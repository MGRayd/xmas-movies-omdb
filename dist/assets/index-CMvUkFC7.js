function Qw(e,t){for(var r=0;r<t.length;r++){const n=t[r];if(typeof n!="string"&&!Array.isArray(n)){for(const s in n)if(s!=="default"&&!(s in e)){const a=Object.getOwnPropertyDescriptor(n,s);a&&Object.defineProperty(e,s,a.get?a:{enumerable:!0,get:()=>n[s]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))n(s);new MutationObserver(s=>{for(const a of s)if(a.type==="childList")for(const i of a.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&n(i)}).observe(document,{childList:!0,subtree:!0});function r(s){const a={};return s.integrity&&(a.integrity=s.integrity),s.referrerPolicy&&(a.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?a.credentials="include":s.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function n(s){if(s.ep)return;s.ep=!0;const a=r(s);fetch(s.href,a)}})();function Jw(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var Zw={exports:{}},ud={},eE={exports:{}},qe={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var pu=Symbol.for("react.element"),YI=Symbol.for("react.portal"),QI=Symbol.for("react.fragment"),JI=Symbol.for("react.strict_mode"),ZI=Symbol.for("react.profiler"),eC=Symbol.for("react.provider"),tC=Symbol.for("react.context"),rC=Symbol.for("react.forward_ref"),nC=Symbol.for("react.suspense"),sC=Symbol.for("react.memo"),aC=Symbol.for("react.lazy"),Kx=Symbol.iterator;function iC(e){return e===null||typeof e!="object"?null:(e=Kx&&e[Kx]||e["@@iterator"],typeof e=="function"?e:null)}var tE={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},rE=Object.assign,nE={};function gl(e,t,r){this.props=e,this.context=t,this.refs=nE,this.updater=r||tE}gl.prototype.isReactComponent={};gl.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};gl.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function sE(){}sE.prototype=gl.prototype;function Wp(e,t,r){this.props=e,this.context=t,this.refs=nE,this.updater=r||tE}var Hp=Wp.prototype=new sE;Hp.constructor=Wp;rE(Hp,gl.prototype);Hp.isPureReactComponent=!0;var qx=Array.isArray,aE=Object.prototype.hasOwnProperty,Gp={current:null},iE={key:!0,ref:!0,__self:!0,__source:!0};function oE(e,t,r){var n,s={},a=null,i=null;if(t!=null)for(n in t.ref!==void 0&&(i=t.ref),t.key!==void 0&&(a=""+t.key),t)aE.call(t,n)&&!iE.hasOwnProperty(n)&&(s[n]=t[n]);var o=arguments.length-2;if(o===1)s.children=r;else if(1<o){for(var l=Array(o),c=0;c<o;c++)l[c]=arguments[c+2];s.children=l}if(e&&e.defaultProps)for(n in o=e.defaultProps,o)s[n]===void 0&&(s[n]=o[n]);return{$$typeof:pu,type:e,key:a,ref:i,props:s,_owner:Gp.current}}function oC(e,t){return{$$typeof:pu,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function Kp(e){return typeof e=="object"&&e!==null&&e.$$typeof===pu}function lC(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(r){return t[r]})}var Xx=/\/+/g;function u0(e,t){return typeof e=="object"&&e!==null&&e.key!=null?lC(""+e.key):t.toString(36)}function Of(e,t,r,n,s){var a=typeof e;(a==="undefined"||a==="boolean")&&(e=null);var i=!1;if(e===null)i=!0;else switch(a){case"string":case"number":i=!0;break;case"object":switch(e.$$typeof){case pu:case YI:i=!0}}if(i)return i=e,s=s(i),e=n===""?"."+u0(i,0):n,qx(s)?(r="",e!=null&&(r=e.replace(Xx,"$&/")+"/"),Of(s,t,r,"",function(c){return c})):s!=null&&(Kp(s)&&(s=oC(s,r+(!s.key||i&&i.key===s.key?"":(""+s.key).replace(Xx,"$&/")+"/")+e)),t.push(s)),1;if(i=0,n=n===""?".":n+":",qx(e))for(var o=0;o<e.length;o++){a=e[o];var l=n+u0(a,o);i+=Of(a,t,r,l,s)}else if(l=iC(e),typeof l=="function")for(e=l.call(e),o=0;!(a=e.next()).done;)a=a.value,l=n+u0(a,o++),i+=Of(a,t,r,l,s);else if(a==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return i}function tf(e,t,r){if(e==null)return e;var n=[],s=0;return Of(e,n,"","",function(a){return t.call(r,a,s++)}),n}function cC(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(r){(e._status===0||e._status===-1)&&(e._status=1,e._result=r)},function(r){(e._status===0||e._status===-1)&&(e._status=2,e._result=r)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var Zr={current:null},Mf={transition:null},uC={ReactCurrentDispatcher:Zr,ReactCurrentBatchConfig:Mf,ReactCurrentOwner:Gp};function lE(){throw Error("act(...) is not supported in production builds of React.")}qe.Children={map:tf,forEach:function(e,t,r){tf(e,function(){t.apply(this,arguments)},r)},count:function(e){var t=0;return tf(e,function(){t++}),t},toArray:function(e){return tf(e,function(t){return t})||[]},only:function(e){if(!Kp(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};qe.Component=gl;qe.Fragment=QI;qe.Profiler=ZI;qe.PureComponent=Wp;qe.StrictMode=JI;qe.Suspense=nC;qe.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=uC;qe.act=lE;qe.cloneElement=function(e,t,r){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var n=rE({},e.props),s=e.key,a=e.ref,i=e._owner;if(t!=null){if(t.ref!==void 0&&(a=t.ref,i=Gp.current),t.key!==void 0&&(s=""+t.key),e.type&&e.type.defaultProps)var o=e.type.defaultProps;for(l in t)aE.call(t,l)&&!iE.hasOwnProperty(l)&&(n[l]=t[l]===void 0&&o!==void 0?o[l]:t[l])}var l=arguments.length-2;if(l===1)n.children=r;else if(1<l){o=Array(l);for(var c=0;c<l;c++)o[c]=arguments[c+2];n.children=o}return{$$typeof:pu,type:e.type,key:s,ref:a,props:n,_owner:i}};qe.createContext=function(e){return e={$$typeof:tC,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:eC,_context:e},e.Consumer=e};qe.createElement=oE;qe.createFactory=function(e){var t=oE.bind(null,e);return t.type=e,t};qe.createRef=function(){return{current:null}};qe.forwardRef=function(e){return{$$typeof:rC,render:e}};qe.isValidElement=Kp;qe.lazy=function(e){return{$$typeof:aC,_payload:{_status:-1,_result:e},_init:cC}};qe.memo=function(e,t){return{$$typeof:sC,type:e,compare:t===void 0?null:t}};qe.startTransition=function(e){var t=Mf.transition;Mf.transition={};try{e()}finally{Mf.transition=t}};qe.unstable_act=lE;qe.useCallback=function(e,t){return Zr.current.useCallback(e,t)};qe.useContext=function(e){return Zr.current.useContext(e)};qe.useDebugValue=function(){};qe.useDeferredValue=function(e){return Zr.current.useDeferredValue(e)};qe.useEffect=function(e,t){return Zr.current.useEffect(e,t)};qe.useId=function(){return Zr.current.useId()};qe.useImperativeHandle=function(e,t,r){return Zr.current.useImperativeHandle(e,t,r)};qe.useInsertionEffect=function(e,t){return Zr.current.useInsertionEffect(e,t)};qe.useLayoutEffect=function(e,t){return Zr.current.useLayoutEffect(e,t)};qe.useMemo=function(e,t){return Zr.current.useMemo(e,t)};qe.useReducer=function(e,t,r){return Zr.current.useReducer(e,t,r)};qe.useRef=function(e){return Zr.current.useRef(e)};qe.useState=function(e){return Zr.current.useState(e)};qe.useSyncExternalStore=function(e,t,r){return Zr.current.useSyncExternalStore(e,t,r)};qe.useTransition=function(){return Zr.current.useTransition()};qe.version="18.3.1";eE.exports=qe;var W=eE.exports;const fd=Jw(W),fC=Qw({__proto__:null,default:fd},[W]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var hC=W,dC=Symbol.for("react.element"),mC=Symbol.for("react.fragment"),pC=Object.prototype.hasOwnProperty,gC=hC.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,vC={key:!0,ref:!0,__self:!0,__source:!0};function cE(e,t,r){var n,s={},a=null,i=null;r!==void 0&&(a=""+r),t.key!==void 0&&(a=""+t.key),t.ref!==void 0&&(i=t.ref);for(n in t)pC.call(t,n)&&!vC.hasOwnProperty(n)&&(s[n]=t[n]);if(e&&e.defaultProps)for(n in t=e.defaultProps,t)s[n]===void 0&&(s[n]=t[n]);return{$$typeof:dC,type:e,key:a,ref:i,props:s,_owner:gC.current}}ud.Fragment=mC;ud.jsx=cE;ud.jsxs=cE;Zw.exports=ud;var d=Zw.exports,om={},uE={exports:{}},In={},fE={exports:{}},hE={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(ie,H){var ce=ie.length;ie.push(H);e:for(;0<ce;){var ve=ce-1>>>1,B=ie[ve];if(0<s(B,H))ie[ve]=H,ie[ce]=B,ce=ve;else break e}}function r(ie){return ie.length===0?null:ie[0]}function n(ie){if(ie.length===0)return null;var H=ie[0],ce=ie.pop();if(ce!==H){ie[0]=ce;e:for(var ve=0,B=ie.length,K=B>>>1;ve<K;){var q=2*(ve+1)-1,G=ie[q],oe=q+1,xe=ie[oe];if(0>s(G,ce))oe<B&&0>s(xe,G)?(ie[ve]=xe,ie[oe]=ce,ve=oe):(ie[ve]=G,ie[q]=ce,ve=q);else if(oe<B&&0>s(xe,ce))ie[ve]=xe,ie[oe]=ce,ve=oe;else break e}}return H}function s(ie,H){var ce=ie.sortIndex-H.sortIndex;return ce!==0?ce:ie.id-H.id}if(typeof performance=="object"&&typeof performance.now=="function"){var a=performance;e.unstable_now=function(){return a.now()}}else{var i=Date,o=i.now();e.unstable_now=function(){return i.now()-o}}var l=[],c=[],u=1,h=null,m=3,p=!1,x=!1,v=!1,w=typeof setTimeout=="function"?setTimeout:null,k=typeof clearTimeout=="function"?clearTimeout:null,T=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function E(ie){for(var H=r(c);H!==null;){if(H.callback===null)n(c);else if(H.startTime<=ie)n(c),H.sortIndex=H.expirationTime,t(l,H);else break;H=r(c)}}function N(ie){if(v=!1,E(ie),!x)if(r(l)!==null)x=!0,he(O);else{var H=r(c);H!==null&&de(N,H.startTime-ie)}}function O(ie,H){x=!1,v&&(v=!1,k(y),y=-1),p=!0;var ce=m;try{for(E(H),h=r(l);h!==null&&(!(h.expirationTime>H)||ie&&!b());){var ve=h.callback;if(typeof ve=="function"){h.callback=null,m=h.priorityLevel;var B=ve(h.expirationTime<=H);H=e.unstable_now(),typeof B=="function"?h.callback=B:h===r(l)&&n(l),E(H)}else n(l);h=r(l)}if(h!==null)var K=!0;else{var q=r(c);q!==null&&de(N,q.startTime-H),K=!1}return K}finally{h=null,m=ce,p=!1}}var L=!1,g=null,y=-1,S=5,R=-1;function b(){return!(e.unstable_now()-R<S)}function P(){if(g!==null){var ie=e.unstable_now();R=ie;var H=!0;try{H=g(!0,ie)}finally{H?C():(L=!1,g=null)}}else L=!1}var C;if(typeof T=="function")C=function(){T(P)};else if(typeof MessageChannel<"u"){var le=new MessageChannel,se=le.port2;le.port1.onmessage=P,C=function(){se.postMessage(null)}}else C=function(){w(P,0)};function he(ie){g=ie,L||(L=!0,C())}function de(ie,H){y=w(function(){ie(e.unstable_now())},H)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(ie){ie.callback=null},e.unstable_continueExecution=function(){x||p||(x=!0,he(O))},e.unstable_forceFrameRate=function(ie){0>ie||125<ie?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):S=0<ie?Math.floor(1e3/ie):5},e.unstable_getCurrentPriorityLevel=function(){return m},e.unstable_getFirstCallbackNode=function(){return r(l)},e.unstable_next=function(ie){switch(m){case 1:case 2:case 3:var H=3;break;default:H=m}var ce=m;m=H;try{return ie()}finally{m=ce}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(ie,H){switch(ie){case 1:case 2:case 3:case 4:case 5:break;default:ie=3}var ce=m;m=ie;try{return H()}finally{m=ce}},e.unstable_scheduleCallback=function(ie,H,ce){var ve=e.unstable_now();switch(typeof ce=="object"&&ce!==null?(ce=ce.delay,ce=typeof ce=="number"&&0<ce?ve+ce:ve):ce=ve,ie){case 1:var B=-1;break;case 2:B=250;break;case 5:B=1073741823;break;case 4:B=1e4;break;default:B=5e3}return B=ce+B,ie={id:u++,callback:H,priorityLevel:ie,startTime:ce,expirationTime:B,sortIndex:-1},ce>ve?(ie.sortIndex=ce,t(c,ie),r(l)===null&&ie===r(c)&&(v?(k(y),y=-1):v=!0,de(N,ce-ve))):(ie.sortIndex=B,t(l,ie),x||p||(x=!0,he(O))),ie},e.unstable_shouldYield=b,e.unstable_wrapCallback=function(ie){var H=m;return function(){var ce=m;m=H;try{return ie.apply(this,arguments)}finally{m=ce}}}})(hE);fE.exports=hE;var xC=fE.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var _C=W,Sn=xC;function ye(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,r=1;r<arguments.length;r++)t+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var dE=new Set,bc={};function Qi(e,t){Yo(e,t),Yo(e+"Capture",t)}function Yo(e,t){for(bc[e]=t,e=0;e<t.length;e++)dE.add(t[e])}var aa=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),lm=Object.prototype.hasOwnProperty,yC=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Yx={},Qx={};function wC(e){return lm.call(Qx,e)?!0:lm.call(Yx,e)?!1:yC.test(e)?Qx[e]=!0:(Yx[e]=!0,!1)}function EC(e,t,r,n){if(r!==null&&r.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return n?!1:r!==null?!r.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function TC(e,t,r,n){if(t===null||typeof t>"u"||EC(e,t,r,n))return!0;if(n)return!1;if(r!==null)switch(r.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function en(e,t,r,n,s,a,i){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=n,this.attributeNamespace=s,this.mustUseProperty=r,this.propertyName=e,this.type=t,this.sanitizeURL=a,this.removeEmptyString=i}var kr={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){kr[e]=new en(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];kr[t]=new en(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){kr[e]=new en(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){kr[e]=new en(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){kr[e]=new en(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){kr[e]=new en(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){kr[e]=new en(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){kr[e]=new en(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){kr[e]=new en(e,5,!1,e.toLowerCase(),null,!1,!1)});var qp=/[\-:]([a-z])/g;function Xp(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(qp,Xp);kr[t]=new en(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(qp,Xp);kr[t]=new en(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(qp,Xp);kr[t]=new en(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){kr[e]=new en(e,1,!1,e.toLowerCase(),null,!1,!1)});kr.xlinkHref=new en("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){kr[e]=new en(e,1,!1,e.toLowerCase(),null,!0,!0)});function Yp(e,t,r,n){var s=kr.hasOwnProperty(t)?kr[t]:null;(s!==null?s.type!==0:n||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(TC(t,r,s,n)&&(r=null),n||s===null?wC(t)&&(r===null?e.removeAttribute(t):e.setAttribute(t,""+r)):s.mustUseProperty?e[s.propertyName]=r===null?s.type===3?!1:"":r:(t=s.attributeName,n=s.attributeNamespace,r===null?e.removeAttribute(t):(s=s.type,r=s===3||s===4&&r===!0?"":""+r,n?e.setAttributeNS(n,t,r):e.setAttribute(t,r))))}var va=_C.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,rf=Symbol.for("react.element"),To=Symbol.for("react.portal"),ko=Symbol.for("react.fragment"),Qp=Symbol.for("react.strict_mode"),cm=Symbol.for("react.profiler"),mE=Symbol.for("react.provider"),pE=Symbol.for("react.context"),Jp=Symbol.for("react.forward_ref"),um=Symbol.for("react.suspense"),fm=Symbol.for("react.suspense_list"),Zp=Symbol.for("react.memo"),Ra=Symbol.for("react.lazy"),gE=Symbol.for("react.offscreen"),Jx=Symbol.iterator;function Ml(e){return e===null||typeof e!="object"?null:(e=Jx&&e[Jx]||e["@@iterator"],typeof e=="function"?e:null)}var Mt=Object.assign,f0;function ql(e){if(f0===void 0)try{throw Error()}catch(r){var t=r.stack.trim().match(/\n( *(at )?)/);f0=t&&t[1]||""}return`
`+f0+e}var h0=!1;function d0(e,t){if(!e||h0)return"";h0=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(c){var n=c}Reflect.construct(e,[],t)}else{try{t.call()}catch(c){n=c}e.call(t.prototype)}else{try{throw Error()}catch(c){n=c}e()}}catch(c){if(c&&n&&typeof c.stack=="string"){for(var s=c.stack.split(`
`),a=n.stack.split(`
`),i=s.length-1,o=a.length-1;1<=i&&0<=o&&s[i]!==a[o];)o--;for(;1<=i&&0<=o;i--,o--)if(s[i]!==a[o]){if(i!==1||o!==1)do if(i--,o--,0>o||s[i]!==a[o]){var l=`
`+s[i].replace(" at new "," at ");return e.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",e.displayName)),l}while(1<=i&&0<=o);break}}}finally{h0=!1,Error.prepareStackTrace=r}return(e=e?e.displayName||e.name:"")?ql(e):""}function kC(e){switch(e.tag){case 5:return ql(e.type);case 16:return ql("Lazy");case 13:return ql("Suspense");case 19:return ql("SuspenseList");case 0:case 2:case 15:return e=d0(e.type,!1),e;case 11:return e=d0(e.type.render,!1),e;case 1:return e=d0(e.type,!0),e;default:return""}}function hm(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case ko:return"Fragment";case To:return"Portal";case cm:return"Profiler";case Qp:return"StrictMode";case um:return"Suspense";case fm:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case pE:return(e.displayName||"Context")+".Consumer";case mE:return(e._context.displayName||"Context")+".Provider";case Jp:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case Zp:return t=e.displayName||null,t!==null?t:hm(e.type)||"Memo";case Ra:t=e._payload,e=e._init;try{return hm(e(t))}catch{}}return null}function SC(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return hm(t);case 8:return t===Qp?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function ti(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function vE(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function AC(e){var t=vE(e)?"checked":"value",r=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),n=""+e[t];if(!e.hasOwnProperty(t)&&typeof r<"u"&&typeof r.get=="function"&&typeof r.set=="function"){var s=r.get,a=r.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return s.call(this)},set:function(i){n=""+i,a.call(this,i)}}),Object.defineProperty(e,t,{enumerable:r.enumerable}),{getValue:function(){return n},setValue:function(i){n=""+i},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function nf(e){e._valueTracker||(e._valueTracker=AC(e))}function xE(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var r=t.getValue(),n="";return e&&(n=vE(e)?e.checked?"true":"false":e.value),e=n,e!==r?(t.setValue(e),!0):!1}function sh(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function dm(e,t){var r=t.checked;return Mt({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:r??e._wrapperState.initialChecked})}function Zx(e,t){var r=t.defaultValue==null?"":t.defaultValue,n=t.checked!=null?t.checked:t.defaultChecked;r=ti(t.value!=null?t.value:r),e._wrapperState={initialChecked:n,initialValue:r,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function _E(e,t){t=t.checked,t!=null&&Yp(e,"checked",t,!1)}function mm(e,t){_E(e,t);var r=ti(t.value),n=t.type;if(r!=null)n==="number"?(r===0&&e.value===""||e.value!=r)&&(e.value=""+r):e.value!==""+r&&(e.value=""+r);else if(n==="submit"||n==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?pm(e,t.type,r):t.hasOwnProperty("defaultValue")&&pm(e,t.type,ti(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function e1(e,t,r){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var n=t.type;if(!(n!=="submit"&&n!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,r||t===e.value||(e.value=t),e.defaultValue=t}r=e.name,r!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,r!==""&&(e.name=r)}function pm(e,t,r){(t!=="number"||sh(e.ownerDocument)!==e)&&(r==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+r&&(e.defaultValue=""+r))}var Xl=Array.isArray;function Mo(e,t,r,n){if(e=e.options,t){t={};for(var s=0;s<r.length;s++)t["$"+r[s]]=!0;for(r=0;r<e.length;r++)s=t.hasOwnProperty("$"+e[r].value),e[r].selected!==s&&(e[r].selected=s),s&&n&&(e[r].defaultSelected=!0)}else{for(r=""+ti(r),t=null,s=0;s<e.length;s++){if(e[s].value===r){e[s].selected=!0,n&&(e[s].defaultSelected=!0);return}t!==null||e[s].disabled||(t=e[s])}t!==null&&(t.selected=!0)}}function gm(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(ye(91));return Mt({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function t1(e,t){var r=t.value;if(r==null){if(r=t.children,t=t.defaultValue,r!=null){if(t!=null)throw Error(ye(92));if(Xl(r)){if(1<r.length)throw Error(ye(93));r=r[0]}t=r}t==null&&(t=""),r=t}e._wrapperState={initialValue:ti(r)}}function yE(e,t){var r=ti(t.value),n=ti(t.defaultValue);r!=null&&(r=""+r,r!==e.value&&(e.value=r),t.defaultValue==null&&e.defaultValue!==r&&(e.defaultValue=r)),n!=null&&(e.defaultValue=""+n)}function r1(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function wE(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function vm(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?wE(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var sf,EE=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,r,n,s){MSApp.execUnsafeLocalFunction(function(){return e(t,r,n,s)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(sf=sf||document.createElement("div"),sf.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=sf.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function Pc(e,t){if(t){var r=e.firstChild;if(r&&r===e.lastChild&&r.nodeType===3){r.nodeValue=t;return}}e.textContent=t}var oc={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},IC=["Webkit","ms","Moz","O"];Object.keys(oc).forEach(function(e){IC.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),oc[t]=oc[e]})});function TE(e,t,r){return t==null||typeof t=="boolean"||t===""?"":r||typeof t!="number"||t===0||oc.hasOwnProperty(e)&&oc[e]?(""+t).trim():t+"px"}function kE(e,t){e=e.style;for(var r in t)if(t.hasOwnProperty(r)){var n=r.indexOf("--")===0,s=TE(r,t[r],n);r==="float"&&(r="cssFloat"),n?e.setProperty(r,s):e[r]=s}}var CC=Mt({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function xm(e,t){if(t){if(CC[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(ye(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(ye(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(ye(61))}if(t.style!=null&&typeof t.style!="object")throw Error(ye(62))}}function _m(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var ym=null;function eg(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var wm=null,Lo=null,jo=null;function n1(e){if(e=xu(e)){if(typeof wm!="function")throw Error(ye(280));var t=e.stateNode;t&&(t=gd(t),wm(e.stateNode,e.type,t))}}function SE(e){Lo?jo?jo.push(e):jo=[e]:Lo=e}function AE(){if(Lo){var e=Lo,t=jo;if(jo=Lo=null,n1(e),t)for(e=0;e<t.length;e++)n1(t[e])}}function IE(e,t){return e(t)}function CE(){}var m0=!1;function RE(e,t,r){if(m0)return e(t,r);m0=!0;try{return IE(e,t,r)}finally{m0=!1,(Lo!==null||jo!==null)&&(CE(),AE())}}function Dc(e,t){var r=e.stateNode;if(r===null)return null;var n=gd(r);if(n===null)return null;r=n[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(e=e.type,n=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!n;break e;default:e=!1}if(e)return null;if(r&&typeof r!="function")throw Error(ye(231,t,typeof r));return r}var Em=!1;if(aa)try{var Ll={};Object.defineProperty(Ll,"passive",{get:function(){Em=!0}}),window.addEventListener("test",Ll,Ll),window.removeEventListener("test",Ll,Ll)}catch{Em=!1}function RC(e,t,r,n,s,a,i,o,l){var c=Array.prototype.slice.call(arguments,3);try{t.apply(r,c)}catch(u){this.onError(u)}}var lc=!1,ah=null,ih=!1,Tm=null,NC={onError:function(e){lc=!0,ah=e}};function bC(e,t,r,n,s,a,i,o,l){lc=!1,ah=null,RC.apply(NC,arguments)}function PC(e,t,r,n,s,a,i,o,l){if(bC.apply(this,arguments),lc){if(lc){var c=ah;lc=!1,ah=null}else throw Error(ye(198));ih||(ih=!0,Tm=c)}}function Ji(e){var t=e,r=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(r=t.return),e=t.return;while(e)}return t.tag===3?r:null}function NE(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function s1(e){if(Ji(e)!==e)throw Error(ye(188))}function DC(e){var t=e.alternate;if(!t){if(t=Ji(e),t===null)throw Error(ye(188));return t!==e?null:e}for(var r=e,n=t;;){var s=r.return;if(s===null)break;var a=s.alternate;if(a===null){if(n=s.return,n!==null){r=n;continue}break}if(s.child===a.child){for(a=s.child;a;){if(a===r)return s1(s),e;if(a===n)return s1(s),t;a=a.sibling}throw Error(ye(188))}if(r.return!==n.return)r=s,n=a;else{for(var i=!1,o=s.child;o;){if(o===r){i=!0,r=s,n=a;break}if(o===n){i=!0,n=s,r=a;break}o=o.sibling}if(!i){for(o=a.child;o;){if(o===r){i=!0,r=a,n=s;break}if(o===n){i=!0,n=a,r=s;break}o=o.sibling}if(!i)throw Error(ye(189))}}if(r.alternate!==n)throw Error(ye(190))}if(r.tag!==3)throw Error(ye(188));return r.stateNode.current===r?e:t}function bE(e){return e=DC(e),e!==null?PE(e):null}function PE(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=PE(e);if(t!==null)return t;e=e.sibling}return null}var DE=Sn.unstable_scheduleCallback,a1=Sn.unstable_cancelCallback,FC=Sn.unstable_shouldYield,OC=Sn.unstable_requestPaint,Wt=Sn.unstable_now,MC=Sn.unstable_getCurrentPriorityLevel,tg=Sn.unstable_ImmediatePriority,FE=Sn.unstable_UserBlockingPriority,oh=Sn.unstable_NormalPriority,LC=Sn.unstable_LowPriority,OE=Sn.unstable_IdlePriority,hd=null,Es=null;function jC(e){if(Es&&typeof Es.onCommitFiberRoot=="function")try{Es.onCommitFiberRoot(hd,e,void 0,(e.current.flags&128)===128)}catch{}}var as=Math.clz32?Math.clz32:BC,VC=Math.log,UC=Math.LN2;function BC(e){return e>>>=0,e===0?32:31-(VC(e)/UC|0)|0}var af=64,of=4194304;function Yl(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function lh(e,t){var r=e.pendingLanes;if(r===0)return 0;var n=0,s=e.suspendedLanes,a=e.pingedLanes,i=r&268435455;if(i!==0){var o=i&~s;o!==0?n=Yl(o):(a&=i,a!==0&&(n=Yl(a)))}else i=r&~s,i!==0?n=Yl(i):a!==0&&(n=Yl(a));if(n===0)return 0;if(t!==0&&t!==n&&!(t&s)&&(s=n&-n,a=t&-t,s>=a||s===16&&(a&4194240)!==0))return t;if(n&4&&(n|=r&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=n;0<t;)r=31-as(t),s=1<<r,n|=e[r],t&=~s;return n}function zC(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function $C(e,t){for(var r=e.suspendedLanes,n=e.pingedLanes,s=e.expirationTimes,a=e.pendingLanes;0<a;){var i=31-as(a),o=1<<i,l=s[i];l===-1?(!(o&r)||o&n)&&(s[i]=zC(o,t)):l<=t&&(e.expiredLanes|=o),a&=~o}}function km(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function ME(){var e=af;return af<<=1,!(af&4194240)&&(af=64),e}function p0(e){for(var t=[],r=0;31>r;r++)t.push(e);return t}function gu(e,t,r){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-as(t),e[t]=r}function WC(e,t){var r=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var n=e.eventTimes;for(e=e.expirationTimes;0<r;){var s=31-as(r),a=1<<s;t[s]=0,n[s]=-1,e[s]=-1,r&=~a}}function rg(e,t){var r=e.entangledLanes|=t;for(e=e.entanglements;r;){var n=31-as(r),s=1<<n;s&t|e[n]&t&&(e[n]|=t),r&=~s}}var pt=0;function LE(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var jE,ng,VE,UE,BE,Sm=!1,lf=[],$a=null,Wa=null,Ha=null,Fc=new Map,Oc=new Map,ba=[],HC="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function i1(e,t){switch(e){case"focusin":case"focusout":$a=null;break;case"dragenter":case"dragleave":Wa=null;break;case"mouseover":case"mouseout":Ha=null;break;case"pointerover":case"pointerout":Fc.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Oc.delete(t.pointerId)}}function jl(e,t,r,n,s,a){return e===null||e.nativeEvent!==a?(e={blockedOn:t,domEventName:r,eventSystemFlags:n,nativeEvent:a,targetContainers:[s]},t!==null&&(t=xu(t),t!==null&&ng(t)),e):(e.eventSystemFlags|=n,t=e.targetContainers,s!==null&&t.indexOf(s)===-1&&t.push(s),e)}function GC(e,t,r,n,s){switch(t){case"focusin":return $a=jl($a,e,t,r,n,s),!0;case"dragenter":return Wa=jl(Wa,e,t,r,n,s),!0;case"mouseover":return Ha=jl(Ha,e,t,r,n,s),!0;case"pointerover":var a=s.pointerId;return Fc.set(a,jl(Fc.get(a)||null,e,t,r,n,s)),!0;case"gotpointercapture":return a=s.pointerId,Oc.set(a,jl(Oc.get(a)||null,e,t,r,n,s)),!0}return!1}function zE(e){var t=Si(e.target);if(t!==null){var r=Ji(t);if(r!==null){if(t=r.tag,t===13){if(t=NE(r),t!==null){e.blockedOn=t,BE(e.priority,function(){VE(r)});return}}else if(t===3&&r.stateNode.current.memoizedState.isDehydrated){e.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}e.blockedOn=null}function Lf(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var r=Am(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(r===null){r=e.nativeEvent;var n=new r.constructor(r.type,r);ym=n,r.target.dispatchEvent(n),ym=null}else return t=xu(r),t!==null&&ng(t),e.blockedOn=r,!1;t.shift()}return!0}function o1(e,t,r){Lf(e)&&r.delete(t)}function KC(){Sm=!1,$a!==null&&Lf($a)&&($a=null),Wa!==null&&Lf(Wa)&&(Wa=null),Ha!==null&&Lf(Ha)&&(Ha=null),Fc.forEach(o1),Oc.forEach(o1)}function Vl(e,t){e.blockedOn===t&&(e.blockedOn=null,Sm||(Sm=!0,Sn.unstable_scheduleCallback(Sn.unstable_NormalPriority,KC)))}function Mc(e){function t(s){return Vl(s,e)}if(0<lf.length){Vl(lf[0],e);for(var r=1;r<lf.length;r++){var n=lf[r];n.blockedOn===e&&(n.blockedOn=null)}}for($a!==null&&Vl($a,e),Wa!==null&&Vl(Wa,e),Ha!==null&&Vl(Ha,e),Fc.forEach(t),Oc.forEach(t),r=0;r<ba.length;r++)n=ba[r],n.blockedOn===e&&(n.blockedOn=null);for(;0<ba.length&&(r=ba[0],r.blockedOn===null);)zE(r),r.blockedOn===null&&ba.shift()}var Vo=va.ReactCurrentBatchConfig,ch=!0;function qC(e,t,r,n){var s=pt,a=Vo.transition;Vo.transition=null;try{pt=1,sg(e,t,r,n)}finally{pt=s,Vo.transition=a}}function XC(e,t,r,n){var s=pt,a=Vo.transition;Vo.transition=null;try{pt=4,sg(e,t,r,n)}finally{pt=s,Vo.transition=a}}function sg(e,t,r,n){if(ch){var s=Am(e,t,r,n);if(s===null)S0(e,t,n,uh,r),i1(e,n);else if(GC(s,e,t,r,n))n.stopPropagation();else if(i1(e,n),t&4&&-1<HC.indexOf(e)){for(;s!==null;){var a=xu(s);if(a!==null&&jE(a),a=Am(e,t,r,n),a===null&&S0(e,t,n,uh,r),a===s)break;s=a}s!==null&&n.stopPropagation()}else S0(e,t,n,null,r)}}var uh=null;function Am(e,t,r,n){if(uh=null,e=eg(n),e=Si(e),e!==null)if(t=Ji(e),t===null)e=null;else if(r=t.tag,r===13){if(e=NE(t),e!==null)return e;e=null}else if(r===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return uh=e,null}function $E(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(MC()){case tg:return 1;case FE:return 4;case oh:case LC:return 16;case OE:return 536870912;default:return 16}default:return 16}}var La=null,ag=null,jf=null;function WE(){if(jf)return jf;var e,t=ag,r=t.length,n,s="value"in La?La.value:La.textContent,a=s.length;for(e=0;e<r&&t[e]===s[e];e++);var i=r-e;for(n=1;n<=i&&t[r-n]===s[a-n];n++);return jf=s.slice(e,1<n?1-n:void 0)}function Vf(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function cf(){return!0}function l1(){return!1}function Cn(e){function t(r,n,s,a,i){this._reactName=r,this._targetInst=s,this.type=n,this.nativeEvent=a,this.target=i,this.currentTarget=null;for(var o in e)e.hasOwnProperty(o)&&(r=e[o],this[o]=r?r(a):a[o]);return this.isDefaultPrevented=(a.defaultPrevented!=null?a.defaultPrevented:a.returnValue===!1)?cf:l1,this.isPropagationStopped=l1,this}return Mt(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=cf)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=cf)},persist:function(){},isPersistent:cf}),t}var vl={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},ig=Cn(vl),vu=Mt({},vl,{view:0,detail:0}),YC=Cn(vu),g0,v0,Ul,dd=Mt({},vu,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:og,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==Ul&&(Ul&&e.type==="mousemove"?(g0=e.screenX-Ul.screenX,v0=e.screenY-Ul.screenY):v0=g0=0,Ul=e),g0)},movementY:function(e){return"movementY"in e?e.movementY:v0}}),c1=Cn(dd),QC=Mt({},dd,{dataTransfer:0}),JC=Cn(QC),ZC=Mt({},vu,{relatedTarget:0}),x0=Cn(ZC),e4=Mt({},vl,{animationName:0,elapsedTime:0,pseudoElement:0}),t4=Cn(e4),r4=Mt({},vl,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),n4=Cn(r4),s4=Mt({},vl,{data:0}),u1=Cn(s4),a4={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},i4={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},o4={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function l4(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=o4[e])?!!t[e]:!1}function og(){return l4}var c4=Mt({},vu,{key:function(e){if(e.key){var t=a4[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=Vf(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?i4[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:og,charCode:function(e){return e.type==="keypress"?Vf(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?Vf(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),u4=Cn(c4),f4=Mt({},dd,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),f1=Cn(f4),h4=Mt({},vu,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:og}),d4=Cn(h4),m4=Mt({},vl,{propertyName:0,elapsedTime:0,pseudoElement:0}),p4=Cn(m4),g4=Mt({},dd,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),v4=Cn(g4),x4=[9,13,27,32],lg=aa&&"CompositionEvent"in window,cc=null;aa&&"documentMode"in document&&(cc=document.documentMode);var _4=aa&&"TextEvent"in window&&!cc,HE=aa&&(!lg||cc&&8<cc&&11>=cc),h1=" ",d1=!1;function GE(e,t){switch(e){case"keyup":return x4.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function KE(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var So=!1;function y4(e,t){switch(e){case"compositionend":return KE(t);case"keypress":return t.which!==32?null:(d1=!0,h1);case"textInput":return e=t.data,e===h1&&d1?null:e;default:return null}}function w4(e,t){if(So)return e==="compositionend"||!lg&&GE(e,t)?(e=WE(),jf=ag=La=null,So=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return HE&&t.locale!=="ko"?null:t.data;default:return null}}var E4={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function m1(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!E4[e.type]:t==="textarea"}function qE(e,t,r,n){SE(n),t=fh(t,"onChange"),0<t.length&&(r=new ig("onChange","change",null,r,n),e.push({event:r,listeners:t}))}var uc=null,Lc=null;function T4(e){a2(e,0)}function md(e){var t=Co(e);if(xE(t))return e}function k4(e,t){if(e==="change")return t}var XE=!1;if(aa){var _0;if(aa){var y0="oninput"in document;if(!y0){var p1=document.createElement("div");p1.setAttribute("oninput","return;"),y0=typeof p1.oninput=="function"}_0=y0}else _0=!1;XE=_0&&(!document.documentMode||9<document.documentMode)}function g1(){uc&&(uc.detachEvent("onpropertychange",YE),Lc=uc=null)}function YE(e){if(e.propertyName==="value"&&md(Lc)){var t=[];qE(t,Lc,e,eg(e)),RE(T4,t)}}function S4(e,t,r){e==="focusin"?(g1(),uc=t,Lc=r,uc.attachEvent("onpropertychange",YE)):e==="focusout"&&g1()}function A4(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return md(Lc)}function I4(e,t){if(e==="click")return md(t)}function C4(e,t){if(e==="input"||e==="change")return md(t)}function R4(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var cs=typeof Object.is=="function"?Object.is:R4;function jc(e,t){if(cs(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var r=Object.keys(e),n=Object.keys(t);if(r.length!==n.length)return!1;for(n=0;n<r.length;n++){var s=r[n];if(!lm.call(t,s)||!cs(e[s],t[s]))return!1}return!0}function v1(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function x1(e,t){var r=v1(e);e=0;for(var n;r;){if(r.nodeType===3){if(n=e+r.textContent.length,e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=v1(r)}}function QE(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?QE(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function JE(){for(var e=window,t=sh();t instanceof e.HTMLIFrameElement;){try{var r=typeof t.contentWindow.location.href=="string"}catch{r=!1}if(r)e=t.contentWindow;else break;t=sh(e.document)}return t}function cg(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function N4(e){var t=JE(),r=e.focusedElem,n=e.selectionRange;if(t!==r&&r&&r.ownerDocument&&QE(r.ownerDocument.documentElement,r)){if(n!==null&&cg(r)){if(t=n.start,e=n.end,e===void 0&&(e=t),"selectionStart"in r)r.selectionStart=t,r.selectionEnd=Math.min(e,r.value.length);else if(e=(t=r.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var s=r.textContent.length,a=Math.min(n.start,s);n=n.end===void 0?a:Math.min(n.end,s),!e.extend&&a>n&&(s=n,n=a,a=s),s=x1(r,a);var i=x1(r,n);s&&i&&(e.rangeCount!==1||e.anchorNode!==s.node||e.anchorOffset!==s.offset||e.focusNode!==i.node||e.focusOffset!==i.offset)&&(t=t.createRange(),t.setStart(s.node,s.offset),e.removeAllRanges(),a>n?(e.addRange(t),e.extend(i.node,i.offset)):(t.setEnd(i.node,i.offset),e.addRange(t)))}}for(t=[],e=r;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof r.focus=="function"&&r.focus(),r=0;r<t.length;r++)e=t[r],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var b4=aa&&"documentMode"in document&&11>=document.documentMode,Ao=null,Im=null,fc=null,Cm=!1;function _1(e,t,r){var n=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;Cm||Ao==null||Ao!==sh(n)||(n=Ao,"selectionStart"in n&&cg(n)?n={start:n.selectionStart,end:n.selectionEnd}:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection(),n={anchorNode:n.anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset}),fc&&jc(fc,n)||(fc=n,n=fh(Im,"onSelect"),0<n.length&&(t=new ig("onSelect","select",null,t,r),e.push({event:t,listeners:n}),t.target=Ao)))}function uf(e,t){var r={};return r[e.toLowerCase()]=t.toLowerCase(),r["Webkit"+e]="webkit"+t,r["Moz"+e]="moz"+t,r}var Io={animationend:uf("Animation","AnimationEnd"),animationiteration:uf("Animation","AnimationIteration"),animationstart:uf("Animation","AnimationStart"),transitionend:uf("Transition","TransitionEnd")},w0={},ZE={};aa&&(ZE=document.createElement("div").style,"AnimationEvent"in window||(delete Io.animationend.animation,delete Io.animationiteration.animation,delete Io.animationstart.animation),"TransitionEvent"in window||delete Io.transitionend.transition);function pd(e){if(w0[e])return w0[e];if(!Io[e])return e;var t=Io[e],r;for(r in t)if(t.hasOwnProperty(r)&&r in ZE)return w0[e]=t[r];return e}var e2=pd("animationend"),t2=pd("animationiteration"),r2=pd("animationstart"),n2=pd("transitionend"),s2=new Map,y1="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function ui(e,t){s2.set(e,t),Qi(t,[e])}for(var E0=0;E0<y1.length;E0++){var T0=y1[E0],P4=T0.toLowerCase(),D4=T0[0].toUpperCase()+T0.slice(1);ui(P4,"on"+D4)}ui(e2,"onAnimationEnd");ui(t2,"onAnimationIteration");ui(r2,"onAnimationStart");ui("dblclick","onDoubleClick");ui("focusin","onFocus");ui("focusout","onBlur");ui(n2,"onTransitionEnd");Yo("onMouseEnter",["mouseout","mouseover"]);Yo("onMouseLeave",["mouseout","mouseover"]);Yo("onPointerEnter",["pointerout","pointerover"]);Yo("onPointerLeave",["pointerout","pointerover"]);Qi("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Qi("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Qi("onBeforeInput",["compositionend","keypress","textInput","paste"]);Qi("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Qi("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Qi("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Ql="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),F4=new Set("cancel close invalid load scroll toggle".split(" ").concat(Ql));function w1(e,t,r){var n=e.type||"unknown-event";e.currentTarget=r,PC(n,t,void 0,e),e.currentTarget=null}function a2(e,t){t=(t&4)!==0;for(var r=0;r<e.length;r++){var n=e[r],s=n.event;n=n.listeners;e:{var a=void 0;if(t)for(var i=n.length-1;0<=i;i--){var o=n[i],l=o.instance,c=o.currentTarget;if(o=o.listener,l!==a&&s.isPropagationStopped())break e;w1(s,o,c),a=l}else for(i=0;i<n.length;i++){if(o=n[i],l=o.instance,c=o.currentTarget,o=o.listener,l!==a&&s.isPropagationStopped())break e;w1(s,o,c),a=l}}}if(ih)throw e=Tm,ih=!1,Tm=null,e}function It(e,t){var r=t[Dm];r===void 0&&(r=t[Dm]=new Set);var n=e+"__bubble";r.has(n)||(i2(t,e,2,!1),r.add(n))}function k0(e,t,r){var n=0;t&&(n|=4),i2(r,e,n,t)}var ff="_reactListening"+Math.random().toString(36).slice(2);function Vc(e){if(!e[ff]){e[ff]=!0,dE.forEach(function(r){r!=="selectionchange"&&(F4.has(r)||k0(r,!1,e),k0(r,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[ff]||(t[ff]=!0,k0("selectionchange",!1,t))}}function i2(e,t,r,n){switch($E(t)){case 1:var s=qC;break;case 4:s=XC;break;default:s=sg}r=s.bind(null,t,r,e),s=void 0,!Em||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(s=!0),n?s!==void 0?e.addEventListener(t,r,{capture:!0,passive:s}):e.addEventListener(t,r,!0):s!==void 0?e.addEventListener(t,r,{passive:s}):e.addEventListener(t,r,!1)}function S0(e,t,r,n,s){var a=n;if(!(t&1)&&!(t&2)&&n!==null)e:for(;;){if(n===null)return;var i=n.tag;if(i===3||i===4){var o=n.stateNode.containerInfo;if(o===s||o.nodeType===8&&o.parentNode===s)break;if(i===4)for(i=n.return;i!==null;){var l=i.tag;if((l===3||l===4)&&(l=i.stateNode.containerInfo,l===s||l.nodeType===8&&l.parentNode===s))return;i=i.return}for(;o!==null;){if(i=Si(o),i===null)return;if(l=i.tag,l===5||l===6){n=a=i;continue e}o=o.parentNode}}n=n.return}RE(function(){var c=a,u=eg(r),h=[];e:{var m=s2.get(e);if(m!==void 0){var p=ig,x=e;switch(e){case"keypress":if(Vf(r)===0)break e;case"keydown":case"keyup":p=u4;break;case"focusin":x="focus",p=x0;break;case"focusout":x="blur",p=x0;break;case"beforeblur":case"afterblur":p=x0;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":p=c1;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":p=JC;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":p=d4;break;case e2:case t2:case r2:p=t4;break;case n2:p=p4;break;case"scroll":p=YC;break;case"wheel":p=v4;break;case"copy":case"cut":case"paste":p=n4;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":p=f1}var v=(t&4)!==0,w=!v&&e==="scroll",k=v?m!==null?m+"Capture":null:m;v=[];for(var T=c,E;T!==null;){E=T;var N=E.stateNode;if(E.tag===5&&N!==null&&(E=N,k!==null&&(N=Dc(T,k),N!=null&&v.push(Uc(T,N,E)))),w)break;T=T.return}0<v.length&&(m=new p(m,x,null,r,u),h.push({event:m,listeners:v}))}}if(!(t&7)){e:{if(m=e==="mouseover"||e==="pointerover",p=e==="mouseout"||e==="pointerout",m&&r!==ym&&(x=r.relatedTarget||r.fromElement)&&(Si(x)||x[ia]))break e;if((p||m)&&(m=u.window===u?u:(m=u.ownerDocument)?m.defaultView||m.parentWindow:window,p?(x=r.relatedTarget||r.toElement,p=c,x=x?Si(x):null,x!==null&&(w=Ji(x),x!==w||x.tag!==5&&x.tag!==6)&&(x=null)):(p=null,x=c),p!==x)){if(v=c1,N="onMouseLeave",k="onMouseEnter",T="mouse",(e==="pointerout"||e==="pointerover")&&(v=f1,N="onPointerLeave",k="onPointerEnter",T="pointer"),w=p==null?m:Co(p),E=x==null?m:Co(x),m=new v(N,T+"leave",p,r,u),m.target=w,m.relatedTarget=E,N=null,Si(u)===c&&(v=new v(k,T+"enter",x,r,u),v.target=E,v.relatedTarget=w,N=v),w=N,p&&x)t:{for(v=p,k=x,T=0,E=v;E;E=go(E))T++;for(E=0,N=k;N;N=go(N))E++;for(;0<T-E;)v=go(v),T--;for(;0<E-T;)k=go(k),E--;for(;T--;){if(v===k||k!==null&&v===k.alternate)break t;v=go(v),k=go(k)}v=null}else v=null;p!==null&&E1(h,m,p,v,!1),x!==null&&w!==null&&E1(h,w,x,v,!0)}}e:{if(m=c?Co(c):window,p=m.nodeName&&m.nodeName.toLowerCase(),p==="select"||p==="input"&&m.type==="file")var O=k4;else if(m1(m))if(XE)O=C4;else{O=A4;var L=S4}else(p=m.nodeName)&&p.toLowerCase()==="input"&&(m.type==="checkbox"||m.type==="radio")&&(O=I4);if(O&&(O=O(e,c))){qE(h,O,r,u);break e}L&&L(e,m,c),e==="focusout"&&(L=m._wrapperState)&&L.controlled&&m.type==="number"&&pm(m,"number",m.value)}switch(L=c?Co(c):window,e){case"focusin":(m1(L)||L.contentEditable==="true")&&(Ao=L,Im=c,fc=null);break;case"focusout":fc=Im=Ao=null;break;case"mousedown":Cm=!0;break;case"contextmenu":case"mouseup":case"dragend":Cm=!1,_1(h,r,u);break;case"selectionchange":if(b4)break;case"keydown":case"keyup":_1(h,r,u)}var g;if(lg)e:{switch(e){case"compositionstart":var y="onCompositionStart";break e;case"compositionend":y="onCompositionEnd";break e;case"compositionupdate":y="onCompositionUpdate";break e}y=void 0}else So?GE(e,r)&&(y="onCompositionEnd"):e==="keydown"&&r.keyCode===229&&(y="onCompositionStart");y&&(HE&&r.locale!=="ko"&&(So||y!=="onCompositionStart"?y==="onCompositionEnd"&&So&&(g=WE()):(La=u,ag="value"in La?La.value:La.textContent,So=!0)),L=fh(c,y),0<L.length&&(y=new u1(y,e,null,r,u),h.push({event:y,listeners:L}),g?y.data=g:(g=KE(r),g!==null&&(y.data=g)))),(g=_4?y4(e,r):w4(e,r))&&(c=fh(c,"onBeforeInput"),0<c.length&&(u=new u1("onBeforeInput","beforeinput",null,r,u),h.push({event:u,listeners:c}),u.data=g))}a2(h,t)})}function Uc(e,t,r){return{instance:e,listener:t,currentTarget:r}}function fh(e,t){for(var r=t+"Capture",n=[];e!==null;){var s=e,a=s.stateNode;s.tag===5&&a!==null&&(s=a,a=Dc(e,r),a!=null&&n.unshift(Uc(e,a,s)),a=Dc(e,t),a!=null&&n.push(Uc(e,a,s))),e=e.return}return n}function go(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function E1(e,t,r,n,s){for(var a=t._reactName,i=[];r!==null&&r!==n;){var o=r,l=o.alternate,c=o.stateNode;if(l!==null&&l===n)break;o.tag===5&&c!==null&&(o=c,s?(l=Dc(r,a),l!=null&&i.unshift(Uc(r,l,o))):s||(l=Dc(r,a),l!=null&&i.push(Uc(r,l,o)))),r=r.return}i.length!==0&&e.push({event:t,listeners:i})}var O4=/\r\n?/g,M4=/\u0000|\uFFFD/g;function T1(e){return(typeof e=="string"?e:""+e).replace(O4,`
`).replace(M4,"")}function hf(e,t,r){if(t=T1(t),T1(e)!==t&&r)throw Error(ye(425))}function hh(){}var Rm=null,Nm=null;function bm(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var Pm=typeof setTimeout=="function"?setTimeout:void 0,L4=typeof clearTimeout=="function"?clearTimeout:void 0,k1=typeof Promise=="function"?Promise:void 0,j4=typeof queueMicrotask=="function"?queueMicrotask:typeof k1<"u"?function(e){return k1.resolve(null).then(e).catch(V4)}:Pm;function V4(e){setTimeout(function(){throw e})}function A0(e,t){var r=t,n=0;do{var s=r.nextSibling;if(e.removeChild(r),s&&s.nodeType===8)if(r=s.data,r==="/$"){if(n===0){e.removeChild(s),Mc(t);return}n--}else r!=="$"&&r!=="$?"&&r!=="$!"||n++;r=s}while(r);Mc(t)}function Ga(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function S1(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="$"||r==="$!"||r==="$?"){if(t===0)return e;t--}else r==="/$"&&t++}e=e.previousSibling}return null}var xl=Math.random().toString(36).slice(2),_s="__reactFiber$"+xl,Bc="__reactProps$"+xl,ia="__reactContainer$"+xl,Dm="__reactEvents$"+xl,U4="__reactListeners$"+xl,B4="__reactHandles$"+xl;function Si(e){var t=e[_s];if(t)return t;for(var r=e.parentNode;r;){if(t=r[ia]||r[_s]){if(r=t.alternate,t.child!==null||r!==null&&r.child!==null)for(e=S1(e);e!==null;){if(r=e[_s])return r;e=S1(e)}return t}e=r,r=e.parentNode}return null}function xu(e){return e=e[_s]||e[ia],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function Co(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(ye(33))}function gd(e){return e[Bc]||null}var Fm=[],Ro=-1;function fi(e){return{current:e}}function Rt(e){0>Ro||(e.current=Fm[Ro],Fm[Ro]=null,Ro--)}function wt(e,t){Ro++,Fm[Ro]=e.current,e.current=t}var ri={},Br=fi(ri),un=fi(!1),ji=ri;function Qo(e,t){var r=e.type.contextTypes;if(!r)return ri;var n=e.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===t)return n.__reactInternalMemoizedMaskedChildContext;var s={},a;for(a in r)s[a]=t[a];return n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=s),s}function fn(e){return e=e.childContextTypes,e!=null}function dh(){Rt(un),Rt(Br)}function A1(e,t,r){if(Br.current!==ri)throw Error(ye(168));wt(Br,t),wt(un,r)}function o2(e,t,r){var n=e.stateNode;if(t=t.childContextTypes,typeof n.getChildContext!="function")return r;n=n.getChildContext();for(var s in n)if(!(s in t))throw Error(ye(108,SC(e)||"Unknown",s));return Mt({},r,n)}function mh(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||ri,ji=Br.current,wt(Br,e),wt(un,un.current),!0}function I1(e,t,r){var n=e.stateNode;if(!n)throw Error(ye(169));r?(e=o2(e,t,ji),n.__reactInternalMemoizedMergedChildContext=e,Rt(un),Rt(Br),wt(Br,e)):Rt(un),wt(un,r)}var Hs=null,vd=!1,I0=!1;function l2(e){Hs===null?Hs=[e]:Hs.push(e)}function z4(e){vd=!0,l2(e)}function hi(){if(!I0&&Hs!==null){I0=!0;var e=0,t=pt;try{var r=Hs;for(pt=1;e<r.length;e++){var n=r[e];do n=n(!0);while(n!==null)}Hs=null,vd=!1}catch(s){throw Hs!==null&&(Hs=Hs.slice(e+1)),DE(tg,hi),s}finally{pt=t,I0=!1}}return null}var No=[],bo=0,ph=null,gh=0,On=[],Mn=0,Vi=null,Gs=1,Ks="";function _i(e,t){No[bo++]=gh,No[bo++]=ph,ph=e,gh=t}function c2(e,t,r){On[Mn++]=Gs,On[Mn++]=Ks,On[Mn++]=Vi,Vi=e;var n=Gs;e=Ks;var s=32-as(n)-1;n&=~(1<<s),r+=1;var a=32-as(t)+s;if(30<a){var i=s-s%5;a=(n&(1<<i)-1).toString(32),n>>=i,s-=i,Gs=1<<32-as(t)+s|r<<s|n,Ks=a+e}else Gs=1<<a|r<<s|n,Ks=e}function ug(e){e.return!==null&&(_i(e,1),c2(e,1,0))}function fg(e){for(;e===ph;)ph=No[--bo],No[bo]=null,gh=No[--bo],No[bo]=null;for(;e===Vi;)Vi=On[--Mn],On[Mn]=null,Ks=On[--Mn],On[Mn]=null,Gs=On[--Mn],On[Mn]=null}var Tn=null,wn=null,Pt=!1,Zn=null;function u2(e,t){var r=Ln(5,null,null,0);r.elementType="DELETED",r.stateNode=t,r.return=e,t=e.deletions,t===null?(e.deletions=[r],e.flags|=16):t.push(r)}function C1(e,t){switch(e.tag){case 5:var r=e.type;return t=t.nodeType!==1||r.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,Tn=e,wn=Ga(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,Tn=e,wn=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(r=Vi!==null?{id:Gs,overflow:Ks}:null,e.memoizedState={dehydrated:t,treeContext:r,retryLane:1073741824},r=Ln(18,null,null,0),r.stateNode=t,r.return=e,e.child=r,Tn=e,wn=null,!0):!1;default:return!1}}function Om(e){return(e.mode&1)!==0&&(e.flags&128)===0}function Mm(e){if(Pt){var t=wn;if(t){var r=t;if(!C1(e,t)){if(Om(e))throw Error(ye(418));t=Ga(r.nextSibling);var n=Tn;t&&C1(e,t)?u2(n,r):(e.flags=e.flags&-4097|2,Pt=!1,Tn=e)}}else{if(Om(e))throw Error(ye(418));e.flags=e.flags&-4097|2,Pt=!1,Tn=e}}}function R1(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;Tn=e}function df(e){if(e!==Tn)return!1;if(!Pt)return R1(e),Pt=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!bm(e.type,e.memoizedProps)),t&&(t=wn)){if(Om(e))throw f2(),Error(ye(418));for(;t;)u2(e,t),t=Ga(t.nextSibling)}if(R1(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(ye(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="/$"){if(t===0){wn=Ga(e.nextSibling);break e}t--}else r!=="$"&&r!=="$!"&&r!=="$?"||t++}e=e.nextSibling}wn=null}}else wn=Tn?Ga(e.stateNode.nextSibling):null;return!0}function f2(){for(var e=wn;e;)e=Ga(e.nextSibling)}function Jo(){wn=Tn=null,Pt=!1}function hg(e){Zn===null?Zn=[e]:Zn.push(e)}var $4=va.ReactCurrentBatchConfig;function Bl(e,t,r){if(e=r.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(r._owner){if(r=r._owner,r){if(r.tag!==1)throw Error(ye(309));var n=r.stateNode}if(!n)throw Error(ye(147,e));var s=n,a=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===a?t.ref:(t=function(i){var o=s.refs;i===null?delete o[a]:o[a]=i},t._stringRef=a,t)}if(typeof e!="string")throw Error(ye(284));if(!r._owner)throw Error(ye(290,e))}return e}function mf(e,t){throw e=Object.prototype.toString.call(t),Error(ye(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function N1(e){var t=e._init;return t(e._payload)}function h2(e){function t(k,T){if(e){var E=k.deletions;E===null?(k.deletions=[T],k.flags|=16):E.push(T)}}function r(k,T){if(!e)return null;for(;T!==null;)t(k,T),T=T.sibling;return null}function n(k,T){for(k=new Map;T!==null;)T.key!==null?k.set(T.key,T):k.set(T.index,T),T=T.sibling;return k}function s(k,T){return k=Ya(k,T),k.index=0,k.sibling=null,k}function a(k,T,E){return k.index=E,e?(E=k.alternate,E!==null?(E=E.index,E<T?(k.flags|=2,T):E):(k.flags|=2,T)):(k.flags|=1048576,T)}function i(k){return e&&k.alternate===null&&(k.flags|=2),k}function o(k,T,E,N){return T===null||T.tag!==6?(T=F0(E,k.mode,N),T.return=k,T):(T=s(T,E),T.return=k,T)}function l(k,T,E,N){var O=E.type;return O===ko?u(k,T,E.props.children,N,E.key):T!==null&&(T.elementType===O||typeof O=="object"&&O!==null&&O.$$typeof===Ra&&N1(O)===T.type)?(N=s(T,E.props),N.ref=Bl(k,T,E),N.return=k,N):(N=Gf(E.type,E.key,E.props,null,k.mode,N),N.ref=Bl(k,T,E),N.return=k,N)}function c(k,T,E,N){return T===null||T.tag!==4||T.stateNode.containerInfo!==E.containerInfo||T.stateNode.implementation!==E.implementation?(T=O0(E,k.mode,N),T.return=k,T):(T=s(T,E.children||[]),T.return=k,T)}function u(k,T,E,N,O){return T===null||T.tag!==7?(T=Di(E,k.mode,N,O),T.return=k,T):(T=s(T,E),T.return=k,T)}function h(k,T,E){if(typeof T=="string"&&T!==""||typeof T=="number")return T=F0(""+T,k.mode,E),T.return=k,T;if(typeof T=="object"&&T!==null){switch(T.$$typeof){case rf:return E=Gf(T.type,T.key,T.props,null,k.mode,E),E.ref=Bl(k,null,T),E.return=k,E;case To:return T=O0(T,k.mode,E),T.return=k,T;case Ra:var N=T._init;return h(k,N(T._payload),E)}if(Xl(T)||Ml(T))return T=Di(T,k.mode,E,null),T.return=k,T;mf(k,T)}return null}function m(k,T,E,N){var O=T!==null?T.key:null;if(typeof E=="string"&&E!==""||typeof E=="number")return O!==null?null:o(k,T,""+E,N);if(typeof E=="object"&&E!==null){switch(E.$$typeof){case rf:return E.key===O?l(k,T,E,N):null;case To:return E.key===O?c(k,T,E,N):null;case Ra:return O=E._init,m(k,T,O(E._payload),N)}if(Xl(E)||Ml(E))return O!==null?null:u(k,T,E,N,null);mf(k,E)}return null}function p(k,T,E,N,O){if(typeof N=="string"&&N!==""||typeof N=="number")return k=k.get(E)||null,o(T,k,""+N,O);if(typeof N=="object"&&N!==null){switch(N.$$typeof){case rf:return k=k.get(N.key===null?E:N.key)||null,l(T,k,N,O);case To:return k=k.get(N.key===null?E:N.key)||null,c(T,k,N,O);case Ra:var L=N._init;return p(k,T,E,L(N._payload),O)}if(Xl(N)||Ml(N))return k=k.get(E)||null,u(T,k,N,O,null);mf(T,N)}return null}function x(k,T,E,N){for(var O=null,L=null,g=T,y=T=0,S=null;g!==null&&y<E.length;y++){g.index>y?(S=g,g=null):S=g.sibling;var R=m(k,g,E[y],N);if(R===null){g===null&&(g=S);break}e&&g&&R.alternate===null&&t(k,g),T=a(R,T,y),L===null?O=R:L.sibling=R,L=R,g=S}if(y===E.length)return r(k,g),Pt&&_i(k,y),O;if(g===null){for(;y<E.length;y++)g=h(k,E[y],N),g!==null&&(T=a(g,T,y),L===null?O=g:L.sibling=g,L=g);return Pt&&_i(k,y),O}for(g=n(k,g);y<E.length;y++)S=p(g,k,y,E[y],N),S!==null&&(e&&S.alternate!==null&&g.delete(S.key===null?y:S.key),T=a(S,T,y),L===null?O=S:L.sibling=S,L=S);return e&&g.forEach(function(b){return t(k,b)}),Pt&&_i(k,y),O}function v(k,T,E,N){var O=Ml(E);if(typeof O!="function")throw Error(ye(150));if(E=O.call(E),E==null)throw Error(ye(151));for(var L=O=null,g=T,y=T=0,S=null,R=E.next();g!==null&&!R.done;y++,R=E.next()){g.index>y?(S=g,g=null):S=g.sibling;var b=m(k,g,R.value,N);if(b===null){g===null&&(g=S);break}e&&g&&b.alternate===null&&t(k,g),T=a(b,T,y),L===null?O=b:L.sibling=b,L=b,g=S}if(R.done)return r(k,g),Pt&&_i(k,y),O;if(g===null){for(;!R.done;y++,R=E.next())R=h(k,R.value,N),R!==null&&(T=a(R,T,y),L===null?O=R:L.sibling=R,L=R);return Pt&&_i(k,y),O}for(g=n(k,g);!R.done;y++,R=E.next())R=p(g,k,y,R.value,N),R!==null&&(e&&R.alternate!==null&&g.delete(R.key===null?y:R.key),T=a(R,T,y),L===null?O=R:L.sibling=R,L=R);return e&&g.forEach(function(P){return t(k,P)}),Pt&&_i(k,y),O}function w(k,T,E,N){if(typeof E=="object"&&E!==null&&E.type===ko&&E.key===null&&(E=E.props.children),typeof E=="object"&&E!==null){switch(E.$$typeof){case rf:e:{for(var O=E.key,L=T;L!==null;){if(L.key===O){if(O=E.type,O===ko){if(L.tag===7){r(k,L.sibling),T=s(L,E.props.children),T.return=k,k=T;break e}}else if(L.elementType===O||typeof O=="object"&&O!==null&&O.$$typeof===Ra&&N1(O)===L.type){r(k,L.sibling),T=s(L,E.props),T.ref=Bl(k,L,E),T.return=k,k=T;break e}r(k,L);break}else t(k,L);L=L.sibling}E.type===ko?(T=Di(E.props.children,k.mode,N,E.key),T.return=k,k=T):(N=Gf(E.type,E.key,E.props,null,k.mode,N),N.ref=Bl(k,T,E),N.return=k,k=N)}return i(k);case To:e:{for(L=E.key;T!==null;){if(T.key===L)if(T.tag===4&&T.stateNode.containerInfo===E.containerInfo&&T.stateNode.implementation===E.implementation){r(k,T.sibling),T=s(T,E.children||[]),T.return=k,k=T;break e}else{r(k,T);break}else t(k,T);T=T.sibling}T=O0(E,k.mode,N),T.return=k,k=T}return i(k);case Ra:return L=E._init,w(k,T,L(E._payload),N)}if(Xl(E))return x(k,T,E,N);if(Ml(E))return v(k,T,E,N);mf(k,E)}return typeof E=="string"&&E!==""||typeof E=="number"?(E=""+E,T!==null&&T.tag===6?(r(k,T.sibling),T=s(T,E),T.return=k,k=T):(r(k,T),T=F0(E,k.mode,N),T.return=k,k=T),i(k)):r(k,T)}return w}var Zo=h2(!0),d2=h2(!1),vh=fi(null),xh=null,Po=null,dg=null;function mg(){dg=Po=xh=null}function pg(e){var t=vh.current;Rt(vh),e._currentValue=t}function Lm(e,t,r){for(;e!==null;){var n=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,n!==null&&(n.childLanes|=t)):n!==null&&(n.childLanes&t)!==t&&(n.childLanes|=t),e===r)break;e=e.return}}function Uo(e,t){xh=e,dg=Po=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(cn=!0),e.firstContext=null)}function Bn(e){var t=e._currentValue;if(dg!==e)if(e={context:e,memoizedValue:t,next:null},Po===null){if(xh===null)throw Error(ye(308));Po=e,xh.dependencies={lanes:0,firstContext:e}}else Po=Po.next=e;return t}var Ai=null;function gg(e){Ai===null?Ai=[e]:Ai.push(e)}function m2(e,t,r,n){var s=t.interleaved;return s===null?(r.next=r,gg(t)):(r.next=s.next,s.next=r),t.interleaved=r,oa(e,n)}function oa(e,t){e.lanes|=t;var r=e.alternate;for(r!==null&&(r.lanes|=t),r=e,e=e.return;e!==null;)e.childLanes|=t,r=e.alternate,r!==null&&(r.childLanes|=t),r=e,e=e.return;return r.tag===3?r.stateNode:null}var Na=!1;function vg(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function p2(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function Zs(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function Ka(e,t,r){var n=e.updateQueue;if(n===null)return null;if(n=n.shared,at&2){var s=n.pending;return s===null?t.next=t:(t.next=s.next,s.next=t),n.pending=t,oa(e,r)}return s=n.interleaved,s===null?(t.next=t,gg(n)):(t.next=s.next,s.next=t),n.interleaved=t,oa(e,r)}function Uf(e,t,r){if(t=t.updateQueue,t!==null&&(t=t.shared,(r&4194240)!==0)){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,rg(e,r)}}function b1(e,t){var r=e.updateQueue,n=e.alternate;if(n!==null&&(n=n.updateQueue,r===n)){var s=null,a=null;if(r=r.firstBaseUpdate,r!==null){do{var i={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};a===null?s=a=i:a=a.next=i,r=r.next}while(r!==null);a===null?s=a=t:a=a.next=t}else s=a=t;r={baseState:n.baseState,firstBaseUpdate:s,lastBaseUpdate:a,shared:n.shared,effects:n.effects},e.updateQueue=r;return}e=r.lastBaseUpdate,e===null?r.firstBaseUpdate=t:e.next=t,r.lastBaseUpdate=t}function _h(e,t,r,n){var s=e.updateQueue;Na=!1;var a=s.firstBaseUpdate,i=s.lastBaseUpdate,o=s.shared.pending;if(o!==null){s.shared.pending=null;var l=o,c=l.next;l.next=null,i===null?a=c:i.next=c,i=l;var u=e.alternate;u!==null&&(u=u.updateQueue,o=u.lastBaseUpdate,o!==i&&(o===null?u.firstBaseUpdate=c:o.next=c,u.lastBaseUpdate=l))}if(a!==null){var h=s.baseState;i=0,u=c=l=null,o=a;do{var m=o.lane,p=o.eventTime;if((n&m)===m){u!==null&&(u=u.next={eventTime:p,lane:0,tag:o.tag,payload:o.payload,callback:o.callback,next:null});e:{var x=e,v=o;switch(m=t,p=r,v.tag){case 1:if(x=v.payload,typeof x=="function"){h=x.call(p,h,m);break e}h=x;break e;case 3:x.flags=x.flags&-65537|128;case 0:if(x=v.payload,m=typeof x=="function"?x.call(p,h,m):x,m==null)break e;h=Mt({},h,m);break e;case 2:Na=!0}}o.callback!==null&&o.lane!==0&&(e.flags|=64,m=s.effects,m===null?s.effects=[o]:m.push(o))}else p={eventTime:p,lane:m,tag:o.tag,payload:o.payload,callback:o.callback,next:null},u===null?(c=u=p,l=h):u=u.next=p,i|=m;if(o=o.next,o===null){if(o=s.shared.pending,o===null)break;m=o,o=m.next,m.next=null,s.lastBaseUpdate=m,s.shared.pending=null}}while(!0);if(u===null&&(l=h),s.baseState=l,s.firstBaseUpdate=c,s.lastBaseUpdate=u,t=s.shared.interleaved,t!==null){s=t;do i|=s.lane,s=s.next;while(s!==t)}else a===null&&(s.shared.lanes=0);Bi|=i,e.lanes=i,e.memoizedState=h}}function P1(e,t,r){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var n=e[t],s=n.callback;if(s!==null){if(n.callback=null,n=r,typeof s!="function")throw Error(ye(191,s));s.call(n)}}}var _u={},Ts=fi(_u),zc=fi(_u),$c=fi(_u);function Ii(e){if(e===_u)throw Error(ye(174));return e}function xg(e,t){switch(wt($c,t),wt(zc,e),wt(Ts,_u),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:vm(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=vm(t,e)}Rt(Ts),wt(Ts,t)}function el(){Rt(Ts),Rt(zc),Rt($c)}function g2(e){Ii($c.current);var t=Ii(Ts.current),r=vm(t,e.type);t!==r&&(wt(zc,e),wt(Ts,r))}function _g(e){zc.current===e&&(Rt(Ts),Rt(zc))}var Ft=fi(0);function yh(e){for(var t=e;t!==null;){if(t.tag===13){var r=t.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||r.data==="$?"||r.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var C0=[];function yg(){for(var e=0;e<C0.length;e++)C0[e]._workInProgressVersionPrimary=null;C0.length=0}var Bf=va.ReactCurrentDispatcher,R0=va.ReactCurrentBatchConfig,Ui=0,Ot=null,rr=null,fr=null,wh=!1,hc=!1,Wc=0,W4=0;function Rr(){throw Error(ye(321))}function wg(e,t){if(t===null)return!1;for(var r=0;r<t.length&&r<e.length;r++)if(!cs(e[r],t[r]))return!1;return!0}function Eg(e,t,r,n,s,a){if(Ui=a,Ot=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,Bf.current=e===null||e.memoizedState===null?q4:X4,e=r(n,s),hc){a=0;do{if(hc=!1,Wc=0,25<=a)throw Error(ye(301));a+=1,fr=rr=null,t.updateQueue=null,Bf.current=Y4,e=r(n,s)}while(hc)}if(Bf.current=Eh,t=rr!==null&&rr.next!==null,Ui=0,fr=rr=Ot=null,wh=!1,t)throw Error(ye(300));return e}function Tg(){var e=Wc!==0;return Wc=0,e}function xs(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return fr===null?Ot.memoizedState=fr=e:fr=fr.next=e,fr}function zn(){if(rr===null){var e=Ot.alternate;e=e!==null?e.memoizedState:null}else e=rr.next;var t=fr===null?Ot.memoizedState:fr.next;if(t!==null)fr=t,rr=e;else{if(e===null)throw Error(ye(310));rr=e,e={memoizedState:rr.memoizedState,baseState:rr.baseState,baseQueue:rr.baseQueue,queue:rr.queue,next:null},fr===null?Ot.memoizedState=fr=e:fr=fr.next=e}return fr}function Hc(e,t){return typeof t=="function"?t(e):t}function N0(e){var t=zn(),r=t.queue;if(r===null)throw Error(ye(311));r.lastRenderedReducer=e;var n=rr,s=n.baseQueue,a=r.pending;if(a!==null){if(s!==null){var i=s.next;s.next=a.next,a.next=i}n.baseQueue=s=a,r.pending=null}if(s!==null){a=s.next,n=n.baseState;var o=i=null,l=null,c=a;do{var u=c.lane;if((Ui&u)===u)l!==null&&(l=l.next={lane:0,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null}),n=c.hasEagerState?c.eagerState:e(n,c.action);else{var h={lane:u,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null};l===null?(o=l=h,i=n):l=l.next=h,Ot.lanes|=u,Bi|=u}c=c.next}while(c!==null&&c!==a);l===null?i=n:l.next=o,cs(n,t.memoizedState)||(cn=!0),t.memoizedState=n,t.baseState=i,t.baseQueue=l,r.lastRenderedState=n}if(e=r.interleaved,e!==null){s=e;do a=s.lane,Ot.lanes|=a,Bi|=a,s=s.next;while(s!==e)}else s===null&&(r.lanes=0);return[t.memoizedState,r.dispatch]}function b0(e){var t=zn(),r=t.queue;if(r===null)throw Error(ye(311));r.lastRenderedReducer=e;var n=r.dispatch,s=r.pending,a=t.memoizedState;if(s!==null){r.pending=null;var i=s=s.next;do a=e(a,i.action),i=i.next;while(i!==s);cs(a,t.memoizedState)||(cn=!0),t.memoizedState=a,t.baseQueue===null&&(t.baseState=a),r.lastRenderedState=a}return[a,n]}function v2(){}function x2(e,t){var r=Ot,n=zn(),s=t(),a=!cs(n.memoizedState,s);if(a&&(n.memoizedState=s,cn=!0),n=n.queue,kg(w2.bind(null,r,n,e),[e]),n.getSnapshot!==t||a||fr!==null&&fr.memoizedState.tag&1){if(r.flags|=2048,Gc(9,y2.bind(null,r,n,s,t),void 0,null),hr===null)throw Error(ye(349));Ui&30||_2(r,t,s)}return s}function _2(e,t,r){e.flags|=16384,e={getSnapshot:t,value:r},t=Ot.updateQueue,t===null?(t={lastEffect:null,stores:null},Ot.updateQueue=t,t.stores=[e]):(r=t.stores,r===null?t.stores=[e]:r.push(e))}function y2(e,t,r,n){t.value=r,t.getSnapshot=n,E2(t)&&T2(e)}function w2(e,t,r){return r(function(){E2(t)&&T2(e)})}function E2(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!cs(e,r)}catch{return!0}}function T2(e){var t=oa(e,1);t!==null&&is(t,e,1,-1)}function D1(e){var t=xs();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Hc,lastRenderedState:e},t.queue=e,e=e.dispatch=K4.bind(null,Ot,e),[t.memoizedState,e]}function Gc(e,t,r,n){return e={tag:e,create:t,destroy:r,deps:n,next:null},t=Ot.updateQueue,t===null?(t={lastEffect:null,stores:null},Ot.updateQueue=t,t.lastEffect=e.next=e):(r=t.lastEffect,r===null?t.lastEffect=e.next=e:(n=r.next,r.next=e,e.next=n,t.lastEffect=e)),e}function k2(){return zn().memoizedState}function zf(e,t,r,n){var s=xs();Ot.flags|=e,s.memoizedState=Gc(1|t,r,void 0,n===void 0?null:n)}function xd(e,t,r,n){var s=zn();n=n===void 0?null:n;var a=void 0;if(rr!==null){var i=rr.memoizedState;if(a=i.destroy,n!==null&&wg(n,i.deps)){s.memoizedState=Gc(t,r,a,n);return}}Ot.flags|=e,s.memoizedState=Gc(1|t,r,a,n)}function F1(e,t){return zf(8390656,8,e,t)}function kg(e,t){return xd(2048,8,e,t)}function S2(e,t){return xd(4,2,e,t)}function A2(e,t){return xd(4,4,e,t)}function I2(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function C2(e,t,r){return r=r!=null?r.concat([e]):null,xd(4,4,I2.bind(null,t,e),r)}function Sg(){}function R2(e,t){var r=zn();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&wg(t,n[1])?n[0]:(r.memoizedState=[e,t],e)}function N2(e,t){var r=zn();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&wg(t,n[1])?n[0]:(e=e(),r.memoizedState=[e,t],e)}function b2(e,t,r){return Ui&21?(cs(r,t)||(r=ME(),Ot.lanes|=r,Bi|=r,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,cn=!0),e.memoizedState=r)}function H4(e,t){var r=pt;pt=r!==0&&4>r?r:4,e(!0);var n=R0.transition;R0.transition={};try{e(!1),t()}finally{pt=r,R0.transition=n}}function P2(){return zn().memoizedState}function G4(e,t,r){var n=Xa(e);if(r={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null},D2(e))F2(t,r);else if(r=m2(e,t,r,n),r!==null){var s=Xr();is(r,e,n,s),O2(r,t,n)}}function K4(e,t,r){var n=Xa(e),s={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null};if(D2(e))F2(t,s);else{var a=e.alternate;if(e.lanes===0&&(a===null||a.lanes===0)&&(a=t.lastRenderedReducer,a!==null))try{var i=t.lastRenderedState,o=a(i,r);if(s.hasEagerState=!0,s.eagerState=o,cs(o,i)){var l=t.interleaved;l===null?(s.next=s,gg(t)):(s.next=l.next,l.next=s),t.interleaved=s;return}}catch{}finally{}r=m2(e,t,s,n),r!==null&&(s=Xr(),is(r,e,n,s),O2(r,t,n))}}function D2(e){var t=e.alternate;return e===Ot||t!==null&&t===Ot}function F2(e,t){hc=wh=!0;var r=e.pending;r===null?t.next=t:(t.next=r.next,r.next=t),e.pending=t}function O2(e,t,r){if(r&4194240){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,rg(e,r)}}var Eh={readContext:Bn,useCallback:Rr,useContext:Rr,useEffect:Rr,useImperativeHandle:Rr,useInsertionEffect:Rr,useLayoutEffect:Rr,useMemo:Rr,useReducer:Rr,useRef:Rr,useState:Rr,useDebugValue:Rr,useDeferredValue:Rr,useTransition:Rr,useMutableSource:Rr,useSyncExternalStore:Rr,useId:Rr,unstable_isNewReconciler:!1},q4={readContext:Bn,useCallback:function(e,t){return xs().memoizedState=[e,t===void 0?null:t],e},useContext:Bn,useEffect:F1,useImperativeHandle:function(e,t,r){return r=r!=null?r.concat([e]):null,zf(4194308,4,I2.bind(null,t,e),r)},useLayoutEffect:function(e,t){return zf(4194308,4,e,t)},useInsertionEffect:function(e,t){return zf(4,2,e,t)},useMemo:function(e,t){var r=xs();return t=t===void 0?null:t,e=e(),r.memoizedState=[e,t],e},useReducer:function(e,t,r){var n=xs();return t=r!==void 0?r(t):t,n.memoizedState=n.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},n.queue=e,e=e.dispatch=G4.bind(null,Ot,e),[n.memoizedState,e]},useRef:function(e){var t=xs();return e={current:e},t.memoizedState=e},useState:D1,useDebugValue:Sg,useDeferredValue:function(e){return xs().memoizedState=e},useTransition:function(){var e=D1(!1),t=e[0];return e=H4.bind(null,e[1]),xs().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,r){var n=Ot,s=xs();if(Pt){if(r===void 0)throw Error(ye(407));r=r()}else{if(r=t(),hr===null)throw Error(ye(349));Ui&30||_2(n,t,r)}s.memoizedState=r;var a={value:r,getSnapshot:t};return s.queue=a,F1(w2.bind(null,n,a,e),[e]),n.flags|=2048,Gc(9,y2.bind(null,n,a,r,t),void 0,null),r},useId:function(){var e=xs(),t=hr.identifierPrefix;if(Pt){var r=Ks,n=Gs;r=(n&~(1<<32-as(n)-1)).toString(32)+r,t=":"+t+"R"+r,r=Wc++,0<r&&(t+="H"+r.toString(32)),t+=":"}else r=W4++,t=":"+t+"r"+r.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},X4={readContext:Bn,useCallback:R2,useContext:Bn,useEffect:kg,useImperativeHandle:C2,useInsertionEffect:S2,useLayoutEffect:A2,useMemo:N2,useReducer:N0,useRef:k2,useState:function(){return N0(Hc)},useDebugValue:Sg,useDeferredValue:function(e){var t=zn();return b2(t,rr.memoizedState,e)},useTransition:function(){var e=N0(Hc)[0],t=zn().memoizedState;return[e,t]},useMutableSource:v2,useSyncExternalStore:x2,useId:P2,unstable_isNewReconciler:!1},Y4={readContext:Bn,useCallback:R2,useContext:Bn,useEffect:kg,useImperativeHandle:C2,useInsertionEffect:S2,useLayoutEffect:A2,useMemo:N2,useReducer:b0,useRef:k2,useState:function(){return b0(Hc)},useDebugValue:Sg,useDeferredValue:function(e){var t=zn();return rr===null?t.memoizedState=e:b2(t,rr.memoizedState,e)},useTransition:function(){var e=b0(Hc)[0],t=zn().memoizedState;return[e,t]},useMutableSource:v2,useSyncExternalStore:x2,useId:P2,unstable_isNewReconciler:!1};function Yn(e,t){if(e&&e.defaultProps){t=Mt({},t),e=e.defaultProps;for(var r in e)t[r]===void 0&&(t[r]=e[r]);return t}return t}function jm(e,t,r,n){t=e.memoizedState,r=r(n,t),r=r==null?t:Mt({},t,r),e.memoizedState=r,e.lanes===0&&(e.updateQueue.baseState=r)}var _d={isMounted:function(e){return(e=e._reactInternals)?Ji(e)===e:!1},enqueueSetState:function(e,t,r){e=e._reactInternals;var n=Xr(),s=Xa(e),a=Zs(n,s);a.payload=t,r!=null&&(a.callback=r),t=Ka(e,a,s),t!==null&&(is(t,e,s,n),Uf(t,e,s))},enqueueReplaceState:function(e,t,r){e=e._reactInternals;var n=Xr(),s=Xa(e),a=Zs(n,s);a.tag=1,a.payload=t,r!=null&&(a.callback=r),t=Ka(e,a,s),t!==null&&(is(t,e,s,n),Uf(t,e,s))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var r=Xr(),n=Xa(e),s=Zs(r,n);s.tag=2,t!=null&&(s.callback=t),t=Ka(e,s,n),t!==null&&(is(t,e,n,r),Uf(t,e,n))}};function O1(e,t,r,n,s,a,i){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(n,a,i):t.prototype&&t.prototype.isPureReactComponent?!jc(r,n)||!jc(s,a):!0}function M2(e,t,r){var n=!1,s=ri,a=t.contextType;return typeof a=="object"&&a!==null?a=Bn(a):(s=fn(t)?ji:Br.current,n=t.contextTypes,a=(n=n!=null)?Qo(e,s):ri),t=new t(r,a),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=_d,e.stateNode=t,t._reactInternals=e,n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=s,e.__reactInternalMemoizedMaskedChildContext=a),t}function M1(e,t,r,n){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(r,n),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(r,n),t.state!==e&&_d.enqueueReplaceState(t,t.state,null)}function Vm(e,t,r,n){var s=e.stateNode;s.props=r,s.state=e.memoizedState,s.refs={},vg(e);var a=t.contextType;typeof a=="object"&&a!==null?s.context=Bn(a):(a=fn(t)?ji:Br.current,s.context=Qo(e,a)),s.state=e.memoizedState,a=t.getDerivedStateFromProps,typeof a=="function"&&(jm(e,t,a,r),s.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof s.getSnapshotBeforeUpdate=="function"||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(t=s.state,typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount(),t!==s.state&&_d.enqueueReplaceState(s,s.state,null),_h(e,r,s,n),s.state=e.memoizedState),typeof s.componentDidMount=="function"&&(e.flags|=4194308)}function tl(e,t){try{var r="",n=t;do r+=kC(n),n=n.return;while(n);var s=r}catch(a){s=`
Error generating stack: `+a.message+`
`+a.stack}return{value:e,source:t,stack:s,digest:null}}function P0(e,t,r){return{value:e,source:null,stack:r??null,digest:t??null}}function Um(e,t){try{console.error(t.value)}catch(r){setTimeout(function(){throw r})}}var Q4=typeof WeakMap=="function"?WeakMap:Map;function L2(e,t,r){r=Zs(-1,r),r.tag=3,r.payload={element:null};var n=t.value;return r.callback=function(){kh||(kh=!0,Ym=n),Um(e,t)},r}function j2(e,t,r){r=Zs(-1,r),r.tag=3;var n=e.type.getDerivedStateFromError;if(typeof n=="function"){var s=t.value;r.payload=function(){return n(s)},r.callback=function(){Um(e,t)}}var a=e.stateNode;return a!==null&&typeof a.componentDidCatch=="function"&&(r.callback=function(){Um(e,t),typeof n!="function"&&(qa===null?qa=new Set([this]):qa.add(this));var i=t.stack;this.componentDidCatch(t.value,{componentStack:i!==null?i:""})}),r}function L1(e,t,r){var n=e.pingCache;if(n===null){n=e.pingCache=new Q4;var s=new Set;n.set(t,s)}else s=n.get(t),s===void 0&&(s=new Set,n.set(t,s));s.has(r)||(s.add(r),e=fR.bind(null,e,t,r),t.then(e,e))}function j1(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function V1(e,t,r,n,s){return e.mode&1?(e.flags|=65536,e.lanes=s,e):(e===t?e.flags|=65536:(e.flags|=128,r.flags|=131072,r.flags&=-52805,r.tag===1&&(r.alternate===null?r.tag=17:(t=Zs(-1,1),t.tag=2,Ka(r,t,1))),r.lanes|=1),e)}var J4=va.ReactCurrentOwner,cn=!1;function Hr(e,t,r,n){t.child=e===null?d2(t,null,r,n):Zo(t,e.child,r,n)}function U1(e,t,r,n,s){r=r.render;var a=t.ref;return Uo(t,s),n=Eg(e,t,r,n,a,s),r=Tg(),e!==null&&!cn?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~s,la(e,t,s)):(Pt&&r&&ug(t),t.flags|=1,Hr(e,t,n,s),t.child)}function B1(e,t,r,n,s){if(e===null){var a=r.type;return typeof a=="function"&&!Dg(a)&&a.defaultProps===void 0&&r.compare===null&&r.defaultProps===void 0?(t.tag=15,t.type=a,V2(e,t,a,n,s)):(e=Gf(r.type,null,n,t,t.mode,s),e.ref=t.ref,e.return=t,t.child=e)}if(a=e.child,!(e.lanes&s)){var i=a.memoizedProps;if(r=r.compare,r=r!==null?r:jc,r(i,n)&&e.ref===t.ref)return la(e,t,s)}return t.flags|=1,e=Ya(a,n),e.ref=t.ref,e.return=t,t.child=e}function V2(e,t,r,n,s){if(e!==null){var a=e.memoizedProps;if(jc(a,n)&&e.ref===t.ref)if(cn=!1,t.pendingProps=n=a,(e.lanes&s)!==0)e.flags&131072&&(cn=!0);else return t.lanes=e.lanes,la(e,t,s)}return Bm(e,t,r,n,s)}function U2(e,t,r){var n=t.pendingProps,s=n.children,a=e!==null?e.memoizedState:null;if(n.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},wt(Fo,vn),vn|=r;else{if(!(r&1073741824))return e=a!==null?a.baseLanes|r:r,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,wt(Fo,vn),vn|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=a!==null?a.baseLanes:r,wt(Fo,vn),vn|=n}else a!==null?(n=a.baseLanes|r,t.memoizedState=null):n=r,wt(Fo,vn),vn|=n;return Hr(e,t,s,r),t.child}function B2(e,t){var r=t.ref;(e===null&&r!==null||e!==null&&e.ref!==r)&&(t.flags|=512,t.flags|=2097152)}function Bm(e,t,r,n,s){var a=fn(r)?ji:Br.current;return a=Qo(t,a),Uo(t,s),r=Eg(e,t,r,n,a,s),n=Tg(),e!==null&&!cn?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~s,la(e,t,s)):(Pt&&n&&ug(t),t.flags|=1,Hr(e,t,r,s),t.child)}function z1(e,t,r,n,s){if(fn(r)){var a=!0;mh(t)}else a=!1;if(Uo(t,s),t.stateNode===null)$f(e,t),M2(t,r,n),Vm(t,r,n,s),n=!0;else if(e===null){var i=t.stateNode,o=t.memoizedProps;i.props=o;var l=i.context,c=r.contextType;typeof c=="object"&&c!==null?c=Bn(c):(c=fn(r)?ji:Br.current,c=Qo(t,c));var u=r.getDerivedStateFromProps,h=typeof u=="function"||typeof i.getSnapshotBeforeUpdate=="function";h||typeof i.UNSAFE_componentWillReceiveProps!="function"&&typeof i.componentWillReceiveProps!="function"||(o!==n||l!==c)&&M1(t,i,n,c),Na=!1;var m=t.memoizedState;i.state=m,_h(t,n,i,s),l=t.memoizedState,o!==n||m!==l||un.current||Na?(typeof u=="function"&&(jm(t,r,u,n),l=t.memoizedState),(o=Na||O1(t,r,o,n,m,l,c))?(h||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount()),typeof i.componentDidMount=="function"&&(t.flags|=4194308)):(typeof i.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=n,t.memoizedState=l),i.props=n,i.state=l,i.context=c,n=o):(typeof i.componentDidMount=="function"&&(t.flags|=4194308),n=!1)}else{i=t.stateNode,p2(e,t),o=t.memoizedProps,c=t.type===t.elementType?o:Yn(t.type,o),i.props=c,h=t.pendingProps,m=i.context,l=r.contextType,typeof l=="object"&&l!==null?l=Bn(l):(l=fn(r)?ji:Br.current,l=Qo(t,l));var p=r.getDerivedStateFromProps;(u=typeof p=="function"||typeof i.getSnapshotBeforeUpdate=="function")||typeof i.UNSAFE_componentWillReceiveProps!="function"&&typeof i.componentWillReceiveProps!="function"||(o!==h||m!==l)&&M1(t,i,n,l),Na=!1,m=t.memoizedState,i.state=m,_h(t,n,i,s);var x=t.memoizedState;o!==h||m!==x||un.current||Na?(typeof p=="function"&&(jm(t,r,p,n),x=t.memoizedState),(c=Na||O1(t,r,c,n,m,x,l)||!1)?(u||typeof i.UNSAFE_componentWillUpdate!="function"&&typeof i.componentWillUpdate!="function"||(typeof i.componentWillUpdate=="function"&&i.componentWillUpdate(n,x,l),typeof i.UNSAFE_componentWillUpdate=="function"&&i.UNSAFE_componentWillUpdate(n,x,l)),typeof i.componentDidUpdate=="function"&&(t.flags|=4),typeof i.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof i.componentDidUpdate!="function"||o===e.memoizedProps&&m===e.memoizedState||(t.flags|=4),typeof i.getSnapshotBeforeUpdate!="function"||o===e.memoizedProps&&m===e.memoizedState||(t.flags|=1024),t.memoizedProps=n,t.memoizedState=x),i.props=n,i.state=x,i.context=l,n=c):(typeof i.componentDidUpdate!="function"||o===e.memoizedProps&&m===e.memoizedState||(t.flags|=4),typeof i.getSnapshotBeforeUpdate!="function"||o===e.memoizedProps&&m===e.memoizedState||(t.flags|=1024),n=!1)}return zm(e,t,r,n,a,s)}function zm(e,t,r,n,s,a){B2(e,t);var i=(t.flags&128)!==0;if(!n&&!i)return s&&I1(t,r,!1),la(e,t,a);n=t.stateNode,J4.current=t;var o=i&&typeof r.getDerivedStateFromError!="function"?null:n.render();return t.flags|=1,e!==null&&i?(t.child=Zo(t,e.child,null,a),t.child=Zo(t,null,o,a)):Hr(e,t,o,a),t.memoizedState=n.state,s&&I1(t,r,!0),t.child}function z2(e){var t=e.stateNode;t.pendingContext?A1(e,t.pendingContext,t.pendingContext!==t.context):t.context&&A1(e,t.context,!1),xg(e,t.containerInfo)}function $1(e,t,r,n,s){return Jo(),hg(s),t.flags|=256,Hr(e,t,r,n),t.child}var $m={dehydrated:null,treeContext:null,retryLane:0};function Wm(e){return{baseLanes:e,cachePool:null,transitions:null}}function $2(e,t,r){var n=t.pendingProps,s=Ft.current,a=!1,i=(t.flags&128)!==0,o;if((o=i)||(o=e!==null&&e.memoizedState===null?!1:(s&2)!==0),o?(a=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(s|=1),wt(Ft,s&1),e===null)return Mm(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(i=n.children,e=n.fallback,a?(n=t.mode,a=t.child,i={mode:"hidden",children:i},!(n&1)&&a!==null?(a.childLanes=0,a.pendingProps=i):a=Ed(i,n,0,null),e=Di(e,n,r,null),a.return=t,e.return=t,a.sibling=e,t.child=a,t.child.memoizedState=Wm(r),t.memoizedState=$m,e):Ag(t,i));if(s=e.memoizedState,s!==null&&(o=s.dehydrated,o!==null))return Z4(e,t,i,n,o,s,r);if(a){a=n.fallback,i=t.mode,s=e.child,o=s.sibling;var l={mode:"hidden",children:n.children};return!(i&1)&&t.child!==s?(n=t.child,n.childLanes=0,n.pendingProps=l,t.deletions=null):(n=Ya(s,l),n.subtreeFlags=s.subtreeFlags&14680064),o!==null?a=Ya(o,a):(a=Di(a,i,r,null),a.flags|=2),a.return=t,n.return=t,n.sibling=a,t.child=n,n=a,a=t.child,i=e.child.memoizedState,i=i===null?Wm(r):{baseLanes:i.baseLanes|r,cachePool:null,transitions:i.transitions},a.memoizedState=i,a.childLanes=e.childLanes&~r,t.memoizedState=$m,n}return a=e.child,e=a.sibling,n=Ya(a,{mode:"visible",children:n.children}),!(t.mode&1)&&(n.lanes=r),n.return=t,n.sibling=null,e!==null&&(r=t.deletions,r===null?(t.deletions=[e],t.flags|=16):r.push(e)),t.child=n,t.memoizedState=null,n}function Ag(e,t){return t=Ed({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function pf(e,t,r,n){return n!==null&&hg(n),Zo(t,e.child,null,r),e=Ag(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function Z4(e,t,r,n,s,a,i){if(r)return t.flags&256?(t.flags&=-257,n=P0(Error(ye(422))),pf(e,t,i,n)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(a=n.fallback,s=t.mode,n=Ed({mode:"visible",children:n.children},s,0,null),a=Di(a,s,i,null),a.flags|=2,n.return=t,a.return=t,n.sibling=a,t.child=n,t.mode&1&&Zo(t,e.child,null,i),t.child.memoizedState=Wm(i),t.memoizedState=$m,a);if(!(t.mode&1))return pf(e,t,i,null);if(s.data==="$!"){if(n=s.nextSibling&&s.nextSibling.dataset,n)var o=n.dgst;return n=o,a=Error(ye(419)),n=P0(a,n,void 0),pf(e,t,i,n)}if(o=(i&e.childLanes)!==0,cn||o){if(n=hr,n!==null){switch(i&-i){case 4:s=2;break;case 16:s=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:s=32;break;case 536870912:s=268435456;break;default:s=0}s=s&(n.suspendedLanes|i)?0:s,s!==0&&s!==a.retryLane&&(a.retryLane=s,oa(e,s),is(n,e,s,-1))}return Pg(),n=P0(Error(ye(421))),pf(e,t,i,n)}return s.data==="$?"?(t.flags|=128,t.child=e.child,t=hR.bind(null,e),s._reactRetry=t,null):(e=a.treeContext,wn=Ga(s.nextSibling),Tn=t,Pt=!0,Zn=null,e!==null&&(On[Mn++]=Gs,On[Mn++]=Ks,On[Mn++]=Vi,Gs=e.id,Ks=e.overflow,Vi=t),t=Ag(t,n.children),t.flags|=4096,t)}function W1(e,t,r){e.lanes|=t;var n=e.alternate;n!==null&&(n.lanes|=t),Lm(e.return,t,r)}function D0(e,t,r,n,s){var a=e.memoizedState;a===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:n,tail:r,tailMode:s}:(a.isBackwards=t,a.rendering=null,a.renderingStartTime=0,a.last=n,a.tail=r,a.tailMode=s)}function W2(e,t,r){var n=t.pendingProps,s=n.revealOrder,a=n.tail;if(Hr(e,t,n.children,r),n=Ft.current,n&2)n=n&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&W1(e,r,t);else if(e.tag===19)W1(e,r,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}n&=1}if(wt(Ft,n),!(t.mode&1))t.memoizedState=null;else switch(s){case"forwards":for(r=t.child,s=null;r!==null;)e=r.alternate,e!==null&&yh(e)===null&&(s=r),r=r.sibling;r=s,r===null?(s=t.child,t.child=null):(s=r.sibling,r.sibling=null),D0(t,!1,s,r,a);break;case"backwards":for(r=null,s=t.child,t.child=null;s!==null;){if(e=s.alternate,e!==null&&yh(e)===null){t.child=s;break}e=s.sibling,s.sibling=r,r=s,s=e}D0(t,!0,r,null,a);break;case"together":D0(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function $f(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function la(e,t,r){if(e!==null&&(t.dependencies=e.dependencies),Bi|=t.lanes,!(r&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(ye(153));if(t.child!==null){for(e=t.child,r=Ya(e,e.pendingProps),t.child=r,r.return=t;e.sibling!==null;)e=e.sibling,r=r.sibling=Ya(e,e.pendingProps),r.return=t;r.sibling=null}return t.child}function eR(e,t,r){switch(t.tag){case 3:z2(t),Jo();break;case 5:g2(t);break;case 1:fn(t.type)&&mh(t);break;case 4:xg(t,t.stateNode.containerInfo);break;case 10:var n=t.type._context,s=t.memoizedProps.value;wt(vh,n._currentValue),n._currentValue=s;break;case 13:if(n=t.memoizedState,n!==null)return n.dehydrated!==null?(wt(Ft,Ft.current&1),t.flags|=128,null):r&t.child.childLanes?$2(e,t,r):(wt(Ft,Ft.current&1),e=la(e,t,r),e!==null?e.sibling:null);wt(Ft,Ft.current&1);break;case 19:if(n=(r&t.childLanes)!==0,e.flags&128){if(n)return W2(e,t,r);t.flags|=128}if(s=t.memoizedState,s!==null&&(s.rendering=null,s.tail=null,s.lastEffect=null),wt(Ft,Ft.current),n)break;return null;case 22:case 23:return t.lanes=0,U2(e,t,r)}return la(e,t,r)}var H2,Hm,G2,K2;H2=function(e,t){for(var r=t.child;r!==null;){if(r.tag===5||r.tag===6)e.appendChild(r.stateNode);else if(r.tag!==4&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===t)break;for(;r.sibling===null;){if(r.return===null||r.return===t)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};Hm=function(){};G2=function(e,t,r,n){var s=e.memoizedProps;if(s!==n){e=t.stateNode,Ii(Ts.current);var a=null;switch(r){case"input":s=dm(e,s),n=dm(e,n),a=[];break;case"select":s=Mt({},s,{value:void 0}),n=Mt({},n,{value:void 0}),a=[];break;case"textarea":s=gm(e,s),n=gm(e,n),a=[];break;default:typeof s.onClick!="function"&&typeof n.onClick=="function"&&(e.onclick=hh)}xm(r,n);var i;r=null;for(c in s)if(!n.hasOwnProperty(c)&&s.hasOwnProperty(c)&&s[c]!=null)if(c==="style"){var o=s[c];for(i in o)o.hasOwnProperty(i)&&(r||(r={}),r[i]="")}else c!=="dangerouslySetInnerHTML"&&c!=="children"&&c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&c!=="autoFocus"&&(bc.hasOwnProperty(c)?a||(a=[]):(a=a||[]).push(c,null));for(c in n){var l=n[c];if(o=s!=null?s[c]:void 0,n.hasOwnProperty(c)&&l!==o&&(l!=null||o!=null))if(c==="style")if(o){for(i in o)!o.hasOwnProperty(i)||l&&l.hasOwnProperty(i)||(r||(r={}),r[i]="");for(i in l)l.hasOwnProperty(i)&&o[i]!==l[i]&&(r||(r={}),r[i]=l[i])}else r||(a||(a=[]),a.push(c,r)),r=l;else c==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,o=o?o.__html:void 0,l!=null&&o!==l&&(a=a||[]).push(c,l)):c==="children"?typeof l!="string"&&typeof l!="number"||(a=a||[]).push(c,""+l):c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&(bc.hasOwnProperty(c)?(l!=null&&c==="onScroll"&&It("scroll",e),a||o===l||(a=[])):(a=a||[]).push(c,l))}r&&(a=a||[]).push("style",r);var c=a;(t.updateQueue=c)&&(t.flags|=4)}};K2=function(e,t,r,n){r!==n&&(t.flags|=4)};function zl(e,t){if(!Pt)switch(e.tailMode){case"hidden":t=e.tail;for(var r=null;t!==null;)t.alternate!==null&&(r=t),t=t.sibling;r===null?e.tail=null:r.sibling=null;break;case"collapsed":r=e.tail;for(var n=null;r!==null;)r.alternate!==null&&(n=r),r=r.sibling;n===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:n.sibling=null}}function Nr(e){var t=e.alternate!==null&&e.alternate.child===e.child,r=0,n=0;if(t)for(var s=e.child;s!==null;)r|=s.lanes|s.childLanes,n|=s.subtreeFlags&14680064,n|=s.flags&14680064,s.return=e,s=s.sibling;else for(s=e.child;s!==null;)r|=s.lanes|s.childLanes,n|=s.subtreeFlags,n|=s.flags,s.return=e,s=s.sibling;return e.subtreeFlags|=n,e.childLanes=r,t}function tR(e,t,r){var n=t.pendingProps;switch(fg(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Nr(t),null;case 1:return fn(t.type)&&dh(),Nr(t),null;case 3:return n=t.stateNode,el(),Rt(un),Rt(Br),yg(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(e===null||e.child===null)&&(df(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,Zn!==null&&(Zm(Zn),Zn=null))),Hm(e,t),Nr(t),null;case 5:_g(t);var s=Ii($c.current);if(r=t.type,e!==null&&t.stateNode!=null)G2(e,t,r,n,s),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!n){if(t.stateNode===null)throw Error(ye(166));return Nr(t),null}if(e=Ii(Ts.current),df(t)){n=t.stateNode,r=t.type;var a=t.memoizedProps;switch(n[_s]=t,n[Bc]=a,e=(t.mode&1)!==0,r){case"dialog":It("cancel",n),It("close",n);break;case"iframe":case"object":case"embed":It("load",n);break;case"video":case"audio":for(s=0;s<Ql.length;s++)It(Ql[s],n);break;case"source":It("error",n);break;case"img":case"image":case"link":It("error",n),It("load",n);break;case"details":It("toggle",n);break;case"input":Zx(n,a),It("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!a.multiple},It("invalid",n);break;case"textarea":t1(n,a),It("invalid",n)}xm(r,a),s=null;for(var i in a)if(a.hasOwnProperty(i)){var o=a[i];i==="children"?typeof o=="string"?n.textContent!==o&&(a.suppressHydrationWarning!==!0&&hf(n.textContent,o,e),s=["children",o]):typeof o=="number"&&n.textContent!==""+o&&(a.suppressHydrationWarning!==!0&&hf(n.textContent,o,e),s=["children",""+o]):bc.hasOwnProperty(i)&&o!=null&&i==="onScroll"&&It("scroll",n)}switch(r){case"input":nf(n),e1(n,a,!0);break;case"textarea":nf(n),r1(n);break;case"select":case"option":break;default:typeof a.onClick=="function"&&(n.onclick=hh)}n=s,t.updateQueue=n,n!==null&&(t.flags|=4)}else{i=s.nodeType===9?s:s.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=wE(r)),e==="http://www.w3.org/1999/xhtml"?r==="script"?(e=i.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof n.is=="string"?e=i.createElement(r,{is:n.is}):(e=i.createElement(r),r==="select"&&(i=e,n.multiple?i.multiple=!0:n.size&&(i.size=n.size))):e=i.createElementNS(e,r),e[_s]=t,e[Bc]=n,H2(e,t,!1,!1),t.stateNode=e;e:{switch(i=_m(r,n),r){case"dialog":It("cancel",e),It("close",e),s=n;break;case"iframe":case"object":case"embed":It("load",e),s=n;break;case"video":case"audio":for(s=0;s<Ql.length;s++)It(Ql[s],e);s=n;break;case"source":It("error",e),s=n;break;case"img":case"image":case"link":It("error",e),It("load",e),s=n;break;case"details":It("toggle",e),s=n;break;case"input":Zx(e,n),s=dm(e,n),It("invalid",e);break;case"option":s=n;break;case"select":e._wrapperState={wasMultiple:!!n.multiple},s=Mt({},n,{value:void 0}),It("invalid",e);break;case"textarea":t1(e,n),s=gm(e,n),It("invalid",e);break;default:s=n}xm(r,s),o=s;for(a in o)if(o.hasOwnProperty(a)){var l=o[a];a==="style"?kE(e,l):a==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&EE(e,l)):a==="children"?typeof l=="string"?(r!=="textarea"||l!=="")&&Pc(e,l):typeof l=="number"&&Pc(e,""+l):a!=="suppressContentEditableWarning"&&a!=="suppressHydrationWarning"&&a!=="autoFocus"&&(bc.hasOwnProperty(a)?l!=null&&a==="onScroll"&&It("scroll",e):l!=null&&Yp(e,a,l,i))}switch(r){case"input":nf(e),e1(e,n,!1);break;case"textarea":nf(e),r1(e);break;case"option":n.value!=null&&e.setAttribute("value",""+ti(n.value));break;case"select":e.multiple=!!n.multiple,a=n.value,a!=null?Mo(e,!!n.multiple,a,!1):n.defaultValue!=null&&Mo(e,!!n.multiple,n.defaultValue,!0);break;default:typeof s.onClick=="function"&&(e.onclick=hh)}switch(r){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}}n&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return Nr(t),null;case 6:if(e&&t.stateNode!=null)K2(e,t,e.memoizedProps,n);else{if(typeof n!="string"&&t.stateNode===null)throw Error(ye(166));if(r=Ii($c.current),Ii(Ts.current),df(t)){if(n=t.stateNode,r=t.memoizedProps,n[_s]=t,(a=n.nodeValue!==r)&&(e=Tn,e!==null))switch(e.tag){case 3:hf(n.nodeValue,r,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&hf(n.nodeValue,r,(e.mode&1)!==0)}a&&(t.flags|=4)}else n=(r.nodeType===9?r:r.ownerDocument).createTextNode(n),n[_s]=t,t.stateNode=n}return Nr(t),null;case 13:if(Rt(Ft),n=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(Pt&&wn!==null&&t.mode&1&&!(t.flags&128))f2(),Jo(),t.flags|=98560,a=!1;else if(a=df(t),n!==null&&n.dehydrated!==null){if(e===null){if(!a)throw Error(ye(318));if(a=t.memoizedState,a=a!==null?a.dehydrated:null,!a)throw Error(ye(317));a[_s]=t}else Jo(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;Nr(t),a=!1}else Zn!==null&&(Zm(Zn),Zn=null),a=!0;if(!a)return t.flags&65536?t:null}return t.flags&128?(t.lanes=r,t):(n=n!==null,n!==(e!==null&&e.memoizedState!==null)&&n&&(t.child.flags|=8192,t.mode&1&&(e===null||Ft.current&1?nr===0&&(nr=3):Pg())),t.updateQueue!==null&&(t.flags|=4),Nr(t),null);case 4:return el(),Hm(e,t),e===null&&Vc(t.stateNode.containerInfo),Nr(t),null;case 10:return pg(t.type._context),Nr(t),null;case 17:return fn(t.type)&&dh(),Nr(t),null;case 19:if(Rt(Ft),a=t.memoizedState,a===null)return Nr(t),null;if(n=(t.flags&128)!==0,i=a.rendering,i===null)if(n)zl(a,!1);else{if(nr!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(i=yh(e),i!==null){for(t.flags|=128,zl(a,!1),n=i.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),t.subtreeFlags=0,n=r,r=t.child;r!==null;)a=r,e=n,a.flags&=14680066,i=a.alternate,i===null?(a.childLanes=0,a.lanes=e,a.child=null,a.subtreeFlags=0,a.memoizedProps=null,a.memoizedState=null,a.updateQueue=null,a.dependencies=null,a.stateNode=null):(a.childLanes=i.childLanes,a.lanes=i.lanes,a.child=i.child,a.subtreeFlags=0,a.deletions=null,a.memoizedProps=i.memoizedProps,a.memoizedState=i.memoizedState,a.updateQueue=i.updateQueue,a.type=i.type,e=i.dependencies,a.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),r=r.sibling;return wt(Ft,Ft.current&1|2),t.child}e=e.sibling}a.tail!==null&&Wt()>rl&&(t.flags|=128,n=!0,zl(a,!1),t.lanes=4194304)}else{if(!n)if(e=yh(i),e!==null){if(t.flags|=128,n=!0,r=e.updateQueue,r!==null&&(t.updateQueue=r,t.flags|=4),zl(a,!0),a.tail===null&&a.tailMode==="hidden"&&!i.alternate&&!Pt)return Nr(t),null}else 2*Wt()-a.renderingStartTime>rl&&r!==1073741824&&(t.flags|=128,n=!0,zl(a,!1),t.lanes=4194304);a.isBackwards?(i.sibling=t.child,t.child=i):(r=a.last,r!==null?r.sibling=i:t.child=i,a.last=i)}return a.tail!==null?(t=a.tail,a.rendering=t,a.tail=t.sibling,a.renderingStartTime=Wt(),t.sibling=null,r=Ft.current,wt(Ft,n?r&1|2:r&1),t):(Nr(t),null);case 22:case 23:return bg(),n=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==n&&(t.flags|=8192),n&&t.mode&1?vn&1073741824&&(Nr(t),t.subtreeFlags&6&&(t.flags|=8192)):Nr(t),null;case 24:return null;case 25:return null}throw Error(ye(156,t.tag))}function rR(e,t){switch(fg(t),t.tag){case 1:return fn(t.type)&&dh(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return el(),Rt(un),Rt(Br),yg(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return _g(t),null;case 13:if(Rt(Ft),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(ye(340));Jo()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return Rt(Ft),null;case 4:return el(),null;case 10:return pg(t.type._context),null;case 22:case 23:return bg(),null;case 24:return null;default:return null}}var gf=!1,Or=!1,nR=typeof WeakSet=="function"?WeakSet:Set,Re=null;function Do(e,t){var r=e.ref;if(r!==null)if(typeof r=="function")try{r(null)}catch(n){Vt(e,t,n)}else r.current=null}function Gm(e,t,r){try{r()}catch(n){Vt(e,t,n)}}var H1=!1;function sR(e,t){if(Rm=ch,e=JE(),cg(e)){if("selectionStart"in e)var r={start:e.selectionStart,end:e.selectionEnd};else e:{r=(r=e.ownerDocument)&&r.defaultView||window;var n=r.getSelection&&r.getSelection();if(n&&n.rangeCount!==0){r=n.anchorNode;var s=n.anchorOffset,a=n.focusNode;n=n.focusOffset;try{r.nodeType,a.nodeType}catch{r=null;break e}var i=0,o=-1,l=-1,c=0,u=0,h=e,m=null;t:for(;;){for(var p;h!==r||s!==0&&h.nodeType!==3||(o=i+s),h!==a||n!==0&&h.nodeType!==3||(l=i+n),h.nodeType===3&&(i+=h.nodeValue.length),(p=h.firstChild)!==null;)m=h,h=p;for(;;){if(h===e)break t;if(m===r&&++c===s&&(o=i),m===a&&++u===n&&(l=i),(p=h.nextSibling)!==null)break;h=m,m=h.parentNode}h=p}r=o===-1||l===-1?null:{start:o,end:l}}else r=null}r=r||{start:0,end:0}}else r=null;for(Nm={focusedElem:e,selectionRange:r},ch=!1,Re=t;Re!==null;)if(t=Re,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,Re=e;else for(;Re!==null;){t=Re;try{var x=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(x!==null){var v=x.memoizedProps,w=x.memoizedState,k=t.stateNode,T=k.getSnapshotBeforeUpdate(t.elementType===t.type?v:Yn(t.type,v),w);k.__reactInternalSnapshotBeforeUpdate=T}break;case 3:var E=t.stateNode.containerInfo;E.nodeType===1?E.textContent="":E.nodeType===9&&E.documentElement&&E.removeChild(E.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(ye(163))}}catch(N){Vt(t,t.return,N)}if(e=t.sibling,e!==null){e.return=t.return,Re=e;break}Re=t.return}return x=H1,H1=!1,x}function dc(e,t,r){var n=t.updateQueue;if(n=n!==null?n.lastEffect:null,n!==null){var s=n=n.next;do{if((s.tag&e)===e){var a=s.destroy;s.destroy=void 0,a!==void 0&&Gm(t,r,a)}s=s.next}while(s!==n)}}function yd(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var r=t=t.next;do{if((r.tag&e)===e){var n=r.create;r.destroy=n()}r=r.next}while(r!==t)}}function Km(e){var t=e.ref;if(t!==null){var r=e.stateNode;switch(e.tag){case 5:e=r;break;default:e=r}typeof t=="function"?t(e):t.current=e}}function q2(e){var t=e.alternate;t!==null&&(e.alternate=null,q2(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[_s],delete t[Bc],delete t[Dm],delete t[U4],delete t[B4])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function X2(e){return e.tag===5||e.tag===3||e.tag===4}function G1(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||X2(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function qm(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.nodeType===8?r.parentNode.insertBefore(e,t):r.insertBefore(e,t):(r.nodeType===8?(t=r.parentNode,t.insertBefore(e,r)):(t=r,t.appendChild(e)),r=r._reactRootContainer,r!=null||t.onclick!==null||(t.onclick=hh));else if(n!==4&&(e=e.child,e!==null))for(qm(e,t,r),e=e.sibling;e!==null;)qm(e,t,r),e=e.sibling}function Xm(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.insertBefore(e,t):r.appendChild(e);else if(n!==4&&(e=e.child,e!==null))for(Xm(e,t,r),e=e.sibling;e!==null;)Xm(e,t,r),e=e.sibling}var gr=null,Qn=!1;function ka(e,t,r){for(r=r.child;r!==null;)Y2(e,t,r),r=r.sibling}function Y2(e,t,r){if(Es&&typeof Es.onCommitFiberUnmount=="function")try{Es.onCommitFiberUnmount(hd,r)}catch{}switch(r.tag){case 5:Or||Do(r,t);case 6:var n=gr,s=Qn;gr=null,ka(e,t,r),gr=n,Qn=s,gr!==null&&(Qn?(e=gr,r=r.stateNode,e.nodeType===8?e.parentNode.removeChild(r):e.removeChild(r)):gr.removeChild(r.stateNode));break;case 18:gr!==null&&(Qn?(e=gr,r=r.stateNode,e.nodeType===8?A0(e.parentNode,r):e.nodeType===1&&A0(e,r),Mc(e)):A0(gr,r.stateNode));break;case 4:n=gr,s=Qn,gr=r.stateNode.containerInfo,Qn=!0,ka(e,t,r),gr=n,Qn=s;break;case 0:case 11:case 14:case 15:if(!Or&&(n=r.updateQueue,n!==null&&(n=n.lastEffect,n!==null))){s=n=n.next;do{var a=s,i=a.destroy;a=a.tag,i!==void 0&&(a&2||a&4)&&Gm(r,t,i),s=s.next}while(s!==n)}ka(e,t,r);break;case 1:if(!Or&&(Do(r,t),n=r.stateNode,typeof n.componentWillUnmount=="function"))try{n.props=r.memoizedProps,n.state=r.memoizedState,n.componentWillUnmount()}catch(o){Vt(r,t,o)}ka(e,t,r);break;case 21:ka(e,t,r);break;case 22:r.mode&1?(Or=(n=Or)||r.memoizedState!==null,ka(e,t,r),Or=n):ka(e,t,r);break;default:ka(e,t,r)}}function K1(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var r=e.stateNode;r===null&&(r=e.stateNode=new nR),t.forEach(function(n){var s=dR.bind(null,e,n);r.has(n)||(r.add(n),n.then(s,s))})}}function Kn(e,t){var r=t.deletions;if(r!==null)for(var n=0;n<r.length;n++){var s=r[n];try{var a=e,i=t,o=i;e:for(;o!==null;){switch(o.tag){case 5:gr=o.stateNode,Qn=!1;break e;case 3:gr=o.stateNode.containerInfo,Qn=!0;break e;case 4:gr=o.stateNode.containerInfo,Qn=!0;break e}o=o.return}if(gr===null)throw Error(ye(160));Y2(a,i,s),gr=null,Qn=!1;var l=s.alternate;l!==null&&(l.return=null),s.return=null}catch(c){Vt(s,t,c)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)Q2(t,e),t=t.sibling}function Q2(e,t){var r=e.alternate,n=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(Kn(t,e),ps(e),n&4){try{dc(3,e,e.return),yd(3,e)}catch(v){Vt(e,e.return,v)}try{dc(5,e,e.return)}catch(v){Vt(e,e.return,v)}}break;case 1:Kn(t,e),ps(e),n&512&&r!==null&&Do(r,r.return);break;case 5:if(Kn(t,e),ps(e),n&512&&r!==null&&Do(r,r.return),e.flags&32){var s=e.stateNode;try{Pc(s,"")}catch(v){Vt(e,e.return,v)}}if(n&4&&(s=e.stateNode,s!=null)){var a=e.memoizedProps,i=r!==null?r.memoizedProps:a,o=e.type,l=e.updateQueue;if(e.updateQueue=null,l!==null)try{o==="input"&&a.type==="radio"&&a.name!=null&&_E(s,a),_m(o,i);var c=_m(o,a);for(i=0;i<l.length;i+=2){var u=l[i],h=l[i+1];u==="style"?kE(s,h):u==="dangerouslySetInnerHTML"?EE(s,h):u==="children"?Pc(s,h):Yp(s,u,h,c)}switch(o){case"input":mm(s,a);break;case"textarea":yE(s,a);break;case"select":var m=s._wrapperState.wasMultiple;s._wrapperState.wasMultiple=!!a.multiple;var p=a.value;p!=null?Mo(s,!!a.multiple,p,!1):m!==!!a.multiple&&(a.defaultValue!=null?Mo(s,!!a.multiple,a.defaultValue,!0):Mo(s,!!a.multiple,a.multiple?[]:"",!1))}s[Bc]=a}catch(v){Vt(e,e.return,v)}}break;case 6:if(Kn(t,e),ps(e),n&4){if(e.stateNode===null)throw Error(ye(162));s=e.stateNode,a=e.memoizedProps;try{s.nodeValue=a}catch(v){Vt(e,e.return,v)}}break;case 3:if(Kn(t,e),ps(e),n&4&&r!==null&&r.memoizedState.isDehydrated)try{Mc(t.containerInfo)}catch(v){Vt(e,e.return,v)}break;case 4:Kn(t,e),ps(e);break;case 13:Kn(t,e),ps(e),s=e.child,s.flags&8192&&(a=s.memoizedState!==null,s.stateNode.isHidden=a,!a||s.alternate!==null&&s.alternate.memoizedState!==null||(Rg=Wt())),n&4&&K1(e);break;case 22:if(u=r!==null&&r.memoizedState!==null,e.mode&1?(Or=(c=Or)||u,Kn(t,e),Or=c):Kn(t,e),ps(e),n&8192){if(c=e.memoizedState!==null,(e.stateNode.isHidden=c)&&!u&&e.mode&1)for(Re=e,u=e.child;u!==null;){for(h=Re=u;Re!==null;){switch(m=Re,p=m.child,m.tag){case 0:case 11:case 14:case 15:dc(4,m,m.return);break;case 1:Do(m,m.return);var x=m.stateNode;if(typeof x.componentWillUnmount=="function"){n=m,r=m.return;try{t=n,x.props=t.memoizedProps,x.state=t.memoizedState,x.componentWillUnmount()}catch(v){Vt(n,r,v)}}break;case 5:Do(m,m.return);break;case 22:if(m.memoizedState!==null){X1(h);continue}}p!==null?(p.return=m,Re=p):X1(h)}u=u.sibling}e:for(u=null,h=e;;){if(h.tag===5){if(u===null){u=h;try{s=h.stateNode,c?(a=s.style,typeof a.setProperty=="function"?a.setProperty("display","none","important"):a.display="none"):(o=h.stateNode,l=h.memoizedProps.style,i=l!=null&&l.hasOwnProperty("display")?l.display:null,o.style.display=TE("display",i))}catch(v){Vt(e,e.return,v)}}}else if(h.tag===6){if(u===null)try{h.stateNode.nodeValue=c?"":h.memoizedProps}catch(v){Vt(e,e.return,v)}}else if((h.tag!==22&&h.tag!==23||h.memoizedState===null||h===e)&&h.child!==null){h.child.return=h,h=h.child;continue}if(h===e)break e;for(;h.sibling===null;){if(h.return===null||h.return===e)break e;u===h&&(u=null),h=h.return}u===h&&(u=null),h.sibling.return=h.return,h=h.sibling}}break;case 19:Kn(t,e),ps(e),n&4&&K1(e);break;case 21:break;default:Kn(t,e),ps(e)}}function ps(e){var t=e.flags;if(t&2){try{e:{for(var r=e.return;r!==null;){if(X2(r)){var n=r;break e}r=r.return}throw Error(ye(160))}switch(n.tag){case 5:var s=n.stateNode;n.flags&32&&(Pc(s,""),n.flags&=-33);var a=G1(e);Xm(e,a,s);break;case 3:case 4:var i=n.stateNode.containerInfo,o=G1(e);qm(e,o,i);break;default:throw Error(ye(161))}}catch(l){Vt(e,e.return,l)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function aR(e,t,r){Re=e,J2(e)}function J2(e,t,r){for(var n=(e.mode&1)!==0;Re!==null;){var s=Re,a=s.child;if(s.tag===22&&n){var i=s.memoizedState!==null||gf;if(!i){var o=s.alternate,l=o!==null&&o.memoizedState!==null||Or;o=gf;var c=Or;if(gf=i,(Or=l)&&!c)for(Re=s;Re!==null;)i=Re,l=i.child,i.tag===22&&i.memoizedState!==null?Y1(s):l!==null?(l.return=i,Re=l):Y1(s);for(;a!==null;)Re=a,J2(a),a=a.sibling;Re=s,gf=o,Or=c}q1(e)}else s.subtreeFlags&8772&&a!==null?(a.return=s,Re=a):q1(e)}}function q1(e){for(;Re!==null;){var t=Re;if(t.flags&8772){var r=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:Or||yd(5,t);break;case 1:var n=t.stateNode;if(t.flags&4&&!Or)if(r===null)n.componentDidMount();else{var s=t.elementType===t.type?r.memoizedProps:Yn(t.type,r.memoizedProps);n.componentDidUpdate(s,r.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var a=t.updateQueue;a!==null&&P1(t,a,n);break;case 3:var i=t.updateQueue;if(i!==null){if(r=null,t.child!==null)switch(t.child.tag){case 5:r=t.child.stateNode;break;case 1:r=t.child.stateNode}P1(t,i,r)}break;case 5:var o=t.stateNode;if(r===null&&t.flags&4){r=o;var l=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&r.focus();break;case"img":l.src&&(r.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var c=t.alternate;if(c!==null){var u=c.memoizedState;if(u!==null){var h=u.dehydrated;h!==null&&Mc(h)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(ye(163))}Or||t.flags&512&&Km(t)}catch(m){Vt(t,t.return,m)}}if(t===e){Re=null;break}if(r=t.sibling,r!==null){r.return=t.return,Re=r;break}Re=t.return}}function X1(e){for(;Re!==null;){var t=Re;if(t===e){Re=null;break}var r=t.sibling;if(r!==null){r.return=t.return,Re=r;break}Re=t.return}}function Y1(e){for(;Re!==null;){var t=Re;try{switch(t.tag){case 0:case 11:case 15:var r=t.return;try{yd(4,t)}catch(l){Vt(t,r,l)}break;case 1:var n=t.stateNode;if(typeof n.componentDidMount=="function"){var s=t.return;try{n.componentDidMount()}catch(l){Vt(t,s,l)}}var a=t.return;try{Km(t)}catch(l){Vt(t,a,l)}break;case 5:var i=t.return;try{Km(t)}catch(l){Vt(t,i,l)}}}catch(l){Vt(t,t.return,l)}if(t===e){Re=null;break}var o=t.sibling;if(o!==null){o.return=t.return,Re=o;break}Re=t.return}}var iR=Math.ceil,Th=va.ReactCurrentDispatcher,Ig=va.ReactCurrentOwner,jn=va.ReactCurrentBatchConfig,at=0,hr=null,Jt=null,yr=0,vn=0,Fo=fi(0),nr=0,Kc=null,Bi=0,wd=0,Cg=0,mc=null,on=null,Rg=0,rl=1/0,Ws=null,kh=!1,Ym=null,qa=null,vf=!1,ja=null,Sh=0,pc=0,Qm=null,Wf=-1,Hf=0;function Xr(){return at&6?Wt():Wf!==-1?Wf:Wf=Wt()}function Xa(e){return e.mode&1?at&2&&yr!==0?yr&-yr:$4.transition!==null?(Hf===0&&(Hf=ME()),Hf):(e=pt,e!==0||(e=window.event,e=e===void 0?16:$E(e.type)),e):1}function is(e,t,r,n){if(50<pc)throw pc=0,Qm=null,Error(ye(185));gu(e,r,n),(!(at&2)||e!==hr)&&(e===hr&&(!(at&2)&&(wd|=r),nr===4&&Pa(e,yr)),hn(e,n),r===1&&at===0&&!(t.mode&1)&&(rl=Wt()+500,vd&&hi()))}function hn(e,t){var r=e.callbackNode;$C(e,t);var n=lh(e,e===hr?yr:0);if(n===0)r!==null&&a1(r),e.callbackNode=null,e.callbackPriority=0;else if(t=n&-n,e.callbackPriority!==t){if(r!=null&&a1(r),t===1)e.tag===0?z4(Q1.bind(null,e)):l2(Q1.bind(null,e)),j4(function(){!(at&6)&&hi()}),r=null;else{switch(LE(n)){case 1:r=tg;break;case 4:r=FE;break;case 16:r=oh;break;case 536870912:r=OE;break;default:r=oh}r=iT(r,Z2.bind(null,e))}e.callbackPriority=t,e.callbackNode=r}}function Z2(e,t){if(Wf=-1,Hf=0,at&6)throw Error(ye(327));var r=e.callbackNode;if(Bo()&&e.callbackNode!==r)return null;var n=lh(e,e===hr?yr:0);if(n===0)return null;if(n&30||n&e.expiredLanes||t)t=Ah(e,n);else{t=n;var s=at;at|=2;var a=tT();(hr!==e||yr!==t)&&(Ws=null,rl=Wt()+500,Pi(e,t));do try{cR();break}catch(o){eT(e,o)}while(!0);mg(),Th.current=a,at=s,Jt!==null?t=0:(hr=null,yr=0,t=nr)}if(t!==0){if(t===2&&(s=km(e),s!==0&&(n=s,t=Jm(e,s))),t===1)throw r=Kc,Pi(e,0),Pa(e,n),hn(e,Wt()),r;if(t===6)Pa(e,n);else{if(s=e.current.alternate,!(n&30)&&!oR(s)&&(t=Ah(e,n),t===2&&(a=km(e),a!==0&&(n=a,t=Jm(e,a))),t===1))throw r=Kc,Pi(e,0),Pa(e,n),hn(e,Wt()),r;switch(e.finishedWork=s,e.finishedLanes=n,t){case 0:case 1:throw Error(ye(345));case 2:yi(e,on,Ws);break;case 3:if(Pa(e,n),(n&130023424)===n&&(t=Rg+500-Wt(),10<t)){if(lh(e,0)!==0)break;if(s=e.suspendedLanes,(s&n)!==n){Xr(),e.pingedLanes|=e.suspendedLanes&s;break}e.timeoutHandle=Pm(yi.bind(null,e,on,Ws),t);break}yi(e,on,Ws);break;case 4:if(Pa(e,n),(n&4194240)===n)break;for(t=e.eventTimes,s=-1;0<n;){var i=31-as(n);a=1<<i,i=t[i],i>s&&(s=i),n&=~a}if(n=s,n=Wt()-n,n=(120>n?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*iR(n/1960))-n,10<n){e.timeoutHandle=Pm(yi.bind(null,e,on,Ws),n);break}yi(e,on,Ws);break;case 5:yi(e,on,Ws);break;default:throw Error(ye(329))}}}return hn(e,Wt()),e.callbackNode===r?Z2.bind(null,e):null}function Jm(e,t){var r=mc;return e.current.memoizedState.isDehydrated&&(Pi(e,t).flags|=256),e=Ah(e,t),e!==2&&(t=on,on=r,t!==null&&Zm(t)),e}function Zm(e){on===null?on=e:on.push.apply(on,e)}function oR(e){for(var t=e;;){if(t.flags&16384){var r=t.updateQueue;if(r!==null&&(r=r.stores,r!==null))for(var n=0;n<r.length;n++){var s=r[n],a=s.getSnapshot;s=s.value;try{if(!cs(a(),s))return!1}catch{return!1}}}if(r=t.child,t.subtreeFlags&16384&&r!==null)r.return=t,t=r;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function Pa(e,t){for(t&=~Cg,t&=~wd,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var r=31-as(t),n=1<<r;e[r]=-1,t&=~n}}function Q1(e){if(at&6)throw Error(ye(327));Bo();var t=lh(e,0);if(!(t&1))return hn(e,Wt()),null;var r=Ah(e,t);if(e.tag!==0&&r===2){var n=km(e);n!==0&&(t=n,r=Jm(e,n))}if(r===1)throw r=Kc,Pi(e,0),Pa(e,t),hn(e,Wt()),r;if(r===6)throw Error(ye(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,yi(e,on,Ws),hn(e,Wt()),null}function Ng(e,t){var r=at;at|=1;try{return e(t)}finally{at=r,at===0&&(rl=Wt()+500,vd&&hi())}}function zi(e){ja!==null&&ja.tag===0&&!(at&6)&&Bo();var t=at;at|=1;var r=jn.transition,n=pt;try{if(jn.transition=null,pt=1,e)return e()}finally{pt=n,jn.transition=r,at=t,!(at&6)&&hi()}}function bg(){vn=Fo.current,Rt(Fo)}function Pi(e,t){e.finishedWork=null,e.finishedLanes=0;var r=e.timeoutHandle;if(r!==-1&&(e.timeoutHandle=-1,L4(r)),Jt!==null)for(r=Jt.return;r!==null;){var n=r;switch(fg(n),n.tag){case 1:n=n.type.childContextTypes,n!=null&&dh();break;case 3:el(),Rt(un),Rt(Br),yg();break;case 5:_g(n);break;case 4:el();break;case 13:Rt(Ft);break;case 19:Rt(Ft);break;case 10:pg(n.type._context);break;case 22:case 23:bg()}r=r.return}if(hr=e,Jt=e=Ya(e.current,null),yr=vn=t,nr=0,Kc=null,Cg=wd=Bi=0,on=mc=null,Ai!==null){for(t=0;t<Ai.length;t++)if(r=Ai[t],n=r.interleaved,n!==null){r.interleaved=null;var s=n.next,a=r.pending;if(a!==null){var i=a.next;a.next=s,n.next=i}r.pending=n}Ai=null}return e}function eT(e,t){do{var r=Jt;try{if(mg(),Bf.current=Eh,wh){for(var n=Ot.memoizedState;n!==null;){var s=n.queue;s!==null&&(s.pending=null),n=n.next}wh=!1}if(Ui=0,fr=rr=Ot=null,hc=!1,Wc=0,Ig.current=null,r===null||r.return===null){nr=1,Kc=t,Jt=null;break}e:{var a=e,i=r.return,o=r,l=t;if(t=yr,o.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var c=l,u=o,h=u.tag;if(!(u.mode&1)&&(h===0||h===11||h===15)){var m=u.alternate;m?(u.updateQueue=m.updateQueue,u.memoizedState=m.memoizedState,u.lanes=m.lanes):(u.updateQueue=null,u.memoizedState=null)}var p=j1(i);if(p!==null){p.flags&=-257,V1(p,i,o,a,t),p.mode&1&&L1(a,c,t),t=p,l=c;var x=t.updateQueue;if(x===null){var v=new Set;v.add(l),t.updateQueue=v}else x.add(l);break e}else{if(!(t&1)){L1(a,c,t),Pg();break e}l=Error(ye(426))}}else if(Pt&&o.mode&1){var w=j1(i);if(w!==null){!(w.flags&65536)&&(w.flags|=256),V1(w,i,o,a,t),hg(tl(l,o));break e}}a=l=tl(l,o),nr!==4&&(nr=2),mc===null?mc=[a]:mc.push(a),a=i;do{switch(a.tag){case 3:a.flags|=65536,t&=-t,a.lanes|=t;var k=L2(a,l,t);b1(a,k);break e;case 1:o=l;var T=a.type,E=a.stateNode;if(!(a.flags&128)&&(typeof T.getDerivedStateFromError=="function"||E!==null&&typeof E.componentDidCatch=="function"&&(qa===null||!qa.has(E)))){a.flags|=65536,t&=-t,a.lanes|=t;var N=j2(a,o,t);b1(a,N);break e}}a=a.return}while(a!==null)}nT(r)}catch(O){t=O,Jt===r&&r!==null&&(Jt=r=r.return);continue}break}while(!0)}function tT(){var e=Th.current;return Th.current=Eh,e===null?Eh:e}function Pg(){(nr===0||nr===3||nr===2)&&(nr=4),hr===null||!(Bi&268435455)&&!(wd&268435455)||Pa(hr,yr)}function Ah(e,t){var r=at;at|=2;var n=tT();(hr!==e||yr!==t)&&(Ws=null,Pi(e,t));do try{lR();break}catch(s){eT(e,s)}while(!0);if(mg(),at=r,Th.current=n,Jt!==null)throw Error(ye(261));return hr=null,yr=0,nr}function lR(){for(;Jt!==null;)rT(Jt)}function cR(){for(;Jt!==null&&!FC();)rT(Jt)}function rT(e){var t=aT(e.alternate,e,vn);e.memoizedProps=e.pendingProps,t===null?nT(e):Jt=t,Ig.current=null}function nT(e){var t=e;do{var r=t.alternate;if(e=t.return,t.flags&32768){if(r=rR(r,t),r!==null){r.flags&=32767,Jt=r;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{nr=6,Jt=null;return}}else if(r=tR(r,t,vn),r!==null){Jt=r;return}if(t=t.sibling,t!==null){Jt=t;return}Jt=t=e}while(t!==null);nr===0&&(nr=5)}function yi(e,t,r){var n=pt,s=jn.transition;try{jn.transition=null,pt=1,uR(e,t,r,n)}finally{jn.transition=s,pt=n}return null}function uR(e,t,r,n){do Bo();while(ja!==null);if(at&6)throw Error(ye(327));r=e.finishedWork;var s=e.finishedLanes;if(r===null)return null;if(e.finishedWork=null,e.finishedLanes=0,r===e.current)throw Error(ye(177));e.callbackNode=null,e.callbackPriority=0;var a=r.lanes|r.childLanes;if(WC(e,a),e===hr&&(Jt=hr=null,yr=0),!(r.subtreeFlags&2064)&&!(r.flags&2064)||vf||(vf=!0,iT(oh,function(){return Bo(),null})),a=(r.flags&15990)!==0,r.subtreeFlags&15990||a){a=jn.transition,jn.transition=null;var i=pt;pt=1;var o=at;at|=4,Ig.current=null,sR(e,r),Q2(r,e),N4(Nm),ch=!!Rm,Nm=Rm=null,e.current=r,aR(r),OC(),at=o,pt=i,jn.transition=a}else e.current=r;if(vf&&(vf=!1,ja=e,Sh=s),a=e.pendingLanes,a===0&&(qa=null),jC(r.stateNode),hn(e,Wt()),t!==null)for(n=e.onRecoverableError,r=0;r<t.length;r++)s=t[r],n(s.value,{componentStack:s.stack,digest:s.digest});if(kh)throw kh=!1,e=Ym,Ym=null,e;return Sh&1&&e.tag!==0&&Bo(),a=e.pendingLanes,a&1?e===Qm?pc++:(pc=0,Qm=e):pc=0,hi(),null}function Bo(){if(ja!==null){var e=LE(Sh),t=jn.transition,r=pt;try{if(jn.transition=null,pt=16>e?16:e,ja===null)var n=!1;else{if(e=ja,ja=null,Sh=0,at&6)throw Error(ye(331));var s=at;for(at|=4,Re=e.current;Re!==null;){var a=Re,i=a.child;if(Re.flags&16){var o=a.deletions;if(o!==null){for(var l=0;l<o.length;l++){var c=o[l];for(Re=c;Re!==null;){var u=Re;switch(u.tag){case 0:case 11:case 15:dc(8,u,a)}var h=u.child;if(h!==null)h.return=u,Re=h;else for(;Re!==null;){u=Re;var m=u.sibling,p=u.return;if(q2(u),u===c){Re=null;break}if(m!==null){m.return=p,Re=m;break}Re=p}}}var x=a.alternate;if(x!==null){var v=x.child;if(v!==null){x.child=null;do{var w=v.sibling;v.sibling=null,v=w}while(v!==null)}}Re=a}}if(a.subtreeFlags&2064&&i!==null)i.return=a,Re=i;else e:for(;Re!==null;){if(a=Re,a.flags&2048)switch(a.tag){case 0:case 11:case 15:dc(9,a,a.return)}var k=a.sibling;if(k!==null){k.return=a.return,Re=k;break e}Re=a.return}}var T=e.current;for(Re=T;Re!==null;){i=Re;var E=i.child;if(i.subtreeFlags&2064&&E!==null)E.return=i,Re=E;else e:for(i=T;Re!==null;){if(o=Re,o.flags&2048)try{switch(o.tag){case 0:case 11:case 15:yd(9,o)}}catch(O){Vt(o,o.return,O)}if(o===i){Re=null;break e}var N=o.sibling;if(N!==null){N.return=o.return,Re=N;break e}Re=o.return}}if(at=s,hi(),Es&&typeof Es.onPostCommitFiberRoot=="function")try{Es.onPostCommitFiberRoot(hd,e)}catch{}n=!0}return n}finally{pt=r,jn.transition=t}}return!1}function J1(e,t,r){t=tl(r,t),t=L2(e,t,1),e=Ka(e,t,1),t=Xr(),e!==null&&(gu(e,1,t),hn(e,t))}function Vt(e,t,r){if(e.tag===3)J1(e,e,r);else for(;t!==null;){if(t.tag===3){J1(t,e,r);break}else if(t.tag===1){var n=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof n.componentDidCatch=="function"&&(qa===null||!qa.has(n))){e=tl(r,e),e=j2(t,e,1),t=Ka(t,e,1),e=Xr(),t!==null&&(gu(t,1,e),hn(t,e));break}}t=t.return}}function fR(e,t,r){var n=e.pingCache;n!==null&&n.delete(t),t=Xr(),e.pingedLanes|=e.suspendedLanes&r,hr===e&&(yr&r)===r&&(nr===4||nr===3&&(yr&130023424)===yr&&500>Wt()-Rg?Pi(e,0):Cg|=r),hn(e,t)}function sT(e,t){t===0&&(e.mode&1?(t=of,of<<=1,!(of&130023424)&&(of=4194304)):t=1);var r=Xr();e=oa(e,t),e!==null&&(gu(e,t,r),hn(e,r))}function hR(e){var t=e.memoizedState,r=0;t!==null&&(r=t.retryLane),sT(e,r)}function dR(e,t){var r=0;switch(e.tag){case 13:var n=e.stateNode,s=e.memoizedState;s!==null&&(r=s.retryLane);break;case 19:n=e.stateNode;break;default:throw Error(ye(314))}n!==null&&n.delete(t),sT(e,r)}var aT;aT=function(e,t,r){if(e!==null)if(e.memoizedProps!==t.pendingProps||un.current)cn=!0;else{if(!(e.lanes&r)&&!(t.flags&128))return cn=!1,eR(e,t,r);cn=!!(e.flags&131072)}else cn=!1,Pt&&t.flags&1048576&&c2(t,gh,t.index);switch(t.lanes=0,t.tag){case 2:var n=t.type;$f(e,t),e=t.pendingProps;var s=Qo(t,Br.current);Uo(t,r),s=Eg(null,t,n,e,s,r);var a=Tg();return t.flags|=1,typeof s=="object"&&s!==null&&typeof s.render=="function"&&s.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,fn(n)?(a=!0,mh(t)):a=!1,t.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,vg(t),s.updater=_d,t.stateNode=s,s._reactInternals=t,Vm(t,n,e,r),t=zm(null,t,n,!0,a,r)):(t.tag=0,Pt&&a&&ug(t),Hr(null,t,s,r),t=t.child),t;case 16:n=t.elementType;e:{switch($f(e,t),e=t.pendingProps,s=n._init,n=s(n._payload),t.type=n,s=t.tag=pR(n),e=Yn(n,e),s){case 0:t=Bm(null,t,n,e,r);break e;case 1:t=z1(null,t,n,e,r);break e;case 11:t=U1(null,t,n,e,r);break e;case 14:t=B1(null,t,n,Yn(n.type,e),r);break e}throw Error(ye(306,n,""))}return t;case 0:return n=t.type,s=t.pendingProps,s=t.elementType===n?s:Yn(n,s),Bm(e,t,n,s,r);case 1:return n=t.type,s=t.pendingProps,s=t.elementType===n?s:Yn(n,s),z1(e,t,n,s,r);case 3:e:{if(z2(t),e===null)throw Error(ye(387));n=t.pendingProps,a=t.memoizedState,s=a.element,p2(e,t),_h(t,n,null,r);var i=t.memoizedState;if(n=i.element,a.isDehydrated)if(a={element:n,isDehydrated:!1,cache:i.cache,pendingSuspenseBoundaries:i.pendingSuspenseBoundaries,transitions:i.transitions},t.updateQueue.baseState=a,t.memoizedState=a,t.flags&256){s=tl(Error(ye(423)),t),t=$1(e,t,n,r,s);break e}else if(n!==s){s=tl(Error(ye(424)),t),t=$1(e,t,n,r,s);break e}else for(wn=Ga(t.stateNode.containerInfo.firstChild),Tn=t,Pt=!0,Zn=null,r=d2(t,null,n,r),t.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if(Jo(),n===s){t=la(e,t,r);break e}Hr(e,t,n,r)}t=t.child}return t;case 5:return g2(t),e===null&&Mm(t),n=t.type,s=t.pendingProps,a=e!==null?e.memoizedProps:null,i=s.children,bm(n,s)?i=null:a!==null&&bm(n,a)&&(t.flags|=32),B2(e,t),Hr(e,t,i,r),t.child;case 6:return e===null&&Mm(t),null;case 13:return $2(e,t,r);case 4:return xg(t,t.stateNode.containerInfo),n=t.pendingProps,e===null?t.child=Zo(t,null,n,r):Hr(e,t,n,r),t.child;case 11:return n=t.type,s=t.pendingProps,s=t.elementType===n?s:Yn(n,s),U1(e,t,n,s,r);case 7:return Hr(e,t,t.pendingProps,r),t.child;case 8:return Hr(e,t,t.pendingProps.children,r),t.child;case 12:return Hr(e,t,t.pendingProps.children,r),t.child;case 10:e:{if(n=t.type._context,s=t.pendingProps,a=t.memoizedProps,i=s.value,wt(vh,n._currentValue),n._currentValue=i,a!==null)if(cs(a.value,i)){if(a.children===s.children&&!un.current){t=la(e,t,r);break e}}else for(a=t.child,a!==null&&(a.return=t);a!==null;){var o=a.dependencies;if(o!==null){i=a.child;for(var l=o.firstContext;l!==null;){if(l.context===n){if(a.tag===1){l=Zs(-1,r&-r),l.tag=2;var c=a.updateQueue;if(c!==null){c=c.shared;var u=c.pending;u===null?l.next=l:(l.next=u.next,u.next=l),c.pending=l}}a.lanes|=r,l=a.alternate,l!==null&&(l.lanes|=r),Lm(a.return,r,t),o.lanes|=r;break}l=l.next}}else if(a.tag===10)i=a.type===t.type?null:a.child;else if(a.tag===18){if(i=a.return,i===null)throw Error(ye(341));i.lanes|=r,o=i.alternate,o!==null&&(o.lanes|=r),Lm(i,r,t),i=a.sibling}else i=a.child;if(i!==null)i.return=a;else for(i=a;i!==null;){if(i===t){i=null;break}if(a=i.sibling,a!==null){a.return=i.return,i=a;break}i=i.return}a=i}Hr(e,t,s.children,r),t=t.child}return t;case 9:return s=t.type,n=t.pendingProps.children,Uo(t,r),s=Bn(s),n=n(s),t.flags|=1,Hr(e,t,n,r),t.child;case 14:return n=t.type,s=Yn(n,t.pendingProps),s=Yn(n.type,s),B1(e,t,n,s,r);case 15:return V2(e,t,t.type,t.pendingProps,r);case 17:return n=t.type,s=t.pendingProps,s=t.elementType===n?s:Yn(n,s),$f(e,t),t.tag=1,fn(n)?(e=!0,mh(t)):e=!1,Uo(t,r),M2(t,n,s),Vm(t,n,s,r),zm(null,t,n,!0,e,r);case 19:return W2(e,t,r);case 22:return U2(e,t,r)}throw Error(ye(156,t.tag))};function iT(e,t){return DE(e,t)}function mR(e,t,r,n){this.tag=e,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Ln(e,t,r,n){return new mR(e,t,r,n)}function Dg(e){return e=e.prototype,!(!e||!e.isReactComponent)}function pR(e){if(typeof e=="function")return Dg(e)?1:0;if(e!=null){if(e=e.$$typeof,e===Jp)return 11;if(e===Zp)return 14}return 2}function Ya(e,t){var r=e.alternate;return r===null?(r=Ln(e.tag,t,e.key,e.mode),r.elementType=e.elementType,r.type=e.type,r.stateNode=e.stateNode,r.alternate=e,e.alternate=r):(r.pendingProps=t,r.type=e.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=e.flags&14680064,r.childLanes=e.childLanes,r.lanes=e.lanes,r.child=e.child,r.memoizedProps=e.memoizedProps,r.memoizedState=e.memoizedState,r.updateQueue=e.updateQueue,t=e.dependencies,r.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},r.sibling=e.sibling,r.index=e.index,r.ref=e.ref,r}function Gf(e,t,r,n,s,a){var i=2;if(n=e,typeof e=="function")Dg(e)&&(i=1);else if(typeof e=="string")i=5;else e:switch(e){case ko:return Di(r.children,s,a,t);case Qp:i=8,s|=8;break;case cm:return e=Ln(12,r,t,s|2),e.elementType=cm,e.lanes=a,e;case um:return e=Ln(13,r,t,s),e.elementType=um,e.lanes=a,e;case fm:return e=Ln(19,r,t,s),e.elementType=fm,e.lanes=a,e;case gE:return Ed(r,s,a,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case mE:i=10;break e;case pE:i=9;break e;case Jp:i=11;break e;case Zp:i=14;break e;case Ra:i=16,n=null;break e}throw Error(ye(130,e==null?e:typeof e,""))}return t=Ln(i,r,t,s),t.elementType=e,t.type=n,t.lanes=a,t}function Di(e,t,r,n){return e=Ln(7,e,n,t),e.lanes=r,e}function Ed(e,t,r,n){return e=Ln(22,e,n,t),e.elementType=gE,e.lanes=r,e.stateNode={isHidden:!1},e}function F0(e,t,r){return e=Ln(6,e,null,t),e.lanes=r,e}function O0(e,t,r){return t=Ln(4,e.children!==null?e.children:[],e.key,t),t.lanes=r,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function gR(e,t,r,n,s){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=p0(0),this.expirationTimes=p0(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=p0(0),this.identifierPrefix=n,this.onRecoverableError=s,this.mutableSourceEagerHydrationData=null}function Fg(e,t,r,n,s,a,i,o,l){return e=new gR(e,t,r,o,l),t===1?(t=1,a===!0&&(t|=8)):t=0,a=Ln(3,null,null,t),e.current=a,a.stateNode=e,a.memoizedState={element:n,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},vg(a),e}function vR(e,t,r){var n=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:To,key:n==null?null:""+n,children:e,containerInfo:t,implementation:r}}function oT(e){if(!e)return ri;e=e._reactInternals;e:{if(Ji(e)!==e||e.tag!==1)throw Error(ye(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(fn(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(ye(171))}if(e.tag===1){var r=e.type;if(fn(r))return o2(e,r,t)}return t}function lT(e,t,r,n,s,a,i,o,l){return e=Fg(r,n,!0,e,s,a,i,o,l),e.context=oT(null),r=e.current,n=Xr(),s=Xa(r),a=Zs(n,s),a.callback=t??null,Ka(r,a,s),e.current.lanes=s,gu(e,s,n),hn(e,n),e}function Td(e,t,r,n){var s=t.current,a=Xr(),i=Xa(s);return r=oT(r),t.context===null?t.context=r:t.pendingContext=r,t=Zs(a,i),t.payload={element:e},n=n===void 0?null:n,n!==null&&(t.callback=n),e=Ka(s,t,i),e!==null&&(is(e,s,i,a),Uf(e,s,i)),i}function Ih(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function Z1(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var r=e.retryLane;e.retryLane=r!==0&&r<t?r:t}}function Og(e,t){Z1(e,t),(e=e.alternate)&&Z1(e,t)}function xR(){return null}var cT=typeof reportError=="function"?reportError:function(e){console.error(e)};function Mg(e){this._internalRoot=e}kd.prototype.render=Mg.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(ye(409));Td(e,t,null,null)};kd.prototype.unmount=Mg.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;zi(function(){Td(null,e,null,null)}),t[ia]=null}};function kd(e){this._internalRoot=e}kd.prototype.unstable_scheduleHydration=function(e){if(e){var t=UE();e={blockedOn:null,target:e,priority:t};for(var r=0;r<ba.length&&t!==0&&t<ba[r].priority;r++);ba.splice(r,0,e),r===0&&zE(e)}};function Lg(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function Sd(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function e_(){}function _R(e,t,r,n,s){if(s){if(typeof n=="function"){var a=n;n=function(){var c=Ih(i);a.call(c)}}var i=lT(t,n,e,0,null,!1,!1,"",e_);return e._reactRootContainer=i,e[ia]=i.current,Vc(e.nodeType===8?e.parentNode:e),zi(),i}for(;s=e.lastChild;)e.removeChild(s);if(typeof n=="function"){var o=n;n=function(){var c=Ih(l);o.call(c)}}var l=Fg(e,0,!1,null,null,!1,!1,"",e_);return e._reactRootContainer=l,e[ia]=l.current,Vc(e.nodeType===8?e.parentNode:e),zi(function(){Td(t,l,r,n)}),l}function Ad(e,t,r,n,s){var a=r._reactRootContainer;if(a){var i=a;if(typeof s=="function"){var o=s;s=function(){var l=Ih(i);o.call(l)}}Td(t,i,e,s)}else i=_R(r,t,e,s,n);return Ih(i)}jE=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var r=Yl(t.pendingLanes);r!==0&&(rg(t,r|1),hn(t,Wt()),!(at&6)&&(rl=Wt()+500,hi()))}break;case 13:zi(function(){var n=oa(e,1);if(n!==null){var s=Xr();is(n,e,1,s)}}),Og(e,1)}};ng=function(e){if(e.tag===13){var t=oa(e,134217728);if(t!==null){var r=Xr();is(t,e,134217728,r)}Og(e,134217728)}};VE=function(e){if(e.tag===13){var t=Xa(e),r=oa(e,t);if(r!==null){var n=Xr();is(r,e,t,n)}Og(e,t)}};UE=function(){return pt};BE=function(e,t){var r=pt;try{return pt=e,t()}finally{pt=r}};wm=function(e,t,r){switch(t){case"input":if(mm(e,r),t=r.name,r.type==="radio"&&t!=null){for(r=e;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<r.length;t++){var n=r[t];if(n!==e&&n.form===e.form){var s=gd(n);if(!s)throw Error(ye(90));xE(n),mm(n,s)}}}break;case"textarea":yE(e,r);break;case"select":t=r.value,t!=null&&Mo(e,!!r.multiple,t,!1)}};IE=Ng;CE=zi;var yR={usingClientEntryPoint:!1,Events:[xu,Co,gd,SE,AE,Ng]},$l={findFiberByHostInstance:Si,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},wR={bundleType:$l.bundleType,version:$l.version,rendererPackageName:$l.rendererPackageName,rendererConfig:$l.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:va.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=bE(e),e===null?null:e.stateNode},findFiberByHostInstance:$l.findFiberByHostInstance||xR,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var xf=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!xf.isDisabled&&xf.supportsFiber)try{hd=xf.inject(wR),Es=xf}catch{}}In.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=yR;In.createPortal=function(e,t){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Lg(t))throw Error(ye(200));return vR(e,t,null,r)};In.createRoot=function(e,t){if(!Lg(e))throw Error(ye(299));var r=!1,n="",s=cT;return t!=null&&(t.unstable_strictMode===!0&&(r=!0),t.identifierPrefix!==void 0&&(n=t.identifierPrefix),t.onRecoverableError!==void 0&&(s=t.onRecoverableError)),t=Fg(e,1,!1,null,null,r,!1,n,s),e[ia]=t.current,Vc(e.nodeType===8?e.parentNode:e),new Mg(t)};In.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(ye(188)):(e=Object.keys(e).join(","),Error(ye(268,e)));return e=bE(t),e=e===null?null:e.stateNode,e};In.flushSync=function(e){return zi(e)};In.hydrate=function(e,t,r){if(!Sd(t))throw Error(ye(200));return Ad(null,e,t,!0,r)};In.hydrateRoot=function(e,t,r){if(!Lg(e))throw Error(ye(405));var n=r!=null&&r.hydratedSources||null,s=!1,a="",i=cT;if(r!=null&&(r.unstable_strictMode===!0&&(s=!0),r.identifierPrefix!==void 0&&(a=r.identifierPrefix),r.onRecoverableError!==void 0&&(i=r.onRecoverableError)),t=lT(t,null,e,1,r??null,s,!1,a,i),e[ia]=t.current,Vc(e),n)for(e=0;e<n.length;e++)r=n[e],s=r._getVersion,s=s(r._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[r,s]:t.mutableSourceEagerHydrationData.push(r,s);return new kd(t)};In.render=function(e,t,r){if(!Sd(t))throw Error(ye(200));return Ad(null,e,t,!1,r)};In.unmountComponentAtNode=function(e){if(!Sd(e))throw Error(ye(40));return e._reactRootContainer?(zi(function(){Ad(null,null,e,!1,function(){e._reactRootContainer=null,e[ia]=null})}),!0):!1};In.unstable_batchedUpdates=Ng;In.unstable_renderSubtreeIntoContainer=function(e,t,r,n){if(!Sd(r))throw Error(ye(200));if(e==null||e._reactInternals===void 0)throw Error(ye(38));return Ad(e,t,r,!1,n)};In.version="18.3.1-next-f1338f8080-20240426";function uT(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(uT)}catch(e){console.error(e)}}uT(),uE.exports=In;var jg=uE.exports;const ER=Jw(jg),TR=Qw({__proto__:null,default:ER},[jg]);var t_=jg;om.createRoot=t_.createRoot,om.hydrateRoot=t_.hydrateRoot;/**
 * @remix-run/router v1.23.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Nt(){return Nt=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Nt.apply(this,arguments)}var Qt;(function(e){e.Pop="POP",e.Push="PUSH",e.Replace="REPLACE"})(Qt||(Qt={}));const r_="popstate";function kR(e){e===void 0&&(e={});function t(n,s){let{pathname:a,search:i,hash:o}=n.location;return qc("",{pathname:a,search:i,hash:o},s.state&&s.state.usr||null,s.state&&s.state.key||"default")}function r(n,s){return typeof s=="string"?s:$i(s)}return AR(t,r,null,e)}function Ge(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}function nl(e,t){if(!e){typeof console<"u"&&console.warn(t);try{throw new Error(t)}catch{}}}function SR(){return Math.random().toString(36).substr(2,8)}function n_(e,t){return{usr:e.state,key:e.key,idx:t}}function qc(e,t,r,n){return r===void 0&&(r=null),Nt({pathname:typeof e=="string"?e:e.pathname,search:"",hash:""},typeof t=="string"?di(t):t,{state:r,key:t&&t.key||n||SR()})}function $i(e){let{pathname:t="/",search:r="",hash:n=""}=e;return r&&r!=="?"&&(t+=r.charAt(0)==="?"?r:"?"+r),n&&n!=="#"&&(t+=n.charAt(0)==="#"?n:"#"+n),t}function di(e){let t={};if(e){let r=e.indexOf("#");r>=0&&(t.hash=e.substr(r),e=e.substr(0,r));let n=e.indexOf("?");n>=0&&(t.search=e.substr(n),e=e.substr(0,n)),e&&(t.pathname=e)}return t}function AR(e,t,r,n){n===void 0&&(n={});let{window:s=document.defaultView,v5Compat:a=!1}=n,i=s.history,o=Qt.Pop,l=null,c=u();c==null&&(c=0,i.replaceState(Nt({},i.state,{idx:c}),""));function u(){return(i.state||{idx:null}).idx}function h(){o=Qt.Pop;let w=u(),k=w==null?null:w-c;c=w,l&&l({action:o,location:v.location,delta:k})}function m(w,k){o=Qt.Push;let T=qc(v.location,w,k);c=u()+1;let E=n_(T,c),N=v.createHref(T);try{i.pushState(E,"",N)}catch(O){if(O instanceof DOMException&&O.name==="DataCloneError")throw O;s.location.assign(N)}a&&l&&l({action:o,location:v.location,delta:1})}function p(w,k){o=Qt.Replace;let T=qc(v.location,w,k);c=u();let E=n_(T,c),N=v.createHref(T);i.replaceState(E,"",N),a&&l&&l({action:o,location:v.location,delta:0})}function x(w){let k=s.location.origin!=="null"?s.location.origin:s.location.href,T=typeof w=="string"?w:$i(w);return T=T.replace(/ $/,"%20"),Ge(k,"No window.location.(origin|href) available to create URL for href: "+T),new URL(T,k)}let v={get action(){return o},get location(){return e(s,i)},listen(w){if(l)throw new Error("A history only accepts one active listener");return s.addEventListener(r_,h),l=w,()=>{s.removeEventListener(r_,h),l=null}},createHref(w){return t(s,w)},createURL:x,encodeLocation(w){let k=x(w);return{pathname:k.pathname,search:k.search,hash:k.hash}},push:m,replace:p,go(w){return i.go(w)}};return v}var mt;(function(e){e.data="data",e.deferred="deferred",e.redirect="redirect",e.error="error"})(mt||(mt={}));const IR=new Set(["lazy","caseSensitive","path","id","index","children"]);function CR(e){return e.index===!0}function Ch(e,t,r,n){return r===void 0&&(r=[]),n===void 0&&(n={}),e.map((s,a)=>{let i=[...r,String(a)],o=typeof s.id=="string"?s.id:i.join("-");if(Ge(s.index!==!0||!s.children,"Cannot specify children on an index route"),Ge(!n[o],'Found a route id collision on id "'+o+`".  Route id's must be globally unique within Data Router usages`),CR(s)){let l=Nt({},s,t(s),{id:o});return n[o]=l,l}else{let l=Nt({},s,t(s),{id:o,children:void 0});return n[o]=l,s.children&&(l.children=Ch(s.children,t,i,n)),l}})}function Ei(e,t,r){return r===void 0&&(r="/"),Kf(e,t,r,!1)}function Kf(e,t,r,n){let s=typeof t=="string"?di(t):t,a=ca(s.pathname||"/",r);if(a==null)return null;let i=fT(e);NR(i);let o=null;for(let l=0;o==null&&l<i.length;++l){let c=BR(a);o=VR(i[l],c,n)}return o}function RR(e,t){let{route:r,pathname:n,params:s}=e;return{id:r.id,pathname:n,params:s,data:t[r.id],handle:r.handle}}function fT(e,t,r,n){t===void 0&&(t=[]),r===void 0&&(r=[]),n===void 0&&(n="");let s=(a,i,o)=>{let l={relativePath:o===void 0?a.path||"":o,caseSensitive:a.caseSensitive===!0,childrenIndex:i,route:a};l.relativePath.startsWith("/")&&(Ge(l.relativePath.startsWith(n),'Absolute route path "'+l.relativePath+'" nested under path '+('"'+n+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),l.relativePath=l.relativePath.slice(n.length));let c=ea([n,l.relativePath]),u=r.concat(l);a.children&&a.children.length>0&&(Ge(a.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+c+'".')),fT(a.children,t,u,c)),!(a.path==null&&!a.index)&&t.push({path:c,score:LR(c,a.index),routesMeta:u})};return e.forEach((a,i)=>{var o;if(a.path===""||!((o=a.path)!=null&&o.includes("?")))s(a,i);else for(let l of hT(a.path))s(a,i,l)}),t}function hT(e){let t=e.split("/");if(t.length===0)return[];let[r,...n]=t,s=r.endsWith("?"),a=r.replace(/\?$/,"");if(n.length===0)return s?[a,""]:[a];let i=hT(n.join("/")),o=[];return o.push(...i.map(l=>l===""?a:[a,l].join("/"))),s&&o.push(...i),o.map(l=>e.startsWith("/")&&l===""?"/":l)}function NR(e){e.sort((t,r)=>t.score!==r.score?r.score-t.score:jR(t.routesMeta.map(n=>n.childrenIndex),r.routesMeta.map(n=>n.childrenIndex)))}const bR=/^:[\w-]+$/,PR=3,DR=2,FR=1,OR=10,MR=-2,s_=e=>e==="*";function LR(e,t){let r=e.split("/"),n=r.length;return r.some(s_)&&(n+=MR),t&&(n+=DR),r.filter(s=>!s_(s)).reduce((s,a)=>s+(bR.test(a)?PR:a===""?FR:OR),n)}function jR(e,t){return e.length===t.length&&e.slice(0,-1).every((n,s)=>n===t[s])?e[e.length-1]-t[t.length-1]:0}function VR(e,t,r){r===void 0&&(r=!1);let{routesMeta:n}=e,s={},a="/",i=[];for(let o=0;o<n.length;++o){let l=n[o],c=o===n.length-1,u=a==="/"?t:t.slice(a.length)||"/",h=Rh({path:l.relativePath,caseSensitive:l.caseSensitive,end:c},u),m=l.route;if(!h&&c&&r&&!n[n.length-1].route.index&&(h=Rh({path:l.relativePath,caseSensitive:l.caseSensitive,end:!1},u)),!h)return null;Object.assign(s,h.params),i.push({params:s,pathname:ea([a,h.pathname]),pathnameBase:WR(ea([a,h.pathnameBase])),route:m}),h.pathnameBase!=="/"&&(a=ea([a,h.pathnameBase]))}return i}function Rh(e,t){typeof e=="string"&&(e={path:e,caseSensitive:!1,end:!0});let[r,n]=UR(e.path,e.caseSensitive,e.end),s=t.match(r);if(!s)return null;let a=s[0],i=a.replace(/(.)\/+$/,"$1"),o=s.slice(1);return{params:n.reduce((c,u,h)=>{let{paramName:m,isOptional:p}=u;if(m==="*"){let v=o[h]||"";i=a.slice(0,a.length-v.length).replace(/(.)\/+$/,"$1")}const x=o[h];return p&&!x?c[m]=void 0:c[m]=(x||"").replace(/%2F/g,"/"),c},{}),pathname:a,pathnameBase:i,pattern:e}}function UR(e,t,r){t===void 0&&(t=!1),r===void 0&&(r=!0),nl(e==="*"||!e.endsWith("*")||e.endsWith("/*"),'Route path "'+e+'" will be treated as if it were '+('"'+e.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+e.replace(/\*$/,"/*")+'".'));let n=[],s="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(i,o,l)=>(n.push({paramName:o,isOptional:l!=null}),l?"/?([^\\/]+)?":"/([^\\/]+)"));return e.endsWith("*")?(n.push({paramName:"*"}),s+=e==="*"||e==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):r?s+="\\/*$":e!==""&&e!=="/"&&(s+="(?:(?=\\/|$))"),[new RegExp(s,t?void 0:"i"),n]}function BR(e){try{return e.split("/").map(t=>decodeURIComponent(t).replace(/\//g,"%2F")).join("/")}catch(t){return nl(!1,'The URL path "'+e+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+t+").")),e}}function ca(e,t){if(t==="/")return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let r=t.endsWith("/")?t.length-1:t.length,n=e.charAt(r);return n&&n!=="/"?null:e.slice(r)||"/"}function zR(e,t){t===void 0&&(t="/");let{pathname:r,search:n="",hash:s=""}=typeof e=="string"?di(e):e;return{pathname:r?r.startsWith("/")?r:$R(r,t):t,search:HR(n),hash:GR(s)}}function $R(e,t){let r=t.replace(/\/+$/,"").split("/");return e.split("/").forEach(s=>{s===".."?r.length>1&&r.pop():s!=="."&&r.push(s)}),r.length>1?r.join("/"):"/"}function M0(e,t,r,n){return"Cannot include a '"+e+"' character in a manually specified "+("`to."+t+"` field ["+JSON.stringify(n)+"].  Please separate it out to the ")+("`to."+r+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function dT(e){return e.filter((t,r)=>r===0||t.route.path&&t.route.path.length>0)}function Id(e,t){let r=dT(e);return t?r.map((n,s)=>s===r.length-1?n.pathname:n.pathnameBase):r.map(n=>n.pathnameBase)}function Cd(e,t,r,n){n===void 0&&(n=!1);let s;typeof e=="string"?s=di(e):(s=Nt({},e),Ge(!s.pathname||!s.pathname.includes("?"),M0("?","pathname","search",s)),Ge(!s.pathname||!s.pathname.includes("#"),M0("#","pathname","hash",s)),Ge(!s.search||!s.search.includes("#"),M0("#","search","hash",s)));let a=e===""||s.pathname==="",i=a?"/":s.pathname,o;if(i==null)o=r;else{let h=t.length-1;if(!n&&i.startsWith("..")){let m=i.split("/");for(;m[0]==="..";)m.shift(),h-=1;s.pathname=m.join("/")}o=h>=0?t[h]:"/"}let l=zR(s,o),c=i&&i!=="/"&&i.endsWith("/"),u=(a||i===".")&&r.endsWith("/");return!l.pathname.endsWith("/")&&(c||u)&&(l.pathname+="/"),l}const ea=e=>e.join("/").replace(/\/\/+/g,"/"),WR=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),HR=e=>!e||e==="?"?"":e.startsWith("?")?e:"?"+e,GR=e=>!e||e==="#"?"":e.startsWith("#")?e:"#"+e;class Nh{constructor(t,r,n,s){s===void 0&&(s=!1),this.status=t,this.statusText=r||"",this.internal=s,n instanceof Error?(this.data=n.toString(),this.error=n):this.data=n}}function Xc(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.internal=="boolean"&&"data"in e}const mT=["post","put","patch","delete"],KR=new Set(mT),qR=["get",...mT],XR=new Set(qR),YR=new Set([301,302,303,307,308]),QR=new Set([307,308]),L0={state:"idle",location:void 0,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0},JR={state:"idle",data:void 0,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0},Wl={state:"unblocked",proceed:void 0,reset:void 0,location:void 0},Vg=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,ZR=e=>({hasErrorBoundary:!!e.hasErrorBoundary}),pT="remix-router-transitions";function eN(e){const t=e.window?e.window:typeof window<"u"?window:void 0,r=typeof t<"u"&&typeof t.document<"u"&&typeof t.document.createElement<"u",n=!r;Ge(e.routes.length>0,"You must provide a non-empty routes array to createRouter");let s;if(e.mapRouteProperties)s=e.mapRouteProperties;else if(e.detectErrorBoundary){let X=e.detectErrorBoundary;s=J=>({hasErrorBoundary:X(J)})}else s=ZR;let a={},i=Ch(e.routes,s,void 0,a),o,l=e.basename||"/",c=e.dataStrategy||sN,u=e.patchRoutesOnNavigation,h=Nt({v7_fetcherPersist:!1,v7_normalizeFormMethod:!1,v7_partialHydration:!1,v7_prependBasename:!1,v7_relativeSplatPath:!1,v7_skipActionErrorRevalidation:!1},e.future),m=null,p=new Set,x=null,v=null,w=null,k=e.hydrationData!=null,T=Ei(i,e.history.location,l),E=!1,N=null;if(T==null&&!u){let X=sn(404,{pathname:e.history.location.pathname}),{matches:J,route:ne}=p_(i);T=J,N={[ne.id]:X}}T&&!e.hydrationData&&Bs(T,i,e.history.location.pathname).active&&(T=null);let O;if(T)if(T.some(X=>X.route.lazy))O=!1;else if(!T.some(X=>X.route.loader))O=!0;else if(h.v7_partialHydration){let X=e.hydrationData?e.hydrationData.loaderData:null,J=e.hydrationData?e.hydrationData.errors:null;if(J){let ne=T.findIndex(me=>J[me.route.id]!==void 0);O=T.slice(0,ne+1).every(me=>!tp(me.route,X,J))}else O=T.every(ne=>!tp(ne.route,X,J))}else O=e.hydrationData!=null;else if(O=!1,T=[],h.v7_partialHydration){let X=Bs(null,i,e.history.location.pathname);X.active&&X.matches&&(E=!0,T=X.matches)}let L,g={historyAction:e.history.action,location:e.history.location,matches:T,initialized:O,navigation:L0,restoreScrollPosition:e.hydrationData!=null?!1:null,preventScrollReset:!1,revalidation:"idle",loaderData:e.hydrationData&&e.hydrationData.loaderData||{},actionData:e.hydrationData&&e.hydrationData.actionData||null,errors:e.hydrationData&&e.hydrationData.errors||N,fetchers:new Map,blockers:new Map},y=Qt.Pop,S=!1,R,b=!1,P=new Map,C=null,le=!1,se=!1,he=[],de=new Set,ie=new Map,H=0,ce=-1,ve=new Map,B=new Set,K=new Map,q=new Map,G=new Set,oe=new Map,xe=new Map,Ce;function Te(){if(m=e.history.listen(X=>{let{action:J,location:ne,delta:me}=X;if(Ce){Ce(),Ce=void 0;return}nl(xe.size===0||me!=null,"You are trying to use a blocker on a POP navigation to a location that was not created by @remix-run/router. This will fail silently in production. This can happen if you are navigating outside the router via `window.history.pushState`/`window.location.hash` instead of using router navigation APIs.  This can also happen if you are using createHashRouter and the user manually changes the URL.");let Se=wa({currentLocation:g.location,nextLocation:ne,historyAction:J});if(Se&&me!=null){let I=new Promise(V=>{Ce=V});e.history.go(me*-1),hs(Se,{state:"blocked",location:ne,proceed(){hs(Se,{state:"proceeding",proceed:void 0,reset:void 0,location:ne}),I.then(()=>e.history.go(me))},reset(){let V=new Map(g.blockers);V.set(Se,Wl),z({blockers:V})}});return}return Fe(J,ne)}),r){xN(t,P);let X=()=>_N(t,P);t.addEventListener("pagehide",X),C=()=>t.removeEventListener("pagehide",X)}return g.initialized||Fe(Qt.Pop,g.location,{initialHydration:!0}),L}function _e(){m&&m(),C&&C(),p.clear(),R&&R.abort(),g.fetchers.forEach((X,J)=>xt(J)),g.blockers.forEach((X,J)=>js(J))}function $e(X){return p.add(X),()=>p.delete(X)}function z(X,J){J===void 0&&(J={}),g=Nt({},g,X);let ne=[],me=[];h.v7_fetcherPersist&&g.fetchers.forEach((Se,I)=>{Se.state==="idle"&&(G.has(I)?me.push(I):ne.push(I))}),G.forEach(Se=>{!g.fetchers.has(Se)&&!ie.has(Se)&&me.push(Se)}),[...p].forEach(Se=>Se(g,{deletedFetchers:me,viewTransitionOpts:J.viewTransitionOpts,flushSync:J.flushSync===!0})),h.v7_fetcherPersist?(ne.forEach(Se=>g.fetchers.delete(Se)),me.forEach(Se=>xt(Se))):me.forEach(Se=>G.delete(Se))}function ot(X,J,ne){var me,Se;let{flushSync:I}=ne===void 0?{}:ne,V=g.actionData!=null&&g.navigation.formMethod!=null&&Jn(g.navigation.formMethod)&&g.navigation.state==="loading"&&((me=X.state)==null?void 0:me._isRedirect)!==!0,D;J.actionData?Object.keys(J.actionData).length>0?D=J.actionData:D=null:V?D=g.actionData:D=null;let F=J.loaderData?d_(g.loaderData,J.loaderData,J.matches||[],J.errors):g.loaderData,M=g.blockers;M.size>0&&(M=new Map(M),M.forEach((te,ee)=>M.set(ee,Wl)));let j=S===!0||g.navigation.formMethod!=null&&Jn(g.navigation.formMethod)&&((Se=X.state)==null?void 0:Se._isRedirect)!==!0;o&&(i=o,o=void 0),le||y===Qt.Pop||(y===Qt.Push?e.history.push(X,X.state):y===Qt.Replace&&e.history.replace(X,X.state));let Y;if(y===Qt.Pop){let te=P.get(g.location.pathname);te&&te.has(X.pathname)?Y={currentLocation:g.location,nextLocation:X}:P.has(X.pathname)&&(Y={currentLocation:X,nextLocation:g.location})}else if(b){let te=P.get(g.location.pathname);te?te.add(X.pathname):(te=new Set([X.pathname]),P.set(g.location.pathname,te)),Y={currentLocation:g.location,nextLocation:X}}z(Nt({},J,{actionData:D,loaderData:F,historyAction:y,location:X,initialized:!0,navigation:L0,revalidation:"idle",restoreScrollPosition:Us(X,J.matches||g.matches),preventScrollReset:j,blockers:M}),{viewTransitionOpts:Y,flushSync:I===!0}),y=Qt.Pop,S=!1,b=!1,le=!1,se=!1,he=[]}async function He(X,J){if(typeof X=="number"){e.history.go(X);return}let ne=ep(g.location,g.matches,l,h.v7_prependBasename,X,h.v7_relativeSplatPath,J==null?void 0:J.fromRouteId,J==null?void 0:J.relative),{path:me,submission:Se,error:I}=a_(h.v7_normalizeFormMethod,!1,ne,J),V=g.location,D=qc(g.location,me,J&&J.state);D=Nt({},D,e.history.encodeLocation(D));let F=J&&J.replace!=null?J.replace:void 0,M=Qt.Push;F===!0?M=Qt.Replace:F===!1||Se!=null&&Jn(Se.formMethod)&&Se.formAction===g.location.pathname+g.location.search&&(M=Qt.Replace);let j=J&&"preventScrollReset"in J?J.preventScrollReset===!0:void 0,Y=(J&&J.flushSync)===!0,te=wa({currentLocation:V,nextLocation:D,historyAction:M});if(te){hs(te,{state:"blocked",location:D,proceed(){hs(te,{state:"proceeding",proceed:void 0,reset:void 0,location:D}),He(X,J)},reset(){let ee=new Map(g.blockers);ee.set(te,Wl),z({blockers:ee})}});return}return await Fe(M,D,{submission:Se,pendingError:I,preventScrollReset:j,replace:J&&J.replace,enableViewTransition:J&&J.viewTransition,flushSync:Y})}function nt(){if(St(),z({revalidation:"loading"}),g.navigation.state!=="submitting"){if(g.navigation.state==="idle"){Fe(g.historyAction,g.location,{startUninterruptedRevalidation:!0});return}Fe(y||g.historyAction,g.navigation.location,{overrideNavigation:g.navigation,enableViewTransition:b===!0})}}async function Fe(X,J,ne){R&&R.abort(),R=null,y=X,le=(ne&&ne.startUninterruptedRevalidation)===!0,uo(g.location,g.matches),S=(ne&&ne.preventScrollReset)===!0,b=(ne&&ne.enableViewTransition)===!0;let me=o||i,Se=ne&&ne.overrideNavigation,I=ne!=null&&ne.initialHydration&&g.matches&&g.matches.length>0&&!E?g.matches:Ei(me,J,l),V=(ne&&ne.flushSync)===!0;if(I&&g.initialized&&!se&&uN(g.location,J)&&!(ne&&ne.submission&&Jn(ne.submission.formMethod))){ot(J,{matches:I},{flushSync:V});return}let D=Bs(I,me,J.pathname);if(D.active&&D.matches&&(I=D.matches),!I){let{error:Z,notFoundMatches:Q,route:ue}=Hn(J.pathname);ot(J,{matches:Q,loaderData:{},errors:{[ue.id]:Z}},{flushSync:V});return}R=new AbortController;let F=vo(e.history,J,R.signal,ne&&ne.submission),M;if(ne&&ne.pendingError)M=[Ti(I).route.id,{type:mt.error,error:ne.pendingError}];else if(ne&&ne.submission&&Jn(ne.submission.formMethod)){let Z=await Ae(F,J,ne.submission,I,D.active,{replace:ne.replace,flushSync:V});if(Z.shortCircuited)return;if(Z.pendingActionResult){let[Q,ue]=Z.pendingActionResult;if(xn(ue)&&Xc(ue.error)&&ue.error.status===404){R=null,ot(J,{matches:Z.matches,loaderData:{},errors:{[Q]:ue.error}});return}}I=Z.matches||I,M=Z.pendingActionResult,Se=j0(J,ne.submission),V=!1,D.active=!1,F=vo(e.history,F.url,F.signal)}let{shortCircuited:j,matches:Y,loaderData:te,errors:ee}=await Tt(F,J,I,D.active,Se,ne&&ne.submission,ne&&ne.fetcherSubmission,ne&&ne.replace,ne&&ne.initialHydration===!0,V,M);j||(R=null,ot(J,Nt({matches:Y||I},m_(M),{loaderData:te,errors:ee})))}async function Ae(X,J,ne,me,Se,I){I===void 0&&(I={}),St();let V=gN(J,ne);if(z({navigation:V},{flushSync:I.flushSync===!0}),Se){let M=await Nn(me,J.pathname,X.signal);if(M.type==="aborted")return{shortCircuited:!0};if(M.type==="error"){let j=Ti(M.partialMatches).route.id;return{matches:M.partialMatches,pendingActionResult:[j,{type:mt.error,error:M.error}]}}else if(M.matches)me=M.matches;else{let{notFoundMatches:j,error:Y,route:te}=Hn(J.pathname);return{matches:j,pendingActionResult:[te.id,{type:mt.error,error:Y}]}}}let D,F=Jl(me,J);if(!F.route.action&&!F.route.lazy)D={type:mt.error,error:sn(405,{method:X.method,pathname:J.pathname,routeId:F.route.id})};else if(D=(await lr("action",g,X,[F],me,null))[F.route.id],X.signal.aborted)return{shortCircuited:!0};if(Ci(D)){let M;return I&&I.replace!=null?M=I.replace:M=u_(D.response.headers.get("Location"),new URL(X.url),l)===g.location.pathname+g.location.search,await kt(X,D,!0,{submission:ne,replace:M}),{shortCircuited:!0}}if(Va(D))throw sn(400,{type:"defer-action"});if(xn(D)){let M=Ti(me,F.route.id);return(I&&I.replace)!==!0&&(y=Qt.Push),{matches:me,pendingActionResult:[M.route.id,D]}}return{matches:me,pendingActionResult:[F.route.id,D]}}async function Tt(X,J,ne,me,Se,I,V,D,F,M,j){let Y=Se||j0(J,I),te=I||V||v_(Y),ee=!le&&(!h.v7_partialHydration||!F);if(me){if(ee){let ft=or(j);z(Nt({navigation:Y},ft!==void 0?{actionData:ft}:{}),{flushSync:M})}let We=await Nn(ne,J.pathname,X.signal);if(We.type==="aborted")return{shortCircuited:!0};if(We.type==="error"){let ft=Ti(We.partialMatches).route.id;return{matches:We.partialMatches,loaderData:{},errors:{[ft]:We.error}}}else if(We.matches)ne=We.matches;else{let{error:ft,notFoundMatches:mr,route:bn}=Hn(J.pathname);return{matches:mr,loaderData:{},errors:{[bn.id]:ft}}}}let Z=o||i,[Q,ue]=o_(e.history,g,ne,te,J,h.v7_partialHydration&&F===!0,h.v7_skipActionErrorRevalidation,se,he,de,G,K,B,Z,l,j);if(Vs(We=>!(ne&&ne.some(ft=>ft.route.id===We))||Q&&Q.some(ft=>ft.route.id===We)),ce=++H,Q.length===0&&ue.length===0){let We=Ls();return ot(J,Nt({matches:ne,loaderData:{},errors:j&&xn(j[1])?{[j[0]]:j[1].error}:null},m_(j),We?{fetchers:new Map(g.fetchers)}:{}),{flushSync:M}),{shortCircuited:!0}}if(ee){let We={};if(!me){We.navigation=Y;let ft=or(j);ft!==void 0&&(We.actionData=ft)}ue.length>0&&(We.fetchers=Ar(ue)),z(We,{flushSync:M})}ue.forEach(We=>{ut(We.key),We.controller&&ie.set(We.key,We.controller)});let we=()=>ue.forEach(We=>ut(We.key));R&&R.signal.addEventListener("abort",we);let{loaderResults:Ie,fetcherResults:pe}=await vt(g,ne,Q,ue,X);if(X.signal.aborted)return{shortCircuited:!0};R&&R.signal.removeEventListener("abort",we),ue.forEach(We=>ie.delete(We.key));let Ee=_f(Ie);if(Ee)return await kt(X,Ee.result,!0,{replace:D}),{shortCircuited:!0};if(Ee=_f(pe),Ee)return B.add(Ee.key),await kt(X,Ee.result,!0,{replace:D}),{shortCircuited:!0};let{loaderData:De,errors:st}=h_(g,ne,Ie,j,ue,pe,oe);oe.forEach((We,ft)=>{We.subscribe(mr=>{(mr||We.done)&&oe.delete(ft)})}),h.v7_partialHydration&&F&&g.errors&&(st=Nt({},g.errors,st));let Ke=Ls(),dt=co(ce),nn=Ke||dt||ue.length>0;return Nt({matches:ne,loaderData:De,errors:st},nn?{fetchers:new Map(g.fetchers)}:{})}function or(X){if(X&&!xn(X[1]))return{[X[0]]:X[1].data};if(g.actionData)return Object.keys(g.actionData).length===0?null:g.actionData}function Ar(X){return X.forEach(J=>{let ne=g.fetchers.get(J.key),me=Hl(void 0,ne?ne.data:void 0);g.fetchers.set(J.key,me)}),new Map(g.fetchers)}function tn(X,J,ne,me){if(n)throw new Error("router.fetch() was called during the server render, but it shouldn't be. You are likely calling a useFetcher() method in the body of your component. Try moving it to a useEffect or a callback.");ut(X);let Se=(me&&me.flushSync)===!0,I=o||i,V=ep(g.location,g.matches,l,h.v7_prependBasename,ne,h.v7_relativeSplatPath,J,me==null?void 0:me.relative),D=Ei(I,V,l),F=Bs(D,I,V);if(F.active&&F.matches&&(D=F.matches),!D){Dt(X,J,sn(404,{pathname:V}),{flushSync:Se});return}let{path:M,submission:j,error:Y}=a_(h.v7_normalizeFormMethod,!0,V,me);if(Y){Dt(X,J,Y,{flushSync:Se});return}let te=Jl(D,M),ee=(me&&me.preventScrollReset)===!0;if(j&&Jn(j.formMethod)){Ms(X,J,M,te,D,F.active,Se,ee,j);return}K.set(X,{routeId:J,path:M}),rn(X,J,M,te,D,F.active,Se,ee,j)}async function Ms(X,J,ne,me,Se,I,V,D,F){St(),K.delete(X);function M(Je){if(!Je.route.action&&!Je.route.lazy){let ms=sn(405,{method:F.formMethod,pathname:ne,routeId:J});return Dt(X,J,ms,{flushSync:V}),!0}return!1}if(!I&&M(me))return;let j=g.fetchers.get(X);ht(X,vN(F,j),{flushSync:V});let Y=new AbortController,te=vo(e.history,ne,Y.signal,F);if(I){let Je=await Nn(Se,new URL(te.url).pathname,te.signal,X);if(Je.type==="aborted")return;if(Je.type==="error"){Dt(X,J,Je.error,{flushSync:V});return}else if(Je.matches){if(Se=Je.matches,me=Jl(Se,ne),M(me))return}else{Dt(X,J,sn(404,{pathname:ne}),{flushSync:V});return}}ie.set(X,Y);let ee=H,Q=(await lr("action",g,te,[me],Se,X))[me.route.id];if(te.signal.aborted){ie.get(X)===Y&&ie.delete(X);return}if(h.v7_fetcherPersist&&G.has(X)){if(Ci(Q)||xn(Q)){ht(X,Ca(void 0));return}}else{if(Ci(Q))if(ie.delete(X),ce>ee){ht(X,Ca(void 0));return}else return B.add(X),ht(X,Hl(F)),kt(te,Q,!1,{fetcherSubmission:F,preventScrollReset:D});if(xn(Q)){Dt(X,J,Q.error);return}}if(Va(Q))throw sn(400,{type:"defer-action"});let ue=g.navigation.location||g.location,we=vo(e.history,ue,Y.signal),Ie=o||i,pe=g.navigation.state!=="idle"?Ei(Ie,g.navigation.location,l):g.matches;Ge(pe,"Didn't find any matches after fetcher action");let Ee=++H;ve.set(X,Ee);let De=Hl(F,Q.data);g.fetchers.set(X,De);let[st,Ke]=o_(e.history,g,pe,F,ue,!1,h.v7_skipActionErrorRevalidation,se,he,de,G,K,B,Ie,l,[me.route.id,Q]);Ke.filter(Je=>Je.key!==X).forEach(Je=>{let ms=Je.key,Cl=g.fetchers.get(ms),$u=Hl(void 0,Cl?Cl.data:void 0);g.fetchers.set(ms,$u),ut(ms),Je.controller&&ie.set(ms,Je.controller)}),z({fetchers:new Map(g.fetchers)});let dt=()=>Ke.forEach(Je=>ut(Je.key));Y.signal.addEventListener("abort",dt);let{loaderResults:nn,fetcherResults:We}=await vt(g,pe,st,Ke,we);if(Y.signal.aborted)return;Y.signal.removeEventListener("abort",dt),ve.delete(X),ie.delete(X),Ke.forEach(Je=>ie.delete(Je.key));let ft=_f(nn);if(ft)return kt(we,ft.result,!1,{preventScrollReset:D});if(ft=_f(We),ft)return B.add(ft.key),kt(we,ft.result,!1,{preventScrollReset:D});let{loaderData:mr,errors:bn}=h_(g,pe,nn,void 0,Ke,We,oe);if(g.fetchers.has(X)){let Je=Ca(Q.data);g.fetchers.set(X,Je)}co(Ee),g.navigation.state==="loading"&&Ee>ce?(Ge(y,"Expected pending action"),R&&R.abort(),ot(g.navigation.location,{matches:pe,loaderData:mr,errors:bn,fetchers:new Map(g.fetchers)})):(z({errors:bn,loaderData:d_(g.loaderData,mr,pe,bn),fetchers:new Map(g.fetchers)}),se=!1)}async function rn(X,J,ne,me,Se,I,V,D,F){let M=g.fetchers.get(X);ht(X,Hl(F,M?M.data:void 0),{flushSync:V});let j=new AbortController,Y=vo(e.history,ne,j.signal);if(I){let Q=await Nn(Se,new URL(Y.url).pathname,Y.signal,X);if(Q.type==="aborted")return;if(Q.type==="error"){Dt(X,J,Q.error,{flushSync:V});return}else if(Q.matches)Se=Q.matches,me=Jl(Se,ne);else{Dt(X,J,sn(404,{pathname:ne}),{flushSync:V});return}}ie.set(X,j);let te=H,Z=(await lr("loader",g,Y,[me],Se,X))[me.route.id];if(Va(Z)&&(Z=await Ug(Z,Y.signal,!0)||Z),ie.get(X)===j&&ie.delete(X),!Y.signal.aborted){if(G.has(X)){ht(X,Ca(void 0));return}if(Ci(Z))if(ce>te){ht(X,Ca(void 0));return}else{B.add(X),await kt(Y,Z,!1,{preventScrollReset:D});return}if(xn(Z)){Dt(X,J,Z.error);return}Ge(!Va(Z),"Unhandled fetcher deferred data"),ht(X,Ca(Z.data))}}async function kt(X,J,ne,me){let{submission:Se,fetcherSubmission:I,preventScrollReset:V,replace:D}=me===void 0?{}:me;J.response.headers.has("X-Remix-Revalidate")&&(se=!0);let F=J.response.headers.get("Location");Ge(F,"Expected a Location header on the redirect Response"),F=u_(F,new URL(X.url),l);let M=qc(g.location,F,{_isRedirect:!0});if(r){let Q=!1;if(J.response.headers.has("X-Remix-Reload-Document"))Q=!0;else if(Vg.test(F)){const ue=e.history.createURL(F);Q=ue.origin!==t.location.origin||ca(ue.pathname,l)==null}if(Q){D?t.location.replace(F):t.location.assign(F);return}}R=null;let j=D===!0||J.response.headers.has("X-Remix-Replace")?Qt.Replace:Qt.Push,{formMethod:Y,formAction:te,formEncType:ee}=g.navigation;!Se&&!I&&Y&&te&&ee&&(Se=v_(g.navigation));let Z=Se||I;if(QR.has(J.response.status)&&Z&&Jn(Z.formMethod))await Fe(j,M,{submission:Nt({},Z,{formAction:F}),preventScrollReset:V||S,enableViewTransition:ne?b:void 0});else{let Q=j0(M,Se);await Fe(j,M,{overrideNavigation:Q,fetcherSubmission:I,preventScrollReset:V||S,enableViewTransition:ne?b:void 0})}}async function lr(X,J,ne,me,Se,I){let V,D={};try{V=await aN(c,X,J,ne,me,Se,I,a,s)}catch(F){return me.forEach(M=>{D[M.route.id]={type:mt.error,error:F}}),D}for(let[F,M]of Object.entries(V))if(fN(M)){let j=M.result;D[F]={type:mt.redirect,response:lN(j,ne,F,Se,l,h.v7_relativeSplatPath)}}else D[F]=await oN(M);return D}async function vt(X,J,ne,me,Se){let I=X.matches,V=lr("loader",X,Se,ne,J,null),D=Promise.all(me.map(async j=>{if(j.matches&&j.match&&j.controller){let te=(await lr("loader",X,vo(e.history,j.path,j.controller.signal),[j.match],j.matches,j.key))[j.match.route.id];return{[j.key]:te}}else return Promise.resolve({[j.key]:{type:mt.error,error:sn(404,{pathname:j.path})}})})),F=await V,M=(await D).reduce((j,Y)=>Object.assign(j,Y),{});return await Promise.all([mN(J,F,Se.signal,I,X.loaderData),pN(J,M,me)]),{loaderResults:F,fetcherResults:M}}function St(){se=!0,he.push(...Vs()),K.forEach((X,J)=>{ie.has(J)&&de.add(J),ut(J)})}function ht(X,J,ne){ne===void 0&&(ne={}),g.fetchers.set(X,J),z({fetchers:new Map(g.fetchers)},{flushSync:(ne&&ne.flushSync)===!0})}function Dt(X,J,ne,me){me===void 0&&(me={});let Se=Ti(g.matches,J);xt(X),z({errors:{[Se.route.id]:ne},fetchers:new Map(g.fetchers)},{flushSync:(me&&me.flushSync)===!0})}function je(X){return q.set(X,(q.get(X)||0)+1),G.has(X)&&G.delete(X),g.fetchers.get(X)||JR}function xt(X){let J=g.fetchers.get(X);ie.has(X)&&!(J&&J.state==="loading"&&ve.has(X))&&ut(X),K.delete(X),ve.delete(X),B.delete(X),h.v7_fetcherPersist&&G.delete(X),de.delete(X),g.fetchers.delete(X)}function Gt(X){let J=(q.get(X)||0)-1;J<=0?(q.delete(X),G.add(X),h.v7_fetcherPersist||xt(X)):q.set(X,J),z({fetchers:new Map(g.fetchers)})}function ut(X){let J=ie.get(X);J&&(J.abort(),ie.delete(X))}function pn(X){for(let J of X){let ne=je(J),me=Ca(ne.data);g.fetchers.set(J,me)}}function Ls(){let X=[],J=!1;for(let ne of B){let me=g.fetchers.get(ne);Ge(me,"Expected fetcher: "+ne),me.state==="loading"&&(B.delete(ne),X.push(ne),J=!0)}return pn(X),J}function co(X){let J=[];for(let[ne,me]of ve)if(me<X){let Se=g.fetchers.get(ne);Ge(Se,"Expected fetcher: "+ne),Se.state==="loading"&&(ut(ne),ve.delete(ne),J.push(ne))}return pn(J),J.length>0}function Il(X,J){let ne=g.blockers.get(X)||Wl;return xe.get(X)!==J&&xe.set(X,J),ne}function js(X){g.blockers.delete(X),xe.delete(X)}function hs(X,J){let ne=g.blockers.get(X)||Wl;Ge(ne.state==="unblocked"&&J.state==="blocked"||ne.state==="blocked"&&J.state==="blocked"||ne.state==="blocked"&&J.state==="proceeding"||ne.state==="blocked"&&J.state==="unblocked"||ne.state==="proceeding"&&J.state==="unblocked","Invalid blocker state transition: "+ne.state+" -> "+J.state);let me=new Map(g.blockers);me.set(X,J),z({blockers:me})}function wa(X){let{currentLocation:J,nextLocation:ne,historyAction:me}=X;if(xe.size===0)return;xe.size>1&&nl(!1,"A router only supports one blocker at a time");let Se=Array.from(xe.entries()),[I,V]=Se[Se.length-1],D=g.blockers.get(I);if(!(D&&D.state==="proceeding")&&V({currentLocation:J,nextLocation:ne,historyAction:me}))return I}function Hn(X){let J=sn(404,{pathname:X}),ne=o||i,{matches:me,route:Se}=p_(ne);return Vs(),{notFoundMatches:me,route:Se,error:J}}function Vs(X){let J=[];return oe.forEach((ne,me)=>{(!X||X(me))&&(ne.cancel(),J.push(me),oe.delete(me))}),J}function ds(X,J,ne){if(x=X,w=J,v=ne||null,!k&&g.navigation===L0){k=!0;let me=Us(g.location,g.matches);me!=null&&z({restoreScrollPosition:me})}return()=>{x=null,w=null,v=null}}function Rn(X,J){return v&&v(X,J.map(me=>RR(me,g.loaderData)))||X.key}function uo(X,J){if(x&&w){let ne=Rn(X,J);x[ne]=w()}}function Us(X,J){if(x){let ne=Rn(X,J),me=x[ne];if(typeof me=="number")return me}return null}function Bs(X,J,ne){if(u)if(X){if(Object.keys(X[0].params).length>0)return{active:!0,matches:Kf(J,ne,l,!0)}}else return{active:!0,matches:Kf(J,ne,l,!0)||[]};return{active:!1,matches:null}}async function Nn(X,J,ne,me){if(!u)return{type:"success",matches:X};let Se=X;for(;;){let I=o==null,V=o||i,D=a;try{await u({signal:ne,path:J,matches:Se,fetcherKey:me,patch:(j,Y)=>{ne.aborted||c_(j,Y,V,D,s)}})}catch(j){return{type:"error",error:j,partialMatches:Se}}finally{I&&!ne.aborted&&(i=[...i])}if(ne.aborted)return{type:"aborted"};let F=Ei(V,J,l);if(F)return{type:"success",matches:F};let M=Kf(V,J,l,!0);if(!M||Se.length===M.length&&Se.every((j,Y)=>j.route.id===M[Y].route.id))return{type:"success",matches:null};Se=M}}function fo(X){a={},o=Ch(X,s,void 0,a)}function er(X,J){let ne=o==null;c_(X,J,o||i,a,s),ne&&(i=[...i],z({}))}return L={get basename(){return l},get future(){return h},get state(){return g},get routes(){return i},get window(){return t},initialize:Te,subscribe:$e,enableScrollRestoration:ds,navigate:He,fetch:tn,revalidate:nt,createHref:X=>e.history.createHref(X),encodeLocation:X=>e.history.encodeLocation(X),getFetcher:je,deleteFetcher:Gt,dispose:_e,getBlocker:Il,deleteBlocker:js,patchRoutes:er,_internalFetchControllers:ie,_internalActiveDeferreds:oe,_internalSetRoutes:fo},L}function tN(e){return e!=null&&("formData"in e&&e.formData!=null||"body"in e&&e.body!==void 0)}function ep(e,t,r,n,s,a,i,o){let l,c;if(i){l=[];for(let h of t)if(l.push(h),h.route.id===i){c=h;break}}else l=t,c=t[t.length-1];let u=Cd(s||".",Id(l,a),ca(e.pathname,r)||e.pathname,o==="path");if(s==null&&(u.search=e.search,u.hash=e.hash),(s==null||s===""||s===".")&&c){let h=Bg(u.search);if(c.route.index&&!h)u.search=u.search?u.search.replace(/^\?/,"?index&"):"?index";else if(!c.route.index&&h){let m=new URLSearchParams(u.search),p=m.getAll("index");m.delete("index"),p.filter(v=>v).forEach(v=>m.append("index",v));let x=m.toString();u.search=x?"?"+x:""}}return n&&r!=="/"&&(u.pathname=u.pathname==="/"?r:ea([r,u.pathname])),$i(u)}function a_(e,t,r,n){if(!n||!tN(n))return{path:r};if(n.formMethod&&!dN(n.formMethod))return{path:r,error:sn(405,{method:n.formMethod})};let s=()=>({path:r,error:sn(400,{type:"invalid-body"})}),a=n.formMethod||"get",i=e?a.toUpperCase():a.toLowerCase(),o=xT(r);if(n.body!==void 0){if(n.formEncType==="text/plain"){if(!Jn(i))return s();let m=typeof n.body=="string"?n.body:n.body instanceof FormData||n.body instanceof URLSearchParams?Array.from(n.body.entries()).reduce((p,x)=>{let[v,w]=x;return""+p+v+"="+w+`
`},""):String(n.body);return{path:r,submission:{formMethod:i,formAction:o,formEncType:n.formEncType,formData:void 0,json:void 0,text:m}}}else if(n.formEncType==="application/json"){if(!Jn(i))return s();try{let m=typeof n.body=="string"?JSON.parse(n.body):n.body;return{path:r,submission:{formMethod:i,formAction:o,formEncType:n.formEncType,formData:void 0,json:m,text:void 0}}}catch{return s()}}}Ge(typeof FormData=="function","FormData is not available in this environment");let l,c;if(n.formData)l=rp(n.formData),c=n.formData;else if(n.body instanceof FormData)l=rp(n.body),c=n.body;else if(n.body instanceof URLSearchParams)l=n.body,c=f_(l);else if(n.body==null)l=new URLSearchParams,c=new FormData;else try{l=new URLSearchParams(n.body),c=f_(l)}catch{return s()}let u={formMethod:i,formAction:o,formEncType:n&&n.formEncType||"application/x-www-form-urlencoded",formData:c,json:void 0,text:void 0};if(Jn(u.formMethod))return{path:r,submission:u};let h=di(r);return t&&h.search&&Bg(h.search)&&l.append("index",""),h.search="?"+l,{path:$i(h),submission:u}}function i_(e,t,r){r===void 0&&(r=!1);let n=e.findIndex(s=>s.route.id===t);return n>=0?e.slice(0,r?n+1:n):e}function o_(e,t,r,n,s,a,i,o,l,c,u,h,m,p,x,v){let w=v?xn(v[1])?v[1].error:v[1].data:void 0,k=e.createURL(t.location),T=e.createURL(s),E=r;a&&t.errors?E=i_(r,Object.keys(t.errors)[0],!0):v&&xn(v[1])&&(E=i_(r,v[0]));let N=v?v[1].statusCode:void 0,O=i&&N&&N>=400,L=E.filter((y,S)=>{let{route:R}=y;if(R.lazy)return!0;if(R.loader==null)return!1;if(a)return tp(R,t.loaderData,t.errors);if(rN(t.loaderData,t.matches[S],y)||l.some(C=>C===y.route.id))return!0;let b=t.matches[S],P=y;return l_(y,Nt({currentUrl:k,currentParams:b.params,nextUrl:T,nextParams:P.params},n,{actionResult:w,actionStatus:N,defaultShouldRevalidate:O?!1:o||k.pathname+k.search===T.pathname+T.search||k.search!==T.search||gT(b,P)}))}),g=[];return h.forEach((y,S)=>{if(a||!r.some(le=>le.route.id===y.routeId)||u.has(S))return;let R=Ei(p,y.path,x);if(!R){g.push({key:S,routeId:y.routeId,path:y.path,matches:null,match:null,controller:null});return}let b=t.fetchers.get(S),P=Jl(R,y.path),C=!1;m.has(S)?C=!1:c.has(S)?(c.delete(S),C=!0):b&&b.state!=="idle"&&b.data===void 0?C=o:C=l_(P,Nt({currentUrl:k,currentParams:t.matches[t.matches.length-1].params,nextUrl:T,nextParams:r[r.length-1].params},n,{actionResult:w,actionStatus:N,defaultShouldRevalidate:O?!1:o})),C&&g.push({key:S,routeId:y.routeId,path:y.path,matches:R,match:P,controller:new AbortController})}),[L,g]}function tp(e,t,r){if(e.lazy)return!0;if(!e.loader)return!1;let n=t!=null&&t[e.id]!==void 0,s=r!=null&&r[e.id]!==void 0;return!n&&s?!1:typeof e.loader=="function"&&e.loader.hydrate===!0?!0:!n&&!s}function rN(e,t,r){let n=!t||r.route.id!==t.route.id,s=e[r.route.id]===void 0;return n||s}function gT(e,t){let r=e.route.path;return e.pathname!==t.pathname||r!=null&&r.endsWith("*")&&e.params["*"]!==t.params["*"]}function l_(e,t){if(e.route.shouldRevalidate){let r=e.route.shouldRevalidate(t);if(typeof r=="boolean")return r}return t.defaultShouldRevalidate}function c_(e,t,r,n,s){var a;let i;if(e){let c=n[e];Ge(c,"No route found to patch children into: routeId = "+e),c.children||(c.children=[]),i=c.children}else i=r;let o=t.filter(c=>!i.some(u=>vT(c,u))),l=Ch(o,s,[e||"_","patch",String(((a=i)==null?void 0:a.length)||"0")],n);i.push(...l)}function vT(e,t){return"id"in e&&"id"in t&&e.id===t.id?!0:e.index===t.index&&e.path===t.path&&e.caseSensitive===t.caseSensitive?(!e.children||e.children.length===0)&&(!t.children||t.children.length===0)?!0:e.children.every((r,n)=>{var s;return(s=t.children)==null?void 0:s.some(a=>vT(r,a))}):!1}async function nN(e,t,r){if(!e.lazy)return;let n=await e.lazy();if(!e.lazy)return;let s=r[e.id];Ge(s,"No route found in manifest");let a={};for(let i in n){let l=s[i]!==void 0&&i!=="hasErrorBoundary";nl(!l,'Route "'+s.id+'" has a static property "'+i+'" defined but its lazy function is also returning a value for this property. '+('The lazy route property "'+i+'" will be ignored.')),!l&&!IR.has(i)&&(a[i]=n[i])}Object.assign(s,a),Object.assign(s,Nt({},t(s),{lazy:void 0}))}async function sN(e){let{matches:t}=e,r=t.filter(s=>s.shouldLoad);return(await Promise.all(r.map(s=>s.resolve()))).reduce((s,a,i)=>Object.assign(s,{[r[i].route.id]:a}),{})}async function aN(e,t,r,n,s,a,i,o,l,c){let u=a.map(p=>p.route.lazy?nN(p.route,l,o):void 0),h=a.map((p,x)=>{let v=u[x],w=s.some(T=>T.route.id===p.route.id);return Nt({},p,{shouldLoad:w,resolve:async T=>(T&&n.method==="GET"&&(p.route.lazy||p.route.loader)&&(w=!0),w?iN(t,n,p,v,T,c):Promise.resolve({type:mt.data,result:void 0}))})}),m=await e({matches:h,request:n,params:a[0].params,fetcherKey:i,context:c});try{await Promise.all(u)}catch{}return m}async function iN(e,t,r,n,s,a){let i,o,l=c=>{let u,h=new Promise((x,v)=>u=v);o=()=>u(),t.signal.addEventListener("abort",o);let m=x=>typeof c!="function"?Promise.reject(new Error("You cannot call the handler for a route which defines a boolean "+('"'+e+'" [routeId: '+r.route.id+"]"))):c({request:t,params:r.params,context:a},...x!==void 0?[x]:[]),p=(async()=>{try{return{type:"data",result:await(s?s(v=>m(v)):m())}}catch(x){return{type:"error",result:x}}})();return Promise.race([p,h])};try{let c=r.route[e];if(n)if(c){let u,[h]=await Promise.all([l(c).catch(m=>{u=m}),n]);if(u!==void 0)throw u;i=h}else if(await n,c=r.route[e],c)i=await l(c);else if(e==="action"){let u=new URL(t.url),h=u.pathname+u.search;throw sn(405,{method:t.method,pathname:h,routeId:r.route.id})}else return{type:mt.data,result:void 0};else if(c)i=await l(c);else{let u=new URL(t.url),h=u.pathname+u.search;throw sn(404,{pathname:h})}Ge(i.result!==void 0,"You defined "+(e==="action"?"an action":"a loader")+" for route "+('"'+r.route.id+"\" but didn't return anything from your `"+e+"` ")+"function. Please return a value or `null`.")}catch(c){return{type:mt.error,result:c}}finally{o&&t.signal.removeEventListener("abort",o)}return i}async function oN(e){let{result:t,type:r}=e;if(_T(t)){let h;try{let m=t.headers.get("Content-Type");m&&/\bapplication\/json\b/.test(m)?t.body==null?h=null:h=await t.json():h=await t.text()}catch(m){return{type:mt.error,error:m}}return r===mt.error?{type:mt.error,error:new Nh(t.status,t.statusText,h),statusCode:t.status,headers:t.headers}:{type:mt.data,data:h,statusCode:t.status,headers:t.headers}}if(r===mt.error){if(g_(t)){var n,s;if(t.data instanceof Error){var a,i;return{type:mt.error,error:t.data,statusCode:(a=t.init)==null?void 0:a.status,headers:(i=t.init)!=null&&i.headers?new Headers(t.init.headers):void 0}}return{type:mt.error,error:new Nh(((n=t.init)==null?void 0:n.status)||500,void 0,t.data),statusCode:Xc(t)?t.status:void 0,headers:(s=t.init)!=null&&s.headers?new Headers(t.init.headers):void 0}}return{type:mt.error,error:t,statusCode:Xc(t)?t.status:void 0}}if(hN(t)){var o,l;return{type:mt.deferred,deferredData:t,statusCode:(o=t.init)==null?void 0:o.status,headers:((l=t.init)==null?void 0:l.headers)&&new Headers(t.init.headers)}}if(g_(t)){var c,u;return{type:mt.data,data:t.data,statusCode:(c=t.init)==null?void 0:c.status,headers:(u=t.init)!=null&&u.headers?new Headers(t.init.headers):void 0}}return{type:mt.data,data:t}}function lN(e,t,r,n,s,a){let i=e.headers.get("Location");if(Ge(i,"Redirects returned/thrown from loaders/actions must have a Location header"),!Vg.test(i)){let o=n.slice(0,n.findIndex(l=>l.route.id===r)+1);i=ep(new URL(t.url),o,s,!0,i,a),e.headers.set("Location",i)}return e}function u_(e,t,r){if(Vg.test(e)){let n=e,s=n.startsWith("//")?new URL(t.protocol+n):new URL(n),a=ca(s.pathname,r)!=null;if(s.origin===t.origin&&a)return s.pathname+s.search+s.hash}return e}function vo(e,t,r,n){let s=e.createURL(xT(t)).toString(),a={signal:r};if(n&&Jn(n.formMethod)){let{formMethod:i,formEncType:o}=n;a.method=i.toUpperCase(),o==="application/json"?(a.headers=new Headers({"Content-Type":o}),a.body=JSON.stringify(n.json)):o==="text/plain"?a.body=n.text:o==="application/x-www-form-urlencoded"&&n.formData?a.body=rp(n.formData):a.body=n.formData}return new Request(s,a)}function rp(e){let t=new URLSearchParams;for(let[r,n]of e.entries())t.append(r,typeof n=="string"?n:n.name);return t}function f_(e){let t=new FormData;for(let[r,n]of e.entries())t.append(r,n);return t}function cN(e,t,r,n,s){let a={},i=null,o,l=!1,c={},u=r&&xn(r[1])?r[1].error:void 0;return e.forEach(h=>{if(!(h.route.id in t))return;let m=h.route.id,p=t[m];if(Ge(!Ci(p),"Cannot handle redirect results in processLoaderData"),xn(p)){let x=p.error;u!==void 0&&(x=u,u=void 0),i=i||{};{let v=Ti(e,m);i[v.route.id]==null&&(i[v.route.id]=x)}a[m]=void 0,l||(l=!0,o=Xc(p.error)?p.error.status:500),p.headers&&(c[m]=p.headers)}else Va(p)?(n.set(m,p.deferredData),a[m]=p.deferredData.data,p.statusCode!=null&&p.statusCode!==200&&!l&&(o=p.statusCode),p.headers&&(c[m]=p.headers)):(a[m]=p.data,p.statusCode&&p.statusCode!==200&&!l&&(o=p.statusCode),p.headers&&(c[m]=p.headers))}),u!==void 0&&r&&(i={[r[0]]:u},a[r[0]]=void 0),{loaderData:a,errors:i,statusCode:o||200,loaderHeaders:c}}function h_(e,t,r,n,s,a,i){let{loaderData:o,errors:l}=cN(t,r,n,i);return s.forEach(c=>{let{key:u,match:h,controller:m}=c,p=a[u];if(Ge(p,"Did not find corresponding fetcher result"),!(m&&m.signal.aborted))if(xn(p)){let x=Ti(e.matches,h==null?void 0:h.route.id);l&&l[x.route.id]||(l=Nt({},l,{[x.route.id]:p.error})),e.fetchers.delete(u)}else if(Ci(p))Ge(!1,"Unhandled fetcher revalidation redirect");else if(Va(p))Ge(!1,"Unhandled fetcher deferred data");else{let x=Ca(p.data);e.fetchers.set(u,x)}}),{loaderData:o,errors:l}}function d_(e,t,r,n){let s=Nt({},t);for(let a of r){let i=a.route.id;if(t.hasOwnProperty(i)?t[i]!==void 0&&(s[i]=t[i]):e[i]!==void 0&&a.route.loader&&(s[i]=e[i]),n&&n.hasOwnProperty(i))break}return s}function m_(e){return e?xn(e[1])?{actionData:{}}:{actionData:{[e[0]]:e[1].data}}:{}}function Ti(e,t){return(t?e.slice(0,e.findIndex(n=>n.route.id===t)+1):[...e]).reverse().find(n=>n.route.hasErrorBoundary===!0)||e[0]}function p_(e){let t=e.length===1?e[0]:e.find(r=>r.index||!r.path||r.path==="/")||{id:"__shim-error-route__"};return{matches:[{params:{},pathname:"",pathnameBase:"",route:t}],route:t}}function sn(e,t){let{pathname:r,routeId:n,method:s,type:a,message:i}=t===void 0?{}:t,o="Unknown Server Error",l="Unknown @remix-run/router error";return e===400?(o="Bad Request",s&&r&&n?l="You made a "+s+' request to "'+r+'" but '+('did not provide a `loader` for route "'+n+'", ')+"so there is no way to handle the request.":a==="defer-action"?l="defer() is not supported in actions":a==="invalid-body"&&(l="Unable to encode submission body")):e===403?(o="Forbidden",l='Route "'+n+'" does not match URL "'+r+'"'):e===404?(o="Not Found",l='No route matches URL "'+r+'"'):e===405&&(o="Method Not Allowed",s&&r&&n?l="You made a "+s.toUpperCase()+' request to "'+r+'" but '+('did not provide an `action` for route "'+n+'", ')+"so there is no way to handle the request.":s&&(l='Invalid request method "'+s.toUpperCase()+'"')),new Nh(e||500,o,new Error(l),!0)}function _f(e){let t=Object.entries(e);for(let r=t.length-1;r>=0;r--){let[n,s]=t[r];if(Ci(s))return{key:n,result:s}}}function xT(e){let t=typeof e=="string"?di(e):e;return $i(Nt({},t,{hash:""}))}function uN(e,t){return e.pathname!==t.pathname||e.search!==t.search?!1:e.hash===""?t.hash!=="":e.hash===t.hash?!0:t.hash!==""}function fN(e){return _T(e.result)&&YR.has(e.result.status)}function Va(e){return e.type===mt.deferred}function xn(e){return e.type===mt.error}function Ci(e){return(e&&e.type)===mt.redirect}function g_(e){return typeof e=="object"&&e!=null&&"type"in e&&"data"in e&&"init"in e&&e.type==="DataWithResponseInit"}function hN(e){let t=e;return t&&typeof t=="object"&&typeof t.data=="object"&&typeof t.subscribe=="function"&&typeof t.cancel=="function"&&typeof t.resolveData=="function"}function _T(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.headers=="object"&&typeof e.body<"u"}function dN(e){return XR.has(e.toLowerCase())}function Jn(e){return KR.has(e.toLowerCase())}async function mN(e,t,r,n,s){let a=Object.entries(t);for(let i=0;i<a.length;i++){let[o,l]=a[i],c=e.find(m=>(m==null?void 0:m.route.id)===o);if(!c)continue;let u=n.find(m=>m.route.id===c.route.id),h=u!=null&&!gT(u,c)&&(s&&s[c.route.id])!==void 0;Va(l)&&h&&await Ug(l,r,!1).then(m=>{m&&(t[o]=m)})}}async function pN(e,t,r){for(let n=0;n<r.length;n++){let{key:s,routeId:a,controller:i}=r[n],o=t[s];e.find(c=>(c==null?void 0:c.route.id)===a)&&Va(o)&&(Ge(i,"Expected an AbortController for revalidating fetcher deferred result"),await Ug(o,i.signal,!0).then(c=>{c&&(t[s]=c)}))}}async function Ug(e,t,r){if(r===void 0&&(r=!1),!await e.deferredData.resolveData(t)){if(r)try{return{type:mt.data,data:e.deferredData.unwrappedData}}catch(s){return{type:mt.error,error:s}}return{type:mt.data,data:e.deferredData.data}}}function Bg(e){return new URLSearchParams(e).getAll("index").some(t=>t==="")}function Jl(e,t){let r=typeof t=="string"?di(t).search:t.search;if(e[e.length-1].route.index&&Bg(r||""))return e[e.length-1];let n=dT(e);return n[n.length-1]}function v_(e){let{formMethod:t,formAction:r,formEncType:n,text:s,formData:a,json:i}=e;if(!(!t||!r||!n)){if(s!=null)return{formMethod:t,formAction:r,formEncType:n,formData:void 0,json:void 0,text:s};if(a!=null)return{formMethod:t,formAction:r,formEncType:n,formData:a,json:void 0,text:void 0};if(i!==void 0)return{formMethod:t,formAction:r,formEncType:n,formData:void 0,json:i,text:void 0}}}function j0(e,t){return t?{state:"loading",location:e,formMethod:t.formMethod,formAction:t.formAction,formEncType:t.formEncType,formData:t.formData,json:t.json,text:t.text}:{state:"loading",location:e,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0}}function gN(e,t){return{state:"submitting",location:e,formMethod:t.formMethod,formAction:t.formAction,formEncType:t.formEncType,formData:t.formData,json:t.json,text:t.text}}function Hl(e,t){return e?{state:"loading",formMethod:e.formMethod,formAction:e.formAction,formEncType:e.formEncType,formData:e.formData,json:e.json,text:e.text,data:t}:{state:"loading",formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0,data:t}}function vN(e,t){return{state:"submitting",formMethod:e.formMethod,formAction:e.formAction,formEncType:e.formEncType,formData:e.formData,json:e.json,text:e.text,data:t?t.data:void 0}}function Ca(e){return{state:"idle",formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0,data:e}}function xN(e,t){try{let r=e.sessionStorage.getItem(pT);if(r){let n=JSON.parse(r);for(let[s,a]of Object.entries(n||{}))a&&Array.isArray(a)&&t.set(s,new Set(a||[]))}}catch{}}function _N(e,t){if(t.size>0){let r={};for(let[n,s]of t)r[n]=[...s];try{e.sessionStorage.setItem(pT,JSON.stringify(r))}catch(n){nl(!1,"Failed to save applied view transitions in sessionStorage ("+n+").")}}}/**
 * React Router v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function bh(){return bh=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},bh.apply(this,arguments)}const yu=W.createContext(null),zg=W.createContext(null),xa=W.createContext(null),$g=W.createContext(null),bs=W.createContext({outlet:null,matches:[],isDataRoute:!1}),yT=W.createContext(null);function yN(e,t){let{relative:r}=t===void 0?{}:t;_l()||Ge(!1);let{basename:n,navigator:s}=W.useContext(xa),{hash:a,pathname:i,search:o}=Rd(e,{relative:r}),l=i;return n!=="/"&&(l=i==="/"?n:ea([n,i])),s.createHref({pathname:l,search:o,hash:a})}function _l(){return W.useContext($g)!=null}function _a(){return _l()||Ge(!1),W.useContext($g).location}function wT(e){W.useContext(xa).static||W.useLayoutEffect(e)}function mi(){let{isDataRoute:e}=W.useContext(bs);return e?ON():wN()}function wN(){_l()||Ge(!1);let e=W.useContext(yu),{basename:t,future:r,navigator:n}=W.useContext(xa),{matches:s}=W.useContext(bs),{pathname:a}=_a(),i=JSON.stringify(Id(s,r.v7_relativeSplatPath)),o=W.useRef(!1);return wT(()=>{o.current=!0}),W.useCallback(function(c,u){if(u===void 0&&(u={}),!o.current)return;if(typeof c=="number"){n.go(c);return}let h=Cd(c,JSON.parse(i),a,u.relative==="path");e==null&&t!=="/"&&(h.pathname=h.pathname==="/"?t:ea([t,h.pathname])),(u.replace?n.replace:n.push)(h,u.state,u)},[t,n,i,a,e])}const EN=W.createContext(null);function TN(e){let t=W.useContext(bs).outlet;return t&&W.createElement(EN.Provider,{value:e},t)}function kN(){let{matches:e}=W.useContext(bs),t=e[e.length-1];return t?t.params:{}}function Rd(e,t){let{relative:r}=t===void 0?{}:t,{future:n}=W.useContext(xa),{matches:s}=W.useContext(bs),{pathname:a}=_a(),i=JSON.stringify(Id(s,n.v7_relativeSplatPath));return W.useMemo(()=>Cd(e,JSON.parse(i),a,r==="path"),[e,i,a,r])}function SN(e,t,r,n){_l()||Ge(!1);let{navigator:s}=W.useContext(xa),{matches:a}=W.useContext(bs),i=a[a.length-1],o=i?i.params:{};i&&i.pathname;let l=i?i.pathnameBase:"/";i&&i.route;let c=_a(),u;u=c;let h=u.pathname||"/",m=h;if(l!=="/"){let v=l.replace(/^\//,"").split("/");m="/"+h.replace(/^\//,"").split("/").slice(v.length).join("/")}let p=Ei(e,{pathname:m});return NN(p&&p.map(v=>Object.assign({},v,{params:Object.assign({},o,v.params),pathname:ea([l,s.encodeLocation?s.encodeLocation(v.pathname).pathname:v.pathname]),pathnameBase:v.pathnameBase==="/"?l:ea([l,s.encodeLocation?s.encodeLocation(v.pathnameBase).pathname:v.pathnameBase])})),a,r,n)}function AN(){let e=FN(),t=Xc(e)?e.status+" "+e.statusText:e instanceof Error?e.message:JSON.stringify(e),r=e instanceof Error?e.stack:null,s={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return W.createElement(W.Fragment,null,W.createElement("h2",null,"Unexpected Application Error!"),W.createElement("h3",{style:{fontStyle:"italic"}},t),r?W.createElement("pre",{style:s},r):null,null)}const IN=W.createElement(AN,null);class CN extends W.Component{constructor(t){super(t),this.state={location:t.location,revalidation:t.revalidation,error:t.error}}static getDerivedStateFromError(t){return{error:t}}static getDerivedStateFromProps(t,r){return r.location!==t.location||r.revalidation!=="idle"&&t.revalidation==="idle"?{error:t.error,location:t.location,revalidation:t.revalidation}:{error:t.error!==void 0?t.error:r.error,location:r.location,revalidation:t.revalidation||r.revalidation}}componentDidCatch(t,r){console.error("React Router caught the following error during render",t,r)}render(){return this.state.error!==void 0?W.createElement(bs.Provider,{value:this.props.routeContext},W.createElement(yT.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function RN(e){let{routeContext:t,match:r,children:n}=e,s=W.useContext(yu);return s&&s.static&&s.staticContext&&(r.route.errorElement||r.route.ErrorBoundary)&&(s.staticContext._deepestRenderedBoundaryId=r.route.id),W.createElement(bs.Provider,{value:t},n)}function NN(e,t,r,n){var s;if(t===void 0&&(t=[]),r===void 0&&(r=null),n===void 0&&(n=null),e==null){var a;if(!r)return null;if(r.errors)e=r.matches;else if((a=n)!=null&&a.v7_partialHydration&&t.length===0&&!r.initialized&&r.matches.length>0)e=r.matches;else return null}let i=e,o=(s=r)==null?void 0:s.errors;if(o!=null){let u=i.findIndex(h=>h.route.id&&(o==null?void 0:o[h.route.id])!==void 0);u>=0||Ge(!1),i=i.slice(0,Math.min(i.length,u+1))}let l=!1,c=-1;if(r&&n&&n.v7_partialHydration)for(let u=0;u<i.length;u++){let h=i[u];if((h.route.HydrateFallback||h.route.hydrateFallbackElement)&&(c=u),h.route.id){let{loaderData:m,errors:p}=r,x=h.route.loader&&m[h.route.id]===void 0&&(!p||p[h.route.id]===void 0);if(h.route.lazy||x){l=!0,c>=0?i=i.slice(0,c+1):i=[i[0]];break}}}return i.reduceRight((u,h,m)=>{let p,x=!1,v=null,w=null;r&&(p=o&&h.route.id?o[h.route.id]:void 0,v=h.route.errorElement||IN,l&&(c<0&&m===0?(MN("route-fallback"),x=!0,w=null):c===m&&(x=!0,w=h.route.hydrateFallbackElement||null)));let k=t.concat(i.slice(0,m+1)),T=()=>{let E;return p?E=v:x?E=w:h.route.Component?E=W.createElement(h.route.Component,null):h.route.element?E=h.route.element:E=u,W.createElement(RN,{match:h,routeContext:{outlet:u,matches:k,isDataRoute:r!=null},children:E})};return r&&(h.route.ErrorBoundary||h.route.errorElement||m===0)?W.createElement(CN,{location:r.location,revalidation:r.revalidation,component:v,error:p,children:T(),routeContext:{outlet:null,matches:k,isDataRoute:!0}}):T()},null)}var ET=function(e){return e.UseBlocker="useBlocker",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e}(ET||{}),TT=function(e){return e.UseBlocker="useBlocker",e.UseLoaderData="useLoaderData",e.UseActionData="useActionData",e.UseRouteError="useRouteError",e.UseNavigation="useNavigation",e.UseRouteLoaderData="useRouteLoaderData",e.UseMatches="useMatches",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e.UseRouteId="useRouteId",e}(TT||{});function bN(e){let t=W.useContext(yu);return t||Ge(!1),t}function PN(e){let t=W.useContext(zg);return t||Ge(!1),t}function DN(e){let t=W.useContext(bs);return t||Ge(!1),t}function kT(e){let t=DN(),r=t.matches[t.matches.length-1];return r.route.id||Ge(!1),r.route.id}function FN(){var e;let t=W.useContext(yT),r=PN(TT.UseRouteError),n=kT();return t!==void 0?t:(e=r.errors)==null?void 0:e[n]}function ON(){let{router:e}=bN(ET.UseNavigateStable),t=kT(),r=W.useRef(!1);return wT(()=>{r.current=!0}),W.useCallback(function(s,a){a===void 0&&(a={}),r.current&&(typeof s=="number"?e.navigate(s):e.navigate(s,bh({fromRouteId:t},a)))},[e,t])}const x_={};function MN(e,t,r){x_[e]||(x_[e]=!0)}function LN(e,t){e==null||e.v7_startTransition,(e==null?void 0:e.v7_relativeSplatPath)===void 0&&(!t||t.v7_relativeSplatPath),t&&(t.v7_fetcherPersist,t.v7_normalizeFormMethod,t.v7_partialHydration,t.v7_skipActionErrorRevalidation)}function jN(e){let{to:t,replace:r,state:n,relative:s}=e;_l()||Ge(!1);let{future:a,static:i}=W.useContext(xa),{matches:o}=W.useContext(bs),{pathname:l}=_a(),c=mi(),u=Cd(t,Id(o,a.v7_relativeSplatPath),l,s==="path"),h=JSON.stringify(u);return W.useEffect(()=>c(JSON.parse(h),{replace:r,state:n,relative:s}),[c,h,s,r,n]),null}function ST(e){return TN(e.context)}function VN(e){let{basename:t="/",children:r=null,location:n,navigationType:s=Qt.Pop,navigator:a,static:i=!1,future:o}=e;_l()&&Ge(!1);let l=t.replace(/^\/*/,"/"),c=W.useMemo(()=>({basename:l,navigator:a,static:i,future:bh({v7_relativeSplatPath:!1},o)}),[l,o,a,i]);typeof n=="string"&&(n=di(n));let{pathname:u="/",search:h="",hash:m="",state:p=null,key:x="default"}=n,v=W.useMemo(()=>{let w=ca(u,l);return w==null?null:{location:{pathname:w,search:h,hash:m,state:p,key:x},navigationType:s}},[l,u,h,m,p,x,s]);return v==null?null:W.createElement(xa.Provider,{value:c},W.createElement($g.Provider,{children:r,value:v}))}new Promise(()=>{});function UN(e){let t={hasErrorBoundary:e.ErrorBoundary!=null||e.errorElement!=null};return e.Component&&Object.assign(t,{element:W.createElement(e.Component),Component:void 0}),e.HydrateFallback&&Object.assign(t,{hydrateFallbackElement:W.createElement(e.HydrateFallback),HydrateFallback:void 0}),e.ErrorBoundary&&Object.assign(t,{errorElement:W.createElement(e.ErrorBoundary),ErrorBoundary:void 0}),t}/**
 * React Router DOM v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function sl(){return sl=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},sl.apply(this,arguments)}function AT(e,t){if(e==null)return{};var r={},n=Object.keys(e),s,a;for(a=0;a<n.length;a++)s=n[a],!(t.indexOf(s)>=0)&&(r[s]=e[s]);return r}function BN(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}function zN(e,t){return e.button===0&&(!t||t==="_self")&&!BN(e)}const $N=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],WN=["aria-current","caseSensitive","className","end","style","to","viewTransition","children"],HN="6";try{window.__reactRouterVersion=HN}catch{}function GN(e,t){return eN({basename:void 0,future:sl({},void 0,{v7_prependBasename:!0}),history:kR({window:void 0}),hydrationData:KN(),routes:e,mapRouteProperties:UN,dataStrategy:void 0,patchRoutesOnNavigation:void 0,window:void 0}).initialize()}function KN(){var e;let t=(e=window)==null?void 0:e.__staticRouterHydrationData;return t&&t.errors&&(t=sl({},t,{errors:qN(t.errors)})),t}function qN(e){if(!e)return null;let t=Object.entries(e),r={};for(let[n,s]of t)if(s&&s.__type==="RouteErrorResponse")r[n]=new Nh(s.status,s.statusText,s.data,s.internal===!0);else if(s&&s.__type==="Error"){if(s.__subType){let a=window[s.__subType];if(typeof a=="function")try{let i=new a(s.message);i.stack="",r[n]=i}catch{}}if(r[n]==null){let a=new Error(s.message);a.stack="",r[n]=a}}else r[n]=s;return r}const IT=W.createContext({isTransitioning:!1}),XN=W.createContext(new Map),YN="startTransition",__=fC[YN],QN="flushSync",y_=TR[QN];function JN(e){__?__(e):e()}function Gl(e){y_?y_(e):e()}let ZN=class{constructor(){this.status="pending",this.promise=new Promise((t,r)=>{this.resolve=n=>{this.status==="pending"&&(this.status="resolved",t(n))},this.reject=n=>{this.status==="pending"&&(this.status="rejected",r(n))}})}};function eb(e){let{fallbackElement:t,router:r,future:n}=e,[s,a]=W.useState(r.state),[i,o]=W.useState(),[l,c]=W.useState({isTransitioning:!1}),[u,h]=W.useState(),[m,p]=W.useState(),[x,v]=W.useState(),w=W.useRef(new Map),{v7_startTransition:k}=n||{},T=W.useCallback(y=>{k?JN(y):y()},[k]),E=W.useCallback((y,S)=>{let{deletedFetchers:R,flushSync:b,viewTransitionOpts:P}=S;y.fetchers.forEach((le,se)=>{le.data!==void 0&&w.current.set(se,le.data)}),R.forEach(le=>w.current.delete(le));let C=r.window==null||r.window.document==null||typeof r.window.document.startViewTransition!="function";if(!P||C){b?Gl(()=>a(y)):T(()=>a(y));return}if(b){Gl(()=>{m&&(u&&u.resolve(),m.skipTransition()),c({isTransitioning:!0,flushSync:!0,currentLocation:P.currentLocation,nextLocation:P.nextLocation})});let le=r.window.document.startViewTransition(()=>{Gl(()=>a(y))});le.finished.finally(()=>{Gl(()=>{h(void 0),p(void 0),o(void 0),c({isTransitioning:!1})})}),Gl(()=>p(le));return}m?(u&&u.resolve(),m.skipTransition(),v({state:y,currentLocation:P.currentLocation,nextLocation:P.nextLocation})):(o(y),c({isTransitioning:!0,flushSync:!1,currentLocation:P.currentLocation,nextLocation:P.nextLocation}))},[r.window,m,u,w,T]);W.useLayoutEffect(()=>r.subscribe(E),[r,E]),W.useEffect(()=>{l.isTransitioning&&!l.flushSync&&h(new ZN)},[l]),W.useEffect(()=>{if(u&&i&&r.window){let y=i,S=u.promise,R=r.window.document.startViewTransition(async()=>{T(()=>a(y)),await S});R.finished.finally(()=>{h(void 0),p(void 0),o(void 0),c({isTransitioning:!1})}),p(R)}},[T,i,u,r.window]),W.useEffect(()=>{u&&i&&s.location.key===i.location.key&&u.resolve()},[u,m,s.location,i]),W.useEffect(()=>{!l.isTransitioning&&x&&(o(x.state),c({isTransitioning:!0,flushSync:!1,currentLocation:x.currentLocation,nextLocation:x.nextLocation}),v(void 0))},[l.isTransitioning,x]),W.useEffect(()=>{},[]);let N=W.useMemo(()=>({createHref:r.createHref,encodeLocation:r.encodeLocation,go:y=>r.navigate(y),push:(y,S,R)=>r.navigate(y,{state:S,preventScrollReset:R==null?void 0:R.preventScrollReset}),replace:(y,S,R)=>r.navigate(y,{replace:!0,state:S,preventScrollReset:R==null?void 0:R.preventScrollReset})}),[r]),O=r.basename||"/",L=W.useMemo(()=>({router:r,navigator:N,static:!1,basename:O}),[r,N,O]),g=W.useMemo(()=>({v7_relativeSplatPath:r.future.v7_relativeSplatPath}),[r.future.v7_relativeSplatPath]);return W.useEffect(()=>LN(n,r.future),[n,r.future]),W.createElement(W.Fragment,null,W.createElement(yu.Provider,{value:L},W.createElement(zg.Provider,{value:s},W.createElement(XN.Provider,{value:w.current},W.createElement(IT.Provider,{value:l},W.createElement(VN,{basename:O,location:s.location,navigationType:s.historyAction,navigator:N,future:g},s.initialized||r.future.v7_partialHydration?W.createElement(tb,{routes:r.routes,future:r.future,state:s}):t))))),null)}const tb=W.memo(rb);function rb(e){let{routes:t,future:r,state:n}=e;return SN(t,void 0,n,r)}const nb=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",sb=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,et=W.forwardRef(function(t,r){let{onClick:n,relative:s,reloadDocument:a,replace:i,state:o,target:l,to:c,preventScrollReset:u,viewTransition:h}=t,m=AT(t,$N),{basename:p}=W.useContext(xa),x,v=!1;if(typeof c=="string"&&sb.test(c)&&(x=c,nb))try{let E=new URL(window.location.href),N=c.startsWith("//")?new URL(E.protocol+c):new URL(c),O=ca(N.pathname,p);N.origin===E.origin&&O!=null?c=O+N.search+N.hash:v=!0}catch{}let w=yN(c,{relative:s}),k=ib(c,{replace:i,state:o,target:l,preventScrollReset:u,relative:s,viewTransition:h});function T(E){n&&n(E),E.defaultPrevented||k(E)}return W.createElement("a",sl({},m,{href:x||w,onClick:v||a?n:T,ref:r,target:l}))}),Sa=W.forwardRef(function(t,r){let{"aria-current":n="page",caseSensitive:s=!1,className:a="",end:i=!1,style:o,to:l,viewTransition:c,children:u}=t,h=AT(t,WN),m=Rd(l,{relative:h.relative}),p=_a(),x=W.useContext(zg),{navigator:v,basename:w}=W.useContext(xa),k=x!=null&&ob(m)&&c===!0,T=v.encodeLocation?v.encodeLocation(m).pathname:m.pathname,E=p.pathname,N=x&&x.navigation&&x.navigation.location?x.navigation.location.pathname:null;s||(E=E.toLowerCase(),N=N?N.toLowerCase():null,T=T.toLowerCase()),N&&w&&(N=ca(N,w)||N);const O=T!=="/"&&T.endsWith("/")?T.length-1:T.length;let L=E===T||!i&&E.startsWith(T)&&E.charAt(O)==="/",g=N!=null&&(N===T||!i&&N.startsWith(T)&&N.charAt(T.length)==="/"),y={isActive:L,isPending:g,isTransitioning:k},S=L?n:void 0,R;typeof a=="function"?R=a(y):R=[a,L?"active":null,g?"pending":null,k?"transitioning":null].filter(Boolean).join(" ");let b=typeof o=="function"?o(y):o;return W.createElement(et,sl({},h,{"aria-current":S,className:R,ref:r,style:b,to:l,viewTransition:c}),typeof u=="function"?u(y):u)});var np;(function(e){e.UseScrollRestoration="useScrollRestoration",e.UseSubmit="useSubmit",e.UseSubmitFetcher="useSubmitFetcher",e.UseFetcher="useFetcher",e.useViewTransitionState="useViewTransitionState"})(np||(np={}));var w_;(function(e){e.UseFetcher="useFetcher",e.UseFetchers="useFetchers",e.UseScrollRestoration="useScrollRestoration"})(w_||(w_={}));function ab(e){let t=W.useContext(yu);return t||Ge(!1),t}function ib(e,t){let{target:r,replace:n,state:s,preventScrollReset:a,relative:i,viewTransition:o}=t===void 0?{}:t,l=mi(),c=_a(),u=Rd(e,{relative:i});return W.useCallback(h=>{if(zN(h,r)){h.preventDefault();let m=n!==void 0?n:$i(c)===$i(u);l(e,{replace:m,state:s,preventScrollReset:a,relative:i,viewTransition:o})}},[c,l,u,n,s,r,e,a,i,o])}function ob(e,t){t===void 0&&(t={});let r=W.useContext(IT);r==null&&Ge(!1);let{basename:n}=ab(np.useViewTransitionState),s=Rd(e,{relative:t.relative});if(!r.isTransitioning)return!1;let a=ca(r.currentLocation.pathname,n)||r.currentLocation.pathname,i=ca(r.nextLocation.pathname,n)||r.nextLocation.pathname;return Rh(s.pathname,i)!=null||Rh(s.pathname,a)!=null}var E_={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const CT=function(e){const t=[];let r=0;for(let n=0;n<e.length;n++){let s=e.charCodeAt(n);s<128?t[r++]=s:s<2048?(t[r++]=s>>6|192,t[r++]=s&63|128):(s&64512)===55296&&n+1<e.length&&(e.charCodeAt(n+1)&64512)===56320?(s=65536+((s&1023)<<10)+(e.charCodeAt(++n)&1023),t[r++]=s>>18|240,t[r++]=s>>12&63|128,t[r++]=s>>6&63|128,t[r++]=s&63|128):(t[r++]=s>>12|224,t[r++]=s>>6&63|128,t[r++]=s&63|128)}return t},lb=function(e){const t=[];let r=0,n=0;for(;r<e.length;){const s=e[r++];if(s<128)t[n++]=String.fromCharCode(s);else if(s>191&&s<224){const a=e[r++];t[n++]=String.fromCharCode((s&31)<<6|a&63)}else if(s>239&&s<365){const a=e[r++],i=e[r++],o=e[r++],l=((s&7)<<18|(a&63)<<12|(i&63)<<6|o&63)-65536;t[n++]=String.fromCharCode(55296+(l>>10)),t[n++]=String.fromCharCode(56320+(l&1023))}else{const a=e[r++],i=e[r++];t[n++]=String.fromCharCode((s&15)<<12|(a&63)<<6|i&63)}}return t.join("")},RT={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(e,t){if(!Array.isArray(e))throw Error("encodeByteArray takes an array as a parameter");this.init_();const r=t?this.byteToCharMapWebSafe_:this.byteToCharMap_,n=[];for(let s=0;s<e.length;s+=3){const a=e[s],i=s+1<e.length,o=i?e[s+1]:0,l=s+2<e.length,c=l?e[s+2]:0,u=a>>2,h=(a&3)<<4|o>>4;let m=(o&15)<<2|c>>6,p=c&63;l||(p=64,i||(m=64)),n.push(r[u],r[h],r[m],r[p])}return n.join("")},encodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?btoa(e):this.encodeByteArray(CT(e),t)},decodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?atob(e):lb(this.decodeStringToByteArray(e,t))},decodeStringToByteArray(e,t){this.init_();const r=t?this.charToByteMapWebSafe_:this.charToByteMap_,n=[];for(let s=0;s<e.length;){const a=r[e.charAt(s++)],o=s<e.length?r[e.charAt(s)]:0;++s;const c=s<e.length?r[e.charAt(s)]:64;++s;const h=s<e.length?r[e.charAt(s)]:64;if(++s,a==null||o==null||c==null||h==null)throw new cb;const m=a<<2|o>>4;if(n.push(m),c!==64){const p=o<<4&240|c>>2;if(n.push(p),h!==64){const x=c<<6&192|h;n.push(x)}}}return n},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let e=0;e<this.ENCODED_VALS.length;e++)this.byteToCharMap_[e]=this.ENCODED_VALS.charAt(e),this.charToByteMap_[this.byteToCharMap_[e]]=e,this.byteToCharMapWebSafe_[e]=this.ENCODED_VALS_WEBSAFE.charAt(e),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[e]]=e,e>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(e)]=e,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(e)]=e)}}};class cb extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const ub=function(e){const t=CT(e);return RT.encodeByteArray(t,!0)},Ph=function(e){return ub(e).replace(/\./g,"")},NT=function(e){try{return RT.decodeString(e,!0)}catch(t){console.error("base64Decode failed: ",t)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fb(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hb=()=>fb().__FIREBASE_DEFAULTS__,db=()=>{if(typeof process>"u"||typeof E_>"u")return;const e=E_.__FIREBASE_DEFAULTS__;if(e)return JSON.parse(e)},mb=()=>{if(typeof document>"u")return;let e;try{e=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const t=e&&NT(e[1]);return t&&JSON.parse(t)},Nd=()=>{try{return hb()||db()||mb()}catch(e){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${e}`);return}},bT=e=>{var t,r;return(r=(t=Nd())===null||t===void 0?void 0:t.emulatorHosts)===null||r===void 0?void 0:r[e]},Wg=e=>{const t=bT(e);if(!t)return;const r=t.lastIndexOf(":");if(r<=0||r+1===t.length)throw new Error(`Invalid host ${t} with no separate hostname and port!`);const n=parseInt(t.substring(r+1),10);return t[0]==="["?[t.substring(1,r-1),n]:[t.substring(0,r),n]},PT=()=>{var e;return(e=Nd())===null||e===void 0?void 0:e.config},DT=e=>{var t;return(t=Nd())===null||t===void 0?void 0:t[`_${e}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pb{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((t,r)=>{this.resolve=t,this.reject=r})}wrapCallback(t){return(r,n)=>{r?this.reject(r):this.resolve(n),typeof t=="function"&&(this.promise.catch(()=>{}),t.length===1?t(r):t(r,n))}}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function FT(e,t){if(e.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const r={alg:"none",type:"JWT"},n=t||"demo-project",s=e.iat||0,a=e.sub||e.user_id;if(!a)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const i=Object.assign({iss:`https://securetoken.google.com/${n}`,aud:n,iat:s,exp:s+3600,auth_time:s,sub:a,user_id:a,firebase:{sign_in_provider:"custom",identities:{}}},e);return[Ph(JSON.stringify(r)),Ph(JSON.stringify(i)),""].join(".")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zr(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function gb(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(zr())}function vb(){var e;const t=(e=Nd())===null||e===void 0?void 0:e.forceEnvironment;if(t==="node")return!0;if(t==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function xb(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function _b(){const e=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof e=="object"&&e.id!==void 0}function yb(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function wb(){const e=zr();return e.indexOf("MSIE ")>=0||e.indexOf("Trident/")>=0}function Eb(){return!vb()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function Tb(){try{return typeof indexedDB=="object"}catch{return!1}}function kb(){return new Promise((e,t)=>{try{let r=!0;const n="validate-browser-context-for-indexeddb-analytics-module",s=self.indexedDB.open(n);s.onsuccess=()=>{s.result.close(),r||self.indexedDB.deleteDatabase(n),e(!0)},s.onupgradeneeded=()=>{r=!1},s.onerror=()=>{var a;t(((a=s.error)===null||a===void 0?void 0:a.message)||"")}}catch(r){t(r)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Sb="FirebaseError";class Ps extends Error{constructor(t,r,n){super(r),this.code=t,this.customData=n,this.name=Sb,Object.setPrototypeOf(this,Ps.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,wu.prototype.create)}}class wu{constructor(t,r,n){this.service=t,this.serviceName=r,this.errors=n}create(t,...r){const n=r[0]||{},s=`${this.service}/${t}`,a=this.errors[t],i=a?Ab(a,n):"Error",o=`${this.serviceName}: ${i} (${s}).`;return new Ps(s,o,n)}}function Ab(e,t){return e.replace(Ib,(r,n)=>{const s=t[n];return s!=null?String(s):`<${n}?>`})}const Ib=/\{\$([^}]+)}/g;function Cb(e){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}function Dh(e,t){if(e===t)return!0;const r=Object.keys(e),n=Object.keys(t);for(const s of r){if(!n.includes(s))return!1;const a=e[s],i=t[s];if(T_(a)&&T_(i)){if(!Dh(a,i))return!1}else if(a!==i)return!1}for(const s of n)if(!r.includes(s))return!1;return!0}function T_(e){return e!==null&&typeof e=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Eu(e){const t=[];for(const[r,n]of Object.entries(e))Array.isArray(n)?n.forEach(s=>{t.push(encodeURIComponent(r)+"="+encodeURIComponent(s))}):t.push(encodeURIComponent(r)+"="+encodeURIComponent(n));return t.length?"&"+t.join("&"):""}function Rb(e,t){const r=new Nb(e,t);return r.subscribe.bind(r)}class Nb{constructor(t,r){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=r,this.task.then(()=>{t(this)}).catch(n=>{this.error(n)})}next(t){this.forEachObserver(r=>{r.next(t)})}error(t){this.forEachObserver(r=>{r.error(t)}),this.close(t)}complete(){this.forEachObserver(t=>{t.complete()}),this.close()}subscribe(t,r,n){let s;if(t===void 0&&r===void 0&&n===void 0)throw new Error("Missing Observer.");bb(t,["next","error","complete"])?s=t:s={next:t,error:r,complete:n},s.next===void 0&&(s.next=V0),s.error===void 0&&(s.error=V0),s.complete===void 0&&(s.complete=V0);const a=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?s.error(this.finalError):s.complete()}catch{}}),this.observers.push(s),a}unsubscribeOne(t){this.observers===void 0||this.observers[t]===void 0||(delete this.observers[t],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(t){if(!this.finalized)for(let r=0;r<this.observers.length;r++)this.sendOne(r,t)}sendOne(t,r){this.task.then(()=>{if(this.observers!==void 0&&this.observers[t]!==void 0)try{r(this.observers[t])}catch(n){typeof console<"u"&&console.error&&console.error(n)}})}close(t){this.finalized||(this.finalized=!0,t!==void 0&&(this.finalError=t),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function bb(e,t){if(typeof e!="object"||e===null)return!1;for(const r of t)if(r in e&&typeof e[r]=="function")return!0;return!1}function V0(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ht(e){return e&&e._delegate?e._delegate:e}class ua{constructor(t,r,n){this.name=t,this.instanceFactory=r,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(t){return this.instantiationMode=t,this}setMultipleInstances(t){return this.multipleInstances=t,this}setServiceProps(t){return this.serviceProps=t,this}setInstanceCreatedCallback(t){return this.onInstanceCreated=t,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wi="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pb{constructor(t,r){this.name=t,this.container=r,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(t){const r=this.normalizeInstanceIdentifier(t);if(!this.instancesDeferred.has(r)){const n=new pb;if(this.instancesDeferred.set(r,n),this.isInitialized(r)||this.shouldAutoInitialize())try{const s=this.getOrInitializeService({instanceIdentifier:r});s&&n.resolve(s)}catch{}}return this.instancesDeferred.get(r).promise}getImmediate(t){var r;const n=this.normalizeInstanceIdentifier(t==null?void 0:t.identifier),s=(r=t==null?void 0:t.optional)!==null&&r!==void 0?r:!1;if(this.isInitialized(n)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:n})}catch(a){if(s)return null;throw a}else{if(s)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(t){if(t.name!==this.name)throw Error(`Mismatching Component ${t.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=t,!!this.shouldAutoInitialize()){if(Fb(t))try{this.getOrInitializeService({instanceIdentifier:wi})}catch{}for(const[r,n]of this.instancesDeferred.entries()){const s=this.normalizeInstanceIdentifier(r);try{const a=this.getOrInitializeService({instanceIdentifier:s});n.resolve(a)}catch{}}}}clearInstance(t=wi){this.instancesDeferred.delete(t),this.instancesOptions.delete(t),this.instances.delete(t)}async delete(){const t=Array.from(this.instances.values());await Promise.all([...t.filter(r=>"INTERNAL"in r).map(r=>r.INTERNAL.delete()),...t.filter(r=>"_delete"in r).map(r=>r._delete())])}isComponentSet(){return this.component!=null}isInitialized(t=wi){return this.instances.has(t)}getOptions(t=wi){return this.instancesOptions.get(t)||{}}initialize(t={}){const{options:r={}}=t,n=this.normalizeInstanceIdentifier(t.instanceIdentifier);if(this.isInitialized(n))throw Error(`${this.name}(${n}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const s=this.getOrInitializeService({instanceIdentifier:n,options:r});for(const[a,i]of this.instancesDeferred.entries()){const o=this.normalizeInstanceIdentifier(a);n===o&&i.resolve(s)}return s}onInit(t,r){var n;const s=this.normalizeInstanceIdentifier(r),a=(n=this.onInitCallbacks.get(s))!==null&&n!==void 0?n:new Set;a.add(t),this.onInitCallbacks.set(s,a);const i=this.instances.get(s);return i&&t(i,s),()=>{a.delete(t)}}invokeOnInitCallbacks(t,r){const n=this.onInitCallbacks.get(r);if(n)for(const s of n)try{s(t,r)}catch{}}getOrInitializeService({instanceIdentifier:t,options:r={}}){let n=this.instances.get(t);if(!n&&this.component&&(n=this.component.instanceFactory(this.container,{instanceIdentifier:Db(t),options:r}),this.instances.set(t,n),this.instancesOptions.set(t,r),this.invokeOnInitCallbacks(n,t),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,t,n)}catch{}return n||null}normalizeInstanceIdentifier(t=wi){return this.component?this.component.multipleInstances?t:wi:t}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function Db(e){return e===wi?void 0:e}function Fb(e){return e.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ob{constructor(t){this.name=t,this.providers=new Map}addComponent(t){const r=this.getProvider(t.name);if(r.isComponentSet())throw new Error(`Component ${t.name} has already been registered with ${this.name}`);r.setComponent(t)}addOrOverwriteComponent(t){this.getProvider(t.name).isComponentSet()&&this.providers.delete(t.name),this.addComponent(t)}getProvider(t){if(this.providers.has(t))return this.providers.get(t);const r=new Pb(t,this);return this.providers.set(t,r),r}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Ye;(function(e){e[e.DEBUG=0]="DEBUG",e[e.VERBOSE=1]="VERBOSE",e[e.INFO=2]="INFO",e[e.WARN=3]="WARN",e[e.ERROR=4]="ERROR",e[e.SILENT=5]="SILENT"})(Ye||(Ye={}));const Mb={debug:Ye.DEBUG,verbose:Ye.VERBOSE,info:Ye.INFO,warn:Ye.WARN,error:Ye.ERROR,silent:Ye.SILENT},Lb=Ye.INFO,jb={[Ye.DEBUG]:"log",[Ye.VERBOSE]:"log",[Ye.INFO]:"info",[Ye.WARN]:"warn",[Ye.ERROR]:"error"},Vb=(e,t,...r)=>{if(t<e.logLevel)return;const n=new Date().toISOString(),s=jb[t];if(s)console[s](`[${n}]  ${e.name}:`,...r);else throw new Error(`Attempted to log a message with an invalid logType (value: ${t})`)};class Hg{constructor(t){this.name=t,this._logLevel=Lb,this._logHandler=Vb,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(t){if(!(t in Ye))throw new TypeError(`Invalid value "${t}" assigned to \`logLevel\``);this._logLevel=t}setLogLevel(t){this._logLevel=typeof t=="string"?Mb[t]:t}get logHandler(){return this._logHandler}set logHandler(t){if(typeof t!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t}get userLogHandler(){return this._userLogHandler}set userLogHandler(t){this._userLogHandler=t}debug(...t){this._userLogHandler&&this._userLogHandler(this,Ye.DEBUG,...t),this._logHandler(this,Ye.DEBUG,...t)}log(...t){this._userLogHandler&&this._userLogHandler(this,Ye.VERBOSE,...t),this._logHandler(this,Ye.VERBOSE,...t)}info(...t){this._userLogHandler&&this._userLogHandler(this,Ye.INFO,...t),this._logHandler(this,Ye.INFO,...t)}warn(...t){this._userLogHandler&&this._userLogHandler(this,Ye.WARN,...t),this._logHandler(this,Ye.WARN,...t)}error(...t){this._userLogHandler&&this._userLogHandler(this,Ye.ERROR,...t),this._logHandler(this,Ye.ERROR,...t)}}const Ub=(e,t)=>t.some(r=>e instanceof r);let k_,S_;function Bb(){return k_||(k_=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function zb(){return S_||(S_=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const OT=new WeakMap,sp=new WeakMap,MT=new WeakMap,U0=new WeakMap,Gg=new WeakMap;function $b(e){const t=new Promise((r,n)=>{const s=()=>{e.removeEventListener("success",a),e.removeEventListener("error",i)},a=()=>{r(Qa(e.result)),s()},i=()=>{n(e.error),s()};e.addEventListener("success",a),e.addEventListener("error",i)});return t.then(r=>{r instanceof IDBCursor&&OT.set(r,e)}).catch(()=>{}),Gg.set(t,e),t}function Wb(e){if(sp.has(e))return;const t=new Promise((r,n)=>{const s=()=>{e.removeEventListener("complete",a),e.removeEventListener("error",i),e.removeEventListener("abort",i)},a=()=>{r(),s()},i=()=>{n(e.error||new DOMException("AbortError","AbortError")),s()};e.addEventListener("complete",a),e.addEventListener("error",i),e.addEventListener("abort",i)});sp.set(e,t)}let ap={get(e,t,r){if(e instanceof IDBTransaction){if(t==="done")return sp.get(e);if(t==="objectStoreNames")return e.objectStoreNames||MT.get(e);if(t==="store")return r.objectStoreNames[1]?void 0:r.objectStore(r.objectStoreNames[0])}return Qa(e[t])},set(e,t,r){return e[t]=r,!0},has(e,t){return e instanceof IDBTransaction&&(t==="done"||t==="store")?!0:t in e}};function Hb(e){ap=e(ap)}function Gb(e){return e===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(t,...r){const n=e.call(B0(this),t,...r);return MT.set(n,t.sort?t.sort():[t]),Qa(n)}:zb().includes(e)?function(...t){return e.apply(B0(this),t),Qa(OT.get(this))}:function(...t){return Qa(e.apply(B0(this),t))}}function Kb(e){return typeof e=="function"?Gb(e):(e instanceof IDBTransaction&&Wb(e),Ub(e,Bb())?new Proxy(e,ap):e)}function Qa(e){if(e instanceof IDBRequest)return $b(e);if(U0.has(e))return U0.get(e);const t=Kb(e);return t!==e&&(U0.set(e,t),Gg.set(t,e)),t}const B0=e=>Gg.get(e);function qb(e,t,{blocked:r,upgrade:n,blocking:s,terminated:a}={}){const i=indexedDB.open(e,t),o=Qa(i);return n&&i.addEventListener("upgradeneeded",l=>{n(Qa(i.result),l.oldVersion,l.newVersion,Qa(i.transaction),l)}),r&&i.addEventListener("blocked",l=>r(l.oldVersion,l.newVersion,l)),o.then(l=>{a&&l.addEventListener("close",()=>a()),s&&l.addEventListener("versionchange",c=>s(c.oldVersion,c.newVersion,c))}).catch(()=>{}),o}const Xb=["get","getKey","getAll","getAllKeys","count"],Yb=["put","add","delete","clear"],z0=new Map;function A_(e,t){if(!(e instanceof IDBDatabase&&!(t in e)&&typeof t=="string"))return;if(z0.get(t))return z0.get(t);const r=t.replace(/FromIndex$/,""),n=t!==r,s=Yb.includes(r);if(!(r in(n?IDBIndex:IDBObjectStore).prototype)||!(s||Xb.includes(r)))return;const a=async function(i,...o){const l=this.transaction(i,s?"readwrite":"readonly");let c=l.store;return n&&(c=c.index(o.shift())),(await Promise.all([c[r](...o),s&&l.done]))[0]};return z0.set(t,a),a}Hb(e=>({...e,get:(t,r,n)=>A_(t,r)||e.get(t,r,n),has:(t,r)=>!!A_(t,r)||e.has(t,r)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qb{constructor(t){this.container=t}getPlatformInfoString(){return this.container.getProviders().map(r=>{if(Jb(r)){const n=r.getImmediate();return`${n.library}/${n.version}`}else return null}).filter(r=>r).join(" ")}}function Jb(e){const t=e.getComponent();return(t==null?void 0:t.type)==="VERSION"}const ip="@firebase/app",I_="0.10.13";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fa=new Hg("@firebase/app"),Zb="@firebase/app-compat",eP="@firebase/analytics-compat",tP="@firebase/analytics",rP="@firebase/app-check-compat",nP="@firebase/app-check",sP="@firebase/auth",aP="@firebase/auth-compat",iP="@firebase/database",oP="@firebase/data-connect",lP="@firebase/database-compat",cP="@firebase/functions",uP="@firebase/functions-compat",fP="@firebase/installations",hP="@firebase/installations-compat",dP="@firebase/messaging",mP="@firebase/messaging-compat",pP="@firebase/performance",gP="@firebase/performance-compat",vP="@firebase/remote-config",xP="@firebase/remote-config-compat",_P="@firebase/storage",yP="@firebase/storage-compat",wP="@firebase/firestore",EP="@firebase/vertexai-preview",TP="@firebase/firestore-compat",kP="firebase",SP="10.14.1";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const op="[DEFAULT]",AP={[ip]:"fire-core",[Zb]:"fire-core-compat",[tP]:"fire-analytics",[eP]:"fire-analytics-compat",[nP]:"fire-app-check",[rP]:"fire-app-check-compat",[sP]:"fire-auth",[aP]:"fire-auth-compat",[iP]:"fire-rtdb",[oP]:"fire-data-connect",[lP]:"fire-rtdb-compat",[cP]:"fire-fn",[uP]:"fire-fn-compat",[fP]:"fire-iid",[hP]:"fire-iid-compat",[dP]:"fire-fcm",[mP]:"fire-fcm-compat",[pP]:"fire-perf",[gP]:"fire-perf-compat",[vP]:"fire-rc",[xP]:"fire-rc-compat",[_P]:"fire-gcs",[yP]:"fire-gcs-compat",[wP]:"fire-fst",[TP]:"fire-fst-compat",[EP]:"fire-vertex","fire-js":"fire-js",[kP]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Fh=new Map,IP=new Map,lp=new Map;function C_(e,t){try{e.container.addComponent(t)}catch(r){fa.debug(`Component ${t.name} failed to register with FirebaseApp ${e.name}`,r)}}function ni(e){const t=e.name;if(lp.has(t))return fa.debug(`There were multiple attempts to register component ${t}.`),!1;lp.set(t,e);for(const r of Fh.values())C_(r,e);for(const r of IP.values())C_(r,e);return!0}function Tu(e,t){const r=e.container.getProvider("heartbeat").getImmediate({optional:!0});return r&&r.triggerHeartbeat(),e.container.getProvider(t)}function qs(e){return e.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const CP={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Ja=new wu("app","Firebase",CP);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RP{constructor(t,r,n){this._isDeleted=!1,this._options=Object.assign({},t),this._config=Object.assign({},r),this._name=r.name,this._automaticDataCollectionEnabled=r.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new ua("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(t){this.checkDestroyed(),this._automaticDataCollectionEnabled=t}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(t){this._isDeleted=t}checkDestroyed(){if(this.isDeleted)throw Ja.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Zi=SP;function LT(e,t={}){let r=e;typeof t!="object"&&(t={name:t});const n=Object.assign({name:op,automaticDataCollectionEnabled:!1},t),s=n.name;if(typeof s!="string"||!s)throw Ja.create("bad-app-name",{appName:String(s)});if(r||(r=PT()),!r)throw Ja.create("no-options");const a=Fh.get(s);if(a){if(Dh(r,a.options)&&Dh(n,a.config))return a;throw Ja.create("duplicate-app",{appName:s})}const i=new Ob(s);for(const l of lp.values())i.addComponent(l);const o=new RP(r,n,i);return Fh.set(s,o),o}function bd(e=op){const t=Fh.get(e);if(!t&&e===op&&PT())return LT();if(!t)throw Ja.create("no-app",{appName:e});return t}function Vn(e,t,r){var n;let s=(n=AP[e])!==null&&n!==void 0?n:e;r&&(s+=`-${r}`);const a=s.match(/\s|\//),i=t.match(/\s|\//);if(a||i){const o=[`Unable to register library "${s}" with version "${t}":`];a&&o.push(`library name "${s}" contains illegal characters (whitespace or "/")`),a&&i&&o.push("and"),i&&o.push(`version name "${t}" contains illegal characters (whitespace or "/")`),fa.warn(o.join(" "));return}ni(new ua(`${s}-version`,()=>({library:s,version:t}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const NP="firebase-heartbeat-database",bP=1,Yc="firebase-heartbeat-store";let $0=null;function jT(){return $0||($0=qb(NP,bP,{upgrade:(e,t)=>{switch(t){case 0:try{e.createObjectStore(Yc)}catch(r){console.warn(r)}}}}).catch(e=>{throw Ja.create("idb-open",{originalErrorMessage:e.message})})),$0}async function PP(e){try{const r=(await jT()).transaction(Yc),n=await r.objectStore(Yc).get(VT(e));return await r.done,n}catch(t){if(t instanceof Ps)fa.warn(t.message);else{const r=Ja.create("idb-get",{originalErrorMessage:t==null?void 0:t.message});fa.warn(r.message)}}}async function R_(e,t){try{const n=(await jT()).transaction(Yc,"readwrite");await n.objectStore(Yc).put(t,VT(e)),await n.done}catch(r){if(r instanceof Ps)fa.warn(r.message);else{const n=Ja.create("idb-set",{originalErrorMessage:r==null?void 0:r.message});fa.warn(n.message)}}}function VT(e){return`${e.name}!${e.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const DP=1024,FP=30*24*60*60*1e3;class OP{constructor(t){this.container=t,this._heartbeatsCache=null;const r=this.container.getProvider("app").getImmediate();this._storage=new LP(r),this._heartbeatsCachePromise=this._storage.read().then(n=>(this._heartbeatsCache=n,n))}async triggerHeartbeat(){var t,r;try{const s=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),a=N_();return((t=this._heartbeatsCache)===null||t===void 0?void 0:t.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((r=this._heartbeatsCache)===null||r===void 0?void 0:r.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===a||this._heartbeatsCache.heartbeats.some(i=>i.date===a)?void 0:(this._heartbeatsCache.heartbeats.push({date:a,agent:s}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(i=>{const o=new Date(i.date).valueOf();return Date.now()-o<=FP}),this._storage.overwrite(this._heartbeatsCache))}catch(n){fa.warn(n)}}async getHeartbeatsHeader(){var t;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((t=this._heartbeatsCache)===null||t===void 0?void 0:t.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const r=N_(),{heartbeatsToSend:n,unsentEntries:s}=MP(this._heartbeatsCache.heartbeats),a=Ph(JSON.stringify({version:2,heartbeats:n}));return this._heartbeatsCache.lastSentHeartbeatDate=r,s.length>0?(this._heartbeatsCache.heartbeats=s,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),a}catch(r){return fa.warn(r),""}}}function N_(){return new Date().toISOString().substring(0,10)}function MP(e,t=DP){const r=[];let n=e.slice();for(const s of e){const a=r.find(i=>i.agent===s.agent);if(a){if(a.dates.push(s.date),b_(r)>t){a.dates.pop();break}}else if(r.push({agent:s.agent,dates:[s.date]}),b_(r)>t){r.pop();break}n=n.slice(1)}return{heartbeatsToSend:r,unsentEntries:n}}class LP{constructor(t){this.app=t,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return Tb()?kb().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const r=await PP(this.app);return r!=null&&r.heartbeats?r:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(t){var r;if(await this._canUseIndexedDBPromise){const s=await this.read();return R_(this.app,{lastSentHeartbeatDate:(r=t.lastSentHeartbeatDate)!==null&&r!==void 0?r:s.lastSentHeartbeatDate,heartbeats:t.heartbeats})}else return}async add(t){var r;if(await this._canUseIndexedDBPromise){const s=await this.read();return R_(this.app,{lastSentHeartbeatDate:(r=t.lastSentHeartbeatDate)!==null&&r!==void 0?r:s.lastSentHeartbeatDate,heartbeats:[...s.heartbeats,...t.heartbeats]})}else return}}function b_(e){return Ph(JSON.stringify({version:2,heartbeats:e})).length}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jP(e){ni(new ua("platform-logger",t=>new Qb(t),"PRIVATE")),ni(new ua("heartbeat",t=>new OP(t),"PRIVATE")),Vn(ip,I_,e),Vn(ip,I_,"esm2017"),Vn("fire-js","")}jP("");function Kg(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,n=Object.getOwnPropertySymbols(e);s<n.length;s++)t.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(e,n[s])&&(r[n[s]]=e[n[s]]);return r}function UT(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const VP=UT,BT=new wu("auth","Firebase",UT());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Oh=new Hg("@firebase/auth");function UP(e,...t){Oh.logLevel<=Ye.WARN&&Oh.warn(`Auth (${Zi}): ${e}`,...t)}function qf(e,...t){Oh.logLevel<=Ye.ERROR&&Oh.error(`Auth (${Zi}): ${e}`,...t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Is(e,...t){throw Xg(e,...t)}function os(e,...t){return Xg(e,...t)}function qg(e,t,r){const n=Object.assign(Object.assign({},VP()),{[t]:r});return new wu("auth","Firebase",n).create(t,{appName:e.name})}function Fi(e){return qg(e,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function BP(e,t,r){const n=r;if(!(t instanceof n))throw n.name!==t.constructor.name&&Is(e,"argument-error"),qg(e,"argument-error",`Type of ${t.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function Xg(e,...t){if(typeof e!="string"){const r=t[0],n=[...t.slice(1)];return n[0]&&(n[0].appName=e.name),e._errorFactory.create(r,...n)}return BT.create(e,...t)}function Me(e,t,...r){if(!e)throw Xg(t,...r)}function Xs(e){const t="INTERNAL ASSERTION FAILED: "+e;throw qf(t),new Error(t)}function ha(e,t){e||Xs(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cp(){var e;return typeof self<"u"&&((e=self.location)===null||e===void 0?void 0:e.href)||""}function zP(){return P_()==="http:"||P_()==="https:"}function P_(){var e;return typeof self<"u"&&((e=self.location)===null||e===void 0?void 0:e.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $P(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(zP()||_b()||"connection"in navigator)?navigator.onLine:!0}function WP(){if(typeof navigator>"u")return null;const e=navigator;return e.languages&&e.languages[0]||e.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ku{constructor(t,r){this.shortDelay=t,this.longDelay=r,ha(r>t,"Short delay should be less than long delay!"),this.isMobile=gb()||yb()}get(){return $P()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Yg(e,t){ha(e.emulator,"Emulator should always be set here");const{url:r}=e.emulator;return t?`${r}${t.startsWith("/")?t.slice(1):t}`:r}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zT{static initialize(t,r,n){this.fetchImpl=t,r&&(this.headersImpl=r),n&&(this.responseImpl=n)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Xs("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Xs("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Xs("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const HP={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const GP=new ku(3e4,6e4);function Qg(e,t){return e.tenantId&&!t.tenantId?Object.assign(Object.assign({},t),{tenantId:e.tenantId}):t}async function yl(e,t,r,n,s={}){return $T(e,s,async()=>{let a={},i={};n&&(t==="GET"?i=n:a={body:JSON.stringify(n)});const o=Eu(Object.assign({key:e.config.apiKey},i)).slice(1),l=await e._getAdditionalHeaders();l["Content-Type"]="application/json",e.languageCode&&(l["X-Firebase-Locale"]=e.languageCode);const c=Object.assign({method:t,headers:l},a);return xb()||(c.referrerPolicy="no-referrer"),zT.fetch()(WT(e,e.config.apiHost,r,o),c)})}async function $T(e,t,r){e._canInitEmulator=!1;const n=Object.assign(Object.assign({},HP),t);try{const s=new qP(e),a=await Promise.race([r(),s.promise]);s.clearNetworkTimeout();const i=await a.json();if("needConfirmation"in i)throw yf(e,"account-exists-with-different-credential",i);if(a.ok&&!("errorMessage"in i))return i;{const o=a.ok?i.errorMessage:i.error.message,[l,c]=o.split(" : ");if(l==="FEDERATED_USER_ID_ALREADY_LINKED")throw yf(e,"credential-already-in-use",i);if(l==="EMAIL_EXISTS")throw yf(e,"email-already-in-use",i);if(l==="USER_DISABLED")throw yf(e,"user-disabled",i);const u=n[l]||l.toLowerCase().replace(/[_\s]+/g,"-");if(c)throw qg(e,u,c);Is(e,u)}}catch(s){if(s instanceof Ps)throw s;Is(e,"network-request-failed",{message:String(s)})}}async function KP(e,t,r,n,s={}){const a=await yl(e,t,r,n,s);return"mfaPendingCredential"in a&&Is(e,"multi-factor-auth-required",{_serverResponse:a}),a}function WT(e,t,r,n){const s=`${t}${r}?${n}`;return e.config.emulator?Yg(e.config,s):`${e.config.apiScheme}://${s}`}class qP{constructor(t){this.auth=t,this.timer=null,this.promise=new Promise((r,n)=>{this.timer=setTimeout(()=>n(os(this.auth,"network-request-failed")),GP.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}}function yf(e,t,r){const n={appName:e.name};r.email&&(n.email=r.email),r.phoneNumber&&(n.phoneNumber=r.phoneNumber);const s=os(e,t,n);return s.customData._tokenResponse=r,s}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function XP(e,t){return yl(e,"POST","/v1/accounts:delete",t)}async function HT(e,t){return yl(e,"POST","/v1/accounts:lookup",t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gc(e){if(e)try{const t=new Date(Number(e));if(!isNaN(t.getTime()))return t.toUTCString()}catch{}}async function GT(e,t=!1){const r=Ht(e),n=await r.getIdToken(t),s=Jg(n);Me(s&&s.exp&&s.auth_time&&s.iat,r.auth,"internal-error");const a=typeof s.firebase=="object"?s.firebase:void 0,i=a==null?void 0:a.sign_in_provider;return{claims:s,token:n,authTime:gc(W0(s.auth_time)),issuedAtTime:gc(W0(s.iat)),expirationTime:gc(W0(s.exp)),signInProvider:i||null,signInSecondFactor:(a==null?void 0:a.sign_in_second_factor)||null}}function W0(e){return Number(e)*1e3}function Jg(e){const[t,r,n]=e.split(".");if(t===void 0||r===void 0||n===void 0)return qf("JWT malformed, contained fewer than 3 sections"),null;try{const s=NT(r);return s?JSON.parse(s):(qf("Failed to decode base64 JWT payload"),null)}catch(s){return qf("Caught error parsing JWT payload as JSON",s==null?void 0:s.toString()),null}}function D_(e){const t=Jg(e);return Me(t,"internal-error"),Me(typeof t.exp<"u","internal-error"),Me(typeof t.iat<"u","internal-error"),Number(t.exp)-Number(t.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Qc(e,t,r=!1){if(r)return t;try{return await t}catch(n){throw n instanceof Ps&&YP(n)&&e.auth.currentUser===e&&await e.auth.signOut(),n}}function YP({code:e}){return e==="auth/user-disabled"||e==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QP{constructor(t){this.user=t,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(t){var r;if(t){const n=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),n}else{this.errorBackoff=3e4;const s=((r=this.user.stsTokenManager.expirationTime)!==null&&r!==void 0?r:0)-Date.now()-3e5;return Math.max(0,s)}}schedule(t=!1){if(!this.isRunning)return;const r=this.getInterval(t);this.timerId=setTimeout(async()=>{await this.iteration()},r)}async iteration(){try{await this.user.getIdToken(!0)}catch(t){(t==null?void 0:t.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class up{constructor(t,r){this.createdAt=t,this.lastLoginAt=r,this._initializeTime()}_initializeTime(){this.lastSignInTime=gc(this.lastLoginAt),this.creationTime=gc(this.createdAt)}_copy(t){this.createdAt=t.createdAt,this.lastLoginAt=t.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Mh(e){var t;const r=e.auth,n=await e.getIdToken(),s=await Qc(e,HT(r,{idToken:n}));Me(s==null?void 0:s.users.length,r,"internal-error");const a=s.users[0];e._notifyReloadListener(a);const i=!((t=a.providerUserInfo)===null||t===void 0)&&t.length?KT(a.providerUserInfo):[],o=ZP(e.providerData,i),l=e.isAnonymous,c=!(e.email&&a.passwordHash)&&!(o!=null&&o.length),u=l?c:!1,h={uid:a.localId,displayName:a.displayName||null,photoURL:a.photoUrl||null,email:a.email||null,emailVerified:a.emailVerified||!1,phoneNumber:a.phoneNumber||null,tenantId:a.tenantId||null,providerData:o,metadata:new up(a.createdAt,a.lastLoginAt),isAnonymous:u};Object.assign(e,h)}async function JP(e){const t=Ht(e);await Mh(t),await t.auth._persistUserIfCurrent(t),t.auth._notifyListenersIfCurrent(t)}function ZP(e,t){return[...e.filter(n=>!t.some(s=>s.providerId===n.providerId)),...t]}function KT(e){return e.map(t=>{var{providerId:r}=t,n=Kg(t,["providerId"]);return{providerId:r,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function eD(e,t){const r=await $T(e,{},async()=>{const n=Eu({grant_type:"refresh_token",refresh_token:t}).slice(1),{tokenApiHost:s,apiKey:a}=e.config,i=WT(e,s,"/v1/token",`key=${a}`),o=await e._getAdditionalHeaders();return o["Content-Type"]="application/x-www-form-urlencoded",zT.fetch()(i,{method:"POST",headers:o,body:n})});return{accessToken:r.access_token,expiresIn:r.expires_in,refreshToken:r.refresh_token}}async function tD(e,t){return yl(e,"POST","/v2/accounts:revokeToken",Qg(e,t))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zo{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(t){Me(t.idToken,"internal-error"),Me(typeof t.idToken<"u","internal-error"),Me(typeof t.refreshToken<"u","internal-error");const r="expiresIn"in t&&typeof t.expiresIn<"u"?Number(t.expiresIn):D_(t.idToken);this.updateTokensAndExpiration(t.idToken,t.refreshToken,r)}updateFromIdToken(t){Me(t.length!==0,"internal-error");const r=D_(t);this.updateTokensAndExpiration(t,null,r)}async getToken(t,r=!1){return!r&&this.accessToken&&!this.isExpired?this.accessToken:(Me(this.refreshToken,t,"user-token-expired"),this.refreshToken?(await this.refresh(t,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(t,r){const{accessToken:n,refreshToken:s,expiresIn:a}=await eD(t,r);this.updateTokensAndExpiration(n,s,Number(a))}updateTokensAndExpiration(t,r,n){this.refreshToken=r||null,this.accessToken=t||null,this.expirationTime=Date.now()+n*1e3}static fromJSON(t,r){const{refreshToken:n,accessToken:s,expirationTime:a}=r,i=new zo;return n&&(Me(typeof n=="string","internal-error",{appName:t}),i.refreshToken=n),s&&(Me(typeof s=="string","internal-error",{appName:t}),i.accessToken=s),a&&(Me(typeof a=="number","internal-error",{appName:t}),i.expirationTime=a),i}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(t){this.accessToken=t.accessToken,this.refreshToken=t.refreshToken,this.expirationTime=t.expirationTime}_clone(){return Object.assign(new zo,this.toJSON())}_performRefresh(){return Xs("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Aa(e,t){Me(typeof e=="string"||typeof e>"u","internal-error",{appName:t})}class Ys{constructor(t){var{uid:r,auth:n,stsTokenManager:s}=t,a=Kg(t,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new QP(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=r,this.auth=n,this.stsTokenManager=s,this.accessToken=s.accessToken,this.displayName=a.displayName||null,this.email=a.email||null,this.emailVerified=a.emailVerified||!1,this.phoneNumber=a.phoneNumber||null,this.photoURL=a.photoURL||null,this.isAnonymous=a.isAnonymous||!1,this.tenantId=a.tenantId||null,this.providerData=a.providerData?[...a.providerData]:[],this.metadata=new up(a.createdAt||void 0,a.lastLoginAt||void 0)}async getIdToken(t){const r=await Qc(this,this.stsTokenManager.getToken(this.auth,t));return Me(r,this.auth,"internal-error"),this.accessToken!==r&&(this.accessToken=r,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),r}getIdTokenResult(t){return GT(this,t)}reload(){return JP(this)}_assign(t){this!==t&&(Me(this.uid===t.uid,this.auth,"internal-error"),this.displayName=t.displayName,this.photoURL=t.photoURL,this.email=t.email,this.emailVerified=t.emailVerified,this.phoneNumber=t.phoneNumber,this.isAnonymous=t.isAnonymous,this.tenantId=t.tenantId,this.providerData=t.providerData.map(r=>Object.assign({},r)),this.metadata._copy(t.metadata),this.stsTokenManager._assign(t.stsTokenManager))}_clone(t){const r=new Ys(Object.assign(Object.assign({},this),{auth:t,stsTokenManager:this.stsTokenManager._clone()}));return r.metadata._copy(this.metadata),r}_onReload(t){Me(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=t,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(t){this.reloadListener?this.reloadListener(t):this.reloadUserInfo=t}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(t,r=!1){let n=!1;t.idToken&&t.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(t),n=!0),r&&await Mh(this),await this.auth._persistUserIfCurrent(this),n&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(qs(this.auth.app))return Promise.reject(Fi(this.auth));const t=await this.getIdToken();return await Qc(this,XP(this.auth,{idToken:t})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(t=>Object.assign({},t)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(t,r){var n,s,a,i,o,l,c,u;const h=(n=r.displayName)!==null&&n!==void 0?n:void 0,m=(s=r.email)!==null&&s!==void 0?s:void 0,p=(a=r.phoneNumber)!==null&&a!==void 0?a:void 0,x=(i=r.photoURL)!==null&&i!==void 0?i:void 0,v=(o=r.tenantId)!==null&&o!==void 0?o:void 0,w=(l=r._redirectEventId)!==null&&l!==void 0?l:void 0,k=(c=r.createdAt)!==null&&c!==void 0?c:void 0,T=(u=r.lastLoginAt)!==null&&u!==void 0?u:void 0,{uid:E,emailVerified:N,isAnonymous:O,providerData:L,stsTokenManager:g}=r;Me(E&&g,t,"internal-error");const y=zo.fromJSON(this.name,g);Me(typeof E=="string",t,"internal-error"),Aa(h,t.name),Aa(m,t.name),Me(typeof N=="boolean",t,"internal-error"),Me(typeof O=="boolean",t,"internal-error"),Aa(p,t.name),Aa(x,t.name),Aa(v,t.name),Aa(w,t.name),Aa(k,t.name),Aa(T,t.name);const S=new Ys({uid:E,auth:t,email:m,emailVerified:N,displayName:h,isAnonymous:O,photoURL:x,phoneNumber:p,tenantId:v,stsTokenManager:y,createdAt:k,lastLoginAt:T});return L&&Array.isArray(L)&&(S.providerData=L.map(R=>Object.assign({},R))),w&&(S._redirectEventId=w),S}static async _fromIdTokenResponse(t,r,n=!1){const s=new zo;s.updateFromServerResponse(r);const a=new Ys({uid:r.localId,auth:t,stsTokenManager:s,isAnonymous:n});return await Mh(a),a}static async _fromGetAccountInfoResponse(t,r,n){const s=r.users[0];Me(s.localId!==void 0,"internal-error");const a=s.providerUserInfo!==void 0?KT(s.providerUserInfo):[],i=!(s.email&&s.passwordHash)&&!(a!=null&&a.length),o=new zo;o.updateFromIdToken(n);const l=new Ys({uid:s.localId,auth:t,stsTokenManager:o,isAnonymous:i}),c={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:a,metadata:new up(s.createdAt,s.lastLoginAt),isAnonymous:!(s.email&&s.passwordHash)&&!(a!=null&&a.length)};return Object.assign(l,c),l}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const F_=new Map;function Qs(e){ha(e instanceof Function,"Expected a class definition");let t=F_.get(e);return t?(ha(t instanceof e,"Instance stored in cache mismatched with class"),t):(t=new e,F_.set(e,t),t)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qT{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(t,r){this.storage[t]=r}async _get(t){const r=this.storage[t];return r===void 0?null:r}async _remove(t){delete this.storage[t]}_addListener(t,r){}_removeListener(t,r){}}qT.type="NONE";const O_=qT;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Xf(e,t,r){return`firebase:${e}:${t}:${r}`}class $o{constructor(t,r,n){this.persistence=t,this.auth=r,this.userKey=n;const{config:s,name:a}=this.auth;this.fullUserKey=Xf(this.userKey,s.apiKey,a),this.fullPersistenceKey=Xf("persistence",s.apiKey,a),this.boundEventHandler=r._onStorageEvent.bind(r),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(t){return this.persistence._set(this.fullUserKey,t.toJSON())}async getCurrentUser(){const t=await this.persistence._get(this.fullUserKey);return t?Ys._fromJSON(this.auth,t):null}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(t){if(this.persistence===t)return;const r=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=t,r)return this.setCurrentUser(r)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(t,r,n="authUser"){if(!r.length)return new $o(Qs(O_),t,n);const s=(await Promise.all(r.map(async c=>{if(await c._isAvailable())return c}))).filter(c=>c);let a=s[0]||Qs(O_);const i=Xf(n,t.config.apiKey,t.name);let o=null;for(const c of r)try{const u=await c._get(i);if(u){const h=Ys._fromJSON(t,u);c!==a&&(o=h),a=c;break}}catch{}const l=s.filter(c=>c._shouldAllowMigration);return!a._shouldAllowMigration||!l.length?new $o(a,t,n):(a=l[0],o&&await a._set(i,o.toJSON()),await Promise.all(r.map(async c=>{if(c!==a)try{await c._remove(i)}catch{}})),new $o(a,t,n))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function M_(e){const t=e.toLowerCase();if(t.includes("opera/")||t.includes("opr/")||t.includes("opios/"))return"Opera";if(JT(t))return"IEMobile";if(t.includes("msie")||t.includes("trident/"))return"IE";if(t.includes("edge/"))return"Edge";if(XT(t))return"Firefox";if(t.includes("silk/"))return"Silk";if(ek(t))return"Blackberry";if(tk(t))return"Webos";if(YT(t))return"Safari";if((t.includes("chrome/")||QT(t))&&!t.includes("edge/"))return"Chrome";if(ZT(t))return"Android";{const r=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,n=e.match(r);if((n==null?void 0:n.length)===2)return n[1]}return"Other"}function XT(e=zr()){return/firefox\//i.test(e)}function YT(e=zr()){const t=e.toLowerCase();return t.includes("safari/")&&!t.includes("chrome/")&&!t.includes("crios/")&&!t.includes("android")}function QT(e=zr()){return/crios\//i.test(e)}function JT(e=zr()){return/iemobile/i.test(e)}function ZT(e=zr()){return/android/i.test(e)}function ek(e=zr()){return/blackberry/i.test(e)}function tk(e=zr()){return/webos/i.test(e)}function Zg(e=zr()){return/iphone|ipad|ipod/i.test(e)||/macintosh/i.test(e)&&/mobile/i.test(e)}function rD(e=zr()){var t;return Zg(e)&&!!(!((t=window.navigator)===null||t===void 0)&&t.standalone)}function nD(){return wb()&&document.documentMode===10}function rk(e=zr()){return Zg(e)||ZT(e)||tk(e)||ek(e)||/windows phone/i.test(e)||JT(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nk(e,t=[]){let r;switch(e){case"Browser":r=M_(zr());break;case"Worker":r=`${M_(zr())}-${e}`;break;default:r=e}const n=t.length?t.join(","):"FirebaseCore-web";return`${r}/JsCore/${Zi}/${n}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sD{constructor(t){this.auth=t,this.queue=[]}pushCallback(t,r){const n=a=>new Promise((i,o)=>{try{const l=t(a);i(l)}catch(l){o(l)}});n.onAbort=r,this.queue.push(n);const s=this.queue.length-1;return()=>{this.queue[s]=()=>Promise.resolve()}}async runMiddleware(t){if(this.auth.currentUser===t)return;const r=[];try{for(const n of this.queue)await n(t),n.onAbort&&r.push(n.onAbort)}catch(n){r.reverse();for(const s of r)try{s()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:n==null?void 0:n.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function aD(e,t={}){return yl(e,"GET","/v2/passwordPolicy",Qg(e,t))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const iD=6;class oD{constructor(t){var r,n,s,a;const i=t.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(r=i.minPasswordLength)!==null&&r!==void 0?r:iD,i.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=i.maxPasswordLength),i.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=i.containsLowercaseCharacter),i.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=i.containsUppercaseCharacter),i.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=i.containsNumericCharacter),i.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=i.containsNonAlphanumericCharacter),this.enforcementState=t.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(s=(n=t.allowedNonAlphanumericCharacters)===null||n===void 0?void 0:n.join(""))!==null&&s!==void 0?s:"",this.forceUpgradeOnSignin=(a=t.forceUpgradeOnSignin)!==null&&a!==void 0?a:!1,this.schemaVersion=t.schemaVersion}validatePassword(t){var r,n,s,a,i,o;const l={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(t,l),this.validatePasswordCharacterOptions(t,l),l.isValid&&(l.isValid=(r=l.meetsMinPasswordLength)!==null&&r!==void 0?r:!0),l.isValid&&(l.isValid=(n=l.meetsMaxPasswordLength)!==null&&n!==void 0?n:!0),l.isValid&&(l.isValid=(s=l.containsLowercaseLetter)!==null&&s!==void 0?s:!0),l.isValid&&(l.isValid=(a=l.containsUppercaseLetter)!==null&&a!==void 0?a:!0),l.isValid&&(l.isValid=(i=l.containsNumericCharacter)!==null&&i!==void 0?i:!0),l.isValid&&(l.isValid=(o=l.containsNonAlphanumericCharacter)!==null&&o!==void 0?o:!0),l}validatePasswordLengthOptions(t,r){const n=this.customStrengthOptions.minPasswordLength,s=this.customStrengthOptions.maxPasswordLength;n&&(r.meetsMinPasswordLength=t.length>=n),s&&(r.meetsMaxPasswordLength=t.length<=s)}validatePasswordCharacterOptions(t,r){this.updatePasswordCharacterOptionsStatuses(r,!1,!1,!1,!1);let n;for(let s=0;s<t.length;s++)n=t.charAt(s),this.updatePasswordCharacterOptionsStatuses(r,n>="a"&&n<="z",n>="A"&&n<="Z",n>="0"&&n<="9",this.allowedNonAlphanumericCharacters.includes(n))}updatePasswordCharacterOptionsStatuses(t,r,n,s,a){this.customStrengthOptions.containsLowercaseLetter&&(t.containsLowercaseLetter||(t.containsLowercaseLetter=r)),this.customStrengthOptions.containsUppercaseLetter&&(t.containsUppercaseLetter||(t.containsUppercaseLetter=n)),this.customStrengthOptions.containsNumericCharacter&&(t.containsNumericCharacter||(t.containsNumericCharacter=s)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(t.containsNonAlphanumericCharacter||(t.containsNonAlphanumericCharacter=a))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lD{constructor(t,r,n,s){this.app=t,this.heartbeatServiceProvider=r,this.appCheckServiceProvider=n,this.config=s,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new L_(this),this.idTokenSubscription=new L_(this),this.beforeStateQueue=new sD(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=BT,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=t.name,this.clientVersion=s.sdkClientVersion}_initializeWithPersistence(t,r){return r&&(this._popupRedirectResolver=Qs(r)),this._initializationPromise=this.queue(async()=>{var n,s;if(!this._deleted&&(this.persistenceManager=await $o.create(this,t),!this._deleted)){if(!((n=this._popupRedirectResolver)===null||n===void 0)&&n._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(r),this.lastNotifiedUid=((s=this.currentUser)===null||s===void 0?void 0:s.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const t=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!t)){if(this.currentUser&&t&&this.currentUser.uid===t.uid){this._currentUser._assign(t),await this.currentUser.getIdToken();return}await this._updateCurrentUser(t,!0)}}async initializeCurrentUserFromIdToken(t){try{const r=await HT(this,{idToken:t}),n=await Ys._fromGetAccountInfoResponse(this,r,t);await this.directlySetCurrentUser(n)}catch(r){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",r),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(t){var r;if(qs(this.app)){const i=this.app.settings.authIdToken;return i?new Promise(o=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(i).then(o,o))}):this.directlySetCurrentUser(null)}const n=await this.assertedPersistence.getCurrentUser();let s=n,a=!1;if(t&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const i=(r=this.redirectUser)===null||r===void 0?void 0:r._redirectEventId,o=s==null?void 0:s._redirectEventId,l=await this.tryRedirectSignIn(t);(!i||i===o)&&(l!=null&&l.user)&&(s=l.user,a=!0)}if(!s)return this.directlySetCurrentUser(null);if(!s._redirectEventId){if(a)try{await this.beforeStateQueue.runMiddleware(s)}catch(i){s=n,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(i))}return s?this.reloadAndSetCurrentUserOrClear(s):this.directlySetCurrentUser(null)}return Me(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===s._redirectEventId?this.directlySetCurrentUser(s):this.reloadAndSetCurrentUserOrClear(s)}async tryRedirectSignIn(t){let r=null;try{r=await this._popupRedirectResolver._completeRedirectFn(this,t,!0)}catch{await this._setRedirectUser(null)}return r}async reloadAndSetCurrentUserOrClear(t){try{await Mh(t)}catch(r){if((r==null?void 0:r.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(t)}useDeviceLanguage(){this.languageCode=WP()}async _delete(){this._deleted=!0}async updateCurrentUser(t){if(qs(this.app))return Promise.reject(Fi(this));const r=t?Ht(t):null;return r&&Me(r.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(r&&r._clone(this))}async _updateCurrentUser(t,r=!1){if(!this._deleted)return t&&Me(this.tenantId===t.tenantId,this,"tenant-id-mismatch"),r||await this.beforeStateQueue.runMiddleware(t),this.queue(async()=>{await this.directlySetCurrentUser(t),this.notifyAuthListeners()})}async signOut(){return qs(this.app)?Promise.reject(Fi(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(t){return qs(this.app)?Promise.reject(Fi(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(Qs(t))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(t){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const r=this._getPasswordPolicyInternal();return r.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):r.validatePassword(t)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const t=await aD(this),r=new oD(t);this.tenantId===null?this._projectPasswordPolicy=r:this._tenantPasswordPolicies[this.tenantId]=r}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(t){this._errorFactory=new wu("auth","Firebase",t())}onAuthStateChanged(t,r,n){return this.registerStateListener(this.authStateSubscription,t,r,n)}beforeAuthStateChanged(t,r){return this.beforeStateQueue.pushCallback(t,r)}onIdTokenChanged(t,r,n){return this.registerStateListener(this.idTokenSubscription,t,r,n)}authStateReady(){return new Promise((t,r)=>{if(this.currentUser)t();else{const n=this.onAuthStateChanged(()=>{n(),t()},r)}})}async revokeAccessToken(t){if(this.currentUser){const r=await this.currentUser.getIdToken(),n={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:t,idToken:r};this.tenantId!=null&&(n.tenantId=this.tenantId),await tD(this,n)}}toJSON(){var t;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(t=this._currentUser)===null||t===void 0?void 0:t.toJSON()}}async _setRedirectUser(t,r){const n=await this.getOrInitRedirectPersistenceManager(r);return t===null?n.removeCurrentUser():n.setCurrentUser(t)}async getOrInitRedirectPersistenceManager(t){if(!this.redirectPersistenceManager){const r=t&&Qs(t)||this._popupRedirectResolver;Me(r,this,"argument-error"),this.redirectPersistenceManager=await $o.create(this,[Qs(r._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(t){var r,n;return this._isInitialized&&await this.queue(async()=>{}),((r=this._currentUser)===null||r===void 0?void 0:r._redirectEventId)===t?this._currentUser:((n=this.redirectUser)===null||n===void 0?void 0:n._redirectEventId)===t?this.redirectUser:null}async _persistUserIfCurrent(t){if(t===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(t))}_notifyListenersIfCurrent(t){t===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var t,r;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const n=(r=(t=this.currentUser)===null||t===void 0?void 0:t.uid)!==null&&r!==void 0?r:null;this.lastNotifiedUid!==n&&(this.lastNotifiedUid=n,this.authStateSubscription.next(this.currentUser))}registerStateListener(t,r,n,s){if(this._deleted)return()=>{};const a=typeof r=="function"?r:r.next.bind(r);let i=!1;const o=this._isInitialized?Promise.resolve():this._initializationPromise;if(Me(o,this,"internal-error"),o.then(()=>{i||a(this.currentUser)}),typeof r=="function"){const l=t.addObserver(r,n,s);return()=>{i=!0,l()}}else{const l=t.addObserver(r);return()=>{i=!0,l()}}}async directlySetCurrentUser(t){this.currentUser&&this.currentUser!==t&&this._currentUser._stopProactiveRefresh(),t&&this.isProactiveRefreshEnabled&&t._startProactiveRefresh(),this.currentUser=t,t?await this.assertedPersistence.setCurrentUser(t):await this.assertedPersistence.removeCurrentUser()}queue(t){return this.operations=this.operations.then(t,t),this.operations}get assertedPersistence(){return Me(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(t){!t||this.frameworks.includes(t)||(this.frameworks.push(t),this.frameworks.sort(),this.clientVersion=nk(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var t;const r={"X-Client-Version":this.clientVersion};this.app.options.appId&&(r["X-Firebase-gmpid"]=this.app.options.appId);const n=await((t=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||t===void 0?void 0:t.getHeartbeatsHeader());n&&(r["X-Firebase-Client"]=n);const s=await this._getAppCheckToken();return s&&(r["X-Firebase-AppCheck"]=s),r}async _getAppCheckToken(){var t;const r=await((t=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||t===void 0?void 0:t.getToken());return r!=null&&r.error&&UP(`Error while retrieving App Check token: ${r.error}`),r==null?void 0:r.token}}function Pd(e){return Ht(e)}class L_{constructor(t){this.auth=t,this.observer=null,this.addObserver=Rb(r=>this.observer=r)}get next(){return Me(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let ev={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function cD(e){ev=e}function uD(e){return ev.loadJS(e)}function fD(){return ev.gapiScript}function hD(e){return`__${e}${Math.floor(Math.random()*1e6)}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function dD(e,t){const r=Tu(e,"auth");if(r.isInitialized()){const s=r.getImmediate(),a=r.getOptions();if(Dh(a,t??{}))return s;Is(s,"already-initialized")}return r.initialize({options:t})}function mD(e,t){const r=(t==null?void 0:t.persistence)||[],n=(Array.isArray(r)?r:[r]).map(Qs);t!=null&&t.errorMap&&e._updateErrorMap(t.errorMap),e._initializeWithPersistence(n,t==null?void 0:t.popupRedirectResolver)}function pD(e,t,r){const n=Pd(e);Me(n._canInitEmulator,n,"emulator-config-failed"),Me(/^https?:\/\//.test(t),n,"invalid-emulator-scheme");const s=!1,a=sk(t),{host:i,port:o}=gD(t),l=o===null?"":`:${o}`;n.config.emulator={url:`${a}//${i}${l}/`},n.settings.appVerificationDisabledForTesting=!0,n.emulatorConfig=Object.freeze({host:i,port:o,protocol:a.replace(":",""),options:Object.freeze({disableWarnings:s})}),vD()}function sk(e){const t=e.indexOf(":");return t<0?"":e.substr(0,t+1)}function gD(e){const t=sk(e),r=/(\/\/)?([^?#/]+)/.exec(e.substr(t.length));if(!r)return{host:"",port:null};const n=r[2].split("@").pop()||"",s=/^(\[[^\]]+\])(:|$)/.exec(n);if(s){const a=s[1];return{host:a,port:j_(n.substr(a.length+1))}}else{const[a,i]=n.split(":");return{host:a,port:j_(i)}}}function j_(e){if(!e)return null;const t=Number(e);return isNaN(t)?null:t}function vD(){function e(){const t=document.createElement("p"),r=t.style;t.innerText="Running in emulator mode. Do not use with production credentials.",r.position="fixed",r.width="100%",r.backgroundColor="#ffffff",r.border=".1em solid #000000",r.color="#b50000",r.bottom="0px",r.left="0px",r.margin="0px",r.zIndex="10000",r.textAlign="center",t.classList.add("firebase-emulator-warning"),document.body.appendChild(t)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",e):e())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ak{constructor(t,r){this.providerId=t,this.signInMethod=r}toJSON(){return Xs("not implemented")}_getIdTokenResponse(t){return Xs("not implemented")}_linkToIdToken(t,r){return Xs("not implemented")}_getReauthenticationResolver(t){return Xs("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Wo(e,t){return KP(e,"POST","/v1/accounts:signInWithIdp",Qg(e,t))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xD="http://localhost";class Wi extends ak{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(t){const r=new Wi(t.providerId,t.signInMethod);return t.idToken||t.accessToken?(t.idToken&&(r.idToken=t.idToken),t.accessToken&&(r.accessToken=t.accessToken),t.nonce&&!t.pendingToken&&(r.nonce=t.nonce),t.pendingToken&&(r.pendingToken=t.pendingToken)):t.oauthToken&&t.oauthTokenSecret?(r.accessToken=t.oauthToken,r.secret=t.oauthTokenSecret):Is("argument-error"),r}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(t){const r=typeof t=="string"?JSON.parse(t):t,{providerId:n,signInMethod:s}=r,a=Kg(r,["providerId","signInMethod"]);if(!n||!s)return null;const i=new Wi(n,s);return i.idToken=a.idToken||void 0,i.accessToken=a.accessToken||void 0,i.secret=a.secret,i.nonce=a.nonce,i.pendingToken=a.pendingToken||null,i}_getIdTokenResponse(t){const r=this.buildRequest();return Wo(t,r)}_linkToIdToken(t,r){const n=this.buildRequest();return n.idToken=r,Wo(t,n)}_getReauthenticationResolver(t){const r=this.buildRequest();return r.autoCreate=!1,Wo(t,r)}buildRequest(){const t={requestUri:xD,returnSecureToken:!0};if(this.pendingToken)t.pendingToken=this.pendingToken;else{const r={};this.idToken&&(r.id_token=this.idToken),this.accessToken&&(r.access_token=this.accessToken),this.secret&&(r.oauth_token_secret=this.secret),r.providerId=this.providerId,this.nonce&&!this.pendingToken&&(r.nonce=this.nonce),t.postBody=Eu(r)}return t}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tv{constructor(t){this.providerId=t,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(t){this.defaultLanguageCode=t}setCustomParameters(t){return this.customParameters=t,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Su extends tv{constructor(){super(...arguments),this.scopes=[]}addScope(t){return this.scopes.includes(t)||this.scopes.push(t),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Da extends Su{constructor(){super("facebook.com")}static credential(t){return Wi._fromParams({providerId:Da.PROVIDER_ID,signInMethod:Da.FACEBOOK_SIGN_IN_METHOD,accessToken:t})}static credentialFromResult(t){return Da.credentialFromTaggedObject(t)}static credentialFromError(t){return Da.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t||!("oauthAccessToken"in t)||!t.oauthAccessToken)return null;try{return Da.credential(t.oauthAccessToken)}catch{return null}}}Da.FACEBOOK_SIGN_IN_METHOD="facebook.com";Da.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ys extends Su{constructor(){super("google.com"),this.addScope("profile")}static credential(t,r){return Wi._fromParams({providerId:ys.PROVIDER_ID,signInMethod:ys.GOOGLE_SIGN_IN_METHOD,idToken:t,accessToken:r})}static credentialFromResult(t){return ys.credentialFromTaggedObject(t)}static credentialFromError(t){return ys.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t)return null;const{oauthIdToken:r,oauthAccessToken:n}=t;if(!r&&!n)return null;try{return ys.credential(r,n)}catch{return null}}}ys.GOOGLE_SIGN_IN_METHOD="google.com";ys.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fa extends Su{constructor(){super("github.com")}static credential(t){return Wi._fromParams({providerId:Fa.PROVIDER_ID,signInMethod:Fa.GITHUB_SIGN_IN_METHOD,accessToken:t})}static credentialFromResult(t){return Fa.credentialFromTaggedObject(t)}static credentialFromError(t){return Fa.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t||!("oauthAccessToken"in t)||!t.oauthAccessToken)return null;try{return Fa.credential(t.oauthAccessToken)}catch{return null}}}Fa.GITHUB_SIGN_IN_METHOD="github.com";Fa.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Oa extends Su{constructor(){super("twitter.com")}static credential(t,r){return Wi._fromParams({providerId:Oa.PROVIDER_ID,signInMethod:Oa.TWITTER_SIGN_IN_METHOD,oauthToken:t,oauthTokenSecret:r})}static credentialFromResult(t){return Oa.credentialFromTaggedObject(t)}static credentialFromError(t){return Oa.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t)return null;const{oauthAccessToken:r,oauthTokenSecret:n}=t;if(!r||!n)return null;try{return Oa.credential(r,n)}catch{return null}}}Oa.TWITTER_SIGN_IN_METHOD="twitter.com";Oa.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class al{constructor(t){this.user=t.user,this.providerId=t.providerId,this._tokenResponse=t._tokenResponse,this.operationType=t.operationType}static async _fromIdTokenResponse(t,r,n,s=!1){const a=await Ys._fromIdTokenResponse(t,n,s),i=V_(n);return new al({user:a,providerId:i,_tokenResponse:n,operationType:r})}static async _forOperation(t,r,n){await t._updateTokensIfNecessary(n,!0);const s=V_(n);return new al({user:t,providerId:s,_tokenResponse:n,operationType:r})}}function V_(e){return e.providerId?e.providerId:"phoneNumber"in e?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lh extends Ps{constructor(t,r,n,s){var a;super(r.code,r.message),this.operationType=n,this.user=s,Object.setPrototypeOf(this,Lh.prototype),this.customData={appName:t.name,tenantId:(a=t.tenantId)!==null&&a!==void 0?a:void 0,_serverResponse:r.customData._serverResponse,operationType:n}}static _fromErrorAndOperation(t,r,n,s){return new Lh(t,r,n,s)}}function ik(e,t,r,n){return(t==="reauthenticate"?r._getReauthenticationResolver(e):r._getIdTokenResponse(e)).catch(a=>{throw a.code==="auth/multi-factor-auth-required"?Lh._fromErrorAndOperation(e,a,t,n):a})}async function _D(e,t,r=!1){const n=await Qc(e,t._linkToIdToken(e.auth,await e.getIdToken()),r);return al._forOperation(e,"link",n)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function yD(e,t,r=!1){const{auth:n}=e;if(qs(n.app))return Promise.reject(Fi(n));const s="reauthenticate";try{const a=await Qc(e,ik(n,s,t,e),r);Me(a.idToken,n,"internal-error");const i=Jg(a.idToken);Me(i,n,"internal-error");const{sub:o}=i;return Me(e.uid===o,n,"user-mismatch"),al._forOperation(e,s,a)}catch(a){throw(a==null?void 0:a.code)==="auth/user-not-found"&&Is(n,"user-mismatch"),a}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function wD(e,t,r=!1){if(qs(e.app))return Promise.reject(Fi(e));const n="signIn",s=await ik(e,n,t),a=await al._fromIdTokenResponse(e,n,s);return r||await e._updateCurrentUser(a.user),a}function ED(e,t,r,n){return Ht(e).onIdTokenChanged(t,r,n)}function TD(e,t,r){return Ht(e).beforeAuthStateChanged(t,r)}function ok(e,t,r,n){return Ht(e).onAuthStateChanged(t,r,n)}function kD(e){return Ht(e).signOut()}const jh="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lk{constructor(t,r){this.storageRetriever=t,this.type=r}_isAvailable(){try{return this.storage?(this.storage.setItem(jh,"1"),this.storage.removeItem(jh),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(t,r){return this.storage.setItem(t,JSON.stringify(r)),Promise.resolve()}_get(t){const r=this.storage.getItem(t);return Promise.resolve(r?JSON.parse(r):null)}_remove(t){return this.storage.removeItem(t),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const SD=1e3,AD=10;class ck extends lk{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(t,r)=>this.onStorageEvent(t,r),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=rk(),this._shouldAllowMigration=!0}forAllChangedKeys(t){for(const r of Object.keys(this.listeners)){const n=this.storage.getItem(r),s=this.localCache[r];n!==s&&t(r,s,n)}}onStorageEvent(t,r=!1){if(!t.key){this.forAllChangedKeys((i,o,l)=>{this.notifyListeners(i,l)});return}const n=t.key;r?this.detachListener():this.stopPolling();const s=()=>{const i=this.storage.getItem(n);!r&&this.localCache[n]===i||this.notifyListeners(n,i)},a=this.storage.getItem(n);nD()&&a!==t.newValue&&t.newValue!==t.oldValue?setTimeout(s,AD):s()}notifyListeners(t,r){this.localCache[t]=r;const n=this.listeners[t];if(n)for(const s of Array.from(n))s(r&&JSON.parse(r))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((t,r,n)=>{this.onStorageEvent(new StorageEvent("storage",{key:t,oldValue:r,newValue:n}),!0)})},SD)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(t,r){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[t]||(this.listeners[t]=new Set,this.localCache[t]=this.storage.getItem(t)),this.listeners[t].add(r)}_removeListener(t,r){this.listeners[t]&&(this.listeners[t].delete(r),this.listeners[t].size===0&&delete this.listeners[t]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(t,r){await super._set(t,r),this.localCache[t]=JSON.stringify(r)}async _get(t){const r=await super._get(t);return this.localCache[t]=JSON.stringify(r),r}async _remove(t){await super._remove(t),delete this.localCache[t]}}ck.type="LOCAL";const ID=ck;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uk extends lk{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(t,r){}_removeListener(t,r){}}uk.type="SESSION";const fk=uk;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function CD(e){return Promise.all(e.map(async t=>{try{return{fulfilled:!0,value:await t}}catch(r){return{fulfilled:!1,reason:r}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dd{constructor(t){this.eventTarget=t,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(t){const r=this.receivers.find(s=>s.isListeningto(t));if(r)return r;const n=new Dd(t);return this.receivers.push(n),n}isListeningto(t){return this.eventTarget===t}async handleEvent(t){const r=t,{eventId:n,eventType:s,data:a}=r.data,i=this.handlersMap[s];if(!(i!=null&&i.size))return;r.ports[0].postMessage({status:"ack",eventId:n,eventType:s});const o=Array.from(i).map(async c=>c(r.origin,a)),l=await CD(o);r.ports[0].postMessage({status:"done",eventId:n,eventType:s,response:l})}_subscribe(t,r){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[t]||(this.handlersMap[t]=new Set),this.handlersMap[t].add(r)}_unsubscribe(t,r){this.handlersMap[t]&&r&&this.handlersMap[t].delete(r),(!r||this.handlersMap[t].size===0)&&delete this.handlersMap[t],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}Dd.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rv(e="",t=10){let r="";for(let n=0;n<t;n++)r+=Math.floor(Math.random()*10);return e+r}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RD{constructor(t){this.target=t,this.handlers=new Set}removeMessageHandler(t){t.messageChannel&&(t.messageChannel.port1.removeEventListener("message",t.onMessage),t.messageChannel.port1.close()),this.handlers.delete(t)}async _send(t,r,n=50){const s=typeof MessageChannel<"u"?new MessageChannel:null;if(!s)throw new Error("connection_unavailable");let a,i;return new Promise((o,l)=>{const c=rv("",20);s.port1.start();const u=setTimeout(()=>{l(new Error("unsupported_event"))},n);i={messageChannel:s,onMessage(h){const m=h;if(m.data.eventId===c)switch(m.data.status){case"ack":clearTimeout(u),a=setTimeout(()=>{l(new Error("timeout"))},3e3);break;case"done":clearTimeout(a),o(m.data.response);break;default:clearTimeout(u),clearTimeout(a),l(new Error("invalid_response"));break}}},this.handlers.add(i),s.port1.addEventListener("message",i.onMessage),this.target.postMessage({eventType:t,eventId:c,data:r},[s.port2])}).finally(()=>{i&&this.removeMessageHandler(i)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ks(){return window}function ND(e){ks().location.href=e}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hk(){return typeof ks().WorkerGlobalScope<"u"&&typeof ks().importScripts=="function"}async function bD(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function PD(){var e;return((e=navigator==null?void 0:navigator.serviceWorker)===null||e===void 0?void 0:e.controller)||null}function DD(){return hk()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dk="firebaseLocalStorageDb",FD=1,Vh="firebaseLocalStorage",mk="fbase_key";class Au{constructor(t){this.request=t}toPromise(){return new Promise((t,r)=>{this.request.addEventListener("success",()=>{t(this.request.result)}),this.request.addEventListener("error",()=>{r(this.request.error)})})}}function Fd(e,t){return e.transaction([Vh],t?"readwrite":"readonly").objectStore(Vh)}function OD(){const e=indexedDB.deleteDatabase(dk);return new Au(e).toPromise()}function fp(){const e=indexedDB.open(dk,FD);return new Promise((t,r)=>{e.addEventListener("error",()=>{r(e.error)}),e.addEventListener("upgradeneeded",()=>{const n=e.result;try{n.createObjectStore(Vh,{keyPath:mk})}catch(s){r(s)}}),e.addEventListener("success",async()=>{const n=e.result;n.objectStoreNames.contains(Vh)?t(n):(n.close(),await OD(),t(await fp()))})})}async function U_(e,t,r){const n=Fd(e,!0).put({[mk]:t,value:r});return new Au(n).toPromise()}async function MD(e,t){const r=Fd(e,!1).get(t),n=await new Au(r).toPromise();return n===void 0?null:n.value}function B_(e,t){const r=Fd(e,!0).delete(t);return new Au(r).toPromise()}const LD=800,jD=3;class pk{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await fp(),this.db)}async _withRetries(t){let r=0;for(;;)try{const n=await this._openDb();return await t(n)}catch(n){if(r++>jD)throw n;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return hk()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=Dd._getInstance(DD()),this.receiver._subscribe("keyChanged",async(t,r)=>({keyProcessed:(await this._poll()).includes(r.key)})),this.receiver._subscribe("ping",async(t,r)=>["keyChanged"])}async initializeSender(){var t,r;if(this.activeServiceWorker=await bD(),!this.activeServiceWorker)return;this.sender=new RD(this.activeServiceWorker);const n=await this.sender._send("ping",{},800);n&&!((t=n[0])===null||t===void 0)&&t.fulfilled&&!((r=n[0])===null||r===void 0)&&r.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(t){if(!(!this.sender||!this.activeServiceWorker||PD()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:t},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const t=await fp();return await U_(t,jh,"1"),await B_(t,jh),!0}catch{}return!1}async _withPendingWrite(t){this.pendingWrites++;try{await t()}finally{this.pendingWrites--}}async _set(t,r){return this._withPendingWrite(async()=>(await this._withRetries(n=>U_(n,t,r)),this.localCache[t]=r,this.notifyServiceWorker(t)))}async _get(t){const r=await this._withRetries(n=>MD(n,t));return this.localCache[t]=r,r}async _remove(t){return this._withPendingWrite(async()=>(await this._withRetries(r=>B_(r,t)),delete this.localCache[t],this.notifyServiceWorker(t)))}async _poll(){const t=await this._withRetries(s=>{const a=Fd(s,!1).getAll();return new Au(a).toPromise()});if(!t)return[];if(this.pendingWrites!==0)return[];const r=[],n=new Set;if(t.length!==0)for(const{fbase_key:s,value:a}of t)n.add(s),JSON.stringify(this.localCache[s])!==JSON.stringify(a)&&(this.notifyListeners(s,a),r.push(s));for(const s of Object.keys(this.localCache))this.localCache[s]&&!n.has(s)&&(this.notifyListeners(s,null),r.push(s));return r}notifyListeners(t,r){this.localCache[t]=r;const n=this.listeners[t];if(n)for(const s of Array.from(n))s(r)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),LD)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(t,r){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[t]||(this.listeners[t]=new Set,this._get(t)),this.listeners[t].add(r)}_removeListener(t,r){this.listeners[t]&&(this.listeners[t].delete(r),this.listeners[t].size===0&&delete this.listeners[t]),Object.keys(this.listeners).length===0&&this.stopPolling()}}pk.type="LOCAL";const VD=pk;new ku(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gk(e,t){return t?Qs(t):(Me(e._popupRedirectResolver,e,"argument-error"),e._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nv extends ak{constructor(t){super("custom","custom"),this.params=t}_getIdTokenResponse(t){return Wo(t,this._buildIdpRequest())}_linkToIdToken(t,r){return Wo(t,this._buildIdpRequest(r))}_getReauthenticationResolver(t){return Wo(t,this._buildIdpRequest())}_buildIdpRequest(t){const r={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return t&&(r.idToken=t),r}}function UD(e){return wD(e.auth,new nv(e),e.bypassAuthState)}function BD(e){const{auth:t,user:r}=e;return Me(r,t,"internal-error"),yD(r,new nv(e),e.bypassAuthState)}async function zD(e){const{auth:t,user:r}=e;return Me(r,t,"internal-error"),_D(r,new nv(e),e.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vk{constructor(t,r,n,s,a=!1){this.auth=t,this.resolver=n,this.user=s,this.bypassAuthState=a,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(r)?r:[r]}execute(){return new Promise(async(t,r)=>{this.pendingPromise={resolve:t,reject:r};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(n){this.reject(n)}})}async onAuthEvent(t){const{urlResponse:r,sessionId:n,postBody:s,tenantId:a,error:i,type:o}=t;if(i){this.reject(i);return}const l={auth:this.auth,requestUri:r,sessionId:n,tenantId:a||void 0,postBody:s||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(o)(l))}catch(c){this.reject(c)}}onError(t){this.reject(t)}getIdpTask(t){switch(t){case"signInViaPopup":case"signInViaRedirect":return UD;case"linkViaPopup":case"linkViaRedirect":return zD;case"reauthViaPopup":case"reauthViaRedirect":return BD;default:Is(this.auth,"internal-error")}}resolve(t){ha(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(t),this.unregisterAndCleanUp()}reject(t){ha(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(t),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $D=new ku(2e3,1e4);async function xk(e,t,r){if(qs(e.app))return Promise.reject(os(e,"operation-not-supported-in-this-environment"));const n=Pd(e);BP(e,t,tv);const s=gk(n,r);return new Ri(n,"signInViaPopup",t,s).executeNotNull()}class Ri extends vk{constructor(t,r,n,s,a){super(t,r,s,a),this.provider=n,this.authWindow=null,this.pollId=null,Ri.currentPopupAction&&Ri.currentPopupAction.cancel(),Ri.currentPopupAction=this}async executeNotNull(){const t=await this.execute();return Me(t,this.auth,"internal-error"),t}async onExecution(){ha(this.filter.length===1,"Popup operations only handle one event");const t=rv();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],t),this.authWindow.associatedEvent=t,this.resolver._originValidation(this.auth).catch(r=>{this.reject(r)}),this.resolver._isIframeWebStorageSupported(this.auth,r=>{r||this.reject(os(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var t;return((t=this.authWindow)===null||t===void 0?void 0:t.associatedEvent)||null}cancel(){this.reject(os(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Ri.currentPopupAction=null}pollUserCancellation(){const t=()=>{var r,n;if(!((n=(r=this.authWindow)===null||r===void 0?void 0:r.window)===null||n===void 0)&&n.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(os(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(t,$D.get())};t()}}Ri.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const WD="pendingRedirect",Yf=new Map;class HD extends vk{constructor(t,r,n=!1){super(t,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],r,void 0,n),this.eventId=null}async execute(){let t=Yf.get(this.auth._key());if(!t){try{const n=await GD(this.resolver,this.auth)?await super.execute():null;t=()=>Promise.resolve(n)}catch(r){t=()=>Promise.reject(r)}Yf.set(this.auth._key(),t)}return this.bypassAuthState||Yf.set(this.auth._key(),()=>Promise.resolve(null)),t()}async onAuthEvent(t){if(t.type==="signInViaRedirect")return super.onAuthEvent(t);if(t.type==="unknown"){this.resolve(null);return}if(t.eventId){const r=await this.auth._redirectUserForId(t.eventId);if(r)return this.user=r,super.onAuthEvent(t);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function GD(e,t){const r=XD(t),n=qD(e);if(!await n._isAvailable())return!1;const s=await n._get(r)==="true";return await n._remove(r),s}function KD(e,t){Yf.set(e._key(),t)}function qD(e){return Qs(e._redirectPersistence)}function XD(e){return Xf(WD,e.config.apiKey,e.name)}async function YD(e,t,r=!1){if(qs(e.app))return Promise.reject(Fi(e));const n=Pd(e),s=gk(n,t),i=await new HD(n,s,r).execute();return i&&!r&&(delete i.user._redirectEventId,await n._persistUserIfCurrent(i.user),await n._setRedirectUser(null,t)),i}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const QD=10*60*1e3;class JD{constructor(t){this.auth=t,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(t){this.consumers.add(t),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,t)&&(this.sendToConsumer(this.queuedRedirectEvent,t),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(t){this.consumers.delete(t)}onEvent(t){if(this.hasEventBeenHandled(t))return!1;let r=!1;return this.consumers.forEach(n=>{this.isEventForConsumer(t,n)&&(r=!0,this.sendToConsumer(t,n),this.saveEventToCache(t))}),this.hasHandledPotentialRedirect||!ZD(t)||(this.hasHandledPotentialRedirect=!0,r||(this.queuedRedirectEvent=t,r=!0)),r}sendToConsumer(t,r){var n;if(t.error&&!_k(t)){const s=((n=t.error.code)===null||n===void 0?void 0:n.split("auth/")[1])||"internal-error";r.onError(os(this.auth,s))}else r.onAuthEvent(t)}isEventForConsumer(t,r){const n=r.eventId===null||!!t.eventId&&t.eventId===r.eventId;return r.filter.includes(t.type)&&n}hasEventBeenHandled(t){return Date.now()-this.lastProcessedEventTime>=QD&&this.cachedEventUids.clear(),this.cachedEventUids.has(z_(t))}saveEventToCache(t){this.cachedEventUids.add(z_(t)),this.lastProcessedEventTime=Date.now()}}function z_(e){return[e.type,e.eventId,e.sessionId,e.tenantId].filter(t=>t).join("-")}function _k({type:e,error:t}){return e==="unknown"&&(t==null?void 0:t.code)==="auth/no-auth-event"}function ZD(e){switch(e.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return _k(e);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function e3(e,t={}){return yl(e,"GET","/v1/projects",t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const t3=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,r3=/^https?/;async function n3(e){if(e.config.emulator)return;const{authorizedDomains:t}=await e3(e);for(const r of t)try{if(s3(r))return}catch{}Is(e,"unauthorized-domain")}function s3(e){const t=cp(),{protocol:r,hostname:n}=new URL(t);if(e.startsWith("chrome-extension://")){const i=new URL(e);return i.hostname===""&&n===""?r==="chrome-extension:"&&e.replace("chrome-extension://","")===t.replace("chrome-extension://",""):r==="chrome-extension:"&&i.hostname===n}if(!r3.test(r))return!1;if(t3.test(e))return n===e;const s=e.replace(/\./g,"\\.");return new RegExp("^(.+\\."+s+"|"+s+")$","i").test(n)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const a3=new ku(3e4,6e4);function $_(){const e=ks().___jsl;if(e!=null&&e.H){for(const t of Object.keys(e.H))if(e.H[t].r=e.H[t].r||[],e.H[t].L=e.H[t].L||[],e.H[t].r=[...e.H[t].L],e.CP)for(let r=0;r<e.CP.length;r++)e.CP[r]=null}}function i3(e){return new Promise((t,r)=>{var n,s,a;function i(){$_(),gapi.load("gapi.iframes",{callback:()=>{t(gapi.iframes.getContext())},ontimeout:()=>{$_(),r(os(e,"network-request-failed"))},timeout:a3.get()})}if(!((s=(n=ks().gapi)===null||n===void 0?void 0:n.iframes)===null||s===void 0)&&s.Iframe)t(gapi.iframes.getContext());else if(!((a=ks().gapi)===null||a===void 0)&&a.load)i();else{const o=hD("iframefcb");return ks()[o]=()=>{gapi.load?i():r(os(e,"network-request-failed"))},uD(`${fD()}?onload=${o}`).catch(l=>r(l))}}).catch(t=>{throw Qf=null,t})}let Qf=null;function o3(e){return Qf=Qf||i3(e),Qf}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const l3=new ku(5e3,15e3),c3="__/auth/iframe",u3="emulator/auth/iframe",f3={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},h3=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function d3(e){const t=e.config;Me(t.authDomain,e,"auth-domain-config-required");const r=t.emulator?Yg(t,u3):`https://${e.config.authDomain}/${c3}`,n={apiKey:t.apiKey,appName:e.name,v:Zi},s=h3.get(e.config.apiHost);s&&(n.eid=s);const a=e._getFrameworks();return a.length&&(n.fw=a.join(",")),`${r}?${Eu(n).slice(1)}`}async function m3(e){const t=await o3(e),r=ks().gapi;return Me(r,e,"internal-error"),t.open({where:document.body,url:d3(e),messageHandlersFilter:r.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:f3,dontclear:!0},n=>new Promise(async(s,a)=>{await n.restyle({setHideOnLeave:!1});const i=os(e,"network-request-failed"),o=ks().setTimeout(()=>{a(i)},l3.get());function l(){ks().clearTimeout(o),s(n)}n.ping(l).then(l,()=>{a(i)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const p3={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},g3=500,v3=600,x3="_blank",_3="http://localhost";class W_{constructor(t){this.window=t,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function y3(e,t,r,n=g3,s=v3){const a=Math.max((window.screen.availHeight-s)/2,0).toString(),i=Math.max((window.screen.availWidth-n)/2,0).toString();let o="";const l=Object.assign(Object.assign({},p3),{width:n.toString(),height:s.toString(),top:a,left:i}),c=zr().toLowerCase();r&&(o=QT(c)?x3:r),XT(c)&&(t=t||_3,l.scrollbars="yes");const u=Object.entries(l).reduce((m,[p,x])=>`${m}${p}=${x},`,"");if(rD(c)&&o!=="_self")return w3(t||"",o),new W_(null);const h=window.open(t||"",o,u);Me(h,e,"popup-blocked");try{h.focus()}catch{}return new W_(h)}function w3(e,t){const r=document.createElement("a");r.href=e,r.target=t;const n=document.createEvent("MouseEvent");n.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),r.dispatchEvent(n)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const E3="__/auth/handler",T3="emulator/auth/handler",k3=encodeURIComponent("fac");async function H_(e,t,r,n,s,a){Me(e.config.authDomain,e,"auth-domain-config-required"),Me(e.config.apiKey,e,"invalid-api-key");const i={apiKey:e.config.apiKey,appName:e.name,authType:r,redirectUrl:n,v:Zi,eventId:s};if(t instanceof tv){t.setDefaultLanguage(e.languageCode),i.providerId=t.providerId||"",Cb(t.getCustomParameters())||(i.customParameters=JSON.stringify(t.getCustomParameters()));for(const[u,h]of Object.entries({}))i[u]=h}if(t instanceof Su){const u=t.getScopes().filter(h=>h!=="");u.length>0&&(i.scopes=u.join(","))}e.tenantId&&(i.tid=e.tenantId);const o=i;for(const u of Object.keys(o))o[u]===void 0&&delete o[u];const l=await e._getAppCheckToken(),c=l?`#${k3}=${encodeURIComponent(l)}`:"";return`${S3(e)}?${Eu(o).slice(1)}${c}`}function S3({config:e}){return e.emulator?Yg(e,T3):`https://${e.authDomain}/${E3}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const H0="webStorageSupport";class A3{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=fk,this._completeRedirectFn=YD,this._overrideRedirectResult=KD}async _openPopup(t,r,n,s){var a;ha((a=this.eventManagers[t._key()])===null||a===void 0?void 0:a.manager,"_initialize() not called before _openPopup()");const i=await H_(t,r,n,cp(),s);return y3(t,i,rv())}async _openRedirect(t,r,n,s){await this._originValidation(t);const a=await H_(t,r,n,cp(),s);return ND(a),new Promise(()=>{})}_initialize(t){const r=t._key();if(this.eventManagers[r]){const{manager:s,promise:a}=this.eventManagers[r];return s?Promise.resolve(s):(ha(a,"If manager is not set, promise should be"),a)}const n=this.initAndGetManager(t);return this.eventManagers[r]={promise:n},n.catch(()=>{delete this.eventManagers[r]}),n}async initAndGetManager(t){const r=await m3(t),n=new JD(t);return r.register("authEvent",s=>(Me(s==null?void 0:s.authEvent,t,"invalid-auth-event"),{status:n.onEvent(s.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[t._key()]={manager:n},this.iframes[t._key()]=r,n}_isIframeWebStorageSupported(t,r){this.iframes[t._key()].send(H0,{type:H0},s=>{var a;const i=(a=s==null?void 0:s[0])===null||a===void 0?void 0:a[H0];i!==void 0&&r(!!i),Is(t,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(t){const r=t._key();return this.originValidationPromises[r]||(this.originValidationPromises[r]=n3(t)),this.originValidationPromises[r]}get _shouldInitProactively(){return rk()||YT()||Zg()}}const I3=A3;var G_="@firebase/auth",K_="1.7.9";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class C3{constructor(t){this.auth=t,this.internalListeners=new Map}getUid(){var t;return this.assertAuthConfigured(),((t=this.auth.currentUser)===null||t===void 0?void 0:t.uid)||null}async getToken(t){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(t)}:null}addAuthTokenListener(t){if(this.assertAuthConfigured(),this.internalListeners.has(t))return;const r=this.auth.onIdTokenChanged(n=>{t((n==null?void 0:n.stsTokenManager.accessToken)||null)});this.internalListeners.set(t,r),this.updateProactiveRefresh()}removeAuthTokenListener(t){this.assertAuthConfigured();const r=this.internalListeners.get(t);r&&(this.internalListeners.delete(t),r(),this.updateProactiveRefresh())}assertAuthConfigured(){Me(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function R3(e){switch(e){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function N3(e){ni(new ua("auth",(t,{options:r})=>{const n=t.getProvider("app").getImmediate(),s=t.getProvider("heartbeat"),a=t.getProvider("app-check-internal"),{apiKey:i,authDomain:o}=n.options;Me(i&&!i.includes(":"),"invalid-api-key",{appName:n.name});const l={apiKey:i,authDomain:o,clientPlatform:e,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:nk(e)},c=new lD(n,s,a,l);return mD(c,r),c},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((t,r,n)=>{t.getProvider("auth-internal").initialize()})),ni(new ua("auth-internal",t=>{const r=Pd(t.getProvider("auth").getImmediate());return(n=>new C3(n))(r)},"PRIVATE").setInstantiationMode("EXPLICIT")),Vn(G_,K_,R3(e)),Vn(G_,K_,"esm2017")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const b3=5*60,P3=DT("authIdTokenMaxAge")||b3;let q_=null;const D3=e=>async t=>{const r=t&&await t.getIdTokenResult(),n=r&&(new Date().getTime()-Date.parse(r.issuedAtTime))/1e3;if(n&&n>P3)return;const s=r==null?void 0:r.token;q_!==s&&(q_=s,await fetch(e,{method:s?"POST":"DELETE",headers:s?{Authorization:`Bearer ${s}`}:{}}))};function F3(e=bd()){const t=Tu(e,"auth");if(t.isInitialized())return t.getImmediate();const r=dD(e,{popupRedirectResolver:I3,persistence:[VD,ID,fk]}),n=DT("authTokenSyncURL");if(n&&typeof isSecureContext=="boolean"&&isSecureContext){const a=new URL(n,location.origin);if(location.origin===a.origin){const i=D3(a.toString());TD(r,i,()=>i(r.currentUser)),ED(r,o=>i(o))}}const s=bT("auth");return s&&pD(r,`http://${s}`),r}function O3(){var e,t;return(t=(e=document.getElementsByTagName("head"))===null||e===void 0?void 0:e[0])!==null&&t!==void 0?t:document}cD({loadJS(e){return new Promise((t,r)=>{const n=document.createElement("script");n.setAttribute("src",e),n.onload=t,n.onerror=s=>{const a=os("internal-error");a.customData=s,r(a)},n.type="text/javascript",n.charset="UTF-8",O3().appendChild(n)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});N3("Browser");var X_=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Oi,yk;(function(){var e;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function t(g,y){function S(){}S.prototype=y.prototype,g.D=y.prototype,g.prototype=new S,g.prototype.constructor=g,g.C=function(R,b,P){for(var C=Array(arguments.length-2),le=2;le<arguments.length;le++)C[le-2]=arguments[le];return y.prototype[b].apply(R,C)}}function r(){this.blockSize=-1}function n(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}t(n,r),n.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function s(g,y,S){S||(S=0);var R=Array(16);if(typeof y=="string")for(var b=0;16>b;++b)R[b]=y.charCodeAt(S++)|y.charCodeAt(S++)<<8|y.charCodeAt(S++)<<16|y.charCodeAt(S++)<<24;else for(b=0;16>b;++b)R[b]=y[S++]|y[S++]<<8|y[S++]<<16|y[S++]<<24;y=g.g[0],S=g.g[1],b=g.g[2];var P=g.g[3],C=y+(P^S&(b^P))+R[0]+3614090360&4294967295;y=S+(C<<7&4294967295|C>>>25),C=P+(b^y&(S^b))+R[1]+3905402710&4294967295,P=y+(C<<12&4294967295|C>>>20),C=b+(S^P&(y^S))+R[2]+606105819&4294967295,b=P+(C<<17&4294967295|C>>>15),C=S+(y^b&(P^y))+R[3]+3250441966&4294967295,S=b+(C<<22&4294967295|C>>>10),C=y+(P^S&(b^P))+R[4]+4118548399&4294967295,y=S+(C<<7&4294967295|C>>>25),C=P+(b^y&(S^b))+R[5]+1200080426&4294967295,P=y+(C<<12&4294967295|C>>>20),C=b+(S^P&(y^S))+R[6]+2821735955&4294967295,b=P+(C<<17&4294967295|C>>>15),C=S+(y^b&(P^y))+R[7]+4249261313&4294967295,S=b+(C<<22&4294967295|C>>>10),C=y+(P^S&(b^P))+R[8]+1770035416&4294967295,y=S+(C<<7&4294967295|C>>>25),C=P+(b^y&(S^b))+R[9]+2336552879&4294967295,P=y+(C<<12&4294967295|C>>>20),C=b+(S^P&(y^S))+R[10]+4294925233&4294967295,b=P+(C<<17&4294967295|C>>>15),C=S+(y^b&(P^y))+R[11]+2304563134&4294967295,S=b+(C<<22&4294967295|C>>>10),C=y+(P^S&(b^P))+R[12]+1804603682&4294967295,y=S+(C<<7&4294967295|C>>>25),C=P+(b^y&(S^b))+R[13]+4254626195&4294967295,P=y+(C<<12&4294967295|C>>>20),C=b+(S^P&(y^S))+R[14]+2792965006&4294967295,b=P+(C<<17&4294967295|C>>>15),C=S+(y^b&(P^y))+R[15]+1236535329&4294967295,S=b+(C<<22&4294967295|C>>>10),C=y+(b^P&(S^b))+R[1]+4129170786&4294967295,y=S+(C<<5&4294967295|C>>>27),C=P+(S^b&(y^S))+R[6]+3225465664&4294967295,P=y+(C<<9&4294967295|C>>>23),C=b+(y^S&(P^y))+R[11]+643717713&4294967295,b=P+(C<<14&4294967295|C>>>18),C=S+(P^y&(b^P))+R[0]+3921069994&4294967295,S=b+(C<<20&4294967295|C>>>12),C=y+(b^P&(S^b))+R[5]+3593408605&4294967295,y=S+(C<<5&4294967295|C>>>27),C=P+(S^b&(y^S))+R[10]+38016083&4294967295,P=y+(C<<9&4294967295|C>>>23),C=b+(y^S&(P^y))+R[15]+3634488961&4294967295,b=P+(C<<14&4294967295|C>>>18),C=S+(P^y&(b^P))+R[4]+3889429448&4294967295,S=b+(C<<20&4294967295|C>>>12),C=y+(b^P&(S^b))+R[9]+568446438&4294967295,y=S+(C<<5&4294967295|C>>>27),C=P+(S^b&(y^S))+R[14]+3275163606&4294967295,P=y+(C<<9&4294967295|C>>>23),C=b+(y^S&(P^y))+R[3]+4107603335&4294967295,b=P+(C<<14&4294967295|C>>>18),C=S+(P^y&(b^P))+R[8]+1163531501&4294967295,S=b+(C<<20&4294967295|C>>>12),C=y+(b^P&(S^b))+R[13]+2850285829&4294967295,y=S+(C<<5&4294967295|C>>>27),C=P+(S^b&(y^S))+R[2]+4243563512&4294967295,P=y+(C<<9&4294967295|C>>>23),C=b+(y^S&(P^y))+R[7]+1735328473&4294967295,b=P+(C<<14&4294967295|C>>>18),C=S+(P^y&(b^P))+R[12]+2368359562&4294967295,S=b+(C<<20&4294967295|C>>>12),C=y+(S^b^P)+R[5]+4294588738&4294967295,y=S+(C<<4&4294967295|C>>>28),C=P+(y^S^b)+R[8]+2272392833&4294967295,P=y+(C<<11&4294967295|C>>>21),C=b+(P^y^S)+R[11]+1839030562&4294967295,b=P+(C<<16&4294967295|C>>>16),C=S+(b^P^y)+R[14]+4259657740&4294967295,S=b+(C<<23&4294967295|C>>>9),C=y+(S^b^P)+R[1]+2763975236&4294967295,y=S+(C<<4&4294967295|C>>>28),C=P+(y^S^b)+R[4]+1272893353&4294967295,P=y+(C<<11&4294967295|C>>>21),C=b+(P^y^S)+R[7]+4139469664&4294967295,b=P+(C<<16&4294967295|C>>>16),C=S+(b^P^y)+R[10]+3200236656&4294967295,S=b+(C<<23&4294967295|C>>>9),C=y+(S^b^P)+R[13]+681279174&4294967295,y=S+(C<<4&4294967295|C>>>28),C=P+(y^S^b)+R[0]+3936430074&4294967295,P=y+(C<<11&4294967295|C>>>21),C=b+(P^y^S)+R[3]+3572445317&4294967295,b=P+(C<<16&4294967295|C>>>16),C=S+(b^P^y)+R[6]+76029189&4294967295,S=b+(C<<23&4294967295|C>>>9),C=y+(S^b^P)+R[9]+3654602809&4294967295,y=S+(C<<4&4294967295|C>>>28),C=P+(y^S^b)+R[12]+3873151461&4294967295,P=y+(C<<11&4294967295|C>>>21),C=b+(P^y^S)+R[15]+530742520&4294967295,b=P+(C<<16&4294967295|C>>>16),C=S+(b^P^y)+R[2]+3299628645&4294967295,S=b+(C<<23&4294967295|C>>>9),C=y+(b^(S|~P))+R[0]+4096336452&4294967295,y=S+(C<<6&4294967295|C>>>26),C=P+(S^(y|~b))+R[7]+1126891415&4294967295,P=y+(C<<10&4294967295|C>>>22),C=b+(y^(P|~S))+R[14]+2878612391&4294967295,b=P+(C<<15&4294967295|C>>>17),C=S+(P^(b|~y))+R[5]+4237533241&4294967295,S=b+(C<<21&4294967295|C>>>11),C=y+(b^(S|~P))+R[12]+1700485571&4294967295,y=S+(C<<6&4294967295|C>>>26),C=P+(S^(y|~b))+R[3]+2399980690&4294967295,P=y+(C<<10&4294967295|C>>>22),C=b+(y^(P|~S))+R[10]+4293915773&4294967295,b=P+(C<<15&4294967295|C>>>17),C=S+(P^(b|~y))+R[1]+2240044497&4294967295,S=b+(C<<21&4294967295|C>>>11),C=y+(b^(S|~P))+R[8]+1873313359&4294967295,y=S+(C<<6&4294967295|C>>>26),C=P+(S^(y|~b))+R[15]+4264355552&4294967295,P=y+(C<<10&4294967295|C>>>22),C=b+(y^(P|~S))+R[6]+2734768916&4294967295,b=P+(C<<15&4294967295|C>>>17),C=S+(P^(b|~y))+R[13]+1309151649&4294967295,S=b+(C<<21&4294967295|C>>>11),C=y+(b^(S|~P))+R[4]+4149444226&4294967295,y=S+(C<<6&4294967295|C>>>26),C=P+(S^(y|~b))+R[11]+3174756917&4294967295,P=y+(C<<10&4294967295|C>>>22),C=b+(y^(P|~S))+R[2]+718787259&4294967295,b=P+(C<<15&4294967295|C>>>17),C=S+(P^(b|~y))+R[9]+3951481745&4294967295,g.g[0]=g.g[0]+y&4294967295,g.g[1]=g.g[1]+(b+(C<<21&4294967295|C>>>11))&4294967295,g.g[2]=g.g[2]+b&4294967295,g.g[3]=g.g[3]+P&4294967295}n.prototype.u=function(g,y){y===void 0&&(y=g.length);for(var S=y-this.blockSize,R=this.B,b=this.h,P=0;P<y;){if(b==0)for(;P<=S;)s(this,g,P),P+=this.blockSize;if(typeof g=="string"){for(;P<y;)if(R[b++]=g.charCodeAt(P++),b==this.blockSize){s(this,R),b=0;break}}else for(;P<y;)if(R[b++]=g[P++],b==this.blockSize){s(this,R),b=0;break}}this.h=b,this.o+=y},n.prototype.v=function(){var g=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);g[0]=128;for(var y=1;y<g.length-8;++y)g[y]=0;var S=8*this.o;for(y=g.length-8;y<g.length;++y)g[y]=S&255,S/=256;for(this.u(g),g=Array(16),y=S=0;4>y;++y)for(var R=0;32>R;R+=8)g[S++]=this.g[y]>>>R&255;return g};function a(g,y){var S=o;return Object.prototype.hasOwnProperty.call(S,g)?S[g]:S[g]=y(g)}function i(g,y){this.h=y;for(var S=[],R=!0,b=g.length-1;0<=b;b--){var P=g[b]|0;R&&P==y||(S[b]=P,R=!1)}this.g=S}var o={};function l(g){return-128<=g&&128>g?a(g,function(y){return new i([y|0],0>y?-1:0)}):new i([g|0],0>g?-1:0)}function c(g){if(isNaN(g)||!isFinite(g))return h;if(0>g)return w(c(-g));for(var y=[],S=1,R=0;g>=S;R++)y[R]=g/S|0,S*=4294967296;return new i(y,0)}function u(g,y){if(g.length==0)throw Error("number format error: empty string");if(y=y||10,2>y||36<y)throw Error("radix out of range: "+y);if(g.charAt(0)=="-")return w(u(g.substring(1),y));if(0<=g.indexOf("-"))throw Error('number format error: interior "-" character');for(var S=c(Math.pow(y,8)),R=h,b=0;b<g.length;b+=8){var P=Math.min(8,g.length-b),C=parseInt(g.substring(b,b+P),y);8>P?(P=c(Math.pow(y,P)),R=R.j(P).add(c(C))):(R=R.j(S),R=R.add(c(C)))}return R}var h=l(0),m=l(1),p=l(16777216);e=i.prototype,e.m=function(){if(v(this))return-w(this).m();for(var g=0,y=1,S=0;S<this.g.length;S++){var R=this.i(S);g+=(0<=R?R:4294967296+R)*y,y*=4294967296}return g},e.toString=function(g){if(g=g||10,2>g||36<g)throw Error("radix out of range: "+g);if(x(this))return"0";if(v(this))return"-"+w(this).toString(g);for(var y=c(Math.pow(g,6)),S=this,R="";;){var b=N(S,y).g;S=k(S,b.j(y));var P=((0<S.g.length?S.g[0]:S.h)>>>0).toString(g);if(S=b,x(S))return P+R;for(;6>P.length;)P="0"+P;R=P+R}},e.i=function(g){return 0>g?0:g<this.g.length?this.g[g]:this.h};function x(g){if(g.h!=0)return!1;for(var y=0;y<g.g.length;y++)if(g.g[y]!=0)return!1;return!0}function v(g){return g.h==-1}e.l=function(g){return g=k(this,g),v(g)?-1:x(g)?0:1};function w(g){for(var y=g.g.length,S=[],R=0;R<y;R++)S[R]=~g.g[R];return new i(S,~g.h).add(m)}e.abs=function(){return v(this)?w(this):this},e.add=function(g){for(var y=Math.max(this.g.length,g.g.length),S=[],R=0,b=0;b<=y;b++){var P=R+(this.i(b)&65535)+(g.i(b)&65535),C=(P>>>16)+(this.i(b)>>>16)+(g.i(b)>>>16);R=C>>>16,P&=65535,C&=65535,S[b]=C<<16|P}return new i(S,S[S.length-1]&-2147483648?-1:0)};function k(g,y){return g.add(w(y))}e.j=function(g){if(x(this)||x(g))return h;if(v(this))return v(g)?w(this).j(w(g)):w(w(this).j(g));if(v(g))return w(this.j(w(g)));if(0>this.l(p)&&0>g.l(p))return c(this.m()*g.m());for(var y=this.g.length+g.g.length,S=[],R=0;R<2*y;R++)S[R]=0;for(R=0;R<this.g.length;R++)for(var b=0;b<g.g.length;b++){var P=this.i(R)>>>16,C=this.i(R)&65535,le=g.i(b)>>>16,se=g.i(b)&65535;S[2*R+2*b]+=C*se,T(S,2*R+2*b),S[2*R+2*b+1]+=P*se,T(S,2*R+2*b+1),S[2*R+2*b+1]+=C*le,T(S,2*R+2*b+1),S[2*R+2*b+2]+=P*le,T(S,2*R+2*b+2)}for(R=0;R<y;R++)S[R]=S[2*R+1]<<16|S[2*R];for(R=y;R<2*y;R++)S[R]=0;return new i(S,0)};function T(g,y){for(;(g[y]&65535)!=g[y];)g[y+1]+=g[y]>>>16,g[y]&=65535,y++}function E(g,y){this.g=g,this.h=y}function N(g,y){if(x(y))throw Error("division by zero");if(x(g))return new E(h,h);if(v(g))return y=N(w(g),y),new E(w(y.g),w(y.h));if(v(y))return y=N(g,w(y)),new E(w(y.g),y.h);if(30<g.g.length){if(v(g)||v(y))throw Error("slowDivide_ only works with positive integers.");for(var S=m,R=y;0>=R.l(g);)S=O(S),R=O(R);var b=L(S,1),P=L(R,1);for(R=L(R,2),S=L(S,2);!x(R);){var C=P.add(R);0>=C.l(g)&&(b=b.add(S),P=C),R=L(R,1),S=L(S,1)}return y=k(g,b.j(y)),new E(b,y)}for(b=h;0<=g.l(y);){for(S=Math.max(1,Math.floor(g.m()/y.m())),R=Math.ceil(Math.log(S)/Math.LN2),R=48>=R?1:Math.pow(2,R-48),P=c(S),C=P.j(y);v(C)||0<C.l(g);)S-=R,P=c(S),C=P.j(y);x(P)&&(P=m),b=b.add(P),g=k(g,C)}return new E(b,g)}e.A=function(g){return N(this,g).h},e.and=function(g){for(var y=Math.max(this.g.length,g.g.length),S=[],R=0;R<y;R++)S[R]=this.i(R)&g.i(R);return new i(S,this.h&g.h)},e.or=function(g){for(var y=Math.max(this.g.length,g.g.length),S=[],R=0;R<y;R++)S[R]=this.i(R)|g.i(R);return new i(S,this.h|g.h)},e.xor=function(g){for(var y=Math.max(this.g.length,g.g.length),S=[],R=0;R<y;R++)S[R]=this.i(R)^g.i(R);return new i(S,this.h^g.h)};function O(g){for(var y=g.g.length+1,S=[],R=0;R<y;R++)S[R]=g.i(R)<<1|g.i(R-1)>>>31;return new i(S,g.h)}function L(g,y){var S=y>>5;y%=32;for(var R=g.g.length-S,b=[],P=0;P<R;P++)b[P]=0<y?g.i(P+S)>>>y|g.i(P+S+1)<<32-y:g.i(P+S);return new i(b,g.h)}n.prototype.digest=n.prototype.v,n.prototype.reset=n.prototype.s,n.prototype.update=n.prototype.u,yk=n,i.prototype.add=i.prototype.add,i.prototype.multiply=i.prototype.j,i.prototype.modulo=i.prototype.A,i.prototype.compare=i.prototype.l,i.prototype.toNumber=i.prototype.m,i.prototype.toString=i.prototype.toString,i.prototype.getBits=i.prototype.i,i.fromNumber=c,i.fromString=u,Oi=i}).apply(typeof X_<"u"?X_:typeof self<"u"?self:typeof window<"u"?window:{});var wf=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var wk,Zl,Ek,Jf,hp,Tk,kk,Sk;(function(){var e,t=typeof Object.defineProperties=="function"?Object.defineProperty:function(f,_,A){return f==Array.prototype||f==Object.prototype||(f[_]=A.value),f};function r(f){f=[typeof globalThis=="object"&&globalThis,f,typeof window=="object"&&window,typeof self=="object"&&self,typeof wf=="object"&&wf];for(var _=0;_<f.length;++_){var A=f[_];if(A&&A.Math==Math)return A}throw Error("Cannot find global object")}var n=r(this);function s(f,_){if(_)e:{var A=n;f=f.split(".");for(var U=0;U<f.length-1;U++){var re=f[U];if(!(re in A))break e;A=A[re]}f=f[f.length-1],U=A[f],_=_(U),_!=U&&_!=null&&t(A,f,{configurable:!0,writable:!0,value:_})}}function a(f,_){f instanceof String&&(f+="");var A=0,U=!1,re={next:function(){if(!U&&A<f.length){var ae=A++;return{value:_(ae,f[ae]),done:!1}}return U=!0,{done:!0,value:void 0}}};return re[Symbol.iterator]=function(){return re},re}s("Array.prototype.values",function(f){return f||function(){return a(this,function(_,A){return A})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var i=i||{},o=this||self;function l(f){var _=typeof f;return _=_!="object"?_:f?Array.isArray(f)?"array":_:"null",_=="array"||_=="object"&&typeof f.length=="number"}function c(f){var _=typeof f;return _=="object"&&f!=null||_=="function"}function u(f,_,A){return f.call.apply(f.bind,arguments)}function h(f,_,A){if(!f)throw Error();if(2<arguments.length){var U=Array.prototype.slice.call(arguments,2);return function(){var re=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(re,U),f.apply(_,re)}}return function(){return f.apply(_,arguments)}}function m(f,_,A){return m=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?u:h,m.apply(null,arguments)}function p(f,_){var A=Array.prototype.slice.call(arguments,1);return function(){var U=A.slice();return U.push.apply(U,arguments),f.apply(this,U)}}function x(f,_){function A(){}A.prototype=_.prototype,f.aa=_.prototype,f.prototype=new A,f.prototype.constructor=f,f.Qb=function(U,re,ae){for(var ke=Array(arguments.length-2),yt=2;yt<arguments.length;yt++)ke[yt-2]=arguments[yt];return _.prototype[re].apply(U,ke)}}function v(f){const _=f.length;if(0<_){const A=Array(_);for(let U=0;U<_;U++)A[U]=f[U];return A}return[]}function w(f,_){for(let A=1;A<arguments.length;A++){const U=arguments[A];if(l(U)){const re=f.length||0,ae=U.length||0;f.length=re+ae;for(let ke=0;ke<ae;ke++)f[re+ke]=U[ke]}else f.push(U)}}class k{constructor(_,A){this.i=_,this.j=A,this.h=0,this.g=null}get(){let _;return 0<this.h?(this.h--,_=this.g,this.g=_.next,_.next=null):_=this.i(),_}}function T(f){return/^[\s\xa0]*$/.test(f)}function E(){var f=o.navigator;return f&&(f=f.userAgent)?f:""}function N(f){return N[" "](f),f}N[" "]=function(){};var O=E().indexOf("Gecko")!=-1&&!(E().toLowerCase().indexOf("webkit")!=-1&&E().indexOf("Edge")==-1)&&!(E().indexOf("Trident")!=-1||E().indexOf("MSIE")!=-1)&&E().indexOf("Edge")==-1;function L(f,_,A){for(const U in f)_.call(A,f[U],U,f)}function g(f,_){for(const A in f)_.call(void 0,f[A],A,f)}function y(f){const _={};for(const A in f)_[A]=f[A];return _}const S="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function R(f,_){let A,U;for(let re=1;re<arguments.length;re++){U=arguments[re];for(A in U)f[A]=U[A];for(let ae=0;ae<S.length;ae++)A=S[ae],Object.prototype.hasOwnProperty.call(U,A)&&(f[A]=U[A])}}function b(f){var _=1;f=f.split(":");const A=[];for(;0<_&&f.length;)A.push(f.shift()),_--;return f.length&&A.push(f.join(":")),A}function P(f){o.setTimeout(()=>{throw f},0)}function C(){var f=H;let _=null;return f.g&&(_=f.g,f.g=f.g.next,f.g||(f.h=null),_.next=null),_}class le{constructor(){this.h=this.g=null}add(_,A){const U=se.get();U.set(_,A),this.h?this.h.next=U:this.g=U,this.h=U}}var se=new k(()=>new he,f=>f.reset());class he{constructor(){this.next=this.g=this.h=null}set(_,A){this.h=_,this.g=A,this.next=null}reset(){this.next=this.g=this.h=null}}let de,ie=!1,H=new le,ce=()=>{const f=o.Promise.resolve(void 0);de=()=>{f.then(ve)}};var ve=()=>{for(var f;f=C();){try{f.h.call(f.g)}catch(A){P(A)}var _=se;_.j(f),100>_.h&&(_.h++,f.next=_.g,_.g=f)}ie=!1};function B(){this.s=this.s,this.C=this.C}B.prototype.s=!1,B.prototype.ma=function(){this.s||(this.s=!0,this.N())},B.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function K(f,_){this.type=f,this.g=this.target=_,this.defaultPrevented=!1}K.prototype.h=function(){this.defaultPrevented=!0};var q=function(){if(!o.addEventListener||!Object.defineProperty)return!1;var f=!1,_=Object.defineProperty({},"passive",{get:function(){f=!0}});try{const A=()=>{};o.addEventListener("test",A,_),o.removeEventListener("test",A,_)}catch{}return f}();function G(f,_){if(K.call(this,f?f.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,f){var A=this.type=f.type,U=f.changedTouches&&f.changedTouches.length?f.changedTouches[0]:null;if(this.target=f.target||f.srcElement,this.g=_,_=f.relatedTarget){if(O){e:{try{N(_.nodeName);var re=!0;break e}catch{}re=!1}re||(_=null)}}else A=="mouseover"?_=f.fromElement:A=="mouseout"&&(_=f.toElement);this.relatedTarget=_,U?(this.clientX=U.clientX!==void 0?U.clientX:U.pageX,this.clientY=U.clientY!==void 0?U.clientY:U.pageY,this.screenX=U.screenX||0,this.screenY=U.screenY||0):(this.clientX=f.clientX!==void 0?f.clientX:f.pageX,this.clientY=f.clientY!==void 0?f.clientY:f.pageY,this.screenX=f.screenX||0,this.screenY=f.screenY||0),this.button=f.button,this.key=f.key||"",this.ctrlKey=f.ctrlKey,this.altKey=f.altKey,this.shiftKey=f.shiftKey,this.metaKey=f.metaKey,this.pointerId=f.pointerId||0,this.pointerType=typeof f.pointerType=="string"?f.pointerType:oe[f.pointerType]||"",this.state=f.state,this.i=f,f.defaultPrevented&&G.aa.h.call(this)}}x(G,K);var oe={2:"touch",3:"pen",4:"mouse"};G.prototype.h=function(){G.aa.h.call(this);var f=this.i;f.preventDefault?f.preventDefault():f.returnValue=!1};var xe="closure_listenable_"+(1e6*Math.random()|0),Ce=0;function Te(f,_,A,U,re){this.listener=f,this.proxy=null,this.src=_,this.type=A,this.capture=!!U,this.ha=re,this.key=++Ce,this.da=this.fa=!1}function _e(f){f.da=!0,f.listener=null,f.proxy=null,f.src=null,f.ha=null}function $e(f){this.src=f,this.g={},this.h=0}$e.prototype.add=function(f,_,A,U,re){var ae=f.toString();f=this.g[ae],f||(f=this.g[ae]=[],this.h++);var ke=ot(f,_,U,re);return-1<ke?(_=f[ke],A||(_.fa=!1)):(_=new Te(_,this.src,ae,!!U,re),_.fa=A,f.push(_)),_};function z(f,_){var A=_.type;if(A in f.g){var U=f.g[A],re=Array.prototype.indexOf.call(U,_,void 0),ae;(ae=0<=re)&&Array.prototype.splice.call(U,re,1),ae&&(_e(_),f.g[A].length==0&&(delete f.g[A],f.h--))}}function ot(f,_,A,U){for(var re=0;re<f.length;++re){var ae=f[re];if(!ae.da&&ae.listener==_&&ae.capture==!!A&&ae.ha==U)return re}return-1}var He="closure_lm_"+(1e6*Math.random()|0),nt={};function Fe(f,_,A,U,re){if(Array.isArray(_)){for(var ae=0;ae<_.length;ae++)Fe(f,_[ae],A,U,re);return null}return A=lr(A),f&&f[xe]?f.K(_,A,c(U)?!!U.capture:!1,re):Ae(f,_,A,!1,U,re)}function Ae(f,_,A,U,re,ae){if(!_)throw Error("Invalid event type");var ke=c(re)?!!re.capture:!!re,yt=rn(f);if(yt||(f[He]=yt=new $e(f)),A=yt.add(_,A,U,ke,ae),A.proxy)return A;if(U=Tt(),A.proxy=U,U.src=f,U.listener=A,f.addEventListener)q||(re=ke),re===void 0&&(re=!1),f.addEventListener(_.toString(),U,re);else if(f.attachEvent)f.attachEvent(tn(_.toString()),U);else if(f.addListener&&f.removeListener)f.addListener(U);else throw Error("addEventListener and attachEvent are unavailable.");return A}function Tt(){function f(A){return _.call(f.src,f.listener,A)}const _=Ms;return f}function or(f,_,A,U,re){if(Array.isArray(_))for(var ae=0;ae<_.length;ae++)or(f,_[ae],A,U,re);else U=c(U)?!!U.capture:!!U,A=lr(A),f&&f[xe]?(f=f.i,_=String(_).toString(),_ in f.g&&(ae=f.g[_],A=ot(ae,A,U,re),-1<A&&(_e(ae[A]),Array.prototype.splice.call(ae,A,1),ae.length==0&&(delete f.g[_],f.h--)))):f&&(f=rn(f))&&(_=f.g[_.toString()],f=-1,_&&(f=ot(_,A,U,re)),(A=-1<f?_[f]:null)&&Ar(A))}function Ar(f){if(typeof f!="number"&&f&&!f.da){var _=f.src;if(_&&_[xe])z(_.i,f);else{var A=f.type,U=f.proxy;_.removeEventListener?_.removeEventListener(A,U,f.capture):_.detachEvent?_.detachEvent(tn(A),U):_.addListener&&_.removeListener&&_.removeListener(U),(A=rn(_))?(z(A,f),A.h==0&&(A.src=null,_[He]=null)):_e(f)}}}function tn(f){return f in nt?nt[f]:nt[f]="on"+f}function Ms(f,_){if(f.da)f=!0;else{_=new G(_,this);var A=f.listener,U=f.ha||f.src;f.fa&&Ar(f),f=A.call(U,_)}return f}function rn(f){return f=f[He],f instanceof $e?f:null}var kt="__closure_events_fn_"+(1e9*Math.random()>>>0);function lr(f){return typeof f=="function"?f:(f[kt]||(f[kt]=function(_){return f.handleEvent(_)}),f[kt])}function vt(){B.call(this),this.i=new $e(this),this.M=this,this.F=null}x(vt,B),vt.prototype[xe]=!0,vt.prototype.removeEventListener=function(f,_,A,U){or(this,f,_,A,U)};function St(f,_){var A,U=f.F;if(U)for(A=[];U;U=U.F)A.push(U);if(f=f.M,U=_.type||_,typeof _=="string")_=new K(_,f);else if(_ instanceof K)_.target=_.target||f;else{var re=_;_=new K(U,f),R(_,re)}if(re=!0,A)for(var ae=A.length-1;0<=ae;ae--){var ke=_.g=A[ae];re=ht(ke,U,!0,_)&&re}if(ke=_.g=f,re=ht(ke,U,!0,_)&&re,re=ht(ke,U,!1,_)&&re,A)for(ae=0;ae<A.length;ae++)ke=_.g=A[ae],re=ht(ke,U,!1,_)&&re}vt.prototype.N=function(){if(vt.aa.N.call(this),this.i){var f=this.i,_;for(_ in f.g){for(var A=f.g[_],U=0;U<A.length;U++)_e(A[U]);delete f.g[_],f.h--}}this.F=null},vt.prototype.K=function(f,_,A,U){return this.i.add(String(f),_,!1,A,U)},vt.prototype.L=function(f,_,A,U){return this.i.add(String(f),_,!0,A,U)};function ht(f,_,A,U){if(_=f.i.g[String(_)],!_)return!0;_=_.concat();for(var re=!0,ae=0;ae<_.length;++ae){var ke=_[ae];if(ke&&!ke.da&&ke.capture==A){var yt=ke.listener,pr=ke.ha||ke.src;ke.fa&&z(f.i,ke),re=yt.call(pr,U)!==!1&&re}}return re&&!U.defaultPrevented}function Dt(f,_,A){if(typeof f=="function")A&&(f=m(f,A));else if(f&&typeof f.handleEvent=="function")f=m(f.handleEvent,f);else throw Error("Invalid listener argument");return 2147483647<Number(_)?-1:o.setTimeout(f,_||0)}function je(f){f.g=Dt(()=>{f.g=null,f.i&&(f.i=!1,je(f))},f.l);const _=f.h;f.h=null,f.m.apply(null,_)}class xt extends B{constructor(_,A){super(),this.m=_,this.l=A,this.h=null,this.i=!1,this.g=null}j(_){this.h=arguments,this.g?this.i=!0:je(this)}N(){super.N(),this.g&&(o.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Gt(f){B.call(this),this.h=f,this.g={}}x(Gt,B);var ut=[];function pn(f){L(f.g,function(_,A){this.g.hasOwnProperty(A)&&Ar(_)},f),f.g={}}Gt.prototype.N=function(){Gt.aa.N.call(this),pn(this)},Gt.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Ls=o.JSON.stringify,co=o.JSON.parse,Il=class{stringify(f){return o.JSON.stringify(f,void 0)}parse(f){return o.JSON.parse(f,void 0)}};function js(){}js.prototype.h=null;function hs(f){return f.h||(f.h=f.i())}function wa(){}var Hn={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function Vs(){K.call(this,"d")}x(Vs,K);function ds(){K.call(this,"c")}x(ds,K);var Rn={},uo=null;function Us(){return uo=uo||new vt}Rn.La="serverreachability";function Bs(f){K.call(this,Rn.La,f)}x(Bs,K);function Nn(f){const _=Us();St(_,new Bs(_))}Rn.STAT_EVENT="statevent";function fo(f,_){K.call(this,Rn.STAT_EVENT,f),this.stat=_}x(fo,K);function er(f){const _=Us();St(_,new fo(_,f))}Rn.Ma="timingevent";function X(f,_){K.call(this,Rn.Ma,f),this.size=_}x(X,K);function J(f,_){if(typeof f!="function")throw Error("Fn must not be null and must be a function");return o.setTimeout(function(){f()},_)}function ne(){this.g=!0}ne.prototype.xa=function(){this.g=!1};function me(f,_,A,U,re,ae){f.info(function(){if(f.g)if(ae)for(var ke="",yt=ae.split("&"),pr=0;pr<yt.length;pr++){var lt=yt[pr].split("=");if(1<lt.length){var Ir=lt[0];lt=lt[1];var Cr=Ir.split("_");ke=2<=Cr.length&&Cr[1]=="type"?ke+(Ir+"="+lt+"&"):ke+(Ir+"=redacted&")}}else ke=null;else ke=ae;return"XMLHTTP REQ ("+U+") [attempt "+re+"]: "+_+`
`+A+`
`+ke})}function Se(f,_,A,U,re,ae,ke){f.info(function(){return"XMLHTTP RESP ("+U+") [ attempt "+re+"]: "+_+`
`+A+`
`+ae+" "+ke})}function I(f,_,A,U){f.info(function(){return"XMLHTTP TEXT ("+_+"): "+D(f,A)+(U?" "+U:"")})}function V(f,_){f.info(function(){return"TIMEOUT: "+_})}ne.prototype.info=function(){};function D(f,_){if(!f.g)return _;if(!_)return null;try{var A=JSON.parse(_);if(A){for(f=0;f<A.length;f++)if(Array.isArray(A[f])){var U=A[f];if(!(2>U.length)){var re=U[1];if(Array.isArray(re)&&!(1>re.length)){var ae=re[0];if(ae!="noop"&&ae!="stop"&&ae!="close")for(var ke=1;ke<re.length;ke++)re[ke]=""}}}}return Ls(A)}catch{return _}}var F={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},M={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},j;function Y(){}x(Y,js),Y.prototype.g=function(){return new XMLHttpRequest},Y.prototype.i=function(){return{}},j=new Y;function te(f,_,A,U){this.j=f,this.i=_,this.l=A,this.R=U||1,this.U=new Gt(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new ee}function ee(){this.i=null,this.g="",this.h=!1}var Z={},Q={};function ue(f,_,A){f.L=1,f.v=Gu(zs(_)),f.m=A,f.P=!0,we(f,null)}function we(f,_){f.F=Date.now(),Ee(f),f.A=zs(f.v);var A=f.A,U=f.R;Array.isArray(U)||(U=[String(U)]),Sx(A.i,"t",U),f.C=0,A=f.j.J,f.h=new ee,f.g=$x(f.j,A?_:null,!f.m),0<f.O&&(f.M=new xt(m(f.Y,f,f.g),f.O)),_=f.U,A=f.g,U=f.ca;var re="readystatechange";Array.isArray(re)||(re&&(ut[0]=re.toString()),re=ut);for(var ae=0;ae<re.length;ae++){var ke=Fe(A,re[ae],U||_.handleEvent,!1,_.h||_);if(!ke)break;_.g[ke.key]=ke}_=f.H?y(f.H):{},f.m?(f.u||(f.u="POST"),_["Content-Type"]="application/x-www-form-urlencoded",f.g.ea(f.A,f.u,f.m,_)):(f.u="GET",f.g.ea(f.A,f.u,null,_)),Nn(),me(f.i,f.u,f.A,f.l,f.R,f.m)}te.prototype.ca=function(f){f=f.target;const _=this.M;_&&$s(f)==3?_.j():this.Y(f)},te.prototype.Y=function(f){try{if(f==this.g)e:{const Cr=$s(this.g);var _=this.g.Ba();const po=this.g.Z();if(!(3>Cr)&&(Cr!=3||this.g&&(this.h.h||this.g.oa()||Px(this.g)))){this.J||Cr!=4||_==7||(_==8||0>=po?Nn(3):Nn(2)),st(this);var A=this.g.Z();this.X=A;t:if(Ie(this)){var U=Px(this.g);f="";var re=U.length,ae=$s(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){dt(this),Ke(this);var ke="";break t}this.h.i=new o.TextDecoder}for(_=0;_<re;_++)this.h.h=!0,f+=this.h.i.decode(U[_],{stream:!(ae&&_==re-1)});U.length=0,this.h.g+=f,this.C=0,ke=this.h.g}else ke=this.g.oa();if(this.o=A==200,Se(this.i,this.u,this.A,this.l,this.R,Cr,A),this.o){if(this.T&&!this.K){t:{if(this.g){var yt,pr=this.g;if((yt=pr.g?pr.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!T(yt)){var lt=yt;break t}}lt=null}if(A=lt)I(this.i,this.l,A,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,nn(this,A);else{this.o=!1,this.s=3,er(12),dt(this),Ke(this);break e}}if(this.P){A=!0;let Gn;for(;!this.J&&this.C<ke.length;)if(Gn=pe(this,ke),Gn==Q){Cr==4&&(this.s=4,er(14),A=!1),I(this.i,this.l,null,"[Incomplete Response]");break}else if(Gn==Z){this.s=4,er(15),I(this.i,this.l,ke,"[Invalid Chunk]"),A=!1;break}else I(this.i,this.l,Gn,null),nn(this,Gn);if(Ie(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Cr!=4||ke.length!=0||this.h.h||(this.s=1,er(16),A=!1),this.o=this.o&&A,!A)I(this.i,this.l,ke,"[Invalid Chunked Response]"),dt(this),Ke(this);else if(0<ke.length&&!this.W){this.W=!0;var Ir=this.j;Ir.g==this&&Ir.ba&&!Ir.M&&(Ir.j.info("Great, no buffering proxy detected. Bytes received: "+ke.length),l0(Ir),Ir.M=!0,er(11))}}else I(this.i,this.l,ke,null),nn(this,ke);Cr==4&&dt(this),this.o&&!this.J&&(Cr==4?Vx(this.j,this):(this.o=!1,Ee(this)))}else qI(this.g),A==400&&0<ke.indexOf("Unknown SID")?(this.s=3,er(12)):(this.s=0,er(13)),dt(this),Ke(this)}}}catch{}finally{}};function Ie(f){return f.g?f.u=="GET"&&f.L!=2&&f.j.Ca:!1}function pe(f,_){var A=f.C,U=_.indexOf(`
`,A);return U==-1?Q:(A=Number(_.substring(A,U)),isNaN(A)?Z:(U+=1,U+A>_.length?Q:(_=_.slice(U,U+A),f.C=U+A,_)))}te.prototype.cancel=function(){this.J=!0,dt(this)};function Ee(f){f.S=Date.now()+f.I,De(f,f.I)}function De(f,_){if(f.B!=null)throw Error("WatchDog timer not null");f.B=J(m(f.ba,f),_)}function st(f){f.B&&(o.clearTimeout(f.B),f.B=null)}te.prototype.ba=function(){this.B=null;const f=Date.now();0<=f-this.S?(V(this.i,this.A),this.L!=2&&(Nn(),er(17)),dt(this),this.s=2,Ke(this)):De(this,this.S-f)};function Ke(f){f.j.G==0||f.J||Vx(f.j,f)}function dt(f){st(f);var _=f.M;_&&typeof _.ma=="function"&&_.ma(),f.M=null,pn(f.U),f.g&&(_=f.g,f.g=null,_.abort(),_.ma())}function nn(f,_){try{var A=f.j;if(A.G!=0&&(A.g==f||Je(A.h,f))){if(!f.K&&Je(A.h,f)&&A.G==3){try{var U=A.Da.g.parse(_)}catch{U=null}if(Array.isArray(U)&&U.length==3){var re=U;if(re[0]==0){e:if(!A.u){if(A.g)if(A.g.F+3e3<f.F)Ju(A),Yu(A);else break e;o0(A),er(18)}}else A.za=re[1],0<A.za-A.T&&37500>re[2]&&A.F&&A.v==0&&!A.C&&(A.C=J(m(A.Za,A),6e3));if(1>=bn(A.h)&&A.ca){try{A.ca()}catch{}A.ca=void 0}}else xi(A,11)}else if((f.K||A.g==f)&&Ju(A),!T(_))for(re=A.Da.g.parse(_),_=0;_<re.length;_++){let lt=re[_];if(A.T=lt[0],lt=lt[1],A.G==2)if(lt[0]=="c"){A.K=lt[1],A.ia=lt[2];const Ir=lt[3];Ir!=null&&(A.la=Ir,A.j.info("VER="+A.la));const Cr=lt[4];Cr!=null&&(A.Aa=Cr,A.j.info("SVER="+A.Aa));const po=lt[5];po!=null&&typeof po=="number"&&0<po&&(U=1.5*po,A.L=U,A.j.info("backChannelRequestTimeoutMs_="+U)),U=A;const Gn=f.g;if(Gn){const ef=Gn.g?Gn.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(ef){var ae=U.h;ae.g||ef.indexOf("spdy")==-1&&ef.indexOf("quic")==-1&&ef.indexOf("h2")==-1||(ae.j=ae.l,ae.g=new Set,ae.h&&(ms(ae,ae.h),ae.h=null))}if(U.D){const c0=Gn.g?Gn.g.getResponseHeader("X-HTTP-Session-Id"):null;c0&&(U.ya=c0,At(U.I,U.D,c0))}}A.G=3,A.l&&A.l.ua(),A.ba&&(A.R=Date.now()-f.F,A.j.info("Handshake RTT: "+A.R+"ms")),U=A;var ke=f;if(U.qa=zx(U,U.J?U.ia:null,U.W),ke.K){Cl(U.h,ke);var yt=ke,pr=U.L;pr&&(yt.I=pr),yt.B&&(st(yt),Ee(yt)),U.g=ke}else Lx(U);0<A.i.length&&Qu(A)}else lt[0]!="stop"&&lt[0]!="close"||xi(A,7);else A.G==3&&(lt[0]=="stop"||lt[0]=="close"?lt[0]=="stop"?xi(A,7):i0(A):lt[0]!="noop"&&A.l&&A.l.ta(lt),A.v=0)}}Nn(4)}catch{}}var We=class{constructor(f,_){this.g=f,this.map=_}};function ft(f){this.l=f||10,o.PerformanceNavigationTiming?(f=o.performance.getEntriesByType("navigation"),f=0<f.length&&(f[0].nextHopProtocol=="hq"||f[0].nextHopProtocol=="h2")):f=!!(o.chrome&&o.chrome.loadTimes&&o.chrome.loadTimes()&&o.chrome.loadTimes().wasFetchedViaSpdy),this.j=f?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function mr(f){return f.h?!0:f.g?f.g.size>=f.j:!1}function bn(f){return f.h?1:f.g?f.g.size:0}function Je(f,_){return f.h?f.h==_:f.g?f.g.has(_):!1}function ms(f,_){f.g?f.g.add(_):f.h=_}function Cl(f,_){f.h&&f.h==_?f.h=null:f.g&&f.g.has(_)&&f.g.delete(_)}ft.prototype.cancel=function(){if(this.i=$u(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const f of this.g.values())f.cancel();this.g.clear()}};function $u(f){if(f.h!=null)return f.i.concat(f.h.D);if(f.g!=null&&f.g.size!==0){let _=f.i;for(const A of f.g.values())_=_.concat(A.D);return _}return v(f.i)}function DI(f){if(f.V&&typeof f.V=="function")return f.V();if(typeof Map<"u"&&f instanceof Map||typeof Set<"u"&&f instanceof Set)return Array.from(f.values());if(typeof f=="string")return f.split("");if(l(f)){for(var _=[],A=f.length,U=0;U<A;U++)_.push(f[U]);return _}_=[],A=0;for(U in f)_[A++]=f[U];return _}function FI(f){if(f.na&&typeof f.na=="function")return f.na();if(!f.V||typeof f.V!="function"){if(typeof Map<"u"&&f instanceof Map)return Array.from(f.keys());if(!(typeof Set<"u"&&f instanceof Set)){if(l(f)||typeof f=="string"){var _=[];f=f.length;for(var A=0;A<f;A++)_.push(A);return _}_=[],A=0;for(const U in f)_[A++]=U;return _}}}function _x(f,_){if(f.forEach&&typeof f.forEach=="function")f.forEach(_,void 0);else if(l(f)||typeof f=="string")Array.prototype.forEach.call(f,_,void 0);else for(var A=FI(f),U=DI(f),re=U.length,ae=0;ae<re;ae++)_.call(void 0,U[ae],A&&A[ae],f)}var yx=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function OI(f,_){if(f){f=f.split("&");for(var A=0;A<f.length;A++){var U=f[A].indexOf("="),re=null;if(0<=U){var ae=f[A].substring(0,U);re=f[A].substring(U+1)}else ae=f[A];_(ae,re?decodeURIComponent(re.replace(/\+/g," ")):"")}}}function vi(f){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,f instanceof vi){this.h=f.h,Wu(this,f.j),this.o=f.o,this.g=f.g,Hu(this,f.s),this.l=f.l;var _=f.i,A=new bl;A.i=_.i,_.g&&(A.g=new Map(_.g),A.h=_.h),wx(this,A),this.m=f.m}else f&&(_=String(f).match(yx))?(this.h=!1,Wu(this,_[1]||"",!0),this.o=Rl(_[2]||""),this.g=Rl(_[3]||"",!0),Hu(this,_[4]),this.l=Rl(_[5]||"",!0),wx(this,_[6]||"",!0),this.m=Rl(_[7]||"")):(this.h=!1,this.i=new bl(null,this.h))}vi.prototype.toString=function(){var f=[],_=this.j;_&&f.push(Nl(_,Ex,!0),":");var A=this.g;return(A||_=="file")&&(f.push("//"),(_=this.o)&&f.push(Nl(_,Ex,!0),"@"),f.push(encodeURIComponent(String(A)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),A=this.s,A!=null&&f.push(":",String(A))),(A=this.l)&&(this.g&&A.charAt(0)!="/"&&f.push("/"),f.push(Nl(A,A.charAt(0)=="/"?jI:LI,!0))),(A=this.i.toString())&&f.push("?",A),(A=this.m)&&f.push("#",Nl(A,UI)),f.join("")};function zs(f){return new vi(f)}function Wu(f,_,A){f.j=A?Rl(_,!0):_,f.j&&(f.j=f.j.replace(/:$/,""))}function Hu(f,_){if(_){if(_=Number(_),isNaN(_)||0>_)throw Error("Bad port number "+_);f.s=_}else f.s=null}function wx(f,_,A){_ instanceof bl?(f.i=_,BI(f.i,f.h)):(A||(_=Nl(_,VI)),f.i=new bl(_,f.h))}function At(f,_,A){f.i.set(_,A)}function Gu(f){return At(f,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),f}function Rl(f,_){return f?_?decodeURI(f.replace(/%25/g,"%2525")):decodeURIComponent(f):""}function Nl(f,_,A){return typeof f=="string"?(f=encodeURI(f).replace(_,MI),A&&(f=f.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),f):null}function MI(f){return f=f.charCodeAt(0),"%"+(f>>4&15).toString(16)+(f&15).toString(16)}var Ex=/[#\/\?@]/g,LI=/[#\?:]/g,jI=/[#\?]/g,VI=/[#\?@]/g,UI=/#/g;function bl(f,_){this.h=this.g=null,this.i=f||null,this.j=!!_}function Ea(f){f.g||(f.g=new Map,f.h=0,f.i&&OI(f.i,function(_,A){f.add(decodeURIComponent(_.replace(/\+/g," ")),A)}))}e=bl.prototype,e.add=function(f,_){Ea(this),this.i=null,f=ho(this,f);var A=this.g.get(f);return A||this.g.set(f,A=[]),A.push(_),this.h+=1,this};function Tx(f,_){Ea(f),_=ho(f,_),f.g.has(_)&&(f.i=null,f.h-=f.g.get(_).length,f.g.delete(_))}function kx(f,_){return Ea(f),_=ho(f,_),f.g.has(_)}e.forEach=function(f,_){Ea(this),this.g.forEach(function(A,U){A.forEach(function(re){f.call(_,re,U,this)},this)},this)},e.na=function(){Ea(this);const f=Array.from(this.g.values()),_=Array.from(this.g.keys()),A=[];for(let U=0;U<_.length;U++){const re=f[U];for(let ae=0;ae<re.length;ae++)A.push(_[U])}return A},e.V=function(f){Ea(this);let _=[];if(typeof f=="string")kx(this,f)&&(_=_.concat(this.g.get(ho(this,f))));else{f=Array.from(this.g.values());for(let A=0;A<f.length;A++)_=_.concat(f[A])}return _},e.set=function(f,_){return Ea(this),this.i=null,f=ho(this,f),kx(this,f)&&(this.h-=this.g.get(f).length),this.g.set(f,[_]),this.h+=1,this},e.get=function(f,_){return f?(f=this.V(f),0<f.length?String(f[0]):_):_};function Sx(f,_,A){Tx(f,_),0<A.length&&(f.i=null,f.g.set(ho(f,_),v(A)),f.h+=A.length)}e.toString=function(){if(this.i)return this.i;if(!this.g)return"";const f=[],_=Array.from(this.g.keys());for(var A=0;A<_.length;A++){var U=_[A];const ae=encodeURIComponent(String(U)),ke=this.V(U);for(U=0;U<ke.length;U++){var re=ae;ke[U]!==""&&(re+="="+encodeURIComponent(String(ke[U]))),f.push(re)}}return this.i=f.join("&")};function ho(f,_){return _=String(_),f.j&&(_=_.toLowerCase()),_}function BI(f,_){_&&!f.j&&(Ea(f),f.i=null,f.g.forEach(function(A,U){var re=U.toLowerCase();U!=re&&(Tx(this,U),Sx(this,re,A))},f)),f.j=_}function zI(f,_){const A=new ne;if(o.Image){const U=new Image;U.onload=p(Ta,A,"TestLoadImage: loaded",!0,_,U),U.onerror=p(Ta,A,"TestLoadImage: error",!1,_,U),U.onabort=p(Ta,A,"TestLoadImage: abort",!1,_,U),U.ontimeout=p(Ta,A,"TestLoadImage: timeout",!1,_,U),o.setTimeout(function(){U.ontimeout&&U.ontimeout()},1e4),U.src=f}else _(!1)}function $I(f,_){const A=new ne,U=new AbortController,re=setTimeout(()=>{U.abort(),Ta(A,"TestPingServer: timeout",!1,_)},1e4);fetch(f,{signal:U.signal}).then(ae=>{clearTimeout(re),ae.ok?Ta(A,"TestPingServer: ok",!0,_):Ta(A,"TestPingServer: server error",!1,_)}).catch(()=>{clearTimeout(re),Ta(A,"TestPingServer: error",!1,_)})}function Ta(f,_,A,U,re){try{re&&(re.onload=null,re.onerror=null,re.onabort=null,re.ontimeout=null),U(A)}catch{}}function WI(){this.g=new Il}function HI(f,_,A){const U=A||"";try{_x(f,function(re,ae){let ke=re;c(re)&&(ke=Ls(re)),_.push(U+ae+"="+encodeURIComponent(ke))})}catch(re){throw _.push(U+"type="+encodeURIComponent("_badmap")),re}}function Ku(f){this.l=f.Ub||null,this.j=f.eb||!1}x(Ku,js),Ku.prototype.g=function(){return new qu(this.l,this.j)},Ku.prototype.i=function(f){return function(){return f}}({});function qu(f,_){vt.call(this),this.D=f,this.o=_,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}x(qu,vt),e=qu.prototype,e.open=function(f,_){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=f,this.A=_,this.readyState=1,Dl(this)},e.send=function(f){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const _={headers:this.u,method:this.B,credentials:this.m,cache:void 0};f&&(_.body=f),(this.D||o).fetch(new Request(this.A,_)).then(this.Sa.bind(this),this.ga.bind(this))},e.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,Pl(this)),this.readyState=0},e.Sa=function(f){if(this.g&&(this.l=f,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=f.headers,this.readyState=2,Dl(this)),this.g&&(this.readyState=3,Dl(this),this.g)))if(this.responseType==="arraybuffer")f.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof o.ReadableStream<"u"&&"body"in f){if(this.j=f.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;Ax(this)}else f.text().then(this.Ra.bind(this),this.ga.bind(this))};function Ax(f){f.j.read().then(f.Pa.bind(f)).catch(f.ga.bind(f))}e.Pa=function(f){if(this.g){if(this.o&&f.value)this.response.push(f.value);else if(!this.o){var _=f.value?f.value:new Uint8Array(0);(_=this.v.decode(_,{stream:!f.done}))&&(this.response=this.responseText+=_)}f.done?Pl(this):Dl(this),this.readyState==3&&Ax(this)}},e.Ra=function(f){this.g&&(this.response=this.responseText=f,Pl(this))},e.Qa=function(f){this.g&&(this.response=f,Pl(this))},e.ga=function(){this.g&&Pl(this)};function Pl(f){f.readyState=4,f.l=null,f.j=null,f.v=null,Dl(f)}e.setRequestHeader=function(f,_){this.u.append(f,_)},e.getResponseHeader=function(f){return this.h&&this.h.get(f.toLowerCase())||""},e.getAllResponseHeaders=function(){if(!this.h)return"";const f=[],_=this.h.entries();for(var A=_.next();!A.done;)A=A.value,f.push(A[0]+": "+A[1]),A=_.next();return f.join(`\r
`)};function Dl(f){f.onreadystatechange&&f.onreadystatechange.call(f)}Object.defineProperty(qu.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(f){this.m=f?"include":"same-origin"}});function Ix(f){let _="";return L(f,function(A,U){_+=U,_+=":",_+=A,_+=`\r
`}),_}function a0(f,_,A){e:{for(U in A){var U=!1;break e}U=!0}U||(A=Ix(A),typeof f=="string"?A!=null&&encodeURIComponent(String(A)):At(f,_,A))}function jt(f){vt.call(this),this.headers=new Map,this.o=f||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}x(jt,vt);var GI=/^https?$/i,KI=["POST","PUT"];e=jt.prototype,e.Ha=function(f){this.J=f},e.ea=function(f,_,A,U){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+f);_=_?_.toUpperCase():"GET",this.D=f,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():j.g(),this.v=this.o?hs(this.o):hs(j),this.g.onreadystatechange=m(this.Ea,this);try{this.B=!0,this.g.open(_,String(f),!0),this.B=!1}catch(ae){Cx(this,ae);return}if(f=A||"",A=new Map(this.headers),U)if(Object.getPrototypeOf(U)===Object.prototype)for(var re in U)A.set(re,U[re]);else if(typeof U.keys=="function"&&typeof U.get=="function")for(const ae of U.keys())A.set(ae,U.get(ae));else throw Error("Unknown input type for opt_headers: "+String(U));U=Array.from(A.keys()).find(ae=>ae.toLowerCase()=="content-type"),re=o.FormData&&f instanceof o.FormData,!(0<=Array.prototype.indexOf.call(KI,_,void 0))||U||re||A.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[ae,ke]of A)this.g.setRequestHeader(ae,ke);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{bx(this),this.u=!0,this.g.send(f),this.u=!1}catch(ae){Cx(this,ae)}};function Cx(f,_){f.h=!1,f.g&&(f.j=!0,f.g.abort(),f.j=!1),f.l=_,f.m=5,Rx(f),Xu(f)}function Rx(f){f.A||(f.A=!0,St(f,"complete"),St(f,"error"))}e.abort=function(f){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=f||7,St(this,"complete"),St(this,"abort"),Xu(this))},e.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Xu(this,!0)),jt.aa.N.call(this)},e.Ea=function(){this.s||(this.B||this.u||this.j?Nx(this):this.bb())},e.bb=function(){Nx(this)};function Nx(f){if(f.h&&typeof i<"u"&&(!f.v[1]||$s(f)!=4||f.Z()!=2)){if(f.u&&$s(f)==4)Dt(f.Ea,0,f);else if(St(f,"readystatechange"),$s(f)==4){f.h=!1;try{const ke=f.Z();e:switch(ke){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var _=!0;break e;default:_=!1}var A;if(!(A=_)){var U;if(U=ke===0){var re=String(f.D).match(yx)[1]||null;!re&&o.self&&o.self.location&&(re=o.self.location.protocol.slice(0,-1)),U=!GI.test(re?re.toLowerCase():"")}A=U}if(A)St(f,"complete"),St(f,"success");else{f.m=6;try{var ae=2<$s(f)?f.g.statusText:""}catch{ae=""}f.l=ae+" ["+f.Z()+"]",Rx(f)}}finally{Xu(f)}}}}function Xu(f,_){if(f.g){bx(f);const A=f.g,U=f.v[0]?()=>{}:null;f.g=null,f.v=null,_||St(f,"ready");try{A.onreadystatechange=U}catch{}}}function bx(f){f.I&&(o.clearTimeout(f.I),f.I=null)}e.isActive=function(){return!!this.g};function $s(f){return f.g?f.g.readyState:0}e.Z=function(){try{return 2<$s(this)?this.g.status:-1}catch{return-1}},e.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},e.Oa=function(f){if(this.g){var _=this.g.responseText;return f&&_.indexOf(f)==0&&(_=_.substring(f.length)),co(_)}};function Px(f){try{if(!f.g)return null;if("response"in f.g)return f.g.response;switch(f.H){case"":case"text":return f.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in f.g)return f.g.mozResponseArrayBuffer}return null}catch{return null}}function qI(f){const _={};f=(f.g&&2<=$s(f)&&f.g.getAllResponseHeaders()||"").split(`\r
`);for(let U=0;U<f.length;U++){if(T(f[U]))continue;var A=b(f[U]);const re=A[0];if(A=A[1],typeof A!="string")continue;A=A.trim();const ae=_[re]||[];_[re]=ae,ae.push(A)}g(_,function(U){return U.join(", ")})}e.Ba=function(){return this.m},e.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function Fl(f,_,A){return A&&A.internalChannelParams&&A.internalChannelParams[f]||_}function Dx(f){this.Aa=0,this.i=[],this.j=new ne,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=Fl("failFast",!1,f),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=Fl("baseRetryDelayMs",5e3,f),this.cb=Fl("retryDelaySeedMs",1e4,f),this.Wa=Fl("forwardChannelMaxRetries",2,f),this.wa=Fl("forwardChannelRequestTimeoutMs",2e4,f),this.pa=f&&f.xmlHttpFactory||void 0,this.Xa=f&&f.Tb||void 0,this.Ca=f&&f.useFetchStreams||!1,this.L=void 0,this.J=f&&f.supportsCrossDomainXhr||!1,this.K="",this.h=new ft(f&&f.concurrentRequestLimit),this.Da=new WI,this.P=f&&f.fastHandshake||!1,this.O=f&&f.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=f&&f.Rb||!1,f&&f.xa&&this.j.xa(),f&&f.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&f&&f.detectBufferingProxy||!1,this.ja=void 0,f&&f.longPollingTimeout&&0<f.longPollingTimeout&&(this.ja=f.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}e=Dx.prototype,e.la=8,e.G=1,e.connect=function(f,_,A,U){er(0),this.W=f,this.H=_||{},A&&U!==void 0&&(this.H.OSID=A,this.H.OAID=U),this.F=this.X,this.I=zx(this,null,this.W),Qu(this)};function i0(f){if(Fx(f),f.G==3){var _=f.U++,A=zs(f.I);if(At(A,"SID",f.K),At(A,"RID",_),At(A,"TYPE","terminate"),Ol(f,A),_=new te(f,f.j,_),_.L=2,_.v=Gu(zs(A)),A=!1,o.navigator&&o.navigator.sendBeacon)try{A=o.navigator.sendBeacon(_.v.toString(),"")}catch{}!A&&o.Image&&(new Image().src=_.v,A=!0),A||(_.g=$x(_.j,null),_.g.ea(_.v)),_.F=Date.now(),Ee(_)}Bx(f)}function Yu(f){f.g&&(l0(f),f.g.cancel(),f.g=null)}function Fx(f){Yu(f),f.u&&(o.clearTimeout(f.u),f.u=null),Ju(f),f.h.cancel(),f.s&&(typeof f.s=="number"&&o.clearTimeout(f.s),f.s=null)}function Qu(f){if(!mr(f.h)&&!f.s){f.s=!0;var _=f.Ga;de||ce(),ie||(de(),ie=!0),H.add(_,f),f.B=0}}function XI(f,_){return bn(f.h)>=f.h.j-(f.s?1:0)?!1:f.s?(f.i=_.D.concat(f.i),!0):f.G==1||f.G==2||f.B>=(f.Va?0:f.Wa)?!1:(f.s=J(m(f.Ga,f,_),Ux(f,f.B)),f.B++,!0)}e.Ga=function(f){if(this.s)if(this.s=null,this.G==1){if(!f){this.U=Math.floor(1e5*Math.random()),f=this.U++;const re=new te(this,this.j,f);let ae=this.o;if(this.S&&(ae?(ae=y(ae),R(ae,this.S)):ae=this.S),this.m!==null||this.O||(re.H=ae,ae=null),this.P)e:{for(var _=0,A=0;A<this.i.length;A++){t:{var U=this.i[A];if("__data__"in U.map&&(U=U.map.__data__,typeof U=="string")){U=U.length;break t}U=void 0}if(U===void 0)break;if(_+=U,4096<_){_=A;break e}if(_===4096||A===this.i.length-1){_=A+1;break e}}_=1e3}else _=1e3;_=Mx(this,re,_),A=zs(this.I),At(A,"RID",f),At(A,"CVER",22),this.D&&At(A,"X-HTTP-Session-Id",this.D),Ol(this,A),ae&&(this.O?_="headers="+encodeURIComponent(String(Ix(ae)))+"&"+_:this.m&&a0(A,this.m,ae)),ms(this.h,re),this.Ua&&At(A,"TYPE","init"),this.P?(At(A,"$req",_),At(A,"SID","null"),re.T=!0,ue(re,A,null)):ue(re,A,_),this.G=2}}else this.G==3&&(f?Ox(this,f):this.i.length==0||mr(this.h)||Ox(this))};function Ox(f,_){var A;_?A=_.l:A=f.U++;const U=zs(f.I);At(U,"SID",f.K),At(U,"RID",A),At(U,"AID",f.T),Ol(f,U),f.m&&f.o&&a0(U,f.m,f.o),A=new te(f,f.j,A,f.B+1),f.m===null&&(A.H=f.o),_&&(f.i=_.D.concat(f.i)),_=Mx(f,A,1e3),A.I=Math.round(.5*f.wa)+Math.round(.5*f.wa*Math.random()),ms(f.h,A),ue(A,U,_)}function Ol(f,_){f.H&&L(f.H,function(A,U){At(_,U,A)}),f.l&&_x({},function(A,U){At(_,U,A)})}function Mx(f,_,A){A=Math.min(f.i.length,A);var U=f.l?m(f.l.Na,f.l,f):null;e:{var re=f.i;let ae=-1;for(;;){const ke=["count="+A];ae==-1?0<A?(ae=re[0].g,ke.push("ofs="+ae)):ae=0:ke.push("ofs="+ae);let yt=!0;for(let pr=0;pr<A;pr++){let lt=re[pr].g;const Ir=re[pr].map;if(lt-=ae,0>lt)ae=Math.max(0,re[pr].g-100),yt=!1;else try{HI(Ir,ke,"req"+lt+"_")}catch{U&&U(Ir)}}if(yt){U=ke.join("&");break e}}}return f=f.i.splice(0,A),_.D=f,U}function Lx(f){if(!f.g&&!f.u){f.Y=1;var _=f.Fa;de||ce(),ie||(de(),ie=!0),H.add(_,f),f.v=0}}function o0(f){return f.g||f.u||3<=f.v?!1:(f.Y++,f.u=J(m(f.Fa,f),Ux(f,f.v)),f.v++,!0)}e.Fa=function(){if(this.u=null,jx(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var f=2*this.R;this.j.info("BP detection timer enabled: "+f),this.A=J(m(this.ab,this),f)}},e.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,er(10),Yu(this),jx(this))};function l0(f){f.A!=null&&(o.clearTimeout(f.A),f.A=null)}function jx(f){f.g=new te(f,f.j,"rpc",f.Y),f.m===null&&(f.g.H=f.o),f.g.O=0;var _=zs(f.qa);At(_,"RID","rpc"),At(_,"SID",f.K),At(_,"AID",f.T),At(_,"CI",f.F?"0":"1"),!f.F&&f.ja&&At(_,"TO",f.ja),At(_,"TYPE","xmlhttp"),Ol(f,_),f.m&&f.o&&a0(_,f.m,f.o),f.L&&(f.g.I=f.L);var A=f.g;f=f.ia,A.L=1,A.v=Gu(zs(_)),A.m=null,A.P=!0,we(A,f)}e.Za=function(){this.C!=null&&(this.C=null,Yu(this),o0(this),er(19))};function Ju(f){f.C!=null&&(o.clearTimeout(f.C),f.C=null)}function Vx(f,_){var A=null;if(f.g==_){Ju(f),l0(f),f.g=null;var U=2}else if(Je(f.h,_))A=_.D,Cl(f.h,_),U=1;else return;if(f.G!=0){if(_.o)if(U==1){A=_.m?_.m.length:0,_=Date.now()-_.F;var re=f.B;U=Us(),St(U,new X(U,A)),Qu(f)}else Lx(f);else if(re=_.s,re==3||re==0&&0<_.X||!(U==1&&XI(f,_)||U==2&&o0(f)))switch(A&&0<A.length&&(_=f.h,_.i=_.i.concat(A)),re){case 1:xi(f,5);break;case 4:xi(f,10);break;case 3:xi(f,6);break;default:xi(f,2)}}}function Ux(f,_){let A=f.Ta+Math.floor(Math.random()*f.cb);return f.isActive()||(A*=2),A*_}function xi(f,_){if(f.j.info("Error code "+_),_==2){var A=m(f.fb,f),U=f.Xa;const re=!U;U=new vi(U||"//www.google.com/images/cleardot.gif"),o.location&&o.location.protocol=="http"||Wu(U,"https"),Gu(U),re?zI(U.toString(),A):$I(U.toString(),A)}else er(2);f.G=0,f.l&&f.l.sa(_),Bx(f),Fx(f)}e.fb=function(f){f?(this.j.info("Successfully pinged google.com"),er(2)):(this.j.info("Failed to ping google.com"),er(1))};function Bx(f){if(f.G=0,f.ka=[],f.l){const _=$u(f.h);(_.length!=0||f.i.length!=0)&&(w(f.ka,_),w(f.ka,f.i),f.h.i.length=0,v(f.i),f.i.length=0),f.l.ra()}}function zx(f,_,A){var U=A instanceof vi?zs(A):new vi(A);if(U.g!="")_&&(U.g=_+"."+U.g),Hu(U,U.s);else{var re=o.location;U=re.protocol,_=_?_+"."+re.hostname:re.hostname,re=+re.port;var ae=new vi(null);U&&Wu(ae,U),_&&(ae.g=_),re&&Hu(ae,re),A&&(ae.l=A),U=ae}return A=f.D,_=f.ya,A&&_&&At(U,A,_),At(U,"VER",f.la),Ol(f,U),U}function $x(f,_,A){if(_&&!f.J)throw Error("Can't create secondary domain capable XhrIo object.");return _=f.Ca&&!f.pa?new jt(new Ku({eb:A})):new jt(f.pa),_.Ha(f.J),_}e.isActive=function(){return!!this.l&&this.l.isActive(this)};function Wx(){}e=Wx.prototype,e.ua=function(){},e.ta=function(){},e.sa=function(){},e.ra=function(){},e.isActive=function(){return!0},e.Na=function(){};function Zu(){}Zu.prototype.g=function(f,_){return new gn(f,_)};function gn(f,_){vt.call(this),this.g=new Dx(_),this.l=f,this.h=_&&_.messageUrlParams||null,f=_&&_.messageHeaders||null,_&&_.clientProtocolHeaderRequired&&(f?f["X-Client-Protocol"]="webchannel":f={"X-Client-Protocol":"webchannel"}),this.g.o=f,f=_&&_.initMessageHeaders||null,_&&_.messageContentType&&(f?f["X-WebChannel-Content-Type"]=_.messageContentType:f={"X-WebChannel-Content-Type":_.messageContentType}),_&&_.va&&(f?f["X-WebChannel-Client-Profile"]=_.va:f={"X-WebChannel-Client-Profile":_.va}),this.g.S=f,(f=_&&_.Sb)&&!T(f)&&(this.g.m=f),this.v=_&&_.supportsCrossDomainXhr||!1,this.u=_&&_.sendRawJson||!1,(_=_&&_.httpSessionIdParam)&&!T(_)&&(this.g.D=_,f=this.h,f!==null&&_ in f&&(f=this.h,_ in f&&delete f[_])),this.j=new mo(this)}x(gn,vt),gn.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},gn.prototype.close=function(){i0(this.g)},gn.prototype.o=function(f){var _=this.g;if(typeof f=="string"){var A={};A.__data__=f,f=A}else this.u&&(A={},A.__data__=Ls(f),f=A);_.i.push(new We(_.Ya++,f)),_.G==3&&Qu(_)},gn.prototype.N=function(){this.g.l=null,delete this.j,i0(this.g),delete this.g,gn.aa.N.call(this)};function Hx(f){Vs.call(this),f.__headers__&&(this.headers=f.__headers__,this.statusCode=f.__status__,delete f.__headers__,delete f.__status__);var _=f.__sm__;if(_){e:{for(const A in _){f=A;break e}f=void 0}(this.i=f)&&(f=this.i,_=_!==null&&f in _?_[f]:void 0),this.data=_}else this.data=f}x(Hx,Vs);function Gx(){ds.call(this),this.status=1}x(Gx,ds);function mo(f){this.g=f}x(mo,Wx),mo.prototype.ua=function(){St(this.g,"a")},mo.prototype.ta=function(f){St(this.g,new Hx(f))},mo.prototype.sa=function(f){St(this.g,new Gx)},mo.prototype.ra=function(){St(this.g,"b")},Zu.prototype.createWebChannel=Zu.prototype.g,gn.prototype.send=gn.prototype.o,gn.prototype.open=gn.prototype.m,gn.prototype.close=gn.prototype.close,Sk=function(){return new Zu},kk=function(){return Us()},Tk=Rn,hp={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},F.NO_ERROR=0,F.TIMEOUT=8,F.HTTP_ERROR=6,Jf=F,M.COMPLETE="complete",Ek=M,wa.EventType=Hn,Hn.OPEN="a",Hn.CLOSE="b",Hn.ERROR="c",Hn.MESSAGE="d",vt.prototype.listen=vt.prototype.K,Zl=wa,jt.prototype.listenOnce=jt.prototype.L,jt.prototype.getLastError=jt.prototype.Ka,jt.prototype.getLastErrorCode=jt.prototype.Ba,jt.prototype.getStatus=jt.prototype.Z,jt.prototype.getResponseJson=jt.prototype.Oa,jt.prototype.getResponseText=jt.prototype.oa,jt.prototype.send=jt.prototype.ea,jt.prototype.setWithCredentials=jt.prototype.Ha,wk=jt}).apply(typeof wf<"u"?wf:typeof self<"u"?self:typeof window<"u"?window:{});const Y_="@firebase/firestore";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dr{constructor(t){this.uid=t}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(t){return t.uid===this.uid}}Dr.UNAUTHENTICATED=new Dr(null),Dr.GOOGLE_CREDENTIALS=new Dr("google-credentials-uid"),Dr.FIRST_PARTY=new Dr("first-party-uid"),Dr.MOCK_USER=new Dr("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let wl="10.14.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Hi=new Hg("@firebase/firestore");function Kl(){return Hi.logLevel}function be(e,...t){if(Hi.logLevel<=Ye.DEBUG){const r=t.map(sv);Hi.debug(`Firestore (${wl}): ${e}`,...r)}}function da(e,...t){if(Hi.logLevel<=Ye.ERROR){const r=t.map(sv);Hi.error(`Firestore (${wl}): ${e}`,...r)}}function il(e,...t){if(Hi.logLevel<=Ye.WARN){const r=t.map(sv);Hi.warn(`Firestore (${wl}): ${e}`,...r)}}function sv(e){if(typeof e=="string")return e;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(r){return JSON.stringify(r)}(e)}catch{return e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Le(e="Unexpected state"){const t=`FIRESTORE (${wl}) INTERNAL ASSERTION FAILED: `+e;throw da(t),new Error(t)}function gt(e,t){e||Le()}function Be(e,t){return e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fe={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Ne extends Ps{constructor(t,r){super(t,r),this.code=t,this.message=r,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ta{constructor(){this.promise=new Promise((t,r)=>{this.resolve=t,this.reject=r})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ak{constructor(t,r){this.user=r,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${t}`)}}class M3{getToken(){return Promise.resolve(null)}invalidateToken(){}start(t,r){t.enqueueRetryable(()=>r(Dr.UNAUTHENTICATED))}shutdown(){}}class L3{constructor(t){this.token=t,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(t,r){this.changeListener=r,t.enqueueRetryable(()=>r(this.token.user))}shutdown(){this.changeListener=null}}class j3{constructor(t){this.t=t,this.currentUser=Dr.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(t,r){gt(this.o===void 0);let n=this.i;const s=l=>this.i!==n?(n=this.i,r(l)):Promise.resolve();let a=new ta;this.o=()=>{this.i++,this.currentUser=this.u(),a.resolve(),a=new ta,t.enqueueRetryable(()=>s(this.currentUser))};const i=()=>{const l=a;t.enqueueRetryable(async()=>{await l.promise,await s(this.currentUser)})},o=l=>{be("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=l,this.o&&(this.auth.addAuthTokenListener(this.o),i())};this.t.onInit(l=>o(l)),setTimeout(()=>{if(!this.auth){const l=this.t.getImmediate({optional:!0});l?o(l):(be("FirebaseAuthCredentialsProvider","Auth not yet detected"),a.resolve(),a=new ta)}},0),i()}getToken(){const t=this.i,r=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(r).then(n=>this.i!==t?(be("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):n?(gt(typeof n.accessToken=="string"),new Ak(n.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const t=this.auth&&this.auth.getUid();return gt(t===null||typeof t=="string"),new Dr(t)}}class V3{constructor(t,r,n){this.l=t,this.h=r,this.P=n,this.type="FirstParty",this.user=Dr.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);const t=this.T();return t&&this.I.set("Authorization",t),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}}class U3{constructor(t,r,n){this.l=t,this.h=r,this.P=n}getToken(){return Promise.resolve(new V3(this.l,this.h,this.P))}start(t,r){t.enqueueRetryable(()=>r(Dr.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class B3{constructor(t){this.value=t,this.type="AppCheck",this.headers=new Map,t&&t.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class z3{constructor(t){this.A=t,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(t,r){gt(this.o===void 0);const n=a=>{a.error!=null&&be("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${a.error.message}`);const i=a.token!==this.R;return this.R=a.token,be("FirebaseAppCheckTokenProvider",`Received ${i?"new":"existing"} token.`),i?r(a.token):Promise.resolve()};this.o=a=>{t.enqueueRetryable(()=>n(a))};const s=a=>{be("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=a,this.o&&this.appCheck.addTokenListener(this.o)};this.A.onInit(a=>s(a)),setTimeout(()=>{if(!this.appCheck){const a=this.A.getImmediate({optional:!0});a?s(a):be("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const t=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(t).then(r=>r?(gt(typeof r.token=="string"),this.R=r.token,new B3(r.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $3(e){const t=typeof self<"u"&&(self.crypto||self.msCrypto),r=new Uint8Array(e);if(t&&typeof t.getRandomValues=="function")t.getRandomValues(r);else for(let n=0;n<e;n++)r[n]=Math.floor(256*Math.random());return r}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ik{static newId(){const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",r=Math.floor(256/t.length)*t.length;let n="";for(;n.length<20;){const s=$3(40);for(let a=0;a<s.length;++a)n.length<20&&s[a]<r&&(n+=t.charAt(s[a]%t.length))}return n}}function ct(e,t){return e<t?-1:e>t?1:0}function ol(e,t,r){return e.length===t.length&&e.every((n,s)=>r(n,t[s]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ar{constructor(t,r){if(this.seconds=t,this.nanoseconds=r,r<0)throw new Ne(fe.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+r);if(r>=1e9)throw new Ne(fe.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+r);if(t<-62135596800)throw new Ne(fe.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(t>=253402300800)throw new Ne(fe.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}static now(){return ar.fromMillis(Date.now())}static fromDate(t){return ar.fromMillis(t.getTime())}static fromMillis(t){const r=Math.floor(t/1e3),n=Math.floor(1e6*(t-1e3*r));return new ar(r,n)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(t){return this.seconds===t.seconds?ct(this.nanoseconds,t.nanoseconds):ct(this.seconds,t.seconds)}isEqual(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const t=this.seconds- -62135596800;return String(t).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ve{constructor(t){this.timestamp=t}static fromTimestamp(t){return new Ve(t)}static min(){return new Ve(new ar(0,0))}static max(){return new Ve(new ar(253402300799,999999999))}compareTo(t){return this.timestamp._compareTo(t.timestamp)}isEqual(t){return this.timestamp.isEqual(t.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jc{constructor(t,r,n){r===void 0?r=0:r>t.length&&Le(),n===void 0?n=t.length-r:n>t.length-r&&Le(),this.segments=t,this.offset=r,this.len=n}get length(){return this.len}isEqual(t){return Jc.comparator(this,t)===0}child(t){const r=this.segments.slice(this.offset,this.limit());return t instanceof Jc?t.forEach(n=>{r.push(n)}):r.push(t),this.construct(r)}limit(){return this.offset+this.length}popFirst(t){return t=t===void 0?1:t,this.construct(this.segments,this.offset+t,this.length-t)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(t){return this.segments[this.offset+t]}isEmpty(){return this.length===0}isPrefixOf(t){if(t.length<this.length)return!1;for(let r=0;r<this.length;r++)if(this.get(r)!==t.get(r))return!1;return!0}isImmediateParentOf(t){if(this.length+1!==t.length)return!1;for(let r=0;r<this.length;r++)if(this.get(r)!==t.get(r))return!1;return!0}forEach(t){for(let r=this.offset,n=this.limit();r<n;r++)t(this.segments[r])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(t,r){const n=Math.min(t.length,r.length);for(let s=0;s<n;s++){const a=t.get(s),i=r.get(s);if(a<i)return-1;if(a>i)return 1}return t.length<r.length?-1:t.length>r.length?1:0}}class Ct extends Jc{construct(t,r,n){return new Ct(t,r,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...t){const r=[];for(const n of t){if(n.indexOf("//")>=0)throw new Ne(fe.INVALID_ARGUMENT,`Invalid segment (${n}). Paths must not contain // in them.`);r.push(...n.split("/").filter(s=>s.length>0))}return new Ct(r)}static emptyPath(){return new Ct([])}}const W3=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class _r extends Jc{construct(t,r,n){return new _r(t,r,n)}static isValidIdentifier(t){return W3.test(t)}canonicalString(){return this.toArray().map(t=>(t=t.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),_r.isValidIdentifier(t)||(t="`"+t+"`"),t)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new _r(["__name__"])}static fromServerFormat(t){const r=[];let n="",s=0;const a=()=>{if(n.length===0)throw new Ne(fe.INVALID_ARGUMENT,`Invalid field path (${t}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);r.push(n),n=""};let i=!1;for(;s<t.length;){const o=t[s];if(o==="\\"){if(s+1===t.length)throw new Ne(fe.INVALID_ARGUMENT,"Path has trailing escape character: "+t);const l=t[s+1];if(l!=="\\"&&l!=="."&&l!=="`")throw new Ne(fe.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);n+=l,s+=2}else o==="`"?(i=!i,s++):o!=="."||i?(n+=o,s++):(a(),s++)}if(a(),i)throw new Ne(fe.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new _r(r)}static emptyPath(){return new _r([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pe{constructor(t){this.path=t}static fromPath(t){return new Pe(Ct.fromString(t))}static fromName(t){return new Pe(Ct.fromString(t).popFirst(5))}static empty(){return new Pe(Ct.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(t){return this.path.length>=2&&this.path.get(this.path.length-2)===t}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(t){return t!==null&&Ct.comparator(this.path,t.path)===0}toString(){return this.path.toString()}static comparator(t,r){return Ct.comparator(t.path,r.path)}static isDocumentKey(t){return t.length%2==0}static fromSegments(t){return new Pe(new Ct(t.slice()))}}function H3(e,t){const r=e.toTimestamp().seconds,n=e.toTimestamp().nanoseconds+1,s=Ve.fromTimestamp(n===1e9?new ar(r+1,0):new ar(r,n));return new si(s,Pe.empty(),t)}function G3(e){return new si(e.readTime,e.key,-1)}class si{constructor(t,r,n){this.readTime=t,this.documentKey=r,this.largestBatchId=n}static min(){return new si(Ve.min(),Pe.empty(),-1)}static max(){return new si(Ve.max(),Pe.empty(),-1)}}function K3(e,t){let r=e.readTime.compareTo(t.readTime);return r!==0?r:(r=Pe.comparator(e.documentKey,t.documentKey),r!==0?r:ct(e.largestBatchId,t.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const q3="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class X3{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(t){this.onCommittedListeners.push(t)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(t=>t())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Iu(e){if(e.code!==fe.FAILED_PRECONDITION||e.message!==q3)throw e;be("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ge{constructor(t){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,t(r=>{this.isDone=!0,this.result=r,this.nextCallback&&this.nextCallback(r)},r=>{this.isDone=!0,this.error=r,this.catchCallback&&this.catchCallback(r)})}catch(t){return this.next(void 0,t)}next(t,r){return this.callbackAttached&&Le(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(r,this.error):this.wrapSuccess(t,this.result):new ge((n,s)=>{this.nextCallback=a=>{this.wrapSuccess(t,a).next(n,s)},this.catchCallback=a=>{this.wrapFailure(r,a).next(n,s)}})}toPromise(){return new Promise((t,r)=>{this.next(t,r)})}wrapUserFunction(t){try{const r=t();return r instanceof ge?r:ge.resolve(r)}catch(r){return ge.reject(r)}}wrapSuccess(t,r){return t?this.wrapUserFunction(()=>t(r)):ge.resolve(r)}wrapFailure(t,r){return t?this.wrapUserFunction(()=>t(r)):ge.reject(r)}static resolve(t){return new ge((r,n)=>{r(t)})}static reject(t){return new ge((r,n)=>{n(t)})}static waitFor(t){return new ge((r,n)=>{let s=0,a=0,i=!1;t.forEach(o=>{++s,o.next(()=>{++a,i&&a===s&&r()},l=>n(l))}),i=!0,a===s&&r()})}static or(t){let r=ge.resolve(!1);for(const n of t)r=r.next(s=>s?ge.resolve(s):n());return r}static forEach(t,r){const n=[];return t.forEach((s,a)=>{n.push(r.call(this,s,a))}),this.waitFor(n)}static mapArray(t,r){return new ge((n,s)=>{const a=t.length,i=new Array(a);let o=0;for(let l=0;l<a;l++){const c=l;r(t[c]).next(u=>{i[c]=u,++o,o===a&&n(i)},u=>s(u))}})}static doWhile(t,r){return new ge((n,s)=>{const a=()=>{t()===!0?r().next(()=>{a()},s):n()};a()})}}function Y3(e){const t=e.match(/Android ([\d.]+)/i),r=t?t[1].split(".").slice(0,2).join("."):"-1";return Number(r)}function Cu(e){return e.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class av{constructor(t,r){this.previousValue=t,r&&(r.sequenceNumberHandler=n=>this.ie(n),this.se=n=>r.writeSequenceNumber(n))}ie(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue}next(){const t=++this.previousValue;return this.se&&this.se(t),t}}av.oe=-1;function Od(e){return e==null}function Uh(e){return e===0&&1/e==-1/0}function Q3(e){return typeof e=="number"&&Number.isInteger(e)&&!Uh(e)&&e<=Number.MAX_SAFE_INTEGER&&e>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Q_(e){let t=0;for(const r in e)Object.prototype.hasOwnProperty.call(e,r)&&t++;return t}function eo(e,t){for(const r in e)Object.prototype.hasOwnProperty.call(e,r)&&t(r,e[r])}function Ck(e){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lt{constructor(t,r){this.comparator=t,this.root=r||vr.EMPTY}insert(t,r){return new Lt(this.comparator,this.root.insert(t,r,this.comparator).copy(null,null,vr.BLACK,null,null))}remove(t){return new Lt(this.comparator,this.root.remove(t,this.comparator).copy(null,null,vr.BLACK,null,null))}get(t){let r=this.root;for(;!r.isEmpty();){const n=this.comparator(t,r.key);if(n===0)return r.value;n<0?r=r.left:n>0&&(r=r.right)}return null}indexOf(t){let r=0,n=this.root;for(;!n.isEmpty();){const s=this.comparator(t,n.key);if(s===0)return r+n.left.size;s<0?n=n.left:(r+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(t){return this.root.inorderTraversal(t)}forEach(t){this.inorderTraversal((r,n)=>(t(r,n),!1))}toString(){const t=[];return this.inorderTraversal((r,n)=>(t.push(`${r}:${n}`),!1)),`{${t.join(", ")}}`}reverseTraversal(t){return this.root.reverseTraversal(t)}getIterator(){return new Ef(this.root,null,this.comparator,!1)}getIteratorFrom(t){return new Ef(this.root,t,this.comparator,!1)}getReverseIterator(){return new Ef(this.root,null,this.comparator,!0)}getReverseIteratorFrom(t){return new Ef(this.root,t,this.comparator,!0)}}class Ef{constructor(t,r,n,s){this.isReverse=s,this.nodeStack=[];let a=1;for(;!t.isEmpty();)if(a=r?n(t.key,r):1,r&&s&&(a*=-1),a<0)t=this.isReverse?t.left:t.right;else{if(a===0){this.nodeStack.push(t);break}this.nodeStack.push(t),t=this.isReverse?t.right:t.left}}getNext(){let t=this.nodeStack.pop();const r={key:t.key,value:t.value};if(this.isReverse)for(t=t.left;!t.isEmpty();)this.nodeStack.push(t),t=t.right;else for(t=t.right;!t.isEmpty();)this.nodeStack.push(t),t=t.left;return r}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const t=this.nodeStack[this.nodeStack.length-1];return{key:t.key,value:t.value}}}class vr{constructor(t,r,n,s,a){this.key=t,this.value=r,this.color=n??vr.RED,this.left=s??vr.EMPTY,this.right=a??vr.EMPTY,this.size=this.left.size+1+this.right.size}copy(t,r,n,s,a){return new vr(t??this.key,r??this.value,n??this.color,s??this.left,a??this.right)}isEmpty(){return!1}inorderTraversal(t){return this.left.inorderTraversal(t)||t(this.key,this.value)||this.right.inorderTraversal(t)}reverseTraversal(t){return this.right.reverseTraversal(t)||t(this.key,this.value)||this.left.reverseTraversal(t)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(t,r,n){let s=this;const a=n(t,s.key);return s=a<0?s.copy(null,null,null,s.left.insert(t,r,n),null):a===0?s.copy(null,r,null,null,null):s.copy(null,null,null,null,s.right.insert(t,r,n)),s.fixUp()}removeMin(){if(this.left.isEmpty())return vr.EMPTY;let t=this;return t.left.isRed()||t.left.left.isRed()||(t=t.moveRedLeft()),t=t.copy(null,null,null,t.left.removeMin(),null),t.fixUp()}remove(t,r){let n,s=this;if(r(t,s.key)<0)s.left.isEmpty()||s.left.isRed()||s.left.left.isRed()||(s=s.moveRedLeft()),s=s.copy(null,null,null,s.left.remove(t,r),null);else{if(s.left.isRed()&&(s=s.rotateRight()),s.right.isEmpty()||s.right.isRed()||s.right.left.isRed()||(s=s.moveRedRight()),r(t,s.key)===0){if(s.right.isEmpty())return vr.EMPTY;n=s.right.min(),s=s.copy(n.key,n.value,null,null,s.right.removeMin())}s=s.copy(null,null,null,null,s.right.remove(t,r))}return s.fixUp()}isRed(){return this.color}fixUp(){let t=this;return t.right.isRed()&&!t.left.isRed()&&(t=t.rotateLeft()),t.left.isRed()&&t.left.left.isRed()&&(t=t.rotateRight()),t.left.isRed()&&t.right.isRed()&&(t=t.colorFlip()),t}moveRedLeft(){let t=this.colorFlip();return t.right.left.isRed()&&(t=t.copy(null,null,null,null,t.right.rotateRight()),t=t.rotateLeft(),t=t.colorFlip()),t}moveRedRight(){let t=this.colorFlip();return t.left.left.isRed()&&(t=t.rotateRight(),t=t.colorFlip()),t}rotateLeft(){const t=this.copy(null,null,vr.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)}rotateRight(){const t=this.copy(null,null,vr.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)}colorFlip(){const t=this.left.copy(null,null,!this.left.color,null,null),r=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,r)}checkMaxDepth(){const t=this.check();return Math.pow(2,t)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw Le();const t=this.left.check();if(t!==this.right.check())throw Le();return t+(this.isRed()?0:1)}}vr.EMPTY=null,vr.RED=!0,vr.BLACK=!1;vr.EMPTY=new class{constructor(){this.size=0}get key(){throw Le()}get value(){throw Le()}get color(){throw Le()}get left(){throw Le()}get right(){throw Le()}copy(t,r,n,s,a){return this}insert(t,r,n){return new vr(t,r)}remove(t,r){return this}isEmpty(){return!0}inorderTraversal(t){return!1}reverseTraversal(t){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wr{constructor(t){this.comparator=t,this.data=new Lt(this.comparator)}has(t){return this.data.get(t)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(t){return this.data.indexOf(t)}forEach(t){this.data.inorderTraversal((r,n)=>(t(r),!1))}forEachInRange(t,r){const n=this.data.getIteratorFrom(t[0]);for(;n.hasNext();){const s=n.getNext();if(this.comparator(s.key,t[1])>=0)return;r(s.key)}}forEachWhile(t,r){let n;for(n=r!==void 0?this.data.getIteratorFrom(r):this.data.getIterator();n.hasNext();)if(!t(n.getNext().key))return}firstAfterOrEqual(t){const r=this.data.getIteratorFrom(t);return r.hasNext()?r.getNext().key:null}getIterator(){return new J_(this.data.getIterator())}getIteratorFrom(t){return new J_(this.data.getIteratorFrom(t))}add(t){return this.copy(this.data.remove(t).insert(t,!0))}delete(t){return this.has(t)?this.copy(this.data.remove(t)):this}isEmpty(){return this.data.isEmpty()}unionWith(t){let r=this;return r.size<t.size&&(r=t,t=this),t.forEach(n=>{r=r.add(n)}),r}isEqual(t){if(!(t instanceof wr)||this.size!==t.size)return!1;const r=this.data.getIterator(),n=t.data.getIterator();for(;r.hasNext();){const s=r.getNext().key,a=n.getNext().key;if(this.comparator(s,a)!==0)return!1}return!0}toArray(){const t=[];return this.forEach(r=>{t.push(r)}),t}toString(){const t=[];return this.forEach(r=>t.push(r)),"SortedSet("+t.toString()+")"}copy(t){const r=new wr(this.comparator);return r.data=t,r}}class J_{constructor(t){this.iter=t}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class En{constructor(t){this.fields=t,t.sort(_r.comparator)}static empty(){return new En([])}unionWith(t){let r=new wr(_r.comparator);for(const n of this.fields)r=r.add(n);for(const n of t)r=r.add(n);return new En(r.toArray())}covers(t){for(const r of this.fields)if(r.isPrefixOf(t))return!0;return!1}isEqual(t){return ol(this.fields,t.fields,(r,n)=>r.isEqual(n))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rk extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sr{constructor(t){this.binaryString=t}static fromBase64String(t){const r=function(s){try{return atob(s)}catch(a){throw typeof DOMException<"u"&&a instanceof DOMException?new Rk("Invalid base64 string: "+a):a}}(t);return new Sr(r)}static fromUint8Array(t){const r=function(s){let a="";for(let i=0;i<s.length;++i)a+=String.fromCharCode(s[i]);return a}(t);return new Sr(r)}[Symbol.iterator](){let t=0;return{next:()=>t<this.binaryString.length?{value:this.binaryString.charCodeAt(t++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(r){return btoa(r)}(this.binaryString)}toUint8Array(){return function(r){const n=new Uint8Array(r.length);for(let s=0;s<r.length;s++)n[s]=r.charCodeAt(s);return n}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(t){return ct(this.binaryString,t.binaryString)}isEqual(t){return this.binaryString===t.binaryString}}Sr.EMPTY_BYTE_STRING=new Sr("");const J3=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function ai(e){if(gt(!!e),typeof e=="string"){let t=0;const r=J3.exec(e);if(gt(!!r),r[1]){let s=r[1];s=(s+"000000000").substr(0,9),t=Number(s)}const n=new Date(e);return{seconds:Math.floor(n.getTime()/1e3),nanos:t}}return{seconds:$t(e.seconds),nanos:$t(e.nanos)}}function $t(e){return typeof e=="number"?e:typeof e=="string"?Number(e):0}function Gi(e){return typeof e=="string"?Sr.fromBase64String(e):Sr.fromUint8Array(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function iv(e){var t,r;return((r=(((t=e==null?void 0:e.mapValue)===null||t===void 0?void 0:t.fields)||{}).__type__)===null||r===void 0?void 0:r.stringValue)==="server_timestamp"}function ov(e){const t=e.mapValue.fields.__previous_value__;return iv(t)?ov(t):t}function Zc(e){const t=ai(e.mapValue.fields.__local_write_time__.timestampValue);return new ar(t.seconds,t.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Z3{constructor(t,r,n,s,a,i,o,l,c){this.databaseId=t,this.appId=r,this.persistenceKey=n,this.host=s,this.ssl=a,this.forceLongPolling=i,this.autoDetectLongPolling=o,this.longPollingOptions=l,this.useFetchStreams=c}}class eu{constructor(t,r){this.projectId=t,this.database=r||"(default)"}static empty(){return new eu("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(t){return t instanceof eu&&t.projectId===this.projectId&&t.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Tf={mapValue:{}};function Ki(e){return"nullValue"in e?0:"booleanValue"in e?1:"integerValue"in e||"doubleValue"in e?2:"timestampValue"in e?3:"stringValue"in e?5:"bytesValue"in e?6:"referenceValue"in e?7:"geoPointValue"in e?8:"arrayValue"in e?9:"mapValue"in e?iv(e)?4:tF(e)?9007199254740991:eF(e)?10:11:Le()}function Cs(e,t){if(e===t)return!0;const r=Ki(e);if(r!==Ki(t))return!1;switch(r){case 0:case 9007199254740991:return!0;case 1:return e.booleanValue===t.booleanValue;case 4:return Zc(e).isEqual(Zc(t));case 3:return function(s,a){if(typeof s.timestampValue=="string"&&typeof a.timestampValue=="string"&&s.timestampValue.length===a.timestampValue.length)return s.timestampValue===a.timestampValue;const i=ai(s.timestampValue),o=ai(a.timestampValue);return i.seconds===o.seconds&&i.nanos===o.nanos}(e,t);case 5:return e.stringValue===t.stringValue;case 6:return function(s,a){return Gi(s.bytesValue).isEqual(Gi(a.bytesValue))}(e,t);case 7:return e.referenceValue===t.referenceValue;case 8:return function(s,a){return $t(s.geoPointValue.latitude)===$t(a.geoPointValue.latitude)&&$t(s.geoPointValue.longitude)===$t(a.geoPointValue.longitude)}(e,t);case 2:return function(s,a){if("integerValue"in s&&"integerValue"in a)return $t(s.integerValue)===$t(a.integerValue);if("doubleValue"in s&&"doubleValue"in a){const i=$t(s.doubleValue),o=$t(a.doubleValue);return i===o?Uh(i)===Uh(o):isNaN(i)&&isNaN(o)}return!1}(e,t);case 9:return ol(e.arrayValue.values||[],t.arrayValue.values||[],Cs);case 10:case 11:return function(s,a){const i=s.mapValue.fields||{},o=a.mapValue.fields||{};if(Q_(i)!==Q_(o))return!1;for(const l in i)if(i.hasOwnProperty(l)&&(o[l]===void 0||!Cs(i[l],o[l])))return!1;return!0}(e,t);default:return Le()}}function tu(e,t){return(e.values||[]).find(r=>Cs(r,t))!==void 0}function ll(e,t){if(e===t)return 0;const r=Ki(e),n=Ki(t);if(r!==n)return ct(r,n);switch(r){case 0:case 9007199254740991:return 0;case 1:return ct(e.booleanValue,t.booleanValue);case 2:return function(a,i){const o=$t(a.integerValue||a.doubleValue),l=$t(i.integerValue||i.doubleValue);return o<l?-1:o>l?1:o===l?0:isNaN(o)?isNaN(l)?0:-1:1}(e,t);case 3:return Z_(e.timestampValue,t.timestampValue);case 4:return Z_(Zc(e),Zc(t));case 5:return ct(e.stringValue,t.stringValue);case 6:return function(a,i){const o=Gi(a),l=Gi(i);return o.compareTo(l)}(e.bytesValue,t.bytesValue);case 7:return function(a,i){const o=a.split("/"),l=i.split("/");for(let c=0;c<o.length&&c<l.length;c++){const u=ct(o[c],l[c]);if(u!==0)return u}return ct(o.length,l.length)}(e.referenceValue,t.referenceValue);case 8:return function(a,i){const o=ct($t(a.latitude),$t(i.latitude));return o!==0?o:ct($t(a.longitude),$t(i.longitude))}(e.geoPointValue,t.geoPointValue);case 9:return ey(e.arrayValue,t.arrayValue);case 10:return function(a,i){var o,l,c,u;const h=a.fields||{},m=i.fields||{},p=(o=h.value)===null||o===void 0?void 0:o.arrayValue,x=(l=m.value)===null||l===void 0?void 0:l.arrayValue,v=ct(((c=p==null?void 0:p.values)===null||c===void 0?void 0:c.length)||0,((u=x==null?void 0:x.values)===null||u===void 0?void 0:u.length)||0);return v!==0?v:ey(p,x)}(e.mapValue,t.mapValue);case 11:return function(a,i){if(a===Tf.mapValue&&i===Tf.mapValue)return 0;if(a===Tf.mapValue)return 1;if(i===Tf.mapValue)return-1;const o=a.fields||{},l=Object.keys(o),c=i.fields||{},u=Object.keys(c);l.sort(),u.sort();for(let h=0;h<l.length&&h<u.length;++h){const m=ct(l[h],u[h]);if(m!==0)return m;const p=ll(o[l[h]],c[u[h]]);if(p!==0)return p}return ct(l.length,u.length)}(e.mapValue,t.mapValue);default:throw Le()}}function Z_(e,t){if(typeof e=="string"&&typeof t=="string"&&e.length===t.length)return ct(e,t);const r=ai(e),n=ai(t),s=ct(r.seconds,n.seconds);return s!==0?s:ct(r.nanos,n.nanos)}function ey(e,t){const r=e.values||[],n=t.values||[];for(let s=0;s<r.length&&s<n.length;++s){const a=ll(r[s],n[s]);if(a)return a}return ct(r.length,n.length)}function cl(e){return dp(e)}function dp(e){return"nullValue"in e?"null":"booleanValue"in e?""+e.booleanValue:"integerValue"in e?""+e.integerValue:"doubleValue"in e?""+e.doubleValue:"timestampValue"in e?function(r){const n=ai(r);return`time(${n.seconds},${n.nanos})`}(e.timestampValue):"stringValue"in e?e.stringValue:"bytesValue"in e?function(r){return Gi(r).toBase64()}(e.bytesValue):"referenceValue"in e?function(r){return Pe.fromName(r).toString()}(e.referenceValue):"geoPointValue"in e?function(r){return`geo(${r.latitude},${r.longitude})`}(e.geoPointValue):"arrayValue"in e?function(r){let n="[",s=!0;for(const a of r.values||[])s?s=!1:n+=",",n+=dp(a);return n+"]"}(e.arrayValue):"mapValue"in e?function(r){const n=Object.keys(r.fields||{}).sort();let s="{",a=!0;for(const i of n)a?a=!1:s+=",",s+=`${i}:${dp(r.fields[i])}`;return s+"}"}(e.mapValue):Le()}function ty(e,t){return{referenceValue:`projects/${e.projectId}/databases/${e.database}/documents/${t.path.canonicalString()}`}}function mp(e){return!!e&&"integerValue"in e}function lv(e){return!!e&&"arrayValue"in e}function ry(e){return!!e&&"nullValue"in e}function ny(e){return!!e&&"doubleValue"in e&&isNaN(Number(e.doubleValue))}function Zf(e){return!!e&&"mapValue"in e}function eF(e){var t,r;return((r=(((t=e==null?void 0:e.mapValue)===null||t===void 0?void 0:t.fields)||{}).__type__)===null||r===void 0?void 0:r.stringValue)==="__vector__"}function vc(e){if(e.geoPointValue)return{geoPointValue:Object.assign({},e.geoPointValue)};if(e.timestampValue&&typeof e.timestampValue=="object")return{timestampValue:Object.assign({},e.timestampValue)};if(e.mapValue){const t={mapValue:{fields:{}}};return eo(e.mapValue.fields,(r,n)=>t.mapValue.fields[r]=vc(n)),t}if(e.arrayValue){const t={arrayValue:{values:[]}};for(let r=0;r<(e.arrayValue.values||[]).length;++r)t.arrayValue.values[r]=vc(e.arrayValue.values[r]);return t}return Object.assign({},e)}function tF(e){return(((e.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ln{constructor(t){this.value=t}static empty(){return new ln({mapValue:{}})}field(t){if(t.isEmpty())return this.value;{let r=this.value;for(let n=0;n<t.length-1;++n)if(r=(r.mapValue.fields||{})[t.get(n)],!Zf(r))return null;return r=(r.mapValue.fields||{})[t.lastSegment()],r||null}}set(t,r){this.getFieldsMap(t.popLast())[t.lastSegment()]=vc(r)}setAll(t){let r=_r.emptyPath(),n={},s=[];t.forEach((i,o)=>{if(!r.isImmediateParentOf(o)){const l=this.getFieldsMap(r);this.applyChanges(l,n,s),n={},s=[],r=o.popLast()}i?n[o.lastSegment()]=vc(i):s.push(o.lastSegment())});const a=this.getFieldsMap(r);this.applyChanges(a,n,s)}delete(t){const r=this.field(t.popLast());Zf(r)&&r.mapValue.fields&&delete r.mapValue.fields[t.lastSegment()]}isEqual(t){return Cs(this.value,t.value)}getFieldsMap(t){let r=this.value;r.mapValue.fields||(r.mapValue={fields:{}});for(let n=0;n<t.length;++n){let s=r.mapValue.fields[t.get(n)];Zf(s)&&s.mapValue.fields||(s={mapValue:{fields:{}}},r.mapValue.fields[t.get(n)]=s),r=s}return r.mapValue.fields}applyChanges(t,r,n){eo(r,(s,a)=>t[s]=a);for(const s of n)delete t[s]}clone(){return new ln(vc(this.value))}}function Nk(e){const t=[];return eo(e.fields,(r,n)=>{const s=new _r([r]);if(Zf(n)){const a=Nk(n.mapValue).fields;if(a.length===0)t.push(s);else for(const i of a)t.push(s.child(i))}else t.push(s)}),new En(t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mr{constructor(t,r,n,s,a,i,o){this.key=t,this.documentType=r,this.version=n,this.readTime=s,this.createTime=a,this.data=i,this.documentState=o}static newInvalidDocument(t){return new Mr(t,0,Ve.min(),Ve.min(),Ve.min(),ln.empty(),0)}static newFoundDocument(t,r,n,s){return new Mr(t,1,r,Ve.min(),n,s,0)}static newNoDocument(t,r){return new Mr(t,2,r,Ve.min(),Ve.min(),ln.empty(),0)}static newUnknownDocument(t,r){return new Mr(t,3,r,Ve.min(),Ve.min(),ln.empty(),2)}convertToFoundDocument(t,r){return!this.createTime.isEqual(Ve.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=t),this.version=t,this.documentType=1,this.data=r,this.documentState=0,this}convertToNoDocument(t){return this.version=t,this.documentType=2,this.data=ln.empty(),this.documentState=0,this}convertToUnknownDocument(t){return this.version=t,this.documentType=3,this.data=ln.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Ve.min(),this}setReadTime(t){return this.readTime=t,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(t){return t instanceof Mr&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.documentType===t.documentType&&this.documentState===t.documentState&&this.data.isEqual(t.data)}mutableCopy(){return new Mr(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bh{constructor(t,r){this.position=t,this.inclusive=r}}function sy(e,t,r){let n=0;for(let s=0;s<e.position.length;s++){const a=t[s],i=e.position[s];if(a.field.isKeyField()?n=Pe.comparator(Pe.fromName(i.referenceValue),r.key):n=ll(i,r.data.field(a.field)),a.dir==="desc"&&(n*=-1),n!==0)break}return n}function ay(e,t){if(e===null)return t===null;if(t===null||e.inclusive!==t.inclusive||e.position.length!==t.position.length)return!1;for(let r=0;r<e.position.length;r++)if(!Cs(e.position[r],t.position[r]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zh{constructor(t,r="asc"){this.field=t,this.dir=r}}function rF(e,t){return e.dir===t.dir&&e.field.isEqual(t.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bk{}class Zt extends bk{constructor(t,r,n){super(),this.field=t,this.op=r,this.value=n}static create(t,r,n){return t.isKeyField()?r==="in"||r==="not-in"?this.createKeyFieldInFilter(t,r,n):new sF(t,r,n):r==="array-contains"?new oF(t,n):r==="in"?new lF(t,n):r==="not-in"?new cF(t,n):r==="array-contains-any"?new uF(t,n):new Zt(t,r,n)}static createKeyFieldInFilter(t,r,n){return r==="in"?new aF(t,n):new iF(t,n)}matches(t){const r=t.data.field(this.field);return this.op==="!="?r!==null&&this.matchesComparison(ll(r,this.value)):r!==null&&Ki(this.value)===Ki(r)&&this.matchesComparison(ll(r,this.value))}matchesComparison(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return t===0;case"!=":return t!==0;case">":return t>0;case">=":return t>=0;default:return Le()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class us extends bk{constructor(t,r){super(),this.filters=t,this.op=r,this.ae=null}static create(t,r){return new us(t,r)}matches(t){return Pk(this)?this.filters.find(r=>!r.matches(t))===void 0:this.filters.find(r=>r.matches(t))!==void 0}getFlattenedFilters(){return this.ae!==null||(this.ae=this.filters.reduce((t,r)=>t.concat(r.getFlattenedFilters()),[])),this.ae}getFilters(){return Object.assign([],this.filters)}}function Pk(e){return e.op==="and"}function Dk(e){return nF(e)&&Pk(e)}function nF(e){for(const t of e.filters)if(t instanceof us)return!1;return!0}function pp(e){if(e instanceof Zt)return e.field.canonicalString()+e.op.toString()+cl(e.value);if(Dk(e))return e.filters.map(t=>pp(t)).join(",");{const t=e.filters.map(r=>pp(r)).join(",");return`${e.op}(${t})`}}function Fk(e,t){return e instanceof Zt?function(n,s){return s instanceof Zt&&n.op===s.op&&n.field.isEqual(s.field)&&Cs(n.value,s.value)}(e,t):e instanceof us?function(n,s){return s instanceof us&&n.op===s.op&&n.filters.length===s.filters.length?n.filters.reduce((a,i,o)=>a&&Fk(i,s.filters[o]),!0):!1}(e,t):void Le()}function Ok(e){return e instanceof Zt?function(r){return`${r.field.canonicalString()} ${r.op} ${cl(r.value)}`}(e):e instanceof us?function(r){return r.op.toString()+" {"+r.getFilters().map(Ok).join(" ,")+"}"}(e):"Filter"}class sF extends Zt{constructor(t,r,n){super(t,r,n),this.key=Pe.fromName(n.referenceValue)}matches(t){const r=Pe.comparator(t.key,this.key);return this.matchesComparison(r)}}class aF extends Zt{constructor(t,r){super(t,"in",r),this.keys=Mk("in",r)}matches(t){return this.keys.some(r=>r.isEqual(t.key))}}class iF extends Zt{constructor(t,r){super(t,"not-in",r),this.keys=Mk("not-in",r)}matches(t){return!this.keys.some(r=>r.isEqual(t.key))}}function Mk(e,t){var r;return(((r=t.arrayValue)===null||r===void 0?void 0:r.values)||[]).map(n=>Pe.fromName(n.referenceValue))}class oF extends Zt{constructor(t,r){super(t,"array-contains",r)}matches(t){const r=t.data.field(this.field);return lv(r)&&tu(r.arrayValue,this.value)}}class lF extends Zt{constructor(t,r){super(t,"in",r)}matches(t){const r=t.data.field(this.field);return r!==null&&tu(this.value.arrayValue,r)}}class cF extends Zt{constructor(t,r){super(t,"not-in",r)}matches(t){if(tu(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const r=t.data.field(this.field);return r!==null&&!tu(this.value.arrayValue,r)}}class uF extends Zt{constructor(t,r){super(t,"array-contains-any",r)}matches(t){const r=t.data.field(this.field);return!(!lv(r)||!r.arrayValue.values)&&r.arrayValue.values.some(n=>tu(this.value.arrayValue,n))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fF{constructor(t,r=null,n=[],s=[],a=null,i=null,o=null){this.path=t,this.collectionGroup=r,this.orderBy=n,this.filters=s,this.limit=a,this.startAt=i,this.endAt=o,this.ue=null}}function iy(e,t=null,r=[],n=[],s=null,a=null,i=null){return new fF(e,t,r,n,s,a,i)}function cv(e){const t=Be(e);if(t.ue===null){let r=t.path.canonicalString();t.collectionGroup!==null&&(r+="|cg:"+t.collectionGroup),r+="|f:",r+=t.filters.map(n=>pp(n)).join(","),r+="|ob:",r+=t.orderBy.map(n=>function(a){return a.field.canonicalString()+a.dir}(n)).join(","),Od(t.limit)||(r+="|l:",r+=t.limit),t.startAt&&(r+="|lb:",r+=t.startAt.inclusive?"b:":"a:",r+=t.startAt.position.map(n=>cl(n)).join(",")),t.endAt&&(r+="|ub:",r+=t.endAt.inclusive?"a:":"b:",r+=t.endAt.position.map(n=>cl(n)).join(",")),t.ue=r}return t.ue}function uv(e,t){if(e.limit!==t.limit||e.orderBy.length!==t.orderBy.length)return!1;for(let r=0;r<e.orderBy.length;r++)if(!rF(e.orderBy[r],t.orderBy[r]))return!1;if(e.filters.length!==t.filters.length)return!1;for(let r=0;r<e.filters.length;r++)if(!Fk(e.filters[r],t.filters[r]))return!1;return e.collectionGroup===t.collectionGroup&&!!e.path.isEqual(t.path)&&!!ay(e.startAt,t.startAt)&&ay(e.endAt,t.endAt)}function gp(e){return Pe.isDocumentKey(e.path)&&e.collectionGroup===null&&e.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ru{constructor(t,r=null,n=[],s=[],a=null,i="F",o=null,l=null){this.path=t,this.collectionGroup=r,this.explicitOrderBy=n,this.filters=s,this.limit=a,this.limitType=i,this.startAt=o,this.endAt=l,this.ce=null,this.le=null,this.he=null,this.startAt,this.endAt}}function hF(e,t,r,n,s,a,i,o){return new Ru(e,t,r,n,s,a,i,o)}function Md(e){return new Ru(e)}function oy(e){return e.filters.length===0&&e.limit===null&&e.startAt==null&&e.endAt==null&&(e.explicitOrderBy.length===0||e.explicitOrderBy.length===1&&e.explicitOrderBy[0].field.isKeyField())}function Lk(e){return e.collectionGroup!==null}function xc(e){const t=Be(e);if(t.ce===null){t.ce=[];const r=new Set;for(const a of t.explicitOrderBy)t.ce.push(a),r.add(a.field.canonicalString());const n=t.explicitOrderBy.length>0?t.explicitOrderBy[t.explicitOrderBy.length-1].dir:"asc";(function(i){let o=new wr(_r.comparator);return i.filters.forEach(l=>{l.getFlattenedFilters().forEach(c=>{c.isInequality()&&(o=o.add(c.field))})}),o})(t).forEach(a=>{r.has(a.canonicalString())||a.isKeyField()||t.ce.push(new zh(a,n))}),r.has(_r.keyField().canonicalString())||t.ce.push(new zh(_r.keyField(),n))}return t.ce}function Ss(e){const t=Be(e);return t.le||(t.le=dF(t,xc(e))),t.le}function dF(e,t){if(e.limitType==="F")return iy(e.path,e.collectionGroup,t,e.filters,e.limit,e.startAt,e.endAt);{t=t.map(s=>{const a=s.dir==="desc"?"asc":"desc";return new zh(s.field,a)});const r=e.endAt?new Bh(e.endAt.position,e.endAt.inclusive):null,n=e.startAt?new Bh(e.startAt.position,e.startAt.inclusive):null;return iy(e.path,e.collectionGroup,t,e.filters,e.limit,r,n)}}function vp(e,t){const r=e.filters.concat([t]);return new Ru(e.path,e.collectionGroup,e.explicitOrderBy.slice(),r,e.limit,e.limitType,e.startAt,e.endAt)}function xp(e,t,r){return new Ru(e.path,e.collectionGroup,e.explicitOrderBy.slice(),e.filters.slice(),t,r,e.startAt,e.endAt)}function Ld(e,t){return uv(Ss(e),Ss(t))&&e.limitType===t.limitType}function jk(e){return`${cv(Ss(e))}|lt:${e.limitType}`}function _o(e){return`Query(target=${function(r){let n=r.path.canonicalString();return r.collectionGroup!==null&&(n+=" collectionGroup="+r.collectionGroup),r.filters.length>0&&(n+=`, filters: [${r.filters.map(s=>Ok(s)).join(", ")}]`),Od(r.limit)||(n+=", limit: "+r.limit),r.orderBy.length>0&&(n+=`, orderBy: [${r.orderBy.map(s=>function(i){return`${i.field.canonicalString()} (${i.dir})`}(s)).join(", ")}]`),r.startAt&&(n+=", startAt: ",n+=r.startAt.inclusive?"b:":"a:",n+=r.startAt.position.map(s=>cl(s)).join(",")),r.endAt&&(n+=", endAt: ",n+=r.endAt.inclusive?"a:":"b:",n+=r.endAt.position.map(s=>cl(s)).join(",")),`Target(${n})`}(Ss(e))}; limitType=${e.limitType})`}function jd(e,t){return t.isFoundDocument()&&function(n,s){const a=s.key.path;return n.collectionGroup!==null?s.key.hasCollectionId(n.collectionGroup)&&n.path.isPrefixOf(a):Pe.isDocumentKey(n.path)?n.path.isEqual(a):n.path.isImmediateParentOf(a)}(e,t)&&function(n,s){for(const a of xc(n))if(!a.field.isKeyField()&&s.data.field(a.field)===null)return!1;return!0}(e,t)&&function(n,s){for(const a of n.filters)if(!a.matches(s))return!1;return!0}(e,t)&&function(n,s){return!(n.startAt&&!function(i,o,l){const c=sy(i,o,l);return i.inclusive?c<=0:c<0}(n.startAt,xc(n),s)||n.endAt&&!function(i,o,l){const c=sy(i,o,l);return i.inclusive?c>=0:c>0}(n.endAt,xc(n),s))}(e,t)}function mF(e){return e.collectionGroup||(e.path.length%2==1?e.path.lastSegment():e.path.get(e.path.length-2))}function Vk(e){return(t,r)=>{let n=!1;for(const s of xc(e)){const a=pF(s,t,r);if(a!==0)return a;n=n||s.field.isKeyField()}return 0}}function pF(e,t,r){const n=e.field.isKeyField()?Pe.comparator(t.key,r.key):function(a,i,o){const l=i.data.field(a),c=o.data.field(a);return l!==null&&c!==null?ll(l,c):Le()}(e.field,t,r);switch(e.dir){case"asc":return n;case"desc":return-1*n;default:return Le()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class El{constructor(t,r){this.mapKeyFn=t,this.equalsFn=r,this.inner={},this.innerSize=0}get(t){const r=this.mapKeyFn(t),n=this.inner[r];if(n!==void 0){for(const[s,a]of n)if(this.equalsFn(s,t))return a}}has(t){return this.get(t)!==void 0}set(t,r){const n=this.mapKeyFn(t),s=this.inner[n];if(s===void 0)return this.inner[n]=[[t,r]],void this.innerSize++;for(let a=0;a<s.length;a++)if(this.equalsFn(s[a][0],t))return void(s[a]=[t,r]);s.push([t,r]),this.innerSize++}delete(t){const r=this.mapKeyFn(t),n=this.inner[r];if(n===void 0)return!1;for(let s=0;s<n.length;s++)if(this.equalsFn(n[s][0],t))return n.length===1?delete this.inner[r]:n.splice(s,1),this.innerSize--,!0;return!1}forEach(t){eo(this.inner,(r,n)=>{for(const[s,a]of n)t(s,a)})}isEmpty(){return Ck(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gF=new Lt(Pe.comparator);function ma(){return gF}const Uk=new Lt(Pe.comparator);function ec(...e){let t=Uk;for(const r of e)t=t.insert(r.key,r);return t}function Bk(e){let t=Uk;return e.forEach((r,n)=>t=t.insert(r,n.overlayedDocument)),t}function Ni(){return _c()}function zk(){return _c()}function _c(){return new El(e=>e.toString(),(e,t)=>e.isEqual(t))}const vF=new Lt(Pe.comparator),xF=new wr(Pe.comparator);function Xe(...e){let t=xF;for(const r of e)t=t.add(r);return t}const _F=new wr(ct);function yF(){return _F}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fv(e,t){if(e.useProto3Json){if(isNaN(t))return{doubleValue:"NaN"};if(t===1/0)return{doubleValue:"Infinity"};if(t===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Uh(t)?"-0":t}}function $k(e){return{integerValue:""+e}}function Wk(e,t){return Q3(t)?$k(t):fv(e,t)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vd{constructor(){this._=void 0}}function wF(e,t,r){return e instanceof ru?function(s,a){const i={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:s.seconds,nanos:s.nanoseconds}}}};return a&&iv(a)&&(a=ov(a)),a&&(i.fields.__previous_value__=a),{mapValue:i}}(r,t):e instanceof nu?Gk(e,t):e instanceof su?Kk(e,t):function(s,a){const i=Hk(s,a),o=ly(i)+ly(s.Pe);return mp(i)&&mp(s.Pe)?$k(o):fv(s.serializer,o)}(e,t)}function EF(e,t,r){return e instanceof nu?Gk(e,t):e instanceof su?Kk(e,t):r}function Hk(e,t){return e instanceof au?function(n){return mp(n)||function(a){return!!a&&"doubleValue"in a}(n)}(t)?t:{integerValue:0}:null}class ru extends Vd{}class nu extends Vd{constructor(t){super(),this.elements=t}}function Gk(e,t){const r=qk(t);for(const n of e.elements)r.some(s=>Cs(s,n))||r.push(n);return{arrayValue:{values:r}}}class su extends Vd{constructor(t){super(),this.elements=t}}function Kk(e,t){let r=qk(t);for(const n of e.elements)r=r.filter(s=>!Cs(s,n));return{arrayValue:{values:r}}}class au extends Vd{constructor(t,r){super(),this.serializer=t,this.Pe=r}}function ly(e){return $t(e.integerValue||e.doubleValue)}function qk(e){return lv(e)&&e.arrayValue.values?e.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xk{constructor(t,r){this.field=t,this.transform=r}}function TF(e,t){return e.field.isEqual(t.field)&&function(n,s){return n instanceof nu&&s instanceof nu||n instanceof su&&s instanceof su?ol(n.elements,s.elements,Cs):n instanceof au&&s instanceof au?Cs(n.Pe,s.Pe):n instanceof ru&&s instanceof ru}(e.transform,t.transform)}class kF{constructor(t,r){this.version=t,this.transformResults=r}}class Un{constructor(t,r){this.updateTime=t,this.exists=r}static none(){return new Un}static exists(t){return new Un(void 0,t)}static updateTime(t){return new Un(t)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)}}function eh(e,t){return e.updateTime!==void 0?t.isFoundDocument()&&t.version.isEqual(e.updateTime):e.exists===void 0||e.exists===t.isFoundDocument()}class Ud{}function Yk(e,t){if(!e.hasLocalMutations||t&&t.fields.length===0)return null;if(t===null)return e.isNoDocument()?new hv(e.key,Un.none()):new Nu(e.key,e.data,Un.none());{const r=e.data,n=ln.empty();let s=new wr(_r.comparator);for(let a of t.fields)if(!s.has(a)){let i=r.field(a);i===null&&a.length>1&&(a=a.popLast(),i=r.field(a)),i===null?n.delete(a):n.set(a,i),s=s.add(a)}return new pi(e.key,n,new En(s.toArray()),Un.none())}}function SF(e,t,r){e instanceof Nu?function(s,a,i){const o=s.value.clone(),l=uy(s.fieldTransforms,a,i.transformResults);o.setAll(l),a.convertToFoundDocument(i.version,o).setHasCommittedMutations()}(e,t,r):e instanceof pi?function(s,a,i){if(!eh(s.precondition,a))return void a.convertToUnknownDocument(i.version);const o=uy(s.fieldTransforms,a,i.transformResults),l=a.data;l.setAll(Qk(s)),l.setAll(o),a.convertToFoundDocument(i.version,l).setHasCommittedMutations()}(e,t,r):function(s,a,i){a.convertToNoDocument(i.version).setHasCommittedMutations()}(0,t,r)}function yc(e,t,r,n){return e instanceof Nu?function(a,i,o,l){if(!eh(a.precondition,i))return o;const c=a.value.clone(),u=fy(a.fieldTransforms,l,i);return c.setAll(u),i.convertToFoundDocument(i.version,c).setHasLocalMutations(),null}(e,t,r,n):e instanceof pi?function(a,i,o,l){if(!eh(a.precondition,i))return o;const c=fy(a.fieldTransforms,l,i),u=i.data;return u.setAll(Qk(a)),u.setAll(c),i.convertToFoundDocument(i.version,u).setHasLocalMutations(),o===null?null:o.unionWith(a.fieldMask.fields).unionWith(a.fieldTransforms.map(h=>h.field))}(e,t,r,n):function(a,i,o){return eh(a.precondition,i)?(i.convertToNoDocument(i.version).setHasLocalMutations(),null):o}(e,t,r)}function AF(e,t){let r=null;for(const n of e.fieldTransforms){const s=t.data.field(n.field),a=Hk(n.transform,s||null);a!=null&&(r===null&&(r=ln.empty()),r.set(n.field,a))}return r||null}function cy(e,t){return e.type===t.type&&!!e.key.isEqual(t.key)&&!!e.precondition.isEqual(t.precondition)&&!!function(n,s){return n===void 0&&s===void 0||!(!n||!s)&&ol(n,s,(a,i)=>TF(a,i))}(e.fieldTransforms,t.fieldTransforms)&&(e.type===0?e.value.isEqual(t.value):e.type!==1||e.data.isEqual(t.data)&&e.fieldMask.isEqual(t.fieldMask))}class Nu extends Ud{constructor(t,r,n,s=[]){super(),this.key=t,this.value=r,this.precondition=n,this.fieldTransforms=s,this.type=0}getFieldMask(){return null}}class pi extends Ud{constructor(t,r,n,s,a=[]){super(),this.key=t,this.data=r,this.fieldMask=n,this.precondition=s,this.fieldTransforms=a,this.type=1}getFieldMask(){return this.fieldMask}}function Qk(e){const t=new Map;return e.fieldMask.fields.forEach(r=>{if(!r.isEmpty()){const n=e.data.field(r);t.set(r,n)}}),t}function uy(e,t,r){const n=new Map;gt(e.length===r.length);for(let s=0;s<r.length;s++){const a=e[s],i=a.transform,o=t.data.field(a.field);n.set(a.field,EF(i,o,r[s]))}return n}function fy(e,t,r){const n=new Map;for(const s of e){const a=s.transform,i=r.data.field(s.field);n.set(s.field,wF(a,i,t))}return n}class hv extends Ud{constructor(t,r){super(),this.key=t,this.precondition=r,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class IF extends Ud{constructor(t,r){super(),this.key=t,this.precondition=r,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class CF{constructor(t,r,n,s){this.batchId=t,this.localWriteTime=r,this.baseMutations=n,this.mutations=s}applyToRemoteDocument(t,r){const n=r.mutationResults;for(let s=0;s<this.mutations.length;s++){const a=this.mutations[s];a.key.isEqual(t.key)&&SF(a,t,n[s])}}applyToLocalView(t,r){for(const n of this.baseMutations)n.key.isEqual(t.key)&&(r=yc(n,t,r,this.localWriteTime));for(const n of this.mutations)n.key.isEqual(t.key)&&(r=yc(n,t,r,this.localWriteTime));return r}applyToLocalDocumentSet(t,r){const n=zk();return this.mutations.forEach(s=>{const a=t.get(s.key),i=a.overlayedDocument;let o=this.applyToLocalView(i,a.mutatedFields);o=r.has(s.key)?null:o;const l=Yk(i,o);l!==null&&n.set(s.key,l),i.isValidDocument()||i.convertToNoDocument(Ve.min())}),n}keys(){return this.mutations.reduce((t,r)=>t.add(r.key),Xe())}isEqual(t){return this.batchId===t.batchId&&ol(this.mutations,t.mutations,(r,n)=>cy(r,n))&&ol(this.baseMutations,t.baseMutations,(r,n)=>cy(r,n))}}class dv{constructor(t,r,n,s){this.batch=t,this.commitVersion=r,this.mutationResults=n,this.docVersions=s}static from(t,r,n){gt(t.mutations.length===n.length);let s=function(){return vF}();const a=t.mutations;for(let i=0;i<a.length;i++)s=s.insert(a[i].key,n[i].version);return new dv(t,r,n,s)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RF{constructor(t,r){this.largestBatchId=t,this.mutation=r}getKey(){return this.mutation.key}isEqual(t){return t!==null&&this.mutation===t.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class NF{constructor(t,r){this.count=t,this.unchangedNames=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var qt,Ze;function bF(e){switch(e){default:return Le();case fe.CANCELLED:case fe.UNKNOWN:case fe.DEADLINE_EXCEEDED:case fe.RESOURCE_EXHAUSTED:case fe.INTERNAL:case fe.UNAVAILABLE:case fe.UNAUTHENTICATED:return!1;case fe.INVALID_ARGUMENT:case fe.NOT_FOUND:case fe.ALREADY_EXISTS:case fe.PERMISSION_DENIED:case fe.FAILED_PRECONDITION:case fe.ABORTED:case fe.OUT_OF_RANGE:case fe.UNIMPLEMENTED:case fe.DATA_LOSS:return!0}}function Jk(e){if(e===void 0)return da("GRPC error has no .code"),fe.UNKNOWN;switch(e){case qt.OK:return fe.OK;case qt.CANCELLED:return fe.CANCELLED;case qt.UNKNOWN:return fe.UNKNOWN;case qt.DEADLINE_EXCEEDED:return fe.DEADLINE_EXCEEDED;case qt.RESOURCE_EXHAUSTED:return fe.RESOURCE_EXHAUSTED;case qt.INTERNAL:return fe.INTERNAL;case qt.UNAVAILABLE:return fe.UNAVAILABLE;case qt.UNAUTHENTICATED:return fe.UNAUTHENTICATED;case qt.INVALID_ARGUMENT:return fe.INVALID_ARGUMENT;case qt.NOT_FOUND:return fe.NOT_FOUND;case qt.ALREADY_EXISTS:return fe.ALREADY_EXISTS;case qt.PERMISSION_DENIED:return fe.PERMISSION_DENIED;case qt.FAILED_PRECONDITION:return fe.FAILED_PRECONDITION;case qt.ABORTED:return fe.ABORTED;case qt.OUT_OF_RANGE:return fe.OUT_OF_RANGE;case qt.UNIMPLEMENTED:return fe.UNIMPLEMENTED;case qt.DATA_LOSS:return fe.DATA_LOSS;default:return Le()}}(Ze=qt||(qt={}))[Ze.OK=0]="OK",Ze[Ze.CANCELLED=1]="CANCELLED",Ze[Ze.UNKNOWN=2]="UNKNOWN",Ze[Ze.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Ze[Ze.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Ze[Ze.NOT_FOUND=5]="NOT_FOUND",Ze[Ze.ALREADY_EXISTS=6]="ALREADY_EXISTS",Ze[Ze.PERMISSION_DENIED=7]="PERMISSION_DENIED",Ze[Ze.UNAUTHENTICATED=16]="UNAUTHENTICATED",Ze[Ze.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Ze[Ze.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Ze[Ze.ABORTED=10]="ABORTED",Ze[Ze.OUT_OF_RANGE=11]="OUT_OF_RANGE",Ze[Ze.UNIMPLEMENTED=12]="UNIMPLEMENTED",Ze[Ze.INTERNAL=13]="INTERNAL",Ze[Ze.UNAVAILABLE=14]="UNAVAILABLE",Ze[Ze.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function PF(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const DF=new Oi([4294967295,4294967295],0);function hy(e){const t=PF().encode(e),r=new yk;return r.update(t),new Uint8Array(r.digest())}function dy(e){const t=new DataView(e.buffer),r=t.getUint32(0,!0),n=t.getUint32(4,!0),s=t.getUint32(8,!0),a=t.getUint32(12,!0);return[new Oi([r,n],0),new Oi([s,a],0)]}class mv{constructor(t,r,n){if(this.bitmap=t,this.padding=r,this.hashCount=n,r<0||r>=8)throw new tc(`Invalid padding: ${r}`);if(n<0)throw new tc(`Invalid hash count: ${n}`);if(t.length>0&&this.hashCount===0)throw new tc(`Invalid hash count: ${n}`);if(t.length===0&&r!==0)throw new tc(`Invalid padding when bitmap length is 0: ${r}`);this.Ie=8*t.length-r,this.Te=Oi.fromNumber(this.Ie)}Ee(t,r,n){let s=t.add(r.multiply(Oi.fromNumber(n)));return s.compare(DF)===1&&(s=new Oi([s.getBits(0),s.getBits(1)],0)),s.modulo(this.Te).toNumber()}de(t){return(this.bitmap[Math.floor(t/8)]&1<<t%8)!=0}mightContain(t){if(this.Ie===0)return!1;const r=hy(t),[n,s]=dy(r);for(let a=0;a<this.hashCount;a++){const i=this.Ee(n,s,a);if(!this.de(i))return!1}return!0}static create(t,r,n){const s=t%8==0?0:8-t%8,a=new Uint8Array(Math.ceil(t/8)),i=new mv(a,s,r);return n.forEach(o=>i.insert(o)),i}insert(t){if(this.Ie===0)return;const r=hy(t),[n,s]=dy(r);for(let a=0;a<this.hashCount;a++){const i=this.Ee(n,s,a);this.Ae(i)}}Ae(t){const r=Math.floor(t/8),n=t%8;this.bitmap[r]|=1<<n}}class tc extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bd{constructor(t,r,n,s,a){this.snapshotVersion=t,this.targetChanges=r,this.targetMismatches=n,this.documentUpdates=s,this.resolvedLimboDocuments=a}static createSynthesizedRemoteEventForCurrentChange(t,r,n){const s=new Map;return s.set(t,bu.createSynthesizedTargetChangeForCurrentChange(t,r,n)),new Bd(Ve.min(),s,new Lt(ct),ma(),Xe())}}class bu{constructor(t,r,n,s,a){this.resumeToken=t,this.current=r,this.addedDocuments=n,this.modifiedDocuments=s,this.removedDocuments=a}static createSynthesizedTargetChangeForCurrentChange(t,r,n){return new bu(n,r,Xe(),Xe(),Xe())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class th{constructor(t,r,n,s){this.Re=t,this.removedTargetIds=r,this.key=n,this.Ve=s}}class Zk{constructor(t,r){this.targetId=t,this.me=r}}class eS{constructor(t,r,n=Sr.EMPTY_BYTE_STRING,s=null){this.state=t,this.targetIds=r,this.resumeToken=n,this.cause=s}}class my{constructor(){this.fe=0,this.ge=gy(),this.pe=Sr.EMPTY_BYTE_STRING,this.ye=!1,this.we=!0}get current(){return this.ye}get resumeToken(){return this.pe}get Se(){return this.fe!==0}get be(){return this.we}De(t){t.approximateByteSize()>0&&(this.we=!0,this.pe=t)}ve(){let t=Xe(),r=Xe(),n=Xe();return this.ge.forEach((s,a)=>{switch(a){case 0:t=t.add(s);break;case 2:r=r.add(s);break;case 1:n=n.add(s);break;default:Le()}}),new bu(this.pe,this.ye,t,r,n)}Ce(){this.we=!1,this.ge=gy()}Fe(t,r){this.we=!0,this.ge=this.ge.insert(t,r)}Me(t){this.we=!0,this.ge=this.ge.remove(t)}xe(){this.fe+=1}Oe(){this.fe-=1,gt(this.fe>=0)}Ne(){this.we=!0,this.ye=!0}}class FF{constructor(t){this.Le=t,this.Be=new Map,this.ke=ma(),this.qe=py(),this.Qe=new Lt(ct)}Ke(t){for(const r of t.Re)t.Ve&&t.Ve.isFoundDocument()?this.$e(r,t.Ve):this.Ue(r,t.key,t.Ve);for(const r of t.removedTargetIds)this.Ue(r,t.key,t.Ve)}We(t){this.forEachTarget(t,r=>{const n=this.Ge(r);switch(t.state){case 0:this.ze(r)&&n.De(t.resumeToken);break;case 1:n.Oe(),n.Se||n.Ce(),n.De(t.resumeToken);break;case 2:n.Oe(),n.Se||this.removeTarget(r);break;case 3:this.ze(r)&&(n.Ne(),n.De(t.resumeToken));break;case 4:this.ze(r)&&(this.je(r),n.De(t.resumeToken));break;default:Le()}})}forEachTarget(t,r){t.targetIds.length>0?t.targetIds.forEach(r):this.Be.forEach((n,s)=>{this.ze(s)&&r(s)})}He(t){const r=t.targetId,n=t.me.count,s=this.Je(r);if(s){const a=s.target;if(gp(a))if(n===0){const i=new Pe(a.path);this.Ue(r,i,Mr.newNoDocument(i,Ve.min()))}else gt(n===1);else{const i=this.Ye(r);if(i!==n){const o=this.Ze(t),l=o?this.Xe(o,t,i):1;if(l!==0){this.je(r);const c=l===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Qe=this.Qe.insert(r,c)}}}}}Ze(t){const r=t.me.unchangedNames;if(!r||!r.bits)return null;const{bits:{bitmap:n="",padding:s=0},hashCount:a=0}=r;let i,o;try{i=Gi(n).toUint8Array()}catch(l){if(l instanceof Rk)return il("Decoding the base64 bloom filter in existence filter failed ("+l.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw l}try{o=new mv(i,s,a)}catch(l){return il(l instanceof tc?"BloomFilter error: ":"Applying bloom filter failed: ",l),null}return o.Ie===0?null:o}Xe(t,r,n){return r.me.count===n-this.nt(t,r.targetId)?0:2}nt(t,r){const n=this.Le.getRemoteKeysForTarget(r);let s=0;return n.forEach(a=>{const i=this.Le.tt(),o=`projects/${i.projectId}/databases/${i.database}/documents/${a.path.canonicalString()}`;t.mightContain(o)||(this.Ue(r,a,null),s++)}),s}rt(t){const r=new Map;this.Be.forEach((a,i)=>{const o=this.Je(i);if(o){if(a.current&&gp(o.target)){const l=new Pe(o.target.path);this.ke.get(l)!==null||this.it(i,l)||this.Ue(i,l,Mr.newNoDocument(l,t))}a.be&&(r.set(i,a.ve()),a.Ce())}});let n=Xe();this.qe.forEach((a,i)=>{let o=!0;i.forEachWhile(l=>{const c=this.Je(l);return!c||c.purpose==="TargetPurposeLimboResolution"||(o=!1,!1)}),o&&(n=n.add(a))}),this.ke.forEach((a,i)=>i.setReadTime(t));const s=new Bd(t,r,this.Qe,this.ke,n);return this.ke=ma(),this.qe=py(),this.Qe=new Lt(ct),s}$e(t,r){if(!this.ze(t))return;const n=this.it(t,r.key)?2:0;this.Ge(t).Fe(r.key,n),this.ke=this.ke.insert(r.key,r),this.qe=this.qe.insert(r.key,this.st(r.key).add(t))}Ue(t,r,n){if(!this.ze(t))return;const s=this.Ge(t);this.it(t,r)?s.Fe(r,1):s.Me(r),this.qe=this.qe.insert(r,this.st(r).delete(t)),n&&(this.ke=this.ke.insert(r,n))}removeTarget(t){this.Be.delete(t)}Ye(t){const r=this.Ge(t).ve();return this.Le.getRemoteKeysForTarget(t).size+r.addedDocuments.size-r.removedDocuments.size}xe(t){this.Ge(t).xe()}Ge(t){let r=this.Be.get(t);return r||(r=new my,this.Be.set(t,r)),r}st(t){let r=this.qe.get(t);return r||(r=new wr(ct),this.qe=this.qe.insert(t,r)),r}ze(t){const r=this.Je(t)!==null;return r||be("WatchChangeAggregator","Detected inactive target",t),r}Je(t){const r=this.Be.get(t);return r&&r.Se?null:this.Le.ot(t)}je(t){this.Be.set(t,new my),this.Le.getRemoteKeysForTarget(t).forEach(r=>{this.Ue(t,r,null)})}it(t,r){return this.Le.getRemoteKeysForTarget(t).has(r)}}function py(){return new Lt(Pe.comparator)}function gy(){return new Lt(Pe.comparator)}const OF={asc:"ASCENDING",desc:"DESCENDING"},MF={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},LF={and:"AND",or:"OR"};class jF{constructor(t,r){this.databaseId=t,this.useProto3Json=r}}function _p(e,t){return e.useProto3Json||Od(t)?t:{value:t}}function $h(e,t){return e.useProto3Json?`${new Date(1e3*t.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+t.nanoseconds).slice(-9)}Z`:{seconds:""+t.seconds,nanos:t.nanoseconds}}function tS(e,t){return e.useProto3Json?t.toBase64():t.toUint8Array()}function VF(e,t){return $h(e,t.toTimestamp())}function As(e){return gt(!!e),Ve.fromTimestamp(function(r){const n=ai(r);return new ar(n.seconds,n.nanos)}(e))}function pv(e,t){return yp(e,t).canonicalString()}function yp(e,t){const r=function(s){return new Ct(["projects",s.projectId,"databases",s.database])}(e).child("documents");return t===void 0?r:r.child(t)}function rS(e){const t=Ct.fromString(e);return gt(oS(t)),t}function wp(e,t){return pv(e.databaseId,t.path)}function G0(e,t){const r=rS(t);if(r.get(1)!==e.databaseId.projectId)throw new Ne(fe.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+r.get(1)+" vs "+e.databaseId.projectId);if(r.get(3)!==e.databaseId.database)throw new Ne(fe.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+r.get(3)+" vs "+e.databaseId.database);return new Pe(sS(r))}function nS(e,t){return pv(e.databaseId,t)}function UF(e){const t=rS(e);return t.length===4?Ct.emptyPath():sS(t)}function Ep(e){return new Ct(["projects",e.databaseId.projectId,"databases",e.databaseId.database]).canonicalString()}function sS(e){return gt(e.length>4&&e.get(4)==="documents"),e.popFirst(5)}function vy(e,t,r){return{name:wp(e,t),fields:r.value.mapValue.fields}}function BF(e,t){let r;if("targetChange"in t){t.targetChange;const n=function(c){return c==="NO_CHANGE"?0:c==="ADD"?1:c==="REMOVE"?2:c==="CURRENT"?3:c==="RESET"?4:Le()}(t.targetChange.targetChangeType||"NO_CHANGE"),s=t.targetChange.targetIds||[],a=function(c,u){return c.useProto3Json?(gt(u===void 0||typeof u=="string"),Sr.fromBase64String(u||"")):(gt(u===void 0||u instanceof Buffer||u instanceof Uint8Array),Sr.fromUint8Array(u||new Uint8Array))}(e,t.targetChange.resumeToken),i=t.targetChange.cause,o=i&&function(c){const u=c.code===void 0?fe.UNKNOWN:Jk(c.code);return new Ne(u,c.message||"")}(i);r=new eS(n,s,a,o||null)}else if("documentChange"in t){t.documentChange;const n=t.documentChange;n.document,n.document.name,n.document.updateTime;const s=G0(e,n.document.name),a=As(n.document.updateTime),i=n.document.createTime?As(n.document.createTime):Ve.min(),o=new ln({mapValue:{fields:n.document.fields}}),l=Mr.newFoundDocument(s,a,i,o),c=n.targetIds||[],u=n.removedTargetIds||[];r=new th(c,u,l.key,l)}else if("documentDelete"in t){t.documentDelete;const n=t.documentDelete;n.document;const s=G0(e,n.document),a=n.readTime?As(n.readTime):Ve.min(),i=Mr.newNoDocument(s,a),o=n.removedTargetIds||[];r=new th([],o,i.key,i)}else if("documentRemove"in t){t.documentRemove;const n=t.documentRemove;n.document;const s=G0(e,n.document),a=n.removedTargetIds||[];r=new th([],a,s,null)}else{if(!("filter"in t))return Le();{t.filter;const n=t.filter;n.targetId;const{count:s=0,unchangedNames:a}=n,i=new NF(s,a),o=n.targetId;r=new Zk(o,i)}}return r}function zF(e,t){let r;if(t instanceof Nu)r={update:vy(e,t.key,t.value)};else if(t instanceof hv)r={delete:wp(e,t.key)};else if(t instanceof pi)r={update:vy(e,t.key,t.data),updateMask:QF(t.fieldMask)};else{if(!(t instanceof IF))return Le();r={verify:wp(e,t.key)}}return t.fieldTransforms.length>0&&(r.updateTransforms=t.fieldTransforms.map(n=>function(a,i){const o=i.transform;if(o instanceof ru)return{fieldPath:i.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(o instanceof nu)return{fieldPath:i.field.canonicalString(),appendMissingElements:{values:o.elements}};if(o instanceof su)return{fieldPath:i.field.canonicalString(),removeAllFromArray:{values:o.elements}};if(o instanceof au)return{fieldPath:i.field.canonicalString(),increment:o.Pe};throw Le()}(0,n))),t.precondition.isNone||(r.currentDocument=function(s,a){return a.updateTime!==void 0?{updateTime:VF(s,a.updateTime)}:a.exists!==void 0?{exists:a.exists}:Le()}(e,t.precondition)),r}function $F(e,t){return e&&e.length>0?(gt(t!==void 0),e.map(r=>function(s,a){let i=s.updateTime?As(s.updateTime):As(a);return i.isEqual(Ve.min())&&(i=As(a)),new kF(i,s.transformResults||[])}(r,t))):[]}function WF(e,t){return{documents:[nS(e,t.path)]}}function HF(e,t){const r={structuredQuery:{}},n=t.path;let s;t.collectionGroup!==null?(s=n,r.structuredQuery.from=[{collectionId:t.collectionGroup,allDescendants:!0}]):(s=n.popLast(),r.structuredQuery.from=[{collectionId:n.lastSegment()}]),r.parent=nS(e,s);const a=function(c){if(c.length!==0)return iS(us.create(c,"and"))}(t.filters);a&&(r.structuredQuery.where=a);const i=function(c){if(c.length!==0)return c.map(u=>function(m){return{field:yo(m.field),direction:qF(m.dir)}}(u))}(t.orderBy);i&&(r.structuredQuery.orderBy=i);const o=_p(e,t.limit);return o!==null&&(r.structuredQuery.limit=o),t.startAt&&(r.structuredQuery.startAt=function(c){return{before:c.inclusive,values:c.position}}(t.startAt)),t.endAt&&(r.structuredQuery.endAt=function(c){return{before:!c.inclusive,values:c.position}}(t.endAt)),{_t:r,parent:s}}function GF(e){let t=UF(e.parent);const r=e.structuredQuery,n=r.from?r.from.length:0;let s=null;if(n>0){gt(n===1);const u=r.from[0];u.allDescendants?s=u.collectionId:t=t.child(u.collectionId)}let a=[];r.where&&(a=function(h){const m=aS(h);return m instanceof us&&Dk(m)?m.getFilters():[m]}(r.where));let i=[];r.orderBy&&(i=function(h){return h.map(m=>function(x){return new zh(wo(x.field),function(w){switch(w){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(x.direction))}(m))}(r.orderBy));let o=null;r.limit&&(o=function(h){let m;return m=typeof h=="object"?h.value:h,Od(m)?null:m}(r.limit));let l=null;r.startAt&&(l=function(h){const m=!!h.before,p=h.values||[];return new Bh(p,m)}(r.startAt));let c=null;return r.endAt&&(c=function(h){const m=!h.before,p=h.values||[];return new Bh(p,m)}(r.endAt)),hF(t,s,i,a,o,"F",l,c)}function KF(e,t){const r=function(s){switch(s){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return Le()}}(t.purpose);return r==null?null:{"goog-listen-tags":r}}function aS(e){return e.unaryFilter!==void 0?function(r){switch(r.unaryFilter.op){case"IS_NAN":const n=wo(r.unaryFilter.field);return Zt.create(n,"==",{doubleValue:NaN});case"IS_NULL":const s=wo(r.unaryFilter.field);return Zt.create(s,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const a=wo(r.unaryFilter.field);return Zt.create(a,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const i=wo(r.unaryFilter.field);return Zt.create(i,"!=",{nullValue:"NULL_VALUE"});default:return Le()}}(e):e.fieldFilter!==void 0?function(r){return Zt.create(wo(r.fieldFilter.field),function(s){switch(s){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return Le()}}(r.fieldFilter.op),r.fieldFilter.value)}(e):e.compositeFilter!==void 0?function(r){return us.create(r.compositeFilter.filters.map(n=>aS(n)),function(s){switch(s){case"AND":return"and";case"OR":return"or";default:return Le()}}(r.compositeFilter.op))}(e):Le()}function qF(e){return OF[e]}function XF(e){return MF[e]}function YF(e){return LF[e]}function yo(e){return{fieldPath:e.canonicalString()}}function wo(e){return _r.fromServerFormat(e.fieldPath)}function iS(e){return e instanceof Zt?function(r){if(r.op==="=="){if(ny(r.value))return{unaryFilter:{field:yo(r.field),op:"IS_NAN"}};if(ry(r.value))return{unaryFilter:{field:yo(r.field),op:"IS_NULL"}}}else if(r.op==="!="){if(ny(r.value))return{unaryFilter:{field:yo(r.field),op:"IS_NOT_NAN"}};if(ry(r.value))return{unaryFilter:{field:yo(r.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:yo(r.field),op:XF(r.op),value:r.value}}}(e):e instanceof us?function(r){const n=r.getFilters().map(s=>iS(s));return n.length===1?n[0]:{compositeFilter:{op:YF(r.op),filters:n}}}(e):Le()}function QF(e){const t=[];return e.fields.forEach(r=>t.push(r.canonicalString())),{fieldPaths:t}}function oS(e){return e.length>=4&&e.get(0)==="projects"&&e.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ua{constructor(t,r,n,s,a=Ve.min(),i=Ve.min(),o=Sr.EMPTY_BYTE_STRING,l=null){this.target=t,this.targetId=r,this.purpose=n,this.sequenceNumber=s,this.snapshotVersion=a,this.lastLimboFreeSnapshotVersion=i,this.resumeToken=o,this.expectedCount=l}withSequenceNumber(t){return new Ua(this.target,this.targetId,this.purpose,t,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(t,r){return new Ua(this.target,this.targetId,this.purpose,this.sequenceNumber,r,this.lastLimboFreeSnapshotVersion,t,null)}withExpectedCount(t){return new Ua(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,t)}withLastLimboFreeSnapshotVersion(t){return new Ua(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,t,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JF{constructor(t){this.ct=t}}function ZF(e){const t=GF({parent:e.parent,structuredQuery:e.structuredQuery});return e.limitType==="LAST"?xp(t,t.limit,"L"):t}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eO{constructor(){this.un=new tO}addToCollectionParentIndex(t,r){return this.un.add(r),ge.resolve()}getCollectionParents(t,r){return ge.resolve(this.un.getEntries(r))}addFieldIndex(t,r){return ge.resolve()}deleteFieldIndex(t,r){return ge.resolve()}deleteAllFieldIndexes(t){return ge.resolve()}createTargetIndexes(t,r){return ge.resolve()}getDocumentsMatchingTarget(t,r){return ge.resolve(null)}getIndexType(t,r){return ge.resolve(0)}getFieldIndexes(t,r){return ge.resolve([])}getNextCollectionGroupToUpdate(t){return ge.resolve(null)}getMinOffset(t,r){return ge.resolve(si.min())}getMinOffsetFromCollectionGroup(t,r){return ge.resolve(si.min())}updateCollectionGroup(t,r,n){return ge.resolve()}updateIndexEntries(t,r){return ge.resolve()}}class tO{constructor(){this.index={}}add(t){const r=t.lastSegment(),n=t.popLast(),s=this.index[r]||new wr(Ct.comparator),a=!s.has(n);return this.index[r]=s.add(n),a}has(t){const r=t.lastSegment(),n=t.popLast(),s=this.index[r];return s&&s.has(n)}getEntries(t){return(this.index[t]||new wr(Ct.comparator)).toArray()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ul{constructor(t){this.Ln=t}next(){return this.Ln+=2,this.Ln}static Bn(){return new ul(0)}static kn(){return new ul(-1)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rO{constructor(){this.changes=new El(t=>t.toString(),(t,r)=>t.isEqual(r)),this.changesApplied=!1}addEntry(t){this.assertNotApplied(),this.changes.set(t.key,t)}removeEntry(t,r){this.assertNotApplied(),this.changes.set(t,Mr.newInvalidDocument(t).setReadTime(r))}getEntry(t,r){this.assertNotApplied();const n=this.changes.get(r);return n!==void 0?ge.resolve(n):this.getFromCache(t,r)}getEntries(t,r){return this.getAllFromCache(t,r)}apply(t){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(t)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nO{constructor(t,r){this.overlayedDocument=t,this.mutatedFields=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sO{constructor(t,r,n,s){this.remoteDocumentCache=t,this.mutationQueue=r,this.documentOverlayCache=n,this.indexManager=s}getDocument(t,r){let n=null;return this.documentOverlayCache.getOverlay(t,r).next(s=>(n=s,this.remoteDocumentCache.getEntry(t,r))).next(s=>(n!==null&&yc(n.mutation,s,En.empty(),ar.now()),s))}getDocuments(t,r){return this.remoteDocumentCache.getEntries(t,r).next(n=>this.getLocalViewOfDocuments(t,n,Xe()).next(()=>n))}getLocalViewOfDocuments(t,r,n=Xe()){const s=Ni();return this.populateOverlays(t,s,r).next(()=>this.computeViews(t,r,s,n).next(a=>{let i=ec();return a.forEach((o,l)=>{i=i.insert(o,l.overlayedDocument)}),i}))}getOverlayedDocuments(t,r){const n=Ni();return this.populateOverlays(t,n,r).next(()=>this.computeViews(t,r,n,Xe()))}populateOverlays(t,r,n){const s=[];return n.forEach(a=>{r.has(a)||s.push(a)}),this.documentOverlayCache.getOverlays(t,s).next(a=>{a.forEach((i,o)=>{r.set(i,o)})})}computeViews(t,r,n,s){let a=ma();const i=_c(),o=function(){return _c()}();return r.forEach((l,c)=>{const u=n.get(c.key);s.has(c.key)&&(u===void 0||u.mutation instanceof pi)?a=a.insert(c.key,c):u!==void 0?(i.set(c.key,u.mutation.getFieldMask()),yc(u.mutation,c,u.mutation.getFieldMask(),ar.now())):i.set(c.key,En.empty())}),this.recalculateAndSaveOverlays(t,a).next(l=>(l.forEach((c,u)=>i.set(c,u)),r.forEach((c,u)=>{var h;return o.set(c,new nO(u,(h=i.get(c))!==null&&h!==void 0?h:null))}),o))}recalculateAndSaveOverlays(t,r){const n=_c();let s=new Lt((i,o)=>i-o),a=Xe();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(t,r).next(i=>{for(const o of i)o.keys().forEach(l=>{const c=r.get(l);if(c===null)return;let u=n.get(l)||En.empty();u=o.applyToLocalView(c,u),n.set(l,u);const h=(s.get(o.batchId)||Xe()).add(l);s=s.insert(o.batchId,h)})}).next(()=>{const i=[],o=s.getReverseIterator();for(;o.hasNext();){const l=o.getNext(),c=l.key,u=l.value,h=zk();u.forEach(m=>{if(!a.has(m)){const p=Yk(r.get(m),n.get(m));p!==null&&h.set(m,p),a=a.add(m)}}),i.push(this.documentOverlayCache.saveOverlays(t,c,h))}return ge.waitFor(i)}).next(()=>n)}recalculateAndSaveOverlaysForDocumentKeys(t,r){return this.remoteDocumentCache.getEntries(t,r).next(n=>this.recalculateAndSaveOverlays(t,n))}getDocumentsMatchingQuery(t,r,n,s){return function(i){return Pe.isDocumentKey(i.path)&&i.collectionGroup===null&&i.filters.length===0}(r)?this.getDocumentsMatchingDocumentQuery(t,r.path):Lk(r)?this.getDocumentsMatchingCollectionGroupQuery(t,r,n,s):this.getDocumentsMatchingCollectionQuery(t,r,n,s)}getNextDocuments(t,r,n,s){return this.remoteDocumentCache.getAllFromCollectionGroup(t,r,n,s).next(a=>{const i=s-a.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(t,r,n.largestBatchId,s-a.size):ge.resolve(Ni());let o=-1,l=a;return i.next(c=>ge.forEach(c,(u,h)=>(o<h.largestBatchId&&(o=h.largestBatchId),a.get(u)?ge.resolve():this.remoteDocumentCache.getEntry(t,u).next(m=>{l=l.insert(u,m)}))).next(()=>this.populateOverlays(t,c,a)).next(()=>this.computeViews(t,l,c,Xe())).next(u=>({batchId:o,changes:Bk(u)})))})}getDocumentsMatchingDocumentQuery(t,r){return this.getDocument(t,new Pe(r)).next(n=>{let s=ec();return n.isFoundDocument()&&(s=s.insert(n.key,n)),s})}getDocumentsMatchingCollectionGroupQuery(t,r,n,s){const a=r.collectionGroup;let i=ec();return this.indexManager.getCollectionParents(t,a).next(o=>ge.forEach(o,l=>{const c=function(h,m){return new Ru(m,null,h.explicitOrderBy.slice(),h.filters.slice(),h.limit,h.limitType,h.startAt,h.endAt)}(r,l.child(a));return this.getDocumentsMatchingCollectionQuery(t,c,n,s).next(u=>{u.forEach((h,m)=>{i=i.insert(h,m)})})}).next(()=>i))}getDocumentsMatchingCollectionQuery(t,r,n,s){let a;return this.documentOverlayCache.getOverlaysForCollection(t,r.path,n.largestBatchId).next(i=>(a=i,this.remoteDocumentCache.getDocumentsMatchingQuery(t,r,n,a,s))).next(i=>{a.forEach((l,c)=>{const u=c.getKey();i.get(u)===null&&(i=i.insert(u,Mr.newInvalidDocument(u)))});let o=ec();return i.forEach((l,c)=>{const u=a.get(l);u!==void 0&&yc(u.mutation,c,En.empty(),ar.now()),jd(r,c)&&(o=o.insert(l,c))}),o})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aO{constructor(t){this.serializer=t,this.hr=new Map,this.Pr=new Map}getBundleMetadata(t,r){return ge.resolve(this.hr.get(r))}saveBundleMetadata(t,r){return this.hr.set(r.id,function(s){return{id:s.id,version:s.version,createTime:As(s.createTime)}}(r)),ge.resolve()}getNamedQuery(t,r){return ge.resolve(this.Pr.get(r))}saveNamedQuery(t,r){return this.Pr.set(r.name,function(s){return{name:s.name,query:ZF(s.bundledQuery),readTime:As(s.readTime)}}(r)),ge.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iO{constructor(){this.overlays=new Lt(Pe.comparator),this.Ir=new Map}getOverlay(t,r){return ge.resolve(this.overlays.get(r))}getOverlays(t,r){const n=Ni();return ge.forEach(r,s=>this.getOverlay(t,s).next(a=>{a!==null&&n.set(s,a)})).next(()=>n)}saveOverlays(t,r,n){return n.forEach((s,a)=>{this.ht(t,r,a)}),ge.resolve()}removeOverlaysForBatchId(t,r,n){const s=this.Ir.get(n);return s!==void 0&&(s.forEach(a=>this.overlays=this.overlays.remove(a)),this.Ir.delete(n)),ge.resolve()}getOverlaysForCollection(t,r,n){const s=Ni(),a=r.length+1,i=new Pe(r.child("")),o=this.overlays.getIteratorFrom(i);for(;o.hasNext();){const l=o.getNext().value,c=l.getKey();if(!r.isPrefixOf(c.path))break;c.path.length===a&&l.largestBatchId>n&&s.set(l.getKey(),l)}return ge.resolve(s)}getOverlaysForCollectionGroup(t,r,n,s){let a=new Lt((c,u)=>c-u);const i=this.overlays.getIterator();for(;i.hasNext();){const c=i.getNext().value;if(c.getKey().getCollectionGroup()===r&&c.largestBatchId>n){let u=a.get(c.largestBatchId);u===null&&(u=Ni(),a=a.insert(c.largestBatchId,u)),u.set(c.getKey(),c)}}const o=Ni(),l=a.getIterator();for(;l.hasNext()&&(l.getNext().value.forEach((c,u)=>o.set(c,u)),!(o.size()>=s)););return ge.resolve(o)}ht(t,r,n){const s=this.overlays.get(n.key);if(s!==null){const i=this.Ir.get(s.largestBatchId).delete(n.key);this.Ir.set(s.largestBatchId,i)}this.overlays=this.overlays.insert(n.key,new RF(r,n));let a=this.Ir.get(r);a===void 0&&(a=Xe(),this.Ir.set(r,a)),this.Ir.set(r,a.add(n.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oO{constructor(){this.sessionToken=Sr.EMPTY_BYTE_STRING}getSessionToken(t){return ge.resolve(this.sessionToken)}setSessionToken(t,r){return this.sessionToken=r,ge.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gv{constructor(){this.Tr=new wr(cr.Er),this.dr=new wr(cr.Ar)}isEmpty(){return this.Tr.isEmpty()}addReference(t,r){const n=new cr(t,r);this.Tr=this.Tr.add(n),this.dr=this.dr.add(n)}Rr(t,r){t.forEach(n=>this.addReference(n,r))}removeReference(t,r){this.Vr(new cr(t,r))}mr(t,r){t.forEach(n=>this.removeReference(n,r))}gr(t){const r=new Pe(new Ct([])),n=new cr(r,t),s=new cr(r,t+1),a=[];return this.dr.forEachInRange([n,s],i=>{this.Vr(i),a.push(i.key)}),a}pr(){this.Tr.forEach(t=>this.Vr(t))}Vr(t){this.Tr=this.Tr.delete(t),this.dr=this.dr.delete(t)}yr(t){const r=new Pe(new Ct([])),n=new cr(r,t),s=new cr(r,t+1);let a=Xe();return this.dr.forEachInRange([n,s],i=>{a=a.add(i.key)}),a}containsKey(t){const r=new cr(t,0),n=this.Tr.firstAfterOrEqual(r);return n!==null&&t.isEqual(n.key)}}class cr{constructor(t,r){this.key=t,this.wr=r}static Er(t,r){return Pe.comparator(t.key,r.key)||ct(t.wr,r.wr)}static Ar(t,r){return ct(t.wr,r.wr)||Pe.comparator(t.key,r.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lO{constructor(t,r){this.indexManager=t,this.referenceDelegate=r,this.mutationQueue=[],this.Sr=1,this.br=new wr(cr.Er)}checkEmpty(t){return ge.resolve(this.mutationQueue.length===0)}addMutationBatch(t,r,n,s){const a=this.Sr;this.Sr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const i=new CF(a,r,n,s);this.mutationQueue.push(i);for(const o of s)this.br=this.br.add(new cr(o.key,a)),this.indexManager.addToCollectionParentIndex(t,o.key.path.popLast());return ge.resolve(i)}lookupMutationBatch(t,r){return ge.resolve(this.Dr(r))}getNextMutationBatchAfterBatchId(t,r){const n=r+1,s=this.vr(n),a=s<0?0:s;return ge.resolve(this.mutationQueue.length>a?this.mutationQueue[a]:null)}getHighestUnacknowledgedBatchId(){return ge.resolve(this.mutationQueue.length===0?-1:this.Sr-1)}getAllMutationBatches(t){return ge.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(t,r){const n=new cr(r,0),s=new cr(r,Number.POSITIVE_INFINITY),a=[];return this.br.forEachInRange([n,s],i=>{const o=this.Dr(i.wr);a.push(o)}),ge.resolve(a)}getAllMutationBatchesAffectingDocumentKeys(t,r){let n=new wr(ct);return r.forEach(s=>{const a=new cr(s,0),i=new cr(s,Number.POSITIVE_INFINITY);this.br.forEachInRange([a,i],o=>{n=n.add(o.wr)})}),ge.resolve(this.Cr(n))}getAllMutationBatchesAffectingQuery(t,r){const n=r.path,s=n.length+1;let a=n;Pe.isDocumentKey(a)||(a=a.child(""));const i=new cr(new Pe(a),0);let o=new wr(ct);return this.br.forEachWhile(l=>{const c=l.key.path;return!!n.isPrefixOf(c)&&(c.length===s&&(o=o.add(l.wr)),!0)},i),ge.resolve(this.Cr(o))}Cr(t){const r=[];return t.forEach(n=>{const s=this.Dr(n);s!==null&&r.push(s)}),r}removeMutationBatch(t,r){gt(this.Fr(r.batchId,"removed")===0),this.mutationQueue.shift();let n=this.br;return ge.forEach(r.mutations,s=>{const a=new cr(s.key,r.batchId);return n=n.delete(a),this.referenceDelegate.markPotentiallyOrphaned(t,s.key)}).next(()=>{this.br=n})}On(t){}containsKey(t,r){const n=new cr(r,0),s=this.br.firstAfterOrEqual(n);return ge.resolve(r.isEqual(s&&s.key))}performConsistencyCheck(t){return this.mutationQueue.length,ge.resolve()}Fr(t,r){return this.vr(t)}vr(t){return this.mutationQueue.length===0?0:t-this.mutationQueue[0].batchId}Dr(t){const r=this.vr(t);return r<0||r>=this.mutationQueue.length?null:this.mutationQueue[r]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cO{constructor(t){this.Mr=t,this.docs=function(){return new Lt(Pe.comparator)}(),this.size=0}setIndexManager(t){this.indexManager=t}addEntry(t,r){const n=r.key,s=this.docs.get(n),a=s?s.size:0,i=this.Mr(r);return this.docs=this.docs.insert(n,{document:r.mutableCopy(),size:i}),this.size+=i-a,this.indexManager.addToCollectionParentIndex(t,n.path.popLast())}removeEntry(t){const r=this.docs.get(t);r&&(this.docs=this.docs.remove(t),this.size-=r.size)}getEntry(t,r){const n=this.docs.get(r);return ge.resolve(n?n.document.mutableCopy():Mr.newInvalidDocument(r))}getEntries(t,r){let n=ma();return r.forEach(s=>{const a=this.docs.get(s);n=n.insert(s,a?a.document.mutableCopy():Mr.newInvalidDocument(s))}),ge.resolve(n)}getDocumentsMatchingQuery(t,r,n,s){let a=ma();const i=r.path,o=new Pe(i.child("")),l=this.docs.getIteratorFrom(o);for(;l.hasNext();){const{key:c,value:{document:u}}=l.getNext();if(!i.isPrefixOf(c.path))break;c.path.length>i.length+1||K3(G3(u),n)<=0||(s.has(u.key)||jd(r,u))&&(a=a.insert(u.key,u.mutableCopy()))}return ge.resolve(a)}getAllFromCollectionGroup(t,r,n,s){Le()}Or(t,r){return ge.forEach(this.docs,n=>r(n))}newChangeBuffer(t){return new uO(this)}getSize(t){return ge.resolve(this.size)}}class uO extends rO{constructor(t){super(),this.cr=t}applyChanges(t){const r=[];return this.changes.forEach((n,s)=>{s.isValidDocument()?r.push(this.cr.addEntry(t,s)):this.cr.removeEntry(n)}),ge.waitFor(r)}getFromCache(t,r){return this.cr.getEntry(t,r)}getAllFromCache(t,r){return this.cr.getEntries(t,r)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fO{constructor(t){this.persistence=t,this.Nr=new El(r=>cv(r),uv),this.lastRemoteSnapshotVersion=Ve.min(),this.highestTargetId=0,this.Lr=0,this.Br=new gv,this.targetCount=0,this.kr=ul.Bn()}forEachTarget(t,r){return this.Nr.forEach((n,s)=>r(s)),ge.resolve()}getLastRemoteSnapshotVersion(t){return ge.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(t){return ge.resolve(this.Lr)}allocateTargetId(t){return this.highestTargetId=this.kr.next(),ge.resolve(this.highestTargetId)}setTargetsMetadata(t,r,n){return n&&(this.lastRemoteSnapshotVersion=n),r>this.Lr&&(this.Lr=r),ge.resolve()}Kn(t){this.Nr.set(t.target,t);const r=t.targetId;r>this.highestTargetId&&(this.kr=new ul(r),this.highestTargetId=r),t.sequenceNumber>this.Lr&&(this.Lr=t.sequenceNumber)}addTargetData(t,r){return this.Kn(r),this.targetCount+=1,ge.resolve()}updateTargetData(t,r){return this.Kn(r),ge.resolve()}removeTargetData(t,r){return this.Nr.delete(r.target),this.Br.gr(r.targetId),this.targetCount-=1,ge.resolve()}removeTargets(t,r,n){let s=0;const a=[];return this.Nr.forEach((i,o)=>{o.sequenceNumber<=r&&n.get(o.targetId)===null&&(this.Nr.delete(i),a.push(this.removeMatchingKeysForTargetId(t,o.targetId)),s++)}),ge.waitFor(a).next(()=>s)}getTargetCount(t){return ge.resolve(this.targetCount)}getTargetData(t,r){const n=this.Nr.get(r)||null;return ge.resolve(n)}addMatchingKeys(t,r,n){return this.Br.Rr(r,n),ge.resolve()}removeMatchingKeys(t,r,n){this.Br.mr(r,n);const s=this.persistence.referenceDelegate,a=[];return s&&r.forEach(i=>{a.push(s.markPotentiallyOrphaned(t,i))}),ge.waitFor(a)}removeMatchingKeysForTargetId(t,r){return this.Br.gr(r),ge.resolve()}getMatchingKeysForTargetId(t,r){const n=this.Br.yr(r);return ge.resolve(n)}containsKey(t,r){return ge.resolve(this.Br.containsKey(r))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hO{constructor(t,r){this.qr={},this.overlays={},this.Qr=new av(0),this.Kr=!1,this.Kr=!0,this.$r=new oO,this.referenceDelegate=t(this),this.Ur=new fO(this),this.indexManager=new eO,this.remoteDocumentCache=function(s){return new cO(s)}(n=>this.referenceDelegate.Wr(n)),this.serializer=new JF(r),this.Gr=new aO(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.Kr=!1,Promise.resolve()}get started(){return this.Kr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(t){return this.indexManager}getDocumentOverlayCache(t){let r=this.overlays[t.toKey()];return r||(r=new iO,this.overlays[t.toKey()]=r),r}getMutationQueue(t,r){let n=this.qr[t.toKey()];return n||(n=new lO(r,this.referenceDelegate),this.qr[t.toKey()]=n),n}getGlobalsCache(){return this.$r}getTargetCache(){return this.Ur}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Gr}runTransaction(t,r,n){be("MemoryPersistence","Starting transaction:",t);const s=new dO(this.Qr.next());return this.referenceDelegate.zr(),n(s).next(a=>this.referenceDelegate.jr(s).next(()=>a)).toPromise().then(a=>(s.raiseOnCommittedEvent(),a))}Hr(t,r){return ge.or(Object.values(this.qr).map(n=>()=>n.containsKey(t,r)))}}class dO extends X3{constructor(t){super(),this.currentSequenceNumber=t}}class vv{constructor(t){this.persistence=t,this.Jr=new gv,this.Yr=null}static Zr(t){return new vv(t)}get Xr(){if(this.Yr)return this.Yr;throw Le()}addReference(t,r,n){return this.Jr.addReference(n,r),this.Xr.delete(n.toString()),ge.resolve()}removeReference(t,r,n){return this.Jr.removeReference(n,r),this.Xr.add(n.toString()),ge.resolve()}markPotentiallyOrphaned(t,r){return this.Xr.add(r.toString()),ge.resolve()}removeTarget(t,r){this.Jr.gr(r.targetId).forEach(s=>this.Xr.add(s.toString()));const n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(t,r.targetId).next(s=>{s.forEach(a=>this.Xr.add(a.toString()))}).next(()=>n.removeTargetData(t,r))}zr(){this.Yr=new Set}jr(t){const r=this.persistence.getRemoteDocumentCache().newChangeBuffer();return ge.forEach(this.Xr,n=>{const s=Pe.fromPath(n);return this.ei(t,s).next(a=>{a||r.removeEntry(s,Ve.min())})}).next(()=>(this.Yr=null,r.apply(t)))}updateLimboDocument(t,r){return this.ei(t,r).next(n=>{n?this.Xr.delete(r.toString()):this.Xr.add(r.toString())})}Wr(t){return 0}ei(t,r){return ge.or([()=>ge.resolve(this.Jr.containsKey(r)),()=>this.persistence.getTargetCache().containsKey(t,r),()=>this.persistence.Hr(t,r)])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xv{constructor(t,r,n,s){this.targetId=t,this.fromCache=r,this.$i=n,this.Ui=s}static Wi(t,r){let n=Xe(),s=Xe();for(const a of r.docChanges)switch(a.type){case 0:n=n.add(a.doc.key);break;case 1:s=s.add(a.doc.key)}return new xv(t,r.fromCache,n,s)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mO{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(t){this._documentReadCount+=t}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pO{constructor(){this.Gi=!1,this.zi=!1,this.ji=100,this.Hi=function(){return Eb()?8:Y3(zr())>0?6:4}()}initialize(t,r){this.Ji=t,this.indexManager=r,this.Gi=!0}getDocumentsMatchingQuery(t,r,n,s){const a={result:null};return this.Yi(t,r).next(i=>{a.result=i}).next(()=>{if(!a.result)return this.Zi(t,r,s,n).next(i=>{a.result=i})}).next(()=>{if(a.result)return;const i=new mO;return this.Xi(t,r,i).next(o=>{if(a.result=o,this.zi)return this.es(t,r,i,o.size)})}).next(()=>a.result)}es(t,r,n,s){return n.documentReadCount<this.ji?(Kl()<=Ye.DEBUG&&be("QueryEngine","SDK will not create cache indexes for query:",_o(r),"since it only creates cache indexes for collection contains","more than or equal to",this.ji,"documents"),ge.resolve()):(Kl()<=Ye.DEBUG&&be("QueryEngine","Query:",_o(r),"scans",n.documentReadCount,"local documents and returns",s,"documents as results."),n.documentReadCount>this.Hi*s?(Kl()<=Ye.DEBUG&&be("QueryEngine","The SDK decides to create cache indexes for query:",_o(r),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(t,Ss(r))):ge.resolve())}Yi(t,r){if(oy(r))return ge.resolve(null);let n=Ss(r);return this.indexManager.getIndexType(t,n).next(s=>s===0?null:(r.limit!==null&&s===1&&(r=xp(r,null,"F"),n=Ss(r)),this.indexManager.getDocumentsMatchingTarget(t,n).next(a=>{const i=Xe(...a);return this.Ji.getDocuments(t,i).next(o=>this.indexManager.getMinOffset(t,n).next(l=>{const c=this.ts(r,o);return this.ns(r,c,i,l.readTime)?this.Yi(t,xp(r,null,"F")):this.rs(t,c,r,l)}))})))}Zi(t,r,n,s){return oy(r)||s.isEqual(Ve.min())?ge.resolve(null):this.Ji.getDocuments(t,n).next(a=>{const i=this.ts(r,a);return this.ns(r,i,n,s)?ge.resolve(null):(Kl()<=Ye.DEBUG&&be("QueryEngine","Re-using previous result from %s to execute query: %s",s.toString(),_o(r)),this.rs(t,i,r,H3(s,-1)).next(o=>o))})}ts(t,r){let n=new wr(Vk(t));return r.forEach((s,a)=>{jd(t,a)&&(n=n.add(a))}),n}ns(t,r,n,s){if(t.limit===null)return!1;if(n.size!==r.size)return!0;const a=t.limitType==="F"?r.last():r.first();return!!a&&(a.hasPendingWrites||a.version.compareTo(s)>0)}Xi(t,r,n){return Kl()<=Ye.DEBUG&&be("QueryEngine","Using full collection scan to execute query:",_o(r)),this.Ji.getDocumentsMatchingQuery(t,r,si.min(),n)}rs(t,r,n,s){return this.Ji.getDocumentsMatchingQuery(t,n,s).next(a=>(r.forEach(i=>{a=a.insert(i.key,i)}),a))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gO{constructor(t,r,n,s){this.persistence=t,this.ss=r,this.serializer=s,this.os=new Lt(ct),this._s=new El(a=>cv(a),uv),this.us=new Map,this.cs=t.getRemoteDocumentCache(),this.Ur=t.getTargetCache(),this.Gr=t.getBundleCache(),this.ls(n)}ls(t){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(t),this.indexManager=this.persistence.getIndexManager(t),this.mutationQueue=this.persistence.getMutationQueue(t,this.indexManager),this.localDocuments=new sO(this.cs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.cs.setIndexManager(this.indexManager),this.ss.initialize(this.localDocuments,this.indexManager)}collectGarbage(t){return this.persistence.runTransaction("Collect garbage","readwrite-primary",r=>t.collect(r,this.os))}}function vO(e,t,r,n){return new gO(e,t,r,n)}async function lS(e,t){const r=Be(e);return await r.persistence.runTransaction("Handle user change","readonly",n=>{let s;return r.mutationQueue.getAllMutationBatches(n).next(a=>(s=a,r.ls(t),r.mutationQueue.getAllMutationBatches(n))).next(a=>{const i=[],o=[];let l=Xe();for(const c of s){i.push(c.batchId);for(const u of c.mutations)l=l.add(u.key)}for(const c of a){o.push(c.batchId);for(const u of c.mutations)l=l.add(u.key)}return r.localDocuments.getDocuments(n,l).next(c=>({hs:c,removedBatchIds:i,addedBatchIds:o}))})})}function xO(e,t){const r=Be(e);return r.persistence.runTransaction("Acknowledge batch","readwrite-primary",n=>{const s=t.batch.keys(),a=r.cs.newChangeBuffer({trackRemovals:!0});return function(o,l,c,u){const h=c.batch,m=h.keys();let p=ge.resolve();return m.forEach(x=>{p=p.next(()=>u.getEntry(l,x)).next(v=>{const w=c.docVersions.get(x);gt(w!==null),v.version.compareTo(w)<0&&(h.applyToRemoteDocument(v,c),v.isValidDocument()&&(v.setReadTime(c.commitVersion),u.addEntry(v)))})}),p.next(()=>o.mutationQueue.removeMutationBatch(l,h))}(r,n,t,a).next(()=>a.apply(n)).next(()=>r.mutationQueue.performConsistencyCheck(n)).next(()=>r.documentOverlayCache.removeOverlaysForBatchId(n,s,t.batch.batchId)).next(()=>r.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(n,function(o){let l=Xe();for(let c=0;c<o.mutationResults.length;++c)o.mutationResults[c].transformResults.length>0&&(l=l.add(o.batch.mutations[c].key));return l}(t))).next(()=>r.localDocuments.getDocuments(n,s))})}function cS(e){const t=Be(e);return t.persistence.runTransaction("Get last remote snapshot version","readonly",r=>t.Ur.getLastRemoteSnapshotVersion(r))}function _O(e,t){const r=Be(e),n=t.snapshotVersion;let s=r.os;return r.persistence.runTransaction("Apply remote event","readwrite-primary",a=>{const i=r.cs.newChangeBuffer({trackRemovals:!0});s=r.os;const o=[];t.targetChanges.forEach((u,h)=>{const m=s.get(h);if(!m)return;o.push(r.Ur.removeMatchingKeys(a,u.removedDocuments,h).next(()=>r.Ur.addMatchingKeys(a,u.addedDocuments,h)));let p=m.withSequenceNumber(a.currentSequenceNumber);t.targetMismatches.get(h)!==null?p=p.withResumeToken(Sr.EMPTY_BYTE_STRING,Ve.min()).withLastLimboFreeSnapshotVersion(Ve.min()):u.resumeToken.approximateByteSize()>0&&(p=p.withResumeToken(u.resumeToken,n)),s=s.insert(h,p),function(v,w,k){return v.resumeToken.approximateByteSize()===0||w.snapshotVersion.toMicroseconds()-v.snapshotVersion.toMicroseconds()>=3e8?!0:k.addedDocuments.size+k.modifiedDocuments.size+k.removedDocuments.size>0}(m,p,u)&&o.push(r.Ur.updateTargetData(a,p))});let l=ma(),c=Xe();if(t.documentUpdates.forEach(u=>{t.resolvedLimboDocuments.has(u)&&o.push(r.persistence.referenceDelegate.updateLimboDocument(a,u))}),o.push(yO(a,i,t.documentUpdates).next(u=>{l=u.Ps,c=u.Is})),!n.isEqual(Ve.min())){const u=r.Ur.getLastRemoteSnapshotVersion(a).next(h=>r.Ur.setTargetsMetadata(a,a.currentSequenceNumber,n));o.push(u)}return ge.waitFor(o).next(()=>i.apply(a)).next(()=>r.localDocuments.getLocalViewOfDocuments(a,l,c)).next(()=>l)}).then(a=>(r.os=s,a))}function yO(e,t,r){let n=Xe(),s=Xe();return r.forEach(a=>n=n.add(a)),t.getEntries(e,n).next(a=>{let i=ma();return r.forEach((o,l)=>{const c=a.get(o);l.isFoundDocument()!==c.isFoundDocument()&&(s=s.add(o)),l.isNoDocument()&&l.version.isEqual(Ve.min())?(t.removeEntry(o,l.readTime),i=i.insert(o,l)):!c.isValidDocument()||l.version.compareTo(c.version)>0||l.version.compareTo(c.version)===0&&c.hasPendingWrites?(t.addEntry(l),i=i.insert(o,l)):be("LocalStore","Ignoring outdated watch update for ",o,". Current version:",c.version," Watch version:",l.version)}),{Ps:i,Is:s}})}function wO(e,t){const r=Be(e);return r.persistence.runTransaction("Get next mutation batch","readonly",n=>(t===void 0&&(t=-1),r.mutationQueue.getNextMutationBatchAfterBatchId(n,t)))}function EO(e,t){const r=Be(e);return r.persistence.runTransaction("Allocate target","readwrite",n=>{let s;return r.Ur.getTargetData(n,t).next(a=>a?(s=a,ge.resolve(s)):r.Ur.allocateTargetId(n).next(i=>(s=new Ua(t,i,"TargetPurposeListen",n.currentSequenceNumber),r.Ur.addTargetData(n,s).next(()=>s))))}).then(n=>{const s=r.os.get(n.targetId);return(s===null||n.snapshotVersion.compareTo(s.snapshotVersion)>0)&&(r.os=r.os.insert(n.targetId,n),r._s.set(t,n.targetId)),n})}async function Tp(e,t,r){const n=Be(e),s=n.os.get(t),a=r?"readwrite":"readwrite-primary";try{r||await n.persistence.runTransaction("Release target",a,i=>n.persistence.referenceDelegate.removeTarget(i,s))}catch(i){if(!Cu(i))throw i;be("LocalStore",`Failed to update sequence numbers for target ${t}: ${i}`)}n.os=n.os.remove(t),n._s.delete(s.target)}function xy(e,t,r){const n=Be(e);let s=Ve.min(),a=Xe();return n.persistence.runTransaction("Execute query","readwrite",i=>function(l,c,u){const h=Be(l),m=h._s.get(u);return m!==void 0?ge.resolve(h.os.get(m)):h.Ur.getTargetData(c,u)}(n,i,Ss(t)).next(o=>{if(o)return s=o.lastLimboFreeSnapshotVersion,n.Ur.getMatchingKeysForTargetId(i,o.targetId).next(l=>{a=l})}).next(()=>n.ss.getDocumentsMatchingQuery(i,t,r?s:Ve.min(),r?a:Xe())).next(o=>(TO(n,mF(t),o),{documents:o,Ts:a})))}function TO(e,t,r){let n=e.us.get(t)||Ve.min();r.forEach((s,a)=>{a.readTime.compareTo(n)>0&&(n=a.readTime)}),e.us.set(t,n)}class _y{constructor(){this.activeTargetIds=yF()}fs(t){this.activeTargetIds=this.activeTargetIds.add(t)}gs(t){this.activeTargetIds=this.activeTargetIds.delete(t)}Vs(){const t={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(t)}}class kO{constructor(){this.so=new _y,this.oo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(t){}updateMutationState(t,r,n){}addLocalQueryTarget(t,r=!0){return r&&this.so.fs(t),this.oo[t]||"not-current"}updateQueryState(t,r,n){this.oo[t]=r}removeLocalQueryTarget(t){this.so.gs(t)}isLocalQueryTarget(t){return this.so.activeTargetIds.has(t)}clearQueryState(t){delete this.oo[t]}getAllActiveQueryTargets(){return this.so.activeTargetIds}isActiveQueryTarget(t){return this.so.activeTargetIds.has(t)}start(){return this.so=new _y,Promise.resolve()}handleUserChange(t,r,n){}setOnlineState(t){}shutdown(){}writeSequenceNumber(t){}notifyBundleLoaded(t){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SO{_o(t){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yy{constructor(){this.ao=()=>this.uo(),this.co=()=>this.lo(),this.ho=[],this.Po()}_o(t){this.ho.push(t)}shutdown(){window.removeEventListener("online",this.ao),window.removeEventListener("offline",this.co)}Po(){window.addEventListener("online",this.ao),window.addEventListener("offline",this.co)}uo(){be("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const t of this.ho)t(0)}lo(){be("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const t of this.ho)t(1)}static D(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let kf=null;function K0(){return kf===null?kf=function(){return 268435456+Math.round(2147483648*Math.random())}():kf++,"0x"+kf.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const AO={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class IO{constructor(t){this.Io=t.Io,this.To=t.To}Eo(t){this.Ao=t}Ro(t){this.Vo=t}mo(t){this.fo=t}onMessage(t){this.po=t}close(){this.To()}send(t){this.Io(t)}yo(){this.Ao()}wo(){this.Vo()}So(t){this.fo(t)}bo(t){this.po(t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const br="WebChannelConnection";class CO extends class{constructor(r){this.databaseInfo=r,this.databaseId=r.databaseId;const n=r.ssl?"https":"http",s=encodeURIComponent(this.databaseId.projectId),a=encodeURIComponent(this.databaseId.database);this.Do=n+"://"+r.host,this.vo=`projects/${s}/databases/${a}`,this.Co=this.databaseId.database==="(default)"?`project_id=${s}`:`project_id=${s}&database_id=${a}`}get Fo(){return!1}Mo(r,n,s,a,i){const o=K0(),l=this.xo(r,n.toUriEncodedString());be("RestConnection",`Sending RPC '${r}' ${o}:`,l,s);const c={"google-cloud-resource-prefix":this.vo,"x-goog-request-params":this.Co};return this.Oo(c,a,i),this.No(r,l,c,s).then(u=>(be("RestConnection",`Received RPC '${r}' ${o}: `,u),u),u=>{throw il("RestConnection",`RPC '${r}' ${o} failed with error: `,u,"url: ",l,"request:",s),u})}Lo(r,n,s,a,i,o){return this.Mo(r,n,s,a,i)}Oo(r,n,s){r["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+wl}(),r["Content-Type"]="text/plain",this.databaseInfo.appId&&(r["X-Firebase-GMPID"]=this.databaseInfo.appId),n&&n.headers.forEach((a,i)=>r[i]=a),s&&s.headers.forEach((a,i)=>r[i]=a)}xo(r,n){const s=AO[r];return`${this.Do}/v1/${n}:${s}`}terminate(){}}{constructor(t){super(t),this.forceLongPolling=t.forceLongPolling,this.autoDetectLongPolling=t.autoDetectLongPolling,this.useFetchStreams=t.useFetchStreams,this.longPollingOptions=t.longPollingOptions}No(t,r,n,s){const a=K0();return new Promise((i,o)=>{const l=new wk;l.setWithCredentials(!0),l.listenOnce(Ek.COMPLETE,()=>{try{switch(l.getLastErrorCode()){case Jf.NO_ERROR:const u=l.getResponseJson();be(br,`XHR for RPC '${t}' ${a} received:`,JSON.stringify(u)),i(u);break;case Jf.TIMEOUT:be(br,`RPC '${t}' ${a} timed out`),o(new Ne(fe.DEADLINE_EXCEEDED,"Request time out"));break;case Jf.HTTP_ERROR:const h=l.getStatus();if(be(br,`RPC '${t}' ${a} failed with status:`,h,"response text:",l.getResponseText()),h>0){let m=l.getResponseJson();Array.isArray(m)&&(m=m[0]);const p=m==null?void 0:m.error;if(p&&p.status&&p.message){const x=function(w){const k=w.toLowerCase().replace(/_/g,"-");return Object.values(fe).indexOf(k)>=0?k:fe.UNKNOWN}(p.status);o(new Ne(x,p.message))}else o(new Ne(fe.UNKNOWN,"Server responded with status "+l.getStatus()))}else o(new Ne(fe.UNAVAILABLE,"Connection failed."));break;default:Le()}}finally{be(br,`RPC '${t}' ${a} completed.`)}});const c=JSON.stringify(s);be(br,`RPC '${t}' ${a} sending request:`,s),l.send(r,"POST",c,n,15)})}Bo(t,r,n){const s=K0(),a=[this.Do,"/","google.firestore.v1.Firestore","/",t,"/channel"],i=Sk(),o=kk(),l={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},c=this.longPollingOptions.timeoutSeconds;c!==void 0&&(l.longPollingTimeout=Math.round(1e3*c)),this.useFetchStreams&&(l.useFetchStreams=!0),this.Oo(l.initMessageHeaders,r,n),l.encodeInitMessageHeaders=!0;const u=a.join("");be(br,`Creating RPC '${t}' stream ${s}: ${u}`,l);const h=i.createWebChannel(u,l);let m=!1,p=!1;const x=new IO({Io:w=>{p?be(br,`Not sending because RPC '${t}' stream ${s} is closed:`,w):(m||(be(br,`Opening RPC '${t}' stream ${s} transport.`),h.open(),m=!0),be(br,`RPC '${t}' stream ${s} sending:`,w),h.send(w))},To:()=>h.close()}),v=(w,k,T)=>{w.listen(k,E=>{try{T(E)}catch(N){setTimeout(()=>{throw N},0)}})};return v(h,Zl.EventType.OPEN,()=>{p||(be(br,`RPC '${t}' stream ${s} transport opened.`),x.yo())}),v(h,Zl.EventType.CLOSE,()=>{p||(p=!0,be(br,`RPC '${t}' stream ${s} transport closed`),x.So())}),v(h,Zl.EventType.ERROR,w=>{p||(p=!0,il(br,`RPC '${t}' stream ${s} transport errored:`,w),x.So(new Ne(fe.UNAVAILABLE,"The operation could not be completed")))}),v(h,Zl.EventType.MESSAGE,w=>{var k;if(!p){const T=w.data[0];gt(!!T);const E=T,N=E.error||((k=E[0])===null||k===void 0?void 0:k.error);if(N){be(br,`RPC '${t}' stream ${s} received error:`,N);const O=N.status;let L=function(S){const R=qt[S];if(R!==void 0)return Jk(R)}(O),g=N.message;L===void 0&&(L=fe.INTERNAL,g="Unknown error status: "+O+" with message "+N.message),p=!0,x.So(new Ne(L,g)),h.close()}else be(br,`RPC '${t}' stream ${s} received:`,T),x.bo(T)}}),v(o,Tk.STAT_EVENT,w=>{w.stat===hp.PROXY?be(br,`RPC '${t}' stream ${s} detected buffering proxy`):w.stat===hp.NOPROXY&&be(br,`RPC '${t}' stream ${s} detected no buffering proxy`)}),setTimeout(()=>{x.wo()},0),x}}function q0(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zd(e){return new jF(e,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uS{constructor(t,r,n=1e3,s=1.5,a=6e4){this.ui=t,this.timerId=r,this.ko=n,this.qo=s,this.Qo=a,this.Ko=0,this.$o=null,this.Uo=Date.now(),this.reset()}reset(){this.Ko=0}Wo(){this.Ko=this.Qo}Go(t){this.cancel();const r=Math.floor(this.Ko+this.zo()),n=Math.max(0,Date.now()-this.Uo),s=Math.max(0,r-n);s>0&&be("ExponentialBackoff",`Backing off for ${s} ms (base delay: ${this.Ko} ms, delay with jitter: ${r} ms, last attempt: ${n} ms ago)`),this.$o=this.ui.enqueueAfterDelay(this.timerId,s,()=>(this.Uo=Date.now(),t())),this.Ko*=this.qo,this.Ko<this.ko&&(this.Ko=this.ko),this.Ko>this.Qo&&(this.Ko=this.Qo)}jo(){this.$o!==null&&(this.$o.skipDelay(),this.$o=null)}cancel(){this.$o!==null&&(this.$o.cancel(),this.$o=null)}zo(){return(Math.random()-.5)*this.Ko}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fS{constructor(t,r,n,s,a,i,o,l){this.ui=t,this.Ho=n,this.Jo=s,this.connection=a,this.authCredentialsProvider=i,this.appCheckCredentialsProvider=o,this.listener=l,this.state=0,this.Yo=0,this.Zo=null,this.Xo=null,this.stream=null,this.e_=0,this.t_=new uS(t,r)}n_(){return this.state===1||this.state===5||this.r_()}r_(){return this.state===2||this.state===3}start(){this.e_=0,this.state!==4?this.auth():this.i_()}async stop(){this.n_()&&await this.close(0)}s_(){this.state=0,this.t_.reset()}o_(){this.r_()&&this.Zo===null&&(this.Zo=this.ui.enqueueAfterDelay(this.Ho,6e4,()=>this.__()))}a_(t){this.u_(),this.stream.send(t)}async __(){if(this.r_())return this.close(0)}u_(){this.Zo&&(this.Zo.cancel(),this.Zo=null)}c_(){this.Xo&&(this.Xo.cancel(),this.Xo=null)}async close(t,r){this.u_(),this.c_(),this.t_.cancel(),this.Yo++,t!==4?this.t_.reset():r&&r.code===fe.RESOURCE_EXHAUSTED?(da(r.toString()),da("Using maximum backoff delay to prevent overloading the backend."),this.t_.Wo()):r&&r.code===fe.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.l_(),this.stream.close(),this.stream=null),this.state=t,await this.listener.mo(r)}l_(){}auth(){this.state=1;const t=this.h_(this.Yo),r=this.Yo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([n,s])=>{this.Yo===r&&this.P_(n,s)},n=>{t(()=>{const s=new Ne(fe.UNKNOWN,"Fetching auth token failed: "+n.message);return this.I_(s)})})}P_(t,r){const n=this.h_(this.Yo);this.stream=this.T_(t,r),this.stream.Eo(()=>{n(()=>this.listener.Eo())}),this.stream.Ro(()=>{n(()=>(this.state=2,this.Xo=this.ui.enqueueAfterDelay(this.Jo,1e4,()=>(this.r_()&&(this.state=3),Promise.resolve())),this.listener.Ro()))}),this.stream.mo(s=>{n(()=>this.I_(s))}),this.stream.onMessage(s=>{n(()=>++this.e_==1?this.E_(s):this.onNext(s))})}i_(){this.state=5,this.t_.Go(async()=>{this.state=0,this.start()})}I_(t){return be("PersistentStream",`close with error: ${t}`),this.stream=null,this.close(4,t)}h_(t){return r=>{this.ui.enqueueAndForget(()=>this.Yo===t?r():(be("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class RO extends fS{constructor(t,r,n,s,a,i){super(t,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",r,n,s,i),this.serializer=a}T_(t,r){return this.connection.Bo("Listen",t,r)}E_(t){return this.onNext(t)}onNext(t){this.t_.reset();const r=BF(this.serializer,t),n=function(a){if(!("targetChange"in a))return Ve.min();const i=a.targetChange;return i.targetIds&&i.targetIds.length?Ve.min():i.readTime?As(i.readTime):Ve.min()}(t);return this.listener.d_(r,n)}A_(t){const r={};r.database=Ep(this.serializer),r.addTarget=function(a,i){let o;const l=i.target;if(o=gp(l)?{documents:WF(a,l)}:{query:HF(a,l)._t},o.targetId=i.targetId,i.resumeToken.approximateByteSize()>0){o.resumeToken=tS(a,i.resumeToken);const c=_p(a,i.expectedCount);c!==null&&(o.expectedCount=c)}else if(i.snapshotVersion.compareTo(Ve.min())>0){o.readTime=$h(a,i.snapshotVersion.toTimestamp());const c=_p(a,i.expectedCount);c!==null&&(o.expectedCount=c)}return o}(this.serializer,t);const n=KF(this.serializer,t);n&&(r.labels=n),this.a_(r)}R_(t){const r={};r.database=Ep(this.serializer),r.removeTarget=t,this.a_(r)}}class NO extends fS{constructor(t,r,n,s,a,i){super(t,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",r,n,s,i),this.serializer=a}get V_(){return this.e_>0}start(){this.lastStreamToken=void 0,super.start()}l_(){this.V_&&this.m_([])}T_(t,r){return this.connection.Bo("Write",t,r)}E_(t){return gt(!!t.streamToken),this.lastStreamToken=t.streamToken,gt(!t.writeResults||t.writeResults.length===0),this.listener.f_()}onNext(t){gt(!!t.streamToken),this.lastStreamToken=t.streamToken,this.t_.reset();const r=$F(t.writeResults,t.commitTime),n=As(t.commitTime);return this.listener.g_(n,r)}p_(){const t={};t.database=Ep(this.serializer),this.a_(t)}m_(t){const r={streamToken:this.lastStreamToken,writes:t.map(n=>zF(this.serializer,n))};this.a_(r)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bO extends class{}{constructor(t,r,n,s){super(),this.authCredentials=t,this.appCheckCredentials=r,this.connection=n,this.serializer=s,this.y_=!1}w_(){if(this.y_)throw new Ne(fe.FAILED_PRECONDITION,"The client has already been terminated.")}Mo(t,r,n,s){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([a,i])=>this.connection.Mo(t,yp(r,n),s,a,i)).catch(a=>{throw a.name==="FirebaseError"?(a.code===fe.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),a):new Ne(fe.UNKNOWN,a.toString())})}Lo(t,r,n,s,a){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([i,o])=>this.connection.Lo(t,yp(r,n),s,i,o,a)).catch(i=>{throw i.name==="FirebaseError"?(i.code===fe.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),i):new Ne(fe.UNKNOWN,i.toString())})}terminate(){this.y_=!0,this.connection.terminate()}}class PO{constructor(t,r){this.asyncQueue=t,this.onlineStateHandler=r,this.state="Unknown",this.S_=0,this.b_=null,this.D_=!0}v_(){this.S_===0&&(this.C_("Unknown"),this.b_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.b_=null,this.F_("Backend didn't respond within 10 seconds."),this.C_("Offline"),Promise.resolve())))}M_(t){this.state==="Online"?this.C_("Unknown"):(this.S_++,this.S_>=1&&(this.x_(),this.F_(`Connection failed 1 times. Most recent error: ${t.toString()}`),this.C_("Offline")))}set(t){this.x_(),this.S_=0,t==="Online"&&(this.D_=!1),this.C_(t)}C_(t){t!==this.state&&(this.state=t,this.onlineStateHandler(t))}F_(t){const r=`Could not reach Cloud Firestore backend. ${t}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.D_?(da(r),this.D_=!1):be("OnlineStateTracker",r)}x_(){this.b_!==null&&(this.b_.cancel(),this.b_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DO{constructor(t,r,n,s,a){this.localStore=t,this.datastore=r,this.asyncQueue=n,this.remoteSyncer={},this.O_=[],this.N_=new Map,this.L_=new Set,this.B_=[],this.k_=a,this.k_._o(i=>{n.enqueueAndForget(async()=>{to(this)&&(be("RemoteStore","Restarting streams for network reachability change."),await async function(l){const c=Be(l);c.L_.add(4),await Pu(c),c.q_.set("Unknown"),c.L_.delete(4),await $d(c)}(this))})}),this.q_=new PO(n,s)}}async function $d(e){if(to(e))for(const t of e.B_)await t(!0)}async function Pu(e){for(const t of e.B_)await t(!1)}function hS(e,t){const r=Be(e);r.N_.has(t.targetId)||(r.N_.set(t.targetId,t),Ev(r)?wv(r):Tl(r).r_()&&yv(r,t))}function _v(e,t){const r=Be(e),n=Tl(r);r.N_.delete(t),n.r_()&&dS(r,t),r.N_.size===0&&(n.r_()?n.o_():to(r)&&r.q_.set("Unknown"))}function yv(e,t){if(e.Q_.xe(t.targetId),t.resumeToken.approximateByteSize()>0||t.snapshotVersion.compareTo(Ve.min())>0){const r=e.remoteSyncer.getRemoteKeysForTarget(t.targetId).size;t=t.withExpectedCount(r)}Tl(e).A_(t)}function dS(e,t){e.Q_.xe(t),Tl(e).R_(t)}function wv(e){e.Q_=new FF({getRemoteKeysForTarget:t=>e.remoteSyncer.getRemoteKeysForTarget(t),ot:t=>e.N_.get(t)||null,tt:()=>e.datastore.serializer.databaseId}),Tl(e).start(),e.q_.v_()}function Ev(e){return to(e)&&!Tl(e).n_()&&e.N_.size>0}function to(e){return Be(e).L_.size===0}function mS(e){e.Q_=void 0}async function FO(e){e.q_.set("Online")}async function OO(e){e.N_.forEach((t,r)=>{yv(e,t)})}async function MO(e,t){mS(e),Ev(e)?(e.q_.M_(t),wv(e)):e.q_.set("Unknown")}async function LO(e,t,r){if(e.q_.set("Online"),t instanceof eS&&t.state===2&&t.cause)try{await async function(s,a){const i=a.cause;for(const o of a.targetIds)s.N_.has(o)&&(await s.remoteSyncer.rejectListen(o,i),s.N_.delete(o),s.Q_.removeTarget(o))}(e,t)}catch(n){be("RemoteStore","Failed to remove targets %s: %s ",t.targetIds.join(","),n),await Wh(e,n)}else if(t instanceof th?e.Q_.Ke(t):t instanceof Zk?e.Q_.He(t):e.Q_.We(t),!r.isEqual(Ve.min()))try{const n=await cS(e.localStore);r.compareTo(n)>=0&&await function(a,i){const o=a.Q_.rt(i);return o.targetChanges.forEach((l,c)=>{if(l.resumeToken.approximateByteSize()>0){const u=a.N_.get(c);u&&a.N_.set(c,u.withResumeToken(l.resumeToken,i))}}),o.targetMismatches.forEach((l,c)=>{const u=a.N_.get(l);if(!u)return;a.N_.set(l,u.withResumeToken(Sr.EMPTY_BYTE_STRING,u.snapshotVersion)),dS(a,l);const h=new Ua(u.target,l,c,u.sequenceNumber);yv(a,h)}),a.remoteSyncer.applyRemoteEvent(o)}(e,r)}catch(n){be("RemoteStore","Failed to raise snapshot:",n),await Wh(e,n)}}async function Wh(e,t,r){if(!Cu(t))throw t;e.L_.add(1),await Pu(e),e.q_.set("Offline"),r||(r=()=>cS(e.localStore)),e.asyncQueue.enqueueRetryable(async()=>{be("RemoteStore","Retrying IndexedDB access"),await r(),e.L_.delete(1),await $d(e)})}function pS(e,t){return t().catch(r=>Wh(e,r,t))}async function Wd(e){const t=Be(e),r=ii(t);let n=t.O_.length>0?t.O_[t.O_.length-1].batchId:-1;for(;jO(t);)try{const s=await wO(t.localStore,n);if(s===null){t.O_.length===0&&r.o_();break}n=s.batchId,VO(t,s)}catch(s){await Wh(t,s)}gS(t)&&vS(t)}function jO(e){return to(e)&&e.O_.length<10}function VO(e,t){e.O_.push(t);const r=ii(e);r.r_()&&r.V_&&r.m_(t.mutations)}function gS(e){return to(e)&&!ii(e).n_()&&e.O_.length>0}function vS(e){ii(e).start()}async function UO(e){ii(e).p_()}async function BO(e){const t=ii(e);for(const r of e.O_)t.m_(r.mutations)}async function zO(e,t,r){const n=e.O_.shift(),s=dv.from(n,t,r);await pS(e,()=>e.remoteSyncer.applySuccessfulWrite(s)),await Wd(e)}async function $O(e,t){t&&ii(e).V_&&await async function(n,s){if(function(i){return bF(i)&&i!==fe.ABORTED}(s.code)){const a=n.O_.shift();ii(n).s_(),await pS(n,()=>n.remoteSyncer.rejectFailedWrite(a.batchId,s)),await Wd(n)}}(e,t),gS(e)&&vS(e)}async function wy(e,t){const r=Be(e);r.asyncQueue.verifyOperationInProgress(),be("RemoteStore","RemoteStore received new credentials");const n=to(r);r.L_.add(3),await Pu(r),n&&r.q_.set("Unknown"),await r.remoteSyncer.handleCredentialChange(t),r.L_.delete(3),await $d(r)}async function WO(e,t){const r=Be(e);t?(r.L_.delete(2),await $d(r)):t||(r.L_.add(2),await Pu(r),r.q_.set("Unknown"))}function Tl(e){return e.K_||(e.K_=function(r,n,s){const a=Be(r);return a.w_(),new RO(n,a.connection,a.authCredentials,a.appCheckCredentials,a.serializer,s)}(e.datastore,e.asyncQueue,{Eo:FO.bind(null,e),Ro:OO.bind(null,e),mo:MO.bind(null,e),d_:LO.bind(null,e)}),e.B_.push(async t=>{t?(e.K_.s_(),Ev(e)?wv(e):e.q_.set("Unknown")):(await e.K_.stop(),mS(e))})),e.K_}function ii(e){return e.U_||(e.U_=function(r,n,s){const a=Be(r);return a.w_(),new NO(n,a.connection,a.authCredentials,a.appCheckCredentials,a.serializer,s)}(e.datastore,e.asyncQueue,{Eo:()=>Promise.resolve(),Ro:UO.bind(null,e),mo:$O.bind(null,e),f_:BO.bind(null,e),g_:zO.bind(null,e)}),e.B_.push(async t=>{t?(e.U_.s_(),await Wd(e)):(await e.U_.stop(),e.O_.length>0&&(be("RemoteStore",`Stopping write stream with ${e.O_.length} pending writes`),e.O_=[]))})),e.U_}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tv{constructor(t,r,n,s,a){this.asyncQueue=t,this.timerId=r,this.targetTimeMs=n,this.op=s,this.removalCallback=a,this.deferred=new ta,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(i=>{})}get promise(){return this.deferred.promise}static createAndSchedule(t,r,n,s,a){const i=Date.now()+n,o=new Tv(t,r,i,s,a);return o.start(n),o}start(t){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),t)}skipDelay(){return this.handleDelayElapsed()}cancel(t){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new Ne(fe.CANCELLED,"Operation cancelled"+(t?": "+t:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(t=>this.deferred.resolve(t))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function kv(e,t){if(da("AsyncQueue",`${t}: ${e}`),Cu(e))return new Ne(fe.UNAVAILABLE,`${t}: ${e}`);throw e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ho{constructor(t){this.comparator=t?(r,n)=>t(r,n)||Pe.comparator(r.key,n.key):(r,n)=>Pe.comparator(r.key,n.key),this.keyedMap=ec(),this.sortedSet=new Lt(this.comparator)}static emptySet(t){return new Ho(t.comparator)}has(t){return this.keyedMap.get(t)!=null}get(t){return this.keyedMap.get(t)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(t){const r=this.keyedMap.get(t);return r?this.sortedSet.indexOf(r):-1}get size(){return this.sortedSet.size}forEach(t){this.sortedSet.inorderTraversal((r,n)=>(t(r),!1))}add(t){const r=this.delete(t.key);return r.copy(r.keyedMap.insert(t.key,t),r.sortedSet.insert(t,null))}delete(t){const r=this.get(t);return r?this.copy(this.keyedMap.remove(t),this.sortedSet.remove(r)):this}isEqual(t){if(!(t instanceof Ho)||this.size!==t.size)return!1;const r=this.sortedSet.getIterator(),n=t.sortedSet.getIterator();for(;r.hasNext();){const s=r.getNext().key,a=n.getNext().key;if(!s.isEqual(a))return!1}return!0}toString(){const t=[];return this.forEach(r=>{t.push(r.toString())}),t.length===0?"DocumentSet ()":`DocumentSet (
  `+t.join(`  
`)+`
)`}copy(t,r){const n=new Ho;return n.comparator=this.comparator,n.keyedMap=t,n.sortedSet=r,n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ey{constructor(){this.W_=new Lt(Pe.comparator)}track(t){const r=t.doc.key,n=this.W_.get(r);n?t.type!==0&&n.type===3?this.W_=this.W_.insert(r,t):t.type===3&&n.type!==1?this.W_=this.W_.insert(r,{type:n.type,doc:t.doc}):t.type===2&&n.type===2?this.W_=this.W_.insert(r,{type:2,doc:t.doc}):t.type===2&&n.type===0?this.W_=this.W_.insert(r,{type:0,doc:t.doc}):t.type===1&&n.type===0?this.W_=this.W_.remove(r):t.type===1&&n.type===2?this.W_=this.W_.insert(r,{type:1,doc:n.doc}):t.type===0&&n.type===1?this.W_=this.W_.insert(r,{type:2,doc:t.doc}):Le():this.W_=this.W_.insert(r,t)}G_(){const t=[];return this.W_.inorderTraversal((r,n)=>{t.push(n)}),t}}class fl{constructor(t,r,n,s,a,i,o,l,c){this.query=t,this.docs=r,this.oldDocs=n,this.docChanges=s,this.mutatedKeys=a,this.fromCache=i,this.syncStateChanged=o,this.excludesMetadataChanges=l,this.hasCachedResults=c}static fromInitialDocuments(t,r,n,s,a){const i=[];return r.forEach(o=>{i.push({type:0,doc:o})}),new fl(t,r,Ho.emptySet(r),i,n,s,!0,!1,a)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(t){if(!(this.fromCache===t.fromCache&&this.hasCachedResults===t.hasCachedResults&&this.syncStateChanged===t.syncStateChanged&&this.mutatedKeys.isEqual(t.mutatedKeys)&&Ld(this.query,t.query)&&this.docs.isEqual(t.docs)&&this.oldDocs.isEqual(t.oldDocs)))return!1;const r=this.docChanges,n=t.docChanges;if(r.length!==n.length)return!1;for(let s=0;s<r.length;s++)if(r[s].type!==n[s].type||!r[s].doc.isEqual(n[s].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HO{constructor(){this.z_=void 0,this.j_=[]}H_(){return this.j_.some(t=>t.J_())}}class GO{constructor(){this.queries=Ty(),this.onlineState="Unknown",this.Y_=new Set}terminate(){(function(r,n){const s=Be(r),a=s.queries;s.queries=Ty(),a.forEach((i,o)=>{for(const l of o.j_)l.onError(n)})})(this,new Ne(fe.ABORTED,"Firestore shutting down"))}}function Ty(){return new El(e=>jk(e),Ld)}async function Sv(e,t){const r=Be(e);let n=3;const s=t.query;let a=r.queries.get(s);a?!a.H_()&&t.J_()&&(n=2):(a=new HO,n=t.J_()?0:1);try{switch(n){case 0:a.z_=await r.onListen(s,!0);break;case 1:a.z_=await r.onListen(s,!1);break;case 2:await r.onFirstRemoteStoreListen(s)}}catch(i){const o=kv(i,`Initialization of query '${_o(t.query)}' failed`);return void t.onError(o)}r.queries.set(s,a),a.j_.push(t),t.Z_(r.onlineState),a.z_&&t.X_(a.z_)&&Iv(r)}async function Av(e,t){const r=Be(e),n=t.query;let s=3;const a=r.queries.get(n);if(a){const i=a.j_.indexOf(t);i>=0&&(a.j_.splice(i,1),a.j_.length===0?s=t.J_()?0:1:!a.H_()&&t.J_()&&(s=2))}switch(s){case 0:return r.queries.delete(n),r.onUnlisten(n,!0);case 1:return r.queries.delete(n),r.onUnlisten(n,!1);case 2:return r.onLastRemoteStoreUnlisten(n);default:return}}function KO(e,t){const r=Be(e);let n=!1;for(const s of t){const a=s.query,i=r.queries.get(a);if(i){for(const o of i.j_)o.X_(s)&&(n=!0);i.z_=s}}n&&Iv(r)}function qO(e,t,r){const n=Be(e),s=n.queries.get(t);if(s)for(const a of s.j_)a.onError(r);n.queries.delete(t)}function Iv(e){e.Y_.forEach(t=>{t.next()})}var kp,ky;(ky=kp||(kp={})).ea="default",ky.Cache="cache";class Cv{constructor(t,r,n){this.query=t,this.ta=r,this.na=!1,this.ra=null,this.onlineState="Unknown",this.options=n||{}}X_(t){if(!this.options.includeMetadataChanges){const n=[];for(const s of t.docChanges)s.type!==3&&n.push(s);t=new fl(t.query,t.docs,t.oldDocs,n,t.mutatedKeys,t.fromCache,t.syncStateChanged,!0,t.hasCachedResults)}let r=!1;return this.na?this.ia(t)&&(this.ta.next(t),r=!0):this.sa(t,this.onlineState)&&(this.oa(t),r=!0),this.ra=t,r}onError(t){this.ta.error(t)}Z_(t){this.onlineState=t;let r=!1;return this.ra&&!this.na&&this.sa(this.ra,t)&&(this.oa(this.ra),r=!0),r}sa(t,r){if(!t.fromCache||!this.J_())return!0;const n=r!=="Offline";return(!this.options._a||!n)&&(!t.docs.isEmpty()||t.hasCachedResults||r==="Offline")}ia(t){if(t.docChanges.length>0)return!0;const r=this.ra&&this.ra.hasPendingWrites!==t.hasPendingWrites;return!(!t.syncStateChanged&&!r)&&this.options.includeMetadataChanges===!0}oa(t){t=fl.fromInitialDocuments(t.query,t.docs,t.mutatedKeys,t.fromCache,t.hasCachedResults),this.na=!0,this.ta.next(t)}J_(){return this.options.source!==kp.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xS{constructor(t){this.key=t}}class _S{constructor(t){this.key=t}}class XO{constructor(t,r){this.query=t,this.Ta=r,this.Ea=null,this.hasCachedResults=!1,this.current=!1,this.da=Xe(),this.mutatedKeys=Xe(),this.Aa=Vk(t),this.Ra=new Ho(this.Aa)}get Va(){return this.Ta}ma(t,r){const n=r?r.fa:new Ey,s=r?r.Ra:this.Ra;let a=r?r.mutatedKeys:this.mutatedKeys,i=s,o=!1;const l=this.query.limitType==="F"&&s.size===this.query.limit?s.last():null,c=this.query.limitType==="L"&&s.size===this.query.limit?s.first():null;if(t.inorderTraversal((u,h)=>{const m=s.get(u),p=jd(this.query,h)?h:null,x=!!m&&this.mutatedKeys.has(m.key),v=!!p&&(p.hasLocalMutations||this.mutatedKeys.has(p.key)&&p.hasCommittedMutations);let w=!1;m&&p?m.data.isEqual(p.data)?x!==v&&(n.track({type:3,doc:p}),w=!0):this.ga(m,p)||(n.track({type:2,doc:p}),w=!0,(l&&this.Aa(p,l)>0||c&&this.Aa(p,c)<0)&&(o=!0)):!m&&p?(n.track({type:0,doc:p}),w=!0):m&&!p&&(n.track({type:1,doc:m}),w=!0,(l||c)&&(o=!0)),w&&(p?(i=i.add(p),a=v?a.add(u):a.delete(u)):(i=i.delete(u),a=a.delete(u)))}),this.query.limit!==null)for(;i.size>this.query.limit;){const u=this.query.limitType==="F"?i.last():i.first();i=i.delete(u.key),a=a.delete(u.key),n.track({type:1,doc:u})}return{Ra:i,fa:n,ns:o,mutatedKeys:a}}ga(t,r){return t.hasLocalMutations&&r.hasCommittedMutations&&!r.hasLocalMutations}applyChanges(t,r,n,s){const a=this.Ra;this.Ra=t.Ra,this.mutatedKeys=t.mutatedKeys;const i=t.fa.G_();i.sort((u,h)=>function(p,x){const v=w=>{switch(w){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Le()}};return v(p)-v(x)}(u.type,h.type)||this.Aa(u.doc,h.doc)),this.pa(n),s=s!=null&&s;const o=r&&!s?this.ya():[],l=this.da.size===0&&this.current&&!s?1:0,c=l!==this.Ea;return this.Ea=l,i.length!==0||c?{snapshot:new fl(this.query,t.Ra,a,i,t.mutatedKeys,l===0,c,!1,!!n&&n.resumeToken.approximateByteSize()>0),wa:o}:{wa:o}}Z_(t){return this.current&&t==="Offline"?(this.current=!1,this.applyChanges({Ra:this.Ra,fa:new Ey,mutatedKeys:this.mutatedKeys,ns:!1},!1)):{wa:[]}}Sa(t){return!this.Ta.has(t)&&!!this.Ra.has(t)&&!this.Ra.get(t).hasLocalMutations}pa(t){t&&(t.addedDocuments.forEach(r=>this.Ta=this.Ta.add(r)),t.modifiedDocuments.forEach(r=>{}),t.removedDocuments.forEach(r=>this.Ta=this.Ta.delete(r)),this.current=t.current)}ya(){if(!this.current)return[];const t=this.da;this.da=Xe(),this.Ra.forEach(n=>{this.Sa(n.key)&&(this.da=this.da.add(n.key))});const r=[];return t.forEach(n=>{this.da.has(n)||r.push(new _S(n))}),this.da.forEach(n=>{t.has(n)||r.push(new xS(n))}),r}ba(t){this.Ta=t.Ts,this.da=Xe();const r=this.ma(t.documents);return this.applyChanges(r,!0)}Da(){return fl.fromInitialDocuments(this.query,this.Ra,this.mutatedKeys,this.Ea===0,this.hasCachedResults)}}class YO{constructor(t,r,n){this.query=t,this.targetId=r,this.view=n}}class QO{constructor(t){this.key=t,this.va=!1}}class JO{constructor(t,r,n,s,a,i){this.localStore=t,this.remoteStore=r,this.eventManager=n,this.sharedClientState=s,this.currentUser=a,this.maxConcurrentLimboResolutions=i,this.Ca={},this.Fa=new El(o=>jk(o),Ld),this.Ma=new Map,this.xa=new Set,this.Oa=new Lt(Pe.comparator),this.Na=new Map,this.La=new gv,this.Ba={},this.ka=new Map,this.qa=ul.kn(),this.onlineState="Unknown",this.Qa=void 0}get isPrimaryClient(){return this.Qa===!0}}async function ZO(e,t,r=!0){const n=SS(e);let s;const a=n.Fa.get(t);return a?(n.sharedClientState.addLocalQueryTarget(a.targetId),s=a.view.Da()):s=await yS(n,t,r,!0),s}async function eM(e,t){const r=SS(e);await yS(r,t,!0,!1)}async function yS(e,t,r,n){const s=await EO(e.localStore,Ss(t)),a=s.targetId,i=e.sharedClientState.addLocalQueryTarget(a,r);let o;return n&&(o=await tM(e,t,a,i==="current",s.resumeToken)),e.isPrimaryClient&&r&&hS(e.remoteStore,s),o}async function tM(e,t,r,n,s){e.Ka=(h,m,p)=>async function(v,w,k,T){let E=w.view.ma(k);E.ns&&(E=await xy(v.localStore,w.query,!1).then(({documents:g})=>w.view.ma(g,E)));const N=T&&T.targetChanges.get(w.targetId),O=T&&T.targetMismatches.get(w.targetId)!=null,L=w.view.applyChanges(E,v.isPrimaryClient,N,O);return Ay(v,w.targetId,L.wa),L.snapshot}(e,h,m,p);const a=await xy(e.localStore,t,!0),i=new XO(t,a.Ts),o=i.ma(a.documents),l=bu.createSynthesizedTargetChangeForCurrentChange(r,n&&e.onlineState!=="Offline",s),c=i.applyChanges(o,e.isPrimaryClient,l);Ay(e,r,c.wa);const u=new YO(t,r,i);return e.Fa.set(t,u),e.Ma.has(r)?e.Ma.get(r).push(t):e.Ma.set(r,[t]),c.snapshot}async function rM(e,t,r){const n=Be(e),s=n.Fa.get(t),a=n.Ma.get(s.targetId);if(a.length>1)return n.Ma.set(s.targetId,a.filter(i=>!Ld(i,t))),void n.Fa.delete(t);n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(s.targetId),n.sharedClientState.isActiveQueryTarget(s.targetId)||await Tp(n.localStore,s.targetId,!1).then(()=>{n.sharedClientState.clearQueryState(s.targetId),r&&_v(n.remoteStore,s.targetId),Sp(n,s.targetId)}).catch(Iu)):(Sp(n,s.targetId),await Tp(n.localStore,s.targetId,!0))}async function nM(e,t){const r=Be(e),n=r.Fa.get(t),s=r.Ma.get(n.targetId);r.isPrimaryClient&&s.length===1&&(r.sharedClientState.removeLocalQueryTarget(n.targetId),_v(r.remoteStore,n.targetId))}async function sM(e,t,r){const n=fM(e);try{const s=await function(i,o){const l=Be(i),c=ar.now(),u=o.reduce((p,x)=>p.add(x.key),Xe());let h,m;return l.persistence.runTransaction("Locally write mutations","readwrite",p=>{let x=ma(),v=Xe();return l.cs.getEntries(p,u).next(w=>{x=w,x.forEach((k,T)=>{T.isValidDocument()||(v=v.add(k))})}).next(()=>l.localDocuments.getOverlayedDocuments(p,x)).next(w=>{h=w;const k=[];for(const T of o){const E=AF(T,h.get(T.key).overlayedDocument);E!=null&&k.push(new pi(T.key,E,Nk(E.value.mapValue),Un.exists(!0)))}return l.mutationQueue.addMutationBatch(p,c,k,o)}).next(w=>{m=w;const k=w.applyToLocalDocumentSet(h,v);return l.documentOverlayCache.saveOverlays(p,w.batchId,k)})}).then(()=>({batchId:m.batchId,changes:Bk(h)}))}(n.localStore,t);n.sharedClientState.addPendingMutation(s.batchId),function(i,o,l){let c=i.Ba[i.currentUser.toKey()];c||(c=new Lt(ct)),c=c.insert(o,l),i.Ba[i.currentUser.toKey()]=c}(n,s.batchId,r),await Du(n,s.changes),await Wd(n.remoteStore)}catch(s){const a=kv(s,"Failed to persist write");r.reject(a)}}async function wS(e,t){const r=Be(e);try{const n=await _O(r.localStore,t);t.targetChanges.forEach((s,a)=>{const i=r.Na.get(a);i&&(gt(s.addedDocuments.size+s.modifiedDocuments.size+s.removedDocuments.size<=1),s.addedDocuments.size>0?i.va=!0:s.modifiedDocuments.size>0?gt(i.va):s.removedDocuments.size>0&&(gt(i.va),i.va=!1))}),await Du(r,n,t)}catch(n){await Iu(n)}}function Sy(e,t,r){const n=Be(e);if(n.isPrimaryClient&&r===0||!n.isPrimaryClient&&r===1){const s=[];n.Fa.forEach((a,i)=>{const o=i.view.Z_(t);o.snapshot&&s.push(o.snapshot)}),function(i,o){const l=Be(i);l.onlineState=o;let c=!1;l.queries.forEach((u,h)=>{for(const m of h.j_)m.Z_(o)&&(c=!0)}),c&&Iv(l)}(n.eventManager,t),s.length&&n.Ca.d_(s),n.onlineState=t,n.isPrimaryClient&&n.sharedClientState.setOnlineState(t)}}async function aM(e,t,r){const n=Be(e);n.sharedClientState.updateQueryState(t,"rejected",r);const s=n.Na.get(t),a=s&&s.key;if(a){let i=new Lt(Pe.comparator);i=i.insert(a,Mr.newNoDocument(a,Ve.min()));const o=Xe().add(a),l=new Bd(Ve.min(),new Map,new Lt(ct),i,o);await wS(n,l),n.Oa=n.Oa.remove(a),n.Na.delete(t),Rv(n)}else await Tp(n.localStore,t,!1).then(()=>Sp(n,t,r)).catch(Iu)}async function iM(e,t){const r=Be(e),n=t.batch.batchId;try{const s=await xO(r.localStore,t);TS(r,n,null),ES(r,n),r.sharedClientState.updateMutationState(n,"acknowledged"),await Du(r,s)}catch(s){await Iu(s)}}async function oM(e,t,r){const n=Be(e);try{const s=await function(i,o){const l=Be(i);return l.persistence.runTransaction("Reject batch","readwrite-primary",c=>{let u;return l.mutationQueue.lookupMutationBatch(c,o).next(h=>(gt(h!==null),u=h.keys(),l.mutationQueue.removeMutationBatch(c,h))).next(()=>l.mutationQueue.performConsistencyCheck(c)).next(()=>l.documentOverlayCache.removeOverlaysForBatchId(c,u,o)).next(()=>l.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(c,u)).next(()=>l.localDocuments.getDocuments(c,u))})}(n.localStore,t);TS(n,t,r),ES(n,t),n.sharedClientState.updateMutationState(t,"rejected",r),await Du(n,s)}catch(s){await Iu(s)}}function ES(e,t){(e.ka.get(t)||[]).forEach(r=>{r.resolve()}),e.ka.delete(t)}function TS(e,t,r){const n=Be(e);let s=n.Ba[n.currentUser.toKey()];if(s){const a=s.get(t);a&&(r?a.reject(r):a.resolve(),s=s.remove(t)),n.Ba[n.currentUser.toKey()]=s}}function Sp(e,t,r=null){e.sharedClientState.removeLocalQueryTarget(t);for(const n of e.Ma.get(t))e.Fa.delete(n),r&&e.Ca.$a(n,r);e.Ma.delete(t),e.isPrimaryClient&&e.La.gr(t).forEach(n=>{e.La.containsKey(n)||kS(e,n)})}function kS(e,t){e.xa.delete(t.path.canonicalString());const r=e.Oa.get(t);r!==null&&(_v(e.remoteStore,r),e.Oa=e.Oa.remove(t),e.Na.delete(r),Rv(e))}function Ay(e,t,r){for(const n of r)n instanceof xS?(e.La.addReference(n.key,t),lM(e,n)):n instanceof _S?(be("SyncEngine","Document no longer in limbo: "+n.key),e.La.removeReference(n.key,t),e.La.containsKey(n.key)||kS(e,n.key)):Le()}function lM(e,t){const r=t.key,n=r.path.canonicalString();e.Oa.get(r)||e.xa.has(n)||(be("SyncEngine","New document in limbo: "+r),e.xa.add(n),Rv(e))}function Rv(e){for(;e.xa.size>0&&e.Oa.size<e.maxConcurrentLimboResolutions;){const t=e.xa.values().next().value;e.xa.delete(t);const r=new Pe(Ct.fromString(t)),n=e.qa.next();e.Na.set(n,new QO(r)),e.Oa=e.Oa.insert(r,n),hS(e.remoteStore,new Ua(Ss(Md(r.path)),n,"TargetPurposeLimboResolution",av.oe))}}async function Du(e,t,r){const n=Be(e),s=[],a=[],i=[];n.Fa.isEmpty()||(n.Fa.forEach((o,l)=>{i.push(n.Ka(l,t,r).then(c=>{var u;if((c||r)&&n.isPrimaryClient){const h=c?!c.fromCache:(u=r==null?void 0:r.targetChanges.get(l.targetId))===null||u===void 0?void 0:u.current;n.sharedClientState.updateQueryState(l.targetId,h?"current":"not-current")}if(c){s.push(c);const h=xv.Wi(l.targetId,c);a.push(h)}}))}),await Promise.all(i),n.Ca.d_(s),await async function(l,c){const u=Be(l);try{await u.persistence.runTransaction("notifyLocalViewChanges","readwrite",h=>ge.forEach(c,m=>ge.forEach(m.$i,p=>u.persistence.referenceDelegate.addReference(h,m.targetId,p)).next(()=>ge.forEach(m.Ui,p=>u.persistence.referenceDelegate.removeReference(h,m.targetId,p)))))}catch(h){if(!Cu(h))throw h;be("LocalStore","Failed to update sequence numbers: "+h)}for(const h of c){const m=h.targetId;if(!h.fromCache){const p=u.os.get(m),x=p.snapshotVersion,v=p.withLastLimboFreeSnapshotVersion(x);u.os=u.os.insert(m,v)}}}(n.localStore,a))}async function cM(e,t){const r=Be(e);if(!r.currentUser.isEqual(t)){be("SyncEngine","User change. New user:",t.toKey());const n=await lS(r.localStore,t);r.currentUser=t,function(a,i){a.ka.forEach(o=>{o.forEach(l=>{l.reject(new Ne(fe.CANCELLED,i))})}),a.ka.clear()}(r,"'waitForPendingWrites' promise is rejected due to a user change."),r.sharedClientState.handleUserChange(t,n.removedBatchIds,n.addedBatchIds),await Du(r,n.hs)}}function uM(e,t){const r=Be(e),n=r.Na.get(t);if(n&&n.va)return Xe().add(n.key);{let s=Xe();const a=r.Ma.get(t);if(!a)return s;for(const i of a){const o=r.Fa.get(i);s=s.unionWith(o.view.Va)}return s}}function SS(e){const t=Be(e);return t.remoteStore.remoteSyncer.applyRemoteEvent=wS.bind(null,t),t.remoteStore.remoteSyncer.getRemoteKeysForTarget=uM.bind(null,t),t.remoteStore.remoteSyncer.rejectListen=aM.bind(null,t),t.Ca.d_=KO.bind(null,t.eventManager),t.Ca.$a=qO.bind(null,t.eventManager),t}function fM(e){const t=Be(e);return t.remoteStore.remoteSyncer.applySuccessfulWrite=iM.bind(null,t),t.remoteStore.remoteSyncer.rejectFailedWrite=oM.bind(null,t),t}class Hh{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(t){this.serializer=zd(t.databaseInfo.databaseId),this.sharedClientState=this.Wa(t),this.persistence=this.Ga(t),await this.persistence.start(),this.localStore=this.za(t),this.gcScheduler=this.ja(t,this.localStore),this.indexBackfillerScheduler=this.Ha(t,this.localStore)}ja(t,r){return null}Ha(t,r){return null}za(t){return vO(this.persistence,new pO,t.initialUser,this.serializer)}Ga(t){return new hO(vv.Zr,this.serializer)}Wa(t){return new kO}async terminate(){var t,r;(t=this.gcScheduler)===null||t===void 0||t.stop(),(r=this.indexBackfillerScheduler)===null||r===void 0||r.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}Hh.provider={build:()=>new Hh};class Ap{async initialize(t,r){this.localStore||(this.localStore=t.localStore,this.sharedClientState=t.sharedClientState,this.datastore=this.createDatastore(r),this.remoteStore=this.createRemoteStore(r),this.eventManager=this.createEventManager(r),this.syncEngine=this.createSyncEngine(r,!t.synchronizeTabs),this.sharedClientState.onlineStateHandler=n=>Sy(this.syncEngine,n,1),this.remoteStore.remoteSyncer.handleCredentialChange=cM.bind(null,this.syncEngine),await WO(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(t){return function(){return new GO}()}createDatastore(t){const r=zd(t.databaseInfo.databaseId),n=function(a){return new CO(a)}(t.databaseInfo);return function(a,i,o,l){return new bO(a,i,o,l)}(t.authCredentials,t.appCheckCredentials,n,r)}createRemoteStore(t){return function(n,s,a,i,o){return new DO(n,s,a,i,o)}(this.localStore,this.datastore,t.asyncQueue,r=>Sy(this.syncEngine,r,0),function(){return yy.D()?new yy:new SO}())}createSyncEngine(t,r){return function(s,a,i,o,l,c,u){const h=new JO(s,a,i,o,l,c);return u&&(h.Qa=!0),h}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,t.initialUser,t.maxConcurrentLimboResolutions,r)}async terminate(){var t,r;await async function(s){const a=Be(s);be("RemoteStore","RemoteStore shutting down."),a.L_.add(5),await Pu(a),a.k_.shutdown(),a.q_.set("Unknown")}(this.remoteStore),(t=this.datastore)===null||t===void 0||t.terminate(),(r=this.eventManager)===null||r===void 0||r.terminate()}}Ap.provider={build:()=>new Ap};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nv{constructor(t){this.observer=t,this.muted=!1}next(t){this.muted||this.observer.next&&this.Ya(this.observer.next,t)}error(t){this.muted||(this.observer.error?this.Ya(this.observer.error,t):da("Uncaught Error in snapshot listener:",t.toString()))}Za(){this.muted=!0}Ya(t,r){setTimeout(()=>{this.muted||t(r)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hM{constructor(t,r,n,s,a){this.authCredentials=t,this.appCheckCredentials=r,this.asyncQueue=n,this.databaseInfo=s,this.user=Dr.UNAUTHENTICATED,this.clientId=Ik.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=a,this.authCredentials.start(n,async i=>{be("FirestoreClient","Received user=",i.uid),await this.authCredentialListener(i),this.user=i}),this.appCheckCredentials.start(n,i=>(be("FirestoreClient","Received new app check token=",i),this.appCheckCredentialListener(i,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(t){this.authCredentialListener=t}setAppCheckTokenChangeListener(t){this.appCheckCredentialListener=t}terminate(){this.asyncQueue.enterRestrictedMode();const t=new ta;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),t.resolve()}catch(r){const n=kv(r,"Failed to shutdown persistence");t.reject(n)}}),t.promise}}async function X0(e,t){e.asyncQueue.verifyOperationInProgress(),be("FirestoreClient","Initializing OfflineComponentProvider");const r=e.configuration;await t.initialize(r);let n=r.initialUser;e.setCredentialChangeListener(async s=>{n.isEqual(s)||(await lS(t.localStore,s),n=s)}),t.persistence.setDatabaseDeletedListener(()=>e.terminate()),e._offlineComponents=t}async function Iy(e,t){e.asyncQueue.verifyOperationInProgress();const r=await dM(e);be("FirestoreClient","Initializing OnlineComponentProvider"),await t.initialize(r,e.configuration),e.setCredentialChangeListener(n=>wy(t.remoteStore,n)),e.setAppCheckTokenChangeListener((n,s)=>wy(t.remoteStore,s)),e._onlineComponents=t}async function dM(e){if(!e._offlineComponents)if(e._uninitializedComponentsProvider){be("FirestoreClient","Using user provided OfflineComponentProvider");try{await X0(e,e._uninitializedComponentsProvider._offline)}catch(t){const r=t;if(!function(s){return s.name==="FirebaseError"?s.code===fe.FAILED_PRECONDITION||s.code===fe.UNIMPLEMENTED:!(typeof DOMException<"u"&&s instanceof DOMException)||s.code===22||s.code===20||s.code===11}(r))throw r;il("Error using user provided cache. Falling back to memory cache: "+r),await X0(e,new Hh)}}else be("FirestoreClient","Using default OfflineComponentProvider"),await X0(e,new Hh);return e._offlineComponents}async function AS(e){return e._onlineComponents||(e._uninitializedComponentsProvider?(be("FirestoreClient","Using user provided OnlineComponentProvider"),await Iy(e,e._uninitializedComponentsProvider._online)):(be("FirestoreClient","Using default OnlineComponentProvider"),await Iy(e,new Ap))),e._onlineComponents}function mM(e){return AS(e).then(t=>t.syncEngine)}async function Gh(e){const t=await AS(e),r=t.eventManager;return r.onListen=ZO.bind(null,t.syncEngine),r.onUnlisten=rM.bind(null,t.syncEngine),r.onFirstRemoteStoreListen=eM.bind(null,t.syncEngine),r.onLastRemoteStoreUnlisten=nM.bind(null,t.syncEngine),r}function pM(e,t,r={}){const n=new ta;return e.asyncQueue.enqueueAndForget(async()=>function(a,i,o,l,c){const u=new Nv({next:m=>{u.Za(),i.enqueueAndForget(()=>Av(a,h));const p=m.docs.has(o);!p&&m.fromCache?c.reject(new Ne(fe.UNAVAILABLE,"Failed to get document because the client is offline.")):p&&m.fromCache&&l&&l.source==="server"?c.reject(new Ne(fe.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):c.resolve(m)},error:m=>c.reject(m)}),h=new Cv(Md(o.path),u,{includeMetadataChanges:!0,_a:!0});return Sv(a,h)}(await Gh(e),e.asyncQueue,t,r,n)),n.promise}function gM(e,t,r={}){const n=new ta;return e.asyncQueue.enqueueAndForget(async()=>function(a,i,o,l,c){const u=new Nv({next:m=>{u.Za(),i.enqueueAndForget(()=>Av(a,h)),m.fromCache&&l.source==="server"?c.reject(new Ne(fe.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):c.resolve(m)},error:m=>c.reject(m)}),h=new Cv(o,u,{includeMetadataChanges:!0,_a:!0});return Sv(a,h)}(await Gh(e),e.asyncQueue,t,r,n)),n.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function IS(e){const t={};return e.timeoutSeconds!==void 0&&(t.timeoutSeconds=e.timeoutSeconds),t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Cy=new Map;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function CS(e,t,r){if(!r)throw new Ne(fe.INVALID_ARGUMENT,`Function ${e}() cannot be called with an empty ${t}.`)}function vM(e,t,r,n){if(t===!0&&n===!0)throw new Ne(fe.INVALID_ARGUMENT,`${e} and ${r} cannot be used together.`)}function Ry(e){if(!Pe.isDocumentKey(e))throw new Ne(fe.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${e} has ${e.length}.`)}function Ny(e){if(Pe.isDocumentKey(e))throw new Ne(fe.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${e} has ${e.length}.`)}function Hd(e){if(e===void 0)return"undefined";if(e===null)return"null";if(typeof e=="string")return e.length>20&&(e=`${e.substring(0,20)}...`),JSON.stringify(e);if(typeof e=="number"||typeof e=="boolean")return""+e;if(typeof e=="object"){if(e instanceof Array)return"an array";{const t=function(n){return n.constructor?n.constructor.name:null}(e);return t?`a custom ${t} object`:"an object"}}return typeof e=="function"?"a function":Le()}function dn(e,t){if("_delegate"in e&&(e=e._delegate),!(e instanceof t)){if(t.name===e.constructor.name)throw new Ne(fe.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const r=Hd(e);throw new Ne(fe.INVALID_ARGUMENT,`Expected type '${t.name}', but it was: ${r}`)}}return e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class by{constructor(t){var r,n;if(t.host===void 0){if(t.ssl!==void 0)throw new Ne(fe.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=t.host,this.ssl=(r=t.ssl)===null||r===void 0||r;if(this.credentials=t.credentials,this.ignoreUndefinedProperties=!!t.ignoreUndefinedProperties,this.localCache=t.localCache,t.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(t.cacheSizeBytes!==-1&&t.cacheSizeBytes<1048576)throw new Ne(fe.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=t.cacheSizeBytes}vM("experimentalForceLongPolling",t.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",t.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!t.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:t.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!t.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=IS((n=t.experimentalLongPollingOptions)!==null&&n!==void 0?n:{}),function(a){if(a.timeoutSeconds!==void 0){if(isNaN(a.timeoutSeconds))throw new Ne(fe.INVALID_ARGUMENT,`invalid long polling timeout: ${a.timeoutSeconds} (must not be NaN)`);if(a.timeoutSeconds<5)throw new Ne(fe.INVALID_ARGUMENT,`invalid long polling timeout: ${a.timeoutSeconds} (minimum allowed value is 5)`);if(a.timeoutSeconds>30)throw new Ne(fe.INVALID_ARGUMENT,`invalid long polling timeout: ${a.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!t.useFetchStreams}isEqual(t){return this.host===t.host&&this.ssl===t.ssl&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.experimentalForceLongPolling===t.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===t.experimentalAutoDetectLongPolling&&function(n,s){return n.timeoutSeconds===s.timeoutSeconds}(this.experimentalLongPollingOptions,t.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties&&this.useFetchStreams===t.useFetchStreams}}class Gd{constructor(t,r,n,s){this._authCredentials=t,this._appCheckCredentials=r,this._databaseId=n,this._app=s,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new by({}),this._settingsFrozen=!1,this._terminateTask="notTerminated"}get app(){if(!this._app)throw new Ne(fe.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(t){if(this._settingsFrozen)throw new Ne(fe.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new by(t),t.credentials!==void 0&&(this._authCredentials=function(n){if(!n)return new M3;switch(n.type){case"firstParty":return new U3(n.sessionIndex||"0",n.iamToken||null,n.authTokenFactory||null);case"provider":return n.client;default:throw new Ne(fe.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(t.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(r){const n=Cy.get(r);n&&(be("ComponentProvider","Removing Datastore"),Cy.delete(r),n.terminate())}(this),Promise.resolve()}}function xM(e,t,r,n={}){var s;const a=(e=dn(e,Gd))._getSettings(),i=`${t}:${r}`;if(a.host!=="firestore.googleapis.com"&&a.host!==i&&il("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),e._setSettings(Object.assign(Object.assign({},a),{host:i,ssl:!1})),n.mockUserToken){let o,l;if(typeof n.mockUserToken=="string")o=n.mockUserToken,l=Dr.MOCK_USER;else{o=FT(n.mockUserToken,(s=e._app)===null||s===void 0?void 0:s.options.projectId);const c=n.mockUserToken.sub||n.mockUserToken.user_id;if(!c)throw new Ne(fe.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");l=new Dr(c)}e._authCredentials=new L3(new Ak(o,l))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ro{constructor(t,r,n){this.converter=r,this._query=n,this.type="query",this.firestore=t}withConverter(t){return new ro(this.firestore,t,this._query)}}class Vr{constructor(t,r,n){this.converter=r,this._key=n,this.type="document",this.firestore=t}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Za(this.firestore,this.converter,this._key.path.popLast())}withConverter(t){return new Vr(this.firestore,t,this._key)}}class Za extends ro{constructor(t,r,n){super(t,r,Md(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const t=this._path.popLast();return t.isEmpty()?null:new Vr(this.firestore,null,new Pe(t))}withConverter(t){return new Za(this.firestore,t,this._path)}}function mn(e,t,...r){if(e=Ht(e),CS("collection","path",t),e instanceof Gd){const n=Ct.fromString(t,...r);return Ny(n),new Za(e,null,n)}{if(!(e instanceof Vr||e instanceof Za))throw new Ne(fe.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=e._path.child(Ct.fromString(t,...r));return Ny(n),new Za(e.firestore,null,n)}}function Yr(e,t,...r){if(e=Ht(e),arguments.length===1&&(t=Ik.newId()),CS("doc","path",t),e instanceof Gd){const n=Ct.fromString(t,...r);return Ry(n),new Vr(e,null,new Pe(n))}{if(!(e instanceof Vr||e instanceof Za))throw new Ne(fe.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=e._path.child(Ct.fromString(t,...r));return Ry(n),new Vr(e.firestore,e instanceof Za?e.converter:null,new Pe(n))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Py{constructor(t=Promise.resolve()){this.Pu=[],this.Iu=!1,this.Tu=[],this.Eu=null,this.du=!1,this.Au=!1,this.Ru=[],this.t_=new uS(this,"async_queue_retry"),this.Vu=()=>{const n=q0();n&&be("AsyncQueue","Visibility state changed to "+n.visibilityState),this.t_.jo()},this.mu=t;const r=q0();r&&typeof r.addEventListener=="function"&&r.addEventListener("visibilitychange",this.Vu)}get isShuttingDown(){return this.Iu}enqueueAndForget(t){this.enqueue(t)}enqueueAndForgetEvenWhileRestricted(t){this.fu(),this.gu(t)}enterRestrictedMode(t){if(!this.Iu){this.Iu=!0,this.Au=t||!1;const r=q0();r&&typeof r.removeEventListener=="function"&&r.removeEventListener("visibilitychange",this.Vu)}}enqueue(t){if(this.fu(),this.Iu)return new Promise(()=>{});const r=new ta;return this.gu(()=>this.Iu&&this.Au?Promise.resolve():(t().then(r.resolve,r.reject),r.promise)).then(()=>r.promise)}enqueueRetryable(t){this.enqueueAndForget(()=>(this.Pu.push(t),this.pu()))}async pu(){if(this.Pu.length!==0){try{await this.Pu[0](),this.Pu.shift(),this.t_.reset()}catch(t){if(!Cu(t))throw t;be("AsyncQueue","Operation failed with retryable error: "+t)}this.Pu.length>0&&this.t_.Go(()=>this.pu())}}gu(t){const r=this.mu.then(()=>(this.du=!0,t().catch(n=>{this.Eu=n,this.du=!1;const s=function(i){let o=i.message||"";return i.stack&&(o=i.stack.includes(i.message)?i.stack:i.message+`
`+i.stack),o}(n);throw da("INTERNAL UNHANDLED ERROR: ",s),n}).then(n=>(this.du=!1,n))));return this.mu=r,r}enqueueAfterDelay(t,r,n){this.fu(),this.Ru.indexOf(t)>-1&&(r=0);const s=Tv.createAndSchedule(this,t,r,n,a=>this.yu(a));return this.Tu.push(s),s}fu(){this.Eu&&Le()}verifyOperationInProgress(){}async wu(){let t;do t=this.mu,await t;while(t!==this.mu)}Su(t){for(const r of this.Tu)if(r.timerId===t)return!0;return!1}bu(t){return this.wu().then(()=>{this.Tu.sort((r,n)=>r.targetTimeMs-n.targetTimeMs);for(const r of this.Tu)if(r.skipDelay(),t!=="all"&&r.timerId===t)break;return this.wu()})}Du(t){this.Ru.push(t)}yu(t){const r=this.Tu.indexOf(t);this.Tu.splice(r,1)}}function Dy(e){return function(r,n){if(typeof r!="object"||r===null)return!1;const s=r;for(const a of n)if(a in s&&typeof s[a]=="function")return!0;return!1}(e,["next","error","complete"])}class pa extends Gd{constructor(t,r,n,s){super(t,r,n,s),this.type="firestore",this._queue=new Py,this._persistenceKey=(s==null?void 0:s.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const t=this._firestoreClient.terminate();this._queue=new Py(t),this._firestoreClient=void 0,await t}}}function _M(e,t){const r=typeof e=="object"?e:bd(),n=typeof e=="string"?e:"(default)",s=Tu(r,"firestore").getImmediate({identifier:n});if(!s._initialized){const a=Wg("firestore");a&&xM(s,...a)}return s}function Kd(e){if(e._terminated)throw new Ne(fe.FAILED_PRECONDITION,"The client has already been terminated.");return e._firestoreClient||yM(e),e._firestoreClient}function yM(e){var t,r,n;const s=e._freezeSettings(),a=function(o,l,c,u){return new Z3(o,l,c,u.host,u.ssl,u.experimentalForceLongPolling,u.experimentalAutoDetectLongPolling,IS(u.experimentalLongPollingOptions),u.useFetchStreams)}(e._databaseId,((t=e._app)===null||t===void 0?void 0:t.options.appId)||"",e._persistenceKey,s);e._componentsProvider||!((r=s.localCache)===null||r===void 0)&&r._offlineComponentProvider&&(!((n=s.localCache)===null||n===void 0)&&n._onlineComponentProvider)&&(e._componentsProvider={_offline:s.localCache._offlineComponentProvider,_online:s.localCache._onlineComponentProvider}),e._firestoreClient=new hM(e._authCredentials,e._appCheckCredentials,e._queue,a,e._componentsProvider&&function(o){const l=o==null?void 0:o._online.build();return{_offline:o==null?void 0:o._offline.build(l),_online:l}}(e._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hl{constructor(t){this._byteString=t}static fromBase64String(t){try{return new hl(Sr.fromBase64String(t))}catch(r){throw new Ne(fe.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+r)}}static fromUint8Array(t){return new hl(Sr.fromUint8Array(t))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(t){return this._byteString.isEqual(t._byteString)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qd{constructor(...t){for(let r=0;r<t.length;++r)if(t[r].length===0)throw new Ne(fe.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new _r(t)}isEqual(t){return this._internalPath.isEqual(t._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fu{constructor(t){this._methodName=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bv{constructor(t,r){if(!isFinite(t)||t<-90||t>90)throw new Ne(fe.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(r)||r<-180||r>180)throw new Ne(fe.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+r);this._lat=t,this._long=r}get latitude(){return this._lat}get longitude(){return this._long}isEqual(t){return this._lat===t._lat&&this._long===t._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(t){return ct(this._lat,t._lat)||ct(this._long,t._long)}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pv{constructor(t){this._values=(t||[]).map(r=>r)}toArray(){return this._values.map(t=>t)}isEqual(t){return function(n,s){if(n.length!==s.length)return!1;for(let a=0;a<n.length;++a)if(n[a]!==s[a])return!1;return!0}(this._values,t._values)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wM=/^__.*__$/;class EM{constructor(t,r,n){this.data=t,this.fieldMask=r,this.fieldTransforms=n}toMutation(t,r){return this.fieldMask!==null?new pi(t,this.data,this.fieldMask,r,this.fieldTransforms):new Nu(t,this.data,r,this.fieldTransforms)}}class RS{constructor(t,r,n){this.data=t,this.fieldMask=r,this.fieldTransforms=n}toMutation(t,r){return new pi(t,this.data,this.fieldMask,r,this.fieldTransforms)}}function NS(e){switch(e){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Le()}}class Dv{constructor(t,r,n,s,a,i){this.settings=t,this.databaseId=r,this.serializer=n,this.ignoreUndefinedProperties=s,a===void 0&&this.vu(),this.fieldTransforms=a||[],this.fieldMask=i||[]}get path(){return this.settings.path}get Cu(){return this.settings.Cu}Fu(t){return new Dv(Object.assign(Object.assign({},this.settings),t),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Mu(t){var r;const n=(r=this.path)===null||r===void 0?void 0:r.child(t),s=this.Fu({path:n,xu:!1});return s.Ou(t),s}Nu(t){var r;const n=(r=this.path)===null||r===void 0?void 0:r.child(t),s=this.Fu({path:n,xu:!1});return s.vu(),s}Lu(t){return this.Fu({path:void 0,xu:!0})}Bu(t){return Kh(t,this.settings.methodName,this.settings.ku||!1,this.path,this.settings.qu)}contains(t){return this.fieldMask.find(r=>t.isPrefixOf(r))!==void 0||this.fieldTransforms.find(r=>t.isPrefixOf(r.field))!==void 0}vu(){if(this.path)for(let t=0;t<this.path.length;t++)this.Ou(this.path.get(t))}Ou(t){if(t.length===0)throw this.Bu("Document fields must not be empty");if(NS(this.Cu)&&wM.test(t))throw this.Bu('Document fields cannot begin and end with "__"')}}class TM{constructor(t,r,n){this.databaseId=t,this.ignoreUndefinedProperties=r,this.serializer=n||zd(t)}Qu(t,r,n,s=!1){return new Dv({Cu:t,methodName:r,qu:n,path:_r.emptyPath(),xu:!1,ku:s},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function Xd(e){const t=e._freezeSettings(),r=zd(e._databaseId);return new TM(e._databaseId,!!t.ignoreUndefinedProperties,r)}function bS(e,t,r,n,s,a={}){const i=e.Qu(a.merge||a.mergeFields?2:0,t,r,s);Mv("Data must be an object, but it was:",i,n);const o=PS(n,i);let l,c;if(a.merge)l=new En(i.fieldMask),c=i.fieldTransforms;else if(a.mergeFields){const u=[];for(const h of a.mergeFields){const m=Ip(t,h,r);if(!i.contains(m))throw new Ne(fe.INVALID_ARGUMENT,`Field '${m}' is specified in your field mask but missing from your input data.`);FS(u,m)||u.push(m)}l=new En(u),c=i.fieldTransforms.filter(h=>l.covers(h.field))}else l=null,c=i.fieldTransforms;return new EM(new ln(o),l,c)}class Yd extends Fu{_toFieldTransform(t){if(t.Cu!==2)throw t.Cu===1?t.Bu(`${this._methodName}() can only appear at the top level of your update data`):t.Bu(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return t.fieldMask.push(t.path),null}isEqual(t){return t instanceof Yd}}class Fv extends Fu{_toFieldTransform(t){return new Xk(t.path,new ru)}isEqual(t){return t instanceof Fv}}class Ov extends Fu{constructor(t,r){super(t),this.$u=r}_toFieldTransform(t){const r=new au(t.serializer,Wk(t.serializer,this.$u));return new Xk(t.path,r)}isEqual(t){return t instanceof Ov&&this.$u===t.$u}}function kM(e,t,r,n){const s=e.Qu(1,t,r);Mv("Data must be an object, but it was:",s,n);const a=[],i=ln.empty();eo(n,(l,c)=>{const u=Lv(t,l,r);c=Ht(c);const h=s.Nu(u);if(c instanceof Yd)a.push(u);else{const m=Ou(c,h);m!=null&&(a.push(u),i.set(u,m))}});const o=new En(a);return new RS(i,o,s.fieldTransforms)}function SM(e,t,r,n,s,a){const i=e.Qu(1,t,r),o=[Ip(t,n,r)],l=[s];if(a.length%2!=0)throw new Ne(fe.INVALID_ARGUMENT,`Function ${t}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let m=0;m<a.length;m+=2)o.push(Ip(t,a[m])),l.push(a[m+1]);const c=[],u=ln.empty();for(let m=o.length-1;m>=0;--m)if(!FS(c,o[m])){const p=o[m];let x=l[m];x=Ht(x);const v=i.Nu(p);if(x instanceof Yd)c.push(p);else{const w=Ou(x,v);w!=null&&(c.push(p),u.set(p,w))}}const h=new En(c);return new RS(u,h,i.fieldTransforms)}function AM(e,t,r,n=!1){return Ou(r,e.Qu(n?4:3,t))}function Ou(e,t){if(DS(e=Ht(e)))return Mv("Unsupported field value:",t,e),PS(e,t);if(e instanceof Fu)return function(n,s){if(!NS(s.Cu))throw s.Bu(`${n._methodName}() can only be used with update() and set()`);if(!s.path)throw s.Bu(`${n._methodName}() is not currently supported inside arrays`);const a=n._toFieldTransform(s);a&&s.fieldTransforms.push(a)}(e,t),null;if(e===void 0&&t.ignoreUndefinedProperties)return null;if(t.path&&t.fieldMask.push(t.path),e instanceof Array){if(t.settings.xu&&t.Cu!==4)throw t.Bu("Nested arrays are not supported");return function(n,s){const a=[];let i=0;for(const o of n){let l=Ou(o,s.Lu(i));l==null&&(l={nullValue:"NULL_VALUE"}),a.push(l),i++}return{arrayValue:{values:a}}}(e,t)}return function(n,s){if((n=Ht(n))===null)return{nullValue:"NULL_VALUE"};if(typeof n=="number")return Wk(s.serializer,n);if(typeof n=="boolean")return{booleanValue:n};if(typeof n=="string")return{stringValue:n};if(n instanceof Date){const a=ar.fromDate(n);return{timestampValue:$h(s.serializer,a)}}if(n instanceof ar){const a=new ar(n.seconds,1e3*Math.floor(n.nanoseconds/1e3));return{timestampValue:$h(s.serializer,a)}}if(n instanceof bv)return{geoPointValue:{latitude:n.latitude,longitude:n.longitude}};if(n instanceof hl)return{bytesValue:tS(s.serializer,n._byteString)};if(n instanceof Vr){const a=s.databaseId,i=n.firestore._databaseId;if(!i.isEqual(a))throw s.Bu(`Document reference is for database ${i.projectId}/${i.database} but should be for database ${a.projectId}/${a.database}`);return{referenceValue:pv(n.firestore._databaseId||s.databaseId,n._key.path)}}if(n instanceof Pv)return function(i,o){return{mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{values:i.toArray().map(l=>{if(typeof l!="number")throw o.Bu("VectorValues must only contain numeric values.");return fv(o.serializer,l)})}}}}}}(n,s);throw s.Bu(`Unsupported field value: ${Hd(n)}`)}(e,t)}function PS(e,t){const r={};return Ck(e)?t.path&&t.path.length>0&&t.fieldMask.push(t.path):eo(e,(n,s)=>{const a=Ou(s,t.Mu(n));a!=null&&(r[n]=a)}),{mapValue:{fields:r}}}function DS(e){return!(typeof e!="object"||e===null||e instanceof Array||e instanceof Date||e instanceof ar||e instanceof bv||e instanceof hl||e instanceof Vr||e instanceof Fu||e instanceof Pv)}function Mv(e,t,r){if(!DS(r)||!function(s){return typeof s=="object"&&s!==null&&(Object.getPrototypeOf(s)===Object.prototype||Object.getPrototypeOf(s)===null)}(r)){const n=Hd(r);throw n==="an object"?t.Bu(e+" a custom object"):t.Bu(e+" "+n)}}function Ip(e,t,r){if((t=Ht(t))instanceof qd)return t._internalPath;if(typeof t=="string")return Lv(e,t);throw Kh("Field path arguments must be of type string or ",e,!1,void 0,r)}const IM=new RegExp("[~\\*/\\[\\]]");function Lv(e,t,r){if(t.search(IM)>=0)throw Kh(`Invalid field path (${t}). Paths must not contain '~', '*', '/', '[', or ']'`,e,!1,void 0,r);try{return new qd(...t.split("."))._internalPath}catch{throw Kh(`Invalid field path (${t}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,e,!1,void 0,r)}}function Kh(e,t,r,n,s){const a=n&&!n.isEmpty(),i=s!==void 0;let o=`Function ${t}() called with invalid data`;r&&(o+=" (via `toFirestore()`)"),o+=". ";let l="";return(a||i)&&(l+=" (found",a&&(l+=` in field ${n}`),i&&(l+=` in document ${s}`),l+=")"),new Ne(fe.INVALID_ARGUMENT,o+e+l)}function FS(e,t){return e.some(r=>r.isEqual(t))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OS{constructor(t,r,n,s,a){this._firestore=t,this._userDataWriter=r,this._key=n,this._document=s,this._converter=a}get id(){return this._key.path.lastSegment()}get ref(){return new Vr(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const t=new CM(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(t)}return this._userDataWriter.convertValue(this._document.data.value)}}get(t){if(this._document){const r=this._document.data.field(jv("DocumentSnapshot.get",t));if(r!==null)return this._userDataWriter.convertValue(r)}}}class CM extends OS{data(){return super.data()}}function jv(e,t){return typeof t=="string"?Lv(e,t):t instanceof qd?t._internalPath:t._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function MS(e){if(e.limitType==="L"&&e.explicitOrderBy.length===0)throw new Ne(fe.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class Vv{}class RM extends Vv{}function qh(e,t,...r){let n=[];t instanceof Vv&&n.push(t),n=n.concat(r),function(a){const i=a.filter(l=>l instanceof Uv).length,o=a.filter(l=>l instanceof Qd).length;if(i>1||i>0&&o>0)throw new Ne(fe.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(n);for(const s of n)e=s._apply(e);return e}class Qd extends RM{constructor(t,r,n){super(),this._field=t,this._op=r,this._value=n,this.type="where"}static _create(t,r,n){return new Qd(t,r,n)}_apply(t){const r=this._parse(t);return LS(t._query,r),new ro(t.firestore,t.converter,vp(t._query,r))}_parse(t){const r=Xd(t.firestore);return function(a,i,o,l,c,u,h){let m;if(c.isKeyField()){if(u==="array-contains"||u==="array-contains-any")throw new Ne(fe.INVALID_ARGUMENT,`Invalid Query. You can't perform '${u}' queries on documentId().`);if(u==="in"||u==="not-in"){Oy(h,u);const p=[];for(const x of h)p.push(Fy(l,a,x));m={arrayValue:{values:p}}}else m=Fy(l,a,h)}else u!=="in"&&u!=="not-in"&&u!=="array-contains-any"||Oy(h,u),m=AM(o,i,h,u==="in"||u==="not-in");return Zt.create(c,u,m)}(t._query,"where",r,t.firestore._databaseId,this._field,this._op,this._value)}}function Xh(e,t,r){const n=t,s=jv("where",e);return Qd._create(s,n,r)}class Uv extends Vv{constructor(t,r){super(),this.type=t,this._queryConstraints=r}static _create(t,r){return new Uv(t,r)}_parse(t){const r=this._queryConstraints.map(n=>n._parse(t)).filter(n=>n.getFilters().length>0);return r.length===1?r[0]:us.create(r,this._getOperator())}_apply(t){const r=this._parse(t);return r.getFilters().length===0?t:(function(s,a){let i=s;const o=a.getFlattenedFilters();for(const l of o)LS(i,l),i=vp(i,l)}(t._query,r),new ro(t.firestore,t.converter,vp(t._query,r)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}function Fy(e,t,r){if(typeof(r=Ht(r))=="string"){if(r==="")throw new Ne(fe.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!Lk(t)&&r.indexOf("/")!==-1)throw new Ne(fe.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${r}' contains a '/' character.`);const n=t.path.child(Ct.fromString(r));if(!Pe.isDocumentKey(n))throw new Ne(fe.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${n}' is not because it has an odd number of segments (${n.length}).`);return ty(e,new Pe(n))}if(r instanceof Vr)return ty(e,r._key);throw new Ne(fe.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${Hd(r)}.`)}function Oy(e,t){if(!Array.isArray(e)||e.length===0)throw new Ne(fe.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${t.toString()}' filters.`)}function LS(e,t){const r=function(s,a){for(const i of s)for(const o of i.getFlattenedFilters())if(a.indexOf(o.op)>=0)return o.op;return null}(e.filters,function(s){switch(s){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(t.op));if(r!==null)throw r===t.op?new Ne(fe.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${t.op.toString()}' filter.`):new Ne(fe.INVALID_ARGUMENT,`Invalid query. You cannot use '${t.op.toString()}' filters with '${r.toString()}' filters.`)}class NM{convertValue(t,r="none"){switch(Ki(t)){case 0:return null;case 1:return t.booleanValue;case 2:return $t(t.integerValue||t.doubleValue);case 3:return this.convertTimestamp(t.timestampValue);case 4:return this.convertServerTimestamp(t,r);case 5:return t.stringValue;case 6:return this.convertBytes(Gi(t.bytesValue));case 7:return this.convertReference(t.referenceValue);case 8:return this.convertGeoPoint(t.geoPointValue);case 9:return this.convertArray(t.arrayValue,r);case 11:return this.convertObject(t.mapValue,r);case 10:return this.convertVectorValue(t.mapValue);default:throw Le()}}convertObject(t,r){return this.convertObjectMap(t.fields,r)}convertObjectMap(t,r="none"){const n={};return eo(t,(s,a)=>{n[s]=this.convertValue(a,r)}),n}convertVectorValue(t){var r,n,s;const a=(s=(n=(r=t.fields)===null||r===void 0?void 0:r.value.arrayValue)===null||n===void 0?void 0:n.values)===null||s===void 0?void 0:s.map(i=>$t(i.doubleValue));return new Pv(a)}convertGeoPoint(t){return new bv($t(t.latitude),$t(t.longitude))}convertArray(t,r){return(t.values||[]).map(n=>this.convertValue(n,r))}convertServerTimestamp(t,r){switch(r){case"previous":const n=ov(t);return n==null?null:this.convertValue(n,r);case"estimate":return this.convertTimestamp(Zc(t));default:return null}}convertTimestamp(t){const r=ai(t);return new ar(r.seconds,r.nanos)}convertDocumentKey(t,r){const n=Ct.fromString(t);gt(oS(n));const s=new eu(n.get(1),n.get(3)),a=new Pe(n.popFirst(5));return s.isEqual(r)||da(`Document ${a} contains a document reference within a different database (${s.projectId}/${s.database}) which is not supported. It will be treated as a reference in the current database (${r.projectId}/${r.database}) instead.`),a}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jS(e,t,r){let n;return n=e?r&&(r.merge||r.mergeFields)?e.toFirestore(t,r):e.toFirestore(t):t,n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rc{constructor(t,r){this.hasPendingWrites=t,this.fromCache=r}isEqual(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache}}class VS extends OS{constructor(t,r,n,s,a,i){super(t,r,n,s,i),this._firestore=t,this._firestoreImpl=t,this.metadata=a}exists(){return super.exists()}data(t={}){if(this._document){if(this._converter){const r=new rh(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(r,t)}return this._userDataWriter.convertValue(this._document.data.value,t.serverTimestamps)}}get(t,r={}){if(this._document){const n=this._document.data.field(jv("DocumentSnapshot.get",t));if(n!==null)return this._userDataWriter.convertValue(n,r.serverTimestamps)}}}class rh extends VS{data(t={}){return super.data(t)}}class US{constructor(t,r,n,s){this._firestore=t,this._userDataWriter=r,this._snapshot=s,this.metadata=new rc(s.hasPendingWrites,s.fromCache),this.query=n}get docs(){const t=[];return this.forEach(r=>t.push(r)),t}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(t,r){this._snapshot.docs.forEach(n=>{t.call(r,new rh(this._firestore,this._userDataWriter,n.key,n,new rc(this._snapshot.mutatedKeys.has(n.key),this._snapshot.fromCache),this.query.converter))})}docChanges(t={}){const r=!!t.includeMetadataChanges;if(r&&this._snapshot.excludesMetadataChanges)throw new Ne(fe.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===r||(this._cachedChanges=function(s,a){if(s._snapshot.oldDocs.isEmpty()){let i=0;return s._snapshot.docChanges.map(o=>{const l=new rh(s._firestore,s._userDataWriter,o.doc.key,o.doc,new rc(s._snapshot.mutatedKeys.has(o.doc.key),s._snapshot.fromCache),s.query.converter);return o.doc,{type:"added",doc:l,oldIndex:-1,newIndex:i++}})}{let i=s._snapshot.oldDocs;return s._snapshot.docChanges.filter(o=>a||o.type!==3).map(o=>{const l=new rh(s._firestore,s._userDataWriter,o.doc.key,o.doc,new rc(s._snapshot.mutatedKeys.has(o.doc.key),s._snapshot.fromCache),s.query.converter);let c=-1,u=-1;return o.type!==0&&(c=i.indexOf(o.doc.key),i=i.delete(o.doc.key)),o.type!==1&&(i=i.add(o.doc),u=i.indexOf(o.doc.key)),{type:bM(o.type),doc:l,oldIndex:c,newIndex:u}})}}(this,r),this._cachedChangesIncludeMetadataChanges=r),this._cachedChanges}}function bM(e){switch(e){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Le()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ra(e){e=dn(e,Vr);const t=dn(e.firestore,pa);return pM(Kd(t),e._key).then(r=>BS(t,e,r))}class Bv extends NM{constructor(t){super(),this.firestore=t}convertBytes(t){return new hl(t)}convertReference(t){const r=this.convertDocumentKey(t,this.firestore._databaseId);return new Vr(this.firestore,null,r)}}function kn(e){e=dn(e,ro);const t=dn(e.firestore,pa),r=Kd(t),n=new Bv(t);return MS(e._query),gM(r,e._query).then(s=>new US(t,n,e,s))}function oi(e,t,r){e=dn(e,Vr);const n=dn(e.firestore,pa),s=jS(e.converter,t,r);return Jd(n,[bS(Xd(n),"setDoc",e._key,s,e.converter!==null,r).toMutation(e._key,Un.none())])}function dl(e,t,r,...n){e=dn(e,Vr);const s=dn(e.firestore,pa),a=Xd(s);let i;return i=typeof(t=Ht(t))=="string"||t instanceof qd?SM(a,"updateDoc",e._key,t,r,n):kM(a,"updateDoc",e._key,t),Jd(s,[i.toMutation(e._key,Un.exists(!0))])}function PM(e){return Jd(dn(e.firestore,pa),[new hv(e._key,Un.none())])}function zv(e,t){const r=dn(e.firestore,pa),n=Yr(e),s=jS(e.converter,t);return Jd(r,[bS(Xd(e.firestore),"addDoc",n._key,s,e.converter!==null,{}).toMutation(n._key,Un.exists(!1))]).then(()=>n)}function DM(e,...t){var r,n,s;e=Ht(e);let a={includeMetadataChanges:!1,source:"default"},i=0;typeof t[i]!="object"||Dy(t[i])||(a=t[i],i++);const o={includeMetadataChanges:a.includeMetadataChanges,source:a.source};if(Dy(t[i])){const h=t[i];t[i]=(r=h.next)===null||r===void 0?void 0:r.bind(h),t[i+1]=(n=h.error)===null||n===void 0?void 0:n.bind(h),t[i+2]=(s=h.complete)===null||s===void 0?void 0:s.bind(h)}let l,c,u;if(e instanceof Vr)c=dn(e.firestore,pa),u=Md(e._key.path),l={next:h=>{t[i]&&t[i](BS(c,e,h))},error:t[i+1],complete:t[i+2]};else{const h=dn(e,ro);c=dn(h.firestore,pa),u=h._query;const m=new Bv(c);l={next:p=>{t[i]&&t[i](new US(c,m,h,p))},error:t[i+1],complete:t[i+2]},MS(e._query)}return function(m,p,x,v){const w=new Nv(v),k=new Cv(p,w,x);return m.asyncQueue.enqueueAndForget(async()=>Sv(await Gh(m),k)),()=>{w.Za(),m.asyncQueue.enqueueAndForget(async()=>Av(await Gh(m),k))}}(Kd(c),u,o,l)}function Jd(e,t){return function(n,s){const a=new ta;return n.asyncQueue.enqueueAndForget(async()=>sM(await mM(n),s,a)),a.promise}(Kd(e),t)}function BS(e,t,r){const n=r.docs.get(t._key),s=new Bv(e);return new VS(e,s,t._key,n,new rc(r.hasPendingWrites,r.fromCache),t.converter)}function FM(){return new Fv("serverTimestamp")}function OM(e){return new Ov("increment",e)}(function(t,r=!0){(function(s){wl=s})(Zi),ni(new ua("firestore",(n,{instanceIdentifier:s,options:a})=>{const i=n.getProvider("app").getImmediate(),o=new pa(new j3(n.getProvider("auth-internal")),new z3(n.getProvider("app-check-internal")),function(c,u){if(!Object.prototype.hasOwnProperty.apply(c.options,["projectId"]))throw new Ne(fe.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new eu(c.options.projectId,u)}(i,s),i);return a=Object.assign({useFetchStreams:r},a),o._setSettings(a),o},"PUBLIC").setMultipleInstances(!0)),Vn(Y_,"4.7.3",t),Vn(Y_,"4.7.3","esm2017")})();var MM="firebase",LM="10.14.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Vn(MM,LM,"app");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zS="firebasestorage.googleapis.com",jM="storageBucket",VM=2*60*1e3,UM=10*60*1e3;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ds extends Ps{constructor(t,r,n=0){super(Y0(t),`Firebase Storage: ${r} (${Y0(t)})`),this.status_=n,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,Ds.prototype)}get status(){return this.status_}set status(t){this.status_=t}_codeEquals(t){return Y0(t)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(t){this.customData.serverResponse=t,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}var Rs;(function(e){e.UNKNOWN="unknown",e.OBJECT_NOT_FOUND="object-not-found",e.BUCKET_NOT_FOUND="bucket-not-found",e.PROJECT_NOT_FOUND="project-not-found",e.QUOTA_EXCEEDED="quota-exceeded",e.UNAUTHENTICATED="unauthenticated",e.UNAUTHORIZED="unauthorized",e.UNAUTHORIZED_APP="unauthorized-app",e.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",e.INVALID_CHECKSUM="invalid-checksum",e.CANCELED="canceled",e.INVALID_EVENT_NAME="invalid-event-name",e.INVALID_URL="invalid-url",e.INVALID_DEFAULT_BUCKET="invalid-default-bucket",e.NO_DEFAULT_BUCKET="no-default-bucket",e.CANNOT_SLICE_BLOB="cannot-slice-blob",e.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",e.NO_DOWNLOAD_URL="no-download-url",e.INVALID_ARGUMENT="invalid-argument",e.INVALID_ARGUMENT_COUNT="invalid-argument-count",e.APP_DELETED="app-deleted",e.INVALID_ROOT_OPERATION="invalid-root-operation",e.INVALID_FORMAT="invalid-format",e.INTERNAL_ERROR="internal-error",e.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})(Rs||(Rs={}));function Y0(e){return"storage/"+e}function BM(){const e="An unknown error occurred, please check the error payload for server response.";return new Ds(Rs.UNKNOWN,e)}function zM(){return new Ds(Rs.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function $M(){return new Ds(Rs.CANCELED,"User canceled the upload/download.")}function WM(e){return new Ds(Rs.INVALID_URL,"Invalid URL '"+e+"'.")}function HM(e){return new Ds(Rs.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+e+"'.")}function My(e){return new Ds(Rs.INVALID_ARGUMENT,e)}function $S(){return new Ds(Rs.APP_DELETED,"The Firebase app was deleted.")}function GM(e){return new Ds(Rs.INVALID_ROOT_OPERATION,"The operation '"+e+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rs{constructor(t,r){this.bucket=t,this.path_=r}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const t=encodeURIComponent;return"/b/"+t(this.bucket)+"/o/"+t(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(t,r){let n;try{n=rs.makeFromUrl(t,r)}catch{return new rs(t,"")}if(n.path==="")return n;throw HM(t)}static makeFromUrl(t,r){let n=null;const s="([A-Za-z0-9.\\-_]+)";function a(N){N.path.charAt(N.path.length-1)==="/"&&(N.path_=N.path_.slice(0,-1))}const i="(/(.*))?$",o=new RegExp("^gs://"+s+i,"i"),l={bucket:1,path:3};function c(N){N.path_=decodeURIComponent(N.path)}const u="v[A-Za-z0-9_]+",h=r.replace(/[.]/g,"\\."),m="(/([^?#]*).*)?$",p=new RegExp(`^https?://${h}/${u}/b/${s}/o${m}`,"i"),x={bucket:1,path:3},v=r===zS?"(?:storage.googleapis.com|storage.cloud.google.com)":r,w="([^?#]*)",k=new RegExp(`^https?://${v}/${s}/${w}`,"i"),E=[{regex:o,indices:l,postModify:a},{regex:p,indices:x,postModify:c},{regex:k,indices:{bucket:1,path:2},postModify:c}];for(let N=0;N<E.length;N++){const O=E[N],L=O.regex.exec(t);if(L){const g=L[O.indices.bucket];let y=L[O.indices.path];y||(y=""),n=new rs(g,y),O.postModify(n);break}}if(n==null)throw WM(t);return n}}class KM{constructor(t){this.promise_=Promise.reject(t)}getPromise(){return this.promise_}cancel(t=!1){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qM(e,t,r){let n=1,s=null,a=null,i=!1,o=0;function l(){return o===2}let c=!1;function u(...w){c||(c=!0,t.apply(null,w))}function h(w){s=setTimeout(()=>{s=null,e(p,l())},w)}function m(){a&&clearTimeout(a)}function p(w,...k){if(c){m();return}if(w){m(),u.call(null,w,...k);return}if(l()||i){m(),u.call(null,w,...k);return}n<64&&(n*=2);let E;o===1?(o=2,E=0):E=(n+Math.random())*1e3,h(E)}let x=!1;function v(w){x||(x=!0,m(),!c&&(s!==null?(w||(o=2),clearTimeout(s),h(0)):w||(o=1)))}return h(0),a=setTimeout(()=>{i=!0,v(!0)},r),v}function XM(e){e(!1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function YM(e){return e!==void 0}function Ly(e,t,r,n){if(n<t)throw My(`Invalid value for '${e}'. Expected ${t} or greater.`);if(n>r)throw My(`Invalid value for '${e}'. Expected ${r} or less.`)}function QM(e){const t=encodeURIComponent;let r="?";for(const n in e)if(e.hasOwnProperty(n)){const s=t(n)+"="+t(e[n]);r=r+s+"&"}return r=r.slice(0,-1),r}var Yh;(function(e){e[e.NO_ERROR=0]="NO_ERROR",e[e.NETWORK_ERROR=1]="NETWORK_ERROR",e[e.ABORT=2]="ABORT"})(Yh||(Yh={}));/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function JM(e,t){const r=e>=500&&e<600,s=[408,429].indexOf(e)!==-1,a=t.indexOf(e)!==-1;return r||s||a}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZM{constructor(t,r,n,s,a,i,o,l,c,u,h,m=!0){this.url_=t,this.method_=r,this.headers_=n,this.body_=s,this.successCodes_=a,this.additionalRetryCodes_=i,this.callback_=o,this.errorCallback_=l,this.timeout_=c,this.progressCallback_=u,this.connectionFactory_=h,this.retry=m,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((p,x)=>{this.resolve_=p,this.reject_=x,this.start_()})}start_(){const t=(n,s)=>{if(s){n(!1,new Sf(!1,null,!0));return}const a=this.connectionFactory_();this.pendingConnection_=a;const i=o=>{const l=o.loaded,c=o.lengthComputable?o.total:-1;this.progressCallback_!==null&&this.progressCallback_(l,c)};this.progressCallback_!==null&&a.addUploadProgressListener(i),a.send(this.url_,this.method_,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&a.removeUploadProgressListener(i),this.pendingConnection_=null;const o=a.getErrorCode()===Yh.NO_ERROR,l=a.getStatus();if(!o||JM(l,this.additionalRetryCodes_)&&this.retry){const u=a.getErrorCode()===Yh.ABORT;n(!1,new Sf(!1,null,u));return}const c=this.successCodes_.indexOf(l)!==-1;n(!0,new Sf(c,a))})},r=(n,s)=>{const a=this.resolve_,i=this.reject_,o=s.connection;if(s.wasSuccessCode)try{const l=this.callback_(o,o.getResponse());YM(l)?a(l):a()}catch(l){i(l)}else if(o!==null){const l=BM();l.serverResponse=o.getErrorText(),this.errorCallback_?i(this.errorCallback_(o,l)):i(l)}else if(s.canceled){const l=this.appDelete_?$S():$M();i(l)}else{const l=zM();i(l)}};this.canceled_?r(!1,new Sf(!1,null,!0)):this.backoffId_=qM(t,r,this.timeout_)}getPromise(){return this.promise_}cancel(t){this.canceled_=!0,this.appDelete_=t||!1,this.backoffId_!==null&&XM(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}}class Sf{constructor(t,r,n){this.wasSuccessCode=t,this.connection=r,this.canceled=!!n}}function eL(e,t){t!==null&&t.length>0&&(e.Authorization="Firebase "+t)}function tL(e,t){e["X-Firebase-Storage-Version"]="webjs/"+(t??"AppManager")}function rL(e,t){t&&(e["X-Firebase-GMPID"]=t)}function nL(e,t){t!==null&&(e["X-Firebase-AppCheck"]=t)}function sL(e,t,r,n,s,a,i=!0){const o=QM(e.urlParams),l=e.url+o,c=Object.assign({},e.headers);return rL(c,t),eL(c,r),tL(c,a),nL(c,n),new ZM(l,e.method,c,e.body,e.successCodes,e.additionalRetryCodes,e.handler,e.errorHandler,e.timeout,e.progressCallback,s,i)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function aL(e){if(e.length===0)return null;const t=e.lastIndexOf("/");return t===-1?"":e.slice(0,t)}function iL(e){const t=e.lastIndexOf("/",e.length-2);return t===-1?e:e.slice(t+1)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qh{constructor(t,r){this._service=t,r instanceof rs?this._location=r:this._location=rs.makeFromUrl(r,t.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(t,r){return new Qh(t,r)}get root(){const t=new rs(this._location.bucket,"");return this._newRef(this._service,t)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return iL(this._location.path)}get storage(){return this._service}get parent(){const t=aL(this._location.path);if(t===null)return null;const r=new rs(this._location.bucket,t);return new Qh(this._service,r)}_throwIfRoot(t){if(this._location.path==="")throw GM(t)}}function jy(e,t){const r=t==null?void 0:t[jM];return r==null?null:rs.makeFromBucketSpec(r,e)}function oL(e,t,r,n={}){e.host=`${t}:${r}`,e._protocol="http";const{mockUserToken:s}=n;s&&(e._overrideAuthToken=typeof s=="string"?s:FT(s,e.app.options.projectId))}class lL{constructor(t,r,n,s,a){this.app=t,this._authProvider=r,this._appCheckProvider=n,this._url=s,this._firebaseVersion=a,this._bucket=null,this._host=zS,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=VM,this._maxUploadRetryTime=UM,this._requests=new Set,s!=null?this._bucket=rs.makeFromBucketSpec(s,this._host):this._bucket=jy(this._host,this.app.options)}get host(){return this._host}set host(t){this._host=t,this._url!=null?this._bucket=rs.makeFromBucketSpec(this._url,t):this._bucket=jy(t,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(t){Ly("time",0,Number.POSITIVE_INFINITY,t),this._maxUploadRetryTime=t}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(t){Ly("time",0,Number.POSITIVE_INFINITY,t),this._maxOperationRetryTime=t}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const t=this._authProvider.getImmediate({optional:!0});if(t){const r=await t.getToken();if(r!==null)return r.accessToken}return null}async _getAppCheckToken(){const t=this._appCheckProvider.getImmediate({optional:!0});return t?(await t.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(t=>t.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(t){return new Qh(this,t)}_makeRequest(t,r,n,s,a=!0){if(this._deleted)return new KM($S());{const i=sL(t,this._appId,n,s,r,this._firebaseVersion,a);return this._requests.add(i),i.getPromise().then(()=>this._requests.delete(i),()=>this._requests.delete(i)),i}}async makeRequestWithTokens(t,r){const[n,s]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(t,r,n,s).getPromise()}}const Vy="@firebase/storage",Uy="0.13.2";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const WS="storage";function cL(e=bd(),t){e=Ht(e);const n=Tu(e,WS).getImmediate({identifier:t}),s=Wg("storage");return s&&uL(n,...s),n}function uL(e,t,r,n={}){oL(e,t,r,n)}function fL(e,{instanceIdentifier:t}){const r=e.getProvider("app").getImmediate(),n=e.getProvider("auth-internal"),s=e.getProvider("app-check-internal");return new lL(r,n,s,t,Zi)}function hL(){ni(new ua(WS,fL,"PUBLIC").setMultipleInstances(!0)),Vn(Vy,Uy,""),Vn(Vy,Uy,"esm2017")}hL();/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const HS="functions";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dL{constructor(t,r,n){this.auth=null,this.messaging=null,this.appCheck=null,this.auth=t.getImmediate({optional:!0}),this.messaging=r.getImmediate({optional:!0}),this.auth||t.get().then(s=>this.auth=s,()=>{}),this.messaging||r.get().then(s=>this.messaging=s,()=>{}),this.appCheck||n.get().then(s=>this.appCheck=s,()=>{})}async getAuthToken(){if(this.auth)try{const t=await this.auth.getToken();return t==null?void 0:t.accessToken}catch{return}}async getMessagingToken(){if(!(!this.messaging||!("Notification"in self)||Notification.permission!=="granted"))try{return await this.messaging.getToken()}catch{return}}async getAppCheckToken(t){if(this.appCheck){const r=t?await this.appCheck.getLimitedUseToken():await this.appCheck.getToken();return r.error?null:r.token}return null}async getContext(t){const r=await this.getAuthToken(),n=await this.getMessagingToken(),s=await this.getAppCheckToken(t);return{authToken:r,messagingToken:n,appCheckToken:s}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Cp="us-central1";class mL{constructor(t,r,n,s,a=Cp,i){this.app=t,this.fetchImpl=i,this.emulatorOrigin=null,this.contextProvider=new dL(r,n,s),this.cancelAllRequests=new Promise(o=>{this.deleteService=()=>Promise.resolve(o())});try{const o=new URL(a);this.customDomain=o.origin+(o.pathname==="/"?"":o.pathname),this.region=Cp}catch{this.customDomain=null,this.region=a}}_delete(){return this.deleteService()}_url(t){const r=this.app.options.projectId;return this.emulatorOrigin!==null?`${this.emulatorOrigin}/${r}/${this.region}/${t}`:this.customDomain!==null?`${this.customDomain}/${t}`:`https://${this.region}-${r}.cloudfunctions.net/${t}`}}function pL(e,t,r){e.emulatorOrigin=`http://${t}:${r}`}const By="@firebase/functions",zy="0.11.8";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gL="auth-internal",vL="app-check-internal",xL="messaging-internal";function _L(e,t){const r=(n,{instanceIdentifier:s})=>{const a=n.getProvider("app").getImmediate(),i=n.getProvider(gL),o=n.getProvider(xL),l=n.getProvider(vL);return new mL(a,i,o,l,s,e)};ni(new ua(HS,r,"PUBLIC").setMultipleInstances(!0)),Vn(By,zy,t),Vn(By,zy,"esm2017")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yL(e=bd(),t=Cp){const n=Tu(Ht(e),HS).getImmediate({identifier:t}),s=Wg("functions");return s&&wL(n,...s),n}function wL(e,t,r){pL(Ht(e),t,r)}_L(fetch.bind(self));const EL={apiKey:"AIzaSyAnEPcQISz9FY68mib-0StN6NQtTF3oz1c",authDomain:"xmas-movies.firebaseapp.com",projectId:"xmas-movies",storageBucket:"xmas-movies.firebasestorage.app",messagingSenderId:"721037810395",appId:"1:721037810395:web:1126b377adcc225c944afe"},Zd=LT(EL),wc=F3(Zd),GS=new ys;GS.setCustomParameters({prompt:"select_account"});const TL=GS,_t=_M(Zd);cL(Zd);yL(Zd);const KS=W.createContext(void 0),fs=()=>{const e=W.useContext(KS);if(e===void 0)throw new Error("useAuth must be used within an AuthProvider");return e},kL=({children:e})=>{const[t,r]=W.useState(null),[n,s]=W.useState(null),[a,i]=W.useState(!0),[o,l]=W.useState(null);W.useEffect(()=>{const m=ok(wc,async p=>{if(r(p),l(null),p)try{const x=Yr(_t,"users",p.uid),v=await ra(x);if(v.exists())await oi(x,{lastLoginAt:FM()},{merge:!0}),s(v.data());else{const w={email:p.email||"",displayName:p.displayName||"User",photoURL:p.photoURL||void 0,createdAt:new Date,lastLoginAt:new Date};await oi(x,w),s({id:p.uid,...w})}}catch(x){console.error("Error fetching user profile:",x),l("Failed to load user profile")}else s(null);i(!1)});return()=>m()},[]);const h={currentUser:t,userProfile:n,isLoading:a,error:o,signInWithGoogle:async()=>{try{l(null),i(!0);const m=new ys;await xk(wc,m)}catch(m){console.error("Login error:",m),l(m.message||"Failed to sign in")}finally{i(!1)}},signOut:async()=>{try{await kD(wc)}catch(m){console.error("Sign out error:",m),l(m.message||"Failed to sign out")}}};return d.jsx(KS.Provider,{value:h,children:e})},Mu=()=>{const[e,t]=W.useState(!1),[r,n]=W.useState(!0),[s,a]=W.useState(null),[i,o]=W.useState(null);return W.useEffect(()=>{const l=ok(wc,async c=>{if(n(!0),a(null),!c){t(!1),o(null),n(!1);return}o({uid:c.uid,email:c.email});try{const h=(await GT(c,!0)).claims.admin===!0;t(h)}catch(u){console.error("Error checking admin status:",u),a("Failed to verify admin status"),t(!1)}finally{n(!1)}});return()=>l()},[]),{isAdmin:e,loading:r,error:s,currentUser:i}},SL=({snowflakeCount:e=100,mobileSnowflakeCount:t=50})=>{const[r,n]=W.useState(!1),[s,a]=W.useState(e),i=W.useRef(null),o=W.useRef([]),l=W.useRef(0);return W.useEffect(()=>{const c=()=>{const u=window.matchMedia("(max-width: 768px)").matches;n(u),a(u?t:e)};return c(),window.addEventListener("resize",c),()=>{window.removeEventListener("resize",c)}},[e,t]),W.useEffect(()=>{const c=i.current;if(!c)return;const u=c.getContext("2d");if(!u)return;const h=()=>{c.width=window.innerWidth,c.height=window.innerHeight},m=()=>{o.current=[];for(let w=0;w<s;w++)o.current.push({x:Math.random()*c.width,y:Math.random()*c.height,size:r?Math.random()*3+1:Math.random()*4+1,speed:r?Math.random()*.8+.3:Math.random()*1+.5,opacity:r?Math.random()*.5+.2:Math.random()*.6+.3,wind:r?Math.random()*.3-.15:Math.random()*.5-.25})},p=w=>{u.beginPath(),u.arc(w.x,w.y,w.size,0,Math.PI*2),u.fillStyle=`rgba(255, 255, 255, ${w.opacity})`,u.fill()},x=w=>{w.y+=w.speed,w.x+=w.wind,w.y>c.height&&(w.y=-10,w.x=Math.random()*c.width),w.x>c.width?w.x=0:w.x<0&&(w.x=c.width)},v=()=>{u.clearRect(0,0,c.width,c.height),o.current.forEach(w=>{p(w),x(w)}),l.current=requestAnimationFrame(v)};return window.addEventListener("resize",h),h(),m(),v(),()=>{window.removeEventListener("resize",h),cancelAnimationFrame(l.current)}},[s]),d.jsx("canvas",{ref:i,className:"fixed top-0 left-0 w-full h-full pointer-events-none z-10","aria-hidden":"true"})},AL=()=>{const[e,t]=W.useState(!1),[r,n]=W.useState(null),[s,a]=W.useState(!1);W.useEffect(()=>{const l=/iPad|iPhone|iPod/.test(navigator.userAgent)&&!window.MSStream;a(l);const c=u=>{u.preventDefault(),n(u),t(!0)};return window.addEventListener("beforeinstallprompt",c),window.matchMedia("(display-mode: standalone)").matches&&t(!1),()=>{window.removeEventListener("beforeinstallprompt",c)}},[]);const i=async()=>{if(!r)return;r.prompt();const{outcome:l}=await r.userChoice;n(null),t(!1),console.log(`User ${l==="accepted"?"accepted":"dismissed"} the install prompt`)},o=()=>{t(!1),localStorage.setItem("installPromptDismissed","true")};return e?d.jsxs("div",{className:"fixed bottom-0 left-0 right-0 bg-green-800 text-white p-4 shadow-lg z-50 flex items-center justify-between",children:[d.jsxs("div",{className:"flex items-center",children:[d.jsx("div",{className:"mr-3 text-2xl",children:d.jsx("i",{className:"fas fa-gift"})}),d.jsx("div",{children:s?d.jsxs("p",{children:["Install this app on your device: tap ",d.jsx("i",{className:"fas fa-share"}),' and then "Add to Home Screen"']}):d.jsx("p",{children:"Add Christmas Movies to your home screen!"})})]}),d.jsxs("div",{className:"flex items-center",children:[!s&&d.jsx("button",{onClick:i,className:"bg-red-700 hover:bg-red-800 text-white py-1 px-4 rounded-full mr-2",children:"Install"}),d.jsx("button",{onClick:o,className:"bg-transparent hover:bg-green-700 text-white py-1 px-2 rounded-full",children:d.jsx("i",{className:"fas fa-times"})})]})]}):null};function IL(){const{currentUser:e}=fs(),{isAdmin:t}=Mu(),[r,n]=W.useState(!1),s=_a();W.useEffect(()=>(r?document.body.style.overflow="hidden":document.body.style.overflow="",()=>{document.body.style.overflow=""}),[r]),W.useEffect(()=>{r&&n(!1)},[s.pathname]);const a=()=>{n(!r)};return d.jsxs("div",{className:"min-h-screen bg-gradient-to-b from-xmas-bg to-xmas-card bg-opacity-95",children:[d.jsx(SL,{snowflakeCount:150,mobileSnowflakeCount:40}),d.jsx(AL,{}),d.jsxs("div",{className:"navbar bg-gradient-to-r from-xmas-card via-xmas-card to-xmas-bg border-b border-xmas-gold px-2 sm:px-4 shadow-lg relative overflow-hidden",children:[d.jsx("div",{className:"absolute top-0 left-0 w-full h-1 bg-gradient-to-r from-xmas-gold via-transparent to-xmas-gold opacity-60"}),d.jsx("div",{className:"absolute -bottom-4 left-0 right-0 h-8 snow-accumulation-fast"}),d.jsxs("div",{className:"flex items-center",children:[d.jsx("button",{className:"btn btn-ghost btn-sm md:hidden relative z-10",onClick:a,"aria-label":"Toggle navigation menu",children:d.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",className:"inline-block w-5 h-5 stroke-current",children:d.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M4 6h16M4 12h16M4 18h16"})})}),d.jsxs(et,{to:"/",className:"hidden sm:flex items-center group",children:[d.jsxs("div",{className:"relative",children:[d.jsx("div",{className:"absolute -inset-1 bg-gradient-to-r from-xmas-gold to-xmas-line rounded-full opacity-70 group-hover:opacity-100 blur transition duration-200"}),d.jsx("div",{className:"relative flex items-center justify-center w-10 h-10 bg-xmas-card rounded-full border border-xmas-gold overflow-hidden",children:d.jsx("img",{src:"/Santa.png",alt:"Santa",className:"w-full h-full object-cover group-hover:scale-110 transition-transform duration-300"})})]}),d.jsx("div",{className:"ml-3 font-christmas text-xl sm:text-2xl bg-gradient-to-br from-xmas-gold via-xmas-snow to-xmas-gold bg-clip-text text-transparent font-bold",children:"Christmas Movies"})]}),d.jsxs(et,{to:"/",className:"sm:hidden flex items-center",children:[d.jsx("div",{className:"w-8 h-8 flex items-center justify-center rounded-full bg-xmas-card border border-xmas-gold overflow-hidden",children:d.jsx("img",{src:"/Santa.png",alt:"Santa",className:"w-full h-full object-cover"})}),d.jsx("span",{className:"ml-2 font-christmas text-lg text-xmas-gold",children:"Christmas Movies"})]})]}),d.jsx("div",{className:"flex-1"}),d.jsxs("div",{className:"flex items-center gap-1 sm:gap-2",children:[e&&d.jsxs(et,{to:"/profile",className:"btn btn-primary btn-sm hidden md:flex",children:[d.jsx("i",{className:"fas fa-user-circle mr-1"})," Profile"]}),e?d.jsxs("div",{className:"dropdown dropdown-end",children:[d.jsx("label",{tabIndex:0,className:"btn btn-ghost btn-circle avatar cursor-pointer",children:d.jsx("div",{className:"w-10 rounded-full border border-xmas-gold",children:e.photoURL?d.jsx("img",{src:e.photoURL,alt:"Profile"}):d.jsx("div",{className:"bg-xmas-card flex items-center justify-center h-full",children:d.jsx("i",{className:"fas fa-user text-xmas-gold"})})})}),d.jsxs("ul",{tabIndex:0,className:"dropdown-content menu menu-sm mt-3 z-[1] p-2 shadow bg-xmas-card rounded-box w-52 border border-xmas-gold",children:[d.jsx("li",{children:d.jsxs(et,{to:"/profile",className:"justify-between",children:["Profile",d.jsx("i",{className:"fas fa-user-circle"})]})}),d.jsx("li",{children:d.jsxs(et,{to:"/movies",children:["My Movies",d.jsx("i",{className:"fas fa-film"})]})}),d.jsx("li",{children:d.jsxs(et,{to:"/random",children:["Random Movie",d.jsx("i",{className:"fas fa-random"})]})}),d.jsx("li",{children:d.jsxs(et,{to:"/import",children:["Import Movies",d.jsx("i",{className:"fas fa-file-import"})]})}),t&&d.jsx("li",{children:d.jsxs(et,{to:"/admin",className:"text-xmas-gold",children:["Admin Dashboard",d.jsx("i",{className:"fas fa-crown"})]})})]})]}):d.jsxs(et,{to:"/login",className:"btn btn-primary btn-sm",children:[d.jsx("i",{className:"fas fa-sign-in-alt mr-1"})," Sign In"]})]})]}),d.jsx("div",{className:`fixed inset-0 bg-black bg-opacity-70 z-20 transition-opacity duration-300 md:hidden ${r?"opacity-100":"opacity-0 pointer-events-none"}`,onClick:a}),d.jsxs("div",{className:`fixed top-0 left-0 h-full w-72 bg-gradient-to-b from-xmas-bg to-xmas-card border-r border-xmas-gold z-30 transform transition-transform duration-300 ease-in-out md:hidden shadow-xl ${r?"translate-x-0":"-translate-x-full"}`,children:[d.jsxs("div",{className:"relative overflow-hidden",children:[d.jsx("div",{className:"absolute top-0 left-0 w-full h-1 bg-gradient-to-r from-xmas-gold via-transparent to-xmas-gold opacity-60"}),d.jsxs("div",{className:"flex justify-between items-center p-4 border-b border-xmas-gold bg-xmas-card bg-opacity-80",children:[d.jsxs("div",{className:"flex items-center",children:[d.jsx("div",{className:"w-9 h-9 flex items-center justify-center rounded-full bg-xmas-card border border-xmas-gold shadow-lg overflow-hidden",children:d.jsx("img",{src:"/Santa.png",alt:"Santa",className:"w-full h-full object-cover"})}),d.jsx("div",{className:"ml-3 font-christmas text-xl bg-gradient-to-br from-xmas-gold via-xmas-snow to-xmas-gold bg-clip-text text-transparent font-bold",children:"Christmas Movies"})]}),d.jsx("button",{className:"btn btn-ghost btn-sm text-xmas-text hover:text-xmas-line",onClick:a,"aria-label":"Close navigation menu",children:d.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:d.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})]}),d.jsx("div",{className:"overflow-y-auto h-full pb-20",children:d.jsx("div",{className:"p-4 pt-6",children:d.jsxs("div",{className:"mb-6",children:[d.jsx("h3",{className:"font-christmas text-xl text-xmas-gold mb-4 pl-2 border-l-2 border-xmas-line",children:"Navigation"}),d.jsxs("ul",{className:"space-y-3",children:[d.jsx("li",{children:d.jsx(Sa,{to:"/",onClick:a,className:({isActive:i})=>i?"flex items-center p-2 pl-3 rounded-md bg-gradient-to-r from-xmas-card to-transparent border-l-2 border-xmas-gold text-xmas-gold font-medium":"flex items-center p-2 pl-3 rounded-md hover:bg-xmas-card hover:bg-opacity-50 text-xmas-text hover:text-xmas-gold transition-all duration-200",children:({isActive:i})=>d.jsxs(d.Fragment,{children:[d.jsx("i",{className:"fas fa-home mr-3 text-xmas-gold"}),d.jsx("span",{children:"Home"}),d.jsx("i",{className:`fas fa-snowflake ml-auto text-xmas-gold opacity-70 ${i?"visible":"invisible"}`})]})})}),e?d.jsxs(d.Fragment,{children:[d.jsx("li",{children:d.jsx(Sa,{to:"/movies",onClick:a,className:({isActive:i})=>i?"flex items-center p-2 pl-3 rounded-md bg-gradient-to-r from-xmas-card to-transparent border-l-2 border-xmas-gold text-xmas-gold font-medium":"flex items-center p-2 pl-3 rounded-md hover:bg-xmas-card hover:bg-opacity-50 text-xmas-text hover:text-xmas-gold transition-all duration-200",children:({isActive:i})=>d.jsxs(d.Fragment,{children:[d.jsx("i",{className:"fas fa-film mr-3 text-xmas-gold"}),d.jsx("span",{children:"My Movies"}),d.jsx("i",{className:`fas fa-snowflake ml-auto text-xmas-gold opacity-70 ${i?"visible":"invisible"}`})]})})}),d.jsx("li",{children:d.jsx(Sa,{to:"/random",onClick:a,className:({isActive:i})=>i?"flex items-center p-2 pl-3 rounded-md bg-gradient-to-r from-xmas-card to-transparent border-l-2 border-xmas-gold text-xmas-gold font-medium":"flex items-center p-2 pl-3 rounded-md hover:bg-xmas-card hover:bg-opacity-50 text-xmas-text hover:text-xmas-gold transition-all duration-200",children:({isActive:i})=>d.jsxs(d.Fragment,{children:[d.jsx("i",{className:"fas fa-random mr-3 text-xmas-gold"}),d.jsx("span",{children:"Random Movie"}),d.jsx("i",{className:`fas fa-snowflake ml-auto text-xmas-gold opacity-70 ${i?"visible":"invisible"}`})]})})}),d.jsx("li",{children:d.jsx(Sa,{to:"/achievements",onClick:a,className:({isActive:i})=>i?"flex items-center p-2 pl-3 rounded-md bg-gradient-to-r from-xmas-card to-transparent border-l-2 border-xmas-gold text-xmas-gold font-medium":"flex items-center p-2 pl-3 rounded-md hover:bg-xmas-card hover:bg-opacity-50 text-xmas-text hover:text-xmas-gold transition-all duration-200",children:({isActive:i})=>d.jsxs(d.Fragment,{children:[d.jsx("i",{className:"fas fa-trophy mr-3 text-xmas-gold"}),d.jsx("span",{children:"Achievements"}),d.jsx("i",{className:`fas fa-snowflake ml-auto text-xmas-gold opacity-70 ${i?"visible":"invisible"}`})]})})}),d.jsx("li",{children:d.jsx(Sa,{to:"/import",onClick:a,className:({isActive:i})=>i?"flex items-center p-2 pl-3 rounded-md bg-gradient-to-r from-xmas-card to-transparent border-l-2 border-xmas-gold text-xmas-gold font-medium":"flex items-center p-2 pl-3 rounded-md hover:bg-xmas-card hover:bg-opacity-50 text-xmas-text hover:text-xmas-gold transition-all duration-200",children:({isActive:i})=>d.jsxs(d.Fragment,{children:[d.jsx("i",{className:"fas fa-file-import mr-3 text-xmas-gold"}),d.jsx("span",{children:"Add Movies"}),d.jsx("i",{className:`fas fa-snowflake ml-auto text-xmas-gold opacity-70 ${i?"visible":"invisible"}`})]})})}),d.jsx("li",{children:d.jsx(Sa,{to:"/profile",onClick:a,className:({isActive:i})=>i?"flex items-center p-2 pl-3 rounded-md bg-gradient-to-r from-xmas-card to-transparent border-l-2 border-xmas-gold text-xmas-gold font-medium":"flex items-center p-2 pl-3 rounded-md hover:bg-xmas-card hover:bg-opacity-50 text-xmas-text hover:text-xmas-gold transition-all duration-200",children:({isActive:i})=>d.jsxs(d.Fragment,{children:[d.jsx("i",{className:"fas fa-user-circle mr-3 text-xmas-gold"}),d.jsx("span",{children:"Profile"}),d.jsx("i",{className:`fas fa-snowflake ml-auto text-xmas-gold opacity-70 ${i?"visible":"invisible"}`})]})})}),t&&d.jsx("li",{children:d.jsx(Sa,{to:"/admin",onClick:a,className:({isActive:i})=>i?"flex items-center p-2 pl-3 rounded-md bg-gradient-to-r from-xmas-card to-transparent border-l-2 border-xmas-gold text-xmas-gold font-medium":"flex items-center p-2 pl-3 rounded-md hover:bg-xmas-card hover:bg-opacity-50 text-xmas-text hover:text-xmas-gold transition-all duration-200",children:({isActive:i})=>d.jsxs(d.Fragment,{children:[d.jsx("i",{className:"fas fa-crown mr-3 text-xmas-gold"}),d.jsx("span",{children:"Admin Dashboard"}),d.jsx("i",{className:`fas fa-snowflake ml-auto text-xmas-gold opacity-70 ${i?"visible":"invisible"}`})]})})})]}):d.jsx("li",{children:d.jsx(Sa,{to:"/login",onClick:a,className:({isActive:i})=>i?"flex items-center p-2 pl-3 rounded-md bg-gradient-to-r from-xmas-card to-transparent border-l-2 border-xmas-gold text-xmas-gold font-medium":"flex items-center p-2 pl-3 rounded-md hover:bg-xmas-card hover:bg-opacity-50 text-xmas-text hover:text-xmas-gold transition-all duration-200",children:({isActive:i})=>d.jsxs(d.Fragment,{children:[d.jsx("i",{className:"fas fa-sign-in-alt mr-3 text-xmas-gold"}),d.jsx("span",{children:"Sign In"}),d.jsx("i",{className:`fas fa-snowflake ml-auto text-xmas-gold opacity-70 ${i?"visible":"invisible"}`})]})})})]})]})})})]}),d.jsx("main",{className:"p-4",children:d.jsx(ST,{})}),d.jsx("div",{className:"fixed bottom-0 left-0 w-full pointer-events-none",children:d.jsx("div",{className:"container mx-auto",children:d.jsxs("div",{className:"relative h-16",children:[d.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-px bg-gradient-to-r from-xmas-gold via-transparent to-xmas-gold opacity-40"}),d.jsx("div",{className:"absolute bottom-4 left-4 opacity-30",children:d.jsx("i",{className:"fas fa-tree text-4xl text-xmas-gold"})}),d.jsx("div",{className:"absolute bottom-4 right-4 opacity-30",children:d.jsx("i",{className:"fas fa-star text-4xl text-xmas-gold"})})]})})})]})}const qS=W.createContext(null);function CL({children:e}){const[t,r]=W.useState([]),n=W.useCallback(i=>{r(o=>o.filter(l=>l.id!==i))},[]),s=W.useCallback((i,o)=>{const l=Math.random().toString(36).slice(2);r(c=>[...c,{id:l,kind:i,message:o}]),setTimeout(()=>n(l),3e3)},[n]),a=W.useMemo(()=>({push:s}),[s]);return d.jsxs(qS.Provider,{value:a,children:[e,d.jsx("div",{className:"fixed top-4 right-4 z-50 space-y-2",children:t.map(i=>d.jsxs("div",{className:`alert shadow-lg max-w-sm ${i.kind==="success"?"alert-success":i.kind==="error"?"alert-error":"alert-info"}`,children:[d.jsxs("div",{children:[i.kind==="success"?"":i.kind==="error"?"":"",d.jsx("span",{className:"ml-2",children:i.message})]}),d.jsx("button",{className:"btn btn-ghost btn-sm",onClick:()=>n(i.id),children:""})]},i.id))})]})}function RL(){const e=W.useContext(qS);if(!e)throw new Error("useToast must be used inside <ToastProvider>");return{success:t=>e.push("success",t),error:t=>e.push("error",t),info:t=>e.push("info",t)}}const $y=({children:e})=>{const{currentUser:t,isLoading:r}=fs();return r?d.jsx("div",{className:"flex justify-center items-center min-h-[60vh]",children:d.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-xmas-gold"})}):t?e?d.jsx(d.Fragment,{children:e}):d.jsx(ST,{}):d.jsx(jN,{to:"/login"})},Go=[{id:"first_snowflake",name:"First Snowflake",description:"You logged your very first watched Christmas movie.",hint:"Watch 1 movie.",icon:"",check:e=>e.totalWatched>=1},{id:"snowball_starter",name:"Snowball Starter",description:"You have started to build your festive watchlist.",hint:"Watch 5 movies.",icon:"",check:e=>e.totalWatched>=5},{id:"blizzard_binger",name:"Blizzard Binger",description:"You powered through a flurry of festive films.",hint:"Watch 20 movies.",icon:"",check:e=>e.totalWatched>=20},{id:"christmas_marathoner",name:"Christmas Marathoner",description:"You turned Christmas movies into a marathon event.",hint:"Watch 50 movies.",icon:"",check:e=>e.totalWatched>=50},{id:"twelve_days",name:"12 Days of Christmas",description:"You kept the festive streak going for 12 days.",hint:"Watch a movie daily for 12 days.",icon:"",check:e=>e.hasTwelveDayStreak},{id:"the_grinch",name:"The Grinch",description:"Not every movie can be a Christmas miracle.",hint:"Give a movie 1.",icon:"",check:e=>e.lowRatingAny},{id:"santas_favourite",name:"Santa's Favourite",description:"You found a film worthy of Santa himself.",hint:"Give a movie a perfect 10.",icon:"",check:e=>e.highRatingAny},{id:"the_critic",name:"The Critic",description:"You have opinions on a lot of movies.",hint:"Rate 20 movies.",icon:"",check:e=>e.totalRated>=20},{id:"nice_list",name:"Nice List",description:"You are generous with your festive ratings.",hint:"Keep your average rating above 5.",icon:"",check:e=>e.averageRating>5},{id:"classic_connoisseur",name:"Classic Connoisseur",description:"You appreciate the classics before Y2K.",hint:"Watch 5 movies released before 2000.",icon:"",check:e=>e.classicWatched>=5},{id:"animated_joy",name:"Animated Joy",description:"You love animated festive adventures.",hint:"Watch 5 animated Christmas movies.",icon:"",check:e=>e.animatedCount>=5},{id:"romcom_reindeer",name:"Rom-Com Reindeer",description:"You love a festive rom-com.",hint:"Watch 5 Christmas romance movies.",icon:"",check:e=>e.romanceCount>=5},{id:"decorator",name:"Decorator",description:"You have a whole row of favourites lit up.",hint:"Mark 10 movies as favourite.",icon:"",check:e=>e.favoriteCount>=10},{id:"elf_mode",name:"Elf Mode",description:"You keep coming back like a dedicated Christmas elf.",hint:"Use the app on 10 different days.",icon:"",check:e=>e.usageDistinctDays>=10},{id:"christmas_eve_watcher",name:"Christmas Eve Watcher",description:"You watched a movie on Christmas Eve.",hint:"Watch a movie on Dec 24.",icon:"",check:e=>e.hasChristmasEveWatch},{id:"new_years_cozy",name:"New Year's Cozy",description:"You started the year with a cozy movie.",hint:"Watch a movie on Jan 1.",icon:"",check:e=>e.hasNewYearsWatch}];function Wy(e){if(!e)return null;if(e instanceof Date)return e;if(typeof e.toDate=="function")return e.toDate();if(typeof e=="object"&&"seconds"in e)return new Date(e.seconds*1e3);if(typeof e=="string"){const t=new Date(e);if(!isNaN(t.getTime()))return t}return null}function NL(e,t){let r=0,n=0,s=0,a=0,i=0,o=0,l=0,c=!1,u=!1;const h=new Set,m=new Set,p=new Set;for(const O of e){if(O.watched){r++;const g=Wy(O.watchedDate);if(g){const S=g.toISOString().split("T")[0];p.add(S);const R=g.getMonth();g.getDate(),R===11&&h.add(S)}const y=t[O.movieId];y&&y.releaseDate&&y.releaseDate.substring(0,4)<"2000"&&a++,y&&y.genres&&y.genres.includes("Romance")&&i++,y&&y.genres&&y.genres.includes("Animation")&&o++}O.favorite&&l++,typeof O.rating=="number"&&(n++,s+=O.rating,O.rating<=1&&(c=!0),O.rating>=10&&(u=!0));const L=Wy(O.updatedAt||O.addedAt);if(L){const g=L.toISOString().split("T")[0];m.add(g)}}const x=Array.from(p).map(O=>{const L=new Date(O+"T00:00:00Z");return Math.floor(L.getTime()/864e5)}).sort((O,L)=>O-L);let v=!1,w=0,k=null;for(const O of x){if(k===null||O===k+1?w+=1:O!==k&&(w=1),w>=12){v=!0;break}k=O}let T=!1,E=!1;for(const O of p){const L=new Date(O+"T00:00:00Z"),g=L.getMonth(),y=L.getDate();g===11&&y===24&&(T=!0),g===0&&y===1&&(E=!0)}const N=n>0?s/n:0;return{totalWatched:r,totalRated:n,averageRating:N,lowRatingAny:c,highRatingAny:u,classicWatched:a,romanceCount:i,animatedCount:o,favoriteCount:l,usageDistinctDays:m.size,decemberDistinctDays:h.size,hasChristmasEveWatch:T,hasNewYearsWatch:E,hasTwelveDayStreak:v}}async function nh(e){const t=await kn(mn(_t,`users/${e}/movies`)),r=[],n=new Set;t.forEach(u=>{const h=u.data();r.push({id:u.id,...h}),h.movieId&&n.add(h.movieId)});const s={};if(n.size){const u=Array.from(n);for(const h of u){(await kn(mn(_t,"movies"))).forEach(p=>{const x=p.data();s[p.id]={id:p.id,...x}});break}}const a=NL(r,s),i=mn(_t,`users/${e}/achievements`),o=await kn(i),l=new Set;o.forEach(u=>l.add(u.id));const c=[];for(const u of Go)!l.has(u.id)&&u.check(a)&&(c.push(u.id),await oi(Yr(_t,`users/${e}/achievements`,u.id),{unlockedAt:new Date,seen:!1}));return c}const bL=()=>{const{currentUser:e}=fs(),[t,r]=W.useState(new Date),[n,s]=W.useState(null),[a,i]=W.useState(null),o=Go.length;W.useEffect(()=>{const u=setInterval(()=>r(new Date),1e3);return()=>clearInterval(u)},[]);const l=W.useMemo(()=>{const u=t.getFullYear(),h=new Date(u,11,25,0,0,0);return t>h?new Date(u+1,11,25,0,0,0):h},[t]),c=W.useMemo(()=>{const u=l.getTime()-t.getTime(),h=Math.max(0,Math.floor(u/1e3)),m=Math.floor(h/86400),p=Math.floor(h%86400/3600),x=Math.floor(h%3600/60),v=h%60;return{days:m,hours:p,minutes:x,seconds:v}},[t,l]);return W.useEffect(()=>{const u=Yr(_t,"stats","global"),h=DM(u,m=>{const p=m.data();s(typeof(p==null?void 0:p.watchedTotal)=="number"?p.watchedTotal:0)});return()=>h()},[]),W.useEffect(()=>{if(!e){i(null);return}(async()=>{try{const h=mn(_t,`users/${e.uid}/achievements`),m=await kn(h);i(m.size)}catch(h){console.error("Error loading achievements count",h),i(null)}})()},[e]),d.jsxs("div",{className:"container mx-auto px-4 py-8",children:[d.jsxs("div",{className:"text-center mb-12",children:[d.jsx("h1",{className:"font-christmas text-5xl md:text-7xl text-xmas-line mb-4",children:"My Christmas Movies"}),d.jsx("p",{className:"text-xl md:text-2xl text-xmas-snow mb-8",children:"Track, rate, and discover your favourite Christmas movies!"}),d.jsx("div",{className:"flex flex-col md:flex-row justify-center gap-6 mb-4 md:mb-6",children:e?d.jsxs(d.Fragment,{children:[d.jsxs(et,{to:"/movies",className:"btn btn-primary btn-lg text-xl px-8 py-3 rounded-md shadow-lg hover:shadow-xl transition-all duration-300 border border-xmas-gold border-opacity-30",children:[d.jsx("i",{className:"fas fa-film mr-2"})," My Movies"]}),d.jsxs(et,{to:"/random",className:"btn btn-primary btn-lg text-xl px-8 py-3 rounded-md shadow-lg hover:shadow-xl transition-all duration-300 border border-xmas-gold border-opacity-30",children:[d.jsx("i",{className:"fas fa-random mr-2"})," Random Movie"]}),d.jsxs(et,{to:"/achievements",className:"btn btn-primary btn-lg text-xl px-8 py-3 rounded-md shadow-lg hover:shadow-xl transition-all duration-300 border border-xmas-gold border-opacity-30",children:[d.jsx("i",{className:"fas fa-trophy mr-2"})," Achievements"]})]}):d.jsxs(et,{to:"/login",className:"btn btn-primary btn-lg text-xl px-8 py-3 rounded-md shadow-lg hover:shadow-xl transition-all duration-300 border border-xmas-gold border-opacity-30",children:[d.jsx("i",{className:"fas fa-sign-in-alt mr-2"})," Sign In"]})})]}),d.jsx("div",{className:"w-full max-w-4xl mx-auto mb-8",children:d.jsx("div",{className:"h-px bg-gradient-to-r from-transparent via-xmas-gold to-transparent"})}),d.jsxs("div",{className:"bg-xmas-card rounded-lg shadow-xl p-6 mb-12 border border-xmas-gold border-opacity-30 relative",children:[d.jsx("h2",{className:"font-christmas text-3xl text-xmas-gold text-center mb-6",children:"Countdown to Christmas"}),d.jsxs("div",{className:"grid md:grid-cols-2 gap-6 items-stretch",children:[d.jsxs("div",{className:"bg-xmas-card bg-opacity-70 p-6 rounded-lg shadow-md border-l-2 border-xmas-line flex flex-col items-center justify-center",children:[d.jsxs("div",{className:"text-5xl md:text-6xl font-bold text-xmas-line mb-2",children:[c.days,"d ",c.hours,"h ",c.minutes,"m ",c.seconds,"s"]}),d.jsx("p",{className:"text-xmas-text text-opacity-80",children:"until Christmas Day"})]}),d.jsxs("div",{className:"bg-xmas-card bg-opacity-70 p-6 rounded-lg shadow-md border-l-2 border-xmas-gold flex flex-col items-center justify-center",children:[d.jsx("div",{className:"text-5xl md:text-6xl font-bold text-xmas-gold mb-2",children:n??""}),d.jsx("p",{className:"text-xmas-text text-opacity-80 text-center",children:"total movies watched"})]})]})]}),d.jsxs("div",{className:"bg-xmas-card rounded-lg shadow-xl p-6 mb-12 border border-xmas-gold border-opacity-20 snow-accumulation snow-accumulation-slow relative",children:[d.jsx("h2",{className:"font-christmas text-3xl text-xmas-line mb-6 text-center",children:"Features"}),d.jsxs("div",{className:"grid md:grid-cols-4 gap-6",children:[d.jsxs("div",{className:"bg-xmas-card bg-opacity-70 p-6 rounded-lg shadow-md border-l-2 border-xmas-line",children:[d.jsx("div",{className:"text-3xl text-xmas-gold mb-4 text-center",children:d.jsx("i",{className:"fas fa-search"})}),d.jsx("h3",{className:"font-christmas text-xl text-center mb-3",children:"Find Movies"}),d.jsx("p",{className:"text-center text-xmas-text text-opacity-80",children:"Search and discover Christmas movies using TMDB integration"})]}),d.jsxs("div",{className:"bg-xmas-card bg-opacity-70 p-6 rounded-lg shadow-md border-l-2 border-xmas-gold",children:[d.jsx("div",{className:"text-3xl text-xmas-gold mb-4 text-center",children:d.jsx("i",{className:"fas fa-star"})}),d.jsx("h3",{className:"font-christmas text-xl text-center mb-3",children:"Rate & Review"}),d.jsx("p",{className:"text-center text-xmas-text text-opacity-80",children:"Keep track of movies you've watched and rate them"})]}),d.jsxs("div",{className:"bg-xmas-card bg-opacity-70 p-6 rounded-lg shadow-md border-l-2 border-xmas-line",children:[d.jsx("div",{className:"text-3xl text-xmas-gold mb-4 text-center",children:d.jsx("i",{className:"fas fa-random"})}),d.jsx("h3",{className:"font-christmas text-xl text-center mb-3",children:"Random Picker"}),d.jsx("p",{className:"text-center text-xmas-text text-opacity-80",children:"Can't decide what to watch? Let our random movie picker help!"})]}),d.jsxs("div",{className:"bg-xmas-card bg-opacity-70 p-6 rounded-lg shadow-md border-l-2 border-xmas-line",children:[d.jsx("div",{className:"text-3xl text-xmas-gold mb-4 text-center",children:d.jsx("i",{className:"fas fa-trophy"})}),d.jsx("h3",{className:"font-christmas text-xl text-center mb-3",children:"Achievements"}),d.jsx("p",{className:"text-center text-xmas-text text-opacity-80 mb-2",children:"Unlock festive badges as you watch, rate, and explore."}),e&&d.jsx("p",{className:"text-center text-xmas-text text-opacity-80 font-medium",children:typeof a=="number"?`${a} / ${o} unlocked`:`${o} to discover`})]})]})]}),d.jsx("div",{className:"bg-xmas-card rounded-lg shadow-xl p-6 mb-12 border border-xmas-gold border-opacity-30 snow-accumulation snow-accumulation-fast relative",children:d.jsxs("div",{className:"mb-6 text-center",children:[d.jsxs("h2",{className:"font-christmas text-3xl md:text-4xl text-xmas-gold inline-block relative",children:[d.jsx("span",{className:"relative z-10",children:"Create Your Collection"}),d.jsx("span",{className:"absolute -bottom-2 left-0 right-0 h-1 bg-xmas-gold opacity-30 rounded-full"})]}),d.jsx("p",{className:"mt-4 mb-6",children:"Add movies to your collection and rate them"}),e?d.jsxs(et,{to:"/import",className:"btn btn-primary",children:[d.jsx("i",{className:"fas fa-file-import mr-2"})," Add Movies"]}):d.jsxs(et,{to:"/login",className:"btn btn-primary",children:[d.jsx("i",{className:"fas fa-sign-in-alt mr-2"})," Sign In to Add"]})]})}),d.jsx("div",{className:"w-full max-w-4xl mx-auto mb-8",children:d.jsx("div",{className:"h-px bg-gradient-to-r from-transparent via-xmas-gold to-transparent"})}),d.jsxs("footer",{className:"text-center text-xmas-mute mt-12 pb-8 space-y-4",children:[d.jsxs("p",{children:[" ",new Date().getFullYear()," Christmas Movie Database"]}),d.jsxs("div",{className:"flex flex-col items-center justify-center gap-2 text-xs md:text-sm text-xmas-mute/80",children:[d.jsx("a",{href:"https://www.themoviedb.org",target:"_blank",rel:"noopener noreferrer",className:"btn flex items-center justify-center gap-2",children:d.jsx("img",{src:"/tmdb.svg",alt:"TMDB logo",className:"h-6 md:h-8 w-auto mb-1"})}),d.jsx("p",{className:"max-w-xl px-4",children:"This product uses the TMDB API but is not endorsed or certified by TMDB."})]})]})]})},PL=()=>{const e=mi(),{currentUser:t,isLoading:r,error:n,signInWithGoogle:s}=fs();W.useEffect(()=>{t&&!r&&e("/")},[t,r,e]);const a=async()=>{try{await s()}catch(i){console.error("Login failed:",i)}};return r?d.jsx("div",{className:"flex justify-center items-center min-h-[60vh]",children:d.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-xmas-gold"})}):d.jsx("div",{className:"container mx-auto px-4 py-12",children:d.jsxs("div",{className:"max-w-md mx-auto",children:[d.jsxs("div",{className:"text-center mb-8",children:[d.jsx("h1",{className:"font-christmas text-4xl text-xmas-line mb-2",children:"Christmas Movie Database"}),d.jsx("p",{className:"text-xmas-mute",children:"Sign in to manage your Christmas movie collection"})]}),d.jsxs("div",{className:"bg-xmas-card rounded-lg shadow-lg p-6",children:[n&&d.jsx("div",{className:"bg-error bg-opacity-10 border-l-4 border-error p-4 mb-6 rounded",children:d.jsx("p",{className:"text-error",children:n})}),d.jsxs("div",{className:"text-center mb-6",children:[d.jsx("p",{className:"mb-4",children:"Sign in with your Google account to access your Christmas movie collection."}),d.jsx("p",{className:"text-sm text-xmas-mute mb-6",children:"Track, rate, and discover Christmas movies!"}),d.jsxs("button",{onClick:a,className:"btn btn-primary w-full flex items-center justify-center gap-2",children:[d.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 48 48",children:[d.jsx("path",{fill:"#FFC107",d:`M43.611,20.083H42V20H24v8h11.303c-1.649,4.657-6.08,8-11.303,8c-6.627,0-12-5.373-12-12
                  s5.373-12,12-12c3.059,0,5.842,1.154,7.961,3.039l5.657-5.657C34.046,6.053,29.268,4,24,4C12.955,4,4,12.955,4,24s8.955,20,20,20
                  s20-8.955,20-20C44,22.659,43.862,21.35,43.611,20.083z`}),d.jsx("path",{fill:"#FF3D00",d:`M6.306,14.691l6.571,4.819C14.655,15.108,18.961,12,24,12c3.059,0,5.842,1.154,7.961,3.039
                  l5.657-5.657C34.046,6.053,29.268,4,24,4C16.318,4,9.656,8.337,6.306,14.691z`}),d.jsx("path",{fill:"#4CAF50",d:`M24,44c5.166,0,9.86-1.977,13.409-5.192l-6.19-5.238C29.211,35.091,26.715,36,24,36
                  c-5.202,0-9.619-3.317-11.283-7.946l-6.522,5.025C9.505,39.556,16.227,44,24,44z`}),d.jsx("path",{fill:"#1976D2",d:`M43.611,20.083H42V20H24v8h11.303c-0.792,2.237-2.231,4.166-4.087,5.571
                  c0.001-0.001,0.002-0.001,0.003-0.002l6.19,5.238C36.971,39.205,44,34,44,24C44,22.659,43.862,21.35,43.611,20.083z`})]}),"Sign in with Google"]})]})]}),d.jsx("div",{className:"text-center mt-6",children:d.jsx("p",{className:"text-sm text-xmas-mute",children:"By signing in, you agree to our Terms of Service and Privacy Policy."})})]})})},DL=e=>e.toLowerCase().replace(/[^\w\s-]/g,"").replace(/\s+/g,"-").replace(/-+/g,"-").trim(),$v=(e,t)=>`/movies/${DL(e)}?id=${t}`,FL=e=>new URLSearchParams(e).get("id"),OL=5*60*1e3;let es=null;const ML=(e,t,r)=>{es={userMovies:t,movies:r,timestamp:Date.now(),userId:e}},LL=e=>!es||es.userId!==e||Date.now()-es.timestamp>OL?null:{userMovies:es.userMovies,movies:es.movies},jL=()=>{es=null},VL=(e,t,r)=>{es&&es.userId===e&&(es.userMovies[t]=r,es.timestamp=Date.now())},Wv=async(e,t,r)=>{const n=Yr(_t,`users/${e}/movies`,t);if((await ra(n)).exists()){const o={...r,updatedAt:new Date};r.rating===null&&(o.rating=null),r.watchedDate===null&&(o.watchedDate=null),r.review===null&&(o.review=null),await dl(n,o)}else{const o={userId:e,movieId:t,watched:r.watched||!1,favorite:r.favorite||!1,addedAt:new Date,updatedAt:new Date,...r};await oi(n,o)}const a=await ra(n),i={id:a.id,...a.data()};return VL(e,t,i),i},Rp=async(e,t)=>{const r=Yr(_t,`users/${e}/movies`,t),n=await ra(r);return n.exists()?{id:n.id,...n.data()}:null},XS=async e=>{const t=mn(_t,`users/${e}/movies`),r=await kn(t),n=[];return r.forEach(s=>{n.push({id:s.id,...s.data()})}),n},UL=async(e,t)=>{const r=Yr(_t,`users/${e}/movies`,t);await PM(r),jL()},e0=async e=>{const t=LL(e);if(t)return t;const r=await XS(e),n={},s=[];r.forEach(o=>{n[o.movieId]=o,s.push(o.movieId)});const a=[];if(s.length>0)for(let l=0;l<s.length;l+=10){const u=s.slice(l,l+10).map(m=>ra(Yr(_t,"movies",m)).then(p=>p.exists()?{id:p.id,...p.data()}:null).catch(p=>(console.error(`Error fetching movie ${m}:`,p),null))),h=await Promise.all(u);a.push(...h.filter(Boolean))}const i={userMovies:n,movies:a};return ML(e,n,a),i},BL=()=>{const{currentUser:e}=fs(),[t,r]=W.useState([]),[n,s]=W.useState({}),[a,i]=W.useState(!0),[o,l]=W.useState(!0),[c,u]=W.useState(null),[h,m]=W.useState("all"),[p,x]=W.useState({option:"title",direction:"asc"}),[v,w]=W.useState(""),[k,T]=W.useState("all"),E=_a();mi(),W.useEffect(()=>{const y=new URLSearchParams(E.search),S=y.get("q")||"",R=y.get("field")||"all";S!==v&&w(S),R!==k&&T(R)},[E.search]),W.useEffect(()=>{(async()=>{if(e)try{l(!0);const{userMovies:S,movies:R}=await e0(e.uid);s(S),r(R)}catch(S){console.error("Error fetching movies:",S),u("Failed to load movies")}finally{l(!1),i(!1)}})()},[e]);const N=y=>{x(S=>S.option===y?{option:y,direction:S.direction==="asc"?"desc":"asc"}:{option:y,direction:"asc"})},O=W.useCallback(y=>{if(!v.trim())return!0;const S=v.toLowerCase().trim(),R=S.split(",").map(C=>C.trim()).filter(Boolean),b=C=>y.cast&&y.cast.some(le=>le.toLowerCase().includes(C)),P=n[y.id];switch(k){case"title":return y.title.toLowerCase().includes(S)||y.sortTitle&&y.sortTitle.toLowerCase().includes(S)||y.originalTitle&&y.originalTitle.toLowerCase().includes(S);case"year":return y.releaseDate&&y.releaseDate.substring(0,4).includes(S);case"cast":return R.length?R.some(C=>b(C)):b(S);case"all":default:return y.title.toLowerCase().includes(S)||y.sortTitle&&y.sortTitle.toLowerCase().includes(S)||y.originalTitle&&y.originalTitle.toLowerCase().includes(S)||y.releaseDate&&y.releaseDate.substring(0,4).includes(S)||y.overview&&y.overview.toLowerCase().includes(S)||y.genres&&y.genres.some(C=>C.toLowerCase().includes(S))||y.directors&&y.directors.some(C=>C.toLowerCase().includes(S))||y.cast&&y.cast.some(C=>C.toLowerCase().includes(S))||P&&P.review&&P.review.toLowerCase().includes(S)}},[v,k,n]),L=W.useMemo(()=>{if(o)return[];i(!0);const y=t.filter(S=>{const R=n[S.id];let b=!0;switch(h){case"watched":b=R&&R.watched;break;case"unwatched":b=!R||!R.watched;break;case"favorites":b=R&&R.favorite;break}return b&&O(S)}).sort((S,R)=>{const b=n[S.id],P=n[R.id],C=p.direction==="asc"?1:-1;switch(p.option){case"title":const le=S.sortTitle||S.title,se=R.sortTitle||R.title;return le.localeCompare(se)*C;case"year":const he=S.releaseDate?parseInt(S.releaseDate.substring(0,4)):0,de=R.releaseDate?parseInt(R.releaseDate.substring(0,4)):0;return(he-de)*C;case"rating":const ie=(b==null?void 0:b.rating)||0,H=(P==null?void 0:P.rating)||0;return(ie-H)*C;case"watched":const ce=b!=null&&b.watched?1:0,ve=P!=null&&P.watched?1:0;return(ce-ve)*C;default:return 0}});return i(!1),y},[t,n,h,p,v,k,o]),g=L;return o?d.jsx("div",{className:"flex justify-center items-center min-h-[60vh]",children:d.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-xmas-gold"})}):d.jsxs("div",{className:"container mx-auto px-2 sm:px-4 py-4 sm:py-8",children:[d.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-center mb-4 sm:mb-8 gap-3",children:[d.jsx("h1",{className:"font-christmas text-2xl sm:text-3xl md:text-4xl text-xmas-line",children:"My Christmas Movies"}),d.jsxs("div",{className:"flex gap-2 w-full sm:w-auto justify-center",children:[d.jsxs(et,{to:"/random",className:"btn btn-primary btn-sm sm:btn-md",children:[d.jsx("i",{className:"fas fa-random mr-1 sm:mr-2"})," ",d.jsx("span",{className:"hidden xs:inline",children:"Random Movie"}),d.jsx("span",{className:"xs:hidden",children:"Random"})]}),d.jsxs(et,{to:"/import",className:"btn btn-primary btn-sm sm:btn-md",children:[d.jsx("i",{className:"fas fa-file-import mr-1 sm:mr-2"})," ",d.jsx("span",{className:"hidden xs:inline",children:"Add Movies"}),d.jsx("span",{className:"xs:hidden",children:"Import"})]})]})]}),c&&d.jsxs("div",{className:"alert alert-error mb-6",children:[d.jsx("i",{className:"fas fa-exclamation-circle mr-2"}),d.jsx("span",{children:c})]}),d.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 mb-3",children:[d.jsxs("div",{className:"relative flex-grow",children:[d.jsx("div",{className:"absolute inset-y-0 left-0 pl-2 flex items-center pointer-events-none",children:d.jsx("i",{className:"fas fa-search text-gray-400"})}),d.jsx("input",{type:"text",className:"input input-bordered input-sm sm:input-md w-full pl-8 pr-8",placeholder:"   Search movies...",value:v,onChange:y=>w(y.target.value)}),v&&d.jsx("button",{className:"absolute inset-y-0 right-0 pr-2 flex items-center",onClick:()=>w(""),children:d.jsx("i",{className:"fas fa-times text-gray-400 hover:text-gray-600"})})]}),d.jsxs("select",{className:"select select-bordered select-sm sm:select-md w-full sm:w-36",value:k,onChange:y=>T(y.target.value),children:[d.jsx("option",{value:"all",children:"All Fields"}),d.jsx("option",{value:"title",children:"Title Only"}),d.jsx("option",{value:"year",children:"Year Only"}),d.jsx("option",{value:"cast",children:"Cast Only"})]})]}),d.jsxs("div",{className:"tabs tabs-boxed mb-3 text-xs sm:text-sm overflow-x-auto",children:[d.jsx("button",{className:`tab ${h==="all"?"tab-active":""}`,onClick:()=>m("all"),children:"All Movies"}),d.jsx("button",{className:`tab ${h==="watched"?"tab-active":""}`,onClick:()=>m("watched"),children:"Watched"}),d.jsx("button",{className:`tab ${h==="unwatched"?"tab-active":""}`,onClick:()=>m("unwatched"),children:"Watch"}),d.jsxs("button",{className:`tab ${h==="favorites"?"tab-active":""}`,onClick:()=>m("favorites"),children:[d.jsx("span",{className:"hidden sm:inline",children:"Favourites"}),d.jsx("span",{className:"sm:hidden",children:"Favs"})]})]}),d.jsxs("div",{className:"flex flex-wrap items-center gap-1 mb-3 bg-xmas-card bg-opacity-50 p-2 rounded-lg overflow-x-auto",children:[d.jsx("span",{className:"text-xs sm:text-sm font-medium mr-1",children:"Sort:"}),d.jsxs("div",{className:"flex flex-nowrap gap-1 overflow-x-auto",children:[d.jsxs("button",{className:`btn btn-xs ${p.option==="title"?"btn-primary":"btn-ghost"}`,onClick:()=>N("title"),children:["Title ",p.option==="title"&&d.jsx("i",{className:`fas fa-sort-${p.direction==="asc"?"up":"down"} ml-1`})]}),d.jsxs("button",{className:`btn btn-xs ${p.option==="year"?"btn-primary":"btn-ghost"}`,onClick:()=>N("year"),children:["Year ",p.option==="year"&&d.jsx("i",{className:`fas fa-sort-${p.direction==="asc"?"up":"down"} ml-1`})]}),d.jsxs("button",{className:`btn btn-xs ${p.option==="rating"?"btn-primary":"btn-ghost"}`,onClick:()=>N("rating"),children:["Rating ",p.option==="rating"&&d.jsx("i",{className:`fas fa-sort-${p.direction==="asc"?"up":"down"} ml-1`})]}),d.jsxs("button",{className:`btn btn-xs ${p.option==="watched"?"btn-primary":"btn-ghost"}`,onClick:()=>N("watched"),children:[d.jsx("span",{className:"hidden sm:inline",children:"Watched Status"}),d.jsx("span",{className:"sm:hidden",children:"Watched"}),p.option==="watched"&&d.jsx("i",{className:`fas fa-sort-${p.direction==="asc"?"up":"down"} ml-1`})]})]})]}),d.jsxs("div",{className:"flex flex-col xs:flex-row justify-between items-start xs:items-center mb-3 text-xs sm:text-sm",children:[d.jsxs("div",{children:[d.jsx("span",{className:"font-medium",children:L.length})," ",L.length===1?"movie":"movies"," found",v&&d.jsxs("span",{className:"ml-1 text-xmas-mute",children:["for: ",d.jsxs("span",{className:"font-medium",children:['"',v,'"']})]})]}),p.option&&d.jsxs("div",{className:"text-xmas-mute",children:["Sorted by ",d.jsx("span",{className:"font-medium",children:p.option})," (",p.direction==="asc"?"asc":"desc",")"]})]}),a&&!o&&d.jsx("div",{className:"flex justify-center items-center py-4",children:d.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-t-2 border-b-2 border-xmas-gold"})}),L.length===0?d.jsxs("div",{className:"bg-xmas-card p-8 rounded-lg text-center",children:[d.jsx("h3",{className:"text-xl mb-4",children:"No movies found"}),d.jsx("p",{className:"mb-4",children:h==="all"?"You haven't added any Christmas movies yet.":`You don't have any ${h} Christmas movies.`}),d.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 justify-center",children:[d.jsxs(et,{to:"/import",className:"btn btn-primary",children:[d.jsx("i",{className:"fas fa-file-import mr-2"})," Add Movies"]}),t.length>0&&d.jsxs(et,{to:"/random",className:"btn btn-primary",children:[d.jsx("i",{className:"fas fa-random mr-2"})," Random Movie"]})]})]}):d.jsx("div",{className:"grid grid-cols-3 sm:grid-cols-4 md:grid-cols-5 lg:grid-cols-6 gap-2 sm:gap-3",children:g.map(y=>{var R;const S=n[y.id];return d.jsx(et,{to:$v(y.title,y.id),state:{from:"movies"},className:"block transition-transform hover:scale-[1.02] hover:shadow-xl",children:d.jsxs("div",{className:"relative rounded-lg overflow-hidden bg-xmas-card shadow-md h-full flex flex-col",children:[d.jsxs("div",{className:"relative",children:[y.posterUrl?d.jsx("img",{src:y.posterUrl,alt:y.title,className:"w-full h-auto object-cover",style:{aspectRatio:"2/3"},loading:"lazy"}):d.jsx("div",{className:"w-full flex items-center justify-center bg-gray-800",style:{aspectRatio:"2/3"},children:d.jsx("i",{className:"fas fa-film text-2xl text-gray-500"})}),S&&S.watched&&d.jsx("div",{className:"absolute top-1 right-1 bg-primary rounded-full p-1 shadow-md",children:d.jsx("i",{className:"fas fa-check text-xs text-white"})}),S&&S.favorite&&d.jsx("div",{className:"absolute top-1 left-1 text-yellow-400 drop-shadow-md",children:d.jsx("i",{className:"fas fa-star text-sm"})})]}),d.jsxs("div",{className:"p-1 sm:p-2 flex-grow flex flex-col",children:[d.jsx("h3",{className:"text-xs sm:text-sm font-medium line-clamp-2",children:y.title}),d.jsxs("div",{className:"flex justify-between items-center mt-1",children:[d.jsx("p",{className:"text-xs text-gray-400",children:(R=y.releaseDate)==null?void 0:R.substring(0,4)}),S&&S.rating&&d.jsxs("div",{className:"flex items-center",children:[d.jsx("span",{className:"text-yellow-400 mr-0.5",children:d.jsx("i",{className:"fas fa-star text-xs"})}),d.jsx("span",{className:"text-xs",children:S.rating})]})]})]})]})},y.id)})})]})},Np=Yr(_t,"stats","global");async function zL(){(await ra(Np)).exists()||await oi(Np,{watchedTotal:0,updatedAt:new Date},{merge:!0})}async function $L(e){await zL(),await dl(Np,{watchedTotal:OM(e),updatedAt:new Date})}const WL=[{id:"heartwarming",label:"Heartwarming",emoji:"",type:"positive"},{id:"very_christmassy",label:"Very Christmassy",emoji:"",type:"positive"},{id:"snowy",label:"Snowy Setting",emoji:"",type:"positive"},{id:"funny",label:"Funny",emoji:"",type:"positive"},{id:"cheesy",label:"Cheesy (Good Way)",emoji:"",type:"positive"},{id:"romantic",label:"Romantic",emoji:"",type:"positive"},{id:"family_friendly",label:"Family Friendly",emoji:"",type:"positive"},{id:"background",label:"Good Background Watch",emoji:"",type:"positive"},{id:"tearjerker",label:"Emotional",emoji:"",type:"positive"},{id:"rewatch",label:"Would Rewatch",emoji:"",type:"positive"}],HL=[{id:"slow",label:"Slow Pacing",emoji:"",type:"negative"},{id:"boring",label:"A Bit Boring",emoji:"",type:"negative"},{id:"low_christmas",label:"Low Xmas Vibes",emoji:"",type:"negative"},{id:"weak_chemistry",label:"Weak Chemistry",emoji:"",type:"negative"},{id:"confusing",label:"Confusing Plot",emoji:"",type:"negative"},{id:"too_long",label:"Too Long",emoji:"",type:"negative"},{id:"cringey",label:"Cringey",emoji:"",type:"negative"},{id:"fake_snow",label:"Fake Snow",emoji:"",type:"negative"},{id:"hammy",label:"Hammy",emoji:"",type:"negative"}],GL={heartwarming:"heartwarming",very_christmassy:"full of Christmas vibes",snowy:"with a lovely snowy setting",funny:"with some funny moments",cheesy:"a bit cheesy in a good way",romantic:"with sweet romantic moments",family_friendly:"very family friendly",background:"great as a cosy background watch",tearjerker:"quite emotional at times",rewatch:"something I'd happily rewatch"},KL={slow:"quite slow in places",boring:"a bit boring overall",low_christmas:"lighter on Christmas vibes than expected",weak_chemistry:"with weak chemistry between the leads",confusing:"a bit confusing at times",too_long:"longer than it needed to be",cringey:"a bit cringey in parts",fake_snow:"with fake snow",hammy:"hammy overacting"};function qL(e){return!e||e<=0?"An easy-going Christmas movie.":e>=9?"Absolutely loved this Christmas movie.":e>=8?"Really enjoyed this festive watch.":e>=7?"A good Christmas movie I liked overall.":e>=6?"A decent cosy watch with some nice moments.":e>=5?"An okay Christmas movie, but nothing special.":e>=3?"Not really my thing, it had a few issues.":"I didn't enjoy this Christmas movie very much."}function Hy(e){if(e.length===0)return"";if(e.length===1)return e[0];const t=e[e.length-1];return`${e.slice(0,-1).join(", ")} and ${t}`}function XL(e){const t=e.map(s=>GL[s]).filter(Boolean),r=e.map(s=>KL[s]).filter(Boolean);let n="";return t.length&&(n+=` It felt ${Hy(t)}.`),r.length&&(n+=` However, it was ${Hy(r)}.`),n}const YL=({rating:e,initialTags:t=[],initialAutoReview:r="",onChange:n})=>{const[s,a]=W.useState(t),[i,o]=W.useState(r);W.useEffect(()=>{a(t)},[t.join("|")]),W.useEffect(()=>{o(r)},[r]);const l=h=>{a(m=>m.includes(h)?m.filter(p=>p!==h):[...m,h])},c=()=>{const h=qL(e),m=XL(s),p=(h+m).trim();o(p),n&&n({tags:s,autoReview:p})},u=h=>s.includes(h);return d.jsxs("div",{className:"mt-4",children:[d.jsxs("div",{className:"flex items-center justify-between mb-2",children:[d.jsx("h3",{className:"text-lg font-semibold text-primary",children:"Quick Vibe Review"}),d.jsx("span",{className:"text-xs opacity-80",children:"Pick a few that fit, then generate."})]}),d.jsx("p",{className:"text-xs mb-1 opacity-80",children:"What worked?"}),d.jsx("div",{className:"flex flex-wrap gap-2 mb-3",children:WL.map(h=>d.jsxs("button",{type:"button",onClick:()=>l(h.id),className:`btn btn-xs rounded-full border ${u(h.id)?"btn-accent text-base-100":"btn-ghost border-base-300 text-sm"}`,children:[d.jsx("span",{className:"mr-1",children:h.emoji}),h.label]},h.id))}),d.jsx("p",{className:"text-xs mb-1 opacity-80",children:"What didn't?"}),d.jsx("div",{className:"flex flex-wrap gap-2 mb-3",children:HL.map(h=>d.jsxs("button",{type:"button",onClick:()=>l(h.id),className:`btn btn-xs rounded-full border ${u(h.id)?"btn-error text-base-100":"btn-ghost border-base-300 text-sm"}`,children:[d.jsx("span",{className:"mr-1",children:h.emoji}),h.label]},h.id))}),d.jsx("button",{type:"button",onClick:c,className:"btn btn-sm btn-primary",children:" Generate Review From Tags"}),i&&d.jsxs("p",{className:"mt-3 text-sm opacity-90 italic",children:["Generated preview: ",i,""]})]})},QL=({watched:e,watchedDate:t,onWatchedDateChange:r,rating:n,onRatingChange:s,review:a,onReviewChange:i,vibeTags:o,onVibeChange:l,saving:c,onSave:u})=>d.jsxs(d.Fragment,{children:[d.jsx("h2",{className:"text-2xl font-christmas text-xmas-gold mb-4",children:"Your Rating & Review"}),e&&d.jsxs("div",{className:"form-control mb-4",children:[d.jsx("label",{className:"label",children:d.jsx("span",{className:"label-text",children:"Date Watched"})}),d.jsx("input",{type:"date",className:"input input-bordered",value:t,onChange:h=>r(h.target.value)})]}),d.jsxs("div",{className:"form-control mb-4",children:[d.jsx("label",{className:"label",children:d.jsx("span",{className:"label-text",children:"Your Rating"})}),d.jsx("div",{className:"rating rating-lg",children:[1,2,3,4,5,6,7,8,9,10].map(h=>d.jsx("input",{type:"radio",name:"rating",className:`mask mask-star-2 ${h<=5?"bg-orange-400":"bg-yellow-400"}`,checked:n===h,onChange:()=>s(h)},h))}),n&&d.jsx("div",{className:"mt-2",children:d.jsx("button",{className:"btn btn-xs btn-ghost",onClick:()=>s(null),children:"Clear Rating"})})]}),d.jsx(YL,{rating:n,initialTags:o,initialAutoReview:a,onChange:l}),d.jsxs("div",{className:"form-control mb-6 mt-4",children:[d.jsx("label",{className:"label",children:d.jsx("span",{className:"label-text",children:"Your Review"})}),d.jsx("textarea",{className:"textarea textarea-bordered h-32",placeholder:"Write your thoughts about this movie...",value:a,onChange:h=>i(h.target.value)})]}),d.jsx("div",{className:"flex justify-end",children:d.jsx("button",{className:"btn btn-primary btn-sm sm:btn-md",onClick:u,disabled:c,children:c?d.jsxs(d.Fragment,{children:[d.jsx("span",{className:"loading loading-spinner loading-sm mr-2"}),"Saving..."]}):d.jsxs(d.Fragment,{children:[d.jsx("i",{className:"fas fa-save mr-2"}),"Save Changes"]})})})]}),JL=()=>{var ie;const{movieId:e}=kN(),t=_a(),r=mi(),{currentUser:n}=fs(),s=RL(),a=FL(t.search),o=((ie=t.state)==null?void 0:ie.from)==="import"?"/import":"/movies",[l,c]=W.useState(null),[u,h]=W.useState(null),[m,p]=W.useState(!0),[x,v]=W.useState(null),[w,k]=W.useState(!1),[T,E]=W.useState(!1),[N,O]=W.useState(""),[L,g]=W.useState(null),[y,S]=W.useState(""),[R,b]=W.useState(!1),[P,C]=W.useState([]);W.useEffect(()=>{(async()=>{if(!n||!a){v("Movie not found"),p(!1);return}try{p(!0);const ce=await ra(Yr(_t,"movies",a));if(!ce.exists()){v("Movie not found"),p(!1);return}const ve={id:ce.id,...ce.data()};c(ve);const B=await Rp(n.uid,a);if(B){h(B),E(B.watched);let K="";if(B.watchedDate)try{if(B.watchedDate instanceof Date)K=B.watchedDate.toISOString().split("T")[0];else{const q=B.watchedDate;if(typeof q=="object"&&q!==null&&"seconds"in q){const G=q;K=new Date(G.seconds*1e3).toISOString().split("T")[0]}else{const G=new Date(B.watchedDate);isNaN(G.getTime())||(K=G.toISOString().split("T")[0])}}}catch(q){console.error("Error parsing watchedDate:",q)}O(K),g(B.rating||null),S(B.review||""),b(B.favorite),C(B.vibeTags||[])}}catch(ce){console.error("Error fetching movie data:",ce),v("Failed to load movie data")}finally{p(!1)}})()},[n,a]);const le=async()=>{if(!(!n||!a||!l))try{k(!0);const H={userId:n.uid,movieId:a,watched:T,favorite:R,updatedAt:new Date,vibeTags:P};if(T&&N)try{H.watchedDate=new Date(N),isNaN(H.watchedDate.getTime())&&delete H.watchedDate}catch(B){console.error("Error parsing watchedDate for save:",B),delete H.watchedDate}else T||(H.watchedDate=null);H.rating=L,H.review=y||null;const ce=await Wv(n.uid,a,H);h(ce);const ve=await nh(n.uid);if(ve.length){const B=ve.map(K=>{var q;return((q=Go.find(G=>G.id===K))==null?void 0:q.name)||K}).join(", ");s.success(`You unlocked: ${B}! `)}}catch(H){console.error("Error saving movie data:",H),v("Failed to save movie data")}finally{k(!1)}},se=async()=>{if(!n||!a)return;const H=!R;b(H);try{const ce=Yr(_t,"users",n.uid,"movies",a);(await ra(ce)).exists()?await dl(ce,{favorite:H,updatedAt:new Date}):await oi(ce,{userId:n.uid,movieId:a,favorite:H,watched:!1,rating:null,review:"",vibeTags:[],addedAt:new Date,updatedAt:new Date},{merge:!0}),h(K=>K&&{...K,favorite:H});const B=await nh(n.uid);if(B.length){const K=B.map(q=>{var G;return((G=Go.find(oe=>oe.id===q))==null?void 0:G.name)||q}).join(", ");s.success(`You unlocked: ${K}! `)}}catch(ce){console.error("Failed to toggle favorite",ce),b(!H)}},he=async()=>{if(!(!n||!a||!window.confirm("Are you sure you want to remove this movie from your collection?")))try{k(!0),await UL(n.uid,a),r("/movies")}catch(H){console.error("Error deleting movie:",H),v("Failed to delete movie"),k(!1)}},de=async()=>{if(!n||!a)return;const H=!T;E(H);try{const ce=Yr(_t,"users",n.uid,"movies",a),ve=await ra(ce),B=ve.exists()?!!ve.data().watched:!1;ve.exists()?await dl(ce,{watched:H,...H?{}:{watchedDate:null},updatedAt:new Date}):await oi(ce,{userId:n.uid,movieId:a,watched:H,favorite:!1,rating:null,review:"",vibeTags:[],addedAt:new Date,updatedAt:new Date},{merge:!0}),h(q=>q&&{...q,watched:H}),B!==H&&await $L(H?1:-1);const K=await nh(n.uid);if(K.length){const q=K.map(G=>{var oe;return((oe=Go.find(xe=>xe.id===G))==null?void 0:oe.name)||G}).join(", ");s.success(`You unlocked: ${q}! `)}}catch(ce){console.error("Failed to toggle watched",ce),E(!H)}};return m?d.jsx("div",{className:"flex justify-center items-center min-h-[60vh]",children:d.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-xmas-gold"})}):l?d.jsxs("div",{className:"container mx-auto px-4 py-8",children:[d.jsx("div",{className:"mb-4",children:d.jsxs(et,{to:o,className:"btn btn-primary btn-sm sm:btn-md",children:[d.jsx("i",{className:"fas fa-arrow-left mr-2"})," Back to Movies"]})}),x&&d.jsxs("div",{className:"alert alert-error mb-6",children:[d.jsx("i",{className:"fas fa-exclamation-circle mr-2"}),d.jsx("span",{children:x})]}),d.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-8",children:[d.jsxs("div",{className:"md:col-span-1",children:[d.jsx("div",{className:"rounded-lg overflow-hidden shadow-xl",children:l.posterUrl?d.jsx("img",{src:l.posterUrl,alt:l.title,className:"w-full object-contain",style:{aspectRatio:"2/3"}}):d.jsx("div",{className:"w-full flex items-center justify-center bg-gray-800",style:{aspectRatio:"2/3"},children:d.jsx("i",{className:"fas fa-film text-6xl text-gray-500"})})}),d.jsxs("div",{className:"mt-4 flex flex-col gap-2",children:[d.jsxs("button",{className:`btn ${R?"btn-primary":"btn-outline"} w-full`,onClick:se,children:[d.jsx("i",{className:`fas fa-star mr-2 ${R?"text-white":""}`}),R?"Favourited":"Add to Favourites"]}),d.jsxs("button",{className:`btn ${T?"btn-success":"btn-outline"} w-full`,onClick:de,children:[d.jsx("i",{className:`fas fa-check mr-2 ${T?"text-white":""}`}),T?"Watched":"Mark as Watched"]}),d.jsxs("button",{className:"btn btn-error btn-outline w-full",onClick:he,disabled:w,children:[d.jsx("i",{className:"fas fa-trash mr-2"}),"Remove from Collection"]}),l.tmdbId&&d.jsxs("div",{className:"mt-2 flex flex-col items-center",children:[d.jsx("a",{href:`https://www.themoviedb.org/movie/${l.tmdbId}`,target:"_blank",rel:"noopener noreferrer",className:"btn btn-outline w-full flex items-center justify-center gap-2",children:d.jsx("img",{src:"/tmdb.svg",alt:"TMDB",className:"h-5"})}),d.jsx("p",{className:"mt-2 text-xs text-gray-400 text-center",children:"This product uses the TMDB API but is not endorsed or certified by TMDB."})]})]})]}),d.jsxs("div",{className:"md:col-span-2",children:[d.jsx("h1",{className:"font-christmas text-3xl md:text-4xl text-xmas-line mb-2",children:l.title}),l.releaseDate&&d.jsx("p",{className:"text-lg text-gray-400 mb-4",children:new Date(l.releaseDate).getFullYear()}),l.genres&&l.genres.length>0&&d.jsx("div",{className:"flex flex-wrap gap-2 mb-4",children:l.genres.map((H,ce)=>d.jsx("span",{className:"badge badge-outline",children:H},ce))}),l.runtime&&d.jsxs("p",{className:"mb-4",children:[d.jsx("i",{className:"fas fa-clock mr-2 text-xmas-gold"}),Math.floor(l.runtime/60),"h ",l.runtime%60,"m"]}),l.overview&&d.jsxs("div",{className:"mb-6",children:[d.jsx("h2",{className:"text-xl font-bold mb-2",children:"Overview"}),d.jsx("p",{className:"text-gray-300",children:l.overview})]}),l.directors&&l.directors.length>0&&d.jsxs("div",{className:"mb-4",children:[d.jsxs("h2",{className:"text-xl font-bold mb-2",children:["Director",l.directors.length>1?"s":""]}),d.jsx("p",{children:l.directors.join(", ")})]}),l.cast&&l.cast.length>0&&d.jsxs("div",{className:"mb-6",children:[d.jsx("h2",{className:"text-xl font-bold mb-2",children:"Cast"}),d.jsx("p",{className:"flex flex-wrap gap-1",children:l.cast.slice(0,10).map((H,ce)=>d.jsxs(fd.Fragment,{children:[d.jsx(et,{to:`/movies?q=${encodeURIComponent(H)}&field=cast`,className:"link link-primary",children:H}),ce<Math.min(l.cast.length,10)-1&&d.jsx("span",{children:","})]},H))})]}),d.jsx("div",{className:"divider"}),T&&d.jsx(QL,{watched:T,watchedDate:N,onWatchedDateChange:O,rating:L,onRatingChange:g,review:y,onReviewChange:S,vibeTags:P,onVibeChange:({tags:H,autoReview:ce})=>{C(H),S(ce)},saving:w,onSave:le})]})]})]}):d.jsxs("div",{className:"container mx-auto px-4 py-8",children:[d.jsxs("div",{className:"alert alert-error",children:[d.jsx("i",{className:"fas fa-exclamation-circle mr-2"}),d.jsx("span",{children:"Movie not found"})]}),d.jsx("div",{className:"mt-4",children:d.jsxs(et,{to:o,className:"btn btn-primary btn-sm sm:btn-md",children:[d.jsx("i",{className:"fas fa-arrow-left mr-2"})," Back to Movies"]})})]})};function Gy(e,t){let r=0;const n=(e.title||"").toLowerCase(),s=(t.title||"").toLowerCase();if(n&&s)if(n===s)r+=60;else if(s.includes(n)||n.includes(s))r+=40;else{const a=n.split(" "),i=s.split(" "),o=a.filter(l=>i.includes(l));r+=o.length/Math.max(a.length,i.length)*40}if(e.releaseDate&&t.release_date){const a=e.releaseDate.slice(0,4),i=t.release_date.slice(0,4);a===i?r+=40:Math.abs(parseInt(a)-parseInt(i))<=1&&(r+=20)}return Math.min(Math.round(r),100)}const ws=e=>e!=null&&e.poster_path?`https://image.tmdb.org/t/p/w500${e.poster_path}`:(e==null?void 0:e.posterUrl)||"",ZL=({onSelect:e,userMovieIds:t})=>{const r=mi(),[n,s]=W.useState([]),[a,i]=W.useState(!0),[o,l]=W.useState(null),[c,u]=W.useState(""),[h,m]=W.useState("all"),[p,x]=W.useState("title-asc"),[v,w]=W.useState(!1);W.useEffect(()=>{(async()=>{try{i(!0),l(null);const L=(await kn(mn(_t,"movies"))).docs.map(g=>{var S;const y=g.data();return y.tmdbId?{id:y.tmdbId,title:y.title,release_date:y.releaseDate,poster_path:(S=y.posterUrl)!=null&&S.startsWith("https://image.tmdb.org/t/p/")?y.posterUrl.replace("https://image.tmdb.org/t/p/w500",""):null,source:"local",firestoreId:g.id,cast:y.cast||[],runtime:y.runtime,genres:y.genres||[],overview:y.overview}:null}).filter(Boolean);s(L)}catch(O){console.error("Error loading local catalogue:",O),l((O==null?void 0:O.message)??"Failed to load local catalogue")}finally{i(!1)}})()},[]);const k=W.useCallback(N=>{if(!c.trim())return!0;const O=c.toLowerCase().trim(),L=O.split(",").map(y=>y.trim()).filter(Boolean),g=y=>N.cast&&N.cast.some(S=>S.toLowerCase().includes(y));switch(h){case"title":return N.title.toLowerCase().includes(O);case"year":return N.release_date&&N.release_date.substring(0,4).includes(O);case"cast":return L.length?L.some(y=>g(y)):g(O);case"all":default:return N.title.toLowerCase().includes(O)||N.release_date&&N.release_date.substring(0,4).includes(O)||N.cast&&N.cast.some(y=>y.toLowerCase().includes(O))}},[c,h]),T=W.useMemo(()=>n.filter(N=>{if(!k(N))return!1;const O=!!N.firestoreId&&t.includes(N.firestoreId);return!(v&&O)}),[n,k,t,v]),E=W.useMemo(()=>{const N=[...T],O=L=>{if(!L.release_date)return 0;const g=parseInt(L.release_date.slice(0,4),10);return Number.isNaN(g)?0:g};return N.sort((L,g)=>{switch(p){case"title-asc":return L.title.localeCompare(g.title);case"title-desc":return g.title.localeCompare(L.title);case"year-desc":{const y=O(L);return O(g)-y||L.title.localeCompare(g.title)}case"year-asc":{const y=O(L),S=O(g);return y-S||L.title.localeCompare(g.title)}default:return 0}}),N},[T,p]);return d.jsxs("div",{className:"space-y-4",children:[d.jsxs("div",{className:"flex flex-col lg:flex-row gap-2",children:[d.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 flex-1",children:[d.jsxs("div",{className:"relative flex-grow",children:[d.jsx("div",{className:"absolute inset-y-0 left-0 pl-2 flex items-center pointer-events-none",children:d.jsx("i",{className:"fas fa-search text-gray-400"})}),d.jsx("input",{type:"text",className:"input input-bordered input-sm sm:input-md w-full pl-8 pr-8",placeholder:"   Search catalogue by title, cast, year...",value:c,onChange:N=>u(N.target.value)}),c&&d.jsx("button",{className:"absolute inset-y-0 right-0 pr-2 flex items-center",onClick:()=>u(""),children:d.jsx("i",{className:"fas fa-times text-gray-400 hover:text-gray-600"})})]}),d.jsxs("select",{className:"select select-bordered select-sm sm:select-md w-full sm:w-40",value:h,onChange:N=>m(N.target.value),children:[d.jsx("option",{value:"all",children:"All Fields"}),d.jsx("option",{value:"title",children:"Title Only"}),d.jsx("option",{value:"year",children:"Year Only"}),d.jsx("option",{value:"cast",children:"Cast Only"})]})]}),d.jsx("div",{className:"flex items-center justify-end",children:d.jsxs("select",{className:"select select-bordered select-sm sm:select-md w-full sm:w-52",value:p,onChange:N=>x(N.target.value),children:[d.jsx("option",{value:"title-asc",children:"Sort: Title (A  Z)"}),d.jsx("option",{value:"title-desc",children:"Sort: Title (Z  A)"}),d.jsx("option",{value:"year-desc",children:"Sort: Year (Newest  Oldest)"}),d.jsx("option",{value:"year-asc",children:"Sort: Year (Oldest  Newest)"})]})})]}),d.jsxs("div",{className:"flex flex-col xs:flex-row justify-between items-start xs:items-center text-xs sm:text-sm gap-2",children:[d.jsx("div",{children:a?d.jsx("span",{children:"Loading catalogue"}):d.jsxs(d.Fragment,{children:[d.jsx("span",{className:"font-medium",children:E.length})," ",E.length===1?"movie":"movies"," in catalogue",c&&d.jsxs("span",{className:"ml-1 opacity-70",children:["for: ",d.jsxs("span",{className:"font-medium",children:['"',c,'"']})]})]})}),d.jsxs("label",{className:"flex items-center gap-1 cursor-pointer select-none",children:[d.jsx("input",{type:"checkbox",className:"checkbox checkbox-xs sm:checkbox-sm",checked:v,onChange:N=>w(N.target.checked)}),d.jsx("span",{children:"Hide owned movies"})]})]}),o&&d.jsx("div",{className:"alert alert-error",children:o}),a&&d.jsx("div",{className:"flex justify-center p-6",children:d.jsx("span",{className:"loading loading-spinner loading-lg"})}),!a&&E.length===0&&!o&&d.jsxs("div",{className:"bg-xmas-card bg-opacity-60 rounded-lg p-6 text-center",children:[d.jsx("h3",{className:"text-lg font-semibold mb-2",children:"No movies found"}),d.jsx("p",{className:"text-sm opacity-80 mb-2",children:"Try changing your search text, field, or sort order."})]}),!a&&E.length>0&&d.jsx("div",{className:"grid grid-cols-3 sm:grid-cols-4 md:grid-cols-5 lg:grid-cols-6 gap-2 sm:gap-3",children:E.map(N=>{var L;const O=!!N.firestoreId&&t.includes(N.firestoreId);return d.jsx("div",{className:`block transition-transform hover:scale-[1.02] hover:shadow-xl ${O?"opacity-60 cursor-pointer":"cursor-pointer"}`,onClick:()=>{O&&N.firestoreId?r($v(N.title,N.firestoreId),{state:{from:"import"}}):e(N)},children:d.jsxs("div",{className:"relative rounded-lg overflow-hidden bg-xmas-card shadow-md h-full flex flex-col",children:[d.jsxs("div",{className:"relative",children:[ws(N)?d.jsx("img",{src:ws(N),alt:N.title,className:"w-full h-auto object-cover",style:{aspectRatio:"2/3"},loading:"lazy"}):d.jsx("div",{className:"w-full flex items-center justify-center bg-gray-800",style:{aspectRatio:"2/3"},children:d.jsx("i",{className:"fas fa-film text-2xl text-gray-500"})}),O&&d.jsxs("div",{className:`\r
                          absolute top-1 left-1 \r
                          badge badge-success \r
                          px-2 py-0.5 \r
                          text-[0.6rem] leading-none \r
                          whitespace-nowrap \r
                          flex items-center gap-1 \r
                          shadow\r
                        `,children:[d.jsx("i",{className:"fas fa-check text-[0.6rem]"}),d.jsx("span",{children:"Owned"})]})]}),d.jsxs("div",{className:"p-1 sm:p-2 flex-grow flex flex-col",children:[d.jsx("h3",{className:"text-xs sm:text-sm font-medium line-clamp-2",children:N.title}),d.jsx("p",{className:"text-xs text-gray-400 mt-1",children:(L=N.release_date)==null?void 0:L.slice(0,4)})]})]})},N.firestoreId||N.id)})})]})},YS=e=>{const t=e.trim();return/^The\s+/i.test(t)?t.replace(/^The\s+/i,"").trim():/^A\s+/i.test(t)?t.replace(/^A\s+/i,"").trim():/^An\s+/i.test(t)?t.replace(/^An\s+/i,"").trim():t},QS="https://api.themoviedb.org/3",e6="https://image.tmdb.org/t/p/w500",t6="https://image.tmdb.org/t/p/original",JS=e=>(e||"").toLowerCase().replace(/^(the|a|an)\s+/,"").replace(/[^a-z0-9]+/g," ").trim(),r6=e=>{var n;const t=new Set,r=s=>{const a=JS(s||"");a&&(t.add(a),a.split(" ").forEach(i=>i&&t.add(i)))};return r(e.title),r(e.original_title),e.release_date&&t.add(e.release_date.slice(0,4)),(e.genres||[]).forEach(s=>r(s==null?void 0:s.name)),(((n=e.credits)==null?void 0:n.cast)||[]).slice(0,5).forEach(s=>r(s==null?void 0:s.name)),Array.from(t).slice(0,200)},bp=async(e,t)=>{const r=await fetch(`${QS}/search/movie?api_key=${t}&query=${encodeURIComponent(e)}&include_adult=false`);if(!r.ok)throw new Error(`TMDB API error: ${r.status}`);return await r.json()},Jh=async(e,t)=>{const r=await fetch(`${QS}/movie/${e}?api_key=${t}&append_to_response=credits`);if(!r.ok)throw new Error(`TMDB API error: ${r.status}`);return await r.json()},Hv=e=>{var n,s,a,i,o,l;const t=YS(e.title),r=JS(t);return{tmdbId:e.id,title:e.title,sortTitle:t,sortTitleLower:r,originalTitle:e.original_title,releaseDate:e.release_date,posterUrl:e.poster_path?`${e6}${e.poster_path}`:void 0,backdropUrl:e.backdrop_path?`${t6}${e.backdrop_path}`:void 0,overview:e.overview,runtime:e.runtime,genres:((n=e.genres)==null?void 0:n.map(c=>c.name))||[],directors:((i=(a=(s=e.credits)==null?void 0:s.crew)==null?void 0:a.filter(c=>c.job==="Director"))==null?void 0:i.map(c=>c.name))||[],cast:((l=(o=e.credits)==null?void 0:o.cast)==null?void 0:l.slice(0,10).map(c=>c.name))||[],isChristmas:!0,keywords:r6(e),updatedAt:new Date}},n6=({tmdbApiKey:e,onSelect:t})=>{const[r,n]=W.useState(""),[s,a]=W.useState(!1),[i,o]=W.useState([]),[l,c]=W.useState(null),u=async()=>{if(r.trim())try{a(!0),c(null);const h=await bp(r,e);o(h.results)}catch(h){c((h==null?void 0:h.message)??"TMDB search failed")}finally{a(!1)}};return d.jsxs("div",{className:"space-y-3",children:[d.jsxs("div",{className:"flex gap-2",children:[d.jsx("input",{className:"input input-bordered flex-1",value:r,onChange:h=>n(h.target.value),placeholder:"Search TMDB...",onKeyDown:h=>h.key==="Enter"&&u()}),d.jsx("button",{className:"btn btn-primary",onClick:u,disabled:s||!e,children:s?d.jsx("span",{className:"loading loading-spinner loading-sm"}):"Search"})]}),l&&d.jsx("div",{className:"alert alert-error",children:l}),i.length>0&&d.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-3",children:i.map(h=>{var m;return d.jsxs("div",{className:"card bg-base-100 shadow cursor-pointer hover:shadow-lg transition-shadow",onClick:()=>t(h),children:[d.jsx("figure",{children:ws(h)?d.jsx("img",{src:ws(h),alt:h.title,className:"w-full h-64 object-contain"}):d.jsx("div",{className:"h-64 w-full flex items-center justify-center bg-base-200",children:d.jsx("i",{className:"fas fa-film text-3xl opacity-50"})})}),d.jsxs("div",{className:"card-body p-3",children:[d.jsx("div",{className:"font-semibold",children:h.title}),d.jsx("div",{className:"text-xs opacity-70",children:(m=h.release_date)==null?void 0:m.slice(0,4)})]})]},h.id)})})]})};/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var ZS=1252,s6=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],Gv={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},Kv=function(e){s6.indexOf(e)!=-1&&(ZS=Gv[0]=e)};function a6(){Kv(1252)}var ns=function(e){Kv(e)};function eA(){ns(1200),a6()}function Ky(e){for(var t=[],r=0,n=e.length;r<n;++r)t[r]=e.charCodeAt(r);return t}function i6(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r)+(e.charCodeAt(2*r+1)<<8));return t.join("")}function tA(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r+1)+(e.charCodeAt(2*r)<<8));return t.join("")}var nc=function(e){var t=e.charCodeAt(0),r=e.charCodeAt(1);return t==255&&r==254?i6(e.slice(2)):t==254&&r==255?tA(e.slice(2)):t==65279?e.slice(1):e},Af=function(t){return String.fromCharCode(t)},qy=function(t){return String.fromCharCode(t)},iu,Ba="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function Xy(e){for(var t="",r=0,n=0,s=0,a=0,i=0,o=0,l=0,c=0;c<e.length;)r=e.charCodeAt(c++),a=r>>2,n=e.charCodeAt(c++),i=(r&3)<<4|n>>4,s=e.charCodeAt(c++),o=(n&15)<<2|s>>6,l=s&63,isNaN(n)?o=l=64:isNaN(s)&&(l=64),t+=Ba.charAt(a)+Ba.charAt(i)+Ba.charAt(o)+Ba.charAt(l);return t}function An(e){var t="",r=0,n=0,s=0,a=0,i=0,o=0,l=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var c=0;c<e.length;)a=Ba.indexOf(e.charAt(c++)),i=Ba.indexOf(e.charAt(c++)),r=a<<2|i>>4,t+=String.fromCharCode(r),o=Ba.indexOf(e.charAt(c++)),n=(i&15)<<4|o>>2,o!==64&&(t+=String.fromCharCode(n)),l=Ba.indexOf(e.charAt(c++)),s=(o&3)<<6|l,l!==64&&(t+=String.fromCharCode(s));return t}var Qe=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),no=function(){if(typeof Buffer<"u"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(t,r){return r?new Buffer(t,r):new Buffer(t)}:Buffer.from.bind(Buffer)}return function(){}}();function li(e){return Qe?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}function Yy(e){return Qe?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}var ts=function(t){return Qe?no(t,"binary"):t.split("").map(function(r){return r.charCodeAt(0)&255})};function so(e){if(Array.isArray(e))return e.map(function(n){return String.fromCharCode(n)}).join("");for(var t=[],r=0;r<e.length;++r)t[r]=String.fromCharCode(e[r]);return t.join("")}function qv(e){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(e instanceof ArrayBuffer)return qv(new Uint8Array(e));for(var t=new Array(e.length),r=0;r<e.length;++r)t[r]=e[r];return t}var Ma=Qe?function(e){return Buffer.concat(e.map(function(t){return Buffer.isBuffer(t)?t:no(t)}))}:function(e){if(typeof Uint8Array<"u"){var t=0,r=0;for(t=0;t<e.length;++t)r+=e[t].length;var n=new Uint8Array(r),s=0;for(t=0,r=0;t<e.length;r+=s,++t)if(s=e[t].length,e[t]instanceof Uint8Array)n.set(e[t],r);else{if(typeof e[t]=="string")throw"wtf";n.set(new Uint8Array(e[t]),r)}return n}return[].concat.apply([],e.map(function(a){return Array.isArray(a)?a:[].slice.call(a)}))};function o6(e){for(var t=[],r=0,n=e.length+250,s=li(e.length+255),a=0;a<e.length;++a){var i=e.charCodeAt(a);if(i<128)s[r++]=i;else if(i<2048)s[r++]=192|i>>6&31,s[r++]=128|i&63;else if(i>=55296&&i<57344){i=(i&1023)+64;var o=e.charCodeAt(++a)&1023;s[r++]=240|i>>8&7,s[r++]=128|i>>2&63,s[r++]=128|o>>6&15|(i&3)<<4,s[r++]=128|o&63}else s[r++]=224|i>>12&15,s[r++]=128|i>>6&63,s[r++]=128|i&63;r>n&&(t.push(s.slice(0,r)),r=0,s=li(65535),n=65530)}return t.push(s.slice(0,r)),Ma(t)}var Qr=/\u0000/g,sc=/[\u0001-\u0006]/g;function Ko(e){for(var t="",r=e.length-1;r>=0;)t+=e.charAt(r--);return t}function ss(e,t){var r=""+e;return r.length>=t?r:Ut("0",t-r.length)+r}function Xv(e,t){var r=""+e;return r.length>=t?r:Ut(" ",t-r.length)+r}function Zh(e,t){var r=""+e;return r.length>=t?r:r+Ut(" ",t-r.length)}function l6(e,t){var r=""+Math.round(e);return r.length>=t?r:Ut("0",t-r.length)+r}function c6(e,t){var r=""+e;return r.length>=t?r:Ut("0",t-r.length)+r}var Qy=Math.pow(2,32);function xo(e,t){if(e>Qy||e<-Qy)return l6(e,t);var r=Math.round(e);return c6(r,t)}function ed(e,t){return t=t||0,e.length>=7+t&&(e.charCodeAt(t)|32)===103&&(e.charCodeAt(t+1)|32)===101&&(e.charCodeAt(t+2)|32)===110&&(e.charCodeAt(t+3)|32)===101&&(e.charCodeAt(t+4)|32)===114&&(e.charCodeAt(t+5)|32)===97&&(e.charCodeAt(t+6)|32)===108}var Jy=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],Q0=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function u6(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"/ "hh""mm""ss" "',e}var ze={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},Zy={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},f6={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function td(e,t,r){for(var n=e<0?-1:1,s=e*n,a=0,i=1,o=0,l=1,c=0,u=0,h=Math.floor(s);c<t&&(h=Math.floor(s),o=h*i+a,u=h*c+l,!(s-h<5e-8));)s=1/(s-h),a=i,i=o,l=c,c=u;if(u>t&&(c>t?(u=l,o=a):(u=c,o=i)),!r)return[0,n*o,u];var m=Math.floor(n*o/u);return[m,n*o-m*u,u]}function bi(e,t,r){if(e>2958465||e<0)return null;var n=e|0,s=Math.floor(86400*(e-n)),a=0,i=[],o={D:n,T:s,u:86400*(e-n)-s,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(o.u)<1e-6&&(o.u=0),t&&t.date1904&&(n+=1462),o.u>.9999&&(o.u=0,++s==86400&&(o.T=s=0,++n,++o.D)),n===60)i=r?[1317,10,29]:[1900,2,29],a=3;else if(n===0)i=r?[1317,8,29]:[1900,1,0],a=6;else{n>60&&--n;var l=new Date(1900,0,1);l.setDate(l.getDate()+n-1),i=[l.getFullYear(),l.getMonth()+1,l.getDate()],a=l.getDay(),n<60&&(a=(a+6)%7),r&&(a=v6(l,i))}return o.y=i[0],o.m=i[1],o.d=i[2],o.S=s%60,s=Math.floor(s/60),o.M=s%60,s=Math.floor(s/60),o.H=s,o.q=a,o}var rA=new Date(1899,11,31,0,0,0),h6=rA.getTime(),d6=new Date(1900,2,1,0,0,0);function nA(e,t){var r=e.getTime();return t?r-=1461*24*60*60*1e3:e>=d6&&(r+=24*60*60*1e3),(r-(h6+(e.getTimezoneOffset()-rA.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function Yv(e){return e.indexOf(".")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function m6(e){return e.indexOf("E")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function p6(e){var t=e<0?12:11,r=Yv(e.toFixed(12));return r.length<=t||(r=e.toPrecision(10),r.length<=t)?r:e.toExponential(5)}function g6(e){var t=Yv(e.toFixed(11));return t.length>(e<0?12:11)||t==="0"||t==="-0"?e.toPrecision(6):t}function ou(e){var t=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),r;return t>=-4&&t<=-1?r=e.toPrecision(10+t):Math.abs(t)<=9?r=p6(e):t===10?r=e.toFixed(10).substr(0,12):r=g6(e),Yv(m6(r.toUpperCase()))}function qi(e,t){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):ou(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return $n(14,nA(e,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+e)}function v6(e,t){t[0]-=581;var r=e.getDay();return e<60&&(r=(r+6)%7),r}function x6(e,t,r,n){var s="",a=0,i=0,o=r.y,l,c=0;switch(e){case 98:o=r.y+543;case 121:switch(t.length){case 1:case 2:l=o%100,c=2;break;default:l=o%1e4,c=4;break}break;case 109:switch(t.length){case 1:case 2:l=r.m,c=t.length;break;case 3:return Q0[r.m-1][1];case 5:return Q0[r.m-1][0];default:return Q0[r.m-1][2]}break;case 100:switch(t.length){case 1:case 2:l=r.d,c=t.length;break;case 3:return Jy[r.q][0];default:return Jy[r.q][1]}break;case 104:switch(t.length){case 1:case 2:l=1+(r.H+11)%12,c=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:l=r.H,c=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:l=r.M,c=t.length;break;default:throw"bad minute format: "+t}break;case 115:if(t!="s"&&t!="ss"&&t!=".0"&&t!=".00"&&t!=".000")throw"bad second format: "+t;return r.u===0&&(t=="s"||t=="ss")?ss(r.S,t.length):(n>=2?i=n===3?1e3:100:i=n===1?10:1,a=Math.round(i*(r.S+r.u)),a>=60*i&&(a=0),t==="s"?a===0?"0":""+a/i:(s=ss(a,2+n),t==="ss"?s.substr(0,2):"."+s.substr(2,t.length-1)));case 90:switch(t){case"[h]":case"[hh]":l=r.D*24+r.H;break;case"[m]":case"[mm]":l=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":l=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+t}c=t.length===3?1:2;break;case 101:l=o,c=1;break}var u=c>0?ss(l,c):"";return u}function za(e){var t=3;if(e.length<=t)return e;for(var r=e.length%t,n=e.substr(0,r);r!=e.length;r+=t)n+=(n.length>0?",":"")+e.substr(r,t);return n}var sA=/%/g;function _6(e,t,r){var n=t.replace(sA,""),s=t.length-n.length;return na(e,n,r*Math.pow(10,2*s))+Ut("%",s)}function y6(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return na(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function aA(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+aA(e,-t);var s=e.indexOf(".");s===-1&&(s=e.indexOf("E"));var a=Math.floor(Math.log(t)*Math.LOG10E)%s;if(a<0&&(a+=s),r=(t/Math.pow(10,a)).toPrecision(n+1+(s+a)%s),r.indexOf("e")===-1){var i=Math.floor(Math.log(t)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(i-r.length+a):r+="E+"+(i-a);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,s)+"."+r.substr(2+s),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,l,c,u){return l+c+u.substr(0,(s+a)%s)+"."+u.substr(a)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var iA=/# (\?+)( ?)\/( ?)(\d+)/;function w6(e,t,r){var n=parseInt(e[4],10),s=Math.round(t*n),a=Math.floor(s/n),i=s-a*n,o=n;return r+(a===0?"":""+a)+" "+(i===0?Ut(" ",e[1].length+1+e[4].length):Xv(i,e[1].length)+e[2]+"/"+e[3]+ss(o,e[4].length))}function E6(e,t,r){return r+(t===0?"":""+t)+Ut(" ",e[1].length+2+e[4].length)}var oA=/^#*0*\.([0#]+)/,lA=/\).*[0#]/,cA=/\(###\) ###\\?-####/;function Gr(e){for(var t="",r,n=0;n!=e.length;++n)switch(r=e.charCodeAt(n)){case 35:break;case 63:t+=" ";break;case 48:t+="0";break;default:t+=String.fromCharCode(r)}return t}function ew(e,t){var r=Math.pow(10,t);return""+Math.round(e*r)/r}function tw(e,t){var r=e-Math.floor(e),n=Math.pow(10,t);return t<(""+Math.round(r*n)).length?0:Math.round(r*n)}function T6(e,t){return t<(""+Math.round((e-Math.floor(e))*Math.pow(10,t))).length?1:0}function k6(e){return e<2147483647&&e>-2147483648?""+(e>=0?e|0:e-1|0):""+Math.floor(e)}function Dn(e,t,r){if(e.charCodeAt(0)===40&&!t.match(lA)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Dn("n",n,r):"("+Dn("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return y6(e,t,r);if(t.indexOf("%")!==-1)return _6(e,t,r);if(t.indexOf("E")!==-1)return aA(t,r);if(t.charCodeAt(0)===36)return"$"+Dn(e,t.substr(t.charAt(1)==" "?2:1),r);var s,a,i,o,l=Math.abs(r),c=r<0?"-":"";if(t.match(/^00+$/))return c+xo(l,t.length);if(t.match(/^[#?]+$/))return s=xo(r,0),s==="0"&&(s=""),s.length>t.length?s:Gr(t.substr(0,t.length-s.length))+s;if(a=t.match(iA))return w6(a,l,c);if(t.match(/^#+0+$/))return c+xo(l,t.length-t.indexOf("0"));if(a=t.match(oA))return s=ew(r,a[1].length).replace(/^([^\.]+)$/,"$1."+Gr(a[1])).replace(/\.$/,"."+Gr(a[1])).replace(/\.(\d*)$/,function(x,v){return"."+v+Ut("0",Gr(a[1]).length-v.length)}),t.indexOf("0.")!==-1?s:s.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),a=t.match(/^(0*)\.(#*)$/))return c+ew(l,a[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,a[1].length?"0.":".");if(a=t.match(/^#{1,3},##0(\.?)$/))return c+za(xo(l,0));if(a=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Dn(e,t,-r):za(""+(Math.floor(r)+T6(r,a[1].length)))+"."+ss(tw(r,a[1].length),a[1].length);if(a=t.match(/^#,#*,#0/))return Dn(e,t.replace(/^#,#*,/,""),r);if(a=t.match(/^([0#]+)(\\?-([0#]+))+$/))return s=Ko(Dn(e,t.replace(/[\\-]/g,""),r)),i=0,Ko(Ko(t.replace(/\\/g,"")).replace(/[0#]/g,function(x){return i<s.length?s.charAt(i++):x==="0"?"0":""}));if(t.match(cA))return s=Dn(e,"##########",r),"("+s.substr(0,3)+") "+s.substr(3,3)+"-"+s.substr(6);var u="";if(a=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(a[4].length,7),o=td(l,Math.pow(10,i)-1,!1),s=""+c,u=na("n",a[1],o[1]),u.charAt(u.length-1)==" "&&(u=u.substr(0,u.length-1)+"0"),s+=u+a[2]+"/"+a[3],u=Zh(o[2],i),u.length<a[4].length&&(u=Gr(a[4].substr(a[4].length-u.length))+u),s+=u,s;if(a=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(Math.max(a[1].length,a[4].length),7),o=td(l,Math.pow(10,i)-1,!0),c+(o[0]||(o[1]?"":"0"))+" "+(o[1]?Xv(o[1],i)+a[2]+"/"+a[3]+Zh(o[2],i):Ut(" ",2*i+1+a[2].length+a[3].length));if(a=t.match(/^[#0?]+$/))return s=xo(r,0),t.length<=s.length?s:Gr(t.substr(0,t.length-s.length))+s;if(a=t.match(/^([#0?]+)\.([#0]+)$/)){s=""+r.toFixed(Math.min(a[2].length,10)).replace(/([^0])0+$/,"$1"),i=s.indexOf(".");var h=t.indexOf(".")-i,m=t.length-s.length-h;return Gr(t.substr(0,h)+s+t.substr(t.length-m))}if(a=t.match(/^00,000\.([#0]*0)$/))return i=tw(r,a[1].length),r<0?"-"+Dn(e,t,-r):za(k6(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(x){return"00,"+(x.length<3?ss(0,3-x.length):"")+x})+"."+ss(i,a[1].length);switch(t){case"###,##0.00":return Dn(e,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var p=za(xo(l,0));return p!=="0"?c+p:"";case"###,###.00":return Dn(e,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return Dn(e,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+t+"|")}function S6(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return na(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function A6(e,t,r){var n=t.replace(sA,""),s=t.length-n.length;return na(e,n,r*Math.pow(10,2*s))+Ut("%",s)}function uA(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+uA(e,-t);var s=e.indexOf(".");s===-1&&(s=e.indexOf("E"));var a=Math.floor(Math.log(t)*Math.LOG10E)%s;if(a<0&&(a+=s),r=(t/Math.pow(10,a)).toPrecision(n+1+(s+a)%s),!r.match(/[Ee]/)){var i=Math.floor(Math.log(t)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(i-r.length+a):r+="E+"+(i-a),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,l,c,u){return l+c+u.substr(0,(s+a)%s)+"."+u.substr(a)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function vs(e,t,r){if(e.charCodeAt(0)===40&&!t.match(lA)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?vs("n",n,r):"("+vs("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return S6(e,t,r);if(t.indexOf("%")!==-1)return A6(e,t,r);if(t.indexOf("E")!==-1)return uA(t,r);if(t.charCodeAt(0)===36)return"$"+vs(e,t.substr(t.charAt(1)==" "?2:1),r);var s,a,i,o,l=Math.abs(r),c=r<0?"-":"";if(t.match(/^00+$/))return c+ss(l,t.length);if(t.match(/^[#?]+$/))return s=""+r,r===0&&(s=""),s.length>t.length?s:Gr(t.substr(0,t.length-s.length))+s;if(a=t.match(iA))return E6(a,l,c);if(t.match(/^#+0+$/))return c+ss(l,t.length-t.indexOf("0"));if(a=t.match(oA))return s=(""+r).replace(/^([^\.]+)$/,"$1."+Gr(a[1])).replace(/\.$/,"."+Gr(a[1])),s=s.replace(/\.(\d*)$/,function(x,v){return"."+v+Ut("0",Gr(a[1]).length-v.length)}),t.indexOf("0.")!==-1?s:s.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),a=t.match(/^(0*)\.(#*)$/))return c+(""+l).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,a[1].length?"0.":".");if(a=t.match(/^#{1,3},##0(\.?)$/))return c+za(""+l);if(a=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+vs(e,t,-r):za(""+r)+"."+Ut("0",a[1].length);if(a=t.match(/^#,#*,#0/))return vs(e,t.replace(/^#,#*,/,""),r);if(a=t.match(/^([0#]+)(\\?-([0#]+))+$/))return s=Ko(vs(e,t.replace(/[\\-]/g,""),r)),i=0,Ko(Ko(t.replace(/\\/g,"")).replace(/[0#]/g,function(x){return i<s.length?s.charAt(i++):x==="0"?"0":""}));if(t.match(cA))return s=vs(e,"##########",r),"("+s.substr(0,3)+") "+s.substr(3,3)+"-"+s.substr(6);var u="";if(a=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(a[4].length,7),o=td(l,Math.pow(10,i)-1,!1),s=""+c,u=na("n",a[1],o[1]),u.charAt(u.length-1)==" "&&(u=u.substr(0,u.length-1)+"0"),s+=u+a[2]+"/"+a[3],u=Zh(o[2],i),u.length<a[4].length&&(u=Gr(a[4].substr(a[4].length-u.length))+u),s+=u,s;if(a=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(Math.max(a[1].length,a[4].length),7),o=td(l,Math.pow(10,i)-1,!0),c+(o[0]||(o[1]?"":"0"))+" "+(o[1]?Xv(o[1],i)+a[2]+"/"+a[3]+Zh(o[2],i):Ut(" ",2*i+1+a[2].length+a[3].length));if(a=t.match(/^[#0?]+$/))return s=""+r,t.length<=s.length?s:Gr(t.substr(0,t.length-s.length))+s;if(a=t.match(/^([#0]+)\.([#0]+)$/)){s=""+r.toFixed(Math.min(a[2].length,10)).replace(/([^0])0+$/,"$1"),i=s.indexOf(".");var h=t.indexOf(".")-i,m=t.length-s.length-h;return Gr(t.substr(0,h)+s+t.substr(t.length-m))}if(a=t.match(/^00,000\.([#0]*0)$/))return r<0?"-"+vs(e,t,-r):za(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(x){return"00,"+(x.length<3?ss(0,3-x.length):"")+x})+"."+ss(0,a[1].length);switch(t){case"###,###":case"##,###":case"#,###":var p=za(""+l);return p!=="0"?c+p:"";default:if(t.match(/\.[0#?]*$/))return vs(e,t.slice(0,t.lastIndexOf(".")),r)+Gr(t.slice(t.lastIndexOf(".")))}throw new Error("unsupported format |"+t+"|")}function na(e,t,r){return(r|0)===r?vs(e,t,r):Dn(e,t,r)}function I6(e){for(var t=[],r=!1,n=0,s=0;n<e.length;++n)switch(e.charCodeAt(n)){case 34:r=!r;break;case 95:case 42:case 92:++n;break;case 59:t[t.length]=e.substr(s,n-s),s=n+1}if(t[t.length]=e.substr(s),r===!0)throw new Error("Format |"+e+"| unterminated string ");return t}var fA=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function kl(e){for(var t=0,r="",n="";t<e.length;)switch(r=e.charAt(t)){case"G":ed(e,t)&&(t+=6),t++;break;case'"':for(;e.charCodeAt(++t)!==34&&t<e.length;);++t;break;case"\\":t+=2;break;case"_":t+=2;break;case"@":++t;break;case"B":case"b":if(e.charAt(t+1)==="1"||e.charAt(t+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(e.substr(t,3).toUpperCase()==="A/P"||e.substr(t,5).toUpperCase()==="AM/PM"||e.substr(t,5).toUpperCase()==="/")return!0;++t;break;case"[":for(n=r;e.charAt(t++)!=="]"&&t<e.length;)n+=e.charAt(t);if(n.match(fA))return!0;break;case".":case"0":case"#":for(;t<e.length&&("0#?.,E+-%".indexOf(r=e.charAt(++t))>-1||r=="\\"&&e.charAt(t+1)=="-"&&"0#".indexOf(e.charAt(t+2))>-1););break;case"?":for(;e.charAt(++t)===r;);break;case"*":++t,(e.charAt(t)==" "||e.charAt(t)=="*")&&++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<e.length&&"0123456789".indexOf(e.charAt(++t))>-1;);break;case" ":++t;break;default:++t;break}return!1}function C6(e,t,r,n){for(var s=[],a="",i=0,o="",l="t",c,u,h,m="H";i<e.length;)switch(o=e.charAt(i)){case"G":if(!ed(e,i))throw new Error("unrecognized character "+o+" in "+e);s[s.length]={t:"G",v:"General"},i+=7;break;case'"':for(a="";(h=e.charCodeAt(++i))!==34&&i<e.length;)a+=String.fromCharCode(h);s[s.length]={t:"t",v:a},++i;break;case"\\":var p=e.charAt(++i),x=p==="("||p===")"?p:"t";s[s.length]={t:x,v:p},++i;break;case"_":s[s.length]={t:"t",v:" "},i+=2;break;case"@":s[s.length]={t:"T",v:t},++i;break;case"B":case"b":if(e.charAt(i+1)==="1"||e.charAt(i+1)==="2"){if(c==null&&(c=bi(t,r,e.charAt(i+1)==="2"),c==null))return"";s[s.length]={t:"X",v:e.substr(i,2)},l=o,i+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":o=o.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0||c==null&&(c=bi(t,r),c==null))return"";for(a=o;++i<e.length&&e.charAt(i).toLowerCase()===o;)a+=o;o==="m"&&l.toLowerCase()==="h"&&(o="M"),o==="h"&&(o=m),s[s.length]={t:o,v:a},l=o;break;case"A":case"a":case"":var v={t:o,v:o};if(c==null&&(c=bi(t,r)),e.substr(i,3).toUpperCase()==="A/P"?(c!=null&&(v.v=c.H>=12?"P":"A"),v.t="T",m="h",i+=3):e.substr(i,5).toUpperCase()==="AM/PM"?(c!=null&&(v.v=c.H>=12?"PM":"AM"),v.t="T",i+=5,m="h"):e.substr(i,5).toUpperCase()==="/"?(c!=null&&(v.v=c.H>=12?"":""),v.t="T",i+=5,m="h"):(v.t="t",++i),c==null&&v.t==="T")return"";s[s.length]=v,l=o;break;case"[":for(a=o;e.charAt(i++)!=="]"&&i<e.length;)a+=e.charAt(i);if(a.slice(-1)!=="]")throw'unterminated "[" block: |'+a+"|";if(a.match(fA)){if(c==null&&(c=bi(t,r),c==null))return"";s[s.length]={t:"Z",v:a.toLowerCase()},l=a.charAt(1)}else a.indexOf("$")>-1&&(a=(a.match(/\$([^-\[\]]*)/)||[])[1]||"$",kl(e)||(s[s.length]={t:"t",v:a}));break;case".":if(c!=null){for(a=o;++i<e.length&&(o=e.charAt(i))==="0";)a+=o;s[s.length]={t:"s",v:a};break}case"0":case"#":for(a=o;++i<e.length&&"0#?.,E+-%".indexOf(o=e.charAt(i))>-1;)a+=o;s[s.length]={t:"n",v:a};break;case"?":for(a=o;e.charAt(++i)===o;)a+=o;s[s.length]={t:o,v:a},l=o;break;case"*":++i,(e.charAt(i)==" "||e.charAt(i)=="*")&&++i;break;case"(":case")":s[s.length]={t:n===1?"t":o,v:o},++i;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(a=o;i<e.length&&"0123456789".indexOf(e.charAt(++i))>-1;)a+=e.charAt(i);s[s.length]={t:"D",v:a};break;case" ":s[s.length]={t:o,v:o},++i;break;case"$":s[s.length]={t:"t",v:"$"},++i;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(o)===-1)throw new Error("unrecognized character "+o+" in "+e);s[s.length]={t:"t",v:o},++i;break}var w=0,k=0,T;for(i=s.length-1,l="t";i>=0;--i)switch(s[i].t){case"h":case"H":s[i].t=m,l="h",w<1&&(w=1);break;case"s":(T=s[i].v.match(/\.0+$/))&&(k=Math.max(k,T[0].length-1)),w<3&&(w=3);case"d":case"y":case"M":case"e":l=s[i].t;break;case"m":l==="s"&&(s[i].t="M",w<2&&(w=2));break;case"X":break;case"Z":w<1&&s[i].v.match(/[Hh]/)&&(w=1),w<2&&s[i].v.match(/[Mm]/)&&(w=2),w<3&&s[i].v.match(/[Ss]/)&&(w=3)}switch(w){case 0:break;case 1:c.u>=.5&&(c.u=0,++c.S),c.S>=60&&(c.S=0,++c.M),c.M>=60&&(c.M=0,++c.H);break;case 2:c.u>=.5&&(c.u=0,++c.S),c.S>=60&&(c.S=0,++c.M);break}var E="",N;for(i=0;i<s.length;++i)switch(s[i].t){case"t":case"T":case" ":case"D":break;case"X":s[i].v="",s[i].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":s[i].v=x6(s[i].t.charCodeAt(0),s[i].v,c,k),s[i].t="t";break;case"n":case"?":for(N=i+1;s[N]!=null&&((o=s[N].t)==="?"||o==="D"||(o===" "||o==="t")&&s[N+1]!=null&&(s[N+1].t==="?"||s[N+1].t==="t"&&s[N+1].v==="/")||s[i].t==="("&&(o===" "||o==="n"||o===")")||o==="t"&&(s[N].v==="/"||s[N].v===" "&&s[N+1]!=null&&s[N+1].t=="?"));)s[i].v+=s[N].v,s[N]={v:"",t:";"},++N;E+=s[i].v,i=N-1;break;case"G":s[i].t="t",s[i].v=qi(t,r);break}var O="",L,g;if(E.length>0){E.charCodeAt(0)==40?(L=t<0&&E.charCodeAt(0)===45?-t:t,g=na("n",E,L)):(L=t<0&&n>1?-t:t,g=na("n",E,L),L<0&&s[0]&&s[0].t=="t"&&(g=g.substr(1),s[0].v="-"+s[0].v)),N=g.length-1;var y=s.length;for(i=0;i<s.length;++i)if(s[i]!=null&&s[i].t!="t"&&s[i].v.indexOf(".")>-1){y=i;break}var S=s.length;if(y===s.length&&g.indexOf("E")===-1){for(i=s.length-1;i>=0;--i)s[i]==null||"n?".indexOf(s[i].t)===-1||(N>=s[i].v.length-1?(N-=s[i].v.length,s[i].v=g.substr(N+1,s[i].v.length)):N<0?s[i].v="":(s[i].v=g.substr(0,N+1),N=-1),s[i].t="t",S=i);N>=0&&S<s.length&&(s[S].v=g.substr(0,N+1)+s[S].v)}else if(y!==s.length&&g.indexOf("E")===-1){for(N=g.indexOf(".")-1,i=y;i>=0;--i)if(!(s[i]==null||"n?".indexOf(s[i].t)===-1)){for(u=s[i].v.indexOf(".")>-1&&i===y?s[i].v.indexOf(".")-1:s[i].v.length-1,O=s[i].v.substr(u+1);u>=0;--u)N>=0&&(s[i].v.charAt(u)==="0"||s[i].v.charAt(u)==="#")&&(O=g.charAt(N--)+O);s[i].v=O,s[i].t="t",S=i}for(N>=0&&S<s.length&&(s[S].v=g.substr(0,N+1)+s[S].v),N=g.indexOf(".")+1,i=y;i<s.length;++i)if(!(s[i]==null||"n?(".indexOf(s[i].t)===-1&&i!==y)){for(u=s[i].v.indexOf(".")>-1&&i===y?s[i].v.indexOf(".")+1:0,O=s[i].v.substr(0,u);u<s[i].v.length;++u)N<g.length&&(O+=g.charAt(N++));s[i].v=O,s[i].t="t",S=i}}}for(i=0;i<s.length;++i)s[i]!=null&&"n?".indexOf(s[i].t)>-1&&(L=n>1&&t<0&&i>0&&s[i-1].v==="-"?-t:t,s[i].v=na(s[i].t,s[i].v,L),s[i].t="t");var R="";for(i=0;i!==s.length;++i)s[i]!=null&&(R+=s[i].v);return R}var rw=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function nw(e,t){if(t==null)return!1;var r=parseFloat(t[2]);switch(t[1]){case"=":if(e==r)return!0;break;case">":if(e>r)return!0;break;case"<":if(e<r)return!0;break;case"<>":if(e!=r)return!0;break;case">=":if(e>=r)return!0;break;case"<=":if(e<=r)return!0;break}return!1}function R6(e,t){var r=I6(e),n=r.length,s=r[n-1].indexOf("@");if(n<4&&s>-1&&--n,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof t!="number")return[4,r.length===4||s>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=s>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=s>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=s>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var a=t>0?r[0]:t<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[n,a];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var i=r[0].match(rw),o=r[1].match(rw);return nw(t,i)?[n,r[0]]:nw(t,o)?[n,r[1]]:[n,r[i!=null&&o!=null?2:1]]}return[n,a]}function $n(e,t,r){r==null&&(r={});var n="";switch(typeof e){case"string":e=="m/d/yy"&&r.dateNF?n=r.dateNF:n=e;break;case"number":e==14&&r.dateNF?n=r.dateNF:n=(r.table!=null?r.table:ze)[e],n==null&&(n=r.table&&r.table[Zy[e]]||ze[Zy[e]]),n==null&&(n=f6[e]||"General");break}if(ed(n,0))return qi(t,r);t instanceof Date&&(t=nA(t,r.date1904));var s=R6(n,t);if(ed(s[1]))return qi(t,r);if(t===!0)t="TRUE";else if(t===!1)t="FALSE";else if(t===""||t==null)return"";return C6(s[1],t,r,s[0])}function Mi(e,t){if(typeof t!="number"){t=+t||-1;for(var r=0;r<392;++r){if(ze[r]==null){t<0&&(t=r);continue}if(ze[r]==e){t=r;break}}t<0&&(t=391)}return ze[t]=e,t}function hA(){ze=u6()}var N6={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},dA=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function b6(e){var t=typeof e=="number"?ze[e]:e;return t=t.replace(dA,"(\\d+)"),new RegExp("^"+t+"$")}function P6(e,t,r){var n=-1,s=-1,a=-1,i=-1,o=-1,l=-1;(t.match(dA)||[]).forEach(function(h,m){var p=parseInt(r[m+1],10);switch(h.toLowerCase().charAt(0)){case"y":n=p;break;case"d":a=p;break;case"h":i=p;break;case"s":l=p;break;case"m":i>=0?o=p:s=p;break}}),l>=0&&o==-1&&s>=0&&(o=s,s=-1);var c=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(s>=1?s:1)).slice(-2)+"-"+("00"+(a>=1?a:1)).slice(-2);c.length==7&&(c="0"+c),c.length==8&&(c="20"+c);var u=("00"+(i>=0?i:0)).slice(-2)+":"+("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(l>=0?l:0)).slice(-2);return i==-1&&o==-1&&l==-1?c:n==-1&&s==-1&&a==-1?u:c+"T"+u}var D6=function(){var e={};e.version="1.2.0";function t(){for(var g=0,y=new Array(256),S=0;S!=256;++S)g=S,g=g&1?-306674912^g>>>1:g>>>1,g=g&1?-306674912^g>>>1:g>>>1,g=g&1?-306674912^g>>>1:g>>>1,g=g&1?-306674912^g>>>1:g>>>1,g=g&1?-306674912^g>>>1:g>>>1,g=g&1?-306674912^g>>>1:g>>>1,g=g&1?-306674912^g>>>1:g>>>1,g=g&1?-306674912^g>>>1:g>>>1,y[S]=g;return typeof Int32Array<"u"?new Int32Array(y):y}var r=t();function n(g){var y=0,S=0,R=0,b=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(R=0;R!=256;++R)b[R]=g[R];for(R=0;R!=256;++R)for(S=g[R],y=256+R;y<4096;y+=256)S=b[y]=S>>>8^g[S&255];var P=[];for(R=1;R!=16;++R)P[R-1]=typeof Int32Array<"u"?b.subarray(R*256,R*256+256):b.slice(R*256,R*256+256);return P}var s=n(r),a=s[0],i=s[1],o=s[2],l=s[3],c=s[4],u=s[5],h=s[6],m=s[7],p=s[8],x=s[9],v=s[10],w=s[11],k=s[12],T=s[13],E=s[14];function N(g,y){for(var S=y^-1,R=0,b=g.length;R<b;)S=S>>>8^r[(S^g.charCodeAt(R++))&255];return~S}function O(g,y){for(var S=y^-1,R=g.length-15,b=0;b<R;)S=E[g[b++]^S&255]^T[g[b++]^S>>8&255]^k[g[b++]^S>>16&255]^w[g[b++]^S>>>24]^v[g[b++]]^x[g[b++]]^p[g[b++]]^m[g[b++]]^h[g[b++]]^u[g[b++]]^c[g[b++]]^l[g[b++]]^o[g[b++]]^i[g[b++]]^a[g[b++]]^r[g[b++]];for(R+=15;b<R;)S=S>>>8^r[(S^g[b++])&255];return~S}function L(g,y){for(var S=y^-1,R=0,b=g.length,P=0,C=0;R<b;)P=g.charCodeAt(R++),P<128?S=S>>>8^r[(S^P)&255]:P<2048?(S=S>>>8^r[(S^(192|P>>6&31))&255],S=S>>>8^r[(S^(128|P&63))&255]):P>=55296&&P<57344?(P=(P&1023)+64,C=g.charCodeAt(R++)&1023,S=S>>>8^r[(S^(240|P>>8&7))&255],S=S>>>8^r[(S^(128|P>>2&63))&255],S=S>>>8^r[(S^(128|C>>6&15|(P&3)<<4))&255],S=S>>>8^r[(S^(128|C&63))&255]):(S=S>>>8^r[(S^(224|P>>12&15))&255],S=S>>>8^r[(S^(128|P>>6&63))&255],S=S>>>8^r[(S^(128|P&63))&255]);return~S}return e.table=r,e.bstr=N,e.buf=O,e.str=L,e}(),tt=function(){var t={};t.version="1.2.1";function r(I,V){for(var D=I.split("/"),F=V.split("/"),M=0,j=0,Y=Math.min(D.length,F.length);M<Y;++M){if(j=D[M].length-F[M].length)return j;if(D[M]!=F[M])return D[M]<F[M]?-1:1}return D.length-F.length}function n(I){if(I.charAt(I.length-1)=="/")return I.slice(0,-1).indexOf("/")===-1?I:n(I.slice(0,-1));var V=I.lastIndexOf("/");return V===-1?I:I.slice(0,V+1)}function s(I){if(I.charAt(I.length-1)=="/")return s(I.slice(0,-1));var V=I.lastIndexOf("/");return V===-1?I:I.slice(V+1)}function a(I,V){typeof V=="string"&&(V=new Date(V));var D=V.getHours();D=D<<6|V.getMinutes(),D=D<<5|V.getSeconds()>>>1,I.write_shift(2,D);var F=V.getFullYear()-1980;F=F<<4|V.getMonth()+1,F=F<<5|V.getDate(),I.write_shift(2,F)}function i(I){var V=I.read_shift(2)&65535,D=I.read_shift(2)&65535,F=new Date,M=D&31;D>>>=5;var j=D&15;D>>>=4,F.setMilliseconds(0),F.setFullYear(D+1980),F.setMonth(j-1),F.setDate(M);var Y=V&31;V>>>=5;var te=V&63;return V>>>=6,F.setHours(V),F.setMinutes(te),F.setSeconds(Y<<1),F}function o(I){xr(I,0);for(var V={},D=0;I.l<=I.length-4;){var F=I.read_shift(2),M=I.read_shift(2),j=I.l+M,Y={};switch(F){case 21589:D=I.read_shift(1),D&1&&(Y.mtime=I.read_shift(4)),M>5&&(D&2&&(Y.atime=I.read_shift(4)),D&4&&(Y.ctime=I.read_shift(4))),Y.mtime&&(Y.mt=new Date(Y.mtime*1e3));break}I.l=j,V[F]=Y}return V}var l;function c(){return l||(l={})}function u(I,V){if(I[0]==80&&I[1]==75)return wa(I,V);if((I[0]|32)==109&&(I[1]|32)==105)return fo(I,V);if(I.length<512)throw new Error("CFB file size "+I.length+" < 512");var D=3,F=512,M=0,j=0,Y=0,te=0,ee=0,Z=[],Q=I.slice(0,512);xr(Q,0);var ue=h(Q);switch(D=ue[0],D){case 3:F=512;break;case 4:F=4096;break;case 0:if(ue[1]==0)return wa(I,V);default:throw new Error("Major Version: Expected 3 or 4 saw "+D)}F!==512&&(Q=I.slice(0,F),xr(Q,28));var we=I.slice(0,F);m(Q,D);var Ie=Q.read_shift(4,"i");if(D===3&&Ie!==0)throw new Error("# Directory Sectors: Expected 0 saw "+Ie);Q.l+=4,Y=Q.read_shift(4,"i"),Q.l+=4,Q.chk("00100000","Mini Stream Cutoff Size: "),te=Q.read_shift(4,"i"),M=Q.read_shift(4,"i"),ee=Q.read_shift(4,"i"),j=Q.read_shift(4,"i");for(var pe=-1,Ee=0;Ee<109&&(pe=Q.read_shift(4,"i"),!(pe<0));++Ee)Z[Ee]=pe;var De=p(I,F);w(ee,j,De,F,Z);var st=T(De,Y,Z,F);st[Y].name="!Directory",M>0&&te!==C&&(st[te].name="!MiniFAT"),st[Z[0]].name="!FAT",st.fat_addrs=Z,st.ssz=F;var Ke={},dt=[],nn=[],We=[];E(Y,st,De,dt,M,Ke,nn,te),x(nn,We,dt),dt.shift();var ft={FileIndex:nn,FullPaths:We};return V&&V.raw&&(ft.raw={header:we,sectors:De}),ft}function h(I){if(I[I.l]==80&&I[I.l+1]==75)return[0,0];I.chk(le,"Header Signature: "),I.l+=16;var V=I.read_shift(2,"u");return[I.read_shift(2,"u"),V]}function m(I,V){var D=9;switch(I.l+=2,D=I.read_shift(2)){case 9:if(V!=3)throw new Error("Sector Shift: Expected 9 saw "+D);break;case 12:if(V!=4)throw new Error("Sector Shift: Expected 12 saw "+D);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+D)}I.chk("0600","Mini Sector Shift: "),I.chk("000000000000","Reserved: ")}function p(I,V){for(var D=Math.ceil(I.length/V)-1,F=[],M=1;M<D;++M)F[M-1]=I.slice(M*V,(M+1)*V);return F[D-1]=I.slice(D*V),F}function x(I,V,D){for(var F=0,M=0,j=0,Y=0,te=0,ee=D.length,Z=[],Q=[];F<ee;++F)Z[F]=Q[F]=F,V[F]=D[F];for(;te<Q.length;++te)F=Q[te],M=I[F].L,j=I[F].R,Y=I[F].C,Z[F]===F&&(M!==-1&&Z[M]!==M&&(Z[F]=Z[M]),j!==-1&&Z[j]!==j&&(Z[F]=Z[j])),Y!==-1&&(Z[Y]=F),M!==-1&&F!=Z[F]&&(Z[M]=Z[F],Q.lastIndexOf(M)<te&&Q.push(M)),j!==-1&&F!=Z[F]&&(Z[j]=Z[F],Q.lastIndexOf(j)<te&&Q.push(j));for(F=1;F<ee;++F)Z[F]===F&&(j!==-1&&Z[j]!==j?Z[F]=Z[j]:M!==-1&&Z[M]!==M&&(Z[F]=Z[M]));for(F=1;F<ee;++F)if(I[F].type!==0){if(te=F,te!=Z[te])do te=Z[te],V[F]=V[te]+"/"+V[F];while(te!==0&&Z[te]!==-1&&te!=Z[te]);Z[F]=-1}for(V[0]+="/",F=1;F<ee;++F)I[F].type!==2&&(V[F]+="/")}function v(I,V,D){for(var F=I.start,M=I.size,j=[],Y=F;D&&M>0&&Y>=0;)j.push(V.slice(Y*P,Y*P+P)),M-=P,Y=ki(D,Y*4);return j.length===0?tr(0):Ma(j).slice(0,I.size)}function w(I,V,D,F,M){var j=C;if(I===C){if(V!==0)throw new Error("DIFAT chain shorter than expected")}else if(I!==-1){var Y=D[I],te=(F>>>2)-1;if(!Y)return;for(var ee=0;ee<te&&(j=ki(Y,ee*4))!==C;++ee)M.push(j);w(ki(Y,F-4),V-1,D,F,M)}}function k(I,V,D,F,M){var j=[],Y=[];M||(M=[]);var te=F-1,ee=0,Z=0;for(ee=V;ee>=0;){M[ee]=!0,j[j.length]=ee,Y.push(I[ee]);var Q=D[Math.floor(ee*4/F)];if(Z=ee*4&te,F<4+Z)throw new Error("FAT boundary crossed: "+ee+" 4 "+F);if(!I[Q])break;ee=ki(I[Q],Z)}return{nodes:j,data:dw([Y])}}function T(I,V,D,F){var M=I.length,j=[],Y=[],te=[],ee=[],Z=F-1,Q=0,ue=0,we=0,Ie=0;for(Q=0;Q<M;++Q)if(te=[],we=Q+V,we>=M&&(we-=M),!Y[we]){ee=[];var pe=[];for(ue=we;ue>=0;){pe[ue]=!0,Y[ue]=!0,te[te.length]=ue,ee.push(I[ue]);var Ee=D[Math.floor(ue*4/F)];if(Ie=ue*4&Z,F<4+Ie)throw new Error("FAT boundary crossed: "+ue+" 4 "+F);if(!I[Ee]||(ue=ki(I[Ee],Ie),pe[ue]))break}j[we]={nodes:te,data:dw([ee])}}return j}function E(I,V,D,F,M,j,Y,te){for(var ee=0,Z=F.length?2:0,Q=V[I].data,ue=0,we=0,Ie;ue<Q.length;ue+=128){var pe=Q.slice(ue,ue+128);xr(pe,64),we=pe.read_shift(2),Ie=tx(pe,0,we-Z),F.push(Ie);var Ee={name:Ie,type:pe.read_shift(1),color:pe.read_shift(1),L:pe.read_shift(4,"i"),R:pe.read_shift(4,"i"),C:pe.read_shift(4,"i"),clsid:pe.read_shift(16),state:pe.read_shift(4,"i"),start:0,size:0},De=pe.read_shift(2)+pe.read_shift(2)+pe.read_shift(2)+pe.read_shift(2);De!==0&&(Ee.ct=N(pe,pe.l-8));var st=pe.read_shift(2)+pe.read_shift(2)+pe.read_shift(2)+pe.read_shift(2);st!==0&&(Ee.mt=N(pe,pe.l-8)),Ee.start=pe.read_shift(4,"i"),Ee.size=pe.read_shift(4,"i"),Ee.size<0&&Ee.start<0&&(Ee.size=Ee.type=0,Ee.start=C,Ee.name=""),Ee.type===5?(ee=Ee.start,M>0&&ee!==C&&(V[ee].name="!StreamData")):Ee.size>=4096?(Ee.storage="fat",V[Ee.start]===void 0&&(V[Ee.start]=k(D,Ee.start,V.fat_addrs,V.ssz)),V[Ee.start].name=Ee.name,Ee.content=V[Ee.start].data.slice(0,Ee.size)):(Ee.storage="minifat",Ee.size<0?Ee.size=0:ee!==C&&Ee.start!==C&&V[ee]&&(Ee.content=v(Ee,V[ee].data,(V[te]||{}).data))),Ee.content&&xr(Ee.content,0),j[Ie]=Ee,Y.push(Ee)}}function N(I,V){return new Date((_n(I,V+4)/1e7*Math.pow(2,32)+_n(I,V)/1e7-11644473600)*1e3)}function O(I,V){return c(),u(l.readFileSync(I),V)}function L(I,V){var D=V&&V.type;switch(D||Qe&&Buffer.isBuffer(I)&&(D="buffer"),D||"base64"){case"file":return O(I,V);case"base64":return u(ts(An(I)),V);case"binary":return u(ts(I),V)}return u(I,V)}function g(I,V){var D=V||{},F=D.root||"Root Entry";if(I.FullPaths||(I.FullPaths=[]),I.FileIndex||(I.FileIndex=[]),I.FullPaths.length!==I.FileIndex.length)throw new Error("inconsistent CFB structure");I.FullPaths.length===0&&(I.FullPaths[0]=F+"/",I.FileIndex[0]={name:F,type:5}),D.CLSID&&(I.FileIndex[0].clsid=D.CLSID),y(I)}function y(I){var V="Sh33tJ5";if(!tt.find(I,"/"+V)){var D=tr(4);D[0]=55,D[1]=D[3]=50,D[2]=54,I.FileIndex.push({name:V,type:2,content:D,size:4,L:69,R:69,C:69}),I.FullPaths.push(I.FullPaths[0]+V),S(I)}}function S(I,V){g(I);for(var D=!1,F=!1,M=I.FullPaths.length-1;M>=0;--M){var j=I.FileIndex[M];switch(j.type){case 0:F?D=!0:(I.FileIndex.pop(),I.FullPaths.pop());break;case 1:case 2:case 5:F=!0,isNaN(j.R*j.L*j.C)&&(D=!0),j.R>-1&&j.L>-1&&j.R==j.L&&(D=!0);break;default:D=!0;break}}if(!(!D&&!V)){var Y=new Date(1987,1,19),te=0,ee=Object.create?Object.create(null):{},Z=[];for(M=0;M<I.FullPaths.length;++M)ee[I.FullPaths[M]]=!0,I.FileIndex[M].type!==0&&Z.push([I.FullPaths[M],I.FileIndex[M]]);for(M=0;M<Z.length;++M){var Q=n(Z[M][0]);F=ee[Q],F||(Z.push([Q,{name:s(Q).replace("/",""),type:1,clsid:he,ct:Y,mt:Y,content:null}]),ee[Q]=!0)}for(Z.sort(function(Ie,pe){return r(Ie[0],pe[0])}),I.FullPaths=[],I.FileIndex=[],M=0;M<Z.length;++M)I.FullPaths[M]=Z[M][0],I.FileIndex[M]=Z[M][1];for(M=0;M<Z.length;++M){var ue=I.FileIndex[M],we=I.FullPaths[M];if(ue.name=s(we).replace("/",""),ue.L=ue.R=ue.C=-(ue.color=1),ue.size=ue.content?ue.content.length:0,ue.start=0,ue.clsid=ue.clsid||he,M===0)ue.C=Z.length>1?1:-1,ue.size=0,ue.type=5;else if(we.slice(-1)=="/"){for(te=M+1;te<Z.length&&n(I.FullPaths[te])!=we;++te);for(ue.C=te>=Z.length?-1:te,te=M+1;te<Z.length&&n(I.FullPaths[te])!=n(we);++te);ue.R=te>=Z.length?-1:te,ue.type=1}else n(I.FullPaths[M+1]||"")==n(we)&&(ue.R=M+1),ue.type=2}}}function R(I,V){var D=V||{};if(D.fileType=="mad")return er(I,D);switch(S(I),D.fileType){case"zip":return Vs(I,D)}var F=function(Ie){for(var pe=0,Ee=0,De=0;De<Ie.FileIndex.length;++De){var st=Ie.FileIndex[De];if(st.content){var Ke=st.content.length;Ke>0&&(Ke<4096?pe+=Ke+63>>6:Ee+=Ke+511>>9)}}for(var dt=Ie.FullPaths.length+3>>2,nn=pe+7>>3,We=pe+127>>7,ft=nn+Ee+dt+We,mr=ft+127>>7,bn=mr<=109?0:Math.ceil((mr-109)/127);ft+mr+bn+127>>7>mr;)bn=++mr<=109?0:Math.ceil((mr-109)/127);var Je=[1,bn,mr,We,dt,Ee,pe,0];return Ie.FileIndex[0].size=pe<<6,Je[7]=(Ie.FileIndex[0].start=Je[0]+Je[1]+Je[2]+Je[3]+Je[4]+Je[5])+(Je[6]+7>>3),Je}(I),M=tr(F[7]<<9),j=0,Y=0;{for(j=0;j<8;++j)M.write_shift(1,se[j]);for(j=0;j<8;++j)M.write_shift(2,0);for(M.write_shift(2,62),M.write_shift(2,3),M.write_shift(2,65534),M.write_shift(2,9),M.write_shift(2,6),j=0;j<3;++j)M.write_shift(2,0);for(M.write_shift(4,0),M.write_shift(4,F[2]),M.write_shift(4,F[0]+F[1]+F[2]+F[3]-1),M.write_shift(4,0),M.write_shift(4,4096),M.write_shift(4,F[3]?F[0]+F[1]+F[2]-1:C),M.write_shift(4,F[3]),M.write_shift(-4,F[1]?F[0]-1:C),M.write_shift(4,F[1]),j=0;j<109;++j)M.write_shift(-4,j<F[2]?F[1]+j:-1)}if(F[1])for(Y=0;Y<F[1];++Y){for(;j<236+Y*127;++j)M.write_shift(-4,j<F[2]?F[1]+j:-1);M.write_shift(-4,Y===F[1]-1?C:Y+1)}var te=function(Ie){for(Y+=Ie;j<Y-1;++j)M.write_shift(-4,j+1);Ie&&(++j,M.write_shift(-4,C))};for(Y=j=0,Y+=F[1];j<Y;++j)M.write_shift(-4,de.DIFSECT);for(Y+=F[2];j<Y;++j)M.write_shift(-4,de.FATSECT);te(F[3]),te(F[4]);for(var ee=0,Z=0,Q=I.FileIndex[0];ee<I.FileIndex.length;++ee)Q=I.FileIndex[ee],Q.content&&(Z=Q.content.length,!(Z<4096)&&(Q.start=Y,te(Z+511>>9)));for(te(F[6]+7>>3);M.l&511;)M.write_shift(-4,de.ENDOFCHAIN);for(Y=j=0,ee=0;ee<I.FileIndex.length;++ee)Q=I.FileIndex[ee],Q.content&&(Z=Q.content.length,!(!Z||Z>=4096)&&(Q.start=Y,te(Z+63>>6)));for(;M.l&511;)M.write_shift(-4,de.ENDOFCHAIN);for(j=0;j<F[4]<<2;++j){var ue=I.FullPaths[j];if(!ue||ue.length===0){for(ee=0;ee<17;++ee)M.write_shift(4,0);for(ee=0;ee<3;++ee)M.write_shift(4,-1);for(ee=0;ee<12;++ee)M.write_shift(4,0);continue}Q=I.FileIndex[j],j===0&&(Q.start=Q.size?Q.start-1:C);var we=j===0&&D.root||Q.name;if(Z=2*(we.length+1),M.write_shift(64,we,"utf16le"),M.write_shift(2,Z),M.write_shift(1,Q.type),M.write_shift(1,Q.color),M.write_shift(-4,Q.L),M.write_shift(-4,Q.R),M.write_shift(-4,Q.C),Q.clsid)M.write_shift(16,Q.clsid,"hex");else for(ee=0;ee<4;++ee)M.write_shift(4,0);M.write_shift(4,Q.state||0),M.write_shift(4,0),M.write_shift(4,0),M.write_shift(4,0),M.write_shift(4,0),M.write_shift(4,Q.start),M.write_shift(4,Q.size),M.write_shift(4,0)}for(j=1;j<I.FileIndex.length;++j)if(Q=I.FileIndex[j],Q.size>=4096)if(M.l=Q.start+1<<9,Qe&&Buffer.isBuffer(Q.content))Q.content.copy(M,M.l,0,Q.size),M.l+=Q.size+511&-512;else{for(ee=0;ee<Q.size;++ee)M.write_shift(1,Q.content[ee]);for(;ee&511;++ee)M.write_shift(1,0)}for(j=1;j<I.FileIndex.length;++j)if(Q=I.FileIndex[j],Q.size>0&&Q.size<4096)if(Qe&&Buffer.isBuffer(Q.content))Q.content.copy(M,M.l,0,Q.size),M.l+=Q.size+63&-64;else{for(ee=0;ee<Q.size;++ee)M.write_shift(1,Q.content[ee]);for(;ee&63;++ee)M.write_shift(1,0)}if(Qe)M.l=M.length;else for(;M.l<M.length;)M.write_shift(1,0);return M}function b(I,V){var D=I.FullPaths.map(function(ee){return ee.toUpperCase()}),F=D.map(function(ee){var Z=ee.split("/");return Z[Z.length-(ee.slice(-1)=="/"?2:1)]}),M=!1;V.charCodeAt(0)===47?(M=!0,V=D[0].slice(0,-1)+V):M=V.indexOf("/")!==-1;var j=V.toUpperCase(),Y=M===!0?D.indexOf(j):F.indexOf(j);if(Y!==-1)return I.FileIndex[Y];var te=!j.match(sc);for(j=j.replace(Qr,""),te&&(j=j.replace(sc,"!")),Y=0;Y<D.length;++Y)if((te?D[Y].replace(sc,"!"):D[Y]).replace(Qr,"")==j||(te?F[Y].replace(sc,"!"):F[Y]).replace(Qr,"")==j)return I.FileIndex[Y];return null}var P=64,C=-2,le="d0cf11e0a1b11ae1",se=[208,207,17,224,161,177,26,225],he="00000000000000000000000000000000",de={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:C,FREESECT:-1,HEADER_SIGNATURE:le,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:he,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function ie(I,V,D){c();var F=R(I,D);l.writeFileSync(V,F)}function H(I){for(var V=new Array(I.length),D=0;D<I.length;++D)V[D]=String.fromCharCode(I[D]);return V.join("")}function ce(I,V){var D=R(I,V);switch(V&&V.type||"buffer"){case"file":return c(),l.writeFileSync(V.filename,D),D;case"binary":return typeof D=="string"?D:H(D);case"base64":return Xy(typeof D=="string"?D:H(D));case"buffer":if(Qe)return Buffer.isBuffer(D)?D:no(D);case"array":return typeof D=="string"?ts(D):D}return D}var ve;function B(I){try{var V=I.InflateRaw,D=new V;if(D._processChunk(new Uint8Array([3,0]),D._finishFlushFlag),D.bytesRead)ve=I;else throw new Error("zlib does not expose bytesRead")}catch(F){console.error("cannot use native zlib: "+(F.message||F))}}function K(I,V){if(!ve)return js(I,V);var D=ve.InflateRaw,F=new D,M=F._processChunk(I.slice(I.l),F._finishFlushFlag);return I.l+=F.bytesRead,M}function q(I){return ve?ve.deflateRawSync(I):je(I)}var G=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],oe=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],xe=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function Ce(I){var V=(I<<1|I<<11)&139536|(I<<5|I<<15)&558144;return(V>>16|V>>8|V)&255}for(var Te=typeof Uint8Array<"u",_e=Te?new Uint8Array(256):[],$e=0;$e<256;++$e)_e[$e]=Ce($e);function z(I,V){var D=_e[I&255];return V<=8?D>>>8-V:(D=D<<8|_e[I>>8&255],V<=16?D>>>16-V:(D=D<<8|_e[I>>16&255],D>>>24-V))}function ot(I,V){var D=V&7,F=V>>>3;return(I[F]|(D<=6?0:I[F+1]<<8))>>>D&3}function He(I,V){var D=V&7,F=V>>>3;return(I[F]|(D<=5?0:I[F+1]<<8))>>>D&7}function nt(I,V){var D=V&7,F=V>>>3;return(I[F]|(D<=4?0:I[F+1]<<8))>>>D&15}function Fe(I,V){var D=V&7,F=V>>>3;return(I[F]|(D<=3?0:I[F+1]<<8))>>>D&31}function Ae(I,V){var D=V&7,F=V>>>3;return(I[F]|(D<=1?0:I[F+1]<<8))>>>D&127}function Tt(I,V,D){var F=V&7,M=V>>>3,j=(1<<D)-1,Y=I[M]>>>F;return D<8-F||(Y|=I[M+1]<<8-F,D<16-F)||(Y|=I[M+2]<<16-F,D<24-F)||(Y|=I[M+3]<<24-F),Y&j}function or(I,V,D){var F=V&7,M=V>>>3;return F<=5?I[M]|=(D&7)<<F:(I[M]|=D<<F&255,I[M+1]=(D&7)>>8-F),V+3}function Ar(I,V,D){var F=V&7,M=V>>>3;return D=(D&1)<<F,I[M]|=D,V+1}function tn(I,V,D){var F=V&7,M=V>>>3;return D<<=F,I[M]|=D&255,D>>>=8,I[M+1]=D,V+8}function Ms(I,V,D){var F=V&7,M=V>>>3;return D<<=F,I[M]|=D&255,D>>>=8,I[M+1]=D&255,I[M+2]=D>>>8,V+16}function rn(I,V){var D=I.length,F=2*D>V?2*D:V+5,M=0;if(D>=V)return I;if(Qe){var j=Yy(F);if(I.copy)I.copy(j);else for(;M<I.length;++M)j[M]=I[M];return j}else if(Te){var Y=new Uint8Array(F);if(Y.set)Y.set(I);else for(;M<D;++M)Y[M]=I[M];return Y}return I.length=F,I}function kt(I){for(var V=new Array(I),D=0;D<I;++D)V[D]=0;return V}function lr(I,V,D){var F=1,M=0,j=0,Y=0,te=0,ee=I.length,Z=Te?new Uint16Array(32):kt(32);for(j=0;j<32;++j)Z[j]=0;for(j=ee;j<D;++j)I[j]=0;ee=I.length;var Q=Te?new Uint16Array(ee):kt(ee);for(j=0;j<ee;++j)Z[M=I[j]]++,F<M&&(F=M),Q[j]=0;for(Z[0]=0,j=1;j<=F;++j)Z[j+16]=te=te+Z[j-1]<<1;for(j=0;j<ee;++j)te=I[j],te!=0&&(Q[j]=Z[te+16]++);var ue=0;for(j=0;j<ee;++j)if(ue=I[j],ue!=0)for(te=z(Q[j],F)>>F-ue,Y=(1<<F+4-ue)-1;Y>=0;--Y)V[te|Y<<ue]=ue&15|j<<4;return F}var vt=Te?new Uint16Array(512):kt(512),St=Te?new Uint16Array(32):kt(32);if(!Te){for(var ht=0;ht<512;++ht)vt[ht]=0;for(ht=0;ht<32;++ht)St[ht]=0}(function(){for(var I=[],V=0;V<32;V++)I.push(5);lr(I,St,32);var D=[];for(V=0;V<=143;V++)D.push(8);for(;V<=255;V++)D.push(9);for(;V<=279;V++)D.push(7);for(;V<=287;V++)D.push(8);lr(D,vt,288)})();var Dt=function(){for(var V=Te?new Uint8Array(32768):[],D=0,F=0;D<xe.length-1;++D)for(;F<xe[D+1];++F)V[F]=D;for(;F<32768;++F)V[F]=29;var M=Te?new Uint8Array(259):[];for(D=0,F=0;D<oe.length-1;++D)for(;F<oe[D+1];++F)M[F]=D;function j(te,ee){for(var Z=0;Z<te.length;){var Q=Math.min(65535,te.length-Z),ue=Z+Q==te.length;for(ee.write_shift(1,+ue),ee.write_shift(2,Q),ee.write_shift(2,~Q&65535);Q-- >0;)ee[ee.l++]=te[Z++]}return ee.l}function Y(te,ee){for(var Z=0,Q=0,ue=Te?new Uint16Array(32768):[];Q<te.length;){var we=Math.min(65535,te.length-Q);if(we<10){for(Z=or(ee,Z,+(Q+we==te.length)),Z&7&&(Z+=8-(Z&7)),ee.l=Z/8|0,ee.write_shift(2,we),ee.write_shift(2,~we&65535);we-- >0;)ee[ee.l++]=te[Q++];Z=ee.l*8;continue}Z=or(ee,Z,+(Q+we==te.length)+2);for(var Ie=0;we-- >0;){var pe=te[Q];Ie=(Ie<<5^pe)&32767;var Ee=-1,De=0;if((Ee=ue[Ie])&&(Ee|=Q&-32768,Ee>Q&&(Ee-=32768),Ee<Q))for(;te[Ee+De]==te[Q+De]&&De<250;)++De;if(De>2){pe=M[De],pe<=22?Z=tn(ee,Z,_e[pe+1]>>1)-1:(tn(ee,Z,3),Z+=5,tn(ee,Z,_e[pe-23]>>5),Z+=3);var st=pe<8?0:pe-4>>2;st>0&&(Ms(ee,Z,De-oe[pe]),Z+=st),pe=V[Q-Ee],Z=tn(ee,Z,_e[pe]>>3),Z-=3;var Ke=pe<4?0:pe-2>>1;Ke>0&&(Ms(ee,Z,Q-Ee-xe[pe]),Z+=Ke);for(var dt=0;dt<De;++dt)ue[Ie]=Q&32767,Ie=(Ie<<5^te[Q])&32767,++Q;we-=De-1}else pe<=143?pe=pe+48:Z=Ar(ee,Z,1),Z=tn(ee,Z,_e[pe]),ue[Ie]=Q&32767,++Q}Z=tn(ee,Z,0)-1}return ee.l=(Z+7)/8|0,ee.l}return function(ee,Z){return ee.length<8?j(ee,Z):Y(ee,Z)}}();function je(I){var V=tr(50+Math.floor(I.length*1.1)),D=Dt(I,V);return V.slice(0,D)}var xt=Te?new Uint16Array(32768):kt(32768),Gt=Te?new Uint16Array(32768):kt(32768),ut=Te?new Uint16Array(128):kt(128),pn=1,Ls=1;function co(I,V){var D=Fe(I,V)+257;V+=5;var F=Fe(I,V)+1;V+=5;var M=nt(I,V)+4;V+=4;for(var j=0,Y=Te?new Uint8Array(19):kt(19),te=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],ee=1,Z=Te?new Uint8Array(8):kt(8),Q=Te?new Uint8Array(8):kt(8),ue=Y.length,we=0;we<M;++we)Y[G[we]]=j=He(I,V),ee<j&&(ee=j),Z[j]++,V+=3;var Ie=0;for(Z[0]=0,we=1;we<=ee;++we)Q[we]=Ie=Ie+Z[we-1]<<1;for(we=0;we<ue;++we)(Ie=Y[we])!=0&&(te[we]=Q[Ie]++);var pe=0;for(we=0;we<ue;++we)if(pe=Y[we],pe!=0){Ie=_e[te[we]]>>8-pe;for(var Ee=(1<<7-pe)-1;Ee>=0;--Ee)ut[Ie|Ee<<pe]=pe&7|we<<3}var De=[];for(ee=1;De.length<D+F;)switch(Ie=ut[Ae(I,V)],V+=Ie&7,Ie>>>=3){case 16:for(j=3+ot(I,V),V+=2,Ie=De[De.length-1];j-- >0;)De.push(Ie);break;case 17:for(j=3+He(I,V),V+=3;j-- >0;)De.push(0);break;case 18:for(j=11+Ae(I,V),V+=7;j-- >0;)De.push(0);break;default:De.push(Ie),ee<Ie&&(ee=Ie);break}var st=De.slice(0,D),Ke=De.slice(D);for(we=D;we<286;++we)st[we]=0;for(we=F;we<30;++we)Ke[we]=0;return pn=lr(st,xt,286),Ls=lr(Ke,Gt,30),V}function Il(I,V){if(I[0]==3&&!(I[1]&3))return[li(V),2];for(var D=0,F=0,M=Yy(V||1<<18),j=0,Y=M.length>>>0,te=0,ee=0;!(F&1);){if(F=He(I,D),D+=3,F>>>1)F>>1==1?(te=9,ee=5):(D=co(I,D),te=pn,ee=Ls);else{D&7&&(D+=8-(D&7));var Z=I[D>>>3]|I[(D>>>3)+1]<<8;if(D+=32,Z>0)for(!V&&Y<j+Z&&(M=rn(M,j+Z),Y=M.length);Z-- >0;)M[j++]=I[D>>>3],D+=8;continue}for(;;){!V&&Y<j+32767&&(M=rn(M,j+32767),Y=M.length);var Q=Tt(I,D,te),ue=F>>>1==1?vt[Q]:xt[Q];if(D+=ue&15,ue>>>=4,!(ue>>>8&255))M[j++]=ue;else{if(ue==256)break;ue-=257;var we=ue<8?0:ue-4>>2;we>5&&(we=0);var Ie=j+oe[ue];we>0&&(Ie+=Tt(I,D,we),D+=we),Q=Tt(I,D,ee),ue=F>>>1==1?St[Q]:Gt[Q],D+=ue&15,ue>>>=4;var pe=ue<4?0:ue-2>>1,Ee=xe[ue];for(pe>0&&(Ee+=Tt(I,D,pe),D+=pe),!V&&Y<Ie&&(M=rn(M,Ie+100),Y=M.length);j<Ie;)M[j]=M[j-Ee],++j}}}return V?[M,D+7>>>3]:[M.slice(0,j),D+7>>>3]}function js(I,V){var D=I.slice(I.l||0),F=Il(D,V);return I.l+=F[1],F[0]}function hs(I,V){if(I)typeof console<"u"&&console.error(V);else throw new Error(V)}function wa(I,V){var D=I;xr(D,0);var F=[],M=[],j={FileIndex:F,FullPaths:M};g(j,{root:V.root});for(var Y=D.length-4;(D[Y]!=80||D[Y+1]!=75||D[Y+2]!=5||D[Y+3]!=6)&&Y>=0;)--Y;D.l=Y+4,D.l+=4;var te=D.read_shift(2);D.l+=6;var ee=D.read_shift(4);for(D.l=ee,Y=0;Y<te;++Y){D.l+=20;var Z=D.read_shift(4),Q=D.read_shift(4),ue=D.read_shift(2),we=D.read_shift(2),Ie=D.read_shift(2);D.l+=8;var pe=D.read_shift(4),Ee=o(D.slice(D.l+ue,D.l+ue+we));D.l+=ue+we+Ie;var De=D.l;D.l=pe+4,Hn(D,Z,Q,j,Ee),D.l=De}return j}function Hn(I,V,D,F,M){I.l+=2;var j=I.read_shift(2),Y=I.read_shift(2),te=i(I);if(j&8257)throw new Error("Unsupported ZIP encryption");for(var ee=I.read_shift(4),Z=I.read_shift(4),Q=I.read_shift(4),ue=I.read_shift(2),we=I.read_shift(2),Ie="",pe=0;pe<ue;++pe)Ie+=String.fromCharCode(I[I.l++]);if(we){var Ee=o(I.slice(I.l,I.l+we));(Ee[21589]||{}).mt&&(te=Ee[21589].mt),((M||{})[21589]||{}).mt&&(te=M[21589].mt)}I.l+=we;var De=I.slice(I.l,I.l+Z);switch(Y){case 8:De=K(I,Q);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+Y)}var st=!1;j&8&&(ee=I.read_shift(4),ee==134695760&&(ee=I.read_shift(4),st=!0),Z=I.read_shift(4),Q=I.read_shift(4)),Z!=V&&hs(st,"Bad compressed size: "+V+" != "+Z),Q!=D&&hs(st,"Bad uncompressed size: "+D+" != "+Q),J(F,Ie,De,{unsafe:!0,mt:te})}function Vs(I,V){var D=V||{},F=[],M=[],j=tr(1),Y=D.compression?8:0,te=0,ee=0,Z=0,Q=0,ue=0,we=I.FullPaths[0],Ie=we,pe=I.FileIndex[0],Ee=[],De=0;for(ee=1;ee<I.FullPaths.length;++ee)if(Ie=I.FullPaths[ee].slice(we.length),pe=I.FileIndex[ee],!(!pe.size||!pe.content||Ie=="Sh33tJ5")){var st=Q,Ke=tr(Ie.length);for(Z=0;Z<Ie.length;++Z)Ke.write_shift(1,Ie.charCodeAt(Z)&127);Ke=Ke.slice(0,Ke.l),Ee[ue]=D6.buf(pe.content,0);var dt=pe.content;Y==8&&(dt=q(dt)),j=tr(30),j.write_shift(4,67324752),j.write_shift(2,20),j.write_shift(2,te),j.write_shift(2,Y),pe.mt?a(j,pe.mt):j.write_shift(4,0),j.write_shift(-4,Ee[ue]),j.write_shift(4,dt.length),j.write_shift(4,pe.content.length),j.write_shift(2,Ke.length),j.write_shift(2,0),Q+=j.length,F.push(j),Q+=Ke.length,F.push(Ke),Q+=dt.length,F.push(dt),j=tr(46),j.write_shift(4,33639248),j.write_shift(2,0),j.write_shift(2,20),j.write_shift(2,te),j.write_shift(2,Y),j.write_shift(4,0),j.write_shift(-4,Ee[ue]),j.write_shift(4,dt.length),j.write_shift(4,pe.content.length),j.write_shift(2,Ke.length),j.write_shift(2,0),j.write_shift(2,0),j.write_shift(2,0),j.write_shift(2,0),j.write_shift(4,0),j.write_shift(4,st),De+=j.l,M.push(j),De+=Ke.length,M.push(Ke),++ue}return j=tr(22),j.write_shift(4,101010256),j.write_shift(2,0),j.write_shift(2,0),j.write_shift(2,ue),j.write_shift(2,ue),j.write_shift(4,De),j.write_shift(4,Q),j.write_shift(2,0),Ma([Ma(F),Ma(M),j])}var ds={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function Rn(I,V){if(I.ctype)return I.ctype;var D=I.name||"",F=D.match(/\.([^\.]+)$/);return F&&ds[F[1]]||V&&(F=(D=V).match(/[\.\\]([^\.\\])+$/),F&&ds[F[1]])?ds[F[1]]:"application/octet-stream"}function uo(I){for(var V=Xy(I),D=[],F=0;F<V.length;F+=76)D.push(V.slice(F,F+76));return D.join(`\r
`)+`\r
`}function Us(I){var V=I.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(Z){var Q=Z.charCodeAt(0).toString(16).toUpperCase();return"="+(Q.length==1?"0"+Q:Q)});V=V.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),V.charAt(0)==`
`&&(V="=0D"+V.slice(1)),V=V.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var D=[],F=V.split(`\r
`),M=0;M<F.length;++M){var j=F[M];if(j.length==0){D.push("");continue}for(var Y=0;Y<j.length;){var te=76,ee=j.slice(Y,Y+te);ee.charAt(te-1)=="="?te--:ee.charAt(te-2)=="="?te-=2:ee.charAt(te-3)=="="&&(te-=3),ee=j.slice(Y,Y+te),Y+=te,Y<j.length&&(ee+="="),D.push(ee)}}return D.join(`\r
`)}function Bs(I){for(var V=[],D=0;D<I.length;++D){for(var F=I[D];D<=I.length&&F.charAt(F.length-1)=="=";)F=F.slice(0,F.length-1)+I[++D];V.push(F)}for(var M=0;M<V.length;++M)V[M]=V[M].replace(/[=][0-9A-Fa-f]{2}/g,function(j){return String.fromCharCode(parseInt(j.slice(1),16))});return ts(V.join(`\r
`))}function Nn(I,V,D){for(var F="",M="",j="",Y,te=0;te<10;++te){var ee=V[te];if(!ee||ee.match(/^\s*$/))break;var Z=ee.match(/^(.*?):\s*([^\s].*)$/);if(Z)switch(Z[1].toLowerCase()){case"content-location":F=Z[2].trim();break;case"content-type":j=Z[2].trim();break;case"content-transfer-encoding":M=Z[2].trim();break}}switch(++te,M.toLowerCase()){case"base64":Y=ts(An(V.slice(te).join("")));break;case"quoted-printable":Y=Bs(V.slice(te));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+M)}var Q=J(I,F.slice(D.length),Y,{unsafe:!0});j&&(Q.ctype=j)}function fo(I,V){if(H(I.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var D=V&&V.root||"",F=(Qe&&Buffer.isBuffer(I)?I.toString("binary"):H(I)).split(`\r
`),M=0,j="";for(M=0;M<F.length;++M)if(j=F[M],!!/^Content-Location:/i.test(j)&&(j=j.slice(j.indexOf("file")),D||(D=j.slice(0,j.lastIndexOf("/")+1)),j.slice(0,D.length)!=D))for(;D.length>0&&(D=D.slice(0,D.length-1),D=D.slice(0,D.lastIndexOf("/")+1),j.slice(0,D.length)!=D););var Y=(F[1]||"").match(/boundary="(.*?)"/);if(!Y)throw new Error("MAD cannot find boundary");var te="--"+(Y[1]||""),ee=[],Z=[],Q={FileIndex:ee,FullPaths:Z};g(Q);var ue,we=0;for(M=0;M<F.length;++M){var Ie=F[M];Ie!==te&&Ie!==te+"--"||(we++&&Nn(Q,F.slice(ue,M),D),ue=M)}return Q}function er(I,V){var D=V||{},F=D.boundary||"SheetJS";F="------="+F;for(var M=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+F.slice(2)+'"',"","",""],j=I.FullPaths[0],Y=j,te=I.FileIndex[0],ee=1;ee<I.FullPaths.length;++ee)if(Y=I.FullPaths[ee].slice(j.length),te=I.FileIndex[ee],!(!te.size||!te.content||Y=="Sh33tJ5")){Y=Y.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(De){return"_x"+De.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(De){return"_u"+De.charCodeAt(0).toString(16)+"_"});for(var Z=te.content,Q=Qe&&Buffer.isBuffer(Z)?Z.toString("binary"):H(Z),ue=0,we=Math.min(1024,Q.length),Ie=0,pe=0;pe<=we;++pe)(Ie=Q.charCodeAt(pe))>=32&&Ie<128&&++ue;var Ee=ue>=we*4/5;M.push(F),M.push("Content-Location: "+(D.root||"file:///C:/SheetJS/")+Y),M.push("Content-Transfer-Encoding: "+(Ee?"quoted-printable":"base64")),M.push("Content-Type: "+Rn(te,Y)),M.push(""),M.push(Ee?Us(Q):uo(Q))}return M.push(F+`--\r
`),M.join(`\r
`)}function X(I){var V={};return g(V,I),V}function J(I,V,D,F){var M=F&&F.unsafe;M||g(I);var j=!M&&tt.find(I,V);if(!j){var Y=I.FullPaths[0];V.slice(0,Y.length)==Y?Y=V:(Y.slice(-1)!="/"&&(Y+="/"),Y=(Y+V).replace("//","/")),j={name:s(V),type:2},I.FileIndex.push(j),I.FullPaths.push(Y),M||tt.utils.cfb_gc(I)}return j.content=D,j.size=D?D.length:0,F&&(F.CLSID&&(j.clsid=F.CLSID),F.mt&&(j.mt=F.mt),F.ct&&(j.ct=F.ct)),j}function ne(I,V){g(I);var D=tt.find(I,V);if(D){for(var F=0;F<I.FileIndex.length;++F)if(I.FileIndex[F]==D)return I.FileIndex.splice(F,1),I.FullPaths.splice(F,1),!0}return!1}function me(I,V,D){g(I);var F=tt.find(I,V);if(F){for(var M=0;M<I.FileIndex.length;++M)if(I.FileIndex[M]==F)return I.FileIndex[M].name=s(D),I.FullPaths[M]=D,!0}return!1}function Se(I){S(I,!0)}return t.find=b,t.read=L,t.parse=u,t.write=ce,t.writeFile=ie,t.utils={cfb_new:X,cfb_add:J,cfb_del:ne,cfb_mov:me,cfb_gc:Se,ReadShift:Ec,CheckField:OA,prep_blob:xr,bconcat:Ma,use_zlib:B,_deflateRaw:je,_inflateRaw:js,consts:de},t}();function F6(e){if(typeof Deno<"u")return Deno.readFileSync(e);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var t=File(e);t.open("r"),t.encoding="binary";var r=t.read();return t.close(),r}catch(n){if(!n.message||!n.message.match(/onstruct/))throw n}throw new Error("Cannot access file "+e)}function Ns(e){for(var t=Object.keys(e),r=[],n=0;n<t.length;++n)Object.prototype.hasOwnProperty.call(e,t[n])&&r.push(t[n]);return r}function Qv(e){for(var t=[],r=Ns(e),n=0;n!==r.length;++n)t[e[r[n]]]=r[n];return t}var rd=new Date(1899,11,30,0,0,0);function Jr(e,t){var r=e.getTime(),n=rd.getTime()+(e.getTimezoneOffset()-rd.getTimezoneOffset())*6e4;return(r-n)/(24*60*60*1e3)}var mA=new Date,O6=rd.getTime()+(mA.getTimezoneOffset()-rd.getTimezoneOffset())*6e4,sw=mA.getTimezoneOffset();function t0(e){var t=new Date;return t.setTime(e*24*60*60*1e3+O6),t.getTimezoneOffset()!==sw&&t.setTime(t.getTime()+(t.getTimezoneOffset()-sw)*6e4),t}function M6(e){var t=0,r=0,n=!1,s=e.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!s)throw new Error("|"+e+"| is not an ISO8601 Duration");for(var a=1;a!=s.length;++a)if(s[a]){switch(r=1,a>3&&(n=!0),s[a].slice(s[a].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+s[a].slice(s[a].length-1));case"D":r*=24;case"H":r*=60;case"M":if(n)r*=60;else throw new Error("Unsupported ISO Duration Field: M")}t+=r*parseInt(s[a],10)}return t}var aw=new Date("2017-02-19T19:06:09.000Z"),pA=isNaN(aw.getFullYear())?new Date("2/19/17"):aw,L6=pA.getFullYear()==2017;function dr(e,t){var r=new Date(e);if(L6)return t>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):t<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(e instanceof Date)return e;if(pA.getFullYear()==1917&&!isNaN(r.getFullYear())){var n=r.getFullYear();return e.indexOf(""+n)>-1||r.setFullYear(r.getFullYear()+100),r}var s=e.match(/\d+/g)||["2017","2","19","0","0","0"],a=new Date(+s[0],+s[1]-1,+s[2],+s[3]||0,+s[4]||0,+s[5]||0);return e.indexOf("Z")>-1&&(a=new Date(a.getTime()-a.getTimezoneOffset()*60*1e3)),a}function Xi(e,t){if(Qe&&Buffer.isBuffer(e)){if(t){if(e[0]==255&&e[1]==254)return ic(e.slice(2).toString("utf16le"));if(e[1]==254&&e[2]==255)return ic(tA(e.slice(2).toString("binary")))}return e.toString("binary")}if(typeof TextDecoder<"u")try{if(t){if(e[0]==255&&e[1]==254)return ic(new TextDecoder("utf-16le").decode(e.slice(2)));if(e[0]==254&&e[1]==255)return ic(new TextDecoder("utf-16be").decode(e.slice(2)))}var r={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[]/g,function(a){return r[a]||a})}catch{}for(var n=[],s=0;s!=e.length;++s)n.push(String.fromCharCode(e[s]));return n.join("")}function Er(e){if(typeof JSON<"u"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=Er(e[r]));return t}function Ut(e,t){for(var r="";r.length<t;)r+=e;return r}function ls(e){var t=Number(e);if(!isNaN(t))return isFinite(t)?t:NaN;if(!/\d/.test(e))return t;var r=1,n=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(t=Number(n))||(n=n.replace(/[(](.*)[)]/,function(s,a){return r=-r,a}),!isNaN(t=Number(n)))?t/r:t}var j6=["january","february","march","april","may","june","july","august","september","october","november","december"];function ml(e){var t=new Date(e),r=new Date(NaN),n=t.getYear(),s=t.getMonth(),a=t.getDate();if(isNaN(a))return r;var i=e.toLowerCase();if(i.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(i=i.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),i.length>3&&j6.indexOf(i)==-1)return r}else if(i.match(/[a-z]/))return r;return n<0||n>8099?r:(s>0||a>1)&&n!=101?t:e.match(/[^-0-9:,\/\\]/)?r:t}var V6=function(){var e="abacaba".split(/(:?b)/i).length==5;return function(r,n,s){if(e||typeof n=="string")return r.split(n);for(var a=r.split(n),i=[a[0]],o=1;o<a.length;++o)i.push(s),i.push(a[o]);return i}}();function gA(e){return e?e.content&&e.type?Xi(e.content,!0):e.data?nc(e.data):e.asNodeBuffer&&Qe?nc(e.asNodeBuffer().toString("binary")):e.asBinary?nc(e.asBinary()):e._data&&e._data.getContent?nc(Xi(Array.prototype.slice.call(e._data.getContent(),0))):null:null}function vA(e){if(!e)return null;if(e.data)return Ky(e.data);if(e.asNodeBuffer&&Qe)return e.asNodeBuffer();if(e._data&&e._data.getContent){var t=e._data.getContent();return typeof t=="string"?Ky(t):Array.prototype.slice.call(t)}return e.content&&e.type?e.content:null}function U6(e){return e&&e.name.slice(-4)===".bin"?vA(e):gA(e)}function Fn(e,t){for(var r=e.FullPaths||Ns(e.files),n=t.toLowerCase().replace(/[\/]/g,"\\"),s=n.replace(/\\/g,"/"),a=0;a<r.length;++a){var i=r[a].replace(/^Root Entry[\/]/,"").toLowerCase();if(n==i||s==i)return e.files?e.files[r[a]]:e.FileIndex[a]}return null}function Jv(e,t){var r=Fn(e,t);if(r==null)throw new Error("Cannot find file "+t+" in zip");return r}function Xt(e,t,r){if(!r)return U6(Jv(e,t));if(!t)return null;try{return Xt(e,t)}catch{return null}}function yn(e,t,r){if(!r)return gA(Jv(e,t));if(!t)return null;try{return yn(e,t)}catch{return null}}function B6(e,t,r){return vA(Jv(e,t))}function iw(e){for(var t=e.FullPaths||Ns(e.files),r=[],n=0;n<t.length;++n)t[n].slice(-1)!="/"&&r.push(t[n].replace(/^Root Entry[\/]/,""));return r.sort()}function z6(e,t,r){if(e.FullPaths){if(typeof r=="string"){var n;return Qe?n=no(r):n=o6(r),tt.utils.cfb_add(e,t,n)}tt.utils.cfb_add(e,t,r)}else e.file(t,r)}function xA(e,t){switch(t.type){case"base64":return tt.read(e,{type:"base64"});case"binary":return tt.read(e,{type:"binary"});case"buffer":case"array":return tt.read(e,{type:"buffer"})}throw new Error("Unrecognized type "+t.type)}function ac(e,t){if(e.charAt(0)=="/")return e.slice(1);var r=t.split("/");t.slice(-1)!="/"&&r.pop();for(var n=e.split("/");n.length!==0;){var s=n.shift();s===".."?r.pop():s!=="."&&r.push(s)}return r.join("/")}var _A=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,$6=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,ow=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,W6=/<[^>]*>/g,Wr=_A.match(ow)?ow:W6,H6=/<\w*:/,G6=/<(\/?)\w+:/;function Oe(e,t,r){for(var n={},s=0,a=0;s!==e.length&&!((a=e.charCodeAt(s))===32||a===10||a===13);++s);if(t||(n[0]=e.slice(0,s)),s===e.length)return n;var i=e.match($6),o=0,l="",c=0,u="",h="",m=1;if(i)for(c=0;c!=i.length;++c){for(h=i[c],a=0;a!=h.length&&h.charCodeAt(a)!==61;++a);for(u=h.slice(0,a).trim();h.charCodeAt(a+1)==32;)++a;for(m=(s=h.charCodeAt(a+1))==34||s==39?1:0,l=h.slice(a+1+m,h.length-m),o=0;o!=u.length&&u.charCodeAt(o)!==58;++o);if(o===u.length)u.indexOf("_")>0&&(u=u.slice(0,u.indexOf("_"))),n[u]=l,n[u.toLowerCase()]=l;else{var p=(o===5&&u.slice(0,5)==="xmlns"?"xmlns":"")+u.slice(o+1);if(n[p]&&u.slice(o-3,o)=="ext")continue;n[p]=l,n[p.toLowerCase()]=l}}return n}function Fs(e){return e.replace(G6,"<$1")}var yA={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},K6=Qv(yA),it=function(){var e=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,t=/_x([\da-fA-F]{4})_/ig;return function r(n){var s=n+"",a=s.indexOf("<![CDATA[");if(a==-1)return s.replace(e,function(o,l){return yA[o]||String.fromCharCode(parseInt(l,o.indexOf("x")>-1?16:10))||o}).replace(t,function(o,l){return String.fromCharCode(parseInt(l,16))});var i=s.indexOf("]]>");return r(s.slice(0,a))+s.slice(a+9,i)+r(s.slice(i+3))}}(),q6=/[&<>'"]/g,X6=/[\u0000-\u001f]/g;function Zv(e){var t=e+"";return t.replace(q6,function(r){return K6[r]}).replace(/\n/g,"<br/>").replace(X6,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}var lw=function(){var e=/&#(\d+);/g;function t(r,n){return String.fromCharCode(parseInt(n,10))}return function(n){return n.replace(e,t)}}();function bt(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function J0(e){for(var t="",r=0,n=0,s=0,a=0,i=0,o=0;r<e.length;){if(n=e.charCodeAt(r++),n<128){t+=String.fromCharCode(n);continue}if(s=e.charCodeAt(r++),n>191&&n<224){i=(n&31)<<6,i|=s&63,t+=String.fromCharCode(i);continue}if(a=e.charCodeAt(r++),n<240){t+=String.fromCharCode((n&15)<<12|(s&63)<<6|a&63);continue}i=e.charCodeAt(r++),o=((n&7)<<18|(s&63)<<12|(a&63)<<6|i&63)-65536,t+=String.fromCharCode(55296+(o>>>10&1023)),t+=String.fromCharCode(56320+(o&1023))}return t}function cw(e){var t=li(2*e.length),r,n,s=1,a=0,i=0,o;for(n=0;n<e.length;n+=s)s=1,(o=e.charCodeAt(n))<128?r=o:o<224?(r=(o&31)*64+(e.charCodeAt(n+1)&63),s=2):o<240?(r=(o&15)*4096+(e.charCodeAt(n+1)&63)*64+(e.charCodeAt(n+2)&63),s=3):(s=4,r=(o&7)*262144+(e.charCodeAt(n+1)&63)*4096+(e.charCodeAt(n+2)&63)*64+(e.charCodeAt(n+3)&63),r-=65536,i=55296+(r>>>10&1023),r=56320+(r&1023)),i!==0&&(t[a++]=i&255,t[a++]=i>>>8,i=0),t[a++]=r%256,t[a++]=r>>>8;return t.slice(0,a).toString("ucs2")}function uw(e){return no(e,"binary").toString("utf8")}var If="foo bar baz",Et=Qe&&(uw(If)==J0(If)&&uw||cw(If)==J0(If)&&cw)||J0,ic=Qe?function(e){return no(e,"utf8").toString("binary")}:function(e){for(var t=[],r=0,n=0,s=0;r<e.length;)switch(n=e.charCodeAt(r++),!0){case n<128:t.push(String.fromCharCode(n));break;case n<2048:t.push(String.fromCharCode(192+(n>>6))),t.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,s=e.charCodeAt(r++)-56320+(n<<10),t.push(String.fromCharCode(240+(s>>18&7))),t.push(String.fromCharCode(144+(s>>12&63))),t.push(String.fromCharCode(128+(s>>6&63))),t.push(String.fromCharCode(128+(s&63)));break;default:t.push(String.fromCharCode(224+(n>>12))),t.push(String.fromCharCode(128+(n>>6&63))),t.push(String.fromCharCode(128+(n&63)))}return t.join("")},lu=function(){var e={};return function(r,n){var s=r+"|"+(n||"");return e[s]?e[s]:e[s]=new RegExp("<(?:\\w+:)?"+r+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+r+">",n||"")}}(),wA=function(){var e=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(t){return[new RegExp("&"+t[0]+";","ig"),t[1]]});return function(r){for(var n=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),s=0;s<e.length;++s)n=n.replace(e[s][0],e[s][1]);return n}}(),Y6=function(){var e={};return function(r){return e[r]!==void 0?e[r]:e[r]=new RegExp("<(?:vt:)?"+r+">([\\s\\S]*?)</(?:vt:)?"+r+">","g")}}(),Q6=/<\/?(?:vt:)?variant>/g,J6=/<(?:vt:)([^>]*)>([\s\S]*)</;function fw(e,t){var r=Oe(e),n=e.match(Y6(r.baseType))||[],s=[];if(n.length!=r.size){if(t.WTF)throw new Error("unexpected vector length "+n.length+" != "+r.size);return s}return n.forEach(function(a){var i=a.replace(Q6,"").match(J6);i&&s.push({v:Et(i[2]),t:i[1]})}),s}var Z6=/(^\s|\s$|\n)/;function e8(e){return Ns(e).map(function(t){return" "+t+'="'+e[t]+'"'}).join("")}function t8(e,t,r){return"<"+e+(r!=null?e8(r):"")+(t!=null?(t.match(Z6)?' xml:space="preserve"':"")+">"+t+"</"+e:"/")+">"}function ex(e){if(Qe&&Buffer.isBuffer(e))return e.toString("utf8");if(typeof e=="string")return e;if(typeof Uint8Array<"u"&&e instanceof Uint8Array)return Et(so(qv(e)));throw new Error("Bad input format: expected Buffer or string")}var cu=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,r8={CT:"http://schemas.openxmlformats.org/package/2006/content-types"},n8=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"];function s8(e,t){for(var r=1-2*(e[t+7]>>>7),n=((e[t+7]&127)<<4)+(e[t+6]>>>4&15),s=e[t+6]&15,a=5;a>=0;--a)s=s*256+e[t+a];return n==2047?s==0?r*(1/0):NaN:(n==0?n=-1022:(n-=1023,s+=Math.pow(2,52)),r*Math.pow(2,n-52)*s)}function a8(e,t,r){var n=(t<0||1/t==-1/0?1:0)<<7,s=0,a=0,i=n?-t:t;isFinite(i)?i==0?s=a=0:(s=Math.floor(Math.log(i)/Math.LN2),a=i*Math.pow(2,52-s),s<=-1023&&(!isFinite(a)||a<Math.pow(2,52))?s=-1022:(a-=Math.pow(2,52),s+=1023)):(s=2047,a=isNaN(t)?26985:0);for(var o=0;o<=5;++o,a/=256)e[r+o]=a&255;e[r+6]=(s&15)<<4|a&15,e[r+7]=s>>4|n}var hw=function(e){for(var t=[],r=10240,n=0;n<e[0].length;++n)if(e[0][n])for(var s=0,a=e[0][n].length;s<a;s+=r)t.push.apply(t,e[0][n].slice(s,s+r));return t},dw=Qe?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(t){return Buffer.isBuffer(t)?t:no(t)})):hw(e)}:hw,mw=function(e,t,r){for(var n=[],s=t;s<r;s+=2)n.push(String.fromCharCode(Js(e,s)));return n.join("").replace(Qr,"")},tx=Qe?function(e,t,r){return Buffer.isBuffer(e)?e.toString("utf16le",t,r).replace(Qr,""):mw(e,t,r)}:mw,pw=function(e,t,r){for(var n=[],s=t;s<t+r;++s)n.push(("0"+e[s].toString(16)).slice(-2));return n.join("")},EA=Qe?function(e,t,r){return Buffer.isBuffer(e)?e.toString("hex",t,t+r):pw(e,t,r)}:pw,gw=function(e,t,r){for(var n=[],s=t;s<r;s++)n.push(String.fromCharCode(Eo(e,s)));return n.join("")},Lu=Qe?function(t,r,n){return Buffer.isBuffer(t)?t.toString("utf8",r,n):gw(t,r,n)}:gw,TA=function(e,t){var r=_n(e,t);return r>0?Lu(e,t+4,t+4+r-1):""},kA=TA,SA=function(e,t){var r=_n(e,t);return r>0?Lu(e,t+4,t+4+r-1):""},AA=SA,IA=function(e,t){var r=2*_n(e,t);return r>0?Lu(e,t+4,t+4+r-1):""},CA=IA,RA=function(t,r){var n=_n(t,r);return n>0?tx(t,r+4,r+4+n):""},NA=RA,bA=function(e,t){var r=_n(e,t);return r>0?Lu(e,t+4,t+4+r):""},PA=bA,DA=function(e,t){return s8(e,t)},nd=DA,FA=function(t){return Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array};Qe&&(kA=function(t,r){if(!Buffer.isBuffer(t))return TA(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},AA=function(t,r){if(!Buffer.isBuffer(t))return SA(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},CA=function(t,r){if(!Buffer.isBuffer(t))return IA(t,r);var n=2*t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n-1)},NA=function(t,r){if(!Buffer.isBuffer(t))return RA(t,r);var n=t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n)},PA=function(t,r){if(!Buffer.isBuffer(t))return bA(t,r);var n=t.readUInt32LE(r);return t.toString("utf8",r+4,r+4+n)},nd=function(t,r){return Buffer.isBuffer(t)?t.readDoubleLE(r):DA(t,r)},FA=function(t){return Buffer.isBuffer(t)||Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array});var Eo=function(e,t){return e[t]},Js=function(e,t){return e[t+1]*256+e[t]},i8=function(e,t){var r=e[t+1]*256+e[t];return r<32768?r:(65535-r+1)*-1},_n=function(e,t){return e[t+3]*(1<<24)+(e[t+2]<<16)+(e[t+1]<<8)+e[t]},ki=function(e,t){return e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]},o8=function(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]};function Ec(e,t){var r="",n,s,a=[],i,o,l,c;switch(t){case"dbcs":if(c=this.l,Qe&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*e).toString("utf16le");else for(l=0;l<e;++l)r+=String.fromCharCode(Js(this,c)),c+=2;e*=2;break;case"utf8":r=Lu(this,this.l,this.l+e);break;case"utf16le":e*=2,r=tx(this,this.l,this.l+e);break;case"wstr":return Ec.call(this,e,"dbcs");case"lpstr-ansi":r=kA(this,this.l),e=4+_n(this,this.l);break;case"lpstr-cp":r=AA(this,this.l),e=4+_n(this,this.l);break;case"lpwstr":r=CA(this,this.l),e=4+2*_n(this,this.l);break;case"lpp4":e=4+_n(this,this.l),r=NA(this,this.l),e&2&&(e+=2);break;case"8lpp4":e=4+_n(this,this.l),r=PA(this,this.l),e&3&&(e+=4-(e&3));break;case"cstr":for(e=0,r="";(i=Eo(this,this.l+e++))!==0;)a.push(Af(i));r=a.join("");break;case"_wstr":for(e=0,r="";(i=Js(this,this.l+e))!==0;)a.push(Af(i)),e+=2;e+=2,r=a.join("");break;case"dbcs-cont":for(r="",c=this.l,l=0;l<e;++l){if(this.lens&&this.lens.indexOf(c)!==-1)return i=Eo(this,c),this.l=c+1,o=Ec.call(this,e-l,i?"dbcs-cont":"sbcs-cont"),a.join("")+o;a.push(Af(Js(this,c))),c+=2}r=a.join(""),e*=2;break;case"cpstr":case"sbcs-cont":for(r="",c=this.l,l=0;l!=e;++l){if(this.lens&&this.lens.indexOf(c)!==-1)return i=Eo(this,c),this.l=c+1,o=Ec.call(this,e-l,i?"dbcs-cont":"sbcs-cont"),a.join("")+o;a.push(Af(Eo(this,c))),c+=1}r=a.join("");break;default:switch(e){case 1:return n=Eo(this,this.l),this.l++,n;case 2:return n=(t==="i"?i8:Js)(this,this.l),this.l+=2,n;case 4:case-4:return t==="i"||!(this[this.l+3]&128)?(n=(e>0?ki:o8)(this,this.l),this.l+=4,n):(s=_n(this,this.l),this.l+=4,s);case 8:case-8:if(t==="f")return e==8?s=nd(this,this.l):s=nd([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,s;e=8;case 16:r=EA(this,this.l,e);break}}return this.l+=e,r}var l8=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24&255},c8=function(e,t,r){e[r]=t&255,e[r+1]=t>>8&255,e[r+2]=t>>16&255,e[r+3]=t>>24&255},u8=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255};function f8(e,t,r){var n=0,s=0;if(r==="dbcs"){for(s=0;s!=t.length;++s)u8(this,t.charCodeAt(s),this.l+2*s);n=2*t.length}else if(r==="sbcs"){for(t=t.replace(/[^\x00-\x7F]/g,"_"),s=0;s!=t.length;++s)this[this.l+s]=t.charCodeAt(s)&255;n=t.length}else if(r==="hex"){for(;s<e;++s)this[this.l++]=parseInt(t.slice(2*s,2*s+2),16)||0;return this}else if(r==="utf16le"){var a=Math.min(this.l+e,this.length);for(s=0;s<Math.min(t.length,e);++s){var i=t.charCodeAt(s);this[this.l++]=i&255,this[this.l++]=i>>8}for(;this.l<a;)this[this.l++]=0;return this}else switch(e){case 1:n=1,this[this.l]=t&255;break;case 2:n=2,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255;break;case 3:n=3,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255,t>>>=8,this[this.l+2]=t&255;break;case 4:n=4,l8(this,t,this.l);break;case 8:if(n=8,r==="f"){a8(this,t,this.l);break}case 16:break;case-4:n=4,c8(this,t,this.l);break}return this.l+=n,this}function OA(e,t){var r=EA(this,this.l,e.length>>1);if(r!==e)throw new Error(t+"Expected "+e+" saw "+r);this.l+=e.length>>1}function xr(e,t){e.l=t,e.read_shift=Ec,e.chk=OA,e.write_shift=f8}function $r(e,t){e.l+=t}function tr(e){var t=li(e);return xr(t,0),t}function ya(e,t,r){if(e){var n,s,a;xr(e,e.l||0);for(var i=e.length,o=0,l=0;e.l<i;){o=e.read_shift(1),o&128&&(o=(o&127)+((e.read_shift(1)&127)<<7));var c=cd[o]||cd[65535];for(n=e.read_shift(1),a=n&127,s=1;s<4&&n&128;++s)a+=((n=e.read_shift(1))&127)<<7*s;l=e.l+a;var u=c.f&&c.f(e,a,r);if(e.l=l,t(u,c,o))return}}}function Pp(){var e=[],t=Qe?256:2048,r=function(c){var u=tr(c);return xr(u,0),u},n=r(t),s=function(){n&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&e.push(n),n=null)},a=function(c){return n&&c<n.length-n.l?n:(s(),n=r(Math.max(c+1,t)))},i=function(){return s(),Ma(e)},o=function(c){s(),n=c,n.l==null&&(n.l=n.length),a(t)};return{next:a,push:o,end:i,_bufs:e}}function Tc(e,t,r){var n=Er(e);if(t.s?(n.cRel&&(n.c+=t.s.c),n.rRel&&(n.r+=t.s.r)):(n.cRel&&(n.c+=t.c),n.rRel&&(n.r+=t.r)),!r||r.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function vw(e,t,r){var n=Er(e);return n.s=Tc(n.s,t.s,r),n.e=Tc(n.e,t.s,r),n}function kc(e,t){if(e.cRel&&e.c<0)for(e=Er(e);e.c<0;)e.c+=t>8?16384:256;if(e.rRel&&e.r<0)for(e=Er(e);e.r<0;)e.r+=t>8?1048576:t>5?65536:16384;var r=Ue(e);return!e.cRel&&e.cRel!=null&&(r=m8(r)),!e.rRel&&e.rRel!=null&&(r=h8(r)),r}function Z0(e,t){return e.s.r==0&&!e.s.rRel&&e.e.r==(t.biff>=12?1048575:t.biff>=8?65536:16384)&&!e.e.rRel?(e.s.cRel?"":"$")+sr(e.s.c)+":"+(e.e.cRel?"":"$")+sr(e.e.c):e.s.c==0&&!e.s.cRel&&e.e.c==(t.biff>=12?16383:255)&&!e.e.cRel?(e.s.rRel?"":"$")+Tr(e.s.r)+":"+(e.e.rRel?"":"$")+Tr(e.e.r):kc(e.s,t.biff)+":"+kc(e.e,t.biff)}function rx(e){return parseInt(d8(e),10)-1}function Tr(e){return""+(e+1)}function h8(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function d8(e){return e.replace(/\$(\d+)$/,"$1")}function nx(e){for(var t=p8(e),r=0,n=0;n!==t.length;++n)r=26*r+t.charCodeAt(n)-64;return r-1}function sr(e){if(e<0)throw new Error("invalid column "+e);var t="";for(++e;e;e=Math.floor((e-1)/26))t=String.fromCharCode((e-1)%26+65)+t;return t}function m8(e){return e.replace(/^([A-Z])/,"$$$1")}function p8(e){return e.replace(/^\$([A-Z])/,"$1")}function g8(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function qr(e){for(var t=0,r=0,n=0;n<e.length;++n){var s=e.charCodeAt(n);s>=48&&s<=57?t=10*t+(s-48):s>=65&&s<=90&&(r=26*r+(s-64))}return{c:r-1,r:t-1}}function Ue(e){for(var t=e.c+1,r="";t;t=(t-1)/26|0)r=String.fromCharCode((t-1)%26+65)+r;return r+(e.r+1)}function Sl(e){var t=e.indexOf(":");return t==-1?{s:qr(e),e:qr(e)}:{s:qr(e.slice(0,t)),e:qr(e.slice(t+1))}}function rt(e,t){return typeof t>"u"||typeof t=="number"?rt(e.s,e.e):(typeof e!="string"&&(e=Ue(e)),typeof t!="string"&&(t=Ue(t)),e==t?e:e+":"+t)}function Bt(e){var t={s:{c:0,r:0},e:{c:0,r:0}},r=0,n=0,s=0,a=e.length;for(r=0;n<a&&!((s=e.charCodeAt(n)-64)<1||s>26);++n)r=26*r+s;for(t.s.c=--r,r=0;n<a&&!((s=e.charCodeAt(n)-48)<0||s>9);++n)r=10*r+s;if(t.s.r=--r,n===a||s!=10)return t.e.c=t.s.c,t.e.r=t.s.r,t;for(++n,r=0;n!=a&&!((s=e.charCodeAt(n)-64)<1||s>26);++n)r=26*r+s;for(t.e.c=--r,r=0;n!=a&&!((s=e.charCodeAt(n)-48)<0||s>9);++n)r=10*r+s;return t.e.r=--r,t}function xw(e,t){var r=e.t=="d"&&t instanceof Date;if(e.z!=null)try{return e.w=$n(e.z,r?Jr(t):t)}catch{}try{return e.w=$n((e.XF||{}).numFmtId||(r?14:0),r?Jr(t):t)}catch{return""+t}}function ga(e,t,r){return e==null||e.t==null||e.t=="z"?"":e.w!==void 0?e.w:(e.t=="d"&&!e.z&&r&&r.dateNF&&(e.z=r.dateNF),e.t=="e"?oo[e.v]||e.v:t==null?xw(e,e.v):xw(e,t))}function gi(e,t){var r=t&&t.sheet?t.sheet:"Sheet1",n={};return n[r]=e,{SheetNames:[r],Sheets:n}}function MA(e,t,r){var n=r||{},s=e?Array.isArray(e):n.dense,a=e||(s?[]:{}),i=0,o=0;if(a&&n.origin!=null){if(typeof n.origin=="number")i=n.origin;else{var l=typeof n.origin=="string"?qr(n.origin):n.origin;i=l.r,o=l.c}a["!ref"]||(a["!ref"]="A1:A1")}var c={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(a["!ref"]){var u=Bt(a["!ref"]);c.s.c=u.s.c,c.s.r=u.s.r,c.e.c=Math.max(c.e.c,u.e.c),c.e.r=Math.max(c.e.r,u.e.r),i==-1&&(c.e.r=i=u.e.r+1)}for(var h=0;h!=t.length;++h)if(t[h]){if(!Array.isArray(t[h]))throw new Error("aoa_to_sheet expects an array of arrays");for(var m=0;m!=t[h].length;++m)if(!(typeof t[h][m]>"u")){var p={v:t[h][m]},x=i+h,v=o+m;if(c.s.r>x&&(c.s.r=x),c.s.c>v&&(c.s.c=v),c.e.r<x&&(c.e.r=x),c.e.c<v&&(c.e.c=v),t[h][m]&&typeof t[h][m]=="object"&&!Array.isArray(t[h][m])&&!(t[h][m]instanceof Date))p=t[h][m];else if(Array.isArray(p.v)&&(p.f=t[h][m][1],p.v=p.v[0]),p.v===null)if(p.f)p.t="n";else if(n.nullError)p.t="e",p.v=0;else if(n.sheetStubs)p.t="z";else continue;else typeof p.v=="number"?p.t="n":typeof p.v=="boolean"?p.t="b":p.v instanceof Date?(p.z=n.dateNF||ze[14],n.cellDates?(p.t="d",p.w=$n(p.z,Jr(p.v))):(p.t="n",p.v=Jr(p.v),p.w=$n(p.z,p.v))):p.t="s";if(s)a[x]||(a[x]=[]),a[x][v]&&a[x][v].z&&(p.z=a[x][v].z),a[x][v]=p;else{var w=Ue({c:v,r:x});a[w]&&a[w].z&&(p.z=a[w].z),a[w]=p}}}return c.s.c<1e7&&(a["!ref"]=rt(c)),a}function Al(e,t){return MA(null,e,t)}function v8(e){return e.read_shift(4,"i")}function Ur(e){var t=e.read_shift(4);return t===0?"":e.read_shift(t,"dbcs")}function x8(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function sx(e,t){var r=e.l,n=e.read_shift(1),s=Ur(e),a=[],i={t:s,h:s};if(n&1){for(var o=e.read_shift(4),l=0;l!=o;++l)a.push(x8(e));i.r=a}else i.r=[{ich:0,ifnt:0}];return e.l=r+t,i}var _8=sx;function Wn(e){var t=e.read_shift(4),r=e.read_shift(2);return r+=e.read_shift(1)<<16,e.l++,{c:t,iStyleRef:r}}function ao(e){var t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:t}}var y8=Ur;function ax(e){var t=e.read_shift(4);return t===0||t===4294967295?"":e.read_shift(t,"dbcs")}var w8=Ur,Dp=ax;function ix(e){var t=e.slice(e.l,e.l+4),r=t[0]&1,n=t[0]&2;e.l+=4;var s=n===0?nd([0,0,0,0,t[0]&252,t[1],t[2],t[3]],0):ki(t,0)>>2;return r?s/100:s}function LA(e){var t={s:{},e:{}};return t.s.r=e.read_shift(4),t.e.r=e.read_shift(4),t.s.c=e.read_shift(4),t.e.c=e.read_shift(4),t}var io=LA;function Lr(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function E8(e){var t={},r=e.read_shift(1),n=r>>>1,s=e.read_shift(1),a=e.read_shift(2,"i"),i=e.read_shift(1),o=e.read_shift(1),l=e.read_shift(1);switch(e.l++,n){case 0:t.auto=1;break;case 1:t.index=s;var c=Li[s];c&&(t.rgb=fu(c));break;case 2:t.rgb=fu([i,o,l]);break;case 3:t.theme=s;break}return a!=0&&(t.tint=a>0?a/32767:a/32768),t}function T8(e){var t=e.read_shift(1);e.l++;var r={fBold:t&1,fItalic:t&2,fUnderline:t&4,fStrikeout:t&8,fOutline:t&16,fShadow:t&32,fCondense:t&64,fExtend:t&128};return r}function jA(e,t){var r={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},n=e.read_shift(4);switch(n){case 0:return"";case 4294967295:case 4294967294:return r[e.read_shift(4)]||""}if(n>400)throw new Error("Unsupported Clipboard: "+n.toString(16));return e.l-=4,e.read_shift(0,t==1?"lpstr":"lpwstr")}function k8(e){return jA(e,1)}function S8(e){return jA(e,2)}var ox=2,an=3,Cf=11,_w=12,sd=19,Rf=64,A8=65,I8=71,C8=4108,R8=4126,ur=80,VA=81,N8=[ur,VA],b8={1:{n:"CodePage",t:ox},2:{n:"Category",t:ur},3:{n:"PresentationFormat",t:ur},4:{n:"ByteCount",t:an},5:{n:"LineCount",t:an},6:{n:"ParagraphCount",t:an},7:{n:"SlideCount",t:an},8:{n:"NoteCount",t:an},9:{n:"HiddenCount",t:an},10:{n:"MultimediaClipCount",t:an},11:{n:"ScaleCrop",t:Cf},12:{n:"HeadingPairs",t:C8},13:{n:"TitlesOfParts",t:R8},14:{n:"Manager",t:ur},15:{n:"Company",t:ur},16:{n:"LinksUpToDate",t:Cf},17:{n:"CharacterCount",t:an},19:{n:"SharedDoc",t:Cf},22:{n:"HyperlinksChanged",t:Cf},23:{n:"AppVersion",t:an,p:"version"},24:{n:"DigSig",t:A8},26:{n:"ContentType",t:ur},27:{n:"ContentStatus",t:ur},28:{n:"Language",t:ur},29:{n:"Version",t:ur},255:{},2147483648:{n:"Locale",t:sd},2147483651:{n:"Behavior",t:sd},1919054434:{}},P8={1:{n:"CodePage",t:ox},2:{n:"Title",t:ur},3:{n:"Subject",t:ur},4:{n:"Author",t:ur},5:{n:"Keywords",t:ur},6:{n:"Comments",t:ur},7:{n:"Template",t:ur},8:{n:"LastAuthor",t:ur},9:{n:"RevNumber",t:ur},10:{n:"EditTime",t:Rf},11:{n:"LastPrinted",t:Rf},12:{n:"CreatedDate",t:Rf},13:{n:"ModifiedDate",t:Rf},14:{n:"PageCount",t:an},15:{n:"WordCount",t:an},16:{n:"CharCount",t:an},17:{n:"Thumbnail",t:I8},18:{n:"Application",t:ur},19:{n:"DocSecurity",t:an},255:{},2147483648:{n:"Locale",t:sd},2147483651:{n:"Behavior",t:sd},1919054434:{}},yw={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},D8=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function F8(e){return e.map(function(t){return[t>>16&255,t>>8&255,t&255]})}var O8=F8([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Li=Er(O8),oo={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},UA={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},ww={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"};function M8(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function L8(e){var t=M8();if(!e||!e.match)return t;var r={};if((e.match(Wr)||[]).forEach(function(n){var s=Oe(n);switch(s[0].replace(H6,"<")){case"<?xml":break;case"<Types":t.xmlns=s["xmlns"+(s[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":r[s.Extension]=s.ContentType;break;case"<Override":t[ww[s.ContentType]]!==void 0&&t[ww[s.ContentType]].push(s.PartName);break}}),t.xmlns!==r8.CT)throw new Error("Unknown Namespace: "+t.xmlns);return t.calcchain=t.calcchains.length>0?t.calcchains[0]:"",t.sst=t.strs.length>0?t.strs[0]:"",t.style=t.styles.length>0?t.styles[0]:"",t.defaults=r,delete t.calcchains,t}var Oo={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function Fp(e){var t=e.lastIndexOf("/");return e.slice(0,t+1)+"_rels/"+e.slice(t+1)+".rels"}function Sc(e,t){var r={"!id":{}};if(!e)return r;t.charAt(0)!=="/"&&(t="/"+t);var n={};return(e.match(Wr)||[]).forEach(function(s){var a=Oe(s);if(a[0]==="<Relationship"){var i={};i.Type=a.Type,i.Target=a.Target,i.Id=a.Id,a.TargetMode&&(i.TargetMode=a.TargetMode);var o=a.TargetMode==="External"?a.Target:ac(a.Target,t);r[o]=i,n[a.Id]=i}}),r["!id"]=n,r}var j8="application/vnd.oasis.opendocument.spreadsheet";function V8(e,t){for(var r=ex(e),n,s;n=cu.exec(r);)switch(n[3]){case"manifest":break;case"file-entry":if(s=Oe(n[0],!1),s.path=="/"&&s.type!==j8)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(t&&t.WTF)throw n}}var Ac=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],U8=function(){for(var e=new Array(Ac.length),t=0;t<Ac.length;++t){var r=Ac[t],n="(?:"+r[0].slice(0,r[0].indexOf(":"))+":)"+r[0].slice(r[0].indexOf(":")+1);e[t]=new RegExp("<"+n+"[^>]*>([\\s\\S]*?)</"+n+">")}return e}();function BA(e){var t={};e=Et(e);for(var r=0;r<Ac.length;++r){var n=Ac[r],s=e.match(U8[r]);s!=null&&s.length>0&&(t[n[1]]=it(s[1])),n[2]==="date"&&t[n[1]]&&(t[n[1]]=dr(t[n[1]]))}return t}var B8=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]];function zA(e,t,r,n){var s=[];if(typeof e=="string")s=fw(e,n);else for(var a=0;a<e.length;++a)s=s.concat(e[a].map(function(u){return{v:u}}));var i=typeof t=="string"?fw(t,n).map(function(u){return u.v}):t,o=0,l=0;if(i.length>0)for(var c=0;c!==s.length;c+=2){switch(l=+s[c+1].v,s[c].v){case"Worksheets":case"":case"":case" ":case"":case" ":case"Arbeitsbltter":case"alma Sayfalar":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de clculo":case"Planilhas":case"Regneark":case"Hojas de clculo":case"Werkbladen":r.Worksheets=l,r.SheetNames=i.slice(o,o+l);break;case"Named Ranges":case"Rangos con nombre":case"":case"Benannte Bereiche":case"Navngivne omrder":r.NamedRanges=l,r.DefinedNames=i.slice(o,o+l);break;case"Charts":case"Diagramme":r.Chartsheets=l,r.ChartNames=i.slice(o,o+l);break}o+=l}}function z8(e,t,r){var n={};return t||(t={}),e=Et(e),B8.forEach(function(s){var a=(e.match(lu(s[0]))||[])[1];switch(s[2]){case"string":a&&(t[s[1]]=it(a));break;case"bool":t[s[1]]=a==="true";break;case"raw":var i=e.match(new RegExp("<"+s[0]+"[^>]*>([\\s\\S]*?)</"+s[0]+">"));i&&i.length>0&&(n[s[1]]=i[1]);break}}),n.HeadingPairs&&n.TitlesOfParts&&zA(n.HeadingPairs,n.TitlesOfParts,t,r),t}var $8=/<[^>]+>[^<]*/g;function W8(e,t){var r={},n="",s=e.match($8);if(s)for(var a=0;a!=s.length;++a){var i=s[a],o=Oe(i);switch(o[0]){case"<?xml":break;case"<Properties":break;case"<property":n=it(o.name);break;case"</property>":n=null;break;default:if(i.indexOf("<vt:")===0){var l=i.split(">"),c=l[0].slice(4),u=l[1];switch(c){case"lpstr":case"bstr":case"lpwstr":r[n]=it(u);break;case"bool":r[n]=bt(u);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":r[n]=parseInt(u,10);break;case"r4":case"r8":case"decimal":r[n]=parseFloat(u);break;case"filetime":case"date":r[n]=dr(u);break;case"cy":case"error":r[n]=it(u);break;default:if(c.slice(-1)=="/")break;t.WTF&&typeof console<"u"&&console.warn("Unexpected",i,c,l)}}else if(i.slice(0,2)!=="</"){if(t.WTF)throw new Error(i)}}}return r}var H8={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},em;function G8(e,t,r){em||(em=Qv(H8)),t=em[t]||t,e[t]=r}function lx(e){var t=e.read_shift(4),r=e.read_shift(4);return new Date((r/1e7*Math.pow(2,32)+t/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function $A(e,t,r){var n=e.l,s=e.read_shift(0,"lpstr-cp");if(r)for(;e.l-n&3;)++e.l;return s}function WA(e,t,r){var n=e.read_shift(0,"lpwstr");return n}function HA(e,t,r){return t===31?WA(e):$A(e,t,r)}function Op(e,t,r){return HA(e,t,r===!1?0:4)}function K8(e,t){if(!t)throw new Error("VtUnalignedString must have positive length");return HA(e,t,0)}function q8(e){for(var t=e.read_shift(4),r=[],n=0;n!=t;++n){var s=e.l;r[n]=e.read_shift(0,"lpwstr").replace(Qr,""),e.l-s&2&&(e.l+=2)}return r}function X8(e){for(var t=e.read_shift(4),r=[],n=0;n!=t;++n)r[n]=e.read_shift(0,"lpstr-cp").replace(Qr,"");return r}function Y8(e){var t=e.l,r=ad(e,VA);e[e.l]==0&&e[e.l+1]==0&&e.l-t&2&&(e.l+=2);var n=ad(e,an);return[r,n]}function Q8(e){for(var t=e.read_shift(4),r=[],n=0;n<t/2;++n)r.push(Y8(e));return r}function Ew(e,t){for(var r=e.read_shift(4),n={},s=0;s!=r;++s){var a=e.read_shift(4),i=e.read_shift(4);n[a]=e.read_shift(i,t===1200?"utf16le":"utf8").replace(Qr,"").replace(sc,"!"),t===1200&&i%2&&(e.l+=2)}return e.l&3&&(e.l=e.l>>3<<2),n}function GA(e){var t=e.read_shift(4),r=e.slice(e.l,e.l+t);return e.l+=t,(t&3)>0&&(e.l+=4-(t&3)&3),r}function J8(e){var t={};return t.Size=e.read_shift(4),e.l+=t.Size+3-(t.Size-1)%4,t}function ad(e,t,r){var n=e.read_shift(2),s,a=r||{};if(e.l+=2,t!==_w&&n!==t&&N8.indexOf(t)===-1&&!((t&65534)==4126&&(n&65534)==4126))throw new Error("Expected type "+t+" saw "+n);switch(t===_w?n:t){case 2:return s=e.read_shift(2,"i"),a.raw||(e.l+=2),s;case 3:return s=e.read_shift(4,"i"),s;case 11:return e.read_shift(4)!==0;case 19:return s=e.read_shift(4),s;case 30:return $A(e,n,4).replace(Qr,"");case 31:return WA(e);case 64:return lx(e);case 65:return GA(e);case 71:return J8(e);case 80:return Op(e,n,!a.raw).replace(Qr,"");case 81:return K8(e,n).replace(Qr,"");case 4108:return Q8(e);case 4126:case 4127:return n==4127?q8(e):X8(e);default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+n)}}function Tw(e,t){var r=e.l,n=e.read_shift(4),s=e.read_shift(4),a=[],i=0,o=0,l=-1,c={};for(i=0;i!=s;++i){var u=e.read_shift(4),h=e.read_shift(4);a[i]=[u,h+r]}a.sort(function(T,E){return T[1]-E[1]});var m={};for(i=0;i!=s;++i){if(e.l!==a[i][1]){var p=!0;if(i>0&&t)switch(t[a[i-1][0]].t){case 2:e.l+2===a[i][1]&&(e.l+=2,p=!1);break;case 80:e.l<=a[i][1]&&(e.l=a[i][1],p=!1);break;case 4108:e.l<=a[i][1]&&(e.l=a[i][1],p=!1);break}if((!t||i==0)&&e.l<=a[i][1]&&(p=!1,e.l=a[i][1]),p)throw new Error("Read Error: Expected address "+a[i][1]+" at "+e.l+" :"+i)}if(t){var x=t[a[i][0]];if(m[x.n]=ad(e,x.t,{raw:!0}),x.p==="version"&&(m[x.n]=String(m[x.n]>>16)+"."+("0000"+String(m[x.n]&65535)).slice(-4)),x.n=="CodePage")switch(m[x.n]){case 0:m[x.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:ns(o=m[x.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+m[x.n])}}else if(a[i][0]===1){if(o=m.CodePage=ad(e,ox),ns(o),l!==-1){var v=e.l;e.l=a[l][1],c=Ew(e,o),e.l=v}}else if(a[i][0]===0){if(o===0){l=i,e.l=a[i+1][1];continue}c=Ew(e,o)}else{var w=c[a[i][0]],k;switch(e[e.l]){case 65:e.l+=4,k=GA(e);break;case 30:e.l+=4,k=Op(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 31:e.l+=4,k=Op(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 3:e.l+=4,k=e.read_shift(4,"i");break;case 19:e.l+=4,k=e.read_shift(4);break;case 5:e.l+=4,k=e.read_shift(8,"f");break;case 11:e.l+=4,k=zt(e,4);break;case 64:e.l+=4,k=dr(lx(e));break;default:throw new Error("unparsed value: "+e[e.l])}m[w]=k}}return e.l=r+n,m}function kw(e,t,r){var n=e.content;if(!n)return{};xr(n,0);var s,a,i,o,l=0;n.chk("feff","Byte Order: "),n.read_shift(2);var c=n.read_shift(4),u=n.read_shift(16);if(u!==tt.utils.consts.HEADER_CLSID&&u!==r)throw new Error("Bad PropertySet CLSID "+u);if(s=n.read_shift(4),s!==1&&s!==2)throw new Error("Unrecognized #Sets: "+s);if(a=n.read_shift(16),o=n.read_shift(4),s===1&&o!==n.l)throw new Error("Length mismatch: "+o+" !== "+n.l);s===2&&(i=n.read_shift(16),l=n.read_shift(4));var h=Tw(n,t),m={SystemIdentifier:c};for(var p in h)m[p]=h[p];if(m.FMTID=a,s===1)return m;if(l-n.l==2&&(n.l+=2),n.l!==l)throw new Error("Length mismatch 2: "+n.l+" !== "+l);var x;try{x=Tw(n,null)}catch{}for(p in x)m[p]=x[p];return m.FMTID=[a,i],m}function Ia(e,t){return e.read_shift(t),null}function Z8(e,t,r){for(var n=[],s=e.l+t;e.l<s;)n.push(r(e,s-e.l));if(s!==e.l)throw new Error("Slurp error");return n}function zt(e,t){return e.read_shift(t)===1}function Yt(e){return e.read_shift(2,"u")}function KA(e,t){return Z8(e,t,Yt)}function e5(e){var t=e.read_shift(1),r=e.read_shift(1);return r===1?t:t===1}function ju(e,t,r){var n=e.read_shift(r&&r.biff>=12?2:1),s="sbcs-cont";if(r&&r.biff>=8,!r||r.biff==8){var a=e.read_shift(1);a&&(s="dbcs-cont")}else r.biff==12&&(s="wstr");r.biff>=2&&r.biff<=5&&(s="cpstr");var i=n?e.read_shift(n,s):"";return i}function t5(e){var t=e.read_shift(2),r=e.read_shift(1),n=r&4,s=r&8,a=1+(r&1),i=0,o,l={};s&&(i=e.read_shift(2)),n&&(o=e.read_shift(4));var c=a==2?"dbcs-cont":"sbcs-cont",u=t===0?"":e.read_shift(t,c);return s&&(e.l+=4*i),n&&(e.l+=o),l.t=u,s||(l.raw="<t>"+l.t+"</t>",l.r=l.t),l}function Yi(e,t,r){var n;if(r){if(r.biff>=2&&r.biff<=5)return e.read_shift(t,"cpstr");if(r.biff>=12)return e.read_shift(t,"dbcs-cont")}var s=e.read_shift(1);return s===0?n=e.read_shift(t,"sbcs-cont"):n=e.read_shift(t,"dbcs-cont"),n}function Vu(e,t,r){var n=e.read_shift(r&&r.biff==2?1:2);return n===0?(e.l++,""):Yi(e,n,r)}function lo(e,t,r){if(r.biff>5)return Vu(e,t,r);var n=e.read_shift(1);return n===0?(e.l++,""):e.read_shift(n,r.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function r5(e){var t=e.read_shift(1);e.l++;var r=e.read_shift(2);return e.l+=2,[t,r]}function n5(e){var t=e.read_shift(4),r=e.l,n=!1;t>24&&(e.l+=t-24,e.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(n=!0),e.l=r);var s=e.read_shift((n?t-24:t)>>1,"utf16le").replace(Qr,"");return n&&(e.l+=24),s}function s5(e){for(var t=e.read_shift(2),r="";t-- >0;)r+="../";var n=e.read_shift(0,"lpstr-ansi");if(e.l+=2,e.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var s=e.read_shift(4);if(s===0)return r+n.replace(/\\/g,"/");var a=e.read_shift(4);if(e.read_shift(2)!=3)throw new Error("Bad FileMoniker");var i=e.read_shift(a>>1,"utf16le").replace(Qr,"");return r+i}function a5(e,t){var r=e.read_shift(16);switch(r){case"e0c9ea79f9bace118c8200aa004ba90b":return n5(e);case"0303000000000000c000000000000046":return s5(e);default:throw new Error("Unsupported Moniker "+r)}}function Nf(e){var t=e.read_shift(4),r=t>0?e.read_shift(t,"utf16le").replace(Qr,""):"";return r}function i5(e,t){var r=e.l+t,n=e.read_shift(4);if(n!==2)throw new Error("Unrecognized streamVersion: "+n);var s=e.read_shift(2);e.l+=2;var a,i,o,l,c="",u,h;s&16&&(a=Nf(e,r-e.l)),s&128&&(i=Nf(e,r-e.l)),(s&257)===257&&(o=Nf(e,r-e.l)),(s&257)===1&&(l=a5(e,r-e.l)),s&8&&(c=Nf(e,r-e.l)),s&32&&(u=e.read_shift(16)),s&64&&(h=lx(e)),e.l=r;var m=i||o||l||"";m&&c&&(m+="#"+c),m||(m="#"+c),s&2&&m.charAt(0)=="/"&&m.charAt(1)!="/"&&(m="file://"+m);var p={Target:m};return u&&(p.guid=u),h&&(p.time=h),a&&(p.Tooltip=a),p}function qA(e){var t=e.read_shift(1),r=e.read_shift(1),n=e.read_shift(1),s=e.read_shift(1);return[t,r,n,s]}function XA(e,t){var r=qA(e);return r[3]=0,r}function Os(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2);return{r:t,c:r,ixfe:n}}function o5(e){var t=e.read_shift(2),r=e.read_shift(2);return e.l+=8,{type:t,flags:r}}function l5(e,t,r){return t===0?"":lo(e,t,r)}function c5(e,t,r){var n=r.biff>8?4:2,s=e.read_shift(n),a=e.read_shift(n,"i"),i=e.read_shift(n,"i");return[s,a,i]}function YA(e){var t=e.read_shift(2),r=ix(e);return[t,r]}function u5(e,t,r){e.l+=4,t-=4;var n=e.l+t,s=ju(e,t,r),a=e.read_shift(2);if(n-=e.l,a!==n)throw new Error("Malformed AddinUdf: padding = "+n+" != "+a);return e.l+=a,s}function r0(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2),s=e.read_shift(2);return{s:{c:n,r:t},e:{c:s,r}}}function QA(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(1),s=e.read_shift(1);return{s:{c:n,r:t},e:{c:s,r}}}var f5=QA;function JA(e){e.l+=4;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2);return e.l+=12,[r,t,n]}function h5(e){var t={};return e.l+=4,e.l+=16,t.fSharedNote=e.read_shift(2),e.l+=4,t}function d5(e){var t={};return e.l+=4,e.cf=e.read_shift(2),t}function Pr(e){e.l+=2,e.l+=e.read_shift(2)}var m5={0:Pr,4:Pr,5:Pr,6:Pr,7:d5,8:Pr,9:Pr,10:Pr,11:Pr,12:Pr,13:h5,14:Pr,15:Pr,16:Pr,17:Pr,18:Pr,19:Pr,20:Pr,21:JA};function p5(e,t){for(var r=e.l+t,n=[];e.l<r;){var s=e.read_shift(2);e.l-=2;try{n.push(m5[s](e,r-e.l))}catch{return e.l=r,n}}return e.l!=r&&(e.l=r),n}function bf(e,t){var r={BIFFVer:0,dt:0};switch(r.BIFFVer=e.read_shift(2),t-=2,t>=2&&(r.dt=e.read_shift(2),e.l-=2),r.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(t>6)throw new Error("Unexpected BIFF Ver "+r.BIFFVer)}return e.read_shift(t),r}function g5(e,t){return t===0||e.read_shift(2),1200}function v5(e,t,r){if(r.enc)return e.l+=t,"";var n=e.l,s=lo(e,0,r);return e.read_shift(t+n-e.l),s}function x5(e,t,r){var n=r&&r.biff==8||t==2?e.read_shift(2):(e.l+=t,0);return{fDialog:n&16,fBelow:n&64,fRight:n&128}}function _5(e,t,r){var n=e.read_shift(4),s=e.read_shift(1)&3,a=e.read_shift(1);switch(a){case 0:a="Worksheet";break;case 1:a="Macrosheet";break;case 2:a="Chartsheet";break;case 6:a="VBAModule";break}var i=ju(e,0,r);return i.length===0&&(i="Sheet1"),{pos:n,hs:s,dt:a,name:i}}function y5(e,t){for(var r=e.l+t,n=e.read_shift(4),s=e.read_shift(4),a=[],i=0;i!=s&&e.l<r;++i)a.push(t5(e));return a.Count=n,a.Unique=s,a}function w5(e,t){var r={};return r.dsst=e.read_shift(2),e.l+=t-2,r}function E5(e){var t={};t.r=e.read_shift(2),t.c=e.read_shift(2),t.cnt=e.read_shift(2)-t.c;var r=e.read_shift(2);e.l+=4;var n=e.read_shift(1);return e.l+=3,n&7&&(t.level=n&7),n&32&&(t.hidden=!0),n&64&&(t.hpt=r/20),t}function T5(e){var t=o5(e);if(t.type!=2211)throw new Error("Invalid Future Record "+t.type);var r=e.read_shift(4);return r!==0}function k5(e){return e.read_shift(2),e.read_shift(4)}function Sw(e,t,r){var n=0;r&&r.biff==2||(n=e.read_shift(2));var s=e.read_shift(2);r&&r.biff==2&&(n=1-(s>>15),s&=32767);var a={Unsynced:n&1,DyZero:(n&2)>>1,ExAsc:(n&4)>>2,ExDsc:(n&8)>>3};return[a,s]}function S5(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2),s=e.read_shift(2),a=e.read_shift(2),i=e.read_shift(2),o=e.read_shift(2),l=e.read_shift(2),c=e.read_shift(2);return{Pos:[t,r],Dim:[n,s],Flags:a,CurTab:i,FirstTab:o,Selected:l,TabRatio:c}}function A5(e,t,r){if(r&&r.biff>=2&&r.biff<5)return{};var n=e.read_shift(2);return{RTL:n&64}}function I5(){}function C5(e,t,r){var n={dyHeight:e.read_shift(2),fl:e.read_shift(2)};switch(r&&r.biff||8){case 2:break;case 3:case 4:e.l+=2;break;default:e.l+=10;break}return n.name=ju(e,0,r),n}function R5(e){var t=Os(e);return t.isst=e.read_shift(4),t}function N5(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=e.l+t,s=Os(e);r.biff==2&&e.l++;var a=Vu(e,n-e.l,r);return s.val=a,s}function b5(e,t,r){var n=e.read_shift(2),s=lo(e,0,r);return[n,s]}var P5=lo;function Aw(e,t,r){var n=e.l+t,s=r.biff==8||!r.biff?4:2,a=e.read_shift(s),i=e.read_shift(s),o=e.read_shift(2),l=e.read_shift(2);return e.l=n,{s:{r:a,c:o},e:{r:i,c:l}}}function D5(e){var t=e.read_shift(2),r=e.read_shift(2),n=YA(e);return{r:t,c:r,ixfe:n[0],rknum:n[1]}}function F5(e,t){for(var r=e.l+t-2,n=e.read_shift(2),s=e.read_shift(2),a=[];e.l<r;)a.push(YA(e));if(e.l!==r)throw new Error("MulRK read error");var i=e.read_shift(2);if(a.length!=i-s+1)throw new Error("MulRK length mismatch");return{r:n,c:s,C:i,rkrec:a}}function O5(e,t){for(var r=e.l+t-2,n=e.read_shift(2),s=e.read_shift(2),a=[];e.l<r;)a.push(e.read_shift(2));if(e.l!==r)throw new Error("MulBlank read error");var i=e.read_shift(2);if(a.length!=i-s+1)throw new Error("MulBlank length mismatch");return{r:n,c:s,C:i,ixfe:a}}function M5(e,t,r,n){var s={},a=e.read_shift(4),i=e.read_shift(4),o=e.read_shift(4),l=e.read_shift(2);return s.patternType=D8[o>>26],n.cellStyles&&(s.alc=a&7,s.fWrap=a>>3&1,s.alcV=a>>4&7,s.fJustLast=a>>7&1,s.trot=a>>8&255,s.cIndent=a>>16&15,s.fShrinkToFit=a>>20&1,s.iReadOrder=a>>22&2,s.fAtrNum=a>>26&1,s.fAtrFnt=a>>27&1,s.fAtrAlc=a>>28&1,s.fAtrBdr=a>>29&1,s.fAtrPat=a>>30&1,s.fAtrProt=a>>31&1,s.dgLeft=i&15,s.dgRight=i>>4&15,s.dgTop=i>>8&15,s.dgBottom=i>>12&15,s.icvLeft=i>>16&127,s.icvRight=i>>23&127,s.grbitDiag=i>>30&3,s.icvTop=o&127,s.icvBottom=o>>7&127,s.icvDiag=o>>14&127,s.dgDiag=o>>21&15,s.icvFore=l&127,s.icvBack=l>>7&127,s.fsxButton=l>>14&1),s}function L5(e,t,r){var n={};return n.ifnt=e.read_shift(2),n.numFmtId=e.read_shift(2),n.flags=e.read_shift(2),n.fStyle=n.flags>>2&1,t-=6,n.data=M5(e,t,n.fStyle,r),n}function j5(e){e.l+=4;var t=[e.read_shift(2),e.read_shift(2)];if(t[0]!==0&&t[0]--,t[1]!==0&&t[1]--,t[0]>7||t[1]>7)throw new Error("Bad Gutters: "+t.join("|"));return t}function Iw(e,t,r){var n=Os(e);(r.biff==2||t==9)&&++e.l;var s=e5(e);return n.val=s,n.t=s===!0||s===!1?"b":"e",n}function V5(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=Os(e),s=Lr(e);return n.val=s,n}var Cw=l5;function U5(e,t,r){var n=e.l+t,s=e.read_shift(2),a=e.read_shift(2);if(r.sbcch=a,a==1025||a==14849)return[a,s];if(a<1||a>255)throw new Error("Unexpected SupBook type: "+a);for(var i=Yi(e,a),o=[];n>e.l;)o.push(Vu(e));return[a,s,i,o]}function Rw(e,t,r){var n=e.read_shift(2),s,a={fBuiltIn:n&1,fWantAdvise:n>>>1&1,fWantPict:n>>>2&1,fOle:n>>>3&1,fOleLink:n>>>4&1,cf:n>>>5&1023,fIcon:n>>>15&1};return r.sbcch===14849&&(s=u5(e,t-2,r)),a.body=s||e.read_shift(t-2),typeof s=="string"&&(a.Name=s),a}var B5=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function Nw(e,t,r){var n=e.l+t,s=e.read_shift(2),a=e.read_shift(1),i=e.read_shift(1),o=e.read_shift(r&&r.biff==2?1:2),l=0;(!r||r.biff>=5)&&(r.biff!=5&&(e.l+=2),l=e.read_shift(2),r.biff==5&&(e.l+=2),e.l+=4);var c=Yi(e,i,r);s&32&&(c=B5[c.charCodeAt(0)]);var u=n-e.l;r&&r.biff==2&&--u;var h=n==e.l||o===0||!(u>0)?[]:EU(e,u,r,o);return{chKey:a,Name:c,itab:l,rgce:h}}function ZA(e,t,r){if(r.biff<8)return z5(e,t,r);for(var n=[],s=e.l+t,a=e.read_shift(r.biff>8?4:2);a--!==0;)n.push(c5(e,r.biff>8?12:6,r));if(e.l!=s)throw new Error("Bad ExternSheet: "+e.l+" != "+s);return n}function z5(e,t,r){e[e.l+1]==3&&e[e.l]++;var n=ju(e,t,r);return n.charCodeAt(0)==3?n.slice(1):n}function $5(e,t,r){if(r.biff<8){e.l+=t;return}var n=e.read_shift(2),s=e.read_shift(2),a=Yi(e,n,r),i=Yi(e,s,r);return[a,i]}function W5(e,t,r){var n=QA(e);e.l++;var s=e.read_shift(1);return t-=8,[TU(e,t,r),s,n]}function bw(e,t,r){var n=f5(e);switch(r.biff){case 2:e.l++,t-=7;break;case 3:case 4:e.l+=2,t-=8;break;default:e.l+=6,t-=12}return[n,yU(e,t,r)]}function H5(e){var t=e.read_shift(4)!==0,r=e.read_shift(4)!==0,n=e.read_shift(4);return[t,r,n]}function G5(e,t,r){if(!(r.biff<8)){var n=e.read_shift(2),s=e.read_shift(2),a=e.read_shift(2),i=e.read_shift(2),o=lo(e,0,r);return r.biff<8&&e.read_shift(1),[{r:n,c:s},o,i,a]}}function K5(e,t,r){return G5(e,t,r)}function q5(e,t){for(var r=[],n=e.read_shift(2);n--;)r.push(r0(e));return r}function X5(e,t,r){if(r&&r.biff<8)return Q5(e,t,r);var n=JA(e),s=p5(e,t-22,n[1]);return{cmo:n,ft:s}}var Y5={8:function(e,t){var r=e.l+t;e.l+=10;var n=e.read_shift(2);e.l+=4,e.l+=2,e.l+=2,e.l+=2,e.l+=4;var s=e.read_shift(1);return e.l+=s,e.l=r,{fmt:n}}};function Q5(e,t,r){e.l+=4;var n=e.read_shift(2),s=e.read_shift(2),a=e.read_shift(2);e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=6,t-=36;var i=[];return i.push((Y5[n]||$r)(e,t,r)),{cmo:[s,n,a],ft:i}}function J5(e,t,r){var n=e.l,s="";try{e.l+=4;var a=(r.lastobj||{cmo:[0,0]}).cmo[1],i;[0,5,7,11,12,14].indexOf(a)==-1?e.l+=6:i=r5(e,6,r);var o=e.read_shift(2);e.read_shift(2),Yt(e,2);var l=e.read_shift(2);e.l+=l;for(var c=1;c<e.lens.length-1;++c){if(e.l-n!=e.lens[c])throw new Error("TxO: bad continue record");var u=e[e.l],h=Yi(e,e.lens[c+1]-e.lens[c]-1);if(s+=h,s.length>=(u?o:2*o))break}if(s.length!==o&&s.length!==o*2)throw new Error("cchText: "+o+" != "+s.length);return e.l=n+t,{t:s}}catch{return e.l=n+t,{t:s}}}function Z5(e,t){var r=r0(e);e.l+=16;var n=i5(e,t-24);return[r,n]}function ej(e,t){e.read_shift(2);var r=r0(e),n=e.read_shift((t-10)/2,"dbcs-cont");return n=n.replace(Qr,""),[r,n]}function tj(e){var t=[0,0],r;return r=e.read_shift(2),t[0]=yw[r]||r,r=e.read_shift(2),t[1]=yw[r]||r,t}function rj(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(XA(e));return r}function nj(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(XA(e));return r}function sj(e){e.l+=2;var t={cxfs:0,crc:0};return t.cxfs=e.read_shift(2),t.crc=e.read_shift(4),t}function eI(e,t,r){if(!r.cellStyles)return $r(e,t);var n=r&&r.biff>=12?4:2,s=e.read_shift(n),a=e.read_shift(n),i=e.read_shift(n),o=e.read_shift(n),l=e.read_shift(2);n==2&&(e.l+=2);var c={s,e:a,w:i,ixfe:o,flags:l};return(r.biff>=5||!r.biff)&&(c.level=l>>8&7),c}function aj(e,t){var r={};return t<32||(e.l+=16,r.header=Lr(e),r.footer=Lr(e),e.l+=2),r}function ij(e,t,r){var n={area:!1};if(r.biff!=5)return e.l+=t,n;var s=e.read_shift(1);return e.l+=3,s&16&&(n.area=!0),n}var oj=Os,lj=KA,cj=Vu;function uj(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),s={fmt:t,env:r,len:n,data:e.slice(e.l,e.l+n)};return e.l+=n,s}function fj(e,t,r){r.biffguess&&r.biff==5&&(r.biff=2);var n=Os(e);++e.l;var s=lo(e,t-7,r);return n.t="str",n.val=s,n}function hj(e){var t=Os(e);++e.l;var r=Lr(e);return t.t="n",t.val=r,t}function dj(e){var t=Os(e);++e.l;var r=e.read_shift(2);return t.t="n",t.val=r,t}function mj(e){var t=e.read_shift(1);return t===0?(e.l++,""):e.read_shift(t,"sbcs-cont")}function pj(e,t){e.l+=6,e.l+=2,e.l+=1,e.l+=3,e.l+=1,e.l+=t-13}function gj(e,t,r){var n=e.l+t,s=Os(e),a=e.read_shift(2),i=Yi(e,a,r);return e.l=n,s.t="str",s.val=i,s}var vj=[2,3,48,49,131,139,140,245],Pw=function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},t=Qv({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(o,l){var c=[],u=li(1);switch(l.type){case"base64":u=ts(An(o));break;case"binary":u=ts(o);break;case"buffer":case"array":u=o;break}xr(u,0);var h=u.read_shift(1),m=!!(h&136),p=!1,x=!1;switch(h){case 2:break;case 3:break;case 48:p=!0,m=!0;break;case 49:p=!0,m=!0;break;case 131:break;case 139:break;case 140:x=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+h.toString(16))}var v=0,w=521;h==2&&(v=u.read_shift(2)),u.l+=3,h!=2&&(v=u.read_shift(4)),v>1048576&&(v=1e6),h!=2&&(w=u.read_shift(2));var k=u.read_shift(2),T=l.codepage||1252;h!=2&&(u.l+=16,u.read_shift(1),u[u.l]!==0&&(T=e[u[u.l]]),u.l+=1,u.l+=2),x&&(u.l+=36);for(var E=[],N={},O=Math.min(u.length,h==2?521:w-10-(p?264:0)),L=x?32:11;u.l<O&&u[u.l]!=13;)switch(N={},N.name=iu.utils.decode(T,u.slice(u.l,u.l+L)).replace(/[\u0000\r\n].*$/g,""),u.l+=L,N.type=String.fromCharCode(u.read_shift(1)),h!=2&&!x&&(N.offset=u.read_shift(4)),N.len=u.read_shift(1),h==2&&(N.offset=u.read_shift(2)),N.dec=u.read_shift(1),N.name.length&&E.push(N),h!=2&&(u.l+=x?13:14),N.type){case"B":(!p||N.len!=8)&&l.WTF&&console.log("Skipping "+N.name+":"+N.type);break;case"G":case"P":l.WTF&&console.log("Skipping "+N.name+":"+N.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+N.type)}if(u[u.l]!==13&&(u.l=w-1),u.read_shift(1)!==13)throw new Error("DBF Terminator not found "+u.l+" "+u[u.l]);u.l=w;var g=0,y=0;for(c[0]=[],y=0;y!=E.length;++y)c[0][y]=E[y].name;for(;v-- >0;){if(u[u.l]===42){u.l+=k;continue}for(++u.l,c[++g]=[],y=0,y=0;y!=E.length;++y){var S=u.slice(u.l,u.l+E[y].len);u.l+=E[y].len,xr(S,0);var R=iu.utils.decode(T,S);switch(E[y].type){case"C":R.trim().length&&(c[g][y]=R.replace(/\s+$/,""));break;case"D":R.length===8?c[g][y]=new Date(+R.slice(0,4),+R.slice(4,6)-1,+R.slice(6,8)):c[g][y]=R;break;case"F":c[g][y]=parseFloat(R.trim());break;case"+":case"I":c[g][y]=x?S.read_shift(-4,"i")^2147483648:S.read_shift(4,"i");break;case"L":switch(R.trim().toUpperCase()){case"Y":case"T":c[g][y]=!0;break;case"N":case"F":c[g][y]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+R+"|")}break;case"M":if(!m)throw new Error("DBF Unexpected MEMO for type "+h.toString(16));c[g][y]="##MEMO##"+(x?parseInt(R.trim(),10):S.read_shift(4));break;case"N":R=R.replace(/\u0000/g,"").trim(),R&&R!="."&&(c[g][y]=+R||0);break;case"@":c[g][y]=new Date(S.read_shift(-8,"f")-621356832e5);break;case"T":c[g][y]=new Date((S.read_shift(4)-2440588)*864e5+S.read_shift(4));break;case"Y":c[g][y]=S.read_shift(4,"i")/1e4+S.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":c[g][y]=-S.read_shift(-8,"f");break;case"B":if(p&&E[y].len==8){c[g][y]=S.read_shift(8,"f");break}case"G":case"P":S.l+=E[y].len;break;case"0":if(E[y].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+E[y].type)}}}if(h!=2&&u.l<u.length&&u[u.l++]!=26)throw new Error("DBF EOF Marker missing "+(u.l-1)+" of "+u.length+" "+u[u.l-1].toString(16));return l&&l.sheetRows&&(c=c.slice(0,l.sheetRows)),l.DBF=E,c}function n(o,l){var c=l||{};c.dateNF||(c.dateNF="yyyymmdd");var u=Al(r(o,c),c);return u["!cols"]=c.DBF.map(function(h){return{wch:h.len,DBF:h}}),delete c.DBF,u}function s(o,l){try{return gi(n(o,l),l)}catch(c){if(l&&l.WTF)throw c}return{SheetNames:[],Sheets:{}}}var a={B:8,C:250,L:1,D:8,"?":0,"":0};function i(o,l){var c=l||{};if(+c.codepage>=0&&ns(+c.codepage),c.type=="string")throw new Error("Cannot write DBF to JS string");var u=Pp(),h=zp(o,{header:1,raw:!0,cellDates:!0}),m=h[0],p=h.slice(1),x=o["!cols"]||[],v=0,w=0,k=0,T=1;for(v=0;v<m.length;++v){if(((x[v]||{}).DBF||{}).name){m[v]=x[v].DBF.name,++k;continue}if(m[v]!=null){if(++k,typeof m[v]=="number"&&(m[v]=m[v].toString(10)),typeof m[v]!="string")throw new Error("DBF Invalid column name "+m[v]+" |"+typeof m[v]+"|");if(m.indexOf(m[v])!==v){for(w=0;w<1024;++w)if(m.indexOf(m[v]+"_"+w)==-1){m[v]+="_"+w;break}}}}var E=Bt(o["!ref"]),N=[],O=[],L=[];for(v=0;v<=E.e.c-E.s.c;++v){var g="",y="",S=0,R=[];for(w=0;w<p.length;++w)p[w][v]!=null&&R.push(p[w][v]);if(R.length==0||m[v]==null){N[v]="?";continue}for(w=0;w<R.length;++w){switch(typeof R[w]){case"number":y="B";break;case"string":y="C";break;case"boolean":y="L";break;case"object":y=R[w]instanceof Date?"D":"C";break;default:y="C"}S=Math.max(S,String(R[w]).length),g=g&&g!=y?"C":y}S>250&&(S=250),y=((x[v]||{}).DBF||{}).type,y=="C"&&x[v].DBF.len>S&&(S=x[v].DBF.len),g=="B"&&y=="N"&&(g="N",L[v]=x[v].DBF.dec,S=x[v].DBF.len),O[v]=g=="C"||y=="N"?S:a[g]||0,T+=O[v],N[v]=g}var b=u.next(32);for(b.write_shift(4,318902576),b.write_shift(4,p.length),b.write_shift(2,296+32*k),b.write_shift(2,T),v=0;v<4;++v)b.write_shift(4,0);for(b.write_shift(4,0|(+t[ZS]||3)<<8),v=0,w=0;v<m.length;++v)if(m[v]!=null){var P=u.next(32),C=(m[v].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);P.write_shift(1,C,"sbcs"),P.write_shift(1,N[v]=="?"?"C":N[v],"sbcs"),P.write_shift(4,w),P.write_shift(1,O[v]||a[N[v]]||0),P.write_shift(1,L[v]||0),P.write_shift(1,2),P.write_shift(4,0),P.write_shift(1,0),P.write_shift(4,0),P.write_shift(4,0),w+=O[v]||a[N[v]]||0}var le=u.next(264);for(le.write_shift(4,13),v=0;v<65;++v)le.write_shift(4,0);for(v=0;v<p.length;++v){var se=u.next(T);for(se.write_shift(1,0),w=0;w<m.length;++w)if(m[w]!=null)switch(N[w]){case"L":se.write_shift(1,p[v][w]==null?63:p[v][w]?84:70);break;case"B":se.write_shift(8,p[v][w]||0,"f");break;case"N":var he="0";for(typeof p[v][w]=="number"&&(he=p[v][w].toFixed(L[w]||0)),k=0;k<O[w]-he.length;++k)se.write_shift(1,32);se.write_shift(1,he,"sbcs");break;case"D":p[v][w]?(se.write_shift(4,("0000"+p[v][w].getFullYear()).slice(-4),"sbcs"),se.write_shift(2,("00"+(p[v][w].getMonth()+1)).slice(-2),"sbcs"),se.write_shift(2,("00"+p[v][w].getDate()).slice(-2),"sbcs")):se.write_shift(8,"00000000","sbcs");break;case"C":var de=String(p[v][w]!=null?p[v][w]:"").slice(0,O[w]);for(se.write_shift(1,de,"sbcs"),k=0;k<O[w]-de.length;++k)se.write_shift(1,32);break}}return u.next(1).write_shift(1,26),u.end()}return{to_workbook:s,to_sheet:n,from_sheet:i}}(),xj=function(){var e={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},t=new RegExp("\x1BN("+Ns(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(m,p){var x=e[p];return typeof x=="number"?qy(x):x},n=function(m,p,x){var v=p.charCodeAt(0)-32<<4|x.charCodeAt(0)-48;return v==59?m:qy(v)};e["|"]=254;function s(m,p){switch(p.type){case"base64":return a(An(m),p);case"binary":return a(m,p);case"buffer":return a(Qe&&Buffer.isBuffer(m)?m.toString("binary"):so(m),p);case"array":return a(Xi(m),p)}throw new Error("Unrecognized type "+p.type)}function a(m,p){var x=m.split(/[\n\r]+/),v=-1,w=-1,k=0,T=0,E=[],N=[],O=null,L={},g=[],y=[],S=[],R=0,b;for(+p.codepage>=0&&ns(+p.codepage);k!==x.length;++k){R=0;var P=x[k].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(t,r),C=P.replace(/;;/g,"\0").split(";").map(function(G){return G.replace(/\u0000/g,";")}),le=C[0],se;if(P.length>0)switch(le){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":C[1].charAt(0)=="P"&&N.push(P.slice(3).replace(/;;/g,";"));break;case"C":var he=!1,de=!1,ie=!1,H=!1,ce=-1,ve=-1;for(T=1;T<C.length;++T)switch(C[T].charAt(0)){case"A":break;case"X":w=parseInt(C[T].slice(1))-1,de=!0;break;case"Y":for(v=parseInt(C[T].slice(1))-1,de||(w=0),b=E.length;b<=v;++b)E[b]=[];break;case"K":se=C[T].slice(1),se.charAt(0)==='"'?se=se.slice(1,se.length-1):se==="TRUE"?se=!0:se==="FALSE"?se=!1:isNaN(ls(se))?isNaN(ml(se).getDate())||(se=dr(se)):(se=ls(se),O!==null&&kl(O)&&(se=t0(se))),he=!0;break;case"E":H=!0;var B=qo(C[T].slice(1),{r:v,c:w});E[v][w]=[E[v][w],B];break;case"S":ie=!0,E[v][w]=[E[v][w],"S5S"];break;case"G":break;case"R":ce=parseInt(C[T].slice(1))-1;break;case"C":ve=parseInt(C[T].slice(1))-1;break;default:if(p&&p.WTF)throw new Error("SYLK bad record "+P)}if(he&&(E[v][w]&&E[v][w].length==2?E[v][w][0]=se:E[v][w]=se,O=null),ie){if(H)throw new Error("SYLK shared formula cannot have own formula");var K=ce>-1&&E[ce][ve];if(!K||!K[1])throw new Error("SYLK shared formula cannot find base");E[v][w][1]=uI(K[1],{r:v-ce,c:w-ve})}break;case"F":var q=0;for(T=1;T<C.length;++T)switch(C[T].charAt(0)){case"X":w=parseInt(C[T].slice(1))-1,++q;break;case"Y":for(v=parseInt(C[T].slice(1))-1,b=E.length;b<=v;++b)E[b]=[];break;case"M":R=parseInt(C[T].slice(1))/20;break;case"F":break;case"G":break;case"P":O=N[parseInt(C[T].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(S=C[T].slice(1).split(" "),b=parseInt(S[0],10);b<=parseInt(S[1],10);++b)R=parseInt(S[2],10),y[b-1]=R===0?{hidden:!0}:{wch:R},pl(y[b-1]);break;case"C":w=parseInt(C[T].slice(1))-1,y[w]||(y[w]={});break;case"R":v=parseInt(C[T].slice(1))-1,g[v]||(g[v]={}),R>0?(g[v].hpt=R,g[v].hpx=hu(R)):R===0&&(g[v].hidden=!0);break;default:if(p&&p.WTF)throw new Error("SYLK bad record "+P)}q<1&&(O=null);break;default:if(p&&p.WTF)throw new Error("SYLK bad record "+P)}}return g.length>0&&(L["!rows"]=g),y.length>0&&(L["!cols"]=y),p&&p.sheetRows&&(E=E.slice(0,p.sheetRows)),[E,L]}function i(m,p){var x=s(m,p),v=x[0],w=x[1],k=Al(v,p);return Ns(w).forEach(function(T){k[T]=w[T]}),k}function o(m,p){return gi(i(m,p),p)}function l(m,p,x,v){var w="C;Y"+(x+1)+";X"+(v+1)+";K";switch(m.t){case"n":w+=m.v||0,m.f&&!m.F&&(w+=";E"+sV(m.f,{r:x,c:v}));break;case"b":w+=m.v?"TRUE":"FALSE";break;case"e":w+=m.w||m.v;break;case"d":w+='"'+(m.w||m.v)+'"';break;case"s":w+='"'+m.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return w}function c(m,p){p.forEach(function(x,v){var w="F;W"+(v+1)+" "+(v+1)+" ";x.hidden?w+="0":(typeof x.width=="number"&&!x.wpx&&(x.wpx=od(x.width)),typeof x.wpx=="number"&&!x.wch&&(x.wch=ld(x.wpx)),typeof x.wch=="number"&&(w+=Math.round(x.wch))),w.charAt(w.length-1)!=" "&&m.push(w)})}function u(m,p){p.forEach(function(x,v){var w="F;";x.hidden?w+="M0;":x.hpt?w+="M"+20*x.hpt+";":x.hpx&&(w+="M"+20*oI(x.hpx)+";"),w.length>2&&m.push(w+"R"+(v+1))})}function h(m,p){var x=["ID;PWXL;N;E"],v=[],w=Bt(m["!ref"]),k,T=Array.isArray(m),E=`\r
`;x.push("P;PGeneral"),x.push("F;P0;DG0G8;M255"),m["!cols"]&&c(x,m["!cols"]),m["!rows"]&&u(x,m["!rows"]),x.push("B;Y"+(w.e.r-w.s.r+1)+";X"+(w.e.c-w.s.c+1)+";D"+[w.s.c,w.s.r,w.e.c,w.e.r].join(" "));for(var N=w.s.r;N<=w.e.r;++N)for(var O=w.s.c;O<=w.e.c;++O){var L=Ue({r:N,c:O});k=T?(m[N]||[])[O]:m[L],!(!k||k.v==null&&(!k.f||k.F))&&v.push(l(k,m,N,O))}return x.join(E)+E+v.join(E)+E+"E"+E}return{to_workbook:o,to_sheet:i,from_sheet:h}}(),_j=function(){function e(a,i){switch(i.type){case"base64":return t(An(a),i);case"binary":return t(a,i);case"buffer":return t(Qe&&Buffer.isBuffer(a)?a.toString("binary"):so(a),i);case"array":return t(Xi(a),i)}throw new Error("Unrecognized type "+i.type)}function t(a,i){for(var o=a.split(`
`),l=-1,c=-1,u=0,h=[];u!==o.length;++u){if(o[u].trim()==="BOT"){h[++l]=[],c=0;continue}if(!(l<0)){var m=o[u].trim().split(","),p=m[0],x=m[1];++u;for(var v=o[u]||"";(v.match(/["]/g)||[]).length&1&&u<o.length-1;)v+=`
`+o[++u];switch(v=v.trim(),+p){case-1:if(v==="BOT"){h[++l]=[],c=0;continue}else if(v!=="EOD")throw new Error("Unrecognized DIF special command "+v);break;case 0:v==="TRUE"?h[l][c]=!0:v==="FALSE"?h[l][c]=!1:isNaN(ls(x))?isNaN(ml(x).getDate())?h[l][c]=x:h[l][c]=dr(x):h[l][c]=ls(x),++c;break;case 1:v=v.slice(1,v.length-1),v=v.replace(/""/g,'"'),v&&v.match(/^=".*"$/)&&(v=v.slice(2,-1)),h[l][c++]=v!==""?v:null;break}if(v==="EOD")break}}return i&&i.sheetRows&&(h=h.slice(0,i.sheetRows)),h}function r(a,i){return Al(e(a,i),i)}function n(a,i){return gi(r(a,i),i)}var s=function(){var a=function(l,c,u,h,m){l.push(c),l.push(u+","+h),l.push('"'+m.replace(/"/g,'""')+'"')},i=function(l,c,u,h){l.push(c+","+u),l.push(c==1?'"'+h.replace(/"/g,'""')+'"':h)};return function(l){var c=[],u=Bt(l["!ref"]),h,m=Array.isArray(l);a(c,"TABLE",0,1,"sheetjs"),a(c,"VECTORS",0,u.e.r-u.s.r+1,""),a(c,"TUPLES",0,u.e.c-u.s.c+1,""),a(c,"DATA",0,0,"");for(var p=u.s.r;p<=u.e.r;++p){i(c,-1,0,"BOT");for(var x=u.s.c;x<=u.e.c;++x){var v=Ue({r:p,c:x});if(h=m?(l[p]||[])[x]:l[v],!h){i(c,1,0,"");continue}switch(h.t){case"n":var w=h.w;!w&&h.v!=null&&(w=h.v),w==null?h.f&&!h.F?i(c,1,0,"="+h.f):i(c,1,0,""):i(c,0,w,"V");break;case"b":i(c,0,h.v?1:0,h.v?"TRUE":"FALSE");break;case"s":i(c,1,0,isNaN(h.v)?h.v:'="'+h.v+'"');break;case"d":h.w||(h.w=$n(h.z||ze[14],Jr(dr(h.v)))),i(c,0,h.w,"V");break;default:i(c,1,0,"")}}}i(c,-1,0,"EOD");var k=`\r
`,T=c.join(k);return T}}();return{to_workbook:n,to_sheet:r,from_sheet:s}}(),yj=function(){function e(h){return h.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function t(h){return h.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(h,m){for(var p=h.split(`
`),x=-1,v=-1,w=0,k=[];w!==p.length;++w){var T=p[w].trim().split(":");if(T[0]==="cell"){var E=qr(T[1]);if(k.length<=E.r)for(x=k.length;x<=E.r;++x)k[x]||(k[x]=[]);switch(x=E.r,v=E.c,T[2]){case"t":k[x][v]=e(T[3]);break;case"v":k[x][v]=+T[3];break;case"vtf":var N=T[T.length-1];case"vtc":switch(T[3]){case"nl":k[x][v]=!!+T[4];break;default:k[x][v]=+T[4];break}T[2]=="vtf"&&(k[x][v]=[k[x][v],N])}}}return m&&m.sheetRows&&(k=k.slice(0,m.sheetRows)),k}function n(h,m){return Al(r(h,m),m)}function s(h,m){return gi(n(h,m),m)}var a=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),i=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,o=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),l="--SocialCalcSpreadsheetControlSave--";function c(h){if(!h||!h["!ref"])return"";for(var m=[],p=[],x,v="",w=Sl(h["!ref"]),k=Array.isArray(h),T=w.s.r;T<=w.e.r;++T)for(var E=w.s.c;E<=w.e.c;++E)if(v=Ue({r:T,c:E}),x=k?(h[T]||[])[E]:h[v],!(!x||x.v==null||x.t==="z")){switch(p=["cell",v,"t"],x.t){case"s":case"str":p.push(t(x.v));break;case"n":x.f?(p[2]="vtf",p[3]="n",p[4]=x.v,p[5]=t(x.f)):(p[2]="v",p[3]=x.v);break;case"b":p[2]="vt"+(x.f?"f":"c"),p[3]="nl",p[4]=x.v?"1":"0",p[5]=t(x.f||(x.v?"TRUE":"FALSE"));break;case"d":var N=Jr(dr(x.v));p[2]="vtc",p[3]="nd",p[4]=""+N,p[5]=x.w||$n(x.z||ze[14],N);break;case"e":continue}m.push(p.join(":"))}return m.push("sheet:c:"+(w.e.c-w.s.c+1)+":r:"+(w.e.r-w.s.r+1)+":tvf:1"),m.push("valueformat:1:text-wiki"),m.join(`
`)}function u(h){return[a,i,o,i,c(h),l].join(`
`)}return{to_workbook:s,to_sheet:n,from_sheet:u}}(),uu=function(){function e(u,h,m,p,x){x.raw?h[m][p]=u:u===""||(u==="TRUE"?h[m][p]=!0:u==="FALSE"?h[m][p]=!1:isNaN(ls(u))?isNaN(ml(u).getDate())?h[m][p]=u:h[m][p]=dr(u):h[m][p]=ls(u))}function t(u,h){var m=h||{},p=[];if(!u||u.length===0)return p;for(var x=u.split(/[\r\n]/),v=x.length-1;v>=0&&x[v].length===0;)--v;for(var w=10,k=0,T=0;T<=v;++T)k=x[T].indexOf(" "),k==-1?k=x[T].length:k++,w=Math.max(w,k);for(T=0;T<=v;++T){p[T]=[];var E=0;for(e(x[T].slice(0,w).trim(),p,T,E,m),E=1;E<=(x[T].length-w)/10+1;++E)e(x[T].slice(w+(E-1)*10,w+E*10).trim(),p,T,E,m)}return m.sheetRows&&(p=p.slice(0,m.sheetRows)),p}var r={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function s(u){for(var h={},m=!1,p=0,x=0;p<u.length;++p)(x=u.charCodeAt(p))==34?m=!m:!m&&x in r&&(h[x]=(h[x]||0)+1);x=[];for(p in h)Object.prototype.hasOwnProperty.call(h,p)&&x.push([h[p],p]);if(!x.length){h=n;for(p in h)Object.prototype.hasOwnProperty.call(h,p)&&x.push([h[p],p])}return x.sort(function(v,w){return v[0]-w[0]||n[v[1]]-n[w[1]]}),r[x.pop()[1]]||44}function a(u,h){var m=h||{},p="",x=m.dense?[]:{},v={s:{c:0,r:0},e:{c:0,r:0}};u.slice(0,4)=="sep="?u.charCodeAt(5)==13&&u.charCodeAt(6)==10?(p=u.charAt(4),u=u.slice(7)):u.charCodeAt(5)==13||u.charCodeAt(5)==10?(p=u.charAt(4),u=u.slice(6)):p=s(u.slice(0,1024)):m&&m.FS?p=m.FS:p=s(u.slice(0,1024));var w=0,k=0,T=0,E=0,N=0,O=p.charCodeAt(0),L=!1,g=0,y=u.charCodeAt(0);u=u.replace(/\r\n/mg,`
`);var S=m.dateNF!=null?b6(m.dateNF):null;function R(){var b=u.slice(E,N),P={};if(b.charAt(0)=='"'&&b.charAt(b.length-1)=='"'&&(b=b.slice(1,-1).replace(/""/g,'"')),b.length===0)P.t="z";else if(m.raw)P.t="s",P.v=b;else if(b.trim().length===0)P.t="s",P.v=b;else if(b.charCodeAt(0)==61)b.charCodeAt(1)==34&&b.charCodeAt(b.length-1)==34?(P.t="s",P.v=b.slice(2,-1).replace(/""/g,'"')):iV(b)?(P.t="n",P.f=b.slice(1)):(P.t="s",P.v=b);else if(b=="TRUE")P.t="b",P.v=!0;else if(b=="FALSE")P.t="b",P.v=!1;else if(!isNaN(T=ls(b)))P.t="n",m.cellText!==!1&&(P.w=b),P.v=T;else if(!isNaN(ml(b).getDate())||S&&b.match(S)){P.z=m.dateNF||ze[14];var C=0;S&&b.match(S)&&(b=P6(b,m.dateNF,b.match(S)||[]),C=1),m.cellDates?(P.t="d",P.v=dr(b,C)):(P.t="n",P.v=Jr(dr(b,C))),m.cellText!==!1&&(P.w=$n(P.z,P.v instanceof Date?Jr(P.v):P.v)),m.cellNF||delete P.z}else P.t="s",P.v=b;if(P.t=="z"||(m.dense?(x[w]||(x[w]=[]),x[w][k]=P):x[Ue({c:k,r:w})]=P),E=N+1,y=u.charCodeAt(E),v.e.c<k&&(v.e.c=k),v.e.r<w&&(v.e.r=w),g==O)++k;else if(k=0,++w,m.sheetRows&&m.sheetRows<=w)return!0}e:for(;N<u.length;++N)switch(g=u.charCodeAt(N)){case 34:y===34&&(L=!L);break;case O:case 10:case 13:if(!L&&R())break e;break}return N-E>0&&R(),x["!ref"]=rt(v),x}function i(u,h){return!(h&&h.PRN)||h.FS||u.slice(0,4)=="sep="||u.indexOf("	")>=0||u.indexOf(",")>=0||u.indexOf(";")>=0?a(u,h):Al(t(u,h),h)}function o(u,h){var m="",p=h.type=="string"?[0,0,0,0]:gx(u,h);switch(h.type){case"base64":m=An(u);break;case"binary":m=u;break;case"buffer":h.codepage==65001?m=u.toString("utf8"):h.codepage&&typeof iu<"u"||(m=Qe&&Buffer.isBuffer(u)?u.toString("binary"):so(u));break;case"array":m=Xi(u);break;case"string":m=u;break;default:throw new Error("Unrecognized type "+h.type)}return p[0]==239&&p[1]==187&&p[2]==191?m=Et(m.slice(3)):h.type!="string"&&h.type!="buffer"&&h.codepage==65001?m=Et(m):h.type=="binary"&&typeof iu<"u",m.slice(0,19)=="socialcalc:version:"?yj.to_sheet(h.type=="string"?m:Et(m),h):i(m,h)}function l(u,h){return gi(o(u,h),h)}function c(u){for(var h=[],m=Bt(u["!ref"]),p,x=Array.isArray(u),v=m.s.r;v<=m.e.r;++v){for(var w=[],k=m.s.c;k<=m.e.c;++k){var T=Ue({r:v,c:k});if(p=x?(u[v]||[])[k]:u[T],!p||p.v==null){w.push("          ");continue}for(var E=(p.w||(ga(p),p.w)||"").slice(0,10);E.length<10;)E+=" ";w.push(E+(k===0?" ":""))}h.push(w.join(""))}return h.join(`
`)}return{to_workbook:l,to_sheet:o,from_sheet:c}}();function wj(e,t){var r=t||{},n=!!r.WTF;r.WTF=!0;try{var s=xj.to_workbook(e,r);return r.WTF=n,s}catch(a){if(r.WTF=n,!a.message.match(/SYLK bad record ID/)&&n)throw a;return uu.to_workbook(e,t)}}var Ic=function(){function e(B,K,q){if(B){xr(B,B.l||0);for(var G=q.Enum||ce;B.l<B.length;){var oe=B.read_shift(2),xe=G[oe]||G[65535],Ce=B.read_shift(2),Te=B.l+Ce,_e=xe.f&&xe.f(B,Ce,q);if(B.l=Te,K(_e,xe,oe))return}}}function t(B,K){switch(K.type){case"base64":return r(ts(An(B)),K);case"binary":return r(ts(B),K);case"buffer":case"array":return r(B,K)}throw"Unsupported type "+K.type}function r(B,K){if(!B)return B;var q=K||{},G=q.dense?[]:{},oe="Sheet1",xe="",Ce=0,Te={},_e=[],$e=[],z={s:{r:0,c:0},e:{r:0,c:0}},ot=q.sheetRows||0;if(B[2]==0&&(B[3]==8||B[3]==9)&&B.length>=16&&B[14]==5&&B[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(B[2]==2)q.Enum=ce,e(B,function(Ae,Tt,or){switch(or){case 0:q.vers=Ae,Ae>=4096&&(q.qpro=!0);break;case 6:z=Ae;break;case 204:Ae&&(xe=Ae);break;case 222:xe=Ae;break;case 15:case 51:q.qpro||(Ae[1].v=Ae[1].v.slice(1));case 13:case 14:case 16:or==14&&(Ae[2]&112)==112&&(Ae[2]&15)>1&&(Ae[2]&15)<15&&(Ae[1].z=q.dateNF||ze[14],q.cellDates&&(Ae[1].t="d",Ae[1].v=t0(Ae[1].v))),q.qpro&&Ae[3]>Ce&&(G["!ref"]=rt(z),Te[oe]=G,_e.push(oe),G=q.dense?[]:{},z={s:{r:0,c:0},e:{r:0,c:0}},Ce=Ae[3],oe=xe||"Sheet"+(Ce+1),xe="");var Ar=q.dense?(G[Ae[0].r]||[])[Ae[0].c]:G[Ue(Ae[0])];if(Ar){Ar.t=Ae[1].t,Ar.v=Ae[1].v,Ae[1].z!=null&&(Ar.z=Ae[1].z),Ae[1].f!=null&&(Ar.f=Ae[1].f);break}q.dense?(G[Ae[0].r]||(G[Ae[0].r]=[]),G[Ae[0].r][Ae[0].c]=Ae[1]):G[Ue(Ae[0])]=Ae[1];break}},q);else if(B[2]==26||B[2]==14)q.Enum=ve,B[2]==14&&(q.qpro=!0,B.l=0),e(B,function(Ae,Tt,or){switch(or){case 204:oe=Ae;break;case 22:Ae[1].v=Ae[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(Ae[3]>Ce&&(G["!ref"]=rt(z),Te[oe]=G,_e.push(oe),G=q.dense?[]:{},z={s:{r:0,c:0},e:{r:0,c:0}},Ce=Ae[3],oe="Sheet"+(Ce+1)),ot>0&&Ae[0].r>=ot)break;q.dense?(G[Ae[0].r]||(G[Ae[0].r]=[]),G[Ae[0].r][Ae[0].c]=Ae[1]):G[Ue(Ae[0])]=Ae[1],z.e.c<Ae[0].c&&(z.e.c=Ae[0].c),z.e.r<Ae[0].r&&(z.e.r=Ae[0].r);break;case 27:Ae[14e3]&&($e[Ae[14e3][0]]=Ae[14e3][1]);break;case 1537:$e[Ae[0]]=Ae[1],Ae[0]==Ce&&(oe=Ae[1]);break}},q);else throw new Error("Unrecognized LOTUS BOF "+B[2]);if(G["!ref"]=rt(z),Te[xe||oe]=G,_e.push(xe||oe),!$e.length)return{SheetNames:_e,Sheets:Te};for(var He={},nt=[],Fe=0;Fe<$e.length;++Fe)Te[_e[Fe]]?(nt.push($e[Fe]||_e[Fe]),He[$e[Fe]]=Te[$e[Fe]]||Te[_e[Fe]]):(nt.push($e[Fe]),He[$e[Fe]]={"!ref":"A1"});return{SheetNames:nt,Sheets:He}}function n(B,K){var q=K||{};if(+q.codepage>=0&&ns(+q.codepage),q.type=="string")throw new Error("Cannot write WK1 to JS string");var G=Pp(),oe=Bt(B["!ref"]),xe=Array.isArray(B),Ce=[];Xn(G,0,a(1030)),Xn(G,6,l(oe));for(var Te=Math.min(oe.e.r,8191),_e=oe.s.r;_e<=Te;++_e)for(var $e=Tr(_e),z=oe.s.c;z<=oe.e.c;++z){_e===oe.s.r&&(Ce[z]=sr(z));var ot=Ce[z]+$e,He=xe?(B[_e]||[])[z]:B[ot];if(!(!He||He.t=="z"))if(He.t=="n")(He.v|0)==He.v&&He.v>=-32768&&He.v<=32767?Xn(G,13,p(_e,z,He.v)):Xn(G,14,v(_e,z,He.v));else{var nt=ga(He);Xn(G,15,h(_e,z,nt.slice(0,239)))}}return Xn(G,1),G.end()}function s(B,K){var q=K||{};if(+q.codepage>=0&&ns(+q.codepage),q.type=="string")throw new Error("Cannot write WK3 to JS string");var G=Pp();Xn(G,0,i(B));for(var oe=0,xe=0;oe<B.SheetNames.length;++oe)(B.Sheets[B.SheetNames[oe]]||{})["!ref"]&&Xn(G,27,H(B.SheetNames[oe],xe++));var Ce=0;for(oe=0;oe<B.SheetNames.length;++oe){var Te=B.Sheets[B.SheetNames[oe]];if(!(!Te||!Te["!ref"])){for(var _e=Bt(Te["!ref"]),$e=Array.isArray(Te),z=[],ot=Math.min(_e.e.r,8191),He=_e.s.r;He<=ot;++He)for(var nt=Tr(He),Fe=_e.s.c;Fe<=_e.e.c;++Fe){He===_e.s.r&&(z[Fe]=sr(Fe));var Ae=z[Fe]+nt,Tt=$e?(Te[He]||[])[Fe]:Te[Ae];if(!(!Tt||Tt.t=="z"))if(Tt.t=="n")Xn(G,23,R(He,Fe,Ce,Tt.v));else{var or=ga(Tt);Xn(G,22,g(He,Fe,Ce,or.slice(0,239)))}}++Ce}}return Xn(G,1),G.end()}function a(B){var K=tr(2);return K.write_shift(2,B),K}function i(B){var K=tr(26);K.write_shift(2,4096),K.write_shift(2,4),K.write_shift(4,0);for(var q=0,G=0,oe=0,xe=0;xe<B.SheetNames.length;++xe){var Ce=B.SheetNames[xe],Te=B.Sheets[Ce];if(!(!Te||!Te["!ref"])){++oe;var _e=Sl(Te["!ref"]);q<_e.e.r&&(q=_e.e.r),G<_e.e.c&&(G=_e.e.c)}}return q>8191&&(q=8191),K.write_shift(2,q),K.write_shift(1,oe),K.write_shift(1,G),K.write_shift(2,0),K.write_shift(2,0),K.write_shift(1,1),K.write_shift(1,2),K.write_shift(4,0),K.write_shift(4,0),K}function o(B,K,q){var G={s:{c:0,r:0},e:{c:0,r:0}};return K==8&&q.qpro?(G.s.c=B.read_shift(1),B.l++,G.s.r=B.read_shift(2),G.e.c=B.read_shift(1),B.l++,G.e.r=B.read_shift(2),G):(G.s.c=B.read_shift(2),G.s.r=B.read_shift(2),K==12&&q.qpro&&(B.l+=2),G.e.c=B.read_shift(2),G.e.r=B.read_shift(2),K==12&&q.qpro&&(B.l+=2),G.s.c==65535&&(G.s.c=G.e.c=G.s.r=G.e.r=0),G)}function l(B){var K=tr(8);return K.write_shift(2,B.s.c),K.write_shift(2,B.s.r),K.write_shift(2,B.e.c),K.write_shift(2,B.e.r),K}function c(B,K,q){var G=[{c:0,r:0},{t:"n",v:0},0,0];return q.qpro&&q.vers!=20768?(G[0].c=B.read_shift(1),G[3]=B.read_shift(1),G[0].r=B.read_shift(2),B.l+=2):(G[2]=B.read_shift(1),G[0].c=B.read_shift(2),G[0].r=B.read_shift(2)),G}function u(B,K,q){var G=B.l+K,oe=c(B,K,q);if(oe[1].t="s",q.vers==20768){B.l++;var xe=B.read_shift(1);return oe[1].v=B.read_shift(xe,"utf8"),oe}return q.qpro&&B.l++,oe[1].v=B.read_shift(G-B.l,"cstr"),oe}function h(B,K,q){var G=tr(7+q.length);G.write_shift(1,255),G.write_shift(2,K),G.write_shift(2,B),G.write_shift(1,39);for(var oe=0;oe<G.length;++oe){var xe=q.charCodeAt(oe);G.write_shift(1,xe>=128?95:xe)}return G.write_shift(1,0),G}function m(B,K,q){var G=c(B,K,q);return G[1].v=B.read_shift(2,"i"),G}function p(B,K,q){var G=tr(7);return G.write_shift(1,255),G.write_shift(2,K),G.write_shift(2,B),G.write_shift(2,q,"i"),G}function x(B,K,q){var G=c(B,K,q);return G[1].v=B.read_shift(8,"f"),G}function v(B,K,q){var G=tr(13);return G.write_shift(1,255),G.write_shift(2,K),G.write_shift(2,B),G.write_shift(8,q,"f"),G}function w(B,K,q){var G=B.l+K,oe=c(B,K,q);if(oe[1].v=B.read_shift(8,"f"),q.qpro)B.l=G;else{var xe=B.read_shift(2);N(B.slice(B.l,B.l+xe),oe),B.l+=xe}return oe}function k(B,K,q){var G=K&32768;return K&=-32769,K=(G?B:0)+(K>=8192?K-16384:K),(G?"":"$")+(q?sr(K):Tr(K))}var T={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},E=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function N(B,K){xr(B,0);for(var q=[],G=0,oe="",xe="",Ce="",Te="";B.l<B.length;){var _e=B[B.l++];switch(_e){case 0:q.push(B.read_shift(8,"f"));break;case 1:xe=k(K[0].c,B.read_shift(2),!0),oe=k(K[0].r,B.read_shift(2),!1),q.push(xe+oe);break;case 2:{var $e=k(K[0].c,B.read_shift(2),!0),z=k(K[0].r,B.read_shift(2),!1);xe=k(K[0].c,B.read_shift(2),!0),oe=k(K[0].r,B.read_shift(2),!1),q.push($e+z+":"+xe+oe)}break;case 3:if(B.l<B.length){console.error("WK1 premature formula end");return}break;case 4:q.push("("+q.pop()+")");break;case 5:q.push(B.read_shift(2));break;case 6:{for(var ot="";_e=B[B.l++];)ot+=String.fromCharCode(_e);q.push('"'+ot.replace(/"/g,'""')+'"')}break;case 8:q.push("-"+q.pop());break;case 23:q.push("+"+q.pop());break;case 22:q.push("NOT("+q.pop()+")");break;case 20:case 21:Te=q.pop(),Ce=q.pop(),q.push(["AND","OR"][_e-20]+"("+Ce+","+Te+")");break;default:if(_e<32&&E[_e])Te=q.pop(),Ce=q.pop(),q.push(Ce+E[_e]+Te);else if(T[_e]){if(G=T[_e][1],G==69&&(G=B[B.l++]),G>q.length){console.error("WK1 bad formula parse 0x"+_e.toString(16)+":|"+q.join("|")+"|");return}var He=q.slice(-G);q.length-=G,q.push(T[_e][0]+"("+He.join(",")+")")}else return _e<=7?console.error("WK1 invalid opcode "+_e.toString(16)):_e<=24?console.error("WK1 unsupported op "+_e.toString(16)):_e<=30?console.error("WK1 invalid opcode "+_e.toString(16)):_e<=115?console.error("WK1 unsupported function opcode "+_e.toString(16)):console.error("WK1 unrecognized opcode "+_e.toString(16))}}q.length==1?K[1].f=""+q[0]:console.error("WK1 bad formula parse |"+q.join("|")+"|")}function O(B){var K=[{c:0,r:0},{t:"n",v:0},0];return K[0].r=B.read_shift(2),K[3]=B[B.l++],K[0].c=B[B.l++],K}function L(B,K){var q=O(B);return q[1].t="s",q[1].v=B.read_shift(K-4,"cstr"),q}function g(B,K,q,G){var oe=tr(6+G.length);oe.write_shift(2,B),oe.write_shift(1,q),oe.write_shift(1,K),oe.write_shift(1,39);for(var xe=0;xe<G.length;++xe){var Ce=G.charCodeAt(xe);oe.write_shift(1,Ce>=128?95:Ce)}return oe.write_shift(1,0),oe}function y(B,K){var q=O(B);q[1].v=B.read_shift(2);var G=q[1].v>>1;if(q[1].v&1)switch(G&7){case 0:G=(G>>3)*5e3;break;case 1:G=(G>>3)*500;break;case 2:G=(G>>3)/20;break;case 3:G=(G>>3)/200;break;case 4:G=(G>>3)/2e3;break;case 5:G=(G>>3)/2e4;break;case 6:G=(G>>3)/16;break;case 7:G=(G>>3)/64;break}return q[1].v=G,q}function S(B,K){var q=O(B),G=B.read_shift(4),oe=B.read_shift(4),xe=B.read_shift(2);if(xe==65535)return G===0&&oe===3221225472?(q[1].t="e",q[1].v=15):G===0&&oe===3489660928?(q[1].t="e",q[1].v=42):q[1].v=0,q;var Ce=xe&32768;return xe=(xe&32767)-16446,q[1].v=(1-Ce*2)*(oe*Math.pow(2,xe+32)+G*Math.pow(2,xe)),q}function R(B,K,q,G){var oe=tr(14);if(oe.write_shift(2,B),oe.write_shift(1,q),oe.write_shift(1,K),G==0)return oe.write_shift(4,0),oe.write_shift(4,0),oe.write_shift(2,65535),oe;var xe=0,Ce=0,Te=0,_e=0;return G<0&&(xe=1,G=-G),Ce=Math.log2(G)|0,G/=Math.pow(2,Ce-31),_e=G>>>0,_e&2147483648||(G/=2,++Ce,_e=G>>>0),G-=_e,_e|=2147483648,_e>>>=0,G*=Math.pow(2,32),Te=G>>>0,oe.write_shift(4,Te),oe.write_shift(4,_e),Ce+=16383+(xe?32768:0),oe.write_shift(2,Ce),oe}function b(B,K){var q=S(B);return B.l+=K-14,q}function P(B,K){var q=O(B),G=B.read_shift(4);return q[1].v=G>>6,q}function C(B,K){var q=O(B),G=B.read_shift(8,"f");return q[1].v=G,q}function le(B,K){var q=C(B);return B.l+=K-10,q}function se(B,K){return B[B.l+K-1]==0?B.read_shift(K,"cstr"):""}function he(B,K){var q=B[B.l++];q>K-1&&(q=K-1);for(var G="";G.length<q;)G+=String.fromCharCode(B[B.l++]);return G}function de(B,K,q){if(!(!q.qpro||K<21)){var G=B.read_shift(1);B.l+=17,B.l+=1,B.l+=2;var oe=B.read_shift(K-21,"cstr");return[G,oe]}}function ie(B,K){for(var q={},G=B.l+K;B.l<G;){var oe=B.read_shift(2);if(oe==14e3){for(q[oe]=[0,""],q[oe][0]=B.read_shift(2);B[B.l];)q[oe][1]+=String.fromCharCode(B[B.l]),B.l++;B.l++}}return q}function H(B,K){var q=tr(5+B.length);q.write_shift(2,14e3),q.write_shift(2,K);for(var G=0;G<B.length;++G){var oe=B.charCodeAt(G);q[q.l++]=oe>127?95:oe}return q[q.l++]=0,q}var ce={0:{n:"BOF",f:Yt},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:o},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:m},14:{n:"NUMBER",f:x},15:{n:"LABEL",f:u},16:{n:"FORMULA",f:w},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:u},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:se},222:{n:"SHEETNAMELP",f:he},65535:{n:""}},ve={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:L},23:{n:"NUMBER17",f:S},24:{n:"NUMBER18",f:y},25:{n:"FORMULA19",f:b},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:ie},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:P},38:{n:"??"},39:{n:"NUMBER27",f:C},40:{n:"FORMULA28",f:le},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:se},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:de},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:n,book_to_wk3:s,to_workbook:t}}();function Ej(e){var t={},r=e.match(Wr),n=0,s=!1;if(r)for(;n!=r.length;++n){var a=Oe(r[n]);switch(a[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!a.val)break;case"<shadow>":case"<shadow/>":t.shadow=1;break;case"</shadow>":break;case"<charset":if(a.val=="1")break;t.cp=Gv[parseInt(a.val,10)];break;case"<outline":if(!a.val)break;case"<outline>":case"<outline/>":t.outline=1;break;case"</outline>":break;case"<rFont":t.name=a.val;break;case"<sz":t.sz=a.val;break;case"<strike":if(!a.val)break;case"<strike>":case"<strike/>":t.strike=1;break;case"</strike>":break;case"<u":if(!a.val)break;switch(a.val){case"double":t.uval="double";break;case"singleAccounting":t.uval="single-accounting";break;case"doubleAccounting":t.uval="double-accounting";break}case"<u>":case"<u/>":t.u=1;break;case"</u>":break;case"<b":if(a.val=="0")break;case"<b>":case"<b/>":t.b=1;break;case"</b>":break;case"<i":if(a.val=="0")break;case"<i>":case"<i/>":t.i=1;break;case"</i>":break;case"<color":a.rgb&&(t.color=a.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":t.family=a.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":t.valign=a.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(a[0].charCodeAt(1)!==47&&!s)throw new Error("Unrecognized rich format "+a[0])}}return t}var Tj=function(){var e=lu("t"),t=lu("rPr");function r(a){var i=a.match(e);if(!i)return{t:"s",v:""};var o={t:"s",v:it(i[1])},l=a.match(t);return l&&(o.s=Ej(l[1])),o}var n=/<(?:\w+:)?r>/g,s=/<\/(?:\w+:)?r>/;return function(i){return i.replace(n,"").split(s).map(r).filter(function(o){return o.v})}}(),kj=function(){var t=/(\r\n|\n)/g;function r(s,a,i){var o=[];s.u&&o.push("text-decoration: underline;"),s.uval&&o.push("text-underline-style:"+s.uval+";"),s.sz&&o.push("font-size:"+s.sz+"pt;"),s.outline&&o.push("text-effect: outline;"),s.shadow&&o.push("text-shadow: auto;"),a.push('<span style="'+o.join("")+'">'),s.b&&(a.push("<b>"),i.push("</b>")),s.i&&(a.push("<i>"),i.push("</i>")),s.strike&&(a.push("<s>"),i.push("</s>"));var l=s.valign||"";return l=="superscript"||l=="super"?l="sup":l=="subscript"&&(l="sub"),l!=""&&(a.push("<"+l+">"),i.push("</"+l+">")),i.push("</span>"),s}function n(s){var a=[[],s.v,[]];return s.v?(s.s&&r(s.s,a[0],a[2]),a[0].join("")+a[1].replace(t,"<br/>")+a[2].join("")):""}return function(a){return a.map(n).join("")}}(),Sj=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,Aj=/<(?:\w+:)?r>/,Ij=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function cx(e,t){var r=t?t.cellHTML:!0,n={};return e?(e.match(/^\s*<(?:\w+:)?t[^>]*>/)?(n.t=it(Et(e.slice(e.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),n.r=Et(e),r&&(n.h=Zv(n.t))):e.match(Aj)&&(n.r=Et(e),n.t=it(Et((e.replace(Ij,"").match(Sj)||[]).join("").replace(Wr,""))),r&&(n.h=kj(Tj(n.r)))),n):{t:""}}var Cj=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,Rj=/<(?:\w+:)?(?:si|sstItem)>/g,Nj=/<\/(?:\w+:)?(?:si|sstItem)>/;function bj(e,t){var r=[],n="";if(!e)return r;var s=e.match(Cj);if(s){n=s[2].replace(Rj,"").split(Nj);for(var a=0;a!=n.length;++a){var i=cx(n[a].trim(),t);i!=null&&(r[r.length]=i)}s=Oe(s[1]),r.Count=s.count,r.Unique=s.uniqueCount}return r}function Pj(e){return[e.read_shift(4),e.read_shift(4)]}function Dj(e,t){var r=[],n=!1;return ya(e,function(a,i,o){switch(o){case 159:r.Count=a[0],r.Unique=a[1];break;case 19:r.push(a);break;case 160:return!0;case 35:n=!0;break;case 36:n=!1;break;default:if(i.T,!n||t.WTF)throw new Error("Unexpected record 0x"+o.toString(16))}}),r}function tI(e){for(var t=[],r=e.split(""),n=0;n<r.length;++n)t[n]=r[n].charCodeAt(0);return t}function sa(e,t){var r={};return r.Major=e.read_shift(2),r.Minor=e.read_shift(2),t>=4&&(e.l+=t-4),r}function Fj(e){var t={};return t.id=e.read_shift(0,"lpp4"),t.R=sa(e,4),t.U=sa(e,4),t.W=sa(e,4),t}function Oj(e){for(var t=e.read_shift(4),r=e.l+t-4,n={},s=e.read_shift(4),a=[];s-- >0;)a.push({t:e.read_shift(4),v:e.read_shift(0,"lpp4")});if(n.name=e.read_shift(0,"lpp4"),n.comps=a,e.l!=r)throw new Error("Bad DataSpaceMapEntry: "+e.l+" != "+r);return n}function Mj(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(Oj(e));return t}function Lj(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(e.read_shift(0,"lpp4"));return t}function jj(e){var t={};return e.read_shift(4),e.l+=4,t.id=e.read_shift(0,"lpp4"),t.name=e.read_shift(0,"lpp4"),t.R=sa(e,4),t.U=sa(e,4),t.W=sa(e,4),t}function Vj(e){var t=jj(e);if(t.ename=e.read_shift(0,"8lpp4"),t.blksz=e.read_shift(4),t.cmode=e.read_shift(4),e.read_shift(4)!=4)throw new Error("Bad !Primary record");return t}function rI(e,t){var r=e.l+t,n={};n.Flags=e.read_shift(4)&63,e.l+=4,n.AlgID=e.read_shift(4);var s=!1;switch(n.AlgID){case 26126:case 26127:case 26128:s=n.Flags==36;break;case 26625:s=n.Flags==4;break;case 0:s=n.Flags==16||n.Flags==4||n.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+n.AlgID}if(!s)throw new Error("Encryption Flags/AlgID mismatch");return n.AlgIDHash=e.read_shift(4),n.KeySize=e.read_shift(4),n.ProviderType=e.read_shift(4),e.l+=8,n.CSPName=e.read_shift(r-e.l>>1,"utf16le"),e.l=r,n}function nI(e,t){var r={},n=e.l+t;return e.l+=4,r.Salt=e.slice(e.l,e.l+16),e.l+=16,r.Verifier=e.slice(e.l,e.l+16),e.l+=16,e.read_shift(4),r.VerifierHash=e.slice(e.l,n),e.l=n,r}function Uj(e){var t=sa(e);switch(t.Minor){case 2:return[t.Minor,Bj(e)];case 3:return[t.Minor,zj()];case 4:return[t.Minor,$j(e)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+t.Minor)}function Bj(e){var t=e.read_shift(4);if((t&63)!=36)throw new Error("EncryptionInfo mismatch");var r=e.read_shift(4),n=rI(e,r),s=nI(e,e.length-e.l);return{t:"Std",h:n,v:s}}function zj(){throw new Error("File is password-protected: ECMA-376 Extensible")}function $j(e){var t=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];e.l+=4;var r=e.read_shift(e.length-e.l,"utf8"),n={};return r.replace(Wr,function(a){var i=Oe(a);switch(Fs(i[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":t.forEach(function(o){n[o]=i[o]});break;case"<dataIntegrity":n.encryptedHmacKey=i.encryptedHmacKey,n.encryptedHmacValue=i.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":n.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":n.uri=i.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":n.encs.push(i);break;default:throw i[0]}}),n}function Wj(e,t){var r={},n=r.EncryptionVersionInfo=sa(e,4);if(t-=4,n.Minor!=2)throw new Error("unrecognized minor version code: "+n.Minor);if(n.Major>4||n.Major<2)throw new Error("unrecognized major version code: "+n.Major);r.Flags=e.read_shift(4),t-=4;var s=e.read_shift(4);return t-=4,r.EncryptionHeader=rI(e,s),t-=s,r.EncryptionVerifier=nI(e,t),r}function Hj(e){var t={},r=t.EncryptionVersionInfo=sa(e,4);if(r.Major!=1||r.Minor!=1)throw"unrecognized version code "+r.Major+" : "+r.Minor;return t.Salt=e.read_shift(16),t.EncryptedVerifier=e.read_shift(16),t.EncryptedVerifierHash=e.read_shift(16),t}function Gj(e){var t=0,r,n=tI(e),s=n.length+1,a,i,o,l,c;for(r=li(s),r[0]=n.length,a=1;a!=s;++a)r[a]=n[a-1];for(a=s-1;a>=0;--a)i=r[a],o=t&16384?1:0,l=t<<1&32767,c=o|l,t=c^i;return t^52811}var sI=function(){var e=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],t=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],r=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],n=function(i){return(i/2|i*128)&255},s=function(i,o){return n(i^o)},a=function(i){for(var o=t[i.length-1],l=104,c=i.length-1;c>=0;--c)for(var u=i[c],h=0;h!=7;++h)u&64&&(o^=r[l]),u*=2,--l;return o};return function(i){for(var o=tI(i),l=a(o),c=o.length,u=li(16),h=0;h!=16;++h)u[h]=0;var m,p,x;for((c&1)===1&&(m=l>>8,u[c]=s(e[0],m),--c,m=l&255,p=o[o.length-1],u[c]=s(p,m));c>0;)--c,m=l>>8,u[c]=s(o[c],m),--c,m=l&255,u[c]=s(o[c],m);for(c=15,x=15-o.length;x>0;)m=l>>8,u[c]=s(e[x],m),--c,--x,m=l&255,u[c]=s(o[c],m),--c,--x;return u}}(),Kj=function(e,t,r,n,s){s||(s=t),n||(n=sI(e));var a,i;for(a=0;a!=t.length;++a)i=t[a],i^=n[r],i=(i>>5|i<<3)&255,s[a]=i,++r;return[s,r,n]},qj=function(e){var t=0,r=sI(e);return function(n){var s=Kj("",n,t,r);return t=s[1],s[0]}};function Xj(e,t,r,n){var s={key:Yt(e),verificationBytes:Yt(e)};return r.password&&(s.verifier=Gj(r.password)),n.valid=s.verificationBytes===s.verifier,n.valid&&(n.insitu=qj(r.password)),s}function Yj(e,t,r){var n=r||{};return n.Info=e.read_shift(2),e.l-=2,n.Info===1?n.Data=Hj(e):n.Data=Wj(e,t),n}function Qj(e,t,r){var n={Type:r.biff>=8?e.read_shift(2):0};return n.Type?Yj(e,t-2,n):Xj(e,r.biff>=8?t:t-2,r,n),n}var Jj=function(){function e(s,a){switch(a.type){case"base64":return t(An(s),a);case"binary":return t(s,a);case"buffer":return t(Qe&&Buffer.isBuffer(s)?s.toString("binary"):so(s),a);case"array":return t(Xi(s),a)}throw new Error("Unrecognized type "+a.type)}function t(s,a){var i=a||{},o=i.dense?[]:{},l=s.match(/\\trowd.*?\\row\b/g);if(!l.length)throw new Error("RTF missing table");var c={s:{c:0,r:0},e:{c:0,r:l.length-1}};return l.forEach(function(u,h){Array.isArray(o)&&(o[h]=[]);for(var m=/\\\w+\b/g,p=0,x,v=-1;x=m.exec(u);){switch(x[0]){case"\\cell":var w=u.slice(p,m.lastIndex-x[0].length);if(w[0]==" "&&(w=w.slice(1)),++v,w.length){var k={v:w,t:"s"};Array.isArray(o)?o[h][v]=k:o[Ue({r:h,c:v})]=k}break}p=m.lastIndex}v>c.e.c&&(c.e.c=v)}),o["!ref"]=rt(c),o}function r(s,a){return gi(e(s,a),a)}function n(s){for(var a=["{\\rtf1\\ansi"],i=Bt(s["!ref"]),o,l=Array.isArray(s),c=i.s.r;c<=i.e.r;++c){a.push("\\trowd\\trautofit1");for(var u=i.s.c;u<=i.e.c;++u)a.push("\\cellx"+(u+1));for(a.push("\\pard\\intbl"),u=i.s.c;u<=i.e.c;++u){var h=Ue({r:c,c:u});o=l?(s[c]||[])[u]:s[h],!(!o||o.v==null&&(!o.f||o.F))&&(a.push(" "+(o.w||(ga(o),o.w))),a.push("\\cell"))}a.push("\\pard\\intbl\\row")}return a.join("")+"}"}return{to_workbook:r,to_sheet:e,from_sheet:n}}();function Zj(e){var t=e.slice(e[0]==="#"?1:0).slice(0,6);return[parseInt(t.slice(0,2),16),parseInt(t.slice(2,4),16),parseInt(t.slice(4,6),16)]}function fu(e){for(var t=0,r=1;t!=3;++t)r=r*256+(e[t]>255?255:e[t]<0?0:e[t]);return r.toString(16).toUpperCase().slice(1)}function e9(e){var t=e[0]/255,r=e[1]/255,n=e[2]/255,s=Math.max(t,r,n),a=Math.min(t,r,n),i=s-a;if(i===0)return[0,0,t];var o=0,l=0,c=s+a;switch(l=i/(c>1?2-c:c),s){case t:o=((r-n)/i+6)%6;break;case r:o=(n-t)/i+2;break;case n:o=(t-r)/i+4;break}return[o/6,l,c/2]}function t9(e){var t=e[0],r=e[1],n=e[2],s=r*2*(n<.5?n:1-n),a=n-s/2,i=[a,a,a],o=6*t,l;if(r!==0)switch(o|0){case 0:case 6:l=s*o,i[0]+=s,i[1]+=l;break;case 1:l=s*(2-o),i[0]+=l,i[1]+=s;break;case 2:l=s*(o-2),i[1]+=s,i[2]+=l;break;case 3:l=s*(4-o),i[1]+=l,i[2]+=s;break;case 4:l=s*(o-4),i[2]+=s,i[0]+=l;break;case 5:l=s*(6-o),i[2]+=l,i[0]+=s;break}for(var c=0;c!=3;++c)i[c]=Math.round(i[c]*255);return i}function id(e,t){if(t===0)return e;var r=e9(Zj(e));return t<0?r[2]=r[2]*(1+t):r[2]=1-(1-r[2])*(1-t),fu(t9(r))}var aI=6,r9=15,n9=1,Kr=aI;function od(e){return Math.floor((e+Math.round(128/Kr)/256)*Kr)}function ld(e){return Math.floor((e-5)/Kr*100+.5)/100}function Mp(e){return Math.round((e*Kr+5)/Kr*256)/256}function tm(e){return Mp(ld(od(e)))}function ux(e){var t=Math.abs(e-tm(e)),r=Kr;if(t>.005)for(Kr=n9;Kr<r9;++Kr)Math.abs(e-tm(e))<=t&&(t=Math.abs(e-tm(e)),r=Kr);Kr=r}function pl(e){e.width?(e.wpx=od(e.width),e.wch=ld(e.wpx),e.MDW=Kr):e.wpx?(e.wch=ld(e.wpx),e.width=Mp(e.wch),e.MDW=Kr):typeof e.wch=="number"&&(e.width=Mp(e.wch),e.wpx=od(e.width),e.MDW=Kr),e.customWidth&&delete e.customWidth}var s9=96,iI=s9;function oI(e){return e*96/iI}function hu(e){return e*iI/96}var a9={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function i9(e,t,r,n){t.Borders=[];var s={},a=!1;(e[0].match(Wr)||[]).forEach(function(i){var o=Oe(i);switch(Fs(o[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":s={},o.diagonalUp&&(s.diagonalUp=bt(o.diagonalUp)),o.diagonalDown&&(s.diagonalDown=bt(o.diagonalDown)),t.Borders.push(s);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(n&&n.WTF&&!a)throw new Error("unrecognized "+o[0]+" in borders")}})}function o9(e,t,r,n){t.Fills=[];var s={},a=!1;(e[0].match(Wr)||[]).forEach(function(i){var o=Oe(i);switch(Fs(o[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":s={},t.Fills.push(s);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":t.Fills.push(s),s={};break;case"<patternFill":case"<patternFill>":o.patternType&&(s.patternType=o.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":s.bgColor||(s.bgColor={}),o.indexed&&(s.bgColor.indexed=parseInt(o.indexed,10)),o.theme&&(s.bgColor.theme=parseInt(o.theme,10)),o.tint&&(s.bgColor.tint=parseFloat(o.tint)),o.rgb&&(s.bgColor.rgb=o.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":s.fgColor||(s.fgColor={}),o.theme&&(s.fgColor.theme=parseInt(o.theme,10)),o.tint&&(s.fgColor.tint=parseFloat(o.tint)),o.rgb!=null&&(s.fgColor.rgb=o.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(n&&n.WTF&&!a)throw new Error("unrecognized "+o[0]+" in fills")}})}function l9(e,t,r,n){t.Fonts=[];var s={},a=!1;(e[0].match(Wr)||[]).forEach(function(i){var o=Oe(i);switch(Fs(o[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":t.Fonts.push(s),s={};break;case"<name":o.val&&(s.name=Et(o.val));break;case"<name/>":case"</name>":break;case"<b":s.bold=o.val?bt(o.val):1;break;case"<b/>":s.bold=1;break;case"<i":s.italic=o.val?bt(o.val):1;break;case"<i/>":s.italic=1;break;case"<u":switch(o.val){case"none":s.underline=0;break;case"single":s.underline=1;break;case"double":s.underline=2;break;case"singleAccounting":s.underline=33;break;case"doubleAccounting":s.underline=34;break}break;case"<u/>":s.underline=1;break;case"<strike":s.strike=o.val?bt(o.val):1;break;case"<strike/>":s.strike=1;break;case"<outline":s.outline=o.val?bt(o.val):1;break;case"<outline/>":s.outline=1;break;case"<shadow":s.shadow=o.val?bt(o.val):1;break;case"<shadow/>":s.shadow=1;break;case"<condense":s.condense=o.val?bt(o.val):1;break;case"<condense/>":s.condense=1;break;case"<extend":s.extend=o.val?bt(o.val):1;break;case"<extend/>":s.extend=1;break;case"<sz":o.val&&(s.sz=+o.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":o.val&&(s.vertAlign=o.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":o.val&&(s.family=parseInt(o.val,10));break;case"<family/>":case"</family>":break;case"<scheme":o.val&&(s.scheme=o.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(o.val=="1")break;o.codepage=Gv[parseInt(o.val,10)];break;case"<color":if(s.color||(s.color={}),o.auto&&(s.color.auto=bt(o.auto)),o.rgb)s.color.rgb=o.rgb.slice(-6);else if(o.indexed){s.color.index=parseInt(o.indexed,10);var l=Li[s.color.index];s.color.index==81&&(l=Li[1]),l||(l=Li[1]),s.color.rgb=l[0].toString(16)+l[1].toString(16)+l[2].toString(16)}else o.theme&&(s.color.theme=parseInt(o.theme,10),o.tint&&(s.color.tint=parseFloat(o.tint)),o.theme&&r.themeElements&&r.themeElements.clrScheme&&(s.color.rgb=id(r.themeElements.clrScheme[s.color.theme].rgb,s.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":a=!0;break;case"</AlternateContent>":a=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(n&&n.WTF&&!a)throw new Error("unrecognized "+o[0]+" in fonts")}})}function c9(e,t,r){t.NumberFmt=[];for(var n=Ns(ze),s=0;s<n.length;++s)t.NumberFmt[n[s]]=ze[n[s]];var a=e[0].match(Wr);if(a)for(s=0;s<a.length;++s){var i=Oe(a[s]);switch(Fs(i[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var o=it(Et(i.formatCode)),l=parseInt(i.numFmtId,10);if(t.NumberFmt[l]=o,l>0){if(l>392){for(l=392;l>60&&t.NumberFmt[l]!=null;--l);t.NumberFmt[l]=o}Mi(o,l)}}break;case"</numFmt>":break;default:if(r.WTF)throw new Error("unrecognized "+i[0]+" in numFmts")}}}var Pf=["numFmtId","fillId","fontId","borderId","xfId"],Df=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function u9(e,t,r){t.CellXf=[];var n,s=!1;(e[0].match(Wr)||[]).forEach(function(a){var i=Oe(a),o=0;switch(Fs(i[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(n=i,delete n[0],o=0;o<Pf.length;++o)n[Pf[o]]&&(n[Pf[o]]=parseInt(n[Pf[o]],10));for(o=0;o<Df.length;++o)n[Df[o]]&&(n[Df[o]]=bt(n[Df[o]]));if(t.NumberFmt&&n.numFmtId>392){for(o=392;o>60;--o)if(t.NumberFmt[n.numFmtId]==t.NumberFmt[o]){n.numFmtId=o;break}}t.CellXf.push(n);break;case"</xf>":break;case"<alignment":case"<alignment/>":var l={};i.vertical&&(l.vertical=i.vertical),i.horizontal&&(l.horizontal=i.horizontal),i.textRotation!=null&&(l.textRotation=i.textRotation),i.indent&&(l.indent=i.indent),i.wrapText&&(l.wrapText=bt(i.wrapText)),n.alignment=l;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":s=!0;break;case"</AlternateContent>":s=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(r&&r.WTF&&!s)throw new Error("unrecognized "+i[0]+" in cellXfs")}})}var f9=function(){var t=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,r=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,n=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,s=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,a=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(o,l,c){var u={};if(!o)return u;o=o.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var h;return(h=o.match(t))&&c9(h,u,c),(h=o.match(s))&&l9(h,u,l,c),(h=o.match(n))&&o9(h,u,l,c),(h=o.match(a))&&i9(h,u,l,c),(h=o.match(r))&&u9(h,u,c),u}}();function h9(e,t){var r=e.read_shift(2),n=Ur(e);return[r,n]}function d9(e,t,r){var n={};n.sz=e.read_shift(2)/20;var s=T8(e);s.fItalic&&(n.italic=1),s.fCondense&&(n.condense=1),s.fExtend&&(n.extend=1),s.fShadow&&(n.shadow=1),s.fOutline&&(n.outline=1),s.fStrikeout&&(n.strike=1);var a=e.read_shift(2);switch(a===700&&(n.bold=1),e.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var i=e.read_shift(1);i!=0&&(n.underline=i);var o=e.read_shift(1);o>0&&(n.family=o);var l=e.read_shift(1);switch(l>0&&(n.charset=l),e.l++,n.color=E8(e),e.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=Ur(e),n}var m9=$r;function p9(e,t){var r=e.l+t,n=e.read_shift(2),s=e.read_shift(2);return e.l=r,{ixfe:n,numFmtId:s}}var g9=$r;function v9(e,t,r){var n={};n.NumberFmt=[];for(var s in ze)n.NumberFmt[s]=ze[s];n.CellXf=[],n.Fonts=[];var a=[],i=!1;return ya(e,function(l,c,u){switch(u){case 44:n.NumberFmt[l[0]]=l[1],Mi(l[1],l[0]);break;case 43:n.Fonts.push(l),l.color.theme!=null&&t&&t.themeElements&&t.themeElements.clrScheme&&(l.color.rgb=id(t.themeElements.clrScheme[l.color.theme].rgb,l.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:a[a.length-1]==617&&n.CellXf.push(l);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:i=!0;break;case 36:i=!1;break;case 37:a.push(u),i=!0;break;case 38:a.pop(),i=!1;break;default:if(c.T>0)a.push(u);else if(c.T<0)a.pop();else if(!i||r.WTF&&a[a.length-1]!=37)throw new Error("Unexpected record 0x"+u.toString(16))}}),n}var x9=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function _9(e,t,r){t.themeElements.clrScheme=[];var n={};(e[0].match(Wr)||[]).forEach(function(s){var a=Oe(s);switch(a[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":n.rgb=a.val;break;case"<a:sysClr":n.rgb=a.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":a[0].charAt(1)==="/"?(t.themeElements.clrScheme[x9.indexOf(a[0])]=n,n={}):n.name=a[0].slice(3,a[0].length-1);break;default:if(r&&r.WTF)throw new Error("Unrecognized "+a[0]+" in clrScheme")}})}function y9(){}function w9(){}var E9=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,T9=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,k9=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function S9(e,t,r){t.themeElements={};var n;[["clrScheme",E9,_9],["fontScheme",T9,y9],["fmtScheme",k9,w9]].forEach(function(s){if(!(n=e.match(s[1])))throw new Error(s[0]+" not found in themeElements");s[2](n,t,r)})}var A9=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function lI(e,t){(!e||e.length===0)&&(e=I9());var r,n={};if(!(r=e.match(A9)))throw new Error("themeElements not found in theme");return S9(r[0],n,t),n.raw=e,n}function I9(e,t){var r=[_A];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function C9(e,t,r){var n=e.l+t,s=e.read_shift(4);if(s!==124226){if(!r.cellStyles){e.l=n;return}var a=e.slice(e.l);e.l=n;var i;try{i=xA(a,{type:"array"})}catch{return}var o=yn(i,"theme/theme/theme1.xml",!0);if(o)return lI(o,r)}}function R9(e){return e.read_shift(4)}function N9(e){var t={};switch(t.xclrType=e.read_shift(2),t.nTintShade=e.read_shift(2),t.xclrType){case 0:e.l+=4;break;case 1:t.xclrValue=b9(e,4);break;case 2:t.xclrValue=qA(e);break;case 3:t.xclrValue=R9(e);break;case 4:e.l+=4;break}return e.l+=8,t}function b9(e,t){return $r(e,t)}function P9(e,t){return $r(e,t)}function D9(e){var t=e.read_shift(2),r=e.read_shift(2)-4,n=[t];switch(t){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:n[1]=N9(e);break;case 6:n[1]=P9(e,r);break;case 14:case 15:n[1]=e.read_shift(r===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+t+" "+r)}return n}function F9(e,t){var r=e.l+t;e.l+=2;var n=e.read_shift(2);e.l+=2;for(var s=e.read_shift(2),a=[];s-- >0;)a.push(D9(e,r-e.l));return{ixfe:n,ext:a}}function O9(e,t){t.forEach(function(r){switch(r[0]){}})}function M9(e,t){return{flags:e.read_shift(4),version:e.read_shift(4),name:Ur(e)}}function L9(e){for(var t=[],r=e.read_shift(4);r-- >0;)t.push([e.read_shift(4),e.read_shift(4)]);return t}function j9(e){return e.l+=4,e.read_shift(4)!=0}function V9(e,t,r){var n={Types:[],Cell:[],Value:[]},s=r||{},a=[],i=!1,o=2;return ya(e,function(l,c,u){switch(u){case 335:n.Types.push({name:l.name});break;case 51:l.forEach(function(h){o==1?n.Cell.push({type:n.Types[h[0]-1].name,index:h[1]}):o==0&&n.Value.push({type:n.Types[h[0]-1].name,index:h[1]})});break;case 337:o=l?1:0;break;case 338:o=2;break;case 35:a.push(u),i=!0;break;case 36:a.pop(),i=!1;break;default:if(!c.T){if(!i||s.WTF&&a[a.length-1]!=35)throw new Error("Unexpected record 0x"+u.toString(16))}}}),n}function U9(e,t,r){var n={Types:[],Cell:[],Value:[]};if(!e)return n;var s=!1,a=2,i;return e.replace(Wr,function(o){var l=Oe(o);switch(Fs(l[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":n.Types.push({name:l.name});break;case"</metadataType>":break;case"<futureMetadata":for(var c=0;c<n.Types.length;++c)n.Types[c].name==l.name&&(i=n.Types[c]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":a==1?n.Cell.push({type:n.Types[l.t-1].name,index:+l.v}):a==0&&n.Value.push({type:n.Types[l.t-1].name,index:+l.v});break;case"</rc>":break;case"<cellMetadata":a=1;break;case"</cellMetadata>":a=2;break;case"<valueMetadata":a=0;break;case"</valueMetadata>":a=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;case"<rvb":if(!i)break;i.offsets||(i.offsets=[]),i.offsets.push(+l.i);break;default:if(!s&&r.WTF)throw new Error("unrecognized "+l[0]+" in metadata")}return o}),n}function B9(e){var t=[];if(!e)return t;var r=1;return(e.match(Wr)||[]).forEach(function(n){var s=Oe(n);switch(s[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete s[0],s.i?r=s.i:s.i=r,t.push(s);break}}),t}function z9(e){var t={};t.i=e.read_shift(4);var r={};r.r=e.read_shift(4),r.c=e.read_shift(4),t.r=Ue(r);var n=e.read_shift(1);return n&2&&(t.l="1"),n&8&&(t.a="1"),t}function $9(e,t,r){var n=[];return ya(e,function(a,i,o){switch(o){case 63:n.push(a);break;default:if(!i.T)throw new Error("Unexpected record 0x"+o.toString(16))}}),n}function W9(e,t,r,n){if(!e)return e;var s=n||{},a=!1;ya(e,function(o,l,c){switch(c){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:a=!0;break;case 36:a=!1;break;default:if(!l.T){if(!a||s.WTF)throw new Error("Unexpected record 0x"+c.toString(16))}}},s)}function H9(e,t){if(!e)return"??";var r=(e.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return t["!id"][r].Target}function Dw(e,t,r,n){var s=Array.isArray(e),a;t.forEach(function(i){var o=qr(i.ref);if(s?(e[o.r]||(e[o.r]=[]),a=e[o.r][o.c]):a=e[i.ref],!a){a={t:"z"},s?e[o.r][o.c]=a:e[i.ref]=a;var l=Bt(e["!ref"]||"BDWGO1000001:A1");l.s.r>o.r&&(l.s.r=o.r),l.e.r<o.r&&(l.e.r=o.r),l.s.c>o.c&&(l.s.c=o.c),l.e.c<o.c&&(l.e.c=o.c);var c=rt(l);c!==e["!ref"]&&(e["!ref"]=c)}a.c||(a.c=[]);var u={a:i.author,t:i.t,r:i.r,T:r};i.h&&(u.h=i.h);for(var h=a.c.length-1;h>=0;--h){if(!r&&a.c[h].T)return;r&&!a.c[h].T&&a.c.splice(h,1)}if(r&&n){for(h=0;h<n.length;++h)if(u.a==n[h].id){u.a=n[h].name||u.a;break}}a.c.push(u)})}function G9(e,t){if(e.match(/<(?:\w+:)?comments *\/>/))return[];var r=[],n=[],s=e.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);s&&s[1]&&s[1].split(/<\/\w*:?author>/).forEach(function(i){if(!(i===""||i.trim()==="")){var o=i.match(/<(?:\w+:)?author[^>]*>(.*)/);o&&r.push(o[1])}});var a=e.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return a&&a[1]&&a[1].split(/<\/\w*:?comment>/).forEach(function(i){if(!(i===""||i.trim()==="")){var o=i.match(/<(?:\w+:)?comment[^>]*>/);if(o){var l=Oe(o[0]),c={author:l.authorId&&r[l.authorId]||"sheetjsghost",ref:l.ref,guid:l.guid},u=qr(l.ref);if(!(t.sheetRows&&t.sheetRows<=u.r)){var h=i.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),m=!!h&&!!h[1]&&cx(h[1])||{r:"",t:"",h:""};c.r=m.r,m.r=="<t></t>"&&(m.t=m.h=""),c.t=(m.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),t.cellHTML&&(c.h=m.h),n.push(c)}}}}),n}function K9(e,t){var r=[],n=!1,s={},a=0;return e.replace(Wr,function(o,l){var c=Oe(o);switch(Fs(c[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":s={author:c.personId,guid:c.id,ref:c.ref,T:1};break;case"</threadedComment>":s.t!=null&&r.push(s);break;case"<text>":case"<text":a=l+o.length;break;case"</text>":s.t=e.slice(a,l).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":n=!0;break;case"</mentions>":n=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&t.WTF)throw new Error("unrecognized "+c[0]+" in threaded comments")}return o}),r}function q9(e,t){var r=[],n=!1;return e.replace(Wr,function(a){var i=Oe(a);switch(Fs(i[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":r.push({name:i.displayname,id:i.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&t.WTF)throw new Error("unrecognized "+i[0]+" in threaded comments")}return a}),r}function X9(e){var t={};t.iauthor=e.read_shift(4);var r=io(e);return t.rfx=r.s,t.ref=Ue(r.s),e.l+=16,t}var Y9=Ur;function Q9(e,t){var r=[],n=[],s={},a=!1;return ya(e,function(o,l,c){switch(c){case 632:n.push(o);break;case 635:s=o;break;case 637:s.t=o.t,s.h=o.h,s.r=o.r;break;case 636:if(s.author=n[s.iauthor],delete s.iauthor,t.sheetRows&&s.rfx&&t.sheetRows<=s.rfx.r)break;s.t||(s.t=""),delete s.rfx,r.push(s);break;case 3072:break;case 35:a=!0;break;case 36:a=!1;break;case 37:break;case 38:break;default:if(!l.T){if(!a||t.WTF)throw new Error("Unexpected record 0x"+c.toString(16))}}}),r}var J9="application/vnd.ms-office.vbaProject";function Z9(e){var t=tt.utils.cfb_new({root:"R"});return e.FullPaths.forEach(function(r,n){if(!(r.slice(-1)==="/"||!r.match(/_VBA_PROJECT_CUR/))){var s=r.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");tt.utils.cfb_add(t,s,e.FileIndex[n].content)}}),tt.write(t)}function eV(){return{"!type":"dialog"}}function tV(){return{"!type":"dialog"}}function rV(){return{"!type":"macro"}}function nV(){return{"!type":"macro"}}var qo=function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,t={r:0,c:0};function r(n,s,a,i){var o=!1,l=!1;a.length==0?l=!0:a.charAt(0)=="["&&(l=!0,a=a.slice(1,-1)),i.length==0?o=!0:i.charAt(0)=="["&&(o=!0,i=i.slice(1,-1));var c=a.length>0?parseInt(a,10)|0:0,u=i.length>0?parseInt(i,10)|0:0;return o?u+=t.c:--u,l?c+=t.r:--c,s+(o?"":"$")+sr(u)+(l?"":"$")+Tr(c)}return function(s,a){return t=a,s.replace(e,r)}}(),cI=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,sV=function(){return function(t,r){return t.replace(cI,function(n,s,a,i,o,l){var c=nx(i)-(a?0:r.c),u=rx(l)-(o?0:r.r),h=u==0?"":o?u+1:"["+u+"]",m=c==0?"":a?c+1:"["+c+"]";return s+"R"+h+"C"+m})}}();function uI(e,t){return e.replace(cI,function(r,n,s,a,i,o){return n+(s=="$"?s+a:sr(nx(a)+t.c))+(i=="$"?i+o:Tr(rx(o)+t.r))})}function aV(e,t,r){var n=Sl(t),s=n.s,a=qr(r),i={r:a.r-s.r,c:a.c-s.c};return uI(e,i)}function iV(e){return e.length!=1}function Fw(e){return e.replace(/_xlfn\./g,"")}function Kt(e){e.l+=1}function ci(e,t){var r=e.read_shift(2);return[r&16383,r>>14&1,r>>15&1]}function fI(e,t,r){var n=2;if(r){if(r.biff>=2&&r.biff<=5)return hI(e);r.biff==12&&(n=4)}var s=e.read_shift(n),a=e.read_shift(n),i=ci(e),o=ci(e);return{s:{r:s,c:i[0],cRel:i[1],rRel:i[2]},e:{r:a,c:o[0],cRel:o[1],rRel:o[2]}}}function hI(e){var t=ci(e),r=ci(e),n=e.read_shift(1),s=e.read_shift(1);return{s:{r:t[0],c:n,cRel:t[1],rRel:t[2]},e:{r:r[0],c:s,cRel:r[1],rRel:r[2]}}}function oV(e,t,r){if(r.biff<8)return hI(e);var n=e.read_shift(r.biff==12?4:2),s=e.read_shift(r.biff==12?4:2),a=ci(e),i=ci(e);return{s:{r:n,c:a[0],cRel:a[1],rRel:a[2]},e:{r:s,c:i[0],cRel:i[1],rRel:i[2]}}}function dI(e,t,r){if(r&&r.biff>=2&&r.biff<=5)return lV(e);var n=e.read_shift(r&&r.biff==12?4:2),s=ci(e);return{r:n,c:s[0],cRel:s[1],rRel:s[2]}}function lV(e){var t=ci(e),r=e.read_shift(1);return{r:t[0],c:r,cRel:t[1],rRel:t[2]}}function cV(e){var t=e.read_shift(2),r=e.read_shift(2);return{r:t,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function uV(e,t,r){var n=r&&r.biff?r.biff:8;if(n>=2&&n<=5)return fV(e);var s=e.read_shift(n>=12?4:2),a=e.read_shift(2),i=(a&16384)>>14,o=(a&32768)>>15;if(a&=16383,o==1)for(;s>524287;)s-=1048576;if(i==1)for(;a>8191;)a=a-16384;return{r:s,c:a,cRel:i,rRel:o}}function fV(e){var t=e.read_shift(2),r=e.read_shift(1),n=(t&32768)>>15,s=(t&16384)>>14;return t&=16383,n==1&&t>=8192&&(t=t-16384),s==1&&r>=128&&(r=r-256),{r:t,c:r,cRel:s,rRel:n}}function hV(e,t,r){var n=(e[e.l++]&96)>>5,s=fI(e,r.biff>=2&&r.biff<=5?6:8,r);return[n,s]}function dV(e,t,r){var n=(e[e.l++]&96)>>5,s=e.read_shift(2,"i"),a=8;if(r)switch(r.biff){case 5:e.l+=12,a=6;break;case 12:a=12;break}var i=fI(e,a,r);return[n,s,i]}function mV(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r&&r.biff>8?12:r.biff<8?6:8,[n]}function pV(e,t,r){var n=(e[e.l++]&96)>>5,s=e.read_shift(2),a=8;if(r)switch(r.biff){case 5:e.l+=12,a=6;break;case 12:a=12;break}return e.l+=a,[n,s]}function gV(e,t,r){var n=(e[e.l++]&96)>>5,s=oV(e,t-1,r);return[n,s]}function vV(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r.biff==2?6:r.biff==12?14:7,[n]}function Ow(e){var t=e[e.l+1]&1,r=1;return e.l+=4,[t,r]}function xV(e,t,r){e.l+=2;for(var n=e.read_shift(r&&r.biff==2?1:2),s=[],a=0;a<=n;++a)s.push(e.read_shift(r&&r.biff==2?1:2));return s}function _V(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function yV(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function wV(e){var t=e[e.l+1]&255?1:0;return e.l+=2,[t,e.read_shift(2)]}function EV(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=r&&r.biff==2?3:4,[n]}function mI(e){var t=e.read_shift(1),r=e.read_shift(1);return[t,r]}function TV(e){return e.read_shift(2),mI(e)}function kV(e){return e.read_shift(2),mI(e)}function SV(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var s=dI(e,0,r);return[n,s]}function AV(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var s=uV(e,0,r);return[n,s]}function IV(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var s=e.read_shift(2);r&&r.biff==5&&(e.l+=12);var a=dI(e,0,r);return[n,s,a]}function CV(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var s=e.read_shift(r&&r.biff<=3?1:2);return[RU[s],vI[s],n]}function RV(e,t,r){var n=e[e.l++],s=e.read_shift(1),a=r&&r.biff<=3?[n==88?-1:0,e.read_shift(1)]:NV(e);return[s,(a[0]===0?vI:CU)[a[1]]]}function NV(e){return[e[e.l+1]>>7,e.read_shift(2)&32767]}function bV(e,t,r){e.l+=r&&r.biff==2?3:4}function PV(e,t,r){if(e.l++,r&&r.biff==12)return[e.read_shift(4,"i"),0];var n=e.read_shift(2),s=e.read_shift(r&&r.biff==2?1:2);return[n,s]}function DV(e){return e.l++,oo[e.read_shift(1)]}function FV(e){return e.l++,e.read_shift(2)}function OV(e){return e.l++,e.read_shift(1)!==0}function MV(e){return e.l++,Lr(e)}function LV(e,t,r){return e.l++,ju(e,t-1,r)}function jV(e,t){var r=[e.read_shift(1)];if(t==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=zt(e,1)?"TRUE":"FALSE",t!=12&&(e.l+=7);break;case 37:case 16:r[1]=oo[e[e.l]],e.l+=t==12?4:8;break;case 0:e.l+=8;break;case 1:r[1]=Lr(e);break;case 2:r[1]=lo(e,0,{biff:t>0&&t<8?2:t});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function VV(e,t,r){for(var n=e.read_shift(r.biff==12?4:2),s=[],a=0;a!=n;++a)s.push((r.biff==12?io:r0)(e));return s}function UV(e,t,r){var n=0,s=0;r.biff==12?(n=e.read_shift(4),s=e.read_shift(4)):(s=1+e.read_shift(1),n=1+e.read_shift(2)),r.biff>=2&&r.biff<8&&(--n,--s==0&&(s=256));for(var a=0,i=[];a!=n&&(i[a]=[]);++a)for(var o=0;o!=s;++o)i[a][o]=jV(e,r.biff);return i}function BV(e,t,r){var n=e.read_shift(1)>>>5&3,s=!r||r.biff>=8?4:2,a=e.read_shift(s);switch(r.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[n,0,a]}function zV(e,t,r){if(r.biff==5)return $V(e);var n=e.read_shift(1)>>>5&3,s=e.read_shift(2),a=e.read_shift(4);return[n,s,a]}function $V(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2,"i");e.l+=8;var n=e.read_shift(2);return e.l+=12,[t,r,n]}function WV(e,t,r){var n=e.read_shift(1)>>>5&3;e.l+=r&&r.biff==2?3:4;var s=e.read_shift(r&&r.biff==2?1:2);return[n,s]}function HV(e,t,r){var n=e.read_shift(1)>>>5&3,s=e.read_shift(r&&r.biff==2?1:2);return[n,s]}function GV(e,t,r){var n=e.read_shift(1)>>>5&3;return e.l+=4,r.biff<8&&e.l--,r.biff==12&&(e.l+=2),[n]}function KV(e,t,r){var n=(e[e.l++]&96)>>5,s=e.read_shift(2),a=4;if(r)switch(r.biff){case 5:a=15;break;case 12:a=6;break}return e.l+=a,[n,s]}var qV=$r,XV=$r,YV=$r;function Uu(e,t,r){return e.l+=2,[cV(e)]}function fx(e){return e.l+=6,[]}var QV=Uu,JV=fx,ZV=fx,eU=Uu;function pI(e){return e.l+=2,[Yt(e),e.read_shift(2)&1]}var tU=Uu,rU=pI,nU=fx,sU=Uu,aU=Uu,iU=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function oU(e){e.l+=2;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),s=e.read_shift(2),a=e.read_shift(2),i=iU[r>>2&31];return{ixti:t,coltype:r&3,rt:i,idx:n,c:s,C:a}}function lU(e){return e.l+=2,[e.read_shift(4)]}function cU(e,t,r){return e.l+=5,e.l+=2,e.l+=r.biff==2?1:4,["PTGSHEET"]}function uU(e,t,r){return e.l+=r.biff==2?4:5,["PTGENDSHEET"]}function fU(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function hU(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function dU(e){return e.l+=4,[0,0]}var Mw={1:{n:"PtgExp",f:PV},2:{n:"PtgTbl",f:YV},3:{n:"PtgAdd",f:Kt},4:{n:"PtgSub",f:Kt},5:{n:"PtgMul",f:Kt},6:{n:"PtgDiv",f:Kt},7:{n:"PtgPower",f:Kt},8:{n:"PtgConcat",f:Kt},9:{n:"PtgLt",f:Kt},10:{n:"PtgLe",f:Kt},11:{n:"PtgEq",f:Kt},12:{n:"PtgGe",f:Kt},13:{n:"PtgGt",f:Kt},14:{n:"PtgNe",f:Kt},15:{n:"PtgIsect",f:Kt},16:{n:"PtgUnion",f:Kt},17:{n:"PtgRange",f:Kt},18:{n:"PtgUplus",f:Kt},19:{n:"PtgUminus",f:Kt},20:{n:"PtgPercent",f:Kt},21:{n:"PtgParen",f:Kt},22:{n:"PtgMissArg",f:Kt},23:{n:"PtgStr",f:LV},26:{n:"PtgSheet",f:cU},27:{n:"PtgEndSheet",f:uU},28:{n:"PtgErr",f:DV},29:{n:"PtgBool",f:OV},30:{n:"PtgInt",f:FV},31:{n:"PtgNum",f:MV},32:{n:"PtgArray",f:vV},33:{n:"PtgFunc",f:CV},34:{n:"PtgFuncVar",f:RV},35:{n:"PtgName",f:BV},36:{n:"PtgRef",f:SV},37:{n:"PtgArea",f:hV},38:{n:"PtgMemArea",f:WV},39:{n:"PtgMemErr",f:qV},40:{n:"PtgMemNoMem",f:XV},41:{n:"PtgMemFunc",f:HV},42:{n:"PtgRefErr",f:GV},43:{n:"PtgAreaErr",f:mV},44:{n:"PtgRefN",f:AV},45:{n:"PtgAreaN",f:gV},46:{n:"PtgMemAreaN",f:fU},47:{n:"PtgMemNoMemN",f:hU},57:{n:"PtgNameX",f:zV},58:{n:"PtgRef3d",f:IV},59:{n:"PtgArea3d",f:dV},60:{n:"PtgRefErr3d",f:KV},61:{n:"PtgAreaErr3d",f:pV},255:{}},mU={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},pU={1:{n:"PtgElfLel",f:pI},2:{n:"PtgElfRw",f:sU},3:{n:"PtgElfCol",f:QV},6:{n:"PtgElfRwV",f:aU},7:{n:"PtgElfColV",f:eU},10:{n:"PtgElfRadical",f:tU},11:{n:"PtgElfRadicalS",f:nU},13:{n:"PtgElfColS",f:JV},15:{n:"PtgElfColSV",f:ZV},16:{n:"PtgElfRadicalLel",f:rU},25:{n:"PtgList",f:oU},29:{n:"PtgSxName",f:lU},255:{}},gU={0:{n:"PtgAttrNoop",f:dU},1:{n:"PtgAttrSemi",f:EV},2:{n:"PtgAttrIf",f:yV},4:{n:"PtgAttrChoose",f:xV},8:{n:"PtgAttrGoto",f:_V},16:{n:"PtgAttrSum",f:bV},32:{n:"PtgAttrBaxcel",f:Ow},33:{n:"PtgAttrBaxcel",f:Ow},64:{n:"PtgAttrSpace",f:TV},65:{n:"PtgAttrSpaceSemi",f:kV},128:{n:"PtgAttrIfError",f:wV},255:{}};function Bu(e,t,r,n){if(n.biff<8)return $r(e,t);for(var s=e.l+t,a=[],i=0;i!==r.length;++i)switch(r[i][0]){case"PtgArray":r[i][1]=UV(e,0,n),a.push(r[i][1]);break;case"PtgMemArea":r[i][2]=VV(e,r[i][1],n),a.push(r[i][2]);break;case"PtgExp":n&&n.biff==12&&(r[i][1][1]=e.read_shift(4),a.push(r[i][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[i][0]}return t=s-e.l,t!==0&&a.push($r(e,t)),a}function zu(e,t,r){for(var n=e.l+t,s,a,i=[];n!=e.l;)t=n-e.l,a=e[e.l],s=Mw[a]||Mw[mU[a]],(a===24||a===25)&&(s=(a===24?pU:gU)[e[e.l+1]]),!s||!s.f?$r(e,t):i.push([s.n,s.f(e,t,r)]);return i}function vU(e){for(var t=[],r=0;r<e.length;++r){for(var n=e[r],s=[],a=0;a<n.length;++a){var i=n[a];if(i)switch(i[0]){case 2:s.push('"'+i[1].replace(/"/g,'""')+'"');break;default:s.push(i[1])}else s.push("")}t.push(s.join(","))}return t.join(";")}var xU={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function _U(e,t){if(!e&&!(t&&t.biff<=5&&t.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}function gI(e,t,r){if(!e)return"SH33TJSERR0";if(r.biff>8&&(!e.XTI||!e.XTI[t]))return e.SheetNames[t];if(!e.XTI)return"SH33TJSERR6";var n=e.XTI[t];if(r.biff<8)return t>1e4&&(t-=65536),t<0&&(t=-t),t==0?"":e.XTI[t-1];if(!n)return"SH33TJSERR1";var s="";if(r.biff>8)switch(e[n[0]][0]){case 357:return s=n[1]==-1?"#REF":e.SheetNames[n[1]],n[1]==n[2]?s:s+":"+e.SheetNames[n[2]];case 358:return r.SID!=null?e.SheetNames[r.SID]:"SH33TJSSAME"+e[n[0]][0];case 355:default:return"SH33TJSSRC"+e[n[0]][0]}switch(e[n[0]][0][0]){case 1025:return s=n[1]==-1?"#REF":e.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?s:s+":"+e.SheetNames[n[2]];case 14849:return e[n[0]].slice(1).map(function(a){return a.Name}).join(";;");default:return e[n[0]][0][3]?(s=n[1]==-1?"#REF":e[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?s:s+":"+e[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function Lw(e,t,r){var n=gI(e,t,r);return n=="#REF"?n:_U(n,r)}function Fr(e,t,r,n,s){var a=s&&s.biff||8,i={s:{c:0,r:0}},o=[],l,c,u,h=0,m=0,p,x="";if(!e[0]||!e[0][0])return"";for(var v=-1,w="",k=0,T=e[0].length;k<T;++k){var E=e[0][k];switch(E[0]){case"PtgUminus":o.push("-"+o.pop());break;case"PtgUplus":o.push("+"+o.pop());break;case"PtgPercent":o.push(o.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(l=o.pop(),c=o.pop(),v>=0){switch(e[0][v][1][0]){case 0:w=Ut(" ",e[0][v][1][1]);break;case 1:w=Ut("\r",e[0][v][1][1]);break;default:if(w="",s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][v][1][0])}c=c+w,v=-1}o.push(c+xU[E[0]]+l);break;case"PtgIsect":l=o.pop(),c=o.pop(),o.push(c+" "+l);break;case"PtgUnion":l=o.pop(),c=o.pop(),o.push(c+","+l);break;case"PtgRange":l=o.pop(),c=o.pop(),o.push(c+":"+l);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":u=Tc(E[1][1],i,s),o.push(kc(u,a));break;case"PtgRefN":u=r?Tc(E[1][1],r,s):E[1][1],o.push(kc(u,a));break;case"PtgRef3d":h=E[1][1],u=Tc(E[1][2],i,s),x=Lw(n,h,s),o.push(x+"!"+kc(u,a));break;case"PtgFunc":case"PtgFuncVar":var N=E[1][0],O=E[1][1];N||(N=0),N&=127;var L=N==0?[]:o.slice(-N);o.length-=N,O==="User"&&(O=L.shift()),o.push(O+"("+L.join(",")+")");break;case"PtgBool":o.push(E[1]?"TRUE":"FALSE");break;case"PtgInt":o.push(E[1]);break;case"PtgNum":o.push(String(E[1]));break;case"PtgStr":o.push('"'+E[1].replace(/"/g,'""')+'"');break;case"PtgErr":o.push(E[1]);break;case"PtgAreaN":p=vw(E[1][1],r?{s:r}:i,s),o.push(Z0(p,s));break;case"PtgArea":p=vw(E[1][1],i,s),o.push(Z0(p,s));break;case"PtgArea3d":h=E[1][1],p=E[1][2],x=Lw(n,h,s),o.push(x+"!"+Z0(p,s));break;case"PtgAttrSum":o.push("SUM("+o.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":m=E[1][2];var g=(n.names||[])[m-1]||(n[0]||[])[m],y=g?g.Name:"SH33TJSNAME"+String(m);y&&y.slice(0,6)=="_xlfn."&&!s.xlfn&&(y=y.slice(6)),o.push(y);break;case"PtgNameX":var S=E[1][1];m=E[1][2];var R;if(s.biff<=5)S<0&&(S=-S),n[S]&&(R=n[S][m]);else{var b="";if(((n[S]||[])[0]||[])[0]==14849||(((n[S]||[])[0]||[])[0]==1025?n[S][m]&&n[S][m].itab>0&&(b=n.SheetNames[n[S][m].itab-1]+"!"):b=n.SheetNames[m-1]+"!"),n[S]&&n[S][m])b+=n[S][m].Name;else if(n[0]&&n[0][m])b+=n[0][m].Name;else{var P=(gI(n,S,s)||"").split(";;");P[m-1]?b=P[m-1]:b+="SH33TJSERRX"}o.push(b);break}R||(R={Name:"SH33TJSERRY"}),o.push(R.Name);break;case"PtgParen":var C="(",le=")";if(v>=0){switch(w="",e[0][v][1][0]){case 2:C=Ut(" ",e[0][v][1][1])+C;break;case 3:C=Ut("\r",e[0][v][1][1])+C;break;case 4:le=Ut(" ",e[0][v][1][1])+le;break;case 5:le=Ut("\r",e[0][v][1][1])+le;break;default:if(s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][v][1][0])}v=-1}o.push(C+o.pop()+le);break;case"PtgRefErr":o.push("#REF!");break;case"PtgRefErr3d":o.push("#REF!");break;case"PtgExp":u={c:E[1][1],r:E[1][0]};var se={c:r.c,r:r.r};if(n.sharedf[Ue(u)]){var he=n.sharedf[Ue(u)];o.push(Fr(he,i,se,n,s))}else{var de=!1;for(l=0;l!=n.arrayf.length;++l)if(c=n.arrayf[l],!(u.c<c[0].s.c||u.c>c[0].e.c)&&!(u.r<c[0].s.r||u.r>c[0].e.r)){o.push(Fr(c[1],i,se,n,s)),de=!0;break}de||o.push(E[1])}break;case"PtgArray":o.push("{"+vU(E[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":v=k;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":o.push("");break;case"PtgAreaErr":o.push("#REF!");break;case"PtgAreaErr3d":o.push("#REF!");break;case"PtgList":o.push("Table"+E[1].idx+"[#"+E[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(E));default:throw new Error("Unrecognized Formula Token: "+String(E))}var ie=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(s.biff!=3&&v>=0&&ie.indexOf(e[0][k][0])==-1){E=e[0][v];var H=!0;switch(E[1][0]){case 4:H=!1;case 0:w=Ut(" ",E[1][1]);break;case 5:H=!1;case 1:w=Ut("\r",E[1][1]);break;default:if(w="",s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+E[1][0])}o.push((H?w:"")+o.pop()+(H?"":w)),v=-1}}if(o.length>1&&s.WTF)throw new Error("bad formula stack");return o[0]}function yU(e,t,r){var n=e.l+t,s=r.biff==2?1:2,a,i=e.read_shift(s);if(i==65535)return[[],$r(e,t-2)];var o=zu(e,i,r);return t!==i+s&&(a=Bu(e,t-i-s,o,r)),e.l=n,[o,a]}function wU(e,t,r){var n=e.l+t,s=r.biff==2?1:2,a,i=e.read_shift(s);if(i==65535)return[[],$r(e,t-2)];var o=zu(e,i,r);return t!==i+s&&(a=Bu(e,t-i-s,o,r)),e.l=n,[o,a]}function EU(e,t,r,n){var s=e.l+t,a=zu(e,n,r),i;return s!==e.l&&(i=Bu(e,s-e.l,a,r)),[a,i]}function TU(e,t,r){var n=e.l+t,s,a=e.read_shift(2),i=zu(e,a,r);return a==65535?[[],$r(e,t-2)]:(t!==a+2&&(s=Bu(e,n-a-2,i,r)),[i,s])}function kU(e){var t;if(Js(e,e.l+6)!==65535)return[Lr(e),"n"];switch(e[e.l]){case 0:return e.l+=8,["String","s"];case 1:return t=e[e.l+2]===1,e.l+=8,[t,"b"];case 2:return t=e[e.l+2],e.l+=8,[t,"e"];case 3:return e.l+=8,["","s"]}return[]}function rm(e,t,r){var n=e.l+t,s=Os(e);r.biff==2&&++e.l;var a=kU(e),i=e.read_shift(1);r.biff!=2&&(e.read_shift(1),r.biff>=5&&e.read_shift(4));var o=wU(e,n-e.l,r);return{cell:s,val:a[0],formula:o,shared:i>>3&1,tt:a[1]}}function n0(e,t,r){var n=e.read_shift(4),s=zu(e,n,r),a=e.read_shift(4),i=a>0?Bu(e,a,s,r):null;return[s,i]}var SU=n0,s0=n0,AU=n0,IU=n0,CU={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},vI={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},RU={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function jw(e){return e.slice(0,3)=="of:"&&(e=e.slice(3)),e.charCodeAt(0)==61&&(e=e.slice(1),e.charCodeAt(0)==61&&(e=e.slice(1))),e=e.replace(/COM\.MICROSOFT\./g,""),e=e.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(t,r){return r.replace(/\./g,"")}),e=e.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),e.replace(/[;~]/g,",").replace(/\|/g,";")}function nm(e){var t=e.split(":"),r=t[0].split(".")[0];return[r,t[0].split(".")[1]+(t.length>1?":"+(t[1].split(".")[1]||t[1].split(".")[0]):"")]}var Cc={},Xo={};function Rc(e,t){if(e){var r=[.7,.7,.75,.75,.3,.3];t=="xlml"&&(r=[1,1,1,1,.5,.5]),e.left==null&&(e.left=r[0]),e.right==null&&(e.right=r[1]),e.top==null&&(e.top=r[2]),e.bottom==null&&(e.bottom=r[3]),e.header==null&&(e.header=r[4]),e.footer==null&&(e.footer=r[5])}}function xI(e,t,r,n,s,a){try{n.cellNF&&(e.z=ze[t])}catch(o){if(n.WTF)throw o}if(!(e.t==="z"&&!n.cellStyles)){if(e.t==="d"&&typeof e.v=="string"&&(e.v=dr(e.v)),(!n||n.cellText!==!1)&&e.t!=="z")try{if(ze[t]==null&&Mi(N6[t]||"General",t),e.t==="e")e.w=e.w||oo[e.v];else if(t===0)if(e.t==="n")(e.v|0)===e.v?e.w=e.v.toString(10):e.w=ou(e.v);else if(e.t==="d"){var i=Jr(e.v);(i|0)===i?e.w=i.toString(10):e.w=ou(i)}else{if(e.v===void 0)return"";e.w=qi(e.v,Xo)}else e.t==="d"?e.w=$n(t,Jr(e.v),Xo):e.w=$n(t,e.v,Xo)}catch(o){if(n.WTF)throw o}if(n.cellStyles&&r!=null)try{e.s=a.Fills[r],e.s.fgColor&&e.s.fgColor.theme&&!e.s.fgColor.rgb&&(e.s.fgColor.rgb=id(s.themeElements.clrScheme[e.s.fgColor.theme].rgb,e.s.fgColor.tint||0),n.WTF&&(e.s.fgColor.raw_rgb=s.themeElements.clrScheme[e.s.fgColor.theme].rgb)),e.s.bgColor&&e.s.bgColor.theme&&(e.s.bgColor.rgb=id(s.themeElements.clrScheme[e.s.bgColor.theme].rgb,e.s.bgColor.tint||0),n.WTF&&(e.s.bgColor.raw_rgb=s.themeElements.clrScheme[e.s.bgColor.theme].rgb))}catch(o){if(n.WTF&&a.Fills)throw o}}}function NU(e,t){var r=Bt(t);r.s.r<=r.e.r&&r.s.c<=r.e.c&&r.s.r>=0&&r.s.c>=0&&(e["!ref"]=rt(r))}var bU=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,PU=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,DU=/<(?:\w:)?hyperlink [^>]*>/mg,FU=/"(\w*:\w*)"/,OU=/<(?:\w:)?col\b[^>]*[\/]?>/g,MU=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,LU=/<(?:\w:)?pageMargins[^>]*\/>/g,_I=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,jU=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,VU=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function UU(e,t,r,n,s,a,i){if(!e)return e;n||(n={"!id":{}});var o=t.dense?[]:{},l={s:{r:2e6,c:2e6},e:{r:0,c:0}},c="",u="",h=e.match(PU);h?(c=e.slice(0,h.index),u=e.slice(h.index+h[0].length)):c=u=e;var m=c.match(_I);m?hx(m[0],o,s,r):(m=c.match(jU))&&BU(m[0],m[1]||"",o,s,r);var p=(c.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(p>0){var x=c.slice(p,p+50).match(FU);x&&NU(o,x[1])}var v=c.match(VU);v&&v[1]&&KU(v[1],s);var w=[];if(t.cellStyles){var k=c.match(OU);k&&WU(w,k)}h&&qU(h[1],o,t,l,a,i);var T=u.match(MU);T&&(o["!autofilter"]=HU(T[0]));var E=[],N=u.match(bU);if(N)for(p=0;p!=N.length;++p)E[p]=Bt(N[p].slice(N[p].indexOf('"')+1));var O=u.match(DU);O&&zU(o,O,n);var L=u.match(LU);if(L&&(o["!margins"]=$U(Oe(L[0]))),!o["!ref"]&&l.e.c>=l.s.c&&l.e.r>=l.s.r&&(o["!ref"]=rt(l)),t.sheetRows>0&&o["!ref"]){var g=Bt(o["!ref"]);t.sheetRows<=+g.e.r&&(g.e.r=t.sheetRows-1,g.e.r>l.e.r&&(g.e.r=l.e.r),g.e.r<g.s.r&&(g.s.r=g.e.r),g.e.c>l.e.c&&(g.e.c=l.e.c),g.e.c<g.s.c&&(g.s.c=g.e.c),o["!fullref"]=o["!ref"],o["!ref"]=rt(g))}return w.length>0&&(o["!cols"]=w),E.length>0&&(o["!merges"]=E),o}function hx(e,t,r,n){var s=Oe(e);r.Sheets[n]||(r.Sheets[n]={}),s.codeName&&(r.Sheets[n].CodeName=it(Et(s.codeName)))}function BU(e,t,r,n,s){hx(e.slice(0,e.indexOf(">")),r,n,s)}function zU(e,t,r){for(var n=Array.isArray(e),s=0;s!=t.length;++s){var a=Oe(Et(t[s]),!0);if(!a.ref)return;var i=((r||{})["!id"]||[])[a.id];i?(a.Target=i.Target,a.location&&(a.Target+="#"+it(a.location))):(a.Target="#"+it(a.location),i={Target:a.Target,TargetMode:"Internal"}),a.Rel=i,a.tooltip&&(a.Tooltip=a.tooltip,delete a.tooltip);for(var o=Bt(a.ref),l=o.s.r;l<=o.e.r;++l)for(var c=o.s.c;c<=o.e.c;++c){var u=Ue({c,r:l});n?(e[l]||(e[l]=[]),e[l][c]||(e[l][c]={t:"z",v:void 0}),e[l][c].l=a):(e[u]||(e[u]={t:"z",v:void 0}),e[u].l=a)}}}function $U(e){var t={};return["left","right","top","bottom","header","footer"].forEach(function(r){e[r]&&(t[r]=parseFloat(e[r]))}),t}function WU(e,t){for(var r=!1,n=0;n!=t.length;++n){var s=Oe(t[n],!0);s.hidden&&(s.hidden=bt(s.hidden));var a=parseInt(s.min,10)-1,i=parseInt(s.max,10)-1;for(s.outlineLevel&&(s.level=+s.outlineLevel||0),delete s.min,delete s.max,s.width=+s.width,!r&&s.width&&(r=!0,ux(s.width)),pl(s);a<=i;)e[a++]=Er(s)}}function HU(e){var t={ref:(e.match(/ref="([^"]*)"/)||[])[1]};return t}var GU=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function KU(e,t){t.Views||(t.Views=[{}]),(e.match(GU)||[]).forEach(function(r,n){var s=Oe(r);t.Views[n]||(t.Views[n]={}),+s.zoomScale&&(t.Views[n].zoom=+s.zoomScale),bt(s.rightToLeft)&&(t.Views[n].RTL=!0)})}var qU=function(){var e=/<(?:\w+:)?c[ \/>]/,t=/<\/(?:\w+:)?row>/,r=/r=["']([^"']*)["']/,n=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,s=/ref=["']([^"']*)["']/,a=lu("v"),i=lu("f");return function(l,c,u,h,m,p){for(var x=0,v="",w=[],k=[],T=0,E=0,N=0,O="",L,g,y=0,S=0,R,b,P=0,C=0,le=Array.isArray(p.CellXf),se,he=[],de=[],ie=Array.isArray(c),H=[],ce={},ve=!1,B=!!u.sheetStubs,K=l.split(t),q=0,G=K.length;q!=G;++q){v=K[q].trim();var oe=v.length;if(oe!==0){var xe=0;e:for(x=0;x<oe;++x)switch(v[x]){case">":if(v[x-1]!="/"){++x;break e}if(u&&u.cellStyles){if(g=Oe(v.slice(xe,x),!0),y=g.r!=null?parseInt(g.r,10):y+1,S=-1,u.sheetRows&&u.sheetRows<y)continue;ce={},ve=!1,g.ht&&(ve=!0,ce.hpt=parseFloat(g.ht),ce.hpx=hu(ce.hpt)),g.hidden=="1"&&(ve=!0,ce.hidden=!0),g.outlineLevel!=null&&(ve=!0,ce.level=+g.outlineLevel),ve&&(H[y-1]=ce)}break;case"<":xe=x;break}if(xe>=x)break;if(g=Oe(v.slice(xe,x),!0),y=g.r!=null?parseInt(g.r,10):y+1,S=-1,!(u.sheetRows&&u.sheetRows<y)){h.s.r>y-1&&(h.s.r=y-1),h.e.r<y-1&&(h.e.r=y-1),u&&u.cellStyles&&(ce={},ve=!1,g.ht&&(ve=!0,ce.hpt=parseFloat(g.ht),ce.hpx=hu(ce.hpt)),g.hidden=="1"&&(ve=!0,ce.hidden=!0),g.outlineLevel!=null&&(ve=!0,ce.level=+g.outlineLevel),ve&&(H[y-1]=ce)),w=v.slice(x).split(e);for(var Ce=0;Ce!=w.length&&w[Ce].trim().charAt(0)=="<";++Ce);for(w=w.slice(Ce),x=0;x!=w.length;++x)if(v=w[x].trim(),v.length!==0){if(k=v.match(r),T=x,E=0,N=0,v="<c "+(v.slice(0,1)=="<"?">":"")+v,k!=null&&k.length===2){for(T=0,O=k[1],E=0;E!=O.length&&!((N=O.charCodeAt(E)-64)<1||N>26);++E)T=26*T+N;--T,S=T}else++S;for(E=0;E!=v.length&&v.charCodeAt(E)!==62;++E);if(++E,g=Oe(v.slice(0,E),!0),g.r||(g.r=Ue({r:y-1,c:S})),O=v.slice(E),L={t:""},(k=O.match(a))!=null&&k[1]!==""&&(L.v=it(k[1])),u.cellFormula){if((k=O.match(i))!=null&&k[1]!==""){if(L.f=it(Et(k[1])).replace(/\r\n/g,`
`),u.xlfn||(L.f=Fw(L.f)),k[0].indexOf('t="array"')>-1)L.F=(O.match(s)||[])[1],L.F.indexOf(":")>-1&&he.push([Bt(L.F),L.F]);else if(k[0].indexOf('t="shared"')>-1){b=Oe(k[0]);var Te=it(Et(k[1]));u.xlfn||(Te=Fw(Te)),de[parseInt(b.si,10)]=[b,Te,g.r]}}else(k=O.match(/<f[^>]*\/>/))&&(b=Oe(k[0]),de[b.si]&&(L.f=aV(de[b.si][1],de[b.si][2],g.r)));var _e=qr(g.r);for(E=0;E<he.length;++E)_e.r>=he[E][0].s.r&&_e.r<=he[E][0].e.r&&_e.c>=he[E][0].s.c&&_e.c<=he[E][0].e.c&&(L.F=he[E][1])}if(g.t==null&&L.v===void 0)if(L.f||L.F)L.v=0,L.t="n";else if(B)L.t="z";else continue;else L.t=g.t||"n";switch(h.s.c>S&&(h.s.c=S),h.e.c<S&&(h.e.c=S),L.t){case"n":if(L.v==""||L.v==null){if(!B)continue;L.t="z"}else L.v=parseFloat(L.v);break;case"s":if(typeof L.v>"u"){if(!B)continue;L.t="z"}else R=Cc[parseInt(L.v,10)],L.v=R.t,L.r=R.r,u.cellHTML&&(L.h=R.h);break;case"str":L.t="s",L.v=L.v!=null?Et(L.v):"",u.cellHTML&&(L.h=Zv(L.v));break;case"inlineStr":k=O.match(n),L.t="s",k!=null&&(R=cx(k[1]))?(L.v=R.t,u.cellHTML&&(L.h=R.h)):L.v="";break;case"b":L.v=bt(L.v);break;case"d":u.cellDates?L.v=dr(L.v,1):(L.v=Jr(dr(L.v,1)),L.t="n");break;case"e":(!u||u.cellText!==!1)&&(L.w=L.v),L.v=UA[L.v];break}if(P=C=0,se=null,le&&g.s!==void 0&&(se=p.CellXf[g.s],se!=null&&(se.numFmtId!=null&&(P=se.numFmtId),u.cellStyles&&se.fillId!=null&&(C=se.fillId))),xI(L,P,C,u,m,p),u.cellDates&&le&&L.t=="n"&&kl(ze[P])&&(L.t="d",L.v=t0(L.v)),g.cm&&u.xlmeta){var $e=(u.xlmeta.Cell||[])[+g.cm-1];$e&&$e.type=="XLDAPR"&&(L.D=!0)}if(ie){var z=qr(g.r);c[z.r]||(c[z.r]=[]),c[z.r][z.c]=L}else c[g.r]=L}}}}H.length>0&&(c["!rows"]=H)}}();function XU(e,t){var r={},n=e.l+t;r.r=e.read_shift(4),e.l+=4;var s=e.read_shift(2);e.l+=1;var a=e.read_shift(1);return e.l=n,a&7&&(r.level=a&7),a&16&&(r.hidden=!0),a&32&&(r.hpt=s/20),r}var YU=io;function QU(){}function JU(e,t){var r={},n=e[e.l];return++e.l,r.above=!(n&64),r.left=!(n&128),e.l+=18,r.name=y8(e),r}function ZU(e){var t=Wn(e);return[t]}function eB(e){var t=ao(e);return[t]}function tB(e){var t=Wn(e),r=e.read_shift(1);return[t,r,"b"]}function rB(e){var t=ao(e),r=e.read_shift(1);return[t,r,"b"]}function nB(e){var t=Wn(e),r=e.read_shift(1);return[t,r,"e"]}function sB(e){var t=ao(e),r=e.read_shift(1);return[t,r,"e"]}function aB(e){var t=Wn(e),r=e.read_shift(4);return[t,r,"s"]}function iB(e){var t=ao(e),r=e.read_shift(4);return[t,r,"s"]}function oB(e){var t=Wn(e),r=Lr(e);return[t,r,"n"]}function yI(e){var t=ao(e),r=Lr(e);return[t,r,"n"]}function lB(e){var t=Wn(e),r=ix(e);return[t,r,"n"]}function cB(e){var t=ao(e),r=ix(e);return[t,r,"n"]}function uB(e){var t=Wn(e),r=sx(e);return[t,r,"is"]}function fB(e){var t=Wn(e),r=Ur(e);return[t,r,"str"]}function hB(e){var t=ao(e),r=Ur(e);return[t,r,"str"]}function dB(e,t,r){var n=e.l+t,s=Wn(e);s.r=r["!row"];var a=e.read_shift(1),i=[s,a,"b"];if(r.cellFormula){e.l+=2;var o=s0(e,n-e.l,r);i[3]=Fr(o,null,s,r.supbooks,r)}else e.l=n;return i}function mB(e,t,r){var n=e.l+t,s=Wn(e);s.r=r["!row"];var a=e.read_shift(1),i=[s,a,"e"];if(r.cellFormula){e.l+=2;var o=s0(e,n-e.l,r);i[3]=Fr(o,null,s,r.supbooks,r)}else e.l=n;return i}function pB(e,t,r){var n=e.l+t,s=Wn(e);s.r=r["!row"];var a=Lr(e),i=[s,a,"n"];if(r.cellFormula){e.l+=2;var o=s0(e,n-e.l,r);i[3]=Fr(o,null,s,r.supbooks,r)}else e.l=n;return i}function gB(e,t,r){var n=e.l+t,s=Wn(e);s.r=r["!row"];var a=Ur(e),i=[s,a,"str"];if(r.cellFormula){e.l+=2;var o=s0(e,n-e.l,r);i[3]=Fr(o,null,s,r.supbooks,r)}else e.l=n;return i}var vB=io;function xB(e,t){var r=e.l+t,n=io(e),s=ax(e),a=Ur(e),i=Ur(e),o=Ur(e);e.l=r;var l={rfx:n,relId:s,loc:a,display:o};return i&&(l.Tooltip=i),l}function _B(){}function yB(e,t,r){var n=e.l+t,s=LA(e),a=e.read_shift(1),i=[s];if(i[2]=a,r.cellFormula){var o=SU(e,n-e.l,r);i[1]=o}else e.l=n;return i}function wB(e,t,r){var n=e.l+t,s=io(e),a=[s];if(r.cellFormula){var i=IU(e,n-e.l,r);a[1]=i,e.l=n}else e.l=n;return a}var EB=["left","right","top","bottom","header","footer"];function TB(e){var t={};return EB.forEach(function(r){t[r]=Lr(e)}),t}function kB(e){var t=e.read_shift(2);return e.l+=28,{RTL:t&32}}function SB(){}function AB(){}function IB(e,t,r,n,s,a,i){if(!e)return e;var o=t||{};n||(n={"!id":{}});var l=o.dense?[]:{},c,u={s:{r:2e6,c:2e6},e:{r:0,c:0}},h=!1,m=!1,p,x,v,w,k,T,E,N,O,L=[];o.biff=12,o["!row"]=0;var g=0,y=!1,S=[],R={},b=o.supbooks||s.supbooks||[[]];if(b.sharedf=R,b.arrayf=S,b.SheetNames=s.SheetNames||s.Sheets.map(function(ie){return ie.name}),!o.supbooks&&(o.supbooks=b,s.Names))for(var P=0;P<s.Names.length;++P)b[0][P+1]=s.Names[P];var C=[],le=[],se=!1;cd[16]={n:"BrtShortReal",f:yI};var he;if(ya(e,function(H,ce,ve){if(!m)switch(ve){case 148:c=H;break;case 0:p=H,o.sheetRows&&o.sheetRows<=p.r&&(m=!0),N=Tr(w=p.r),o["!row"]=p.r,(H.hidden||H.hpt||H.level!=null)&&(H.hpt&&(H.hpx=hu(H.hpt)),le[H.r]=H);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(x={t:H[2]},H[2]){case"n":x.v=H[1];break;case"s":E=Cc[H[1]],x.v=E.t,x.r=E.r;break;case"b":x.v=!!H[1];break;case"e":x.v=H[1],o.cellText!==!1&&(x.w=oo[x.v]);break;case"str":x.t="s",x.v=H[1];break;case"is":x.t="s",x.v=H[1].t;break}if((v=i.CellXf[H[0].iStyleRef])&&xI(x,v.numFmtId,null,o,a,i),k=H[0].c==-1?k+1:H[0].c,o.dense?(l[w]||(l[w]=[]),l[w][k]=x):l[sr(k)+N]=x,o.cellFormula){for(y=!1,g=0;g<S.length;++g){var B=S[g];p.r>=B[0].s.r&&p.r<=B[0].e.r&&k>=B[0].s.c&&k<=B[0].e.c&&(x.F=rt(B[0]),y=!0)}!y&&H.length>3&&(x.f=H[3])}if(u.s.r>p.r&&(u.s.r=p.r),u.s.c>k&&(u.s.c=k),u.e.r<p.r&&(u.e.r=p.r),u.e.c<k&&(u.e.c=k),o.cellDates&&v&&x.t=="n"&&kl(ze[v.numFmtId])){var K=bi(x.v);K&&(x.t="d",x.v=new Date(K.y,K.m-1,K.d,K.H,K.M,K.S,K.u))}he&&(he.type=="XLDAPR"&&(x.D=!0),he=void 0);break;case 1:case 12:if(!o.sheetStubs||h)break;x={t:"z",v:void 0},k=H[0].c==-1?k+1:H[0].c,o.dense?(l[w]||(l[w]=[]),l[w][k]=x):l[sr(k)+N]=x,u.s.r>p.r&&(u.s.r=p.r),u.s.c>k&&(u.s.c=k),u.e.r<p.r&&(u.e.r=p.r),u.e.c<k&&(u.e.c=k),he&&(he.type=="XLDAPR"&&(x.D=!0),he=void 0);break;case 176:L.push(H);break;case 49:he=((o.xlmeta||{}).Cell||[])[H-1];break;case 494:var q=n["!id"][H.relId];for(q?(H.Target=q.Target,H.loc&&(H.Target+="#"+H.loc),H.Rel=q):H.relId==""&&(H.Target="#"+H.loc),w=H.rfx.s.r;w<=H.rfx.e.r;++w)for(k=H.rfx.s.c;k<=H.rfx.e.c;++k)o.dense?(l[w]||(l[w]=[]),l[w][k]||(l[w][k]={t:"z",v:void 0}),l[w][k].l=H):(T=Ue({c:k,r:w}),l[T]||(l[T]={t:"z",v:void 0}),l[T].l=H);break;case 426:if(!o.cellFormula)break;S.push(H),O=o.dense?l[w][k]:l[sr(k)+N],O.f=Fr(H[1],u,{r:p.r,c:k},b,o),O.F=rt(H[0]);break;case 427:if(!o.cellFormula)break;R[Ue(H[0].s)]=H[1],O=o.dense?l[w][k]:l[sr(k)+N],O.f=Fr(H[1],u,{r:p.r,c:k},b,o);break;case 60:if(!o.cellStyles)break;for(;H.e>=H.s;)C[H.e--]={width:H.w/256,hidden:!!(H.flags&1),level:H.level},se||(se=!0,ux(H.w/256)),pl(C[H.e+1]);break;case 161:l["!autofilter"]={ref:rt(H)};break;case 476:l["!margins"]=H;break;case 147:s.Sheets[r]||(s.Sheets[r]={}),H.name&&(s.Sheets[r].CodeName=H.name),(H.above||H.left)&&(l["!outline"]={above:H.above,left:H.left});break;case 137:s.Views||(s.Views=[{}]),s.Views[0]||(s.Views[0]={}),H.RTL&&(s.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:h=!0;break;case 36:h=!1;break;case 37:h=!0;break;case 38:h=!1;break;default:if(!ce.T){if(!h||o.WTF)throw new Error("Unexpected record 0x"+ve.toString(16))}}},o),delete o.supbooks,delete o["!row"],!l["!ref"]&&(u.s.r<2e6||c&&(c.e.r>0||c.e.c>0||c.s.r>0||c.s.c>0))&&(l["!ref"]=rt(c||u)),o.sheetRows&&l["!ref"]){var de=Bt(l["!ref"]);o.sheetRows<=+de.e.r&&(de.e.r=o.sheetRows-1,de.e.r>u.e.r&&(de.e.r=u.e.r),de.e.r<de.s.r&&(de.s.r=de.e.r),de.e.c>u.e.c&&(de.e.c=u.e.c),de.e.c<de.s.c&&(de.s.c=de.e.c),l["!fullref"]=l["!ref"],l["!ref"]=rt(de))}return L.length>0&&(l["!merges"]=L),C.length>0&&(l["!cols"]=C),le.length>0&&(l["!rows"]=le),l}function CB(e){var t=[],r=e.match(/^<c:numCache>/),n;(e.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(a){var i=a.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);i&&(t[+i[1]]=r?+i[2]:i[2])});var s=it((e.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(e.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(a){n=a.replace(/<.*?>/g,"")}),[t,s,n]}function RB(e,t,r,n,s,a){var i=a||{"!type":"chart"};if(!e)return a;var o=0,l=0,c="A",u={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(e.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(h){var m=CB(h);u.s.r=u.s.c=0,u.e.c=o,c=sr(o),m[0].forEach(function(p,x){i[c+Tr(x)]={t:"n",v:p,z:m[1]},l=x}),u.e.r<l&&(u.e.r=l),++o}),o>0&&(i["!ref"]=rt(u)),i}function NB(e,t,r,n,s){if(!e)return e;n||(n={"!id":{}});var a={"!type":"chart","!drawel":null,"!rel":""},i,o=e.match(_I);return o&&hx(o[0],a,s,r),(i=e.match(/drawing r:id="(.*?)"/))&&(a["!rel"]=i[1]),n["!id"][a["!rel"]]&&(a["!drawel"]=n["!id"][a["!rel"]]),a}function bB(e,t){e.l+=10;var r=Ur(e);return{name:r}}function PB(e,t,r,n,s){if(!e)return e;n||(n={"!id":{}});var a={"!type":"chart","!drawel":null,"!rel":""},i=!1;return ya(e,function(l,c,u){switch(u){case 550:a["!rel"]=l;break;case 651:s.Sheets[r]||(s.Sheets[r]={}),l.name&&(s.Sheets[r].CodeName=l.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:i=!0;break;case 36:i=!1;break;case 37:break;case 38:break;default:if(!(c.T>0)){if(!(c.T<0)){if(!i||t.WTF)throw new Error("Unexpected record 0x"+u.toString(16))}}}},t),n["!id"][a["!rel"]]&&(a["!drawel"]=n["!id"][a["!rel"]]),a}var wI=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],DB=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],FB=[],OB=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function Vw(e,t){for(var r=0;r!=e.length;++r)for(var n=e[r],s=0;s!=t.length;++s){var a=t[s];if(n[a[0]]==null)n[a[0]]=a[1];else switch(a[2]){case"bool":typeof n[a[0]]=="string"&&(n[a[0]]=bt(n[a[0]]));break;case"int":typeof n[a[0]]=="string"&&(n[a[0]]=parseInt(n[a[0]],10));break}}}function Uw(e,t){for(var r=0;r!=t.length;++r){var n=t[r];if(e[n[0]]==null)e[n[0]]=n[1];else switch(n[2]){case"bool":typeof e[n[0]]=="string"&&(e[n[0]]=bt(e[n[0]]));break;case"int":typeof e[n[0]]=="string"&&(e[n[0]]=parseInt(e[n[0]],10));break}}}function EI(e){Uw(e.WBProps,wI),Uw(e.CalcPr,OB),Vw(e.WBView,DB),Vw(e.Sheets,FB),Xo.date1904=bt(e.WBProps.date1904)}var MB="][*?/\\".split("");function LB(e,t){if(e.length>31)throw new Error("Sheet names cannot exceed 31 chars");var r=!0;return MB.forEach(function(n){if(e.indexOf(n)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),r}var jB=/<\w+:workbook/;function VB(e,t){if(!e)throw new Error("Could not find file");var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},n=!1,s="xmlns",a={},i=0;if(e.replace(Wr,function(l,c){var u=Oe(l);switch(Fs(u[0])){case"<?xml":break;case"<workbook":l.match(jB)&&(s="xmlns"+l.match(/<(\w+):/)[1]),r.xmlns=u[s];break;case"</workbook>":break;case"<fileVersion":delete u[0],r.AppVersion=u;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":wI.forEach(function(h){if(u[h[0]]!=null)switch(h[2]){case"bool":r.WBProps[h[0]]=bt(u[h[0]]);break;case"int":r.WBProps[h[0]]=parseInt(u[h[0]],10);break;default:r.WBProps[h[0]]=u[h[0]]}}),u.codeName&&(r.WBProps.CodeName=Et(u.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete u[0],r.WBView.push(u);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(u.state){case"hidden":u.Hidden=1;break;case"veryHidden":u.Hidden=2;break;default:u.Hidden=0}delete u.state,u.name=it(Et(u.name)),delete u[0],r.Sheets.push(u);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":n=!0;break;case"</definedNames>":n=!1;break;case"<definedName":a={},a.Name=Et(u.name),u.comment&&(a.Comment=u.comment),u.localSheetId&&(a.Sheet=+u.localSheetId),bt(u.hidden||"0")&&(a.Hidden=!0),i=c+l.length;break;case"</definedName>":a.Ref=it(Et(e.slice(i,c))),r.Names.push(a);break;case"<definedName/>":break;case"<calcPr":delete u[0],r.CalcPr=u;break;case"<calcPr/>":delete u[0],r.CalcPr=u;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":n=!0;break;case"</AlternateContent>":n=!1;break;case"<revisionPtr":break;default:if(!n&&t.WTF)throw new Error("unrecognized "+u[0]+" in workbook")}return l}),n8.indexOf(r.xmlns)===-1)throw new Error("Unknown Namespace: "+r.xmlns);return EI(r),r}function UB(e,t){var r={};return r.Hidden=e.read_shift(4),r.iTabID=e.read_shift(4),r.strRelID=Dp(e),r.name=Ur(e),r}function BB(e,t){var r={},n=e.read_shift(4);r.defaultThemeVersion=e.read_shift(4);var s=t>8?Ur(e):"";return s.length>0&&(r.CodeName=s),r.autoCompressPictures=!!(n&65536),r.backupFile=!!(n&64),r.checkCompatibility=!!(n&4096),r.date1904=!!(n&1),r.filterPrivacy=!!(n&8),r.hidePivotFieldList=!!(n&1024),r.promptedSolutions=!!(n&16),r.publishItems=!!(n&2048),r.refreshAllConnections=!!(n&262144),r.saveExternalLinkValues=!!(n&128),r.showBorderUnselectedTables=!!(n&4),r.showInkAnnotation=!!(n&32),r.showObjects=["all","placeholders","none"][n>>13&3],r.showPivotChartFilter=!!(n&32768),r.updateLinks=["userSet","never","always"][n>>8&3],r}function zB(e,t){var r={};return e.read_shift(4),r.ArchID=e.read_shift(4),e.l+=t-8,r}function $B(e,t,r){var n=e.l+t;e.l+=4,e.l+=1;var s=e.read_shift(4),a=w8(e),i=AU(e,0,r),o=ax(e);e.l=n;var l={Name:a,Ptg:i};return s<268435455&&(l.Sheet=s),o&&(l.Comment=o),l}function WB(e,t){var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},n=[],s=!1;t||(t={}),t.biff=12;var a=[],i=[[]];return i.SheetNames=[],i.XTI=[],cd[16]={n:"BrtFRTArchID$",f:zB},ya(e,function(l,c,u){switch(u){case 156:i.SheetNames.push(l.name),r.Sheets.push(l);break;case 153:r.WBProps=l;break;case 39:l.Sheet!=null&&(t.SID=l.Sheet),l.Ref=Fr(l.Ptg,null,null,i,t),delete t.SID,delete l.Ptg,a.push(l);break;case 1036:break;case 357:case 358:case 355:case 667:i[0].length?i.push([u,l]):i[0]=[u,l],i[i.length-1].XTI=[];break;case 362:i.length===0&&(i[0]=[],i[0].XTI=[]),i[i.length-1].XTI=i[i.length-1].XTI.concat(l),i.XTI=i.XTI.concat(l);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:n.push(u),s=!0;break;case 36:n.pop(),s=!1;break;case 37:n.push(u),s=!0;break;case 38:n.pop(),s=!1;break;case 16:break;default:if(!c.T){if(!s||t.WTF&&n[n.length-1]!=37&&n[n.length-1]!=35)throw new Error("Unexpected record 0x"+u.toString(16))}}},t),EI(r),r.Names=a,r.supbooks=i,r}function HB(e,t,r){return t.slice(-4)===".bin"?WB(e,r):VB(e,r)}function GB(e,t,r,n,s,a,i,o){return t.slice(-4)===".bin"?IB(e,n,r,s,a,i,o):UU(e,n,r,s,a,i,o)}function KB(e,t,r,n,s,a,i,o){return t.slice(-4)===".bin"?PB(e,n,r,s,a):NB(e,n,r,s,a)}function qB(e,t,r,n,s,a,i,o){return t.slice(-4)===".bin"?rV():nV()}function XB(e,t,r,n,s,a,i,o){return t.slice(-4)===".bin"?eV():tV()}function YB(e,t,r,n){return t.slice(-4)===".bin"?v9(e,r,n):f9(e,r,n)}function QB(e,t,r){return lI(e,r)}function JB(e,t,r){return t.slice(-4)===".bin"?Dj(e,r):bj(e,r)}function ZB(e,t,r){return t.slice(-4)===".bin"?Q9(e,r):G9(e,r)}function e7(e,t,r){return t.slice(-4)===".bin"?$9(e):B9(e)}function t7(e,t,r,n){return r.slice(-4)===".bin"?W9(e,t,r,n):void 0}function r7(e,t,r){return t.slice(-4)===".bin"?V9(e,t,r):U9(e,t,r)}var TI=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,kI=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function qn(e,t){var r=e.split(/\s+/),n=[];if(n[0]=r[0],r.length===1)return n;var s=e.match(TI),a,i,o,l;if(s)for(l=0;l!=s.length;++l)a=s[l].match(kI),(i=a[1].indexOf(":"))===-1?n[a[1]]=a[2].slice(1,a[2].length-1):(a[1].slice(0,6)==="xmlns:"?o="xmlns"+a[1].slice(6):o=a[1].slice(i+1),n[o]=a[2].slice(1,a[2].length-1));return n}function n7(e){var t=e.split(/\s+/),r={};if(t.length===1)return r;var n=e.match(TI),s,a,i,o;if(n)for(o=0;o!=n.length;++o)s=n[o].match(kI),(a=s[1].indexOf(":"))===-1?r[s[1]]=s[2].slice(1,s[2].length-1):(s[1].slice(0,6)==="xmlns:"?i="xmlns"+s[1].slice(6):i=s[1].slice(a+1),r[i]=s[2].slice(1,s[2].length-1));return r}var Nc;function s7(e,t){var r=Nc[e]||it(e);return r==="General"?qi(t):$n(r,t)}function a7(e,t,r,n){var s=n;switch((r[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":s=bt(n);break;case"i2":case"int":s=parseInt(n,10);break;case"r4":case"float":s=parseFloat(n);break;case"date":case"dateTime.tz":s=dr(n);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+r[0])}e[it(t)]=s}function i7(e,t,r){if(e.t!=="z"){if(!r||r.cellText!==!1)try{e.t==="e"?e.w=e.w||oo[e.v]:t==="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=ou(e.v):e.w=qi(e.v):e.w=s7(t||"General",e.v)}catch(a){if(r.WTF)throw a}try{var n=Nc[t]||t||"General";if(r.cellNF&&(e.z=n),r.cellDates&&e.t=="n"&&kl(n)){var s=bi(e.v);s&&(e.t="d",e.v=new Date(s.y,s.m-1,s.d,s.H,s.M,s.S,s.u))}}catch(a){if(r.WTF)throw a}}}function o7(e,t,r){if(r.cellStyles&&t.Interior){var n=t.Interior;n.Pattern&&(n.patternType=a9[n.Pattern]||n.Pattern)}e[t.ID]=t}function l7(e,t,r,n,s,a,i,o,l,c){var u="General",h=n.StyleID,m={};c=c||{};var p=[],x=0;for(h===void 0&&o&&(h=o.StyleID),h===void 0&&i&&(h=i.StyleID);a[h]!==void 0&&(a[h].nf&&(u=a[h].nf),a[h].Interior&&p.push(a[h].Interior),!!a[h].Parent);)h=a[h].Parent;switch(r.Type){case"Boolean":n.t="b",n.v=bt(e);break;case"String":n.t="s",n.r=lw(it(e)),n.v=e.indexOf("<")>-1?it(t||e).replace(/<.*?>/g,""):n.r;break;case"DateTime":e.slice(-1)!="Z"&&(e+="Z"),n.v=(dr(e)-new Date(Date.UTC(1899,11,30)))/(24*60*60*1e3),n.v!==n.v?n.v=it(e):n.v<60&&(n.v=n.v-1),(!u||u=="General")&&(u="yyyy-mm-dd");case"Number":n.v===void 0&&(n.v=+e),n.t||(n.t="n");break;case"Error":n.t="e",n.v=UA[e],c.cellText!==!1&&(n.w=e);break;default:e==""&&t==""?n.t="z":(n.t="s",n.v=lw(t||e));break}if(i7(n,u,c),c.cellFormula!==!1)if(n.Formula){var v=it(n.Formula);v.charCodeAt(0)==61&&(v=v.slice(1)),n.f=qo(v,s),delete n.Formula,n.ArrayRange=="RC"?n.F=qo("RC:RC",s):n.ArrayRange&&(n.F=qo(n.ArrayRange,s),l.push([Bt(n.F),n.F]))}else for(x=0;x<l.length;++x)s.r>=l[x][0].s.r&&s.r<=l[x][0].e.r&&s.c>=l[x][0].s.c&&s.c<=l[x][0].e.c&&(n.F=l[x][1]);c.cellStyles&&(p.forEach(function(w){!m.patternType&&w.patternType&&(m.patternType=w.patternType)}),n.s=m),n.StyleID!==void 0&&(n.ixfe=n.StyleID)}function c7(e){e.t=e.v||"",e.t=e.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.v=e.w=e.ixfe=void 0}function sm(e,t){var r=t||{};hA();var n=nc(ex(e));(r.type=="binary"||r.type=="array"||r.type=="base64")&&(n=Et(n));var s=n.slice(0,1024).toLowerCase(),a=!1;if(s=s.replace(/".*?"/g,""),(s.indexOf(">")&1023)>Math.min(s.indexOf(",")&1023,s.indexOf(";")&1023)){var i=Er(r);return i.type="string",uu.to_workbook(n,i)}if(s.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(Tt){s.indexOf("<"+Tt)>=0&&(a=!0)}),a)return x7(n,r);Nc={"General Number":"General","General Date":ze[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":ze[15],"Short Date":ze[14],"Long Time":ze[19],"Medium Time":ze[18],"Short Time":ze[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:ze[2],Standard:ze[4],Percent:ze[10],Scientific:ze[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var o,l=[],c,u={},h=[],m=r.dense?[]:{},p="",x={},v={},w=qn('<Data ss:Type="String">'),k=0,T=0,E=0,N={s:{r:2e6,c:2e6},e:{r:0,c:0}},O={},L={},g="",y=0,S=[],R={},b={},P=0,C=[],le=[],se={},he=[],de,ie=!1,H=[],ce=[],ve={},B=0,K=0,q={Sheets:[],WBProps:{date1904:!1}},G={};cu.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"");for(var oe="";o=cu.exec(n);)switch(o[3]=(oe=o[3]).toLowerCase()){case"data":if(oe=="data"){if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&l.push([o[3],!0]);break}if(l[l.length-1][1])break;o[1]==="/"?l7(n.slice(k,o.index),g,w,l[l.length-1][0]=="comment"?se:x,{c:T,r:E},O,he[T],v,H,r):(g="",w=qn(o[0]),k=o.index+o[0].length);break;case"cell":if(o[1]==="/")if(le.length>0&&(x.c=le),(!r.sheetRows||r.sheetRows>E)&&x.v!==void 0&&(r.dense?(m[E]||(m[E]=[]),m[E][T]=x):m[sr(T)+Tr(E)]=x),x.HRef&&(x.l={Target:it(x.HRef)},x.HRefScreenTip&&(x.l.Tooltip=x.HRefScreenTip),delete x.HRef,delete x.HRefScreenTip),(x.MergeAcross||x.MergeDown)&&(B=T+(parseInt(x.MergeAcross,10)|0),K=E+(parseInt(x.MergeDown,10)|0),S.push({s:{c:T,r:E},e:{c:B,r:K}})),!r.sheetStubs)x.MergeAcross?T=B+1:++T;else if(x.MergeAcross||x.MergeDown){for(var xe=T;xe<=B;++xe)for(var Ce=E;Ce<=K;++Ce)(xe>T||Ce>E)&&(r.dense?(m[Ce]||(m[Ce]=[]),m[Ce][xe]={t:"z"}):m[sr(xe)+Tr(Ce)]={t:"z"});T=B+1}else++T;else x=n7(o[0]),x.Index&&(T=+x.Index-1),T<N.s.c&&(N.s.c=T),T>N.e.c&&(N.e.c=T),o[0].slice(-2)==="/>"&&++T,le=[];break;case"row":o[1]==="/"||o[0].slice(-2)==="/>"?(E<N.s.r&&(N.s.r=E),E>N.e.r&&(N.e.r=E),o[0].slice(-2)==="/>"&&(v=qn(o[0]),v.Index&&(E=+v.Index-1)),T=0,++E):(v=qn(o[0]),v.Index&&(E=+v.Index-1),ve={},(v.AutoFitHeight=="0"||v.Height)&&(ve.hpx=parseInt(v.Height,10),ve.hpt=oI(ve.hpx),ce[E]=ve),v.Hidden=="1"&&(ve.hidden=!0,ce[E]=ve));break;case"worksheet":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"));h.push(p),N.s.r<=N.e.r&&N.s.c<=N.e.c&&(m["!ref"]=rt(N),r.sheetRows&&r.sheetRows<=N.e.r&&(m["!fullref"]=m["!ref"],N.e.r=r.sheetRows-1,m["!ref"]=rt(N))),S.length&&(m["!merges"]=S),he.length>0&&(m["!cols"]=he),ce.length>0&&(m["!rows"]=ce),u[p]=m}else N={s:{r:2e6,c:2e6},e:{r:0,c:0}},E=T=0,l.push([o[3],!1]),c=qn(o[0]),p=it(c.Name),m=r.dense?[]:{},S=[],H=[],ce=[],G={name:p,Hidden:0},q.Sheets.push(G);break;case"table":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else{if(o[0].slice(-2)=="/>")break;l.push([o[3],!1]),he=[],ie=!1}break;case"style":o[1]==="/"?o7(O,L,r):L=qn(o[0]);break;case"numberformat":L.nf=it(qn(o[0]).Format||"General"),Nc[L.nf]&&(L.nf=Nc[L.nf]);for(var Te=0;Te!=392&&ze[Te]!=L.nf;++Te);if(Te==392){for(Te=57;Te!=392;++Te)if(ze[Te]==null){Mi(L.nf,Te);break}}break;case"column":if(l[l.length-1][0]!=="table")break;if(de=qn(o[0]),de.Hidden&&(de.hidden=!0,delete de.Hidden),de.Width&&(de.wpx=parseInt(de.Width,10)),!ie&&de.wpx>10){ie=!0,Kr=aI;for(var _e=0;_e<he.length;++_e)he[_e]&&pl(he[_e])}ie&&pl(de),he[de.Index-1||he.length]=de;for(var $e=0;$e<+de.Span;++$e)he[he.length]=Er(de);break;case"namedrange":if(o[1]==="/")break;q.Names||(q.Names=[]);var z=Oe(o[0]),ot={Name:z.Name,Ref:qo(z.RefersTo.slice(1),{r:0,c:0})};q.Sheets.length>0&&(ot.Sheet=q.Sheets.length-1),q.Names.push(ot);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(o[0].slice(-2)==="/>")break;o[1]==="/"?g+=n.slice(y,o.index):y=o.index+o[0].length;break;case"interior":if(!r.cellStyles)break;L.Interior=qn(o[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(o[0].slice(-2)==="/>")break;o[1]==="/"?G8(R,oe,n.slice(P,o.index)):P=o.index+o[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else l.push([o[3],!1]);break;case"comment":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"));c7(se),le.push(se)}else l.push([o[3],!1]),c=qn(o[0]),se={a:c.Author};break;case"autofilter":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else if(o[0].charAt(o[0].length-2)!=="/"){var He=qn(o[0]);m["!autofilter"]={ref:qo(He.Range).replace(/\$/g,"")},l.push([o[3],!0])}break;case"name":break;case"datavalidation":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&l.push([o[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&l.push([o[3],!0]);break;case"null":break;default:if(l.length==0&&o[3]=="document"||l.length==0&&o[3]=="uof")return Gw(n,r);var nt=!0;switch(l[l.length-1][0]){case"officedocumentsettings":switch(o[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:nt=!1}break;case"componentoptions":switch(o[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:nt=!1}break;case"excelworkbook":switch(o[3]){case"date1904":q.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:nt=!1}break;case"workbookoptions":switch(o[3]){case"owcversion":break;case"height":break;case"width":break;default:nt=!1}break;case"worksheetoptions":switch(o[3]){case"visible":if(o[0].slice(-2)!=="/>")if(o[1]==="/")switch(n.slice(P,o.index)){case"SheetHidden":G.Hidden=1;break;case"SheetVeryHidden":G.Hidden=2;break}else P=o.index+o[0].length;break;case"header":m["!margins"]||Rc(m["!margins"]={},"xlml"),isNaN(+Oe(o[0]).Margin)||(m["!margins"].header=+Oe(o[0]).Margin);break;case"footer":m["!margins"]||Rc(m["!margins"]={},"xlml"),isNaN(+Oe(o[0]).Margin)||(m["!margins"].footer=+Oe(o[0]).Margin);break;case"pagemargins":var Fe=Oe(o[0]);m["!margins"]||Rc(m["!margins"]={},"xlml"),isNaN(+Fe.Top)||(m["!margins"].top=+Fe.Top),isNaN(+Fe.Left)||(m["!margins"].left=+Fe.Left),isNaN(+Fe.Right)||(m["!margins"].right=+Fe.Right),isNaN(+Fe.Bottom)||(m["!margins"].bottom=+Fe.Bottom);break;case"displayrighttoleft":q.Views||(q.Views=[]),q.Views[0]||(q.Views[0]={}),q.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":m["!outline"]||(m["!outline"]={}),m["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":m["!outline"]||(m["!outline"]={}),m["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:nt=!1}break;case"pivottable":case"pivotcache":switch(o[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:nt=!1}break;case"pagebreaks":switch(o[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:nt=!1}break;case"autofilter":switch(o[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:nt=!1}break;case"querytable":switch(o[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:nt=!1}break;case"datavalidation":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:nt=!1}break;case"sorting":case"conditionalformatting":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:nt=!1}break;case"mapinfo":case"schema":case"data":switch(o[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:nt=!1}break;case"smarttags":break;default:nt=!1;break}if(nt||o[3].match(/!\[CDATA/))break;if(!l[l.length-1][1])throw"Unrecognized tag: "+o[3]+"|"+l.join("|");if(l[l.length-1][0]==="customdocumentproperties"){if(o[0].slice(-2)==="/>")break;o[1]==="/"?a7(b,oe,C,n.slice(P,o.index)):(C=o,P=o.index+o[0].length);break}if(r.WTF)throw"Unrecognized tag: "+o[3]+"|"+l.join("|")}var Ae={};return!r.bookSheets&&!r.bookProps&&(Ae.Sheets=u),Ae.SheetNames=h,Ae.Workbook=q,Ae.SSF=Er(ze),Ae.Props=R,Ae.Custprops=b,Ae}function Lp(e,t){switch(px(t=t||{}),t.type||"base64"){case"base64":return sm(An(e),t);case"binary":case"buffer":case"file":return sm(e,t);case"array":return sm(so(e),t)}}function u7(e){var t={},r=e.content;if(r.l=28,t.AnsiUserType=r.read_shift(0,"lpstr-ansi"),t.AnsiClipboardFormat=k8(r),r.length-r.l<=4)return t;var n=r.read_shift(4);if(n==0||n>40||(r.l-=4,t.Reserved1=r.read_shift(0,"lpstr-ansi"),r.length-r.l<=4)||(n=r.read_shift(4),n!==1907505652)||(t.UnicodeClipboardFormat=S8(r),n=r.read_shift(4),n==0||n>40))return t;r.l-=4,t.Reserved2=r.read_shift(0,"lpwstr")}var f7=[60,1084,2066,2165,2175];function h7(e,t,r,n,s){var a=n,i=[],o=r.slice(r.l,r.l+a);if(s&&s.enc&&s.enc.insitu&&o.length>0)switch(e){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:s.enc.insitu(o)}i.push(o),r.l+=a;for(var l=Js(r,r.l),c=jp[l],u=0;c!=null&&f7.indexOf(l)>-1;)a=Js(r,r.l+2),u=r.l+4,l==2066?u+=4:(l==2165||l==2175)&&(u+=12),o=r.slice(u,r.l+4+a),i.push(o),r.l+=4+a,c=jp[l=Js(r,r.l)];var h=Ma(i);xr(h,0);var m=0;h.lens=[];for(var p=0;p<i.length;++p)h.lens.push(m),m+=i[p].length;if(h.length<n)throw"XLS Record 0x"+e.toString(16)+" Truncated: "+h.length+" < "+n;return t.f(h,h.length,s)}function gs(e,t,r){if(e.t!=="z"&&e.XF){var n=0;try{n=e.z||e.XF.numFmtId||0,t.cellNF&&(e.z=ze[n])}catch(a){if(t.WTF)throw a}if(!t||t.cellText!==!1)try{e.t==="e"?e.w=e.w||oo[e.v]:n===0||n=="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=ou(e.v):e.w=qi(e.v):e.w=$n(n,e.v,{date1904:!!r,dateNF:t&&t.dateNF})}catch(a){if(t.WTF)throw a}if(t.cellDates&&n&&e.t=="n"&&kl(ze[n]||String(n))){var s=bi(e.v);s&&(e.t="d",e.v=new Date(s.y,s.m-1,s.d,s.H,s.M,s.S,s.u))}}}function Ff(e,t,r){return{v:e,ixfe:t,t:r}}function d7(e,t){var r={opts:{}},n={},s=t.dense?[]:{},a={},i={},o=null,l=[],c="",u={},h,m="",p,x,v,w,k={},T=[],E,N,O=[],L=[],g={Sheets:[],WBProps:{date1904:!1},Views:[{}]},y={},S=function(je){return je<8?Li[je]:je<64&&L[je-8]||Li[je]},R=function(je,xt,Gt){var ut=xt.XF.data;if(!(!ut||!ut.patternType||!Gt||!Gt.cellStyles)){xt.s={},xt.s.patternType=ut.patternType;var pn;(pn=fu(S(ut.icvFore)))&&(xt.s.fgColor={rgb:pn}),(pn=fu(S(ut.icvBack)))&&(xt.s.bgColor={rgb:pn})}},b=function(je,xt,Gt){if(!(ve>1)&&!(Gt.sheetRows&&je.r>=Gt.sheetRows)){if(Gt.cellStyles&&xt.XF&&xt.XF.data&&R(je,xt,Gt),delete xt.ixfe,delete xt.XF,h=je,m=Ue(je),(!i||!i.s||!i.e)&&(i={s:{r:0,c:0},e:{r:0,c:0}}),je.r<i.s.r&&(i.s.r=je.r),je.c<i.s.c&&(i.s.c=je.c),je.r+1>i.e.r&&(i.e.r=je.r+1),je.c+1>i.e.c&&(i.e.c=je.c+1),Gt.cellFormula&&xt.f){for(var ut=0;ut<T.length;++ut)if(!(T[ut][0].s.c>je.c||T[ut][0].s.r>je.r)&&!(T[ut][0].e.c<je.c||T[ut][0].e.r<je.r)){xt.F=rt(T[ut][0]),(T[ut][0].s.c!=je.c||T[ut][0].s.r!=je.r)&&delete xt.f,xt.f&&(xt.f=""+Fr(T[ut][1],i,je,H,P));break}}Gt.dense?(s[je.r]||(s[je.r]=[]),s[je.r][je.c]=xt):s[m]=xt}},P={enc:!1,sbcch:0,snames:[],sharedf:k,arrayf:T,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!t&&!!t.cellStyles,WTF:!!t&&!!t.wtf};t.password&&(P.password=t.password);var C,le=[],se=[],he=[],de=[],ie=!1,H=[];H.SheetNames=P.snames,H.sharedf=P.sharedf,H.arrayf=P.arrayf,H.names=[],H.XTI=[];var ce=0,ve=0,B=0,K=[],q=[],G;P.codepage=1200,ns(1200);for(var oe=!1;e.l<e.length-1;){var xe=e.l,Ce=e.read_shift(2);if(Ce===0&&ce===10)break;var Te=e.l===e.length?0:e.read_shift(2),_e=jp[Ce];if(_e&&_e.f){if(t.bookSheets&&ce===133&&Ce!==133)break;if(ce=Ce,_e.r===2||_e.r==12){var $e=e.read_shift(2);if(Te-=2,!P.enc&&$e!==Ce&&(($e&255)<<8|$e>>8)!==Ce)throw new Error("rt mismatch: "+$e+"!="+Ce);_e.r==12&&(e.l+=10,Te-=10)}var z={};if(Ce===10?z=_e.f(e,Te,P):z=h7(Ce,_e,e,Te,P),ve==0&&[9,521,1033,2057].indexOf(ce)===-1)continue;switch(Ce){case 34:r.opts.Date1904=g.WBProps.date1904=z;break;case 134:r.opts.WriteProtect=!0;break;case 47:if(P.enc||(e.l=0),P.enc=z,!t.password)throw new Error("File is password-protected");if(z.valid==null)throw new Error("Encryption scheme unsupported");if(!z.valid)throw new Error("Password is incorrect");break;case 92:P.lastuser=z;break;case 66:var ot=Number(z);switch(ot){case 21010:ot=1200;break;case 32768:ot=1e4;break;case 32769:ot=1252;break}ns(P.codepage=ot),oe=!0;break;case 317:P.rrtabid=z;break;case 25:P.winlocked=z;break;case 439:r.opts.RefreshAll=z;break;case 12:r.opts.CalcCount=z;break;case 16:r.opts.CalcDelta=z;break;case 17:r.opts.CalcIter=z;break;case 13:r.opts.CalcMode=z;break;case 14:r.opts.CalcPrecision=z;break;case 95:r.opts.CalcSaveRecalc=z;break;case 15:P.CalcRefMode=z;break;case 2211:r.opts.FullCalc=z;break;case 129:z.fDialog&&(s["!type"]="dialog"),z.fBelow||((s["!outline"]||(s["!outline"]={})).above=!0),z.fRight||((s["!outline"]||(s["!outline"]={})).left=!0);break;case 224:O.push(z);break;case 430:H.push([z]),H[H.length-1].XTI=[];break;case 35:case 547:H[H.length-1].push(z);break;case 24:case 536:G={Name:z.Name,Ref:Fr(z.rgce,i,null,H,P)},z.itab>0&&(G.Sheet=z.itab-1),H.names.push(G),H[0]||(H[0]=[],H[0].XTI=[]),H[H.length-1].push(z),z.Name=="_xlnm._FilterDatabase"&&z.itab>0&&z.rgce&&z.rgce[0]&&z.rgce[0][0]&&z.rgce[0][0][0]=="PtgArea3d"&&(q[z.itab-1]={ref:rt(z.rgce[0][0][1][2])});break;case 22:P.ExternCount=z;break;case 23:H.length==0&&(H[0]=[],H[0].XTI=[]),H[H.length-1].XTI=H[H.length-1].XTI.concat(z),H.XTI=H.XTI.concat(z);break;case 2196:if(P.biff<8)break;G!=null&&(G.Comment=z[1]);break;case 18:s["!protect"]=z;break;case 19:z!==0&&P.WTF&&console.error("Password verifier: "+z);break;case 133:a[z.pos]=z,P.snames.push(z.name);break;case 10:{if(--ve)break;if(i.e){if(i.e.r>0&&i.e.c>0){if(i.e.r--,i.e.c--,s["!ref"]=rt(i),t.sheetRows&&t.sheetRows<=i.e.r){var He=i.e.r;i.e.r=t.sheetRows-1,s["!fullref"]=s["!ref"],s["!ref"]=rt(i),i.e.r=He}i.e.r++,i.e.c++}le.length>0&&(s["!merges"]=le),se.length>0&&(s["!objects"]=se),he.length>0&&(s["!cols"]=he),de.length>0&&(s["!rows"]=de),g.Sheets.push(y)}c===""?u=s:n[c]=s,s=t.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(P.biff===8&&(P.biff={9:2,521:3,1033:4}[Ce]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[z.BIFFVer]||8),P.biffguess=z.BIFFVer==0,z.BIFFVer==0&&z.dt==4096&&(P.biff=5,oe=!0,ns(P.codepage=28591)),P.biff==8&&z.BIFFVer==0&&z.dt==16&&(P.biff=2),ve++)break;if(s=t.dense?[]:{},P.biff<8&&!oe&&(oe=!0,ns(P.codepage=t.codepage||1252)),P.biff<5||z.BIFFVer==0&&z.dt==4096){c===""&&(c="Sheet1"),i={s:{r:0,c:0},e:{r:0,c:0}};var nt={pos:e.l-Te,name:c};a[nt.pos]=nt,P.snames.push(c)}else c=(a[xe]||{name:""}).name;z.dt==32&&(s["!type"]="chart"),z.dt==64&&(s["!type"]="macro"),le=[],se=[],P.arrayf=T=[],he=[],de=[],ie=!1,y={Hidden:(a[xe]||{hs:0}).hs,name:c}}break;case 515:case 3:case 2:s["!type"]=="chart"&&(t.dense?(s[z.r]||[])[z.c]:s[Ue({c:z.c,r:z.r})])&&++z.c,E={ixfe:z.ixfe,XF:O[z.ixfe]||{},v:z.val,t:"n"},B>0&&(E.z=K[E.ixfe>>8&63]),gs(E,t,r.opts.Date1904),b({c:z.c,r:z.r},E,t);break;case 5:case 517:E={ixfe:z.ixfe,XF:O[z.ixfe],v:z.val,t:z.t},B>0&&(E.z=K[E.ixfe>>8&63]),gs(E,t,r.opts.Date1904),b({c:z.c,r:z.r},E,t);break;case 638:E={ixfe:z.ixfe,XF:O[z.ixfe],v:z.rknum,t:"n"},B>0&&(E.z=K[E.ixfe>>8&63]),gs(E,t,r.opts.Date1904),b({c:z.c,r:z.r},E,t);break;case 189:for(var Fe=z.c;Fe<=z.C;++Fe){var Ae=z.rkrec[Fe-z.c][0];E={ixfe:Ae,XF:O[Ae],v:z.rkrec[Fe-z.c][1],t:"n"},B>0&&(E.z=K[E.ixfe>>8&63]),gs(E,t,r.opts.Date1904),b({c:Fe,r:z.r},E,t)}break;case 6:case 518:case 1030:{if(z.val=="String"){o=z;break}if(E=Ff(z.val,z.cell.ixfe,z.tt),E.XF=O[E.ixfe],t.cellFormula){var Tt=z.formula;if(Tt&&Tt[0]&&Tt[0][0]&&Tt[0][0][0]=="PtgExp"){var or=Tt[0][0][1][0],Ar=Tt[0][0][1][1],tn=Ue({r:or,c:Ar});k[tn]?E.f=""+Fr(z.formula,i,z.cell,H,P):E.F=((t.dense?(s[or]||[])[Ar]:s[tn])||{}).F}else E.f=""+Fr(z.formula,i,z.cell,H,P)}B>0&&(E.z=K[E.ixfe>>8&63]),gs(E,t,r.opts.Date1904),b(z.cell,E,t),o=z}break;case 7:case 519:if(o)o.val=z,E=Ff(z,o.cell.ixfe,"s"),E.XF=O[E.ixfe],t.cellFormula&&(E.f=""+Fr(o.formula,i,o.cell,H,P)),B>0&&(E.z=K[E.ixfe>>8&63]),gs(E,t,r.opts.Date1904),b(o.cell,E,t),o=null;else throw new Error("String record expects Formula");break;case 33:case 545:{T.push(z);var Ms=Ue(z[0].s);if(p=t.dense?(s[z[0].s.r]||[])[z[0].s.c]:s[Ms],t.cellFormula&&p){if(!o||!Ms||!p)break;p.f=""+Fr(z[1],i,z[0],H,P),p.F=rt(z[0])}}break;case 1212:{if(!t.cellFormula)break;if(m){if(!o)break;k[Ue(o.cell)]=z[0],p=t.dense?(s[o.cell.r]||[])[o.cell.c]:s[Ue(o.cell)],(p||{}).f=""+Fr(z[0],i,h,H,P)}}break;case 253:E=Ff(l[z.isst].t,z.ixfe,"s"),l[z.isst].h&&(E.h=l[z.isst].h),E.XF=O[E.ixfe],B>0&&(E.z=K[E.ixfe>>8&63]),gs(E,t,r.opts.Date1904),b({c:z.c,r:z.r},E,t);break;case 513:t.sheetStubs&&(E={ixfe:z.ixfe,XF:O[z.ixfe],t:"z"},B>0&&(E.z=K[E.ixfe>>8&63]),gs(E,t,r.opts.Date1904),b({c:z.c,r:z.r},E,t));break;case 190:if(t.sheetStubs)for(var rn=z.c;rn<=z.C;++rn){var kt=z.ixfe[rn-z.c];E={ixfe:kt,XF:O[kt],t:"z"},B>0&&(E.z=K[E.ixfe>>8&63]),gs(E,t,r.opts.Date1904),b({c:rn,r:z.r},E,t)}break;case 214:case 516:case 4:E=Ff(z.val,z.ixfe,"s"),E.XF=O[E.ixfe],B>0&&(E.z=K[E.ixfe>>8&63]),gs(E,t,r.opts.Date1904),b({c:z.c,r:z.r},E,t);break;case 0:case 512:ve===1&&(i=z);break;case 252:l=z;break;case 1054:if(P.biff==4){K[B++]=z[1];for(var lr=0;lr<B+163&&ze[lr]!=z[1];++lr);lr>=163&&Mi(z[1],B+163)}else Mi(z[1],z[0]);break;case 30:{K[B++]=z;for(var vt=0;vt<B+163&&ze[vt]!=z;++vt);vt>=163&&Mi(z,B+163)}break;case 229:le=le.concat(z);break;case 93:se[z.cmo[0]]=P.lastobj=z;break;case 438:P.lastobj.TxO=z;break;case 127:P.lastobj.ImData=z;break;case 440:for(w=z[0].s.r;w<=z[0].e.r;++w)for(v=z[0].s.c;v<=z[0].e.c;++v)p=t.dense?(s[w]||[])[v]:s[Ue({c:v,r:w})],p&&(p.l=z[1]);break;case 2048:for(w=z[0].s.r;w<=z[0].e.r;++w)for(v=z[0].s.c;v<=z[0].e.c;++v)p=t.dense?(s[w]||[])[v]:s[Ue({c:v,r:w})],p&&p.l&&(p.l.Tooltip=z[1]);break;case 28:{if(P.biff<=5&&P.biff>=2)break;p=t.dense?(s[z[0].r]||[])[z[0].c]:s[Ue(z[0])];var St=se[z[2]];p||(t.dense?(s[z[0].r]||(s[z[0].r]=[]),p=s[z[0].r][z[0].c]={t:"z"}):p=s[Ue(z[0])]={t:"z"},i.e.r=Math.max(i.e.r,z[0].r),i.s.r=Math.min(i.s.r,z[0].r),i.e.c=Math.max(i.e.c,z[0].c),i.s.c=Math.min(i.s.c,z[0].c)),p.c||(p.c=[]),x={a:z[1],t:St.TxO.t},p.c.push(x)}break;case 2173:O9(O[z.ixfe],z.ext);break;case 125:{if(!P.cellStyles)break;for(;z.e>=z.s;)he[z.e--]={width:z.w/256,level:z.level||0,hidden:!!(z.flags&1)},ie||(ie=!0,ux(z.w/256)),pl(he[z.e+1])}break;case 520:{var ht={};z.level!=null&&(de[z.r]=ht,ht.level=z.level),z.hidden&&(de[z.r]=ht,ht.hidden=!0),z.hpt&&(de[z.r]=ht,ht.hpt=z.hpt,ht.hpx=hu(z.hpt))}break;case 38:case 39:case 40:case 41:s["!margins"]||Rc(s["!margins"]={}),s["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[Ce]]=z;break;case 161:s["!margins"]||Rc(s["!margins"]={}),s["!margins"].header=z.header,s["!margins"].footer=z.footer;break;case 574:z.RTL&&(g.Views[0].RTL=!0);break;case 146:L=z;break;case 2198:C=z;break;case 140:N=z;break;case 442:c?y.CodeName=z||y.name:g.WBProps.CodeName=z||"ThisWorkbook";break}}else _e||console.error("Missing Info for XLS Record 0x"+Ce.toString(16)),e.l+=Te}return r.SheetNames=Ns(a).sort(function(Dt,je){return Number(Dt)-Number(je)}).map(function(Dt){return a[Dt].name}),t.bookSheets||(r.Sheets=n),!r.SheetNames.length&&u["!ref"]?(r.SheetNames.push("Sheet1"),r.Sheets&&(r.Sheets.Sheet1=u)):r.Preamble=u,r.Sheets&&q.forEach(function(Dt,je){r.Sheets[r.SheetNames[je]]["!autofilter"]=Dt}),r.Strings=l,r.SSF=Er(ze),P.enc&&(r.Encryption=P.enc),C&&(r.Themes=C),r.Metadata={},N!==void 0&&(r.Metadata.Country=N),H.names.length>0&&(g.Names=H.names),r.Workbook=g,r}var Bw={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function m7(e,t,r){var n=tt.find(e,"/!DocumentSummaryInformation");if(n&&n.size>0)try{var s=kw(n,b8,Bw.DSI);for(var a in s)t[a]=s[a]}catch(c){if(r.WTF)throw c}var i=tt.find(e,"/!SummaryInformation");if(i&&i.size>0)try{var o=kw(i,P8,Bw.SI);for(var l in o)t[l]==null&&(t[l]=o[l])}catch(c){if(r.WTF)throw c}t.HeadingPairs&&t.TitlesOfParts&&(zA(t.HeadingPairs,t.TitlesOfParts,t,r),delete t.HeadingPairs,delete t.TitlesOfParts)}function SI(e,t){t||(t={}),px(t),eA(),t.codepage&&Kv(t.codepage);var r,n;if(e.FullPaths){if(tt.find(e,"/encryption"))throw new Error("File is password-protected");r=tt.find(e,"!CompObj"),n=tt.find(e,"/Workbook")||tt.find(e,"/Book")}else{switch(t.type){case"base64":e=ts(An(e));break;case"binary":e=ts(e);break;case"buffer":break;case"array":Array.isArray(e)||(e=Array.prototype.slice.call(e));break}xr(e,0),n={content:e}}var s,a;if(r&&u7(r),t.bookProps&&!t.bookSheets)s={};else{var i=Qe?"buffer":"array";if(n&&n.content)s=d7(n.content,t);else if((a=tt.find(e,"PerfectOffice_MAIN"))&&a.content)s=Ic.to_workbook(a.content,(t.type=i,t));else if((a=tt.find(e,"NativeContent_MAIN"))&&a.content)s=Ic.to_workbook(a.content,(t.type=i,t));else throw(a=tt.find(e,"MN0"))&&a.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");t.bookVBA&&e.FullPaths&&tt.find(e,"/_VBA_PROJECT_CUR/VBA/dir")&&(s.vbaraw=Z9(e))}var o={};return e.FullPaths&&m7(e,o,t),s.Props=s.Custprops=o,t.bookFiles&&(s.cfb=e),s}var cd={0:{f:XU},1:{f:ZU},2:{f:lB},3:{f:nB},4:{f:tB},5:{f:oB},6:{f:fB},7:{f:aB},8:{f:gB},9:{f:pB},10:{f:dB},11:{f:mB},12:{f:eB},13:{f:cB},14:{f:sB},15:{f:rB},16:{f:yI},17:{f:hB},18:{f:iB},19:{f:sx},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:$B},40:{},42:{},43:{f:d9},44:{f:h9},45:{f:m9},46:{f:g9},47:{f:p9},48:{},49:{f:v8},50:{},51:{f:L9},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:eI},62:{f:uB},63:{f:z9},64:{f:SB},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:$r,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:kB},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:JU},148:{f:YU,p:16},151:{f:_B},152:{},153:{f:BB},154:{},155:{},156:{f:UB},157:{},158:{},159:{T:1,f:Pj},160:{T:-1},161:{T:1,f:io},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:vB},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:M9},336:{T:-1},337:{f:j9,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:Dp},357:{},358:{},359:{},360:{T:1},361:{},362:{f:ZA},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:yB},427:{f:wB},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:TB},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:QU},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:xB},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:Dp},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:Y9},633:{T:1},634:{T:-1},635:{T:1,f:X9},636:{T:-1},637:{f:_8},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:bB},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:AB},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},jp={6:{f:rm},10:{f:Ia},12:{f:Yt},13:{f:Yt},14:{f:zt},15:{f:zt},16:{f:Lr},17:{f:zt},18:{f:zt},19:{f:Yt},20:{f:Cw},21:{f:Cw},23:{f:ZA},24:{f:Nw},25:{f:zt},26:{},27:{},28:{f:K5},29:{},34:{f:zt},35:{f:Rw},38:{f:Lr},39:{f:Lr},40:{f:Lr},41:{f:Lr},42:{f:zt},43:{f:zt},47:{f:Qj},49:{f:C5},51:{f:Yt},60:{},61:{f:S5},64:{f:zt},65:{f:I5},66:{f:Yt},77:{},80:{},81:{},82:{},85:{f:Yt},89:{},90:{},91:{},92:{f:v5},93:{f:X5},94:{},95:{f:zt},96:{},97:{},99:{f:zt},125:{f:eI},128:{f:j5},129:{f:x5},130:{f:Yt},131:{f:zt},132:{f:zt},133:{f:_5},134:{},140:{f:tj},141:{f:Yt},144:{},146:{f:nj},151:{},152:{},153:{},154:{},155:{},156:{f:Yt},157:{},158:{},160:{f:lj},161:{f:aj},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:F5},190:{f:O5},193:{f:Ia},197:{},198:{},199:{},200:{},201:{},202:{f:zt},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:Yt},220:{},221:{f:zt},222:{},224:{f:L5},225:{f:g5},226:{f:Ia},227:{},229:{f:q5},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:y5},253:{f:R5},255:{f:w5},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:KA},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:zt},353:{f:Ia},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:U5},431:{f:zt},432:{},433:{},434:{},437:{},438:{f:J5},439:{f:zt},440:{f:Z5},441:{},442:{f:Vu},443:{},444:{f:Yt},445:{},446:{},448:{f:Ia},449:{f:k5,r:2},450:{f:Ia},512:{f:Aw},513:{f:oj},515:{f:V5},516:{f:N5},517:{f:Iw},519:{f:cj},520:{f:E5},523:{},545:{f:bw},549:{f:Sw},566:{},574:{f:A5},638:{f:D5},659:{},1048:{},1054:{f:b5},1084:{},1212:{f:W5},2048:{f:ej},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:bf},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:Ia},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:sj,r:12},2173:{f:F9,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:zt,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:$5,r:12},2197:{},2198:{f:C9,r:12},2199:{},2200:{},2201:{},2202:{f:H5,r:12},2203:{f:Ia},2204:{},2205:{},2206:{},2207:{},2211:{f:T5},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:Yt},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:ij},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:rj},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:Aw},1:{},2:{f:dj},3:{f:hj},4:{f:fj},5:{f:Iw},7:{f:mj},8:{},9:{f:bf},11:{},22:{f:Yt},30:{f:P5},31:{},32:{},33:{f:bw},36:{},37:{f:Sw},50:{f:pj},62:{},52:{},67:{},68:{f:Yt},69:{},86:{},126:{},127:{f:uj},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:gj},223:{},234:{},354:{},421:{},518:{f:rm},521:{f:bf},536:{f:Nw},547:{f:Rw},561:{},579:{},1030:{f:rm},1033:{f:bf},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function Xn(e,t,r,n){var s=t;if(!isNaN(s)){var a=(r||[]).length||0,i=e.next(4);i.write_shift(2,s),i.write_shift(2,a),a>0&&FA(r)&&e.push(r)}}function zw(e,t){var r=t||{},n=r.dense?[]:{};e=e.replace(/<!--.*?-->/g,"");var s=e.match(/<table/i);if(!s)throw new Error("Invalid HTML: could not find <table>");var a=e.match(/<\/table/i),i=s.index,o=a&&a.index||e.length,l=V6(e.slice(i,o),/(:?<tr[^>]*>)/i,"<tr>"),c=-1,u=0,h=0,m=0,p={s:{r:1e7,c:1e7},e:{r:0,c:0}},x=[];for(i=0;i<l.length;++i){var v=l[i].trim(),w=v.slice(0,3).toLowerCase();if(w=="<tr"){if(++c,r.sheetRows&&r.sheetRows<=c){--c;break}u=0;continue}if(!(w!="<td"&&w!="<th")){var k=v.split(/<\/t[dh]>/i);for(o=0;o<k.length;++o){var T=k[o].trim();if(T.match(/<t[dh]/i)){for(var E=T,N=0;E.charAt(0)=="<"&&(N=E.indexOf(">"))>-1;)E=E.slice(N+1);for(var O=0;O<x.length;++O){var L=x[O];L.s.c==u&&L.s.r<c&&c<=L.e.r&&(u=L.e.c+1,O=-1)}var g=Oe(T.slice(0,T.indexOf(">")));m=g.colspan?+g.colspan:1,((h=+g.rowspan)>1||m>1)&&x.push({s:{r:c,c:u},e:{r:c+(h||1)-1,c:u+m-1}});var y=g.t||g["data-t"]||"";if(!E.length){u+=m;continue}if(E=wA(E),p.s.r>c&&(p.s.r=c),p.e.r<c&&(p.e.r=c),p.s.c>u&&(p.s.c=u),p.e.c<u&&(p.e.c=u),!E.length){u+=m;continue}var S={t:"s",v:E};r.raw||!E.trim().length||y=="s"||(E==="TRUE"?S={t:"b",v:!0}:E==="FALSE"?S={t:"b",v:!1}:isNaN(ls(E))?isNaN(ml(E).getDate())||(S={t:"d",v:dr(E)},r.cellDates||(S={t:"n",v:Jr(S.v)}),S.z=r.dateNF||ze[14]):S={t:"n",v:ls(E)}),r.dense?(n[c]||(n[c]=[]),n[c][u]=S):n[Ue({r:c,c:u})]=S,u+=m}}}}return n["!ref"]=rt(p),x.length&&(n["!merges"]=x),n}function p7(e,t,r,n){for(var s=e["!merges"]||[],a=[],i=t.s.c;i<=t.e.c;++i){for(var o=0,l=0,c=0;c<s.length;++c)if(!(s[c].s.r>r||s[c].s.c>i)&&!(s[c].e.r<r||s[c].e.c<i)){if(s[c].s.r<r||s[c].s.c<i){o=-1;break}o=s[c].e.r-s[c].s.r+1,l=s[c].e.c-s[c].s.c+1;break}if(!(o<0)){var u=Ue({r,c:i}),h=n.dense?(e[r]||[])[i]:e[u],m=h&&h.v!=null&&(h.h||Zv(h.w||(ga(h),h.w)||""))||"",p={};o>1&&(p.rowspan=o),l>1&&(p.colspan=l),n.editable?m='<span contenteditable="true">'+m+"</span>":h&&(p["data-t"]=h&&h.t||"z",h.v!=null&&(p["data-v"]=h.v),h.z!=null&&(p["data-z"]=h.z),h.l&&(h.l.Target||"#").charAt(0)!="#"&&(m='<a href="'+h.l.Target+'">'+m+"</a>")),p.id=(n.id||"sjs")+"-"+u,a.push(t8("td",m,p))}}var x="<tr>";return x+a.join("")+"</tr>"}var g7='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',v7="</body></html>";function x7(e,t){var r=e.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!r||r.length==0)throw new Error("Invalid HTML: could not find <table>");if(r.length==1)return gi(zw(r[0],t),t);var n=vx();return r.forEach(function(s,a){xx(n,zw(s,t),"Sheet"+(a+1))}),n}function _7(e,t,r){var n=[];return n.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function y7(e,t){var r=t||{},n=r.header!=null?r.header:g7,s=r.footer!=null?r.footer:v7,a=[n],i=Sl(e["!ref"]);r.dense=Array.isArray(e),a.push(_7(e,i,r));for(var o=i.s.r;o<=i.e.r;++o)a.push(p7(e,i,o,r));return a.push("</table>"+s),a.join("")}function AI(e,t,r){var n=r||{},s=0,a=0;if(n.origin!=null)if(typeof n.origin=="number")s=n.origin;else{var i=typeof n.origin=="string"?qr(n.origin):n.origin;s=i.r,a=i.c}var o=t.getElementsByTagName("tr"),l=Math.min(n.sheetRows||1e7,o.length),c={s:{r:0,c:0},e:{r:s,c:a}};if(e["!ref"]){var u=Sl(e["!ref"]);c.s.r=Math.min(c.s.r,u.s.r),c.s.c=Math.min(c.s.c,u.s.c),c.e.r=Math.max(c.e.r,u.e.r),c.e.c=Math.max(c.e.c,u.e.c),s==-1&&(c.e.r=s=u.e.r+1)}var h=[],m=0,p=e["!rows"]||(e["!rows"]=[]),x=0,v=0,w=0,k=0,T=0,E=0;for(e["!cols"]||(e["!cols"]=[]);x<o.length&&v<l;++x){var N=o[x];if($w(N)){if(n.display)continue;p[v]={hidden:!0}}var O=N.children;for(w=k=0;w<O.length;++w){var L=O[w];if(!(n.display&&$w(L))){var g=L.hasAttribute("data-v")?L.getAttribute("data-v"):L.hasAttribute("v")?L.getAttribute("v"):wA(L.innerHTML),y=L.getAttribute("data-z")||L.getAttribute("z");for(m=0;m<h.length;++m){var S=h[m];S.s.c==k+a&&S.s.r<v+s&&v+s<=S.e.r&&(k=S.e.c+1-a,m=-1)}E=+L.getAttribute("colspan")||1,((T=+L.getAttribute("rowspan")||1)>1||E>1)&&h.push({s:{r:v+s,c:k+a},e:{r:v+s+(T||1)-1,c:k+a+(E||1)-1}});var R={t:"s",v:g},b=L.getAttribute("data-t")||L.getAttribute("t")||"";g!=null&&(g.length==0?R.t=b||"z":n.raw||g.trim().length==0||b=="s"||(g==="TRUE"?R={t:"b",v:!0}:g==="FALSE"?R={t:"b",v:!1}:isNaN(ls(g))?isNaN(ml(g).getDate())||(R={t:"d",v:dr(g)},n.cellDates||(R={t:"n",v:Jr(R.v)}),R.z=n.dateNF||ze[14]):R={t:"n",v:ls(g)})),R.z===void 0&&y!=null&&(R.z=y);var P="",C=L.getElementsByTagName("A");if(C&&C.length)for(var le=0;le<C.length&&!(C[le].hasAttribute("href")&&(P=C[le].getAttribute("href"),P.charAt(0)!="#"));++le);P&&P.charAt(0)!="#"&&(R.l={Target:P}),n.dense?(e[v+s]||(e[v+s]=[]),e[v+s][k+a]=R):e[Ue({c:k+a,r:v+s})]=R,c.e.c<k+a&&(c.e.c=k+a),k+=E}}++v}return h.length&&(e["!merges"]=(e["!merges"]||[]).concat(h)),c.e.r=Math.max(c.e.r,v-1+s),e["!ref"]=rt(c),v>=l&&(e["!fullref"]=rt((c.e.r=o.length-x+v-1+s,c))),e}function II(e,t){var r=t||{},n=r.dense?[]:{};return AI(n,e,t)}function w7(e,t){return gi(II(e,t),t)}function $w(e){var t="",r=E7(e);return r&&(t=r(e).getPropertyValue("display")),t||(t=e.style&&e.style.display),t==="none"}function E7(e){return e.ownerDocument.defaultView&&typeof e.ownerDocument.defaultView.getComputedStyle=="function"?e.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function T7(e){var t=e.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(n,s){return Array(parseInt(s,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),r=it(t.replace(/<[^>]*>/g,""));return[r]}var Ww={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function CI(e,t){var r=t||{},n=ex(e),s=[],a,i,o={name:""},l="",c=0,u,h,m={},p=[],x=r.dense?[]:{},v,w,k={value:""},T="",E=0,N=[],O=-1,L=-1,g={s:{r:1e6,c:1e7},e:{r:0,c:0}},y=0,S={},R=[],b={},P=0,C=0,le=[],se=1,he=1,de=[],ie={Names:[]},H={},ce=["",""],ve=[],B={},K="",q=0,G=!1,oe=!1,xe=0;for(cu.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");v=cu.exec(n);)switch(v[3]=v[3].replace(/_.*$/,"")){case"table":case"":v[1]==="/"?(g.e.c>=g.s.c&&g.e.r>=g.s.r?x["!ref"]=rt(g):x["!ref"]="A1:A1",r.sheetRows>0&&r.sheetRows<=g.e.r&&(x["!fullref"]=x["!ref"],g.e.r=r.sheetRows-1,x["!ref"]=rt(g)),R.length&&(x["!merges"]=R),le.length&&(x["!rows"]=le),u.name=u.||u.name,typeof JSON<"u"&&JSON.stringify(u),p.push(u.name),m[u.name]=x,oe=!1):v[0].charAt(v[0].length-2)!=="/"&&(u=Oe(v[0],!1),O=L=-1,g.s.r=g.s.c=1e7,g.e.r=g.e.c=0,x=r.dense?[]:{},R=[],le=[],oe=!0);break;case"table-row-group":v[1]==="/"?--y:++y;break;case"table-row":case"":if(v[1]==="/"){O+=se,se=1;break}if(h=Oe(v[0],!1),h.?O=h.-1:O==-1&&(O=0),se=+h["number-rows-repeated"]||1,se<10)for(xe=0;xe<se;++xe)y>0&&(le[O+xe]={level:y});L=-1;break;case"covered-table-cell":v[1]!=="/"&&++L,r.sheetStubs&&(r.dense?(x[O]||(x[O]=[]),x[O][L]={t:"z"}):x[Ue({r:O,c:L})]={t:"z"}),T="",N=[];break;case"table-cell":case"":if(v[0].charAt(v[0].length-2)==="/")++L,k=Oe(v[0],!1),he=parseInt(k["number-columns-repeated"]||"1",10),w={t:"z",v:null},k.formula&&r.cellFormula!=!1&&(w.f=jw(it(k.formula))),(k.||k["value-type"])=="string"&&(w.t="s",w.v=it(k["string-value"]||""),r.dense?(x[O]||(x[O]=[]),x[O][L]=w):x[Ue({r:O,c:L})]=w),L+=he-1;else if(v[1]!=="/"){++L,T="",E=0,N=[],he=1;var Ce=se?O+se-1:O;if(L>g.e.c&&(g.e.c=L),L<g.s.c&&(g.s.c=L),O<g.s.r&&(g.s.r=O),Ce>g.e.r&&(g.e.r=Ce),k=Oe(v[0],!1),ve=[],B={},w={t:k.||k["value-type"],v:null},r.cellFormula)if(k.formula&&(k.formula=it(k.formula)),k["number-matrix-columns-spanned"]&&k["number-matrix-rows-spanned"]&&(P=parseInt(k["number-matrix-rows-spanned"],10)||0,C=parseInt(k["number-matrix-columns-spanned"],10)||0,b={s:{r:O,c:L},e:{r:O+P-1,c:L+C-1}},w.F=rt(b),de.push([b,w.F])),k.formula)w.f=jw(k.formula);else for(xe=0;xe<de.length;++xe)O>=de[xe][0].s.r&&O<=de[xe][0].e.r&&L>=de[xe][0].s.c&&L<=de[xe][0].e.c&&(w.F=de[xe][1]);switch((k["number-columns-spanned"]||k["number-rows-spanned"])&&(P=parseInt(k["number-rows-spanned"],10)||0,C=parseInt(k["number-columns-spanned"],10)||0,b={s:{r:O,c:L},e:{r:O+P-1,c:L+C-1}},R.push(b)),k["number-columns-repeated"]&&(he=parseInt(k["number-columns-repeated"],10)),w.t){case"boolean":w.t="b",w.v=bt(k["boolean-value"]);break;case"float":w.t="n",w.v=parseFloat(k.value);break;case"percentage":w.t="n",w.v=parseFloat(k.value);break;case"currency":w.t="n",w.v=parseFloat(k.value);break;case"date":w.t="d",w.v=dr(k["date-value"]),r.cellDates||(w.t="n",w.v=Jr(w.v)),w.z="m/d/yy";break;case"time":w.t="n",w.v=M6(k["time-value"])/86400,r.cellDates&&(w.t="d",w.v=t0(w.v)),w.z="HH:MM:SS";break;case"number":w.t="n",w.v=parseFloat(k.);break;default:if(w.t==="string"||w.t==="text"||!w.t)w.t="s",k["string-value"]!=null&&(T=it(k["string-value"]),N=[]);else throw new Error("Unsupported value type "+w.t)}}else{if(G=!1,w.t==="s"&&(w.v=T||"",N.length&&(w.R=N),G=E==0),H.Target&&(w.l=H),ve.length>0&&(w.c=ve,ve=[]),T&&r.cellText!==!1&&(w.w=T),G&&(w.t="z",delete w.v),(!G||r.sheetStubs)&&!(r.sheetRows&&r.sheetRows<=O))for(var Te=0;Te<se;++Te){if(he=parseInt(k["number-columns-repeated"]||"1",10),r.dense)for(x[O+Te]||(x[O+Te]=[]),x[O+Te][L]=Te==0?w:Er(w);--he>0;)x[O+Te][L+he]=Er(w);else for(x[Ue({r:O+Te,c:L})]=w;--he>0;)x[Ue({r:O+Te,c:L+he})]=Er(w);g.e.c<=L&&(g.e.c=L)}he=parseInt(k["number-columns-repeated"]||"1",10),L+=he-1,he=0,w={},T="",N=[]}H={};break;case"document":case"document-content":case"":case"spreadsheet":case"":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(v[1]==="/"){if((a=s.pop())[0]!==v[3])throw"Bad state: "+a}else v[0].charAt(v[0].length-2)!=="/"&&s.push([v[3],!0]);break;case"annotation":if(v[1]==="/"){if((a=s.pop())[0]!==v[3])throw"Bad state: "+a;B.t=T,N.length&&(B.R=N),B.a=K,ve.push(B)}else v[0].charAt(v[0].length-2)!=="/"&&s.push([v[3],!1]);K="",q=0,T="",E=0,N=[];break;case"creator":v[1]==="/"?K=n.slice(q,v.index):q=v.index+v[0].length;break;case"meta":case"":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(v[1]==="/"){if((a=s.pop())[0]!==v[3])throw"Bad state: "+a}else v[0].charAt(v[0].length-2)!=="/"&&s.push([v[3],!1]);T="",E=0,N=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(v[1]==="/"){if(S[o.name]=l,(a=s.pop())[0]!==v[3])throw"Bad state: "+a}else v[0].charAt(v[0].length-2)!=="/"&&(l="",o=Oe(v[0],!1),s.push([v[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(s[s.length-1][0]){case"time-style":case"date-style":i=Oe(v[0],!1),l+=Ww[v[3]][i.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(s[s.length-1][0]){case"time-style":case"date-style":i=Oe(v[0],!1),l+=Ww[v[3]][i.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(v[0].slice(-2)==="/>")break;if(v[1]==="/")switch(s[s.length-1][0]){case"number-style":case"date-style":case"time-style":l+=n.slice(c,v.index);break}else c=v.index+v[0].length;break;case"named-range":i=Oe(v[0],!1),ce=nm(i["cell-range-address"]);var _e={Name:i.name,Ref:ce[0]+"!"+ce[1]};oe&&(_e.Sheet=p.length),ie.Names.push(_e);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"":if(["master-styles"].indexOf(s[s.length-1][0])>-1)break;if(v[1]==="/"&&(!k||!k["string-value"])){var $e=T7(n.slice(E,v.index));T=(T.length>0?T+`
`:"")+$e[0]}else Oe(v[0],!1),E=v.index+v[0].length;break;case"s":break;case"database-range":if(v[1]==="/")break;try{ce=nm(Oe(v[0])["target-range-address"]),m[ce[0]]["!autofilter"]={ref:ce[1]}}catch{}break;case"date":break;case"object":break;case"title":case"":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(v[1]!=="/"){if(H=Oe(v[0],!1),!H.href)break;H.Target=it(H.href),delete H.href,H.Target.charAt(0)=="#"&&H.Target.indexOf(".")>-1?(ce=nm(H.Target.slice(1)),H.Target="#"+ce[0]+"!"+ce[1]):H.Target.match(/^\.\.[\\\/]/)&&(H.Target=H.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(v[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case":":case":":break;default:if(r.WTF)throw new Error(v)}}var z={Sheets:m,SheetNames:p,Workbook:ie};return r.bookSheets&&delete z.Sheets,z}function Hw(e,t){t=t||{},Fn(e,"META-INF/manifest.xml")&&V8(Xt(e,"META-INF/manifest.xml"),t);var r=yn(e,"content.xml");if(!r)throw new Error("Missing content.xml in ODS / UOF file");var n=CI(Et(r),t);return Fn(e,"meta.xml")&&(n.Props=BA(Xt(e,"meta.xml"))),n}function Gw(e,t){return CI(e,t)}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function dx(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function Vp(e){return typeof TextDecoder<"u"?new TextDecoder().decode(e):Et(so(e))}function Up(e){var t=e.reduce(function(s,a){return s+a.length},0),r=new Uint8Array(t),n=0;return e.forEach(function(s){r.set(s,n),n+=s.length}),r}function Kw(e){return e-=e>>1&1431655765,e=(e&858993459)+(e>>2&858993459),(e+(e>>4)&252645135)*16843009>>>24}function k7(e,t){for(var r=(e[t+15]&127)<<7|e[t+14]>>1,n=e[t+14]&1,s=t+13;s>=t;--s)n=n*256+e[s];return(e[t+15]&128?-n:n)*Math.pow(10,r-6176)}function du(e,t){var r=t?t[0]:0,n=e[r]&127;e:if(e[r++]>=128&&(n|=(e[r]&127)<<7,e[r++]<128||(n|=(e[r]&127)<<14,e[r++]<128)||(n|=(e[r]&127)<<21,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,28),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,35),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,42),++r,e[r++]<128)))break e;return t&&(t[0]=r),n}function ir(e){var t=0,r=e[t]&127;e:if(e[t++]>=128){if(r|=(e[t]&127)<<7,e[t++]<128||(r|=(e[t]&127)<<14,e[t++]<128)||(r|=(e[t]&127)<<21,e[t++]<128))break e;r|=(e[t]&127)<<28}return r}function jr(e){for(var t=[],r=[0];r[0]<e.length;){var n=r[0],s=du(e,r),a=s&7;s=Math.floor(s/8);var i=0,o;if(s==0)break;switch(a){case 0:{for(var l=r[0];e[r[0]++]>=128;);o=e.slice(l,r[0])}break;case 5:i=4,o=e.slice(r[0],r[0]+i),r[0]+=i;break;case 1:i=8,o=e.slice(r[0],r[0]+i),r[0]+=i;break;case 2:i=du(e,r),o=e.slice(r[0],r[0]+i),r[0]+=i;break;case 3:case 4:default:throw new Error("PB Type ".concat(a," for Field ").concat(s," at offset ").concat(n))}var c={data:o,type:a};t[s]==null?t[s]=[c]:t[s].push(c)}return t}function mx(e,t){return(e==null?void 0:e.map(function(r){return t(r.data)}))||[]}function S7(e){for(var t,r=[],n=[0];n[0]<e.length;){var s=du(e,n),a=jr(e.slice(n[0],n[0]+s));n[0]+=s;var i={id:ir(a[1][0].data),messages:[]};a[2].forEach(function(o){var l=jr(o.data),c=ir(l[3][0].data);i.messages.push({meta:l,data:e.slice(n[0],n[0]+c)}),n[0]+=c}),(t=a[3])!=null&&t[0]&&(i.merge=ir(a[3][0].data)>>>0>0),r.push(i)}return r}function A7(e,t){if(e!=0)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var r=[0],n=du(t,r),s=[];r[0]<t.length;){var a=t[r[0]]&3;if(a==0){var i=t[r[0]++]>>2;if(i<60)++i;else{var o=i-59;i=t[r[0]],o>1&&(i|=t[r[0]+1]<<8),o>2&&(i|=t[r[0]+2]<<16),o>3&&(i|=t[r[0]+3]<<24),i>>>=0,i++,r[0]+=o}s.push(t.slice(r[0],r[0]+i)),r[0]+=i;continue}else{var l=0,c=0;if(a==1?(c=(t[r[0]]>>2&7)+4,l=(t[r[0]++]&224)<<3,l|=t[r[0]++]):(c=(t[r[0]++]>>2)+1,a==2?(l=t[r[0]]|t[r[0]+1]<<8,r[0]+=2):(l=(t[r[0]]|t[r[0]+1]<<8|t[r[0]+2]<<16|t[r[0]+3]<<24)>>>0,r[0]+=4)),s=[Up(s)],l==0)throw new Error("Invalid offset 0");if(l>s[0].length)throw new Error("Invalid offset beyond length");if(c>=l)for(s.push(s[0].slice(-l)),c-=l;c>=s[s.length-1].length;)s.push(s[s.length-1]),c-=s[s.length-1].length;s.push(s[0].slice(-l,-l+c))}}var u=Up(s);if(u.length!=n)throw new Error("Unexpected length: ".concat(u.length," != ").concat(n));return u}function I7(e){for(var t=[],r=0;r<e.length;){var n=e[r++],s=e[r]|e[r+1]<<8|e[r+2]<<16;r+=3,t.push(A7(n,e.slice(r,r+s))),r+=s}if(r!==e.length)throw new Error("data is not a valid framed stream!");return Up(t)}function C7(e,t,r,n){var s=dx(e),a=s.getUint32(4,!0),i=(n>1?12:8)+Kw(a&(n>1?3470:398))*4,o=-1,l=-1,c=NaN,u=new Date(2001,0,1);a&512&&(o=s.getUint32(i,!0),i+=4),i+=Kw(a&(n>1?12288:4096))*4,a&16&&(l=s.getUint32(i,!0),i+=4),a&32&&(c=s.getFloat64(i,!0),i+=8),a&64&&(u.setTime(u.getTime()+s.getFloat64(i,!0)*1e3),i+=8);var h;switch(e[2]){case 0:break;case 2:h={t:"n",v:c};break;case 3:h={t:"s",v:t[l]};break;case 5:h={t:"d",v:u};break;case 6:h={t:"b",v:c>0};break;case 7:h={t:"n",v:c/86400};break;case 8:h={t:"e",v:0};break;case 9:if(o>-1)h={t:"s",v:r[o]};else if(l>-1)h={t:"s",v:t[l]};else if(!isNaN(c))h={t:"n",v:c};else throw new Error("Unsupported cell type ".concat(e.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(e.slice(0,4)))}return h}function R7(e,t,r){var n=dx(e),s=n.getUint32(8,!0),a=12,i=-1,o=-1,l=NaN,c=NaN,u=new Date(2001,0,1);s&1&&(l=k7(e,a),a+=16),s&2&&(c=n.getFloat64(a,!0),a+=8),s&4&&(u.setTime(u.getTime()+n.getFloat64(a,!0)*1e3),a+=8),s&8&&(o=n.getUint32(a,!0),a+=4),s&16&&(i=n.getUint32(a,!0),a+=4);var h;switch(e[1]){case 0:break;case 2:h={t:"n",v:l};break;case 3:h={t:"s",v:t[o]};break;case 5:h={t:"d",v:u};break;case 6:h={t:"b",v:c>0};break;case 7:h={t:"n",v:c/86400};break;case 8:h={t:"e",v:0};break;case 9:if(i>-1)h={t:"s",v:r[i]};else throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(s&31," : ").concat(e.slice(0,4)));break;case 10:h={t:"n",v:l};break;default:throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(s&31," : ").concat(e.slice(0,4)))}return h}function N7(e,t,r){switch(e[0]){case 0:case 1:case 2:case 3:return C7(e,t,r,e[0]);case 5:return R7(e,t,r);default:throw new Error("Unsupported payload version ".concat(e[0]))}}function ei(e){var t=jr(e);return du(t[1][0].data)}function qw(e,t){var r=jr(t.data),n=ir(r[1][0].data),s=r[3],a=[];return(s||[]).forEach(function(i){var o=jr(i.data),l=ir(o[1][0].data)>>>0;switch(n){case 1:a[l]=Vp(o[3][0].data);break;case 8:{var c=e[ei(o[9][0].data)][0],u=jr(c.data),h=e[ei(u[1][0].data)][0],m=ir(h.meta[1][0].data);if(m!=2001)throw new Error("2000 unexpected reference to ".concat(m));var p=jr(h.data);a[l]=p[3].map(function(x){return Vp(x.data)}).join("")}break}}),a}function b7(e,t){var r,n,s,a,i,o,l,c,u,h,m,p,x,v,w=jr(e),k=ir(w[1][0].data)>>>0,T=ir(w[2][0].data)>>>0,E=((n=(r=w[8])==null?void 0:r[0])==null?void 0:n.data)&&ir(w[8][0].data)>0||!1,N,O;if((a=(s=w[7])==null?void 0:s[0])!=null&&a.data&&t!=0)N=(o=(i=w[7])==null?void 0:i[0])==null?void 0:o.data,O=(c=(l=w[6])==null?void 0:l[0])==null?void 0:c.data;else if((h=(u=w[4])==null?void 0:u[0])!=null&&h.data&&t!=1)N=(p=(m=w[4])==null?void 0:m[0])==null?void 0:p.data,O=(v=(x=w[3])==null?void 0:x[0])==null?void 0:v.data;else throw"NUMBERS Tile missing ".concat(t," cell storage");for(var L=E?4:1,g=dx(N),y=[],S=0;S<N.length/2;++S){var R=g.getUint16(S*2,!0);R<65535&&y.push([S,R])}if(y.length!=T)throw"Expected ".concat(T," cells, found ").concat(y.length);var b=[];for(S=0;S<y.length-1;++S)b[y[S][0]]=O.subarray(y[S][1]*L,y[S+1][1]*L);return y.length>=1&&(b[y[y.length-1][0]]=O.subarray(y[y.length-1][1]*L)),{R:k,cells:b}}function P7(e,t){var r,n=jr(t.data),s=(r=n==null?void 0:n[7])!=null&&r[0]?ir(n[7][0].data)>>>0>0?1:0:-1,a=mx(n[5],function(i){return b7(i,s)});return{nrows:ir(n[4][0].data)>>>0,data:a.reduce(function(i,o){return i[o.R]||(i[o.R]=[]),o.cells.forEach(function(l,c){if(i[o.R][c])throw new Error("Duplicate cell r=".concat(o.R," c=").concat(c));i[o.R][c]=l}),i},[])}}function D7(e,t,r){var n,s=jr(t.data),a={s:{r:0,c:0},e:{r:0,c:0}};if(a.e.r=(ir(s[6][0].data)>>>0)-1,a.e.r<0)throw new Error("Invalid row varint ".concat(s[6][0].data));if(a.e.c=(ir(s[7][0].data)>>>0)-1,a.e.c<0)throw new Error("Invalid col varint ".concat(s[7][0].data));r["!ref"]=rt(a);var i=jr(s[4][0].data),o=qw(e,e[ei(i[4][0].data)][0]),l=(n=i[17])!=null&&n[0]?qw(e,e[ei(i[17][0].data)][0]):[],c=jr(i[3][0].data),u=0;c[1].forEach(function(h){var m=jr(h.data),p=e[ei(m[2][0].data)][0],x=ir(p.meta[1][0].data);if(x!=6002)throw new Error("6001 unexpected reference to ".concat(x));var v=P7(e,p);v.data.forEach(function(w,k){w.forEach(function(T,E){var N=Ue({r:u+k,c:E}),O=N7(T,o,l);O&&(r[N]=O)})}),u+=v.nrows})}function F7(e,t){var r=jr(t.data),n={"!ref":"A1"},s=e[ei(r[2][0].data)],a=ir(s[0].meta[1][0].data);if(a!=6001)throw new Error("6000 unexpected reference to ".concat(a));return D7(e,s[0],n),n}function O7(e,t){var r,n=jr(t.data),s={name:(r=n[1])!=null&&r[0]?Vp(n[1][0].data):"",sheets:[]},a=mx(n[2],ei);return a.forEach(function(i){e[i].forEach(function(o){var l=ir(o.meta[1][0].data);l==6e3&&s.sheets.push(F7(e,o))})}),s}function M7(e,t){var r=vx(),n=jr(t.data),s=mx(n[1],ei);if(s.forEach(function(a){e[a].forEach(function(i){var o=ir(i.meta[1][0].data);if(o==2){var l=O7(e,i);l.sheets.forEach(function(c,u){xx(r,c,u==0?l.name:l.name+"_"+u,!0)})}})}),r.SheetNames.length==0)throw new Error("Empty NUMBERS file");return r}function am(e){var t,r,n,s,a={},i=[];if(e.FullPaths.forEach(function(l){if(l.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),e.FileIndex.forEach(function(l){if(l.name.match(/\.iwa$/)){var c;try{c=I7(l.content)}catch(h){return console.log("?? "+l.content.length+" "+(h.message||h))}var u;try{u=S7(c)}catch(h){return console.log("## "+(h.message||h))}u.forEach(function(h){a[h.id]=h.messages,i.push(h.id)})}}),!i.length)throw new Error("File has no messages");var o=((s=(n=(r=(t=a==null?void 0:a[1])==null?void 0:t[0])==null?void 0:r.meta)==null?void 0:n[1])==null?void 0:s[0].data)&&ir(a[1][0].meta[1][0].data)==1&&a[1][0];if(o||i.forEach(function(l){a[l].forEach(function(c){var u=ir(c.meta[1][0].data)>>>0;if(u==1)if(!o)o=c;else throw new Error("Document has multiple roots")})}),!o)throw new Error("Cannot find Document root");return M7(a,o)}function L7(e){return function(r){for(var n=0;n!=e.length;++n){var s=e[n];r[s[0]]===void 0&&(r[s[0]]=s[1]),s[2]==="n"&&(r[s[0]]=Number(r[s[0]]))}}}function px(e){L7([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(e)}function j7(e){return Oo.WS.indexOf(e)>-1?"sheet":e==Oo.CS?"chart":e==Oo.DS?"dialog":e==Oo.MS?"macro":e&&e.length?e:"sheet"}function V7(e,t){if(!e)return 0;try{e=t.map(function(n){return n.id||(n.id=n.strRelID),[n.name,e["!id"][n.id].Target,j7(e["!id"][n.id].Type)]})}catch{return null}return!e||e.length===0?null:e}function U7(e,t,r,n,s,a,i,o,l,c,u,h){try{a[n]=Sc(yn(e,r,!0),t);var m=Xt(e,t),p;switch(o){case"sheet":p=GB(m,t,s,l,a[n],c,u,h);break;case"chart":if(p=KB(m,t,s,l,a[n],c,u,h),!p||!p["!drawel"])break;var x=ac(p["!drawel"].Target,t),v=Fp(x),w=H9(yn(e,x,!0),Sc(yn(e,v,!0),x)),k=ac(w,x),T=Fp(k);p=RB(yn(e,k,!0),k,l,Sc(yn(e,T,!0),k),c,p);break;case"macro":p=qB(m,t,s,l,a[n],c,u,h);break;case"dialog":p=XB(m,t,s,l,a[n],c,u,h);break;default:throw new Error("Unrecognized sheet type "+o)}i[n]=p;var E=[];a&&a[n]&&Ns(a[n]).forEach(function(N){var O="";if(a[n][N].Type==Oo.CMNT){O=ac(a[n][N].Target,t);var L=ZB(Xt(e,O,!0),O,l);if(!L||!L.length)return;Dw(p,L,!1)}a[n][N].Type==Oo.TCMNT&&(O=ac(a[n][N].Target,t),E=E.concat(K9(Xt(e,O,!0),l)))}),E&&E.length&&Dw(p,E,!0,l.people||[])}catch(N){if(l.WTF)throw N}}function Pn(e){return e.charAt(0)=="/"?e.slice(1):e}function B7(e,t){if(hA(),t=t||{},px(t),Fn(e,"META-INF/manifest.xml")||Fn(e,"objectdata.xml"))return Hw(e,t);if(Fn(e,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof am<"u"){if(e.FileIndex)return am(e);var r=tt.utils.cfb_new();return iw(e).forEach(function(le){z6(r,le,B6(e,le))}),am(r)}throw new Error("Unsupported NUMBERS file")}if(!Fn(e,"[Content_Types].xml"))throw Fn(e,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):Fn(e,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var n=iw(e),s=L8(yn(e,"[Content_Types].xml")),a=!1,i,o;if(s.workbooks.length===0&&(o="xl/workbook.xml",Xt(e,o,!0)&&s.workbooks.push(o)),s.workbooks.length===0){if(o="xl/workbook.bin",!Xt(e,o,!0))throw new Error("Could not find workbook");s.workbooks.push(o),a=!0}s.workbooks[0].slice(-3)=="bin"&&(a=!0);var l={},c={};if(!t.bookSheets&&!t.bookProps){if(Cc=[],s.sst)try{Cc=JB(Xt(e,Pn(s.sst)),s.sst,t)}catch(le){if(t.WTF)throw le}t.cellStyles&&s.themes.length&&(l=QB(yn(e,s.themes[0].replace(/^\//,""),!0)||"",s.themes[0],t)),s.style&&(c=YB(Xt(e,Pn(s.style)),s.style,l,t))}s.links.map(function(le){try{var se=Sc(yn(e,Fp(Pn(le))),le);return t7(Xt(e,Pn(le)),se,le,t)}catch{}});var u=HB(Xt(e,Pn(s.workbooks[0])),s.workbooks[0],t),h={},m="";s.coreprops.length&&(m=Xt(e,Pn(s.coreprops[0]),!0),m&&(h=BA(m)),s.extprops.length!==0&&(m=Xt(e,Pn(s.extprops[0]),!0),m&&z8(m,h,t)));var p={};(!t.bookSheets||t.bookProps)&&s.custprops.length!==0&&(m=yn(e,Pn(s.custprops[0]),!0),m&&(p=W8(m,t)));var x={};if((t.bookSheets||t.bookProps)&&(u.Sheets?i=u.Sheets.map(function(se){return se.name}):h.Worksheets&&h.SheetNames.length>0&&(i=h.SheetNames),t.bookProps&&(x.Props=h,x.Custprops=p),t.bookSheets&&typeof i<"u"&&(x.SheetNames=i),t.bookSheets?x.SheetNames:t.bookProps))return x;i={};var v={};t.bookDeps&&s.calcchain&&(v=e7(Xt(e,Pn(s.calcchain)),s.calcchain));var w=0,k={},T,E;{var N=u.Sheets;h.Worksheets=N.length,h.SheetNames=[];for(var O=0;O!=N.length;++O)h.SheetNames[O]=N[O].name}var L=a?"bin":"xml",g=s.workbooks[0].lastIndexOf("/"),y=(s.workbooks[0].slice(0,g+1)+"_rels/"+s.workbooks[0].slice(g+1)+".rels").replace(/^\//,"");Fn(e,y)||(y="xl/_rels/workbook."+L+".rels");var S=Sc(yn(e,y,!0),y.replace(/_rels.*/,"s5s"));(s.metadata||[]).length>=1&&(t.xlmeta=r7(Xt(e,Pn(s.metadata[0])),s.metadata[0],t)),(s.people||[]).length>=1&&(t.people=q9(Xt(e,Pn(s.people[0])),t)),S&&(S=V7(S,u.Sheets));var R=Xt(e,"xl/worksheets/sheet.xml",!0)?1:0;e:for(w=0;w!=h.Worksheets;++w){var b="sheet";if(S&&S[w]?(T="xl/"+S[w][1].replace(/[\/]?xl\//,""),Fn(e,T)||(T=S[w][1]),Fn(e,T)||(T=y.replace(/_rels\/.*$/,"")+S[w][1]),b=S[w][2]):(T="xl/worksheets/sheet"+(w+1-R)+"."+L,T=T.replace(/sheet0\./,"sheet.")),E=T.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),t&&t.sheets!=null)switch(typeof t.sheets){case"number":if(w!=t.sheets)continue e;break;case"string":if(h.SheetNames[w].toLowerCase()!=t.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(t.sheets)){for(var P=!1,C=0;C!=t.sheets.length;++C)typeof t.sheets[C]=="number"&&t.sheets[C]==w&&(P=1),typeof t.sheets[C]=="string"&&t.sheets[C].toLowerCase()==h.SheetNames[w].toLowerCase()&&(P=1);if(!P)continue e}}U7(e,T,E,h.SheetNames[w],w,k,i,b,t,u,l,c)}return x={Directory:s,Workbook:u,Props:h,Custprops:p,Deps:v,Sheets:i,SheetNames:h.SheetNames,Strings:Cc,Styles:c,Themes:l,SSF:Er(ze)},t&&t.bookFiles&&(e.files?(x.keys=n,x.files=e.files):(x.keys=[],x.files={},e.FullPaths.forEach(function(le,se){le=le.replace(/^Root Entry[\/]/,""),x.keys.push(le),x.files[le]=e.FileIndex[se]}))),t&&t.bookVBA&&(s.vba.length>0?x.vbaraw=Xt(e,Pn(s.vba[0]),!0):s.defaults&&s.defaults.bin===J9&&(x.vbaraw=Xt(e,"xl/vbaProject.bin",!0))),x}function z7(e,t){var r=t||{},n="Workbook",s=tt.find(e,n);try{if(n="/!DataSpaces/Version",s=tt.find(e,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(Fj(s.content),n="/!DataSpaces/DataSpaceMap",s=tt.find(e,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);var a=Mj(s.content);if(a.length!==1||a[0].comps.length!==1||a[0].comps[0].t!==0||a[0].name!=="StrongEncryptionDataSpace"||a[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",s=tt.find(e,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);var i=Lj(s.content);if(i.length!=1||i[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",s=tt.find(e,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);Vj(s.content)}catch{}if(n="/EncryptionInfo",s=tt.find(e,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);var o=Uj(s.content);if(n="/EncryptedPackage",s=tt.find(e,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(o[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(o[1],s.content,r.password||"",r);if(o[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(o[1],s.content,r.password||"",r);throw new Error("File is password-protected")}function gx(e,t){var r="";switch((t||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":r=An(e.slice(0,12));break;case"binary":r=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(t&&t.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function $7(e,t){return tt.find(e,"EncryptedPackage")?z7(e,t):SI(e,t)}function W7(e,t){var r,n=e,s=t||{};return s.type||(s.type=Qe&&Buffer.isBuffer(e)?"buffer":"base64"),r=xA(n,s),B7(r,s)}function RI(e,t){var r=0;e:for(;r<e.length;)switch(e.charCodeAt(r)){case 10:case 13:case 32:++r;break;case 60:return Lp(e.slice(r),t);default:break e}return uu.to_workbook(e,t)}function H7(e,t){var r="",n=gx(e,t);switch(t.type){case"base64":r=An(e);break;case"binary":r=e;break;case"buffer":r=e.toString("binary");break;case"array":r=Xi(e);break;default:throw new Error("Unrecognized type "+t.type)}return n[0]==239&&n[1]==187&&n[2]==191&&(r=Et(r)),t.type="binary",RI(r,t)}function G7(e,t){var r=e;return t.type=="base64"&&(r=An(r)),r=iu.utils.decode(1200,r.slice(2),"str"),t.type="binary",RI(r,t)}function K7(e){return e.match(/[^\x00-\x7F]/)?ic(e):e}function im(e,t,r,n){return n?(r.type="string",uu.to_workbook(e,r)):uu.to_workbook(t,r)}function Bp(e,t){eA();var r=t||{};if(typeof ArrayBuffer<"u"&&e instanceof ArrayBuffer)return Bp(new Uint8Array(e),(r=Er(r),r.type="array",r));typeof Uint8Array<"u"&&e instanceof Uint8Array&&!r.type&&(r.type=typeof Deno<"u"?"buffer":"array");var n=e,s=[0,0,0,0],a=!1;if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),Xo={},r.dateNF&&(Xo.dateNF=r.dateNF),r.type||(r.type=Qe&&Buffer.isBuffer(e)?"buffer":"base64"),r.type=="file"&&(r.type=Qe?"buffer":"binary",n=F6(e),typeof Uint8Array<"u"&&!Qe&&(r.type="array")),r.type=="string"&&(a=!0,r.type="binary",r.codepage=65001,n=K7(e)),r.type=="array"&&typeof Uint8Array<"u"&&e instanceof Uint8Array&&typeof ArrayBuffer<"u"){var i=new ArrayBuffer(3),o=new Uint8Array(i);if(o.foo="bar",!o.foo)return r=Er(r),r.type="array",Bp(qv(n),r)}switch((s=gx(n,r))[0]){case 208:if(s[1]===207&&s[2]===17&&s[3]===224&&s[4]===161&&s[5]===177&&s[6]===26&&s[7]===225)return $7(tt.read(n,r),r);break;case 9:if(s[1]<=8)return SI(n,r);break;case 60:return Lp(n,r);case 73:if(s[1]===73&&s[2]===42&&s[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(s[1]===68)return wj(n,r);break;case 84:if(s[1]===65&&s[2]===66&&s[3]===76)return _j.to_workbook(n,r);break;case 80:return s[1]===75&&s[2]<9&&s[3]<9?W7(n,r):im(e,n,r,a);case 239:return s[3]===60?Lp(n,r):im(e,n,r,a);case 255:if(s[1]===254)return G7(n,r);if(s[1]===0&&s[2]===2&&s[3]===0)return Ic.to_workbook(n,r);break;case 0:if(s[1]===0&&(s[2]>=2&&s[3]===0||s[2]===0&&(s[3]===8||s[3]===9)))return Ic.to_workbook(n,r);break;case 3:case 131:case 139:case 140:return Pw.to_workbook(n,r);case 123:if(s[1]===92&&s[2]===114&&s[3]===116)return Jj.to_workbook(n,r);break;case 10:case 13:case 32:return H7(n,r);case 137:if(s[1]===80&&s[2]===78&&s[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return vj.indexOf(s[0])>-1&&s[2]<=12&&s[3]<=31?Pw.to_workbook(n,r):im(e,n,r,a)}function q7(e,t,r,n,s,a,i,o){var l=Tr(r),c=o.defval,u=o.raw||!Object.prototype.hasOwnProperty.call(o,"raw"),h=!0,m=s===1?[]:{};if(s!==1)if(Object.defineProperty)try{Object.defineProperty(m,"__rowNum__",{value:r,enumerable:!1})}catch{m.__rowNum__=r}else m.__rowNum__=r;if(!i||e[r])for(var p=t.s.c;p<=t.e.c;++p){var x=i?e[r][p]:e[n[p]+l];if(x===void 0||x.t===void 0){if(c===void 0)continue;a[p]!=null&&(m[a[p]]=c);continue}var v=x.v;switch(x.t){case"z":if(v==null)break;continue;case"e":v=v==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+x.t)}if(a[p]!=null){if(v==null)if(x.t=="e"&&v===null)m[a[p]]=null;else if(c!==void 0)m[a[p]]=c;else if(u&&v===null)m[a[p]]=null;else continue;else m[a[p]]=u&&(x.t!=="n"||x.t==="n"&&o.rawNumbers!==!1)?v:ga(x,v,o);v!=null&&(h=!1)}}return{row:m,isempty:h}}function zp(e,t){if(e==null||e["!ref"]==null)return[];var r={t:"n",v:0},n=0,s=1,a=[],i=0,o="",l={s:{r:0,c:0},e:{r:0,c:0}},c=t||{},u=c.range!=null?c.range:e["!ref"];switch(c.header===1?n=1:c.header==="A"?n=2:Array.isArray(c.header)?n=3:c.header==null&&(n=0),typeof u){case"string":l=Bt(u);break;case"number":l=Bt(e["!ref"]),l.s.r=u;break;default:l=u}n>0&&(s=0);var h=Tr(l.s.r),m=[],p=[],x=0,v=0,w=Array.isArray(e),k=l.s.r,T=0,E={};w&&!e[k]&&(e[k]=[]);var N=c.skipHidden&&e["!cols"]||[],O=c.skipHidden&&e["!rows"]||[];for(T=l.s.c;T<=l.e.c;++T)if(!(N[T]||{}).hidden)switch(m[T]=sr(T),r=w?e[k][T]:e[m[T]+h],n){case 1:a[T]=T-l.s.c;break;case 2:a[T]=m[T];break;case 3:a[T]=c.header[T-l.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),o=i=ga(r,null,c),v=E[i]||0,!v)E[i]=1;else{do o=i+"_"+v++;while(E[o]);E[i]=v,E[o]=1}a[T]=o}for(k=l.s.r+s;k<=l.e.r;++k)if(!(O[k]||{}).hidden){var L=q7(e,l,k,m,n,a,w,c);(L.isempty===!1||(n===1?c.blankrows!==!1:c.blankrows))&&(p[x++]=L.row)}return p.length=x,p}var Xw=/"/g;function X7(e,t,r,n,s,a,i,o){for(var l=!0,c=[],u="",h=Tr(r),m=t.s.c;m<=t.e.c;++m)if(n[m]){var p=o.dense?(e[r]||[])[m]:e[n[m]+h];if(p==null)u="";else if(p.v!=null){l=!1,u=""+(o.rawNumbers&&p.t=="n"?p.v:ga(p,null,o));for(var x=0,v=0;x!==u.length;++x)if((v=u.charCodeAt(x))===s||v===a||v===34||o.forceQuotes){u='"'+u.replace(Xw,'""')+'"';break}u=="ID"&&(u='"ID"')}else p.f!=null&&!p.F?(l=!1,u="="+p.f,u.indexOf(",")>=0&&(u='"'+u.replace(Xw,'""')+'"')):u="";c.push(u)}return o.blankrows===!1&&l?null:c.join(i)}function NI(e,t){var r=[],n=t??{};if(e==null||e["!ref"]==null)return"";var s=Bt(e["!ref"]),a=n.FS!==void 0?n.FS:",",i=a.charCodeAt(0),o=n.RS!==void 0?n.RS:`
`,l=o.charCodeAt(0),c=new RegExp((a=="|"?"\\|":a)+"+$"),u="",h=[];n.dense=Array.isArray(e);for(var m=n.skipHidden&&e["!cols"]||[],p=n.skipHidden&&e["!rows"]||[],x=s.s.c;x<=s.e.c;++x)(m[x]||{}).hidden||(h[x]=sr(x));for(var v=0,w=s.s.r;w<=s.e.r;++w)(p[w]||{}).hidden||(u=X7(e,s,w,h,i,l,a,n),u!=null&&(n.strip&&(u=u.replace(c,"")),(u||n.blankrows!==!1)&&r.push((v++?o:"")+u)));return delete n.dense,r.join("")}function Y7(e,t){t||(t={}),t.FS="	",t.RS=`
`;var r=NI(e,t);return r}function Q7(e){var t="",r,n="";if(e==null||e["!ref"]==null)return[];var s=Bt(e["!ref"]),a="",i=[],o,l=[],c=Array.isArray(e);for(o=s.s.c;o<=s.e.c;++o)i[o]=sr(o);for(var u=s.s.r;u<=s.e.r;++u)for(a=Tr(u),o=s.s.c;o<=s.e.c;++o)if(t=i[o]+a,r=c?(e[u]||[])[o]:e[t],n="",r!==void 0){if(r.F!=null){if(t=r.F,!r.f)continue;n=r.f,t.indexOf(":")==-1&&(t=t+":"+t)}if(r.f!=null)n=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)n=""+r.v;else if(r.t=="b")n=r.v?"TRUE":"FALSE";else if(r.w!==void 0)n="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?n="'"+r.v:n=""+r.v}}l[l.length]=t+"="+n}return l}function bI(e,t,r){var n=r||{},s=+!n.skipHeader,a=e||{},i=0,o=0;if(a&&n.origin!=null)if(typeof n.origin=="number")i=n.origin;else{var l=typeof n.origin=="string"?qr(n.origin):n.origin;i=l.r,o=l.c}var c,u={s:{c:0,r:0},e:{c:o,r:i+t.length-1+s}};if(a["!ref"]){var h=Bt(a["!ref"]);u.e.c=Math.max(u.e.c,h.e.c),u.e.r=Math.max(u.e.r,h.e.r),i==-1&&(i=h.e.r+1,u.e.r=i+t.length-1+s)}else i==-1&&(i=0,u.e.r=t.length-1+s);var m=n.header||[],p=0;t.forEach(function(v,w){Ns(v).forEach(function(k){(p=m.indexOf(k))==-1&&(m[p=m.length]=k);var T=v[k],E="z",N="",O=Ue({c:o+p,r:i+w+s});c=mu(a,O),T&&typeof T=="object"&&!(T instanceof Date)?a[O]=T:(typeof T=="number"?E="n":typeof T=="boolean"?E="b":typeof T=="string"?E="s":T instanceof Date?(E="d",n.cellDates||(E="n",T=Jr(T)),N=n.dateNF||ze[14]):T===null&&n.nullError&&(E="e",T=0),c?(c.t=E,c.v=T,delete c.w,delete c.R,N&&(c.z=N)):a[O]=c={t:E,v:T},N&&(c.z=N))})}),u.e.c=Math.max(u.e.c,o+m.length-1);var x=Tr(i);if(s)for(p=0;p<m.length;++p)a[sr(p+o)+x]={t:"s",v:m[p]};return a["!ref"]=rt(u),a}function J7(e,t){return bI(null,e,t)}function mu(e,t,r){if(typeof t=="string"){if(Array.isArray(e)){var n=qr(t);return e[n.r]||(e[n.r]=[]),e[n.r][n.c]||(e[n.r][n.c]={t:"z"})}return e[t]||(e[t]={t:"z"})}return typeof t!="number"?mu(e,Ue(t)):mu(e,Ue({r:t,c:r||0}))}function Z7(e,t){if(typeof t=="number"){if(t>=0&&e.SheetNames.length>t)return t;throw new Error("Cannot find sheet # "+t)}else if(typeof t=="string"){var r=e.SheetNames.indexOf(t);if(r>-1)return r;throw new Error("Cannot find sheet name |"+t+"|")}else throw new Error("Cannot find sheet |"+t+"|")}function vx(){return{SheetNames:[],Sheets:{}}}function xx(e,t,r,n){var s=1;if(!r)for(;s<=65535&&e.SheetNames.indexOf(r="Sheet"+s)!=-1;++s,r=void 0);if(!r||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&e.SheetNames.indexOf(r)>=0){var a=r.match(/(^.*?)(\d+)$/);s=a&&+a[2]||0;var i=a&&a[1]||r;for(++s;s<=65535&&e.SheetNames.indexOf(r=i+s)!=-1;++s);}if(LB(r),e.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return e.SheetNames.push(r),e.Sheets[r]=t,r}function ez(e,t,r){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var n=Z7(e,t);switch(e.Workbook.Sheets[n]||(e.Workbook.Sheets[n]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}e.Workbook.Sheets[n].Hidden=r}function tz(e,t){return e.z=t,e}function PI(e,t,r){return t?(e.l={Target:t},r&&(e.l.Tooltip=r)):delete e.l,e}function rz(e,t,r){return PI(e,"#"+t,r)}function nz(e,t,r){e.c||(e.c=[]),e.c.push({t,a:r||"SheetJS"})}function sz(e,t,r,n){for(var s=typeof t!="string"?t:Bt(t),a=typeof t=="string"?t:rt(t),i=s.s.r;i<=s.e.r;++i)for(var o=s.s.c;o<=s.e.c;++o){var l=mu(e,i,o);l.t="n",l.F=a,delete l.v,i==s.s.r&&o==s.s.c&&(l.f=r,n&&(l.D=!0))}return e}var az={encode_col:sr,encode_row:Tr,encode_cell:Ue,encode_range:rt,decode_col:nx,decode_row:rx,split_cell:g8,decode_cell:qr,decode_range:Sl,format_cell:ga,sheet_add_aoa:MA,sheet_add_json:bI,sheet_add_dom:AI,aoa_to_sheet:Al,json_to_sheet:J7,table_to_sheet:II,table_to_book:w7,sheet_to_csv:NI,sheet_to_txt:Y7,sheet_to_json:zp,sheet_to_html:y7,sheet_to_formulae:Q7,sheet_to_row_object_array:zp,sheet_get_cell:mu,book_new:vx,book_append_sheet:xx,book_set_sheet_visibility:ez,cell_set_number_format:tz,cell_set_hyperlink:PI,cell_set_internal_link:rz,cell_add_comment:nz,sheet_set_array_formula:sz,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};const iz=({tmdbApiKey:e,userId:t,onDone:r})=>{const[n,s]=W.useState(null),[a,i]=W.useState([]),[o,l]=W.useState([]),[c,u]=W.useState("upload"),[h,m]=W.useState(0),[p,x]=W.useState(0),[v,w]=W.useState(!1),[k,T]=W.useState(null),[E,N]=W.useState([]),[O,L]=W.useState(null),g=o.filter(C=>C.selected&&C.tmdbMatch).length,y=C=>{var he;const le=(he=C.target.files)==null?void 0:he[0];if(!le)return;s(le);const se=new FileReader;se.onload=de=>{var B;const ie=Bp((B=de.target)==null?void 0:B.result,{type:"binary"}),H=ie.Sheets[ie.SheetNames[0]],ve=az.sheet_to_json(H).map(K=>({title:K.title||K.Title||K.name||K.Name||"",releaseDate:K.releaseDate||K.ReleaseDate||K.release_date||K.year||K.Year||"",watched:K.watched||K.Watched||!1,rating:K.rating||K.Rating||null,review:K.review||K.Review||K.notes||K.Notes||""})).filter(K=>K.title);i(ve)},se.readAsBinaryString(le)},S=async()=>{if(!a.length||!e){L("Missing data or TMDB key");return}try{w(!0),L(null),l([]),m(0);const C=[],le=mn(_t,"movies");for(let se=0;se<a.length;se++){const he=a[se];try{const de=`${he.title} ${he.releaseDate||""}`.trim(),ie=await bp(de,e);if(!ie.results.length)C.push({excelData:he,tmdbMatch:null,confidence:0,status:"unmatched",userMovieExists:!1,selected:!1});else{const H=await Jh(ie.results[0].id,e),ce=Gy(he,H),ve=await kn(qh(le,Xh("tmdbId","==",H.id)));let B,K=!1;ve.empty||(B=ve.docs[0].id,K=!!await Rp(t,B)),C.push({excelData:he,tmdbMatch:H,confidence:ce,status:K?"duplicate":ce>=70?"matched":"manual",userMovieExists:K,movieId:B,selected:!K})}}catch{C.push({excelData:he,tmdbMatch:null,confidence:0,status:"unmatched",userMovieExists:!1,selected:!1})}m(Math.round((se+1)/a.length*100))}l(C),u("review")}finally{w(!1)}},R=async(C,le)=>{try{w(!0);const se=o[C],he=le||se.excelData.title,de=await bp(he,e);T(C),N(de.results)}finally{w(!1)}},b=async C=>{if(k!=null){w(!0);try{const le=await Jh(C.id,e),se=Gy(o[k].excelData,le),he=mn(_t,"movies"),de=await kn(qh(he,Xh("tmdbId","==",le.id)));let ie,H=!1;de.empty||(ie=de.docs[0].id,H=!!await Rp(t,ie)),l(ce=>{const ve=[...ce],B=ve[k];return ve[k]={...B,tmdbMatch:le,confidence:se,status:H?"duplicate":"matched",userMovieExists:H,movieId:ie,selected:!H},ve}),T(null),N([])}finally{w(!1)}}},P=async()=>{const C=o.filter(se=>se.selected&&se.tmdbMatch);if(!C.length)return;u("import"),x(0);const le=mn(_t,"movies");for(let se=0;se<C.length;se++){const he=C[se];try{let de=he.movieId;de||(de=(await zv(le,{...Hv(he.tmdbMatch),addedAt:new Date,updatedAt:new Date})).id),await Wv(t,de,{userId:t,movieId:de,watched:he.excelData.watched||!1,rating:he.excelData.rating||null,review:he.excelData.review||"",favorite:!1})}catch{}x(Math.round((se+1)/C.length*100))}r==null||r()};return d.jsxs("div",{className:"space-y-6",children:[c==="upload"&&d.jsxs("div",{className:"space-y-4",children:[d.jsx("input",{type:"file",accept:".xlsx,.xls",className:"file-input file-input-bordered w-full",onChange:y}),!!a.length&&d.jsxs("div",{className:"text-sm opacity-80",children:[a.length," rows detected"]}),d.jsx("button",{className:"btn btn-primary",onClick:S,disabled:!e||!a.length||v,children:v?d.jsx("span",{className:"loading loading-spinner loading-sm"}):"Scan & Match"})]}),c==="review"&&d.jsxs("div",{className:"space-y-4",children:[d.jsxs("div",{className:"flex justify-between items-center",children:[d.jsx("div",{className:"font-bold",children:"Review Matches"}),d.jsx("button",{className:"btn btn-ghost btn-sm",onClick:()=>u("upload"),children:"Back"})]}),d.jsx("div",{className:"overflow-x-auto",children:d.jsxs("table",{className:"table table-zebra w-full",children:[d.jsx("thead",{children:d.jsxs("tr",{children:[d.jsx("th",{}),d.jsx("th",{children:"Excel"}),d.jsx("th",{children:"Match"}),d.jsx("th",{children:"Confidence"}),d.jsx("th",{children:"Status"}),d.jsx("th",{children:"Action"})]})}),d.jsx("tbody",{children:o.map((C,le)=>{var se;return d.jsxs("tr",{className:C.userMovieExists?"bg-warning bg-opacity-20":"",children:[d.jsx("td",{children:d.jsx("input",{type:"checkbox",className:"checkbox",checked:C.selected,disabled:!C.tmdbMatch,onChange:()=>{const he=[...o];he[le].selected=!he[le].selected,l(he)}})}),d.jsxs("td",{children:[d.jsx("div",{className:"font-semibold",children:C.excelData.title}),d.jsx("div",{className:"text-xs opacity-70",children:C.excelData.releaseDate||"-"})]}),d.jsx("td",{children:C.tmdbMatch?d.jsxs("div",{className:"flex items-center gap-3",children:[d.jsx("div",{className:"w-12 h-18",children:ws(C.tmdbMatch)?d.jsx("img",{src:ws(C.tmdbMatch),className:"object-cover"}):d.jsx("div",{className:"w-full h-full bg-base-200"})}),d.jsxs("div",{children:[d.jsx("div",{className:"font-semibold",children:C.tmdbMatch.title}),d.jsx("div",{className:"text-xs opacity-70",children:(se=C.tmdbMatch.release_date)==null?void 0:se.slice(0,4)})]})]}):d.jsx("span",{className:"text-error",children:"No match"})}),d.jsx("td",{children:C.tmdbMatch?d.jsxs("div",{className:"flex items-center",children:[d.jsx("progress",{className:`progress ${C.confidence>=70?"progress-success":C.confidence>=40?"progress-warning":"progress-error"}`,value:C.confidence,max:100}),d.jsxs("span",{className:"ml-2",children:[C.confidence,"%"]})]}):"-"}),d.jsxs("td",{children:[C.status==="matched"&&d.jsx("div",{className:"badge badge-success",children:"Matched"}),C.status==="unmatched"&&d.jsx("div",{className:"badge badge-error",children:"Unmatched"}),C.status==="duplicate"&&d.jsx("div",{className:"badge badge-warning",children:"Duplicate"}),C.status==="manual"&&d.jsx("div",{className:"badge badge-info",children:"Manual"})]}),d.jsx("td",{children:d.jsx("button",{className:"btn btn-sm btn-outline",onClick:()=>R(le),children:d.jsx("i",{className:"fas fa-search"})})})]},le)})})]})}),d.jsx("div",{className:"flex justify-end",children:d.jsxs("button",{className:"btn btn-primary",onClick:P,disabled:!g||v,children:["Import ",g," Movies"]})}),!!h&&h<100&&d.jsx("div",{children:d.jsx("progress",{className:"progress w-full",value:h,max:100})})]}),c==="import"&&d.jsxs("div",{className:"space-y-3",children:[d.jsx("div",{className:"font-bold",children:"Importing"}),d.jsx("progress",{className:"progress w-full",value:p,max:100})]}),k!==null&&d.jsx("div",{className:"modal modal-open",children:d.jsxs("div",{className:"modal-box max-w-4xl",children:[d.jsxs("h3",{className:"font-bold text-lg mb-4",children:["Manual match: ",o[k].excelData.title]}),d.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 mb-6",children:[d.jsx("input",{type:"text",className:"input input-bordered flex-1",placeholder:"Search for a movie...",defaultValue:o[k].excelData.title,onKeyDown:C=>C.key==="Enter"&&R(k,C.target.value)}),d.jsx("button",{className:"btn btn-primary w-full sm:w-auto",onClick:()=>{var C;return R(k,(C=document.querySelector(".modal input"))==null?void 0:C.value)},disabled:v,children:v?d.jsx("span",{className:"loading loading-spinner loading-sm"}):d.jsx("i",{className:"fas fa-search"})})]}),d.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-3 max-h-96 overflow-y-auto",children:E.map(C=>{var le;return d.jsxs("div",{className:"card bg-base-100 shadow cursor-pointer",onClick:()=>b(C),children:[d.jsx("figure",{children:ws(C)?d.jsx("img",{src:ws(C)}):d.jsx("div",{className:"h-48 w-full bg-base-200"})}),d.jsxs("div",{className:"card-body p-3",children:[d.jsx("div",{className:"text-sm font-semibold",children:C.title}),d.jsx("div",{className:"text-xs opacity-70",children:(le=C.release_date)==null?void 0:le.slice(0,4)})]})]},C.id)})}),d.jsx("div",{className:"modal-action",children:d.jsx("button",{className:"btn",onClick:()=>{T(null),N([])},children:"Close"})})]})}),O&&d.jsx("div",{className:"alert alert-error",children:O})]})},oz=({selected:e,showDetails:t,loading:r,onToggleDetails:n,onAdd:s,onClose:a})=>{var i,o,l,c,u;return e?d.jsx("dialog",{className:"modal modal-open",children:d.jsxs("div",{className:"modal-box bg-xmas-card",children:[d.jsxs("div",{className:"flex gap-4",children:[d.jsx("div",{className:"w-24 shrink-0",children:ws(e)?d.jsx("img",{src:ws(e),alt:e.title,className:"w-full rounded-lg"}):d.jsx("div",{className:"w-full h-36 bg-base-200 flex items-center justify-center rounded-lg",children:d.jsx("i",{className:"fas fa-film text-2xl opacity-50"})})}),d.jsxs("div",{className:"flex-1",children:[d.jsx("h2",{className:"text-xl font-bold mb-1",children:e.title}),d.jsx("p",{className:"text-sm opacity-80 mb-1",children:(i=e.release_date)==null?void 0:i.slice(0,4)}),!t&&e.runtime&&d.jsxs("p",{className:"text-sm opacity-80 mb-1",children:["Runtime: ",e.runtime," min"]}),t&&d.jsxs("div",{className:"mt-3 space-y-2 text-sm opacity-90 max-h-48 overflow-auto pr-1",children:[e.overview&&d.jsxs("div",{children:[d.jsx("p",{className:"font-semibold mb-1",children:"Overview"}),d.jsx("p",{children:e.overview})]}),e.runtime&&d.jsxs("p",{children:[d.jsx("span",{className:"font-semibold",children:"Runtime:"})," ",e.runtime," min"]}),e.genres&&e.genres.length>0&&d.jsxs("p",{children:[d.jsx("span",{className:"font-semibold",children:"Genres:"})," ",e.genres.map(h=>typeof h=="string"?h:h.name).join(", ")]}),(((l=(o=e.credits)==null?void 0:o.cast)==null?void 0:l.length)||((c=e.cast)==null?void 0:c.length))&&d.jsxs("p",{children:[d.jsx("span",{className:"font-semibold",children:"Top cast:"})," ",((u=e.credits)!=null&&u.cast&&e.credits.cast.length>0?e.credits.cast.map(h=>h.name):e.cast).slice(0,5).join(", ")]})]})]})]}),d.jsxs("div",{className:"mt-4 space-y-3",children:[d.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-3",children:[d.jsx("div",{children:(e.overview||e.runtime||e.genres||e.credits||e.cast)&&d.jsxs("button",{type:"button",className:"btn btn-outline btn-sm sm:btn-md gap-2",onClick:n,disabled:r,children:[d.jsx("i",{className:"fas fa-info-circle"}),t?"Hide details":"View details"]})}),d.jsxs("div",{className:"flex justify-end gap-2",children:[d.jsxs("button",{className:"btn btn-primary btn-sm sm:btn-md",onClick:s,disabled:r,children:[r?d.jsx("span",{className:"loading loading-spinner loading-sm mr-2"}):d.jsx("i",{className:"fas fa-plus mr-2"}),"Add Movie"]}),d.jsx("button",{className:"btn btn-outline btn-sm sm:btn-md",onClick:a,disabled:r,children:"Cancel"})]})]}),e.id&&d.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center gap-2",children:[d.jsx("a",{href:`https://www.themoviedb.org/movie/${e.id}`,target:"_blank",rel:"noopener noreferrer",className:"btn btn-outline btn-xs sm:btn-sm flex items-center justify-center gap-2",children:d.jsx("img",{src:"/tmdb.svg",alt:"TMDB",className:"h-4 sm:h-5"})}),d.jsx("p",{className:"text-[10px] text-gray-400 max-w-xs",children:"This product uses the TMDB API but is not endorsed or certified by TMDB."})]})]}),d.jsx("form",{method:"dialog",className:"modal-backdrop",onClick:a,children:d.jsx("button",{children:"close"})})]})}):null},lz=()=>{const{currentUser:e,userProfile:t}=fs(),{isAdmin:r}=Mu(),[n,s]=W.useState(""),[a,i]=W.useState("local"),[o,l]=W.useState(null),[c,u]=W.useState(!1),[h,m]=W.useState(!1),[p,x]=W.useState(null),[v,w]=W.useState([]);W.useEffect(()=>{r&&(t!=null&&t.tmdbApiKey)?s(t.tmdbApiKey):s("")},[t,r]),W.useEffect(()=>{(async()=>{if(!e){w([]);return}try{const{userMovies:L}=await e0(e.uid);w(Object.keys(L))}catch(L){console.error("Error loading user movies for import page:",L)}})()},[e]);const k=O=>{x(null),u(!1),l(O)},T=async O=>{if(!r){x({type:"error",text:"Only admins can import directly from TMDB."});return}if(!n){x({type:"error",text:"TMDB key required to fetch details."});return}try{m(!0),x(null),u(!1);const L=await Jh(O.id,n);l(L)}catch(L){x({type:"error",text:(L==null?void 0:L.message)??"Failed to fetch details"})}finally{m(!1)}},E=async()=>{if(!(!e||!o))try{m(!0),x(null);const O=mn(_t,"movies"),L=await kn(qh(O,Xh("tmdbId","==",o.id)));let g;if(L.empty){if(!r){x({type:"error",text:"Only admins can add new catalogue movies."}),m(!1);return}g=(await zv(O,{...Hv(o),addedAt:new Date,updatedAt:new Date})).id}else g=L.docs[0].id;await Wv(e.uid,g,{userId:e.uid,movieId:g,watched:!1,favorite:!1}),w(y=>y.includes(g)?y:[...y,g]),x({type:"success",text:"Added to your collection!"}),u(!1),l(null)}catch(O){x({type:"error",text:(O==null?void 0:O.message)??"Failed to add movie"})}finally{m(!1)}},N=()=>{h||l(null)};return d.jsxs("div",{className:"container mx-auto px-4 py-8",children:[d.jsx("div",{className:"mb-4",children:d.jsxs(et,{to:"/movies",className:"btn btn-primary btn-sm sm:btn-md",children:[d.jsx("i",{className:"fas fa-arrow-left mr-2"})," Back to Movies"]})}),d.jsx("h1",{className:"font-christmas text-3xl md:text-4xl text-xmas-line mb-6",children:"Add Movies"}),p&&d.jsxs("div",{className:`alert ${p.type==="error"?"alert-error":"alert-success"} mb-4`,children:[d.jsx("i",{className:`fas ${p.type==="error"?"fa-exclamation-circle":"fa-check-circle"} mr-2`}),d.jsx("span",{children:p.text})]}),d.jsxs("div",{className:"tabs tabs-boxed mb-6",children:[d.jsxs("button",{className:`tab ${a==="local"?"tab-active":""}`,onClick:()=>i("local"),children:[d.jsx("i",{className:"fas fa-database mr-2"}),"Local"]}),r&&d.jsxs("button",{className:`tab ${a==="tmdb"?"tab-active":""}`,onClick:()=>i("tmdb"),children:[d.jsx("i",{className:"fas fa-search mr-2"}),"TMDB"]}),r&&d.jsxs("button",{className:`tab ${a==="excel"?"tab-active":""}`,onClick:()=>i("excel"),children:[d.jsx("i",{className:"fas fa-file-excel mr-2"}),"Excel"]})]}),a==="local"&&d.jsx("div",{className:"bg-xmas-card p-6 rounded-lg shadow-lg",children:d.jsx(ZL,{onSelect:k,userMovieIds:v})}),a==="tmdb"&&r&&d.jsxs("div",{className:"bg-xmas-card p-6 rounded-lg shadow-lg",children:[!n&&d.jsxs("div",{className:"alert alert-warning mb-4",children:[d.jsx("i",{className:"fas fa-exclamation-triangle mr-2"}),d.jsx("span",{children:"Set your TMDB API key in Profile to search TMDB."})]}),d.jsx(n6,{tmdbApiKey:n,onSelect:T})]}),a==="excel"&&r&&d.jsxs("div",{className:"bg-xmas-card p-6 rounded-lg shadow-lg",children:[!n&&d.jsxs("div",{className:"alert alert-warning mb-4",children:[d.jsx("i",{className:"fas fa-exclamation-triangle mr-2"}),d.jsx("span",{children:"TMDB key required for matching."})]}),e?d.jsx(iz,{tmdbApiKey:n,userId:e.uid,onDone:()=>i("local")}):d.jsx("div",{className:"alert alert-info",children:"Log in to import from Excel."})]}),o&&d.jsx(oz,{selected:o,showDetails:c,loading:h,onToggleDetails:()=>u(O=>!O),onAdd:E,onClose:N})]})},cz=()=>{var w,k,T;const{currentUser:e}=fs(),[t,r]=W.useState([]),[n,s]=W.useState({}),[a,i]=W.useState(!0),[o,l]=W.useState(null),[c,u]=W.useState(null),[h,m]=W.useState(!1),[p,x]=W.useState(!1);W.useEffect(()=>{(async()=>{if(e)try{i(!0);const{userMovies:N,movies:O}=await e0(e.uid);s(N),r(O)}catch(N){console.error("Error fetching movies:",N),l("Failed to load movies")}finally{i(!1)}})()},[e]);const v=()=>{if(t.length===0)return;x(!0),u(null);const E=t.filter(g=>{const y=n[g.id];return h||!y||!y.watched});if(E.length===0){l("No eligible movies found. Try including watched movies."),x(!1);return}let N=0;const O=25,L=setInterval(()=>{const g=Math.floor(Math.random()*E.length);u(E[g]),N++,N>=O&&(clearInterval(L),x(!1))},100)};return a?d.jsx("div",{className:"flex justify-center items-center min-h-[60vh]",children:d.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-xmas-gold"})}):d.jsxs("div",{className:"container mx-auto px-4 py-8",children:[d.jsx("div",{className:"mb-4",children:d.jsxs(et,{to:"/movies",className:"btn btn-primary btn-sm sm:btn-md",children:[d.jsx("i",{className:"fas fa-arrow-left mr-2"})," Back to Movies"]})}),d.jsx("h1",{className:"font-christmas text-3xl md:text-4xl text-xmas-line mb-6",children:"Christmas Movie Picker"}),o&&d.jsxs("div",{className:"alert alert-error mb-6",children:[d.jsx("i",{className:"fas fa-exclamation-circle mr-2"}),d.jsx("span",{children:o})]}),t.length===0?d.jsxs("div",{className:"bg-xmas-card p-8 rounded-lg text-center",children:[d.jsx("h3",{className:"text-xl mb-4",children:"No movies in your collection"}),d.jsx("p",{className:"mb-4",children:"Add some Christmas movies to use the random movie picker!"}),d.jsxs(et,{to:"/import",className:"btn btn-primary",children:[d.jsx("i",{className:"fas fa-file-import mr-2"})," Import Movies"]})]}):d.jsxs("div",{className:"bg-xmas-card p-8 rounded-lg shadow-lg",children:[d.jsxs("div",{className:"text-center mb-6",children:[d.jsx("p",{className:"mb-4",children:"Can't decide what Christmas movie to watch? Let us pick one for you!"}),d.jsx("div",{className:"form-control mb-6",children:d.jsxs("label",{className:"label cursor-pointer justify-center",children:[d.jsx("span",{className:"label-text mr-2",children:"Include watched movies"}),d.jsx("input",{type:"checkbox",className:"toggle toggle-primary",checked:h,onChange:()=>m(!h)})]})}),d.jsx("button",{className:"btn btn-primary btn-lg",onClick:v,disabled:p,children:p?d.jsxs(d.Fragment,{children:[d.jsx("span",{className:"loading loading-spinner loading-md mr-2"}),"Picking a movie..."]}):d.jsxs(d.Fragment,{children:[d.jsx("i",{className:"fas fa-random mr-2"}),"Pick a Random Movie"]})})]}),c&&d.jsx("div",{className:"mt-8 flex flex-col items-center",children:d.jsx("div",{className:"w-full max-w-md",children:d.jsxs("div",{className:"card bg-base-100 shadow-xl overflow-hidden",children:[d.jsxs("figure",{className:"relative",children:[c.posterUrl?d.jsx("img",{src:c.posterUrl,alt:c.title,className:"w-full object-contain",style:{aspectRatio:"2/3",maxHeight:"500px"},loading:"lazy"}):d.jsx("div",{className:"w-full flex items-center justify-center bg-gray-800",style:{aspectRatio:"2/3",maxHeight:"500px"},children:d.jsx("i",{className:"fas fa-film text-6xl text-gray-500"})}),((w=n[c.id])==null?void 0:w.watched)&&d.jsx("div",{className:"absolute top-4 left-4 badge badge-lg badge-success",children:"Already Watched"}),((k=n[c.id])==null?void 0:k.rating)&&d.jsxs("div",{className:"absolute top-4 right-4 badge badge-lg badge-warning",children:[d.jsx("i",{className:"fas fa-star mr-1"}),n[c.id].rating,"/10"]})]}),d.jsxs("div",{className:"card-body",children:[d.jsx("h2",{className:"card-title text-2xl font-christmas",children:c.title}),d.jsx("p",{className:"text-gray-400",children:(T=c.releaseDate)==null?void 0:T.substring(0,4)}),d.jsxs("div",{className:"card-actions justify-end mt-4",children:[d.jsx(et,{to:$v(c.title,c.id),className:"btn btn-primary",children:"View Details"}),d.jsx("button",{className:"btn btn-outline",onClick:v,disabled:p,children:"Pick Another"})]})]})]})})})]})]})},uz=(e,t)=>{const r=["Title","TMDB ID","Release Year","Watched","Watched Date","Rating","Review","Favorite","Date Added"].join(","),n=e.map(s=>{const a=t[s.id];if(!a)return null;const i=s.releaseDate?s.releaseDate.substring(0,4):"",o=a.watchedDate?$p(a.watchedDate):"",l=a.addedAt?$p(a.addedAt):"",c=Yw(s.title),u=a.review?Yw(a.review):"";return[c,s.tmdbId||"",i,a.watched?"Yes":"No",o,a.rating!==null&&a.rating!==void 0?a.rating:"",u,a.favorite?"Yes":"No",l].join(",")}).filter(Boolean);return[r,...n].join(`
`)},$p=e=>{if(!(e instanceof Date))try{e&&typeof e.toDate=="function"?e=e.toDate():e=new Date(e)}catch{return""}return e.toISOString().split("T")[0]},Yw=e=>e?e.includes(",")||e.includes('"')||e.includes(`
`)?`"${e.replace(/"/g,'""')}"`:e:"",fz=(e,t,r)=>{const n=document.createElement("a"),s=new Blob([e],{type:r});n.href=URL.createObjectURL(s),n.download=t,n.click(),URL.revokeObjectURL(n.href)},hz=async(e,t,r)=>{const n=uz(e,t),s=`${r.replace(/\s+/g,"_")}_christmas_movies_${$p(new Date)}.csv`;fz(n,s,"text/csv;charset=utf-8;")},dz=async()=>{const e=mn(_t,"movies"),t=await kn(e);let r=0;const n=t.size;for(const s of t.docs){const a=s.data();if(a.sortTitle)continue;const i=YS(a.title);i!==a.title&&(await dl(Yr(_t,"movies",s.id),{sortTitle:i,updatedAt:new Date}),r++)}return{updated:r,total:n}},mz=()=>{const{currentUser:e,userProfile:t,signOut:r}=fs(),{isAdmin:n}=Mu(),[s,a]=W.useState(!1),[i,o]=W.useState(""),[l,c]=W.useState(!1),[u,h]=W.useState(!1),[m,p]=W.useState(!1),[x,v]=W.useState(null),[w,k]=W.useState(null),[T,E]=W.useState({totalMovies:0,watchedMovies:0,unwatchedMovies:0,averageRating:0,favoriteMovies:0});W.useEffect(()=>{t!=null&&t.tmdbApiKey&&o(t.tmdbApiKey),(async()=>{if(e)try{const y=await XS(e.uid),S=y.length,R=y.filter(se=>se.watched).length,b=S-R,P=y.filter(se=>se.favorite).length,C=y.filter(se=>se.rating!==void 0&&se.rating!==null),le=C.length>0?C.reduce((se,he)=>se+(he.rating||0),0)/C.length:0;E({totalMovies:S,watchedMovies:R,unwatchedMovies:b,averageRating:le,favoriteMovies:P})}catch(y){console.error("Error fetching user stats:",y)}})()},[e,t]);const N=async()=>{if(e)try{c(!0),v(null);const g=Yr(_t,"users",e.uid);await dl(g,{tmdbApiKey:i}),k("TMDB API key saved successfully!"),setTimeout(()=>{k(null)},3e3)}catch(g){console.error("Error saving API key:",g),v(g.message||"Failed to save API key")}finally{c(!1)}},O=async()=>{try{await r()}catch(g){console.error("Error signing out:",g)}},L=async()=>{if(e)try{h(!0),v(null);const{userMovies:g,movies:y}=await e0(e.uid);await hz(y,g,t.displayName||"User"),k("Movies exported successfully!"),setTimeout(()=>{k(null)},3e3)}catch(g){console.error("Error exporting movies:",g),v(g.message||"Failed to export movies")}finally{h(!1)}};return!e||!t?d.jsx("div",{className:"flex justify-center items-center min-h-[60vh]",children:d.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-xmas-gold"})}):d.jsxs("div",{className:"container mx-auto px-4 py-8",children:[d.jsx("h1",{className:"font-christmas text-3xl md:text-4xl text-xmas-line mb-6",children:"Your Profile"}),x&&d.jsxs("div",{className:"alert alert-error mb-6",children:[d.jsx("i",{className:"fas fa-exclamation-circle mr-2"}),d.jsx("span",{children:x})]}),w&&d.jsxs("div",{className:"alert alert-success mb-6",children:[d.jsx("i",{className:"fas fa-check-circle mr-2"}),d.jsx("span",{children:w})]}),d.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-8",children:[d.jsx("div",{className:"md:col-span-1",children:d.jsxs("div",{className:"bg-xmas-card p-6 rounded-lg shadow-lg",children:[d.jsxs("div",{className:"flex flex-col items-center mb-6",children:[t.photoURL?d.jsx("img",{src:t.photoURL,alt:t.displayName,className:"w-24 h-24 rounded-full mb-4"}):d.jsx("div",{className:"w-24 h-24 rounded-full bg-gray-700 flex items-center justify-center mb-4",children:d.jsx("i",{className:"fas fa-user text-4xl text-gray-400"})}),d.jsx("h2",{className:"text-xl font-bold",children:t.displayName})]}),d.jsx("div",{className:"divider"}),d.jsxs("div",{className:"mb-6",children:[d.jsx("h3",{className:"text-lg font-bold mb-2",children:"Your Stats"}),d.jsxs("ul",{className:"space-y-2",children:[d.jsxs("li",{className:"flex justify-between",children:[d.jsx("span",{children:"Total Movies:"}),d.jsx("span",{className:"font-bold",children:T.totalMovies})]}),d.jsxs("li",{className:"flex justify-between",children:[d.jsx("span",{children:"Watched:"}),d.jsx("span",{className:"font-bold",children:T.watchedMovies})]}),d.jsxs("li",{className:"flex justify-between",children:[d.jsx("span",{children:"Unwatched:"}),d.jsx("span",{className:"font-bold",children:T.unwatchedMovies})]}),d.jsxs("li",{className:"flex justify-between",children:[d.jsx("span",{children:"Favorites:"}),d.jsx("span",{className:"font-bold",children:T.favoriteMovies})]}),d.jsxs("li",{className:"flex justify-between",children:[d.jsx("span",{children:"Average Rating:"}),d.jsxs("span",{className:"font-bold",children:[T.averageRating.toFixed(1),"/10"]})]})]})]}),d.jsx("div",{className:"divider"}),d.jsxs("div",{className:"mt-6 space-y-3",children:[d.jsxs("button",{className:"btn btn-outline btn-primary w-full",onClick:L,disabled:u||T.totalMovies===0,children:[u?d.jsx("span",{className:"loading loading-spinner loading-sm mr-2"}):d.jsx("i",{className:"fas fa-file-export mr-2"}),"Export Movie Data"]}),d.jsxs("button",{className:"btn btn-outline btn-error w-full",onClick:O,children:[d.jsx("i",{className:"fas fa-sign-out-alt mr-2"}),"Sign Out"]})]})]})}),d.jsx("div",{className:"md:col-span-2",children:d.jsxs("div",{className:"bg-xmas-card p-6 rounded-lg shadow-lg",children:[n&&d.jsxs(d.Fragment,{children:[d.jsx("h2",{className:"text-2xl font-bold mb-4",children:"Settings"}),d.jsxs("div",{className:"mb-6",children:[d.jsx("h3",{className:"text-lg font-bold mb-2",children:"TMDB API Key"}),d.jsxs("p",{className:"mb-4",children:["Your TMDB API key is used to fetch movies, cast and other details."," ",d.jsx("a",{href:"https://www.themoviedb.org/settings/api",target:"_blank",rel:"noopener noreferrer",className:"link link-primary",children:"The Movie Database"}),"."]}),d.jsxs("div",{className:"form-control",children:[d.jsx("label",{className:"label",children:d.jsx("span",{className:"label-text",children:"API Key"})}),d.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 items-stretch",children:[d.jsx("input",{type:s?"text":"password",className:"input input-bordered flex-1 h-12 text-lg",value:i,onChange:g=>o(g.target.value),placeholder:"Enter your TMDB API key",style:{letterSpacing:s?"normal":"3px"}}),d.jsx("button",{type:"button",className:"btn btn-ghost w-12",onClick:()=>a(g=>!g),children:d.jsx("i",{className:`fas ${s?"fa-eye-slash":"fa-eye"}`})}),d.jsx("button",{className:"btn btn-primary w-full sm:w-auto",onClick:N,disabled:l,children:l?d.jsx("span",{className:"loading loading-spinner loading-sm"}):d.jsx("i",{className:"fas fa-save"})})]})]})]}),d.jsx("div",{className:"divider"})]}),d.jsxs("div",{className:"mb-6",children:[d.jsx("h3",{className:"text-lg font-bold mb-2",children:"Quick Links"}),d.jsxs("div",{className:"flex flex-wrap gap-2",children:[d.jsxs(et,{to:"/movies",className:"btn btn-outline btn-sm",children:[d.jsx("i",{className:"fas fa-film mr-2"}),"My Movies"]}),d.jsxs(et,{to:"/import",className:"btn btn-outline btn-sm",children:[d.jsx("i",{className:"fas fa-file-import mr-2"}),"Import Movies"]}),d.jsxs(et,{to:"/random",className:"btn btn-outline btn-sm",children:[d.jsx("i",{className:"fas fa-random mr-2"}),"Random Movie Picker"]}),d.jsxs(et,{to:"/achievements",className:"btn btn-outline btn-sm",children:[d.jsx("i",{className:"fas fa-trophy mr-2"}),"Achievements"]})]})]}),n&&d.jsxs(d.Fragment,{children:[d.jsx("div",{className:"divider"}),d.jsxs("div",{className:"mb-6",children:[d.jsx("h3",{className:"text-lg font-bold mb-2",children:"Admin Tools"}),d.jsxs(et,{to:"/admin",className:"btn btn-primary btn-sm",children:[d.jsx("i",{className:"fas fa-tools mr-2"}),"Open Admin Dashboard"]})]})]})]})})]})]})},pz=({item:e})=>{const[t,r]=fd.useState(!1);return d.jsxs("div",{className:"rounded-lg p-4 shadow-lg border transition-transform bg-xmas-card "+(e.unlocked?"border-xmas-gold hover:scale-[1.02]":"border-gray-700 opacity-70"),children:[d.jsxs("div",{className:"flex items-center mb-3",children:[d.jsx("div",{className:"relative mr-3 w-16 h-16 rounded-full overflow-hidden border border-xmas-gold/60 bg-gray-800 flex items-center justify-center",children:t?d.jsx("span",{className:"text-3xl",children:e.icon}):d.jsx("img",{src:`/achievements/${e.id}.png`,alt:e.name,className:"w-full h-full object-cover",loading:"lazy",onError:()=>r(!0)})}),d.jsxs("div",{children:[d.jsxs("h2",{className:"text-lg font-bold flex items-center gap-2",children:[e.name,e.unlocked&&d.jsx("span",{className:"badge badge-success badge-sm",children:"Unlocked"})]}),e.unlocked&&e.unlockedAt&&d.jsxs("p",{className:"text-xs text-xmas-text/70 mt-1",children:["Unlocked on"," ",e.unlockedAt.toLocaleDateString(void 0,{year:"numeric",month:"short",day:"numeric"})]})]})]}),d.jsx("p",{className:"text-sm text-xmas-text mb-3",children:e.unlocked?e.description:e.hint}),!e.unlocked&&d.jsx("p",{className:"text-xs text-xmas-text/60 italic",children:"Locked  keep watching to reveal this badge."})]})},gz=()=>{const{currentUser:e}=fs(),[t,r]=W.useState(!0),[n,s]=W.useState([]);return W.useEffect(()=>{(async()=>{if(e)try{r(!0),await nh(e.uid);const i=mn(_t,`users/${e.uid}/achievements`),o=await kn(i),l=new Map;o.forEach(u=>{const h=u.data();let m=null;h.unlockedAt instanceof Date?m=h.unlockedAt:h.unlockedAt&&typeof h.unlockedAt.toDate=="function"&&(m=h.unlockedAt.toDate()),l.set(u.id,{unlockedAt:m,seen:h.seen})});const c=Go.map(u=>{const h=l.get(u.id);return{id:u.id,name:u.name,description:u.description,hint:u.hint,icon:u.icon,unlocked:!!h,unlockedAt:(h==null?void 0:h.unlockedAt)??null}}).sort((u,h)=>{if(u.unlocked!==h.unlocked)return u.unlocked?-1:1;if(u.unlocked&&h.unlocked){const m=u.unlockedAt?u.unlockedAt.getTime():0,p=h.unlockedAt?h.unlockedAt.getTime():0;if(m!==p)return m-p}return u.name.localeCompare(h.name)});s(c)}finally{r(!1)}})()},[e]),e?t?d.jsx("div",{className:"flex justify-center items-center min-h-[60vh]",children:d.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-xmas-gold"})}):d.jsxs("div",{className:"container mx-auto px-4 py-8",children:[d.jsx("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between mb-6",children:d.jsxs("div",{children:[d.jsx("h1",{className:"font-christmas text-3xl md:text-4xl text-xmas-line mb-2",children:"Achievements"}),d.jsx("p",{className:"text-sm text-xmas-text/80",children:"Unlock festive badges as you watch, rate and explore your Christmas movies."})]})}),d.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-3 gap-6",children:n.map(a=>d.jsx(pz,{item:a},a.id))})]}):d.jsx("div",{className:"flex justify-center items-center min-h-[60vh]",children:d.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-xmas-gold"})})},vz=()=>{const e=mi(),{isAdmin:t,loading:r,currentUser:n}=Mu(),[s,a]=W.useState(!1),[i,o]=W.useState(null),l=!1;W.useEffect(()=>{t&&!r&&e("/admin")},[t,r,e]);const c=async()=>{o(null),a(!0);try{await xk(wc,TL)}catch(u){console.error("Login error:",u),u.code==="auth/popup-closed-by-user"?o("Sign-in popup was closed. Please try again."):u.code==="auth/cancelled-popup-request"?o("Another popup is already open. Please try again."):u.code==="auth/unauthorized-domain"?(console.error("Unauthorized domain error:",window.location.hostname),o("This domain is not authorized for OAuth operations. Please add "+window.location.hostname+" to your Firebase authorized domains list in the Firebase console under Authentication > Sign-in method > Authorized domains.")):o("Failed to sign in. Please try again."),a(!1)}};return r?d.jsx("div",{className:"flex justify-center items-center min-h-[60vh]",children:d.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-xmas-gold"})}):d.jsx("div",{className:"container mx-auto px-4 py-12",children:d.jsxs("div",{className:"max-w-md mx-auto",children:[d.jsxs("div",{className:"text-center mb-8",children:[d.jsx("h1",{className:"font-christmas text-4xl text-xmas-line mb-2",children:"Admin Login"}),d.jsx("p",{className:"text-xmas-mute",children:"Sign in to manage the Christmas Quiz"})]}),d.jsxs("div",{className:"bg-xmas-card rounded-lg shadow-lg p-6",children:[l,n&&d.jsxs("div",{className:"bg-info bg-opacity-10 border-l-4 border-info p-4 mb-6 rounded",children:[d.jsx("p",{className:"text-info font-bold mb-2",children:"User Authenticated"}),d.jsxs("p",{className:"text-info text-sm mb-1",children:["Email: ",n.email]}),d.jsxs("p",{className:"text-info text-sm mb-2",children:["UID: ",n.uid]}),d.jsxs("p",{className:"text-info text-sm",children:["To grant admin access, create a document in the ",d.jsx("code",{className:"bg-base-300 px-1 py-0.5 rounded",children:"admins"})," collection with this UID as the document ID."]}),l]}),i&&d.jsx("div",{className:"bg-error bg-opacity-10 border-l-4 border-error p-4 mb-6 rounded",children:d.jsx("p",{className:"text-error",children:i})}),d.jsxs("div",{className:"text-center mb-6",children:[d.jsx("p",{className:"mb-4",children:"Sign in with your Google account to access the admin panel."}),d.jsx("p",{className:"text-sm text-xmas-mute mb-6",children:"Only authorized administrators will be granted access."}),d.jsx("button",{onClick:c,className:"btn btn-primary w-full flex items-center justify-center gap-2",disabled:s,children:s?d.jsxs(d.Fragment,{children:[d.jsx("span",{className:"loading loading-spinner loading-sm"}),"Signing in..."]}):d.jsxs(d.Fragment,{children:[d.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 48 48",children:[d.jsx("path",{fill:"#FFC107",d:`M43.611,20.083H42V20H24v8h11.303c-1.649,4.657-6.08,8-11.303,8c-6.627,0-12-5.373-12-12
                      s5.373-12,12-12c3.059,0,5.842,1.154,7.961,3.039l5.657-5.657C34.046,6.053,29.268,4,24,4C12.955,4,4,12.955,4,24s8.955,20,20,20
                      s20-8.955,20-20C44,22.659,43.862,21.35,43.611,20.083z`}),d.jsx("path",{fill:"#FF3D00",d:`M6.306,14.691l6.571,4.819C14.655,15.108,18.961,12,24,12c3.059,0,5.842,1.154,7.961,3.039
                      l5.657-5.657C34.046,6.053,29.268,4,24,4C16.318,4,9.656,8.337,6.306,14.691z`}),d.jsx("path",{fill:"#4CAF50",d:`M24,44c5.166,0,9.86-1.977,13.409-5.192l-6.19-5.238C29.211,35.091,26.715,36,24,36
                      c-5.202,0-9.619-3.317-11.283-7.946l-6.522,5.025C9.505,39.556,16.227,44,24,44z`}),d.jsx("path",{fill:"#1976D2",d:`M43.611,20.083H42V20H24v8h11.303c-0.792,2.237-2.231,4.166-4.087,5.571
                      c0.001-0.001,0.002-0.001,0.003-0.002l6.19,5.238C36.971,39.205,44,34,44,24C44,22.659,43.862,21.35,43.611,20.083z`})]}),"Sign in with Google"]})})]})]}),d.jsx("div",{className:"text-center mt-6",children:d.jsx("button",{onClick:()=>e("/"),className:"btn btn-link text-xmas-mute",children:"Back to Home"})})]})})};async function xz(e,t){const r=await Jh(e,t),n=mn(_t,"movies"),s=qh(n,Xh("tmdbId","==",r.id)),a=await kn(s),i={...Hv(r),updatedAt:new Date};if(a.empty){const o={...i,addedAt:new Date};return{movieId:(await zv(n,o)).id,action:"created"}}else{const o=a.docs[0].id;return await oi(Yr(_t,"movies",o),i,{merge:!0}),{movieId:o,action:"updated"}}}const _z=e=>new Promise(t=>setTimeout(t,e));async function yz(e,t,r,n=200){let s=0,a=0,i=0,o=0;const l=[];for(let c=0;c<e.length;c++){const u=e[c];try{if(!u||Number.isNaN(u)){i++,r==null||r(c+1,e.length,"skipped");continue}const{movieId:h,action:m}=await xz(u,t);l.push(h),m==="created"?s++:a++,r==null||r(c+1,e.length,m),n>0&&await _z(n)}catch(h){console.error("Catalogue upsert error for TMDB",u,h),o++,r==null||r(c+1,e.length,"error")}}return{totalRequested:e.length,created:s,updated:a,skipped:i,errors:o,movieIds:l}}const wz=()=>{const e=mi(),{isAdmin:t,loading:r}=Mu(),{userProfile:n}=fs(),[s,a]=W.useState(!0),[i,o]=W.useState(null),[l,c]=W.useState(null),[u,h]=W.useState(!1),[m,p]=W.useState({totalMovies:0,moviesWithSortTitle:0}),[x,v]=W.useState(""),[w,k]=W.useState(""),[T,E]=W.useState(!0),[N,O]=W.useState(!1),[L,g]=W.useState(0),[y,S]=W.useState("");W.useEffect(()=>{n!=null&&n.tmdbApiKey&&v(n.tmdbApiKey)},[n]),W.useEffect(()=>{!r&&!t&&e("/admin/login")},[t,r,e]),W.useEffect(()=>{t&&(async()=>{if(t){a(!0);try{const le=await kn(mn(_t,"movies")),se=le.size;let he=0;le.forEach(de=>{de.data().sortTitle&&he++}),p({totalMovies:se,moviesWithSortTitle:he})}catch(le){console.error("Error fetching movie data:",le),o("Failed to load movie data")}finally{a(!1)}}})()},[t]);const R=async()=>{try{h(!0),o(null);const C=await dz();c(`Sort titles updated for ${C.updated} out of ${C.total} movies.`),p(le=>({...le,moviesWithSortTitle:le.moviesWithSortTitle+C.updated})),setTimeout(()=>c(null),5e3)}catch(C){console.error("Error updating sort titles:",C),o(C.message||"Failed to update sort titles")}finally{h(!1)}},b=W.useMemo(()=>{const le=w.split(/[\s,]+/).map(se=>se.trim()).filter(Boolean).map(se=>Number(se)).filter(se=>Number.isInteger(se)&&se>0);return Array.from(new Set(le))},[w]),P=async()=>{if(o(null),c(null),!x){o("TMDB API key required");return}if(b.length===0){o("Please paste at least one valid TMDB ID");return}try{O(!0),g(0),S(`Starting (0 / ${b.length})`);const C=await yz(b,x,(le,se,he)=>{const de=Math.round(le/se*100);g(de),S(`Processed ${le} / ${se} (${he})`)},T?300:0);c(`Catalogue updated. Created: ${C.created}, Updated: ${C.updated}, Skipped: ${C.skipped}, Errors: ${C.errors}.`)}catch(C){console.error(C),o((C==null?void 0:C.message)??"Catalogue import failed.")}finally{O(!1)}};return r||s?d.jsx("div",{className:"flex justify-center items-center min-h-[60vh]",children:d.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-xmas-gold"})}):d.jsxs("div",{className:"container mx-auto px-4 py-8",children:[d.jsxs("div",{className:"flex justify-between items-center mb-8",children:[d.jsx("h1",{className:"font-christmas text-3xl md:text-4xl text-xmas-line",children:"Admin Dashboard"}),d.jsx("div",{className:"flex gap-2",children:d.jsxs(et,{to:"/movies",className:"btn btn-outline",children:[d.jsx("i",{className:"fas fa-film mr-2"})," Movies"]})})]}),i&&d.jsxs("div",{className:"alert alert-error mb-6",children:[d.jsx("i",{className:"fas fa-exclamation-circle mr-2"}),d.jsx("span",{children:i})]}),l&&d.jsxs("div",{className:"alert alert-success mb-6",children:[d.jsx("i",{className:"fas fa-check-circle mr-2"}),d.jsx("span",{children:l})]}),d.jsxs("div",{className:"mb-8",children:[d.jsx("h2",{className:"text-2xl font-christmas mb-4 text-xmas-gold",children:"Movie Administration"}),d.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-8",children:[d.jsx("div",{className:"card bg-xmas-card shadow-xl",children:d.jsxs("div",{className:"card-body",children:[d.jsxs("h2",{className:"card-title font-christmas",children:[d.jsx("i",{className:"fas fa-sort-alpha-down text-primary mr-2"})," Sort Title Migration"]}),d.jsx("p",{className:"mb-4",children:'Update all movies to include sort titles (e.g., "The Grinch"  "Grinch") for better alphabetical sorting.'}),d.jsxs("div",{className:"flex flex-col gap-2",children:[d.jsxs("div",{className:"stats bg-base-200 text-base-content",children:[d.jsxs("div",{className:"stat",children:[d.jsx("div",{className:"stat-title",children:"Total Movies"}),d.jsx("div",{className:"stat-value",children:m.totalMovies})]}),d.jsxs("div",{className:"stat",children:[d.jsx("div",{className:"stat-title",children:"With Sort Titles"}),d.jsx("div",{className:"stat-value",children:m.moviesWithSortTitle}),d.jsx("div",{className:"stat-desc",children:m.totalMovies>0?`${Math.round(m.moviesWithSortTitle/m.totalMovies*100)}%`:"0%"})]})]}),d.jsxs("button",{className:"btn btn-primary w-full",onClick:R,disabled:u||m.moviesWithSortTitle===m.totalMovies,children:[u?d.jsx("span",{className:"loading loading-spinner loading-sm mr-2"}):d.jsx("i",{className:"fas fa-sync-alt mr-2"}),m.moviesWithSortTitle===m.totalMovies?"All Movies Updated":"Update Sort Titles"]})]})]})}),d.jsx("div",{className:"card bg-xmas-card shadow-xl",children:d.jsxs("div",{className:"card-body",children:[d.jsxs("h2",{className:"card-title font-christmas",children:[d.jsx("i",{className:"fas fa-database text-primary mr-2"})," Catalogue Builder (TMDB IDs)"]}),d.jsxs("p",{className:"mb-4",children:["Bulk-import TMDB titles into your ",d.jsx("code",{children:"movies"})," catalogue only  no user collections will be updated."]}),d.jsx("label",{className:"label mt-4",children:d.jsx("span",{className:"label-text",children:"TMDB IDs (comma / space / newline separated)"})}),d.jsx("textarea",{className:"textarea textarea-bordered w-full h-40",value:w,onChange:C=>k(C.target.value),placeholder:`e.g. 603, 497, 155, 27205
603
497 155
27205`}),d.jsxs("div",{className:"flex items-center gap-4 mt-4",children:[d.jsx("div",{className:"form-control",children:d.jsxs("label",{className:"label cursor-pointer gap-2",children:[d.jsx("span",{className:"label-text",children:"Slow mode (API friendly)"}),d.jsx("input",{type:"checkbox",className:"toggle",checked:T,onChange:C=>E(C.target.checked)})]})}),d.jsx("button",{className:"btn btn-primary ml-auto",onClick:P,disabled:N||b.length===0||!x,title:x?void 0:"Add your TMDB API key in Profile > Settings",children:N?d.jsxs(d.Fragment,{children:[d.jsx("span",{className:"loading loading-spinner loading-sm mr-2"}),"Importing ",b.length,""]}):d.jsxs(d.Fragment,{children:[d.jsx("i",{className:"fas fa-file-import mr-2"}),"Import ",b.length||0," to Catalogue"]})})]}),(N||L>0)&&d.jsxs("div",{className:"mt-4",children:[d.jsx("progress",{className:"progress w-full",value:L,max:100}),d.jsx("div",{className:"text-sm mt-1 opacity-80",children:y})]})]})})]})]})]})},Ez=GN([{element:d.jsx(IL,{}),children:[{path:"/",element:d.jsx(bL,{})},{path:"/login",element:d.jsx(PL,{})},{element:d.jsx($y,{}),children:[{path:"/movies",element:d.jsx(BL,{})},{path:"/movies/:movieId",element:d.jsx(JL,{})},{path:"/import",element:d.jsx(lz,{})},{path:"/random",element:d.jsx(cz,{})},{path:"/profile",element:d.jsx(mz,{})},{path:"/achievements",element:d.jsx(gz,{})}]},{path:"/admin/login",element:d.jsx(vz,{})},{path:"/admin",element:d.jsx($y,{children:d.jsx(wz,{})})}]}]);om.createRoot(document.getElementById("root")).render(d.jsx(fd.StrictMode,{children:d.jsx(kL,{children:d.jsx(CL,{children:d.jsx(eb,{router:Ez})})})}));
