function Qw(e,t){for(var r=0;r<t.length;r++){const n=t[r];if(typeof n!="string"&&!Array.isArray(n)){for(const s in n)if(s!=="default"&&!(s in e)){const a=Object.getOwnPropertyDescriptor(n,s);a&&Object.defineProperty(e,s,a.get?a:{enumerable:!0,get:()=>n[s]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))n(s);new MutationObserver(s=>{for(const a of s)if(a.type==="childList")for(const i of a.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&n(i)}).observe(document,{childList:!0,subtree:!0});function r(s){const a={};return s.integrity&&(a.integrity=s.integrity),s.referrerPolicy&&(a.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?a.credentials="include":s.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function n(s){if(s.ep)return;s.ep=!0;const a=r(s);fetch(s.href,a)}})();function Jw(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var Zw={exports:{}},ud={},eE={exports:{}},qe={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var vu=Symbol.for("react.element"),QI=Symbol.for("react.portal"),JI=Symbol.for("react.fragment"),ZI=Symbol.for("react.strict_mode"),eC=Symbol.for("react.profiler"),tC=Symbol.for("react.provider"),rC=Symbol.for("react.context"),nC=Symbol.for("react.forward_ref"),sC=Symbol.for("react.suspense"),aC=Symbol.for("react.memo"),iC=Symbol.for("react.lazy"),Kx=Symbol.iterator;function oC(e){return e===null||typeof e!="object"?null:(e=Kx&&e[Kx]||e["@@iterator"],typeof e=="function"?e:null)}var tE={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},rE=Object.assign,nE={};function xl(e,t,r){this.props=e,this.context=t,this.refs=nE,this.updater=r||tE}xl.prototype.isReactComponent={};xl.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};xl.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function sE(){}sE.prototype=xl.prototype;function Gp(e,t,r){this.props=e,this.context=t,this.refs=nE,this.updater=r||tE}var Kp=Gp.prototype=new sE;Kp.constructor=Gp;rE(Kp,xl.prototype);Kp.isPureReactComponent=!0;var qx=Array.isArray,aE=Object.prototype.hasOwnProperty,qp={current:null},iE={key:!0,ref:!0,__self:!0,__source:!0};function oE(e,t,r){var n,s={},a=null,i=null;if(t!=null)for(n in t.ref!==void 0&&(i=t.ref),t.key!==void 0&&(a=""+t.key),t)aE.call(t,n)&&!iE.hasOwnProperty(n)&&(s[n]=t[n]);var o=arguments.length-2;if(o===1)s.children=r;else if(1<o){for(var l=Array(o),c=0;c<o;c++)l[c]=arguments[c+2];s.children=l}if(e&&e.defaultProps)for(n in o=e.defaultProps,o)s[n]===void 0&&(s[n]=o[n]);return{$$typeof:vu,type:e,key:a,ref:i,props:s,_owner:qp.current}}function lC(e,t){return{$$typeof:vu,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function Xp(e){return typeof e=="object"&&e!==null&&e.$$typeof===vu}function cC(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(r){return t[r]})}var Xx=/\/+/g;function h0(e,t){return typeof e=="object"&&e!==null&&e.key!=null?cC(""+e.key):t.toString(36)}function Lf(e,t,r,n,s){var a=typeof e;(a==="undefined"||a==="boolean")&&(e=null);var i=!1;if(e===null)i=!0;else switch(a){case"string":case"number":i=!0;break;case"object":switch(e.$$typeof){case vu:case QI:i=!0}}if(i)return i=e,s=s(i),e=n===""?"."+h0(i,0):n,qx(s)?(r="",e!=null&&(r=e.replace(Xx,"$&/")+"/"),Lf(s,t,r,"",function(c){return c})):s!=null&&(Xp(s)&&(s=lC(s,r+(!s.key||i&&i.key===s.key?"":(""+s.key).replace(Xx,"$&/")+"/")+e)),t.push(s)),1;if(i=0,n=n===""?".":n+":",qx(e))for(var o=0;o<e.length;o++){a=e[o];var l=n+h0(a,o);i+=Lf(a,t,r,l,s)}else if(l=oC(e),typeof l=="function")for(e=l.call(e),o=0;!(a=e.next()).done;)a=a.value,l=n+h0(a,o++),i+=Lf(a,t,r,l,s);else if(a==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return i}function nf(e,t,r){if(e==null)return e;var n=[],s=0;return Lf(e,n,"","",function(a){return t.call(r,a,s++)}),n}function uC(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(r){(e._status===0||e._status===-1)&&(e._status=1,e._result=r)},function(r){(e._status===0||e._status===-1)&&(e._status=2,e._result=r)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var tn={current:null},jf={transition:null},fC={ReactCurrentDispatcher:tn,ReactCurrentBatchConfig:jf,ReactCurrentOwner:qp};function lE(){throw Error("act(...) is not supported in production builds of React.")}qe.Children={map:nf,forEach:function(e,t,r){nf(e,function(){t.apply(this,arguments)},r)},count:function(e){var t=0;return nf(e,function(){t++}),t},toArray:function(e){return nf(e,function(t){return t})||[]},only:function(e){if(!Xp(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};qe.Component=xl;qe.Fragment=JI;qe.Profiler=eC;qe.PureComponent=Gp;qe.StrictMode=ZI;qe.Suspense=sC;qe.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=fC;qe.act=lE;qe.cloneElement=function(e,t,r){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var n=rE({},e.props),s=e.key,a=e.ref,i=e._owner;if(t!=null){if(t.ref!==void 0&&(a=t.ref,i=qp.current),t.key!==void 0&&(s=""+t.key),e.type&&e.type.defaultProps)var o=e.type.defaultProps;for(l in t)aE.call(t,l)&&!iE.hasOwnProperty(l)&&(n[l]=t[l]===void 0&&o!==void 0?o[l]:t[l])}var l=arguments.length-2;if(l===1)n.children=r;else if(1<l){o=Array(l);for(var c=0;c<l;c++)o[c]=arguments[c+2];n.children=o}return{$$typeof:vu,type:e.type,key:s,ref:a,props:n,_owner:i}};qe.createContext=function(e){return e={$$typeof:rC,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:tC,_context:e},e.Consumer=e};qe.createElement=oE;qe.createFactory=function(e){var t=oE.bind(null,e);return t.type=e,t};qe.createRef=function(){return{current:null}};qe.forwardRef=function(e){return{$$typeof:nC,render:e}};qe.isValidElement=Xp;qe.lazy=function(e){return{$$typeof:iC,_payload:{_status:-1,_result:e},_init:uC}};qe.memo=function(e,t){return{$$typeof:aC,type:e,compare:t===void 0?null:t}};qe.startTransition=function(e){var t=jf.transition;jf.transition={};try{e()}finally{jf.transition=t}};qe.unstable_act=lE;qe.useCallback=function(e,t){return tn.current.useCallback(e,t)};qe.useContext=function(e){return tn.current.useContext(e)};qe.useDebugValue=function(){};qe.useDeferredValue=function(e){return tn.current.useDeferredValue(e)};qe.useEffect=function(e,t){return tn.current.useEffect(e,t)};qe.useId=function(){return tn.current.useId()};qe.useImperativeHandle=function(e,t,r){return tn.current.useImperativeHandle(e,t,r)};qe.useInsertionEffect=function(e,t){return tn.current.useInsertionEffect(e,t)};qe.useLayoutEffect=function(e,t){return tn.current.useLayoutEffect(e,t)};qe.useMemo=function(e,t){return tn.current.useMemo(e,t)};qe.useReducer=function(e,t,r){return tn.current.useReducer(e,t,r)};qe.useRef=function(e){return tn.current.useRef(e)};qe.useState=function(e){return tn.current.useState(e)};qe.useSyncExternalStore=function(e,t,r){return tn.current.useSyncExternalStore(e,t,r)};qe.useTransition=function(){return tn.current.useTransition()};qe.version="18.3.1";eE.exports=qe;var z=eE.exports;const fd=Jw(z),hC=Qw({__proto__:null,default:fd},[z]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var dC=z,mC=Symbol.for("react.element"),pC=Symbol.for("react.fragment"),gC=Object.prototype.hasOwnProperty,vC=dC.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,xC={key:!0,ref:!0,__self:!0,__source:!0};function cE(e,t,r){var n,s={},a=null,i=null;r!==void 0&&(a=""+r),t.key!==void 0&&(a=""+t.key),t.ref!==void 0&&(i=t.ref);for(n in t)gC.call(t,n)&&!xC.hasOwnProperty(n)&&(s[n]=t[n]);if(e&&e.defaultProps)for(n in t=e.defaultProps,t)s[n]===void 0&&(s[n]=t[n]);return{$$typeof:mC,type:e,key:a,ref:i,props:s,_owner:vC.current}}ud.Fragment=pC;ud.jsx=cE;ud.jsxs=cE;Zw.exports=ud;var h=Zw.exports,cm={},uE={exports:{}},In={},fE={exports:{}},hE={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(ee,H){var se=ee.length;ee.push(H);e:for(;0<se;){var ce=se-1>>>1,B=ee[ce];if(0<s(B,H))ee[ce]=H,ee[se]=B,se=ce;else break e}}function r(ee){return ee.length===0?null:ee[0]}function n(ee){if(ee.length===0)return null;var H=ee[0],se=ee.pop();if(se!==H){ee[0]=se;e:for(var ce=0,B=ee.length,K=B>>>1;ce<K;){var X=2*(ce+1)-1,G=ee[X],ie=X+1,ge=ee[ie];if(0>s(G,se))ie<B&&0>s(ge,G)?(ee[ce]=ge,ee[ie]=se,ce=ie):(ee[ce]=G,ee[X]=se,ce=X);else if(ie<B&&0>s(ge,se))ee[ce]=ge,ee[ie]=se,ce=ie;else break e}}return H}function s(ee,H){var se=ee.sortIndex-H.sortIndex;return se!==0?se:ee.id-H.id}if(typeof performance=="object"&&typeof performance.now=="function"){var a=performance;e.unstable_now=function(){return a.now()}}else{var i=Date,o=i.now();e.unstable_now=function(){return i.now()-o}}var l=[],c=[],u=1,d=null,m=3,p=!1,g=!1,x=!1,w=typeof setTimeout=="function"?setTimeout:null,k=typeof clearTimeout=="function"?clearTimeout:null,T=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function E(ee){for(var H=r(c);H!==null;){if(H.callback===null)n(c);else if(H.startTime<=ee)n(c),H.sortIndex=H.expirationTime,t(l,H);else break;H=r(c)}}function N(ee){if(x=!1,E(ee),!g)if(r(l)!==null)g=!0,he(M);else{var H=r(c);H!==null&&pe(N,H.startTime-ee)}}function M(ee,H){g=!1,x&&(x=!1,k(_),_=-1),p=!0;var se=m;try{for(E(H),d=r(l);d!==null&&(!(d.expirationTime>H)||ee&&!b());){var ce=d.callback;if(typeof ce=="function"){d.callback=null,m=d.priorityLevel;var B=ce(d.expirationTime<=H);H=e.unstable_now(),typeof B=="function"?d.callback=B:d===r(l)&&n(l),E(H)}else n(l);d=r(l)}if(d!==null)var K=!0;else{var X=r(c);X!==null&&pe(N,X.startTime-H),K=!1}return K}finally{d=null,m=se,p=!1}}var O=!1,v=null,_=-1,S=5,I=-1;function b(){return!(e.unstable_now()-I<S)}function P(){if(v!==null){var ee=e.unstable_now();I=ee;var H=!0;try{H=v(!0,ee)}finally{H?R():(O=!1,v=null)}}else O=!1}var R;if(typeof T=="function")R=function(){T(P)};else if(typeof MessageChannel<"u"){var ue=new MessageChannel,le=ue.port2;ue.port1.onmessage=P,R=function(){le.postMessage(null)}}else R=function(){w(P,0)};function he(ee){v=ee,O||(O=!0,R())}function pe(ee,H){_=w(function(){ee(e.unstable_now())},H)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(ee){ee.callback=null},e.unstable_continueExecution=function(){g||p||(g=!0,he(M))},e.unstable_forceFrameRate=function(ee){0>ee||125<ee?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):S=0<ee?Math.floor(1e3/ee):5},e.unstable_getCurrentPriorityLevel=function(){return m},e.unstable_getFirstCallbackNode=function(){return r(l)},e.unstable_next=function(ee){switch(m){case 1:case 2:case 3:var H=3;break;default:H=m}var se=m;m=H;try{return ee()}finally{m=se}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(ee,H){switch(ee){case 1:case 2:case 3:case 4:case 5:break;default:ee=3}var se=m;m=ee;try{return H()}finally{m=se}},e.unstable_scheduleCallback=function(ee,H,se){var ce=e.unstable_now();switch(typeof se=="object"&&se!==null?(se=se.delay,se=typeof se=="number"&&0<se?ce+se:ce):se=ce,ee){case 1:var B=-1;break;case 2:B=250;break;case 5:B=1073741823;break;case 4:B=1e4;break;default:B=5e3}return B=se+B,ee={id:u++,callback:H,priorityLevel:ee,startTime:se,expirationTime:B,sortIndex:-1},se>ce?(ee.sortIndex=se,t(c,ee),r(l)===null&&ee===r(c)&&(x?(k(_),_=-1):x=!0,pe(N,se-ce))):(ee.sortIndex=B,t(l,ee),g||p||(g=!0,he(M))),ee},e.unstable_shouldYield=b,e.unstable_wrapCallback=function(ee){var H=m;return function(){var se=m;m=H;try{return ee.apply(this,arguments)}finally{m=se}}}})(hE);fE.exports=hE;var yC=fE.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var _C=z,Sn=yC;function _e(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,r=1;r<arguments.length;r++)t+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var dE=new Set,Dc={};function eo(e,t){Zo(e,t),Zo(e+"Capture",t)}function Zo(e,t){for(Dc[e]=t,e=0;e<t.length;e++)dE.add(t[e])}var aa=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),um=Object.prototype.hasOwnProperty,wC=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Yx={},Qx={};function EC(e){return um.call(Qx,e)?!0:um.call(Yx,e)?!1:wC.test(e)?Qx[e]=!0:(Yx[e]=!0,!1)}function TC(e,t,r,n){if(r!==null&&r.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return n?!1:r!==null?!r.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function kC(e,t,r,n){if(t===null||typeof t>"u"||TC(e,t,r,n))return!0;if(n)return!1;if(r!==null)switch(r.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function rn(e,t,r,n,s,a,i){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=n,this.attributeNamespace=s,this.mustUseProperty=r,this.propertyName=e,this.type=t,this.sanitizeURL=a,this.removeEmptyString=i}var Ir={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){Ir[e]=new rn(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];Ir[t]=new rn(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){Ir[e]=new rn(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){Ir[e]=new rn(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){Ir[e]=new rn(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){Ir[e]=new rn(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){Ir[e]=new rn(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){Ir[e]=new rn(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){Ir[e]=new rn(e,5,!1,e.toLowerCase(),null,!1,!1)});var Yp=/[\-:]([a-z])/g;function Qp(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(Yp,Qp);Ir[t]=new rn(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(Yp,Qp);Ir[t]=new rn(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(Yp,Qp);Ir[t]=new rn(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){Ir[e]=new rn(e,1,!1,e.toLowerCase(),null,!1,!1)});Ir.xlinkHref=new rn("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){Ir[e]=new rn(e,1,!1,e.toLowerCase(),null,!0,!0)});function Jp(e,t,r,n){var s=Ir.hasOwnProperty(t)?Ir[t]:null;(s!==null?s.type!==0:n||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(kC(t,r,s,n)&&(r=null),n||s===null?EC(t)&&(r===null?e.removeAttribute(t):e.setAttribute(t,""+r)):s.mustUseProperty?e[s.propertyName]=r===null?s.type===3?!1:"":r:(t=s.attributeName,n=s.attributeNamespace,r===null?e.removeAttribute(t):(s=s.type,r=s===3||s===4&&r===!0?"":""+r,n?e.setAttributeNS(n,t,r):e.setAttribute(t,r))))}var va=_C.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,sf=Symbol.for("react.element"),Ao=Symbol.for("react.portal"),Io=Symbol.for("react.fragment"),Zp=Symbol.for("react.strict_mode"),fm=Symbol.for("react.profiler"),mE=Symbol.for("react.provider"),pE=Symbol.for("react.context"),eg=Symbol.for("react.forward_ref"),hm=Symbol.for("react.suspense"),dm=Symbol.for("react.suspense_list"),tg=Symbol.for("react.memo"),Na=Symbol.for("react.lazy"),gE=Symbol.for("react.offscreen"),Jx=Symbol.iterator;function jl(e){return e===null||typeof e!="object"?null:(e=Jx&&e[Jx]||e["@@iterator"],typeof e=="function"?e:null)}var Mt=Object.assign,d0;function Yl(e){if(d0===void 0)try{throw Error()}catch(r){var t=r.stack.trim().match(/\n( *(at )?)/);d0=t&&t[1]||""}return`
`+d0+e}var m0=!1;function p0(e,t){if(!e||m0)return"";m0=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(c){var n=c}Reflect.construct(e,[],t)}else{try{t.call()}catch(c){n=c}e.call(t.prototype)}else{try{throw Error()}catch(c){n=c}e()}}catch(c){if(c&&n&&typeof c.stack=="string"){for(var s=c.stack.split(`
`),a=n.stack.split(`
`),i=s.length-1,o=a.length-1;1<=i&&0<=o&&s[i]!==a[o];)o--;for(;1<=i&&0<=o;i--,o--)if(s[i]!==a[o]){if(i!==1||o!==1)do if(i--,o--,0>o||s[i]!==a[o]){var l=`
`+s[i].replace(" at new "," at ");return e.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",e.displayName)),l}while(1<=i&&0<=o);break}}}finally{m0=!1,Error.prepareStackTrace=r}return(e=e?e.displayName||e.name:"")?Yl(e):""}function SC(e){switch(e.tag){case 5:return Yl(e.type);case 16:return Yl("Lazy");case 13:return Yl("Suspense");case 19:return Yl("SuspenseList");case 0:case 2:case 15:return e=p0(e.type,!1),e;case 11:return e=p0(e.type.render,!1),e;case 1:return e=p0(e.type,!0),e;default:return""}}function mm(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case Io:return"Fragment";case Ao:return"Portal";case fm:return"Profiler";case Zp:return"StrictMode";case hm:return"Suspense";case dm:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case pE:return(e.displayName||"Context")+".Consumer";case mE:return(e._context.displayName||"Context")+".Provider";case eg:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case tg:return t=e.displayName||null,t!==null?t:mm(e.type)||"Memo";case Na:t=e._payload,e=e._init;try{return mm(e(t))}catch{}}return null}function AC(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return mm(t);case 8:return t===Zp?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function ni(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function vE(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function IC(e){var t=vE(e)?"checked":"value",r=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),n=""+e[t];if(!e.hasOwnProperty(t)&&typeof r<"u"&&typeof r.get=="function"&&typeof r.set=="function"){var s=r.get,a=r.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return s.call(this)},set:function(i){n=""+i,a.call(this,i)}}),Object.defineProperty(e,t,{enumerable:r.enumerable}),{getValue:function(){return n},setValue:function(i){n=""+i},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function af(e){e._valueTracker||(e._valueTracker=IC(e))}function xE(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var r=t.getValue(),n="";return e&&(n=vE(e)?e.checked?"true":"false":e.value),e=n,e!==r?(t.setValue(e),!0):!1}function ih(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function pm(e,t){var r=t.checked;return Mt({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:r??e._wrapperState.initialChecked})}function Zx(e,t){var r=t.defaultValue==null?"":t.defaultValue,n=t.checked!=null?t.checked:t.defaultChecked;r=ni(t.value!=null?t.value:r),e._wrapperState={initialChecked:n,initialValue:r,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function yE(e,t){t=t.checked,t!=null&&Jp(e,"checked",t,!1)}function gm(e,t){yE(e,t);var r=ni(t.value),n=t.type;if(r!=null)n==="number"?(r===0&&e.value===""||e.value!=r)&&(e.value=""+r):e.value!==""+r&&(e.value=""+r);else if(n==="submit"||n==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?vm(e,t.type,r):t.hasOwnProperty("defaultValue")&&vm(e,t.type,ni(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function e1(e,t,r){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var n=t.type;if(!(n!=="submit"&&n!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,r||t===e.value||(e.value=t),e.defaultValue=t}r=e.name,r!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,r!==""&&(e.name=r)}function vm(e,t,r){(t!=="number"||ih(e.ownerDocument)!==e)&&(r==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+r&&(e.defaultValue=""+r))}var Ql=Array.isArray;function Vo(e,t,r,n){if(e=e.options,t){t={};for(var s=0;s<r.length;s++)t["$"+r[s]]=!0;for(r=0;r<e.length;r++)s=t.hasOwnProperty("$"+e[r].value),e[r].selected!==s&&(e[r].selected=s),s&&n&&(e[r].defaultSelected=!0)}else{for(r=""+ni(r),t=null,s=0;s<e.length;s++){if(e[s].value===r){e[s].selected=!0,n&&(e[s].defaultSelected=!0);return}t!==null||e[s].disabled||(t=e[s])}t!==null&&(t.selected=!0)}}function xm(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(_e(91));return Mt({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function t1(e,t){var r=t.value;if(r==null){if(r=t.children,t=t.defaultValue,r!=null){if(t!=null)throw Error(_e(92));if(Ql(r)){if(1<r.length)throw Error(_e(93));r=r[0]}t=r}t==null&&(t=""),r=t}e._wrapperState={initialValue:ni(r)}}function _E(e,t){var r=ni(t.value),n=ni(t.defaultValue);r!=null&&(r=""+r,r!==e.value&&(e.value=r),t.defaultValue==null&&e.defaultValue!==r&&(e.defaultValue=r)),n!=null&&(e.defaultValue=""+n)}function r1(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function wE(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function ym(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?wE(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var of,EE=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,r,n,s){MSApp.execUnsafeLocalFunction(function(){return e(t,r,n,s)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(of=of||document.createElement("div"),of.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=of.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function Fc(e,t){if(t){var r=e.firstChild;if(r&&r===e.lastChild&&r.nodeType===3){r.nodeValue=t;return}}e.textContent=t}var cc={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},CC=["Webkit","ms","Moz","O"];Object.keys(cc).forEach(function(e){CC.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),cc[t]=cc[e]})});function TE(e,t,r){return t==null||typeof t=="boolean"||t===""?"":r||typeof t!="number"||t===0||cc.hasOwnProperty(e)&&cc[e]?(""+t).trim():t+"px"}function kE(e,t){e=e.style;for(var r in t)if(t.hasOwnProperty(r)){var n=r.indexOf("--")===0,s=TE(r,t[r],n);r==="float"&&(r="cssFloat"),n?e.setProperty(r,s):e[r]=s}}var NC=Mt({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function _m(e,t){if(t){if(NC[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(_e(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(_e(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(_e(61))}if(t.style!=null&&typeof t.style!="object")throw Error(_e(62))}}function wm(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Em=null;function rg(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var Tm=null,Uo=null,Bo=null;function n1(e){if(e=_u(e)){if(typeof Tm!="function")throw Error(_e(280));var t=e.stateNode;t&&(t=gd(t),Tm(e.stateNode,e.type,t))}}function SE(e){Uo?Bo?Bo.push(e):Bo=[e]:Uo=e}function AE(){if(Uo){var e=Uo,t=Bo;if(Bo=Uo=null,n1(e),t)for(e=0;e<t.length;e++)n1(t[e])}}function IE(e,t){return e(t)}function CE(){}var g0=!1;function NE(e,t,r){if(g0)return e(t,r);g0=!0;try{return IE(e,t,r)}finally{g0=!1,(Uo!==null||Bo!==null)&&(CE(),AE())}}function Oc(e,t){var r=e.stateNode;if(r===null)return null;var n=gd(r);if(n===null)return null;r=n[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(e=e.type,n=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!n;break e;default:e=!1}if(e)return null;if(r&&typeof r!="function")throw Error(_e(231,t,typeof r));return r}var km=!1;if(aa)try{var Vl={};Object.defineProperty(Vl,"passive",{get:function(){km=!0}}),window.addEventListener("test",Vl,Vl),window.removeEventListener("test",Vl,Vl)}catch{km=!1}function RC(e,t,r,n,s,a,i,o,l){var c=Array.prototype.slice.call(arguments,3);try{t.apply(r,c)}catch(u){this.onError(u)}}var uc=!1,oh=null,lh=!1,Sm=null,bC={onError:function(e){uc=!0,oh=e}};function PC(e,t,r,n,s,a,i,o,l){uc=!1,oh=null,RC.apply(bC,arguments)}function DC(e,t,r,n,s,a,i,o,l){if(PC.apply(this,arguments),uc){if(uc){var c=oh;uc=!1,oh=null}else throw Error(_e(198));lh||(lh=!0,Sm=c)}}function to(e){var t=e,r=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(r=t.return),e=t.return;while(e)}return t.tag===3?r:null}function RE(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function s1(e){if(to(e)!==e)throw Error(_e(188))}function FC(e){var t=e.alternate;if(!t){if(t=to(e),t===null)throw Error(_e(188));return t!==e?null:e}for(var r=e,n=t;;){var s=r.return;if(s===null)break;var a=s.alternate;if(a===null){if(n=s.return,n!==null){r=n;continue}break}if(s.child===a.child){for(a=s.child;a;){if(a===r)return s1(s),e;if(a===n)return s1(s),t;a=a.sibling}throw Error(_e(188))}if(r.return!==n.return)r=s,n=a;else{for(var i=!1,o=s.child;o;){if(o===r){i=!0,r=s,n=a;break}if(o===n){i=!0,n=s,r=a;break}o=o.sibling}if(!i){for(o=a.child;o;){if(o===r){i=!0,r=a,n=s;break}if(o===n){i=!0,n=a,r=s;break}o=o.sibling}if(!i)throw Error(_e(189))}}if(r.alternate!==n)throw Error(_e(190))}if(r.tag!==3)throw Error(_e(188));return r.stateNode.current===r?e:t}function bE(e){return e=FC(e),e!==null?PE(e):null}function PE(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=PE(e);if(t!==null)return t;e=e.sibling}return null}var DE=Sn.unstable_scheduleCallback,a1=Sn.unstable_cancelCallback,OC=Sn.unstable_shouldYield,MC=Sn.unstable_requestPaint,Wt=Sn.unstable_now,LC=Sn.unstable_getCurrentPriorityLevel,ng=Sn.unstable_ImmediatePriority,FE=Sn.unstable_UserBlockingPriority,ch=Sn.unstable_NormalPriority,jC=Sn.unstable_LowPriority,OE=Sn.unstable_IdlePriority,hd=null,Es=null;function VC(e){if(Es&&typeof Es.onCommitFiberRoot=="function")try{Es.onCommitFiberRoot(hd,e,void 0,(e.current.flags&128)===128)}catch{}}var is=Math.clz32?Math.clz32:zC,UC=Math.log,BC=Math.LN2;function zC(e){return e>>>=0,e===0?32:31-(UC(e)/BC|0)|0}var lf=64,cf=4194304;function Jl(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function uh(e,t){var r=e.pendingLanes;if(r===0)return 0;var n=0,s=e.suspendedLanes,a=e.pingedLanes,i=r&268435455;if(i!==0){var o=i&~s;o!==0?n=Jl(o):(a&=i,a!==0&&(n=Jl(a)))}else i=r&~s,i!==0?n=Jl(i):a!==0&&(n=Jl(a));if(n===0)return 0;if(t!==0&&t!==n&&!(t&s)&&(s=n&-n,a=t&-t,s>=a||s===16&&(a&4194240)!==0))return t;if(n&4&&(n|=r&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=n;0<t;)r=31-is(t),s=1<<r,n|=e[r],t&=~s;return n}function $C(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function WC(e,t){for(var r=e.suspendedLanes,n=e.pingedLanes,s=e.expirationTimes,a=e.pendingLanes;0<a;){var i=31-is(a),o=1<<i,l=s[i];l===-1?(!(o&r)||o&n)&&(s[i]=$C(o,t)):l<=t&&(e.expiredLanes|=o),a&=~o}}function Am(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function ME(){var e=lf;return lf<<=1,!(lf&4194240)&&(lf=64),e}function v0(e){for(var t=[],r=0;31>r;r++)t.push(e);return t}function xu(e,t,r){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-is(t),e[t]=r}function HC(e,t){var r=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var n=e.eventTimes;for(e=e.expirationTimes;0<r;){var s=31-is(r),a=1<<s;t[s]=0,n[s]=-1,e[s]=-1,r&=~a}}function sg(e,t){var r=e.entangledLanes|=t;for(e=e.entanglements;r;){var n=31-is(r),s=1<<n;s&t|e[n]&t&&(e[n]|=t),r&=~s}}var gt=0;function LE(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var jE,ag,VE,UE,BE,Im=!1,uf=[],$a=null,Wa=null,Ha=null,Mc=new Map,Lc=new Map,ba=[],GC="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function i1(e,t){switch(e){case"focusin":case"focusout":$a=null;break;case"dragenter":case"dragleave":Wa=null;break;case"mouseover":case"mouseout":Ha=null;break;case"pointerover":case"pointerout":Mc.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Lc.delete(t.pointerId)}}function Ul(e,t,r,n,s,a){return e===null||e.nativeEvent!==a?(e={blockedOn:t,domEventName:r,eventSystemFlags:n,nativeEvent:a,targetContainers:[s]},t!==null&&(t=_u(t),t!==null&&ag(t)),e):(e.eventSystemFlags|=n,t=e.targetContainers,s!==null&&t.indexOf(s)===-1&&t.push(s),e)}function KC(e,t,r,n,s){switch(t){case"focusin":return $a=Ul($a,e,t,r,n,s),!0;case"dragenter":return Wa=Ul(Wa,e,t,r,n,s),!0;case"mouseover":return Ha=Ul(Ha,e,t,r,n,s),!0;case"pointerover":var a=s.pointerId;return Mc.set(a,Ul(Mc.get(a)||null,e,t,r,n,s)),!0;case"gotpointercapture":return a=s.pointerId,Lc.set(a,Ul(Lc.get(a)||null,e,t,r,n,s)),!0}return!1}function zE(e){var t=Ii(e.target);if(t!==null){var r=to(t);if(r!==null){if(t=r.tag,t===13){if(t=RE(r),t!==null){e.blockedOn=t,BE(e.priority,function(){VE(r)});return}}else if(t===3&&r.stateNode.current.memoizedState.isDehydrated){e.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}e.blockedOn=null}function Vf(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var r=Cm(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(r===null){r=e.nativeEvent;var n=new r.constructor(r.type,r);Em=n,r.target.dispatchEvent(n),Em=null}else return t=_u(r),t!==null&&ag(t),e.blockedOn=r,!1;t.shift()}return!0}function o1(e,t,r){Vf(e)&&r.delete(t)}function qC(){Im=!1,$a!==null&&Vf($a)&&($a=null),Wa!==null&&Vf(Wa)&&(Wa=null),Ha!==null&&Vf(Ha)&&(Ha=null),Mc.forEach(o1),Lc.forEach(o1)}function Bl(e,t){e.blockedOn===t&&(e.blockedOn=null,Im||(Im=!0,Sn.unstable_scheduleCallback(Sn.unstable_NormalPriority,qC)))}function jc(e){function t(s){return Bl(s,e)}if(0<uf.length){Bl(uf[0],e);for(var r=1;r<uf.length;r++){var n=uf[r];n.blockedOn===e&&(n.blockedOn=null)}}for($a!==null&&Bl($a,e),Wa!==null&&Bl(Wa,e),Ha!==null&&Bl(Ha,e),Mc.forEach(t),Lc.forEach(t),r=0;r<ba.length;r++)n=ba[r],n.blockedOn===e&&(n.blockedOn=null);for(;0<ba.length&&(r=ba[0],r.blockedOn===null);)zE(r),r.blockedOn===null&&ba.shift()}var zo=va.ReactCurrentBatchConfig,fh=!0;function XC(e,t,r,n){var s=gt,a=zo.transition;zo.transition=null;try{gt=1,ig(e,t,r,n)}finally{gt=s,zo.transition=a}}function YC(e,t,r,n){var s=gt,a=zo.transition;zo.transition=null;try{gt=4,ig(e,t,r,n)}finally{gt=s,zo.transition=a}}function ig(e,t,r,n){if(fh){var s=Cm(e,t,r,n);if(s===null)I0(e,t,n,hh,r),i1(e,n);else if(KC(s,e,t,r,n))n.stopPropagation();else if(i1(e,n),t&4&&-1<GC.indexOf(e)){for(;s!==null;){var a=_u(s);if(a!==null&&jE(a),a=Cm(e,t,r,n),a===null&&I0(e,t,n,hh,r),a===s)break;s=a}s!==null&&n.stopPropagation()}else I0(e,t,n,null,r)}}var hh=null;function Cm(e,t,r,n){if(hh=null,e=rg(n),e=Ii(e),e!==null)if(t=to(e),t===null)e=null;else if(r=t.tag,r===13){if(e=RE(t),e!==null)return e;e=null}else if(r===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return hh=e,null}function $E(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(LC()){case ng:return 1;case FE:return 4;case ch:case jC:return 16;case OE:return 536870912;default:return 16}default:return 16}}var La=null,og=null,Uf=null;function WE(){if(Uf)return Uf;var e,t=og,r=t.length,n,s="value"in La?La.value:La.textContent,a=s.length;for(e=0;e<r&&t[e]===s[e];e++);var i=r-e;for(n=1;n<=i&&t[r-n]===s[a-n];n++);return Uf=s.slice(e,1<n?1-n:void 0)}function Bf(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function ff(){return!0}function l1(){return!1}function Cn(e){function t(r,n,s,a,i){this._reactName=r,this._targetInst=s,this.type=n,this.nativeEvent=a,this.target=i,this.currentTarget=null;for(var o in e)e.hasOwnProperty(o)&&(r=e[o],this[o]=r?r(a):a[o]);return this.isDefaultPrevented=(a.defaultPrevented!=null?a.defaultPrevented:a.returnValue===!1)?ff:l1,this.isPropagationStopped=l1,this}return Mt(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=ff)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=ff)},persist:function(){},isPersistent:ff}),t}var yl={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},lg=Cn(yl),yu=Mt({},yl,{view:0,detail:0}),QC=Cn(yu),x0,y0,zl,dd=Mt({},yu,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:cg,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==zl&&(zl&&e.type==="mousemove"?(x0=e.screenX-zl.screenX,y0=e.screenY-zl.screenY):y0=x0=0,zl=e),x0)},movementY:function(e){return"movementY"in e?e.movementY:y0}}),c1=Cn(dd),JC=Mt({},dd,{dataTransfer:0}),ZC=Cn(JC),e4=Mt({},yu,{relatedTarget:0}),_0=Cn(e4),t4=Mt({},yl,{animationName:0,elapsedTime:0,pseudoElement:0}),r4=Cn(t4),n4=Mt({},yl,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),s4=Cn(n4),a4=Mt({},yl,{data:0}),u1=Cn(a4),i4={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},o4={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},l4={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function c4(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=l4[e])?!!t[e]:!1}function cg(){return c4}var u4=Mt({},yu,{key:function(e){if(e.key){var t=i4[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=Bf(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?o4[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:cg,charCode:function(e){return e.type==="keypress"?Bf(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?Bf(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),f4=Cn(u4),h4=Mt({},dd,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),f1=Cn(h4),d4=Mt({},yu,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:cg}),m4=Cn(d4),p4=Mt({},yl,{propertyName:0,elapsedTime:0,pseudoElement:0}),g4=Cn(p4),v4=Mt({},dd,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),x4=Cn(v4),y4=[9,13,27,32],ug=aa&&"CompositionEvent"in window,fc=null;aa&&"documentMode"in document&&(fc=document.documentMode);var _4=aa&&"TextEvent"in window&&!fc,HE=aa&&(!ug||fc&&8<fc&&11>=fc),h1=" ",d1=!1;function GE(e,t){switch(e){case"keyup":return y4.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function KE(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var Co=!1;function w4(e,t){switch(e){case"compositionend":return KE(t);case"keypress":return t.which!==32?null:(d1=!0,h1);case"textInput":return e=t.data,e===h1&&d1?null:e;default:return null}}function E4(e,t){if(Co)return e==="compositionend"||!ug&&GE(e,t)?(e=WE(),Uf=og=La=null,Co=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return HE&&t.locale!=="ko"?null:t.data;default:return null}}var T4={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function m1(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!T4[e.type]:t==="textarea"}function qE(e,t,r,n){SE(n),t=dh(t,"onChange"),0<t.length&&(r=new lg("onChange","change",null,r,n),e.push({event:r,listeners:t}))}var hc=null,Vc=null;function k4(e){a2(e,0)}function md(e){var t=bo(e);if(xE(t))return e}function S4(e,t){if(e==="change")return t}var XE=!1;if(aa){var w0;if(aa){var E0="oninput"in document;if(!E0){var p1=document.createElement("div");p1.setAttribute("oninput","return;"),E0=typeof p1.oninput=="function"}w0=E0}else w0=!1;XE=w0&&(!document.documentMode||9<document.documentMode)}function g1(){hc&&(hc.detachEvent("onpropertychange",YE),Vc=hc=null)}function YE(e){if(e.propertyName==="value"&&md(Vc)){var t=[];qE(t,Vc,e,rg(e)),NE(k4,t)}}function A4(e,t,r){e==="focusin"?(g1(),hc=t,Vc=r,hc.attachEvent("onpropertychange",YE)):e==="focusout"&&g1()}function I4(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return md(Vc)}function C4(e,t){if(e==="click")return md(t)}function N4(e,t){if(e==="input"||e==="change")return md(t)}function R4(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var us=typeof Object.is=="function"?Object.is:R4;function Uc(e,t){if(us(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var r=Object.keys(e),n=Object.keys(t);if(r.length!==n.length)return!1;for(n=0;n<r.length;n++){var s=r[n];if(!um.call(t,s)||!us(e[s],t[s]))return!1}return!0}function v1(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function x1(e,t){var r=v1(e);e=0;for(var n;r;){if(r.nodeType===3){if(n=e+r.textContent.length,e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=v1(r)}}function QE(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?QE(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function JE(){for(var e=window,t=ih();t instanceof e.HTMLIFrameElement;){try{var r=typeof t.contentWindow.location.href=="string"}catch{r=!1}if(r)e=t.contentWindow;else break;t=ih(e.document)}return t}function fg(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function b4(e){var t=JE(),r=e.focusedElem,n=e.selectionRange;if(t!==r&&r&&r.ownerDocument&&QE(r.ownerDocument.documentElement,r)){if(n!==null&&fg(r)){if(t=n.start,e=n.end,e===void 0&&(e=t),"selectionStart"in r)r.selectionStart=t,r.selectionEnd=Math.min(e,r.value.length);else if(e=(t=r.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var s=r.textContent.length,a=Math.min(n.start,s);n=n.end===void 0?a:Math.min(n.end,s),!e.extend&&a>n&&(s=n,n=a,a=s),s=x1(r,a);var i=x1(r,n);s&&i&&(e.rangeCount!==1||e.anchorNode!==s.node||e.anchorOffset!==s.offset||e.focusNode!==i.node||e.focusOffset!==i.offset)&&(t=t.createRange(),t.setStart(s.node,s.offset),e.removeAllRanges(),a>n?(e.addRange(t),e.extend(i.node,i.offset)):(t.setEnd(i.node,i.offset),e.addRange(t)))}}for(t=[],e=r;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof r.focus=="function"&&r.focus(),r=0;r<t.length;r++)e=t[r],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var P4=aa&&"documentMode"in document&&11>=document.documentMode,No=null,Nm=null,dc=null,Rm=!1;function y1(e,t,r){var n=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;Rm||No==null||No!==ih(n)||(n=No,"selectionStart"in n&&fg(n)?n={start:n.selectionStart,end:n.selectionEnd}:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection(),n={anchorNode:n.anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset}),dc&&Uc(dc,n)||(dc=n,n=dh(Nm,"onSelect"),0<n.length&&(t=new lg("onSelect","select",null,t,r),e.push({event:t,listeners:n}),t.target=No)))}function hf(e,t){var r={};return r[e.toLowerCase()]=t.toLowerCase(),r["Webkit"+e]="webkit"+t,r["Moz"+e]="moz"+t,r}var Ro={animationend:hf("Animation","AnimationEnd"),animationiteration:hf("Animation","AnimationIteration"),animationstart:hf("Animation","AnimationStart"),transitionend:hf("Transition","TransitionEnd")},T0={},ZE={};aa&&(ZE=document.createElement("div").style,"AnimationEvent"in window||(delete Ro.animationend.animation,delete Ro.animationiteration.animation,delete Ro.animationstart.animation),"TransitionEvent"in window||delete Ro.transitionend.transition);function pd(e){if(T0[e])return T0[e];if(!Ro[e])return e;var t=Ro[e],r;for(r in t)if(t.hasOwnProperty(r)&&r in ZE)return T0[e]=t[r];return e}var e2=pd("animationend"),t2=pd("animationiteration"),r2=pd("animationstart"),n2=pd("transitionend"),s2=new Map,_1="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function hi(e,t){s2.set(e,t),eo(t,[e])}for(var k0=0;k0<_1.length;k0++){var S0=_1[k0],D4=S0.toLowerCase(),F4=S0[0].toUpperCase()+S0.slice(1);hi(D4,"on"+F4)}hi(e2,"onAnimationEnd");hi(t2,"onAnimationIteration");hi(r2,"onAnimationStart");hi("dblclick","onDoubleClick");hi("focusin","onFocus");hi("focusout","onBlur");hi(n2,"onTransitionEnd");Zo("onMouseEnter",["mouseout","mouseover"]);Zo("onMouseLeave",["mouseout","mouseover"]);Zo("onPointerEnter",["pointerout","pointerover"]);Zo("onPointerLeave",["pointerout","pointerover"]);eo("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));eo("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));eo("onBeforeInput",["compositionend","keypress","textInput","paste"]);eo("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));eo("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));eo("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Zl="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),O4=new Set("cancel close invalid load scroll toggle".split(" ").concat(Zl));function w1(e,t,r){var n=e.type||"unknown-event";e.currentTarget=r,DC(n,t,void 0,e),e.currentTarget=null}function a2(e,t){t=(t&4)!==0;for(var r=0;r<e.length;r++){var n=e[r],s=n.event;n=n.listeners;e:{var a=void 0;if(t)for(var i=n.length-1;0<=i;i--){var o=n[i],l=o.instance,c=o.currentTarget;if(o=o.listener,l!==a&&s.isPropagationStopped())break e;w1(s,o,c),a=l}else for(i=0;i<n.length;i++){if(o=n[i],l=o.instance,c=o.currentTarget,o=o.listener,l!==a&&s.isPropagationStopped())break e;w1(s,o,c),a=l}}}if(lh)throw e=Sm,lh=!1,Sm=null,e}function It(e,t){var r=t[Om];r===void 0&&(r=t[Om]=new Set);var n=e+"__bubble";r.has(n)||(i2(t,e,2,!1),r.add(n))}function A0(e,t,r){var n=0;t&&(n|=4),i2(r,e,n,t)}var df="_reactListening"+Math.random().toString(36).slice(2);function Bc(e){if(!e[df]){e[df]=!0,dE.forEach(function(r){r!=="selectionchange"&&(O4.has(r)||A0(r,!1,e),A0(r,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[df]||(t[df]=!0,A0("selectionchange",!1,t))}}function i2(e,t,r,n){switch($E(t)){case 1:var s=XC;break;case 4:s=YC;break;default:s=ig}r=s.bind(null,t,r,e),s=void 0,!km||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(s=!0),n?s!==void 0?e.addEventListener(t,r,{capture:!0,passive:s}):e.addEventListener(t,r,!0):s!==void 0?e.addEventListener(t,r,{passive:s}):e.addEventListener(t,r,!1)}function I0(e,t,r,n,s){var a=n;if(!(t&1)&&!(t&2)&&n!==null)e:for(;;){if(n===null)return;var i=n.tag;if(i===3||i===4){var o=n.stateNode.containerInfo;if(o===s||o.nodeType===8&&o.parentNode===s)break;if(i===4)for(i=n.return;i!==null;){var l=i.tag;if((l===3||l===4)&&(l=i.stateNode.containerInfo,l===s||l.nodeType===8&&l.parentNode===s))return;i=i.return}for(;o!==null;){if(i=Ii(o),i===null)return;if(l=i.tag,l===5||l===6){n=a=i;continue e}o=o.parentNode}}n=n.return}NE(function(){var c=a,u=rg(r),d=[];e:{var m=s2.get(e);if(m!==void 0){var p=lg,g=e;switch(e){case"keypress":if(Bf(r)===0)break e;case"keydown":case"keyup":p=f4;break;case"focusin":g="focus",p=_0;break;case"focusout":g="blur",p=_0;break;case"beforeblur":case"afterblur":p=_0;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":p=c1;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":p=ZC;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":p=m4;break;case e2:case t2:case r2:p=r4;break;case n2:p=g4;break;case"scroll":p=QC;break;case"wheel":p=x4;break;case"copy":case"cut":case"paste":p=s4;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":p=f1}var x=(t&4)!==0,w=!x&&e==="scroll",k=x?m!==null?m+"Capture":null:m;x=[];for(var T=c,E;T!==null;){E=T;var N=E.stateNode;if(E.tag===5&&N!==null&&(E=N,k!==null&&(N=Oc(T,k),N!=null&&x.push(zc(T,N,E)))),w)break;T=T.return}0<x.length&&(m=new p(m,g,null,r,u),d.push({event:m,listeners:x}))}}if(!(t&7)){e:{if(m=e==="mouseover"||e==="pointerover",p=e==="mouseout"||e==="pointerout",m&&r!==Em&&(g=r.relatedTarget||r.fromElement)&&(Ii(g)||g[ia]))break e;if((p||m)&&(m=u.window===u?u:(m=u.ownerDocument)?m.defaultView||m.parentWindow:window,p?(g=r.relatedTarget||r.toElement,p=c,g=g?Ii(g):null,g!==null&&(w=to(g),g!==w||g.tag!==5&&g.tag!==6)&&(g=null)):(p=null,g=c),p!==g)){if(x=c1,N="onMouseLeave",k="onMouseEnter",T="mouse",(e==="pointerout"||e==="pointerover")&&(x=f1,N="onPointerLeave",k="onPointerEnter",T="pointer"),w=p==null?m:bo(p),E=g==null?m:bo(g),m=new x(N,T+"leave",p,r,u),m.target=w,m.relatedTarget=E,N=null,Ii(u)===c&&(x=new x(k,T+"enter",g,r,u),x.target=E,x.relatedTarget=w,N=x),w=N,p&&g)t:{for(x=p,k=g,T=0,E=x;E;E=yo(E))T++;for(E=0,N=k;N;N=yo(N))E++;for(;0<T-E;)x=yo(x),T--;for(;0<E-T;)k=yo(k),E--;for(;T--;){if(x===k||k!==null&&x===k.alternate)break t;x=yo(x),k=yo(k)}x=null}else x=null;p!==null&&E1(d,m,p,x,!1),g!==null&&w!==null&&E1(d,w,g,x,!0)}}e:{if(m=c?bo(c):window,p=m.nodeName&&m.nodeName.toLowerCase(),p==="select"||p==="input"&&m.type==="file")var M=S4;else if(m1(m))if(XE)M=N4;else{M=I4;var O=A4}else(p=m.nodeName)&&p.toLowerCase()==="input"&&(m.type==="checkbox"||m.type==="radio")&&(M=C4);if(M&&(M=M(e,c))){qE(d,M,r,u);break e}O&&O(e,m,c),e==="focusout"&&(O=m._wrapperState)&&O.controlled&&m.type==="number"&&vm(m,"number",m.value)}switch(O=c?bo(c):window,e){case"focusin":(m1(O)||O.contentEditable==="true")&&(No=O,Nm=c,dc=null);break;case"focusout":dc=Nm=No=null;break;case"mousedown":Rm=!0;break;case"contextmenu":case"mouseup":case"dragend":Rm=!1,y1(d,r,u);break;case"selectionchange":if(P4)break;case"keydown":case"keyup":y1(d,r,u)}var v;if(ug)e:{switch(e){case"compositionstart":var _="onCompositionStart";break e;case"compositionend":_="onCompositionEnd";break e;case"compositionupdate":_="onCompositionUpdate";break e}_=void 0}else Co?GE(e,r)&&(_="onCompositionEnd"):e==="keydown"&&r.keyCode===229&&(_="onCompositionStart");_&&(HE&&r.locale!=="ko"&&(Co||_!=="onCompositionStart"?_==="onCompositionEnd"&&Co&&(v=WE()):(La=u,og="value"in La?La.value:La.textContent,Co=!0)),O=dh(c,_),0<O.length&&(_=new u1(_,e,null,r,u),d.push({event:_,listeners:O}),v?_.data=v:(v=KE(r),v!==null&&(_.data=v)))),(v=_4?w4(e,r):E4(e,r))&&(c=dh(c,"onBeforeInput"),0<c.length&&(u=new u1("onBeforeInput","beforeinput",null,r,u),d.push({event:u,listeners:c}),u.data=v))}a2(d,t)})}function zc(e,t,r){return{instance:e,listener:t,currentTarget:r}}function dh(e,t){for(var r=t+"Capture",n=[];e!==null;){var s=e,a=s.stateNode;s.tag===5&&a!==null&&(s=a,a=Oc(e,r),a!=null&&n.unshift(zc(e,a,s)),a=Oc(e,t),a!=null&&n.push(zc(e,a,s))),e=e.return}return n}function yo(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function E1(e,t,r,n,s){for(var a=t._reactName,i=[];r!==null&&r!==n;){var o=r,l=o.alternate,c=o.stateNode;if(l!==null&&l===n)break;o.tag===5&&c!==null&&(o=c,s?(l=Oc(r,a),l!=null&&i.unshift(zc(r,l,o))):s||(l=Oc(r,a),l!=null&&i.push(zc(r,l,o)))),r=r.return}i.length!==0&&e.push({event:t,listeners:i})}var M4=/\r\n?/g,L4=/\u0000|\uFFFD/g;function T1(e){return(typeof e=="string"?e:""+e).replace(M4,`
`).replace(L4,"")}function mf(e,t,r){if(t=T1(t),T1(e)!==t&&r)throw Error(_e(425))}function mh(){}var bm=null,Pm=null;function Dm(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var Fm=typeof setTimeout=="function"?setTimeout:void 0,j4=typeof clearTimeout=="function"?clearTimeout:void 0,k1=typeof Promise=="function"?Promise:void 0,V4=typeof queueMicrotask=="function"?queueMicrotask:typeof k1<"u"?function(e){return k1.resolve(null).then(e).catch(U4)}:Fm;function U4(e){setTimeout(function(){throw e})}function C0(e,t){var r=t,n=0;do{var s=r.nextSibling;if(e.removeChild(r),s&&s.nodeType===8)if(r=s.data,r==="/$"){if(n===0){e.removeChild(s),jc(t);return}n--}else r!=="$"&&r!=="$?"&&r!=="$!"||n++;r=s}while(r);jc(t)}function Ga(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function S1(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="$"||r==="$!"||r==="$?"){if(t===0)return e;t--}else r==="/$"&&t++}e=e.previousSibling}return null}var _l=Math.random().toString(36).slice(2),ys="__reactFiber$"+_l,$c="__reactProps$"+_l,ia="__reactContainer$"+_l,Om="__reactEvents$"+_l,B4="__reactListeners$"+_l,z4="__reactHandles$"+_l;function Ii(e){var t=e[ys];if(t)return t;for(var r=e.parentNode;r;){if(t=r[ia]||r[ys]){if(r=t.alternate,t.child!==null||r!==null&&r.child!==null)for(e=S1(e);e!==null;){if(r=e[ys])return r;e=S1(e)}return t}e=r,r=e.parentNode}return null}function _u(e){return e=e[ys]||e[ia],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function bo(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(_e(33))}function gd(e){return e[$c]||null}var Mm=[],Po=-1;function di(e){return{current:e}}function Nt(e){0>Po||(e.current=Mm[Po],Mm[Po]=null,Po--)}function wt(e,t){Po++,Mm[Po]=e.current,e.current=t}var si={},Wr=di(si),hn=di(!1),Ui=si;function el(e,t){var r=e.type.contextTypes;if(!r)return si;var n=e.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===t)return n.__reactInternalMemoizedMaskedChildContext;var s={},a;for(a in r)s[a]=t[a];return n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=s),s}function dn(e){return e=e.childContextTypes,e!=null}function ph(){Nt(hn),Nt(Wr)}function A1(e,t,r){if(Wr.current!==si)throw Error(_e(168));wt(Wr,t),wt(hn,r)}function o2(e,t,r){var n=e.stateNode;if(t=t.childContextTypes,typeof n.getChildContext!="function")return r;n=n.getChildContext();for(var s in n)if(!(s in t))throw Error(_e(108,AC(e)||"Unknown",s));return Mt({},r,n)}function gh(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||si,Ui=Wr.current,wt(Wr,e),wt(hn,hn.current),!0}function I1(e,t,r){var n=e.stateNode;if(!n)throw Error(_e(169));r?(e=o2(e,t,Ui),n.__reactInternalMemoizedMergedChildContext=e,Nt(hn),Nt(Wr),wt(Wr,e)):Nt(hn),wt(hn,r)}var Gs=null,vd=!1,N0=!1;function l2(e){Gs===null?Gs=[e]:Gs.push(e)}function $4(e){vd=!0,l2(e)}function mi(){if(!N0&&Gs!==null){N0=!0;var e=0,t=gt;try{var r=Gs;for(gt=1;e<r.length;e++){var n=r[e];do n=n(!0);while(n!==null)}Gs=null,vd=!1}catch(s){throw Gs!==null&&(Gs=Gs.slice(e+1)),DE(ng,mi),s}finally{gt=t,N0=!1}}return null}var Do=[],Fo=0,vh=null,xh=0,Mn=[],Ln=0,Bi=null,Ks=1,qs="";function wi(e,t){Do[Fo++]=xh,Do[Fo++]=vh,vh=e,xh=t}function c2(e,t,r){Mn[Ln++]=Ks,Mn[Ln++]=qs,Mn[Ln++]=Bi,Bi=e;var n=Ks;e=qs;var s=32-is(n)-1;n&=~(1<<s),r+=1;var a=32-is(t)+s;if(30<a){var i=s-s%5;a=(n&(1<<i)-1).toString(32),n>>=i,s-=i,Ks=1<<32-is(t)+s|r<<s|n,qs=a+e}else Ks=1<<a|r<<s|n,qs=e}function hg(e){e.return!==null&&(wi(e,1),c2(e,1,0))}function dg(e){for(;e===vh;)vh=Do[--Fo],Do[Fo]=null,xh=Do[--Fo],Do[Fo]=null;for(;e===Bi;)Bi=Mn[--Ln],Mn[Ln]=null,qs=Mn[--Ln],Mn[Ln]=null,Ks=Mn[--Ln],Mn[Ln]=null}var kn=null,En=null,Pt=!1,es=null;function u2(e,t){var r=jn(5,null,null,0);r.elementType="DELETED",r.stateNode=t,r.return=e,t=e.deletions,t===null?(e.deletions=[r],e.flags|=16):t.push(r)}function C1(e,t){switch(e.tag){case 5:var r=e.type;return t=t.nodeType!==1||r.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,kn=e,En=Ga(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,kn=e,En=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(r=Bi!==null?{id:Ks,overflow:qs}:null,e.memoizedState={dehydrated:t,treeContext:r,retryLane:1073741824},r=jn(18,null,null,0),r.stateNode=t,r.return=e,e.child=r,kn=e,En=null,!0):!1;default:return!1}}function Lm(e){return(e.mode&1)!==0&&(e.flags&128)===0}function jm(e){if(Pt){var t=En;if(t){var r=t;if(!C1(e,t)){if(Lm(e))throw Error(_e(418));t=Ga(r.nextSibling);var n=kn;t&&C1(e,t)?u2(n,r):(e.flags=e.flags&-4097|2,Pt=!1,kn=e)}}else{if(Lm(e))throw Error(_e(418));e.flags=e.flags&-4097|2,Pt=!1,kn=e}}}function N1(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;kn=e}function pf(e){if(e!==kn)return!1;if(!Pt)return N1(e),Pt=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!Dm(e.type,e.memoizedProps)),t&&(t=En)){if(Lm(e))throw f2(),Error(_e(418));for(;t;)u2(e,t),t=Ga(t.nextSibling)}if(N1(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(_e(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="/$"){if(t===0){En=Ga(e.nextSibling);break e}t--}else r!=="$"&&r!=="$!"&&r!=="$?"||t++}e=e.nextSibling}En=null}}else En=kn?Ga(e.stateNode.nextSibling):null;return!0}function f2(){for(var e=En;e;)e=Ga(e.nextSibling)}function tl(){En=kn=null,Pt=!1}function mg(e){es===null?es=[e]:es.push(e)}var W4=va.ReactCurrentBatchConfig;function $l(e,t,r){if(e=r.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(r._owner){if(r=r._owner,r){if(r.tag!==1)throw Error(_e(309));var n=r.stateNode}if(!n)throw Error(_e(147,e));var s=n,a=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===a?t.ref:(t=function(i){var o=s.refs;i===null?delete o[a]:o[a]=i},t._stringRef=a,t)}if(typeof e!="string")throw Error(_e(284));if(!r._owner)throw Error(_e(290,e))}return e}function gf(e,t){throw e=Object.prototype.toString.call(t),Error(_e(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function R1(e){var t=e._init;return t(e._payload)}function h2(e){function t(k,T){if(e){var E=k.deletions;E===null?(k.deletions=[T],k.flags|=16):E.push(T)}}function r(k,T){if(!e)return null;for(;T!==null;)t(k,T),T=T.sibling;return null}function n(k,T){for(k=new Map;T!==null;)T.key!==null?k.set(T.key,T):k.set(T.index,T),T=T.sibling;return k}function s(k,T){return k=Ya(k,T),k.index=0,k.sibling=null,k}function a(k,T,E){return k.index=E,e?(E=k.alternate,E!==null?(E=E.index,E<T?(k.flags|=2,T):E):(k.flags|=2,T)):(k.flags|=1048576,T)}function i(k){return e&&k.alternate===null&&(k.flags|=2),k}function o(k,T,E,N){return T===null||T.tag!==6?(T=M0(E,k.mode,N),T.return=k,T):(T=s(T,E),T.return=k,T)}function l(k,T,E,N){var M=E.type;return M===Io?u(k,T,E.props.children,N,E.key):T!==null&&(T.elementType===M||typeof M=="object"&&M!==null&&M.$$typeof===Na&&R1(M)===T.type)?(N=s(T,E.props),N.ref=$l(k,T,E),N.return=k,N):(N=qf(E.type,E.key,E.props,null,k.mode,N),N.ref=$l(k,T,E),N.return=k,N)}function c(k,T,E,N){return T===null||T.tag!==4||T.stateNode.containerInfo!==E.containerInfo||T.stateNode.implementation!==E.implementation?(T=L0(E,k.mode,N),T.return=k,T):(T=s(T,E.children||[]),T.return=k,T)}function u(k,T,E,N,M){return T===null||T.tag!==7?(T=Oi(E,k.mode,N,M),T.return=k,T):(T=s(T,E),T.return=k,T)}function d(k,T,E){if(typeof T=="string"&&T!==""||typeof T=="number")return T=M0(""+T,k.mode,E),T.return=k,T;if(typeof T=="object"&&T!==null){switch(T.$$typeof){case sf:return E=qf(T.type,T.key,T.props,null,k.mode,E),E.ref=$l(k,null,T),E.return=k,E;case Ao:return T=L0(T,k.mode,E),T.return=k,T;case Na:var N=T._init;return d(k,N(T._payload),E)}if(Ql(T)||jl(T))return T=Oi(T,k.mode,E,null),T.return=k,T;gf(k,T)}return null}function m(k,T,E,N){var M=T!==null?T.key:null;if(typeof E=="string"&&E!==""||typeof E=="number")return M!==null?null:o(k,T,""+E,N);if(typeof E=="object"&&E!==null){switch(E.$$typeof){case sf:return E.key===M?l(k,T,E,N):null;case Ao:return E.key===M?c(k,T,E,N):null;case Na:return M=E._init,m(k,T,M(E._payload),N)}if(Ql(E)||jl(E))return M!==null?null:u(k,T,E,N,null);gf(k,E)}return null}function p(k,T,E,N,M){if(typeof N=="string"&&N!==""||typeof N=="number")return k=k.get(E)||null,o(T,k,""+N,M);if(typeof N=="object"&&N!==null){switch(N.$$typeof){case sf:return k=k.get(N.key===null?E:N.key)||null,l(T,k,N,M);case Ao:return k=k.get(N.key===null?E:N.key)||null,c(T,k,N,M);case Na:var O=N._init;return p(k,T,E,O(N._payload),M)}if(Ql(N)||jl(N))return k=k.get(E)||null,u(T,k,N,M,null);gf(T,N)}return null}function g(k,T,E,N){for(var M=null,O=null,v=T,_=T=0,S=null;v!==null&&_<E.length;_++){v.index>_?(S=v,v=null):S=v.sibling;var I=m(k,v,E[_],N);if(I===null){v===null&&(v=S);break}e&&v&&I.alternate===null&&t(k,v),T=a(I,T,_),O===null?M=I:O.sibling=I,O=I,v=S}if(_===E.length)return r(k,v),Pt&&wi(k,_),M;if(v===null){for(;_<E.length;_++)v=d(k,E[_],N),v!==null&&(T=a(v,T,_),O===null?M=v:O.sibling=v,O=v);return Pt&&wi(k,_),M}for(v=n(k,v);_<E.length;_++)S=p(v,k,_,E[_],N),S!==null&&(e&&S.alternate!==null&&v.delete(S.key===null?_:S.key),T=a(S,T,_),O===null?M=S:O.sibling=S,O=S);return e&&v.forEach(function(b){return t(k,b)}),Pt&&wi(k,_),M}function x(k,T,E,N){var M=jl(E);if(typeof M!="function")throw Error(_e(150));if(E=M.call(E),E==null)throw Error(_e(151));for(var O=M=null,v=T,_=T=0,S=null,I=E.next();v!==null&&!I.done;_++,I=E.next()){v.index>_?(S=v,v=null):S=v.sibling;var b=m(k,v,I.value,N);if(b===null){v===null&&(v=S);break}e&&v&&b.alternate===null&&t(k,v),T=a(b,T,_),O===null?M=b:O.sibling=b,O=b,v=S}if(I.done)return r(k,v),Pt&&wi(k,_),M;if(v===null){for(;!I.done;_++,I=E.next())I=d(k,I.value,N),I!==null&&(T=a(I,T,_),O===null?M=I:O.sibling=I,O=I);return Pt&&wi(k,_),M}for(v=n(k,v);!I.done;_++,I=E.next())I=p(v,k,_,I.value,N),I!==null&&(e&&I.alternate!==null&&v.delete(I.key===null?_:I.key),T=a(I,T,_),O===null?M=I:O.sibling=I,O=I);return e&&v.forEach(function(P){return t(k,P)}),Pt&&wi(k,_),M}function w(k,T,E,N){if(typeof E=="object"&&E!==null&&E.type===Io&&E.key===null&&(E=E.props.children),typeof E=="object"&&E!==null){switch(E.$$typeof){case sf:e:{for(var M=E.key,O=T;O!==null;){if(O.key===M){if(M=E.type,M===Io){if(O.tag===7){r(k,O.sibling),T=s(O,E.props.children),T.return=k,k=T;break e}}else if(O.elementType===M||typeof M=="object"&&M!==null&&M.$$typeof===Na&&R1(M)===O.type){r(k,O.sibling),T=s(O,E.props),T.ref=$l(k,O,E),T.return=k,k=T;break e}r(k,O);break}else t(k,O);O=O.sibling}E.type===Io?(T=Oi(E.props.children,k.mode,N,E.key),T.return=k,k=T):(N=qf(E.type,E.key,E.props,null,k.mode,N),N.ref=$l(k,T,E),N.return=k,k=N)}return i(k);case Ao:e:{for(O=E.key;T!==null;){if(T.key===O)if(T.tag===4&&T.stateNode.containerInfo===E.containerInfo&&T.stateNode.implementation===E.implementation){r(k,T.sibling),T=s(T,E.children||[]),T.return=k,k=T;break e}else{r(k,T);break}else t(k,T);T=T.sibling}T=L0(E,k.mode,N),T.return=k,k=T}return i(k);case Na:return O=E._init,w(k,T,O(E._payload),N)}if(Ql(E))return g(k,T,E,N);if(jl(E))return x(k,T,E,N);gf(k,E)}return typeof E=="string"&&E!==""||typeof E=="number"?(E=""+E,T!==null&&T.tag===6?(r(k,T.sibling),T=s(T,E),T.return=k,k=T):(r(k,T),T=M0(E,k.mode,N),T.return=k,k=T),i(k)):r(k,T)}return w}var rl=h2(!0),d2=h2(!1),yh=di(null),_h=null,Oo=null,pg=null;function gg(){pg=Oo=_h=null}function vg(e){var t=yh.current;Nt(yh),e._currentValue=t}function Vm(e,t,r){for(;e!==null;){var n=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,n!==null&&(n.childLanes|=t)):n!==null&&(n.childLanes&t)!==t&&(n.childLanes|=t),e===r)break;e=e.return}}function $o(e,t){_h=e,pg=Oo=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(fn=!0),e.firstContext=null)}function zn(e){var t=e._currentValue;if(pg!==e)if(e={context:e,memoizedValue:t,next:null},Oo===null){if(_h===null)throw Error(_e(308));Oo=e,_h.dependencies={lanes:0,firstContext:e}}else Oo=Oo.next=e;return t}var Ci=null;function xg(e){Ci===null?Ci=[e]:Ci.push(e)}function m2(e,t,r,n){var s=t.interleaved;return s===null?(r.next=r,xg(t)):(r.next=s.next,s.next=r),t.interleaved=r,oa(e,n)}function oa(e,t){e.lanes|=t;var r=e.alternate;for(r!==null&&(r.lanes|=t),r=e,e=e.return;e!==null;)e.childLanes|=t,r=e.alternate,r!==null&&(r.childLanes|=t),r=e,e=e.return;return r.tag===3?r.stateNode:null}var Ra=!1;function yg(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function p2(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function ea(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function Ka(e,t,r){var n=e.updateQueue;if(n===null)return null;if(n=n.shared,it&2){var s=n.pending;return s===null?t.next=t:(t.next=s.next,s.next=t),n.pending=t,oa(e,r)}return s=n.interleaved,s===null?(t.next=t,xg(n)):(t.next=s.next,s.next=t),n.interleaved=t,oa(e,r)}function zf(e,t,r){if(t=t.updateQueue,t!==null&&(t=t.shared,(r&4194240)!==0)){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,sg(e,r)}}function b1(e,t){var r=e.updateQueue,n=e.alternate;if(n!==null&&(n=n.updateQueue,r===n)){var s=null,a=null;if(r=r.firstBaseUpdate,r!==null){do{var i={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};a===null?s=a=i:a=a.next=i,r=r.next}while(r!==null);a===null?s=a=t:a=a.next=t}else s=a=t;r={baseState:n.baseState,firstBaseUpdate:s,lastBaseUpdate:a,shared:n.shared,effects:n.effects},e.updateQueue=r;return}e=r.lastBaseUpdate,e===null?r.firstBaseUpdate=t:e.next=t,r.lastBaseUpdate=t}function wh(e,t,r,n){var s=e.updateQueue;Ra=!1;var a=s.firstBaseUpdate,i=s.lastBaseUpdate,o=s.shared.pending;if(o!==null){s.shared.pending=null;var l=o,c=l.next;l.next=null,i===null?a=c:i.next=c,i=l;var u=e.alternate;u!==null&&(u=u.updateQueue,o=u.lastBaseUpdate,o!==i&&(o===null?u.firstBaseUpdate=c:o.next=c,u.lastBaseUpdate=l))}if(a!==null){var d=s.baseState;i=0,u=c=l=null,o=a;do{var m=o.lane,p=o.eventTime;if((n&m)===m){u!==null&&(u=u.next={eventTime:p,lane:0,tag:o.tag,payload:o.payload,callback:o.callback,next:null});e:{var g=e,x=o;switch(m=t,p=r,x.tag){case 1:if(g=x.payload,typeof g=="function"){d=g.call(p,d,m);break e}d=g;break e;case 3:g.flags=g.flags&-65537|128;case 0:if(g=x.payload,m=typeof g=="function"?g.call(p,d,m):g,m==null)break e;d=Mt({},d,m);break e;case 2:Ra=!0}}o.callback!==null&&o.lane!==0&&(e.flags|=64,m=s.effects,m===null?s.effects=[o]:m.push(o))}else p={eventTime:p,lane:m,tag:o.tag,payload:o.payload,callback:o.callback,next:null},u===null?(c=u=p,l=d):u=u.next=p,i|=m;if(o=o.next,o===null){if(o=s.shared.pending,o===null)break;m=o,o=m.next,m.next=null,s.lastBaseUpdate=m,s.shared.pending=null}}while(!0);if(u===null&&(l=d),s.baseState=l,s.firstBaseUpdate=c,s.lastBaseUpdate=u,t=s.shared.interleaved,t!==null){s=t;do i|=s.lane,s=s.next;while(s!==t)}else a===null&&(s.shared.lanes=0);$i|=i,e.lanes=i,e.memoizedState=d}}function P1(e,t,r){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var n=e[t],s=n.callback;if(s!==null){if(n.callback=null,n=r,typeof s!="function")throw Error(_e(191,s));s.call(n)}}}var wu={},Ts=di(wu),Wc=di(wu),Hc=di(wu);function Ni(e){if(e===wu)throw Error(_e(174));return e}function _g(e,t){switch(wt(Hc,t),wt(Wc,e),wt(Ts,wu),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:ym(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=ym(t,e)}Nt(Ts),wt(Ts,t)}function nl(){Nt(Ts),Nt(Wc),Nt(Hc)}function g2(e){Ni(Hc.current);var t=Ni(Ts.current),r=ym(t,e.type);t!==r&&(wt(Wc,e),wt(Ts,r))}function wg(e){Wc.current===e&&(Nt(Ts),Nt(Wc))}var Ft=di(0);function Eh(e){for(var t=e;t!==null;){if(t.tag===13){var r=t.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||r.data==="$?"||r.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var R0=[];function Eg(){for(var e=0;e<R0.length;e++)R0[e]._workInProgressVersionPrimary=null;R0.length=0}var $f=va.ReactCurrentDispatcher,b0=va.ReactCurrentBatchConfig,zi=0,Ot=null,rr=null,hr=null,Th=!1,mc=!1,Gc=0,H4=0;function Pr(){throw Error(_e(321))}function Tg(e,t){if(t===null)return!1;for(var r=0;r<t.length&&r<e.length;r++)if(!us(e[r],t[r]))return!1;return!0}function kg(e,t,r,n,s,a){if(zi=a,Ot=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,$f.current=e===null||e.memoizedState===null?X4:Y4,e=r(n,s),mc){a=0;do{if(mc=!1,Gc=0,25<=a)throw Error(_e(301));a+=1,hr=rr=null,t.updateQueue=null,$f.current=Q4,e=r(n,s)}while(mc)}if($f.current=kh,t=rr!==null&&rr.next!==null,zi=0,hr=rr=Ot=null,Th=!1,t)throw Error(_e(300));return e}function Sg(){var e=Gc!==0;return Gc=0,e}function xs(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return hr===null?Ot.memoizedState=hr=e:hr=hr.next=e,hr}function $n(){if(rr===null){var e=Ot.alternate;e=e!==null?e.memoizedState:null}else e=rr.next;var t=hr===null?Ot.memoizedState:hr.next;if(t!==null)hr=t,rr=e;else{if(e===null)throw Error(_e(310));rr=e,e={memoizedState:rr.memoizedState,baseState:rr.baseState,baseQueue:rr.baseQueue,queue:rr.queue,next:null},hr===null?Ot.memoizedState=hr=e:hr=hr.next=e}return hr}function Kc(e,t){return typeof t=="function"?t(e):t}function P0(e){var t=$n(),r=t.queue;if(r===null)throw Error(_e(311));r.lastRenderedReducer=e;var n=rr,s=n.baseQueue,a=r.pending;if(a!==null){if(s!==null){var i=s.next;s.next=a.next,a.next=i}n.baseQueue=s=a,r.pending=null}if(s!==null){a=s.next,n=n.baseState;var o=i=null,l=null,c=a;do{var u=c.lane;if((zi&u)===u)l!==null&&(l=l.next={lane:0,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null}),n=c.hasEagerState?c.eagerState:e(n,c.action);else{var d={lane:u,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null};l===null?(o=l=d,i=n):l=l.next=d,Ot.lanes|=u,$i|=u}c=c.next}while(c!==null&&c!==a);l===null?i=n:l.next=o,us(n,t.memoizedState)||(fn=!0),t.memoizedState=n,t.baseState=i,t.baseQueue=l,r.lastRenderedState=n}if(e=r.interleaved,e!==null){s=e;do a=s.lane,Ot.lanes|=a,$i|=a,s=s.next;while(s!==e)}else s===null&&(r.lanes=0);return[t.memoizedState,r.dispatch]}function D0(e){var t=$n(),r=t.queue;if(r===null)throw Error(_e(311));r.lastRenderedReducer=e;var n=r.dispatch,s=r.pending,a=t.memoizedState;if(s!==null){r.pending=null;var i=s=s.next;do a=e(a,i.action),i=i.next;while(i!==s);us(a,t.memoizedState)||(fn=!0),t.memoizedState=a,t.baseQueue===null&&(t.baseState=a),r.lastRenderedState=a}return[a,n]}function v2(){}function x2(e,t){var r=Ot,n=$n(),s=t(),a=!us(n.memoizedState,s);if(a&&(n.memoizedState=s,fn=!0),n=n.queue,Ag(w2.bind(null,r,n,e),[e]),n.getSnapshot!==t||a||hr!==null&&hr.memoizedState.tag&1){if(r.flags|=2048,qc(9,_2.bind(null,r,n,s,t),void 0,null),dr===null)throw Error(_e(349));zi&30||y2(r,t,s)}return s}function y2(e,t,r){e.flags|=16384,e={getSnapshot:t,value:r},t=Ot.updateQueue,t===null?(t={lastEffect:null,stores:null},Ot.updateQueue=t,t.stores=[e]):(r=t.stores,r===null?t.stores=[e]:r.push(e))}function _2(e,t,r,n){t.value=r,t.getSnapshot=n,E2(t)&&T2(e)}function w2(e,t,r){return r(function(){E2(t)&&T2(e)})}function E2(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!us(e,r)}catch{return!0}}function T2(e){var t=oa(e,1);t!==null&&os(t,e,1,-1)}function D1(e){var t=xs();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Kc,lastRenderedState:e},t.queue=e,e=e.dispatch=q4.bind(null,Ot,e),[t.memoizedState,e]}function qc(e,t,r,n){return e={tag:e,create:t,destroy:r,deps:n,next:null},t=Ot.updateQueue,t===null?(t={lastEffect:null,stores:null},Ot.updateQueue=t,t.lastEffect=e.next=e):(r=t.lastEffect,r===null?t.lastEffect=e.next=e:(n=r.next,r.next=e,e.next=n,t.lastEffect=e)),e}function k2(){return $n().memoizedState}function Wf(e,t,r,n){var s=xs();Ot.flags|=e,s.memoizedState=qc(1|t,r,void 0,n===void 0?null:n)}function xd(e,t,r,n){var s=$n();n=n===void 0?null:n;var a=void 0;if(rr!==null){var i=rr.memoizedState;if(a=i.destroy,n!==null&&Tg(n,i.deps)){s.memoizedState=qc(t,r,a,n);return}}Ot.flags|=e,s.memoizedState=qc(1|t,r,a,n)}function F1(e,t){return Wf(8390656,8,e,t)}function Ag(e,t){return xd(2048,8,e,t)}function S2(e,t){return xd(4,2,e,t)}function A2(e,t){return xd(4,4,e,t)}function I2(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function C2(e,t,r){return r=r!=null?r.concat([e]):null,xd(4,4,I2.bind(null,t,e),r)}function Ig(){}function N2(e,t){var r=$n();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&Tg(t,n[1])?n[0]:(r.memoizedState=[e,t],e)}function R2(e,t){var r=$n();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&Tg(t,n[1])?n[0]:(e=e(),r.memoizedState=[e,t],e)}function b2(e,t,r){return zi&21?(us(r,t)||(r=ME(),Ot.lanes|=r,$i|=r,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,fn=!0),e.memoizedState=r)}function G4(e,t){var r=gt;gt=r!==0&&4>r?r:4,e(!0);var n=b0.transition;b0.transition={};try{e(!1),t()}finally{gt=r,b0.transition=n}}function P2(){return $n().memoizedState}function K4(e,t,r){var n=Xa(e);if(r={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null},D2(e))F2(t,r);else if(r=m2(e,t,r,n),r!==null){var s=Jr();os(r,e,n,s),O2(r,t,n)}}function q4(e,t,r){var n=Xa(e),s={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null};if(D2(e))F2(t,s);else{var a=e.alternate;if(e.lanes===0&&(a===null||a.lanes===0)&&(a=t.lastRenderedReducer,a!==null))try{var i=t.lastRenderedState,o=a(i,r);if(s.hasEagerState=!0,s.eagerState=o,us(o,i)){var l=t.interleaved;l===null?(s.next=s,xg(t)):(s.next=l.next,l.next=s),t.interleaved=s;return}}catch{}finally{}r=m2(e,t,s,n),r!==null&&(s=Jr(),os(r,e,n,s),O2(r,t,n))}}function D2(e){var t=e.alternate;return e===Ot||t!==null&&t===Ot}function F2(e,t){mc=Th=!0;var r=e.pending;r===null?t.next=t:(t.next=r.next,r.next=t),e.pending=t}function O2(e,t,r){if(r&4194240){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,sg(e,r)}}var kh={readContext:zn,useCallback:Pr,useContext:Pr,useEffect:Pr,useImperativeHandle:Pr,useInsertionEffect:Pr,useLayoutEffect:Pr,useMemo:Pr,useReducer:Pr,useRef:Pr,useState:Pr,useDebugValue:Pr,useDeferredValue:Pr,useTransition:Pr,useMutableSource:Pr,useSyncExternalStore:Pr,useId:Pr,unstable_isNewReconciler:!1},X4={readContext:zn,useCallback:function(e,t){return xs().memoizedState=[e,t===void 0?null:t],e},useContext:zn,useEffect:F1,useImperativeHandle:function(e,t,r){return r=r!=null?r.concat([e]):null,Wf(4194308,4,I2.bind(null,t,e),r)},useLayoutEffect:function(e,t){return Wf(4194308,4,e,t)},useInsertionEffect:function(e,t){return Wf(4,2,e,t)},useMemo:function(e,t){var r=xs();return t=t===void 0?null:t,e=e(),r.memoizedState=[e,t],e},useReducer:function(e,t,r){var n=xs();return t=r!==void 0?r(t):t,n.memoizedState=n.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},n.queue=e,e=e.dispatch=K4.bind(null,Ot,e),[n.memoizedState,e]},useRef:function(e){var t=xs();return e={current:e},t.memoizedState=e},useState:D1,useDebugValue:Ig,useDeferredValue:function(e){return xs().memoizedState=e},useTransition:function(){var e=D1(!1),t=e[0];return e=G4.bind(null,e[1]),xs().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,r){var n=Ot,s=xs();if(Pt){if(r===void 0)throw Error(_e(407));r=r()}else{if(r=t(),dr===null)throw Error(_e(349));zi&30||y2(n,t,r)}s.memoizedState=r;var a={value:r,getSnapshot:t};return s.queue=a,F1(w2.bind(null,n,a,e),[e]),n.flags|=2048,qc(9,_2.bind(null,n,a,r,t),void 0,null),r},useId:function(){var e=xs(),t=dr.identifierPrefix;if(Pt){var r=qs,n=Ks;r=(n&~(1<<32-is(n)-1)).toString(32)+r,t=":"+t+"R"+r,r=Gc++,0<r&&(t+="H"+r.toString(32)),t+=":"}else r=H4++,t=":"+t+"r"+r.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},Y4={readContext:zn,useCallback:N2,useContext:zn,useEffect:Ag,useImperativeHandle:C2,useInsertionEffect:S2,useLayoutEffect:A2,useMemo:R2,useReducer:P0,useRef:k2,useState:function(){return P0(Kc)},useDebugValue:Ig,useDeferredValue:function(e){var t=$n();return b2(t,rr.memoizedState,e)},useTransition:function(){var e=P0(Kc)[0],t=$n().memoizedState;return[e,t]},useMutableSource:v2,useSyncExternalStore:x2,useId:P2,unstable_isNewReconciler:!1},Q4={readContext:zn,useCallback:N2,useContext:zn,useEffect:Ag,useImperativeHandle:C2,useInsertionEffect:S2,useLayoutEffect:A2,useMemo:R2,useReducer:D0,useRef:k2,useState:function(){return D0(Kc)},useDebugValue:Ig,useDeferredValue:function(e){var t=$n();return rr===null?t.memoizedState=e:b2(t,rr.memoizedState,e)},useTransition:function(){var e=D0(Kc)[0],t=$n().memoizedState;return[e,t]},useMutableSource:v2,useSyncExternalStore:x2,useId:P2,unstable_isNewReconciler:!1};function Qn(e,t){if(e&&e.defaultProps){t=Mt({},t),e=e.defaultProps;for(var r in e)t[r]===void 0&&(t[r]=e[r]);return t}return t}function Um(e,t,r,n){t=e.memoizedState,r=r(n,t),r=r==null?t:Mt({},t,r),e.memoizedState=r,e.lanes===0&&(e.updateQueue.baseState=r)}var yd={isMounted:function(e){return(e=e._reactInternals)?to(e)===e:!1},enqueueSetState:function(e,t,r){e=e._reactInternals;var n=Jr(),s=Xa(e),a=ea(n,s);a.payload=t,r!=null&&(a.callback=r),t=Ka(e,a,s),t!==null&&(os(t,e,s,n),zf(t,e,s))},enqueueReplaceState:function(e,t,r){e=e._reactInternals;var n=Jr(),s=Xa(e),a=ea(n,s);a.tag=1,a.payload=t,r!=null&&(a.callback=r),t=Ka(e,a,s),t!==null&&(os(t,e,s,n),zf(t,e,s))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var r=Jr(),n=Xa(e),s=ea(r,n);s.tag=2,t!=null&&(s.callback=t),t=Ka(e,s,n),t!==null&&(os(t,e,n,r),zf(t,e,n))}};function O1(e,t,r,n,s,a,i){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(n,a,i):t.prototype&&t.prototype.isPureReactComponent?!Uc(r,n)||!Uc(s,a):!0}function M2(e,t,r){var n=!1,s=si,a=t.contextType;return typeof a=="object"&&a!==null?a=zn(a):(s=dn(t)?Ui:Wr.current,n=t.contextTypes,a=(n=n!=null)?el(e,s):si),t=new t(r,a),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=yd,e.stateNode=t,t._reactInternals=e,n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=s,e.__reactInternalMemoizedMaskedChildContext=a),t}function M1(e,t,r,n){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(r,n),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(r,n),t.state!==e&&yd.enqueueReplaceState(t,t.state,null)}function Bm(e,t,r,n){var s=e.stateNode;s.props=r,s.state=e.memoizedState,s.refs={},yg(e);var a=t.contextType;typeof a=="object"&&a!==null?s.context=zn(a):(a=dn(t)?Ui:Wr.current,s.context=el(e,a)),s.state=e.memoizedState,a=t.getDerivedStateFromProps,typeof a=="function"&&(Um(e,t,a,r),s.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof s.getSnapshotBeforeUpdate=="function"||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(t=s.state,typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount(),t!==s.state&&yd.enqueueReplaceState(s,s.state,null),wh(e,r,s,n),s.state=e.memoizedState),typeof s.componentDidMount=="function"&&(e.flags|=4194308)}function sl(e,t){try{var r="",n=t;do r+=SC(n),n=n.return;while(n);var s=r}catch(a){s=`
Error generating stack: `+a.message+`
`+a.stack}return{value:e,source:t,stack:s,digest:null}}function F0(e,t,r){return{value:e,source:null,stack:r??null,digest:t??null}}function zm(e,t){try{console.error(t.value)}catch(r){setTimeout(function(){throw r})}}var J4=typeof WeakMap=="function"?WeakMap:Map;function L2(e,t,r){r=ea(-1,r),r.tag=3,r.payload={element:null};var n=t.value;return r.callback=function(){Ah||(Ah=!0,Jm=n),zm(e,t)},r}function j2(e,t,r){r=ea(-1,r),r.tag=3;var n=e.type.getDerivedStateFromError;if(typeof n=="function"){var s=t.value;r.payload=function(){return n(s)},r.callback=function(){zm(e,t)}}var a=e.stateNode;return a!==null&&typeof a.componentDidCatch=="function"&&(r.callback=function(){zm(e,t),typeof n!="function"&&(qa===null?qa=new Set([this]):qa.add(this));var i=t.stack;this.componentDidCatch(t.value,{componentStack:i!==null?i:""})}),r}function L1(e,t,r){var n=e.pingCache;if(n===null){n=e.pingCache=new J4;var s=new Set;n.set(t,s)}else s=n.get(t),s===void 0&&(s=new Set,n.set(t,s));s.has(r)||(s.add(r),e=hN.bind(null,e,t,r),t.then(e,e))}function j1(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function V1(e,t,r,n,s){return e.mode&1?(e.flags|=65536,e.lanes=s,e):(e===t?e.flags|=65536:(e.flags|=128,r.flags|=131072,r.flags&=-52805,r.tag===1&&(r.alternate===null?r.tag=17:(t=ea(-1,1),t.tag=2,Ka(r,t,1))),r.lanes|=1),e)}var Z4=va.ReactCurrentOwner,fn=!1;function qr(e,t,r,n){t.child=e===null?d2(t,null,r,n):rl(t,e.child,r,n)}function U1(e,t,r,n,s){r=r.render;var a=t.ref;return $o(t,s),n=kg(e,t,r,n,a,s),r=Sg(),e!==null&&!fn?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~s,la(e,t,s)):(Pt&&r&&hg(t),t.flags|=1,qr(e,t,n,s),t.child)}function B1(e,t,r,n,s){if(e===null){var a=r.type;return typeof a=="function"&&!Og(a)&&a.defaultProps===void 0&&r.compare===null&&r.defaultProps===void 0?(t.tag=15,t.type=a,V2(e,t,a,n,s)):(e=qf(r.type,null,n,t,t.mode,s),e.ref=t.ref,e.return=t,t.child=e)}if(a=e.child,!(e.lanes&s)){var i=a.memoizedProps;if(r=r.compare,r=r!==null?r:Uc,r(i,n)&&e.ref===t.ref)return la(e,t,s)}return t.flags|=1,e=Ya(a,n),e.ref=t.ref,e.return=t,t.child=e}function V2(e,t,r,n,s){if(e!==null){var a=e.memoizedProps;if(Uc(a,n)&&e.ref===t.ref)if(fn=!1,t.pendingProps=n=a,(e.lanes&s)!==0)e.flags&131072&&(fn=!0);else return t.lanes=e.lanes,la(e,t,s)}return $m(e,t,r,n,s)}function U2(e,t,r){var n=t.pendingProps,s=n.children,a=e!==null?e.memoizedState:null;if(n.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},wt(Lo,xn),xn|=r;else{if(!(r&1073741824))return e=a!==null?a.baseLanes|r:r,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,wt(Lo,xn),xn|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=a!==null?a.baseLanes:r,wt(Lo,xn),xn|=n}else a!==null?(n=a.baseLanes|r,t.memoizedState=null):n=r,wt(Lo,xn),xn|=n;return qr(e,t,s,r),t.child}function B2(e,t){var r=t.ref;(e===null&&r!==null||e!==null&&e.ref!==r)&&(t.flags|=512,t.flags|=2097152)}function $m(e,t,r,n,s){var a=dn(r)?Ui:Wr.current;return a=el(t,a),$o(t,s),r=kg(e,t,r,n,a,s),n=Sg(),e!==null&&!fn?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~s,la(e,t,s)):(Pt&&n&&hg(t),t.flags|=1,qr(e,t,r,s),t.child)}function z1(e,t,r,n,s){if(dn(r)){var a=!0;gh(t)}else a=!1;if($o(t,s),t.stateNode===null)Hf(e,t),M2(t,r,n),Bm(t,r,n,s),n=!0;else if(e===null){var i=t.stateNode,o=t.memoizedProps;i.props=o;var l=i.context,c=r.contextType;typeof c=="object"&&c!==null?c=zn(c):(c=dn(r)?Ui:Wr.current,c=el(t,c));var u=r.getDerivedStateFromProps,d=typeof u=="function"||typeof i.getSnapshotBeforeUpdate=="function";d||typeof i.UNSAFE_componentWillReceiveProps!="function"&&typeof i.componentWillReceiveProps!="function"||(o!==n||l!==c)&&M1(t,i,n,c),Ra=!1;var m=t.memoizedState;i.state=m,wh(t,n,i,s),l=t.memoizedState,o!==n||m!==l||hn.current||Ra?(typeof u=="function"&&(Um(t,r,u,n),l=t.memoizedState),(o=Ra||O1(t,r,o,n,m,l,c))?(d||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount()),typeof i.componentDidMount=="function"&&(t.flags|=4194308)):(typeof i.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=n,t.memoizedState=l),i.props=n,i.state=l,i.context=c,n=o):(typeof i.componentDidMount=="function"&&(t.flags|=4194308),n=!1)}else{i=t.stateNode,p2(e,t),o=t.memoizedProps,c=t.type===t.elementType?o:Qn(t.type,o),i.props=c,d=t.pendingProps,m=i.context,l=r.contextType,typeof l=="object"&&l!==null?l=zn(l):(l=dn(r)?Ui:Wr.current,l=el(t,l));var p=r.getDerivedStateFromProps;(u=typeof p=="function"||typeof i.getSnapshotBeforeUpdate=="function")||typeof i.UNSAFE_componentWillReceiveProps!="function"&&typeof i.componentWillReceiveProps!="function"||(o!==d||m!==l)&&M1(t,i,n,l),Ra=!1,m=t.memoizedState,i.state=m,wh(t,n,i,s);var g=t.memoizedState;o!==d||m!==g||hn.current||Ra?(typeof p=="function"&&(Um(t,r,p,n),g=t.memoizedState),(c=Ra||O1(t,r,c,n,m,g,l)||!1)?(u||typeof i.UNSAFE_componentWillUpdate!="function"&&typeof i.componentWillUpdate!="function"||(typeof i.componentWillUpdate=="function"&&i.componentWillUpdate(n,g,l),typeof i.UNSAFE_componentWillUpdate=="function"&&i.UNSAFE_componentWillUpdate(n,g,l)),typeof i.componentDidUpdate=="function"&&(t.flags|=4),typeof i.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof i.componentDidUpdate!="function"||o===e.memoizedProps&&m===e.memoizedState||(t.flags|=4),typeof i.getSnapshotBeforeUpdate!="function"||o===e.memoizedProps&&m===e.memoizedState||(t.flags|=1024),t.memoizedProps=n,t.memoizedState=g),i.props=n,i.state=g,i.context=l,n=c):(typeof i.componentDidUpdate!="function"||o===e.memoizedProps&&m===e.memoizedState||(t.flags|=4),typeof i.getSnapshotBeforeUpdate!="function"||o===e.memoizedProps&&m===e.memoizedState||(t.flags|=1024),n=!1)}return Wm(e,t,r,n,a,s)}function Wm(e,t,r,n,s,a){B2(e,t);var i=(t.flags&128)!==0;if(!n&&!i)return s&&I1(t,r,!1),la(e,t,a);n=t.stateNode,Z4.current=t;var o=i&&typeof r.getDerivedStateFromError!="function"?null:n.render();return t.flags|=1,e!==null&&i?(t.child=rl(t,e.child,null,a),t.child=rl(t,null,o,a)):qr(e,t,o,a),t.memoizedState=n.state,s&&I1(t,r,!0),t.child}function z2(e){var t=e.stateNode;t.pendingContext?A1(e,t.pendingContext,t.pendingContext!==t.context):t.context&&A1(e,t.context,!1),_g(e,t.containerInfo)}function $1(e,t,r,n,s){return tl(),mg(s),t.flags|=256,qr(e,t,r,n),t.child}var Hm={dehydrated:null,treeContext:null,retryLane:0};function Gm(e){return{baseLanes:e,cachePool:null,transitions:null}}function $2(e,t,r){var n=t.pendingProps,s=Ft.current,a=!1,i=(t.flags&128)!==0,o;if((o=i)||(o=e!==null&&e.memoizedState===null?!1:(s&2)!==0),o?(a=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(s|=1),wt(Ft,s&1),e===null)return jm(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(i=n.children,e=n.fallback,a?(n=t.mode,a=t.child,i={mode:"hidden",children:i},!(n&1)&&a!==null?(a.childLanes=0,a.pendingProps=i):a=Ed(i,n,0,null),e=Oi(e,n,r,null),a.return=t,e.return=t,a.sibling=e,t.child=a,t.child.memoizedState=Gm(r),t.memoizedState=Hm,e):Cg(t,i));if(s=e.memoizedState,s!==null&&(o=s.dehydrated,o!==null))return eN(e,t,i,n,o,s,r);if(a){a=n.fallback,i=t.mode,s=e.child,o=s.sibling;var l={mode:"hidden",children:n.children};return!(i&1)&&t.child!==s?(n=t.child,n.childLanes=0,n.pendingProps=l,t.deletions=null):(n=Ya(s,l),n.subtreeFlags=s.subtreeFlags&14680064),o!==null?a=Ya(o,a):(a=Oi(a,i,r,null),a.flags|=2),a.return=t,n.return=t,n.sibling=a,t.child=n,n=a,a=t.child,i=e.child.memoizedState,i=i===null?Gm(r):{baseLanes:i.baseLanes|r,cachePool:null,transitions:i.transitions},a.memoizedState=i,a.childLanes=e.childLanes&~r,t.memoizedState=Hm,n}return a=e.child,e=a.sibling,n=Ya(a,{mode:"visible",children:n.children}),!(t.mode&1)&&(n.lanes=r),n.return=t,n.sibling=null,e!==null&&(r=t.deletions,r===null?(t.deletions=[e],t.flags|=16):r.push(e)),t.child=n,t.memoizedState=null,n}function Cg(e,t){return t=Ed({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function vf(e,t,r,n){return n!==null&&mg(n),rl(t,e.child,null,r),e=Cg(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function eN(e,t,r,n,s,a,i){if(r)return t.flags&256?(t.flags&=-257,n=F0(Error(_e(422))),vf(e,t,i,n)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(a=n.fallback,s=t.mode,n=Ed({mode:"visible",children:n.children},s,0,null),a=Oi(a,s,i,null),a.flags|=2,n.return=t,a.return=t,n.sibling=a,t.child=n,t.mode&1&&rl(t,e.child,null,i),t.child.memoizedState=Gm(i),t.memoizedState=Hm,a);if(!(t.mode&1))return vf(e,t,i,null);if(s.data==="$!"){if(n=s.nextSibling&&s.nextSibling.dataset,n)var o=n.dgst;return n=o,a=Error(_e(419)),n=F0(a,n,void 0),vf(e,t,i,n)}if(o=(i&e.childLanes)!==0,fn||o){if(n=dr,n!==null){switch(i&-i){case 4:s=2;break;case 16:s=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:s=32;break;case 536870912:s=268435456;break;default:s=0}s=s&(n.suspendedLanes|i)?0:s,s!==0&&s!==a.retryLane&&(a.retryLane=s,oa(e,s),os(n,e,s,-1))}return Fg(),n=F0(Error(_e(421))),vf(e,t,i,n)}return s.data==="$?"?(t.flags|=128,t.child=e.child,t=dN.bind(null,e),s._reactRetry=t,null):(e=a.treeContext,En=Ga(s.nextSibling),kn=t,Pt=!0,es=null,e!==null&&(Mn[Ln++]=Ks,Mn[Ln++]=qs,Mn[Ln++]=Bi,Ks=e.id,qs=e.overflow,Bi=t),t=Cg(t,n.children),t.flags|=4096,t)}function W1(e,t,r){e.lanes|=t;var n=e.alternate;n!==null&&(n.lanes|=t),Vm(e.return,t,r)}function O0(e,t,r,n,s){var a=e.memoizedState;a===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:n,tail:r,tailMode:s}:(a.isBackwards=t,a.rendering=null,a.renderingStartTime=0,a.last=n,a.tail=r,a.tailMode=s)}function W2(e,t,r){var n=t.pendingProps,s=n.revealOrder,a=n.tail;if(qr(e,t,n.children,r),n=Ft.current,n&2)n=n&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&W1(e,r,t);else if(e.tag===19)W1(e,r,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}n&=1}if(wt(Ft,n),!(t.mode&1))t.memoizedState=null;else switch(s){case"forwards":for(r=t.child,s=null;r!==null;)e=r.alternate,e!==null&&Eh(e)===null&&(s=r),r=r.sibling;r=s,r===null?(s=t.child,t.child=null):(s=r.sibling,r.sibling=null),O0(t,!1,s,r,a);break;case"backwards":for(r=null,s=t.child,t.child=null;s!==null;){if(e=s.alternate,e!==null&&Eh(e)===null){t.child=s;break}e=s.sibling,s.sibling=r,r=s,s=e}O0(t,!0,r,null,a);break;case"together":O0(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function Hf(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function la(e,t,r){if(e!==null&&(t.dependencies=e.dependencies),$i|=t.lanes,!(r&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(_e(153));if(t.child!==null){for(e=t.child,r=Ya(e,e.pendingProps),t.child=r,r.return=t;e.sibling!==null;)e=e.sibling,r=r.sibling=Ya(e,e.pendingProps),r.return=t;r.sibling=null}return t.child}function tN(e,t,r){switch(t.tag){case 3:z2(t),tl();break;case 5:g2(t);break;case 1:dn(t.type)&&gh(t);break;case 4:_g(t,t.stateNode.containerInfo);break;case 10:var n=t.type._context,s=t.memoizedProps.value;wt(yh,n._currentValue),n._currentValue=s;break;case 13:if(n=t.memoizedState,n!==null)return n.dehydrated!==null?(wt(Ft,Ft.current&1),t.flags|=128,null):r&t.child.childLanes?$2(e,t,r):(wt(Ft,Ft.current&1),e=la(e,t,r),e!==null?e.sibling:null);wt(Ft,Ft.current&1);break;case 19:if(n=(r&t.childLanes)!==0,e.flags&128){if(n)return W2(e,t,r);t.flags|=128}if(s=t.memoizedState,s!==null&&(s.rendering=null,s.tail=null,s.lastEffect=null),wt(Ft,Ft.current),n)break;return null;case 22:case 23:return t.lanes=0,U2(e,t,r)}return la(e,t,r)}var H2,Km,G2,K2;H2=function(e,t){for(var r=t.child;r!==null;){if(r.tag===5||r.tag===6)e.appendChild(r.stateNode);else if(r.tag!==4&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===t)break;for(;r.sibling===null;){if(r.return===null||r.return===t)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};Km=function(){};G2=function(e,t,r,n){var s=e.memoizedProps;if(s!==n){e=t.stateNode,Ni(Ts.current);var a=null;switch(r){case"input":s=pm(e,s),n=pm(e,n),a=[];break;case"select":s=Mt({},s,{value:void 0}),n=Mt({},n,{value:void 0}),a=[];break;case"textarea":s=xm(e,s),n=xm(e,n),a=[];break;default:typeof s.onClick!="function"&&typeof n.onClick=="function"&&(e.onclick=mh)}_m(r,n);var i;r=null;for(c in s)if(!n.hasOwnProperty(c)&&s.hasOwnProperty(c)&&s[c]!=null)if(c==="style"){var o=s[c];for(i in o)o.hasOwnProperty(i)&&(r||(r={}),r[i]="")}else c!=="dangerouslySetInnerHTML"&&c!=="children"&&c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&c!=="autoFocus"&&(Dc.hasOwnProperty(c)?a||(a=[]):(a=a||[]).push(c,null));for(c in n){var l=n[c];if(o=s!=null?s[c]:void 0,n.hasOwnProperty(c)&&l!==o&&(l!=null||o!=null))if(c==="style")if(o){for(i in o)!o.hasOwnProperty(i)||l&&l.hasOwnProperty(i)||(r||(r={}),r[i]="");for(i in l)l.hasOwnProperty(i)&&o[i]!==l[i]&&(r||(r={}),r[i]=l[i])}else r||(a||(a=[]),a.push(c,r)),r=l;else c==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,o=o?o.__html:void 0,l!=null&&o!==l&&(a=a||[]).push(c,l)):c==="children"?typeof l!="string"&&typeof l!="number"||(a=a||[]).push(c,""+l):c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&(Dc.hasOwnProperty(c)?(l!=null&&c==="onScroll"&&It("scroll",e),a||o===l||(a=[])):(a=a||[]).push(c,l))}r&&(a=a||[]).push("style",r);var c=a;(t.updateQueue=c)&&(t.flags|=4)}};K2=function(e,t,r,n){r!==n&&(t.flags|=4)};function Wl(e,t){if(!Pt)switch(e.tailMode){case"hidden":t=e.tail;for(var r=null;t!==null;)t.alternate!==null&&(r=t),t=t.sibling;r===null?e.tail=null:r.sibling=null;break;case"collapsed":r=e.tail;for(var n=null;r!==null;)r.alternate!==null&&(n=r),r=r.sibling;n===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:n.sibling=null}}function Dr(e){var t=e.alternate!==null&&e.alternate.child===e.child,r=0,n=0;if(t)for(var s=e.child;s!==null;)r|=s.lanes|s.childLanes,n|=s.subtreeFlags&14680064,n|=s.flags&14680064,s.return=e,s=s.sibling;else for(s=e.child;s!==null;)r|=s.lanes|s.childLanes,n|=s.subtreeFlags,n|=s.flags,s.return=e,s=s.sibling;return e.subtreeFlags|=n,e.childLanes=r,t}function rN(e,t,r){var n=t.pendingProps;switch(dg(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Dr(t),null;case 1:return dn(t.type)&&ph(),Dr(t),null;case 3:return n=t.stateNode,nl(),Nt(hn),Nt(Wr),Eg(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(e===null||e.child===null)&&(pf(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,es!==null&&(tp(es),es=null))),Km(e,t),Dr(t),null;case 5:wg(t);var s=Ni(Hc.current);if(r=t.type,e!==null&&t.stateNode!=null)G2(e,t,r,n,s),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!n){if(t.stateNode===null)throw Error(_e(166));return Dr(t),null}if(e=Ni(Ts.current),pf(t)){n=t.stateNode,r=t.type;var a=t.memoizedProps;switch(n[ys]=t,n[$c]=a,e=(t.mode&1)!==0,r){case"dialog":It("cancel",n),It("close",n);break;case"iframe":case"object":case"embed":It("load",n);break;case"video":case"audio":for(s=0;s<Zl.length;s++)It(Zl[s],n);break;case"source":It("error",n);break;case"img":case"image":case"link":It("error",n),It("load",n);break;case"details":It("toggle",n);break;case"input":Zx(n,a),It("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!a.multiple},It("invalid",n);break;case"textarea":t1(n,a),It("invalid",n)}_m(r,a),s=null;for(var i in a)if(a.hasOwnProperty(i)){var o=a[i];i==="children"?typeof o=="string"?n.textContent!==o&&(a.suppressHydrationWarning!==!0&&mf(n.textContent,o,e),s=["children",o]):typeof o=="number"&&n.textContent!==""+o&&(a.suppressHydrationWarning!==!0&&mf(n.textContent,o,e),s=["children",""+o]):Dc.hasOwnProperty(i)&&o!=null&&i==="onScroll"&&It("scroll",n)}switch(r){case"input":af(n),e1(n,a,!0);break;case"textarea":af(n),r1(n);break;case"select":case"option":break;default:typeof a.onClick=="function"&&(n.onclick=mh)}n=s,t.updateQueue=n,n!==null&&(t.flags|=4)}else{i=s.nodeType===9?s:s.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=wE(r)),e==="http://www.w3.org/1999/xhtml"?r==="script"?(e=i.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof n.is=="string"?e=i.createElement(r,{is:n.is}):(e=i.createElement(r),r==="select"&&(i=e,n.multiple?i.multiple=!0:n.size&&(i.size=n.size))):e=i.createElementNS(e,r),e[ys]=t,e[$c]=n,H2(e,t,!1,!1),t.stateNode=e;e:{switch(i=wm(r,n),r){case"dialog":It("cancel",e),It("close",e),s=n;break;case"iframe":case"object":case"embed":It("load",e),s=n;break;case"video":case"audio":for(s=0;s<Zl.length;s++)It(Zl[s],e);s=n;break;case"source":It("error",e),s=n;break;case"img":case"image":case"link":It("error",e),It("load",e),s=n;break;case"details":It("toggle",e),s=n;break;case"input":Zx(e,n),s=pm(e,n),It("invalid",e);break;case"option":s=n;break;case"select":e._wrapperState={wasMultiple:!!n.multiple},s=Mt({},n,{value:void 0}),It("invalid",e);break;case"textarea":t1(e,n),s=xm(e,n),It("invalid",e);break;default:s=n}_m(r,s),o=s;for(a in o)if(o.hasOwnProperty(a)){var l=o[a];a==="style"?kE(e,l):a==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&EE(e,l)):a==="children"?typeof l=="string"?(r!=="textarea"||l!=="")&&Fc(e,l):typeof l=="number"&&Fc(e,""+l):a!=="suppressContentEditableWarning"&&a!=="suppressHydrationWarning"&&a!=="autoFocus"&&(Dc.hasOwnProperty(a)?l!=null&&a==="onScroll"&&It("scroll",e):l!=null&&Jp(e,a,l,i))}switch(r){case"input":af(e),e1(e,n,!1);break;case"textarea":af(e),r1(e);break;case"option":n.value!=null&&e.setAttribute("value",""+ni(n.value));break;case"select":e.multiple=!!n.multiple,a=n.value,a!=null?Vo(e,!!n.multiple,a,!1):n.defaultValue!=null&&Vo(e,!!n.multiple,n.defaultValue,!0);break;default:typeof s.onClick=="function"&&(e.onclick=mh)}switch(r){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}}n&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return Dr(t),null;case 6:if(e&&t.stateNode!=null)K2(e,t,e.memoizedProps,n);else{if(typeof n!="string"&&t.stateNode===null)throw Error(_e(166));if(r=Ni(Hc.current),Ni(Ts.current),pf(t)){if(n=t.stateNode,r=t.memoizedProps,n[ys]=t,(a=n.nodeValue!==r)&&(e=kn,e!==null))switch(e.tag){case 3:mf(n.nodeValue,r,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&mf(n.nodeValue,r,(e.mode&1)!==0)}a&&(t.flags|=4)}else n=(r.nodeType===9?r:r.ownerDocument).createTextNode(n),n[ys]=t,t.stateNode=n}return Dr(t),null;case 13:if(Nt(Ft),n=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(Pt&&En!==null&&t.mode&1&&!(t.flags&128))f2(),tl(),t.flags|=98560,a=!1;else if(a=pf(t),n!==null&&n.dehydrated!==null){if(e===null){if(!a)throw Error(_e(318));if(a=t.memoizedState,a=a!==null?a.dehydrated:null,!a)throw Error(_e(317));a[ys]=t}else tl(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;Dr(t),a=!1}else es!==null&&(tp(es),es=null),a=!0;if(!a)return t.flags&65536?t:null}return t.flags&128?(t.lanes=r,t):(n=n!==null,n!==(e!==null&&e.memoizedState!==null)&&n&&(t.child.flags|=8192,t.mode&1&&(e===null||Ft.current&1?nr===0&&(nr=3):Fg())),t.updateQueue!==null&&(t.flags|=4),Dr(t),null);case 4:return nl(),Km(e,t),e===null&&Bc(t.stateNode.containerInfo),Dr(t),null;case 10:return vg(t.type._context),Dr(t),null;case 17:return dn(t.type)&&ph(),Dr(t),null;case 19:if(Nt(Ft),a=t.memoizedState,a===null)return Dr(t),null;if(n=(t.flags&128)!==0,i=a.rendering,i===null)if(n)Wl(a,!1);else{if(nr!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(i=Eh(e),i!==null){for(t.flags|=128,Wl(a,!1),n=i.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),t.subtreeFlags=0,n=r,r=t.child;r!==null;)a=r,e=n,a.flags&=14680066,i=a.alternate,i===null?(a.childLanes=0,a.lanes=e,a.child=null,a.subtreeFlags=0,a.memoizedProps=null,a.memoizedState=null,a.updateQueue=null,a.dependencies=null,a.stateNode=null):(a.childLanes=i.childLanes,a.lanes=i.lanes,a.child=i.child,a.subtreeFlags=0,a.deletions=null,a.memoizedProps=i.memoizedProps,a.memoizedState=i.memoizedState,a.updateQueue=i.updateQueue,a.type=i.type,e=i.dependencies,a.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),r=r.sibling;return wt(Ft,Ft.current&1|2),t.child}e=e.sibling}a.tail!==null&&Wt()>al&&(t.flags|=128,n=!0,Wl(a,!1),t.lanes=4194304)}else{if(!n)if(e=Eh(i),e!==null){if(t.flags|=128,n=!0,r=e.updateQueue,r!==null&&(t.updateQueue=r,t.flags|=4),Wl(a,!0),a.tail===null&&a.tailMode==="hidden"&&!i.alternate&&!Pt)return Dr(t),null}else 2*Wt()-a.renderingStartTime>al&&r!==1073741824&&(t.flags|=128,n=!0,Wl(a,!1),t.lanes=4194304);a.isBackwards?(i.sibling=t.child,t.child=i):(r=a.last,r!==null?r.sibling=i:t.child=i,a.last=i)}return a.tail!==null?(t=a.tail,a.rendering=t,a.tail=t.sibling,a.renderingStartTime=Wt(),t.sibling=null,r=Ft.current,wt(Ft,n?r&1|2:r&1),t):(Dr(t),null);case 22:case 23:return Dg(),n=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==n&&(t.flags|=8192),n&&t.mode&1?xn&1073741824&&(Dr(t),t.subtreeFlags&6&&(t.flags|=8192)):Dr(t),null;case 24:return null;case 25:return null}throw Error(_e(156,t.tag))}function nN(e,t){switch(dg(t),t.tag){case 1:return dn(t.type)&&ph(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return nl(),Nt(hn),Nt(Wr),Eg(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return wg(t),null;case 13:if(Nt(Ft),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(_e(340));tl()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return Nt(Ft),null;case 4:return nl(),null;case 10:return vg(t.type._context),null;case 22:case 23:return Dg(),null;case 24:return null;default:return null}}var xf=!1,jr=!1,sN=typeof WeakSet=="function"?WeakSet:Set,Ne=null;function Mo(e,t){var r=e.ref;if(r!==null)if(typeof r=="function")try{r(null)}catch(n){Vt(e,t,n)}else r.current=null}function qm(e,t,r){try{r()}catch(n){Vt(e,t,n)}}var H1=!1;function aN(e,t){if(bm=fh,e=JE(),fg(e)){if("selectionStart"in e)var r={start:e.selectionStart,end:e.selectionEnd};else e:{r=(r=e.ownerDocument)&&r.defaultView||window;var n=r.getSelection&&r.getSelection();if(n&&n.rangeCount!==0){r=n.anchorNode;var s=n.anchorOffset,a=n.focusNode;n=n.focusOffset;try{r.nodeType,a.nodeType}catch{r=null;break e}var i=0,o=-1,l=-1,c=0,u=0,d=e,m=null;t:for(;;){for(var p;d!==r||s!==0&&d.nodeType!==3||(o=i+s),d!==a||n!==0&&d.nodeType!==3||(l=i+n),d.nodeType===3&&(i+=d.nodeValue.length),(p=d.firstChild)!==null;)m=d,d=p;for(;;){if(d===e)break t;if(m===r&&++c===s&&(o=i),m===a&&++u===n&&(l=i),(p=d.nextSibling)!==null)break;d=m,m=d.parentNode}d=p}r=o===-1||l===-1?null:{start:o,end:l}}else r=null}r=r||{start:0,end:0}}else r=null;for(Pm={focusedElem:e,selectionRange:r},fh=!1,Ne=t;Ne!==null;)if(t=Ne,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,Ne=e;else for(;Ne!==null;){t=Ne;try{var g=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(g!==null){var x=g.memoizedProps,w=g.memoizedState,k=t.stateNode,T=k.getSnapshotBeforeUpdate(t.elementType===t.type?x:Qn(t.type,x),w);k.__reactInternalSnapshotBeforeUpdate=T}break;case 3:var E=t.stateNode.containerInfo;E.nodeType===1?E.textContent="":E.nodeType===9&&E.documentElement&&E.removeChild(E.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(_e(163))}}catch(N){Vt(t,t.return,N)}if(e=t.sibling,e!==null){e.return=t.return,Ne=e;break}Ne=t.return}return g=H1,H1=!1,g}function pc(e,t,r){var n=t.updateQueue;if(n=n!==null?n.lastEffect:null,n!==null){var s=n=n.next;do{if((s.tag&e)===e){var a=s.destroy;s.destroy=void 0,a!==void 0&&qm(t,r,a)}s=s.next}while(s!==n)}}function _d(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var r=t=t.next;do{if((r.tag&e)===e){var n=r.create;r.destroy=n()}r=r.next}while(r!==t)}}function Xm(e){var t=e.ref;if(t!==null){var r=e.stateNode;switch(e.tag){case 5:e=r;break;default:e=r}typeof t=="function"?t(e):t.current=e}}function q2(e){var t=e.alternate;t!==null&&(e.alternate=null,q2(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[ys],delete t[$c],delete t[Om],delete t[B4],delete t[z4])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function X2(e){return e.tag===5||e.tag===3||e.tag===4}function G1(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||X2(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function Ym(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.nodeType===8?r.parentNode.insertBefore(e,t):r.insertBefore(e,t):(r.nodeType===8?(t=r.parentNode,t.insertBefore(e,r)):(t=r,t.appendChild(e)),r=r._reactRootContainer,r!=null||t.onclick!==null||(t.onclick=mh));else if(n!==4&&(e=e.child,e!==null))for(Ym(e,t,r),e=e.sibling;e!==null;)Ym(e,t,r),e=e.sibling}function Qm(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.insertBefore(e,t):r.appendChild(e);else if(n!==4&&(e=e.child,e!==null))for(Qm(e,t,r),e=e.sibling;e!==null;)Qm(e,t,r),e=e.sibling}var vr=null,Jn=!1;function ka(e,t,r){for(r=r.child;r!==null;)Y2(e,t,r),r=r.sibling}function Y2(e,t,r){if(Es&&typeof Es.onCommitFiberUnmount=="function")try{Es.onCommitFiberUnmount(hd,r)}catch{}switch(r.tag){case 5:jr||Mo(r,t);case 6:var n=vr,s=Jn;vr=null,ka(e,t,r),vr=n,Jn=s,vr!==null&&(Jn?(e=vr,r=r.stateNode,e.nodeType===8?e.parentNode.removeChild(r):e.removeChild(r)):vr.removeChild(r.stateNode));break;case 18:vr!==null&&(Jn?(e=vr,r=r.stateNode,e.nodeType===8?C0(e.parentNode,r):e.nodeType===1&&C0(e,r),jc(e)):C0(vr,r.stateNode));break;case 4:n=vr,s=Jn,vr=r.stateNode.containerInfo,Jn=!0,ka(e,t,r),vr=n,Jn=s;break;case 0:case 11:case 14:case 15:if(!jr&&(n=r.updateQueue,n!==null&&(n=n.lastEffect,n!==null))){s=n=n.next;do{var a=s,i=a.destroy;a=a.tag,i!==void 0&&(a&2||a&4)&&qm(r,t,i),s=s.next}while(s!==n)}ka(e,t,r);break;case 1:if(!jr&&(Mo(r,t),n=r.stateNode,typeof n.componentWillUnmount=="function"))try{n.props=r.memoizedProps,n.state=r.memoizedState,n.componentWillUnmount()}catch(o){Vt(r,t,o)}ka(e,t,r);break;case 21:ka(e,t,r);break;case 22:r.mode&1?(jr=(n=jr)||r.memoizedState!==null,ka(e,t,r),jr=n):ka(e,t,r);break;default:ka(e,t,r)}}function K1(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var r=e.stateNode;r===null&&(r=e.stateNode=new sN),t.forEach(function(n){var s=mN.bind(null,e,n);r.has(n)||(r.add(n),n.then(s,s))})}}function qn(e,t){var r=t.deletions;if(r!==null)for(var n=0;n<r.length;n++){var s=r[n];try{var a=e,i=t,o=i;e:for(;o!==null;){switch(o.tag){case 5:vr=o.stateNode,Jn=!1;break e;case 3:vr=o.stateNode.containerInfo,Jn=!0;break e;case 4:vr=o.stateNode.containerInfo,Jn=!0;break e}o=o.return}if(vr===null)throw Error(_e(160));Y2(a,i,s),vr=null,Jn=!1;var l=s.alternate;l!==null&&(l.return=null),s.return=null}catch(c){Vt(s,t,c)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)Q2(t,e),t=t.sibling}function Q2(e,t){var r=e.alternate,n=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(qn(t,e),ps(e),n&4){try{pc(3,e,e.return),_d(3,e)}catch(x){Vt(e,e.return,x)}try{pc(5,e,e.return)}catch(x){Vt(e,e.return,x)}}break;case 1:qn(t,e),ps(e),n&512&&r!==null&&Mo(r,r.return);break;case 5:if(qn(t,e),ps(e),n&512&&r!==null&&Mo(r,r.return),e.flags&32){var s=e.stateNode;try{Fc(s,"")}catch(x){Vt(e,e.return,x)}}if(n&4&&(s=e.stateNode,s!=null)){var a=e.memoizedProps,i=r!==null?r.memoizedProps:a,o=e.type,l=e.updateQueue;if(e.updateQueue=null,l!==null)try{o==="input"&&a.type==="radio"&&a.name!=null&&yE(s,a),wm(o,i);var c=wm(o,a);for(i=0;i<l.length;i+=2){var u=l[i],d=l[i+1];u==="style"?kE(s,d):u==="dangerouslySetInnerHTML"?EE(s,d):u==="children"?Fc(s,d):Jp(s,u,d,c)}switch(o){case"input":gm(s,a);break;case"textarea":_E(s,a);break;case"select":var m=s._wrapperState.wasMultiple;s._wrapperState.wasMultiple=!!a.multiple;var p=a.value;p!=null?Vo(s,!!a.multiple,p,!1):m!==!!a.multiple&&(a.defaultValue!=null?Vo(s,!!a.multiple,a.defaultValue,!0):Vo(s,!!a.multiple,a.multiple?[]:"",!1))}s[$c]=a}catch(x){Vt(e,e.return,x)}}break;case 6:if(qn(t,e),ps(e),n&4){if(e.stateNode===null)throw Error(_e(162));s=e.stateNode,a=e.memoizedProps;try{s.nodeValue=a}catch(x){Vt(e,e.return,x)}}break;case 3:if(qn(t,e),ps(e),n&4&&r!==null&&r.memoizedState.isDehydrated)try{jc(t.containerInfo)}catch(x){Vt(e,e.return,x)}break;case 4:qn(t,e),ps(e);break;case 13:qn(t,e),ps(e),s=e.child,s.flags&8192&&(a=s.memoizedState!==null,s.stateNode.isHidden=a,!a||s.alternate!==null&&s.alternate.memoizedState!==null||(bg=Wt())),n&4&&K1(e);break;case 22:if(u=r!==null&&r.memoizedState!==null,e.mode&1?(jr=(c=jr)||u,qn(t,e),jr=c):qn(t,e),ps(e),n&8192){if(c=e.memoizedState!==null,(e.stateNode.isHidden=c)&&!u&&e.mode&1)for(Ne=e,u=e.child;u!==null;){for(d=Ne=u;Ne!==null;){switch(m=Ne,p=m.child,m.tag){case 0:case 11:case 14:case 15:pc(4,m,m.return);break;case 1:Mo(m,m.return);var g=m.stateNode;if(typeof g.componentWillUnmount=="function"){n=m,r=m.return;try{t=n,g.props=t.memoizedProps,g.state=t.memoizedState,g.componentWillUnmount()}catch(x){Vt(n,r,x)}}break;case 5:Mo(m,m.return);break;case 22:if(m.memoizedState!==null){X1(d);continue}}p!==null?(p.return=m,Ne=p):X1(d)}u=u.sibling}e:for(u=null,d=e;;){if(d.tag===5){if(u===null){u=d;try{s=d.stateNode,c?(a=s.style,typeof a.setProperty=="function"?a.setProperty("display","none","important"):a.display="none"):(o=d.stateNode,l=d.memoizedProps.style,i=l!=null&&l.hasOwnProperty("display")?l.display:null,o.style.display=TE("display",i))}catch(x){Vt(e,e.return,x)}}}else if(d.tag===6){if(u===null)try{d.stateNode.nodeValue=c?"":d.memoizedProps}catch(x){Vt(e,e.return,x)}}else if((d.tag!==22&&d.tag!==23||d.memoizedState===null||d===e)&&d.child!==null){d.child.return=d,d=d.child;continue}if(d===e)break e;for(;d.sibling===null;){if(d.return===null||d.return===e)break e;u===d&&(u=null),d=d.return}u===d&&(u=null),d.sibling.return=d.return,d=d.sibling}}break;case 19:qn(t,e),ps(e),n&4&&K1(e);break;case 21:break;default:qn(t,e),ps(e)}}function ps(e){var t=e.flags;if(t&2){try{e:{for(var r=e.return;r!==null;){if(X2(r)){var n=r;break e}r=r.return}throw Error(_e(160))}switch(n.tag){case 5:var s=n.stateNode;n.flags&32&&(Fc(s,""),n.flags&=-33);var a=G1(e);Qm(e,a,s);break;case 3:case 4:var i=n.stateNode.containerInfo,o=G1(e);Ym(e,o,i);break;default:throw Error(_e(161))}}catch(l){Vt(e,e.return,l)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function iN(e,t,r){Ne=e,J2(e)}function J2(e,t,r){for(var n=(e.mode&1)!==0;Ne!==null;){var s=Ne,a=s.child;if(s.tag===22&&n){var i=s.memoizedState!==null||xf;if(!i){var o=s.alternate,l=o!==null&&o.memoizedState!==null||jr;o=xf;var c=jr;if(xf=i,(jr=l)&&!c)for(Ne=s;Ne!==null;)i=Ne,l=i.child,i.tag===22&&i.memoizedState!==null?Y1(s):l!==null?(l.return=i,Ne=l):Y1(s);for(;a!==null;)Ne=a,J2(a),a=a.sibling;Ne=s,xf=o,jr=c}q1(e)}else s.subtreeFlags&8772&&a!==null?(a.return=s,Ne=a):q1(e)}}function q1(e){for(;Ne!==null;){var t=Ne;if(t.flags&8772){var r=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:jr||_d(5,t);break;case 1:var n=t.stateNode;if(t.flags&4&&!jr)if(r===null)n.componentDidMount();else{var s=t.elementType===t.type?r.memoizedProps:Qn(t.type,r.memoizedProps);n.componentDidUpdate(s,r.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var a=t.updateQueue;a!==null&&P1(t,a,n);break;case 3:var i=t.updateQueue;if(i!==null){if(r=null,t.child!==null)switch(t.child.tag){case 5:r=t.child.stateNode;break;case 1:r=t.child.stateNode}P1(t,i,r)}break;case 5:var o=t.stateNode;if(r===null&&t.flags&4){r=o;var l=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&r.focus();break;case"img":l.src&&(r.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var c=t.alternate;if(c!==null){var u=c.memoizedState;if(u!==null){var d=u.dehydrated;d!==null&&jc(d)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(_e(163))}jr||t.flags&512&&Xm(t)}catch(m){Vt(t,t.return,m)}}if(t===e){Ne=null;break}if(r=t.sibling,r!==null){r.return=t.return,Ne=r;break}Ne=t.return}}function X1(e){for(;Ne!==null;){var t=Ne;if(t===e){Ne=null;break}var r=t.sibling;if(r!==null){r.return=t.return,Ne=r;break}Ne=t.return}}function Y1(e){for(;Ne!==null;){var t=Ne;try{switch(t.tag){case 0:case 11:case 15:var r=t.return;try{_d(4,t)}catch(l){Vt(t,r,l)}break;case 1:var n=t.stateNode;if(typeof n.componentDidMount=="function"){var s=t.return;try{n.componentDidMount()}catch(l){Vt(t,s,l)}}var a=t.return;try{Xm(t)}catch(l){Vt(t,a,l)}break;case 5:var i=t.return;try{Xm(t)}catch(l){Vt(t,i,l)}}}catch(l){Vt(t,t.return,l)}if(t===e){Ne=null;break}var o=t.sibling;if(o!==null){o.return=t.return,Ne=o;break}Ne=t.return}}var oN=Math.ceil,Sh=va.ReactCurrentDispatcher,Ng=va.ReactCurrentOwner,Vn=va.ReactCurrentBatchConfig,it=0,dr=null,Jt=null,wr=0,xn=0,Lo=di(0),nr=0,Xc=null,$i=0,wd=0,Rg=0,gc=null,cn=null,bg=0,al=1/0,Hs=null,Ah=!1,Jm=null,qa=null,yf=!1,ja=null,Ih=0,vc=0,Zm=null,Gf=-1,Kf=0;function Jr(){return it&6?Wt():Gf!==-1?Gf:Gf=Wt()}function Xa(e){return e.mode&1?it&2&&wr!==0?wr&-wr:W4.transition!==null?(Kf===0&&(Kf=ME()),Kf):(e=gt,e!==0||(e=window.event,e=e===void 0?16:$E(e.type)),e):1}function os(e,t,r,n){if(50<vc)throw vc=0,Zm=null,Error(_e(185));xu(e,r,n),(!(it&2)||e!==dr)&&(e===dr&&(!(it&2)&&(wd|=r),nr===4&&Pa(e,wr)),mn(e,n),r===1&&it===0&&!(t.mode&1)&&(al=Wt()+500,vd&&mi()))}function mn(e,t){var r=e.callbackNode;WC(e,t);var n=uh(e,e===dr?wr:0);if(n===0)r!==null&&a1(r),e.callbackNode=null,e.callbackPriority=0;else if(t=n&-n,e.callbackPriority!==t){if(r!=null&&a1(r),t===1)e.tag===0?$4(Q1.bind(null,e)):l2(Q1.bind(null,e)),V4(function(){!(it&6)&&mi()}),r=null;else{switch(LE(n)){case 1:r=ng;break;case 4:r=FE;break;case 16:r=ch;break;case 536870912:r=OE;break;default:r=ch}r=iT(r,Z2.bind(null,e))}e.callbackPriority=t,e.callbackNode=r}}function Z2(e,t){if(Gf=-1,Kf=0,it&6)throw Error(_e(327));var r=e.callbackNode;if(Wo()&&e.callbackNode!==r)return null;var n=uh(e,e===dr?wr:0);if(n===0)return null;if(n&30||n&e.expiredLanes||t)t=Ch(e,n);else{t=n;var s=it;it|=2;var a=tT();(dr!==e||wr!==t)&&(Hs=null,al=Wt()+500,Fi(e,t));do try{uN();break}catch(o){eT(e,o)}while(!0);gg(),Sh.current=a,it=s,Jt!==null?t=0:(dr=null,wr=0,t=nr)}if(t!==0){if(t===2&&(s=Am(e),s!==0&&(n=s,t=ep(e,s))),t===1)throw r=Xc,Fi(e,0),Pa(e,n),mn(e,Wt()),r;if(t===6)Pa(e,n);else{if(s=e.current.alternate,!(n&30)&&!lN(s)&&(t=Ch(e,n),t===2&&(a=Am(e),a!==0&&(n=a,t=ep(e,a))),t===1))throw r=Xc,Fi(e,0),Pa(e,n),mn(e,Wt()),r;switch(e.finishedWork=s,e.finishedLanes=n,t){case 0:case 1:throw Error(_e(345));case 2:Ei(e,cn,Hs);break;case 3:if(Pa(e,n),(n&130023424)===n&&(t=bg+500-Wt(),10<t)){if(uh(e,0)!==0)break;if(s=e.suspendedLanes,(s&n)!==n){Jr(),e.pingedLanes|=e.suspendedLanes&s;break}e.timeoutHandle=Fm(Ei.bind(null,e,cn,Hs),t);break}Ei(e,cn,Hs);break;case 4:if(Pa(e,n),(n&4194240)===n)break;for(t=e.eventTimes,s=-1;0<n;){var i=31-is(n);a=1<<i,i=t[i],i>s&&(s=i),n&=~a}if(n=s,n=Wt()-n,n=(120>n?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*oN(n/1960))-n,10<n){e.timeoutHandle=Fm(Ei.bind(null,e,cn,Hs),n);break}Ei(e,cn,Hs);break;case 5:Ei(e,cn,Hs);break;default:throw Error(_e(329))}}}return mn(e,Wt()),e.callbackNode===r?Z2.bind(null,e):null}function ep(e,t){var r=gc;return e.current.memoizedState.isDehydrated&&(Fi(e,t).flags|=256),e=Ch(e,t),e!==2&&(t=cn,cn=r,t!==null&&tp(t)),e}function tp(e){cn===null?cn=e:cn.push.apply(cn,e)}function lN(e){for(var t=e;;){if(t.flags&16384){var r=t.updateQueue;if(r!==null&&(r=r.stores,r!==null))for(var n=0;n<r.length;n++){var s=r[n],a=s.getSnapshot;s=s.value;try{if(!us(a(),s))return!1}catch{return!1}}}if(r=t.child,t.subtreeFlags&16384&&r!==null)r.return=t,t=r;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function Pa(e,t){for(t&=~Rg,t&=~wd,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var r=31-is(t),n=1<<r;e[r]=-1,t&=~n}}function Q1(e){if(it&6)throw Error(_e(327));Wo();var t=uh(e,0);if(!(t&1))return mn(e,Wt()),null;var r=Ch(e,t);if(e.tag!==0&&r===2){var n=Am(e);n!==0&&(t=n,r=ep(e,n))}if(r===1)throw r=Xc,Fi(e,0),Pa(e,t),mn(e,Wt()),r;if(r===6)throw Error(_e(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,Ei(e,cn,Hs),mn(e,Wt()),null}function Pg(e,t){var r=it;it|=1;try{return e(t)}finally{it=r,it===0&&(al=Wt()+500,vd&&mi())}}function Wi(e){ja!==null&&ja.tag===0&&!(it&6)&&Wo();var t=it;it|=1;var r=Vn.transition,n=gt;try{if(Vn.transition=null,gt=1,e)return e()}finally{gt=n,Vn.transition=r,it=t,!(it&6)&&mi()}}function Dg(){xn=Lo.current,Nt(Lo)}function Fi(e,t){e.finishedWork=null,e.finishedLanes=0;var r=e.timeoutHandle;if(r!==-1&&(e.timeoutHandle=-1,j4(r)),Jt!==null)for(r=Jt.return;r!==null;){var n=r;switch(dg(n),n.tag){case 1:n=n.type.childContextTypes,n!=null&&ph();break;case 3:nl(),Nt(hn),Nt(Wr),Eg();break;case 5:wg(n);break;case 4:nl();break;case 13:Nt(Ft);break;case 19:Nt(Ft);break;case 10:vg(n.type._context);break;case 22:case 23:Dg()}r=r.return}if(dr=e,Jt=e=Ya(e.current,null),wr=xn=t,nr=0,Xc=null,Rg=wd=$i=0,cn=gc=null,Ci!==null){for(t=0;t<Ci.length;t++)if(r=Ci[t],n=r.interleaved,n!==null){r.interleaved=null;var s=n.next,a=r.pending;if(a!==null){var i=a.next;a.next=s,n.next=i}r.pending=n}Ci=null}return e}function eT(e,t){do{var r=Jt;try{if(gg(),$f.current=kh,Th){for(var n=Ot.memoizedState;n!==null;){var s=n.queue;s!==null&&(s.pending=null),n=n.next}Th=!1}if(zi=0,hr=rr=Ot=null,mc=!1,Gc=0,Ng.current=null,r===null||r.return===null){nr=1,Xc=t,Jt=null;break}e:{var a=e,i=r.return,o=r,l=t;if(t=wr,o.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var c=l,u=o,d=u.tag;if(!(u.mode&1)&&(d===0||d===11||d===15)){var m=u.alternate;m?(u.updateQueue=m.updateQueue,u.memoizedState=m.memoizedState,u.lanes=m.lanes):(u.updateQueue=null,u.memoizedState=null)}var p=j1(i);if(p!==null){p.flags&=-257,V1(p,i,o,a,t),p.mode&1&&L1(a,c,t),t=p,l=c;var g=t.updateQueue;if(g===null){var x=new Set;x.add(l),t.updateQueue=x}else g.add(l);break e}else{if(!(t&1)){L1(a,c,t),Fg();break e}l=Error(_e(426))}}else if(Pt&&o.mode&1){var w=j1(i);if(w!==null){!(w.flags&65536)&&(w.flags|=256),V1(w,i,o,a,t),mg(sl(l,o));break e}}a=l=sl(l,o),nr!==4&&(nr=2),gc===null?gc=[a]:gc.push(a),a=i;do{switch(a.tag){case 3:a.flags|=65536,t&=-t,a.lanes|=t;var k=L2(a,l,t);b1(a,k);break e;case 1:o=l;var T=a.type,E=a.stateNode;if(!(a.flags&128)&&(typeof T.getDerivedStateFromError=="function"||E!==null&&typeof E.componentDidCatch=="function"&&(qa===null||!qa.has(E)))){a.flags|=65536,t&=-t,a.lanes|=t;var N=j2(a,o,t);b1(a,N);break e}}a=a.return}while(a!==null)}nT(r)}catch(M){t=M,Jt===r&&r!==null&&(Jt=r=r.return);continue}break}while(!0)}function tT(){var e=Sh.current;return Sh.current=kh,e===null?kh:e}function Fg(){(nr===0||nr===3||nr===2)&&(nr=4),dr===null||!($i&268435455)&&!(wd&268435455)||Pa(dr,wr)}function Ch(e,t){var r=it;it|=2;var n=tT();(dr!==e||wr!==t)&&(Hs=null,Fi(e,t));do try{cN();break}catch(s){eT(e,s)}while(!0);if(gg(),it=r,Sh.current=n,Jt!==null)throw Error(_e(261));return dr=null,wr=0,nr}function cN(){for(;Jt!==null;)rT(Jt)}function uN(){for(;Jt!==null&&!OC();)rT(Jt)}function rT(e){var t=aT(e.alternate,e,xn);e.memoizedProps=e.pendingProps,t===null?nT(e):Jt=t,Ng.current=null}function nT(e){var t=e;do{var r=t.alternate;if(e=t.return,t.flags&32768){if(r=nN(r,t),r!==null){r.flags&=32767,Jt=r;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{nr=6,Jt=null;return}}else if(r=rN(r,t,xn),r!==null){Jt=r;return}if(t=t.sibling,t!==null){Jt=t;return}Jt=t=e}while(t!==null);nr===0&&(nr=5)}function Ei(e,t,r){var n=gt,s=Vn.transition;try{Vn.transition=null,gt=1,fN(e,t,r,n)}finally{Vn.transition=s,gt=n}return null}function fN(e,t,r,n){do Wo();while(ja!==null);if(it&6)throw Error(_e(327));r=e.finishedWork;var s=e.finishedLanes;if(r===null)return null;if(e.finishedWork=null,e.finishedLanes=0,r===e.current)throw Error(_e(177));e.callbackNode=null,e.callbackPriority=0;var a=r.lanes|r.childLanes;if(HC(e,a),e===dr&&(Jt=dr=null,wr=0),!(r.subtreeFlags&2064)&&!(r.flags&2064)||yf||(yf=!0,iT(ch,function(){return Wo(),null})),a=(r.flags&15990)!==0,r.subtreeFlags&15990||a){a=Vn.transition,Vn.transition=null;var i=gt;gt=1;var o=it;it|=4,Ng.current=null,aN(e,r),Q2(r,e),b4(Pm),fh=!!bm,Pm=bm=null,e.current=r,iN(r),MC(),it=o,gt=i,Vn.transition=a}else e.current=r;if(yf&&(yf=!1,ja=e,Ih=s),a=e.pendingLanes,a===0&&(qa=null),VC(r.stateNode),mn(e,Wt()),t!==null)for(n=e.onRecoverableError,r=0;r<t.length;r++)s=t[r],n(s.value,{componentStack:s.stack,digest:s.digest});if(Ah)throw Ah=!1,e=Jm,Jm=null,e;return Ih&1&&e.tag!==0&&Wo(),a=e.pendingLanes,a&1?e===Zm?vc++:(vc=0,Zm=e):vc=0,mi(),null}function Wo(){if(ja!==null){var e=LE(Ih),t=Vn.transition,r=gt;try{if(Vn.transition=null,gt=16>e?16:e,ja===null)var n=!1;else{if(e=ja,ja=null,Ih=0,it&6)throw Error(_e(331));var s=it;for(it|=4,Ne=e.current;Ne!==null;){var a=Ne,i=a.child;if(Ne.flags&16){var o=a.deletions;if(o!==null){for(var l=0;l<o.length;l++){var c=o[l];for(Ne=c;Ne!==null;){var u=Ne;switch(u.tag){case 0:case 11:case 15:pc(8,u,a)}var d=u.child;if(d!==null)d.return=u,Ne=d;else for(;Ne!==null;){u=Ne;var m=u.sibling,p=u.return;if(q2(u),u===c){Ne=null;break}if(m!==null){m.return=p,Ne=m;break}Ne=p}}}var g=a.alternate;if(g!==null){var x=g.child;if(x!==null){g.child=null;do{var w=x.sibling;x.sibling=null,x=w}while(x!==null)}}Ne=a}}if(a.subtreeFlags&2064&&i!==null)i.return=a,Ne=i;else e:for(;Ne!==null;){if(a=Ne,a.flags&2048)switch(a.tag){case 0:case 11:case 15:pc(9,a,a.return)}var k=a.sibling;if(k!==null){k.return=a.return,Ne=k;break e}Ne=a.return}}var T=e.current;for(Ne=T;Ne!==null;){i=Ne;var E=i.child;if(i.subtreeFlags&2064&&E!==null)E.return=i,Ne=E;else e:for(i=T;Ne!==null;){if(o=Ne,o.flags&2048)try{switch(o.tag){case 0:case 11:case 15:_d(9,o)}}catch(M){Vt(o,o.return,M)}if(o===i){Ne=null;break e}var N=o.sibling;if(N!==null){N.return=o.return,Ne=N;break e}Ne=o.return}}if(it=s,mi(),Es&&typeof Es.onPostCommitFiberRoot=="function")try{Es.onPostCommitFiberRoot(hd,e)}catch{}n=!0}return n}finally{gt=r,Vn.transition=t}}return!1}function J1(e,t,r){t=sl(r,t),t=L2(e,t,1),e=Ka(e,t,1),t=Jr(),e!==null&&(xu(e,1,t),mn(e,t))}function Vt(e,t,r){if(e.tag===3)J1(e,e,r);else for(;t!==null;){if(t.tag===3){J1(t,e,r);break}else if(t.tag===1){var n=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof n.componentDidCatch=="function"&&(qa===null||!qa.has(n))){e=sl(r,e),e=j2(t,e,1),t=Ka(t,e,1),e=Jr(),t!==null&&(xu(t,1,e),mn(t,e));break}}t=t.return}}function hN(e,t,r){var n=e.pingCache;n!==null&&n.delete(t),t=Jr(),e.pingedLanes|=e.suspendedLanes&r,dr===e&&(wr&r)===r&&(nr===4||nr===3&&(wr&130023424)===wr&&500>Wt()-bg?Fi(e,0):Rg|=r),mn(e,t)}function sT(e,t){t===0&&(e.mode&1?(t=cf,cf<<=1,!(cf&130023424)&&(cf=4194304)):t=1);var r=Jr();e=oa(e,t),e!==null&&(xu(e,t,r),mn(e,r))}function dN(e){var t=e.memoizedState,r=0;t!==null&&(r=t.retryLane),sT(e,r)}function mN(e,t){var r=0;switch(e.tag){case 13:var n=e.stateNode,s=e.memoizedState;s!==null&&(r=s.retryLane);break;case 19:n=e.stateNode;break;default:throw Error(_e(314))}n!==null&&n.delete(t),sT(e,r)}var aT;aT=function(e,t,r){if(e!==null)if(e.memoizedProps!==t.pendingProps||hn.current)fn=!0;else{if(!(e.lanes&r)&&!(t.flags&128))return fn=!1,tN(e,t,r);fn=!!(e.flags&131072)}else fn=!1,Pt&&t.flags&1048576&&c2(t,xh,t.index);switch(t.lanes=0,t.tag){case 2:var n=t.type;Hf(e,t),e=t.pendingProps;var s=el(t,Wr.current);$o(t,r),s=kg(null,t,n,e,s,r);var a=Sg();return t.flags|=1,typeof s=="object"&&s!==null&&typeof s.render=="function"&&s.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,dn(n)?(a=!0,gh(t)):a=!1,t.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,yg(t),s.updater=yd,t.stateNode=s,s._reactInternals=t,Bm(t,n,e,r),t=Wm(null,t,n,!0,a,r)):(t.tag=0,Pt&&a&&hg(t),qr(null,t,s,r),t=t.child),t;case 16:n=t.elementType;e:{switch(Hf(e,t),e=t.pendingProps,s=n._init,n=s(n._payload),t.type=n,s=t.tag=gN(n),e=Qn(n,e),s){case 0:t=$m(null,t,n,e,r);break e;case 1:t=z1(null,t,n,e,r);break e;case 11:t=U1(null,t,n,e,r);break e;case 14:t=B1(null,t,n,Qn(n.type,e),r);break e}throw Error(_e(306,n,""))}return t;case 0:return n=t.type,s=t.pendingProps,s=t.elementType===n?s:Qn(n,s),$m(e,t,n,s,r);case 1:return n=t.type,s=t.pendingProps,s=t.elementType===n?s:Qn(n,s),z1(e,t,n,s,r);case 3:e:{if(z2(t),e===null)throw Error(_e(387));n=t.pendingProps,a=t.memoizedState,s=a.element,p2(e,t),wh(t,n,null,r);var i=t.memoizedState;if(n=i.element,a.isDehydrated)if(a={element:n,isDehydrated:!1,cache:i.cache,pendingSuspenseBoundaries:i.pendingSuspenseBoundaries,transitions:i.transitions},t.updateQueue.baseState=a,t.memoizedState=a,t.flags&256){s=sl(Error(_e(423)),t),t=$1(e,t,n,r,s);break e}else if(n!==s){s=sl(Error(_e(424)),t),t=$1(e,t,n,r,s);break e}else for(En=Ga(t.stateNode.containerInfo.firstChild),kn=t,Pt=!0,es=null,r=d2(t,null,n,r),t.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if(tl(),n===s){t=la(e,t,r);break e}qr(e,t,n,r)}t=t.child}return t;case 5:return g2(t),e===null&&jm(t),n=t.type,s=t.pendingProps,a=e!==null?e.memoizedProps:null,i=s.children,Dm(n,s)?i=null:a!==null&&Dm(n,a)&&(t.flags|=32),B2(e,t),qr(e,t,i,r),t.child;case 6:return e===null&&jm(t),null;case 13:return $2(e,t,r);case 4:return _g(t,t.stateNode.containerInfo),n=t.pendingProps,e===null?t.child=rl(t,null,n,r):qr(e,t,n,r),t.child;case 11:return n=t.type,s=t.pendingProps,s=t.elementType===n?s:Qn(n,s),U1(e,t,n,s,r);case 7:return qr(e,t,t.pendingProps,r),t.child;case 8:return qr(e,t,t.pendingProps.children,r),t.child;case 12:return qr(e,t,t.pendingProps.children,r),t.child;case 10:e:{if(n=t.type._context,s=t.pendingProps,a=t.memoizedProps,i=s.value,wt(yh,n._currentValue),n._currentValue=i,a!==null)if(us(a.value,i)){if(a.children===s.children&&!hn.current){t=la(e,t,r);break e}}else for(a=t.child,a!==null&&(a.return=t);a!==null;){var o=a.dependencies;if(o!==null){i=a.child;for(var l=o.firstContext;l!==null;){if(l.context===n){if(a.tag===1){l=ea(-1,r&-r),l.tag=2;var c=a.updateQueue;if(c!==null){c=c.shared;var u=c.pending;u===null?l.next=l:(l.next=u.next,u.next=l),c.pending=l}}a.lanes|=r,l=a.alternate,l!==null&&(l.lanes|=r),Vm(a.return,r,t),o.lanes|=r;break}l=l.next}}else if(a.tag===10)i=a.type===t.type?null:a.child;else if(a.tag===18){if(i=a.return,i===null)throw Error(_e(341));i.lanes|=r,o=i.alternate,o!==null&&(o.lanes|=r),Vm(i,r,t),i=a.sibling}else i=a.child;if(i!==null)i.return=a;else for(i=a;i!==null;){if(i===t){i=null;break}if(a=i.sibling,a!==null){a.return=i.return,i=a;break}i=i.return}a=i}qr(e,t,s.children,r),t=t.child}return t;case 9:return s=t.type,n=t.pendingProps.children,$o(t,r),s=zn(s),n=n(s),t.flags|=1,qr(e,t,n,r),t.child;case 14:return n=t.type,s=Qn(n,t.pendingProps),s=Qn(n.type,s),B1(e,t,n,s,r);case 15:return V2(e,t,t.type,t.pendingProps,r);case 17:return n=t.type,s=t.pendingProps,s=t.elementType===n?s:Qn(n,s),Hf(e,t),t.tag=1,dn(n)?(e=!0,gh(t)):e=!1,$o(t,r),M2(t,n,s),Bm(t,n,s,r),Wm(null,t,n,!0,e,r);case 19:return W2(e,t,r);case 22:return U2(e,t,r)}throw Error(_e(156,t.tag))};function iT(e,t){return DE(e,t)}function pN(e,t,r,n){this.tag=e,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function jn(e,t,r,n){return new pN(e,t,r,n)}function Og(e){return e=e.prototype,!(!e||!e.isReactComponent)}function gN(e){if(typeof e=="function")return Og(e)?1:0;if(e!=null){if(e=e.$$typeof,e===eg)return 11;if(e===tg)return 14}return 2}function Ya(e,t){var r=e.alternate;return r===null?(r=jn(e.tag,t,e.key,e.mode),r.elementType=e.elementType,r.type=e.type,r.stateNode=e.stateNode,r.alternate=e,e.alternate=r):(r.pendingProps=t,r.type=e.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=e.flags&14680064,r.childLanes=e.childLanes,r.lanes=e.lanes,r.child=e.child,r.memoizedProps=e.memoizedProps,r.memoizedState=e.memoizedState,r.updateQueue=e.updateQueue,t=e.dependencies,r.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},r.sibling=e.sibling,r.index=e.index,r.ref=e.ref,r}function qf(e,t,r,n,s,a){var i=2;if(n=e,typeof e=="function")Og(e)&&(i=1);else if(typeof e=="string")i=5;else e:switch(e){case Io:return Oi(r.children,s,a,t);case Zp:i=8,s|=8;break;case fm:return e=jn(12,r,t,s|2),e.elementType=fm,e.lanes=a,e;case hm:return e=jn(13,r,t,s),e.elementType=hm,e.lanes=a,e;case dm:return e=jn(19,r,t,s),e.elementType=dm,e.lanes=a,e;case gE:return Ed(r,s,a,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case mE:i=10;break e;case pE:i=9;break e;case eg:i=11;break e;case tg:i=14;break e;case Na:i=16,n=null;break e}throw Error(_e(130,e==null?e:typeof e,""))}return t=jn(i,r,t,s),t.elementType=e,t.type=n,t.lanes=a,t}function Oi(e,t,r,n){return e=jn(7,e,n,t),e.lanes=r,e}function Ed(e,t,r,n){return e=jn(22,e,n,t),e.elementType=gE,e.lanes=r,e.stateNode={isHidden:!1},e}function M0(e,t,r){return e=jn(6,e,null,t),e.lanes=r,e}function L0(e,t,r){return t=jn(4,e.children!==null?e.children:[],e.key,t),t.lanes=r,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function vN(e,t,r,n,s){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=v0(0),this.expirationTimes=v0(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=v0(0),this.identifierPrefix=n,this.onRecoverableError=s,this.mutableSourceEagerHydrationData=null}function Mg(e,t,r,n,s,a,i,o,l){return e=new vN(e,t,r,o,l),t===1?(t=1,a===!0&&(t|=8)):t=0,a=jn(3,null,null,t),e.current=a,a.stateNode=e,a.memoizedState={element:n,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},yg(a),e}function xN(e,t,r){var n=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Ao,key:n==null?null:""+n,children:e,containerInfo:t,implementation:r}}function oT(e){if(!e)return si;e=e._reactInternals;e:{if(to(e)!==e||e.tag!==1)throw Error(_e(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(dn(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(_e(171))}if(e.tag===1){var r=e.type;if(dn(r))return o2(e,r,t)}return t}function lT(e,t,r,n,s,a,i,o,l){return e=Mg(r,n,!0,e,s,a,i,o,l),e.context=oT(null),r=e.current,n=Jr(),s=Xa(r),a=ea(n,s),a.callback=t??null,Ka(r,a,s),e.current.lanes=s,xu(e,s,n),mn(e,n),e}function Td(e,t,r,n){var s=t.current,a=Jr(),i=Xa(s);return r=oT(r),t.context===null?t.context=r:t.pendingContext=r,t=ea(a,i),t.payload={element:e},n=n===void 0?null:n,n!==null&&(t.callback=n),e=Ka(s,t,i),e!==null&&(os(e,s,i,a),zf(e,s,i)),i}function Nh(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function Z1(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var r=e.retryLane;e.retryLane=r!==0&&r<t?r:t}}function Lg(e,t){Z1(e,t),(e=e.alternate)&&Z1(e,t)}function yN(){return null}var cT=typeof reportError=="function"?reportError:function(e){console.error(e)};function jg(e){this._internalRoot=e}kd.prototype.render=jg.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(_e(409));Td(e,t,null,null)};kd.prototype.unmount=jg.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;Wi(function(){Td(null,e,null,null)}),t[ia]=null}};function kd(e){this._internalRoot=e}kd.prototype.unstable_scheduleHydration=function(e){if(e){var t=UE();e={blockedOn:null,target:e,priority:t};for(var r=0;r<ba.length&&t!==0&&t<ba[r].priority;r++);ba.splice(r,0,e),r===0&&zE(e)}};function Vg(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function Sd(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function ey(){}function _N(e,t,r,n,s){if(s){if(typeof n=="function"){var a=n;n=function(){var c=Nh(i);a.call(c)}}var i=lT(t,n,e,0,null,!1,!1,"",ey);return e._reactRootContainer=i,e[ia]=i.current,Bc(e.nodeType===8?e.parentNode:e),Wi(),i}for(;s=e.lastChild;)e.removeChild(s);if(typeof n=="function"){var o=n;n=function(){var c=Nh(l);o.call(c)}}var l=Mg(e,0,!1,null,null,!1,!1,"",ey);return e._reactRootContainer=l,e[ia]=l.current,Bc(e.nodeType===8?e.parentNode:e),Wi(function(){Td(t,l,r,n)}),l}function Ad(e,t,r,n,s){var a=r._reactRootContainer;if(a){var i=a;if(typeof s=="function"){var o=s;s=function(){var l=Nh(i);o.call(l)}}Td(t,i,e,s)}else i=_N(r,t,e,s,n);return Nh(i)}jE=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var r=Jl(t.pendingLanes);r!==0&&(sg(t,r|1),mn(t,Wt()),!(it&6)&&(al=Wt()+500,mi()))}break;case 13:Wi(function(){var n=oa(e,1);if(n!==null){var s=Jr();os(n,e,1,s)}}),Lg(e,1)}};ag=function(e){if(e.tag===13){var t=oa(e,134217728);if(t!==null){var r=Jr();os(t,e,134217728,r)}Lg(e,134217728)}};VE=function(e){if(e.tag===13){var t=Xa(e),r=oa(e,t);if(r!==null){var n=Jr();os(r,e,t,n)}Lg(e,t)}};UE=function(){return gt};BE=function(e,t){var r=gt;try{return gt=e,t()}finally{gt=r}};Tm=function(e,t,r){switch(t){case"input":if(gm(e,r),t=r.name,r.type==="radio"&&t!=null){for(r=e;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<r.length;t++){var n=r[t];if(n!==e&&n.form===e.form){var s=gd(n);if(!s)throw Error(_e(90));xE(n),gm(n,s)}}}break;case"textarea":_E(e,r);break;case"select":t=r.value,t!=null&&Vo(e,!!r.multiple,t,!1)}};IE=Pg;CE=Wi;var wN={usingClientEntryPoint:!1,Events:[_u,bo,gd,SE,AE,Pg]},Hl={findFiberByHostInstance:Ii,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},EN={bundleType:Hl.bundleType,version:Hl.version,rendererPackageName:Hl.rendererPackageName,rendererConfig:Hl.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:va.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=bE(e),e===null?null:e.stateNode},findFiberByHostInstance:Hl.findFiberByHostInstance||yN,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var _f=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!_f.isDisabled&&_f.supportsFiber)try{hd=_f.inject(EN),Es=_f}catch{}}In.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=wN;In.createPortal=function(e,t){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Vg(t))throw Error(_e(200));return xN(e,t,null,r)};In.createRoot=function(e,t){if(!Vg(e))throw Error(_e(299));var r=!1,n="",s=cT;return t!=null&&(t.unstable_strictMode===!0&&(r=!0),t.identifierPrefix!==void 0&&(n=t.identifierPrefix),t.onRecoverableError!==void 0&&(s=t.onRecoverableError)),t=Mg(e,1,!1,null,null,r,!1,n,s),e[ia]=t.current,Bc(e.nodeType===8?e.parentNode:e),new jg(t)};In.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(_e(188)):(e=Object.keys(e).join(","),Error(_e(268,e)));return e=bE(t),e=e===null?null:e.stateNode,e};In.flushSync=function(e){return Wi(e)};In.hydrate=function(e,t,r){if(!Sd(t))throw Error(_e(200));return Ad(null,e,t,!0,r)};In.hydrateRoot=function(e,t,r){if(!Vg(e))throw Error(_e(405));var n=r!=null&&r.hydratedSources||null,s=!1,a="",i=cT;if(r!=null&&(r.unstable_strictMode===!0&&(s=!0),r.identifierPrefix!==void 0&&(a=r.identifierPrefix),r.onRecoverableError!==void 0&&(i=r.onRecoverableError)),t=lT(t,null,e,1,r??null,s,!1,a,i),e[ia]=t.current,Bc(e),n)for(e=0;e<n.length;e++)r=n[e],s=r._getVersion,s=s(r._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[r,s]:t.mutableSourceEagerHydrationData.push(r,s);return new kd(t)};In.render=function(e,t,r){if(!Sd(t))throw Error(_e(200));return Ad(null,e,t,!1,r)};In.unmountComponentAtNode=function(e){if(!Sd(e))throw Error(_e(40));return e._reactRootContainer?(Wi(function(){Ad(null,null,e,!1,function(){e._reactRootContainer=null,e[ia]=null})}),!0):!1};In.unstable_batchedUpdates=Pg;In.unstable_renderSubtreeIntoContainer=function(e,t,r,n){if(!Sd(r))throw Error(_e(200));if(e==null||e._reactInternals===void 0)throw Error(_e(38));return Ad(e,t,r,!1,n)};In.version="18.3.1-next-f1338f8080-20240426";function uT(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(uT)}catch(e){console.error(e)}}uT(),uE.exports=In;var Ug=uE.exports;const TN=Jw(Ug),kN=Qw({__proto__:null,default:TN},[Ug]);var ty=Ug;cm.createRoot=ty.createRoot,cm.hydrateRoot=ty.hydrateRoot;/**
 * @remix-run/router v1.23.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Rt(){return Rt=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Rt.apply(this,arguments)}var Qt;(function(e){e.Pop="POP",e.Push="PUSH",e.Replace="REPLACE"})(Qt||(Qt={}));const ry="popstate";function SN(e){e===void 0&&(e={});function t(n,s){let{pathname:a,search:i,hash:o}=n.location;return Yc("",{pathname:a,search:i,hash:o},s.state&&s.state.usr||null,s.state&&s.state.key||"default")}function r(n,s){return typeof s=="string"?s:Hi(s)}return IN(t,r,null,e)}function Ge(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}function il(e,t){if(!e){typeof console<"u"&&console.warn(t);try{throw new Error(t)}catch{}}}function AN(){return Math.random().toString(36).substr(2,8)}function ny(e,t){return{usr:e.state,key:e.key,idx:t}}function Yc(e,t,r,n){return r===void 0&&(r=null),Rt({pathname:typeof e=="string"?e:e.pathname,search:"",hash:""},typeof t=="string"?pi(t):t,{state:r,key:t&&t.key||n||AN()})}function Hi(e){let{pathname:t="/",search:r="",hash:n=""}=e;return r&&r!=="?"&&(t+=r.charAt(0)==="?"?r:"?"+r),n&&n!=="#"&&(t+=n.charAt(0)==="#"?n:"#"+n),t}function pi(e){let t={};if(e){let r=e.indexOf("#");r>=0&&(t.hash=e.substr(r),e=e.substr(0,r));let n=e.indexOf("?");n>=0&&(t.search=e.substr(n),e=e.substr(0,n)),e&&(t.pathname=e)}return t}function IN(e,t,r,n){n===void 0&&(n={});let{window:s=document.defaultView,v5Compat:a=!1}=n,i=s.history,o=Qt.Pop,l=null,c=u();c==null&&(c=0,i.replaceState(Rt({},i.state,{idx:c}),""));function u(){return(i.state||{idx:null}).idx}function d(){o=Qt.Pop;let w=u(),k=w==null?null:w-c;c=w,l&&l({action:o,location:x.location,delta:k})}function m(w,k){o=Qt.Push;let T=Yc(x.location,w,k);c=u()+1;let E=ny(T,c),N=x.createHref(T);try{i.pushState(E,"",N)}catch(M){if(M instanceof DOMException&&M.name==="DataCloneError")throw M;s.location.assign(N)}a&&l&&l({action:o,location:x.location,delta:1})}function p(w,k){o=Qt.Replace;let T=Yc(x.location,w,k);c=u();let E=ny(T,c),N=x.createHref(T);i.replaceState(E,"",N),a&&l&&l({action:o,location:x.location,delta:0})}function g(w){let k=s.location.origin!=="null"?s.location.origin:s.location.href,T=typeof w=="string"?w:Hi(w);return T=T.replace(/ $/,"%20"),Ge(k,"No window.location.(origin|href) available to create URL for href: "+T),new URL(T,k)}let x={get action(){return o},get location(){return e(s,i)},listen(w){if(l)throw new Error("A history only accepts one active listener");return s.addEventListener(ry,d),l=w,()=>{s.removeEventListener(ry,d),l=null}},createHref(w){return t(s,w)},createURL:g,encodeLocation(w){let k=g(w);return{pathname:k.pathname,search:k.search,hash:k.hash}},push:m,replace:p,go(w){return i.go(w)}};return x}var pt;(function(e){e.data="data",e.deferred="deferred",e.redirect="redirect",e.error="error"})(pt||(pt={}));const CN=new Set(["lazy","caseSensitive","path","id","index","children"]);function NN(e){return e.index===!0}function Rh(e,t,r,n){return r===void 0&&(r=[]),n===void 0&&(n={}),e.map((s,a)=>{let i=[...r,String(a)],o=typeof s.id=="string"?s.id:i.join("-");if(Ge(s.index!==!0||!s.children,"Cannot specify children on an index route"),Ge(!n[o],'Found a route id collision on id "'+o+`".  Route id's must be globally unique within Data Router usages`),NN(s)){let l=Rt({},s,t(s),{id:o});return n[o]=l,l}else{let l=Rt({},s,t(s),{id:o,children:void 0});return n[o]=l,s.children&&(l.children=Rh(s.children,t,i,n)),l}})}function ki(e,t,r){return r===void 0&&(r="/"),Xf(e,t,r,!1)}function Xf(e,t,r,n){let s=typeof t=="string"?pi(t):t,a=ca(s.pathname||"/",r);if(a==null)return null;let i=fT(e);bN(i);let o=null;for(let l=0;o==null&&l<i.length;++l){let c=zN(a);o=UN(i[l],c,n)}return o}function RN(e,t){let{route:r,pathname:n,params:s}=e;return{id:r.id,pathname:n,params:s,data:t[r.id],handle:r.handle}}function fT(e,t,r,n){t===void 0&&(t=[]),r===void 0&&(r=[]),n===void 0&&(n="");let s=(a,i,o)=>{let l={relativePath:o===void 0?a.path||"":o,caseSensitive:a.caseSensitive===!0,childrenIndex:i,route:a};l.relativePath.startsWith("/")&&(Ge(l.relativePath.startsWith(n),'Absolute route path "'+l.relativePath+'" nested under path '+('"'+n+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),l.relativePath=l.relativePath.slice(n.length));let c=ta([n,l.relativePath]),u=r.concat(l);a.children&&a.children.length>0&&(Ge(a.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+c+'".')),fT(a.children,t,u,c)),!(a.path==null&&!a.index)&&t.push({path:c,score:jN(c,a.index),routesMeta:u})};return e.forEach((a,i)=>{var o;if(a.path===""||!((o=a.path)!=null&&o.includes("?")))s(a,i);else for(let l of hT(a.path))s(a,i,l)}),t}function hT(e){let t=e.split("/");if(t.length===0)return[];let[r,...n]=t,s=r.endsWith("?"),a=r.replace(/\?$/,"");if(n.length===0)return s?[a,""]:[a];let i=hT(n.join("/")),o=[];return o.push(...i.map(l=>l===""?a:[a,l].join("/"))),s&&o.push(...i),o.map(l=>e.startsWith("/")&&l===""?"/":l)}function bN(e){e.sort((t,r)=>t.score!==r.score?r.score-t.score:VN(t.routesMeta.map(n=>n.childrenIndex),r.routesMeta.map(n=>n.childrenIndex)))}const PN=/^:[\w-]+$/,DN=3,FN=2,ON=1,MN=10,LN=-2,sy=e=>e==="*";function jN(e,t){let r=e.split("/"),n=r.length;return r.some(sy)&&(n+=LN),t&&(n+=FN),r.filter(s=>!sy(s)).reduce((s,a)=>s+(PN.test(a)?DN:a===""?ON:MN),n)}function VN(e,t){return e.length===t.length&&e.slice(0,-1).every((n,s)=>n===t[s])?e[e.length-1]-t[t.length-1]:0}function UN(e,t,r){r===void 0&&(r=!1);let{routesMeta:n}=e,s={},a="/",i=[];for(let o=0;o<n.length;++o){let l=n[o],c=o===n.length-1,u=a==="/"?t:t.slice(a.length)||"/",d=bh({path:l.relativePath,caseSensitive:l.caseSensitive,end:c},u),m=l.route;if(!d&&c&&r&&!n[n.length-1].route.index&&(d=bh({path:l.relativePath,caseSensitive:l.caseSensitive,end:!1},u)),!d)return null;Object.assign(s,d.params),i.push({params:s,pathname:ta([a,d.pathname]),pathnameBase:HN(ta([a,d.pathnameBase])),route:m}),d.pathnameBase!=="/"&&(a=ta([a,d.pathnameBase]))}return i}function bh(e,t){typeof e=="string"&&(e={path:e,caseSensitive:!1,end:!0});let[r,n]=BN(e.path,e.caseSensitive,e.end),s=t.match(r);if(!s)return null;let a=s[0],i=a.replace(/(.)\/+$/,"$1"),o=s.slice(1);return{params:n.reduce((c,u,d)=>{let{paramName:m,isOptional:p}=u;if(m==="*"){let x=o[d]||"";i=a.slice(0,a.length-x.length).replace(/(.)\/+$/,"$1")}const g=o[d];return p&&!g?c[m]=void 0:c[m]=(g||"").replace(/%2F/g,"/"),c},{}),pathname:a,pathnameBase:i,pattern:e}}function BN(e,t,r){t===void 0&&(t=!1),r===void 0&&(r=!0),il(e==="*"||!e.endsWith("*")||e.endsWith("/*"),'Route path "'+e+'" will be treated as if it were '+('"'+e.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+e.replace(/\*$/,"/*")+'".'));let n=[],s="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(i,o,l)=>(n.push({paramName:o,isOptional:l!=null}),l?"/?([^\\/]+)?":"/([^\\/]+)"));return e.endsWith("*")?(n.push({paramName:"*"}),s+=e==="*"||e==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):r?s+="\\/*$":e!==""&&e!=="/"&&(s+="(?:(?=\\/|$))"),[new RegExp(s,t?void 0:"i"),n]}function zN(e){try{return e.split("/").map(t=>decodeURIComponent(t).replace(/\//g,"%2F")).join("/")}catch(t){return il(!1,'The URL path "'+e+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+t+").")),e}}function ca(e,t){if(t==="/")return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let r=t.endsWith("/")?t.length-1:t.length,n=e.charAt(r);return n&&n!=="/"?null:e.slice(r)||"/"}function $N(e,t){t===void 0&&(t="/");let{pathname:r,search:n="",hash:s=""}=typeof e=="string"?pi(e):e;return{pathname:r?r.startsWith("/")?r:WN(r,t):t,search:GN(n),hash:KN(s)}}function WN(e,t){let r=t.replace(/\/+$/,"").split("/");return e.split("/").forEach(s=>{s===".."?r.length>1&&r.pop():s!=="."&&r.push(s)}),r.length>1?r.join("/"):"/"}function j0(e,t,r,n){return"Cannot include a '"+e+"' character in a manually specified "+("`to."+t+"` field ["+JSON.stringify(n)+"].  Please separate it out to the ")+("`to."+r+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function dT(e){return e.filter((t,r)=>r===0||t.route.path&&t.route.path.length>0)}function Id(e,t){let r=dT(e);return t?r.map((n,s)=>s===r.length-1?n.pathname:n.pathnameBase):r.map(n=>n.pathnameBase)}function Cd(e,t,r,n){n===void 0&&(n=!1);let s;typeof e=="string"?s=pi(e):(s=Rt({},e),Ge(!s.pathname||!s.pathname.includes("?"),j0("?","pathname","search",s)),Ge(!s.pathname||!s.pathname.includes("#"),j0("#","pathname","hash",s)),Ge(!s.search||!s.search.includes("#"),j0("#","search","hash",s)));let a=e===""||s.pathname==="",i=a?"/":s.pathname,o;if(i==null)o=r;else{let d=t.length-1;if(!n&&i.startsWith("..")){let m=i.split("/");for(;m[0]==="..";)m.shift(),d-=1;s.pathname=m.join("/")}o=d>=0?t[d]:"/"}let l=$N(s,o),c=i&&i!=="/"&&i.endsWith("/"),u=(a||i===".")&&r.endsWith("/");return!l.pathname.endsWith("/")&&(c||u)&&(l.pathname+="/"),l}const ta=e=>e.join("/").replace(/\/\/+/g,"/"),HN=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),GN=e=>!e||e==="?"?"":e.startsWith("?")?e:"?"+e,KN=e=>!e||e==="#"?"":e.startsWith("#")?e:"#"+e;class Ph{constructor(t,r,n,s){s===void 0&&(s=!1),this.status=t,this.statusText=r||"",this.internal=s,n instanceof Error?(this.data=n.toString(),this.error=n):this.data=n}}function Qc(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.internal=="boolean"&&"data"in e}const mT=["post","put","patch","delete"],qN=new Set(mT),XN=["get",...mT],YN=new Set(XN),QN=new Set([301,302,303,307,308]),JN=new Set([307,308]),V0={state:"idle",location:void 0,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0},ZN={state:"idle",data:void 0,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0},Gl={state:"unblocked",proceed:void 0,reset:void 0,location:void 0},Bg=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,eR=e=>({hasErrorBoundary:!!e.hasErrorBoundary}),pT="remix-router-transitions";function tR(e){const t=e.window?e.window:typeof window<"u"?window:void 0,r=typeof t<"u"&&typeof t.document<"u"&&typeof t.document.createElement<"u",n=!r;Ge(e.routes.length>0,"You must provide a non-empty routes array to createRouter");let s;if(e.mapRouteProperties)s=e.mapRouteProperties;else if(e.detectErrorBoundary){let q=e.detectErrorBoundary;s=J=>({hasErrorBoundary:q(J)})}else s=eR;let a={},i=Rh(e.routes,s,void 0,a),o,l=e.basename||"/",c=e.dataStrategy||aR,u=e.patchRoutesOnNavigation,d=Rt({v7_fetcherPersist:!1,v7_normalizeFormMethod:!1,v7_partialHydration:!1,v7_prependBasename:!1,v7_relativeSplatPath:!1,v7_skipActionErrorRevalidation:!1},e.future),m=null,p=new Set,g=null,x=null,w=null,k=e.hydrationData!=null,T=ki(i,e.history.location,l),E=!1,N=null;if(T==null&&!u){let q=on(404,{pathname:e.history.location.pathname}),{matches:J,route:ae}=py(i);T=J,N={[ae.id]:q}}T&&!e.hydrationData&&zs(T,i,e.history.location.pathname).active&&(T=null);let M;if(T)if(T.some(q=>q.route.lazy))M=!1;else if(!T.some(q=>q.route.loader))M=!0;else if(d.v7_partialHydration){let q=e.hydrationData?e.hydrationData.loaderData:null,J=e.hydrationData?e.hydrationData.errors:null;if(J){let ae=T.findIndex(me=>J[me.route.id]!==void 0);M=T.slice(0,ae+1).every(me=>!np(me.route,q,J))}else M=T.every(ae=>!np(ae.route,q,J))}else M=e.hydrationData!=null;else if(M=!1,T=[],d.v7_partialHydration){let q=zs(null,i,e.history.location.pathname);q.active&&q.matches&&(E=!0,T=q.matches)}let O,v={historyAction:e.history.action,location:e.history.location,matches:T,initialized:M,navigation:V0,restoreScrollPosition:e.hydrationData!=null?!1:null,preventScrollReset:!1,revalidation:"idle",loaderData:e.hydrationData&&e.hydrationData.loaderData||{},actionData:e.hydrationData&&e.hydrationData.actionData||null,errors:e.hydrationData&&e.hydrationData.errors||N,fetchers:new Map,blockers:new Map},_=Qt.Pop,S=!1,I,b=!1,P=new Map,R=null,ue=!1,le=!1,he=[],pe=new Set,ee=new Map,H=0,se=-1,ce=new Map,B=new Set,K=new Map,X=new Map,G=new Set,ie=new Map,ge=new Map,Ie;function Te(){if(m=e.history.listen(q=>{let{action:J,location:ae,delta:me}=q;if(Ie){Ie(),Ie=void 0;return}il(ge.size===0||me!=null,"You are trying to use a blocker on a POP navigation to a location that was not created by @remix-run/router. This will fail silently in production. This can happen if you are navigating outside the router via `window.history.pushState`/`window.location.hash` instead of using router navigation APIs.  This can also happen if you are using createHashRouter and the user manually changes the URL.");let Se=wa({currentLocation:v.location,nextLocation:ae,historyAction:J});if(Se&&me!=null){let C=new Promise(V=>{Ie=V});e.history.go(me*-1),hs(Se,{state:"blocked",location:ae,proceed(){hs(Se,{state:"proceeding",proceed:void 0,reset:void 0,location:ae}),C.then(()=>e.history.go(me))},reset(){let V=new Map(v.blockers);V.set(Se,Gl),W({blockers:V})}});return}return Fe(J,ae)}),r){yR(t,P);let q=()=>_R(t,P);t.addEventListener("pagehide",q),R=()=>t.removeEventListener("pagehide",q)}return v.initialized||Fe(Qt.Pop,v.location,{initialHydration:!0}),O}function ye(){m&&m(),R&&R(),p.clear(),I&&I.abort(),v.fetchers.forEach((q,J)=>yt(J)),v.blockers.forEach((q,J)=>Vs(J))}function $e(q){return p.add(q),()=>p.delete(q)}function W(q,J){J===void 0&&(J={}),v=Rt({},v,q);let ae=[],me=[];d.v7_fetcherPersist&&v.fetchers.forEach((Se,C)=>{Se.state==="idle"&&(G.has(C)?me.push(C):ae.push(C))}),G.forEach(Se=>{!v.fetchers.has(Se)&&!ee.has(Se)&&me.push(Se)}),[...p].forEach(Se=>Se(v,{deletedFetchers:me,viewTransitionOpts:J.viewTransitionOpts,flushSync:J.flushSync===!0})),d.v7_fetcherPersist?(ae.forEach(Se=>v.fetchers.delete(Se)),me.forEach(Se=>yt(Se))):me.forEach(Se=>G.delete(Se))}function lt(q,J,ae){var me,Se;let{flushSync:C}=ae===void 0?{}:ae,V=v.actionData!=null&&v.navigation.formMethod!=null&&Zn(v.navigation.formMethod)&&v.navigation.state==="loading"&&((me=q.state)==null?void 0:me._isRedirect)!==!0,D;J.actionData?Object.keys(J.actionData).length>0?D=J.actionData:D=null:V?D=v.actionData:D=null;let F=J.loaderData?dy(v.loaderData,J.loaderData,J.matches||[],J.errors):v.loaderData,L=v.blockers;L.size>0&&(L=new Map(L),L.forEach((re,te)=>L.set(te,Gl)));let j=S===!0||v.navigation.formMethod!=null&&Zn(v.navigation.formMethod)&&((Se=q.state)==null?void 0:Se._isRedirect)!==!0;o&&(i=o,o=void 0),ue||_===Qt.Pop||(_===Qt.Push?e.history.push(q,q.state):_===Qt.Replace&&e.history.replace(q,q.state));let Y;if(_===Qt.Pop){let re=P.get(v.location.pathname);re&&re.has(q.pathname)?Y={currentLocation:v.location,nextLocation:q}:P.has(q.pathname)&&(Y={currentLocation:q,nextLocation:v.location})}else if(b){let re=P.get(v.location.pathname);re?re.add(q.pathname):(re=new Set([q.pathname]),P.set(v.location.pathname,re)),Y={currentLocation:v.location,nextLocation:q}}W(Rt({},J,{actionData:D,loaderData:F,historyAction:_,location:q,initialized:!0,navigation:V0,revalidation:"idle",restoreScrollPosition:Bs(q,J.matches||v.matches),preventScrollReset:j,blockers:L}),{viewTransitionOpts:Y,flushSync:C===!0}),_=Qt.Pop,S=!1,b=!1,ue=!1,le=!1,he=[]}async function He(q,J){if(typeof q=="number"){e.history.go(q);return}let ae=rp(v.location,v.matches,l,d.v7_prependBasename,q,d.v7_relativeSplatPath,J==null?void 0:J.fromRouteId,J==null?void 0:J.relative),{path:me,submission:Se,error:C}=ay(d.v7_normalizeFormMethod,!1,ae,J),V=v.location,D=Yc(v.location,me,J&&J.state);D=Rt({},D,e.history.encodeLocation(D));let F=J&&J.replace!=null?J.replace:void 0,L=Qt.Push;F===!0?L=Qt.Replace:F===!1||Se!=null&&Zn(Se.formMethod)&&Se.formAction===v.location.pathname+v.location.search&&(L=Qt.Replace);let j=J&&"preventScrollReset"in J?J.preventScrollReset===!0:void 0,Y=(J&&J.flushSync)===!0,re=wa({currentLocation:V,nextLocation:D,historyAction:L});if(re){hs(re,{state:"blocked",location:D,proceed(){hs(re,{state:"proceeding",proceed:void 0,reset:void 0,location:D}),He(q,J)},reset(){let te=new Map(v.blockers);te.set(re,Gl),W({blockers:te})}});return}return await Fe(L,D,{submission:Se,pendingError:C,preventScrollReset:j,replace:J&&J.replace,enableViewTransition:J&&J.viewTransition,flushSync:Y})}function st(){if(St(),W({revalidation:"loading"}),v.navigation.state!=="submitting"){if(v.navigation.state==="idle"){Fe(v.historyAction,v.location,{startUninterruptedRevalidation:!0});return}Fe(_||v.historyAction,v.navigation.location,{overrideNavigation:v.navigation,enableViewTransition:b===!0})}}async function Fe(q,J,ae){I&&I.abort(),I=null,_=q,ue=(ae&&ae.startUninterruptedRevalidation)===!0,mo(v.location,v.matches),S=(ae&&ae.preventScrollReset)===!0,b=(ae&&ae.enableViewTransition)===!0;let me=o||i,Se=ae&&ae.overrideNavigation,C=ae!=null&&ae.initialHydration&&v.matches&&v.matches.length>0&&!E?v.matches:ki(me,J,l),V=(ae&&ae.flushSync)===!0;if(C&&v.initialized&&!le&&fR(v.location,J)&&!(ae&&ae.submission&&Zn(ae.submission.formMethod))){lt(J,{matches:C},{flushSync:V});return}let D=zs(C,me,J.pathname);if(D.active&&D.matches&&(C=D.matches),!C){let{error:Z,notFoundMatches:Q,route:fe}=Gn(J.pathname);lt(J,{matches:Q,loaderData:{},errors:{[fe.id]:Z}},{flushSync:V});return}I=new AbortController;let F=_o(e.history,J,I.signal,ae&&ae.submission),L;if(ae&&ae.pendingError)L=[Si(C).route.id,{type:pt.error,error:ae.pendingError}];else if(ae&&ae.submission&&Zn(ae.submission.formMethod)){let Z=await Ae(F,J,ae.submission,C,D.active,{replace:ae.replace,flushSync:V});if(Z.shortCircuited)return;if(Z.pendingActionResult){let[Q,fe]=Z.pendingActionResult;if(yn(fe)&&Qc(fe.error)&&fe.error.status===404){I=null,lt(J,{matches:Z.matches,loaderData:{},errors:{[Q]:fe.error}});return}}C=Z.matches||C,L=Z.pendingActionResult,Se=U0(J,ae.submission),V=!1,D.active=!1,F=_o(e.history,F.url,F.signal)}let{shortCircuited:j,matches:Y,loaderData:re,errors:te}=await Tt(F,J,C,D.active,Se,ae&&ae.submission,ae&&ae.fetcherSubmission,ae&&ae.replace,ae&&ae.initialHydration===!0,V,L);j||(I=null,lt(J,Rt({matches:Y||C},my(L),{loaderData:re,errors:te})))}async function Ae(q,J,ae,me,Se,C){C===void 0&&(C={}),St();let V=vR(J,ae);if(W({navigation:V},{flushSync:C.flushSync===!0}),Se){let L=await bn(me,J.pathname,q.signal);if(L.type==="aborted")return{shortCircuited:!0};if(L.type==="error"){let j=Si(L.partialMatches).route.id;return{matches:L.partialMatches,pendingActionResult:[j,{type:pt.error,error:L.error}]}}else if(L.matches)me=L.matches;else{let{notFoundMatches:j,error:Y,route:re}=Gn(J.pathname);return{matches:j,pendingActionResult:[re.id,{type:pt.error,error:Y}]}}}let D,F=ec(me,J);if(!F.route.action&&!F.route.lazy)D={type:pt.error,error:on(405,{method:q.method,pathname:J.pathname,routeId:F.route.id})};else if(D=(await cr("action",v,q,[F],me,null))[F.route.id],q.signal.aborted)return{shortCircuited:!0};if(Ri(D)){let L;return C&&C.replace!=null?L=C.replace:L=uy(D.response.headers.get("Location"),new URL(q.url),l)===v.location.pathname+v.location.search,await kt(q,D,!0,{submission:ae,replace:L}),{shortCircuited:!0}}if(Va(D))throw on(400,{type:"defer-action"});if(yn(D)){let L=Si(me,F.route.id);return(C&&C.replace)!==!0&&(_=Qt.Push),{matches:me,pendingActionResult:[L.route.id,D]}}return{matches:me,pendingActionResult:[F.route.id,D]}}async function Tt(q,J,ae,me,Se,C,V,D,F,L,j){let Y=Se||U0(J,C),re=C||V||vy(Y),te=!ue&&(!d.v7_partialHydration||!F);if(me){if(te){let ht=lr(j);W(Rt({navigation:Y},ht!==void 0?{actionData:ht}:{}),{flushSync:L})}let We=await bn(ae,J.pathname,q.signal);if(We.type==="aborted")return{shortCircuited:!0};if(We.type==="error"){let ht=Si(We.partialMatches).route.id;return{matches:We.partialMatches,loaderData:{},errors:{[ht]:We.error}}}else if(We.matches)ae=We.matches;else{let{error:ht,notFoundMatches:pr,route:Pn}=Gn(J.pathname);return{matches:pr,loaderData:{},errors:{[Pn.id]:ht}}}}let Z=o||i,[Q,fe]=oy(e.history,v,ae,re,J,d.v7_partialHydration&&F===!0,d.v7_skipActionErrorRevalidation,le,he,pe,G,K,B,Z,l,j);if(Us(We=>!(ae&&ae.some(ht=>ht.route.id===We))||Q&&Q.some(ht=>ht.route.id===We)),se=++H,Q.length===0&&fe.length===0){let We=js();return lt(J,Rt({matches:ae,loaderData:{},errors:j&&yn(j[1])?{[j[0]]:j[1].error}:null},my(j),We?{fetchers:new Map(v.fetchers)}:{}),{flushSync:L}),{shortCircuited:!0}}if(te){let We={};if(!me){We.navigation=Y;let ht=lr(j);ht!==void 0&&(We.actionData=ht)}fe.length>0&&(We.fetchers=Nr(fe)),W(We,{flushSync:L})}fe.forEach(We=>{ft(We.key),We.controller&&ee.set(We.key,We.controller)});let we=()=>fe.forEach(We=>ft(We.key));I&&I.signal.addEventListener("abort",we);let{loaderResults:Ce,fetcherResults:ve}=await xt(v,ae,Q,fe,q);if(q.signal.aborted)return{shortCircuited:!0};I&&I.signal.removeEventListener("abort",we),fe.forEach(We=>ee.delete(We.key));let Ee=wf(Ce);if(Ee)return await kt(q,Ee.result,!0,{replace:D}),{shortCircuited:!0};if(Ee=wf(ve),Ee)return B.add(Ee.key),await kt(q,Ee.result,!0,{replace:D}),{shortCircuited:!0};let{loaderData:De,errors:at}=hy(v,ae,Ce,j,fe,ve,ie);ie.forEach((We,ht)=>{We.subscribe(pr=>{(pr||We.done)&&ie.delete(ht)})}),d.v7_partialHydration&&F&&v.errors&&(at=Rt({},v.errors,at));let Ke=js(),mt=ho(se),an=Ke||mt||fe.length>0;return Rt({matches:ae,loaderData:De,errors:at},an?{fetchers:new Map(v.fetchers)}:{})}function lr(q){if(q&&!yn(q[1]))return{[q[0]]:q[1].data};if(v.actionData)return Object.keys(v.actionData).length===0?null:v.actionData}function Nr(q){return q.forEach(J=>{let ae=v.fetchers.get(J.key),me=Kl(void 0,ae?ae.data:void 0);v.fetchers.set(J.key,me)}),new Map(v.fetchers)}function nn(q,J,ae,me){if(n)throw new Error("router.fetch() was called during the server render, but it shouldn't be. You are likely calling a useFetcher() method in the body of your component. Try moving it to a useEffect or a callback.");ft(q);let Se=(me&&me.flushSync)===!0,C=o||i,V=rp(v.location,v.matches,l,d.v7_prependBasename,ae,d.v7_relativeSplatPath,J,me==null?void 0:me.relative),D=ki(C,V,l),F=zs(D,C,V);if(F.active&&F.matches&&(D=F.matches),!D){Dt(q,J,on(404,{pathname:V}),{flushSync:Se});return}let{path:L,submission:j,error:Y}=ay(d.v7_normalizeFormMethod,!0,V,me);if(Y){Dt(q,J,Y,{flushSync:Se});return}let re=ec(D,L),te=(me&&me.preventScrollReset)===!0;if(j&&Zn(j.formMethod)){Ls(q,J,L,re,D,F.active,Se,te,j);return}K.set(q,{routeId:J,path:L}),sn(q,J,L,re,D,F.active,Se,te,j)}async function Ls(q,J,ae,me,Se,C,V,D,F){St(),K.delete(q);function L(Ze){if(!Ze.route.action&&!Ze.route.lazy){let ms=on(405,{method:F.formMethod,pathname:ae,routeId:J});return Dt(q,J,ms,{flushSync:V}),!0}return!1}if(!C&&L(me))return;let j=v.fetchers.get(q);dt(q,xR(F,j),{flushSync:V});let Y=new AbortController,re=_o(e.history,ae,Y.signal,F);if(C){let Ze=await bn(Se,new URL(re.url).pathname,re.signal,q);if(Ze.type==="aborted")return;if(Ze.type==="error"){Dt(q,J,Ze.error,{flushSync:V});return}else if(Ze.matches){if(Se=Ze.matches,me=ec(Se,ae),L(me))return}else{Dt(q,J,on(404,{pathname:ae}),{flushSync:V});return}}ee.set(q,Y);let te=H,Q=(await cr("action",v,re,[me],Se,q))[me.route.id];if(re.signal.aborted){ee.get(q)===Y&&ee.delete(q);return}if(d.v7_fetcherPersist&&G.has(q)){if(Ri(Q)||yn(Q)){dt(q,Ca(void 0));return}}else{if(Ri(Q))if(ee.delete(q),se>te){dt(q,Ca(void 0));return}else return B.add(q),dt(q,Kl(F)),kt(re,Q,!1,{fetcherSubmission:F,preventScrollReset:D});if(yn(Q)){Dt(q,J,Q.error);return}}if(Va(Q))throw on(400,{type:"defer-action"});let fe=v.navigation.location||v.location,we=_o(e.history,fe,Y.signal),Ce=o||i,ve=v.navigation.state!=="idle"?ki(Ce,v.navigation.location,l):v.matches;Ge(ve,"Didn't find any matches after fetcher action");let Ee=++H;ce.set(q,Ee);let De=Kl(F,Q.data);v.fetchers.set(q,De);let[at,Ke]=oy(e.history,v,ve,F,fe,!1,d.v7_skipActionErrorRevalidation,le,he,pe,G,K,B,Ce,l,[me.route.id,Q]);Ke.filter(Ze=>Ze.key!==q).forEach(Ze=>{let ms=Ze.key,Rl=v.fetchers.get(ms),Hu=Kl(void 0,Rl?Rl.data:void 0);v.fetchers.set(ms,Hu),ft(ms),Ze.controller&&ee.set(ms,Ze.controller)}),W({fetchers:new Map(v.fetchers)});let mt=()=>Ke.forEach(Ze=>ft(Ze.key));Y.signal.addEventListener("abort",mt);let{loaderResults:an,fetcherResults:We}=await xt(v,ve,at,Ke,we);if(Y.signal.aborted)return;Y.signal.removeEventListener("abort",mt),ce.delete(q),ee.delete(q),Ke.forEach(Ze=>ee.delete(Ze.key));let ht=wf(an);if(ht)return kt(we,ht.result,!1,{preventScrollReset:D});if(ht=wf(We),ht)return B.add(ht.key),kt(we,ht.result,!1,{preventScrollReset:D});let{loaderData:pr,errors:Pn}=hy(v,ve,an,void 0,Ke,We,ie);if(v.fetchers.has(q)){let Ze=Ca(Q.data);v.fetchers.set(q,Ze)}ho(Ee),v.navigation.state==="loading"&&Ee>se?(Ge(_,"Expected pending action"),I&&I.abort(),lt(v.navigation.location,{matches:ve,loaderData:pr,errors:Pn,fetchers:new Map(v.fetchers)})):(W({errors:Pn,loaderData:dy(v.loaderData,pr,ve,Pn),fetchers:new Map(v.fetchers)}),le=!1)}async function sn(q,J,ae,me,Se,C,V,D,F){let L=v.fetchers.get(q);dt(q,Kl(F,L?L.data:void 0),{flushSync:V});let j=new AbortController,Y=_o(e.history,ae,j.signal);if(C){let Q=await bn(Se,new URL(Y.url).pathname,Y.signal,q);if(Q.type==="aborted")return;if(Q.type==="error"){Dt(q,J,Q.error,{flushSync:V});return}else if(Q.matches)Se=Q.matches,me=ec(Se,ae);else{Dt(q,J,on(404,{pathname:ae}),{flushSync:V});return}}ee.set(q,j);let re=H,Z=(await cr("loader",v,Y,[me],Se,q))[me.route.id];if(Va(Z)&&(Z=await zg(Z,Y.signal,!0)||Z),ee.get(q)===j&&ee.delete(q),!Y.signal.aborted){if(G.has(q)){dt(q,Ca(void 0));return}if(Ri(Z))if(se>re){dt(q,Ca(void 0));return}else{B.add(q),await kt(Y,Z,!1,{preventScrollReset:D});return}if(yn(Z)){Dt(q,J,Z.error);return}Ge(!Va(Z),"Unhandled fetcher deferred data"),dt(q,Ca(Z.data))}}async function kt(q,J,ae,me){let{submission:Se,fetcherSubmission:C,preventScrollReset:V,replace:D}=me===void 0?{}:me;J.response.headers.has("X-Remix-Revalidate")&&(le=!0);let F=J.response.headers.get("Location");Ge(F,"Expected a Location header on the redirect Response"),F=uy(F,new URL(q.url),l);let L=Yc(v.location,F,{_isRedirect:!0});if(r){let Q=!1;if(J.response.headers.has("X-Remix-Reload-Document"))Q=!0;else if(Bg.test(F)){const fe=e.history.createURL(F);Q=fe.origin!==t.location.origin||ca(fe.pathname,l)==null}if(Q){D?t.location.replace(F):t.location.assign(F);return}}I=null;let j=D===!0||J.response.headers.has("X-Remix-Replace")?Qt.Replace:Qt.Push,{formMethod:Y,formAction:re,formEncType:te}=v.navigation;!Se&&!C&&Y&&re&&te&&(Se=vy(v.navigation));let Z=Se||C;if(JN.has(J.response.status)&&Z&&Zn(Z.formMethod))await Fe(j,L,{submission:Rt({},Z,{formAction:F}),preventScrollReset:V||S,enableViewTransition:ae?b:void 0});else{let Q=U0(L,Se);await Fe(j,L,{overrideNavigation:Q,fetcherSubmission:C,preventScrollReset:V||S,enableViewTransition:ae?b:void 0})}}async function cr(q,J,ae,me,Se,C){let V,D={};try{V=await iR(c,q,J,ae,me,Se,C,a,s)}catch(F){return me.forEach(L=>{D[L.route.id]={type:pt.error,error:F}}),D}for(let[F,L]of Object.entries(V))if(hR(L)){let j=L.result;D[F]={type:pt.redirect,response:cR(j,ae,F,Se,l,d.v7_relativeSplatPath)}}else D[F]=await lR(L);return D}async function xt(q,J,ae,me,Se){let C=q.matches,V=cr("loader",q,Se,ae,J,null),D=Promise.all(me.map(async j=>{if(j.matches&&j.match&&j.controller){let re=(await cr("loader",q,_o(e.history,j.path,j.controller.signal),[j.match],j.matches,j.key))[j.match.route.id];return{[j.key]:re}}else return Promise.resolve({[j.key]:{type:pt.error,error:on(404,{pathname:j.path})}})})),F=await V,L=(await D).reduce((j,Y)=>Object.assign(j,Y),{});return await Promise.all([pR(J,F,Se.signal,C,q.loaderData),gR(J,L,me)]),{loaderResults:F,fetcherResults:L}}function St(){le=!0,he.push(...Us()),K.forEach((q,J)=>{ee.has(J)&&pe.add(J),ft(J)})}function dt(q,J,ae){ae===void 0&&(ae={}),v.fetchers.set(q,J),W({fetchers:new Map(v.fetchers)},{flushSync:(ae&&ae.flushSync)===!0})}function Dt(q,J,ae,me){me===void 0&&(me={});let Se=Si(v.matches,J);yt(q),W({errors:{[Se.route.id]:ae},fetchers:new Map(v.fetchers)},{flushSync:(me&&me.flushSync)===!0})}function je(q){return X.set(q,(X.get(q)||0)+1),G.has(q)&&G.delete(q),v.fetchers.get(q)||ZN}function yt(q){let J=v.fetchers.get(q);ee.has(q)&&!(J&&J.state==="loading"&&ce.has(q))&&ft(q),K.delete(q),ce.delete(q),B.delete(q),d.v7_fetcherPersist&&G.delete(q),pe.delete(q),v.fetchers.delete(q)}function Gt(q){let J=(X.get(q)||0)-1;J<=0?(X.delete(q),G.add(q),d.v7_fetcherPersist||yt(q)):X.set(q,J),W({fetchers:new Map(v.fetchers)})}function ft(q){let J=ee.get(q);J&&(J.abort(),ee.delete(q))}function gn(q){for(let J of q){let ae=je(J),me=Ca(ae.data);v.fetchers.set(J,me)}}function js(){let q=[],J=!1;for(let ae of B){let me=v.fetchers.get(ae);Ge(me,"Expected fetcher: "+ae),me.state==="loading"&&(B.delete(ae),q.push(ae),J=!0)}return gn(q),J}function ho(q){let J=[];for(let[ae,me]of ce)if(me<q){let Se=v.fetchers.get(ae);Ge(Se,"Expected fetcher: "+ae),Se.state==="loading"&&(ft(ae),ce.delete(ae),J.push(ae))}return gn(J),J.length>0}function Nl(q,J){let ae=v.blockers.get(q)||Gl;return ge.get(q)!==J&&ge.set(q,J),ae}function Vs(q){v.blockers.delete(q),ge.delete(q)}function hs(q,J){let ae=v.blockers.get(q)||Gl;Ge(ae.state==="unblocked"&&J.state==="blocked"||ae.state==="blocked"&&J.state==="blocked"||ae.state==="blocked"&&J.state==="proceeding"||ae.state==="blocked"&&J.state==="unblocked"||ae.state==="proceeding"&&J.state==="unblocked","Invalid blocker state transition: "+ae.state+" -> "+J.state);let me=new Map(v.blockers);me.set(q,J),W({blockers:me})}function wa(q){let{currentLocation:J,nextLocation:ae,historyAction:me}=q;if(ge.size===0)return;ge.size>1&&il(!1,"A router only supports one blocker at a time");let Se=Array.from(ge.entries()),[C,V]=Se[Se.length-1],D=v.blockers.get(C);if(!(D&&D.state==="proceeding")&&V({currentLocation:J,nextLocation:ae,historyAction:me}))return C}function Gn(q){let J=on(404,{pathname:q}),ae=o||i,{matches:me,route:Se}=py(ae);return Us(),{notFoundMatches:me,route:Se,error:J}}function Us(q){let J=[];return ie.forEach((ae,me)=>{(!q||q(me))&&(ae.cancel(),J.push(me),ie.delete(me))}),J}function ds(q,J,ae){if(g=q,w=J,x=ae||null,!k&&v.navigation===V0){k=!0;let me=Bs(v.location,v.matches);me!=null&&W({restoreScrollPosition:me})}return()=>{g=null,w=null,x=null}}function Rn(q,J){return x&&x(q,J.map(me=>RN(me,v.loaderData)))||q.key}function mo(q,J){if(g&&w){let ae=Rn(q,J);g[ae]=w()}}function Bs(q,J){if(g){let ae=Rn(q,J),me=g[ae];if(typeof me=="number")return me}return null}function zs(q,J,ae){if(u)if(q){if(Object.keys(q[0].params).length>0)return{active:!0,matches:Xf(J,ae,l,!0)}}else return{active:!0,matches:Xf(J,ae,l,!0)||[]};return{active:!1,matches:null}}async function bn(q,J,ae,me){if(!u)return{type:"success",matches:q};let Se=q;for(;;){let C=o==null,V=o||i,D=a;try{await u({signal:ae,path:J,matches:Se,fetcherKey:me,patch:(j,Y)=>{ae.aborted||cy(j,Y,V,D,s)}})}catch(j){return{type:"error",error:j,partialMatches:Se}}finally{C&&!ae.aborted&&(i=[...i])}if(ae.aborted)return{type:"aborted"};let F=ki(V,J,l);if(F)return{type:"success",matches:F};let L=Xf(V,J,l,!0);if(!L||Se.length===L.length&&Se.every((j,Y)=>j.route.id===L[Y].route.id))return{type:"success",matches:null};Se=L}}function po(q){a={},o=Rh(q,s,void 0,a)}function er(q,J){let ae=o==null;cy(q,J,o||i,a,s),ae&&(i=[...i],W({}))}return O={get basename(){return l},get future(){return d},get state(){return v},get routes(){return i},get window(){return t},initialize:Te,subscribe:$e,enableScrollRestoration:ds,navigate:He,fetch:nn,revalidate:st,createHref:q=>e.history.createHref(q),encodeLocation:q=>e.history.encodeLocation(q),getFetcher:je,deleteFetcher:Gt,dispose:ye,getBlocker:Nl,deleteBlocker:Vs,patchRoutes:er,_internalFetchControllers:ee,_internalActiveDeferreds:ie,_internalSetRoutes:po},O}function rR(e){return e!=null&&("formData"in e&&e.formData!=null||"body"in e&&e.body!==void 0)}function rp(e,t,r,n,s,a,i,o){let l,c;if(i){l=[];for(let d of t)if(l.push(d),d.route.id===i){c=d;break}}else l=t,c=t[t.length-1];let u=Cd(s||".",Id(l,a),ca(e.pathname,r)||e.pathname,o==="path");if(s==null&&(u.search=e.search,u.hash=e.hash),(s==null||s===""||s===".")&&c){let d=$g(u.search);if(c.route.index&&!d)u.search=u.search?u.search.replace(/^\?/,"?index&"):"?index";else if(!c.route.index&&d){let m=new URLSearchParams(u.search),p=m.getAll("index");m.delete("index"),p.filter(x=>x).forEach(x=>m.append("index",x));let g=m.toString();u.search=g?"?"+g:""}}return n&&r!=="/"&&(u.pathname=u.pathname==="/"?r:ta([r,u.pathname])),Hi(u)}function ay(e,t,r,n){if(!n||!rR(n))return{path:r};if(n.formMethod&&!mR(n.formMethod))return{path:r,error:on(405,{method:n.formMethod})};let s=()=>({path:r,error:on(400,{type:"invalid-body"})}),a=n.formMethod||"get",i=e?a.toUpperCase():a.toLowerCase(),o=xT(r);if(n.body!==void 0){if(n.formEncType==="text/plain"){if(!Zn(i))return s();let m=typeof n.body=="string"?n.body:n.body instanceof FormData||n.body instanceof URLSearchParams?Array.from(n.body.entries()).reduce((p,g)=>{let[x,w]=g;return""+p+x+"="+w+`
`},""):String(n.body);return{path:r,submission:{formMethod:i,formAction:o,formEncType:n.formEncType,formData:void 0,json:void 0,text:m}}}else if(n.formEncType==="application/json"){if(!Zn(i))return s();try{let m=typeof n.body=="string"?JSON.parse(n.body):n.body;return{path:r,submission:{formMethod:i,formAction:o,formEncType:n.formEncType,formData:void 0,json:m,text:void 0}}}catch{return s()}}}Ge(typeof FormData=="function","FormData is not available in this environment");let l,c;if(n.formData)l=sp(n.formData),c=n.formData;else if(n.body instanceof FormData)l=sp(n.body),c=n.body;else if(n.body instanceof URLSearchParams)l=n.body,c=fy(l);else if(n.body==null)l=new URLSearchParams,c=new FormData;else try{l=new URLSearchParams(n.body),c=fy(l)}catch{return s()}let u={formMethod:i,formAction:o,formEncType:n&&n.formEncType||"application/x-www-form-urlencoded",formData:c,json:void 0,text:void 0};if(Zn(u.formMethod))return{path:r,submission:u};let d=pi(r);return t&&d.search&&$g(d.search)&&l.append("index",""),d.search="?"+l,{path:Hi(d),submission:u}}function iy(e,t,r){r===void 0&&(r=!1);let n=e.findIndex(s=>s.route.id===t);return n>=0?e.slice(0,r?n+1:n):e}function oy(e,t,r,n,s,a,i,o,l,c,u,d,m,p,g,x){let w=x?yn(x[1])?x[1].error:x[1].data:void 0,k=e.createURL(t.location),T=e.createURL(s),E=r;a&&t.errors?E=iy(r,Object.keys(t.errors)[0],!0):x&&yn(x[1])&&(E=iy(r,x[0]));let N=x?x[1].statusCode:void 0,M=i&&N&&N>=400,O=E.filter((_,S)=>{let{route:I}=_;if(I.lazy)return!0;if(I.loader==null)return!1;if(a)return np(I,t.loaderData,t.errors);if(nR(t.loaderData,t.matches[S],_)||l.some(R=>R===_.route.id))return!0;let b=t.matches[S],P=_;return ly(_,Rt({currentUrl:k,currentParams:b.params,nextUrl:T,nextParams:P.params},n,{actionResult:w,actionStatus:N,defaultShouldRevalidate:M?!1:o||k.pathname+k.search===T.pathname+T.search||k.search!==T.search||gT(b,P)}))}),v=[];return d.forEach((_,S)=>{if(a||!r.some(ue=>ue.route.id===_.routeId)||u.has(S))return;let I=ki(p,_.path,g);if(!I){v.push({key:S,routeId:_.routeId,path:_.path,matches:null,match:null,controller:null});return}let b=t.fetchers.get(S),P=ec(I,_.path),R=!1;m.has(S)?R=!1:c.has(S)?(c.delete(S),R=!0):b&&b.state!=="idle"&&b.data===void 0?R=o:R=ly(P,Rt({currentUrl:k,currentParams:t.matches[t.matches.length-1].params,nextUrl:T,nextParams:r[r.length-1].params},n,{actionResult:w,actionStatus:N,defaultShouldRevalidate:M?!1:o})),R&&v.push({key:S,routeId:_.routeId,path:_.path,matches:I,match:P,controller:new AbortController})}),[O,v]}function np(e,t,r){if(e.lazy)return!0;if(!e.loader)return!1;let n=t!=null&&t[e.id]!==void 0,s=r!=null&&r[e.id]!==void 0;return!n&&s?!1:typeof e.loader=="function"&&e.loader.hydrate===!0?!0:!n&&!s}function nR(e,t,r){let n=!t||r.route.id!==t.route.id,s=e[r.route.id]===void 0;return n||s}function gT(e,t){let r=e.route.path;return e.pathname!==t.pathname||r!=null&&r.endsWith("*")&&e.params["*"]!==t.params["*"]}function ly(e,t){if(e.route.shouldRevalidate){let r=e.route.shouldRevalidate(t);if(typeof r=="boolean")return r}return t.defaultShouldRevalidate}function cy(e,t,r,n,s){var a;let i;if(e){let c=n[e];Ge(c,"No route found to patch children into: routeId = "+e),c.children||(c.children=[]),i=c.children}else i=r;let o=t.filter(c=>!i.some(u=>vT(c,u))),l=Rh(o,s,[e||"_","patch",String(((a=i)==null?void 0:a.length)||"0")],n);i.push(...l)}function vT(e,t){return"id"in e&&"id"in t&&e.id===t.id?!0:e.index===t.index&&e.path===t.path&&e.caseSensitive===t.caseSensitive?(!e.children||e.children.length===0)&&(!t.children||t.children.length===0)?!0:e.children.every((r,n)=>{var s;return(s=t.children)==null?void 0:s.some(a=>vT(r,a))}):!1}async function sR(e,t,r){if(!e.lazy)return;let n=await e.lazy();if(!e.lazy)return;let s=r[e.id];Ge(s,"No route found in manifest");let a={};for(let i in n){let l=s[i]!==void 0&&i!=="hasErrorBoundary";il(!l,'Route "'+s.id+'" has a static property "'+i+'" defined but its lazy function is also returning a value for this property. '+('The lazy route property "'+i+'" will be ignored.')),!l&&!CN.has(i)&&(a[i]=n[i])}Object.assign(s,a),Object.assign(s,Rt({},t(s),{lazy:void 0}))}async function aR(e){let{matches:t}=e,r=t.filter(s=>s.shouldLoad);return(await Promise.all(r.map(s=>s.resolve()))).reduce((s,a,i)=>Object.assign(s,{[r[i].route.id]:a}),{})}async function iR(e,t,r,n,s,a,i,o,l,c){let u=a.map(p=>p.route.lazy?sR(p.route,l,o):void 0),d=a.map((p,g)=>{let x=u[g],w=s.some(T=>T.route.id===p.route.id);return Rt({},p,{shouldLoad:w,resolve:async T=>(T&&n.method==="GET"&&(p.route.lazy||p.route.loader)&&(w=!0),w?oR(t,n,p,x,T,c):Promise.resolve({type:pt.data,result:void 0}))})}),m=await e({matches:d,request:n,params:a[0].params,fetcherKey:i,context:c});try{await Promise.all(u)}catch{}return m}async function oR(e,t,r,n,s,a){let i,o,l=c=>{let u,d=new Promise((g,x)=>u=x);o=()=>u(),t.signal.addEventListener("abort",o);let m=g=>typeof c!="function"?Promise.reject(new Error("You cannot call the handler for a route which defines a boolean "+('"'+e+'" [routeId: '+r.route.id+"]"))):c({request:t,params:r.params,context:a},...g!==void 0?[g]:[]),p=(async()=>{try{return{type:"data",result:await(s?s(x=>m(x)):m())}}catch(g){return{type:"error",result:g}}})();return Promise.race([p,d])};try{let c=r.route[e];if(n)if(c){let u,[d]=await Promise.all([l(c).catch(m=>{u=m}),n]);if(u!==void 0)throw u;i=d}else if(await n,c=r.route[e],c)i=await l(c);else if(e==="action"){let u=new URL(t.url),d=u.pathname+u.search;throw on(405,{method:t.method,pathname:d,routeId:r.route.id})}else return{type:pt.data,result:void 0};else if(c)i=await l(c);else{let u=new URL(t.url),d=u.pathname+u.search;throw on(404,{pathname:d})}Ge(i.result!==void 0,"You defined "+(e==="action"?"an action":"a loader")+" for route "+('"'+r.route.id+"\" but didn't return anything from your `"+e+"` ")+"function. Please return a value or `null`.")}catch(c){return{type:pt.error,result:c}}finally{o&&t.signal.removeEventListener("abort",o)}return i}async function lR(e){let{result:t,type:r}=e;if(yT(t)){let d;try{let m=t.headers.get("Content-Type");m&&/\bapplication\/json\b/.test(m)?t.body==null?d=null:d=await t.json():d=await t.text()}catch(m){return{type:pt.error,error:m}}return r===pt.error?{type:pt.error,error:new Ph(t.status,t.statusText,d),statusCode:t.status,headers:t.headers}:{type:pt.data,data:d,statusCode:t.status,headers:t.headers}}if(r===pt.error){if(gy(t)){var n,s;if(t.data instanceof Error){var a,i;return{type:pt.error,error:t.data,statusCode:(a=t.init)==null?void 0:a.status,headers:(i=t.init)!=null&&i.headers?new Headers(t.init.headers):void 0}}return{type:pt.error,error:new Ph(((n=t.init)==null?void 0:n.status)||500,void 0,t.data),statusCode:Qc(t)?t.status:void 0,headers:(s=t.init)!=null&&s.headers?new Headers(t.init.headers):void 0}}return{type:pt.error,error:t,statusCode:Qc(t)?t.status:void 0}}if(dR(t)){var o,l;return{type:pt.deferred,deferredData:t,statusCode:(o=t.init)==null?void 0:o.status,headers:((l=t.init)==null?void 0:l.headers)&&new Headers(t.init.headers)}}if(gy(t)){var c,u;return{type:pt.data,data:t.data,statusCode:(c=t.init)==null?void 0:c.status,headers:(u=t.init)!=null&&u.headers?new Headers(t.init.headers):void 0}}return{type:pt.data,data:t}}function cR(e,t,r,n,s,a){let i=e.headers.get("Location");if(Ge(i,"Redirects returned/thrown from loaders/actions must have a Location header"),!Bg.test(i)){let o=n.slice(0,n.findIndex(l=>l.route.id===r)+1);i=rp(new URL(t.url),o,s,!0,i,a),e.headers.set("Location",i)}return e}function uy(e,t,r){if(Bg.test(e)){let n=e,s=n.startsWith("//")?new URL(t.protocol+n):new URL(n),a=ca(s.pathname,r)!=null;if(s.origin===t.origin&&a)return s.pathname+s.search+s.hash}return e}function _o(e,t,r,n){let s=e.createURL(xT(t)).toString(),a={signal:r};if(n&&Zn(n.formMethod)){let{formMethod:i,formEncType:o}=n;a.method=i.toUpperCase(),o==="application/json"?(a.headers=new Headers({"Content-Type":o}),a.body=JSON.stringify(n.json)):o==="text/plain"?a.body=n.text:o==="application/x-www-form-urlencoded"&&n.formData?a.body=sp(n.formData):a.body=n.formData}return new Request(s,a)}function sp(e){let t=new URLSearchParams;for(let[r,n]of e.entries())t.append(r,typeof n=="string"?n:n.name);return t}function fy(e){let t=new FormData;for(let[r,n]of e.entries())t.append(r,n);return t}function uR(e,t,r,n,s){let a={},i=null,o,l=!1,c={},u=r&&yn(r[1])?r[1].error:void 0;return e.forEach(d=>{if(!(d.route.id in t))return;let m=d.route.id,p=t[m];if(Ge(!Ri(p),"Cannot handle redirect results in processLoaderData"),yn(p)){let g=p.error;u!==void 0&&(g=u,u=void 0),i=i||{};{let x=Si(e,m);i[x.route.id]==null&&(i[x.route.id]=g)}a[m]=void 0,l||(l=!0,o=Qc(p.error)?p.error.status:500),p.headers&&(c[m]=p.headers)}else Va(p)?(n.set(m,p.deferredData),a[m]=p.deferredData.data,p.statusCode!=null&&p.statusCode!==200&&!l&&(o=p.statusCode),p.headers&&(c[m]=p.headers)):(a[m]=p.data,p.statusCode&&p.statusCode!==200&&!l&&(o=p.statusCode),p.headers&&(c[m]=p.headers))}),u!==void 0&&r&&(i={[r[0]]:u},a[r[0]]=void 0),{loaderData:a,errors:i,statusCode:o||200,loaderHeaders:c}}function hy(e,t,r,n,s,a,i){let{loaderData:o,errors:l}=uR(t,r,n,i);return s.forEach(c=>{let{key:u,match:d,controller:m}=c,p=a[u];if(Ge(p,"Did not find corresponding fetcher result"),!(m&&m.signal.aborted))if(yn(p)){let g=Si(e.matches,d==null?void 0:d.route.id);l&&l[g.route.id]||(l=Rt({},l,{[g.route.id]:p.error})),e.fetchers.delete(u)}else if(Ri(p))Ge(!1,"Unhandled fetcher revalidation redirect");else if(Va(p))Ge(!1,"Unhandled fetcher deferred data");else{let g=Ca(p.data);e.fetchers.set(u,g)}}),{loaderData:o,errors:l}}function dy(e,t,r,n){let s=Rt({},t);for(let a of r){let i=a.route.id;if(t.hasOwnProperty(i)?t[i]!==void 0&&(s[i]=t[i]):e[i]!==void 0&&a.route.loader&&(s[i]=e[i]),n&&n.hasOwnProperty(i))break}return s}function my(e){return e?yn(e[1])?{actionData:{}}:{actionData:{[e[0]]:e[1].data}}:{}}function Si(e,t){return(t?e.slice(0,e.findIndex(n=>n.route.id===t)+1):[...e]).reverse().find(n=>n.route.hasErrorBoundary===!0)||e[0]}function py(e){let t=e.length===1?e[0]:e.find(r=>r.index||!r.path||r.path==="/")||{id:"__shim-error-route__"};return{matches:[{params:{},pathname:"",pathnameBase:"",route:t}],route:t}}function on(e,t){let{pathname:r,routeId:n,method:s,type:a,message:i}=t===void 0?{}:t,o="Unknown Server Error",l="Unknown @remix-run/router error";return e===400?(o="Bad Request",s&&r&&n?l="You made a "+s+' request to "'+r+'" but '+('did not provide a `loader` for route "'+n+'", ')+"so there is no way to handle the request.":a==="defer-action"?l="defer() is not supported in actions":a==="invalid-body"&&(l="Unable to encode submission body")):e===403?(o="Forbidden",l='Route "'+n+'" does not match URL "'+r+'"'):e===404?(o="Not Found",l='No route matches URL "'+r+'"'):e===405&&(o="Method Not Allowed",s&&r&&n?l="You made a "+s.toUpperCase()+' request to "'+r+'" but '+('did not provide an `action` for route "'+n+'", ')+"so there is no way to handle the request.":s&&(l='Invalid request method "'+s.toUpperCase()+'"')),new Ph(e||500,o,new Error(l),!0)}function wf(e){let t=Object.entries(e);for(let r=t.length-1;r>=0;r--){let[n,s]=t[r];if(Ri(s))return{key:n,result:s}}}function xT(e){let t=typeof e=="string"?pi(e):e;return Hi(Rt({},t,{hash:""}))}function fR(e,t){return e.pathname!==t.pathname||e.search!==t.search?!1:e.hash===""?t.hash!=="":e.hash===t.hash?!0:t.hash!==""}function hR(e){return yT(e.result)&&QN.has(e.result.status)}function Va(e){return e.type===pt.deferred}function yn(e){return e.type===pt.error}function Ri(e){return(e&&e.type)===pt.redirect}function gy(e){return typeof e=="object"&&e!=null&&"type"in e&&"data"in e&&"init"in e&&e.type==="DataWithResponseInit"}function dR(e){let t=e;return t&&typeof t=="object"&&typeof t.data=="object"&&typeof t.subscribe=="function"&&typeof t.cancel=="function"&&typeof t.resolveData=="function"}function yT(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.headers=="object"&&typeof e.body<"u"}function mR(e){return YN.has(e.toLowerCase())}function Zn(e){return qN.has(e.toLowerCase())}async function pR(e,t,r,n,s){let a=Object.entries(t);for(let i=0;i<a.length;i++){let[o,l]=a[i],c=e.find(m=>(m==null?void 0:m.route.id)===o);if(!c)continue;let u=n.find(m=>m.route.id===c.route.id),d=u!=null&&!gT(u,c)&&(s&&s[c.route.id])!==void 0;Va(l)&&d&&await zg(l,r,!1).then(m=>{m&&(t[o]=m)})}}async function gR(e,t,r){for(let n=0;n<r.length;n++){let{key:s,routeId:a,controller:i}=r[n],o=t[s];e.find(c=>(c==null?void 0:c.route.id)===a)&&Va(o)&&(Ge(i,"Expected an AbortController for revalidating fetcher deferred result"),await zg(o,i.signal,!0).then(c=>{c&&(t[s]=c)}))}}async function zg(e,t,r){if(r===void 0&&(r=!1),!await e.deferredData.resolveData(t)){if(r)try{return{type:pt.data,data:e.deferredData.unwrappedData}}catch(s){return{type:pt.error,error:s}}return{type:pt.data,data:e.deferredData.data}}}function $g(e){return new URLSearchParams(e).getAll("index").some(t=>t==="")}function ec(e,t){let r=typeof t=="string"?pi(t).search:t.search;if(e[e.length-1].route.index&&$g(r||""))return e[e.length-1];let n=dT(e);return n[n.length-1]}function vy(e){let{formMethod:t,formAction:r,formEncType:n,text:s,formData:a,json:i}=e;if(!(!t||!r||!n)){if(s!=null)return{formMethod:t,formAction:r,formEncType:n,formData:void 0,json:void 0,text:s};if(a!=null)return{formMethod:t,formAction:r,formEncType:n,formData:a,json:void 0,text:void 0};if(i!==void 0)return{formMethod:t,formAction:r,formEncType:n,formData:void 0,json:i,text:void 0}}}function U0(e,t){return t?{state:"loading",location:e,formMethod:t.formMethod,formAction:t.formAction,formEncType:t.formEncType,formData:t.formData,json:t.json,text:t.text}:{state:"loading",location:e,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0}}function vR(e,t){return{state:"submitting",location:e,formMethod:t.formMethod,formAction:t.formAction,formEncType:t.formEncType,formData:t.formData,json:t.json,text:t.text}}function Kl(e,t){return e?{state:"loading",formMethod:e.formMethod,formAction:e.formAction,formEncType:e.formEncType,formData:e.formData,json:e.json,text:e.text,data:t}:{state:"loading",formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0,data:t}}function xR(e,t){return{state:"submitting",formMethod:e.formMethod,formAction:e.formAction,formEncType:e.formEncType,formData:e.formData,json:e.json,text:e.text,data:t?t.data:void 0}}function Ca(e){return{state:"idle",formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0,data:e}}function yR(e,t){try{let r=e.sessionStorage.getItem(pT);if(r){let n=JSON.parse(r);for(let[s,a]of Object.entries(n||{}))a&&Array.isArray(a)&&t.set(s,new Set(a||[]))}}catch{}}function _R(e,t){if(t.size>0){let r={};for(let[n,s]of t)r[n]=[...s];try{e.sessionStorage.setItem(pT,JSON.stringify(r))}catch(n){il(!1,"Failed to save applied view transitions in sessionStorage ("+n+").")}}}/**
 * React Router v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Dh(){return Dh=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Dh.apply(this,arguments)}const Eu=z.createContext(null),Wg=z.createContext(null),xa=z.createContext(null),Hg=z.createContext(null),Ps=z.createContext({outlet:null,matches:[],isDataRoute:!1}),_T=z.createContext(null);function wR(e,t){let{relative:r}=t===void 0?{}:t;wl()||Ge(!1);let{basename:n,navigator:s}=z.useContext(xa),{hash:a,pathname:i,search:o}=Nd(e,{relative:r}),l=i;return n!=="/"&&(l=i==="/"?n:ta([n,i])),s.createHref({pathname:l,search:o,hash:a})}function wl(){return z.useContext(Hg)!=null}function ya(){return wl()||Ge(!1),z.useContext(Hg).location}function wT(e){z.useContext(xa).static||z.useLayoutEffect(e)}function gi(){let{isDataRoute:e}=z.useContext(Ps);return e?MR():ER()}function ER(){wl()||Ge(!1);let e=z.useContext(Eu),{basename:t,future:r,navigator:n}=z.useContext(xa),{matches:s}=z.useContext(Ps),{pathname:a}=ya(),i=JSON.stringify(Id(s,r.v7_relativeSplatPath)),o=z.useRef(!1);return wT(()=>{o.current=!0}),z.useCallback(function(c,u){if(u===void 0&&(u={}),!o.current)return;if(typeof c=="number"){n.go(c);return}let d=Cd(c,JSON.parse(i),a,u.relative==="path");e==null&&t!=="/"&&(d.pathname=d.pathname==="/"?t:ta([t,d.pathname])),(u.replace?n.replace:n.push)(d,u.state,u)},[t,n,i,a,e])}const TR=z.createContext(null);function kR(e){let t=z.useContext(Ps).outlet;return t&&z.createElement(TR.Provider,{value:e},t)}function SR(){let{matches:e}=z.useContext(Ps),t=e[e.length-1];return t?t.params:{}}function Nd(e,t){let{relative:r}=t===void 0?{}:t,{future:n}=z.useContext(xa),{matches:s}=z.useContext(Ps),{pathname:a}=ya(),i=JSON.stringify(Id(s,n.v7_relativeSplatPath));return z.useMemo(()=>Cd(e,JSON.parse(i),a,r==="path"),[e,i,a,r])}function AR(e,t,r,n){wl()||Ge(!1);let{navigator:s}=z.useContext(xa),{matches:a}=z.useContext(Ps),i=a[a.length-1],o=i?i.params:{};i&&i.pathname;let l=i?i.pathnameBase:"/";i&&i.route;let c=ya(),u;u=c;let d=u.pathname||"/",m=d;if(l!=="/"){let x=l.replace(/^\//,"").split("/");m="/"+d.replace(/^\//,"").split("/").slice(x.length).join("/")}let p=ki(e,{pathname:m});return bR(p&&p.map(x=>Object.assign({},x,{params:Object.assign({},o,x.params),pathname:ta([l,s.encodeLocation?s.encodeLocation(x.pathname).pathname:x.pathname]),pathnameBase:x.pathnameBase==="/"?l:ta([l,s.encodeLocation?s.encodeLocation(x.pathnameBase).pathname:x.pathnameBase])})),a,r,n)}function IR(){let e=OR(),t=Qc(e)?e.status+" "+e.statusText:e instanceof Error?e.message:JSON.stringify(e),r=e instanceof Error?e.stack:null,s={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return z.createElement(z.Fragment,null,z.createElement("h2",null,"Unexpected Application Error!"),z.createElement("h3",{style:{fontStyle:"italic"}},t),r?z.createElement("pre",{style:s},r):null,null)}const CR=z.createElement(IR,null);class NR extends z.Component{constructor(t){super(t),this.state={location:t.location,revalidation:t.revalidation,error:t.error}}static getDerivedStateFromError(t){return{error:t}}static getDerivedStateFromProps(t,r){return r.location!==t.location||r.revalidation!=="idle"&&t.revalidation==="idle"?{error:t.error,location:t.location,revalidation:t.revalidation}:{error:t.error!==void 0?t.error:r.error,location:r.location,revalidation:t.revalidation||r.revalidation}}componentDidCatch(t,r){console.error("React Router caught the following error during render",t,r)}render(){return this.state.error!==void 0?z.createElement(Ps.Provider,{value:this.props.routeContext},z.createElement(_T.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function RR(e){let{routeContext:t,match:r,children:n}=e,s=z.useContext(Eu);return s&&s.static&&s.staticContext&&(r.route.errorElement||r.route.ErrorBoundary)&&(s.staticContext._deepestRenderedBoundaryId=r.route.id),z.createElement(Ps.Provider,{value:t},n)}function bR(e,t,r,n){var s;if(t===void 0&&(t=[]),r===void 0&&(r=null),n===void 0&&(n=null),e==null){var a;if(!r)return null;if(r.errors)e=r.matches;else if((a=n)!=null&&a.v7_partialHydration&&t.length===0&&!r.initialized&&r.matches.length>0)e=r.matches;else return null}let i=e,o=(s=r)==null?void 0:s.errors;if(o!=null){let u=i.findIndex(d=>d.route.id&&(o==null?void 0:o[d.route.id])!==void 0);u>=0||Ge(!1),i=i.slice(0,Math.min(i.length,u+1))}let l=!1,c=-1;if(r&&n&&n.v7_partialHydration)for(let u=0;u<i.length;u++){let d=i[u];if((d.route.HydrateFallback||d.route.hydrateFallbackElement)&&(c=u),d.route.id){let{loaderData:m,errors:p}=r,g=d.route.loader&&m[d.route.id]===void 0&&(!p||p[d.route.id]===void 0);if(d.route.lazy||g){l=!0,c>=0?i=i.slice(0,c+1):i=[i[0]];break}}}return i.reduceRight((u,d,m)=>{let p,g=!1,x=null,w=null;r&&(p=o&&d.route.id?o[d.route.id]:void 0,x=d.route.errorElement||CR,l&&(c<0&&m===0?(LR("route-fallback"),g=!0,w=null):c===m&&(g=!0,w=d.route.hydrateFallbackElement||null)));let k=t.concat(i.slice(0,m+1)),T=()=>{let E;return p?E=x:g?E=w:d.route.Component?E=z.createElement(d.route.Component,null):d.route.element?E=d.route.element:E=u,z.createElement(RR,{match:d,routeContext:{outlet:u,matches:k,isDataRoute:r!=null},children:E})};return r&&(d.route.ErrorBoundary||d.route.errorElement||m===0)?z.createElement(NR,{location:r.location,revalidation:r.revalidation,component:x,error:p,children:T(),routeContext:{outlet:null,matches:k,isDataRoute:!0}}):T()},null)}var ET=function(e){return e.UseBlocker="useBlocker",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e}(ET||{}),TT=function(e){return e.UseBlocker="useBlocker",e.UseLoaderData="useLoaderData",e.UseActionData="useActionData",e.UseRouteError="useRouteError",e.UseNavigation="useNavigation",e.UseRouteLoaderData="useRouteLoaderData",e.UseMatches="useMatches",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e.UseRouteId="useRouteId",e}(TT||{});function PR(e){let t=z.useContext(Eu);return t||Ge(!1),t}function DR(e){let t=z.useContext(Wg);return t||Ge(!1),t}function FR(e){let t=z.useContext(Ps);return t||Ge(!1),t}function kT(e){let t=FR(),r=t.matches[t.matches.length-1];return r.route.id||Ge(!1),r.route.id}function OR(){var e;let t=z.useContext(_T),r=DR(TT.UseRouteError),n=kT();return t!==void 0?t:(e=r.errors)==null?void 0:e[n]}function MR(){let{router:e}=PR(ET.UseNavigateStable),t=kT(),r=z.useRef(!1);return wT(()=>{r.current=!0}),z.useCallback(function(s,a){a===void 0&&(a={}),r.current&&(typeof s=="number"?e.navigate(s):e.navigate(s,Dh({fromRouteId:t},a)))},[e,t])}const xy={};function LR(e,t,r){xy[e]||(xy[e]=!0)}function jR(e,t){e==null||e.v7_startTransition,(e==null?void 0:e.v7_relativeSplatPath)===void 0&&(!t||t.v7_relativeSplatPath),t&&(t.v7_fetcherPersist,t.v7_normalizeFormMethod,t.v7_partialHydration,t.v7_skipActionErrorRevalidation)}function VR(e){let{to:t,replace:r,state:n,relative:s}=e;wl()||Ge(!1);let{future:a,static:i}=z.useContext(xa),{matches:o}=z.useContext(Ps),{pathname:l}=ya(),c=gi(),u=Cd(t,Id(o,a.v7_relativeSplatPath),l,s==="path"),d=JSON.stringify(u);return z.useEffect(()=>c(JSON.parse(d),{replace:r,state:n,relative:s}),[c,d,s,r,n]),null}function ST(e){return kR(e.context)}function UR(e){let{basename:t="/",children:r=null,location:n,navigationType:s=Qt.Pop,navigator:a,static:i=!1,future:o}=e;wl()&&Ge(!1);let l=t.replace(/^\/*/,"/"),c=z.useMemo(()=>({basename:l,navigator:a,static:i,future:Dh({v7_relativeSplatPath:!1},o)}),[l,o,a,i]);typeof n=="string"&&(n=pi(n));let{pathname:u="/",search:d="",hash:m="",state:p=null,key:g="default"}=n,x=z.useMemo(()=>{let w=ca(u,l);return w==null?null:{location:{pathname:w,search:d,hash:m,state:p,key:g},navigationType:s}},[l,u,d,m,p,g,s]);return x==null?null:z.createElement(xa.Provider,{value:c},z.createElement(Hg.Provider,{children:r,value:x}))}new Promise(()=>{});function BR(e){let t={hasErrorBoundary:e.ErrorBoundary!=null||e.errorElement!=null};return e.Component&&Object.assign(t,{element:z.createElement(e.Component),Component:void 0}),e.HydrateFallback&&Object.assign(t,{hydrateFallbackElement:z.createElement(e.HydrateFallback),HydrateFallback:void 0}),e.ErrorBoundary&&Object.assign(t,{errorElement:z.createElement(e.ErrorBoundary),ErrorBoundary:void 0}),t}/**
 * React Router DOM v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function ol(){return ol=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},ol.apply(this,arguments)}function AT(e,t){if(e==null)return{};var r={},n=Object.keys(e),s,a;for(a=0;a<n.length;a++)s=n[a],!(t.indexOf(s)>=0)&&(r[s]=e[s]);return r}function zR(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}function $R(e,t){return e.button===0&&(!t||t==="_self")&&!zR(e)}const WR=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],HR=["aria-current","caseSensitive","className","end","style","to","viewTransition","children"],GR="6";try{window.__reactRouterVersion=GR}catch{}function KR(e,t){return tR({basename:void 0,future:ol({},void 0,{v7_prependBasename:!0}),history:SN({window:void 0}),hydrationData:qR(),routes:e,mapRouteProperties:BR,dataStrategy:void 0,patchRoutesOnNavigation:void 0,window:void 0}).initialize()}function qR(){var e;let t=(e=window)==null?void 0:e.__staticRouterHydrationData;return t&&t.errors&&(t=ol({},t,{errors:XR(t.errors)})),t}function XR(e){if(!e)return null;let t=Object.entries(e),r={};for(let[n,s]of t)if(s&&s.__type==="RouteErrorResponse")r[n]=new Ph(s.status,s.statusText,s.data,s.internal===!0);else if(s&&s.__type==="Error"){if(s.__subType){let a=window[s.__subType];if(typeof a=="function")try{let i=new a(s.message);i.stack="",r[n]=i}catch{}}if(r[n]==null){let a=new Error(s.message);a.stack="",r[n]=a}}else r[n]=s;return r}const IT=z.createContext({isTransitioning:!1}),YR=z.createContext(new Map),QR="startTransition",yy=hC[QR],JR="flushSync",_y=kN[JR];function ZR(e){yy?yy(e):e()}function ql(e){_y?_y(e):e()}let eb=class{constructor(){this.status="pending",this.promise=new Promise((t,r)=>{this.resolve=n=>{this.status==="pending"&&(this.status="resolved",t(n))},this.reject=n=>{this.status==="pending"&&(this.status="rejected",r(n))}})}};function tb(e){let{fallbackElement:t,router:r,future:n}=e,[s,a]=z.useState(r.state),[i,o]=z.useState(),[l,c]=z.useState({isTransitioning:!1}),[u,d]=z.useState(),[m,p]=z.useState(),[g,x]=z.useState(),w=z.useRef(new Map),{v7_startTransition:k}=n||{},T=z.useCallback(_=>{k?ZR(_):_()},[k]),E=z.useCallback((_,S)=>{let{deletedFetchers:I,flushSync:b,viewTransitionOpts:P}=S;_.fetchers.forEach((ue,le)=>{ue.data!==void 0&&w.current.set(le,ue.data)}),I.forEach(ue=>w.current.delete(ue));let R=r.window==null||r.window.document==null||typeof r.window.document.startViewTransition!="function";if(!P||R){b?ql(()=>a(_)):T(()=>a(_));return}if(b){ql(()=>{m&&(u&&u.resolve(),m.skipTransition()),c({isTransitioning:!0,flushSync:!0,currentLocation:P.currentLocation,nextLocation:P.nextLocation})});let ue=r.window.document.startViewTransition(()=>{ql(()=>a(_))});ue.finished.finally(()=>{ql(()=>{d(void 0),p(void 0),o(void 0),c({isTransitioning:!1})})}),ql(()=>p(ue));return}m?(u&&u.resolve(),m.skipTransition(),x({state:_,currentLocation:P.currentLocation,nextLocation:P.nextLocation})):(o(_),c({isTransitioning:!0,flushSync:!1,currentLocation:P.currentLocation,nextLocation:P.nextLocation}))},[r.window,m,u,w,T]);z.useLayoutEffect(()=>r.subscribe(E),[r,E]),z.useEffect(()=>{l.isTransitioning&&!l.flushSync&&d(new eb)},[l]),z.useEffect(()=>{if(u&&i&&r.window){let _=i,S=u.promise,I=r.window.document.startViewTransition(async()=>{T(()=>a(_)),await S});I.finished.finally(()=>{d(void 0),p(void 0),o(void 0),c({isTransitioning:!1})}),p(I)}},[T,i,u,r.window]),z.useEffect(()=>{u&&i&&s.location.key===i.location.key&&u.resolve()},[u,m,s.location,i]),z.useEffect(()=>{!l.isTransitioning&&g&&(o(g.state),c({isTransitioning:!0,flushSync:!1,currentLocation:g.currentLocation,nextLocation:g.nextLocation}),x(void 0))},[l.isTransitioning,g]),z.useEffect(()=>{},[]);let N=z.useMemo(()=>({createHref:r.createHref,encodeLocation:r.encodeLocation,go:_=>r.navigate(_),push:(_,S,I)=>r.navigate(_,{state:S,preventScrollReset:I==null?void 0:I.preventScrollReset}),replace:(_,S,I)=>r.navigate(_,{replace:!0,state:S,preventScrollReset:I==null?void 0:I.preventScrollReset})}),[r]),M=r.basename||"/",O=z.useMemo(()=>({router:r,navigator:N,static:!1,basename:M}),[r,N,M]),v=z.useMemo(()=>({v7_relativeSplatPath:r.future.v7_relativeSplatPath}),[r.future.v7_relativeSplatPath]);return z.useEffect(()=>jR(n,r.future),[n,r.future]),z.createElement(z.Fragment,null,z.createElement(Eu.Provider,{value:O},z.createElement(Wg.Provider,{value:s},z.createElement(YR.Provider,{value:w.current},z.createElement(IT.Provider,{value:l},z.createElement(UR,{basename:M,location:s.location,navigationType:s.historyAction,navigator:N,future:v},s.initialized||r.future.v7_partialHydration?z.createElement(rb,{routes:r.routes,future:r.future,state:s}):t))))),null)}const rb=z.memo(nb);function nb(e){let{routes:t,future:r,state:n}=e;return AR(t,void 0,n,r)}const sb=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",ab=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,tt=z.forwardRef(function(t,r){let{onClick:n,relative:s,reloadDocument:a,replace:i,state:o,target:l,to:c,preventScrollReset:u,viewTransition:d}=t,m=AT(t,WR),{basename:p}=z.useContext(xa),g,x=!1;if(typeof c=="string"&&ab.test(c)&&(g=c,sb))try{let E=new URL(window.location.href),N=c.startsWith("//")?new URL(E.protocol+c):new URL(c),M=ca(N.pathname,p);N.origin===E.origin&&M!=null?c=M+N.search+N.hash:x=!0}catch{}let w=wR(c,{relative:s}),k=ob(c,{replace:i,state:o,target:l,preventScrollReset:u,relative:s,viewTransition:d});function T(E){n&&n(E),E.defaultPrevented||k(E)}return z.createElement("a",ol({},m,{href:g||w,onClick:x||a?n:T,ref:r,target:l}))}),Sa=z.forwardRef(function(t,r){let{"aria-current":n="page",caseSensitive:s=!1,className:a="",end:i=!1,style:o,to:l,viewTransition:c,children:u}=t,d=AT(t,HR),m=Nd(l,{relative:d.relative}),p=ya(),g=z.useContext(Wg),{navigator:x,basename:w}=z.useContext(xa),k=g!=null&&lb(m)&&c===!0,T=x.encodeLocation?x.encodeLocation(m).pathname:m.pathname,E=p.pathname,N=g&&g.navigation&&g.navigation.location?g.navigation.location.pathname:null;s||(E=E.toLowerCase(),N=N?N.toLowerCase():null,T=T.toLowerCase()),N&&w&&(N=ca(N,w)||N);const M=T!=="/"&&T.endsWith("/")?T.length-1:T.length;let O=E===T||!i&&E.startsWith(T)&&E.charAt(M)==="/",v=N!=null&&(N===T||!i&&N.startsWith(T)&&N.charAt(T.length)==="/"),_={isActive:O,isPending:v,isTransitioning:k},S=O?n:void 0,I;typeof a=="function"?I=a(_):I=[a,O?"active":null,v?"pending":null,k?"transitioning":null].filter(Boolean).join(" ");let b=typeof o=="function"?o(_):o;return z.createElement(tt,ol({},d,{"aria-current":S,className:I,ref:r,style:b,to:l,viewTransition:c}),typeof u=="function"?u(_):u)});var ap;(function(e){e.UseScrollRestoration="useScrollRestoration",e.UseSubmit="useSubmit",e.UseSubmitFetcher="useSubmitFetcher",e.UseFetcher="useFetcher",e.useViewTransitionState="useViewTransitionState"})(ap||(ap={}));var wy;(function(e){e.UseFetcher="useFetcher",e.UseFetchers="useFetchers",e.UseScrollRestoration="useScrollRestoration"})(wy||(wy={}));function ib(e){let t=z.useContext(Eu);return t||Ge(!1),t}function ob(e,t){let{target:r,replace:n,state:s,preventScrollReset:a,relative:i,viewTransition:o}=t===void 0?{}:t,l=gi(),c=ya(),u=Nd(e,{relative:i});return z.useCallback(d=>{if($R(d,r)){d.preventDefault();let m=n!==void 0?n:Hi(c)===Hi(u);l(e,{replace:m,state:s,preventScrollReset:a,relative:i,viewTransition:o})}},[c,l,u,n,s,r,e,a,i,o])}function lb(e,t){t===void 0&&(t={});let r=z.useContext(IT);r==null&&Ge(!1);let{basename:n}=ib(ap.useViewTransitionState),s=Nd(e,{relative:t.relative});if(!r.isTransitioning)return!1;let a=ca(r.currentLocation.pathname,n)||r.currentLocation.pathname,i=ca(r.nextLocation.pathname,n)||r.nextLocation.pathname;return bh(s.pathname,i)!=null||bh(s.pathname,a)!=null}var Ey={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const CT=function(e){const t=[];let r=0;for(let n=0;n<e.length;n++){let s=e.charCodeAt(n);s<128?t[r++]=s:s<2048?(t[r++]=s>>6|192,t[r++]=s&63|128):(s&64512)===55296&&n+1<e.length&&(e.charCodeAt(n+1)&64512)===56320?(s=65536+((s&1023)<<10)+(e.charCodeAt(++n)&1023),t[r++]=s>>18|240,t[r++]=s>>12&63|128,t[r++]=s>>6&63|128,t[r++]=s&63|128):(t[r++]=s>>12|224,t[r++]=s>>6&63|128,t[r++]=s&63|128)}return t},cb=function(e){const t=[];let r=0,n=0;for(;r<e.length;){const s=e[r++];if(s<128)t[n++]=String.fromCharCode(s);else if(s>191&&s<224){const a=e[r++];t[n++]=String.fromCharCode((s&31)<<6|a&63)}else if(s>239&&s<365){const a=e[r++],i=e[r++],o=e[r++],l=((s&7)<<18|(a&63)<<12|(i&63)<<6|o&63)-65536;t[n++]=String.fromCharCode(55296+(l>>10)),t[n++]=String.fromCharCode(56320+(l&1023))}else{const a=e[r++],i=e[r++];t[n++]=String.fromCharCode((s&15)<<12|(a&63)<<6|i&63)}}return t.join("")},NT={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(e,t){if(!Array.isArray(e))throw Error("encodeByteArray takes an array as a parameter");this.init_();const r=t?this.byteToCharMapWebSafe_:this.byteToCharMap_,n=[];for(let s=0;s<e.length;s+=3){const a=e[s],i=s+1<e.length,o=i?e[s+1]:0,l=s+2<e.length,c=l?e[s+2]:0,u=a>>2,d=(a&3)<<4|o>>4;let m=(o&15)<<2|c>>6,p=c&63;l||(p=64,i||(m=64)),n.push(r[u],r[d],r[m],r[p])}return n.join("")},encodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?btoa(e):this.encodeByteArray(CT(e),t)},decodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?atob(e):cb(this.decodeStringToByteArray(e,t))},decodeStringToByteArray(e,t){this.init_();const r=t?this.charToByteMapWebSafe_:this.charToByteMap_,n=[];for(let s=0;s<e.length;){const a=r[e.charAt(s++)],o=s<e.length?r[e.charAt(s)]:0;++s;const c=s<e.length?r[e.charAt(s)]:64;++s;const d=s<e.length?r[e.charAt(s)]:64;if(++s,a==null||o==null||c==null||d==null)throw new ub;const m=a<<2|o>>4;if(n.push(m),c!==64){const p=o<<4&240|c>>2;if(n.push(p),d!==64){const g=c<<6&192|d;n.push(g)}}}return n},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let e=0;e<this.ENCODED_VALS.length;e++)this.byteToCharMap_[e]=this.ENCODED_VALS.charAt(e),this.charToByteMap_[this.byteToCharMap_[e]]=e,this.byteToCharMapWebSafe_[e]=this.ENCODED_VALS_WEBSAFE.charAt(e),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[e]]=e,e>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(e)]=e,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(e)]=e)}}};class ub extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const fb=function(e){const t=CT(e);return NT.encodeByteArray(t,!0)},Fh=function(e){return fb(e).replace(/\./g,"")},RT=function(e){try{return NT.decodeString(e,!0)}catch(t){console.error("base64Decode failed: ",t)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hb(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const db=()=>hb().__FIREBASE_DEFAULTS__,mb=()=>{if(typeof process>"u"||typeof Ey>"u")return;const e=Ey.__FIREBASE_DEFAULTS__;if(e)return JSON.parse(e)},pb=()=>{if(typeof document>"u")return;let e;try{e=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const t=e&&RT(e[1]);return t&&JSON.parse(t)},Rd=()=>{try{return db()||mb()||pb()}catch(e){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${e}`);return}},bT=e=>{var t,r;return(r=(t=Rd())===null||t===void 0?void 0:t.emulatorHosts)===null||r===void 0?void 0:r[e]},Gg=e=>{const t=bT(e);if(!t)return;const r=t.lastIndexOf(":");if(r<=0||r+1===t.length)throw new Error(`Invalid host ${t} with no separate hostname and port!`);const n=parseInt(t.substring(r+1),10);return t[0]==="["?[t.substring(1,r-1),n]:[t.substring(0,r),n]},PT=()=>{var e;return(e=Rd())===null||e===void 0?void 0:e.config},DT=e=>{var t;return(t=Rd())===null||t===void 0?void 0:t[`_${e}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gb{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((t,r)=>{this.resolve=t,this.reject=r})}wrapCallback(t){return(r,n)=>{r?this.reject(r):this.resolve(n),typeof t=="function"&&(this.promise.catch(()=>{}),t.length===1?t(r):t(r,n))}}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function FT(e,t){if(e.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const r={alg:"none",type:"JWT"},n=t||"demo-project",s=e.iat||0,a=e.sub||e.user_id;if(!a)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const i=Object.assign({iss:`https://securetoken.google.com/${n}`,aud:n,iat:s,exp:s+3600,auth_time:s,sub:a,user_id:a,firebase:{sign_in_provider:"custom",identities:{}}},e);return[Fh(JSON.stringify(r)),Fh(JSON.stringify(i)),""].join(".")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Hr(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function vb(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Hr())}function xb(){var e;const t=(e=Rd())===null||e===void 0?void 0:e.forceEnvironment;if(t==="node")return!0;if(t==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function yb(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function _b(){const e=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof e=="object"&&e.id!==void 0}function wb(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function Eb(){const e=Hr();return e.indexOf("MSIE ")>=0||e.indexOf("Trident/")>=0}function Tb(){return!xb()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function kb(){try{return typeof indexedDB=="object"}catch{return!1}}function Sb(){return new Promise((e,t)=>{try{let r=!0;const n="validate-browser-context-for-indexeddb-analytics-module",s=self.indexedDB.open(n);s.onsuccess=()=>{s.result.close(),r||self.indexedDB.deleteDatabase(n),e(!0)},s.onupgradeneeded=()=>{r=!1},s.onerror=()=>{var a;t(((a=s.error)===null||a===void 0?void 0:a.message)||"")}}catch(r){t(r)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ab="FirebaseError";class Ds extends Error{constructor(t,r,n){super(r),this.code=t,this.customData=n,this.name=Ab,Object.setPrototypeOf(this,Ds.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Tu.prototype.create)}}class Tu{constructor(t,r,n){this.service=t,this.serviceName=r,this.errors=n}create(t,...r){const n=r[0]||{},s=`${this.service}/${t}`,a=this.errors[t],i=a?Ib(a,n):"Error",o=`${this.serviceName}: ${i} (${s}).`;return new Ds(s,o,n)}}function Ib(e,t){return e.replace(Cb,(r,n)=>{const s=t[n];return s!=null?String(s):`<${n}?>`})}const Cb=/\{\$([^}]+)}/g;function Nb(e){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}function Oh(e,t){if(e===t)return!0;const r=Object.keys(e),n=Object.keys(t);for(const s of r){if(!n.includes(s))return!1;const a=e[s],i=t[s];if(Ty(a)&&Ty(i)){if(!Oh(a,i))return!1}else if(a!==i)return!1}for(const s of n)if(!r.includes(s))return!1;return!0}function Ty(e){return e!==null&&typeof e=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ku(e){const t=[];for(const[r,n]of Object.entries(e))Array.isArray(n)?n.forEach(s=>{t.push(encodeURIComponent(r)+"="+encodeURIComponent(s))}):t.push(encodeURIComponent(r)+"="+encodeURIComponent(n));return t.length?"&"+t.join("&"):""}function Rb(e,t){const r=new bb(e,t);return r.subscribe.bind(r)}class bb{constructor(t,r){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=r,this.task.then(()=>{t(this)}).catch(n=>{this.error(n)})}next(t){this.forEachObserver(r=>{r.next(t)})}error(t){this.forEachObserver(r=>{r.error(t)}),this.close(t)}complete(){this.forEachObserver(t=>{t.complete()}),this.close()}subscribe(t,r,n){let s;if(t===void 0&&r===void 0&&n===void 0)throw new Error("Missing Observer.");Pb(t,["next","error","complete"])?s=t:s={next:t,error:r,complete:n},s.next===void 0&&(s.next=B0),s.error===void 0&&(s.error=B0),s.complete===void 0&&(s.complete=B0);const a=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?s.error(this.finalError):s.complete()}catch{}}),this.observers.push(s),a}unsubscribeOne(t){this.observers===void 0||this.observers[t]===void 0||(delete this.observers[t],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(t){if(!this.finalized)for(let r=0;r<this.observers.length;r++)this.sendOne(r,t)}sendOne(t,r){this.task.then(()=>{if(this.observers!==void 0&&this.observers[t]!==void 0)try{r(this.observers[t])}catch(n){typeof console<"u"&&console.error&&console.error(n)}})}close(t){this.finalized||(this.finalized=!0,t!==void 0&&(this.finalError=t),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function Pb(e,t){if(typeof e!="object"||e===null)return!1;for(const r of t)if(r in e&&typeof e[r]=="function")return!0;return!1}function B0(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ht(e){return e&&e._delegate?e._delegate:e}class ua{constructor(t,r,n){this.name=t,this.instanceFactory=r,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(t){return this.instantiationMode=t,this}setMultipleInstances(t){return this.multipleInstances=t,this}setServiceProps(t){return this.serviceProps=t,this}setInstanceCreatedCallback(t){return this.onInstanceCreated=t,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ti="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Db{constructor(t,r){this.name=t,this.container=r,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(t){const r=this.normalizeInstanceIdentifier(t);if(!this.instancesDeferred.has(r)){const n=new gb;if(this.instancesDeferred.set(r,n),this.isInitialized(r)||this.shouldAutoInitialize())try{const s=this.getOrInitializeService({instanceIdentifier:r});s&&n.resolve(s)}catch{}}return this.instancesDeferred.get(r).promise}getImmediate(t){var r;const n=this.normalizeInstanceIdentifier(t==null?void 0:t.identifier),s=(r=t==null?void 0:t.optional)!==null&&r!==void 0?r:!1;if(this.isInitialized(n)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:n})}catch(a){if(s)return null;throw a}else{if(s)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(t){if(t.name!==this.name)throw Error(`Mismatching Component ${t.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=t,!!this.shouldAutoInitialize()){if(Ob(t))try{this.getOrInitializeService({instanceIdentifier:Ti})}catch{}for(const[r,n]of this.instancesDeferred.entries()){const s=this.normalizeInstanceIdentifier(r);try{const a=this.getOrInitializeService({instanceIdentifier:s});n.resolve(a)}catch{}}}}clearInstance(t=Ti){this.instancesDeferred.delete(t),this.instancesOptions.delete(t),this.instances.delete(t)}async delete(){const t=Array.from(this.instances.values());await Promise.all([...t.filter(r=>"INTERNAL"in r).map(r=>r.INTERNAL.delete()),...t.filter(r=>"_delete"in r).map(r=>r._delete())])}isComponentSet(){return this.component!=null}isInitialized(t=Ti){return this.instances.has(t)}getOptions(t=Ti){return this.instancesOptions.get(t)||{}}initialize(t={}){const{options:r={}}=t,n=this.normalizeInstanceIdentifier(t.instanceIdentifier);if(this.isInitialized(n))throw Error(`${this.name}(${n}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const s=this.getOrInitializeService({instanceIdentifier:n,options:r});for(const[a,i]of this.instancesDeferred.entries()){const o=this.normalizeInstanceIdentifier(a);n===o&&i.resolve(s)}return s}onInit(t,r){var n;const s=this.normalizeInstanceIdentifier(r),a=(n=this.onInitCallbacks.get(s))!==null&&n!==void 0?n:new Set;a.add(t),this.onInitCallbacks.set(s,a);const i=this.instances.get(s);return i&&t(i,s),()=>{a.delete(t)}}invokeOnInitCallbacks(t,r){const n=this.onInitCallbacks.get(r);if(n)for(const s of n)try{s(t,r)}catch{}}getOrInitializeService({instanceIdentifier:t,options:r={}}){let n=this.instances.get(t);if(!n&&this.component&&(n=this.component.instanceFactory(this.container,{instanceIdentifier:Fb(t),options:r}),this.instances.set(t,n),this.instancesOptions.set(t,r),this.invokeOnInitCallbacks(n,t),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,t,n)}catch{}return n||null}normalizeInstanceIdentifier(t=Ti){return this.component?this.component.multipleInstances?t:Ti:t}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function Fb(e){return e===Ti?void 0:e}function Ob(e){return e.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mb{constructor(t){this.name=t,this.providers=new Map}addComponent(t){const r=this.getProvider(t.name);if(r.isComponentSet())throw new Error(`Component ${t.name} has already been registered with ${this.name}`);r.setComponent(t)}addOrOverwriteComponent(t){this.getProvider(t.name).isComponentSet()&&this.providers.delete(t.name),this.addComponent(t)}getProvider(t){if(this.providers.has(t))return this.providers.get(t);const r=new Db(t,this);return this.providers.set(t,r),r}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Ye;(function(e){e[e.DEBUG=0]="DEBUG",e[e.VERBOSE=1]="VERBOSE",e[e.INFO=2]="INFO",e[e.WARN=3]="WARN",e[e.ERROR=4]="ERROR",e[e.SILENT=5]="SILENT"})(Ye||(Ye={}));const Lb={debug:Ye.DEBUG,verbose:Ye.VERBOSE,info:Ye.INFO,warn:Ye.WARN,error:Ye.ERROR,silent:Ye.SILENT},jb=Ye.INFO,Vb={[Ye.DEBUG]:"log",[Ye.VERBOSE]:"log",[Ye.INFO]:"info",[Ye.WARN]:"warn",[Ye.ERROR]:"error"},Ub=(e,t,...r)=>{if(t<e.logLevel)return;const n=new Date().toISOString(),s=Vb[t];if(s)console[s](`[${n}]  ${e.name}:`,...r);else throw new Error(`Attempted to log a message with an invalid logType (value: ${t})`)};class Kg{constructor(t){this.name=t,this._logLevel=jb,this._logHandler=Ub,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(t){if(!(t in Ye))throw new TypeError(`Invalid value "${t}" assigned to \`logLevel\``);this._logLevel=t}setLogLevel(t){this._logLevel=typeof t=="string"?Lb[t]:t}get logHandler(){return this._logHandler}set logHandler(t){if(typeof t!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t}get userLogHandler(){return this._userLogHandler}set userLogHandler(t){this._userLogHandler=t}debug(...t){this._userLogHandler&&this._userLogHandler(this,Ye.DEBUG,...t),this._logHandler(this,Ye.DEBUG,...t)}log(...t){this._userLogHandler&&this._userLogHandler(this,Ye.VERBOSE,...t),this._logHandler(this,Ye.VERBOSE,...t)}info(...t){this._userLogHandler&&this._userLogHandler(this,Ye.INFO,...t),this._logHandler(this,Ye.INFO,...t)}warn(...t){this._userLogHandler&&this._userLogHandler(this,Ye.WARN,...t),this._logHandler(this,Ye.WARN,...t)}error(...t){this._userLogHandler&&this._userLogHandler(this,Ye.ERROR,...t),this._logHandler(this,Ye.ERROR,...t)}}const Bb=(e,t)=>t.some(r=>e instanceof r);let ky,Sy;function zb(){return ky||(ky=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function $b(){return Sy||(Sy=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const OT=new WeakMap,ip=new WeakMap,MT=new WeakMap,z0=new WeakMap,qg=new WeakMap;function Wb(e){const t=new Promise((r,n)=>{const s=()=>{e.removeEventListener("success",a),e.removeEventListener("error",i)},a=()=>{r(Qa(e.result)),s()},i=()=>{n(e.error),s()};e.addEventListener("success",a),e.addEventListener("error",i)});return t.then(r=>{r instanceof IDBCursor&&OT.set(r,e)}).catch(()=>{}),qg.set(t,e),t}function Hb(e){if(ip.has(e))return;const t=new Promise((r,n)=>{const s=()=>{e.removeEventListener("complete",a),e.removeEventListener("error",i),e.removeEventListener("abort",i)},a=()=>{r(),s()},i=()=>{n(e.error||new DOMException("AbortError","AbortError")),s()};e.addEventListener("complete",a),e.addEventListener("error",i),e.addEventListener("abort",i)});ip.set(e,t)}let op={get(e,t,r){if(e instanceof IDBTransaction){if(t==="done")return ip.get(e);if(t==="objectStoreNames")return e.objectStoreNames||MT.get(e);if(t==="store")return r.objectStoreNames[1]?void 0:r.objectStore(r.objectStoreNames[0])}return Qa(e[t])},set(e,t,r){return e[t]=r,!0},has(e,t){return e instanceof IDBTransaction&&(t==="done"||t==="store")?!0:t in e}};function Gb(e){op=e(op)}function Kb(e){return e===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(t,...r){const n=e.call($0(this),t,...r);return MT.set(n,t.sort?t.sort():[t]),Qa(n)}:$b().includes(e)?function(...t){return e.apply($0(this),t),Qa(OT.get(this))}:function(...t){return Qa(e.apply($0(this),t))}}function qb(e){return typeof e=="function"?Kb(e):(e instanceof IDBTransaction&&Hb(e),Bb(e,zb())?new Proxy(e,op):e)}function Qa(e){if(e instanceof IDBRequest)return Wb(e);if(z0.has(e))return z0.get(e);const t=qb(e);return t!==e&&(z0.set(e,t),qg.set(t,e)),t}const $0=e=>qg.get(e);function Xb(e,t,{blocked:r,upgrade:n,blocking:s,terminated:a}={}){const i=indexedDB.open(e,t),o=Qa(i);return n&&i.addEventListener("upgradeneeded",l=>{n(Qa(i.result),l.oldVersion,l.newVersion,Qa(i.transaction),l)}),r&&i.addEventListener("blocked",l=>r(l.oldVersion,l.newVersion,l)),o.then(l=>{a&&l.addEventListener("close",()=>a()),s&&l.addEventListener("versionchange",c=>s(c.oldVersion,c.newVersion,c))}).catch(()=>{}),o}const Yb=["get","getKey","getAll","getAllKeys","count"],Qb=["put","add","delete","clear"],W0=new Map;function Ay(e,t){if(!(e instanceof IDBDatabase&&!(t in e)&&typeof t=="string"))return;if(W0.get(t))return W0.get(t);const r=t.replace(/FromIndex$/,""),n=t!==r,s=Qb.includes(r);if(!(r in(n?IDBIndex:IDBObjectStore).prototype)||!(s||Yb.includes(r)))return;const a=async function(i,...o){const l=this.transaction(i,s?"readwrite":"readonly");let c=l.store;return n&&(c=c.index(o.shift())),(await Promise.all([c[r](...o),s&&l.done]))[0]};return W0.set(t,a),a}Gb(e=>({...e,get:(t,r,n)=>Ay(t,r)||e.get(t,r,n),has:(t,r)=>!!Ay(t,r)||e.has(t,r)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jb{constructor(t){this.container=t}getPlatformInfoString(){return this.container.getProviders().map(r=>{if(Zb(r)){const n=r.getImmediate();return`${n.library}/${n.version}`}else return null}).filter(r=>r).join(" ")}}function Zb(e){const t=e.getComponent();return(t==null?void 0:t.type)==="VERSION"}const lp="@firebase/app",Iy="0.10.13";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fa=new Kg("@firebase/app"),eP="@firebase/app-compat",tP="@firebase/analytics-compat",rP="@firebase/analytics",nP="@firebase/app-check-compat",sP="@firebase/app-check",aP="@firebase/auth",iP="@firebase/auth-compat",oP="@firebase/database",lP="@firebase/data-connect",cP="@firebase/database-compat",uP="@firebase/functions",fP="@firebase/functions-compat",hP="@firebase/installations",dP="@firebase/installations-compat",mP="@firebase/messaging",pP="@firebase/messaging-compat",gP="@firebase/performance",vP="@firebase/performance-compat",xP="@firebase/remote-config",yP="@firebase/remote-config-compat",_P="@firebase/storage",wP="@firebase/storage-compat",EP="@firebase/firestore",TP="@firebase/vertexai-preview",kP="@firebase/firestore-compat",SP="firebase",AP="10.14.1";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cp="[DEFAULT]",IP={[lp]:"fire-core",[eP]:"fire-core-compat",[rP]:"fire-analytics",[tP]:"fire-analytics-compat",[sP]:"fire-app-check",[nP]:"fire-app-check-compat",[aP]:"fire-auth",[iP]:"fire-auth-compat",[oP]:"fire-rtdb",[lP]:"fire-data-connect",[cP]:"fire-rtdb-compat",[uP]:"fire-fn",[fP]:"fire-fn-compat",[hP]:"fire-iid",[dP]:"fire-iid-compat",[mP]:"fire-fcm",[pP]:"fire-fcm-compat",[gP]:"fire-perf",[vP]:"fire-perf-compat",[xP]:"fire-rc",[yP]:"fire-rc-compat",[_P]:"fire-gcs",[wP]:"fire-gcs-compat",[EP]:"fire-fst",[kP]:"fire-fst-compat",[TP]:"fire-vertex","fire-js":"fire-js",[SP]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Mh=new Map,CP=new Map,up=new Map;function Cy(e,t){try{e.container.addComponent(t)}catch(r){fa.debug(`Component ${t.name} failed to register with FirebaseApp ${e.name}`,r)}}function ai(e){const t=e.name;if(up.has(t))return fa.debug(`There were multiple attempts to register component ${t}.`),!1;up.set(t,e);for(const r of Mh.values())Cy(r,e);for(const r of CP.values())Cy(r,e);return!0}function Su(e,t){const r=e.container.getProvider("heartbeat").getImmediate({optional:!0});return r&&r.triggerHeartbeat(),e.container.getProvider(t)}function Xs(e){return e.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const NP={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Ja=new Tu("app","Firebase",NP);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RP{constructor(t,r,n){this._isDeleted=!1,this._options=Object.assign({},t),this._config=Object.assign({},r),this._name=r.name,this._automaticDataCollectionEnabled=r.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new ua("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(t){this.checkDestroyed(),this._automaticDataCollectionEnabled=t}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(t){this._isDeleted=t}checkDestroyed(){if(this.isDeleted)throw Ja.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ro=AP;function LT(e,t={}){let r=e;typeof t!="object"&&(t={name:t});const n=Object.assign({name:cp,automaticDataCollectionEnabled:!1},t),s=n.name;if(typeof s!="string"||!s)throw Ja.create("bad-app-name",{appName:String(s)});if(r||(r=PT()),!r)throw Ja.create("no-options");const a=Mh.get(s);if(a){if(Oh(r,a.options)&&Oh(n,a.config))return a;throw Ja.create("duplicate-app",{appName:s})}const i=new Mb(s);for(const l of up.values())i.addComponent(l);const o=new RP(r,n,i);return Mh.set(s,o),o}function bd(e=cp){const t=Mh.get(e);if(!t&&e===cp&&PT())return LT();if(!t)throw Ja.create("no-app",{appName:e});return t}function Un(e,t,r){var n;let s=(n=IP[e])!==null&&n!==void 0?n:e;r&&(s+=`-${r}`);const a=s.match(/\s|\//),i=t.match(/\s|\//);if(a||i){const o=[`Unable to register library "${s}" with version "${t}":`];a&&o.push(`library name "${s}" contains illegal characters (whitespace or "/")`),a&&i&&o.push("and"),i&&o.push(`version name "${t}" contains illegal characters (whitespace or "/")`),fa.warn(o.join(" "));return}ai(new ua(`${s}-version`,()=>({library:s,version:t}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bP="firebase-heartbeat-database",PP=1,Jc="firebase-heartbeat-store";let H0=null;function jT(){return H0||(H0=Xb(bP,PP,{upgrade:(e,t)=>{switch(t){case 0:try{e.createObjectStore(Jc)}catch(r){console.warn(r)}}}}).catch(e=>{throw Ja.create("idb-open",{originalErrorMessage:e.message})})),H0}async function DP(e){try{const r=(await jT()).transaction(Jc),n=await r.objectStore(Jc).get(VT(e));return await r.done,n}catch(t){if(t instanceof Ds)fa.warn(t.message);else{const r=Ja.create("idb-get",{originalErrorMessage:t==null?void 0:t.message});fa.warn(r.message)}}}async function Ny(e,t){try{const n=(await jT()).transaction(Jc,"readwrite");await n.objectStore(Jc).put(t,VT(e)),await n.done}catch(r){if(r instanceof Ds)fa.warn(r.message);else{const n=Ja.create("idb-set",{originalErrorMessage:r==null?void 0:r.message});fa.warn(n.message)}}}function VT(e){return`${e.name}!${e.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const FP=1024,OP=30*24*60*60*1e3;class MP{constructor(t){this.container=t,this._heartbeatsCache=null;const r=this.container.getProvider("app").getImmediate();this._storage=new jP(r),this._heartbeatsCachePromise=this._storage.read().then(n=>(this._heartbeatsCache=n,n))}async triggerHeartbeat(){var t,r;try{const s=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),a=Ry();return((t=this._heartbeatsCache)===null||t===void 0?void 0:t.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((r=this._heartbeatsCache)===null||r===void 0?void 0:r.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===a||this._heartbeatsCache.heartbeats.some(i=>i.date===a)?void 0:(this._heartbeatsCache.heartbeats.push({date:a,agent:s}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(i=>{const o=new Date(i.date).valueOf();return Date.now()-o<=OP}),this._storage.overwrite(this._heartbeatsCache))}catch(n){fa.warn(n)}}async getHeartbeatsHeader(){var t;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((t=this._heartbeatsCache)===null||t===void 0?void 0:t.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const r=Ry(),{heartbeatsToSend:n,unsentEntries:s}=LP(this._heartbeatsCache.heartbeats),a=Fh(JSON.stringify({version:2,heartbeats:n}));return this._heartbeatsCache.lastSentHeartbeatDate=r,s.length>0?(this._heartbeatsCache.heartbeats=s,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),a}catch(r){return fa.warn(r),""}}}function Ry(){return new Date().toISOString().substring(0,10)}function LP(e,t=FP){const r=[];let n=e.slice();for(const s of e){const a=r.find(i=>i.agent===s.agent);if(a){if(a.dates.push(s.date),by(r)>t){a.dates.pop();break}}else if(r.push({agent:s.agent,dates:[s.date]}),by(r)>t){r.pop();break}n=n.slice(1)}return{heartbeatsToSend:r,unsentEntries:n}}class jP{constructor(t){this.app=t,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return kb()?Sb().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const r=await DP(this.app);return r!=null&&r.heartbeats?r:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(t){var r;if(await this._canUseIndexedDBPromise){const s=await this.read();return Ny(this.app,{lastSentHeartbeatDate:(r=t.lastSentHeartbeatDate)!==null&&r!==void 0?r:s.lastSentHeartbeatDate,heartbeats:t.heartbeats})}else return}async add(t){var r;if(await this._canUseIndexedDBPromise){const s=await this.read();return Ny(this.app,{lastSentHeartbeatDate:(r=t.lastSentHeartbeatDate)!==null&&r!==void 0?r:s.lastSentHeartbeatDate,heartbeats:[...s.heartbeats,...t.heartbeats]})}else return}}function by(e){return Fh(JSON.stringify({version:2,heartbeats:e})).length}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function VP(e){ai(new ua("platform-logger",t=>new Jb(t),"PRIVATE")),ai(new ua("heartbeat",t=>new MP(t),"PRIVATE")),Un(lp,Iy,e),Un(lp,Iy,"esm2017"),Un("fire-js","")}VP("");function Xg(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,n=Object.getOwnPropertySymbols(e);s<n.length;s++)t.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(e,n[s])&&(r[n[s]]=e[n[s]]);return r}function UT(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const UP=UT,BT=new Tu("auth","Firebase",UT());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Lh=new Kg("@firebase/auth");function BP(e,...t){Lh.logLevel<=Ye.WARN&&Lh.warn(`Auth (${ro}): ${e}`,...t)}function Yf(e,...t){Lh.logLevel<=Ye.ERROR&&Lh.error(`Auth (${ro}): ${e}`,...t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Cs(e,...t){throw Qg(e,...t)}function ls(e,...t){return Qg(e,...t)}function Yg(e,t,r){const n=Object.assign(Object.assign({},UP()),{[t]:r});return new Tu("auth","Firebase",n).create(t,{appName:e.name})}function Mi(e){return Yg(e,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function zP(e,t,r){const n=r;if(!(t instanceof n))throw n.name!==t.constructor.name&&Cs(e,"argument-error"),Yg(e,"argument-error",`Type of ${t.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function Qg(e,...t){if(typeof e!="string"){const r=t[0],n=[...t.slice(1)];return n[0]&&(n[0].appName=e.name),e._errorFactory.create(r,...n)}return BT.create(e,...t)}function Me(e,t,...r){if(!e)throw Qg(t,...r)}function Ys(e){const t="INTERNAL ASSERTION FAILED: "+e;throw Yf(t),new Error(t)}function ha(e,t){e||Ys(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fp(){var e;return typeof self<"u"&&((e=self.location)===null||e===void 0?void 0:e.href)||""}function $P(){return Py()==="http:"||Py()==="https:"}function Py(){var e;return typeof self<"u"&&((e=self.location)===null||e===void 0?void 0:e.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function WP(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&($P()||_b()||"connection"in navigator)?navigator.onLine:!0}function HP(){if(typeof navigator>"u")return null;const e=navigator;return e.languages&&e.languages[0]||e.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Au{constructor(t,r){this.shortDelay=t,this.longDelay=r,ha(r>t,"Short delay should be less than long delay!"),this.isMobile=vb()||wb()}get(){return WP()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Jg(e,t){ha(e.emulator,"Emulator should always be set here");const{url:r}=e.emulator;return t?`${r}${t.startsWith("/")?t.slice(1):t}`:r}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zT{static initialize(t,r,n){this.fetchImpl=t,r&&(this.headersImpl=r),n&&(this.responseImpl=n)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Ys("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Ys("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Ys("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const GP={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const KP=new Au(3e4,6e4);function Zg(e,t){return e.tenantId&&!t.tenantId?Object.assign(Object.assign({},t),{tenantId:e.tenantId}):t}async function El(e,t,r,n,s={}){return $T(e,s,async()=>{let a={},i={};n&&(t==="GET"?i=n:a={body:JSON.stringify(n)});const o=ku(Object.assign({key:e.config.apiKey},i)).slice(1),l=await e._getAdditionalHeaders();l["Content-Type"]="application/json",e.languageCode&&(l["X-Firebase-Locale"]=e.languageCode);const c=Object.assign({method:t,headers:l},a);return yb()||(c.referrerPolicy="no-referrer"),zT.fetch()(WT(e,e.config.apiHost,r,o),c)})}async function $T(e,t,r){e._canInitEmulator=!1;const n=Object.assign(Object.assign({},GP),t);try{const s=new XP(e),a=await Promise.race([r(),s.promise]);s.clearNetworkTimeout();const i=await a.json();if("needConfirmation"in i)throw Ef(e,"account-exists-with-different-credential",i);if(a.ok&&!("errorMessage"in i))return i;{const o=a.ok?i.errorMessage:i.error.message,[l,c]=o.split(" : ");if(l==="FEDERATED_USER_ID_ALREADY_LINKED")throw Ef(e,"credential-already-in-use",i);if(l==="EMAIL_EXISTS")throw Ef(e,"email-already-in-use",i);if(l==="USER_DISABLED")throw Ef(e,"user-disabled",i);const u=n[l]||l.toLowerCase().replace(/[_\s]+/g,"-");if(c)throw Yg(e,u,c);Cs(e,u)}}catch(s){if(s instanceof Ds)throw s;Cs(e,"network-request-failed",{message:String(s)})}}async function qP(e,t,r,n,s={}){const a=await El(e,t,r,n,s);return"mfaPendingCredential"in a&&Cs(e,"multi-factor-auth-required",{_serverResponse:a}),a}function WT(e,t,r,n){const s=`${t}${r}?${n}`;return e.config.emulator?Jg(e.config,s):`${e.config.apiScheme}://${s}`}class XP{constructor(t){this.auth=t,this.timer=null,this.promise=new Promise((r,n)=>{this.timer=setTimeout(()=>n(ls(this.auth,"network-request-failed")),KP.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}}function Ef(e,t,r){const n={appName:e.name};r.email&&(n.email=r.email),r.phoneNumber&&(n.phoneNumber=r.phoneNumber);const s=ls(e,t,n);return s.customData._tokenResponse=r,s}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function YP(e,t){return El(e,"POST","/v1/accounts:delete",t)}async function HT(e,t){return El(e,"POST","/v1/accounts:lookup",t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xc(e){if(e)try{const t=new Date(Number(e));if(!isNaN(t.getTime()))return t.toUTCString()}catch{}}async function GT(e,t=!1){const r=Ht(e),n=await r.getIdToken(t),s=ev(n);Me(s&&s.exp&&s.auth_time&&s.iat,r.auth,"internal-error");const a=typeof s.firebase=="object"?s.firebase:void 0,i=a==null?void 0:a.sign_in_provider;return{claims:s,token:n,authTime:xc(G0(s.auth_time)),issuedAtTime:xc(G0(s.iat)),expirationTime:xc(G0(s.exp)),signInProvider:i||null,signInSecondFactor:(a==null?void 0:a.sign_in_second_factor)||null}}function G0(e){return Number(e)*1e3}function ev(e){const[t,r,n]=e.split(".");if(t===void 0||r===void 0||n===void 0)return Yf("JWT malformed, contained fewer than 3 sections"),null;try{const s=RT(r);return s?JSON.parse(s):(Yf("Failed to decode base64 JWT payload"),null)}catch(s){return Yf("Caught error parsing JWT payload as JSON",s==null?void 0:s.toString()),null}}function Dy(e){const t=ev(e);return Me(t,"internal-error"),Me(typeof t.exp<"u","internal-error"),Me(typeof t.iat<"u","internal-error"),Number(t.exp)-Number(t.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Zc(e,t,r=!1){if(r)return t;try{return await t}catch(n){throw n instanceof Ds&&QP(n)&&e.auth.currentUser===e&&await e.auth.signOut(),n}}function QP({code:e}){return e==="auth/user-disabled"||e==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JP{constructor(t){this.user=t,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(t){var r;if(t){const n=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),n}else{this.errorBackoff=3e4;const s=((r=this.user.stsTokenManager.expirationTime)!==null&&r!==void 0?r:0)-Date.now()-3e5;return Math.max(0,s)}}schedule(t=!1){if(!this.isRunning)return;const r=this.getInterval(t);this.timerId=setTimeout(async()=>{await this.iteration()},r)}async iteration(){try{await this.user.getIdToken(!0)}catch(t){(t==null?void 0:t.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hp{constructor(t,r){this.createdAt=t,this.lastLoginAt=r,this._initializeTime()}_initializeTime(){this.lastSignInTime=xc(this.lastLoginAt),this.creationTime=xc(this.createdAt)}_copy(t){this.createdAt=t.createdAt,this.lastLoginAt=t.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function jh(e){var t;const r=e.auth,n=await e.getIdToken(),s=await Zc(e,HT(r,{idToken:n}));Me(s==null?void 0:s.users.length,r,"internal-error");const a=s.users[0];e._notifyReloadListener(a);const i=!((t=a.providerUserInfo)===null||t===void 0)&&t.length?KT(a.providerUserInfo):[],o=eD(e.providerData,i),l=e.isAnonymous,c=!(e.email&&a.passwordHash)&&!(o!=null&&o.length),u=l?c:!1,d={uid:a.localId,displayName:a.displayName||null,photoURL:a.photoUrl||null,email:a.email||null,emailVerified:a.emailVerified||!1,phoneNumber:a.phoneNumber||null,tenantId:a.tenantId||null,providerData:o,metadata:new hp(a.createdAt,a.lastLoginAt),isAnonymous:u};Object.assign(e,d)}async function ZP(e){const t=Ht(e);await jh(t),await t.auth._persistUserIfCurrent(t),t.auth._notifyListenersIfCurrent(t)}function eD(e,t){return[...e.filter(n=>!t.some(s=>s.providerId===n.providerId)),...t]}function KT(e){return e.map(t=>{var{providerId:r}=t,n=Xg(t,["providerId"]);return{providerId:r,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function tD(e,t){const r=await $T(e,{},async()=>{const n=ku({grant_type:"refresh_token",refresh_token:t}).slice(1),{tokenApiHost:s,apiKey:a}=e.config,i=WT(e,s,"/v1/token",`key=${a}`),o=await e._getAdditionalHeaders();return o["Content-Type"]="application/x-www-form-urlencoded",zT.fetch()(i,{method:"POST",headers:o,body:n})});return{accessToken:r.access_token,expiresIn:r.expires_in,refreshToken:r.refresh_token}}async function rD(e,t){return El(e,"POST","/v2/accounts:revokeToken",Zg(e,t))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ho{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(t){Me(t.idToken,"internal-error"),Me(typeof t.idToken<"u","internal-error"),Me(typeof t.refreshToken<"u","internal-error");const r="expiresIn"in t&&typeof t.expiresIn<"u"?Number(t.expiresIn):Dy(t.idToken);this.updateTokensAndExpiration(t.idToken,t.refreshToken,r)}updateFromIdToken(t){Me(t.length!==0,"internal-error");const r=Dy(t);this.updateTokensAndExpiration(t,null,r)}async getToken(t,r=!1){return!r&&this.accessToken&&!this.isExpired?this.accessToken:(Me(this.refreshToken,t,"user-token-expired"),this.refreshToken?(await this.refresh(t,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(t,r){const{accessToken:n,refreshToken:s,expiresIn:a}=await tD(t,r);this.updateTokensAndExpiration(n,s,Number(a))}updateTokensAndExpiration(t,r,n){this.refreshToken=r||null,this.accessToken=t||null,this.expirationTime=Date.now()+n*1e3}static fromJSON(t,r){const{refreshToken:n,accessToken:s,expirationTime:a}=r,i=new Ho;return n&&(Me(typeof n=="string","internal-error",{appName:t}),i.refreshToken=n),s&&(Me(typeof s=="string","internal-error",{appName:t}),i.accessToken=s),a&&(Me(typeof a=="number","internal-error",{appName:t}),i.expirationTime=a),i}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(t){this.accessToken=t.accessToken,this.refreshToken=t.refreshToken,this.expirationTime=t.expirationTime}_clone(){return Object.assign(new Ho,this.toJSON())}_performRefresh(){return Ys("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Aa(e,t){Me(typeof e=="string"||typeof e>"u","internal-error",{appName:t})}class Qs{constructor(t){var{uid:r,auth:n,stsTokenManager:s}=t,a=Xg(t,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new JP(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=r,this.auth=n,this.stsTokenManager=s,this.accessToken=s.accessToken,this.displayName=a.displayName||null,this.email=a.email||null,this.emailVerified=a.emailVerified||!1,this.phoneNumber=a.phoneNumber||null,this.photoURL=a.photoURL||null,this.isAnonymous=a.isAnonymous||!1,this.tenantId=a.tenantId||null,this.providerData=a.providerData?[...a.providerData]:[],this.metadata=new hp(a.createdAt||void 0,a.lastLoginAt||void 0)}async getIdToken(t){const r=await Zc(this,this.stsTokenManager.getToken(this.auth,t));return Me(r,this.auth,"internal-error"),this.accessToken!==r&&(this.accessToken=r,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),r}getIdTokenResult(t){return GT(this,t)}reload(){return ZP(this)}_assign(t){this!==t&&(Me(this.uid===t.uid,this.auth,"internal-error"),this.displayName=t.displayName,this.photoURL=t.photoURL,this.email=t.email,this.emailVerified=t.emailVerified,this.phoneNumber=t.phoneNumber,this.isAnonymous=t.isAnonymous,this.tenantId=t.tenantId,this.providerData=t.providerData.map(r=>Object.assign({},r)),this.metadata._copy(t.metadata),this.stsTokenManager._assign(t.stsTokenManager))}_clone(t){const r=new Qs(Object.assign(Object.assign({},this),{auth:t,stsTokenManager:this.stsTokenManager._clone()}));return r.metadata._copy(this.metadata),r}_onReload(t){Me(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=t,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(t){this.reloadListener?this.reloadListener(t):this.reloadUserInfo=t}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(t,r=!1){let n=!1;t.idToken&&t.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(t),n=!0),r&&await jh(this),await this.auth._persistUserIfCurrent(this),n&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(Xs(this.auth.app))return Promise.reject(Mi(this.auth));const t=await this.getIdToken();return await Zc(this,YP(this.auth,{idToken:t})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(t=>Object.assign({},t)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(t,r){var n,s,a,i,o,l,c,u;const d=(n=r.displayName)!==null&&n!==void 0?n:void 0,m=(s=r.email)!==null&&s!==void 0?s:void 0,p=(a=r.phoneNumber)!==null&&a!==void 0?a:void 0,g=(i=r.photoURL)!==null&&i!==void 0?i:void 0,x=(o=r.tenantId)!==null&&o!==void 0?o:void 0,w=(l=r._redirectEventId)!==null&&l!==void 0?l:void 0,k=(c=r.createdAt)!==null&&c!==void 0?c:void 0,T=(u=r.lastLoginAt)!==null&&u!==void 0?u:void 0,{uid:E,emailVerified:N,isAnonymous:M,providerData:O,stsTokenManager:v}=r;Me(E&&v,t,"internal-error");const _=Ho.fromJSON(this.name,v);Me(typeof E=="string",t,"internal-error"),Aa(d,t.name),Aa(m,t.name),Me(typeof N=="boolean",t,"internal-error"),Me(typeof M=="boolean",t,"internal-error"),Aa(p,t.name),Aa(g,t.name),Aa(x,t.name),Aa(w,t.name),Aa(k,t.name),Aa(T,t.name);const S=new Qs({uid:E,auth:t,email:m,emailVerified:N,displayName:d,isAnonymous:M,photoURL:g,phoneNumber:p,tenantId:x,stsTokenManager:_,createdAt:k,lastLoginAt:T});return O&&Array.isArray(O)&&(S.providerData=O.map(I=>Object.assign({},I))),w&&(S._redirectEventId=w),S}static async _fromIdTokenResponse(t,r,n=!1){const s=new Ho;s.updateFromServerResponse(r);const a=new Qs({uid:r.localId,auth:t,stsTokenManager:s,isAnonymous:n});return await jh(a),a}static async _fromGetAccountInfoResponse(t,r,n){const s=r.users[0];Me(s.localId!==void 0,"internal-error");const a=s.providerUserInfo!==void 0?KT(s.providerUserInfo):[],i=!(s.email&&s.passwordHash)&&!(a!=null&&a.length),o=new Ho;o.updateFromIdToken(n);const l=new Qs({uid:s.localId,auth:t,stsTokenManager:o,isAnonymous:i}),c={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:a,metadata:new hp(s.createdAt,s.lastLoginAt),isAnonymous:!(s.email&&s.passwordHash)&&!(a!=null&&a.length)};return Object.assign(l,c),l}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Fy=new Map;function Js(e){ha(e instanceof Function,"Expected a class definition");let t=Fy.get(e);return t?(ha(t instanceof e,"Instance stored in cache mismatched with class"),t):(t=new e,Fy.set(e,t),t)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qT{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(t,r){this.storage[t]=r}async _get(t){const r=this.storage[t];return r===void 0?null:r}async _remove(t){delete this.storage[t]}_addListener(t,r){}_removeListener(t,r){}}qT.type="NONE";const Oy=qT;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Qf(e,t,r){return`firebase:${e}:${t}:${r}`}class Go{constructor(t,r,n){this.persistence=t,this.auth=r,this.userKey=n;const{config:s,name:a}=this.auth;this.fullUserKey=Qf(this.userKey,s.apiKey,a),this.fullPersistenceKey=Qf("persistence",s.apiKey,a),this.boundEventHandler=r._onStorageEvent.bind(r),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(t){return this.persistence._set(this.fullUserKey,t.toJSON())}async getCurrentUser(){const t=await this.persistence._get(this.fullUserKey);return t?Qs._fromJSON(this.auth,t):null}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(t){if(this.persistence===t)return;const r=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=t,r)return this.setCurrentUser(r)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(t,r,n="authUser"){if(!r.length)return new Go(Js(Oy),t,n);const s=(await Promise.all(r.map(async c=>{if(await c._isAvailable())return c}))).filter(c=>c);let a=s[0]||Js(Oy);const i=Qf(n,t.config.apiKey,t.name);let o=null;for(const c of r)try{const u=await c._get(i);if(u){const d=Qs._fromJSON(t,u);c!==a&&(o=d),a=c;break}}catch{}const l=s.filter(c=>c._shouldAllowMigration);return!a._shouldAllowMigration||!l.length?new Go(a,t,n):(a=l[0],o&&await a._set(i,o.toJSON()),await Promise.all(r.map(async c=>{if(c!==a)try{await c._remove(i)}catch{}})),new Go(a,t,n))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function My(e){const t=e.toLowerCase();if(t.includes("opera/")||t.includes("opr/")||t.includes("opios/"))return"Opera";if(JT(t))return"IEMobile";if(t.includes("msie")||t.includes("trident/"))return"IE";if(t.includes("edge/"))return"Edge";if(XT(t))return"Firefox";if(t.includes("silk/"))return"Silk";if(ek(t))return"Blackberry";if(tk(t))return"Webos";if(YT(t))return"Safari";if((t.includes("chrome/")||QT(t))&&!t.includes("edge/"))return"Chrome";if(ZT(t))return"Android";{const r=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,n=e.match(r);if((n==null?void 0:n.length)===2)return n[1]}return"Other"}function XT(e=Hr()){return/firefox\//i.test(e)}function YT(e=Hr()){const t=e.toLowerCase();return t.includes("safari/")&&!t.includes("chrome/")&&!t.includes("crios/")&&!t.includes("android")}function QT(e=Hr()){return/crios\//i.test(e)}function JT(e=Hr()){return/iemobile/i.test(e)}function ZT(e=Hr()){return/android/i.test(e)}function ek(e=Hr()){return/blackberry/i.test(e)}function tk(e=Hr()){return/webos/i.test(e)}function tv(e=Hr()){return/iphone|ipad|ipod/i.test(e)||/macintosh/i.test(e)&&/mobile/i.test(e)}function nD(e=Hr()){var t;return tv(e)&&!!(!((t=window.navigator)===null||t===void 0)&&t.standalone)}function sD(){return Eb()&&document.documentMode===10}function rk(e=Hr()){return tv(e)||ZT(e)||tk(e)||ek(e)||/windows phone/i.test(e)||JT(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nk(e,t=[]){let r;switch(e){case"Browser":r=My(Hr());break;case"Worker":r=`${My(Hr())}-${e}`;break;default:r=e}const n=t.length?t.join(","):"FirebaseCore-web";return`${r}/JsCore/${ro}/${n}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aD{constructor(t){this.auth=t,this.queue=[]}pushCallback(t,r){const n=a=>new Promise((i,o)=>{try{const l=t(a);i(l)}catch(l){o(l)}});n.onAbort=r,this.queue.push(n);const s=this.queue.length-1;return()=>{this.queue[s]=()=>Promise.resolve()}}async runMiddleware(t){if(this.auth.currentUser===t)return;const r=[];try{for(const n of this.queue)await n(t),n.onAbort&&r.push(n.onAbort)}catch(n){r.reverse();for(const s of r)try{s()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:n==null?void 0:n.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function iD(e,t={}){return El(e,"GET","/v2/passwordPolicy",Zg(e,t))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oD=6;class lD{constructor(t){var r,n,s,a;const i=t.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(r=i.minPasswordLength)!==null&&r!==void 0?r:oD,i.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=i.maxPasswordLength),i.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=i.containsLowercaseCharacter),i.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=i.containsUppercaseCharacter),i.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=i.containsNumericCharacter),i.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=i.containsNonAlphanumericCharacter),this.enforcementState=t.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(s=(n=t.allowedNonAlphanumericCharacters)===null||n===void 0?void 0:n.join(""))!==null&&s!==void 0?s:"",this.forceUpgradeOnSignin=(a=t.forceUpgradeOnSignin)!==null&&a!==void 0?a:!1,this.schemaVersion=t.schemaVersion}validatePassword(t){var r,n,s,a,i,o;const l={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(t,l),this.validatePasswordCharacterOptions(t,l),l.isValid&&(l.isValid=(r=l.meetsMinPasswordLength)!==null&&r!==void 0?r:!0),l.isValid&&(l.isValid=(n=l.meetsMaxPasswordLength)!==null&&n!==void 0?n:!0),l.isValid&&(l.isValid=(s=l.containsLowercaseLetter)!==null&&s!==void 0?s:!0),l.isValid&&(l.isValid=(a=l.containsUppercaseLetter)!==null&&a!==void 0?a:!0),l.isValid&&(l.isValid=(i=l.containsNumericCharacter)!==null&&i!==void 0?i:!0),l.isValid&&(l.isValid=(o=l.containsNonAlphanumericCharacter)!==null&&o!==void 0?o:!0),l}validatePasswordLengthOptions(t,r){const n=this.customStrengthOptions.minPasswordLength,s=this.customStrengthOptions.maxPasswordLength;n&&(r.meetsMinPasswordLength=t.length>=n),s&&(r.meetsMaxPasswordLength=t.length<=s)}validatePasswordCharacterOptions(t,r){this.updatePasswordCharacterOptionsStatuses(r,!1,!1,!1,!1);let n;for(let s=0;s<t.length;s++)n=t.charAt(s),this.updatePasswordCharacterOptionsStatuses(r,n>="a"&&n<="z",n>="A"&&n<="Z",n>="0"&&n<="9",this.allowedNonAlphanumericCharacters.includes(n))}updatePasswordCharacterOptionsStatuses(t,r,n,s,a){this.customStrengthOptions.containsLowercaseLetter&&(t.containsLowercaseLetter||(t.containsLowercaseLetter=r)),this.customStrengthOptions.containsUppercaseLetter&&(t.containsUppercaseLetter||(t.containsUppercaseLetter=n)),this.customStrengthOptions.containsNumericCharacter&&(t.containsNumericCharacter||(t.containsNumericCharacter=s)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(t.containsNonAlphanumericCharacter||(t.containsNonAlphanumericCharacter=a))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cD{constructor(t,r,n,s){this.app=t,this.heartbeatServiceProvider=r,this.appCheckServiceProvider=n,this.config=s,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new Ly(this),this.idTokenSubscription=new Ly(this),this.beforeStateQueue=new aD(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=BT,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=t.name,this.clientVersion=s.sdkClientVersion}_initializeWithPersistence(t,r){return r&&(this._popupRedirectResolver=Js(r)),this._initializationPromise=this.queue(async()=>{var n,s;if(!this._deleted&&(this.persistenceManager=await Go.create(this,t),!this._deleted)){if(!((n=this._popupRedirectResolver)===null||n===void 0)&&n._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(r),this.lastNotifiedUid=((s=this.currentUser)===null||s===void 0?void 0:s.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const t=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!t)){if(this.currentUser&&t&&this.currentUser.uid===t.uid){this._currentUser._assign(t),await this.currentUser.getIdToken();return}await this._updateCurrentUser(t,!0)}}async initializeCurrentUserFromIdToken(t){try{const r=await HT(this,{idToken:t}),n=await Qs._fromGetAccountInfoResponse(this,r,t);await this.directlySetCurrentUser(n)}catch(r){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",r),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(t){var r;if(Xs(this.app)){const i=this.app.settings.authIdToken;return i?new Promise(o=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(i).then(o,o))}):this.directlySetCurrentUser(null)}const n=await this.assertedPersistence.getCurrentUser();let s=n,a=!1;if(t&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const i=(r=this.redirectUser)===null||r===void 0?void 0:r._redirectEventId,o=s==null?void 0:s._redirectEventId,l=await this.tryRedirectSignIn(t);(!i||i===o)&&(l!=null&&l.user)&&(s=l.user,a=!0)}if(!s)return this.directlySetCurrentUser(null);if(!s._redirectEventId){if(a)try{await this.beforeStateQueue.runMiddleware(s)}catch(i){s=n,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(i))}return s?this.reloadAndSetCurrentUserOrClear(s):this.directlySetCurrentUser(null)}return Me(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===s._redirectEventId?this.directlySetCurrentUser(s):this.reloadAndSetCurrentUserOrClear(s)}async tryRedirectSignIn(t){let r=null;try{r=await this._popupRedirectResolver._completeRedirectFn(this,t,!0)}catch{await this._setRedirectUser(null)}return r}async reloadAndSetCurrentUserOrClear(t){try{await jh(t)}catch(r){if((r==null?void 0:r.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(t)}useDeviceLanguage(){this.languageCode=HP()}async _delete(){this._deleted=!0}async updateCurrentUser(t){if(Xs(this.app))return Promise.reject(Mi(this));const r=t?Ht(t):null;return r&&Me(r.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(r&&r._clone(this))}async _updateCurrentUser(t,r=!1){if(!this._deleted)return t&&Me(this.tenantId===t.tenantId,this,"tenant-id-mismatch"),r||await this.beforeStateQueue.runMiddleware(t),this.queue(async()=>{await this.directlySetCurrentUser(t),this.notifyAuthListeners()})}async signOut(){return Xs(this.app)?Promise.reject(Mi(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(t){return Xs(this.app)?Promise.reject(Mi(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(Js(t))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(t){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const r=this._getPasswordPolicyInternal();return r.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):r.validatePassword(t)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const t=await iD(this),r=new lD(t);this.tenantId===null?this._projectPasswordPolicy=r:this._tenantPasswordPolicies[this.tenantId]=r}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(t){this._errorFactory=new Tu("auth","Firebase",t())}onAuthStateChanged(t,r,n){return this.registerStateListener(this.authStateSubscription,t,r,n)}beforeAuthStateChanged(t,r){return this.beforeStateQueue.pushCallback(t,r)}onIdTokenChanged(t,r,n){return this.registerStateListener(this.idTokenSubscription,t,r,n)}authStateReady(){return new Promise((t,r)=>{if(this.currentUser)t();else{const n=this.onAuthStateChanged(()=>{n(),t()},r)}})}async revokeAccessToken(t){if(this.currentUser){const r=await this.currentUser.getIdToken(),n={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:t,idToken:r};this.tenantId!=null&&(n.tenantId=this.tenantId),await rD(this,n)}}toJSON(){var t;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(t=this._currentUser)===null||t===void 0?void 0:t.toJSON()}}async _setRedirectUser(t,r){const n=await this.getOrInitRedirectPersistenceManager(r);return t===null?n.removeCurrentUser():n.setCurrentUser(t)}async getOrInitRedirectPersistenceManager(t){if(!this.redirectPersistenceManager){const r=t&&Js(t)||this._popupRedirectResolver;Me(r,this,"argument-error"),this.redirectPersistenceManager=await Go.create(this,[Js(r._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(t){var r,n;return this._isInitialized&&await this.queue(async()=>{}),((r=this._currentUser)===null||r===void 0?void 0:r._redirectEventId)===t?this._currentUser:((n=this.redirectUser)===null||n===void 0?void 0:n._redirectEventId)===t?this.redirectUser:null}async _persistUserIfCurrent(t){if(t===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(t))}_notifyListenersIfCurrent(t){t===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var t,r;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const n=(r=(t=this.currentUser)===null||t===void 0?void 0:t.uid)!==null&&r!==void 0?r:null;this.lastNotifiedUid!==n&&(this.lastNotifiedUid=n,this.authStateSubscription.next(this.currentUser))}registerStateListener(t,r,n,s){if(this._deleted)return()=>{};const a=typeof r=="function"?r:r.next.bind(r);let i=!1;const o=this._isInitialized?Promise.resolve():this._initializationPromise;if(Me(o,this,"internal-error"),o.then(()=>{i||a(this.currentUser)}),typeof r=="function"){const l=t.addObserver(r,n,s);return()=>{i=!0,l()}}else{const l=t.addObserver(r);return()=>{i=!0,l()}}}async directlySetCurrentUser(t){this.currentUser&&this.currentUser!==t&&this._currentUser._stopProactiveRefresh(),t&&this.isProactiveRefreshEnabled&&t._startProactiveRefresh(),this.currentUser=t,t?await this.assertedPersistence.setCurrentUser(t):await this.assertedPersistence.removeCurrentUser()}queue(t){return this.operations=this.operations.then(t,t),this.operations}get assertedPersistence(){return Me(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(t){!t||this.frameworks.includes(t)||(this.frameworks.push(t),this.frameworks.sort(),this.clientVersion=nk(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var t;const r={"X-Client-Version":this.clientVersion};this.app.options.appId&&(r["X-Firebase-gmpid"]=this.app.options.appId);const n=await((t=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||t===void 0?void 0:t.getHeartbeatsHeader());n&&(r["X-Firebase-Client"]=n);const s=await this._getAppCheckToken();return s&&(r["X-Firebase-AppCheck"]=s),r}async _getAppCheckToken(){var t;const r=await((t=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||t===void 0?void 0:t.getToken());return r!=null&&r.error&&BP(`Error while retrieving App Check token: ${r.error}`),r==null?void 0:r.token}}function Pd(e){return Ht(e)}class Ly{constructor(t){this.auth=t,this.observer=null,this.addObserver=Rb(r=>this.observer=r)}get next(){return Me(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let rv={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function uD(e){rv=e}function fD(e){return rv.loadJS(e)}function hD(){return rv.gapiScript}function dD(e){return`__${e}${Math.floor(Math.random()*1e6)}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mD(e,t){const r=Su(e,"auth");if(r.isInitialized()){const s=r.getImmediate(),a=r.getOptions();if(Oh(a,t??{}))return s;Cs(s,"already-initialized")}return r.initialize({options:t})}function pD(e,t){const r=(t==null?void 0:t.persistence)||[],n=(Array.isArray(r)?r:[r]).map(Js);t!=null&&t.errorMap&&e._updateErrorMap(t.errorMap),e._initializeWithPersistence(n,t==null?void 0:t.popupRedirectResolver)}function gD(e,t,r){const n=Pd(e);Me(n._canInitEmulator,n,"emulator-config-failed"),Me(/^https?:\/\//.test(t),n,"invalid-emulator-scheme");const s=!1,a=sk(t),{host:i,port:o}=vD(t),l=o===null?"":`:${o}`;n.config.emulator={url:`${a}//${i}${l}/`},n.settings.appVerificationDisabledForTesting=!0,n.emulatorConfig=Object.freeze({host:i,port:o,protocol:a.replace(":",""),options:Object.freeze({disableWarnings:s})}),xD()}function sk(e){const t=e.indexOf(":");return t<0?"":e.substr(0,t+1)}function vD(e){const t=sk(e),r=/(\/\/)?([^?#/]+)/.exec(e.substr(t.length));if(!r)return{host:"",port:null};const n=r[2].split("@").pop()||"",s=/^(\[[^\]]+\])(:|$)/.exec(n);if(s){const a=s[1];return{host:a,port:jy(n.substr(a.length+1))}}else{const[a,i]=n.split(":");return{host:a,port:jy(i)}}}function jy(e){if(!e)return null;const t=Number(e);return isNaN(t)?null:t}function xD(){function e(){const t=document.createElement("p"),r=t.style;t.innerText="Running in emulator mode. Do not use with production credentials.",r.position="fixed",r.width="100%",r.backgroundColor="#ffffff",r.border=".1em solid #000000",r.color="#b50000",r.bottom="0px",r.left="0px",r.margin="0px",r.zIndex="10000",r.textAlign="center",t.classList.add("firebase-emulator-warning"),document.body.appendChild(t)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",e):e())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ak{constructor(t,r){this.providerId=t,this.signInMethod=r}toJSON(){return Ys("not implemented")}_getIdTokenResponse(t){return Ys("not implemented")}_linkToIdToken(t,r){return Ys("not implemented")}_getReauthenticationResolver(t){return Ys("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Ko(e,t){return qP(e,"POST","/v1/accounts:signInWithIdp",Zg(e,t))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yD="http://localhost";class Gi extends ak{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(t){const r=new Gi(t.providerId,t.signInMethod);return t.idToken||t.accessToken?(t.idToken&&(r.idToken=t.idToken),t.accessToken&&(r.accessToken=t.accessToken),t.nonce&&!t.pendingToken&&(r.nonce=t.nonce),t.pendingToken&&(r.pendingToken=t.pendingToken)):t.oauthToken&&t.oauthTokenSecret?(r.accessToken=t.oauthToken,r.secret=t.oauthTokenSecret):Cs("argument-error"),r}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(t){const r=typeof t=="string"?JSON.parse(t):t,{providerId:n,signInMethod:s}=r,a=Xg(r,["providerId","signInMethod"]);if(!n||!s)return null;const i=new Gi(n,s);return i.idToken=a.idToken||void 0,i.accessToken=a.accessToken||void 0,i.secret=a.secret,i.nonce=a.nonce,i.pendingToken=a.pendingToken||null,i}_getIdTokenResponse(t){const r=this.buildRequest();return Ko(t,r)}_linkToIdToken(t,r){const n=this.buildRequest();return n.idToken=r,Ko(t,n)}_getReauthenticationResolver(t){const r=this.buildRequest();return r.autoCreate=!1,Ko(t,r)}buildRequest(){const t={requestUri:yD,returnSecureToken:!0};if(this.pendingToken)t.pendingToken=this.pendingToken;else{const r={};this.idToken&&(r.id_token=this.idToken),this.accessToken&&(r.access_token=this.accessToken),this.secret&&(r.oauth_token_secret=this.secret),r.providerId=this.providerId,this.nonce&&!this.pendingToken&&(r.nonce=this.nonce),t.postBody=ku(r)}return t}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nv{constructor(t){this.providerId=t,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(t){this.defaultLanguageCode=t}setCustomParameters(t){return this.customParameters=t,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Iu extends nv{constructor(){super(...arguments),this.scopes=[]}addScope(t){return this.scopes.includes(t)||this.scopes.push(t),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Da extends Iu{constructor(){super("facebook.com")}static credential(t){return Gi._fromParams({providerId:Da.PROVIDER_ID,signInMethod:Da.FACEBOOK_SIGN_IN_METHOD,accessToken:t})}static credentialFromResult(t){return Da.credentialFromTaggedObject(t)}static credentialFromError(t){return Da.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t||!("oauthAccessToken"in t)||!t.oauthAccessToken)return null;try{return Da.credential(t.oauthAccessToken)}catch{return null}}}Da.FACEBOOK_SIGN_IN_METHOD="facebook.com";Da.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _s extends Iu{constructor(){super("google.com"),this.addScope("profile")}static credential(t,r){return Gi._fromParams({providerId:_s.PROVIDER_ID,signInMethod:_s.GOOGLE_SIGN_IN_METHOD,idToken:t,accessToken:r})}static credentialFromResult(t){return _s.credentialFromTaggedObject(t)}static credentialFromError(t){return _s.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t)return null;const{oauthIdToken:r,oauthAccessToken:n}=t;if(!r&&!n)return null;try{return _s.credential(r,n)}catch{return null}}}_s.GOOGLE_SIGN_IN_METHOD="google.com";_s.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fa extends Iu{constructor(){super("github.com")}static credential(t){return Gi._fromParams({providerId:Fa.PROVIDER_ID,signInMethod:Fa.GITHUB_SIGN_IN_METHOD,accessToken:t})}static credentialFromResult(t){return Fa.credentialFromTaggedObject(t)}static credentialFromError(t){return Fa.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t||!("oauthAccessToken"in t)||!t.oauthAccessToken)return null;try{return Fa.credential(t.oauthAccessToken)}catch{return null}}}Fa.GITHUB_SIGN_IN_METHOD="github.com";Fa.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Oa extends Iu{constructor(){super("twitter.com")}static credential(t,r){return Gi._fromParams({providerId:Oa.PROVIDER_ID,signInMethod:Oa.TWITTER_SIGN_IN_METHOD,oauthToken:t,oauthTokenSecret:r})}static credentialFromResult(t){return Oa.credentialFromTaggedObject(t)}static credentialFromError(t){return Oa.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t)return null;const{oauthAccessToken:r,oauthTokenSecret:n}=t;if(!r||!n)return null;try{return Oa.credential(r,n)}catch{return null}}}Oa.TWITTER_SIGN_IN_METHOD="twitter.com";Oa.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ll{constructor(t){this.user=t.user,this.providerId=t.providerId,this._tokenResponse=t._tokenResponse,this.operationType=t.operationType}static async _fromIdTokenResponse(t,r,n,s=!1){const a=await Qs._fromIdTokenResponse(t,n,s),i=Vy(n);return new ll({user:a,providerId:i,_tokenResponse:n,operationType:r})}static async _forOperation(t,r,n){await t._updateTokensIfNecessary(n,!0);const s=Vy(n);return new ll({user:t,providerId:s,_tokenResponse:n,operationType:r})}}function Vy(e){return e.providerId?e.providerId:"phoneNumber"in e?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vh extends Ds{constructor(t,r,n,s){var a;super(r.code,r.message),this.operationType=n,this.user=s,Object.setPrototypeOf(this,Vh.prototype),this.customData={appName:t.name,tenantId:(a=t.tenantId)!==null&&a!==void 0?a:void 0,_serverResponse:r.customData._serverResponse,operationType:n}}static _fromErrorAndOperation(t,r,n,s){return new Vh(t,r,n,s)}}function ik(e,t,r,n){return(t==="reauthenticate"?r._getReauthenticationResolver(e):r._getIdTokenResponse(e)).catch(a=>{throw a.code==="auth/multi-factor-auth-required"?Vh._fromErrorAndOperation(e,a,t,n):a})}async function _D(e,t,r=!1){const n=await Zc(e,t._linkToIdToken(e.auth,await e.getIdToken()),r);return ll._forOperation(e,"link",n)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function wD(e,t,r=!1){const{auth:n}=e;if(Xs(n.app))return Promise.reject(Mi(n));const s="reauthenticate";try{const a=await Zc(e,ik(n,s,t,e),r);Me(a.idToken,n,"internal-error");const i=ev(a.idToken);Me(i,n,"internal-error");const{sub:o}=i;return Me(e.uid===o,n,"user-mismatch"),ll._forOperation(e,s,a)}catch(a){throw(a==null?void 0:a.code)==="auth/user-not-found"&&Cs(n,"user-mismatch"),a}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ED(e,t,r=!1){if(Xs(e.app))return Promise.reject(Mi(e));const n="signIn",s=await ik(e,n,t),a=await ll._fromIdTokenResponse(e,n,s);return r||await e._updateCurrentUser(a.user),a}function TD(e,t,r,n){return Ht(e).onIdTokenChanged(t,r,n)}function kD(e,t,r){return Ht(e).beforeAuthStateChanged(t,r)}function ok(e,t,r,n){return Ht(e).onAuthStateChanged(t,r,n)}function SD(e){return Ht(e).signOut()}const Uh="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lk{constructor(t,r){this.storageRetriever=t,this.type=r}_isAvailable(){try{return this.storage?(this.storage.setItem(Uh,"1"),this.storage.removeItem(Uh),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(t,r){return this.storage.setItem(t,JSON.stringify(r)),Promise.resolve()}_get(t){const r=this.storage.getItem(t);return Promise.resolve(r?JSON.parse(r):null)}_remove(t){return this.storage.removeItem(t),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const AD=1e3,ID=10;class ck extends lk{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(t,r)=>this.onStorageEvent(t,r),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=rk(),this._shouldAllowMigration=!0}forAllChangedKeys(t){for(const r of Object.keys(this.listeners)){const n=this.storage.getItem(r),s=this.localCache[r];n!==s&&t(r,s,n)}}onStorageEvent(t,r=!1){if(!t.key){this.forAllChangedKeys((i,o,l)=>{this.notifyListeners(i,l)});return}const n=t.key;r?this.detachListener():this.stopPolling();const s=()=>{const i=this.storage.getItem(n);!r&&this.localCache[n]===i||this.notifyListeners(n,i)},a=this.storage.getItem(n);sD()&&a!==t.newValue&&t.newValue!==t.oldValue?setTimeout(s,ID):s()}notifyListeners(t,r){this.localCache[t]=r;const n=this.listeners[t];if(n)for(const s of Array.from(n))s(r&&JSON.parse(r))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((t,r,n)=>{this.onStorageEvent(new StorageEvent("storage",{key:t,oldValue:r,newValue:n}),!0)})},AD)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(t,r){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[t]||(this.listeners[t]=new Set,this.localCache[t]=this.storage.getItem(t)),this.listeners[t].add(r)}_removeListener(t,r){this.listeners[t]&&(this.listeners[t].delete(r),this.listeners[t].size===0&&delete this.listeners[t]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(t,r){await super._set(t,r),this.localCache[t]=JSON.stringify(r)}async _get(t){const r=await super._get(t);return this.localCache[t]=JSON.stringify(r),r}async _remove(t){await super._remove(t),delete this.localCache[t]}}ck.type="LOCAL";const CD=ck;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uk extends lk{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(t,r){}_removeListener(t,r){}}uk.type="SESSION";const fk=uk;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ND(e){return Promise.all(e.map(async t=>{try{return{fulfilled:!0,value:await t}}catch(r){return{fulfilled:!1,reason:r}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dd{constructor(t){this.eventTarget=t,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(t){const r=this.receivers.find(s=>s.isListeningto(t));if(r)return r;const n=new Dd(t);return this.receivers.push(n),n}isListeningto(t){return this.eventTarget===t}async handleEvent(t){const r=t,{eventId:n,eventType:s,data:a}=r.data,i=this.handlersMap[s];if(!(i!=null&&i.size))return;r.ports[0].postMessage({status:"ack",eventId:n,eventType:s});const o=Array.from(i).map(async c=>c(r.origin,a)),l=await ND(o);r.ports[0].postMessage({status:"done",eventId:n,eventType:s,response:l})}_subscribe(t,r){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[t]||(this.handlersMap[t]=new Set),this.handlersMap[t].add(r)}_unsubscribe(t,r){this.handlersMap[t]&&r&&this.handlersMap[t].delete(r),(!r||this.handlersMap[t].size===0)&&delete this.handlersMap[t],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}Dd.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sv(e="",t=10){let r="";for(let n=0;n<t;n++)r+=Math.floor(Math.random()*10);return e+r}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RD{constructor(t){this.target=t,this.handlers=new Set}removeMessageHandler(t){t.messageChannel&&(t.messageChannel.port1.removeEventListener("message",t.onMessage),t.messageChannel.port1.close()),this.handlers.delete(t)}async _send(t,r,n=50){const s=typeof MessageChannel<"u"?new MessageChannel:null;if(!s)throw new Error("connection_unavailable");let a,i;return new Promise((o,l)=>{const c=sv("",20);s.port1.start();const u=setTimeout(()=>{l(new Error("unsupported_event"))},n);i={messageChannel:s,onMessage(d){const m=d;if(m.data.eventId===c)switch(m.data.status){case"ack":clearTimeout(u),a=setTimeout(()=>{l(new Error("timeout"))},3e3);break;case"done":clearTimeout(a),o(m.data.response);break;default:clearTimeout(u),clearTimeout(a),l(new Error("invalid_response"));break}}},this.handlers.add(i),s.port1.addEventListener("message",i.onMessage),this.target.postMessage({eventType:t,eventId:c,data:r},[s.port2])}).finally(()=>{i&&this.removeMessageHandler(i)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ks(){return window}function bD(e){ks().location.href=e}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hk(){return typeof ks().WorkerGlobalScope<"u"&&typeof ks().importScripts=="function"}async function PD(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function DD(){var e;return((e=navigator==null?void 0:navigator.serviceWorker)===null||e===void 0?void 0:e.controller)||null}function FD(){return hk()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dk="firebaseLocalStorageDb",OD=1,Bh="firebaseLocalStorage",mk="fbase_key";class Cu{constructor(t){this.request=t}toPromise(){return new Promise((t,r)=>{this.request.addEventListener("success",()=>{t(this.request.result)}),this.request.addEventListener("error",()=>{r(this.request.error)})})}}function Fd(e,t){return e.transaction([Bh],t?"readwrite":"readonly").objectStore(Bh)}function MD(){const e=indexedDB.deleteDatabase(dk);return new Cu(e).toPromise()}function dp(){const e=indexedDB.open(dk,OD);return new Promise((t,r)=>{e.addEventListener("error",()=>{r(e.error)}),e.addEventListener("upgradeneeded",()=>{const n=e.result;try{n.createObjectStore(Bh,{keyPath:mk})}catch(s){r(s)}}),e.addEventListener("success",async()=>{const n=e.result;n.objectStoreNames.contains(Bh)?t(n):(n.close(),await MD(),t(await dp()))})})}async function Uy(e,t,r){const n=Fd(e,!0).put({[mk]:t,value:r});return new Cu(n).toPromise()}async function LD(e,t){const r=Fd(e,!1).get(t),n=await new Cu(r).toPromise();return n===void 0?null:n.value}function By(e,t){const r=Fd(e,!0).delete(t);return new Cu(r).toPromise()}const jD=800,VD=3;class pk{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await dp(),this.db)}async _withRetries(t){let r=0;for(;;)try{const n=await this._openDb();return await t(n)}catch(n){if(r++>VD)throw n;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return hk()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=Dd._getInstance(FD()),this.receiver._subscribe("keyChanged",async(t,r)=>({keyProcessed:(await this._poll()).includes(r.key)})),this.receiver._subscribe("ping",async(t,r)=>["keyChanged"])}async initializeSender(){var t,r;if(this.activeServiceWorker=await PD(),!this.activeServiceWorker)return;this.sender=new RD(this.activeServiceWorker);const n=await this.sender._send("ping",{},800);n&&!((t=n[0])===null||t===void 0)&&t.fulfilled&&!((r=n[0])===null||r===void 0)&&r.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(t){if(!(!this.sender||!this.activeServiceWorker||DD()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:t},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const t=await dp();return await Uy(t,Uh,"1"),await By(t,Uh),!0}catch{}return!1}async _withPendingWrite(t){this.pendingWrites++;try{await t()}finally{this.pendingWrites--}}async _set(t,r){return this._withPendingWrite(async()=>(await this._withRetries(n=>Uy(n,t,r)),this.localCache[t]=r,this.notifyServiceWorker(t)))}async _get(t){const r=await this._withRetries(n=>LD(n,t));return this.localCache[t]=r,r}async _remove(t){return this._withPendingWrite(async()=>(await this._withRetries(r=>By(r,t)),delete this.localCache[t],this.notifyServiceWorker(t)))}async _poll(){const t=await this._withRetries(s=>{const a=Fd(s,!1).getAll();return new Cu(a).toPromise()});if(!t)return[];if(this.pendingWrites!==0)return[];const r=[],n=new Set;if(t.length!==0)for(const{fbase_key:s,value:a}of t)n.add(s),JSON.stringify(this.localCache[s])!==JSON.stringify(a)&&(this.notifyListeners(s,a),r.push(s));for(const s of Object.keys(this.localCache))this.localCache[s]&&!n.has(s)&&(this.notifyListeners(s,null),r.push(s));return r}notifyListeners(t,r){this.localCache[t]=r;const n=this.listeners[t];if(n)for(const s of Array.from(n))s(r)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),jD)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(t,r){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[t]||(this.listeners[t]=new Set,this._get(t)),this.listeners[t].add(r)}_removeListener(t,r){this.listeners[t]&&(this.listeners[t].delete(r),this.listeners[t].size===0&&delete this.listeners[t]),Object.keys(this.listeners).length===0&&this.stopPolling()}}pk.type="LOCAL";const UD=pk;new Au(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gk(e,t){return t?Js(t):(Me(e._popupRedirectResolver,e,"argument-error"),e._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class av extends ak{constructor(t){super("custom","custom"),this.params=t}_getIdTokenResponse(t){return Ko(t,this._buildIdpRequest())}_linkToIdToken(t,r){return Ko(t,this._buildIdpRequest(r))}_getReauthenticationResolver(t){return Ko(t,this._buildIdpRequest())}_buildIdpRequest(t){const r={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return t&&(r.idToken=t),r}}function BD(e){return ED(e.auth,new av(e),e.bypassAuthState)}function zD(e){const{auth:t,user:r}=e;return Me(r,t,"internal-error"),wD(r,new av(e),e.bypassAuthState)}async function $D(e){const{auth:t,user:r}=e;return Me(r,t,"internal-error"),_D(r,new av(e),e.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vk{constructor(t,r,n,s,a=!1){this.auth=t,this.resolver=n,this.user=s,this.bypassAuthState=a,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(r)?r:[r]}execute(){return new Promise(async(t,r)=>{this.pendingPromise={resolve:t,reject:r};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(n){this.reject(n)}})}async onAuthEvent(t){const{urlResponse:r,sessionId:n,postBody:s,tenantId:a,error:i,type:o}=t;if(i){this.reject(i);return}const l={auth:this.auth,requestUri:r,sessionId:n,tenantId:a||void 0,postBody:s||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(o)(l))}catch(c){this.reject(c)}}onError(t){this.reject(t)}getIdpTask(t){switch(t){case"signInViaPopup":case"signInViaRedirect":return BD;case"linkViaPopup":case"linkViaRedirect":return $D;case"reauthViaPopup":case"reauthViaRedirect":return zD;default:Cs(this.auth,"internal-error")}}resolve(t){ha(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(t),this.unregisterAndCleanUp()}reject(t){ha(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(t),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const WD=new Au(2e3,1e4);async function xk(e,t,r){if(Xs(e.app))return Promise.reject(ls(e,"operation-not-supported-in-this-environment"));const n=Pd(e);zP(e,t,nv);const s=gk(n,r);return new bi(n,"signInViaPopup",t,s).executeNotNull()}class bi extends vk{constructor(t,r,n,s,a){super(t,r,s,a),this.provider=n,this.authWindow=null,this.pollId=null,bi.currentPopupAction&&bi.currentPopupAction.cancel(),bi.currentPopupAction=this}async executeNotNull(){const t=await this.execute();return Me(t,this.auth,"internal-error"),t}async onExecution(){ha(this.filter.length===1,"Popup operations only handle one event");const t=sv();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],t),this.authWindow.associatedEvent=t,this.resolver._originValidation(this.auth).catch(r=>{this.reject(r)}),this.resolver._isIframeWebStorageSupported(this.auth,r=>{r||this.reject(ls(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var t;return((t=this.authWindow)===null||t===void 0?void 0:t.associatedEvent)||null}cancel(){this.reject(ls(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,bi.currentPopupAction=null}pollUserCancellation(){const t=()=>{var r,n;if(!((n=(r=this.authWindow)===null||r===void 0?void 0:r.window)===null||n===void 0)&&n.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(ls(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(t,WD.get())};t()}}bi.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const HD="pendingRedirect",Jf=new Map;class GD extends vk{constructor(t,r,n=!1){super(t,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],r,void 0,n),this.eventId=null}async execute(){let t=Jf.get(this.auth._key());if(!t){try{const n=await KD(this.resolver,this.auth)?await super.execute():null;t=()=>Promise.resolve(n)}catch(r){t=()=>Promise.reject(r)}Jf.set(this.auth._key(),t)}return this.bypassAuthState||Jf.set(this.auth._key(),()=>Promise.resolve(null)),t()}async onAuthEvent(t){if(t.type==="signInViaRedirect")return super.onAuthEvent(t);if(t.type==="unknown"){this.resolve(null);return}if(t.eventId){const r=await this.auth._redirectUserForId(t.eventId);if(r)return this.user=r,super.onAuthEvent(t);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function KD(e,t){const r=YD(t),n=XD(e);if(!await n._isAvailable())return!1;const s=await n._get(r)==="true";return await n._remove(r),s}function qD(e,t){Jf.set(e._key(),t)}function XD(e){return Js(e._redirectPersistence)}function YD(e){return Qf(HD,e.config.apiKey,e.name)}async function QD(e,t,r=!1){if(Xs(e.app))return Promise.reject(Mi(e));const n=Pd(e),s=gk(n,t),i=await new GD(n,s,r).execute();return i&&!r&&(delete i.user._redirectEventId,await n._persistUserIfCurrent(i.user),await n._setRedirectUser(null,t)),i}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const JD=10*60*1e3;class ZD{constructor(t){this.auth=t,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(t){this.consumers.add(t),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,t)&&(this.sendToConsumer(this.queuedRedirectEvent,t),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(t){this.consumers.delete(t)}onEvent(t){if(this.hasEventBeenHandled(t))return!1;let r=!1;return this.consumers.forEach(n=>{this.isEventForConsumer(t,n)&&(r=!0,this.sendToConsumer(t,n),this.saveEventToCache(t))}),this.hasHandledPotentialRedirect||!e3(t)||(this.hasHandledPotentialRedirect=!0,r||(this.queuedRedirectEvent=t,r=!0)),r}sendToConsumer(t,r){var n;if(t.error&&!yk(t)){const s=((n=t.error.code)===null||n===void 0?void 0:n.split("auth/")[1])||"internal-error";r.onError(ls(this.auth,s))}else r.onAuthEvent(t)}isEventForConsumer(t,r){const n=r.eventId===null||!!t.eventId&&t.eventId===r.eventId;return r.filter.includes(t.type)&&n}hasEventBeenHandled(t){return Date.now()-this.lastProcessedEventTime>=JD&&this.cachedEventUids.clear(),this.cachedEventUids.has(zy(t))}saveEventToCache(t){this.cachedEventUids.add(zy(t)),this.lastProcessedEventTime=Date.now()}}function zy(e){return[e.type,e.eventId,e.sessionId,e.tenantId].filter(t=>t).join("-")}function yk({type:e,error:t}){return e==="unknown"&&(t==null?void 0:t.code)==="auth/no-auth-event"}function e3(e){switch(e.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return yk(e);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function t3(e,t={}){return El(e,"GET","/v1/projects",t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const r3=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,n3=/^https?/;async function s3(e){if(e.config.emulator)return;const{authorizedDomains:t}=await t3(e);for(const r of t)try{if(a3(r))return}catch{}Cs(e,"unauthorized-domain")}function a3(e){const t=fp(),{protocol:r,hostname:n}=new URL(t);if(e.startsWith("chrome-extension://")){const i=new URL(e);return i.hostname===""&&n===""?r==="chrome-extension:"&&e.replace("chrome-extension://","")===t.replace("chrome-extension://",""):r==="chrome-extension:"&&i.hostname===n}if(!n3.test(r))return!1;if(r3.test(e))return n===e;const s=e.replace(/\./g,"\\.");return new RegExp("^(.+\\."+s+"|"+s+")$","i").test(n)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const i3=new Au(3e4,6e4);function $y(){const e=ks().___jsl;if(e!=null&&e.H){for(const t of Object.keys(e.H))if(e.H[t].r=e.H[t].r||[],e.H[t].L=e.H[t].L||[],e.H[t].r=[...e.H[t].L],e.CP)for(let r=0;r<e.CP.length;r++)e.CP[r]=null}}function o3(e){return new Promise((t,r)=>{var n,s,a;function i(){$y(),gapi.load("gapi.iframes",{callback:()=>{t(gapi.iframes.getContext())},ontimeout:()=>{$y(),r(ls(e,"network-request-failed"))},timeout:i3.get()})}if(!((s=(n=ks().gapi)===null||n===void 0?void 0:n.iframes)===null||s===void 0)&&s.Iframe)t(gapi.iframes.getContext());else if(!((a=ks().gapi)===null||a===void 0)&&a.load)i();else{const o=dD("iframefcb");return ks()[o]=()=>{gapi.load?i():r(ls(e,"network-request-failed"))},fD(`${hD()}?onload=${o}`).catch(l=>r(l))}}).catch(t=>{throw Zf=null,t})}let Zf=null;function l3(e){return Zf=Zf||o3(e),Zf}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const c3=new Au(5e3,15e3),u3="__/auth/iframe",f3="emulator/auth/iframe",h3={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},d3=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function m3(e){const t=e.config;Me(t.authDomain,e,"auth-domain-config-required");const r=t.emulator?Jg(t,f3):`https://${e.config.authDomain}/${u3}`,n={apiKey:t.apiKey,appName:e.name,v:ro},s=d3.get(e.config.apiHost);s&&(n.eid=s);const a=e._getFrameworks();return a.length&&(n.fw=a.join(",")),`${r}?${ku(n).slice(1)}`}async function p3(e){const t=await l3(e),r=ks().gapi;return Me(r,e,"internal-error"),t.open({where:document.body,url:m3(e),messageHandlersFilter:r.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:h3,dontclear:!0},n=>new Promise(async(s,a)=>{await n.restyle({setHideOnLeave:!1});const i=ls(e,"network-request-failed"),o=ks().setTimeout(()=>{a(i)},c3.get());function l(){ks().clearTimeout(o),s(n)}n.ping(l).then(l,()=>{a(i)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const g3={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},v3=500,x3=600,y3="_blank",_3="http://localhost";class Wy{constructor(t){this.window=t,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function w3(e,t,r,n=v3,s=x3){const a=Math.max((window.screen.availHeight-s)/2,0).toString(),i=Math.max((window.screen.availWidth-n)/2,0).toString();let o="";const l=Object.assign(Object.assign({},g3),{width:n.toString(),height:s.toString(),top:a,left:i}),c=Hr().toLowerCase();r&&(o=QT(c)?y3:r),XT(c)&&(t=t||_3,l.scrollbars="yes");const u=Object.entries(l).reduce((m,[p,g])=>`${m}${p}=${g},`,"");if(nD(c)&&o!=="_self")return E3(t||"",o),new Wy(null);const d=window.open(t||"",o,u);Me(d,e,"popup-blocked");try{d.focus()}catch{}return new Wy(d)}function E3(e,t){const r=document.createElement("a");r.href=e,r.target=t;const n=document.createEvent("MouseEvent");n.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),r.dispatchEvent(n)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const T3="__/auth/handler",k3="emulator/auth/handler",S3=encodeURIComponent("fac");async function Hy(e,t,r,n,s,a){Me(e.config.authDomain,e,"auth-domain-config-required"),Me(e.config.apiKey,e,"invalid-api-key");const i={apiKey:e.config.apiKey,appName:e.name,authType:r,redirectUrl:n,v:ro,eventId:s};if(t instanceof nv){t.setDefaultLanguage(e.languageCode),i.providerId=t.providerId||"",Nb(t.getCustomParameters())||(i.customParameters=JSON.stringify(t.getCustomParameters()));for(const[u,d]of Object.entries({}))i[u]=d}if(t instanceof Iu){const u=t.getScopes().filter(d=>d!=="");u.length>0&&(i.scopes=u.join(","))}e.tenantId&&(i.tid=e.tenantId);const o=i;for(const u of Object.keys(o))o[u]===void 0&&delete o[u];const l=await e._getAppCheckToken(),c=l?`#${S3}=${encodeURIComponent(l)}`:"";return`${A3(e)}?${ku(o).slice(1)}${c}`}function A3({config:e}){return e.emulator?Jg(e,k3):`https://${e.authDomain}/${T3}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const K0="webStorageSupport";class I3{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=fk,this._completeRedirectFn=QD,this._overrideRedirectResult=qD}async _openPopup(t,r,n,s){var a;ha((a=this.eventManagers[t._key()])===null||a===void 0?void 0:a.manager,"_initialize() not called before _openPopup()");const i=await Hy(t,r,n,fp(),s);return w3(t,i,sv())}async _openRedirect(t,r,n,s){await this._originValidation(t);const a=await Hy(t,r,n,fp(),s);return bD(a),new Promise(()=>{})}_initialize(t){const r=t._key();if(this.eventManagers[r]){const{manager:s,promise:a}=this.eventManagers[r];return s?Promise.resolve(s):(ha(a,"If manager is not set, promise should be"),a)}const n=this.initAndGetManager(t);return this.eventManagers[r]={promise:n},n.catch(()=>{delete this.eventManagers[r]}),n}async initAndGetManager(t){const r=await p3(t),n=new ZD(t);return r.register("authEvent",s=>(Me(s==null?void 0:s.authEvent,t,"invalid-auth-event"),{status:n.onEvent(s.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[t._key()]={manager:n},this.iframes[t._key()]=r,n}_isIframeWebStorageSupported(t,r){this.iframes[t._key()].send(K0,{type:K0},s=>{var a;const i=(a=s==null?void 0:s[0])===null||a===void 0?void 0:a[K0];i!==void 0&&r(!!i),Cs(t,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(t){const r=t._key();return this.originValidationPromises[r]||(this.originValidationPromises[r]=s3(t)),this.originValidationPromises[r]}get _shouldInitProactively(){return rk()||YT()||tv()}}const C3=I3;var Gy="@firebase/auth",Ky="1.7.9";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class N3{constructor(t){this.auth=t,this.internalListeners=new Map}getUid(){var t;return this.assertAuthConfigured(),((t=this.auth.currentUser)===null||t===void 0?void 0:t.uid)||null}async getToken(t){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(t)}:null}addAuthTokenListener(t){if(this.assertAuthConfigured(),this.internalListeners.has(t))return;const r=this.auth.onIdTokenChanged(n=>{t((n==null?void 0:n.stsTokenManager.accessToken)||null)});this.internalListeners.set(t,r),this.updateProactiveRefresh()}removeAuthTokenListener(t){this.assertAuthConfigured();const r=this.internalListeners.get(t);r&&(this.internalListeners.delete(t),r(),this.updateProactiveRefresh())}assertAuthConfigured(){Me(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function R3(e){switch(e){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function b3(e){ai(new ua("auth",(t,{options:r})=>{const n=t.getProvider("app").getImmediate(),s=t.getProvider("heartbeat"),a=t.getProvider("app-check-internal"),{apiKey:i,authDomain:o}=n.options;Me(i&&!i.includes(":"),"invalid-api-key",{appName:n.name});const l={apiKey:i,authDomain:o,clientPlatform:e,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:nk(e)},c=new cD(n,s,a,l);return pD(c,r),c},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((t,r,n)=>{t.getProvider("auth-internal").initialize()})),ai(new ua("auth-internal",t=>{const r=Pd(t.getProvider("auth").getImmediate());return(n=>new N3(n))(r)},"PRIVATE").setInstantiationMode("EXPLICIT")),Un(Gy,Ky,R3(e)),Un(Gy,Ky,"esm2017")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const P3=5*60,D3=DT("authIdTokenMaxAge")||P3;let qy=null;const F3=e=>async t=>{const r=t&&await t.getIdTokenResult(),n=r&&(new Date().getTime()-Date.parse(r.issuedAtTime))/1e3;if(n&&n>D3)return;const s=r==null?void 0:r.token;qy!==s&&(qy=s,await fetch(e,{method:s?"POST":"DELETE",headers:s?{Authorization:`Bearer ${s}`}:{}}))};function O3(e=bd()){const t=Su(e,"auth");if(t.isInitialized())return t.getImmediate();const r=mD(e,{popupRedirectResolver:C3,persistence:[UD,CD,fk]}),n=DT("authTokenSyncURL");if(n&&typeof isSecureContext=="boolean"&&isSecureContext){const a=new URL(n,location.origin);if(location.origin===a.origin){const i=F3(a.toString());kD(r,i,()=>i(r.currentUser)),TD(r,o=>i(o))}}const s=bT("auth");return s&&gD(r,`http://${s}`),r}function M3(){var e,t;return(t=(e=document.getElementsByTagName("head"))===null||e===void 0?void 0:e[0])!==null&&t!==void 0?t:document}uD({loadJS(e){return new Promise((t,r)=>{const n=document.createElement("script");n.setAttribute("src",e),n.onload=t,n.onerror=s=>{const a=ls("internal-error");a.customData=s,r(a)},n.type="text/javascript",n.charset="UTF-8",M3().appendChild(n)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});b3("Browser");var Xy=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Li,_k;(function(){var e;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function t(v,_){function S(){}S.prototype=_.prototype,v.D=_.prototype,v.prototype=new S,v.prototype.constructor=v,v.C=function(I,b,P){for(var R=Array(arguments.length-2),ue=2;ue<arguments.length;ue++)R[ue-2]=arguments[ue];return _.prototype[b].apply(I,R)}}function r(){this.blockSize=-1}function n(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}t(n,r),n.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function s(v,_,S){S||(S=0);var I=Array(16);if(typeof _=="string")for(var b=0;16>b;++b)I[b]=_.charCodeAt(S++)|_.charCodeAt(S++)<<8|_.charCodeAt(S++)<<16|_.charCodeAt(S++)<<24;else for(b=0;16>b;++b)I[b]=_[S++]|_[S++]<<8|_[S++]<<16|_[S++]<<24;_=v.g[0],S=v.g[1],b=v.g[2];var P=v.g[3],R=_+(P^S&(b^P))+I[0]+3614090360&4294967295;_=S+(R<<7&4294967295|R>>>25),R=P+(b^_&(S^b))+I[1]+3905402710&4294967295,P=_+(R<<12&4294967295|R>>>20),R=b+(S^P&(_^S))+I[2]+606105819&4294967295,b=P+(R<<17&4294967295|R>>>15),R=S+(_^b&(P^_))+I[3]+3250441966&4294967295,S=b+(R<<22&4294967295|R>>>10),R=_+(P^S&(b^P))+I[4]+4118548399&4294967295,_=S+(R<<7&4294967295|R>>>25),R=P+(b^_&(S^b))+I[5]+1200080426&4294967295,P=_+(R<<12&4294967295|R>>>20),R=b+(S^P&(_^S))+I[6]+2821735955&4294967295,b=P+(R<<17&4294967295|R>>>15),R=S+(_^b&(P^_))+I[7]+4249261313&4294967295,S=b+(R<<22&4294967295|R>>>10),R=_+(P^S&(b^P))+I[8]+1770035416&4294967295,_=S+(R<<7&4294967295|R>>>25),R=P+(b^_&(S^b))+I[9]+2336552879&4294967295,P=_+(R<<12&4294967295|R>>>20),R=b+(S^P&(_^S))+I[10]+4294925233&4294967295,b=P+(R<<17&4294967295|R>>>15),R=S+(_^b&(P^_))+I[11]+2304563134&4294967295,S=b+(R<<22&4294967295|R>>>10),R=_+(P^S&(b^P))+I[12]+1804603682&4294967295,_=S+(R<<7&4294967295|R>>>25),R=P+(b^_&(S^b))+I[13]+4254626195&4294967295,P=_+(R<<12&4294967295|R>>>20),R=b+(S^P&(_^S))+I[14]+2792965006&4294967295,b=P+(R<<17&4294967295|R>>>15),R=S+(_^b&(P^_))+I[15]+1236535329&4294967295,S=b+(R<<22&4294967295|R>>>10),R=_+(b^P&(S^b))+I[1]+4129170786&4294967295,_=S+(R<<5&4294967295|R>>>27),R=P+(S^b&(_^S))+I[6]+3225465664&4294967295,P=_+(R<<9&4294967295|R>>>23),R=b+(_^S&(P^_))+I[11]+643717713&4294967295,b=P+(R<<14&4294967295|R>>>18),R=S+(P^_&(b^P))+I[0]+3921069994&4294967295,S=b+(R<<20&4294967295|R>>>12),R=_+(b^P&(S^b))+I[5]+3593408605&4294967295,_=S+(R<<5&4294967295|R>>>27),R=P+(S^b&(_^S))+I[10]+38016083&4294967295,P=_+(R<<9&4294967295|R>>>23),R=b+(_^S&(P^_))+I[15]+3634488961&4294967295,b=P+(R<<14&4294967295|R>>>18),R=S+(P^_&(b^P))+I[4]+3889429448&4294967295,S=b+(R<<20&4294967295|R>>>12),R=_+(b^P&(S^b))+I[9]+568446438&4294967295,_=S+(R<<5&4294967295|R>>>27),R=P+(S^b&(_^S))+I[14]+3275163606&4294967295,P=_+(R<<9&4294967295|R>>>23),R=b+(_^S&(P^_))+I[3]+4107603335&4294967295,b=P+(R<<14&4294967295|R>>>18),R=S+(P^_&(b^P))+I[8]+1163531501&4294967295,S=b+(R<<20&4294967295|R>>>12),R=_+(b^P&(S^b))+I[13]+2850285829&4294967295,_=S+(R<<5&4294967295|R>>>27),R=P+(S^b&(_^S))+I[2]+4243563512&4294967295,P=_+(R<<9&4294967295|R>>>23),R=b+(_^S&(P^_))+I[7]+1735328473&4294967295,b=P+(R<<14&4294967295|R>>>18),R=S+(P^_&(b^P))+I[12]+2368359562&4294967295,S=b+(R<<20&4294967295|R>>>12),R=_+(S^b^P)+I[5]+4294588738&4294967295,_=S+(R<<4&4294967295|R>>>28),R=P+(_^S^b)+I[8]+2272392833&4294967295,P=_+(R<<11&4294967295|R>>>21),R=b+(P^_^S)+I[11]+1839030562&4294967295,b=P+(R<<16&4294967295|R>>>16),R=S+(b^P^_)+I[14]+4259657740&4294967295,S=b+(R<<23&4294967295|R>>>9),R=_+(S^b^P)+I[1]+2763975236&4294967295,_=S+(R<<4&4294967295|R>>>28),R=P+(_^S^b)+I[4]+1272893353&4294967295,P=_+(R<<11&4294967295|R>>>21),R=b+(P^_^S)+I[7]+4139469664&4294967295,b=P+(R<<16&4294967295|R>>>16),R=S+(b^P^_)+I[10]+3200236656&4294967295,S=b+(R<<23&4294967295|R>>>9),R=_+(S^b^P)+I[13]+681279174&4294967295,_=S+(R<<4&4294967295|R>>>28),R=P+(_^S^b)+I[0]+3936430074&4294967295,P=_+(R<<11&4294967295|R>>>21),R=b+(P^_^S)+I[3]+3572445317&4294967295,b=P+(R<<16&4294967295|R>>>16),R=S+(b^P^_)+I[6]+76029189&4294967295,S=b+(R<<23&4294967295|R>>>9),R=_+(S^b^P)+I[9]+3654602809&4294967295,_=S+(R<<4&4294967295|R>>>28),R=P+(_^S^b)+I[12]+3873151461&4294967295,P=_+(R<<11&4294967295|R>>>21),R=b+(P^_^S)+I[15]+530742520&4294967295,b=P+(R<<16&4294967295|R>>>16),R=S+(b^P^_)+I[2]+3299628645&4294967295,S=b+(R<<23&4294967295|R>>>9),R=_+(b^(S|~P))+I[0]+4096336452&4294967295,_=S+(R<<6&4294967295|R>>>26),R=P+(S^(_|~b))+I[7]+1126891415&4294967295,P=_+(R<<10&4294967295|R>>>22),R=b+(_^(P|~S))+I[14]+2878612391&4294967295,b=P+(R<<15&4294967295|R>>>17),R=S+(P^(b|~_))+I[5]+4237533241&4294967295,S=b+(R<<21&4294967295|R>>>11),R=_+(b^(S|~P))+I[12]+1700485571&4294967295,_=S+(R<<6&4294967295|R>>>26),R=P+(S^(_|~b))+I[3]+2399980690&4294967295,P=_+(R<<10&4294967295|R>>>22),R=b+(_^(P|~S))+I[10]+4293915773&4294967295,b=P+(R<<15&4294967295|R>>>17),R=S+(P^(b|~_))+I[1]+2240044497&4294967295,S=b+(R<<21&4294967295|R>>>11),R=_+(b^(S|~P))+I[8]+1873313359&4294967295,_=S+(R<<6&4294967295|R>>>26),R=P+(S^(_|~b))+I[15]+4264355552&4294967295,P=_+(R<<10&4294967295|R>>>22),R=b+(_^(P|~S))+I[6]+2734768916&4294967295,b=P+(R<<15&4294967295|R>>>17),R=S+(P^(b|~_))+I[13]+1309151649&4294967295,S=b+(R<<21&4294967295|R>>>11),R=_+(b^(S|~P))+I[4]+4149444226&4294967295,_=S+(R<<6&4294967295|R>>>26),R=P+(S^(_|~b))+I[11]+3174756917&4294967295,P=_+(R<<10&4294967295|R>>>22),R=b+(_^(P|~S))+I[2]+718787259&4294967295,b=P+(R<<15&4294967295|R>>>17),R=S+(P^(b|~_))+I[9]+3951481745&4294967295,v.g[0]=v.g[0]+_&4294967295,v.g[1]=v.g[1]+(b+(R<<21&4294967295|R>>>11))&4294967295,v.g[2]=v.g[2]+b&4294967295,v.g[3]=v.g[3]+P&4294967295}n.prototype.u=function(v,_){_===void 0&&(_=v.length);for(var S=_-this.blockSize,I=this.B,b=this.h,P=0;P<_;){if(b==0)for(;P<=S;)s(this,v,P),P+=this.blockSize;if(typeof v=="string"){for(;P<_;)if(I[b++]=v.charCodeAt(P++),b==this.blockSize){s(this,I),b=0;break}}else for(;P<_;)if(I[b++]=v[P++],b==this.blockSize){s(this,I),b=0;break}}this.h=b,this.o+=_},n.prototype.v=function(){var v=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);v[0]=128;for(var _=1;_<v.length-8;++_)v[_]=0;var S=8*this.o;for(_=v.length-8;_<v.length;++_)v[_]=S&255,S/=256;for(this.u(v),v=Array(16),_=S=0;4>_;++_)for(var I=0;32>I;I+=8)v[S++]=this.g[_]>>>I&255;return v};function a(v,_){var S=o;return Object.prototype.hasOwnProperty.call(S,v)?S[v]:S[v]=_(v)}function i(v,_){this.h=_;for(var S=[],I=!0,b=v.length-1;0<=b;b--){var P=v[b]|0;I&&P==_||(S[b]=P,I=!1)}this.g=S}var o={};function l(v){return-128<=v&&128>v?a(v,function(_){return new i([_|0],0>_?-1:0)}):new i([v|0],0>v?-1:0)}function c(v){if(isNaN(v)||!isFinite(v))return d;if(0>v)return w(c(-v));for(var _=[],S=1,I=0;v>=S;I++)_[I]=v/S|0,S*=4294967296;return new i(_,0)}function u(v,_){if(v.length==0)throw Error("number format error: empty string");if(_=_||10,2>_||36<_)throw Error("radix out of range: "+_);if(v.charAt(0)=="-")return w(u(v.substring(1),_));if(0<=v.indexOf("-"))throw Error('number format error: interior "-" character');for(var S=c(Math.pow(_,8)),I=d,b=0;b<v.length;b+=8){var P=Math.min(8,v.length-b),R=parseInt(v.substring(b,b+P),_);8>P?(P=c(Math.pow(_,P)),I=I.j(P).add(c(R))):(I=I.j(S),I=I.add(c(R)))}return I}var d=l(0),m=l(1),p=l(16777216);e=i.prototype,e.m=function(){if(x(this))return-w(this).m();for(var v=0,_=1,S=0;S<this.g.length;S++){var I=this.i(S);v+=(0<=I?I:4294967296+I)*_,_*=4294967296}return v},e.toString=function(v){if(v=v||10,2>v||36<v)throw Error("radix out of range: "+v);if(g(this))return"0";if(x(this))return"-"+w(this).toString(v);for(var _=c(Math.pow(v,6)),S=this,I="";;){var b=N(S,_).g;S=k(S,b.j(_));var P=((0<S.g.length?S.g[0]:S.h)>>>0).toString(v);if(S=b,g(S))return P+I;for(;6>P.length;)P="0"+P;I=P+I}},e.i=function(v){return 0>v?0:v<this.g.length?this.g[v]:this.h};function g(v){if(v.h!=0)return!1;for(var _=0;_<v.g.length;_++)if(v.g[_]!=0)return!1;return!0}function x(v){return v.h==-1}e.l=function(v){return v=k(this,v),x(v)?-1:g(v)?0:1};function w(v){for(var _=v.g.length,S=[],I=0;I<_;I++)S[I]=~v.g[I];return new i(S,~v.h).add(m)}e.abs=function(){return x(this)?w(this):this},e.add=function(v){for(var _=Math.max(this.g.length,v.g.length),S=[],I=0,b=0;b<=_;b++){var P=I+(this.i(b)&65535)+(v.i(b)&65535),R=(P>>>16)+(this.i(b)>>>16)+(v.i(b)>>>16);I=R>>>16,P&=65535,R&=65535,S[b]=R<<16|P}return new i(S,S[S.length-1]&-2147483648?-1:0)};function k(v,_){return v.add(w(_))}e.j=function(v){if(g(this)||g(v))return d;if(x(this))return x(v)?w(this).j(w(v)):w(w(this).j(v));if(x(v))return w(this.j(w(v)));if(0>this.l(p)&&0>v.l(p))return c(this.m()*v.m());for(var _=this.g.length+v.g.length,S=[],I=0;I<2*_;I++)S[I]=0;for(I=0;I<this.g.length;I++)for(var b=0;b<v.g.length;b++){var P=this.i(I)>>>16,R=this.i(I)&65535,ue=v.i(b)>>>16,le=v.i(b)&65535;S[2*I+2*b]+=R*le,T(S,2*I+2*b),S[2*I+2*b+1]+=P*le,T(S,2*I+2*b+1),S[2*I+2*b+1]+=R*ue,T(S,2*I+2*b+1),S[2*I+2*b+2]+=P*ue,T(S,2*I+2*b+2)}for(I=0;I<_;I++)S[I]=S[2*I+1]<<16|S[2*I];for(I=_;I<2*_;I++)S[I]=0;return new i(S,0)};function T(v,_){for(;(v[_]&65535)!=v[_];)v[_+1]+=v[_]>>>16,v[_]&=65535,_++}function E(v,_){this.g=v,this.h=_}function N(v,_){if(g(_))throw Error("division by zero");if(g(v))return new E(d,d);if(x(v))return _=N(w(v),_),new E(w(_.g),w(_.h));if(x(_))return _=N(v,w(_)),new E(w(_.g),_.h);if(30<v.g.length){if(x(v)||x(_))throw Error("slowDivide_ only works with positive integers.");for(var S=m,I=_;0>=I.l(v);)S=M(S),I=M(I);var b=O(S,1),P=O(I,1);for(I=O(I,2),S=O(S,2);!g(I);){var R=P.add(I);0>=R.l(v)&&(b=b.add(S),P=R),I=O(I,1),S=O(S,1)}return _=k(v,b.j(_)),new E(b,_)}for(b=d;0<=v.l(_);){for(S=Math.max(1,Math.floor(v.m()/_.m())),I=Math.ceil(Math.log(S)/Math.LN2),I=48>=I?1:Math.pow(2,I-48),P=c(S),R=P.j(_);x(R)||0<R.l(v);)S-=I,P=c(S),R=P.j(_);g(P)&&(P=m),b=b.add(P),v=k(v,R)}return new E(b,v)}e.A=function(v){return N(this,v).h},e.and=function(v){for(var _=Math.max(this.g.length,v.g.length),S=[],I=0;I<_;I++)S[I]=this.i(I)&v.i(I);return new i(S,this.h&v.h)},e.or=function(v){for(var _=Math.max(this.g.length,v.g.length),S=[],I=0;I<_;I++)S[I]=this.i(I)|v.i(I);return new i(S,this.h|v.h)},e.xor=function(v){for(var _=Math.max(this.g.length,v.g.length),S=[],I=0;I<_;I++)S[I]=this.i(I)^v.i(I);return new i(S,this.h^v.h)};function M(v){for(var _=v.g.length+1,S=[],I=0;I<_;I++)S[I]=v.i(I)<<1|v.i(I-1)>>>31;return new i(S,v.h)}function O(v,_){var S=_>>5;_%=32;for(var I=v.g.length-S,b=[],P=0;P<I;P++)b[P]=0<_?v.i(P+S)>>>_|v.i(P+S+1)<<32-_:v.i(P+S);return new i(b,v.h)}n.prototype.digest=n.prototype.v,n.prototype.reset=n.prototype.s,n.prototype.update=n.prototype.u,_k=n,i.prototype.add=i.prototype.add,i.prototype.multiply=i.prototype.j,i.prototype.modulo=i.prototype.A,i.prototype.compare=i.prototype.l,i.prototype.toNumber=i.prototype.m,i.prototype.toString=i.prototype.toString,i.prototype.getBits=i.prototype.i,i.fromNumber=c,i.fromString=u,Li=i}).apply(typeof Xy<"u"?Xy:typeof self<"u"?self:typeof window<"u"?window:{});var Tf=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var wk,tc,Ek,eh,mp,Tk,kk,Sk;(function(){var e,t=typeof Object.defineProperties=="function"?Object.defineProperty:function(f,y,A){return f==Array.prototype||f==Object.prototype||(f[y]=A.value),f};function r(f){f=[typeof globalThis=="object"&&globalThis,f,typeof window=="object"&&window,typeof self=="object"&&self,typeof Tf=="object"&&Tf];for(var y=0;y<f.length;++y){var A=f[y];if(A&&A.Math==Math)return A}throw Error("Cannot find global object")}var n=r(this);function s(f,y){if(y)e:{var A=n;f=f.split(".");for(var U=0;U<f.length-1;U++){var ne=f[U];if(!(ne in A))break e;A=A[ne]}f=f[f.length-1],U=A[f],y=y(U),y!=U&&y!=null&&t(A,f,{configurable:!0,writable:!0,value:y})}}function a(f,y){f instanceof String&&(f+="");var A=0,U=!1,ne={next:function(){if(!U&&A<f.length){var oe=A++;return{value:y(oe,f[oe]),done:!1}}return U=!0,{done:!0,value:void 0}}};return ne[Symbol.iterator]=function(){return ne},ne}s("Array.prototype.values",function(f){return f||function(){return a(this,function(y,A){return A})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var i=i||{},o=this||self;function l(f){var y=typeof f;return y=y!="object"?y:f?Array.isArray(f)?"array":y:"null",y=="array"||y=="object"&&typeof f.length=="number"}function c(f){var y=typeof f;return y=="object"&&f!=null||y=="function"}function u(f,y,A){return f.call.apply(f.bind,arguments)}function d(f,y,A){if(!f)throw Error();if(2<arguments.length){var U=Array.prototype.slice.call(arguments,2);return function(){var ne=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(ne,U),f.apply(y,ne)}}return function(){return f.apply(y,arguments)}}function m(f,y,A){return m=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?u:d,m.apply(null,arguments)}function p(f,y){var A=Array.prototype.slice.call(arguments,1);return function(){var U=A.slice();return U.push.apply(U,arguments),f.apply(this,U)}}function g(f,y){function A(){}A.prototype=y.prototype,f.aa=y.prototype,f.prototype=new A,f.prototype.constructor=f,f.Qb=function(U,ne,oe){for(var ke=Array(arguments.length-2),_t=2;_t<arguments.length;_t++)ke[_t-2]=arguments[_t];return y.prototype[ne].apply(U,ke)}}function x(f){const y=f.length;if(0<y){const A=Array(y);for(let U=0;U<y;U++)A[U]=f[U];return A}return[]}function w(f,y){for(let A=1;A<arguments.length;A++){const U=arguments[A];if(l(U)){const ne=f.length||0,oe=U.length||0;f.length=ne+oe;for(let ke=0;ke<oe;ke++)f[ne+ke]=U[ke]}else f.push(U)}}class k{constructor(y,A){this.i=y,this.j=A,this.h=0,this.g=null}get(){let y;return 0<this.h?(this.h--,y=this.g,this.g=y.next,y.next=null):y=this.i(),y}}function T(f){return/^[\s\xa0]*$/.test(f)}function E(){var f=o.navigator;return f&&(f=f.userAgent)?f:""}function N(f){return N[" "](f),f}N[" "]=function(){};var M=E().indexOf("Gecko")!=-1&&!(E().toLowerCase().indexOf("webkit")!=-1&&E().indexOf("Edge")==-1)&&!(E().indexOf("Trident")!=-1||E().indexOf("MSIE")!=-1)&&E().indexOf("Edge")==-1;function O(f,y,A){for(const U in f)y.call(A,f[U],U,f)}function v(f,y){for(const A in f)y.call(void 0,f[A],A,f)}function _(f){const y={};for(const A in f)y[A]=f[A];return y}const S="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function I(f,y){let A,U;for(let ne=1;ne<arguments.length;ne++){U=arguments[ne];for(A in U)f[A]=U[A];for(let oe=0;oe<S.length;oe++)A=S[oe],Object.prototype.hasOwnProperty.call(U,A)&&(f[A]=U[A])}}function b(f){var y=1;f=f.split(":");const A=[];for(;0<y&&f.length;)A.push(f.shift()),y--;return f.length&&A.push(f.join(":")),A}function P(f){o.setTimeout(()=>{throw f},0)}function R(){var f=H;let y=null;return f.g&&(y=f.g,f.g=f.g.next,f.g||(f.h=null),y.next=null),y}class ue{constructor(){this.h=this.g=null}add(y,A){const U=le.get();U.set(y,A),this.h?this.h.next=U:this.g=U,this.h=U}}var le=new k(()=>new he,f=>f.reset());class he{constructor(){this.next=this.g=this.h=null}set(y,A){this.h=y,this.g=A,this.next=null}reset(){this.next=this.g=this.h=null}}let pe,ee=!1,H=new ue,se=()=>{const f=o.Promise.resolve(void 0);pe=()=>{f.then(ce)}};var ce=()=>{for(var f;f=R();){try{f.h.call(f.g)}catch(A){P(A)}var y=le;y.j(f),100>y.h&&(y.h++,f.next=y.g,y.g=f)}ee=!1};function B(){this.s=this.s,this.C=this.C}B.prototype.s=!1,B.prototype.ma=function(){this.s||(this.s=!0,this.N())},B.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function K(f,y){this.type=f,this.g=this.target=y,this.defaultPrevented=!1}K.prototype.h=function(){this.defaultPrevented=!0};var X=function(){if(!o.addEventListener||!Object.defineProperty)return!1;var f=!1,y=Object.defineProperty({},"passive",{get:function(){f=!0}});try{const A=()=>{};o.addEventListener("test",A,y),o.removeEventListener("test",A,y)}catch{}return f}();function G(f,y){if(K.call(this,f?f.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,f){var A=this.type=f.type,U=f.changedTouches&&f.changedTouches.length?f.changedTouches[0]:null;if(this.target=f.target||f.srcElement,this.g=y,y=f.relatedTarget){if(M){e:{try{N(y.nodeName);var ne=!0;break e}catch{}ne=!1}ne||(y=null)}}else A=="mouseover"?y=f.fromElement:A=="mouseout"&&(y=f.toElement);this.relatedTarget=y,U?(this.clientX=U.clientX!==void 0?U.clientX:U.pageX,this.clientY=U.clientY!==void 0?U.clientY:U.pageY,this.screenX=U.screenX||0,this.screenY=U.screenY||0):(this.clientX=f.clientX!==void 0?f.clientX:f.pageX,this.clientY=f.clientY!==void 0?f.clientY:f.pageY,this.screenX=f.screenX||0,this.screenY=f.screenY||0),this.button=f.button,this.key=f.key||"",this.ctrlKey=f.ctrlKey,this.altKey=f.altKey,this.shiftKey=f.shiftKey,this.metaKey=f.metaKey,this.pointerId=f.pointerId||0,this.pointerType=typeof f.pointerType=="string"?f.pointerType:ie[f.pointerType]||"",this.state=f.state,this.i=f,f.defaultPrevented&&G.aa.h.call(this)}}g(G,K);var ie={2:"touch",3:"pen",4:"mouse"};G.prototype.h=function(){G.aa.h.call(this);var f=this.i;f.preventDefault?f.preventDefault():f.returnValue=!1};var ge="closure_listenable_"+(1e6*Math.random()|0),Ie=0;function Te(f,y,A,U,ne){this.listener=f,this.proxy=null,this.src=y,this.type=A,this.capture=!!U,this.ha=ne,this.key=++Ie,this.da=this.fa=!1}function ye(f){f.da=!0,f.listener=null,f.proxy=null,f.src=null,f.ha=null}function $e(f){this.src=f,this.g={},this.h=0}$e.prototype.add=function(f,y,A,U,ne){var oe=f.toString();f=this.g[oe],f||(f=this.g[oe]=[],this.h++);var ke=lt(f,y,U,ne);return-1<ke?(y=f[ke],A||(y.fa=!1)):(y=new Te(y,this.src,oe,!!U,ne),y.fa=A,f.push(y)),y};function W(f,y){var A=y.type;if(A in f.g){var U=f.g[A],ne=Array.prototype.indexOf.call(U,y,void 0),oe;(oe=0<=ne)&&Array.prototype.splice.call(U,ne,1),oe&&(ye(y),f.g[A].length==0&&(delete f.g[A],f.h--))}}function lt(f,y,A,U){for(var ne=0;ne<f.length;++ne){var oe=f[ne];if(!oe.da&&oe.listener==y&&oe.capture==!!A&&oe.ha==U)return ne}return-1}var He="closure_lm_"+(1e6*Math.random()|0),st={};function Fe(f,y,A,U,ne){if(Array.isArray(y)){for(var oe=0;oe<y.length;oe++)Fe(f,y[oe],A,U,ne);return null}return A=cr(A),f&&f[ge]?f.K(y,A,c(U)?!!U.capture:!1,ne):Ae(f,y,A,!1,U,ne)}function Ae(f,y,A,U,ne,oe){if(!y)throw Error("Invalid event type");var ke=c(ne)?!!ne.capture:!!ne,_t=sn(f);if(_t||(f[He]=_t=new $e(f)),A=_t.add(y,A,U,ke,oe),A.proxy)return A;if(U=Tt(),A.proxy=U,U.src=f,U.listener=A,f.addEventListener)X||(ne=ke),ne===void 0&&(ne=!1),f.addEventListener(y.toString(),U,ne);else if(f.attachEvent)f.attachEvent(nn(y.toString()),U);else if(f.addListener&&f.removeListener)f.addListener(U);else throw Error("addEventListener and attachEvent are unavailable.");return A}function Tt(){function f(A){return y.call(f.src,f.listener,A)}const y=Ls;return f}function lr(f,y,A,U,ne){if(Array.isArray(y))for(var oe=0;oe<y.length;oe++)lr(f,y[oe],A,U,ne);else U=c(U)?!!U.capture:!!U,A=cr(A),f&&f[ge]?(f=f.i,y=String(y).toString(),y in f.g&&(oe=f.g[y],A=lt(oe,A,U,ne),-1<A&&(ye(oe[A]),Array.prototype.splice.call(oe,A,1),oe.length==0&&(delete f.g[y],f.h--)))):f&&(f=sn(f))&&(y=f.g[y.toString()],f=-1,y&&(f=lt(y,A,U,ne)),(A=-1<f?y[f]:null)&&Nr(A))}function Nr(f){if(typeof f!="number"&&f&&!f.da){var y=f.src;if(y&&y[ge])W(y.i,f);else{var A=f.type,U=f.proxy;y.removeEventListener?y.removeEventListener(A,U,f.capture):y.detachEvent?y.detachEvent(nn(A),U):y.addListener&&y.removeListener&&y.removeListener(U),(A=sn(y))?(W(A,f),A.h==0&&(A.src=null,y[He]=null)):ye(f)}}}function nn(f){return f in st?st[f]:st[f]="on"+f}function Ls(f,y){if(f.da)f=!0;else{y=new G(y,this);var A=f.listener,U=f.ha||f.src;f.fa&&Nr(f),f=A.call(U,y)}return f}function sn(f){return f=f[He],f instanceof $e?f:null}var kt="__closure_events_fn_"+(1e9*Math.random()>>>0);function cr(f){return typeof f=="function"?f:(f[kt]||(f[kt]=function(y){return f.handleEvent(y)}),f[kt])}function xt(){B.call(this),this.i=new $e(this),this.M=this,this.F=null}g(xt,B),xt.prototype[ge]=!0,xt.prototype.removeEventListener=function(f,y,A,U){lr(this,f,y,A,U)};function St(f,y){var A,U=f.F;if(U)for(A=[];U;U=U.F)A.push(U);if(f=f.M,U=y.type||y,typeof y=="string")y=new K(y,f);else if(y instanceof K)y.target=y.target||f;else{var ne=y;y=new K(U,f),I(y,ne)}if(ne=!0,A)for(var oe=A.length-1;0<=oe;oe--){var ke=y.g=A[oe];ne=dt(ke,U,!0,y)&&ne}if(ke=y.g=f,ne=dt(ke,U,!0,y)&&ne,ne=dt(ke,U,!1,y)&&ne,A)for(oe=0;oe<A.length;oe++)ke=y.g=A[oe],ne=dt(ke,U,!1,y)&&ne}xt.prototype.N=function(){if(xt.aa.N.call(this),this.i){var f=this.i,y;for(y in f.g){for(var A=f.g[y],U=0;U<A.length;U++)ye(A[U]);delete f.g[y],f.h--}}this.F=null},xt.prototype.K=function(f,y,A,U){return this.i.add(String(f),y,!1,A,U)},xt.prototype.L=function(f,y,A,U){return this.i.add(String(f),y,!0,A,U)};function dt(f,y,A,U){if(y=f.i.g[String(y)],!y)return!0;y=y.concat();for(var ne=!0,oe=0;oe<y.length;++oe){var ke=y[oe];if(ke&&!ke.da&&ke.capture==A){var _t=ke.listener,gr=ke.ha||ke.src;ke.fa&&W(f.i,ke),ne=_t.call(gr,U)!==!1&&ne}}return ne&&!U.defaultPrevented}function Dt(f,y,A){if(typeof f=="function")A&&(f=m(f,A));else if(f&&typeof f.handleEvent=="function")f=m(f.handleEvent,f);else throw Error("Invalid listener argument");return 2147483647<Number(y)?-1:o.setTimeout(f,y||0)}function je(f){f.g=Dt(()=>{f.g=null,f.i&&(f.i=!1,je(f))},f.l);const y=f.h;f.h=null,f.m.apply(null,y)}class yt extends B{constructor(y,A){super(),this.m=y,this.l=A,this.h=null,this.i=!1,this.g=null}j(y){this.h=arguments,this.g?this.i=!0:je(this)}N(){super.N(),this.g&&(o.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Gt(f){B.call(this),this.h=f,this.g={}}g(Gt,B);var ft=[];function gn(f){O(f.g,function(y,A){this.g.hasOwnProperty(A)&&Nr(y)},f),f.g={}}Gt.prototype.N=function(){Gt.aa.N.call(this),gn(this)},Gt.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var js=o.JSON.stringify,ho=o.JSON.parse,Nl=class{stringify(f){return o.JSON.stringify(f,void 0)}parse(f){return o.JSON.parse(f,void 0)}};function Vs(){}Vs.prototype.h=null;function hs(f){return f.h||(f.h=f.i())}function wa(){}var Gn={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function Us(){K.call(this,"d")}g(Us,K);function ds(){K.call(this,"c")}g(ds,K);var Rn={},mo=null;function Bs(){return mo=mo||new xt}Rn.La="serverreachability";function zs(f){K.call(this,Rn.La,f)}g(zs,K);function bn(f){const y=Bs();St(y,new zs(y))}Rn.STAT_EVENT="statevent";function po(f,y){K.call(this,Rn.STAT_EVENT,f),this.stat=y}g(po,K);function er(f){const y=Bs();St(y,new po(y,f))}Rn.Ma="timingevent";function q(f,y){K.call(this,Rn.Ma,f),this.size=y}g(q,K);function J(f,y){if(typeof f!="function")throw Error("Fn must not be null and must be a function");return o.setTimeout(function(){f()},y)}function ae(){this.g=!0}ae.prototype.xa=function(){this.g=!1};function me(f,y,A,U,ne,oe){f.info(function(){if(f.g)if(oe)for(var ke="",_t=oe.split("&"),gr=0;gr<_t.length;gr++){var ct=_t[gr].split("=");if(1<ct.length){var Rr=ct[0];ct=ct[1];var br=Rr.split("_");ke=2<=br.length&&br[1]=="type"?ke+(Rr+"="+ct+"&"):ke+(Rr+"=redacted&")}}else ke=null;else ke=oe;return"XMLHTTP REQ ("+U+") [attempt "+ne+"]: "+y+`
`+A+`
`+ke})}function Se(f,y,A,U,ne,oe,ke){f.info(function(){return"XMLHTTP RESP ("+U+") [ attempt "+ne+"]: "+y+`
`+A+`
`+oe+" "+ke})}function C(f,y,A,U){f.info(function(){return"XMLHTTP TEXT ("+y+"): "+D(f,A)+(U?" "+U:"")})}function V(f,y){f.info(function(){return"TIMEOUT: "+y})}ae.prototype.info=function(){};function D(f,y){if(!f.g)return y;if(!y)return null;try{var A=JSON.parse(y);if(A){for(f=0;f<A.length;f++)if(Array.isArray(A[f])){var U=A[f];if(!(2>U.length)){var ne=U[1];if(Array.isArray(ne)&&!(1>ne.length)){var oe=ne[0];if(oe!="noop"&&oe!="stop"&&oe!="close")for(var ke=1;ke<ne.length;ke++)ne[ke]=""}}}}return js(A)}catch{return y}}var F={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},L={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},j;function Y(){}g(Y,Vs),Y.prototype.g=function(){return new XMLHttpRequest},Y.prototype.i=function(){return{}},j=new Y;function re(f,y,A,U){this.j=f,this.i=y,this.l=A,this.R=U||1,this.U=new Gt(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new te}function te(){this.i=null,this.g="",this.h=!1}var Z={},Q={};function fe(f,y,A){f.L=1,f.v=qu($s(y)),f.m=A,f.P=!0,we(f,null)}function we(f,y){f.F=Date.now(),Ee(f),f.A=$s(f.v);var A=f.A,U=f.R;Array.isArray(U)||(U=[String(U)]),Sx(A.i,"t",U),f.C=0,A=f.j.J,f.h=new te,f.g=$x(f.j,A?y:null,!f.m),0<f.O&&(f.M=new yt(m(f.Y,f,f.g),f.O)),y=f.U,A=f.g,U=f.ca;var ne="readystatechange";Array.isArray(ne)||(ne&&(ft[0]=ne.toString()),ne=ft);for(var oe=0;oe<ne.length;oe++){var ke=Fe(A,ne[oe],U||y.handleEvent,!1,y.h||y);if(!ke)break;y.g[ke.key]=ke}y=f.H?_(f.H):{},f.m?(f.u||(f.u="POST"),y["Content-Type"]="application/x-www-form-urlencoded",f.g.ea(f.A,f.u,f.m,y)):(f.u="GET",f.g.ea(f.A,f.u,null,y)),bn(),me(f.i,f.u,f.A,f.l,f.R,f.m)}re.prototype.ca=function(f){f=f.target;const y=this.M;y&&Ws(f)==3?y.j():this.Y(f)},re.prototype.Y=function(f){try{if(f==this.g)e:{const br=Ws(this.g);var y=this.g.Ba();const xo=this.g.Z();if(!(3>br)&&(br!=3||this.g&&(this.h.h||this.g.oa()||Px(this.g)))){this.J||br!=4||y==7||(y==8||0>=xo?bn(3):bn(2)),at(this);var A=this.g.Z();this.X=A;t:if(Ce(this)){var U=Px(this.g);f="";var ne=U.length,oe=Ws(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){mt(this),Ke(this);var ke="";break t}this.h.i=new o.TextDecoder}for(y=0;y<ne;y++)this.h.h=!0,f+=this.h.i.decode(U[y],{stream:!(oe&&y==ne-1)});U.length=0,this.h.g+=f,this.C=0,ke=this.h.g}else ke=this.g.oa();if(this.o=A==200,Se(this.i,this.u,this.A,this.l,this.R,br,A),this.o){if(this.T&&!this.K){t:{if(this.g){var _t,gr=this.g;if((_t=gr.g?gr.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!T(_t)){var ct=_t;break t}}ct=null}if(A=ct)C(this.i,this.l,A,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,an(this,A);else{this.o=!1,this.s=3,er(12),mt(this),Ke(this);break e}}if(this.P){A=!0;let Kn;for(;!this.J&&this.C<ke.length;)if(Kn=ve(this,ke),Kn==Q){br==4&&(this.s=4,er(14),A=!1),C(this.i,this.l,null,"[Incomplete Response]");break}else if(Kn==Z){this.s=4,er(15),C(this.i,this.l,ke,"[Invalid Chunk]"),A=!1;break}else C(this.i,this.l,Kn,null),an(this,Kn);if(Ce(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),br!=4||ke.length!=0||this.h.h||(this.s=1,er(16),A=!1),this.o=this.o&&A,!A)C(this.i,this.l,ke,"[Invalid Chunked Response]"),mt(this),Ke(this);else if(0<ke.length&&!this.W){this.W=!0;var Rr=this.j;Rr.g==this&&Rr.ba&&!Rr.M&&(Rr.j.info("Great, no buffering proxy detected. Bytes received: "+ke.length),u0(Rr),Rr.M=!0,er(11))}}else C(this.i,this.l,ke,null),an(this,ke);br==4&&mt(this),this.o&&!this.J&&(br==4?Vx(this.j,this):(this.o=!1,Ee(this)))}else XI(this.g),A==400&&0<ke.indexOf("Unknown SID")?(this.s=3,er(12)):(this.s=0,er(13)),mt(this),Ke(this)}}}catch{}finally{}};function Ce(f){return f.g?f.u=="GET"&&f.L!=2&&f.j.Ca:!1}function ve(f,y){var A=f.C,U=y.indexOf(`
`,A);return U==-1?Q:(A=Number(y.substring(A,U)),isNaN(A)?Z:(U+=1,U+A>y.length?Q:(y=y.slice(U,U+A),f.C=U+A,y)))}re.prototype.cancel=function(){this.J=!0,mt(this)};function Ee(f){f.S=Date.now()+f.I,De(f,f.I)}function De(f,y){if(f.B!=null)throw Error("WatchDog timer not null");f.B=J(m(f.ba,f),y)}function at(f){f.B&&(o.clearTimeout(f.B),f.B=null)}re.prototype.ba=function(){this.B=null;const f=Date.now();0<=f-this.S?(V(this.i,this.A),this.L!=2&&(bn(),er(17)),mt(this),this.s=2,Ke(this)):De(this,this.S-f)};function Ke(f){f.j.G==0||f.J||Vx(f.j,f)}function mt(f){at(f);var y=f.M;y&&typeof y.ma=="function"&&y.ma(),f.M=null,gn(f.U),f.g&&(y=f.g,f.g=null,y.abort(),y.ma())}function an(f,y){try{var A=f.j;if(A.G!=0&&(A.g==f||Ze(A.h,f))){if(!f.K&&Ze(A.h,f)&&A.G==3){try{var U=A.Da.g.parse(y)}catch{U=null}if(Array.isArray(U)&&U.length==3){var ne=U;if(ne[0]==0){e:if(!A.u){if(A.g)if(A.g.F+3e3<f.F)ef(A),Ju(A);else break e;c0(A),er(18)}}else A.za=ne[1],0<A.za-A.T&&37500>ne[2]&&A.F&&A.v==0&&!A.C&&(A.C=J(m(A.Za,A),6e3));if(1>=Pn(A.h)&&A.ca){try{A.ca()}catch{}A.ca=void 0}}else _i(A,11)}else if((f.K||A.g==f)&&ef(A),!T(y))for(ne=A.Da.g.parse(y),y=0;y<ne.length;y++){let ct=ne[y];if(A.T=ct[0],ct=ct[1],A.G==2)if(ct[0]=="c"){A.K=ct[1],A.ia=ct[2];const Rr=ct[3];Rr!=null&&(A.la=Rr,A.j.info("VER="+A.la));const br=ct[4];br!=null&&(A.Aa=br,A.j.info("SVER="+A.Aa));const xo=ct[5];xo!=null&&typeof xo=="number"&&0<xo&&(U=1.5*xo,A.L=U,A.j.info("backChannelRequestTimeoutMs_="+U)),U=A;const Kn=f.g;if(Kn){const rf=Kn.g?Kn.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(rf){var oe=U.h;oe.g||rf.indexOf("spdy")==-1&&rf.indexOf("quic")==-1&&rf.indexOf("h2")==-1||(oe.j=oe.l,oe.g=new Set,oe.h&&(ms(oe,oe.h),oe.h=null))}if(U.D){const f0=Kn.g?Kn.g.getResponseHeader("X-HTTP-Session-Id"):null;f0&&(U.ya=f0,At(U.I,U.D,f0))}}A.G=3,A.l&&A.l.ua(),A.ba&&(A.R=Date.now()-f.F,A.j.info("Handshake RTT: "+A.R+"ms")),U=A;var ke=f;if(U.qa=zx(U,U.J?U.ia:null,U.W),ke.K){Rl(U.h,ke);var _t=ke,gr=U.L;gr&&(_t.I=gr),_t.B&&(at(_t),Ee(_t)),U.g=ke}else Lx(U);0<A.i.length&&Zu(A)}else ct[0]!="stop"&&ct[0]!="close"||_i(A,7);else A.G==3&&(ct[0]=="stop"||ct[0]=="close"?ct[0]=="stop"?_i(A,7):l0(A):ct[0]!="noop"&&A.l&&A.l.ta(ct),A.v=0)}}bn(4)}catch{}}var We=class{constructor(f,y){this.g=f,this.map=y}};function ht(f){this.l=f||10,o.PerformanceNavigationTiming?(f=o.performance.getEntriesByType("navigation"),f=0<f.length&&(f[0].nextHopProtocol=="hq"||f[0].nextHopProtocol=="h2")):f=!!(o.chrome&&o.chrome.loadTimes&&o.chrome.loadTimes()&&o.chrome.loadTimes().wasFetchedViaSpdy),this.j=f?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function pr(f){return f.h?!0:f.g?f.g.size>=f.j:!1}function Pn(f){return f.h?1:f.g?f.g.size:0}function Ze(f,y){return f.h?f.h==y:f.g?f.g.has(y):!1}function ms(f,y){f.g?f.g.add(y):f.h=y}function Rl(f,y){f.h&&f.h==y?f.h=null:f.g&&f.g.has(y)&&f.g.delete(y)}ht.prototype.cancel=function(){if(this.i=Hu(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const f of this.g.values())f.cancel();this.g.clear()}};function Hu(f){if(f.h!=null)return f.i.concat(f.h.D);if(f.g!=null&&f.g.size!==0){let y=f.i;for(const A of f.g.values())y=y.concat(A.D);return y}return x(f.i)}function FI(f){if(f.V&&typeof f.V=="function")return f.V();if(typeof Map<"u"&&f instanceof Map||typeof Set<"u"&&f instanceof Set)return Array.from(f.values());if(typeof f=="string")return f.split("");if(l(f)){for(var y=[],A=f.length,U=0;U<A;U++)y.push(f[U]);return y}y=[],A=0;for(U in f)y[A++]=f[U];return y}function OI(f){if(f.na&&typeof f.na=="function")return f.na();if(!f.V||typeof f.V!="function"){if(typeof Map<"u"&&f instanceof Map)return Array.from(f.keys());if(!(typeof Set<"u"&&f instanceof Set)){if(l(f)||typeof f=="string"){var y=[];f=f.length;for(var A=0;A<f;A++)y.push(A);return y}y=[],A=0;for(const U in f)y[A++]=U;return y}}}function yx(f,y){if(f.forEach&&typeof f.forEach=="function")f.forEach(y,void 0);else if(l(f)||typeof f=="string")Array.prototype.forEach.call(f,y,void 0);else for(var A=OI(f),U=FI(f),ne=U.length,oe=0;oe<ne;oe++)y.call(void 0,U[oe],A&&A[oe],f)}var _x=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function MI(f,y){if(f){f=f.split("&");for(var A=0;A<f.length;A++){var U=f[A].indexOf("="),ne=null;if(0<=U){var oe=f[A].substring(0,U);ne=f[A].substring(U+1)}else oe=f[A];y(oe,ne?decodeURIComponent(ne.replace(/\+/g," ")):"")}}}function yi(f){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,f instanceof yi){this.h=f.h,Gu(this,f.j),this.o=f.o,this.g=f.g,Ku(this,f.s),this.l=f.l;var y=f.i,A=new Dl;A.i=y.i,y.g&&(A.g=new Map(y.g),A.h=y.h),wx(this,A),this.m=f.m}else f&&(y=String(f).match(_x))?(this.h=!1,Gu(this,y[1]||"",!0),this.o=bl(y[2]||""),this.g=bl(y[3]||"",!0),Ku(this,y[4]),this.l=bl(y[5]||"",!0),wx(this,y[6]||"",!0),this.m=bl(y[7]||"")):(this.h=!1,this.i=new Dl(null,this.h))}yi.prototype.toString=function(){var f=[],y=this.j;y&&f.push(Pl(y,Ex,!0),":");var A=this.g;return(A||y=="file")&&(f.push("//"),(y=this.o)&&f.push(Pl(y,Ex,!0),"@"),f.push(encodeURIComponent(String(A)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),A=this.s,A!=null&&f.push(":",String(A))),(A=this.l)&&(this.g&&A.charAt(0)!="/"&&f.push("/"),f.push(Pl(A,A.charAt(0)=="/"?VI:jI,!0))),(A=this.i.toString())&&f.push("?",A),(A=this.m)&&f.push("#",Pl(A,BI)),f.join("")};function $s(f){return new yi(f)}function Gu(f,y,A){f.j=A?bl(y,!0):y,f.j&&(f.j=f.j.replace(/:$/,""))}function Ku(f,y){if(y){if(y=Number(y),isNaN(y)||0>y)throw Error("Bad port number "+y);f.s=y}else f.s=null}function wx(f,y,A){y instanceof Dl?(f.i=y,zI(f.i,f.h)):(A||(y=Pl(y,UI)),f.i=new Dl(y,f.h))}function At(f,y,A){f.i.set(y,A)}function qu(f){return At(f,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),f}function bl(f,y){return f?y?decodeURI(f.replace(/%25/g,"%2525")):decodeURIComponent(f):""}function Pl(f,y,A){return typeof f=="string"?(f=encodeURI(f).replace(y,LI),A&&(f=f.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),f):null}function LI(f){return f=f.charCodeAt(0),"%"+(f>>4&15).toString(16)+(f&15).toString(16)}var Ex=/[#\/\?@]/g,jI=/[#\?:]/g,VI=/[#\?]/g,UI=/[#\?@]/g,BI=/#/g;function Dl(f,y){this.h=this.g=null,this.i=f||null,this.j=!!y}function Ea(f){f.g||(f.g=new Map,f.h=0,f.i&&MI(f.i,function(y,A){f.add(decodeURIComponent(y.replace(/\+/g," ")),A)}))}e=Dl.prototype,e.add=function(f,y){Ea(this),this.i=null,f=go(this,f);var A=this.g.get(f);return A||this.g.set(f,A=[]),A.push(y),this.h+=1,this};function Tx(f,y){Ea(f),y=go(f,y),f.g.has(y)&&(f.i=null,f.h-=f.g.get(y).length,f.g.delete(y))}function kx(f,y){return Ea(f),y=go(f,y),f.g.has(y)}e.forEach=function(f,y){Ea(this),this.g.forEach(function(A,U){A.forEach(function(ne){f.call(y,ne,U,this)},this)},this)},e.na=function(){Ea(this);const f=Array.from(this.g.values()),y=Array.from(this.g.keys()),A=[];for(let U=0;U<y.length;U++){const ne=f[U];for(let oe=0;oe<ne.length;oe++)A.push(y[U])}return A},e.V=function(f){Ea(this);let y=[];if(typeof f=="string")kx(this,f)&&(y=y.concat(this.g.get(go(this,f))));else{f=Array.from(this.g.values());for(let A=0;A<f.length;A++)y=y.concat(f[A])}return y},e.set=function(f,y){return Ea(this),this.i=null,f=go(this,f),kx(this,f)&&(this.h-=this.g.get(f).length),this.g.set(f,[y]),this.h+=1,this},e.get=function(f,y){return f?(f=this.V(f),0<f.length?String(f[0]):y):y};function Sx(f,y,A){Tx(f,y),0<A.length&&(f.i=null,f.g.set(go(f,y),x(A)),f.h+=A.length)}e.toString=function(){if(this.i)return this.i;if(!this.g)return"";const f=[],y=Array.from(this.g.keys());for(var A=0;A<y.length;A++){var U=y[A];const oe=encodeURIComponent(String(U)),ke=this.V(U);for(U=0;U<ke.length;U++){var ne=oe;ke[U]!==""&&(ne+="="+encodeURIComponent(String(ke[U]))),f.push(ne)}}return this.i=f.join("&")};function go(f,y){return y=String(y),f.j&&(y=y.toLowerCase()),y}function zI(f,y){y&&!f.j&&(Ea(f),f.i=null,f.g.forEach(function(A,U){var ne=U.toLowerCase();U!=ne&&(Tx(this,U),Sx(this,ne,A))},f)),f.j=y}function $I(f,y){const A=new ae;if(o.Image){const U=new Image;U.onload=p(Ta,A,"TestLoadImage: loaded",!0,y,U),U.onerror=p(Ta,A,"TestLoadImage: error",!1,y,U),U.onabort=p(Ta,A,"TestLoadImage: abort",!1,y,U),U.ontimeout=p(Ta,A,"TestLoadImage: timeout",!1,y,U),o.setTimeout(function(){U.ontimeout&&U.ontimeout()},1e4),U.src=f}else y(!1)}function WI(f,y){const A=new ae,U=new AbortController,ne=setTimeout(()=>{U.abort(),Ta(A,"TestPingServer: timeout",!1,y)},1e4);fetch(f,{signal:U.signal}).then(oe=>{clearTimeout(ne),oe.ok?Ta(A,"TestPingServer: ok",!0,y):Ta(A,"TestPingServer: server error",!1,y)}).catch(()=>{clearTimeout(ne),Ta(A,"TestPingServer: error",!1,y)})}function Ta(f,y,A,U,ne){try{ne&&(ne.onload=null,ne.onerror=null,ne.onabort=null,ne.ontimeout=null),U(A)}catch{}}function HI(){this.g=new Nl}function GI(f,y,A){const U=A||"";try{yx(f,function(ne,oe){let ke=ne;c(ne)&&(ke=js(ne)),y.push(U+oe+"="+encodeURIComponent(ke))})}catch(ne){throw y.push(U+"type="+encodeURIComponent("_badmap")),ne}}function Xu(f){this.l=f.Ub||null,this.j=f.eb||!1}g(Xu,Vs),Xu.prototype.g=function(){return new Yu(this.l,this.j)},Xu.prototype.i=function(f){return function(){return f}}({});function Yu(f,y){xt.call(this),this.D=f,this.o=y,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}g(Yu,xt),e=Yu.prototype,e.open=function(f,y){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=f,this.A=y,this.readyState=1,Ol(this)},e.send=function(f){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const y={headers:this.u,method:this.B,credentials:this.m,cache:void 0};f&&(y.body=f),(this.D||o).fetch(new Request(this.A,y)).then(this.Sa.bind(this),this.ga.bind(this))},e.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,Fl(this)),this.readyState=0},e.Sa=function(f){if(this.g&&(this.l=f,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=f.headers,this.readyState=2,Ol(this)),this.g&&(this.readyState=3,Ol(this),this.g)))if(this.responseType==="arraybuffer")f.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof o.ReadableStream<"u"&&"body"in f){if(this.j=f.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;Ax(this)}else f.text().then(this.Ra.bind(this),this.ga.bind(this))};function Ax(f){f.j.read().then(f.Pa.bind(f)).catch(f.ga.bind(f))}e.Pa=function(f){if(this.g){if(this.o&&f.value)this.response.push(f.value);else if(!this.o){var y=f.value?f.value:new Uint8Array(0);(y=this.v.decode(y,{stream:!f.done}))&&(this.response=this.responseText+=y)}f.done?Fl(this):Ol(this),this.readyState==3&&Ax(this)}},e.Ra=function(f){this.g&&(this.response=this.responseText=f,Fl(this))},e.Qa=function(f){this.g&&(this.response=f,Fl(this))},e.ga=function(){this.g&&Fl(this)};function Fl(f){f.readyState=4,f.l=null,f.j=null,f.v=null,Ol(f)}e.setRequestHeader=function(f,y){this.u.append(f,y)},e.getResponseHeader=function(f){return this.h&&this.h.get(f.toLowerCase())||""},e.getAllResponseHeaders=function(){if(!this.h)return"";const f=[],y=this.h.entries();for(var A=y.next();!A.done;)A=A.value,f.push(A[0]+": "+A[1]),A=y.next();return f.join(`\r
`)};function Ol(f){f.onreadystatechange&&f.onreadystatechange.call(f)}Object.defineProperty(Yu.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(f){this.m=f?"include":"same-origin"}});function Ix(f){let y="";return O(f,function(A,U){y+=U,y+=":",y+=A,y+=`\r
`}),y}function o0(f,y,A){e:{for(U in A){var U=!1;break e}U=!0}U||(A=Ix(A),typeof f=="string"?A!=null&&encodeURIComponent(String(A)):At(f,y,A))}function jt(f){xt.call(this),this.headers=new Map,this.o=f||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}g(jt,xt);var KI=/^https?$/i,qI=["POST","PUT"];e=jt.prototype,e.Ha=function(f){this.J=f},e.ea=function(f,y,A,U){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+f);y=y?y.toUpperCase():"GET",this.D=f,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():j.g(),this.v=this.o?hs(this.o):hs(j),this.g.onreadystatechange=m(this.Ea,this);try{this.B=!0,this.g.open(y,String(f),!0),this.B=!1}catch(oe){Cx(this,oe);return}if(f=A||"",A=new Map(this.headers),U)if(Object.getPrototypeOf(U)===Object.prototype)for(var ne in U)A.set(ne,U[ne]);else if(typeof U.keys=="function"&&typeof U.get=="function")for(const oe of U.keys())A.set(oe,U.get(oe));else throw Error("Unknown input type for opt_headers: "+String(U));U=Array.from(A.keys()).find(oe=>oe.toLowerCase()=="content-type"),ne=o.FormData&&f instanceof o.FormData,!(0<=Array.prototype.indexOf.call(qI,y,void 0))||U||ne||A.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[oe,ke]of A)this.g.setRequestHeader(oe,ke);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{bx(this),this.u=!0,this.g.send(f),this.u=!1}catch(oe){Cx(this,oe)}};function Cx(f,y){f.h=!1,f.g&&(f.j=!0,f.g.abort(),f.j=!1),f.l=y,f.m=5,Nx(f),Qu(f)}function Nx(f){f.A||(f.A=!0,St(f,"complete"),St(f,"error"))}e.abort=function(f){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=f||7,St(this,"complete"),St(this,"abort"),Qu(this))},e.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Qu(this,!0)),jt.aa.N.call(this)},e.Ea=function(){this.s||(this.B||this.u||this.j?Rx(this):this.bb())},e.bb=function(){Rx(this)};function Rx(f){if(f.h&&typeof i<"u"&&(!f.v[1]||Ws(f)!=4||f.Z()!=2)){if(f.u&&Ws(f)==4)Dt(f.Ea,0,f);else if(St(f,"readystatechange"),Ws(f)==4){f.h=!1;try{const ke=f.Z();e:switch(ke){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var y=!0;break e;default:y=!1}var A;if(!(A=y)){var U;if(U=ke===0){var ne=String(f.D).match(_x)[1]||null;!ne&&o.self&&o.self.location&&(ne=o.self.location.protocol.slice(0,-1)),U=!KI.test(ne?ne.toLowerCase():"")}A=U}if(A)St(f,"complete"),St(f,"success");else{f.m=6;try{var oe=2<Ws(f)?f.g.statusText:""}catch{oe=""}f.l=oe+" ["+f.Z()+"]",Nx(f)}}finally{Qu(f)}}}}function Qu(f,y){if(f.g){bx(f);const A=f.g,U=f.v[0]?()=>{}:null;f.g=null,f.v=null,y||St(f,"ready");try{A.onreadystatechange=U}catch{}}}function bx(f){f.I&&(o.clearTimeout(f.I),f.I=null)}e.isActive=function(){return!!this.g};function Ws(f){return f.g?f.g.readyState:0}e.Z=function(){try{return 2<Ws(this)?this.g.status:-1}catch{return-1}},e.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},e.Oa=function(f){if(this.g){var y=this.g.responseText;return f&&y.indexOf(f)==0&&(y=y.substring(f.length)),ho(y)}};function Px(f){try{if(!f.g)return null;if("response"in f.g)return f.g.response;switch(f.H){case"":case"text":return f.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in f.g)return f.g.mozResponseArrayBuffer}return null}catch{return null}}function XI(f){const y={};f=(f.g&&2<=Ws(f)&&f.g.getAllResponseHeaders()||"").split(`\r
`);for(let U=0;U<f.length;U++){if(T(f[U]))continue;var A=b(f[U]);const ne=A[0];if(A=A[1],typeof A!="string")continue;A=A.trim();const oe=y[ne]||[];y[ne]=oe,oe.push(A)}v(y,function(U){return U.join(", ")})}e.Ba=function(){return this.m},e.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function Ml(f,y,A){return A&&A.internalChannelParams&&A.internalChannelParams[f]||y}function Dx(f){this.Aa=0,this.i=[],this.j=new ae,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=Ml("failFast",!1,f),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=Ml("baseRetryDelayMs",5e3,f),this.cb=Ml("retryDelaySeedMs",1e4,f),this.Wa=Ml("forwardChannelMaxRetries",2,f),this.wa=Ml("forwardChannelRequestTimeoutMs",2e4,f),this.pa=f&&f.xmlHttpFactory||void 0,this.Xa=f&&f.Tb||void 0,this.Ca=f&&f.useFetchStreams||!1,this.L=void 0,this.J=f&&f.supportsCrossDomainXhr||!1,this.K="",this.h=new ht(f&&f.concurrentRequestLimit),this.Da=new HI,this.P=f&&f.fastHandshake||!1,this.O=f&&f.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=f&&f.Rb||!1,f&&f.xa&&this.j.xa(),f&&f.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&f&&f.detectBufferingProxy||!1,this.ja=void 0,f&&f.longPollingTimeout&&0<f.longPollingTimeout&&(this.ja=f.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}e=Dx.prototype,e.la=8,e.G=1,e.connect=function(f,y,A,U){er(0),this.W=f,this.H=y||{},A&&U!==void 0&&(this.H.OSID=A,this.H.OAID=U),this.F=this.X,this.I=zx(this,null,this.W),Zu(this)};function l0(f){if(Fx(f),f.G==3){var y=f.U++,A=$s(f.I);if(At(A,"SID",f.K),At(A,"RID",y),At(A,"TYPE","terminate"),Ll(f,A),y=new re(f,f.j,y),y.L=2,y.v=qu($s(A)),A=!1,o.navigator&&o.navigator.sendBeacon)try{A=o.navigator.sendBeacon(y.v.toString(),"")}catch{}!A&&o.Image&&(new Image().src=y.v,A=!0),A||(y.g=$x(y.j,null),y.g.ea(y.v)),y.F=Date.now(),Ee(y)}Bx(f)}function Ju(f){f.g&&(u0(f),f.g.cancel(),f.g=null)}function Fx(f){Ju(f),f.u&&(o.clearTimeout(f.u),f.u=null),ef(f),f.h.cancel(),f.s&&(typeof f.s=="number"&&o.clearTimeout(f.s),f.s=null)}function Zu(f){if(!pr(f.h)&&!f.s){f.s=!0;var y=f.Ga;pe||se(),ee||(pe(),ee=!0),H.add(y,f),f.B=0}}function YI(f,y){return Pn(f.h)>=f.h.j-(f.s?1:0)?!1:f.s?(f.i=y.D.concat(f.i),!0):f.G==1||f.G==2||f.B>=(f.Va?0:f.Wa)?!1:(f.s=J(m(f.Ga,f,y),Ux(f,f.B)),f.B++,!0)}e.Ga=function(f){if(this.s)if(this.s=null,this.G==1){if(!f){this.U=Math.floor(1e5*Math.random()),f=this.U++;const ne=new re(this,this.j,f);let oe=this.o;if(this.S&&(oe?(oe=_(oe),I(oe,this.S)):oe=this.S),this.m!==null||this.O||(ne.H=oe,oe=null),this.P)e:{for(var y=0,A=0;A<this.i.length;A++){t:{var U=this.i[A];if("__data__"in U.map&&(U=U.map.__data__,typeof U=="string")){U=U.length;break t}U=void 0}if(U===void 0)break;if(y+=U,4096<y){y=A;break e}if(y===4096||A===this.i.length-1){y=A+1;break e}}y=1e3}else y=1e3;y=Mx(this,ne,y),A=$s(this.I),At(A,"RID",f),At(A,"CVER",22),this.D&&At(A,"X-HTTP-Session-Id",this.D),Ll(this,A),oe&&(this.O?y="headers="+encodeURIComponent(String(Ix(oe)))+"&"+y:this.m&&o0(A,this.m,oe)),ms(this.h,ne),this.Ua&&At(A,"TYPE","init"),this.P?(At(A,"$req",y),At(A,"SID","null"),ne.T=!0,fe(ne,A,null)):fe(ne,A,y),this.G=2}}else this.G==3&&(f?Ox(this,f):this.i.length==0||pr(this.h)||Ox(this))};function Ox(f,y){var A;y?A=y.l:A=f.U++;const U=$s(f.I);At(U,"SID",f.K),At(U,"RID",A),At(U,"AID",f.T),Ll(f,U),f.m&&f.o&&o0(U,f.m,f.o),A=new re(f,f.j,A,f.B+1),f.m===null&&(A.H=f.o),y&&(f.i=y.D.concat(f.i)),y=Mx(f,A,1e3),A.I=Math.round(.5*f.wa)+Math.round(.5*f.wa*Math.random()),ms(f.h,A),fe(A,U,y)}function Ll(f,y){f.H&&O(f.H,function(A,U){At(y,U,A)}),f.l&&yx({},function(A,U){At(y,U,A)})}function Mx(f,y,A){A=Math.min(f.i.length,A);var U=f.l?m(f.l.Na,f.l,f):null;e:{var ne=f.i;let oe=-1;for(;;){const ke=["count="+A];oe==-1?0<A?(oe=ne[0].g,ke.push("ofs="+oe)):oe=0:ke.push("ofs="+oe);let _t=!0;for(let gr=0;gr<A;gr++){let ct=ne[gr].g;const Rr=ne[gr].map;if(ct-=oe,0>ct)oe=Math.max(0,ne[gr].g-100),_t=!1;else try{GI(Rr,ke,"req"+ct+"_")}catch{U&&U(Rr)}}if(_t){U=ke.join("&");break e}}}return f=f.i.splice(0,A),y.D=f,U}function Lx(f){if(!f.g&&!f.u){f.Y=1;var y=f.Fa;pe||se(),ee||(pe(),ee=!0),H.add(y,f),f.v=0}}function c0(f){return f.g||f.u||3<=f.v?!1:(f.Y++,f.u=J(m(f.Fa,f),Ux(f,f.v)),f.v++,!0)}e.Fa=function(){if(this.u=null,jx(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var f=2*this.R;this.j.info("BP detection timer enabled: "+f),this.A=J(m(this.ab,this),f)}},e.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,er(10),Ju(this),jx(this))};function u0(f){f.A!=null&&(o.clearTimeout(f.A),f.A=null)}function jx(f){f.g=new re(f,f.j,"rpc",f.Y),f.m===null&&(f.g.H=f.o),f.g.O=0;var y=$s(f.qa);At(y,"RID","rpc"),At(y,"SID",f.K),At(y,"AID",f.T),At(y,"CI",f.F?"0":"1"),!f.F&&f.ja&&At(y,"TO",f.ja),At(y,"TYPE","xmlhttp"),Ll(f,y),f.m&&f.o&&o0(y,f.m,f.o),f.L&&(f.g.I=f.L);var A=f.g;f=f.ia,A.L=1,A.v=qu($s(y)),A.m=null,A.P=!0,we(A,f)}e.Za=function(){this.C!=null&&(this.C=null,Ju(this),c0(this),er(19))};function ef(f){f.C!=null&&(o.clearTimeout(f.C),f.C=null)}function Vx(f,y){var A=null;if(f.g==y){ef(f),u0(f),f.g=null;var U=2}else if(Ze(f.h,y))A=y.D,Rl(f.h,y),U=1;else return;if(f.G!=0){if(y.o)if(U==1){A=y.m?y.m.length:0,y=Date.now()-y.F;var ne=f.B;U=Bs(),St(U,new q(U,A)),Zu(f)}else Lx(f);else if(ne=y.s,ne==3||ne==0&&0<y.X||!(U==1&&YI(f,y)||U==2&&c0(f)))switch(A&&0<A.length&&(y=f.h,y.i=y.i.concat(A)),ne){case 1:_i(f,5);break;case 4:_i(f,10);break;case 3:_i(f,6);break;default:_i(f,2)}}}function Ux(f,y){let A=f.Ta+Math.floor(Math.random()*f.cb);return f.isActive()||(A*=2),A*y}function _i(f,y){if(f.j.info("Error code "+y),y==2){var A=m(f.fb,f),U=f.Xa;const ne=!U;U=new yi(U||"//www.google.com/images/cleardot.gif"),o.location&&o.location.protocol=="http"||Gu(U,"https"),qu(U),ne?$I(U.toString(),A):WI(U.toString(),A)}else er(2);f.G=0,f.l&&f.l.sa(y),Bx(f),Fx(f)}e.fb=function(f){f?(this.j.info("Successfully pinged google.com"),er(2)):(this.j.info("Failed to ping google.com"),er(1))};function Bx(f){if(f.G=0,f.ka=[],f.l){const y=Hu(f.h);(y.length!=0||f.i.length!=0)&&(w(f.ka,y),w(f.ka,f.i),f.h.i.length=0,x(f.i),f.i.length=0),f.l.ra()}}function zx(f,y,A){var U=A instanceof yi?$s(A):new yi(A);if(U.g!="")y&&(U.g=y+"."+U.g),Ku(U,U.s);else{var ne=o.location;U=ne.protocol,y=y?y+"."+ne.hostname:ne.hostname,ne=+ne.port;var oe=new yi(null);U&&Gu(oe,U),y&&(oe.g=y),ne&&Ku(oe,ne),A&&(oe.l=A),U=oe}return A=f.D,y=f.ya,A&&y&&At(U,A,y),At(U,"VER",f.la),Ll(f,U),U}function $x(f,y,A){if(y&&!f.J)throw Error("Can't create secondary domain capable XhrIo object.");return y=f.Ca&&!f.pa?new jt(new Xu({eb:A})):new jt(f.pa),y.Ha(f.J),y}e.isActive=function(){return!!this.l&&this.l.isActive(this)};function Wx(){}e=Wx.prototype,e.ua=function(){},e.ta=function(){},e.sa=function(){},e.ra=function(){},e.isActive=function(){return!0},e.Na=function(){};function tf(){}tf.prototype.g=function(f,y){return new vn(f,y)};function vn(f,y){xt.call(this),this.g=new Dx(y),this.l=f,this.h=y&&y.messageUrlParams||null,f=y&&y.messageHeaders||null,y&&y.clientProtocolHeaderRequired&&(f?f["X-Client-Protocol"]="webchannel":f={"X-Client-Protocol":"webchannel"}),this.g.o=f,f=y&&y.initMessageHeaders||null,y&&y.messageContentType&&(f?f["X-WebChannel-Content-Type"]=y.messageContentType:f={"X-WebChannel-Content-Type":y.messageContentType}),y&&y.va&&(f?f["X-WebChannel-Client-Profile"]=y.va:f={"X-WebChannel-Client-Profile":y.va}),this.g.S=f,(f=y&&y.Sb)&&!T(f)&&(this.g.m=f),this.v=y&&y.supportsCrossDomainXhr||!1,this.u=y&&y.sendRawJson||!1,(y=y&&y.httpSessionIdParam)&&!T(y)&&(this.g.D=y,f=this.h,f!==null&&y in f&&(f=this.h,y in f&&delete f[y])),this.j=new vo(this)}g(vn,xt),vn.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},vn.prototype.close=function(){l0(this.g)},vn.prototype.o=function(f){var y=this.g;if(typeof f=="string"){var A={};A.__data__=f,f=A}else this.u&&(A={},A.__data__=js(f),f=A);y.i.push(new We(y.Ya++,f)),y.G==3&&Zu(y)},vn.prototype.N=function(){this.g.l=null,delete this.j,l0(this.g),delete this.g,vn.aa.N.call(this)};function Hx(f){Us.call(this),f.__headers__&&(this.headers=f.__headers__,this.statusCode=f.__status__,delete f.__headers__,delete f.__status__);var y=f.__sm__;if(y){e:{for(const A in y){f=A;break e}f=void 0}(this.i=f)&&(f=this.i,y=y!==null&&f in y?y[f]:void 0),this.data=y}else this.data=f}g(Hx,Us);function Gx(){ds.call(this),this.status=1}g(Gx,ds);function vo(f){this.g=f}g(vo,Wx),vo.prototype.ua=function(){St(this.g,"a")},vo.prototype.ta=function(f){St(this.g,new Hx(f))},vo.prototype.sa=function(f){St(this.g,new Gx)},vo.prototype.ra=function(){St(this.g,"b")},tf.prototype.createWebChannel=tf.prototype.g,vn.prototype.send=vn.prototype.o,vn.prototype.open=vn.prototype.m,vn.prototype.close=vn.prototype.close,Sk=function(){return new tf},kk=function(){return Bs()},Tk=Rn,mp={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},F.NO_ERROR=0,F.TIMEOUT=8,F.HTTP_ERROR=6,eh=F,L.COMPLETE="complete",Ek=L,wa.EventType=Gn,Gn.OPEN="a",Gn.CLOSE="b",Gn.ERROR="c",Gn.MESSAGE="d",xt.prototype.listen=xt.prototype.K,tc=wa,jt.prototype.listenOnce=jt.prototype.L,jt.prototype.getLastError=jt.prototype.Ka,jt.prototype.getLastErrorCode=jt.prototype.Ba,jt.prototype.getStatus=jt.prototype.Z,jt.prototype.getResponseJson=jt.prototype.Oa,jt.prototype.getResponseText=jt.prototype.oa,jt.prototype.send=jt.prototype.ea,jt.prototype.setWithCredentials=jt.prototype.Ha,wk=jt}).apply(typeof Tf<"u"?Tf:typeof self<"u"?self:typeof window<"u"?window:{});const Yy="@firebase/firestore";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mr{constructor(t){this.uid=t}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(t){return t.uid===this.uid}}Mr.UNAUTHENTICATED=new Mr(null),Mr.GOOGLE_CREDENTIALS=new Mr("google-credentials-uid"),Mr.FIRST_PARTY=new Mr("first-party-uid"),Mr.MOCK_USER=new Mr("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Tl="10.14.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ki=new Kg("@firebase/firestore");function Xl(){return Ki.logLevel}function be(e,...t){if(Ki.logLevel<=Ye.DEBUG){const r=t.map(iv);Ki.debug(`Firestore (${Tl}): ${e}`,...r)}}function da(e,...t){if(Ki.logLevel<=Ye.ERROR){const r=t.map(iv);Ki.error(`Firestore (${Tl}): ${e}`,...r)}}function cl(e,...t){if(Ki.logLevel<=Ye.WARN){const r=t.map(iv);Ki.warn(`Firestore (${Tl}): ${e}`,...r)}}function iv(e){if(typeof e=="string")return e;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(r){return JSON.stringify(r)}(e)}catch{return e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Le(e="Unexpected state"){const t=`FIRESTORE (${Tl}) INTERNAL ASSERTION FAILED: `+e;throw da(t),new Error(t)}function vt(e,t){e||Le()}function Be(e,t){return e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const de={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Re extends Ds{constructor(t,r){super(t,r),this.code=t,this.message=r,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ra{constructor(){this.promise=new Promise((t,r)=>{this.resolve=t,this.reject=r})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ak{constructor(t,r){this.user=r,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${t}`)}}class L3{getToken(){return Promise.resolve(null)}invalidateToken(){}start(t,r){t.enqueueRetryable(()=>r(Mr.UNAUTHENTICATED))}shutdown(){}}class j3{constructor(t){this.token=t,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(t,r){this.changeListener=r,t.enqueueRetryable(()=>r(this.token.user))}shutdown(){this.changeListener=null}}class V3{constructor(t){this.t=t,this.currentUser=Mr.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(t,r){vt(this.o===void 0);let n=this.i;const s=l=>this.i!==n?(n=this.i,r(l)):Promise.resolve();let a=new ra;this.o=()=>{this.i++,this.currentUser=this.u(),a.resolve(),a=new ra,t.enqueueRetryable(()=>s(this.currentUser))};const i=()=>{const l=a;t.enqueueRetryable(async()=>{await l.promise,await s(this.currentUser)})},o=l=>{be("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=l,this.o&&(this.auth.addAuthTokenListener(this.o),i())};this.t.onInit(l=>o(l)),setTimeout(()=>{if(!this.auth){const l=this.t.getImmediate({optional:!0});l?o(l):(be("FirebaseAuthCredentialsProvider","Auth not yet detected"),a.resolve(),a=new ra)}},0),i()}getToken(){const t=this.i,r=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(r).then(n=>this.i!==t?(be("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):n?(vt(typeof n.accessToken=="string"),new Ak(n.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const t=this.auth&&this.auth.getUid();return vt(t===null||typeof t=="string"),new Mr(t)}}class U3{constructor(t,r,n){this.l=t,this.h=r,this.P=n,this.type="FirstParty",this.user=Mr.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);const t=this.T();return t&&this.I.set("Authorization",t),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}}class B3{constructor(t,r,n){this.l=t,this.h=r,this.P=n}getToken(){return Promise.resolve(new U3(this.l,this.h,this.P))}start(t,r){t.enqueueRetryable(()=>r(Mr.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class z3{constructor(t){this.value=t,this.type="AppCheck",this.headers=new Map,t&&t.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class $3{constructor(t){this.A=t,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(t,r){vt(this.o===void 0);const n=a=>{a.error!=null&&be("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${a.error.message}`);const i=a.token!==this.R;return this.R=a.token,be("FirebaseAppCheckTokenProvider",`Received ${i?"new":"existing"} token.`),i?r(a.token):Promise.resolve()};this.o=a=>{t.enqueueRetryable(()=>n(a))};const s=a=>{be("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=a,this.o&&this.appCheck.addTokenListener(this.o)};this.A.onInit(a=>s(a)),setTimeout(()=>{if(!this.appCheck){const a=this.A.getImmediate({optional:!0});a?s(a):be("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const t=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(t).then(r=>r?(vt(typeof r.token=="string"),this.R=r.token,new z3(r.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function W3(e){const t=typeof self<"u"&&(self.crypto||self.msCrypto),r=new Uint8Array(e);if(t&&typeof t.getRandomValues=="function")t.getRandomValues(r);else for(let n=0;n<e;n++)r[n]=Math.floor(256*Math.random());return r}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ik{static newId(){const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",r=Math.floor(256/t.length)*t.length;let n="";for(;n.length<20;){const s=W3(40);for(let a=0;a<s.length;++a)n.length<20&&s[a]<r&&(n+=t.charAt(s[a]%t.length))}return n}}function ut(e,t){return e<t?-1:e>t?1:0}function ul(e,t,r){return e.length===t.length&&e.every((n,s)=>r(n,t[s]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ar{constructor(t,r){if(this.seconds=t,this.nanoseconds=r,r<0)throw new Re(de.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+r);if(r>=1e9)throw new Re(de.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+r);if(t<-62135596800)throw new Re(de.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(t>=253402300800)throw new Re(de.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}static now(){return ar.fromMillis(Date.now())}static fromDate(t){return ar.fromMillis(t.getTime())}static fromMillis(t){const r=Math.floor(t/1e3),n=Math.floor(1e6*(t-1e3*r));return new ar(r,n)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(t){return this.seconds===t.seconds?ut(this.nanoseconds,t.nanoseconds):ut(this.seconds,t.seconds)}isEqual(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const t=this.seconds- -62135596800;return String(t).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ve{constructor(t){this.timestamp=t}static fromTimestamp(t){return new Ve(t)}static min(){return new Ve(new ar(0,0))}static max(){return new Ve(new ar(253402300799,999999999))}compareTo(t){return this.timestamp._compareTo(t.timestamp)}isEqual(t){return this.timestamp.isEqual(t.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eu{constructor(t,r,n){r===void 0?r=0:r>t.length&&Le(),n===void 0?n=t.length-r:n>t.length-r&&Le(),this.segments=t,this.offset=r,this.len=n}get length(){return this.len}isEqual(t){return eu.comparator(this,t)===0}child(t){const r=this.segments.slice(this.offset,this.limit());return t instanceof eu?t.forEach(n=>{r.push(n)}):r.push(t),this.construct(r)}limit(){return this.offset+this.length}popFirst(t){return t=t===void 0?1:t,this.construct(this.segments,this.offset+t,this.length-t)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(t){return this.segments[this.offset+t]}isEmpty(){return this.length===0}isPrefixOf(t){if(t.length<this.length)return!1;for(let r=0;r<this.length;r++)if(this.get(r)!==t.get(r))return!1;return!0}isImmediateParentOf(t){if(this.length+1!==t.length)return!1;for(let r=0;r<this.length;r++)if(this.get(r)!==t.get(r))return!1;return!0}forEach(t){for(let r=this.offset,n=this.limit();r<n;r++)t(this.segments[r])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(t,r){const n=Math.min(t.length,r.length);for(let s=0;s<n;s++){const a=t.get(s),i=r.get(s);if(a<i)return-1;if(a>i)return 1}return t.length<r.length?-1:t.length>r.length?1:0}}class Ct extends eu{construct(t,r,n){return new Ct(t,r,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...t){const r=[];for(const n of t){if(n.indexOf("//")>=0)throw new Re(de.INVALID_ARGUMENT,`Invalid segment (${n}). Paths must not contain // in them.`);r.push(...n.split("/").filter(s=>s.length>0))}return new Ct(r)}static emptyPath(){return new Ct([])}}const H3=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class _r extends eu{construct(t,r,n){return new _r(t,r,n)}static isValidIdentifier(t){return H3.test(t)}canonicalString(){return this.toArray().map(t=>(t=t.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),_r.isValidIdentifier(t)||(t="`"+t+"`"),t)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new _r(["__name__"])}static fromServerFormat(t){const r=[];let n="",s=0;const a=()=>{if(n.length===0)throw new Re(de.INVALID_ARGUMENT,`Invalid field path (${t}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);r.push(n),n=""};let i=!1;for(;s<t.length;){const o=t[s];if(o==="\\"){if(s+1===t.length)throw new Re(de.INVALID_ARGUMENT,"Path has trailing escape character: "+t);const l=t[s+1];if(l!=="\\"&&l!=="."&&l!=="`")throw new Re(de.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);n+=l,s+=2}else o==="`"?(i=!i,s++):o!=="."||i?(n+=o,s++):(a(),s++)}if(a(),i)throw new Re(de.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new _r(r)}static emptyPath(){return new _r([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pe{constructor(t){this.path=t}static fromPath(t){return new Pe(Ct.fromString(t))}static fromName(t){return new Pe(Ct.fromString(t).popFirst(5))}static empty(){return new Pe(Ct.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(t){return this.path.length>=2&&this.path.get(this.path.length-2)===t}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(t){return t!==null&&Ct.comparator(this.path,t.path)===0}toString(){return this.path.toString()}static comparator(t,r){return Ct.comparator(t.path,r.path)}static isDocumentKey(t){return t.length%2==0}static fromSegments(t){return new Pe(new Ct(t.slice()))}}function G3(e,t){const r=e.toTimestamp().seconds,n=e.toTimestamp().nanoseconds+1,s=Ve.fromTimestamp(n===1e9?new ar(r+1,0):new ar(r,n));return new ii(s,Pe.empty(),t)}function K3(e){return new ii(e.readTime,e.key,-1)}class ii{constructor(t,r,n){this.readTime=t,this.documentKey=r,this.largestBatchId=n}static min(){return new ii(Ve.min(),Pe.empty(),-1)}static max(){return new ii(Ve.max(),Pe.empty(),-1)}}function q3(e,t){let r=e.readTime.compareTo(t.readTime);return r!==0?r:(r=Pe.comparator(e.documentKey,t.documentKey),r!==0?r:ut(e.largestBatchId,t.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const X3="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class Y3{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(t){this.onCommittedListeners.push(t)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(t=>t())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Nu(e){if(e.code!==de.FAILED_PRECONDITION||e.message!==X3)throw e;be("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xe{constructor(t){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,t(r=>{this.isDone=!0,this.result=r,this.nextCallback&&this.nextCallback(r)},r=>{this.isDone=!0,this.error=r,this.catchCallback&&this.catchCallback(r)})}catch(t){return this.next(void 0,t)}next(t,r){return this.callbackAttached&&Le(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(r,this.error):this.wrapSuccess(t,this.result):new xe((n,s)=>{this.nextCallback=a=>{this.wrapSuccess(t,a).next(n,s)},this.catchCallback=a=>{this.wrapFailure(r,a).next(n,s)}})}toPromise(){return new Promise((t,r)=>{this.next(t,r)})}wrapUserFunction(t){try{const r=t();return r instanceof xe?r:xe.resolve(r)}catch(r){return xe.reject(r)}}wrapSuccess(t,r){return t?this.wrapUserFunction(()=>t(r)):xe.resolve(r)}wrapFailure(t,r){return t?this.wrapUserFunction(()=>t(r)):xe.reject(r)}static resolve(t){return new xe((r,n)=>{r(t)})}static reject(t){return new xe((r,n)=>{n(t)})}static waitFor(t){return new xe((r,n)=>{let s=0,a=0,i=!1;t.forEach(o=>{++s,o.next(()=>{++a,i&&a===s&&r()},l=>n(l))}),i=!0,a===s&&r()})}static or(t){let r=xe.resolve(!1);for(const n of t)r=r.next(s=>s?xe.resolve(s):n());return r}static forEach(t,r){const n=[];return t.forEach((s,a)=>{n.push(r.call(this,s,a))}),this.waitFor(n)}static mapArray(t,r){return new xe((n,s)=>{const a=t.length,i=new Array(a);let o=0;for(let l=0;l<a;l++){const c=l;r(t[c]).next(u=>{i[c]=u,++o,o===a&&n(i)},u=>s(u))}})}static doWhile(t,r){return new xe((n,s)=>{const a=()=>{t()===!0?r().next(()=>{a()},s):n()};a()})}}function Q3(e){const t=e.match(/Android ([\d.]+)/i),r=t?t[1].split(".").slice(0,2).join("."):"-1";return Number(r)}function Ru(e){return e.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ov{constructor(t,r){this.previousValue=t,r&&(r.sequenceNumberHandler=n=>this.ie(n),this.se=n=>r.writeSequenceNumber(n))}ie(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue}next(){const t=++this.previousValue;return this.se&&this.se(t),t}}ov.oe=-1;function Od(e){return e==null}function zh(e){return e===0&&1/e==-1/0}function J3(e){return typeof e=="number"&&Number.isInteger(e)&&!zh(e)&&e<=Number.MAX_SAFE_INTEGER&&e>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Qy(e){let t=0;for(const r in e)Object.prototype.hasOwnProperty.call(e,r)&&t++;return t}function no(e,t){for(const r in e)Object.prototype.hasOwnProperty.call(e,r)&&t(r,e[r])}function Ck(e){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lt{constructor(t,r){this.comparator=t,this.root=r||xr.EMPTY}insert(t,r){return new Lt(this.comparator,this.root.insert(t,r,this.comparator).copy(null,null,xr.BLACK,null,null))}remove(t){return new Lt(this.comparator,this.root.remove(t,this.comparator).copy(null,null,xr.BLACK,null,null))}get(t){let r=this.root;for(;!r.isEmpty();){const n=this.comparator(t,r.key);if(n===0)return r.value;n<0?r=r.left:n>0&&(r=r.right)}return null}indexOf(t){let r=0,n=this.root;for(;!n.isEmpty();){const s=this.comparator(t,n.key);if(s===0)return r+n.left.size;s<0?n=n.left:(r+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(t){return this.root.inorderTraversal(t)}forEach(t){this.inorderTraversal((r,n)=>(t(r,n),!1))}toString(){const t=[];return this.inorderTraversal((r,n)=>(t.push(`${r}:${n}`),!1)),`{${t.join(", ")}}`}reverseTraversal(t){return this.root.reverseTraversal(t)}getIterator(){return new kf(this.root,null,this.comparator,!1)}getIteratorFrom(t){return new kf(this.root,t,this.comparator,!1)}getReverseIterator(){return new kf(this.root,null,this.comparator,!0)}getReverseIteratorFrom(t){return new kf(this.root,t,this.comparator,!0)}}class kf{constructor(t,r,n,s){this.isReverse=s,this.nodeStack=[];let a=1;for(;!t.isEmpty();)if(a=r?n(t.key,r):1,r&&s&&(a*=-1),a<0)t=this.isReverse?t.left:t.right;else{if(a===0){this.nodeStack.push(t);break}this.nodeStack.push(t),t=this.isReverse?t.right:t.left}}getNext(){let t=this.nodeStack.pop();const r={key:t.key,value:t.value};if(this.isReverse)for(t=t.left;!t.isEmpty();)this.nodeStack.push(t),t=t.right;else for(t=t.right;!t.isEmpty();)this.nodeStack.push(t),t=t.left;return r}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const t=this.nodeStack[this.nodeStack.length-1];return{key:t.key,value:t.value}}}class xr{constructor(t,r,n,s,a){this.key=t,this.value=r,this.color=n??xr.RED,this.left=s??xr.EMPTY,this.right=a??xr.EMPTY,this.size=this.left.size+1+this.right.size}copy(t,r,n,s,a){return new xr(t??this.key,r??this.value,n??this.color,s??this.left,a??this.right)}isEmpty(){return!1}inorderTraversal(t){return this.left.inorderTraversal(t)||t(this.key,this.value)||this.right.inorderTraversal(t)}reverseTraversal(t){return this.right.reverseTraversal(t)||t(this.key,this.value)||this.left.reverseTraversal(t)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(t,r,n){let s=this;const a=n(t,s.key);return s=a<0?s.copy(null,null,null,s.left.insert(t,r,n),null):a===0?s.copy(null,r,null,null,null):s.copy(null,null,null,null,s.right.insert(t,r,n)),s.fixUp()}removeMin(){if(this.left.isEmpty())return xr.EMPTY;let t=this;return t.left.isRed()||t.left.left.isRed()||(t=t.moveRedLeft()),t=t.copy(null,null,null,t.left.removeMin(),null),t.fixUp()}remove(t,r){let n,s=this;if(r(t,s.key)<0)s.left.isEmpty()||s.left.isRed()||s.left.left.isRed()||(s=s.moveRedLeft()),s=s.copy(null,null,null,s.left.remove(t,r),null);else{if(s.left.isRed()&&(s=s.rotateRight()),s.right.isEmpty()||s.right.isRed()||s.right.left.isRed()||(s=s.moveRedRight()),r(t,s.key)===0){if(s.right.isEmpty())return xr.EMPTY;n=s.right.min(),s=s.copy(n.key,n.value,null,null,s.right.removeMin())}s=s.copy(null,null,null,null,s.right.remove(t,r))}return s.fixUp()}isRed(){return this.color}fixUp(){let t=this;return t.right.isRed()&&!t.left.isRed()&&(t=t.rotateLeft()),t.left.isRed()&&t.left.left.isRed()&&(t=t.rotateRight()),t.left.isRed()&&t.right.isRed()&&(t=t.colorFlip()),t}moveRedLeft(){let t=this.colorFlip();return t.right.left.isRed()&&(t=t.copy(null,null,null,null,t.right.rotateRight()),t=t.rotateLeft(),t=t.colorFlip()),t}moveRedRight(){let t=this.colorFlip();return t.left.left.isRed()&&(t=t.rotateRight(),t=t.colorFlip()),t}rotateLeft(){const t=this.copy(null,null,xr.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)}rotateRight(){const t=this.copy(null,null,xr.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)}colorFlip(){const t=this.left.copy(null,null,!this.left.color,null,null),r=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,r)}checkMaxDepth(){const t=this.check();return Math.pow(2,t)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw Le();const t=this.left.check();if(t!==this.right.check())throw Le();return t+(this.isRed()?0:1)}}xr.EMPTY=null,xr.RED=!0,xr.BLACK=!1;xr.EMPTY=new class{constructor(){this.size=0}get key(){throw Le()}get value(){throw Le()}get color(){throw Le()}get left(){throw Le()}get right(){throw Le()}copy(t,r,n,s,a){return this}insert(t,r,n){return new xr(t,r)}remove(t,r){return this}isEmpty(){return!0}inorderTraversal(t){return!1}reverseTraversal(t){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Er{constructor(t){this.comparator=t,this.data=new Lt(this.comparator)}has(t){return this.data.get(t)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(t){return this.data.indexOf(t)}forEach(t){this.data.inorderTraversal((r,n)=>(t(r),!1))}forEachInRange(t,r){const n=this.data.getIteratorFrom(t[0]);for(;n.hasNext();){const s=n.getNext();if(this.comparator(s.key,t[1])>=0)return;r(s.key)}}forEachWhile(t,r){let n;for(n=r!==void 0?this.data.getIteratorFrom(r):this.data.getIterator();n.hasNext();)if(!t(n.getNext().key))return}firstAfterOrEqual(t){const r=this.data.getIteratorFrom(t);return r.hasNext()?r.getNext().key:null}getIterator(){return new Jy(this.data.getIterator())}getIteratorFrom(t){return new Jy(this.data.getIteratorFrom(t))}add(t){return this.copy(this.data.remove(t).insert(t,!0))}delete(t){return this.has(t)?this.copy(this.data.remove(t)):this}isEmpty(){return this.data.isEmpty()}unionWith(t){let r=this;return r.size<t.size&&(r=t,t=this),t.forEach(n=>{r=r.add(n)}),r}isEqual(t){if(!(t instanceof Er)||this.size!==t.size)return!1;const r=this.data.getIterator(),n=t.data.getIterator();for(;r.hasNext();){const s=r.getNext().key,a=n.getNext().key;if(this.comparator(s,a)!==0)return!1}return!0}toArray(){const t=[];return this.forEach(r=>{t.push(r)}),t}toString(){const t=[];return this.forEach(r=>t.push(r)),"SortedSet("+t.toString()+")"}copy(t){const r=new Er(this.comparator);return r.data=t,r}}class Jy{constructor(t){this.iter=t}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tn{constructor(t){this.fields=t,t.sort(_r.comparator)}static empty(){return new Tn([])}unionWith(t){let r=new Er(_r.comparator);for(const n of this.fields)r=r.add(n);for(const n of t)r=r.add(n);return new Tn(r.toArray())}covers(t){for(const r of this.fields)if(r.isPrefixOf(t))return!0;return!1}isEqual(t){return ul(this.fields,t.fields,(r,n)=>r.isEqual(n))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nk extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cr{constructor(t){this.binaryString=t}static fromBase64String(t){const r=function(s){try{return atob(s)}catch(a){throw typeof DOMException<"u"&&a instanceof DOMException?new Nk("Invalid base64 string: "+a):a}}(t);return new Cr(r)}static fromUint8Array(t){const r=function(s){let a="";for(let i=0;i<s.length;++i)a+=String.fromCharCode(s[i]);return a}(t);return new Cr(r)}[Symbol.iterator](){let t=0;return{next:()=>t<this.binaryString.length?{value:this.binaryString.charCodeAt(t++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(r){return btoa(r)}(this.binaryString)}toUint8Array(){return function(r){const n=new Uint8Array(r.length);for(let s=0;s<r.length;s++)n[s]=r.charCodeAt(s);return n}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(t){return ut(this.binaryString,t.binaryString)}isEqual(t){return this.binaryString===t.binaryString}}Cr.EMPTY_BYTE_STRING=new Cr("");const Z3=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function oi(e){if(vt(!!e),typeof e=="string"){let t=0;const r=Z3.exec(e);if(vt(!!r),r[1]){let s=r[1];s=(s+"000000000").substr(0,9),t=Number(s)}const n=new Date(e);return{seconds:Math.floor(n.getTime()/1e3),nanos:t}}return{seconds:$t(e.seconds),nanos:$t(e.nanos)}}function $t(e){return typeof e=="number"?e:typeof e=="string"?Number(e):0}function qi(e){return typeof e=="string"?Cr.fromBase64String(e):Cr.fromUint8Array(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function lv(e){var t,r;return((r=(((t=e==null?void 0:e.mapValue)===null||t===void 0?void 0:t.fields)||{}).__type__)===null||r===void 0?void 0:r.stringValue)==="server_timestamp"}function cv(e){const t=e.mapValue.fields.__previous_value__;return lv(t)?cv(t):t}function tu(e){const t=oi(e.mapValue.fields.__local_write_time__.timestampValue);return new ar(t.seconds,t.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eF{constructor(t,r,n,s,a,i,o,l,c){this.databaseId=t,this.appId=r,this.persistenceKey=n,this.host=s,this.ssl=a,this.forceLongPolling=i,this.autoDetectLongPolling=o,this.longPollingOptions=l,this.useFetchStreams=c}}class ru{constructor(t,r){this.projectId=t,this.database=r||"(default)"}static empty(){return new ru("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(t){return t instanceof ru&&t.projectId===this.projectId&&t.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Sf={mapValue:{}};function Xi(e){return"nullValue"in e?0:"booleanValue"in e?1:"integerValue"in e||"doubleValue"in e?2:"timestampValue"in e?3:"stringValue"in e?5:"bytesValue"in e?6:"referenceValue"in e?7:"geoPointValue"in e?8:"arrayValue"in e?9:"mapValue"in e?lv(e)?4:rF(e)?9007199254740991:tF(e)?10:11:Le()}function Ns(e,t){if(e===t)return!0;const r=Xi(e);if(r!==Xi(t))return!1;switch(r){case 0:case 9007199254740991:return!0;case 1:return e.booleanValue===t.booleanValue;case 4:return tu(e).isEqual(tu(t));case 3:return function(s,a){if(typeof s.timestampValue=="string"&&typeof a.timestampValue=="string"&&s.timestampValue.length===a.timestampValue.length)return s.timestampValue===a.timestampValue;const i=oi(s.timestampValue),o=oi(a.timestampValue);return i.seconds===o.seconds&&i.nanos===o.nanos}(e,t);case 5:return e.stringValue===t.stringValue;case 6:return function(s,a){return qi(s.bytesValue).isEqual(qi(a.bytesValue))}(e,t);case 7:return e.referenceValue===t.referenceValue;case 8:return function(s,a){return $t(s.geoPointValue.latitude)===$t(a.geoPointValue.latitude)&&$t(s.geoPointValue.longitude)===$t(a.geoPointValue.longitude)}(e,t);case 2:return function(s,a){if("integerValue"in s&&"integerValue"in a)return $t(s.integerValue)===$t(a.integerValue);if("doubleValue"in s&&"doubleValue"in a){const i=$t(s.doubleValue),o=$t(a.doubleValue);return i===o?zh(i)===zh(o):isNaN(i)&&isNaN(o)}return!1}(e,t);case 9:return ul(e.arrayValue.values||[],t.arrayValue.values||[],Ns);case 10:case 11:return function(s,a){const i=s.mapValue.fields||{},o=a.mapValue.fields||{};if(Qy(i)!==Qy(o))return!1;for(const l in i)if(i.hasOwnProperty(l)&&(o[l]===void 0||!Ns(i[l],o[l])))return!1;return!0}(e,t);default:return Le()}}function nu(e,t){return(e.values||[]).find(r=>Ns(r,t))!==void 0}function fl(e,t){if(e===t)return 0;const r=Xi(e),n=Xi(t);if(r!==n)return ut(r,n);switch(r){case 0:case 9007199254740991:return 0;case 1:return ut(e.booleanValue,t.booleanValue);case 2:return function(a,i){const o=$t(a.integerValue||a.doubleValue),l=$t(i.integerValue||i.doubleValue);return o<l?-1:o>l?1:o===l?0:isNaN(o)?isNaN(l)?0:-1:1}(e,t);case 3:return Zy(e.timestampValue,t.timestampValue);case 4:return Zy(tu(e),tu(t));case 5:return ut(e.stringValue,t.stringValue);case 6:return function(a,i){const o=qi(a),l=qi(i);return o.compareTo(l)}(e.bytesValue,t.bytesValue);case 7:return function(a,i){const o=a.split("/"),l=i.split("/");for(let c=0;c<o.length&&c<l.length;c++){const u=ut(o[c],l[c]);if(u!==0)return u}return ut(o.length,l.length)}(e.referenceValue,t.referenceValue);case 8:return function(a,i){const o=ut($t(a.latitude),$t(i.latitude));return o!==0?o:ut($t(a.longitude),$t(i.longitude))}(e.geoPointValue,t.geoPointValue);case 9:return e_(e.arrayValue,t.arrayValue);case 10:return function(a,i){var o,l,c,u;const d=a.fields||{},m=i.fields||{},p=(o=d.value)===null||o===void 0?void 0:o.arrayValue,g=(l=m.value)===null||l===void 0?void 0:l.arrayValue,x=ut(((c=p==null?void 0:p.values)===null||c===void 0?void 0:c.length)||0,((u=g==null?void 0:g.values)===null||u===void 0?void 0:u.length)||0);return x!==0?x:e_(p,g)}(e.mapValue,t.mapValue);case 11:return function(a,i){if(a===Sf.mapValue&&i===Sf.mapValue)return 0;if(a===Sf.mapValue)return 1;if(i===Sf.mapValue)return-1;const o=a.fields||{},l=Object.keys(o),c=i.fields||{},u=Object.keys(c);l.sort(),u.sort();for(let d=0;d<l.length&&d<u.length;++d){const m=ut(l[d],u[d]);if(m!==0)return m;const p=fl(o[l[d]],c[u[d]]);if(p!==0)return p}return ut(l.length,u.length)}(e.mapValue,t.mapValue);default:throw Le()}}function Zy(e,t){if(typeof e=="string"&&typeof t=="string"&&e.length===t.length)return ut(e,t);const r=oi(e),n=oi(t),s=ut(r.seconds,n.seconds);return s!==0?s:ut(r.nanos,n.nanos)}function e_(e,t){const r=e.values||[],n=t.values||[];for(let s=0;s<r.length&&s<n.length;++s){const a=fl(r[s],n[s]);if(a)return a}return ut(r.length,n.length)}function hl(e){return pp(e)}function pp(e){return"nullValue"in e?"null":"booleanValue"in e?""+e.booleanValue:"integerValue"in e?""+e.integerValue:"doubleValue"in e?""+e.doubleValue:"timestampValue"in e?function(r){const n=oi(r);return`time(${n.seconds},${n.nanos})`}(e.timestampValue):"stringValue"in e?e.stringValue:"bytesValue"in e?function(r){return qi(r).toBase64()}(e.bytesValue):"referenceValue"in e?function(r){return Pe.fromName(r).toString()}(e.referenceValue):"geoPointValue"in e?function(r){return`geo(${r.latitude},${r.longitude})`}(e.geoPointValue):"arrayValue"in e?function(r){let n="[",s=!0;for(const a of r.values||[])s?s=!1:n+=",",n+=pp(a);return n+"]"}(e.arrayValue):"mapValue"in e?function(r){const n=Object.keys(r.fields||{}).sort();let s="{",a=!0;for(const i of n)a?a=!1:s+=",",s+=`${i}:${pp(r.fields[i])}`;return s+"}"}(e.mapValue):Le()}function t_(e,t){return{referenceValue:`projects/${e.projectId}/databases/${e.database}/documents/${t.path.canonicalString()}`}}function gp(e){return!!e&&"integerValue"in e}function uv(e){return!!e&&"arrayValue"in e}function r_(e){return!!e&&"nullValue"in e}function n_(e){return!!e&&"doubleValue"in e&&isNaN(Number(e.doubleValue))}function th(e){return!!e&&"mapValue"in e}function tF(e){var t,r;return((r=(((t=e==null?void 0:e.mapValue)===null||t===void 0?void 0:t.fields)||{}).__type__)===null||r===void 0?void 0:r.stringValue)==="__vector__"}function yc(e){if(e.geoPointValue)return{geoPointValue:Object.assign({},e.geoPointValue)};if(e.timestampValue&&typeof e.timestampValue=="object")return{timestampValue:Object.assign({},e.timestampValue)};if(e.mapValue){const t={mapValue:{fields:{}}};return no(e.mapValue.fields,(r,n)=>t.mapValue.fields[r]=yc(n)),t}if(e.arrayValue){const t={arrayValue:{values:[]}};for(let r=0;r<(e.arrayValue.values||[]).length;++r)t.arrayValue.values[r]=yc(e.arrayValue.values[r]);return t}return Object.assign({},e)}function rF(e){return(((e.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class un{constructor(t){this.value=t}static empty(){return new un({mapValue:{}})}field(t){if(t.isEmpty())return this.value;{let r=this.value;for(let n=0;n<t.length-1;++n)if(r=(r.mapValue.fields||{})[t.get(n)],!th(r))return null;return r=(r.mapValue.fields||{})[t.lastSegment()],r||null}}set(t,r){this.getFieldsMap(t.popLast())[t.lastSegment()]=yc(r)}setAll(t){let r=_r.emptyPath(),n={},s=[];t.forEach((i,o)=>{if(!r.isImmediateParentOf(o)){const l=this.getFieldsMap(r);this.applyChanges(l,n,s),n={},s=[],r=o.popLast()}i?n[o.lastSegment()]=yc(i):s.push(o.lastSegment())});const a=this.getFieldsMap(r);this.applyChanges(a,n,s)}delete(t){const r=this.field(t.popLast());th(r)&&r.mapValue.fields&&delete r.mapValue.fields[t.lastSegment()]}isEqual(t){return Ns(this.value,t.value)}getFieldsMap(t){let r=this.value;r.mapValue.fields||(r.mapValue={fields:{}});for(let n=0;n<t.length;++n){let s=r.mapValue.fields[t.get(n)];th(s)&&s.mapValue.fields||(s={mapValue:{fields:{}}},r.mapValue.fields[t.get(n)]=s),r=s}return r.mapValue.fields}applyChanges(t,r,n){no(r,(s,a)=>t[s]=a);for(const s of n)delete t[s]}clone(){return new un(yc(this.value))}}function Rk(e){const t=[];return no(e.fields,(r,n)=>{const s=new _r([r]);if(th(n)){const a=Rk(n.mapValue).fields;if(a.length===0)t.push(s);else for(const i of a)t.push(s.child(i))}else t.push(s)}),new Tn(t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vr{constructor(t,r,n,s,a,i,o){this.key=t,this.documentType=r,this.version=n,this.readTime=s,this.createTime=a,this.data=i,this.documentState=o}static newInvalidDocument(t){return new Vr(t,0,Ve.min(),Ve.min(),Ve.min(),un.empty(),0)}static newFoundDocument(t,r,n,s){return new Vr(t,1,r,Ve.min(),n,s,0)}static newNoDocument(t,r){return new Vr(t,2,r,Ve.min(),Ve.min(),un.empty(),0)}static newUnknownDocument(t,r){return new Vr(t,3,r,Ve.min(),Ve.min(),un.empty(),2)}convertToFoundDocument(t,r){return!this.createTime.isEqual(Ve.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=t),this.version=t,this.documentType=1,this.data=r,this.documentState=0,this}convertToNoDocument(t){return this.version=t,this.documentType=2,this.data=un.empty(),this.documentState=0,this}convertToUnknownDocument(t){return this.version=t,this.documentType=3,this.data=un.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Ve.min(),this}setReadTime(t){return this.readTime=t,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(t){return t instanceof Vr&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.documentType===t.documentType&&this.documentState===t.documentState&&this.data.isEqual(t.data)}mutableCopy(){return new Vr(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $h{constructor(t,r){this.position=t,this.inclusive=r}}function s_(e,t,r){let n=0;for(let s=0;s<e.position.length;s++){const a=t[s],i=e.position[s];if(a.field.isKeyField()?n=Pe.comparator(Pe.fromName(i.referenceValue),r.key):n=fl(i,r.data.field(a.field)),a.dir==="desc"&&(n*=-1),n!==0)break}return n}function a_(e,t){if(e===null)return t===null;if(t===null||e.inclusive!==t.inclusive||e.position.length!==t.position.length)return!1;for(let r=0;r<e.position.length;r++)if(!Ns(e.position[r],t.position[r]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wh{constructor(t,r="asc"){this.field=t,this.dir=r}}function nF(e,t){return e.dir===t.dir&&e.field.isEqual(t.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bk{}class Zt extends bk{constructor(t,r,n){super(),this.field=t,this.op=r,this.value=n}static create(t,r,n){return t.isKeyField()?r==="in"||r==="not-in"?this.createKeyFieldInFilter(t,r,n):new aF(t,r,n):r==="array-contains"?new lF(t,n):r==="in"?new cF(t,n):r==="not-in"?new uF(t,n):r==="array-contains-any"?new fF(t,n):new Zt(t,r,n)}static createKeyFieldInFilter(t,r,n){return r==="in"?new iF(t,n):new oF(t,n)}matches(t){const r=t.data.field(this.field);return this.op==="!="?r!==null&&this.matchesComparison(fl(r,this.value)):r!==null&&Xi(this.value)===Xi(r)&&this.matchesComparison(fl(r,this.value))}matchesComparison(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return t===0;case"!=":return t!==0;case">":return t>0;case">=":return t>=0;default:return Le()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class fs extends bk{constructor(t,r){super(),this.filters=t,this.op=r,this.ae=null}static create(t,r){return new fs(t,r)}matches(t){return Pk(this)?this.filters.find(r=>!r.matches(t))===void 0:this.filters.find(r=>r.matches(t))!==void 0}getFlattenedFilters(){return this.ae!==null||(this.ae=this.filters.reduce((t,r)=>t.concat(r.getFlattenedFilters()),[])),this.ae}getFilters(){return Object.assign([],this.filters)}}function Pk(e){return e.op==="and"}function Dk(e){return sF(e)&&Pk(e)}function sF(e){for(const t of e.filters)if(t instanceof fs)return!1;return!0}function vp(e){if(e instanceof Zt)return e.field.canonicalString()+e.op.toString()+hl(e.value);if(Dk(e))return e.filters.map(t=>vp(t)).join(",");{const t=e.filters.map(r=>vp(r)).join(",");return`${e.op}(${t})`}}function Fk(e,t){return e instanceof Zt?function(n,s){return s instanceof Zt&&n.op===s.op&&n.field.isEqual(s.field)&&Ns(n.value,s.value)}(e,t):e instanceof fs?function(n,s){return s instanceof fs&&n.op===s.op&&n.filters.length===s.filters.length?n.filters.reduce((a,i,o)=>a&&Fk(i,s.filters[o]),!0):!1}(e,t):void Le()}function Ok(e){return e instanceof Zt?function(r){return`${r.field.canonicalString()} ${r.op} ${hl(r.value)}`}(e):e instanceof fs?function(r){return r.op.toString()+" {"+r.getFilters().map(Ok).join(" ,")+"}"}(e):"Filter"}class aF extends Zt{constructor(t,r,n){super(t,r,n),this.key=Pe.fromName(n.referenceValue)}matches(t){const r=Pe.comparator(t.key,this.key);return this.matchesComparison(r)}}class iF extends Zt{constructor(t,r){super(t,"in",r),this.keys=Mk("in",r)}matches(t){return this.keys.some(r=>r.isEqual(t.key))}}class oF extends Zt{constructor(t,r){super(t,"not-in",r),this.keys=Mk("not-in",r)}matches(t){return!this.keys.some(r=>r.isEqual(t.key))}}function Mk(e,t){var r;return(((r=t.arrayValue)===null||r===void 0?void 0:r.values)||[]).map(n=>Pe.fromName(n.referenceValue))}class lF extends Zt{constructor(t,r){super(t,"array-contains",r)}matches(t){const r=t.data.field(this.field);return uv(r)&&nu(r.arrayValue,this.value)}}class cF extends Zt{constructor(t,r){super(t,"in",r)}matches(t){const r=t.data.field(this.field);return r!==null&&nu(this.value.arrayValue,r)}}class uF extends Zt{constructor(t,r){super(t,"not-in",r)}matches(t){if(nu(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const r=t.data.field(this.field);return r!==null&&!nu(this.value.arrayValue,r)}}class fF extends Zt{constructor(t,r){super(t,"array-contains-any",r)}matches(t){const r=t.data.field(this.field);return!(!uv(r)||!r.arrayValue.values)&&r.arrayValue.values.some(n=>nu(this.value.arrayValue,n))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hF{constructor(t,r=null,n=[],s=[],a=null,i=null,o=null){this.path=t,this.collectionGroup=r,this.orderBy=n,this.filters=s,this.limit=a,this.startAt=i,this.endAt=o,this.ue=null}}function i_(e,t=null,r=[],n=[],s=null,a=null,i=null){return new hF(e,t,r,n,s,a,i)}function fv(e){const t=Be(e);if(t.ue===null){let r=t.path.canonicalString();t.collectionGroup!==null&&(r+="|cg:"+t.collectionGroup),r+="|f:",r+=t.filters.map(n=>vp(n)).join(","),r+="|ob:",r+=t.orderBy.map(n=>function(a){return a.field.canonicalString()+a.dir}(n)).join(","),Od(t.limit)||(r+="|l:",r+=t.limit),t.startAt&&(r+="|lb:",r+=t.startAt.inclusive?"b:":"a:",r+=t.startAt.position.map(n=>hl(n)).join(",")),t.endAt&&(r+="|ub:",r+=t.endAt.inclusive?"a:":"b:",r+=t.endAt.position.map(n=>hl(n)).join(",")),t.ue=r}return t.ue}function hv(e,t){if(e.limit!==t.limit||e.orderBy.length!==t.orderBy.length)return!1;for(let r=0;r<e.orderBy.length;r++)if(!nF(e.orderBy[r],t.orderBy[r]))return!1;if(e.filters.length!==t.filters.length)return!1;for(let r=0;r<e.filters.length;r++)if(!Fk(e.filters[r],t.filters[r]))return!1;return e.collectionGroup===t.collectionGroup&&!!e.path.isEqual(t.path)&&!!a_(e.startAt,t.startAt)&&a_(e.endAt,t.endAt)}function xp(e){return Pe.isDocumentKey(e.path)&&e.collectionGroup===null&&e.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bu{constructor(t,r=null,n=[],s=[],a=null,i="F",o=null,l=null){this.path=t,this.collectionGroup=r,this.explicitOrderBy=n,this.filters=s,this.limit=a,this.limitType=i,this.startAt=o,this.endAt=l,this.ce=null,this.le=null,this.he=null,this.startAt,this.endAt}}function dF(e,t,r,n,s,a,i,o){return new bu(e,t,r,n,s,a,i,o)}function Md(e){return new bu(e)}function o_(e){return e.filters.length===0&&e.limit===null&&e.startAt==null&&e.endAt==null&&(e.explicitOrderBy.length===0||e.explicitOrderBy.length===1&&e.explicitOrderBy[0].field.isKeyField())}function Lk(e){return e.collectionGroup!==null}function _c(e){const t=Be(e);if(t.ce===null){t.ce=[];const r=new Set;for(const a of t.explicitOrderBy)t.ce.push(a),r.add(a.field.canonicalString());const n=t.explicitOrderBy.length>0?t.explicitOrderBy[t.explicitOrderBy.length-1].dir:"asc";(function(i){let o=new Er(_r.comparator);return i.filters.forEach(l=>{l.getFlattenedFilters().forEach(c=>{c.isInequality()&&(o=o.add(c.field))})}),o})(t).forEach(a=>{r.has(a.canonicalString())||a.isKeyField()||t.ce.push(new Wh(a,n))}),r.has(_r.keyField().canonicalString())||t.ce.push(new Wh(_r.keyField(),n))}return t.ce}function Ss(e){const t=Be(e);return t.le||(t.le=mF(t,_c(e))),t.le}function mF(e,t){if(e.limitType==="F")return i_(e.path,e.collectionGroup,t,e.filters,e.limit,e.startAt,e.endAt);{t=t.map(s=>{const a=s.dir==="desc"?"asc":"desc";return new Wh(s.field,a)});const r=e.endAt?new $h(e.endAt.position,e.endAt.inclusive):null,n=e.startAt?new $h(e.startAt.position,e.startAt.inclusive):null;return i_(e.path,e.collectionGroup,t,e.filters,e.limit,r,n)}}function yp(e,t){const r=e.filters.concat([t]);return new bu(e.path,e.collectionGroup,e.explicitOrderBy.slice(),r,e.limit,e.limitType,e.startAt,e.endAt)}function _p(e,t,r){return new bu(e.path,e.collectionGroup,e.explicitOrderBy.slice(),e.filters.slice(),t,r,e.startAt,e.endAt)}function Ld(e,t){return hv(Ss(e),Ss(t))&&e.limitType===t.limitType}function jk(e){return`${fv(Ss(e))}|lt:${e.limitType}`}function Eo(e){return`Query(target=${function(r){let n=r.path.canonicalString();return r.collectionGroup!==null&&(n+=" collectionGroup="+r.collectionGroup),r.filters.length>0&&(n+=`, filters: [${r.filters.map(s=>Ok(s)).join(", ")}]`),Od(r.limit)||(n+=", limit: "+r.limit),r.orderBy.length>0&&(n+=`, orderBy: [${r.orderBy.map(s=>function(i){return`${i.field.canonicalString()} (${i.dir})`}(s)).join(", ")}]`),r.startAt&&(n+=", startAt: ",n+=r.startAt.inclusive?"b:":"a:",n+=r.startAt.position.map(s=>hl(s)).join(",")),r.endAt&&(n+=", endAt: ",n+=r.endAt.inclusive?"a:":"b:",n+=r.endAt.position.map(s=>hl(s)).join(",")),`Target(${n})`}(Ss(e))}; limitType=${e.limitType})`}function jd(e,t){return t.isFoundDocument()&&function(n,s){const a=s.key.path;return n.collectionGroup!==null?s.key.hasCollectionId(n.collectionGroup)&&n.path.isPrefixOf(a):Pe.isDocumentKey(n.path)?n.path.isEqual(a):n.path.isImmediateParentOf(a)}(e,t)&&function(n,s){for(const a of _c(n))if(!a.field.isKeyField()&&s.data.field(a.field)===null)return!1;return!0}(e,t)&&function(n,s){for(const a of n.filters)if(!a.matches(s))return!1;return!0}(e,t)&&function(n,s){return!(n.startAt&&!function(i,o,l){const c=s_(i,o,l);return i.inclusive?c<=0:c<0}(n.startAt,_c(n),s)||n.endAt&&!function(i,o,l){const c=s_(i,o,l);return i.inclusive?c>=0:c>0}(n.endAt,_c(n),s))}(e,t)}function pF(e){return e.collectionGroup||(e.path.length%2==1?e.path.lastSegment():e.path.get(e.path.length-2))}function Vk(e){return(t,r)=>{let n=!1;for(const s of _c(e)){const a=gF(s,t,r);if(a!==0)return a;n=n||s.field.isKeyField()}return 0}}function gF(e,t,r){const n=e.field.isKeyField()?Pe.comparator(t.key,r.key):function(a,i,o){const l=i.data.field(a),c=o.data.field(a);return l!==null&&c!==null?fl(l,c):Le()}(e.field,t,r);switch(e.dir){case"asc":return n;case"desc":return-1*n;default:return Le()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kl{constructor(t,r){this.mapKeyFn=t,this.equalsFn=r,this.inner={},this.innerSize=0}get(t){const r=this.mapKeyFn(t),n=this.inner[r];if(n!==void 0){for(const[s,a]of n)if(this.equalsFn(s,t))return a}}has(t){return this.get(t)!==void 0}set(t,r){const n=this.mapKeyFn(t),s=this.inner[n];if(s===void 0)return this.inner[n]=[[t,r]],void this.innerSize++;for(let a=0;a<s.length;a++)if(this.equalsFn(s[a][0],t))return void(s[a]=[t,r]);s.push([t,r]),this.innerSize++}delete(t){const r=this.mapKeyFn(t),n=this.inner[r];if(n===void 0)return!1;for(let s=0;s<n.length;s++)if(this.equalsFn(n[s][0],t))return n.length===1?delete this.inner[r]:n.splice(s,1),this.innerSize--,!0;return!1}forEach(t){no(this.inner,(r,n)=>{for(const[s,a]of n)t(s,a)})}isEmpty(){return Ck(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vF=new Lt(Pe.comparator);function ma(){return vF}const Uk=new Lt(Pe.comparator);function rc(...e){let t=Uk;for(const r of e)t=t.insert(r.key,r);return t}function Bk(e){let t=Uk;return e.forEach((r,n)=>t=t.insert(r,n.overlayedDocument)),t}function Pi(){return wc()}function zk(){return wc()}function wc(){return new kl(e=>e.toString(),(e,t)=>e.isEqual(t))}const xF=new Lt(Pe.comparator),yF=new Er(Pe.comparator);function Xe(...e){let t=yF;for(const r of e)t=t.add(r);return t}const _F=new Er(ut);function wF(){return _F}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function dv(e,t){if(e.useProto3Json){if(isNaN(t))return{doubleValue:"NaN"};if(t===1/0)return{doubleValue:"Infinity"};if(t===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:zh(t)?"-0":t}}function $k(e){return{integerValue:""+e}}function Wk(e,t){return J3(t)?$k(t):dv(e,t)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vd{constructor(){this._=void 0}}function EF(e,t,r){return e instanceof su?function(s,a){const i={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:s.seconds,nanos:s.nanoseconds}}}};return a&&lv(a)&&(a=cv(a)),a&&(i.fields.__previous_value__=a),{mapValue:i}}(r,t):e instanceof au?Gk(e,t):e instanceof iu?Kk(e,t):function(s,a){const i=Hk(s,a),o=l_(i)+l_(s.Pe);return gp(i)&&gp(s.Pe)?$k(o):dv(s.serializer,o)}(e,t)}function TF(e,t,r){return e instanceof au?Gk(e,t):e instanceof iu?Kk(e,t):r}function Hk(e,t){return e instanceof ou?function(n){return gp(n)||function(a){return!!a&&"doubleValue"in a}(n)}(t)?t:{integerValue:0}:null}class su extends Vd{}class au extends Vd{constructor(t){super(),this.elements=t}}function Gk(e,t){const r=qk(t);for(const n of e.elements)r.some(s=>Ns(s,n))||r.push(n);return{arrayValue:{values:r}}}class iu extends Vd{constructor(t){super(),this.elements=t}}function Kk(e,t){let r=qk(t);for(const n of e.elements)r=r.filter(s=>!Ns(s,n));return{arrayValue:{values:r}}}class ou extends Vd{constructor(t,r){super(),this.serializer=t,this.Pe=r}}function l_(e){return $t(e.integerValue||e.doubleValue)}function qk(e){return uv(e)&&e.arrayValue.values?e.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xk{constructor(t,r){this.field=t,this.transform=r}}function kF(e,t){return e.field.isEqual(t.field)&&function(n,s){return n instanceof au&&s instanceof au||n instanceof iu&&s instanceof iu?ul(n.elements,s.elements,Ns):n instanceof ou&&s instanceof ou?Ns(n.Pe,s.Pe):n instanceof su&&s instanceof su}(e.transform,t.transform)}class SF{constructor(t,r){this.version=t,this.transformResults=r}}class Bn{constructor(t,r){this.updateTime=t,this.exists=r}static none(){return new Bn}static exists(t){return new Bn(void 0,t)}static updateTime(t){return new Bn(t)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)}}function rh(e,t){return e.updateTime!==void 0?t.isFoundDocument()&&t.version.isEqual(e.updateTime):e.exists===void 0||e.exists===t.isFoundDocument()}class Ud{}function Yk(e,t){if(!e.hasLocalMutations||t&&t.fields.length===0)return null;if(t===null)return e.isNoDocument()?new mv(e.key,Bn.none()):new Pu(e.key,e.data,Bn.none());{const r=e.data,n=un.empty();let s=new Er(_r.comparator);for(let a of t.fields)if(!s.has(a)){let i=r.field(a);i===null&&a.length>1&&(a=a.popLast(),i=r.field(a)),i===null?n.delete(a):n.set(a,i),s=s.add(a)}return new vi(e.key,n,new Tn(s.toArray()),Bn.none())}}function AF(e,t,r){e instanceof Pu?function(s,a,i){const o=s.value.clone(),l=u_(s.fieldTransforms,a,i.transformResults);o.setAll(l),a.convertToFoundDocument(i.version,o).setHasCommittedMutations()}(e,t,r):e instanceof vi?function(s,a,i){if(!rh(s.precondition,a))return void a.convertToUnknownDocument(i.version);const o=u_(s.fieldTransforms,a,i.transformResults),l=a.data;l.setAll(Qk(s)),l.setAll(o),a.convertToFoundDocument(i.version,l).setHasCommittedMutations()}(e,t,r):function(s,a,i){a.convertToNoDocument(i.version).setHasCommittedMutations()}(0,t,r)}function Ec(e,t,r,n){return e instanceof Pu?function(a,i,o,l){if(!rh(a.precondition,i))return o;const c=a.value.clone(),u=f_(a.fieldTransforms,l,i);return c.setAll(u),i.convertToFoundDocument(i.version,c).setHasLocalMutations(),null}(e,t,r,n):e instanceof vi?function(a,i,o,l){if(!rh(a.precondition,i))return o;const c=f_(a.fieldTransforms,l,i),u=i.data;return u.setAll(Qk(a)),u.setAll(c),i.convertToFoundDocument(i.version,u).setHasLocalMutations(),o===null?null:o.unionWith(a.fieldMask.fields).unionWith(a.fieldTransforms.map(d=>d.field))}(e,t,r,n):function(a,i,o){return rh(a.precondition,i)?(i.convertToNoDocument(i.version).setHasLocalMutations(),null):o}(e,t,r)}function IF(e,t){let r=null;for(const n of e.fieldTransforms){const s=t.data.field(n.field),a=Hk(n.transform,s||null);a!=null&&(r===null&&(r=un.empty()),r.set(n.field,a))}return r||null}function c_(e,t){return e.type===t.type&&!!e.key.isEqual(t.key)&&!!e.precondition.isEqual(t.precondition)&&!!function(n,s){return n===void 0&&s===void 0||!(!n||!s)&&ul(n,s,(a,i)=>kF(a,i))}(e.fieldTransforms,t.fieldTransforms)&&(e.type===0?e.value.isEqual(t.value):e.type!==1||e.data.isEqual(t.data)&&e.fieldMask.isEqual(t.fieldMask))}class Pu extends Ud{constructor(t,r,n,s=[]){super(),this.key=t,this.value=r,this.precondition=n,this.fieldTransforms=s,this.type=0}getFieldMask(){return null}}class vi extends Ud{constructor(t,r,n,s,a=[]){super(),this.key=t,this.data=r,this.fieldMask=n,this.precondition=s,this.fieldTransforms=a,this.type=1}getFieldMask(){return this.fieldMask}}function Qk(e){const t=new Map;return e.fieldMask.fields.forEach(r=>{if(!r.isEmpty()){const n=e.data.field(r);t.set(r,n)}}),t}function u_(e,t,r){const n=new Map;vt(e.length===r.length);for(let s=0;s<r.length;s++){const a=e[s],i=a.transform,o=t.data.field(a.field);n.set(a.field,TF(i,o,r[s]))}return n}function f_(e,t,r){const n=new Map;for(const s of e){const a=s.transform,i=r.data.field(s.field);n.set(s.field,EF(a,i,t))}return n}class mv extends Ud{constructor(t,r){super(),this.key=t,this.precondition=r,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class CF extends Ud{constructor(t,r){super(),this.key=t,this.precondition=r,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class NF{constructor(t,r,n,s){this.batchId=t,this.localWriteTime=r,this.baseMutations=n,this.mutations=s}applyToRemoteDocument(t,r){const n=r.mutationResults;for(let s=0;s<this.mutations.length;s++){const a=this.mutations[s];a.key.isEqual(t.key)&&AF(a,t,n[s])}}applyToLocalView(t,r){for(const n of this.baseMutations)n.key.isEqual(t.key)&&(r=Ec(n,t,r,this.localWriteTime));for(const n of this.mutations)n.key.isEqual(t.key)&&(r=Ec(n,t,r,this.localWriteTime));return r}applyToLocalDocumentSet(t,r){const n=zk();return this.mutations.forEach(s=>{const a=t.get(s.key),i=a.overlayedDocument;let o=this.applyToLocalView(i,a.mutatedFields);o=r.has(s.key)?null:o;const l=Yk(i,o);l!==null&&n.set(s.key,l),i.isValidDocument()||i.convertToNoDocument(Ve.min())}),n}keys(){return this.mutations.reduce((t,r)=>t.add(r.key),Xe())}isEqual(t){return this.batchId===t.batchId&&ul(this.mutations,t.mutations,(r,n)=>c_(r,n))&&ul(this.baseMutations,t.baseMutations,(r,n)=>c_(r,n))}}class pv{constructor(t,r,n,s){this.batch=t,this.commitVersion=r,this.mutationResults=n,this.docVersions=s}static from(t,r,n){vt(t.mutations.length===n.length);let s=function(){return xF}();const a=t.mutations;for(let i=0;i<a.length;i++)s=s.insert(a[i].key,n[i].version);return new pv(t,r,n,s)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RF{constructor(t,r){this.largestBatchId=t,this.mutation=r}getKey(){return this.mutation.key}isEqual(t){return t!==null&&this.mutation===t.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bF{constructor(t,r){this.count=t,this.unchangedNames=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var qt,et;function PF(e){switch(e){default:return Le();case de.CANCELLED:case de.UNKNOWN:case de.DEADLINE_EXCEEDED:case de.RESOURCE_EXHAUSTED:case de.INTERNAL:case de.UNAVAILABLE:case de.UNAUTHENTICATED:return!1;case de.INVALID_ARGUMENT:case de.NOT_FOUND:case de.ALREADY_EXISTS:case de.PERMISSION_DENIED:case de.FAILED_PRECONDITION:case de.ABORTED:case de.OUT_OF_RANGE:case de.UNIMPLEMENTED:case de.DATA_LOSS:return!0}}function Jk(e){if(e===void 0)return da("GRPC error has no .code"),de.UNKNOWN;switch(e){case qt.OK:return de.OK;case qt.CANCELLED:return de.CANCELLED;case qt.UNKNOWN:return de.UNKNOWN;case qt.DEADLINE_EXCEEDED:return de.DEADLINE_EXCEEDED;case qt.RESOURCE_EXHAUSTED:return de.RESOURCE_EXHAUSTED;case qt.INTERNAL:return de.INTERNAL;case qt.UNAVAILABLE:return de.UNAVAILABLE;case qt.UNAUTHENTICATED:return de.UNAUTHENTICATED;case qt.INVALID_ARGUMENT:return de.INVALID_ARGUMENT;case qt.NOT_FOUND:return de.NOT_FOUND;case qt.ALREADY_EXISTS:return de.ALREADY_EXISTS;case qt.PERMISSION_DENIED:return de.PERMISSION_DENIED;case qt.FAILED_PRECONDITION:return de.FAILED_PRECONDITION;case qt.ABORTED:return de.ABORTED;case qt.OUT_OF_RANGE:return de.OUT_OF_RANGE;case qt.UNIMPLEMENTED:return de.UNIMPLEMENTED;case qt.DATA_LOSS:return de.DATA_LOSS;default:return Le()}}(et=qt||(qt={}))[et.OK=0]="OK",et[et.CANCELLED=1]="CANCELLED",et[et.UNKNOWN=2]="UNKNOWN",et[et.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",et[et.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",et[et.NOT_FOUND=5]="NOT_FOUND",et[et.ALREADY_EXISTS=6]="ALREADY_EXISTS",et[et.PERMISSION_DENIED=7]="PERMISSION_DENIED",et[et.UNAUTHENTICATED=16]="UNAUTHENTICATED",et[et.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",et[et.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",et[et.ABORTED=10]="ABORTED",et[et.OUT_OF_RANGE=11]="OUT_OF_RANGE",et[et.UNIMPLEMENTED=12]="UNIMPLEMENTED",et[et.INTERNAL=13]="INTERNAL",et[et.UNAVAILABLE=14]="UNAVAILABLE",et[et.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function DF(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const FF=new Li([4294967295,4294967295],0);function h_(e){const t=DF().encode(e),r=new _k;return r.update(t),new Uint8Array(r.digest())}function d_(e){const t=new DataView(e.buffer),r=t.getUint32(0,!0),n=t.getUint32(4,!0),s=t.getUint32(8,!0),a=t.getUint32(12,!0);return[new Li([r,n],0),new Li([s,a],0)]}class gv{constructor(t,r,n){if(this.bitmap=t,this.padding=r,this.hashCount=n,r<0||r>=8)throw new nc(`Invalid padding: ${r}`);if(n<0)throw new nc(`Invalid hash count: ${n}`);if(t.length>0&&this.hashCount===0)throw new nc(`Invalid hash count: ${n}`);if(t.length===0&&r!==0)throw new nc(`Invalid padding when bitmap length is 0: ${r}`);this.Ie=8*t.length-r,this.Te=Li.fromNumber(this.Ie)}Ee(t,r,n){let s=t.add(r.multiply(Li.fromNumber(n)));return s.compare(FF)===1&&(s=new Li([s.getBits(0),s.getBits(1)],0)),s.modulo(this.Te).toNumber()}de(t){return(this.bitmap[Math.floor(t/8)]&1<<t%8)!=0}mightContain(t){if(this.Ie===0)return!1;const r=h_(t),[n,s]=d_(r);for(let a=0;a<this.hashCount;a++){const i=this.Ee(n,s,a);if(!this.de(i))return!1}return!0}static create(t,r,n){const s=t%8==0?0:8-t%8,a=new Uint8Array(Math.ceil(t/8)),i=new gv(a,s,r);return n.forEach(o=>i.insert(o)),i}insert(t){if(this.Ie===0)return;const r=h_(t),[n,s]=d_(r);for(let a=0;a<this.hashCount;a++){const i=this.Ee(n,s,a);this.Ae(i)}}Ae(t){const r=Math.floor(t/8),n=t%8;this.bitmap[r]|=1<<n}}class nc extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bd{constructor(t,r,n,s,a){this.snapshotVersion=t,this.targetChanges=r,this.targetMismatches=n,this.documentUpdates=s,this.resolvedLimboDocuments=a}static createSynthesizedRemoteEventForCurrentChange(t,r,n){const s=new Map;return s.set(t,Du.createSynthesizedTargetChangeForCurrentChange(t,r,n)),new Bd(Ve.min(),s,new Lt(ut),ma(),Xe())}}class Du{constructor(t,r,n,s,a){this.resumeToken=t,this.current=r,this.addedDocuments=n,this.modifiedDocuments=s,this.removedDocuments=a}static createSynthesizedTargetChangeForCurrentChange(t,r,n){return new Du(n,r,Xe(),Xe(),Xe())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nh{constructor(t,r,n,s){this.Re=t,this.removedTargetIds=r,this.key=n,this.Ve=s}}class Zk{constructor(t,r){this.targetId=t,this.me=r}}class eS{constructor(t,r,n=Cr.EMPTY_BYTE_STRING,s=null){this.state=t,this.targetIds=r,this.resumeToken=n,this.cause=s}}class m_{constructor(){this.fe=0,this.ge=g_(),this.pe=Cr.EMPTY_BYTE_STRING,this.ye=!1,this.we=!0}get current(){return this.ye}get resumeToken(){return this.pe}get Se(){return this.fe!==0}get be(){return this.we}De(t){t.approximateByteSize()>0&&(this.we=!0,this.pe=t)}ve(){let t=Xe(),r=Xe(),n=Xe();return this.ge.forEach((s,a)=>{switch(a){case 0:t=t.add(s);break;case 2:r=r.add(s);break;case 1:n=n.add(s);break;default:Le()}}),new Du(this.pe,this.ye,t,r,n)}Ce(){this.we=!1,this.ge=g_()}Fe(t,r){this.we=!0,this.ge=this.ge.insert(t,r)}Me(t){this.we=!0,this.ge=this.ge.remove(t)}xe(){this.fe+=1}Oe(){this.fe-=1,vt(this.fe>=0)}Ne(){this.we=!0,this.ye=!0}}class OF{constructor(t){this.Le=t,this.Be=new Map,this.ke=ma(),this.qe=p_(),this.Qe=new Lt(ut)}Ke(t){for(const r of t.Re)t.Ve&&t.Ve.isFoundDocument()?this.$e(r,t.Ve):this.Ue(r,t.key,t.Ve);for(const r of t.removedTargetIds)this.Ue(r,t.key,t.Ve)}We(t){this.forEachTarget(t,r=>{const n=this.Ge(r);switch(t.state){case 0:this.ze(r)&&n.De(t.resumeToken);break;case 1:n.Oe(),n.Se||n.Ce(),n.De(t.resumeToken);break;case 2:n.Oe(),n.Se||this.removeTarget(r);break;case 3:this.ze(r)&&(n.Ne(),n.De(t.resumeToken));break;case 4:this.ze(r)&&(this.je(r),n.De(t.resumeToken));break;default:Le()}})}forEachTarget(t,r){t.targetIds.length>0?t.targetIds.forEach(r):this.Be.forEach((n,s)=>{this.ze(s)&&r(s)})}He(t){const r=t.targetId,n=t.me.count,s=this.Je(r);if(s){const a=s.target;if(xp(a))if(n===0){const i=new Pe(a.path);this.Ue(r,i,Vr.newNoDocument(i,Ve.min()))}else vt(n===1);else{const i=this.Ye(r);if(i!==n){const o=this.Ze(t),l=o?this.Xe(o,t,i):1;if(l!==0){this.je(r);const c=l===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Qe=this.Qe.insert(r,c)}}}}}Ze(t){const r=t.me.unchangedNames;if(!r||!r.bits)return null;const{bits:{bitmap:n="",padding:s=0},hashCount:a=0}=r;let i,o;try{i=qi(n).toUint8Array()}catch(l){if(l instanceof Nk)return cl("Decoding the base64 bloom filter in existence filter failed ("+l.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw l}try{o=new gv(i,s,a)}catch(l){return cl(l instanceof nc?"BloomFilter error: ":"Applying bloom filter failed: ",l),null}return o.Ie===0?null:o}Xe(t,r,n){return r.me.count===n-this.nt(t,r.targetId)?0:2}nt(t,r){const n=this.Le.getRemoteKeysForTarget(r);let s=0;return n.forEach(a=>{const i=this.Le.tt(),o=`projects/${i.projectId}/databases/${i.database}/documents/${a.path.canonicalString()}`;t.mightContain(o)||(this.Ue(r,a,null),s++)}),s}rt(t){const r=new Map;this.Be.forEach((a,i)=>{const o=this.Je(i);if(o){if(a.current&&xp(o.target)){const l=new Pe(o.target.path);this.ke.get(l)!==null||this.it(i,l)||this.Ue(i,l,Vr.newNoDocument(l,t))}a.be&&(r.set(i,a.ve()),a.Ce())}});let n=Xe();this.qe.forEach((a,i)=>{let o=!0;i.forEachWhile(l=>{const c=this.Je(l);return!c||c.purpose==="TargetPurposeLimboResolution"||(o=!1,!1)}),o&&(n=n.add(a))}),this.ke.forEach((a,i)=>i.setReadTime(t));const s=new Bd(t,r,this.Qe,this.ke,n);return this.ke=ma(),this.qe=p_(),this.Qe=new Lt(ut),s}$e(t,r){if(!this.ze(t))return;const n=this.it(t,r.key)?2:0;this.Ge(t).Fe(r.key,n),this.ke=this.ke.insert(r.key,r),this.qe=this.qe.insert(r.key,this.st(r.key).add(t))}Ue(t,r,n){if(!this.ze(t))return;const s=this.Ge(t);this.it(t,r)?s.Fe(r,1):s.Me(r),this.qe=this.qe.insert(r,this.st(r).delete(t)),n&&(this.ke=this.ke.insert(r,n))}removeTarget(t){this.Be.delete(t)}Ye(t){const r=this.Ge(t).ve();return this.Le.getRemoteKeysForTarget(t).size+r.addedDocuments.size-r.removedDocuments.size}xe(t){this.Ge(t).xe()}Ge(t){let r=this.Be.get(t);return r||(r=new m_,this.Be.set(t,r)),r}st(t){let r=this.qe.get(t);return r||(r=new Er(ut),this.qe=this.qe.insert(t,r)),r}ze(t){const r=this.Je(t)!==null;return r||be("WatchChangeAggregator","Detected inactive target",t),r}Je(t){const r=this.Be.get(t);return r&&r.Se?null:this.Le.ot(t)}je(t){this.Be.set(t,new m_),this.Le.getRemoteKeysForTarget(t).forEach(r=>{this.Ue(t,r,null)})}it(t,r){return this.Le.getRemoteKeysForTarget(t).has(r)}}function p_(){return new Lt(Pe.comparator)}function g_(){return new Lt(Pe.comparator)}const MF={asc:"ASCENDING",desc:"DESCENDING"},LF={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},jF={and:"AND",or:"OR"};class VF{constructor(t,r){this.databaseId=t,this.useProto3Json=r}}function wp(e,t){return e.useProto3Json||Od(t)?t:{value:t}}function Hh(e,t){return e.useProto3Json?`${new Date(1e3*t.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+t.nanoseconds).slice(-9)}Z`:{seconds:""+t.seconds,nanos:t.nanoseconds}}function tS(e,t){return e.useProto3Json?t.toBase64():t.toUint8Array()}function UF(e,t){return Hh(e,t.toTimestamp())}function As(e){return vt(!!e),Ve.fromTimestamp(function(r){const n=oi(r);return new ar(n.seconds,n.nanos)}(e))}function vv(e,t){return Ep(e,t).canonicalString()}function Ep(e,t){const r=function(s){return new Ct(["projects",s.projectId,"databases",s.database])}(e).child("documents");return t===void 0?r:r.child(t)}function rS(e){const t=Ct.fromString(e);return vt(oS(t)),t}function Tp(e,t){return vv(e.databaseId,t.path)}function q0(e,t){const r=rS(t);if(r.get(1)!==e.databaseId.projectId)throw new Re(de.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+r.get(1)+" vs "+e.databaseId.projectId);if(r.get(3)!==e.databaseId.database)throw new Re(de.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+r.get(3)+" vs "+e.databaseId.database);return new Pe(sS(r))}function nS(e,t){return vv(e.databaseId,t)}function BF(e){const t=rS(e);return t.length===4?Ct.emptyPath():sS(t)}function kp(e){return new Ct(["projects",e.databaseId.projectId,"databases",e.databaseId.database]).canonicalString()}function sS(e){return vt(e.length>4&&e.get(4)==="documents"),e.popFirst(5)}function v_(e,t,r){return{name:Tp(e,t),fields:r.value.mapValue.fields}}function zF(e,t){let r;if("targetChange"in t){t.targetChange;const n=function(c){return c==="NO_CHANGE"?0:c==="ADD"?1:c==="REMOVE"?2:c==="CURRENT"?3:c==="RESET"?4:Le()}(t.targetChange.targetChangeType||"NO_CHANGE"),s=t.targetChange.targetIds||[],a=function(c,u){return c.useProto3Json?(vt(u===void 0||typeof u=="string"),Cr.fromBase64String(u||"")):(vt(u===void 0||u instanceof Buffer||u instanceof Uint8Array),Cr.fromUint8Array(u||new Uint8Array))}(e,t.targetChange.resumeToken),i=t.targetChange.cause,o=i&&function(c){const u=c.code===void 0?de.UNKNOWN:Jk(c.code);return new Re(u,c.message||"")}(i);r=new eS(n,s,a,o||null)}else if("documentChange"in t){t.documentChange;const n=t.documentChange;n.document,n.document.name,n.document.updateTime;const s=q0(e,n.document.name),a=As(n.document.updateTime),i=n.document.createTime?As(n.document.createTime):Ve.min(),o=new un({mapValue:{fields:n.document.fields}}),l=Vr.newFoundDocument(s,a,i,o),c=n.targetIds||[],u=n.removedTargetIds||[];r=new nh(c,u,l.key,l)}else if("documentDelete"in t){t.documentDelete;const n=t.documentDelete;n.document;const s=q0(e,n.document),a=n.readTime?As(n.readTime):Ve.min(),i=Vr.newNoDocument(s,a),o=n.removedTargetIds||[];r=new nh([],o,i.key,i)}else if("documentRemove"in t){t.documentRemove;const n=t.documentRemove;n.document;const s=q0(e,n.document),a=n.removedTargetIds||[];r=new nh([],a,s,null)}else{if(!("filter"in t))return Le();{t.filter;const n=t.filter;n.targetId;const{count:s=0,unchangedNames:a}=n,i=new bF(s,a),o=n.targetId;r=new Zk(o,i)}}return r}function $F(e,t){let r;if(t instanceof Pu)r={update:v_(e,t.key,t.value)};else if(t instanceof mv)r={delete:Tp(e,t.key)};else if(t instanceof vi)r={update:v_(e,t.key,t.data),updateMask:JF(t.fieldMask)};else{if(!(t instanceof CF))return Le();r={verify:Tp(e,t.key)}}return t.fieldTransforms.length>0&&(r.updateTransforms=t.fieldTransforms.map(n=>function(a,i){const o=i.transform;if(o instanceof su)return{fieldPath:i.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(o instanceof au)return{fieldPath:i.field.canonicalString(),appendMissingElements:{values:o.elements}};if(o instanceof iu)return{fieldPath:i.field.canonicalString(),removeAllFromArray:{values:o.elements}};if(o instanceof ou)return{fieldPath:i.field.canonicalString(),increment:o.Pe};throw Le()}(0,n))),t.precondition.isNone||(r.currentDocument=function(s,a){return a.updateTime!==void 0?{updateTime:UF(s,a.updateTime)}:a.exists!==void 0?{exists:a.exists}:Le()}(e,t.precondition)),r}function WF(e,t){return e&&e.length>0?(vt(t!==void 0),e.map(r=>function(s,a){let i=s.updateTime?As(s.updateTime):As(a);return i.isEqual(Ve.min())&&(i=As(a)),new SF(i,s.transformResults||[])}(r,t))):[]}function HF(e,t){return{documents:[nS(e,t.path)]}}function GF(e,t){const r={structuredQuery:{}},n=t.path;let s;t.collectionGroup!==null?(s=n,r.structuredQuery.from=[{collectionId:t.collectionGroup,allDescendants:!0}]):(s=n.popLast(),r.structuredQuery.from=[{collectionId:n.lastSegment()}]),r.parent=nS(e,s);const a=function(c){if(c.length!==0)return iS(fs.create(c,"and"))}(t.filters);a&&(r.structuredQuery.where=a);const i=function(c){if(c.length!==0)return c.map(u=>function(m){return{field:To(m.field),direction:XF(m.dir)}}(u))}(t.orderBy);i&&(r.structuredQuery.orderBy=i);const o=wp(e,t.limit);return o!==null&&(r.structuredQuery.limit=o),t.startAt&&(r.structuredQuery.startAt=function(c){return{before:c.inclusive,values:c.position}}(t.startAt)),t.endAt&&(r.structuredQuery.endAt=function(c){return{before:!c.inclusive,values:c.position}}(t.endAt)),{_t:r,parent:s}}function KF(e){let t=BF(e.parent);const r=e.structuredQuery,n=r.from?r.from.length:0;let s=null;if(n>0){vt(n===1);const u=r.from[0];u.allDescendants?s=u.collectionId:t=t.child(u.collectionId)}let a=[];r.where&&(a=function(d){const m=aS(d);return m instanceof fs&&Dk(m)?m.getFilters():[m]}(r.where));let i=[];r.orderBy&&(i=function(d){return d.map(m=>function(g){return new Wh(ko(g.field),function(w){switch(w){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(g.direction))}(m))}(r.orderBy));let o=null;r.limit&&(o=function(d){let m;return m=typeof d=="object"?d.value:d,Od(m)?null:m}(r.limit));let l=null;r.startAt&&(l=function(d){const m=!!d.before,p=d.values||[];return new $h(p,m)}(r.startAt));let c=null;return r.endAt&&(c=function(d){const m=!d.before,p=d.values||[];return new $h(p,m)}(r.endAt)),dF(t,s,i,a,o,"F",l,c)}function qF(e,t){const r=function(s){switch(s){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return Le()}}(t.purpose);return r==null?null:{"goog-listen-tags":r}}function aS(e){return e.unaryFilter!==void 0?function(r){switch(r.unaryFilter.op){case"IS_NAN":const n=ko(r.unaryFilter.field);return Zt.create(n,"==",{doubleValue:NaN});case"IS_NULL":const s=ko(r.unaryFilter.field);return Zt.create(s,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const a=ko(r.unaryFilter.field);return Zt.create(a,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const i=ko(r.unaryFilter.field);return Zt.create(i,"!=",{nullValue:"NULL_VALUE"});default:return Le()}}(e):e.fieldFilter!==void 0?function(r){return Zt.create(ko(r.fieldFilter.field),function(s){switch(s){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return Le()}}(r.fieldFilter.op),r.fieldFilter.value)}(e):e.compositeFilter!==void 0?function(r){return fs.create(r.compositeFilter.filters.map(n=>aS(n)),function(s){switch(s){case"AND":return"and";case"OR":return"or";default:return Le()}}(r.compositeFilter.op))}(e):Le()}function XF(e){return MF[e]}function YF(e){return LF[e]}function QF(e){return jF[e]}function To(e){return{fieldPath:e.canonicalString()}}function ko(e){return _r.fromServerFormat(e.fieldPath)}function iS(e){return e instanceof Zt?function(r){if(r.op==="=="){if(n_(r.value))return{unaryFilter:{field:To(r.field),op:"IS_NAN"}};if(r_(r.value))return{unaryFilter:{field:To(r.field),op:"IS_NULL"}}}else if(r.op==="!="){if(n_(r.value))return{unaryFilter:{field:To(r.field),op:"IS_NOT_NAN"}};if(r_(r.value))return{unaryFilter:{field:To(r.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:To(r.field),op:YF(r.op),value:r.value}}}(e):e instanceof fs?function(r){const n=r.getFilters().map(s=>iS(s));return n.length===1?n[0]:{compositeFilter:{op:QF(r.op),filters:n}}}(e):Le()}function JF(e){const t=[];return e.fields.forEach(r=>t.push(r.canonicalString())),{fieldPaths:t}}function oS(e){return e.length>=4&&e.get(0)==="projects"&&e.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ua{constructor(t,r,n,s,a=Ve.min(),i=Ve.min(),o=Cr.EMPTY_BYTE_STRING,l=null){this.target=t,this.targetId=r,this.purpose=n,this.sequenceNumber=s,this.snapshotVersion=a,this.lastLimboFreeSnapshotVersion=i,this.resumeToken=o,this.expectedCount=l}withSequenceNumber(t){return new Ua(this.target,this.targetId,this.purpose,t,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(t,r){return new Ua(this.target,this.targetId,this.purpose,this.sequenceNumber,r,this.lastLimboFreeSnapshotVersion,t,null)}withExpectedCount(t){return new Ua(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,t)}withLastLimboFreeSnapshotVersion(t){return new Ua(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,t,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZF{constructor(t){this.ct=t}}function eO(e){const t=KF({parent:e.parent,structuredQuery:e.structuredQuery});return e.limitType==="LAST"?_p(t,t.limit,"L"):t}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tO{constructor(){this.un=new rO}addToCollectionParentIndex(t,r){return this.un.add(r),xe.resolve()}getCollectionParents(t,r){return xe.resolve(this.un.getEntries(r))}addFieldIndex(t,r){return xe.resolve()}deleteFieldIndex(t,r){return xe.resolve()}deleteAllFieldIndexes(t){return xe.resolve()}createTargetIndexes(t,r){return xe.resolve()}getDocumentsMatchingTarget(t,r){return xe.resolve(null)}getIndexType(t,r){return xe.resolve(0)}getFieldIndexes(t,r){return xe.resolve([])}getNextCollectionGroupToUpdate(t){return xe.resolve(null)}getMinOffset(t,r){return xe.resolve(ii.min())}getMinOffsetFromCollectionGroup(t,r){return xe.resolve(ii.min())}updateCollectionGroup(t,r,n){return xe.resolve()}updateIndexEntries(t,r){return xe.resolve()}}class rO{constructor(){this.index={}}add(t){const r=t.lastSegment(),n=t.popLast(),s=this.index[r]||new Er(Ct.comparator),a=!s.has(n);return this.index[r]=s.add(n),a}has(t){const r=t.lastSegment(),n=t.popLast(),s=this.index[r];return s&&s.has(n)}getEntries(t){return(this.index[t]||new Er(Ct.comparator)).toArray()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dl{constructor(t){this.Ln=t}next(){return this.Ln+=2,this.Ln}static Bn(){return new dl(0)}static kn(){return new dl(-1)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nO{constructor(){this.changes=new kl(t=>t.toString(),(t,r)=>t.isEqual(r)),this.changesApplied=!1}addEntry(t){this.assertNotApplied(),this.changes.set(t.key,t)}removeEntry(t,r){this.assertNotApplied(),this.changes.set(t,Vr.newInvalidDocument(t).setReadTime(r))}getEntry(t,r){this.assertNotApplied();const n=this.changes.get(r);return n!==void 0?xe.resolve(n):this.getFromCache(t,r)}getEntries(t,r){return this.getAllFromCache(t,r)}apply(t){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(t)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sO{constructor(t,r){this.overlayedDocument=t,this.mutatedFields=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aO{constructor(t,r,n,s){this.remoteDocumentCache=t,this.mutationQueue=r,this.documentOverlayCache=n,this.indexManager=s}getDocument(t,r){let n=null;return this.documentOverlayCache.getOverlay(t,r).next(s=>(n=s,this.remoteDocumentCache.getEntry(t,r))).next(s=>(n!==null&&Ec(n.mutation,s,Tn.empty(),ar.now()),s))}getDocuments(t,r){return this.remoteDocumentCache.getEntries(t,r).next(n=>this.getLocalViewOfDocuments(t,n,Xe()).next(()=>n))}getLocalViewOfDocuments(t,r,n=Xe()){const s=Pi();return this.populateOverlays(t,s,r).next(()=>this.computeViews(t,r,s,n).next(a=>{let i=rc();return a.forEach((o,l)=>{i=i.insert(o,l.overlayedDocument)}),i}))}getOverlayedDocuments(t,r){const n=Pi();return this.populateOverlays(t,n,r).next(()=>this.computeViews(t,r,n,Xe()))}populateOverlays(t,r,n){const s=[];return n.forEach(a=>{r.has(a)||s.push(a)}),this.documentOverlayCache.getOverlays(t,s).next(a=>{a.forEach((i,o)=>{r.set(i,o)})})}computeViews(t,r,n,s){let a=ma();const i=wc(),o=function(){return wc()}();return r.forEach((l,c)=>{const u=n.get(c.key);s.has(c.key)&&(u===void 0||u.mutation instanceof vi)?a=a.insert(c.key,c):u!==void 0?(i.set(c.key,u.mutation.getFieldMask()),Ec(u.mutation,c,u.mutation.getFieldMask(),ar.now())):i.set(c.key,Tn.empty())}),this.recalculateAndSaveOverlays(t,a).next(l=>(l.forEach((c,u)=>i.set(c,u)),r.forEach((c,u)=>{var d;return o.set(c,new sO(u,(d=i.get(c))!==null&&d!==void 0?d:null))}),o))}recalculateAndSaveOverlays(t,r){const n=wc();let s=new Lt((i,o)=>i-o),a=Xe();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(t,r).next(i=>{for(const o of i)o.keys().forEach(l=>{const c=r.get(l);if(c===null)return;let u=n.get(l)||Tn.empty();u=o.applyToLocalView(c,u),n.set(l,u);const d=(s.get(o.batchId)||Xe()).add(l);s=s.insert(o.batchId,d)})}).next(()=>{const i=[],o=s.getReverseIterator();for(;o.hasNext();){const l=o.getNext(),c=l.key,u=l.value,d=zk();u.forEach(m=>{if(!a.has(m)){const p=Yk(r.get(m),n.get(m));p!==null&&d.set(m,p),a=a.add(m)}}),i.push(this.documentOverlayCache.saveOverlays(t,c,d))}return xe.waitFor(i)}).next(()=>n)}recalculateAndSaveOverlaysForDocumentKeys(t,r){return this.remoteDocumentCache.getEntries(t,r).next(n=>this.recalculateAndSaveOverlays(t,n))}getDocumentsMatchingQuery(t,r,n,s){return function(i){return Pe.isDocumentKey(i.path)&&i.collectionGroup===null&&i.filters.length===0}(r)?this.getDocumentsMatchingDocumentQuery(t,r.path):Lk(r)?this.getDocumentsMatchingCollectionGroupQuery(t,r,n,s):this.getDocumentsMatchingCollectionQuery(t,r,n,s)}getNextDocuments(t,r,n,s){return this.remoteDocumentCache.getAllFromCollectionGroup(t,r,n,s).next(a=>{const i=s-a.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(t,r,n.largestBatchId,s-a.size):xe.resolve(Pi());let o=-1,l=a;return i.next(c=>xe.forEach(c,(u,d)=>(o<d.largestBatchId&&(o=d.largestBatchId),a.get(u)?xe.resolve():this.remoteDocumentCache.getEntry(t,u).next(m=>{l=l.insert(u,m)}))).next(()=>this.populateOverlays(t,c,a)).next(()=>this.computeViews(t,l,c,Xe())).next(u=>({batchId:o,changes:Bk(u)})))})}getDocumentsMatchingDocumentQuery(t,r){return this.getDocument(t,new Pe(r)).next(n=>{let s=rc();return n.isFoundDocument()&&(s=s.insert(n.key,n)),s})}getDocumentsMatchingCollectionGroupQuery(t,r,n,s){const a=r.collectionGroup;let i=rc();return this.indexManager.getCollectionParents(t,a).next(o=>xe.forEach(o,l=>{const c=function(d,m){return new bu(m,null,d.explicitOrderBy.slice(),d.filters.slice(),d.limit,d.limitType,d.startAt,d.endAt)}(r,l.child(a));return this.getDocumentsMatchingCollectionQuery(t,c,n,s).next(u=>{u.forEach((d,m)=>{i=i.insert(d,m)})})}).next(()=>i))}getDocumentsMatchingCollectionQuery(t,r,n,s){let a;return this.documentOverlayCache.getOverlaysForCollection(t,r.path,n.largestBatchId).next(i=>(a=i,this.remoteDocumentCache.getDocumentsMatchingQuery(t,r,n,a,s))).next(i=>{a.forEach((l,c)=>{const u=c.getKey();i.get(u)===null&&(i=i.insert(u,Vr.newInvalidDocument(u)))});let o=rc();return i.forEach((l,c)=>{const u=a.get(l);u!==void 0&&Ec(u.mutation,c,Tn.empty(),ar.now()),jd(r,c)&&(o=o.insert(l,c))}),o})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iO{constructor(t){this.serializer=t,this.hr=new Map,this.Pr=new Map}getBundleMetadata(t,r){return xe.resolve(this.hr.get(r))}saveBundleMetadata(t,r){return this.hr.set(r.id,function(s){return{id:s.id,version:s.version,createTime:As(s.createTime)}}(r)),xe.resolve()}getNamedQuery(t,r){return xe.resolve(this.Pr.get(r))}saveNamedQuery(t,r){return this.Pr.set(r.name,function(s){return{name:s.name,query:eO(s.bundledQuery),readTime:As(s.readTime)}}(r)),xe.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oO{constructor(){this.overlays=new Lt(Pe.comparator),this.Ir=new Map}getOverlay(t,r){return xe.resolve(this.overlays.get(r))}getOverlays(t,r){const n=Pi();return xe.forEach(r,s=>this.getOverlay(t,s).next(a=>{a!==null&&n.set(s,a)})).next(()=>n)}saveOverlays(t,r,n){return n.forEach((s,a)=>{this.ht(t,r,a)}),xe.resolve()}removeOverlaysForBatchId(t,r,n){const s=this.Ir.get(n);return s!==void 0&&(s.forEach(a=>this.overlays=this.overlays.remove(a)),this.Ir.delete(n)),xe.resolve()}getOverlaysForCollection(t,r,n){const s=Pi(),a=r.length+1,i=new Pe(r.child("")),o=this.overlays.getIteratorFrom(i);for(;o.hasNext();){const l=o.getNext().value,c=l.getKey();if(!r.isPrefixOf(c.path))break;c.path.length===a&&l.largestBatchId>n&&s.set(l.getKey(),l)}return xe.resolve(s)}getOverlaysForCollectionGroup(t,r,n,s){let a=new Lt((c,u)=>c-u);const i=this.overlays.getIterator();for(;i.hasNext();){const c=i.getNext().value;if(c.getKey().getCollectionGroup()===r&&c.largestBatchId>n){let u=a.get(c.largestBatchId);u===null&&(u=Pi(),a=a.insert(c.largestBatchId,u)),u.set(c.getKey(),c)}}const o=Pi(),l=a.getIterator();for(;l.hasNext()&&(l.getNext().value.forEach((c,u)=>o.set(c,u)),!(o.size()>=s)););return xe.resolve(o)}ht(t,r,n){const s=this.overlays.get(n.key);if(s!==null){const i=this.Ir.get(s.largestBatchId).delete(n.key);this.Ir.set(s.largestBatchId,i)}this.overlays=this.overlays.insert(n.key,new RF(r,n));let a=this.Ir.get(r);a===void 0&&(a=Xe(),this.Ir.set(r,a)),this.Ir.set(r,a.add(n.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lO{constructor(){this.sessionToken=Cr.EMPTY_BYTE_STRING}getSessionToken(t){return xe.resolve(this.sessionToken)}setSessionToken(t,r){return this.sessionToken=r,xe.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xv{constructor(){this.Tr=new Er(ur.Er),this.dr=new Er(ur.Ar)}isEmpty(){return this.Tr.isEmpty()}addReference(t,r){const n=new ur(t,r);this.Tr=this.Tr.add(n),this.dr=this.dr.add(n)}Rr(t,r){t.forEach(n=>this.addReference(n,r))}removeReference(t,r){this.Vr(new ur(t,r))}mr(t,r){t.forEach(n=>this.removeReference(n,r))}gr(t){const r=new Pe(new Ct([])),n=new ur(r,t),s=new ur(r,t+1),a=[];return this.dr.forEachInRange([n,s],i=>{this.Vr(i),a.push(i.key)}),a}pr(){this.Tr.forEach(t=>this.Vr(t))}Vr(t){this.Tr=this.Tr.delete(t),this.dr=this.dr.delete(t)}yr(t){const r=new Pe(new Ct([])),n=new ur(r,t),s=new ur(r,t+1);let a=Xe();return this.dr.forEachInRange([n,s],i=>{a=a.add(i.key)}),a}containsKey(t){const r=new ur(t,0),n=this.Tr.firstAfterOrEqual(r);return n!==null&&t.isEqual(n.key)}}class ur{constructor(t,r){this.key=t,this.wr=r}static Er(t,r){return Pe.comparator(t.key,r.key)||ut(t.wr,r.wr)}static Ar(t,r){return ut(t.wr,r.wr)||Pe.comparator(t.key,r.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cO{constructor(t,r){this.indexManager=t,this.referenceDelegate=r,this.mutationQueue=[],this.Sr=1,this.br=new Er(ur.Er)}checkEmpty(t){return xe.resolve(this.mutationQueue.length===0)}addMutationBatch(t,r,n,s){const a=this.Sr;this.Sr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const i=new NF(a,r,n,s);this.mutationQueue.push(i);for(const o of s)this.br=this.br.add(new ur(o.key,a)),this.indexManager.addToCollectionParentIndex(t,o.key.path.popLast());return xe.resolve(i)}lookupMutationBatch(t,r){return xe.resolve(this.Dr(r))}getNextMutationBatchAfterBatchId(t,r){const n=r+1,s=this.vr(n),a=s<0?0:s;return xe.resolve(this.mutationQueue.length>a?this.mutationQueue[a]:null)}getHighestUnacknowledgedBatchId(){return xe.resolve(this.mutationQueue.length===0?-1:this.Sr-1)}getAllMutationBatches(t){return xe.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(t,r){const n=new ur(r,0),s=new ur(r,Number.POSITIVE_INFINITY),a=[];return this.br.forEachInRange([n,s],i=>{const o=this.Dr(i.wr);a.push(o)}),xe.resolve(a)}getAllMutationBatchesAffectingDocumentKeys(t,r){let n=new Er(ut);return r.forEach(s=>{const a=new ur(s,0),i=new ur(s,Number.POSITIVE_INFINITY);this.br.forEachInRange([a,i],o=>{n=n.add(o.wr)})}),xe.resolve(this.Cr(n))}getAllMutationBatchesAffectingQuery(t,r){const n=r.path,s=n.length+1;let a=n;Pe.isDocumentKey(a)||(a=a.child(""));const i=new ur(new Pe(a),0);let o=new Er(ut);return this.br.forEachWhile(l=>{const c=l.key.path;return!!n.isPrefixOf(c)&&(c.length===s&&(o=o.add(l.wr)),!0)},i),xe.resolve(this.Cr(o))}Cr(t){const r=[];return t.forEach(n=>{const s=this.Dr(n);s!==null&&r.push(s)}),r}removeMutationBatch(t,r){vt(this.Fr(r.batchId,"removed")===0),this.mutationQueue.shift();let n=this.br;return xe.forEach(r.mutations,s=>{const a=new ur(s.key,r.batchId);return n=n.delete(a),this.referenceDelegate.markPotentiallyOrphaned(t,s.key)}).next(()=>{this.br=n})}On(t){}containsKey(t,r){const n=new ur(r,0),s=this.br.firstAfterOrEqual(n);return xe.resolve(r.isEqual(s&&s.key))}performConsistencyCheck(t){return this.mutationQueue.length,xe.resolve()}Fr(t,r){return this.vr(t)}vr(t){return this.mutationQueue.length===0?0:t-this.mutationQueue[0].batchId}Dr(t){const r=this.vr(t);return r<0||r>=this.mutationQueue.length?null:this.mutationQueue[r]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uO{constructor(t){this.Mr=t,this.docs=function(){return new Lt(Pe.comparator)}(),this.size=0}setIndexManager(t){this.indexManager=t}addEntry(t,r){const n=r.key,s=this.docs.get(n),a=s?s.size:0,i=this.Mr(r);return this.docs=this.docs.insert(n,{document:r.mutableCopy(),size:i}),this.size+=i-a,this.indexManager.addToCollectionParentIndex(t,n.path.popLast())}removeEntry(t){const r=this.docs.get(t);r&&(this.docs=this.docs.remove(t),this.size-=r.size)}getEntry(t,r){const n=this.docs.get(r);return xe.resolve(n?n.document.mutableCopy():Vr.newInvalidDocument(r))}getEntries(t,r){let n=ma();return r.forEach(s=>{const a=this.docs.get(s);n=n.insert(s,a?a.document.mutableCopy():Vr.newInvalidDocument(s))}),xe.resolve(n)}getDocumentsMatchingQuery(t,r,n,s){let a=ma();const i=r.path,o=new Pe(i.child("")),l=this.docs.getIteratorFrom(o);for(;l.hasNext();){const{key:c,value:{document:u}}=l.getNext();if(!i.isPrefixOf(c.path))break;c.path.length>i.length+1||q3(K3(u),n)<=0||(s.has(u.key)||jd(r,u))&&(a=a.insert(u.key,u.mutableCopy()))}return xe.resolve(a)}getAllFromCollectionGroup(t,r,n,s){Le()}Or(t,r){return xe.forEach(this.docs,n=>r(n))}newChangeBuffer(t){return new fO(this)}getSize(t){return xe.resolve(this.size)}}class fO extends nO{constructor(t){super(),this.cr=t}applyChanges(t){const r=[];return this.changes.forEach((n,s)=>{s.isValidDocument()?r.push(this.cr.addEntry(t,s)):this.cr.removeEntry(n)}),xe.waitFor(r)}getFromCache(t,r){return this.cr.getEntry(t,r)}getAllFromCache(t,r){return this.cr.getEntries(t,r)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hO{constructor(t){this.persistence=t,this.Nr=new kl(r=>fv(r),hv),this.lastRemoteSnapshotVersion=Ve.min(),this.highestTargetId=0,this.Lr=0,this.Br=new xv,this.targetCount=0,this.kr=dl.Bn()}forEachTarget(t,r){return this.Nr.forEach((n,s)=>r(s)),xe.resolve()}getLastRemoteSnapshotVersion(t){return xe.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(t){return xe.resolve(this.Lr)}allocateTargetId(t){return this.highestTargetId=this.kr.next(),xe.resolve(this.highestTargetId)}setTargetsMetadata(t,r,n){return n&&(this.lastRemoteSnapshotVersion=n),r>this.Lr&&(this.Lr=r),xe.resolve()}Kn(t){this.Nr.set(t.target,t);const r=t.targetId;r>this.highestTargetId&&(this.kr=new dl(r),this.highestTargetId=r),t.sequenceNumber>this.Lr&&(this.Lr=t.sequenceNumber)}addTargetData(t,r){return this.Kn(r),this.targetCount+=1,xe.resolve()}updateTargetData(t,r){return this.Kn(r),xe.resolve()}removeTargetData(t,r){return this.Nr.delete(r.target),this.Br.gr(r.targetId),this.targetCount-=1,xe.resolve()}removeTargets(t,r,n){let s=0;const a=[];return this.Nr.forEach((i,o)=>{o.sequenceNumber<=r&&n.get(o.targetId)===null&&(this.Nr.delete(i),a.push(this.removeMatchingKeysForTargetId(t,o.targetId)),s++)}),xe.waitFor(a).next(()=>s)}getTargetCount(t){return xe.resolve(this.targetCount)}getTargetData(t,r){const n=this.Nr.get(r)||null;return xe.resolve(n)}addMatchingKeys(t,r,n){return this.Br.Rr(r,n),xe.resolve()}removeMatchingKeys(t,r,n){this.Br.mr(r,n);const s=this.persistence.referenceDelegate,a=[];return s&&r.forEach(i=>{a.push(s.markPotentiallyOrphaned(t,i))}),xe.waitFor(a)}removeMatchingKeysForTargetId(t,r){return this.Br.gr(r),xe.resolve()}getMatchingKeysForTargetId(t,r){const n=this.Br.yr(r);return xe.resolve(n)}containsKey(t,r){return xe.resolve(this.Br.containsKey(r))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dO{constructor(t,r){this.qr={},this.overlays={},this.Qr=new ov(0),this.Kr=!1,this.Kr=!0,this.$r=new lO,this.referenceDelegate=t(this),this.Ur=new hO(this),this.indexManager=new tO,this.remoteDocumentCache=function(s){return new uO(s)}(n=>this.referenceDelegate.Wr(n)),this.serializer=new ZF(r),this.Gr=new iO(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.Kr=!1,Promise.resolve()}get started(){return this.Kr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(t){return this.indexManager}getDocumentOverlayCache(t){let r=this.overlays[t.toKey()];return r||(r=new oO,this.overlays[t.toKey()]=r),r}getMutationQueue(t,r){let n=this.qr[t.toKey()];return n||(n=new cO(r,this.referenceDelegate),this.qr[t.toKey()]=n),n}getGlobalsCache(){return this.$r}getTargetCache(){return this.Ur}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Gr}runTransaction(t,r,n){be("MemoryPersistence","Starting transaction:",t);const s=new mO(this.Qr.next());return this.referenceDelegate.zr(),n(s).next(a=>this.referenceDelegate.jr(s).next(()=>a)).toPromise().then(a=>(s.raiseOnCommittedEvent(),a))}Hr(t,r){return xe.or(Object.values(this.qr).map(n=>()=>n.containsKey(t,r)))}}class mO extends Y3{constructor(t){super(),this.currentSequenceNumber=t}}class yv{constructor(t){this.persistence=t,this.Jr=new xv,this.Yr=null}static Zr(t){return new yv(t)}get Xr(){if(this.Yr)return this.Yr;throw Le()}addReference(t,r,n){return this.Jr.addReference(n,r),this.Xr.delete(n.toString()),xe.resolve()}removeReference(t,r,n){return this.Jr.removeReference(n,r),this.Xr.add(n.toString()),xe.resolve()}markPotentiallyOrphaned(t,r){return this.Xr.add(r.toString()),xe.resolve()}removeTarget(t,r){this.Jr.gr(r.targetId).forEach(s=>this.Xr.add(s.toString()));const n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(t,r.targetId).next(s=>{s.forEach(a=>this.Xr.add(a.toString()))}).next(()=>n.removeTargetData(t,r))}zr(){this.Yr=new Set}jr(t){const r=this.persistence.getRemoteDocumentCache().newChangeBuffer();return xe.forEach(this.Xr,n=>{const s=Pe.fromPath(n);return this.ei(t,s).next(a=>{a||r.removeEntry(s,Ve.min())})}).next(()=>(this.Yr=null,r.apply(t)))}updateLimboDocument(t,r){return this.ei(t,r).next(n=>{n?this.Xr.delete(r.toString()):this.Xr.add(r.toString())})}Wr(t){return 0}ei(t,r){return xe.or([()=>xe.resolve(this.Jr.containsKey(r)),()=>this.persistence.getTargetCache().containsKey(t,r),()=>this.persistence.Hr(t,r)])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _v{constructor(t,r,n,s){this.targetId=t,this.fromCache=r,this.$i=n,this.Ui=s}static Wi(t,r){let n=Xe(),s=Xe();for(const a of r.docChanges)switch(a.type){case 0:n=n.add(a.doc.key);break;case 1:s=s.add(a.doc.key)}return new _v(t,r.fromCache,n,s)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pO{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(t){this._documentReadCount+=t}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gO{constructor(){this.Gi=!1,this.zi=!1,this.ji=100,this.Hi=function(){return Tb()?8:Q3(Hr())>0?6:4}()}initialize(t,r){this.Ji=t,this.indexManager=r,this.Gi=!0}getDocumentsMatchingQuery(t,r,n,s){const a={result:null};return this.Yi(t,r).next(i=>{a.result=i}).next(()=>{if(!a.result)return this.Zi(t,r,s,n).next(i=>{a.result=i})}).next(()=>{if(a.result)return;const i=new pO;return this.Xi(t,r,i).next(o=>{if(a.result=o,this.zi)return this.es(t,r,i,o.size)})}).next(()=>a.result)}es(t,r,n,s){return n.documentReadCount<this.ji?(Xl()<=Ye.DEBUG&&be("QueryEngine","SDK will not create cache indexes for query:",Eo(r),"since it only creates cache indexes for collection contains","more than or equal to",this.ji,"documents"),xe.resolve()):(Xl()<=Ye.DEBUG&&be("QueryEngine","Query:",Eo(r),"scans",n.documentReadCount,"local documents and returns",s,"documents as results."),n.documentReadCount>this.Hi*s?(Xl()<=Ye.DEBUG&&be("QueryEngine","The SDK decides to create cache indexes for query:",Eo(r),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(t,Ss(r))):xe.resolve())}Yi(t,r){if(o_(r))return xe.resolve(null);let n=Ss(r);return this.indexManager.getIndexType(t,n).next(s=>s===0?null:(r.limit!==null&&s===1&&(r=_p(r,null,"F"),n=Ss(r)),this.indexManager.getDocumentsMatchingTarget(t,n).next(a=>{const i=Xe(...a);return this.Ji.getDocuments(t,i).next(o=>this.indexManager.getMinOffset(t,n).next(l=>{const c=this.ts(r,o);return this.ns(r,c,i,l.readTime)?this.Yi(t,_p(r,null,"F")):this.rs(t,c,r,l)}))})))}Zi(t,r,n,s){return o_(r)||s.isEqual(Ve.min())?xe.resolve(null):this.Ji.getDocuments(t,n).next(a=>{const i=this.ts(r,a);return this.ns(r,i,n,s)?xe.resolve(null):(Xl()<=Ye.DEBUG&&be("QueryEngine","Re-using previous result from %s to execute query: %s",s.toString(),Eo(r)),this.rs(t,i,r,G3(s,-1)).next(o=>o))})}ts(t,r){let n=new Er(Vk(t));return r.forEach((s,a)=>{jd(t,a)&&(n=n.add(a))}),n}ns(t,r,n,s){if(t.limit===null)return!1;if(n.size!==r.size)return!0;const a=t.limitType==="F"?r.last():r.first();return!!a&&(a.hasPendingWrites||a.version.compareTo(s)>0)}Xi(t,r,n){return Xl()<=Ye.DEBUG&&be("QueryEngine","Using full collection scan to execute query:",Eo(r)),this.Ji.getDocumentsMatchingQuery(t,r,ii.min(),n)}rs(t,r,n,s){return this.Ji.getDocumentsMatchingQuery(t,n,s).next(a=>(r.forEach(i=>{a=a.insert(i.key,i)}),a))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vO{constructor(t,r,n,s){this.persistence=t,this.ss=r,this.serializer=s,this.os=new Lt(ut),this._s=new kl(a=>fv(a),hv),this.us=new Map,this.cs=t.getRemoteDocumentCache(),this.Ur=t.getTargetCache(),this.Gr=t.getBundleCache(),this.ls(n)}ls(t){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(t),this.indexManager=this.persistence.getIndexManager(t),this.mutationQueue=this.persistence.getMutationQueue(t,this.indexManager),this.localDocuments=new aO(this.cs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.cs.setIndexManager(this.indexManager),this.ss.initialize(this.localDocuments,this.indexManager)}collectGarbage(t){return this.persistence.runTransaction("Collect garbage","readwrite-primary",r=>t.collect(r,this.os))}}function xO(e,t,r,n){return new vO(e,t,r,n)}async function lS(e,t){const r=Be(e);return await r.persistence.runTransaction("Handle user change","readonly",n=>{let s;return r.mutationQueue.getAllMutationBatches(n).next(a=>(s=a,r.ls(t),r.mutationQueue.getAllMutationBatches(n))).next(a=>{const i=[],o=[];let l=Xe();for(const c of s){i.push(c.batchId);for(const u of c.mutations)l=l.add(u.key)}for(const c of a){o.push(c.batchId);for(const u of c.mutations)l=l.add(u.key)}return r.localDocuments.getDocuments(n,l).next(c=>({hs:c,removedBatchIds:i,addedBatchIds:o}))})})}function yO(e,t){const r=Be(e);return r.persistence.runTransaction("Acknowledge batch","readwrite-primary",n=>{const s=t.batch.keys(),a=r.cs.newChangeBuffer({trackRemovals:!0});return function(o,l,c,u){const d=c.batch,m=d.keys();let p=xe.resolve();return m.forEach(g=>{p=p.next(()=>u.getEntry(l,g)).next(x=>{const w=c.docVersions.get(g);vt(w!==null),x.version.compareTo(w)<0&&(d.applyToRemoteDocument(x,c),x.isValidDocument()&&(x.setReadTime(c.commitVersion),u.addEntry(x)))})}),p.next(()=>o.mutationQueue.removeMutationBatch(l,d))}(r,n,t,a).next(()=>a.apply(n)).next(()=>r.mutationQueue.performConsistencyCheck(n)).next(()=>r.documentOverlayCache.removeOverlaysForBatchId(n,s,t.batch.batchId)).next(()=>r.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(n,function(o){let l=Xe();for(let c=0;c<o.mutationResults.length;++c)o.mutationResults[c].transformResults.length>0&&(l=l.add(o.batch.mutations[c].key));return l}(t))).next(()=>r.localDocuments.getDocuments(n,s))})}function cS(e){const t=Be(e);return t.persistence.runTransaction("Get last remote snapshot version","readonly",r=>t.Ur.getLastRemoteSnapshotVersion(r))}function _O(e,t){const r=Be(e),n=t.snapshotVersion;let s=r.os;return r.persistence.runTransaction("Apply remote event","readwrite-primary",a=>{const i=r.cs.newChangeBuffer({trackRemovals:!0});s=r.os;const o=[];t.targetChanges.forEach((u,d)=>{const m=s.get(d);if(!m)return;o.push(r.Ur.removeMatchingKeys(a,u.removedDocuments,d).next(()=>r.Ur.addMatchingKeys(a,u.addedDocuments,d)));let p=m.withSequenceNumber(a.currentSequenceNumber);t.targetMismatches.get(d)!==null?p=p.withResumeToken(Cr.EMPTY_BYTE_STRING,Ve.min()).withLastLimboFreeSnapshotVersion(Ve.min()):u.resumeToken.approximateByteSize()>0&&(p=p.withResumeToken(u.resumeToken,n)),s=s.insert(d,p),function(x,w,k){return x.resumeToken.approximateByteSize()===0||w.snapshotVersion.toMicroseconds()-x.snapshotVersion.toMicroseconds()>=3e8?!0:k.addedDocuments.size+k.modifiedDocuments.size+k.removedDocuments.size>0}(m,p,u)&&o.push(r.Ur.updateTargetData(a,p))});let l=ma(),c=Xe();if(t.documentUpdates.forEach(u=>{t.resolvedLimboDocuments.has(u)&&o.push(r.persistence.referenceDelegate.updateLimboDocument(a,u))}),o.push(wO(a,i,t.documentUpdates).next(u=>{l=u.Ps,c=u.Is})),!n.isEqual(Ve.min())){const u=r.Ur.getLastRemoteSnapshotVersion(a).next(d=>r.Ur.setTargetsMetadata(a,a.currentSequenceNumber,n));o.push(u)}return xe.waitFor(o).next(()=>i.apply(a)).next(()=>r.localDocuments.getLocalViewOfDocuments(a,l,c)).next(()=>l)}).then(a=>(r.os=s,a))}function wO(e,t,r){let n=Xe(),s=Xe();return r.forEach(a=>n=n.add(a)),t.getEntries(e,n).next(a=>{let i=ma();return r.forEach((o,l)=>{const c=a.get(o);l.isFoundDocument()!==c.isFoundDocument()&&(s=s.add(o)),l.isNoDocument()&&l.version.isEqual(Ve.min())?(t.removeEntry(o,l.readTime),i=i.insert(o,l)):!c.isValidDocument()||l.version.compareTo(c.version)>0||l.version.compareTo(c.version)===0&&c.hasPendingWrites?(t.addEntry(l),i=i.insert(o,l)):be("LocalStore","Ignoring outdated watch update for ",o,". Current version:",c.version," Watch version:",l.version)}),{Ps:i,Is:s}})}function EO(e,t){const r=Be(e);return r.persistence.runTransaction("Get next mutation batch","readonly",n=>(t===void 0&&(t=-1),r.mutationQueue.getNextMutationBatchAfterBatchId(n,t)))}function TO(e,t){const r=Be(e);return r.persistence.runTransaction("Allocate target","readwrite",n=>{let s;return r.Ur.getTargetData(n,t).next(a=>a?(s=a,xe.resolve(s)):r.Ur.allocateTargetId(n).next(i=>(s=new Ua(t,i,"TargetPurposeListen",n.currentSequenceNumber),r.Ur.addTargetData(n,s).next(()=>s))))}).then(n=>{const s=r.os.get(n.targetId);return(s===null||n.snapshotVersion.compareTo(s.snapshotVersion)>0)&&(r.os=r.os.insert(n.targetId,n),r._s.set(t,n.targetId)),n})}async function Sp(e,t,r){const n=Be(e),s=n.os.get(t),a=r?"readwrite":"readwrite-primary";try{r||await n.persistence.runTransaction("Release target",a,i=>n.persistence.referenceDelegate.removeTarget(i,s))}catch(i){if(!Ru(i))throw i;be("LocalStore",`Failed to update sequence numbers for target ${t}: ${i}`)}n.os=n.os.remove(t),n._s.delete(s.target)}function x_(e,t,r){const n=Be(e);let s=Ve.min(),a=Xe();return n.persistence.runTransaction("Execute query","readwrite",i=>function(l,c,u){const d=Be(l),m=d._s.get(u);return m!==void 0?xe.resolve(d.os.get(m)):d.Ur.getTargetData(c,u)}(n,i,Ss(t)).next(o=>{if(o)return s=o.lastLimboFreeSnapshotVersion,n.Ur.getMatchingKeysForTargetId(i,o.targetId).next(l=>{a=l})}).next(()=>n.ss.getDocumentsMatchingQuery(i,t,r?s:Ve.min(),r?a:Xe())).next(o=>(kO(n,pF(t),o),{documents:o,Ts:a})))}function kO(e,t,r){let n=e.us.get(t)||Ve.min();r.forEach((s,a)=>{a.readTime.compareTo(n)>0&&(n=a.readTime)}),e.us.set(t,n)}class y_{constructor(){this.activeTargetIds=wF()}fs(t){this.activeTargetIds=this.activeTargetIds.add(t)}gs(t){this.activeTargetIds=this.activeTargetIds.delete(t)}Vs(){const t={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(t)}}class SO{constructor(){this.so=new y_,this.oo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(t){}updateMutationState(t,r,n){}addLocalQueryTarget(t,r=!0){return r&&this.so.fs(t),this.oo[t]||"not-current"}updateQueryState(t,r,n){this.oo[t]=r}removeLocalQueryTarget(t){this.so.gs(t)}isLocalQueryTarget(t){return this.so.activeTargetIds.has(t)}clearQueryState(t){delete this.oo[t]}getAllActiveQueryTargets(){return this.so.activeTargetIds}isActiveQueryTarget(t){return this.so.activeTargetIds.has(t)}start(){return this.so=new y_,Promise.resolve()}handleUserChange(t,r,n){}setOnlineState(t){}shutdown(){}writeSequenceNumber(t){}notifyBundleLoaded(t){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AO{_o(t){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class __{constructor(){this.ao=()=>this.uo(),this.co=()=>this.lo(),this.ho=[],this.Po()}_o(t){this.ho.push(t)}shutdown(){window.removeEventListener("online",this.ao),window.removeEventListener("offline",this.co)}Po(){window.addEventListener("online",this.ao),window.addEventListener("offline",this.co)}uo(){be("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const t of this.ho)t(0)}lo(){be("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const t of this.ho)t(1)}static D(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Af=null;function X0(){return Af===null?Af=function(){return 268435456+Math.round(2147483648*Math.random())}():Af++,"0x"+Af.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const IO={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class CO{constructor(t){this.Io=t.Io,this.To=t.To}Eo(t){this.Ao=t}Ro(t){this.Vo=t}mo(t){this.fo=t}onMessage(t){this.po=t}close(){this.To()}send(t){this.Io(t)}yo(){this.Ao()}wo(){this.Vo()}So(t){this.fo(t)}bo(t){this.po(t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Fr="WebChannelConnection";class NO extends class{constructor(r){this.databaseInfo=r,this.databaseId=r.databaseId;const n=r.ssl?"https":"http",s=encodeURIComponent(this.databaseId.projectId),a=encodeURIComponent(this.databaseId.database);this.Do=n+"://"+r.host,this.vo=`projects/${s}/databases/${a}`,this.Co=this.databaseId.database==="(default)"?`project_id=${s}`:`project_id=${s}&database_id=${a}`}get Fo(){return!1}Mo(r,n,s,a,i){const o=X0(),l=this.xo(r,n.toUriEncodedString());be("RestConnection",`Sending RPC '${r}' ${o}:`,l,s);const c={"google-cloud-resource-prefix":this.vo,"x-goog-request-params":this.Co};return this.Oo(c,a,i),this.No(r,l,c,s).then(u=>(be("RestConnection",`Received RPC '${r}' ${o}: `,u),u),u=>{throw cl("RestConnection",`RPC '${r}' ${o} failed with error: `,u,"url: ",l,"request:",s),u})}Lo(r,n,s,a,i,o){return this.Mo(r,n,s,a,i)}Oo(r,n,s){r["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+Tl}(),r["Content-Type"]="text/plain",this.databaseInfo.appId&&(r["X-Firebase-GMPID"]=this.databaseInfo.appId),n&&n.headers.forEach((a,i)=>r[i]=a),s&&s.headers.forEach((a,i)=>r[i]=a)}xo(r,n){const s=IO[r];return`${this.Do}/v1/${n}:${s}`}terminate(){}}{constructor(t){super(t),this.forceLongPolling=t.forceLongPolling,this.autoDetectLongPolling=t.autoDetectLongPolling,this.useFetchStreams=t.useFetchStreams,this.longPollingOptions=t.longPollingOptions}No(t,r,n,s){const a=X0();return new Promise((i,o)=>{const l=new wk;l.setWithCredentials(!0),l.listenOnce(Ek.COMPLETE,()=>{try{switch(l.getLastErrorCode()){case eh.NO_ERROR:const u=l.getResponseJson();be(Fr,`XHR for RPC '${t}' ${a} received:`,JSON.stringify(u)),i(u);break;case eh.TIMEOUT:be(Fr,`RPC '${t}' ${a} timed out`),o(new Re(de.DEADLINE_EXCEEDED,"Request time out"));break;case eh.HTTP_ERROR:const d=l.getStatus();if(be(Fr,`RPC '${t}' ${a} failed with status:`,d,"response text:",l.getResponseText()),d>0){let m=l.getResponseJson();Array.isArray(m)&&(m=m[0]);const p=m==null?void 0:m.error;if(p&&p.status&&p.message){const g=function(w){const k=w.toLowerCase().replace(/_/g,"-");return Object.values(de).indexOf(k)>=0?k:de.UNKNOWN}(p.status);o(new Re(g,p.message))}else o(new Re(de.UNKNOWN,"Server responded with status "+l.getStatus()))}else o(new Re(de.UNAVAILABLE,"Connection failed."));break;default:Le()}}finally{be(Fr,`RPC '${t}' ${a} completed.`)}});const c=JSON.stringify(s);be(Fr,`RPC '${t}' ${a} sending request:`,s),l.send(r,"POST",c,n,15)})}Bo(t,r,n){const s=X0(),a=[this.Do,"/","google.firestore.v1.Firestore","/",t,"/channel"],i=Sk(),o=kk(),l={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},c=this.longPollingOptions.timeoutSeconds;c!==void 0&&(l.longPollingTimeout=Math.round(1e3*c)),this.useFetchStreams&&(l.useFetchStreams=!0),this.Oo(l.initMessageHeaders,r,n),l.encodeInitMessageHeaders=!0;const u=a.join("");be(Fr,`Creating RPC '${t}' stream ${s}: ${u}`,l);const d=i.createWebChannel(u,l);let m=!1,p=!1;const g=new CO({Io:w=>{p?be(Fr,`Not sending because RPC '${t}' stream ${s} is closed:`,w):(m||(be(Fr,`Opening RPC '${t}' stream ${s} transport.`),d.open(),m=!0),be(Fr,`RPC '${t}' stream ${s} sending:`,w),d.send(w))},To:()=>d.close()}),x=(w,k,T)=>{w.listen(k,E=>{try{T(E)}catch(N){setTimeout(()=>{throw N},0)}})};return x(d,tc.EventType.OPEN,()=>{p||(be(Fr,`RPC '${t}' stream ${s} transport opened.`),g.yo())}),x(d,tc.EventType.CLOSE,()=>{p||(p=!0,be(Fr,`RPC '${t}' stream ${s} transport closed`),g.So())}),x(d,tc.EventType.ERROR,w=>{p||(p=!0,cl(Fr,`RPC '${t}' stream ${s} transport errored:`,w),g.So(new Re(de.UNAVAILABLE,"The operation could not be completed")))}),x(d,tc.EventType.MESSAGE,w=>{var k;if(!p){const T=w.data[0];vt(!!T);const E=T,N=E.error||((k=E[0])===null||k===void 0?void 0:k.error);if(N){be(Fr,`RPC '${t}' stream ${s} received error:`,N);const M=N.status;let O=function(S){const I=qt[S];if(I!==void 0)return Jk(I)}(M),v=N.message;O===void 0&&(O=de.INTERNAL,v="Unknown error status: "+M+" with message "+N.message),p=!0,g.So(new Re(O,v)),d.close()}else be(Fr,`RPC '${t}' stream ${s} received:`,T),g.bo(T)}}),x(o,Tk.STAT_EVENT,w=>{w.stat===mp.PROXY?be(Fr,`RPC '${t}' stream ${s} detected buffering proxy`):w.stat===mp.NOPROXY&&be(Fr,`RPC '${t}' stream ${s} detected no buffering proxy`)}),setTimeout(()=>{g.wo()},0),g}}function Y0(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zd(e){return new VF(e,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uS{constructor(t,r,n=1e3,s=1.5,a=6e4){this.ui=t,this.timerId=r,this.ko=n,this.qo=s,this.Qo=a,this.Ko=0,this.$o=null,this.Uo=Date.now(),this.reset()}reset(){this.Ko=0}Wo(){this.Ko=this.Qo}Go(t){this.cancel();const r=Math.floor(this.Ko+this.zo()),n=Math.max(0,Date.now()-this.Uo),s=Math.max(0,r-n);s>0&&be("ExponentialBackoff",`Backing off for ${s} ms (base delay: ${this.Ko} ms, delay with jitter: ${r} ms, last attempt: ${n} ms ago)`),this.$o=this.ui.enqueueAfterDelay(this.timerId,s,()=>(this.Uo=Date.now(),t())),this.Ko*=this.qo,this.Ko<this.ko&&(this.Ko=this.ko),this.Ko>this.Qo&&(this.Ko=this.Qo)}jo(){this.$o!==null&&(this.$o.skipDelay(),this.$o=null)}cancel(){this.$o!==null&&(this.$o.cancel(),this.$o=null)}zo(){return(Math.random()-.5)*this.Ko}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fS{constructor(t,r,n,s,a,i,o,l){this.ui=t,this.Ho=n,this.Jo=s,this.connection=a,this.authCredentialsProvider=i,this.appCheckCredentialsProvider=o,this.listener=l,this.state=0,this.Yo=0,this.Zo=null,this.Xo=null,this.stream=null,this.e_=0,this.t_=new uS(t,r)}n_(){return this.state===1||this.state===5||this.r_()}r_(){return this.state===2||this.state===3}start(){this.e_=0,this.state!==4?this.auth():this.i_()}async stop(){this.n_()&&await this.close(0)}s_(){this.state=0,this.t_.reset()}o_(){this.r_()&&this.Zo===null&&(this.Zo=this.ui.enqueueAfterDelay(this.Ho,6e4,()=>this.__()))}a_(t){this.u_(),this.stream.send(t)}async __(){if(this.r_())return this.close(0)}u_(){this.Zo&&(this.Zo.cancel(),this.Zo=null)}c_(){this.Xo&&(this.Xo.cancel(),this.Xo=null)}async close(t,r){this.u_(),this.c_(),this.t_.cancel(),this.Yo++,t!==4?this.t_.reset():r&&r.code===de.RESOURCE_EXHAUSTED?(da(r.toString()),da("Using maximum backoff delay to prevent overloading the backend."),this.t_.Wo()):r&&r.code===de.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.l_(),this.stream.close(),this.stream=null),this.state=t,await this.listener.mo(r)}l_(){}auth(){this.state=1;const t=this.h_(this.Yo),r=this.Yo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([n,s])=>{this.Yo===r&&this.P_(n,s)},n=>{t(()=>{const s=new Re(de.UNKNOWN,"Fetching auth token failed: "+n.message);return this.I_(s)})})}P_(t,r){const n=this.h_(this.Yo);this.stream=this.T_(t,r),this.stream.Eo(()=>{n(()=>this.listener.Eo())}),this.stream.Ro(()=>{n(()=>(this.state=2,this.Xo=this.ui.enqueueAfterDelay(this.Jo,1e4,()=>(this.r_()&&(this.state=3),Promise.resolve())),this.listener.Ro()))}),this.stream.mo(s=>{n(()=>this.I_(s))}),this.stream.onMessage(s=>{n(()=>++this.e_==1?this.E_(s):this.onNext(s))})}i_(){this.state=5,this.t_.Go(async()=>{this.state=0,this.start()})}I_(t){return be("PersistentStream",`close with error: ${t}`),this.stream=null,this.close(4,t)}h_(t){return r=>{this.ui.enqueueAndForget(()=>this.Yo===t?r():(be("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class RO extends fS{constructor(t,r,n,s,a,i){super(t,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",r,n,s,i),this.serializer=a}T_(t,r){return this.connection.Bo("Listen",t,r)}E_(t){return this.onNext(t)}onNext(t){this.t_.reset();const r=zF(this.serializer,t),n=function(a){if(!("targetChange"in a))return Ve.min();const i=a.targetChange;return i.targetIds&&i.targetIds.length?Ve.min():i.readTime?As(i.readTime):Ve.min()}(t);return this.listener.d_(r,n)}A_(t){const r={};r.database=kp(this.serializer),r.addTarget=function(a,i){let o;const l=i.target;if(o=xp(l)?{documents:HF(a,l)}:{query:GF(a,l)._t},o.targetId=i.targetId,i.resumeToken.approximateByteSize()>0){o.resumeToken=tS(a,i.resumeToken);const c=wp(a,i.expectedCount);c!==null&&(o.expectedCount=c)}else if(i.snapshotVersion.compareTo(Ve.min())>0){o.readTime=Hh(a,i.snapshotVersion.toTimestamp());const c=wp(a,i.expectedCount);c!==null&&(o.expectedCount=c)}return o}(this.serializer,t);const n=qF(this.serializer,t);n&&(r.labels=n),this.a_(r)}R_(t){const r={};r.database=kp(this.serializer),r.removeTarget=t,this.a_(r)}}class bO extends fS{constructor(t,r,n,s,a,i){super(t,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",r,n,s,i),this.serializer=a}get V_(){return this.e_>0}start(){this.lastStreamToken=void 0,super.start()}l_(){this.V_&&this.m_([])}T_(t,r){return this.connection.Bo("Write",t,r)}E_(t){return vt(!!t.streamToken),this.lastStreamToken=t.streamToken,vt(!t.writeResults||t.writeResults.length===0),this.listener.f_()}onNext(t){vt(!!t.streamToken),this.lastStreamToken=t.streamToken,this.t_.reset();const r=WF(t.writeResults,t.commitTime),n=As(t.commitTime);return this.listener.g_(n,r)}p_(){const t={};t.database=kp(this.serializer),this.a_(t)}m_(t){const r={streamToken:this.lastStreamToken,writes:t.map(n=>$F(this.serializer,n))};this.a_(r)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PO extends class{}{constructor(t,r,n,s){super(),this.authCredentials=t,this.appCheckCredentials=r,this.connection=n,this.serializer=s,this.y_=!1}w_(){if(this.y_)throw new Re(de.FAILED_PRECONDITION,"The client has already been terminated.")}Mo(t,r,n,s){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([a,i])=>this.connection.Mo(t,Ep(r,n),s,a,i)).catch(a=>{throw a.name==="FirebaseError"?(a.code===de.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),a):new Re(de.UNKNOWN,a.toString())})}Lo(t,r,n,s,a){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([i,o])=>this.connection.Lo(t,Ep(r,n),s,i,o,a)).catch(i=>{throw i.name==="FirebaseError"?(i.code===de.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),i):new Re(de.UNKNOWN,i.toString())})}terminate(){this.y_=!0,this.connection.terminate()}}class DO{constructor(t,r){this.asyncQueue=t,this.onlineStateHandler=r,this.state="Unknown",this.S_=0,this.b_=null,this.D_=!0}v_(){this.S_===0&&(this.C_("Unknown"),this.b_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.b_=null,this.F_("Backend didn't respond within 10 seconds."),this.C_("Offline"),Promise.resolve())))}M_(t){this.state==="Online"?this.C_("Unknown"):(this.S_++,this.S_>=1&&(this.x_(),this.F_(`Connection failed 1 times. Most recent error: ${t.toString()}`),this.C_("Offline")))}set(t){this.x_(),this.S_=0,t==="Online"&&(this.D_=!1),this.C_(t)}C_(t){t!==this.state&&(this.state=t,this.onlineStateHandler(t))}F_(t){const r=`Could not reach Cloud Firestore backend. ${t}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.D_?(da(r),this.D_=!1):be("OnlineStateTracker",r)}x_(){this.b_!==null&&(this.b_.cancel(),this.b_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FO{constructor(t,r,n,s,a){this.localStore=t,this.datastore=r,this.asyncQueue=n,this.remoteSyncer={},this.O_=[],this.N_=new Map,this.L_=new Set,this.B_=[],this.k_=a,this.k_._o(i=>{n.enqueueAndForget(async()=>{so(this)&&(be("RemoteStore","Restarting streams for network reachability change."),await async function(l){const c=Be(l);c.L_.add(4),await Fu(c),c.q_.set("Unknown"),c.L_.delete(4),await $d(c)}(this))})}),this.q_=new DO(n,s)}}async function $d(e){if(so(e))for(const t of e.B_)await t(!0)}async function Fu(e){for(const t of e.B_)await t(!1)}function hS(e,t){const r=Be(e);r.N_.has(t.targetId)||(r.N_.set(t.targetId,t),kv(r)?Tv(r):Sl(r).r_()&&Ev(r,t))}function wv(e,t){const r=Be(e),n=Sl(r);r.N_.delete(t),n.r_()&&dS(r,t),r.N_.size===0&&(n.r_()?n.o_():so(r)&&r.q_.set("Unknown"))}function Ev(e,t){if(e.Q_.xe(t.targetId),t.resumeToken.approximateByteSize()>0||t.snapshotVersion.compareTo(Ve.min())>0){const r=e.remoteSyncer.getRemoteKeysForTarget(t.targetId).size;t=t.withExpectedCount(r)}Sl(e).A_(t)}function dS(e,t){e.Q_.xe(t),Sl(e).R_(t)}function Tv(e){e.Q_=new OF({getRemoteKeysForTarget:t=>e.remoteSyncer.getRemoteKeysForTarget(t),ot:t=>e.N_.get(t)||null,tt:()=>e.datastore.serializer.databaseId}),Sl(e).start(),e.q_.v_()}function kv(e){return so(e)&&!Sl(e).n_()&&e.N_.size>0}function so(e){return Be(e).L_.size===0}function mS(e){e.Q_=void 0}async function OO(e){e.q_.set("Online")}async function MO(e){e.N_.forEach((t,r)=>{Ev(e,t)})}async function LO(e,t){mS(e),kv(e)?(e.q_.M_(t),Tv(e)):e.q_.set("Unknown")}async function jO(e,t,r){if(e.q_.set("Online"),t instanceof eS&&t.state===2&&t.cause)try{await async function(s,a){const i=a.cause;for(const o of a.targetIds)s.N_.has(o)&&(await s.remoteSyncer.rejectListen(o,i),s.N_.delete(o),s.Q_.removeTarget(o))}(e,t)}catch(n){be("RemoteStore","Failed to remove targets %s: %s ",t.targetIds.join(","),n),await Gh(e,n)}else if(t instanceof nh?e.Q_.Ke(t):t instanceof Zk?e.Q_.He(t):e.Q_.We(t),!r.isEqual(Ve.min()))try{const n=await cS(e.localStore);r.compareTo(n)>=0&&await function(a,i){const o=a.Q_.rt(i);return o.targetChanges.forEach((l,c)=>{if(l.resumeToken.approximateByteSize()>0){const u=a.N_.get(c);u&&a.N_.set(c,u.withResumeToken(l.resumeToken,i))}}),o.targetMismatches.forEach((l,c)=>{const u=a.N_.get(l);if(!u)return;a.N_.set(l,u.withResumeToken(Cr.EMPTY_BYTE_STRING,u.snapshotVersion)),dS(a,l);const d=new Ua(u.target,l,c,u.sequenceNumber);Ev(a,d)}),a.remoteSyncer.applyRemoteEvent(o)}(e,r)}catch(n){be("RemoteStore","Failed to raise snapshot:",n),await Gh(e,n)}}async function Gh(e,t,r){if(!Ru(t))throw t;e.L_.add(1),await Fu(e),e.q_.set("Offline"),r||(r=()=>cS(e.localStore)),e.asyncQueue.enqueueRetryable(async()=>{be("RemoteStore","Retrying IndexedDB access"),await r(),e.L_.delete(1),await $d(e)})}function pS(e,t){return t().catch(r=>Gh(e,r,t))}async function Wd(e){const t=Be(e),r=li(t);let n=t.O_.length>0?t.O_[t.O_.length-1].batchId:-1;for(;VO(t);)try{const s=await EO(t.localStore,n);if(s===null){t.O_.length===0&&r.o_();break}n=s.batchId,UO(t,s)}catch(s){await Gh(t,s)}gS(t)&&vS(t)}function VO(e){return so(e)&&e.O_.length<10}function UO(e,t){e.O_.push(t);const r=li(e);r.r_()&&r.V_&&r.m_(t.mutations)}function gS(e){return so(e)&&!li(e).n_()&&e.O_.length>0}function vS(e){li(e).start()}async function BO(e){li(e).p_()}async function zO(e){const t=li(e);for(const r of e.O_)t.m_(r.mutations)}async function $O(e,t,r){const n=e.O_.shift(),s=pv.from(n,t,r);await pS(e,()=>e.remoteSyncer.applySuccessfulWrite(s)),await Wd(e)}async function WO(e,t){t&&li(e).V_&&await async function(n,s){if(function(i){return PF(i)&&i!==de.ABORTED}(s.code)){const a=n.O_.shift();li(n).s_(),await pS(n,()=>n.remoteSyncer.rejectFailedWrite(a.batchId,s)),await Wd(n)}}(e,t),gS(e)&&vS(e)}async function w_(e,t){const r=Be(e);r.asyncQueue.verifyOperationInProgress(),be("RemoteStore","RemoteStore received new credentials");const n=so(r);r.L_.add(3),await Fu(r),n&&r.q_.set("Unknown"),await r.remoteSyncer.handleCredentialChange(t),r.L_.delete(3),await $d(r)}async function HO(e,t){const r=Be(e);t?(r.L_.delete(2),await $d(r)):t||(r.L_.add(2),await Fu(r),r.q_.set("Unknown"))}function Sl(e){return e.K_||(e.K_=function(r,n,s){const a=Be(r);return a.w_(),new RO(n,a.connection,a.authCredentials,a.appCheckCredentials,a.serializer,s)}(e.datastore,e.asyncQueue,{Eo:OO.bind(null,e),Ro:MO.bind(null,e),mo:LO.bind(null,e),d_:jO.bind(null,e)}),e.B_.push(async t=>{t?(e.K_.s_(),kv(e)?Tv(e):e.q_.set("Unknown")):(await e.K_.stop(),mS(e))})),e.K_}function li(e){return e.U_||(e.U_=function(r,n,s){const a=Be(r);return a.w_(),new bO(n,a.connection,a.authCredentials,a.appCheckCredentials,a.serializer,s)}(e.datastore,e.asyncQueue,{Eo:()=>Promise.resolve(),Ro:BO.bind(null,e),mo:WO.bind(null,e),f_:zO.bind(null,e),g_:$O.bind(null,e)}),e.B_.push(async t=>{t?(e.U_.s_(),await Wd(e)):(await e.U_.stop(),e.O_.length>0&&(be("RemoteStore",`Stopping write stream with ${e.O_.length} pending writes`),e.O_=[]))})),e.U_}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sv{constructor(t,r,n,s,a){this.asyncQueue=t,this.timerId=r,this.targetTimeMs=n,this.op=s,this.removalCallback=a,this.deferred=new ra,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(i=>{})}get promise(){return this.deferred.promise}static createAndSchedule(t,r,n,s,a){const i=Date.now()+n,o=new Sv(t,r,i,s,a);return o.start(n),o}start(t){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),t)}skipDelay(){return this.handleDelayElapsed()}cancel(t){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new Re(de.CANCELLED,"Operation cancelled"+(t?": "+t:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(t=>this.deferred.resolve(t))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Av(e,t){if(da("AsyncQueue",`${t}: ${e}`),Ru(e))return new Re(de.UNAVAILABLE,`${t}: ${e}`);throw e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qo{constructor(t){this.comparator=t?(r,n)=>t(r,n)||Pe.comparator(r.key,n.key):(r,n)=>Pe.comparator(r.key,n.key),this.keyedMap=rc(),this.sortedSet=new Lt(this.comparator)}static emptySet(t){return new qo(t.comparator)}has(t){return this.keyedMap.get(t)!=null}get(t){return this.keyedMap.get(t)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(t){const r=this.keyedMap.get(t);return r?this.sortedSet.indexOf(r):-1}get size(){return this.sortedSet.size}forEach(t){this.sortedSet.inorderTraversal((r,n)=>(t(r),!1))}add(t){const r=this.delete(t.key);return r.copy(r.keyedMap.insert(t.key,t),r.sortedSet.insert(t,null))}delete(t){const r=this.get(t);return r?this.copy(this.keyedMap.remove(t),this.sortedSet.remove(r)):this}isEqual(t){if(!(t instanceof qo)||this.size!==t.size)return!1;const r=this.sortedSet.getIterator(),n=t.sortedSet.getIterator();for(;r.hasNext();){const s=r.getNext().key,a=n.getNext().key;if(!s.isEqual(a))return!1}return!0}toString(){const t=[];return this.forEach(r=>{t.push(r.toString())}),t.length===0?"DocumentSet ()":`DocumentSet (
  `+t.join(`  
`)+`
)`}copy(t,r){const n=new qo;return n.comparator=this.comparator,n.keyedMap=t,n.sortedSet=r,n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class E_{constructor(){this.W_=new Lt(Pe.comparator)}track(t){const r=t.doc.key,n=this.W_.get(r);n?t.type!==0&&n.type===3?this.W_=this.W_.insert(r,t):t.type===3&&n.type!==1?this.W_=this.W_.insert(r,{type:n.type,doc:t.doc}):t.type===2&&n.type===2?this.W_=this.W_.insert(r,{type:2,doc:t.doc}):t.type===2&&n.type===0?this.W_=this.W_.insert(r,{type:0,doc:t.doc}):t.type===1&&n.type===0?this.W_=this.W_.remove(r):t.type===1&&n.type===2?this.W_=this.W_.insert(r,{type:1,doc:n.doc}):t.type===0&&n.type===1?this.W_=this.W_.insert(r,{type:2,doc:t.doc}):Le():this.W_=this.W_.insert(r,t)}G_(){const t=[];return this.W_.inorderTraversal((r,n)=>{t.push(n)}),t}}class ml{constructor(t,r,n,s,a,i,o,l,c){this.query=t,this.docs=r,this.oldDocs=n,this.docChanges=s,this.mutatedKeys=a,this.fromCache=i,this.syncStateChanged=o,this.excludesMetadataChanges=l,this.hasCachedResults=c}static fromInitialDocuments(t,r,n,s,a){const i=[];return r.forEach(o=>{i.push({type:0,doc:o})}),new ml(t,r,qo.emptySet(r),i,n,s,!0,!1,a)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(t){if(!(this.fromCache===t.fromCache&&this.hasCachedResults===t.hasCachedResults&&this.syncStateChanged===t.syncStateChanged&&this.mutatedKeys.isEqual(t.mutatedKeys)&&Ld(this.query,t.query)&&this.docs.isEqual(t.docs)&&this.oldDocs.isEqual(t.oldDocs)))return!1;const r=this.docChanges,n=t.docChanges;if(r.length!==n.length)return!1;for(let s=0;s<r.length;s++)if(r[s].type!==n[s].type||!r[s].doc.isEqual(n[s].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GO{constructor(){this.z_=void 0,this.j_=[]}H_(){return this.j_.some(t=>t.J_())}}class KO{constructor(){this.queries=T_(),this.onlineState="Unknown",this.Y_=new Set}terminate(){(function(r,n){const s=Be(r),a=s.queries;s.queries=T_(),a.forEach((i,o)=>{for(const l of o.j_)l.onError(n)})})(this,new Re(de.ABORTED,"Firestore shutting down"))}}function T_(){return new kl(e=>jk(e),Ld)}async function Iv(e,t){const r=Be(e);let n=3;const s=t.query;let a=r.queries.get(s);a?!a.H_()&&t.J_()&&(n=2):(a=new GO,n=t.J_()?0:1);try{switch(n){case 0:a.z_=await r.onListen(s,!0);break;case 1:a.z_=await r.onListen(s,!1);break;case 2:await r.onFirstRemoteStoreListen(s)}}catch(i){const o=Av(i,`Initialization of query '${Eo(t.query)}' failed`);return void t.onError(o)}r.queries.set(s,a),a.j_.push(t),t.Z_(r.onlineState),a.z_&&t.X_(a.z_)&&Nv(r)}async function Cv(e,t){const r=Be(e),n=t.query;let s=3;const a=r.queries.get(n);if(a){const i=a.j_.indexOf(t);i>=0&&(a.j_.splice(i,1),a.j_.length===0?s=t.J_()?0:1:!a.H_()&&t.J_()&&(s=2))}switch(s){case 0:return r.queries.delete(n),r.onUnlisten(n,!0);case 1:return r.queries.delete(n),r.onUnlisten(n,!1);case 2:return r.onLastRemoteStoreUnlisten(n);default:return}}function qO(e,t){const r=Be(e);let n=!1;for(const s of t){const a=s.query,i=r.queries.get(a);if(i){for(const o of i.j_)o.X_(s)&&(n=!0);i.z_=s}}n&&Nv(r)}function XO(e,t,r){const n=Be(e),s=n.queries.get(t);if(s)for(const a of s.j_)a.onError(r);n.queries.delete(t)}function Nv(e){e.Y_.forEach(t=>{t.next()})}var Ap,k_;(k_=Ap||(Ap={})).ea="default",k_.Cache="cache";class Rv{constructor(t,r,n){this.query=t,this.ta=r,this.na=!1,this.ra=null,this.onlineState="Unknown",this.options=n||{}}X_(t){if(!this.options.includeMetadataChanges){const n=[];for(const s of t.docChanges)s.type!==3&&n.push(s);t=new ml(t.query,t.docs,t.oldDocs,n,t.mutatedKeys,t.fromCache,t.syncStateChanged,!0,t.hasCachedResults)}let r=!1;return this.na?this.ia(t)&&(this.ta.next(t),r=!0):this.sa(t,this.onlineState)&&(this.oa(t),r=!0),this.ra=t,r}onError(t){this.ta.error(t)}Z_(t){this.onlineState=t;let r=!1;return this.ra&&!this.na&&this.sa(this.ra,t)&&(this.oa(this.ra),r=!0),r}sa(t,r){if(!t.fromCache||!this.J_())return!0;const n=r!=="Offline";return(!this.options._a||!n)&&(!t.docs.isEmpty()||t.hasCachedResults||r==="Offline")}ia(t){if(t.docChanges.length>0)return!0;const r=this.ra&&this.ra.hasPendingWrites!==t.hasPendingWrites;return!(!t.syncStateChanged&&!r)&&this.options.includeMetadataChanges===!0}oa(t){t=ml.fromInitialDocuments(t.query,t.docs,t.mutatedKeys,t.fromCache,t.hasCachedResults),this.na=!0,this.ta.next(t)}J_(){return this.options.source!==Ap.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xS{constructor(t){this.key=t}}class yS{constructor(t){this.key=t}}class YO{constructor(t,r){this.query=t,this.Ta=r,this.Ea=null,this.hasCachedResults=!1,this.current=!1,this.da=Xe(),this.mutatedKeys=Xe(),this.Aa=Vk(t),this.Ra=new qo(this.Aa)}get Va(){return this.Ta}ma(t,r){const n=r?r.fa:new E_,s=r?r.Ra:this.Ra;let a=r?r.mutatedKeys:this.mutatedKeys,i=s,o=!1;const l=this.query.limitType==="F"&&s.size===this.query.limit?s.last():null,c=this.query.limitType==="L"&&s.size===this.query.limit?s.first():null;if(t.inorderTraversal((u,d)=>{const m=s.get(u),p=jd(this.query,d)?d:null,g=!!m&&this.mutatedKeys.has(m.key),x=!!p&&(p.hasLocalMutations||this.mutatedKeys.has(p.key)&&p.hasCommittedMutations);let w=!1;m&&p?m.data.isEqual(p.data)?g!==x&&(n.track({type:3,doc:p}),w=!0):this.ga(m,p)||(n.track({type:2,doc:p}),w=!0,(l&&this.Aa(p,l)>0||c&&this.Aa(p,c)<0)&&(o=!0)):!m&&p?(n.track({type:0,doc:p}),w=!0):m&&!p&&(n.track({type:1,doc:m}),w=!0,(l||c)&&(o=!0)),w&&(p?(i=i.add(p),a=x?a.add(u):a.delete(u)):(i=i.delete(u),a=a.delete(u)))}),this.query.limit!==null)for(;i.size>this.query.limit;){const u=this.query.limitType==="F"?i.last():i.first();i=i.delete(u.key),a=a.delete(u.key),n.track({type:1,doc:u})}return{Ra:i,fa:n,ns:o,mutatedKeys:a}}ga(t,r){return t.hasLocalMutations&&r.hasCommittedMutations&&!r.hasLocalMutations}applyChanges(t,r,n,s){const a=this.Ra;this.Ra=t.Ra,this.mutatedKeys=t.mutatedKeys;const i=t.fa.G_();i.sort((u,d)=>function(p,g){const x=w=>{switch(w){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Le()}};return x(p)-x(g)}(u.type,d.type)||this.Aa(u.doc,d.doc)),this.pa(n),s=s!=null&&s;const o=r&&!s?this.ya():[],l=this.da.size===0&&this.current&&!s?1:0,c=l!==this.Ea;return this.Ea=l,i.length!==0||c?{snapshot:new ml(this.query,t.Ra,a,i,t.mutatedKeys,l===0,c,!1,!!n&&n.resumeToken.approximateByteSize()>0),wa:o}:{wa:o}}Z_(t){return this.current&&t==="Offline"?(this.current=!1,this.applyChanges({Ra:this.Ra,fa:new E_,mutatedKeys:this.mutatedKeys,ns:!1},!1)):{wa:[]}}Sa(t){return!this.Ta.has(t)&&!!this.Ra.has(t)&&!this.Ra.get(t).hasLocalMutations}pa(t){t&&(t.addedDocuments.forEach(r=>this.Ta=this.Ta.add(r)),t.modifiedDocuments.forEach(r=>{}),t.removedDocuments.forEach(r=>this.Ta=this.Ta.delete(r)),this.current=t.current)}ya(){if(!this.current)return[];const t=this.da;this.da=Xe(),this.Ra.forEach(n=>{this.Sa(n.key)&&(this.da=this.da.add(n.key))});const r=[];return t.forEach(n=>{this.da.has(n)||r.push(new yS(n))}),this.da.forEach(n=>{t.has(n)||r.push(new xS(n))}),r}ba(t){this.Ta=t.Ts,this.da=Xe();const r=this.ma(t.documents);return this.applyChanges(r,!0)}Da(){return ml.fromInitialDocuments(this.query,this.Ra,this.mutatedKeys,this.Ea===0,this.hasCachedResults)}}class QO{constructor(t,r,n){this.query=t,this.targetId=r,this.view=n}}class JO{constructor(t){this.key=t,this.va=!1}}class ZO{constructor(t,r,n,s,a,i){this.localStore=t,this.remoteStore=r,this.eventManager=n,this.sharedClientState=s,this.currentUser=a,this.maxConcurrentLimboResolutions=i,this.Ca={},this.Fa=new kl(o=>jk(o),Ld),this.Ma=new Map,this.xa=new Set,this.Oa=new Lt(Pe.comparator),this.Na=new Map,this.La=new xv,this.Ba={},this.ka=new Map,this.qa=dl.kn(),this.onlineState="Unknown",this.Qa=void 0}get isPrimaryClient(){return this.Qa===!0}}async function eM(e,t,r=!0){const n=SS(e);let s;const a=n.Fa.get(t);return a?(n.sharedClientState.addLocalQueryTarget(a.targetId),s=a.view.Da()):s=await _S(n,t,r,!0),s}async function tM(e,t){const r=SS(e);await _S(r,t,!0,!1)}async function _S(e,t,r,n){const s=await TO(e.localStore,Ss(t)),a=s.targetId,i=e.sharedClientState.addLocalQueryTarget(a,r);let o;return n&&(o=await rM(e,t,a,i==="current",s.resumeToken)),e.isPrimaryClient&&r&&hS(e.remoteStore,s),o}async function rM(e,t,r,n,s){e.Ka=(d,m,p)=>async function(x,w,k,T){let E=w.view.ma(k);E.ns&&(E=await x_(x.localStore,w.query,!1).then(({documents:v})=>w.view.ma(v,E)));const N=T&&T.targetChanges.get(w.targetId),M=T&&T.targetMismatches.get(w.targetId)!=null,O=w.view.applyChanges(E,x.isPrimaryClient,N,M);return A_(x,w.targetId,O.wa),O.snapshot}(e,d,m,p);const a=await x_(e.localStore,t,!0),i=new YO(t,a.Ts),o=i.ma(a.documents),l=Du.createSynthesizedTargetChangeForCurrentChange(r,n&&e.onlineState!=="Offline",s),c=i.applyChanges(o,e.isPrimaryClient,l);A_(e,r,c.wa);const u=new QO(t,r,i);return e.Fa.set(t,u),e.Ma.has(r)?e.Ma.get(r).push(t):e.Ma.set(r,[t]),c.snapshot}async function nM(e,t,r){const n=Be(e),s=n.Fa.get(t),a=n.Ma.get(s.targetId);if(a.length>1)return n.Ma.set(s.targetId,a.filter(i=>!Ld(i,t))),void n.Fa.delete(t);n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(s.targetId),n.sharedClientState.isActiveQueryTarget(s.targetId)||await Sp(n.localStore,s.targetId,!1).then(()=>{n.sharedClientState.clearQueryState(s.targetId),r&&wv(n.remoteStore,s.targetId),Ip(n,s.targetId)}).catch(Nu)):(Ip(n,s.targetId),await Sp(n.localStore,s.targetId,!0))}async function sM(e,t){const r=Be(e),n=r.Fa.get(t),s=r.Ma.get(n.targetId);r.isPrimaryClient&&s.length===1&&(r.sharedClientState.removeLocalQueryTarget(n.targetId),wv(r.remoteStore,n.targetId))}async function aM(e,t,r){const n=hM(e);try{const s=await function(i,o){const l=Be(i),c=ar.now(),u=o.reduce((p,g)=>p.add(g.key),Xe());let d,m;return l.persistence.runTransaction("Locally write mutations","readwrite",p=>{let g=ma(),x=Xe();return l.cs.getEntries(p,u).next(w=>{g=w,g.forEach((k,T)=>{T.isValidDocument()||(x=x.add(k))})}).next(()=>l.localDocuments.getOverlayedDocuments(p,g)).next(w=>{d=w;const k=[];for(const T of o){const E=IF(T,d.get(T.key).overlayedDocument);E!=null&&k.push(new vi(T.key,E,Rk(E.value.mapValue),Bn.exists(!0)))}return l.mutationQueue.addMutationBatch(p,c,k,o)}).next(w=>{m=w;const k=w.applyToLocalDocumentSet(d,x);return l.documentOverlayCache.saveOverlays(p,w.batchId,k)})}).then(()=>({batchId:m.batchId,changes:Bk(d)}))}(n.localStore,t);n.sharedClientState.addPendingMutation(s.batchId),function(i,o,l){let c=i.Ba[i.currentUser.toKey()];c||(c=new Lt(ut)),c=c.insert(o,l),i.Ba[i.currentUser.toKey()]=c}(n,s.batchId,r),await Ou(n,s.changes),await Wd(n.remoteStore)}catch(s){const a=Av(s,"Failed to persist write");r.reject(a)}}async function wS(e,t){const r=Be(e);try{const n=await _O(r.localStore,t);t.targetChanges.forEach((s,a)=>{const i=r.Na.get(a);i&&(vt(s.addedDocuments.size+s.modifiedDocuments.size+s.removedDocuments.size<=1),s.addedDocuments.size>0?i.va=!0:s.modifiedDocuments.size>0?vt(i.va):s.removedDocuments.size>0&&(vt(i.va),i.va=!1))}),await Ou(r,n,t)}catch(n){await Nu(n)}}function S_(e,t,r){const n=Be(e);if(n.isPrimaryClient&&r===0||!n.isPrimaryClient&&r===1){const s=[];n.Fa.forEach((a,i)=>{const o=i.view.Z_(t);o.snapshot&&s.push(o.snapshot)}),function(i,o){const l=Be(i);l.onlineState=o;let c=!1;l.queries.forEach((u,d)=>{for(const m of d.j_)m.Z_(o)&&(c=!0)}),c&&Nv(l)}(n.eventManager,t),s.length&&n.Ca.d_(s),n.onlineState=t,n.isPrimaryClient&&n.sharedClientState.setOnlineState(t)}}async function iM(e,t,r){const n=Be(e);n.sharedClientState.updateQueryState(t,"rejected",r);const s=n.Na.get(t),a=s&&s.key;if(a){let i=new Lt(Pe.comparator);i=i.insert(a,Vr.newNoDocument(a,Ve.min()));const o=Xe().add(a),l=new Bd(Ve.min(),new Map,new Lt(ut),i,o);await wS(n,l),n.Oa=n.Oa.remove(a),n.Na.delete(t),bv(n)}else await Sp(n.localStore,t,!1).then(()=>Ip(n,t,r)).catch(Nu)}async function oM(e,t){const r=Be(e),n=t.batch.batchId;try{const s=await yO(r.localStore,t);TS(r,n,null),ES(r,n),r.sharedClientState.updateMutationState(n,"acknowledged"),await Ou(r,s)}catch(s){await Nu(s)}}async function lM(e,t,r){const n=Be(e);try{const s=await function(i,o){const l=Be(i);return l.persistence.runTransaction("Reject batch","readwrite-primary",c=>{let u;return l.mutationQueue.lookupMutationBatch(c,o).next(d=>(vt(d!==null),u=d.keys(),l.mutationQueue.removeMutationBatch(c,d))).next(()=>l.mutationQueue.performConsistencyCheck(c)).next(()=>l.documentOverlayCache.removeOverlaysForBatchId(c,u,o)).next(()=>l.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(c,u)).next(()=>l.localDocuments.getDocuments(c,u))})}(n.localStore,t);TS(n,t,r),ES(n,t),n.sharedClientState.updateMutationState(t,"rejected",r),await Ou(n,s)}catch(s){await Nu(s)}}function ES(e,t){(e.ka.get(t)||[]).forEach(r=>{r.resolve()}),e.ka.delete(t)}function TS(e,t,r){const n=Be(e);let s=n.Ba[n.currentUser.toKey()];if(s){const a=s.get(t);a&&(r?a.reject(r):a.resolve(),s=s.remove(t)),n.Ba[n.currentUser.toKey()]=s}}function Ip(e,t,r=null){e.sharedClientState.removeLocalQueryTarget(t);for(const n of e.Ma.get(t))e.Fa.delete(n),r&&e.Ca.$a(n,r);e.Ma.delete(t),e.isPrimaryClient&&e.La.gr(t).forEach(n=>{e.La.containsKey(n)||kS(e,n)})}function kS(e,t){e.xa.delete(t.path.canonicalString());const r=e.Oa.get(t);r!==null&&(wv(e.remoteStore,r),e.Oa=e.Oa.remove(t),e.Na.delete(r),bv(e))}function A_(e,t,r){for(const n of r)n instanceof xS?(e.La.addReference(n.key,t),cM(e,n)):n instanceof yS?(be("SyncEngine","Document no longer in limbo: "+n.key),e.La.removeReference(n.key,t),e.La.containsKey(n.key)||kS(e,n.key)):Le()}function cM(e,t){const r=t.key,n=r.path.canonicalString();e.Oa.get(r)||e.xa.has(n)||(be("SyncEngine","New document in limbo: "+r),e.xa.add(n),bv(e))}function bv(e){for(;e.xa.size>0&&e.Oa.size<e.maxConcurrentLimboResolutions;){const t=e.xa.values().next().value;e.xa.delete(t);const r=new Pe(Ct.fromString(t)),n=e.qa.next();e.Na.set(n,new JO(r)),e.Oa=e.Oa.insert(r,n),hS(e.remoteStore,new Ua(Ss(Md(r.path)),n,"TargetPurposeLimboResolution",ov.oe))}}async function Ou(e,t,r){const n=Be(e),s=[],a=[],i=[];n.Fa.isEmpty()||(n.Fa.forEach((o,l)=>{i.push(n.Ka(l,t,r).then(c=>{var u;if((c||r)&&n.isPrimaryClient){const d=c?!c.fromCache:(u=r==null?void 0:r.targetChanges.get(l.targetId))===null||u===void 0?void 0:u.current;n.sharedClientState.updateQueryState(l.targetId,d?"current":"not-current")}if(c){s.push(c);const d=_v.Wi(l.targetId,c);a.push(d)}}))}),await Promise.all(i),n.Ca.d_(s),await async function(l,c){const u=Be(l);try{await u.persistence.runTransaction("notifyLocalViewChanges","readwrite",d=>xe.forEach(c,m=>xe.forEach(m.$i,p=>u.persistence.referenceDelegate.addReference(d,m.targetId,p)).next(()=>xe.forEach(m.Ui,p=>u.persistence.referenceDelegate.removeReference(d,m.targetId,p)))))}catch(d){if(!Ru(d))throw d;be("LocalStore","Failed to update sequence numbers: "+d)}for(const d of c){const m=d.targetId;if(!d.fromCache){const p=u.os.get(m),g=p.snapshotVersion,x=p.withLastLimboFreeSnapshotVersion(g);u.os=u.os.insert(m,x)}}}(n.localStore,a))}async function uM(e,t){const r=Be(e);if(!r.currentUser.isEqual(t)){be("SyncEngine","User change. New user:",t.toKey());const n=await lS(r.localStore,t);r.currentUser=t,function(a,i){a.ka.forEach(o=>{o.forEach(l=>{l.reject(new Re(de.CANCELLED,i))})}),a.ka.clear()}(r,"'waitForPendingWrites' promise is rejected due to a user change."),r.sharedClientState.handleUserChange(t,n.removedBatchIds,n.addedBatchIds),await Ou(r,n.hs)}}function fM(e,t){const r=Be(e),n=r.Na.get(t);if(n&&n.va)return Xe().add(n.key);{let s=Xe();const a=r.Ma.get(t);if(!a)return s;for(const i of a){const o=r.Fa.get(i);s=s.unionWith(o.view.Va)}return s}}function SS(e){const t=Be(e);return t.remoteStore.remoteSyncer.applyRemoteEvent=wS.bind(null,t),t.remoteStore.remoteSyncer.getRemoteKeysForTarget=fM.bind(null,t),t.remoteStore.remoteSyncer.rejectListen=iM.bind(null,t),t.Ca.d_=qO.bind(null,t.eventManager),t.Ca.$a=XO.bind(null,t.eventManager),t}function hM(e){const t=Be(e);return t.remoteStore.remoteSyncer.applySuccessfulWrite=oM.bind(null,t),t.remoteStore.remoteSyncer.rejectFailedWrite=lM.bind(null,t),t}class Kh{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(t){this.serializer=zd(t.databaseInfo.databaseId),this.sharedClientState=this.Wa(t),this.persistence=this.Ga(t),await this.persistence.start(),this.localStore=this.za(t),this.gcScheduler=this.ja(t,this.localStore),this.indexBackfillerScheduler=this.Ha(t,this.localStore)}ja(t,r){return null}Ha(t,r){return null}za(t){return xO(this.persistence,new gO,t.initialUser,this.serializer)}Ga(t){return new dO(yv.Zr,this.serializer)}Wa(t){return new SO}async terminate(){var t,r;(t=this.gcScheduler)===null||t===void 0||t.stop(),(r=this.indexBackfillerScheduler)===null||r===void 0||r.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}Kh.provider={build:()=>new Kh};class Cp{async initialize(t,r){this.localStore||(this.localStore=t.localStore,this.sharedClientState=t.sharedClientState,this.datastore=this.createDatastore(r),this.remoteStore=this.createRemoteStore(r),this.eventManager=this.createEventManager(r),this.syncEngine=this.createSyncEngine(r,!t.synchronizeTabs),this.sharedClientState.onlineStateHandler=n=>S_(this.syncEngine,n,1),this.remoteStore.remoteSyncer.handleCredentialChange=uM.bind(null,this.syncEngine),await HO(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(t){return function(){return new KO}()}createDatastore(t){const r=zd(t.databaseInfo.databaseId),n=function(a){return new NO(a)}(t.databaseInfo);return function(a,i,o,l){return new PO(a,i,o,l)}(t.authCredentials,t.appCheckCredentials,n,r)}createRemoteStore(t){return function(n,s,a,i,o){return new FO(n,s,a,i,o)}(this.localStore,this.datastore,t.asyncQueue,r=>S_(this.syncEngine,r,0),function(){return __.D()?new __:new AO}())}createSyncEngine(t,r){return function(s,a,i,o,l,c,u){const d=new ZO(s,a,i,o,l,c);return u&&(d.Qa=!0),d}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,t.initialUser,t.maxConcurrentLimboResolutions,r)}async terminate(){var t,r;await async function(s){const a=Be(s);be("RemoteStore","RemoteStore shutting down."),a.L_.add(5),await Fu(a),a.k_.shutdown(),a.q_.set("Unknown")}(this.remoteStore),(t=this.datastore)===null||t===void 0||t.terminate(),(r=this.eventManager)===null||r===void 0||r.terminate()}}Cp.provider={build:()=>new Cp};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pv{constructor(t){this.observer=t,this.muted=!1}next(t){this.muted||this.observer.next&&this.Ya(this.observer.next,t)}error(t){this.muted||(this.observer.error?this.Ya(this.observer.error,t):da("Uncaught Error in snapshot listener:",t.toString()))}Za(){this.muted=!0}Ya(t,r){setTimeout(()=>{this.muted||t(r)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dM{constructor(t,r,n,s,a){this.authCredentials=t,this.appCheckCredentials=r,this.asyncQueue=n,this.databaseInfo=s,this.user=Mr.UNAUTHENTICATED,this.clientId=Ik.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=a,this.authCredentials.start(n,async i=>{be("FirestoreClient","Received user=",i.uid),await this.authCredentialListener(i),this.user=i}),this.appCheckCredentials.start(n,i=>(be("FirestoreClient","Received new app check token=",i),this.appCheckCredentialListener(i,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(t){this.authCredentialListener=t}setAppCheckTokenChangeListener(t){this.appCheckCredentialListener=t}terminate(){this.asyncQueue.enterRestrictedMode();const t=new ra;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),t.resolve()}catch(r){const n=Av(r,"Failed to shutdown persistence");t.reject(n)}}),t.promise}}async function Q0(e,t){e.asyncQueue.verifyOperationInProgress(),be("FirestoreClient","Initializing OfflineComponentProvider");const r=e.configuration;await t.initialize(r);let n=r.initialUser;e.setCredentialChangeListener(async s=>{n.isEqual(s)||(await lS(t.localStore,s),n=s)}),t.persistence.setDatabaseDeletedListener(()=>e.terminate()),e._offlineComponents=t}async function I_(e,t){e.asyncQueue.verifyOperationInProgress();const r=await mM(e);be("FirestoreClient","Initializing OnlineComponentProvider"),await t.initialize(r,e.configuration),e.setCredentialChangeListener(n=>w_(t.remoteStore,n)),e.setAppCheckTokenChangeListener((n,s)=>w_(t.remoteStore,s)),e._onlineComponents=t}async function mM(e){if(!e._offlineComponents)if(e._uninitializedComponentsProvider){be("FirestoreClient","Using user provided OfflineComponentProvider");try{await Q0(e,e._uninitializedComponentsProvider._offline)}catch(t){const r=t;if(!function(s){return s.name==="FirebaseError"?s.code===de.FAILED_PRECONDITION||s.code===de.UNIMPLEMENTED:!(typeof DOMException<"u"&&s instanceof DOMException)||s.code===22||s.code===20||s.code===11}(r))throw r;cl("Error using user provided cache. Falling back to memory cache: "+r),await Q0(e,new Kh)}}else be("FirestoreClient","Using default OfflineComponentProvider"),await Q0(e,new Kh);return e._offlineComponents}async function AS(e){return e._onlineComponents||(e._uninitializedComponentsProvider?(be("FirestoreClient","Using user provided OnlineComponentProvider"),await I_(e,e._uninitializedComponentsProvider._online)):(be("FirestoreClient","Using default OnlineComponentProvider"),await I_(e,new Cp))),e._onlineComponents}function pM(e){return AS(e).then(t=>t.syncEngine)}async function qh(e){const t=await AS(e),r=t.eventManager;return r.onListen=eM.bind(null,t.syncEngine),r.onUnlisten=nM.bind(null,t.syncEngine),r.onFirstRemoteStoreListen=tM.bind(null,t.syncEngine),r.onLastRemoteStoreUnlisten=sM.bind(null,t.syncEngine),r}function gM(e,t,r={}){const n=new ra;return e.asyncQueue.enqueueAndForget(async()=>function(a,i,o,l,c){const u=new Pv({next:m=>{u.Za(),i.enqueueAndForget(()=>Cv(a,d));const p=m.docs.has(o);!p&&m.fromCache?c.reject(new Re(de.UNAVAILABLE,"Failed to get document because the client is offline.")):p&&m.fromCache&&l&&l.source==="server"?c.reject(new Re(de.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):c.resolve(m)},error:m=>c.reject(m)}),d=new Rv(Md(o.path),u,{includeMetadataChanges:!0,_a:!0});return Iv(a,d)}(await qh(e),e.asyncQueue,t,r,n)),n.promise}function vM(e,t,r={}){const n=new ra;return e.asyncQueue.enqueueAndForget(async()=>function(a,i,o,l,c){const u=new Pv({next:m=>{u.Za(),i.enqueueAndForget(()=>Cv(a,d)),m.fromCache&&l.source==="server"?c.reject(new Re(de.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):c.resolve(m)},error:m=>c.reject(m)}),d=new Rv(o,u,{includeMetadataChanges:!0,_a:!0});return Iv(a,d)}(await qh(e),e.asyncQueue,t,r,n)),n.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function IS(e){const t={};return e.timeoutSeconds!==void 0&&(t.timeoutSeconds=e.timeoutSeconds),t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const C_=new Map;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function CS(e,t,r){if(!r)throw new Re(de.INVALID_ARGUMENT,`Function ${e}() cannot be called with an empty ${t}.`)}function xM(e,t,r,n){if(t===!0&&n===!0)throw new Re(de.INVALID_ARGUMENT,`${e} and ${r} cannot be used together.`)}function N_(e){if(!Pe.isDocumentKey(e))throw new Re(de.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${e} has ${e.length}.`)}function R_(e){if(Pe.isDocumentKey(e))throw new Re(de.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${e} has ${e.length}.`)}function Hd(e){if(e===void 0)return"undefined";if(e===null)return"null";if(typeof e=="string")return e.length>20&&(e=`${e.substring(0,20)}...`),JSON.stringify(e);if(typeof e=="number"||typeof e=="boolean")return""+e;if(typeof e=="object"){if(e instanceof Array)return"an array";{const t=function(n){return n.constructor?n.constructor.name:null}(e);return t?`a custom ${t} object`:"an object"}}return typeof e=="function"?"a function":Le()}function pn(e,t){if("_delegate"in e&&(e=e._delegate),!(e instanceof t)){if(t.name===e.constructor.name)throw new Re(de.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const r=Hd(e);throw new Re(de.INVALID_ARGUMENT,`Expected type '${t.name}', but it was: ${r}`)}}return e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class b_{constructor(t){var r,n;if(t.host===void 0){if(t.ssl!==void 0)throw new Re(de.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=t.host,this.ssl=(r=t.ssl)===null||r===void 0||r;if(this.credentials=t.credentials,this.ignoreUndefinedProperties=!!t.ignoreUndefinedProperties,this.localCache=t.localCache,t.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(t.cacheSizeBytes!==-1&&t.cacheSizeBytes<1048576)throw new Re(de.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=t.cacheSizeBytes}xM("experimentalForceLongPolling",t.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",t.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!t.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:t.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!t.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=IS((n=t.experimentalLongPollingOptions)!==null&&n!==void 0?n:{}),function(a){if(a.timeoutSeconds!==void 0){if(isNaN(a.timeoutSeconds))throw new Re(de.INVALID_ARGUMENT,`invalid long polling timeout: ${a.timeoutSeconds} (must not be NaN)`);if(a.timeoutSeconds<5)throw new Re(de.INVALID_ARGUMENT,`invalid long polling timeout: ${a.timeoutSeconds} (minimum allowed value is 5)`);if(a.timeoutSeconds>30)throw new Re(de.INVALID_ARGUMENT,`invalid long polling timeout: ${a.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!t.useFetchStreams}isEqual(t){return this.host===t.host&&this.ssl===t.ssl&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.experimentalForceLongPolling===t.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===t.experimentalAutoDetectLongPolling&&function(n,s){return n.timeoutSeconds===s.timeoutSeconds}(this.experimentalLongPollingOptions,t.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties&&this.useFetchStreams===t.useFetchStreams}}class Gd{constructor(t,r,n,s){this._authCredentials=t,this._appCheckCredentials=r,this._databaseId=n,this._app=s,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new b_({}),this._settingsFrozen=!1,this._terminateTask="notTerminated"}get app(){if(!this._app)throw new Re(de.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(t){if(this._settingsFrozen)throw new Re(de.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new b_(t),t.credentials!==void 0&&(this._authCredentials=function(n){if(!n)return new L3;switch(n.type){case"firstParty":return new B3(n.sessionIndex||"0",n.iamToken||null,n.authTokenFactory||null);case"provider":return n.client;default:throw new Re(de.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(t.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(r){const n=C_.get(r);n&&(be("ComponentProvider","Removing Datastore"),C_.delete(r),n.terminate())}(this),Promise.resolve()}}function yM(e,t,r,n={}){var s;const a=(e=pn(e,Gd))._getSettings(),i=`${t}:${r}`;if(a.host!=="firestore.googleapis.com"&&a.host!==i&&cl("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),e._setSettings(Object.assign(Object.assign({},a),{host:i,ssl:!1})),n.mockUserToken){let o,l;if(typeof n.mockUserToken=="string")o=n.mockUserToken,l=Mr.MOCK_USER;else{o=FT(n.mockUserToken,(s=e._app)===null||s===void 0?void 0:s.options.projectId);const c=n.mockUserToken.sub||n.mockUserToken.user_id;if(!c)throw new Re(de.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");l=new Mr(c)}e._authCredentials=new j3(new Ak(o,l))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ao{constructor(t,r,n){this.converter=r,this._query=n,this.type="query",this.firestore=t}withConverter(t){return new ao(this.firestore,t,this._query)}}class zr{constructor(t,r,n){this.converter=r,this._key=n,this.type="document",this.firestore=t}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Za(this.firestore,this.converter,this._key.path.popLast())}withConverter(t){return new zr(this.firestore,t,this._key)}}class Za extends ao{constructor(t,r,n){super(t,r,Md(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const t=this._path.popLast();return t.isEmpty()?null:new zr(this.firestore,null,new Pe(t))}withConverter(t){return new Za(this.firestore,t,this._path)}}function ir(e,t,...r){if(e=Ht(e),CS("collection","path",t),e instanceof Gd){const n=Ct.fromString(t,...r);return R_(n),new Za(e,null,n)}{if(!(e instanceof zr||e instanceof Za))throw new Re(de.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=e._path.child(Ct.fromString(t,...r));return R_(n),new Za(e.firestore,null,n)}}function Tr(e,t,...r){if(e=Ht(e),arguments.length===1&&(t=Ik.newId()),CS("doc","path",t),e instanceof Gd){const n=Ct.fromString(t,...r);return N_(n),new zr(e,null,new Pe(n))}{if(!(e instanceof zr||e instanceof Za))throw new Re(de.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=e._path.child(Ct.fromString(t,...r));return N_(n),new zr(e.firestore,e instanceof Za?e.converter:null,new Pe(n))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class P_{constructor(t=Promise.resolve()){this.Pu=[],this.Iu=!1,this.Tu=[],this.Eu=null,this.du=!1,this.Au=!1,this.Ru=[],this.t_=new uS(this,"async_queue_retry"),this.Vu=()=>{const n=Y0();n&&be("AsyncQueue","Visibility state changed to "+n.visibilityState),this.t_.jo()},this.mu=t;const r=Y0();r&&typeof r.addEventListener=="function"&&r.addEventListener("visibilitychange",this.Vu)}get isShuttingDown(){return this.Iu}enqueueAndForget(t){this.enqueue(t)}enqueueAndForgetEvenWhileRestricted(t){this.fu(),this.gu(t)}enterRestrictedMode(t){if(!this.Iu){this.Iu=!0,this.Au=t||!1;const r=Y0();r&&typeof r.removeEventListener=="function"&&r.removeEventListener("visibilitychange",this.Vu)}}enqueue(t){if(this.fu(),this.Iu)return new Promise(()=>{});const r=new ra;return this.gu(()=>this.Iu&&this.Au?Promise.resolve():(t().then(r.resolve,r.reject),r.promise)).then(()=>r.promise)}enqueueRetryable(t){this.enqueueAndForget(()=>(this.Pu.push(t),this.pu()))}async pu(){if(this.Pu.length!==0){try{await this.Pu[0](),this.Pu.shift(),this.t_.reset()}catch(t){if(!Ru(t))throw t;be("AsyncQueue","Operation failed with retryable error: "+t)}this.Pu.length>0&&this.t_.Go(()=>this.pu())}}gu(t){const r=this.mu.then(()=>(this.du=!0,t().catch(n=>{this.Eu=n,this.du=!1;const s=function(i){let o=i.message||"";return i.stack&&(o=i.stack.includes(i.message)?i.stack:i.message+`
`+i.stack),o}(n);throw da("INTERNAL UNHANDLED ERROR: ",s),n}).then(n=>(this.du=!1,n))));return this.mu=r,r}enqueueAfterDelay(t,r,n){this.fu(),this.Ru.indexOf(t)>-1&&(r=0);const s=Sv.createAndSchedule(this,t,r,n,a=>this.yu(a));return this.Tu.push(s),s}fu(){this.Eu&&Le()}verifyOperationInProgress(){}async wu(){let t;do t=this.mu,await t;while(t!==this.mu)}Su(t){for(const r of this.Tu)if(r.timerId===t)return!0;return!1}bu(t){return this.wu().then(()=>{this.Tu.sort((r,n)=>r.targetTimeMs-n.targetTimeMs);for(const r of this.Tu)if(r.skipDelay(),t!=="all"&&r.timerId===t)break;return this.wu()})}Du(t){this.Ru.push(t)}yu(t){const r=this.Tu.indexOf(t);this.Tu.splice(r,1)}}function D_(e){return function(r,n){if(typeof r!="object"||r===null)return!1;const s=r;for(const a of n)if(a in s&&typeof s[a]=="function")return!0;return!1}(e,["next","error","complete"])}class pa extends Gd{constructor(t,r,n,s){super(t,r,n,s),this.type="firestore",this._queue=new P_,this._persistenceKey=(s==null?void 0:s.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const t=this._firestoreClient.terminate();this._queue=new P_(t),this._firestoreClient=void 0,await t}}}function _M(e,t){const r=typeof e=="object"?e:bd(),n=typeof e=="string"?e:"(default)",s=Su(r,"firestore").getImmediate({identifier:n});if(!s._initialized){const a=Gg("firestore");a&&yM(s,...a)}return s}function Kd(e){if(e._terminated)throw new Re(de.FAILED_PRECONDITION,"The client has already been terminated.");return e._firestoreClient||wM(e),e._firestoreClient}function wM(e){var t,r,n;const s=e._freezeSettings(),a=function(o,l,c,u){return new eF(o,l,c,u.host,u.ssl,u.experimentalForceLongPolling,u.experimentalAutoDetectLongPolling,IS(u.experimentalLongPollingOptions),u.useFetchStreams)}(e._databaseId,((t=e._app)===null||t===void 0?void 0:t.options.appId)||"",e._persistenceKey,s);e._componentsProvider||!((r=s.localCache)===null||r===void 0)&&r._offlineComponentProvider&&(!((n=s.localCache)===null||n===void 0)&&n._onlineComponentProvider)&&(e._componentsProvider={_offline:s.localCache._offlineComponentProvider,_online:s.localCache._onlineComponentProvider}),e._firestoreClient=new dM(e._authCredentials,e._appCheckCredentials,e._queue,a,e._componentsProvider&&function(o){const l=o==null?void 0:o._online.build();return{_offline:o==null?void 0:o._offline.build(l),_online:l}}(e._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pl{constructor(t){this._byteString=t}static fromBase64String(t){try{return new pl(Cr.fromBase64String(t))}catch(r){throw new Re(de.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+r)}}static fromUint8Array(t){return new pl(Cr.fromUint8Array(t))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(t){return this._byteString.isEqual(t._byteString)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qd{constructor(...t){for(let r=0;r<t.length;++r)if(t[r].length===0)throw new Re(de.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new _r(t)}isEqual(t){return this._internalPath.isEqual(t._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mu{constructor(t){this._methodName=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dv{constructor(t,r){if(!isFinite(t)||t<-90||t>90)throw new Re(de.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(r)||r<-180||r>180)throw new Re(de.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+r);this._lat=t,this._long=r}get latitude(){return this._lat}get longitude(){return this._long}isEqual(t){return this._lat===t._lat&&this._long===t._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(t){return ut(this._lat,t._lat)||ut(this._long,t._long)}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fv{constructor(t){this._values=(t||[]).map(r=>r)}toArray(){return this._values.map(t=>t)}isEqual(t){return function(n,s){if(n.length!==s.length)return!1;for(let a=0;a<n.length;++a)if(n[a]!==s[a])return!1;return!0}(this._values,t._values)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const EM=/^__.*__$/;class TM{constructor(t,r,n){this.data=t,this.fieldMask=r,this.fieldTransforms=n}toMutation(t,r){return this.fieldMask!==null?new vi(t,this.data,this.fieldMask,r,this.fieldTransforms):new Pu(t,this.data,r,this.fieldTransforms)}}class NS{constructor(t,r,n){this.data=t,this.fieldMask=r,this.fieldTransforms=n}toMutation(t,r){return new vi(t,this.data,this.fieldMask,r,this.fieldTransforms)}}function RS(e){switch(e){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Le()}}class Ov{constructor(t,r,n,s,a,i){this.settings=t,this.databaseId=r,this.serializer=n,this.ignoreUndefinedProperties=s,a===void 0&&this.vu(),this.fieldTransforms=a||[],this.fieldMask=i||[]}get path(){return this.settings.path}get Cu(){return this.settings.Cu}Fu(t){return new Ov(Object.assign(Object.assign({},this.settings),t),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Mu(t){var r;const n=(r=this.path)===null||r===void 0?void 0:r.child(t),s=this.Fu({path:n,xu:!1});return s.Ou(t),s}Nu(t){var r;const n=(r=this.path)===null||r===void 0?void 0:r.child(t),s=this.Fu({path:n,xu:!1});return s.vu(),s}Lu(t){return this.Fu({path:void 0,xu:!0})}Bu(t){return Xh(t,this.settings.methodName,this.settings.ku||!1,this.path,this.settings.qu)}contains(t){return this.fieldMask.find(r=>t.isPrefixOf(r))!==void 0||this.fieldTransforms.find(r=>t.isPrefixOf(r.field))!==void 0}vu(){if(this.path)for(let t=0;t<this.path.length;t++)this.Ou(this.path.get(t))}Ou(t){if(t.length===0)throw this.Bu("Document fields must not be empty");if(RS(this.Cu)&&EM.test(t))throw this.Bu('Document fields cannot begin and end with "__"')}}class kM{constructor(t,r,n){this.databaseId=t,this.ignoreUndefinedProperties=r,this.serializer=n||zd(t)}Qu(t,r,n,s=!1){return new Ov({Cu:t,methodName:r,qu:n,path:_r.emptyPath(),xu:!1,ku:s},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function Xd(e){const t=e._freezeSettings(),r=zd(e._databaseId);return new kM(e._databaseId,!!t.ignoreUndefinedProperties,r)}function bS(e,t,r,n,s,a={}){const i=e.Qu(a.merge||a.mergeFields?2:0,t,r,s);jv("Data must be an object, but it was:",i,n);const o=PS(n,i);let l,c;if(a.merge)l=new Tn(i.fieldMask),c=i.fieldTransforms;else if(a.mergeFields){const u=[];for(const d of a.mergeFields){const m=Np(t,d,r);if(!i.contains(m))throw new Re(de.INVALID_ARGUMENT,`Field '${m}' is specified in your field mask but missing from your input data.`);FS(u,m)||u.push(m)}l=new Tn(u),c=i.fieldTransforms.filter(d=>l.covers(d.field))}else l=null,c=i.fieldTransforms;return new TM(new un(o),l,c)}class Yd extends Mu{_toFieldTransform(t){if(t.Cu!==2)throw t.Cu===1?t.Bu(`${this._methodName}() can only appear at the top level of your update data`):t.Bu(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return t.fieldMask.push(t.path),null}isEqual(t){return t instanceof Yd}}class Mv extends Mu{_toFieldTransform(t){return new Xk(t.path,new su)}isEqual(t){return t instanceof Mv}}class Lv extends Mu{constructor(t,r){super(t),this.$u=r}_toFieldTransform(t){const r=new ou(t.serializer,Wk(t.serializer,this.$u));return new Xk(t.path,r)}isEqual(t){return t instanceof Lv&&this.$u===t.$u}}function SM(e,t,r,n){const s=e.Qu(1,t,r);jv("Data must be an object, but it was:",s,n);const a=[],i=un.empty();no(n,(l,c)=>{const u=Vv(t,l,r);c=Ht(c);const d=s.Nu(u);if(c instanceof Yd)a.push(u);else{const m=Lu(c,d);m!=null&&(a.push(u),i.set(u,m))}});const o=new Tn(a);return new NS(i,o,s.fieldTransforms)}function AM(e,t,r,n,s,a){const i=e.Qu(1,t,r),o=[Np(t,n,r)],l=[s];if(a.length%2!=0)throw new Re(de.INVALID_ARGUMENT,`Function ${t}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let m=0;m<a.length;m+=2)o.push(Np(t,a[m])),l.push(a[m+1]);const c=[],u=un.empty();for(let m=o.length-1;m>=0;--m)if(!FS(c,o[m])){const p=o[m];let g=l[m];g=Ht(g);const x=i.Nu(p);if(g instanceof Yd)c.push(p);else{const w=Lu(g,x);w!=null&&(c.push(p),u.set(p,w))}}const d=new Tn(c);return new NS(u,d,i.fieldTransforms)}function IM(e,t,r,n=!1){return Lu(r,e.Qu(n?4:3,t))}function Lu(e,t){if(DS(e=Ht(e)))return jv("Unsupported field value:",t,e),PS(e,t);if(e instanceof Mu)return function(n,s){if(!RS(s.Cu))throw s.Bu(`${n._methodName}() can only be used with update() and set()`);if(!s.path)throw s.Bu(`${n._methodName}() is not currently supported inside arrays`);const a=n._toFieldTransform(s);a&&s.fieldTransforms.push(a)}(e,t),null;if(e===void 0&&t.ignoreUndefinedProperties)return null;if(t.path&&t.fieldMask.push(t.path),e instanceof Array){if(t.settings.xu&&t.Cu!==4)throw t.Bu("Nested arrays are not supported");return function(n,s){const a=[];let i=0;for(const o of n){let l=Lu(o,s.Lu(i));l==null&&(l={nullValue:"NULL_VALUE"}),a.push(l),i++}return{arrayValue:{values:a}}}(e,t)}return function(n,s){if((n=Ht(n))===null)return{nullValue:"NULL_VALUE"};if(typeof n=="number")return Wk(s.serializer,n);if(typeof n=="boolean")return{booleanValue:n};if(typeof n=="string")return{stringValue:n};if(n instanceof Date){const a=ar.fromDate(n);return{timestampValue:Hh(s.serializer,a)}}if(n instanceof ar){const a=new ar(n.seconds,1e3*Math.floor(n.nanoseconds/1e3));return{timestampValue:Hh(s.serializer,a)}}if(n instanceof Dv)return{geoPointValue:{latitude:n.latitude,longitude:n.longitude}};if(n instanceof pl)return{bytesValue:tS(s.serializer,n._byteString)};if(n instanceof zr){const a=s.databaseId,i=n.firestore._databaseId;if(!i.isEqual(a))throw s.Bu(`Document reference is for database ${i.projectId}/${i.database} but should be for database ${a.projectId}/${a.database}`);return{referenceValue:vv(n.firestore._databaseId||s.databaseId,n._key.path)}}if(n instanceof Fv)return function(i,o){return{mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{values:i.toArray().map(l=>{if(typeof l!="number")throw o.Bu("VectorValues must only contain numeric values.");return dv(o.serializer,l)})}}}}}}(n,s);throw s.Bu(`Unsupported field value: ${Hd(n)}`)}(e,t)}function PS(e,t){const r={};return Ck(e)?t.path&&t.path.length>0&&t.fieldMask.push(t.path):no(e,(n,s)=>{const a=Lu(s,t.Mu(n));a!=null&&(r[n]=a)}),{mapValue:{fields:r}}}function DS(e){return!(typeof e!="object"||e===null||e instanceof Array||e instanceof Date||e instanceof ar||e instanceof Dv||e instanceof pl||e instanceof zr||e instanceof Mu||e instanceof Fv)}function jv(e,t,r){if(!DS(r)||!function(s){return typeof s=="object"&&s!==null&&(Object.getPrototypeOf(s)===Object.prototype||Object.getPrototypeOf(s)===null)}(r)){const n=Hd(r);throw n==="an object"?t.Bu(e+" a custom object"):t.Bu(e+" "+n)}}function Np(e,t,r){if((t=Ht(t))instanceof qd)return t._internalPath;if(typeof t=="string")return Vv(e,t);throw Xh("Field path arguments must be of type string or ",e,!1,void 0,r)}const CM=new RegExp("[~\\*/\\[\\]]");function Vv(e,t,r){if(t.search(CM)>=0)throw Xh(`Invalid field path (${t}). Paths must not contain '~', '*', '/', '[', or ']'`,e,!1,void 0,r);try{return new qd(...t.split("."))._internalPath}catch{throw Xh(`Invalid field path (${t}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,e,!1,void 0,r)}}function Xh(e,t,r,n,s){const a=n&&!n.isEmpty(),i=s!==void 0;let o=`Function ${t}() called with invalid data`;r&&(o+=" (via `toFirestore()`)"),o+=". ";let l="";return(a||i)&&(l+=" (found",a&&(l+=` in field ${n}`),i&&(l+=` in document ${s}`),l+=")"),new Re(de.INVALID_ARGUMENT,o+e+l)}function FS(e,t){return e.some(r=>r.isEqual(t))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OS{constructor(t,r,n,s,a){this._firestore=t,this._userDataWriter=r,this._key=n,this._document=s,this._converter=a}get id(){return this._key.path.lastSegment()}get ref(){return new zr(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const t=new NM(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(t)}return this._userDataWriter.convertValue(this._document.data.value)}}get(t){if(this._document){const r=this._document.data.field(Uv("DocumentSnapshot.get",t));if(r!==null)return this._userDataWriter.convertValue(r)}}}class NM extends OS{data(){return super.data()}}function Uv(e,t){return typeof t=="string"?Vv(e,t):t instanceof qd?t._internalPath:t._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function MS(e){if(e.limitType==="L"&&e.explicitOrderBy.length===0)throw new Re(de.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class Bv{}class RM extends Bv{}function ei(e,t,...r){let n=[];t instanceof Bv&&n.push(t),n=n.concat(r),function(a){const i=a.filter(l=>l instanceof zv).length,o=a.filter(l=>l instanceof Qd).length;if(i>1||i>0&&o>0)throw new Re(de.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(n);for(const s of n)e=s._apply(e);return e}class Qd extends RM{constructor(t,r,n){super(),this._field=t,this._op=r,this._value=n,this.type="where"}static _create(t,r,n){return new Qd(t,r,n)}_apply(t){const r=this._parse(t);return LS(t._query,r),new ao(t.firestore,t.converter,yp(t._query,r))}_parse(t){const r=Xd(t.firestore);return function(a,i,o,l,c,u,d){let m;if(c.isKeyField()){if(u==="array-contains"||u==="array-contains-any")throw new Re(de.INVALID_ARGUMENT,`Invalid Query. You can't perform '${u}' queries on documentId().`);if(u==="in"||u==="not-in"){O_(d,u);const p=[];for(const g of d)p.push(F_(l,a,g));m={arrayValue:{values:p}}}else m=F_(l,a,d)}else u!=="in"&&u!=="not-in"&&u!=="array-contains-any"||O_(d,u),m=IM(o,i,d,u==="in"||u==="not-in");return Zt.create(c,u,m)}(t._query,"where",r,t.firestore._databaseId,this._field,this._op,this._value)}}function ti(e,t,r){const n=t,s=Uv("where",e);return Qd._create(s,n,r)}class zv extends Bv{constructor(t,r){super(),this.type=t,this._queryConstraints=r}static _create(t,r){return new zv(t,r)}_parse(t){const r=this._queryConstraints.map(n=>n._parse(t)).filter(n=>n.getFilters().length>0);return r.length===1?r[0]:fs.create(r,this._getOperator())}_apply(t){const r=this._parse(t);return r.getFilters().length===0?t:(function(s,a){let i=s;const o=a.getFlattenedFilters();for(const l of o)LS(i,l),i=yp(i,l)}(t._query,r),new ao(t.firestore,t.converter,yp(t._query,r)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}function F_(e,t,r){if(typeof(r=Ht(r))=="string"){if(r==="")throw new Re(de.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!Lk(t)&&r.indexOf("/")!==-1)throw new Re(de.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${r}' contains a '/' character.`);const n=t.path.child(Ct.fromString(r));if(!Pe.isDocumentKey(n))throw new Re(de.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${n}' is not because it has an odd number of segments (${n.length}).`);return t_(e,new Pe(n))}if(r instanceof zr)return t_(e,r._key);throw new Re(de.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${Hd(r)}.`)}function O_(e,t){if(!Array.isArray(e)||e.length===0)throw new Re(de.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${t.toString()}' filters.`)}function LS(e,t){const r=function(s,a){for(const i of s)for(const o of i.getFlattenedFilters())if(a.indexOf(o.op)>=0)return o.op;return null}(e.filters,function(s){switch(s){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(t.op));if(r!==null)throw r===t.op?new Re(de.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${t.op.toString()}' filter.`):new Re(de.INVALID_ARGUMENT,`Invalid query. You cannot use '${t.op.toString()}' filters with '${r.toString()}' filters.`)}class bM{convertValue(t,r="none"){switch(Xi(t)){case 0:return null;case 1:return t.booleanValue;case 2:return $t(t.integerValue||t.doubleValue);case 3:return this.convertTimestamp(t.timestampValue);case 4:return this.convertServerTimestamp(t,r);case 5:return t.stringValue;case 6:return this.convertBytes(qi(t.bytesValue));case 7:return this.convertReference(t.referenceValue);case 8:return this.convertGeoPoint(t.geoPointValue);case 9:return this.convertArray(t.arrayValue,r);case 11:return this.convertObject(t.mapValue,r);case 10:return this.convertVectorValue(t.mapValue);default:throw Le()}}convertObject(t,r){return this.convertObjectMap(t.fields,r)}convertObjectMap(t,r="none"){const n={};return no(t,(s,a)=>{n[s]=this.convertValue(a,r)}),n}convertVectorValue(t){var r,n,s;const a=(s=(n=(r=t.fields)===null||r===void 0?void 0:r.value.arrayValue)===null||n===void 0?void 0:n.values)===null||s===void 0?void 0:s.map(i=>$t(i.doubleValue));return new Fv(a)}convertGeoPoint(t){return new Dv($t(t.latitude),$t(t.longitude))}convertArray(t,r){return(t.values||[]).map(n=>this.convertValue(n,r))}convertServerTimestamp(t,r){switch(r){case"previous":const n=cv(t);return n==null?null:this.convertValue(n,r);case"estimate":return this.convertTimestamp(tu(t));default:return null}}convertTimestamp(t){const r=oi(t);return new ar(r.seconds,r.nanos)}convertDocumentKey(t,r){const n=Ct.fromString(t);vt(oS(n));const s=new ru(n.get(1),n.get(3)),a=new Pe(n.popFirst(5));return s.isEqual(r)||da(`Document ${a} contains a document reference within a different database (${s.projectId}/${s.database}) which is not supported. It will be treated as a reference in the current database (${r.projectId}/${r.database}) instead.`),a}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jS(e,t,r){let n;return n=e?r&&(r.merge||r.mergeFields)?e.toFirestore(t,r):e.toFirestore(t):t,n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sc{constructor(t,r){this.hasPendingWrites=t,this.fromCache=r}isEqual(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache}}class VS extends OS{constructor(t,r,n,s,a,i){super(t,r,n,s,i),this._firestore=t,this._firestoreImpl=t,this.metadata=a}exists(){return super.exists()}data(t={}){if(this._document){if(this._converter){const r=new sh(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(r,t)}return this._userDataWriter.convertValue(this._document.data.value,t.serverTimestamps)}}get(t,r={}){if(this._document){const n=this._document.data.field(Uv("DocumentSnapshot.get",t));if(n!==null)return this._userDataWriter.convertValue(n,r.serverTimestamps)}}}class sh extends VS{data(t={}){return super.data(t)}}class US{constructor(t,r,n,s){this._firestore=t,this._userDataWriter=r,this._snapshot=s,this.metadata=new sc(s.hasPendingWrites,s.fromCache),this.query=n}get docs(){const t=[];return this.forEach(r=>t.push(r)),t}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(t,r){this._snapshot.docs.forEach(n=>{t.call(r,new sh(this._firestore,this._userDataWriter,n.key,n,new sc(this._snapshot.mutatedKeys.has(n.key),this._snapshot.fromCache),this.query.converter))})}docChanges(t={}){const r=!!t.includeMetadataChanges;if(r&&this._snapshot.excludesMetadataChanges)throw new Re(de.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===r||(this._cachedChanges=function(s,a){if(s._snapshot.oldDocs.isEmpty()){let i=0;return s._snapshot.docChanges.map(o=>{const l=new sh(s._firestore,s._userDataWriter,o.doc.key,o.doc,new sc(s._snapshot.mutatedKeys.has(o.doc.key),s._snapshot.fromCache),s.query.converter);return o.doc,{type:"added",doc:l,oldIndex:-1,newIndex:i++}})}{let i=s._snapshot.oldDocs;return s._snapshot.docChanges.filter(o=>a||o.type!==3).map(o=>{const l=new sh(s._firestore,s._userDataWriter,o.doc.key,o.doc,new sc(s._snapshot.mutatedKeys.has(o.doc.key),s._snapshot.fromCache),s.query.converter);let c=-1,u=-1;return o.type!==0&&(c=i.indexOf(o.doc.key),i=i.delete(o.doc.key)),o.type!==1&&(i=i.add(o.doc),u=i.indexOf(o.doc.key)),{type:PM(o.type),doc:l,oldIndex:c,newIndex:u}})}}(this,r),this._cachedChangesIncludeMetadataChanges=r),this._cachedChanges}}function PM(e){switch(e){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Le()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Is(e){e=pn(e,zr);const t=pn(e.firestore,pa);return gM(Kd(t),e._key).then(r=>BS(t,e,r))}class $v extends bM{constructor(t){super(),this.firestore=t}convertBytes(t){return new pl(t)}convertReference(t){const r=this.convertDocumentKey(t,this.firestore._databaseId);return new zr(this.firestore,null,r)}}function kr(e){e=pn(e,ao);const t=pn(e.firestore,pa),r=Kd(t),n=new $v(t);return MS(e._query),vM(r,e._query).then(s=>new US(t,n,e,s))}function ci(e,t,r){e=pn(e,zr);const n=pn(e.firestore,pa),s=jS(e.converter,t,r);return Zd(n,[bS(Xd(n),"setDoc",e._key,s,e.converter!==null,r).toMutation(e._key,Bn.none())])}function Yi(e,t,r,...n){e=pn(e,zr);const s=pn(e.firestore,pa),a=Xd(s);let i;return i=typeof(t=Ht(t))=="string"||t instanceof qd?AM(a,"updateDoc",e._key,t,r,n):SM(a,"updateDoc",e._key,t),Zd(s,[i.toMutation(e._key,Bn.exists(!0))])}function DM(e){return Zd(pn(e.firestore,pa),[new mv(e._key,Bn.none())])}function Jd(e,t){const r=pn(e.firestore,pa),n=Tr(e),s=jS(e.converter,t);return Zd(r,[bS(Xd(e.firestore),"addDoc",n._key,s,e.converter!==null,{}).toMutation(n._key,Bn.exists(!1))]).then(()=>n)}function FM(e,...t){var r,n,s;e=Ht(e);let a={includeMetadataChanges:!1,source:"default"},i=0;typeof t[i]!="object"||D_(t[i])||(a=t[i],i++);const o={includeMetadataChanges:a.includeMetadataChanges,source:a.source};if(D_(t[i])){const d=t[i];t[i]=(r=d.next)===null||r===void 0?void 0:r.bind(d),t[i+1]=(n=d.error)===null||n===void 0?void 0:n.bind(d),t[i+2]=(s=d.complete)===null||s===void 0?void 0:s.bind(d)}let l,c,u;if(e instanceof zr)c=pn(e.firestore,pa),u=Md(e._key.path),l={next:d=>{t[i]&&t[i](BS(c,e,d))},error:t[i+1],complete:t[i+2]};else{const d=pn(e,ao);c=pn(d.firestore,pa),u=d._query;const m=new $v(c);l={next:p=>{t[i]&&t[i](new US(c,m,d,p))},error:t[i+1],complete:t[i+2]},MS(e._query)}return function(m,p,g,x){const w=new Pv(x),k=new Rv(p,w,g);return m.asyncQueue.enqueueAndForget(async()=>Iv(await qh(m),k)),()=>{w.Za(),m.asyncQueue.enqueueAndForget(async()=>Cv(await qh(m),k))}}(Kd(c),u,o,l)}function Zd(e,t){return function(n,s){const a=new ra;return n.asyncQueue.enqueueAndForget(async()=>aM(await pM(n),s,a)),a.promise}(Kd(e),t)}function BS(e,t,r){const n=r.docs.get(t._key),s=new $v(e);return new VS(e,s,t._key,n,new sc(r.hasPendingWrites,r.fromCache),t.converter)}function OM(){return new Mv("serverTimestamp")}function MM(e){return new Lv("increment",e)}(function(t,r=!0){(function(s){Tl=s})(ro),ai(new ua("firestore",(n,{instanceIdentifier:s,options:a})=>{const i=n.getProvider("app").getImmediate(),o=new pa(new V3(n.getProvider("auth-internal")),new $3(n.getProvider("app-check-internal")),function(c,u){if(!Object.prototype.hasOwnProperty.apply(c.options,["projectId"]))throw new Re(de.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new ru(c.options.projectId,u)}(i,s),i);return a=Object.assign({useFetchStreams:r},a),o._setSettings(a),o},"PUBLIC").setMultipleInstances(!0)),Un(Yy,"4.7.3",t),Un(Yy,"4.7.3","esm2017")})();var LM="firebase",jM="10.14.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Un(LM,jM,"app");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zS="firebasestorage.googleapis.com",VM="storageBucket",UM=2*60*1e3,BM=10*60*1e3;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fs extends Ds{constructor(t,r,n=0){super(J0(t),`Firebase Storage: ${r} (${J0(t)})`),this.status_=n,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,Fs.prototype)}get status(){return this.status_}set status(t){this.status_=t}_codeEquals(t){return J0(t)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(t){this.customData.serverResponse=t,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}var Rs;(function(e){e.UNKNOWN="unknown",e.OBJECT_NOT_FOUND="object-not-found",e.BUCKET_NOT_FOUND="bucket-not-found",e.PROJECT_NOT_FOUND="project-not-found",e.QUOTA_EXCEEDED="quota-exceeded",e.UNAUTHENTICATED="unauthenticated",e.UNAUTHORIZED="unauthorized",e.UNAUTHORIZED_APP="unauthorized-app",e.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",e.INVALID_CHECKSUM="invalid-checksum",e.CANCELED="canceled",e.INVALID_EVENT_NAME="invalid-event-name",e.INVALID_URL="invalid-url",e.INVALID_DEFAULT_BUCKET="invalid-default-bucket",e.NO_DEFAULT_BUCKET="no-default-bucket",e.CANNOT_SLICE_BLOB="cannot-slice-blob",e.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",e.NO_DOWNLOAD_URL="no-download-url",e.INVALID_ARGUMENT="invalid-argument",e.INVALID_ARGUMENT_COUNT="invalid-argument-count",e.APP_DELETED="app-deleted",e.INVALID_ROOT_OPERATION="invalid-root-operation",e.INVALID_FORMAT="invalid-format",e.INTERNAL_ERROR="internal-error",e.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})(Rs||(Rs={}));function J0(e){return"storage/"+e}function zM(){const e="An unknown error occurred, please check the error payload for server response.";return new Fs(Rs.UNKNOWN,e)}function $M(){return new Fs(Rs.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function WM(){return new Fs(Rs.CANCELED,"User canceled the upload/download.")}function HM(e){return new Fs(Rs.INVALID_URL,"Invalid URL '"+e+"'.")}function GM(e){return new Fs(Rs.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+e+"'.")}function M_(e){return new Fs(Rs.INVALID_ARGUMENT,e)}function $S(){return new Fs(Rs.APP_DELETED,"The Firebase app was deleted.")}function KM(e){return new Fs(Rs.INVALID_ROOT_OPERATION,"The operation '"+e+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ns{constructor(t,r){this.bucket=t,this.path_=r}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const t=encodeURIComponent;return"/b/"+t(this.bucket)+"/o/"+t(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(t,r){let n;try{n=ns.makeFromUrl(t,r)}catch{return new ns(t,"")}if(n.path==="")return n;throw GM(t)}static makeFromUrl(t,r){let n=null;const s="([A-Za-z0-9.\\-_]+)";function a(N){N.path.charAt(N.path.length-1)==="/"&&(N.path_=N.path_.slice(0,-1))}const i="(/(.*))?$",o=new RegExp("^gs://"+s+i,"i"),l={bucket:1,path:3};function c(N){N.path_=decodeURIComponent(N.path)}const u="v[A-Za-z0-9_]+",d=r.replace(/[.]/g,"\\."),m="(/([^?#]*).*)?$",p=new RegExp(`^https?://${d}/${u}/b/${s}/o${m}`,"i"),g={bucket:1,path:3},x=r===zS?"(?:storage.googleapis.com|storage.cloud.google.com)":r,w="([^?#]*)",k=new RegExp(`^https?://${x}/${s}/${w}`,"i"),E=[{regex:o,indices:l,postModify:a},{regex:p,indices:g,postModify:c},{regex:k,indices:{bucket:1,path:2},postModify:c}];for(let N=0;N<E.length;N++){const M=E[N],O=M.regex.exec(t);if(O){const v=O[M.indices.bucket];let _=O[M.indices.path];_||(_=""),n=new ns(v,_),M.postModify(n);break}}if(n==null)throw HM(t);return n}}class qM{constructor(t){this.promise_=Promise.reject(t)}getPromise(){return this.promise_}cancel(t=!1){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function XM(e,t,r){let n=1,s=null,a=null,i=!1,o=0;function l(){return o===2}let c=!1;function u(...w){c||(c=!0,t.apply(null,w))}function d(w){s=setTimeout(()=>{s=null,e(p,l())},w)}function m(){a&&clearTimeout(a)}function p(w,...k){if(c){m();return}if(w){m(),u.call(null,w,...k);return}if(l()||i){m(),u.call(null,w,...k);return}n<64&&(n*=2);let E;o===1?(o=2,E=0):E=(n+Math.random())*1e3,d(E)}let g=!1;function x(w){g||(g=!0,m(),!c&&(s!==null?(w||(o=2),clearTimeout(s),d(0)):w||(o=1)))}return d(0),a=setTimeout(()=>{i=!0,x(!0)},r),x}function YM(e){e(!1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function QM(e){return e!==void 0}function L_(e,t,r,n){if(n<t)throw M_(`Invalid value for '${e}'. Expected ${t} or greater.`);if(n>r)throw M_(`Invalid value for '${e}'. Expected ${r} or less.`)}function JM(e){const t=encodeURIComponent;let r="?";for(const n in e)if(e.hasOwnProperty(n)){const s=t(n)+"="+t(e[n]);r=r+s+"&"}return r=r.slice(0,-1),r}var Yh;(function(e){e[e.NO_ERROR=0]="NO_ERROR",e[e.NETWORK_ERROR=1]="NETWORK_ERROR",e[e.ABORT=2]="ABORT"})(Yh||(Yh={}));/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ZM(e,t){const r=e>=500&&e<600,s=[408,429].indexOf(e)!==-1,a=t.indexOf(e)!==-1;return r||s||a}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eL{constructor(t,r,n,s,a,i,o,l,c,u,d,m=!0){this.url_=t,this.method_=r,this.headers_=n,this.body_=s,this.successCodes_=a,this.additionalRetryCodes_=i,this.callback_=o,this.errorCallback_=l,this.timeout_=c,this.progressCallback_=u,this.connectionFactory_=d,this.retry=m,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((p,g)=>{this.resolve_=p,this.reject_=g,this.start_()})}start_(){const t=(n,s)=>{if(s){n(!1,new If(!1,null,!0));return}const a=this.connectionFactory_();this.pendingConnection_=a;const i=o=>{const l=o.loaded,c=o.lengthComputable?o.total:-1;this.progressCallback_!==null&&this.progressCallback_(l,c)};this.progressCallback_!==null&&a.addUploadProgressListener(i),a.send(this.url_,this.method_,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&a.removeUploadProgressListener(i),this.pendingConnection_=null;const o=a.getErrorCode()===Yh.NO_ERROR,l=a.getStatus();if(!o||ZM(l,this.additionalRetryCodes_)&&this.retry){const u=a.getErrorCode()===Yh.ABORT;n(!1,new If(!1,null,u));return}const c=this.successCodes_.indexOf(l)!==-1;n(!0,new If(c,a))})},r=(n,s)=>{const a=this.resolve_,i=this.reject_,o=s.connection;if(s.wasSuccessCode)try{const l=this.callback_(o,o.getResponse());QM(l)?a(l):a()}catch(l){i(l)}else if(o!==null){const l=zM();l.serverResponse=o.getErrorText(),this.errorCallback_?i(this.errorCallback_(o,l)):i(l)}else if(s.canceled){const l=this.appDelete_?$S():WM();i(l)}else{const l=$M();i(l)}};this.canceled_?r(!1,new If(!1,null,!0)):this.backoffId_=XM(t,r,this.timeout_)}getPromise(){return this.promise_}cancel(t){this.canceled_=!0,this.appDelete_=t||!1,this.backoffId_!==null&&YM(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}}class If{constructor(t,r,n){this.wasSuccessCode=t,this.connection=r,this.canceled=!!n}}function tL(e,t){t!==null&&t.length>0&&(e.Authorization="Firebase "+t)}function rL(e,t){e["X-Firebase-Storage-Version"]="webjs/"+(t??"AppManager")}function nL(e,t){t&&(e["X-Firebase-GMPID"]=t)}function sL(e,t){t!==null&&(e["X-Firebase-AppCheck"]=t)}function aL(e,t,r,n,s,a,i=!0){const o=JM(e.urlParams),l=e.url+o,c=Object.assign({},e.headers);return nL(c,t),tL(c,r),rL(c,a),sL(c,n),new eL(l,e.method,c,e.body,e.successCodes,e.additionalRetryCodes,e.handler,e.errorHandler,e.timeout,e.progressCallback,s,i)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function iL(e){if(e.length===0)return null;const t=e.lastIndexOf("/");return t===-1?"":e.slice(0,t)}function oL(e){const t=e.lastIndexOf("/",e.length-2);return t===-1?e:e.slice(t+1)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qh{constructor(t,r){this._service=t,r instanceof ns?this._location=r:this._location=ns.makeFromUrl(r,t.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(t,r){return new Qh(t,r)}get root(){const t=new ns(this._location.bucket,"");return this._newRef(this._service,t)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return oL(this._location.path)}get storage(){return this._service}get parent(){const t=iL(this._location.path);if(t===null)return null;const r=new ns(this._location.bucket,t);return new Qh(this._service,r)}_throwIfRoot(t){if(this._location.path==="")throw KM(t)}}function j_(e,t){const r=t==null?void 0:t[VM];return r==null?null:ns.makeFromBucketSpec(r,e)}function lL(e,t,r,n={}){e.host=`${t}:${r}`,e._protocol="http";const{mockUserToken:s}=n;s&&(e._overrideAuthToken=typeof s=="string"?s:FT(s,e.app.options.projectId))}class cL{constructor(t,r,n,s,a){this.app=t,this._authProvider=r,this._appCheckProvider=n,this._url=s,this._firebaseVersion=a,this._bucket=null,this._host=zS,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=UM,this._maxUploadRetryTime=BM,this._requests=new Set,s!=null?this._bucket=ns.makeFromBucketSpec(s,this._host):this._bucket=j_(this._host,this.app.options)}get host(){return this._host}set host(t){this._host=t,this._url!=null?this._bucket=ns.makeFromBucketSpec(this._url,t):this._bucket=j_(t,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(t){L_("time",0,Number.POSITIVE_INFINITY,t),this._maxUploadRetryTime=t}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(t){L_("time",0,Number.POSITIVE_INFINITY,t),this._maxOperationRetryTime=t}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const t=this._authProvider.getImmediate({optional:!0});if(t){const r=await t.getToken();if(r!==null)return r.accessToken}return null}async _getAppCheckToken(){const t=this._appCheckProvider.getImmediate({optional:!0});return t?(await t.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(t=>t.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(t){return new Qh(this,t)}_makeRequest(t,r,n,s,a=!0){if(this._deleted)return new qM($S());{const i=aL(t,this._appId,n,s,r,this._firebaseVersion,a);return this._requests.add(i),i.getPromise().then(()=>this._requests.delete(i),()=>this._requests.delete(i)),i}}async makeRequestWithTokens(t,r){const[n,s]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(t,r,n,s).getPromise()}}const V_="@firebase/storage",U_="0.13.2";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const WS="storage";function uL(e=bd(),t){e=Ht(e);const n=Su(e,WS).getImmediate({identifier:t}),s=Gg("storage");return s&&fL(n,...s),n}function fL(e,t,r,n={}){lL(e,t,r,n)}function hL(e,{instanceIdentifier:t}){const r=e.getProvider("app").getImmediate(),n=e.getProvider("auth-internal"),s=e.getProvider("app-check-internal");return new cL(r,n,s,t,ro)}function dL(){ai(new ua(WS,hL,"PUBLIC").setMultipleInstances(!0)),Un(V_,U_,""),Un(V_,U_,"esm2017")}dL();/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const HS="functions";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mL{constructor(t,r,n){this.auth=null,this.messaging=null,this.appCheck=null,this.auth=t.getImmediate({optional:!0}),this.messaging=r.getImmediate({optional:!0}),this.auth||t.get().then(s=>this.auth=s,()=>{}),this.messaging||r.get().then(s=>this.messaging=s,()=>{}),this.appCheck||n.get().then(s=>this.appCheck=s,()=>{})}async getAuthToken(){if(this.auth)try{const t=await this.auth.getToken();return t==null?void 0:t.accessToken}catch{return}}async getMessagingToken(){if(!(!this.messaging||!("Notification"in self)||Notification.permission!=="granted"))try{return await this.messaging.getToken()}catch{return}}async getAppCheckToken(t){if(this.appCheck){const r=t?await this.appCheck.getLimitedUseToken():await this.appCheck.getToken();return r.error?null:r.token}return null}async getContext(t){const r=await this.getAuthToken(),n=await this.getMessagingToken(),s=await this.getAppCheckToken(t);return{authToken:r,messagingToken:n,appCheckToken:s}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Rp="us-central1";class pL{constructor(t,r,n,s,a=Rp,i){this.app=t,this.fetchImpl=i,this.emulatorOrigin=null,this.contextProvider=new mL(r,n,s),this.cancelAllRequests=new Promise(o=>{this.deleteService=()=>Promise.resolve(o())});try{const o=new URL(a);this.customDomain=o.origin+(o.pathname==="/"?"":o.pathname),this.region=Rp}catch{this.customDomain=null,this.region=a}}_delete(){return this.deleteService()}_url(t){const r=this.app.options.projectId;return this.emulatorOrigin!==null?`${this.emulatorOrigin}/${r}/${this.region}/${t}`:this.customDomain!==null?`${this.customDomain}/${t}`:`https://${this.region}-${r}.cloudfunctions.net/${t}`}}function gL(e,t,r){e.emulatorOrigin=`http://${t}:${r}`}const B_="@firebase/functions",z_="0.11.8";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vL="auth-internal",xL="app-check-internal",yL="messaging-internal";function _L(e,t){const r=(n,{instanceIdentifier:s})=>{const a=n.getProvider("app").getImmediate(),i=n.getProvider(vL),o=n.getProvider(yL),l=n.getProvider(xL);return new pL(a,i,o,l,s,e)};ai(new ua(HS,r,"PUBLIC").setMultipleInstances(!0)),Un(B_,z_,t),Un(B_,z_,"esm2017")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wL(e=bd(),t=Rp){const n=Su(Ht(e),HS).getImmediate({identifier:t}),s=Gg("functions");return s&&EL(n,...s),n}function EL(e,t,r){gL(Ht(e),t,r)}_L(fetch.bind(self));const TL={apiKey:"AIzaSyAnEPcQISz9FY68mib-0StN6NQtTF3oz1c",authDomain:"xmas-movies.firebaseapp.com",projectId:"xmas-movies",storageBucket:"xmas-movies.firebasestorage.app",messagingSenderId:"721037810395",appId:"1:721037810395:web:1126b377adcc225c944afe"},e0=LT(TL),Tc=O3(e0),GS=new _s;GS.setCustomParameters({prompt:"select_account"});const kL=GS,Je=_M(e0);uL(e0);wL(e0);const KS=z.createContext(void 0),Nn=()=>{const e=z.useContext(KS);if(e===void 0)throw new Error("useAuth must be used within an AuthProvider");return e},SL=({children:e})=>{const[t,r]=z.useState(null),[n,s]=z.useState(null),[a,i]=z.useState(!0),[o,l]=z.useState(null);z.useEffect(()=>{const m=ok(Tc,async p=>{if(r(p),l(null),p)try{const g=Tr(Je,"users",p.uid),x=await Is(g);if(x.exists())await ci(g,{lastLoginAt:OM()},{merge:!0}),s(x.data());else{const w={email:p.email||"",displayName:p.displayName||"User",photoURL:p.photoURL||void 0,createdAt:new Date,lastLoginAt:new Date};await ci(g,w),s({id:p.uid,...w})}}catch(g){console.error("Error fetching user profile:",g),l("Failed to load user profile")}else s(null);i(!1)});return()=>m()},[]);const d={currentUser:t,userProfile:n,isLoading:a,error:o,signInWithGoogle:async()=>{try{l(null),i(!0);const m=new _s;await xk(Tc,m)}catch(m){console.error("Login error:",m),l(m.message||"Failed to sign in")}finally{i(!1)}},signOut:async()=>{try{await SD(Tc)}catch(m){console.error("Sign out error:",m),l(m.message||"Failed to sign out")}}};return h.jsx(KS.Provider,{value:d,children:e})},ju=()=>{const[e,t]=z.useState(!1),[r,n]=z.useState(!0),[s,a]=z.useState(null),[i,o]=z.useState(null);return z.useEffect(()=>{const l=ok(Tc,async c=>{if(n(!0),a(null),!c){t(!1),o(null),n(!1);return}o({uid:c.uid,email:c.email});try{const d=(await GT(c,!0)).claims.admin===!0;t(d)}catch(u){console.error("Error checking admin status:",u),a("Failed to verify admin status"),t(!1)}finally{n(!1)}});return()=>l()},[]),{isAdmin:e,loading:r,error:s,currentUser:i}},AL=({snowflakeCount:e=100,mobileSnowflakeCount:t=50})=>{const[r,n]=z.useState(!1),[s,a]=z.useState(e),i=z.useRef(null),o=z.useRef([]),l=z.useRef(0);return z.useEffect(()=>{const c=()=>{const u=window.matchMedia("(max-width: 768px)").matches;n(u),a(u?t:e)};return c(),window.addEventListener("resize",c),()=>{window.removeEventListener("resize",c)}},[e,t]),z.useEffect(()=>{const c=i.current;if(!c)return;const u=c.getContext("2d");if(!u)return;const d=()=>{c.width=window.innerWidth,c.height=window.innerHeight},m=()=>{o.current=[];for(let w=0;w<s;w++)o.current.push({x:Math.random()*c.width,y:Math.random()*c.height,size:r?Math.random()*3+1:Math.random()*4+1,speed:r?Math.random()*.8+.3:Math.random()*1+.5,opacity:r?Math.random()*.5+.2:Math.random()*.6+.3,wind:r?Math.random()*.3-.15:Math.random()*.5-.25})},p=w=>{u.beginPath(),u.arc(w.x,w.y,w.size,0,Math.PI*2),u.fillStyle=`rgba(255, 255, 255, ${w.opacity})`,u.fill()},g=w=>{w.y+=w.speed,w.x+=w.wind,w.y>c.height&&(w.y=-10,w.x=Math.random()*c.width),w.x>c.width?w.x=0:w.x<0&&(w.x=c.width)},x=()=>{u.clearRect(0,0,c.width,c.height),o.current.forEach(w=>{p(w),g(w)}),l.current=requestAnimationFrame(x)};return window.addEventListener("resize",d),d(),m(),x(),()=>{window.removeEventListener("resize",d),cancelAnimationFrame(l.current)}},[s]),h.jsx("canvas",{ref:i,className:"fixed top-0 left-0 w-full h-full pointer-events-none z-10","aria-hidden":"true"})},IL=()=>{const[e,t]=z.useState(!1),[r,n]=z.useState(null),[s,a]=z.useState(!1);z.useEffect(()=>{const l=/iPad|iPhone|iPod/.test(navigator.userAgent)&&!window.MSStream;a(l);const c=u=>{u.preventDefault(),n(u),t(!0)};return window.addEventListener("beforeinstallprompt",c),window.matchMedia("(display-mode: standalone)").matches&&t(!1),()=>{window.removeEventListener("beforeinstallprompt",c)}},[]);const i=async()=>{if(!r)return;r.prompt();const{outcome:l}=await r.userChoice;n(null),t(!1),console.log(`User ${l==="accepted"?"accepted":"dismissed"} the install prompt`)},o=()=>{t(!1),localStorage.setItem("installPromptDismissed","true")};return e?h.jsxs("div",{className:"fixed bottom-0 left-0 right-0 bg-green-800 text-white p-4 shadow-lg z-50 flex items-center justify-between",children:[h.jsxs("div",{className:"flex items-center",children:[h.jsx("div",{className:"mr-3 text-2xl",children:h.jsx("i",{className:"fas fa-gift"})}),h.jsx("div",{children:s?h.jsxs("p",{children:["Install this app on your device: tap ",h.jsx("i",{className:"fas fa-share"}),' and then "Add to Home Screen"']}):h.jsx("p",{children:"Add Christmas Movies to your home screen!"})})]}),h.jsxs("div",{className:"flex items-center",children:[!s&&h.jsx("button",{onClick:i,className:"bg-red-700 hover:bg-red-800 text-white py-1 px-4 rounded-full mr-2",children:"Install"}),h.jsx("button",{onClick:o,className:"bg-transparent hover:bg-green-700 text-white py-1 px-2 rounded-full",children:h.jsx("i",{className:"fas fa-times"})})]})]}):null};function CL(){const{currentUser:e}=Nn(),{isAdmin:t}=ju(),[r,n]=z.useState(!1),s=ya();z.useEffect(()=>(r?document.body.style.overflow="hidden":document.body.style.overflow="",()=>{document.body.style.overflow=""}),[r]),z.useEffect(()=>{r&&n(!1)},[s.pathname]);const a=()=>{n(!r)};return h.jsxs("div",{className:"min-h-screen bg-gradient-to-b from-xmas-bg to-xmas-card bg-opacity-95",children:[h.jsx(AL,{snowflakeCount:150,mobileSnowflakeCount:40}),h.jsx(IL,{}),h.jsxs("div",{className:"navbar bg-gradient-to-r from-xmas-card via-xmas-card to-xmas-bg border-b border-xmas-gold px-2 sm:px-4 shadow-lg relative overflow-hidden",children:[h.jsx("div",{className:"absolute top-0 left-0 w-full h-1 bg-gradient-to-r from-xmas-gold via-transparent to-xmas-gold opacity-60"}),h.jsx("div",{className:"absolute -bottom-4 left-0 right-0 h-8 snow-accumulation-fast"}),h.jsxs("div",{className:"flex items-center",children:[h.jsx("button",{className:"btn btn-ghost btn-sm md:hidden relative z-10",onClick:a,"aria-label":"Toggle navigation menu",children:h.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",className:"inline-block w-5 h-5 stroke-current",children:h.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M4 6h16M4 12h16M4 18h16"})})}),h.jsxs(tt,{to:"/",className:"hidden sm:flex items-center group",children:[h.jsxs("div",{className:"relative",children:[h.jsx("div",{className:"absolute -inset-1 bg-gradient-to-r from-xmas-gold to-xmas-line rounded-full opacity-70 group-hover:opacity-100 blur transition duration-200"}),h.jsx("div",{className:"relative flex items-center justify-center w-10 h-10 bg-xmas-card rounded-full border border-xmas-gold overflow-hidden",children:h.jsx("img",{src:"/Santa.png",alt:"Santa",className:"w-full h-full object-cover group-hover:scale-110 transition-transform duration-300"})})]}),h.jsx("div",{className:"ml-3 font-christmas text-xl sm:text-2xl bg-gradient-to-br from-xmas-gold via-xmas-snow to-xmas-gold bg-clip-text text-transparent font-bold",children:"Christmas Movies"})]}),h.jsxs(tt,{to:"/",className:"sm:hidden flex items-center",children:[h.jsx("div",{className:"w-8 h-8 flex items-center justify-center rounded-full bg-xmas-card border border-xmas-gold overflow-hidden",children:h.jsx("img",{src:"/Santa.png",alt:"Santa",className:"w-full h-full object-cover"})}),h.jsx("span",{className:"ml-2 font-christmas text-lg text-xmas-gold",children:"Christmas Movies"})]})]}),h.jsx("div",{className:"flex-1"}),h.jsxs("div",{className:"flex items-center gap-1 sm:gap-2",children:[e&&h.jsxs(tt,{to:"/profile",className:"btn btn-primary btn-sm hidden md:flex",children:[h.jsx("i",{className:"fas fa-user-circle mr-1"})," Profile"]}),e?h.jsxs("div",{className:"dropdown dropdown-end",children:[h.jsx("label",{tabIndex:0,className:"btn btn-ghost btn-circle avatar cursor-pointer",children:h.jsx("div",{className:"w-10 rounded-full border border-xmas-gold",children:e.photoURL?h.jsx("img",{src:e.photoURL,alt:"Profile"}):h.jsx("div",{className:"bg-xmas-card flex items-center justify-center h-full",children:h.jsx("i",{className:"fas fa-user text-xmas-gold"})})})}),h.jsxs("ul",{tabIndex:0,className:"dropdown-content menu menu-sm mt-3 z-[1] p-2 shadow bg-xmas-card rounded-box w-52 border border-xmas-gold",children:[h.jsx("li",{children:h.jsxs(tt,{to:"/profile",className:"justify-between",children:["Profile",h.jsx("i",{className:"fas fa-user-circle"})]})}),h.jsx("li",{children:h.jsxs(tt,{to:"/movies",children:["My Movies",h.jsx("i",{className:"fas fa-film"})]})}),h.jsx("li",{children:h.jsxs(tt,{to:"/random",children:["Random Movie",h.jsx("i",{className:"fas fa-random"})]})}),h.jsx("li",{children:h.jsxs(tt,{to:"/import",children:["Import Movies",h.jsx("i",{className:"fas fa-file-import"})]})}),t&&h.jsx("li",{children:h.jsxs(tt,{to:"/admin",className:"text-xmas-gold",children:["Admin Dashboard",h.jsx("i",{className:"fas fa-crown"})]})})]})]}):h.jsxs(tt,{to:"/login",className:"btn btn-primary btn-sm",children:[h.jsx("i",{className:"fas fa-sign-in-alt mr-1"})," Sign In"]})]})]}),h.jsx("div",{className:`fixed inset-0 bg-black bg-opacity-70 z-20 transition-opacity duration-300 md:hidden ${r?"opacity-100":"opacity-0 pointer-events-none"}`,onClick:a}),h.jsxs("div",{className:`fixed top-0 left-0 h-full w-72 bg-gradient-to-b from-xmas-bg to-xmas-card border-r border-xmas-gold z-30 transform transition-transform duration-300 ease-in-out md:hidden shadow-xl ${r?"translate-x-0":"-translate-x-full"}`,children:[h.jsxs("div",{className:"relative overflow-hidden",children:[h.jsx("div",{className:"absolute top-0 left-0 w-full h-1 bg-gradient-to-r from-xmas-gold via-transparent to-xmas-gold opacity-60"}),h.jsxs("div",{className:"flex justify-between items-center p-4 border-b border-xmas-gold bg-xmas-card bg-opacity-80",children:[h.jsxs("div",{className:"flex items-center",children:[h.jsx("div",{className:"w-9 h-9 flex items-center justify-center rounded-full bg-xmas-card border border-xmas-gold shadow-lg overflow-hidden",children:h.jsx("img",{src:"/Santa.png",alt:"Santa",className:"w-full h-full object-cover"})}),h.jsx("div",{className:"ml-3 font-christmas text-xl bg-gradient-to-br from-xmas-gold via-xmas-snow to-xmas-gold bg-clip-text text-transparent font-bold",children:"Christmas Movies"})]}),h.jsx("button",{className:"btn btn-ghost btn-sm text-xmas-text hover:text-xmas-line",onClick:a,"aria-label":"Close navigation menu",children:h.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:h.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})]}),h.jsx("div",{className:"overflow-y-auto h-full pb-20",children:h.jsx("div",{className:"p-4 pt-6",children:h.jsxs("div",{className:"mb-6",children:[h.jsx("h3",{className:"font-christmas text-xl text-xmas-gold mb-4 pl-2 border-l-2 border-xmas-line",children:"Navigation"}),h.jsxs("ul",{className:"space-y-3",children:[h.jsx("li",{children:h.jsx(Sa,{to:"/",onClick:a,className:({isActive:i})=>i?"flex items-center p-2 pl-3 rounded-md bg-gradient-to-r from-xmas-card to-transparent border-l-2 border-xmas-gold text-xmas-gold font-medium":"flex items-center p-2 pl-3 rounded-md hover:bg-xmas-card hover:bg-opacity-50 text-xmas-text hover:text-xmas-gold transition-all duration-200",children:({isActive:i})=>h.jsxs(h.Fragment,{children:[h.jsx("i",{className:"fas fa-home mr-3 text-xmas-gold"}),h.jsx("span",{children:"Home"}),h.jsx("i",{className:`fas fa-snowflake ml-auto text-xmas-gold opacity-70 ${i?"visible":"invisible"}`})]})})}),e?h.jsxs(h.Fragment,{children:[h.jsx("li",{children:h.jsx(Sa,{to:"/movies",onClick:a,className:({isActive:i})=>i?"flex items-center p-2 pl-3 rounded-md bg-gradient-to-r from-xmas-card to-transparent border-l-2 border-xmas-gold text-xmas-gold font-medium":"flex items-center p-2 pl-3 rounded-md hover:bg-xmas-card hover:bg-opacity-50 text-xmas-text hover:text-xmas-gold transition-all duration-200",children:({isActive:i})=>h.jsxs(h.Fragment,{children:[h.jsx("i",{className:"fas fa-film mr-3 text-xmas-gold"}),h.jsx("span",{children:"My Movies"}),h.jsx("i",{className:`fas fa-snowflake ml-auto text-xmas-gold opacity-70 ${i?"visible":"invisible"}`})]})})}),h.jsx("li",{children:h.jsx(Sa,{to:"/random",onClick:a,className:({isActive:i})=>i?"flex items-center p-2 pl-3 rounded-md bg-gradient-to-r from-xmas-card to-transparent border-l-2 border-xmas-gold text-xmas-gold font-medium":"flex items-center p-2 pl-3 rounded-md hover:bg-xmas-card hover:bg-opacity-50 text-xmas-text hover:text-xmas-gold transition-all duration-200",children:({isActive:i})=>h.jsxs(h.Fragment,{children:[h.jsx("i",{className:"fas fa-random mr-3 text-xmas-gold"}),h.jsx("span",{children:"Random Movie"}),h.jsx("i",{className:`fas fa-snowflake ml-auto text-xmas-gold opacity-70 ${i?"visible":"invisible"}`})]})})}),h.jsx("li",{children:h.jsx(Sa,{to:"/achievements",onClick:a,className:({isActive:i})=>i?"flex items-center p-2 pl-3 rounded-md bg-gradient-to-r from-xmas-card to-transparent border-l-2 border-xmas-gold text-xmas-gold font-medium":"flex items-center p-2 pl-3 rounded-md hover:bg-xmas-card hover:bg-opacity-50 text-xmas-text hover:text-xmas-gold transition-all duration-200",children:({isActive:i})=>h.jsxs(h.Fragment,{children:[h.jsx("i",{className:"fas fa-trophy mr-3 text-xmas-gold"}),h.jsx("span",{children:"Achievements"}),h.jsx("i",{className:`fas fa-snowflake ml-auto text-xmas-gold opacity-70 ${i?"visible":"invisible"}`})]})})}),h.jsx("li",{children:h.jsx(Sa,{to:"/import",onClick:a,className:({isActive:i})=>i?"flex items-center p-2 pl-3 rounded-md bg-gradient-to-r from-xmas-card to-transparent border-l-2 border-xmas-gold text-xmas-gold font-medium":"flex items-center p-2 pl-3 rounded-md hover:bg-xmas-card hover:bg-opacity-50 text-xmas-text hover:text-xmas-gold transition-all duration-200",children:({isActive:i})=>h.jsxs(h.Fragment,{children:[h.jsx("i",{className:"fas fa-file-import mr-3 text-xmas-gold"}),h.jsx("span",{children:"Add Movies"}),h.jsx("i",{className:`fas fa-snowflake ml-auto text-xmas-gold opacity-70 ${i?"visible":"invisible"}`})]})})}),h.jsx("li",{children:h.jsx(Sa,{to:"/profile",onClick:a,className:({isActive:i})=>i?"flex items-center p-2 pl-3 rounded-md bg-gradient-to-r from-xmas-card to-transparent border-l-2 border-xmas-gold text-xmas-gold font-medium":"flex items-center p-2 pl-3 rounded-md hover:bg-xmas-card hover:bg-opacity-50 text-xmas-text hover:text-xmas-gold transition-all duration-200",children:({isActive:i})=>h.jsxs(h.Fragment,{children:[h.jsx("i",{className:"fas fa-user-circle mr-3 text-xmas-gold"}),h.jsx("span",{children:"Profile"}),h.jsx("i",{className:`fas fa-snowflake ml-auto text-xmas-gold opacity-70 ${i?"visible":"invisible"}`})]})})}),t&&h.jsx("li",{children:h.jsx(Sa,{to:"/admin",onClick:a,className:({isActive:i})=>i?"flex items-center p-2 pl-3 rounded-md bg-gradient-to-r from-xmas-card to-transparent border-l-2 border-xmas-gold text-xmas-gold font-medium":"flex items-center p-2 pl-3 rounded-md hover:bg-xmas-card hover:bg-opacity-50 text-xmas-text hover:text-xmas-gold transition-all duration-200",children:({isActive:i})=>h.jsxs(h.Fragment,{children:[h.jsx("i",{className:"fas fa-crown mr-3 text-xmas-gold"}),h.jsx("span",{children:"Admin Dashboard"}),h.jsx("i",{className:`fas fa-snowflake ml-auto text-xmas-gold opacity-70 ${i?"visible":"invisible"}`})]})})})]}):h.jsx("li",{children:h.jsx(Sa,{to:"/login",onClick:a,className:({isActive:i})=>i?"flex items-center p-2 pl-3 rounded-md bg-gradient-to-r from-xmas-card to-transparent border-l-2 border-xmas-gold text-xmas-gold font-medium":"flex items-center p-2 pl-3 rounded-md hover:bg-xmas-card hover:bg-opacity-50 text-xmas-text hover:text-xmas-gold transition-all duration-200",children:({isActive:i})=>h.jsxs(h.Fragment,{children:[h.jsx("i",{className:"fas fa-sign-in-alt mr-3 text-xmas-gold"}),h.jsx("span",{children:"Sign In"}),h.jsx("i",{className:`fas fa-snowflake ml-auto text-xmas-gold opacity-70 ${i?"visible":"invisible"}`})]})})})]})]})})})]}),h.jsx("main",{className:"p-4",children:h.jsx(ST,{})}),h.jsx("div",{className:"fixed bottom-0 left-0 w-full pointer-events-none",children:h.jsx("div",{className:"container mx-auto",children:h.jsxs("div",{className:"relative h-16",children:[h.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-px bg-gradient-to-r from-xmas-gold via-transparent to-xmas-gold opacity-40"}),h.jsx("div",{className:"absolute bottom-4 left-4 opacity-30",children:h.jsx("i",{className:"fas fa-tree text-4xl text-xmas-gold"})}),h.jsx("div",{className:"absolute bottom-4 right-4 opacity-30",children:h.jsx("i",{className:"fas fa-star text-4xl text-xmas-gold"})})]})})})]})}const qS=z.createContext(null);function NL({children:e}){const[t,r]=z.useState([]),n=z.useCallback(i=>{r(o=>o.filter(l=>l.id!==i))},[]),s=z.useCallback((i,o)=>{const l=Math.random().toString(36).slice(2);r(c=>[...c,{id:l,kind:i,message:o}]),setTimeout(()=>n(l),3e3)},[n]),a=z.useMemo(()=>({push:s}),[s]);return h.jsxs(qS.Provider,{value:a,children:[e,h.jsx("div",{className:"fixed top-4 right-4 z-50 space-y-2",children:t.map(i=>h.jsxs("div",{className:`alert shadow-lg max-w-sm ${i.kind==="success"?"alert-success":i.kind==="error"?"alert-error":"alert-info"}`,children:[h.jsxs("div",{children:[i.kind==="success"?"":i.kind==="error"?"":"",h.jsx("span",{className:"ml-2",children:i.message})]}),h.jsx("button",{className:"btn btn-ghost btn-sm",onClick:()=>n(i.id),children:""})]},i.id))})]})}function RL(){const e=z.useContext(qS);if(!e)throw new Error("useToast must be used inside <ToastProvider>");return{success:t=>e.push("success",t),error:t=>e.push("error",t),info:t=>e.push("info",t)}}const $_=({children:e})=>{const{currentUser:t,isLoading:r}=Nn();return r?h.jsx("div",{className:"flex justify-center items-center min-h-[60vh]",children:h.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-xmas-gold"})}):t?e?h.jsx(h.Fragment,{children:e}):h.jsx(ST,{}):h.jsx(VR,{to:"/login"})},Xo=[{id:"first_snowflake",name:"First Snowflake",description:"You logged your very first watched Christmas movie.",hint:"Watch 1 movie.",icon:"",check:e=>e.totalWatched>=1},{id:"snowball_starter",name:"Snowball Starter",description:"You have started to build your festive watchlist.",hint:"Watch 5 movies.",icon:"",check:e=>e.totalWatched>=5},{id:"blizzard_binger",name:"Blizzard Binger",description:"You powered through a flurry of festive films.",hint:"Watch 20 movies.",icon:"",check:e=>e.totalWatched>=20},{id:"christmas_marathoner",name:"Christmas Marathoner",description:"You turned Christmas movies into a marathon event.",hint:"Watch 50 movies.",icon:"",check:e=>e.totalWatched>=50},{id:"twelve_days",name:"12 Days of Christmas",description:"You kept the festive streak going for 12 days.",hint:"Watch a movie daily for 12 days.",icon:"",check:e=>e.hasTwelveDayStreak},{id:"the_grinch",name:"The Grinch",description:"Not every movie can be a Christmas miracle.",hint:"Give a movie 1.",icon:"",check:e=>e.lowRatingAny},{id:"santas_favourite",name:"Santa's Favourite",description:"You found a film worthy of Santa himself.",hint:"Give a movie a perfect 10.",icon:"",check:e=>e.highRatingAny},{id:"the_critic",name:"The Critic",description:"You have opinions on a lot of movies.",hint:"Rate 20 movies.",icon:"",check:e=>e.totalRated>=20},{id:"nice_list",name:"Nice List",description:"You are generous with your festive ratings.",hint:"Keep your average rating above 5.",icon:"",check:e=>e.averageRating>5},{id:"classic_connoisseur",name:"Classic Connoisseur",description:"You appreciate the classics before Y2K.",hint:"Watch 5 movies released before 2000.",icon:"",check:e=>e.classicWatched>=5},{id:"animated_joy",name:"Animated Joy",description:"You love animated festive adventures.",hint:"Watch 5 animated Christmas movies.",icon:"",check:e=>e.animatedCount>=5},{id:"romcom_reindeer",name:"Rom-Com Reindeer",description:"You love a festive rom-com.",hint:"Watch 5 Christmas romance movies.",icon:"",check:e=>e.romanceCount>=5},{id:"decorator",name:"Decorator",description:"You have a whole row of favourites lit up.",hint:"Mark 10 movies as favourite.",icon:"",check:e=>e.favoriteCount>=10},{id:"elf_mode",name:"Elf Mode",description:"You keep coming back like a dedicated Christmas elf.",hint:"Use the app on 10 different days.",icon:"",check:e=>e.usageDistinctDays>=10},{id:"christmas_eve_watcher",name:"Christmas Eve Watcher",description:"You watched a movie on Christmas Eve.",hint:"Watch a movie on Dec 24.",icon:"",check:e=>e.hasChristmasEveWatch},{id:"new_years_cozy",name:"New Year's Cozy",description:"You started the year with a cozy movie.",hint:"Watch a movie on Jan 1.",icon:"",check:e=>e.hasNewYearsWatch}];function W_(e){if(!e)return null;if(e instanceof Date)return e;if(typeof e.toDate=="function")return e.toDate();if(typeof e=="object"&&"seconds"in e)return new Date(e.seconds*1e3);if(typeof e=="string"){const t=new Date(e);if(!isNaN(t.getTime()))return t}return null}function bL(e,t){let r=0,n=0,s=0,a=0,i=0,o=0,l=0,c=!1,u=!1;const d=new Set,m=new Set,p=new Set;for(const M of e){if(M.watched){r++;const v=W_(M.watchedDate);if(v){const S=v.toISOString().split("T")[0];p.add(S);const I=v.getMonth();v.getDate(),I===11&&d.add(S)}const _=t[M.movieId];_&&_.releaseDate&&_.releaseDate.substring(0,4)<"2000"&&a++,_&&_.genres&&_.genres.includes("Romance")&&i++,_&&_.genres&&_.genres.includes("Animation")&&o++}M.favorite&&l++,typeof M.rating=="number"&&(n++,s+=M.rating,M.rating<=1&&(c=!0),M.rating>=10&&(u=!0));const O=W_(M.updatedAt||M.addedAt);if(O){const v=O.toISOString().split("T")[0];m.add(v)}}const g=Array.from(p).map(M=>{const O=new Date(M+"T00:00:00Z");return Math.floor(O.getTime()/864e5)}).sort((M,O)=>M-O);let x=!1,w=0,k=null;for(const M of g){if(k===null||M===k+1?w+=1:M!==k&&(w=1),w>=12){x=!0;break}k=M}let T=!1,E=!1;for(const M of p){const O=new Date(M+"T00:00:00Z"),v=O.getMonth(),_=O.getDate();v===11&&_===24&&(T=!0),v===0&&_===1&&(E=!0)}const N=n>0?s/n:0;return{totalWatched:r,totalRated:n,averageRating:N,lowRatingAny:c,highRatingAny:u,classicWatched:a,romanceCount:i,animatedCount:o,favoriteCount:l,usageDistinctDays:m.size,decemberDistinctDays:d.size,hasChristmasEveWatch:T,hasNewYearsWatch:E,hasTwelveDayStreak:x}}async function ah(e){const t=await kr(ir(Je,`users/${e}/movies`)),r=[],n=new Set;t.forEach(u=>{const d=u.data();r.push({id:u.id,...d}),d.movieId&&n.add(d.movieId)});const s={};if(n.size){const u=Array.from(n);for(const d of u){(await kr(ir(Je,"movies"))).forEach(p=>{const g=p.data();s[p.id]={id:p.id,...g}});break}}const a=bL(r,s),i=ir(Je,`users/${e}/achievements`),o=await kr(i),l=new Set;o.forEach(u=>l.add(u.id));const c=[];for(const u of Xo)!l.has(u.id)&&u.check(a)&&(c.push(u.id),await ci(Tr(Je,`users/${e}/achievements`,u.id),{unlockedAt:new Date,seen:!1}));return c}const PL=()=>{const{currentUser:e}=Nn(),[t,r]=z.useState(new Date),[n,s]=z.useState(null),[a,i]=z.useState(null),o=Xo.length;z.useEffect(()=>{const u=setInterval(()=>r(new Date),1e3);return()=>clearInterval(u)},[]);const l=z.useMemo(()=>{const u=t.getFullYear(),d=new Date(u,11,25,0,0,0);return t>d?new Date(u+1,11,25,0,0,0):d},[t]),c=z.useMemo(()=>{const u=l.getTime()-t.getTime(),d=Math.max(0,Math.floor(u/1e3)),m=Math.floor(d/86400),p=Math.floor(d%86400/3600),g=Math.floor(d%3600/60),x=d%60;return{days:m,hours:p,minutes:g,seconds:x}},[t,l]);return z.useEffect(()=>{const u=Tr(Je,"stats","global"),d=FM(u,m=>{const p=m.data();s(typeof(p==null?void 0:p.watchedTotal)=="number"?p.watchedTotal:0)});return()=>d()},[]),z.useEffect(()=>{if(!e){i(null);return}(async()=>{try{const d=ir(Je,`users/${e.uid}/achievements`),m=await kr(d);i(m.size)}catch(d){console.error("Error loading achievements count",d),i(null)}})()},[e]),h.jsxs("div",{className:"container mx-auto px-4 py-8",children:[h.jsxs("div",{className:"text-center mb-12",children:[h.jsx("h1",{className:"font-christmas text-5xl md:text-7xl text-xmas-line mb-4",children:"My Christmas Movies"}),h.jsx("p",{className:"text-xl md:text-2xl text-xmas-snow mb-8",children:"Track, rate, and discover your favourite Christmas movies!"}),h.jsx("div",{className:"flex flex-col md:flex-row justify-center gap-6 mb-4 md:mb-6",children:e?h.jsxs(h.Fragment,{children:[h.jsxs(tt,{to:"/movies",className:"btn btn-primary btn-lg text-xl px-8 py-3 rounded-md shadow-lg hover:shadow-xl transition-all duration-300 border border-xmas-gold border-opacity-30",children:[h.jsx("i",{className:"fas fa-film mr-2"})," My Movies"]}),h.jsxs(tt,{to:"/random",className:"btn btn-primary btn-lg text-xl px-8 py-3 rounded-md shadow-lg hover:shadow-xl transition-all duration-300 border border-xmas-gold border-opacity-30",children:[h.jsx("i",{className:"fas fa-random mr-2"})," Random Movie"]}),h.jsxs(tt,{to:"/achievements",className:"btn btn-primary btn-lg text-xl px-8 py-3 rounded-md shadow-lg hover:shadow-xl transition-all duration-300 border border-xmas-gold border-opacity-30",children:[h.jsx("i",{className:"fas fa-trophy mr-2"})," Achievements"]})]}):h.jsxs(tt,{to:"/login",className:"btn btn-primary btn-lg text-xl px-8 py-3 rounded-md shadow-lg hover:shadow-xl transition-all duration-300 border border-xmas-gold border-opacity-30",children:[h.jsx("i",{className:"fas fa-sign-in-alt mr-2"})," Sign In"]})})]}),h.jsx("div",{className:"w-full max-w-4xl mx-auto mb-8",children:h.jsx("div",{className:"h-px bg-gradient-to-r from-transparent via-xmas-gold to-transparent"})}),h.jsxs("div",{className:"bg-xmas-card rounded-lg shadow-xl p-6 mb-12 border border-xmas-gold border-opacity-30 relative",children:[h.jsx("h2",{className:"font-christmas text-3xl text-xmas-gold text-center mb-6",children:"Countdown to Christmas"}),h.jsxs("div",{className:"grid md:grid-cols-2 gap-6 items-stretch",children:[h.jsxs("div",{className:"bg-xmas-card bg-opacity-70 p-6 rounded-lg shadow-md border-l-2 border-xmas-line flex flex-col items-center justify-center",children:[h.jsxs("div",{className:"text-5xl md:text-6xl font-bold text-xmas-line mb-2",children:[c.days,"d ",c.hours,"h ",c.minutes,"m ",c.seconds,"s"]}),h.jsx("p",{className:"text-xmas-text text-opacity-80",children:"until Christmas Day"})]}),h.jsxs("div",{className:"bg-xmas-card bg-opacity-70 p-6 rounded-lg shadow-md border-l-2 border-xmas-gold flex flex-col items-center justify-center",children:[h.jsx("div",{className:"text-5xl md:text-6xl font-bold text-xmas-gold mb-2",children:n??""}),h.jsx("p",{className:"text-xmas-text text-opacity-80 text-center",children:"total movies watched"})]})]})]}),h.jsxs("div",{className:"bg-xmas-card rounded-lg shadow-xl p-6 mb-12 border border-xmas-gold border-opacity-20 snow-accumulation snow-accumulation-slow relative",children:[h.jsx("h2",{className:"font-christmas text-3xl text-xmas-line mb-6 text-center",children:"Features"}),h.jsxs("div",{className:"grid md:grid-cols-4 gap-6",children:[h.jsxs("div",{className:"bg-xmas-card bg-opacity-70 p-6 rounded-lg shadow-md border-l-2 border-xmas-line",children:[h.jsx("div",{className:"text-3xl text-xmas-gold mb-4 text-center",children:h.jsx("i",{className:"fas fa-search"})}),h.jsx("h3",{className:"font-christmas text-xl text-center mb-3",children:"Find Movies"}),h.jsx("p",{className:"text-center text-xmas-text text-opacity-80",children:"Search and discover Christmas movies using TMDB integration"})]}),h.jsxs("div",{className:"bg-xmas-card bg-opacity-70 p-6 rounded-lg shadow-md border-l-2 border-xmas-gold",children:[h.jsx("div",{className:"text-3xl text-xmas-gold mb-4 text-center",children:h.jsx("i",{className:"fas fa-star"})}),h.jsx("h3",{className:"font-christmas text-xl text-center mb-3",children:"Rate & Review"}),h.jsx("p",{className:"text-center text-xmas-text text-opacity-80",children:"Keep track of movies you've watched and rate them"})]}),h.jsxs("div",{className:"bg-xmas-card bg-opacity-70 p-6 rounded-lg shadow-md border-l-2 border-xmas-line",children:[h.jsx("div",{className:"text-3xl text-xmas-gold mb-4 text-center",children:h.jsx("i",{className:"fas fa-random"})}),h.jsx("h3",{className:"font-christmas text-xl text-center mb-3",children:"Random Picker"}),h.jsx("p",{className:"text-center text-xmas-text text-opacity-80",children:"Can't decide what to watch? Let our random movie picker help!"})]}),h.jsxs("div",{className:"bg-xmas-card bg-opacity-70 p-6 rounded-lg shadow-md border-l-2 border-xmas-line",children:[h.jsx("div",{className:"text-3xl text-xmas-gold mb-4 text-center",children:h.jsx("i",{className:"fas fa-trophy"})}),h.jsx("h3",{className:"font-christmas text-xl text-center mb-3",children:"Achievements"}),h.jsx("p",{className:"text-center text-xmas-text text-opacity-80 mb-2",children:"Unlock festive badges as you watch, rate, and explore."}),e&&h.jsx("p",{className:"text-center text-xmas-text text-opacity-80 font-medium",children:typeof a=="number"?`${a} / ${o} unlocked`:`${o} to discover`})]})]})]}),h.jsx("div",{className:"bg-xmas-card rounded-lg shadow-xl p-6 mb-12 border border-xmas-gold border-opacity-30 snow-accumulation snow-accumulation-fast relative",children:h.jsxs("div",{className:"mb-6 text-center",children:[h.jsxs("h2",{className:"font-christmas text-3xl md:text-4xl text-xmas-gold inline-block relative",children:[h.jsx("span",{className:"relative z-10",children:"Create Your Collection"}),h.jsx("span",{className:"absolute -bottom-2 left-0 right-0 h-1 bg-xmas-gold opacity-30 rounded-full"})]}),h.jsx("p",{className:"mt-4 mb-6",children:"Add movies to your collection and rate them"}),e?h.jsxs(tt,{to:"/import",className:"btn btn-primary",children:[h.jsx("i",{className:"fas fa-file-import mr-2"})," Add Movies"]}):h.jsxs(tt,{to:"/login",className:"btn btn-primary",children:[h.jsx("i",{className:"fas fa-sign-in-alt mr-2"})," Sign In to Add"]})]})}),h.jsx("div",{className:"w-full max-w-4xl mx-auto mb-8",children:h.jsx("div",{className:"h-px bg-gradient-to-r from-transparent via-xmas-gold to-transparent"})}),h.jsxs("footer",{className:"text-center text-xmas-mute mt-12 pb-8 space-y-4",children:[h.jsxs("p",{children:[" ",new Date().getFullYear()," Christmas Movie Database"]}),h.jsxs("div",{className:"flex flex-col items-center justify-center gap-2 text-xs md:text-sm text-xmas-mute/80",children:[h.jsx("a",{href:"https://www.themoviedb.org",target:"_blank",rel:"noopener noreferrer",className:"btn flex items-center justify-center gap-2",children:h.jsx("img",{src:"/tmdb.svg",alt:"TMDB logo",className:"h-6 md:h-8 w-auto mb-1"})}),h.jsx("p",{className:"max-w-xl px-4",children:"This product uses the TMDB API but is not endorsed or certified by TMDB."})]})]})]})},DL=()=>{const e=gi(),{currentUser:t,isLoading:r,error:n,signInWithGoogle:s}=Nn();z.useEffect(()=>{t&&!r&&e("/")},[t,r,e]);const a=async()=>{try{await s()}catch(i){console.error("Login failed:",i)}};return r?h.jsx("div",{className:"flex justify-center items-center min-h-[60vh]",children:h.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-xmas-gold"})}):h.jsx("div",{className:"container mx-auto px-4 py-12",children:h.jsxs("div",{className:"max-w-md mx-auto",children:[h.jsxs("div",{className:"text-center mb-8",children:[h.jsx("h1",{className:"font-christmas text-4xl text-xmas-line mb-2",children:"Christmas Movie Database"}),h.jsx("p",{className:"text-xmas-mute",children:"Sign in to manage your Christmas movie collection"})]}),h.jsxs("div",{className:"bg-xmas-card rounded-lg shadow-lg p-6",children:[n&&h.jsx("div",{className:"bg-error bg-opacity-10 border-l-4 border-error p-4 mb-6 rounded",children:h.jsx("p",{className:"text-error",children:n})}),h.jsxs("div",{className:"text-center mb-6",children:[h.jsx("p",{className:"mb-4",children:"Sign in with your Google account to access your Christmas movie collection."}),h.jsx("p",{className:"text-sm text-xmas-mute mb-6",children:"Track, rate, and discover Christmas movies!"}),h.jsxs("button",{onClick:a,className:"btn btn-primary w-full flex items-center justify-center gap-2",children:[h.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 48 48",children:[h.jsx("path",{fill:"#FFC107",d:`M43.611,20.083H42V20H24v8h11.303c-1.649,4.657-6.08,8-11.303,8c-6.627,0-12-5.373-12-12
                  s5.373-12,12-12c3.059,0,5.842,1.154,7.961,3.039l5.657-5.657C34.046,6.053,29.268,4,24,4C12.955,4,4,12.955,4,24s8.955,20,20,20
                  s20-8.955,20-20C44,22.659,43.862,21.35,43.611,20.083z`}),h.jsx("path",{fill:"#FF3D00",d:`M6.306,14.691l6.571,4.819C14.655,15.108,18.961,12,24,12c3.059,0,5.842,1.154,7.961,3.039
                  l5.657-5.657C34.046,6.053,29.268,4,24,4C16.318,4,9.656,8.337,6.306,14.691z`}),h.jsx("path",{fill:"#4CAF50",d:`M24,44c5.166,0,9.86-1.977,13.409-5.192l-6.19-5.238C29.211,35.091,26.715,36,24,36
                  c-5.202,0-9.619-3.317-11.283-7.946l-6.522,5.025C9.505,39.556,16.227,44,24,44z`}),h.jsx("path",{fill:"#1976D2",d:`M43.611,20.083H42V20H24v8h11.303c-0.792,2.237-2.231,4.166-4.087,5.571
                  c0.001-0.001,0.002-0.001,0.003-0.002l6.19,5.238C36.971,39.205,44,34,44,24C44,22.659,43.862,21.35,43.611,20.083z`})]}),"Sign in with Google"]})]})]}),h.jsx("div",{className:"text-center mt-6",children:h.jsx("p",{className:"text-sm text-xmas-mute",children:"By signing in, you agree to our Terms of Service and Privacy Policy."})})]})})},FL=e=>e.toLowerCase().replace(/[^\w\s-]/g,"").replace(/\s+/g,"-").replace(/-+/g,"-").trim(),Wv=(e,t)=>`/movies/${FL(e)}?id=${t}`,OL=e=>new URLSearchParams(e).get("id"),ML=5*60*1e3;let ts=null;const LL=(e,t,r)=>{ts={userMovies:t,movies:r,timestamp:Date.now(),userId:e}},jL=e=>!ts||ts.userId!==e||Date.now()-ts.timestamp>ML?null:{userMovies:ts.userMovies,movies:ts.movies},XS=()=>{ts=null},VL=(e,t,r)=>{ts&&ts.userId===e&&(ts.userMovies[t]=r,ts.timestamp=Date.now())},t0=async(e,t,r)=>{const n=Tr(Je,`users/${e}/movies`,t);if((await Is(n)).exists()){const o={...r,updatedAt:new Date};r.rating===null&&(o.rating=null),r.watchedDate===null&&(o.watchedDate=null),r.review===null&&(o.review=null),await Yi(n,o)}else{const o={userId:e,movieId:t,watched:r.watched||!1,favorite:r.favorite||!1,addedAt:new Date,updatedAt:new Date,...r};await ci(n,o)}const a=await Is(n),i={id:a.id,...a.data()};return VL(e,t,i),i},bp=async(e,t)=>{const r=Tr(Je,`users/${e}/movies`,t),n=await Is(r);return n.exists()?{id:n.id,...n.data()}:null},YS=async e=>{const t=ir(Je,`users/${e}/movies`),r=await kr(t),n=[];return r.forEach(s=>{n.push({id:s.id,...s.data()})}),n},UL=async(e,t)=>{const r=Tr(Je,`users/${e}/movies`,t);await DM(r),XS()},r0=async e=>{const t=jL(e);if(t)return t;const r=await YS(e),n={},s=[];r.forEach(o=>{n[o.movieId]=o,s.push(o.movieId)});const a=[];if(s.length>0)for(let l=0;l<s.length;l+=10){const u=s.slice(l,l+10).map(m=>Is(Tr(Je,"movies",m)).then(p=>p.exists()?{id:p.id,...p.data()}:null).catch(p=>(console.error(`Error fetching movie ${m}:`,p),null))),d=await Promise.all(u);a.push(...d.filter(Boolean))}const i={userMovies:n,movies:a};return LL(e,n,a),i},BL=()=>{const{currentUser:e}=Nn(),[t,r]=z.useState([]),[n,s]=z.useState({}),[a,i]=z.useState(!0),[o,l]=z.useState(!0),[c,u]=z.useState(null),[d,m]=z.useState("all"),[p,g]=z.useState({option:"title",direction:"asc"}),[x,w]=z.useState(""),[k,T]=z.useState("all"),E=ya();gi(),z.useEffect(()=>{const _=new URLSearchParams(E.search),S=_.get("q")||"",I=_.get("field")||"all";S!==x&&w(S),I!==k&&T(I)},[E.search]),z.useEffect(()=>{(async()=>{if(e)try{l(!0);const{userMovies:S,movies:I}=await r0(e.uid);s(S),r(I)}catch(S){console.error("Error fetching movies:",S),u("Failed to load movies")}finally{l(!1),i(!1)}})()},[e,E.key]);const N=_=>{g(S=>S.option===_?{option:_,direction:S.direction==="asc"?"desc":"asc"}:{option:_,direction:"asc"})},M=z.useCallback(_=>{if(!x.trim())return!0;const S=x.toLowerCase().trim(),I=S.split(",").map(R=>R.trim()).filter(Boolean),b=R=>_.cast&&_.cast.some(ue=>ue.toLowerCase().includes(R)),P=n[_.id];switch(k){case"title":return _.title.toLowerCase().includes(S)||_.sortTitle&&_.sortTitle.toLowerCase().includes(S)||_.originalTitle&&_.originalTitle.toLowerCase().includes(S);case"year":return _.releaseDate&&_.releaseDate.substring(0,4).includes(S);case"cast":return I.length?I.some(R=>b(R)):b(S);case"all":default:return _.title.toLowerCase().includes(S)||_.sortTitle&&_.sortTitle.toLowerCase().includes(S)||_.originalTitle&&_.originalTitle.toLowerCase().includes(S)||_.releaseDate&&_.releaseDate.substring(0,4).includes(S)||_.overview&&_.overview.toLowerCase().includes(S)||_.genres&&_.genres.some(R=>R.toLowerCase().includes(S))||_.directors&&_.directors.some(R=>R.toLowerCase().includes(S))||_.cast&&_.cast.some(R=>R.toLowerCase().includes(S))||P&&P.review&&P.review.toLowerCase().includes(S)}},[x,k,n]),O=z.useMemo(()=>{if(o)return[];i(!0);const _=t.filter(S=>{const I=n[S.id];let b=!0;switch(d){case"watched":b=I&&I.watched;break;case"unwatched":b=!I||!I.watched;break;case"favorites":b=I&&I.favorite;break}return b&&M(S)}).sort((S,I)=>{const b=n[S.id],P=n[I.id],R=p.direction==="asc"?1:-1;switch(p.option){case"title":const ue=S.sortTitle||S.title,le=I.sortTitle||I.title;return ue.localeCompare(le)*R;case"year":const he=S.releaseDate?parseInt(S.releaseDate.substring(0,4)):0,pe=I.releaseDate?parseInt(I.releaseDate.substring(0,4)):0;return(he-pe)*R;case"rating":const ee=(b==null?void 0:b.rating)||0,H=(P==null?void 0:P.rating)||0;return(ee-H)*R;case"watched":const se=b!=null&&b.watched?1:0,ce=P!=null&&P.watched?1:0;return(se-ce)*R;default:return 0}});return i(!1),_},[t,n,d,p,x,k,o]),v=O;return o?h.jsx("div",{className:"flex justify-center items-center min-h-[60vh]",children:h.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-xmas-gold"})}):h.jsxs("div",{className:"container mx-auto px-2 sm:px-4 py-4 sm:py-8",children:[h.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-center mb-4 sm:mb-8 gap-3",children:[h.jsx("h1",{className:"font-christmas text-2xl sm:text-3xl md:text-4xl text-xmas-line",children:"My Christmas Movies"}),h.jsxs("div",{className:"flex gap-2 w-full sm:w-auto justify-center",children:[h.jsxs(tt,{to:"/random",className:"btn btn-primary btn-sm sm:btn-md",children:[h.jsx("i",{className:"fas fa-random mr-1 sm:mr-2"})," ",h.jsx("span",{className:"hidden xs:inline",children:"Random Movie"}),h.jsx("span",{className:"xs:hidden",children:"Random"})]}),h.jsxs(tt,{to:"/import",className:"btn btn-primary btn-sm sm:btn-md",children:[h.jsx("i",{className:"fas fa-file-import mr-1 sm:mr-2"})," ",h.jsx("span",{className:"hidden xs:inline",children:"Add Movies"}),h.jsx("span",{className:"xs:hidden",children:"Import"})]})]})]}),c&&h.jsxs("div",{className:"alert alert-error mb-6",children:[h.jsx("i",{className:"fas fa-exclamation-circle mr-2"}),h.jsx("span",{children:c})]}),h.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 mb-3",children:[h.jsxs("div",{className:"relative flex-grow",children:[h.jsx("div",{className:"absolute inset-y-0 left-0 pl-2 flex items-center pointer-events-none",children:h.jsx("i",{className:"fas fa-search text-gray-400"})}),h.jsx("input",{type:"text",className:"input input-bordered input-sm sm:input-md w-full pl-8 pr-8",placeholder:"   Search movies...",value:x,onChange:_=>w(_.target.value)}),x&&h.jsx("button",{className:"absolute inset-y-0 right-0 pr-2 flex items-center",onClick:()=>w(""),children:h.jsx("i",{className:"fas fa-times text-gray-400 hover:text-gray-600"})})]}),h.jsxs("select",{className:"select select-bordered select-sm sm:select-md w-full sm:w-36",value:k,onChange:_=>T(_.target.value),children:[h.jsx("option",{value:"all",children:"All Fields"}),h.jsx("option",{value:"title",children:"Title Only"}),h.jsx("option",{value:"year",children:"Year Only"}),h.jsx("option",{value:"cast",children:"Cast Only"})]})]}),h.jsxs("div",{className:"tabs tabs-boxed mb-3 text-xs sm:text-sm overflow-x-auto",children:[h.jsx("button",{className:`tab ${d==="all"?"tab-active":""}`,onClick:()=>m("all"),children:"All Movies"}),h.jsx("button",{className:`tab ${d==="watched"?"tab-active":""}`,onClick:()=>m("watched"),children:"Watched"}),h.jsx("button",{className:`tab ${d==="unwatched"?"tab-active":""}`,onClick:()=>m("unwatched"),children:"Watch"}),h.jsxs("button",{className:`tab ${d==="favorites"?"tab-active":""}`,onClick:()=>m("favorites"),children:[h.jsx("span",{className:"hidden sm:inline",children:"Favourites"}),h.jsx("span",{className:"sm:hidden",children:"Favs"})]})]}),h.jsxs("div",{className:"flex flex-wrap items-center gap-1 mb-3 bg-xmas-card bg-opacity-50 p-2 rounded-lg overflow-x-auto",children:[h.jsx("span",{className:"text-xs sm:text-sm font-medium mr-1",children:"Sort:"}),h.jsxs("div",{className:"flex flex-nowrap gap-1 overflow-x-auto",children:[h.jsxs("button",{className:`btn btn-xs ${p.option==="title"?"btn-primary":"btn-ghost"}`,onClick:()=>N("title"),children:["Title ",p.option==="title"&&h.jsx("i",{className:`fas fa-sort-${p.direction==="asc"?"up":"down"} ml-1`})]}),h.jsxs("button",{className:`btn btn-xs ${p.option==="year"?"btn-primary":"btn-ghost"}`,onClick:()=>N("year"),children:["Year ",p.option==="year"&&h.jsx("i",{className:`fas fa-sort-${p.direction==="asc"?"up":"down"} ml-1`})]}),h.jsxs("button",{className:`btn btn-xs ${p.option==="rating"?"btn-primary":"btn-ghost"}`,onClick:()=>N("rating"),children:["Rating ",p.option==="rating"&&h.jsx("i",{className:`fas fa-sort-${p.direction==="asc"?"up":"down"} ml-1`})]}),h.jsxs("button",{className:`btn btn-xs ${p.option==="watched"?"btn-primary":"btn-ghost"}`,onClick:()=>N("watched"),children:[h.jsx("span",{className:"hidden sm:inline",children:"Watched Status"}),h.jsx("span",{className:"sm:hidden",children:"Watched"}),p.option==="watched"&&h.jsx("i",{className:`fas fa-sort-${p.direction==="asc"?"up":"down"} ml-1`})]})]})]}),h.jsxs("div",{className:"flex flex-col xs:flex-row justify-between items-start xs:items-center mb-3 text-xs sm:text-sm",children:[h.jsxs("div",{children:[h.jsx("span",{className:"font-medium",children:O.length})," ",O.length===1?"movie":"movies"," found",x&&h.jsxs("span",{className:"ml-1 text-xmas-mute",children:["for: ",h.jsxs("span",{className:"font-medium",children:['"',x,'"']})]})]}),p.option&&h.jsxs("div",{className:"text-xmas-mute",children:["Sorted by ",h.jsx("span",{className:"font-medium",children:p.option})," (",p.direction==="asc"?"asc":"desc",")"]})]}),a&&!o&&h.jsx("div",{className:"flex justify-center items-center py-4",children:h.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-t-2 border-b-2 border-xmas-gold"})}),O.length===0?h.jsxs("div",{className:"bg-xmas-card p-8 rounded-lg text-center",children:[h.jsx("h3",{className:"text-xl mb-4",children:"No movies found"}),h.jsx("p",{className:"mb-4",children:d==="all"?"You haven't added any Christmas movies yet.":`You don't have any ${d} Christmas movies.`}),h.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 justify-center",children:[h.jsxs(tt,{to:"/import",className:"btn btn-primary",children:[h.jsx("i",{className:"fas fa-file-import mr-2"})," Add Movies"]}),t.length>0&&h.jsxs(tt,{to:"/random",className:"btn btn-primary",children:[h.jsx("i",{className:"fas fa-random mr-2"})," Random Movie"]})]})]}):h.jsx("div",{className:"grid grid-cols-3 sm:grid-cols-4 md:grid-cols-5 lg:grid-cols-6 gap-2 sm:gap-3",children:v.map(_=>{var I;const S=n[_.id];return h.jsx(tt,{to:Wv(_.title,_.id),state:{from:"movies"},className:"block transition-transform hover:scale-[1.02] hover:shadow-xl",children:h.jsxs("div",{className:"relative rounded-lg overflow-hidden bg-xmas-card shadow-md h-full flex flex-col",children:[h.jsxs("div",{className:"relative",children:[_.posterUrl?h.jsx("img",{src:_.posterUrl,alt:_.title,className:"w-full h-auto object-cover",style:{aspectRatio:"2/3"},loading:"lazy"}):h.jsx("div",{className:"w-full flex items-center justify-center bg-gray-800",style:{aspectRatio:"2/3"},children:h.jsx("i",{className:"fas fa-film text-2xl text-gray-500"})}),S&&S.watched&&h.jsx("div",{className:"absolute top-1 right-1 bg-primary rounded-full p-1 shadow-md",children:h.jsx("i",{className:"fas fa-check text-xs text-white"})}),S&&S.favorite&&h.jsx("div",{className:"absolute top-1 left-1 text-yellow-400 drop-shadow-md",children:h.jsx("i",{className:"fas fa-star text-sm"})})]}),h.jsxs("div",{className:"p-1 sm:p-2 flex-grow flex flex-col",children:[h.jsx("h3",{className:"text-xs sm:text-sm font-medium line-clamp-2",children:_.title}),h.jsxs("div",{className:"flex justify-between items-center mt-1",children:[h.jsx("p",{className:"text-xs text-gray-400",children:(I=_.releaseDate)==null?void 0:I.substring(0,4)}),S&&S.rating&&h.jsxs("div",{className:"flex items-center",children:[h.jsx("span",{className:"text-yellow-400 mr-0.5",children:h.jsx("i",{className:"fas fa-star text-xs"})}),h.jsx("span",{className:"text-xs",children:S.rating})]})]})]})]})},_.id)})})]})},Pp=Tr(Je,"stats","global");async function zL(){(await Is(Pp)).exists()||await ci(Pp,{watchedTotal:0,updatedAt:new Date},{merge:!0})}async function $L(e){await zL(),await Yi(Pp,{watchedTotal:MM(e),updatedAt:new Date})}const WL=[{id:"heartwarming",label:"Heartwarming",emoji:"",type:"positive"},{id:"very_christmassy",label:"Very Christmassy",emoji:"",type:"positive"},{id:"snowy",label:"Snowy Setting",emoji:"",type:"positive"},{id:"funny",label:"Funny",emoji:"",type:"positive"},{id:"cheesy",label:"Cheesy (Good Way)",emoji:"",type:"positive"},{id:"romantic",label:"Romantic",emoji:"",type:"positive"},{id:"family_friendly",label:"Family Friendly",emoji:"",type:"positive"},{id:"background",label:"Good Background Watch",emoji:"",type:"positive"},{id:"tearjerker",label:"Emotional",emoji:"",type:"positive"},{id:"rewatch",label:"Would Rewatch",emoji:"",type:"positive"}],HL=[{id:"slow",label:"Slow Pacing",emoji:"",type:"negative"},{id:"boring",label:"A Bit Boring",emoji:"",type:"negative"},{id:"low_christmas",label:"Low Xmas Vibes",emoji:"",type:"negative"},{id:"weak_chemistry",label:"Weak Chemistry",emoji:"",type:"negative"},{id:"confusing",label:"Confusing Plot",emoji:"",type:"negative"},{id:"too_long",label:"Too Long",emoji:"",type:"negative"},{id:"cringey",label:"Cringey",emoji:"",type:"negative"},{id:"fake_snow",label:"Fake Snow",emoji:"",type:"negative"},{id:"hammy",label:"Hammy",emoji:"",type:"negative"}],GL={heartwarming:"heartwarming",very_christmassy:"full of Christmas vibes",snowy:"with a lovely snowy setting",funny:"with some funny moments",cheesy:"a bit cheesy in a good way",romantic:"with sweet romantic moments",family_friendly:"very family friendly",background:"great as a cosy background watch",tearjerker:"quite emotional at times",rewatch:"something I'd happily rewatch"},KL={slow:"quite slow in places",boring:"a bit boring overall",low_christmas:"lighter on Christmas vibes than expected",weak_chemistry:"with weak chemistry between the leads",confusing:"a bit confusing at times",too_long:"longer than it needed to be",cringey:"a bit cringey in parts",fake_snow:"with fake snow",hammy:"hammy overacting"};function qL(e){return!e||e<=0?"An easy-going Christmas movie.":e>=9?"Absolutely loved this Christmas movie.":e>=8?"Really enjoyed this festive watch.":e>=7?"A good Christmas movie I liked overall.":e>=6?"A decent cosy watch with some nice moments.":e>=5?"An okay Christmas movie, but nothing special.":e>=3?"Not really my thing, it had a few issues.":"I didn't enjoy this Christmas movie very much."}function H_(e){if(e.length===0)return"";if(e.length===1)return e[0];const t=e[e.length-1];return`${e.slice(0,-1).join(", ")} and ${t}`}function XL(e){const t=e.map(s=>GL[s]).filter(Boolean),r=e.map(s=>KL[s]).filter(Boolean);let n="";return t.length&&(n+=` It felt ${H_(t)}.`),r.length&&(n+=` However, it was ${H_(r)}.`),n}const YL=({rating:e,initialTags:t=[],initialAutoReview:r="",onChange:n})=>{const[s,a]=z.useState(t),[i,o]=z.useState(r);z.useEffect(()=>{a(t)},[t.join("|")]),z.useEffect(()=>{o(r)},[r]);const l=d=>{a(m=>m.includes(d)?m.filter(p=>p!==d):[...m,d])},c=()=>{const d=qL(e),m=XL(s),p=(d+m).trim();o(p),n&&n({tags:s,autoReview:p})},u=d=>s.includes(d);return h.jsxs("div",{className:"mt-4",children:[h.jsxs("div",{className:"flex items-center justify-between mb-2",children:[h.jsx("h3",{className:"text-lg font-semibold text-primary",children:"Quick Vibe Review"}),h.jsx("span",{className:"text-xs opacity-80",children:"Pick a few that fit, then generate."})]}),h.jsx("p",{className:"text-xs mb-1 opacity-80",children:"What worked?"}),h.jsx("div",{className:"flex flex-wrap gap-2 mb-3",children:WL.map(d=>h.jsxs("button",{type:"button",onClick:()=>l(d.id),className:`btn btn-xs rounded-full border ${u(d.id)?"btn-accent text-base-100":"btn-ghost border-base-300 text-sm"}`,children:[h.jsx("span",{className:"mr-1",children:d.emoji}),d.label]},d.id))}),h.jsx("p",{className:"text-xs mb-1 opacity-80",children:"What didn't?"}),h.jsx("div",{className:"flex flex-wrap gap-2 mb-3",children:HL.map(d=>h.jsxs("button",{type:"button",onClick:()=>l(d.id),className:`btn btn-xs rounded-full border ${u(d.id)?"btn-error text-base-100":"btn-ghost border-base-300 text-sm"}`,children:[h.jsx("span",{className:"mr-1",children:d.emoji}),d.label]},d.id))}),h.jsx("button",{type:"button",onClick:c,className:"btn btn-sm btn-primary",children:" Generate Review From Tags"}),i&&h.jsxs("p",{className:"mt-3 text-sm opacity-90 italic",children:["Generated preview: ",i,""]})]})},QL=({watched:e,watchedDate:t,onWatchedDateChange:r,rating:n,onRatingChange:s,review:a,onReviewChange:i,vibeTags:o,onVibeChange:l,saving:c,onSave:u})=>h.jsxs(h.Fragment,{children:[h.jsx("h2",{className:"text-2xl font-christmas text-xmas-gold mb-4",children:"Your Rating & Review"}),e&&h.jsxs("div",{className:"form-control mb-4",children:[h.jsx("label",{className:"label",children:h.jsx("span",{className:"label-text",children:"Date Watched"})}),h.jsx("input",{type:"date",className:"input input-bordered",value:t,onChange:d=>r(d.target.value)})]}),h.jsxs("div",{className:"form-control mb-4",children:[h.jsx("label",{className:"label",children:h.jsx("span",{className:"label-text",children:"Your Rating"})}),h.jsx("div",{className:"rating rating-lg",children:[1,2,3,4,5,6,7,8,9,10].map(d=>h.jsx("input",{type:"radio",name:"rating",className:`mask mask-star-2 ${d<=5?"bg-orange-400":"bg-yellow-400"}`,checked:n===d,onChange:()=>s(d)},d))}),n&&h.jsx("div",{className:"mt-2",children:h.jsx("button",{className:"btn btn-xs btn-ghost",onClick:()=>s(null),children:"Clear Rating"})})]}),h.jsx(YL,{rating:n,initialTags:o,initialAutoReview:a,onChange:l}),h.jsxs("div",{className:"form-control mb-6 mt-4",children:[h.jsx("label",{className:"label",children:h.jsx("span",{className:"label-text",children:"Your Review"})}),h.jsx("textarea",{className:"textarea textarea-bordered h-32",placeholder:"Write your thoughts about this movie...",value:a,onChange:d=>i(d.target.value)})]}),h.jsx("div",{className:"flex justify-end",children:h.jsx("button",{className:"btn btn-primary btn-sm sm:btn-md",onClick:u,disabled:c,children:c?h.jsxs(h.Fragment,{children:[h.jsx("span",{className:"loading loading-spinner loading-sm mr-2"}),"Saving..."]}):h.jsxs(h.Fragment,{children:[h.jsx("i",{className:"fas fa-save mr-2"}),"Save Changes"]})})})]}),JL=()=>{var H;const{movieId:e}=SR(),t=ya(),r=gi(),{currentUser:n}=Nn(),s=RL(),a=OL(t.search),o=((H=t.state)==null?void 0:H.from)==="import"?"/import":"/movies",[l,c]=z.useState(null),[u,d]=z.useState(null),[m,p]=z.useState(!0),[g,x]=z.useState(null),[w,k]=z.useState(!1),[T,E]=z.useState(!1),[N,M]=z.useState(""),[O,v]=z.useState(null),[_,S]=z.useState(""),[I,b]=z.useState(!1),[P,R]=z.useState([]),ue=z.useRef(null);z.useEffect(()=>{(async()=>{if(!n||!a){x("Movie not found"),p(!1);return}try{p(!0);const ce=await Is(Tr(Je,"movies",a));if(!ce.exists()){x("Movie not found"),p(!1);return}const B={id:ce.id,...ce.data()};c(B);const K=await bp(n.uid,a);if(K){d(K),E(K.watched);let X="";if(K.watchedDate)try{if(K.watchedDate instanceof Date)X=K.watchedDate.toISOString().split("T")[0];else{const G=K.watchedDate;if(typeof G=="object"&&G!==null&&"seconds"in G){const ie=G;X=new Date(ie.seconds*1e3).toISOString().split("T")[0]}else{const ie=new Date(K.watchedDate);isNaN(ie.getTime())||(X=ie.toISOString().split("T")[0])}}}catch(G){console.error("Error parsing watchedDate:",G)}M(X),v(K.rating||null),S(K.review||""),b(K.favorite),R(K.vibeTags||[])}}catch(ce){console.error("Error fetching movie data:",ce),x("Failed to load movie data")}finally{p(!1)}})()},[n,a]),z.useEffect(()=>{T&&ue.current&&typeof window<"u"&&window.innerWidth<768&&ue.current.scrollIntoView({behavior:"smooth",block:"start"})},[T]);const le=async()=>{if(!(!n||!a||!l))try{k(!0);const se={userId:n.uid,movieId:a,watched:T,favorite:I,updatedAt:new Date,vibeTags:P};if(T&&N)try{se.watchedDate=new Date(N),isNaN(se.watchedDate.getTime())&&delete se.watchedDate}catch(K){console.error("Error parsing watchedDate for save:",K),delete se.watchedDate}else T||(se.watchedDate=null);se.rating=O,se.review=_||null;const ce=await t0(n.uid,a,se);d(ce);const B=await ah(n.uid);if(B.length){const K=B.map(X=>{var G;return((G=Xo.find(ie=>ie.id===X))==null?void 0:G.name)||X}).join(", ");s.success(`You unlocked: ${K}! `)}}catch(se){console.error("Error saving movie data:",se),x("Failed to save movie data")}finally{k(!1)}},he=async()=>{if(!n||!a)return;const se=!I;b(se);try{const ce=Tr(Je,"users",n.uid,"movies",a);(await Is(ce)).exists()?await Yi(ce,{favorite:se,updatedAt:new Date}):await ci(ce,{userId:n.uid,movieId:a,favorite:se,watched:!1,rating:null,review:"",vibeTags:[],addedAt:new Date,updatedAt:new Date},{merge:!0}),d(X=>X&&{...X,favorite:se});const K=await ah(n.uid);if(K.length){const X=K.map(G=>{var ie;return((ie=Xo.find(ge=>ge.id===G))==null?void 0:ie.name)||G}).join(", ");s.success(`You unlocked: ${X}! `)}}catch(ce){console.error("Failed to toggle favorite",ce),b(!se)}},pe=async()=>{if(!(!n||!a||!window.confirm("Are you sure you want to remove this movie from your collection?")))try{k(!0),await UL(n.uid,a),r("/movies")}catch(se){console.error("Error deleting movie:",se),x("Failed to delete movie"),k(!1)}},ee=async()=>{if(!n||!a)return;const se=!T;E(se);try{const ce=Tr(Je,"users",n.uid,"movies",a),B=await Is(ce),K=B.exists()?!!B.data().watched:!1;B.exists()?await Yi(ce,{watched:se,...se?{}:{watchedDate:null},updatedAt:new Date}):await ci(ce,{userId:n.uid,movieId:a,watched:se,favorite:!1,rating:null,review:"",vibeTags:[],addedAt:new Date,updatedAt:new Date},{merge:!0}),d(G=>G&&{...G,watched:se}),K!==se&&await $L(se?1:-1);const X=await ah(n.uid);if(X.length){const G=X.map(ie=>{var ge;return((ge=Xo.find(Ie=>Ie.id===ie))==null?void 0:ge.name)||ie}).join(", ");s.success(`You unlocked: ${G}! `)}}catch(ce){console.error("Failed to toggle watched",ce),E(!se)}};return m?h.jsx("div",{className:"flex justify-center items-center min-h-[60vh]",children:h.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-xmas-gold"})}):l?h.jsxs("div",{className:"container mx-auto px-4 py-8",children:[h.jsx("div",{className:"mb-4",children:h.jsxs(tt,{to:o,className:"btn btn-primary btn-sm sm:btn-md",children:[h.jsx("i",{className:"fas fa-arrow-left mr-2"})," Back to Movies"]})}),g&&h.jsxs("div",{className:"alert alert-error mb-6",children:[h.jsx("i",{className:"fas fa-exclamation-circle mr-2"}),h.jsx("span",{children:g})]}),h.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-8",children:[h.jsxs("div",{className:"md:col-span-1",children:[h.jsx("div",{className:"rounded-lg overflow-hidden shadow-xl",children:l.posterUrl?h.jsx("img",{src:l.posterUrl,alt:l.title,className:"w-full object-contain",style:{aspectRatio:"2/3"}}):h.jsx("div",{className:"w-full flex items-center justify-center bg-gray-800",style:{aspectRatio:"2/3"},children:h.jsx("i",{className:"fas fa-film text-6xl text-gray-500"})})}),h.jsxs("div",{className:"mt-4 flex flex-col gap-2",children:[h.jsxs("button",{className:`btn ${I?"btn-primary":"btn-outline"} w-full`,onClick:he,children:[h.jsx("i",{className:`fas fa-star mr-2 ${I?"text-white":""}`}),I?"Favourited":"Add to Favourites"]}),h.jsxs("button",{className:`btn ${T?"btn-success":"btn-outline"} w-full`,onClick:ee,children:[h.jsx("i",{className:`fas fa-check mr-2 ${T?"text-white":""}`}),T?"Watched":"Mark as Watched"]}),h.jsxs("button",{className:"btn btn-error btn-outline w-full",onClick:pe,disabled:w,children:[h.jsx("i",{className:"fas fa-trash mr-2"}),"Remove from Collection"]}),l.tmdbId&&h.jsxs("div",{className:"mt-2 flex flex-col items-center",children:[h.jsx("a",{href:`https://www.themoviedb.org/movie/${l.tmdbId}`,target:"_blank",rel:"noopener noreferrer",className:"btn btn-outline w-full flex items-center justify-center gap-2",children:h.jsx("img",{src:"/tmdb.svg",alt:"TMDB",className:"h-5"})}),h.jsx("p",{className:"mt-2 text-xs text-gray-400 text-center",children:"This product uses the TMDB API but is not endorsed or certified by TMDB."})]})]})]}),h.jsxs("div",{className:"md:col-span-2",children:[h.jsx("h1",{className:"font-christmas text-3xl md:text-4xl text-xmas-line mb-2",children:l.title}),l.releaseDate&&h.jsx("p",{className:"text-lg text-gray-400 mb-4",children:new Date(l.releaseDate).getFullYear()}),l.genres&&l.genres.length>0&&h.jsx("div",{className:"flex flex-wrap gap-2 mb-4",children:l.genres.map((se,ce)=>h.jsx("span",{className:"badge badge-outline",children:se},ce))}),l.runtime&&h.jsxs("p",{className:"mb-4",children:[h.jsx("i",{className:"fas fa-clock mr-2 text-xmas-gold"}),Math.floor(l.runtime/60),"h ",l.runtime%60,"m"]}),l.overview&&h.jsxs("div",{className:"mb-6",children:[h.jsx("h2",{className:"text-xl font-bold mb-2",children:"Overview"}),h.jsx("p",{className:"text-gray-300",children:l.overview})]}),l.directors&&l.directors.length>0&&h.jsxs("div",{className:"mb-4",children:[h.jsxs("h2",{className:"text-xl font-bold mb-2",children:["Director",l.directors.length>1?"s":""]}),h.jsx("p",{children:l.directors.join(", ")})]}),l.cast&&l.cast.length>0&&h.jsxs("div",{className:"mb-6",children:[h.jsx("h2",{className:"text-xl font-bold mb-2",children:"Cast"}),h.jsx("p",{className:"flex flex-wrap gap-1",children:l.cast.slice(0,10).map((se,ce)=>h.jsxs(fd.Fragment,{children:[h.jsx(tt,{to:`/movies?q=${encodeURIComponent(se)}&field=cast`,className:"link link-primary",children:se}),ce<Math.min(l.cast.length,10)-1&&h.jsx("span",{children:","})]},se))})]}),h.jsxs("div",{ref:ue,children:[h.jsx("div",{className:"divider"}),T&&h.jsx(QL,{watched:T,watchedDate:N,onWatchedDateChange:M,rating:O,onRatingChange:v,review:_,onReviewChange:S,vibeTags:P,onVibeChange:({tags:se,autoReview:ce})=>{R(se),S(ce)},saving:w,onSave:le})]})]})]})]}):h.jsxs("div",{className:"container mx-auto px-4 py-8",children:[h.jsxs("div",{className:"alert alert-error",children:[h.jsx("i",{className:"fas fa-exclamation-circle mr-2"}),h.jsx("span",{children:"Movie not found"})]}),h.jsx("div",{className:"mt-4",children:h.jsxs(tt,{to:o,className:"btn btn-primary btn-sm sm:btn-md",children:[h.jsx("i",{className:"fas fa-arrow-left mr-2"})," Back to Movies"]})})]})};function G_(e,t){let r=0;const n=(e.title||"").toLowerCase(),s=(t.title||"").toLowerCase();if(n&&s)if(n===s)r+=60;else if(s.includes(n)||n.includes(s))r+=40;else{const a=n.split(" "),i=s.split(" "),o=a.filter(l=>i.includes(l));r+=o.length/Math.max(a.length,i.length)*40}if(e.releaseDate&&t.release_date){const a=e.releaseDate.slice(0,4),i=t.release_date.slice(0,4);a===i?r+=40:Math.abs(parseInt(a)-parseInt(i))<=1&&(r+=20)}return Math.min(Math.round(r),100)}const ws=e=>e!=null&&e.poster_path?`https://image.tmdb.org/t/p/w500${e.poster_path}`:(e==null?void 0:e.posterUrl)||"",ZL=({onSelect:e,userMovieIds:t})=>{const r=gi(),[n,s]=z.useState([]),[a,i]=z.useState(!0),[o,l]=z.useState(null),[c,u]=z.useState(""),[d,m]=z.useState("all"),[p,g]=z.useState("title-asc"),[x,w]=z.useState(!1);z.useEffect(()=>{(async()=>{try{i(!0),l(null);const O=(await kr(ir(Je,"movies"))).docs.map(v=>{var S;const _=v.data();return _.tmdbId?{id:_.tmdbId,title:_.title,release_date:_.releaseDate,poster_path:(S=_.posterUrl)!=null&&S.startsWith("https://image.tmdb.org/t/p/")?_.posterUrl.replace("https://image.tmdb.org/t/p/w500",""):null,source:"local",firestoreId:v.id,cast:_.cast||[],runtime:_.runtime,genres:_.genres||[],overview:_.overview}:null}).filter(Boolean);s(O)}catch(M){console.error("Error loading local catalogue:",M),l((M==null?void 0:M.message)??"Failed to load local catalogue")}finally{i(!1)}})()},[]);const k=z.useCallback(N=>{if(!c.trim())return!0;const M=c.toLowerCase().trim(),O=M.split(",").map(_=>_.trim()).filter(Boolean),v=_=>N.cast&&N.cast.some(S=>S.toLowerCase().includes(_));switch(d){case"title":return N.title.toLowerCase().includes(M);case"year":return N.release_date&&N.release_date.substring(0,4).includes(M);case"cast":return O.length?O.some(_=>v(_)):v(M);case"all":default:return N.title.toLowerCase().includes(M)||N.release_date&&N.release_date.substring(0,4).includes(M)||N.cast&&N.cast.some(_=>_.toLowerCase().includes(M))}},[c,d]),T=z.useMemo(()=>n.filter(N=>{if(!k(N))return!1;const M=!!N.firestoreId&&t.includes(N.firestoreId);return!(x&&M)}),[n,k,t,x]),E=z.useMemo(()=>{const N=[...T],M=O=>{if(!O.release_date)return 0;const v=parseInt(O.release_date.slice(0,4),10);return Number.isNaN(v)?0:v};return N.sort((O,v)=>{switch(p){case"title-asc":return O.title.localeCompare(v.title);case"title-desc":return v.title.localeCompare(O.title);case"year-desc":{const _=M(O);return M(v)-_||O.title.localeCompare(v.title)}case"year-asc":{const _=M(O),S=M(v);return _-S||O.title.localeCompare(v.title)}default:return 0}}),N},[T,p]);return h.jsxs("div",{className:"space-y-4",children:[h.jsxs("div",{className:"flex flex-col lg:flex-row gap-2",children:[h.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 flex-1",children:[h.jsxs("div",{className:"relative flex-grow",children:[h.jsx("div",{className:"absolute inset-y-0 left-0 pl-2 flex items-center pointer-events-none",children:h.jsx("i",{className:"fas fa-search text-gray-400"})}),h.jsx("input",{type:"text",className:"input input-bordered input-sm sm:input-md w-full pl-8 pr-8",placeholder:"   Search catalogue by title, cast, year...",value:c,onChange:N=>u(N.target.value)}),c&&h.jsx("button",{className:"absolute inset-y-0 right-0 pr-2 flex items-center",onClick:()=>u(""),children:h.jsx("i",{className:"fas fa-times text-gray-400 hover:text-gray-600"})})]}),h.jsxs("select",{className:"select select-bordered select-sm sm:select-md w-full sm:w-40",value:d,onChange:N=>m(N.target.value),children:[h.jsx("option",{value:"all",children:"All Fields"}),h.jsx("option",{value:"title",children:"Title Only"}),h.jsx("option",{value:"year",children:"Year Only"}),h.jsx("option",{value:"cast",children:"Cast Only"})]})]}),h.jsx("div",{className:"flex items-center justify-end",children:h.jsxs("select",{className:"select select-bordered select-sm sm:select-md w-full sm:w-52",value:p,onChange:N=>g(N.target.value),children:[h.jsx("option",{value:"title-asc",children:"Sort: Title (A  Z)"}),h.jsx("option",{value:"title-desc",children:"Sort: Title (Z  A)"}),h.jsx("option",{value:"year-desc",children:"Sort: Year (Newest  Oldest)"}),h.jsx("option",{value:"year-asc",children:"Sort: Year (Oldest  Newest)"})]})})]}),h.jsxs("div",{className:"flex flex-col xs:flex-row justify-between items-start xs:items-center text-xs sm:text-sm gap-2",children:[h.jsx("div",{children:a?h.jsx("span",{children:"Loading catalogue"}):h.jsxs(h.Fragment,{children:[h.jsx("span",{className:"font-medium",children:E.length})," ",E.length===1?"movie":"movies"," in catalogue",c&&h.jsxs("span",{className:"ml-1 opacity-70",children:["for: ",h.jsxs("span",{className:"font-medium",children:['"',c,'"']})]})]})}),h.jsxs("label",{className:"flex items-center gap-1 cursor-pointer select-none",children:[h.jsx("input",{type:"checkbox",className:"checkbox checkbox-xs sm:checkbox-sm",checked:x,onChange:N=>w(N.target.checked)}),h.jsx("span",{children:"Hide owned movies"})]})]}),o&&h.jsx("div",{className:"alert alert-error",children:o}),a&&h.jsx("div",{className:"flex justify-center p-6",children:h.jsx("span",{className:"loading loading-spinner loading-lg"})}),!a&&E.length===0&&!o&&h.jsxs("div",{className:"bg-xmas-card bg-opacity-60 rounded-lg p-6 text-center",children:[h.jsx("h3",{className:"text-lg font-semibold mb-2",children:"No movies found"}),h.jsx("p",{className:"text-sm opacity-80 mb-2",children:"Try changing your search text, field, or sort order."})]}),!a&&E.length>0&&h.jsx("div",{className:"grid grid-cols-3 sm:grid-cols-4 md:grid-cols-5 lg:grid-cols-6 gap-2 sm:gap-3",children:E.map(N=>{var O;const M=!!N.firestoreId&&t.includes(N.firestoreId);return h.jsx("div",{className:`block transition-transform hover:scale-[1.02] hover:shadow-xl ${M?"opacity-60 cursor-pointer":"cursor-pointer"}`,onClick:()=>{M&&N.firestoreId?r(Wv(N.title,N.firestoreId),{state:{from:"import"}}):e(N)},children:h.jsxs("div",{className:"relative rounded-lg overflow-hidden bg-xmas-card shadow-md h-full flex flex-col",children:[h.jsxs("div",{className:"relative",children:[ws(N)?h.jsx("img",{src:ws(N),alt:N.title,className:"w-full h-auto object-cover",style:{aspectRatio:"2/3"},loading:"lazy"}):h.jsx("div",{className:"w-full flex items-center justify-center bg-gray-800",style:{aspectRatio:"2/3"},children:h.jsx("i",{className:"fas fa-film text-2xl text-gray-500"})}),M&&h.jsxs("div",{className:`\r
                          absolute top-1 left-1 \r
                          badge badge-success \r
                          px-2 py-0.5 \r
                          text-[0.6rem] leading-none \r
                          whitespace-nowrap \r
                          flex items-center gap-1 \r
                          shadow\r
                        `,children:[h.jsx("i",{className:"fas fa-check text-[0.6rem]"}),h.jsx("span",{children:"Owned"})]})]}),h.jsxs("div",{className:"p-1 sm:p-2 flex-grow flex flex-col",children:[h.jsx("h3",{className:"text-xs sm:text-sm font-medium line-clamp-2",children:N.title}),h.jsx("p",{className:"text-xs text-gray-400 mt-1",children:(O=N.release_date)==null?void 0:O.slice(0,4)})]})]})},N.firestoreId||N.id)})})]})},QS=e=>{const t=e.trim();return/^The\s+/i.test(t)?t.replace(/^The\s+/i,"").trim():/^A\s+/i.test(t)?t.replace(/^A\s+/i,"").trim():/^An\s+/i.test(t)?t.replace(/^An\s+/i,"").trim():t},JS="https://api.themoviedb.org/3",e6="https://image.tmdb.org/t/p/w500",t6="https://image.tmdb.org/t/p/original",ZS=e=>(e||"").toLowerCase().replace(/^(the|a|an)\s+/,"").replace(/[^a-z0-9]+/g," ").trim(),r6=e=>{var n;const t=new Set,r=s=>{const a=ZS(s||"");a&&(t.add(a),a.split(" ").forEach(i=>i&&t.add(i)))};return r(e.title),r(e.original_title),e.release_date&&t.add(e.release_date.slice(0,4)),(e.genres||[]).forEach(s=>r(s==null?void 0:s.name)),(((n=e.credits)==null?void 0:n.cast)||[]).slice(0,5).forEach(s=>r(s==null?void 0:s.name)),Array.from(t).slice(0,200)},Dp=async(e,t)=>{const r=await fetch(`${JS}/search/movie?api_key=${t}&query=${encodeURIComponent(e)}&include_adult=false`);if(!r.ok)throw new Error(`TMDB API error: ${r.status}`);return await r.json()},Jh=async(e,t)=>{const r=await fetch(`${JS}/movie/${e}?api_key=${t}&append_to_response=credits`);if(!r.ok)throw new Error(`TMDB API error: ${r.status}`);return await r.json()},Hv=e=>{var n,s,a,i,o,l;const t=QS(e.title),r=ZS(t);return{tmdbId:e.id,title:e.title,sortTitle:t,sortTitleLower:r,originalTitle:e.original_title,releaseDate:e.release_date,posterUrl:e.poster_path?`${e6}${e.poster_path}`:void 0,backdropUrl:e.backdrop_path?`${t6}${e.backdrop_path}`:void 0,overview:e.overview,runtime:e.runtime,genres:((n=e.genres)==null?void 0:n.map(c=>c.name))||[],directors:((i=(a=(s=e.credits)==null?void 0:s.crew)==null?void 0:a.filter(c=>c.job==="Director"))==null?void 0:i.map(c=>c.name))||[],cast:((l=(o=e.credits)==null?void 0:o.cast)==null?void 0:l.slice(0,10).map(c=>c.name))||[],isChristmas:!0,keywords:r6(e),updatedAt:new Date}},n6=({tmdbApiKey:e,onSelect:t})=>{const[r,n]=z.useState(""),[s,a]=z.useState(!1),[i,o]=z.useState([]),[l,c]=z.useState(null),u=async()=>{if(r.trim())try{a(!0),c(null);const d=await Dp(r,e);o(d.results)}catch(d){c((d==null?void 0:d.message)??"TMDB search failed")}finally{a(!1)}};return h.jsxs("div",{className:"space-y-3",children:[h.jsxs("div",{className:"flex gap-2",children:[h.jsx("input",{className:"input input-bordered flex-1",value:r,onChange:d=>n(d.target.value),placeholder:"Search TMDB...",onKeyDown:d=>d.key==="Enter"&&u()}),h.jsx("button",{className:"btn btn-primary",onClick:u,disabled:s||!e,children:s?h.jsx("span",{className:"loading loading-spinner loading-sm"}):"Search"})]}),l&&h.jsx("div",{className:"alert alert-error",children:l}),i.length>0&&h.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-3",children:i.map(d=>{var m;return h.jsxs("div",{className:"card bg-base-100 shadow cursor-pointer hover:shadow-lg transition-shadow",onClick:()=>t(d),children:[h.jsx("figure",{children:ws(d)?h.jsx("img",{src:ws(d),alt:d.title,className:"w-full h-64 object-contain"}):h.jsx("div",{className:"h-64 w-full flex items-center justify-center bg-base-200",children:h.jsx("i",{className:"fas fa-film text-3xl opacity-50"})})}),h.jsxs("div",{className:"card-body p-3",children:[h.jsx("div",{className:"font-semibold",children:d.title}),h.jsx("div",{className:"text-xs opacity-70",children:(m=d.release_date)==null?void 0:m.slice(0,4)})]})]},d.id)})})]})};/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var eA=1252,s6=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],Gv={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},Kv=function(e){s6.indexOf(e)!=-1&&(eA=Gv[0]=e)};function a6(){Kv(1252)}var ss=function(e){Kv(e)};function tA(){ss(1200),a6()}function K_(e){for(var t=[],r=0,n=e.length;r<n;++r)t[r]=e.charCodeAt(r);return t}function i6(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r)+(e.charCodeAt(2*r+1)<<8));return t.join("")}function rA(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r+1)+(e.charCodeAt(2*r)<<8));return t.join("")}var ac=function(e){var t=e.charCodeAt(0),r=e.charCodeAt(1);return t==255&&r==254?i6(e.slice(2)):t==254&&r==255?rA(e.slice(2)):t==65279?e.slice(1):e},Cf=function(t){return String.fromCharCode(t)},q_=function(t){return String.fromCharCode(t)},lu,Ba="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function X_(e){for(var t="",r=0,n=0,s=0,a=0,i=0,o=0,l=0,c=0;c<e.length;)r=e.charCodeAt(c++),a=r>>2,n=e.charCodeAt(c++),i=(r&3)<<4|n>>4,s=e.charCodeAt(c++),o=(n&15)<<2|s>>6,l=s&63,isNaN(n)?o=l=64:isNaN(s)&&(l=64),t+=Ba.charAt(a)+Ba.charAt(i)+Ba.charAt(o)+Ba.charAt(l);return t}function An(e){var t="",r=0,n=0,s=0,a=0,i=0,o=0,l=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var c=0;c<e.length;)a=Ba.indexOf(e.charAt(c++)),i=Ba.indexOf(e.charAt(c++)),r=a<<2|i>>4,t+=String.fromCharCode(r),o=Ba.indexOf(e.charAt(c++)),n=(i&15)<<4|o>>2,o!==64&&(t+=String.fromCharCode(n)),l=Ba.indexOf(e.charAt(c++)),s=(o&3)<<6|l,l!==64&&(t+=String.fromCharCode(s));return t}var Qe=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),io=function(){if(typeof Buffer<"u"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(t,r){return r?new Buffer(t,r):new Buffer(t)}:Buffer.from.bind(Buffer)}return function(){}}();function ui(e){return Qe?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}function Y_(e){return Qe?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}var rs=function(t){return Qe?io(t,"binary"):t.split("").map(function(r){return r.charCodeAt(0)&255})};function oo(e){if(Array.isArray(e))return e.map(function(n){return String.fromCharCode(n)}).join("");for(var t=[],r=0;r<e.length;++r)t[r]=String.fromCharCode(e[r]);return t.join("")}function qv(e){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(e instanceof ArrayBuffer)return qv(new Uint8Array(e));for(var t=new Array(e.length),r=0;r<e.length;++r)t[r]=e[r];return t}var Ma=Qe?function(e){return Buffer.concat(e.map(function(t){return Buffer.isBuffer(t)?t:io(t)}))}:function(e){if(typeof Uint8Array<"u"){var t=0,r=0;for(t=0;t<e.length;++t)r+=e[t].length;var n=new Uint8Array(r),s=0;for(t=0,r=0;t<e.length;r+=s,++t)if(s=e[t].length,e[t]instanceof Uint8Array)n.set(e[t],r);else{if(typeof e[t]=="string")throw"wtf";n.set(new Uint8Array(e[t]),r)}return n}return[].concat.apply([],e.map(function(a){return Array.isArray(a)?a:[].slice.call(a)}))};function o6(e){for(var t=[],r=0,n=e.length+250,s=ui(e.length+255),a=0;a<e.length;++a){var i=e.charCodeAt(a);if(i<128)s[r++]=i;else if(i<2048)s[r++]=192|i>>6&31,s[r++]=128|i&63;else if(i>=55296&&i<57344){i=(i&1023)+64;var o=e.charCodeAt(++a)&1023;s[r++]=240|i>>8&7,s[r++]=128|i>>2&63,s[r++]=128|o>>6&15|(i&3)<<4,s[r++]=128|o&63}else s[r++]=224|i>>12&15,s[r++]=128|i>>6&63,s[r++]=128|i&63;r>n&&(t.push(s.slice(0,r)),r=0,s=ui(65535),n=65530)}return t.push(s.slice(0,r)),Ma(t)}var Zr=/\u0000/g,ic=/[\u0001-\u0006]/g;function Yo(e){for(var t="",r=e.length-1;r>=0;)t+=e.charAt(r--);return t}function as(e,t){var r=""+e;return r.length>=t?r:Ut("0",t-r.length)+r}function Xv(e,t){var r=""+e;return r.length>=t?r:Ut(" ",t-r.length)+r}function Zh(e,t){var r=""+e;return r.length>=t?r:r+Ut(" ",t-r.length)}function l6(e,t){var r=""+Math.round(e);return r.length>=t?r:Ut("0",t-r.length)+r}function c6(e,t){var r=""+e;return r.length>=t?r:Ut("0",t-r.length)+r}var Q_=Math.pow(2,32);function wo(e,t){if(e>Q_||e<-Q_)return l6(e,t);var r=Math.round(e);return c6(r,t)}function ed(e,t){return t=t||0,e.length>=7+t&&(e.charCodeAt(t)|32)===103&&(e.charCodeAt(t+1)|32)===101&&(e.charCodeAt(t+2)|32)===110&&(e.charCodeAt(t+3)|32)===101&&(e.charCodeAt(t+4)|32)===114&&(e.charCodeAt(t+5)|32)===97&&(e.charCodeAt(t+6)|32)===108}var J_=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],Z0=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function u6(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"/ "hh""mm""ss" "',e}var ze={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},Z_={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},f6={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function td(e,t,r){for(var n=e<0?-1:1,s=e*n,a=0,i=1,o=0,l=1,c=0,u=0,d=Math.floor(s);c<t&&(d=Math.floor(s),o=d*i+a,u=d*c+l,!(s-d<5e-8));)s=1/(s-d),a=i,i=o,l=c,c=u;if(u>t&&(c>t?(u=l,o=a):(u=c,o=i)),!r)return[0,n*o,u];var m=Math.floor(n*o/u);return[m,n*o-m*u,u]}function Di(e,t,r){if(e>2958465||e<0)return null;var n=e|0,s=Math.floor(86400*(e-n)),a=0,i=[],o={D:n,T:s,u:86400*(e-n)-s,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(o.u)<1e-6&&(o.u=0),t&&t.date1904&&(n+=1462),o.u>.9999&&(o.u=0,++s==86400&&(o.T=s=0,++n,++o.D)),n===60)i=r?[1317,10,29]:[1900,2,29],a=3;else if(n===0)i=r?[1317,8,29]:[1900,1,0],a=6;else{n>60&&--n;var l=new Date(1900,0,1);l.setDate(l.getDate()+n-1),i=[l.getFullYear(),l.getMonth()+1,l.getDate()],a=l.getDay(),n<60&&(a=(a+6)%7),r&&(a=v6(l,i))}return o.y=i[0],o.m=i[1],o.d=i[2],o.S=s%60,s=Math.floor(s/60),o.M=s%60,s=Math.floor(s/60),o.H=s,o.q=a,o}var nA=new Date(1899,11,31,0,0,0),h6=nA.getTime(),d6=new Date(1900,2,1,0,0,0);function sA(e,t){var r=e.getTime();return t?r-=1461*24*60*60*1e3:e>=d6&&(r+=24*60*60*1e3),(r-(h6+(e.getTimezoneOffset()-nA.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function Yv(e){return e.indexOf(".")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function m6(e){return e.indexOf("E")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function p6(e){var t=e<0?12:11,r=Yv(e.toFixed(12));return r.length<=t||(r=e.toPrecision(10),r.length<=t)?r:e.toExponential(5)}function g6(e){var t=Yv(e.toFixed(11));return t.length>(e<0?12:11)||t==="0"||t==="-0"?e.toPrecision(6):t}function cu(e){var t=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),r;return t>=-4&&t<=-1?r=e.toPrecision(10+t):Math.abs(t)<=9?r=p6(e):t===10?r=e.toFixed(10).substr(0,12):r=g6(e),Yv(m6(r.toUpperCase()))}function Qi(e,t){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):cu(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return Wn(14,sA(e,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+e)}function v6(e,t){t[0]-=581;var r=e.getDay();return e<60&&(r=(r+6)%7),r}function x6(e,t,r,n){var s="",a=0,i=0,o=r.y,l,c=0;switch(e){case 98:o=r.y+543;case 121:switch(t.length){case 1:case 2:l=o%100,c=2;break;default:l=o%1e4,c=4;break}break;case 109:switch(t.length){case 1:case 2:l=r.m,c=t.length;break;case 3:return Z0[r.m-1][1];case 5:return Z0[r.m-1][0];default:return Z0[r.m-1][2]}break;case 100:switch(t.length){case 1:case 2:l=r.d,c=t.length;break;case 3:return J_[r.q][0];default:return J_[r.q][1]}break;case 104:switch(t.length){case 1:case 2:l=1+(r.H+11)%12,c=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:l=r.H,c=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:l=r.M,c=t.length;break;default:throw"bad minute format: "+t}break;case 115:if(t!="s"&&t!="ss"&&t!=".0"&&t!=".00"&&t!=".000")throw"bad second format: "+t;return r.u===0&&(t=="s"||t=="ss")?as(r.S,t.length):(n>=2?i=n===3?1e3:100:i=n===1?10:1,a=Math.round(i*(r.S+r.u)),a>=60*i&&(a=0),t==="s"?a===0?"0":""+a/i:(s=as(a,2+n),t==="ss"?s.substr(0,2):"."+s.substr(2,t.length-1)));case 90:switch(t){case"[h]":case"[hh]":l=r.D*24+r.H;break;case"[m]":case"[mm]":l=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":l=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+t}c=t.length===3?1:2;break;case 101:l=o,c=1;break}var u=c>0?as(l,c):"";return u}function za(e){var t=3;if(e.length<=t)return e;for(var r=e.length%t,n=e.substr(0,r);r!=e.length;r+=t)n+=(n.length>0?",":"")+e.substr(r,t);return n}var aA=/%/g;function y6(e,t,r){var n=t.replace(aA,""),s=t.length-n.length;return na(e,n,r*Math.pow(10,2*s))+Ut("%",s)}function _6(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return na(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function iA(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+iA(e,-t);var s=e.indexOf(".");s===-1&&(s=e.indexOf("E"));var a=Math.floor(Math.log(t)*Math.LOG10E)%s;if(a<0&&(a+=s),r=(t/Math.pow(10,a)).toPrecision(n+1+(s+a)%s),r.indexOf("e")===-1){var i=Math.floor(Math.log(t)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(i-r.length+a):r+="E+"+(i-a);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,s)+"."+r.substr(2+s),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,l,c,u){return l+c+u.substr(0,(s+a)%s)+"."+u.substr(a)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var oA=/# (\?+)( ?)\/( ?)(\d+)/;function w6(e,t,r){var n=parseInt(e[4],10),s=Math.round(t*n),a=Math.floor(s/n),i=s-a*n,o=n;return r+(a===0?"":""+a)+" "+(i===0?Ut(" ",e[1].length+1+e[4].length):Xv(i,e[1].length)+e[2]+"/"+e[3]+as(o,e[4].length))}function E6(e,t,r){return r+(t===0?"":""+t)+Ut(" ",e[1].length+2+e[4].length)}var lA=/^#*0*\.([0#]+)/,cA=/\).*[0#]/,uA=/\(###\) ###\\?-####/;function Xr(e){for(var t="",r,n=0;n!=e.length;++n)switch(r=e.charCodeAt(n)){case 35:break;case 63:t+=" ";break;case 48:t+="0";break;default:t+=String.fromCharCode(r)}return t}function ew(e,t){var r=Math.pow(10,t);return""+Math.round(e*r)/r}function tw(e,t){var r=e-Math.floor(e),n=Math.pow(10,t);return t<(""+Math.round(r*n)).length?0:Math.round(r*n)}function T6(e,t){return t<(""+Math.round((e-Math.floor(e))*Math.pow(10,t))).length?1:0}function k6(e){return e<2147483647&&e>-2147483648?""+(e>=0?e|0:e-1|0):""+Math.floor(e)}function Fn(e,t,r){if(e.charCodeAt(0)===40&&!t.match(cA)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Fn("n",n,r):"("+Fn("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return _6(e,t,r);if(t.indexOf("%")!==-1)return y6(e,t,r);if(t.indexOf("E")!==-1)return iA(t,r);if(t.charCodeAt(0)===36)return"$"+Fn(e,t.substr(t.charAt(1)==" "?2:1),r);var s,a,i,o,l=Math.abs(r),c=r<0?"-":"";if(t.match(/^00+$/))return c+wo(l,t.length);if(t.match(/^[#?]+$/))return s=wo(r,0),s==="0"&&(s=""),s.length>t.length?s:Xr(t.substr(0,t.length-s.length))+s;if(a=t.match(oA))return w6(a,l,c);if(t.match(/^#+0+$/))return c+wo(l,t.length-t.indexOf("0"));if(a=t.match(lA))return s=ew(r,a[1].length).replace(/^([^\.]+)$/,"$1."+Xr(a[1])).replace(/\.$/,"."+Xr(a[1])).replace(/\.(\d*)$/,function(g,x){return"."+x+Ut("0",Xr(a[1]).length-x.length)}),t.indexOf("0.")!==-1?s:s.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),a=t.match(/^(0*)\.(#*)$/))return c+ew(l,a[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,a[1].length?"0.":".");if(a=t.match(/^#{1,3},##0(\.?)$/))return c+za(wo(l,0));if(a=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Fn(e,t,-r):za(""+(Math.floor(r)+T6(r,a[1].length)))+"."+as(tw(r,a[1].length),a[1].length);if(a=t.match(/^#,#*,#0/))return Fn(e,t.replace(/^#,#*,/,""),r);if(a=t.match(/^([0#]+)(\\?-([0#]+))+$/))return s=Yo(Fn(e,t.replace(/[\\-]/g,""),r)),i=0,Yo(Yo(t.replace(/\\/g,"")).replace(/[0#]/g,function(g){return i<s.length?s.charAt(i++):g==="0"?"0":""}));if(t.match(uA))return s=Fn(e,"##########",r),"("+s.substr(0,3)+") "+s.substr(3,3)+"-"+s.substr(6);var u="";if(a=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(a[4].length,7),o=td(l,Math.pow(10,i)-1,!1),s=""+c,u=na("n",a[1],o[1]),u.charAt(u.length-1)==" "&&(u=u.substr(0,u.length-1)+"0"),s+=u+a[2]+"/"+a[3],u=Zh(o[2],i),u.length<a[4].length&&(u=Xr(a[4].substr(a[4].length-u.length))+u),s+=u,s;if(a=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(Math.max(a[1].length,a[4].length),7),o=td(l,Math.pow(10,i)-1,!0),c+(o[0]||(o[1]?"":"0"))+" "+(o[1]?Xv(o[1],i)+a[2]+"/"+a[3]+Zh(o[2],i):Ut(" ",2*i+1+a[2].length+a[3].length));if(a=t.match(/^[#0?]+$/))return s=wo(r,0),t.length<=s.length?s:Xr(t.substr(0,t.length-s.length))+s;if(a=t.match(/^([#0?]+)\.([#0]+)$/)){s=""+r.toFixed(Math.min(a[2].length,10)).replace(/([^0])0+$/,"$1"),i=s.indexOf(".");var d=t.indexOf(".")-i,m=t.length-s.length-d;return Xr(t.substr(0,d)+s+t.substr(t.length-m))}if(a=t.match(/^00,000\.([#0]*0)$/))return i=tw(r,a[1].length),r<0?"-"+Fn(e,t,-r):za(k6(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(g){return"00,"+(g.length<3?as(0,3-g.length):"")+g})+"."+as(i,a[1].length);switch(t){case"###,##0.00":return Fn(e,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var p=za(wo(l,0));return p!=="0"?c+p:"";case"###,###.00":return Fn(e,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return Fn(e,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+t+"|")}function S6(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return na(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function A6(e,t,r){var n=t.replace(aA,""),s=t.length-n.length;return na(e,n,r*Math.pow(10,2*s))+Ut("%",s)}function fA(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+fA(e,-t);var s=e.indexOf(".");s===-1&&(s=e.indexOf("E"));var a=Math.floor(Math.log(t)*Math.LOG10E)%s;if(a<0&&(a+=s),r=(t/Math.pow(10,a)).toPrecision(n+1+(s+a)%s),!r.match(/[Ee]/)){var i=Math.floor(Math.log(t)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(i-r.length+a):r+="E+"+(i-a),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,l,c,u){return l+c+u.substr(0,(s+a)%s)+"."+u.substr(a)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function vs(e,t,r){if(e.charCodeAt(0)===40&&!t.match(cA)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?vs("n",n,r):"("+vs("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return S6(e,t,r);if(t.indexOf("%")!==-1)return A6(e,t,r);if(t.indexOf("E")!==-1)return fA(t,r);if(t.charCodeAt(0)===36)return"$"+vs(e,t.substr(t.charAt(1)==" "?2:1),r);var s,a,i,o,l=Math.abs(r),c=r<0?"-":"";if(t.match(/^00+$/))return c+as(l,t.length);if(t.match(/^[#?]+$/))return s=""+r,r===0&&(s=""),s.length>t.length?s:Xr(t.substr(0,t.length-s.length))+s;if(a=t.match(oA))return E6(a,l,c);if(t.match(/^#+0+$/))return c+as(l,t.length-t.indexOf("0"));if(a=t.match(lA))return s=(""+r).replace(/^([^\.]+)$/,"$1."+Xr(a[1])).replace(/\.$/,"."+Xr(a[1])),s=s.replace(/\.(\d*)$/,function(g,x){return"."+x+Ut("0",Xr(a[1]).length-x.length)}),t.indexOf("0.")!==-1?s:s.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),a=t.match(/^(0*)\.(#*)$/))return c+(""+l).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,a[1].length?"0.":".");if(a=t.match(/^#{1,3},##0(\.?)$/))return c+za(""+l);if(a=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+vs(e,t,-r):za(""+r)+"."+Ut("0",a[1].length);if(a=t.match(/^#,#*,#0/))return vs(e,t.replace(/^#,#*,/,""),r);if(a=t.match(/^([0#]+)(\\?-([0#]+))+$/))return s=Yo(vs(e,t.replace(/[\\-]/g,""),r)),i=0,Yo(Yo(t.replace(/\\/g,"")).replace(/[0#]/g,function(g){return i<s.length?s.charAt(i++):g==="0"?"0":""}));if(t.match(uA))return s=vs(e,"##########",r),"("+s.substr(0,3)+") "+s.substr(3,3)+"-"+s.substr(6);var u="";if(a=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(a[4].length,7),o=td(l,Math.pow(10,i)-1,!1),s=""+c,u=na("n",a[1],o[1]),u.charAt(u.length-1)==" "&&(u=u.substr(0,u.length-1)+"0"),s+=u+a[2]+"/"+a[3],u=Zh(o[2],i),u.length<a[4].length&&(u=Xr(a[4].substr(a[4].length-u.length))+u),s+=u,s;if(a=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(Math.max(a[1].length,a[4].length),7),o=td(l,Math.pow(10,i)-1,!0),c+(o[0]||(o[1]?"":"0"))+" "+(o[1]?Xv(o[1],i)+a[2]+"/"+a[3]+Zh(o[2],i):Ut(" ",2*i+1+a[2].length+a[3].length));if(a=t.match(/^[#0?]+$/))return s=""+r,t.length<=s.length?s:Xr(t.substr(0,t.length-s.length))+s;if(a=t.match(/^([#0]+)\.([#0]+)$/)){s=""+r.toFixed(Math.min(a[2].length,10)).replace(/([^0])0+$/,"$1"),i=s.indexOf(".");var d=t.indexOf(".")-i,m=t.length-s.length-d;return Xr(t.substr(0,d)+s+t.substr(t.length-m))}if(a=t.match(/^00,000\.([#0]*0)$/))return r<0?"-"+vs(e,t,-r):za(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(g){return"00,"+(g.length<3?as(0,3-g.length):"")+g})+"."+as(0,a[1].length);switch(t){case"###,###":case"##,###":case"#,###":var p=za(""+l);return p!=="0"?c+p:"";default:if(t.match(/\.[0#?]*$/))return vs(e,t.slice(0,t.lastIndexOf(".")),r)+Xr(t.slice(t.lastIndexOf(".")))}throw new Error("unsupported format |"+t+"|")}function na(e,t,r){return(r|0)===r?vs(e,t,r):Fn(e,t,r)}function I6(e){for(var t=[],r=!1,n=0,s=0;n<e.length;++n)switch(e.charCodeAt(n)){case 34:r=!r;break;case 95:case 42:case 92:++n;break;case 59:t[t.length]=e.substr(s,n-s),s=n+1}if(t[t.length]=e.substr(s),r===!0)throw new Error("Format |"+e+"| unterminated string ");return t}var hA=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function Al(e){for(var t=0,r="",n="";t<e.length;)switch(r=e.charAt(t)){case"G":ed(e,t)&&(t+=6),t++;break;case'"':for(;e.charCodeAt(++t)!==34&&t<e.length;);++t;break;case"\\":t+=2;break;case"_":t+=2;break;case"@":++t;break;case"B":case"b":if(e.charAt(t+1)==="1"||e.charAt(t+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(e.substr(t,3).toUpperCase()==="A/P"||e.substr(t,5).toUpperCase()==="AM/PM"||e.substr(t,5).toUpperCase()==="/")return!0;++t;break;case"[":for(n=r;e.charAt(t++)!=="]"&&t<e.length;)n+=e.charAt(t);if(n.match(hA))return!0;break;case".":case"0":case"#":for(;t<e.length&&("0#?.,E+-%".indexOf(r=e.charAt(++t))>-1||r=="\\"&&e.charAt(t+1)=="-"&&"0#".indexOf(e.charAt(t+2))>-1););break;case"?":for(;e.charAt(++t)===r;);break;case"*":++t,(e.charAt(t)==" "||e.charAt(t)=="*")&&++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<e.length&&"0123456789".indexOf(e.charAt(++t))>-1;);break;case" ":++t;break;default:++t;break}return!1}function C6(e,t,r,n){for(var s=[],a="",i=0,o="",l="t",c,u,d,m="H";i<e.length;)switch(o=e.charAt(i)){case"G":if(!ed(e,i))throw new Error("unrecognized character "+o+" in "+e);s[s.length]={t:"G",v:"General"},i+=7;break;case'"':for(a="";(d=e.charCodeAt(++i))!==34&&i<e.length;)a+=String.fromCharCode(d);s[s.length]={t:"t",v:a},++i;break;case"\\":var p=e.charAt(++i),g=p==="("||p===")"?p:"t";s[s.length]={t:g,v:p},++i;break;case"_":s[s.length]={t:"t",v:" "},i+=2;break;case"@":s[s.length]={t:"T",v:t},++i;break;case"B":case"b":if(e.charAt(i+1)==="1"||e.charAt(i+1)==="2"){if(c==null&&(c=Di(t,r,e.charAt(i+1)==="2"),c==null))return"";s[s.length]={t:"X",v:e.substr(i,2)},l=o,i+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":o=o.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0||c==null&&(c=Di(t,r),c==null))return"";for(a=o;++i<e.length&&e.charAt(i).toLowerCase()===o;)a+=o;o==="m"&&l.toLowerCase()==="h"&&(o="M"),o==="h"&&(o=m),s[s.length]={t:o,v:a},l=o;break;case"A":case"a":case"":var x={t:o,v:o};if(c==null&&(c=Di(t,r)),e.substr(i,3).toUpperCase()==="A/P"?(c!=null&&(x.v=c.H>=12?"P":"A"),x.t="T",m="h",i+=3):e.substr(i,5).toUpperCase()==="AM/PM"?(c!=null&&(x.v=c.H>=12?"PM":"AM"),x.t="T",i+=5,m="h"):e.substr(i,5).toUpperCase()==="/"?(c!=null&&(x.v=c.H>=12?"":""),x.t="T",i+=5,m="h"):(x.t="t",++i),c==null&&x.t==="T")return"";s[s.length]=x,l=o;break;case"[":for(a=o;e.charAt(i++)!=="]"&&i<e.length;)a+=e.charAt(i);if(a.slice(-1)!=="]")throw'unterminated "[" block: |'+a+"|";if(a.match(hA)){if(c==null&&(c=Di(t,r),c==null))return"";s[s.length]={t:"Z",v:a.toLowerCase()},l=a.charAt(1)}else a.indexOf("$")>-1&&(a=(a.match(/\$([^-\[\]]*)/)||[])[1]||"$",Al(e)||(s[s.length]={t:"t",v:a}));break;case".":if(c!=null){for(a=o;++i<e.length&&(o=e.charAt(i))==="0";)a+=o;s[s.length]={t:"s",v:a};break}case"0":case"#":for(a=o;++i<e.length&&"0#?.,E+-%".indexOf(o=e.charAt(i))>-1;)a+=o;s[s.length]={t:"n",v:a};break;case"?":for(a=o;e.charAt(++i)===o;)a+=o;s[s.length]={t:o,v:a},l=o;break;case"*":++i,(e.charAt(i)==" "||e.charAt(i)=="*")&&++i;break;case"(":case")":s[s.length]={t:n===1?"t":o,v:o},++i;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(a=o;i<e.length&&"0123456789".indexOf(e.charAt(++i))>-1;)a+=e.charAt(i);s[s.length]={t:"D",v:a};break;case" ":s[s.length]={t:o,v:o},++i;break;case"$":s[s.length]={t:"t",v:"$"},++i;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(o)===-1)throw new Error("unrecognized character "+o+" in "+e);s[s.length]={t:"t",v:o},++i;break}var w=0,k=0,T;for(i=s.length-1,l="t";i>=0;--i)switch(s[i].t){case"h":case"H":s[i].t=m,l="h",w<1&&(w=1);break;case"s":(T=s[i].v.match(/\.0+$/))&&(k=Math.max(k,T[0].length-1)),w<3&&(w=3);case"d":case"y":case"M":case"e":l=s[i].t;break;case"m":l==="s"&&(s[i].t="M",w<2&&(w=2));break;case"X":break;case"Z":w<1&&s[i].v.match(/[Hh]/)&&(w=1),w<2&&s[i].v.match(/[Mm]/)&&(w=2),w<3&&s[i].v.match(/[Ss]/)&&(w=3)}switch(w){case 0:break;case 1:c.u>=.5&&(c.u=0,++c.S),c.S>=60&&(c.S=0,++c.M),c.M>=60&&(c.M=0,++c.H);break;case 2:c.u>=.5&&(c.u=0,++c.S),c.S>=60&&(c.S=0,++c.M);break}var E="",N;for(i=0;i<s.length;++i)switch(s[i].t){case"t":case"T":case" ":case"D":break;case"X":s[i].v="",s[i].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":s[i].v=x6(s[i].t.charCodeAt(0),s[i].v,c,k),s[i].t="t";break;case"n":case"?":for(N=i+1;s[N]!=null&&((o=s[N].t)==="?"||o==="D"||(o===" "||o==="t")&&s[N+1]!=null&&(s[N+1].t==="?"||s[N+1].t==="t"&&s[N+1].v==="/")||s[i].t==="("&&(o===" "||o==="n"||o===")")||o==="t"&&(s[N].v==="/"||s[N].v===" "&&s[N+1]!=null&&s[N+1].t=="?"));)s[i].v+=s[N].v,s[N]={v:"",t:";"},++N;E+=s[i].v,i=N-1;break;case"G":s[i].t="t",s[i].v=Qi(t,r);break}var M="",O,v;if(E.length>0){E.charCodeAt(0)==40?(O=t<0&&E.charCodeAt(0)===45?-t:t,v=na("n",E,O)):(O=t<0&&n>1?-t:t,v=na("n",E,O),O<0&&s[0]&&s[0].t=="t"&&(v=v.substr(1),s[0].v="-"+s[0].v)),N=v.length-1;var _=s.length;for(i=0;i<s.length;++i)if(s[i]!=null&&s[i].t!="t"&&s[i].v.indexOf(".")>-1){_=i;break}var S=s.length;if(_===s.length&&v.indexOf("E")===-1){for(i=s.length-1;i>=0;--i)s[i]==null||"n?".indexOf(s[i].t)===-1||(N>=s[i].v.length-1?(N-=s[i].v.length,s[i].v=v.substr(N+1,s[i].v.length)):N<0?s[i].v="":(s[i].v=v.substr(0,N+1),N=-1),s[i].t="t",S=i);N>=0&&S<s.length&&(s[S].v=v.substr(0,N+1)+s[S].v)}else if(_!==s.length&&v.indexOf("E")===-1){for(N=v.indexOf(".")-1,i=_;i>=0;--i)if(!(s[i]==null||"n?".indexOf(s[i].t)===-1)){for(u=s[i].v.indexOf(".")>-1&&i===_?s[i].v.indexOf(".")-1:s[i].v.length-1,M=s[i].v.substr(u+1);u>=0;--u)N>=0&&(s[i].v.charAt(u)==="0"||s[i].v.charAt(u)==="#")&&(M=v.charAt(N--)+M);s[i].v=M,s[i].t="t",S=i}for(N>=0&&S<s.length&&(s[S].v=v.substr(0,N+1)+s[S].v),N=v.indexOf(".")+1,i=_;i<s.length;++i)if(!(s[i]==null||"n?(".indexOf(s[i].t)===-1&&i!==_)){for(u=s[i].v.indexOf(".")>-1&&i===_?s[i].v.indexOf(".")+1:0,M=s[i].v.substr(0,u);u<s[i].v.length;++u)N<v.length&&(M+=v.charAt(N++));s[i].v=M,s[i].t="t",S=i}}}for(i=0;i<s.length;++i)s[i]!=null&&"n?".indexOf(s[i].t)>-1&&(O=n>1&&t<0&&i>0&&s[i-1].v==="-"?-t:t,s[i].v=na(s[i].t,s[i].v,O),s[i].t="t");var I="";for(i=0;i!==s.length;++i)s[i]!=null&&(I+=s[i].v);return I}var rw=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function nw(e,t){if(t==null)return!1;var r=parseFloat(t[2]);switch(t[1]){case"=":if(e==r)return!0;break;case">":if(e>r)return!0;break;case"<":if(e<r)return!0;break;case"<>":if(e!=r)return!0;break;case">=":if(e>=r)return!0;break;case"<=":if(e<=r)return!0;break}return!1}function N6(e,t){var r=I6(e),n=r.length,s=r[n-1].indexOf("@");if(n<4&&s>-1&&--n,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof t!="number")return[4,r.length===4||s>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=s>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=s>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=s>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var a=t>0?r[0]:t<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[n,a];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var i=r[0].match(rw),o=r[1].match(rw);return nw(t,i)?[n,r[0]]:nw(t,o)?[n,r[1]]:[n,r[i!=null&&o!=null?2:1]]}return[n,a]}function Wn(e,t,r){r==null&&(r={});var n="";switch(typeof e){case"string":e=="m/d/yy"&&r.dateNF?n=r.dateNF:n=e;break;case"number":e==14&&r.dateNF?n=r.dateNF:n=(r.table!=null?r.table:ze)[e],n==null&&(n=r.table&&r.table[Z_[e]]||ze[Z_[e]]),n==null&&(n=f6[e]||"General");break}if(ed(n,0))return Qi(t,r);t instanceof Date&&(t=sA(t,r.date1904));var s=N6(n,t);if(ed(s[1]))return Qi(t,r);if(t===!0)t="TRUE";else if(t===!1)t="FALSE";else if(t===""||t==null)return"";return C6(s[1],t,r,s[0])}function ji(e,t){if(typeof t!="number"){t=+t||-1;for(var r=0;r<392;++r){if(ze[r]==null){t<0&&(t=r);continue}if(ze[r]==e){t=r;break}}t<0&&(t=391)}return ze[t]=e,t}function dA(){ze=u6()}var R6={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},mA=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function b6(e){var t=typeof e=="number"?ze[e]:e;return t=t.replace(mA,"(\\d+)"),new RegExp("^"+t+"$")}function P6(e,t,r){var n=-1,s=-1,a=-1,i=-1,o=-1,l=-1;(t.match(mA)||[]).forEach(function(d,m){var p=parseInt(r[m+1],10);switch(d.toLowerCase().charAt(0)){case"y":n=p;break;case"d":a=p;break;case"h":i=p;break;case"s":l=p;break;case"m":i>=0?o=p:s=p;break}}),l>=0&&o==-1&&s>=0&&(o=s,s=-1);var c=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(s>=1?s:1)).slice(-2)+"-"+("00"+(a>=1?a:1)).slice(-2);c.length==7&&(c="0"+c),c.length==8&&(c="20"+c);var u=("00"+(i>=0?i:0)).slice(-2)+":"+("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(l>=0?l:0)).slice(-2);return i==-1&&o==-1&&l==-1?c:n==-1&&s==-1&&a==-1?u:c+"T"+u}var D6=function(){var e={};e.version="1.2.0";function t(){for(var v=0,_=new Array(256),S=0;S!=256;++S)v=S,v=v&1?-306674912^v>>>1:v>>>1,v=v&1?-306674912^v>>>1:v>>>1,v=v&1?-306674912^v>>>1:v>>>1,v=v&1?-306674912^v>>>1:v>>>1,v=v&1?-306674912^v>>>1:v>>>1,v=v&1?-306674912^v>>>1:v>>>1,v=v&1?-306674912^v>>>1:v>>>1,v=v&1?-306674912^v>>>1:v>>>1,_[S]=v;return typeof Int32Array<"u"?new Int32Array(_):_}var r=t();function n(v){var _=0,S=0,I=0,b=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(I=0;I!=256;++I)b[I]=v[I];for(I=0;I!=256;++I)for(S=v[I],_=256+I;_<4096;_+=256)S=b[_]=S>>>8^v[S&255];var P=[];for(I=1;I!=16;++I)P[I-1]=typeof Int32Array<"u"?b.subarray(I*256,I*256+256):b.slice(I*256,I*256+256);return P}var s=n(r),a=s[0],i=s[1],o=s[2],l=s[3],c=s[4],u=s[5],d=s[6],m=s[7],p=s[8],g=s[9],x=s[10],w=s[11],k=s[12],T=s[13],E=s[14];function N(v,_){for(var S=_^-1,I=0,b=v.length;I<b;)S=S>>>8^r[(S^v.charCodeAt(I++))&255];return~S}function M(v,_){for(var S=_^-1,I=v.length-15,b=0;b<I;)S=E[v[b++]^S&255]^T[v[b++]^S>>8&255]^k[v[b++]^S>>16&255]^w[v[b++]^S>>>24]^x[v[b++]]^g[v[b++]]^p[v[b++]]^m[v[b++]]^d[v[b++]]^u[v[b++]]^c[v[b++]]^l[v[b++]]^o[v[b++]]^i[v[b++]]^a[v[b++]]^r[v[b++]];for(I+=15;b<I;)S=S>>>8^r[(S^v[b++])&255];return~S}function O(v,_){for(var S=_^-1,I=0,b=v.length,P=0,R=0;I<b;)P=v.charCodeAt(I++),P<128?S=S>>>8^r[(S^P)&255]:P<2048?(S=S>>>8^r[(S^(192|P>>6&31))&255],S=S>>>8^r[(S^(128|P&63))&255]):P>=55296&&P<57344?(P=(P&1023)+64,R=v.charCodeAt(I++)&1023,S=S>>>8^r[(S^(240|P>>8&7))&255],S=S>>>8^r[(S^(128|P>>2&63))&255],S=S>>>8^r[(S^(128|R>>6&15|(P&3)<<4))&255],S=S>>>8^r[(S^(128|R&63))&255]):(S=S>>>8^r[(S^(224|P>>12&15))&255],S=S>>>8^r[(S^(128|P>>6&63))&255],S=S>>>8^r[(S^(128|P&63))&255]);return~S}return e.table=r,e.bstr=N,e.buf=M,e.str=O,e}(),rt=function(){var t={};t.version="1.2.1";function r(C,V){for(var D=C.split("/"),F=V.split("/"),L=0,j=0,Y=Math.min(D.length,F.length);L<Y;++L){if(j=D[L].length-F[L].length)return j;if(D[L]!=F[L])return D[L]<F[L]?-1:1}return D.length-F.length}function n(C){if(C.charAt(C.length-1)=="/")return C.slice(0,-1).indexOf("/")===-1?C:n(C.slice(0,-1));var V=C.lastIndexOf("/");return V===-1?C:C.slice(0,V+1)}function s(C){if(C.charAt(C.length-1)=="/")return s(C.slice(0,-1));var V=C.lastIndexOf("/");return V===-1?C:C.slice(V+1)}function a(C,V){typeof V=="string"&&(V=new Date(V));var D=V.getHours();D=D<<6|V.getMinutes(),D=D<<5|V.getSeconds()>>>1,C.write_shift(2,D);var F=V.getFullYear()-1980;F=F<<4|V.getMonth()+1,F=F<<5|V.getDate(),C.write_shift(2,F)}function i(C){var V=C.read_shift(2)&65535,D=C.read_shift(2)&65535,F=new Date,L=D&31;D>>>=5;var j=D&15;D>>>=4,F.setMilliseconds(0),F.setFullYear(D+1980),F.setMonth(j-1),F.setDate(L);var Y=V&31;V>>>=5;var re=V&63;return V>>>=6,F.setHours(V),F.setMinutes(re),F.setSeconds(Y<<1),F}function o(C){yr(C,0);for(var V={},D=0;C.l<=C.length-4;){var F=C.read_shift(2),L=C.read_shift(2),j=C.l+L,Y={};switch(F){case 21589:D=C.read_shift(1),D&1&&(Y.mtime=C.read_shift(4)),L>5&&(D&2&&(Y.atime=C.read_shift(4)),D&4&&(Y.ctime=C.read_shift(4))),Y.mtime&&(Y.mt=new Date(Y.mtime*1e3));break}C.l=j,V[F]=Y}return V}var l;function c(){return l||(l={})}function u(C,V){if(C[0]==80&&C[1]==75)return wa(C,V);if((C[0]|32)==109&&(C[1]|32)==105)return po(C,V);if(C.length<512)throw new Error("CFB file size "+C.length+" < 512");var D=3,F=512,L=0,j=0,Y=0,re=0,te=0,Z=[],Q=C.slice(0,512);yr(Q,0);var fe=d(Q);switch(D=fe[0],D){case 3:F=512;break;case 4:F=4096;break;case 0:if(fe[1]==0)return wa(C,V);default:throw new Error("Major Version: Expected 3 or 4 saw "+D)}F!==512&&(Q=C.slice(0,F),yr(Q,28));var we=C.slice(0,F);m(Q,D);var Ce=Q.read_shift(4,"i");if(D===3&&Ce!==0)throw new Error("# Directory Sectors: Expected 0 saw "+Ce);Q.l+=4,Y=Q.read_shift(4,"i"),Q.l+=4,Q.chk("00100000","Mini Stream Cutoff Size: "),re=Q.read_shift(4,"i"),L=Q.read_shift(4,"i"),te=Q.read_shift(4,"i"),j=Q.read_shift(4,"i");for(var ve=-1,Ee=0;Ee<109&&(ve=Q.read_shift(4,"i"),!(ve<0));++Ee)Z[Ee]=ve;var De=p(C,F);w(te,j,De,F,Z);var at=T(De,Y,Z,F);at[Y].name="!Directory",L>0&&re!==R&&(at[re].name="!MiniFAT"),at[Z[0]].name="!FAT",at.fat_addrs=Z,at.ssz=F;var Ke={},mt=[],an=[],We=[];E(Y,at,De,mt,L,Ke,an,re),g(an,We,mt),mt.shift();var ht={FileIndex:an,FullPaths:We};return V&&V.raw&&(ht.raw={header:we,sectors:De}),ht}function d(C){if(C[C.l]==80&&C[C.l+1]==75)return[0,0];C.chk(ue,"Header Signature: "),C.l+=16;var V=C.read_shift(2,"u");return[C.read_shift(2,"u"),V]}function m(C,V){var D=9;switch(C.l+=2,D=C.read_shift(2)){case 9:if(V!=3)throw new Error("Sector Shift: Expected 9 saw "+D);break;case 12:if(V!=4)throw new Error("Sector Shift: Expected 12 saw "+D);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+D)}C.chk("0600","Mini Sector Shift: "),C.chk("000000000000","Reserved: ")}function p(C,V){for(var D=Math.ceil(C.length/V)-1,F=[],L=1;L<D;++L)F[L-1]=C.slice(L*V,(L+1)*V);return F[D-1]=C.slice(D*V),F}function g(C,V,D){for(var F=0,L=0,j=0,Y=0,re=0,te=D.length,Z=[],Q=[];F<te;++F)Z[F]=Q[F]=F,V[F]=D[F];for(;re<Q.length;++re)F=Q[re],L=C[F].L,j=C[F].R,Y=C[F].C,Z[F]===F&&(L!==-1&&Z[L]!==L&&(Z[F]=Z[L]),j!==-1&&Z[j]!==j&&(Z[F]=Z[j])),Y!==-1&&(Z[Y]=F),L!==-1&&F!=Z[F]&&(Z[L]=Z[F],Q.lastIndexOf(L)<re&&Q.push(L)),j!==-1&&F!=Z[F]&&(Z[j]=Z[F],Q.lastIndexOf(j)<re&&Q.push(j));for(F=1;F<te;++F)Z[F]===F&&(j!==-1&&Z[j]!==j?Z[F]=Z[j]:L!==-1&&Z[L]!==L&&(Z[F]=Z[L]));for(F=1;F<te;++F)if(C[F].type!==0){if(re=F,re!=Z[re])do re=Z[re],V[F]=V[re]+"/"+V[F];while(re!==0&&Z[re]!==-1&&re!=Z[re]);Z[F]=-1}for(V[0]+="/",F=1;F<te;++F)C[F].type!==2&&(V[F]+="/")}function x(C,V,D){for(var F=C.start,L=C.size,j=[],Y=F;D&&L>0&&Y>=0;)j.push(V.slice(Y*P,Y*P+P)),L-=P,Y=Ai(D,Y*4);return j.length===0?tr(0):Ma(j).slice(0,C.size)}function w(C,V,D,F,L){var j=R;if(C===R){if(V!==0)throw new Error("DIFAT chain shorter than expected")}else if(C!==-1){var Y=D[C],re=(F>>>2)-1;if(!Y)return;for(var te=0;te<re&&(j=Ai(Y,te*4))!==R;++te)L.push(j);w(Ai(Y,F-4),V-1,D,F,L)}}function k(C,V,D,F,L){var j=[],Y=[];L||(L=[]);var re=F-1,te=0,Z=0;for(te=V;te>=0;){L[te]=!0,j[j.length]=te,Y.push(C[te]);var Q=D[Math.floor(te*4/F)];if(Z=te*4&re,F<4+Z)throw new Error("FAT boundary crossed: "+te+" 4 "+F);if(!C[Q])break;te=Ai(C[Q],Z)}return{nodes:j,data:dw([Y])}}function T(C,V,D,F){var L=C.length,j=[],Y=[],re=[],te=[],Z=F-1,Q=0,fe=0,we=0,Ce=0;for(Q=0;Q<L;++Q)if(re=[],we=Q+V,we>=L&&(we-=L),!Y[we]){te=[];var ve=[];for(fe=we;fe>=0;){ve[fe]=!0,Y[fe]=!0,re[re.length]=fe,te.push(C[fe]);var Ee=D[Math.floor(fe*4/F)];if(Ce=fe*4&Z,F<4+Ce)throw new Error("FAT boundary crossed: "+fe+" 4 "+F);if(!C[Ee]||(fe=Ai(C[Ee],Ce),ve[fe]))break}j[we]={nodes:re,data:dw([te])}}return j}function E(C,V,D,F,L,j,Y,re){for(var te=0,Z=F.length?2:0,Q=V[C].data,fe=0,we=0,Ce;fe<Q.length;fe+=128){var ve=Q.slice(fe,fe+128);yr(ve,64),we=ve.read_shift(2),Ce=tx(ve,0,we-Z),F.push(Ce);var Ee={name:Ce,type:ve.read_shift(1),color:ve.read_shift(1),L:ve.read_shift(4,"i"),R:ve.read_shift(4,"i"),C:ve.read_shift(4,"i"),clsid:ve.read_shift(16),state:ve.read_shift(4,"i"),start:0,size:0},De=ve.read_shift(2)+ve.read_shift(2)+ve.read_shift(2)+ve.read_shift(2);De!==0&&(Ee.ct=N(ve,ve.l-8));var at=ve.read_shift(2)+ve.read_shift(2)+ve.read_shift(2)+ve.read_shift(2);at!==0&&(Ee.mt=N(ve,ve.l-8)),Ee.start=ve.read_shift(4,"i"),Ee.size=ve.read_shift(4,"i"),Ee.size<0&&Ee.start<0&&(Ee.size=Ee.type=0,Ee.start=R,Ee.name=""),Ee.type===5?(te=Ee.start,L>0&&te!==R&&(V[te].name="!StreamData")):Ee.size>=4096?(Ee.storage="fat",V[Ee.start]===void 0&&(V[Ee.start]=k(D,Ee.start,V.fat_addrs,V.ssz)),V[Ee.start].name=Ee.name,Ee.content=V[Ee.start].data.slice(0,Ee.size)):(Ee.storage="minifat",Ee.size<0?Ee.size=0:te!==R&&Ee.start!==R&&V[te]&&(Ee.content=x(Ee,V[te].data,(V[re]||{}).data))),Ee.content&&yr(Ee.content,0),j[Ce]=Ee,Y.push(Ee)}}function N(C,V){return new Date((_n(C,V+4)/1e7*Math.pow(2,32)+_n(C,V)/1e7-11644473600)*1e3)}function M(C,V){return c(),u(l.readFileSync(C),V)}function O(C,V){var D=V&&V.type;switch(D||Qe&&Buffer.isBuffer(C)&&(D="buffer"),D||"base64"){case"file":return M(C,V);case"base64":return u(rs(An(C)),V);case"binary":return u(rs(C),V)}return u(C,V)}function v(C,V){var D=V||{},F=D.root||"Root Entry";if(C.FullPaths||(C.FullPaths=[]),C.FileIndex||(C.FileIndex=[]),C.FullPaths.length!==C.FileIndex.length)throw new Error("inconsistent CFB structure");C.FullPaths.length===0&&(C.FullPaths[0]=F+"/",C.FileIndex[0]={name:F,type:5}),D.CLSID&&(C.FileIndex[0].clsid=D.CLSID),_(C)}function _(C){var V="Sh33tJ5";if(!rt.find(C,"/"+V)){var D=tr(4);D[0]=55,D[1]=D[3]=50,D[2]=54,C.FileIndex.push({name:V,type:2,content:D,size:4,L:69,R:69,C:69}),C.FullPaths.push(C.FullPaths[0]+V),S(C)}}function S(C,V){v(C);for(var D=!1,F=!1,L=C.FullPaths.length-1;L>=0;--L){var j=C.FileIndex[L];switch(j.type){case 0:F?D=!0:(C.FileIndex.pop(),C.FullPaths.pop());break;case 1:case 2:case 5:F=!0,isNaN(j.R*j.L*j.C)&&(D=!0),j.R>-1&&j.L>-1&&j.R==j.L&&(D=!0);break;default:D=!0;break}}if(!(!D&&!V)){var Y=new Date(1987,1,19),re=0,te=Object.create?Object.create(null):{},Z=[];for(L=0;L<C.FullPaths.length;++L)te[C.FullPaths[L]]=!0,C.FileIndex[L].type!==0&&Z.push([C.FullPaths[L],C.FileIndex[L]]);for(L=0;L<Z.length;++L){var Q=n(Z[L][0]);F=te[Q],F||(Z.push([Q,{name:s(Q).replace("/",""),type:1,clsid:he,ct:Y,mt:Y,content:null}]),te[Q]=!0)}for(Z.sort(function(Ce,ve){return r(Ce[0],ve[0])}),C.FullPaths=[],C.FileIndex=[],L=0;L<Z.length;++L)C.FullPaths[L]=Z[L][0],C.FileIndex[L]=Z[L][1];for(L=0;L<Z.length;++L){var fe=C.FileIndex[L],we=C.FullPaths[L];if(fe.name=s(we).replace("/",""),fe.L=fe.R=fe.C=-(fe.color=1),fe.size=fe.content?fe.content.length:0,fe.start=0,fe.clsid=fe.clsid||he,L===0)fe.C=Z.length>1?1:-1,fe.size=0,fe.type=5;else if(we.slice(-1)=="/"){for(re=L+1;re<Z.length&&n(C.FullPaths[re])!=we;++re);for(fe.C=re>=Z.length?-1:re,re=L+1;re<Z.length&&n(C.FullPaths[re])!=n(we);++re);fe.R=re>=Z.length?-1:re,fe.type=1}else n(C.FullPaths[L+1]||"")==n(we)&&(fe.R=L+1),fe.type=2}}}function I(C,V){var D=V||{};if(D.fileType=="mad")return er(C,D);switch(S(C),D.fileType){case"zip":return Us(C,D)}var F=function(Ce){for(var ve=0,Ee=0,De=0;De<Ce.FileIndex.length;++De){var at=Ce.FileIndex[De];if(at.content){var Ke=at.content.length;Ke>0&&(Ke<4096?ve+=Ke+63>>6:Ee+=Ke+511>>9)}}for(var mt=Ce.FullPaths.length+3>>2,an=ve+7>>3,We=ve+127>>7,ht=an+Ee+mt+We,pr=ht+127>>7,Pn=pr<=109?0:Math.ceil((pr-109)/127);ht+pr+Pn+127>>7>pr;)Pn=++pr<=109?0:Math.ceil((pr-109)/127);var Ze=[1,Pn,pr,We,mt,Ee,ve,0];return Ce.FileIndex[0].size=ve<<6,Ze[7]=(Ce.FileIndex[0].start=Ze[0]+Ze[1]+Ze[2]+Ze[3]+Ze[4]+Ze[5])+(Ze[6]+7>>3),Ze}(C),L=tr(F[7]<<9),j=0,Y=0;{for(j=0;j<8;++j)L.write_shift(1,le[j]);for(j=0;j<8;++j)L.write_shift(2,0);for(L.write_shift(2,62),L.write_shift(2,3),L.write_shift(2,65534),L.write_shift(2,9),L.write_shift(2,6),j=0;j<3;++j)L.write_shift(2,0);for(L.write_shift(4,0),L.write_shift(4,F[2]),L.write_shift(4,F[0]+F[1]+F[2]+F[3]-1),L.write_shift(4,0),L.write_shift(4,4096),L.write_shift(4,F[3]?F[0]+F[1]+F[2]-1:R),L.write_shift(4,F[3]),L.write_shift(-4,F[1]?F[0]-1:R),L.write_shift(4,F[1]),j=0;j<109;++j)L.write_shift(-4,j<F[2]?F[1]+j:-1)}if(F[1])for(Y=0;Y<F[1];++Y){for(;j<236+Y*127;++j)L.write_shift(-4,j<F[2]?F[1]+j:-1);L.write_shift(-4,Y===F[1]-1?R:Y+1)}var re=function(Ce){for(Y+=Ce;j<Y-1;++j)L.write_shift(-4,j+1);Ce&&(++j,L.write_shift(-4,R))};for(Y=j=0,Y+=F[1];j<Y;++j)L.write_shift(-4,pe.DIFSECT);for(Y+=F[2];j<Y;++j)L.write_shift(-4,pe.FATSECT);re(F[3]),re(F[4]);for(var te=0,Z=0,Q=C.FileIndex[0];te<C.FileIndex.length;++te)Q=C.FileIndex[te],Q.content&&(Z=Q.content.length,!(Z<4096)&&(Q.start=Y,re(Z+511>>9)));for(re(F[6]+7>>3);L.l&511;)L.write_shift(-4,pe.ENDOFCHAIN);for(Y=j=0,te=0;te<C.FileIndex.length;++te)Q=C.FileIndex[te],Q.content&&(Z=Q.content.length,!(!Z||Z>=4096)&&(Q.start=Y,re(Z+63>>6)));for(;L.l&511;)L.write_shift(-4,pe.ENDOFCHAIN);for(j=0;j<F[4]<<2;++j){var fe=C.FullPaths[j];if(!fe||fe.length===0){for(te=0;te<17;++te)L.write_shift(4,0);for(te=0;te<3;++te)L.write_shift(4,-1);for(te=0;te<12;++te)L.write_shift(4,0);continue}Q=C.FileIndex[j],j===0&&(Q.start=Q.size?Q.start-1:R);var we=j===0&&D.root||Q.name;if(Z=2*(we.length+1),L.write_shift(64,we,"utf16le"),L.write_shift(2,Z),L.write_shift(1,Q.type),L.write_shift(1,Q.color),L.write_shift(-4,Q.L),L.write_shift(-4,Q.R),L.write_shift(-4,Q.C),Q.clsid)L.write_shift(16,Q.clsid,"hex");else for(te=0;te<4;++te)L.write_shift(4,0);L.write_shift(4,Q.state||0),L.write_shift(4,0),L.write_shift(4,0),L.write_shift(4,0),L.write_shift(4,0),L.write_shift(4,Q.start),L.write_shift(4,Q.size),L.write_shift(4,0)}for(j=1;j<C.FileIndex.length;++j)if(Q=C.FileIndex[j],Q.size>=4096)if(L.l=Q.start+1<<9,Qe&&Buffer.isBuffer(Q.content))Q.content.copy(L,L.l,0,Q.size),L.l+=Q.size+511&-512;else{for(te=0;te<Q.size;++te)L.write_shift(1,Q.content[te]);for(;te&511;++te)L.write_shift(1,0)}for(j=1;j<C.FileIndex.length;++j)if(Q=C.FileIndex[j],Q.size>0&&Q.size<4096)if(Qe&&Buffer.isBuffer(Q.content))Q.content.copy(L,L.l,0,Q.size),L.l+=Q.size+63&-64;else{for(te=0;te<Q.size;++te)L.write_shift(1,Q.content[te]);for(;te&63;++te)L.write_shift(1,0)}if(Qe)L.l=L.length;else for(;L.l<L.length;)L.write_shift(1,0);return L}function b(C,V){var D=C.FullPaths.map(function(te){return te.toUpperCase()}),F=D.map(function(te){var Z=te.split("/");return Z[Z.length-(te.slice(-1)=="/"?2:1)]}),L=!1;V.charCodeAt(0)===47?(L=!0,V=D[0].slice(0,-1)+V):L=V.indexOf("/")!==-1;var j=V.toUpperCase(),Y=L===!0?D.indexOf(j):F.indexOf(j);if(Y!==-1)return C.FileIndex[Y];var re=!j.match(ic);for(j=j.replace(Zr,""),re&&(j=j.replace(ic,"!")),Y=0;Y<D.length;++Y)if((re?D[Y].replace(ic,"!"):D[Y]).replace(Zr,"")==j||(re?F[Y].replace(ic,"!"):F[Y]).replace(Zr,"")==j)return C.FileIndex[Y];return null}var P=64,R=-2,ue="d0cf11e0a1b11ae1",le=[208,207,17,224,161,177,26,225],he="00000000000000000000000000000000",pe={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:R,FREESECT:-1,HEADER_SIGNATURE:ue,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:he,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function ee(C,V,D){c();var F=I(C,D);l.writeFileSync(V,F)}function H(C){for(var V=new Array(C.length),D=0;D<C.length;++D)V[D]=String.fromCharCode(C[D]);return V.join("")}function se(C,V){var D=I(C,V);switch(V&&V.type||"buffer"){case"file":return c(),l.writeFileSync(V.filename,D),D;case"binary":return typeof D=="string"?D:H(D);case"base64":return X_(typeof D=="string"?D:H(D));case"buffer":if(Qe)return Buffer.isBuffer(D)?D:io(D);case"array":return typeof D=="string"?rs(D):D}return D}var ce;function B(C){try{var V=C.InflateRaw,D=new V;if(D._processChunk(new Uint8Array([3,0]),D._finishFlushFlag),D.bytesRead)ce=C;else throw new Error("zlib does not expose bytesRead")}catch(F){console.error("cannot use native zlib: "+(F.message||F))}}function K(C,V){if(!ce)return Vs(C,V);var D=ce.InflateRaw,F=new D,L=F._processChunk(C.slice(C.l),F._finishFlushFlag);return C.l+=F.bytesRead,L}function X(C){return ce?ce.deflateRawSync(C):je(C)}var G=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],ie=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],ge=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function Ie(C){var V=(C<<1|C<<11)&139536|(C<<5|C<<15)&558144;return(V>>16|V>>8|V)&255}for(var Te=typeof Uint8Array<"u",ye=Te?new Uint8Array(256):[],$e=0;$e<256;++$e)ye[$e]=Ie($e);function W(C,V){var D=ye[C&255];return V<=8?D>>>8-V:(D=D<<8|ye[C>>8&255],V<=16?D>>>16-V:(D=D<<8|ye[C>>16&255],D>>>24-V))}function lt(C,V){var D=V&7,F=V>>>3;return(C[F]|(D<=6?0:C[F+1]<<8))>>>D&3}function He(C,V){var D=V&7,F=V>>>3;return(C[F]|(D<=5?0:C[F+1]<<8))>>>D&7}function st(C,V){var D=V&7,F=V>>>3;return(C[F]|(D<=4?0:C[F+1]<<8))>>>D&15}function Fe(C,V){var D=V&7,F=V>>>3;return(C[F]|(D<=3?0:C[F+1]<<8))>>>D&31}function Ae(C,V){var D=V&7,F=V>>>3;return(C[F]|(D<=1?0:C[F+1]<<8))>>>D&127}function Tt(C,V,D){var F=V&7,L=V>>>3,j=(1<<D)-1,Y=C[L]>>>F;return D<8-F||(Y|=C[L+1]<<8-F,D<16-F)||(Y|=C[L+2]<<16-F,D<24-F)||(Y|=C[L+3]<<24-F),Y&j}function lr(C,V,D){var F=V&7,L=V>>>3;return F<=5?C[L]|=(D&7)<<F:(C[L]|=D<<F&255,C[L+1]=(D&7)>>8-F),V+3}function Nr(C,V,D){var F=V&7,L=V>>>3;return D=(D&1)<<F,C[L]|=D,V+1}function nn(C,V,D){var F=V&7,L=V>>>3;return D<<=F,C[L]|=D&255,D>>>=8,C[L+1]=D,V+8}function Ls(C,V,D){var F=V&7,L=V>>>3;return D<<=F,C[L]|=D&255,D>>>=8,C[L+1]=D&255,C[L+2]=D>>>8,V+16}function sn(C,V){var D=C.length,F=2*D>V?2*D:V+5,L=0;if(D>=V)return C;if(Qe){var j=Y_(F);if(C.copy)C.copy(j);else for(;L<C.length;++L)j[L]=C[L];return j}else if(Te){var Y=new Uint8Array(F);if(Y.set)Y.set(C);else for(;L<D;++L)Y[L]=C[L];return Y}return C.length=F,C}function kt(C){for(var V=new Array(C),D=0;D<C;++D)V[D]=0;return V}function cr(C,V,D){var F=1,L=0,j=0,Y=0,re=0,te=C.length,Z=Te?new Uint16Array(32):kt(32);for(j=0;j<32;++j)Z[j]=0;for(j=te;j<D;++j)C[j]=0;te=C.length;var Q=Te?new Uint16Array(te):kt(te);for(j=0;j<te;++j)Z[L=C[j]]++,F<L&&(F=L),Q[j]=0;for(Z[0]=0,j=1;j<=F;++j)Z[j+16]=re=re+Z[j-1]<<1;for(j=0;j<te;++j)re=C[j],re!=0&&(Q[j]=Z[re+16]++);var fe=0;for(j=0;j<te;++j)if(fe=C[j],fe!=0)for(re=W(Q[j],F)>>F-fe,Y=(1<<F+4-fe)-1;Y>=0;--Y)V[re|Y<<fe]=fe&15|j<<4;return F}var xt=Te?new Uint16Array(512):kt(512),St=Te?new Uint16Array(32):kt(32);if(!Te){for(var dt=0;dt<512;++dt)xt[dt]=0;for(dt=0;dt<32;++dt)St[dt]=0}(function(){for(var C=[],V=0;V<32;V++)C.push(5);cr(C,St,32);var D=[];for(V=0;V<=143;V++)D.push(8);for(;V<=255;V++)D.push(9);for(;V<=279;V++)D.push(7);for(;V<=287;V++)D.push(8);cr(D,xt,288)})();var Dt=function(){for(var V=Te?new Uint8Array(32768):[],D=0,F=0;D<ge.length-1;++D)for(;F<ge[D+1];++F)V[F]=D;for(;F<32768;++F)V[F]=29;var L=Te?new Uint8Array(259):[];for(D=0,F=0;D<ie.length-1;++D)for(;F<ie[D+1];++F)L[F]=D;function j(re,te){for(var Z=0;Z<re.length;){var Q=Math.min(65535,re.length-Z),fe=Z+Q==re.length;for(te.write_shift(1,+fe),te.write_shift(2,Q),te.write_shift(2,~Q&65535);Q-- >0;)te[te.l++]=re[Z++]}return te.l}function Y(re,te){for(var Z=0,Q=0,fe=Te?new Uint16Array(32768):[];Q<re.length;){var we=Math.min(65535,re.length-Q);if(we<10){for(Z=lr(te,Z,+(Q+we==re.length)),Z&7&&(Z+=8-(Z&7)),te.l=Z/8|0,te.write_shift(2,we),te.write_shift(2,~we&65535);we-- >0;)te[te.l++]=re[Q++];Z=te.l*8;continue}Z=lr(te,Z,+(Q+we==re.length)+2);for(var Ce=0;we-- >0;){var ve=re[Q];Ce=(Ce<<5^ve)&32767;var Ee=-1,De=0;if((Ee=fe[Ce])&&(Ee|=Q&-32768,Ee>Q&&(Ee-=32768),Ee<Q))for(;re[Ee+De]==re[Q+De]&&De<250;)++De;if(De>2){ve=L[De],ve<=22?Z=nn(te,Z,ye[ve+1]>>1)-1:(nn(te,Z,3),Z+=5,nn(te,Z,ye[ve-23]>>5),Z+=3);var at=ve<8?0:ve-4>>2;at>0&&(Ls(te,Z,De-ie[ve]),Z+=at),ve=V[Q-Ee],Z=nn(te,Z,ye[ve]>>3),Z-=3;var Ke=ve<4?0:ve-2>>1;Ke>0&&(Ls(te,Z,Q-Ee-ge[ve]),Z+=Ke);for(var mt=0;mt<De;++mt)fe[Ce]=Q&32767,Ce=(Ce<<5^re[Q])&32767,++Q;we-=De-1}else ve<=143?ve=ve+48:Z=Nr(te,Z,1),Z=nn(te,Z,ye[ve]),fe[Ce]=Q&32767,++Q}Z=nn(te,Z,0)-1}return te.l=(Z+7)/8|0,te.l}return function(te,Z){return te.length<8?j(te,Z):Y(te,Z)}}();function je(C){var V=tr(50+Math.floor(C.length*1.1)),D=Dt(C,V);return V.slice(0,D)}var yt=Te?new Uint16Array(32768):kt(32768),Gt=Te?new Uint16Array(32768):kt(32768),ft=Te?new Uint16Array(128):kt(128),gn=1,js=1;function ho(C,V){var D=Fe(C,V)+257;V+=5;var F=Fe(C,V)+1;V+=5;var L=st(C,V)+4;V+=4;for(var j=0,Y=Te?new Uint8Array(19):kt(19),re=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],te=1,Z=Te?new Uint8Array(8):kt(8),Q=Te?new Uint8Array(8):kt(8),fe=Y.length,we=0;we<L;++we)Y[G[we]]=j=He(C,V),te<j&&(te=j),Z[j]++,V+=3;var Ce=0;for(Z[0]=0,we=1;we<=te;++we)Q[we]=Ce=Ce+Z[we-1]<<1;for(we=0;we<fe;++we)(Ce=Y[we])!=0&&(re[we]=Q[Ce]++);var ve=0;for(we=0;we<fe;++we)if(ve=Y[we],ve!=0){Ce=ye[re[we]]>>8-ve;for(var Ee=(1<<7-ve)-1;Ee>=0;--Ee)ft[Ce|Ee<<ve]=ve&7|we<<3}var De=[];for(te=1;De.length<D+F;)switch(Ce=ft[Ae(C,V)],V+=Ce&7,Ce>>>=3){case 16:for(j=3+lt(C,V),V+=2,Ce=De[De.length-1];j-- >0;)De.push(Ce);break;case 17:for(j=3+He(C,V),V+=3;j-- >0;)De.push(0);break;case 18:for(j=11+Ae(C,V),V+=7;j-- >0;)De.push(0);break;default:De.push(Ce),te<Ce&&(te=Ce);break}var at=De.slice(0,D),Ke=De.slice(D);for(we=D;we<286;++we)at[we]=0;for(we=F;we<30;++we)Ke[we]=0;return gn=cr(at,yt,286),js=cr(Ke,Gt,30),V}function Nl(C,V){if(C[0]==3&&!(C[1]&3))return[ui(V),2];for(var D=0,F=0,L=Y_(V||1<<18),j=0,Y=L.length>>>0,re=0,te=0;!(F&1);){if(F=He(C,D),D+=3,F>>>1)F>>1==1?(re=9,te=5):(D=ho(C,D),re=gn,te=js);else{D&7&&(D+=8-(D&7));var Z=C[D>>>3]|C[(D>>>3)+1]<<8;if(D+=32,Z>0)for(!V&&Y<j+Z&&(L=sn(L,j+Z),Y=L.length);Z-- >0;)L[j++]=C[D>>>3],D+=8;continue}for(;;){!V&&Y<j+32767&&(L=sn(L,j+32767),Y=L.length);var Q=Tt(C,D,re),fe=F>>>1==1?xt[Q]:yt[Q];if(D+=fe&15,fe>>>=4,!(fe>>>8&255))L[j++]=fe;else{if(fe==256)break;fe-=257;var we=fe<8?0:fe-4>>2;we>5&&(we=0);var Ce=j+ie[fe];we>0&&(Ce+=Tt(C,D,we),D+=we),Q=Tt(C,D,te),fe=F>>>1==1?St[Q]:Gt[Q],D+=fe&15,fe>>>=4;var ve=fe<4?0:fe-2>>1,Ee=ge[fe];for(ve>0&&(Ee+=Tt(C,D,ve),D+=ve),!V&&Y<Ce&&(L=sn(L,Ce+100),Y=L.length);j<Ce;)L[j]=L[j-Ee],++j}}}return V?[L,D+7>>>3]:[L.slice(0,j),D+7>>>3]}function Vs(C,V){var D=C.slice(C.l||0),F=Nl(D,V);return C.l+=F[1],F[0]}function hs(C,V){if(C)typeof console<"u"&&console.error(V);else throw new Error(V)}function wa(C,V){var D=C;yr(D,0);var F=[],L=[],j={FileIndex:F,FullPaths:L};v(j,{root:V.root});for(var Y=D.length-4;(D[Y]!=80||D[Y+1]!=75||D[Y+2]!=5||D[Y+3]!=6)&&Y>=0;)--Y;D.l=Y+4,D.l+=4;var re=D.read_shift(2);D.l+=6;var te=D.read_shift(4);for(D.l=te,Y=0;Y<re;++Y){D.l+=20;var Z=D.read_shift(4),Q=D.read_shift(4),fe=D.read_shift(2),we=D.read_shift(2),Ce=D.read_shift(2);D.l+=8;var ve=D.read_shift(4),Ee=o(D.slice(D.l+fe,D.l+fe+we));D.l+=fe+we+Ce;var De=D.l;D.l=ve+4,Gn(D,Z,Q,j,Ee),D.l=De}return j}function Gn(C,V,D,F,L){C.l+=2;var j=C.read_shift(2),Y=C.read_shift(2),re=i(C);if(j&8257)throw new Error("Unsupported ZIP encryption");for(var te=C.read_shift(4),Z=C.read_shift(4),Q=C.read_shift(4),fe=C.read_shift(2),we=C.read_shift(2),Ce="",ve=0;ve<fe;++ve)Ce+=String.fromCharCode(C[C.l++]);if(we){var Ee=o(C.slice(C.l,C.l+we));(Ee[21589]||{}).mt&&(re=Ee[21589].mt),((L||{})[21589]||{}).mt&&(re=L[21589].mt)}C.l+=we;var De=C.slice(C.l,C.l+Z);switch(Y){case 8:De=K(C,Q);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+Y)}var at=!1;j&8&&(te=C.read_shift(4),te==134695760&&(te=C.read_shift(4),at=!0),Z=C.read_shift(4),Q=C.read_shift(4)),Z!=V&&hs(at,"Bad compressed size: "+V+" != "+Z),Q!=D&&hs(at,"Bad uncompressed size: "+D+" != "+Q),J(F,Ce,De,{unsafe:!0,mt:re})}function Us(C,V){var D=V||{},F=[],L=[],j=tr(1),Y=D.compression?8:0,re=0,te=0,Z=0,Q=0,fe=0,we=C.FullPaths[0],Ce=we,ve=C.FileIndex[0],Ee=[],De=0;for(te=1;te<C.FullPaths.length;++te)if(Ce=C.FullPaths[te].slice(we.length),ve=C.FileIndex[te],!(!ve.size||!ve.content||Ce=="Sh33tJ5")){var at=Q,Ke=tr(Ce.length);for(Z=0;Z<Ce.length;++Z)Ke.write_shift(1,Ce.charCodeAt(Z)&127);Ke=Ke.slice(0,Ke.l),Ee[fe]=D6.buf(ve.content,0);var mt=ve.content;Y==8&&(mt=X(mt)),j=tr(30),j.write_shift(4,67324752),j.write_shift(2,20),j.write_shift(2,re),j.write_shift(2,Y),ve.mt?a(j,ve.mt):j.write_shift(4,0),j.write_shift(-4,Ee[fe]),j.write_shift(4,mt.length),j.write_shift(4,ve.content.length),j.write_shift(2,Ke.length),j.write_shift(2,0),Q+=j.length,F.push(j),Q+=Ke.length,F.push(Ke),Q+=mt.length,F.push(mt),j=tr(46),j.write_shift(4,33639248),j.write_shift(2,0),j.write_shift(2,20),j.write_shift(2,re),j.write_shift(2,Y),j.write_shift(4,0),j.write_shift(-4,Ee[fe]),j.write_shift(4,mt.length),j.write_shift(4,ve.content.length),j.write_shift(2,Ke.length),j.write_shift(2,0),j.write_shift(2,0),j.write_shift(2,0),j.write_shift(2,0),j.write_shift(4,0),j.write_shift(4,at),De+=j.l,L.push(j),De+=Ke.length,L.push(Ke),++fe}return j=tr(22),j.write_shift(4,101010256),j.write_shift(2,0),j.write_shift(2,0),j.write_shift(2,fe),j.write_shift(2,fe),j.write_shift(4,De),j.write_shift(4,Q),j.write_shift(2,0),Ma([Ma(F),Ma(L),j])}var ds={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function Rn(C,V){if(C.ctype)return C.ctype;var D=C.name||"",F=D.match(/\.([^\.]+)$/);return F&&ds[F[1]]||V&&(F=(D=V).match(/[\.\\]([^\.\\])+$/),F&&ds[F[1]])?ds[F[1]]:"application/octet-stream"}function mo(C){for(var V=X_(C),D=[],F=0;F<V.length;F+=76)D.push(V.slice(F,F+76));return D.join(`\r
`)+`\r
`}function Bs(C){var V=C.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(Z){var Q=Z.charCodeAt(0).toString(16).toUpperCase();return"="+(Q.length==1?"0"+Q:Q)});V=V.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),V.charAt(0)==`
`&&(V="=0D"+V.slice(1)),V=V.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var D=[],F=V.split(`\r
`),L=0;L<F.length;++L){var j=F[L];if(j.length==0){D.push("");continue}for(var Y=0;Y<j.length;){var re=76,te=j.slice(Y,Y+re);te.charAt(re-1)=="="?re--:te.charAt(re-2)=="="?re-=2:te.charAt(re-3)=="="&&(re-=3),te=j.slice(Y,Y+re),Y+=re,Y<j.length&&(te+="="),D.push(te)}}return D.join(`\r
`)}function zs(C){for(var V=[],D=0;D<C.length;++D){for(var F=C[D];D<=C.length&&F.charAt(F.length-1)=="=";)F=F.slice(0,F.length-1)+C[++D];V.push(F)}for(var L=0;L<V.length;++L)V[L]=V[L].replace(/[=][0-9A-Fa-f]{2}/g,function(j){return String.fromCharCode(parseInt(j.slice(1),16))});return rs(V.join(`\r
`))}function bn(C,V,D){for(var F="",L="",j="",Y,re=0;re<10;++re){var te=V[re];if(!te||te.match(/^\s*$/))break;var Z=te.match(/^(.*?):\s*([^\s].*)$/);if(Z)switch(Z[1].toLowerCase()){case"content-location":F=Z[2].trim();break;case"content-type":j=Z[2].trim();break;case"content-transfer-encoding":L=Z[2].trim();break}}switch(++re,L.toLowerCase()){case"base64":Y=rs(An(V.slice(re).join("")));break;case"quoted-printable":Y=zs(V.slice(re));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+L)}var Q=J(C,F.slice(D.length),Y,{unsafe:!0});j&&(Q.ctype=j)}function po(C,V){if(H(C.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var D=V&&V.root||"",F=(Qe&&Buffer.isBuffer(C)?C.toString("binary"):H(C)).split(`\r
`),L=0,j="";for(L=0;L<F.length;++L)if(j=F[L],!!/^Content-Location:/i.test(j)&&(j=j.slice(j.indexOf("file")),D||(D=j.slice(0,j.lastIndexOf("/")+1)),j.slice(0,D.length)!=D))for(;D.length>0&&(D=D.slice(0,D.length-1),D=D.slice(0,D.lastIndexOf("/")+1),j.slice(0,D.length)!=D););var Y=(F[1]||"").match(/boundary="(.*?)"/);if(!Y)throw new Error("MAD cannot find boundary");var re="--"+(Y[1]||""),te=[],Z=[],Q={FileIndex:te,FullPaths:Z};v(Q);var fe,we=0;for(L=0;L<F.length;++L){var Ce=F[L];Ce!==re&&Ce!==re+"--"||(we++&&bn(Q,F.slice(fe,L),D),fe=L)}return Q}function er(C,V){var D=V||{},F=D.boundary||"SheetJS";F="------="+F;for(var L=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+F.slice(2)+'"',"","",""],j=C.FullPaths[0],Y=j,re=C.FileIndex[0],te=1;te<C.FullPaths.length;++te)if(Y=C.FullPaths[te].slice(j.length),re=C.FileIndex[te],!(!re.size||!re.content||Y=="Sh33tJ5")){Y=Y.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(De){return"_x"+De.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(De){return"_u"+De.charCodeAt(0).toString(16)+"_"});for(var Z=re.content,Q=Qe&&Buffer.isBuffer(Z)?Z.toString("binary"):H(Z),fe=0,we=Math.min(1024,Q.length),Ce=0,ve=0;ve<=we;++ve)(Ce=Q.charCodeAt(ve))>=32&&Ce<128&&++fe;var Ee=fe>=we*4/5;L.push(F),L.push("Content-Location: "+(D.root||"file:///C:/SheetJS/")+Y),L.push("Content-Transfer-Encoding: "+(Ee?"quoted-printable":"base64")),L.push("Content-Type: "+Rn(re,Y)),L.push(""),L.push(Ee?Bs(Q):mo(Q))}return L.push(F+`--\r
`),L.join(`\r
`)}function q(C){var V={};return v(V,C),V}function J(C,V,D,F){var L=F&&F.unsafe;L||v(C);var j=!L&&rt.find(C,V);if(!j){var Y=C.FullPaths[0];V.slice(0,Y.length)==Y?Y=V:(Y.slice(-1)!="/"&&(Y+="/"),Y=(Y+V).replace("//","/")),j={name:s(V),type:2},C.FileIndex.push(j),C.FullPaths.push(Y),L||rt.utils.cfb_gc(C)}return j.content=D,j.size=D?D.length:0,F&&(F.CLSID&&(j.clsid=F.CLSID),F.mt&&(j.mt=F.mt),F.ct&&(j.ct=F.ct)),j}function ae(C,V){v(C);var D=rt.find(C,V);if(D){for(var F=0;F<C.FileIndex.length;++F)if(C.FileIndex[F]==D)return C.FileIndex.splice(F,1),C.FullPaths.splice(F,1),!0}return!1}function me(C,V,D){v(C);var F=rt.find(C,V);if(F){for(var L=0;L<C.FileIndex.length;++L)if(C.FileIndex[L]==F)return C.FileIndex[L].name=s(D),C.FullPaths[L]=D,!0}return!1}function Se(C){S(C,!0)}return t.find=b,t.read=O,t.parse=u,t.write=se,t.writeFile=ee,t.utils={cfb_new:q,cfb_add:J,cfb_del:ae,cfb_mov:me,cfb_gc:Se,ReadShift:kc,CheckField:MA,prep_blob:yr,bconcat:Ma,use_zlib:B,_deflateRaw:je,_inflateRaw:Vs,consts:pe},t}();function F6(e){if(typeof Deno<"u")return Deno.readFileSync(e);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var t=File(e);t.open("r"),t.encoding="binary";var r=t.read();return t.close(),r}catch(n){if(!n.message||!n.message.match(/onstruct/))throw n}throw new Error("Cannot access file "+e)}function bs(e){for(var t=Object.keys(e),r=[],n=0;n<t.length;++n)Object.prototype.hasOwnProperty.call(e,t[n])&&r.push(t[n]);return r}function Qv(e){for(var t=[],r=bs(e),n=0;n!==r.length;++n)t[e[r[n]]]=r[n];return t}var rd=new Date(1899,11,30,0,0,0);function en(e,t){var r=e.getTime(),n=rd.getTime()+(e.getTimezoneOffset()-rd.getTimezoneOffset())*6e4;return(r-n)/(24*60*60*1e3)}var pA=new Date,O6=rd.getTime()+(pA.getTimezoneOffset()-rd.getTimezoneOffset())*6e4,sw=pA.getTimezoneOffset();function n0(e){var t=new Date;return t.setTime(e*24*60*60*1e3+O6),t.getTimezoneOffset()!==sw&&t.setTime(t.getTime()+(t.getTimezoneOffset()-sw)*6e4),t}function M6(e){var t=0,r=0,n=!1,s=e.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!s)throw new Error("|"+e+"| is not an ISO8601 Duration");for(var a=1;a!=s.length;++a)if(s[a]){switch(r=1,a>3&&(n=!0),s[a].slice(s[a].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+s[a].slice(s[a].length-1));case"D":r*=24;case"H":r*=60;case"M":if(n)r*=60;else throw new Error("Unsupported ISO Duration Field: M")}t+=r*parseInt(s[a],10)}return t}var aw=new Date("2017-02-19T19:06:09.000Z"),gA=isNaN(aw.getFullYear())?new Date("2/19/17"):aw,L6=gA.getFullYear()==2017;function mr(e,t){var r=new Date(e);if(L6)return t>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):t<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(e instanceof Date)return e;if(gA.getFullYear()==1917&&!isNaN(r.getFullYear())){var n=r.getFullYear();return e.indexOf(""+n)>-1||r.setFullYear(r.getFullYear()+100),r}var s=e.match(/\d+/g)||["2017","2","19","0","0","0"],a=new Date(+s[0],+s[1]-1,+s[2],+s[3]||0,+s[4]||0,+s[5]||0);return e.indexOf("Z")>-1&&(a=new Date(a.getTime()-a.getTimezoneOffset()*60*1e3)),a}function Ji(e,t){if(Qe&&Buffer.isBuffer(e)){if(t){if(e[0]==255&&e[1]==254)return lc(e.slice(2).toString("utf16le"));if(e[1]==254&&e[2]==255)return lc(rA(e.slice(2).toString("binary")))}return e.toString("binary")}if(typeof TextDecoder<"u")try{if(t){if(e[0]==255&&e[1]==254)return lc(new TextDecoder("utf-16le").decode(e.slice(2)));if(e[0]==254&&e[1]==255)return lc(new TextDecoder("utf-16be").decode(e.slice(2)))}var r={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[]/g,function(a){return r[a]||a})}catch{}for(var n=[],s=0;s!=e.length;++s)n.push(String.fromCharCode(e[s]));return n.join("")}function Sr(e){if(typeof JSON<"u"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=Sr(e[r]));return t}function Ut(e,t){for(var r="";r.length<t;)r+=e;return r}function cs(e){var t=Number(e);if(!isNaN(t))return isFinite(t)?t:NaN;if(!/\d/.test(e))return t;var r=1,n=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(t=Number(n))||(n=n.replace(/[(](.*)[)]/,function(s,a){return r=-r,a}),!isNaN(t=Number(n)))?t/r:t}var j6=["january","february","march","april","may","june","july","august","september","october","november","december"];function gl(e){var t=new Date(e),r=new Date(NaN),n=t.getYear(),s=t.getMonth(),a=t.getDate();if(isNaN(a))return r;var i=e.toLowerCase();if(i.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(i=i.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),i.length>3&&j6.indexOf(i)==-1)return r}else if(i.match(/[a-z]/))return r;return n<0||n>8099?r:(s>0||a>1)&&n!=101?t:e.match(/[^-0-9:,\/\\]/)?r:t}var V6=function(){var e="abacaba".split(/(:?b)/i).length==5;return function(r,n,s){if(e||typeof n=="string")return r.split(n);for(var a=r.split(n),i=[a[0]],o=1;o<a.length;++o)i.push(s),i.push(a[o]);return i}}();function vA(e){return e?e.content&&e.type?Ji(e.content,!0):e.data?ac(e.data):e.asNodeBuffer&&Qe?ac(e.asNodeBuffer().toString("binary")):e.asBinary?ac(e.asBinary()):e._data&&e._data.getContent?ac(Ji(Array.prototype.slice.call(e._data.getContent(),0))):null:null}function xA(e){if(!e)return null;if(e.data)return K_(e.data);if(e.asNodeBuffer&&Qe)return e.asNodeBuffer();if(e._data&&e._data.getContent){var t=e._data.getContent();return typeof t=="string"?K_(t):Array.prototype.slice.call(t)}return e.content&&e.type?e.content:null}function U6(e){return e&&e.name.slice(-4)===".bin"?xA(e):vA(e)}function On(e,t){for(var r=e.FullPaths||bs(e.files),n=t.toLowerCase().replace(/[\/]/g,"\\"),s=n.replace(/\\/g,"/"),a=0;a<r.length;++a){var i=r[a].replace(/^Root Entry[\/]/,"").toLowerCase();if(n==i||s==i)return e.files?e.files[r[a]]:e.FileIndex[a]}return null}function Jv(e,t){var r=On(e,t);if(r==null)throw new Error("Cannot find file "+t+" in zip");return r}function Xt(e,t,r){if(!r)return U6(Jv(e,t));if(!t)return null;try{return Xt(e,t)}catch{return null}}function wn(e,t,r){if(!r)return vA(Jv(e,t));if(!t)return null;try{return wn(e,t)}catch{return null}}function B6(e,t,r){return xA(Jv(e,t))}function iw(e){for(var t=e.FullPaths||bs(e.files),r=[],n=0;n<t.length;++n)t[n].slice(-1)!="/"&&r.push(t[n].replace(/^Root Entry[\/]/,""));return r.sort()}function z6(e,t,r){if(e.FullPaths){if(typeof r=="string"){var n;return Qe?n=io(r):n=o6(r),rt.utils.cfb_add(e,t,n)}rt.utils.cfb_add(e,t,r)}else e.file(t,r)}function yA(e,t){switch(t.type){case"base64":return rt.read(e,{type:"base64"});case"binary":return rt.read(e,{type:"binary"});case"buffer":case"array":return rt.read(e,{type:"buffer"})}throw new Error("Unrecognized type "+t.type)}function oc(e,t){if(e.charAt(0)=="/")return e.slice(1);var r=t.split("/");t.slice(-1)!="/"&&r.pop();for(var n=e.split("/");n.length!==0;){var s=n.shift();s===".."?r.pop():s!=="."&&r.push(s)}return r.join("/")}var _A=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,$6=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,ow=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,W6=/<[^>]*>/g,Kr=_A.match(ow)?ow:W6,H6=/<\w*:/,G6=/<(\/?)\w+:/;function Oe(e,t,r){for(var n={},s=0,a=0;s!==e.length&&!((a=e.charCodeAt(s))===32||a===10||a===13);++s);if(t||(n[0]=e.slice(0,s)),s===e.length)return n;var i=e.match($6),o=0,l="",c=0,u="",d="",m=1;if(i)for(c=0;c!=i.length;++c){for(d=i[c],a=0;a!=d.length&&d.charCodeAt(a)!==61;++a);for(u=d.slice(0,a).trim();d.charCodeAt(a+1)==32;)++a;for(m=(s=d.charCodeAt(a+1))==34||s==39?1:0,l=d.slice(a+1+m,d.length-m),o=0;o!=u.length&&u.charCodeAt(o)!==58;++o);if(o===u.length)u.indexOf("_")>0&&(u=u.slice(0,u.indexOf("_"))),n[u]=l,n[u.toLowerCase()]=l;else{var p=(o===5&&u.slice(0,5)==="xmlns"?"xmlns":"")+u.slice(o+1);if(n[p]&&u.slice(o-3,o)=="ext")continue;n[p]=l,n[p.toLowerCase()]=l}}return n}function Os(e){return e.replace(G6,"<$1")}var wA={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},K6=Qv(wA),ot=function(){var e=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,t=/_x([\da-fA-F]{4})_/ig;return function r(n){var s=n+"",a=s.indexOf("<![CDATA[");if(a==-1)return s.replace(e,function(o,l){return wA[o]||String.fromCharCode(parseInt(l,o.indexOf("x")>-1?16:10))||o}).replace(t,function(o,l){return String.fromCharCode(parseInt(l,16))});var i=s.indexOf("]]>");return r(s.slice(0,a))+s.slice(a+9,i)+r(s.slice(i+3))}}(),q6=/[&<>'"]/g,X6=/[\u0000-\u001f]/g;function Zv(e){var t=e+"";return t.replace(q6,function(r){return K6[r]}).replace(/\n/g,"<br/>").replace(X6,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}var lw=function(){var e=/&#(\d+);/g;function t(r,n){return String.fromCharCode(parseInt(n,10))}return function(n){return n.replace(e,t)}}();function bt(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function em(e){for(var t="",r=0,n=0,s=0,a=0,i=0,o=0;r<e.length;){if(n=e.charCodeAt(r++),n<128){t+=String.fromCharCode(n);continue}if(s=e.charCodeAt(r++),n>191&&n<224){i=(n&31)<<6,i|=s&63,t+=String.fromCharCode(i);continue}if(a=e.charCodeAt(r++),n<240){t+=String.fromCharCode((n&15)<<12|(s&63)<<6|a&63);continue}i=e.charCodeAt(r++),o=((n&7)<<18|(s&63)<<12|(a&63)<<6|i&63)-65536,t+=String.fromCharCode(55296+(o>>>10&1023)),t+=String.fromCharCode(56320+(o&1023))}return t}function cw(e){var t=ui(2*e.length),r,n,s=1,a=0,i=0,o;for(n=0;n<e.length;n+=s)s=1,(o=e.charCodeAt(n))<128?r=o:o<224?(r=(o&31)*64+(e.charCodeAt(n+1)&63),s=2):o<240?(r=(o&15)*4096+(e.charCodeAt(n+1)&63)*64+(e.charCodeAt(n+2)&63),s=3):(s=4,r=(o&7)*262144+(e.charCodeAt(n+1)&63)*4096+(e.charCodeAt(n+2)&63)*64+(e.charCodeAt(n+3)&63),r-=65536,i=55296+(r>>>10&1023),r=56320+(r&1023)),i!==0&&(t[a++]=i&255,t[a++]=i>>>8,i=0),t[a++]=r%256,t[a++]=r>>>8;return t.slice(0,a).toString("ucs2")}function uw(e){return io(e,"binary").toString("utf8")}var Nf="foo bar baz",Et=Qe&&(uw(Nf)==em(Nf)&&uw||cw(Nf)==em(Nf)&&cw)||em,lc=Qe?function(e){return io(e,"utf8").toString("binary")}:function(e){for(var t=[],r=0,n=0,s=0;r<e.length;)switch(n=e.charCodeAt(r++),!0){case n<128:t.push(String.fromCharCode(n));break;case n<2048:t.push(String.fromCharCode(192+(n>>6))),t.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,s=e.charCodeAt(r++)-56320+(n<<10),t.push(String.fromCharCode(240+(s>>18&7))),t.push(String.fromCharCode(144+(s>>12&63))),t.push(String.fromCharCode(128+(s>>6&63))),t.push(String.fromCharCode(128+(s&63)));break;default:t.push(String.fromCharCode(224+(n>>12))),t.push(String.fromCharCode(128+(n>>6&63))),t.push(String.fromCharCode(128+(n&63)))}return t.join("")},uu=function(){var e={};return function(r,n){var s=r+"|"+(n||"");return e[s]?e[s]:e[s]=new RegExp("<(?:\\w+:)?"+r+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+r+">",n||"")}}(),EA=function(){var e=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(t){return[new RegExp("&"+t[0]+";","ig"),t[1]]});return function(r){for(var n=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),s=0;s<e.length;++s)n=n.replace(e[s][0],e[s][1]);return n}}(),Y6=function(){var e={};return function(r){return e[r]!==void 0?e[r]:e[r]=new RegExp("<(?:vt:)?"+r+">([\\s\\S]*?)</(?:vt:)?"+r+">","g")}}(),Q6=/<\/?(?:vt:)?variant>/g,J6=/<(?:vt:)([^>]*)>([\s\S]*)</;function fw(e,t){var r=Oe(e),n=e.match(Y6(r.baseType))||[],s=[];if(n.length!=r.size){if(t.WTF)throw new Error("unexpected vector length "+n.length+" != "+r.size);return s}return n.forEach(function(a){var i=a.replace(Q6,"").match(J6);i&&s.push({v:Et(i[2]),t:i[1]})}),s}var Z6=/(^\s|\s$|\n)/;function e8(e){return bs(e).map(function(t){return" "+t+'="'+e[t]+'"'}).join("")}function t8(e,t,r){return"<"+e+(r!=null?e8(r):"")+(t!=null?(t.match(Z6)?' xml:space="preserve"':"")+">"+t+"</"+e:"/")+">"}function ex(e){if(Qe&&Buffer.isBuffer(e))return e.toString("utf8");if(typeof e=="string")return e;if(typeof Uint8Array<"u"&&e instanceof Uint8Array)return Et(oo(qv(e)));throw new Error("Bad input format: expected Buffer or string")}var fu=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,r8={CT:"http://schemas.openxmlformats.org/package/2006/content-types"},n8=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"];function s8(e,t){for(var r=1-2*(e[t+7]>>>7),n=((e[t+7]&127)<<4)+(e[t+6]>>>4&15),s=e[t+6]&15,a=5;a>=0;--a)s=s*256+e[t+a];return n==2047?s==0?r*(1/0):NaN:(n==0?n=-1022:(n-=1023,s+=Math.pow(2,52)),r*Math.pow(2,n-52)*s)}function a8(e,t,r){var n=(t<0||1/t==-1/0?1:0)<<7,s=0,a=0,i=n?-t:t;isFinite(i)?i==0?s=a=0:(s=Math.floor(Math.log(i)/Math.LN2),a=i*Math.pow(2,52-s),s<=-1023&&(!isFinite(a)||a<Math.pow(2,52))?s=-1022:(a-=Math.pow(2,52),s+=1023)):(s=2047,a=isNaN(t)?26985:0);for(var o=0;o<=5;++o,a/=256)e[r+o]=a&255;e[r+6]=(s&15)<<4|a&15,e[r+7]=s>>4|n}var hw=function(e){for(var t=[],r=10240,n=0;n<e[0].length;++n)if(e[0][n])for(var s=0,a=e[0][n].length;s<a;s+=r)t.push.apply(t,e[0][n].slice(s,s+r));return t},dw=Qe?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(t){return Buffer.isBuffer(t)?t:io(t)})):hw(e)}:hw,mw=function(e,t,r){for(var n=[],s=t;s<r;s+=2)n.push(String.fromCharCode(Zs(e,s)));return n.join("").replace(Zr,"")},tx=Qe?function(e,t,r){return Buffer.isBuffer(e)?e.toString("utf16le",t,r).replace(Zr,""):mw(e,t,r)}:mw,pw=function(e,t,r){for(var n=[],s=t;s<t+r;++s)n.push(("0"+e[s].toString(16)).slice(-2));return n.join("")},TA=Qe?function(e,t,r){return Buffer.isBuffer(e)?e.toString("hex",t,t+r):pw(e,t,r)}:pw,gw=function(e,t,r){for(var n=[],s=t;s<r;s++)n.push(String.fromCharCode(So(e,s)));return n.join("")},Vu=Qe?function(t,r,n){return Buffer.isBuffer(t)?t.toString("utf8",r,n):gw(t,r,n)}:gw,kA=function(e,t){var r=_n(e,t);return r>0?Vu(e,t+4,t+4+r-1):""},SA=kA,AA=function(e,t){var r=_n(e,t);return r>0?Vu(e,t+4,t+4+r-1):""},IA=AA,CA=function(e,t){var r=2*_n(e,t);return r>0?Vu(e,t+4,t+4+r-1):""},NA=CA,RA=function(t,r){var n=_n(t,r);return n>0?tx(t,r+4,r+4+n):""},bA=RA,PA=function(e,t){var r=_n(e,t);return r>0?Vu(e,t+4,t+4+r):""},DA=PA,FA=function(e,t){return s8(e,t)},nd=FA,OA=function(t){return Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array};Qe&&(SA=function(t,r){if(!Buffer.isBuffer(t))return kA(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},IA=function(t,r){if(!Buffer.isBuffer(t))return AA(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},NA=function(t,r){if(!Buffer.isBuffer(t))return CA(t,r);var n=2*t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n-1)},bA=function(t,r){if(!Buffer.isBuffer(t))return RA(t,r);var n=t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n)},DA=function(t,r){if(!Buffer.isBuffer(t))return PA(t,r);var n=t.readUInt32LE(r);return t.toString("utf8",r+4,r+4+n)},nd=function(t,r){return Buffer.isBuffer(t)?t.readDoubleLE(r):FA(t,r)},OA=function(t){return Buffer.isBuffer(t)||Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array});var So=function(e,t){return e[t]},Zs=function(e,t){return e[t+1]*256+e[t]},i8=function(e,t){var r=e[t+1]*256+e[t];return r<32768?r:(65535-r+1)*-1},_n=function(e,t){return e[t+3]*(1<<24)+(e[t+2]<<16)+(e[t+1]<<8)+e[t]},Ai=function(e,t){return e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]},o8=function(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]};function kc(e,t){var r="",n,s,a=[],i,o,l,c;switch(t){case"dbcs":if(c=this.l,Qe&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*e).toString("utf16le");else for(l=0;l<e;++l)r+=String.fromCharCode(Zs(this,c)),c+=2;e*=2;break;case"utf8":r=Vu(this,this.l,this.l+e);break;case"utf16le":e*=2,r=tx(this,this.l,this.l+e);break;case"wstr":return kc.call(this,e,"dbcs");case"lpstr-ansi":r=SA(this,this.l),e=4+_n(this,this.l);break;case"lpstr-cp":r=IA(this,this.l),e=4+_n(this,this.l);break;case"lpwstr":r=NA(this,this.l),e=4+2*_n(this,this.l);break;case"lpp4":e=4+_n(this,this.l),r=bA(this,this.l),e&2&&(e+=2);break;case"8lpp4":e=4+_n(this,this.l),r=DA(this,this.l),e&3&&(e+=4-(e&3));break;case"cstr":for(e=0,r="";(i=So(this,this.l+e++))!==0;)a.push(Cf(i));r=a.join("");break;case"_wstr":for(e=0,r="";(i=Zs(this,this.l+e))!==0;)a.push(Cf(i)),e+=2;e+=2,r=a.join("");break;case"dbcs-cont":for(r="",c=this.l,l=0;l<e;++l){if(this.lens&&this.lens.indexOf(c)!==-1)return i=So(this,c),this.l=c+1,o=kc.call(this,e-l,i?"dbcs-cont":"sbcs-cont"),a.join("")+o;a.push(Cf(Zs(this,c))),c+=2}r=a.join(""),e*=2;break;case"cpstr":case"sbcs-cont":for(r="",c=this.l,l=0;l!=e;++l){if(this.lens&&this.lens.indexOf(c)!==-1)return i=So(this,c),this.l=c+1,o=kc.call(this,e-l,i?"dbcs-cont":"sbcs-cont"),a.join("")+o;a.push(Cf(So(this,c))),c+=1}r=a.join("");break;default:switch(e){case 1:return n=So(this,this.l),this.l++,n;case 2:return n=(t==="i"?i8:Zs)(this,this.l),this.l+=2,n;case 4:case-4:return t==="i"||!(this[this.l+3]&128)?(n=(e>0?Ai:o8)(this,this.l),this.l+=4,n):(s=_n(this,this.l),this.l+=4,s);case 8:case-8:if(t==="f")return e==8?s=nd(this,this.l):s=nd([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,s;e=8;case 16:r=TA(this,this.l,e);break}}return this.l+=e,r}var l8=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24&255},c8=function(e,t,r){e[r]=t&255,e[r+1]=t>>8&255,e[r+2]=t>>16&255,e[r+3]=t>>24&255},u8=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255};function f8(e,t,r){var n=0,s=0;if(r==="dbcs"){for(s=0;s!=t.length;++s)u8(this,t.charCodeAt(s),this.l+2*s);n=2*t.length}else if(r==="sbcs"){for(t=t.replace(/[^\x00-\x7F]/g,"_"),s=0;s!=t.length;++s)this[this.l+s]=t.charCodeAt(s)&255;n=t.length}else if(r==="hex"){for(;s<e;++s)this[this.l++]=parseInt(t.slice(2*s,2*s+2),16)||0;return this}else if(r==="utf16le"){var a=Math.min(this.l+e,this.length);for(s=0;s<Math.min(t.length,e);++s){var i=t.charCodeAt(s);this[this.l++]=i&255,this[this.l++]=i>>8}for(;this.l<a;)this[this.l++]=0;return this}else switch(e){case 1:n=1,this[this.l]=t&255;break;case 2:n=2,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255;break;case 3:n=3,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255,t>>>=8,this[this.l+2]=t&255;break;case 4:n=4,l8(this,t,this.l);break;case 8:if(n=8,r==="f"){a8(this,t,this.l);break}case 16:break;case-4:n=4,c8(this,t,this.l);break}return this.l+=n,this}function MA(e,t){var r=TA(this,this.l,e.length>>1);if(r!==e)throw new Error(t+"Expected "+e+" saw "+r);this.l+=e.length>>1}function yr(e,t){e.l=t,e.read_shift=kc,e.chk=MA,e.write_shift=f8}function Gr(e,t){e.l+=t}function tr(e){var t=ui(e);return yr(t,0),t}function _a(e,t,r){if(e){var n,s,a;yr(e,e.l||0);for(var i=e.length,o=0,l=0;e.l<i;){o=e.read_shift(1),o&128&&(o=(o&127)+((e.read_shift(1)&127)<<7));var c=cd[o]||cd[65535];for(n=e.read_shift(1),a=n&127,s=1;s<4&&n&128;++s)a+=((n=e.read_shift(1))&127)<<7*s;l=e.l+a;var u=c.f&&c.f(e,a,r);if(e.l=l,t(u,c,o))return}}}function Fp(){var e=[],t=Qe?256:2048,r=function(c){var u=tr(c);return yr(u,0),u},n=r(t),s=function(){n&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&e.push(n),n=null)},a=function(c){return n&&c<n.length-n.l?n:(s(),n=r(Math.max(c+1,t)))},i=function(){return s(),Ma(e)},o=function(c){s(),n=c,n.l==null&&(n.l=n.length),a(t)};return{next:a,push:o,end:i,_bufs:e}}function Sc(e,t,r){var n=Sr(e);if(t.s?(n.cRel&&(n.c+=t.s.c),n.rRel&&(n.r+=t.s.r)):(n.cRel&&(n.c+=t.c),n.rRel&&(n.r+=t.r)),!r||r.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function vw(e,t,r){var n=Sr(e);return n.s=Sc(n.s,t.s,r),n.e=Sc(n.e,t.s,r),n}function Ac(e,t){if(e.cRel&&e.c<0)for(e=Sr(e);e.c<0;)e.c+=t>8?16384:256;if(e.rRel&&e.r<0)for(e=Sr(e);e.r<0;)e.r+=t>8?1048576:t>5?65536:16384;var r=Ue(e);return!e.cRel&&e.cRel!=null&&(r=m8(r)),!e.rRel&&e.rRel!=null&&(r=h8(r)),r}function tm(e,t){return e.s.r==0&&!e.s.rRel&&e.e.r==(t.biff>=12?1048575:t.biff>=8?65536:16384)&&!e.e.rRel?(e.s.cRel?"":"$")+sr(e.s.c)+":"+(e.e.cRel?"":"$")+sr(e.e.c):e.s.c==0&&!e.s.cRel&&e.e.c==(t.biff>=12?16383:255)&&!e.e.cRel?(e.s.rRel?"":"$")+Ar(e.s.r)+":"+(e.e.rRel?"":"$")+Ar(e.e.r):Ac(e.s,t.biff)+":"+Ac(e.e,t.biff)}function rx(e){return parseInt(d8(e),10)-1}function Ar(e){return""+(e+1)}function h8(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function d8(e){return e.replace(/\$(\d+)$/,"$1")}function nx(e){for(var t=p8(e),r=0,n=0;n!==t.length;++n)r=26*r+t.charCodeAt(n)-64;return r-1}function sr(e){if(e<0)throw new Error("invalid column "+e);var t="";for(++e;e;e=Math.floor((e-1)/26))t=String.fromCharCode((e-1)%26+65)+t;return t}function m8(e){return e.replace(/^([A-Z])/,"$$$1")}function p8(e){return e.replace(/^\$([A-Z])/,"$1")}function g8(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function Qr(e){for(var t=0,r=0,n=0;n<e.length;++n){var s=e.charCodeAt(n);s>=48&&s<=57?t=10*t+(s-48):s>=65&&s<=90&&(r=26*r+(s-64))}return{c:r-1,r:t-1}}function Ue(e){for(var t=e.c+1,r="";t;t=(t-1)/26|0)r=String.fromCharCode((t-1)%26+65)+r;return r+(e.r+1)}function Il(e){var t=e.indexOf(":");return t==-1?{s:Qr(e),e:Qr(e)}:{s:Qr(e.slice(0,t)),e:Qr(e.slice(t+1))}}function nt(e,t){return typeof t>"u"||typeof t=="number"?nt(e.s,e.e):(typeof e!="string"&&(e=Ue(e)),typeof t!="string"&&(t=Ue(t)),e==t?e:e+":"+t)}function Bt(e){var t={s:{c:0,r:0},e:{c:0,r:0}},r=0,n=0,s=0,a=e.length;for(r=0;n<a&&!((s=e.charCodeAt(n)-64)<1||s>26);++n)r=26*r+s;for(t.s.c=--r,r=0;n<a&&!((s=e.charCodeAt(n)-48)<0||s>9);++n)r=10*r+s;if(t.s.r=--r,n===a||s!=10)return t.e.c=t.s.c,t.e.r=t.s.r,t;for(++n,r=0;n!=a&&!((s=e.charCodeAt(n)-64)<1||s>26);++n)r=26*r+s;for(t.e.c=--r,r=0;n!=a&&!((s=e.charCodeAt(n)-48)<0||s>9);++n)r=10*r+s;return t.e.r=--r,t}function xw(e,t){var r=e.t=="d"&&t instanceof Date;if(e.z!=null)try{return e.w=Wn(e.z,r?en(t):t)}catch{}try{return e.w=Wn((e.XF||{}).numFmtId||(r?14:0),r?en(t):t)}catch{return""+t}}function ga(e,t,r){return e==null||e.t==null||e.t=="z"?"":e.w!==void 0?e.w:(e.t=="d"&&!e.z&&r&&r.dateNF&&(e.z=r.dateNF),e.t=="e"?uo[e.v]||e.v:t==null?xw(e,e.v):xw(e,t))}function xi(e,t){var r=t&&t.sheet?t.sheet:"Sheet1",n={};return n[r]=e,{SheetNames:[r],Sheets:n}}function LA(e,t,r){var n=r||{},s=e?Array.isArray(e):n.dense,a=e||(s?[]:{}),i=0,o=0;if(a&&n.origin!=null){if(typeof n.origin=="number")i=n.origin;else{var l=typeof n.origin=="string"?Qr(n.origin):n.origin;i=l.r,o=l.c}a["!ref"]||(a["!ref"]="A1:A1")}var c={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(a["!ref"]){var u=Bt(a["!ref"]);c.s.c=u.s.c,c.s.r=u.s.r,c.e.c=Math.max(c.e.c,u.e.c),c.e.r=Math.max(c.e.r,u.e.r),i==-1&&(c.e.r=i=u.e.r+1)}for(var d=0;d!=t.length;++d)if(t[d]){if(!Array.isArray(t[d]))throw new Error("aoa_to_sheet expects an array of arrays");for(var m=0;m!=t[d].length;++m)if(!(typeof t[d][m]>"u")){var p={v:t[d][m]},g=i+d,x=o+m;if(c.s.r>g&&(c.s.r=g),c.s.c>x&&(c.s.c=x),c.e.r<g&&(c.e.r=g),c.e.c<x&&(c.e.c=x),t[d][m]&&typeof t[d][m]=="object"&&!Array.isArray(t[d][m])&&!(t[d][m]instanceof Date))p=t[d][m];else if(Array.isArray(p.v)&&(p.f=t[d][m][1],p.v=p.v[0]),p.v===null)if(p.f)p.t="n";else if(n.nullError)p.t="e",p.v=0;else if(n.sheetStubs)p.t="z";else continue;else typeof p.v=="number"?p.t="n":typeof p.v=="boolean"?p.t="b":p.v instanceof Date?(p.z=n.dateNF||ze[14],n.cellDates?(p.t="d",p.w=Wn(p.z,en(p.v))):(p.t="n",p.v=en(p.v),p.w=Wn(p.z,p.v))):p.t="s";if(s)a[g]||(a[g]=[]),a[g][x]&&a[g][x].z&&(p.z=a[g][x].z),a[g][x]=p;else{var w=Ue({c:x,r:g});a[w]&&a[w].z&&(p.z=a[w].z),a[w]=p}}}return c.s.c<1e7&&(a["!ref"]=nt(c)),a}function Cl(e,t){return LA(null,e,t)}function v8(e){return e.read_shift(4,"i")}function $r(e){var t=e.read_shift(4);return t===0?"":e.read_shift(t,"dbcs")}function x8(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function sx(e,t){var r=e.l,n=e.read_shift(1),s=$r(e),a=[],i={t:s,h:s};if(n&1){for(var o=e.read_shift(4),l=0;l!=o;++l)a.push(x8(e));i.r=a}else i.r=[{ich:0,ifnt:0}];return e.l=r+t,i}var y8=sx;function Hn(e){var t=e.read_shift(4),r=e.read_shift(2);return r+=e.read_shift(1)<<16,e.l++,{c:t,iStyleRef:r}}function lo(e){var t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:t}}var _8=$r;function ax(e){var t=e.read_shift(4);return t===0||t===4294967295?"":e.read_shift(t,"dbcs")}var w8=$r,Op=ax;function ix(e){var t=e.slice(e.l,e.l+4),r=t[0]&1,n=t[0]&2;e.l+=4;var s=n===0?nd([0,0,0,0,t[0]&252,t[1],t[2],t[3]],0):Ai(t,0)>>2;return r?s/100:s}function jA(e){var t={s:{},e:{}};return t.s.r=e.read_shift(4),t.e.r=e.read_shift(4),t.s.c=e.read_shift(4),t.e.c=e.read_shift(4),t}var co=jA;function Ur(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function E8(e){var t={},r=e.read_shift(1),n=r>>>1,s=e.read_shift(1),a=e.read_shift(2,"i"),i=e.read_shift(1),o=e.read_shift(1),l=e.read_shift(1);switch(e.l++,n){case 0:t.auto=1;break;case 1:t.index=s;var c=Vi[s];c&&(t.rgb=du(c));break;case 2:t.rgb=du([i,o,l]);break;case 3:t.theme=s;break}return a!=0&&(t.tint=a>0?a/32767:a/32768),t}function T8(e){var t=e.read_shift(1);e.l++;var r={fBold:t&1,fItalic:t&2,fUnderline:t&4,fStrikeout:t&8,fOutline:t&16,fShadow:t&32,fCondense:t&64,fExtend:t&128};return r}function VA(e,t){var r={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},n=e.read_shift(4);switch(n){case 0:return"";case 4294967295:case 4294967294:return r[e.read_shift(4)]||""}if(n>400)throw new Error("Unsupported Clipboard: "+n.toString(16));return e.l-=4,e.read_shift(0,t==1?"lpstr":"lpwstr")}function k8(e){return VA(e,1)}function S8(e){return VA(e,2)}var ox=2,ln=3,Rf=11,yw=12,sd=19,bf=64,A8=65,I8=71,C8=4108,N8=4126,fr=80,UA=81,R8=[fr,UA],b8={1:{n:"CodePage",t:ox},2:{n:"Category",t:fr},3:{n:"PresentationFormat",t:fr},4:{n:"ByteCount",t:ln},5:{n:"LineCount",t:ln},6:{n:"ParagraphCount",t:ln},7:{n:"SlideCount",t:ln},8:{n:"NoteCount",t:ln},9:{n:"HiddenCount",t:ln},10:{n:"MultimediaClipCount",t:ln},11:{n:"ScaleCrop",t:Rf},12:{n:"HeadingPairs",t:C8},13:{n:"TitlesOfParts",t:N8},14:{n:"Manager",t:fr},15:{n:"Company",t:fr},16:{n:"LinksUpToDate",t:Rf},17:{n:"CharacterCount",t:ln},19:{n:"SharedDoc",t:Rf},22:{n:"HyperlinksChanged",t:Rf},23:{n:"AppVersion",t:ln,p:"version"},24:{n:"DigSig",t:A8},26:{n:"ContentType",t:fr},27:{n:"ContentStatus",t:fr},28:{n:"Language",t:fr},29:{n:"Version",t:fr},255:{},2147483648:{n:"Locale",t:sd},2147483651:{n:"Behavior",t:sd},1919054434:{}},P8={1:{n:"CodePage",t:ox},2:{n:"Title",t:fr},3:{n:"Subject",t:fr},4:{n:"Author",t:fr},5:{n:"Keywords",t:fr},6:{n:"Comments",t:fr},7:{n:"Template",t:fr},8:{n:"LastAuthor",t:fr},9:{n:"RevNumber",t:fr},10:{n:"EditTime",t:bf},11:{n:"LastPrinted",t:bf},12:{n:"CreatedDate",t:bf},13:{n:"ModifiedDate",t:bf},14:{n:"PageCount",t:ln},15:{n:"WordCount",t:ln},16:{n:"CharCount",t:ln},17:{n:"Thumbnail",t:I8},18:{n:"Application",t:fr},19:{n:"DocSecurity",t:ln},255:{},2147483648:{n:"Locale",t:sd},2147483651:{n:"Behavior",t:sd},1919054434:{}},_w={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},D8=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function F8(e){return e.map(function(t){return[t>>16&255,t>>8&255,t&255]})}var O8=F8([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Vi=Sr(O8),uo={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},BA={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},ww={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"};function M8(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function L8(e){var t=M8();if(!e||!e.match)return t;var r={};if((e.match(Kr)||[]).forEach(function(n){var s=Oe(n);switch(s[0].replace(H6,"<")){case"<?xml":break;case"<Types":t.xmlns=s["xmlns"+(s[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":r[s.Extension]=s.ContentType;break;case"<Override":t[ww[s.ContentType]]!==void 0&&t[ww[s.ContentType]].push(s.PartName);break}}),t.xmlns!==r8.CT)throw new Error("Unknown Namespace: "+t.xmlns);return t.calcchain=t.calcchains.length>0?t.calcchains[0]:"",t.sst=t.strs.length>0?t.strs[0]:"",t.style=t.styles.length>0?t.styles[0]:"",t.defaults=r,delete t.calcchains,t}var jo={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function Mp(e){var t=e.lastIndexOf("/");return e.slice(0,t+1)+"_rels/"+e.slice(t+1)+".rels"}function Ic(e,t){var r={"!id":{}};if(!e)return r;t.charAt(0)!=="/"&&(t="/"+t);var n={};return(e.match(Kr)||[]).forEach(function(s){var a=Oe(s);if(a[0]==="<Relationship"){var i={};i.Type=a.Type,i.Target=a.Target,i.Id=a.Id,a.TargetMode&&(i.TargetMode=a.TargetMode);var o=a.TargetMode==="External"?a.Target:oc(a.Target,t);r[o]=i,n[a.Id]=i}}),r["!id"]=n,r}var j8="application/vnd.oasis.opendocument.spreadsheet";function V8(e,t){for(var r=ex(e),n,s;n=fu.exec(r);)switch(n[3]){case"manifest":break;case"file-entry":if(s=Oe(n[0],!1),s.path=="/"&&s.type!==j8)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(t&&t.WTF)throw n}}var Cc=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],U8=function(){for(var e=new Array(Cc.length),t=0;t<Cc.length;++t){var r=Cc[t],n="(?:"+r[0].slice(0,r[0].indexOf(":"))+":)"+r[0].slice(r[0].indexOf(":")+1);e[t]=new RegExp("<"+n+"[^>]*>([\\s\\S]*?)</"+n+">")}return e}();function zA(e){var t={};e=Et(e);for(var r=0;r<Cc.length;++r){var n=Cc[r],s=e.match(U8[r]);s!=null&&s.length>0&&(t[n[1]]=ot(s[1])),n[2]==="date"&&t[n[1]]&&(t[n[1]]=mr(t[n[1]]))}return t}var B8=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]];function $A(e,t,r,n){var s=[];if(typeof e=="string")s=fw(e,n);else for(var a=0;a<e.length;++a)s=s.concat(e[a].map(function(u){return{v:u}}));var i=typeof t=="string"?fw(t,n).map(function(u){return u.v}):t,o=0,l=0;if(i.length>0)for(var c=0;c!==s.length;c+=2){switch(l=+s[c+1].v,s[c].v){case"Worksheets":case"":case"":case" ":case"":case" ":case"Arbeitsbltter":case"alma Sayfalar":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de clculo":case"Planilhas":case"Regneark":case"Hojas de clculo":case"Werkbladen":r.Worksheets=l,r.SheetNames=i.slice(o,o+l);break;case"Named Ranges":case"Rangos con nombre":case"":case"Benannte Bereiche":case"Navngivne omrder":r.NamedRanges=l,r.DefinedNames=i.slice(o,o+l);break;case"Charts":case"Diagramme":r.Chartsheets=l,r.ChartNames=i.slice(o,o+l);break}o+=l}}function z8(e,t,r){var n={};return t||(t={}),e=Et(e),B8.forEach(function(s){var a=(e.match(uu(s[0]))||[])[1];switch(s[2]){case"string":a&&(t[s[1]]=ot(a));break;case"bool":t[s[1]]=a==="true";break;case"raw":var i=e.match(new RegExp("<"+s[0]+"[^>]*>([\\s\\S]*?)</"+s[0]+">"));i&&i.length>0&&(n[s[1]]=i[1]);break}}),n.HeadingPairs&&n.TitlesOfParts&&$A(n.HeadingPairs,n.TitlesOfParts,t,r),t}var $8=/<[^>]+>[^<]*/g;function W8(e,t){var r={},n="",s=e.match($8);if(s)for(var a=0;a!=s.length;++a){var i=s[a],o=Oe(i);switch(o[0]){case"<?xml":break;case"<Properties":break;case"<property":n=ot(o.name);break;case"</property>":n=null;break;default:if(i.indexOf("<vt:")===0){var l=i.split(">"),c=l[0].slice(4),u=l[1];switch(c){case"lpstr":case"bstr":case"lpwstr":r[n]=ot(u);break;case"bool":r[n]=bt(u);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":r[n]=parseInt(u,10);break;case"r4":case"r8":case"decimal":r[n]=parseFloat(u);break;case"filetime":case"date":r[n]=mr(u);break;case"cy":case"error":r[n]=ot(u);break;default:if(c.slice(-1)=="/")break;t.WTF&&typeof console<"u"&&console.warn("Unexpected",i,c,l)}}else if(i.slice(0,2)!=="</"){if(t.WTF)throw new Error(i)}}}return r}var H8={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},rm;function G8(e,t,r){rm||(rm=Qv(H8)),t=rm[t]||t,e[t]=r}function lx(e){var t=e.read_shift(4),r=e.read_shift(4);return new Date((r/1e7*Math.pow(2,32)+t/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function WA(e,t,r){var n=e.l,s=e.read_shift(0,"lpstr-cp");if(r)for(;e.l-n&3;)++e.l;return s}function HA(e,t,r){var n=e.read_shift(0,"lpwstr");return n}function GA(e,t,r){return t===31?HA(e):WA(e,t,r)}function Lp(e,t,r){return GA(e,t,r===!1?0:4)}function K8(e,t){if(!t)throw new Error("VtUnalignedString must have positive length");return GA(e,t,0)}function q8(e){for(var t=e.read_shift(4),r=[],n=0;n!=t;++n){var s=e.l;r[n]=e.read_shift(0,"lpwstr").replace(Zr,""),e.l-s&2&&(e.l+=2)}return r}function X8(e){for(var t=e.read_shift(4),r=[],n=0;n!=t;++n)r[n]=e.read_shift(0,"lpstr-cp").replace(Zr,"");return r}function Y8(e){var t=e.l,r=ad(e,UA);e[e.l]==0&&e[e.l+1]==0&&e.l-t&2&&(e.l+=2);var n=ad(e,ln);return[r,n]}function Q8(e){for(var t=e.read_shift(4),r=[],n=0;n<t/2;++n)r.push(Y8(e));return r}function Ew(e,t){for(var r=e.read_shift(4),n={},s=0;s!=r;++s){var a=e.read_shift(4),i=e.read_shift(4);n[a]=e.read_shift(i,t===1200?"utf16le":"utf8").replace(Zr,"").replace(ic,"!"),t===1200&&i%2&&(e.l+=2)}return e.l&3&&(e.l=e.l>>3<<2),n}function KA(e){var t=e.read_shift(4),r=e.slice(e.l,e.l+t);return e.l+=t,(t&3)>0&&(e.l+=4-(t&3)&3),r}function J8(e){var t={};return t.Size=e.read_shift(4),e.l+=t.Size+3-(t.Size-1)%4,t}function ad(e,t,r){var n=e.read_shift(2),s,a=r||{};if(e.l+=2,t!==yw&&n!==t&&R8.indexOf(t)===-1&&!((t&65534)==4126&&(n&65534)==4126))throw new Error("Expected type "+t+" saw "+n);switch(t===yw?n:t){case 2:return s=e.read_shift(2,"i"),a.raw||(e.l+=2),s;case 3:return s=e.read_shift(4,"i"),s;case 11:return e.read_shift(4)!==0;case 19:return s=e.read_shift(4),s;case 30:return WA(e,n,4).replace(Zr,"");case 31:return HA(e);case 64:return lx(e);case 65:return KA(e);case 71:return J8(e);case 80:return Lp(e,n,!a.raw).replace(Zr,"");case 81:return K8(e,n).replace(Zr,"");case 4108:return Q8(e);case 4126:case 4127:return n==4127?q8(e):X8(e);default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+n)}}function Tw(e,t){var r=e.l,n=e.read_shift(4),s=e.read_shift(4),a=[],i=0,o=0,l=-1,c={};for(i=0;i!=s;++i){var u=e.read_shift(4),d=e.read_shift(4);a[i]=[u,d+r]}a.sort(function(T,E){return T[1]-E[1]});var m={};for(i=0;i!=s;++i){if(e.l!==a[i][1]){var p=!0;if(i>0&&t)switch(t[a[i-1][0]].t){case 2:e.l+2===a[i][1]&&(e.l+=2,p=!1);break;case 80:e.l<=a[i][1]&&(e.l=a[i][1],p=!1);break;case 4108:e.l<=a[i][1]&&(e.l=a[i][1],p=!1);break}if((!t||i==0)&&e.l<=a[i][1]&&(p=!1,e.l=a[i][1]),p)throw new Error("Read Error: Expected address "+a[i][1]+" at "+e.l+" :"+i)}if(t){var g=t[a[i][0]];if(m[g.n]=ad(e,g.t,{raw:!0}),g.p==="version"&&(m[g.n]=String(m[g.n]>>16)+"."+("0000"+String(m[g.n]&65535)).slice(-4)),g.n=="CodePage")switch(m[g.n]){case 0:m[g.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:ss(o=m[g.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+m[g.n])}}else if(a[i][0]===1){if(o=m.CodePage=ad(e,ox),ss(o),l!==-1){var x=e.l;e.l=a[l][1],c=Ew(e,o),e.l=x}}else if(a[i][0]===0){if(o===0){l=i,e.l=a[i+1][1];continue}c=Ew(e,o)}else{var w=c[a[i][0]],k;switch(e[e.l]){case 65:e.l+=4,k=KA(e);break;case 30:e.l+=4,k=Lp(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 31:e.l+=4,k=Lp(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 3:e.l+=4,k=e.read_shift(4,"i");break;case 19:e.l+=4,k=e.read_shift(4);break;case 5:e.l+=4,k=e.read_shift(8,"f");break;case 11:e.l+=4,k=zt(e,4);break;case 64:e.l+=4,k=mr(lx(e));break;default:throw new Error("unparsed value: "+e[e.l])}m[w]=k}}return e.l=r+n,m}function kw(e,t,r){var n=e.content;if(!n)return{};yr(n,0);var s,a,i,o,l=0;n.chk("feff","Byte Order: "),n.read_shift(2);var c=n.read_shift(4),u=n.read_shift(16);if(u!==rt.utils.consts.HEADER_CLSID&&u!==r)throw new Error("Bad PropertySet CLSID "+u);if(s=n.read_shift(4),s!==1&&s!==2)throw new Error("Unrecognized #Sets: "+s);if(a=n.read_shift(16),o=n.read_shift(4),s===1&&o!==n.l)throw new Error("Length mismatch: "+o+" !== "+n.l);s===2&&(i=n.read_shift(16),l=n.read_shift(4));var d=Tw(n,t),m={SystemIdentifier:c};for(var p in d)m[p]=d[p];if(m.FMTID=a,s===1)return m;if(l-n.l==2&&(n.l+=2),n.l!==l)throw new Error("Length mismatch 2: "+n.l+" !== "+l);var g;try{g=Tw(n,null)}catch{}for(p in g)m[p]=g[p];return m.FMTID=[a,i],m}function Ia(e,t){return e.read_shift(t),null}function Z8(e,t,r){for(var n=[],s=e.l+t;e.l<s;)n.push(r(e,s-e.l));if(s!==e.l)throw new Error("Slurp error");return n}function zt(e,t){return e.read_shift(t)===1}function Yt(e){return e.read_shift(2,"u")}function qA(e,t){return Z8(e,t,Yt)}function e5(e){var t=e.read_shift(1),r=e.read_shift(1);return r===1?t:t===1}function Uu(e,t,r){var n=e.read_shift(r&&r.biff>=12?2:1),s="sbcs-cont";if(r&&r.biff>=8,!r||r.biff==8){var a=e.read_shift(1);a&&(s="dbcs-cont")}else r.biff==12&&(s="wstr");r.biff>=2&&r.biff<=5&&(s="cpstr");var i=n?e.read_shift(n,s):"";return i}function t5(e){var t=e.read_shift(2),r=e.read_shift(1),n=r&4,s=r&8,a=1+(r&1),i=0,o,l={};s&&(i=e.read_shift(2)),n&&(o=e.read_shift(4));var c=a==2?"dbcs-cont":"sbcs-cont",u=t===0?"":e.read_shift(t,c);return s&&(e.l+=4*i),n&&(e.l+=o),l.t=u,s||(l.raw="<t>"+l.t+"</t>",l.r=l.t),l}function Zi(e,t,r){var n;if(r){if(r.biff>=2&&r.biff<=5)return e.read_shift(t,"cpstr");if(r.biff>=12)return e.read_shift(t,"dbcs-cont")}var s=e.read_shift(1);return s===0?n=e.read_shift(t,"sbcs-cont"):n=e.read_shift(t,"dbcs-cont"),n}function Bu(e,t,r){var n=e.read_shift(r&&r.biff==2?1:2);return n===0?(e.l++,""):Zi(e,n,r)}function fo(e,t,r){if(r.biff>5)return Bu(e,t,r);var n=e.read_shift(1);return n===0?(e.l++,""):e.read_shift(n,r.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function r5(e){var t=e.read_shift(1);e.l++;var r=e.read_shift(2);return e.l+=2,[t,r]}function n5(e){var t=e.read_shift(4),r=e.l,n=!1;t>24&&(e.l+=t-24,e.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(n=!0),e.l=r);var s=e.read_shift((n?t-24:t)>>1,"utf16le").replace(Zr,"");return n&&(e.l+=24),s}function s5(e){for(var t=e.read_shift(2),r="";t-- >0;)r+="../";var n=e.read_shift(0,"lpstr-ansi");if(e.l+=2,e.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var s=e.read_shift(4);if(s===0)return r+n.replace(/\\/g,"/");var a=e.read_shift(4);if(e.read_shift(2)!=3)throw new Error("Bad FileMoniker");var i=e.read_shift(a>>1,"utf16le").replace(Zr,"");return r+i}function a5(e,t){var r=e.read_shift(16);switch(r){case"e0c9ea79f9bace118c8200aa004ba90b":return n5(e);case"0303000000000000c000000000000046":return s5(e);default:throw new Error("Unsupported Moniker "+r)}}function Pf(e){var t=e.read_shift(4),r=t>0?e.read_shift(t,"utf16le").replace(Zr,""):"";return r}function i5(e,t){var r=e.l+t,n=e.read_shift(4);if(n!==2)throw new Error("Unrecognized streamVersion: "+n);var s=e.read_shift(2);e.l+=2;var a,i,o,l,c="",u,d;s&16&&(a=Pf(e,r-e.l)),s&128&&(i=Pf(e,r-e.l)),(s&257)===257&&(o=Pf(e,r-e.l)),(s&257)===1&&(l=a5(e,r-e.l)),s&8&&(c=Pf(e,r-e.l)),s&32&&(u=e.read_shift(16)),s&64&&(d=lx(e)),e.l=r;var m=i||o||l||"";m&&c&&(m+="#"+c),m||(m="#"+c),s&2&&m.charAt(0)=="/"&&m.charAt(1)!="/"&&(m="file://"+m);var p={Target:m};return u&&(p.guid=u),d&&(p.time=d),a&&(p.Tooltip=a),p}function XA(e){var t=e.read_shift(1),r=e.read_shift(1),n=e.read_shift(1),s=e.read_shift(1);return[t,r,n,s]}function YA(e,t){var r=XA(e);return r[3]=0,r}function Ms(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2);return{r:t,c:r,ixfe:n}}function o5(e){var t=e.read_shift(2),r=e.read_shift(2);return e.l+=8,{type:t,flags:r}}function l5(e,t,r){return t===0?"":fo(e,t,r)}function c5(e,t,r){var n=r.biff>8?4:2,s=e.read_shift(n),a=e.read_shift(n,"i"),i=e.read_shift(n,"i");return[s,a,i]}function QA(e){var t=e.read_shift(2),r=ix(e);return[t,r]}function u5(e,t,r){e.l+=4,t-=4;var n=e.l+t,s=Uu(e,t,r),a=e.read_shift(2);if(n-=e.l,a!==n)throw new Error("Malformed AddinUdf: padding = "+n+" != "+a);return e.l+=a,s}function s0(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2),s=e.read_shift(2);return{s:{c:n,r:t},e:{c:s,r}}}function JA(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(1),s=e.read_shift(1);return{s:{c:n,r:t},e:{c:s,r}}}var f5=JA;function ZA(e){e.l+=4;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2);return e.l+=12,[r,t,n]}function h5(e){var t={};return e.l+=4,e.l+=16,t.fSharedNote=e.read_shift(2),e.l+=4,t}function d5(e){var t={};return e.l+=4,e.cf=e.read_shift(2),t}function Or(e){e.l+=2,e.l+=e.read_shift(2)}var m5={0:Or,4:Or,5:Or,6:Or,7:d5,8:Or,9:Or,10:Or,11:Or,12:Or,13:h5,14:Or,15:Or,16:Or,17:Or,18:Or,19:Or,20:Or,21:ZA};function p5(e,t){for(var r=e.l+t,n=[];e.l<r;){var s=e.read_shift(2);e.l-=2;try{n.push(m5[s](e,r-e.l))}catch{return e.l=r,n}}return e.l!=r&&(e.l=r),n}function Df(e,t){var r={BIFFVer:0,dt:0};switch(r.BIFFVer=e.read_shift(2),t-=2,t>=2&&(r.dt=e.read_shift(2),e.l-=2),r.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(t>6)throw new Error("Unexpected BIFF Ver "+r.BIFFVer)}return e.read_shift(t),r}function g5(e,t){return t===0||e.read_shift(2),1200}function v5(e,t,r){if(r.enc)return e.l+=t,"";var n=e.l,s=fo(e,0,r);return e.read_shift(t+n-e.l),s}function x5(e,t,r){var n=r&&r.biff==8||t==2?e.read_shift(2):(e.l+=t,0);return{fDialog:n&16,fBelow:n&64,fRight:n&128}}function y5(e,t,r){var n=e.read_shift(4),s=e.read_shift(1)&3,a=e.read_shift(1);switch(a){case 0:a="Worksheet";break;case 1:a="Macrosheet";break;case 2:a="Chartsheet";break;case 6:a="VBAModule";break}var i=Uu(e,0,r);return i.length===0&&(i="Sheet1"),{pos:n,hs:s,dt:a,name:i}}function _5(e,t){for(var r=e.l+t,n=e.read_shift(4),s=e.read_shift(4),a=[],i=0;i!=s&&e.l<r;++i)a.push(t5(e));return a.Count=n,a.Unique=s,a}function w5(e,t){var r={};return r.dsst=e.read_shift(2),e.l+=t-2,r}function E5(e){var t={};t.r=e.read_shift(2),t.c=e.read_shift(2),t.cnt=e.read_shift(2)-t.c;var r=e.read_shift(2);e.l+=4;var n=e.read_shift(1);return e.l+=3,n&7&&(t.level=n&7),n&32&&(t.hidden=!0),n&64&&(t.hpt=r/20),t}function T5(e){var t=o5(e);if(t.type!=2211)throw new Error("Invalid Future Record "+t.type);var r=e.read_shift(4);return r!==0}function k5(e){return e.read_shift(2),e.read_shift(4)}function Sw(e,t,r){var n=0;r&&r.biff==2||(n=e.read_shift(2));var s=e.read_shift(2);r&&r.biff==2&&(n=1-(s>>15),s&=32767);var a={Unsynced:n&1,DyZero:(n&2)>>1,ExAsc:(n&4)>>2,ExDsc:(n&8)>>3};return[a,s]}function S5(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2),s=e.read_shift(2),a=e.read_shift(2),i=e.read_shift(2),o=e.read_shift(2),l=e.read_shift(2),c=e.read_shift(2);return{Pos:[t,r],Dim:[n,s],Flags:a,CurTab:i,FirstTab:o,Selected:l,TabRatio:c}}function A5(e,t,r){if(r&&r.biff>=2&&r.biff<5)return{};var n=e.read_shift(2);return{RTL:n&64}}function I5(){}function C5(e,t,r){var n={dyHeight:e.read_shift(2),fl:e.read_shift(2)};switch(r&&r.biff||8){case 2:break;case 3:case 4:e.l+=2;break;default:e.l+=10;break}return n.name=Uu(e,0,r),n}function N5(e){var t=Ms(e);return t.isst=e.read_shift(4),t}function R5(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=e.l+t,s=Ms(e);r.biff==2&&e.l++;var a=Bu(e,n-e.l,r);return s.val=a,s}function b5(e,t,r){var n=e.read_shift(2),s=fo(e,0,r);return[n,s]}var P5=fo;function Aw(e,t,r){var n=e.l+t,s=r.biff==8||!r.biff?4:2,a=e.read_shift(s),i=e.read_shift(s),o=e.read_shift(2),l=e.read_shift(2);return e.l=n,{s:{r:a,c:o},e:{r:i,c:l}}}function D5(e){var t=e.read_shift(2),r=e.read_shift(2),n=QA(e);return{r:t,c:r,ixfe:n[0],rknum:n[1]}}function F5(e,t){for(var r=e.l+t-2,n=e.read_shift(2),s=e.read_shift(2),a=[];e.l<r;)a.push(QA(e));if(e.l!==r)throw new Error("MulRK read error");var i=e.read_shift(2);if(a.length!=i-s+1)throw new Error("MulRK length mismatch");return{r:n,c:s,C:i,rkrec:a}}function O5(e,t){for(var r=e.l+t-2,n=e.read_shift(2),s=e.read_shift(2),a=[];e.l<r;)a.push(e.read_shift(2));if(e.l!==r)throw new Error("MulBlank read error");var i=e.read_shift(2);if(a.length!=i-s+1)throw new Error("MulBlank length mismatch");return{r:n,c:s,C:i,ixfe:a}}function M5(e,t,r,n){var s={},a=e.read_shift(4),i=e.read_shift(4),o=e.read_shift(4),l=e.read_shift(2);return s.patternType=D8[o>>26],n.cellStyles&&(s.alc=a&7,s.fWrap=a>>3&1,s.alcV=a>>4&7,s.fJustLast=a>>7&1,s.trot=a>>8&255,s.cIndent=a>>16&15,s.fShrinkToFit=a>>20&1,s.iReadOrder=a>>22&2,s.fAtrNum=a>>26&1,s.fAtrFnt=a>>27&1,s.fAtrAlc=a>>28&1,s.fAtrBdr=a>>29&1,s.fAtrPat=a>>30&1,s.fAtrProt=a>>31&1,s.dgLeft=i&15,s.dgRight=i>>4&15,s.dgTop=i>>8&15,s.dgBottom=i>>12&15,s.icvLeft=i>>16&127,s.icvRight=i>>23&127,s.grbitDiag=i>>30&3,s.icvTop=o&127,s.icvBottom=o>>7&127,s.icvDiag=o>>14&127,s.dgDiag=o>>21&15,s.icvFore=l&127,s.icvBack=l>>7&127,s.fsxButton=l>>14&1),s}function L5(e,t,r){var n={};return n.ifnt=e.read_shift(2),n.numFmtId=e.read_shift(2),n.flags=e.read_shift(2),n.fStyle=n.flags>>2&1,t-=6,n.data=M5(e,t,n.fStyle,r),n}function j5(e){e.l+=4;var t=[e.read_shift(2),e.read_shift(2)];if(t[0]!==0&&t[0]--,t[1]!==0&&t[1]--,t[0]>7||t[1]>7)throw new Error("Bad Gutters: "+t.join("|"));return t}function Iw(e,t,r){var n=Ms(e);(r.biff==2||t==9)&&++e.l;var s=e5(e);return n.val=s,n.t=s===!0||s===!1?"b":"e",n}function V5(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=Ms(e),s=Ur(e);return n.val=s,n}var Cw=l5;function U5(e,t,r){var n=e.l+t,s=e.read_shift(2),a=e.read_shift(2);if(r.sbcch=a,a==1025||a==14849)return[a,s];if(a<1||a>255)throw new Error("Unexpected SupBook type: "+a);for(var i=Zi(e,a),o=[];n>e.l;)o.push(Bu(e));return[a,s,i,o]}function Nw(e,t,r){var n=e.read_shift(2),s,a={fBuiltIn:n&1,fWantAdvise:n>>>1&1,fWantPict:n>>>2&1,fOle:n>>>3&1,fOleLink:n>>>4&1,cf:n>>>5&1023,fIcon:n>>>15&1};return r.sbcch===14849&&(s=u5(e,t-2,r)),a.body=s||e.read_shift(t-2),typeof s=="string"&&(a.Name=s),a}var B5=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function Rw(e,t,r){var n=e.l+t,s=e.read_shift(2),a=e.read_shift(1),i=e.read_shift(1),o=e.read_shift(r&&r.biff==2?1:2),l=0;(!r||r.biff>=5)&&(r.biff!=5&&(e.l+=2),l=e.read_shift(2),r.biff==5&&(e.l+=2),e.l+=4);var c=Zi(e,i,r);s&32&&(c=B5[c.charCodeAt(0)]);var u=n-e.l;r&&r.biff==2&&--u;var d=n==e.l||o===0||!(u>0)?[]:EU(e,u,r,o);return{chKey:a,Name:c,itab:l,rgce:d}}function eI(e,t,r){if(r.biff<8)return z5(e,t,r);for(var n=[],s=e.l+t,a=e.read_shift(r.biff>8?4:2);a--!==0;)n.push(c5(e,r.biff>8?12:6,r));if(e.l!=s)throw new Error("Bad ExternSheet: "+e.l+" != "+s);return n}function z5(e,t,r){e[e.l+1]==3&&e[e.l]++;var n=Uu(e,t,r);return n.charCodeAt(0)==3?n.slice(1):n}function $5(e,t,r){if(r.biff<8){e.l+=t;return}var n=e.read_shift(2),s=e.read_shift(2),a=Zi(e,n,r),i=Zi(e,s,r);return[a,i]}function W5(e,t,r){var n=JA(e);e.l++;var s=e.read_shift(1);return t-=8,[TU(e,t,r),s,n]}function bw(e,t,r){var n=f5(e);switch(r.biff){case 2:e.l++,t-=7;break;case 3:case 4:e.l+=2,t-=8;break;default:e.l+=6,t-=12}return[n,_U(e,t,r)]}function H5(e){var t=e.read_shift(4)!==0,r=e.read_shift(4)!==0,n=e.read_shift(4);return[t,r,n]}function G5(e,t,r){if(!(r.biff<8)){var n=e.read_shift(2),s=e.read_shift(2),a=e.read_shift(2),i=e.read_shift(2),o=fo(e,0,r);return r.biff<8&&e.read_shift(1),[{r:n,c:s},o,i,a]}}function K5(e,t,r){return G5(e,t,r)}function q5(e,t){for(var r=[],n=e.read_shift(2);n--;)r.push(s0(e));return r}function X5(e,t,r){if(r&&r.biff<8)return Q5(e,t,r);var n=ZA(e),s=p5(e,t-22,n[1]);return{cmo:n,ft:s}}var Y5={8:function(e,t){var r=e.l+t;e.l+=10;var n=e.read_shift(2);e.l+=4,e.l+=2,e.l+=2,e.l+=2,e.l+=4;var s=e.read_shift(1);return e.l+=s,e.l=r,{fmt:n}}};function Q5(e,t,r){e.l+=4;var n=e.read_shift(2),s=e.read_shift(2),a=e.read_shift(2);e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=6,t-=36;var i=[];return i.push((Y5[n]||Gr)(e,t,r)),{cmo:[s,n,a],ft:i}}function J5(e,t,r){var n=e.l,s="";try{e.l+=4;var a=(r.lastobj||{cmo:[0,0]}).cmo[1],i;[0,5,7,11,12,14].indexOf(a)==-1?e.l+=6:i=r5(e,6,r);var o=e.read_shift(2);e.read_shift(2),Yt(e,2);var l=e.read_shift(2);e.l+=l;for(var c=1;c<e.lens.length-1;++c){if(e.l-n!=e.lens[c])throw new Error("TxO: bad continue record");var u=e[e.l],d=Zi(e,e.lens[c+1]-e.lens[c]-1);if(s+=d,s.length>=(u?o:2*o))break}if(s.length!==o&&s.length!==o*2)throw new Error("cchText: "+o+" != "+s.length);return e.l=n+t,{t:s}}catch{return e.l=n+t,{t:s}}}function Z5(e,t){var r=s0(e);e.l+=16;var n=i5(e,t-24);return[r,n]}function ej(e,t){e.read_shift(2);var r=s0(e),n=e.read_shift((t-10)/2,"dbcs-cont");return n=n.replace(Zr,""),[r,n]}function tj(e){var t=[0,0],r;return r=e.read_shift(2),t[0]=_w[r]||r,r=e.read_shift(2),t[1]=_w[r]||r,t}function rj(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(YA(e));return r}function nj(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(YA(e));return r}function sj(e){e.l+=2;var t={cxfs:0,crc:0};return t.cxfs=e.read_shift(2),t.crc=e.read_shift(4),t}function tI(e,t,r){if(!r.cellStyles)return Gr(e,t);var n=r&&r.biff>=12?4:2,s=e.read_shift(n),a=e.read_shift(n),i=e.read_shift(n),o=e.read_shift(n),l=e.read_shift(2);n==2&&(e.l+=2);var c={s,e:a,w:i,ixfe:o,flags:l};return(r.biff>=5||!r.biff)&&(c.level=l>>8&7),c}function aj(e,t){var r={};return t<32||(e.l+=16,r.header=Ur(e),r.footer=Ur(e),e.l+=2),r}function ij(e,t,r){var n={area:!1};if(r.biff!=5)return e.l+=t,n;var s=e.read_shift(1);return e.l+=3,s&16&&(n.area=!0),n}var oj=Ms,lj=qA,cj=Bu;function uj(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),s={fmt:t,env:r,len:n,data:e.slice(e.l,e.l+n)};return e.l+=n,s}function fj(e,t,r){r.biffguess&&r.biff==5&&(r.biff=2);var n=Ms(e);++e.l;var s=fo(e,t-7,r);return n.t="str",n.val=s,n}function hj(e){var t=Ms(e);++e.l;var r=Ur(e);return t.t="n",t.val=r,t}function dj(e){var t=Ms(e);++e.l;var r=e.read_shift(2);return t.t="n",t.val=r,t}function mj(e){var t=e.read_shift(1);return t===0?(e.l++,""):e.read_shift(t,"sbcs-cont")}function pj(e,t){e.l+=6,e.l+=2,e.l+=1,e.l+=3,e.l+=1,e.l+=t-13}function gj(e,t,r){var n=e.l+t,s=Ms(e),a=e.read_shift(2),i=Zi(e,a,r);return e.l=n,s.t="str",s.val=i,s}var vj=[2,3,48,49,131,139,140,245],Pw=function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},t=Qv({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(o,l){var c=[],u=ui(1);switch(l.type){case"base64":u=rs(An(o));break;case"binary":u=rs(o);break;case"buffer":case"array":u=o;break}yr(u,0);var d=u.read_shift(1),m=!!(d&136),p=!1,g=!1;switch(d){case 2:break;case 3:break;case 48:p=!0,m=!0;break;case 49:p=!0,m=!0;break;case 131:break;case 139:break;case 140:g=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+d.toString(16))}var x=0,w=521;d==2&&(x=u.read_shift(2)),u.l+=3,d!=2&&(x=u.read_shift(4)),x>1048576&&(x=1e6),d!=2&&(w=u.read_shift(2));var k=u.read_shift(2),T=l.codepage||1252;d!=2&&(u.l+=16,u.read_shift(1),u[u.l]!==0&&(T=e[u[u.l]]),u.l+=1,u.l+=2),g&&(u.l+=36);for(var E=[],N={},M=Math.min(u.length,d==2?521:w-10-(p?264:0)),O=g?32:11;u.l<M&&u[u.l]!=13;)switch(N={},N.name=lu.utils.decode(T,u.slice(u.l,u.l+O)).replace(/[\u0000\r\n].*$/g,""),u.l+=O,N.type=String.fromCharCode(u.read_shift(1)),d!=2&&!g&&(N.offset=u.read_shift(4)),N.len=u.read_shift(1),d==2&&(N.offset=u.read_shift(2)),N.dec=u.read_shift(1),N.name.length&&E.push(N),d!=2&&(u.l+=g?13:14),N.type){case"B":(!p||N.len!=8)&&l.WTF&&console.log("Skipping "+N.name+":"+N.type);break;case"G":case"P":l.WTF&&console.log("Skipping "+N.name+":"+N.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+N.type)}if(u[u.l]!==13&&(u.l=w-1),u.read_shift(1)!==13)throw new Error("DBF Terminator not found "+u.l+" "+u[u.l]);u.l=w;var v=0,_=0;for(c[0]=[],_=0;_!=E.length;++_)c[0][_]=E[_].name;for(;x-- >0;){if(u[u.l]===42){u.l+=k;continue}for(++u.l,c[++v]=[],_=0,_=0;_!=E.length;++_){var S=u.slice(u.l,u.l+E[_].len);u.l+=E[_].len,yr(S,0);var I=lu.utils.decode(T,S);switch(E[_].type){case"C":I.trim().length&&(c[v][_]=I.replace(/\s+$/,""));break;case"D":I.length===8?c[v][_]=new Date(+I.slice(0,4),+I.slice(4,6)-1,+I.slice(6,8)):c[v][_]=I;break;case"F":c[v][_]=parseFloat(I.trim());break;case"+":case"I":c[v][_]=g?S.read_shift(-4,"i")^2147483648:S.read_shift(4,"i");break;case"L":switch(I.trim().toUpperCase()){case"Y":case"T":c[v][_]=!0;break;case"N":case"F":c[v][_]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+I+"|")}break;case"M":if(!m)throw new Error("DBF Unexpected MEMO for type "+d.toString(16));c[v][_]="##MEMO##"+(g?parseInt(I.trim(),10):S.read_shift(4));break;case"N":I=I.replace(/\u0000/g,"").trim(),I&&I!="."&&(c[v][_]=+I||0);break;case"@":c[v][_]=new Date(S.read_shift(-8,"f")-621356832e5);break;case"T":c[v][_]=new Date((S.read_shift(4)-2440588)*864e5+S.read_shift(4));break;case"Y":c[v][_]=S.read_shift(4,"i")/1e4+S.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":c[v][_]=-S.read_shift(-8,"f");break;case"B":if(p&&E[_].len==8){c[v][_]=S.read_shift(8,"f");break}case"G":case"P":S.l+=E[_].len;break;case"0":if(E[_].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+E[_].type)}}}if(d!=2&&u.l<u.length&&u[u.l++]!=26)throw new Error("DBF EOF Marker missing "+(u.l-1)+" of "+u.length+" "+u[u.l-1].toString(16));return l&&l.sheetRows&&(c=c.slice(0,l.sheetRows)),l.DBF=E,c}function n(o,l){var c=l||{};c.dateNF||(c.dateNF="yyyymmdd");var u=Cl(r(o,c),c);return u["!cols"]=c.DBF.map(function(d){return{wch:d.len,DBF:d}}),delete c.DBF,u}function s(o,l){try{return xi(n(o,l),l)}catch(c){if(l&&l.WTF)throw c}return{SheetNames:[],Sheets:{}}}var a={B:8,C:250,L:1,D:8,"?":0,"":0};function i(o,l){var c=l||{};if(+c.codepage>=0&&ss(+c.codepage),c.type=="string")throw new Error("Cannot write DBF to JS string");var u=Fp(),d=Wp(o,{header:1,raw:!0,cellDates:!0}),m=d[0],p=d.slice(1),g=o["!cols"]||[],x=0,w=0,k=0,T=1;for(x=0;x<m.length;++x){if(((g[x]||{}).DBF||{}).name){m[x]=g[x].DBF.name,++k;continue}if(m[x]!=null){if(++k,typeof m[x]=="number"&&(m[x]=m[x].toString(10)),typeof m[x]!="string")throw new Error("DBF Invalid column name "+m[x]+" |"+typeof m[x]+"|");if(m.indexOf(m[x])!==x){for(w=0;w<1024;++w)if(m.indexOf(m[x]+"_"+w)==-1){m[x]+="_"+w;break}}}}var E=Bt(o["!ref"]),N=[],M=[],O=[];for(x=0;x<=E.e.c-E.s.c;++x){var v="",_="",S=0,I=[];for(w=0;w<p.length;++w)p[w][x]!=null&&I.push(p[w][x]);if(I.length==0||m[x]==null){N[x]="?";continue}for(w=0;w<I.length;++w){switch(typeof I[w]){case"number":_="B";break;case"string":_="C";break;case"boolean":_="L";break;case"object":_=I[w]instanceof Date?"D":"C";break;default:_="C"}S=Math.max(S,String(I[w]).length),v=v&&v!=_?"C":_}S>250&&(S=250),_=((g[x]||{}).DBF||{}).type,_=="C"&&g[x].DBF.len>S&&(S=g[x].DBF.len),v=="B"&&_=="N"&&(v="N",O[x]=g[x].DBF.dec,S=g[x].DBF.len),M[x]=v=="C"||_=="N"?S:a[v]||0,T+=M[x],N[x]=v}var b=u.next(32);for(b.write_shift(4,318902576),b.write_shift(4,p.length),b.write_shift(2,296+32*k),b.write_shift(2,T),x=0;x<4;++x)b.write_shift(4,0);for(b.write_shift(4,0|(+t[eA]||3)<<8),x=0,w=0;x<m.length;++x)if(m[x]!=null){var P=u.next(32),R=(m[x].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);P.write_shift(1,R,"sbcs"),P.write_shift(1,N[x]=="?"?"C":N[x],"sbcs"),P.write_shift(4,w),P.write_shift(1,M[x]||a[N[x]]||0),P.write_shift(1,O[x]||0),P.write_shift(1,2),P.write_shift(4,0),P.write_shift(1,0),P.write_shift(4,0),P.write_shift(4,0),w+=M[x]||a[N[x]]||0}var ue=u.next(264);for(ue.write_shift(4,13),x=0;x<65;++x)ue.write_shift(4,0);for(x=0;x<p.length;++x){var le=u.next(T);for(le.write_shift(1,0),w=0;w<m.length;++w)if(m[w]!=null)switch(N[w]){case"L":le.write_shift(1,p[x][w]==null?63:p[x][w]?84:70);break;case"B":le.write_shift(8,p[x][w]||0,"f");break;case"N":var he="0";for(typeof p[x][w]=="number"&&(he=p[x][w].toFixed(O[w]||0)),k=0;k<M[w]-he.length;++k)le.write_shift(1,32);le.write_shift(1,he,"sbcs");break;case"D":p[x][w]?(le.write_shift(4,("0000"+p[x][w].getFullYear()).slice(-4),"sbcs"),le.write_shift(2,("00"+(p[x][w].getMonth()+1)).slice(-2),"sbcs"),le.write_shift(2,("00"+p[x][w].getDate()).slice(-2),"sbcs")):le.write_shift(8,"00000000","sbcs");break;case"C":var pe=String(p[x][w]!=null?p[x][w]:"").slice(0,M[w]);for(le.write_shift(1,pe,"sbcs"),k=0;k<M[w]-pe.length;++k)le.write_shift(1,32);break}}return u.next(1).write_shift(1,26),u.end()}return{to_workbook:s,to_sheet:n,from_sheet:i}}(),xj=function(){var e={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},t=new RegExp("\x1BN("+bs(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(m,p){var g=e[p];return typeof g=="number"?q_(g):g},n=function(m,p,g){var x=p.charCodeAt(0)-32<<4|g.charCodeAt(0)-48;return x==59?m:q_(x)};e["|"]=254;function s(m,p){switch(p.type){case"base64":return a(An(m),p);case"binary":return a(m,p);case"buffer":return a(Qe&&Buffer.isBuffer(m)?m.toString("binary"):oo(m),p);case"array":return a(Ji(m),p)}throw new Error("Unrecognized type "+p.type)}function a(m,p){var g=m.split(/[\n\r]+/),x=-1,w=-1,k=0,T=0,E=[],N=[],M=null,O={},v=[],_=[],S=[],I=0,b;for(+p.codepage>=0&&ss(+p.codepage);k!==g.length;++k){I=0;var P=g[k].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(t,r),R=P.replace(/;;/g,"\0").split(";").map(function(G){return G.replace(/\u0000/g,";")}),ue=R[0],le;if(P.length>0)switch(ue){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":R[1].charAt(0)=="P"&&N.push(P.slice(3).replace(/;;/g,";"));break;case"C":var he=!1,pe=!1,ee=!1,H=!1,se=-1,ce=-1;for(T=1;T<R.length;++T)switch(R[T].charAt(0)){case"A":break;case"X":w=parseInt(R[T].slice(1))-1,pe=!0;break;case"Y":for(x=parseInt(R[T].slice(1))-1,pe||(w=0),b=E.length;b<=x;++b)E[b]=[];break;case"K":le=R[T].slice(1),le.charAt(0)==='"'?le=le.slice(1,le.length-1):le==="TRUE"?le=!0:le==="FALSE"?le=!1:isNaN(cs(le))?isNaN(gl(le).getDate())||(le=mr(le)):(le=cs(le),M!==null&&Al(M)&&(le=n0(le))),he=!0;break;case"E":H=!0;var B=Qo(R[T].slice(1),{r:x,c:w});E[x][w]=[E[x][w],B];break;case"S":ee=!0,E[x][w]=[E[x][w],"S5S"];break;case"G":break;case"R":se=parseInt(R[T].slice(1))-1;break;case"C":ce=parseInt(R[T].slice(1))-1;break;default:if(p&&p.WTF)throw new Error("SYLK bad record "+P)}if(he&&(E[x][w]&&E[x][w].length==2?E[x][w][0]=le:E[x][w]=le,M=null),ee){if(H)throw new Error("SYLK shared formula cannot have own formula");var K=se>-1&&E[se][ce];if(!K||!K[1])throw new Error("SYLK shared formula cannot find base");E[x][w][1]=fI(K[1],{r:x-se,c:w-ce})}break;case"F":var X=0;for(T=1;T<R.length;++T)switch(R[T].charAt(0)){case"X":w=parseInt(R[T].slice(1))-1,++X;break;case"Y":for(x=parseInt(R[T].slice(1))-1,b=E.length;b<=x;++b)E[b]=[];break;case"M":I=parseInt(R[T].slice(1))/20;break;case"F":break;case"G":break;case"P":M=N[parseInt(R[T].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(S=R[T].slice(1).split(" "),b=parseInt(S[0],10);b<=parseInt(S[1],10);++b)I=parseInt(S[2],10),_[b-1]=I===0?{hidden:!0}:{wch:I},vl(_[b-1]);break;case"C":w=parseInt(R[T].slice(1))-1,_[w]||(_[w]={});break;case"R":x=parseInt(R[T].slice(1))-1,v[x]||(v[x]={}),I>0?(v[x].hpt=I,v[x].hpx=mu(I)):I===0&&(v[x].hidden=!0);break;default:if(p&&p.WTF)throw new Error("SYLK bad record "+P)}X<1&&(M=null);break;default:if(p&&p.WTF)throw new Error("SYLK bad record "+P)}}return v.length>0&&(O["!rows"]=v),_.length>0&&(O["!cols"]=_),p&&p.sheetRows&&(E=E.slice(0,p.sheetRows)),[E,O]}function i(m,p){var g=s(m,p),x=g[0],w=g[1],k=Cl(x,p);return bs(w).forEach(function(T){k[T]=w[T]}),k}function o(m,p){return xi(i(m,p),p)}function l(m,p,g,x){var w="C;Y"+(g+1)+";X"+(x+1)+";K";switch(m.t){case"n":w+=m.v||0,m.f&&!m.F&&(w+=";E"+sV(m.f,{r:g,c:x}));break;case"b":w+=m.v?"TRUE":"FALSE";break;case"e":w+=m.w||m.v;break;case"d":w+='"'+(m.w||m.v)+'"';break;case"s":w+='"'+m.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return w}function c(m,p){p.forEach(function(g,x){var w="F;W"+(x+1)+" "+(x+1)+" ";g.hidden?w+="0":(typeof g.width=="number"&&!g.wpx&&(g.wpx=od(g.width)),typeof g.wpx=="number"&&!g.wch&&(g.wch=ld(g.wpx)),typeof g.wch=="number"&&(w+=Math.round(g.wch))),w.charAt(w.length-1)!=" "&&m.push(w)})}function u(m,p){p.forEach(function(g,x){var w="F;";g.hidden?w+="M0;":g.hpt?w+="M"+20*g.hpt+";":g.hpx&&(w+="M"+20*lI(g.hpx)+";"),w.length>2&&m.push(w+"R"+(x+1))})}function d(m,p){var g=["ID;PWXL;N;E"],x=[],w=Bt(m["!ref"]),k,T=Array.isArray(m),E=`\r
`;g.push("P;PGeneral"),g.push("F;P0;DG0G8;M255"),m["!cols"]&&c(g,m["!cols"]),m["!rows"]&&u(g,m["!rows"]),g.push("B;Y"+(w.e.r-w.s.r+1)+";X"+(w.e.c-w.s.c+1)+";D"+[w.s.c,w.s.r,w.e.c,w.e.r].join(" "));for(var N=w.s.r;N<=w.e.r;++N)for(var M=w.s.c;M<=w.e.c;++M){var O=Ue({r:N,c:M});k=T?(m[N]||[])[M]:m[O],!(!k||k.v==null&&(!k.f||k.F))&&x.push(l(k,m,N,M))}return g.join(E)+E+x.join(E)+E+"E"+E}return{to_workbook:o,to_sheet:i,from_sheet:d}}(),yj=function(){function e(a,i){switch(i.type){case"base64":return t(An(a),i);case"binary":return t(a,i);case"buffer":return t(Qe&&Buffer.isBuffer(a)?a.toString("binary"):oo(a),i);case"array":return t(Ji(a),i)}throw new Error("Unrecognized type "+i.type)}function t(a,i){for(var o=a.split(`
`),l=-1,c=-1,u=0,d=[];u!==o.length;++u){if(o[u].trim()==="BOT"){d[++l]=[],c=0;continue}if(!(l<0)){var m=o[u].trim().split(","),p=m[0],g=m[1];++u;for(var x=o[u]||"";(x.match(/["]/g)||[]).length&1&&u<o.length-1;)x+=`
`+o[++u];switch(x=x.trim(),+p){case-1:if(x==="BOT"){d[++l]=[],c=0;continue}else if(x!=="EOD")throw new Error("Unrecognized DIF special command "+x);break;case 0:x==="TRUE"?d[l][c]=!0:x==="FALSE"?d[l][c]=!1:isNaN(cs(g))?isNaN(gl(g).getDate())?d[l][c]=g:d[l][c]=mr(g):d[l][c]=cs(g),++c;break;case 1:x=x.slice(1,x.length-1),x=x.replace(/""/g,'"'),x&&x.match(/^=".*"$/)&&(x=x.slice(2,-1)),d[l][c++]=x!==""?x:null;break}if(x==="EOD")break}}return i&&i.sheetRows&&(d=d.slice(0,i.sheetRows)),d}function r(a,i){return Cl(e(a,i),i)}function n(a,i){return xi(r(a,i),i)}var s=function(){var a=function(l,c,u,d,m){l.push(c),l.push(u+","+d),l.push('"'+m.replace(/"/g,'""')+'"')},i=function(l,c,u,d){l.push(c+","+u),l.push(c==1?'"'+d.replace(/"/g,'""')+'"':d)};return function(l){var c=[],u=Bt(l["!ref"]),d,m=Array.isArray(l);a(c,"TABLE",0,1,"sheetjs"),a(c,"VECTORS",0,u.e.r-u.s.r+1,""),a(c,"TUPLES",0,u.e.c-u.s.c+1,""),a(c,"DATA",0,0,"");for(var p=u.s.r;p<=u.e.r;++p){i(c,-1,0,"BOT");for(var g=u.s.c;g<=u.e.c;++g){var x=Ue({r:p,c:g});if(d=m?(l[p]||[])[g]:l[x],!d){i(c,1,0,"");continue}switch(d.t){case"n":var w=d.w;!w&&d.v!=null&&(w=d.v),w==null?d.f&&!d.F?i(c,1,0,"="+d.f):i(c,1,0,""):i(c,0,w,"V");break;case"b":i(c,0,d.v?1:0,d.v?"TRUE":"FALSE");break;case"s":i(c,1,0,isNaN(d.v)?d.v:'="'+d.v+'"');break;case"d":d.w||(d.w=Wn(d.z||ze[14],en(mr(d.v)))),i(c,0,d.w,"V");break;default:i(c,1,0,"")}}}i(c,-1,0,"EOD");var k=`\r
`,T=c.join(k);return T}}();return{to_workbook:n,to_sheet:r,from_sheet:s}}(),_j=function(){function e(d){return d.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function t(d){return d.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(d,m){for(var p=d.split(`
`),g=-1,x=-1,w=0,k=[];w!==p.length;++w){var T=p[w].trim().split(":");if(T[0]==="cell"){var E=Qr(T[1]);if(k.length<=E.r)for(g=k.length;g<=E.r;++g)k[g]||(k[g]=[]);switch(g=E.r,x=E.c,T[2]){case"t":k[g][x]=e(T[3]);break;case"v":k[g][x]=+T[3];break;case"vtf":var N=T[T.length-1];case"vtc":switch(T[3]){case"nl":k[g][x]=!!+T[4];break;default:k[g][x]=+T[4];break}T[2]=="vtf"&&(k[g][x]=[k[g][x],N])}}}return m&&m.sheetRows&&(k=k.slice(0,m.sheetRows)),k}function n(d,m){return Cl(r(d,m),m)}function s(d,m){return xi(n(d,m),m)}var a=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),i=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,o=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),l="--SocialCalcSpreadsheetControlSave--";function c(d){if(!d||!d["!ref"])return"";for(var m=[],p=[],g,x="",w=Il(d["!ref"]),k=Array.isArray(d),T=w.s.r;T<=w.e.r;++T)for(var E=w.s.c;E<=w.e.c;++E)if(x=Ue({r:T,c:E}),g=k?(d[T]||[])[E]:d[x],!(!g||g.v==null||g.t==="z")){switch(p=["cell",x,"t"],g.t){case"s":case"str":p.push(t(g.v));break;case"n":g.f?(p[2]="vtf",p[3]="n",p[4]=g.v,p[5]=t(g.f)):(p[2]="v",p[3]=g.v);break;case"b":p[2]="vt"+(g.f?"f":"c"),p[3]="nl",p[4]=g.v?"1":"0",p[5]=t(g.f||(g.v?"TRUE":"FALSE"));break;case"d":var N=en(mr(g.v));p[2]="vtc",p[3]="nd",p[4]=""+N,p[5]=g.w||Wn(g.z||ze[14],N);break;case"e":continue}m.push(p.join(":"))}return m.push("sheet:c:"+(w.e.c-w.s.c+1)+":r:"+(w.e.r-w.s.r+1)+":tvf:1"),m.push("valueformat:1:text-wiki"),m.join(`
`)}function u(d){return[a,i,o,i,c(d),l].join(`
`)}return{to_workbook:s,to_sheet:n,from_sheet:u}}(),hu=function(){function e(u,d,m,p,g){g.raw?d[m][p]=u:u===""||(u==="TRUE"?d[m][p]=!0:u==="FALSE"?d[m][p]=!1:isNaN(cs(u))?isNaN(gl(u).getDate())?d[m][p]=u:d[m][p]=mr(u):d[m][p]=cs(u))}function t(u,d){var m=d||{},p=[];if(!u||u.length===0)return p;for(var g=u.split(/[\r\n]/),x=g.length-1;x>=0&&g[x].length===0;)--x;for(var w=10,k=0,T=0;T<=x;++T)k=g[T].indexOf(" "),k==-1?k=g[T].length:k++,w=Math.max(w,k);for(T=0;T<=x;++T){p[T]=[];var E=0;for(e(g[T].slice(0,w).trim(),p,T,E,m),E=1;E<=(g[T].length-w)/10+1;++E)e(g[T].slice(w+(E-1)*10,w+E*10).trim(),p,T,E,m)}return m.sheetRows&&(p=p.slice(0,m.sheetRows)),p}var r={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function s(u){for(var d={},m=!1,p=0,g=0;p<u.length;++p)(g=u.charCodeAt(p))==34?m=!m:!m&&g in r&&(d[g]=(d[g]||0)+1);g=[];for(p in d)Object.prototype.hasOwnProperty.call(d,p)&&g.push([d[p],p]);if(!g.length){d=n;for(p in d)Object.prototype.hasOwnProperty.call(d,p)&&g.push([d[p],p])}return g.sort(function(x,w){return x[0]-w[0]||n[x[1]]-n[w[1]]}),r[g.pop()[1]]||44}function a(u,d){var m=d||{},p="",g=m.dense?[]:{},x={s:{c:0,r:0},e:{c:0,r:0}};u.slice(0,4)=="sep="?u.charCodeAt(5)==13&&u.charCodeAt(6)==10?(p=u.charAt(4),u=u.slice(7)):u.charCodeAt(5)==13||u.charCodeAt(5)==10?(p=u.charAt(4),u=u.slice(6)):p=s(u.slice(0,1024)):m&&m.FS?p=m.FS:p=s(u.slice(0,1024));var w=0,k=0,T=0,E=0,N=0,M=p.charCodeAt(0),O=!1,v=0,_=u.charCodeAt(0);u=u.replace(/\r\n/mg,`
`);var S=m.dateNF!=null?b6(m.dateNF):null;function I(){var b=u.slice(E,N),P={};if(b.charAt(0)=='"'&&b.charAt(b.length-1)=='"'&&(b=b.slice(1,-1).replace(/""/g,'"')),b.length===0)P.t="z";else if(m.raw)P.t="s",P.v=b;else if(b.trim().length===0)P.t="s",P.v=b;else if(b.charCodeAt(0)==61)b.charCodeAt(1)==34&&b.charCodeAt(b.length-1)==34?(P.t="s",P.v=b.slice(2,-1).replace(/""/g,'"')):iV(b)?(P.t="n",P.f=b.slice(1)):(P.t="s",P.v=b);else if(b=="TRUE")P.t="b",P.v=!0;else if(b=="FALSE")P.t="b",P.v=!1;else if(!isNaN(T=cs(b)))P.t="n",m.cellText!==!1&&(P.w=b),P.v=T;else if(!isNaN(gl(b).getDate())||S&&b.match(S)){P.z=m.dateNF||ze[14];var R=0;S&&b.match(S)&&(b=P6(b,m.dateNF,b.match(S)||[]),R=1),m.cellDates?(P.t="d",P.v=mr(b,R)):(P.t="n",P.v=en(mr(b,R))),m.cellText!==!1&&(P.w=Wn(P.z,P.v instanceof Date?en(P.v):P.v)),m.cellNF||delete P.z}else P.t="s",P.v=b;if(P.t=="z"||(m.dense?(g[w]||(g[w]=[]),g[w][k]=P):g[Ue({c:k,r:w})]=P),E=N+1,_=u.charCodeAt(E),x.e.c<k&&(x.e.c=k),x.e.r<w&&(x.e.r=w),v==M)++k;else if(k=0,++w,m.sheetRows&&m.sheetRows<=w)return!0}e:for(;N<u.length;++N)switch(v=u.charCodeAt(N)){case 34:_===34&&(O=!O);break;case M:case 10:case 13:if(!O&&I())break e;break}return N-E>0&&I(),g["!ref"]=nt(x),g}function i(u,d){return!(d&&d.PRN)||d.FS||u.slice(0,4)=="sep="||u.indexOf("	")>=0||u.indexOf(",")>=0||u.indexOf(";")>=0?a(u,d):Cl(t(u,d),d)}function o(u,d){var m="",p=d.type=="string"?[0,0,0,0]:gx(u,d);switch(d.type){case"base64":m=An(u);break;case"binary":m=u;break;case"buffer":d.codepage==65001?m=u.toString("utf8"):d.codepage&&typeof lu<"u"||(m=Qe&&Buffer.isBuffer(u)?u.toString("binary"):oo(u));break;case"array":m=Ji(u);break;case"string":m=u;break;default:throw new Error("Unrecognized type "+d.type)}return p[0]==239&&p[1]==187&&p[2]==191?m=Et(m.slice(3)):d.type!="string"&&d.type!="buffer"&&d.codepage==65001?m=Et(m):d.type=="binary"&&typeof lu<"u",m.slice(0,19)=="socialcalc:version:"?_j.to_sheet(d.type=="string"?m:Et(m),d):i(m,d)}function l(u,d){return xi(o(u,d),d)}function c(u){for(var d=[],m=Bt(u["!ref"]),p,g=Array.isArray(u),x=m.s.r;x<=m.e.r;++x){for(var w=[],k=m.s.c;k<=m.e.c;++k){var T=Ue({r:x,c:k});if(p=g?(u[x]||[])[k]:u[T],!p||p.v==null){w.push("          ");continue}for(var E=(p.w||(ga(p),p.w)||"").slice(0,10);E.length<10;)E+=" ";w.push(E+(k===0?" ":""))}d.push(w.join(""))}return d.join(`
`)}return{to_workbook:l,to_sheet:o,from_sheet:c}}();function wj(e,t){var r=t||{},n=!!r.WTF;r.WTF=!0;try{var s=xj.to_workbook(e,r);return r.WTF=n,s}catch(a){if(r.WTF=n,!a.message.match(/SYLK bad record ID/)&&n)throw a;return hu.to_workbook(e,t)}}var Nc=function(){function e(B,K,X){if(B){yr(B,B.l||0);for(var G=X.Enum||se;B.l<B.length;){var ie=B.read_shift(2),ge=G[ie]||G[65535],Ie=B.read_shift(2),Te=B.l+Ie,ye=ge.f&&ge.f(B,Ie,X);if(B.l=Te,K(ye,ge,ie))return}}}function t(B,K){switch(K.type){case"base64":return r(rs(An(B)),K);case"binary":return r(rs(B),K);case"buffer":case"array":return r(B,K)}throw"Unsupported type "+K.type}function r(B,K){if(!B)return B;var X=K||{},G=X.dense?[]:{},ie="Sheet1",ge="",Ie=0,Te={},ye=[],$e=[],W={s:{r:0,c:0},e:{r:0,c:0}},lt=X.sheetRows||0;if(B[2]==0&&(B[3]==8||B[3]==9)&&B.length>=16&&B[14]==5&&B[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(B[2]==2)X.Enum=se,e(B,function(Ae,Tt,lr){switch(lr){case 0:X.vers=Ae,Ae>=4096&&(X.qpro=!0);break;case 6:W=Ae;break;case 204:Ae&&(ge=Ae);break;case 222:ge=Ae;break;case 15:case 51:X.qpro||(Ae[1].v=Ae[1].v.slice(1));case 13:case 14:case 16:lr==14&&(Ae[2]&112)==112&&(Ae[2]&15)>1&&(Ae[2]&15)<15&&(Ae[1].z=X.dateNF||ze[14],X.cellDates&&(Ae[1].t="d",Ae[1].v=n0(Ae[1].v))),X.qpro&&Ae[3]>Ie&&(G["!ref"]=nt(W),Te[ie]=G,ye.push(ie),G=X.dense?[]:{},W={s:{r:0,c:0},e:{r:0,c:0}},Ie=Ae[3],ie=ge||"Sheet"+(Ie+1),ge="");var Nr=X.dense?(G[Ae[0].r]||[])[Ae[0].c]:G[Ue(Ae[0])];if(Nr){Nr.t=Ae[1].t,Nr.v=Ae[1].v,Ae[1].z!=null&&(Nr.z=Ae[1].z),Ae[1].f!=null&&(Nr.f=Ae[1].f);break}X.dense?(G[Ae[0].r]||(G[Ae[0].r]=[]),G[Ae[0].r][Ae[0].c]=Ae[1]):G[Ue(Ae[0])]=Ae[1];break}},X);else if(B[2]==26||B[2]==14)X.Enum=ce,B[2]==14&&(X.qpro=!0,B.l=0),e(B,function(Ae,Tt,lr){switch(lr){case 204:ie=Ae;break;case 22:Ae[1].v=Ae[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(Ae[3]>Ie&&(G["!ref"]=nt(W),Te[ie]=G,ye.push(ie),G=X.dense?[]:{},W={s:{r:0,c:0},e:{r:0,c:0}},Ie=Ae[3],ie="Sheet"+(Ie+1)),lt>0&&Ae[0].r>=lt)break;X.dense?(G[Ae[0].r]||(G[Ae[0].r]=[]),G[Ae[0].r][Ae[0].c]=Ae[1]):G[Ue(Ae[0])]=Ae[1],W.e.c<Ae[0].c&&(W.e.c=Ae[0].c),W.e.r<Ae[0].r&&(W.e.r=Ae[0].r);break;case 27:Ae[14e3]&&($e[Ae[14e3][0]]=Ae[14e3][1]);break;case 1537:$e[Ae[0]]=Ae[1],Ae[0]==Ie&&(ie=Ae[1]);break}},X);else throw new Error("Unrecognized LOTUS BOF "+B[2]);if(G["!ref"]=nt(W),Te[ge||ie]=G,ye.push(ge||ie),!$e.length)return{SheetNames:ye,Sheets:Te};for(var He={},st=[],Fe=0;Fe<$e.length;++Fe)Te[ye[Fe]]?(st.push($e[Fe]||ye[Fe]),He[$e[Fe]]=Te[$e[Fe]]||Te[ye[Fe]]):(st.push($e[Fe]),He[$e[Fe]]={"!ref":"A1"});return{SheetNames:st,Sheets:He}}function n(B,K){var X=K||{};if(+X.codepage>=0&&ss(+X.codepage),X.type=="string")throw new Error("Cannot write WK1 to JS string");var G=Fp(),ie=Bt(B["!ref"]),ge=Array.isArray(B),Ie=[];Yn(G,0,a(1030)),Yn(G,6,l(ie));for(var Te=Math.min(ie.e.r,8191),ye=ie.s.r;ye<=Te;++ye)for(var $e=Ar(ye),W=ie.s.c;W<=ie.e.c;++W){ye===ie.s.r&&(Ie[W]=sr(W));var lt=Ie[W]+$e,He=ge?(B[ye]||[])[W]:B[lt];if(!(!He||He.t=="z"))if(He.t=="n")(He.v|0)==He.v&&He.v>=-32768&&He.v<=32767?Yn(G,13,p(ye,W,He.v)):Yn(G,14,x(ye,W,He.v));else{var st=ga(He);Yn(G,15,d(ye,W,st.slice(0,239)))}}return Yn(G,1),G.end()}function s(B,K){var X=K||{};if(+X.codepage>=0&&ss(+X.codepage),X.type=="string")throw new Error("Cannot write WK3 to JS string");var G=Fp();Yn(G,0,i(B));for(var ie=0,ge=0;ie<B.SheetNames.length;++ie)(B.Sheets[B.SheetNames[ie]]||{})["!ref"]&&Yn(G,27,H(B.SheetNames[ie],ge++));var Ie=0;for(ie=0;ie<B.SheetNames.length;++ie){var Te=B.Sheets[B.SheetNames[ie]];if(!(!Te||!Te["!ref"])){for(var ye=Bt(Te["!ref"]),$e=Array.isArray(Te),W=[],lt=Math.min(ye.e.r,8191),He=ye.s.r;He<=lt;++He)for(var st=Ar(He),Fe=ye.s.c;Fe<=ye.e.c;++Fe){He===ye.s.r&&(W[Fe]=sr(Fe));var Ae=W[Fe]+st,Tt=$e?(Te[He]||[])[Fe]:Te[Ae];if(!(!Tt||Tt.t=="z"))if(Tt.t=="n")Yn(G,23,I(He,Fe,Ie,Tt.v));else{var lr=ga(Tt);Yn(G,22,v(He,Fe,Ie,lr.slice(0,239)))}}++Ie}}return Yn(G,1),G.end()}function a(B){var K=tr(2);return K.write_shift(2,B),K}function i(B){var K=tr(26);K.write_shift(2,4096),K.write_shift(2,4),K.write_shift(4,0);for(var X=0,G=0,ie=0,ge=0;ge<B.SheetNames.length;++ge){var Ie=B.SheetNames[ge],Te=B.Sheets[Ie];if(!(!Te||!Te["!ref"])){++ie;var ye=Il(Te["!ref"]);X<ye.e.r&&(X=ye.e.r),G<ye.e.c&&(G=ye.e.c)}}return X>8191&&(X=8191),K.write_shift(2,X),K.write_shift(1,ie),K.write_shift(1,G),K.write_shift(2,0),K.write_shift(2,0),K.write_shift(1,1),K.write_shift(1,2),K.write_shift(4,0),K.write_shift(4,0),K}function o(B,K,X){var G={s:{c:0,r:0},e:{c:0,r:0}};return K==8&&X.qpro?(G.s.c=B.read_shift(1),B.l++,G.s.r=B.read_shift(2),G.e.c=B.read_shift(1),B.l++,G.e.r=B.read_shift(2),G):(G.s.c=B.read_shift(2),G.s.r=B.read_shift(2),K==12&&X.qpro&&(B.l+=2),G.e.c=B.read_shift(2),G.e.r=B.read_shift(2),K==12&&X.qpro&&(B.l+=2),G.s.c==65535&&(G.s.c=G.e.c=G.s.r=G.e.r=0),G)}function l(B){var K=tr(8);return K.write_shift(2,B.s.c),K.write_shift(2,B.s.r),K.write_shift(2,B.e.c),K.write_shift(2,B.e.r),K}function c(B,K,X){var G=[{c:0,r:0},{t:"n",v:0},0,0];return X.qpro&&X.vers!=20768?(G[0].c=B.read_shift(1),G[3]=B.read_shift(1),G[0].r=B.read_shift(2),B.l+=2):(G[2]=B.read_shift(1),G[0].c=B.read_shift(2),G[0].r=B.read_shift(2)),G}function u(B,K,X){var G=B.l+K,ie=c(B,K,X);if(ie[1].t="s",X.vers==20768){B.l++;var ge=B.read_shift(1);return ie[1].v=B.read_shift(ge,"utf8"),ie}return X.qpro&&B.l++,ie[1].v=B.read_shift(G-B.l,"cstr"),ie}function d(B,K,X){var G=tr(7+X.length);G.write_shift(1,255),G.write_shift(2,K),G.write_shift(2,B),G.write_shift(1,39);for(var ie=0;ie<G.length;++ie){var ge=X.charCodeAt(ie);G.write_shift(1,ge>=128?95:ge)}return G.write_shift(1,0),G}function m(B,K,X){var G=c(B,K,X);return G[1].v=B.read_shift(2,"i"),G}function p(B,K,X){var G=tr(7);return G.write_shift(1,255),G.write_shift(2,K),G.write_shift(2,B),G.write_shift(2,X,"i"),G}function g(B,K,X){var G=c(B,K,X);return G[1].v=B.read_shift(8,"f"),G}function x(B,K,X){var G=tr(13);return G.write_shift(1,255),G.write_shift(2,K),G.write_shift(2,B),G.write_shift(8,X,"f"),G}function w(B,K,X){var G=B.l+K,ie=c(B,K,X);if(ie[1].v=B.read_shift(8,"f"),X.qpro)B.l=G;else{var ge=B.read_shift(2);N(B.slice(B.l,B.l+ge),ie),B.l+=ge}return ie}function k(B,K,X){var G=K&32768;return K&=-32769,K=(G?B:0)+(K>=8192?K-16384:K),(G?"":"$")+(X?sr(K):Ar(K))}var T={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},E=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function N(B,K){yr(B,0);for(var X=[],G=0,ie="",ge="",Ie="",Te="";B.l<B.length;){var ye=B[B.l++];switch(ye){case 0:X.push(B.read_shift(8,"f"));break;case 1:ge=k(K[0].c,B.read_shift(2),!0),ie=k(K[0].r,B.read_shift(2),!1),X.push(ge+ie);break;case 2:{var $e=k(K[0].c,B.read_shift(2),!0),W=k(K[0].r,B.read_shift(2),!1);ge=k(K[0].c,B.read_shift(2),!0),ie=k(K[0].r,B.read_shift(2),!1),X.push($e+W+":"+ge+ie)}break;case 3:if(B.l<B.length){console.error("WK1 premature formula end");return}break;case 4:X.push("("+X.pop()+")");break;case 5:X.push(B.read_shift(2));break;case 6:{for(var lt="";ye=B[B.l++];)lt+=String.fromCharCode(ye);X.push('"'+lt.replace(/"/g,'""')+'"')}break;case 8:X.push("-"+X.pop());break;case 23:X.push("+"+X.pop());break;case 22:X.push("NOT("+X.pop()+")");break;case 20:case 21:Te=X.pop(),Ie=X.pop(),X.push(["AND","OR"][ye-20]+"("+Ie+","+Te+")");break;default:if(ye<32&&E[ye])Te=X.pop(),Ie=X.pop(),X.push(Ie+E[ye]+Te);else if(T[ye]){if(G=T[ye][1],G==69&&(G=B[B.l++]),G>X.length){console.error("WK1 bad formula parse 0x"+ye.toString(16)+":|"+X.join("|")+"|");return}var He=X.slice(-G);X.length-=G,X.push(T[ye][0]+"("+He.join(",")+")")}else return ye<=7?console.error("WK1 invalid opcode "+ye.toString(16)):ye<=24?console.error("WK1 unsupported op "+ye.toString(16)):ye<=30?console.error("WK1 invalid opcode "+ye.toString(16)):ye<=115?console.error("WK1 unsupported function opcode "+ye.toString(16)):console.error("WK1 unrecognized opcode "+ye.toString(16))}}X.length==1?K[1].f=""+X[0]:console.error("WK1 bad formula parse |"+X.join("|")+"|")}function M(B){var K=[{c:0,r:0},{t:"n",v:0},0];return K[0].r=B.read_shift(2),K[3]=B[B.l++],K[0].c=B[B.l++],K}function O(B,K){var X=M(B);return X[1].t="s",X[1].v=B.read_shift(K-4,"cstr"),X}function v(B,K,X,G){var ie=tr(6+G.length);ie.write_shift(2,B),ie.write_shift(1,X),ie.write_shift(1,K),ie.write_shift(1,39);for(var ge=0;ge<G.length;++ge){var Ie=G.charCodeAt(ge);ie.write_shift(1,Ie>=128?95:Ie)}return ie.write_shift(1,0),ie}function _(B,K){var X=M(B);X[1].v=B.read_shift(2);var G=X[1].v>>1;if(X[1].v&1)switch(G&7){case 0:G=(G>>3)*5e3;break;case 1:G=(G>>3)*500;break;case 2:G=(G>>3)/20;break;case 3:G=(G>>3)/200;break;case 4:G=(G>>3)/2e3;break;case 5:G=(G>>3)/2e4;break;case 6:G=(G>>3)/16;break;case 7:G=(G>>3)/64;break}return X[1].v=G,X}function S(B,K){var X=M(B),G=B.read_shift(4),ie=B.read_shift(4),ge=B.read_shift(2);if(ge==65535)return G===0&&ie===3221225472?(X[1].t="e",X[1].v=15):G===0&&ie===3489660928?(X[1].t="e",X[1].v=42):X[1].v=0,X;var Ie=ge&32768;return ge=(ge&32767)-16446,X[1].v=(1-Ie*2)*(ie*Math.pow(2,ge+32)+G*Math.pow(2,ge)),X}function I(B,K,X,G){var ie=tr(14);if(ie.write_shift(2,B),ie.write_shift(1,X),ie.write_shift(1,K),G==0)return ie.write_shift(4,0),ie.write_shift(4,0),ie.write_shift(2,65535),ie;var ge=0,Ie=0,Te=0,ye=0;return G<0&&(ge=1,G=-G),Ie=Math.log2(G)|0,G/=Math.pow(2,Ie-31),ye=G>>>0,ye&2147483648||(G/=2,++Ie,ye=G>>>0),G-=ye,ye|=2147483648,ye>>>=0,G*=Math.pow(2,32),Te=G>>>0,ie.write_shift(4,Te),ie.write_shift(4,ye),Ie+=16383+(ge?32768:0),ie.write_shift(2,Ie),ie}function b(B,K){var X=S(B);return B.l+=K-14,X}function P(B,K){var X=M(B),G=B.read_shift(4);return X[1].v=G>>6,X}function R(B,K){var X=M(B),G=B.read_shift(8,"f");return X[1].v=G,X}function ue(B,K){var X=R(B);return B.l+=K-10,X}function le(B,K){return B[B.l+K-1]==0?B.read_shift(K,"cstr"):""}function he(B,K){var X=B[B.l++];X>K-1&&(X=K-1);for(var G="";G.length<X;)G+=String.fromCharCode(B[B.l++]);return G}function pe(B,K,X){if(!(!X.qpro||K<21)){var G=B.read_shift(1);B.l+=17,B.l+=1,B.l+=2;var ie=B.read_shift(K-21,"cstr");return[G,ie]}}function ee(B,K){for(var X={},G=B.l+K;B.l<G;){var ie=B.read_shift(2);if(ie==14e3){for(X[ie]=[0,""],X[ie][0]=B.read_shift(2);B[B.l];)X[ie][1]+=String.fromCharCode(B[B.l]),B.l++;B.l++}}return X}function H(B,K){var X=tr(5+B.length);X.write_shift(2,14e3),X.write_shift(2,K);for(var G=0;G<B.length;++G){var ie=B.charCodeAt(G);X[X.l++]=ie>127?95:ie}return X[X.l++]=0,X}var se={0:{n:"BOF",f:Yt},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:o},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:m},14:{n:"NUMBER",f:g},15:{n:"LABEL",f:u},16:{n:"FORMULA",f:w},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:u},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:le},222:{n:"SHEETNAMELP",f:he},65535:{n:""}},ce={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:O},23:{n:"NUMBER17",f:S},24:{n:"NUMBER18",f:_},25:{n:"FORMULA19",f:b},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:ee},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:P},38:{n:"??"},39:{n:"NUMBER27",f:R},40:{n:"FORMULA28",f:ue},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:le},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:pe},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:n,book_to_wk3:s,to_workbook:t}}();function Ej(e){var t={},r=e.match(Kr),n=0,s=!1;if(r)for(;n!=r.length;++n){var a=Oe(r[n]);switch(a[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!a.val)break;case"<shadow>":case"<shadow/>":t.shadow=1;break;case"</shadow>":break;case"<charset":if(a.val=="1")break;t.cp=Gv[parseInt(a.val,10)];break;case"<outline":if(!a.val)break;case"<outline>":case"<outline/>":t.outline=1;break;case"</outline>":break;case"<rFont":t.name=a.val;break;case"<sz":t.sz=a.val;break;case"<strike":if(!a.val)break;case"<strike>":case"<strike/>":t.strike=1;break;case"</strike>":break;case"<u":if(!a.val)break;switch(a.val){case"double":t.uval="double";break;case"singleAccounting":t.uval="single-accounting";break;case"doubleAccounting":t.uval="double-accounting";break}case"<u>":case"<u/>":t.u=1;break;case"</u>":break;case"<b":if(a.val=="0")break;case"<b>":case"<b/>":t.b=1;break;case"</b>":break;case"<i":if(a.val=="0")break;case"<i>":case"<i/>":t.i=1;break;case"</i>":break;case"<color":a.rgb&&(t.color=a.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":t.family=a.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":t.valign=a.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(a[0].charCodeAt(1)!==47&&!s)throw new Error("Unrecognized rich format "+a[0])}}return t}var Tj=function(){var e=uu("t"),t=uu("rPr");function r(a){var i=a.match(e);if(!i)return{t:"s",v:""};var o={t:"s",v:ot(i[1])},l=a.match(t);return l&&(o.s=Ej(l[1])),o}var n=/<(?:\w+:)?r>/g,s=/<\/(?:\w+:)?r>/;return function(i){return i.replace(n,"").split(s).map(r).filter(function(o){return o.v})}}(),kj=function(){var t=/(\r\n|\n)/g;function r(s,a,i){var o=[];s.u&&o.push("text-decoration: underline;"),s.uval&&o.push("text-underline-style:"+s.uval+";"),s.sz&&o.push("font-size:"+s.sz+"pt;"),s.outline&&o.push("text-effect: outline;"),s.shadow&&o.push("text-shadow: auto;"),a.push('<span style="'+o.join("")+'">'),s.b&&(a.push("<b>"),i.push("</b>")),s.i&&(a.push("<i>"),i.push("</i>")),s.strike&&(a.push("<s>"),i.push("</s>"));var l=s.valign||"";return l=="superscript"||l=="super"?l="sup":l=="subscript"&&(l="sub"),l!=""&&(a.push("<"+l+">"),i.push("</"+l+">")),i.push("</span>"),s}function n(s){var a=[[],s.v,[]];return s.v?(s.s&&r(s.s,a[0],a[2]),a[0].join("")+a[1].replace(t,"<br/>")+a[2].join("")):""}return function(a){return a.map(n).join("")}}(),Sj=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,Aj=/<(?:\w+:)?r>/,Ij=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function cx(e,t){var r=t?t.cellHTML:!0,n={};return e?(e.match(/^\s*<(?:\w+:)?t[^>]*>/)?(n.t=ot(Et(e.slice(e.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),n.r=Et(e),r&&(n.h=Zv(n.t))):e.match(Aj)&&(n.r=Et(e),n.t=ot(Et((e.replace(Ij,"").match(Sj)||[]).join("").replace(Kr,""))),r&&(n.h=kj(Tj(n.r)))),n):{t:""}}var Cj=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,Nj=/<(?:\w+:)?(?:si|sstItem)>/g,Rj=/<\/(?:\w+:)?(?:si|sstItem)>/;function bj(e,t){var r=[],n="";if(!e)return r;var s=e.match(Cj);if(s){n=s[2].replace(Nj,"").split(Rj);for(var a=0;a!=n.length;++a){var i=cx(n[a].trim(),t);i!=null&&(r[r.length]=i)}s=Oe(s[1]),r.Count=s.count,r.Unique=s.uniqueCount}return r}function Pj(e){return[e.read_shift(4),e.read_shift(4)]}function Dj(e,t){var r=[],n=!1;return _a(e,function(a,i,o){switch(o){case 159:r.Count=a[0],r.Unique=a[1];break;case 19:r.push(a);break;case 160:return!0;case 35:n=!0;break;case 36:n=!1;break;default:if(i.T,!n||t.WTF)throw new Error("Unexpected record 0x"+o.toString(16))}}),r}function rI(e){for(var t=[],r=e.split(""),n=0;n<r.length;++n)t[n]=r[n].charCodeAt(0);return t}function sa(e,t){var r={};return r.Major=e.read_shift(2),r.Minor=e.read_shift(2),t>=4&&(e.l+=t-4),r}function Fj(e){var t={};return t.id=e.read_shift(0,"lpp4"),t.R=sa(e,4),t.U=sa(e,4),t.W=sa(e,4),t}function Oj(e){for(var t=e.read_shift(4),r=e.l+t-4,n={},s=e.read_shift(4),a=[];s-- >0;)a.push({t:e.read_shift(4),v:e.read_shift(0,"lpp4")});if(n.name=e.read_shift(0,"lpp4"),n.comps=a,e.l!=r)throw new Error("Bad DataSpaceMapEntry: "+e.l+" != "+r);return n}function Mj(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(Oj(e));return t}function Lj(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(e.read_shift(0,"lpp4"));return t}function jj(e){var t={};return e.read_shift(4),e.l+=4,t.id=e.read_shift(0,"lpp4"),t.name=e.read_shift(0,"lpp4"),t.R=sa(e,4),t.U=sa(e,4),t.W=sa(e,4),t}function Vj(e){var t=jj(e);if(t.ename=e.read_shift(0,"8lpp4"),t.blksz=e.read_shift(4),t.cmode=e.read_shift(4),e.read_shift(4)!=4)throw new Error("Bad !Primary record");return t}function nI(e,t){var r=e.l+t,n={};n.Flags=e.read_shift(4)&63,e.l+=4,n.AlgID=e.read_shift(4);var s=!1;switch(n.AlgID){case 26126:case 26127:case 26128:s=n.Flags==36;break;case 26625:s=n.Flags==4;break;case 0:s=n.Flags==16||n.Flags==4||n.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+n.AlgID}if(!s)throw new Error("Encryption Flags/AlgID mismatch");return n.AlgIDHash=e.read_shift(4),n.KeySize=e.read_shift(4),n.ProviderType=e.read_shift(4),e.l+=8,n.CSPName=e.read_shift(r-e.l>>1,"utf16le"),e.l=r,n}function sI(e,t){var r={},n=e.l+t;return e.l+=4,r.Salt=e.slice(e.l,e.l+16),e.l+=16,r.Verifier=e.slice(e.l,e.l+16),e.l+=16,e.read_shift(4),r.VerifierHash=e.slice(e.l,n),e.l=n,r}function Uj(e){var t=sa(e);switch(t.Minor){case 2:return[t.Minor,Bj(e)];case 3:return[t.Minor,zj()];case 4:return[t.Minor,$j(e)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+t.Minor)}function Bj(e){var t=e.read_shift(4);if((t&63)!=36)throw new Error("EncryptionInfo mismatch");var r=e.read_shift(4),n=nI(e,r),s=sI(e,e.length-e.l);return{t:"Std",h:n,v:s}}function zj(){throw new Error("File is password-protected: ECMA-376 Extensible")}function $j(e){var t=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];e.l+=4;var r=e.read_shift(e.length-e.l,"utf8"),n={};return r.replace(Kr,function(a){var i=Oe(a);switch(Os(i[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":t.forEach(function(o){n[o]=i[o]});break;case"<dataIntegrity":n.encryptedHmacKey=i.encryptedHmacKey,n.encryptedHmacValue=i.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":n.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":n.uri=i.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":n.encs.push(i);break;default:throw i[0]}}),n}function Wj(e,t){var r={},n=r.EncryptionVersionInfo=sa(e,4);if(t-=4,n.Minor!=2)throw new Error("unrecognized minor version code: "+n.Minor);if(n.Major>4||n.Major<2)throw new Error("unrecognized major version code: "+n.Major);r.Flags=e.read_shift(4),t-=4;var s=e.read_shift(4);return t-=4,r.EncryptionHeader=nI(e,s),t-=s,r.EncryptionVerifier=sI(e,t),r}function Hj(e){var t={},r=t.EncryptionVersionInfo=sa(e,4);if(r.Major!=1||r.Minor!=1)throw"unrecognized version code "+r.Major+" : "+r.Minor;return t.Salt=e.read_shift(16),t.EncryptedVerifier=e.read_shift(16),t.EncryptedVerifierHash=e.read_shift(16),t}function Gj(e){var t=0,r,n=rI(e),s=n.length+1,a,i,o,l,c;for(r=ui(s),r[0]=n.length,a=1;a!=s;++a)r[a]=n[a-1];for(a=s-1;a>=0;--a)i=r[a],o=t&16384?1:0,l=t<<1&32767,c=o|l,t=c^i;return t^52811}var aI=function(){var e=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],t=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],r=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],n=function(i){return(i/2|i*128)&255},s=function(i,o){return n(i^o)},a=function(i){for(var o=t[i.length-1],l=104,c=i.length-1;c>=0;--c)for(var u=i[c],d=0;d!=7;++d)u&64&&(o^=r[l]),u*=2,--l;return o};return function(i){for(var o=rI(i),l=a(o),c=o.length,u=ui(16),d=0;d!=16;++d)u[d]=0;var m,p,g;for((c&1)===1&&(m=l>>8,u[c]=s(e[0],m),--c,m=l&255,p=o[o.length-1],u[c]=s(p,m));c>0;)--c,m=l>>8,u[c]=s(o[c],m),--c,m=l&255,u[c]=s(o[c],m);for(c=15,g=15-o.length;g>0;)m=l>>8,u[c]=s(e[g],m),--c,--g,m=l&255,u[c]=s(o[c],m),--c,--g;return u}}(),Kj=function(e,t,r,n,s){s||(s=t),n||(n=aI(e));var a,i;for(a=0;a!=t.length;++a)i=t[a],i^=n[r],i=(i>>5|i<<3)&255,s[a]=i,++r;return[s,r,n]},qj=function(e){var t=0,r=aI(e);return function(n){var s=Kj("",n,t,r);return t=s[1],s[0]}};function Xj(e,t,r,n){var s={key:Yt(e),verificationBytes:Yt(e)};return r.password&&(s.verifier=Gj(r.password)),n.valid=s.verificationBytes===s.verifier,n.valid&&(n.insitu=qj(r.password)),s}function Yj(e,t,r){var n=r||{};return n.Info=e.read_shift(2),e.l-=2,n.Info===1?n.Data=Hj(e):n.Data=Wj(e,t),n}function Qj(e,t,r){var n={Type:r.biff>=8?e.read_shift(2):0};return n.Type?Yj(e,t-2,n):Xj(e,r.biff>=8?t:t-2,r,n),n}var Jj=function(){function e(s,a){switch(a.type){case"base64":return t(An(s),a);case"binary":return t(s,a);case"buffer":return t(Qe&&Buffer.isBuffer(s)?s.toString("binary"):oo(s),a);case"array":return t(Ji(s),a)}throw new Error("Unrecognized type "+a.type)}function t(s,a){var i=a||{},o=i.dense?[]:{},l=s.match(/\\trowd.*?\\row\b/g);if(!l.length)throw new Error("RTF missing table");var c={s:{c:0,r:0},e:{c:0,r:l.length-1}};return l.forEach(function(u,d){Array.isArray(o)&&(o[d]=[]);for(var m=/\\\w+\b/g,p=0,g,x=-1;g=m.exec(u);){switch(g[0]){case"\\cell":var w=u.slice(p,m.lastIndex-g[0].length);if(w[0]==" "&&(w=w.slice(1)),++x,w.length){var k={v:w,t:"s"};Array.isArray(o)?o[d][x]=k:o[Ue({r:d,c:x})]=k}break}p=m.lastIndex}x>c.e.c&&(c.e.c=x)}),o["!ref"]=nt(c),o}function r(s,a){return xi(e(s,a),a)}function n(s){for(var a=["{\\rtf1\\ansi"],i=Bt(s["!ref"]),o,l=Array.isArray(s),c=i.s.r;c<=i.e.r;++c){a.push("\\trowd\\trautofit1");for(var u=i.s.c;u<=i.e.c;++u)a.push("\\cellx"+(u+1));for(a.push("\\pard\\intbl"),u=i.s.c;u<=i.e.c;++u){var d=Ue({r:c,c:u});o=l?(s[c]||[])[u]:s[d],!(!o||o.v==null&&(!o.f||o.F))&&(a.push(" "+(o.w||(ga(o),o.w))),a.push("\\cell"))}a.push("\\pard\\intbl\\row")}return a.join("")+"}"}return{to_workbook:r,to_sheet:e,from_sheet:n}}();function Zj(e){var t=e.slice(e[0]==="#"?1:0).slice(0,6);return[parseInt(t.slice(0,2),16),parseInt(t.slice(2,4),16),parseInt(t.slice(4,6),16)]}function du(e){for(var t=0,r=1;t!=3;++t)r=r*256+(e[t]>255?255:e[t]<0?0:e[t]);return r.toString(16).toUpperCase().slice(1)}function e9(e){var t=e[0]/255,r=e[1]/255,n=e[2]/255,s=Math.max(t,r,n),a=Math.min(t,r,n),i=s-a;if(i===0)return[0,0,t];var o=0,l=0,c=s+a;switch(l=i/(c>1?2-c:c),s){case t:o=((r-n)/i+6)%6;break;case r:o=(n-t)/i+2;break;case n:o=(t-r)/i+4;break}return[o/6,l,c/2]}function t9(e){var t=e[0],r=e[1],n=e[2],s=r*2*(n<.5?n:1-n),a=n-s/2,i=[a,a,a],o=6*t,l;if(r!==0)switch(o|0){case 0:case 6:l=s*o,i[0]+=s,i[1]+=l;break;case 1:l=s*(2-o),i[0]+=l,i[1]+=s;break;case 2:l=s*(o-2),i[1]+=s,i[2]+=l;break;case 3:l=s*(4-o),i[1]+=l,i[2]+=s;break;case 4:l=s*(o-4),i[2]+=s,i[0]+=l;break;case 5:l=s*(6-o),i[2]+=l,i[0]+=s;break}for(var c=0;c!=3;++c)i[c]=Math.round(i[c]*255);return i}function id(e,t){if(t===0)return e;var r=e9(Zj(e));return t<0?r[2]=r[2]*(1+t):r[2]=1-(1-r[2])*(1-t),du(t9(r))}var iI=6,r9=15,n9=1,Yr=iI;function od(e){return Math.floor((e+Math.round(128/Yr)/256)*Yr)}function ld(e){return Math.floor((e-5)/Yr*100+.5)/100}function jp(e){return Math.round((e*Yr+5)/Yr*256)/256}function nm(e){return jp(ld(od(e)))}function ux(e){var t=Math.abs(e-nm(e)),r=Yr;if(t>.005)for(Yr=n9;Yr<r9;++Yr)Math.abs(e-nm(e))<=t&&(t=Math.abs(e-nm(e)),r=Yr);Yr=r}function vl(e){e.width?(e.wpx=od(e.width),e.wch=ld(e.wpx),e.MDW=Yr):e.wpx?(e.wch=ld(e.wpx),e.width=jp(e.wch),e.MDW=Yr):typeof e.wch=="number"&&(e.width=jp(e.wch),e.wpx=od(e.width),e.MDW=Yr),e.customWidth&&delete e.customWidth}var s9=96,oI=s9;function lI(e){return e*96/oI}function mu(e){return e*oI/96}var a9={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function i9(e,t,r,n){t.Borders=[];var s={},a=!1;(e[0].match(Kr)||[]).forEach(function(i){var o=Oe(i);switch(Os(o[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":s={},o.diagonalUp&&(s.diagonalUp=bt(o.diagonalUp)),o.diagonalDown&&(s.diagonalDown=bt(o.diagonalDown)),t.Borders.push(s);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(n&&n.WTF&&!a)throw new Error("unrecognized "+o[0]+" in borders")}})}function o9(e,t,r,n){t.Fills=[];var s={},a=!1;(e[0].match(Kr)||[]).forEach(function(i){var o=Oe(i);switch(Os(o[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":s={},t.Fills.push(s);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":t.Fills.push(s),s={};break;case"<patternFill":case"<patternFill>":o.patternType&&(s.patternType=o.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":s.bgColor||(s.bgColor={}),o.indexed&&(s.bgColor.indexed=parseInt(o.indexed,10)),o.theme&&(s.bgColor.theme=parseInt(o.theme,10)),o.tint&&(s.bgColor.tint=parseFloat(o.tint)),o.rgb&&(s.bgColor.rgb=o.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":s.fgColor||(s.fgColor={}),o.theme&&(s.fgColor.theme=parseInt(o.theme,10)),o.tint&&(s.fgColor.tint=parseFloat(o.tint)),o.rgb!=null&&(s.fgColor.rgb=o.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(n&&n.WTF&&!a)throw new Error("unrecognized "+o[0]+" in fills")}})}function l9(e,t,r,n){t.Fonts=[];var s={},a=!1;(e[0].match(Kr)||[]).forEach(function(i){var o=Oe(i);switch(Os(o[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":t.Fonts.push(s),s={};break;case"<name":o.val&&(s.name=Et(o.val));break;case"<name/>":case"</name>":break;case"<b":s.bold=o.val?bt(o.val):1;break;case"<b/>":s.bold=1;break;case"<i":s.italic=o.val?bt(o.val):1;break;case"<i/>":s.italic=1;break;case"<u":switch(o.val){case"none":s.underline=0;break;case"single":s.underline=1;break;case"double":s.underline=2;break;case"singleAccounting":s.underline=33;break;case"doubleAccounting":s.underline=34;break}break;case"<u/>":s.underline=1;break;case"<strike":s.strike=o.val?bt(o.val):1;break;case"<strike/>":s.strike=1;break;case"<outline":s.outline=o.val?bt(o.val):1;break;case"<outline/>":s.outline=1;break;case"<shadow":s.shadow=o.val?bt(o.val):1;break;case"<shadow/>":s.shadow=1;break;case"<condense":s.condense=o.val?bt(o.val):1;break;case"<condense/>":s.condense=1;break;case"<extend":s.extend=o.val?bt(o.val):1;break;case"<extend/>":s.extend=1;break;case"<sz":o.val&&(s.sz=+o.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":o.val&&(s.vertAlign=o.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":o.val&&(s.family=parseInt(o.val,10));break;case"<family/>":case"</family>":break;case"<scheme":o.val&&(s.scheme=o.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(o.val=="1")break;o.codepage=Gv[parseInt(o.val,10)];break;case"<color":if(s.color||(s.color={}),o.auto&&(s.color.auto=bt(o.auto)),o.rgb)s.color.rgb=o.rgb.slice(-6);else if(o.indexed){s.color.index=parseInt(o.indexed,10);var l=Vi[s.color.index];s.color.index==81&&(l=Vi[1]),l||(l=Vi[1]),s.color.rgb=l[0].toString(16)+l[1].toString(16)+l[2].toString(16)}else o.theme&&(s.color.theme=parseInt(o.theme,10),o.tint&&(s.color.tint=parseFloat(o.tint)),o.theme&&r.themeElements&&r.themeElements.clrScheme&&(s.color.rgb=id(r.themeElements.clrScheme[s.color.theme].rgb,s.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":a=!0;break;case"</AlternateContent>":a=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(n&&n.WTF&&!a)throw new Error("unrecognized "+o[0]+" in fonts")}})}function c9(e,t,r){t.NumberFmt=[];for(var n=bs(ze),s=0;s<n.length;++s)t.NumberFmt[n[s]]=ze[n[s]];var a=e[0].match(Kr);if(a)for(s=0;s<a.length;++s){var i=Oe(a[s]);switch(Os(i[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var o=ot(Et(i.formatCode)),l=parseInt(i.numFmtId,10);if(t.NumberFmt[l]=o,l>0){if(l>392){for(l=392;l>60&&t.NumberFmt[l]!=null;--l);t.NumberFmt[l]=o}ji(o,l)}}break;case"</numFmt>":break;default:if(r.WTF)throw new Error("unrecognized "+i[0]+" in numFmts")}}}var Ff=["numFmtId","fillId","fontId","borderId","xfId"],Of=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function u9(e,t,r){t.CellXf=[];var n,s=!1;(e[0].match(Kr)||[]).forEach(function(a){var i=Oe(a),o=0;switch(Os(i[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(n=i,delete n[0],o=0;o<Ff.length;++o)n[Ff[o]]&&(n[Ff[o]]=parseInt(n[Ff[o]],10));for(o=0;o<Of.length;++o)n[Of[o]]&&(n[Of[o]]=bt(n[Of[o]]));if(t.NumberFmt&&n.numFmtId>392){for(o=392;o>60;--o)if(t.NumberFmt[n.numFmtId]==t.NumberFmt[o]){n.numFmtId=o;break}}t.CellXf.push(n);break;case"</xf>":break;case"<alignment":case"<alignment/>":var l={};i.vertical&&(l.vertical=i.vertical),i.horizontal&&(l.horizontal=i.horizontal),i.textRotation!=null&&(l.textRotation=i.textRotation),i.indent&&(l.indent=i.indent),i.wrapText&&(l.wrapText=bt(i.wrapText)),n.alignment=l;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":s=!0;break;case"</AlternateContent>":s=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(r&&r.WTF&&!s)throw new Error("unrecognized "+i[0]+" in cellXfs")}})}var f9=function(){var t=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,r=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,n=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,s=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,a=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(o,l,c){var u={};if(!o)return u;o=o.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var d;return(d=o.match(t))&&c9(d,u,c),(d=o.match(s))&&l9(d,u,l,c),(d=o.match(n))&&o9(d,u,l,c),(d=o.match(a))&&i9(d,u,l,c),(d=o.match(r))&&u9(d,u,c),u}}();function h9(e,t){var r=e.read_shift(2),n=$r(e);return[r,n]}function d9(e,t,r){var n={};n.sz=e.read_shift(2)/20;var s=T8(e);s.fItalic&&(n.italic=1),s.fCondense&&(n.condense=1),s.fExtend&&(n.extend=1),s.fShadow&&(n.shadow=1),s.fOutline&&(n.outline=1),s.fStrikeout&&(n.strike=1);var a=e.read_shift(2);switch(a===700&&(n.bold=1),e.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var i=e.read_shift(1);i!=0&&(n.underline=i);var o=e.read_shift(1);o>0&&(n.family=o);var l=e.read_shift(1);switch(l>0&&(n.charset=l),e.l++,n.color=E8(e),e.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=$r(e),n}var m9=Gr;function p9(e,t){var r=e.l+t,n=e.read_shift(2),s=e.read_shift(2);return e.l=r,{ixfe:n,numFmtId:s}}var g9=Gr;function v9(e,t,r){var n={};n.NumberFmt=[];for(var s in ze)n.NumberFmt[s]=ze[s];n.CellXf=[],n.Fonts=[];var a=[],i=!1;return _a(e,function(l,c,u){switch(u){case 44:n.NumberFmt[l[0]]=l[1],ji(l[1],l[0]);break;case 43:n.Fonts.push(l),l.color.theme!=null&&t&&t.themeElements&&t.themeElements.clrScheme&&(l.color.rgb=id(t.themeElements.clrScheme[l.color.theme].rgb,l.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:a[a.length-1]==617&&n.CellXf.push(l);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:i=!0;break;case 36:i=!1;break;case 37:a.push(u),i=!0;break;case 38:a.pop(),i=!1;break;default:if(c.T>0)a.push(u);else if(c.T<0)a.pop();else if(!i||r.WTF&&a[a.length-1]!=37)throw new Error("Unexpected record 0x"+u.toString(16))}}),n}var x9=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function y9(e,t,r){t.themeElements.clrScheme=[];var n={};(e[0].match(Kr)||[]).forEach(function(s){var a=Oe(s);switch(a[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":n.rgb=a.val;break;case"<a:sysClr":n.rgb=a.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":a[0].charAt(1)==="/"?(t.themeElements.clrScheme[x9.indexOf(a[0])]=n,n={}):n.name=a[0].slice(3,a[0].length-1);break;default:if(r&&r.WTF)throw new Error("Unrecognized "+a[0]+" in clrScheme")}})}function _9(){}function w9(){}var E9=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,T9=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,k9=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function S9(e,t,r){t.themeElements={};var n;[["clrScheme",E9,y9],["fontScheme",T9,_9],["fmtScheme",k9,w9]].forEach(function(s){if(!(n=e.match(s[1])))throw new Error(s[0]+" not found in themeElements");s[2](n,t,r)})}var A9=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function cI(e,t){(!e||e.length===0)&&(e=I9());var r,n={};if(!(r=e.match(A9)))throw new Error("themeElements not found in theme");return S9(r[0],n,t),n.raw=e,n}function I9(e,t){var r=[_A];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function C9(e,t,r){var n=e.l+t,s=e.read_shift(4);if(s!==124226){if(!r.cellStyles){e.l=n;return}var a=e.slice(e.l);e.l=n;var i;try{i=yA(a,{type:"array"})}catch{return}var o=wn(i,"theme/theme/theme1.xml",!0);if(o)return cI(o,r)}}function N9(e){return e.read_shift(4)}function R9(e){var t={};switch(t.xclrType=e.read_shift(2),t.nTintShade=e.read_shift(2),t.xclrType){case 0:e.l+=4;break;case 1:t.xclrValue=b9(e,4);break;case 2:t.xclrValue=XA(e);break;case 3:t.xclrValue=N9(e);break;case 4:e.l+=4;break}return e.l+=8,t}function b9(e,t){return Gr(e,t)}function P9(e,t){return Gr(e,t)}function D9(e){var t=e.read_shift(2),r=e.read_shift(2)-4,n=[t];switch(t){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:n[1]=R9(e);break;case 6:n[1]=P9(e,r);break;case 14:case 15:n[1]=e.read_shift(r===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+t+" "+r)}return n}function F9(e,t){var r=e.l+t;e.l+=2;var n=e.read_shift(2);e.l+=2;for(var s=e.read_shift(2),a=[];s-- >0;)a.push(D9(e,r-e.l));return{ixfe:n,ext:a}}function O9(e,t){t.forEach(function(r){switch(r[0]){}})}function M9(e,t){return{flags:e.read_shift(4),version:e.read_shift(4),name:$r(e)}}function L9(e){for(var t=[],r=e.read_shift(4);r-- >0;)t.push([e.read_shift(4),e.read_shift(4)]);return t}function j9(e){return e.l+=4,e.read_shift(4)!=0}function V9(e,t,r){var n={Types:[],Cell:[],Value:[]},s=r||{},a=[],i=!1,o=2;return _a(e,function(l,c,u){switch(u){case 335:n.Types.push({name:l.name});break;case 51:l.forEach(function(d){o==1?n.Cell.push({type:n.Types[d[0]-1].name,index:d[1]}):o==0&&n.Value.push({type:n.Types[d[0]-1].name,index:d[1]})});break;case 337:o=l?1:0;break;case 338:o=2;break;case 35:a.push(u),i=!0;break;case 36:a.pop(),i=!1;break;default:if(!c.T){if(!i||s.WTF&&a[a.length-1]!=35)throw new Error("Unexpected record 0x"+u.toString(16))}}}),n}function U9(e,t,r){var n={Types:[],Cell:[],Value:[]};if(!e)return n;var s=!1,a=2,i;return e.replace(Kr,function(o){var l=Oe(o);switch(Os(l[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":n.Types.push({name:l.name});break;case"</metadataType>":break;case"<futureMetadata":for(var c=0;c<n.Types.length;++c)n.Types[c].name==l.name&&(i=n.Types[c]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":a==1?n.Cell.push({type:n.Types[l.t-1].name,index:+l.v}):a==0&&n.Value.push({type:n.Types[l.t-1].name,index:+l.v});break;case"</rc>":break;case"<cellMetadata":a=1;break;case"</cellMetadata>":a=2;break;case"<valueMetadata":a=0;break;case"</valueMetadata>":a=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;case"<rvb":if(!i)break;i.offsets||(i.offsets=[]),i.offsets.push(+l.i);break;default:if(!s&&r.WTF)throw new Error("unrecognized "+l[0]+" in metadata")}return o}),n}function B9(e){var t=[];if(!e)return t;var r=1;return(e.match(Kr)||[]).forEach(function(n){var s=Oe(n);switch(s[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete s[0],s.i?r=s.i:s.i=r,t.push(s);break}}),t}function z9(e){var t={};t.i=e.read_shift(4);var r={};r.r=e.read_shift(4),r.c=e.read_shift(4),t.r=Ue(r);var n=e.read_shift(1);return n&2&&(t.l="1"),n&8&&(t.a="1"),t}function $9(e,t,r){var n=[];return _a(e,function(a,i,o){switch(o){case 63:n.push(a);break;default:if(!i.T)throw new Error("Unexpected record 0x"+o.toString(16))}}),n}function W9(e,t,r,n){if(!e)return e;var s=n||{},a=!1;_a(e,function(o,l,c){switch(c){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:a=!0;break;case 36:a=!1;break;default:if(!l.T){if(!a||s.WTF)throw new Error("Unexpected record 0x"+c.toString(16))}}},s)}function H9(e,t){if(!e)return"??";var r=(e.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return t["!id"][r].Target}function Dw(e,t,r,n){var s=Array.isArray(e),a;t.forEach(function(i){var o=Qr(i.ref);if(s?(e[o.r]||(e[o.r]=[]),a=e[o.r][o.c]):a=e[i.ref],!a){a={t:"z"},s?e[o.r][o.c]=a:e[i.ref]=a;var l=Bt(e["!ref"]||"BDWGO1000001:A1");l.s.r>o.r&&(l.s.r=o.r),l.e.r<o.r&&(l.e.r=o.r),l.s.c>o.c&&(l.s.c=o.c),l.e.c<o.c&&(l.e.c=o.c);var c=nt(l);c!==e["!ref"]&&(e["!ref"]=c)}a.c||(a.c=[]);var u={a:i.author,t:i.t,r:i.r,T:r};i.h&&(u.h=i.h);for(var d=a.c.length-1;d>=0;--d){if(!r&&a.c[d].T)return;r&&!a.c[d].T&&a.c.splice(d,1)}if(r&&n){for(d=0;d<n.length;++d)if(u.a==n[d].id){u.a=n[d].name||u.a;break}}a.c.push(u)})}function G9(e,t){if(e.match(/<(?:\w+:)?comments *\/>/))return[];var r=[],n=[],s=e.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);s&&s[1]&&s[1].split(/<\/\w*:?author>/).forEach(function(i){if(!(i===""||i.trim()==="")){var o=i.match(/<(?:\w+:)?author[^>]*>(.*)/);o&&r.push(o[1])}});var a=e.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return a&&a[1]&&a[1].split(/<\/\w*:?comment>/).forEach(function(i){if(!(i===""||i.trim()==="")){var o=i.match(/<(?:\w+:)?comment[^>]*>/);if(o){var l=Oe(o[0]),c={author:l.authorId&&r[l.authorId]||"sheetjsghost",ref:l.ref,guid:l.guid},u=Qr(l.ref);if(!(t.sheetRows&&t.sheetRows<=u.r)){var d=i.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),m=!!d&&!!d[1]&&cx(d[1])||{r:"",t:"",h:""};c.r=m.r,m.r=="<t></t>"&&(m.t=m.h=""),c.t=(m.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),t.cellHTML&&(c.h=m.h),n.push(c)}}}}),n}function K9(e,t){var r=[],n=!1,s={},a=0;return e.replace(Kr,function(o,l){var c=Oe(o);switch(Os(c[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":s={author:c.personId,guid:c.id,ref:c.ref,T:1};break;case"</threadedComment>":s.t!=null&&r.push(s);break;case"<text>":case"<text":a=l+o.length;break;case"</text>":s.t=e.slice(a,l).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":n=!0;break;case"</mentions>":n=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&t.WTF)throw new Error("unrecognized "+c[0]+" in threaded comments")}return o}),r}function q9(e,t){var r=[],n=!1;return e.replace(Kr,function(a){var i=Oe(a);switch(Os(i[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":r.push({name:i.displayname,id:i.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&t.WTF)throw new Error("unrecognized "+i[0]+" in threaded comments")}return a}),r}function X9(e){var t={};t.iauthor=e.read_shift(4);var r=co(e);return t.rfx=r.s,t.ref=Ue(r.s),e.l+=16,t}var Y9=$r;function Q9(e,t){var r=[],n=[],s={},a=!1;return _a(e,function(o,l,c){switch(c){case 632:n.push(o);break;case 635:s=o;break;case 637:s.t=o.t,s.h=o.h,s.r=o.r;break;case 636:if(s.author=n[s.iauthor],delete s.iauthor,t.sheetRows&&s.rfx&&t.sheetRows<=s.rfx.r)break;s.t||(s.t=""),delete s.rfx,r.push(s);break;case 3072:break;case 35:a=!0;break;case 36:a=!1;break;case 37:break;case 38:break;default:if(!l.T){if(!a||t.WTF)throw new Error("Unexpected record 0x"+c.toString(16))}}}),r}var J9="application/vnd.ms-office.vbaProject";function Z9(e){var t=rt.utils.cfb_new({root:"R"});return e.FullPaths.forEach(function(r,n){if(!(r.slice(-1)==="/"||!r.match(/_VBA_PROJECT_CUR/))){var s=r.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");rt.utils.cfb_add(t,s,e.FileIndex[n].content)}}),rt.write(t)}function eV(){return{"!type":"dialog"}}function tV(){return{"!type":"dialog"}}function rV(){return{"!type":"macro"}}function nV(){return{"!type":"macro"}}var Qo=function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,t={r:0,c:0};function r(n,s,a,i){var o=!1,l=!1;a.length==0?l=!0:a.charAt(0)=="["&&(l=!0,a=a.slice(1,-1)),i.length==0?o=!0:i.charAt(0)=="["&&(o=!0,i=i.slice(1,-1));var c=a.length>0?parseInt(a,10)|0:0,u=i.length>0?parseInt(i,10)|0:0;return o?u+=t.c:--u,l?c+=t.r:--c,s+(o?"":"$")+sr(u)+(l?"":"$")+Ar(c)}return function(s,a){return t=a,s.replace(e,r)}}(),uI=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,sV=function(){return function(t,r){return t.replace(uI,function(n,s,a,i,o,l){var c=nx(i)-(a?0:r.c),u=rx(l)-(o?0:r.r),d=u==0?"":o?u+1:"["+u+"]",m=c==0?"":a?c+1:"["+c+"]";return s+"R"+d+"C"+m})}}();function fI(e,t){return e.replace(uI,function(r,n,s,a,i,o){return n+(s=="$"?s+a:sr(nx(a)+t.c))+(i=="$"?i+o:Ar(rx(o)+t.r))})}function aV(e,t,r){var n=Il(t),s=n.s,a=Qr(r),i={r:a.r-s.r,c:a.c-s.c};return fI(e,i)}function iV(e){return e.length!=1}function Fw(e){return e.replace(/_xlfn\./g,"")}function Kt(e){e.l+=1}function fi(e,t){var r=e.read_shift(2);return[r&16383,r>>14&1,r>>15&1]}function hI(e,t,r){var n=2;if(r){if(r.biff>=2&&r.biff<=5)return dI(e);r.biff==12&&(n=4)}var s=e.read_shift(n),a=e.read_shift(n),i=fi(e),o=fi(e);return{s:{r:s,c:i[0],cRel:i[1],rRel:i[2]},e:{r:a,c:o[0],cRel:o[1],rRel:o[2]}}}function dI(e){var t=fi(e),r=fi(e),n=e.read_shift(1),s=e.read_shift(1);return{s:{r:t[0],c:n,cRel:t[1],rRel:t[2]},e:{r:r[0],c:s,cRel:r[1],rRel:r[2]}}}function oV(e,t,r){if(r.biff<8)return dI(e);var n=e.read_shift(r.biff==12?4:2),s=e.read_shift(r.biff==12?4:2),a=fi(e),i=fi(e);return{s:{r:n,c:a[0],cRel:a[1],rRel:a[2]},e:{r:s,c:i[0],cRel:i[1],rRel:i[2]}}}function mI(e,t,r){if(r&&r.biff>=2&&r.biff<=5)return lV(e);var n=e.read_shift(r&&r.biff==12?4:2),s=fi(e);return{r:n,c:s[0],cRel:s[1],rRel:s[2]}}function lV(e){var t=fi(e),r=e.read_shift(1);return{r:t[0],c:r,cRel:t[1],rRel:t[2]}}function cV(e){var t=e.read_shift(2),r=e.read_shift(2);return{r:t,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function uV(e,t,r){var n=r&&r.biff?r.biff:8;if(n>=2&&n<=5)return fV(e);var s=e.read_shift(n>=12?4:2),a=e.read_shift(2),i=(a&16384)>>14,o=(a&32768)>>15;if(a&=16383,o==1)for(;s>524287;)s-=1048576;if(i==1)for(;a>8191;)a=a-16384;return{r:s,c:a,cRel:i,rRel:o}}function fV(e){var t=e.read_shift(2),r=e.read_shift(1),n=(t&32768)>>15,s=(t&16384)>>14;return t&=16383,n==1&&t>=8192&&(t=t-16384),s==1&&r>=128&&(r=r-256),{r:t,c:r,cRel:s,rRel:n}}function hV(e,t,r){var n=(e[e.l++]&96)>>5,s=hI(e,r.biff>=2&&r.biff<=5?6:8,r);return[n,s]}function dV(e,t,r){var n=(e[e.l++]&96)>>5,s=e.read_shift(2,"i"),a=8;if(r)switch(r.biff){case 5:e.l+=12,a=6;break;case 12:a=12;break}var i=hI(e,a,r);return[n,s,i]}function mV(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r&&r.biff>8?12:r.biff<8?6:8,[n]}function pV(e,t,r){var n=(e[e.l++]&96)>>5,s=e.read_shift(2),a=8;if(r)switch(r.biff){case 5:e.l+=12,a=6;break;case 12:a=12;break}return e.l+=a,[n,s]}function gV(e,t,r){var n=(e[e.l++]&96)>>5,s=oV(e,t-1,r);return[n,s]}function vV(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r.biff==2?6:r.biff==12?14:7,[n]}function Ow(e){var t=e[e.l+1]&1,r=1;return e.l+=4,[t,r]}function xV(e,t,r){e.l+=2;for(var n=e.read_shift(r&&r.biff==2?1:2),s=[],a=0;a<=n;++a)s.push(e.read_shift(r&&r.biff==2?1:2));return s}function yV(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function _V(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function wV(e){var t=e[e.l+1]&255?1:0;return e.l+=2,[t,e.read_shift(2)]}function EV(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=r&&r.biff==2?3:4,[n]}function pI(e){var t=e.read_shift(1),r=e.read_shift(1);return[t,r]}function TV(e){return e.read_shift(2),pI(e)}function kV(e){return e.read_shift(2),pI(e)}function SV(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var s=mI(e,0,r);return[n,s]}function AV(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var s=uV(e,0,r);return[n,s]}function IV(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var s=e.read_shift(2);r&&r.biff==5&&(e.l+=12);var a=mI(e,0,r);return[n,s,a]}function CV(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var s=e.read_shift(r&&r.biff<=3?1:2);return[NU[s],xI[s],n]}function NV(e,t,r){var n=e[e.l++],s=e.read_shift(1),a=r&&r.biff<=3?[n==88?-1:0,e.read_shift(1)]:RV(e);return[s,(a[0]===0?xI:CU)[a[1]]]}function RV(e){return[e[e.l+1]>>7,e.read_shift(2)&32767]}function bV(e,t,r){e.l+=r&&r.biff==2?3:4}function PV(e,t,r){if(e.l++,r&&r.biff==12)return[e.read_shift(4,"i"),0];var n=e.read_shift(2),s=e.read_shift(r&&r.biff==2?1:2);return[n,s]}function DV(e){return e.l++,uo[e.read_shift(1)]}function FV(e){return e.l++,e.read_shift(2)}function OV(e){return e.l++,e.read_shift(1)!==0}function MV(e){return e.l++,Ur(e)}function LV(e,t,r){return e.l++,Uu(e,t-1,r)}function jV(e,t){var r=[e.read_shift(1)];if(t==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=zt(e,1)?"TRUE":"FALSE",t!=12&&(e.l+=7);break;case 37:case 16:r[1]=uo[e[e.l]],e.l+=t==12?4:8;break;case 0:e.l+=8;break;case 1:r[1]=Ur(e);break;case 2:r[1]=fo(e,0,{biff:t>0&&t<8?2:t});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function VV(e,t,r){for(var n=e.read_shift(r.biff==12?4:2),s=[],a=0;a!=n;++a)s.push((r.biff==12?co:s0)(e));return s}function UV(e,t,r){var n=0,s=0;r.biff==12?(n=e.read_shift(4),s=e.read_shift(4)):(s=1+e.read_shift(1),n=1+e.read_shift(2)),r.biff>=2&&r.biff<8&&(--n,--s==0&&(s=256));for(var a=0,i=[];a!=n&&(i[a]=[]);++a)for(var o=0;o!=s;++o)i[a][o]=jV(e,r.biff);return i}function BV(e,t,r){var n=e.read_shift(1)>>>5&3,s=!r||r.biff>=8?4:2,a=e.read_shift(s);switch(r.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[n,0,a]}function zV(e,t,r){if(r.biff==5)return $V(e);var n=e.read_shift(1)>>>5&3,s=e.read_shift(2),a=e.read_shift(4);return[n,s,a]}function $V(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2,"i");e.l+=8;var n=e.read_shift(2);return e.l+=12,[t,r,n]}function WV(e,t,r){var n=e.read_shift(1)>>>5&3;e.l+=r&&r.biff==2?3:4;var s=e.read_shift(r&&r.biff==2?1:2);return[n,s]}function HV(e,t,r){var n=e.read_shift(1)>>>5&3,s=e.read_shift(r&&r.biff==2?1:2);return[n,s]}function GV(e,t,r){var n=e.read_shift(1)>>>5&3;return e.l+=4,r.biff<8&&e.l--,r.biff==12&&(e.l+=2),[n]}function KV(e,t,r){var n=(e[e.l++]&96)>>5,s=e.read_shift(2),a=4;if(r)switch(r.biff){case 5:a=15;break;case 12:a=6;break}return e.l+=a,[n,s]}var qV=Gr,XV=Gr,YV=Gr;function zu(e,t,r){return e.l+=2,[cV(e)]}function fx(e){return e.l+=6,[]}var QV=zu,JV=fx,ZV=fx,eU=zu;function gI(e){return e.l+=2,[Yt(e),e.read_shift(2)&1]}var tU=zu,rU=gI,nU=fx,sU=zu,aU=zu,iU=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function oU(e){e.l+=2;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),s=e.read_shift(2),a=e.read_shift(2),i=iU[r>>2&31];return{ixti:t,coltype:r&3,rt:i,idx:n,c:s,C:a}}function lU(e){return e.l+=2,[e.read_shift(4)]}function cU(e,t,r){return e.l+=5,e.l+=2,e.l+=r.biff==2?1:4,["PTGSHEET"]}function uU(e,t,r){return e.l+=r.biff==2?4:5,["PTGENDSHEET"]}function fU(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function hU(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function dU(e){return e.l+=4,[0,0]}var Mw={1:{n:"PtgExp",f:PV},2:{n:"PtgTbl",f:YV},3:{n:"PtgAdd",f:Kt},4:{n:"PtgSub",f:Kt},5:{n:"PtgMul",f:Kt},6:{n:"PtgDiv",f:Kt},7:{n:"PtgPower",f:Kt},8:{n:"PtgConcat",f:Kt},9:{n:"PtgLt",f:Kt},10:{n:"PtgLe",f:Kt},11:{n:"PtgEq",f:Kt},12:{n:"PtgGe",f:Kt},13:{n:"PtgGt",f:Kt},14:{n:"PtgNe",f:Kt},15:{n:"PtgIsect",f:Kt},16:{n:"PtgUnion",f:Kt},17:{n:"PtgRange",f:Kt},18:{n:"PtgUplus",f:Kt},19:{n:"PtgUminus",f:Kt},20:{n:"PtgPercent",f:Kt},21:{n:"PtgParen",f:Kt},22:{n:"PtgMissArg",f:Kt},23:{n:"PtgStr",f:LV},26:{n:"PtgSheet",f:cU},27:{n:"PtgEndSheet",f:uU},28:{n:"PtgErr",f:DV},29:{n:"PtgBool",f:OV},30:{n:"PtgInt",f:FV},31:{n:"PtgNum",f:MV},32:{n:"PtgArray",f:vV},33:{n:"PtgFunc",f:CV},34:{n:"PtgFuncVar",f:NV},35:{n:"PtgName",f:BV},36:{n:"PtgRef",f:SV},37:{n:"PtgArea",f:hV},38:{n:"PtgMemArea",f:WV},39:{n:"PtgMemErr",f:qV},40:{n:"PtgMemNoMem",f:XV},41:{n:"PtgMemFunc",f:HV},42:{n:"PtgRefErr",f:GV},43:{n:"PtgAreaErr",f:mV},44:{n:"PtgRefN",f:AV},45:{n:"PtgAreaN",f:gV},46:{n:"PtgMemAreaN",f:fU},47:{n:"PtgMemNoMemN",f:hU},57:{n:"PtgNameX",f:zV},58:{n:"PtgRef3d",f:IV},59:{n:"PtgArea3d",f:dV},60:{n:"PtgRefErr3d",f:KV},61:{n:"PtgAreaErr3d",f:pV},255:{}},mU={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},pU={1:{n:"PtgElfLel",f:gI},2:{n:"PtgElfRw",f:sU},3:{n:"PtgElfCol",f:QV},6:{n:"PtgElfRwV",f:aU},7:{n:"PtgElfColV",f:eU},10:{n:"PtgElfRadical",f:tU},11:{n:"PtgElfRadicalS",f:nU},13:{n:"PtgElfColS",f:JV},15:{n:"PtgElfColSV",f:ZV},16:{n:"PtgElfRadicalLel",f:rU},25:{n:"PtgList",f:oU},29:{n:"PtgSxName",f:lU},255:{}},gU={0:{n:"PtgAttrNoop",f:dU},1:{n:"PtgAttrSemi",f:EV},2:{n:"PtgAttrIf",f:_V},4:{n:"PtgAttrChoose",f:xV},8:{n:"PtgAttrGoto",f:yV},16:{n:"PtgAttrSum",f:bV},32:{n:"PtgAttrBaxcel",f:Ow},33:{n:"PtgAttrBaxcel",f:Ow},64:{n:"PtgAttrSpace",f:TV},65:{n:"PtgAttrSpaceSemi",f:kV},128:{n:"PtgAttrIfError",f:wV},255:{}};function $u(e,t,r,n){if(n.biff<8)return Gr(e,t);for(var s=e.l+t,a=[],i=0;i!==r.length;++i)switch(r[i][0]){case"PtgArray":r[i][1]=UV(e,0,n),a.push(r[i][1]);break;case"PtgMemArea":r[i][2]=VV(e,r[i][1],n),a.push(r[i][2]);break;case"PtgExp":n&&n.biff==12&&(r[i][1][1]=e.read_shift(4),a.push(r[i][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[i][0]}return t=s-e.l,t!==0&&a.push(Gr(e,t)),a}function Wu(e,t,r){for(var n=e.l+t,s,a,i=[];n!=e.l;)t=n-e.l,a=e[e.l],s=Mw[a]||Mw[mU[a]],(a===24||a===25)&&(s=(a===24?pU:gU)[e[e.l+1]]),!s||!s.f?Gr(e,t):i.push([s.n,s.f(e,t,r)]);return i}function vU(e){for(var t=[],r=0;r<e.length;++r){for(var n=e[r],s=[],a=0;a<n.length;++a){var i=n[a];if(i)switch(i[0]){case 2:s.push('"'+i[1].replace(/"/g,'""')+'"');break;default:s.push(i[1])}else s.push("")}t.push(s.join(","))}return t.join(";")}var xU={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function yU(e,t){if(!e&&!(t&&t.biff<=5&&t.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}function vI(e,t,r){if(!e)return"SH33TJSERR0";if(r.biff>8&&(!e.XTI||!e.XTI[t]))return e.SheetNames[t];if(!e.XTI)return"SH33TJSERR6";var n=e.XTI[t];if(r.biff<8)return t>1e4&&(t-=65536),t<0&&(t=-t),t==0?"":e.XTI[t-1];if(!n)return"SH33TJSERR1";var s="";if(r.biff>8)switch(e[n[0]][0]){case 357:return s=n[1]==-1?"#REF":e.SheetNames[n[1]],n[1]==n[2]?s:s+":"+e.SheetNames[n[2]];case 358:return r.SID!=null?e.SheetNames[r.SID]:"SH33TJSSAME"+e[n[0]][0];case 355:default:return"SH33TJSSRC"+e[n[0]][0]}switch(e[n[0]][0][0]){case 1025:return s=n[1]==-1?"#REF":e.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?s:s+":"+e.SheetNames[n[2]];case 14849:return e[n[0]].slice(1).map(function(a){return a.Name}).join(";;");default:return e[n[0]][0][3]?(s=n[1]==-1?"#REF":e[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?s:s+":"+e[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function Lw(e,t,r){var n=vI(e,t,r);return n=="#REF"?n:yU(n,r)}function Lr(e,t,r,n,s){var a=s&&s.biff||8,i={s:{c:0,r:0}},o=[],l,c,u,d=0,m=0,p,g="";if(!e[0]||!e[0][0])return"";for(var x=-1,w="",k=0,T=e[0].length;k<T;++k){var E=e[0][k];switch(E[0]){case"PtgUminus":o.push("-"+o.pop());break;case"PtgUplus":o.push("+"+o.pop());break;case"PtgPercent":o.push(o.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(l=o.pop(),c=o.pop(),x>=0){switch(e[0][x][1][0]){case 0:w=Ut(" ",e[0][x][1][1]);break;case 1:w=Ut("\r",e[0][x][1][1]);break;default:if(w="",s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][x][1][0])}c=c+w,x=-1}o.push(c+xU[E[0]]+l);break;case"PtgIsect":l=o.pop(),c=o.pop(),o.push(c+" "+l);break;case"PtgUnion":l=o.pop(),c=o.pop(),o.push(c+","+l);break;case"PtgRange":l=o.pop(),c=o.pop(),o.push(c+":"+l);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":u=Sc(E[1][1],i,s),o.push(Ac(u,a));break;case"PtgRefN":u=r?Sc(E[1][1],r,s):E[1][1],o.push(Ac(u,a));break;case"PtgRef3d":d=E[1][1],u=Sc(E[1][2],i,s),g=Lw(n,d,s),o.push(g+"!"+Ac(u,a));break;case"PtgFunc":case"PtgFuncVar":var N=E[1][0],M=E[1][1];N||(N=0),N&=127;var O=N==0?[]:o.slice(-N);o.length-=N,M==="User"&&(M=O.shift()),o.push(M+"("+O.join(",")+")");break;case"PtgBool":o.push(E[1]?"TRUE":"FALSE");break;case"PtgInt":o.push(E[1]);break;case"PtgNum":o.push(String(E[1]));break;case"PtgStr":o.push('"'+E[1].replace(/"/g,'""')+'"');break;case"PtgErr":o.push(E[1]);break;case"PtgAreaN":p=vw(E[1][1],r?{s:r}:i,s),o.push(tm(p,s));break;case"PtgArea":p=vw(E[1][1],i,s),o.push(tm(p,s));break;case"PtgArea3d":d=E[1][1],p=E[1][2],g=Lw(n,d,s),o.push(g+"!"+tm(p,s));break;case"PtgAttrSum":o.push("SUM("+o.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":m=E[1][2];var v=(n.names||[])[m-1]||(n[0]||[])[m],_=v?v.Name:"SH33TJSNAME"+String(m);_&&_.slice(0,6)=="_xlfn."&&!s.xlfn&&(_=_.slice(6)),o.push(_);break;case"PtgNameX":var S=E[1][1];m=E[1][2];var I;if(s.biff<=5)S<0&&(S=-S),n[S]&&(I=n[S][m]);else{var b="";if(((n[S]||[])[0]||[])[0]==14849||(((n[S]||[])[0]||[])[0]==1025?n[S][m]&&n[S][m].itab>0&&(b=n.SheetNames[n[S][m].itab-1]+"!"):b=n.SheetNames[m-1]+"!"),n[S]&&n[S][m])b+=n[S][m].Name;else if(n[0]&&n[0][m])b+=n[0][m].Name;else{var P=(vI(n,S,s)||"").split(";;");P[m-1]?b=P[m-1]:b+="SH33TJSERRX"}o.push(b);break}I||(I={Name:"SH33TJSERRY"}),o.push(I.Name);break;case"PtgParen":var R="(",ue=")";if(x>=0){switch(w="",e[0][x][1][0]){case 2:R=Ut(" ",e[0][x][1][1])+R;break;case 3:R=Ut("\r",e[0][x][1][1])+R;break;case 4:ue=Ut(" ",e[0][x][1][1])+ue;break;case 5:ue=Ut("\r",e[0][x][1][1])+ue;break;default:if(s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][x][1][0])}x=-1}o.push(R+o.pop()+ue);break;case"PtgRefErr":o.push("#REF!");break;case"PtgRefErr3d":o.push("#REF!");break;case"PtgExp":u={c:E[1][1],r:E[1][0]};var le={c:r.c,r:r.r};if(n.sharedf[Ue(u)]){var he=n.sharedf[Ue(u)];o.push(Lr(he,i,le,n,s))}else{var pe=!1;for(l=0;l!=n.arrayf.length;++l)if(c=n.arrayf[l],!(u.c<c[0].s.c||u.c>c[0].e.c)&&!(u.r<c[0].s.r||u.r>c[0].e.r)){o.push(Lr(c[1],i,le,n,s)),pe=!0;break}pe||o.push(E[1])}break;case"PtgArray":o.push("{"+vU(E[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":x=k;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":o.push("");break;case"PtgAreaErr":o.push("#REF!");break;case"PtgAreaErr3d":o.push("#REF!");break;case"PtgList":o.push("Table"+E[1].idx+"[#"+E[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(E));default:throw new Error("Unrecognized Formula Token: "+String(E))}var ee=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(s.biff!=3&&x>=0&&ee.indexOf(e[0][k][0])==-1){E=e[0][x];var H=!0;switch(E[1][0]){case 4:H=!1;case 0:w=Ut(" ",E[1][1]);break;case 5:H=!1;case 1:w=Ut("\r",E[1][1]);break;default:if(w="",s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+E[1][0])}o.push((H?w:"")+o.pop()+(H?"":w)),x=-1}}if(o.length>1&&s.WTF)throw new Error("bad formula stack");return o[0]}function _U(e,t,r){var n=e.l+t,s=r.biff==2?1:2,a,i=e.read_shift(s);if(i==65535)return[[],Gr(e,t-2)];var o=Wu(e,i,r);return t!==i+s&&(a=$u(e,t-i-s,o,r)),e.l=n,[o,a]}function wU(e,t,r){var n=e.l+t,s=r.biff==2?1:2,a,i=e.read_shift(s);if(i==65535)return[[],Gr(e,t-2)];var o=Wu(e,i,r);return t!==i+s&&(a=$u(e,t-i-s,o,r)),e.l=n,[o,a]}function EU(e,t,r,n){var s=e.l+t,a=Wu(e,n,r),i;return s!==e.l&&(i=$u(e,s-e.l,a,r)),[a,i]}function TU(e,t,r){var n=e.l+t,s,a=e.read_shift(2),i=Wu(e,a,r);return a==65535?[[],Gr(e,t-2)]:(t!==a+2&&(s=$u(e,n-a-2,i,r)),[i,s])}function kU(e){var t;if(Zs(e,e.l+6)!==65535)return[Ur(e),"n"];switch(e[e.l]){case 0:return e.l+=8,["String","s"];case 1:return t=e[e.l+2]===1,e.l+=8,[t,"b"];case 2:return t=e[e.l+2],e.l+=8,[t,"e"];case 3:return e.l+=8,["","s"]}return[]}function sm(e,t,r){var n=e.l+t,s=Ms(e);r.biff==2&&++e.l;var a=kU(e),i=e.read_shift(1);r.biff!=2&&(e.read_shift(1),r.biff>=5&&e.read_shift(4));var o=wU(e,n-e.l,r);return{cell:s,val:a[0],formula:o,shared:i>>3&1,tt:a[1]}}function a0(e,t,r){var n=e.read_shift(4),s=Wu(e,n,r),a=e.read_shift(4),i=a>0?$u(e,a,s,r):null;return[s,i]}var SU=a0,i0=a0,AU=a0,IU=a0,CU={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},xI={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},NU={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function jw(e){return e.slice(0,3)=="of:"&&(e=e.slice(3)),e.charCodeAt(0)==61&&(e=e.slice(1),e.charCodeAt(0)==61&&(e=e.slice(1))),e=e.replace(/COM\.MICROSOFT\./g,""),e=e.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(t,r){return r.replace(/\./g,"")}),e=e.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),e.replace(/[;~]/g,",").replace(/\|/g,";")}function am(e){var t=e.split(":"),r=t[0].split(".")[0];return[r,t[0].split(".")[1]+(t.length>1?":"+(t[1].split(".")[1]||t[1].split(".")[0]):"")]}var Rc={},Jo={};function bc(e,t){if(e){var r=[.7,.7,.75,.75,.3,.3];t=="xlml"&&(r=[1,1,1,1,.5,.5]),e.left==null&&(e.left=r[0]),e.right==null&&(e.right=r[1]),e.top==null&&(e.top=r[2]),e.bottom==null&&(e.bottom=r[3]),e.header==null&&(e.header=r[4]),e.footer==null&&(e.footer=r[5])}}function yI(e,t,r,n,s,a){try{n.cellNF&&(e.z=ze[t])}catch(o){if(n.WTF)throw o}if(!(e.t==="z"&&!n.cellStyles)){if(e.t==="d"&&typeof e.v=="string"&&(e.v=mr(e.v)),(!n||n.cellText!==!1)&&e.t!=="z")try{if(ze[t]==null&&ji(R6[t]||"General",t),e.t==="e")e.w=e.w||uo[e.v];else if(t===0)if(e.t==="n")(e.v|0)===e.v?e.w=e.v.toString(10):e.w=cu(e.v);else if(e.t==="d"){var i=en(e.v);(i|0)===i?e.w=i.toString(10):e.w=cu(i)}else{if(e.v===void 0)return"";e.w=Qi(e.v,Jo)}else e.t==="d"?e.w=Wn(t,en(e.v),Jo):e.w=Wn(t,e.v,Jo)}catch(o){if(n.WTF)throw o}if(n.cellStyles&&r!=null)try{e.s=a.Fills[r],e.s.fgColor&&e.s.fgColor.theme&&!e.s.fgColor.rgb&&(e.s.fgColor.rgb=id(s.themeElements.clrScheme[e.s.fgColor.theme].rgb,e.s.fgColor.tint||0),n.WTF&&(e.s.fgColor.raw_rgb=s.themeElements.clrScheme[e.s.fgColor.theme].rgb)),e.s.bgColor&&e.s.bgColor.theme&&(e.s.bgColor.rgb=id(s.themeElements.clrScheme[e.s.bgColor.theme].rgb,e.s.bgColor.tint||0),n.WTF&&(e.s.bgColor.raw_rgb=s.themeElements.clrScheme[e.s.bgColor.theme].rgb))}catch(o){if(n.WTF&&a.Fills)throw o}}}function RU(e,t){var r=Bt(t);r.s.r<=r.e.r&&r.s.c<=r.e.c&&r.s.r>=0&&r.s.c>=0&&(e["!ref"]=nt(r))}var bU=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,PU=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,DU=/<(?:\w:)?hyperlink [^>]*>/mg,FU=/"(\w*:\w*)"/,OU=/<(?:\w:)?col\b[^>]*[\/]?>/g,MU=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,LU=/<(?:\w:)?pageMargins[^>]*\/>/g,_I=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,jU=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,VU=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function UU(e,t,r,n,s,a,i){if(!e)return e;n||(n={"!id":{}});var o=t.dense?[]:{},l={s:{r:2e6,c:2e6},e:{r:0,c:0}},c="",u="",d=e.match(PU);d?(c=e.slice(0,d.index),u=e.slice(d.index+d[0].length)):c=u=e;var m=c.match(_I);m?hx(m[0],o,s,r):(m=c.match(jU))&&BU(m[0],m[1]||"",o,s,r);var p=(c.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(p>0){var g=c.slice(p,p+50).match(FU);g&&RU(o,g[1])}var x=c.match(VU);x&&x[1]&&KU(x[1],s);var w=[];if(t.cellStyles){var k=c.match(OU);k&&WU(w,k)}d&&qU(d[1],o,t,l,a,i);var T=u.match(MU);T&&(o["!autofilter"]=HU(T[0]));var E=[],N=u.match(bU);if(N)for(p=0;p!=N.length;++p)E[p]=Bt(N[p].slice(N[p].indexOf('"')+1));var M=u.match(DU);M&&zU(o,M,n);var O=u.match(LU);if(O&&(o["!margins"]=$U(Oe(O[0]))),!o["!ref"]&&l.e.c>=l.s.c&&l.e.r>=l.s.r&&(o["!ref"]=nt(l)),t.sheetRows>0&&o["!ref"]){var v=Bt(o["!ref"]);t.sheetRows<=+v.e.r&&(v.e.r=t.sheetRows-1,v.e.r>l.e.r&&(v.e.r=l.e.r),v.e.r<v.s.r&&(v.s.r=v.e.r),v.e.c>l.e.c&&(v.e.c=l.e.c),v.e.c<v.s.c&&(v.s.c=v.e.c),o["!fullref"]=o["!ref"],o["!ref"]=nt(v))}return w.length>0&&(o["!cols"]=w),E.length>0&&(o["!merges"]=E),o}function hx(e,t,r,n){var s=Oe(e);r.Sheets[n]||(r.Sheets[n]={}),s.codeName&&(r.Sheets[n].CodeName=ot(Et(s.codeName)))}function BU(e,t,r,n,s){hx(e.slice(0,e.indexOf(">")),r,n,s)}function zU(e,t,r){for(var n=Array.isArray(e),s=0;s!=t.length;++s){var a=Oe(Et(t[s]),!0);if(!a.ref)return;var i=((r||{})["!id"]||[])[a.id];i?(a.Target=i.Target,a.location&&(a.Target+="#"+ot(a.location))):(a.Target="#"+ot(a.location),i={Target:a.Target,TargetMode:"Internal"}),a.Rel=i,a.tooltip&&(a.Tooltip=a.tooltip,delete a.tooltip);for(var o=Bt(a.ref),l=o.s.r;l<=o.e.r;++l)for(var c=o.s.c;c<=o.e.c;++c){var u=Ue({c,r:l});n?(e[l]||(e[l]=[]),e[l][c]||(e[l][c]={t:"z",v:void 0}),e[l][c].l=a):(e[u]||(e[u]={t:"z",v:void 0}),e[u].l=a)}}}function $U(e){var t={};return["left","right","top","bottom","header","footer"].forEach(function(r){e[r]&&(t[r]=parseFloat(e[r]))}),t}function WU(e,t){for(var r=!1,n=0;n!=t.length;++n){var s=Oe(t[n],!0);s.hidden&&(s.hidden=bt(s.hidden));var a=parseInt(s.min,10)-1,i=parseInt(s.max,10)-1;for(s.outlineLevel&&(s.level=+s.outlineLevel||0),delete s.min,delete s.max,s.width=+s.width,!r&&s.width&&(r=!0,ux(s.width)),vl(s);a<=i;)e[a++]=Sr(s)}}function HU(e){var t={ref:(e.match(/ref="([^"]*)"/)||[])[1]};return t}var GU=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function KU(e,t){t.Views||(t.Views=[{}]),(e.match(GU)||[]).forEach(function(r,n){var s=Oe(r);t.Views[n]||(t.Views[n]={}),+s.zoomScale&&(t.Views[n].zoom=+s.zoomScale),bt(s.rightToLeft)&&(t.Views[n].RTL=!0)})}var qU=function(){var e=/<(?:\w+:)?c[ \/>]/,t=/<\/(?:\w+:)?row>/,r=/r=["']([^"']*)["']/,n=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,s=/ref=["']([^"']*)["']/,a=uu("v"),i=uu("f");return function(l,c,u,d,m,p){for(var g=0,x="",w=[],k=[],T=0,E=0,N=0,M="",O,v,_=0,S=0,I,b,P=0,R=0,ue=Array.isArray(p.CellXf),le,he=[],pe=[],ee=Array.isArray(c),H=[],se={},ce=!1,B=!!u.sheetStubs,K=l.split(t),X=0,G=K.length;X!=G;++X){x=K[X].trim();var ie=x.length;if(ie!==0){var ge=0;e:for(g=0;g<ie;++g)switch(x[g]){case">":if(x[g-1]!="/"){++g;break e}if(u&&u.cellStyles){if(v=Oe(x.slice(ge,g),!0),_=v.r!=null?parseInt(v.r,10):_+1,S=-1,u.sheetRows&&u.sheetRows<_)continue;se={},ce=!1,v.ht&&(ce=!0,se.hpt=parseFloat(v.ht),se.hpx=mu(se.hpt)),v.hidden=="1"&&(ce=!0,se.hidden=!0),v.outlineLevel!=null&&(ce=!0,se.level=+v.outlineLevel),ce&&(H[_-1]=se)}break;case"<":ge=g;break}if(ge>=g)break;if(v=Oe(x.slice(ge,g),!0),_=v.r!=null?parseInt(v.r,10):_+1,S=-1,!(u.sheetRows&&u.sheetRows<_)){d.s.r>_-1&&(d.s.r=_-1),d.e.r<_-1&&(d.e.r=_-1),u&&u.cellStyles&&(se={},ce=!1,v.ht&&(ce=!0,se.hpt=parseFloat(v.ht),se.hpx=mu(se.hpt)),v.hidden=="1"&&(ce=!0,se.hidden=!0),v.outlineLevel!=null&&(ce=!0,se.level=+v.outlineLevel),ce&&(H[_-1]=se)),w=x.slice(g).split(e);for(var Ie=0;Ie!=w.length&&w[Ie].trim().charAt(0)=="<";++Ie);for(w=w.slice(Ie),g=0;g!=w.length;++g)if(x=w[g].trim(),x.length!==0){if(k=x.match(r),T=g,E=0,N=0,x="<c "+(x.slice(0,1)=="<"?">":"")+x,k!=null&&k.length===2){for(T=0,M=k[1],E=0;E!=M.length&&!((N=M.charCodeAt(E)-64)<1||N>26);++E)T=26*T+N;--T,S=T}else++S;for(E=0;E!=x.length&&x.charCodeAt(E)!==62;++E);if(++E,v=Oe(x.slice(0,E),!0),v.r||(v.r=Ue({r:_-1,c:S})),M=x.slice(E),O={t:""},(k=M.match(a))!=null&&k[1]!==""&&(O.v=ot(k[1])),u.cellFormula){if((k=M.match(i))!=null&&k[1]!==""){if(O.f=ot(Et(k[1])).replace(/\r\n/g,`
`),u.xlfn||(O.f=Fw(O.f)),k[0].indexOf('t="array"')>-1)O.F=(M.match(s)||[])[1],O.F.indexOf(":")>-1&&he.push([Bt(O.F),O.F]);else if(k[0].indexOf('t="shared"')>-1){b=Oe(k[0]);var Te=ot(Et(k[1]));u.xlfn||(Te=Fw(Te)),pe[parseInt(b.si,10)]=[b,Te,v.r]}}else(k=M.match(/<f[^>]*\/>/))&&(b=Oe(k[0]),pe[b.si]&&(O.f=aV(pe[b.si][1],pe[b.si][2],v.r)));var ye=Qr(v.r);for(E=0;E<he.length;++E)ye.r>=he[E][0].s.r&&ye.r<=he[E][0].e.r&&ye.c>=he[E][0].s.c&&ye.c<=he[E][0].e.c&&(O.F=he[E][1])}if(v.t==null&&O.v===void 0)if(O.f||O.F)O.v=0,O.t="n";else if(B)O.t="z";else continue;else O.t=v.t||"n";switch(d.s.c>S&&(d.s.c=S),d.e.c<S&&(d.e.c=S),O.t){case"n":if(O.v==""||O.v==null){if(!B)continue;O.t="z"}else O.v=parseFloat(O.v);break;case"s":if(typeof O.v>"u"){if(!B)continue;O.t="z"}else I=Rc[parseInt(O.v,10)],O.v=I.t,O.r=I.r,u.cellHTML&&(O.h=I.h);break;case"str":O.t="s",O.v=O.v!=null?Et(O.v):"",u.cellHTML&&(O.h=Zv(O.v));break;case"inlineStr":k=M.match(n),O.t="s",k!=null&&(I=cx(k[1]))?(O.v=I.t,u.cellHTML&&(O.h=I.h)):O.v="";break;case"b":O.v=bt(O.v);break;case"d":u.cellDates?O.v=mr(O.v,1):(O.v=en(mr(O.v,1)),O.t="n");break;case"e":(!u||u.cellText!==!1)&&(O.w=O.v),O.v=BA[O.v];break}if(P=R=0,le=null,ue&&v.s!==void 0&&(le=p.CellXf[v.s],le!=null&&(le.numFmtId!=null&&(P=le.numFmtId),u.cellStyles&&le.fillId!=null&&(R=le.fillId))),yI(O,P,R,u,m,p),u.cellDates&&ue&&O.t=="n"&&Al(ze[P])&&(O.t="d",O.v=n0(O.v)),v.cm&&u.xlmeta){var $e=(u.xlmeta.Cell||[])[+v.cm-1];$e&&$e.type=="XLDAPR"&&(O.D=!0)}if(ee){var W=Qr(v.r);c[W.r]||(c[W.r]=[]),c[W.r][W.c]=O}else c[v.r]=O}}}}H.length>0&&(c["!rows"]=H)}}();function XU(e,t){var r={},n=e.l+t;r.r=e.read_shift(4),e.l+=4;var s=e.read_shift(2);e.l+=1;var a=e.read_shift(1);return e.l=n,a&7&&(r.level=a&7),a&16&&(r.hidden=!0),a&32&&(r.hpt=s/20),r}var YU=co;function QU(){}function JU(e,t){var r={},n=e[e.l];return++e.l,r.above=!(n&64),r.left=!(n&128),e.l+=18,r.name=_8(e),r}function ZU(e){var t=Hn(e);return[t]}function eB(e){var t=lo(e);return[t]}function tB(e){var t=Hn(e),r=e.read_shift(1);return[t,r,"b"]}function rB(e){var t=lo(e),r=e.read_shift(1);return[t,r,"b"]}function nB(e){var t=Hn(e),r=e.read_shift(1);return[t,r,"e"]}function sB(e){var t=lo(e),r=e.read_shift(1);return[t,r,"e"]}function aB(e){var t=Hn(e),r=e.read_shift(4);return[t,r,"s"]}function iB(e){var t=lo(e),r=e.read_shift(4);return[t,r,"s"]}function oB(e){var t=Hn(e),r=Ur(e);return[t,r,"n"]}function wI(e){var t=lo(e),r=Ur(e);return[t,r,"n"]}function lB(e){var t=Hn(e),r=ix(e);return[t,r,"n"]}function cB(e){var t=lo(e),r=ix(e);return[t,r,"n"]}function uB(e){var t=Hn(e),r=sx(e);return[t,r,"is"]}function fB(e){var t=Hn(e),r=$r(e);return[t,r,"str"]}function hB(e){var t=lo(e),r=$r(e);return[t,r,"str"]}function dB(e,t,r){var n=e.l+t,s=Hn(e);s.r=r["!row"];var a=e.read_shift(1),i=[s,a,"b"];if(r.cellFormula){e.l+=2;var o=i0(e,n-e.l,r);i[3]=Lr(o,null,s,r.supbooks,r)}else e.l=n;return i}function mB(e,t,r){var n=e.l+t,s=Hn(e);s.r=r["!row"];var a=e.read_shift(1),i=[s,a,"e"];if(r.cellFormula){e.l+=2;var o=i0(e,n-e.l,r);i[3]=Lr(o,null,s,r.supbooks,r)}else e.l=n;return i}function pB(e,t,r){var n=e.l+t,s=Hn(e);s.r=r["!row"];var a=Ur(e),i=[s,a,"n"];if(r.cellFormula){e.l+=2;var o=i0(e,n-e.l,r);i[3]=Lr(o,null,s,r.supbooks,r)}else e.l=n;return i}function gB(e,t,r){var n=e.l+t,s=Hn(e);s.r=r["!row"];var a=$r(e),i=[s,a,"str"];if(r.cellFormula){e.l+=2;var o=i0(e,n-e.l,r);i[3]=Lr(o,null,s,r.supbooks,r)}else e.l=n;return i}var vB=co;function xB(e,t){var r=e.l+t,n=co(e),s=ax(e),a=$r(e),i=$r(e),o=$r(e);e.l=r;var l={rfx:n,relId:s,loc:a,display:o};return i&&(l.Tooltip=i),l}function yB(){}function _B(e,t,r){var n=e.l+t,s=jA(e),a=e.read_shift(1),i=[s];if(i[2]=a,r.cellFormula){var o=SU(e,n-e.l,r);i[1]=o}else e.l=n;return i}function wB(e,t,r){var n=e.l+t,s=co(e),a=[s];if(r.cellFormula){var i=IU(e,n-e.l,r);a[1]=i,e.l=n}else e.l=n;return a}var EB=["left","right","top","bottom","header","footer"];function TB(e){var t={};return EB.forEach(function(r){t[r]=Ur(e)}),t}function kB(e){var t=e.read_shift(2);return e.l+=28,{RTL:t&32}}function SB(){}function AB(){}function IB(e,t,r,n,s,a,i){if(!e)return e;var o=t||{};n||(n={"!id":{}});var l=o.dense?[]:{},c,u={s:{r:2e6,c:2e6},e:{r:0,c:0}},d=!1,m=!1,p,g,x,w,k,T,E,N,M,O=[];o.biff=12,o["!row"]=0;var v=0,_=!1,S=[],I={},b=o.supbooks||s.supbooks||[[]];if(b.sharedf=I,b.arrayf=S,b.SheetNames=s.SheetNames||s.Sheets.map(function(ee){return ee.name}),!o.supbooks&&(o.supbooks=b,s.Names))for(var P=0;P<s.Names.length;++P)b[0][P+1]=s.Names[P];var R=[],ue=[],le=!1;cd[16]={n:"BrtShortReal",f:wI};var he;if(_a(e,function(H,se,ce){if(!m)switch(ce){case 148:c=H;break;case 0:p=H,o.sheetRows&&o.sheetRows<=p.r&&(m=!0),N=Ar(w=p.r),o["!row"]=p.r,(H.hidden||H.hpt||H.level!=null)&&(H.hpt&&(H.hpx=mu(H.hpt)),ue[H.r]=H);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(g={t:H[2]},H[2]){case"n":g.v=H[1];break;case"s":E=Rc[H[1]],g.v=E.t,g.r=E.r;break;case"b":g.v=!!H[1];break;case"e":g.v=H[1],o.cellText!==!1&&(g.w=uo[g.v]);break;case"str":g.t="s",g.v=H[1];break;case"is":g.t="s",g.v=H[1].t;break}if((x=i.CellXf[H[0].iStyleRef])&&yI(g,x.numFmtId,null,o,a,i),k=H[0].c==-1?k+1:H[0].c,o.dense?(l[w]||(l[w]=[]),l[w][k]=g):l[sr(k)+N]=g,o.cellFormula){for(_=!1,v=0;v<S.length;++v){var B=S[v];p.r>=B[0].s.r&&p.r<=B[0].e.r&&k>=B[0].s.c&&k<=B[0].e.c&&(g.F=nt(B[0]),_=!0)}!_&&H.length>3&&(g.f=H[3])}if(u.s.r>p.r&&(u.s.r=p.r),u.s.c>k&&(u.s.c=k),u.e.r<p.r&&(u.e.r=p.r),u.e.c<k&&(u.e.c=k),o.cellDates&&x&&g.t=="n"&&Al(ze[x.numFmtId])){var K=Di(g.v);K&&(g.t="d",g.v=new Date(K.y,K.m-1,K.d,K.H,K.M,K.S,K.u))}he&&(he.type=="XLDAPR"&&(g.D=!0),he=void 0);break;case 1:case 12:if(!o.sheetStubs||d)break;g={t:"z",v:void 0},k=H[0].c==-1?k+1:H[0].c,o.dense?(l[w]||(l[w]=[]),l[w][k]=g):l[sr(k)+N]=g,u.s.r>p.r&&(u.s.r=p.r),u.s.c>k&&(u.s.c=k),u.e.r<p.r&&(u.e.r=p.r),u.e.c<k&&(u.e.c=k),he&&(he.type=="XLDAPR"&&(g.D=!0),he=void 0);break;case 176:O.push(H);break;case 49:he=((o.xlmeta||{}).Cell||[])[H-1];break;case 494:var X=n["!id"][H.relId];for(X?(H.Target=X.Target,H.loc&&(H.Target+="#"+H.loc),H.Rel=X):H.relId==""&&(H.Target="#"+H.loc),w=H.rfx.s.r;w<=H.rfx.e.r;++w)for(k=H.rfx.s.c;k<=H.rfx.e.c;++k)o.dense?(l[w]||(l[w]=[]),l[w][k]||(l[w][k]={t:"z",v:void 0}),l[w][k].l=H):(T=Ue({c:k,r:w}),l[T]||(l[T]={t:"z",v:void 0}),l[T].l=H);break;case 426:if(!o.cellFormula)break;S.push(H),M=o.dense?l[w][k]:l[sr(k)+N],M.f=Lr(H[1],u,{r:p.r,c:k},b,o),M.F=nt(H[0]);break;case 427:if(!o.cellFormula)break;I[Ue(H[0].s)]=H[1],M=o.dense?l[w][k]:l[sr(k)+N],M.f=Lr(H[1],u,{r:p.r,c:k},b,o);break;case 60:if(!o.cellStyles)break;for(;H.e>=H.s;)R[H.e--]={width:H.w/256,hidden:!!(H.flags&1),level:H.level},le||(le=!0,ux(H.w/256)),vl(R[H.e+1]);break;case 161:l["!autofilter"]={ref:nt(H)};break;case 476:l["!margins"]=H;break;case 147:s.Sheets[r]||(s.Sheets[r]={}),H.name&&(s.Sheets[r].CodeName=H.name),(H.above||H.left)&&(l["!outline"]={above:H.above,left:H.left});break;case 137:s.Views||(s.Views=[{}]),s.Views[0]||(s.Views[0]={}),H.RTL&&(s.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:d=!0;break;case 36:d=!1;break;case 37:d=!0;break;case 38:d=!1;break;default:if(!se.T){if(!d||o.WTF)throw new Error("Unexpected record 0x"+ce.toString(16))}}},o),delete o.supbooks,delete o["!row"],!l["!ref"]&&(u.s.r<2e6||c&&(c.e.r>0||c.e.c>0||c.s.r>0||c.s.c>0))&&(l["!ref"]=nt(c||u)),o.sheetRows&&l["!ref"]){var pe=Bt(l["!ref"]);o.sheetRows<=+pe.e.r&&(pe.e.r=o.sheetRows-1,pe.e.r>u.e.r&&(pe.e.r=u.e.r),pe.e.r<pe.s.r&&(pe.s.r=pe.e.r),pe.e.c>u.e.c&&(pe.e.c=u.e.c),pe.e.c<pe.s.c&&(pe.s.c=pe.e.c),l["!fullref"]=l["!ref"],l["!ref"]=nt(pe))}return O.length>0&&(l["!merges"]=O),R.length>0&&(l["!cols"]=R),ue.length>0&&(l["!rows"]=ue),l}function CB(e){var t=[],r=e.match(/^<c:numCache>/),n;(e.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(a){var i=a.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);i&&(t[+i[1]]=r?+i[2]:i[2])});var s=ot((e.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(e.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(a){n=a.replace(/<.*?>/g,"")}),[t,s,n]}function NB(e,t,r,n,s,a){var i=a||{"!type":"chart"};if(!e)return a;var o=0,l=0,c="A",u={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(e.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(d){var m=CB(d);u.s.r=u.s.c=0,u.e.c=o,c=sr(o),m[0].forEach(function(p,g){i[c+Ar(g)]={t:"n",v:p,z:m[1]},l=g}),u.e.r<l&&(u.e.r=l),++o}),o>0&&(i["!ref"]=nt(u)),i}function RB(e,t,r,n,s){if(!e)return e;n||(n={"!id":{}});var a={"!type":"chart","!drawel":null,"!rel":""},i,o=e.match(_I);return o&&hx(o[0],a,s,r),(i=e.match(/drawing r:id="(.*?)"/))&&(a["!rel"]=i[1]),n["!id"][a["!rel"]]&&(a["!drawel"]=n["!id"][a["!rel"]]),a}function bB(e,t){e.l+=10;var r=$r(e);return{name:r}}function PB(e,t,r,n,s){if(!e)return e;n||(n={"!id":{}});var a={"!type":"chart","!drawel":null,"!rel":""},i=!1;return _a(e,function(l,c,u){switch(u){case 550:a["!rel"]=l;break;case 651:s.Sheets[r]||(s.Sheets[r]={}),l.name&&(s.Sheets[r].CodeName=l.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:i=!0;break;case 36:i=!1;break;case 37:break;case 38:break;default:if(!(c.T>0)){if(!(c.T<0)){if(!i||t.WTF)throw new Error("Unexpected record 0x"+u.toString(16))}}}},t),n["!id"][a["!rel"]]&&(a["!drawel"]=n["!id"][a["!rel"]]),a}var EI=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],DB=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],FB=[],OB=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function Vw(e,t){for(var r=0;r!=e.length;++r)for(var n=e[r],s=0;s!=t.length;++s){var a=t[s];if(n[a[0]]==null)n[a[0]]=a[1];else switch(a[2]){case"bool":typeof n[a[0]]=="string"&&(n[a[0]]=bt(n[a[0]]));break;case"int":typeof n[a[0]]=="string"&&(n[a[0]]=parseInt(n[a[0]],10));break}}}function Uw(e,t){for(var r=0;r!=t.length;++r){var n=t[r];if(e[n[0]]==null)e[n[0]]=n[1];else switch(n[2]){case"bool":typeof e[n[0]]=="string"&&(e[n[0]]=bt(e[n[0]]));break;case"int":typeof e[n[0]]=="string"&&(e[n[0]]=parseInt(e[n[0]],10));break}}}function TI(e){Uw(e.WBProps,EI),Uw(e.CalcPr,OB),Vw(e.WBView,DB),Vw(e.Sheets,FB),Jo.date1904=bt(e.WBProps.date1904)}var MB="][*?/\\".split("");function LB(e,t){if(e.length>31)throw new Error("Sheet names cannot exceed 31 chars");var r=!0;return MB.forEach(function(n){if(e.indexOf(n)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),r}var jB=/<\w+:workbook/;function VB(e,t){if(!e)throw new Error("Could not find file");var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},n=!1,s="xmlns",a={},i=0;if(e.replace(Kr,function(l,c){var u=Oe(l);switch(Os(u[0])){case"<?xml":break;case"<workbook":l.match(jB)&&(s="xmlns"+l.match(/<(\w+):/)[1]),r.xmlns=u[s];break;case"</workbook>":break;case"<fileVersion":delete u[0],r.AppVersion=u;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":EI.forEach(function(d){if(u[d[0]]!=null)switch(d[2]){case"bool":r.WBProps[d[0]]=bt(u[d[0]]);break;case"int":r.WBProps[d[0]]=parseInt(u[d[0]],10);break;default:r.WBProps[d[0]]=u[d[0]]}}),u.codeName&&(r.WBProps.CodeName=Et(u.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete u[0],r.WBView.push(u);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(u.state){case"hidden":u.Hidden=1;break;case"veryHidden":u.Hidden=2;break;default:u.Hidden=0}delete u.state,u.name=ot(Et(u.name)),delete u[0],r.Sheets.push(u);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":n=!0;break;case"</definedNames>":n=!1;break;case"<definedName":a={},a.Name=Et(u.name),u.comment&&(a.Comment=u.comment),u.localSheetId&&(a.Sheet=+u.localSheetId),bt(u.hidden||"0")&&(a.Hidden=!0),i=c+l.length;break;case"</definedName>":a.Ref=ot(Et(e.slice(i,c))),r.Names.push(a);break;case"<definedName/>":break;case"<calcPr":delete u[0],r.CalcPr=u;break;case"<calcPr/>":delete u[0],r.CalcPr=u;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":n=!0;break;case"</AlternateContent>":n=!1;break;case"<revisionPtr":break;default:if(!n&&t.WTF)throw new Error("unrecognized "+u[0]+" in workbook")}return l}),n8.indexOf(r.xmlns)===-1)throw new Error("Unknown Namespace: "+r.xmlns);return TI(r),r}function UB(e,t){var r={};return r.Hidden=e.read_shift(4),r.iTabID=e.read_shift(4),r.strRelID=Op(e),r.name=$r(e),r}function BB(e,t){var r={},n=e.read_shift(4);r.defaultThemeVersion=e.read_shift(4);var s=t>8?$r(e):"";return s.length>0&&(r.CodeName=s),r.autoCompressPictures=!!(n&65536),r.backupFile=!!(n&64),r.checkCompatibility=!!(n&4096),r.date1904=!!(n&1),r.filterPrivacy=!!(n&8),r.hidePivotFieldList=!!(n&1024),r.promptedSolutions=!!(n&16),r.publishItems=!!(n&2048),r.refreshAllConnections=!!(n&262144),r.saveExternalLinkValues=!!(n&128),r.showBorderUnselectedTables=!!(n&4),r.showInkAnnotation=!!(n&32),r.showObjects=["all","placeholders","none"][n>>13&3],r.showPivotChartFilter=!!(n&32768),r.updateLinks=["userSet","never","always"][n>>8&3],r}function zB(e,t){var r={};return e.read_shift(4),r.ArchID=e.read_shift(4),e.l+=t-8,r}function $B(e,t,r){var n=e.l+t;e.l+=4,e.l+=1;var s=e.read_shift(4),a=w8(e),i=AU(e,0,r),o=ax(e);e.l=n;var l={Name:a,Ptg:i};return s<268435455&&(l.Sheet=s),o&&(l.Comment=o),l}function WB(e,t){var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},n=[],s=!1;t||(t={}),t.biff=12;var a=[],i=[[]];return i.SheetNames=[],i.XTI=[],cd[16]={n:"BrtFRTArchID$",f:zB},_a(e,function(l,c,u){switch(u){case 156:i.SheetNames.push(l.name),r.Sheets.push(l);break;case 153:r.WBProps=l;break;case 39:l.Sheet!=null&&(t.SID=l.Sheet),l.Ref=Lr(l.Ptg,null,null,i,t),delete t.SID,delete l.Ptg,a.push(l);break;case 1036:break;case 357:case 358:case 355:case 667:i[0].length?i.push([u,l]):i[0]=[u,l],i[i.length-1].XTI=[];break;case 362:i.length===0&&(i[0]=[],i[0].XTI=[]),i[i.length-1].XTI=i[i.length-1].XTI.concat(l),i.XTI=i.XTI.concat(l);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:n.push(u),s=!0;break;case 36:n.pop(),s=!1;break;case 37:n.push(u),s=!0;break;case 38:n.pop(),s=!1;break;case 16:break;default:if(!c.T){if(!s||t.WTF&&n[n.length-1]!=37&&n[n.length-1]!=35)throw new Error("Unexpected record 0x"+u.toString(16))}}},t),TI(r),r.Names=a,r.supbooks=i,r}function HB(e,t,r){return t.slice(-4)===".bin"?WB(e,r):VB(e,r)}function GB(e,t,r,n,s,a,i,o){return t.slice(-4)===".bin"?IB(e,n,r,s,a,i,o):UU(e,n,r,s,a,i,o)}function KB(e,t,r,n,s,a,i,o){return t.slice(-4)===".bin"?PB(e,n,r,s,a):RB(e,n,r,s,a)}function qB(e,t,r,n,s,a,i,o){return t.slice(-4)===".bin"?rV():nV()}function XB(e,t,r,n,s,a,i,o){return t.slice(-4)===".bin"?eV():tV()}function YB(e,t,r,n){return t.slice(-4)===".bin"?v9(e,r,n):f9(e,r,n)}function QB(e,t,r){return cI(e,r)}function JB(e,t,r){return t.slice(-4)===".bin"?Dj(e,r):bj(e,r)}function ZB(e,t,r){return t.slice(-4)===".bin"?Q9(e,r):G9(e,r)}function e7(e,t,r){return t.slice(-4)===".bin"?$9(e):B9(e)}function t7(e,t,r,n){return r.slice(-4)===".bin"?W9(e,t,r,n):void 0}function r7(e,t,r){return t.slice(-4)===".bin"?V9(e,t,r):U9(e,t,r)}var kI=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,SI=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function Xn(e,t){var r=e.split(/\s+/),n=[];if(n[0]=r[0],r.length===1)return n;var s=e.match(kI),a,i,o,l;if(s)for(l=0;l!=s.length;++l)a=s[l].match(SI),(i=a[1].indexOf(":"))===-1?n[a[1]]=a[2].slice(1,a[2].length-1):(a[1].slice(0,6)==="xmlns:"?o="xmlns"+a[1].slice(6):o=a[1].slice(i+1),n[o]=a[2].slice(1,a[2].length-1));return n}function n7(e){var t=e.split(/\s+/),r={};if(t.length===1)return r;var n=e.match(kI),s,a,i,o;if(n)for(o=0;o!=n.length;++o)s=n[o].match(SI),(a=s[1].indexOf(":"))===-1?r[s[1]]=s[2].slice(1,s[2].length-1):(s[1].slice(0,6)==="xmlns:"?i="xmlns"+s[1].slice(6):i=s[1].slice(a+1),r[i]=s[2].slice(1,s[2].length-1));return r}var Pc;function s7(e,t){var r=Pc[e]||ot(e);return r==="General"?Qi(t):Wn(r,t)}function a7(e,t,r,n){var s=n;switch((r[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":s=bt(n);break;case"i2":case"int":s=parseInt(n,10);break;case"r4":case"float":s=parseFloat(n);break;case"date":case"dateTime.tz":s=mr(n);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+r[0])}e[ot(t)]=s}function i7(e,t,r){if(e.t!=="z"){if(!r||r.cellText!==!1)try{e.t==="e"?e.w=e.w||uo[e.v]:t==="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=cu(e.v):e.w=Qi(e.v):e.w=s7(t||"General",e.v)}catch(a){if(r.WTF)throw a}try{var n=Pc[t]||t||"General";if(r.cellNF&&(e.z=n),r.cellDates&&e.t=="n"&&Al(n)){var s=Di(e.v);s&&(e.t="d",e.v=new Date(s.y,s.m-1,s.d,s.H,s.M,s.S,s.u))}}catch(a){if(r.WTF)throw a}}}function o7(e,t,r){if(r.cellStyles&&t.Interior){var n=t.Interior;n.Pattern&&(n.patternType=a9[n.Pattern]||n.Pattern)}e[t.ID]=t}function l7(e,t,r,n,s,a,i,o,l,c){var u="General",d=n.StyleID,m={};c=c||{};var p=[],g=0;for(d===void 0&&o&&(d=o.StyleID),d===void 0&&i&&(d=i.StyleID);a[d]!==void 0&&(a[d].nf&&(u=a[d].nf),a[d].Interior&&p.push(a[d].Interior),!!a[d].Parent);)d=a[d].Parent;switch(r.Type){case"Boolean":n.t="b",n.v=bt(e);break;case"String":n.t="s",n.r=lw(ot(e)),n.v=e.indexOf("<")>-1?ot(t||e).replace(/<.*?>/g,""):n.r;break;case"DateTime":e.slice(-1)!="Z"&&(e+="Z"),n.v=(mr(e)-new Date(Date.UTC(1899,11,30)))/(24*60*60*1e3),n.v!==n.v?n.v=ot(e):n.v<60&&(n.v=n.v-1),(!u||u=="General")&&(u="yyyy-mm-dd");case"Number":n.v===void 0&&(n.v=+e),n.t||(n.t="n");break;case"Error":n.t="e",n.v=BA[e],c.cellText!==!1&&(n.w=e);break;default:e==""&&t==""?n.t="z":(n.t="s",n.v=lw(t||e));break}if(i7(n,u,c),c.cellFormula!==!1)if(n.Formula){var x=ot(n.Formula);x.charCodeAt(0)==61&&(x=x.slice(1)),n.f=Qo(x,s),delete n.Formula,n.ArrayRange=="RC"?n.F=Qo("RC:RC",s):n.ArrayRange&&(n.F=Qo(n.ArrayRange,s),l.push([Bt(n.F),n.F]))}else for(g=0;g<l.length;++g)s.r>=l[g][0].s.r&&s.r<=l[g][0].e.r&&s.c>=l[g][0].s.c&&s.c<=l[g][0].e.c&&(n.F=l[g][1]);c.cellStyles&&(p.forEach(function(w){!m.patternType&&w.patternType&&(m.patternType=w.patternType)}),n.s=m),n.StyleID!==void 0&&(n.ixfe=n.StyleID)}function c7(e){e.t=e.v||"",e.t=e.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.v=e.w=e.ixfe=void 0}function im(e,t){var r=t||{};dA();var n=ac(ex(e));(r.type=="binary"||r.type=="array"||r.type=="base64")&&(n=Et(n));var s=n.slice(0,1024).toLowerCase(),a=!1;if(s=s.replace(/".*?"/g,""),(s.indexOf(">")&1023)>Math.min(s.indexOf(",")&1023,s.indexOf(";")&1023)){var i=Sr(r);return i.type="string",hu.to_workbook(n,i)}if(s.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(Tt){s.indexOf("<"+Tt)>=0&&(a=!0)}),a)return x7(n,r);Pc={"General Number":"General","General Date":ze[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":ze[15],"Short Date":ze[14],"Long Time":ze[19],"Medium Time":ze[18],"Short Time":ze[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:ze[2],Standard:ze[4],Percent:ze[10],Scientific:ze[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var o,l=[],c,u={},d=[],m=r.dense?[]:{},p="",g={},x={},w=Xn('<Data ss:Type="String">'),k=0,T=0,E=0,N={s:{r:2e6,c:2e6},e:{r:0,c:0}},M={},O={},v="",_=0,S=[],I={},b={},P=0,R=[],ue=[],le={},he=[],pe,ee=!1,H=[],se=[],ce={},B=0,K=0,X={Sheets:[],WBProps:{date1904:!1}},G={};fu.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"");for(var ie="";o=fu.exec(n);)switch(o[3]=(ie=o[3]).toLowerCase()){case"data":if(ie=="data"){if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&l.push([o[3],!0]);break}if(l[l.length-1][1])break;o[1]==="/"?l7(n.slice(k,o.index),v,w,l[l.length-1][0]=="comment"?le:g,{c:T,r:E},M,he[T],x,H,r):(v="",w=Xn(o[0]),k=o.index+o[0].length);break;case"cell":if(o[1]==="/")if(ue.length>0&&(g.c=ue),(!r.sheetRows||r.sheetRows>E)&&g.v!==void 0&&(r.dense?(m[E]||(m[E]=[]),m[E][T]=g):m[sr(T)+Ar(E)]=g),g.HRef&&(g.l={Target:ot(g.HRef)},g.HRefScreenTip&&(g.l.Tooltip=g.HRefScreenTip),delete g.HRef,delete g.HRefScreenTip),(g.MergeAcross||g.MergeDown)&&(B=T+(parseInt(g.MergeAcross,10)|0),K=E+(parseInt(g.MergeDown,10)|0),S.push({s:{c:T,r:E},e:{c:B,r:K}})),!r.sheetStubs)g.MergeAcross?T=B+1:++T;else if(g.MergeAcross||g.MergeDown){for(var ge=T;ge<=B;++ge)for(var Ie=E;Ie<=K;++Ie)(ge>T||Ie>E)&&(r.dense?(m[Ie]||(m[Ie]=[]),m[Ie][ge]={t:"z"}):m[sr(ge)+Ar(Ie)]={t:"z"});T=B+1}else++T;else g=n7(o[0]),g.Index&&(T=+g.Index-1),T<N.s.c&&(N.s.c=T),T>N.e.c&&(N.e.c=T),o[0].slice(-2)==="/>"&&++T,ue=[];break;case"row":o[1]==="/"||o[0].slice(-2)==="/>"?(E<N.s.r&&(N.s.r=E),E>N.e.r&&(N.e.r=E),o[0].slice(-2)==="/>"&&(x=Xn(o[0]),x.Index&&(E=+x.Index-1)),T=0,++E):(x=Xn(o[0]),x.Index&&(E=+x.Index-1),ce={},(x.AutoFitHeight=="0"||x.Height)&&(ce.hpx=parseInt(x.Height,10),ce.hpt=lI(ce.hpx),se[E]=ce),x.Hidden=="1"&&(ce.hidden=!0,se[E]=ce));break;case"worksheet":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"));d.push(p),N.s.r<=N.e.r&&N.s.c<=N.e.c&&(m["!ref"]=nt(N),r.sheetRows&&r.sheetRows<=N.e.r&&(m["!fullref"]=m["!ref"],N.e.r=r.sheetRows-1,m["!ref"]=nt(N))),S.length&&(m["!merges"]=S),he.length>0&&(m["!cols"]=he),se.length>0&&(m["!rows"]=se),u[p]=m}else N={s:{r:2e6,c:2e6},e:{r:0,c:0}},E=T=0,l.push([o[3],!1]),c=Xn(o[0]),p=ot(c.Name),m=r.dense?[]:{},S=[],H=[],se=[],G={name:p,Hidden:0},X.Sheets.push(G);break;case"table":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else{if(o[0].slice(-2)=="/>")break;l.push([o[3],!1]),he=[],ee=!1}break;case"style":o[1]==="/"?o7(M,O,r):O=Xn(o[0]);break;case"numberformat":O.nf=ot(Xn(o[0]).Format||"General"),Pc[O.nf]&&(O.nf=Pc[O.nf]);for(var Te=0;Te!=392&&ze[Te]!=O.nf;++Te);if(Te==392){for(Te=57;Te!=392;++Te)if(ze[Te]==null){ji(O.nf,Te);break}}break;case"column":if(l[l.length-1][0]!=="table")break;if(pe=Xn(o[0]),pe.Hidden&&(pe.hidden=!0,delete pe.Hidden),pe.Width&&(pe.wpx=parseInt(pe.Width,10)),!ee&&pe.wpx>10){ee=!0,Yr=iI;for(var ye=0;ye<he.length;++ye)he[ye]&&vl(he[ye])}ee&&vl(pe),he[pe.Index-1||he.length]=pe;for(var $e=0;$e<+pe.Span;++$e)he[he.length]=Sr(pe);break;case"namedrange":if(o[1]==="/")break;X.Names||(X.Names=[]);var W=Oe(o[0]),lt={Name:W.Name,Ref:Qo(W.RefersTo.slice(1),{r:0,c:0})};X.Sheets.length>0&&(lt.Sheet=X.Sheets.length-1),X.Names.push(lt);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(o[0].slice(-2)==="/>")break;o[1]==="/"?v+=n.slice(_,o.index):_=o.index+o[0].length;break;case"interior":if(!r.cellStyles)break;O.Interior=Xn(o[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(o[0].slice(-2)==="/>")break;o[1]==="/"?G8(I,ie,n.slice(P,o.index)):P=o.index+o[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else l.push([o[3],!1]);break;case"comment":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"));c7(le),ue.push(le)}else l.push([o[3],!1]),c=Xn(o[0]),le={a:c.Author};break;case"autofilter":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else if(o[0].charAt(o[0].length-2)!=="/"){var He=Xn(o[0]);m["!autofilter"]={ref:Qo(He.Range).replace(/\$/g,"")},l.push([o[3],!0])}break;case"name":break;case"datavalidation":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&l.push([o[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&l.push([o[3],!0]);break;case"null":break;default:if(l.length==0&&o[3]=="document"||l.length==0&&o[3]=="uof")return Gw(n,r);var st=!0;switch(l[l.length-1][0]){case"officedocumentsettings":switch(o[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:st=!1}break;case"componentoptions":switch(o[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:st=!1}break;case"excelworkbook":switch(o[3]){case"date1904":X.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:st=!1}break;case"workbookoptions":switch(o[3]){case"owcversion":break;case"height":break;case"width":break;default:st=!1}break;case"worksheetoptions":switch(o[3]){case"visible":if(o[0].slice(-2)!=="/>")if(o[1]==="/")switch(n.slice(P,o.index)){case"SheetHidden":G.Hidden=1;break;case"SheetVeryHidden":G.Hidden=2;break}else P=o.index+o[0].length;break;case"header":m["!margins"]||bc(m["!margins"]={},"xlml"),isNaN(+Oe(o[0]).Margin)||(m["!margins"].header=+Oe(o[0]).Margin);break;case"footer":m["!margins"]||bc(m["!margins"]={},"xlml"),isNaN(+Oe(o[0]).Margin)||(m["!margins"].footer=+Oe(o[0]).Margin);break;case"pagemargins":var Fe=Oe(o[0]);m["!margins"]||bc(m["!margins"]={},"xlml"),isNaN(+Fe.Top)||(m["!margins"].top=+Fe.Top),isNaN(+Fe.Left)||(m["!margins"].left=+Fe.Left),isNaN(+Fe.Right)||(m["!margins"].right=+Fe.Right),isNaN(+Fe.Bottom)||(m["!margins"].bottom=+Fe.Bottom);break;case"displayrighttoleft":X.Views||(X.Views=[]),X.Views[0]||(X.Views[0]={}),X.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":m["!outline"]||(m["!outline"]={}),m["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":m["!outline"]||(m["!outline"]={}),m["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:st=!1}break;case"pivottable":case"pivotcache":switch(o[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:st=!1}break;case"pagebreaks":switch(o[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:st=!1}break;case"autofilter":switch(o[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:st=!1}break;case"querytable":switch(o[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:st=!1}break;case"datavalidation":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:st=!1}break;case"sorting":case"conditionalformatting":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:st=!1}break;case"mapinfo":case"schema":case"data":switch(o[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:st=!1}break;case"smarttags":break;default:st=!1;break}if(st||o[3].match(/!\[CDATA/))break;if(!l[l.length-1][1])throw"Unrecognized tag: "+o[3]+"|"+l.join("|");if(l[l.length-1][0]==="customdocumentproperties"){if(o[0].slice(-2)==="/>")break;o[1]==="/"?a7(b,ie,R,n.slice(P,o.index)):(R=o,P=o.index+o[0].length);break}if(r.WTF)throw"Unrecognized tag: "+o[3]+"|"+l.join("|")}var Ae={};return!r.bookSheets&&!r.bookProps&&(Ae.Sheets=u),Ae.SheetNames=d,Ae.Workbook=X,Ae.SSF=Sr(ze),Ae.Props=I,Ae.Custprops=b,Ae}function Vp(e,t){switch(px(t=t||{}),t.type||"base64"){case"base64":return im(An(e),t);case"binary":case"buffer":case"file":return im(e,t);case"array":return im(oo(e),t)}}function u7(e){var t={},r=e.content;if(r.l=28,t.AnsiUserType=r.read_shift(0,"lpstr-ansi"),t.AnsiClipboardFormat=k8(r),r.length-r.l<=4)return t;var n=r.read_shift(4);if(n==0||n>40||(r.l-=4,t.Reserved1=r.read_shift(0,"lpstr-ansi"),r.length-r.l<=4)||(n=r.read_shift(4),n!==1907505652)||(t.UnicodeClipboardFormat=S8(r),n=r.read_shift(4),n==0||n>40))return t;r.l-=4,t.Reserved2=r.read_shift(0,"lpwstr")}var f7=[60,1084,2066,2165,2175];function h7(e,t,r,n,s){var a=n,i=[],o=r.slice(r.l,r.l+a);if(s&&s.enc&&s.enc.insitu&&o.length>0)switch(e){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:s.enc.insitu(o)}i.push(o),r.l+=a;for(var l=Zs(r,r.l),c=Up[l],u=0;c!=null&&f7.indexOf(l)>-1;)a=Zs(r,r.l+2),u=r.l+4,l==2066?u+=4:(l==2165||l==2175)&&(u+=12),o=r.slice(u,r.l+4+a),i.push(o),r.l+=4+a,c=Up[l=Zs(r,r.l)];var d=Ma(i);yr(d,0);var m=0;d.lens=[];for(var p=0;p<i.length;++p)d.lens.push(m),m+=i[p].length;if(d.length<n)throw"XLS Record 0x"+e.toString(16)+" Truncated: "+d.length+" < "+n;return t.f(d,d.length,s)}function gs(e,t,r){if(e.t!=="z"&&e.XF){var n=0;try{n=e.z||e.XF.numFmtId||0,t.cellNF&&(e.z=ze[n])}catch(a){if(t.WTF)throw a}if(!t||t.cellText!==!1)try{e.t==="e"?e.w=e.w||uo[e.v]:n===0||n=="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=cu(e.v):e.w=Qi(e.v):e.w=Wn(n,e.v,{date1904:!!r,dateNF:t&&t.dateNF})}catch(a){if(t.WTF)throw a}if(t.cellDates&&n&&e.t=="n"&&Al(ze[n]||String(n))){var s=Di(e.v);s&&(e.t="d",e.v=new Date(s.y,s.m-1,s.d,s.H,s.M,s.S,s.u))}}}function Mf(e,t,r){return{v:e,ixfe:t,t:r}}function d7(e,t){var r={opts:{}},n={},s=t.dense?[]:{},a={},i={},o=null,l=[],c="",u={},d,m="",p,g,x,w,k={},T=[],E,N,M=[],O=[],v={Sheets:[],WBProps:{date1904:!1},Views:[{}]},_={},S=function(je){return je<8?Vi[je]:je<64&&O[je-8]||Vi[je]},I=function(je,yt,Gt){var ft=yt.XF.data;if(!(!ft||!ft.patternType||!Gt||!Gt.cellStyles)){yt.s={},yt.s.patternType=ft.patternType;var gn;(gn=du(S(ft.icvFore)))&&(yt.s.fgColor={rgb:gn}),(gn=du(S(ft.icvBack)))&&(yt.s.bgColor={rgb:gn})}},b=function(je,yt,Gt){if(!(ce>1)&&!(Gt.sheetRows&&je.r>=Gt.sheetRows)){if(Gt.cellStyles&&yt.XF&&yt.XF.data&&I(je,yt,Gt),delete yt.ixfe,delete yt.XF,d=je,m=Ue(je),(!i||!i.s||!i.e)&&(i={s:{r:0,c:0},e:{r:0,c:0}}),je.r<i.s.r&&(i.s.r=je.r),je.c<i.s.c&&(i.s.c=je.c),je.r+1>i.e.r&&(i.e.r=je.r+1),je.c+1>i.e.c&&(i.e.c=je.c+1),Gt.cellFormula&&yt.f){for(var ft=0;ft<T.length;++ft)if(!(T[ft][0].s.c>je.c||T[ft][0].s.r>je.r)&&!(T[ft][0].e.c<je.c||T[ft][0].e.r<je.r)){yt.F=nt(T[ft][0]),(T[ft][0].s.c!=je.c||T[ft][0].s.r!=je.r)&&delete yt.f,yt.f&&(yt.f=""+Lr(T[ft][1],i,je,H,P));break}}Gt.dense?(s[je.r]||(s[je.r]=[]),s[je.r][je.c]=yt):s[m]=yt}},P={enc:!1,sbcch:0,snames:[],sharedf:k,arrayf:T,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!t&&!!t.cellStyles,WTF:!!t&&!!t.wtf};t.password&&(P.password=t.password);var R,ue=[],le=[],he=[],pe=[],ee=!1,H=[];H.SheetNames=P.snames,H.sharedf=P.sharedf,H.arrayf=P.arrayf,H.names=[],H.XTI=[];var se=0,ce=0,B=0,K=[],X=[],G;P.codepage=1200,ss(1200);for(var ie=!1;e.l<e.length-1;){var ge=e.l,Ie=e.read_shift(2);if(Ie===0&&se===10)break;var Te=e.l===e.length?0:e.read_shift(2),ye=Up[Ie];if(ye&&ye.f){if(t.bookSheets&&se===133&&Ie!==133)break;if(se=Ie,ye.r===2||ye.r==12){var $e=e.read_shift(2);if(Te-=2,!P.enc&&$e!==Ie&&(($e&255)<<8|$e>>8)!==Ie)throw new Error("rt mismatch: "+$e+"!="+Ie);ye.r==12&&(e.l+=10,Te-=10)}var W={};if(Ie===10?W=ye.f(e,Te,P):W=h7(Ie,ye,e,Te,P),ce==0&&[9,521,1033,2057].indexOf(se)===-1)continue;switch(Ie){case 34:r.opts.Date1904=v.WBProps.date1904=W;break;case 134:r.opts.WriteProtect=!0;break;case 47:if(P.enc||(e.l=0),P.enc=W,!t.password)throw new Error("File is password-protected");if(W.valid==null)throw new Error("Encryption scheme unsupported");if(!W.valid)throw new Error("Password is incorrect");break;case 92:P.lastuser=W;break;case 66:var lt=Number(W);switch(lt){case 21010:lt=1200;break;case 32768:lt=1e4;break;case 32769:lt=1252;break}ss(P.codepage=lt),ie=!0;break;case 317:P.rrtabid=W;break;case 25:P.winlocked=W;break;case 439:r.opts.RefreshAll=W;break;case 12:r.opts.CalcCount=W;break;case 16:r.opts.CalcDelta=W;break;case 17:r.opts.CalcIter=W;break;case 13:r.opts.CalcMode=W;break;case 14:r.opts.CalcPrecision=W;break;case 95:r.opts.CalcSaveRecalc=W;break;case 15:P.CalcRefMode=W;break;case 2211:r.opts.FullCalc=W;break;case 129:W.fDialog&&(s["!type"]="dialog"),W.fBelow||((s["!outline"]||(s["!outline"]={})).above=!0),W.fRight||((s["!outline"]||(s["!outline"]={})).left=!0);break;case 224:M.push(W);break;case 430:H.push([W]),H[H.length-1].XTI=[];break;case 35:case 547:H[H.length-1].push(W);break;case 24:case 536:G={Name:W.Name,Ref:Lr(W.rgce,i,null,H,P)},W.itab>0&&(G.Sheet=W.itab-1),H.names.push(G),H[0]||(H[0]=[],H[0].XTI=[]),H[H.length-1].push(W),W.Name=="_xlnm._FilterDatabase"&&W.itab>0&&W.rgce&&W.rgce[0]&&W.rgce[0][0]&&W.rgce[0][0][0]=="PtgArea3d"&&(X[W.itab-1]={ref:nt(W.rgce[0][0][1][2])});break;case 22:P.ExternCount=W;break;case 23:H.length==0&&(H[0]=[],H[0].XTI=[]),H[H.length-1].XTI=H[H.length-1].XTI.concat(W),H.XTI=H.XTI.concat(W);break;case 2196:if(P.biff<8)break;G!=null&&(G.Comment=W[1]);break;case 18:s["!protect"]=W;break;case 19:W!==0&&P.WTF&&console.error("Password verifier: "+W);break;case 133:a[W.pos]=W,P.snames.push(W.name);break;case 10:{if(--ce)break;if(i.e){if(i.e.r>0&&i.e.c>0){if(i.e.r--,i.e.c--,s["!ref"]=nt(i),t.sheetRows&&t.sheetRows<=i.e.r){var He=i.e.r;i.e.r=t.sheetRows-1,s["!fullref"]=s["!ref"],s["!ref"]=nt(i),i.e.r=He}i.e.r++,i.e.c++}ue.length>0&&(s["!merges"]=ue),le.length>0&&(s["!objects"]=le),he.length>0&&(s["!cols"]=he),pe.length>0&&(s["!rows"]=pe),v.Sheets.push(_)}c===""?u=s:n[c]=s,s=t.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(P.biff===8&&(P.biff={9:2,521:3,1033:4}[Ie]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[W.BIFFVer]||8),P.biffguess=W.BIFFVer==0,W.BIFFVer==0&&W.dt==4096&&(P.biff=5,ie=!0,ss(P.codepage=28591)),P.biff==8&&W.BIFFVer==0&&W.dt==16&&(P.biff=2),ce++)break;if(s=t.dense?[]:{},P.biff<8&&!ie&&(ie=!0,ss(P.codepage=t.codepage||1252)),P.biff<5||W.BIFFVer==0&&W.dt==4096){c===""&&(c="Sheet1"),i={s:{r:0,c:0},e:{r:0,c:0}};var st={pos:e.l-Te,name:c};a[st.pos]=st,P.snames.push(c)}else c=(a[ge]||{name:""}).name;W.dt==32&&(s["!type"]="chart"),W.dt==64&&(s["!type"]="macro"),ue=[],le=[],P.arrayf=T=[],he=[],pe=[],ee=!1,_={Hidden:(a[ge]||{hs:0}).hs,name:c}}break;case 515:case 3:case 2:s["!type"]=="chart"&&(t.dense?(s[W.r]||[])[W.c]:s[Ue({c:W.c,r:W.r})])&&++W.c,E={ixfe:W.ixfe,XF:M[W.ixfe]||{},v:W.val,t:"n"},B>0&&(E.z=K[E.ixfe>>8&63]),gs(E,t,r.opts.Date1904),b({c:W.c,r:W.r},E,t);break;case 5:case 517:E={ixfe:W.ixfe,XF:M[W.ixfe],v:W.val,t:W.t},B>0&&(E.z=K[E.ixfe>>8&63]),gs(E,t,r.opts.Date1904),b({c:W.c,r:W.r},E,t);break;case 638:E={ixfe:W.ixfe,XF:M[W.ixfe],v:W.rknum,t:"n"},B>0&&(E.z=K[E.ixfe>>8&63]),gs(E,t,r.opts.Date1904),b({c:W.c,r:W.r},E,t);break;case 189:for(var Fe=W.c;Fe<=W.C;++Fe){var Ae=W.rkrec[Fe-W.c][0];E={ixfe:Ae,XF:M[Ae],v:W.rkrec[Fe-W.c][1],t:"n"},B>0&&(E.z=K[E.ixfe>>8&63]),gs(E,t,r.opts.Date1904),b({c:Fe,r:W.r},E,t)}break;case 6:case 518:case 1030:{if(W.val=="String"){o=W;break}if(E=Mf(W.val,W.cell.ixfe,W.tt),E.XF=M[E.ixfe],t.cellFormula){var Tt=W.formula;if(Tt&&Tt[0]&&Tt[0][0]&&Tt[0][0][0]=="PtgExp"){var lr=Tt[0][0][1][0],Nr=Tt[0][0][1][1],nn=Ue({r:lr,c:Nr});k[nn]?E.f=""+Lr(W.formula,i,W.cell,H,P):E.F=((t.dense?(s[lr]||[])[Nr]:s[nn])||{}).F}else E.f=""+Lr(W.formula,i,W.cell,H,P)}B>0&&(E.z=K[E.ixfe>>8&63]),gs(E,t,r.opts.Date1904),b(W.cell,E,t),o=W}break;case 7:case 519:if(o)o.val=W,E=Mf(W,o.cell.ixfe,"s"),E.XF=M[E.ixfe],t.cellFormula&&(E.f=""+Lr(o.formula,i,o.cell,H,P)),B>0&&(E.z=K[E.ixfe>>8&63]),gs(E,t,r.opts.Date1904),b(o.cell,E,t),o=null;else throw new Error("String record expects Formula");break;case 33:case 545:{T.push(W);var Ls=Ue(W[0].s);if(p=t.dense?(s[W[0].s.r]||[])[W[0].s.c]:s[Ls],t.cellFormula&&p){if(!o||!Ls||!p)break;p.f=""+Lr(W[1],i,W[0],H,P),p.F=nt(W[0])}}break;case 1212:{if(!t.cellFormula)break;if(m){if(!o)break;k[Ue(o.cell)]=W[0],p=t.dense?(s[o.cell.r]||[])[o.cell.c]:s[Ue(o.cell)],(p||{}).f=""+Lr(W[0],i,d,H,P)}}break;case 253:E=Mf(l[W.isst].t,W.ixfe,"s"),l[W.isst].h&&(E.h=l[W.isst].h),E.XF=M[E.ixfe],B>0&&(E.z=K[E.ixfe>>8&63]),gs(E,t,r.opts.Date1904),b({c:W.c,r:W.r},E,t);break;case 513:t.sheetStubs&&(E={ixfe:W.ixfe,XF:M[W.ixfe],t:"z"},B>0&&(E.z=K[E.ixfe>>8&63]),gs(E,t,r.opts.Date1904),b({c:W.c,r:W.r},E,t));break;case 190:if(t.sheetStubs)for(var sn=W.c;sn<=W.C;++sn){var kt=W.ixfe[sn-W.c];E={ixfe:kt,XF:M[kt],t:"z"},B>0&&(E.z=K[E.ixfe>>8&63]),gs(E,t,r.opts.Date1904),b({c:sn,r:W.r},E,t)}break;case 214:case 516:case 4:E=Mf(W.val,W.ixfe,"s"),E.XF=M[E.ixfe],B>0&&(E.z=K[E.ixfe>>8&63]),gs(E,t,r.opts.Date1904),b({c:W.c,r:W.r},E,t);break;case 0:case 512:ce===1&&(i=W);break;case 252:l=W;break;case 1054:if(P.biff==4){K[B++]=W[1];for(var cr=0;cr<B+163&&ze[cr]!=W[1];++cr);cr>=163&&ji(W[1],B+163)}else ji(W[1],W[0]);break;case 30:{K[B++]=W;for(var xt=0;xt<B+163&&ze[xt]!=W;++xt);xt>=163&&ji(W,B+163)}break;case 229:ue=ue.concat(W);break;case 93:le[W.cmo[0]]=P.lastobj=W;break;case 438:P.lastobj.TxO=W;break;case 127:P.lastobj.ImData=W;break;case 440:for(w=W[0].s.r;w<=W[0].e.r;++w)for(x=W[0].s.c;x<=W[0].e.c;++x)p=t.dense?(s[w]||[])[x]:s[Ue({c:x,r:w})],p&&(p.l=W[1]);break;case 2048:for(w=W[0].s.r;w<=W[0].e.r;++w)for(x=W[0].s.c;x<=W[0].e.c;++x)p=t.dense?(s[w]||[])[x]:s[Ue({c:x,r:w})],p&&p.l&&(p.l.Tooltip=W[1]);break;case 28:{if(P.biff<=5&&P.biff>=2)break;p=t.dense?(s[W[0].r]||[])[W[0].c]:s[Ue(W[0])];var St=le[W[2]];p||(t.dense?(s[W[0].r]||(s[W[0].r]=[]),p=s[W[0].r][W[0].c]={t:"z"}):p=s[Ue(W[0])]={t:"z"},i.e.r=Math.max(i.e.r,W[0].r),i.s.r=Math.min(i.s.r,W[0].r),i.e.c=Math.max(i.e.c,W[0].c),i.s.c=Math.min(i.s.c,W[0].c)),p.c||(p.c=[]),g={a:W[1],t:St.TxO.t},p.c.push(g)}break;case 2173:O9(M[W.ixfe],W.ext);break;case 125:{if(!P.cellStyles)break;for(;W.e>=W.s;)he[W.e--]={width:W.w/256,level:W.level||0,hidden:!!(W.flags&1)},ee||(ee=!0,ux(W.w/256)),vl(he[W.e+1])}break;case 520:{var dt={};W.level!=null&&(pe[W.r]=dt,dt.level=W.level),W.hidden&&(pe[W.r]=dt,dt.hidden=!0),W.hpt&&(pe[W.r]=dt,dt.hpt=W.hpt,dt.hpx=mu(W.hpt))}break;case 38:case 39:case 40:case 41:s["!margins"]||bc(s["!margins"]={}),s["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[Ie]]=W;break;case 161:s["!margins"]||bc(s["!margins"]={}),s["!margins"].header=W.header,s["!margins"].footer=W.footer;break;case 574:W.RTL&&(v.Views[0].RTL=!0);break;case 146:O=W;break;case 2198:R=W;break;case 140:N=W;break;case 442:c?_.CodeName=W||_.name:v.WBProps.CodeName=W||"ThisWorkbook";break}}else ye||console.error("Missing Info for XLS Record 0x"+Ie.toString(16)),e.l+=Te}return r.SheetNames=bs(a).sort(function(Dt,je){return Number(Dt)-Number(je)}).map(function(Dt){return a[Dt].name}),t.bookSheets||(r.Sheets=n),!r.SheetNames.length&&u["!ref"]?(r.SheetNames.push("Sheet1"),r.Sheets&&(r.Sheets.Sheet1=u)):r.Preamble=u,r.Sheets&&X.forEach(function(Dt,je){r.Sheets[r.SheetNames[je]]["!autofilter"]=Dt}),r.Strings=l,r.SSF=Sr(ze),P.enc&&(r.Encryption=P.enc),R&&(r.Themes=R),r.Metadata={},N!==void 0&&(r.Metadata.Country=N),H.names.length>0&&(v.Names=H.names),r.Workbook=v,r}var Bw={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function m7(e,t,r){var n=rt.find(e,"/!DocumentSummaryInformation");if(n&&n.size>0)try{var s=kw(n,b8,Bw.DSI);for(var a in s)t[a]=s[a]}catch(c){if(r.WTF)throw c}var i=rt.find(e,"/!SummaryInformation");if(i&&i.size>0)try{var o=kw(i,P8,Bw.SI);for(var l in o)t[l]==null&&(t[l]=o[l])}catch(c){if(r.WTF)throw c}t.HeadingPairs&&t.TitlesOfParts&&($A(t.HeadingPairs,t.TitlesOfParts,t,r),delete t.HeadingPairs,delete t.TitlesOfParts)}function AI(e,t){t||(t={}),px(t),tA(),t.codepage&&Kv(t.codepage);var r,n;if(e.FullPaths){if(rt.find(e,"/encryption"))throw new Error("File is password-protected");r=rt.find(e,"!CompObj"),n=rt.find(e,"/Workbook")||rt.find(e,"/Book")}else{switch(t.type){case"base64":e=rs(An(e));break;case"binary":e=rs(e);break;case"buffer":break;case"array":Array.isArray(e)||(e=Array.prototype.slice.call(e));break}yr(e,0),n={content:e}}var s,a;if(r&&u7(r),t.bookProps&&!t.bookSheets)s={};else{var i=Qe?"buffer":"array";if(n&&n.content)s=d7(n.content,t);else if((a=rt.find(e,"PerfectOffice_MAIN"))&&a.content)s=Nc.to_workbook(a.content,(t.type=i,t));else if((a=rt.find(e,"NativeContent_MAIN"))&&a.content)s=Nc.to_workbook(a.content,(t.type=i,t));else throw(a=rt.find(e,"MN0"))&&a.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");t.bookVBA&&e.FullPaths&&rt.find(e,"/_VBA_PROJECT_CUR/VBA/dir")&&(s.vbaraw=Z9(e))}var o={};return e.FullPaths&&m7(e,o,t),s.Props=s.Custprops=o,t.bookFiles&&(s.cfb=e),s}var cd={0:{f:XU},1:{f:ZU},2:{f:lB},3:{f:nB},4:{f:tB},5:{f:oB},6:{f:fB},7:{f:aB},8:{f:gB},9:{f:pB},10:{f:dB},11:{f:mB},12:{f:eB},13:{f:cB},14:{f:sB},15:{f:rB},16:{f:wI},17:{f:hB},18:{f:iB},19:{f:sx},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:$B},40:{},42:{},43:{f:d9},44:{f:h9},45:{f:m9},46:{f:g9},47:{f:p9},48:{},49:{f:v8},50:{},51:{f:L9},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:tI},62:{f:uB},63:{f:z9},64:{f:SB},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:Gr,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:kB},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:JU},148:{f:YU,p:16},151:{f:yB},152:{},153:{f:BB},154:{},155:{},156:{f:UB},157:{},158:{},159:{T:1,f:Pj},160:{T:-1},161:{T:1,f:co},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:vB},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:M9},336:{T:-1},337:{f:j9,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:Op},357:{},358:{},359:{},360:{T:1},361:{},362:{f:eI},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:_B},427:{f:wB},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:TB},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:QU},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:xB},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:Op},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:Y9},633:{T:1},634:{T:-1},635:{T:1,f:X9},636:{T:-1},637:{f:y8},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:bB},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:AB},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},Up={6:{f:sm},10:{f:Ia},12:{f:Yt},13:{f:Yt},14:{f:zt},15:{f:zt},16:{f:Ur},17:{f:zt},18:{f:zt},19:{f:Yt},20:{f:Cw},21:{f:Cw},23:{f:eI},24:{f:Rw},25:{f:zt},26:{},27:{},28:{f:K5},29:{},34:{f:zt},35:{f:Nw},38:{f:Ur},39:{f:Ur},40:{f:Ur},41:{f:Ur},42:{f:zt},43:{f:zt},47:{f:Qj},49:{f:C5},51:{f:Yt},60:{},61:{f:S5},64:{f:zt},65:{f:I5},66:{f:Yt},77:{},80:{},81:{},82:{},85:{f:Yt},89:{},90:{},91:{},92:{f:v5},93:{f:X5},94:{},95:{f:zt},96:{},97:{},99:{f:zt},125:{f:tI},128:{f:j5},129:{f:x5},130:{f:Yt},131:{f:zt},132:{f:zt},133:{f:y5},134:{},140:{f:tj},141:{f:Yt},144:{},146:{f:nj},151:{},152:{},153:{},154:{},155:{},156:{f:Yt},157:{},158:{},160:{f:lj},161:{f:aj},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:F5},190:{f:O5},193:{f:Ia},197:{},198:{},199:{},200:{},201:{},202:{f:zt},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:Yt},220:{},221:{f:zt},222:{},224:{f:L5},225:{f:g5},226:{f:Ia},227:{},229:{f:q5},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:_5},253:{f:N5},255:{f:w5},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:qA},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:zt},353:{f:Ia},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:U5},431:{f:zt},432:{},433:{},434:{},437:{},438:{f:J5},439:{f:zt},440:{f:Z5},441:{},442:{f:Bu},443:{},444:{f:Yt},445:{},446:{},448:{f:Ia},449:{f:k5,r:2},450:{f:Ia},512:{f:Aw},513:{f:oj},515:{f:V5},516:{f:R5},517:{f:Iw},519:{f:cj},520:{f:E5},523:{},545:{f:bw},549:{f:Sw},566:{},574:{f:A5},638:{f:D5},659:{},1048:{},1054:{f:b5},1084:{},1212:{f:W5},2048:{f:ej},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:Df},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:Ia},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:sj,r:12},2173:{f:F9,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:zt,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:$5,r:12},2197:{},2198:{f:C9,r:12},2199:{},2200:{},2201:{},2202:{f:H5,r:12},2203:{f:Ia},2204:{},2205:{},2206:{},2207:{},2211:{f:T5},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:Yt},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:ij},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:rj},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:Aw},1:{},2:{f:dj},3:{f:hj},4:{f:fj},5:{f:Iw},7:{f:mj},8:{},9:{f:Df},11:{},22:{f:Yt},30:{f:P5},31:{},32:{},33:{f:bw},36:{},37:{f:Sw},50:{f:pj},62:{},52:{},67:{},68:{f:Yt},69:{},86:{},126:{},127:{f:uj},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:gj},223:{},234:{},354:{},421:{},518:{f:sm},521:{f:Df},536:{f:Rw},547:{f:Nw},561:{},579:{},1030:{f:sm},1033:{f:Df},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function Yn(e,t,r,n){var s=t;if(!isNaN(s)){var a=(r||[]).length||0,i=e.next(4);i.write_shift(2,s),i.write_shift(2,a),a>0&&OA(r)&&e.push(r)}}function zw(e,t){var r=t||{},n=r.dense?[]:{};e=e.replace(/<!--.*?-->/g,"");var s=e.match(/<table/i);if(!s)throw new Error("Invalid HTML: could not find <table>");var a=e.match(/<\/table/i),i=s.index,o=a&&a.index||e.length,l=V6(e.slice(i,o),/(:?<tr[^>]*>)/i,"<tr>"),c=-1,u=0,d=0,m=0,p={s:{r:1e7,c:1e7},e:{r:0,c:0}},g=[];for(i=0;i<l.length;++i){var x=l[i].trim(),w=x.slice(0,3).toLowerCase();if(w=="<tr"){if(++c,r.sheetRows&&r.sheetRows<=c){--c;break}u=0;continue}if(!(w!="<td"&&w!="<th")){var k=x.split(/<\/t[dh]>/i);for(o=0;o<k.length;++o){var T=k[o].trim();if(T.match(/<t[dh]/i)){for(var E=T,N=0;E.charAt(0)=="<"&&(N=E.indexOf(">"))>-1;)E=E.slice(N+1);for(var M=0;M<g.length;++M){var O=g[M];O.s.c==u&&O.s.r<c&&c<=O.e.r&&(u=O.e.c+1,M=-1)}var v=Oe(T.slice(0,T.indexOf(">")));m=v.colspan?+v.colspan:1,((d=+v.rowspan)>1||m>1)&&g.push({s:{r:c,c:u},e:{r:c+(d||1)-1,c:u+m-1}});var _=v.t||v["data-t"]||"";if(!E.length){u+=m;continue}if(E=EA(E),p.s.r>c&&(p.s.r=c),p.e.r<c&&(p.e.r=c),p.s.c>u&&(p.s.c=u),p.e.c<u&&(p.e.c=u),!E.length){u+=m;continue}var S={t:"s",v:E};r.raw||!E.trim().length||_=="s"||(E==="TRUE"?S={t:"b",v:!0}:E==="FALSE"?S={t:"b",v:!1}:isNaN(cs(E))?isNaN(gl(E).getDate())||(S={t:"d",v:mr(E)},r.cellDates||(S={t:"n",v:en(S.v)}),S.z=r.dateNF||ze[14]):S={t:"n",v:cs(E)}),r.dense?(n[c]||(n[c]=[]),n[c][u]=S):n[Ue({r:c,c:u})]=S,u+=m}}}}return n["!ref"]=nt(p),g.length&&(n["!merges"]=g),n}function p7(e,t,r,n){for(var s=e["!merges"]||[],a=[],i=t.s.c;i<=t.e.c;++i){for(var o=0,l=0,c=0;c<s.length;++c)if(!(s[c].s.r>r||s[c].s.c>i)&&!(s[c].e.r<r||s[c].e.c<i)){if(s[c].s.r<r||s[c].s.c<i){o=-1;break}o=s[c].e.r-s[c].s.r+1,l=s[c].e.c-s[c].s.c+1;break}if(!(o<0)){var u=Ue({r,c:i}),d=n.dense?(e[r]||[])[i]:e[u],m=d&&d.v!=null&&(d.h||Zv(d.w||(ga(d),d.w)||""))||"",p={};o>1&&(p.rowspan=o),l>1&&(p.colspan=l),n.editable?m='<span contenteditable="true">'+m+"</span>":d&&(p["data-t"]=d&&d.t||"z",d.v!=null&&(p["data-v"]=d.v),d.z!=null&&(p["data-z"]=d.z),d.l&&(d.l.Target||"#").charAt(0)!="#"&&(m='<a href="'+d.l.Target+'">'+m+"</a>")),p.id=(n.id||"sjs")+"-"+u,a.push(t8("td",m,p))}}var g="<tr>";return g+a.join("")+"</tr>"}var g7='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',v7="</body></html>";function x7(e,t){var r=e.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!r||r.length==0)throw new Error("Invalid HTML: could not find <table>");if(r.length==1)return xi(zw(r[0],t),t);var n=vx();return r.forEach(function(s,a){xx(n,zw(s,t),"Sheet"+(a+1))}),n}function y7(e,t,r){var n=[];return n.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function _7(e,t){var r=t||{},n=r.header!=null?r.header:g7,s=r.footer!=null?r.footer:v7,a=[n],i=Il(e["!ref"]);r.dense=Array.isArray(e),a.push(y7(e,i,r));for(var o=i.s.r;o<=i.e.r;++o)a.push(p7(e,i,o,r));return a.push("</table>"+s),a.join("")}function II(e,t,r){var n=r||{},s=0,a=0;if(n.origin!=null)if(typeof n.origin=="number")s=n.origin;else{var i=typeof n.origin=="string"?Qr(n.origin):n.origin;s=i.r,a=i.c}var o=t.getElementsByTagName("tr"),l=Math.min(n.sheetRows||1e7,o.length),c={s:{r:0,c:0},e:{r:s,c:a}};if(e["!ref"]){var u=Il(e["!ref"]);c.s.r=Math.min(c.s.r,u.s.r),c.s.c=Math.min(c.s.c,u.s.c),c.e.r=Math.max(c.e.r,u.e.r),c.e.c=Math.max(c.e.c,u.e.c),s==-1&&(c.e.r=s=u.e.r+1)}var d=[],m=0,p=e["!rows"]||(e["!rows"]=[]),g=0,x=0,w=0,k=0,T=0,E=0;for(e["!cols"]||(e["!cols"]=[]);g<o.length&&x<l;++g){var N=o[g];if($w(N)){if(n.display)continue;p[x]={hidden:!0}}var M=N.children;for(w=k=0;w<M.length;++w){var O=M[w];if(!(n.display&&$w(O))){var v=O.hasAttribute("data-v")?O.getAttribute("data-v"):O.hasAttribute("v")?O.getAttribute("v"):EA(O.innerHTML),_=O.getAttribute("data-z")||O.getAttribute("z");for(m=0;m<d.length;++m){var S=d[m];S.s.c==k+a&&S.s.r<x+s&&x+s<=S.e.r&&(k=S.e.c+1-a,m=-1)}E=+O.getAttribute("colspan")||1,((T=+O.getAttribute("rowspan")||1)>1||E>1)&&d.push({s:{r:x+s,c:k+a},e:{r:x+s+(T||1)-1,c:k+a+(E||1)-1}});var I={t:"s",v},b=O.getAttribute("data-t")||O.getAttribute("t")||"";v!=null&&(v.length==0?I.t=b||"z":n.raw||v.trim().length==0||b=="s"||(v==="TRUE"?I={t:"b",v:!0}:v==="FALSE"?I={t:"b",v:!1}:isNaN(cs(v))?isNaN(gl(v).getDate())||(I={t:"d",v:mr(v)},n.cellDates||(I={t:"n",v:en(I.v)}),I.z=n.dateNF||ze[14]):I={t:"n",v:cs(v)})),I.z===void 0&&_!=null&&(I.z=_);var P="",R=O.getElementsByTagName("A");if(R&&R.length)for(var ue=0;ue<R.length&&!(R[ue].hasAttribute("href")&&(P=R[ue].getAttribute("href"),P.charAt(0)!="#"));++ue);P&&P.charAt(0)!="#"&&(I.l={Target:P}),n.dense?(e[x+s]||(e[x+s]=[]),e[x+s][k+a]=I):e[Ue({c:k+a,r:x+s})]=I,c.e.c<k+a&&(c.e.c=k+a),k+=E}}++x}return d.length&&(e["!merges"]=(e["!merges"]||[]).concat(d)),c.e.r=Math.max(c.e.r,x-1+s),e["!ref"]=nt(c),x>=l&&(e["!fullref"]=nt((c.e.r=o.length-g+x-1+s,c))),e}function CI(e,t){var r=t||{},n=r.dense?[]:{};return II(n,e,t)}function w7(e,t){return xi(CI(e,t),t)}function $w(e){var t="",r=E7(e);return r&&(t=r(e).getPropertyValue("display")),t||(t=e.style&&e.style.display),t==="none"}function E7(e){return e.ownerDocument.defaultView&&typeof e.ownerDocument.defaultView.getComputedStyle=="function"?e.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function T7(e){var t=e.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(n,s){return Array(parseInt(s,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),r=ot(t.replace(/<[^>]*>/g,""));return[r]}var Ww={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function NI(e,t){var r=t||{},n=ex(e),s=[],a,i,o={name:""},l="",c=0,u,d,m={},p=[],g=r.dense?[]:{},x,w,k={value:""},T="",E=0,N=[],M=-1,O=-1,v={s:{r:1e6,c:1e7},e:{r:0,c:0}},_=0,S={},I=[],b={},P=0,R=0,ue=[],le=1,he=1,pe=[],ee={Names:[]},H={},se=["",""],ce=[],B={},K="",X=0,G=!1,ie=!1,ge=0;for(fu.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");x=fu.exec(n);)switch(x[3]=x[3].replace(/_.*$/,"")){case"table":case"":x[1]==="/"?(v.e.c>=v.s.c&&v.e.r>=v.s.r?g["!ref"]=nt(v):g["!ref"]="A1:A1",r.sheetRows>0&&r.sheetRows<=v.e.r&&(g["!fullref"]=g["!ref"],v.e.r=r.sheetRows-1,g["!ref"]=nt(v)),I.length&&(g["!merges"]=I),ue.length&&(g["!rows"]=ue),u.name=u.||u.name,typeof JSON<"u"&&JSON.stringify(u),p.push(u.name),m[u.name]=g,ie=!1):x[0].charAt(x[0].length-2)!=="/"&&(u=Oe(x[0],!1),M=O=-1,v.s.r=v.s.c=1e7,v.e.r=v.e.c=0,g=r.dense?[]:{},I=[],ue=[],ie=!0);break;case"table-row-group":x[1]==="/"?--_:++_;break;case"table-row":case"":if(x[1]==="/"){M+=le,le=1;break}if(d=Oe(x[0],!1),d.?M=d.-1:M==-1&&(M=0),le=+d["number-rows-repeated"]||1,le<10)for(ge=0;ge<le;++ge)_>0&&(ue[M+ge]={level:_});O=-1;break;case"covered-table-cell":x[1]!=="/"&&++O,r.sheetStubs&&(r.dense?(g[M]||(g[M]=[]),g[M][O]={t:"z"}):g[Ue({r:M,c:O})]={t:"z"}),T="",N=[];break;case"table-cell":case"":if(x[0].charAt(x[0].length-2)==="/")++O,k=Oe(x[0],!1),he=parseInt(k["number-columns-repeated"]||"1",10),w={t:"z",v:null},k.formula&&r.cellFormula!=!1&&(w.f=jw(ot(k.formula))),(k.||k["value-type"])=="string"&&(w.t="s",w.v=ot(k["string-value"]||""),r.dense?(g[M]||(g[M]=[]),g[M][O]=w):g[Ue({r:M,c:O})]=w),O+=he-1;else if(x[1]!=="/"){++O,T="",E=0,N=[],he=1;var Ie=le?M+le-1:M;if(O>v.e.c&&(v.e.c=O),O<v.s.c&&(v.s.c=O),M<v.s.r&&(v.s.r=M),Ie>v.e.r&&(v.e.r=Ie),k=Oe(x[0],!1),ce=[],B={},w={t:k.||k["value-type"],v:null},r.cellFormula)if(k.formula&&(k.formula=ot(k.formula)),k["number-matrix-columns-spanned"]&&k["number-matrix-rows-spanned"]&&(P=parseInt(k["number-matrix-rows-spanned"],10)||0,R=parseInt(k["number-matrix-columns-spanned"],10)||0,b={s:{r:M,c:O},e:{r:M+P-1,c:O+R-1}},w.F=nt(b),pe.push([b,w.F])),k.formula)w.f=jw(k.formula);else for(ge=0;ge<pe.length;++ge)M>=pe[ge][0].s.r&&M<=pe[ge][0].e.r&&O>=pe[ge][0].s.c&&O<=pe[ge][0].e.c&&(w.F=pe[ge][1]);switch((k["number-columns-spanned"]||k["number-rows-spanned"])&&(P=parseInt(k["number-rows-spanned"],10)||0,R=parseInt(k["number-columns-spanned"],10)||0,b={s:{r:M,c:O},e:{r:M+P-1,c:O+R-1}},I.push(b)),k["number-columns-repeated"]&&(he=parseInt(k["number-columns-repeated"],10)),w.t){case"boolean":w.t="b",w.v=bt(k["boolean-value"]);break;case"float":w.t="n",w.v=parseFloat(k.value);break;case"percentage":w.t="n",w.v=parseFloat(k.value);break;case"currency":w.t="n",w.v=parseFloat(k.value);break;case"date":w.t="d",w.v=mr(k["date-value"]),r.cellDates||(w.t="n",w.v=en(w.v)),w.z="m/d/yy";break;case"time":w.t="n",w.v=M6(k["time-value"])/86400,r.cellDates&&(w.t="d",w.v=n0(w.v)),w.z="HH:MM:SS";break;case"number":w.t="n",w.v=parseFloat(k.);break;default:if(w.t==="string"||w.t==="text"||!w.t)w.t="s",k["string-value"]!=null&&(T=ot(k["string-value"]),N=[]);else throw new Error("Unsupported value type "+w.t)}}else{if(G=!1,w.t==="s"&&(w.v=T||"",N.length&&(w.R=N),G=E==0),H.Target&&(w.l=H),ce.length>0&&(w.c=ce,ce=[]),T&&r.cellText!==!1&&(w.w=T),G&&(w.t="z",delete w.v),(!G||r.sheetStubs)&&!(r.sheetRows&&r.sheetRows<=M))for(var Te=0;Te<le;++Te){if(he=parseInt(k["number-columns-repeated"]||"1",10),r.dense)for(g[M+Te]||(g[M+Te]=[]),g[M+Te][O]=Te==0?w:Sr(w);--he>0;)g[M+Te][O+he]=Sr(w);else for(g[Ue({r:M+Te,c:O})]=w;--he>0;)g[Ue({r:M+Te,c:O+he})]=Sr(w);v.e.c<=O&&(v.e.c=O)}he=parseInt(k["number-columns-repeated"]||"1",10),O+=he-1,he=0,w={},T="",N=[]}H={};break;case"document":case"document-content":case"":case"spreadsheet":case"":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(x[1]==="/"){if((a=s.pop())[0]!==x[3])throw"Bad state: "+a}else x[0].charAt(x[0].length-2)!=="/"&&s.push([x[3],!0]);break;case"annotation":if(x[1]==="/"){if((a=s.pop())[0]!==x[3])throw"Bad state: "+a;B.t=T,N.length&&(B.R=N),B.a=K,ce.push(B)}else x[0].charAt(x[0].length-2)!=="/"&&s.push([x[3],!1]);K="",X=0,T="",E=0,N=[];break;case"creator":x[1]==="/"?K=n.slice(X,x.index):X=x.index+x[0].length;break;case"meta":case"":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(x[1]==="/"){if((a=s.pop())[0]!==x[3])throw"Bad state: "+a}else x[0].charAt(x[0].length-2)!=="/"&&s.push([x[3],!1]);T="",E=0,N=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(x[1]==="/"){if(S[o.name]=l,(a=s.pop())[0]!==x[3])throw"Bad state: "+a}else x[0].charAt(x[0].length-2)!=="/"&&(l="",o=Oe(x[0],!1),s.push([x[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(s[s.length-1][0]){case"time-style":case"date-style":i=Oe(x[0],!1),l+=Ww[x[3]][i.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(s[s.length-1][0]){case"time-style":case"date-style":i=Oe(x[0],!1),l+=Ww[x[3]][i.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(x[0].slice(-2)==="/>")break;if(x[1]==="/")switch(s[s.length-1][0]){case"number-style":case"date-style":case"time-style":l+=n.slice(c,x.index);break}else c=x.index+x[0].length;break;case"named-range":i=Oe(x[0],!1),se=am(i["cell-range-address"]);var ye={Name:i.name,Ref:se[0]+"!"+se[1]};ie&&(ye.Sheet=p.length),ee.Names.push(ye);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"":if(["master-styles"].indexOf(s[s.length-1][0])>-1)break;if(x[1]==="/"&&(!k||!k["string-value"])){var $e=T7(n.slice(E,x.index));T=(T.length>0?T+`
`:"")+$e[0]}else Oe(x[0],!1),E=x.index+x[0].length;break;case"s":break;case"database-range":if(x[1]==="/")break;try{se=am(Oe(x[0])["target-range-address"]),m[se[0]]["!autofilter"]={ref:se[1]}}catch{}break;case"date":break;case"object":break;case"title":case"":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(x[1]!=="/"){if(H=Oe(x[0],!1),!H.href)break;H.Target=ot(H.href),delete H.href,H.Target.charAt(0)=="#"&&H.Target.indexOf(".")>-1?(se=am(H.Target.slice(1)),H.Target="#"+se[0]+"!"+se[1]):H.Target.match(/^\.\.[\\\/]/)&&(H.Target=H.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(x[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case":":case":":break;default:if(r.WTF)throw new Error(x)}}var W={Sheets:m,SheetNames:p,Workbook:ee};return r.bookSheets&&delete W.Sheets,W}function Hw(e,t){t=t||{},On(e,"META-INF/manifest.xml")&&V8(Xt(e,"META-INF/manifest.xml"),t);var r=wn(e,"content.xml");if(!r)throw new Error("Missing content.xml in ODS / UOF file");var n=NI(Et(r),t);return On(e,"meta.xml")&&(n.Props=zA(Xt(e,"meta.xml"))),n}function Gw(e,t){return NI(e,t)}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function dx(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function Bp(e){return typeof TextDecoder<"u"?new TextDecoder().decode(e):Et(oo(e))}function zp(e){var t=e.reduce(function(s,a){return s+a.length},0),r=new Uint8Array(t),n=0;return e.forEach(function(s){r.set(s,n),n+=s.length}),r}function Kw(e){return e-=e>>1&1431655765,e=(e&858993459)+(e>>2&858993459),(e+(e>>4)&252645135)*16843009>>>24}function k7(e,t){for(var r=(e[t+15]&127)<<7|e[t+14]>>1,n=e[t+14]&1,s=t+13;s>=t;--s)n=n*256+e[s];return(e[t+15]&128?-n:n)*Math.pow(10,r-6176)}function pu(e,t){var r=t?t[0]:0,n=e[r]&127;e:if(e[r++]>=128&&(n|=(e[r]&127)<<7,e[r++]<128||(n|=(e[r]&127)<<14,e[r++]<128)||(n|=(e[r]&127)<<21,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,28),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,35),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,42),++r,e[r++]<128)))break e;return t&&(t[0]=r),n}function or(e){var t=0,r=e[t]&127;e:if(e[t++]>=128){if(r|=(e[t]&127)<<7,e[t++]<128||(r|=(e[t]&127)<<14,e[t++]<128)||(r|=(e[t]&127)<<21,e[t++]<128))break e;r|=(e[t]&127)<<28}return r}function Br(e){for(var t=[],r=[0];r[0]<e.length;){var n=r[0],s=pu(e,r),a=s&7;s=Math.floor(s/8);var i=0,o;if(s==0)break;switch(a){case 0:{for(var l=r[0];e[r[0]++]>=128;);o=e.slice(l,r[0])}break;case 5:i=4,o=e.slice(r[0],r[0]+i),r[0]+=i;break;case 1:i=8,o=e.slice(r[0],r[0]+i),r[0]+=i;break;case 2:i=pu(e,r),o=e.slice(r[0],r[0]+i),r[0]+=i;break;case 3:case 4:default:throw new Error("PB Type ".concat(a," for Field ").concat(s," at offset ").concat(n))}var c={data:o,type:a};t[s]==null?t[s]=[c]:t[s].push(c)}return t}function mx(e,t){return(e==null?void 0:e.map(function(r){return t(r.data)}))||[]}function S7(e){for(var t,r=[],n=[0];n[0]<e.length;){var s=pu(e,n),a=Br(e.slice(n[0],n[0]+s));n[0]+=s;var i={id:or(a[1][0].data),messages:[]};a[2].forEach(function(o){var l=Br(o.data),c=or(l[3][0].data);i.messages.push({meta:l,data:e.slice(n[0],n[0]+c)}),n[0]+=c}),(t=a[3])!=null&&t[0]&&(i.merge=or(a[3][0].data)>>>0>0),r.push(i)}return r}function A7(e,t){if(e!=0)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var r=[0],n=pu(t,r),s=[];r[0]<t.length;){var a=t[r[0]]&3;if(a==0){var i=t[r[0]++]>>2;if(i<60)++i;else{var o=i-59;i=t[r[0]],o>1&&(i|=t[r[0]+1]<<8),o>2&&(i|=t[r[0]+2]<<16),o>3&&(i|=t[r[0]+3]<<24),i>>>=0,i++,r[0]+=o}s.push(t.slice(r[0],r[0]+i)),r[0]+=i;continue}else{var l=0,c=0;if(a==1?(c=(t[r[0]]>>2&7)+4,l=(t[r[0]++]&224)<<3,l|=t[r[0]++]):(c=(t[r[0]++]>>2)+1,a==2?(l=t[r[0]]|t[r[0]+1]<<8,r[0]+=2):(l=(t[r[0]]|t[r[0]+1]<<8|t[r[0]+2]<<16|t[r[0]+3]<<24)>>>0,r[0]+=4)),s=[zp(s)],l==0)throw new Error("Invalid offset 0");if(l>s[0].length)throw new Error("Invalid offset beyond length");if(c>=l)for(s.push(s[0].slice(-l)),c-=l;c>=s[s.length-1].length;)s.push(s[s.length-1]),c-=s[s.length-1].length;s.push(s[0].slice(-l,-l+c))}}var u=zp(s);if(u.length!=n)throw new Error("Unexpected length: ".concat(u.length," != ").concat(n));return u}function I7(e){for(var t=[],r=0;r<e.length;){var n=e[r++],s=e[r]|e[r+1]<<8|e[r+2]<<16;r+=3,t.push(A7(n,e.slice(r,r+s))),r+=s}if(r!==e.length)throw new Error("data is not a valid framed stream!");return zp(t)}function C7(e,t,r,n){var s=dx(e),a=s.getUint32(4,!0),i=(n>1?12:8)+Kw(a&(n>1?3470:398))*4,o=-1,l=-1,c=NaN,u=new Date(2001,0,1);a&512&&(o=s.getUint32(i,!0),i+=4),i+=Kw(a&(n>1?12288:4096))*4,a&16&&(l=s.getUint32(i,!0),i+=4),a&32&&(c=s.getFloat64(i,!0),i+=8),a&64&&(u.setTime(u.getTime()+s.getFloat64(i,!0)*1e3),i+=8);var d;switch(e[2]){case 0:break;case 2:d={t:"n",v:c};break;case 3:d={t:"s",v:t[l]};break;case 5:d={t:"d",v:u};break;case 6:d={t:"b",v:c>0};break;case 7:d={t:"n",v:c/86400};break;case 8:d={t:"e",v:0};break;case 9:if(o>-1)d={t:"s",v:r[o]};else if(l>-1)d={t:"s",v:t[l]};else if(!isNaN(c))d={t:"n",v:c};else throw new Error("Unsupported cell type ".concat(e.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(e.slice(0,4)))}return d}function N7(e,t,r){var n=dx(e),s=n.getUint32(8,!0),a=12,i=-1,o=-1,l=NaN,c=NaN,u=new Date(2001,0,1);s&1&&(l=k7(e,a),a+=16),s&2&&(c=n.getFloat64(a,!0),a+=8),s&4&&(u.setTime(u.getTime()+n.getFloat64(a,!0)*1e3),a+=8),s&8&&(o=n.getUint32(a,!0),a+=4),s&16&&(i=n.getUint32(a,!0),a+=4);var d;switch(e[1]){case 0:break;case 2:d={t:"n",v:l};break;case 3:d={t:"s",v:t[o]};break;case 5:d={t:"d",v:u};break;case 6:d={t:"b",v:c>0};break;case 7:d={t:"n",v:c/86400};break;case 8:d={t:"e",v:0};break;case 9:if(i>-1)d={t:"s",v:r[i]};else throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(s&31," : ").concat(e.slice(0,4)));break;case 10:d={t:"n",v:l};break;default:throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(s&31," : ").concat(e.slice(0,4)))}return d}function R7(e,t,r){switch(e[0]){case 0:case 1:case 2:case 3:return C7(e,t,r,e[0]);case 5:return N7(e,t,r);default:throw new Error("Unsupported payload version ".concat(e[0]))}}function ri(e){var t=Br(e);return pu(t[1][0].data)}function qw(e,t){var r=Br(t.data),n=or(r[1][0].data),s=r[3],a=[];return(s||[]).forEach(function(i){var o=Br(i.data),l=or(o[1][0].data)>>>0;switch(n){case 1:a[l]=Bp(o[3][0].data);break;case 8:{var c=e[ri(o[9][0].data)][0],u=Br(c.data),d=e[ri(u[1][0].data)][0],m=or(d.meta[1][0].data);if(m!=2001)throw new Error("2000 unexpected reference to ".concat(m));var p=Br(d.data);a[l]=p[3].map(function(g){return Bp(g.data)}).join("")}break}}),a}function b7(e,t){var r,n,s,a,i,o,l,c,u,d,m,p,g,x,w=Br(e),k=or(w[1][0].data)>>>0,T=or(w[2][0].data)>>>0,E=((n=(r=w[8])==null?void 0:r[0])==null?void 0:n.data)&&or(w[8][0].data)>0||!1,N,M;if((a=(s=w[7])==null?void 0:s[0])!=null&&a.data&&t!=0)N=(o=(i=w[7])==null?void 0:i[0])==null?void 0:o.data,M=(c=(l=w[6])==null?void 0:l[0])==null?void 0:c.data;else if((d=(u=w[4])==null?void 0:u[0])!=null&&d.data&&t!=1)N=(p=(m=w[4])==null?void 0:m[0])==null?void 0:p.data,M=(x=(g=w[3])==null?void 0:g[0])==null?void 0:x.data;else throw"NUMBERS Tile missing ".concat(t," cell storage");for(var O=E?4:1,v=dx(N),_=[],S=0;S<N.length/2;++S){var I=v.getUint16(S*2,!0);I<65535&&_.push([S,I])}if(_.length!=T)throw"Expected ".concat(T," cells, found ").concat(_.length);var b=[];for(S=0;S<_.length-1;++S)b[_[S][0]]=M.subarray(_[S][1]*O,_[S+1][1]*O);return _.length>=1&&(b[_[_.length-1][0]]=M.subarray(_[_.length-1][1]*O)),{R:k,cells:b}}function P7(e,t){var r,n=Br(t.data),s=(r=n==null?void 0:n[7])!=null&&r[0]?or(n[7][0].data)>>>0>0?1:0:-1,a=mx(n[5],function(i){return b7(i,s)});return{nrows:or(n[4][0].data)>>>0,data:a.reduce(function(i,o){return i[o.R]||(i[o.R]=[]),o.cells.forEach(function(l,c){if(i[o.R][c])throw new Error("Duplicate cell r=".concat(o.R," c=").concat(c));i[o.R][c]=l}),i},[])}}function D7(e,t,r){var n,s=Br(t.data),a={s:{r:0,c:0},e:{r:0,c:0}};if(a.e.r=(or(s[6][0].data)>>>0)-1,a.e.r<0)throw new Error("Invalid row varint ".concat(s[6][0].data));if(a.e.c=(or(s[7][0].data)>>>0)-1,a.e.c<0)throw new Error("Invalid col varint ".concat(s[7][0].data));r["!ref"]=nt(a);var i=Br(s[4][0].data),o=qw(e,e[ri(i[4][0].data)][0]),l=(n=i[17])!=null&&n[0]?qw(e,e[ri(i[17][0].data)][0]):[],c=Br(i[3][0].data),u=0;c[1].forEach(function(d){var m=Br(d.data),p=e[ri(m[2][0].data)][0],g=or(p.meta[1][0].data);if(g!=6002)throw new Error("6001 unexpected reference to ".concat(g));var x=P7(e,p);x.data.forEach(function(w,k){w.forEach(function(T,E){var N=Ue({r:u+k,c:E}),M=R7(T,o,l);M&&(r[N]=M)})}),u+=x.nrows})}function F7(e,t){var r=Br(t.data),n={"!ref":"A1"},s=e[ri(r[2][0].data)],a=or(s[0].meta[1][0].data);if(a!=6001)throw new Error("6000 unexpected reference to ".concat(a));return D7(e,s[0],n),n}function O7(e,t){var r,n=Br(t.data),s={name:(r=n[1])!=null&&r[0]?Bp(n[1][0].data):"",sheets:[]},a=mx(n[2],ri);return a.forEach(function(i){e[i].forEach(function(o){var l=or(o.meta[1][0].data);l==6e3&&s.sheets.push(F7(e,o))})}),s}function M7(e,t){var r=vx(),n=Br(t.data),s=mx(n[1],ri);if(s.forEach(function(a){e[a].forEach(function(i){var o=or(i.meta[1][0].data);if(o==2){var l=O7(e,i);l.sheets.forEach(function(c,u){xx(r,c,u==0?l.name:l.name+"_"+u,!0)})}})}),r.SheetNames.length==0)throw new Error("Empty NUMBERS file");return r}function om(e){var t,r,n,s,a={},i=[];if(e.FullPaths.forEach(function(l){if(l.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),e.FileIndex.forEach(function(l){if(l.name.match(/\.iwa$/)){var c;try{c=I7(l.content)}catch(d){return console.log("?? "+l.content.length+" "+(d.message||d))}var u;try{u=S7(c)}catch(d){return console.log("## "+(d.message||d))}u.forEach(function(d){a[d.id]=d.messages,i.push(d.id)})}}),!i.length)throw new Error("File has no messages");var o=((s=(n=(r=(t=a==null?void 0:a[1])==null?void 0:t[0])==null?void 0:r.meta)==null?void 0:n[1])==null?void 0:s[0].data)&&or(a[1][0].meta[1][0].data)==1&&a[1][0];if(o||i.forEach(function(l){a[l].forEach(function(c){var u=or(c.meta[1][0].data)>>>0;if(u==1)if(!o)o=c;else throw new Error("Document has multiple roots")})}),!o)throw new Error("Cannot find Document root");return M7(a,o)}function L7(e){return function(r){for(var n=0;n!=e.length;++n){var s=e[n];r[s[0]]===void 0&&(r[s[0]]=s[1]),s[2]==="n"&&(r[s[0]]=Number(r[s[0]]))}}}function px(e){L7([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(e)}function j7(e){return jo.WS.indexOf(e)>-1?"sheet":e==jo.CS?"chart":e==jo.DS?"dialog":e==jo.MS?"macro":e&&e.length?e:"sheet"}function V7(e,t){if(!e)return 0;try{e=t.map(function(n){return n.id||(n.id=n.strRelID),[n.name,e["!id"][n.id].Target,j7(e["!id"][n.id].Type)]})}catch{return null}return!e||e.length===0?null:e}function U7(e,t,r,n,s,a,i,o,l,c,u,d){try{a[n]=Ic(wn(e,r,!0),t);var m=Xt(e,t),p;switch(o){case"sheet":p=GB(m,t,s,l,a[n],c,u,d);break;case"chart":if(p=KB(m,t,s,l,a[n],c,u,d),!p||!p["!drawel"])break;var g=oc(p["!drawel"].Target,t),x=Mp(g),w=H9(wn(e,g,!0),Ic(wn(e,x,!0),g)),k=oc(w,g),T=Mp(k);p=NB(wn(e,k,!0),k,l,Ic(wn(e,T,!0),k),c,p);break;case"macro":p=qB(m,t,s,l,a[n],c,u,d);break;case"dialog":p=XB(m,t,s,l,a[n],c,u,d);break;default:throw new Error("Unrecognized sheet type "+o)}i[n]=p;var E=[];a&&a[n]&&bs(a[n]).forEach(function(N){var M="";if(a[n][N].Type==jo.CMNT){M=oc(a[n][N].Target,t);var O=ZB(Xt(e,M,!0),M,l);if(!O||!O.length)return;Dw(p,O,!1)}a[n][N].Type==jo.TCMNT&&(M=oc(a[n][N].Target,t),E=E.concat(K9(Xt(e,M,!0),l)))}),E&&E.length&&Dw(p,E,!0,l.people||[])}catch(N){if(l.WTF)throw N}}function Dn(e){return e.charAt(0)=="/"?e.slice(1):e}function B7(e,t){if(dA(),t=t||{},px(t),On(e,"META-INF/manifest.xml")||On(e,"objectdata.xml"))return Hw(e,t);if(On(e,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof om<"u"){if(e.FileIndex)return om(e);var r=rt.utils.cfb_new();return iw(e).forEach(function(ue){z6(r,ue,B6(e,ue))}),om(r)}throw new Error("Unsupported NUMBERS file")}if(!On(e,"[Content_Types].xml"))throw On(e,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):On(e,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var n=iw(e),s=L8(wn(e,"[Content_Types].xml")),a=!1,i,o;if(s.workbooks.length===0&&(o="xl/workbook.xml",Xt(e,o,!0)&&s.workbooks.push(o)),s.workbooks.length===0){if(o="xl/workbook.bin",!Xt(e,o,!0))throw new Error("Could not find workbook");s.workbooks.push(o),a=!0}s.workbooks[0].slice(-3)=="bin"&&(a=!0);var l={},c={};if(!t.bookSheets&&!t.bookProps){if(Rc=[],s.sst)try{Rc=JB(Xt(e,Dn(s.sst)),s.sst,t)}catch(ue){if(t.WTF)throw ue}t.cellStyles&&s.themes.length&&(l=QB(wn(e,s.themes[0].replace(/^\//,""),!0)||"",s.themes[0],t)),s.style&&(c=YB(Xt(e,Dn(s.style)),s.style,l,t))}s.links.map(function(ue){try{var le=Ic(wn(e,Mp(Dn(ue))),ue);return t7(Xt(e,Dn(ue)),le,ue,t)}catch{}});var u=HB(Xt(e,Dn(s.workbooks[0])),s.workbooks[0],t),d={},m="";s.coreprops.length&&(m=Xt(e,Dn(s.coreprops[0]),!0),m&&(d=zA(m)),s.extprops.length!==0&&(m=Xt(e,Dn(s.extprops[0]),!0),m&&z8(m,d,t)));var p={};(!t.bookSheets||t.bookProps)&&s.custprops.length!==0&&(m=wn(e,Dn(s.custprops[0]),!0),m&&(p=W8(m,t)));var g={};if((t.bookSheets||t.bookProps)&&(u.Sheets?i=u.Sheets.map(function(le){return le.name}):d.Worksheets&&d.SheetNames.length>0&&(i=d.SheetNames),t.bookProps&&(g.Props=d,g.Custprops=p),t.bookSheets&&typeof i<"u"&&(g.SheetNames=i),t.bookSheets?g.SheetNames:t.bookProps))return g;i={};var x={};t.bookDeps&&s.calcchain&&(x=e7(Xt(e,Dn(s.calcchain)),s.calcchain));var w=0,k={},T,E;{var N=u.Sheets;d.Worksheets=N.length,d.SheetNames=[];for(var M=0;M!=N.length;++M)d.SheetNames[M]=N[M].name}var O=a?"bin":"xml",v=s.workbooks[0].lastIndexOf("/"),_=(s.workbooks[0].slice(0,v+1)+"_rels/"+s.workbooks[0].slice(v+1)+".rels").replace(/^\//,"");On(e,_)||(_="xl/_rels/workbook."+O+".rels");var S=Ic(wn(e,_,!0),_.replace(/_rels.*/,"s5s"));(s.metadata||[]).length>=1&&(t.xlmeta=r7(Xt(e,Dn(s.metadata[0])),s.metadata[0],t)),(s.people||[]).length>=1&&(t.people=q9(Xt(e,Dn(s.people[0])),t)),S&&(S=V7(S,u.Sheets));var I=Xt(e,"xl/worksheets/sheet.xml",!0)?1:0;e:for(w=0;w!=d.Worksheets;++w){var b="sheet";if(S&&S[w]?(T="xl/"+S[w][1].replace(/[\/]?xl\//,""),On(e,T)||(T=S[w][1]),On(e,T)||(T=_.replace(/_rels\/.*$/,"")+S[w][1]),b=S[w][2]):(T="xl/worksheets/sheet"+(w+1-I)+"."+O,T=T.replace(/sheet0\./,"sheet.")),E=T.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),t&&t.sheets!=null)switch(typeof t.sheets){case"number":if(w!=t.sheets)continue e;break;case"string":if(d.SheetNames[w].toLowerCase()!=t.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(t.sheets)){for(var P=!1,R=0;R!=t.sheets.length;++R)typeof t.sheets[R]=="number"&&t.sheets[R]==w&&(P=1),typeof t.sheets[R]=="string"&&t.sheets[R].toLowerCase()==d.SheetNames[w].toLowerCase()&&(P=1);if(!P)continue e}}U7(e,T,E,d.SheetNames[w],w,k,i,b,t,u,l,c)}return g={Directory:s,Workbook:u,Props:d,Custprops:p,Deps:x,Sheets:i,SheetNames:d.SheetNames,Strings:Rc,Styles:c,Themes:l,SSF:Sr(ze)},t&&t.bookFiles&&(e.files?(g.keys=n,g.files=e.files):(g.keys=[],g.files={},e.FullPaths.forEach(function(ue,le){ue=ue.replace(/^Root Entry[\/]/,""),g.keys.push(ue),g.files[ue]=e.FileIndex[le]}))),t&&t.bookVBA&&(s.vba.length>0?g.vbaraw=Xt(e,Dn(s.vba[0]),!0):s.defaults&&s.defaults.bin===J9&&(g.vbaraw=Xt(e,"xl/vbaProject.bin",!0))),g}function z7(e,t){var r=t||{},n="Workbook",s=rt.find(e,n);try{if(n="/!DataSpaces/Version",s=rt.find(e,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(Fj(s.content),n="/!DataSpaces/DataSpaceMap",s=rt.find(e,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);var a=Mj(s.content);if(a.length!==1||a[0].comps.length!==1||a[0].comps[0].t!==0||a[0].name!=="StrongEncryptionDataSpace"||a[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",s=rt.find(e,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);var i=Lj(s.content);if(i.length!=1||i[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",s=rt.find(e,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);Vj(s.content)}catch{}if(n="/EncryptionInfo",s=rt.find(e,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);var o=Uj(s.content);if(n="/EncryptedPackage",s=rt.find(e,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(o[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(o[1],s.content,r.password||"",r);if(o[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(o[1],s.content,r.password||"",r);throw new Error("File is password-protected")}function gx(e,t){var r="";switch((t||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":r=An(e.slice(0,12));break;case"binary":r=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(t&&t.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function $7(e,t){return rt.find(e,"EncryptedPackage")?z7(e,t):AI(e,t)}function W7(e,t){var r,n=e,s=t||{};return s.type||(s.type=Qe&&Buffer.isBuffer(e)?"buffer":"base64"),r=yA(n,s),B7(r,s)}function RI(e,t){var r=0;e:for(;r<e.length;)switch(e.charCodeAt(r)){case 10:case 13:case 32:++r;break;case 60:return Vp(e.slice(r),t);default:break e}return hu.to_workbook(e,t)}function H7(e,t){var r="",n=gx(e,t);switch(t.type){case"base64":r=An(e);break;case"binary":r=e;break;case"buffer":r=e.toString("binary");break;case"array":r=Ji(e);break;default:throw new Error("Unrecognized type "+t.type)}return n[0]==239&&n[1]==187&&n[2]==191&&(r=Et(r)),t.type="binary",RI(r,t)}function G7(e,t){var r=e;return t.type=="base64"&&(r=An(r)),r=lu.utils.decode(1200,r.slice(2),"str"),t.type="binary",RI(r,t)}function K7(e){return e.match(/[^\x00-\x7F]/)?lc(e):e}function lm(e,t,r,n){return n?(r.type="string",hu.to_workbook(e,r)):hu.to_workbook(t,r)}function $p(e,t){tA();var r=t||{};if(typeof ArrayBuffer<"u"&&e instanceof ArrayBuffer)return $p(new Uint8Array(e),(r=Sr(r),r.type="array",r));typeof Uint8Array<"u"&&e instanceof Uint8Array&&!r.type&&(r.type=typeof Deno<"u"?"buffer":"array");var n=e,s=[0,0,0,0],a=!1;if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),Jo={},r.dateNF&&(Jo.dateNF=r.dateNF),r.type||(r.type=Qe&&Buffer.isBuffer(e)?"buffer":"base64"),r.type=="file"&&(r.type=Qe?"buffer":"binary",n=F6(e),typeof Uint8Array<"u"&&!Qe&&(r.type="array")),r.type=="string"&&(a=!0,r.type="binary",r.codepage=65001,n=K7(e)),r.type=="array"&&typeof Uint8Array<"u"&&e instanceof Uint8Array&&typeof ArrayBuffer<"u"){var i=new ArrayBuffer(3),o=new Uint8Array(i);if(o.foo="bar",!o.foo)return r=Sr(r),r.type="array",$p(qv(n),r)}switch((s=gx(n,r))[0]){case 208:if(s[1]===207&&s[2]===17&&s[3]===224&&s[4]===161&&s[5]===177&&s[6]===26&&s[7]===225)return $7(rt.read(n,r),r);break;case 9:if(s[1]<=8)return AI(n,r);break;case 60:return Vp(n,r);case 73:if(s[1]===73&&s[2]===42&&s[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(s[1]===68)return wj(n,r);break;case 84:if(s[1]===65&&s[2]===66&&s[3]===76)return yj.to_workbook(n,r);break;case 80:return s[1]===75&&s[2]<9&&s[3]<9?W7(n,r):lm(e,n,r,a);case 239:return s[3]===60?Vp(n,r):lm(e,n,r,a);case 255:if(s[1]===254)return G7(n,r);if(s[1]===0&&s[2]===2&&s[3]===0)return Nc.to_workbook(n,r);break;case 0:if(s[1]===0&&(s[2]>=2&&s[3]===0||s[2]===0&&(s[3]===8||s[3]===9)))return Nc.to_workbook(n,r);break;case 3:case 131:case 139:case 140:return Pw.to_workbook(n,r);case 123:if(s[1]===92&&s[2]===114&&s[3]===116)return Jj.to_workbook(n,r);break;case 10:case 13:case 32:return H7(n,r);case 137:if(s[1]===80&&s[2]===78&&s[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return vj.indexOf(s[0])>-1&&s[2]<=12&&s[3]<=31?Pw.to_workbook(n,r):lm(e,n,r,a)}function q7(e,t,r,n,s,a,i,o){var l=Ar(r),c=o.defval,u=o.raw||!Object.prototype.hasOwnProperty.call(o,"raw"),d=!0,m=s===1?[]:{};if(s!==1)if(Object.defineProperty)try{Object.defineProperty(m,"__rowNum__",{value:r,enumerable:!1})}catch{m.__rowNum__=r}else m.__rowNum__=r;if(!i||e[r])for(var p=t.s.c;p<=t.e.c;++p){var g=i?e[r][p]:e[n[p]+l];if(g===void 0||g.t===void 0){if(c===void 0)continue;a[p]!=null&&(m[a[p]]=c);continue}var x=g.v;switch(g.t){case"z":if(x==null)break;continue;case"e":x=x==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+g.t)}if(a[p]!=null){if(x==null)if(g.t=="e"&&x===null)m[a[p]]=null;else if(c!==void 0)m[a[p]]=c;else if(u&&x===null)m[a[p]]=null;else continue;else m[a[p]]=u&&(g.t!=="n"||g.t==="n"&&o.rawNumbers!==!1)?x:ga(g,x,o);x!=null&&(d=!1)}}return{row:m,isempty:d}}function Wp(e,t){if(e==null||e["!ref"]==null)return[];var r={t:"n",v:0},n=0,s=1,a=[],i=0,o="",l={s:{r:0,c:0},e:{r:0,c:0}},c=t||{},u=c.range!=null?c.range:e["!ref"];switch(c.header===1?n=1:c.header==="A"?n=2:Array.isArray(c.header)?n=3:c.header==null&&(n=0),typeof u){case"string":l=Bt(u);break;case"number":l=Bt(e["!ref"]),l.s.r=u;break;default:l=u}n>0&&(s=0);var d=Ar(l.s.r),m=[],p=[],g=0,x=0,w=Array.isArray(e),k=l.s.r,T=0,E={};w&&!e[k]&&(e[k]=[]);var N=c.skipHidden&&e["!cols"]||[],M=c.skipHidden&&e["!rows"]||[];for(T=l.s.c;T<=l.e.c;++T)if(!(N[T]||{}).hidden)switch(m[T]=sr(T),r=w?e[k][T]:e[m[T]+d],n){case 1:a[T]=T-l.s.c;break;case 2:a[T]=m[T];break;case 3:a[T]=c.header[T-l.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),o=i=ga(r,null,c),x=E[i]||0,!x)E[i]=1;else{do o=i+"_"+x++;while(E[o]);E[i]=x,E[o]=1}a[T]=o}for(k=l.s.r+s;k<=l.e.r;++k)if(!(M[k]||{}).hidden){var O=q7(e,l,k,m,n,a,w,c);(O.isempty===!1||(n===1?c.blankrows!==!1:c.blankrows))&&(p[g++]=O.row)}return p.length=g,p}var Xw=/"/g;function X7(e,t,r,n,s,a,i,o){for(var l=!0,c=[],u="",d=Ar(r),m=t.s.c;m<=t.e.c;++m)if(n[m]){var p=o.dense?(e[r]||[])[m]:e[n[m]+d];if(p==null)u="";else if(p.v!=null){l=!1,u=""+(o.rawNumbers&&p.t=="n"?p.v:ga(p,null,o));for(var g=0,x=0;g!==u.length;++g)if((x=u.charCodeAt(g))===s||x===a||x===34||o.forceQuotes){u='"'+u.replace(Xw,'""')+'"';break}u=="ID"&&(u='"ID"')}else p.f!=null&&!p.F?(l=!1,u="="+p.f,u.indexOf(",")>=0&&(u='"'+u.replace(Xw,'""')+'"')):u="";c.push(u)}return o.blankrows===!1&&l?null:c.join(i)}function bI(e,t){var r=[],n=t??{};if(e==null||e["!ref"]==null)return"";var s=Bt(e["!ref"]),a=n.FS!==void 0?n.FS:",",i=a.charCodeAt(0),o=n.RS!==void 0?n.RS:`
`,l=o.charCodeAt(0),c=new RegExp((a=="|"?"\\|":a)+"+$"),u="",d=[];n.dense=Array.isArray(e);for(var m=n.skipHidden&&e["!cols"]||[],p=n.skipHidden&&e["!rows"]||[],g=s.s.c;g<=s.e.c;++g)(m[g]||{}).hidden||(d[g]=sr(g));for(var x=0,w=s.s.r;w<=s.e.r;++w)(p[w]||{}).hidden||(u=X7(e,s,w,d,i,l,a,n),u!=null&&(n.strip&&(u=u.replace(c,"")),(u||n.blankrows!==!1)&&r.push((x++?o:"")+u)));return delete n.dense,r.join("")}function Y7(e,t){t||(t={}),t.FS="	",t.RS=`
`;var r=bI(e,t);return r}function Q7(e){var t="",r,n="";if(e==null||e["!ref"]==null)return[];var s=Bt(e["!ref"]),a="",i=[],o,l=[],c=Array.isArray(e);for(o=s.s.c;o<=s.e.c;++o)i[o]=sr(o);for(var u=s.s.r;u<=s.e.r;++u)for(a=Ar(u),o=s.s.c;o<=s.e.c;++o)if(t=i[o]+a,r=c?(e[u]||[])[o]:e[t],n="",r!==void 0){if(r.F!=null){if(t=r.F,!r.f)continue;n=r.f,t.indexOf(":")==-1&&(t=t+":"+t)}if(r.f!=null)n=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)n=""+r.v;else if(r.t=="b")n=r.v?"TRUE":"FALSE";else if(r.w!==void 0)n="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?n="'"+r.v:n=""+r.v}}l[l.length]=t+"="+n}return l}function PI(e,t,r){var n=r||{},s=+!n.skipHeader,a=e||{},i=0,o=0;if(a&&n.origin!=null)if(typeof n.origin=="number")i=n.origin;else{var l=typeof n.origin=="string"?Qr(n.origin):n.origin;i=l.r,o=l.c}var c,u={s:{c:0,r:0},e:{c:o,r:i+t.length-1+s}};if(a["!ref"]){var d=Bt(a["!ref"]);u.e.c=Math.max(u.e.c,d.e.c),u.e.r=Math.max(u.e.r,d.e.r),i==-1&&(i=d.e.r+1,u.e.r=i+t.length-1+s)}else i==-1&&(i=0,u.e.r=t.length-1+s);var m=n.header||[],p=0;t.forEach(function(x,w){bs(x).forEach(function(k){(p=m.indexOf(k))==-1&&(m[p=m.length]=k);var T=x[k],E="z",N="",M=Ue({c:o+p,r:i+w+s});c=gu(a,M),T&&typeof T=="object"&&!(T instanceof Date)?a[M]=T:(typeof T=="number"?E="n":typeof T=="boolean"?E="b":typeof T=="string"?E="s":T instanceof Date?(E="d",n.cellDates||(E="n",T=en(T)),N=n.dateNF||ze[14]):T===null&&n.nullError&&(E="e",T=0),c?(c.t=E,c.v=T,delete c.w,delete c.R,N&&(c.z=N)):a[M]=c={t:E,v:T},N&&(c.z=N))})}),u.e.c=Math.max(u.e.c,o+m.length-1);var g=Ar(i);if(s)for(p=0;p<m.length;++p)a[sr(p+o)+g]={t:"s",v:m[p]};return a["!ref"]=nt(u),a}function J7(e,t){return PI(null,e,t)}function gu(e,t,r){if(typeof t=="string"){if(Array.isArray(e)){var n=Qr(t);return e[n.r]||(e[n.r]=[]),e[n.r][n.c]||(e[n.r][n.c]={t:"z"})}return e[t]||(e[t]={t:"z"})}return typeof t!="number"?gu(e,Ue(t)):gu(e,Ue({r:t,c:r||0}))}function Z7(e,t){if(typeof t=="number"){if(t>=0&&e.SheetNames.length>t)return t;throw new Error("Cannot find sheet # "+t)}else if(typeof t=="string"){var r=e.SheetNames.indexOf(t);if(r>-1)return r;throw new Error("Cannot find sheet name |"+t+"|")}else throw new Error("Cannot find sheet |"+t+"|")}function vx(){return{SheetNames:[],Sheets:{}}}function xx(e,t,r,n){var s=1;if(!r)for(;s<=65535&&e.SheetNames.indexOf(r="Sheet"+s)!=-1;++s,r=void 0);if(!r||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&e.SheetNames.indexOf(r)>=0){var a=r.match(/(^.*?)(\d+)$/);s=a&&+a[2]||0;var i=a&&a[1]||r;for(++s;s<=65535&&e.SheetNames.indexOf(r=i+s)!=-1;++s);}if(LB(r),e.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return e.SheetNames.push(r),e.Sheets[r]=t,r}function ez(e,t,r){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var n=Z7(e,t);switch(e.Workbook.Sheets[n]||(e.Workbook.Sheets[n]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}e.Workbook.Sheets[n].Hidden=r}function tz(e,t){return e.z=t,e}function DI(e,t,r){return t?(e.l={Target:t},r&&(e.l.Tooltip=r)):delete e.l,e}function rz(e,t,r){return DI(e,"#"+t,r)}function nz(e,t,r){e.c||(e.c=[]),e.c.push({t,a:r||"SheetJS"})}function sz(e,t,r,n){for(var s=typeof t!="string"?t:Bt(t),a=typeof t=="string"?t:nt(t),i=s.s.r;i<=s.e.r;++i)for(var o=s.s.c;o<=s.e.c;++o){var l=gu(e,i,o);l.t="n",l.F=a,delete l.v,i==s.s.r&&o==s.s.c&&(l.f=r,n&&(l.D=!0))}return e}var az={encode_col:sr,encode_row:Ar,encode_cell:Ue,encode_range:nt,decode_col:nx,decode_row:rx,split_cell:g8,decode_cell:Qr,decode_range:Il,format_cell:ga,sheet_add_aoa:LA,sheet_add_json:PI,sheet_add_dom:II,aoa_to_sheet:Cl,json_to_sheet:J7,table_to_sheet:CI,table_to_book:w7,sheet_to_csv:bI,sheet_to_txt:Y7,sheet_to_json:Wp,sheet_to_html:_7,sheet_to_formulae:Q7,sheet_to_row_object_array:Wp,sheet_get_cell:gu,book_new:vx,book_append_sheet:xx,book_set_sheet_visibility:ez,cell_set_number_format:tz,cell_set_hyperlink:DI,cell_set_internal_link:rz,cell_add_comment:nz,sheet_set_array_formula:sz,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};const iz=({tmdbApiKey:e,userId:t,onDone:r})=>{const[n,s]=z.useState(null),[a,i]=z.useState([]),[o,l]=z.useState([]),[c,u]=z.useState("upload"),[d,m]=z.useState(0),[p,g]=z.useState(0),[x,w]=z.useState(!1),[k,T]=z.useState(null),[E,N]=z.useState([]),[M,O]=z.useState(null),v=o.filter(R=>R.selected&&R.tmdbMatch).length,_=R=>{var he;const ue=(he=R.target.files)==null?void 0:he[0];if(!ue)return;s(ue);const le=new FileReader;le.onload=pe=>{var B;const ee=$p((B=pe.target)==null?void 0:B.result,{type:"binary"}),H=ee.Sheets[ee.SheetNames[0]],ce=az.sheet_to_json(H).map(K=>({title:K.title||K.Title||K.name||K.Name||"",releaseDate:K.releaseDate||K.ReleaseDate||K.release_date||K.year||K.Year||"",watched:K.watched||K.Watched||!1,rating:K.rating||K.Rating||null,review:K.review||K.Review||K.notes||K.Notes||""})).filter(K=>K.title);i(ce)},le.readAsBinaryString(ue)},S=async()=>{if(!a.length||!e){O("Missing data or TMDB key");return}try{w(!0),O(null),l([]),m(0);const R=[],ue=ir(Je,"movies");for(let le=0;le<a.length;le++){const he=a[le];try{const pe=`${he.title} ${he.releaseDate||""}`.trim(),ee=await Dp(pe,e);if(!ee.results.length)R.push({excelData:he,tmdbMatch:null,confidence:0,status:"unmatched",userMovieExists:!1,selected:!1});else{const H=await Jh(ee.results[0].id,e),se=G_(he,H),ce=await kr(ei(ue,ti("tmdbId","==",H.id)));let B,K=!1;ce.empty||(B=ce.docs[0].id,K=!!await bp(t,B)),R.push({excelData:he,tmdbMatch:H,confidence:se,status:K?"duplicate":se>=70?"matched":"manual",userMovieExists:K,movieId:B,selected:!K})}}catch{R.push({excelData:he,tmdbMatch:null,confidence:0,status:"unmatched",userMovieExists:!1,selected:!1})}m(Math.round((le+1)/a.length*100))}l(R),u("review")}finally{w(!1)}},I=async(R,ue)=>{try{w(!0);const le=o[R],he=ue||le.excelData.title,pe=await Dp(he,e);T(R),N(pe.results)}finally{w(!1)}},b=async R=>{if(k!=null){w(!0);try{const ue=await Jh(R.id,e),le=G_(o[k].excelData,ue),he=ir(Je,"movies"),pe=await kr(ei(he,ti("tmdbId","==",ue.id)));let ee,H=!1;pe.empty||(ee=pe.docs[0].id,H=!!await bp(t,ee)),l(se=>{const ce=[...se],B=ce[k];return ce[k]={...B,tmdbMatch:ue,confidence:le,status:H?"duplicate":"matched",userMovieExists:H,movieId:ee,selected:!H},ce}),T(null),N([])}finally{w(!1)}}},P=async()=>{const R=o.filter(le=>le.selected&&le.tmdbMatch);if(!R.length)return;u("import"),g(0);const ue=ir(Je,"movies");for(let le=0;le<R.length;le++){const he=R[le];try{let pe=he.movieId;pe||(pe=(await Jd(ue,{...Hv(he.tmdbMatch),addedAt:new Date,updatedAt:new Date})).id),await t0(t,pe,{userId:t,movieId:pe,watched:he.excelData.watched||!1,rating:he.excelData.rating||null,review:he.excelData.review||"",favorite:!1})}catch{}g(Math.round((le+1)/R.length*100))}r==null||r()};return h.jsxs("div",{className:"space-y-6",children:[c==="upload"&&h.jsxs("div",{className:"space-y-4",children:[h.jsx("input",{type:"file",accept:".xlsx,.xls",className:"file-input file-input-bordered w-full",onChange:_}),!!a.length&&h.jsxs("div",{className:"text-sm opacity-80",children:[a.length," rows detected"]}),h.jsx("button",{className:"btn btn-primary",onClick:S,disabled:!e||!a.length||x,children:x?h.jsx("span",{className:"loading loading-spinner loading-sm"}):"Scan & Match"})]}),c==="review"&&h.jsxs("div",{className:"space-y-4",children:[h.jsxs("div",{className:"flex justify-between items-center",children:[h.jsx("div",{className:"font-bold",children:"Review Matches"}),h.jsx("button",{className:"btn btn-ghost btn-sm",onClick:()=>u("upload"),children:"Back"})]}),h.jsx("div",{className:"overflow-x-auto",children:h.jsxs("table",{className:"table table-zebra w-full",children:[h.jsx("thead",{children:h.jsxs("tr",{children:[h.jsx("th",{}),h.jsx("th",{children:"Excel"}),h.jsx("th",{children:"Match"}),h.jsx("th",{children:"Confidence"}),h.jsx("th",{children:"Status"}),h.jsx("th",{children:"Action"})]})}),h.jsx("tbody",{children:o.map((R,ue)=>{var le;return h.jsxs("tr",{className:R.userMovieExists?"bg-warning bg-opacity-20":"",children:[h.jsx("td",{children:h.jsx("input",{type:"checkbox",className:"checkbox",checked:R.selected,disabled:!R.tmdbMatch,onChange:()=>{const he=[...o];he[ue].selected=!he[ue].selected,l(he)}})}),h.jsxs("td",{children:[h.jsx("div",{className:"font-semibold",children:R.excelData.title}),h.jsx("div",{className:"text-xs opacity-70",children:R.excelData.releaseDate||"-"})]}),h.jsx("td",{children:R.tmdbMatch?h.jsxs("div",{className:"flex items-center gap-3",children:[h.jsx("div",{className:"w-12 h-18",children:ws(R.tmdbMatch)?h.jsx("img",{src:ws(R.tmdbMatch),className:"object-cover"}):h.jsx("div",{className:"w-full h-full bg-base-200"})}),h.jsxs("div",{children:[h.jsx("div",{className:"font-semibold",children:R.tmdbMatch.title}),h.jsx("div",{className:"text-xs opacity-70",children:(le=R.tmdbMatch.release_date)==null?void 0:le.slice(0,4)})]})]}):h.jsx("span",{className:"text-error",children:"No match"})}),h.jsx("td",{children:R.tmdbMatch?h.jsxs("div",{className:"flex items-center",children:[h.jsx("progress",{className:`progress ${R.confidence>=70?"progress-success":R.confidence>=40?"progress-warning":"progress-error"}`,value:R.confidence,max:100}),h.jsxs("span",{className:"ml-2",children:[R.confidence,"%"]})]}):"-"}),h.jsxs("td",{children:[R.status==="matched"&&h.jsx("div",{className:"badge badge-success",children:"Matched"}),R.status==="unmatched"&&h.jsx("div",{className:"badge badge-error",children:"Unmatched"}),R.status==="duplicate"&&h.jsx("div",{className:"badge badge-warning",children:"Duplicate"}),R.status==="manual"&&h.jsx("div",{className:"badge badge-info",children:"Manual"})]}),h.jsx("td",{children:h.jsx("button",{className:"btn btn-sm btn-outline",onClick:()=>I(ue),children:h.jsx("i",{className:"fas fa-search"})})})]},ue)})})]})}),h.jsx("div",{className:"flex justify-end",children:h.jsxs("button",{className:"btn btn-primary",onClick:P,disabled:!v||x,children:["Import ",v," Movies"]})}),!!d&&d<100&&h.jsx("div",{children:h.jsx("progress",{className:"progress w-full",value:d,max:100})})]}),c==="import"&&h.jsxs("div",{className:"space-y-3",children:[h.jsx("div",{className:"font-bold",children:"Importing"}),h.jsx("progress",{className:"progress w-full",value:p,max:100})]}),k!==null&&h.jsx("div",{className:"modal modal-open",children:h.jsxs("div",{className:"modal-box max-w-4xl",children:[h.jsxs("h3",{className:"font-bold text-lg mb-4",children:["Manual match: ",o[k].excelData.title]}),h.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 mb-6",children:[h.jsx("input",{type:"text",className:"input input-bordered flex-1",placeholder:"Search for a movie...",defaultValue:o[k].excelData.title,onKeyDown:R=>R.key==="Enter"&&I(k,R.target.value)}),h.jsx("button",{className:"btn btn-primary w-full sm:w-auto",onClick:()=>{var R;return I(k,(R=document.querySelector(".modal input"))==null?void 0:R.value)},disabled:x,children:x?h.jsx("span",{className:"loading loading-spinner loading-sm"}):h.jsx("i",{className:"fas fa-search"})})]}),h.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-3 max-h-96 overflow-y-auto",children:E.map(R=>{var ue;return h.jsxs("div",{className:"card bg-base-100 shadow cursor-pointer",onClick:()=>b(R),children:[h.jsx("figure",{children:ws(R)?h.jsx("img",{src:ws(R)}):h.jsx("div",{className:"h-48 w-full bg-base-200"})}),h.jsxs("div",{className:"card-body p-3",children:[h.jsx("div",{className:"text-sm font-semibold",children:R.title}),h.jsx("div",{className:"text-xs opacity-70",children:(ue=R.release_date)==null?void 0:ue.slice(0,4)})]})]},R.id)})}),h.jsx("div",{className:"modal-action",children:h.jsx("button",{className:"btn",onClick:()=>{T(null),N([])},children:"Close"})})]})}),M&&h.jsx("div",{className:"alert alert-error",children:M})]})},oz=({selected:e,showDetails:t,loading:r,onToggleDetails:n,onAdd:s,onClose:a})=>{var i,o,l,c,u;return e?h.jsx("dialog",{className:"modal modal-open",children:h.jsxs("div",{className:"modal-box bg-xmas-card",children:[h.jsxs("div",{className:"flex gap-4",children:[h.jsx("div",{className:"w-24 shrink-0",children:ws(e)?h.jsx("img",{src:ws(e),alt:e.title,className:"w-full rounded-lg"}):h.jsx("div",{className:"w-full h-36 bg-base-200 flex items-center justify-center rounded-lg",children:h.jsx("i",{className:"fas fa-film text-2xl opacity-50"})})}),h.jsxs("div",{className:"flex-1",children:[h.jsx("h2",{className:"text-xl font-bold mb-1",children:e.title}),h.jsx("p",{className:"text-sm opacity-80 mb-1",children:(i=e.release_date)==null?void 0:i.slice(0,4)}),!t&&e.runtime&&h.jsxs("p",{className:"text-sm opacity-80 mb-1",children:["Runtime: ",e.runtime," min"]}),t&&h.jsxs("div",{className:"mt-3 space-y-2 text-sm opacity-90 max-h-48 overflow-auto pr-1",children:[e.overview&&h.jsxs("div",{children:[h.jsx("p",{className:"font-semibold mb-1",children:"Overview"}),h.jsx("p",{children:e.overview})]}),e.runtime&&h.jsxs("p",{children:[h.jsx("span",{className:"font-semibold",children:"Runtime:"})," ",e.runtime," min"]}),e.genres&&e.genres.length>0&&h.jsxs("p",{children:[h.jsx("span",{className:"font-semibold",children:"Genres:"})," ",e.genres.map(d=>typeof d=="string"?d:d.name).join(", ")]}),(((l=(o=e.credits)==null?void 0:o.cast)==null?void 0:l.length)||((c=e.cast)==null?void 0:c.length))&&h.jsxs("p",{children:[h.jsx("span",{className:"font-semibold",children:"Top cast:"})," ",((u=e.credits)!=null&&u.cast&&e.credits.cast.length>0?e.credits.cast.map(d=>d.name):e.cast).slice(0,5).join(", ")]})]})]})]}),h.jsxs("div",{className:"mt-4 space-y-3",children:[h.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-3",children:[h.jsx("div",{children:(e.overview||e.runtime||e.genres||e.credits||e.cast)&&h.jsxs("button",{type:"button",className:"btn btn-outline btn-sm sm:btn-md gap-2",onClick:n,disabled:r,children:[h.jsx("i",{className:"fas fa-info-circle"}),t?"Hide details":"View details"]})}),h.jsxs("div",{className:"flex justify-end gap-2",children:[h.jsxs("button",{className:"btn btn-primary btn-sm sm:btn-md",onClick:s,disabled:r,children:[r?h.jsx("span",{className:"loading loading-spinner loading-sm mr-2"}):h.jsx("i",{className:"fas fa-plus mr-2"}),"Add Movie"]}),h.jsx("button",{className:"btn btn-outline btn-sm sm:btn-md",onClick:a,disabled:r,children:"Cancel"})]})]}),e.id&&h.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center gap-2",children:[h.jsx("a",{href:`https://www.themoviedb.org/movie/${e.id}`,target:"_blank",rel:"noopener noreferrer",className:"btn btn-outline btn-xs sm:btn-sm flex items-center justify-center gap-2",children:h.jsx("img",{src:"/tmdb.svg",alt:"TMDB",className:"h-4 sm:h-5"})}),h.jsx("p",{className:"text-[10px] text-gray-400 max-w-xs",children:"This product uses the TMDB API but is not endorsed or certified by TMDB."})]})]}),h.jsx("form",{method:"dialog",className:"modal-backdrop",onClick:a,children:h.jsx("button",{children:"close"})})]})}):null},lz=()=>{const{currentUser:e,userProfile:t}=Nn(),[r,n]=z.useState(!1),[s,a]=z.useState(""),[i,o]=z.useState(""),[l,c]=z.useState(""),[u,d]=z.useState(""),[m,p]=z.useState(""),[g,x]=z.useState(!1),[w,k]=z.useState(null),[T,E]=z.useState(null);z.useEffect(()=>{i&&!l&&c(`https://www.themoviedb.org/movie/${i}`)},[i,l]);const N=()=>{a(""),o(""),c(""),d(""),p(""),k(null)},M=()=>{if(k(null),E(null),!e){k("Please sign in to request a movie.");return}n(!0)},O=()=>{g||(n(!1),N())},v=async _=>{if(_.preventDefault(),!e){k("You must be signed in to submit a request.");return}if(!s.trim()){k("Please enter a movie title.");return}try{x(!0),k(null),await Jd(ir(Je,"Requests"),{title:s.trim(),tmdbId:i?Number(i):null,tmdbUrl:l.trim()||null,year:u.trim()||null,notes:m.trim()||null,userId:e.uid,userDisplayName:(t==null?void 0:t.displayName)||e.displayName||null,status:"pending",createdAt:new Date}),E("Request submitted! Thank you."),N(),n(!1)}catch(S){console.error("Failed to submit movie request:",S),k((S==null?void 0:S.message)||"Failed to submit request. Please try again.")}finally{x(!1)}};return h.jsxs(h.Fragment,{children:[h.jsxs("button",{type:"button",className:"btn btn-outline btn-sm sm:btn-md mb-4",onClick:M,children:[h.jsx("i",{className:"fas fa-gift mr-2"}),"Request a movie"]}),w&&!r&&h.jsxs("div",{className:"alert alert-warning mb-4",children:[h.jsx("i",{className:"fas fa-exclamation-triangle mr-2"}),h.jsx("span",{children:w})]}),T&&!r&&h.jsxs("div",{className:"alert alert-success mb-4",children:[h.jsx("i",{className:"fas fa-check-circle mr-2"}),h.jsx("span",{children:T})]}),r&&h.jsx("dialog",{className:"modal modal-open",children:h.jsxs("div",{className:"modal-box bg-xmas-card max-w-lg",children:[h.jsx("h2",{className:"font-christmas text-2xl mb-2 text-xmas-gold",children:"Request a Movie"}),h.jsx("p",{className:"text-sm mb-4 opacity-80",children:"Can't find a movie in the catalogue? Tell us about it so we can add it."}),w&&h.jsxs("div",{className:"alert alert-error mb-3",children:[h.jsx("i",{className:"fas fa-exclamation-circle mr-2"}),h.jsx("span",{children:w})]}),h.jsxs("form",{className:"space-y-3",onSubmit:v,children:[h.jsxs("div",{children:[h.jsx("label",{className:"label",children:h.jsx("span",{className:"label-text",children:"Movie title *"})}),h.jsx("input",{type:"text",className:"input input-bordered w-full",value:s,onChange:_=>a(_.target.value),required:!0,disabled:g,placeholder:"e.g. The Grinch"})]}),h.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:[h.jsxs("div",{children:[h.jsx("label",{className:"label",children:h.jsx("span",{className:"label-text",children:"TMDB ID (optional)"})}),h.jsx("input",{type:"number",className:"input input-bordered w-full",value:i,onChange:_=>o(_.target.value),disabled:g,placeholder:"e.g. 8871"})]}),h.jsxs("div",{children:[h.jsx("label",{className:"label",children:h.jsx("span",{className:"label-text",children:"Release year (optional)"})}),h.jsx("input",{type:"number",className:"input input-bordered w-full",value:u,onChange:_=>d(_.target.value),disabled:g,placeholder:"e.g. 2000"})]})]}),h.jsxs("div",{children:[h.jsx("label",{className:"label",children:h.jsx("span",{className:"label-text",children:"TMDB URL (optional)"})}),h.jsx("input",{type:"url",className:"input input-bordered w-full",value:l,onChange:_=>c(_.target.value),disabled:g,placeholder:"https://www.themoviedb.org/movie/..."}),h.jsx("p",{className:"text-xs opacity-70 mt-1",children:"If you provide a TMDB ID, the URL will be auto-filled. You can also paste a URL directly."})]}),h.jsxs("div",{children:[h.jsx("label",{className:"label",children:h.jsx("span",{className:"label-text",children:"Anything else that helps? (optional)"})}),h.jsx("textarea",{className:"textarea textarea-bordered w-full",rows:3,value:m,onChange:_=>p(_.target.value),disabled:g,placeholder:"Actors, streaming service, or where you heard about it."})]}),h.jsxs("div",{className:"modal-action flex justify-end gap-2",children:[h.jsx("button",{type:"button",className:"btn btn-ghost",onClick:O,disabled:g,children:"Cancel"}),h.jsxs("button",{type:"submit",className:"btn btn-primary",disabled:g,children:[g&&h.jsx("span",{className:"loading loading-spinner loading-sm mr-2"}),"Submit request"]})]})]}),h.jsx("form",{method:"dialog",className:"modal-backdrop",onClick:O,children:h.jsx("button",{children:"close"})})]})})]})},cz=()=>{const{currentUser:e,userProfile:t}=Nn(),{isAdmin:r}=ju(),[n,s]=z.useState(""),[a,i]=z.useState("local"),[o,l]=z.useState(null),[c,u]=z.useState(!1),[d,m]=z.useState(!1),[p,g]=z.useState(null),[x,w]=z.useState([]);z.useEffect(()=>{r&&(t!=null&&t.tmdbApiKey)?s(t.tmdbApiKey):s("")},[t,r]),z.useEffect(()=>{(async()=>{if(!e){w([]);return}try{const{userMovies:O}=await r0(e.uid);w(Object.keys(O))}catch(O){console.error("Error loading user movies for import page:",O)}})()},[e]);const k=M=>{g(null),u(!1),l(M)},T=async M=>{if(!r){g({type:"error",text:"Only admins can import directly from TMDB."});return}if(!n){g({type:"error",text:"TMDB key required to fetch details."});return}try{m(!0),g(null),u(!1);const O=await Jh(M.id,n);l(O)}catch(O){g({type:"error",text:(O==null?void 0:O.message)??"Failed to fetch details"})}finally{m(!1)}},E=async()=>{if(!(!e||!o))try{m(!0),g(null);const M=ir(Je,"movies"),O=await kr(ei(M,ti("tmdbId","==",o.id)));let v;if(O.empty){if(!r){g({type:"error",text:"Only admins can add new catalogue movies."}),m(!1);return}v=(await Jd(M,{...Hv(o),addedAt:new Date,updatedAt:new Date})).id}else v=O.docs[0].id;await t0(e.uid,v,{userId:e.uid,movieId:v,watched:!1,favorite:!1}),w(_=>_.includes(v)?_:[..._,v]),XS(),g({type:"success",text:"Added to your collection!"}),u(!1),l(null)}catch(M){g({type:"error",text:(M==null?void 0:M.message)??"Failed to add movie"})}finally{m(!1)}},N=()=>{d||l(null)};return h.jsxs("div",{className:"container mx-auto px-4 py-8",children:[h.jsx("div",{className:"mb-4",children:h.jsxs(tt,{to:"/movies",className:"btn btn-primary btn-sm sm:btn-md",children:[h.jsx("i",{className:"fas fa-arrow-left mr-2"})," Back to Movies"]})}),h.jsx("h1",{className:"font-christmas text-3xl md:text-4xl text-xmas-line mb-6",children:"Add Movies"}),p&&h.jsxs("div",{className:`alert ${p.type==="error"?"alert-error":"alert-success"} mb-4`,children:[h.jsx("i",{className:`fas ${p.type==="error"?"fa-exclamation-circle":"fa-check-circle"} mr-2`}),h.jsx("span",{children:p.text})]}),h.jsx("div",{className:"mb-4",children:h.jsx(lz,{})}),r&&h.jsxs("div",{className:"tabs tabs-boxed mb-6",children:[h.jsxs("button",{className:`tab ${a==="local"?"tab-active":""}`,onClick:()=>i("local"),children:[h.jsx("i",{className:"fas fa-database mr-2"}),"Local"]}),h.jsxs("button",{className:`tab ${a==="tmdb"?"tab-active":""}`,onClick:()=>i("tmdb"),children:[h.jsx("i",{className:"fas fa-search mr-2"}),"TMDB"]}),h.jsxs("button",{className:`tab ${a==="excel"?"tab-active":""}`,onClick:()=>i("excel"),children:[h.jsx("i",{className:"fas fa-file-excel mr-2"}),"Excel"]})]}),a==="local"&&h.jsx("div",{className:"bg-xmas-card p-6 rounded-lg shadow-lg",children:h.jsx(ZL,{onSelect:k,userMovieIds:x})}),a==="tmdb"&&r&&h.jsxs("div",{className:"bg-xmas-card p-6 rounded-lg shadow-lg",children:[!n&&h.jsxs("div",{className:"alert alert-warning mb-4",children:[h.jsx("i",{className:"fas fa-exclamation-triangle mr-2"}),h.jsx("span",{children:"Set your TMDB API key in Profile to search TMDB."})]}),h.jsx(n6,{tmdbApiKey:n,onSelect:T})]}),a==="excel"&&r&&h.jsxs("div",{className:"bg-xmas-card p-6 rounded-lg shadow-lg",children:[!n&&h.jsxs("div",{className:"alert alert-warning mb-4",children:[h.jsx("i",{className:"fas fa-exclamation-triangle mr-2"}),h.jsx("span",{children:"TMDB key required for matching."})]}),e?h.jsx(iz,{tmdbApiKey:n,userId:e.uid,onDone:()=>i("local")}):h.jsx("div",{className:"alert alert-info",children:"Log in to import from Excel."})]}),o&&h.jsx(oz,{selected:o,showDetails:c,loading:d,onToggleDetails:()=>u(M=>!M),onAdd:E,onClose:N})]})},uz=()=>{var w,k,T;const{currentUser:e}=Nn(),[t,r]=z.useState([]),[n,s]=z.useState({}),[a,i]=z.useState(!0),[o,l]=z.useState(null),[c,u]=z.useState(null),[d,m]=z.useState(!1),[p,g]=z.useState(!1);z.useEffect(()=>{(async()=>{if(e)try{i(!0);const{userMovies:N,movies:M}=await r0(e.uid);s(N),r(M)}catch(N){console.error("Error fetching movies:",N),l("Failed to load movies")}finally{i(!1)}})()},[e]);const x=()=>{if(t.length===0)return;g(!0),u(null);const E=t.filter(v=>{const _=n[v.id];return d||!_||!_.watched});if(E.length===0){l("No eligible movies found. Try including watched movies."),g(!1);return}let N=0;const M=25,O=setInterval(()=>{const v=Math.floor(Math.random()*E.length);u(E[v]),N++,N>=M&&(clearInterval(O),g(!1))},100)};return a?h.jsx("div",{className:"flex justify-center items-center min-h-[60vh]",children:h.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-xmas-gold"})}):h.jsxs("div",{className:"container mx-auto px-4 py-8",children:[h.jsx("div",{className:"mb-4",children:h.jsxs(tt,{to:"/movies",className:"btn btn-primary btn-sm sm:btn-md",children:[h.jsx("i",{className:"fas fa-arrow-left mr-2"})," Back to Movies"]})}),h.jsx("h1",{className:"font-christmas text-3xl md:text-4xl text-xmas-line mb-6",children:"Christmas Movie Picker"}),o&&h.jsxs("div",{className:"alert alert-error mb-6",children:[h.jsx("i",{className:"fas fa-exclamation-circle mr-2"}),h.jsx("span",{children:o})]}),t.length===0?h.jsxs("div",{className:"bg-xmas-card p-8 rounded-lg text-center",children:[h.jsx("h3",{className:"text-xl mb-4",children:"No movies in your collection"}),h.jsx("p",{className:"mb-4",children:"Add some Christmas movies to use the random movie picker!"}),h.jsxs(tt,{to:"/import",className:"btn btn-primary",children:[h.jsx("i",{className:"fas fa-file-import mr-2"})," Import Movies"]})]}):h.jsxs("div",{className:"bg-xmas-card p-8 rounded-lg shadow-lg",children:[h.jsxs("div",{className:"text-center mb-6",children:[h.jsx("p",{className:"mb-4",children:"Can't decide what Christmas movie to watch? Let us pick one for you!"}),h.jsx("div",{className:"form-control mb-6",children:h.jsxs("label",{className:"label cursor-pointer justify-center",children:[h.jsx("span",{className:"label-text mr-2",children:"Include watched movies"}),h.jsx("input",{type:"checkbox",className:"toggle toggle-primary",checked:d,onChange:()=>m(!d)})]})}),h.jsx("button",{className:"btn btn-primary btn-lg",onClick:x,disabled:p,children:p?h.jsxs(h.Fragment,{children:[h.jsx("span",{className:"loading loading-spinner loading-md mr-2"}),"Picking a movie..."]}):h.jsxs(h.Fragment,{children:[h.jsx("i",{className:"fas fa-random mr-2"}),"Pick a Random Movie"]})})]}),c&&h.jsx("div",{className:"mt-8 flex flex-col items-center",children:h.jsx("div",{className:"w-full max-w-md",children:h.jsxs("div",{className:"card bg-base-100 shadow-xl overflow-hidden",children:[h.jsxs("figure",{className:"relative",children:[c.posterUrl?h.jsx("img",{src:c.posterUrl,alt:c.title,className:"w-full object-contain",style:{aspectRatio:"2/3",maxHeight:"500px"},loading:"lazy"}):h.jsx("div",{className:"w-full flex items-center justify-center bg-gray-800",style:{aspectRatio:"2/3",maxHeight:"500px"},children:h.jsx("i",{className:"fas fa-film text-6xl text-gray-500"})}),((w=n[c.id])==null?void 0:w.watched)&&h.jsx("div",{className:"absolute top-4 left-4 badge badge-lg badge-success",children:"Already Watched"}),((k=n[c.id])==null?void 0:k.rating)&&h.jsxs("div",{className:"absolute top-4 right-4 badge badge-lg badge-warning",children:[h.jsx("i",{className:"fas fa-star mr-1"}),n[c.id].rating,"/10"]})]}),h.jsxs("div",{className:"card-body",children:[h.jsx("h2",{className:"card-title text-2xl font-christmas",children:c.title}),h.jsx("p",{className:"text-gray-400",children:(T=c.releaseDate)==null?void 0:T.substring(0,4)}),h.jsxs("div",{className:"card-actions justify-end mt-4",children:[h.jsx(tt,{to:Wv(c.title,c.id),className:"btn btn-primary",children:"View Details"}),h.jsx("button",{className:"btn btn-outline",onClick:x,disabled:p,children:"Pick Another"})]})]})]})})})]})]})},fz=(e,t)=>{const r=["Title","TMDB ID","Release Year","Watched","Watched Date","Rating","Review","Favorite","Date Added"].join(","),n=e.map(s=>{const a=t[s.id];if(!a)return null;const i=s.releaseDate?s.releaseDate.substring(0,4):"",o=a.watchedDate?Hp(a.watchedDate):"",l=a.addedAt?Hp(a.addedAt):"",c=Yw(s.title),u=a.review?Yw(a.review):"";return[c,s.tmdbId||"",i,a.watched?"Yes":"No",o,a.rating!==null&&a.rating!==void 0?a.rating:"",u,a.favorite?"Yes":"No",l].join(",")}).filter(Boolean);return[r,...n].join(`
`)},Hp=e=>{if(!(e instanceof Date))try{e&&typeof e.toDate=="function"?e=e.toDate():e=new Date(e)}catch{return""}return e.toISOString().split("T")[0]},Yw=e=>e?e.includes(",")||e.includes('"')||e.includes(`
`)?`"${e.replace(/"/g,'""')}"`:e:"",hz=(e,t,r)=>{const n=document.createElement("a"),s=new Blob([e],{type:r});n.href=URL.createObjectURL(s),n.download=t,n.click(),URL.revokeObjectURL(n.href)},dz=async(e,t,r)=>{const n=fz(e,t),s=`${r.replace(/\s+/g,"_")}_christmas_movies_${Hp(new Date)}.csv`;hz(n,s,"text/csv;charset=utf-8;")},mz=async()=>{const e=ir(Je,"movies"),t=await kr(e);let r=0;const n=t.size;for(const s of t.docs){const a=s.data();if(a.sortTitle)continue;const i=QS(a.title);i!==a.title&&(await Yi(Tr(Je,"movies",s.id),{sortTitle:i,updatedAt:new Date}),r++)}return{updated:r,total:n}},pz=()=>{const{currentUser:e}=Nn(),[t,r]=z.useState([]),[n,s]=z.useState(!1),[a,i]=z.useState(null),[o,l]=z.useState(null),[c,u]=z.useState(new Set);z.useEffect(()=>{(async()=>{if(e){s(!0),i(null);try{const x=ei(ir(Je,"Requests"),ti("userId","==",e.uid)),k=(await kr(x)).docs.map(T=>{const E=T.data();return{id:T.id,title:E.title,year:E.year??null,status:E.status,tmdbId:E.tmdbId??null,createdAt:E.createdAt,updatedAt:E.updatedAt}});if(r(k),e&&k.length>0){const T=[];for(const E of k){if(E.status!=="fulfilled"||!E.tmdbId)continue;const N=ir(Je,"movies"),M=ei(N,ti("tmdbId","==",E.tmdbId)),O=await kr(M);if(O.empty)continue;const _=O.docs[0].id,S=Tr(Je,`users/${e.uid}/movies`,_);(await Is(S)).exists()&&T.push(E.id)}T.length>0&&u(new Set(T))}}catch(x){console.error("Error loading your movie requests:",x),i(x.message||"Failed to load your movie requests")}finally{s(!1)}}})()},[e]);const d=g=>{if(!g)return"";const x=g!=null&&g.toDate?g.toDate():g;try{return new Date(x).toLocaleString()}catch{return""}},m=g=>g==="fulfilled"?"badge badge-success":g==="dismissed"?"badge badge-ghost":"badge badge-warning",p=async g=>{if(e){if(!g.tmdbId){i("This request does not have a TMDB ID to match a movie.");return}try{i(null),l(g.id);const x=ir(Je,"movies"),w=ei(x,ti("tmdbId","==",g.tmdbId)),k=await kr(w);if(k.empty){i("Could not find this movie in the catalogue yet.");return}const E=k.docs[0].id;await t0(e.uid,E,{userId:e.uid,movieId:E,watched:!1,favorite:!1}),u(N=>new Set(N).add(g.id))}catch(x){console.error("Failed to add movie to your collection:",x),i(x.message||"Failed to add movie to your collection")}finally{l(null)}}};return h.jsxs("div",{className:"mt-8",children:[h.jsx("h3",{className:"text-lg font-bold mb-2",children:"My Movie Requests"}),h.jsx("p",{className:"text-sm opacity-80 mb-4",children:"These are movies you've asked to be added to the catalogue."}),n&&h.jsx("div",{className:"flex justify-center py-4",children:h.jsx("span",{className:"loading loading-spinner loading-md"})}),a&&h.jsxs("div",{className:"alert alert-error mb-4",children:[h.jsx("i",{className:"fas fa-exclamation-circle mr-2"}),h.jsx("span",{children:a})]}),!n&&!a&&t.length===0&&h.jsx("p",{className:"text-sm opacity-80",children:"You haven't requested any movies yet."}),!n&&!a&&t.length>0&&h.jsx("div",{className:"overflow-x-auto",children:h.jsxs("table",{className:"table table-zebra table-sm",children:[h.jsx("thead",{children:h.jsxs("tr",{children:[h.jsx("th",{children:"Title"}),h.jsx("th",{children:"Year"}),h.jsx("th",{children:"Status"}),h.jsx("th",{children:"Last Updated"}),h.jsx("th",{})]})}),h.jsx("tbody",{children:t.map(g=>h.jsxs("tr",{children:[h.jsx("td",{children:g.title}),h.jsx("td",{children:g.year||"-"}),h.jsx("td",{children:h.jsx("span",{className:m(g.status),children:g.status})}),h.jsx("td",{className:"text-xs",children:d(g.updatedAt||g.createdAt)}),h.jsx("td",{children:g.status==="fulfilled"&&g.tmdbId&&(c.has(g.id)?h.jsx("span",{className:"badge badge-success text-xs",children:"In collection"}):h.jsxs("button",{className:"btn btn-xs btn-primary",onClick:()=>p(g),disabled:o===g.id,children:[o===g.id&&h.jsx("span",{className:"loading loading-spinner loading-xs mr-1"}),"Add to my movies"]}))})]},g.id))})]})})]})},gz=()=>{const{currentUser:e,userProfile:t,signOut:r}=Nn(),{isAdmin:n}=ju(),[s,a]=z.useState(!1),[i,o]=z.useState(""),[l,c]=z.useState(!1),[u,d]=z.useState(!1),[m,p]=z.useState(!1),[g,x]=z.useState(null),[w,k]=z.useState(null),[T,E]=z.useState({totalMovies:0,watchedMovies:0,unwatchedMovies:0,averageRating:0,favoriteMovies:0});z.useEffect(()=>{t!=null&&t.tmdbApiKey&&o(t.tmdbApiKey),(async()=>{if(e)try{const _=await YS(e.uid),S=_.length,I=_.filter(le=>le.watched).length,b=S-I,P=_.filter(le=>le.favorite).length,R=_.filter(le=>le.rating!==void 0&&le.rating!==null),ue=R.length>0?R.reduce((le,he)=>le+(he.rating||0),0)/R.length:0;E({totalMovies:S,watchedMovies:I,unwatchedMovies:b,averageRating:ue,favoriteMovies:P})}catch(_){console.error("Error fetching user stats:",_)}})()},[e,t]);const N=async()=>{if(e)try{c(!0),x(null);const v=Tr(Je,"users",e.uid);await Yi(v,{tmdbApiKey:i}),k("TMDB API key saved successfully!"),setTimeout(()=>{k(null)},3e3)}catch(v){console.error("Error saving API key:",v),x(v.message||"Failed to save API key")}finally{c(!1)}},M=async()=>{try{await r()}catch(v){console.error("Error signing out:",v)}},O=async()=>{if(e)try{d(!0),x(null);const{userMovies:v,movies:_}=await r0(e.uid);await dz(_,v,t.displayName||"User"),k("Movies exported successfully!"),setTimeout(()=>{k(null)},3e3)}catch(v){console.error("Error exporting movies:",v),x(v.message||"Failed to export movies")}finally{d(!1)}};return!e||!t?h.jsx("div",{className:"flex justify-center items-center min-h-[60vh]",children:h.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-xmas-gold"})}):h.jsxs("div",{className:"container mx-auto px-4 py-8",children:[h.jsx("h1",{className:"font-christmas text-3xl md:text-4xl text-xmas-line mb-6",children:"Your Profile"}),g&&h.jsxs("div",{className:"alert alert-error mb-6",children:[h.jsx("i",{className:"fas fa-exclamation-circle mr-2"}),h.jsx("span",{children:g})]}),w&&h.jsxs("div",{className:"alert alert-success mb-6",children:[h.jsx("i",{className:"fas fa-check-circle mr-2"}),h.jsx("span",{children:w})]}),h.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-8",children:[h.jsx("div",{className:"md:col-span-1",children:h.jsxs("div",{className:"bg-xmas-card p-6 rounded-lg shadow-lg",children:[h.jsxs("div",{className:"flex flex-col items-center mb-6",children:[t.photoURL?h.jsx("img",{src:t.photoURL,alt:t.displayName,className:"w-24 h-24 rounded-full mb-4"}):h.jsx("div",{className:"w-24 h-24 rounded-full bg-gray-700 flex items-center justify-center mb-4",children:h.jsx("i",{className:"fas fa-user text-4xl text-gray-400"})}),h.jsx("h2",{className:"text-xl font-bold",children:t.displayName})]}),h.jsx("div",{className:"divider"}),h.jsxs("div",{className:"mb-6",children:[h.jsx("h3",{className:"text-lg font-bold mb-2",children:"Your Stats"}),h.jsxs("ul",{className:"space-y-2",children:[h.jsxs("li",{className:"flex justify-between",children:[h.jsx("span",{children:"Total Movies:"}),h.jsx("span",{className:"font-bold",children:T.totalMovies})]}),h.jsxs("li",{className:"flex justify-between",children:[h.jsx("span",{children:"Watched:"}),h.jsx("span",{className:"font-bold",children:T.watchedMovies})]}),h.jsxs("li",{className:"flex justify-between",children:[h.jsx("span",{children:"Unwatched:"}),h.jsx("span",{className:"font-bold",children:T.unwatchedMovies})]}),h.jsxs("li",{className:"flex justify-between",children:[h.jsx("span",{children:"Favorites:"}),h.jsx("span",{className:"font-bold",children:T.favoriteMovies})]}),h.jsxs("li",{className:"flex justify-between",children:[h.jsx("span",{children:"Average Rating:"}),h.jsxs("span",{className:"font-bold",children:[T.averageRating.toFixed(1),"/10"]})]})]})]}),h.jsx("div",{className:"divider"}),h.jsxs("div",{className:"mt-6 space-y-3",children:[h.jsxs("button",{className:"btn btn-outline btn-primary w-full",onClick:O,disabled:u||T.totalMovies===0,children:[u?h.jsx("span",{className:"loading loading-spinner loading-sm mr-2"}):h.jsx("i",{className:"fas fa-file-export mr-2"}),"Export Movie Data"]}),h.jsxs("button",{className:"btn btn-outline btn-error w-full",onClick:M,children:[h.jsx("i",{className:"fas fa-sign-out-alt mr-2"}),"Sign Out"]})]})]})}),h.jsx("div",{className:"md:col-span-2",children:h.jsxs("div",{className:"bg-xmas-card p-6 rounded-lg shadow-lg",children:[n&&h.jsxs(h.Fragment,{children:[h.jsx("h2",{className:"text-2xl font-bold mb-4",children:"Settings"}),h.jsxs("div",{className:"mb-6",children:[h.jsx("h3",{className:"text-lg font-bold mb-2",children:"TMDB API Key"}),h.jsxs("p",{className:"mb-4",children:["Your TMDB API key is used to fetch movies, cast and other details."," ",h.jsx("a",{href:"https://www.themoviedb.org/settings/api",target:"_blank",rel:"noopener noreferrer",className:"link link-primary",children:"The Movie Database"}),"."]}),h.jsxs("div",{className:"form-control",children:[h.jsx("label",{className:"label",children:h.jsx("span",{className:"label-text",children:"API Key"})}),h.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 items-stretch",children:[h.jsx("input",{type:s?"text":"password",className:"input input-bordered flex-1 h-12 text-lg",value:i,onChange:v=>o(v.target.value),placeholder:"Enter your TMDB API key",style:{letterSpacing:s?"normal":"3px"}}),h.jsx("button",{type:"button",className:"btn btn-ghost w-12",onClick:()=>a(v=>!v),children:h.jsx("i",{className:`fas ${s?"fa-eye-slash":"fa-eye"}`})}),h.jsx("button",{className:"btn btn-primary w-full sm:w-auto",onClick:N,disabled:l,children:l?h.jsx("span",{className:"loading loading-spinner loading-sm"}):h.jsx("i",{className:"fas fa-save"})})]})]})]}),h.jsx("div",{className:"divider"})]}),h.jsxs("div",{className:"mb-6",children:[h.jsx("h3",{className:"text-lg font-bold mb-2",children:"Quick Links"}),h.jsxs("div",{className:"flex flex-wrap gap-2",children:[h.jsxs(tt,{to:"/movies",className:"btn btn-outline btn-sm",children:[h.jsx("i",{className:"fas fa-film mr-2"}),"My Movies"]}),h.jsxs(tt,{to:"/import",className:"btn btn-outline btn-sm",children:[h.jsx("i",{className:"fas fa-file-import mr-2"}),"Add Movies"]}),h.jsxs(tt,{to:"/random",className:"btn btn-outline btn-sm",children:[h.jsx("i",{className:"fas fa-random mr-2"}),"Random Movie Picker"]}),h.jsxs(tt,{to:"/achievements",className:"btn btn-outline btn-sm",children:[h.jsx("i",{className:"fas fa-trophy mr-2"}),"Achievements"]})]})]}),h.jsx(pz,{}),n&&h.jsxs(h.Fragment,{children:[h.jsx("div",{className:"divider"}),h.jsxs("div",{className:"mb-6",children:[h.jsx("h3",{className:"text-lg font-bold mb-2",children:"Admin Tools"}),h.jsxs(tt,{to:"/admin",className:"btn btn-primary btn-sm",children:[h.jsx("i",{className:"fas fa-tools mr-2"}),"Open Admin Dashboard"]})]})]})]})})]})]})},vz=({item:e})=>{const[t,r]=fd.useState(!1);return h.jsxs("div",{className:"rounded-lg p-4 shadow-lg border transition-transform bg-xmas-card "+(e.unlocked?"border-xmas-gold hover:scale-[1.02]":"border-gray-700 opacity-70"),children:[h.jsxs("div",{className:"flex items-center mb-3",children:[h.jsx("div",{className:"relative mr-3 w-16 h-16 rounded-full overflow-hidden border border-xmas-gold/60 bg-gray-800 flex items-center justify-center",children:t?h.jsx("span",{className:"text-3xl",children:e.icon}):h.jsx("img",{src:`/achievements/${e.id}.png`,alt:e.name,className:"w-full h-full object-cover",loading:"lazy",onError:()=>r(!0)})}),h.jsxs("div",{children:[h.jsxs("h2",{className:"text-lg font-bold flex items-center gap-2",children:[e.name,e.unlocked&&h.jsx("span",{className:"badge badge-success badge-sm",children:"Unlocked"})]}),e.unlocked&&e.unlockedAt&&h.jsxs("p",{className:"text-xs text-xmas-text/70 mt-1",children:["Unlocked on"," ",e.unlockedAt.toLocaleDateString(void 0,{year:"numeric",month:"short",day:"numeric"})]})]})]}),h.jsx("p",{className:"text-sm text-xmas-text mb-3",children:e.unlocked?e.description:e.hint}),!e.unlocked&&h.jsx("p",{className:"text-xs text-xmas-text/60 italic",children:"Locked  keep watching to reveal this badge."})]})},xz=()=>{const{currentUser:e}=Nn(),[t,r]=z.useState(!0),[n,s]=z.useState([]);return z.useEffect(()=>{(async()=>{if(e)try{r(!0),await ah(e.uid);const i=ir(Je,`users/${e.uid}/achievements`),o=await kr(i),l=new Map;o.forEach(u=>{const d=u.data();let m=null;d.unlockedAt instanceof Date?m=d.unlockedAt:d.unlockedAt&&typeof d.unlockedAt.toDate=="function"&&(m=d.unlockedAt.toDate()),l.set(u.id,{unlockedAt:m,seen:d.seen})});const c=Xo.map(u=>{const d=l.get(u.id);return{id:u.id,name:u.name,description:u.description,hint:u.hint,icon:u.icon,unlocked:!!d,unlockedAt:(d==null?void 0:d.unlockedAt)??null}}).sort((u,d)=>{if(u.unlocked!==d.unlocked)return u.unlocked?-1:1;if(u.unlocked&&d.unlocked){const m=u.unlockedAt?u.unlockedAt.getTime():0,p=d.unlockedAt?d.unlockedAt.getTime():0;if(m!==p)return m-p}return u.name.localeCompare(d.name)});s(c)}finally{r(!1)}})()},[e]),e?t?h.jsx("div",{className:"flex justify-center items-center min-h-[60vh]",children:h.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-xmas-gold"})}):h.jsxs("div",{className:"container mx-auto px-4 py-8",children:[h.jsx("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between mb-6",children:h.jsxs("div",{children:[h.jsx("h1",{className:"font-christmas text-3xl md:text-4xl text-xmas-line mb-2",children:"Achievements"}),h.jsx("p",{className:"text-sm text-xmas-text/80",children:"Unlock festive badges as you watch, rate and explore your Christmas movies."})]})}),h.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-3 gap-6",children:n.map(a=>h.jsx(vz,{item:a},a.id))})]}):h.jsx("div",{className:"flex justify-center items-center min-h-[60vh]",children:h.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-xmas-gold"})})},yz=()=>{const e=gi(),{isAdmin:t,loading:r,currentUser:n}=ju(),[s,a]=z.useState(!1),[i,o]=z.useState(null),l=!1;z.useEffect(()=>{t&&!r&&e("/admin")},[t,r,e]);const c=async()=>{o(null),a(!0);try{await xk(Tc,kL)}catch(u){console.error("Login error:",u),u.code==="auth/popup-closed-by-user"?o("Sign-in popup was closed. Please try again."):u.code==="auth/cancelled-popup-request"?o("Another popup is already open. Please try again."):u.code==="auth/unauthorized-domain"?(console.error("Unauthorized domain error:",window.location.hostname),o("This domain is not authorized for OAuth operations. Please add "+window.location.hostname+" to your Firebase authorized domains list in the Firebase console under Authentication > Sign-in method > Authorized domains.")):o("Failed to sign in. Please try again."),a(!1)}};return r?h.jsx("div",{className:"flex justify-center items-center min-h-[60vh]",children:h.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-xmas-gold"})}):h.jsx("div",{className:"container mx-auto px-4 py-12",children:h.jsxs("div",{className:"max-w-md mx-auto",children:[h.jsxs("div",{className:"text-center mb-8",children:[h.jsx("h1",{className:"font-christmas text-4xl text-xmas-line mb-2",children:"Admin Login"}),h.jsx("p",{className:"text-xmas-mute",children:"Sign in to manage the Christmas Quiz"})]}),h.jsxs("div",{className:"bg-xmas-card rounded-lg shadow-lg p-6",children:[l,n&&h.jsxs("div",{className:"bg-info bg-opacity-10 border-l-4 border-info p-4 mb-6 rounded",children:[h.jsx("p",{className:"text-info font-bold mb-2",children:"User Authenticated"}),h.jsxs("p",{className:"text-info text-sm mb-1",children:["Email: ",n.email]}),h.jsxs("p",{className:"text-info text-sm mb-2",children:["UID: ",n.uid]}),h.jsxs("p",{className:"text-info text-sm",children:["To grant admin access, create a document in the ",h.jsx("code",{className:"bg-base-300 px-1 py-0.5 rounded",children:"admins"})," collection with this UID as the document ID."]}),l]}),i&&h.jsx("div",{className:"bg-error bg-opacity-10 border-l-4 border-error p-4 mb-6 rounded",children:h.jsx("p",{className:"text-error",children:i})}),h.jsxs("div",{className:"text-center mb-6",children:[h.jsx("p",{className:"mb-4",children:"Sign in with your Google account to access the admin panel."}),h.jsx("p",{className:"text-sm text-xmas-mute mb-6",children:"Only authorized administrators will be granted access."}),h.jsx("button",{onClick:c,className:"btn btn-primary w-full flex items-center justify-center gap-2",disabled:s,children:s?h.jsxs(h.Fragment,{children:[h.jsx("span",{className:"loading loading-spinner loading-sm"}),"Signing in..."]}):h.jsxs(h.Fragment,{children:[h.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 48 48",children:[h.jsx("path",{fill:"#FFC107",d:`M43.611,20.083H42V20H24v8h11.303c-1.649,4.657-6.08,8-11.303,8c-6.627,0-12-5.373-12-12
                      s5.373-12,12-12c3.059,0,5.842,1.154,7.961,3.039l5.657-5.657C34.046,6.053,29.268,4,24,4C12.955,4,4,12.955,4,24s8.955,20,20,20
                      s20-8.955,20-20C44,22.659,43.862,21.35,43.611,20.083z`}),h.jsx("path",{fill:"#FF3D00",d:`M6.306,14.691l6.571,4.819C14.655,15.108,18.961,12,24,12c3.059,0,5.842,1.154,7.961,3.039
                      l5.657-5.657C34.046,6.053,29.268,4,24,4C16.318,4,9.656,8.337,6.306,14.691z`}),h.jsx("path",{fill:"#4CAF50",d:`M24,44c5.166,0,9.86-1.977,13.409-5.192l-6.19-5.238C29.211,35.091,26.715,36,24,36
                      c-5.202,0-9.619-3.317-11.283-7.946l-6.522,5.025C9.505,39.556,16.227,44,24,44z`}),h.jsx("path",{fill:"#1976D2",d:`M43.611,20.083H42V20H24v8h11.303c-0.792,2.237-2.231,4.166-4.087,5.571
                      c0.001-0.001,0.002-0.001,0.003-0.002l6.19,5.238C36.971,39.205,44,34,44,24C44,22.659,43.862,21.35,43.611,20.083z`})]}),"Sign in with Google"]})})]})]}),h.jsx("div",{className:"text-center mt-6",children:h.jsx("button",{onClick:()=>e("/"),className:"btn btn-link text-xmas-mute",children:"Back to Home"})})]})})};async function _z(e,t){const r=await Jh(e,t),n=ir(Je,"movies"),s=ei(n,ti("tmdbId","==",r.id)),a=await kr(s),i={...Hv(r),updatedAt:new Date};if(a.empty){const o={...i,addedAt:new Date};return{movieId:(await Jd(n,o)).id,action:"created"}}else{const o=a.docs[0].id;return await ci(Tr(Je,"movies",o),i,{merge:!0}),{movieId:o,action:"updated"}}}const wz=e=>new Promise(t=>setTimeout(t,e));async function Ez(e,t,r,n=200){let s=0,a=0,i=0,o=0;const l=[];for(let c=0;c<e.length;c++){const u=e[c];try{if(!u||Number.isNaN(u)){i++,r==null||r(c+1,e.length,"skipped");continue}const{movieId:d,action:m}=await _z(u,t);l.push(d),m==="created"?s++:a++,r==null||r(c+1,e.length,m),n>0&&await wz(n)}catch(d){console.error("Catalogue upsert error for TMDB",u,d),o++,r==null||r(c+1,e.length,"error")}}return{totalRequested:e.length,created:s,updated:a,skipped:i,errors:o,movieIds:l}}const Tz=()=>{const e=gi(),{isAdmin:t,loading:r}=ju(),{userProfile:n}=Nn(),[s,a]=z.useState(!0),[i,o]=z.useState(null),[l,c]=z.useState(null),[u,d]=z.useState(!1),[m,p]=z.useState({totalMovies:0,moviesWithSortTitle:0}),[g,x]=z.useState([]),[w,k]=z.useState(!1),[T,E]=z.useState(""),[N,M]=z.useState(""),[O,v]=z.useState(!0),[_,S]=z.useState(!1),[I,b]=z.useState(0),[P,R]=z.useState("");z.useEffect(()=>{n!=null&&n.tmdbApiKey&&E(n.tmdbApiKey)},[n]),z.useEffect(()=>{!r&&!t&&e("/admin/login")},[t,r,e]),z.useEffect(()=>{t&&(async()=>{if(t){a(!0);try{const H=await kr(ir(Je,"movies")),se=H.size;let ce=0;H.forEach(B=>{B.data().sortTitle&&ce++}),p({totalMovies:se,moviesWithSortTitle:ce})}catch(H){console.error("Error fetching movie data:",H),o("Failed to load movie data")}finally{a(!1)}}})()},[t]),z.useEffect(()=>{t&&(async()=>{if(t){k(!0);try{const H=ei(ir(Je,"Requests"),ti("status","==","pending")),ce=(await kr(H)).docs.map(B=>({id:B.id,...B.data()}));x(ce)}catch(H){console.error("Error fetching movie requests:",H),o("Failed to load movie requests")}finally{k(!1)}}})()},[t]);const ue=async()=>{try{d(!0),o(null);const ee=await mz();c(`Sort titles updated for ${ee.updated} out of ${ee.total} movies.`),p(H=>({...H,moviesWithSortTitle:H.moviesWithSortTitle+ee.updated})),setTimeout(()=>c(null),5e3)}catch(ee){console.error("Error updating sort titles:",ee),o(ee.message||"Failed to update sort titles")}finally{d(!1)}},le=async(ee,H)=>{try{o(null),await Yi(Tr(Je,"Requests",ee),{status:H,updatedAt:new Date}),x(se=>se.filter(ce=>ce.id!==ee)),c(`Request marked as ${H}.`),setTimeout(()=>c(null),4e3)}catch(se){console.error("Error updating request status:",se),o(se.message||"Failed to update request")}},he=z.useMemo(()=>{const H=N.split(/[\s,]+/).map(se=>se.trim()).filter(Boolean).map(se=>Number(se)).filter(se=>Number.isInteger(se)&&se>0);return Array.from(new Set(H))},[N]),pe=async()=>{if(o(null),c(null),!T){o("TMDB API key required");return}if(he.length===0){o("Please paste at least one valid TMDB ID");return}try{S(!0),b(0),R(`Starting (0 / ${he.length})`);const ee=await Ez(he,T,(H,se,ce)=>{const B=Math.round(H/se*100);b(B),R(`Processed ${H} / ${se} (${ce})`)},O?300:0);c(`Catalogue updated. Created: ${ee.created}, Updated: ${ee.updated}, Skipped: ${ee.skipped}, Errors: ${ee.errors}.`)}catch(ee){console.error(ee),o((ee==null?void 0:ee.message)??"Catalogue import failed.")}finally{S(!1)}};return r||s?h.jsx("div",{className:"flex justify-center items-center min-h-[60vh]",children:h.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-xmas-gold"})}):h.jsxs("div",{className:"container mx-auto px-4 py-8",children:[h.jsxs("div",{className:"flex justify-between items-center mb-8",children:[h.jsx("h1",{className:"font-christmas text-3xl md:text-4xl text-xmas-line",children:"Admin Dashboard"}),h.jsx("div",{className:"flex gap-2",children:h.jsxs(tt,{to:"/movies",className:"btn btn-outline",children:[h.jsx("i",{className:"fas fa-film mr-2"})," Movies"]})})]}),i&&h.jsxs("div",{className:"alert alert-error mb-6",children:[h.jsx("i",{className:"fas fa-exclamation-circle mr-2"}),h.jsx("span",{children:i})]}),l&&h.jsxs("div",{className:"alert alert-success mb-6",children:[h.jsx("i",{className:"fas fa-check-circle mr-2"}),h.jsx("span",{children:l})]}),h.jsxs("div",{className:"mb-8",children:[h.jsx("h2",{className:"text-2xl font-christmas mb-4 text-xmas-gold",children:"Movie Administration"}),h.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-8",children:[h.jsx("div",{className:"card bg-xmas-card shadow-xl",children:h.jsxs("div",{className:"card-body",children:[h.jsxs("h2",{className:"card-title font-christmas",children:[h.jsx("i",{className:"fas fa-sort-alpha-down text-primary mr-2"})," Sort Title Migration"]}),h.jsx("p",{className:"mb-4",children:'Update all movies to include sort titles (e.g., "The Grinch"  "Grinch") for better alphabetical sorting.'}),h.jsxs("div",{className:"flex flex-col gap-2",children:[h.jsxs("div",{className:"stats bg-base-200 text-base-content",children:[h.jsxs("div",{className:"stat",children:[h.jsx("div",{className:"stat-title",children:"Total Movies"}),h.jsx("div",{className:"stat-value",children:m.totalMovies})]}),h.jsxs("div",{className:"stat",children:[h.jsx("div",{className:"stat-title",children:"With Sort Titles"}),h.jsx("div",{className:"stat-value",children:m.moviesWithSortTitle}),h.jsx("div",{className:"stat-desc",children:m.totalMovies>0?`${Math.round(m.moviesWithSortTitle/m.totalMovies*100)}%`:"0%"})]})]}),h.jsxs("button",{className:"btn btn-primary w-full",onClick:ue,disabled:u||m.moviesWithSortTitle===m.totalMovies,children:[u?h.jsx("span",{className:"loading loading-spinner loading-sm mr-2"}):h.jsx("i",{className:"fas fa-sync-alt mr-2"}),m.moviesWithSortTitle===m.totalMovies?"All Movies Updated":"Update Sort Titles"]})]})]})}),h.jsx("div",{className:"card bg-xmas-card shadow-xl",children:h.jsxs("div",{className:"card-body",children:[h.jsxs("h2",{className:"card-title font-christmas",children:[h.jsx("i",{className:"fas fa-database text-primary mr-2"})," Catalogue Builder (TMDB IDs)"]}),h.jsxs("p",{className:"mb-4",children:["Bulk-import TMDB titles into your ",h.jsx("code",{children:"movies"})," catalogue only  no user collections will be updated."]}),h.jsx("label",{className:"label mt-4",children:h.jsx("span",{className:"label-text",children:"TMDB IDs (comma / space / newline separated)"})}),h.jsx("textarea",{className:"textarea textarea-bordered w-full h-40",value:N,onChange:ee=>M(ee.target.value),placeholder:`e.g. 603, 497, 155, 27205
603
497 155
27205`}),h.jsxs("div",{className:"flex items-center gap-4 mt-4",children:[h.jsx("div",{className:"form-control",children:h.jsxs("label",{className:"label cursor-pointer gap-2",children:[h.jsx("span",{className:"label-text",children:"Slow mode (API friendly)"}),h.jsx("input",{type:"checkbox",className:"toggle",checked:O,onChange:ee=>v(ee.target.checked)})]})}),h.jsx("button",{className:"btn btn-primary ml-auto",onClick:pe,disabled:_||he.length===0||!T,title:T?void 0:"Add your TMDB API key in Profile > Settings",children:_?h.jsxs(h.Fragment,{children:[h.jsx("span",{className:"loading loading-spinner loading-sm mr-2"}),"Importing ",he.length,""]}):h.jsxs(h.Fragment,{children:[h.jsx("i",{className:"fas fa-file-import mr-2"}),"Import ",he.length||0," to Catalogue"]})})]}),(_||I>0)&&h.jsxs("div",{className:"mt-4",children:[h.jsx("progress",{className:"progress w-full",value:I,max:100}),h.jsx("div",{className:"text-sm mt-1 opacity-80",children:P})]})]})})]})]}),h.jsxs("div",{className:"mb-8",children:[h.jsx("h2",{className:"text-2xl font-christmas mb-4 text-xmas-gold",children:"Movie Requests"}),h.jsx("div",{className:"card bg-xmas-card shadow-xl",children:h.jsxs("div",{className:"card-body",children:[h.jsxs("h2",{className:"card-title font-christmas flex items-center gap-2",children:[h.jsx("i",{className:"fas fa-gift text-primary"}),"Pending Requests"]}),h.jsx("p",{className:"text-sm opacity-80 mb-4",children:"These are movies users have asked to be added to the catalogue."}),w?h.jsx("div",{className:"flex justify-center py-8",children:h.jsx("span",{className:"loading loading-spinner loading-md"})}):g.length===0?h.jsx("p",{className:"text-sm opacity-80",children:"No pending requests right now."}):h.jsx("div",{className:"overflow-x-auto",children:h.jsxs("table",{className:"table table-zebra table-sm",children:[h.jsx("thead",{children:h.jsxs("tr",{children:[h.jsx("th",{children:"Title"}),h.jsx("th",{children:"Year"}),h.jsx("th",{children:"TMDB"}),h.jsx("th",{children:"Requested By"}),h.jsx("th",{children:"Notes"}),h.jsx("th",{})]})}),h.jsx("tbody",{children:g.map(ee=>{var se;const H=(se=ee.createdAt)!=null&&se.toDate?ee.createdAt.toDate():ee.createdAt;return h.jsxs("tr",{children:[h.jsxs("td",{children:[h.jsx("div",{className:"font-semibold",children:ee.title}),H&&h.jsx("div",{className:"text-xs opacity-70",children:new Date(H).toLocaleString()})]}),h.jsx("td",{children:ee.year||"-"}),h.jsxs("td",{children:[ee.tmdbId&&h.jsxs("div",{className:"text-xs",children:["ID: ",ee.tmdbId]}),ee.tmdbUrl&&h.jsx("a",{href:ee.tmdbUrl,target:"_blank",rel:"noopener noreferrer",className:"link link-primary text-xs",children:"View TMDB"})]}),h.jsxs("td",{children:[h.jsx("div",{className:"text-sm",children:ee.userDisplayName||ee.userEmail||ee.userId}),ee.userEmail&&h.jsx("div",{className:"text-xs opacity-70",children:ee.userEmail})]}),h.jsx("td",{className:"max-w-xs whitespace-pre-wrap text-xs",children:ee.notes||"-"}),h.jsxs("td",{className:"flex flex-col gap-1",children:[h.jsx("button",{className:"btn btn-xs btn-success",onClick:()=>le(ee.id,"fulfilled"),children:"Fulfilled"}),h.jsx("button",{className:"btn btn-xs btn-ghost",onClick:()=>le(ee.id,"dismissed"),children:"Dismiss"})]})]},ee.id)})})]})})]})})]})]})},kz=KR([{element:h.jsx(CL,{}),children:[{path:"/",element:h.jsx(PL,{})},{path:"/login",element:h.jsx(DL,{})},{element:h.jsx($_,{}),children:[{path:"/movies",element:h.jsx(BL,{})},{path:"/movies/:movieId",element:h.jsx(JL,{})},{path:"/import",element:h.jsx(cz,{})},{path:"/random",element:h.jsx(uz,{})},{path:"/profile",element:h.jsx(gz,{})},{path:"/achievements",element:h.jsx(xz,{})}]},{path:"/admin/login",element:h.jsx(yz,{})},{path:"/admin",element:h.jsx($_,{children:h.jsx(Tz,{})})}]}]);cm.createRoot(document.getElementById("root")).render(h.jsx(fd.StrictMode,{children:h.jsx(SL,{children:h.jsx(NL,{children:h.jsx(tb,{router:kz})})})}));
