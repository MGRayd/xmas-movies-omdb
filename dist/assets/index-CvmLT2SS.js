function Yw(t,e){for(var r=0;r<e.length;r++){const n=e[r];if(typeof n!="string"&&!Array.isArray(n)){for(const s in n)if(s!=="default"&&!(s in t)){const a=Object.getOwnPropertyDescriptor(n,s);a&&Object.defineProperty(t,s,a.get?a:{enumerable:!0,get:()=>n[s]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))n(s);new MutationObserver(s=>{for(const a of s)if(a.type==="childList")for(const i of a.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&n(i)}).observe(document,{childList:!0,subtree:!0});function r(s){const a={};return s.integrity&&(a.integrity=s.integrity),s.referrerPolicy&&(a.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?a.credentials="include":s.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function n(s){if(s.ep)return;s.ep=!0;const a=r(s);fetch(s.href,a)}})();function Qw(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var Jw={exports:{}},ld={},Zw={exports:{}},qe={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var mu=Symbol.for("react.element"),qI=Symbol.for("react.portal"),XI=Symbol.for("react.fragment"),YI=Symbol.for("react.strict_mode"),QI=Symbol.for("react.profiler"),JI=Symbol.for("react.provider"),ZI=Symbol.for("react.context"),eC=Symbol.for("react.forward_ref"),tC=Symbol.for("react.suspense"),rC=Symbol.for("react.memo"),nC=Symbol.for("react.lazy"),Gx=Symbol.iterator;function sC(t){return t===null||typeof t!="object"?null:(t=Gx&&t[Gx]||t["@@iterator"],typeof t=="function"?t:null)}var eE={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},tE=Object.assign,rE={};function pl(t,e,r){this.props=t,this.context=e,this.refs=rE,this.updater=r||eE}pl.prototype.isReactComponent={};pl.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};pl.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function nE(){}nE.prototype=pl.prototype;function Bp(t,e,r){this.props=t,this.context=e,this.refs=rE,this.updater=r||eE}var zp=Bp.prototype=new nE;zp.constructor=Bp;tE(zp,pl.prototype);zp.isPureReactComponent=!0;var Kx=Array.isArray,sE=Object.prototype.hasOwnProperty,$p={current:null},aE={key:!0,ref:!0,__self:!0,__source:!0};function iE(t,e,r){var n,s={},a=null,i=null;if(e!=null)for(n in e.ref!==void 0&&(i=e.ref),e.key!==void 0&&(a=""+e.key),e)sE.call(e,n)&&!aE.hasOwnProperty(n)&&(s[n]=e[n]);var o=arguments.length-2;if(o===1)s.children=r;else if(1<o){for(var l=Array(o),c=0;c<o;c++)l[c]=arguments[c+2];s.children=l}if(t&&t.defaultProps)for(n in o=t.defaultProps,o)s[n]===void 0&&(s[n]=o[n]);return{$$typeof:mu,type:t,key:a,ref:i,props:s,_owner:$p.current}}function aC(t,e){return{$$typeof:mu,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function Wp(t){return typeof t=="object"&&t!==null&&t.$$typeof===mu}function iC(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(r){return e[r]})}var qx=/\/+/g;function o0(t,e){return typeof t=="object"&&t!==null&&t.key!=null?iC(""+t.key):e.toString(36)}function Ff(t,e,r,n,s){var a=typeof t;(a==="undefined"||a==="boolean")&&(t=null);var i=!1;if(t===null)i=!0;else switch(a){case"string":case"number":i=!0;break;case"object":switch(t.$$typeof){case mu:case qI:i=!0}}if(i)return i=t,s=s(i),t=n===""?"."+o0(i,0):n,Kx(s)?(r="",t!=null&&(r=t.replace(qx,"$&/")+"/"),Ff(s,e,r,"",function(c){return c})):s!=null&&(Wp(s)&&(s=aC(s,r+(!s.key||i&&i.key===s.key?"":(""+s.key).replace(qx,"$&/")+"/")+t)),e.push(s)),1;if(i=0,n=n===""?".":n+":",Kx(t))for(var o=0;o<t.length;o++){a=t[o];var l=n+o0(a,o);i+=Ff(a,e,r,l,s)}else if(l=sC(t),typeof l=="function")for(t=l.call(t),o=0;!(a=t.next()).done;)a=a.value,l=n+o0(a,o++),i+=Ff(a,e,r,l,s);else if(a==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return i}function ef(t,e,r){if(t==null)return t;var n=[],s=0;return Ff(t,n,"","",function(a){return e.call(r,a,s++)}),n}function oC(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(r){(t._status===0||t._status===-1)&&(t._status=1,t._result=r)},function(r){(t._status===0||t._status===-1)&&(t._status=2,t._result=r)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var Zr={current:null},Of={transition:null},lC={ReactCurrentDispatcher:Zr,ReactCurrentBatchConfig:Of,ReactCurrentOwner:$p};function oE(){throw Error("act(...) is not supported in production builds of React.")}qe.Children={map:ef,forEach:function(t,e,r){ef(t,function(){e.apply(this,arguments)},r)},count:function(t){var e=0;return ef(t,function(){e++}),e},toArray:function(t){return ef(t,function(e){return e})||[]},only:function(t){if(!Wp(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};qe.Component=pl;qe.Fragment=XI;qe.Profiler=QI;qe.PureComponent=Bp;qe.StrictMode=YI;qe.Suspense=tC;qe.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=lC;qe.act=oE;qe.cloneElement=function(t,e,r){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var n=tE({},t.props),s=t.key,a=t.ref,i=t._owner;if(e!=null){if(e.ref!==void 0&&(a=e.ref,i=$p.current),e.key!==void 0&&(s=""+e.key),t.type&&t.type.defaultProps)var o=t.type.defaultProps;for(l in e)sE.call(e,l)&&!aE.hasOwnProperty(l)&&(n[l]=e[l]===void 0&&o!==void 0?o[l]:e[l])}var l=arguments.length-2;if(l===1)n.children=r;else if(1<l){o=Array(l);for(var c=0;c<l;c++)o[c]=arguments[c+2];n.children=o}return{$$typeof:mu,type:t.type,key:s,ref:a,props:n,_owner:i}};qe.createContext=function(t){return t={$$typeof:ZI,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:JI,_context:t},t.Consumer=t};qe.createElement=iE;qe.createFactory=function(t){var e=iE.bind(null,t);return e.type=t,e};qe.createRef=function(){return{current:null}};qe.forwardRef=function(t){return{$$typeof:eC,render:t}};qe.isValidElement=Wp;qe.lazy=function(t){return{$$typeof:nC,_payload:{_status:-1,_result:t},_init:oC}};qe.memo=function(t,e){return{$$typeof:rC,type:t,compare:e===void 0?null:e}};qe.startTransition=function(t){var e=Of.transition;Of.transition={};try{t()}finally{Of.transition=e}};qe.unstable_act=oE;qe.useCallback=function(t,e){return Zr.current.useCallback(t,e)};qe.useContext=function(t){return Zr.current.useContext(t)};qe.useDebugValue=function(){};qe.useDeferredValue=function(t){return Zr.current.useDeferredValue(t)};qe.useEffect=function(t,e){return Zr.current.useEffect(t,e)};qe.useId=function(){return Zr.current.useId()};qe.useImperativeHandle=function(t,e,r){return Zr.current.useImperativeHandle(t,e,r)};qe.useInsertionEffect=function(t,e){return Zr.current.useInsertionEffect(t,e)};qe.useLayoutEffect=function(t,e){return Zr.current.useLayoutEffect(t,e)};qe.useMemo=function(t,e){return Zr.current.useMemo(t,e)};qe.useReducer=function(t,e,r){return Zr.current.useReducer(t,e,r)};qe.useRef=function(t){return Zr.current.useRef(t)};qe.useState=function(t){return Zr.current.useState(t)};qe.useSyncExternalStore=function(t,e,r){return Zr.current.useSyncExternalStore(t,e,r)};qe.useTransition=function(){return Zr.current.useTransition()};qe.version="18.3.1";Zw.exports=qe;var W=Zw.exports;const Hp=Qw(W),cC=Yw({__proto__:null,default:Hp},[W]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var uC=W,fC=Symbol.for("react.element"),hC=Symbol.for("react.fragment"),dC=Object.prototype.hasOwnProperty,mC=uC.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,pC={key:!0,ref:!0,__self:!0,__source:!0};function lE(t,e,r){var n,s={},a=null,i=null;r!==void 0&&(a=""+r),e.key!==void 0&&(a=""+e.key),e.ref!==void 0&&(i=e.ref);for(n in e)dC.call(e,n)&&!pC.hasOwnProperty(n)&&(s[n]=e[n]);if(t&&t.defaultProps)for(n in e=t.defaultProps,e)s[n]===void 0&&(s[n]=e[n]);return{$$typeof:fC,type:t,key:a,ref:i,props:s,_owner:mC.current}}ld.Fragment=hC;ld.jsx=lE;ld.jsxs=lE;Jw.exports=ld;var d=Jw.exports,sm={},cE={exports:{}},In={},uE={exports:{}},fE={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(ee,H){var ue=ee.length;ee.push(H);e:for(;0<ue;){var de=ue-1>>>1,B=ee[de];if(0<s(B,H))ee[de]=H,ee[ue]=B,ue=de;else break e}}function r(ee){return ee.length===0?null:ee[0]}function n(ee){if(ee.length===0)return null;var H=ee[0],ue=ee.pop();if(ue!==H){ee[0]=ue;e:for(var de=0,B=ee.length,K=B>>>1;de<K;){var X=2*(de+1)-1,q=ee[X],le=X+1,_e=ee[le];if(0>s(q,ue))le<B&&0>s(_e,q)?(ee[de]=_e,ee[le]=ue,de=le):(ee[de]=q,ee[X]=ue,de=X);else if(le<B&&0>s(_e,ue))ee[de]=_e,ee[le]=ue,de=le;else break e}}return H}function s(ee,H){var ue=ee.sortIndex-H.sortIndex;return ue!==0?ue:ee.id-H.id}if(typeof performance=="object"&&typeof performance.now=="function"){var a=performance;t.unstable_now=function(){return a.now()}}else{var i=Date,o=i.now();t.unstable_now=function(){return i.now()-o}}var l=[],c=[],u=1,h=null,m=3,p=!1,x=!1,v=!1,w=typeof setTimeout=="function"?setTimeout:null,k=typeof clearTimeout=="function"?clearTimeout:null,T=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function E(ee){for(var H=r(c);H!==null;){if(H.callback===null)n(c);else if(H.startTime<=ee)n(c),H.sortIndex=H.expirationTime,e(l,H);else break;H=r(c)}}function N(ee){if(v=!1,E(ee),!x)if(r(l)!==null)x=!0,he(O);else{var H=r(c);H!==null&&me(N,H.startTime-ee)}}function O(ee,H){x=!1,v&&(v=!1,k(y),y=-1),p=!0;var ue=m;try{for(E(H),h=r(l);h!==null&&(!(h.expirationTime>H)||ee&&!P());){var de=h.callback;if(typeof de=="function"){h.callback=null,m=h.priorityLevel;var B=de(h.expirationTime<=H);H=t.unstable_now(),typeof B=="function"?h.callback=B:h===r(l)&&n(l),E(H)}else n(l);h=r(l)}if(h!==null)var K=!0;else{var X=r(c);X!==null&&me(N,X.startTime-H),K=!1}return K}finally{h=null,m=ue,p=!1}}var M=!1,g=null,y=-1,S=5,R=-1;function P(){return!(t.unstable_now()-R<S)}function b(){if(g!==null){var ee=t.unstable_now();R=ee;var H=!0;try{H=g(!0,ee)}finally{H?C():(M=!1,g=null)}}else M=!1}var C;if(typeof T=="function")C=function(){T(b)};else if(typeof MessageChannel<"u"){var oe=new MessageChannel,ae=oe.port2;oe.port1.onmessage=b,C=function(){ae.postMessage(null)}}else C=function(){w(b,0)};function he(ee){g=ee,M||(M=!0,C())}function me(ee,H){y=w(function(){ee(t.unstable_now())},H)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(ee){ee.callback=null},t.unstable_continueExecution=function(){x||p||(x=!0,he(O))},t.unstable_forceFrameRate=function(ee){0>ee||125<ee?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):S=0<ee?Math.floor(1e3/ee):5},t.unstable_getCurrentPriorityLevel=function(){return m},t.unstable_getFirstCallbackNode=function(){return r(l)},t.unstable_next=function(ee){switch(m){case 1:case 2:case 3:var H=3;break;default:H=m}var ue=m;m=H;try{return ee()}finally{m=ue}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(ee,H){switch(ee){case 1:case 2:case 3:case 4:case 5:break;default:ee=3}var ue=m;m=ee;try{return H()}finally{m=ue}},t.unstable_scheduleCallback=function(ee,H,ue){var de=t.unstable_now();switch(typeof ue=="object"&&ue!==null?(ue=ue.delay,ue=typeof ue=="number"&&0<ue?de+ue:de):ue=de,ee){case 1:var B=-1;break;case 2:B=250;break;case 5:B=1073741823;break;case 4:B=1e4;break;default:B=5e3}return B=ue+B,ee={id:u++,callback:H,priorityLevel:ee,startTime:ue,expirationTime:B,sortIndex:-1},ue>de?(ee.sortIndex=ue,e(c,ee),r(l)===null&&ee===r(c)&&(v?(k(y),y=-1):v=!0,me(N,ue-de))):(ee.sortIndex=B,e(l,ee),x||p||(x=!0,he(O))),ee},t.unstable_shouldYield=P,t.unstable_wrapCallback=function(ee){var H=m;return function(){var ue=m;m=H;try{return ee.apply(this,arguments)}finally{m=ue}}}})(fE);uE.exports=fE;var gC=uE.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var vC=W,Sn=gC;function ye(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,r=1;r<arguments.length;r++)e+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var hE=new Set,Nc={};function Qi(t,e){Xo(t,e),Xo(t+"Capture",e)}function Xo(t,e){for(Nc[t]=e,t=0;t<e.length;t++)hE.add(e[t])}var aa=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),am=Object.prototype.hasOwnProperty,xC=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Xx={},Yx={};function _C(t){return am.call(Yx,t)?!0:am.call(Xx,t)?!1:xC.test(t)?Yx[t]=!0:(Xx[t]=!0,!1)}function yC(t,e,r,n){if(r!==null&&r.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return n?!1:r!==null?!r.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function wC(t,e,r,n){if(e===null||typeof e>"u"||yC(t,e,r,n))return!0;if(n)return!1;if(r!==null)switch(r.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function en(t,e,r,n,s,a,i){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=n,this.attributeNamespace=s,this.mustUseProperty=r,this.propertyName=t,this.type=e,this.sanitizeURL=a,this.removeEmptyString=i}var kr={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){kr[t]=new en(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];kr[e]=new en(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){kr[t]=new en(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){kr[t]=new en(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){kr[t]=new en(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){kr[t]=new en(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){kr[t]=new en(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){kr[t]=new en(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){kr[t]=new en(t,5,!1,t.toLowerCase(),null,!1,!1)});var Gp=/[\-:]([a-z])/g;function Kp(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(Gp,Kp);kr[e]=new en(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(Gp,Kp);kr[e]=new en(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(Gp,Kp);kr[e]=new en(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){kr[t]=new en(t,1,!1,t.toLowerCase(),null,!1,!1)});kr.xlinkHref=new en("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){kr[t]=new en(t,1,!1,t.toLowerCase(),null,!0,!0)});function qp(t,e,r,n){var s=kr.hasOwnProperty(e)?kr[e]:null;(s!==null?s.type!==0:n||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(wC(e,r,s,n)&&(r=null),n||s===null?_C(e)&&(r===null?t.removeAttribute(e):t.setAttribute(e,""+r)):s.mustUseProperty?t[s.propertyName]=r===null?s.type===3?!1:"":r:(e=s.attributeName,n=s.attributeNamespace,r===null?t.removeAttribute(e):(s=s.type,r=s===3||s===4&&r===!0?"":""+r,n?t.setAttributeNS(n,e,r):t.setAttribute(e,r))))}var va=vC.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,tf=Symbol.for("react.element"),To=Symbol.for("react.portal"),ko=Symbol.for("react.fragment"),Xp=Symbol.for("react.strict_mode"),im=Symbol.for("react.profiler"),dE=Symbol.for("react.provider"),mE=Symbol.for("react.context"),Yp=Symbol.for("react.forward_ref"),om=Symbol.for("react.suspense"),lm=Symbol.for("react.suspense_list"),Qp=Symbol.for("react.memo"),Ca=Symbol.for("react.lazy"),pE=Symbol.for("react.offscreen"),Qx=Symbol.iterator;function Ol(t){return t===null||typeof t!="object"?null:(t=Qx&&t[Qx]||t["@@iterator"],typeof t=="function"?t:null)}var Mt=Object.assign,l0;function Kl(t){if(l0===void 0)try{throw Error()}catch(r){var e=r.stack.trim().match(/\n( *(at )?)/);l0=e&&e[1]||""}return`
`+l0+t}var c0=!1;function u0(t,e){if(!t||c0)return"";c0=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(c){var n=c}Reflect.construct(t,[],e)}else{try{e.call()}catch(c){n=c}t.call(e.prototype)}else{try{throw Error()}catch(c){n=c}t()}}catch(c){if(c&&n&&typeof c.stack=="string"){for(var s=c.stack.split(`
`),a=n.stack.split(`
`),i=s.length-1,o=a.length-1;1<=i&&0<=o&&s[i]!==a[o];)o--;for(;1<=i&&0<=o;i--,o--)if(s[i]!==a[o]){if(i!==1||o!==1)do if(i--,o--,0>o||s[i]!==a[o]){var l=`
`+s[i].replace(" at new "," at ");return t.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",t.displayName)),l}while(1<=i&&0<=o);break}}}finally{c0=!1,Error.prepareStackTrace=r}return(t=t?t.displayName||t.name:"")?Kl(t):""}function EC(t){switch(t.tag){case 5:return Kl(t.type);case 16:return Kl("Lazy");case 13:return Kl("Suspense");case 19:return Kl("SuspenseList");case 0:case 2:case 15:return t=u0(t.type,!1),t;case 11:return t=u0(t.type.render,!1),t;case 1:return t=u0(t.type,!0),t;default:return""}}function cm(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case ko:return"Fragment";case To:return"Portal";case im:return"Profiler";case Xp:return"StrictMode";case om:return"Suspense";case lm:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case mE:return(t.displayName||"Context")+".Consumer";case dE:return(t._context.displayName||"Context")+".Provider";case Yp:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case Qp:return e=t.displayName||null,e!==null?e:cm(t.type)||"Memo";case Ca:e=t._payload,t=t._init;try{return cm(t(e))}catch{}}return null}function TC(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return cm(e);case 8:return e===Xp?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function ei(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function gE(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function kC(t){var e=gE(t)?"checked":"value",r=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),n=""+t[e];if(!t.hasOwnProperty(e)&&typeof r<"u"&&typeof r.get=="function"&&typeof r.set=="function"){var s=r.get,a=r.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return s.call(this)},set:function(i){n=""+i,a.call(this,i)}}),Object.defineProperty(t,e,{enumerable:r.enumerable}),{getValue:function(){return n},setValue:function(i){n=""+i},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function rf(t){t._valueTracker||(t._valueTracker=kC(t))}function vE(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var r=e.getValue(),n="";return t&&(n=gE(t)?t.checked?"true":"false":t.value),t=n,t!==r?(e.setValue(t),!0):!1}function rh(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function um(t,e){var r=e.checked;return Mt({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:r??t._wrapperState.initialChecked})}function Jx(t,e){var r=e.defaultValue==null?"":e.defaultValue,n=e.checked!=null?e.checked:e.defaultChecked;r=ei(e.value!=null?e.value:r),t._wrapperState={initialChecked:n,initialValue:r,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function xE(t,e){e=e.checked,e!=null&&qp(t,"checked",e,!1)}function fm(t,e){xE(t,e);var r=ei(e.value),n=e.type;if(r!=null)n==="number"?(r===0&&t.value===""||t.value!=r)&&(t.value=""+r):t.value!==""+r&&(t.value=""+r);else if(n==="submit"||n==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?hm(t,e.type,r):e.hasOwnProperty("defaultValue")&&hm(t,e.type,ei(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function Zx(t,e,r){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var n=e.type;if(!(n!=="submit"&&n!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,r||e===t.value||(t.value=e),t.defaultValue=e}r=t.name,r!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,r!==""&&(t.name=r)}function hm(t,e,r){(e!=="number"||rh(t.ownerDocument)!==t)&&(r==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+r&&(t.defaultValue=""+r))}var ql=Array.isArray;function Mo(t,e,r,n){if(t=t.options,e){e={};for(var s=0;s<r.length;s++)e["$"+r[s]]=!0;for(r=0;r<t.length;r++)s=e.hasOwnProperty("$"+t[r].value),t[r].selected!==s&&(t[r].selected=s),s&&n&&(t[r].defaultSelected=!0)}else{for(r=""+ei(r),e=null,s=0;s<t.length;s++){if(t[s].value===r){t[s].selected=!0,n&&(t[s].defaultSelected=!0);return}e!==null||t[s].disabled||(e=t[s])}e!==null&&(e.selected=!0)}}function dm(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(ye(91));return Mt({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function e1(t,e){var r=e.value;if(r==null){if(r=e.children,e=e.defaultValue,r!=null){if(e!=null)throw Error(ye(92));if(ql(r)){if(1<r.length)throw Error(ye(93));r=r[0]}e=r}e==null&&(e=""),r=e}t._wrapperState={initialValue:ei(r)}}function _E(t,e){var r=ei(e.value),n=ei(e.defaultValue);r!=null&&(r=""+r,r!==t.value&&(t.value=r),e.defaultValue==null&&t.defaultValue!==r&&(t.defaultValue=r)),n!=null&&(t.defaultValue=""+n)}function t1(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function yE(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function mm(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?yE(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var nf,wE=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,r,n,s){MSApp.execUnsafeLocalFunction(function(){return t(e,r,n,s)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(nf=nf||document.createElement("div"),nf.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=nf.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function Pc(t,e){if(e){var r=t.firstChild;if(r&&r===t.lastChild&&r.nodeType===3){r.nodeValue=e;return}}t.textContent=e}var ic={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},SC=["Webkit","ms","Moz","O"];Object.keys(ic).forEach(function(t){SC.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),ic[e]=ic[t]})});function EE(t,e,r){return e==null||typeof e=="boolean"||e===""?"":r||typeof e!="number"||e===0||ic.hasOwnProperty(t)&&ic[t]?(""+e).trim():e+"px"}function TE(t,e){t=t.style;for(var r in e)if(e.hasOwnProperty(r)){var n=r.indexOf("--")===0,s=EE(r,e[r],n);r==="float"&&(r="cssFloat"),n?t.setProperty(r,s):t[r]=s}}var AC=Mt({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function pm(t,e){if(e){if(AC[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(ye(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(ye(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(ye(61))}if(e.style!=null&&typeof e.style!="object")throw Error(ye(62))}}function gm(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var vm=null;function Jp(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var xm=null,Lo=null,jo=null;function r1(t){if(t=vu(t)){if(typeof xm!="function")throw Error(ye(280));var e=t.stateNode;e&&(e=dd(e),xm(t.stateNode,t.type,e))}}function kE(t){Lo?jo?jo.push(t):jo=[t]:Lo=t}function SE(){if(Lo){var t=Lo,e=jo;if(jo=Lo=null,r1(t),e)for(t=0;t<e.length;t++)r1(e[t])}}function AE(t,e){return t(e)}function IE(){}var f0=!1;function CE(t,e,r){if(f0)return t(e,r);f0=!0;try{return AE(t,e,r)}finally{f0=!1,(Lo!==null||jo!==null)&&(IE(),SE())}}function bc(t,e){var r=t.stateNode;if(r===null)return null;var n=dd(r);if(n===null)return null;r=n[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(t=t.type,n=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!n;break e;default:t=!1}if(t)return null;if(r&&typeof r!="function")throw Error(ye(231,e,typeof r));return r}var _m=!1;if(aa)try{var Ml={};Object.defineProperty(Ml,"passive",{get:function(){_m=!0}}),window.addEventListener("test",Ml,Ml),window.removeEventListener("test",Ml,Ml)}catch{_m=!1}function IC(t,e,r,n,s,a,i,o,l){var c=Array.prototype.slice.call(arguments,3);try{e.apply(r,c)}catch(u){this.onError(u)}}var oc=!1,nh=null,sh=!1,ym=null,CC={onError:function(t){oc=!0,nh=t}};function RC(t,e,r,n,s,a,i,o,l){oc=!1,nh=null,IC.apply(CC,arguments)}function NC(t,e,r,n,s,a,i,o,l){if(RC.apply(this,arguments),oc){if(oc){var c=nh;oc=!1,nh=null}else throw Error(ye(198));sh||(sh=!0,ym=c)}}function Ji(t){var e=t,r=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(r=e.return),t=e.return;while(t)}return e.tag===3?r:null}function RE(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function n1(t){if(Ji(t)!==t)throw Error(ye(188))}function PC(t){var e=t.alternate;if(!e){if(e=Ji(t),e===null)throw Error(ye(188));return e!==t?null:t}for(var r=t,n=e;;){var s=r.return;if(s===null)break;var a=s.alternate;if(a===null){if(n=s.return,n!==null){r=n;continue}break}if(s.child===a.child){for(a=s.child;a;){if(a===r)return n1(s),t;if(a===n)return n1(s),e;a=a.sibling}throw Error(ye(188))}if(r.return!==n.return)r=s,n=a;else{for(var i=!1,o=s.child;o;){if(o===r){i=!0,r=s,n=a;break}if(o===n){i=!0,n=s,r=a;break}o=o.sibling}if(!i){for(o=a.child;o;){if(o===r){i=!0,r=a,n=s;break}if(o===n){i=!0,n=a,r=s;break}o=o.sibling}if(!i)throw Error(ye(189))}}if(r.alternate!==n)throw Error(ye(190))}if(r.tag!==3)throw Error(ye(188));return r.stateNode.current===r?t:e}function NE(t){return t=PC(t),t!==null?PE(t):null}function PE(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=PE(t);if(e!==null)return e;t=t.sibling}return null}var bE=Sn.unstable_scheduleCallback,s1=Sn.unstable_cancelCallback,bC=Sn.unstable_shouldYield,DC=Sn.unstable_requestPaint,Wt=Sn.unstable_now,FC=Sn.unstable_getCurrentPriorityLevel,Zp=Sn.unstable_ImmediatePriority,DE=Sn.unstable_UserBlockingPriority,ah=Sn.unstable_NormalPriority,OC=Sn.unstable_LowPriority,FE=Sn.unstable_IdlePriority,cd=null,Es=null;function MC(t){if(Es&&typeof Es.onCommitFiberRoot=="function")try{Es.onCommitFiberRoot(cd,t,void 0,(t.current.flags&128)===128)}catch{}}var as=Math.clz32?Math.clz32:VC,LC=Math.log,jC=Math.LN2;function VC(t){return t>>>=0,t===0?32:31-(LC(t)/jC|0)|0}var sf=64,af=4194304;function Xl(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function ih(t,e){var r=t.pendingLanes;if(r===0)return 0;var n=0,s=t.suspendedLanes,a=t.pingedLanes,i=r&268435455;if(i!==0){var o=i&~s;o!==0?n=Xl(o):(a&=i,a!==0&&(n=Xl(a)))}else i=r&~s,i!==0?n=Xl(i):a!==0&&(n=Xl(a));if(n===0)return 0;if(e!==0&&e!==n&&!(e&s)&&(s=n&-n,a=e&-e,s>=a||s===16&&(a&4194240)!==0))return e;if(n&4&&(n|=r&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=n;0<e;)r=31-as(e),s=1<<r,n|=t[r],e&=~s;return n}function UC(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function BC(t,e){for(var r=t.suspendedLanes,n=t.pingedLanes,s=t.expirationTimes,a=t.pendingLanes;0<a;){var i=31-as(a),o=1<<i,l=s[i];l===-1?(!(o&r)||o&n)&&(s[i]=UC(o,e)):l<=e&&(t.expiredLanes|=o),a&=~o}}function wm(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function OE(){var t=sf;return sf<<=1,!(sf&4194240)&&(sf=64),t}function h0(t){for(var e=[],r=0;31>r;r++)e.push(t);return e}function pu(t,e,r){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-as(e),t[e]=r}function zC(t,e){var r=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var n=t.eventTimes;for(t=t.expirationTimes;0<r;){var s=31-as(r),a=1<<s;e[s]=0,n[s]=-1,t[s]=-1,r&=~a}}function eg(t,e){var r=t.entangledLanes|=e;for(t=t.entanglements;r;){var n=31-as(r),s=1<<n;s&e|t[n]&e&&(t[n]|=e),r&=~s}}var pt=0;function ME(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var LE,tg,jE,VE,UE,Em=!1,of=[],za=null,$a=null,Wa=null,Dc=new Map,Fc=new Map,Na=[],$C="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function a1(t,e){switch(t){case"focusin":case"focusout":za=null;break;case"dragenter":case"dragleave":$a=null;break;case"mouseover":case"mouseout":Wa=null;break;case"pointerover":case"pointerout":Dc.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":Fc.delete(e.pointerId)}}function Ll(t,e,r,n,s,a){return t===null||t.nativeEvent!==a?(t={blockedOn:e,domEventName:r,eventSystemFlags:n,nativeEvent:a,targetContainers:[s]},e!==null&&(e=vu(e),e!==null&&tg(e)),t):(t.eventSystemFlags|=n,e=t.targetContainers,s!==null&&e.indexOf(s)===-1&&e.push(s),t)}function WC(t,e,r,n,s){switch(e){case"focusin":return za=Ll(za,t,e,r,n,s),!0;case"dragenter":return $a=Ll($a,t,e,r,n,s),!0;case"mouseover":return Wa=Ll(Wa,t,e,r,n,s),!0;case"pointerover":var a=s.pointerId;return Dc.set(a,Ll(Dc.get(a)||null,t,e,r,n,s)),!0;case"gotpointercapture":return a=s.pointerId,Fc.set(a,Ll(Fc.get(a)||null,t,e,r,n,s)),!0}return!1}function BE(t){var e=Si(t.target);if(e!==null){var r=Ji(e);if(r!==null){if(e=r.tag,e===13){if(e=RE(r),e!==null){t.blockedOn=e,UE(t.priority,function(){jE(r)});return}}else if(e===3&&r.stateNode.current.memoizedState.isDehydrated){t.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}t.blockedOn=null}function Mf(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var r=Tm(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(r===null){r=t.nativeEvent;var n=new r.constructor(r.type,r);vm=n,r.target.dispatchEvent(n),vm=null}else return e=vu(r),e!==null&&tg(e),t.blockedOn=r,!1;e.shift()}return!0}function i1(t,e,r){Mf(t)&&r.delete(e)}function HC(){Em=!1,za!==null&&Mf(za)&&(za=null),$a!==null&&Mf($a)&&($a=null),Wa!==null&&Mf(Wa)&&(Wa=null),Dc.forEach(i1),Fc.forEach(i1)}function jl(t,e){t.blockedOn===e&&(t.blockedOn=null,Em||(Em=!0,Sn.unstable_scheduleCallback(Sn.unstable_NormalPriority,HC)))}function Oc(t){function e(s){return jl(s,t)}if(0<of.length){jl(of[0],t);for(var r=1;r<of.length;r++){var n=of[r];n.blockedOn===t&&(n.blockedOn=null)}}for(za!==null&&jl(za,t),$a!==null&&jl($a,t),Wa!==null&&jl(Wa,t),Dc.forEach(e),Fc.forEach(e),r=0;r<Na.length;r++)n=Na[r],n.blockedOn===t&&(n.blockedOn=null);for(;0<Na.length&&(r=Na[0],r.blockedOn===null);)BE(r),r.blockedOn===null&&Na.shift()}var Vo=va.ReactCurrentBatchConfig,oh=!0;function GC(t,e,r,n){var s=pt,a=Vo.transition;Vo.transition=null;try{pt=1,rg(t,e,r,n)}finally{pt=s,Vo.transition=a}}function KC(t,e,r,n){var s=pt,a=Vo.transition;Vo.transition=null;try{pt=4,rg(t,e,r,n)}finally{pt=s,Vo.transition=a}}function rg(t,e,r,n){if(oh){var s=Tm(t,e,r,n);if(s===null)E0(t,e,n,lh,r),a1(t,n);else if(WC(s,t,e,r,n))n.stopPropagation();else if(a1(t,n),e&4&&-1<$C.indexOf(t)){for(;s!==null;){var a=vu(s);if(a!==null&&LE(a),a=Tm(t,e,r,n),a===null&&E0(t,e,n,lh,r),a===s)break;s=a}s!==null&&n.stopPropagation()}else E0(t,e,n,null,r)}}var lh=null;function Tm(t,e,r,n){if(lh=null,t=Jp(n),t=Si(t),t!==null)if(e=Ji(t),e===null)t=null;else if(r=e.tag,r===13){if(t=RE(e),t!==null)return t;t=null}else if(r===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return lh=t,null}function zE(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(FC()){case Zp:return 1;case DE:return 4;case ah:case OC:return 16;case FE:return 536870912;default:return 16}default:return 16}}var Ma=null,ng=null,Lf=null;function $E(){if(Lf)return Lf;var t,e=ng,r=e.length,n,s="value"in Ma?Ma.value:Ma.textContent,a=s.length;for(t=0;t<r&&e[t]===s[t];t++);var i=r-t;for(n=1;n<=i&&e[r-n]===s[a-n];n++);return Lf=s.slice(t,1<n?1-n:void 0)}function jf(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function lf(){return!0}function o1(){return!1}function Cn(t){function e(r,n,s,a,i){this._reactName=r,this._targetInst=s,this.type=n,this.nativeEvent=a,this.target=i,this.currentTarget=null;for(var o in t)t.hasOwnProperty(o)&&(r=t[o],this[o]=r?r(a):a[o]);return this.isDefaultPrevented=(a.defaultPrevented!=null?a.defaultPrevented:a.returnValue===!1)?lf:o1,this.isPropagationStopped=o1,this}return Mt(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=lf)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=lf)},persist:function(){},isPersistent:lf}),e}var gl={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},sg=Cn(gl),gu=Mt({},gl,{view:0,detail:0}),qC=Cn(gu),d0,m0,Vl,ud=Mt({},gu,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:ag,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==Vl&&(Vl&&t.type==="mousemove"?(d0=t.screenX-Vl.screenX,m0=t.screenY-Vl.screenY):m0=d0=0,Vl=t),d0)},movementY:function(t){return"movementY"in t?t.movementY:m0}}),l1=Cn(ud),XC=Mt({},ud,{dataTransfer:0}),YC=Cn(XC),QC=Mt({},gu,{relatedTarget:0}),p0=Cn(QC),JC=Mt({},gl,{animationName:0,elapsedTime:0,pseudoElement:0}),ZC=Cn(JC),e4=Mt({},gl,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),t4=Cn(e4),r4=Mt({},gl,{data:0}),c1=Cn(r4),n4={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},s4={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},a4={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function i4(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=a4[t])?!!e[t]:!1}function ag(){return i4}var o4=Mt({},gu,{key:function(t){if(t.key){var e=n4[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=jf(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?s4[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:ag,charCode:function(t){return t.type==="keypress"?jf(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?jf(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),l4=Cn(o4),c4=Mt({},ud,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),u1=Cn(c4),u4=Mt({},gu,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:ag}),f4=Cn(u4),h4=Mt({},gl,{propertyName:0,elapsedTime:0,pseudoElement:0}),d4=Cn(h4),m4=Mt({},ud,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),p4=Cn(m4),g4=[9,13,27,32],ig=aa&&"CompositionEvent"in window,lc=null;aa&&"documentMode"in document&&(lc=document.documentMode);var v4=aa&&"TextEvent"in window&&!lc,WE=aa&&(!ig||lc&&8<lc&&11>=lc),f1=" ",h1=!1;function HE(t,e){switch(t){case"keyup":return g4.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function GE(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var So=!1;function x4(t,e){switch(t){case"compositionend":return GE(e);case"keypress":return e.which!==32?null:(h1=!0,f1);case"textInput":return t=e.data,t===f1&&h1?null:t;default:return null}}function _4(t,e){if(So)return t==="compositionend"||!ig&&HE(t,e)?(t=$E(),Lf=ng=Ma=null,So=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return WE&&e.locale!=="ko"?null:e.data;default:return null}}var y4={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function d1(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!y4[t.type]:e==="textarea"}function KE(t,e,r,n){kE(n),e=ch(e,"onChange"),0<e.length&&(r=new sg("onChange","change",null,r,n),t.push({event:r,listeners:e}))}var cc=null,Mc=null;function w4(t){s2(t,0)}function fd(t){var e=Co(t);if(vE(e))return t}function E4(t,e){if(t==="change")return e}var qE=!1;if(aa){var g0;if(aa){var v0="oninput"in document;if(!v0){var m1=document.createElement("div");m1.setAttribute("oninput","return;"),v0=typeof m1.oninput=="function"}g0=v0}else g0=!1;qE=g0&&(!document.documentMode||9<document.documentMode)}function p1(){cc&&(cc.detachEvent("onpropertychange",XE),Mc=cc=null)}function XE(t){if(t.propertyName==="value"&&fd(Mc)){var e=[];KE(e,Mc,t,Jp(t)),CE(w4,e)}}function T4(t,e,r){t==="focusin"?(p1(),cc=e,Mc=r,cc.attachEvent("onpropertychange",XE)):t==="focusout"&&p1()}function k4(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return fd(Mc)}function S4(t,e){if(t==="click")return fd(e)}function A4(t,e){if(t==="input"||t==="change")return fd(e)}function I4(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var cs=typeof Object.is=="function"?Object.is:I4;function Lc(t,e){if(cs(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var r=Object.keys(t),n=Object.keys(e);if(r.length!==n.length)return!1;for(n=0;n<r.length;n++){var s=r[n];if(!am.call(e,s)||!cs(t[s],e[s]))return!1}return!0}function g1(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function v1(t,e){var r=g1(t);t=0;for(var n;r;){if(r.nodeType===3){if(n=t+r.textContent.length,t<=e&&n>=e)return{node:r,offset:e-t};t=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=g1(r)}}function YE(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?YE(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function QE(){for(var t=window,e=rh();e instanceof t.HTMLIFrameElement;){try{var r=typeof e.contentWindow.location.href=="string"}catch{r=!1}if(r)t=e.contentWindow;else break;e=rh(t.document)}return e}function og(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function C4(t){var e=QE(),r=t.focusedElem,n=t.selectionRange;if(e!==r&&r&&r.ownerDocument&&YE(r.ownerDocument.documentElement,r)){if(n!==null&&og(r)){if(e=n.start,t=n.end,t===void 0&&(t=e),"selectionStart"in r)r.selectionStart=e,r.selectionEnd=Math.min(t,r.value.length);else if(t=(e=r.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var s=r.textContent.length,a=Math.min(n.start,s);n=n.end===void 0?a:Math.min(n.end,s),!t.extend&&a>n&&(s=n,n=a,a=s),s=v1(r,a);var i=v1(r,n);s&&i&&(t.rangeCount!==1||t.anchorNode!==s.node||t.anchorOffset!==s.offset||t.focusNode!==i.node||t.focusOffset!==i.offset)&&(e=e.createRange(),e.setStart(s.node,s.offset),t.removeAllRanges(),a>n?(t.addRange(e),t.extend(i.node,i.offset)):(e.setEnd(i.node,i.offset),t.addRange(e)))}}for(e=[],t=r;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof r.focus=="function"&&r.focus(),r=0;r<e.length;r++)t=e[r],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var R4=aa&&"documentMode"in document&&11>=document.documentMode,Ao=null,km=null,uc=null,Sm=!1;function x1(t,e,r){var n=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;Sm||Ao==null||Ao!==rh(n)||(n=Ao,"selectionStart"in n&&og(n)?n={start:n.selectionStart,end:n.selectionEnd}:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection(),n={anchorNode:n.anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset}),uc&&Lc(uc,n)||(uc=n,n=ch(km,"onSelect"),0<n.length&&(e=new sg("onSelect","select",null,e,r),t.push({event:e,listeners:n}),e.target=Ao)))}function cf(t,e){var r={};return r[t.toLowerCase()]=e.toLowerCase(),r["Webkit"+t]="webkit"+e,r["Moz"+t]="moz"+e,r}var Io={animationend:cf("Animation","AnimationEnd"),animationiteration:cf("Animation","AnimationIteration"),animationstart:cf("Animation","AnimationStart"),transitionend:cf("Transition","TransitionEnd")},x0={},JE={};aa&&(JE=document.createElement("div").style,"AnimationEvent"in window||(delete Io.animationend.animation,delete Io.animationiteration.animation,delete Io.animationstart.animation),"TransitionEvent"in window||delete Io.transitionend.transition);function hd(t){if(x0[t])return x0[t];if(!Io[t])return t;var e=Io[t],r;for(r in e)if(e.hasOwnProperty(r)&&r in JE)return x0[t]=e[r];return t}var ZE=hd("animationend"),e2=hd("animationiteration"),t2=hd("animationstart"),r2=hd("transitionend"),n2=new Map,_1="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function ci(t,e){n2.set(t,e),Qi(e,[t])}for(var _0=0;_0<_1.length;_0++){var y0=_1[_0],N4=y0.toLowerCase(),P4=y0[0].toUpperCase()+y0.slice(1);ci(N4,"on"+P4)}ci(ZE,"onAnimationEnd");ci(e2,"onAnimationIteration");ci(t2,"onAnimationStart");ci("dblclick","onDoubleClick");ci("focusin","onFocus");ci("focusout","onBlur");ci(r2,"onTransitionEnd");Xo("onMouseEnter",["mouseout","mouseover"]);Xo("onMouseLeave",["mouseout","mouseover"]);Xo("onPointerEnter",["pointerout","pointerover"]);Xo("onPointerLeave",["pointerout","pointerover"]);Qi("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Qi("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Qi("onBeforeInput",["compositionend","keypress","textInput","paste"]);Qi("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Qi("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Qi("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Yl="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),b4=new Set("cancel close invalid load scroll toggle".split(" ").concat(Yl));function y1(t,e,r){var n=t.type||"unknown-event";t.currentTarget=r,NC(n,e,void 0,t),t.currentTarget=null}function s2(t,e){e=(e&4)!==0;for(var r=0;r<t.length;r++){var n=t[r],s=n.event;n=n.listeners;e:{var a=void 0;if(e)for(var i=n.length-1;0<=i;i--){var o=n[i],l=o.instance,c=o.currentTarget;if(o=o.listener,l!==a&&s.isPropagationStopped())break e;y1(s,o,c),a=l}else for(i=0;i<n.length;i++){if(o=n[i],l=o.instance,c=o.currentTarget,o=o.listener,l!==a&&s.isPropagationStopped())break e;y1(s,o,c),a=l}}}if(sh)throw t=ym,sh=!1,ym=null,t}function It(t,e){var r=e[Nm];r===void 0&&(r=e[Nm]=new Set);var n=t+"__bubble";r.has(n)||(a2(e,t,2,!1),r.add(n))}function w0(t,e,r){var n=0;e&&(n|=4),a2(r,t,n,e)}var uf="_reactListening"+Math.random().toString(36).slice(2);function jc(t){if(!t[uf]){t[uf]=!0,hE.forEach(function(r){r!=="selectionchange"&&(b4.has(r)||w0(r,!1,t),w0(r,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[uf]||(e[uf]=!0,w0("selectionchange",!1,e))}}function a2(t,e,r,n){switch(zE(e)){case 1:var s=GC;break;case 4:s=KC;break;default:s=rg}r=s.bind(null,e,r,t),s=void 0,!_m||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(s=!0),n?s!==void 0?t.addEventListener(e,r,{capture:!0,passive:s}):t.addEventListener(e,r,!0):s!==void 0?t.addEventListener(e,r,{passive:s}):t.addEventListener(e,r,!1)}function E0(t,e,r,n,s){var a=n;if(!(e&1)&&!(e&2)&&n!==null)e:for(;;){if(n===null)return;var i=n.tag;if(i===3||i===4){var o=n.stateNode.containerInfo;if(o===s||o.nodeType===8&&o.parentNode===s)break;if(i===4)for(i=n.return;i!==null;){var l=i.tag;if((l===3||l===4)&&(l=i.stateNode.containerInfo,l===s||l.nodeType===8&&l.parentNode===s))return;i=i.return}for(;o!==null;){if(i=Si(o),i===null)return;if(l=i.tag,l===5||l===6){n=a=i;continue e}o=o.parentNode}}n=n.return}CE(function(){var c=a,u=Jp(r),h=[];e:{var m=n2.get(t);if(m!==void 0){var p=sg,x=t;switch(t){case"keypress":if(jf(r)===0)break e;case"keydown":case"keyup":p=l4;break;case"focusin":x="focus",p=p0;break;case"focusout":x="blur",p=p0;break;case"beforeblur":case"afterblur":p=p0;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":p=l1;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":p=YC;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":p=f4;break;case ZE:case e2:case t2:p=ZC;break;case r2:p=d4;break;case"scroll":p=qC;break;case"wheel":p=p4;break;case"copy":case"cut":case"paste":p=t4;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":p=u1}var v=(e&4)!==0,w=!v&&t==="scroll",k=v?m!==null?m+"Capture":null:m;v=[];for(var T=c,E;T!==null;){E=T;var N=E.stateNode;if(E.tag===5&&N!==null&&(E=N,k!==null&&(N=bc(T,k),N!=null&&v.push(Vc(T,N,E)))),w)break;T=T.return}0<v.length&&(m=new p(m,x,null,r,u),h.push({event:m,listeners:v}))}}if(!(e&7)){e:{if(m=t==="mouseover"||t==="pointerover",p=t==="mouseout"||t==="pointerout",m&&r!==vm&&(x=r.relatedTarget||r.fromElement)&&(Si(x)||x[ia]))break e;if((p||m)&&(m=u.window===u?u:(m=u.ownerDocument)?m.defaultView||m.parentWindow:window,p?(x=r.relatedTarget||r.toElement,p=c,x=x?Si(x):null,x!==null&&(w=Ji(x),x!==w||x.tag!==5&&x.tag!==6)&&(x=null)):(p=null,x=c),p!==x)){if(v=l1,N="onMouseLeave",k="onMouseEnter",T="mouse",(t==="pointerout"||t==="pointerover")&&(v=u1,N="onPointerLeave",k="onPointerEnter",T="pointer"),w=p==null?m:Co(p),E=x==null?m:Co(x),m=new v(N,T+"leave",p,r,u),m.target=w,m.relatedTarget=E,N=null,Si(u)===c&&(v=new v(k,T+"enter",x,r,u),v.target=E,v.relatedTarget=w,N=v),w=N,p&&x)t:{for(v=p,k=x,T=0,E=v;E;E=go(E))T++;for(E=0,N=k;N;N=go(N))E++;for(;0<T-E;)v=go(v),T--;for(;0<E-T;)k=go(k),E--;for(;T--;){if(v===k||k!==null&&v===k.alternate)break t;v=go(v),k=go(k)}v=null}else v=null;p!==null&&w1(h,m,p,v,!1),x!==null&&w!==null&&w1(h,w,x,v,!0)}}e:{if(m=c?Co(c):window,p=m.nodeName&&m.nodeName.toLowerCase(),p==="select"||p==="input"&&m.type==="file")var O=E4;else if(d1(m))if(qE)O=A4;else{O=k4;var M=T4}else(p=m.nodeName)&&p.toLowerCase()==="input"&&(m.type==="checkbox"||m.type==="radio")&&(O=S4);if(O&&(O=O(t,c))){KE(h,O,r,u);break e}M&&M(t,m,c),t==="focusout"&&(M=m._wrapperState)&&M.controlled&&m.type==="number"&&hm(m,"number",m.value)}switch(M=c?Co(c):window,t){case"focusin":(d1(M)||M.contentEditable==="true")&&(Ao=M,km=c,uc=null);break;case"focusout":uc=km=Ao=null;break;case"mousedown":Sm=!0;break;case"contextmenu":case"mouseup":case"dragend":Sm=!1,x1(h,r,u);break;case"selectionchange":if(R4)break;case"keydown":case"keyup":x1(h,r,u)}var g;if(ig)e:{switch(t){case"compositionstart":var y="onCompositionStart";break e;case"compositionend":y="onCompositionEnd";break e;case"compositionupdate":y="onCompositionUpdate";break e}y=void 0}else So?HE(t,r)&&(y="onCompositionEnd"):t==="keydown"&&r.keyCode===229&&(y="onCompositionStart");y&&(WE&&r.locale!=="ko"&&(So||y!=="onCompositionStart"?y==="onCompositionEnd"&&So&&(g=$E()):(Ma=u,ng="value"in Ma?Ma.value:Ma.textContent,So=!0)),M=ch(c,y),0<M.length&&(y=new c1(y,t,null,r,u),h.push({event:y,listeners:M}),g?y.data=g:(g=GE(r),g!==null&&(y.data=g)))),(g=v4?x4(t,r):_4(t,r))&&(c=ch(c,"onBeforeInput"),0<c.length&&(u=new c1("onBeforeInput","beforeinput",null,r,u),h.push({event:u,listeners:c}),u.data=g))}s2(h,e)})}function Vc(t,e,r){return{instance:t,listener:e,currentTarget:r}}function ch(t,e){for(var r=e+"Capture",n=[];t!==null;){var s=t,a=s.stateNode;s.tag===5&&a!==null&&(s=a,a=bc(t,r),a!=null&&n.unshift(Vc(t,a,s)),a=bc(t,e),a!=null&&n.push(Vc(t,a,s))),t=t.return}return n}function go(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function w1(t,e,r,n,s){for(var a=e._reactName,i=[];r!==null&&r!==n;){var o=r,l=o.alternate,c=o.stateNode;if(l!==null&&l===n)break;o.tag===5&&c!==null&&(o=c,s?(l=bc(r,a),l!=null&&i.unshift(Vc(r,l,o))):s||(l=bc(r,a),l!=null&&i.push(Vc(r,l,o)))),r=r.return}i.length!==0&&t.push({event:e,listeners:i})}var D4=/\r\n?/g,F4=/\u0000|\uFFFD/g;function E1(t){return(typeof t=="string"?t:""+t).replace(D4,`
`).replace(F4,"")}function ff(t,e,r){if(e=E1(e),E1(t)!==e&&r)throw Error(ye(425))}function uh(){}var Am=null,Im=null;function Cm(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var Rm=typeof setTimeout=="function"?setTimeout:void 0,O4=typeof clearTimeout=="function"?clearTimeout:void 0,T1=typeof Promise=="function"?Promise:void 0,M4=typeof queueMicrotask=="function"?queueMicrotask:typeof T1<"u"?function(t){return T1.resolve(null).then(t).catch(L4)}:Rm;function L4(t){setTimeout(function(){throw t})}function T0(t,e){var r=e,n=0;do{var s=r.nextSibling;if(t.removeChild(r),s&&s.nodeType===8)if(r=s.data,r==="/$"){if(n===0){t.removeChild(s),Oc(e);return}n--}else r!=="$"&&r!=="$?"&&r!=="$!"||n++;r=s}while(r);Oc(e)}function Ha(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function k1(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var r=t.data;if(r==="$"||r==="$!"||r==="$?"){if(e===0)return t;e--}else r==="/$"&&e++}t=t.previousSibling}return null}var vl=Math.random().toString(36).slice(2),_s="__reactFiber$"+vl,Uc="__reactProps$"+vl,ia="__reactContainer$"+vl,Nm="__reactEvents$"+vl,j4="__reactListeners$"+vl,V4="__reactHandles$"+vl;function Si(t){var e=t[_s];if(e)return e;for(var r=t.parentNode;r;){if(e=r[ia]||r[_s]){if(r=e.alternate,e.child!==null||r!==null&&r.child!==null)for(t=k1(t);t!==null;){if(r=t[_s])return r;t=k1(t)}return e}t=r,r=t.parentNode}return null}function vu(t){return t=t[_s]||t[ia],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function Co(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(ye(33))}function dd(t){return t[Uc]||null}var Pm=[],Ro=-1;function ui(t){return{current:t}}function Rt(t){0>Ro||(t.current=Pm[Ro],Pm[Ro]=null,Ro--)}function wt(t,e){Ro++,Pm[Ro]=t.current,t.current=e}var ti={},Br=ui(ti),un=ui(!1),ji=ti;function Yo(t,e){var r=t.type.contextTypes;if(!r)return ti;var n=t.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===e)return n.__reactInternalMemoizedMaskedChildContext;var s={},a;for(a in r)s[a]=e[a];return n&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=s),s}function fn(t){return t=t.childContextTypes,t!=null}function fh(){Rt(un),Rt(Br)}function S1(t,e,r){if(Br.current!==ti)throw Error(ye(168));wt(Br,e),wt(un,r)}function i2(t,e,r){var n=t.stateNode;if(e=e.childContextTypes,typeof n.getChildContext!="function")return r;n=n.getChildContext();for(var s in n)if(!(s in e))throw Error(ye(108,TC(t)||"Unknown",s));return Mt({},r,n)}function hh(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||ti,ji=Br.current,wt(Br,t),wt(un,un.current),!0}function A1(t,e,r){var n=t.stateNode;if(!n)throw Error(ye(169));r?(t=i2(t,e,ji),n.__reactInternalMemoizedMergedChildContext=t,Rt(un),Rt(Br),wt(Br,t)):Rt(un),wt(un,r)}var Hs=null,md=!1,k0=!1;function o2(t){Hs===null?Hs=[t]:Hs.push(t)}function U4(t){md=!0,o2(t)}function fi(){if(!k0&&Hs!==null){k0=!0;var t=0,e=pt;try{var r=Hs;for(pt=1;t<r.length;t++){var n=r[t];do n=n(!0);while(n!==null)}Hs=null,md=!1}catch(s){throw Hs!==null&&(Hs=Hs.slice(t+1)),bE(Zp,fi),s}finally{pt=e,k0=!1}}return null}var No=[],Po=0,dh=null,mh=0,On=[],Mn=0,Vi=null,Gs=1,Ks="";function _i(t,e){No[Po++]=mh,No[Po++]=dh,dh=t,mh=e}function l2(t,e,r){On[Mn++]=Gs,On[Mn++]=Ks,On[Mn++]=Vi,Vi=t;var n=Gs;t=Ks;var s=32-as(n)-1;n&=~(1<<s),r+=1;var a=32-as(e)+s;if(30<a){var i=s-s%5;a=(n&(1<<i)-1).toString(32),n>>=i,s-=i,Gs=1<<32-as(e)+s|r<<s|n,Ks=a+t}else Gs=1<<a|r<<s|n,Ks=t}function lg(t){t.return!==null&&(_i(t,1),l2(t,1,0))}function cg(t){for(;t===dh;)dh=No[--Po],No[Po]=null,mh=No[--Po],No[Po]=null;for(;t===Vi;)Vi=On[--Mn],On[Mn]=null,Ks=On[--Mn],On[Mn]=null,Gs=On[--Mn],On[Mn]=null}var Tn=null,wn=null,bt=!1,Zn=null;function c2(t,e){var r=Ln(5,null,null,0);r.elementType="DELETED",r.stateNode=e,r.return=t,e=t.deletions,e===null?(t.deletions=[r],t.flags|=16):e.push(r)}function I1(t,e){switch(t.tag){case 5:var r=t.type;return e=e.nodeType!==1||r.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,Tn=t,wn=Ha(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,Tn=t,wn=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(r=Vi!==null?{id:Gs,overflow:Ks}:null,t.memoizedState={dehydrated:e,treeContext:r,retryLane:1073741824},r=Ln(18,null,null,0),r.stateNode=e,r.return=t,t.child=r,Tn=t,wn=null,!0):!1;default:return!1}}function bm(t){return(t.mode&1)!==0&&(t.flags&128)===0}function Dm(t){if(bt){var e=wn;if(e){var r=e;if(!I1(t,e)){if(bm(t))throw Error(ye(418));e=Ha(r.nextSibling);var n=Tn;e&&I1(t,e)?c2(n,r):(t.flags=t.flags&-4097|2,bt=!1,Tn=t)}}else{if(bm(t))throw Error(ye(418));t.flags=t.flags&-4097|2,bt=!1,Tn=t}}}function C1(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;Tn=t}function hf(t){if(t!==Tn)return!1;if(!bt)return C1(t),bt=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!Cm(t.type,t.memoizedProps)),e&&(e=wn)){if(bm(t))throw u2(),Error(ye(418));for(;e;)c2(t,e),e=Ha(e.nextSibling)}if(C1(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(ye(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var r=t.data;if(r==="/$"){if(e===0){wn=Ha(t.nextSibling);break e}e--}else r!=="$"&&r!=="$!"&&r!=="$?"||e++}t=t.nextSibling}wn=null}}else wn=Tn?Ha(t.stateNode.nextSibling):null;return!0}function u2(){for(var t=wn;t;)t=Ha(t.nextSibling)}function Qo(){wn=Tn=null,bt=!1}function ug(t){Zn===null?Zn=[t]:Zn.push(t)}var B4=va.ReactCurrentBatchConfig;function Ul(t,e,r){if(t=r.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(r._owner){if(r=r._owner,r){if(r.tag!==1)throw Error(ye(309));var n=r.stateNode}if(!n)throw Error(ye(147,t));var s=n,a=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===a?e.ref:(e=function(i){var o=s.refs;i===null?delete o[a]:o[a]=i},e._stringRef=a,e)}if(typeof t!="string")throw Error(ye(284));if(!r._owner)throw Error(ye(290,t))}return t}function df(t,e){throw t=Object.prototype.toString.call(e),Error(ye(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function R1(t){var e=t._init;return e(t._payload)}function f2(t){function e(k,T){if(t){var E=k.deletions;E===null?(k.deletions=[T],k.flags|=16):E.push(T)}}function r(k,T){if(!t)return null;for(;T!==null;)e(k,T),T=T.sibling;return null}function n(k,T){for(k=new Map;T!==null;)T.key!==null?k.set(T.key,T):k.set(T.index,T),T=T.sibling;return k}function s(k,T){return k=Xa(k,T),k.index=0,k.sibling=null,k}function a(k,T,E){return k.index=E,t?(E=k.alternate,E!==null?(E=E.index,E<T?(k.flags|=2,T):E):(k.flags|=2,T)):(k.flags|=1048576,T)}function i(k){return t&&k.alternate===null&&(k.flags|=2),k}function o(k,T,E,N){return T===null||T.tag!==6?(T=P0(E,k.mode,N),T.return=k,T):(T=s(T,E),T.return=k,T)}function l(k,T,E,N){var O=E.type;return O===ko?u(k,T,E.props.children,N,E.key):T!==null&&(T.elementType===O||typeof O=="object"&&O!==null&&O.$$typeof===Ca&&R1(O)===T.type)?(N=s(T,E.props),N.ref=Ul(k,T,E),N.return=k,N):(N=Hf(E.type,E.key,E.props,null,k.mode,N),N.ref=Ul(k,T,E),N.return=k,N)}function c(k,T,E,N){return T===null||T.tag!==4||T.stateNode.containerInfo!==E.containerInfo||T.stateNode.implementation!==E.implementation?(T=b0(E,k.mode,N),T.return=k,T):(T=s(T,E.children||[]),T.return=k,T)}function u(k,T,E,N,O){return T===null||T.tag!==7?(T=Di(E,k.mode,N,O),T.return=k,T):(T=s(T,E),T.return=k,T)}function h(k,T,E){if(typeof T=="string"&&T!==""||typeof T=="number")return T=P0(""+T,k.mode,E),T.return=k,T;if(typeof T=="object"&&T!==null){switch(T.$$typeof){case tf:return E=Hf(T.type,T.key,T.props,null,k.mode,E),E.ref=Ul(k,null,T),E.return=k,E;case To:return T=b0(T,k.mode,E),T.return=k,T;case Ca:var N=T._init;return h(k,N(T._payload),E)}if(ql(T)||Ol(T))return T=Di(T,k.mode,E,null),T.return=k,T;df(k,T)}return null}function m(k,T,E,N){var O=T!==null?T.key:null;if(typeof E=="string"&&E!==""||typeof E=="number")return O!==null?null:o(k,T,""+E,N);if(typeof E=="object"&&E!==null){switch(E.$$typeof){case tf:return E.key===O?l(k,T,E,N):null;case To:return E.key===O?c(k,T,E,N):null;case Ca:return O=E._init,m(k,T,O(E._payload),N)}if(ql(E)||Ol(E))return O!==null?null:u(k,T,E,N,null);df(k,E)}return null}function p(k,T,E,N,O){if(typeof N=="string"&&N!==""||typeof N=="number")return k=k.get(E)||null,o(T,k,""+N,O);if(typeof N=="object"&&N!==null){switch(N.$$typeof){case tf:return k=k.get(N.key===null?E:N.key)||null,l(T,k,N,O);case To:return k=k.get(N.key===null?E:N.key)||null,c(T,k,N,O);case Ca:var M=N._init;return p(k,T,E,M(N._payload),O)}if(ql(N)||Ol(N))return k=k.get(E)||null,u(T,k,N,O,null);df(T,N)}return null}function x(k,T,E,N){for(var O=null,M=null,g=T,y=T=0,S=null;g!==null&&y<E.length;y++){g.index>y?(S=g,g=null):S=g.sibling;var R=m(k,g,E[y],N);if(R===null){g===null&&(g=S);break}t&&g&&R.alternate===null&&e(k,g),T=a(R,T,y),M===null?O=R:M.sibling=R,M=R,g=S}if(y===E.length)return r(k,g),bt&&_i(k,y),O;if(g===null){for(;y<E.length;y++)g=h(k,E[y],N),g!==null&&(T=a(g,T,y),M===null?O=g:M.sibling=g,M=g);return bt&&_i(k,y),O}for(g=n(k,g);y<E.length;y++)S=p(g,k,y,E[y],N),S!==null&&(t&&S.alternate!==null&&g.delete(S.key===null?y:S.key),T=a(S,T,y),M===null?O=S:M.sibling=S,M=S);return t&&g.forEach(function(P){return e(k,P)}),bt&&_i(k,y),O}function v(k,T,E,N){var O=Ol(E);if(typeof O!="function")throw Error(ye(150));if(E=O.call(E),E==null)throw Error(ye(151));for(var M=O=null,g=T,y=T=0,S=null,R=E.next();g!==null&&!R.done;y++,R=E.next()){g.index>y?(S=g,g=null):S=g.sibling;var P=m(k,g,R.value,N);if(P===null){g===null&&(g=S);break}t&&g&&P.alternate===null&&e(k,g),T=a(P,T,y),M===null?O=P:M.sibling=P,M=P,g=S}if(R.done)return r(k,g),bt&&_i(k,y),O;if(g===null){for(;!R.done;y++,R=E.next())R=h(k,R.value,N),R!==null&&(T=a(R,T,y),M===null?O=R:M.sibling=R,M=R);return bt&&_i(k,y),O}for(g=n(k,g);!R.done;y++,R=E.next())R=p(g,k,y,R.value,N),R!==null&&(t&&R.alternate!==null&&g.delete(R.key===null?y:R.key),T=a(R,T,y),M===null?O=R:M.sibling=R,M=R);return t&&g.forEach(function(b){return e(k,b)}),bt&&_i(k,y),O}function w(k,T,E,N){if(typeof E=="object"&&E!==null&&E.type===ko&&E.key===null&&(E=E.props.children),typeof E=="object"&&E!==null){switch(E.$$typeof){case tf:e:{for(var O=E.key,M=T;M!==null;){if(M.key===O){if(O=E.type,O===ko){if(M.tag===7){r(k,M.sibling),T=s(M,E.props.children),T.return=k,k=T;break e}}else if(M.elementType===O||typeof O=="object"&&O!==null&&O.$$typeof===Ca&&R1(O)===M.type){r(k,M.sibling),T=s(M,E.props),T.ref=Ul(k,M,E),T.return=k,k=T;break e}r(k,M);break}else e(k,M);M=M.sibling}E.type===ko?(T=Di(E.props.children,k.mode,N,E.key),T.return=k,k=T):(N=Hf(E.type,E.key,E.props,null,k.mode,N),N.ref=Ul(k,T,E),N.return=k,k=N)}return i(k);case To:e:{for(M=E.key;T!==null;){if(T.key===M)if(T.tag===4&&T.stateNode.containerInfo===E.containerInfo&&T.stateNode.implementation===E.implementation){r(k,T.sibling),T=s(T,E.children||[]),T.return=k,k=T;break e}else{r(k,T);break}else e(k,T);T=T.sibling}T=b0(E,k.mode,N),T.return=k,k=T}return i(k);case Ca:return M=E._init,w(k,T,M(E._payload),N)}if(ql(E))return x(k,T,E,N);if(Ol(E))return v(k,T,E,N);df(k,E)}return typeof E=="string"&&E!==""||typeof E=="number"?(E=""+E,T!==null&&T.tag===6?(r(k,T.sibling),T=s(T,E),T.return=k,k=T):(r(k,T),T=P0(E,k.mode,N),T.return=k,k=T),i(k)):r(k,T)}return w}var Jo=f2(!0),h2=f2(!1),ph=ui(null),gh=null,bo=null,fg=null;function hg(){fg=bo=gh=null}function dg(t){var e=ph.current;Rt(ph),t._currentValue=e}function Fm(t,e,r){for(;t!==null;){var n=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,n!==null&&(n.childLanes|=e)):n!==null&&(n.childLanes&e)!==e&&(n.childLanes|=e),t===r)break;t=t.return}}function Uo(t,e){gh=t,fg=bo=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(cn=!0),t.firstContext=null)}function Bn(t){var e=t._currentValue;if(fg!==t)if(t={context:t,memoizedValue:e,next:null},bo===null){if(gh===null)throw Error(ye(308));bo=t,gh.dependencies={lanes:0,firstContext:t}}else bo=bo.next=t;return e}var Ai=null;function mg(t){Ai===null?Ai=[t]:Ai.push(t)}function d2(t,e,r,n){var s=e.interleaved;return s===null?(r.next=r,mg(e)):(r.next=s.next,s.next=r),e.interleaved=r,oa(t,n)}function oa(t,e){t.lanes|=e;var r=t.alternate;for(r!==null&&(r.lanes|=e),r=t,t=t.return;t!==null;)t.childLanes|=e,r=t.alternate,r!==null&&(r.childLanes|=e),r=t,t=t.return;return r.tag===3?r.stateNode:null}var Ra=!1;function pg(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function m2(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function Zs(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function Ga(t,e,r){var n=t.updateQueue;if(n===null)return null;if(n=n.shared,at&2){var s=n.pending;return s===null?e.next=e:(e.next=s.next,s.next=e),n.pending=e,oa(t,r)}return s=n.interleaved,s===null?(e.next=e,mg(n)):(e.next=s.next,s.next=e),n.interleaved=e,oa(t,r)}function Vf(t,e,r){if(e=e.updateQueue,e!==null&&(e=e.shared,(r&4194240)!==0)){var n=e.lanes;n&=t.pendingLanes,r|=n,e.lanes=r,eg(t,r)}}function N1(t,e){var r=t.updateQueue,n=t.alternate;if(n!==null&&(n=n.updateQueue,r===n)){var s=null,a=null;if(r=r.firstBaseUpdate,r!==null){do{var i={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};a===null?s=a=i:a=a.next=i,r=r.next}while(r!==null);a===null?s=a=e:a=a.next=e}else s=a=e;r={baseState:n.baseState,firstBaseUpdate:s,lastBaseUpdate:a,shared:n.shared,effects:n.effects},t.updateQueue=r;return}t=r.lastBaseUpdate,t===null?r.firstBaseUpdate=e:t.next=e,r.lastBaseUpdate=e}function vh(t,e,r,n){var s=t.updateQueue;Ra=!1;var a=s.firstBaseUpdate,i=s.lastBaseUpdate,o=s.shared.pending;if(o!==null){s.shared.pending=null;var l=o,c=l.next;l.next=null,i===null?a=c:i.next=c,i=l;var u=t.alternate;u!==null&&(u=u.updateQueue,o=u.lastBaseUpdate,o!==i&&(o===null?u.firstBaseUpdate=c:o.next=c,u.lastBaseUpdate=l))}if(a!==null){var h=s.baseState;i=0,u=c=l=null,o=a;do{var m=o.lane,p=o.eventTime;if((n&m)===m){u!==null&&(u=u.next={eventTime:p,lane:0,tag:o.tag,payload:o.payload,callback:o.callback,next:null});e:{var x=t,v=o;switch(m=e,p=r,v.tag){case 1:if(x=v.payload,typeof x=="function"){h=x.call(p,h,m);break e}h=x;break e;case 3:x.flags=x.flags&-65537|128;case 0:if(x=v.payload,m=typeof x=="function"?x.call(p,h,m):x,m==null)break e;h=Mt({},h,m);break e;case 2:Ra=!0}}o.callback!==null&&o.lane!==0&&(t.flags|=64,m=s.effects,m===null?s.effects=[o]:m.push(o))}else p={eventTime:p,lane:m,tag:o.tag,payload:o.payload,callback:o.callback,next:null},u===null?(c=u=p,l=h):u=u.next=p,i|=m;if(o=o.next,o===null){if(o=s.shared.pending,o===null)break;m=o,o=m.next,m.next=null,s.lastBaseUpdate=m,s.shared.pending=null}}while(!0);if(u===null&&(l=h),s.baseState=l,s.firstBaseUpdate=c,s.lastBaseUpdate=u,e=s.shared.interleaved,e!==null){s=e;do i|=s.lane,s=s.next;while(s!==e)}else a===null&&(s.shared.lanes=0);Bi|=i,t.lanes=i,t.memoizedState=h}}function P1(t,e,r){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var n=t[e],s=n.callback;if(s!==null){if(n.callback=null,n=r,typeof s!="function")throw Error(ye(191,s));s.call(n)}}}var xu={},Ts=ui(xu),Bc=ui(xu),zc=ui(xu);function Ii(t){if(t===xu)throw Error(ye(174));return t}function gg(t,e){switch(wt(zc,e),wt(Bc,t),wt(Ts,xu),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:mm(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=mm(e,t)}Rt(Ts),wt(Ts,e)}function Zo(){Rt(Ts),Rt(Bc),Rt(zc)}function p2(t){Ii(zc.current);var e=Ii(Ts.current),r=mm(e,t.type);e!==r&&(wt(Bc,t),wt(Ts,r))}function vg(t){Bc.current===t&&(Rt(Ts),Rt(Bc))}var Ft=ui(0);function xh(t){for(var e=t;e!==null;){if(e.tag===13){var r=e.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||r.data==="$?"||r.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var S0=[];function xg(){for(var t=0;t<S0.length;t++)S0[t]._workInProgressVersionPrimary=null;S0.length=0}var Uf=va.ReactCurrentDispatcher,A0=va.ReactCurrentBatchConfig,Ui=0,Ot=null,rr=null,fr=null,_h=!1,fc=!1,$c=0,z4=0;function Rr(){throw Error(ye(321))}function _g(t,e){if(e===null)return!1;for(var r=0;r<e.length&&r<t.length;r++)if(!cs(t[r],e[r]))return!1;return!0}function yg(t,e,r,n,s,a){if(Ui=a,Ot=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,Uf.current=t===null||t.memoizedState===null?G4:K4,t=r(n,s),fc){a=0;do{if(fc=!1,$c=0,25<=a)throw Error(ye(301));a+=1,fr=rr=null,e.updateQueue=null,Uf.current=q4,t=r(n,s)}while(fc)}if(Uf.current=yh,e=rr!==null&&rr.next!==null,Ui=0,fr=rr=Ot=null,_h=!1,e)throw Error(ye(300));return t}function wg(){var t=$c!==0;return $c=0,t}function xs(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return fr===null?Ot.memoizedState=fr=t:fr=fr.next=t,fr}function zn(){if(rr===null){var t=Ot.alternate;t=t!==null?t.memoizedState:null}else t=rr.next;var e=fr===null?Ot.memoizedState:fr.next;if(e!==null)fr=e,rr=t;else{if(t===null)throw Error(ye(310));rr=t,t={memoizedState:rr.memoizedState,baseState:rr.baseState,baseQueue:rr.baseQueue,queue:rr.queue,next:null},fr===null?Ot.memoizedState=fr=t:fr=fr.next=t}return fr}function Wc(t,e){return typeof e=="function"?e(t):e}function I0(t){var e=zn(),r=e.queue;if(r===null)throw Error(ye(311));r.lastRenderedReducer=t;var n=rr,s=n.baseQueue,a=r.pending;if(a!==null){if(s!==null){var i=s.next;s.next=a.next,a.next=i}n.baseQueue=s=a,r.pending=null}if(s!==null){a=s.next,n=n.baseState;var o=i=null,l=null,c=a;do{var u=c.lane;if((Ui&u)===u)l!==null&&(l=l.next={lane:0,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null}),n=c.hasEagerState?c.eagerState:t(n,c.action);else{var h={lane:u,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null};l===null?(o=l=h,i=n):l=l.next=h,Ot.lanes|=u,Bi|=u}c=c.next}while(c!==null&&c!==a);l===null?i=n:l.next=o,cs(n,e.memoizedState)||(cn=!0),e.memoizedState=n,e.baseState=i,e.baseQueue=l,r.lastRenderedState=n}if(t=r.interleaved,t!==null){s=t;do a=s.lane,Ot.lanes|=a,Bi|=a,s=s.next;while(s!==t)}else s===null&&(r.lanes=0);return[e.memoizedState,r.dispatch]}function C0(t){var e=zn(),r=e.queue;if(r===null)throw Error(ye(311));r.lastRenderedReducer=t;var n=r.dispatch,s=r.pending,a=e.memoizedState;if(s!==null){r.pending=null;var i=s=s.next;do a=t(a,i.action),i=i.next;while(i!==s);cs(a,e.memoizedState)||(cn=!0),e.memoizedState=a,e.baseQueue===null&&(e.baseState=a),r.lastRenderedState=a}return[a,n]}function g2(){}function v2(t,e){var r=Ot,n=zn(),s=e(),a=!cs(n.memoizedState,s);if(a&&(n.memoizedState=s,cn=!0),n=n.queue,Eg(y2.bind(null,r,n,t),[t]),n.getSnapshot!==e||a||fr!==null&&fr.memoizedState.tag&1){if(r.flags|=2048,Hc(9,_2.bind(null,r,n,s,e),void 0,null),hr===null)throw Error(ye(349));Ui&30||x2(r,e,s)}return s}function x2(t,e,r){t.flags|=16384,t={getSnapshot:e,value:r},e=Ot.updateQueue,e===null?(e={lastEffect:null,stores:null},Ot.updateQueue=e,e.stores=[t]):(r=e.stores,r===null?e.stores=[t]:r.push(t))}function _2(t,e,r,n){e.value=r,e.getSnapshot=n,w2(e)&&E2(t)}function y2(t,e,r){return r(function(){w2(e)&&E2(t)})}function w2(t){var e=t.getSnapshot;t=t.value;try{var r=e();return!cs(t,r)}catch{return!0}}function E2(t){var e=oa(t,1);e!==null&&is(e,t,1,-1)}function b1(t){var e=xs();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Wc,lastRenderedState:t},e.queue=t,t=t.dispatch=H4.bind(null,Ot,t),[e.memoizedState,t]}function Hc(t,e,r,n){return t={tag:t,create:e,destroy:r,deps:n,next:null},e=Ot.updateQueue,e===null?(e={lastEffect:null,stores:null},Ot.updateQueue=e,e.lastEffect=t.next=t):(r=e.lastEffect,r===null?e.lastEffect=t.next=t:(n=r.next,r.next=t,t.next=n,e.lastEffect=t)),t}function T2(){return zn().memoizedState}function Bf(t,e,r,n){var s=xs();Ot.flags|=t,s.memoizedState=Hc(1|e,r,void 0,n===void 0?null:n)}function pd(t,e,r,n){var s=zn();n=n===void 0?null:n;var a=void 0;if(rr!==null){var i=rr.memoizedState;if(a=i.destroy,n!==null&&_g(n,i.deps)){s.memoizedState=Hc(e,r,a,n);return}}Ot.flags|=t,s.memoizedState=Hc(1|e,r,a,n)}function D1(t,e){return Bf(8390656,8,t,e)}function Eg(t,e){return pd(2048,8,t,e)}function k2(t,e){return pd(4,2,t,e)}function S2(t,e){return pd(4,4,t,e)}function A2(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function I2(t,e,r){return r=r!=null?r.concat([t]):null,pd(4,4,A2.bind(null,e,t),r)}function Tg(){}function C2(t,e){var r=zn();e=e===void 0?null:e;var n=r.memoizedState;return n!==null&&e!==null&&_g(e,n[1])?n[0]:(r.memoizedState=[t,e],t)}function R2(t,e){var r=zn();e=e===void 0?null:e;var n=r.memoizedState;return n!==null&&e!==null&&_g(e,n[1])?n[0]:(t=t(),r.memoizedState=[t,e],t)}function N2(t,e,r){return Ui&21?(cs(r,e)||(r=OE(),Ot.lanes|=r,Bi|=r,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,cn=!0),t.memoizedState=r)}function $4(t,e){var r=pt;pt=r!==0&&4>r?r:4,t(!0);var n=A0.transition;A0.transition={};try{t(!1),e()}finally{pt=r,A0.transition=n}}function P2(){return zn().memoizedState}function W4(t,e,r){var n=qa(t);if(r={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null},b2(t))D2(e,r);else if(r=d2(t,e,r,n),r!==null){var s=Xr();is(r,t,n,s),F2(r,e,n)}}function H4(t,e,r){var n=qa(t),s={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null};if(b2(t))D2(e,s);else{var a=t.alternate;if(t.lanes===0&&(a===null||a.lanes===0)&&(a=e.lastRenderedReducer,a!==null))try{var i=e.lastRenderedState,o=a(i,r);if(s.hasEagerState=!0,s.eagerState=o,cs(o,i)){var l=e.interleaved;l===null?(s.next=s,mg(e)):(s.next=l.next,l.next=s),e.interleaved=s;return}}catch{}finally{}r=d2(t,e,s,n),r!==null&&(s=Xr(),is(r,t,n,s),F2(r,e,n))}}function b2(t){var e=t.alternate;return t===Ot||e!==null&&e===Ot}function D2(t,e){fc=_h=!0;var r=t.pending;r===null?e.next=e:(e.next=r.next,r.next=e),t.pending=e}function F2(t,e,r){if(r&4194240){var n=e.lanes;n&=t.pendingLanes,r|=n,e.lanes=r,eg(t,r)}}var yh={readContext:Bn,useCallback:Rr,useContext:Rr,useEffect:Rr,useImperativeHandle:Rr,useInsertionEffect:Rr,useLayoutEffect:Rr,useMemo:Rr,useReducer:Rr,useRef:Rr,useState:Rr,useDebugValue:Rr,useDeferredValue:Rr,useTransition:Rr,useMutableSource:Rr,useSyncExternalStore:Rr,useId:Rr,unstable_isNewReconciler:!1},G4={readContext:Bn,useCallback:function(t,e){return xs().memoizedState=[t,e===void 0?null:e],t},useContext:Bn,useEffect:D1,useImperativeHandle:function(t,e,r){return r=r!=null?r.concat([t]):null,Bf(4194308,4,A2.bind(null,e,t),r)},useLayoutEffect:function(t,e){return Bf(4194308,4,t,e)},useInsertionEffect:function(t,e){return Bf(4,2,t,e)},useMemo:function(t,e){var r=xs();return e=e===void 0?null:e,t=t(),r.memoizedState=[t,e],t},useReducer:function(t,e,r){var n=xs();return e=r!==void 0?r(e):e,n.memoizedState=n.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},n.queue=t,t=t.dispatch=W4.bind(null,Ot,t),[n.memoizedState,t]},useRef:function(t){var e=xs();return t={current:t},e.memoizedState=t},useState:b1,useDebugValue:Tg,useDeferredValue:function(t){return xs().memoizedState=t},useTransition:function(){var t=b1(!1),e=t[0];return t=$4.bind(null,t[1]),xs().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,r){var n=Ot,s=xs();if(bt){if(r===void 0)throw Error(ye(407));r=r()}else{if(r=e(),hr===null)throw Error(ye(349));Ui&30||x2(n,e,r)}s.memoizedState=r;var a={value:r,getSnapshot:e};return s.queue=a,D1(y2.bind(null,n,a,t),[t]),n.flags|=2048,Hc(9,_2.bind(null,n,a,r,e),void 0,null),r},useId:function(){var t=xs(),e=hr.identifierPrefix;if(bt){var r=Ks,n=Gs;r=(n&~(1<<32-as(n)-1)).toString(32)+r,e=":"+e+"R"+r,r=$c++,0<r&&(e+="H"+r.toString(32)),e+=":"}else r=z4++,e=":"+e+"r"+r.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},K4={readContext:Bn,useCallback:C2,useContext:Bn,useEffect:Eg,useImperativeHandle:I2,useInsertionEffect:k2,useLayoutEffect:S2,useMemo:R2,useReducer:I0,useRef:T2,useState:function(){return I0(Wc)},useDebugValue:Tg,useDeferredValue:function(t){var e=zn();return N2(e,rr.memoizedState,t)},useTransition:function(){var t=I0(Wc)[0],e=zn().memoizedState;return[t,e]},useMutableSource:g2,useSyncExternalStore:v2,useId:P2,unstable_isNewReconciler:!1},q4={readContext:Bn,useCallback:C2,useContext:Bn,useEffect:Eg,useImperativeHandle:I2,useInsertionEffect:k2,useLayoutEffect:S2,useMemo:R2,useReducer:C0,useRef:T2,useState:function(){return C0(Wc)},useDebugValue:Tg,useDeferredValue:function(t){var e=zn();return rr===null?e.memoizedState=t:N2(e,rr.memoizedState,t)},useTransition:function(){var t=C0(Wc)[0],e=zn().memoizedState;return[t,e]},useMutableSource:g2,useSyncExternalStore:v2,useId:P2,unstable_isNewReconciler:!1};function Yn(t,e){if(t&&t.defaultProps){e=Mt({},e),t=t.defaultProps;for(var r in t)e[r]===void 0&&(e[r]=t[r]);return e}return e}function Om(t,e,r,n){e=t.memoizedState,r=r(n,e),r=r==null?e:Mt({},e,r),t.memoizedState=r,t.lanes===0&&(t.updateQueue.baseState=r)}var gd={isMounted:function(t){return(t=t._reactInternals)?Ji(t)===t:!1},enqueueSetState:function(t,e,r){t=t._reactInternals;var n=Xr(),s=qa(t),a=Zs(n,s);a.payload=e,r!=null&&(a.callback=r),e=Ga(t,a,s),e!==null&&(is(e,t,s,n),Vf(e,t,s))},enqueueReplaceState:function(t,e,r){t=t._reactInternals;var n=Xr(),s=qa(t),a=Zs(n,s);a.tag=1,a.payload=e,r!=null&&(a.callback=r),e=Ga(t,a,s),e!==null&&(is(e,t,s,n),Vf(e,t,s))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var r=Xr(),n=qa(t),s=Zs(r,n);s.tag=2,e!=null&&(s.callback=e),e=Ga(t,s,n),e!==null&&(is(e,t,n,r),Vf(e,t,n))}};function F1(t,e,r,n,s,a,i){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(n,a,i):e.prototype&&e.prototype.isPureReactComponent?!Lc(r,n)||!Lc(s,a):!0}function O2(t,e,r){var n=!1,s=ti,a=e.contextType;return typeof a=="object"&&a!==null?a=Bn(a):(s=fn(e)?ji:Br.current,n=e.contextTypes,a=(n=n!=null)?Yo(t,s):ti),e=new e(r,a),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=gd,t.stateNode=e,e._reactInternals=t,n&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=s,t.__reactInternalMemoizedMaskedChildContext=a),e}function O1(t,e,r,n){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(r,n),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(r,n),e.state!==t&&gd.enqueueReplaceState(e,e.state,null)}function Mm(t,e,r,n){var s=t.stateNode;s.props=r,s.state=t.memoizedState,s.refs={},pg(t);var a=e.contextType;typeof a=="object"&&a!==null?s.context=Bn(a):(a=fn(e)?ji:Br.current,s.context=Yo(t,a)),s.state=t.memoizedState,a=e.getDerivedStateFromProps,typeof a=="function"&&(Om(t,e,a,r),s.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof s.getSnapshotBeforeUpdate=="function"||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(e=s.state,typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount(),e!==s.state&&gd.enqueueReplaceState(s,s.state,null),vh(t,r,s,n),s.state=t.memoizedState),typeof s.componentDidMount=="function"&&(t.flags|=4194308)}function el(t,e){try{var r="",n=e;do r+=EC(n),n=n.return;while(n);var s=r}catch(a){s=`
Error generating stack: `+a.message+`
`+a.stack}return{value:t,source:e,stack:s,digest:null}}function R0(t,e,r){return{value:t,source:null,stack:r??null,digest:e??null}}function Lm(t,e){try{console.error(e.value)}catch(r){setTimeout(function(){throw r})}}var X4=typeof WeakMap=="function"?WeakMap:Map;function M2(t,e,r){r=Zs(-1,r),r.tag=3,r.payload={element:null};var n=e.value;return r.callback=function(){Eh||(Eh=!0,Km=n),Lm(t,e)},r}function L2(t,e,r){r=Zs(-1,r),r.tag=3;var n=t.type.getDerivedStateFromError;if(typeof n=="function"){var s=e.value;r.payload=function(){return n(s)},r.callback=function(){Lm(t,e)}}var a=t.stateNode;return a!==null&&typeof a.componentDidCatch=="function"&&(r.callback=function(){Lm(t,e),typeof n!="function"&&(Ka===null?Ka=new Set([this]):Ka.add(this));var i=e.stack;this.componentDidCatch(e.value,{componentStack:i!==null?i:""})}),r}function M1(t,e,r){var n=t.pingCache;if(n===null){n=t.pingCache=new X4;var s=new Set;n.set(e,s)}else s=n.get(e),s===void 0&&(s=new Set,n.set(e,s));s.has(r)||(s.add(r),t=cR.bind(null,t,e,r),e.then(t,t))}function L1(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function j1(t,e,r,n,s){return t.mode&1?(t.flags|=65536,t.lanes=s,t):(t===e?t.flags|=65536:(t.flags|=128,r.flags|=131072,r.flags&=-52805,r.tag===1&&(r.alternate===null?r.tag=17:(e=Zs(-1,1),e.tag=2,Ga(r,e,1))),r.lanes|=1),t)}var Y4=va.ReactCurrentOwner,cn=!1;function Hr(t,e,r,n){e.child=t===null?h2(e,null,r,n):Jo(e,t.child,r,n)}function V1(t,e,r,n,s){r=r.render;var a=e.ref;return Uo(e,s),n=yg(t,e,r,n,a,s),r=wg(),t!==null&&!cn?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,la(t,e,s)):(bt&&r&&lg(e),e.flags|=1,Hr(t,e,n,s),e.child)}function U1(t,e,r,n,s){if(t===null){var a=r.type;return typeof a=="function"&&!Pg(a)&&a.defaultProps===void 0&&r.compare===null&&r.defaultProps===void 0?(e.tag=15,e.type=a,j2(t,e,a,n,s)):(t=Hf(r.type,null,n,e,e.mode,s),t.ref=e.ref,t.return=e,e.child=t)}if(a=t.child,!(t.lanes&s)){var i=a.memoizedProps;if(r=r.compare,r=r!==null?r:Lc,r(i,n)&&t.ref===e.ref)return la(t,e,s)}return e.flags|=1,t=Xa(a,n),t.ref=e.ref,t.return=e,e.child=t}function j2(t,e,r,n,s){if(t!==null){var a=t.memoizedProps;if(Lc(a,n)&&t.ref===e.ref)if(cn=!1,e.pendingProps=n=a,(t.lanes&s)!==0)t.flags&131072&&(cn=!0);else return e.lanes=t.lanes,la(t,e,s)}return jm(t,e,r,n,s)}function V2(t,e,r){var n=e.pendingProps,s=n.children,a=t!==null?t.memoizedState:null;if(n.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},wt(Fo,vn),vn|=r;else{if(!(r&1073741824))return t=a!==null?a.baseLanes|r:r,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,wt(Fo,vn),vn|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=a!==null?a.baseLanes:r,wt(Fo,vn),vn|=n}else a!==null?(n=a.baseLanes|r,e.memoizedState=null):n=r,wt(Fo,vn),vn|=n;return Hr(t,e,s,r),e.child}function U2(t,e){var r=e.ref;(t===null&&r!==null||t!==null&&t.ref!==r)&&(e.flags|=512,e.flags|=2097152)}function jm(t,e,r,n,s){var a=fn(r)?ji:Br.current;return a=Yo(e,a),Uo(e,s),r=yg(t,e,r,n,a,s),n=wg(),t!==null&&!cn?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,la(t,e,s)):(bt&&n&&lg(e),e.flags|=1,Hr(t,e,r,s),e.child)}function B1(t,e,r,n,s){if(fn(r)){var a=!0;hh(e)}else a=!1;if(Uo(e,s),e.stateNode===null)zf(t,e),O2(e,r,n),Mm(e,r,n,s),n=!0;else if(t===null){var i=e.stateNode,o=e.memoizedProps;i.props=o;var l=i.context,c=r.contextType;typeof c=="object"&&c!==null?c=Bn(c):(c=fn(r)?ji:Br.current,c=Yo(e,c));var u=r.getDerivedStateFromProps,h=typeof u=="function"||typeof i.getSnapshotBeforeUpdate=="function";h||typeof i.UNSAFE_componentWillReceiveProps!="function"&&typeof i.componentWillReceiveProps!="function"||(o!==n||l!==c)&&O1(e,i,n,c),Ra=!1;var m=e.memoizedState;i.state=m,vh(e,n,i,s),l=e.memoizedState,o!==n||m!==l||un.current||Ra?(typeof u=="function"&&(Om(e,r,u,n),l=e.memoizedState),(o=Ra||F1(e,r,o,n,m,l,c))?(h||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount()),typeof i.componentDidMount=="function"&&(e.flags|=4194308)):(typeof i.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=n,e.memoizedState=l),i.props=n,i.state=l,i.context=c,n=o):(typeof i.componentDidMount=="function"&&(e.flags|=4194308),n=!1)}else{i=e.stateNode,m2(t,e),o=e.memoizedProps,c=e.type===e.elementType?o:Yn(e.type,o),i.props=c,h=e.pendingProps,m=i.context,l=r.contextType,typeof l=="object"&&l!==null?l=Bn(l):(l=fn(r)?ji:Br.current,l=Yo(e,l));var p=r.getDerivedStateFromProps;(u=typeof p=="function"||typeof i.getSnapshotBeforeUpdate=="function")||typeof i.UNSAFE_componentWillReceiveProps!="function"&&typeof i.componentWillReceiveProps!="function"||(o!==h||m!==l)&&O1(e,i,n,l),Ra=!1,m=e.memoizedState,i.state=m,vh(e,n,i,s);var x=e.memoizedState;o!==h||m!==x||un.current||Ra?(typeof p=="function"&&(Om(e,r,p,n),x=e.memoizedState),(c=Ra||F1(e,r,c,n,m,x,l)||!1)?(u||typeof i.UNSAFE_componentWillUpdate!="function"&&typeof i.componentWillUpdate!="function"||(typeof i.componentWillUpdate=="function"&&i.componentWillUpdate(n,x,l),typeof i.UNSAFE_componentWillUpdate=="function"&&i.UNSAFE_componentWillUpdate(n,x,l)),typeof i.componentDidUpdate=="function"&&(e.flags|=4),typeof i.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof i.componentDidUpdate!="function"||o===t.memoizedProps&&m===t.memoizedState||(e.flags|=4),typeof i.getSnapshotBeforeUpdate!="function"||o===t.memoizedProps&&m===t.memoizedState||(e.flags|=1024),e.memoizedProps=n,e.memoizedState=x),i.props=n,i.state=x,i.context=l,n=c):(typeof i.componentDidUpdate!="function"||o===t.memoizedProps&&m===t.memoizedState||(e.flags|=4),typeof i.getSnapshotBeforeUpdate!="function"||o===t.memoizedProps&&m===t.memoizedState||(e.flags|=1024),n=!1)}return Vm(t,e,r,n,a,s)}function Vm(t,e,r,n,s,a){U2(t,e);var i=(e.flags&128)!==0;if(!n&&!i)return s&&A1(e,r,!1),la(t,e,a);n=e.stateNode,Y4.current=e;var o=i&&typeof r.getDerivedStateFromError!="function"?null:n.render();return e.flags|=1,t!==null&&i?(e.child=Jo(e,t.child,null,a),e.child=Jo(e,null,o,a)):Hr(t,e,o,a),e.memoizedState=n.state,s&&A1(e,r,!0),e.child}function B2(t){var e=t.stateNode;e.pendingContext?S1(t,e.pendingContext,e.pendingContext!==e.context):e.context&&S1(t,e.context,!1),gg(t,e.containerInfo)}function z1(t,e,r,n,s){return Qo(),ug(s),e.flags|=256,Hr(t,e,r,n),e.child}var Um={dehydrated:null,treeContext:null,retryLane:0};function Bm(t){return{baseLanes:t,cachePool:null,transitions:null}}function z2(t,e,r){var n=e.pendingProps,s=Ft.current,a=!1,i=(e.flags&128)!==0,o;if((o=i)||(o=t!==null&&t.memoizedState===null?!1:(s&2)!==0),o?(a=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(s|=1),wt(Ft,s&1),t===null)return Dm(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(i=n.children,t=n.fallback,a?(n=e.mode,a=e.child,i={mode:"hidden",children:i},!(n&1)&&a!==null?(a.childLanes=0,a.pendingProps=i):a=_d(i,n,0,null),t=Di(t,n,r,null),a.return=e,t.return=e,a.sibling=t,e.child=a,e.child.memoizedState=Bm(r),e.memoizedState=Um,t):kg(e,i));if(s=t.memoizedState,s!==null&&(o=s.dehydrated,o!==null))return Q4(t,e,i,n,o,s,r);if(a){a=n.fallback,i=e.mode,s=t.child,o=s.sibling;var l={mode:"hidden",children:n.children};return!(i&1)&&e.child!==s?(n=e.child,n.childLanes=0,n.pendingProps=l,e.deletions=null):(n=Xa(s,l),n.subtreeFlags=s.subtreeFlags&14680064),o!==null?a=Xa(o,a):(a=Di(a,i,r,null),a.flags|=2),a.return=e,n.return=e,n.sibling=a,e.child=n,n=a,a=e.child,i=t.child.memoizedState,i=i===null?Bm(r):{baseLanes:i.baseLanes|r,cachePool:null,transitions:i.transitions},a.memoizedState=i,a.childLanes=t.childLanes&~r,e.memoizedState=Um,n}return a=t.child,t=a.sibling,n=Xa(a,{mode:"visible",children:n.children}),!(e.mode&1)&&(n.lanes=r),n.return=e,n.sibling=null,t!==null&&(r=e.deletions,r===null?(e.deletions=[t],e.flags|=16):r.push(t)),e.child=n,e.memoizedState=null,n}function kg(t,e){return e=_d({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function mf(t,e,r,n){return n!==null&&ug(n),Jo(e,t.child,null,r),t=kg(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function Q4(t,e,r,n,s,a,i){if(r)return e.flags&256?(e.flags&=-257,n=R0(Error(ye(422))),mf(t,e,i,n)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(a=n.fallback,s=e.mode,n=_d({mode:"visible",children:n.children},s,0,null),a=Di(a,s,i,null),a.flags|=2,n.return=e,a.return=e,n.sibling=a,e.child=n,e.mode&1&&Jo(e,t.child,null,i),e.child.memoizedState=Bm(i),e.memoizedState=Um,a);if(!(e.mode&1))return mf(t,e,i,null);if(s.data==="$!"){if(n=s.nextSibling&&s.nextSibling.dataset,n)var o=n.dgst;return n=o,a=Error(ye(419)),n=R0(a,n,void 0),mf(t,e,i,n)}if(o=(i&t.childLanes)!==0,cn||o){if(n=hr,n!==null){switch(i&-i){case 4:s=2;break;case 16:s=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:s=32;break;case 536870912:s=268435456;break;default:s=0}s=s&(n.suspendedLanes|i)?0:s,s!==0&&s!==a.retryLane&&(a.retryLane=s,oa(t,s),is(n,t,s,-1))}return Ng(),n=R0(Error(ye(421))),mf(t,e,i,n)}return s.data==="$?"?(e.flags|=128,e.child=t.child,e=uR.bind(null,t),s._reactRetry=e,null):(t=a.treeContext,wn=Ha(s.nextSibling),Tn=e,bt=!0,Zn=null,t!==null&&(On[Mn++]=Gs,On[Mn++]=Ks,On[Mn++]=Vi,Gs=t.id,Ks=t.overflow,Vi=e),e=kg(e,n.children),e.flags|=4096,e)}function $1(t,e,r){t.lanes|=e;var n=t.alternate;n!==null&&(n.lanes|=e),Fm(t.return,e,r)}function N0(t,e,r,n,s){var a=t.memoizedState;a===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:n,tail:r,tailMode:s}:(a.isBackwards=e,a.rendering=null,a.renderingStartTime=0,a.last=n,a.tail=r,a.tailMode=s)}function $2(t,e,r){var n=e.pendingProps,s=n.revealOrder,a=n.tail;if(Hr(t,e,n.children,r),n=Ft.current,n&2)n=n&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&$1(t,r,e);else if(t.tag===19)$1(t,r,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}n&=1}if(wt(Ft,n),!(e.mode&1))e.memoizedState=null;else switch(s){case"forwards":for(r=e.child,s=null;r!==null;)t=r.alternate,t!==null&&xh(t)===null&&(s=r),r=r.sibling;r=s,r===null?(s=e.child,e.child=null):(s=r.sibling,r.sibling=null),N0(e,!1,s,r,a);break;case"backwards":for(r=null,s=e.child,e.child=null;s!==null;){if(t=s.alternate,t!==null&&xh(t)===null){e.child=s;break}t=s.sibling,s.sibling=r,r=s,s=t}N0(e,!0,r,null,a);break;case"together":N0(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function zf(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function la(t,e,r){if(t!==null&&(e.dependencies=t.dependencies),Bi|=e.lanes,!(r&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(ye(153));if(e.child!==null){for(t=e.child,r=Xa(t,t.pendingProps),e.child=r,r.return=e;t.sibling!==null;)t=t.sibling,r=r.sibling=Xa(t,t.pendingProps),r.return=e;r.sibling=null}return e.child}function J4(t,e,r){switch(e.tag){case 3:B2(e),Qo();break;case 5:p2(e);break;case 1:fn(e.type)&&hh(e);break;case 4:gg(e,e.stateNode.containerInfo);break;case 10:var n=e.type._context,s=e.memoizedProps.value;wt(ph,n._currentValue),n._currentValue=s;break;case 13:if(n=e.memoizedState,n!==null)return n.dehydrated!==null?(wt(Ft,Ft.current&1),e.flags|=128,null):r&e.child.childLanes?z2(t,e,r):(wt(Ft,Ft.current&1),t=la(t,e,r),t!==null?t.sibling:null);wt(Ft,Ft.current&1);break;case 19:if(n=(r&e.childLanes)!==0,t.flags&128){if(n)return $2(t,e,r);e.flags|=128}if(s=e.memoizedState,s!==null&&(s.rendering=null,s.tail=null,s.lastEffect=null),wt(Ft,Ft.current),n)break;return null;case 22:case 23:return e.lanes=0,V2(t,e,r)}return la(t,e,r)}var W2,zm,H2,G2;W2=function(t,e){for(var r=e.child;r!==null;){if(r.tag===5||r.tag===6)t.appendChild(r.stateNode);else if(r.tag!==4&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===e)break;for(;r.sibling===null;){if(r.return===null||r.return===e)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};zm=function(){};H2=function(t,e,r,n){var s=t.memoizedProps;if(s!==n){t=e.stateNode,Ii(Ts.current);var a=null;switch(r){case"input":s=um(t,s),n=um(t,n),a=[];break;case"select":s=Mt({},s,{value:void 0}),n=Mt({},n,{value:void 0}),a=[];break;case"textarea":s=dm(t,s),n=dm(t,n),a=[];break;default:typeof s.onClick!="function"&&typeof n.onClick=="function"&&(t.onclick=uh)}pm(r,n);var i;r=null;for(c in s)if(!n.hasOwnProperty(c)&&s.hasOwnProperty(c)&&s[c]!=null)if(c==="style"){var o=s[c];for(i in o)o.hasOwnProperty(i)&&(r||(r={}),r[i]="")}else c!=="dangerouslySetInnerHTML"&&c!=="children"&&c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&c!=="autoFocus"&&(Nc.hasOwnProperty(c)?a||(a=[]):(a=a||[]).push(c,null));for(c in n){var l=n[c];if(o=s!=null?s[c]:void 0,n.hasOwnProperty(c)&&l!==o&&(l!=null||o!=null))if(c==="style")if(o){for(i in o)!o.hasOwnProperty(i)||l&&l.hasOwnProperty(i)||(r||(r={}),r[i]="");for(i in l)l.hasOwnProperty(i)&&o[i]!==l[i]&&(r||(r={}),r[i]=l[i])}else r||(a||(a=[]),a.push(c,r)),r=l;else c==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,o=o?o.__html:void 0,l!=null&&o!==l&&(a=a||[]).push(c,l)):c==="children"?typeof l!="string"&&typeof l!="number"||(a=a||[]).push(c,""+l):c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&(Nc.hasOwnProperty(c)?(l!=null&&c==="onScroll"&&It("scroll",t),a||o===l||(a=[])):(a=a||[]).push(c,l))}r&&(a=a||[]).push("style",r);var c=a;(e.updateQueue=c)&&(e.flags|=4)}};G2=function(t,e,r,n){r!==n&&(e.flags|=4)};function Bl(t,e){if(!bt)switch(t.tailMode){case"hidden":e=t.tail;for(var r=null;e!==null;)e.alternate!==null&&(r=e),e=e.sibling;r===null?t.tail=null:r.sibling=null;break;case"collapsed":r=t.tail;for(var n=null;r!==null;)r.alternate!==null&&(n=r),r=r.sibling;n===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:n.sibling=null}}function Nr(t){var e=t.alternate!==null&&t.alternate.child===t.child,r=0,n=0;if(e)for(var s=t.child;s!==null;)r|=s.lanes|s.childLanes,n|=s.subtreeFlags&14680064,n|=s.flags&14680064,s.return=t,s=s.sibling;else for(s=t.child;s!==null;)r|=s.lanes|s.childLanes,n|=s.subtreeFlags,n|=s.flags,s.return=t,s=s.sibling;return t.subtreeFlags|=n,t.childLanes=r,e}function Z4(t,e,r){var n=e.pendingProps;switch(cg(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Nr(e),null;case 1:return fn(e.type)&&fh(),Nr(e),null;case 3:return n=e.stateNode,Zo(),Rt(un),Rt(Br),xg(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(t===null||t.child===null)&&(hf(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,Zn!==null&&(Ym(Zn),Zn=null))),zm(t,e),Nr(e),null;case 5:vg(e);var s=Ii(zc.current);if(r=e.type,t!==null&&e.stateNode!=null)H2(t,e,r,n,s),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!n){if(e.stateNode===null)throw Error(ye(166));return Nr(e),null}if(t=Ii(Ts.current),hf(e)){n=e.stateNode,r=e.type;var a=e.memoizedProps;switch(n[_s]=e,n[Uc]=a,t=(e.mode&1)!==0,r){case"dialog":It("cancel",n),It("close",n);break;case"iframe":case"object":case"embed":It("load",n);break;case"video":case"audio":for(s=0;s<Yl.length;s++)It(Yl[s],n);break;case"source":It("error",n);break;case"img":case"image":case"link":It("error",n),It("load",n);break;case"details":It("toggle",n);break;case"input":Jx(n,a),It("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!a.multiple},It("invalid",n);break;case"textarea":e1(n,a),It("invalid",n)}pm(r,a),s=null;for(var i in a)if(a.hasOwnProperty(i)){var o=a[i];i==="children"?typeof o=="string"?n.textContent!==o&&(a.suppressHydrationWarning!==!0&&ff(n.textContent,o,t),s=["children",o]):typeof o=="number"&&n.textContent!==""+o&&(a.suppressHydrationWarning!==!0&&ff(n.textContent,o,t),s=["children",""+o]):Nc.hasOwnProperty(i)&&o!=null&&i==="onScroll"&&It("scroll",n)}switch(r){case"input":rf(n),Zx(n,a,!0);break;case"textarea":rf(n),t1(n);break;case"select":case"option":break;default:typeof a.onClick=="function"&&(n.onclick=uh)}n=s,e.updateQueue=n,n!==null&&(e.flags|=4)}else{i=s.nodeType===9?s:s.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=yE(r)),t==="http://www.w3.org/1999/xhtml"?r==="script"?(t=i.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof n.is=="string"?t=i.createElement(r,{is:n.is}):(t=i.createElement(r),r==="select"&&(i=t,n.multiple?i.multiple=!0:n.size&&(i.size=n.size))):t=i.createElementNS(t,r),t[_s]=e,t[Uc]=n,W2(t,e,!1,!1),e.stateNode=t;e:{switch(i=gm(r,n),r){case"dialog":It("cancel",t),It("close",t),s=n;break;case"iframe":case"object":case"embed":It("load",t),s=n;break;case"video":case"audio":for(s=0;s<Yl.length;s++)It(Yl[s],t);s=n;break;case"source":It("error",t),s=n;break;case"img":case"image":case"link":It("error",t),It("load",t),s=n;break;case"details":It("toggle",t),s=n;break;case"input":Jx(t,n),s=um(t,n),It("invalid",t);break;case"option":s=n;break;case"select":t._wrapperState={wasMultiple:!!n.multiple},s=Mt({},n,{value:void 0}),It("invalid",t);break;case"textarea":e1(t,n),s=dm(t,n),It("invalid",t);break;default:s=n}pm(r,s),o=s;for(a in o)if(o.hasOwnProperty(a)){var l=o[a];a==="style"?TE(t,l):a==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&wE(t,l)):a==="children"?typeof l=="string"?(r!=="textarea"||l!=="")&&Pc(t,l):typeof l=="number"&&Pc(t,""+l):a!=="suppressContentEditableWarning"&&a!=="suppressHydrationWarning"&&a!=="autoFocus"&&(Nc.hasOwnProperty(a)?l!=null&&a==="onScroll"&&It("scroll",t):l!=null&&qp(t,a,l,i))}switch(r){case"input":rf(t),Zx(t,n,!1);break;case"textarea":rf(t),t1(t);break;case"option":n.value!=null&&t.setAttribute("value",""+ei(n.value));break;case"select":t.multiple=!!n.multiple,a=n.value,a!=null?Mo(t,!!n.multiple,a,!1):n.defaultValue!=null&&Mo(t,!!n.multiple,n.defaultValue,!0);break;default:typeof s.onClick=="function"&&(t.onclick=uh)}switch(r){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}}n&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return Nr(e),null;case 6:if(t&&e.stateNode!=null)G2(t,e,t.memoizedProps,n);else{if(typeof n!="string"&&e.stateNode===null)throw Error(ye(166));if(r=Ii(zc.current),Ii(Ts.current),hf(e)){if(n=e.stateNode,r=e.memoizedProps,n[_s]=e,(a=n.nodeValue!==r)&&(t=Tn,t!==null))switch(t.tag){case 3:ff(n.nodeValue,r,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&ff(n.nodeValue,r,(t.mode&1)!==0)}a&&(e.flags|=4)}else n=(r.nodeType===9?r:r.ownerDocument).createTextNode(n),n[_s]=e,e.stateNode=n}return Nr(e),null;case 13:if(Rt(Ft),n=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(bt&&wn!==null&&e.mode&1&&!(e.flags&128))u2(),Qo(),e.flags|=98560,a=!1;else if(a=hf(e),n!==null&&n.dehydrated!==null){if(t===null){if(!a)throw Error(ye(318));if(a=e.memoizedState,a=a!==null?a.dehydrated:null,!a)throw Error(ye(317));a[_s]=e}else Qo(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;Nr(e),a=!1}else Zn!==null&&(Ym(Zn),Zn=null),a=!0;if(!a)return e.flags&65536?e:null}return e.flags&128?(e.lanes=r,e):(n=n!==null,n!==(t!==null&&t.memoizedState!==null)&&n&&(e.child.flags|=8192,e.mode&1&&(t===null||Ft.current&1?nr===0&&(nr=3):Ng())),e.updateQueue!==null&&(e.flags|=4),Nr(e),null);case 4:return Zo(),zm(t,e),t===null&&jc(e.stateNode.containerInfo),Nr(e),null;case 10:return dg(e.type._context),Nr(e),null;case 17:return fn(e.type)&&fh(),Nr(e),null;case 19:if(Rt(Ft),a=e.memoizedState,a===null)return Nr(e),null;if(n=(e.flags&128)!==0,i=a.rendering,i===null)if(n)Bl(a,!1);else{if(nr!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(i=xh(t),i!==null){for(e.flags|=128,Bl(a,!1),n=i.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),e.subtreeFlags=0,n=r,r=e.child;r!==null;)a=r,t=n,a.flags&=14680066,i=a.alternate,i===null?(a.childLanes=0,a.lanes=t,a.child=null,a.subtreeFlags=0,a.memoizedProps=null,a.memoizedState=null,a.updateQueue=null,a.dependencies=null,a.stateNode=null):(a.childLanes=i.childLanes,a.lanes=i.lanes,a.child=i.child,a.subtreeFlags=0,a.deletions=null,a.memoizedProps=i.memoizedProps,a.memoizedState=i.memoizedState,a.updateQueue=i.updateQueue,a.type=i.type,t=i.dependencies,a.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),r=r.sibling;return wt(Ft,Ft.current&1|2),e.child}t=t.sibling}a.tail!==null&&Wt()>tl&&(e.flags|=128,n=!0,Bl(a,!1),e.lanes=4194304)}else{if(!n)if(t=xh(i),t!==null){if(e.flags|=128,n=!0,r=t.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),Bl(a,!0),a.tail===null&&a.tailMode==="hidden"&&!i.alternate&&!bt)return Nr(e),null}else 2*Wt()-a.renderingStartTime>tl&&r!==1073741824&&(e.flags|=128,n=!0,Bl(a,!1),e.lanes=4194304);a.isBackwards?(i.sibling=e.child,e.child=i):(r=a.last,r!==null?r.sibling=i:e.child=i,a.last=i)}return a.tail!==null?(e=a.tail,a.rendering=e,a.tail=e.sibling,a.renderingStartTime=Wt(),e.sibling=null,r=Ft.current,wt(Ft,n?r&1|2:r&1),e):(Nr(e),null);case 22:case 23:return Rg(),n=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==n&&(e.flags|=8192),n&&e.mode&1?vn&1073741824&&(Nr(e),e.subtreeFlags&6&&(e.flags|=8192)):Nr(e),null;case 24:return null;case 25:return null}throw Error(ye(156,e.tag))}function eR(t,e){switch(cg(e),e.tag){case 1:return fn(e.type)&&fh(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return Zo(),Rt(un),Rt(Br),xg(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return vg(e),null;case 13:if(Rt(Ft),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(ye(340));Qo()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return Rt(Ft),null;case 4:return Zo(),null;case 10:return dg(e.type._context),null;case 22:case 23:return Rg(),null;case 24:return null;default:return null}}var pf=!1,Or=!1,tR=typeof WeakSet=="function"?WeakSet:Set,Re=null;function Do(t,e){var r=t.ref;if(r!==null)if(typeof r=="function")try{r(null)}catch(n){Vt(t,e,n)}else r.current=null}function $m(t,e,r){try{r()}catch(n){Vt(t,e,n)}}var W1=!1;function rR(t,e){if(Am=oh,t=QE(),og(t)){if("selectionStart"in t)var r={start:t.selectionStart,end:t.selectionEnd};else e:{r=(r=t.ownerDocument)&&r.defaultView||window;var n=r.getSelection&&r.getSelection();if(n&&n.rangeCount!==0){r=n.anchorNode;var s=n.anchorOffset,a=n.focusNode;n=n.focusOffset;try{r.nodeType,a.nodeType}catch{r=null;break e}var i=0,o=-1,l=-1,c=0,u=0,h=t,m=null;t:for(;;){for(var p;h!==r||s!==0&&h.nodeType!==3||(o=i+s),h!==a||n!==0&&h.nodeType!==3||(l=i+n),h.nodeType===3&&(i+=h.nodeValue.length),(p=h.firstChild)!==null;)m=h,h=p;for(;;){if(h===t)break t;if(m===r&&++c===s&&(o=i),m===a&&++u===n&&(l=i),(p=h.nextSibling)!==null)break;h=m,m=h.parentNode}h=p}r=o===-1||l===-1?null:{start:o,end:l}}else r=null}r=r||{start:0,end:0}}else r=null;for(Im={focusedElem:t,selectionRange:r},oh=!1,Re=e;Re!==null;)if(e=Re,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,Re=t;else for(;Re!==null;){e=Re;try{var x=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(x!==null){var v=x.memoizedProps,w=x.memoizedState,k=e.stateNode,T=k.getSnapshotBeforeUpdate(e.elementType===e.type?v:Yn(e.type,v),w);k.__reactInternalSnapshotBeforeUpdate=T}break;case 3:var E=e.stateNode.containerInfo;E.nodeType===1?E.textContent="":E.nodeType===9&&E.documentElement&&E.removeChild(E.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(ye(163))}}catch(N){Vt(e,e.return,N)}if(t=e.sibling,t!==null){t.return=e.return,Re=t;break}Re=e.return}return x=W1,W1=!1,x}function hc(t,e,r){var n=e.updateQueue;if(n=n!==null?n.lastEffect:null,n!==null){var s=n=n.next;do{if((s.tag&t)===t){var a=s.destroy;s.destroy=void 0,a!==void 0&&$m(e,r,a)}s=s.next}while(s!==n)}}function vd(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var r=e=e.next;do{if((r.tag&t)===t){var n=r.create;r.destroy=n()}r=r.next}while(r!==e)}}function Wm(t){var e=t.ref;if(e!==null){var r=t.stateNode;switch(t.tag){case 5:t=r;break;default:t=r}typeof e=="function"?e(t):e.current=t}}function K2(t){var e=t.alternate;e!==null&&(t.alternate=null,K2(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[_s],delete e[Uc],delete e[Nm],delete e[j4],delete e[V4])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function q2(t){return t.tag===5||t.tag===3||t.tag===4}function H1(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||q2(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function Hm(t,e,r){var n=t.tag;if(n===5||n===6)t=t.stateNode,e?r.nodeType===8?r.parentNode.insertBefore(t,e):r.insertBefore(t,e):(r.nodeType===8?(e=r.parentNode,e.insertBefore(t,r)):(e=r,e.appendChild(t)),r=r._reactRootContainer,r!=null||e.onclick!==null||(e.onclick=uh));else if(n!==4&&(t=t.child,t!==null))for(Hm(t,e,r),t=t.sibling;t!==null;)Hm(t,e,r),t=t.sibling}function Gm(t,e,r){var n=t.tag;if(n===5||n===6)t=t.stateNode,e?r.insertBefore(t,e):r.appendChild(t);else if(n!==4&&(t=t.child,t!==null))for(Gm(t,e,r),t=t.sibling;t!==null;)Gm(t,e,r),t=t.sibling}var gr=null,Qn=!1;function ka(t,e,r){for(r=r.child;r!==null;)X2(t,e,r),r=r.sibling}function X2(t,e,r){if(Es&&typeof Es.onCommitFiberUnmount=="function")try{Es.onCommitFiberUnmount(cd,r)}catch{}switch(r.tag){case 5:Or||Do(r,e);case 6:var n=gr,s=Qn;gr=null,ka(t,e,r),gr=n,Qn=s,gr!==null&&(Qn?(t=gr,r=r.stateNode,t.nodeType===8?t.parentNode.removeChild(r):t.removeChild(r)):gr.removeChild(r.stateNode));break;case 18:gr!==null&&(Qn?(t=gr,r=r.stateNode,t.nodeType===8?T0(t.parentNode,r):t.nodeType===1&&T0(t,r),Oc(t)):T0(gr,r.stateNode));break;case 4:n=gr,s=Qn,gr=r.stateNode.containerInfo,Qn=!0,ka(t,e,r),gr=n,Qn=s;break;case 0:case 11:case 14:case 15:if(!Or&&(n=r.updateQueue,n!==null&&(n=n.lastEffect,n!==null))){s=n=n.next;do{var a=s,i=a.destroy;a=a.tag,i!==void 0&&(a&2||a&4)&&$m(r,e,i),s=s.next}while(s!==n)}ka(t,e,r);break;case 1:if(!Or&&(Do(r,e),n=r.stateNode,typeof n.componentWillUnmount=="function"))try{n.props=r.memoizedProps,n.state=r.memoizedState,n.componentWillUnmount()}catch(o){Vt(r,e,o)}ka(t,e,r);break;case 21:ka(t,e,r);break;case 22:r.mode&1?(Or=(n=Or)||r.memoizedState!==null,ka(t,e,r),Or=n):ka(t,e,r);break;default:ka(t,e,r)}}function G1(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var r=t.stateNode;r===null&&(r=t.stateNode=new tR),e.forEach(function(n){var s=fR.bind(null,t,n);r.has(n)||(r.add(n),n.then(s,s))})}}function Kn(t,e){var r=e.deletions;if(r!==null)for(var n=0;n<r.length;n++){var s=r[n];try{var a=t,i=e,o=i;e:for(;o!==null;){switch(o.tag){case 5:gr=o.stateNode,Qn=!1;break e;case 3:gr=o.stateNode.containerInfo,Qn=!0;break e;case 4:gr=o.stateNode.containerInfo,Qn=!0;break e}o=o.return}if(gr===null)throw Error(ye(160));X2(a,i,s),gr=null,Qn=!1;var l=s.alternate;l!==null&&(l.return=null),s.return=null}catch(c){Vt(s,e,c)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)Y2(e,t),e=e.sibling}function Y2(t,e){var r=t.alternate,n=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(Kn(e,t),ps(t),n&4){try{hc(3,t,t.return),vd(3,t)}catch(v){Vt(t,t.return,v)}try{hc(5,t,t.return)}catch(v){Vt(t,t.return,v)}}break;case 1:Kn(e,t),ps(t),n&512&&r!==null&&Do(r,r.return);break;case 5:if(Kn(e,t),ps(t),n&512&&r!==null&&Do(r,r.return),t.flags&32){var s=t.stateNode;try{Pc(s,"")}catch(v){Vt(t,t.return,v)}}if(n&4&&(s=t.stateNode,s!=null)){var a=t.memoizedProps,i=r!==null?r.memoizedProps:a,o=t.type,l=t.updateQueue;if(t.updateQueue=null,l!==null)try{o==="input"&&a.type==="radio"&&a.name!=null&&xE(s,a),gm(o,i);var c=gm(o,a);for(i=0;i<l.length;i+=2){var u=l[i],h=l[i+1];u==="style"?TE(s,h):u==="dangerouslySetInnerHTML"?wE(s,h):u==="children"?Pc(s,h):qp(s,u,h,c)}switch(o){case"input":fm(s,a);break;case"textarea":_E(s,a);break;case"select":var m=s._wrapperState.wasMultiple;s._wrapperState.wasMultiple=!!a.multiple;var p=a.value;p!=null?Mo(s,!!a.multiple,p,!1):m!==!!a.multiple&&(a.defaultValue!=null?Mo(s,!!a.multiple,a.defaultValue,!0):Mo(s,!!a.multiple,a.multiple?[]:"",!1))}s[Uc]=a}catch(v){Vt(t,t.return,v)}}break;case 6:if(Kn(e,t),ps(t),n&4){if(t.stateNode===null)throw Error(ye(162));s=t.stateNode,a=t.memoizedProps;try{s.nodeValue=a}catch(v){Vt(t,t.return,v)}}break;case 3:if(Kn(e,t),ps(t),n&4&&r!==null&&r.memoizedState.isDehydrated)try{Oc(e.containerInfo)}catch(v){Vt(t,t.return,v)}break;case 4:Kn(e,t),ps(t);break;case 13:Kn(e,t),ps(t),s=t.child,s.flags&8192&&(a=s.memoizedState!==null,s.stateNode.isHidden=a,!a||s.alternate!==null&&s.alternate.memoizedState!==null||(Ig=Wt())),n&4&&G1(t);break;case 22:if(u=r!==null&&r.memoizedState!==null,t.mode&1?(Or=(c=Or)||u,Kn(e,t),Or=c):Kn(e,t),ps(t),n&8192){if(c=t.memoizedState!==null,(t.stateNode.isHidden=c)&&!u&&t.mode&1)for(Re=t,u=t.child;u!==null;){for(h=Re=u;Re!==null;){switch(m=Re,p=m.child,m.tag){case 0:case 11:case 14:case 15:hc(4,m,m.return);break;case 1:Do(m,m.return);var x=m.stateNode;if(typeof x.componentWillUnmount=="function"){n=m,r=m.return;try{e=n,x.props=e.memoizedProps,x.state=e.memoizedState,x.componentWillUnmount()}catch(v){Vt(n,r,v)}}break;case 5:Do(m,m.return);break;case 22:if(m.memoizedState!==null){q1(h);continue}}p!==null?(p.return=m,Re=p):q1(h)}u=u.sibling}e:for(u=null,h=t;;){if(h.tag===5){if(u===null){u=h;try{s=h.stateNode,c?(a=s.style,typeof a.setProperty=="function"?a.setProperty("display","none","important"):a.display="none"):(o=h.stateNode,l=h.memoizedProps.style,i=l!=null&&l.hasOwnProperty("display")?l.display:null,o.style.display=EE("display",i))}catch(v){Vt(t,t.return,v)}}}else if(h.tag===6){if(u===null)try{h.stateNode.nodeValue=c?"":h.memoizedProps}catch(v){Vt(t,t.return,v)}}else if((h.tag!==22&&h.tag!==23||h.memoizedState===null||h===t)&&h.child!==null){h.child.return=h,h=h.child;continue}if(h===t)break e;for(;h.sibling===null;){if(h.return===null||h.return===t)break e;u===h&&(u=null),h=h.return}u===h&&(u=null),h.sibling.return=h.return,h=h.sibling}}break;case 19:Kn(e,t),ps(t),n&4&&G1(t);break;case 21:break;default:Kn(e,t),ps(t)}}function ps(t){var e=t.flags;if(e&2){try{e:{for(var r=t.return;r!==null;){if(q2(r)){var n=r;break e}r=r.return}throw Error(ye(160))}switch(n.tag){case 5:var s=n.stateNode;n.flags&32&&(Pc(s,""),n.flags&=-33);var a=H1(t);Gm(t,a,s);break;case 3:case 4:var i=n.stateNode.containerInfo,o=H1(t);Hm(t,o,i);break;default:throw Error(ye(161))}}catch(l){Vt(t,t.return,l)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function nR(t,e,r){Re=t,Q2(t)}function Q2(t,e,r){for(var n=(t.mode&1)!==0;Re!==null;){var s=Re,a=s.child;if(s.tag===22&&n){var i=s.memoizedState!==null||pf;if(!i){var o=s.alternate,l=o!==null&&o.memoizedState!==null||Or;o=pf;var c=Or;if(pf=i,(Or=l)&&!c)for(Re=s;Re!==null;)i=Re,l=i.child,i.tag===22&&i.memoizedState!==null?X1(s):l!==null?(l.return=i,Re=l):X1(s);for(;a!==null;)Re=a,Q2(a),a=a.sibling;Re=s,pf=o,Or=c}K1(t)}else s.subtreeFlags&8772&&a!==null?(a.return=s,Re=a):K1(t)}}function K1(t){for(;Re!==null;){var e=Re;if(e.flags&8772){var r=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:Or||vd(5,e);break;case 1:var n=e.stateNode;if(e.flags&4&&!Or)if(r===null)n.componentDidMount();else{var s=e.elementType===e.type?r.memoizedProps:Yn(e.type,r.memoizedProps);n.componentDidUpdate(s,r.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var a=e.updateQueue;a!==null&&P1(e,a,n);break;case 3:var i=e.updateQueue;if(i!==null){if(r=null,e.child!==null)switch(e.child.tag){case 5:r=e.child.stateNode;break;case 1:r=e.child.stateNode}P1(e,i,r)}break;case 5:var o=e.stateNode;if(r===null&&e.flags&4){r=o;var l=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&r.focus();break;case"img":l.src&&(r.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var c=e.alternate;if(c!==null){var u=c.memoizedState;if(u!==null){var h=u.dehydrated;h!==null&&Oc(h)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(ye(163))}Or||e.flags&512&&Wm(e)}catch(m){Vt(e,e.return,m)}}if(e===t){Re=null;break}if(r=e.sibling,r!==null){r.return=e.return,Re=r;break}Re=e.return}}function q1(t){for(;Re!==null;){var e=Re;if(e===t){Re=null;break}var r=e.sibling;if(r!==null){r.return=e.return,Re=r;break}Re=e.return}}function X1(t){for(;Re!==null;){var e=Re;try{switch(e.tag){case 0:case 11:case 15:var r=e.return;try{vd(4,e)}catch(l){Vt(e,r,l)}break;case 1:var n=e.stateNode;if(typeof n.componentDidMount=="function"){var s=e.return;try{n.componentDidMount()}catch(l){Vt(e,s,l)}}var a=e.return;try{Wm(e)}catch(l){Vt(e,a,l)}break;case 5:var i=e.return;try{Wm(e)}catch(l){Vt(e,i,l)}}}catch(l){Vt(e,e.return,l)}if(e===t){Re=null;break}var o=e.sibling;if(o!==null){o.return=e.return,Re=o;break}Re=e.return}}var sR=Math.ceil,wh=va.ReactCurrentDispatcher,Sg=va.ReactCurrentOwner,jn=va.ReactCurrentBatchConfig,at=0,hr=null,Jt=null,yr=0,vn=0,Fo=ui(0),nr=0,Gc=null,Bi=0,xd=0,Ag=0,dc=null,on=null,Ig=0,tl=1/0,Ws=null,Eh=!1,Km=null,Ka=null,gf=!1,La=null,Th=0,mc=0,qm=null,$f=-1,Wf=0;function Xr(){return at&6?Wt():$f!==-1?$f:$f=Wt()}function qa(t){return t.mode&1?at&2&&yr!==0?yr&-yr:B4.transition!==null?(Wf===0&&(Wf=OE()),Wf):(t=pt,t!==0||(t=window.event,t=t===void 0?16:zE(t.type)),t):1}function is(t,e,r,n){if(50<mc)throw mc=0,qm=null,Error(ye(185));pu(t,r,n),(!(at&2)||t!==hr)&&(t===hr&&(!(at&2)&&(xd|=r),nr===4&&Pa(t,yr)),hn(t,n),r===1&&at===0&&!(e.mode&1)&&(tl=Wt()+500,md&&fi()))}function hn(t,e){var r=t.callbackNode;BC(t,e);var n=ih(t,t===hr?yr:0);if(n===0)r!==null&&s1(r),t.callbackNode=null,t.callbackPriority=0;else if(e=n&-n,t.callbackPriority!==e){if(r!=null&&s1(r),e===1)t.tag===0?U4(Y1.bind(null,t)):o2(Y1.bind(null,t)),M4(function(){!(at&6)&&fi()}),r=null;else{switch(ME(n)){case 1:r=Zp;break;case 4:r=DE;break;case 16:r=ah;break;case 536870912:r=FE;break;default:r=ah}r=aT(r,J2.bind(null,t))}t.callbackPriority=e,t.callbackNode=r}}function J2(t,e){if($f=-1,Wf=0,at&6)throw Error(ye(327));var r=t.callbackNode;if(Bo()&&t.callbackNode!==r)return null;var n=ih(t,t===hr?yr:0);if(n===0)return null;if(n&30||n&t.expiredLanes||e)e=kh(t,n);else{e=n;var s=at;at|=2;var a=eT();(hr!==t||yr!==e)&&(Ws=null,tl=Wt()+500,bi(t,e));do try{oR();break}catch(o){Z2(t,o)}while(!0);hg(),wh.current=a,at=s,Jt!==null?e=0:(hr=null,yr=0,e=nr)}if(e!==0){if(e===2&&(s=wm(t),s!==0&&(n=s,e=Xm(t,s))),e===1)throw r=Gc,bi(t,0),Pa(t,n),hn(t,Wt()),r;if(e===6)Pa(t,n);else{if(s=t.current.alternate,!(n&30)&&!aR(s)&&(e=kh(t,n),e===2&&(a=wm(t),a!==0&&(n=a,e=Xm(t,a))),e===1))throw r=Gc,bi(t,0),Pa(t,n),hn(t,Wt()),r;switch(t.finishedWork=s,t.finishedLanes=n,e){case 0:case 1:throw Error(ye(345));case 2:yi(t,on,Ws);break;case 3:if(Pa(t,n),(n&130023424)===n&&(e=Ig+500-Wt(),10<e)){if(ih(t,0)!==0)break;if(s=t.suspendedLanes,(s&n)!==n){Xr(),t.pingedLanes|=t.suspendedLanes&s;break}t.timeoutHandle=Rm(yi.bind(null,t,on,Ws),e);break}yi(t,on,Ws);break;case 4:if(Pa(t,n),(n&4194240)===n)break;for(e=t.eventTimes,s=-1;0<n;){var i=31-as(n);a=1<<i,i=e[i],i>s&&(s=i),n&=~a}if(n=s,n=Wt()-n,n=(120>n?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*sR(n/1960))-n,10<n){t.timeoutHandle=Rm(yi.bind(null,t,on,Ws),n);break}yi(t,on,Ws);break;case 5:yi(t,on,Ws);break;default:throw Error(ye(329))}}}return hn(t,Wt()),t.callbackNode===r?J2.bind(null,t):null}function Xm(t,e){var r=dc;return t.current.memoizedState.isDehydrated&&(bi(t,e).flags|=256),t=kh(t,e),t!==2&&(e=on,on=r,e!==null&&Ym(e)),t}function Ym(t){on===null?on=t:on.push.apply(on,t)}function aR(t){for(var e=t;;){if(e.flags&16384){var r=e.updateQueue;if(r!==null&&(r=r.stores,r!==null))for(var n=0;n<r.length;n++){var s=r[n],a=s.getSnapshot;s=s.value;try{if(!cs(a(),s))return!1}catch{return!1}}}if(r=e.child,e.subtreeFlags&16384&&r!==null)r.return=e,e=r;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function Pa(t,e){for(e&=~Ag,e&=~xd,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var r=31-as(e),n=1<<r;t[r]=-1,e&=~n}}function Y1(t){if(at&6)throw Error(ye(327));Bo();var e=ih(t,0);if(!(e&1))return hn(t,Wt()),null;var r=kh(t,e);if(t.tag!==0&&r===2){var n=wm(t);n!==0&&(e=n,r=Xm(t,n))}if(r===1)throw r=Gc,bi(t,0),Pa(t,e),hn(t,Wt()),r;if(r===6)throw Error(ye(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,yi(t,on,Ws),hn(t,Wt()),null}function Cg(t,e){var r=at;at|=1;try{return t(e)}finally{at=r,at===0&&(tl=Wt()+500,md&&fi())}}function zi(t){La!==null&&La.tag===0&&!(at&6)&&Bo();var e=at;at|=1;var r=jn.transition,n=pt;try{if(jn.transition=null,pt=1,t)return t()}finally{pt=n,jn.transition=r,at=e,!(at&6)&&fi()}}function Rg(){vn=Fo.current,Rt(Fo)}function bi(t,e){t.finishedWork=null,t.finishedLanes=0;var r=t.timeoutHandle;if(r!==-1&&(t.timeoutHandle=-1,O4(r)),Jt!==null)for(r=Jt.return;r!==null;){var n=r;switch(cg(n),n.tag){case 1:n=n.type.childContextTypes,n!=null&&fh();break;case 3:Zo(),Rt(un),Rt(Br),xg();break;case 5:vg(n);break;case 4:Zo();break;case 13:Rt(Ft);break;case 19:Rt(Ft);break;case 10:dg(n.type._context);break;case 22:case 23:Rg()}r=r.return}if(hr=t,Jt=t=Xa(t.current,null),yr=vn=e,nr=0,Gc=null,Ag=xd=Bi=0,on=dc=null,Ai!==null){for(e=0;e<Ai.length;e++)if(r=Ai[e],n=r.interleaved,n!==null){r.interleaved=null;var s=n.next,a=r.pending;if(a!==null){var i=a.next;a.next=s,n.next=i}r.pending=n}Ai=null}return t}function Z2(t,e){do{var r=Jt;try{if(hg(),Uf.current=yh,_h){for(var n=Ot.memoizedState;n!==null;){var s=n.queue;s!==null&&(s.pending=null),n=n.next}_h=!1}if(Ui=0,fr=rr=Ot=null,fc=!1,$c=0,Sg.current=null,r===null||r.return===null){nr=1,Gc=e,Jt=null;break}e:{var a=t,i=r.return,o=r,l=e;if(e=yr,o.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var c=l,u=o,h=u.tag;if(!(u.mode&1)&&(h===0||h===11||h===15)){var m=u.alternate;m?(u.updateQueue=m.updateQueue,u.memoizedState=m.memoizedState,u.lanes=m.lanes):(u.updateQueue=null,u.memoizedState=null)}var p=L1(i);if(p!==null){p.flags&=-257,j1(p,i,o,a,e),p.mode&1&&M1(a,c,e),e=p,l=c;var x=e.updateQueue;if(x===null){var v=new Set;v.add(l),e.updateQueue=v}else x.add(l);break e}else{if(!(e&1)){M1(a,c,e),Ng();break e}l=Error(ye(426))}}else if(bt&&o.mode&1){var w=L1(i);if(w!==null){!(w.flags&65536)&&(w.flags|=256),j1(w,i,o,a,e),ug(el(l,o));break e}}a=l=el(l,o),nr!==4&&(nr=2),dc===null?dc=[a]:dc.push(a),a=i;do{switch(a.tag){case 3:a.flags|=65536,e&=-e,a.lanes|=e;var k=M2(a,l,e);N1(a,k);break e;case 1:o=l;var T=a.type,E=a.stateNode;if(!(a.flags&128)&&(typeof T.getDerivedStateFromError=="function"||E!==null&&typeof E.componentDidCatch=="function"&&(Ka===null||!Ka.has(E)))){a.flags|=65536,e&=-e,a.lanes|=e;var N=L2(a,o,e);N1(a,N);break e}}a=a.return}while(a!==null)}rT(r)}catch(O){e=O,Jt===r&&r!==null&&(Jt=r=r.return);continue}break}while(!0)}function eT(){var t=wh.current;return wh.current=yh,t===null?yh:t}function Ng(){(nr===0||nr===3||nr===2)&&(nr=4),hr===null||!(Bi&268435455)&&!(xd&268435455)||Pa(hr,yr)}function kh(t,e){var r=at;at|=2;var n=eT();(hr!==t||yr!==e)&&(Ws=null,bi(t,e));do try{iR();break}catch(s){Z2(t,s)}while(!0);if(hg(),at=r,wh.current=n,Jt!==null)throw Error(ye(261));return hr=null,yr=0,nr}function iR(){for(;Jt!==null;)tT(Jt)}function oR(){for(;Jt!==null&&!bC();)tT(Jt)}function tT(t){var e=sT(t.alternate,t,vn);t.memoizedProps=t.pendingProps,e===null?rT(t):Jt=e,Sg.current=null}function rT(t){var e=t;do{var r=e.alternate;if(t=e.return,e.flags&32768){if(r=eR(r,e),r!==null){r.flags&=32767,Jt=r;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{nr=6,Jt=null;return}}else if(r=Z4(r,e,vn),r!==null){Jt=r;return}if(e=e.sibling,e!==null){Jt=e;return}Jt=e=t}while(e!==null);nr===0&&(nr=5)}function yi(t,e,r){var n=pt,s=jn.transition;try{jn.transition=null,pt=1,lR(t,e,r,n)}finally{jn.transition=s,pt=n}return null}function lR(t,e,r,n){do Bo();while(La!==null);if(at&6)throw Error(ye(327));r=t.finishedWork;var s=t.finishedLanes;if(r===null)return null;if(t.finishedWork=null,t.finishedLanes=0,r===t.current)throw Error(ye(177));t.callbackNode=null,t.callbackPriority=0;var a=r.lanes|r.childLanes;if(zC(t,a),t===hr&&(Jt=hr=null,yr=0),!(r.subtreeFlags&2064)&&!(r.flags&2064)||gf||(gf=!0,aT(ah,function(){return Bo(),null})),a=(r.flags&15990)!==0,r.subtreeFlags&15990||a){a=jn.transition,jn.transition=null;var i=pt;pt=1;var o=at;at|=4,Sg.current=null,rR(t,r),Y2(r,t),C4(Im),oh=!!Am,Im=Am=null,t.current=r,nR(r),DC(),at=o,pt=i,jn.transition=a}else t.current=r;if(gf&&(gf=!1,La=t,Th=s),a=t.pendingLanes,a===0&&(Ka=null),MC(r.stateNode),hn(t,Wt()),e!==null)for(n=t.onRecoverableError,r=0;r<e.length;r++)s=e[r],n(s.value,{componentStack:s.stack,digest:s.digest});if(Eh)throw Eh=!1,t=Km,Km=null,t;return Th&1&&t.tag!==0&&Bo(),a=t.pendingLanes,a&1?t===qm?mc++:(mc=0,qm=t):mc=0,fi(),null}function Bo(){if(La!==null){var t=ME(Th),e=jn.transition,r=pt;try{if(jn.transition=null,pt=16>t?16:t,La===null)var n=!1;else{if(t=La,La=null,Th=0,at&6)throw Error(ye(331));var s=at;for(at|=4,Re=t.current;Re!==null;){var a=Re,i=a.child;if(Re.flags&16){var o=a.deletions;if(o!==null){for(var l=0;l<o.length;l++){var c=o[l];for(Re=c;Re!==null;){var u=Re;switch(u.tag){case 0:case 11:case 15:hc(8,u,a)}var h=u.child;if(h!==null)h.return=u,Re=h;else for(;Re!==null;){u=Re;var m=u.sibling,p=u.return;if(K2(u),u===c){Re=null;break}if(m!==null){m.return=p,Re=m;break}Re=p}}}var x=a.alternate;if(x!==null){var v=x.child;if(v!==null){x.child=null;do{var w=v.sibling;v.sibling=null,v=w}while(v!==null)}}Re=a}}if(a.subtreeFlags&2064&&i!==null)i.return=a,Re=i;else e:for(;Re!==null;){if(a=Re,a.flags&2048)switch(a.tag){case 0:case 11:case 15:hc(9,a,a.return)}var k=a.sibling;if(k!==null){k.return=a.return,Re=k;break e}Re=a.return}}var T=t.current;for(Re=T;Re!==null;){i=Re;var E=i.child;if(i.subtreeFlags&2064&&E!==null)E.return=i,Re=E;else e:for(i=T;Re!==null;){if(o=Re,o.flags&2048)try{switch(o.tag){case 0:case 11:case 15:vd(9,o)}}catch(O){Vt(o,o.return,O)}if(o===i){Re=null;break e}var N=o.sibling;if(N!==null){N.return=o.return,Re=N;break e}Re=o.return}}if(at=s,fi(),Es&&typeof Es.onPostCommitFiberRoot=="function")try{Es.onPostCommitFiberRoot(cd,t)}catch{}n=!0}return n}finally{pt=r,jn.transition=e}}return!1}function Q1(t,e,r){e=el(r,e),e=M2(t,e,1),t=Ga(t,e,1),e=Xr(),t!==null&&(pu(t,1,e),hn(t,e))}function Vt(t,e,r){if(t.tag===3)Q1(t,t,r);else for(;e!==null;){if(e.tag===3){Q1(e,t,r);break}else if(e.tag===1){var n=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof n.componentDidCatch=="function"&&(Ka===null||!Ka.has(n))){t=el(r,t),t=L2(e,t,1),e=Ga(e,t,1),t=Xr(),e!==null&&(pu(e,1,t),hn(e,t));break}}e=e.return}}function cR(t,e,r){var n=t.pingCache;n!==null&&n.delete(e),e=Xr(),t.pingedLanes|=t.suspendedLanes&r,hr===t&&(yr&r)===r&&(nr===4||nr===3&&(yr&130023424)===yr&&500>Wt()-Ig?bi(t,0):Ag|=r),hn(t,e)}function nT(t,e){e===0&&(t.mode&1?(e=af,af<<=1,!(af&130023424)&&(af=4194304)):e=1);var r=Xr();t=oa(t,e),t!==null&&(pu(t,e,r),hn(t,r))}function uR(t){var e=t.memoizedState,r=0;e!==null&&(r=e.retryLane),nT(t,r)}function fR(t,e){var r=0;switch(t.tag){case 13:var n=t.stateNode,s=t.memoizedState;s!==null&&(r=s.retryLane);break;case 19:n=t.stateNode;break;default:throw Error(ye(314))}n!==null&&n.delete(e),nT(t,r)}var sT;sT=function(t,e,r){if(t!==null)if(t.memoizedProps!==e.pendingProps||un.current)cn=!0;else{if(!(t.lanes&r)&&!(e.flags&128))return cn=!1,J4(t,e,r);cn=!!(t.flags&131072)}else cn=!1,bt&&e.flags&1048576&&l2(e,mh,e.index);switch(e.lanes=0,e.tag){case 2:var n=e.type;zf(t,e),t=e.pendingProps;var s=Yo(e,Br.current);Uo(e,r),s=yg(null,e,n,t,s,r);var a=wg();return e.flags|=1,typeof s=="object"&&s!==null&&typeof s.render=="function"&&s.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,fn(n)?(a=!0,hh(e)):a=!1,e.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,pg(e),s.updater=gd,e.stateNode=s,s._reactInternals=e,Mm(e,n,t,r),e=Vm(null,e,n,!0,a,r)):(e.tag=0,bt&&a&&lg(e),Hr(null,e,s,r),e=e.child),e;case 16:n=e.elementType;e:{switch(zf(t,e),t=e.pendingProps,s=n._init,n=s(n._payload),e.type=n,s=e.tag=dR(n),t=Yn(n,t),s){case 0:e=jm(null,e,n,t,r);break e;case 1:e=B1(null,e,n,t,r);break e;case 11:e=V1(null,e,n,t,r);break e;case 14:e=U1(null,e,n,Yn(n.type,t),r);break e}throw Error(ye(306,n,""))}return e;case 0:return n=e.type,s=e.pendingProps,s=e.elementType===n?s:Yn(n,s),jm(t,e,n,s,r);case 1:return n=e.type,s=e.pendingProps,s=e.elementType===n?s:Yn(n,s),B1(t,e,n,s,r);case 3:e:{if(B2(e),t===null)throw Error(ye(387));n=e.pendingProps,a=e.memoizedState,s=a.element,m2(t,e),vh(e,n,null,r);var i=e.memoizedState;if(n=i.element,a.isDehydrated)if(a={element:n,isDehydrated:!1,cache:i.cache,pendingSuspenseBoundaries:i.pendingSuspenseBoundaries,transitions:i.transitions},e.updateQueue.baseState=a,e.memoizedState=a,e.flags&256){s=el(Error(ye(423)),e),e=z1(t,e,n,r,s);break e}else if(n!==s){s=el(Error(ye(424)),e),e=z1(t,e,n,r,s);break e}else for(wn=Ha(e.stateNode.containerInfo.firstChild),Tn=e,bt=!0,Zn=null,r=h2(e,null,n,r),e.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if(Qo(),n===s){e=la(t,e,r);break e}Hr(t,e,n,r)}e=e.child}return e;case 5:return p2(e),t===null&&Dm(e),n=e.type,s=e.pendingProps,a=t!==null?t.memoizedProps:null,i=s.children,Cm(n,s)?i=null:a!==null&&Cm(n,a)&&(e.flags|=32),U2(t,e),Hr(t,e,i,r),e.child;case 6:return t===null&&Dm(e),null;case 13:return z2(t,e,r);case 4:return gg(e,e.stateNode.containerInfo),n=e.pendingProps,t===null?e.child=Jo(e,null,n,r):Hr(t,e,n,r),e.child;case 11:return n=e.type,s=e.pendingProps,s=e.elementType===n?s:Yn(n,s),V1(t,e,n,s,r);case 7:return Hr(t,e,e.pendingProps,r),e.child;case 8:return Hr(t,e,e.pendingProps.children,r),e.child;case 12:return Hr(t,e,e.pendingProps.children,r),e.child;case 10:e:{if(n=e.type._context,s=e.pendingProps,a=e.memoizedProps,i=s.value,wt(ph,n._currentValue),n._currentValue=i,a!==null)if(cs(a.value,i)){if(a.children===s.children&&!un.current){e=la(t,e,r);break e}}else for(a=e.child,a!==null&&(a.return=e);a!==null;){var o=a.dependencies;if(o!==null){i=a.child;for(var l=o.firstContext;l!==null;){if(l.context===n){if(a.tag===1){l=Zs(-1,r&-r),l.tag=2;var c=a.updateQueue;if(c!==null){c=c.shared;var u=c.pending;u===null?l.next=l:(l.next=u.next,u.next=l),c.pending=l}}a.lanes|=r,l=a.alternate,l!==null&&(l.lanes|=r),Fm(a.return,r,e),o.lanes|=r;break}l=l.next}}else if(a.tag===10)i=a.type===e.type?null:a.child;else if(a.tag===18){if(i=a.return,i===null)throw Error(ye(341));i.lanes|=r,o=i.alternate,o!==null&&(o.lanes|=r),Fm(i,r,e),i=a.sibling}else i=a.child;if(i!==null)i.return=a;else for(i=a;i!==null;){if(i===e){i=null;break}if(a=i.sibling,a!==null){a.return=i.return,i=a;break}i=i.return}a=i}Hr(t,e,s.children,r),e=e.child}return e;case 9:return s=e.type,n=e.pendingProps.children,Uo(e,r),s=Bn(s),n=n(s),e.flags|=1,Hr(t,e,n,r),e.child;case 14:return n=e.type,s=Yn(n,e.pendingProps),s=Yn(n.type,s),U1(t,e,n,s,r);case 15:return j2(t,e,e.type,e.pendingProps,r);case 17:return n=e.type,s=e.pendingProps,s=e.elementType===n?s:Yn(n,s),zf(t,e),e.tag=1,fn(n)?(t=!0,hh(e)):t=!1,Uo(e,r),O2(e,n,s),Mm(e,n,s,r),Vm(null,e,n,!0,t,r);case 19:return $2(t,e,r);case 22:return V2(t,e,r)}throw Error(ye(156,e.tag))};function aT(t,e){return bE(t,e)}function hR(t,e,r,n){this.tag=t,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Ln(t,e,r,n){return new hR(t,e,r,n)}function Pg(t){return t=t.prototype,!(!t||!t.isReactComponent)}function dR(t){if(typeof t=="function")return Pg(t)?1:0;if(t!=null){if(t=t.$$typeof,t===Yp)return 11;if(t===Qp)return 14}return 2}function Xa(t,e){var r=t.alternate;return r===null?(r=Ln(t.tag,e,t.key,t.mode),r.elementType=t.elementType,r.type=t.type,r.stateNode=t.stateNode,r.alternate=t,t.alternate=r):(r.pendingProps=e,r.type=t.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=t.flags&14680064,r.childLanes=t.childLanes,r.lanes=t.lanes,r.child=t.child,r.memoizedProps=t.memoizedProps,r.memoizedState=t.memoizedState,r.updateQueue=t.updateQueue,e=t.dependencies,r.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},r.sibling=t.sibling,r.index=t.index,r.ref=t.ref,r}function Hf(t,e,r,n,s,a){var i=2;if(n=t,typeof t=="function")Pg(t)&&(i=1);else if(typeof t=="string")i=5;else e:switch(t){case ko:return Di(r.children,s,a,e);case Xp:i=8,s|=8;break;case im:return t=Ln(12,r,e,s|2),t.elementType=im,t.lanes=a,t;case om:return t=Ln(13,r,e,s),t.elementType=om,t.lanes=a,t;case lm:return t=Ln(19,r,e,s),t.elementType=lm,t.lanes=a,t;case pE:return _d(r,s,a,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case dE:i=10;break e;case mE:i=9;break e;case Yp:i=11;break e;case Qp:i=14;break e;case Ca:i=16,n=null;break e}throw Error(ye(130,t==null?t:typeof t,""))}return e=Ln(i,r,e,s),e.elementType=t,e.type=n,e.lanes=a,e}function Di(t,e,r,n){return t=Ln(7,t,n,e),t.lanes=r,t}function _d(t,e,r,n){return t=Ln(22,t,n,e),t.elementType=pE,t.lanes=r,t.stateNode={isHidden:!1},t}function P0(t,e,r){return t=Ln(6,t,null,e),t.lanes=r,t}function b0(t,e,r){return e=Ln(4,t.children!==null?t.children:[],t.key,e),e.lanes=r,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function mR(t,e,r,n,s){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=h0(0),this.expirationTimes=h0(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=h0(0),this.identifierPrefix=n,this.onRecoverableError=s,this.mutableSourceEagerHydrationData=null}function bg(t,e,r,n,s,a,i,o,l){return t=new mR(t,e,r,o,l),e===1?(e=1,a===!0&&(e|=8)):e=0,a=Ln(3,null,null,e),t.current=a,a.stateNode=t,a.memoizedState={element:n,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},pg(a),t}function pR(t,e,r){var n=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:To,key:n==null?null:""+n,children:t,containerInfo:e,implementation:r}}function iT(t){if(!t)return ti;t=t._reactInternals;e:{if(Ji(t)!==t||t.tag!==1)throw Error(ye(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(fn(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(ye(171))}if(t.tag===1){var r=t.type;if(fn(r))return i2(t,r,e)}return e}function oT(t,e,r,n,s,a,i,o,l){return t=bg(r,n,!0,t,s,a,i,o,l),t.context=iT(null),r=t.current,n=Xr(),s=qa(r),a=Zs(n,s),a.callback=e??null,Ga(r,a,s),t.current.lanes=s,pu(t,s,n),hn(t,n),t}function yd(t,e,r,n){var s=e.current,a=Xr(),i=qa(s);return r=iT(r),e.context===null?e.context=r:e.pendingContext=r,e=Zs(a,i),e.payload={element:t},n=n===void 0?null:n,n!==null&&(e.callback=n),t=Ga(s,e,i),t!==null&&(is(t,s,i,a),Vf(t,s,i)),i}function Sh(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function J1(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var r=t.retryLane;t.retryLane=r!==0&&r<e?r:e}}function Dg(t,e){J1(t,e),(t=t.alternate)&&J1(t,e)}function gR(){return null}var lT=typeof reportError=="function"?reportError:function(t){console.error(t)};function Fg(t){this._internalRoot=t}wd.prototype.render=Fg.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(ye(409));yd(t,e,null,null)};wd.prototype.unmount=Fg.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;zi(function(){yd(null,t,null,null)}),e[ia]=null}};function wd(t){this._internalRoot=t}wd.prototype.unstable_scheduleHydration=function(t){if(t){var e=VE();t={blockedOn:null,target:t,priority:e};for(var r=0;r<Na.length&&e!==0&&e<Na[r].priority;r++);Na.splice(r,0,t),r===0&&BE(t)}};function Og(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function Ed(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function Z1(){}function vR(t,e,r,n,s){if(s){if(typeof n=="function"){var a=n;n=function(){var c=Sh(i);a.call(c)}}var i=oT(e,n,t,0,null,!1,!1,"",Z1);return t._reactRootContainer=i,t[ia]=i.current,jc(t.nodeType===8?t.parentNode:t),zi(),i}for(;s=t.lastChild;)t.removeChild(s);if(typeof n=="function"){var o=n;n=function(){var c=Sh(l);o.call(c)}}var l=bg(t,0,!1,null,null,!1,!1,"",Z1);return t._reactRootContainer=l,t[ia]=l.current,jc(t.nodeType===8?t.parentNode:t),zi(function(){yd(e,l,r,n)}),l}function Td(t,e,r,n,s){var a=r._reactRootContainer;if(a){var i=a;if(typeof s=="function"){var o=s;s=function(){var l=Sh(i);o.call(l)}}yd(e,i,t,s)}else i=vR(r,e,t,s,n);return Sh(i)}LE=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var r=Xl(e.pendingLanes);r!==0&&(eg(e,r|1),hn(e,Wt()),!(at&6)&&(tl=Wt()+500,fi()))}break;case 13:zi(function(){var n=oa(t,1);if(n!==null){var s=Xr();is(n,t,1,s)}}),Dg(t,1)}};tg=function(t){if(t.tag===13){var e=oa(t,134217728);if(e!==null){var r=Xr();is(e,t,134217728,r)}Dg(t,134217728)}};jE=function(t){if(t.tag===13){var e=qa(t),r=oa(t,e);if(r!==null){var n=Xr();is(r,t,e,n)}Dg(t,e)}};VE=function(){return pt};UE=function(t,e){var r=pt;try{return pt=t,e()}finally{pt=r}};xm=function(t,e,r){switch(e){case"input":if(fm(t,r),e=r.name,r.type==="radio"&&e!=null){for(r=t;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<r.length;e++){var n=r[e];if(n!==t&&n.form===t.form){var s=dd(n);if(!s)throw Error(ye(90));vE(n),fm(n,s)}}}break;case"textarea":_E(t,r);break;case"select":e=r.value,e!=null&&Mo(t,!!r.multiple,e,!1)}};AE=Cg;IE=zi;var xR={usingClientEntryPoint:!1,Events:[vu,Co,dd,kE,SE,Cg]},zl={findFiberByHostInstance:Si,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},_R={bundleType:zl.bundleType,version:zl.version,rendererPackageName:zl.rendererPackageName,rendererConfig:zl.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:va.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=NE(t),t===null?null:t.stateNode},findFiberByHostInstance:zl.findFiberByHostInstance||gR,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var vf=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!vf.isDisabled&&vf.supportsFiber)try{cd=vf.inject(_R),Es=vf}catch{}}In.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=xR;In.createPortal=function(t,e){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Og(e))throw Error(ye(200));return pR(t,e,null,r)};In.createRoot=function(t,e){if(!Og(t))throw Error(ye(299));var r=!1,n="",s=lT;return e!=null&&(e.unstable_strictMode===!0&&(r=!0),e.identifierPrefix!==void 0&&(n=e.identifierPrefix),e.onRecoverableError!==void 0&&(s=e.onRecoverableError)),e=bg(t,1,!1,null,null,r,!1,n,s),t[ia]=e.current,jc(t.nodeType===8?t.parentNode:t),new Fg(e)};In.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(ye(188)):(t=Object.keys(t).join(","),Error(ye(268,t)));return t=NE(e),t=t===null?null:t.stateNode,t};In.flushSync=function(t){return zi(t)};In.hydrate=function(t,e,r){if(!Ed(e))throw Error(ye(200));return Td(null,t,e,!0,r)};In.hydrateRoot=function(t,e,r){if(!Og(t))throw Error(ye(405));var n=r!=null&&r.hydratedSources||null,s=!1,a="",i=lT;if(r!=null&&(r.unstable_strictMode===!0&&(s=!0),r.identifierPrefix!==void 0&&(a=r.identifierPrefix),r.onRecoverableError!==void 0&&(i=r.onRecoverableError)),e=oT(e,null,t,1,r??null,s,!1,a,i),t[ia]=e.current,jc(t),n)for(t=0;t<n.length;t++)r=n[t],s=r._getVersion,s=s(r._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[r,s]:e.mutableSourceEagerHydrationData.push(r,s);return new wd(e)};In.render=function(t,e,r){if(!Ed(e))throw Error(ye(200));return Td(null,t,e,!1,r)};In.unmountComponentAtNode=function(t){if(!Ed(t))throw Error(ye(40));return t._reactRootContainer?(zi(function(){Td(null,null,t,!1,function(){t._reactRootContainer=null,t[ia]=null})}),!0):!1};In.unstable_batchedUpdates=Cg;In.unstable_renderSubtreeIntoContainer=function(t,e,r,n){if(!Ed(r))throw Error(ye(200));if(t==null||t._reactInternals===void 0)throw Error(ye(38));return Td(t,e,r,!1,n)};In.version="18.3.1-next-f1338f8080-20240426";function cT(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(cT)}catch(t){console.error(t)}}cT(),cE.exports=In;var Mg=cE.exports;const yR=Qw(Mg),wR=Yw({__proto__:null,default:yR},[Mg]);var e_=Mg;sm.createRoot=e_.createRoot,sm.hydrateRoot=e_.hydrateRoot;/**
 * @remix-run/router v1.23.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Nt(){return Nt=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},Nt.apply(this,arguments)}var Qt;(function(t){t.Pop="POP",t.Push="PUSH",t.Replace="REPLACE"})(Qt||(Qt={}));const t_="popstate";function ER(t){t===void 0&&(t={});function e(n,s){let{pathname:a,search:i,hash:o}=n.location;return Kc("",{pathname:a,search:i,hash:o},s.state&&s.state.usr||null,s.state&&s.state.key||"default")}function r(n,s){return typeof s=="string"?s:$i(s)}return kR(e,r,null,t)}function Ge(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function rl(t,e){if(!t){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function TR(){return Math.random().toString(36).substr(2,8)}function r_(t,e){return{usr:t.state,key:t.key,idx:e}}function Kc(t,e,r,n){return r===void 0&&(r=null),Nt({pathname:typeof t=="string"?t:t.pathname,search:"",hash:""},typeof e=="string"?hi(e):e,{state:r,key:e&&e.key||n||TR()})}function $i(t){let{pathname:e="/",search:r="",hash:n=""}=t;return r&&r!=="?"&&(e+=r.charAt(0)==="?"?r:"?"+r),n&&n!=="#"&&(e+=n.charAt(0)==="#"?n:"#"+n),e}function hi(t){let e={};if(t){let r=t.indexOf("#");r>=0&&(e.hash=t.substr(r),t=t.substr(0,r));let n=t.indexOf("?");n>=0&&(e.search=t.substr(n),t=t.substr(0,n)),t&&(e.pathname=t)}return e}function kR(t,e,r,n){n===void 0&&(n={});let{window:s=document.defaultView,v5Compat:a=!1}=n,i=s.history,o=Qt.Pop,l=null,c=u();c==null&&(c=0,i.replaceState(Nt({},i.state,{idx:c}),""));function u(){return(i.state||{idx:null}).idx}function h(){o=Qt.Pop;let w=u(),k=w==null?null:w-c;c=w,l&&l({action:o,location:v.location,delta:k})}function m(w,k){o=Qt.Push;let T=Kc(v.location,w,k);c=u()+1;let E=r_(T,c),N=v.createHref(T);try{i.pushState(E,"",N)}catch(O){if(O instanceof DOMException&&O.name==="DataCloneError")throw O;s.location.assign(N)}a&&l&&l({action:o,location:v.location,delta:1})}function p(w,k){o=Qt.Replace;let T=Kc(v.location,w,k);c=u();let E=r_(T,c),N=v.createHref(T);i.replaceState(E,"",N),a&&l&&l({action:o,location:v.location,delta:0})}function x(w){let k=s.location.origin!=="null"?s.location.origin:s.location.href,T=typeof w=="string"?w:$i(w);return T=T.replace(/ $/,"%20"),Ge(k,"No window.location.(origin|href) available to create URL for href: "+T),new URL(T,k)}let v={get action(){return o},get location(){return t(s,i)},listen(w){if(l)throw new Error("A history only accepts one active listener");return s.addEventListener(t_,h),l=w,()=>{s.removeEventListener(t_,h),l=null}},createHref(w){return e(s,w)},createURL:x,encodeLocation(w){let k=x(w);return{pathname:k.pathname,search:k.search,hash:k.hash}},push:m,replace:p,go(w){return i.go(w)}};return v}var mt;(function(t){t.data="data",t.deferred="deferred",t.redirect="redirect",t.error="error"})(mt||(mt={}));const SR=new Set(["lazy","caseSensitive","path","id","index","children"]);function AR(t){return t.index===!0}function Ah(t,e,r,n){return r===void 0&&(r=[]),n===void 0&&(n={}),t.map((s,a)=>{let i=[...r,String(a)],o=typeof s.id=="string"?s.id:i.join("-");if(Ge(s.index!==!0||!s.children,"Cannot specify children on an index route"),Ge(!n[o],'Found a route id collision on id "'+o+`".  Route id's must be globally unique within Data Router usages`),AR(s)){let l=Nt({},s,e(s),{id:o});return n[o]=l,l}else{let l=Nt({},s,e(s),{id:o,children:void 0});return n[o]=l,s.children&&(l.children=Ah(s.children,e,i,n)),l}})}function Ei(t,e,r){return r===void 0&&(r="/"),Gf(t,e,r,!1)}function Gf(t,e,r,n){let s=typeof e=="string"?hi(e):e,a=ca(s.pathname||"/",r);if(a==null)return null;let i=uT(t);CR(i);let o=null;for(let l=0;o==null&&l<i.length;++l){let c=VR(a);o=LR(i[l],c,n)}return o}function IR(t,e){let{route:r,pathname:n,params:s}=t;return{id:r.id,pathname:n,params:s,data:e[r.id],handle:r.handle}}function uT(t,e,r,n){e===void 0&&(e=[]),r===void 0&&(r=[]),n===void 0&&(n="");let s=(a,i,o)=>{let l={relativePath:o===void 0?a.path||"":o,caseSensitive:a.caseSensitive===!0,childrenIndex:i,route:a};l.relativePath.startsWith("/")&&(Ge(l.relativePath.startsWith(n),'Absolute route path "'+l.relativePath+'" nested under path '+('"'+n+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),l.relativePath=l.relativePath.slice(n.length));let c=ea([n,l.relativePath]),u=r.concat(l);a.children&&a.children.length>0&&(Ge(a.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+c+'".')),uT(a.children,e,u,c)),!(a.path==null&&!a.index)&&e.push({path:c,score:OR(c,a.index),routesMeta:u})};return t.forEach((a,i)=>{var o;if(a.path===""||!((o=a.path)!=null&&o.includes("?")))s(a,i);else for(let l of fT(a.path))s(a,i,l)}),e}function fT(t){let e=t.split("/");if(e.length===0)return[];let[r,...n]=e,s=r.endsWith("?"),a=r.replace(/\?$/,"");if(n.length===0)return s?[a,""]:[a];let i=fT(n.join("/")),o=[];return o.push(...i.map(l=>l===""?a:[a,l].join("/"))),s&&o.push(...i),o.map(l=>t.startsWith("/")&&l===""?"/":l)}function CR(t){t.sort((e,r)=>e.score!==r.score?r.score-e.score:MR(e.routesMeta.map(n=>n.childrenIndex),r.routesMeta.map(n=>n.childrenIndex)))}const RR=/^:[\w-]+$/,NR=3,PR=2,bR=1,DR=10,FR=-2,n_=t=>t==="*";function OR(t,e){let r=t.split("/"),n=r.length;return r.some(n_)&&(n+=FR),e&&(n+=PR),r.filter(s=>!n_(s)).reduce((s,a)=>s+(RR.test(a)?NR:a===""?bR:DR),n)}function MR(t,e){return t.length===e.length&&t.slice(0,-1).every((n,s)=>n===e[s])?t[t.length-1]-e[e.length-1]:0}function LR(t,e,r){r===void 0&&(r=!1);let{routesMeta:n}=t,s={},a="/",i=[];for(let o=0;o<n.length;++o){let l=n[o],c=o===n.length-1,u=a==="/"?e:e.slice(a.length)||"/",h=Ih({path:l.relativePath,caseSensitive:l.caseSensitive,end:c},u),m=l.route;if(!h&&c&&r&&!n[n.length-1].route.index&&(h=Ih({path:l.relativePath,caseSensitive:l.caseSensitive,end:!1},u)),!h)return null;Object.assign(s,h.params),i.push({params:s,pathname:ea([a,h.pathname]),pathnameBase:zR(ea([a,h.pathnameBase])),route:m}),h.pathnameBase!=="/"&&(a=ea([a,h.pathnameBase]))}return i}function Ih(t,e){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[r,n]=jR(t.path,t.caseSensitive,t.end),s=e.match(r);if(!s)return null;let a=s[0],i=a.replace(/(.)\/+$/,"$1"),o=s.slice(1);return{params:n.reduce((c,u,h)=>{let{paramName:m,isOptional:p}=u;if(m==="*"){let v=o[h]||"";i=a.slice(0,a.length-v.length).replace(/(.)\/+$/,"$1")}const x=o[h];return p&&!x?c[m]=void 0:c[m]=(x||"").replace(/%2F/g,"/"),c},{}),pathname:a,pathnameBase:i,pattern:t}}function jR(t,e,r){e===void 0&&(e=!1),r===void 0&&(r=!0),rl(t==="*"||!t.endsWith("*")||t.endsWith("/*"),'Route path "'+t+'" will be treated as if it were '+('"'+t.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+t.replace(/\*$/,"/*")+'".'));let n=[],s="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(i,o,l)=>(n.push({paramName:o,isOptional:l!=null}),l?"/?([^\\/]+)?":"/([^\\/]+)"));return t.endsWith("*")?(n.push({paramName:"*"}),s+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):r?s+="\\/*$":t!==""&&t!=="/"&&(s+="(?:(?=\\/|$))"),[new RegExp(s,e?void 0:"i"),n]}function VR(t){try{return t.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return rl(!1,'The URL path "'+t+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+e+").")),t}}function ca(t,e){if(e==="/")return t;if(!t.toLowerCase().startsWith(e.toLowerCase()))return null;let r=e.endsWith("/")?e.length-1:e.length,n=t.charAt(r);return n&&n!=="/"?null:t.slice(r)||"/"}function UR(t,e){e===void 0&&(e="/");let{pathname:r,search:n="",hash:s=""}=typeof t=="string"?hi(t):t;return{pathname:r?r.startsWith("/")?r:BR(r,e):e,search:$R(n),hash:WR(s)}}function BR(t,e){let r=e.replace(/\/+$/,"").split("/");return t.split("/").forEach(s=>{s===".."?r.length>1&&r.pop():s!=="."&&r.push(s)}),r.length>1?r.join("/"):"/"}function D0(t,e,r,n){return"Cannot include a '"+t+"' character in a manually specified "+("`to."+e+"` field ["+JSON.stringify(n)+"].  Please separate it out to the ")+("`to."+r+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function hT(t){return t.filter((e,r)=>r===0||e.route.path&&e.route.path.length>0)}function kd(t,e){let r=hT(t);return e?r.map((n,s)=>s===r.length-1?n.pathname:n.pathnameBase):r.map(n=>n.pathnameBase)}function Sd(t,e,r,n){n===void 0&&(n=!1);let s;typeof t=="string"?s=hi(t):(s=Nt({},t),Ge(!s.pathname||!s.pathname.includes("?"),D0("?","pathname","search",s)),Ge(!s.pathname||!s.pathname.includes("#"),D0("#","pathname","hash",s)),Ge(!s.search||!s.search.includes("#"),D0("#","search","hash",s)));let a=t===""||s.pathname==="",i=a?"/":s.pathname,o;if(i==null)o=r;else{let h=e.length-1;if(!n&&i.startsWith("..")){let m=i.split("/");for(;m[0]==="..";)m.shift(),h-=1;s.pathname=m.join("/")}o=h>=0?e[h]:"/"}let l=UR(s,o),c=i&&i!=="/"&&i.endsWith("/"),u=(a||i===".")&&r.endsWith("/");return!l.pathname.endsWith("/")&&(c||u)&&(l.pathname+="/"),l}const ea=t=>t.join("/").replace(/\/\/+/g,"/"),zR=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),$R=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,WR=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t;class Ch{constructor(e,r,n,s){s===void 0&&(s=!1),this.status=e,this.statusText=r||"",this.internal=s,n instanceof Error?(this.data=n.toString(),this.error=n):this.data=n}}function qc(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}const dT=["post","put","patch","delete"],HR=new Set(dT),GR=["get",...dT],KR=new Set(GR),qR=new Set([301,302,303,307,308]),XR=new Set([307,308]),F0={state:"idle",location:void 0,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0},YR={state:"idle",data:void 0,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0},$l={state:"unblocked",proceed:void 0,reset:void 0,location:void 0},Lg=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,QR=t=>({hasErrorBoundary:!!t.hasErrorBoundary}),mT="remix-router-transitions";function JR(t){const e=t.window?t.window:typeof window<"u"?window:void 0,r=typeof e<"u"&&typeof e.document<"u"&&typeof e.document.createElement<"u",n=!r;Ge(t.routes.length>0,"You must provide a non-empty routes array to createRouter");let s;if(t.mapRouteProperties)s=t.mapRouteProperties;else if(t.detectErrorBoundary){let G=t.detectErrorBoundary;s=J=>({hasErrorBoundary:G(J)})}else s=QR;let a={},i=Ah(t.routes,s,void 0,a),o,l=t.basename||"/",c=t.dataStrategy||rN,u=t.patchRoutesOnNavigation,h=Nt({v7_fetcherPersist:!1,v7_normalizeFormMethod:!1,v7_partialHydration:!1,v7_prependBasename:!1,v7_relativeSplatPath:!1,v7_skipActionErrorRevalidation:!1},t.future),m=null,p=new Set,x=null,v=null,w=null,k=t.hydrationData!=null,T=Ei(i,t.history.location,l),E=!1,N=null;if(T==null&&!u){let G=sn(404,{pathname:t.history.location.pathname}),{matches:J,route:se}=m_(i);T=J,N={[se.id]:G}}T&&!t.hydrationData&&Bs(T,i,t.history.location.pathname).active&&(T=null);let O;if(T)if(T.some(G=>G.route.lazy))O=!1;else if(!T.some(G=>G.route.loader))O=!0;else if(h.v7_partialHydration){let G=t.hydrationData?t.hydrationData.loaderData:null,J=t.hydrationData?t.hydrationData.errors:null;if(J){let se=T.findIndex(pe=>J[pe.route.id]!==void 0);O=T.slice(0,se+1).every(pe=>!Jm(pe.route,G,J))}else O=T.every(se=>!Jm(se.route,G,J))}else O=t.hydrationData!=null;else if(O=!1,T=[],h.v7_partialHydration){let G=Bs(null,i,t.history.location.pathname);G.active&&G.matches&&(E=!0,T=G.matches)}let M,g={historyAction:t.history.action,location:t.history.location,matches:T,initialized:O,navigation:F0,restoreScrollPosition:t.hydrationData!=null?!1:null,preventScrollReset:!1,revalidation:"idle",loaderData:t.hydrationData&&t.hydrationData.loaderData||{},actionData:t.hydrationData&&t.hydrationData.actionData||null,errors:t.hydrationData&&t.hydrationData.errors||N,fetchers:new Map,blockers:new Map},y=Qt.Pop,S=!1,R,P=!1,b=new Map,C=null,oe=!1,ae=!1,he=[],me=new Set,ee=new Map,H=0,ue=-1,de=new Map,B=new Set,K=new Map,X=new Map,q=new Set,le=new Map,_e=new Map,Ce;function Te(){if(m=t.history.listen(G=>{let{action:J,location:se,delta:pe}=G;if(Ce){Ce(),Ce=void 0;return}rl(_e.size===0||pe!=null,"You are trying to use a blocker on a POP navigation to a location that was not created by @remix-run/router. This will fail silently in production. This can happen if you are navigating outside the router via `window.history.pushState`/`window.location.hash` instead of using router navigation APIs.  This can also happen if you are using createHashRouter and the user manually changes the URL.");let Se=wa({currentLocation:g.location,nextLocation:se,historyAction:J});if(Se&&pe!=null){let I=new Promise(V=>{Ce=V});t.history.go(pe*-1),hs(Se,{state:"blocked",location:se,proceed(){hs(Se,{state:"proceeding",proceed:void 0,reset:void 0,location:se}),I.then(()=>t.history.go(pe))},reset(){let V=new Map(g.blockers);V.set(Se,$l),z({blockers:V})}});return}return Fe(J,se)}),r){gN(e,b);let G=()=>vN(e,b);e.addEventListener("pagehide",G),C=()=>e.removeEventListener("pagehide",G)}return g.initialized||Fe(Qt.Pop,g.location,{initialHydration:!0}),M}function xe(){m&&m(),C&&C(),p.clear(),R&&R.abort(),g.fetchers.forEach((G,J)=>xt(J)),g.blockers.forEach((G,J)=>js(J))}function $e(G){return p.add(G),()=>p.delete(G)}function z(G,J){J===void 0&&(J={}),g=Nt({},g,G);let se=[],pe=[];h.v7_fetcherPersist&&g.fetchers.forEach((Se,I)=>{Se.state==="idle"&&(q.has(I)?pe.push(I):se.push(I))}),q.forEach(Se=>{!g.fetchers.has(Se)&&!ee.has(Se)&&pe.push(Se)}),[...p].forEach(Se=>Se(g,{deletedFetchers:pe,viewTransitionOpts:J.viewTransitionOpts,flushSync:J.flushSync===!0})),h.v7_fetcherPersist?(se.forEach(Se=>g.fetchers.delete(Se)),pe.forEach(Se=>xt(Se))):pe.forEach(Se=>q.delete(Se))}function ot(G,J,se){var pe,Se;let{flushSync:I}=se===void 0?{}:se,V=g.actionData!=null&&g.navigation.formMethod!=null&&Jn(g.navigation.formMethod)&&g.navigation.state==="loading"&&((pe=G.state)==null?void 0:pe._isRedirect)!==!0,D;J.actionData?Object.keys(J.actionData).length>0?D=J.actionData:D=null:V?D=g.actionData:D=null;let F=J.loaderData?h_(g.loaderData,J.loaderData,J.matches||[],J.errors):g.loaderData,L=g.blockers;L.size>0&&(L=new Map(L),L.forEach((re,te)=>L.set(te,$l)));let j=S===!0||g.navigation.formMethod!=null&&Jn(g.navigation.formMethod)&&((Se=G.state)==null?void 0:Se._isRedirect)!==!0;o&&(i=o,o=void 0),oe||y===Qt.Pop||(y===Qt.Push?t.history.push(G,G.state):y===Qt.Replace&&t.history.replace(G,G.state));let Y;if(y===Qt.Pop){let re=b.get(g.location.pathname);re&&re.has(G.pathname)?Y={currentLocation:g.location,nextLocation:G}:b.has(G.pathname)&&(Y={currentLocation:G,nextLocation:g.location})}else if(P){let re=b.get(g.location.pathname);re?re.add(G.pathname):(re=new Set([G.pathname]),b.set(g.location.pathname,re)),Y={currentLocation:g.location,nextLocation:G}}z(Nt({},J,{actionData:D,loaderData:F,historyAction:y,location:G,initialized:!0,navigation:F0,revalidation:"idle",restoreScrollPosition:Us(G,J.matches||g.matches),preventScrollReset:j,blockers:L}),{viewTransitionOpts:Y,flushSync:I===!0}),y=Qt.Pop,S=!1,P=!1,oe=!1,ae=!1,he=[]}async function He(G,J){if(typeof G=="number"){t.history.go(G);return}let se=Qm(g.location,g.matches,l,h.v7_prependBasename,G,h.v7_relativeSplatPath,J==null?void 0:J.fromRouteId,J==null?void 0:J.relative),{path:pe,submission:Se,error:I}=s_(h.v7_normalizeFormMethod,!1,se,J),V=g.location,D=Kc(g.location,pe,J&&J.state);D=Nt({},D,t.history.encodeLocation(D));let F=J&&J.replace!=null?J.replace:void 0,L=Qt.Push;F===!0?L=Qt.Replace:F===!1||Se!=null&&Jn(Se.formMethod)&&Se.formAction===g.location.pathname+g.location.search&&(L=Qt.Replace);let j=J&&"preventScrollReset"in J?J.preventScrollReset===!0:void 0,Y=(J&&J.flushSync)===!0,re=wa({currentLocation:V,nextLocation:D,historyAction:L});if(re){hs(re,{state:"blocked",location:D,proceed(){hs(re,{state:"proceeding",proceed:void 0,reset:void 0,location:D}),He(G,J)},reset(){let te=new Map(g.blockers);te.set(re,$l),z({blockers:te})}});return}return await Fe(L,D,{submission:Se,pendingError:I,preventScrollReset:j,replace:J&&J.replace,enableViewTransition:J&&J.viewTransition,flushSync:Y})}function nt(){if(St(),z({revalidation:"loading"}),g.navigation.state!=="submitting"){if(g.navigation.state==="idle"){Fe(g.historyAction,g.location,{startUninterruptedRevalidation:!0});return}Fe(y||g.historyAction,g.navigation.location,{overrideNavigation:g.navigation,enableViewTransition:P===!0})}}async function Fe(G,J,se){R&&R.abort(),R=null,y=G,oe=(se&&se.startUninterruptedRevalidation)===!0,uo(g.location,g.matches),S=(se&&se.preventScrollReset)===!0,P=(se&&se.enableViewTransition)===!0;let pe=o||i,Se=se&&se.overrideNavigation,I=se!=null&&se.initialHydration&&g.matches&&g.matches.length>0&&!E?g.matches:Ei(pe,J,l),V=(se&&se.flushSync)===!0;if(I&&g.initialized&&!ae&&lN(g.location,J)&&!(se&&se.submission&&Jn(se.submission.formMethod))){ot(J,{matches:I},{flushSync:V});return}let D=Bs(I,pe,J.pathname);if(D.active&&D.matches&&(I=D.matches),!I){let{error:Z,notFoundMatches:Q,route:ce}=Hn(J.pathname);ot(J,{matches:Q,loaderData:{},errors:{[ce.id]:Z}},{flushSync:V});return}R=new AbortController;let F=vo(t.history,J,R.signal,se&&se.submission),L;if(se&&se.pendingError)L=[Ti(I).route.id,{type:mt.error,error:se.pendingError}];else if(se&&se.submission&&Jn(se.submission.formMethod)){let Z=await Ae(F,J,se.submission,I,D.active,{replace:se.replace,flushSync:V});if(Z.shortCircuited)return;if(Z.pendingActionResult){let[Q,ce]=Z.pendingActionResult;if(xn(ce)&&qc(ce.error)&&ce.error.status===404){R=null,ot(J,{matches:Z.matches,loaderData:{},errors:{[Q]:ce.error}});return}}I=Z.matches||I,L=Z.pendingActionResult,Se=O0(J,se.submission),V=!1,D.active=!1,F=vo(t.history,F.url,F.signal)}let{shortCircuited:j,matches:Y,loaderData:re,errors:te}=await Tt(F,J,I,D.active,Se,se&&se.submission,se&&se.fetcherSubmission,se&&se.replace,se&&se.initialHydration===!0,V,L);j||(R=null,ot(J,Nt({matches:Y||I},d_(L),{loaderData:re,errors:te})))}async function Ae(G,J,se,pe,Se,I){I===void 0&&(I={}),St();let V=mN(J,se);if(z({navigation:V},{flushSync:I.flushSync===!0}),Se){let L=await Nn(pe,J.pathname,G.signal);if(L.type==="aborted")return{shortCircuited:!0};if(L.type==="error"){let j=Ti(L.partialMatches).route.id;return{matches:L.partialMatches,pendingActionResult:[j,{type:mt.error,error:L.error}]}}else if(L.matches)pe=L.matches;else{let{notFoundMatches:j,error:Y,route:re}=Hn(J.pathname);return{matches:j,pendingActionResult:[re.id,{type:mt.error,error:Y}]}}}let D,F=Ql(pe,J);if(!F.route.action&&!F.route.lazy)D={type:mt.error,error:sn(405,{method:G.method,pathname:J.pathname,routeId:F.route.id})};else if(D=(await lr("action",g,G,[F],pe,null))[F.route.id],G.signal.aborted)return{shortCircuited:!0};if(Ci(D)){let L;return I&&I.replace!=null?L=I.replace:L=c_(D.response.headers.get("Location"),new URL(G.url),l)===g.location.pathname+g.location.search,await kt(G,D,!0,{submission:se,replace:L}),{shortCircuited:!0}}if(ja(D))throw sn(400,{type:"defer-action"});if(xn(D)){let L=Ti(pe,F.route.id);return(I&&I.replace)!==!0&&(y=Qt.Push),{matches:pe,pendingActionResult:[L.route.id,D]}}return{matches:pe,pendingActionResult:[F.route.id,D]}}async function Tt(G,J,se,pe,Se,I,V,D,F,L,j){let Y=Se||O0(J,I),re=I||V||g_(Y),te=!oe&&(!h.v7_partialHydration||!F);if(pe){if(te){let ft=or(j);z(Nt({navigation:Y},ft!==void 0?{actionData:ft}:{}),{flushSync:L})}let We=await Nn(se,J.pathname,G.signal);if(We.type==="aborted")return{shortCircuited:!0};if(We.type==="error"){let ft=Ti(We.partialMatches).route.id;return{matches:We.partialMatches,loaderData:{},errors:{[ft]:We.error}}}else if(We.matches)se=We.matches;else{let{error:ft,notFoundMatches:mr,route:Pn}=Hn(J.pathname);return{matches:mr,loaderData:{},errors:{[Pn.id]:ft}}}}let Z=o||i,[Q,ce]=i_(t.history,g,se,re,J,h.v7_partialHydration&&F===!0,h.v7_skipActionErrorRevalidation,ae,he,me,q,K,B,Z,l,j);if(Vs(We=>!(se&&se.some(ft=>ft.route.id===We))||Q&&Q.some(ft=>ft.route.id===We)),ue=++H,Q.length===0&&ce.length===0){let We=Ls();return ot(J,Nt({matches:se,loaderData:{},errors:j&&xn(j[1])?{[j[0]]:j[1].error}:null},d_(j),We?{fetchers:new Map(g.fetchers)}:{}),{flushSync:L}),{shortCircuited:!0}}if(te){let We={};if(!pe){We.navigation=Y;let ft=or(j);ft!==void 0&&(We.actionData=ft)}ce.length>0&&(We.fetchers=Ar(ce)),z(We,{flushSync:L})}ce.forEach(We=>{ut(We.key),We.controller&&ee.set(We.key,We.controller)});let we=()=>ce.forEach(We=>ut(We.key));R&&R.signal.addEventListener("abort",we);let{loaderResults:Ie,fetcherResults:ge}=await vt(g,se,Q,ce,G);if(G.signal.aborted)return{shortCircuited:!0};R&&R.signal.removeEventListener("abort",we),ce.forEach(We=>ee.delete(We.key));let Ee=xf(Ie);if(Ee)return await kt(G,Ee.result,!0,{replace:D}),{shortCircuited:!0};if(Ee=xf(ge),Ee)return B.add(Ee.key),await kt(G,Ee.result,!0,{replace:D}),{shortCircuited:!0};let{loaderData:De,errors:st}=f_(g,se,Ie,j,ce,ge,le);le.forEach((We,ft)=>{We.subscribe(mr=>{(mr||We.done)&&le.delete(ft)})}),h.v7_partialHydration&&F&&g.errors&&(st=Nt({},g.errors,st));let Ke=Ls(),dt=co(ue),nn=Ke||dt||ce.length>0;return Nt({matches:se,loaderData:De,errors:st},nn?{fetchers:new Map(g.fetchers)}:{})}function or(G){if(G&&!xn(G[1]))return{[G[0]]:G[1].data};if(g.actionData)return Object.keys(g.actionData).length===0?null:g.actionData}function Ar(G){return G.forEach(J=>{let se=g.fetchers.get(J.key),pe=Wl(void 0,se?se.data:void 0);g.fetchers.set(J.key,pe)}),new Map(g.fetchers)}function tn(G,J,se,pe){if(n)throw new Error("router.fetch() was called during the server render, but it shouldn't be. You are likely calling a useFetcher() method in the body of your component. Try moving it to a useEffect or a callback.");ut(G);let Se=(pe&&pe.flushSync)===!0,I=o||i,V=Qm(g.location,g.matches,l,h.v7_prependBasename,se,h.v7_relativeSplatPath,J,pe==null?void 0:pe.relative),D=Ei(I,V,l),F=Bs(D,I,V);if(F.active&&F.matches&&(D=F.matches),!D){Dt(G,J,sn(404,{pathname:V}),{flushSync:Se});return}let{path:L,submission:j,error:Y}=s_(h.v7_normalizeFormMethod,!0,V,pe);if(Y){Dt(G,J,Y,{flushSync:Se});return}let re=Ql(D,L),te=(pe&&pe.preventScrollReset)===!0;if(j&&Jn(j.formMethod)){Ms(G,J,L,re,D,F.active,Se,te,j);return}K.set(G,{routeId:J,path:L}),rn(G,J,L,re,D,F.active,Se,te,j)}async function Ms(G,J,se,pe,Se,I,V,D,F){St(),K.delete(G);function L(Je){if(!Je.route.action&&!Je.route.lazy){let ms=sn(405,{method:F.formMethod,pathname:se,routeId:J});return Dt(G,J,ms,{flushSync:V}),!0}return!1}if(!I&&L(pe))return;let j=g.fetchers.get(G);ht(G,pN(F,j),{flushSync:V});let Y=new AbortController,re=vo(t.history,se,Y.signal,F);if(I){let Je=await Nn(Se,new URL(re.url).pathname,re.signal,G);if(Je.type==="aborted")return;if(Je.type==="error"){Dt(G,J,Je.error,{flushSync:V});return}else if(Je.matches){if(Se=Je.matches,pe=Ql(Se,se),L(pe))return}else{Dt(G,J,sn(404,{pathname:se}),{flushSync:V});return}}ee.set(G,Y);let te=H,Q=(await lr("action",g,re,[pe],Se,G))[pe.route.id];if(re.signal.aborted){ee.get(G)===Y&&ee.delete(G);return}if(h.v7_fetcherPersist&&q.has(G)){if(Ci(Q)||xn(Q)){ht(G,Ia(void 0));return}}else{if(Ci(Q))if(ee.delete(G),ue>te){ht(G,Ia(void 0));return}else return B.add(G),ht(G,Wl(F)),kt(re,Q,!1,{fetcherSubmission:F,preventScrollReset:D});if(xn(Q)){Dt(G,J,Q.error);return}}if(ja(Q))throw sn(400,{type:"defer-action"});let ce=g.navigation.location||g.location,we=vo(t.history,ce,Y.signal),Ie=o||i,ge=g.navigation.state!=="idle"?Ei(Ie,g.navigation.location,l):g.matches;Ge(ge,"Didn't find any matches after fetcher action");let Ee=++H;de.set(G,Ee);let De=Wl(F,Q.data);g.fetchers.set(G,De);let[st,Ke]=i_(t.history,g,ge,F,ce,!1,h.v7_skipActionErrorRevalidation,ae,he,me,q,K,B,Ie,l,[pe.route.id,Q]);Ke.filter(Je=>Je.key!==G).forEach(Je=>{let ms=Je.key,Il=g.fetchers.get(ms),zu=Wl(void 0,Il?Il.data:void 0);g.fetchers.set(ms,zu),ut(ms),Je.controller&&ee.set(ms,Je.controller)}),z({fetchers:new Map(g.fetchers)});let dt=()=>Ke.forEach(Je=>ut(Je.key));Y.signal.addEventListener("abort",dt);let{loaderResults:nn,fetcherResults:We}=await vt(g,ge,st,Ke,we);if(Y.signal.aborted)return;Y.signal.removeEventListener("abort",dt),de.delete(G),ee.delete(G),Ke.forEach(Je=>ee.delete(Je.key));let ft=xf(nn);if(ft)return kt(we,ft.result,!1,{preventScrollReset:D});if(ft=xf(We),ft)return B.add(ft.key),kt(we,ft.result,!1,{preventScrollReset:D});let{loaderData:mr,errors:Pn}=f_(g,ge,nn,void 0,Ke,We,le);if(g.fetchers.has(G)){let Je=Ia(Q.data);g.fetchers.set(G,Je)}co(Ee),g.navigation.state==="loading"&&Ee>ue?(Ge(y,"Expected pending action"),R&&R.abort(),ot(g.navigation.location,{matches:ge,loaderData:mr,errors:Pn,fetchers:new Map(g.fetchers)})):(z({errors:Pn,loaderData:h_(g.loaderData,mr,ge,Pn),fetchers:new Map(g.fetchers)}),ae=!1)}async function rn(G,J,se,pe,Se,I,V,D,F){let L=g.fetchers.get(G);ht(G,Wl(F,L?L.data:void 0),{flushSync:V});let j=new AbortController,Y=vo(t.history,se,j.signal);if(I){let Q=await Nn(Se,new URL(Y.url).pathname,Y.signal,G);if(Q.type==="aborted")return;if(Q.type==="error"){Dt(G,J,Q.error,{flushSync:V});return}else if(Q.matches)Se=Q.matches,pe=Ql(Se,se);else{Dt(G,J,sn(404,{pathname:se}),{flushSync:V});return}}ee.set(G,j);let re=H,Z=(await lr("loader",g,Y,[pe],Se,G))[pe.route.id];if(ja(Z)&&(Z=await jg(Z,Y.signal,!0)||Z),ee.get(G)===j&&ee.delete(G),!Y.signal.aborted){if(q.has(G)){ht(G,Ia(void 0));return}if(Ci(Z))if(ue>re){ht(G,Ia(void 0));return}else{B.add(G),await kt(Y,Z,!1,{preventScrollReset:D});return}if(xn(Z)){Dt(G,J,Z.error);return}Ge(!ja(Z),"Unhandled fetcher deferred data"),ht(G,Ia(Z.data))}}async function kt(G,J,se,pe){let{submission:Se,fetcherSubmission:I,preventScrollReset:V,replace:D}=pe===void 0?{}:pe;J.response.headers.has("X-Remix-Revalidate")&&(ae=!0);let F=J.response.headers.get("Location");Ge(F,"Expected a Location header on the redirect Response"),F=c_(F,new URL(G.url),l);let L=Kc(g.location,F,{_isRedirect:!0});if(r){let Q=!1;if(J.response.headers.has("X-Remix-Reload-Document"))Q=!0;else if(Lg.test(F)){const ce=t.history.createURL(F);Q=ce.origin!==e.location.origin||ca(ce.pathname,l)==null}if(Q){D?e.location.replace(F):e.location.assign(F);return}}R=null;let j=D===!0||J.response.headers.has("X-Remix-Replace")?Qt.Replace:Qt.Push,{formMethod:Y,formAction:re,formEncType:te}=g.navigation;!Se&&!I&&Y&&re&&te&&(Se=g_(g.navigation));let Z=Se||I;if(XR.has(J.response.status)&&Z&&Jn(Z.formMethod))await Fe(j,L,{submission:Nt({},Z,{formAction:F}),preventScrollReset:V||S,enableViewTransition:se?P:void 0});else{let Q=O0(L,Se);await Fe(j,L,{overrideNavigation:Q,fetcherSubmission:I,preventScrollReset:V||S,enableViewTransition:se?P:void 0})}}async function lr(G,J,se,pe,Se,I){let V,D={};try{V=await nN(c,G,J,se,pe,Se,I,a,s)}catch(F){return pe.forEach(L=>{D[L.route.id]={type:mt.error,error:F}}),D}for(let[F,L]of Object.entries(V))if(cN(L)){let j=L.result;D[F]={type:mt.redirect,response:iN(j,se,F,Se,l,h.v7_relativeSplatPath)}}else D[F]=await aN(L);return D}async function vt(G,J,se,pe,Se){let I=G.matches,V=lr("loader",G,Se,se,J,null),D=Promise.all(pe.map(async j=>{if(j.matches&&j.match&&j.controller){let re=(await lr("loader",G,vo(t.history,j.path,j.controller.signal),[j.match],j.matches,j.key))[j.match.route.id];return{[j.key]:re}}else return Promise.resolve({[j.key]:{type:mt.error,error:sn(404,{pathname:j.path})}})})),F=await V,L=(await D).reduce((j,Y)=>Object.assign(j,Y),{});return await Promise.all([hN(J,F,Se.signal,I,G.loaderData),dN(J,L,pe)]),{loaderResults:F,fetcherResults:L}}function St(){ae=!0,he.push(...Vs()),K.forEach((G,J)=>{ee.has(J)&&me.add(J),ut(J)})}function ht(G,J,se){se===void 0&&(se={}),g.fetchers.set(G,J),z({fetchers:new Map(g.fetchers)},{flushSync:(se&&se.flushSync)===!0})}function Dt(G,J,se,pe){pe===void 0&&(pe={});let Se=Ti(g.matches,J);xt(G),z({errors:{[Se.route.id]:se},fetchers:new Map(g.fetchers)},{flushSync:(pe&&pe.flushSync)===!0})}function je(G){return X.set(G,(X.get(G)||0)+1),q.has(G)&&q.delete(G),g.fetchers.get(G)||YR}function xt(G){let J=g.fetchers.get(G);ee.has(G)&&!(J&&J.state==="loading"&&de.has(G))&&ut(G),K.delete(G),de.delete(G),B.delete(G),h.v7_fetcherPersist&&q.delete(G),me.delete(G),g.fetchers.delete(G)}function Gt(G){let J=(X.get(G)||0)-1;J<=0?(X.delete(G),q.add(G),h.v7_fetcherPersist||xt(G)):X.set(G,J),z({fetchers:new Map(g.fetchers)})}function ut(G){let J=ee.get(G);J&&(J.abort(),ee.delete(G))}function pn(G){for(let J of G){let se=je(J),pe=Ia(se.data);g.fetchers.set(J,pe)}}function Ls(){let G=[],J=!1;for(let se of B){let pe=g.fetchers.get(se);Ge(pe,"Expected fetcher: "+se),pe.state==="loading"&&(B.delete(se),G.push(se),J=!0)}return pn(G),J}function co(G){let J=[];for(let[se,pe]of de)if(pe<G){let Se=g.fetchers.get(se);Ge(Se,"Expected fetcher: "+se),Se.state==="loading"&&(ut(se),de.delete(se),J.push(se))}return pn(J),J.length>0}function Al(G,J){let se=g.blockers.get(G)||$l;return _e.get(G)!==J&&_e.set(G,J),se}function js(G){g.blockers.delete(G),_e.delete(G)}function hs(G,J){let se=g.blockers.get(G)||$l;Ge(se.state==="unblocked"&&J.state==="blocked"||se.state==="blocked"&&J.state==="blocked"||se.state==="blocked"&&J.state==="proceeding"||se.state==="blocked"&&J.state==="unblocked"||se.state==="proceeding"&&J.state==="unblocked","Invalid blocker state transition: "+se.state+" -> "+J.state);let pe=new Map(g.blockers);pe.set(G,J),z({blockers:pe})}function wa(G){let{currentLocation:J,nextLocation:se,historyAction:pe}=G;if(_e.size===0)return;_e.size>1&&rl(!1,"A router only supports one blocker at a time");let Se=Array.from(_e.entries()),[I,V]=Se[Se.length-1],D=g.blockers.get(I);if(!(D&&D.state==="proceeding")&&V({currentLocation:J,nextLocation:se,historyAction:pe}))return I}function Hn(G){let J=sn(404,{pathname:G}),se=o||i,{matches:pe,route:Se}=m_(se);return Vs(),{notFoundMatches:pe,route:Se,error:J}}function Vs(G){let J=[];return le.forEach((se,pe)=>{(!G||G(pe))&&(se.cancel(),J.push(pe),le.delete(pe))}),J}function ds(G,J,se){if(x=G,w=J,v=se||null,!k&&g.navigation===F0){k=!0;let pe=Us(g.location,g.matches);pe!=null&&z({restoreScrollPosition:pe})}return()=>{x=null,w=null,v=null}}function Rn(G,J){return v&&v(G,J.map(pe=>IR(pe,g.loaderData)))||G.key}function uo(G,J){if(x&&w){let se=Rn(G,J);x[se]=w()}}function Us(G,J){if(x){let se=Rn(G,J),pe=x[se];if(typeof pe=="number")return pe}return null}function Bs(G,J,se){if(u)if(G){if(Object.keys(G[0].params).length>0)return{active:!0,matches:Gf(J,se,l,!0)}}else return{active:!0,matches:Gf(J,se,l,!0)||[]};return{active:!1,matches:null}}async function Nn(G,J,se,pe){if(!u)return{type:"success",matches:G};let Se=G;for(;;){let I=o==null,V=o||i,D=a;try{await u({signal:se,path:J,matches:Se,fetcherKey:pe,patch:(j,Y)=>{se.aborted||l_(j,Y,V,D,s)}})}catch(j){return{type:"error",error:j,partialMatches:Se}}finally{I&&!se.aborted&&(i=[...i])}if(se.aborted)return{type:"aborted"};let F=Ei(V,J,l);if(F)return{type:"success",matches:F};let L=Gf(V,J,l,!0);if(!L||Se.length===L.length&&Se.every((j,Y)=>j.route.id===L[Y].route.id))return{type:"success",matches:null};Se=L}}function fo(G){a={},o=Ah(G,s,void 0,a)}function er(G,J){let se=o==null;l_(G,J,o||i,a,s),se&&(i=[...i],z({}))}return M={get basename(){return l},get future(){return h},get state(){return g},get routes(){return i},get window(){return e},initialize:Te,subscribe:$e,enableScrollRestoration:ds,navigate:He,fetch:tn,revalidate:nt,createHref:G=>t.history.createHref(G),encodeLocation:G=>t.history.encodeLocation(G),getFetcher:je,deleteFetcher:Gt,dispose:xe,getBlocker:Al,deleteBlocker:js,patchRoutes:er,_internalFetchControllers:ee,_internalActiveDeferreds:le,_internalSetRoutes:fo},M}function ZR(t){return t!=null&&("formData"in t&&t.formData!=null||"body"in t&&t.body!==void 0)}function Qm(t,e,r,n,s,a,i,o){let l,c;if(i){l=[];for(let h of e)if(l.push(h),h.route.id===i){c=h;break}}else l=e,c=e[e.length-1];let u=Sd(s||".",kd(l,a),ca(t.pathname,r)||t.pathname,o==="path");if(s==null&&(u.search=t.search,u.hash=t.hash),(s==null||s===""||s===".")&&c){let h=Vg(u.search);if(c.route.index&&!h)u.search=u.search?u.search.replace(/^\?/,"?index&"):"?index";else if(!c.route.index&&h){let m=new URLSearchParams(u.search),p=m.getAll("index");m.delete("index"),p.filter(v=>v).forEach(v=>m.append("index",v));let x=m.toString();u.search=x?"?"+x:""}}return n&&r!=="/"&&(u.pathname=u.pathname==="/"?r:ea([r,u.pathname])),$i(u)}function s_(t,e,r,n){if(!n||!ZR(n))return{path:r};if(n.formMethod&&!fN(n.formMethod))return{path:r,error:sn(405,{method:n.formMethod})};let s=()=>({path:r,error:sn(400,{type:"invalid-body"})}),a=n.formMethod||"get",i=t?a.toUpperCase():a.toLowerCase(),o=vT(r);if(n.body!==void 0){if(n.formEncType==="text/plain"){if(!Jn(i))return s();let m=typeof n.body=="string"?n.body:n.body instanceof FormData||n.body instanceof URLSearchParams?Array.from(n.body.entries()).reduce((p,x)=>{let[v,w]=x;return""+p+v+"="+w+`
`},""):String(n.body);return{path:r,submission:{formMethod:i,formAction:o,formEncType:n.formEncType,formData:void 0,json:void 0,text:m}}}else if(n.formEncType==="application/json"){if(!Jn(i))return s();try{let m=typeof n.body=="string"?JSON.parse(n.body):n.body;return{path:r,submission:{formMethod:i,formAction:o,formEncType:n.formEncType,formData:void 0,json:m,text:void 0}}}catch{return s()}}}Ge(typeof FormData=="function","FormData is not available in this environment");let l,c;if(n.formData)l=Zm(n.formData),c=n.formData;else if(n.body instanceof FormData)l=Zm(n.body),c=n.body;else if(n.body instanceof URLSearchParams)l=n.body,c=u_(l);else if(n.body==null)l=new URLSearchParams,c=new FormData;else try{l=new URLSearchParams(n.body),c=u_(l)}catch{return s()}let u={formMethod:i,formAction:o,formEncType:n&&n.formEncType||"application/x-www-form-urlencoded",formData:c,json:void 0,text:void 0};if(Jn(u.formMethod))return{path:r,submission:u};let h=hi(r);return e&&h.search&&Vg(h.search)&&l.append("index",""),h.search="?"+l,{path:$i(h),submission:u}}function a_(t,e,r){r===void 0&&(r=!1);let n=t.findIndex(s=>s.route.id===e);return n>=0?t.slice(0,r?n+1:n):t}function i_(t,e,r,n,s,a,i,o,l,c,u,h,m,p,x,v){let w=v?xn(v[1])?v[1].error:v[1].data:void 0,k=t.createURL(e.location),T=t.createURL(s),E=r;a&&e.errors?E=a_(r,Object.keys(e.errors)[0],!0):v&&xn(v[1])&&(E=a_(r,v[0]));let N=v?v[1].statusCode:void 0,O=i&&N&&N>=400,M=E.filter((y,S)=>{let{route:R}=y;if(R.lazy)return!0;if(R.loader==null)return!1;if(a)return Jm(R,e.loaderData,e.errors);if(eN(e.loaderData,e.matches[S],y)||l.some(C=>C===y.route.id))return!0;let P=e.matches[S],b=y;return o_(y,Nt({currentUrl:k,currentParams:P.params,nextUrl:T,nextParams:b.params},n,{actionResult:w,actionStatus:N,defaultShouldRevalidate:O?!1:o||k.pathname+k.search===T.pathname+T.search||k.search!==T.search||pT(P,b)}))}),g=[];return h.forEach((y,S)=>{if(a||!r.some(oe=>oe.route.id===y.routeId)||u.has(S))return;let R=Ei(p,y.path,x);if(!R){g.push({key:S,routeId:y.routeId,path:y.path,matches:null,match:null,controller:null});return}let P=e.fetchers.get(S),b=Ql(R,y.path),C=!1;m.has(S)?C=!1:c.has(S)?(c.delete(S),C=!0):P&&P.state!=="idle"&&P.data===void 0?C=o:C=o_(b,Nt({currentUrl:k,currentParams:e.matches[e.matches.length-1].params,nextUrl:T,nextParams:r[r.length-1].params},n,{actionResult:w,actionStatus:N,defaultShouldRevalidate:O?!1:o})),C&&g.push({key:S,routeId:y.routeId,path:y.path,matches:R,match:b,controller:new AbortController})}),[M,g]}function Jm(t,e,r){if(t.lazy)return!0;if(!t.loader)return!1;let n=e!=null&&e[t.id]!==void 0,s=r!=null&&r[t.id]!==void 0;return!n&&s?!1:typeof t.loader=="function"&&t.loader.hydrate===!0?!0:!n&&!s}function eN(t,e,r){let n=!e||r.route.id!==e.route.id,s=t[r.route.id]===void 0;return n||s}function pT(t,e){let r=t.route.path;return t.pathname!==e.pathname||r!=null&&r.endsWith("*")&&t.params["*"]!==e.params["*"]}function o_(t,e){if(t.route.shouldRevalidate){let r=t.route.shouldRevalidate(e);if(typeof r=="boolean")return r}return e.defaultShouldRevalidate}function l_(t,e,r,n,s){var a;let i;if(t){let c=n[t];Ge(c,"No route found to patch children into: routeId = "+t),c.children||(c.children=[]),i=c.children}else i=r;let o=e.filter(c=>!i.some(u=>gT(c,u))),l=Ah(o,s,[t||"_","patch",String(((a=i)==null?void 0:a.length)||"0")],n);i.push(...l)}function gT(t,e){return"id"in t&&"id"in e&&t.id===e.id?!0:t.index===e.index&&t.path===e.path&&t.caseSensitive===e.caseSensitive?(!t.children||t.children.length===0)&&(!e.children||e.children.length===0)?!0:t.children.every((r,n)=>{var s;return(s=e.children)==null?void 0:s.some(a=>gT(r,a))}):!1}async function tN(t,e,r){if(!t.lazy)return;let n=await t.lazy();if(!t.lazy)return;let s=r[t.id];Ge(s,"No route found in manifest");let a={};for(let i in n){let l=s[i]!==void 0&&i!=="hasErrorBoundary";rl(!l,'Route "'+s.id+'" has a static property "'+i+'" defined but its lazy function is also returning a value for this property. '+('The lazy route property "'+i+'" will be ignored.')),!l&&!SR.has(i)&&(a[i]=n[i])}Object.assign(s,a),Object.assign(s,Nt({},e(s),{lazy:void 0}))}async function rN(t){let{matches:e}=t,r=e.filter(s=>s.shouldLoad);return(await Promise.all(r.map(s=>s.resolve()))).reduce((s,a,i)=>Object.assign(s,{[r[i].route.id]:a}),{})}async function nN(t,e,r,n,s,a,i,o,l,c){let u=a.map(p=>p.route.lazy?tN(p.route,l,o):void 0),h=a.map((p,x)=>{let v=u[x],w=s.some(T=>T.route.id===p.route.id);return Nt({},p,{shouldLoad:w,resolve:async T=>(T&&n.method==="GET"&&(p.route.lazy||p.route.loader)&&(w=!0),w?sN(e,n,p,v,T,c):Promise.resolve({type:mt.data,result:void 0}))})}),m=await t({matches:h,request:n,params:a[0].params,fetcherKey:i,context:c});try{await Promise.all(u)}catch{}return m}async function sN(t,e,r,n,s,a){let i,o,l=c=>{let u,h=new Promise((x,v)=>u=v);o=()=>u(),e.signal.addEventListener("abort",o);let m=x=>typeof c!="function"?Promise.reject(new Error("You cannot call the handler for a route which defines a boolean "+('"'+t+'" [routeId: '+r.route.id+"]"))):c({request:e,params:r.params,context:a},...x!==void 0?[x]:[]),p=(async()=>{try{return{type:"data",result:await(s?s(v=>m(v)):m())}}catch(x){return{type:"error",result:x}}})();return Promise.race([p,h])};try{let c=r.route[t];if(n)if(c){let u,[h]=await Promise.all([l(c).catch(m=>{u=m}),n]);if(u!==void 0)throw u;i=h}else if(await n,c=r.route[t],c)i=await l(c);else if(t==="action"){let u=new URL(e.url),h=u.pathname+u.search;throw sn(405,{method:e.method,pathname:h,routeId:r.route.id})}else return{type:mt.data,result:void 0};else if(c)i=await l(c);else{let u=new URL(e.url),h=u.pathname+u.search;throw sn(404,{pathname:h})}Ge(i.result!==void 0,"You defined "+(t==="action"?"an action":"a loader")+" for route "+('"'+r.route.id+"\" but didn't return anything from your `"+t+"` ")+"function. Please return a value or `null`.")}catch(c){return{type:mt.error,result:c}}finally{o&&e.signal.removeEventListener("abort",o)}return i}async function aN(t){let{result:e,type:r}=t;if(xT(e)){let h;try{let m=e.headers.get("Content-Type");m&&/\bapplication\/json\b/.test(m)?e.body==null?h=null:h=await e.json():h=await e.text()}catch(m){return{type:mt.error,error:m}}return r===mt.error?{type:mt.error,error:new Ch(e.status,e.statusText,h),statusCode:e.status,headers:e.headers}:{type:mt.data,data:h,statusCode:e.status,headers:e.headers}}if(r===mt.error){if(p_(e)){var n,s;if(e.data instanceof Error){var a,i;return{type:mt.error,error:e.data,statusCode:(a=e.init)==null?void 0:a.status,headers:(i=e.init)!=null&&i.headers?new Headers(e.init.headers):void 0}}return{type:mt.error,error:new Ch(((n=e.init)==null?void 0:n.status)||500,void 0,e.data),statusCode:qc(e)?e.status:void 0,headers:(s=e.init)!=null&&s.headers?new Headers(e.init.headers):void 0}}return{type:mt.error,error:e,statusCode:qc(e)?e.status:void 0}}if(uN(e)){var o,l;return{type:mt.deferred,deferredData:e,statusCode:(o=e.init)==null?void 0:o.status,headers:((l=e.init)==null?void 0:l.headers)&&new Headers(e.init.headers)}}if(p_(e)){var c,u;return{type:mt.data,data:e.data,statusCode:(c=e.init)==null?void 0:c.status,headers:(u=e.init)!=null&&u.headers?new Headers(e.init.headers):void 0}}return{type:mt.data,data:e}}function iN(t,e,r,n,s,a){let i=t.headers.get("Location");if(Ge(i,"Redirects returned/thrown from loaders/actions must have a Location header"),!Lg.test(i)){let o=n.slice(0,n.findIndex(l=>l.route.id===r)+1);i=Qm(new URL(e.url),o,s,!0,i,a),t.headers.set("Location",i)}return t}function c_(t,e,r){if(Lg.test(t)){let n=t,s=n.startsWith("//")?new URL(e.protocol+n):new URL(n),a=ca(s.pathname,r)!=null;if(s.origin===e.origin&&a)return s.pathname+s.search+s.hash}return t}function vo(t,e,r,n){let s=t.createURL(vT(e)).toString(),a={signal:r};if(n&&Jn(n.formMethod)){let{formMethod:i,formEncType:o}=n;a.method=i.toUpperCase(),o==="application/json"?(a.headers=new Headers({"Content-Type":o}),a.body=JSON.stringify(n.json)):o==="text/plain"?a.body=n.text:o==="application/x-www-form-urlencoded"&&n.formData?a.body=Zm(n.formData):a.body=n.formData}return new Request(s,a)}function Zm(t){let e=new URLSearchParams;for(let[r,n]of t.entries())e.append(r,typeof n=="string"?n:n.name);return e}function u_(t){let e=new FormData;for(let[r,n]of t.entries())e.append(r,n);return e}function oN(t,e,r,n,s){let a={},i=null,o,l=!1,c={},u=r&&xn(r[1])?r[1].error:void 0;return t.forEach(h=>{if(!(h.route.id in e))return;let m=h.route.id,p=e[m];if(Ge(!Ci(p),"Cannot handle redirect results in processLoaderData"),xn(p)){let x=p.error;u!==void 0&&(x=u,u=void 0),i=i||{};{let v=Ti(t,m);i[v.route.id]==null&&(i[v.route.id]=x)}a[m]=void 0,l||(l=!0,o=qc(p.error)?p.error.status:500),p.headers&&(c[m]=p.headers)}else ja(p)?(n.set(m,p.deferredData),a[m]=p.deferredData.data,p.statusCode!=null&&p.statusCode!==200&&!l&&(o=p.statusCode),p.headers&&(c[m]=p.headers)):(a[m]=p.data,p.statusCode&&p.statusCode!==200&&!l&&(o=p.statusCode),p.headers&&(c[m]=p.headers))}),u!==void 0&&r&&(i={[r[0]]:u},a[r[0]]=void 0),{loaderData:a,errors:i,statusCode:o||200,loaderHeaders:c}}function f_(t,e,r,n,s,a,i){let{loaderData:o,errors:l}=oN(e,r,n,i);return s.forEach(c=>{let{key:u,match:h,controller:m}=c,p=a[u];if(Ge(p,"Did not find corresponding fetcher result"),!(m&&m.signal.aborted))if(xn(p)){let x=Ti(t.matches,h==null?void 0:h.route.id);l&&l[x.route.id]||(l=Nt({},l,{[x.route.id]:p.error})),t.fetchers.delete(u)}else if(Ci(p))Ge(!1,"Unhandled fetcher revalidation redirect");else if(ja(p))Ge(!1,"Unhandled fetcher deferred data");else{let x=Ia(p.data);t.fetchers.set(u,x)}}),{loaderData:o,errors:l}}function h_(t,e,r,n){let s=Nt({},e);for(let a of r){let i=a.route.id;if(e.hasOwnProperty(i)?e[i]!==void 0&&(s[i]=e[i]):t[i]!==void 0&&a.route.loader&&(s[i]=t[i]),n&&n.hasOwnProperty(i))break}return s}function d_(t){return t?xn(t[1])?{actionData:{}}:{actionData:{[t[0]]:t[1].data}}:{}}function Ti(t,e){return(e?t.slice(0,t.findIndex(n=>n.route.id===e)+1):[...t]).reverse().find(n=>n.route.hasErrorBoundary===!0)||t[0]}function m_(t){let e=t.length===1?t[0]:t.find(r=>r.index||!r.path||r.path==="/")||{id:"__shim-error-route__"};return{matches:[{params:{},pathname:"",pathnameBase:"",route:e}],route:e}}function sn(t,e){let{pathname:r,routeId:n,method:s,type:a,message:i}=e===void 0?{}:e,o="Unknown Server Error",l="Unknown @remix-run/router error";return t===400?(o="Bad Request",s&&r&&n?l="You made a "+s+' request to "'+r+'" but '+('did not provide a `loader` for route "'+n+'", ')+"so there is no way to handle the request.":a==="defer-action"?l="defer() is not supported in actions":a==="invalid-body"&&(l="Unable to encode submission body")):t===403?(o="Forbidden",l='Route "'+n+'" does not match URL "'+r+'"'):t===404?(o="Not Found",l='No route matches URL "'+r+'"'):t===405&&(o="Method Not Allowed",s&&r&&n?l="You made a "+s.toUpperCase()+' request to "'+r+'" but '+('did not provide an `action` for route "'+n+'", ')+"so there is no way to handle the request.":s&&(l='Invalid request method "'+s.toUpperCase()+'"')),new Ch(t||500,o,new Error(l),!0)}function xf(t){let e=Object.entries(t);for(let r=e.length-1;r>=0;r--){let[n,s]=e[r];if(Ci(s))return{key:n,result:s}}}function vT(t){let e=typeof t=="string"?hi(t):t;return $i(Nt({},e,{hash:""}))}function lN(t,e){return t.pathname!==e.pathname||t.search!==e.search?!1:t.hash===""?e.hash!=="":t.hash===e.hash?!0:e.hash!==""}function cN(t){return xT(t.result)&&qR.has(t.result.status)}function ja(t){return t.type===mt.deferred}function xn(t){return t.type===mt.error}function Ci(t){return(t&&t.type)===mt.redirect}function p_(t){return typeof t=="object"&&t!=null&&"type"in t&&"data"in t&&"init"in t&&t.type==="DataWithResponseInit"}function uN(t){let e=t;return e&&typeof e=="object"&&typeof e.data=="object"&&typeof e.subscribe=="function"&&typeof e.cancel=="function"&&typeof e.resolveData=="function"}function xT(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.headers=="object"&&typeof t.body<"u"}function fN(t){return KR.has(t.toLowerCase())}function Jn(t){return HR.has(t.toLowerCase())}async function hN(t,e,r,n,s){let a=Object.entries(e);for(let i=0;i<a.length;i++){let[o,l]=a[i],c=t.find(m=>(m==null?void 0:m.route.id)===o);if(!c)continue;let u=n.find(m=>m.route.id===c.route.id),h=u!=null&&!pT(u,c)&&(s&&s[c.route.id])!==void 0;ja(l)&&h&&await jg(l,r,!1).then(m=>{m&&(e[o]=m)})}}async function dN(t,e,r){for(let n=0;n<r.length;n++){let{key:s,routeId:a,controller:i}=r[n],o=e[s];t.find(c=>(c==null?void 0:c.route.id)===a)&&ja(o)&&(Ge(i,"Expected an AbortController for revalidating fetcher deferred result"),await jg(o,i.signal,!0).then(c=>{c&&(e[s]=c)}))}}async function jg(t,e,r){if(r===void 0&&(r=!1),!await t.deferredData.resolveData(e)){if(r)try{return{type:mt.data,data:t.deferredData.unwrappedData}}catch(s){return{type:mt.error,error:s}}return{type:mt.data,data:t.deferredData.data}}}function Vg(t){return new URLSearchParams(t).getAll("index").some(e=>e==="")}function Ql(t,e){let r=typeof e=="string"?hi(e).search:e.search;if(t[t.length-1].route.index&&Vg(r||""))return t[t.length-1];let n=hT(t);return n[n.length-1]}function g_(t){let{formMethod:e,formAction:r,formEncType:n,text:s,formData:a,json:i}=t;if(!(!e||!r||!n)){if(s!=null)return{formMethod:e,formAction:r,formEncType:n,formData:void 0,json:void 0,text:s};if(a!=null)return{formMethod:e,formAction:r,formEncType:n,formData:a,json:void 0,text:void 0};if(i!==void 0)return{formMethod:e,formAction:r,formEncType:n,formData:void 0,json:i,text:void 0}}}function O0(t,e){return e?{state:"loading",location:t,formMethod:e.formMethod,formAction:e.formAction,formEncType:e.formEncType,formData:e.formData,json:e.json,text:e.text}:{state:"loading",location:t,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0}}function mN(t,e){return{state:"submitting",location:t,formMethod:e.formMethod,formAction:e.formAction,formEncType:e.formEncType,formData:e.formData,json:e.json,text:e.text}}function Wl(t,e){return t?{state:"loading",formMethod:t.formMethod,formAction:t.formAction,formEncType:t.formEncType,formData:t.formData,json:t.json,text:t.text,data:e}:{state:"loading",formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0,data:e}}function pN(t,e){return{state:"submitting",formMethod:t.formMethod,formAction:t.formAction,formEncType:t.formEncType,formData:t.formData,json:t.json,text:t.text,data:e?e.data:void 0}}function Ia(t){return{state:"idle",formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0,data:t}}function gN(t,e){try{let r=t.sessionStorage.getItem(mT);if(r){let n=JSON.parse(r);for(let[s,a]of Object.entries(n||{}))a&&Array.isArray(a)&&e.set(s,new Set(a||[]))}}catch{}}function vN(t,e){if(e.size>0){let r={};for(let[n,s]of e)r[n]=[...s];try{t.sessionStorage.setItem(mT,JSON.stringify(r))}catch(n){rl(!1,"Failed to save applied view transitions in sessionStorage ("+n+").")}}}/**
 * React Router v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Rh(){return Rh=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},Rh.apply(this,arguments)}const _u=W.createContext(null),Ug=W.createContext(null),xa=W.createContext(null),Bg=W.createContext(null),Ps=W.createContext({outlet:null,matches:[],isDataRoute:!1}),_T=W.createContext(null);function xN(t,e){let{relative:r}=e===void 0?{}:e;xl()||Ge(!1);let{basename:n,navigator:s}=W.useContext(xa),{hash:a,pathname:i,search:o}=Ad(t,{relative:r}),l=i;return n!=="/"&&(l=i==="/"?n:ea([n,i])),s.createHref({pathname:l,search:o,hash:a})}function xl(){return W.useContext(Bg)!=null}function _a(){return xl()||Ge(!1),W.useContext(Bg).location}function yT(t){W.useContext(xa).static||W.useLayoutEffect(t)}function di(){let{isDataRoute:t}=W.useContext(Ps);return t?DN():_N()}function _N(){xl()||Ge(!1);let t=W.useContext(_u),{basename:e,future:r,navigator:n}=W.useContext(xa),{matches:s}=W.useContext(Ps),{pathname:a}=_a(),i=JSON.stringify(kd(s,r.v7_relativeSplatPath)),o=W.useRef(!1);return yT(()=>{o.current=!0}),W.useCallback(function(c,u){if(u===void 0&&(u={}),!o.current)return;if(typeof c=="number"){n.go(c);return}let h=Sd(c,JSON.parse(i),a,u.relative==="path");t==null&&e!=="/"&&(h.pathname=h.pathname==="/"?e:ea([e,h.pathname])),(u.replace?n.replace:n.push)(h,u.state,u)},[e,n,i,a,t])}const yN=W.createContext(null);function wN(t){let e=W.useContext(Ps).outlet;return e&&W.createElement(yN.Provider,{value:t},e)}function EN(){let{matches:t}=W.useContext(Ps),e=t[t.length-1];return e?e.params:{}}function Ad(t,e){let{relative:r}=e===void 0?{}:e,{future:n}=W.useContext(xa),{matches:s}=W.useContext(Ps),{pathname:a}=_a(),i=JSON.stringify(kd(s,n.v7_relativeSplatPath));return W.useMemo(()=>Sd(t,JSON.parse(i),a,r==="path"),[t,i,a,r])}function TN(t,e,r,n){xl()||Ge(!1);let{navigator:s}=W.useContext(xa),{matches:a}=W.useContext(Ps),i=a[a.length-1],o=i?i.params:{};i&&i.pathname;let l=i?i.pathnameBase:"/";i&&i.route;let c=_a(),u;u=c;let h=u.pathname||"/",m=h;if(l!=="/"){let v=l.replace(/^\//,"").split("/");m="/"+h.replace(/^\//,"").split("/").slice(v.length).join("/")}let p=Ei(t,{pathname:m});return CN(p&&p.map(v=>Object.assign({},v,{params:Object.assign({},o,v.params),pathname:ea([l,s.encodeLocation?s.encodeLocation(v.pathname).pathname:v.pathname]),pathnameBase:v.pathnameBase==="/"?l:ea([l,s.encodeLocation?s.encodeLocation(v.pathnameBase).pathname:v.pathnameBase])})),a,r,n)}function kN(){let t=bN(),e=qc(t)?t.status+" "+t.statusText:t instanceof Error?t.message:JSON.stringify(t),r=t instanceof Error?t.stack:null,s={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return W.createElement(W.Fragment,null,W.createElement("h2",null,"Unexpected Application Error!"),W.createElement("h3",{style:{fontStyle:"italic"}},e),r?W.createElement("pre",{style:s},r):null,null)}const SN=W.createElement(kN,null);class AN extends W.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,r){return r.location!==e.location||r.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:r.error,location:r.location,revalidation:e.revalidation||r.revalidation}}componentDidCatch(e,r){console.error("React Router caught the following error during render",e,r)}render(){return this.state.error!==void 0?W.createElement(Ps.Provider,{value:this.props.routeContext},W.createElement(_T.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function IN(t){let{routeContext:e,match:r,children:n}=t,s=W.useContext(_u);return s&&s.static&&s.staticContext&&(r.route.errorElement||r.route.ErrorBoundary)&&(s.staticContext._deepestRenderedBoundaryId=r.route.id),W.createElement(Ps.Provider,{value:e},n)}function CN(t,e,r,n){var s;if(e===void 0&&(e=[]),r===void 0&&(r=null),n===void 0&&(n=null),t==null){var a;if(!r)return null;if(r.errors)t=r.matches;else if((a=n)!=null&&a.v7_partialHydration&&e.length===0&&!r.initialized&&r.matches.length>0)t=r.matches;else return null}let i=t,o=(s=r)==null?void 0:s.errors;if(o!=null){let u=i.findIndex(h=>h.route.id&&(o==null?void 0:o[h.route.id])!==void 0);u>=0||Ge(!1),i=i.slice(0,Math.min(i.length,u+1))}let l=!1,c=-1;if(r&&n&&n.v7_partialHydration)for(let u=0;u<i.length;u++){let h=i[u];if((h.route.HydrateFallback||h.route.hydrateFallbackElement)&&(c=u),h.route.id){let{loaderData:m,errors:p}=r,x=h.route.loader&&m[h.route.id]===void 0&&(!p||p[h.route.id]===void 0);if(h.route.lazy||x){l=!0,c>=0?i=i.slice(0,c+1):i=[i[0]];break}}}return i.reduceRight((u,h,m)=>{let p,x=!1,v=null,w=null;r&&(p=o&&h.route.id?o[h.route.id]:void 0,v=h.route.errorElement||SN,l&&(c<0&&m===0?(FN("route-fallback"),x=!0,w=null):c===m&&(x=!0,w=h.route.hydrateFallbackElement||null)));let k=e.concat(i.slice(0,m+1)),T=()=>{let E;return p?E=v:x?E=w:h.route.Component?E=W.createElement(h.route.Component,null):h.route.element?E=h.route.element:E=u,W.createElement(IN,{match:h,routeContext:{outlet:u,matches:k,isDataRoute:r!=null},children:E})};return r&&(h.route.ErrorBoundary||h.route.errorElement||m===0)?W.createElement(AN,{location:r.location,revalidation:r.revalidation,component:v,error:p,children:T(),routeContext:{outlet:null,matches:k,isDataRoute:!0}}):T()},null)}var wT=function(t){return t.UseBlocker="useBlocker",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t}(wT||{}),ET=function(t){return t.UseBlocker="useBlocker",t.UseLoaderData="useLoaderData",t.UseActionData="useActionData",t.UseRouteError="useRouteError",t.UseNavigation="useNavigation",t.UseRouteLoaderData="useRouteLoaderData",t.UseMatches="useMatches",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t.UseRouteId="useRouteId",t}(ET||{});function RN(t){let e=W.useContext(_u);return e||Ge(!1),e}function NN(t){let e=W.useContext(Ug);return e||Ge(!1),e}function PN(t){let e=W.useContext(Ps);return e||Ge(!1),e}function TT(t){let e=PN(),r=e.matches[e.matches.length-1];return r.route.id||Ge(!1),r.route.id}function bN(){var t;let e=W.useContext(_T),r=NN(ET.UseRouteError),n=TT();return e!==void 0?e:(t=r.errors)==null?void 0:t[n]}function DN(){let{router:t}=RN(wT.UseNavigateStable),e=TT(),r=W.useRef(!1);return yT(()=>{r.current=!0}),W.useCallback(function(s,a){a===void 0&&(a={}),r.current&&(typeof s=="number"?t.navigate(s):t.navigate(s,Rh({fromRouteId:e},a)))},[t,e])}const v_={};function FN(t,e,r){v_[t]||(v_[t]=!0)}function ON(t,e){t==null||t.v7_startTransition,(t==null?void 0:t.v7_relativeSplatPath)===void 0&&(!e||e.v7_relativeSplatPath),e&&(e.v7_fetcherPersist,e.v7_normalizeFormMethod,e.v7_partialHydration,e.v7_skipActionErrorRevalidation)}function MN(t){let{to:e,replace:r,state:n,relative:s}=t;xl()||Ge(!1);let{future:a,static:i}=W.useContext(xa),{matches:o}=W.useContext(Ps),{pathname:l}=_a(),c=di(),u=Sd(e,kd(o,a.v7_relativeSplatPath),l,s==="path"),h=JSON.stringify(u);return W.useEffect(()=>c(JSON.parse(h),{replace:r,state:n,relative:s}),[c,h,s,r,n]),null}function kT(t){return wN(t.context)}function LN(t){let{basename:e="/",children:r=null,location:n,navigationType:s=Qt.Pop,navigator:a,static:i=!1,future:o}=t;xl()&&Ge(!1);let l=e.replace(/^\/*/,"/"),c=W.useMemo(()=>({basename:l,navigator:a,static:i,future:Rh({v7_relativeSplatPath:!1},o)}),[l,o,a,i]);typeof n=="string"&&(n=hi(n));let{pathname:u="/",search:h="",hash:m="",state:p=null,key:x="default"}=n,v=W.useMemo(()=>{let w=ca(u,l);return w==null?null:{location:{pathname:w,search:h,hash:m,state:p,key:x},navigationType:s}},[l,u,h,m,p,x,s]);return v==null?null:W.createElement(xa.Provider,{value:c},W.createElement(Bg.Provider,{children:r,value:v}))}new Promise(()=>{});function jN(t){let e={hasErrorBoundary:t.ErrorBoundary!=null||t.errorElement!=null};return t.Component&&Object.assign(e,{element:W.createElement(t.Component),Component:void 0}),t.HydrateFallback&&Object.assign(e,{hydrateFallbackElement:W.createElement(t.HydrateFallback),HydrateFallback:void 0}),t.ErrorBoundary&&Object.assign(e,{errorElement:W.createElement(t.ErrorBoundary),ErrorBoundary:void 0}),e}/**
 * React Router DOM v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function nl(){return nl=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},nl.apply(this,arguments)}function ST(t,e){if(t==null)return{};var r={},n=Object.keys(t),s,a;for(a=0;a<n.length;a++)s=n[a],!(e.indexOf(s)>=0)&&(r[s]=t[s]);return r}function VN(t){return!!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}function UN(t,e){return t.button===0&&(!e||e==="_self")&&!VN(t)}const BN=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],zN=["aria-current","caseSensitive","className","end","style","to","viewTransition","children"],$N="6";try{window.__reactRouterVersion=$N}catch{}function WN(t,e){return JR({basename:void 0,future:nl({},void 0,{v7_prependBasename:!0}),history:ER({window:void 0}),hydrationData:HN(),routes:t,mapRouteProperties:jN,dataStrategy:void 0,patchRoutesOnNavigation:void 0,window:void 0}).initialize()}function HN(){var t;let e=(t=window)==null?void 0:t.__staticRouterHydrationData;return e&&e.errors&&(e=nl({},e,{errors:GN(e.errors)})),e}function GN(t){if(!t)return null;let e=Object.entries(t),r={};for(let[n,s]of e)if(s&&s.__type==="RouteErrorResponse")r[n]=new Ch(s.status,s.statusText,s.data,s.internal===!0);else if(s&&s.__type==="Error"){if(s.__subType){let a=window[s.__subType];if(typeof a=="function")try{let i=new a(s.message);i.stack="",r[n]=i}catch{}}if(r[n]==null){let a=new Error(s.message);a.stack="",r[n]=a}}else r[n]=s;return r}const AT=W.createContext({isTransitioning:!1}),KN=W.createContext(new Map),qN="startTransition",x_=cC[qN],XN="flushSync",__=wR[XN];function YN(t){x_?x_(t):t()}function Hl(t){__?__(t):t()}let QN=class{constructor(){this.status="pending",this.promise=new Promise((e,r)=>{this.resolve=n=>{this.status==="pending"&&(this.status="resolved",e(n))},this.reject=n=>{this.status==="pending"&&(this.status="rejected",r(n))}})}};function JN(t){let{fallbackElement:e,router:r,future:n}=t,[s,a]=W.useState(r.state),[i,o]=W.useState(),[l,c]=W.useState({isTransitioning:!1}),[u,h]=W.useState(),[m,p]=W.useState(),[x,v]=W.useState(),w=W.useRef(new Map),{v7_startTransition:k}=n||{},T=W.useCallback(y=>{k?YN(y):y()},[k]),E=W.useCallback((y,S)=>{let{deletedFetchers:R,flushSync:P,viewTransitionOpts:b}=S;y.fetchers.forEach((oe,ae)=>{oe.data!==void 0&&w.current.set(ae,oe.data)}),R.forEach(oe=>w.current.delete(oe));let C=r.window==null||r.window.document==null||typeof r.window.document.startViewTransition!="function";if(!b||C){P?Hl(()=>a(y)):T(()=>a(y));return}if(P){Hl(()=>{m&&(u&&u.resolve(),m.skipTransition()),c({isTransitioning:!0,flushSync:!0,currentLocation:b.currentLocation,nextLocation:b.nextLocation})});let oe=r.window.document.startViewTransition(()=>{Hl(()=>a(y))});oe.finished.finally(()=>{Hl(()=>{h(void 0),p(void 0),o(void 0),c({isTransitioning:!1})})}),Hl(()=>p(oe));return}m?(u&&u.resolve(),m.skipTransition(),v({state:y,currentLocation:b.currentLocation,nextLocation:b.nextLocation})):(o(y),c({isTransitioning:!0,flushSync:!1,currentLocation:b.currentLocation,nextLocation:b.nextLocation}))},[r.window,m,u,w,T]);W.useLayoutEffect(()=>r.subscribe(E),[r,E]),W.useEffect(()=>{l.isTransitioning&&!l.flushSync&&h(new QN)},[l]),W.useEffect(()=>{if(u&&i&&r.window){let y=i,S=u.promise,R=r.window.document.startViewTransition(async()=>{T(()=>a(y)),await S});R.finished.finally(()=>{h(void 0),p(void 0),o(void 0),c({isTransitioning:!1})}),p(R)}},[T,i,u,r.window]),W.useEffect(()=>{u&&i&&s.location.key===i.location.key&&u.resolve()},[u,m,s.location,i]),W.useEffect(()=>{!l.isTransitioning&&x&&(o(x.state),c({isTransitioning:!0,flushSync:!1,currentLocation:x.currentLocation,nextLocation:x.nextLocation}),v(void 0))},[l.isTransitioning,x]),W.useEffect(()=>{},[]);let N=W.useMemo(()=>({createHref:r.createHref,encodeLocation:r.encodeLocation,go:y=>r.navigate(y),push:(y,S,R)=>r.navigate(y,{state:S,preventScrollReset:R==null?void 0:R.preventScrollReset}),replace:(y,S,R)=>r.navigate(y,{replace:!0,state:S,preventScrollReset:R==null?void 0:R.preventScrollReset})}),[r]),O=r.basename||"/",M=W.useMemo(()=>({router:r,navigator:N,static:!1,basename:O}),[r,N,O]),g=W.useMemo(()=>({v7_relativeSplatPath:r.future.v7_relativeSplatPath}),[r.future.v7_relativeSplatPath]);return W.useEffect(()=>ON(n,r.future),[n,r.future]),W.createElement(W.Fragment,null,W.createElement(_u.Provider,{value:M},W.createElement(Ug.Provider,{value:s},W.createElement(KN.Provider,{value:w.current},W.createElement(AT.Provider,{value:l},W.createElement(LN,{basename:O,location:s.location,navigationType:s.historyAction,navigator:N,future:g},s.initialized||r.future.v7_partialHydration?W.createElement(ZN,{routes:r.routes,future:r.future,state:s}):e))))),null)}const ZN=W.memo(eP);function eP(t){let{routes:e,future:r,state:n}=t;return TN(e,void 0,n,r)}const tP=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",rP=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,et=W.forwardRef(function(e,r){let{onClick:n,relative:s,reloadDocument:a,replace:i,state:o,target:l,to:c,preventScrollReset:u,viewTransition:h}=e,m=ST(e,BN),{basename:p}=W.useContext(xa),x,v=!1;if(typeof c=="string"&&rP.test(c)&&(x=c,tP))try{let E=new URL(window.location.href),N=c.startsWith("//")?new URL(E.protocol+c):new URL(c),O=ca(N.pathname,p);N.origin===E.origin&&O!=null?c=O+N.search+N.hash:v=!0}catch{}let w=xN(c,{relative:s}),k=sP(c,{replace:i,state:o,target:l,preventScrollReset:u,relative:s,viewTransition:h});function T(E){n&&n(E),E.defaultPrevented||k(E)}return W.createElement("a",nl({},m,{href:x||w,onClick:v||a?n:T,ref:r,target:l}))}),xi=W.forwardRef(function(e,r){let{"aria-current":n="page",caseSensitive:s=!1,className:a="",end:i=!1,style:o,to:l,viewTransition:c,children:u}=e,h=ST(e,zN),m=Ad(l,{relative:h.relative}),p=_a(),x=W.useContext(Ug),{navigator:v,basename:w}=W.useContext(xa),k=x!=null&&aP(m)&&c===!0,T=v.encodeLocation?v.encodeLocation(m).pathname:m.pathname,E=p.pathname,N=x&&x.navigation&&x.navigation.location?x.navigation.location.pathname:null;s||(E=E.toLowerCase(),N=N?N.toLowerCase():null,T=T.toLowerCase()),N&&w&&(N=ca(N,w)||N);const O=T!=="/"&&T.endsWith("/")?T.length-1:T.length;let M=E===T||!i&&E.startsWith(T)&&E.charAt(O)==="/",g=N!=null&&(N===T||!i&&N.startsWith(T)&&N.charAt(T.length)==="/"),y={isActive:M,isPending:g,isTransitioning:k},S=M?n:void 0,R;typeof a=="function"?R=a(y):R=[a,M?"active":null,g?"pending":null,k?"transitioning":null].filter(Boolean).join(" ");let P=typeof o=="function"?o(y):o;return W.createElement(et,nl({},h,{"aria-current":S,className:R,ref:r,style:P,to:l,viewTransition:c}),typeof u=="function"?u(y):u)});var ep;(function(t){t.UseScrollRestoration="useScrollRestoration",t.UseSubmit="useSubmit",t.UseSubmitFetcher="useSubmitFetcher",t.UseFetcher="useFetcher",t.useViewTransitionState="useViewTransitionState"})(ep||(ep={}));var y_;(function(t){t.UseFetcher="useFetcher",t.UseFetchers="useFetchers",t.UseScrollRestoration="useScrollRestoration"})(y_||(y_={}));function nP(t){let e=W.useContext(_u);return e||Ge(!1),e}function sP(t,e){let{target:r,replace:n,state:s,preventScrollReset:a,relative:i,viewTransition:o}=e===void 0?{}:e,l=di(),c=_a(),u=Ad(t,{relative:i});return W.useCallback(h=>{if(UN(h,r)){h.preventDefault();let m=n!==void 0?n:$i(c)===$i(u);l(t,{replace:m,state:s,preventScrollReset:a,relative:i,viewTransition:o})}},[c,l,u,n,s,r,t,a,i,o])}function aP(t,e){e===void 0&&(e={});let r=W.useContext(AT);r==null&&Ge(!1);let{basename:n}=nP(ep.useViewTransitionState),s=Ad(t,{relative:e.relative});if(!r.isTransitioning)return!1;let a=ca(r.currentLocation.pathname,n)||r.currentLocation.pathname,i=ca(r.nextLocation.pathname,n)||r.nextLocation.pathname;return Ih(s.pathname,i)!=null||Ih(s.pathname,a)!=null}var w_={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const IT=function(t){const e=[];let r=0;for(let n=0;n<t.length;n++){let s=t.charCodeAt(n);s<128?e[r++]=s:s<2048?(e[r++]=s>>6|192,e[r++]=s&63|128):(s&64512)===55296&&n+1<t.length&&(t.charCodeAt(n+1)&64512)===56320?(s=65536+((s&1023)<<10)+(t.charCodeAt(++n)&1023),e[r++]=s>>18|240,e[r++]=s>>12&63|128,e[r++]=s>>6&63|128,e[r++]=s&63|128):(e[r++]=s>>12|224,e[r++]=s>>6&63|128,e[r++]=s&63|128)}return e},iP=function(t){const e=[];let r=0,n=0;for(;r<t.length;){const s=t[r++];if(s<128)e[n++]=String.fromCharCode(s);else if(s>191&&s<224){const a=t[r++];e[n++]=String.fromCharCode((s&31)<<6|a&63)}else if(s>239&&s<365){const a=t[r++],i=t[r++],o=t[r++],l=((s&7)<<18|(a&63)<<12|(i&63)<<6|o&63)-65536;e[n++]=String.fromCharCode(55296+(l>>10)),e[n++]=String.fromCharCode(56320+(l&1023))}else{const a=t[r++],i=t[r++];e[n++]=String.fromCharCode((s&15)<<12|(a&63)<<6|i&63)}}return e.join("")},CT={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const r=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,n=[];for(let s=0;s<t.length;s+=3){const a=t[s],i=s+1<t.length,o=i?t[s+1]:0,l=s+2<t.length,c=l?t[s+2]:0,u=a>>2,h=(a&3)<<4|o>>4;let m=(o&15)<<2|c>>6,p=c&63;l||(p=64,i||(m=64)),n.push(r[u],r[h],r[m],r[p])}return n.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(IT(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):iP(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const r=e?this.charToByteMapWebSafe_:this.charToByteMap_,n=[];for(let s=0;s<t.length;){const a=r[t.charAt(s++)],o=s<t.length?r[t.charAt(s)]:0;++s;const c=s<t.length?r[t.charAt(s)]:64;++s;const h=s<t.length?r[t.charAt(s)]:64;if(++s,a==null||o==null||c==null||h==null)throw new oP;const m=a<<2|o>>4;if(n.push(m),c!==64){const p=o<<4&240|c>>2;if(n.push(p),h!==64){const x=c<<6&192|h;n.push(x)}}}return n},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class oP extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const lP=function(t){const e=IT(t);return CT.encodeByteArray(e,!0)},Nh=function(t){return lP(t).replace(/\./g,"")},RT=function(t){try{return CT.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cP(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uP=()=>cP().__FIREBASE_DEFAULTS__,fP=()=>{if(typeof process>"u"||typeof w_>"u")return;const t=w_.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},hP=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&RT(t[1]);return e&&JSON.parse(e)},Id=()=>{try{return uP()||fP()||hP()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},NT=t=>{var e,r;return(r=(e=Id())===null||e===void 0?void 0:e.emulatorHosts)===null||r===void 0?void 0:r[t]},zg=t=>{const e=NT(t);if(!e)return;const r=e.lastIndexOf(":");if(r<=0||r+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const n=parseInt(e.substring(r+1),10);return e[0]==="["?[e.substring(1,r-1),n]:[e.substring(0,r),n]},PT=()=>{var t;return(t=Id())===null||t===void 0?void 0:t.config},bT=t=>{var e;return(e=Id())===null||e===void 0?void 0:e[`_${t}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dP{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,r)=>{this.resolve=e,this.reject=r})}wrapCallback(e){return(r,n)=>{r?this.reject(r):this.resolve(n),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(r):e(r,n))}}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function DT(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const r={alg:"none",type:"JWT"},n=e||"demo-project",s=t.iat||0,a=t.sub||t.user_id;if(!a)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const i=Object.assign({iss:`https://securetoken.google.com/${n}`,aud:n,iat:s,exp:s+3600,auth_time:s,sub:a,user_id:a,firebase:{sign_in_provider:"custom",identities:{}}},t);return[Nh(JSON.stringify(r)),Nh(JSON.stringify(i)),""].join(".")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zr(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function mP(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(zr())}function pP(){var t;const e=(t=Id())===null||t===void 0?void 0:t.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function gP(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function vP(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function xP(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function _P(){const t=zr();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function yP(){return!pP()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function wP(){try{return typeof indexedDB=="object"}catch{return!1}}function EP(){return new Promise((t,e)=>{try{let r=!0;const n="validate-browser-context-for-indexeddb-analytics-module",s=self.indexedDB.open(n);s.onsuccess=()=>{s.result.close(),r||self.indexedDB.deleteDatabase(n),t(!0)},s.onupgradeneeded=()=>{r=!1},s.onerror=()=>{var a;e(((a=s.error)===null||a===void 0?void 0:a.message)||"")}}catch(r){e(r)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const TP="FirebaseError";class bs extends Error{constructor(e,r,n){super(r),this.code=e,this.customData=n,this.name=TP,Object.setPrototypeOf(this,bs.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,yu.prototype.create)}}class yu{constructor(e,r,n){this.service=e,this.serviceName=r,this.errors=n}create(e,...r){const n=r[0]||{},s=`${this.service}/${e}`,a=this.errors[e],i=a?kP(a,n):"Error",o=`${this.serviceName}: ${i} (${s}).`;return new bs(s,o,n)}}function kP(t,e){return t.replace(SP,(r,n)=>{const s=e[n];return s!=null?String(s):`<${n}?>`})}const SP=/\{\$([^}]+)}/g;function AP(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function Ph(t,e){if(t===e)return!0;const r=Object.keys(t),n=Object.keys(e);for(const s of r){if(!n.includes(s))return!1;const a=t[s],i=e[s];if(E_(a)&&E_(i)){if(!Ph(a,i))return!1}else if(a!==i)return!1}for(const s of n)if(!r.includes(s))return!1;return!0}function E_(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wu(t){const e=[];for(const[r,n]of Object.entries(t))Array.isArray(n)?n.forEach(s=>{e.push(encodeURIComponent(r)+"="+encodeURIComponent(s))}):e.push(encodeURIComponent(r)+"="+encodeURIComponent(n));return e.length?"&"+e.join("&"):""}function IP(t,e){const r=new CP(t,e);return r.subscribe.bind(r)}class CP{constructor(e,r){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=r,this.task.then(()=>{e(this)}).catch(n=>{this.error(n)})}next(e){this.forEachObserver(r=>{r.next(e)})}error(e){this.forEachObserver(r=>{r.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,r,n){let s;if(e===void 0&&r===void 0&&n===void 0)throw new Error("Missing Observer.");RP(e,["next","error","complete"])?s=e:s={next:e,error:r,complete:n},s.next===void 0&&(s.next=M0),s.error===void 0&&(s.error=M0),s.complete===void 0&&(s.complete=M0);const a=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?s.error(this.finalError):s.complete()}catch{}}),this.observers.push(s),a}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let r=0;r<this.observers.length;r++)this.sendOne(r,e)}sendOne(e,r){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{r(this.observers[e])}catch(n){typeof console<"u"&&console.error&&console.error(n)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function RP(t,e){if(typeof t!="object"||t===null)return!1;for(const r of e)if(r in t&&typeof t[r]=="function")return!0;return!1}function M0(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ht(t){return t&&t._delegate?t._delegate:t}class ua{constructor(e,r,n){this.name=e,this.instanceFactory=r,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wi="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class NP{constructor(e,r){this.name=e,this.container=r,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const r=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(r)){const n=new dP;if(this.instancesDeferred.set(r,n),this.isInitialized(r)||this.shouldAutoInitialize())try{const s=this.getOrInitializeService({instanceIdentifier:r});s&&n.resolve(s)}catch{}}return this.instancesDeferred.get(r).promise}getImmediate(e){var r;const n=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),s=(r=e==null?void 0:e.optional)!==null&&r!==void 0?r:!1;if(this.isInitialized(n)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:n})}catch(a){if(s)return null;throw a}else{if(s)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(bP(e))try{this.getOrInitializeService({instanceIdentifier:wi})}catch{}for(const[r,n]of this.instancesDeferred.entries()){const s=this.normalizeInstanceIdentifier(r);try{const a=this.getOrInitializeService({instanceIdentifier:s});n.resolve(a)}catch{}}}}clearInstance(e=wi){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(r=>"INTERNAL"in r).map(r=>r.INTERNAL.delete()),...e.filter(r=>"_delete"in r).map(r=>r._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=wi){return this.instances.has(e)}getOptions(e=wi){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:r={}}=e,n=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(n))throw Error(`${this.name}(${n}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const s=this.getOrInitializeService({instanceIdentifier:n,options:r});for(const[a,i]of this.instancesDeferred.entries()){const o=this.normalizeInstanceIdentifier(a);n===o&&i.resolve(s)}return s}onInit(e,r){var n;const s=this.normalizeInstanceIdentifier(r),a=(n=this.onInitCallbacks.get(s))!==null&&n!==void 0?n:new Set;a.add(e),this.onInitCallbacks.set(s,a);const i=this.instances.get(s);return i&&e(i,s),()=>{a.delete(e)}}invokeOnInitCallbacks(e,r){const n=this.onInitCallbacks.get(r);if(n)for(const s of n)try{s(e,r)}catch{}}getOrInitializeService({instanceIdentifier:e,options:r={}}){let n=this.instances.get(e);if(!n&&this.component&&(n=this.component.instanceFactory(this.container,{instanceIdentifier:PP(e),options:r}),this.instances.set(e,n),this.instancesOptions.set(e,r),this.invokeOnInitCallbacks(n,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,n)}catch{}return n||null}normalizeInstanceIdentifier(e=wi){return this.component?this.component.multipleInstances?e:wi:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function PP(t){return t===wi?void 0:t}function bP(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DP{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const r=this.getProvider(e.name);if(r.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);r.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const r=new NP(e,this);return this.providers.set(e,r),r}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Ye;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(Ye||(Ye={}));const FP={debug:Ye.DEBUG,verbose:Ye.VERBOSE,info:Ye.INFO,warn:Ye.WARN,error:Ye.ERROR,silent:Ye.SILENT},OP=Ye.INFO,MP={[Ye.DEBUG]:"log",[Ye.VERBOSE]:"log",[Ye.INFO]:"info",[Ye.WARN]:"warn",[Ye.ERROR]:"error"},LP=(t,e,...r)=>{if(e<t.logLevel)return;const n=new Date().toISOString(),s=MP[e];if(s)console[s](`[${n}]  ${t.name}:`,...r);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class $g{constructor(e){this.name=e,this._logLevel=OP,this._logHandler=LP,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Ye))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?FP[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Ye.DEBUG,...e),this._logHandler(this,Ye.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Ye.VERBOSE,...e),this._logHandler(this,Ye.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Ye.INFO,...e),this._logHandler(this,Ye.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Ye.WARN,...e),this._logHandler(this,Ye.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Ye.ERROR,...e),this._logHandler(this,Ye.ERROR,...e)}}const jP=(t,e)=>e.some(r=>t instanceof r);let T_,k_;function VP(){return T_||(T_=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function UP(){return k_||(k_=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const FT=new WeakMap,tp=new WeakMap,OT=new WeakMap,L0=new WeakMap,Wg=new WeakMap;function BP(t){const e=new Promise((r,n)=>{const s=()=>{t.removeEventListener("success",a),t.removeEventListener("error",i)},a=()=>{r(Ya(t.result)),s()},i=()=>{n(t.error),s()};t.addEventListener("success",a),t.addEventListener("error",i)});return e.then(r=>{r instanceof IDBCursor&&FT.set(r,t)}).catch(()=>{}),Wg.set(e,t),e}function zP(t){if(tp.has(t))return;const e=new Promise((r,n)=>{const s=()=>{t.removeEventListener("complete",a),t.removeEventListener("error",i),t.removeEventListener("abort",i)},a=()=>{r(),s()},i=()=>{n(t.error||new DOMException("AbortError","AbortError")),s()};t.addEventListener("complete",a),t.addEventListener("error",i),t.addEventListener("abort",i)});tp.set(t,e)}let rp={get(t,e,r){if(t instanceof IDBTransaction){if(e==="done")return tp.get(t);if(e==="objectStoreNames")return t.objectStoreNames||OT.get(t);if(e==="store")return r.objectStoreNames[1]?void 0:r.objectStore(r.objectStoreNames[0])}return Ya(t[e])},set(t,e,r){return t[e]=r,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function $P(t){rp=t(rp)}function WP(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...r){const n=t.call(j0(this),e,...r);return OT.set(n,e.sort?e.sort():[e]),Ya(n)}:UP().includes(t)?function(...e){return t.apply(j0(this),e),Ya(FT.get(this))}:function(...e){return Ya(t.apply(j0(this),e))}}function HP(t){return typeof t=="function"?WP(t):(t instanceof IDBTransaction&&zP(t),jP(t,VP())?new Proxy(t,rp):t)}function Ya(t){if(t instanceof IDBRequest)return BP(t);if(L0.has(t))return L0.get(t);const e=HP(t);return e!==t&&(L0.set(t,e),Wg.set(e,t)),e}const j0=t=>Wg.get(t);function GP(t,e,{blocked:r,upgrade:n,blocking:s,terminated:a}={}){const i=indexedDB.open(t,e),o=Ya(i);return n&&i.addEventListener("upgradeneeded",l=>{n(Ya(i.result),l.oldVersion,l.newVersion,Ya(i.transaction),l)}),r&&i.addEventListener("blocked",l=>r(l.oldVersion,l.newVersion,l)),o.then(l=>{a&&l.addEventListener("close",()=>a()),s&&l.addEventListener("versionchange",c=>s(c.oldVersion,c.newVersion,c))}).catch(()=>{}),o}const KP=["get","getKey","getAll","getAllKeys","count"],qP=["put","add","delete","clear"],V0=new Map;function S_(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(V0.get(e))return V0.get(e);const r=e.replace(/FromIndex$/,""),n=e!==r,s=qP.includes(r);if(!(r in(n?IDBIndex:IDBObjectStore).prototype)||!(s||KP.includes(r)))return;const a=async function(i,...o){const l=this.transaction(i,s?"readwrite":"readonly");let c=l.store;return n&&(c=c.index(o.shift())),(await Promise.all([c[r](...o),s&&l.done]))[0]};return V0.set(e,a),a}$P(t=>({...t,get:(e,r,n)=>S_(e,r)||t.get(e,r,n),has:(e,r)=>!!S_(e,r)||t.has(e,r)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XP{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(r=>{if(YP(r)){const n=r.getImmediate();return`${n.library}/${n.version}`}else return null}).filter(r=>r).join(" ")}}function YP(t){const e=t.getComponent();return(e==null?void 0:e.type)==="VERSION"}const np="@firebase/app",A_="0.10.13";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fa=new $g("@firebase/app"),QP="@firebase/app-compat",JP="@firebase/analytics-compat",ZP="@firebase/analytics",eb="@firebase/app-check-compat",tb="@firebase/app-check",rb="@firebase/auth",nb="@firebase/auth-compat",sb="@firebase/database",ab="@firebase/data-connect",ib="@firebase/database-compat",ob="@firebase/functions",lb="@firebase/functions-compat",cb="@firebase/installations",ub="@firebase/installations-compat",fb="@firebase/messaging",hb="@firebase/messaging-compat",db="@firebase/performance",mb="@firebase/performance-compat",pb="@firebase/remote-config",gb="@firebase/remote-config-compat",vb="@firebase/storage",xb="@firebase/storage-compat",_b="@firebase/firestore",yb="@firebase/vertexai-preview",wb="@firebase/firestore-compat",Eb="firebase",Tb="10.14.1";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sp="[DEFAULT]",kb={[np]:"fire-core",[QP]:"fire-core-compat",[ZP]:"fire-analytics",[JP]:"fire-analytics-compat",[tb]:"fire-app-check",[eb]:"fire-app-check-compat",[rb]:"fire-auth",[nb]:"fire-auth-compat",[sb]:"fire-rtdb",[ab]:"fire-data-connect",[ib]:"fire-rtdb-compat",[ob]:"fire-fn",[lb]:"fire-fn-compat",[cb]:"fire-iid",[ub]:"fire-iid-compat",[fb]:"fire-fcm",[hb]:"fire-fcm-compat",[db]:"fire-perf",[mb]:"fire-perf-compat",[pb]:"fire-rc",[gb]:"fire-rc-compat",[vb]:"fire-gcs",[xb]:"fire-gcs-compat",[_b]:"fire-fst",[wb]:"fire-fst-compat",[yb]:"fire-vertex","fire-js":"fire-js",[Eb]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bh=new Map,Sb=new Map,ap=new Map;function I_(t,e){try{t.container.addComponent(e)}catch(r){fa.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,r)}}function ri(t){const e=t.name;if(ap.has(e))return fa.debug(`There were multiple attempts to register component ${e}.`),!1;ap.set(e,t);for(const r of bh.values())I_(r,t);for(const r of Sb.values())I_(r,t);return!0}function Eu(t,e){const r=t.container.getProvider("heartbeat").getImmediate({optional:!0});return r&&r.triggerHeartbeat(),t.container.getProvider(e)}function qs(t){return t.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ab={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Qa=new yu("app","Firebase",Ab);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ib{constructor(e,r,n){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},r),this._name=r.name,this._automaticDataCollectionEnabled=r.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new ua("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Qa.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Zi=Tb;function MT(t,e={}){let r=t;typeof e!="object"&&(e={name:e});const n=Object.assign({name:sp,automaticDataCollectionEnabled:!1},e),s=n.name;if(typeof s!="string"||!s)throw Qa.create("bad-app-name",{appName:String(s)});if(r||(r=PT()),!r)throw Qa.create("no-options");const a=bh.get(s);if(a){if(Ph(r,a.options)&&Ph(n,a.config))return a;throw Qa.create("duplicate-app",{appName:s})}const i=new DP(s);for(const l of ap.values())i.addComponent(l);const o=new Ib(r,n,i);return bh.set(s,o),o}function Cd(t=sp){const e=bh.get(t);if(!e&&t===sp&&PT())return MT();if(!e)throw Qa.create("no-app",{appName:t});return e}function Vn(t,e,r){var n;let s=(n=kb[t])!==null&&n!==void 0?n:t;r&&(s+=`-${r}`);const a=s.match(/\s|\//),i=e.match(/\s|\//);if(a||i){const o=[`Unable to register library "${s}" with version "${e}":`];a&&o.push(`library name "${s}" contains illegal characters (whitespace or "/")`),a&&i&&o.push("and"),i&&o.push(`version name "${e}" contains illegal characters (whitespace or "/")`),fa.warn(o.join(" "));return}ri(new ua(`${s}-version`,()=>({library:s,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Cb="firebase-heartbeat-database",Rb=1,Xc="firebase-heartbeat-store";let U0=null;function LT(){return U0||(U0=GP(Cb,Rb,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(Xc)}catch(r){console.warn(r)}}}}).catch(t=>{throw Qa.create("idb-open",{originalErrorMessage:t.message})})),U0}async function Nb(t){try{const r=(await LT()).transaction(Xc),n=await r.objectStore(Xc).get(jT(t));return await r.done,n}catch(e){if(e instanceof bs)fa.warn(e.message);else{const r=Qa.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});fa.warn(r.message)}}}async function C_(t,e){try{const n=(await LT()).transaction(Xc,"readwrite");await n.objectStore(Xc).put(e,jT(t)),await n.done}catch(r){if(r instanceof bs)fa.warn(r.message);else{const n=Qa.create("idb-set",{originalErrorMessage:r==null?void 0:r.message});fa.warn(n.message)}}}function jT(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Pb=1024,bb=30*24*60*60*1e3;class Db{constructor(e){this.container=e,this._heartbeatsCache=null;const r=this.container.getProvider("app").getImmediate();this._storage=new Ob(r),this._heartbeatsCachePromise=this._storage.read().then(n=>(this._heartbeatsCache=n,n))}async triggerHeartbeat(){var e,r;try{const s=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),a=R_();return((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((r=this._heartbeatsCache)===null||r===void 0?void 0:r.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===a||this._heartbeatsCache.heartbeats.some(i=>i.date===a)?void 0:(this._heartbeatsCache.heartbeats.push({date:a,agent:s}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(i=>{const o=new Date(i.date).valueOf();return Date.now()-o<=bb}),this._storage.overwrite(this._heartbeatsCache))}catch(n){fa.warn(n)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const r=R_(),{heartbeatsToSend:n,unsentEntries:s}=Fb(this._heartbeatsCache.heartbeats),a=Nh(JSON.stringify({version:2,heartbeats:n}));return this._heartbeatsCache.lastSentHeartbeatDate=r,s.length>0?(this._heartbeatsCache.heartbeats=s,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),a}catch(r){return fa.warn(r),""}}}function R_(){return new Date().toISOString().substring(0,10)}function Fb(t,e=Pb){const r=[];let n=t.slice();for(const s of t){const a=r.find(i=>i.agent===s.agent);if(a){if(a.dates.push(s.date),N_(r)>e){a.dates.pop();break}}else if(r.push({agent:s.agent,dates:[s.date]}),N_(r)>e){r.pop();break}n=n.slice(1)}return{heartbeatsToSend:r,unsentEntries:n}}class Ob{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return wP()?EP().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const r=await Nb(this.app);return r!=null&&r.heartbeats?r:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){var r;if(await this._canUseIndexedDBPromise){const s=await this.read();return C_(this.app,{lastSentHeartbeatDate:(r=e.lastSentHeartbeatDate)!==null&&r!==void 0?r:s.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var r;if(await this._canUseIndexedDBPromise){const s=await this.read();return C_(this.app,{lastSentHeartbeatDate:(r=e.lastSentHeartbeatDate)!==null&&r!==void 0?r:s.lastSentHeartbeatDate,heartbeats:[...s.heartbeats,...e.heartbeats]})}else return}}function N_(t){return Nh(JSON.stringify({version:2,heartbeats:t})).length}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Mb(t){ri(new ua("platform-logger",e=>new XP(e),"PRIVATE")),ri(new ua("heartbeat",e=>new Db(e),"PRIVATE")),Vn(np,A_,t),Vn(np,A_,"esm2017"),Vn("fire-js","")}Mb("");function Hg(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,n=Object.getOwnPropertySymbols(t);s<n.length;s++)e.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(t,n[s])&&(r[n[s]]=t[n[s]]);return r}function VT(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const Lb=VT,UT=new yu("auth","Firebase",VT());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Dh=new $g("@firebase/auth");function jb(t,...e){Dh.logLevel<=Ye.WARN&&Dh.warn(`Auth (${Zi}): ${t}`,...e)}function Kf(t,...e){Dh.logLevel<=Ye.ERROR&&Dh.error(`Auth (${Zi}): ${t}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Is(t,...e){throw Kg(t,...e)}function os(t,...e){return Kg(t,...e)}function Gg(t,e,r){const n=Object.assign(Object.assign({},Lb()),{[e]:r});return new yu("auth","Firebase",n).create(e,{appName:t.name})}function Fi(t){return Gg(t,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function Vb(t,e,r){const n=r;if(!(e instanceof n))throw n.name!==e.constructor.name&&Is(t,"argument-error"),Gg(t,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function Kg(t,...e){if(typeof t!="string"){const r=e[0],n=[...e.slice(1)];return n[0]&&(n[0].appName=t.name),t._errorFactory.create(r,...n)}return UT.create(t,...e)}function Me(t,e,...r){if(!t)throw Kg(e,...r)}function Xs(t){const e="INTERNAL ASSERTION FAILED: "+t;throw Kf(e),new Error(e)}function ha(t,e){t||Xs(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ip(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.href)||""}function Ub(){return P_()==="http:"||P_()==="https:"}function P_(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Bb(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(Ub()||vP()||"connection"in navigator)?navigator.onLine:!0}function zb(){if(typeof navigator>"u")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tu{constructor(e,r){this.shortDelay=e,this.longDelay=r,ha(r>e,"Short delay should be less than long delay!"),this.isMobile=mP()||xP()}get(){return Bb()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qg(t,e){ha(t.emulator,"Emulator should always be set here");const{url:r}=t.emulator;return e?`${r}${e.startsWith("/")?e.slice(1):e}`:r}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BT{static initialize(e,r,n){this.fetchImpl=e,r&&(this.headersImpl=r),n&&(this.responseImpl=n)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Xs("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Xs("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Xs("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $b={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Wb=new Tu(3e4,6e4);function Xg(t,e){return t.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:t.tenantId}):e}async function _l(t,e,r,n,s={}){return zT(t,s,async()=>{let a={},i={};n&&(e==="GET"?i=n:a={body:JSON.stringify(n)});const o=wu(Object.assign({key:t.config.apiKey},i)).slice(1),l=await t._getAdditionalHeaders();l["Content-Type"]="application/json",t.languageCode&&(l["X-Firebase-Locale"]=t.languageCode);const c=Object.assign({method:e,headers:l},a);return gP()||(c.referrerPolicy="no-referrer"),BT.fetch()($T(t,t.config.apiHost,r,o),c)})}async function zT(t,e,r){t._canInitEmulator=!1;const n=Object.assign(Object.assign({},$b),e);try{const s=new Gb(t),a=await Promise.race([r(),s.promise]);s.clearNetworkTimeout();const i=await a.json();if("needConfirmation"in i)throw _f(t,"account-exists-with-different-credential",i);if(a.ok&&!("errorMessage"in i))return i;{const o=a.ok?i.errorMessage:i.error.message,[l,c]=o.split(" : ");if(l==="FEDERATED_USER_ID_ALREADY_LINKED")throw _f(t,"credential-already-in-use",i);if(l==="EMAIL_EXISTS")throw _f(t,"email-already-in-use",i);if(l==="USER_DISABLED")throw _f(t,"user-disabled",i);const u=n[l]||l.toLowerCase().replace(/[_\s]+/g,"-");if(c)throw Gg(t,u,c);Is(t,u)}}catch(s){if(s instanceof bs)throw s;Is(t,"network-request-failed",{message:String(s)})}}async function Hb(t,e,r,n,s={}){const a=await _l(t,e,r,n,s);return"mfaPendingCredential"in a&&Is(t,"multi-factor-auth-required",{_serverResponse:a}),a}function $T(t,e,r,n){const s=`${e}${r}?${n}`;return t.config.emulator?qg(t.config,s):`${t.config.apiScheme}://${s}`}class Gb{constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((r,n)=>{this.timer=setTimeout(()=>n(os(this.auth,"network-request-failed")),Wb.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}}function _f(t,e,r){const n={appName:t.name};r.email&&(n.email=r.email),r.phoneNumber&&(n.phoneNumber=r.phoneNumber);const s=os(t,e,n);return s.customData._tokenResponse=r,s}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Kb(t,e){return _l(t,"POST","/v1/accounts:delete",e)}async function WT(t,e){return _l(t,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pc(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function HT(t,e=!1){const r=Ht(t),n=await r.getIdToken(e),s=Yg(n);Me(s&&s.exp&&s.auth_time&&s.iat,r.auth,"internal-error");const a=typeof s.firebase=="object"?s.firebase:void 0,i=a==null?void 0:a.sign_in_provider;return{claims:s,token:n,authTime:pc(B0(s.auth_time)),issuedAtTime:pc(B0(s.iat)),expirationTime:pc(B0(s.exp)),signInProvider:i||null,signInSecondFactor:(a==null?void 0:a.sign_in_second_factor)||null}}function B0(t){return Number(t)*1e3}function Yg(t){const[e,r,n]=t.split(".");if(e===void 0||r===void 0||n===void 0)return Kf("JWT malformed, contained fewer than 3 sections"),null;try{const s=RT(r);return s?JSON.parse(s):(Kf("Failed to decode base64 JWT payload"),null)}catch(s){return Kf("Caught error parsing JWT payload as JSON",s==null?void 0:s.toString()),null}}function b_(t){const e=Yg(t);return Me(e,"internal-error"),Me(typeof e.exp<"u","internal-error"),Me(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Yc(t,e,r=!1){if(r)return e;try{return await e}catch(n){throw n instanceof bs&&qb(n)&&t.auth.currentUser===t&&await t.auth.signOut(),n}}function qb({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xb{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var r;if(e){const n=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),n}else{this.errorBackoff=3e4;const s=((r=this.user.stsTokenManager.expirationTime)!==null&&r!==void 0?r:0)-Date.now()-3e5;return Math.max(0,s)}}schedule(e=!1){if(!this.isRunning)return;const r=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},r)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class op{constructor(e,r){this.createdAt=e,this.lastLoginAt=r,this._initializeTime()}_initializeTime(){this.lastSignInTime=pc(this.lastLoginAt),this.creationTime=pc(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Fh(t){var e;const r=t.auth,n=await t.getIdToken(),s=await Yc(t,WT(r,{idToken:n}));Me(s==null?void 0:s.users.length,r,"internal-error");const a=s.users[0];t._notifyReloadListener(a);const i=!((e=a.providerUserInfo)===null||e===void 0)&&e.length?GT(a.providerUserInfo):[],o=Qb(t.providerData,i),l=t.isAnonymous,c=!(t.email&&a.passwordHash)&&!(o!=null&&o.length),u=l?c:!1,h={uid:a.localId,displayName:a.displayName||null,photoURL:a.photoUrl||null,email:a.email||null,emailVerified:a.emailVerified||!1,phoneNumber:a.phoneNumber||null,tenantId:a.tenantId||null,providerData:o,metadata:new op(a.createdAt,a.lastLoginAt),isAnonymous:u};Object.assign(t,h)}async function Yb(t){const e=Ht(t);await Fh(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function Qb(t,e){return[...t.filter(n=>!e.some(s=>s.providerId===n.providerId)),...e]}function GT(t){return t.map(e=>{var{providerId:r}=e,n=Hg(e,["providerId"]);return{providerId:r,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Jb(t,e){const r=await zT(t,{},async()=>{const n=wu({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:s,apiKey:a}=t.config,i=$T(t,s,"/v1/token",`key=${a}`),o=await t._getAdditionalHeaders();return o["Content-Type"]="application/x-www-form-urlencoded",BT.fetch()(i,{method:"POST",headers:o,body:n})});return{accessToken:r.access_token,expiresIn:r.expires_in,refreshToken:r.refresh_token}}async function Zb(t,e){return _l(t,"POST","/v2/accounts:revokeToken",Xg(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zo{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){Me(e.idToken,"internal-error"),Me(typeof e.idToken<"u","internal-error"),Me(typeof e.refreshToken<"u","internal-error");const r="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):b_(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,r)}updateFromIdToken(e){Me(e.length!==0,"internal-error");const r=b_(e);this.updateTokensAndExpiration(e,null,r)}async getToken(e,r=!1){return!r&&this.accessToken&&!this.isExpired?this.accessToken:(Me(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,r){const{accessToken:n,refreshToken:s,expiresIn:a}=await Jb(e,r);this.updateTokensAndExpiration(n,s,Number(a))}updateTokensAndExpiration(e,r,n){this.refreshToken=r||null,this.accessToken=e||null,this.expirationTime=Date.now()+n*1e3}static fromJSON(e,r){const{refreshToken:n,accessToken:s,expirationTime:a}=r,i=new zo;return n&&(Me(typeof n=="string","internal-error",{appName:e}),i.refreshToken=n),s&&(Me(typeof s=="string","internal-error",{appName:e}),i.accessToken=s),a&&(Me(typeof a=="number","internal-error",{appName:e}),i.expirationTime=a),i}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new zo,this.toJSON())}_performRefresh(){return Xs("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Sa(t,e){Me(typeof t=="string"||typeof t>"u","internal-error",{appName:e})}class Ys{constructor(e){var{uid:r,auth:n,stsTokenManager:s}=e,a=Hg(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new Xb(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=r,this.auth=n,this.stsTokenManager=s,this.accessToken=s.accessToken,this.displayName=a.displayName||null,this.email=a.email||null,this.emailVerified=a.emailVerified||!1,this.phoneNumber=a.phoneNumber||null,this.photoURL=a.photoURL||null,this.isAnonymous=a.isAnonymous||!1,this.tenantId=a.tenantId||null,this.providerData=a.providerData?[...a.providerData]:[],this.metadata=new op(a.createdAt||void 0,a.lastLoginAt||void 0)}async getIdToken(e){const r=await Yc(this,this.stsTokenManager.getToken(this.auth,e));return Me(r,this.auth,"internal-error"),this.accessToken!==r&&(this.accessToken=r,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),r}getIdTokenResult(e){return HT(this,e)}reload(){return Yb(this)}_assign(e){this!==e&&(Me(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(r=>Object.assign({},r)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const r=new Ys(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return r.metadata._copy(this.metadata),r}_onReload(e){Me(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,r=!1){let n=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),n=!0),r&&await Fh(this),await this.auth._persistUserIfCurrent(this),n&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(qs(this.auth.app))return Promise.reject(Fi(this.auth));const e=await this.getIdToken();return await Yc(this,Kb(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,r){var n,s,a,i,o,l,c,u;const h=(n=r.displayName)!==null&&n!==void 0?n:void 0,m=(s=r.email)!==null&&s!==void 0?s:void 0,p=(a=r.phoneNumber)!==null&&a!==void 0?a:void 0,x=(i=r.photoURL)!==null&&i!==void 0?i:void 0,v=(o=r.tenantId)!==null&&o!==void 0?o:void 0,w=(l=r._redirectEventId)!==null&&l!==void 0?l:void 0,k=(c=r.createdAt)!==null&&c!==void 0?c:void 0,T=(u=r.lastLoginAt)!==null&&u!==void 0?u:void 0,{uid:E,emailVerified:N,isAnonymous:O,providerData:M,stsTokenManager:g}=r;Me(E&&g,e,"internal-error");const y=zo.fromJSON(this.name,g);Me(typeof E=="string",e,"internal-error"),Sa(h,e.name),Sa(m,e.name),Me(typeof N=="boolean",e,"internal-error"),Me(typeof O=="boolean",e,"internal-error"),Sa(p,e.name),Sa(x,e.name),Sa(v,e.name),Sa(w,e.name),Sa(k,e.name),Sa(T,e.name);const S=new Ys({uid:E,auth:e,email:m,emailVerified:N,displayName:h,isAnonymous:O,photoURL:x,phoneNumber:p,tenantId:v,stsTokenManager:y,createdAt:k,lastLoginAt:T});return M&&Array.isArray(M)&&(S.providerData=M.map(R=>Object.assign({},R))),w&&(S._redirectEventId=w),S}static async _fromIdTokenResponse(e,r,n=!1){const s=new zo;s.updateFromServerResponse(r);const a=new Ys({uid:r.localId,auth:e,stsTokenManager:s,isAnonymous:n});return await Fh(a),a}static async _fromGetAccountInfoResponse(e,r,n){const s=r.users[0];Me(s.localId!==void 0,"internal-error");const a=s.providerUserInfo!==void 0?GT(s.providerUserInfo):[],i=!(s.email&&s.passwordHash)&&!(a!=null&&a.length),o=new zo;o.updateFromIdToken(n);const l=new Ys({uid:s.localId,auth:e,stsTokenManager:o,isAnonymous:i}),c={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:a,metadata:new op(s.createdAt,s.lastLoginAt),isAnonymous:!(s.email&&s.passwordHash)&&!(a!=null&&a.length)};return Object.assign(l,c),l}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const D_=new Map;function Qs(t){ha(t instanceof Function,"Expected a class definition");let e=D_.get(t);return e?(ha(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,D_.set(t,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class KT{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,r){this.storage[e]=r}async _get(e){const r=this.storage[e];return r===void 0?null:r}async _remove(e){delete this.storage[e]}_addListener(e,r){}_removeListener(e,r){}}KT.type="NONE";const F_=KT;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qf(t,e,r){return`firebase:${t}:${e}:${r}`}class $o{constructor(e,r,n){this.persistence=e,this.auth=r,this.userKey=n;const{config:s,name:a}=this.auth;this.fullUserKey=qf(this.userKey,s.apiKey,a),this.fullPersistenceKey=qf("persistence",s.apiKey,a),this.boundEventHandler=r._onStorageEvent.bind(r),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);return e?Ys._fromJSON(this.auth,e):null}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const r=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,r)return this.setCurrentUser(r)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,r,n="authUser"){if(!r.length)return new $o(Qs(F_),e,n);const s=(await Promise.all(r.map(async c=>{if(await c._isAvailable())return c}))).filter(c=>c);let a=s[0]||Qs(F_);const i=qf(n,e.config.apiKey,e.name);let o=null;for(const c of r)try{const u=await c._get(i);if(u){const h=Ys._fromJSON(e,u);c!==a&&(o=h),a=c;break}}catch{}const l=s.filter(c=>c._shouldAllowMigration);return!a._shouldAllowMigration||!l.length?new $o(a,e,n):(a=l[0],o&&await a._set(i,o.toJSON()),await Promise.all(r.map(async c=>{if(c!==a)try{await c._remove(i)}catch{}})),new $o(a,e,n))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function O_(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(QT(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(qT(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(ZT(e))return"Blackberry";if(ek(e))return"Webos";if(XT(e))return"Safari";if((e.includes("chrome/")||YT(e))&&!e.includes("edge/"))return"Chrome";if(JT(e))return"Android";{const r=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,n=t.match(r);if((n==null?void 0:n.length)===2)return n[1]}return"Other"}function qT(t=zr()){return/firefox\//i.test(t)}function XT(t=zr()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function YT(t=zr()){return/crios\//i.test(t)}function QT(t=zr()){return/iemobile/i.test(t)}function JT(t=zr()){return/android/i.test(t)}function ZT(t=zr()){return/blackberry/i.test(t)}function ek(t=zr()){return/webos/i.test(t)}function Qg(t=zr()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function eD(t=zr()){var e;return Qg(t)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function tD(){return _P()&&document.documentMode===10}function tk(t=zr()){return Qg(t)||JT(t)||ek(t)||ZT(t)||/windows phone/i.test(t)||QT(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rk(t,e=[]){let r;switch(t){case"Browser":r=O_(zr());break;case"Worker":r=`${O_(zr())}-${t}`;break;default:r=t}const n=e.length?e.join(","):"FirebaseCore-web";return`${r}/JsCore/${Zi}/${n}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rD{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,r){const n=a=>new Promise((i,o)=>{try{const l=e(a);i(l)}catch(l){o(l)}});n.onAbort=r,this.queue.push(n);const s=this.queue.length-1;return()=>{this.queue[s]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const r=[];try{for(const n of this.queue)await n(e),n.onAbort&&r.push(n.onAbort)}catch(n){r.reverse();for(const s of r)try{s()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:n==null?void 0:n.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function nD(t,e={}){return _l(t,"GET","/v2/passwordPolicy",Xg(t,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sD=6;class aD{constructor(e){var r,n,s,a;const i=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(r=i.minPasswordLength)!==null&&r!==void 0?r:sD,i.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=i.maxPasswordLength),i.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=i.containsLowercaseCharacter),i.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=i.containsUppercaseCharacter),i.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=i.containsNumericCharacter),i.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=i.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(s=(n=e.allowedNonAlphanumericCharacters)===null||n===void 0?void 0:n.join(""))!==null&&s!==void 0?s:"",this.forceUpgradeOnSignin=(a=e.forceUpgradeOnSignin)!==null&&a!==void 0?a:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var r,n,s,a,i,o;const l={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,l),this.validatePasswordCharacterOptions(e,l),l.isValid&&(l.isValid=(r=l.meetsMinPasswordLength)!==null&&r!==void 0?r:!0),l.isValid&&(l.isValid=(n=l.meetsMaxPasswordLength)!==null&&n!==void 0?n:!0),l.isValid&&(l.isValid=(s=l.containsLowercaseLetter)!==null&&s!==void 0?s:!0),l.isValid&&(l.isValid=(a=l.containsUppercaseLetter)!==null&&a!==void 0?a:!0),l.isValid&&(l.isValid=(i=l.containsNumericCharacter)!==null&&i!==void 0?i:!0),l.isValid&&(l.isValid=(o=l.containsNonAlphanumericCharacter)!==null&&o!==void 0?o:!0),l}validatePasswordLengthOptions(e,r){const n=this.customStrengthOptions.minPasswordLength,s=this.customStrengthOptions.maxPasswordLength;n&&(r.meetsMinPasswordLength=e.length>=n),s&&(r.meetsMaxPasswordLength=e.length<=s)}validatePasswordCharacterOptions(e,r){this.updatePasswordCharacterOptionsStatuses(r,!1,!1,!1,!1);let n;for(let s=0;s<e.length;s++)n=e.charAt(s),this.updatePasswordCharacterOptionsStatuses(r,n>="a"&&n<="z",n>="A"&&n<="Z",n>="0"&&n<="9",this.allowedNonAlphanumericCharacters.includes(n))}updatePasswordCharacterOptionsStatuses(e,r,n,s,a){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=r)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=n)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=s)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=a))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iD{constructor(e,r,n,s){this.app=e,this.heartbeatServiceProvider=r,this.appCheckServiceProvider=n,this.config=s,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new M_(this),this.idTokenSubscription=new M_(this),this.beforeStateQueue=new rD(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=UT,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=s.sdkClientVersion}_initializeWithPersistence(e,r){return r&&(this._popupRedirectResolver=Qs(r)),this._initializationPromise=this.queue(async()=>{var n,s;if(!this._deleted&&(this.persistenceManager=await $o.create(this,e),!this._deleted)){if(!((n=this._popupRedirectResolver)===null||n===void 0)&&n._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(r),this.lastNotifiedUid=((s=this.currentUser)===null||s===void 0?void 0:s.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const r=await WT(this,{idToken:e}),n=await Ys._fromGetAccountInfoResponse(this,r,e);await this.directlySetCurrentUser(n)}catch(r){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",r),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var r;if(qs(this.app)){const i=this.app.settings.authIdToken;return i?new Promise(o=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(i).then(o,o))}):this.directlySetCurrentUser(null)}const n=await this.assertedPersistence.getCurrentUser();let s=n,a=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const i=(r=this.redirectUser)===null||r===void 0?void 0:r._redirectEventId,o=s==null?void 0:s._redirectEventId,l=await this.tryRedirectSignIn(e);(!i||i===o)&&(l!=null&&l.user)&&(s=l.user,a=!0)}if(!s)return this.directlySetCurrentUser(null);if(!s._redirectEventId){if(a)try{await this.beforeStateQueue.runMiddleware(s)}catch(i){s=n,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(i))}return s?this.reloadAndSetCurrentUserOrClear(s):this.directlySetCurrentUser(null)}return Me(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===s._redirectEventId?this.directlySetCurrentUser(s):this.reloadAndSetCurrentUserOrClear(s)}async tryRedirectSignIn(e){let r=null;try{r=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return r}async reloadAndSetCurrentUserOrClear(e){try{await Fh(e)}catch(r){if((r==null?void 0:r.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=zb()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(qs(this.app))return Promise.reject(Fi(this));const r=e?Ht(e):null;return r&&Me(r.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(r&&r._clone(this))}async _updateCurrentUser(e,r=!1){if(!this._deleted)return e&&Me(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),r||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return qs(this.app)?Promise.reject(Fi(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return qs(this.app)?Promise.reject(Fi(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(Qs(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const r=this._getPasswordPolicyInternal();return r.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):r.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await nD(this),r=new aD(e);this.tenantId===null?this._projectPasswordPolicy=r:this._tenantPasswordPolicies[this.tenantId]=r}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(e){this._errorFactory=new yu("auth","Firebase",e())}onAuthStateChanged(e,r,n){return this.registerStateListener(this.authStateSubscription,e,r,n)}beforeAuthStateChanged(e,r){return this.beforeStateQueue.pushCallback(e,r)}onIdTokenChanged(e,r,n){return this.registerStateListener(this.idTokenSubscription,e,r,n)}authStateReady(){return new Promise((e,r)=>{if(this.currentUser)e();else{const n=this.onAuthStateChanged(()=>{n(),e()},r)}})}async revokeAccessToken(e){if(this.currentUser){const r=await this.currentUser.getIdToken(),n={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:r};this.tenantId!=null&&(n.tenantId=this.tenantId),await Zb(this,n)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}async _setRedirectUser(e,r){const n=await this.getOrInitRedirectPersistenceManager(r);return e===null?n.removeCurrentUser():n.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const r=e&&Qs(e)||this._popupRedirectResolver;Me(r,this,"argument-error"),this.redirectPersistenceManager=await $o.create(this,[Qs(r._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var r,n;return this._isInitialized&&await this.queue(async()=>{}),((r=this._currentUser)===null||r===void 0?void 0:r._redirectEventId)===e?this._currentUser:((n=this.redirectUser)===null||n===void 0?void 0:n._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,r;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const n=(r=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&r!==void 0?r:null;this.lastNotifiedUid!==n&&(this.lastNotifiedUid=n,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,r,n,s){if(this._deleted)return()=>{};const a=typeof r=="function"?r:r.next.bind(r);let i=!1;const o=this._isInitialized?Promise.resolve():this._initializationPromise;if(Me(o,this,"internal-error"),o.then(()=>{i||a(this.currentUser)}),typeof r=="function"){const l=e.addObserver(r,n,s);return()=>{i=!0,l()}}else{const l=e.addObserver(r);return()=>{i=!0,l()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return Me(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=rk(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const r={"X-Client-Version":this.clientVersion};this.app.options.appId&&(r["X-Firebase-gmpid"]=this.app.options.appId);const n=await((e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader());n&&(r["X-Firebase-Client"]=n);const s=await this._getAppCheckToken();return s&&(r["X-Firebase-AppCheck"]=s),r}async _getAppCheckToken(){var e;const r=await((e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken());return r!=null&&r.error&&jb(`Error while retrieving App Check token: ${r.error}`),r==null?void 0:r.token}}function Rd(t){return Ht(t)}class M_{constructor(e){this.auth=e,this.observer=null,this.addObserver=IP(r=>this.observer=r)}get next(){return Me(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Jg={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function oD(t){Jg=t}function lD(t){return Jg.loadJS(t)}function cD(){return Jg.gapiScript}function uD(t){return`__${t}${Math.floor(Math.random()*1e6)}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fD(t,e){const r=Eu(t,"auth");if(r.isInitialized()){const s=r.getImmediate(),a=r.getOptions();if(Ph(a,e??{}))return s;Is(s,"already-initialized")}return r.initialize({options:e})}function hD(t,e){const r=(e==null?void 0:e.persistence)||[],n=(Array.isArray(r)?r:[r]).map(Qs);e!=null&&e.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(n,e==null?void 0:e.popupRedirectResolver)}function dD(t,e,r){const n=Rd(t);Me(n._canInitEmulator,n,"emulator-config-failed"),Me(/^https?:\/\//.test(e),n,"invalid-emulator-scheme");const s=!1,a=nk(e),{host:i,port:o}=mD(e),l=o===null?"":`:${o}`;n.config.emulator={url:`${a}//${i}${l}/`},n.settings.appVerificationDisabledForTesting=!0,n.emulatorConfig=Object.freeze({host:i,port:o,protocol:a.replace(":",""),options:Object.freeze({disableWarnings:s})}),pD()}function nk(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function mD(t){const e=nk(t),r=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!r)return{host:"",port:null};const n=r[2].split("@").pop()||"",s=/^(\[[^\]]+\])(:|$)/.exec(n);if(s){const a=s[1];return{host:a,port:L_(n.substr(a.length+1))}}else{const[a,i]=n.split(":");return{host:a,port:L_(i)}}}function L_(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}function pD(){function t(){const e=document.createElement("p"),r=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",r.position="fixed",r.width="100%",r.backgroundColor="#ffffff",r.border=".1em solid #000000",r.color="#b50000",r.bottom="0px",r.left="0px",r.margin="0px",r.zIndex="10000",r.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",t):t())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sk{constructor(e,r){this.providerId=e,this.signInMethod=r}toJSON(){return Xs("not implemented")}_getIdTokenResponse(e){return Xs("not implemented")}_linkToIdToken(e,r){return Xs("not implemented")}_getReauthenticationResolver(e){return Xs("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Wo(t,e){return Hb(t,"POST","/v1/accounts:signInWithIdp",Xg(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gD="http://localhost";class Wi extends sk{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const r=new Wi(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(r.idToken=e.idToken),e.accessToken&&(r.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(r.nonce=e.nonce),e.pendingToken&&(r.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(r.accessToken=e.oauthToken,r.secret=e.oauthTokenSecret):Is("argument-error"),r}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const r=typeof e=="string"?JSON.parse(e):e,{providerId:n,signInMethod:s}=r,a=Hg(r,["providerId","signInMethod"]);if(!n||!s)return null;const i=new Wi(n,s);return i.idToken=a.idToken||void 0,i.accessToken=a.accessToken||void 0,i.secret=a.secret,i.nonce=a.nonce,i.pendingToken=a.pendingToken||null,i}_getIdTokenResponse(e){const r=this.buildRequest();return Wo(e,r)}_linkToIdToken(e,r){const n=this.buildRequest();return n.idToken=r,Wo(e,n)}_getReauthenticationResolver(e){const r=this.buildRequest();return r.autoCreate=!1,Wo(e,r)}buildRequest(){const e={requestUri:gD,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const r={};this.idToken&&(r.id_token=this.idToken),this.accessToken&&(r.access_token=this.accessToken),this.secret&&(r.oauth_token_secret=this.secret),r.providerId=this.providerId,this.nonce&&!this.pendingToken&&(r.nonce=this.nonce),e.postBody=wu(r)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zg{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ku extends Zg{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ba extends ku{constructor(){super("facebook.com")}static credential(e){return Wi._fromParams({providerId:ba.PROVIDER_ID,signInMethod:ba.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return ba.credentialFromTaggedObject(e)}static credentialFromError(e){return ba.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return ba.credential(e.oauthAccessToken)}catch{return null}}}ba.FACEBOOK_SIGN_IN_METHOD="facebook.com";ba.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ys extends ku{constructor(){super("google.com"),this.addScope("profile")}static credential(e,r){return Wi._fromParams({providerId:ys.PROVIDER_ID,signInMethod:ys.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:r})}static credentialFromResult(e){return ys.credentialFromTaggedObject(e)}static credentialFromError(e){return ys.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:r,oauthAccessToken:n}=e;if(!r&&!n)return null;try{return ys.credential(r,n)}catch{return null}}}ys.GOOGLE_SIGN_IN_METHOD="google.com";ys.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Da extends ku{constructor(){super("github.com")}static credential(e){return Wi._fromParams({providerId:Da.PROVIDER_ID,signInMethod:Da.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Da.credentialFromTaggedObject(e)}static credentialFromError(e){return Da.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Da.credential(e.oauthAccessToken)}catch{return null}}}Da.GITHUB_SIGN_IN_METHOD="github.com";Da.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fa extends ku{constructor(){super("twitter.com")}static credential(e,r){return Wi._fromParams({providerId:Fa.PROVIDER_ID,signInMethod:Fa.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:r})}static credentialFromResult(e){return Fa.credentialFromTaggedObject(e)}static credentialFromError(e){return Fa.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:r,oauthTokenSecret:n}=e;if(!r||!n)return null;try{return Fa.credential(r,n)}catch{return null}}}Fa.TWITTER_SIGN_IN_METHOD="twitter.com";Fa.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sl{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,r,n,s=!1){const a=await Ys._fromIdTokenResponse(e,n,s),i=j_(n);return new sl({user:a,providerId:i,_tokenResponse:n,operationType:r})}static async _forOperation(e,r,n){await e._updateTokensIfNecessary(n,!0);const s=j_(n);return new sl({user:e,providerId:s,_tokenResponse:n,operationType:r})}}function j_(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Oh extends bs{constructor(e,r,n,s){var a;super(r.code,r.message),this.operationType=n,this.user=s,Object.setPrototypeOf(this,Oh.prototype),this.customData={appName:e.name,tenantId:(a=e.tenantId)!==null&&a!==void 0?a:void 0,_serverResponse:r.customData._serverResponse,operationType:n}}static _fromErrorAndOperation(e,r,n,s){return new Oh(e,r,n,s)}}function ak(t,e,r,n){return(e==="reauthenticate"?r._getReauthenticationResolver(t):r._getIdTokenResponse(t)).catch(a=>{throw a.code==="auth/multi-factor-auth-required"?Oh._fromErrorAndOperation(t,a,e,n):a})}async function vD(t,e,r=!1){const n=await Yc(t,e._linkToIdToken(t.auth,await t.getIdToken()),r);return sl._forOperation(t,"link",n)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function xD(t,e,r=!1){const{auth:n}=t;if(qs(n.app))return Promise.reject(Fi(n));const s="reauthenticate";try{const a=await Yc(t,ak(n,s,e,t),r);Me(a.idToken,n,"internal-error");const i=Yg(a.idToken);Me(i,n,"internal-error");const{sub:o}=i;return Me(t.uid===o,n,"user-mismatch"),sl._forOperation(t,s,a)}catch(a){throw(a==null?void 0:a.code)==="auth/user-not-found"&&Is(n,"user-mismatch"),a}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function _D(t,e,r=!1){if(qs(t.app))return Promise.reject(Fi(t));const n="signIn",s=await ak(t,n,e),a=await sl._fromIdTokenResponse(t,n,s);return r||await t._updateCurrentUser(a.user),a}function yD(t,e,r,n){return Ht(t).onIdTokenChanged(e,r,n)}function wD(t,e,r){return Ht(t).beforeAuthStateChanged(e,r)}function ik(t,e,r,n){return Ht(t).onAuthStateChanged(e,r,n)}function ED(t){return Ht(t).signOut()}const Mh="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ok{constructor(e,r){this.storageRetriever=e,this.type=r}_isAvailable(){try{return this.storage?(this.storage.setItem(Mh,"1"),this.storage.removeItem(Mh),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,r){return this.storage.setItem(e,JSON.stringify(r)),Promise.resolve()}_get(e){const r=this.storage.getItem(e);return Promise.resolve(r?JSON.parse(r):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const TD=1e3,kD=10;class lk extends ok{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,r)=>this.onStorageEvent(e,r),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=tk(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const r of Object.keys(this.listeners)){const n=this.storage.getItem(r),s=this.localCache[r];n!==s&&e(r,s,n)}}onStorageEvent(e,r=!1){if(!e.key){this.forAllChangedKeys((i,o,l)=>{this.notifyListeners(i,l)});return}const n=e.key;r?this.detachListener():this.stopPolling();const s=()=>{const i=this.storage.getItem(n);!r&&this.localCache[n]===i||this.notifyListeners(n,i)},a=this.storage.getItem(n);tD()&&a!==e.newValue&&e.newValue!==e.oldValue?setTimeout(s,kD):s()}notifyListeners(e,r){this.localCache[e]=r;const n=this.listeners[e];if(n)for(const s of Array.from(n))s(r&&JSON.parse(r))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,r,n)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:r,newValue:n}),!0)})},TD)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,r){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(r)}_removeListener(e,r){this.listeners[e]&&(this.listeners[e].delete(r),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,r){await super._set(e,r),this.localCache[e]=JSON.stringify(r)}async _get(e){const r=await super._get(e);return this.localCache[e]=JSON.stringify(r),r}async _remove(e){await super._remove(e),delete this.localCache[e]}}lk.type="LOCAL";const SD=lk;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ck extends ok{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,r){}_removeListener(e,r){}}ck.type="SESSION";const uk=ck;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function AD(t){return Promise.all(t.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(r){return{fulfilled:!1,reason:r}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nd{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const r=this.receivers.find(s=>s.isListeningto(e));if(r)return r;const n=new Nd(e);return this.receivers.push(n),n}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const r=e,{eventId:n,eventType:s,data:a}=r.data,i=this.handlersMap[s];if(!(i!=null&&i.size))return;r.ports[0].postMessage({status:"ack",eventId:n,eventType:s});const o=Array.from(i).map(async c=>c(r.origin,a)),l=await AD(o);r.ports[0].postMessage({status:"done",eventId:n,eventType:s,response:l})}_subscribe(e,r){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(r)}_unsubscribe(e,r){this.handlersMap[e]&&r&&this.handlersMap[e].delete(r),(!r||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}Nd.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ev(t="",e=10){let r="";for(let n=0;n<e;n++)r+=Math.floor(Math.random()*10);return t+r}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ID{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,r,n=50){const s=typeof MessageChannel<"u"?new MessageChannel:null;if(!s)throw new Error("connection_unavailable");let a,i;return new Promise((o,l)=>{const c=ev("",20);s.port1.start();const u=setTimeout(()=>{l(new Error("unsupported_event"))},n);i={messageChannel:s,onMessage(h){const m=h;if(m.data.eventId===c)switch(m.data.status){case"ack":clearTimeout(u),a=setTimeout(()=>{l(new Error("timeout"))},3e3);break;case"done":clearTimeout(a),o(m.data.response);break;default:clearTimeout(u),clearTimeout(a),l(new Error("invalid_response"));break}}},this.handlers.add(i),s.port1.addEventListener("message",i.onMessage),this.target.postMessage({eventType:e,eventId:c,data:r},[s.port2])}).finally(()=>{i&&this.removeMessageHandler(i)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ks(){return window}function CD(t){ks().location.href=t}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fk(){return typeof ks().WorkerGlobalScope<"u"&&typeof ks().importScripts=="function"}async function RD(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function ND(){var t;return((t=navigator==null?void 0:navigator.serviceWorker)===null||t===void 0?void 0:t.controller)||null}function PD(){return fk()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hk="firebaseLocalStorageDb",bD=1,Lh="firebaseLocalStorage",dk="fbase_key";class Su{constructor(e){this.request=e}toPromise(){return new Promise((e,r)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{r(this.request.error)})})}}function Pd(t,e){return t.transaction([Lh],e?"readwrite":"readonly").objectStore(Lh)}function DD(){const t=indexedDB.deleteDatabase(hk);return new Su(t).toPromise()}function lp(){const t=indexedDB.open(hk,bD);return new Promise((e,r)=>{t.addEventListener("error",()=>{r(t.error)}),t.addEventListener("upgradeneeded",()=>{const n=t.result;try{n.createObjectStore(Lh,{keyPath:dk})}catch(s){r(s)}}),t.addEventListener("success",async()=>{const n=t.result;n.objectStoreNames.contains(Lh)?e(n):(n.close(),await DD(),e(await lp()))})})}async function V_(t,e,r){const n=Pd(t,!0).put({[dk]:e,value:r});return new Su(n).toPromise()}async function FD(t,e){const r=Pd(t,!1).get(e),n=await new Su(r).toPromise();return n===void 0?null:n.value}function U_(t,e){const r=Pd(t,!0).delete(e);return new Su(r).toPromise()}const OD=800,MD=3;class mk{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await lp(),this.db)}async _withRetries(e){let r=0;for(;;)try{const n=await this._openDb();return await e(n)}catch(n){if(r++>MD)throw n;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return fk()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=Nd._getInstance(PD()),this.receiver._subscribe("keyChanged",async(e,r)=>({keyProcessed:(await this._poll()).includes(r.key)})),this.receiver._subscribe("ping",async(e,r)=>["keyChanged"])}async initializeSender(){var e,r;if(this.activeServiceWorker=await RD(),!this.activeServiceWorker)return;this.sender=new ID(this.activeServiceWorker);const n=await this.sender._send("ping",{},800);n&&!((e=n[0])===null||e===void 0)&&e.fulfilled&&!((r=n[0])===null||r===void 0)&&r.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||ND()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await lp();return await V_(e,Mh,"1"),await U_(e,Mh),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,r){return this._withPendingWrite(async()=>(await this._withRetries(n=>V_(n,e,r)),this.localCache[e]=r,this.notifyServiceWorker(e)))}async _get(e){const r=await this._withRetries(n=>FD(n,e));return this.localCache[e]=r,r}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(r=>U_(r,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(s=>{const a=Pd(s,!1).getAll();return new Su(a).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const r=[],n=new Set;if(e.length!==0)for(const{fbase_key:s,value:a}of e)n.add(s),JSON.stringify(this.localCache[s])!==JSON.stringify(a)&&(this.notifyListeners(s,a),r.push(s));for(const s of Object.keys(this.localCache))this.localCache[s]&&!n.has(s)&&(this.notifyListeners(s,null),r.push(s));return r}notifyListeners(e,r){this.localCache[e]=r;const n=this.listeners[e];if(n)for(const s of Array.from(n))s(r)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),OD)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,r){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(r)}_removeListener(e,r){this.listeners[e]&&(this.listeners[e].delete(r),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}mk.type="LOCAL";const LD=mk;new Tu(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pk(t,e){return e?Qs(e):(Me(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tv extends sk{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Wo(e,this._buildIdpRequest())}_linkToIdToken(e,r){return Wo(e,this._buildIdpRequest(r))}_getReauthenticationResolver(e){return Wo(e,this._buildIdpRequest())}_buildIdpRequest(e){const r={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(r.idToken=e),r}}function jD(t){return _D(t.auth,new tv(t),t.bypassAuthState)}function VD(t){const{auth:e,user:r}=t;return Me(r,e,"internal-error"),xD(r,new tv(t),t.bypassAuthState)}async function UD(t){const{auth:e,user:r}=t;return Me(r,e,"internal-error"),vD(r,new tv(t),t.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gk{constructor(e,r,n,s,a=!1){this.auth=e,this.resolver=n,this.user=s,this.bypassAuthState=a,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(r)?r:[r]}execute(){return new Promise(async(e,r)=>{this.pendingPromise={resolve:e,reject:r};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(n){this.reject(n)}})}async onAuthEvent(e){const{urlResponse:r,sessionId:n,postBody:s,tenantId:a,error:i,type:o}=e;if(i){this.reject(i);return}const l={auth:this.auth,requestUri:r,sessionId:n,tenantId:a||void 0,postBody:s||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(o)(l))}catch(c){this.reject(c)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return jD;case"linkViaPopup":case"linkViaRedirect":return UD;case"reauthViaPopup":case"reauthViaRedirect":return VD;default:Is(this.auth,"internal-error")}}resolve(e){ha(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){ha(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const BD=new Tu(2e3,1e4);async function vk(t,e,r){if(qs(t.app))return Promise.reject(os(t,"operation-not-supported-in-this-environment"));const n=Rd(t);Vb(t,e,Zg);const s=pk(n,r);return new Ri(n,"signInViaPopup",e,s).executeNotNull()}class Ri extends gk{constructor(e,r,n,s,a){super(e,r,s,a),this.provider=n,this.authWindow=null,this.pollId=null,Ri.currentPopupAction&&Ri.currentPopupAction.cancel(),Ri.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return Me(e,this.auth,"internal-error"),e}async onExecution(){ha(this.filter.length===1,"Popup operations only handle one event");const e=ev();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(r=>{this.reject(r)}),this.resolver._isIframeWebStorageSupported(this.auth,r=>{r||this.reject(os(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)===null||e===void 0?void 0:e.associatedEvent)||null}cancel(){this.reject(os(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Ri.currentPopupAction=null}pollUserCancellation(){const e=()=>{var r,n;if(!((n=(r=this.authWindow)===null||r===void 0?void 0:r.window)===null||n===void 0)&&n.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(os(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,BD.get())};e()}}Ri.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zD="pendingRedirect",Xf=new Map;class $D extends gk{constructor(e,r,n=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],r,void 0,n),this.eventId=null}async execute(){let e=Xf.get(this.auth._key());if(!e){try{const n=await WD(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(n)}catch(r){e=()=>Promise.reject(r)}Xf.set(this.auth._key(),e)}return this.bypassAuthState||Xf.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const r=await this.auth._redirectUserForId(e.eventId);if(r)return this.user=r,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function WD(t,e){const r=KD(e),n=GD(t);if(!await n._isAvailable())return!1;const s=await n._get(r)==="true";return await n._remove(r),s}function HD(t,e){Xf.set(t._key(),e)}function GD(t){return Qs(t._redirectPersistence)}function KD(t){return qf(zD,t.config.apiKey,t.name)}async function qD(t,e,r=!1){if(qs(t.app))return Promise.reject(Fi(t));const n=Rd(t),s=pk(n,e),i=await new $D(n,s,r).execute();return i&&!r&&(delete i.user._redirectEventId,await n._persistUserIfCurrent(i.user),await n._setRedirectUser(null,e)),i}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const XD=10*60*1e3;class YD{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let r=!1;return this.consumers.forEach(n=>{this.isEventForConsumer(e,n)&&(r=!0,this.sendToConsumer(e,n),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!QD(e)||(this.hasHandledPotentialRedirect=!0,r||(this.queuedRedirectEvent=e,r=!0)),r}sendToConsumer(e,r){var n;if(e.error&&!xk(e)){const s=((n=e.error.code)===null||n===void 0?void 0:n.split("auth/")[1])||"internal-error";r.onError(os(this.auth,s))}else r.onAuthEvent(e)}isEventForConsumer(e,r){const n=r.eventId===null||!!e.eventId&&e.eventId===r.eventId;return r.filter.includes(e.type)&&n}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=XD&&this.cachedEventUids.clear(),this.cachedEventUids.has(B_(e))}saveEventToCache(e){this.cachedEventUids.add(B_(e)),this.lastProcessedEventTime=Date.now()}}function B_(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function xk({type:t,error:e}){return t==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function QD(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return xk(t);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function JD(t,e={}){return _l(t,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ZD=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,e3=/^https?/;async function t3(t){if(t.config.emulator)return;const{authorizedDomains:e}=await JD(t);for(const r of e)try{if(r3(r))return}catch{}Is(t,"unauthorized-domain")}function r3(t){const e=ip(),{protocol:r,hostname:n}=new URL(e);if(t.startsWith("chrome-extension://")){const i=new URL(t);return i.hostname===""&&n===""?r==="chrome-extension:"&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):r==="chrome-extension:"&&i.hostname===n}if(!e3.test(r))return!1;if(ZD.test(t))return n===t;const s=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+s+"|"+s+")$","i").test(n)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const n3=new Tu(3e4,6e4);function z_(){const t=ks().___jsl;if(t!=null&&t.H){for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let r=0;r<t.CP.length;r++)t.CP[r]=null}}function s3(t){return new Promise((e,r)=>{var n,s,a;function i(){z_(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{z_(),r(os(t,"network-request-failed"))},timeout:n3.get()})}if(!((s=(n=ks().gapi)===null||n===void 0?void 0:n.iframes)===null||s===void 0)&&s.Iframe)e(gapi.iframes.getContext());else if(!((a=ks().gapi)===null||a===void 0)&&a.load)i();else{const o=uD("iframefcb");return ks()[o]=()=>{gapi.load?i():r(os(t,"network-request-failed"))},lD(`${cD()}?onload=${o}`).catch(l=>r(l))}}).catch(e=>{throw Yf=null,e})}let Yf=null;function a3(t){return Yf=Yf||s3(t),Yf}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const i3=new Tu(5e3,15e3),o3="__/auth/iframe",l3="emulator/auth/iframe",c3={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},u3=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function f3(t){const e=t.config;Me(e.authDomain,t,"auth-domain-config-required");const r=e.emulator?qg(e,l3):`https://${t.config.authDomain}/${o3}`,n={apiKey:e.apiKey,appName:t.name,v:Zi},s=u3.get(t.config.apiHost);s&&(n.eid=s);const a=t._getFrameworks();return a.length&&(n.fw=a.join(",")),`${r}?${wu(n).slice(1)}`}async function h3(t){const e=await a3(t),r=ks().gapi;return Me(r,t,"internal-error"),e.open({where:document.body,url:f3(t),messageHandlersFilter:r.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:c3,dontclear:!0},n=>new Promise(async(s,a)=>{await n.restyle({setHideOnLeave:!1});const i=os(t,"network-request-failed"),o=ks().setTimeout(()=>{a(i)},i3.get());function l(){ks().clearTimeout(o),s(n)}n.ping(l).then(l,()=>{a(i)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const d3={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},m3=500,p3=600,g3="_blank",v3="http://localhost";class $_{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function x3(t,e,r,n=m3,s=p3){const a=Math.max((window.screen.availHeight-s)/2,0).toString(),i=Math.max((window.screen.availWidth-n)/2,0).toString();let o="";const l=Object.assign(Object.assign({},d3),{width:n.toString(),height:s.toString(),top:a,left:i}),c=zr().toLowerCase();r&&(o=YT(c)?g3:r),qT(c)&&(e=e||v3,l.scrollbars="yes");const u=Object.entries(l).reduce((m,[p,x])=>`${m}${p}=${x},`,"");if(eD(c)&&o!=="_self")return _3(e||"",o),new $_(null);const h=window.open(e||"",o,u);Me(h,t,"popup-blocked");try{h.focus()}catch{}return new $_(h)}function _3(t,e){const r=document.createElement("a");r.href=t,r.target=e;const n=document.createEvent("MouseEvent");n.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),r.dispatchEvent(n)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const y3="__/auth/handler",w3="emulator/auth/handler",E3=encodeURIComponent("fac");async function W_(t,e,r,n,s,a){Me(t.config.authDomain,t,"auth-domain-config-required"),Me(t.config.apiKey,t,"invalid-api-key");const i={apiKey:t.config.apiKey,appName:t.name,authType:r,redirectUrl:n,v:Zi,eventId:s};if(e instanceof Zg){e.setDefaultLanguage(t.languageCode),i.providerId=e.providerId||"",AP(e.getCustomParameters())||(i.customParameters=JSON.stringify(e.getCustomParameters()));for(const[u,h]of Object.entries({}))i[u]=h}if(e instanceof ku){const u=e.getScopes().filter(h=>h!=="");u.length>0&&(i.scopes=u.join(","))}t.tenantId&&(i.tid=t.tenantId);const o=i;for(const u of Object.keys(o))o[u]===void 0&&delete o[u];const l=await t._getAppCheckToken(),c=l?`#${E3}=${encodeURIComponent(l)}`:"";return`${T3(t)}?${wu(o).slice(1)}${c}`}function T3({config:t}){return t.emulator?qg(t,w3):`https://${t.authDomain}/${y3}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const z0="webStorageSupport";class k3{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=uk,this._completeRedirectFn=qD,this._overrideRedirectResult=HD}async _openPopup(e,r,n,s){var a;ha((a=this.eventManagers[e._key()])===null||a===void 0?void 0:a.manager,"_initialize() not called before _openPopup()");const i=await W_(e,r,n,ip(),s);return x3(e,i,ev())}async _openRedirect(e,r,n,s){await this._originValidation(e);const a=await W_(e,r,n,ip(),s);return CD(a),new Promise(()=>{})}_initialize(e){const r=e._key();if(this.eventManagers[r]){const{manager:s,promise:a}=this.eventManagers[r];return s?Promise.resolve(s):(ha(a,"If manager is not set, promise should be"),a)}const n=this.initAndGetManager(e);return this.eventManagers[r]={promise:n},n.catch(()=>{delete this.eventManagers[r]}),n}async initAndGetManager(e){const r=await h3(e),n=new YD(e);return r.register("authEvent",s=>(Me(s==null?void 0:s.authEvent,e,"invalid-auth-event"),{status:n.onEvent(s.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:n},this.iframes[e._key()]=r,n}_isIframeWebStorageSupported(e,r){this.iframes[e._key()].send(z0,{type:z0},s=>{var a;const i=(a=s==null?void 0:s[0])===null||a===void 0?void 0:a[z0];i!==void 0&&r(!!i),Is(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const r=e._key();return this.originValidationPromises[r]||(this.originValidationPromises[r]=t3(e)),this.originValidationPromises[r]}get _shouldInitProactively(){return tk()||XT()||Qg()}}const S3=k3;var H_="@firebase/auth",G_="1.7.9";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class A3{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const r=this.auth.onIdTokenChanged(n=>{e((n==null?void 0:n.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,r),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const r=this.internalListeners.get(e);r&&(this.internalListeners.delete(e),r(),this.updateProactiveRefresh())}assertAuthConfigured(){Me(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function I3(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function C3(t){ri(new ua("auth",(e,{options:r})=>{const n=e.getProvider("app").getImmediate(),s=e.getProvider("heartbeat"),a=e.getProvider("app-check-internal"),{apiKey:i,authDomain:o}=n.options;Me(i&&!i.includes(":"),"invalid-api-key",{appName:n.name});const l={apiKey:i,authDomain:o,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:rk(t)},c=new iD(n,s,a,l);return hD(c,r),c},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,r,n)=>{e.getProvider("auth-internal").initialize()})),ri(new ua("auth-internal",e=>{const r=Rd(e.getProvider("auth").getImmediate());return(n=>new A3(n))(r)},"PRIVATE").setInstantiationMode("EXPLICIT")),Vn(H_,G_,I3(t)),Vn(H_,G_,"esm2017")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const R3=5*60,N3=bT("authIdTokenMaxAge")||R3;let K_=null;const P3=t=>async e=>{const r=e&&await e.getIdTokenResult(),n=r&&(new Date().getTime()-Date.parse(r.issuedAtTime))/1e3;if(n&&n>N3)return;const s=r==null?void 0:r.token;K_!==s&&(K_=s,await fetch(t,{method:s?"POST":"DELETE",headers:s?{Authorization:`Bearer ${s}`}:{}}))};function b3(t=Cd()){const e=Eu(t,"auth");if(e.isInitialized())return e.getImmediate();const r=fD(t,{popupRedirectResolver:S3,persistence:[LD,SD,uk]}),n=bT("authTokenSyncURL");if(n&&typeof isSecureContext=="boolean"&&isSecureContext){const a=new URL(n,location.origin);if(location.origin===a.origin){const i=P3(a.toString());wD(r,i,()=>i(r.currentUser)),yD(r,o=>i(o))}}const s=NT("auth");return s&&dD(r,`http://${s}`),r}function D3(){var t,e;return(e=(t=document.getElementsByTagName("head"))===null||t===void 0?void 0:t[0])!==null&&e!==void 0?e:document}oD({loadJS(t){return new Promise((e,r)=>{const n=document.createElement("script");n.setAttribute("src",t),n.onload=e,n.onerror=s=>{const a=os("internal-error");a.customData=s,r(a)},n.type="text/javascript",n.charset="UTF-8",D3().appendChild(n)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});C3("Browser");var q_=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Oi,_k;(function(){var t;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(g,y){function S(){}S.prototype=y.prototype,g.D=y.prototype,g.prototype=new S,g.prototype.constructor=g,g.C=function(R,P,b){for(var C=Array(arguments.length-2),oe=2;oe<arguments.length;oe++)C[oe-2]=arguments[oe];return y.prototype[P].apply(R,C)}}function r(){this.blockSize=-1}function n(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(n,r),n.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function s(g,y,S){S||(S=0);var R=Array(16);if(typeof y=="string")for(var P=0;16>P;++P)R[P]=y.charCodeAt(S++)|y.charCodeAt(S++)<<8|y.charCodeAt(S++)<<16|y.charCodeAt(S++)<<24;else for(P=0;16>P;++P)R[P]=y[S++]|y[S++]<<8|y[S++]<<16|y[S++]<<24;y=g.g[0],S=g.g[1],P=g.g[2];var b=g.g[3],C=y+(b^S&(P^b))+R[0]+3614090360&4294967295;y=S+(C<<7&4294967295|C>>>25),C=b+(P^y&(S^P))+R[1]+3905402710&4294967295,b=y+(C<<12&4294967295|C>>>20),C=P+(S^b&(y^S))+R[2]+606105819&4294967295,P=b+(C<<17&4294967295|C>>>15),C=S+(y^P&(b^y))+R[3]+3250441966&4294967295,S=P+(C<<22&4294967295|C>>>10),C=y+(b^S&(P^b))+R[4]+4118548399&4294967295,y=S+(C<<7&4294967295|C>>>25),C=b+(P^y&(S^P))+R[5]+1200080426&4294967295,b=y+(C<<12&4294967295|C>>>20),C=P+(S^b&(y^S))+R[6]+2821735955&4294967295,P=b+(C<<17&4294967295|C>>>15),C=S+(y^P&(b^y))+R[7]+4249261313&4294967295,S=P+(C<<22&4294967295|C>>>10),C=y+(b^S&(P^b))+R[8]+1770035416&4294967295,y=S+(C<<7&4294967295|C>>>25),C=b+(P^y&(S^P))+R[9]+2336552879&4294967295,b=y+(C<<12&4294967295|C>>>20),C=P+(S^b&(y^S))+R[10]+4294925233&4294967295,P=b+(C<<17&4294967295|C>>>15),C=S+(y^P&(b^y))+R[11]+2304563134&4294967295,S=P+(C<<22&4294967295|C>>>10),C=y+(b^S&(P^b))+R[12]+1804603682&4294967295,y=S+(C<<7&4294967295|C>>>25),C=b+(P^y&(S^P))+R[13]+4254626195&4294967295,b=y+(C<<12&4294967295|C>>>20),C=P+(S^b&(y^S))+R[14]+2792965006&4294967295,P=b+(C<<17&4294967295|C>>>15),C=S+(y^P&(b^y))+R[15]+1236535329&4294967295,S=P+(C<<22&4294967295|C>>>10),C=y+(P^b&(S^P))+R[1]+4129170786&4294967295,y=S+(C<<5&4294967295|C>>>27),C=b+(S^P&(y^S))+R[6]+3225465664&4294967295,b=y+(C<<9&4294967295|C>>>23),C=P+(y^S&(b^y))+R[11]+643717713&4294967295,P=b+(C<<14&4294967295|C>>>18),C=S+(b^y&(P^b))+R[0]+3921069994&4294967295,S=P+(C<<20&4294967295|C>>>12),C=y+(P^b&(S^P))+R[5]+3593408605&4294967295,y=S+(C<<5&4294967295|C>>>27),C=b+(S^P&(y^S))+R[10]+38016083&4294967295,b=y+(C<<9&4294967295|C>>>23),C=P+(y^S&(b^y))+R[15]+3634488961&4294967295,P=b+(C<<14&4294967295|C>>>18),C=S+(b^y&(P^b))+R[4]+3889429448&4294967295,S=P+(C<<20&4294967295|C>>>12),C=y+(P^b&(S^P))+R[9]+568446438&4294967295,y=S+(C<<5&4294967295|C>>>27),C=b+(S^P&(y^S))+R[14]+3275163606&4294967295,b=y+(C<<9&4294967295|C>>>23),C=P+(y^S&(b^y))+R[3]+4107603335&4294967295,P=b+(C<<14&4294967295|C>>>18),C=S+(b^y&(P^b))+R[8]+1163531501&4294967295,S=P+(C<<20&4294967295|C>>>12),C=y+(P^b&(S^P))+R[13]+2850285829&4294967295,y=S+(C<<5&4294967295|C>>>27),C=b+(S^P&(y^S))+R[2]+4243563512&4294967295,b=y+(C<<9&4294967295|C>>>23),C=P+(y^S&(b^y))+R[7]+1735328473&4294967295,P=b+(C<<14&4294967295|C>>>18),C=S+(b^y&(P^b))+R[12]+2368359562&4294967295,S=P+(C<<20&4294967295|C>>>12),C=y+(S^P^b)+R[5]+4294588738&4294967295,y=S+(C<<4&4294967295|C>>>28),C=b+(y^S^P)+R[8]+2272392833&4294967295,b=y+(C<<11&4294967295|C>>>21),C=P+(b^y^S)+R[11]+1839030562&4294967295,P=b+(C<<16&4294967295|C>>>16),C=S+(P^b^y)+R[14]+4259657740&4294967295,S=P+(C<<23&4294967295|C>>>9),C=y+(S^P^b)+R[1]+2763975236&4294967295,y=S+(C<<4&4294967295|C>>>28),C=b+(y^S^P)+R[4]+1272893353&4294967295,b=y+(C<<11&4294967295|C>>>21),C=P+(b^y^S)+R[7]+4139469664&4294967295,P=b+(C<<16&4294967295|C>>>16),C=S+(P^b^y)+R[10]+3200236656&4294967295,S=P+(C<<23&4294967295|C>>>9),C=y+(S^P^b)+R[13]+681279174&4294967295,y=S+(C<<4&4294967295|C>>>28),C=b+(y^S^P)+R[0]+3936430074&4294967295,b=y+(C<<11&4294967295|C>>>21),C=P+(b^y^S)+R[3]+3572445317&4294967295,P=b+(C<<16&4294967295|C>>>16),C=S+(P^b^y)+R[6]+76029189&4294967295,S=P+(C<<23&4294967295|C>>>9),C=y+(S^P^b)+R[9]+3654602809&4294967295,y=S+(C<<4&4294967295|C>>>28),C=b+(y^S^P)+R[12]+3873151461&4294967295,b=y+(C<<11&4294967295|C>>>21),C=P+(b^y^S)+R[15]+530742520&4294967295,P=b+(C<<16&4294967295|C>>>16),C=S+(P^b^y)+R[2]+3299628645&4294967295,S=P+(C<<23&4294967295|C>>>9),C=y+(P^(S|~b))+R[0]+4096336452&4294967295,y=S+(C<<6&4294967295|C>>>26),C=b+(S^(y|~P))+R[7]+1126891415&4294967295,b=y+(C<<10&4294967295|C>>>22),C=P+(y^(b|~S))+R[14]+2878612391&4294967295,P=b+(C<<15&4294967295|C>>>17),C=S+(b^(P|~y))+R[5]+4237533241&4294967295,S=P+(C<<21&4294967295|C>>>11),C=y+(P^(S|~b))+R[12]+1700485571&4294967295,y=S+(C<<6&4294967295|C>>>26),C=b+(S^(y|~P))+R[3]+2399980690&4294967295,b=y+(C<<10&4294967295|C>>>22),C=P+(y^(b|~S))+R[10]+4293915773&4294967295,P=b+(C<<15&4294967295|C>>>17),C=S+(b^(P|~y))+R[1]+2240044497&4294967295,S=P+(C<<21&4294967295|C>>>11),C=y+(P^(S|~b))+R[8]+1873313359&4294967295,y=S+(C<<6&4294967295|C>>>26),C=b+(S^(y|~P))+R[15]+4264355552&4294967295,b=y+(C<<10&4294967295|C>>>22),C=P+(y^(b|~S))+R[6]+2734768916&4294967295,P=b+(C<<15&4294967295|C>>>17),C=S+(b^(P|~y))+R[13]+1309151649&4294967295,S=P+(C<<21&4294967295|C>>>11),C=y+(P^(S|~b))+R[4]+4149444226&4294967295,y=S+(C<<6&4294967295|C>>>26),C=b+(S^(y|~P))+R[11]+3174756917&4294967295,b=y+(C<<10&4294967295|C>>>22),C=P+(y^(b|~S))+R[2]+718787259&4294967295,P=b+(C<<15&4294967295|C>>>17),C=S+(b^(P|~y))+R[9]+3951481745&4294967295,g.g[0]=g.g[0]+y&4294967295,g.g[1]=g.g[1]+(P+(C<<21&4294967295|C>>>11))&4294967295,g.g[2]=g.g[2]+P&4294967295,g.g[3]=g.g[3]+b&4294967295}n.prototype.u=function(g,y){y===void 0&&(y=g.length);for(var S=y-this.blockSize,R=this.B,P=this.h,b=0;b<y;){if(P==0)for(;b<=S;)s(this,g,b),b+=this.blockSize;if(typeof g=="string"){for(;b<y;)if(R[P++]=g.charCodeAt(b++),P==this.blockSize){s(this,R),P=0;break}}else for(;b<y;)if(R[P++]=g[b++],P==this.blockSize){s(this,R),P=0;break}}this.h=P,this.o+=y},n.prototype.v=function(){var g=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);g[0]=128;for(var y=1;y<g.length-8;++y)g[y]=0;var S=8*this.o;for(y=g.length-8;y<g.length;++y)g[y]=S&255,S/=256;for(this.u(g),g=Array(16),y=S=0;4>y;++y)for(var R=0;32>R;R+=8)g[S++]=this.g[y]>>>R&255;return g};function a(g,y){var S=o;return Object.prototype.hasOwnProperty.call(S,g)?S[g]:S[g]=y(g)}function i(g,y){this.h=y;for(var S=[],R=!0,P=g.length-1;0<=P;P--){var b=g[P]|0;R&&b==y||(S[P]=b,R=!1)}this.g=S}var o={};function l(g){return-128<=g&&128>g?a(g,function(y){return new i([y|0],0>y?-1:0)}):new i([g|0],0>g?-1:0)}function c(g){if(isNaN(g)||!isFinite(g))return h;if(0>g)return w(c(-g));for(var y=[],S=1,R=0;g>=S;R++)y[R]=g/S|0,S*=4294967296;return new i(y,0)}function u(g,y){if(g.length==0)throw Error("number format error: empty string");if(y=y||10,2>y||36<y)throw Error("radix out of range: "+y);if(g.charAt(0)=="-")return w(u(g.substring(1),y));if(0<=g.indexOf("-"))throw Error('number format error: interior "-" character');for(var S=c(Math.pow(y,8)),R=h,P=0;P<g.length;P+=8){var b=Math.min(8,g.length-P),C=parseInt(g.substring(P,P+b),y);8>b?(b=c(Math.pow(y,b)),R=R.j(b).add(c(C))):(R=R.j(S),R=R.add(c(C)))}return R}var h=l(0),m=l(1),p=l(16777216);t=i.prototype,t.m=function(){if(v(this))return-w(this).m();for(var g=0,y=1,S=0;S<this.g.length;S++){var R=this.i(S);g+=(0<=R?R:4294967296+R)*y,y*=4294967296}return g},t.toString=function(g){if(g=g||10,2>g||36<g)throw Error("radix out of range: "+g);if(x(this))return"0";if(v(this))return"-"+w(this).toString(g);for(var y=c(Math.pow(g,6)),S=this,R="";;){var P=N(S,y).g;S=k(S,P.j(y));var b=((0<S.g.length?S.g[0]:S.h)>>>0).toString(g);if(S=P,x(S))return b+R;for(;6>b.length;)b="0"+b;R=b+R}},t.i=function(g){return 0>g?0:g<this.g.length?this.g[g]:this.h};function x(g){if(g.h!=0)return!1;for(var y=0;y<g.g.length;y++)if(g.g[y]!=0)return!1;return!0}function v(g){return g.h==-1}t.l=function(g){return g=k(this,g),v(g)?-1:x(g)?0:1};function w(g){for(var y=g.g.length,S=[],R=0;R<y;R++)S[R]=~g.g[R];return new i(S,~g.h).add(m)}t.abs=function(){return v(this)?w(this):this},t.add=function(g){for(var y=Math.max(this.g.length,g.g.length),S=[],R=0,P=0;P<=y;P++){var b=R+(this.i(P)&65535)+(g.i(P)&65535),C=(b>>>16)+(this.i(P)>>>16)+(g.i(P)>>>16);R=C>>>16,b&=65535,C&=65535,S[P]=C<<16|b}return new i(S,S[S.length-1]&-2147483648?-1:0)};function k(g,y){return g.add(w(y))}t.j=function(g){if(x(this)||x(g))return h;if(v(this))return v(g)?w(this).j(w(g)):w(w(this).j(g));if(v(g))return w(this.j(w(g)));if(0>this.l(p)&&0>g.l(p))return c(this.m()*g.m());for(var y=this.g.length+g.g.length,S=[],R=0;R<2*y;R++)S[R]=0;for(R=0;R<this.g.length;R++)for(var P=0;P<g.g.length;P++){var b=this.i(R)>>>16,C=this.i(R)&65535,oe=g.i(P)>>>16,ae=g.i(P)&65535;S[2*R+2*P]+=C*ae,T(S,2*R+2*P),S[2*R+2*P+1]+=b*ae,T(S,2*R+2*P+1),S[2*R+2*P+1]+=C*oe,T(S,2*R+2*P+1),S[2*R+2*P+2]+=b*oe,T(S,2*R+2*P+2)}for(R=0;R<y;R++)S[R]=S[2*R+1]<<16|S[2*R];for(R=y;R<2*y;R++)S[R]=0;return new i(S,0)};function T(g,y){for(;(g[y]&65535)!=g[y];)g[y+1]+=g[y]>>>16,g[y]&=65535,y++}function E(g,y){this.g=g,this.h=y}function N(g,y){if(x(y))throw Error("division by zero");if(x(g))return new E(h,h);if(v(g))return y=N(w(g),y),new E(w(y.g),w(y.h));if(v(y))return y=N(g,w(y)),new E(w(y.g),y.h);if(30<g.g.length){if(v(g)||v(y))throw Error("slowDivide_ only works with positive integers.");for(var S=m,R=y;0>=R.l(g);)S=O(S),R=O(R);var P=M(S,1),b=M(R,1);for(R=M(R,2),S=M(S,2);!x(R);){var C=b.add(R);0>=C.l(g)&&(P=P.add(S),b=C),R=M(R,1),S=M(S,1)}return y=k(g,P.j(y)),new E(P,y)}for(P=h;0<=g.l(y);){for(S=Math.max(1,Math.floor(g.m()/y.m())),R=Math.ceil(Math.log(S)/Math.LN2),R=48>=R?1:Math.pow(2,R-48),b=c(S),C=b.j(y);v(C)||0<C.l(g);)S-=R,b=c(S),C=b.j(y);x(b)&&(b=m),P=P.add(b),g=k(g,C)}return new E(P,g)}t.A=function(g){return N(this,g).h},t.and=function(g){for(var y=Math.max(this.g.length,g.g.length),S=[],R=0;R<y;R++)S[R]=this.i(R)&g.i(R);return new i(S,this.h&g.h)},t.or=function(g){for(var y=Math.max(this.g.length,g.g.length),S=[],R=0;R<y;R++)S[R]=this.i(R)|g.i(R);return new i(S,this.h|g.h)},t.xor=function(g){for(var y=Math.max(this.g.length,g.g.length),S=[],R=0;R<y;R++)S[R]=this.i(R)^g.i(R);return new i(S,this.h^g.h)};function O(g){for(var y=g.g.length+1,S=[],R=0;R<y;R++)S[R]=g.i(R)<<1|g.i(R-1)>>>31;return new i(S,g.h)}function M(g,y){var S=y>>5;y%=32;for(var R=g.g.length-S,P=[],b=0;b<R;b++)P[b]=0<y?g.i(b+S)>>>y|g.i(b+S+1)<<32-y:g.i(b+S);return new i(P,g.h)}n.prototype.digest=n.prototype.v,n.prototype.reset=n.prototype.s,n.prototype.update=n.prototype.u,_k=n,i.prototype.add=i.prototype.add,i.prototype.multiply=i.prototype.j,i.prototype.modulo=i.prototype.A,i.prototype.compare=i.prototype.l,i.prototype.toNumber=i.prototype.m,i.prototype.toString=i.prototype.toString,i.prototype.getBits=i.prototype.i,i.fromNumber=c,i.fromString=u,Oi=i}).apply(typeof q_<"u"?q_:typeof self<"u"?self:typeof window<"u"?window:{});var yf=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var yk,Jl,wk,Qf,cp,Ek,Tk,kk;(function(){var t,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(f,_,A){return f==Array.prototype||f==Object.prototype||(f[_]=A.value),f};function r(f){f=[typeof globalThis=="object"&&globalThis,f,typeof window=="object"&&window,typeof self=="object"&&self,typeof yf=="object"&&yf];for(var _=0;_<f.length;++_){var A=f[_];if(A&&A.Math==Math)return A}throw Error("Cannot find global object")}var n=r(this);function s(f,_){if(_)e:{var A=n;f=f.split(".");for(var U=0;U<f.length-1;U++){var ne=f[U];if(!(ne in A))break e;A=A[ne]}f=f[f.length-1],U=A[f],_=_(U),_!=U&&_!=null&&e(A,f,{configurable:!0,writable:!0,value:_})}}function a(f,_){f instanceof String&&(f+="");var A=0,U=!1,ne={next:function(){if(!U&&A<f.length){var ie=A++;return{value:_(ie,f[ie]),done:!1}}return U=!0,{done:!0,value:void 0}}};return ne[Symbol.iterator]=function(){return ne},ne}s("Array.prototype.values",function(f){return f||function(){return a(this,function(_,A){return A})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var i=i||{},o=this||self;function l(f){var _=typeof f;return _=_!="object"?_:f?Array.isArray(f)?"array":_:"null",_=="array"||_=="object"&&typeof f.length=="number"}function c(f){var _=typeof f;return _=="object"&&f!=null||_=="function"}function u(f,_,A){return f.call.apply(f.bind,arguments)}function h(f,_,A){if(!f)throw Error();if(2<arguments.length){var U=Array.prototype.slice.call(arguments,2);return function(){var ne=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(ne,U),f.apply(_,ne)}}return function(){return f.apply(_,arguments)}}function m(f,_,A){return m=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?u:h,m.apply(null,arguments)}function p(f,_){var A=Array.prototype.slice.call(arguments,1);return function(){var U=A.slice();return U.push.apply(U,arguments),f.apply(this,U)}}function x(f,_){function A(){}A.prototype=_.prototype,f.aa=_.prototype,f.prototype=new A,f.prototype.constructor=f,f.Qb=function(U,ne,ie){for(var ke=Array(arguments.length-2),yt=2;yt<arguments.length;yt++)ke[yt-2]=arguments[yt];return _.prototype[ne].apply(U,ke)}}function v(f){const _=f.length;if(0<_){const A=Array(_);for(let U=0;U<_;U++)A[U]=f[U];return A}return[]}function w(f,_){for(let A=1;A<arguments.length;A++){const U=arguments[A];if(l(U)){const ne=f.length||0,ie=U.length||0;f.length=ne+ie;for(let ke=0;ke<ie;ke++)f[ne+ke]=U[ke]}else f.push(U)}}class k{constructor(_,A){this.i=_,this.j=A,this.h=0,this.g=null}get(){let _;return 0<this.h?(this.h--,_=this.g,this.g=_.next,_.next=null):_=this.i(),_}}function T(f){return/^[\s\xa0]*$/.test(f)}function E(){var f=o.navigator;return f&&(f=f.userAgent)?f:""}function N(f){return N[" "](f),f}N[" "]=function(){};var O=E().indexOf("Gecko")!=-1&&!(E().toLowerCase().indexOf("webkit")!=-1&&E().indexOf("Edge")==-1)&&!(E().indexOf("Trident")!=-1||E().indexOf("MSIE")!=-1)&&E().indexOf("Edge")==-1;function M(f,_,A){for(const U in f)_.call(A,f[U],U,f)}function g(f,_){for(const A in f)_.call(void 0,f[A],A,f)}function y(f){const _={};for(const A in f)_[A]=f[A];return _}const S="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function R(f,_){let A,U;for(let ne=1;ne<arguments.length;ne++){U=arguments[ne];for(A in U)f[A]=U[A];for(let ie=0;ie<S.length;ie++)A=S[ie],Object.prototype.hasOwnProperty.call(U,A)&&(f[A]=U[A])}}function P(f){var _=1;f=f.split(":");const A=[];for(;0<_&&f.length;)A.push(f.shift()),_--;return f.length&&A.push(f.join(":")),A}function b(f){o.setTimeout(()=>{throw f},0)}function C(){var f=H;let _=null;return f.g&&(_=f.g,f.g=f.g.next,f.g||(f.h=null),_.next=null),_}class oe{constructor(){this.h=this.g=null}add(_,A){const U=ae.get();U.set(_,A),this.h?this.h.next=U:this.g=U,this.h=U}}var ae=new k(()=>new he,f=>f.reset());class he{constructor(){this.next=this.g=this.h=null}set(_,A){this.h=_,this.g=A,this.next=null}reset(){this.next=this.g=this.h=null}}let me,ee=!1,H=new oe,ue=()=>{const f=o.Promise.resolve(void 0);me=()=>{f.then(de)}};var de=()=>{for(var f;f=C();){try{f.h.call(f.g)}catch(A){b(A)}var _=ae;_.j(f),100>_.h&&(_.h++,f.next=_.g,_.g=f)}ee=!1};function B(){this.s=this.s,this.C=this.C}B.prototype.s=!1,B.prototype.ma=function(){this.s||(this.s=!0,this.N())},B.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function K(f,_){this.type=f,this.g=this.target=_,this.defaultPrevented=!1}K.prototype.h=function(){this.defaultPrevented=!0};var X=function(){if(!o.addEventListener||!Object.defineProperty)return!1;var f=!1,_=Object.defineProperty({},"passive",{get:function(){f=!0}});try{const A=()=>{};o.addEventListener("test",A,_),o.removeEventListener("test",A,_)}catch{}return f}();function q(f,_){if(K.call(this,f?f.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,f){var A=this.type=f.type,U=f.changedTouches&&f.changedTouches.length?f.changedTouches[0]:null;if(this.target=f.target||f.srcElement,this.g=_,_=f.relatedTarget){if(O){e:{try{N(_.nodeName);var ne=!0;break e}catch{}ne=!1}ne||(_=null)}}else A=="mouseover"?_=f.fromElement:A=="mouseout"&&(_=f.toElement);this.relatedTarget=_,U?(this.clientX=U.clientX!==void 0?U.clientX:U.pageX,this.clientY=U.clientY!==void 0?U.clientY:U.pageY,this.screenX=U.screenX||0,this.screenY=U.screenY||0):(this.clientX=f.clientX!==void 0?f.clientX:f.pageX,this.clientY=f.clientY!==void 0?f.clientY:f.pageY,this.screenX=f.screenX||0,this.screenY=f.screenY||0),this.button=f.button,this.key=f.key||"",this.ctrlKey=f.ctrlKey,this.altKey=f.altKey,this.shiftKey=f.shiftKey,this.metaKey=f.metaKey,this.pointerId=f.pointerId||0,this.pointerType=typeof f.pointerType=="string"?f.pointerType:le[f.pointerType]||"",this.state=f.state,this.i=f,f.defaultPrevented&&q.aa.h.call(this)}}x(q,K);var le={2:"touch",3:"pen",4:"mouse"};q.prototype.h=function(){q.aa.h.call(this);var f=this.i;f.preventDefault?f.preventDefault():f.returnValue=!1};var _e="closure_listenable_"+(1e6*Math.random()|0),Ce=0;function Te(f,_,A,U,ne){this.listener=f,this.proxy=null,this.src=_,this.type=A,this.capture=!!U,this.ha=ne,this.key=++Ce,this.da=this.fa=!1}function xe(f){f.da=!0,f.listener=null,f.proxy=null,f.src=null,f.ha=null}function $e(f){this.src=f,this.g={},this.h=0}$e.prototype.add=function(f,_,A,U,ne){var ie=f.toString();f=this.g[ie],f||(f=this.g[ie]=[],this.h++);var ke=ot(f,_,U,ne);return-1<ke?(_=f[ke],A||(_.fa=!1)):(_=new Te(_,this.src,ie,!!U,ne),_.fa=A,f.push(_)),_};function z(f,_){var A=_.type;if(A in f.g){var U=f.g[A],ne=Array.prototype.indexOf.call(U,_,void 0),ie;(ie=0<=ne)&&Array.prototype.splice.call(U,ne,1),ie&&(xe(_),f.g[A].length==0&&(delete f.g[A],f.h--))}}function ot(f,_,A,U){for(var ne=0;ne<f.length;++ne){var ie=f[ne];if(!ie.da&&ie.listener==_&&ie.capture==!!A&&ie.ha==U)return ne}return-1}var He="closure_lm_"+(1e6*Math.random()|0),nt={};function Fe(f,_,A,U,ne){if(Array.isArray(_)){for(var ie=0;ie<_.length;ie++)Fe(f,_[ie],A,U,ne);return null}return A=lr(A),f&&f[_e]?f.K(_,A,c(U)?!!U.capture:!1,ne):Ae(f,_,A,!1,U,ne)}function Ae(f,_,A,U,ne,ie){if(!_)throw Error("Invalid event type");var ke=c(ne)?!!ne.capture:!!ne,yt=rn(f);if(yt||(f[He]=yt=new $e(f)),A=yt.add(_,A,U,ke,ie),A.proxy)return A;if(U=Tt(),A.proxy=U,U.src=f,U.listener=A,f.addEventListener)X||(ne=ke),ne===void 0&&(ne=!1),f.addEventListener(_.toString(),U,ne);else if(f.attachEvent)f.attachEvent(tn(_.toString()),U);else if(f.addListener&&f.removeListener)f.addListener(U);else throw Error("addEventListener and attachEvent are unavailable.");return A}function Tt(){function f(A){return _.call(f.src,f.listener,A)}const _=Ms;return f}function or(f,_,A,U,ne){if(Array.isArray(_))for(var ie=0;ie<_.length;ie++)or(f,_[ie],A,U,ne);else U=c(U)?!!U.capture:!!U,A=lr(A),f&&f[_e]?(f=f.i,_=String(_).toString(),_ in f.g&&(ie=f.g[_],A=ot(ie,A,U,ne),-1<A&&(xe(ie[A]),Array.prototype.splice.call(ie,A,1),ie.length==0&&(delete f.g[_],f.h--)))):f&&(f=rn(f))&&(_=f.g[_.toString()],f=-1,_&&(f=ot(_,A,U,ne)),(A=-1<f?_[f]:null)&&Ar(A))}function Ar(f){if(typeof f!="number"&&f&&!f.da){var _=f.src;if(_&&_[_e])z(_.i,f);else{var A=f.type,U=f.proxy;_.removeEventListener?_.removeEventListener(A,U,f.capture):_.detachEvent?_.detachEvent(tn(A),U):_.addListener&&_.removeListener&&_.removeListener(U),(A=rn(_))?(z(A,f),A.h==0&&(A.src=null,_[He]=null)):xe(f)}}}function tn(f){return f in nt?nt[f]:nt[f]="on"+f}function Ms(f,_){if(f.da)f=!0;else{_=new q(_,this);var A=f.listener,U=f.ha||f.src;f.fa&&Ar(f),f=A.call(U,_)}return f}function rn(f){return f=f[He],f instanceof $e?f:null}var kt="__closure_events_fn_"+(1e9*Math.random()>>>0);function lr(f){return typeof f=="function"?f:(f[kt]||(f[kt]=function(_){return f.handleEvent(_)}),f[kt])}function vt(){B.call(this),this.i=new $e(this),this.M=this,this.F=null}x(vt,B),vt.prototype[_e]=!0,vt.prototype.removeEventListener=function(f,_,A,U){or(this,f,_,A,U)};function St(f,_){var A,U=f.F;if(U)for(A=[];U;U=U.F)A.push(U);if(f=f.M,U=_.type||_,typeof _=="string")_=new K(_,f);else if(_ instanceof K)_.target=_.target||f;else{var ne=_;_=new K(U,f),R(_,ne)}if(ne=!0,A)for(var ie=A.length-1;0<=ie;ie--){var ke=_.g=A[ie];ne=ht(ke,U,!0,_)&&ne}if(ke=_.g=f,ne=ht(ke,U,!0,_)&&ne,ne=ht(ke,U,!1,_)&&ne,A)for(ie=0;ie<A.length;ie++)ke=_.g=A[ie],ne=ht(ke,U,!1,_)&&ne}vt.prototype.N=function(){if(vt.aa.N.call(this),this.i){var f=this.i,_;for(_ in f.g){for(var A=f.g[_],U=0;U<A.length;U++)xe(A[U]);delete f.g[_],f.h--}}this.F=null},vt.prototype.K=function(f,_,A,U){return this.i.add(String(f),_,!1,A,U)},vt.prototype.L=function(f,_,A,U){return this.i.add(String(f),_,!0,A,U)};function ht(f,_,A,U){if(_=f.i.g[String(_)],!_)return!0;_=_.concat();for(var ne=!0,ie=0;ie<_.length;++ie){var ke=_[ie];if(ke&&!ke.da&&ke.capture==A){var yt=ke.listener,pr=ke.ha||ke.src;ke.fa&&z(f.i,ke),ne=yt.call(pr,U)!==!1&&ne}}return ne&&!U.defaultPrevented}function Dt(f,_,A){if(typeof f=="function")A&&(f=m(f,A));else if(f&&typeof f.handleEvent=="function")f=m(f.handleEvent,f);else throw Error("Invalid listener argument");return 2147483647<Number(_)?-1:o.setTimeout(f,_||0)}function je(f){f.g=Dt(()=>{f.g=null,f.i&&(f.i=!1,je(f))},f.l);const _=f.h;f.h=null,f.m.apply(null,_)}class xt extends B{constructor(_,A){super(),this.m=_,this.l=A,this.h=null,this.i=!1,this.g=null}j(_){this.h=arguments,this.g?this.i=!0:je(this)}N(){super.N(),this.g&&(o.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Gt(f){B.call(this),this.h=f,this.g={}}x(Gt,B);var ut=[];function pn(f){M(f.g,function(_,A){this.g.hasOwnProperty(A)&&Ar(_)},f),f.g={}}Gt.prototype.N=function(){Gt.aa.N.call(this),pn(this)},Gt.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Ls=o.JSON.stringify,co=o.JSON.parse,Al=class{stringify(f){return o.JSON.stringify(f,void 0)}parse(f){return o.JSON.parse(f,void 0)}};function js(){}js.prototype.h=null;function hs(f){return f.h||(f.h=f.i())}function wa(){}var Hn={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function Vs(){K.call(this,"d")}x(Vs,K);function ds(){K.call(this,"c")}x(ds,K);var Rn={},uo=null;function Us(){return uo=uo||new vt}Rn.La="serverreachability";function Bs(f){K.call(this,Rn.La,f)}x(Bs,K);function Nn(f){const _=Us();St(_,new Bs(_))}Rn.STAT_EVENT="statevent";function fo(f,_){K.call(this,Rn.STAT_EVENT,f),this.stat=_}x(fo,K);function er(f){const _=Us();St(_,new fo(_,f))}Rn.Ma="timingevent";function G(f,_){K.call(this,Rn.Ma,f),this.size=_}x(G,K);function J(f,_){if(typeof f!="function")throw Error("Fn must not be null and must be a function");return o.setTimeout(function(){f()},_)}function se(){this.g=!0}se.prototype.xa=function(){this.g=!1};function pe(f,_,A,U,ne,ie){f.info(function(){if(f.g)if(ie)for(var ke="",yt=ie.split("&"),pr=0;pr<yt.length;pr++){var lt=yt[pr].split("=");if(1<lt.length){var Ir=lt[0];lt=lt[1];var Cr=Ir.split("_");ke=2<=Cr.length&&Cr[1]=="type"?ke+(Ir+"="+lt+"&"):ke+(Ir+"=redacted&")}}else ke=null;else ke=ie;return"XMLHTTP REQ ("+U+") [attempt "+ne+"]: "+_+`
`+A+`
`+ke})}function Se(f,_,A,U,ne,ie,ke){f.info(function(){return"XMLHTTP RESP ("+U+") [ attempt "+ne+"]: "+_+`
`+A+`
`+ie+" "+ke})}function I(f,_,A,U){f.info(function(){return"XMLHTTP TEXT ("+_+"): "+D(f,A)+(U?" "+U:"")})}function V(f,_){f.info(function(){return"TIMEOUT: "+_})}se.prototype.info=function(){};function D(f,_){if(!f.g)return _;if(!_)return null;try{var A=JSON.parse(_);if(A){for(f=0;f<A.length;f++)if(Array.isArray(A[f])){var U=A[f];if(!(2>U.length)){var ne=U[1];if(Array.isArray(ne)&&!(1>ne.length)){var ie=ne[0];if(ie!="noop"&&ie!="stop"&&ie!="close")for(var ke=1;ke<ne.length;ke++)ne[ke]=""}}}}return Ls(A)}catch{return _}}var F={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},L={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},j;function Y(){}x(Y,js),Y.prototype.g=function(){return new XMLHttpRequest},Y.prototype.i=function(){return{}},j=new Y;function re(f,_,A,U){this.j=f,this.i=_,this.l=A,this.R=U||1,this.U=new Gt(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new te}function te(){this.i=null,this.g="",this.h=!1}var Z={},Q={};function ce(f,_,A){f.L=1,f.v=Hu(zs(_)),f.m=A,f.P=!0,we(f,null)}function we(f,_){f.F=Date.now(),Ee(f),f.A=zs(f.v);var A=f.A,U=f.R;Array.isArray(U)||(U=[String(U)]),kx(A.i,"t",U),f.C=0,A=f.j.J,f.h=new te,f.g=zx(f.j,A?_:null,!f.m),0<f.O&&(f.M=new xt(m(f.Y,f,f.g),f.O)),_=f.U,A=f.g,U=f.ca;var ne="readystatechange";Array.isArray(ne)||(ne&&(ut[0]=ne.toString()),ne=ut);for(var ie=0;ie<ne.length;ie++){var ke=Fe(A,ne[ie],U||_.handleEvent,!1,_.h||_);if(!ke)break;_.g[ke.key]=ke}_=f.H?y(f.H):{},f.m?(f.u||(f.u="POST"),_["Content-Type"]="application/x-www-form-urlencoded",f.g.ea(f.A,f.u,f.m,_)):(f.u="GET",f.g.ea(f.A,f.u,null,_)),Nn(),pe(f.i,f.u,f.A,f.l,f.R,f.m)}re.prototype.ca=function(f){f=f.target;const _=this.M;_&&$s(f)==3?_.j():this.Y(f)},re.prototype.Y=function(f){try{if(f==this.g)e:{const Cr=$s(this.g);var _=this.g.Ba();const po=this.g.Z();if(!(3>Cr)&&(Cr!=3||this.g&&(this.h.h||this.g.oa()||Px(this.g)))){this.J||Cr!=4||_==7||(_==8||0>=po?Nn(3):Nn(2)),st(this);var A=this.g.Z();this.X=A;t:if(Ie(this)){var U=Px(this.g);f="";var ne=U.length,ie=$s(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){dt(this),Ke(this);var ke="";break t}this.h.i=new o.TextDecoder}for(_=0;_<ne;_++)this.h.h=!0,f+=this.h.i.decode(U[_],{stream:!(ie&&_==ne-1)});U.length=0,this.h.g+=f,this.C=0,ke=this.h.g}else ke=this.g.oa();if(this.o=A==200,Se(this.i,this.u,this.A,this.l,this.R,Cr,A),this.o){if(this.T&&!this.K){t:{if(this.g){var yt,pr=this.g;if((yt=pr.g?pr.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!T(yt)){var lt=yt;break t}}lt=null}if(A=lt)I(this.i,this.l,A,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,nn(this,A);else{this.o=!1,this.s=3,er(12),dt(this),Ke(this);break e}}if(this.P){A=!0;let Gn;for(;!this.J&&this.C<ke.length;)if(Gn=ge(this,ke),Gn==Q){Cr==4&&(this.s=4,er(14),A=!1),I(this.i,this.l,null,"[Incomplete Response]");break}else if(Gn==Z){this.s=4,er(15),I(this.i,this.l,ke,"[Invalid Chunk]"),A=!1;break}else I(this.i,this.l,Gn,null),nn(this,Gn);if(Ie(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Cr!=4||ke.length!=0||this.h.h||(this.s=1,er(16),A=!1),this.o=this.o&&A,!A)I(this.i,this.l,ke,"[Invalid Chunked Response]"),dt(this),Ke(this);else if(0<ke.length&&!this.W){this.W=!0;var Ir=this.j;Ir.g==this&&Ir.ba&&!Ir.M&&(Ir.j.info("Great, no buffering proxy detected. Bytes received: "+ke.length),a0(Ir),Ir.M=!0,er(11))}}else I(this.i,this.l,ke,null),nn(this,ke);Cr==4&&dt(this),this.o&&!this.J&&(Cr==4?jx(this.j,this):(this.o=!1,Ee(this)))}else GI(this.g),A==400&&0<ke.indexOf("Unknown SID")?(this.s=3,er(12)):(this.s=0,er(13)),dt(this),Ke(this)}}}catch{}finally{}};function Ie(f){return f.g?f.u=="GET"&&f.L!=2&&f.j.Ca:!1}function ge(f,_){var A=f.C,U=_.indexOf(`
`,A);return U==-1?Q:(A=Number(_.substring(A,U)),isNaN(A)?Z:(U+=1,U+A>_.length?Q:(_=_.slice(U,U+A),f.C=U+A,_)))}re.prototype.cancel=function(){this.J=!0,dt(this)};function Ee(f){f.S=Date.now()+f.I,De(f,f.I)}function De(f,_){if(f.B!=null)throw Error("WatchDog timer not null");f.B=J(m(f.ba,f),_)}function st(f){f.B&&(o.clearTimeout(f.B),f.B=null)}re.prototype.ba=function(){this.B=null;const f=Date.now();0<=f-this.S?(V(this.i,this.A),this.L!=2&&(Nn(),er(17)),dt(this),this.s=2,Ke(this)):De(this,this.S-f)};function Ke(f){f.j.G==0||f.J||jx(f.j,f)}function dt(f){st(f);var _=f.M;_&&typeof _.ma=="function"&&_.ma(),f.M=null,pn(f.U),f.g&&(_=f.g,f.g=null,_.abort(),_.ma())}function nn(f,_){try{var A=f.j;if(A.G!=0&&(A.g==f||Je(A.h,f))){if(!f.K&&Je(A.h,f)&&A.G==3){try{var U=A.Da.g.parse(_)}catch{U=null}if(Array.isArray(U)&&U.length==3){var ne=U;if(ne[0]==0){e:if(!A.u){if(A.g)if(A.g.F+3e3<f.F)Qu(A),Xu(A);else break e;s0(A),er(18)}}else A.za=ne[1],0<A.za-A.T&&37500>ne[2]&&A.F&&A.v==0&&!A.C&&(A.C=J(m(A.Za,A),6e3));if(1>=Pn(A.h)&&A.ca){try{A.ca()}catch{}A.ca=void 0}}else vi(A,11)}else if((f.K||A.g==f)&&Qu(A),!T(_))for(ne=A.Da.g.parse(_),_=0;_<ne.length;_++){let lt=ne[_];if(A.T=lt[0],lt=lt[1],A.G==2)if(lt[0]=="c"){A.K=lt[1],A.ia=lt[2];const Ir=lt[3];Ir!=null&&(A.la=Ir,A.j.info("VER="+A.la));const Cr=lt[4];Cr!=null&&(A.Aa=Cr,A.j.info("SVER="+A.Aa));const po=lt[5];po!=null&&typeof po=="number"&&0<po&&(U=1.5*po,A.L=U,A.j.info("backChannelRequestTimeoutMs_="+U)),U=A;const Gn=f.g;if(Gn){const Zu=Gn.g?Gn.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Zu){var ie=U.h;ie.g||Zu.indexOf("spdy")==-1&&Zu.indexOf("quic")==-1&&Zu.indexOf("h2")==-1||(ie.j=ie.l,ie.g=new Set,ie.h&&(ms(ie,ie.h),ie.h=null))}if(U.D){const i0=Gn.g?Gn.g.getResponseHeader("X-HTTP-Session-Id"):null;i0&&(U.ya=i0,At(U.I,U.D,i0))}}A.G=3,A.l&&A.l.ua(),A.ba&&(A.R=Date.now()-f.F,A.j.info("Handshake RTT: "+A.R+"ms")),U=A;var ke=f;if(U.qa=Bx(U,U.J?U.ia:null,U.W),ke.K){Il(U.h,ke);var yt=ke,pr=U.L;pr&&(yt.I=pr),yt.B&&(st(yt),Ee(yt)),U.g=ke}else Mx(U);0<A.i.length&&Yu(A)}else lt[0]!="stop"&&lt[0]!="close"||vi(A,7);else A.G==3&&(lt[0]=="stop"||lt[0]=="close"?lt[0]=="stop"?vi(A,7):n0(A):lt[0]!="noop"&&A.l&&A.l.ta(lt),A.v=0)}}Nn(4)}catch{}}var We=class{constructor(f,_){this.g=f,this.map=_}};function ft(f){this.l=f||10,o.PerformanceNavigationTiming?(f=o.performance.getEntriesByType("navigation"),f=0<f.length&&(f[0].nextHopProtocol=="hq"||f[0].nextHopProtocol=="h2")):f=!!(o.chrome&&o.chrome.loadTimes&&o.chrome.loadTimes()&&o.chrome.loadTimes().wasFetchedViaSpdy),this.j=f?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function mr(f){return f.h?!0:f.g?f.g.size>=f.j:!1}function Pn(f){return f.h?1:f.g?f.g.size:0}function Je(f,_){return f.h?f.h==_:f.g?f.g.has(_):!1}function ms(f,_){f.g?f.g.add(_):f.h=_}function Il(f,_){f.h&&f.h==_?f.h=null:f.g&&f.g.has(_)&&f.g.delete(_)}ft.prototype.cancel=function(){if(this.i=zu(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const f of this.g.values())f.cancel();this.g.clear()}};function zu(f){if(f.h!=null)return f.i.concat(f.h.D);if(f.g!=null&&f.g.size!==0){let _=f.i;for(const A of f.g.values())_=_.concat(A.D);return _}return v(f.i)}function PI(f){if(f.V&&typeof f.V=="function")return f.V();if(typeof Map<"u"&&f instanceof Map||typeof Set<"u"&&f instanceof Set)return Array.from(f.values());if(typeof f=="string")return f.split("");if(l(f)){for(var _=[],A=f.length,U=0;U<A;U++)_.push(f[U]);return _}_=[],A=0;for(U in f)_[A++]=f[U];return _}function bI(f){if(f.na&&typeof f.na=="function")return f.na();if(!f.V||typeof f.V!="function"){if(typeof Map<"u"&&f instanceof Map)return Array.from(f.keys());if(!(typeof Set<"u"&&f instanceof Set)){if(l(f)||typeof f=="string"){var _=[];f=f.length;for(var A=0;A<f;A++)_.push(A);return _}_=[],A=0;for(const U in f)_[A++]=U;return _}}}function xx(f,_){if(f.forEach&&typeof f.forEach=="function")f.forEach(_,void 0);else if(l(f)||typeof f=="string")Array.prototype.forEach.call(f,_,void 0);else for(var A=bI(f),U=PI(f),ne=U.length,ie=0;ie<ne;ie++)_.call(void 0,U[ie],A&&A[ie],f)}var _x=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function DI(f,_){if(f){f=f.split("&");for(var A=0;A<f.length;A++){var U=f[A].indexOf("="),ne=null;if(0<=U){var ie=f[A].substring(0,U);ne=f[A].substring(U+1)}else ie=f[A];_(ie,ne?decodeURIComponent(ne.replace(/\+/g," ")):"")}}}function gi(f){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,f instanceof gi){this.h=f.h,$u(this,f.j),this.o=f.o,this.g=f.g,Wu(this,f.s),this.l=f.l;var _=f.i,A=new Nl;A.i=_.i,_.g&&(A.g=new Map(_.g),A.h=_.h),yx(this,A),this.m=f.m}else f&&(_=String(f).match(_x))?(this.h=!1,$u(this,_[1]||"",!0),this.o=Cl(_[2]||""),this.g=Cl(_[3]||"",!0),Wu(this,_[4]),this.l=Cl(_[5]||"",!0),yx(this,_[6]||"",!0),this.m=Cl(_[7]||"")):(this.h=!1,this.i=new Nl(null,this.h))}gi.prototype.toString=function(){var f=[],_=this.j;_&&f.push(Rl(_,wx,!0),":");var A=this.g;return(A||_=="file")&&(f.push("//"),(_=this.o)&&f.push(Rl(_,wx,!0),"@"),f.push(encodeURIComponent(String(A)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),A=this.s,A!=null&&f.push(":",String(A))),(A=this.l)&&(this.g&&A.charAt(0)!="/"&&f.push("/"),f.push(Rl(A,A.charAt(0)=="/"?MI:OI,!0))),(A=this.i.toString())&&f.push("?",A),(A=this.m)&&f.push("#",Rl(A,jI)),f.join("")};function zs(f){return new gi(f)}function $u(f,_,A){f.j=A?Cl(_,!0):_,f.j&&(f.j=f.j.replace(/:$/,""))}function Wu(f,_){if(_){if(_=Number(_),isNaN(_)||0>_)throw Error("Bad port number "+_);f.s=_}else f.s=null}function yx(f,_,A){_ instanceof Nl?(f.i=_,VI(f.i,f.h)):(A||(_=Rl(_,LI)),f.i=new Nl(_,f.h))}function At(f,_,A){f.i.set(_,A)}function Hu(f){return At(f,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),f}function Cl(f,_){return f?_?decodeURI(f.replace(/%25/g,"%2525")):decodeURIComponent(f):""}function Rl(f,_,A){return typeof f=="string"?(f=encodeURI(f).replace(_,FI),A&&(f=f.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),f):null}function FI(f){return f=f.charCodeAt(0),"%"+(f>>4&15).toString(16)+(f&15).toString(16)}var wx=/[#\/\?@]/g,OI=/[#\?:]/g,MI=/[#\?]/g,LI=/[#\?@]/g,jI=/#/g;function Nl(f,_){this.h=this.g=null,this.i=f||null,this.j=!!_}function Ea(f){f.g||(f.g=new Map,f.h=0,f.i&&DI(f.i,function(_,A){f.add(decodeURIComponent(_.replace(/\+/g," ")),A)}))}t=Nl.prototype,t.add=function(f,_){Ea(this),this.i=null,f=ho(this,f);var A=this.g.get(f);return A||this.g.set(f,A=[]),A.push(_),this.h+=1,this};function Ex(f,_){Ea(f),_=ho(f,_),f.g.has(_)&&(f.i=null,f.h-=f.g.get(_).length,f.g.delete(_))}function Tx(f,_){return Ea(f),_=ho(f,_),f.g.has(_)}t.forEach=function(f,_){Ea(this),this.g.forEach(function(A,U){A.forEach(function(ne){f.call(_,ne,U,this)},this)},this)},t.na=function(){Ea(this);const f=Array.from(this.g.values()),_=Array.from(this.g.keys()),A=[];for(let U=0;U<_.length;U++){const ne=f[U];for(let ie=0;ie<ne.length;ie++)A.push(_[U])}return A},t.V=function(f){Ea(this);let _=[];if(typeof f=="string")Tx(this,f)&&(_=_.concat(this.g.get(ho(this,f))));else{f=Array.from(this.g.values());for(let A=0;A<f.length;A++)_=_.concat(f[A])}return _},t.set=function(f,_){return Ea(this),this.i=null,f=ho(this,f),Tx(this,f)&&(this.h-=this.g.get(f).length),this.g.set(f,[_]),this.h+=1,this},t.get=function(f,_){return f?(f=this.V(f),0<f.length?String(f[0]):_):_};function kx(f,_,A){Ex(f,_),0<A.length&&(f.i=null,f.g.set(ho(f,_),v(A)),f.h+=A.length)}t.toString=function(){if(this.i)return this.i;if(!this.g)return"";const f=[],_=Array.from(this.g.keys());for(var A=0;A<_.length;A++){var U=_[A];const ie=encodeURIComponent(String(U)),ke=this.V(U);for(U=0;U<ke.length;U++){var ne=ie;ke[U]!==""&&(ne+="="+encodeURIComponent(String(ke[U]))),f.push(ne)}}return this.i=f.join("&")};function ho(f,_){return _=String(_),f.j&&(_=_.toLowerCase()),_}function VI(f,_){_&&!f.j&&(Ea(f),f.i=null,f.g.forEach(function(A,U){var ne=U.toLowerCase();U!=ne&&(Ex(this,U),kx(this,ne,A))},f)),f.j=_}function UI(f,_){const A=new se;if(o.Image){const U=new Image;U.onload=p(Ta,A,"TestLoadImage: loaded",!0,_,U),U.onerror=p(Ta,A,"TestLoadImage: error",!1,_,U),U.onabort=p(Ta,A,"TestLoadImage: abort",!1,_,U),U.ontimeout=p(Ta,A,"TestLoadImage: timeout",!1,_,U),o.setTimeout(function(){U.ontimeout&&U.ontimeout()},1e4),U.src=f}else _(!1)}function BI(f,_){const A=new se,U=new AbortController,ne=setTimeout(()=>{U.abort(),Ta(A,"TestPingServer: timeout",!1,_)},1e4);fetch(f,{signal:U.signal}).then(ie=>{clearTimeout(ne),ie.ok?Ta(A,"TestPingServer: ok",!0,_):Ta(A,"TestPingServer: server error",!1,_)}).catch(()=>{clearTimeout(ne),Ta(A,"TestPingServer: error",!1,_)})}function Ta(f,_,A,U,ne){try{ne&&(ne.onload=null,ne.onerror=null,ne.onabort=null,ne.ontimeout=null),U(A)}catch{}}function zI(){this.g=new Al}function $I(f,_,A){const U=A||"";try{xx(f,function(ne,ie){let ke=ne;c(ne)&&(ke=Ls(ne)),_.push(U+ie+"="+encodeURIComponent(ke))})}catch(ne){throw _.push(U+"type="+encodeURIComponent("_badmap")),ne}}function Gu(f){this.l=f.Ub||null,this.j=f.eb||!1}x(Gu,js),Gu.prototype.g=function(){return new Ku(this.l,this.j)},Gu.prototype.i=function(f){return function(){return f}}({});function Ku(f,_){vt.call(this),this.D=f,this.o=_,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}x(Ku,vt),t=Ku.prototype,t.open=function(f,_){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=f,this.A=_,this.readyState=1,bl(this)},t.send=function(f){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const _={headers:this.u,method:this.B,credentials:this.m,cache:void 0};f&&(_.body=f),(this.D||o).fetch(new Request(this.A,_)).then(this.Sa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,Pl(this)),this.readyState=0},t.Sa=function(f){if(this.g&&(this.l=f,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=f.headers,this.readyState=2,bl(this)),this.g&&(this.readyState=3,bl(this),this.g)))if(this.responseType==="arraybuffer")f.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof o.ReadableStream<"u"&&"body"in f){if(this.j=f.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;Sx(this)}else f.text().then(this.Ra.bind(this),this.ga.bind(this))};function Sx(f){f.j.read().then(f.Pa.bind(f)).catch(f.ga.bind(f))}t.Pa=function(f){if(this.g){if(this.o&&f.value)this.response.push(f.value);else if(!this.o){var _=f.value?f.value:new Uint8Array(0);(_=this.v.decode(_,{stream:!f.done}))&&(this.response=this.responseText+=_)}f.done?Pl(this):bl(this),this.readyState==3&&Sx(this)}},t.Ra=function(f){this.g&&(this.response=this.responseText=f,Pl(this))},t.Qa=function(f){this.g&&(this.response=f,Pl(this))},t.ga=function(){this.g&&Pl(this)};function Pl(f){f.readyState=4,f.l=null,f.j=null,f.v=null,bl(f)}t.setRequestHeader=function(f,_){this.u.append(f,_)},t.getResponseHeader=function(f){return this.h&&this.h.get(f.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";const f=[],_=this.h.entries();for(var A=_.next();!A.done;)A=A.value,f.push(A[0]+": "+A[1]),A=_.next();return f.join(`\r
`)};function bl(f){f.onreadystatechange&&f.onreadystatechange.call(f)}Object.defineProperty(Ku.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(f){this.m=f?"include":"same-origin"}});function Ax(f){let _="";return M(f,function(A,U){_+=U,_+=":",_+=A,_+=`\r
`}),_}function r0(f,_,A){e:{for(U in A){var U=!1;break e}U=!0}U||(A=Ax(A),typeof f=="string"?A!=null&&encodeURIComponent(String(A)):At(f,_,A))}function jt(f){vt.call(this),this.headers=new Map,this.o=f||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}x(jt,vt);var WI=/^https?$/i,HI=["POST","PUT"];t=jt.prototype,t.Ha=function(f){this.J=f},t.ea=function(f,_,A,U){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+f);_=_?_.toUpperCase():"GET",this.D=f,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():j.g(),this.v=this.o?hs(this.o):hs(j),this.g.onreadystatechange=m(this.Ea,this);try{this.B=!0,this.g.open(_,String(f),!0),this.B=!1}catch(ie){Ix(this,ie);return}if(f=A||"",A=new Map(this.headers),U)if(Object.getPrototypeOf(U)===Object.prototype)for(var ne in U)A.set(ne,U[ne]);else if(typeof U.keys=="function"&&typeof U.get=="function")for(const ie of U.keys())A.set(ie,U.get(ie));else throw Error("Unknown input type for opt_headers: "+String(U));U=Array.from(A.keys()).find(ie=>ie.toLowerCase()=="content-type"),ne=o.FormData&&f instanceof o.FormData,!(0<=Array.prototype.indexOf.call(HI,_,void 0))||U||ne||A.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[ie,ke]of A)this.g.setRequestHeader(ie,ke);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{Nx(this),this.u=!0,this.g.send(f),this.u=!1}catch(ie){Ix(this,ie)}};function Ix(f,_){f.h=!1,f.g&&(f.j=!0,f.g.abort(),f.j=!1),f.l=_,f.m=5,Cx(f),qu(f)}function Cx(f){f.A||(f.A=!0,St(f,"complete"),St(f,"error"))}t.abort=function(f){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=f||7,St(this,"complete"),St(this,"abort"),qu(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),qu(this,!0)),jt.aa.N.call(this)},t.Ea=function(){this.s||(this.B||this.u||this.j?Rx(this):this.bb())},t.bb=function(){Rx(this)};function Rx(f){if(f.h&&typeof i<"u"&&(!f.v[1]||$s(f)!=4||f.Z()!=2)){if(f.u&&$s(f)==4)Dt(f.Ea,0,f);else if(St(f,"readystatechange"),$s(f)==4){f.h=!1;try{const ke=f.Z();e:switch(ke){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var _=!0;break e;default:_=!1}var A;if(!(A=_)){var U;if(U=ke===0){var ne=String(f.D).match(_x)[1]||null;!ne&&o.self&&o.self.location&&(ne=o.self.location.protocol.slice(0,-1)),U=!WI.test(ne?ne.toLowerCase():"")}A=U}if(A)St(f,"complete"),St(f,"success");else{f.m=6;try{var ie=2<$s(f)?f.g.statusText:""}catch{ie=""}f.l=ie+" ["+f.Z()+"]",Cx(f)}}finally{qu(f)}}}}function qu(f,_){if(f.g){Nx(f);const A=f.g,U=f.v[0]?()=>{}:null;f.g=null,f.v=null,_||St(f,"ready");try{A.onreadystatechange=U}catch{}}}function Nx(f){f.I&&(o.clearTimeout(f.I),f.I=null)}t.isActive=function(){return!!this.g};function $s(f){return f.g?f.g.readyState:0}t.Z=function(){try{return 2<$s(this)?this.g.status:-1}catch{return-1}},t.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},t.Oa=function(f){if(this.g){var _=this.g.responseText;return f&&_.indexOf(f)==0&&(_=_.substring(f.length)),co(_)}};function Px(f){try{if(!f.g)return null;if("response"in f.g)return f.g.response;switch(f.H){case"":case"text":return f.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in f.g)return f.g.mozResponseArrayBuffer}return null}catch{return null}}function GI(f){const _={};f=(f.g&&2<=$s(f)&&f.g.getAllResponseHeaders()||"").split(`\r
`);for(let U=0;U<f.length;U++){if(T(f[U]))continue;var A=P(f[U]);const ne=A[0];if(A=A[1],typeof A!="string")continue;A=A.trim();const ie=_[ne]||[];_[ne]=ie,ie.push(A)}g(_,function(U){return U.join(", ")})}t.Ba=function(){return this.m},t.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function Dl(f,_,A){return A&&A.internalChannelParams&&A.internalChannelParams[f]||_}function bx(f){this.Aa=0,this.i=[],this.j=new se,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=Dl("failFast",!1,f),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=Dl("baseRetryDelayMs",5e3,f),this.cb=Dl("retryDelaySeedMs",1e4,f),this.Wa=Dl("forwardChannelMaxRetries",2,f),this.wa=Dl("forwardChannelRequestTimeoutMs",2e4,f),this.pa=f&&f.xmlHttpFactory||void 0,this.Xa=f&&f.Tb||void 0,this.Ca=f&&f.useFetchStreams||!1,this.L=void 0,this.J=f&&f.supportsCrossDomainXhr||!1,this.K="",this.h=new ft(f&&f.concurrentRequestLimit),this.Da=new zI,this.P=f&&f.fastHandshake||!1,this.O=f&&f.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=f&&f.Rb||!1,f&&f.xa&&this.j.xa(),f&&f.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&f&&f.detectBufferingProxy||!1,this.ja=void 0,f&&f.longPollingTimeout&&0<f.longPollingTimeout&&(this.ja=f.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}t=bx.prototype,t.la=8,t.G=1,t.connect=function(f,_,A,U){er(0),this.W=f,this.H=_||{},A&&U!==void 0&&(this.H.OSID=A,this.H.OAID=U),this.F=this.X,this.I=Bx(this,null,this.W),Yu(this)};function n0(f){if(Dx(f),f.G==3){var _=f.U++,A=zs(f.I);if(At(A,"SID",f.K),At(A,"RID",_),At(A,"TYPE","terminate"),Fl(f,A),_=new re(f,f.j,_),_.L=2,_.v=Hu(zs(A)),A=!1,o.navigator&&o.navigator.sendBeacon)try{A=o.navigator.sendBeacon(_.v.toString(),"")}catch{}!A&&o.Image&&(new Image().src=_.v,A=!0),A||(_.g=zx(_.j,null),_.g.ea(_.v)),_.F=Date.now(),Ee(_)}Ux(f)}function Xu(f){f.g&&(a0(f),f.g.cancel(),f.g=null)}function Dx(f){Xu(f),f.u&&(o.clearTimeout(f.u),f.u=null),Qu(f),f.h.cancel(),f.s&&(typeof f.s=="number"&&o.clearTimeout(f.s),f.s=null)}function Yu(f){if(!mr(f.h)&&!f.s){f.s=!0;var _=f.Ga;me||ue(),ee||(me(),ee=!0),H.add(_,f),f.B=0}}function KI(f,_){return Pn(f.h)>=f.h.j-(f.s?1:0)?!1:f.s?(f.i=_.D.concat(f.i),!0):f.G==1||f.G==2||f.B>=(f.Va?0:f.Wa)?!1:(f.s=J(m(f.Ga,f,_),Vx(f,f.B)),f.B++,!0)}t.Ga=function(f){if(this.s)if(this.s=null,this.G==1){if(!f){this.U=Math.floor(1e5*Math.random()),f=this.U++;const ne=new re(this,this.j,f);let ie=this.o;if(this.S&&(ie?(ie=y(ie),R(ie,this.S)):ie=this.S),this.m!==null||this.O||(ne.H=ie,ie=null),this.P)e:{for(var _=0,A=0;A<this.i.length;A++){t:{var U=this.i[A];if("__data__"in U.map&&(U=U.map.__data__,typeof U=="string")){U=U.length;break t}U=void 0}if(U===void 0)break;if(_+=U,4096<_){_=A;break e}if(_===4096||A===this.i.length-1){_=A+1;break e}}_=1e3}else _=1e3;_=Ox(this,ne,_),A=zs(this.I),At(A,"RID",f),At(A,"CVER",22),this.D&&At(A,"X-HTTP-Session-Id",this.D),Fl(this,A),ie&&(this.O?_="headers="+encodeURIComponent(String(Ax(ie)))+"&"+_:this.m&&r0(A,this.m,ie)),ms(this.h,ne),this.Ua&&At(A,"TYPE","init"),this.P?(At(A,"$req",_),At(A,"SID","null"),ne.T=!0,ce(ne,A,null)):ce(ne,A,_),this.G=2}}else this.G==3&&(f?Fx(this,f):this.i.length==0||mr(this.h)||Fx(this))};function Fx(f,_){var A;_?A=_.l:A=f.U++;const U=zs(f.I);At(U,"SID",f.K),At(U,"RID",A),At(U,"AID",f.T),Fl(f,U),f.m&&f.o&&r0(U,f.m,f.o),A=new re(f,f.j,A,f.B+1),f.m===null&&(A.H=f.o),_&&(f.i=_.D.concat(f.i)),_=Ox(f,A,1e3),A.I=Math.round(.5*f.wa)+Math.round(.5*f.wa*Math.random()),ms(f.h,A),ce(A,U,_)}function Fl(f,_){f.H&&M(f.H,function(A,U){At(_,U,A)}),f.l&&xx({},function(A,U){At(_,U,A)})}function Ox(f,_,A){A=Math.min(f.i.length,A);var U=f.l?m(f.l.Na,f.l,f):null;e:{var ne=f.i;let ie=-1;for(;;){const ke=["count="+A];ie==-1?0<A?(ie=ne[0].g,ke.push("ofs="+ie)):ie=0:ke.push("ofs="+ie);let yt=!0;for(let pr=0;pr<A;pr++){let lt=ne[pr].g;const Ir=ne[pr].map;if(lt-=ie,0>lt)ie=Math.max(0,ne[pr].g-100),yt=!1;else try{$I(Ir,ke,"req"+lt+"_")}catch{U&&U(Ir)}}if(yt){U=ke.join("&");break e}}}return f=f.i.splice(0,A),_.D=f,U}function Mx(f){if(!f.g&&!f.u){f.Y=1;var _=f.Fa;me||ue(),ee||(me(),ee=!0),H.add(_,f),f.v=0}}function s0(f){return f.g||f.u||3<=f.v?!1:(f.Y++,f.u=J(m(f.Fa,f),Vx(f,f.v)),f.v++,!0)}t.Fa=function(){if(this.u=null,Lx(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var f=2*this.R;this.j.info("BP detection timer enabled: "+f),this.A=J(m(this.ab,this),f)}},t.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,er(10),Xu(this),Lx(this))};function a0(f){f.A!=null&&(o.clearTimeout(f.A),f.A=null)}function Lx(f){f.g=new re(f,f.j,"rpc",f.Y),f.m===null&&(f.g.H=f.o),f.g.O=0;var _=zs(f.qa);At(_,"RID","rpc"),At(_,"SID",f.K),At(_,"AID",f.T),At(_,"CI",f.F?"0":"1"),!f.F&&f.ja&&At(_,"TO",f.ja),At(_,"TYPE","xmlhttp"),Fl(f,_),f.m&&f.o&&r0(_,f.m,f.o),f.L&&(f.g.I=f.L);var A=f.g;f=f.ia,A.L=1,A.v=Hu(zs(_)),A.m=null,A.P=!0,we(A,f)}t.Za=function(){this.C!=null&&(this.C=null,Xu(this),s0(this),er(19))};function Qu(f){f.C!=null&&(o.clearTimeout(f.C),f.C=null)}function jx(f,_){var A=null;if(f.g==_){Qu(f),a0(f),f.g=null;var U=2}else if(Je(f.h,_))A=_.D,Il(f.h,_),U=1;else return;if(f.G!=0){if(_.o)if(U==1){A=_.m?_.m.length:0,_=Date.now()-_.F;var ne=f.B;U=Us(),St(U,new G(U,A)),Yu(f)}else Mx(f);else if(ne=_.s,ne==3||ne==0&&0<_.X||!(U==1&&KI(f,_)||U==2&&s0(f)))switch(A&&0<A.length&&(_=f.h,_.i=_.i.concat(A)),ne){case 1:vi(f,5);break;case 4:vi(f,10);break;case 3:vi(f,6);break;default:vi(f,2)}}}function Vx(f,_){let A=f.Ta+Math.floor(Math.random()*f.cb);return f.isActive()||(A*=2),A*_}function vi(f,_){if(f.j.info("Error code "+_),_==2){var A=m(f.fb,f),U=f.Xa;const ne=!U;U=new gi(U||"//www.google.com/images/cleardot.gif"),o.location&&o.location.protocol=="http"||$u(U,"https"),Hu(U),ne?UI(U.toString(),A):BI(U.toString(),A)}else er(2);f.G=0,f.l&&f.l.sa(_),Ux(f),Dx(f)}t.fb=function(f){f?(this.j.info("Successfully pinged google.com"),er(2)):(this.j.info("Failed to ping google.com"),er(1))};function Ux(f){if(f.G=0,f.ka=[],f.l){const _=zu(f.h);(_.length!=0||f.i.length!=0)&&(w(f.ka,_),w(f.ka,f.i),f.h.i.length=0,v(f.i),f.i.length=0),f.l.ra()}}function Bx(f,_,A){var U=A instanceof gi?zs(A):new gi(A);if(U.g!="")_&&(U.g=_+"."+U.g),Wu(U,U.s);else{var ne=o.location;U=ne.protocol,_=_?_+"."+ne.hostname:ne.hostname,ne=+ne.port;var ie=new gi(null);U&&$u(ie,U),_&&(ie.g=_),ne&&Wu(ie,ne),A&&(ie.l=A),U=ie}return A=f.D,_=f.ya,A&&_&&At(U,A,_),At(U,"VER",f.la),Fl(f,U),U}function zx(f,_,A){if(_&&!f.J)throw Error("Can't create secondary domain capable XhrIo object.");return _=f.Ca&&!f.pa?new jt(new Gu({eb:A})):new jt(f.pa),_.Ha(f.J),_}t.isActive=function(){return!!this.l&&this.l.isActive(this)};function $x(){}t=$x.prototype,t.ua=function(){},t.ta=function(){},t.sa=function(){},t.ra=function(){},t.isActive=function(){return!0},t.Na=function(){};function Ju(){}Ju.prototype.g=function(f,_){return new gn(f,_)};function gn(f,_){vt.call(this),this.g=new bx(_),this.l=f,this.h=_&&_.messageUrlParams||null,f=_&&_.messageHeaders||null,_&&_.clientProtocolHeaderRequired&&(f?f["X-Client-Protocol"]="webchannel":f={"X-Client-Protocol":"webchannel"}),this.g.o=f,f=_&&_.initMessageHeaders||null,_&&_.messageContentType&&(f?f["X-WebChannel-Content-Type"]=_.messageContentType:f={"X-WebChannel-Content-Type":_.messageContentType}),_&&_.va&&(f?f["X-WebChannel-Client-Profile"]=_.va:f={"X-WebChannel-Client-Profile":_.va}),this.g.S=f,(f=_&&_.Sb)&&!T(f)&&(this.g.m=f),this.v=_&&_.supportsCrossDomainXhr||!1,this.u=_&&_.sendRawJson||!1,(_=_&&_.httpSessionIdParam)&&!T(_)&&(this.g.D=_,f=this.h,f!==null&&_ in f&&(f=this.h,_ in f&&delete f[_])),this.j=new mo(this)}x(gn,vt),gn.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},gn.prototype.close=function(){n0(this.g)},gn.prototype.o=function(f){var _=this.g;if(typeof f=="string"){var A={};A.__data__=f,f=A}else this.u&&(A={},A.__data__=Ls(f),f=A);_.i.push(new We(_.Ya++,f)),_.G==3&&Yu(_)},gn.prototype.N=function(){this.g.l=null,delete this.j,n0(this.g),delete this.g,gn.aa.N.call(this)};function Wx(f){Vs.call(this),f.__headers__&&(this.headers=f.__headers__,this.statusCode=f.__status__,delete f.__headers__,delete f.__status__);var _=f.__sm__;if(_){e:{for(const A in _){f=A;break e}f=void 0}(this.i=f)&&(f=this.i,_=_!==null&&f in _?_[f]:void 0),this.data=_}else this.data=f}x(Wx,Vs);function Hx(){ds.call(this),this.status=1}x(Hx,ds);function mo(f){this.g=f}x(mo,$x),mo.prototype.ua=function(){St(this.g,"a")},mo.prototype.ta=function(f){St(this.g,new Wx(f))},mo.prototype.sa=function(f){St(this.g,new Hx)},mo.prototype.ra=function(){St(this.g,"b")},Ju.prototype.createWebChannel=Ju.prototype.g,gn.prototype.send=gn.prototype.o,gn.prototype.open=gn.prototype.m,gn.prototype.close=gn.prototype.close,kk=function(){return new Ju},Tk=function(){return Us()},Ek=Rn,cp={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},F.NO_ERROR=0,F.TIMEOUT=8,F.HTTP_ERROR=6,Qf=F,L.COMPLETE="complete",wk=L,wa.EventType=Hn,Hn.OPEN="a",Hn.CLOSE="b",Hn.ERROR="c",Hn.MESSAGE="d",vt.prototype.listen=vt.prototype.K,Jl=wa,jt.prototype.listenOnce=jt.prototype.L,jt.prototype.getLastError=jt.prototype.Ka,jt.prototype.getLastErrorCode=jt.prototype.Ba,jt.prototype.getStatus=jt.prototype.Z,jt.prototype.getResponseJson=jt.prototype.Oa,jt.prototype.getResponseText=jt.prototype.oa,jt.prototype.send=jt.prototype.ea,jt.prototype.setWithCredentials=jt.prototype.Ha,yk=jt}).apply(typeof yf<"u"?yf:typeof self<"u"?self:typeof window<"u"?window:{});const X_="@firebase/firestore";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dr{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}Dr.UNAUTHENTICATED=new Dr(null),Dr.GOOGLE_CREDENTIALS=new Dr("google-credentials-uid"),Dr.FIRST_PARTY=new Dr("first-party-uid"),Dr.MOCK_USER=new Dr("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let yl="10.14.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Hi=new $g("@firebase/firestore");function Gl(){return Hi.logLevel}function Pe(t,...e){if(Hi.logLevel<=Ye.DEBUG){const r=e.map(rv);Hi.debug(`Firestore (${yl}): ${t}`,...r)}}function da(t,...e){if(Hi.logLevel<=Ye.ERROR){const r=e.map(rv);Hi.error(`Firestore (${yl}): ${t}`,...r)}}function al(t,...e){if(Hi.logLevel<=Ye.WARN){const r=e.map(rv);Hi.warn(`Firestore (${yl}): ${t}`,...r)}}function rv(t){if(typeof t=="string")return t;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(r){return JSON.stringify(r)}(t)}catch{return t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Le(t="Unexpected state"){const e=`FIRESTORE (${yl}) INTERNAL ASSERTION FAILED: `+t;throw da(e),new Error(e)}function gt(t,e){t||Le()}function Be(t,e){return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fe={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Ne extends bs{constructor(e,r){super(e,r),this.code=e,this.message=r,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ta{constructor(){this.promise=new Promise((e,r)=>{this.resolve=e,this.reject=r})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sk{constructor(e,r){this.user=r,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class F3{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,r){e.enqueueRetryable(()=>r(Dr.UNAUTHENTICATED))}shutdown(){}}class O3{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,r){this.changeListener=r,e.enqueueRetryable(()=>r(this.token.user))}shutdown(){this.changeListener=null}}class M3{constructor(e){this.t=e,this.currentUser=Dr.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,r){gt(this.o===void 0);let n=this.i;const s=l=>this.i!==n?(n=this.i,r(l)):Promise.resolve();let a=new ta;this.o=()=>{this.i++,this.currentUser=this.u(),a.resolve(),a=new ta,e.enqueueRetryable(()=>s(this.currentUser))};const i=()=>{const l=a;e.enqueueRetryable(async()=>{await l.promise,await s(this.currentUser)})},o=l=>{Pe("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=l,this.o&&(this.auth.addAuthTokenListener(this.o),i())};this.t.onInit(l=>o(l)),setTimeout(()=>{if(!this.auth){const l=this.t.getImmediate({optional:!0});l?o(l):(Pe("FirebaseAuthCredentialsProvider","Auth not yet detected"),a.resolve(),a=new ta)}},0),i()}getToken(){const e=this.i,r=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(r).then(n=>this.i!==e?(Pe("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):n?(gt(typeof n.accessToken=="string"),new Sk(n.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return gt(e===null||typeof e=="string"),new Dr(e)}}class L3{constructor(e,r,n){this.l=e,this.h=r,this.P=n,this.type="FirstParty",this.user=Dr.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);const e=this.T();return e&&this.I.set("Authorization",e),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}}class j3{constructor(e,r,n){this.l=e,this.h=r,this.P=n}getToken(){return Promise.resolve(new L3(this.l,this.h,this.P))}start(e,r){e.enqueueRetryable(()=>r(Dr.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class V3{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class U3{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,r){gt(this.o===void 0);const n=a=>{a.error!=null&&Pe("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${a.error.message}`);const i=a.token!==this.R;return this.R=a.token,Pe("FirebaseAppCheckTokenProvider",`Received ${i?"new":"existing"} token.`),i?r(a.token):Promise.resolve()};this.o=a=>{e.enqueueRetryable(()=>n(a))};const s=a=>{Pe("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=a,this.o&&this.appCheck.addTokenListener(this.o)};this.A.onInit(a=>s(a)),setTimeout(()=>{if(!this.appCheck){const a=this.A.getImmediate({optional:!0});a?s(a):Pe("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(r=>r?(gt(typeof r.token=="string"),this.R=r.token,new V3(r.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function B3(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),r=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(r);else for(let n=0;n<t;n++)r[n]=Math.floor(256*Math.random());return r}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ak{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",r=Math.floor(256/e.length)*e.length;let n="";for(;n.length<20;){const s=B3(40);for(let a=0;a<s.length;++a)n.length<20&&s[a]<r&&(n+=e.charAt(s[a]%e.length))}return n}}function ct(t,e){return t<e?-1:t>e?1:0}function il(t,e,r){return t.length===e.length&&t.every((n,s)=>r(n,e[s]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ar{constructor(e,r){if(this.seconds=e,this.nanoseconds=r,r<0)throw new Ne(fe.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+r);if(r>=1e9)throw new Ne(fe.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+r);if(e<-62135596800)throw new Ne(fe.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new Ne(fe.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return ar.fromMillis(Date.now())}static fromDate(e){return ar.fromMillis(e.getTime())}static fromMillis(e){const r=Math.floor(e/1e3),n=Math.floor(1e6*(e-1e3*r));return new ar(r,n)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?ct(this.nanoseconds,e.nanoseconds):ct(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ve{constructor(e){this.timestamp=e}static fromTimestamp(e){return new Ve(e)}static min(){return new Ve(new ar(0,0))}static max(){return new Ve(new ar(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qc{constructor(e,r,n){r===void 0?r=0:r>e.length&&Le(),n===void 0?n=e.length-r:n>e.length-r&&Le(),this.segments=e,this.offset=r,this.len=n}get length(){return this.len}isEqual(e){return Qc.comparator(this,e)===0}child(e){const r=this.segments.slice(this.offset,this.limit());return e instanceof Qc?e.forEach(n=>{r.push(n)}):r.push(e),this.construct(r)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let r=0;r<this.length;r++)if(this.get(r)!==e.get(r))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let r=0;r<this.length;r++)if(this.get(r)!==e.get(r))return!1;return!0}forEach(e){for(let r=this.offset,n=this.limit();r<n;r++)e(this.segments[r])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,r){const n=Math.min(e.length,r.length);for(let s=0;s<n;s++){const a=e.get(s),i=r.get(s);if(a<i)return-1;if(a>i)return 1}return e.length<r.length?-1:e.length>r.length?1:0}}class Ct extends Qc{construct(e,r,n){return new Ct(e,r,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const r=[];for(const n of e){if(n.indexOf("//")>=0)throw new Ne(fe.INVALID_ARGUMENT,`Invalid segment (${n}). Paths must not contain // in them.`);r.push(...n.split("/").filter(s=>s.length>0))}return new Ct(r)}static emptyPath(){return new Ct([])}}const z3=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class _r extends Qc{construct(e,r,n){return new _r(e,r,n)}static isValidIdentifier(e){return z3.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),_r.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new _r(["__name__"])}static fromServerFormat(e){const r=[];let n="",s=0;const a=()=>{if(n.length===0)throw new Ne(fe.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);r.push(n),n=""};let i=!1;for(;s<e.length;){const o=e[s];if(o==="\\"){if(s+1===e.length)throw new Ne(fe.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const l=e[s+1];if(l!=="\\"&&l!=="."&&l!=="`")throw new Ne(fe.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);n+=l,s+=2}else o==="`"?(i=!i,s++):o!=="."||i?(n+=o,s++):(a(),s++)}if(a(),i)throw new Ne(fe.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new _r(r)}static emptyPath(){return new _r([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class be{constructor(e){this.path=e}static fromPath(e){return new be(Ct.fromString(e))}static fromName(e){return new be(Ct.fromString(e).popFirst(5))}static empty(){return new be(Ct.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&Ct.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,r){return Ct.comparator(e.path,r.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new be(new Ct(e.slice()))}}function $3(t,e){const r=t.toTimestamp().seconds,n=t.toTimestamp().nanoseconds+1,s=Ve.fromTimestamp(n===1e9?new ar(r+1,0):new ar(r,n));return new ni(s,be.empty(),e)}function W3(t){return new ni(t.readTime,t.key,-1)}class ni{constructor(e,r,n){this.readTime=e,this.documentKey=r,this.largestBatchId=n}static min(){return new ni(Ve.min(),be.empty(),-1)}static max(){return new ni(Ve.max(),be.empty(),-1)}}function H3(t,e){let r=t.readTime.compareTo(e.readTime);return r!==0?r:(r=be.comparator(t.documentKey,e.documentKey),r!==0?r:ct(t.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const G3="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class K3{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Au(t){if(t.code!==fe.FAILED_PRECONDITION||t.message!==G3)throw t;Pe("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ve{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(r=>{this.isDone=!0,this.result=r,this.nextCallback&&this.nextCallback(r)},r=>{this.isDone=!0,this.error=r,this.catchCallback&&this.catchCallback(r)})}catch(e){return this.next(void 0,e)}next(e,r){return this.callbackAttached&&Le(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(r,this.error):this.wrapSuccess(e,this.result):new ve((n,s)=>{this.nextCallback=a=>{this.wrapSuccess(e,a).next(n,s)},this.catchCallback=a=>{this.wrapFailure(r,a).next(n,s)}})}toPromise(){return new Promise((e,r)=>{this.next(e,r)})}wrapUserFunction(e){try{const r=e();return r instanceof ve?r:ve.resolve(r)}catch(r){return ve.reject(r)}}wrapSuccess(e,r){return e?this.wrapUserFunction(()=>e(r)):ve.resolve(r)}wrapFailure(e,r){return e?this.wrapUserFunction(()=>e(r)):ve.reject(r)}static resolve(e){return new ve((r,n)=>{r(e)})}static reject(e){return new ve((r,n)=>{n(e)})}static waitFor(e){return new ve((r,n)=>{let s=0,a=0,i=!1;e.forEach(o=>{++s,o.next(()=>{++a,i&&a===s&&r()},l=>n(l))}),i=!0,a===s&&r()})}static or(e){let r=ve.resolve(!1);for(const n of e)r=r.next(s=>s?ve.resolve(s):n());return r}static forEach(e,r){const n=[];return e.forEach((s,a)=>{n.push(r.call(this,s,a))}),this.waitFor(n)}static mapArray(e,r){return new ve((n,s)=>{const a=e.length,i=new Array(a);let o=0;for(let l=0;l<a;l++){const c=l;r(e[c]).next(u=>{i[c]=u,++o,o===a&&n(i)},u=>s(u))}})}static doWhile(e,r){return new ve((n,s)=>{const a=()=>{e()===!0?r().next(()=>{a()},s):n()};a()})}}function q3(t){const e=t.match(/Android ([\d.]+)/i),r=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(r)}function Iu(t){return t.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nv{constructor(e,r){this.previousValue=e,r&&(r.sequenceNumberHandler=n=>this.ie(n),this.se=n=>r.writeSequenceNumber(n))}ie(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.se&&this.se(e),e}}nv.oe=-1;function bd(t){return t==null}function jh(t){return t===0&&1/t==-1/0}function X3(t){return typeof t=="number"&&Number.isInteger(t)&&!jh(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Y_(t){let e=0;for(const r in t)Object.prototype.hasOwnProperty.call(t,r)&&e++;return e}function eo(t,e){for(const r in t)Object.prototype.hasOwnProperty.call(t,r)&&e(r,t[r])}function Ik(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lt{constructor(e,r){this.comparator=e,this.root=r||vr.EMPTY}insert(e,r){return new Lt(this.comparator,this.root.insert(e,r,this.comparator).copy(null,null,vr.BLACK,null,null))}remove(e){return new Lt(this.comparator,this.root.remove(e,this.comparator).copy(null,null,vr.BLACK,null,null))}get(e){let r=this.root;for(;!r.isEmpty();){const n=this.comparator(e,r.key);if(n===0)return r.value;n<0?r=r.left:n>0&&(r=r.right)}return null}indexOf(e){let r=0,n=this.root;for(;!n.isEmpty();){const s=this.comparator(e,n.key);if(s===0)return r+n.left.size;s<0?n=n.left:(r+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((r,n)=>(e(r,n),!1))}toString(){const e=[];return this.inorderTraversal((r,n)=>(e.push(`${r}:${n}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new wf(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new wf(this.root,e,this.comparator,!1)}getReverseIterator(){return new wf(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new wf(this.root,e,this.comparator,!0)}}class wf{constructor(e,r,n,s){this.isReverse=s,this.nodeStack=[];let a=1;for(;!e.isEmpty();)if(a=r?n(e.key,r):1,r&&s&&(a*=-1),a<0)e=this.isReverse?e.left:e.right;else{if(a===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const r={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return r}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class vr{constructor(e,r,n,s,a){this.key=e,this.value=r,this.color=n??vr.RED,this.left=s??vr.EMPTY,this.right=a??vr.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,r,n,s,a){return new vr(e??this.key,r??this.value,n??this.color,s??this.left,a??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,r,n){let s=this;const a=n(e,s.key);return s=a<0?s.copy(null,null,null,s.left.insert(e,r,n),null):a===0?s.copy(null,r,null,null,null):s.copy(null,null,null,null,s.right.insert(e,r,n)),s.fixUp()}removeMin(){if(this.left.isEmpty())return vr.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,r){let n,s=this;if(r(e,s.key)<0)s.left.isEmpty()||s.left.isRed()||s.left.left.isRed()||(s=s.moveRedLeft()),s=s.copy(null,null,null,s.left.remove(e,r),null);else{if(s.left.isRed()&&(s=s.rotateRight()),s.right.isEmpty()||s.right.isRed()||s.right.left.isRed()||(s=s.moveRedRight()),r(e,s.key)===0){if(s.right.isEmpty())return vr.EMPTY;n=s.right.min(),s=s.copy(n.key,n.value,null,null,s.right.removeMin())}s=s.copy(null,null,null,null,s.right.remove(e,r))}return s.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,vr.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,vr.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),r=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,r)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw Le();const e=this.left.check();if(e!==this.right.check())throw Le();return e+(this.isRed()?0:1)}}vr.EMPTY=null,vr.RED=!0,vr.BLACK=!1;vr.EMPTY=new class{constructor(){this.size=0}get key(){throw Le()}get value(){throw Le()}get color(){throw Le()}get left(){throw Le()}get right(){throw Le()}copy(e,r,n,s,a){return this}insert(e,r,n){return new vr(e,r)}remove(e,r){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wr{constructor(e){this.comparator=e,this.data=new Lt(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((r,n)=>(e(r),!1))}forEachInRange(e,r){const n=this.data.getIteratorFrom(e[0]);for(;n.hasNext();){const s=n.getNext();if(this.comparator(s.key,e[1])>=0)return;r(s.key)}}forEachWhile(e,r){let n;for(n=r!==void 0?this.data.getIteratorFrom(r):this.data.getIterator();n.hasNext();)if(!e(n.getNext().key))return}firstAfterOrEqual(e){const r=this.data.getIteratorFrom(e);return r.hasNext()?r.getNext().key:null}getIterator(){return new Q_(this.data.getIterator())}getIteratorFrom(e){return new Q_(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let r=this;return r.size<e.size&&(r=e,e=this),e.forEach(n=>{r=r.add(n)}),r}isEqual(e){if(!(e instanceof wr)||this.size!==e.size)return!1;const r=this.data.getIterator(),n=e.data.getIterator();for(;r.hasNext();){const s=r.getNext().key,a=n.getNext().key;if(this.comparator(s,a)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(r=>{e.push(r)}),e}toString(){const e=[];return this.forEach(r=>e.push(r)),"SortedSet("+e.toString()+")"}copy(e){const r=new wr(this.comparator);return r.data=e,r}}class Q_{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class En{constructor(e){this.fields=e,e.sort(_r.comparator)}static empty(){return new En([])}unionWith(e){let r=new wr(_r.comparator);for(const n of this.fields)r=r.add(n);for(const n of e)r=r.add(n);return new En(r.toArray())}covers(e){for(const r of this.fields)if(r.isPrefixOf(e))return!0;return!1}isEqual(e){return il(this.fields,e.fields,(r,n)=>r.isEqual(n))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ck extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sr{constructor(e){this.binaryString=e}static fromBase64String(e){const r=function(s){try{return atob(s)}catch(a){throw typeof DOMException<"u"&&a instanceof DOMException?new Ck("Invalid base64 string: "+a):a}}(e);return new Sr(r)}static fromUint8Array(e){const r=function(s){let a="";for(let i=0;i<s.length;++i)a+=String.fromCharCode(s[i]);return a}(e);return new Sr(r)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(r){return btoa(r)}(this.binaryString)}toUint8Array(){return function(r){const n=new Uint8Array(r.length);for(let s=0;s<r.length;s++)n[s]=r.charCodeAt(s);return n}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return ct(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Sr.EMPTY_BYTE_STRING=new Sr("");const Y3=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function si(t){if(gt(!!t),typeof t=="string"){let e=0;const r=Y3.exec(t);if(gt(!!r),r[1]){let s=r[1];s=(s+"000000000").substr(0,9),e=Number(s)}const n=new Date(t);return{seconds:Math.floor(n.getTime()/1e3),nanos:e}}return{seconds:$t(t.seconds),nanos:$t(t.nanos)}}function $t(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function Gi(t){return typeof t=="string"?Sr.fromBase64String(t):Sr.fromUint8Array(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sv(t){var e,r;return((r=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||r===void 0?void 0:r.stringValue)==="server_timestamp"}function av(t){const e=t.mapValue.fields.__previous_value__;return sv(e)?av(e):e}function Jc(t){const e=si(t.mapValue.fields.__local_write_time__.timestampValue);return new ar(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Q3{constructor(e,r,n,s,a,i,o,l,c){this.databaseId=e,this.appId=r,this.persistenceKey=n,this.host=s,this.ssl=a,this.forceLongPolling=i,this.autoDetectLongPolling=o,this.longPollingOptions=l,this.useFetchStreams=c}}class Zc{constructor(e,r){this.projectId=e,this.database=r||"(default)"}static empty(){return new Zc("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(e){return e instanceof Zc&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ef={mapValue:{}};function Ki(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?sv(t)?4:Z3(t)?9007199254740991:J3(t)?10:11:Le()}function Cs(t,e){if(t===e)return!0;const r=Ki(t);if(r!==Ki(e))return!1;switch(r){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return Jc(t).isEqual(Jc(e));case 3:return function(s,a){if(typeof s.timestampValue=="string"&&typeof a.timestampValue=="string"&&s.timestampValue.length===a.timestampValue.length)return s.timestampValue===a.timestampValue;const i=si(s.timestampValue),o=si(a.timestampValue);return i.seconds===o.seconds&&i.nanos===o.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(s,a){return Gi(s.bytesValue).isEqual(Gi(a.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(s,a){return $t(s.geoPointValue.latitude)===$t(a.geoPointValue.latitude)&&$t(s.geoPointValue.longitude)===$t(a.geoPointValue.longitude)}(t,e);case 2:return function(s,a){if("integerValue"in s&&"integerValue"in a)return $t(s.integerValue)===$t(a.integerValue);if("doubleValue"in s&&"doubleValue"in a){const i=$t(s.doubleValue),o=$t(a.doubleValue);return i===o?jh(i)===jh(o):isNaN(i)&&isNaN(o)}return!1}(t,e);case 9:return il(t.arrayValue.values||[],e.arrayValue.values||[],Cs);case 10:case 11:return function(s,a){const i=s.mapValue.fields||{},o=a.mapValue.fields||{};if(Y_(i)!==Y_(o))return!1;for(const l in i)if(i.hasOwnProperty(l)&&(o[l]===void 0||!Cs(i[l],o[l])))return!1;return!0}(t,e);default:return Le()}}function eu(t,e){return(t.values||[]).find(r=>Cs(r,e))!==void 0}function ol(t,e){if(t===e)return 0;const r=Ki(t),n=Ki(e);if(r!==n)return ct(r,n);switch(r){case 0:case 9007199254740991:return 0;case 1:return ct(t.booleanValue,e.booleanValue);case 2:return function(a,i){const o=$t(a.integerValue||a.doubleValue),l=$t(i.integerValue||i.doubleValue);return o<l?-1:o>l?1:o===l?0:isNaN(o)?isNaN(l)?0:-1:1}(t,e);case 3:return J_(t.timestampValue,e.timestampValue);case 4:return J_(Jc(t),Jc(e));case 5:return ct(t.stringValue,e.stringValue);case 6:return function(a,i){const o=Gi(a),l=Gi(i);return o.compareTo(l)}(t.bytesValue,e.bytesValue);case 7:return function(a,i){const o=a.split("/"),l=i.split("/");for(let c=0;c<o.length&&c<l.length;c++){const u=ct(o[c],l[c]);if(u!==0)return u}return ct(o.length,l.length)}(t.referenceValue,e.referenceValue);case 8:return function(a,i){const o=ct($t(a.latitude),$t(i.latitude));return o!==0?o:ct($t(a.longitude),$t(i.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return Z_(t.arrayValue,e.arrayValue);case 10:return function(a,i){var o,l,c,u;const h=a.fields||{},m=i.fields||{},p=(o=h.value)===null||o===void 0?void 0:o.arrayValue,x=(l=m.value)===null||l===void 0?void 0:l.arrayValue,v=ct(((c=p==null?void 0:p.values)===null||c===void 0?void 0:c.length)||0,((u=x==null?void 0:x.values)===null||u===void 0?void 0:u.length)||0);return v!==0?v:Z_(p,x)}(t.mapValue,e.mapValue);case 11:return function(a,i){if(a===Ef.mapValue&&i===Ef.mapValue)return 0;if(a===Ef.mapValue)return 1;if(i===Ef.mapValue)return-1;const o=a.fields||{},l=Object.keys(o),c=i.fields||{},u=Object.keys(c);l.sort(),u.sort();for(let h=0;h<l.length&&h<u.length;++h){const m=ct(l[h],u[h]);if(m!==0)return m;const p=ol(o[l[h]],c[u[h]]);if(p!==0)return p}return ct(l.length,u.length)}(t.mapValue,e.mapValue);default:throw Le()}}function J_(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return ct(t,e);const r=si(t),n=si(e),s=ct(r.seconds,n.seconds);return s!==0?s:ct(r.nanos,n.nanos)}function Z_(t,e){const r=t.values||[],n=e.values||[];for(let s=0;s<r.length&&s<n.length;++s){const a=ol(r[s],n[s]);if(a)return a}return ct(r.length,n.length)}function ll(t){return up(t)}function up(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(r){const n=si(r);return`time(${n.seconds},${n.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(r){return Gi(r).toBase64()}(t.bytesValue):"referenceValue"in t?function(r){return be.fromName(r).toString()}(t.referenceValue):"geoPointValue"in t?function(r){return`geo(${r.latitude},${r.longitude})`}(t.geoPointValue):"arrayValue"in t?function(r){let n="[",s=!0;for(const a of r.values||[])s?s=!1:n+=",",n+=up(a);return n+"]"}(t.arrayValue):"mapValue"in t?function(r){const n=Object.keys(r.fields||{}).sort();let s="{",a=!0;for(const i of n)a?a=!1:s+=",",s+=`${i}:${up(r.fields[i])}`;return s+"}"}(t.mapValue):Le()}function ey(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function fp(t){return!!t&&"integerValue"in t}function iv(t){return!!t&&"arrayValue"in t}function ty(t){return!!t&&"nullValue"in t}function ry(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function Jf(t){return!!t&&"mapValue"in t}function J3(t){var e,r;return((r=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||r===void 0?void 0:r.stringValue)==="__vector__"}function gc(t){if(t.geoPointValue)return{geoPointValue:Object.assign({},t.geoPointValue)};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:Object.assign({},t.timestampValue)};if(t.mapValue){const e={mapValue:{fields:{}}};return eo(t.mapValue.fields,(r,n)=>e.mapValue.fields[r]=gc(n)),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let r=0;r<(t.arrayValue.values||[]).length;++r)e.arrayValue.values[r]=gc(t.arrayValue.values[r]);return e}return Object.assign({},t)}function Z3(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ln{constructor(e){this.value=e}static empty(){return new ln({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let r=this.value;for(let n=0;n<e.length-1;++n)if(r=(r.mapValue.fields||{})[e.get(n)],!Jf(r))return null;return r=(r.mapValue.fields||{})[e.lastSegment()],r||null}}set(e,r){this.getFieldsMap(e.popLast())[e.lastSegment()]=gc(r)}setAll(e){let r=_r.emptyPath(),n={},s=[];e.forEach((i,o)=>{if(!r.isImmediateParentOf(o)){const l=this.getFieldsMap(r);this.applyChanges(l,n,s),n={},s=[],r=o.popLast()}i?n[o.lastSegment()]=gc(i):s.push(o.lastSegment())});const a=this.getFieldsMap(r);this.applyChanges(a,n,s)}delete(e){const r=this.field(e.popLast());Jf(r)&&r.mapValue.fields&&delete r.mapValue.fields[e.lastSegment()]}isEqual(e){return Cs(this.value,e.value)}getFieldsMap(e){let r=this.value;r.mapValue.fields||(r.mapValue={fields:{}});for(let n=0;n<e.length;++n){let s=r.mapValue.fields[e.get(n)];Jf(s)&&s.mapValue.fields||(s={mapValue:{fields:{}}},r.mapValue.fields[e.get(n)]=s),r=s}return r.mapValue.fields}applyChanges(e,r,n){eo(r,(s,a)=>e[s]=a);for(const s of n)delete e[s]}clone(){return new ln(gc(this.value))}}function Rk(t){const e=[];return eo(t.fields,(r,n)=>{const s=new _r([r]);if(Jf(n)){const a=Rk(n.mapValue).fields;if(a.length===0)e.push(s);else for(const i of a)e.push(s.child(i))}else e.push(s)}),new En(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mr{constructor(e,r,n,s,a,i,o){this.key=e,this.documentType=r,this.version=n,this.readTime=s,this.createTime=a,this.data=i,this.documentState=o}static newInvalidDocument(e){return new Mr(e,0,Ve.min(),Ve.min(),Ve.min(),ln.empty(),0)}static newFoundDocument(e,r,n,s){return new Mr(e,1,r,Ve.min(),n,s,0)}static newNoDocument(e,r){return new Mr(e,2,r,Ve.min(),Ve.min(),ln.empty(),0)}static newUnknownDocument(e,r){return new Mr(e,3,r,Ve.min(),Ve.min(),ln.empty(),2)}convertToFoundDocument(e,r){return!this.createTime.isEqual(Ve.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=r,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=ln.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=ln.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Ve.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof Mr&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Mr(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vh{constructor(e,r){this.position=e,this.inclusive=r}}function ny(t,e,r){let n=0;for(let s=0;s<t.position.length;s++){const a=e[s],i=t.position[s];if(a.field.isKeyField()?n=be.comparator(be.fromName(i.referenceValue),r.key):n=ol(i,r.data.field(a.field)),a.dir==="desc"&&(n*=-1),n!==0)break}return n}function sy(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let r=0;r<t.position.length;r++)if(!Cs(t.position[r],e.position[r]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Uh{constructor(e,r="asc"){this.field=e,this.dir=r}}function eF(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nk{}class Zt extends Nk{constructor(e,r,n){super(),this.field=e,this.op=r,this.value=n}static create(e,r,n){return e.isKeyField()?r==="in"||r==="not-in"?this.createKeyFieldInFilter(e,r,n):new rF(e,r,n):r==="array-contains"?new aF(e,n):r==="in"?new iF(e,n):r==="not-in"?new oF(e,n):r==="array-contains-any"?new lF(e,n):new Zt(e,r,n)}static createKeyFieldInFilter(e,r,n){return r==="in"?new nF(e,n):new sF(e,n)}matches(e){const r=e.data.field(this.field);return this.op==="!="?r!==null&&this.matchesComparison(ol(r,this.value)):r!==null&&Ki(this.value)===Ki(r)&&this.matchesComparison(ol(r,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return Le()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class us extends Nk{constructor(e,r){super(),this.filters=e,this.op=r,this.ae=null}static create(e,r){return new us(e,r)}matches(e){return Pk(this)?this.filters.find(r=>!r.matches(e))===void 0:this.filters.find(r=>r.matches(e))!==void 0}getFlattenedFilters(){return this.ae!==null||(this.ae=this.filters.reduce((e,r)=>e.concat(r.getFlattenedFilters()),[])),this.ae}getFilters(){return Object.assign([],this.filters)}}function Pk(t){return t.op==="and"}function bk(t){return tF(t)&&Pk(t)}function tF(t){for(const e of t.filters)if(e instanceof us)return!1;return!0}function hp(t){if(t instanceof Zt)return t.field.canonicalString()+t.op.toString()+ll(t.value);if(bk(t))return t.filters.map(e=>hp(e)).join(",");{const e=t.filters.map(r=>hp(r)).join(",");return`${t.op}(${e})`}}function Dk(t,e){return t instanceof Zt?function(n,s){return s instanceof Zt&&n.op===s.op&&n.field.isEqual(s.field)&&Cs(n.value,s.value)}(t,e):t instanceof us?function(n,s){return s instanceof us&&n.op===s.op&&n.filters.length===s.filters.length?n.filters.reduce((a,i,o)=>a&&Dk(i,s.filters[o]),!0):!1}(t,e):void Le()}function Fk(t){return t instanceof Zt?function(r){return`${r.field.canonicalString()} ${r.op} ${ll(r.value)}`}(t):t instanceof us?function(r){return r.op.toString()+" {"+r.getFilters().map(Fk).join(" ,")+"}"}(t):"Filter"}class rF extends Zt{constructor(e,r,n){super(e,r,n),this.key=be.fromName(n.referenceValue)}matches(e){const r=be.comparator(e.key,this.key);return this.matchesComparison(r)}}class nF extends Zt{constructor(e,r){super(e,"in",r),this.keys=Ok("in",r)}matches(e){return this.keys.some(r=>r.isEqual(e.key))}}class sF extends Zt{constructor(e,r){super(e,"not-in",r),this.keys=Ok("not-in",r)}matches(e){return!this.keys.some(r=>r.isEqual(e.key))}}function Ok(t,e){var r;return(((r=e.arrayValue)===null||r===void 0?void 0:r.values)||[]).map(n=>be.fromName(n.referenceValue))}class aF extends Zt{constructor(e,r){super(e,"array-contains",r)}matches(e){const r=e.data.field(this.field);return iv(r)&&eu(r.arrayValue,this.value)}}class iF extends Zt{constructor(e,r){super(e,"in",r)}matches(e){const r=e.data.field(this.field);return r!==null&&eu(this.value.arrayValue,r)}}class oF extends Zt{constructor(e,r){super(e,"not-in",r)}matches(e){if(eu(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const r=e.data.field(this.field);return r!==null&&!eu(this.value.arrayValue,r)}}class lF extends Zt{constructor(e,r){super(e,"array-contains-any",r)}matches(e){const r=e.data.field(this.field);return!(!iv(r)||!r.arrayValue.values)&&r.arrayValue.values.some(n=>eu(this.value.arrayValue,n))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cF{constructor(e,r=null,n=[],s=[],a=null,i=null,o=null){this.path=e,this.collectionGroup=r,this.orderBy=n,this.filters=s,this.limit=a,this.startAt=i,this.endAt=o,this.ue=null}}function ay(t,e=null,r=[],n=[],s=null,a=null,i=null){return new cF(t,e,r,n,s,a,i)}function ov(t){const e=Be(t);if(e.ue===null){let r=e.path.canonicalString();e.collectionGroup!==null&&(r+="|cg:"+e.collectionGroup),r+="|f:",r+=e.filters.map(n=>hp(n)).join(","),r+="|ob:",r+=e.orderBy.map(n=>function(a){return a.field.canonicalString()+a.dir}(n)).join(","),bd(e.limit)||(r+="|l:",r+=e.limit),e.startAt&&(r+="|lb:",r+=e.startAt.inclusive?"b:":"a:",r+=e.startAt.position.map(n=>ll(n)).join(",")),e.endAt&&(r+="|ub:",r+=e.endAt.inclusive?"a:":"b:",r+=e.endAt.position.map(n=>ll(n)).join(",")),e.ue=r}return e.ue}function lv(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let r=0;r<t.orderBy.length;r++)if(!eF(t.orderBy[r],e.orderBy[r]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let r=0;r<t.filters.length;r++)if(!Dk(t.filters[r],e.filters[r]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!sy(t.startAt,e.startAt)&&sy(t.endAt,e.endAt)}function dp(t){return be.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cu{constructor(e,r=null,n=[],s=[],a=null,i="F",o=null,l=null){this.path=e,this.collectionGroup=r,this.explicitOrderBy=n,this.filters=s,this.limit=a,this.limitType=i,this.startAt=o,this.endAt=l,this.ce=null,this.le=null,this.he=null,this.startAt,this.endAt}}function uF(t,e,r,n,s,a,i,o){return new Cu(t,e,r,n,s,a,i,o)}function Dd(t){return new Cu(t)}function iy(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function Mk(t){return t.collectionGroup!==null}function vc(t){const e=Be(t);if(e.ce===null){e.ce=[];const r=new Set;for(const a of e.explicitOrderBy)e.ce.push(a),r.add(a.field.canonicalString());const n=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(i){let o=new wr(_r.comparator);return i.filters.forEach(l=>{l.getFlattenedFilters().forEach(c=>{c.isInequality()&&(o=o.add(c.field))})}),o})(e).forEach(a=>{r.has(a.canonicalString())||a.isKeyField()||e.ce.push(new Uh(a,n))}),r.has(_r.keyField().canonicalString())||e.ce.push(new Uh(_r.keyField(),n))}return e.ce}function Ss(t){const e=Be(t);return e.le||(e.le=fF(e,vc(t))),e.le}function fF(t,e){if(t.limitType==="F")return ay(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map(s=>{const a=s.dir==="desc"?"asc":"desc";return new Uh(s.field,a)});const r=t.endAt?new Vh(t.endAt.position,t.endAt.inclusive):null,n=t.startAt?new Vh(t.startAt.position,t.startAt.inclusive):null;return ay(t.path,t.collectionGroup,e,t.filters,t.limit,r,n)}}function mp(t,e){const r=t.filters.concat([e]);return new Cu(t.path,t.collectionGroup,t.explicitOrderBy.slice(),r,t.limit,t.limitType,t.startAt,t.endAt)}function pp(t,e,r){return new Cu(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,r,t.startAt,t.endAt)}function Fd(t,e){return lv(Ss(t),Ss(e))&&t.limitType===e.limitType}function Lk(t){return`${ov(Ss(t))}|lt:${t.limitType}`}function _o(t){return`Query(target=${function(r){let n=r.path.canonicalString();return r.collectionGroup!==null&&(n+=" collectionGroup="+r.collectionGroup),r.filters.length>0&&(n+=`, filters: [${r.filters.map(s=>Fk(s)).join(", ")}]`),bd(r.limit)||(n+=", limit: "+r.limit),r.orderBy.length>0&&(n+=`, orderBy: [${r.orderBy.map(s=>function(i){return`${i.field.canonicalString()} (${i.dir})`}(s)).join(", ")}]`),r.startAt&&(n+=", startAt: ",n+=r.startAt.inclusive?"b:":"a:",n+=r.startAt.position.map(s=>ll(s)).join(",")),r.endAt&&(n+=", endAt: ",n+=r.endAt.inclusive?"a:":"b:",n+=r.endAt.position.map(s=>ll(s)).join(",")),`Target(${n})`}(Ss(t))}; limitType=${t.limitType})`}function Od(t,e){return e.isFoundDocument()&&function(n,s){const a=s.key.path;return n.collectionGroup!==null?s.key.hasCollectionId(n.collectionGroup)&&n.path.isPrefixOf(a):be.isDocumentKey(n.path)?n.path.isEqual(a):n.path.isImmediateParentOf(a)}(t,e)&&function(n,s){for(const a of vc(n))if(!a.field.isKeyField()&&s.data.field(a.field)===null)return!1;return!0}(t,e)&&function(n,s){for(const a of n.filters)if(!a.matches(s))return!1;return!0}(t,e)&&function(n,s){return!(n.startAt&&!function(i,o,l){const c=ny(i,o,l);return i.inclusive?c<=0:c<0}(n.startAt,vc(n),s)||n.endAt&&!function(i,o,l){const c=ny(i,o,l);return i.inclusive?c>=0:c>0}(n.endAt,vc(n),s))}(t,e)}function hF(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function jk(t){return(e,r)=>{let n=!1;for(const s of vc(t)){const a=dF(s,e,r);if(a!==0)return a;n=n||s.field.isKeyField()}return 0}}function dF(t,e,r){const n=t.field.isKeyField()?be.comparator(e.key,r.key):function(a,i,o){const l=i.data.field(a),c=o.data.field(a);return l!==null&&c!==null?ol(l,c):Le()}(t.field,e,r);switch(t.dir){case"asc":return n;case"desc":return-1*n;default:return Le()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wl{constructor(e,r){this.mapKeyFn=e,this.equalsFn=r,this.inner={},this.innerSize=0}get(e){const r=this.mapKeyFn(e),n=this.inner[r];if(n!==void 0){for(const[s,a]of n)if(this.equalsFn(s,e))return a}}has(e){return this.get(e)!==void 0}set(e,r){const n=this.mapKeyFn(e),s=this.inner[n];if(s===void 0)return this.inner[n]=[[e,r]],void this.innerSize++;for(let a=0;a<s.length;a++)if(this.equalsFn(s[a][0],e))return void(s[a]=[e,r]);s.push([e,r]),this.innerSize++}delete(e){const r=this.mapKeyFn(e),n=this.inner[r];if(n===void 0)return!1;for(let s=0;s<n.length;s++)if(this.equalsFn(n[s][0],e))return n.length===1?delete this.inner[r]:n.splice(s,1),this.innerSize--,!0;return!1}forEach(e){eo(this.inner,(r,n)=>{for(const[s,a]of n)e(s,a)})}isEmpty(){return Ik(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mF=new Lt(be.comparator);function ma(){return mF}const Vk=new Lt(be.comparator);function Zl(...t){let e=Vk;for(const r of t)e=e.insert(r.key,r);return e}function Uk(t){let e=Vk;return t.forEach((r,n)=>e=e.insert(r,n.overlayedDocument)),e}function Ni(){return xc()}function Bk(){return xc()}function xc(){return new wl(t=>t.toString(),(t,e)=>t.isEqual(e))}const pF=new Lt(be.comparator),gF=new wr(be.comparator);function Xe(...t){let e=gF;for(const r of t)e=e.add(r);return e}const vF=new wr(ct);function xF(){return vF}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cv(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:jh(e)?"-0":e}}function zk(t){return{integerValue:""+t}}function $k(t,e){return X3(e)?zk(e):cv(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Md{constructor(){this._=void 0}}function _F(t,e,r){return t instanceof tu?function(s,a){const i={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:s.seconds,nanos:s.nanoseconds}}}};return a&&sv(a)&&(a=av(a)),a&&(i.fields.__previous_value__=a),{mapValue:i}}(r,e):t instanceof ru?Hk(t,e):t instanceof nu?Gk(t,e):function(s,a){const i=Wk(s,a),o=oy(i)+oy(s.Pe);return fp(i)&&fp(s.Pe)?zk(o):cv(s.serializer,o)}(t,e)}function yF(t,e,r){return t instanceof ru?Hk(t,e):t instanceof nu?Gk(t,e):r}function Wk(t,e){return t instanceof su?function(n){return fp(n)||function(a){return!!a&&"doubleValue"in a}(n)}(e)?e:{integerValue:0}:null}class tu extends Md{}class ru extends Md{constructor(e){super(),this.elements=e}}function Hk(t,e){const r=Kk(e);for(const n of t.elements)r.some(s=>Cs(s,n))||r.push(n);return{arrayValue:{values:r}}}class nu extends Md{constructor(e){super(),this.elements=e}}function Gk(t,e){let r=Kk(e);for(const n of t.elements)r=r.filter(s=>!Cs(s,n));return{arrayValue:{values:r}}}class su extends Md{constructor(e,r){super(),this.serializer=e,this.Pe=r}}function oy(t){return $t(t.integerValue||t.doubleValue)}function Kk(t){return iv(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qk{constructor(e,r){this.field=e,this.transform=r}}function wF(t,e){return t.field.isEqual(e.field)&&function(n,s){return n instanceof ru&&s instanceof ru||n instanceof nu&&s instanceof nu?il(n.elements,s.elements,Cs):n instanceof su&&s instanceof su?Cs(n.Pe,s.Pe):n instanceof tu&&s instanceof tu}(t.transform,e.transform)}class EF{constructor(e,r){this.version=e,this.transformResults=r}}class Un{constructor(e,r){this.updateTime=e,this.exists=r}static none(){return new Un}static exists(e){return new Un(void 0,e)}static updateTime(e){return new Un(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Zf(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class Ld{}function Xk(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new uv(t.key,Un.none()):new Ru(t.key,t.data,Un.none());{const r=t.data,n=ln.empty();let s=new wr(_r.comparator);for(let a of e.fields)if(!s.has(a)){let i=r.field(a);i===null&&a.length>1&&(a=a.popLast(),i=r.field(a)),i===null?n.delete(a):n.set(a,i),s=s.add(a)}return new mi(t.key,n,new En(s.toArray()),Un.none())}}function TF(t,e,r){t instanceof Ru?function(s,a,i){const o=s.value.clone(),l=cy(s.fieldTransforms,a,i.transformResults);o.setAll(l),a.convertToFoundDocument(i.version,o).setHasCommittedMutations()}(t,e,r):t instanceof mi?function(s,a,i){if(!Zf(s.precondition,a))return void a.convertToUnknownDocument(i.version);const o=cy(s.fieldTransforms,a,i.transformResults),l=a.data;l.setAll(Yk(s)),l.setAll(o),a.convertToFoundDocument(i.version,l).setHasCommittedMutations()}(t,e,r):function(s,a,i){a.convertToNoDocument(i.version).setHasCommittedMutations()}(0,e,r)}function _c(t,e,r,n){return t instanceof Ru?function(a,i,o,l){if(!Zf(a.precondition,i))return o;const c=a.value.clone(),u=uy(a.fieldTransforms,l,i);return c.setAll(u),i.convertToFoundDocument(i.version,c).setHasLocalMutations(),null}(t,e,r,n):t instanceof mi?function(a,i,o,l){if(!Zf(a.precondition,i))return o;const c=uy(a.fieldTransforms,l,i),u=i.data;return u.setAll(Yk(a)),u.setAll(c),i.convertToFoundDocument(i.version,u).setHasLocalMutations(),o===null?null:o.unionWith(a.fieldMask.fields).unionWith(a.fieldTransforms.map(h=>h.field))}(t,e,r,n):function(a,i,o){return Zf(a.precondition,i)?(i.convertToNoDocument(i.version).setHasLocalMutations(),null):o}(t,e,r)}function kF(t,e){let r=null;for(const n of t.fieldTransforms){const s=e.data.field(n.field),a=Wk(n.transform,s||null);a!=null&&(r===null&&(r=ln.empty()),r.set(n.field,a))}return r||null}function ly(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(n,s){return n===void 0&&s===void 0||!(!n||!s)&&il(n,s,(a,i)=>wF(a,i))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class Ru extends Ld{constructor(e,r,n,s=[]){super(),this.key=e,this.value=r,this.precondition=n,this.fieldTransforms=s,this.type=0}getFieldMask(){return null}}class mi extends Ld{constructor(e,r,n,s,a=[]){super(),this.key=e,this.data=r,this.fieldMask=n,this.precondition=s,this.fieldTransforms=a,this.type=1}getFieldMask(){return this.fieldMask}}function Yk(t){const e=new Map;return t.fieldMask.fields.forEach(r=>{if(!r.isEmpty()){const n=t.data.field(r);e.set(r,n)}}),e}function cy(t,e,r){const n=new Map;gt(t.length===r.length);for(let s=0;s<r.length;s++){const a=t[s],i=a.transform,o=e.data.field(a.field);n.set(a.field,yF(i,o,r[s]))}return n}function uy(t,e,r){const n=new Map;for(const s of t){const a=s.transform,i=r.data.field(s.field);n.set(s.field,_F(a,i,e))}return n}class uv extends Ld{constructor(e,r){super(),this.key=e,this.precondition=r,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class SF extends Ld{constructor(e,r){super(),this.key=e,this.precondition=r,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AF{constructor(e,r,n,s){this.batchId=e,this.localWriteTime=r,this.baseMutations=n,this.mutations=s}applyToRemoteDocument(e,r){const n=r.mutationResults;for(let s=0;s<this.mutations.length;s++){const a=this.mutations[s];a.key.isEqual(e.key)&&TF(a,e,n[s])}}applyToLocalView(e,r){for(const n of this.baseMutations)n.key.isEqual(e.key)&&(r=_c(n,e,r,this.localWriteTime));for(const n of this.mutations)n.key.isEqual(e.key)&&(r=_c(n,e,r,this.localWriteTime));return r}applyToLocalDocumentSet(e,r){const n=Bk();return this.mutations.forEach(s=>{const a=e.get(s.key),i=a.overlayedDocument;let o=this.applyToLocalView(i,a.mutatedFields);o=r.has(s.key)?null:o;const l=Xk(i,o);l!==null&&n.set(s.key,l),i.isValidDocument()||i.convertToNoDocument(Ve.min())}),n}keys(){return this.mutations.reduce((e,r)=>e.add(r.key),Xe())}isEqual(e){return this.batchId===e.batchId&&il(this.mutations,e.mutations,(r,n)=>ly(r,n))&&il(this.baseMutations,e.baseMutations,(r,n)=>ly(r,n))}}class fv{constructor(e,r,n,s){this.batch=e,this.commitVersion=r,this.mutationResults=n,this.docVersions=s}static from(e,r,n){gt(e.mutations.length===n.length);let s=function(){return pF}();const a=e.mutations;for(let i=0;i<a.length;i++)s=s.insert(a[i].key,n[i].version);return new fv(e,r,n,s)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class IF{constructor(e,r){this.largestBatchId=e,this.mutation=r}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class CF{constructor(e,r){this.count=e,this.unchangedNames=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var qt,Ze;function RF(t){switch(t){default:return Le();case fe.CANCELLED:case fe.UNKNOWN:case fe.DEADLINE_EXCEEDED:case fe.RESOURCE_EXHAUSTED:case fe.INTERNAL:case fe.UNAVAILABLE:case fe.UNAUTHENTICATED:return!1;case fe.INVALID_ARGUMENT:case fe.NOT_FOUND:case fe.ALREADY_EXISTS:case fe.PERMISSION_DENIED:case fe.FAILED_PRECONDITION:case fe.ABORTED:case fe.OUT_OF_RANGE:case fe.UNIMPLEMENTED:case fe.DATA_LOSS:return!0}}function Qk(t){if(t===void 0)return da("GRPC error has no .code"),fe.UNKNOWN;switch(t){case qt.OK:return fe.OK;case qt.CANCELLED:return fe.CANCELLED;case qt.UNKNOWN:return fe.UNKNOWN;case qt.DEADLINE_EXCEEDED:return fe.DEADLINE_EXCEEDED;case qt.RESOURCE_EXHAUSTED:return fe.RESOURCE_EXHAUSTED;case qt.INTERNAL:return fe.INTERNAL;case qt.UNAVAILABLE:return fe.UNAVAILABLE;case qt.UNAUTHENTICATED:return fe.UNAUTHENTICATED;case qt.INVALID_ARGUMENT:return fe.INVALID_ARGUMENT;case qt.NOT_FOUND:return fe.NOT_FOUND;case qt.ALREADY_EXISTS:return fe.ALREADY_EXISTS;case qt.PERMISSION_DENIED:return fe.PERMISSION_DENIED;case qt.FAILED_PRECONDITION:return fe.FAILED_PRECONDITION;case qt.ABORTED:return fe.ABORTED;case qt.OUT_OF_RANGE:return fe.OUT_OF_RANGE;case qt.UNIMPLEMENTED:return fe.UNIMPLEMENTED;case qt.DATA_LOSS:return fe.DATA_LOSS;default:return Le()}}(Ze=qt||(qt={}))[Ze.OK=0]="OK",Ze[Ze.CANCELLED=1]="CANCELLED",Ze[Ze.UNKNOWN=2]="UNKNOWN",Ze[Ze.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Ze[Ze.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Ze[Ze.NOT_FOUND=5]="NOT_FOUND",Ze[Ze.ALREADY_EXISTS=6]="ALREADY_EXISTS",Ze[Ze.PERMISSION_DENIED=7]="PERMISSION_DENIED",Ze[Ze.UNAUTHENTICATED=16]="UNAUTHENTICATED",Ze[Ze.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Ze[Ze.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Ze[Ze.ABORTED=10]="ABORTED",Ze[Ze.OUT_OF_RANGE=11]="OUT_OF_RANGE",Ze[Ze.UNIMPLEMENTED=12]="UNIMPLEMENTED",Ze[Ze.INTERNAL=13]="INTERNAL",Ze[Ze.UNAVAILABLE=14]="UNAVAILABLE",Ze[Ze.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function NF(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const PF=new Oi([4294967295,4294967295],0);function fy(t){const e=NF().encode(t),r=new _k;return r.update(e),new Uint8Array(r.digest())}function hy(t){const e=new DataView(t.buffer),r=e.getUint32(0,!0),n=e.getUint32(4,!0),s=e.getUint32(8,!0),a=e.getUint32(12,!0);return[new Oi([r,n],0),new Oi([s,a],0)]}class hv{constructor(e,r,n){if(this.bitmap=e,this.padding=r,this.hashCount=n,r<0||r>=8)throw new ec(`Invalid padding: ${r}`);if(n<0)throw new ec(`Invalid hash count: ${n}`);if(e.length>0&&this.hashCount===0)throw new ec(`Invalid hash count: ${n}`);if(e.length===0&&r!==0)throw new ec(`Invalid padding when bitmap length is 0: ${r}`);this.Ie=8*e.length-r,this.Te=Oi.fromNumber(this.Ie)}Ee(e,r,n){let s=e.add(r.multiply(Oi.fromNumber(n)));return s.compare(PF)===1&&(s=new Oi([s.getBits(0),s.getBits(1)],0)),s.modulo(this.Te).toNumber()}de(e){return(this.bitmap[Math.floor(e/8)]&1<<e%8)!=0}mightContain(e){if(this.Ie===0)return!1;const r=fy(e),[n,s]=hy(r);for(let a=0;a<this.hashCount;a++){const i=this.Ee(n,s,a);if(!this.de(i))return!1}return!0}static create(e,r,n){const s=e%8==0?0:8-e%8,a=new Uint8Array(Math.ceil(e/8)),i=new hv(a,s,r);return n.forEach(o=>i.insert(o)),i}insert(e){if(this.Ie===0)return;const r=fy(e),[n,s]=hy(r);for(let a=0;a<this.hashCount;a++){const i=this.Ee(n,s,a);this.Ae(i)}}Ae(e){const r=Math.floor(e/8),n=e%8;this.bitmap[r]|=1<<n}}class ec extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jd{constructor(e,r,n,s,a){this.snapshotVersion=e,this.targetChanges=r,this.targetMismatches=n,this.documentUpdates=s,this.resolvedLimboDocuments=a}static createSynthesizedRemoteEventForCurrentChange(e,r,n){const s=new Map;return s.set(e,Nu.createSynthesizedTargetChangeForCurrentChange(e,r,n)),new jd(Ve.min(),s,new Lt(ct),ma(),Xe())}}class Nu{constructor(e,r,n,s,a){this.resumeToken=e,this.current=r,this.addedDocuments=n,this.modifiedDocuments=s,this.removedDocuments=a}static createSynthesizedTargetChangeForCurrentChange(e,r,n){return new Nu(n,r,Xe(),Xe(),Xe())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eh{constructor(e,r,n,s){this.Re=e,this.removedTargetIds=r,this.key=n,this.Ve=s}}class Jk{constructor(e,r){this.targetId=e,this.me=r}}class Zk{constructor(e,r,n=Sr.EMPTY_BYTE_STRING,s=null){this.state=e,this.targetIds=r,this.resumeToken=n,this.cause=s}}class dy{constructor(){this.fe=0,this.ge=py(),this.pe=Sr.EMPTY_BYTE_STRING,this.ye=!1,this.we=!0}get current(){return this.ye}get resumeToken(){return this.pe}get Se(){return this.fe!==0}get be(){return this.we}De(e){e.approximateByteSize()>0&&(this.we=!0,this.pe=e)}ve(){let e=Xe(),r=Xe(),n=Xe();return this.ge.forEach((s,a)=>{switch(a){case 0:e=e.add(s);break;case 2:r=r.add(s);break;case 1:n=n.add(s);break;default:Le()}}),new Nu(this.pe,this.ye,e,r,n)}Ce(){this.we=!1,this.ge=py()}Fe(e,r){this.we=!0,this.ge=this.ge.insert(e,r)}Me(e){this.we=!0,this.ge=this.ge.remove(e)}xe(){this.fe+=1}Oe(){this.fe-=1,gt(this.fe>=0)}Ne(){this.we=!0,this.ye=!0}}class bF{constructor(e){this.Le=e,this.Be=new Map,this.ke=ma(),this.qe=my(),this.Qe=new Lt(ct)}Ke(e){for(const r of e.Re)e.Ve&&e.Ve.isFoundDocument()?this.$e(r,e.Ve):this.Ue(r,e.key,e.Ve);for(const r of e.removedTargetIds)this.Ue(r,e.key,e.Ve)}We(e){this.forEachTarget(e,r=>{const n=this.Ge(r);switch(e.state){case 0:this.ze(r)&&n.De(e.resumeToken);break;case 1:n.Oe(),n.Se||n.Ce(),n.De(e.resumeToken);break;case 2:n.Oe(),n.Se||this.removeTarget(r);break;case 3:this.ze(r)&&(n.Ne(),n.De(e.resumeToken));break;case 4:this.ze(r)&&(this.je(r),n.De(e.resumeToken));break;default:Le()}})}forEachTarget(e,r){e.targetIds.length>0?e.targetIds.forEach(r):this.Be.forEach((n,s)=>{this.ze(s)&&r(s)})}He(e){const r=e.targetId,n=e.me.count,s=this.Je(r);if(s){const a=s.target;if(dp(a))if(n===0){const i=new be(a.path);this.Ue(r,i,Mr.newNoDocument(i,Ve.min()))}else gt(n===1);else{const i=this.Ye(r);if(i!==n){const o=this.Ze(e),l=o?this.Xe(o,e,i):1;if(l!==0){this.je(r);const c=l===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Qe=this.Qe.insert(r,c)}}}}}Ze(e){const r=e.me.unchangedNames;if(!r||!r.bits)return null;const{bits:{bitmap:n="",padding:s=0},hashCount:a=0}=r;let i,o;try{i=Gi(n).toUint8Array()}catch(l){if(l instanceof Ck)return al("Decoding the base64 bloom filter in existence filter failed ("+l.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw l}try{o=new hv(i,s,a)}catch(l){return al(l instanceof ec?"BloomFilter error: ":"Applying bloom filter failed: ",l),null}return o.Ie===0?null:o}Xe(e,r,n){return r.me.count===n-this.nt(e,r.targetId)?0:2}nt(e,r){const n=this.Le.getRemoteKeysForTarget(r);let s=0;return n.forEach(a=>{const i=this.Le.tt(),o=`projects/${i.projectId}/databases/${i.database}/documents/${a.path.canonicalString()}`;e.mightContain(o)||(this.Ue(r,a,null),s++)}),s}rt(e){const r=new Map;this.Be.forEach((a,i)=>{const o=this.Je(i);if(o){if(a.current&&dp(o.target)){const l=new be(o.target.path);this.ke.get(l)!==null||this.it(i,l)||this.Ue(i,l,Mr.newNoDocument(l,e))}a.be&&(r.set(i,a.ve()),a.Ce())}});let n=Xe();this.qe.forEach((a,i)=>{let o=!0;i.forEachWhile(l=>{const c=this.Je(l);return!c||c.purpose==="TargetPurposeLimboResolution"||(o=!1,!1)}),o&&(n=n.add(a))}),this.ke.forEach((a,i)=>i.setReadTime(e));const s=new jd(e,r,this.Qe,this.ke,n);return this.ke=ma(),this.qe=my(),this.Qe=new Lt(ct),s}$e(e,r){if(!this.ze(e))return;const n=this.it(e,r.key)?2:0;this.Ge(e).Fe(r.key,n),this.ke=this.ke.insert(r.key,r),this.qe=this.qe.insert(r.key,this.st(r.key).add(e))}Ue(e,r,n){if(!this.ze(e))return;const s=this.Ge(e);this.it(e,r)?s.Fe(r,1):s.Me(r),this.qe=this.qe.insert(r,this.st(r).delete(e)),n&&(this.ke=this.ke.insert(r,n))}removeTarget(e){this.Be.delete(e)}Ye(e){const r=this.Ge(e).ve();return this.Le.getRemoteKeysForTarget(e).size+r.addedDocuments.size-r.removedDocuments.size}xe(e){this.Ge(e).xe()}Ge(e){let r=this.Be.get(e);return r||(r=new dy,this.Be.set(e,r)),r}st(e){let r=this.qe.get(e);return r||(r=new wr(ct),this.qe=this.qe.insert(e,r)),r}ze(e){const r=this.Je(e)!==null;return r||Pe("WatchChangeAggregator","Detected inactive target",e),r}Je(e){const r=this.Be.get(e);return r&&r.Se?null:this.Le.ot(e)}je(e){this.Be.set(e,new dy),this.Le.getRemoteKeysForTarget(e).forEach(r=>{this.Ue(e,r,null)})}it(e,r){return this.Le.getRemoteKeysForTarget(e).has(r)}}function my(){return new Lt(be.comparator)}function py(){return new Lt(be.comparator)}const DF={asc:"ASCENDING",desc:"DESCENDING"},FF={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},OF={and:"AND",or:"OR"};class MF{constructor(e,r){this.databaseId=e,this.useProto3Json=r}}function gp(t,e){return t.useProto3Json||bd(e)?e:{value:e}}function Bh(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function eS(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function LF(t,e){return Bh(t,e.toTimestamp())}function As(t){return gt(!!t),Ve.fromTimestamp(function(r){const n=si(r);return new ar(n.seconds,n.nanos)}(t))}function dv(t,e){return vp(t,e).canonicalString()}function vp(t,e){const r=function(s){return new Ct(["projects",s.projectId,"databases",s.database])}(t).child("documents");return e===void 0?r:r.child(e)}function tS(t){const e=Ct.fromString(t);return gt(iS(e)),e}function xp(t,e){return dv(t.databaseId,e.path)}function $0(t,e){const r=tS(e);if(r.get(1)!==t.databaseId.projectId)throw new Ne(fe.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+r.get(1)+" vs "+t.databaseId.projectId);if(r.get(3)!==t.databaseId.database)throw new Ne(fe.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+r.get(3)+" vs "+t.databaseId.database);return new be(nS(r))}function rS(t,e){return dv(t.databaseId,e)}function jF(t){const e=tS(t);return e.length===4?Ct.emptyPath():nS(e)}function _p(t){return new Ct(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function nS(t){return gt(t.length>4&&t.get(4)==="documents"),t.popFirst(5)}function gy(t,e,r){return{name:xp(t,e),fields:r.value.mapValue.fields}}function VF(t,e){let r;if("targetChange"in e){e.targetChange;const n=function(c){return c==="NO_CHANGE"?0:c==="ADD"?1:c==="REMOVE"?2:c==="CURRENT"?3:c==="RESET"?4:Le()}(e.targetChange.targetChangeType||"NO_CHANGE"),s=e.targetChange.targetIds||[],a=function(c,u){return c.useProto3Json?(gt(u===void 0||typeof u=="string"),Sr.fromBase64String(u||"")):(gt(u===void 0||u instanceof Buffer||u instanceof Uint8Array),Sr.fromUint8Array(u||new Uint8Array))}(t,e.targetChange.resumeToken),i=e.targetChange.cause,o=i&&function(c){const u=c.code===void 0?fe.UNKNOWN:Qk(c.code);return new Ne(u,c.message||"")}(i);r=new Zk(n,s,a,o||null)}else if("documentChange"in e){e.documentChange;const n=e.documentChange;n.document,n.document.name,n.document.updateTime;const s=$0(t,n.document.name),a=As(n.document.updateTime),i=n.document.createTime?As(n.document.createTime):Ve.min(),o=new ln({mapValue:{fields:n.document.fields}}),l=Mr.newFoundDocument(s,a,i,o),c=n.targetIds||[],u=n.removedTargetIds||[];r=new eh(c,u,l.key,l)}else if("documentDelete"in e){e.documentDelete;const n=e.documentDelete;n.document;const s=$0(t,n.document),a=n.readTime?As(n.readTime):Ve.min(),i=Mr.newNoDocument(s,a),o=n.removedTargetIds||[];r=new eh([],o,i.key,i)}else if("documentRemove"in e){e.documentRemove;const n=e.documentRemove;n.document;const s=$0(t,n.document),a=n.removedTargetIds||[];r=new eh([],a,s,null)}else{if(!("filter"in e))return Le();{e.filter;const n=e.filter;n.targetId;const{count:s=0,unchangedNames:a}=n,i=new CF(s,a),o=n.targetId;r=new Jk(o,i)}}return r}function UF(t,e){let r;if(e instanceof Ru)r={update:gy(t,e.key,e.value)};else if(e instanceof uv)r={delete:xp(t,e.key)};else if(e instanceof mi)r={update:gy(t,e.key,e.data),updateMask:XF(e.fieldMask)};else{if(!(e instanceof SF))return Le();r={verify:xp(t,e.key)}}return e.fieldTransforms.length>0&&(r.updateTransforms=e.fieldTransforms.map(n=>function(a,i){const o=i.transform;if(o instanceof tu)return{fieldPath:i.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(o instanceof ru)return{fieldPath:i.field.canonicalString(),appendMissingElements:{values:o.elements}};if(o instanceof nu)return{fieldPath:i.field.canonicalString(),removeAllFromArray:{values:o.elements}};if(o instanceof su)return{fieldPath:i.field.canonicalString(),increment:o.Pe};throw Le()}(0,n))),e.precondition.isNone||(r.currentDocument=function(s,a){return a.updateTime!==void 0?{updateTime:LF(s,a.updateTime)}:a.exists!==void 0?{exists:a.exists}:Le()}(t,e.precondition)),r}function BF(t,e){return t&&t.length>0?(gt(e!==void 0),t.map(r=>function(s,a){let i=s.updateTime?As(s.updateTime):As(a);return i.isEqual(Ve.min())&&(i=As(a)),new EF(i,s.transformResults||[])}(r,e))):[]}function zF(t,e){return{documents:[rS(t,e.path)]}}function $F(t,e){const r={structuredQuery:{}},n=e.path;let s;e.collectionGroup!==null?(s=n,r.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(s=n.popLast(),r.structuredQuery.from=[{collectionId:n.lastSegment()}]),r.parent=rS(t,s);const a=function(c){if(c.length!==0)return aS(us.create(c,"and"))}(e.filters);a&&(r.structuredQuery.where=a);const i=function(c){if(c.length!==0)return c.map(u=>function(m){return{field:yo(m.field),direction:GF(m.dir)}}(u))}(e.orderBy);i&&(r.structuredQuery.orderBy=i);const o=gp(t,e.limit);return o!==null&&(r.structuredQuery.limit=o),e.startAt&&(r.structuredQuery.startAt=function(c){return{before:c.inclusive,values:c.position}}(e.startAt)),e.endAt&&(r.structuredQuery.endAt=function(c){return{before:!c.inclusive,values:c.position}}(e.endAt)),{_t:r,parent:s}}function WF(t){let e=jF(t.parent);const r=t.structuredQuery,n=r.from?r.from.length:0;let s=null;if(n>0){gt(n===1);const u=r.from[0];u.allDescendants?s=u.collectionId:e=e.child(u.collectionId)}let a=[];r.where&&(a=function(h){const m=sS(h);return m instanceof us&&bk(m)?m.getFilters():[m]}(r.where));let i=[];r.orderBy&&(i=function(h){return h.map(m=>function(x){return new Uh(wo(x.field),function(w){switch(w){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(x.direction))}(m))}(r.orderBy));let o=null;r.limit&&(o=function(h){let m;return m=typeof h=="object"?h.value:h,bd(m)?null:m}(r.limit));let l=null;r.startAt&&(l=function(h){const m=!!h.before,p=h.values||[];return new Vh(p,m)}(r.startAt));let c=null;return r.endAt&&(c=function(h){const m=!h.before,p=h.values||[];return new Vh(p,m)}(r.endAt)),uF(e,s,i,a,o,"F",l,c)}function HF(t,e){const r=function(s){switch(s){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return Le()}}(e.purpose);return r==null?null:{"goog-listen-tags":r}}function sS(t){return t.unaryFilter!==void 0?function(r){switch(r.unaryFilter.op){case"IS_NAN":const n=wo(r.unaryFilter.field);return Zt.create(n,"==",{doubleValue:NaN});case"IS_NULL":const s=wo(r.unaryFilter.field);return Zt.create(s,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const a=wo(r.unaryFilter.field);return Zt.create(a,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const i=wo(r.unaryFilter.field);return Zt.create(i,"!=",{nullValue:"NULL_VALUE"});default:return Le()}}(t):t.fieldFilter!==void 0?function(r){return Zt.create(wo(r.fieldFilter.field),function(s){switch(s){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return Le()}}(r.fieldFilter.op),r.fieldFilter.value)}(t):t.compositeFilter!==void 0?function(r){return us.create(r.compositeFilter.filters.map(n=>sS(n)),function(s){switch(s){case"AND":return"and";case"OR":return"or";default:return Le()}}(r.compositeFilter.op))}(t):Le()}function GF(t){return DF[t]}function KF(t){return FF[t]}function qF(t){return OF[t]}function yo(t){return{fieldPath:t.canonicalString()}}function wo(t){return _r.fromServerFormat(t.fieldPath)}function aS(t){return t instanceof Zt?function(r){if(r.op==="=="){if(ry(r.value))return{unaryFilter:{field:yo(r.field),op:"IS_NAN"}};if(ty(r.value))return{unaryFilter:{field:yo(r.field),op:"IS_NULL"}}}else if(r.op==="!="){if(ry(r.value))return{unaryFilter:{field:yo(r.field),op:"IS_NOT_NAN"}};if(ty(r.value))return{unaryFilter:{field:yo(r.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:yo(r.field),op:KF(r.op),value:r.value}}}(t):t instanceof us?function(r){const n=r.getFilters().map(s=>aS(s));return n.length===1?n[0]:{compositeFilter:{op:qF(r.op),filters:n}}}(t):Le()}function XF(t){const e=[];return t.fields.forEach(r=>e.push(r.canonicalString())),{fieldPaths:e}}function iS(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Va{constructor(e,r,n,s,a=Ve.min(),i=Ve.min(),o=Sr.EMPTY_BYTE_STRING,l=null){this.target=e,this.targetId=r,this.purpose=n,this.sequenceNumber=s,this.snapshotVersion=a,this.lastLimboFreeSnapshotVersion=i,this.resumeToken=o,this.expectedCount=l}withSequenceNumber(e){return new Va(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,r){return new Va(this.target,this.targetId,this.purpose,this.sequenceNumber,r,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Va(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Va(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YF{constructor(e){this.ct=e}}function QF(t){const e=WF({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?pp(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JF{constructor(){this.un=new ZF}addToCollectionParentIndex(e,r){return this.un.add(r),ve.resolve()}getCollectionParents(e,r){return ve.resolve(this.un.getEntries(r))}addFieldIndex(e,r){return ve.resolve()}deleteFieldIndex(e,r){return ve.resolve()}deleteAllFieldIndexes(e){return ve.resolve()}createTargetIndexes(e,r){return ve.resolve()}getDocumentsMatchingTarget(e,r){return ve.resolve(null)}getIndexType(e,r){return ve.resolve(0)}getFieldIndexes(e,r){return ve.resolve([])}getNextCollectionGroupToUpdate(e){return ve.resolve(null)}getMinOffset(e,r){return ve.resolve(ni.min())}getMinOffsetFromCollectionGroup(e,r){return ve.resolve(ni.min())}updateCollectionGroup(e,r,n){return ve.resolve()}updateIndexEntries(e,r){return ve.resolve()}}class ZF{constructor(){this.index={}}add(e){const r=e.lastSegment(),n=e.popLast(),s=this.index[r]||new wr(Ct.comparator),a=!s.has(n);return this.index[r]=s.add(n),a}has(e){const r=e.lastSegment(),n=e.popLast(),s=this.index[r];return s&&s.has(n)}getEntries(e){return(this.index[e]||new wr(Ct.comparator)).toArray()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cl{constructor(e){this.Ln=e}next(){return this.Ln+=2,this.Ln}static Bn(){return new cl(0)}static kn(){return new cl(-1)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eO{constructor(){this.changes=new wl(e=>e.toString(),(e,r)=>e.isEqual(r)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,r){this.assertNotApplied(),this.changes.set(e,Mr.newInvalidDocument(e).setReadTime(r))}getEntry(e,r){this.assertNotApplied();const n=this.changes.get(r);return n!==void 0?ve.resolve(n):this.getFromCache(e,r)}getEntries(e,r){return this.getAllFromCache(e,r)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tO{constructor(e,r){this.overlayedDocument=e,this.mutatedFields=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rO{constructor(e,r,n,s){this.remoteDocumentCache=e,this.mutationQueue=r,this.documentOverlayCache=n,this.indexManager=s}getDocument(e,r){let n=null;return this.documentOverlayCache.getOverlay(e,r).next(s=>(n=s,this.remoteDocumentCache.getEntry(e,r))).next(s=>(n!==null&&_c(n.mutation,s,En.empty(),ar.now()),s))}getDocuments(e,r){return this.remoteDocumentCache.getEntries(e,r).next(n=>this.getLocalViewOfDocuments(e,n,Xe()).next(()=>n))}getLocalViewOfDocuments(e,r,n=Xe()){const s=Ni();return this.populateOverlays(e,s,r).next(()=>this.computeViews(e,r,s,n).next(a=>{let i=Zl();return a.forEach((o,l)=>{i=i.insert(o,l.overlayedDocument)}),i}))}getOverlayedDocuments(e,r){const n=Ni();return this.populateOverlays(e,n,r).next(()=>this.computeViews(e,r,n,Xe()))}populateOverlays(e,r,n){const s=[];return n.forEach(a=>{r.has(a)||s.push(a)}),this.documentOverlayCache.getOverlays(e,s).next(a=>{a.forEach((i,o)=>{r.set(i,o)})})}computeViews(e,r,n,s){let a=ma();const i=xc(),o=function(){return xc()}();return r.forEach((l,c)=>{const u=n.get(c.key);s.has(c.key)&&(u===void 0||u.mutation instanceof mi)?a=a.insert(c.key,c):u!==void 0?(i.set(c.key,u.mutation.getFieldMask()),_c(u.mutation,c,u.mutation.getFieldMask(),ar.now())):i.set(c.key,En.empty())}),this.recalculateAndSaveOverlays(e,a).next(l=>(l.forEach((c,u)=>i.set(c,u)),r.forEach((c,u)=>{var h;return o.set(c,new tO(u,(h=i.get(c))!==null&&h!==void 0?h:null))}),o))}recalculateAndSaveOverlays(e,r){const n=xc();let s=new Lt((i,o)=>i-o),a=Xe();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,r).next(i=>{for(const o of i)o.keys().forEach(l=>{const c=r.get(l);if(c===null)return;let u=n.get(l)||En.empty();u=o.applyToLocalView(c,u),n.set(l,u);const h=(s.get(o.batchId)||Xe()).add(l);s=s.insert(o.batchId,h)})}).next(()=>{const i=[],o=s.getReverseIterator();for(;o.hasNext();){const l=o.getNext(),c=l.key,u=l.value,h=Bk();u.forEach(m=>{if(!a.has(m)){const p=Xk(r.get(m),n.get(m));p!==null&&h.set(m,p),a=a.add(m)}}),i.push(this.documentOverlayCache.saveOverlays(e,c,h))}return ve.waitFor(i)}).next(()=>n)}recalculateAndSaveOverlaysForDocumentKeys(e,r){return this.remoteDocumentCache.getEntries(e,r).next(n=>this.recalculateAndSaveOverlays(e,n))}getDocumentsMatchingQuery(e,r,n,s){return function(i){return be.isDocumentKey(i.path)&&i.collectionGroup===null&&i.filters.length===0}(r)?this.getDocumentsMatchingDocumentQuery(e,r.path):Mk(r)?this.getDocumentsMatchingCollectionGroupQuery(e,r,n,s):this.getDocumentsMatchingCollectionQuery(e,r,n,s)}getNextDocuments(e,r,n,s){return this.remoteDocumentCache.getAllFromCollectionGroup(e,r,n,s).next(a=>{const i=s-a.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,r,n.largestBatchId,s-a.size):ve.resolve(Ni());let o=-1,l=a;return i.next(c=>ve.forEach(c,(u,h)=>(o<h.largestBatchId&&(o=h.largestBatchId),a.get(u)?ve.resolve():this.remoteDocumentCache.getEntry(e,u).next(m=>{l=l.insert(u,m)}))).next(()=>this.populateOverlays(e,c,a)).next(()=>this.computeViews(e,l,c,Xe())).next(u=>({batchId:o,changes:Uk(u)})))})}getDocumentsMatchingDocumentQuery(e,r){return this.getDocument(e,new be(r)).next(n=>{let s=Zl();return n.isFoundDocument()&&(s=s.insert(n.key,n)),s})}getDocumentsMatchingCollectionGroupQuery(e,r,n,s){const a=r.collectionGroup;let i=Zl();return this.indexManager.getCollectionParents(e,a).next(o=>ve.forEach(o,l=>{const c=function(h,m){return new Cu(m,null,h.explicitOrderBy.slice(),h.filters.slice(),h.limit,h.limitType,h.startAt,h.endAt)}(r,l.child(a));return this.getDocumentsMatchingCollectionQuery(e,c,n,s).next(u=>{u.forEach((h,m)=>{i=i.insert(h,m)})})}).next(()=>i))}getDocumentsMatchingCollectionQuery(e,r,n,s){let a;return this.documentOverlayCache.getOverlaysForCollection(e,r.path,n.largestBatchId).next(i=>(a=i,this.remoteDocumentCache.getDocumentsMatchingQuery(e,r,n,a,s))).next(i=>{a.forEach((l,c)=>{const u=c.getKey();i.get(u)===null&&(i=i.insert(u,Mr.newInvalidDocument(u)))});let o=Zl();return i.forEach((l,c)=>{const u=a.get(l);u!==void 0&&_c(u.mutation,c,En.empty(),ar.now()),Od(r,c)&&(o=o.insert(l,c))}),o})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nO{constructor(e){this.serializer=e,this.hr=new Map,this.Pr=new Map}getBundleMetadata(e,r){return ve.resolve(this.hr.get(r))}saveBundleMetadata(e,r){return this.hr.set(r.id,function(s){return{id:s.id,version:s.version,createTime:As(s.createTime)}}(r)),ve.resolve()}getNamedQuery(e,r){return ve.resolve(this.Pr.get(r))}saveNamedQuery(e,r){return this.Pr.set(r.name,function(s){return{name:s.name,query:QF(s.bundledQuery),readTime:As(s.readTime)}}(r)),ve.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sO{constructor(){this.overlays=new Lt(be.comparator),this.Ir=new Map}getOverlay(e,r){return ve.resolve(this.overlays.get(r))}getOverlays(e,r){const n=Ni();return ve.forEach(r,s=>this.getOverlay(e,s).next(a=>{a!==null&&n.set(s,a)})).next(()=>n)}saveOverlays(e,r,n){return n.forEach((s,a)=>{this.ht(e,r,a)}),ve.resolve()}removeOverlaysForBatchId(e,r,n){const s=this.Ir.get(n);return s!==void 0&&(s.forEach(a=>this.overlays=this.overlays.remove(a)),this.Ir.delete(n)),ve.resolve()}getOverlaysForCollection(e,r,n){const s=Ni(),a=r.length+1,i=new be(r.child("")),o=this.overlays.getIteratorFrom(i);for(;o.hasNext();){const l=o.getNext().value,c=l.getKey();if(!r.isPrefixOf(c.path))break;c.path.length===a&&l.largestBatchId>n&&s.set(l.getKey(),l)}return ve.resolve(s)}getOverlaysForCollectionGroup(e,r,n,s){let a=new Lt((c,u)=>c-u);const i=this.overlays.getIterator();for(;i.hasNext();){const c=i.getNext().value;if(c.getKey().getCollectionGroup()===r&&c.largestBatchId>n){let u=a.get(c.largestBatchId);u===null&&(u=Ni(),a=a.insert(c.largestBatchId,u)),u.set(c.getKey(),c)}}const o=Ni(),l=a.getIterator();for(;l.hasNext()&&(l.getNext().value.forEach((c,u)=>o.set(c,u)),!(o.size()>=s)););return ve.resolve(o)}ht(e,r,n){const s=this.overlays.get(n.key);if(s!==null){const i=this.Ir.get(s.largestBatchId).delete(n.key);this.Ir.set(s.largestBatchId,i)}this.overlays=this.overlays.insert(n.key,new IF(r,n));let a=this.Ir.get(r);a===void 0&&(a=Xe(),this.Ir.set(r,a)),this.Ir.set(r,a.add(n.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aO{constructor(){this.sessionToken=Sr.EMPTY_BYTE_STRING}getSessionToken(e){return ve.resolve(this.sessionToken)}setSessionToken(e,r){return this.sessionToken=r,ve.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mv{constructor(){this.Tr=new wr(cr.Er),this.dr=new wr(cr.Ar)}isEmpty(){return this.Tr.isEmpty()}addReference(e,r){const n=new cr(e,r);this.Tr=this.Tr.add(n),this.dr=this.dr.add(n)}Rr(e,r){e.forEach(n=>this.addReference(n,r))}removeReference(e,r){this.Vr(new cr(e,r))}mr(e,r){e.forEach(n=>this.removeReference(n,r))}gr(e){const r=new be(new Ct([])),n=new cr(r,e),s=new cr(r,e+1),a=[];return this.dr.forEachInRange([n,s],i=>{this.Vr(i),a.push(i.key)}),a}pr(){this.Tr.forEach(e=>this.Vr(e))}Vr(e){this.Tr=this.Tr.delete(e),this.dr=this.dr.delete(e)}yr(e){const r=new be(new Ct([])),n=new cr(r,e),s=new cr(r,e+1);let a=Xe();return this.dr.forEachInRange([n,s],i=>{a=a.add(i.key)}),a}containsKey(e){const r=new cr(e,0),n=this.Tr.firstAfterOrEqual(r);return n!==null&&e.isEqual(n.key)}}class cr{constructor(e,r){this.key=e,this.wr=r}static Er(e,r){return be.comparator(e.key,r.key)||ct(e.wr,r.wr)}static Ar(e,r){return ct(e.wr,r.wr)||be.comparator(e.key,r.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iO{constructor(e,r){this.indexManager=e,this.referenceDelegate=r,this.mutationQueue=[],this.Sr=1,this.br=new wr(cr.Er)}checkEmpty(e){return ve.resolve(this.mutationQueue.length===0)}addMutationBatch(e,r,n,s){const a=this.Sr;this.Sr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const i=new AF(a,r,n,s);this.mutationQueue.push(i);for(const o of s)this.br=this.br.add(new cr(o.key,a)),this.indexManager.addToCollectionParentIndex(e,o.key.path.popLast());return ve.resolve(i)}lookupMutationBatch(e,r){return ve.resolve(this.Dr(r))}getNextMutationBatchAfterBatchId(e,r){const n=r+1,s=this.vr(n),a=s<0?0:s;return ve.resolve(this.mutationQueue.length>a?this.mutationQueue[a]:null)}getHighestUnacknowledgedBatchId(){return ve.resolve(this.mutationQueue.length===0?-1:this.Sr-1)}getAllMutationBatches(e){return ve.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,r){const n=new cr(r,0),s=new cr(r,Number.POSITIVE_INFINITY),a=[];return this.br.forEachInRange([n,s],i=>{const o=this.Dr(i.wr);a.push(o)}),ve.resolve(a)}getAllMutationBatchesAffectingDocumentKeys(e,r){let n=new wr(ct);return r.forEach(s=>{const a=new cr(s,0),i=new cr(s,Number.POSITIVE_INFINITY);this.br.forEachInRange([a,i],o=>{n=n.add(o.wr)})}),ve.resolve(this.Cr(n))}getAllMutationBatchesAffectingQuery(e,r){const n=r.path,s=n.length+1;let a=n;be.isDocumentKey(a)||(a=a.child(""));const i=new cr(new be(a),0);let o=new wr(ct);return this.br.forEachWhile(l=>{const c=l.key.path;return!!n.isPrefixOf(c)&&(c.length===s&&(o=o.add(l.wr)),!0)},i),ve.resolve(this.Cr(o))}Cr(e){const r=[];return e.forEach(n=>{const s=this.Dr(n);s!==null&&r.push(s)}),r}removeMutationBatch(e,r){gt(this.Fr(r.batchId,"removed")===0),this.mutationQueue.shift();let n=this.br;return ve.forEach(r.mutations,s=>{const a=new cr(s.key,r.batchId);return n=n.delete(a),this.referenceDelegate.markPotentiallyOrphaned(e,s.key)}).next(()=>{this.br=n})}On(e){}containsKey(e,r){const n=new cr(r,0),s=this.br.firstAfterOrEqual(n);return ve.resolve(r.isEqual(s&&s.key))}performConsistencyCheck(e){return this.mutationQueue.length,ve.resolve()}Fr(e,r){return this.vr(e)}vr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Dr(e){const r=this.vr(e);return r<0||r>=this.mutationQueue.length?null:this.mutationQueue[r]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oO{constructor(e){this.Mr=e,this.docs=function(){return new Lt(be.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,r){const n=r.key,s=this.docs.get(n),a=s?s.size:0,i=this.Mr(r);return this.docs=this.docs.insert(n,{document:r.mutableCopy(),size:i}),this.size+=i-a,this.indexManager.addToCollectionParentIndex(e,n.path.popLast())}removeEntry(e){const r=this.docs.get(e);r&&(this.docs=this.docs.remove(e),this.size-=r.size)}getEntry(e,r){const n=this.docs.get(r);return ve.resolve(n?n.document.mutableCopy():Mr.newInvalidDocument(r))}getEntries(e,r){let n=ma();return r.forEach(s=>{const a=this.docs.get(s);n=n.insert(s,a?a.document.mutableCopy():Mr.newInvalidDocument(s))}),ve.resolve(n)}getDocumentsMatchingQuery(e,r,n,s){let a=ma();const i=r.path,o=new be(i.child("")),l=this.docs.getIteratorFrom(o);for(;l.hasNext();){const{key:c,value:{document:u}}=l.getNext();if(!i.isPrefixOf(c.path))break;c.path.length>i.length+1||H3(W3(u),n)<=0||(s.has(u.key)||Od(r,u))&&(a=a.insert(u.key,u.mutableCopy()))}return ve.resolve(a)}getAllFromCollectionGroup(e,r,n,s){Le()}Or(e,r){return ve.forEach(this.docs,n=>r(n))}newChangeBuffer(e){return new lO(this)}getSize(e){return ve.resolve(this.size)}}class lO extends eO{constructor(e){super(),this.cr=e}applyChanges(e){const r=[];return this.changes.forEach((n,s)=>{s.isValidDocument()?r.push(this.cr.addEntry(e,s)):this.cr.removeEntry(n)}),ve.waitFor(r)}getFromCache(e,r){return this.cr.getEntry(e,r)}getAllFromCache(e,r){return this.cr.getEntries(e,r)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cO{constructor(e){this.persistence=e,this.Nr=new wl(r=>ov(r),lv),this.lastRemoteSnapshotVersion=Ve.min(),this.highestTargetId=0,this.Lr=0,this.Br=new mv,this.targetCount=0,this.kr=cl.Bn()}forEachTarget(e,r){return this.Nr.forEach((n,s)=>r(s)),ve.resolve()}getLastRemoteSnapshotVersion(e){return ve.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return ve.resolve(this.Lr)}allocateTargetId(e){return this.highestTargetId=this.kr.next(),ve.resolve(this.highestTargetId)}setTargetsMetadata(e,r,n){return n&&(this.lastRemoteSnapshotVersion=n),r>this.Lr&&(this.Lr=r),ve.resolve()}Kn(e){this.Nr.set(e.target,e);const r=e.targetId;r>this.highestTargetId&&(this.kr=new cl(r),this.highestTargetId=r),e.sequenceNumber>this.Lr&&(this.Lr=e.sequenceNumber)}addTargetData(e,r){return this.Kn(r),this.targetCount+=1,ve.resolve()}updateTargetData(e,r){return this.Kn(r),ve.resolve()}removeTargetData(e,r){return this.Nr.delete(r.target),this.Br.gr(r.targetId),this.targetCount-=1,ve.resolve()}removeTargets(e,r,n){let s=0;const a=[];return this.Nr.forEach((i,o)=>{o.sequenceNumber<=r&&n.get(o.targetId)===null&&(this.Nr.delete(i),a.push(this.removeMatchingKeysForTargetId(e,o.targetId)),s++)}),ve.waitFor(a).next(()=>s)}getTargetCount(e){return ve.resolve(this.targetCount)}getTargetData(e,r){const n=this.Nr.get(r)||null;return ve.resolve(n)}addMatchingKeys(e,r,n){return this.Br.Rr(r,n),ve.resolve()}removeMatchingKeys(e,r,n){this.Br.mr(r,n);const s=this.persistence.referenceDelegate,a=[];return s&&r.forEach(i=>{a.push(s.markPotentiallyOrphaned(e,i))}),ve.waitFor(a)}removeMatchingKeysForTargetId(e,r){return this.Br.gr(r),ve.resolve()}getMatchingKeysForTargetId(e,r){const n=this.Br.yr(r);return ve.resolve(n)}containsKey(e,r){return ve.resolve(this.Br.containsKey(r))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uO{constructor(e,r){this.qr={},this.overlays={},this.Qr=new nv(0),this.Kr=!1,this.Kr=!0,this.$r=new aO,this.referenceDelegate=e(this),this.Ur=new cO(this),this.indexManager=new JF,this.remoteDocumentCache=function(s){return new oO(s)}(n=>this.referenceDelegate.Wr(n)),this.serializer=new YF(r),this.Gr=new nO(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.Kr=!1,Promise.resolve()}get started(){return this.Kr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let r=this.overlays[e.toKey()];return r||(r=new sO,this.overlays[e.toKey()]=r),r}getMutationQueue(e,r){let n=this.qr[e.toKey()];return n||(n=new iO(r,this.referenceDelegate),this.qr[e.toKey()]=n),n}getGlobalsCache(){return this.$r}getTargetCache(){return this.Ur}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Gr}runTransaction(e,r,n){Pe("MemoryPersistence","Starting transaction:",e);const s=new fO(this.Qr.next());return this.referenceDelegate.zr(),n(s).next(a=>this.referenceDelegate.jr(s).next(()=>a)).toPromise().then(a=>(s.raiseOnCommittedEvent(),a))}Hr(e,r){return ve.or(Object.values(this.qr).map(n=>()=>n.containsKey(e,r)))}}class fO extends K3{constructor(e){super(),this.currentSequenceNumber=e}}class pv{constructor(e){this.persistence=e,this.Jr=new mv,this.Yr=null}static Zr(e){return new pv(e)}get Xr(){if(this.Yr)return this.Yr;throw Le()}addReference(e,r,n){return this.Jr.addReference(n,r),this.Xr.delete(n.toString()),ve.resolve()}removeReference(e,r,n){return this.Jr.removeReference(n,r),this.Xr.add(n.toString()),ve.resolve()}markPotentiallyOrphaned(e,r){return this.Xr.add(r.toString()),ve.resolve()}removeTarget(e,r){this.Jr.gr(r.targetId).forEach(s=>this.Xr.add(s.toString()));const n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(e,r.targetId).next(s=>{s.forEach(a=>this.Xr.add(a.toString()))}).next(()=>n.removeTargetData(e,r))}zr(){this.Yr=new Set}jr(e){const r=this.persistence.getRemoteDocumentCache().newChangeBuffer();return ve.forEach(this.Xr,n=>{const s=be.fromPath(n);return this.ei(e,s).next(a=>{a||r.removeEntry(s,Ve.min())})}).next(()=>(this.Yr=null,r.apply(e)))}updateLimboDocument(e,r){return this.ei(e,r).next(n=>{n?this.Xr.delete(r.toString()):this.Xr.add(r.toString())})}Wr(e){return 0}ei(e,r){return ve.or([()=>ve.resolve(this.Jr.containsKey(r)),()=>this.persistence.getTargetCache().containsKey(e,r),()=>this.persistence.Hr(e,r)])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gv{constructor(e,r,n,s){this.targetId=e,this.fromCache=r,this.$i=n,this.Ui=s}static Wi(e,r){let n=Xe(),s=Xe();for(const a of r.docChanges)switch(a.type){case 0:n=n.add(a.doc.key);break;case 1:s=s.add(a.doc.key)}return new gv(e,r.fromCache,n,s)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hO{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dO{constructor(){this.Gi=!1,this.zi=!1,this.ji=100,this.Hi=function(){return yP()?8:q3(zr())>0?6:4}()}initialize(e,r){this.Ji=e,this.indexManager=r,this.Gi=!0}getDocumentsMatchingQuery(e,r,n,s){const a={result:null};return this.Yi(e,r).next(i=>{a.result=i}).next(()=>{if(!a.result)return this.Zi(e,r,s,n).next(i=>{a.result=i})}).next(()=>{if(a.result)return;const i=new hO;return this.Xi(e,r,i).next(o=>{if(a.result=o,this.zi)return this.es(e,r,i,o.size)})}).next(()=>a.result)}es(e,r,n,s){return n.documentReadCount<this.ji?(Gl()<=Ye.DEBUG&&Pe("QueryEngine","SDK will not create cache indexes for query:",_o(r),"since it only creates cache indexes for collection contains","more than or equal to",this.ji,"documents"),ve.resolve()):(Gl()<=Ye.DEBUG&&Pe("QueryEngine","Query:",_o(r),"scans",n.documentReadCount,"local documents and returns",s,"documents as results."),n.documentReadCount>this.Hi*s?(Gl()<=Ye.DEBUG&&Pe("QueryEngine","The SDK decides to create cache indexes for query:",_o(r),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Ss(r))):ve.resolve())}Yi(e,r){if(iy(r))return ve.resolve(null);let n=Ss(r);return this.indexManager.getIndexType(e,n).next(s=>s===0?null:(r.limit!==null&&s===1&&(r=pp(r,null,"F"),n=Ss(r)),this.indexManager.getDocumentsMatchingTarget(e,n).next(a=>{const i=Xe(...a);return this.Ji.getDocuments(e,i).next(o=>this.indexManager.getMinOffset(e,n).next(l=>{const c=this.ts(r,o);return this.ns(r,c,i,l.readTime)?this.Yi(e,pp(r,null,"F")):this.rs(e,c,r,l)}))})))}Zi(e,r,n,s){return iy(r)||s.isEqual(Ve.min())?ve.resolve(null):this.Ji.getDocuments(e,n).next(a=>{const i=this.ts(r,a);return this.ns(r,i,n,s)?ve.resolve(null):(Gl()<=Ye.DEBUG&&Pe("QueryEngine","Re-using previous result from %s to execute query: %s",s.toString(),_o(r)),this.rs(e,i,r,$3(s,-1)).next(o=>o))})}ts(e,r){let n=new wr(jk(e));return r.forEach((s,a)=>{Od(e,a)&&(n=n.add(a))}),n}ns(e,r,n,s){if(e.limit===null)return!1;if(n.size!==r.size)return!0;const a=e.limitType==="F"?r.last():r.first();return!!a&&(a.hasPendingWrites||a.version.compareTo(s)>0)}Xi(e,r,n){return Gl()<=Ye.DEBUG&&Pe("QueryEngine","Using full collection scan to execute query:",_o(r)),this.Ji.getDocumentsMatchingQuery(e,r,ni.min(),n)}rs(e,r,n,s){return this.Ji.getDocumentsMatchingQuery(e,n,s).next(a=>(r.forEach(i=>{a=a.insert(i.key,i)}),a))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mO{constructor(e,r,n,s){this.persistence=e,this.ss=r,this.serializer=s,this.os=new Lt(ct),this._s=new wl(a=>ov(a),lv),this.us=new Map,this.cs=e.getRemoteDocumentCache(),this.Ur=e.getTargetCache(),this.Gr=e.getBundleCache(),this.ls(n)}ls(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new rO(this.cs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.cs.setIndexManager(this.indexManager),this.ss.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",r=>e.collect(r,this.os))}}function pO(t,e,r,n){return new mO(t,e,r,n)}async function oS(t,e){const r=Be(t);return await r.persistence.runTransaction("Handle user change","readonly",n=>{let s;return r.mutationQueue.getAllMutationBatches(n).next(a=>(s=a,r.ls(e),r.mutationQueue.getAllMutationBatches(n))).next(a=>{const i=[],o=[];let l=Xe();for(const c of s){i.push(c.batchId);for(const u of c.mutations)l=l.add(u.key)}for(const c of a){o.push(c.batchId);for(const u of c.mutations)l=l.add(u.key)}return r.localDocuments.getDocuments(n,l).next(c=>({hs:c,removedBatchIds:i,addedBatchIds:o}))})})}function gO(t,e){const r=Be(t);return r.persistence.runTransaction("Acknowledge batch","readwrite-primary",n=>{const s=e.batch.keys(),a=r.cs.newChangeBuffer({trackRemovals:!0});return function(o,l,c,u){const h=c.batch,m=h.keys();let p=ve.resolve();return m.forEach(x=>{p=p.next(()=>u.getEntry(l,x)).next(v=>{const w=c.docVersions.get(x);gt(w!==null),v.version.compareTo(w)<0&&(h.applyToRemoteDocument(v,c),v.isValidDocument()&&(v.setReadTime(c.commitVersion),u.addEntry(v)))})}),p.next(()=>o.mutationQueue.removeMutationBatch(l,h))}(r,n,e,a).next(()=>a.apply(n)).next(()=>r.mutationQueue.performConsistencyCheck(n)).next(()=>r.documentOverlayCache.removeOverlaysForBatchId(n,s,e.batch.batchId)).next(()=>r.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(n,function(o){let l=Xe();for(let c=0;c<o.mutationResults.length;++c)o.mutationResults[c].transformResults.length>0&&(l=l.add(o.batch.mutations[c].key));return l}(e))).next(()=>r.localDocuments.getDocuments(n,s))})}function lS(t){const e=Be(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",r=>e.Ur.getLastRemoteSnapshotVersion(r))}function vO(t,e){const r=Be(t),n=e.snapshotVersion;let s=r.os;return r.persistence.runTransaction("Apply remote event","readwrite-primary",a=>{const i=r.cs.newChangeBuffer({trackRemovals:!0});s=r.os;const o=[];e.targetChanges.forEach((u,h)=>{const m=s.get(h);if(!m)return;o.push(r.Ur.removeMatchingKeys(a,u.removedDocuments,h).next(()=>r.Ur.addMatchingKeys(a,u.addedDocuments,h)));let p=m.withSequenceNumber(a.currentSequenceNumber);e.targetMismatches.get(h)!==null?p=p.withResumeToken(Sr.EMPTY_BYTE_STRING,Ve.min()).withLastLimboFreeSnapshotVersion(Ve.min()):u.resumeToken.approximateByteSize()>0&&(p=p.withResumeToken(u.resumeToken,n)),s=s.insert(h,p),function(v,w,k){return v.resumeToken.approximateByteSize()===0||w.snapshotVersion.toMicroseconds()-v.snapshotVersion.toMicroseconds()>=3e8?!0:k.addedDocuments.size+k.modifiedDocuments.size+k.removedDocuments.size>0}(m,p,u)&&o.push(r.Ur.updateTargetData(a,p))});let l=ma(),c=Xe();if(e.documentUpdates.forEach(u=>{e.resolvedLimboDocuments.has(u)&&o.push(r.persistence.referenceDelegate.updateLimboDocument(a,u))}),o.push(xO(a,i,e.documentUpdates).next(u=>{l=u.Ps,c=u.Is})),!n.isEqual(Ve.min())){const u=r.Ur.getLastRemoteSnapshotVersion(a).next(h=>r.Ur.setTargetsMetadata(a,a.currentSequenceNumber,n));o.push(u)}return ve.waitFor(o).next(()=>i.apply(a)).next(()=>r.localDocuments.getLocalViewOfDocuments(a,l,c)).next(()=>l)}).then(a=>(r.os=s,a))}function xO(t,e,r){let n=Xe(),s=Xe();return r.forEach(a=>n=n.add(a)),e.getEntries(t,n).next(a=>{let i=ma();return r.forEach((o,l)=>{const c=a.get(o);l.isFoundDocument()!==c.isFoundDocument()&&(s=s.add(o)),l.isNoDocument()&&l.version.isEqual(Ve.min())?(e.removeEntry(o,l.readTime),i=i.insert(o,l)):!c.isValidDocument()||l.version.compareTo(c.version)>0||l.version.compareTo(c.version)===0&&c.hasPendingWrites?(e.addEntry(l),i=i.insert(o,l)):Pe("LocalStore","Ignoring outdated watch update for ",o,". Current version:",c.version," Watch version:",l.version)}),{Ps:i,Is:s}})}function _O(t,e){const r=Be(t);return r.persistence.runTransaction("Get next mutation batch","readonly",n=>(e===void 0&&(e=-1),r.mutationQueue.getNextMutationBatchAfterBatchId(n,e)))}function yO(t,e){const r=Be(t);return r.persistence.runTransaction("Allocate target","readwrite",n=>{let s;return r.Ur.getTargetData(n,e).next(a=>a?(s=a,ve.resolve(s)):r.Ur.allocateTargetId(n).next(i=>(s=new Va(e,i,"TargetPurposeListen",n.currentSequenceNumber),r.Ur.addTargetData(n,s).next(()=>s))))}).then(n=>{const s=r.os.get(n.targetId);return(s===null||n.snapshotVersion.compareTo(s.snapshotVersion)>0)&&(r.os=r.os.insert(n.targetId,n),r._s.set(e,n.targetId)),n})}async function yp(t,e,r){const n=Be(t),s=n.os.get(e),a=r?"readwrite":"readwrite-primary";try{r||await n.persistence.runTransaction("Release target",a,i=>n.persistence.referenceDelegate.removeTarget(i,s))}catch(i){if(!Iu(i))throw i;Pe("LocalStore",`Failed to update sequence numbers for target ${e}: ${i}`)}n.os=n.os.remove(e),n._s.delete(s.target)}function vy(t,e,r){const n=Be(t);let s=Ve.min(),a=Xe();return n.persistence.runTransaction("Execute query","readwrite",i=>function(l,c,u){const h=Be(l),m=h._s.get(u);return m!==void 0?ve.resolve(h.os.get(m)):h.Ur.getTargetData(c,u)}(n,i,Ss(e)).next(o=>{if(o)return s=o.lastLimboFreeSnapshotVersion,n.Ur.getMatchingKeysForTargetId(i,o.targetId).next(l=>{a=l})}).next(()=>n.ss.getDocumentsMatchingQuery(i,e,r?s:Ve.min(),r?a:Xe())).next(o=>(wO(n,hF(e),o),{documents:o,Ts:a})))}function wO(t,e,r){let n=t.us.get(e)||Ve.min();r.forEach((s,a)=>{a.readTime.compareTo(n)>0&&(n=a.readTime)}),t.us.set(e,n)}class xy{constructor(){this.activeTargetIds=xF()}fs(e){this.activeTargetIds=this.activeTargetIds.add(e)}gs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Vs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class EO{constructor(){this.so=new xy,this.oo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,r,n){}addLocalQueryTarget(e,r=!0){return r&&this.so.fs(e),this.oo[e]||"not-current"}updateQueryState(e,r,n){this.oo[e]=r}removeLocalQueryTarget(e){this.so.gs(e)}isLocalQueryTarget(e){return this.so.activeTargetIds.has(e)}clearQueryState(e){delete this.oo[e]}getAllActiveQueryTargets(){return this.so.activeTargetIds}isActiveQueryTarget(e){return this.so.activeTargetIds.has(e)}start(){return this.so=new xy,Promise.resolve()}handleUserChange(e,r,n){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TO{_o(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _y{constructor(){this.ao=()=>this.uo(),this.co=()=>this.lo(),this.ho=[],this.Po()}_o(e){this.ho.push(e)}shutdown(){window.removeEventListener("online",this.ao),window.removeEventListener("offline",this.co)}Po(){window.addEventListener("online",this.ao),window.addEventListener("offline",this.co)}uo(){Pe("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.ho)e(0)}lo(){Pe("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.ho)e(1)}static D(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Tf=null;function W0(){return Tf===null?Tf=function(){return 268435456+Math.round(2147483648*Math.random())}():Tf++,"0x"+Tf.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kO={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SO{constructor(e){this.Io=e.Io,this.To=e.To}Eo(e){this.Ao=e}Ro(e){this.Vo=e}mo(e){this.fo=e}onMessage(e){this.po=e}close(){this.To()}send(e){this.Io(e)}yo(){this.Ao()}wo(){this.Vo()}So(e){this.fo(e)}bo(e){this.po(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Pr="WebChannelConnection";class AO extends class{constructor(r){this.databaseInfo=r,this.databaseId=r.databaseId;const n=r.ssl?"https":"http",s=encodeURIComponent(this.databaseId.projectId),a=encodeURIComponent(this.databaseId.database);this.Do=n+"://"+r.host,this.vo=`projects/${s}/databases/${a}`,this.Co=this.databaseId.database==="(default)"?`project_id=${s}`:`project_id=${s}&database_id=${a}`}get Fo(){return!1}Mo(r,n,s,a,i){const o=W0(),l=this.xo(r,n.toUriEncodedString());Pe("RestConnection",`Sending RPC '${r}' ${o}:`,l,s);const c={"google-cloud-resource-prefix":this.vo,"x-goog-request-params":this.Co};return this.Oo(c,a,i),this.No(r,l,c,s).then(u=>(Pe("RestConnection",`Received RPC '${r}' ${o}: `,u),u),u=>{throw al("RestConnection",`RPC '${r}' ${o} failed with error: `,u,"url: ",l,"request:",s),u})}Lo(r,n,s,a,i,o){return this.Mo(r,n,s,a,i)}Oo(r,n,s){r["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+yl}(),r["Content-Type"]="text/plain",this.databaseInfo.appId&&(r["X-Firebase-GMPID"]=this.databaseInfo.appId),n&&n.headers.forEach((a,i)=>r[i]=a),s&&s.headers.forEach((a,i)=>r[i]=a)}xo(r,n){const s=kO[r];return`${this.Do}/v1/${n}:${s}`}terminate(){}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}No(e,r,n,s){const a=W0();return new Promise((i,o)=>{const l=new yk;l.setWithCredentials(!0),l.listenOnce(wk.COMPLETE,()=>{try{switch(l.getLastErrorCode()){case Qf.NO_ERROR:const u=l.getResponseJson();Pe(Pr,`XHR for RPC '${e}' ${a} received:`,JSON.stringify(u)),i(u);break;case Qf.TIMEOUT:Pe(Pr,`RPC '${e}' ${a} timed out`),o(new Ne(fe.DEADLINE_EXCEEDED,"Request time out"));break;case Qf.HTTP_ERROR:const h=l.getStatus();if(Pe(Pr,`RPC '${e}' ${a} failed with status:`,h,"response text:",l.getResponseText()),h>0){let m=l.getResponseJson();Array.isArray(m)&&(m=m[0]);const p=m==null?void 0:m.error;if(p&&p.status&&p.message){const x=function(w){const k=w.toLowerCase().replace(/_/g,"-");return Object.values(fe).indexOf(k)>=0?k:fe.UNKNOWN}(p.status);o(new Ne(x,p.message))}else o(new Ne(fe.UNKNOWN,"Server responded with status "+l.getStatus()))}else o(new Ne(fe.UNAVAILABLE,"Connection failed."));break;default:Le()}}finally{Pe(Pr,`RPC '${e}' ${a} completed.`)}});const c=JSON.stringify(s);Pe(Pr,`RPC '${e}' ${a} sending request:`,s),l.send(r,"POST",c,n,15)})}Bo(e,r,n){const s=W0(),a=[this.Do,"/","google.firestore.v1.Firestore","/",e,"/channel"],i=kk(),o=Tk(),l={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},c=this.longPollingOptions.timeoutSeconds;c!==void 0&&(l.longPollingTimeout=Math.round(1e3*c)),this.useFetchStreams&&(l.useFetchStreams=!0),this.Oo(l.initMessageHeaders,r,n),l.encodeInitMessageHeaders=!0;const u=a.join("");Pe(Pr,`Creating RPC '${e}' stream ${s}: ${u}`,l);const h=i.createWebChannel(u,l);let m=!1,p=!1;const x=new SO({Io:w=>{p?Pe(Pr,`Not sending because RPC '${e}' stream ${s} is closed:`,w):(m||(Pe(Pr,`Opening RPC '${e}' stream ${s} transport.`),h.open(),m=!0),Pe(Pr,`RPC '${e}' stream ${s} sending:`,w),h.send(w))},To:()=>h.close()}),v=(w,k,T)=>{w.listen(k,E=>{try{T(E)}catch(N){setTimeout(()=>{throw N},0)}})};return v(h,Jl.EventType.OPEN,()=>{p||(Pe(Pr,`RPC '${e}' stream ${s} transport opened.`),x.yo())}),v(h,Jl.EventType.CLOSE,()=>{p||(p=!0,Pe(Pr,`RPC '${e}' stream ${s} transport closed`),x.So())}),v(h,Jl.EventType.ERROR,w=>{p||(p=!0,al(Pr,`RPC '${e}' stream ${s} transport errored:`,w),x.So(new Ne(fe.UNAVAILABLE,"The operation could not be completed")))}),v(h,Jl.EventType.MESSAGE,w=>{var k;if(!p){const T=w.data[0];gt(!!T);const E=T,N=E.error||((k=E[0])===null||k===void 0?void 0:k.error);if(N){Pe(Pr,`RPC '${e}' stream ${s} received error:`,N);const O=N.status;let M=function(S){const R=qt[S];if(R!==void 0)return Qk(R)}(O),g=N.message;M===void 0&&(M=fe.INTERNAL,g="Unknown error status: "+O+" with message "+N.message),p=!0,x.So(new Ne(M,g)),h.close()}else Pe(Pr,`RPC '${e}' stream ${s} received:`,T),x.bo(T)}}),v(o,Ek.STAT_EVENT,w=>{w.stat===cp.PROXY?Pe(Pr,`RPC '${e}' stream ${s} detected buffering proxy`):w.stat===cp.NOPROXY&&Pe(Pr,`RPC '${e}' stream ${s} detected no buffering proxy`)}),setTimeout(()=>{x.wo()},0),x}}function H0(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Vd(t){return new MF(t,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cS{constructor(e,r,n=1e3,s=1.5,a=6e4){this.ui=e,this.timerId=r,this.ko=n,this.qo=s,this.Qo=a,this.Ko=0,this.$o=null,this.Uo=Date.now(),this.reset()}reset(){this.Ko=0}Wo(){this.Ko=this.Qo}Go(e){this.cancel();const r=Math.floor(this.Ko+this.zo()),n=Math.max(0,Date.now()-this.Uo),s=Math.max(0,r-n);s>0&&Pe("ExponentialBackoff",`Backing off for ${s} ms (base delay: ${this.Ko} ms, delay with jitter: ${r} ms, last attempt: ${n} ms ago)`),this.$o=this.ui.enqueueAfterDelay(this.timerId,s,()=>(this.Uo=Date.now(),e())),this.Ko*=this.qo,this.Ko<this.ko&&(this.Ko=this.ko),this.Ko>this.Qo&&(this.Ko=this.Qo)}jo(){this.$o!==null&&(this.$o.skipDelay(),this.$o=null)}cancel(){this.$o!==null&&(this.$o.cancel(),this.$o=null)}zo(){return(Math.random()-.5)*this.Ko}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uS{constructor(e,r,n,s,a,i,o,l){this.ui=e,this.Ho=n,this.Jo=s,this.connection=a,this.authCredentialsProvider=i,this.appCheckCredentialsProvider=o,this.listener=l,this.state=0,this.Yo=0,this.Zo=null,this.Xo=null,this.stream=null,this.e_=0,this.t_=new cS(e,r)}n_(){return this.state===1||this.state===5||this.r_()}r_(){return this.state===2||this.state===3}start(){this.e_=0,this.state!==4?this.auth():this.i_()}async stop(){this.n_()&&await this.close(0)}s_(){this.state=0,this.t_.reset()}o_(){this.r_()&&this.Zo===null&&(this.Zo=this.ui.enqueueAfterDelay(this.Ho,6e4,()=>this.__()))}a_(e){this.u_(),this.stream.send(e)}async __(){if(this.r_())return this.close(0)}u_(){this.Zo&&(this.Zo.cancel(),this.Zo=null)}c_(){this.Xo&&(this.Xo.cancel(),this.Xo=null)}async close(e,r){this.u_(),this.c_(),this.t_.cancel(),this.Yo++,e!==4?this.t_.reset():r&&r.code===fe.RESOURCE_EXHAUSTED?(da(r.toString()),da("Using maximum backoff delay to prevent overloading the backend."),this.t_.Wo()):r&&r.code===fe.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.l_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.mo(r)}l_(){}auth(){this.state=1;const e=this.h_(this.Yo),r=this.Yo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([n,s])=>{this.Yo===r&&this.P_(n,s)},n=>{e(()=>{const s=new Ne(fe.UNKNOWN,"Fetching auth token failed: "+n.message);return this.I_(s)})})}P_(e,r){const n=this.h_(this.Yo);this.stream=this.T_(e,r),this.stream.Eo(()=>{n(()=>this.listener.Eo())}),this.stream.Ro(()=>{n(()=>(this.state=2,this.Xo=this.ui.enqueueAfterDelay(this.Jo,1e4,()=>(this.r_()&&(this.state=3),Promise.resolve())),this.listener.Ro()))}),this.stream.mo(s=>{n(()=>this.I_(s))}),this.stream.onMessage(s=>{n(()=>++this.e_==1?this.E_(s):this.onNext(s))})}i_(){this.state=5,this.t_.Go(async()=>{this.state=0,this.start()})}I_(e){return Pe("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}h_(e){return r=>{this.ui.enqueueAndForget(()=>this.Yo===e?r():(Pe("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class IO extends uS{constructor(e,r,n,s,a,i){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",r,n,s,i),this.serializer=a}T_(e,r){return this.connection.Bo("Listen",e,r)}E_(e){return this.onNext(e)}onNext(e){this.t_.reset();const r=VF(this.serializer,e),n=function(a){if(!("targetChange"in a))return Ve.min();const i=a.targetChange;return i.targetIds&&i.targetIds.length?Ve.min():i.readTime?As(i.readTime):Ve.min()}(e);return this.listener.d_(r,n)}A_(e){const r={};r.database=_p(this.serializer),r.addTarget=function(a,i){let o;const l=i.target;if(o=dp(l)?{documents:zF(a,l)}:{query:$F(a,l)._t},o.targetId=i.targetId,i.resumeToken.approximateByteSize()>0){o.resumeToken=eS(a,i.resumeToken);const c=gp(a,i.expectedCount);c!==null&&(o.expectedCount=c)}else if(i.snapshotVersion.compareTo(Ve.min())>0){o.readTime=Bh(a,i.snapshotVersion.toTimestamp());const c=gp(a,i.expectedCount);c!==null&&(o.expectedCount=c)}return o}(this.serializer,e);const n=HF(this.serializer,e);n&&(r.labels=n),this.a_(r)}R_(e){const r={};r.database=_p(this.serializer),r.removeTarget=e,this.a_(r)}}class CO extends uS{constructor(e,r,n,s,a,i){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",r,n,s,i),this.serializer=a}get V_(){return this.e_>0}start(){this.lastStreamToken=void 0,super.start()}l_(){this.V_&&this.m_([])}T_(e,r){return this.connection.Bo("Write",e,r)}E_(e){return gt(!!e.streamToken),this.lastStreamToken=e.streamToken,gt(!e.writeResults||e.writeResults.length===0),this.listener.f_()}onNext(e){gt(!!e.streamToken),this.lastStreamToken=e.streamToken,this.t_.reset();const r=BF(e.writeResults,e.commitTime),n=As(e.commitTime);return this.listener.g_(n,r)}p_(){const e={};e.database=_p(this.serializer),this.a_(e)}m_(e){const r={streamToken:this.lastStreamToken,writes:e.map(n=>UF(this.serializer,n))};this.a_(r)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RO extends class{}{constructor(e,r,n,s){super(),this.authCredentials=e,this.appCheckCredentials=r,this.connection=n,this.serializer=s,this.y_=!1}w_(){if(this.y_)throw new Ne(fe.FAILED_PRECONDITION,"The client has already been terminated.")}Mo(e,r,n,s){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([a,i])=>this.connection.Mo(e,vp(r,n),s,a,i)).catch(a=>{throw a.name==="FirebaseError"?(a.code===fe.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),a):new Ne(fe.UNKNOWN,a.toString())})}Lo(e,r,n,s,a){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([i,o])=>this.connection.Lo(e,vp(r,n),s,i,o,a)).catch(i=>{throw i.name==="FirebaseError"?(i.code===fe.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),i):new Ne(fe.UNKNOWN,i.toString())})}terminate(){this.y_=!0,this.connection.terminate()}}class NO{constructor(e,r){this.asyncQueue=e,this.onlineStateHandler=r,this.state="Unknown",this.S_=0,this.b_=null,this.D_=!0}v_(){this.S_===0&&(this.C_("Unknown"),this.b_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.b_=null,this.F_("Backend didn't respond within 10 seconds."),this.C_("Offline"),Promise.resolve())))}M_(e){this.state==="Online"?this.C_("Unknown"):(this.S_++,this.S_>=1&&(this.x_(),this.F_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.C_("Offline")))}set(e){this.x_(),this.S_=0,e==="Online"&&(this.D_=!1),this.C_(e)}C_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}F_(e){const r=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.D_?(da(r),this.D_=!1):Pe("OnlineStateTracker",r)}x_(){this.b_!==null&&(this.b_.cancel(),this.b_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PO{constructor(e,r,n,s,a){this.localStore=e,this.datastore=r,this.asyncQueue=n,this.remoteSyncer={},this.O_=[],this.N_=new Map,this.L_=new Set,this.B_=[],this.k_=a,this.k_._o(i=>{n.enqueueAndForget(async()=>{to(this)&&(Pe("RemoteStore","Restarting streams for network reachability change."),await async function(l){const c=Be(l);c.L_.add(4),await Pu(c),c.q_.set("Unknown"),c.L_.delete(4),await Ud(c)}(this))})}),this.q_=new NO(n,s)}}async function Ud(t){if(to(t))for(const e of t.B_)await e(!0)}async function Pu(t){for(const e of t.B_)await e(!1)}function fS(t,e){const r=Be(t);r.N_.has(e.targetId)||(r.N_.set(e.targetId,e),yv(r)?_v(r):El(r).r_()&&xv(r,e))}function vv(t,e){const r=Be(t),n=El(r);r.N_.delete(e),n.r_()&&hS(r,e),r.N_.size===0&&(n.r_()?n.o_():to(r)&&r.q_.set("Unknown"))}function xv(t,e){if(t.Q_.xe(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(Ve.min())>0){const r=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(r)}El(t).A_(e)}function hS(t,e){t.Q_.xe(e),El(t).R_(e)}function _v(t){t.Q_=new bF({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),ot:e=>t.N_.get(e)||null,tt:()=>t.datastore.serializer.databaseId}),El(t).start(),t.q_.v_()}function yv(t){return to(t)&&!El(t).n_()&&t.N_.size>0}function to(t){return Be(t).L_.size===0}function dS(t){t.Q_=void 0}async function bO(t){t.q_.set("Online")}async function DO(t){t.N_.forEach((e,r)=>{xv(t,e)})}async function FO(t,e){dS(t),yv(t)?(t.q_.M_(e),_v(t)):t.q_.set("Unknown")}async function OO(t,e,r){if(t.q_.set("Online"),e instanceof Zk&&e.state===2&&e.cause)try{await async function(s,a){const i=a.cause;for(const o of a.targetIds)s.N_.has(o)&&(await s.remoteSyncer.rejectListen(o,i),s.N_.delete(o),s.Q_.removeTarget(o))}(t,e)}catch(n){Pe("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),n),await zh(t,n)}else if(e instanceof eh?t.Q_.Ke(e):e instanceof Jk?t.Q_.He(e):t.Q_.We(e),!r.isEqual(Ve.min()))try{const n=await lS(t.localStore);r.compareTo(n)>=0&&await function(a,i){const o=a.Q_.rt(i);return o.targetChanges.forEach((l,c)=>{if(l.resumeToken.approximateByteSize()>0){const u=a.N_.get(c);u&&a.N_.set(c,u.withResumeToken(l.resumeToken,i))}}),o.targetMismatches.forEach((l,c)=>{const u=a.N_.get(l);if(!u)return;a.N_.set(l,u.withResumeToken(Sr.EMPTY_BYTE_STRING,u.snapshotVersion)),hS(a,l);const h=new Va(u.target,l,c,u.sequenceNumber);xv(a,h)}),a.remoteSyncer.applyRemoteEvent(o)}(t,r)}catch(n){Pe("RemoteStore","Failed to raise snapshot:",n),await zh(t,n)}}async function zh(t,e,r){if(!Iu(e))throw e;t.L_.add(1),await Pu(t),t.q_.set("Offline"),r||(r=()=>lS(t.localStore)),t.asyncQueue.enqueueRetryable(async()=>{Pe("RemoteStore","Retrying IndexedDB access"),await r(),t.L_.delete(1),await Ud(t)})}function mS(t,e){return e().catch(r=>zh(t,r,e))}async function Bd(t){const e=Be(t),r=ai(e);let n=e.O_.length>0?e.O_[e.O_.length-1].batchId:-1;for(;MO(e);)try{const s=await _O(e.localStore,n);if(s===null){e.O_.length===0&&r.o_();break}n=s.batchId,LO(e,s)}catch(s){await zh(e,s)}pS(e)&&gS(e)}function MO(t){return to(t)&&t.O_.length<10}function LO(t,e){t.O_.push(e);const r=ai(t);r.r_()&&r.V_&&r.m_(e.mutations)}function pS(t){return to(t)&&!ai(t).n_()&&t.O_.length>0}function gS(t){ai(t).start()}async function jO(t){ai(t).p_()}async function VO(t){const e=ai(t);for(const r of t.O_)e.m_(r.mutations)}async function UO(t,e,r){const n=t.O_.shift(),s=fv.from(n,e,r);await mS(t,()=>t.remoteSyncer.applySuccessfulWrite(s)),await Bd(t)}async function BO(t,e){e&&ai(t).V_&&await async function(n,s){if(function(i){return RF(i)&&i!==fe.ABORTED}(s.code)){const a=n.O_.shift();ai(n).s_(),await mS(n,()=>n.remoteSyncer.rejectFailedWrite(a.batchId,s)),await Bd(n)}}(t,e),pS(t)&&gS(t)}async function yy(t,e){const r=Be(t);r.asyncQueue.verifyOperationInProgress(),Pe("RemoteStore","RemoteStore received new credentials");const n=to(r);r.L_.add(3),await Pu(r),n&&r.q_.set("Unknown"),await r.remoteSyncer.handleCredentialChange(e),r.L_.delete(3),await Ud(r)}async function zO(t,e){const r=Be(t);e?(r.L_.delete(2),await Ud(r)):e||(r.L_.add(2),await Pu(r),r.q_.set("Unknown"))}function El(t){return t.K_||(t.K_=function(r,n,s){const a=Be(r);return a.w_(),new IO(n,a.connection,a.authCredentials,a.appCheckCredentials,a.serializer,s)}(t.datastore,t.asyncQueue,{Eo:bO.bind(null,t),Ro:DO.bind(null,t),mo:FO.bind(null,t),d_:OO.bind(null,t)}),t.B_.push(async e=>{e?(t.K_.s_(),yv(t)?_v(t):t.q_.set("Unknown")):(await t.K_.stop(),dS(t))})),t.K_}function ai(t){return t.U_||(t.U_=function(r,n,s){const a=Be(r);return a.w_(),new CO(n,a.connection,a.authCredentials,a.appCheckCredentials,a.serializer,s)}(t.datastore,t.asyncQueue,{Eo:()=>Promise.resolve(),Ro:jO.bind(null,t),mo:BO.bind(null,t),f_:VO.bind(null,t),g_:UO.bind(null,t)}),t.B_.push(async e=>{e?(t.U_.s_(),await Bd(t)):(await t.U_.stop(),t.O_.length>0&&(Pe("RemoteStore",`Stopping write stream with ${t.O_.length} pending writes`),t.O_=[]))})),t.U_}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wv{constructor(e,r,n,s,a){this.asyncQueue=e,this.timerId=r,this.targetTimeMs=n,this.op=s,this.removalCallback=a,this.deferred=new ta,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(i=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,r,n,s,a){const i=Date.now()+n,o=new wv(e,r,i,s,a);return o.start(n),o}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new Ne(fe.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Ev(t,e){if(da("AsyncQueue",`${e}: ${t}`),Iu(t))return new Ne(fe.UNAVAILABLE,`${e}: ${t}`);throw t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ho{constructor(e){this.comparator=e?(r,n)=>e(r,n)||be.comparator(r.key,n.key):(r,n)=>be.comparator(r.key,n.key),this.keyedMap=Zl(),this.sortedSet=new Lt(this.comparator)}static emptySet(e){return new Ho(e.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const r=this.keyedMap.get(e);return r?this.sortedSet.indexOf(r):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((r,n)=>(e(r),!1))}add(e){const r=this.delete(e.key);return r.copy(r.keyedMap.insert(e.key,e),r.sortedSet.insert(e,null))}delete(e){const r=this.get(e);return r?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(r)):this}isEqual(e){if(!(e instanceof Ho)||this.size!==e.size)return!1;const r=this.sortedSet.getIterator(),n=e.sortedSet.getIterator();for(;r.hasNext();){const s=r.getNext().key,a=n.getNext().key;if(!s.isEqual(a))return!1}return!0}toString(){const e=[];return this.forEach(r=>{e.push(r.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,r){const n=new Ho;return n.comparator=this.comparator,n.keyedMap=e,n.sortedSet=r,n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wy{constructor(){this.W_=new Lt(be.comparator)}track(e){const r=e.doc.key,n=this.W_.get(r);n?e.type!==0&&n.type===3?this.W_=this.W_.insert(r,e):e.type===3&&n.type!==1?this.W_=this.W_.insert(r,{type:n.type,doc:e.doc}):e.type===2&&n.type===2?this.W_=this.W_.insert(r,{type:2,doc:e.doc}):e.type===2&&n.type===0?this.W_=this.W_.insert(r,{type:0,doc:e.doc}):e.type===1&&n.type===0?this.W_=this.W_.remove(r):e.type===1&&n.type===2?this.W_=this.W_.insert(r,{type:1,doc:n.doc}):e.type===0&&n.type===1?this.W_=this.W_.insert(r,{type:2,doc:e.doc}):Le():this.W_=this.W_.insert(r,e)}G_(){const e=[];return this.W_.inorderTraversal((r,n)=>{e.push(n)}),e}}class ul{constructor(e,r,n,s,a,i,o,l,c){this.query=e,this.docs=r,this.oldDocs=n,this.docChanges=s,this.mutatedKeys=a,this.fromCache=i,this.syncStateChanged=o,this.excludesMetadataChanges=l,this.hasCachedResults=c}static fromInitialDocuments(e,r,n,s,a){const i=[];return r.forEach(o=>{i.push({type:0,doc:o})}),new ul(e,r,Ho.emptySet(r),i,n,s,!0,!1,a)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Fd(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const r=this.docChanges,n=e.docChanges;if(r.length!==n.length)return!1;for(let s=0;s<r.length;s++)if(r[s].type!==n[s].type||!r[s].doc.isEqual(n[s].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $O{constructor(){this.z_=void 0,this.j_=[]}H_(){return this.j_.some(e=>e.J_())}}class WO{constructor(){this.queries=Ey(),this.onlineState="Unknown",this.Y_=new Set}terminate(){(function(r,n){const s=Be(r),a=s.queries;s.queries=Ey(),a.forEach((i,o)=>{for(const l of o.j_)l.onError(n)})})(this,new Ne(fe.ABORTED,"Firestore shutting down"))}}function Ey(){return new wl(t=>Lk(t),Fd)}async function Tv(t,e){const r=Be(t);let n=3;const s=e.query;let a=r.queries.get(s);a?!a.H_()&&e.J_()&&(n=2):(a=new $O,n=e.J_()?0:1);try{switch(n){case 0:a.z_=await r.onListen(s,!0);break;case 1:a.z_=await r.onListen(s,!1);break;case 2:await r.onFirstRemoteStoreListen(s)}}catch(i){const o=Ev(i,`Initialization of query '${_o(e.query)}' failed`);return void e.onError(o)}r.queries.set(s,a),a.j_.push(e),e.Z_(r.onlineState),a.z_&&e.X_(a.z_)&&Sv(r)}async function kv(t,e){const r=Be(t),n=e.query;let s=3;const a=r.queries.get(n);if(a){const i=a.j_.indexOf(e);i>=0&&(a.j_.splice(i,1),a.j_.length===0?s=e.J_()?0:1:!a.H_()&&e.J_()&&(s=2))}switch(s){case 0:return r.queries.delete(n),r.onUnlisten(n,!0);case 1:return r.queries.delete(n),r.onUnlisten(n,!1);case 2:return r.onLastRemoteStoreUnlisten(n);default:return}}function HO(t,e){const r=Be(t);let n=!1;for(const s of e){const a=s.query,i=r.queries.get(a);if(i){for(const o of i.j_)o.X_(s)&&(n=!0);i.z_=s}}n&&Sv(r)}function GO(t,e,r){const n=Be(t),s=n.queries.get(e);if(s)for(const a of s.j_)a.onError(r);n.queries.delete(e)}function Sv(t){t.Y_.forEach(e=>{e.next()})}var wp,Ty;(Ty=wp||(wp={})).ea="default",Ty.Cache="cache";class Av{constructor(e,r,n){this.query=e,this.ta=r,this.na=!1,this.ra=null,this.onlineState="Unknown",this.options=n||{}}X_(e){if(!this.options.includeMetadataChanges){const n=[];for(const s of e.docChanges)s.type!==3&&n.push(s);e=new ul(e.query,e.docs,e.oldDocs,n,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let r=!1;return this.na?this.ia(e)&&(this.ta.next(e),r=!0):this.sa(e,this.onlineState)&&(this.oa(e),r=!0),this.ra=e,r}onError(e){this.ta.error(e)}Z_(e){this.onlineState=e;let r=!1;return this.ra&&!this.na&&this.sa(this.ra,e)&&(this.oa(this.ra),r=!0),r}sa(e,r){if(!e.fromCache||!this.J_())return!0;const n=r!=="Offline";return(!this.options._a||!n)&&(!e.docs.isEmpty()||e.hasCachedResults||r==="Offline")}ia(e){if(e.docChanges.length>0)return!0;const r=this.ra&&this.ra.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!r)&&this.options.includeMetadataChanges===!0}oa(e){e=ul.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.na=!0,this.ta.next(e)}J_(){return this.options.source!==wp.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vS{constructor(e){this.key=e}}class xS{constructor(e){this.key=e}}class KO{constructor(e,r){this.query=e,this.Ta=r,this.Ea=null,this.hasCachedResults=!1,this.current=!1,this.da=Xe(),this.mutatedKeys=Xe(),this.Aa=jk(e),this.Ra=new Ho(this.Aa)}get Va(){return this.Ta}ma(e,r){const n=r?r.fa:new wy,s=r?r.Ra:this.Ra;let a=r?r.mutatedKeys:this.mutatedKeys,i=s,o=!1;const l=this.query.limitType==="F"&&s.size===this.query.limit?s.last():null,c=this.query.limitType==="L"&&s.size===this.query.limit?s.first():null;if(e.inorderTraversal((u,h)=>{const m=s.get(u),p=Od(this.query,h)?h:null,x=!!m&&this.mutatedKeys.has(m.key),v=!!p&&(p.hasLocalMutations||this.mutatedKeys.has(p.key)&&p.hasCommittedMutations);let w=!1;m&&p?m.data.isEqual(p.data)?x!==v&&(n.track({type:3,doc:p}),w=!0):this.ga(m,p)||(n.track({type:2,doc:p}),w=!0,(l&&this.Aa(p,l)>0||c&&this.Aa(p,c)<0)&&(o=!0)):!m&&p?(n.track({type:0,doc:p}),w=!0):m&&!p&&(n.track({type:1,doc:m}),w=!0,(l||c)&&(o=!0)),w&&(p?(i=i.add(p),a=v?a.add(u):a.delete(u)):(i=i.delete(u),a=a.delete(u)))}),this.query.limit!==null)for(;i.size>this.query.limit;){const u=this.query.limitType==="F"?i.last():i.first();i=i.delete(u.key),a=a.delete(u.key),n.track({type:1,doc:u})}return{Ra:i,fa:n,ns:o,mutatedKeys:a}}ga(e,r){return e.hasLocalMutations&&r.hasCommittedMutations&&!r.hasLocalMutations}applyChanges(e,r,n,s){const a=this.Ra;this.Ra=e.Ra,this.mutatedKeys=e.mutatedKeys;const i=e.fa.G_();i.sort((u,h)=>function(p,x){const v=w=>{switch(w){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Le()}};return v(p)-v(x)}(u.type,h.type)||this.Aa(u.doc,h.doc)),this.pa(n),s=s!=null&&s;const o=r&&!s?this.ya():[],l=this.da.size===0&&this.current&&!s?1:0,c=l!==this.Ea;return this.Ea=l,i.length!==0||c?{snapshot:new ul(this.query,e.Ra,a,i,e.mutatedKeys,l===0,c,!1,!!n&&n.resumeToken.approximateByteSize()>0),wa:o}:{wa:o}}Z_(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({Ra:this.Ra,fa:new wy,mutatedKeys:this.mutatedKeys,ns:!1},!1)):{wa:[]}}Sa(e){return!this.Ta.has(e)&&!!this.Ra.has(e)&&!this.Ra.get(e).hasLocalMutations}pa(e){e&&(e.addedDocuments.forEach(r=>this.Ta=this.Ta.add(r)),e.modifiedDocuments.forEach(r=>{}),e.removedDocuments.forEach(r=>this.Ta=this.Ta.delete(r)),this.current=e.current)}ya(){if(!this.current)return[];const e=this.da;this.da=Xe(),this.Ra.forEach(n=>{this.Sa(n.key)&&(this.da=this.da.add(n.key))});const r=[];return e.forEach(n=>{this.da.has(n)||r.push(new xS(n))}),this.da.forEach(n=>{e.has(n)||r.push(new vS(n))}),r}ba(e){this.Ta=e.Ts,this.da=Xe();const r=this.ma(e.documents);return this.applyChanges(r,!0)}Da(){return ul.fromInitialDocuments(this.query,this.Ra,this.mutatedKeys,this.Ea===0,this.hasCachedResults)}}class qO{constructor(e,r,n){this.query=e,this.targetId=r,this.view=n}}class XO{constructor(e){this.key=e,this.va=!1}}class YO{constructor(e,r,n,s,a,i){this.localStore=e,this.remoteStore=r,this.eventManager=n,this.sharedClientState=s,this.currentUser=a,this.maxConcurrentLimboResolutions=i,this.Ca={},this.Fa=new wl(o=>Lk(o),Fd),this.Ma=new Map,this.xa=new Set,this.Oa=new Lt(be.comparator),this.Na=new Map,this.La=new mv,this.Ba={},this.ka=new Map,this.qa=cl.kn(),this.onlineState="Unknown",this.Qa=void 0}get isPrimaryClient(){return this.Qa===!0}}async function QO(t,e,r=!0){const n=kS(t);let s;const a=n.Fa.get(e);return a?(n.sharedClientState.addLocalQueryTarget(a.targetId),s=a.view.Da()):s=await _S(n,e,r,!0),s}async function JO(t,e){const r=kS(t);await _S(r,e,!0,!1)}async function _S(t,e,r,n){const s=await yO(t.localStore,Ss(e)),a=s.targetId,i=t.sharedClientState.addLocalQueryTarget(a,r);let o;return n&&(o=await ZO(t,e,a,i==="current",s.resumeToken)),t.isPrimaryClient&&r&&fS(t.remoteStore,s),o}async function ZO(t,e,r,n,s){t.Ka=(h,m,p)=>async function(v,w,k,T){let E=w.view.ma(k);E.ns&&(E=await vy(v.localStore,w.query,!1).then(({documents:g})=>w.view.ma(g,E)));const N=T&&T.targetChanges.get(w.targetId),O=T&&T.targetMismatches.get(w.targetId)!=null,M=w.view.applyChanges(E,v.isPrimaryClient,N,O);return Sy(v,w.targetId,M.wa),M.snapshot}(t,h,m,p);const a=await vy(t.localStore,e,!0),i=new KO(e,a.Ts),o=i.ma(a.documents),l=Nu.createSynthesizedTargetChangeForCurrentChange(r,n&&t.onlineState!=="Offline",s),c=i.applyChanges(o,t.isPrimaryClient,l);Sy(t,r,c.wa);const u=new qO(e,r,i);return t.Fa.set(e,u),t.Ma.has(r)?t.Ma.get(r).push(e):t.Ma.set(r,[e]),c.snapshot}async function eM(t,e,r){const n=Be(t),s=n.Fa.get(e),a=n.Ma.get(s.targetId);if(a.length>1)return n.Ma.set(s.targetId,a.filter(i=>!Fd(i,e))),void n.Fa.delete(e);n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(s.targetId),n.sharedClientState.isActiveQueryTarget(s.targetId)||await yp(n.localStore,s.targetId,!1).then(()=>{n.sharedClientState.clearQueryState(s.targetId),r&&vv(n.remoteStore,s.targetId),Ep(n,s.targetId)}).catch(Au)):(Ep(n,s.targetId),await yp(n.localStore,s.targetId,!0))}async function tM(t,e){const r=Be(t),n=r.Fa.get(e),s=r.Ma.get(n.targetId);r.isPrimaryClient&&s.length===1&&(r.sharedClientState.removeLocalQueryTarget(n.targetId),vv(r.remoteStore,n.targetId))}async function rM(t,e,r){const n=cM(t);try{const s=await function(i,o){const l=Be(i),c=ar.now(),u=o.reduce((p,x)=>p.add(x.key),Xe());let h,m;return l.persistence.runTransaction("Locally write mutations","readwrite",p=>{let x=ma(),v=Xe();return l.cs.getEntries(p,u).next(w=>{x=w,x.forEach((k,T)=>{T.isValidDocument()||(v=v.add(k))})}).next(()=>l.localDocuments.getOverlayedDocuments(p,x)).next(w=>{h=w;const k=[];for(const T of o){const E=kF(T,h.get(T.key).overlayedDocument);E!=null&&k.push(new mi(T.key,E,Rk(E.value.mapValue),Un.exists(!0)))}return l.mutationQueue.addMutationBatch(p,c,k,o)}).next(w=>{m=w;const k=w.applyToLocalDocumentSet(h,v);return l.documentOverlayCache.saveOverlays(p,w.batchId,k)})}).then(()=>({batchId:m.batchId,changes:Uk(h)}))}(n.localStore,e);n.sharedClientState.addPendingMutation(s.batchId),function(i,o,l){let c=i.Ba[i.currentUser.toKey()];c||(c=new Lt(ct)),c=c.insert(o,l),i.Ba[i.currentUser.toKey()]=c}(n,s.batchId,r),await bu(n,s.changes),await Bd(n.remoteStore)}catch(s){const a=Ev(s,"Failed to persist write");r.reject(a)}}async function yS(t,e){const r=Be(t);try{const n=await vO(r.localStore,e);e.targetChanges.forEach((s,a)=>{const i=r.Na.get(a);i&&(gt(s.addedDocuments.size+s.modifiedDocuments.size+s.removedDocuments.size<=1),s.addedDocuments.size>0?i.va=!0:s.modifiedDocuments.size>0?gt(i.va):s.removedDocuments.size>0&&(gt(i.va),i.va=!1))}),await bu(r,n,e)}catch(n){await Au(n)}}function ky(t,e,r){const n=Be(t);if(n.isPrimaryClient&&r===0||!n.isPrimaryClient&&r===1){const s=[];n.Fa.forEach((a,i)=>{const o=i.view.Z_(e);o.snapshot&&s.push(o.snapshot)}),function(i,o){const l=Be(i);l.onlineState=o;let c=!1;l.queries.forEach((u,h)=>{for(const m of h.j_)m.Z_(o)&&(c=!0)}),c&&Sv(l)}(n.eventManager,e),s.length&&n.Ca.d_(s),n.onlineState=e,n.isPrimaryClient&&n.sharedClientState.setOnlineState(e)}}async function nM(t,e,r){const n=Be(t);n.sharedClientState.updateQueryState(e,"rejected",r);const s=n.Na.get(e),a=s&&s.key;if(a){let i=new Lt(be.comparator);i=i.insert(a,Mr.newNoDocument(a,Ve.min()));const o=Xe().add(a),l=new jd(Ve.min(),new Map,new Lt(ct),i,o);await yS(n,l),n.Oa=n.Oa.remove(a),n.Na.delete(e),Iv(n)}else await yp(n.localStore,e,!1).then(()=>Ep(n,e,r)).catch(Au)}async function sM(t,e){const r=Be(t),n=e.batch.batchId;try{const s=await gO(r.localStore,e);ES(r,n,null),wS(r,n),r.sharedClientState.updateMutationState(n,"acknowledged"),await bu(r,s)}catch(s){await Au(s)}}async function aM(t,e,r){const n=Be(t);try{const s=await function(i,o){const l=Be(i);return l.persistence.runTransaction("Reject batch","readwrite-primary",c=>{let u;return l.mutationQueue.lookupMutationBatch(c,o).next(h=>(gt(h!==null),u=h.keys(),l.mutationQueue.removeMutationBatch(c,h))).next(()=>l.mutationQueue.performConsistencyCheck(c)).next(()=>l.documentOverlayCache.removeOverlaysForBatchId(c,u,o)).next(()=>l.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(c,u)).next(()=>l.localDocuments.getDocuments(c,u))})}(n.localStore,e);ES(n,e,r),wS(n,e),n.sharedClientState.updateMutationState(e,"rejected",r),await bu(n,s)}catch(s){await Au(s)}}function wS(t,e){(t.ka.get(e)||[]).forEach(r=>{r.resolve()}),t.ka.delete(e)}function ES(t,e,r){const n=Be(t);let s=n.Ba[n.currentUser.toKey()];if(s){const a=s.get(e);a&&(r?a.reject(r):a.resolve(),s=s.remove(e)),n.Ba[n.currentUser.toKey()]=s}}function Ep(t,e,r=null){t.sharedClientState.removeLocalQueryTarget(e);for(const n of t.Ma.get(e))t.Fa.delete(n),r&&t.Ca.$a(n,r);t.Ma.delete(e),t.isPrimaryClient&&t.La.gr(e).forEach(n=>{t.La.containsKey(n)||TS(t,n)})}function TS(t,e){t.xa.delete(e.path.canonicalString());const r=t.Oa.get(e);r!==null&&(vv(t.remoteStore,r),t.Oa=t.Oa.remove(e),t.Na.delete(r),Iv(t))}function Sy(t,e,r){for(const n of r)n instanceof vS?(t.La.addReference(n.key,e),iM(t,n)):n instanceof xS?(Pe("SyncEngine","Document no longer in limbo: "+n.key),t.La.removeReference(n.key,e),t.La.containsKey(n.key)||TS(t,n.key)):Le()}function iM(t,e){const r=e.key,n=r.path.canonicalString();t.Oa.get(r)||t.xa.has(n)||(Pe("SyncEngine","New document in limbo: "+r),t.xa.add(n),Iv(t))}function Iv(t){for(;t.xa.size>0&&t.Oa.size<t.maxConcurrentLimboResolutions;){const e=t.xa.values().next().value;t.xa.delete(e);const r=new be(Ct.fromString(e)),n=t.qa.next();t.Na.set(n,new XO(r)),t.Oa=t.Oa.insert(r,n),fS(t.remoteStore,new Va(Ss(Dd(r.path)),n,"TargetPurposeLimboResolution",nv.oe))}}async function bu(t,e,r){const n=Be(t),s=[],a=[],i=[];n.Fa.isEmpty()||(n.Fa.forEach((o,l)=>{i.push(n.Ka(l,e,r).then(c=>{var u;if((c||r)&&n.isPrimaryClient){const h=c?!c.fromCache:(u=r==null?void 0:r.targetChanges.get(l.targetId))===null||u===void 0?void 0:u.current;n.sharedClientState.updateQueryState(l.targetId,h?"current":"not-current")}if(c){s.push(c);const h=gv.Wi(l.targetId,c);a.push(h)}}))}),await Promise.all(i),n.Ca.d_(s),await async function(l,c){const u=Be(l);try{await u.persistence.runTransaction("notifyLocalViewChanges","readwrite",h=>ve.forEach(c,m=>ve.forEach(m.$i,p=>u.persistence.referenceDelegate.addReference(h,m.targetId,p)).next(()=>ve.forEach(m.Ui,p=>u.persistence.referenceDelegate.removeReference(h,m.targetId,p)))))}catch(h){if(!Iu(h))throw h;Pe("LocalStore","Failed to update sequence numbers: "+h)}for(const h of c){const m=h.targetId;if(!h.fromCache){const p=u.os.get(m),x=p.snapshotVersion,v=p.withLastLimboFreeSnapshotVersion(x);u.os=u.os.insert(m,v)}}}(n.localStore,a))}async function oM(t,e){const r=Be(t);if(!r.currentUser.isEqual(e)){Pe("SyncEngine","User change. New user:",e.toKey());const n=await oS(r.localStore,e);r.currentUser=e,function(a,i){a.ka.forEach(o=>{o.forEach(l=>{l.reject(new Ne(fe.CANCELLED,i))})}),a.ka.clear()}(r,"'waitForPendingWrites' promise is rejected due to a user change."),r.sharedClientState.handleUserChange(e,n.removedBatchIds,n.addedBatchIds),await bu(r,n.hs)}}function lM(t,e){const r=Be(t),n=r.Na.get(e);if(n&&n.va)return Xe().add(n.key);{let s=Xe();const a=r.Ma.get(e);if(!a)return s;for(const i of a){const o=r.Fa.get(i);s=s.unionWith(o.view.Va)}return s}}function kS(t){const e=Be(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=yS.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=lM.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=nM.bind(null,e),e.Ca.d_=HO.bind(null,e.eventManager),e.Ca.$a=GO.bind(null,e.eventManager),e}function cM(t){const e=Be(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=sM.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=aM.bind(null,e),e}class $h{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=Vd(e.databaseInfo.databaseId),this.sharedClientState=this.Wa(e),this.persistence=this.Ga(e),await this.persistence.start(),this.localStore=this.za(e),this.gcScheduler=this.ja(e,this.localStore),this.indexBackfillerScheduler=this.Ha(e,this.localStore)}ja(e,r){return null}Ha(e,r){return null}za(e){return pO(this.persistence,new dO,e.initialUser,this.serializer)}Ga(e){return new uO(pv.Zr,this.serializer)}Wa(e){return new EO}async terminate(){var e,r;(e=this.gcScheduler)===null||e===void 0||e.stop(),(r=this.indexBackfillerScheduler)===null||r===void 0||r.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}$h.provider={build:()=>new $h};class Tp{async initialize(e,r){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(r),this.remoteStore=this.createRemoteStore(r),this.eventManager=this.createEventManager(r),this.syncEngine=this.createSyncEngine(r,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=n=>ky(this.syncEngine,n,1),this.remoteStore.remoteSyncer.handleCredentialChange=oM.bind(null,this.syncEngine),await zO(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new WO}()}createDatastore(e){const r=Vd(e.databaseInfo.databaseId),n=function(a){return new AO(a)}(e.databaseInfo);return function(a,i,o,l){return new RO(a,i,o,l)}(e.authCredentials,e.appCheckCredentials,n,r)}createRemoteStore(e){return function(n,s,a,i,o){return new PO(n,s,a,i,o)}(this.localStore,this.datastore,e.asyncQueue,r=>ky(this.syncEngine,r,0),function(){return _y.D()?new _y:new TO}())}createSyncEngine(e,r){return function(s,a,i,o,l,c,u){const h=new YO(s,a,i,o,l,c);return u&&(h.Qa=!0),h}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,r)}async terminate(){var e,r;await async function(s){const a=Be(s);Pe("RemoteStore","RemoteStore shutting down."),a.L_.add(5),await Pu(a),a.k_.shutdown(),a.q_.set("Unknown")}(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate(),(r=this.eventManager)===null||r===void 0||r.terminate()}}Tp.provider={build:()=>new Tp};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cv{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ya(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ya(this.observer.error,e):da("Uncaught Error in snapshot listener:",e.toString()))}Za(){this.muted=!0}Ya(e,r){setTimeout(()=>{this.muted||e(r)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uM{constructor(e,r,n,s,a){this.authCredentials=e,this.appCheckCredentials=r,this.asyncQueue=n,this.databaseInfo=s,this.user=Dr.UNAUTHENTICATED,this.clientId=Ak.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=a,this.authCredentials.start(n,async i=>{Pe("FirestoreClient","Received user=",i.uid),await this.authCredentialListener(i),this.user=i}),this.appCheckCredentials.start(n,i=>(Pe("FirestoreClient","Received new app check token=",i),this.appCheckCredentialListener(i,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new ta;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(r){const n=Ev(r,"Failed to shutdown persistence");e.reject(n)}}),e.promise}}async function G0(t,e){t.asyncQueue.verifyOperationInProgress(),Pe("FirestoreClient","Initializing OfflineComponentProvider");const r=t.configuration;await e.initialize(r);let n=r.initialUser;t.setCredentialChangeListener(async s=>{n.isEqual(s)||(await oS(e.localStore,s),n=s)}),e.persistence.setDatabaseDeletedListener(()=>t.terminate()),t._offlineComponents=e}async function Ay(t,e){t.asyncQueue.verifyOperationInProgress();const r=await fM(t);Pe("FirestoreClient","Initializing OnlineComponentProvider"),await e.initialize(r,t.configuration),t.setCredentialChangeListener(n=>yy(e.remoteStore,n)),t.setAppCheckTokenChangeListener((n,s)=>yy(e.remoteStore,s)),t._onlineComponents=e}async function fM(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){Pe("FirestoreClient","Using user provided OfflineComponentProvider");try{await G0(t,t._uninitializedComponentsProvider._offline)}catch(e){const r=e;if(!function(s){return s.name==="FirebaseError"?s.code===fe.FAILED_PRECONDITION||s.code===fe.UNIMPLEMENTED:!(typeof DOMException<"u"&&s instanceof DOMException)||s.code===22||s.code===20||s.code===11}(r))throw r;al("Error using user provided cache. Falling back to memory cache: "+r),await G0(t,new $h)}}else Pe("FirestoreClient","Using default OfflineComponentProvider"),await G0(t,new $h);return t._offlineComponents}async function SS(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(Pe("FirestoreClient","Using user provided OnlineComponentProvider"),await Ay(t,t._uninitializedComponentsProvider._online)):(Pe("FirestoreClient","Using default OnlineComponentProvider"),await Ay(t,new Tp))),t._onlineComponents}function hM(t){return SS(t).then(e=>e.syncEngine)}async function Wh(t){const e=await SS(t),r=e.eventManager;return r.onListen=QO.bind(null,e.syncEngine),r.onUnlisten=eM.bind(null,e.syncEngine),r.onFirstRemoteStoreListen=JO.bind(null,e.syncEngine),r.onLastRemoteStoreUnlisten=tM.bind(null,e.syncEngine),r}function dM(t,e,r={}){const n=new ta;return t.asyncQueue.enqueueAndForget(async()=>function(a,i,o,l,c){const u=new Cv({next:m=>{u.Za(),i.enqueueAndForget(()=>kv(a,h));const p=m.docs.has(o);!p&&m.fromCache?c.reject(new Ne(fe.UNAVAILABLE,"Failed to get document because the client is offline.")):p&&m.fromCache&&l&&l.source==="server"?c.reject(new Ne(fe.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):c.resolve(m)},error:m=>c.reject(m)}),h=new Av(Dd(o.path),u,{includeMetadataChanges:!0,_a:!0});return Tv(a,h)}(await Wh(t),t.asyncQueue,e,r,n)),n.promise}function mM(t,e,r={}){const n=new ta;return t.asyncQueue.enqueueAndForget(async()=>function(a,i,o,l,c){const u=new Cv({next:m=>{u.Za(),i.enqueueAndForget(()=>kv(a,h)),m.fromCache&&l.source==="server"?c.reject(new Ne(fe.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):c.resolve(m)},error:m=>c.reject(m)}),h=new Av(o,u,{includeMetadataChanges:!0,_a:!0});return Tv(a,h)}(await Wh(t),t.asyncQueue,e,r,n)),n.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function AS(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Iy=new Map;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function IS(t,e,r){if(!r)throw new Ne(fe.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function pM(t,e,r,n){if(e===!0&&n===!0)throw new Ne(fe.INVALID_ARGUMENT,`${t} and ${r} cannot be used together.`)}function Cy(t){if(!be.isDocumentKey(t))throw new Ne(fe.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function Ry(t){if(be.isDocumentKey(t))throw new Ne(fe.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function zd(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=function(n){return n.constructor?n.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":Le()}function dn(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new Ne(fe.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const r=zd(t);throw new Ne(fe.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${r}`)}}return t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ny{constructor(e){var r,n;if(e.host===void 0){if(e.ssl!==void 0)throw new Ne(fe.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=(r=e.ssl)===null||r===void 0||r;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new Ne(fe.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}pM("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=AS((n=e.experimentalLongPollingOptions)!==null&&n!==void 0?n:{}),function(a){if(a.timeoutSeconds!==void 0){if(isNaN(a.timeoutSeconds))throw new Ne(fe.INVALID_ARGUMENT,`invalid long polling timeout: ${a.timeoutSeconds} (must not be NaN)`);if(a.timeoutSeconds<5)throw new Ne(fe.INVALID_ARGUMENT,`invalid long polling timeout: ${a.timeoutSeconds} (minimum allowed value is 5)`);if(a.timeoutSeconds>30)throw new Ne(fe.INVALID_ARGUMENT,`invalid long polling timeout: ${a.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(n,s){return n.timeoutSeconds===s.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class $d{constructor(e,r,n,s){this._authCredentials=e,this._appCheckCredentials=r,this._databaseId=n,this._app=s,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Ny({}),this._settingsFrozen=!1,this._terminateTask="notTerminated"}get app(){if(!this._app)throw new Ne(fe.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new Ne(fe.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Ny(e),e.credentials!==void 0&&(this._authCredentials=function(n){if(!n)return new F3;switch(n.type){case"firstParty":return new j3(n.sessionIndex||"0",n.iamToken||null,n.authTokenFactory||null);case"provider":return n.client;default:throw new Ne(fe.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(r){const n=Iy.get(r);n&&(Pe("ComponentProvider","Removing Datastore"),Iy.delete(r),n.terminate())}(this),Promise.resolve()}}function gM(t,e,r,n={}){var s;const a=(t=dn(t,$d))._getSettings(),i=`${e}:${r}`;if(a.host!=="firestore.googleapis.com"&&a.host!==i&&al("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),t._setSettings(Object.assign(Object.assign({},a),{host:i,ssl:!1})),n.mockUserToken){let o,l;if(typeof n.mockUserToken=="string")o=n.mockUserToken,l=Dr.MOCK_USER;else{o=DT(n.mockUserToken,(s=t._app)===null||s===void 0?void 0:s.options.projectId);const c=n.mockUserToken.sub||n.mockUserToken.user_id;if(!c)throw new Ne(fe.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");l=new Dr(c)}t._authCredentials=new O3(new Sk(o,l))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ro{constructor(e,r,n){this.converter=r,this._query=n,this.type="query",this.firestore=e}withConverter(e){return new ro(this.firestore,e,this._query)}}class Vr{constructor(e,r,n){this.converter=r,this._key=n,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Ja(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Vr(this.firestore,e,this._key)}}class Ja extends ro{constructor(e,r,n){super(e,r,Dd(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Vr(this.firestore,null,new be(e))}withConverter(e){return new Ja(this.firestore,e,this._path)}}function mn(t,e,...r){if(t=Ht(t),IS("collection","path",e),t instanceof $d){const n=Ct.fromString(e,...r);return Ry(n),new Ja(t,null,n)}{if(!(t instanceof Vr||t instanceof Ja))throw new Ne(fe.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=t._path.child(Ct.fromString(e,...r));return Ry(n),new Ja(t.firestore,null,n)}}function Yr(t,e,...r){if(t=Ht(t),arguments.length===1&&(e=Ak.newId()),IS("doc","path",e),t instanceof $d){const n=Ct.fromString(e,...r);return Cy(n),new Vr(t,null,new be(n))}{if(!(t instanceof Vr||t instanceof Ja))throw new Ne(fe.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=t._path.child(Ct.fromString(e,...r));return Cy(n),new Vr(t.firestore,t instanceof Ja?t.converter:null,new be(n))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Py{constructor(e=Promise.resolve()){this.Pu=[],this.Iu=!1,this.Tu=[],this.Eu=null,this.du=!1,this.Au=!1,this.Ru=[],this.t_=new cS(this,"async_queue_retry"),this.Vu=()=>{const n=H0();n&&Pe("AsyncQueue","Visibility state changed to "+n.visibilityState),this.t_.jo()},this.mu=e;const r=H0();r&&typeof r.addEventListener=="function"&&r.addEventListener("visibilitychange",this.Vu)}get isShuttingDown(){return this.Iu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.fu(),this.gu(e)}enterRestrictedMode(e){if(!this.Iu){this.Iu=!0,this.Au=e||!1;const r=H0();r&&typeof r.removeEventListener=="function"&&r.removeEventListener("visibilitychange",this.Vu)}}enqueue(e){if(this.fu(),this.Iu)return new Promise(()=>{});const r=new ta;return this.gu(()=>this.Iu&&this.Au?Promise.resolve():(e().then(r.resolve,r.reject),r.promise)).then(()=>r.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Pu.push(e),this.pu()))}async pu(){if(this.Pu.length!==0){try{await this.Pu[0](),this.Pu.shift(),this.t_.reset()}catch(e){if(!Iu(e))throw e;Pe("AsyncQueue","Operation failed with retryable error: "+e)}this.Pu.length>0&&this.t_.Go(()=>this.pu())}}gu(e){const r=this.mu.then(()=>(this.du=!0,e().catch(n=>{this.Eu=n,this.du=!1;const s=function(i){let o=i.message||"";return i.stack&&(o=i.stack.includes(i.message)?i.stack:i.message+`
`+i.stack),o}(n);throw da("INTERNAL UNHANDLED ERROR: ",s),n}).then(n=>(this.du=!1,n))));return this.mu=r,r}enqueueAfterDelay(e,r,n){this.fu(),this.Ru.indexOf(e)>-1&&(r=0);const s=wv.createAndSchedule(this,e,r,n,a=>this.yu(a));return this.Tu.push(s),s}fu(){this.Eu&&Le()}verifyOperationInProgress(){}async wu(){let e;do e=this.mu,await e;while(e!==this.mu)}Su(e){for(const r of this.Tu)if(r.timerId===e)return!0;return!1}bu(e){return this.wu().then(()=>{this.Tu.sort((r,n)=>r.targetTimeMs-n.targetTimeMs);for(const r of this.Tu)if(r.skipDelay(),e!=="all"&&r.timerId===e)break;return this.wu()})}Du(e){this.Ru.push(e)}yu(e){const r=this.Tu.indexOf(e);this.Tu.splice(r,1)}}function by(t){return function(r,n){if(typeof r!="object"||r===null)return!1;const s=r;for(const a of n)if(a in s&&typeof s[a]=="function")return!0;return!1}(t,["next","error","complete"])}class pa extends $d{constructor(e,r,n,s){super(e,r,n,s),this.type="firestore",this._queue=new Py,this._persistenceKey=(s==null?void 0:s.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new Py(e),this._firestoreClient=void 0,await e}}}function vM(t,e){const r=typeof t=="object"?t:Cd(),n=typeof t=="string"?t:"(default)",s=Eu(r,"firestore").getImmediate({identifier:n});if(!s._initialized){const a=zg("firestore");a&&gM(s,...a)}return s}function Wd(t){if(t._terminated)throw new Ne(fe.FAILED_PRECONDITION,"The client has already been terminated.");return t._firestoreClient||xM(t),t._firestoreClient}function xM(t){var e,r,n;const s=t._freezeSettings(),a=function(o,l,c,u){return new Q3(o,l,c,u.host,u.ssl,u.experimentalForceLongPolling,u.experimentalAutoDetectLongPolling,AS(u.experimentalLongPollingOptions),u.useFetchStreams)}(t._databaseId,((e=t._app)===null||e===void 0?void 0:e.options.appId)||"",t._persistenceKey,s);t._componentsProvider||!((r=s.localCache)===null||r===void 0)&&r._offlineComponentProvider&&(!((n=s.localCache)===null||n===void 0)&&n._onlineComponentProvider)&&(t._componentsProvider={_offline:s.localCache._offlineComponentProvider,_online:s.localCache._onlineComponentProvider}),t._firestoreClient=new uM(t._authCredentials,t._appCheckCredentials,t._queue,a,t._componentsProvider&&function(o){const l=o==null?void 0:o._online.build();return{_offline:o==null?void 0:o._offline.build(l),_online:l}}(t._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fl{constructor(e){this._byteString=e}static fromBase64String(e){try{return new fl(Sr.fromBase64String(e))}catch(r){throw new Ne(fe.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+r)}}static fromUint8Array(e){return new fl(Sr.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hd{constructor(...e){for(let r=0;r<e.length;++r)if(e[r].length===0)throw new Ne(fe.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new _r(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Du{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rv{constructor(e,r){if(!isFinite(e)||e<-90||e>90)throw new Ne(fe.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(r)||r<-180||r>180)throw new Ne(fe.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+r);this._lat=e,this._long=r}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return ct(this._lat,e._lat)||ct(this._long,e._long)}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nv{constructor(e){this._values=(e||[]).map(r=>r)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(n,s){if(n.length!==s.length)return!1;for(let a=0;a<n.length;++a)if(n[a]!==s[a])return!1;return!0}(this._values,e._values)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _M=/^__.*__$/;class yM{constructor(e,r,n){this.data=e,this.fieldMask=r,this.fieldTransforms=n}toMutation(e,r){return this.fieldMask!==null?new mi(e,this.data,this.fieldMask,r,this.fieldTransforms):new Ru(e,this.data,r,this.fieldTransforms)}}class CS{constructor(e,r,n){this.data=e,this.fieldMask=r,this.fieldTransforms=n}toMutation(e,r){return new mi(e,this.data,this.fieldMask,r,this.fieldTransforms)}}function RS(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Le()}}class Pv{constructor(e,r,n,s,a,i){this.settings=e,this.databaseId=r,this.serializer=n,this.ignoreUndefinedProperties=s,a===void 0&&this.vu(),this.fieldTransforms=a||[],this.fieldMask=i||[]}get path(){return this.settings.path}get Cu(){return this.settings.Cu}Fu(e){return new Pv(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Mu(e){var r;const n=(r=this.path)===null||r===void 0?void 0:r.child(e),s=this.Fu({path:n,xu:!1});return s.Ou(e),s}Nu(e){var r;const n=(r=this.path)===null||r===void 0?void 0:r.child(e),s=this.Fu({path:n,xu:!1});return s.vu(),s}Lu(e){return this.Fu({path:void 0,xu:!0})}Bu(e){return Hh(e,this.settings.methodName,this.settings.ku||!1,this.path,this.settings.qu)}contains(e){return this.fieldMask.find(r=>e.isPrefixOf(r))!==void 0||this.fieldTransforms.find(r=>e.isPrefixOf(r.field))!==void 0}vu(){if(this.path)for(let e=0;e<this.path.length;e++)this.Ou(this.path.get(e))}Ou(e){if(e.length===0)throw this.Bu("Document fields must not be empty");if(RS(this.Cu)&&_M.test(e))throw this.Bu('Document fields cannot begin and end with "__"')}}class wM{constructor(e,r,n){this.databaseId=e,this.ignoreUndefinedProperties=r,this.serializer=n||Vd(e)}Qu(e,r,n,s=!1){return new Pv({Cu:e,methodName:r,qu:n,path:_r.emptyPath(),xu:!1,ku:s},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function Gd(t){const e=t._freezeSettings(),r=Vd(t._databaseId);return new wM(t._databaseId,!!e.ignoreUndefinedProperties,r)}function NS(t,e,r,n,s,a={}){const i=t.Qu(a.merge||a.mergeFields?2:0,e,r,s);Fv("Data must be an object, but it was:",i,n);const o=PS(n,i);let l,c;if(a.merge)l=new En(i.fieldMask),c=i.fieldTransforms;else if(a.mergeFields){const u=[];for(const h of a.mergeFields){const m=kp(e,h,r);if(!i.contains(m))throw new Ne(fe.INVALID_ARGUMENT,`Field '${m}' is specified in your field mask but missing from your input data.`);DS(u,m)||u.push(m)}l=new En(u),c=i.fieldTransforms.filter(h=>l.covers(h.field))}else l=null,c=i.fieldTransforms;return new yM(new ln(o),l,c)}class Kd extends Du{_toFieldTransform(e){if(e.Cu!==2)throw e.Cu===1?e.Bu(`${this._methodName}() can only appear at the top level of your update data`):e.Bu(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof Kd}}class bv extends Du{_toFieldTransform(e){return new qk(e.path,new tu)}isEqual(e){return e instanceof bv}}class Dv extends Du{constructor(e,r){super(e),this.$u=r}_toFieldTransform(e){const r=new su(e.serializer,$k(e.serializer,this.$u));return new qk(e.path,r)}isEqual(e){return e instanceof Dv&&this.$u===e.$u}}function EM(t,e,r,n){const s=t.Qu(1,e,r);Fv("Data must be an object, but it was:",s,n);const a=[],i=ln.empty();eo(n,(l,c)=>{const u=Ov(e,l,r);c=Ht(c);const h=s.Nu(u);if(c instanceof Kd)a.push(u);else{const m=Fu(c,h);m!=null&&(a.push(u),i.set(u,m))}});const o=new En(a);return new CS(i,o,s.fieldTransforms)}function TM(t,e,r,n,s,a){const i=t.Qu(1,e,r),o=[kp(e,n,r)],l=[s];if(a.length%2!=0)throw new Ne(fe.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let m=0;m<a.length;m+=2)o.push(kp(e,a[m])),l.push(a[m+1]);const c=[],u=ln.empty();for(let m=o.length-1;m>=0;--m)if(!DS(c,o[m])){const p=o[m];let x=l[m];x=Ht(x);const v=i.Nu(p);if(x instanceof Kd)c.push(p);else{const w=Fu(x,v);w!=null&&(c.push(p),u.set(p,w))}}const h=new En(c);return new CS(u,h,i.fieldTransforms)}function kM(t,e,r,n=!1){return Fu(r,t.Qu(n?4:3,e))}function Fu(t,e){if(bS(t=Ht(t)))return Fv("Unsupported field value:",e,t),PS(t,e);if(t instanceof Du)return function(n,s){if(!RS(s.Cu))throw s.Bu(`${n._methodName}() can only be used with update() and set()`);if(!s.path)throw s.Bu(`${n._methodName}() is not currently supported inside arrays`);const a=n._toFieldTransform(s);a&&s.fieldTransforms.push(a)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.xu&&e.Cu!==4)throw e.Bu("Nested arrays are not supported");return function(n,s){const a=[];let i=0;for(const o of n){let l=Fu(o,s.Lu(i));l==null&&(l={nullValue:"NULL_VALUE"}),a.push(l),i++}return{arrayValue:{values:a}}}(t,e)}return function(n,s){if((n=Ht(n))===null)return{nullValue:"NULL_VALUE"};if(typeof n=="number")return $k(s.serializer,n);if(typeof n=="boolean")return{booleanValue:n};if(typeof n=="string")return{stringValue:n};if(n instanceof Date){const a=ar.fromDate(n);return{timestampValue:Bh(s.serializer,a)}}if(n instanceof ar){const a=new ar(n.seconds,1e3*Math.floor(n.nanoseconds/1e3));return{timestampValue:Bh(s.serializer,a)}}if(n instanceof Rv)return{geoPointValue:{latitude:n.latitude,longitude:n.longitude}};if(n instanceof fl)return{bytesValue:eS(s.serializer,n._byteString)};if(n instanceof Vr){const a=s.databaseId,i=n.firestore._databaseId;if(!i.isEqual(a))throw s.Bu(`Document reference is for database ${i.projectId}/${i.database} but should be for database ${a.projectId}/${a.database}`);return{referenceValue:dv(n.firestore._databaseId||s.databaseId,n._key.path)}}if(n instanceof Nv)return function(i,o){return{mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{values:i.toArray().map(l=>{if(typeof l!="number")throw o.Bu("VectorValues must only contain numeric values.");return cv(o.serializer,l)})}}}}}}(n,s);throw s.Bu(`Unsupported field value: ${zd(n)}`)}(t,e)}function PS(t,e){const r={};return Ik(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):eo(t,(n,s)=>{const a=Fu(s,e.Mu(n));a!=null&&(r[n]=a)}),{mapValue:{fields:r}}}function bS(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof ar||t instanceof Rv||t instanceof fl||t instanceof Vr||t instanceof Du||t instanceof Nv)}function Fv(t,e,r){if(!bS(r)||!function(s){return typeof s=="object"&&s!==null&&(Object.getPrototypeOf(s)===Object.prototype||Object.getPrototypeOf(s)===null)}(r)){const n=zd(r);throw n==="an object"?e.Bu(t+" a custom object"):e.Bu(t+" "+n)}}function kp(t,e,r){if((e=Ht(e))instanceof Hd)return e._internalPath;if(typeof e=="string")return Ov(t,e);throw Hh("Field path arguments must be of type string or ",t,!1,void 0,r)}const SM=new RegExp("[~\\*/\\[\\]]");function Ov(t,e,r){if(e.search(SM)>=0)throw Hh(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,r);try{return new Hd(...e.split("."))._internalPath}catch{throw Hh(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,r)}}function Hh(t,e,r,n,s){const a=n&&!n.isEmpty(),i=s!==void 0;let o=`Function ${e}() called with invalid data`;r&&(o+=" (via `toFirestore()`)"),o+=". ";let l="";return(a||i)&&(l+=" (found",a&&(l+=` in field ${n}`),i&&(l+=` in document ${s}`),l+=")"),new Ne(fe.INVALID_ARGUMENT,o+t+l)}function DS(t,e){return t.some(r=>r.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FS{constructor(e,r,n,s,a){this._firestore=e,this._userDataWriter=r,this._key=n,this._document=s,this._converter=a}get id(){return this._key.path.lastSegment()}get ref(){return new Vr(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new AM(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const r=this._document.data.field(Mv("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r)}}}class AM extends FS{data(){return super.data()}}function Mv(t,e){return typeof e=="string"?Ov(t,e):e instanceof Hd?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function OS(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new Ne(fe.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class Lv{}class IM extends Lv{}function Gh(t,e,...r){let n=[];e instanceof Lv&&n.push(e),n=n.concat(r),function(a){const i=a.filter(l=>l instanceof jv).length,o=a.filter(l=>l instanceof qd).length;if(i>1||i>0&&o>0)throw new Ne(fe.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(n);for(const s of n)t=s._apply(t);return t}class qd extends IM{constructor(e,r,n){super(),this._field=e,this._op=r,this._value=n,this.type="where"}static _create(e,r,n){return new qd(e,r,n)}_apply(e){const r=this._parse(e);return MS(e._query,r),new ro(e.firestore,e.converter,mp(e._query,r))}_parse(e){const r=Gd(e.firestore);return function(a,i,o,l,c,u,h){let m;if(c.isKeyField()){if(u==="array-contains"||u==="array-contains-any")throw new Ne(fe.INVALID_ARGUMENT,`Invalid Query. You can't perform '${u}' queries on documentId().`);if(u==="in"||u==="not-in"){Fy(h,u);const p=[];for(const x of h)p.push(Dy(l,a,x));m={arrayValue:{values:p}}}else m=Dy(l,a,h)}else u!=="in"&&u!=="not-in"&&u!=="array-contains-any"||Fy(h,u),m=kM(o,i,h,u==="in"||u==="not-in");return Zt.create(c,u,m)}(e._query,"where",r,e.firestore._databaseId,this._field,this._op,this._value)}}function Kh(t,e,r){const n=e,s=Mv("where",t);return qd._create(s,n,r)}class jv extends Lv{constructor(e,r){super(),this.type=e,this._queryConstraints=r}static _create(e,r){return new jv(e,r)}_parse(e){const r=this._queryConstraints.map(n=>n._parse(e)).filter(n=>n.getFilters().length>0);return r.length===1?r[0]:us.create(r,this._getOperator())}_apply(e){const r=this._parse(e);return r.getFilters().length===0?e:(function(s,a){let i=s;const o=a.getFlattenedFilters();for(const l of o)MS(i,l),i=mp(i,l)}(e._query,r),new ro(e.firestore,e.converter,mp(e._query,r)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}function Dy(t,e,r){if(typeof(r=Ht(r))=="string"){if(r==="")throw new Ne(fe.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!Mk(e)&&r.indexOf("/")!==-1)throw new Ne(fe.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${r}' contains a '/' character.`);const n=e.path.child(Ct.fromString(r));if(!be.isDocumentKey(n))throw new Ne(fe.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${n}' is not because it has an odd number of segments (${n.length}).`);return ey(t,new be(n))}if(r instanceof Vr)return ey(t,r._key);throw new Ne(fe.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${zd(r)}.`)}function Fy(t,e){if(!Array.isArray(t)||t.length===0)throw new Ne(fe.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function MS(t,e){const r=function(s,a){for(const i of s)for(const o of i.getFlattenedFilters())if(a.indexOf(o.op)>=0)return o.op;return null}(t.filters,function(s){switch(s){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(r!==null)throw r===e.op?new Ne(fe.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new Ne(fe.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${r.toString()}' filters.`)}class CM{convertValue(e,r="none"){switch(Ki(e)){case 0:return null;case 1:return e.booleanValue;case 2:return $t(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,r);case 5:return e.stringValue;case 6:return this.convertBytes(Gi(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,r);case 11:return this.convertObject(e.mapValue,r);case 10:return this.convertVectorValue(e.mapValue);default:throw Le()}}convertObject(e,r){return this.convertObjectMap(e.fields,r)}convertObjectMap(e,r="none"){const n={};return eo(e,(s,a)=>{n[s]=this.convertValue(a,r)}),n}convertVectorValue(e){var r,n,s;const a=(s=(n=(r=e.fields)===null||r===void 0?void 0:r.value.arrayValue)===null||n===void 0?void 0:n.values)===null||s===void 0?void 0:s.map(i=>$t(i.doubleValue));return new Nv(a)}convertGeoPoint(e){return new Rv($t(e.latitude),$t(e.longitude))}convertArray(e,r){return(e.values||[]).map(n=>this.convertValue(n,r))}convertServerTimestamp(e,r){switch(r){case"previous":const n=av(e);return n==null?null:this.convertValue(n,r);case"estimate":return this.convertTimestamp(Jc(e));default:return null}}convertTimestamp(e){const r=si(e);return new ar(r.seconds,r.nanos)}convertDocumentKey(e,r){const n=Ct.fromString(e);gt(iS(n));const s=new Zc(n.get(1),n.get(3)),a=new be(n.popFirst(5));return s.isEqual(r)||da(`Document ${a} contains a document reference within a different database (${s.projectId}/${s.database}) which is not supported. It will be treated as a reference in the current database (${r.projectId}/${r.database}) instead.`),a}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function LS(t,e,r){let n;return n=t?r&&(r.merge||r.mergeFields)?t.toFirestore(e,r):t.toFirestore(e):e,n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tc{constructor(e,r){this.hasPendingWrites=e,this.fromCache=r}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class jS extends FS{constructor(e,r,n,s,a,i){super(e,r,n,s,i),this._firestore=e,this._firestoreImpl=e,this.metadata=a}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const r=new th(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(r,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,r={}){if(this._document){const n=this._document.data.field(Mv("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n,r.serverTimestamps)}}}class th extends jS{data(e={}){return super.data(e)}}class VS{constructor(e,r,n,s){this._firestore=e,this._userDataWriter=r,this._snapshot=s,this.metadata=new tc(s.hasPendingWrites,s.fromCache),this.query=n}get docs(){const e=[];return this.forEach(r=>e.push(r)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,r){this._snapshot.docs.forEach(n=>{e.call(r,new th(this._firestore,this._userDataWriter,n.key,n,new tc(this._snapshot.mutatedKeys.has(n.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const r=!!e.includeMetadataChanges;if(r&&this._snapshot.excludesMetadataChanges)throw new Ne(fe.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===r||(this._cachedChanges=function(s,a){if(s._snapshot.oldDocs.isEmpty()){let i=0;return s._snapshot.docChanges.map(o=>{const l=new th(s._firestore,s._userDataWriter,o.doc.key,o.doc,new tc(s._snapshot.mutatedKeys.has(o.doc.key),s._snapshot.fromCache),s.query.converter);return o.doc,{type:"added",doc:l,oldIndex:-1,newIndex:i++}})}{let i=s._snapshot.oldDocs;return s._snapshot.docChanges.filter(o=>a||o.type!==3).map(o=>{const l=new th(s._firestore,s._userDataWriter,o.doc.key,o.doc,new tc(s._snapshot.mutatedKeys.has(o.doc.key),s._snapshot.fromCache),s.query.converter);let c=-1,u=-1;return o.type!==0&&(c=i.indexOf(o.doc.key),i=i.delete(o.doc.key)),o.type!==1&&(i=i.add(o.doc),u=i.indexOf(o.doc.key)),{type:RM(o.type),doc:l,oldIndex:c,newIndex:u}})}}(this,r),this._cachedChangesIncludeMetadataChanges=r),this._cachedChanges}}function RM(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Le()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ra(t){t=dn(t,Vr);const e=dn(t.firestore,pa);return dM(Wd(e),t._key).then(r=>US(e,t,r))}class Vv extends CM{constructor(e){super(),this.firestore=e}convertBytes(e){return new fl(e)}convertReference(e){const r=this.convertDocumentKey(e,this.firestore._databaseId);return new Vr(this.firestore,null,r)}}function kn(t){t=dn(t,ro);const e=dn(t.firestore,pa),r=Wd(e),n=new Vv(e);return OS(t._query),mM(r,t._query).then(s=>new VS(e,n,t,s))}function ii(t,e,r){t=dn(t,Vr);const n=dn(t.firestore,pa),s=LS(t.converter,e,r);return Xd(n,[NS(Gd(n),"setDoc",t._key,s,t.converter!==null,r).toMutation(t._key,Un.none())])}function hl(t,e,r,...n){t=dn(t,Vr);const s=dn(t.firestore,pa),a=Gd(s);let i;return i=typeof(e=Ht(e))=="string"||e instanceof Hd?TM(a,"updateDoc",t._key,e,r,n):EM(a,"updateDoc",t._key,e),Xd(s,[i.toMutation(t._key,Un.exists(!0))])}function NM(t){return Xd(dn(t.firestore,pa),[new uv(t._key,Un.none())])}function Uv(t,e){const r=dn(t.firestore,pa),n=Yr(t),s=LS(t.converter,e);return Xd(r,[NS(Gd(t.firestore),"addDoc",n._key,s,t.converter!==null,{}).toMutation(n._key,Un.exists(!1))]).then(()=>n)}function PM(t,...e){var r,n,s;t=Ht(t);let a={includeMetadataChanges:!1,source:"default"},i=0;typeof e[i]!="object"||by(e[i])||(a=e[i],i++);const o={includeMetadataChanges:a.includeMetadataChanges,source:a.source};if(by(e[i])){const h=e[i];e[i]=(r=h.next)===null||r===void 0?void 0:r.bind(h),e[i+1]=(n=h.error)===null||n===void 0?void 0:n.bind(h),e[i+2]=(s=h.complete)===null||s===void 0?void 0:s.bind(h)}let l,c,u;if(t instanceof Vr)c=dn(t.firestore,pa),u=Dd(t._key.path),l={next:h=>{e[i]&&e[i](US(c,t,h))},error:e[i+1],complete:e[i+2]};else{const h=dn(t,ro);c=dn(h.firestore,pa),u=h._query;const m=new Vv(c);l={next:p=>{e[i]&&e[i](new VS(c,m,h,p))},error:e[i+1],complete:e[i+2]},OS(t._query)}return function(m,p,x,v){const w=new Cv(v),k=new Av(p,w,x);return m.asyncQueue.enqueueAndForget(async()=>Tv(await Wh(m),k)),()=>{w.Za(),m.asyncQueue.enqueueAndForget(async()=>kv(await Wh(m),k))}}(Wd(c),u,o,l)}function Xd(t,e){return function(n,s){const a=new ta;return n.asyncQueue.enqueueAndForget(async()=>rM(await hM(n),s,a)),a.promise}(Wd(t),e)}function US(t,e,r){const n=r.docs.get(e._key),s=new Vv(t);return new jS(t,s,e._key,n,new tc(r.hasPendingWrites,r.fromCache),e.converter)}function bM(){return new bv("serverTimestamp")}function DM(t){return new Dv("increment",t)}(function(e,r=!0){(function(s){yl=s})(Zi),ri(new ua("firestore",(n,{instanceIdentifier:s,options:a})=>{const i=n.getProvider("app").getImmediate(),o=new pa(new M3(n.getProvider("auth-internal")),new U3(n.getProvider("app-check-internal")),function(c,u){if(!Object.prototype.hasOwnProperty.apply(c.options,["projectId"]))throw new Ne(fe.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Zc(c.options.projectId,u)}(i,s),i);return a=Object.assign({useFetchStreams:r},a),o._setSettings(a),o},"PUBLIC").setMultipleInstances(!0)),Vn(X_,"4.7.3",e),Vn(X_,"4.7.3","esm2017")})();var FM="firebase",OM="10.14.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Vn(FM,OM,"app");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const BS="firebasestorage.googleapis.com",MM="storageBucket",LM=2*60*1e3,jM=10*60*1e3;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ds extends bs{constructor(e,r,n=0){super(K0(e),`Firebase Storage: ${r} (${K0(e)})`),this.status_=n,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,Ds.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return K0(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}var Rs;(function(t){t.UNKNOWN="unknown",t.OBJECT_NOT_FOUND="object-not-found",t.BUCKET_NOT_FOUND="bucket-not-found",t.PROJECT_NOT_FOUND="project-not-found",t.QUOTA_EXCEEDED="quota-exceeded",t.UNAUTHENTICATED="unauthenticated",t.UNAUTHORIZED="unauthorized",t.UNAUTHORIZED_APP="unauthorized-app",t.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",t.INVALID_CHECKSUM="invalid-checksum",t.CANCELED="canceled",t.INVALID_EVENT_NAME="invalid-event-name",t.INVALID_URL="invalid-url",t.INVALID_DEFAULT_BUCKET="invalid-default-bucket",t.NO_DEFAULT_BUCKET="no-default-bucket",t.CANNOT_SLICE_BLOB="cannot-slice-blob",t.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",t.NO_DOWNLOAD_URL="no-download-url",t.INVALID_ARGUMENT="invalid-argument",t.INVALID_ARGUMENT_COUNT="invalid-argument-count",t.APP_DELETED="app-deleted",t.INVALID_ROOT_OPERATION="invalid-root-operation",t.INVALID_FORMAT="invalid-format",t.INTERNAL_ERROR="internal-error",t.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})(Rs||(Rs={}));function K0(t){return"storage/"+t}function VM(){const t="An unknown error occurred, please check the error payload for server response.";return new Ds(Rs.UNKNOWN,t)}function UM(){return new Ds(Rs.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function BM(){return new Ds(Rs.CANCELED,"User canceled the upload/download.")}function zM(t){return new Ds(Rs.INVALID_URL,"Invalid URL '"+t+"'.")}function $M(t){return new Ds(Rs.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+t+"'.")}function Oy(t){return new Ds(Rs.INVALID_ARGUMENT,t)}function zS(){return new Ds(Rs.APP_DELETED,"The Firebase app was deleted.")}function WM(t){return new Ds(Rs.INVALID_ROOT_OPERATION,"The operation '"+t+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rs{constructor(e,r){this.bucket=e,this.path_=r}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,r){let n;try{n=rs.makeFromUrl(e,r)}catch{return new rs(e,"")}if(n.path==="")return n;throw $M(e)}static makeFromUrl(e,r){let n=null;const s="([A-Za-z0-9.\\-_]+)";function a(N){N.path.charAt(N.path.length-1)==="/"&&(N.path_=N.path_.slice(0,-1))}const i="(/(.*))?$",o=new RegExp("^gs://"+s+i,"i"),l={bucket:1,path:3};function c(N){N.path_=decodeURIComponent(N.path)}const u="v[A-Za-z0-9_]+",h=r.replace(/[.]/g,"\\."),m="(/([^?#]*).*)?$",p=new RegExp(`^https?://${h}/${u}/b/${s}/o${m}`,"i"),x={bucket:1,path:3},v=r===BS?"(?:storage.googleapis.com|storage.cloud.google.com)":r,w="([^?#]*)",k=new RegExp(`^https?://${v}/${s}/${w}`,"i"),E=[{regex:o,indices:l,postModify:a},{regex:p,indices:x,postModify:c},{regex:k,indices:{bucket:1,path:2},postModify:c}];for(let N=0;N<E.length;N++){const O=E[N],M=O.regex.exec(e);if(M){const g=M[O.indices.bucket];let y=M[O.indices.path];y||(y=""),n=new rs(g,y),O.postModify(n);break}}if(n==null)throw zM(e);return n}}class HM{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function GM(t,e,r){let n=1,s=null,a=null,i=!1,o=0;function l(){return o===2}let c=!1;function u(...w){c||(c=!0,e.apply(null,w))}function h(w){s=setTimeout(()=>{s=null,t(p,l())},w)}function m(){a&&clearTimeout(a)}function p(w,...k){if(c){m();return}if(w){m(),u.call(null,w,...k);return}if(l()||i){m(),u.call(null,w,...k);return}n<64&&(n*=2);let E;o===1?(o=2,E=0):E=(n+Math.random())*1e3,h(E)}let x=!1;function v(w){x||(x=!0,m(),!c&&(s!==null?(w||(o=2),clearTimeout(s),h(0)):w||(o=1)))}return h(0),a=setTimeout(()=>{i=!0,v(!0)},r),v}function KM(t){t(!1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qM(t){return t!==void 0}function My(t,e,r,n){if(n<e)throw Oy(`Invalid value for '${t}'. Expected ${e} or greater.`);if(n>r)throw Oy(`Invalid value for '${t}'. Expected ${r} or less.`)}function XM(t){const e=encodeURIComponent;let r="?";for(const n in t)if(t.hasOwnProperty(n)){const s=e(n)+"="+e(t[n]);r=r+s+"&"}return r=r.slice(0,-1),r}var qh;(function(t){t[t.NO_ERROR=0]="NO_ERROR",t[t.NETWORK_ERROR=1]="NETWORK_ERROR",t[t.ABORT=2]="ABORT"})(qh||(qh={}));/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function YM(t,e){const r=t>=500&&t<600,s=[408,429].indexOf(t)!==-1,a=e.indexOf(t)!==-1;return r||s||a}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QM{constructor(e,r,n,s,a,i,o,l,c,u,h,m=!0){this.url_=e,this.method_=r,this.headers_=n,this.body_=s,this.successCodes_=a,this.additionalRetryCodes_=i,this.callback_=o,this.errorCallback_=l,this.timeout_=c,this.progressCallback_=u,this.connectionFactory_=h,this.retry=m,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((p,x)=>{this.resolve_=p,this.reject_=x,this.start_()})}start_(){const e=(n,s)=>{if(s){n(!1,new kf(!1,null,!0));return}const a=this.connectionFactory_();this.pendingConnection_=a;const i=o=>{const l=o.loaded,c=o.lengthComputable?o.total:-1;this.progressCallback_!==null&&this.progressCallback_(l,c)};this.progressCallback_!==null&&a.addUploadProgressListener(i),a.send(this.url_,this.method_,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&a.removeUploadProgressListener(i),this.pendingConnection_=null;const o=a.getErrorCode()===qh.NO_ERROR,l=a.getStatus();if(!o||YM(l,this.additionalRetryCodes_)&&this.retry){const u=a.getErrorCode()===qh.ABORT;n(!1,new kf(!1,null,u));return}const c=this.successCodes_.indexOf(l)!==-1;n(!0,new kf(c,a))})},r=(n,s)=>{const a=this.resolve_,i=this.reject_,o=s.connection;if(s.wasSuccessCode)try{const l=this.callback_(o,o.getResponse());qM(l)?a(l):a()}catch(l){i(l)}else if(o!==null){const l=VM();l.serverResponse=o.getErrorText(),this.errorCallback_?i(this.errorCallback_(o,l)):i(l)}else if(s.canceled){const l=this.appDelete_?zS():BM();i(l)}else{const l=UM();i(l)}};this.canceled_?r(!1,new kf(!1,null,!0)):this.backoffId_=GM(e,r,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&KM(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}}class kf{constructor(e,r,n){this.wasSuccessCode=e,this.connection=r,this.canceled=!!n}}function JM(t,e){e!==null&&e.length>0&&(t.Authorization="Firebase "+e)}function ZM(t,e){t["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}function eL(t,e){e&&(t["X-Firebase-GMPID"]=e)}function tL(t,e){e!==null&&(t["X-Firebase-AppCheck"]=e)}function rL(t,e,r,n,s,a,i=!0){const o=XM(t.urlParams),l=t.url+o,c=Object.assign({},t.headers);return eL(c,e),JM(c,r),ZM(c,a),tL(c,n),new QM(l,t.method,c,t.body,t.successCodes,t.additionalRetryCodes,t.handler,t.errorHandler,t.timeout,t.progressCallback,s,i)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nL(t){if(t.length===0)return null;const e=t.lastIndexOf("/");return e===-1?"":t.slice(0,e)}function sL(t){const e=t.lastIndexOf("/",t.length-2);return e===-1?t:t.slice(e+1)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xh{constructor(e,r){this._service=e,r instanceof rs?this._location=r:this._location=rs.makeFromUrl(r,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,r){return new Xh(e,r)}get root(){const e=new rs(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return sL(this._location.path)}get storage(){return this._service}get parent(){const e=nL(this._location.path);if(e===null)return null;const r=new rs(this._location.bucket,e);return new Xh(this._service,r)}_throwIfRoot(e){if(this._location.path==="")throw WM(e)}}function Ly(t,e){const r=e==null?void 0:e[MM];return r==null?null:rs.makeFromBucketSpec(r,t)}function aL(t,e,r,n={}){t.host=`${e}:${r}`,t._protocol="http";const{mockUserToken:s}=n;s&&(t._overrideAuthToken=typeof s=="string"?s:DT(s,t.app.options.projectId))}class iL{constructor(e,r,n,s,a){this.app=e,this._authProvider=r,this._appCheckProvider=n,this._url=s,this._firebaseVersion=a,this._bucket=null,this._host=BS,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=LM,this._maxUploadRetryTime=jM,this._requests=new Set,s!=null?this._bucket=rs.makeFromBucketSpec(s,this._host):this._bucket=Ly(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=rs.makeFromBucketSpec(this._url,e):this._bucket=Ly(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){My("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){My("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const r=await e.getToken();if(r!==null)return r.accessToken}return null}async _getAppCheckToken(){const e=this._appCheckProvider.getImmediate({optional:!0});return e?(await e.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new Xh(this,e)}_makeRequest(e,r,n,s,a=!0){if(this._deleted)return new HM(zS());{const i=rL(e,this._appId,n,s,r,this._firebaseVersion,a);return this._requests.add(i),i.getPromise().then(()=>this._requests.delete(i),()=>this._requests.delete(i)),i}}async makeRequestWithTokens(e,r){const[n,s]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,r,n,s).getPromise()}}const jy="@firebase/storage",Vy="0.13.2";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $S="storage";function oL(t=Cd(),e){t=Ht(t);const n=Eu(t,$S).getImmediate({identifier:e}),s=zg("storage");return s&&lL(n,...s),n}function lL(t,e,r,n={}){aL(t,e,r,n)}function cL(t,{instanceIdentifier:e}){const r=t.getProvider("app").getImmediate(),n=t.getProvider("auth-internal"),s=t.getProvider("app-check-internal");return new iL(r,n,s,e,Zi)}function uL(){ri(new ua($S,cL,"PUBLIC").setMultipleInstances(!0)),Vn(jy,Vy,""),Vn(jy,Vy,"esm2017")}uL();/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const WS="functions";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fL{constructor(e,r,n){this.auth=null,this.messaging=null,this.appCheck=null,this.auth=e.getImmediate({optional:!0}),this.messaging=r.getImmediate({optional:!0}),this.auth||e.get().then(s=>this.auth=s,()=>{}),this.messaging||r.get().then(s=>this.messaging=s,()=>{}),this.appCheck||n.get().then(s=>this.appCheck=s,()=>{})}async getAuthToken(){if(this.auth)try{const e=await this.auth.getToken();return e==null?void 0:e.accessToken}catch{return}}async getMessagingToken(){if(!(!this.messaging||!("Notification"in self)||Notification.permission!=="granted"))try{return await this.messaging.getToken()}catch{return}}async getAppCheckToken(e){if(this.appCheck){const r=e?await this.appCheck.getLimitedUseToken():await this.appCheck.getToken();return r.error?null:r.token}return null}async getContext(e){const r=await this.getAuthToken(),n=await this.getMessagingToken(),s=await this.getAppCheckToken(e);return{authToken:r,messagingToken:n,appCheckToken:s}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Sp="us-central1";class hL{constructor(e,r,n,s,a=Sp,i){this.app=e,this.fetchImpl=i,this.emulatorOrigin=null,this.contextProvider=new fL(r,n,s),this.cancelAllRequests=new Promise(o=>{this.deleteService=()=>Promise.resolve(o())});try{const o=new URL(a);this.customDomain=o.origin+(o.pathname==="/"?"":o.pathname),this.region=Sp}catch{this.customDomain=null,this.region=a}}_delete(){return this.deleteService()}_url(e){const r=this.app.options.projectId;return this.emulatorOrigin!==null?`${this.emulatorOrigin}/${r}/${this.region}/${e}`:this.customDomain!==null?`${this.customDomain}/${e}`:`https://${this.region}-${r}.cloudfunctions.net/${e}`}}function dL(t,e,r){t.emulatorOrigin=`http://${e}:${r}`}const Uy="@firebase/functions",By="0.11.8";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mL="auth-internal",pL="app-check-internal",gL="messaging-internal";function vL(t,e){const r=(n,{instanceIdentifier:s})=>{const a=n.getProvider("app").getImmediate(),i=n.getProvider(mL),o=n.getProvider(gL),l=n.getProvider(pL);return new hL(a,i,o,l,s,t)};ri(new ua(WS,r,"PUBLIC").setMultipleInstances(!0)),Vn(Uy,By,e),Vn(Uy,By,"esm2017")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xL(t=Cd(),e=Sp){const n=Eu(Ht(t),WS).getImmediate({identifier:e}),s=zg("functions");return s&&_L(n,...s),n}function _L(t,e,r){dL(Ht(t),e,r)}vL(fetch.bind(self));const yL={apiKey:"AIzaSyAnEPcQISz9FY68mib-0StN6NQtTF3oz1c",authDomain:"xmas-movies.firebaseapp.com",projectId:"xmas-movies",storageBucket:"xmas-movies.firebasestorage.app",messagingSenderId:"721037810395",appId:"1:721037810395:web:1126b377adcc225c944afe"},Yd=MT(yL),yc=b3(Yd),HS=new ys;HS.setCustomParameters({prompt:"select_account"});const wL=HS,_t=vM(Yd);oL(Yd);xL(Yd);const GS=W.createContext(void 0),fs=()=>{const t=W.useContext(GS);if(t===void 0)throw new Error("useAuth must be used within an AuthProvider");return t},EL=({children:t})=>{const[e,r]=W.useState(null),[n,s]=W.useState(null),[a,i]=W.useState(!0),[o,l]=W.useState(null);W.useEffect(()=>{const m=ik(yc,async p=>{if(r(p),l(null),p)try{const x=Yr(_t,"users",p.uid),v=await ra(x);if(v.exists())await ii(x,{lastLoginAt:bM()},{merge:!0}),s(v.data());else{const w={email:p.email||"",displayName:p.displayName||"User",photoURL:p.photoURL||void 0,createdAt:new Date,lastLoginAt:new Date};await ii(x,w),s({id:p.uid,...w})}}catch(x){console.error("Error fetching user profile:",x),l("Failed to load user profile")}else s(null);i(!1)});return()=>m()},[]);const h={currentUser:e,userProfile:n,isLoading:a,error:o,signInWithGoogle:async()=>{try{l(null),i(!0);const m=new ys;await vk(yc,m)}catch(m){console.error("Login error:",m),l(m.message||"Failed to sign in")}finally{i(!1)}},signOut:async()=>{try{await ED(yc)}catch(m){console.error("Sign out error:",m),l(m.message||"Failed to sign out")}}};return d.jsx(GS.Provider,{value:h,children:t})},Ou=()=>{const[t,e]=W.useState(!1),[r,n]=W.useState(!0),[s,a]=W.useState(null),[i,o]=W.useState(null);return W.useEffect(()=>{const l=ik(yc,async c=>{if(n(!0),a(null),!c){e(!1),o(null),n(!1);return}o({uid:c.uid,email:c.email});try{const h=(await HT(c,!0)).claims.admin===!0;e(h)}catch(u){console.error("Error checking admin status:",u),a("Failed to verify admin status"),e(!1)}finally{n(!1)}});return()=>l()},[]),{isAdmin:t,loading:r,error:s,currentUser:i}},TL=({snowflakeCount:t=100,mobileSnowflakeCount:e=50})=>{const[r,n]=W.useState(!1),[s,a]=W.useState(t),i=W.useRef(null),o=W.useRef([]),l=W.useRef(0);return W.useEffect(()=>{const c=()=>{const u=window.matchMedia("(max-width: 768px)").matches;n(u),a(u?e:t)};return c(),window.addEventListener("resize",c),()=>{window.removeEventListener("resize",c)}},[t,e]),W.useEffect(()=>{const c=i.current;if(!c)return;const u=c.getContext("2d");if(!u)return;const h=()=>{c.width=window.innerWidth,c.height=window.innerHeight},m=()=>{o.current=[];for(let w=0;w<s;w++)o.current.push({x:Math.random()*c.width,y:Math.random()*c.height,size:r?Math.random()*3+1:Math.random()*4+1,speed:r?Math.random()*.8+.3:Math.random()*1+.5,opacity:r?Math.random()*.5+.2:Math.random()*.6+.3,wind:r?Math.random()*.3-.15:Math.random()*.5-.25})},p=w=>{u.beginPath(),u.arc(w.x,w.y,w.size,0,Math.PI*2),u.fillStyle=`rgba(255, 255, 255, ${w.opacity})`,u.fill()},x=w=>{w.y+=w.speed,w.x+=w.wind,w.y>c.height&&(w.y=-10,w.x=Math.random()*c.width),w.x>c.width?w.x=0:w.x<0&&(w.x=c.width)},v=()=>{u.clearRect(0,0,c.width,c.height),o.current.forEach(w=>{p(w),x(w)}),l.current=requestAnimationFrame(v)};return window.addEventListener("resize",h),h(),m(),v(),()=>{window.removeEventListener("resize",h),cancelAnimationFrame(l.current)}},[s]),d.jsx("canvas",{ref:i,className:"fixed top-0 left-0 w-full h-full pointer-events-none z-10","aria-hidden":"true"})},kL=()=>{const[t,e]=W.useState(!1),[r,n]=W.useState(null),[s,a]=W.useState(!1);W.useEffect(()=>{const l=/iPad|iPhone|iPod/.test(navigator.userAgent)&&!window.MSStream;a(l);const c=u=>{u.preventDefault(),n(u),e(!0)};return window.addEventListener("beforeinstallprompt",c),window.matchMedia("(display-mode: standalone)").matches&&e(!1),()=>{window.removeEventListener("beforeinstallprompt",c)}},[]);const i=async()=>{if(!r)return;r.prompt();const{outcome:l}=await r.userChoice;n(null),e(!1),console.log(`User ${l==="accepted"?"accepted":"dismissed"} the install prompt`)},o=()=>{e(!1),localStorage.setItem("installPromptDismissed","true")};return t?d.jsxs("div",{className:"fixed bottom-0 left-0 right-0 bg-green-800 text-white p-4 shadow-lg z-50 flex items-center justify-between",children:[d.jsxs("div",{className:"flex items-center",children:[d.jsx("div",{className:"mr-3 text-2xl",children:d.jsx("i",{className:"fas fa-gift"})}),d.jsx("div",{children:s?d.jsxs("p",{children:["Install this app on your device: tap ",d.jsx("i",{className:"fas fa-share"}),' and then "Add to Home Screen"']}):d.jsx("p",{children:"Add Christmas Movies to your home screen!"})})]}),d.jsxs("div",{className:"flex items-center",children:[!s&&d.jsx("button",{onClick:i,className:"bg-red-700 hover:bg-red-800 text-white py-1 px-4 rounded-full mr-2",children:"Install"}),d.jsx("button",{onClick:o,className:"bg-transparent hover:bg-green-700 text-white py-1 px-2 rounded-full",children:d.jsx("i",{className:"fas fa-times"})})]})]}):null};function SL(){const{currentUser:t}=fs(),{isAdmin:e}=Ou(),[r,n]=W.useState(!1),s=_a();W.useEffect(()=>(r?document.body.style.overflow="hidden":document.body.style.overflow="",()=>{document.body.style.overflow=""}),[r]),W.useEffect(()=>{r&&n(!1)},[s.pathname]);const a=()=>{n(!r)};return d.jsxs("div",{className:"min-h-screen bg-gradient-to-b from-xmas-bg to-xmas-card bg-opacity-95",children:[d.jsx(TL,{snowflakeCount:150,mobileSnowflakeCount:40}),d.jsx(kL,{}),d.jsxs("div",{className:"navbar bg-gradient-to-r from-xmas-card via-xmas-card to-xmas-bg border-b border-xmas-gold px-2 sm:px-4 shadow-lg relative overflow-hidden",children:[d.jsx("div",{className:"absolute top-0 left-0 w-full h-1 bg-gradient-to-r from-xmas-gold via-transparent to-xmas-gold opacity-60"}),d.jsx("div",{className:"absolute -bottom-4 left-0 right-0 h-8 snow-accumulation-fast"}),d.jsxs("div",{className:"flex items-center",children:[d.jsx("button",{className:"btn btn-ghost btn-sm md:hidden relative z-10",onClick:a,"aria-label":"Toggle navigation menu",children:d.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",className:"inline-block w-5 h-5 stroke-current",children:d.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M4 6h16M4 12h16M4 18h16"})})}),d.jsxs(et,{to:"/",className:"hidden sm:flex items-center group",children:[d.jsxs("div",{className:"relative",children:[d.jsx("div",{className:"absolute -inset-1 bg-gradient-to-r from-xmas-gold to-xmas-line rounded-full opacity-70 group-hover:opacity-100 blur transition duration-200"}),d.jsx("div",{className:"relative flex items-center justify-center w-10 h-10 bg-xmas-card rounded-full border border-xmas-gold overflow-hidden",children:d.jsx("img",{src:"/Santa.png",alt:"Santa",className:"w-full h-full object-cover group-hover:scale-110 transition-transform duration-300"})})]}),d.jsx("div",{className:"ml-3 font-christmas text-xl sm:text-2xl bg-gradient-to-br from-xmas-gold via-xmas-snow to-xmas-gold bg-clip-text text-transparent font-bold",children:"Christmas Movies"})]}),d.jsxs(et,{to:"/",className:"sm:hidden flex items-center",children:[d.jsx("div",{className:"w-8 h-8 flex items-center justify-center rounded-full bg-xmas-card border border-xmas-gold overflow-hidden",children:d.jsx("img",{src:"/Santa.png",alt:"Santa",className:"w-full h-full object-cover"})}),d.jsx("span",{className:"ml-2 font-christmas text-lg text-xmas-gold",children:"Christmas Movies"})]})]}),d.jsx("div",{className:"flex-1"}),d.jsxs("div",{className:"flex items-center gap-1 sm:gap-2",children:[t&&d.jsxs(et,{to:"/profile",className:"btn btn-primary btn-sm hidden md:flex",children:[d.jsx("i",{className:"fas fa-user-circle mr-1"})," Profile"]}),t?d.jsxs("div",{className:"dropdown dropdown-end",children:[d.jsx("label",{tabIndex:0,className:"btn btn-ghost btn-circle avatar cursor-pointer",children:d.jsx("div",{className:"w-10 rounded-full border border-xmas-gold",children:t.photoURL?d.jsx("img",{src:t.photoURL,alt:"Profile"}):d.jsx("div",{className:"bg-xmas-card flex items-center justify-center h-full",children:d.jsx("i",{className:"fas fa-user text-xmas-gold"})})})}),d.jsxs("ul",{tabIndex:0,className:"dropdown-content menu menu-sm mt-3 z-[1] p-2 shadow bg-xmas-card rounded-box w-52 border border-xmas-gold",children:[d.jsx("li",{children:d.jsxs(et,{to:"/profile",className:"justify-between",children:["Profile",d.jsx("i",{className:"fas fa-user-circle"})]})}),d.jsx("li",{children:d.jsxs(et,{to:"/movies",children:["My Movies",d.jsx("i",{className:"fas fa-film"})]})}),d.jsx("li",{children:d.jsxs(et,{to:"/random",children:["Random Movie",d.jsx("i",{className:"fas fa-random"})]})}),d.jsx("li",{children:d.jsxs(et,{to:"/import",children:["Import Movies",d.jsx("i",{className:"fas fa-file-import"})]})}),e&&d.jsx("li",{children:d.jsxs(et,{to:"/admin",className:"text-xmas-gold",children:["Admin Dashboard",d.jsx("i",{className:"fas fa-crown"})]})})]})]}):d.jsxs(et,{to:"/login",className:"btn btn-primary btn-sm",children:[d.jsx("i",{className:"fas fa-sign-in-alt mr-1"})," Sign In"]})]})]}),d.jsx("div",{className:`fixed inset-0 bg-black bg-opacity-70 z-20 transition-opacity duration-300 md:hidden ${r?"opacity-100":"opacity-0 pointer-events-none"}`,onClick:a}),d.jsxs("div",{className:`fixed top-0 left-0 h-full w-72 bg-gradient-to-b from-xmas-bg to-xmas-card border-r border-xmas-gold z-30 transform transition-transform duration-300 ease-in-out md:hidden shadow-xl ${r?"translate-x-0":"-translate-x-full"}`,children:[d.jsxs("div",{className:"relative overflow-hidden",children:[d.jsx("div",{className:"absolute top-0 left-0 w-full h-1 bg-gradient-to-r from-xmas-gold via-transparent to-xmas-gold opacity-60"}),d.jsxs("div",{className:"flex justify-between items-center p-4 border-b border-xmas-gold bg-xmas-card bg-opacity-80",children:[d.jsxs("div",{className:"flex items-center",children:[d.jsx("div",{className:"w-9 h-9 flex items-center justify-center rounded-full bg-xmas-card border border-xmas-gold shadow-lg overflow-hidden",children:d.jsx("img",{src:"/Santa.png",alt:"Santa",className:"w-full h-full object-cover"})}),d.jsx("div",{className:"ml-3 font-christmas text-xl bg-gradient-to-br from-xmas-gold via-xmas-snow to-xmas-gold bg-clip-text text-transparent font-bold",children:"Christmas Movies"})]}),d.jsx("button",{className:"btn btn-ghost btn-sm text-xmas-text hover:text-xmas-line",onClick:a,"aria-label":"Close navigation menu",children:d.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:d.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})]}),d.jsx("div",{className:"overflow-y-auto h-full pb-20",children:d.jsx("div",{className:"p-4 pt-6",children:d.jsxs("div",{className:"mb-6",children:[d.jsx("h3",{className:"font-christmas text-xl text-xmas-gold mb-4 pl-2 border-l-2 border-xmas-line",children:"Navigation"}),d.jsxs("ul",{className:"space-y-3",children:[d.jsx("li",{children:d.jsx(xi,{to:"/",onClick:a,className:({isActive:i})=>i?"flex items-center p-2 pl-3 rounded-md bg-gradient-to-r from-xmas-card to-transparent border-l-2 border-xmas-gold text-xmas-gold font-medium":"flex items-center p-2 pl-3 rounded-md hover:bg-xmas-card hover:bg-opacity-50 text-xmas-text hover:text-xmas-gold transition-all duration-200",children:({isActive:i})=>d.jsxs(d.Fragment,{children:[d.jsx("i",{className:"fas fa-home mr-3 text-xmas-gold"}),d.jsx("span",{children:"Home"}),d.jsx("i",{className:`fas fa-snowflake ml-auto text-xmas-gold opacity-70 ${i?"visible":"invisible"}`})]})})}),t?d.jsxs(d.Fragment,{children:[d.jsx("li",{children:d.jsx(xi,{to:"/movies",onClick:a,className:({isActive:i})=>i?"flex items-center p-2 pl-3 rounded-md bg-gradient-to-r from-xmas-card to-transparent border-l-2 border-xmas-gold text-xmas-gold font-medium":"flex items-center p-2 pl-3 rounded-md hover:bg-xmas-card hover:bg-opacity-50 text-xmas-text hover:text-xmas-gold transition-all duration-200",children:({isActive:i})=>d.jsxs(d.Fragment,{children:[d.jsx("i",{className:"fas fa-film mr-3 text-xmas-gold"}),d.jsx("span",{children:"My Movies"}),d.jsx("i",{className:`fas fa-snowflake ml-auto text-xmas-gold opacity-70 ${i?"visible":"invisible"}`})]})})}),d.jsx("li",{children:d.jsx(xi,{to:"/random",onClick:a,className:({isActive:i})=>i?"flex items-center p-2 pl-3 rounded-md bg-gradient-to-r from-xmas-card to-transparent border-l-2 border-xmas-gold text-xmas-gold font-medium":"flex items-center p-2 pl-3 rounded-md hover:bg-xmas-card hover:bg-opacity-50 text-xmas-text hover:text-xmas-gold transition-all duration-200",children:({isActive:i})=>d.jsxs(d.Fragment,{children:[d.jsx("i",{className:"fas fa-random mr-3 text-xmas-gold"}),d.jsx("span",{children:"Random Movie"}),d.jsx("i",{className:`fas fa-snowflake ml-auto text-xmas-gold opacity-70 ${i?"visible":"invisible"}`})]})})}),d.jsx("li",{children:d.jsx(xi,{to:"/import",onClick:a,className:({isActive:i})=>i?"flex items-center p-2 pl-3 rounded-md bg-gradient-to-r from-xmas-card to-transparent border-l-2 border-xmas-gold text-xmas-gold font-medium":"flex items-center p-2 pl-3 rounded-md hover:bg-xmas-card hover:bg-opacity-50 text-xmas-text hover:text-xmas-gold transition-all duration-200",children:({isActive:i})=>d.jsxs(d.Fragment,{children:[d.jsx("i",{className:"fas fa-file-import mr-3 text-xmas-gold"}),d.jsx("span",{children:"Import Movies"}),d.jsx("i",{className:`fas fa-snowflake ml-auto text-xmas-gold opacity-70 ${i?"visible":"invisible"}`})]})})}),d.jsx("li",{children:d.jsx(xi,{to:"/profile",onClick:a,className:({isActive:i})=>i?"flex items-center p-2 pl-3 rounded-md bg-gradient-to-r from-xmas-card to-transparent border-l-2 border-xmas-gold text-xmas-gold font-medium":"flex items-center p-2 pl-3 rounded-md hover:bg-xmas-card hover:bg-opacity-50 text-xmas-text hover:text-xmas-gold transition-all duration-200",children:({isActive:i})=>d.jsxs(d.Fragment,{children:[d.jsx("i",{className:"fas fa-user-circle mr-3 text-xmas-gold"}),d.jsx("span",{children:"Profile"}),d.jsx("i",{className:`fas fa-snowflake ml-auto text-xmas-gold opacity-70 ${i?"visible":"invisible"}`})]})})}),e&&d.jsx("li",{children:d.jsx(xi,{to:"/admin",onClick:a,className:({isActive:i})=>i?"flex items-center p-2 pl-3 rounded-md bg-gradient-to-r from-xmas-card to-transparent border-l-2 border-xmas-gold text-xmas-gold font-medium":"flex items-center p-2 pl-3 rounded-md hover:bg-xmas-card hover:bg-opacity-50 text-xmas-text hover:text-xmas-gold transition-all duration-200",children:({isActive:i})=>d.jsxs(d.Fragment,{children:[d.jsx("i",{className:"fas fa-crown mr-3 text-xmas-gold"}),d.jsx("span",{children:"Admin Dashboard"}),d.jsx("i",{className:`fas fa-snowflake ml-auto text-xmas-gold opacity-70 ${i?"visible":"invisible"}`})]})})})]}):d.jsx("li",{children:d.jsx(xi,{to:"/login",onClick:a,className:({isActive:i})=>i?"flex items-center p-2 pl-3 rounded-md bg-gradient-to-r from-xmas-card to-transparent border-l-2 border-xmas-gold text-xmas-gold font-medium":"flex items-center p-2 pl-3 rounded-md hover:bg-xmas-card hover:bg-opacity-50 text-xmas-text hover:text-xmas-gold transition-all duration-200",children:({isActive:i})=>d.jsxs(d.Fragment,{children:[d.jsx("i",{className:"fas fa-sign-in-alt mr-3 text-xmas-gold"}),d.jsx("span",{children:"Sign In"}),d.jsx("i",{className:`fas fa-snowflake ml-auto text-xmas-gold opacity-70 ${i?"visible":"invisible"}`})]})})})]})]})})})]}),d.jsx("main",{className:"p-4",children:d.jsx(kT,{})}),d.jsx("div",{className:"fixed bottom-0 left-0 w-full pointer-events-none",children:d.jsx("div",{className:"container mx-auto",children:d.jsxs("div",{className:"relative h-16",children:[d.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-px bg-gradient-to-r from-xmas-gold via-transparent to-xmas-gold opacity-40"}),d.jsx("div",{className:"absolute bottom-4 left-4 opacity-30",children:d.jsx("i",{className:"fas fa-tree text-4xl text-xmas-gold"})}),d.jsx("div",{className:"absolute bottom-4 right-4 opacity-30",children:d.jsx("i",{className:"fas fa-star text-4xl text-xmas-gold"})})]})})})]})}const zy=({children:t})=>{const{currentUser:e,isLoading:r}=fs();return r?d.jsx("div",{className:"flex justify-center items-center min-h-[60vh]",children:d.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-xmas-gold"})}):e?t?d.jsx(d.Fragment,{children:t}):d.jsx(kT,{}):d.jsx(MN,{to:"/login"})},Bv=[{id:"first_snowflake",name:"First Snowflake",description:"You logged your very first watched Christmas movie.",hint:"Watch 1 movie.",icon:"",check:t=>t.totalWatched>=1},{id:"snowball_starter",name:"Snowball Starter",description:"You have started to build your festive watchlist.",hint:"Watch 5 movies.",icon:"",check:t=>t.totalWatched>=5},{id:"blizzard_binger",name:"Blizzard Binger",description:"You powered through a flurry of festive films.",hint:"Watch 20 movies.",icon:"",check:t=>t.totalWatched>=20},{id:"christmas_marathoner",name:"Christmas Marathoner",description:"You turned Christmas movies into a marathon event.",hint:"Watch 50 movies.",icon:"",check:t=>t.totalWatched>=50},{id:"twelve_days",name:"12 Days of Christmas",description:"You kept the festive streak going for 12 days.",hint:"Watch a movie daily for 12 days.",icon:"",check:t=>t.hasTwelveDayStreak},{id:"the_grinch",name:"The Grinch",description:"Not every movie can be a Christmas miracle.",hint:"Give a movie 1.",icon:"",check:t=>t.lowRatingAny},{id:"santas_favourite",name:"Santa's Favourite",description:"You found a film worthy of Santa himself.",hint:"Give a movie a perfect 10.",icon:"",check:t=>t.highRatingAny},{id:"the_critic",name:"The Critic",description:"You have opinions on a lot of movies.",hint:"Rate 20 movies.",icon:"",check:t=>t.totalRated>=20},{id:"nice_list",name:"Nice List",description:"You are generous with your festive ratings.",hint:"Keep your average rating above 5.",icon:"",check:t=>t.averageRating>5},{id:"classic_connoisseur",name:"Classic Connoisseur",description:"You appreciate the classics before Y2K.",hint:"Watch 5 movies released before 2000.",icon:"",check:t=>t.classicWatched>=5},{id:"animated_joy",name:"Animated Joy",description:"You love animated festive adventures.",hint:"Watch 5 animated Christmas movies.",icon:"",check:t=>t.animatedCount>=5},{id:"romcom_reindeer",name:"Rom-Com Reindeer",description:"You love a festive meet-cute.",hint:"Watch 5 Christmas romance movies.",icon:"",check:t=>t.romanceCount>=5},{id:"decorator",name:"Decorator",description:"You have a whole row of favourites lit up.",hint:"Mark 10 movies as favourite.",icon:"",check:t=>t.favoriteCount>=10},{id:"elf_mode",name:"Elf Mode",description:"You keep coming back like a dedicated Christmas elf.",hint:"Use the app on 10 different days.",icon:"",check:t=>t.usageDistinctDays>=10},{id:"christmas_eve_watcher",name:"Christmas Eve Watcher",description:"You watched a movie on Christmas Eve.",hint:"Watch a movie on Dec 24.",icon:"",check:t=>t.hasChristmasEveWatch},{id:"new_years_cozy",name:"New Year's Cozy",description:"You started the year with a cozy movie.",hint:"Watch a movie on Jan 1.",icon:"",check:t=>t.hasNewYearsWatch}];function $y(t){if(!t)return null;if(t instanceof Date)return t;if(typeof t.toDate=="function")return t.toDate();if(typeof t=="object"&&"seconds"in t)return new Date(t.seconds*1e3);if(typeof t=="string"){const e=new Date(t);if(!isNaN(e.getTime()))return e}return null}function AL(t,e){let r=0,n=0,s=0,a=0,i=0,o=0,l=0,c=!1,u=!1;const h=new Set,m=new Set,p=new Set;for(const O of t){if(O.watched){r++;const g=$y(O.watchedDate);if(g){const S=g.toISOString().split("T")[0];p.add(S);const R=g.getMonth();g.getDate(),R===11&&h.add(S)}const y=e[O.movieId];y&&y.releaseDate&&y.releaseDate.substring(0,4)<"2000"&&a++,y&&y.genres&&y.genres.includes("Romance")&&i++,y&&y.genres&&y.genres.includes("Animation")&&o++}O.favorite&&l++,typeof O.rating=="number"&&(n++,s+=O.rating,O.rating<=1&&(c=!0),O.rating>=10&&(u=!0));const M=$y(O.updatedAt||O.addedAt);if(M){const g=M.toISOString().split("T")[0];m.add(g)}}const x=Array.from(p).map(O=>{const M=new Date(O+"T00:00:00Z");return Math.floor(M.getTime()/864e5)}).sort((O,M)=>O-M);let v=!1,w=0,k=null;for(const O of x){if(k===null||O===k+1?w+=1:O!==k&&(w=1),w>=12){v=!0;break}k=O}let T=!1,E=!1;for(const O of p){const M=new Date(O+"T00:00:00Z"),g=M.getMonth(),y=M.getDate();g===11&&y===24&&(T=!0),g===0&&y===1&&(E=!0)}const N=n>0?s/n:0;return{totalWatched:r,totalRated:n,averageRating:N,lowRatingAny:c,highRatingAny:u,classicWatched:a,romanceCount:i,animatedCount:o,favoriteCount:l,usageDistinctDays:m.size,decemberDistinctDays:h.size,hasChristmasEveWatch:T,hasNewYearsWatch:E,hasTwelveDayStreak:v}}async function IL(t){const e=await kn(mn(_t,`users/${t}/movies`)),r=[],n=new Set;e.forEach(u=>{const h=u.data();r.push({id:u.id,...h}),h.movieId&&n.add(h.movieId)});const s={};if(n.size){const u=Array.from(n);for(const h of u){(await kn(mn(_t,"movies"))).forEach(p=>{const x=p.data();s[p.id]={id:p.id,...x}});break}}const a=AL(r,s),i=mn(_t,`users/${t}/achievements`),o=await kn(i),l=new Set;o.forEach(u=>l.add(u.id));const c=[];for(const u of Bv)!l.has(u.id)&&u.check(a)&&(c.push(u.id),await ii(Yr(_t,`users/${t}/achievements`,u.id),{unlockedAt:new Date,seen:!1}));return c}const CL=()=>{const{currentUser:t}=fs(),[e,r]=W.useState(new Date),[n,s]=W.useState(null),[a,i]=W.useState(null),o=Bv.length;W.useEffect(()=>{const u=setInterval(()=>r(new Date),1e3);return()=>clearInterval(u)},[]);const l=W.useMemo(()=>{const u=e.getFullYear(),h=new Date(u,11,25,0,0,0);return e>h?new Date(u+1,11,25,0,0,0):h},[e]),c=W.useMemo(()=>{const u=l.getTime()-e.getTime(),h=Math.max(0,Math.floor(u/1e3)),m=Math.floor(h/86400),p=Math.floor(h%86400/3600),x=Math.floor(h%3600/60),v=h%60;return{days:m,hours:p,minutes:x,seconds:v}},[e,l]);return W.useEffect(()=>{const u=Yr(_t,"stats","global"),h=PM(u,m=>{const p=m.data();s(typeof(p==null?void 0:p.watchedTotal)=="number"?p.watchedTotal:0)});return()=>h()},[]),W.useEffect(()=>{if(!t){i(null);return}(async()=>{try{const h=mn(_t,`users/${t.uid}/achievements`),m=await kn(h);i(m.size)}catch(h){console.error("Error loading achievements count",h),i(null)}})()},[t]),d.jsxs("div",{className:"container mx-auto px-4 py-8",children:[d.jsxs("div",{className:"text-center mb-12",children:[d.jsx("h1",{className:"font-christmas text-5xl md:text-7xl text-xmas-line mb-4",children:"My Christmas Movies"}),d.jsx("p",{className:"text-xl md:text-2xl text-xmas-snow mb-8",children:"Track, rate, and discover your favourite Christmas movies!"}),d.jsx("div",{className:"flex flex-col md:flex-row justify-center gap-6 mb-4 md:mb-6",children:t?d.jsxs(d.Fragment,{children:[d.jsxs(et,{to:"/movies",className:"btn btn-primary btn-lg text-xl px-8 py-3 rounded-md shadow-lg hover:shadow-xl transition-all duration-300 border border-xmas-gold border-opacity-30",children:[d.jsx("i",{className:"fas fa-film mr-2"})," My Movies"]}),d.jsxs(et,{to:"/random",className:"btn btn-primary btn-lg text-xl px-8 py-3 rounded-md shadow-lg hover:shadow-xl transition-all duration-300 border border-xmas-gold border-opacity-30",children:[d.jsx("i",{className:"fas fa-random mr-2"})," Random Movie"]}),d.jsxs(et,{to:"/achievements",className:"btn btn-primary btn-lg text-xl px-8 py-3 rounded-md shadow-lg hover:shadow-xl transition-all duration-300 border border-xmas-gold border-opacity-30",children:[d.jsx("i",{className:"fas fa-trophy mr-2"})," Achievements"]})]}):d.jsxs(et,{to:"/login",className:"btn btn-primary btn-lg text-xl px-8 py-3 rounded-md shadow-lg hover:shadow-xl transition-all duration-300 border border-xmas-gold border-opacity-30",children:[d.jsx("i",{className:"fas fa-sign-in-alt mr-2"})," Sign In"]})})]}),d.jsx("div",{className:"w-full max-w-4xl mx-auto mb-8",children:d.jsx("div",{className:"h-px bg-gradient-to-r from-transparent via-xmas-gold to-transparent"})}),d.jsxs("div",{className:"bg-xmas-card rounded-lg shadow-xl p-6 mb-12 border border-xmas-gold border-opacity-30 relative",children:[d.jsx("h2",{className:"font-christmas text-3xl text-xmas-gold text-center mb-6",children:"Countdown to Christmas"}),d.jsxs("div",{className:"grid md:grid-cols-2 gap-6 items-stretch",children:[d.jsxs("div",{className:"bg-xmas-card bg-opacity-70 p-6 rounded-lg shadow-md border-l-2 border-xmas-line flex flex-col items-center justify-center",children:[d.jsxs("div",{className:"text-5xl md:text-6xl font-bold text-xmas-line mb-2",children:[c.days,"d ",c.hours,"h ",c.minutes,"m ",c.seconds,"s"]}),d.jsx("p",{className:"text-xmas-text text-opacity-80",children:"until Christmas Day"})]}),d.jsxs("div",{className:"bg-xmas-card bg-opacity-70 p-6 rounded-lg shadow-md border-l-2 border-xmas-gold flex flex-col items-center justify-center",children:[d.jsx("div",{className:"text-5xl md:text-6xl font-bold text-xmas-gold mb-2",children:n??""}),d.jsx("p",{className:"text-xmas-text text-opacity-80 text-center",children:"total movies watched"})]})]})]}),d.jsxs("div",{className:"bg-xmas-card rounded-lg shadow-xl p-6 mb-12 border border-xmas-gold border-opacity-20 snow-accumulation snow-accumulation-slow relative",children:[d.jsx("h2",{className:"font-christmas text-3xl text-xmas-line mb-6 text-center",children:"Features"}),d.jsxs("div",{className:"grid md:grid-cols-4 gap-6",children:[d.jsxs("div",{className:"bg-xmas-card bg-opacity-70 p-6 rounded-lg shadow-md border-l-2 border-xmas-line",children:[d.jsx("div",{className:"text-3xl text-xmas-gold mb-4 text-center",children:d.jsx("i",{className:"fas fa-search"})}),d.jsx("h3",{className:"font-christmas text-xl text-center mb-3",children:"Find Movies"}),d.jsx("p",{className:"text-center text-xmas-text text-opacity-80",children:"Search and discover Christmas movies using TMDB integration"})]}),d.jsxs("div",{className:"bg-xmas-card bg-opacity-70 p-6 rounded-lg shadow-md border-l-2 border-xmas-gold",children:[d.jsx("div",{className:"text-3xl text-xmas-gold mb-4 text-center",children:d.jsx("i",{className:"fas fa-star"})}),d.jsx("h3",{className:"font-christmas text-xl text-center mb-3",children:"Rate & Review"}),d.jsx("p",{className:"text-center text-xmas-text text-opacity-80",children:"Keep track of movies you've watched and rate them"})]}),d.jsxs("div",{className:"bg-xmas-card bg-opacity-70 p-6 rounded-lg shadow-md border-l-2 border-xmas-line",children:[d.jsx("div",{className:"text-3xl text-xmas-gold mb-4 text-center",children:d.jsx("i",{className:"fas fa-random"})}),d.jsx("h3",{className:"font-christmas text-xl text-center mb-3",children:"Random Picker"}),d.jsx("p",{className:"text-center text-xmas-text text-opacity-80",children:"Can't decide what to watch? Let our random movie picker help!"})]}),d.jsxs("div",{className:"bg-xmas-card bg-opacity-70 p-6 rounded-lg shadow-md border-l-2 border-xmas-line",children:[d.jsx("div",{className:"text-3xl text-xmas-gold mb-4 text-center",children:d.jsx("i",{className:"fas fa-trophy"})}),d.jsx("h3",{className:"font-christmas text-xl text-center mb-3",children:"Achievements"}),d.jsx("p",{className:"text-center text-xmas-text text-opacity-80 mb-2",children:"Unlock festive badges as you watch, rate, and explore."}),t&&d.jsx("p",{className:"text-center text-xmas-text text-opacity-80 font-medium",children:typeof a=="number"?`${a} / ${o} unlocked`:`${o} to discover`})]})]})]}),d.jsx("div",{className:"bg-xmas-card rounded-lg shadow-xl p-6 mb-12 border border-xmas-gold border-opacity-30 snow-accumulation snow-accumulation-fast relative",children:d.jsxs("div",{className:"mb-6 text-center",children:[d.jsxs("h2",{className:"font-christmas text-3xl md:text-4xl text-xmas-gold inline-block relative",children:[d.jsx("span",{className:"relative z-10",children:"Create Your Collection"}),d.jsx("span",{className:"absolute -bottom-2 left-0 right-0 h-1 bg-xmas-gold opacity-30 rounded-full"})]}),d.jsx("p",{className:"mt-4 mb-6",children:"Add movies to your collection and rate them"}),t?d.jsxs(et,{to:"/import",className:"btn btn-primary",children:[d.jsx("i",{className:"fas fa-file-import mr-2"})," Add Movies"]}):d.jsxs(et,{to:"/login",className:"btn btn-primary",children:[d.jsx("i",{className:"fas fa-sign-in-alt mr-2"})," Sign In to Add"]})]})}),d.jsx("div",{className:"w-full max-w-4xl mx-auto mb-8",children:d.jsx("div",{className:"h-px bg-gradient-to-r from-transparent via-xmas-gold to-transparent"})}),d.jsxs("footer",{className:"text-center text-xmas-mute mt-12 pb-8 space-y-4",children:[d.jsxs("p",{children:[" ",new Date().getFullYear()," Christmas Movie Database"]}),d.jsxs("div",{className:"flex flex-col items-center justify-center gap-2 text-xs md:text-sm text-xmas-mute/80",children:[d.jsx("a",{href:"https://www.themoviedb.org",target:"_blank",rel:"noopener noreferrer",className:"btn flex items-center justify-center gap-2",children:d.jsx("img",{src:"/tmdb.svg",alt:"TMDB logo",className:"h-6 md:h-8 w-auto mb-1"})}),d.jsx("p",{className:"max-w-xl px-4",children:"This product uses the TMDB API but is not endorsed or certified by TMDB."})]})]})]})},RL=()=>{const t=di(),{currentUser:e,isLoading:r,error:n,signInWithGoogle:s}=fs();W.useEffect(()=>{e&&!r&&t("/movies")},[e,r,t]);const a=async()=>{try{await s()}catch(i){console.error("Login failed:",i)}};return r?d.jsx("div",{className:"flex justify-center items-center min-h-[60vh]",children:d.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-xmas-gold"})}):d.jsx("div",{className:"container mx-auto px-4 py-12",children:d.jsxs("div",{className:"max-w-md mx-auto",children:[d.jsxs("div",{className:"text-center mb-8",children:[d.jsx("h1",{className:"font-christmas text-4xl text-xmas-line mb-2",children:"Christmas Movie Database"}),d.jsx("p",{className:"text-xmas-mute",children:"Sign in to manage your Christmas movie collection"})]}),d.jsxs("div",{className:"bg-xmas-card rounded-lg shadow-lg p-6",children:[n&&d.jsx("div",{className:"bg-error bg-opacity-10 border-l-4 border-error p-4 mb-6 rounded",children:d.jsx("p",{className:"text-error",children:n})}),d.jsxs("div",{className:"text-center mb-6",children:[d.jsx("p",{className:"mb-4",children:"Sign in with your Google account to access your Christmas movie collection."}),d.jsx("p",{className:"text-sm text-xmas-mute mb-6",children:"Track, rate, and discover Christmas movies!"}),d.jsxs("button",{onClick:a,className:"btn btn-primary w-full flex items-center justify-center gap-2",children:[d.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 48 48",children:[d.jsx("path",{fill:"#FFC107",d:`M43.611,20.083H42V20H24v8h11.303c-1.649,4.657-6.08,8-11.303,8c-6.627,0-12-5.373-12-12
                  s5.373-12,12-12c3.059,0,5.842,1.154,7.961,3.039l5.657-5.657C34.046,6.053,29.268,4,24,4C12.955,4,4,12.955,4,24s8.955,20,20,20
                  s20-8.955,20-20C44,22.659,43.862,21.35,43.611,20.083z`}),d.jsx("path",{fill:"#FF3D00",d:`M6.306,14.691l6.571,4.819C14.655,15.108,18.961,12,24,12c3.059,0,5.842,1.154,7.961,3.039
                  l5.657-5.657C34.046,6.053,29.268,4,24,4C16.318,4,9.656,8.337,6.306,14.691z`}),d.jsx("path",{fill:"#4CAF50",d:`M24,44c5.166,0,9.86-1.977,13.409-5.192l-6.19-5.238C29.211,35.091,26.715,36,24,36
                  c-5.202,0-9.619-3.317-11.283-7.946l-6.522,5.025C9.505,39.556,16.227,44,24,44z`}),d.jsx("path",{fill:"#1976D2",d:`M43.611,20.083H42V20H24v8h11.303c-0.792,2.237-2.231,4.166-4.087,5.571
                  c0.001-0.001,0.002-0.001,0.003-0.002l6.19,5.238C36.971,39.205,44,34,44,24C44,22.659,43.862,21.35,43.611,20.083z`})]}),"Sign in with Google"]})]})]}),d.jsx("div",{className:"text-center mt-6",children:d.jsx("p",{className:"text-sm text-xmas-mute",children:"By signing in, you agree to our Terms of Service and Privacy Policy."})})]})})},NL=t=>t.toLowerCase().replace(/[^\w\s-]/g,"").replace(/\s+/g,"-").replace(/-+/g,"-").trim(),zv=(t,e)=>`/movies/${NL(t)}?id=${e}`,PL=t=>new URLSearchParams(t).get("id"),bL=5*60*1e3;let es=null;const DL=(t,e,r)=>{es={userMovies:e,movies:r,timestamp:Date.now(),userId:t}},FL=t=>!es||es.userId!==t||Date.now()-es.timestamp>bL?null:{userMovies:es.userMovies,movies:es.movies},OL=()=>{es=null},ML=(t,e,r)=>{es&&es.userId===t&&(es.userMovies[e]=r,es.timestamp=Date.now())},$v=async(t,e,r)=>{const n=Yr(_t,`users/${t}/movies`,e);if((await ra(n)).exists()){const o={...r,updatedAt:new Date};r.rating===null&&(o.rating=null),r.watchedDate===null&&(o.watchedDate=null),r.review===null&&(o.review=null),await hl(n,o)}else{const o={userId:t,movieId:e,watched:r.watched||!1,favorite:r.favorite||!1,addedAt:new Date,updatedAt:new Date,...r};await ii(n,o)}const a=await ra(n),i={id:a.id,...a.data()};return ML(t,e,i),i},Ap=async(t,e)=>{const r=Yr(_t,`users/${t}/movies`,e),n=await ra(r);return n.exists()?{id:n.id,...n.data()}:null},KS=async t=>{const e=mn(_t,`users/${t}/movies`),r=await kn(e),n=[];return r.forEach(s=>{n.push({id:s.id,...s.data()})}),n},LL=async(t,e)=>{const r=Yr(_t,`users/${t}/movies`,e);await NM(r),OL()},Qd=async t=>{const e=FL(t);if(e)return e;const r=await KS(t),n={},s=[];r.forEach(o=>{n[o.movieId]=o,s.push(o.movieId)});const a=[];if(s.length>0)for(let l=0;l<s.length;l+=10){const u=s.slice(l,l+10).map(m=>ra(Yr(_t,"movies",m)).then(p=>p.exists()?{id:p.id,...p.data()}:null).catch(p=>(console.error(`Error fetching movie ${m}:`,p),null))),h=await Promise.all(u);a.push(...h.filter(Boolean))}const i={userMovies:n,movies:a};return DL(t,n,a),i},jL=()=>{const{currentUser:t}=fs(),[e,r]=W.useState([]),[n,s]=W.useState({}),[a,i]=W.useState(!0),[o,l]=W.useState(!0),[c,u]=W.useState(null),[h,m]=W.useState("all"),[p,x]=W.useState({option:"title",direction:"asc"}),[v,w]=W.useState(""),[k,T]=W.useState("all"),E=_a();di(),W.useEffect(()=>{const y=new URLSearchParams(E.search),S=y.get("q")||"",R=y.get("field")||"all";S!==v&&w(S),R!==k&&T(R)},[E.search]),W.useEffect(()=>{(async()=>{if(t)try{l(!0);const{userMovies:S,movies:R}=await Qd(t.uid);s(S),r(R)}catch(S){console.error("Error fetching movies:",S),u("Failed to load movies")}finally{l(!1),i(!1)}})()},[t]);const N=y=>{x(S=>S.option===y?{option:y,direction:S.direction==="asc"?"desc":"asc"}:{option:y,direction:"asc"})},O=W.useCallback(y=>{if(!v.trim())return!0;const S=v.toLowerCase().trim(),R=S.split(",").map(C=>C.trim()).filter(Boolean),P=C=>y.cast&&y.cast.some(oe=>oe.toLowerCase().includes(C)),b=n[y.id];switch(k){case"title":return y.title.toLowerCase().includes(S)||y.sortTitle&&y.sortTitle.toLowerCase().includes(S)||y.originalTitle&&y.originalTitle.toLowerCase().includes(S);case"year":return y.releaseDate&&y.releaseDate.substring(0,4).includes(S);case"cast":return R.length?R.some(C=>P(C)):P(S);case"all":default:return y.title.toLowerCase().includes(S)||y.sortTitle&&y.sortTitle.toLowerCase().includes(S)||y.originalTitle&&y.originalTitle.toLowerCase().includes(S)||y.releaseDate&&y.releaseDate.substring(0,4).includes(S)||y.overview&&y.overview.toLowerCase().includes(S)||y.genres&&y.genres.some(C=>C.toLowerCase().includes(S))||y.directors&&y.directors.some(C=>C.toLowerCase().includes(S))||y.cast&&y.cast.some(C=>C.toLowerCase().includes(S))||b&&b.review&&b.review.toLowerCase().includes(S)}},[v,k,n]),M=W.useMemo(()=>{if(o)return[];i(!0);const y=e.filter(S=>{const R=n[S.id];let P=!0;switch(h){case"watched":P=R&&R.watched;break;case"unwatched":P=!R||!R.watched;break;case"favorites":P=R&&R.favorite;break}return P&&O(S)}).sort((S,R)=>{const P=n[S.id],b=n[R.id],C=p.direction==="asc"?1:-1;switch(p.option){case"title":const oe=S.sortTitle||S.title,ae=R.sortTitle||R.title;return oe.localeCompare(ae)*C;case"year":const he=S.releaseDate?parseInt(S.releaseDate.substring(0,4)):0,me=R.releaseDate?parseInt(R.releaseDate.substring(0,4)):0;return(he-me)*C;case"rating":const ee=(P==null?void 0:P.rating)||0,H=(b==null?void 0:b.rating)||0;return(ee-H)*C;case"watched":const ue=P!=null&&P.watched?1:0,de=b!=null&&b.watched?1:0;return(ue-de)*C;default:return 0}});return i(!1),y},[e,n,h,p,v,k,o]),g=M;return o?d.jsx("div",{className:"flex justify-center items-center min-h-[60vh]",children:d.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-xmas-gold"})}):d.jsxs("div",{className:"container mx-auto px-2 sm:px-4 py-4 sm:py-8",children:[d.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-center mb-4 sm:mb-8 gap-3",children:[d.jsx("h1",{className:"font-christmas text-2xl sm:text-3xl md:text-4xl text-xmas-line",children:"My Christmas Movies"}),d.jsxs("div",{className:"flex gap-2 w-full sm:w-auto justify-center",children:[d.jsxs(et,{to:"/random",className:"btn btn-primary btn-sm sm:btn-md",children:[d.jsx("i",{className:"fas fa-random mr-1 sm:mr-2"})," ",d.jsx("span",{className:"hidden xs:inline",children:"Random Movie"}),d.jsx("span",{className:"xs:hidden",children:"Random"})]}),d.jsxs(et,{to:"/import",className:"btn btn-primary btn-sm sm:btn-md",children:[d.jsx("i",{className:"fas fa-file-import mr-1 sm:mr-2"})," ",d.jsx("span",{className:"hidden xs:inline",children:"Add Movies"}),d.jsx("span",{className:"xs:hidden",children:"Import"})]})]})]}),c&&d.jsxs("div",{className:"alert alert-error mb-6",children:[d.jsx("i",{className:"fas fa-exclamation-circle mr-2"}),d.jsx("span",{children:c})]}),d.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 mb-3",children:[d.jsxs("div",{className:"relative flex-grow",children:[d.jsx("div",{className:"absolute inset-y-0 left-0 pl-2 flex items-center pointer-events-none",children:d.jsx("i",{className:"fas fa-search text-gray-400"})}),d.jsx("input",{type:"text",className:"input input-bordered input-sm sm:input-md w-full pl-8 pr-8",placeholder:"   Search movies...",value:v,onChange:y=>w(y.target.value)}),v&&d.jsx("button",{className:"absolute inset-y-0 right-0 pr-2 flex items-center",onClick:()=>w(""),children:d.jsx("i",{className:"fas fa-times text-gray-400 hover:text-gray-600"})})]}),d.jsxs("select",{className:"select select-bordered select-sm sm:select-md w-full sm:w-36",value:k,onChange:y=>T(y.target.value),children:[d.jsx("option",{value:"all",children:"All Fields"}),d.jsx("option",{value:"title",children:"Title Only"}),d.jsx("option",{value:"year",children:"Year Only"}),d.jsx("option",{value:"cast",children:"Cast Only"})]})]}),d.jsxs("div",{className:"tabs tabs-boxed mb-3 text-xs sm:text-sm overflow-x-auto",children:[d.jsx("button",{className:`tab ${h==="all"?"tab-active":""}`,onClick:()=>m("all"),children:"All Movies"}),d.jsx("button",{className:`tab ${h==="watched"?"tab-active":""}`,onClick:()=>m("watched"),children:"Watched"}),d.jsx("button",{className:`tab ${h==="unwatched"?"tab-active":""}`,onClick:()=>m("unwatched"),children:"Watch"}),d.jsxs("button",{className:`tab ${h==="favorites"?"tab-active":""}`,onClick:()=>m("favorites"),children:[d.jsx("span",{className:"hidden sm:inline",children:"Favourites"}),d.jsx("span",{className:"sm:hidden",children:"Favs"})]})]}),d.jsxs("div",{className:"flex flex-wrap items-center gap-1 mb-3 bg-xmas-card bg-opacity-50 p-2 rounded-lg overflow-x-auto",children:[d.jsx("span",{className:"text-xs sm:text-sm font-medium mr-1",children:"Sort:"}),d.jsxs("div",{className:"flex flex-nowrap gap-1 overflow-x-auto",children:[d.jsxs("button",{className:`btn btn-xs ${p.option==="title"?"btn-primary":"btn-ghost"}`,onClick:()=>N("title"),children:["Title ",p.option==="title"&&d.jsx("i",{className:`fas fa-sort-${p.direction==="asc"?"up":"down"} ml-1`})]}),d.jsxs("button",{className:`btn btn-xs ${p.option==="year"?"btn-primary":"btn-ghost"}`,onClick:()=>N("year"),children:["Year ",p.option==="year"&&d.jsx("i",{className:`fas fa-sort-${p.direction==="asc"?"up":"down"} ml-1`})]}),d.jsxs("button",{className:`btn btn-xs ${p.option==="rating"?"btn-primary":"btn-ghost"}`,onClick:()=>N("rating"),children:["Rating ",p.option==="rating"&&d.jsx("i",{className:`fas fa-sort-${p.direction==="asc"?"up":"down"} ml-1`})]}),d.jsxs("button",{className:`btn btn-xs ${p.option==="watched"?"btn-primary":"btn-ghost"}`,onClick:()=>N("watched"),children:[d.jsx("span",{className:"hidden sm:inline",children:"Watched Status"}),d.jsx("span",{className:"sm:hidden",children:"Watched"}),p.option==="watched"&&d.jsx("i",{className:`fas fa-sort-${p.direction==="asc"?"up":"down"} ml-1`})]})]})]}),d.jsxs("div",{className:"flex flex-col xs:flex-row justify-between items-start xs:items-center mb-3 text-xs sm:text-sm",children:[d.jsxs("div",{children:[d.jsx("span",{className:"font-medium",children:M.length})," ",M.length===1?"movie":"movies"," found",v&&d.jsxs("span",{className:"ml-1 text-xmas-mute",children:["for: ",d.jsxs("span",{className:"font-medium",children:['"',v,'"']})]})]}),p.option&&d.jsxs("div",{className:"text-xmas-mute",children:["Sorted by ",d.jsx("span",{className:"font-medium",children:p.option})," (",p.direction==="asc"?"asc":"desc",")"]})]}),a&&!o&&d.jsx("div",{className:"flex justify-center items-center py-4",children:d.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-t-2 border-b-2 border-xmas-gold"})}),M.length===0?d.jsxs("div",{className:"bg-xmas-card p-8 rounded-lg text-center",children:[d.jsx("h3",{className:"text-xl mb-4",children:"No movies found"}),d.jsx("p",{className:"mb-4",children:h==="all"?"You haven't added any Christmas movies yet.":`You don't have any ${h} Christmas movies.`}),d.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 justify-center",children:[d.jsxs(et,{to:"/import",className:"btn btn-primary",children:[d.jsx("i",{className:"fas fa-file-import mr-2"})," Add Movies"]}),e.length>0&&d.jsxs(et,{to:"/random",className:"btn btn-primary",children:[d.jsx("i",{className:"fas fa-random mr-2"})," Random Movie"]})]})]}):d.jsx("div",{className:"grid grid-cols-3 sm:grid-cols-4 md:grid-cols-5 lg:grid-cols-6 gap-2 sm:gap-3",children:g.map(y=>{var R;const S=n[y.id];return d.jsx(et,{to:zv(y.title,y.id),state:{from:"movies"},className:"block transition-transform hover:scale-[1.02] hover:shadow-xl",children:d.jsxs("div",{className:"relative rounded-lg overflow-hidden bg-xmas-card shadow-md h-full flex flex-col",children:[d.jsxs("div",{className:"relative",children:[y.posterUrl?d.jsx("img",{src:y.posterUrl,alt:y.title,className:"w-full h-auto object-cover",style:{aspectRatio:"2/3"},loading:"lazy"}):d.jsx("div",{className:"w-full flex items-center justify-center bg-gray-800",style:{aspectRatio:"2/3"},children:d.jsx("i",{className:"fas fa-film text-2xl text-gray-500"})}),S&&S.watched&&d.jsx("div",{className:"absolute top-1 right-1 bg-primary rounded-full p-1 shadow-md",children:d.jsx("i",{className:"fas fa-check text-xs text-white"})}),S&&S.favorite&&d.jsx("div",{className:"absolute top-1 left-1 text-yellow-400 drop-shadow-md",children:d.jsx("i",{className:"fas fa-star text-sm"})})]}),d.jsxs("div",{className:"p-1 sm:p-2 flex-grow flex flex-col",children:[d.jsx("h3",{className:"text-xs sm:text-sm font-medium line-clamp-2",children:y.title}),d.jsxs("div",{className:"flex justify-between items-center mt-1",children:[d.jsx("p",{className:"text-xs text-gray-400",children:(R=y.releaseDate)==null?void 0:R.substring(0,4)}),S&&S.rating&&d.jsxs("div",{className:"flex items-center",children:[d.jsx("span",{className:"text-yellow-400 mr-0.5",children:d.jsx("i",{className:"fas fa-star text-xs"})}),d.jsx("span",{className:"text-xs",children:S.rating})]})]})]})]})},y.id)})})]})},Ip=Yr(_t,"stats","global");async function VL(){(await ra(Ip)).exists()||await ii(Ip,{watchedTotal:0,updatedAt:new Date},{merge:!0})}async function UL(t){await VL(),await hl(Ip,{watchedTotal:DM(t),updatedAt:new Date})}const BL=[{id:"heartwarming",label:"Heartwarming",emoji:"",type:"positive"},{id:"very_christmassy",label:"Very Christmassy",emoji:"",type:"positive"},{id:"snowy",label:"Snowy Setting",emoji:"",type:"positive"},{id:"funny",label:"Funny",emoji:"",type:"positive"},{id:"cheesy",label:"Cheesy (Good Way)",emoji:"",type:"positive"},{id:"romantic",label:"Romantic",emoji:"",type:"positive"},{id:"family_friendly",label:"Family Friendly",emoji:"",type:"positive"},{id:"background",label:"Good Background Watch",emoji:"",type:"positive"},{id:"tearjerker",label:"Emotional",emoji:"",type:"positive"},{id:"rewatch",label:"Would Rewatch",emoji:"",type:"positive"}],zL=[{id:"slow",label:"Slow Pacing",emoji:"",type:"negative"},{id:"boring",label:"A Bit Boring",emoji:"",type:"negative"},{id:"low_christmas",label:"Low Xmas Vibes",emoji:"",type:"negative"},{id:"weak_chemistry",label:"Weak Chemistry",emoji:"",type:"negative"},{id:"confusing",label:"Confusing Plot",emoji:"",type:"negative"},{id:"too_long",label:"Too Long",emoji:"",type:"negative"},{id:"cringey",label:"Cringey",emoji:"",type:"negative"},{id:"fake_snow",label:"Fake Snow",emoji:"",type:"negative"},{id:"hammy",label:"Hammy",emoji:"",type:"negative"}],$L={heartwarming:"heartwarming",very_christmassy:"full of Christmas vibes",snowy:"with a lovely snowy setting",funny:"with some funny moments",cheesy:"a bit cheesy in a good way",romantic:"with sweet romantic moments",family_friendly:"very family friendly",background:"great as a cosy background watch",tearjerker:"quite emotional at times",rewatch:"something I'd happily rewatch"},WL={slow:"quite slow in places",boring:"a bit boring overall",low_christmas:"lighter on Christmas vibes than expected",weak_chemistry:"with weak chemistry between the leads",confusing:"a bit confusing at times",too_long:"longer than it needed to be",cringey:"a bit cringey in parts",fake_snow:"with fake snow",hammy:"hammy overacting"};function HL(t){return!t||t<=0?"An easy-going Christmas movie.":t>=9?"Absolutely loved this Christmas movie.":t>=8?"Really enjoyed this festive watch.":t>=7?"A good Christmas movie I liked overall.":t>=6?"A decent cosy watch with some nice moments.":t>=5?"An okay Christmas movie, but nothing special.":t>=3?"Not really my thing, it had a few issues.":"I didn't enjoy this Christmas movie very much."}function Wy(t){if(t.length===0)return"";if(t.length===1)return t[0];const e=t[t.length-1];return`${t.slice(0,-1).join(", ")} and ${e}`}function GL(t){const e=t.map(s=>$L[s]).filter(Boolean),r=t.map(s=>WL[s]).filter(Boolean);let n="";return e.length&&(n+=` It felt ${Wy(e)}.`),r.length&&(n+=` However, it was ${Wy(r)}.`),n}const KL=({rating:t,initialTags:e=[],initialAutoReview:r="",onChange:n})=>{const[s,a]=W.useState(e),[i,o]=W.useState(r);W.useEffect(()=>{a(e)},[e.join("|")]),W.useEffect(()=>{o(r)},[r]);const l=h=>{a(m=>m.includes(h)?m.filter(p=>p!==h):[...m,h])},c=()=>{const h=HL(t),m=GL(s),p=(h+m).trim();o(p),n&&n({tags:s,autoReview:p})},u=h=>s.includes(h);return d.jsxs("div",{className:"mt-4",children:[d.jsxs("div",{className:"flex items-center justify-between mb-2",children:[d.jsx("h3",{className:"text-lg font-semibold text-primary",children:"Quick Vibe Review"}),d.jsx("span",{className:"text-xs opacity-80",children:"Pick a few that fit, then generate."})]}),d.jsx("p",{className:"text-xs mb-1 opacity-80",children:"What worked?"}),d.jsx("div",{className:"flex flex-wrap gap-2 mb-3",children:BL.map(h=>d.jsxs("button",{type:"button",onClick:()=>l(h.id),className:`btn btn-xs rounded-full border ${u(h.id)?"btn-accent text-base-100":"btn-ghost border-base-300 text-sm"}`,children:[d.jsx("span",{className:"mr-1",children:h.emoji}),h.label]},h.id))}),d.jsx("p",{className:"text-xs mb-1 opacity-80",children:"What didn't?"}),d.jsx("div",{className:"flex flex-wrap gap-2 mb-3",children:zL.map(h=>d.jsxs("button",{type:"button",onClick:()=>l(h.id),className:`btn btn-xs rounded-full border ${u(h.id)?"btn-error text-base-100":"btn-ghost border-base-300 text-sm"}`,children:[d.jsx("span",{className:"mr-1",children:h.emoji}),h.label]},h.id))}),d.jsx("button",{type:"button",onClick:c,className:"btn btn-sm btn-primary",children:" Generate Review From Tags"}),i&&d.jsxs("p",{className:"mt-3 text-sm opacity-90 italic",children:["Generated preview: ",i,""]})]})},qL=()=>{var me;const{movieId:t}=EN(),e=_a(),r=di(),{currentUser:n}=fs(),s=PL(e.search),i=((me=e.state)==null?void 0:me.from)==="import"?"/import":"/movies",[o,l]=W.useState(null),[c,u]=W.useState(null),[h,m]=W.useState(!0),[p,x]=W.useState(null),[v,w]=W.useState(!1),[k,T]=W.useState(!1),[E,N]=W.useState(""),[O,M]=W.useState(null),[g,y]=W.useState(""),[S,R]=W.useState(!1),[P,b]=W.useState([]);W.useEffect(()=>{(async()=>{if(!n||!s){x("Movie not found"),m(!1);return}try{m(!0);const H=await ra(Yr(_t,"movies",s));if(!H.exists()){x("Movie not found"),m(!1);return}const ue={id:H.id,...H.data()};l(ue);const de=await Ap(n.uid,s);if(de){u(de),T(de.watched);let B="";if(de.watchedDate)try{if(de.watchedDate instanceof Date)B=de.watchedDate.toISOString().split("T")[0];else{const K=de.watchedDate;if(typeof K=="object"&&K!==null&&"seconds"in K){const X=K;B=new Date(X.seconds*1e3).toISOString().split("T")[0]}else{const X=new Date(de.watchedDate);isNaN(X.getTime())||(B=X.toISOString().split("T")[0])}}}catch(K){console.error("Error parsing watchedDate:",K)}N(B),M(de.rating||null),y(de.review||""),R(de.favorite),b(de.vibeTags||[])}}catch(H){console.error("Error fetching movie data:",H),x("Failed to load movie data")}finally{m(!1)}})()},[n,s]);const C=async()=>{if(!(!n||!s||!o))try{w(!0);const ee={userId:n.uid,movieId:s,watched:k,favorite:S,updatedAt:new Date,vibeTags:P};if(k&&E)try{ee.watchedDate=new Date(E),isNaN(ee.watchedDate.getTime())&&delete ee.watchedDate}catch(ue){console.error("Error parsing watchedDate for save:",ue),delete ee.watchedDate}else k||(ee.watchedDate=null);ee.rating=O,ee.review=g||null;const H=await $v(n.uid,s,ee);u(H)}catch(ee){console.error("Error saving movie data:",ee),x("Failed to save movie data")}finally{w(!1)}},oe=async()=>{if(!n||!s)return;const ee=!S;R(ee);try{const H=Yr(_t,"users",n.uid,"movies",s);(await ra(H)).exists()?await hl(H,{favorite:ee,updatedAt:new Date}):await ii(H,{userId:n.uid,movieId:s,favorite:ee,watched:!1,rating:null,review:"",vibeTags:[],addedAt:new Date,updatedAt:new Date},{merge:!0}),u(de=>de&&{...de,favorite:ee})}catch(H){console.error("Failed to toggle favorite",H),R(!ee)}},ae=async()=>{if(!(!n||!s||!window.confirm("Are you sure you want to remove this movie from your collection?")))try{w(!0),await LL(n.uid,s),r("/movies")}catch(ee){console.error("Error deleting movie:",ee),x("Failed to delete movie"),w(!1)}},he=async()=>{if(!n||!s)return;const ee=!k;T(ee);try{const H=Yr(_t,"users",n.uid,"movies",s),ue=await ra(H),de=ue.exists()?!!ue.data().watched:!1;ue.exists()?await hl(H,{watched:ee,...ee?{}:{watchedDate:null},updatedAt:new Date}):await ii(H,{userId:n.uid,movieId:s,watched:ee,favorite:!1,rating:null,review:"",vibeTags:[],addedAt:new Date,updatedAt:new Date},{merge:!0}),u(B=>B&&{...B,watched:ee}),de!==ee&&await UL(ee?1:-1)}catch(H){console.error("Failed to toggle watched",H),T(!ee)}};return h?d.jsx("div",{className:"flex justify-center items-center min-h-[60vh]",children:d.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-xmas-gold"})}):o?d.jsxs("div",{className:"container mx-auto px-4 py-8",children:[d.jsx("div",{className:"mb-4",children:d.jsxs(et,{to:i,className:"btn btn-primary btn-sm sm:btn-md",children:[d.jsx("i",{className:"fas fa-arrow-left mr-2"})," Back to Movies"]})}),p&&d.jsxs("div",{className:"alert alert-error mb-6",children:[d.jsx("i",{className:"fas fa-exclamation-circle mr-2"}),d.jsx("span",{children:p})]}),d.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-8",children:[d.jsxs("div",{className:"md:col-span-1",children:[d.jsx("div",{className:"rounded-lg overflow-hidden shadow-xl",children:o.posterUrl?d.jsx("img",{src:o.posterUrl,alt:o.title,className:"w-full object-contain",style:{aspectRatio:"2/3"}}):d.jsx("div",{className:"w-full flex items-center justify-center bg-gray-800",style:{aspectRatio:"2/3"},children:d.jsx("i",{className:"fas fa-film text-6xl text-gray-500"})})}),d.jsxs("div",{className:"mt-4 flex flex-col gap-2",children:[d.jsxs("button",{className:`btn ${S?"btn-primary":"btn-outline"} w-full`,onClick:oe,children:[d.jsx("i",{className:`fas fa-star mr-2 ${S?"text-white":""}`}),S?"Favourited":"Add to Favourites"]}),d.jsxs("button",{className:`btn ${k?"btn-success":"btn-outline"} w-full`,onClick:he,children:[d.jsx("i",{className:`fas fa-check mr-2 ${k?"text-white":""}`}),k?"Watched":"Mark as Watched"]}),d.jsxs("button",{className:"btn btn-error btn-outline w-full",onClick:ae,disabled:v,children:[d.jsx("i",{className:"fas fa-trash mr-2"}),"Remove from Collection"]}),o.tmdbId&&d.jsxs("div",{className:"mt-2 flex flex-col items-center",children:[d.jsx("a",{href:`https://www.themoviedb.org/movie/${o.tmdbId}`,target:"_blank",rel:"noopener noreferrer",className:"btn btn-outline w-full flex items-center justify-center gap-2",children:d.jsx("img",{src:"/tmdb.svg",alt:"TMDB",className:"h-5"})}),d.jsx("p",{className:"mt-2 text-xs text-gray-400 text-center",children:"This product uses the TMDB API but is not endorsed or certified by TMDB."})]})]})]}),d.jsxs("div",{className:"md:col-span-2",children:[d.jsx("h1",{className:"font-christmas text-3xl md:text-4xl text-xmas-line mb-2",children:o.title}),o.releaseDate&&d.jsx("p",{className:"text-lg text-gray-400 mb-4",children:new Date(o.releaseDate).getFullYear()}),o.genres&&o.genres.length>0&&d.jsx("div",{className:"flex flex-wrap gap-2 mb-4",children:o.genres.map((ee,H)=>d.jsx("span",{className:"badge badge-outline",children:ee},H))}),o.runtime&&d.jsxs("p",{className:"mb-4",children:[d.jsx("i",{className:"fas fa-clock mr-2 text-xmas-gold"}),Math.floor(o.runtime/60),"h ",o.runtime%60,"m"]}),o.overview&&d.jsxs("div",{className:"mb-6",children:[d.jsx("h2",{className:"text-xl font-bold mb-2",children:"Overview"}),d.jsx("p",{className:"text-gray-300",children:o.overview})]}),o.directors&&o.directors.length>0&&d.jsxs("div",{className:"mb-4",children:[d.jsxs("h2",{className:"text-xl font-bold mb-2",children:["Director",o.directors.length>1?"s":""]}),d.jsx("p",{children:o.directors.join(", ")})]}),o.cast&&o.cast.length>0&&d.jsxs("div",{className:"mb-6",children:[d.jsx("h2",{className:"text-xl font-bold mb-2",children:"Cast"}),d.jsx("p",{className:"flex flex-wrap gap-1",children:o.cast.slice(0,10).map((ee,H)=>d.jsxs(Hp.Fragment,{children:[d.jsx(et,{to:`/movies?q=${encodeURIComponent(ee)}&field=cast`,className:"link link-primary",children:ee}),H<Math.min(o.cast.length,10)-1&&d.jsx("span",{children:","})]},ee))})]}),d.jsx("div",{className:"divider"}),d.jsx("h2",{className:"text-2xl font-christmas text-xmas-gold mb-4",children:"Your Rating & Review"}),k&&d.jsxs("div",{className:"form-control mb-4",children:[d.jsx("label",{className:"label",children:d.jsx("span",{className:"label-text",children:"Date Watched"})}),d.jsx("input",{type:"date",className:"input input-bordered",value:E,onChange:ee=>N(ee.target.value)})]}),d.jsxs("div",{className:"form-control mb-4",children:[d.jsx("label",{className:"label",children:d.jsx("span",{className:"label-text",children:"Your Rating"})}),d.jsx("div",{className:"rating rating-lg",children:[1,2,3,4,5,6,7,8,9,10].map(ee=>d.jsx("input",{type:"radio",name:"rating",className:`mask mask-star-2 ${ee<=5?"bg-orange-400":"bg-yellow-400"}`,checked:O===ee,onChange:()=>M(ee)},ee))}),O&&d.jsx("div",{className:"mt-2",children:d.jsx("button",{className:"btn btn-xs btn-ghost",onClick:()=>M(null),children:"Clear Rating"})})]}),d.jsx(KL,{rating:O,initialTags:P,initialAutoReview:g,onChange:({tags:ee,autoReview:H})=>{b(ee),y(H)}}),d.jsxs("div",{className:"form-control mb-6 mt-4",children:[d.jsx("label",{className:"label",children:d.jsx("span",{className:"label-text",children:"Your Review"})}),d.jsx("textarea",{className:"textarea textarea-bordered h-32",placeholder:"Write your thoughts about this movie...",value:g,onChange:ee=>y(ee.target.value)})]}),d.jsx("div",{className:"flex justify-end",children:d.jsx("button",{className:"btn btn-primary btn-sm sm:btn-md",onClick:C,disabled:v,children:v?d.jsxs(d.Fragment,{children:[d.jsx("span",{className:"loading loading-spinner loading-sm mr-2"}),"Saving..."]}):d.jsxs(d.Fragment,{children:[d.jsx("i",{className:"fas fa-save mr-2"}),"Save Changes"]})})})]})]})]}):d.jsxs("div",{className:"container mx-auto px-4 py-8",children:[d.jsxs("div",{className:"alert alert-error",children:[d.jsx("i",{className:"fas fa-exclamation-circle mr-2"}),d.jsx("span",{children:"Movie not found"})]}),d.jsx("div",{className:"mt-4",children:d.jsxs(et,{to:i,className:"btn btn-primary btn-sm sm:btn-md",children:[d.jsx("i",{className:"fas fa-arrow-left mr-2"})," Back to Movies"]})})]})};function Hy(t,e){let r=0;const n=(t.title||"").toLowerCase(),s=(e.title||"").toLowerCase();if(n&&s)if(n===s)r+=60;else if(s.includes(n)||n.includes(s))r+=40;else{const a=n.split(" "),i=s.split(" "),o=a.filter(l=>i.includes(l));r+=o.length/Math.max(a.length,i.length)*40}if(t.releaseDate&&e.release_date){const a=t.releaseDate.slice(0,4),i=e.release_date.slice(0,4);a===i?r+=40:Math.abs(parseInt(a)-parseInt(i))<=1&&(r+=20)}return Math.min(Math.round(r),100)}const ws=t=>t!=null&&t.poster_path?`https://image.tmdb.org/t/p/w500${t.poster_path}`:(t==null?void 0:t.posterUrl)||"",XL=({onSelect:t,userMovieIds:e})=>{const r=di(),[n,s]=W.useState([]),[a,i]=W.useState(!0),[o,l]=W.useState(null),[c,u]=W.useState(""),[h,m]=W.useState("all"),[p,x]=W.useState("title-asc"),[v,w]=W.useState(!1);W.useEffect(()=>{(async()=>{try{i(!0),l(null);const M=(await kn(mn(_t,"movies"))).docs.map(g=>{var S;const y=g.data();return y.tmdbId?{id:y.tmdbId,title:y.title,release_date:y.releaseDate,poster_path:(S=y.posterUrl)!=null&&S.startsWith("https://image.tmdb.org/t/p/")?y.posterUrl.replace("https://image.tmdb.org/t/p/w500",""):null,source:"local",firestoreId:g.id,cast:y.cast||[],runtime:y.runtime,genres:y.genres||[],overview:y.overview}:null}).filter(Boolean);s(M)}catch(O){console.error("Error loading local catalogue:",O),l((O==null?void 0:O.message)??"Failed to load local catalogue")}finally{i(!1)}})()},[]);const k=W.useCallback(N=>{if(!c.trim())return!0;const O=c.toLowerCase().trim(),M=O.split(",").map(y=>y.trim()).filter(Boolean),g=y=>N.cast&&N.cast.some(S=>S.toLowerCase().includes(y));switch(h){case"title":return N.title.toLowerCase().includes(O);case"year":return N.release_date&&N.release_date.substring(0,4).includes(O);case"cast":return M.length?M.some(y=>g(y)):g(O);case"all":default:return N.title.toLowerCase().includes(O)||N.release_date&&N.release_date.substring(0,4).includes(O)||N.cast&&N.cast.some(y=>y.toLowerCase().includes(O))}},[c,h]),T=W.useMemo(()=>n.filter(N=>{if(!k(N))return!1;const O=!!N.firestoreId&&e.includes(N.firestoreId);return!(v&&O)}),[n,k,e,v]),E=W.useMemo(()=>{const N=[...T],O=M=>{if(!M.release_date)return 0;const g=parseInt(M.release_date.slice(0,4),10);return Number.isNaN(g)?0:g};return N.sort((M,g)=>{switch(p){case"title-asc":return M.title.localeCompare(g.title);case"title-desc":return g.title.localeCompare(M.title);case"year-desc":{const y=O(M);return O(g)-y||M.title.localeCompare(g.title)}case"year-asc":{const y=O(M),S=O(g);return y-S||M.title.localeCompare(g.title)}default:return 0}}),N},[T,p]);return d.jsxs("div",{className:"space-y-4",children:[d.jsxs("div",{className:"flex flex-col lg:flex-row gap-2",children:[d.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 flex-1",children:[d.jsxs("div",{className:"relative flex-grow",children:[d.jsx("div",{className:"absolute inset-y-0 left-0 pl-2 flex items-center pointer-events-none",children:d.jsx("i",{className:"fas fa-search text-gray-400"})}),d.jsx("input",{type:"text",className:"input input-bordered input-sm sm:input-md w-full pl-8 pr-8",placeholder:"   Search catalogue by title, cast, year...",value:c,onChange:N=>u(N.target.value)}),c&&d.jsx("button",{className:"absolute inset-y-0 right-0 pr-2 flex items-center",onClick:()=>u(""),children:d.jsx("i",{className:"fas fa-times text-gray-400 hover:text-gray-600"})})]}),d.jsxs("select",{className:"select select-bordered select-sm sm:select-md w-full sm:w-40",value:h,onChange:N=>m(N.target.value),children:[d.jsx("option",{value:"all",children:"All Fields"}),d.jsx("option",{value:"title",children:"Title Only"}),d.jsx("option",{value:"year",children:"Year Only"}),d.jsx("option",{value:"cast",children:"Cast Only"})]})]}),d.jsx("div",{className:"flex items-center justify-end",children:d.jsxs("select",{className:"select select-bordered select-sm sm:select-md w-full sm:w-52",value:p,onChange:N=>x(N.target.value),children:[d.jsx("option",{value:"title-asc",children:"Sort: Title (A  Z)"}),d.jsx("option",{value:"title-desc",children:"Sort: Title (Z  A)"}),d.jsx("option",{value:"year-desc",children:"Sort: Year (Newest  Oldest)"}),d.jsx("option",{value:"year-asc",children:"Sort: Year (Oldest  Newest)"})]})})]}),d.jsxs("div",{className:"flex flex-col xs:flex-row justify-between items-start xs:items-center text-xs sm:text-sm gap-2",children:[d.jsx("div",{children:a?d.jsx("span",{children:"Loading catalogue"}):d.jsxs(d.Fragment,{children:[d.jsx("span",{className:"font-medium",children:E.length})," ",E.length===1?"movie":"movies"," in catalogue",c&&d.jsxs("span",{className:"ml-1 opacity-70",children:["for: ",d.jsxs("span",{className:"font-medium",children:['"',c,'"']})]})]})}),d.jsxs("label",{className:"flex items-center gap-1 cursor-pointer select-none",children:[d.jsx("input",{type:"checkbox",className:"checkbox checkbox-xs sm:checkbox-sm",checked:v,onChange:N=>w(N.target.checked)}),d.jsx("span",{children:"Hide owned movies"})]})]}),o&&d.jsx("div",{className:"alert alert-error",children:o}),a&&d.jsx("div",{className:"flex justify-center p-6",children:d.jsx("span",{className:"loading loading-spinner loading-lg"})}),!a&&E.length===0&&!o&&d.jsxs("div",{className:"bg-xmas-card bg-opacity-60 rounded-lg p-6 text-center",children:[d.jsx("h3",{className:"text-lg font-semibold mb-2",children:"No movies found"}),d.jsx("p",{className:"text-sm opacity-80 mb-2",children:"Try changing your search text, field, or sort order."})]}),!a&&E.length>0&&d.jsx("div",{className:"grid grid-cols-3 sm:grid-cols-4 md:grid-cols-5 lg:grid-cols-6 gap-2 sm:gap-3",children:E.map(N=>{var M;const O=!!N.firestoreId&&e.includes(N.firestoreId);return d.jsx("div",{className:`block transition-transform hover:scale-[1.02] hover:shadow-xl ${O?"opacity-60 cursor-pointer":"cursor-pointer"}`,onClick:()=>{O&&N.firestoreId?r(zv(N.title,N.firestoreId),{state:{from:"import"}}):t(N)},children:d.jsxs("div",{className:"relative rounded-lg overflow-hidden bg-xmas-card shadow-md h-full flex flex-col",children:[d.jsxs("div",{className:"relative",children:[ws(N)?d.jsx("img",{src:ws(N),alt:N.title,className:"w-full h-auto object-cover",style:{aspectRatio:"2/3"},loading:"lazy"}):d.jsx("div",{className:"w-full flex items-center justify-center bg-gray-800",style:{aspectRatio:"2/3"},children:d.jsx("i",{className:"fas fa-film text-2xl text-gray-500"})}),O&&d.jsxs("div",{className:`\r
                          absolute top-1 left-1 \r
                          badge badge-success \r
                          px-2 py-0.5 \r
                          text-[0.6rem] leading-none \r
                          whitespace-nowrap \r
                          flex items-center gap-1 \r
                          shadow\r
                        `,children:[d.jsx("i",{className:"fas fa-check text-[0.6rem]"}),d.jsx("span",{children:"Owned"})]})]}),d.jsxs("div",{className:"p-1 sm:p-2 flex-grow flex flex-col",children:[d.jsx("h3",{className:"text-xs sm:text-sm font-medium line-clamp-2",children:N.title}),d.jsx("p",{className:"text-xs text-gray-400 mt-1",children:(M=N.release_date)==null?void 0:M.slice(0,4)})]})]})},N.firestoreId||N.id)})})]})},qS=t=>{const e=t.trim();return/^The\s+/i.test(e)?e.replace(/^The\s+/i,"").trim():/^A\s+/i.test(e)?e.replace(/^A\s+/i,"").trim():/^An\s+/i.test(e)?e.replace(/^An\s+/i,"").trim():e},XS="https://api.themoviedb.org/3",YL="https://image.tmdb.org/t/p/w500",QL="https://image.tmdb.org/t/p/original",YS=t=>(t||"").toLowerCase().replace(/^(the|a|an)\s+/,"").replace(/[^a-z0-9]+/g," ").trim(),JL=t=>{var n;const e=new Set,r=s=>{const a=YS(s||"");a&&(e.add(a),a.split(" ").forEach(i=>i&&e.add(i)))};return r(t.title),r(t.original_title),t.release_date&&e.add(t.release_date.slice(0,4)),(t.genres||[]).forEach(s=>r(s==null?void 0:s.name)),(((n=t.credits)==null?void 0:n.cast)||[]).slice(0,5).forEach(s=>r(s==null?void 0:s.name)),Array.from(e).slice(0,200)},Cp=async(t,e)=>{const r=await fetch(`${XS}/search/movie?api_key=${e}&query=${encodeURIComponent(t)}&include_adult=false`);if(!r.ok)throw new Error(`TMDB API error: ${r.status}`);return await r.json()},Yh=async(t,e)=>{const r=await fetch(`${XS}/movie/${t}?api_key=${e}&append_to_response=credits`);if(!r.ok)throw new Error(`TMDB API error: ${r.status}`);return await r.json()},Wv=t=>{var n,s,a,i,o,l;const e=qS(t.title),r=YS(e);return{tmdbId:t.id,title:t.title,sortTitle:e,sortTitleLower:r,originalTitle:t.original_title,releaseDate:t.release_date,posterUrl:t.poster_path?`${YL}${t.poster_path}`:void 0,backdropUrl:t.backdrop_path?`${QL}${t.backdrop_path}`:void 0,overview:t.overview,runtime:t.runtime,genres:((n=t.genres)==null?void 0:n.map(c=>c.name))||[],directors:((i=(a=(s=t.credits)==null?void 0:s.crew)==null?void 0:a.filter(c=>c.job==="Director"))==null?void 0:i.map(c=>c.name))||[],cast:((l=(o=t.credits)==null?void 0:o.cast)==null?void 0:l.slice(0,10).map(c=>c.name))||[],isChristmas:!0,keywords:JL(t),updatedAt:new Date}},ZL=({tmdbApiKey:t,onSelect:e})=>{const[r,n]=W.useState(""),[s,a]=W.useState(!1),[i,o]=W.useState([]),[l,c]=W.useState(null),u=async()=>{if(r.trim())try{a(!0),c(null);const h=await Cp(r,t);o(h.results)}catch(h){c((h==null?void 0:h.message)??"TMDB search failed")}finally{a(!1)}};return d.jsxs("div",{className:"space-y-3",children:[d.jsxs("div",{className:"flex gap-2",children:[d.jsx("input",{className:"input input-bordered flex-1",value:r,onChange:h=>n(h.target.value),placeholder:"Search TMDB...",onKeyDown:h=>h.key==="Enter"&&u()}),d.jsx("button",{className:"btn btn-primary",onClick:u,disabled:s||!t,children:s?d.jsx("span",{className:"loading loading-spinner loading-sm"}):"Search"})]}),l&&d.jsx("div",{className:"alert alert-error",children:l}),i.length>0&&d.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-3",children:i.map(h=>{var m;return d.jsxs("div",{className:"card bg-base-100 shadow cursor-pointer hover:shadow-lg transition-shadow",onClick:()=>e(h),children:[d.jsx("figure",{children:ws(h)?d.jsx("img",{src:ws(h),alt:h.title,className:"w-full h-64 object-contain"}):d.jsx("div",{className:"h-64 w-full flex items-center justify-center bg-base-200",children:d.jsx("i",{className:"fas fa-film text-3xl opacity-50"})})}),d.jsxs("div",{className:"card-body p-3",children:[d.jsx("div",{className:"font-semibold",children:h.title}),d.jsx("div",{className:"text-xs opacity-70",children:(m=h.release_date)==null?void 0:m.slice(0,4)})]})]},h.id)})})]})};/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var QS=1252,e6=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],Hv={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},Gv=function(t){e6.indexOf(t)!=-1&&(QS=Hv[0]=t)};function t6(){Gv(1252)}var ns=function(t){Gv(t)};function JS(){ns(1200),t6()}function Gy(t){for(var e=[],r=0,n=t.length;r<n;++r)e[r]=t.charCodeAt(r);return e}function r6(t){for(var e=[],r=0;r<t.length>>1;++r)e[r]=String.fromCharCode(t.charCodeAt(2*r)+(t.charCodeAt(2*r+1)<<8));return e.join("")}function ZS(t){for(var e=[],r=0;r<t.length>>1;++r)e[r]=String.fromCharCode(t.charCodeAt(2*r+1)+(t.charCodeAt(2*r)<<8));return e.join("")}var rc=function(t){var e=t.charCodeAt(0),r=t.charCodeAt(1);return e==255&&r==254?r6(t.slice(2)):e==254&&r==255?ZS(t.slice(2)):e==65279?t.slice(1):t},Sf=function(e){return String.fromCharCode(e)},Ky=function(e){return String.fromCharCode(e)},au,Ua="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function qy(t){for(var e="",r=0,n=0,s=0,a=0,i=0,o=0,l=0,c=0;c<t.length;)r=t.charCodeAt(c++),a=r>>2,n=t.charCodeAt(c++),i=(r&3)<<4|n>>4,s=t.charCodeAt(c++),o=(n&15)<<2|s>>6,l=s&63,isNaN(n)?o=l=64:isNaN(s)&&(l=64),e+=Ua.charAt(a)+Ua.charAt(i)+Ua.charAt(o)+Ua.charAt(l);return e}function An(t){var e="",r=0,n=0,s=0,a=0,i=0,o=0,l=0;t=t.replace(/[^\w\+\/\=]/g,"");for(var c=0;c<t.length;)a=Ua.indexOf(t.charAt(c++)),i=Ua.indexOf(t.charAt(c++)),r=a<<2|i>>4,e+=String.fromCharCode(r),o=Ua.indexOf(t.charAt(c++)),n=(i&15)<<4|o>>2,o!==64&&(e+=String.fromCharCode(n)),l=Ua.indexOf(t.charAt(c++)),s=(o&3)<<6|l,l!==64&&(e+=String.fromCharCode(s));return e}var Qe=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),no=function(){if(typeof Buffer<"u"){var t=!Buffer.from;if(!t)try{Buffer.from("foo","utf8")}catch{t=!0}return t?function(e,r){return r?new Buffer(e,r):new Buffer(e)}:Buffer.from.bind(Buffer)}return function(){}}();function oi(t){return Qe?Buffer.alloc?Buffer.alloc(t):new Buffer(t):typeof Uint8Array<"u"?new Uint8Array(t):new Array(t)}function Xy(t){return Qe?Buffer.allocUnsafe?Buffer.allocUnsafe(t):new Buffer(t):typeof Uint8Array<"u"?new Uint8Array(t):new Array(t)}var ts=function(e){return Qe?no(e,"binary"):e.split("").map(function(r){return r.charCodeAt(0)&255})};function so(t){if(Array.isArray(t))return t.map(function(n){return String.fromCharCode(n)}).join("");for(var e=[],r=0;r<t.length;++r)e[r]=String.fromCharCode(t[r]);return e.join("")}function Kv(t){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(t instanceof ArrayBuffer)return Kv(new Uint8Array(t));for(var e=new Array(t.length),r=0;r<t.length;++r)e[r]=t[r];return e}var Oa=Qe?function(t){return Buffer.concat(t.map(function(e){return Buffer.isBuffer(e)?e:no(e)}))}:function(t){if(typeof Uint8Array<"u"){var e=0,r=0;for(e=0;e<t.length;++e)r+=t[e].length;var n=new Uint8Array(r),s=0;for(e=0,r=0;e<t.length;r+=s,++e)if(s=t[e].length,t[e]instanceof Uint8Array)n.set(t[e],r);else{if(typeof t[e]=="string")throw"wtf";n.set(new Uint8Array(t[e]),r)}return n}return[].concat.apply([],t.map(function(a){return Array.isArray(a)?a:[].slice.call(a)}))};function n6(t){for(var e=[],r=0,n=t.length+250,s=oi(t.length+255),a=0;a<t.length;++a){var i=t.charCodeAt(a);if(i<128)s[r++]=i;else if(i<2048)s[r++]=192|i>>6&31,s[r++]=128|i&63;else if(i>=55296&&i<57344){i=(i&1023)+64;var o=t.charCodeAt(++a)&1023;s[r++]=240|i>>8&7,s[r++]=128|i>>2&63,s[r++]=128|o>>6&15|(i&3)<<4,s[r++]=128|o&63}else s[r++]=224|i>>12&15,s[r++]=128|i>>6&63,s[r++]=128|i&63;r>n&&(e.push(s.slice(0,r)),r=0,s=oi(65535),n=65530)}return e.push(s.slice(0,r)),Oa(e)}var Qr=/\u0000/g,nc=/[\u0001-\u0006]/g;function Go(t){for(var e="",r=t.length-1;r>=0;)e+=t.charAt(r--);return e}function ss(t,e){var r=""+t;return r.length>=e?r:Ut("0",e-r.length)+r}function qv(t,e){var r=""+t;return r.length>=e?r:Ut(" ",e-r.length)+r}function Qh(t,e){var r=""+t;return r.length>=e?r:r+Ut(" ",e-r.length)}function s6(t,e){var r=""+Math.round(t);return r.length>=e?r:Ut("0",e-r.length)+r}function a6(t,e){var r=""+t;return r.length>=e?r:Ut("0",e-r.length)+r}var Yy=Math.pow(2,32);function xo(t,e){if(t>Yy||t<-Yy)return s6(t,e);var r=Math.round(t);return a6(r,e)}function Jh(t,e){return e=e||0,t.length>=7+e&&(t.charCodeAt(e)|32)===103&&(t.charCodeAt(e+1)|32)===101&&(t.charCodeAt(e+2)|32)===110&&(t.charCodeAt(e+3)|32)===101&&(t.charCodeAt(e+4)|32)===114&&(t.charCodeAt(e+5)|32)===97&&(t.charCodeAt(e+6)|32)===108}var Qy=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],q0=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function i6(t){return t||(t={}),t[0]="General",t[1]="0",t[2]="0.00",t[3]="#,##0",t[4]="#,##0.00",t[9]="0%",t[10]="0.00%",t[11]="0.00E+00",t[12]="# ?/?",t[13]="# ??/??",t[14]="m/d/yy",t[15]="d-mmm-yy",t[16]="d-mmm",t[17]="mmm-yy",t[18]="h:mm AM/PM",t[19]="h:mm:ss AM/PM",t[20]="h:mm",t[21]="h:mm:ss",t[22]="m/d/yy h:mm",t[37]="#,##0 ;(#,##0)",t[38]="#,##0 ;[Red](#,##0)",t[39]="#,##0.00;(#,##0.00)",t[40]="#,##0.00;[Red](#,##0.00)",t[45]="mm:ss",t[46]="[h]:mm:ss",t[47]="mmss.0",t[48]="##0.0E+0",t[49]="@",t[56]='"/ "hh""mm""ss" "',t}var ze={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},Jy={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},o6={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function Zh(t,e,r){for(var n=t<0?-1:1,s=t*n,a=0,i=1,o=0,l=1,c=0,u=0,h=Math.floor(s);c<e&&(h=Math.floor(s),o=h*i+a,u=h*c+l,!(s-h<5e-8));)s=1/(s-h),a=i,i=o,l=c,c=u;if(u>e&&(c>e?(u=l,o=a):(u=c,o=i)),!r)return[0,n*o,u];var m=Math.floor(n*o/u);return[m,n*o-m*u,u]}function Pi(t,e,r){if(t>2958465||t<0)return null;var n=t|0,s=Math.floor(86400*(t-n)),a=0,i=[],o={D:n,T:s,u:86400*(t-n)-s,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(o.u)<1e-6&&(o.u=0),e&&e.date1904&&(n+=1462),o.u>.9999&&(o.u=0,++s==86400&&(o.T=s=0,++n,++o.D)),n===60)i=r?[1317,10,29]:[1900,2,29],a=3;else if(n===0)i=r?[1317,8,29]:[1900,1,0],a=6;else{n>60&&--n;var l=new Date(1900,0,1);l.setDate(l.getDate()+n-1),i=[l.getFullYear(),l.getMonth()+1,l.getDate()],a=l.getDay(),n<60&&(a=(a+6)%7),r&&(a=d6(l,i))}return o.y=i[0],o.m=i[1],o.d=i[2],o.S=s%60,s=Math.floor(s/60),o.M=s%60,s=Math.floor(s/60),o.H=s,o.q=a,o}var eA=new Date(1899,11,31,0,0,0),l6=eA.getTime(),c6=new Date(1900,2,1,0,0,0);function tA(t,e){var r=t.getTime();return e?r-=1461*24*60*60*1e3:t>=c6&&(r+=24*60*60*1e3),(r-(l6+(t.getTimezoneOffset()-eA.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function Xv(t){return t.indexOf(".")==-1?t:t.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function u6(t){return t.indexOf("E")==-1?t:t.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function f6(t){var e=t<0?12:11,r=Xv(t.toFixed(12));return r.length<=e||(r=t.toPrecision(10),r.length<=e)?r:t.toExponential(5)}function h6(t){var e=Xv(t.toFixed(11));return e.length>(t<0?12:11)||e==="0"||e==="-0"?t.toPrecision(6):e}function iu(t){var e=Math.floor(Math.log(Math.abs(t))*Math.LOG10E),r;return e>=-4&&e<=-1?r=t.toPrecision(10+e):Math.abs(e)<=9?r=f6(t):e===10?r=t.toFixed(10).substr(0,12):r=h6(t),Xv(u6(r.toUpperCase()))}function qi(t,e){switch(typeof t){case"string":return t;case"boolean":return t?"TRUE":"FALSE";case"number":return(t|0)===t?t.toString(10):iu(t);case"undefined":return"";case"object":if(t==null)return"";if(t instanceof Date)return $n(14,tA(t,e&&e.date1904),e)}throw new Error("unsupported value in General format: "+t)}function d6(t,e){e[0]-=581;var r=t.getDay();return t<60&&(r=(r+6)%7),r}function m6(t,e,r,n){var s="",a=0,i=0,o=r.y,l,c=0;switch(t){case 98:o=r.y+543;case 121:switch(e.length){case 1:case 2:l=o%100,c=2;break;default:l=o%1e4,c=4;break}break;case 109:switch(e.length){case 1:case 2:l=r.m,c=e.length;break;case 3:return q0[r.m-1][1];case 5:return q0[r.m-1][0];default:return q0[r.m-1][2]}break;case 100:switch(e.length){case 1:case 2:l=r.d,c=e.length;break;case 3:return Qy[r.q][0];default:return Qy[r.q][1]}break;case 104:switch(e.length){case 1:case 2:l=1+(r.H+11)%12,c=e.length;break;default:throw"bad hour format: "+e}break;case 72:switch(e.length){case 1:case 2:l=r.H,c=e.length;break;default:throw"bad hour format: "+e}break;case 77:switch(e.length){case 1:case 2:l=r.M,c=e.length;break;default:throw"bad minute format: "+e}break;case 115:if(e!="s"&&e!="ss"&&e!=".0"&&e!=".00"&&e!=".000")throw"bad second format: "+e;return r.u===0&&(e=="s"||e=="ss")?ss(r.S,e.length):(n>=2?i=n===3?1e3:100:i=n===1?10:1,a=Math.round(i*(r.S+r.u)),a>=60*i&&(a=0),e==="s"?a===0?"0":""+a/i:(s=ss(a,2+n),e==="ss"?s.substr(0,2):"."+s.substr(2,e.length-1)));case 90:switch(e){case"[h]":case"[hh]":l=r.D*24+r.H;break;case"[m]":case"[mm]":l=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":l=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+e}c=e.length===3?1:2;break;case 101:l=o,c=1;break}var u=c>0?ss(l,c):"";return u}function Ba(t){var e=3;if(t.length<=e)return t;for(var r=t.length%e,n=t.substr(0,r);r!=t.length;r+=e)n+=(n.length>0?",":"")+t.substr(r,e);return n}var rA=/%/g;function p6(t,e,r){var n=e.replace(rA,""),s=e.length-n.length;return na(t,n,r*Math.pow(10,2*s))+Ut("%",s)}function g6(t,e,r){for(var n=e.length-1;e.charCodeAt(n-1)===44;)--n;return na(t,e.substr(0,n),r/Math.pow(10,3*(e.length-n)))}function nA(t,e){var r,n=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+nA(t,-e);var s=t.indexOf(".");s===-1&&(s=t.indexOf("E"));var a=Math.floor(Math.log(e)*Math.LOG10E)%s;if(a<0&&(a+=s),r=(e/Math.pow(10,a)).toPrecision(n+1+(s+a)%s),r.indexOf("e")===-1){var i=Math.floor(Math.log(e)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(i-r.length+a):r+="E+"+(i-a);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,s)+"."+r.substr(2+s),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,l,c,u){return l+c+u.substr(0,(s+a)%s)+"."+u.substr(a)+"E"})}else r=e.toExponential(n);return t.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),t.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var sA=/# (\?+)( ?)\/( ?)(\d+)/;function v6(t,e,r){var n=parseInt(t[4],10),s=Math.round(e*n),a=Math.floor(s/n),i=s-a*n,o=n;return r+(a===0?"":""+a)+" "+(i===0?Ut(" ",t[1].length+1+t[4].length):qv(i,t[1].length)+t[2]+"/"+t[3]+ss(o,t[4].length))}function x6(t,e,r){return r+(e===0?"":""+e)+Ut(" ",t[1].length+2+t[4].length)}var aA=/^#*0*\.([0#]+)/,iA=/\).*[0#]/,oA=/\(###\) ###\\?-####/;function Gr(t){for(var e="",r,n=0;n!=t.length;++n)switch(r=t.charCodeAt(n)){case 35:break;case 63:e+=" ";break;case 48:e+="0";break;default:e+=String.fromCharCode(r)}return e}function Zy(t,e){var r=Math.pow(10,e);return""+Math.round(t*r)/r}function ew(t,e){var r=t-Math.floor(t),n=Math.pow(10,e);return e<(""+Math.round(r*n)).length?0:Math.round(r*n)}function _6(t,e){return e<(""+Math.round((t-Math.floor(t))*Math.pow(10,e))).length?1:0}function y6(t){return t<2147483647&&t>-2147483648?""+(t>=0?t|0:t-1|0):""+Math.floor(t)}function Dn(t,e,r){if(t.charCodeAt(0)===40&&!e.match(iA)){var n=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Dn("n",n,r):"("+Dn("n",n,-r)+")"}if(e.charCodeAt(e.length-1)===44)return g6(t,e,r);if(e.indexOf("%")!==-1)return p6(t,e,r);if(e.indexOf("E")!==-1)return nA(e,r);if(e.charCodeAt(0)===36)return"$"+Dn(t,e.substr(e.charAt(1)==" "?2:1),r);var s,a,i,o,l=Math.abs(r),c=r<0?"-":"";if(e.match(/^00+$/))return c+xo(l,e.length);if(e.match(/^[#?]+$/))return s=xo(r,0),s==="0"&&(s=""),s.length>e.length?s:Gr(e.substr(0,e.length-s.length))+s;if(a=e.match(sA))return v6(a,l,c);if(e.match(/^#+0+$/))return c+xo(l,e.length-e.indexOf("0"));if(a=e.match(aA))return s=Zy(r,a[1].length).replace(/^([^\.]+)$/,"$1."+Gr(a[1])).replace(/\.$/,"."+Gr(a[1])).replace(/\.(\d*)$/,function(x,v){return"."+v+Ut("0",Gr(a[1]).length-v.length)}),e.indexOf("0.")!==-1?s:s.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),a=e.match(/^(0*)\.(#*)$/))return c+Zy(l,a[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,a[1].length?"0.":".");if(a=e.match(/^#{1,3},##0(\.?)$/))return c+Ba(xo(l,0));if(a=e.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Dn(t,e,-r):Ba(""+(Math.floor(r)+_6(r,a[1].length)))+"."+ss(ew(r,a[1].length),a[1].length);if(a=e.match(/^#,#*,#0/))return Dn(t,e.replace(/^#,#*,/,""),r);if(a=e.match(/^([0#]+)(\\?-([0#]+))+$/))return s=Go(Dn(t,e.replace(/[\\-]/g,""),r)),i=0,Go(Go(e.replace(/\\/g,"")).replace(/[0#]/g,function(x){return i<s.length?s.charAt(i++):x==="0"?"0":""}));if(e.match(oA))return s=Dn(t,"##########",r),"("+s.substr(0,3)+") "+s.substr(3,3)+"-"+s.substr(6);var u="";if(a=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(a[4].length,7),o=Zh(l,Math.pow(10,i)-1,!1),s=""+c,u=na("n",a[1],o[1]),u.charAt(u.length-1)==" "&&(u=u.substr(0,u.length-1)+"0"),s+=u+a[2]+"/"+a[3],u=Qh(o[2],i),u.length<a[4].length&&(u=Gr(a[4].substr(a[4].length-u.length))+u),s+=u,s;if(a=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(Math.max(a[1].length,a[4].length),7),o=Zh(l,Math.pow(10,i)-1,!0),c+(o[0]||(o[1]?"":"0"))+" "+(o[1]?qv(o[1],i)+a[2]+"/"+a[3]+Qh(o[2],i):Ut(" ",2*i+1+a[2].length+a[3].length));if(a=e.match(/^[#0?]+$/))return s=xo(r,0),e.length<=s.length?s:Gr(e.substr(0,e.length-s.length))+s;if(a=e.match(/^([#0?]+)\.([#0]+)$/)){s=""+r.toFixed(Math.min(a[2].length,10)).replace(/([^0])0+$/,"$1"),i=s.indexOf(".");var h=e.indexOf(".")-i,m=e.length-s.length-h;return Gr(e.substr(0,h)+s+e.substr(e.length-m))}if(a=e.match(/^00,000\.([#0]*0)$/))return i=ew(r,a[1].length),r<0?"-"+Dn(t,e,-r):Ba(y6(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(x){return"00,"+(x.length<3?ss(0,3-x.length):"")+x})+"."+ss(i,a[1].length);switch(e){case"###,##0.00":return Dn(t,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var p=Ba(xo(l,0));return p!=="0"?c+p:"";case"###,###.00":return Dn(t,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return Dn(t,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+e+"|")}function w6(t,e,r){for(var n=e.length-1;e.charCodeAt(n-1)===44;)--n;return na(t,e.substr(0,n),r/Math.pow(10,3*(e.length-n)))}function E6(t,e,r){var n=e.replace(rA,""),s=e.length-n.length;return na(t,n,r*Math.pow(10,2*s))+Ut("%",s)}function lA(t,e){var r,n=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+lA(t,-e);var s=t.indexOf(".");s===-1&&(s=t.indexOf("E"));var a=Math.floor(Math.log(e)*Math.LOG10E)%s;if(a<0&&(a+=s),r=(e/Math.pow(10,a)).toPrecision(n+1+(s+a)%s),!r.match(/[Ee]/)){var i=Math.floor(Math.log(e)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(i-r.length+a):r+="E+"+(i-a),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,l,c,u){return l+c+u.substr(0,(s+a)%s)+"."+u.substr(a)+"E"})}else r=e.toExponential(n);return t.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),t.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function vs(t,e,r){if(t.charCodeAt(0)===40&&!e.match(iA)){var n=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?vs("n",n,r):"("+vs("n",n,-r)+")"}if(e.charCodeAt(e.length-1)===44)return w6(t,e,r);if(e.indexOf("%")!==-1)return E6(t,e,r);if(e.indexOf("E")!==-1)return lA(e,r);if(e.charCodeAt(0)===36)return"$"+vs(t,e.substr(e.charAt(1)==" "?2:1),r);var s,a,i,o,l=Math.abs(r),c=r<0?"-":"";if(e.match(/^00+$/))return c+ss(l,e.length);if(e.match(/^[#?]+$/))return s=""+r,r===0&&(s=""),s.length>e.length?s:Gr(e.substr(0,e.length-s.length))+s;if(a=e.match(sA))return x6(a,l,c);if(e.match(/^#+0+$/))return c+ss(l,e.length-e.indexOf("0"));if(a=e.match(aA))return s=(""+r).replace(/^([^\.]+)$/,"$1."+Gr(a[1])).replace(/\.$/,"."+Gr(a[1])),s=s.replace(/\.(\d*)$/,function(x,v){return"."+v+Ut("0",Gr(a[1]).length-v.length)}),e.indexOf("0.")!==-1?s:s.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),a=e.match(/^(0*)\.(#*)$/))return c+(""+l).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,a[1].length?"0.":".");if(a=e.match(/^#{1,3},##0(\.?)$/))return c+Ba(""+l);if(a=e.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+vs(t,e,-r):Ba(""+r)+"."+Ut("0",a[1].length);if(a=e.match(/^#,#*,#0/))return vs(t,e.replace(/^#,#*,/,""),r);if(a=e.match(/^([0#]+)(\\?-([0#]+))+$/))return s=Go(vs(t,e.replace(/[\\-]/g,""),r)),i=0,Go(Go(e.replace(/\\/g,"")).replace(/[0#]/g,function(x){return i<s.length?s.charAt(i++):x==="0"?"0":""}));if(e.match(oA))return s=vs(t,"##########",r),"("+s.substr(0,3)+") "+s.substr(3,3)+"-"+s.substr(6);var u="";if(a=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(a[4].length,7),o=Zh(l,Math.pow(10,i)-1,!1),s=""+c,u=na("n",a[1],o[1]),u.charAt(u.length-1)==" "&&(u=u.substr(0,u.length-1)+"0"),s+=u+a[2]+"/"+a[3],u=Qh(o[2],i),u.length<a[4].length&&(u=Gr(a[4].substr(a[4].length-u.length))+u),s+=u,s;if(a=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(Math.max(a[1].length,a[4].length),7),o=Zh(l,Math.pow(10,i)-1,!0),c+(o[0]||(o[1]?"":"0"))+" "+(o[1]?qv(o[1],i)+a[2]+"/"+a[3]+Qh(o[2],i):Ut(" ",2*i+1+a[2].length+a[3].length));if(a=e.match(/^[#0?]+$/))return s=""+r,e.length<=s.length?s:Gr(e.substr(0,e.length-s.length))+s;if(a=e.match(/^([#0]+)\.([#0]+)$/)){s=""+r.toFixed(Math.min(a[2].length,10)).replace(/([^0])0+$/,"$1"),i=s.indexOf(".");var h=e.indexOf(".")-i,m=e.length-s.length-h;return Gr(e.substr(0,h)+s+e.substr(e.length-m))}if(a=e.match(/^00,000\.([#0]*0)$/))return r<0?"-"+vs(t,e,-r):Ba(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(x){return"00,"+(x.length<3?ss(0,3-x.length):"")+x})+"."+ss(0,a[1].length);switch(e){case"###,###":case"##,###":case"#,###":var p=Ba(""+l);return p!=="0"?c+p:"";default:if(e.match(/\.[0#?]*$/))return vs(t,e.slice(0,e.lastIndexOf(".")),r)+Gr(e.slice(e.lastIndexOf(".")))}throw new Error("unsupported format |"+e+"|")}function na(t,e,r){return(r|0)===r?vs(t,e,r):Dn(t,e,r)}function T6(t){for(var e=[],r=!1,n=0,s=0;n<t.length;++n)switch(t.charCodeAt(n)){case 34:r=!r;break;case 95:case 42:case 92:++n;break;case 59:e[e.length]=t.substr(s,n-s),s=n+1}if(e[e.length]=t.substr(s),r===!0)throw new Error("Format |"+t+"| unterminated string ");return e}var cA=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function Tl(t){for(var e=0,r="",n="";e<t.length;)switch(r=t.charAt(e)){case"G":Jh(t,e)&&(e+=6),e++;break;case'"':for(;t.charCodeAt(++e)!==34&&e<t.length;);++e;break;case"\\":e+=2;break;case"_":e+=2;break;case"@":++e;break;case"B":case"b":if(t.charAt(e+1)==="1"||t.charAt(e+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(t.substr(e,3).toUpperCase()==="A/P"||t.substr(e,5).toUpperCase()==="AM/PM"||t.substr(e,5).toUpperCase()==="/")return!0;++e;break;case"[":for(n=r;t.charAt(e++)!=="]"&&e<t.length;)n+=t.charAt(e);if(n.match(cA))return!0;break;case".":case"0":case"#":for(;e<t.length&&("0#?.,E+-%".indexOf(r=t.charAt(++e))>-1||r=="\\"&&t.charAt(e+1)=="-"&&"0#".indexOf(t.charAt(e+2))>-1););break;case"?":for(;t.charAt(++e)===r;);break;case"*":++e,(t.charAt(e)==" "||t.charAt(e)=="*")&&++e;break;case"(":case")":++e;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;e<t.length&&"0123456789".indexOf(t.charAt(++e))>-1;);break;case" ":++e;break;default:++e;break}return!1}function k6(t,e,r,n){for(var s=[],a="",i=0,o="",l="t",c,u,h,m="H";i<t.length;)switch(o=t.charAt(i)){case"G":if(!Jh(t,i))throw new Error("unrecognized character "+o+" in "+t);s[s.length]={t:"G",v:"General"},i+=7;break;case'"':for(a="";(h=t.charCodeAt(++i))!==34&&i<t.length;)a+=String.fromCharCode(h);s[s.length]={t:"t",v:a},++i;break;case"\\":var p=t.charAt(++i),x=p==="("||p===")"?p:"t";s[s.length]={t:x,v:p},++i;break;case"_":s[s.length]={t:"t",v:" "},i+=2;break;case"@":s[s.length]={t:"T",v:e},++i;break;case"B":case"b":if(t.charAt(i+1)==="1"||t.charAt(i+1)==="2"){if(c==null&&(c=Pi(e,r,t.charAt(i+1)==="2"),c==null))return"";s[s.length]={t:"X",v:t.substr(i,2)},l=o,i+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":o=o.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(e<0||c==null&&(c=Pi(e,r),c==null))return"";for(a=o;++i<t.length&&t.charAt(i).toLowerCase()===o;)a+=o;o==="m"&&l.toLowerCase()==="h"&&(o="M"),o==="h"&&(o=m),s[s.length]={t:o,v:a},l=o;break;case"A":case"a":case"":var v={t:o,v:o};if(c==null&&(c=Pi(e,r)),t.substr(i,3).toUpperCase()==="A/P"?(c!=null&&(v.v=c.H>=12?"P":"A"),v.t="T",m="h",i+=3):t.substr(i,5).toUpperCase()==="AM/PM"?(c!=null&&(v.v=c.H>=12?"PM":"AM"),v.t="T",i+=5,m="h"):t.substr(i,5).toUpperCase()==="/"?(c!=null&&(v.v=c.H>=12?"":""),v.t="T",i+=5,m="h"):(v.t="t",++i),c==null&&v.t==="T")return"";s[s.length]=v,l=o;break;case"[":for(a=o;t.charAt(i++)!=="]"&&i<t.length;)a+=t.charAt(i);if(a.slice(-1)!=="]")throw'unterminated "[" block: |'+a+"|";if(a.match(cA)){if(c==null&&(c=Pi(e,r),c==null))return"";s[s.length]={t:"Z",v:a.toLowerCase()},l=a.charAt(1)}else a.indexOf("$")>-1&&(a=(a.match(/\$([^-\[\]]*)/)||[])[1]||"$",Tl(t)||(s[s.length]={t:"t",v:a}));break;case".":if(c!=null){for(a=o;++i<t.length&&(o=t.charAt(i))==="0";)a+=o;s[s.length]={t:"s",v:a};break}case"0":case"#":for(a=o;++i<t.length&&"0#?.,E+-%".indexOf(o=t.charAt(i))>-1;)a+=o;s[s.length]={t:"n",v:a};break;case"?":for(a=o;t.charAt(++i)===o;)a+=o;s[s.length]={t:o,v:a},l=o;break;case"*":++i,(t.charAt(i)==" "||t.charAt(i)=="*")&&++i;break;case"(":case")":s[s.length]={t:n===1?"t":o,v:o},++i;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(a=o;i<t.length&&"0123456789".indexOf(t.charAt(++i))>-1;)a+=t.charAt(i);s[s.length]={t:"D",v:a};break;case" ":s[s.length]={t:o,v:o},++i;break;case"$":s[s.length]={t:"t",v:"$"},++i;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(o)===-1)throw new Error("unrecognized character "+o+" in "+t);s[s.length]={t:"t",v:o},++i;break}var w=0,k=0,T;for(i=s.length-1,l="t";i>=0;--i)switch(s[i].t){case"h":case"H":s[i].t=m,l="h",w<1&&(w=1);break;case"s":(T=s[i].v.match(/\.0+$/))&&(k=Math.max(k,T[0].length-1)),w<3&&(w=3);case"d":case"y":case"M":case"e":l=s[i].t;break;case"m":l==="s"&&(s[i].t="M",w<2&&(w=2));break;case"X":break;case"Z":w<1&&s[i].v.match(/[Hh]/)&&(w=1),w<2&&s[i].v.match(/[Mm]/)&&(w=2),w<3&&s[i].v.match(/[Ss]/)&&(w=3)}switch(w){case 0:break;case 1:c.u>=.5&&(c.u=0,++c.S),c.S>=60&&(c.S=0,++c.M),c.M>=60&&(c.M=0,++c.H);break;case 2:c.u>=.5&&(c.u=0,++c.S),c.S>=60&&(c.S=0,++c.M);break}var E="",N;for(i=0;i<s.length;++i)switch(s[i].t){case"t":case"T":case" ":case"D":break;case"X":s[i].v="",s[i].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":s[i].v=m6(s[i].t.charCodeAt(0),s[i].v,c,k),s[i].t="t";break;case"n":case"?":for(N=i+1;s[N]!=null&&((o=s[N].t)==="?"||o==="D"||(o===" "||o==="t")&&s[N+1]!=null&&(s[N+1].t==="?"||s[N+1].t==="t"&&s[N+1].v==="/")||s[i].t==="("&&(o===" "||o==="n"||o===")")||o==="t"&&(s[N].v==="/"||s[N].v===" "&&s[N+1]!=null&&s[N+1].t=="?"));)s[i].v+=s[N].v,s[N]={v:"",t:";"},++N;E+=s[i].v,i=N-1;break;case"G":s[i].t="t",s[i].v=qi(e,r);break}var O="",M,g;if(E.length>0){E.charCodeAt(0)==40?(M=e<0&&E.charCodeAt(0)===45?-e:e,g=na("n",E,M)):(M=e<0&&n>1?-e:e,g=na("n",E,M),M<0&&s[0]&&s[0].t=="t"&&(g=g.substr(1),s[0].v="-"+s[0].v)),N=g.length-1;var y=s.length;for(i=0;i<s.length;++i)if(s[i]!=null&&s[i].t!="t"&&s[i].v.indexOf(".")>-1){y=i;break}var S=s.length;if(y===s.length&&g.indexOf("E")===-1){for(i=s.length-1;i>=0;--i)s[i]==null||"n?".indexOf(s[i].t)===-1||(N>=s[i].v.length-1?(N-=s[i].v.length,s[i].v=g.substr(N+1,s[i].v.length)):N<0?s[i].v="":(s[i].v=g.substr(0,N+1),N=-1),s[i].t="t",S=i);N>=0&&S<s.length&&(s[S].v=g.substr(0,N+1)+s[S].v)}else if(y!==s.length&&g.indexOf("E")===-1){for(N=g.indexOf(".")-1,i=y;i>=0;--i)if(!(s[i]==null||"n?".indexOf(s[i].t)===-1)){for(u=s[i].v.indexOf(".")>-1&&i===y?s[i].v.indexOf(".")-1:s[i].v.length-1,O=s[i].v.substr(u+1);u>=0;--u)N>=0&&(s[i].v.charAt(u)==="0"||s[i].v.charAt(u)==="#")&&(O=g.charAt(N--)+O);s[i].v=O,s[i].t="t",S=i}for(N>=0&&S<s.length&&(s[S].v=g.substr(0,N+1)+s[S].v),N=g.indexOf(".")+1,i=y;i<s.length;++i)if(!(s[i]==null||"n?(".indexOf(s[i].t)===-1&&i!==y)){for(u=s[i].v.indexOf(".")>-1&&i===y?s[i].v.indexOf(".")+1:0,O=s[i].v.substr(0,u);u<s[i].v.length;++u)N<g.length&&(O+=g.charAt(N++));s[i].v=O,s[i].t="t",S=i}}}for(i=0;i<s.length;++i)s[i]!=null&&"n?".indexOf(s[i].t)>-1&&(M=n>1&&e<0&&i>0&&s[i-1].v==="-"?-e:e,s[i].v=na(s[i].t,s[i].v,M),s[i].t="t");var R="";for(i=0;i!==s.length;++i)s[i]!=null&&(R+=s[i].v);return R}var tw=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function rw(t,e){if(e==null)return!1;var r=parseFloat(e[2]);switch(e[1]){case"=":if(t==r)return!0;break;case">":if(t>r)return!0;break;case"<":if(t<r)return!0;break;case"<>":if(t!=r)return!0;break;case">=":if(t>=r)return!0;break;case"<=":if(t<=r)return!0;break}return!1}function S6(t,e){var r=T6(t),n=r.length,s=r[n-1].indexOf("@");if(n<4&&s>-1&&--n,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof e!="number")return[4,r.length===4||s>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=s>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=s>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=s>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var a=e>0?r[0]:e<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[n,a];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var i=r[0].match(tw),o=r[1].match(tw);return rw(e,i)?[n,r[0]]:rw(e,o)?[n,r[1]]:[n,r[i!=null&&o!=null?2:1]]}return[n,a]}function $n(t,e,r){r==null&&(r={});var n="";switch(typeof t){case"string":t=="m/d/yy"&&r.dateNF?n=r.dateNF:n=t;break;case"number":t==14&&r.dateNF?n=r.dateNF:n=(r.table!=null?r.table:ze)[t],n==null&&(n=r.table&&r.table[Jy[t]]||ze[Jy[t]]),n==null&&(n=o6[t]||"General");break}if(Jh(n,0))return qi(e,r);e instanceof Date&&(e=tA(e,r.date1904));var s=S6(n,e);if(Jh(s[1]))return qi(e,r);if(e===!0)e="TRUE";else if(e===!1)e="FALSE";else if(e===""||e==null)return"";return k6(s[1],e,r,s[0])}function Mi(t,e){if(typeof e!="number"){e=+e||-1;for(var r=0;r<392;++r){if(ze[r]==null){e<0&&(e=r);continue}if(ze[r]==t){e=r;break}}e<0&&(e=391)}return ze[e]=t,e}function uA(){ze=i6()}var A6={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},fA=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function I6(t){var e=typeof t=="number"?ze[t]:t;return e=e.replace(fA,"(\\d+)"),new RegExp("^"+e+"$")}function C6(t,e,r){var n=-1,s=-1,a=-1,i=-1,o=-1,l=-1;(e.match(fA)||[]).forEach(function(h,m){var p=parseInt(r[m+1],10);switch(h.toLowerCase().charAt(0)){case"y":n=p;break;case"d":a=p;break;case"h":i=p;break;case"s":l=p;break;case"m":i>=0?o=p:s=p;break}}),l>=0&&o==-1&&s>=0&&(o=s,s=-1);var c=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(s>=1?s:1)).slice(-2)+"-"+("00"+(a>=1?a:1)).slice(-2);c.length==7&&(c="0"+c),c.length==8&&(c="20"+c);var u=("00"+(i>=0?i:0)).slice(-2)+":"+("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(l>=0?l:0)).slice(-2);return i==-1&&o==-1&&l==-1?c:n==-1&&s==-1&&a==-1?u:c+"T"+u}var R6=function(){var t={};t.version="1.2.0";function e(){for(var g=0,y=new Array(256),S=0;S!=256;++S)g=S,g=g&1?-306674912^g>>>1:g>>>1,g=g&1?-306674912^g>>>1:g>>>1,g=g&1?-306674912^g>>>1:g>>>1,g=g&1?-306674912^g>>>1:g>>>1,g=g&1?-306674912^g>>>1:g>>>1,g=g&1?-306674912^g>>>1:g>>>1,g=g&1?-306674912^g>>>1:g>>>1,g=g&1?-306674912^g>>>1:g>>>1,y[S]=g;return typeof Int32Array<"u"?new Int32Array(y):y}var r=e();function n(g){var y=0,S=0,R=0,P=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(R=0;R!=256;++R)P[R]=g[R];for(R=0;R!=256;++R)for(S=g[R],y=256+R;y<4096;y+=256)S=P[y]=S>>>8^g[S&255];var b=[];for(R=1;R!=16;++R)b[R-1]=typeof Int32Array<"u"?P.subarray(R*256,R*256+256):P.slice(R*256,R*256+256);return b}var s=n(r),a=s[0],i=s[1],o=s[2],l=s[3],c=s[4],u=s[5],h=s[6],m=s[7],p=s[8],x=s[9],v=s[10],w=s[11],k=s[12],T=s[13],E=s[14];function N(g,y){for(var S=y^-1,R=0,P=g.length;R<P;)S=S>>>8^r[(S^g.charCodeAt(R++))&255];return~S}function O(g,y){for(var S=y^-1,R=g.length-15,P=0;P<R;)S=E[g[P++]^S&255]^T[g[P++]^S>>8&255]^k[g[P++]^S>>16&255]^w[g[P++]^S>>>24]^v[g[P++]]^x[g[P++]]^p[g[P++]]^m[g[P++]]^h[g[P++]]^u[g[P++]]^c[g[P++]]^l[g[P++]]^o[g[P++]]^i[g[P++]]^a[g[P++]]^r[g[P++]];for(R+=15;P<R;)S=S>>>8^r[(S^g[P++])&255];return~S}function M(g,y){for(var S=y^-1,R=0,P=g.length,b=0,C=0;R<P;)b=g.charCodeAt(R++),b<128?S=S>>>8^r[(S^b)&255]:b<2048?(S=S>>>8^r[(S^(192|b>>6&31))&255],S=S>>>8^r[(S^(128|b&63))&255]):b>=55296&&b<57344?(b=(b&1023)+64,C=g.charCodeAt(R++)&1023,S=S>>>8^r[(S^(240|b>>8&7))&255],S=S>>>8^r[(S^(128|b>>2&63))&255],S=S>>>8^r[(S^(128|C>>6&15|(b&3)<<4))&255],S=S>>>8^r[(S^(128|C&63))&255]):(S=S>>>8^r[(S^(224|b>>12&15))&255],S=S>>>8^r[(S^(128|b>>6&63))&255],S=S>>>8^r[(S^(128|b&63))&255]);return~S}return t.table=r,t.bstr=N,t.buf=O,t.str=M,t}(),tt=function(){var e={};e.version="1.2.1";function r(I,V){for(var D=I.split("/"),F=V.split("/"),L=0,j=0,Y=Math.min(D.length,F.length);L<Y;++L){if(j=D[L].length-F[L].length)return j;if(D[L]!=F[L])return D[L]<F[L]?-1:1}return D.length-F.length}function n(I){if(I.charAt(I.length-1)=="/")return I.slice(0,-1).indexOf("/")===-1?I:n(I.slice(0,-1));var V=I.lastIndexOf("/");return V===-1?I:I.slice(0,V+1)}function s(I){if(I.charAt(I.length-1)=="/")return s(I.slice(0,-1));var V=I.lastIndexOf("/");return V===-1?I:I.slice(V+1)}function a(I,V){typeof V=="string"&&(V=new Date(V));var D=V.getHours();D=D<<6|V.getMinutes(),D=D<<5|V.getSeconds()>>>1,I.write_shift(2,D);var F=V.getFullYear()-1980;F=F<<4|V.getMonth()+1,F=F<<5|V.getDate(),I.write_shift(2,F)}function i(I){var V=I.read_shift(2)&65535,D=I.read_shift(2)&65535,F=new Date,L=D&31;D>>>=5;var j=D&15;D>>>=4,F.setMilliseconds(0),F.setFullYear(D+1980),F.setMonth(j-1),F.setDate(L);var Y=V&31;V>>>=5;var re=V&63;return V>>>=6,F.setHours(V),F.setMinutes(re),F.setSeconds(Y<<1),F}function o(I){xr(I,0);for(var V={},D=0;I.l<=I.length-4;){var F=I.read_shift(2),L=I.read_shift(2),j=I.l+L,Y={};switch(F){case 21589:D=I.read_shift(1),D&1&&(Y.mtime=I.read_shift(4)),L>5&&(D&2&&(Y.atime=I.read_shift(4)),D&4&&(Y.ctime=I.read_shift(4))),Y.mtime&&(Y.mt=new Date(Y.mtime*1e3));break}I.l=j,V[F]=Y}return V}var l;function c(){return l||(l={})}function u(I,V){if(I[0]==80&&I[1]==75)return wa(I,V);if((I[0]|32)==109&&(I[1]|32)==105)return fo(I,V);if(I.length<512)throw new Error("CFB file size "+I.length+" < 512");var D=3,F=512,L=0,j=0,Y=0,re=0,te=0,Z=[],Q=I.slice(0,512);xr(Q,0);var ce=h(Q);switch(D=ce[0],D){case 3:F=512;break;case 4:F=4096;break;case 0:if(ce[1]==0)return wa(I,V);default:throw new Error("Major Version: Expected 3 or 4 saw "+D)}F!==512&&(Q=I.slice(0,F),xr(Q,28));var we=I.slice(0,F);m(Q,D);var Ie=Q.read_shift(4,"i");if(D===3&&Ie!==0)throw new Error("# Directory Sectors: Expected 0 saw "+Ie);Q.l+=4,Y=Q.read_shift(4,"i"),Q.l+=4,Q.chk("00100000","Mini Stream Cutoff Size: "),re=Q.read_shift(4,"i"),L=Q.read_shift(4,"i"),te=Q.read_shift(4,"i"),j=Q.read_shift(4,"i");for(var ge=-1,Ee=0;Ee<109&&(ge=Q.read_shift(4,"i"),!(ge<0));++Ee)Z[Ee]=ge;var De=p(I,F);w(te,j,De,F,Z);var st=T(De,Y,Z,F);st[Y].name="!Directory",L>0&&re!==C&&(st[re].name="!MiniFAT"),st[Z[0]].name="!FAT",st.fat_addrs=Z,st.ssz=F;var Ke={},dt=[],nn=[],We=[];E(Y,st,De,dt,L,Ke,nn,re),x(nn,We,dt),dt.shift();var ft={FileIndex:nn,FullPaths:We};return V&&V.raw&&(ft.raw={header:we,sectors:De}),ft}function h(I){if(I[I.l]==80&&I[I.l+1]==75)return[0,0];I.chk(oe,"Header Signature: "),I.l+=16;var V=I.read_shift(2,"u");return[I.read_shift(2,"u"),V]}function m(I,V){var D=9;switch(I.l+=2,D=I.read_shift(2)){case 9:if(V!=3)throw new Error("Sector Shift: Expected 9 saw "+D);break;case 12:if(V!=4)throw new Error("Sector Shift: Expected 12 saw "+D);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+D)}I.chk("0600","Mini Sector Shift: "),I.chk("000000000000","Reserved: ")}function p(I,V){for(var D=Math.ceil(I.length/V)-1,F=[],L=1;L<D;++L)F[L-1]=I.slice(L*V,(L+1)*V);return F[D-1]=I.slice(D*V),F}function x(I,V,D){for(var F=0,L=0,j=0,Y=0,re=0,te=D.length,Z=[],Q=[];F<te;++F)Z[F]=Q[F]=F,V[F]=D[F];for(;re<Q.length;++re)F=Q[re],L=I[F].L,j=I[F].R,Y=I[F].C,Z[F]===F&&(L!==-1&&Z[L]!==L&&(Z[F]=Z[L]),j!==-1&&Z[j]!==j&&(Z[F]=Z[j])),Y!==-1&&(Z[Y]=F),L!==-1&&F!=Z[F]&&(Z[L]=Z[F],Q.lastIndexOf(L)<re&&Q.push(L)),j!==-1&&F!=Z[F]&&(Z[j]=Z[F],Q.lastIndexOf(j)<re&&Q.push(j));for(F=1;F<te;++F)Z[F]===F&&(j!==-1&&Z[j]!==j?Z[F]=Z[j]:L!==-1&&Z[L]!==L&&(Z[F]=Z[L]));for(F=1;F<te;++F)if(I[F].type!==0){if(re=F,re!=Z[re])do re=Z[re],V[F]=V[re]+"/"+V[F];while(re!==0&&Z[re]!==-1&&re!=Z[re]);Z[F]=-1}for(V[0]+="/",F=1;F<te;++F)I[F].type!==2&&(V[F]+="/")}function v(I,V,D){for(var F=I.start,L=I.size,j=[],Y=F;D&&L>0&&Y>=0;)j.push(V.slice(Y*b,Y*b+b)),L-=b,Y=ki(D,Y*4);return j.length===0?tr(0):Oa(j).slice(0,I.size)}function w(I,V,D,F,L){var j=C;if(I===C){if(V!==0)throw new Error("DIFAT chain shorter than expected")}else if(I!==-1){var Y=D[I],re=(F>>>2)-1;if(!Y)return;for(var te=0;te<re&&(j=ki(Y,te*4))!==C;++te)L.push(j);w(ki(Y,F-4),V-1,D,F,L)}}function k(I,V,D,F,L){var j=[],Y=[];L||(L=[]);var re=F-1,te=0,Z=0;for(te=V;te>=0;){L[te]=!0,j[j.length]=te,Y.push(I[te]);var Q=D[Math.floor(te*4/F)];if(Z=te*4&re,F<4+Z)throw new Error("FAT boundary crossed: "+te+" 4 "+F);if(!I[Q])break;te=ki(I[Q],Z)}return{nodes:j,data:hw([Y])}}function T(I,V,D,F){var L=I.length,j=[],Y=[],re=[],te=[],Z=F-1,Q=0,ce=0,we=0,Ie=0;for(Q=0;Q<L;++Q)if(re=[],we=Q+V,we>=L&&(we-=L),!Y[we]){te=[];var ge=[];for(ce=we;ce>=0;){ge[ce]=!0,Y[ce]=!0,re[re.length]=ce,te.push(I[ce]);var Ee=D[Math.floor(ce*4/F)];if(Ie=ce*4&Z,F<4+Ie)throw new Error("FAT boundary crossed: "+ce+" 4 "+F);if(!I[Ee]||(ce=ki(I[Ee],Ie),ge[ce]))break}j[we]={nodes:re,data:hw([te])}}return j}function E(I,V,D,F,L,j,Y,re){for(var te=0,Z=F.length?2:0,Q=V[I].data,ce=0,we=0,Ie;ce<Q.length;ce+=128){var ge=Q.slice(ce,ce+128);xr(ge,64),we=ge.read_shift(2),Ie=ex(ge,0,we-Z),F.push(Ie);var Ee={name:Ie,type:ge.read_shift(1),color:ge.read_shift(1),L:ge.read_shift(4,"i"),R:ge.read_shift(4,"i"),C:ge.read_shift(4,"i"),clsid:ge.read_shift(16),state:ge.read_shift(4,"i"),start:0,size:0},De=ge.read_shift(2)+ge.read_shift(2)+ge.read_shift(2)+ge.read_shift(2);De!==0&&(Ee.ct=N(ge,ge.l-8));var st=ge.read_shift(2)+ge.read_shift(2)+ge.read_shift(2)+ge.read_shift(2);st!==0&&(Ee.mt=N(ge,ge.l-8)),Ee.start=ge.read_shift(4,"i"),Ee.size=ge.read_shift(4,"i"),Ee.size<0&&Ee.start<0&&(Ee.size=Ee.type=0,Ee.start=C,Ee.name=""),Ee.type===5?(te=Ee.start,L>0&&te!==C&&(V[te].name="!StreamData")):Ee.size>=4096?(Ee.storage="fat",V[Ee.start]===void 0&&(V[Ee.start]=k(D,Ee.start,V.fat_addrs,V.ssz)),V[Ee.start].name=Ee.name,Ee.content=V[Ee.start].data.slice(0,Ee.size)):(Ee.storage="minifat",Ee.size<0?Ee.size=0:te!==C&&Ee.start!==C&&V[te]&&(Ee.content=v(Ee,V[te].data,(V[re]||{}).data))),Ee.content&&xr(Ee.content,0),j[Ie]=Ee,Y.push(Ee)}}function N(I,V){return new Date((_n(I,V+4)/1e7*Math.pow(2,32)+_n(I,V)/1e7-11644473600)*1e3)}function O(I,V){return c(),u(l.readFileSync(I),V)}function M(I,V){var D=V&&V.type;switch(D||Qe&&Buffer.isBuffer(I)&&(D="buffer"),D||"base64"){case"file":return O(I,V);case"base64":return u(ts(An(I)),V);case"binary":return u(ts(I),V)}return u(I,V)}function g(I,V){var D=V||{},F=D.root||"Root Entry";if(I.FullPaths||(I.FullPaths=[]),I.FileIndex||(I.FileIndex=[]),I.FullPaths.length!==I.FileIndex.length)throw new Error("inconsistent CFB structure");I.FullPaths.length===0&&(I.FullPaths[0]=F+"/",I.FileIndex[0]={name:F,type:5}),D.CLSID&&(I.FileIndex[0].clsid=D.CLSID),y(I)}function y(I){var V="Sh33tJ5";if(!tt.find(I,"/"+V)){var D=tr(4);D[0]=55,D[1]=D[3]=50,D[2]=54,I.FileIndex.push({name:V,type:2,content:D,size:4,L:69,R:69,C:69}),I.FullPaths.push(I.FullPaths[0]+V),S(I)}}function S(I,V){g(I);for(var D=!1,F=!1,L=I.FullPaths.length-1;L>=0;--L){var j=I.FileIndex[L];switch(j.type){case 0:F?D=!0:(I.FileIndex.pop(),I.FullPaths.pop());break;case 1:case 2:case 5:F=!0,isNaN(j.R*j.L*j.C)&&(D=!0),j.R>-1&&j.L>-1&&j.R==j.L&&(D=!0);break;default:D=!0;break}}if(!(!D&&!V)){var Y=new Date(1987,1,19),re=0,te=Object.create?Object.create(null):{},Z=[];for(L=0;L<I.FullPaths.length;++L)te[I.FullPaths[L]]=!0,I.FileIndex[L].type!==0&&Z.push([I.FullPaths[L],I.FileIndex[L]]);for(L=0;L<Z.length;++L){var Q=n(Z[L][0]);F=te[Q],F||(Z.push([Q,{name:s(Q).replace("/",""),type:1,clsid:he,ct:Y,mt:Y,content:null}]),te[Q]=!0)}for(Z.sort(function(Ie,ge){return r(Ie[0],ge[0])}),I.FullPaths=[],I.FileIndex=[],L=0;L<Z.length;++L)I.FullPaths[L]=Z[L][0],I.FileIndex[L]=Z[L][1];for(L=0;L<Z.length;++L){var ce=I.FileIndex[L],we=I.FullPaths[L];if(ce.name=s(we).replace("/",""),ce.L=ce.R=ce.C=-(ce.color=1),ce.size=ce.content?ce.content.length:0,ce.start=0,ce.clsid=ce.clsid||he,L===0)ce.C=Z.length>1?1:-1,ce.size=0,ce.type=5;else if(we.slice(-1)=="/"){for(re=L+1;re<Z.length&&n(I.FullPaths[re])!=we;++re);for(ce.C=re>=Z.length?-1:re,re=L+1;re<Z.length&&n(I.FullPaths[re])!=n(we);++re);ce.R=re>=Z.length?-1:re,ce.type=1}else n(I.FullPaths[L+1]||"")==n(we)&&(ce.R=L+1),ce.type=2}}}function R(I,V){var D=V||{};if(D.fileType=="mad")return er(I,D);switch(S(I),D.fileType){case"zip":return Vs(I,D)}var F=function(Ie){for(var ge=0,Ee=0,De=0;De<Ie.FileIndex.length;++De){var st=Ie.FileIndex[De];if(st.content){var Ke=st.content.length;Ke>0&&(Ke<4096?ge+=Ke+63>>6:Ee+=Ke+511>>9)}}for(var dt=Ie.FullPaths.length+3>>2,nn=ge+7>>3,We=ge+127>>7,ft=nn+Ee+dt+We,mr=ft+127>>7,Pn=mr<=109?0:Math.ceil((mr-109)/127);ft+mr+Pn+127>>7>mr;)Pn=++mr<=109?0:Math.ceil((mr-109)/127);var Je=[1,Pn,mr,We,dt,Ee,ge,0];return Ie.FileIndex[0].size=ge<<6,Je[7]=(Ie.FileIndex[0].start=Je[0]+Je[1]+Je[2]+Je[3]+Je[4]+Je[5])+(Je[6]+7>>3),Je}(I),L=tr(F[7]<<9),j=0,Y=0;{for(j=0;j<8;++j)L.write_shift(1,ae[j]);for(j=0;j<8;++j)L.write_shift(2,0);for(L.write_shift(2,62),L.write_shift(2,3),L.write_shift(2,65534),L.write_shift(2,9),L.write_shift(2,6),j=0;j<3;++j)L.write_shift(2,0);for(L.write_shift(4,0),L.write_shift(4,F[2]),L.write_shift(4,F[0]+F[1]+F[2]+F[3]-1),L.write_shift(4,0),L.write_shift(4,4096),L.write_shift(4,F[3]?F[0]+F[1]+F[2]-1:C),L.write_shift(4,F[3]),L.write_shift(-4,F[1]?F[0]-1:C),L.write_shift(4,F[1]),j=0;j<109;++j)L.write_shift(-4,j<F[2]?F[1]+j:-1)}if(F[1])for(Y=0;Y<F[1];++Y){for(;j<236+Y*127;++j)L.write_shift(-4,j<F[2]?F[1]+j:-1);L.write_shift(-4,Y===F[1]-1?C:Y+1)}var re=function(Ie){for(Y+=Ie;j<Y-1;++j)L.write_shift(-4,j+1);Ie&&(++j,L.write_shift(-4,C))};for(Y=j=0,Y+=F[1];j<Y;++j)L.write_shift(-4,me.DIFSECT);for(Y+=F[2];j<Y;++j)L.write_shift(-4,me.FATSECT);re(F[3]),re(F[4]);for(var te=0,Z=0,Q=I.FileIndex[0];te<I.FileIndex.length;++te)Q=I.FileIndex[te],Q.content&&(Z=Q.content.length,!(Z<4096)&&(Q.start=Y,re(Z+511>>9)));for(re(F[6]+7>>3);L.l&511;)L.write_shift(-4,me.ENDOFCHAIN);for(Y=j=0,te=0;te<I.FileIndex.length;++te)Q=I.FileIndex[te],Q.content&&(Z=Q.content.length,!(!Z||Z>=4096)&&(Q.start=Y,re(Z+63>>6)));for(;L.l&511;)L.write_shift(-4,me.ENDOFCHAIN);for(j=0;j<F[4]<<2;++j){var ce=I.FullPaths[j];if(!ce||ce.length===0){for(te=0;te<17;++te)L.write_shift(4,0);for(te=0;te<3;++te)L.write_shift(4,-1);for(te=0;te<12;++te)L.write_shift(4,0);continue}Q=I.FileIndex[j],j===0&&(Q.start=Q.size?Q.start-1:C);var we=j===0&&D.root||Q.name;if(Z=2*(we.length+1),L.write_shift(64,we,"utf16le"),L.write_shift(2,Z),L.write_shift(1,Q.type),L.write_shift(1,Q.color),L.write_shift(-4,Q.L),L.write_shift(-4,Q.R),L.write_shift(-4,Q.C),Q.clsid)L.write_shift(16,Q.clsid,"hex");else for(te=0;te<4;++te)L.write_shift(4,0);L.write_shift(4,Q.state||0),L.write_shift(4,0),L.write_shift(4,0),L.write_shift(4,0),L.write_shift(4,0),L.write_shift(4,Q.start),L.write_shift(4,Q.size),L.write_shift(4,0)}for(j=1;j<I.FileIndex.length;++j)if(Q=I.FileIndex[j],Q.size>=4096)if(L.l=Q.start+1<<9,Qe&&Buffer.isBuffer(Q.content))Q.content.copy(L,L.l,0,Q.size),L.l+=Q.size+511&-512;else{for(te=0;te<Q.size;++te)L.write_shift(1,Q.content[te]);for(;te&511;++te)L.write_shift(1,0)}for(j=1;j<I.FileIndex.length;++j)if(Q=I.FileIndex[j],Q.size>0&&Q.size<4096)if(Qe&&Buffer.isBuffer(Q.content))Q.content.copy(L,L.l,0,Q.size),L.l+=Q.size+63&-64;else{for(te=0;te<Q.size;++te)L.write_shift(1,Q.content[te]);for(;te&63;++te)L.write_shift(1,0)}if(Qe)L.l=L.length;else for(;L.l<L.length;)L.write_shift(1,0);return L}function P(I,V){var D=I.FullPaths.map(function(te){return te.toUpperCase()}),F=D.map(function(te){var Z=te.split("/");return Z[Z.length-(te.slice(-1)=="/"?2:1)]}),L=!1;V.charCodeAt(0)===47?(L=!0,V=D[0].slice(0,-1)+V):L=V.indexOf("/")!==-1;var j=V.toUpperCase(),Y=L===!0?D.indexOf(j):F.indexOf(j);if(Y!==-1)return I.FileIndex[Y];var re=!j.match(nc);for(j=j.replace(Qr,""),re&&(j=j.replace(nc,"!")),Y=0;Y<D.length;++Y)if((re?D[Y].replace(nc,"!"):D[Y]).replace(Qr,"")==j||(re?F[Y].replace(nc,"!"):F[Y]).replace(Qr,"")==j)return I.FileIndex[Y];return null}var b=64,C=-2,oe="d0cf11e0a1b11ae1",ae=[208,207,17,224,161,177,26,225],he="00000000000000000000000000000000",me={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:C,FREESECT:-1,HEADER_SIGNATURE:oe,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:he,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function ee(I,V,D){c();var F=R(I,D);l.writeFileSync(V,F)}function H(I){for(var V=new Array(I.length),D=0;D<I.length;++D)V[D]=String.fromCharCode(I[D]);return V.join("")}function ue(I,V){var D=R(I,V);switch(V&&V.type||"buffer"){case"file":return c(),l.writeFileSync(V.filename,D),D;case"binary":return typeof D=="string"?D:H(D);case"base64":return qy(typeof D=="string"?D:H(D));case"buffer":if(Qe)return Buffer.isBuffer(D)?D:no(D);case"array":return typeof D=="string"?ts(D):D}return D}var de;function B(I){try{var V=I.InflateRaw,D=new V;if(D._processChunk(new Uint8Array([3,0]),D._finishFlushFlag),D.bytesRead)de=I;else throw new Error("zlib does not expose bytesRead")}catch(F){console.error("cannot use native zlib: "+(F.message||F))}}function K(I,V){if(!de)return js(I,V);var D=de.InflateRaw,F=new D,L=F._processChunk(I.slice(I.l),F._finishFlushFlag);return I.l+=F.bytesRead,L}function X(I){return de?de.deflateRawSync(I):je(I)}var q=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],le=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],_e=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function Ce(I){var V=(I<<1|I<<11)&139536|(I<<5|I<<15)&558144;return(V>>16|V>>8|V)&255}for(var Te=typeof Uint8Array<"u",xe=Te?new Uint8Array(256):[],$e=0;$e<256;++$e)xe[$e]=Ce($e);function z(I,V){var D=xe[I&255];return V<=8?D>>>8-V:(D=D<<8|xe[I>>8&255],V<=16?D>>>16-V:(D=D<<8|xe[I>>16&255],D>>>24-V))}function ot(I,V){var D=V&7,F=V>>>3;return(I[F]|(D<=6?0:I[F+1]<<8))>>>D&3}function He(I,V){var D=V&7,F=V>>>3;return(I[F]|(D<=5?0:I[F+1]<<8))>>>D&7}function nt(I,V){var D=V&7,F=V>>>3;return(I[F]|(D<=4?0:I[F+1]<<8))>>>D&15}function Fe(I,V){var D=V&7,F=V>>>3;return(I[F]|(D<=3?0:I[F+1]<<8))>>>D&31}function Ae(I,V){var D=V&7,F=V>>>3;return(I[F]|(D<=1?0:I[F+1]<<8))>>>D&127}function Tt(I,V,D){var F=V&7,L=V>>>3,j=(1<<D)-1,Y=I[L]>>>F;return D<8-F||(Y|=I[L+1]<<8-F,D<16-F)||(Y|=I[L+2]<<16-F,D<24-F)||(Y|=I[L+3]<<24-F),Y&j}function or(I,V,D){var F=V&7,L=V>>>3;return F<=5?I[L]|=(D&7)<<F:(I[L]|=D<<F&255,I[L+1]=(D&7)>>8-F),V+3}function Ar(I,V,D){var F=V&7,L=V>>>3;return D=(D&1)<<F,I[L]|=D,V+1}function tn(I,V,D){var F=V&7,L=V>>>3;return D<<=F,I[L]|=D&255,D>>>=8,I[L+1]=D,V+8}function Ms(I,V,D){var F=V&7,L=V>>>3;return D<<=F,I[L]|=D&255,D>>>=8,I[L+1]=D&255,I[L+2]=D>>>8,V+16}function rn(I,V){var D=I.length,F=2*D>V?2*D:V+5,L=0;if(D>=V)return I;if(Qe){var j=Xy(F);if(I.copy)I.copy(j);else for(;L<I.length;++L)j[L]=I[L];return j}else if(Te){var Y=new Uint8Array(F);if(Y.set)Y.set(I);else for(;L<D;++L)Y[L]=I[L];return Y}return I.length=F,I}function kt(I){for(var V=new Array(I),D=0;D<I;++D)V[D]=0;return V}function lr(I,V,D){var F=1,L=0,j=0,Y=0,re=0,te=I.length,Z=Te?new Uint16Array(32):kt(32);for(j=0;j<32;++j)Z[j]=0;for(j=te;j<D;++j)I[j]=0;te=I.length;var Q=Te?new Uint16Array(te):kt(te);for(j=0;j<te;++j)Z[L=I[j]]++,F<L&&(F=L),Q[j]=0;for(Z[0]=0,j=1;j<=F;++j)Z[j+16]=re=re+Z[j-1]<<1;for(j=0;j<te;++j)re=I[j],re!=0&&(Q[j]=Z[re+16]++);var ce=0;for(j=0;j<te;++j)if(ce=I[j],ce!=0)for(re=z(Q[j],F)>>F-ce,Y=(1<<F+4-ce)-1;Y>=0;--Y)V[re|Y<<ce]=ce&15|j<<4;return F}var vt=Te?new Uint16Array(512):kt(512),St=Te?new Uint16Array(32):kt(32);if(!Te){for(var ht=0;ht<512;++ht)vt[ht]=0;for(ht=0;ht<32;++ht)St[ht]=0}(function(){for(var I=[],V=0;V<32;V++)I.push(5);lr(I,St,32);var D=[];for(V=0;V<=143;V++)D.push(8);for(;V<=255;V++)D.push(9);for(;V<=279;V++)D.push(7);for(;V<=287;V++)D.push(8);lr(D,vt,288)})();var Dt=function(){for(var V=Te?new Uint8Array(32768):[],D=0,F=0;D<_e.length-1;++D)for(;F<_e[D+1];++F)V[F]=D;for(;F<32768;++F)V[F]=29;var L=Te?new Uint8Array(259):[];for(D=0,F=0;D<le.length-1;++D)for(;F<le[D+1];++F)L[F]=D;function j(re,te){for(var Z=0;Z<re.length;){var Q=Math.min(65535,re.length-Z),ce=Z+Q==re.length;for(te.write_shift(1,+ce),te.write_shift(2,Q),te.write_shift(2,~Q&65535);Q-- >0;)te[te.l++]=re[Z++]}return te.l}function Y(re,te){for(var Z=0,Q=0,ce=Te?new Uint16Array(32768):[];Q<re.length;){var we=Math.min(65535,re.length-Q);if(we<10){for(Z=or(te,Z,+(Q+we==re.length)),Z&7&&(Z+=8-(Z&7)),te.l=Z/8|0,te.write_shift(2,we),te.write_shift(2,~we&65535);we-- >0;)te[te.l++]=re[Q++];Z=te.l*8;continue}Z=or(te,Z,+(Q+we==re.length)+2);for(var Ie=0;we-- >0;){var ge=re[Q];Ie=(Ie<<5^ge)&32767;var Ee=-1,De=0;if((Ee=ce[Ie])&&(Ee|=Q&-32768,Ee>Q&&(Ee-=32768),Ee<Q))for(;re[Ee+De]==re[Q+De]&&De<250;)++De;if(De>2){ge=L[De],ge<=22?Z=tn(te,Z,xe[ge+1]>>1)-1:(tn(te,Z,3),Z+=5,tn(te,Z,xe[ge-23]>>5),Z+=3);var st=ge<8?0:ge-4>>2;st>0&&(Ms(te,Z,De-le[ge]),Z+=st),ge=V[Q-Ee],Z=tn(te,Z,xe[ge]>>3),Z-=3;var Ke=ge<4?0:ge-2>>1;Ke>0&&(Ms(te,Z,Q-Ee-_e[ge]),Z+=Ke);for(var dt=0;dt<De;++dt)ce[Ie]=Q&32767,Ie=(Ie<<5^re[Q])&32767,++Q;we-=De-1}else ge<=143?ge=ge+48:Z=Ar(te,Z,1),Z=tn(te,Z,xe[ge]),ce[Ie]=Q&32767,++Q}Z=tn(te,Z,0)-1}return te.l=(Z+7)/8|0,te.l}return function(te,Z){return te.length<8?j(te,Z):Y(te,Z)}}();function je(I){var V=tr(50+Math.floor(I.length*1.1)),D=Dt(I,V);return V.slice(0,D)}var xt=Te?new Uint16Array(32768):kt(32768),Gt=Te?new Uint16Array(32768):kt(32768),ut=Te?new Uint16Array(128):kt(128),pn=1,Ls=1;function co(I,V){var D=Fe(I,V)+257;V+=5;var F=Fe(I,V)+1;V+=5;var L=nt(I,V)+4;V+=4;for(var j=0,Y=Te?new Uint8Array(19):kt(19),re=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],te=1,Z=Te?new Uint8Array(8):kt(8),Q=Te?new Uint8Array(8):kt(8),ce=Y.length,we=0;we<L;++we)Y[q[we]]=j=He(I,V),te<j&&(te=j),Z[j]++,V+=3;var Ie=0;for(Z[0]=0,we=1;we<=te;++we)Q[we]=Ie=Ie+Z[we-1]<<1;for(we=0;we<ce;++we)(Ie=Y[we])!=0&&(re[we]=Q[Ie]++);var ge=0;for(we=0;we<ce;++we)if(ge=Y[we],ge!=0){Ie=xe[re[we]]>>8-ge;for(var Ee=(1<<7-ge)-1;Ee>=0;--Ee)ut[Ie|Ee<<ge]=ge&7|we<<3}var De=[];for(te=1;De.length<D+F;)switch(Ie=ut[Ae(I,V)],V+=Ie&7,Ie>>>=3){case 16:for(j=3+ot(I,V),V+=2,Ie=De[De.length-1];j-- >0;)De.push(Ie);break;case 17:for(j=3+He(I,V),V+=3;j-- >0;)De.push(0);break;case 18:for(j=11+Ae(I,V),V+=7;j-- >0;)De.push(0);break;default:De.push(Ie),te<Ie&&(te=Ie);break}var st=De.slice(0,D),Ke=De.slice(D);for(we=D;we<286;++we)st[we]=0;for(we=F;we<30;++we)Ke[we]=0;return pn=lr(st,xt,286),Ls=lr(Ke,Gt,30),V}function Al(I,V){if(I[0]==3&&!(I[1]&3))return[oi(V),2];for(var D=0,F=0,L=Xy(V||1<<18),j=0,Y=L.length>>>0,re=0,te=0;!(F&1);){if(F=He(I,D),D+=3,F>>>1)F>>1==1?(re=9,te=5):(D=co(I,D),re=pn,te=Ls);else{D&7&&(D+=8-(D&7));var Z=I[D>>>3]|I[(D>>>3)+1]<<8;if(D+=32,Z>0)for(!V&&Y<j+Z&&(L=rn(L,j+Z),Y=L.length);Z-- >0;)L[j++]=I[D>>>3],D+=8;continue}for(;;){!V&&Y<j+32767&&(L=rn(L,j+32767),Y=L.length);var Q=Tt(I,D,re),ce=F>>>1==1?vt[Q]:xt[Q];if(D+=ce&15,ce>>>=4,!(ce>>>8&255))L[j++]=ce;else{if(ce==256)break;ce-=257;var we=ce<8?0:ce-4>>2;we>5&&(we=0);var Ie=j+le[ce];we>0&&(Ie+=Tt(I,D,we),D+=we),Q=Tt(I,D,te),ce=F>>>1==1?St[Q]:Gt[Q],D+=ce&15,ce>>>=4;var ge=ce<4?0:ce-2>>1,Ee=_e[ce];for(ge>0&&(Ee+=Tt(I,D,ge),D+=ge),!V&&Y<Ie&&(L=rn(L,Ie+100),Y=L.length);j<Ie;)L[j]=L[j-Ee],++j}}}return V?[L,D+7>>>3]:[L.slice(0,j),D+7>>>3]}function js(I,V){var D=I.slice(I.l||0),F=Al(D,V);return I.l+=F[1],F[0]}function hs(I,V){if(I)typeof console<"u"&&console.error(V);else throw new Error(V)}function wa(I,V){var D=I;xr(D,0);var F=[],L=[],j={FileIndex:F,FullPaths:L};g(j,{root:V.root});for(var Y=D.length-4;(D[Y]!=80||D[Y+1]!=75||D[Y+2]!=5||D[Y+3]!=6)&&Y>=0;)--Y;D.l=Y+4,D.l+=4;var re=D.read_shift(2);D.l+=6;var te=D.read_shift(4);for(D.l=te,Y=0;Y<re;++Y){D.l+=20;var Z=D.read_shift(4),Q=D.read_shift(4),ce=D.read_shift(2),we=D.read_shift(2),Ie=D.read_shift(2);D.l+=8;var ge=D.read_shift(4),Ee=o(D.slice(D.l+ce,D.l+ce+we));D.l+=ce+we+Ie;var De=D.l;D.l=ge+4,Hn(D,Z,Q,j,Ee),D.l=De}return j}function Hn(I,V,D,F,L){I.l+=2;var j=I.read_shift(2),Y=I.read_shift(2),re=i(I);if(j&8257)throw new Error("Unsupported ZIP encryption");for(var te=I.read_shift(4),Z=I.read_shift(4),Q=I.read_shift(4),ce=I.read_shift(2),we=I.read_shift(2),Ie="",ge=0;ge<ce;++ge)Ie+=String.fromCharCode(I[I.l++]);if(we){var Ee=o(I.slice(I.l,I.l+we));(Ee[21589]||{}).mt&&(re=Ee[21589].mt),((L||{})[21589]||{}).mt&&(re=L[21589].mt)}I.l+=we;var De=I.slice(I.l,I.l+Z);switch(Y){case 8:De=K(I,Q);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+Y)}var st=!1;j&8&&(te=I.read_shift(4),te==134695760&&(te=I.read_shift(4),st=!0),Z=I.read_shift(4),Q=I.read_shift(4)),Z!=V&&hs(st,"Bad compressed size: "+V+" != "+Z),Q!=D&&hs(st,"Bad uncompressed size: "+D+" != "+Q),J(F,Ie,De,{unsafe:!0,mt:re})}function Vs(I,V){var D=V||{},F=[],L=[],j=tr(1),Y=D.compression?8:0,re=0,te=0,Z=0,Q=0,ce=0,we=I.FullPaths[0],Ie=we,ge=I.FileIndex[0],Ee=[],De=0;for(te=1;te<I.FullPaths.length;++te)if(Ie=I.FullPaths[te].slice(we.length),ge=I.FileIndex[te],!(!ge.size||!ge.content||Ie=="Sh33tJ5")){var st=Q,Ke=tr(Ie.length);for(Z=0;Z<Ie.length;++Z)Ke.write_shift(1,Ie.charCodeAt(Z)&127);Ke=Ke.slice(0,Ke.l),Ee[ce]=R6.buf(ge.content,0);var dt=ge.content;Y==8&&(dt=X(dt)),j=tr(30),j.write_shift(4,67324752),j.write_shift(2,20),j.write_shift(2,re),j.write_shift(2,Y),ge.mt?a(j,ge.mt):j.write_shift(4,0),j.write_shift(-4,Ee[ce]),j.write_shift(4,dt.length),j.write_shift(4,ge.content.length),j.write_shift(2,Ke.length),j.write_shift(2,0),Q+=j.length,F.push(j),Q+=Ke.length,F.push(Ke),Q+=dt.length,F.push(dt),j=tr(46),j.write_shift(4,33639248),j.write_shift(2,0),j.write_shift(2,20),j.write_shift(2,re),j.write_shift(2,Y),j.write_shift(4,0),j.write_shift(-4,Ee[ce]),j.write_shift(4,dt.length),j.write_shift(4,ge.content.length),j.write_shift(2,Ke.length),j.write_shift(2,0),j.write_shift(2,0),j.write_shift(2,0),j.write_shift(2,0),j.write_shift(4,0),j.write_shift(4,st),De+=j.l,L.push(j),De+=Ke.length,L.push(Ke),++ce}return j=tr(22),j.write_shift(4,101010256),j.write_shift(2,0),j.write_shift(2,0),j.write_shift(2,ce),j.write_shift(2,ce),j.write_shift(4,De),j.write_shift(4,Q),j.write_shift(2,0),Oa([Oa(F),Oa(L),j])}var ds={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function Rn(I,V){if(I.ctype)return I.ctype;var D=I.name||"",F=D.match(/\.([^\.]+)$/);return F&&ds[F[1]]||V&&(F=(D=V).match(/[\.\\]([^\.\\])+$/),F&&ds[F[1]])?ds[F[1]]:"application/octet-stream"}function uo(I){for(var V=qy(I),D=[],F=0;F<V.length;F+=76)D.push(V.slice(F,F+76));return D.join(`\r
`)+`\r
`}function Us(I){var V=I.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(Z){var Q=Z.charCodeAt(0).toString(16).toUpperCase();return"="+(Q.length==1?"0"+Q:Q)});V=V.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),V.charAt(0)==`
`&&(V="=0D"+V.slice(1)),V=V.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var D=[],F=V.split(`\r
`),L=0;L<F.length;++L){var j=F[L];if(j.length==0){D.push("");continue}for(var Y=0;Y<j.length;){var re=76,te=j.slice(Y,Y+re);te.charAt(re-1)=="="?re--:te.charAt(re-2)=="="?re-=2:te.charAt(re-3)=="="&&(re-=3),te=j.slice(Y,Y+re),Y+=re,Y<j.length&&(te+="="),D.push(te)}}return D.join(`\r
`)}function Bs(I){for(var V=[],D=0;D<I.length;++D){for(var F=I[D];D<=I.length&&F.charAt(F.length-1)=="=";)F=F.slice(0,F.length-1)+I[++D];V.push(F)}for(var L=0;L<V.length;++L)V[L]=V[L].replace(/[=][0-9A-Fa-f]{2}/g,function(j){return String.fromCharCode(parseInt(j.slice(1),16))});return ts(V.join(`\r
`))}function Nn(I,V,D){for(var F="",L="",j="",Y,re=0;re<10;++re){var te=V[re];if(!te||te.match(/^\s*$/))break;var Z=te.match(/^(.*?):\s*([^\s].*)$/);if(Z)switch(Z[1].toLowerCase()){case"content-location":F=Z[2].trim();break;case"content-type":j=Z[2].trim();break;case"content-transfer-encoding":L=Z[2].trim();break}}switch(++re,L.toLowerCase()){case"base64":Y=ts(An(V.slice(re).join("")));break;case"quoted-printable":Y=Bs(V.slice(re));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+L)}var Q=J(I,F.slice(D.length),Y,{unsafe:!0});j&&(Q.ctype=j)}function fo(I,V){if(H(I.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var D=V&&V.root||"",F=(Qe&&Buffer.isBuffer(I)?I.toString("binary"):H(I)).split(`\r
`),L=0,j="";for(L=0;L<F.length;++L)if(j=F[L],!!/^Content-Location:/i.test(j)&&(j=j.slice(j.indexOf("file")),D||(D=j.slice(0,j.lastIndexOf("/")+1)),j.slice(0,D.length)!=D))for(;D.length>0&&(D=D.slice(0,D.length-1),D=D.slice(0,D.lastIndexOf("/")+1),j.slice(0,D.length)!=D););var Y=(F[1]||"").match(/boundary="(.*?)"/);if(!Y)throw new Error("MAD cannot find boundary");var re="--"+(Y[1]||""),te=[],Z=[],Q={FileIndex:te,FullPaths:Z};g(Q);var ce,we=0;for(L=0;L<F.length;++L){var Ie=F[L];Ie!==re&&Ie!==re+"--"||(we++&&Nn(Q,F.slice(ce,L),D),ce=L)}return Q}function er(I,V){var D=V||{},F=D.boundary||"SheetJS";F="------="+F;for(var L=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+F.slice(2)+'"',"","",""],j=I.FullPaths[0],Y=j,re=I.FileIndex[0],te=1;te<I.FullPaths.length;++te)if(Y=I.FullPaths[te].slice(j.length),re=I.FileIndex[te],!(!re.size||!re.content||Y=="Sh33tJ5")){Y=Y.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(De){return"_x"+De.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(De){return"_u"+De.charCodeAt(0).toString(16)+"_"});for(var Z=re.content,Q=Qe&&Buffer.isBuffer(Z)?Z.toString("binary"):H(Z),ce=0,we=Math.min(1024,Q.length),Ie=0,ge=0;ge<=we;++ge)(Ie=Q.charCodeAt(ge))>=32&&Ie<128&&++ce;var Ee=ce>=we*4/5;L.push(F),L.push("Content-Location: "+(D.root||"file:///C:/SheetJS/")+Y),L.push("Content-Transfer-Encoding: "+(Ee?"quoted-printable":"base64")),L.push("Content-Type: "+Rn(re,Y)),L.push(""),L.push(Ee?Us(Q):uo(Q))}return L.push(F+`--\r
`),L.join(`\r
`)}function G(I){var V={};return g(V,I),V}function J(I,V,D,F){var L=F&&F.unsafe;L||g(I);var j=!L&&tt.find(I,V);if(!j){var Y=I.FullPaths[0];V.slice(0,Y.length)==Y?Y=V:(Y.slice(-1)!="/"&&(Y+="/"),Y=(Y+V).replace("//","/")),j={name:s(V),type:2},I.FileIndex.push(j),I.FullPaths.push(Y),L||tt.utils.cfb_gc(I)}return j.content=D,j.size=D?D.length:0,F&&(F.CLSID&&(j.clsid=F.CLSID),F.mt&&(j.mt=F.mt),F.ct&&(j.ct=F.ct)),j}function se(I,V){g(I);var D=tt.find(I,V);if(D){for(var F=0;F<I.FileIndex.length;++F)if(I.FileIndex[F]==D)return I.FileIndex.splice(F,1),I.FullPaths.splice(F,1),!0}return!1}function pe(I,V,D){g(I);var F=tt.find(I,V);if(F){for(var L=0;L<I.FileIndex.length;++L)if(I.FileIndex[L]==F)return I.FileIndex[L].name=s(D),I.FullPaths[L]=D,!0}return!1}function Se(I){S(I,!0)}return e.find=P,e.read=M,e.parse=u,e.write=ue,e.writeFile=ee,e.utils={cfb_new:G,cfb_add:J,cfb_del:se,cfb_mov:pe,cfb_gc:Se,ReadShift:wc,CheckField:DA,prep_blob:xr,bconcat:Oa,use_zlib:B,_deflateRaw:je,_inflateRaw:js,consts:me},e}();function N6(t){if(typeof Deno<"u")return Deno.readFileSync(t);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var e=File(t);e.open("r"),e.encoding="binary";var r=e.read();return e.close(),r}catch(n){if(!n.message||!n.message.match(/onstruct/))throw n}throw new Error("Cannot access file "+t)}function Ns(t){for(var e=Object.keys(t),r=[],n=0;n<e.length;++n)Object.prototype.hasOwnProperty.call(t,e[n])&&r.push(e[n]);return r}function Yv(t){for(var e=[],r=Ns(t),n=0;n!==r.length;++n)e[t[r[n]]]=r[n];return e}var ed=new Date(1899,11,30,0,0,0);function Jr(t,e){var r=t.getTime(),n=ed.getTime()+(t.getTimezoneOffset()-ed.getTimezoneOffset())*6e4;return(r-n)/(24*60*60*1e3)}var hA=new Date,P6=ed.getTime()+(hA.getTimezoneOffset()-ed.getTimezoneOffset())*6e4,nw=hA.getTimezoneOffset();function Jd(t){var e=new Date;return e.setTime(t*24*60*60*1e3+P6),e.getTimezoneOffset()!==nw&&e.setTime(e.getTime()+(e.getTimezoneOffset()-nw)*6e4),e}function b6(t){var e=0,r=0,n=!1,s=t.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!s)throw new Error("|"+t+"| is not an ISO8601 Duration");for(var a=1;a!=s.length;++a)if(s[a]){switch(r=1,a>3&&(n=!0),s[a].slice(s[a].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+s[a].slice(s[a].length-1));case"D":r*=24;case"H":r*=60;case"M":if(n)r*=60;else throw new Error("Unsupported ISO Duration Field: M")}e+=r*parseInt(s[a],10)}return e}var sw=new Date("2017-02-19T19:06:09.000Z"),dA=isNaN(sw.getFullYear())?new Date("2/19/17"):sw,D6=dA.getFullYear()==2017;function dr(t,e){var r=new Date(t);if(D6)return e>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):e<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(t instanceof Date)return t;if(dA.getFullYear()==1917&&!isNaN(r.getFullYear())){var n=r.getFullYear();return t.indexOf(""+n)>-1||r.setFullYear(r.getFullYear()+100),r}var s=t.match(/\d+/g)||["2017","2","19","0","0","0"],a=new Date(+s[0],+s[1]-1,+s[2],+s[3]||0,+s[4]||0,+s[5]||0);return t.indexOf("Z")>-1&&(a=new Date(a.getTime()-a.getTimezoneOffset()*60*1e3)),a}function Xi(t,e){if(Qe&&Buffer.isBuffer(t)){if(e){if(t[0]==255&&t[1]==254)return ac(t.slice(2).toString("utf16le"));if(t[1]==254&&t[2]==255)return ac(ZS(t.slice(2).toString("binary")))}return t.toString("binary")}if(typeof TextDecoder<"u")try{if(e){if(t[0]==255&&t[1]==254)return ac(new TextDecoder("utf-16le").decode(t.slice(2)));if(t[0]==254&&t[1]==255)return ac(new TextDecoder("utf-16be").decode(t.slice(2)))}var r={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(t)&&(t=new Uint8Array(t)),new TextDecoder("latin1").decode(t).replace(/[]/g,function(a){return r[a]||a})}catch{}for(var n=[],s=0;s!=t.length;++s)n.push(String.fromCharCode(t[s]));return n.join("")}function Er(t){if(typeof JSON<"u"&&!Array.isArray(t))return JSON.parse(JSON.stringify(t));if(typeof t!="object"||t==null)return t;if(t instanceof Date)return new Date(t.getTime());var e={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=Er(t[r]));return e}function Ut(t,e){for(var r="";r.length<e;)r+=t;return r}function ls(t){var e=Number(t);if(!isNaN(e))return isFinite(e)?e:NaN;if(!/\d/.test(t))return e;var r=1,n=t.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(e=Number(n))||(n=n.replace(/[(](.*)[)]/,function(s,a){return r=-r,a}),!isNaN(e=Number(n)))?e/r:e}var F6=["january","february","march","april","may","june","july","august","september","october","november","december"];function dl(t){var e=new Date(t),r=new Date(NaN),n=e.getYear(),s=e.getMonth(),a=e.getDate();if(isNaN(a))return r;var i=t.toLowerCase();if(i.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(i=i.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),i.length>3&&F6.indexOf(i)==-1)return r}else if(i.match(/[a-z]/))return r;return n<0||n>8099?r:(s>0||a>1)&&n!=101?e:t.match(/[^-0-9:,\/\\]/)?r:e}var O6=function(){var t="abacaba".split(/(:?b)/i).length==5;return function(r,n,s){if(t||typeof n=="string")return r.split(n);for(var a=r.split(n),i=[a[0]],o=1;o<a.length;++o)i.push(s),i.push(a[o]);return i}}();function mA(t){return t?t.content&&t.type?Xi(t.content,!0):t.data?rc(t.data):t.asNodeBuffer&&Qe?rc(t.asNodeBuffer().toString("binary")):t.asBinary?rc(t.asBinary()):t._data&&t._data.getContent?rc(Xi(Array.prototype.slice.call(t._data.getContent(),0))):null:null}function pA(t){if(!t)return null;if(t.data)return Gy(t.data);if(t.asNodeBuffer&&Qe)return t.asNodeBuffer();if(t._data&&t._data.getContent){var e=t._data.getContent();return typeof e=="string"?Gy(e):Array.prototype.slice.call(e)}return t.content&&t.type?t.content:null}function M6(t){return t&&t.name.slice(-4)===".bin"?pA(t):mA(t)}function Fn(t,e){for(var r=t.FullPaths||Ns(t.files),n=e.toLowerCase().replace(/[\/]/g,"\\"),s=n.replace(/\\/g,"/"),a=0;a<r.length;++a){var i=r[a].replace(/^Root Entry[\/]/,"").toLowerCase();if(n==i||s==i)return t.files?t.files[r[a]]:t.FileIndex[a]}return null}function Qv(t,e){var r=Fn(t,e);if(r==null)throw new Error("Cannot find file "+e+" in zip");return r}function Xt(t,e,r){if(!r)return M6(Qv(t,e));if(!e)return null;try{return Xt(t,e)}catch{return null}}function yn(t,e,r){if(!r)return mA(Qv(t,e));if(!e)return null;try{return yn(t,e)}catch{return null}}function L6(t,e,r){return pA(Qv(t,e))}function aw(t){for(var e=t.FullPaths||Ns(t.files),r=[],n=0;n<e.length;++n)e[n].slice(-1)!="/"&&r.push(e[n].replace(/^Root Entry[\/]/,""));return r.sort()}function j6(t,e,r){if(t.FullPaths){if(typeof r=="string"){var n;return Qe?n=no(r):n=n6(r),tt.utils.cfb_add(t,e,n)}tt.utils.cfb_add(t,e,r)}else t.file(e,r)}function gA(t,e){switch(e.type){case"base64":return tt.read(t,{type:"base64"});case"binary":return tt.read(t,{type:"binary"});case"buffer":case"array":return tt.read(t,{type:"buffer"})}throw new Error("Unrecognized type "+e.type)}function sc(t,e){if(t.charAt(0)=="/")return t.slice(1);var r=e.split("/");e.slice(-1)!="/"&&r.pop();for(var n=t.split("/");n.length!==0;){var s=n.shift();s===".."?r.pop():s!=="."&&r.push(s)}return r.join("/")}var vA=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,V6=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,iw=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,U6=/<[^>]*>/g,Wr=vA.match(iw)?iw:U6,B6=/<\w*:/,z6=/<(\/?)\w+:/;function Oe(t,e,r){for(var n={},s=0,a=0;s!==t.length&&!((a=t.charCodeAt(s))===32||a===10||a===13);++s);if(e||(n[0]=t.slice(0,s)),s===t.length)return n;var i=t.match(V6),o=0,l="",c=0,u="",h="",m=1;if(i)for(c=0;c!=i.length;++c){for(h=i[c],a=0;a!=h.length&&h.charCodeAt(a)!==61;++a);for(u=h.slice(0,a).trim();h.charCodeAt(a+1)==32;)++a;for(m=(s=h.charCodeAt(a+1))==34||s==39?1:0,l=h.slice(a+1+m,h.length-m),o=0;o!=u.length&&u.charCodeAt(o)!==58;++o);if(o===u.length)u.indexOf("_")>0&&(u=u.slice(0,u.indexOf("_"))),n[u]=l,n[u.toLowerCase()]=l;else{var p=(o===5&&u.slice(0,5)==="xmlns"?"xmlns":"")+u.slice(o+1);if(n[p]&&u.slice(o-3,o)=="ext")continue;n[p]=l,n[p.toLowerCase()]=l}}return n}function Fs(t){return t.replace(z6,"<$1")}var xA={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},$6=Yv(xA),it=function(){var t=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,e=/_x([\da-fA-F]{4})_/ig;return function r(n){var s=n+"",a=s.indexOf("<![CDATA[");if(a==-1)return s.replace(t,function(o,l){return xA[o]||String.fromCharCode(parseInt(l,o.indexOf("x")>-1?16:10))||o}).replace(e,function(o,l){return String.fromCharCode(parseInt(l,16))});var i=s.indexOf("]]>");return r(s.slice(0,a))+s.slice(a+9,i)+r(s.slice(i+3))}}(),W6=/[&<>'"]/g,H6=/[\u0000-\u001f]/g;function Jv(t){var e=t+"";return e.replace(W6,function(r){return $6[r]}).replace(/\n/g,"<br/>").replace(H6,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}var ow=function(){var t=/&#(\d+);/g;function e(r,n){return String.fromCharCode(parseInt(n,10))}return function(n){return n.replace(t,e)}}();function Pt(t){switch(t){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function X0(t){for(var e="",r=0,n=0,s=0,a=0,i=0,o=0;r<t.length;){if(n=t.charCodeAt(r++),n<128){e+=String.fromCharCode(n);continue}if(s=t.charCodeAt(r++),n>191&&n<224){i=(n&31)<<6,i|=s&63,e+=String.fromCharCode(i);continue}if(a=t.charCodeAt(r++),n<240){e+=String.fromCharCode((n&15)<<12|(s&63)<<6|a&63);continue}i=t.charCodeAt(r++),o=((n&7)<<18|(s&63)<<12|(a&63)<<6|i&63)-65536,e+=String.fromCharCode(55296+(o>>>10&1023)),e+=String.fromCharCode(56320+(o&1023))}return e}function lw(t){var e=oi(2*t.length),r,n,s=1,a=0,i=0,o;for(n=0;n<t.length;n+=s)s=1,(o=t.charCodeAt(n))<128?r=o:o<224?(r=(o&31)*64+(t.charCodeAt(n+1)&63),s=2):o<240?(r=(o&15)*4096+(t.charCodeAt(n+1)&63)*64+(t.charCodeAt(n+2)&63),s=3):(s=4,r=(o&7)*262144+(t.charCodeAt(n+1)&63)*4096+(t.charCodeAt(n+2)&63)*64+(t.charCodeAt(n+3)&63),r-=65536,i=55296+(r>>>10&1023),r=56320+(r&1023)),i!==0&&(e[a++]=i&255,e[a++]=i>>>8,i=0),e[a++]=r%256,e[a++]=r>>>8;return e.slice(0,a).toString("ucs2")}function cw(t){return no(t,"binary").toString("utf8")}var Af="foo bar baz",Et=Qe&&(cw(Af)==X0(Af)&&cw||lw(Af)==X0(Af)&&lw)||X0,ac=Qe?function(t){return no(t,"utf8").toString("binary")}:function(t){for(var e=[],r=0,n=0,s=0;r<t.length;)switch(n=t.charCodeAt(r++),!0){case n<128:e.push(String.fromCharCode(n));break;case n<2048:e.push(String.fromCharCode(192+(n>>6))),e.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,s=t.charCodeAt(r++)-56320+(n<<10),e.push(String.fromCharCode(240+(s>>18&7))),e.push(String.fromCharCode(144+(s>>12&63))),e.push(String.fromCharCode(128+(s>>6&63))),e.push(String.fromCharCode(128+(s&63)));break;default:e.push(String.fromCharCode(224+(n>>12))),e.push(String.fromCharCode(128+(n>>6&63))),e.push(String.fromCharCode(128+(n&63)))}return e.join("")},ou=function(){var t={};return function(r,n){var s=r+"|"+(n||"");return t[s]?t[s]:t[s]=new RegExp("<(?:\\w+:)?"+r+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+r+">",n||"")}}(),_A=function(){var t=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(e){return[new RegExp("&"+e[0]+";","ig"),e[1]]});return function(r){for(var n=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),s=0;s<t.length;++s)n=n.replace(t[s][0],t[s][1]);return n}}(),G6=function(){var t={};return function(r){return t[r]!==void 0?t[r]:t[r]=new RegExp("<(?:vt:)?"+r+">([\\s\\S]*?)</(?:vt:)?"+r+">","g")}}(),K6=/<\/?(?:vt:)?variant>/g,q6=/<(?:vt:)([^>]*)>([\s\S]*)</;function uw(t,e){var r=Oe(t),n=t.match(G6(r.baseType))||[],s=[];if(n.length!=r.size){if(e.WTF)throw new Error("unexpected vector length "+n.length+" != "+r.size);return s}return n.forEach(function(a){var i=a.replace(K6,"").match(q6);i&&s.push({v:Et(i[2]),t:i[1]})}),s}var X6=/(^\s|\s$|\n)/;function Y6(t){return Ns(t).map(function(e){return" "+e+'="'+t[e]+'"'}).join("")}function Q6(t,e,r){return"<"+t+(r!=null?Y6(r):"")+(e!=null?(e.match(X6)?' xml:space="preserve"':"")+">"+e+"</"+t:"/")+">"}function Zv(t){if(Qe&&Buffer.isBuffer(t))return t.toString("utf8");if(typeof t=="string")return t;if(typeof Uint8Array<"u"&&t instanceof Uint8Array)return Et(so(Kv(t)));throw new Error("Bad input format: expected Buffer or string")}var lu=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,J6={CT:"http://schemas.openxmlformats.org/package/2006/content-types"},Z6=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"];function e8(t,e){for(var r=1-2*(t[e+7]>>>7),n=((t[e+7]&127)<<4)+(t[e+6]>>>4&15),s=t[e+6]&15,a=5;a>=0;--a)s=s*256+t[e+a];return n==2047?s==0?r*(1/0):NaN:(n==0?n=-1022:(n-=1023,s+=Math.pow(2,52)),r*Math.pow(2,n-52)*s)}function t8(t,e,r){var n=(e<0||1/e==-1/0?1:0)<<7,s=0,a=0,i=n?-e:e;isFinite(i)?i==0?s=a=0:(s=Math.floor(Math.log(i)/Math.LN2),a=i*Math.pow(2,52-s),s<=-1023&&(!isFinite(a)||a<Math.pow(2,52))?s=-1022:(a-=Math.pow(2,52),s+=1023)):(s=2047,a=isNaN(e)?26985:0);for(var o=0;o<=5;++o,a/=256)t[r+o]=a&255;t[r+6]=(s&15)<<4|a&15,t[r+7]=s>>4|n}var fw=function(t){for(var e=[],r=10240,n=0;n<t[0].length;++n)if(t[0][n])for(var s=0,a=t[0][n].length;s<a;s+=r)e.push.apply(e,t[0][n].slice(s,s+r));return e},hw=Qe?function(t){return t[0].length>0&&Buffer.isBuffer(t[0][0])?Buffer.concat(t[0].map(function(e){return Buffer.isBuffer(e)?e:no(e)})):fw(t)}:fw,dw=function(t,e,r){for(var n=[],s=e;s<r;s+=2)n.push(String.fromCharCode(Js(t,s)));return n.join("").replace(Qr,"")},ex=Qe?function(t,e,r){return Buffer.isBuffer(t)?t.toString("utf16le",e,r).replace(Qr,""):dw(t,e,r)}:dw,mw=function(t,e,r){for(var n=[],s=e;s<e+r;++s)n.push(("0"+t[s].toString(16)).slice(-2));return n.join("")},yA=Qe?function(t,e,r){return Buffer.isBuffer(t)?t.toString("hex",e,e+r):mw(t,e,r)}:mw,pw=function(t,e,r){for(var n=[],s=e;s<r;s++)n.push(String.fromCharCode(Eo(t,s)));return n.join("")},Mu=Qe?function(e,r,n){return Buffer.isBuffer(e)?e.toString("utf8",r,n):pw(e,r,n)}:pw,wA=function(t,e){var r=_n(t,e);return r>0?Mu(t,e+4,e+4+r-1):""},EA=wA,TA=function(t,e){var r=_n(t,e);return r>0?Mu(t,e+4,e+4+r-1):""},kA=TA,SA=function(t,e){var r=2*_n(t,e);return r>0?Mu(t,e+4,e+4+r-1):""},AA=SA,IA=function(e,r){var n=_n(e,r);return n>0?ex(e,r+4,r+4+n):""},CA=IA,RA=function(t,e){var r=_n(t,e);return r>0?Mu(t,e+4,e+4+r):""},NA=RA,PA=function(t,e){return e8(t,e)},td=PA,bA=function(e){return Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array};Qe&&(EA=function(e,r){if(!Buffer.isBuffer(e))return wA(e,r);var n=e.readUInt32LE(r);return n>0?e.toString("utf8",r+4,r+4+n-1):""},kA=function(e,r){if(!Buffer.isBuffer(e))return TA(e,r);var n=e.readUInt32LE(r);return n>0?e.toString("utf8",r+4,r+4+n-1):""},AA=function(e,r){if(!Buffer.isBuffer(e))return SA(e,r);var n=2*e.readUInt32LE(r);return e.toString("utf16le",r+4,r+4+n-1)},CA=function(e,r){if(!Buffer.isBuffer(e))return IA(e,r);var n=e.readUInt32LE(r);return e.toString("utf16le",r+4,r+4+n)},NA=function(e,r){if(!Buffer.isBuffer(e))return RA(e,r);var n=e.readUInt32LE(r);return e.toString("utf8",r+4,r+4+n)},td=function(e,r){return Buffer.isBuffer(e)?e.readDoubleLE(r):PA(e,r)},bA=function(e){return Buffer.isBuffer(e)||Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array});var Eo=function(t,e){return t[e]},Js=function(t,e){return t[e+1]*256+t[e]},r8=function(t,e){var r=t[e+1]*256+t[e];return r<32768?r:(65535-r+1)*-1},_n=function(t,e){return t[e+3]*(1<<24)+(t[e+2]<<16)+(t[e+1]<<8)+t[e]},ki=function(t,e){return t[e+3]<<24|t[e+2]<<16|t[e+1]<<8|t[e]},n8=function(t,e){return t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3]};function wc(t,e){var r="",n,s,a=[],i,o,l,c;switch(e){case"dbcs":if(c=this.l,Qe&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*t).toString("utf16le");else for(l=0;l<t;++l)r+=String.fromCharCode(Js(this,c)),c+=2;t*=2;break;case"utf8":r=Mu(this,this.l,this.l+t);break;case"utf16le":t*=2,r=ex(this,this.l,this.l+t);break;case"wstr":return wc.call(this,t,"dbcs");case"lpstr-ansi":r=EA(this,this.l),t=4+_n(this,this.l);break;case"lpstr-cp":r=kA(this,this.l),t=4+_n(this,this.l);break;case"lpwstr":r=AA(this,this.l),t=4+2*_n(this,this.l);break;case"lpp4":t=4+_n(this,this.l),r=CA(this,this.l),t&2&&(t+=2);break;case"8lpp4":t=4+_n(this,this.l),r=NA(this,this.l),t&3&&(t+=4-(t&3));break;case"cstr":for(t=0,r="";(i=Eo(this,this.l+t++))!==0;)a.push(Sf(i));r=a.join("");break;case"_wstr":for(t=0,r="";(i=Js(this,this.l+t))!==0;)a.push(Sf(i)),t+=2;t+=2,r=a.join("");break;case"dbcs-cont":for(r="",c=this.l,l=0;l<t;++l){if(this.lens&&this.lens.indexOf(c)!==-1)return i=Eo(this,c),this.l=c+1,o=wc.call(this,t-l,i?"dbcs-cont":"sbcs-cont"),a.join("")+o;a.push(Sf(Js(this,c))),c+=2}r=a.join(""),t*=2;break;case"cpstr":case"sbcs-cont":for(r="",c=this.l,l=0;l!=t;++l){if(this.lens&&this.lens.indexOf(c)!==-1)return i=Eo(this,c),this.l=c+1,o=wc.call(this,t-l,i?"dbcs-cont":"sbcs-cont"),a.join("")+o;a.push(Sf(Eo(this,c))),c+=1}r=a.join("");break;default:switch(t){case 1:return n=Eo(this,this.l),this.l++,n;case 2:return n=(e==="i"?r8:Js)(this,this.l),this.l+=2,n;case 4:case-4:return e==="i"||!(this[this.l+3]&128)?(n=(t>0?ki:n8)(this,this.l),this.l+=4,n):(s=_n(this,this.l),this.l+=4,s);case 8:case-8:if(e==="f")return t==8?s=td(this,this.l):s=td([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,s;t=8;case 16:r=yA(this,this.l,t);break}}return this.l+=t,r}var s8=function(t,e,r){t[r]=e&255,t[r+1]=e>>>8&255,t[r+2]=e>>>16&255,t[r+3]=e>>>24&255},a8=function(t,e,r){t[r]=e&255,t[r+1]=e>>8&255,t[r+2]=e>>16&255,t[r+3]=e>>24&255},i8=function(t,e,r){t[r]=e&255,t[r+1]=e>>>8&255};function o8(t,e,r){var n=0,s=0;if(r==="dbcs"){for(s=0;s!=e.length;++s)i8(this,e.charCodeAt(s),this.l+2*s);n=2*e.length}else if(r==="sbcs"){for(e=e.replace(/[^\x00-\x7F]/g,"_"),s=0;s!=e.length;++s)this[this.l+s]=e.charCodeAt(s)&255;n=e.length}else if(r==="hex"){for(;s<t;++s)this[this.l++]=parseInt(e.slice(2*s,2*s+2),16)||0;return this}else if(r==="utf16le"){var a=Math.min(this.l+t,this.length);for(s=0;s<Math.min(e.length,t);++s){var i=e.charCodeAt(s);this[this.l++]=i&255,this[this.l++]=i>>8}for(;this.l<a;)this[this.l++]=0;return this}else switch(t){case 1:n=1,this[this.l]=e&255;break;case 2:n=2,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255;break;case 3:n=3,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255,e>>>=8,this[this.l+2]=e&255;break;case 4:n=4,s8(this,e,this.l);break;case 8:if(n=8,r==="f"){t8(this,e,this.l);break}case 16:break;case-4:n=4,a8(this,e,this.l);break}return this.l+=n,this}function DA(t,e){var r=yA(this,this.l,t.length>>1);if(r!==t)throw new Error(e+"Expected "+t+" saw "+r);this.l+=t.length>>1}function xr(t,e){t.l=e,t.read_shift=wc,t.chk=DA,t.write_shift=o8}function $r(t,e){t.l+=e}function tr(t){var e=oi(t);return xr(e,0),e}function ya(t,e,r){if(t){var n,s,a;xr(t,t.l||0);for(var i=t.length,o=0,l=0;t.l<i;){o=t.read_shift(1),o&128&&(o=(o&127)+((t.read_shift(1)&127)<<7));var c=od[o]||od[65535];for(n=t.read_shift(1),a=n&127,s=1;s<4&&n&128;++s)a+=((n=t.read_shift(1))&127)<<7*s;l=t.l+a;var u=c.f&&c.f(t,a,r);if(t.l=l,e(u,c,o))return}}}function Rp(){var t=[],e=Qe?256:2048,r=function(c){var u=tr(c);return xr(u,0),u},n=r(e),s=function(){n&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&t.push(n),n=null)},a=function(c){return n&&c<n.length-n.l?n:(s(),n=r(Math.max(c+1,e)))},i=function(){return s(),Oa(t)},o=function(c){s(),n=c,n.l==null&&(n.l=n.length),a(e)};return{next:a,push:o,end:i,_bufs:t}}function Ec(t,e,r){var n=Er(t);if(e.s?(n.cRel&&(n.c+=e.s.c),n.rRel&&(n.r+=e.s.r)):(n.cRel&&(n.c+=e.c),n.rRel&&(n.r+=e.r)),!r||r.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function gw(t,e,r){var n=Er(t);return n.s=Ec(n.s,e.s,r),n.e=Ec(n.e,e.s,r),n}function Tc(t,e){if(t.cRel&&t.c<0)for(t=Er(t);t.c<0;)t.c+=e>8?16384:256;if(t.rRel&&t.r<0)for(t=Er(t);t.r<0;)t.r+=e>8?1048576:e>5?65536:16384;var r=Ue(t);return!t.cRel&&t.cRel!=null&&(r=u8(r)),!t.rRel&&t.rRel!=null&&(r=l8(r)),r}function Y0(t,e){return t.s.r==0&&!t.s.rRel&&t.e.r==(e.biff>=12?1048575:e.biff>=8?65536:16384)&&!t.e.rRel?(t.s.cRel?"":"$")+sr(t.s.c)+":"+(t.e.cRel?"":"$")+sr(t.e.c):t.s.c==0&&!t.s.cRel&&t.e.c==(e.biff>=12?16383:255)&&!t.e.cRel?(t.s.rRel?"":"$")+Tr(t.s.r)+":"+(t.e.rRel?"":"$")+Tr(t.e.r):Tc(t.s,e.biff)+":"+Tc(t.e,e.biff)}function tx(t){return parseInt(c8(t),10)-1}function Tr(t){return""+(t+1)}function l8(t){return t.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function c8(t){return t.replace(/\$(\d+)$/,"$1")}function rx(t){for(var e=f8(t),r=0,n=0;n!==e.length;++n)r=26*r+e.charCodeAt(n)-64;return r-1}function sr(t){if(t<0)throw new Error("invalid column "+t);var e="";for(++t;t;t=Math.floor((t-1)/26))e=String.fromCharCode((t-1)%26+65)+e;return e}function u8(t){return t.replace(/^([A-Z])/,"$$$1")}function f8(t){return t.replace(/^\$([A-Z])/,"$1")}function h8(t){return t.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function qr(t){for(var e=0,r=0,n=0;n<t.length;++n){var s=t.charCodeAt(n);s>=48&&s<=57?e=10*e+(s-48):s>=65&&s<=90&&(r=26*r+(s-64))}return{c:r-1,r:e-1}}function Ue(t){for(var e=t.c+1,r="";e;e=(e-1)/26|0)r=String.fromCharCode((e-1)%26+65)+r;return r+(t.r+1)}function kl(t){var e=t.indexOf(":");return e==-1?{s:qr(t),e:qr(t)}:{s:qr(t.slice(0,e)),e:qr(t.slice(e+1))}}function rt(t,e){return typeof e>"u"||typeof e=="number"?rt(t.s,t.e):(typeof t!="string"&&(t=Ue(t)),typeof e!="string"&&(e=Ue(e)),t==e?t:t+":"+e)}function Bt(t){var e={s:{c:0,r:0},e:{c:0,r:0}},r=0,n=0,s=0,a=t.length;for(r=0;n<a&&!((s=t.charCodeAt(n)-64)<1||s>26);++n)r=26*r+s;for(e.s.c=--r,r=0;n<a&&!((s=t.charCodeAt(n)-48)<0||s>9);++n)r=10*r+s;if(e.s.r=--r,n===a||s!=10)return e.e.c=e.s.c,e.e.r=e.s.r,e;for(++n,r=0;n!=a&&!((s=t.charCodeAt(n)-64)<1||s>26);++n)r=26*r+s;for(e.e.c=--r,r=0;n!=a&&!((s=t.charCodeAt(n)-48)<0||s>9);++n)r=10*r+s;return e.e.r=--r,e}function vw(t,e){var r=t.t=="d"&&e instanceof Date;if(t.z!=null)try{return t.w=$n(t.z,r?Jr(e):e)}catch{}try{return t.w=$n((t.XF||{}).numFmtId||(r?14:0),r?Jr(e):e)}catch{return""+e}}function ga(t,e,r){return t==null||t.t==null||t.t=="z"?"":t.w!==void 0?t.w:(t.t=="d"&&!t.z&&r&&r.dateNF&&(t.z=r.dateNF),t.t=="e"?oo[t.v]||t.v:e==null?vw(t,t.v):vw(t,e))}function pi(t,e){var r=e&&e.sheet?e.sheet:"Sheet1",n={};return n[r]=t,{SheetNames:[r],Sheets:n}}function FA(t,e,r){var n=r||{},s=t?Array.isArray(t):n.dense,a=t||(s?[]:{}),i=0,o=0;if(a&&n.origin!=null){if(typeof n.origin=="number")i=n.origin;else{var l=typeof n.origin=="string"?qr(n.origin):n.origin;i=l.r,o=l.c}a["!ref"]||(a["!ref"]="A1:A1")}var c={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(a["!ref"]){var u=Bt(a["!ref"]);c.s.c=u.s.c,c.s.r=u.s.r,c.e.c=Math.max(c.e.c,u.e.c),c.e.r=Math.max(c.e.r,u.e.r),i==-1&&(c.e.r=i=u.e.r+1)}for(var h=0;h!=e.length;++h)if(e[h]){if(!Array.isArray(e[h]))throw new Error("aoa_to_sheet expects an array of arrays");for(var m=0;m!=e[h].length;++m)if(!(typeof e[h][m]>"u")){var p={v:e[h][m]},x=i+h,v=o+m;if(c.s.r>x&&(c.s.r=x),c.s.c>v&&(c.s.c=v),c.e.r<x&&(c.e.r=x),c.e.c<v&&(c.e.c=v),e[h][m]&&typeof e[h][m]=="object"&&!Array.isArray(e[h][m])&&!(e[h][m]instanceof Date))p=e[h][m];else if(Array.isArray(p.v)&&(p.f=e[h][m][1],p.v=p.v[0]),p.v===null)if(p.f)p.t="n";else if(n.nullError)p.t="e",p.v=0;else if(n.sheetStubs)p.t="z";else continue;else typeof p.v=="number"?p.t="n":typeof p.v=="boolean"?p.t="b":p.v instanceof Date?(p.z=n.dateNF||ze[14],n.cellDates?(p.t="d",p.w=$n(p.z,Jr(p.v))):(p.t="n",p.v=Jr(p.v),p.w=$n(p.z,p.v))):p.t="s";if(s)a[x]||(a[x]=[]),a[x][v]&&a[x][v].z&&(p.z=a[x][v].z),a[x][v]=p;else{var w=Ue({c:v,r:x});a[w]&&a[w].z&&(p.z=a[w].z),a[w]=p}}}return c.s.c<1e7&&(a["!ref"]=rt(c)),a}function Sl(t,e){return FA(null,t,e)}function d8(t){return t.read_shift(4,"i")}function Ur(t){var e=t.read_shift(4);return e===0?"":t.read_shift(e,"dbcs")}function m8(t){return{ich:t.read_shift(2),ifnt:t.read_shift(2)}}function nx(t,e){var r=t.l,n=t.read_shift(1),s=Ur(t),a=[],i={t:s,h:s};if(n&1){for(var o=t.read_shift(4),l=0;l!=o;++l)a.push(m8(t));i.r=a}else i.r=[{ich:0,ifnt:0}];return t.l=r+e,i}var p8=nx;function Wn(t){var e=t.read_shift(4),r=t.read_shift(2);return r+=t.read_shift(1)<<16,t.l++,{c:e,iStyleRef:r}}function ao(t){var e=t.read_shift(2);return e+=t.read_shift(1)<<16,t.l++,{c:-1,iStyleRef:e}}var g8=Ur;function sx(t){var e=t.read_shift(4);return e===0||e===4294967295?"":t.read_shift(e,"dbcs")}var v8=Ur,Np=sx;function ax(t){var e=t.slice(t.l,t.l+4),r=e[0]&1,n=e[0]&2;t.l+=4;var s=n===0?td([0,0,0,0,e[0]&252,e[1],e[2],e[3]],0):ki(e,0)>>2;return r?s/100:s}function OA(t){var e={s:{},e:{}};return e.s.r=t.read_shift(4),e.e.r=t.read_shift(4),e.s.c=t.read_shift(4),e.e.c=t.read_shift(4),e}var io=OA;function Lr(t){if(t.length-t.l<8)throw"XLS Xnum Buffer underflow";return t.read_shift(8,"f")}function x8(t){var e={},r=t.read_shift(1),n=r>>>1,s=t.read_shift(1),a=t.read_shift(2,"i"),i=t.read_shift(1),o=t.read_shift(1),l=t.read_shift(1);switch(t.l++,n){case 0:e.auto=1;break;case 1:e.index=s;var c=Li[s];c&&(e.rgb=uu(c));break;case 2:e.rgb=uu([i,o,l]);break;case 3:e.theme=s;break}return a!=0&&(e.tint=a>0?a/32767:a/32768),e}function _8(t){var e=t.read_shift(1);t.l++;var r={fBold:e&1,fItalic:e&2,fUnderline:e&4,fStrikeout:e&8,fOutline:e&16,fShadow:e&32,fCondense:e&64,fExtend:e&128};return r}function MA(t,e){var r={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},n=t.read_shift(4);switch(n){case 0:return"";case 4294967295:case 4294967294:return r[t.read_shift(4)]||""}if(n>400)throw new Error("Unsupported Clipboard: "+n.toString(16));return t.l-=4,t.read_shift(0,e==1?"lpstr":"lpwstr")}function y8(t){return MA(t,1)}function w8(t){return MA(t,2)}var ix=2,an=3,If=11,xw=12,rd=19,Cf=64,E8=65,T8=71,k8=4108,S8=4126,ur=80,LA=81,A8=[ur,LA],I8={1:{n:"CodePage",t:ix},2:{n:"Category",t:ur},3:{n:"PresentationFormat",t:ur},4:{n:"ByteCount",t:an},5:{n:"LineCount",t:an},6:{n:"ParagraphCount",t:an},7:{n:"SlideCount",t:an},8:{n:"NoteCount",t:an},9:{n:"HiddenCount",t:an},10:{n:"MultimediaClipCount",t:an},11:{n:"ScaleCrop",t:If},12:{n:"HeadingPairs",t:k8},13:{n:"TitlesOfParts",t:S8},14:{n:"Manager",t:ur},15:{n:"Company",t:ur},16:{n:"LinksUpToDate",t:If},17:{n:"CharacterCount",t:an},19:{n:"SharedDoc",t:If},22:{n:"HyperlinksChanged",t:If},23:{n:"AppVersion",t:an,p:"version"},24:{n:"DigSig",t:E8},26:{n:"ContentType",t:ur},27:{n:"ContentStatus",t:ur},28:{n:"Language",t:ur},29:{n:"Version",t:ur},255:{},2147483648:{n:"Locale",t:rd},2147483651:{n:"Behavior",t:rd},1919054434:{}},C8={1:{n:"CodePage",t:ix},2:{n:"Title",t:ur},3:{n:"Subject",t:ur},4:{n:"Author",t:ur},5:{n:"Keywords",t:ur},6:{n:"Comments",t:ur},7:{n:"Template",t:ur},8:{n:"LastAuthor",t:ur},9:{n:"RevNumber",t:ur},10:{n:"EditTime",t:Cf},11:{n:"LastPrinted",t:Cf},12:{n:"CreatedDate",t:Cf},13:{n:"ModifiedDate",t:Cf},14:{n:"PageCount",t:an},15:{n:"WordCount",t:an},16:{n:"CharCount",t:an},17:{n:"Thumbnail",t:T8},18:{n:"Application",t:ur},19:{n:"DocSecurity",t:an},255:{},2147483648:{n:"Locale",t:rd},2147483651:{n:"Behavior",t:rd},1919054434:{}},_w={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},R8=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function N8(t){return t.map(function(e){return[e>>16&255,e>>8&255,e&255]})}var P8=N8([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Li=Er(P8),oo={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},jA={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},yw={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"};function b8(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function D8(t){var e=b8();if(!t||!t.match)return e;var r={};if((t.match(Wr)||[]).forEach(function(n){var s=Oe(n);switch(s[0].replace(B6,"<")){case"<?xml":break;case"<Types":e.xmlns=s["xmlns"+(s[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":r[s.Extension]=s.ContentType;break;case"<Override":e[yw[s.ContentType]]!==void 0&&e[yw[s.ContentType]].push(s.PartName);break}}),e.xmlns!==J6.CT)throw new Error("Unknown Namespace: "+e.xmlns);return e.calcchain=e.calcchains.length>0?e.calcchains[0]:"",e.sst=e.strs.length>0?e.strs[0]:"",e.style=e.styles.length>0?e.styles[0]:"",e.defaults=r,delete e.calcchains,e}var Oo={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function Pp(t){var e=t.lastIndexOf("/");return t.slice(0,e+1)+"_rels/"+t.slice(e+1)+".rels"}function kc(t,e){var r={"!id":{}};if(!t)return r;e.charAt(0)!=="/"&&(e="/"+e);var n={};return(t.match(Wr)||[]).forEach(function(s){var a=Oe(s);if(a[0]==="<Relationship"){var i={};i.Type=a.Type,i.Target=a.Target,i.Id=a.Id,a.TargetMode&&(i.TargetMode=a.TargetMode);var o=a.TargetMode==="External"?a.Target:sc(a.Target,e);r[o]=i,n[a.Id]=i}}),r["!id"]=n,r}var F8="application/vnd.oasis.opendocument.spreadsheet";function O8(t,e){for(var r=Zv(t),n,s;n=lu.exec(r);)switch(n[3]){case"manifest":break;case"file-entry":if(s=Oe(n[0],!1),s.path=="/"&&s.type!==F8)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(e&&e.WTF)throw n}}var Sc=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],M8=function(){for(var t=new Array(Sc.length),e=0;e<Sc.length;++e){var r=Sc[e],n="(?:"+r[0].slice(0,r[0].indexOf(":"))+":)"+r[0].slice(r[0].indexOf(":")+1);t[e]=new RegExp("<"+n+"[^>]*>([\\s\\S]*?)</"+n+">")}return t}();function VA(t){var e={};t=Et(t);for(var r=0;r<Sc.length;++r){var n=Sc[r],s=t.match(M8[r]);s!=null&&s.length>0&&(e[n[1]]=it(s[1])),n[2]==="date"&&e[n[1]]&&(e[n[1]]=dr(e[n[1]]))}return e}var L8=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]];function UA(t,e,r,n){var s=[];if(typeof t=="string")s=uw(t,n);else for(var a=0;a<t.length;++a)s=s.concat(t[a].map(function(u){return{v:u}}));var i=typeof e=="string"?uw(e,n).map(function(u){return u.v}):e,o=0,l=0;if(i.length>0)for(var c=0;c!==s.length;c+=2){switch(l=+s[c+1].v,s[c].v){case"Worksheets":case"":case"":case" ":case"":case" ":case"Arbeitsbltter":case"alma Sayfalar":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de clculo":case"Planilhas":case"Regneark":case"Hojas de clculo":case"Werkbladen":r.Worksheets=l,r.SheetNames=i.slice(o,o+l);break;case"Named Ranges":case"Rangos con nombre":case"":case"Benannte Bereiche":case"Navngivne omrder":r.NamedRanges=l,r.DefinedNames=i.slice(o,o+l);break;case"Charts":case"Diagramme":r.Chartsheets=l,r.ChartNames=i.slice(o,o+l);break}o+=l}}function j8(t,e,r){var n={};return e||(e={}),t=Et(t),L8.forEach(function(s){var a=(t.match(ou(s[0]))||[])[1];switch(s[2]){case"string":a&&(e[s[1]]=it(a));break;case"bool":e[s[1]]=a==="true";break;case"raw":var i=t.match(new RegExp("<"+s[0]+"[^>]*>([\\s\\S]*?)</"+s[0]+">"));i&&i.length>0&&(n[s[1]]=i[1]);break}}),n.HeadingPairs&&n.TitlesOfParts&&UA(n.HeadingPairs,n.TitlesOfParts,e,r),e}var V8=/<[^>]+>[^<]*/g;function U8(t,e){var r={},n="",s=t.match(V8);if(s)for(var a=0;a!=s.length;++a){var i=s[a],o=Oe(i);switch(o[0]){case"<?xml":break;case"<Properties":break;case"<property":n=it(o.name);break;case"</property>":n=null;break;default:if(i.indexOf("<vt:")===0){var l=i.split(">"),c=l[0].slice(4),u=l[1];switch(c){case"lpstr":case"bstr":case"lpwstr":r[n]=it(u);break;case"bool":r[n]=Pt(u);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":r[n]=parseInt(u,10);break;case"r4":case"r8":case"decimal":r[n]=parseFloat(u);break;case"filetime":case"date":r[n]=dr(u);break;case"cy":case"error":r[n]=it(u);break;default:if(c.slice(-1)=="/")break;e.WTF&&typeof console<"u"&&console.warn("Unexpected",i,c,l)}}else if(i.slice(0,2)!=="</"){if(e.WTF)throw new Error(i)}}}return r}var B8={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},Q0;function z8(t,e,r){Q0||(Q0=Yv(B8)),e=Q0[e]||e,t[e]=r}function ox(t){var e=t.read_shift(4),r=t.read_shift(4);return new Date((r/1e7*Math.pow(2,32)+e/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function BA(t,e,r){var n=t.l,s=t.read_shift(0,"lpstr-cp");if(r)for(;t.l-n&3;)++t.l;return s}function zA(t,e,r){var n=t.read_shift(0,"lpwstr");return n}function $A(t,e,r){return e===31?zA(t):BA(t,e,r)}function bp(t,e,r){return $A(t,e,r===!1?0:4)}function $8(t,e){if(!e)throw new Error("VtUnalignedString must have positive length");return $A(t,e,0)}function W8(t){for(var e=t.read_shift(4),r=[],n=0;n!=e;++n){var s=t.l;r[n]=t.read_shift(0,"lpwstr").replace(Qr,""),t.l-s&2&&(t.l+=2)}return r}function H8(t){for(var e=t.read_shift(4),r=[],n=0;n!=e;++n)r[n]=t.read_shift(0,"lpstr-cp").replace(Qr,"");return r}function G8(t){var e=t.l,r=nd(t,LA);t[t.l]==0&&t[t.l+1]==0&&t.l-e&2&&(t.l+=2);var n=nd(t,an);return[r,n]}function K8(t){for(var e=t.read_shift(4),r=[],n=0;n<e/2;++n)r.push(G8(t));return r}function ww(t,e){for(var r=t.read_shift(4),n={},s=0;s!=r;++s){var a=t.read_shift(4),i=t.read_shift(4);n[a]=t.read_shift(i,e===1200?"utf16le":"utf8").replace(Qr,"").replace(nc,"!"),e===1200&&i%2&&(t.l+=2)}return t.l&3&&(t.l=t.l>>3<<2),n}function WA(t){var e=t.read_shift(4),r=t.slice(t.l,t.l+e);return t.l+=e,(e&3)>0&&(t.l+=4-(e&3)&3),r}function q8(t){var e={};return e.Size=t.read_shift(4),t.l+=e.Size+3-(e.Size-1)%4,e}function nd(t,e,r){var n=t.read_shift(2),s,a=r||{};if(t.l+=2,e!==xw&&n!==e&&A8.indexOf(e)===-1&&!((e&65534)==4126&&(n&65534)==4126))throw new Error("Expected type "+e+" saw "+n);switch(e===xw?n:e){case 2:return s=t.read_shift(2,"i"),a.raw||(t.l+=2),s;case 3:return s=t.read_shift(4,"i"),s;case 11:return t.read_shift(4)!==0;case 19:return s=t.read_shift(4),s;case 30:return BA(t,n,4).replace(Qr,"");case 31:return zA(t);case 64:return ox(t);case 65:return WA(t);case 71:return q8(t);case 80:return bp(t,n,!a.raw).replace(Qr,"");case 81:return $8(t,n).replace(Qr,"");case 4108:return K8(t);case 4126:case 4127:return n==4127?W8(t):H8(t);default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+n)}}function Ew(t,e){var r=t.l,n=t.read_shift(4),s=t.read_shift(4),a=[],i=0,o=0,l=-1,c={};for(i=0;i!=s;++i){var u=t.read_shift(4),h=t.read_shift(4);a[i]=[u,h+r]}a.sort(function(T,E){return T[1]-E[1]});var m={};for(i=0;i!=s;++i){if(t.l!==a[i][1]){var p=!0;if(i>0&&e)switch(e[a[i-1][0]].t){case 2:t.l+2===a[i][1]&&(t.l+=2,p=!1);break;case 80:t.l<=a[i][1]&&(t.l=a[i][1],p=!1);break;case 4108:t.l<=a[i][1]&&(t.l=a[i][1],p=!1);break}if((!e||i==0)&&t.l<=a[i][1]&&(p=!1,t.l=a[i][1]),p)throw new Error("Read Error: Expected address "+a[i][1]+" at "+t.l+" :"+i)}if(e){var x=e[a[i][0]];if(m[x.n]=nd(t,x.t,{raw:!0}),x.p==="version"&&(m[x.n]=String(m[x.n]>>16)+"."+("0000"+String(m[x.n]&65535)).slice(-4)),x.n=="CodePage")switch(m[x.n]){case 0:m[x.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:ns(o=m[x.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+m[x.n])}}else if(a[i][0]===1){if(o=m.CodePage=nd(t,ix),ns(o),l!==-1){var v=t.l;t.l=a[l][1],c=ww(t,o),t.l=v}}else if(a[i][0]===0){if(o===0){l=i,t.l=a[i+1][1];continue}c=ww(t,o)}else{var w=c[a[i][0]],k;switch(t[t.l]){case 65:t.l+=4,k=WA(t);break;case 30:t.l+=4,k=bp(t,t[t.l-4]).replace(/\u0000+$/,"");break;case 31:t.l+=4,k=bp(t,t[t.l-4]).replace(/\u0000+$/,"");break;case 3:t.l+=4,k=t.read_shift(4,"i");break;case 19:t.l+=4,k=t.read_shift(4);break;case 5:t.l+=4,k=t.read_shift(8,"f");break;case 11:t.l+=4,k=zt(t,4);break;case 64:t.l+=4,k=dr(ox(t));break;default:throw new Error("unparsed value: "+t[t.l])}m[w]=k}}return t.l=r+n,m}function Tw(t,e,r){var n=t.content;if(!n)return{};xr(n,0);var s,a,i,o,l=0;n.chk("feff","Byte Order: "),n.read_shift(2);var c=n.read_shift(4),u=n.read_shift(16);if(u!==tt.utils.consts.HEADER_CLSID&&u!==r)throw new Error("Bad PropertySet CLSID "+u);if(s=n.read_shift(4),s!==1&&s!==2)throw new Error("Unrecognized #Sets: "+s);if(a=n.read_shift(16),o=n.read_shift(4),s===1&&o!==n.l)throw new Error("Length mismatch: "+o+" !== "+n.l);s===2&&(i=n.read_shift(16),l=n.read_shift(4));var h=Ew(n,e),m={SystemIdentifier:c};for(var p in h)m[p]=h[p];if(m.FMTID=a,s===1)return m;if(l-n.l==2&&(n.l+=2),n.l!==l)throw new Error("Length mismatch 2: "+n.l+" !== "+l);var x;try{x=Ew(n,null)}catch{}for(p in x)m[p]=x[p];return m.FMTID=[a,i],m}function Aa(t,e){return t.read_shift(e),null}function X8(t,e,r){for(var n=[],s=t.l+e;t.l<s;)n.push(r(t,s-t.l));if(s!==t.l)throw new Error("Slurp error");return n}function zt(t,e){return t.read_shift(e)===1}function Yt(t){return t.read_shift(2,"u")}function HA(t,e){return X8(t,e,Yt)}function Y8(t){var e=t.read_shift(1),r=t.read_shift(1);return r===1?e:e===1}function Lu(t,e,r){var n=t.read_shift(r&&r.biff>=12?2:1),s="sbcs-cont";if(r&&r.biff>=8,!r||r.biff==8){var a=t.read_shift(1);a&&(s="dbcs-cont")}else r.biff==12&&(s="wstr");r.biff>=2&&r.biff<=5&&(s="cpstr");var i=n?t.read_shift(n,s):"";return i}function Q8(t){var e=t.read_shift(2),r=t.read_shift(1),n=r&4,s=r&8,a=1+(r&1),i=0,o,l={};s&&(i=t.read_shift(2)),n&&(o=t.read_shift(4));var c=a==2?"dbcs-cont":"sbcs-cont",u=e===0?"":t.read_shift(e,c);return s&&(t.l+=4*i),n&&(t.l+=o),l.t=u,s||(l.raw="<t>"+l.t+"</t>",l.r=l.t),l}function Yi(t,e,r){var n;if(r){if(r.biff>=2&&r.biff<=5)return t.read_shift(e,"cpstr");if(r.biff>=12)return t.read_shift(e,"dbcs-cont")}var s=t.read_shift(1);return s===0?n=t.read_shift(e,"sbcs-cont"):n=t.read_shift(e,"dbcs-cont"),n}function ju(t,e,r){var n=t.read_shift(r&&r.biff==2?1:2);return n===0?(t.l++,""):Yi(t,n,r)}function lo(t,e,r){if(r.biff>5)return ju(t,e,r);var n=t.read_shift(1);return n===0?(t.l++,""):t.read_shift(n,r.biff<=4||!t.lens?"cpstr":"sbcs-cont")}function J8(t){var e=t.read_shift(1);t.l++;var r=t.read_shift(2);return t.l+=2,[e,r]}function Z8(t){var e=t.read_shift(4),r=t.l,n=!1;e>24&&(t.l+=e-24,t.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(n=!0),t.l=r);var s=t.read_shift((n?e-24:e)>>1,"utf16le").replace(Qr,"");return n&&(t.l+=24),s}function e5(t){for(var e=t.read_shift(2),r="";e-- >0;)r+="../";var n=t.read_shift(0,"lpstr-ansi");if(t.l+=2,t.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var s=t.read_shift(4);if(s===0)return r+n.replace(/\\/g,"/");var a=t.read_shift(4);if(t.read_shift(2)!=3)throw new Error("Bad FileMoniker");var i=t.read_shift(a>>1,"utf16le").replace(Qr,"");return r+i}function t5(t,e){var r=t.read_shift(16);switch(r){case"e0c9ea79f9bace118c8200aa004ba90b":return Z8(t);case"0303000000000000c000000000000046":return e5(t);default:throw new Error("Unsupported Moniker "+r)}}function Rf(t){var e=t.read_shift(4),r=e>0?t.read_shift(e,"utf16le").replace(Qr,""):"";return r}function r5(t,e){var r=t.l+e,n=t.read_shift(4);if(n!==2)throw new Error("Unrecognized streamVersion: "+n);var s=t.read_shift(2);t.l+=2;var a,i,o,l,c="",u,h;s&16&&(a=Rf(t,r-t.l)),s&128&&(i=Rf(t,r-t.l)),(s&257)===257&&(o=Rf(t,r-t.l)),(s&257)===1&&(l=t5(t,r-t.l)),s&8&&(c=Rf(t,r-t.l)),s&32&&(u=t.read_shift(16)),s&64&&(h=ox(t)),t.l=r;var m=i||o||l||"";m&&c&&(m+="#"+c),m||(m="#"+c),s&2&&m.charAt(0)=="/"&&m.charAt(1)!="/"&&(m="file://"+m);var p={Target:m};return u&&(p.guid=u),h&&(p.time=h),a&&(p.Tooltip=a),p}function GA(t){var e=t.read_shift(1),r=t.read_shift(1),n=t.read_shift(1),s=t.read_shift(1);return[e,r,n,s]}function KA(t,e){var r=GA(t);return r[3]=0,r}function Os(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2);return{r:e,c:r,ixfe:n}}function n5(t){var e=t.read_shift(2),r=t.read_shift(2);return t.l+=8,{type:e,flags:r}}function s5(t,e,r){return e===0?"":lo(t,e,r)}function a5(t,e,r){var n=r.biff>8?4:2,s=t.read_shift(n),a=t.read_shift(n,"i"),i=t.read_shift(n,"i");return[s,a,i]}function qA(t){var e=t.read_shift(2),r=ax(t);return[e,r]}function i5(t,e,r){t.l+=4,e-=4;var n=t.l+e,s=Lu(t,e,r),a=t.read_shift(2);if(n-=t.l,a!==n)throw new Error("Malformed AddinUdf: padding = "+n+" != "+a);return t.l+=a,s}function Zd(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2),s=t.read_shift(2);return{s:{c:n,r:e},e:{c:s,r}}}function XA(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(1),s=t.read_shift(1);return{s:{c:n,r:e},e:{c:s,r}}}var o5=XA;function YA(t){t.l+=4;var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2);return t.l+=12,[r,e,n]}function l5(t){var e={};return t.l+=4,t.l+=16,e.fSharedNote=t.read_shift(2),t.l+=4,e}function c5(t){var e={};return t.l+=4,t.cf=t.read_shift(2),e}function br(t){t.l+=2,t.l+=t.read_shift(2)}var u5={0:br,4:br,5:br,6:br,7:c5,8:br,9:br,10:br,11:br,12:br,13:l5,14:br,15:br,16:br,17:br,18:br,19:br,20:br,21:YA};function f5(t,e){for(var r=t.l+e,n=[];t.l<r;){var s=t.read_shift(2);t.l-=2;try{n.push(u5[s](t,r-t.l))}catch{return t.l=r,n}}return t.l!=r&&(t.l=r),n}function Nf(t,e){var r={BIFFVer:0,dt:0};switch(r.BIFFVer=t.read_shift(2),e-=2,e>=2&&(r.dt=t.read_shift(2),t.l-=2),r.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(e>6)throw new Error("Unexpected BIFF Ver "+r.BIFFVer)}return t.read_shift(e),r}function h5(t,e){return e===0||t.read_shift(2),1200}function d5(t,e,r){if(r.enc)return t.l+=e,"";var n=t.l,s=lo(t,0,r);return t.read_shift(e+n-t.l),s}function m5(t,e,r){var n=r&&r.biff==8||e==2?t.read_shift(2):(t.l+=e,0);return{fDialog:n&16,fBelow:n&64,fRight:n&128}}function p5(t,e,r){var n=t.read_shift(4),s=t.read_shift(1)&3,a=t.read_shift(1);switch(a){case 0:a="Worksheet";break;case 1:a="Macrosheet";break;case 2:a="Chartsheet";break;case 6:a="VBAModule";break}var i=Lu(t,0,r);return i.length===0&&(i="Sheet1"),{pos:n,hs:s,dt:a,name:i}}function g5(t,e){for(var r=t.l+e,n=t.read_shift(4),s=t.read_shift(4),a=[],i=0;i!=s&&t.l<r;++i)a.push(Q8(t));return a.Count=n,a.Unique=s,a}function v5(t,e){var r={};return r.dsst=t.read_shift(2),t.l+=e-2,r}function x5(t){var e={};e.r=t.read_shift(2),e.c=t.read_shift(2),e.cnt=t.read_shift(2)-e.c;var r=t.read_shift(2);t.l+=4;var n=t.read_shift(1);return t.l+=3,n&7&&(e.level=n&7),n&32&&(e.hidden=!0),n&64&&(e.hpt=r/20),e}function _5(t){var e=n5(t);if(e.type!=2211)throw new Error("Invalid Future Record "+e.type);var r=t.read_shift(4);return r!==0}function y5(t){return t.read_shift(2),t.read_shift(4)}function kw(t,e,r){var n=0;r&&r.biff==2||(n=t.read_shift(2));var s=t.read_shift(2);r&&r.biff==2&&(n=1-(s>>15),s&=32767);var a={Unsynced:n&1,DyZero:(n&2)>>1,ExAsc:(n&4)>>2,ExDsc:(n&8)>>3};return[a,s]}function w5(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2),s=t.read_shift(2),a=t.read_shift(2),i=t.read_shift(2),o=t.read_shift(2),l=t.read_shift(2),c=t.read_shift(2);return{Pos:[e,r],Dim:[n,s],Flags:a,CurTab:i,FirstTab:o,Selected:l,TabRatio:c}}function E5(t,e,r){if(r&&r.biff>=2&&r.biff<5)return{};var n=t.read_shift(2);return{RTL:n&64}}function T5(){}function k5(t,e,r){var n={dyHeight:t.read_shift(2),fl:t.read_shift(2)};switch(r&&r.biff||8){case 2:break;case 3:case 4:t.l+=2;break;default:t.l+=10;break}return n.name=Lu(t,0,r),n}function S5(t){var e=Os(t);return e.isst=t.read_shift(4),e}function A5(t,e,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=t.l+e,s=Os(t);r.biff==2&&t.l++;var a=ju(t,n-t.l,r);return s.val=a,s}function I5(t,e,r){var n=t.read_shift(2),s=lo(t,0,r);return[n,s]}var C5=lo;function Sw(t,e,r){var n=t.l+e,s=r.biff==8||!r.biff?4:2,a=t.read_shift(s),i=t.read_shift(s),o=t.read_shift(2),l=t.read_shift(2);return t.l=n,{s:{r:a,c:o},e:{r:i,c:l}}}function R5(t){var e=t.read_shift(2),r=t.read_shift(2),n=qA(t);return{r:e,c:r,ixfe:n[0],rknum:n[1]}}function N5(t,e){for(var r=t.l+e-2,n=t.read_shift(2),s=t.read_shift(2),a=[];t.l<r;)a.push(qA(t));if(t.l!==r)throw new Error("MulRK read error");var i=t.read_shift(2);if(a.length!=i-s+1)throw new Error("MulRK length mismatch");return{r:n,c:s,C:i,rkrec:a}}function P5(t,e){for(var r=t.l+e-2,n=t.read_shift(2),s=t.read_shift(2),a=[];t.l<r;)a.push(t.read_shift(2));if(t.l!==r)throw new Error("MulBlank read error");var i=t.read_shift(2);if(a.length!=i-s+1)throw new Error("MulBlank length mismatch");return{r:n,c:s,C:i,ixfe:a}}function b5(t,e,r,n){var s={},a=t.read_shift(4),i=t.read_shift(4),o=t.read_shift(4),l=t.read_shift(2);return s.patternType=R8[o>>26],n.cellStyles&&(s.alc=a&7,s.fWrap=a>>3&1,s.alcV=a>>4&7,s.fJustLast=a>>7&1,s.trot=a>>8&255,s.cIndent=a>>16&15,s.fShrinkToFit=a>>20&1,s.iReadOrder=a>>22&2,s.fAtrNum=a>>26&1,s.fAtrFnt=a>>27&1,s.fAtrAlc=a>>28&1,s.fAtrBdr=a>>29&1,s.fAtrPat=a>>30&1,s.fAtrProt=a>>31&1,s.dgLeft=i&15,s.dgRight=i>>4&15,s.dgTop=i>>8&15,s.dgBottom=i>>12&15,s.icvLeft=i>>16&127,s.icvRight=i>>23&127,s.grbitDiag=i>>30&3,s.icvTop=o&127,s.icvBottom=o>>7&127,s.icvDiag=o>>14&127,s.dgDiag=o>>21&15,s.icvFore=l&127,s.icvBack=l>>7&127,s.fsxButton=l>>14&1),s}function D5(t,e,r){var n={};return n.ifnt=t.read_shift(2),n.numFmtId=t.read_shift(2),n.flags=t.read_shift(2),n.fStyle=n.flags>>2&1,e-=6,n.data=b5(t,e,n.fStyle,r),n}function F5(t){t.l+=4;var e=[t.read_shift(2),t.read_shift(2)];if(e[0]!==0&&e[0]--,e[1]!==0&&e[1]--,e[0]>7||e[1]>7)throw new Error("Bad Gutters: "+e.join("|"));return e}function Aw(t,e,r){var n=Os(t);(r.biff==2||e==9)&&++t.l;var s=Y8(t);return n.val=s,n.t=s===!0||s===!1?"b":"e",n}function O5(t,e,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=Os(t),s=Lr(t);return n.val=s,n}var Iw=s5;function M5(t,e,r){var n=t.l+e,s=t.read_shift(2),a=t.read_shift(2);if(r.sbcch=a,a==1025||a==14849)return[a,s];if(a<1||a>255)throw new Error("Unexpected SupBook type: "+a);for(var i=Yi(t,a),o=[];n>t.l;)o.push(ju(t));return[a,s,i,o]}function Cw(t,e,r){var n=t.read_shift(2),s,a={fBuiltIn:n&1,fWantAdvise:n>>>1&1,fWantPict:n>>>2&1,fOle:n>>>3&1,fOleLink:n>>>4&1,cf:n>>>5&1023,fIcon:n>>>15&1};return r.sbcch===14849&&(s=i5(t,e-2,r)),a.body=s||t.read_shift(e-2),typeof s=="string"&&(a.Name=s),a}var L5=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function Rw(t,e,r){var n=t.l+e,s=t.read_shift(2),a=t.read_shift(1),i=t.read_shift(1),o=t.read_shift(r&&r.biff==2?1:2),l=0;(!r||r.biff>=5)&&(r.biff!=5&&(t.l+=2),l=t.read_shift(2),r.biff==5&&(t.l+=2),t.l+=4);var c=Yi(t,i,r);s&32&&(c=L5[c.charCodeAt(0)]);var u=n-t.l;r&&r.biff==2&&--u;var h=n==t.l||o===0||!(u>0)?[]:xU(t,u,r,o);return{chKey:a,Name:c,itab:l,rgce:h}}function QA(t,e,r){if(r.biff<8)return j5(t,e,r);for(var n=[],s=t.l+e,a=t.read_shift(r.biff>8?4:2);a--!==0;)n.push(a5(t,r.biff>8?12:6,r));if(t.l!=s)throw new Error("Bad ExternSheet: "+t.l+" != "+s);return n}function j5(t,e,r){t[t.l+1]==3&&t[t.l]++;var n=Lu(t,e,r);return n.charCodeAt(0)==3?n.slice(1):n}function V5(t,e,r){if(r.biff<8){t.l+=e;return}var n=t.read_shift(2),s=t.read_shift(2),a=Yi(t,n,r),i=Yi(t,s,r);return[a,i]}function U5(t,e,r){var n=XA(t);t.l++;var s=t.read_shift(1);return e-=8,[_U(t,e,r),s,n]}function Nw(t,e,r){var n=o5(t);switch(r.biff){case 2:t.l++,e-=7;break;case 3:case 4:t.l+=2,e-=8;break;default:t.l+=6,e-=12}return[n,gU(t,e,r)]}function B5(t){var e=t.read_shift(4)!==0,r=t.read_shift(4)!==0,n=t.read_shift(4);return[e,r,n]}function z5(t,e,r){if(!(r.biff<8)){var n=t.read_shift(2),s=t.read_shift(2),a=t.read_shift(2),i=t.read_shift(2),o=lo(t,0,r);return r.biff<8&&t.read_shift(1),[{r:n,c:s},o,i,a]}}function $5(t,e,r){return z5(t,e,r)}function W5(t,e){for(var r=[],n=t.read_shift(2);n--;)r.push(Zd(t));return r}function H5(t,e,r){if(r&&r.biff<8)return K5(t,e,r);var n=YA(t),s=f5(t,e-22,n[1]);return{cmo:n,ft:s}}var G5={8:function(t,e){var r=t.l+e;t.l+=10;var n=t.read_shift(2);t.l+=4,t.l+=2,t.l+=2,t.l+=2,t.l+=4;var s=t.read_shift(1);return t.l+=s,t.l=r,{fmt:n}}};function K5(t,e,r){t.l+=4;var n=t.read_shift(2),s=t.read_shift(2),a=t.read_shift(2);t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=6,e-=36;var i=[];return i.push((G5[n]||$r)(t,e,r)),{cmo:[s,n,a],ft:i}}function q5(t,e,r){var n=t.l,s="";try{t.l+=4;var a=(r.lastobj||{cmo:[0,0]}).cmo[1],i;[0,5,7,11,12,14].indexOf(a)==-1?t.l+=6:i=J8(t,6,r);var o=t.read_shift(2);t.read_shift(2),Yt(t,2);var l=t.read_shift(2);t.l+=l;for(var c=1;c<t.lens.length-1;++c){if(t.l-n!=t.lens[c])throw new Error("TxO: bad continue record");var u=t[t.l],h=Yi(t,t.lens[c+1]-t.lens[c]-1);if(s+=h,s.length>=(u?o:2*o))break}if(s.length!==o&&s.length!==o*2)throw new Error("cchText: "+o+" != "+s.length);return t.l=n+e,{t:s}}catch{return t.l=n+e,{t:s}}}function X5(t,e){var r=Zd(t);t.l+=16;var n=r5(t,e-24);return[r,n]}function Y5(t,e){t.read_shift(2);var r=Zd(t),n=t.read_shift((e-10)/2,"dbcs-cont");return n=n.replace(Qr,""),[r,n]}function Q5(t){var e=[0,0],r;return r=t.read_shift(2),e[0]=_w[r]||r,r=t.read_shift(2),e[1]=_w[r]||r,e}function J5(t){for(var e=t.read_shift(2),r=[];e-- >0;)r.push(KA(t));return r}function Z5(t){for(var e=t.read_shift(2),r=[];e-- >0;)r.push(KA(t));return r}function ej(t){t.l+=2;var e={cxfs:0,crc:0};return e.cxfs=t.read_shift(2),e.crc=t.read_shift(4),e}function JA(t,e,r){if(!r.cellStyles)return $r(t,e);var n=r&&r.biff>=12?4:2,s=t.read_shift(n),a=t.read_shift(n),i=t.read_shift(n),o=t.read_shift(n),l=t.read_shift(2);n==2&&(t.l+=2);var c={s,e:a,w:i,ixfe:o,flags:l};return(r.biff>=5||!r.biff)&&(c.level=l>>8&7),c}function tj(t,e){var r={};return e<32||(t.l+=16,r.header=Lr(t),r.footer=Lr(t),t.l+=2),r}function rj(t,e,r){var n={area:!1};if(r.biff!=5)return t.l+=e,n;var s=t.read_shift(1);return t.l+=3,s&16&&(n.area=!0),n}var nj=Os,sj=HA,aj=ju;function ij(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(4),s={fmt:e,env:r,len:n,data:t.slice(t.l,t.l+n)};return t.l+=n,s}function oj(t,e,r){r.biffguess&&r.biff==5&&(r.biff=2);var n=Os(t);++t.l;var s=lo(t,e-7,r);return n.t="str",n.val=s,n}function lj(t){var e=Os(t);++t.l;var r=Lr(t);return e.t="n",e.val=r,e}function cj(t){var e=Os(t);++t.l;var r=t.read_shift(2);return e.t="n",e.val=r,e}function uj(t){var e=t.read_shift(1);return e===0?(t.l++,""):t.read_shift(e,"sbcs-cont")}function fj(t,e){t.l+=6,t.l+=2,t.l+=1,t.l+=3,t.l+=1,t.l+=e-13}function hj(t,e,r){var n=t.l+e,s=Os(t),a=t.read_shift(2),i=Yi(t,a,r);return t.l=n,s.t="str",s.val=i,s}var dj=[2,3,48,49,131,139,140,245],Pw=function(){var t={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},e=Yv({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(o,l){var c=[],u=oi(1);switch(l.type){case"base64":u=ts(An(o));break;case"binary":u=ts(o);break;case"buffer":case"array":u=o;break}xr(u,0);var h=u.read_shift(1),m=!!(h&136),p=!1,x=!1;switch(h){case 2:break;case 3:break;case 48:p=!0,m=!0;break;case 49:p=!0,m=!0;break;case 131:break;case 139:break;case 140:x=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+h.toString(16))}var v=0,w=521;h==2&&(v=u.read_shift(2)),u.l+=3,h!=2&&(v=u.read_shift(4)),v>1048576&&(v=1e6),h!=2&&(w=u.read_shift(2));var k=u.read_shift(2),T=l.codepage||1252;h!=2&&(u.l+=16,u.read_shift(1),u[u.l]!==0&&(T=t[u[u.l]]),u.l+=1,u.l+=2),x&&(u.l+=36);for(var E=[],N={},O=Math.min(u.length,h==2?521:w-10-(p?264:0)),M=x?32:11;u.l<O&&u[u.l]!=13;)switch(N={},N.name=au.utils.decode(T,u.slice(u.l,u.l+M)).replace(/[\u0000\r\n].*$/g,""),u.l+=M,N.type=String.fromCharCode(u.read_shift(1)),h!=2&&!x&&(N.offset=u.read_shift(4)),N.len=u.read_shift(1),h==2&&(N.offset=u.read_shift(2)),N.dec=u.read_shift(1),N.name.length&&E.push(N),h!=2&&(u.l+=x?13:14),N.type){case"B":(!p||N.len!=8)&&l.WTF&&console.log("Skipping "+N.name+":"+N.type);break;case"G":case"P":l.WTF&&console.log("Skipping "+N.name+":"+N.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+N.type)}if(u[u.l]!==13&&(u.l=w-1),u.read_shift(1)!==13)throw new Error("DBF Terminator not found "+u.l+" "+u[u.l]);u.l=w;var g=0,y=0;for(c[0]=[],y=0;y!=E.length;++y)c[0][y]=E[y].name;for(;v-- >0;){if(u[u.l]===42){u.l+=k;continue}for(++u.l,c[++g]=[],y=0,y=0;y!=E.length;++y){var S=u.slice(u.l,u.l+E[y].len);u.l+=E[y].len,xr(S,0);var R=au.utils.decode(T,S);switch(E[y].type){case"C":R.trim().length&&(c[g][y]=R.replace(/\s+$/,""));break;case"D":R.length===8?c[g][y]=new Date(+R.slice(0,4),+R.slice(4,6)-1,+R.slice(6,8)):c[g][y]=R;break;case"F":c[g][y]=parseFloat(R.trim());break;case"+":case"I":c[g][y]=x?S.read_shift(-4,"i")^2147483648:S.read_shift(4,"i");break;case"L":switch(R.trim().toUpperCase()){case"Y":case"T":c[g][y]=!0;break;case"N":case"F":c[g][y]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+R+"|")}break;case"M":if(!m)throw new Error("DBF Unexpected MEMO for type "+h.toString(16));c[g][y]="##MEMO##"+(x?parseInt(R.trim(),10):S.read_shift(4));break;case"N":R=R.replace(/\u0000/g,"").trim(),R&&R!="."&&(c[g][y]=+R||0);break;case"@":c[g][y]=new Date(S.read_shift(-8,"f")-621356832e5);break;case"T":c[g][y]=new Date((S.read_shift(4)-2440588)*864e5+S.read_shift(4));break;case"Y":c[g][y]=S.read_shift(4,"i")/1e4+S.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":c[g][y]=-S.read_shift(-8,"f");break;case"B":if(p&&E[y].len==8){c[g][y]=S.read_shift(8,"f");break}case"G":case"P":S.l+=E[y].len;break;case"0":if(E[y].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+E[y].type)}}}if(h!=2&&u.l<u.length&&u[u.l++]!=26)throw new Error("DBF EOF Marker missing "+(u.l-1)+" of "+u.length+" "+u[u.l-1].toString(16));return l&&l.sheetRows&&(c=c.slice(0,l.sheetRows)),l.DBF=E,c}function n(o,l){var c=l||{};c.dateNF||(c.dateNF="yyyymmdd");var u=Sl(r(o,c),c);return u["!cols"]=c.DBF.map(function(h){return{wch:h.len,DBF:h}}),delete c.DBF,u}function s(o,l){try{return pi(n(o,l),l)}catch(c){if(l&&l.WTF)throw c}return{SheetNames:[],Sheets:{}}}var a={B:8,C:250,L:1,D:8,"?":0,"":0};function i(o,l){var c=l||{};if(+c.codepage>=0&&ns(+c.codepage),c.type=="string")throw new Error("Cannot write DBF to JS string");var u=Rp(),h=Vp(o,{header:1,raw:!0,cellDates:!0}),m=h[0],p=h.slice(1),x=o["!cols"]||[],v=0,w=0,k=0,T=1;for(v=0;v<m.length;++v){if(((x[v]||{}).DBF||{}).name){m[v]=x[v].DBF.name,++k;continue}if(m[v]!=null){if(++k,typeof m[v]=="number"&&(m[v]=m[v].toString(10)),typeof m[v]!="string")throw new Error("DBF Invalid column name "+m[v]+" |"+typeof m[v]+"|");if(m.indexOf(m[v])!==v){for(w=0;w<1024;++w)if(m.indexOf(m[v]+"_"+w)==-1){m[v]+="_"+w;break}}}}var E=Bt(o["!ref"]),N=[],O=[],M=[];for(v=0;v<=E.e.c-E.s.c;++v){var g="",y="",S=0,R=[];for(w=0;w<p.length;++w)p[w][v]!=null&&R.push(p[w][v]);if(R.length==0||m[v]==null){N[v]="?";continue}for(w=0;w<R.length;++w){switch(typeof R[w]){case"number":y="B";break;case"string":y="C";break;case"boolean":y="L";break;case"object":y=R[w]instanceof Date?"D":"C";break;default:y="C"}S=Math.max(S,String(R[w]).length),g=g&&g!=y?"C":y}S>250&&(S=250),y=((x[v]||{}).DBF||{}).type,y=="C"&&x[v].DBF.len>S&&(S=x[v].DBF.len),g=="B"&&y=="N"&&(g="N",M[v]=x[v].DBF.dec,S=x[v].DBF.len),O[v]=g=="C"||y=="N"?S:a[g]||0,T+=O[v],N[v]=g}var P=u.next(32);for(P.write_shift(4,318902576),P.write_shift(4,p.length),P.write_shift(2,296+32*k),P.write_shift(2,T),v=0;v<4;++v)P.write_shift(4,0);for(P.write_shift(4,0|(+e[QS]||3)<<8),v=0,w=0;v<m.length;++v)if(m[v]!=null){var b=u.next(32),C=(m[v].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);b.write_shift(1,C,"sbcs"),b.write_shift(1,N[v]=="?"?"C":N[v],"sbcs"),b.write_shift(4,w),b.write_shift(1,O[v]||a[N[v]]||0),b.write_shift(1,M[v]||0),b.write_shift(1,2),b.write_shift(4,0),b.write_shift(1,0),b.write_shift(4,0),b.write_shift(4,0),w+=O[v]||a[N[v]]||0}var oe=u.next(264);for(oe.write_shift(4,13),v=0;v<65;++v)oe.write_shift(4,0);for(v=0;v<p.length;++v){var ae=u.next(T);for(ae.write_shift(1,0),w=0;w<m.length;++w)if(m[w]!=null)switch(N[w]){case"L":ae.write_shift(1,p[v][w]==null?63:p[v][w]?84:70);break;case"B":ae.write_shift(8,p[v][w]||0,"f");break;case"N":var he="0";for(typeof p[v][w]=="number"&&(he=p[v][w].toFixed(M[w]||0)),k=0;k<O[w]-he.length;++k)ae.write_shift(1,32);ae.write_shift(1,he,"sbcs");break;case"D":p[v][w]?(ae.write_shift(4,("0000"+p[v][w].getFullYear()).slice(-4),"sbcs"),ae.write_shift(2,("00"+(p[v][w].getMonth()+1)).slice(-2),"sbcs"),ae.write_shift(2,("00"+p[v][w].getDate()).slice(-2),"sbcs")):ae.write_shift(8,"00000000","sbcs");break;case"C":var me=String(p[v][w]!=null?p[v][w]:"").slice(0,O[w]);for(ae.write_shift(1,me,"sbcs"),k=0;k<O[w]-me.length;++k)ae.write_shift(1,32);break}}return u.next(1).write_shift(1,26),u.end()}return{to_workbook:s,to_sheet:n,from_sheet:i}}(),mj=function(){var t={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},e=new RegExp("\x1BN("+Ns(t).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(m,p){var x=t[p];return typeof x=="number"?Ky(x):x},n=function(m,p,x){var v=p.charCodeAt(0)-32<<4|x.charCodeAt(0)-48;return v==59?m:Ky(v)};t["|"]=254;function s(m,p){switch(p.type){case"base64":return a(An(m),p);case"binary":return a(m,p);case"buffer":return a(Qe&&Buffer.isBuffer(m)?m.toString("binary"):so(m),p);case"array":return a(Xi(m),p)}throw new Error("Unrecognized type "+p.type)}function a(m,p){var x=m.split(/[\n\r]+/),v=-1,w=-1,k=0,T=0,E=[],N=[],O=null,M={},g=[],y=[],S=[],R=0,P;for(+p.codepage>=0&&ns(+p.codepage);k!==x.length;++k){R=0;var b=x[k].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(e,r),C=b.replace(/;;/g,"\0").split(";").map(function(q){return q.replace(/\u0000/g,";")}),oe=C[0],ae;if(b.length>0)switch(oe){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":C[1].charAt(0)=="P"&&N.push(b.slice(3).replace(/;;/g,";"));break;case"C":var he=!1,me=!1,ee=!1,H=!1,ue=-1,de=-1;for(T=1;T<C.length;++T)switch(C[T].charAt(0)){case"A":break;case"X":w=parseInt(C[T].slice(1))-1,me=!0;break;case"Y":for(v=parseInt(C[T].slice(1))-1,me||(w=0),P=E.length;P<=v;++P)E[P]=[];break;case"K":ae=C[T].slice(1),ae.charAt(0)==='"'?ae=ae.slice(1,ae.length-1):ae==="TRUE"?ae=!0:ae==="FALSE"?ae=!1:isNaN(ls(ae))?isNaN(dl(ae).getDate())||(ae=dr(ae)):(ae=ls(ae),O!==null&&Tl(O)&&(ae=Jd(ae))),he=!0;break;case"E":H=!0;var B=Ko(C[T].slice(1),{r:v,c:w});E[v][w]=[E[v][w],B];break;case"S":ee=!0,E[v][w]=[E[v][w],"S5S"];break;case"G":break;case"R":ue=parseInt(C[T].slice(1))-1;break;case"C":de=parseInt(C[T].slice(1))-1;break;default:if(p&&p.WTF)throw new Error("SYLK bad record "+b)}if(he&&(E[v][w]&&E[v][w].length==2?E[v][w][0]=ae:E[v][w]=ae,O=null),ee){if(H)throw new Error("SYLK shared formula cannot have own formula");var K=ue>-1&&E[ue][de];if(!K||!K[1])throw new Error("SYLK shared formula cannot find base");E[v][w][1]=lI(K[1],{r:v-ue,c:w-de})}break;case"F":var X=0;for(T=1;T<C.length;++T)switch(C[T].charAt(0)){case"X":w=parseInt(C[T].slice(1))-1,++X;break;case"Y":for(v=parseInt(C[T].slice(1))-1,P=E.length;P<=v;++P)E[P]=[];break;case"M":R=parseInt(C[T].slice(1))/20;break;case"F":break;case"G":break;case"P":O=N[parseInt(C[T].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(S=C[T].slice(1).split(" "),P=parseInt(S[0],10);P<=parseInt(S[1],10);++P)R=parseInt(S[2],10),y[P-1]=R===0?{hidden:!0}:{wch:R},ml(y[P-1]);break;case"C":w=parseInt(C[T].slice(1))-1,y[w]||(y[w]={});break;case"R":v=parseInt(C[T].slice(1))-1,g[v]||(g[v]={}),R>0?(g[v].hpt=R,g[v].hpx=fu(R)):R===0&&(g[v].hidden=!0);break;default:if(p&&p.WTF)throw new Error("SYLK bad record "+b)}X<1&&(O=null);break;default:if(p&&p.WTF)throw new Error("SYLK bad record "+b)}}return g.length>0&&(M["!rows"]=g),y.length>0&&(M["!cols"]=y),p&&p.sheetRows&&(E=E.slice(0,p.sheetRows)),[E,M]}function i(m,p){var x=s(m,p),v=x[0],w=x[1],k=Sl(v,p);return Ns(w).forEach(function(T){k[T]=w[T]}),k}function o(m,p){return pi(i(m,p),p)}function l(m,p,x,v){var w="C;Y"+(x+1)+";X"+(v+1)+";K";switch(m.t){case"n":w+=m.v||0,m.f&&!m.F&&(w+=";E"+eV(m.f,{r:x,c:v}));break;case"b":w+=m.v?"TRUE":"FALSE";break;case"e":w+=m.w||m.v;break;case"d":w+='"'+(m.w||m.v)+'"';break;case"s":w+='"'+m.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return w}function c(m,p){p.forEach(function(x,v){var w="F;W"+(v+1)+" "+(v+1)+" ";x.hidden?w+="0":(typeof x.width=="number"&&!x.wpx&&(x.wpx=ad(x.width)),typeof x.wpx=="number"&&!x.wch&&(x.wch=id(x.wpx)),typeof x.wch=="number"&&(w+=Math.round(x.wch))),w.charAt(w.length-1)!=" "&&m.push(w)})}function u(m,p){p.forEach(function(x,v){var w="F;";x.hidden?w+="M0;":x.hpt?w+="M"+20*x.hpt+";":x.hpx&&(w+="M"+20*aI(x.hpx)+";"),w.length>2&&m.push(w+"R"+(v+1))})}function h(m,p){var x=["ID;PWXL;N;E"],v=[],w=Bt(m["!ref"]),k,T=Array.isArray(m),E=`\r
`;x.push("P;PGeneral"),x.push("F;P0;DG0G8;M255"),m["!cols"]&&c(x,m["!cols"]),m["!rows"]&&u(x,m["!rows"]),x.push("B;Y"+(w.e.r-w.s.r+1)+";X"+(w.e.c-w.s.c+1)+";D"+[w.s.c,w.s.r,w.e.c,w.e.r].join(" "));for(var N=w.s.r;N<=w.e.r;++N)for(var O=w.s.c;O<=w.e.c;++O){var M=Ue({r:N,c:O});k=T?(m[N]||[])[O]:m[M],!(!k||k.v==null&&(!k.f||k.F))&&v.push(l(k,m,N,O))}return x.join(E)+E+v.join(E)+E+"E"+E}return{to_workbook:o,to_sheet:i,from_sheet:h}}(),pj=function(){function t(a,i){switch(i.type){case"base64":return e(An(a),i);case"binary":return e(a,i);case"buffer":return e(Qe&&Buffer.isBuffer(a)?a.toString("binary"):so(a),i);case"array":return e(Xi(a),i)}throw new Error("Unrecognized type "+i.type)}function e(a,i){for(var o=a.split(`
`),l=-1,c=-1,u=0,h=[];u!==o.length;++u){if(o[u].trim()==="BOT"){h[++l]=[],c=0;continue}if(!(l<0)){var m=o[u].trim().split(","),p=m[0],x=m[1];++u;for(var v=o[u]||"";(v.match(/["]/g)||[]).length&1&&u<o.length-1;)v+=`
`+o[++u];switch(v=v.trim(),+p){case-1:if(v==="BOT"){h[++l]=[],c=0;continue}else if(v!=="EOD")throw new Error("Unrecognized DIF special command "+v);break;case 0:v==="TRUE"?h[l][c]=!0:v==="FALSE"?h[l][c]=!1:isNaN(ls(x))?isNaN(dl(x).getDate())?h[l][c]=x:h[l][c]=dr(x):h[l][c]=ls(x),++c;break;case 1:v=v.slice(1,v.length-1),v=v.replace(/""/g,'"'),v&&v.match(/^=".*"$/)&&(v=v.slice(2,-1)),h[l][c++]=v!==""?v:null;break}if(v==="EOD")break}}return i&&i.sheetRows&&(h=h.slice(0,i.sheetRows)),h}function r(a,i){return Sl(t(a,i),i)}function n(a,i){return pi(r(a,i),i)}var s=function(){var a=function(l,c,u,h,m){l.push(c),l.push(u+","+h),l.push('"'+m.replace(/"/g,'""')+'"')},i=function(l,c,u,h){l.push(c+","+u),l.push(c==1?'"'+h.replace(/"/g,'""')+'"':h)};return function(l){var c=[],u=Bt(l["!ref"]),h,m=Array.isArray(l);a(c,"TABLE",0,1,"sheetjs"),a(c,"VECTORS",0,u.e.r-u.s.r+1,""),a(c,"TUPLES",0,u.e.c-u.s.c+1,""),a(c,"DATA",0,0,"");for(var p=u.s.r;p<=u.e.r;++p){i(c,-1,0,"BOT");for(var x=u.s.c;x<=u.e.c;++x){var v=Ue({r:p,c:x});if(h=m?(l[p]||[])[x]:l[v],!h){i(c,1,0,"");continue}switch(h.t){case"n":var w=h.w;!w&&h.v!=null&&(w=h.v),w==null?h.f&&!h.F?i(c,1,0,"="+h.f):i(c,1,0,""):i(c,0,w,"V");break;case"b":i(c,0,h.v?1:0,h.v?"TRUE":"FALSE");break;case"s":i(c,1,0,isNaN(h.v)?h.v:'="'+h.v+'"');break;case"d":h.w||(h.w=$n(h.z||ze[14],Jr(dr(h.v)))),i(c,0,h.w,"V");break;default:i(c,1,0,"")}}}i(c,-1,0,"EOD");var k=`\r
`,T=c.join(k);return T}}();return{to_workbook:n,to_sheet:r,from_sheet:s}}(),gj=function(){function t(h){return h.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function e(h){return h.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(h,m){for(var p=h.split(`
`),x=-1,v=-1,w=0,k=[];w!==p.length;++w){var T=p[w].trim().split(":");if(T[0]==="cell"){var E=qr(T[1]);if(k.length<=E.r)for(x=k.length;x<=E.r;++x)k[x]||(k[x]=[]);switch(x=E.r,v=E.c,T[2]){case"t":k[x][v]=t(T[3]);break;case"v":k[x][v]=+T[3];break;case"vtf":var N=T[T.length-1];case"vtc":switch(T[3]){case"nl":k[x][v]=!!+T[4];break;default:k[x][v]=+T[4];break}T[2]=="vtf"&&(k[x][v]=[k[x][v],N])}}}return m&&m.sheetRows&&(k=k.slice(0,m.sheetRows)),k}function n(h,m){return Sl(r(h,m),m)}function s(h,m){return pi(n(h,m),m)}var a=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),i=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,o=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),l="--SocialCalcSpreadsheetControlSave--";function c(h){if(!h||!h["!ref"])return"";for(var m=[],p=[],x,v="",w=kl(h["!ref"]),k=Array.isArray(h),T=w.s.r;T<=w.e.r;++T)for(var E=w.s.c;E<=w.e.c;++E)if(v=Ue({r:T,c:E}),x=k?(h[T]||[])[E]:h[v],!(!x||x.v==null||x.t==="z")){switch(p=["cell",v,"t"],x.t){case"s":case"str":p.push(e(x.v));break;case"n":x.f?(p[2]="vtf",p[3]="n",p[4]=x.v,p[5]=e(x.f)):(p[2]="v",p[3]=x.v);break;case"b":p[2]="vt"+(x.f?"f":"c"),p[3]="nl",p[4]=x.v?"1":"0",p[5]=e(x.f||(x.v?"TRUE":"FALSE"));break;case"d":var N=Jr(dr(x.v));p[2]="vtc",p[3]="nd",p[4]=""+N,p[5]=x.w||$n(x.z||ze[14],N);break;case"e":continue}m.push(p.join(":"))}return m.push("sheet:c:"+(w.e.c-w.s.c+1)+":r:"+(w.e.r-w.s.r+1)+":tvf:1"),m.push("valueformat:1:text-wiki"),m.join(`
`)}function u(h){return[a,i,o,i,c(h),l].join(`
`)}return{to_workbook:s,to_sheet:n,from_sheet:u}}(),cu=function(){function t(u,h,m,p,x){x.raw?h[m][p]=u:u===""||(u==="TRUE"?h[m][p]=!0:u==="FALSE"?h[m][p]=!1:isNaN(ls(u))?isNaN(dl(u).getDate())?h[m][p]=u:h[m][p]=dr(u):h[m][p]=ls(u))}function e(u,h){var m=h||{},p=[];if(!u||u.length===0)return p;for(var x=u.split(/[\r\n]/),v=x.length-1;v>=0&&x[v].length===0;)--v;for(var w=10,k=0,T=0;T<=v;++T)k=x[T].indexOf(" "),k==-1?k=x[T].length:k++,w=Math.max(w,k);for(T=0;T<=v;++T){p[T]=[];var E=0;for(t(x[T].slice(0,w).trim(),p,T,E,m),E=1;E<=(x[T].length-w)/10+1;++E)t(x[T].slice(w+(E-1)*10,w+E*10).trim(),p,T,E,m)}return m.sheetRows&&(p=p.slice(0,m.sheetRows)),p}var r={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function s(u){for(var h={},m=!1,p=0,x=0;p<u.length;++p)(x=u.charCodeAt(p))==34?m=!m:!m&&x in r&&(h[x]=(h[x]||0)+1);x=[];for(p in h)Object.prototype.hasOwnProperty.call(h,p)&&x.push([h[p],p]);if(!x.length){h=n;for(p in h)Object.prototype.hasOwnProperty.call(h,p)&&x.push([h[p],p])}return x.sort(function(v,w){return v[0]-w[0]||n[v[1]]-n[w[1]]}),r[x.pop()[1]]||44}function a(u,h){var m=h||{},p="",x=m.dense?[]:{},v={s:{c:0,r:0},e:{c:0,r:0}};u.slice(0,4)=="sep="?u.charCodeAt(5)==13&&u.charCodeAt(6)==10?(p=u.charAt(4),u=u.slice(7)):u.charCodeAt(5)==13||u.charCodeAt(5)==10?(p=u.charAt(4),u=u.slice(6)):p=s(u.slice(0,1024)):m&&m.FS?p=m.FS:p=s(u.slice(0,1024));var w=0,k=0,T=0,E=0,N=0,O=p.charCodeAt(0),M=!1,g=0,y=u.charCodeAt(0);u=u.replace(/\r\n/mg,`
`);var S=m.dateNF!=null?I6(m.dateNF):null;function R(){var P=u.slice(E,N),b={};if(P.charAt(0)=='"'&&P.charAt(P.length-1)=='"'&&(P=P.slice(1,-1).replace(/""/g,'"')),P.length===0)b.t="z";else if(m.raw)b.t="s",b.v=P;else if(P.trim().length===0)b.t="s",b.v=P;else if(P.charCodeAt(0)==61)P.charCodeAt(1)==34&&P.charCodeAt(P.length-1)==34?(b.t="s",b.v=P.slice(2,-1).replace(/""/g,'"')):rV(P)?(b.t="n",b.f=P.slice(1)):(b.t="s",b.v=P);else if(P=="TRUE")b.t="b",b.v=!0;else if(P=="FALSE")b.t="b",b.v=!1;else if(!isNaN(T=ls(P)))b.t="n",m.cellText!==!1&&(b.w=P),b.v=T;else if(!isNaN(dl(P).getDate())||S&&P.match(S)){b.z=m.dateNF||ze[14];var C=0;S&&P.match(S)&&(P=C6(P,m.dateNF,P.match(S)||[]),C=1),m.cellDates?(b.t="d",b.v=dr(P,C)):(b.t="n",b.v=Jr(dr(P,C))),m.cellText!==!1&&(b.w=$n(b.z,b.v instanceof Date?Jr(b.v):b.v)),m.cellNF||delete b.z}else b.t="s",b.v=P;if(b.t=="z"||(m.dense?(x[w]||(x[w]=[]),x[w][k]=b):x[Ue({c:k,r:w})]=b),E=N+1,y=u.charCodeAt(E),v.e.c<k&&(v.e.c=k),v.e.r<w&&(v.e.r=w),g==O)++k;else if(k=0,++w,m.sheetRows&&m.sheetRows<=w)return!0}e:for(;N<u.length;++N)switch(g=u.charCodeAt(N)){case 34:y===34&&(M=!M);break;case O:case 10:case 13:if(!M&&R())break e;break}return N-E>0&&R(),x["!ref"]=rt(v),x}function i(u,h){return!(h&&h.PRN)||h.FS||u.slice(0,4)=="sep="||u.indexOf("	")>=0||u.indexOf(",")>=0||u.indexOf(";")>=0?a(u,h):Sl(e(u,h),h)}function o(u,h){var m="",p=h.type=="string"?[0,0,0,0]:px(u,h);switch(h.type){case"base64":m=An(u);break;case"binary":m=u;break;case"buffer":h.codepage==65001?m=u.toString("utf8"):h.codepage&&typeof au<"u"||(m=Qe&&Buffer.isBuffer(u)?u.toString("binary"):so(u));break;case"array":m=Xi(u);break;case"string":m=u;break;default:throw new Error("Unrecognized type "+h.type)}return p[0]==239&&p[1]==187&&p[2]==191?m=Et(m.slice(3)):h.type!="string"&&h.type!="buffer"&&h.codepage==65001?m=Et(m):h.type=="binary"&&typeof au<"u",m.slice(0,19)=="socialcalc:version:"?gj.to_sheet(h.type=="string"?m:Et(m),h):i(m,h)}function l(u,h){return pi(o(u,h),h)}function c(u){for(var h=[],m=Bt(u["!ref"]),p,x=Array.isArray(u),v=m.s.r;v<=m.e.r;++v){for(var w=[],k=m.s.c;k<=m.e.c;++k){var T=Ue({r:v,c:k});if(p=x?(u[v]||[])[k]:u[T],!p||p.v==null){w.push("          ");continue}for(var E=(p.w||(ga(p),p.w)||"").slice(0,10);E.length<10;)E+=" ";w.push(E+(k===0?" ":""))}h.push(w.join(""))}return h.join(`
`)}return{to_workbook:l,to_sheet:o,from_sheet:c}}();function vj(t,e){var r=e||{},n=!!r.WTF;r.WTF=!0;try{var s=mj.to_workbook(t,r);return r.WTF=n,s}catch(a){if(r.WTF=n,!a.message.match(/SYLK bad record ID/)&&n)throw a;return cu.to_workbook(t,e)}}var Ac=function(){function t(B,K,X){if(B){xr(B,B.l||0);for(var q=X.Enum||ue;B.l<B.length;){var le=B.read_shift(2),_e=q[le]||q[65535],Ce=B.read_shift(2),Te=B.l+Ce,xe=_e.f&&_e.f(B,Ce,X);if(B.l=Te,K(xe,_e,le))return}}}function e(B,K){switch(K.type){case"base64":return r(ts(An(B)),K);case"binary":return r(ts(B),K);case"buffer":case"array":return r(B,K)}throw"Unsupported type "+K.type}function r(B,K){if(!B)return B;var X=K||{},q=X.dense?[]:{},le="Sheet1",_e="",Ce=0,Te={},xe=[],$e=[],z={s:{r:0,c:0},e:{r:0,c:0}},ot=X.sheetRows||0;if(B[2]==0&&(B[3]==8||B[3]==9)&&B.length>=16&&B[14]==5&&B[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(B[2]==2)X.Enum=ue,t(B,function(Ae,Tt,or){switch(or){case 0:X.vers=Ae,Ae>=4096&&(X.qpro=!0);break;case 6:z=Ae;break;case 204:Ae&&(_e=Ae);break;case 222:_e=Ae;break;case 15:case 51:X.qpro||(Ae[1].v=Ae[1].v.slice(1));case 13:case 14:case 16:or==14&&(Ae[2]&112)==112&&(Ae[2]&15)>1&&(Ae[2]&15)<15&&(Ae[1].z=X.dateNF||ze[14],X.cellDates&&(Ae[1].t="d",Ae[1].v=Jd(Ae[1].v))),X.qpro&&Ae[3]>Ce&&(q["!ref"]=rt(z),Te[le]=q,xe.push(le),q=X.dense?[]:{},z={s:{r:0,c:0},e:{r:0,c:0}},Ce=Ae[3],le=_e||"Sheet"+(Ce+1),_e="");var Ar=X.dense?(q[Ae[0].r]||[])[Ae[0].c]:q[Ue(Ae[0])];if(Ar){Ar.t=Ae[1].t,Ar.v=Ae[1].v,Ae[1].z!=null&&(Ar.z=Ae[1].z),Ae[1].f!=null&&(Ar.f=Ae[1].f);break}X.dense?(q[Ae[0].r]||(q[Ae[0].r]=[]),q[Ae[0].r][Ae[0].c]=Ae[1]):q[Ue(Ae[0])]=Ae[1];break}},X);else if(B[2]==26||B[2]==14)X.Enum=de,B[2]==14&&(X.qpro=!0,B.l=0),t(B,function(Ae,Tt,or){switch(or){case 204:le=Ae;break;case 22:Ae[1].v=Ae[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(Ae[3]>Ce&&(q["!ref"]=rt(z),Te[le]=q,xe.push(le),q=X.dense?[]:{},z={s:{r:0,c:0},e:{r:0,c:0}},Ce=Ae[3],le="Sheet"+(Ce+1)),ot>0&&Ae[0].r>=ot)break;X.dense?(q[Ae[0].r]||(q[Ae[0].r]=[]),q[Ae[0].r][Ae[0].c]=Ae[1]):q[Ue(Ae[0])]=Ae[1],z.e.c<Ae[0].c&&(z.e.c=Ae[0].c),z.e.r<Ae[0].r&&(z.e.r=Ae[0].r);break;case 27:Ae[14e3]&&($e[Ae[14e3][0]]=Ae[14e3][1]);break;case 1537:$e[Ae[0]]=Ae[1],Ae[0]==Ce&&(le=Ae[1]);break}},X);else throw new Error("Unrecognized LOTUS BOF "+B[2]);if(q["!ref"]=rt(z),Te[_e||le]=q,xe.push(_e||le),!$e.length)return{SheetNames:xe,Sheets:Te};for(var He={},nt=[],Fe=0;Fe<$e.length;++Fe)Te[xe[Fe]]?(nt.push($e[Fe]||xe[Fe]),He[$e[Fe]]=Te[$e[Fe]]||Te[xe[Fe]]):(nt.push($e[Fe]),He[$e[Fe]]={"!ref":"A1"});return{SheetNames:nt,Sheets:He}}function n(B,K){var X=K||{};if(+X.codepage>=0&&ns(+X.codepage),X.type=="string")throw new Error("Cannot write WK1 to JS string");var q=Rp(),le=Bt(B["!ref"]),_e=Array.isArray(B),Ce=[];Xn(q,0,a(1030)),Xn(q,6,l(le));for(var Te=Math.min(le.e.r,8191),xe=le.s.r;xe<=Te;++xe)for(var $e=Tr(xe),z=le.s.c;z<=le.e.c;++z){xe===le.s.r&&(Ce[z]=sr(z));var ot=Ce[z]+$e,He=_e?(B[xe]||[])[z]:B[ot];if(!(!He||He.t=="z"))if(He.t=="n")(He.v|0)==He.v&&He.v>=-32768&&He.v<=32767?Xn(q,13,p(xe,z,He.v)):Xn(q,14,v(xe,z,He.v));else{var nt=ga(He);Xn(q,15,h(xe,z,nt.slice(0,239)))}}return Xn(q,1),q.end()}function s(B,K){var X=K||{};if(+X.codepage>=0&&ns(+X.codepage),X.type=="string")throw new Error("Cannot write WK3 to JS string");var q=Rp();Xn(q,0,i(B));for(var le=0,_e=0;le<B.SheetNames.length;++le)(B.Sheets[B.SheetNames[le]]||{})["!ref"]&&Xn(q,27,H(B.SheetNames[le],_e++));var Ce=0;for(le=0;le<B.SheetNames.length;++le){var Te=B.Sheets[B.SheetNames[le]];if(!(!Te||!Te["!ref"])){for(var xe=Bt(Te["!ref"]),$e=Array.isArray(Te),z=[],ot=Math.min(xe.e.r,8191),He=xe.s.r;He<=ot;++He)for(var nt=Tr(He),Fe=xe.s.c;Fe<=xe.e.c;++Fe){He===xe.s.r&&(z[Fe]=sr(Fe));var Ae=z[Fe]+nt,Tt=$e?(Te[He]||[])[Fe]:Te[Ae];if(!(!Tt||Tt.t=="z"))if(Tt.t=="n")Xn(q,23,R(He,Fe,Ce,Tt.v));else{var or=ga(Tt);Xn(q,22,g(He,Fe,Ce,or.slice(0,239)))}}++Ce}}return Xn(q,1),q.end()}function a(B){var K=tr(2);return K.write_shift(2,B),K}function i(B){var K=tr(26);K.write_shift(2,4096),K.write_shift(2,4),K.write_shift(4,0);for(var X=0,q=0,le=0,_e=0;_e<B.SheetNames.length;++_e){var Ce=B.SheetNames[_e],Te=B.Sheets[Ce];if(!(!Te||!Te["!ref"])){++le;var xe=kl(Te["!ref"]);X<xe.e.r&&(X=xe.e.r),q<xe.e.c&&(q=xe.e.c)}}return X>8191&&(X=8191),K.write_shift(2,X),K.write_shift(1,le),K.write_shift(1,q),K.write_shift(2,0),K.write_shift(2,0),K.write_shift(1,1),K.write_shift(1,2),K.write_shift(4,0),K.write_shift(4,0),K}function o(B,K,X){var q={s:{c:0,r:0},e:{c:0,r:0}};return K==8&&X.qpro?(q.s.c=B.read_shift(1),B.l++,q.s.r=B.read_shift(2),q.e.c=B.read_shift(1),B.l++,q.e.r=B.read_shift(2),q):(q.s.c=B.read_shift(2),q.s.r=B.read_shift(2),K==12&&X.qpro&&(B.l+=2),q.e.c=B.read_shift(2),q.e.r=B.read_shift(2),K==12&&X.qpro&&(B.l+=2),q.s.c==65535&&(q.s.c=q.e.c=q.s.r=q.e.r=0),q)}function l(B){var K=tr(8);return K.write_shift(2,B.s.c),K.write_shift(2,B.s.r),K.write_shift(2,B.e.c),K.write_shift(2,B.e.r),K}function c(B,K,X){var q=[{c:0,r:0},{t:"n",v:0},0,0];return X.qpro&&X.vers!=20768?(q[0].c=B.read_shift(1),q[3]=B.read_shift(1),q[0].r=B.read_shift(2),B.l+=2):(q[2]=B.read_shift(1),q[0].c=B.read_shift(2),q[0].r=B.read_shift(2)),q}function u(B,K,X){var q=B.l+K,le=c(B,K,X);if(le[1].t="s",X.vers==20768){B.l++;var _e=B.read_shift(1);return le[1].v=B.read_shift(_e,"utf8"),le}return X.qpro&&B.l++,le[1].v=B.read_shift(q-B.l,"cstr"),le}function h(B,K,X){var q=tr(7+X.length);q.write_shift(1,255),q.write_shift(2,K),q.write_shift(2,B),q.write_shift(1,39);for(var le=0;le<q.length;++le){var _e=X.charCodeAt(le);q.write_shift(1,_e>=128?95:_e)}return q.write_shift(1,0),q}function m(B,K,X){var q=c(B,K,X);return q[1].v=B.read_shift(2,"i"),q}function p(B,K,X){var q=tr(7);return q.write_shift(1,255),q.write_shift(2,K),q.write_shift(2,B),q.write_shift(2,X,"i"),q}function x(B,K,X){var q=c(B,K,X);return q[1].v=B.read_shift(8,"f"),q}function v(B,K,X){var q=tr(13);return q.write_shift(1,255),q.write_shift(2,K),q.write_shift(2,B),q.write_shift(8,X,"f"),q}function w(B,K,X){var q=B.l+K,le=c(B,K,X);if(le[1].v=B.read_shift(8,"f"),X.qpro)B.l=q;else{var _e=B.read_shift(2);N(B.slice(B.l,B.l+_e),le),B.l+=_e}return le}function k(B,K,X){var q=K&32768;return K&=-32769,K=(q?B:0)+(K>=8192?K-16384:K),(q?"":"$")+(X?sr(K):Tr(K))}var T={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},E=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function N(B,K){xr(B,0);for(var X=[],q=0,le="",_e="",Ce="",Te="";B.l<B.length;){var xe=B[B.l++];switch(xe){case 0:X.push(B.read_shift(8,"f"));break;case 1:_e=k(K[0].c,B.read_shift(2),!0),le=k(K[0].r,B.read_shift(2),!1),X.push(_e+le);break;case 2:{var $e=k(K[0].c,B.read_shift(2),!0),z=k(K[0].r,B.read_shift(2),!1);_e=k(K[0].c,B.read_shift(2),!0),le=k(K[0].r,B.read_shift(2),!1),X.push($e+z+":"+_e+le)}break;case 3:if(B.l<B.length){console.error("WK1 premature formula end");return}break;case 4:X.push("("+X.pop()+")");break;case 5:X.push(B.read_shift(2));break;case 6:{for(var ot="";xe=B[B.l++];)ot+=String.fromCharCode(xe);X.push('"'+ot.replace(/"/g,'""')+'"')}break;case 8:X.push("-"+X.pop());break;case 23:X.push("+"+X.pop());break;case 22:X.push("NOT("+X.pop()+")");break;case 20:case 21:Te=X.pop(),Ce=X.pop(),X.push(["AND","OR"][xe-20]+"("+Ce+","+Te+")");break;default:if(xe<32&&E[xe])Te=X.pop(),Ce=X.pop(),X.push(Ce+E[xe]+Te);else if(T[xe]){if(q=T[xe][1],q==69&&(q=B[B.l++]),q>X.length){console.error("WK1 bad formula parse 0x"+xe.toString(16)+":|"+X.join("|")+"|");return}var He=X.slice(-q);X.length-=q,X.push(T[xe][0]+"("+He.join(",")+")")}else return xe<=7?console.error("WK1 invalid opcode "+xe.toString(16)):xe<=24?console.error("WK1 unsupported op "+xe.toString(16)):xe<=30?console.error("WK1 invalid opcode "+xe.toString(16)):xe<=115?console.error("WK1 unsupported function opcode "+xe.toString(16)):console.error("WK1 unrecognized opcode "+xe.toString(16))}}X.length==1?K[1].f=""+X[0]:console.error("WK1 bad formula parse |"+X.join("|")+"|")}function O(B){var K=[{c:0,r:0},{t:"n",v:0},0];return K[0].r=B.read_shift(2),K[3]=B[B.l++],K[0].c=B[B.l++],K}function M(B,K){var X=O(B);return X[1].t="s",X[1].v=B.read_shift(K-4,"cstr"),X}function g(B,K,X,q){var le=tr(6+q.length);le.write_shift(2,B),le.write_shift(1,X),le.write_shift(1,K),le.write_shift(1,39);for(var _e=0;_e<q.length;++_e){var Ce=q.charCodeAt(_e);le.write_shift(1,Ce>=128?95:Ce)}return le.write_shift(1,0),le}function y(B,K){var X=O(B);X[1].v=B.read_shift(2);var q=X[1].v>>1;if(X[1].v&1)switch(q&7){case 0:q=(q>>3)*5e3;break;case 1:q=(q>>3)*500;break;case 2:q=(q>>3)/20;break;case 3:q=(q>>3)/200;break;case 4:q=(q>>3)/2e3;break;case 5:q=(q>>3)/2e4;break;case 6:q=(q>>3)/16;break;case 7:q=(q>>3)/64;break}return X[1].v=q,X}function S(B,K){var X=O(B),q=B.read_shift(4),le=B.read_shift(4),_e=B.read_shift(2);if(_e==65535)return q===0&&le===3221225472?(X[1].t="e",X[1].v=15):q===0&&le===3489660928?(X[1].t="e",X[1].v=42):X[1].v=0,X;var Ce=_e&32768;return _e=(_e&32767)-16446,X[1].v=(1-Ce*2)*(le*Math.pow(2,_e+32)+q*Math.pow(2,_e)),X}function R(B,K,X,q){var le=tr(14);if(le.write_shift(2,B),le.write_shift(1,X),le.write_shift(1,K),q==0)return le.write_shift(4,0),le.write_shift(4,0),le.write_shift(2,65535),le;var _e=0,Ce=0,Te=0,xe=0;return q<0&&(_e=1,q=-q),Ce=Math.log2(q)|0,q/=Math.pow(2,Ce-31),xe=q>>>0,xe&2147483648||(q/=2,++Ce,xe=q>>>0),q-=xe,xe|=2147483648,xe>>>=0,q*=Math.pow(2,32),Te=q>>>0,le.write_shift(4,Te),le.write_shift(4,xe),Ce+=16383+(_e?32768:0),le.write_shift(2,Ce),le}function P(B,K){var X=S(B);return B.l+=K-14,X}function b(B,K){var X=O(B),q=B.read_shift(4);return X[1].v=q>>6,X}function C(B,K){var X=O(B),q=B.read_shift(8,"f");return X[1].v=q,X}function oe(B,K){var X=C(B);return B.l+=K-10,X}function ae(B,K){return B[B.l+K-1]==0?B.read_shift(K,"cstr"):""}function he(B,K){var X=B[B.l++];X>K-1&&(X=K-1);for(var q="";q.length<X;)q+=String.fromCharCode(B[B.l++]);return q}function me(B,K,X){if(!(!X.qpro||K<21)){var q=B.read_shift(1);B.l+=17,B.l+=1,B.l+=2;var le=B.read_shift(K-21,"cstr");return[q,le]}}function ee(B,K){for(var X={},q=B.l+K;B.l<q;){var le=B.read_shift(2);if(le==14e3){for(X[le]=[0,""],X[le][0]=B.read_shift(2);B[B.l];)X[le][1]+=String.fromCharCode(B[B.l]),B.l++;B.l++}}return X}function H(B,K){var X=tr(5+B.length);X.write_shift(2,14e3),X.write_shift(2,K);for(var q=0;q<B.length;++q){var le=B.charCodeAt(q);X[X.l++]=le>127?95:le}return X[X.l++]=0,X}var ue={0:{n:"BOF",f:Yt},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:o},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:m},14:{n:"NUMBER",f:x},15:{n:"LABEL",f:u},16:{n:"FORMULA",f:w},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:u},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:ae},222:{n:"SHEETNAMELP",f:he},65535:{n:""}},de={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:M},23:{n:"NUMBER17",f:S},24:{n:"NUMBER18",f:y},25:{n:"FORMULA19",f:P},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:ee},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:b},38:{n:"??"},39:{n:"NUMBER27",f:C},40:{n:"FORMULA28",f:oe},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:ae},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:me},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:n,book_to_wk3:s,to_workbook:e}}();function xj(t){var e={},r=t.match(Wr),n=0,s=!1;if(r)for(;n!=r.length;++n){var a=Oe(r[n]);switch(a[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!a.val)break;case"<shadow>":case"<shadow/>":e.shadow=1;break;case"</shadow>":break;case"<charset":if(a.val=="1")break;e.cp=Hv[parseInt(a.val,10)];break;case"<outline":if(!a.val)break;case"<outline>":case"<outline/>":e.outline=1;break;case"</outline>":break;case"<rFont":e.name=a.val;break;case"<sz":e.sz=a.val;break;case"<strike":if(!a.val)break;case"<strike>":case"<strike/>":e.strike=1;break;case"</strike>":break;case"<u":if(!a.val)break;switch(a.val){case"double":e.uval="double";break;case"singleAccounting":e.uval="single-accounting";break;case"doubleAccounting":e.uval="double-accounting";break}case"<u>":case"<u/>":e.u=1;break;case"</u>":break;case"<b":if(a.val=="0")break;case"<b>":case"<b/>":e.b=1;break;case"</b>":break;case"<i":if(a.val=="0")break;case"<i>":case"<i/>":e.i=1;break;case"</i>":break;case"<color":a.rgb&&(e.color=a.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":e.family=a.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":e.valign=a.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(a[0].charCodeAt(1)!==47&&!s)throw new Error("Unrecognized rich format "+a[0])}}return e}var _j=function(){var t=ou("t"),e=ou("rPr");function r(a){var i=a.match(t);if(!i)return{t:"s",v:""};var o={t:"s",v:it(i[1])},l=a.match(e);return l&&(o.s=xj(l[1])),o}var n=/<(?:\w+:)?r>/g,s=/<\/(?:\w+:)?r>/;return function(i){return i.replace(n,"").split(s).map(r).filter(function(o){return o.v})}}(),yj=function(){var e=/(\r\n|\n)/g;function r(s,a,i){var o=[];s.u&&o.push("text-decoration: underline;"),s.uval&&o.push("text-underline-style:"+s.uval+";"),s.sz&&o.push("font-size:"+s.sz+"pt;"),s.outline&&o.push("text-effect: outline;"),s.shadow&&o.push("text-shadow: auto;"),a.push('<span style="'+o.join("")+'">'),s.b&&(a.push("<b>"),i.push("</b>")),s.i&&(a.push("<i>"),i.push("</i>")),s.strike&&(a.push("<s>"),i.push("</s>"));var l=s.valign||"";return l=="superscript"||l=="super"?l="sup":l=="subscript"&&(l="sub"),l!=""&&(a.push("<"+l+">"),i.push("</"+l+">")),i.push("</span>"),s}function n(s){var a=[[],s.v,[]];return s.v?(s.s&&r(s.s,a[0],a[2]),a[0].join("")+a[1].replace(e,"<br/>")+a[2].join("")):""}return function(a){return a.map(n).join("")}}(),wj=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,Ej=/<(?:\w+:)?r>/,Tj=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function lx(t,e){var r=e?e.cellHTML:!0,n={};return t?(t.match(/^\s*<(?:\w+:)?t[^>]*>/)?(n.t=it(Et(t.slice(t.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),n.r=Et(t),r&&(n.h=Jv(n.t))):t.match(Ej)&&(n.r=Et(t),n.t=it(Et((t.replace(Tj,"").match(wj)||[]).join("").replace(Wr,""))),r&&(n.h=yj(_j(n.r)))),n):{t:""}}var kj=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,Sj=/<(?:\w+:)?(?:si|sstItem)>/g,Aj=/<\/(?:\w+:)?(?:si|sstItem)>/;function Ij(t,e){var r=[],n="";if(!t)return r;var s=t.match(kj);if(s){n=s[2].replace(Sj,"").split(Aj);for(var a=0;a!=n.length;++a){var i=lx(n[a].trim(),e);i!=null&&(r[r.length]=i)}s=Oe(s[1]),r.Count=s.count,r.Unique=s.uniqueCount}return r}function Cj(t){return[t.read_shift(4),t.read_shift(4)]}function Rj(t,e){var r=[],n=!1;return ya(t,function(a,i,o){switch(o){case 159:r.Count=a[0],r.Unique=a[1];break;case 19:r.push(a);break;case 160:return!0;case 35:n=!0;break;case 36:n=!1;break;default:if(i.T,!n||e.WTF)throw new Error("Unexpected record 0x"+o.toString(16))}}),r}function ZA(t){for(var e=[],r=t.split(""),n=0;n<r.length;++n)e[n]=r[n].charCodeAt(0);return e}function sa(t,e){var r={};return r.Major=t.read_shift(2),r.Minor=t.read_shift(2),e>=4&&(t.l+=e-4),r}function Nj(t){var e={};return e.id=t.read_shift(0,"lpp4"),e.R=sa(t,4),e.U=sa(t,4),e.W=sa(t,4),e}function Pj(t){for(var e=t.read_shift(4),r=t.l+e-4,n={},s=t.read_shift(4),a=[];s-- >0;)a.push({t:t.read_shift(4),v:t.read_shift(0,"lpp4")});if(n.name=t.read_shift(0,"lpp4"),n.comps=a,t.l!=r)throw new Error("Bad DataSpaceMapEntry: "+t.l+" != "+r);return n}function bj(t){var e=[];t.l+=4;for(var r=t.read_shift(4);r-- >0;)e.push(Pj(t));return e}function Dj(t){var e=[];t.l+=4;for(var r=t.read_shift(4);r-- >0;)e.push(t.read_shift(0,"lpp4"));return e}function Fj(t){var e={};return t.read_shift(4),t.l+=4,e.id=t.read_shift(0,"lpp4"),e.name=t.read_shift(0,"lpp4"),e.R=sa(t,4),e.U=sa(t,4),e.W=sa(t,4),e}function Oj(t){var e=Fj(t);if(e.ename=t.read_shift(0,"8lpp4"),e.blksz=t.read_shift(4),e.cmode=t.read_shift(4),t.read_shift(4)!=4)throw new Error("Bad !Primary record");return e}function eI(t,e){var r=t.l+e,n={};n.Flags=t.read_shift(4)&63,t.l+=4,n.AlgID=t.read_shift(4);var s=!1;switch(n.AlgID){case 26126:case 26127:case 26128:s=n.Flags==36;break;case 26625:s=n.Flags==4;break;case 0:s=n.Flags==16||n.Flags==4||n.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+n.AlgID}if(!s)throw new Error("Encryption Flags/AlgID mismatch");return n.AlgIDHash=t.read_shift(4),n.KeySize=t.read_shift(4),n.ProviderType=t.read_shift(4),t.l+=8,n.CSPName=t.read_shift(r-t.l>>1,"utf16le"),t.l=r,n}function tI(t,e){var r={},n=t.l+e;return t.l+=4,r.Salt=t.slice(t.l,t.l+16),t.l+=16,r.Verifier=t.slice(t.l,t.l+16),t.l+=16,t.read_shift(4),r.VerifierHash=t.slice(t.l,n),t.l=n,r}function Mj(t){var e=sa(t);switch(e.Minor){case 2:return[e.Minor,Lj(t)];case 3:return[e.Minor,jj()];case 4:return[e.Minor,Vj(t)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+e.Minor)}function Lj(t){var e=t.read_shift(4);if((e&63)!=36)throw new Error("EncryptionInfo mismatch");var r=t.read_shift(4),n=eI(t,r),s=tI(t,t.length-t.l);return{t:"Std",h:n,v:s}}function jj(){throw new Error("File is password-protected: ECMA-376 Extensible")}function Vj(t){var e=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];t.l+=4;var r=t.read_shift(t.length-t.l,"utf8"),n={};return r.replace(Wr,function(a){var i=Oe(a);switch(Fs(i[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":e.forEach(function(o){n[o]=i[o]});break;case"<dataIntegrity":n.encryptedHmacKey=i.encryptedHmacKey,n.encryptedHmacValue=i.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":n.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":n.uri=i.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":n.encs.push(i);break;default:throw i[0]}}),n}function Uj(t,e){var r={},n=r.EncryptionVersionInfo=sa(t,4);if(e-=4,n.Minor!=2)throw new Error("unrecognized minor version code: "+n.Minor);if(n.Major>4||n.Major<2)throw new Error("unrecognized major version code: "+n.Major);r.Flags=t.read_shift(4),e-=4;var s=t.read_shift(4);return e-=4,r.EncryptionHeader=eI(t,s),e-=s,r.EncryptionVerifier=tI(t,e),r}function Bj(t){var e={},r=e.EncryptionVersionInfo=sa(t,4);if(r.Major!=1||r.Minor!=1)throw"unrecognized version code "+r.Major+" : "+r.Minor;return e.Salt=t.read_shift(16),e.EncryptedVerifier=t.read_shift(16),e.EncryptedVerifierHash=t.read_shift(16),e}function zj(t){var e=0,r,n=ZA(t),s=n.length+1,a,i,o,l,c;for(r=oi(s),r[0]=n.length,a=1;a!=s;++a)r[a]=n[a-1];for(a=s-1;a>=0;--a)i=r[a],o=e&16384?1:0,l=e<<1&32767,c=o|l,e=c^i;return e^52811}var rI=function(){var t=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],e=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],r=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],n=function(i){return(i/2|i*128)&255},s=function(i,o){return n(i^o)},a=function(i){for(var o=e[i.length-1],l=104,c=i.length-1;c>=0;--c)for(var u=i[c],h=0;h!=7;++h)u&64&&(o^=r[l]),u*=2,--l;return o};return function(i){for(var o=ZA(i),l=a(o),c=o.length,u=oi(16),h=0;h!=16;++h)u[h]=0;var m,p,x;for((c&1)===1&&(m=l>>8,u[c]=s(t[0],m),--c,m=l&255,p=o[o.length-1],u[c]=s(p,m));c>0;)--c,m=l>>8,u[c]=s(o[c],m),--c,m=l&255,u[c]=s(o[c],m);for(c=15,x=15-o.length;x>0;)m=l>>8,u[c]=s(t[x],m),--c,--x,m=l&255,u[c]=s(o[c],m),--c,--x;return u}}(),$j=function(t,e,r,n,s){s||(s=e),n||(n=rI(t));var a,i;for(a=0;a!=e.length;++a)i=e[a],i^=n[r],i=(i>>5|i<<3)&255,s[a]=i,++r;return[s,r,n]},Wj=function(t){var e=0,r=rI(t);return function(n){var s=$j("",n,e,r);return e=s[1],s[0]}};function Hj(t,e,r,n){var s={key:Yt(t),verificationBytes:Yt(t)};return r.password&&(s.verifier=zj(r.password)),n.valid=s.verificationBytes===s.verifier,n.valid&&(n.insitu=Wj(r.password)),s}function Gj(t,e,r){var n=r||{};return n.Info=t.read_shift(2),t.l-=2,n.Info===1?n.Data=Bj(t):n.Data=Uj(t,e),n}function Kj(t,e,r){var n={Type:r.biff>=8?t.read_shift(2):0};return n.Type?Gj(t,e-2,n):Hj(t,r.biff>=8?e:e-2,r,n),n}var qj=function(){function t(s,a){switch(a.type){case"base64":return e(An(s),a);case"binary":return e(s,a);case"buffer":return e(Qe&&Buffer.isBuffer(s)?s.toString("binary"):so(s),a);case"array":return e(Xi(s),a)}throw new Error("Unrecognized type "+a.type)}function e(s,a){var i=a||{},o=i.dense?[]:{},l=s.match(/\\trowd.*?\\row\b/g);if(!l.length)throw new Error("RTF missing table");var c={s:{c:0,r:0},e:{c:0,r:l.length-1}};return l.forEach(function(u,h){Array.isArray(o)&&(o[h]=[]);for(var m=/\\\w+\b/g,p=0,x,v=-1;x=m.exec(u);){switch(x[0]){case"\\cell":var w=u.slice(p,m.lastIndex-x[0].length);if(w[0]==" "&&(w=w.slice(1)),++v,w.length){var k={v:w,t:"s"};Array.isArray(o)?o[h][v]=k:o[Ue({r:h,c:v})]=k}break}p=m.lastIndex}v>c.e.c&&(c.e.c=v)}),o["!ref"]=rt(c),o}function r(s,a){return pi(t(s,a),a)}function n(s){for(var a=["{\\rtf1\\ansi"],i=Bt(s["!ref"]),o,l=Array.isArray(s),c=i.s.r;c<=i.e.r;++c){a.push("\\trowd\\trautofit1");for(var u=i.s.c;u<=i.e.c;++u)a.push("\\cellx"+(u+1));for(a.push("\\pard\\intbl"),u=i.s.c;u<=i.e.c;++u){var h=Ue({r:c,c:u});o=l?(s[c]||[])[u]:s[h],!(!o||o.v==null&&(!o.f||o.F))&&(a.push(" "+(o.w||(ga(o),o.w))),a.push("\\cell"))}a.push("\\pard\\intbl\\row")}return a.join("")+"}"}return{to_workbook:r,to_sheet:t,from_sheet:n}}();function Xj(t){var e=t.slice(t[0]==="#"?1:0).slice(0,6);return[parseInt(e.slice(0,2),16),parseInt(e.slice(2,4),16),parseInt(e.slice(4,6),16)]}function uu(t){for(var e=0,r=1;e!=3;++e)r=r*256+(t[e]>255?255:t[e]<0?0:t[e]);return r.toString(16).toUpperCase().slice(1)}function Yj(t){var e=t[0]/255,r=t[1]/255,n=t[2]/255,s=Math.max(e,r,n),a=Math.min(e,r,n),i=s-a;if(i===0)return[0,0,e];var o=0,l=0,c=s+a;switch(l=i/(c>1?2-c:c),s){case e:o=((r-n)/i+6)%6;break;case r:o=(n-e)/i+2;break;case n:o=(e-r)/i+4;break}return[o/6,l,c/2]}function Qj(t){var e=t[0],r=t[1],n=t[2],s=r*2*(n<.5?n:1-n),a=n-s/2,i=[a,a,a],o=6*e,l;if(r!==0)switch(o|0){case 0:case 6:l=s*o,i[0]+=s,i[1]+=l;break;case 1:l=s*(2-o),i[0]+=l,i[1]+=s;break;case 2:l=s*(o-2),i[1]+=s,i[2]+=l;break;case 3:l=s*(4-o),i[1]+=l,i[2]+=s;break;case 4:l=s*(o-4),i[2]+=s,i[0]+=l;break;case 5:l=s*(6-o),i[2]+=l,i[0]+=s;break}for(var c=0;c!=3;++c)i[c]=Math.round(i[c]*255);return i}function sd(t,e){if(e===0)return t;var r=Yj(Xj(t));return e<0?r[2]=r[2]*(1+e):r[2]=1-(1-r[2])*(1-e),uu(Qj(r))}var nI=6,Jj=15,Zj=1,Kr=nI;function ad(t){return Math.floor((t+Math.round(128/Kr)/256)*Kr)}function id(t){return Math.floor((t-5)/Kr*100+.5)/100}function Dp(t){return Math.round((t*Kr+5)/Kr*256)/256}function J0(t){return Dp(id(ad(t)))}function cx(t){var e=Math.abs(t-J0(t)),r=Kr;if(e>.005)for(Kr=Zj;Kr<Jj;++Kr)Math.abs(t-J0(t))<=e&&(e=Math.abs(t-J0(t)),r=Kr);Kr=r}function ml(t){t.width?(t.wpx=ad(t.width),t.wch=id(t.wpx),t.MDW=Kr):t.wpx?(t.wch=id(t.wpx),t.width=Dp(t.wch),t.MDW=Kr):typeof t.wch=="number"&&(t.width=Dp(t.wch),t.wpx=ad(t.width),t.MDW=Kr),t.customWidth&&delete t.customWidth}var e9=96,sI=e9;function aI(t){return t*96/sI}function fu(t){return t*sI/96}var t9={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function r9(t,e,r,n){e.Borders=[];var s={},a=!1;(t[0].match(Wr)||[]).forEach(function(i){var o=Oe(i);switch(Fs(o[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":s={},o.diagonalUp&&(s.diagonalUp=Pt(o.diagonalUp)),o.diagonalDown&&(s.diagonalDown=Pt(o.diagonalDown)),e.Borders.push(s);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(n&&n.WTF&&!a)throw new Error("unrecognized "+o[0]+" in borders")}})}function n9(t,e,r,n){e.Fills=[];var s={},a=!1;(t[0].match(Wr)||[]).forEach(function(i){var o=Oe(i);switch(Fs(o[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":s={},e.Fills.push(s);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":e.Fills.push(s),s={};break;case"<patternFill":case"<patternFill>":o.patternType&&(s.patternType=o.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":s.bgColor||(s.bgColor={}),o.indexed&&(s.bgColor.indexed=parseInt(o.indexed,10)),o.theme&&(s.bgColor.theme=parseInt(o.theme,10)),o.tint&&(s.bgColor.tint=parseFloat(o.tint)),o.rgb&&(s.bgColor.rgb=o.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":s.fgColor||(s.fgColor={}),o.theme&&(s.fgColor.theme=parseInt(o.theme,10)),o.tint&&(s.fgColor.tint=parseFloat(o.tint)),o.rgb!=null&&(s.fgColor.rgb=o.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(n&&n.WTF&&!a)throw new Error("unrecognized "+o[0]+" in fills")}})}function s9(t,e,r,n){e.Fonts=[];var s={},a=!1;(t[0].match(Wr)||[]).forEach(function(i){var o=Oe(i);switch(Fs(o[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":e.Fonts.push(s),s={};break;case"<name":o.val&&(s.name=Et(o.val));break;case"<name/>":case"</name>":break;case"<b":s.bold=o.val?Pt(o.val):1;break;case"<b/>":s.bold=1;break;case"<i":s.italic=o.val?Pt(o.val):1;break;case"<i/>":s.italic=1;break;case"<u":switch(o.val){case"none":s.underline=0;break;case"single":s.underline=1;break;case"double":s.underline=2;break;case"singleAccounting":s.underline=33;break;case"doubleAccounting":s.underline=34;break}break;case"<u/>":s.underline=1;break;case"<strike":s.strike=o.val?Pt(o.val):1;break;case"<strike/>":s.strike=1;break;case"<outline":s.outline=o.val?Pt(o.val):1;break;case"<outline/>":s.outline=1;break;case"<shadow":s.shadow=o.val?Pt(o.val):1;break;case"<shadow/>":s.shadow=1;break;case"<condense":s.condense=o.val?Pt(o.val):1;break;case"<condense/>":s.condense=1;break;case"<extend":s.extend=o.val?Pt(o.val):1;break;case"<extend/>":s.extend=1;break;case"<sz":o.val&&(s.sz=+o.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":o.val&&(s.vertAlign=o.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":o.val&&(s.family=parseInt(o.val,10));break;case"<family/>":case"</family>":break;case"<scheme":o.val&&(s.scheme=o.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(o.val=="1")break;o.codepage=Hv[parseInt(o.val,10)];break;case"<color":if(s.color||(s.color={}),o.auto&&(s.color.auto=Pt(o.auto)),o.rgb)s.color.rgb=o.rgb.slice(-6);else if(o.indexed){s.color.index=parseInt(o.indexed,10);var l=Li[s.color.index];s.color.index==81&&(l=Li[1]),l||(l=Li[1]),s.color.rgb=l[0].toString(16)+l[1].toString(16)+l[2].toString(16)}else o.theme&&(s.color.theme=parseInt(o.theme,10),o.tint&&(s.color.tint=parseFloat(o.tint)),o.theme&&r.themeElements&&r.themeElements.clrScheme&&(s.color.rgb=sd(r.themeElements.clrScheme[s.color.theme].rgb,s.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":a=!0;break;case"</AlternateContent>":a=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(n&&n.WTF&&!a)throw new Error("unrecognized "+o[0]+" in fonts")}})}function a9(t,e,r){e.NumberFmt=[];for(var n=Ns(ze),s=0;s<n.length;++s)e.NumberFmt[n[s]]=ze[n[s]];var a=t[0].match(Wr);if(a)for(s=0;s<a.length;++s){var i=Oe(a[s]);switch(Fs(i[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var o=it(Et(i.formatCode)),l=parseInt(i.numFmtId,10);if(e.NumberFmt[l]=o,l>0){if(l>392){for(l=392;l>60&&e.NumberFmt[l]!=null;--l);e.NumberFmt[l]=o}Mi(o,l)}}break;case"</numFmt>":break;default:if(r.WTF)throw new Error("unrecognized "+i[0]+" in numFmts")}}}var Pf=["numFmtId","fillId","fontId","borderId","xfId"],bf=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function i9(t,e,r){e.CellXf=[];var n,s=!1;(t[0].match(Wr)||[]).forEach(function(a){var i=Oe(a),o=0;switch(Fs(i[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(n=i,delete n[0],o=0;o<Pf.length;++o)n[Pf[o]]&&(n[Pf[o]]=parseInt(n[Pf[o]],10));for(o=0;o<bf.length;++o)n[bf[o]]&&(n[bf[o]]=Pt(n[bf[o]]));if(e.NumberFmt&&n.numFmtId>392){for(o=392;o>60;--o)if(e.NumberFmt[n.numFmtId]==e.NumberFmt[o]){n.numFmtId=o;break}}e.CellXf.push(n);break;case"</xf>":break;case"<alignment":case"<alignment/>":var l={};i.vertical&&(l.vertical=i.vertical),i.horizontal&&(l.horizontal=i.horizontal),i.textRotation!=null&&(l.textRotation=i.textRotation),i.indent&&(l.indent=i.indent),i.wrapText&&(l.wrapText=Pt(i.wrapText)),n.alignment=l;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":s=!0;break;case"</AlternateContent>":s=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(r&&r.WTF&&!s)throw new Error("unrecognized "+i[0]+" in cellXfs")}})}var o9=function(){var e=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,r=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,n=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,s=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,a=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(o,l,c){var u={};if(!o)return u;o=o.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var h;return(h=o.match(e))&&a9(h,u,c),(h=o.match(s))&&s9(h,u,l,c),(h=o.match(n))&&n9(h,u,l,c),(h=o.match(a))&&r9(h,u,l,c),(h=o.match(r))&&i9(h,u,c),u}}();function l9(t,e){var r=t.read_shift(2),n=Ur(t);return[r,n]}function c9(t,e,r){var n={};n.sz=t.read_shift(2)/20;var s=_8(t);s.fItalic&&(n.italic=1),s.fCondense&&(n.condense=1),s.fExtend&&(n.extend=1),s.fShadow&&(n.shadow=1),s.fOutline&&(n.outline=1),s.fStrikeout&&(n.strike=1);var a=t.read_shift(2);switch(a===700&&(n.bold=1),t.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var i=t.read_shift(1);i!=0&&(n.underline=i);var o=t.read_shift(1);o>0&&(n.family=o);var l=t.read_shift(1);switch(l>0&&(n.charset=l),t.l++,n.color=x8(t),t.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=Ur(t),n}var u9=$r;function f9(t,e){var r=t.l+e,n=t.read_shift(2),s=t.read_shift(2);return t.l=r,{ixfe:n,numFmtId:s}}var h9=$r;function d9(t,e,r){var n={};n.NumberFmt=[];for(var s in ze)n.NumberFmt[s]=ze[s];n.CellXf=[],n.Fonts=[];var a=[],i=!1;return ya(t,function(l,c,u){switch(u){case 44:n.NumberFmt[l[0]]=l[1],Mi(l[1],l[0]);break;case 43:n.Fonts.push(l),l.color.theme!=null&&e&&e.themeElements&&e.themeElements.clrScheme&&(l.color.rgb=sd(e.themeElements.clrScheme[l.color.theme].rgb,l.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:a[a.length-1]==617&&n.CellXf.push(l);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:i=!0;break;case 36:i=!1;break;case 37:a.push(u),i=!0;break;case 38:a.pop(),i=!1;break;default:if(c.T>0)a.push(u);else if(c.T<0)a.pop();else if(!i||r.WTF&&a[a.length-1]!=37)throw new Error("Unexpected record 0x"+u.toString(16))}}),n}var m9=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function p9(t,e,r){e.themeElements.clrScheme=[];var n={};(t[0].match(Wr)||[]).forEach(function(s){var a=Oe(s);switch(a[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":n.rgb=a.val;break;case"<a:sysClr":n.rgb=a.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":a[0].charAt(1)==="/"?(e.themeElements.clrScheme[m9.indexOf(a[0])]=n,n={}):n.name=a[0].slice(3,a[0].length-1);break;default:if(r&&r.WTF)throw new Error("Unrecognized "+a[0]+" in clrScheme")}})}function g9(){}function v9(){}var x9=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,_9=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,y9=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function w9(t,e,r){e.themeElements={};var n;[["clrScheme",x9,p9],["fontScheme",_9,g9],["fmtScheme",y9,v9]].forEach(function(s){if(!(n=t.match(s[1])))throw new Error(s[0]+" not found in themeElements");s[2](n,e,r)})}var E9=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function iI(t,e){(!t||t.length===0)&&(t=T9());var r,n={};if(!(r=t.match(E9)))throw new Error("themeElements not found in theme");return w9(r[0],n,e),n.raw=t,n}function T9(t,e){var r=[vA];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function k9(t,e,r){var n=t.l+e,s=t.read_shift(4);if(s!==124226){if(!r.cellStyles){t.l=n;return}var a=t.slice(t.l);t.l=n;var i;try{i=gA(a,{type:"array"})}catch{return}var o=yn(i,"theme/theme/theme1.xml",!0);if(o)return iI(o,r)}}function S9(t){return t.read_shift(4)}function A9(t){var e={};switch(e.xclrType=t.read_shift(2),e.nTintShade=t.read_shift(2),e.xclrType){case 0:t.l+=4;break;case 1:e.xclrValue=I9(t,4);break;case 2:e.xclrValue=GA(t);break;case 3:e.xclrValue=S9(t);break;case 4:t.l+=4;break}return t.l+=8,e}function I9(t,e){return $r(t,e)}function C9(t,e){return $r(t,e)}function R9(t){var e=t.read_shift(2),r=t.read_shift(2)-4,n=[e];switch(e){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:n[1]=A9(t);break;case 6:n[1]=C9(t,r);break;case 14:case 15:n[1]=t.read_shift(r===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+e+" "+r)}return n}function N9(t,e){var r=t.l+e;t.l+=2;var n=t.read_shift(2);t.l+=2;for(var s=t.read_shift(2),a=[];s-- >0;)a.push(R9(t,r-t.l));return{ixfe:n,ext:a}}function P9(t,e){e.forEach(function(r){switch(r[0]){}})}function b9(t,e){return{flags:t.read_shift(4),version:t.read_shift(4),name:Ur(t)}}function D9(t){for(var e=[],r=t.read_shift(4);r-- >0;)e.push([t.read_shift(4),t.read_shift(4)]);return e}function F9(t){return t.l+=4,t.read_shift(4)!=0}function O9(t,e,r){var n={Types:[],Cell:[],Value:[]},s=r||{},a=[],i=!1,o=2;return ya(t,function(l,c,u){switch(u){case 335:n.Types.push({name:l.name});break;case 51:l.forEach(function(h){o==1?n.Cell.push({type:n.Types[h[0]-1].name,index:h[1]}):o==0&&n.Value.push({type:n.Types[h[0]-1].name,index:h[1]})});break;case 337:o=l?1:0;break;case 338:o=2;break;case 35:a.push(u),i=!0;break;case 36:a.pop(),i=!1;break;default:if(!c.T){if(!i||s.WTF&&a[a.length-1]!=35)throw new Error("Unexpected record 0x"+u.toString(16))}}}),n}function M9(t,e,r){var n={Types:[],Cell:[],Value:[]};if(!t)return n;var s=!1,a=2,i;return t.replace(Wr,function(o){var l=Oe(o);switch(Fs(l[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":n.Types.push({name:l.name});break;case"</metadataType>":break;case"<futureMetadata":for(var c=0;c<n.Types.length;++c)n.Types[c].name==l.name&&(i=n.Types[c]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":a==1?n.Cell.push({type:n.Types[l.t-1].name,index:+l.v}):a==0&&n.Value.push({type:n.Types[l.t-1].name,index:+l.v});break;case"</rc>":break;case"<cellMetadata":a=1;break;case"</cellMetadata>":a=2;break;case"<valueMetadata":a=0;break;case"</valueMetadata>":a=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;case"<rvb":if(!i)break;i.offsets||(i.offsets=[]),i.offsets.push(+l.i);break;default:if(!s&&r.WTF)throw new Error("unrecognized "+l[0]+" in metadata")}return o}),n}function L9(t){var e=[];if(!t)return e;var r=1;return(t.match(Wr)||[]).forEach(function(n){var s=Oe(n);switch(s[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete s[0],s.i?r=s.i:s.i=r,e.push(s);break}}),e}function j9(t){var e={};e.i=t.read_shift(4);var r={};r.r=t.read_shift(4),r.c=t.read_shift(4),e.r=Ue(r);var n=t.read_shift(1);return n&2&&(e.l="1"),n&8&&(e.a="1"),e}function V9(t,e,r){var n=[];return ya(t,function(a,i,o){switch(o){case 63:n.push(a);break;default:if(!i.T)throw new Error("Unexpected record 0x"+o.toString(16))}}),n}function U9(t,e,r,n){if(!t)return t;var s=n||{},a=!1;ya(t,function(o,l,c){switch(c){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:a=!0;break;case 36:a=!1;break;default:if(!l.T){if(!a||s.WTF)throw new Error("Unexpected record 0x"+c.toString(16))}}},s)}function B9(t,e){if(!t)return"??";var r=(t.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return e["!id"][r].Target}function bw(t,e,r,n){var s=Array.isArray(t),a;e.forEach(function(i){var o=qr(i.ref);if(s?(t[o.r]||(t[o.r]=[]),a=t[o.r][o.c]):a=t[i.ref],!a){a={t:"z"},s?t[o.r][o.c]=a:t[i.ref]=a;var l=Bt(t["!ref"]||"BDWGO1000001:A1");l.s.r>o.r&&(l.s.r=o.r),l.e.r<o.r&&(l.e.r=o.r),l.s.c>o.c&&(l.s.c=o.c),l.e.c<o.c&&(l.e.c=o.c);var c=rt(l);c!==t["!ref"]&&(t["!ref"]=c)}a.c||(a.c=[]);var u={a:i.author,t:i.t,r:i.r,T:r};i.h&&(u.h=i.h);for(var h=a.c.length-1;h>=0;--h){if(!r&&a.c[h].T)return;r&&!a.c[h].T&&a.c.splice(h,1)}if(r&&n){for(h=0;h<n.length;++h)if(u.a==n[h].id){u.a=n[h].name||u.a;break}}a.c.push(u)})}function z9(t,e){if(t.match(/<(?:\w+:)?comments *\/>/))return[];var r=[],n=[],s=t.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);s&&s[1]&&s[1].split(/<\/\w*:?author>/).forEach(function(i){if(!(i===""||i.trim()==="")){var o=i.match(/<(?:\w+:)?author[^>]*>(.*)/);o&&r.push(o[1])}});var a=t.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return a&&a[1]&&a[1].split(/<\/\w*:?comment>/).forEach(function(i){if(!(i===""||i.trim()==="")){var o=i.match(/<(?:\w+:)?comment[^>]*>/);if(o){var l=Oe(o[0]),c={author:l.authorId&&r[l.authorId]||"sheetjsghost",ref:l.ref,guid:l.guid},u=qr(l.ref);if(!(e.sheetRows&&e.sheetRows<=u.r)){var h=i.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),m=!!h&&!!h[1]&&lx(h[1])||{r:"",t:"",h:""};c.r=m.r,m.r=="<t></t>"&&(m.t=m.h=""),c.t=(m.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.cellHTML&&(c.h=m.h),n.push(c)}}}}),n}function $9(t,e){var r=[],n=!1,s={},a=0;return t.replace(Wr,function(o,l){var c=Oe(o);switch(Fs(c[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":s={author:c.personId,guid:c.id,ref:c.ref,T:1};break;case"</threadedComment>":s.t!=null&&r.push(s);break;case"<text>":case"<text":a=l+o.length;break;case"</text>":s.t=t.slice(a,l).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":n=!0;break;case"</mentions>":n=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&e.WTF)throw new Error("unrecognized "+c[0]+" in threaded comments")}return o}),r}function W9(t,e){var r=[],n=!1;return t.replace(Wr,function(a){var i=Oe(a);switch(Fs(i[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":r.push({name:i.displayname,id:i.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&e.WTF)throw new Error("unrecognized "+i[0]+" in threaded comments")}return a}),r}function H9(t){var e={};e.iauthor=t.read_shift(4);var r=io(t);return e.rfx=r.s,e.ref=Ue(r.s),t.l+=16,e}var G9=Ur;function K9(t,e){var r=[],n=[],s={},a=!1;return ya(t,function(o,l,c){switch(c){case 632:n.push(o);break;case 635:s=o;break;case 637:s.t=o.t,s.h=o.h,s.r=o.r;break;case 636:if(s.author=n[s.iauthor],delete s.iauthor,e.sheetRows&&s.rfx&&e.sheetRows<=s.rfx.r)break;s.t||(s.t=""),delete s.rfx,r.push(s);break;case 3072:break;case 35:a=!0;break;case 36:a=!1;break;case 37:break;case 38:break;default:if(!l.T){if(!a||e.WTF)throw new Error("Unexpected record 0x"+c.toString(16))}}}),r}var q9="application/vnd.ms-office.vbaProject";function X9(t){var e=tt.utils.cfb_new({root:"R"});return t.FullPaths.forEach(function(r,n){if(!(r.slice(-1)==="/"||!r.match(/_VBA_PROJECT_CUR/))){var s=r.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");tt.utils.cfb_add(e,s,t.FileIndex[n].content)}}),tt.write(e)}function Y9(){return{"!type":"dialog"}}function Q9(){return{"!type":"dialog"}}function J9(){return{"!type":"macro"}}function Z9(){return{"!type":"macro"}}var Ko=function(){var t=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,e={r:0,c:0};function r(n,s,a,i){var o=!1,l=!1;a.length==0?l=!0:a.charAt(0)=="["&&(l=!0,a=a.slice(1,-1)),i.length==0?o=!0:i.charAt(0)=="["&&(o=!0,i=i.slice(1,-1));var c=a.length>0?parseInt(a,10)|0:0,u=i.length>0?parseInt(i,10)|0:0;return o?u+=e.c:--u,l?c+=e.r:--c,s+(o?"":"$")+sr(u)+(l?"":"$")+Tr(c)}return function(s,a){return e=a,s.replace(t,r)}}(),oI=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,eV=function(){return function(e,r){return e.replace(oI,function(n,s,a,i,o,l){var c=rx(i)-(a?0:r.c),u=tx(l)-(o?0:r.r),h=u==0?"":o?u+1:"["+u+"]",m=c==0?"":a?c+1:"["+c+"]";return s+"R"+h+"C"+m})}}();function lI(t,e){return t.replace(oI,function(r,n,s,a,i,o){return n+(s=="$"?s+a:sr(rx(a)+e.c))+(i=="$"?i+o:Tr(tx(o)+e.r))})}function tV(t,e,r){var n=kl(e),s=n.s,a=qr(r),i={r:a.r-s.r,c:a.c-s.c};return lI(t,i)}function rV(t){return t.length!=1}function Dw(t){return t.replace(/_xlfn\./g,"")}function Kt(t){t.l+=1}function li(t,e){var r=t.read_shift(2);return[r&16383,r>>14&1,r>>15&1]}function cI(t,e,r){var n=2;if(r){if(r.biff>=2&&r.biff<=5)return uI(t);r.biff==12&&(n=4)}var s=t.read_shift(n),a=t.read_shift(n),i=li(t),o=li(t);return{s:{r:s,c:i[0],cRel:i[1],rRel:i[2]},e:{r:a,c:o[0],cRel:o[1],rRel:o[2]}}}function uI(t){var e=li(t),r=li(t),n=t.read_shift(1),s=t.read_shift(1);return{s:{r:e[0],c:n,cRel:e[1],rRel:e[2]},e:{r:r[0],c:s,cRel:r[1],rRel:r[2]}}}function nV(t,e,r){if(r.biff<8)return uI(t);var n=t.read_shift(r.biff==12?4:2),s=t.read_shift(r.biff==12?4:2),a=li(t),i=li(t);return{s:{r:n,c:a[0],cRel:a[1],rRel:a[2]},e:{r:s,c:i[0],cRel:i[1],rRel:i[2]}}}function fI(t,e,r){if(r&&r.biff>=2&&r.biff<=5)return sV(t);var n=t.read_shift(r&&r.biff==12?4:2),s=li(t);return{r:n,c:s[0],cRel:s[1],rRel:s[2]}}function sV(t){var e=li(t),r=t.read_shift(1);return{r:e[0],c:r,cRel:e[1],rRel:e[2]}}function aV(t){var e=t.read_shift(2),r=t.read_shift(2);return{r:e,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function iV(t,e,r){var n=r&&r.biff?r.biff:8;if(n>=2&&n<=5)return oV(t);var s=t.read_shift(n>=12?4:2),a=t.read_shift(2),i=(a&16384)>>14,o=(a&32768)>>15;if(a&=16383,o==1)for(;s>524287;)s-=1048576;if(i==1)for(;a>8191;)a=a-16384;return{r:s,c:a,cRel:i,rRel:o}}function oV(t){var e=t.read_shift(2),r=t.read_shift(1),n=(e&32768)>>15,s=(e&16384)>>14;return e&=16383,n==1&&e>=8192&&(e=e-16384),s==1&&r>=128&&(r=r-256),{r:e,c:r,cRel:s,rRel:n}}function lV(t,e,r){var n=(t[t.l++]&96)>>5,s=cI(t,r.biff>=2&&r.biff<=5?6:8,r);return[n,s]}function cV(t,e,r){var n=(t[t.l++]&96)>>5,s=t.read_shift(2,"i"),a=8;if(r)switch(r.biff){case 5:t.l+=12,a=6;break;case 12:a=12;break}var i=cI(t,a,r);return[n,s,i]}function uV(t,e,r){var n=(t[t.l++]&96)>>5;return t.l+=r&&r.biff>8?12:r.biff<8?6:8,[n]}function fV(t,e,r){var n=(t[t.l++]&96)>>5,s=t.read_shift(2),a=8;if(r)switch(r.biff){case 5:t.l+=12,a=6;break;case 12:a=12;break}return t.l+=a,[n,s]}function hV(t,e,r){var n=(t[t.l++]&96)>>5,s=nV(t,e-1,r);return[n,s]}function dV(t,e,r){var n=(t[t.l++]&96)>>5;return t.l+=r.biff==2?6:r.biff==12?14:7,[n]}function Fw(t){var e=t[t.l+1]&1,r=1;return t.l+=4,[e,r]}function mV(t,e,r){t.l+=2;for(var n=t.read_shift(r&&r.biff==2?1:2),s=[],a=0;a<=n;++a)s.push(t.read_shift(r&&r.biff==2?1:2));return s}function pV(t,e,r){var n=t[t.l+1]&255?1:0;return t.l+=2,[n,t.read_shift(r&&r.biff==2?1:2)]}function gV(t,e,r){var n=t[t.l+1]&255?1:0;return t.l+=2,[n,t.read_shift(r&&r.biff==2?1:2)]}function vV(t){var e=t[t.l+1]&255?1:0;return t.l+=2,[e,t.read_shift(2)]}function xV(t,e,r){var n=t[t.l+1]&255?1:0;return t.l+=r&&r.biff==2?3:4,[n]}function hI(t){var e=t.read_shift(1),r=t.read_shift(1);return[e,r]}function _V(t){return t.read_shift(2),hI(t)}function yV(t){return t.read_shift(2),hI(t)}function wV(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var s=fI(t,0,r);return[n,s]}function EV(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var s=iV(t,0,r);return[n,s]}function TV(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var s=t.read_shift(2);r&&r.biff==5&&(t.l+=12);var a=fI(t,0,r);return[n,s,a]}function kV(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var s=t.read_shift(r&&r.biff<=3?1:2);return[SU[s],pI[s],n]}function SV(t,e,r){var n=t[t.l++],s=t.read_shift(1),a=r&&r.biff<=3?[n==88?-1:0,t.read_shift(1)]:AV(t);return[s,(a[0]===0?pI:kU)[a[1]]]}function AV(t){return[t[t.l+1]>>7,t.read_shift(2)&32767]}function IV(t,e,r){t.l+=r&&r.biff==2?3:4}function CV(t,e,r){if(t.l++,r&&r.biff==12)return[t.read_shift(4,"i"),0];var n=t.read_shift(2),s=t.read_shift(r&&r.biff==2?1:2);return[n,s]}function RV(t){return t.l++,oo[t.read_shift(1)]}function NV(t){return t.l++,t.read_shift(2)}function PV(t){return t.l++,t.read_shift(1)!==0}function bV(t){return t.l++,Lr(t)}function DV(t,e,r){return t.l++,Lu(t,e-1,r)}function FV(t,e){var r=[t.read_shift(1)];if(e==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=zt(t,1)?"TRUE":"FALSE",e!=12&&(t.l+=7);break;case 37:case 16:r[1]=oo[t[t.l]],t.l+=e==12?4:8;break;case 0:t.l+=8;break;case 1:r[1]=Lr(t);break;case 2:r[1]=lo(t,0,{biff:e>0&&e<8?2:e});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function OV(t,e,r){for(var n=t.read_shift(r.biff==12?4:2),s=[],a=0;a!=n;++a)s.push((r.biff==12?io:Zd)(t));return s}function MV(t,e,r){var n=0,s=0;r.biff==12?(n=t.read_shift(4),s=t.read_shift(4)):(s=1+t.read_shift(1),n=1+t.read_shift(2)),r.biff>=2&&r.biff<8&&(--n,--s==0&&(s=256));for(var a=0,i=[];a!=n&&(i[a]=[]);++a)for(var o=0;o!=s;++o)i[a][o]=FV(t,r.biff);return i}function LV(t,e,r){var n=t.read_shift(1)>>>5&3,s=!r||r.biff>=8?4:2,a=t.read_shift(s);switch(r.biff){case 2:t.l+=5;break;case 3:case 4:t.l+=8;break;case 5:t.l+=12;break}return[n,0,a]}function jV(t,e,r){if(r.biff==5)return VV(t);var n=t.read_shift(1)>>>5&3,s=t.read_shift(2),a=t.read_shift(4);return[n,s,a]}function VV(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2,"i");t.l+=8;var n=t.read_shift(2);return t.l+=12,[e,r,n]}function UV(t,e,r){var n=t.read_shift(1)>>>5&3;t.l+=r&&r.biff==2?3:4;var s=t.read_shift(r&&r.biff==2?1:2);return[n,s]}function BV(t,e,r){var n=t.read_shift(1)>>>5&3,s=t.read_shift(r&&r.biff==2?1:2);return[n,s]}function zV(t,e,r){var n=t.read_shift(1)>>>5&3;return t.l+=4,r.biff<8&&t.l--,r.biff==12&&(t.l+=2),[n]}function $V(t,e,r){var n=(t[t.l++]&96)>>5,s=t.read_shift(2),a=4;if(r)switch(r.biff){case 5:a=15;break;case 12:a=6;break}return t.l+=a,[n,s]}var WV=$r,HV=$r,GV=$r;function Vu(t,e,r){return t.l+=2,[aV(t)]}function ux(t){return t.l+=6,[]}var KV=Vu,qV=ux,XV=ux,YV=Vu;function dI(t){return t.l+=2,[Yt(t),t.read_shift(2)&1]}var QV=Vu,JV=dI,ZV=ux,eU=Vu,tU=Vu,rU=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function nU(t){t.l+=2;var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(4),s=t.read_shift(2),a=t.read_shift(2),i=rU[r>>2&31];return{ixti:e,coltype:r&3,rt:i,idx:n,c:s,C:a}}function sU(t){return t.l+=2,[t.read_shift(4)]}function aU(t,e,r){return t.l+=5,t.l+=2,t.l+=r.biff==2?1:4,["PTGSHEET"]}function iU(t,e,r){return t.l+=r.biff==2?4:5,["PTGENDSHEET"]}function oU(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2);return[e,r]}function lU(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2);return[e,r]}function cU(t){return t.l+=4,[0,0]}var Ow={1:{n:"PtgExp",f:CV},2:{n:"PtgTbl",f:GV},3:{n:"PtgAdd",f:Kt},4:{n:"PtgSub",f:Kt},5:{n:"PtgMul",f:Kt},6:{n:"PtgDiv",f:Kt},7:{n:"PtgPower",f:Kt},8:{n:"PtgConcat",f:Kt},9:{n:"PtgLt",f:Kt},10:{n:"PtgLe",f:Kt},11:{n:"PtgEq",f:Kt},12:{n:"PtgGe",f:Kt},13:{n:"PtgGt",f:Kt},14:{n:"PtgNe",f:Kt},15:{n:"PtgIsect",f:Kt},16:{n:"PtgUnion",f:Kt},17:{n:"PtgRange",f:Kt},18:{n:"PtgUplus",f:Kt},19:{n:"PtgUminus",f:Kt},20:{n:"PtgPercent",f:Kt},21:{n:"PtgParen",f:Kt},22:{n:"PtgMissArg",f:Kt},23:{n:"PtgStr",f:DV},26:{n:"PtgSheet",f:aU},27:{n:"PtgEndSheet",f:iU},28:{n:"PtgErr",f:RV},29:{n:"PtgBool",f:PV},30:{n:"PtgInt",f:NV},31:{n:"PtgNum",f:bV},32:{n:"PtgArray",f:dV},33:{n:"PtgFunc",f:kV},34:{n:"PtgFuncVar",f:SV},35:{n:"PtgName",f:LV},36:{n:"PtgRef",f:wV},37:{n:"PtgArea",f:lV},38:{n:"PtgMemArea",f:UV},39:{n:"PtgMemErr",f:WV},40:{n:"PtgMemNoMem",f:HV},41:{n:"PtgMemFunc",f:BV},42:{n:"PtgRefErr",f:zV},43:{n:"PtgAreaErr",f:uV},44:{n:"PtgRefN",f:EV},45:{n:"PtgAreaN",f:hV},46:{n:"PtgMemAreaN",f:oU},47:{n:"PtgMemNoMemN",f:lU},57:{n:"PtgNameX",f:jV},58:{n:"PtgRef3d",f:TV},59:{n:"PtgArea3d",f:cV},60:{n:"PtgRefErr3d",f:$V},61:{n:"PtgAreaErr3d",f:fV},255:{}},uU={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},fU={1:{n:"PtgElfLel",f:dI},2:{n:"PtgElfRw",f:eU},3:{n:"PtgElfCol",f:KV},6:{n:"PtgElfRwV",f:tU},7:{n:"PtgElfColV",f:YV},10:{n:"PtgElfRadical",f:QV},11:{n:"PtgElfRadicalS",f:ZV},13:{n:"PtgElfColS",f:qV},15:{n:"PtgElfColSV",f:XV},16:{n:"PtgElfRadicalLel",f:JV},25:{n:"PtgList",f:nU},29:{n:"PtgSxName",f:sU},255:{}},hU={0:{n:"PtgAttrNoop",f:cU},1:{n:"PtgAttrSemi",f:xV},2:{n:"PtgAttrIf",f:gV},4:{n:"PtgAttrChoose",f:mV},8:{n:"PtgAttrGoto",f:pV},16:{n:"PtgAttrSum",f:IV},32:{n:"PtgAttrBaxcel",f:Fw},33:{n:"PtgAttrBaxcel",f:Fw},64:{n:"PtgAttrSpace",f:_V},65:{n:"PtgAttrSpaceSemi",f:yV},128:{n:"PtgAttrIfError",f:vV},255:{}};function Uu(t,e,r,n){if(n.biff<8)return $r(t,e);for(var s=t.l+e,a=[],i=0;i!==r.length;++i)switch(r[i][0]){case"PtgArray":r[i][1]=MV(t,0,n),a.push(r[i][1]);break;case"PtgMemArea":r[i][2]=OV(t,r[i][1],n),a.push(r[i][2]);break;case"PtgExp":n&&n.biff==12&&(r[i][1][1]=t.read_shift(4),a.push(r[i][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[i][0]}return e=s-t.l,e!==0&&a.push($r(t,e)),a}function Bu(t,e,r){for(var n=t.l+e,s,a,i=[];n!=t.l;)e=n-t.l,a=t[t.l],s=Ow[a]||Ow[uU[a]],(a===24||a===25)&&(s=(a===24?fU:hU)[t[t.l+1]]),!s||!s.f?$r(t,e):i.push([s.n,s.f(t,e,r)]);return i}function dU(t){for(var e=[],r=0;r<t.length;++r){for(var n=t[r],s=[],a=0;a<n.length;++a){var i=n[a];if(i)switch(i[0]){case 2:s.push('"'+i[1].replace(/"/g,'""')+'"');break;default:s.push(i[1])}else s.push("")}e.push(s.join(","))}return e.join(";")}var mU={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function pU(t,e){if(!t&&!(e&&e.biff<=5&&e.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(t)?"'"+t+"'":t}function mI(t,e,r){if(!t)return"SH33TJSERR0";if(r.biff>8&&(!t.XTI||!t.XTI[e]))return t.SheetNames[e];if(!t.XTI)return"SH33TJSERR6";var n=t.XTI[e];if(r.biff<8)return e>1e4&&(e-=65536),e<0&&(e=-e),e==0?"":t.XTI[e-1];if(!n)return"SH33TJSERR1";var s="";if(r.biff>8)switch(t[n[0]][0]){case 357:return s=n[1]==-1?"#REF":t.SheetNames[n[1]],n[1]==n[2]?s:s+":"+t.SheetNames[n[2]];case 358:return r.SID!=null?t.SheetNames[r.SID]:"SH33TJSSAME"+t[n[0]][0];case 355:default:return"SH33TJSSRC"+t[n[0]][0]}switch(t[n[0]][0][0]){case 1025:return s=n[1]==-1?"#REF":t.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?s:s+":"+t.SheetNames[n[2]];case 14849:return t[n[0]].slice(1).map(function(a){return a.Name}).join(";;");default:return t[n[0]][0][3]?(s=n[1]==-1?"#REF":t[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?s:s+":"+t[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function Mw(t,e,r){var n=mI(t,e,r);return n=="#REF"?n:pU(n,r)}function Fr(t,e,r,n,s){var a=s&&s.biff||8,i={s:{c:0,r:0}},o=[],l,c,u,h=0,m=0,p,x="";if(!t[0]||!t[0][0])return"";for(var v=-1,w="",k=0,T=t[0].length;k<T;++k){var E=t[0][k];switch(E[0]){case"PtgUminus":o.push("-"+o.pop());break;case"PtgUplus":o.push("+"+o.pop());break;case"PtgPercent":o.push(o.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(l=o.pop(),c=o.pop(),v>=0){switch(t[0][v][1][0]){case 0:w=Ut(" ",t[0][v][1][1]);break;case 1:w=Ut("\r",t[0][v][1][1]);break;default:if(w="",s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+t[0][v][1][0])}c=c+w,v=-1}o.push(c+mU[E[0]]+l);break;case"PtgIsect":l=o.pop(),c=o.pop(),o.push(c+" "+l);break;case"PtgUnion":l=o.pop(),c=o.pop(),o.push(c+","+l);break;case"PtgRange":l=o.pop(),c=o.pop(),o.push(c+":"+l);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":u=Ec(E[1][1],i,s),o.push(Tc(u,a));break;case"PtgRefN":u=r?Ec(E[1][1],r,s):E[1][1],o.push(Tc(u,a));break;case"PtgRef3d":h=E[1][1],u=Ec(E[1][2],i,s),x=Mw(n,h,s),o.push(x+"!"+Tc(u,a));break;case"PtgFunc":case"PtgFuncVar":var N=E[1][0],O=E[1][1];N||(N=0),N&=127;var M=N==0?[]:o.slice(-N);o.length-=N,O==="User"&&(O=M.shift()),o.push(O+"("+M.join(",")+")");break;case"PtgBool":o.push(E[1]?"TRUE":"FALSE");break;case"PtgInt":o.push(E[1]);break;case"PtgNum":o.push(String(E[1]));break;case"PtgStr":o.push('"'+E[1].replace(/"/g,'""')+'"');break;case"PtgErr":o.push(E[1]);break;case"PtgAreaN":p=gw(E[1][1],r?{s:r}:i,s),o.push(Y0(p,s));break;case"PtgArea":p=gw(E[1][1],i,s),o.push(Y0(p,s));break;case"PtgArea3d":h=E[1][1],p=E[1][2],x=Mw(n,h,s),o.push(x+"!"+Y0(p,s));break;case"PtgAttrSum":o.push("SUM("+o.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":m=E[1][2];var g=(n.names||[])[m-1]||(n[0]||[])[m],y=g?g.Name:"SH33TJSNAME"+String(m);y&&y.slice(0,6)=="_xlfn."&&!s.xlfn&&(y=y.slice(6)),o.push(y);break;case"PtgNameX":var S=E[1][1];m=E[1][2];var R;if(s.biff<=5)S<0&&(S=-S),n[S]&&(R=n[S][m]);else{var P="";if(((n[S]||[])[0]||[])[0]==14849||(((n[S]||[])[0]||[])[0]==1025?n[S][m]&&n[S][m].itab>0&&(P=n.SheetNames[n[S][m].itab-1]+"!"):P=n.SheetNames[m-1]+"!"),n[S]&&n[S][m])P+=n[S][m].Name;else if(n[0]&&n[0][m])P+=n[0][m].Name;else{var b=(mI(n,S,s)||"").split(";;");b[m-1]?P=b[m-1]:P+="SH33TJSERRX"}o.push(P);break}R||(R={Name:"SH33TJSERRY"}),o.push(R.Name);break;case"PtgParen":var C="(",oe=")";if(v>=0){switch(w="",t[0][v][1][0]){case 2:C=Ut(" ",t[0][v][1][1])+C;break;case 3:C=Ut("\r",t[0][v][1][1])+C;break;case 4:oe=Ut(" ",t[0][v][1][1])+oe;break;case 5:oe=Ut("\r",t[0][v][1][1])+oe;break;default:if(s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+t[0][v][1][0])}v=-1}o.push(C+o.pop()+oe);break;case"PtgRefErr":o.push("#REF!");break;case"PtgRefErr3d":o.push("#REF!");break;case"PtgExp":u={c:E[1][1],r:E[1][0]};var ae={c:r.c,r:r.r};if(n.sharedf[Ue(u)]){var he=n.sharedf[Ue(u)];o.push(Fr(he,i,ae,n,s))}else{var me=!1;for(l=0;l!=n.arrayf.length;++l)if(c=n.arrayf[l],!(u.c<c[0].s.c||u.c>c[0].e.c)&&!(u.r<c[0].s.r||u.r>c[0].e.r)){o.push(Fr(c[1],i,ae,n,s)),me=!0;break}me||o.push(E[1])}break;case"PtgArray":o.push("{"+dU(E[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":v=k;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":o.push("");break;case"PtgAreaErr":o.push("#REF!");break;case"PtgAreaErr3d":o.push("#REF!");break;case"PtgList":o.push("Table"+E[1].idx+"[#"+E[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(E));default:throw new Error("Unrecognized Formula Token: "+String(E))}var ee=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(s.biff!=3&&v>=0&&ee.indexOf(t[0][k][0])==-1){E=t[0][v];var H=!0;switch(E[1][0]){case 4:H=!1;case 0:w=Ut(" ",E[1][1]);break;case 5:H=!1;case 1:w=Ut("\r",E[1][1]);break;default:if(w="",s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+E[1][0])}o.push((H?w:"")+o.pop()+(H?"":w)),v=-1}}if(o.length>1&&s.WTF)throw new Error("bad formula stack");return o[0]}function gU(t,e,r){var n=t.l+e,s=r.biff==2?1:2,a,i=t.read_shift(s);if(i==65535)return[[],$r(t,e-2)];var o=Bu(t,i,r);return e!==i+s&&(a=Uu(t,e-i-s,o,r)),t.l=n,[o,a]}function vU(t,e,r){var n=t.l+e,s=r.biff==2?1:2,a,i=t.read_shift(s);if(i==65535)return[[],$r(t,e-2)];var o=Bu(t,i,r);return e!==i+s&&(a=Uu(t,e-i-s,o,r)),t.l=n,[o,a]}function xU(t,e,r,n){var s=t.l+e,a=Bu(t,n,r),i;return s!==t.l&&(i=Uu(t,s-t.l,a,r)),[a,i]}function _U(t,e,r){var n=t.l+e,s,a=t.read_shift(2),i=Bu(t,a,r);return a==65535?[[],$r(t,e-2)]:(e!==a+2&&(s=Uu(t,n-a-2,i,r)),[i,s])}function yU(t){var e;if(Js(t,t.l+6)!==65535)return[Lr(t),"n"];switch(t[t.l]){case 0:return t.l+=8,["String","s"];case 1:return e=t[t.l+2]===1,t.l+=8,[e,"b"];case 2:return e=t[t.l+2],t.l+=8,[e,"e"];case 3:return t.l+=8,["","s"]}return[]}function Z0(t,e,r){var n=t.l+e,s=Os(t);r.biff==2&&++t.l;var a=yU(t),i=t.read_shift(1);r.biff!=2&&(t.read_shift(1),r.biff>=5&&t.read_shift(4));var o=vU(t,n-t.l,r);return{cell:s,val:a[0],formula:o,shared:i>>3&1,tt:a[1]}}function e0(t,e,r){var n=t.read_shift(4),s=Bu(t,n,r),a=t.read_shift(4),i=a>0?Uu(t,a,s,r):null;return[s,i]}var wU=e0,t0=e0,EU=e0,TU=e0,kU={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},pI={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},SU={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function Lw(t){return t.slice(0,3)=="of:"&&(t=t.slice(3)),t.charCodeAt(0)==61&&(t=t.slice(1),t.charCodeAt(0)==61&&(t=t.slice(1))),t=t.replace(/COM\.MICROSOFT\./g,""),t=t.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(e,r){return r.replace(/\./g,"")}),t=t.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),t.replace(/[;~]/g,",").replace(/\|/g,";")}function em(t){var e=t.split(":"),r=e[0].split(".")[0];return[r,e[0].split(".")[1]+(e.length>1?":"+(e[1].split(".")[1]||e[1].split(".")[0]):"")]}var Ic={},qo={};function Cc(t,e){if(t){var r=[.7,.7,.75,.75,.3,.3];e=="xlml"&&(r=[1,1,1,1,.5,.5]),t.left==null&&(t.left=r[0]),t.right==null&&(t.right=r[1]),t.top==null&&(t.top=r[2]),t.bottom==null&&(t.bottom=r[3]),t.header==null&&(t.header=r[4]),t.footer==null&&(t.footer=r[5])}}function gI(t,e,r,n,s,a){try{n.cellNF&&(t.z=ze[e])}catch(o){if(n.WTF)throw o}if(!(t.t==="z"&&!n.cellStyles)){if(t.t==="d"&&typeof t.v=="string"&&(t.v=dr(t.v)),(!n||n.cellText!==!1)&&t.t!=="z")try{if(ze[e]==null&&Mi(A6[e]||"General",e),t.t==="e")t.w=t.w||oo[t.v];else if(e===0)if(t.t==="n")(t.v|0)===t.v?t.w=t.v.toString(10):t.w=iu(t.v);else if(t.t==="d"){var i=Jr(t.v);(i|0)===i?t.w=i.toString(10):t.w=iu(i)}else{if(t.v===void 0)return"";t.w=qi(t.v,qo)}else t.t==="d"?t.w=$n(e,Jr(t.v),qo):t.w=$n(e,t.v,qo)}catch(o){if(n.WTF)throw o}if(n.cellStyles&&r!=null)try{t.s=a.Fills[r],t.s.fgColor&&t.s.fgColor.theme&&!t.s.fgColor.rgb&&(t.s.fgColor.rgb=sd(s.themeElements.clrScheme[t.s.fgColor.theme].rgb,t.s.fgColor.tint||0),n.WTF&&(t.s.fgColor.raw_rgb=s.themeElements.clrScheme[t.s.fgColor.theme].rgb)),t.s.bgColor&&t.s.bgColor.theme&&(t.s.bgColor.rgb=sd(s.themeElements.clrScheme[t.s.bgColor.theme].rgb,t.s.bgColor.tint||0),n.WTF&&(t.s.bgColor.raw_rgb=s.themeElements.clrScheme[t.s.bgColor.theme].rgb))}catch(o){if(n.WTF&&a.Fills)throw o}}}function AU(t,e){var r=Bt(e);r.s.r<=r.e.r&&r.s.c<=r.e.c&&r.s.r>=0&&r.s.c>=0&&(t["!ref"]=rt(r))}var IU=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,CU=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,RU=/<(?:\w:)?hyperlink [^>]*>/mg,NU=/"(\w*:\w*)"/,PU=/<(?:\w:)?col\b[^>]*[\/]?>/g,bU=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,DU=/<(?:\w:)?pageMargins[^>]*\/>/g,vI=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,FU=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,OU=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function MU(t,e,r,n,s,a,i){if(!t)return t;n||(n={"!id":{}});var o=e.dense?[]:{},l={s:{r:2e6,c:2e6},e:{r:0,c:0}},c="",u="",h=t.match(CU);h?(c=t.slice(0,h.index),u=t.slice(h.index+h[0].length)):c=u=t;var m=c.match(vI);m?fx(m[0],o,s,r):(m=c.match(FU))&&LU(m[0],m[1]||"",o,s,r);var p=(c.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(p>0){var x=c.slice(p,p+50).match(NU);x&&AU(o,x[1])}var v=c.match(OU);v&&v[1]&&$U(v[1],s);var w=[];if(e.cellStyles){var k=c.match(PU);k&&UU(w,k)}h&&WU(h[1],o,e,l,a,i);var T=u.match(bU);T&&(o["!autofilter"]=BU(T[0]));var E=[],N=u.match(IU);if(N)for(p=0;p!=N.length;++p)E[p]=Bt(N[p].slice(N[p].indexOf('"')+1));var O=u.match(RU);O&&jU(o,O,n);var M=u.match(DU);if(M&&(o["!margins"]=VU(Oe(M[0]))),!o["!ref"]&&l.e.c>=l.s.c&&l.e.r>=l.s.r&&(o["!ref"]=rt(l)),e.sheetRows>0&&o["!ref"]){var g=Bt(o["!ref"]);e.sheetRows<=+g.e.r&&(g.e.r=e.sheetRows-1,g.e.r>l.e.r&&(g.e.r=l.e.r),g.e.r<g.s.r&&(g.s.r=g.e.r),g.e.c>l.e.c&&(g.e.c=l.e.c),g.e.c<g.s.c&&(g.s.c=g.e.c),o["!fullref"]=o["!ref"],o["!ref"]=rt(g))}return w.length>0&&(o["!cols"]=w),E.length>0&&(o["!merges"]=E),o}function fx(t,e,r,n){var s=Oe(t);r.Sheets[n]||(r.Sheets[n]={}),s.codeName&&(r.Sheets[n].CodeName=it(Et(s.codeName)))}function LU(t,e,r,n,s){fx(t.slice(0,t.indexOf(">")),r,n,s)}function jU(t,e,r){for(var n=Array.isArray(t),s=0;s!=e.length;++s){var a=Oe(Et(e[s]),!0);if(!a.ref)return;var i=((r||{})["!id"]||[])[a.id];i?(a.Target=i.Target,a.location&&(a.Target+="#"+it(a.location))):(a.Target="#"+it(a.location),i={Target:a.Target,TargetMode:"Internal"}),a.Rel=i,a.tooltip&&(a.Tooltip=a.tooltip,delete a.tooltip);for(var o=Bt(a.ref),l=o.s.r;l<=o.e.r;++l)for(var c=o.s.c;c<=o.e.c;++c){var u=Ue({c,r:l});n?(t[l]||(t[l]=[]),t[l][c]||(t[l][c]={t:"z",v:void 0}),t[l][c].l=a):(t[u]||(t[u]={t:"z",v:void 0}),t[u].l=a)}}}function VU(t){var e={};return["left","right","top","bottom","header","footer"].forEach(function(r){t[r]&&(e[r]=parseFloat(t[r]))}),e}function UU(t,e){for(var r=!1,n=0;n!=e.length;++n){var s=Oe(e[n],!0);s.hidden&&(s.hidden=Pt(s.hidden));var a=parseInt(s.min,10)-1,i=parseInt(s.max,10)-1;for(s.outlineLevel&&(s.level=+s.outlineLevel||0),delete s.min,delete s.max,s.width=+s.width,!r&&s.width&&(r=!0,cx(s.width)),ml(s);a<=i;)t[a++]=Er(s)}}function BU(t){var e={ref:(t.match(/ref="([^"]*)"/)||[])[1]};return e}var zU=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function $U(t,e){e.Views||(e.Views=[{}]),(t.match(zU)||[]).forEach(function(r,n){var s=Oe(r);e.Views[n]||(e.Views[n]={}),+s.zoomScale&&(e.Views[n].zoom=+s.zoomScale),Pt(s.rightToLeft)&&(e.Views[n].RTL=!0)})}var WU=function(){var t=/<(?:\w+:)?c[ \/>]/,e=/<\/(?:\w+:)?row>/,r=/r=["']([^"']*)["']/,n=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,s=/ref=["']([^"']*)["']/,a=ou("v"),i=ou("f");return function(l,c,u,h,m,p){for(var x=0,v="",w=[],k=[],T=0,E=0,N=0,O="",M,g,y=0,S=0,R,P,b=0,C=0,oe=Array.isArray(p.CellXf),ae,he=[],me=[],ee=Array.isArray(c),H=[],ue={},de=!1,B=!!u.sheetStubs,K=l.split(e),X=0,q=K.length;X!=q;++X){v=K[X].trim();var le=v.length;if(le!==0){var _e=0;e:for(x=0;x<le;++x)switch(v[x]){case">":if(v[x-1]!="/"){++x;break e}if(u&&u.cellStyles){if(g=Oe(v.slice(_e,x),!0),y=g.r!=null?parseInt(g.r,10):y+1,S=-1,u.sheetRows&&u.sheetRows<y)continue;ue={},de=!1,g.ht&&(de=!0,ue.hpt=parseFloat(g.ht),ue.hpx=fu(ue.hpt)),g.hidden=="1"&&(de=!0,ue.hidden=!0),g.outlineLevel!=null&&(de=!0,ue.level=+g.outlineLevel),de&&(H[y-1]=ue)}break;case"<":_e=x;break}if(_e>=x)break;if(g=Oe(v.slice(_e,x),!0),y=g.r!=null?parseInt(g.r,10):y+1,S=-1,!(u.sheetRows&&u.sheetRows<y)){h.s.r>y-1&&(h.s.r=y-1),h.e.r<y-1&&(h.e.r=y-1),u&&u.cellStyles&&(ue={},de=!1,g.ht&&(de=!0,ue.hpt=parseFloat(g.ht),ue.hpx=fu(ue.hpt)),g.hidden=="1"&&(de=!0,ue.hidden=!0),g.outlineLevel!=null&&(de=!0,ue.level=+g.outlineLevel),de&&(H[y-1]=ue)),w=v.slice(x).split(t);for(var Ce=0;Ce!=w.length&&w[Ce].trim().charAt(0)=="<";++Ce);for(w=w.slice(Ce),x=0;x!=w.length;++x)if(v=w[x].trim(),v.length!==0){if(k=v.match(r),T=x,E=0,N=0,v="<c "+(v.slice(0,1)=="<"?">":"")+v,k!=null&&k.length===2){for(T=0,O=k[1],E=0;E!=O.length&&!((N=O.charCodeAt(E)-64)<1||N>26);++E)T=26*T+N;--T,S=T}else++S;for(E=0;E!=v.length&&v.charCodeAt(E)!==62;++E);if(++E,g=Oe(v.slice(0,E),!0),g.r||(g.r=Ue({r:y-1,c:S})),O=v.slice(E),M={t:""},(k=O.match(a))!=null&&k[1]!==""&&(M.v=it(k[1])),u.cellFormula){if((k=O.match(i))!=null&&k[1]!==""){if(M.f=it(Et(k[1])).replace(/\r\n/g,`
`),u.xlfn||(M.f=Dw(M.f)),k[0].indexOf('t="array"')>-1)M.F=(O.match(s)||[])[1],M.F.indexOf(":")>-1&&he.push([Bt(M.F),M.F]);else if(k[0].indexOf('t="shared"')>-1){P=Oe(k[0]);var Te=it(Et(k[1]));u.xlfn||(Te=Dw(Te)),me[parseInt(P.si,10)]=[P,Te,g.r]}}else(k=O.match(/<f[^>]*\/>/))&&(P=Oe(k[0]),me[P.si]&&(M.f=tV(me[P.si][1],me[P.si][2],g.r)));var xe=qr(g.r);for(E=0;E<he.length;++E)xe.r>=he[E][0].s.r&&xe.r<=he[E][0].e.r&&xe.c>=he[E][0].s.c&&xe.c<=he[E][0].e.c&&(M.F=he[E][1])}if(g.t==null&&M.v===void 0)if(M.f||M.F)M.v=0,M.t="n";else if(B)M.t="z";else continue;else M.t=g.t||"n";switch(h.s.c>S&&(h.s.c=S),h.e.c<S&&(h.e.c=S),M.t){case"n":if(M.v==""||M.v==null){if(!B)continue;M.t="z"}else M.v=parseFloat(M.v);break;case"s":if(typeof M.v>"u"){if(!B)continue;M.t="z"}else R=Ic[parseInt(M.v,10)],M.v=R.t,M.r=R.r,u.cellHTML&&(M.h=R.h);break;case"str":M.t="s",M.v=M.v!=null?Et(M.v):"",u.cellHTML&&(M.h=Jv(M.v));break;case"inlineStr":k=O.match(n),M.t="s",k!=null&&(R=lx(k[1]))?(M.v=R.t,u.cellHTML&&(M.h=R.h)):M.v="";break;case"b":M.v=Pt(M.v);break;case"d":u.cellDates?M.v=dr(M.v,1):(M.v=Jr(dr(M.v,1)),M.t="n");break;case"e":(!u||u.cellText!==!1)&&(M.w=M.v),M.v=jA[M.v];break}if(b=C=0,ae=null,oe&&g.s!==void 0&&(ae=p.CellXf[g.s],ae!=null&&(ae.numFmtId!=null&&(b=ae.numFmtId),u.cellStyles&&ae.fillId!=null&&(C=ae.fillId))),gI(M,b,C,u,m,p),u.cellDates&&oe&&M.t=="n"&&Tl(ze[b])&&(M.t="d",M.v=Jd(M.v)),g.cm&&u.xlmeta){var $e=(u.xlmeta.Cell||[])[+g.cm-1];$e&&$e.type=="XLDAPR"&&(M.D=!0)}if(ee){var z=qr(g.r);c[z.r]||(c[z.r]=[]),c[z.r][z.c]=M}else c[g.r]=M}}}}H.length>0&&(c["!rows"]=H)}}();function HU(t,e){var r={},n=t.l+e;r.r=t.read_shift(4),t.l+=4;var s=t.read_shift(2);t.l+=1;var a=t.read_shift(1);return t.l=n,a&7&&(r.level=a&7),a&16&&(r.hidden=!0),a&32&&(r.hpt=s/20),r}var GU=io;function KU(){}function qU(t,e){var r={},n=t[t.l];return++t.l,r.above=!(n&64),r.left=!(n&128),t.l+=18,r.name=g8(t),r}function XU(t){var e=Wn(t);return[e]}function YU(t){var e=ao(t);return[e]}function QU(t){var e=Wn(t),r=t.read_shift(1);return[e,r,"b"]}function JU(t){var e=ao(t),r=t.read_shift(1);return[e,r,"b"]}function ZU(t){var e=Wn(t),r=t.read_shift(1);return[e,r,"e"]}function eB(t){var e=ao(t),r=t.read_shift(1);return[e,r,"e"]}function tB(t){var e=Wn(t),r=t.read_shift(4);return[e,r,"s"]}function rB(t){var e=ao(t),r=t.read_shift(4);return[e,r,"s"]}function nB(t){var e=Wn(t),r=Lr(t);return[e,r,"n"]}function xI(t){var e=ao(t),r=Lr(t);return[e,r,"n"]}function sB(t){var e=Wn(t),r=ax(t);return[e,r,"n"]}function aB(t){var e=ao(t),r=ax(t);return[e,r,"n"]}function iB(t){var e=Wn(t),r=nx(t);return[e,r,"is"]}function oB(t){var e=Wn(t),r=Ur(t);return[e,r,"str"]}function lB(t){var e=ao(t),r=Ur(t);return[e,r,"str"]}function cB(t,e,r){var n=t.l+e,s=Wn(t);s.r=r["!row"];var a=t.read_shift(1),i=[s,a,"b"];if(r.cellFormula){t.l+=2;var o=t0(t,n-t.l,r);i[3]=Fr(o,null,s,r.supbooks,r)}else t.l=n;return i}function uB(t,e,r){var n=t.l+e,s=Wn(t);s.r=r["!row"];var a=t.read_shift(1),i=[s,a,"e"];if(r.cellFormula){t.l+=2;var o=t0(t,n-t.l,r);i[3]=Fr(o,null,s,r.supbooks,r)}else t.l=n;return i}function fB(t,e,r){var n=t.l+e,s=Wn(t);s.r=r["!row"];var a=Lr(t),i=[s,a,"n"];if(r.cellFormula){t.l+=2;var o=t0(t,n-t.l,r);i[3]=Fr(o,null,s,r.supbooks,r)}else t.l=n;return i}function hB(t,e,r){var n=t.l+e,s=Wn(t);s.r=r["!row"];var a=Ur(t),i=[s,a,"str"];if(r.cellFormula){t.l+=2;var o=t0(t,n-t.l,r);i[3]=Fr(o,null,s,r.supbooks,r)}else t.l=n;return i}var dB=io;function mB(t,e){var r=t.l+e,n=io(t),s=sx(t),a=Ur(t),i=Ur(t),o=Ur(t);t.l=r;var l={rfx:n,relId:s,loc:a,display:o};return i&&(l.Tooltip=i),l}function pB(){}function gB(t,e,r){var n=t.l+e,s=OA(t),a=t.read_shift(1),i=[s];if(i[2]=a,r.cellFormula){var o=wU(t,n-t.l,r);i[1]=o}else t.l=n;return i}function vB(t,e,r){var n=t.l+e,s=io(t),a=[s];if(r.cellFormula){var i=TU(t,n-t.l,r);a[1]=i,t.l=n}else t.l=n;return a}var xB=["left","right","top","bottom","header","footer"];function _B(t){var e={};return xB.forEach(function(r){e[r]=Lr(t)}),e}function yB(t){var e=t.read_shift(2);return t.l+=28,{RTL:e&32}}function wB(){}function EB(){}function TB(t,e,r,n,s,a,i){if(!t)return t;var o=e||{};n||(n={"!id":{}});var l=o.dense?[]:{},c,u={s:{r:2e6,c:2e6},e:{r:0,c:0}},h=!1,m=!1,p,x,v,w,k,T,E,N,O,M=[];o.biff=12,o["!row"]=0;var g=0,y=!1,S=[],R={},P=o.supbooks||s.supbooks||[[]];if(P.sharedf=R,P.arrayf=S,P.SheetNames=s.SheetNames||s.Sheets.map(function(ee){return ee.name}),!o.supbooks&&(o.supbooks=P,s.Names))for(var b=0;b<s.Names.length;++b)P[0][b+1]=s.Names[b];var C=[],oe=[],ae=!1;od[16]={n:"BrtShortReal",f:xI};var he;if(ya(t,function(H,ue,de){if(!m)switch(de){case 148:c=H;break;case 0:p=H,o.sheetRows&&o.sheetRows<=p.r&&(m=!0),N=Tr(w=p.r),o["!row"]=p.r,(H.hidden||H.hpt||H.level!=null)&&(H.hpt&&(H.hpx=fu(H.hpt)),oe[H.r]=H);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(x={t:H[2]},H[2]){case"n":x.v=H[1];break;case"s":E=Ic[H[1]],x.v=E.t,x.r=E.r;break;case"b":x.v=!!H[1];break;case"e":x.v=H[1],o.cellText!==!1&&(x.w=oo[x.v]);break;case"str":x.t="s",x.v=H[1];break;case"is":x.t="s",x.v=H[1].t;break}if((v=i.CellXf[H[0].iStyleRef])&&gI(x,v.numFmtId,null,o,a,i),k=H[0].c==-1?k+1:H[0].c,o.dense?(l[w]||(l[w]=[]),l[w][k]=x):l[sr(k)+N]=x,o.cellFormula){for(y=!1,g=0;g<S.length;++g){var B=S[g];p.r>=B[0].s.r&&p.r<=B[0].e.r&&k>=B[0].s.c&&k<=B[0].e.c&&(x.F=rt(B[0]),y=!0)}!y&&H.length>3&&(x.f=H[3])}if(u.s.r>p.r&&(u.s.r=p.r),u.s.c>k&&(u.s.c=k),u.e.r<p.r&&(u.e.r=p.r),u.e.c<k&&(u.e.c=k),o.cellDates&&v&&x.t=="n"&&Tl(ze[v.numFmtId])){var K=Pi(x.v);K&&(x.t="d",x.v=new Date(K.y,K.m-1,K.d,K.H,K.M,K.S,K.u))}he&&(he.type=="XLDAPR"&&(x.D=!0),he=void 0);break;case 1:case 12:if(!o.sheetStubs||h)break;x={t:"z",v:void 0},k=H[0].c==-1?k+1:H[0].c,o.dense?(l[w]||(l[w]=[]),l[w][k]=x):l[sr(k)+N]=x,u.s.r>p.r&&(u.s.r=p.r),u.s.c>k&&(u.s.c=k),u.e.r<p.r&&(u.e.r=p.r),u.e.c<k&&(u.e.c=k),he&&(he.type=="XLDAPR"&&(x.D=!0),he=void 0);break;case 176:M.push(H);break;case 49:he=((o.xlmeta||{}).Cell||[])[H-1];break;case 494:var X=n["!id"][H.relId];for(X?(H.Target=X.Target,H.loc&&(H.Target+="#"+H.loc),H.Rel=X):H.relId==""&&(H.Target="#"+H.loc),w=H.rfx.s.r;w<=H.rfx.e.r;++w)for(k=H.rfx.s.c;k<=H.rfx.e.c;++k)o.dense?(l[w]||(l[w]=[]),l[w][k]||(l[w][k]={t:"z",v:void 0}),l[w][k].l=H):(T=Ue({c:k,r:w}),l[T]||(l[T]={t:"z",v:void 0}),l[T].l=H);break;case 426:if(!o.cellFormula)break;S.push(H),O=o.dense?l[w][k]:l[sr(k)+N],O.f=Fr(H[1],u,{r:p.r,c:k},P,o),O.F=rt(H[0]);break;case 427:if(!o.cellFormula)break;R[Ue(H[0].s)]=H[1],O=o.dense?l[w][k]:l[sr(k)+N],O.f=Fr(H[1],u,{r:p.r,c:k},P,o);break;case 60:if(!o.cellStyles)break;for(;H.e>=H.s;)C[H.e--]={width:H.w/256,hidden:!!(H.flags&1),level:H.level},ae||(ae=!0,cx(H.w/256)),ml(C[H.e+1]);break;case 161:l["!autofilter"]={ref:rt(H)};break;case 476:l["!margins"]=H;break;case 147:s.Sheets[r]||(s.Sheets[r]={}),H.name&&(s.Sheets[r].CodeName=H.name),(H.above||H.left)&&(l["!outline"]={above:H.above,left:H.left});break;case 137:s.Views||(s.Views=[{}]),s.Views[0]||(s.Views[0]={}),H.RTL&&(s.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:h=!0;break;case 36:h=!1;break;case 37:h=!0;break;case 38:h=!1;break;default:if(!ue.T){if(!h||o.WTF)throw new Error("Unexpected record 0x"+de.toString(16))}}},o),delete o.supbooks,delete o["!row"],!l["!ref"]&&(u.s.r<2e6||c&&(c.e.r>0||c.e.c>0||c.s.r>0||c.s.c>0))&&(l["!ref"]=rt(c||u)),o.sheetRows&&l["!ref"]){var me=Bt(l["!ref"]);o.sheetRows<=+me.e.r&&(me.e.r=o.sheetRows-1,me.e.r>u.e.r&&(me.e.r=u.e.r),me.e.r<me.s.r&&(me.s.r=me.e.r),me.e.c>u.e.c&&(me.e.c=u.e.c),me.e.c<me.s.c&&(me.s.c=me.e.c),l["!fullref"]=l["!ref"],l["!ref"]=rt(me))}return M.length>0&&(l["!merges"]=M),C.length>0&&(l["!cols"]=C),oe.length>0&&(l["!rows"]=oe),l}function kB(t){var e=[],r=t.match(/^<c:numCache>/),n;(t.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(a){var i=a.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);i&&(e[+i[1]]=r?+i[2]:i[2])});var s=it((t.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(t.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(a){n=a.replace(/<.*?>/g,"")}),[e,s,n]}function SB(t,e,r,n,s,a){var i=a||{"!type":"chart"};if(!t)return a;var o=0,l=0,c="A",u={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(t.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(h){var m=kB(h);u.s.r=u.s.c=0,u.e.c=o,c=sr(o),m[0].forEach(function(p,x){i[c+Tr(x)]={t:"n",v:p,z:m[1]},l=x}),u.e.r<l&&(u.e.r=l),++o}),o>0&&(i["!ref"]=rt(u)),i}function AB(t,e,r,n,s){if(!t)return t;n||(n={"!id":{}});var a={"!type":"chart","!drawel":null,"!rel":""},i,o=t.match(vI);return o&&fx(o[0],a,s,r),(i=t.match(/drawing r:id="(.*?)"/))&&(a["!rel"]=i[1]),n["!id"][a["!rel"]]&&(a["!drawel"]=n["!id"][a["!rel"]]),a}function IB(t,e){t.l+=10;var r=Ur(t);return{name:r}}function CB(t,e,r,n,s){if(!t)return t;n||(n={"!id":{}});var a={"!type":"chart","!drawel":null,"!rel":""},i=!1;return ya(t,function(l,c,u){switch(u){case 550:a["!rel"]=l;break;case 651:s.Sheets[r]||(s.Sheets[r]={}),l.name&&(s.Sheets[r].CodeName=l.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:i=!0;break;case 36:i=!1;break;case 37:break;case 38:break;default:if(!(c.T>0)){if(!(c.T<0)){if(!i||e.WTF)throw new Error("Unexpected record 0x"+u.toString(16))}}}},e),n["!id"][a["!rel"]]&&(a["!drawel"]=n["!id"][a["!rel"]]),a}var _I=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],RB=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],NB=[],PB=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function jw(t,e){for(var r=0;r!=t.length;++r)for(var n=t[r],s=0;s!=e.length;++s){var a=e[s];if(n[a[0]]==null)n[a[0]]=a[1];else switch(a[2]){case"bool":typeof n[a[0]]=="string"&&(n[a[0]]=Pt(n[a[0]]));break;case"int":typeof n[a[0]]=="string"&&(n[a[0]]=parseInt(n[a[0]],10));break}}}function Vw(t,e){for(var r=0;r!=e.length;++r){var n=e[r];if(t[n[0]]==null)t[n[0]]=n[1];else switch(n[2]){case"bool":typeof t[n[0]]=="string"&&(t[n[0]]=Pt(t[n[0]]));break;case"int":typeof t[n[0]]=="string"&&(t[n[0]]=parseInt(t[n[0]],10));break}}}function yI(t){Vw(t.WBProps,_I),Vw(t.CalcPr,PB),jw(t.WBView,RB),jw(t.Sheets,NB),qo.date1904=Pt(t.WBProps.date1904)}var bB="][*?/\\".split("");function DB(t,e){if(t.length>31)throw new Error("Sheet names cannot exceed 31 chars");var r=!0;return bB.forEach(function(n){if(t.indexOf(n)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),r}var FB=/<\w+:workbook/;function OB(t,e){if(!t)throw new Error("Could not find file");var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},n=!1,s="xmlns",a={},i=0;if(t.replace(Wr,function(l,c){var u=Oe(l);switch(Fs(u[0])){case"<?xml":break;case"<workbook":l.match(FB)&&(s="xmlns"+l.match(/<(\w+):/)[1]),r.xmlns=u[s];break;case"</workbook>":break;case"<fileVersion":delete u[0],r.AppVersion=u;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":_I.forEach(function(h){if(u[h[0]]!=null)switch(h[2]){case"bool":r.WBProps[h[0]]=Pt(u[h[0]]);break;case"int":r.WBProps[h[0]]=parseInt(u[h[0]],10);break;default:r.WBProps[h[0]]=u[h[0]]}}),u.codeName&&(r.WBProps.CodeName=Et(u.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete u[0],r.WBView.push(u);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(u.state){case"hidden":u.Hidden=1;break;case"veryHidden":u.Hidden=2;break;default:u.Hidden=0}delete u.state,u.name=it(Et(u.name)),delete u[0],r.Sheets.push(u);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":n=!0;break;case"</definedNames>":n=!1;break;case"<definedName":a={},a.Name=Et(u.name),u.comment&&(a.Comment=u.comment),u.localSheetId&&(a.Sheet=+u.localSheetId),Pt(u.hidden||"0")&&(a.Hidden=!0),i=c+l.length;break;case"</definedName>":a.Ref=it(Et(t.slice(i,c))),r.Names.push(a);break;case"<definedName/>":break;case"<calcPr":delete u[0],r.CalcPr=u;break;case"<calcPr/>":delete u[0],r.CalcPr=u;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":n=!0;break;case"</AlternateContent>":n=!1;break;case"<revisionPtr":break;default:if(!n&&e.WTF)throw new Error("unrecognized "+u[0]+" in workbook")}return l}),Z6.indexOf(r.xmlns)===-1)throw new Error("Unknown Namespace: "+r.xmlns);return yI(r),r}function MB(t,e){var r={};return r.Hidden=t.read_shift(4),r.iTabID=t.read_shift(4),r.strRelID=Np(t),r.name=Ur(t),r}function LB(t,e){var r={},n=t.read_shift(4);r.defaultThemeVersion=t.read_shift(4);var s=e>8?Ur(t):"";return s.length>0&&(r.CodeName=s),r.autoCompressPictures=!!(n&65536),r.backupFile=!!(n&64),r.checkCompatibility=!!(n&4096),r.date1904=!!(n&1),r.filterPrivacy=!!(n&8),r.hidePivotFieldList=!!(n&1024),r.promptedSolutions=!!(n&16),r.publishItems=!!(n&2048),r.refreshAllConnections=!!(n&262144),r.saveExternalLinkValues=!!(n&128),r.showBorderUnselectedTables=!!(n&4),r.showInkAnnotation=!!(n&32),r.showObjects=["all","placeholders","none"][n>>13&3],r.showPivotChartFilter=!!(n&32768),r.updateLinks=["userSet","never","always"][n>>8&3],r}function jB(t,e){var r={};return t.read_shift(4),r.ArchID=t.read_shift(4),t.l+=e-8,r}function VB(t,e,r){var n=t.l+e;t.l+=4,t.l+=1;var s=t.read_shift(4),a=v8(t),i=EU(t,0,r),o=sx(t);t.l=n;var l={Name:a,Ptg:i};return s<268435455&&(l.Sheet=s),o&&(l.Comment=o),l}function UB(t,e){var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},n=[],s=!1;e||(e={}),e.biff=12;var a=[],i=[[]];return i.SheetNames=[],i.XTI=[],od[16]={n:"BrtFRTArchID$",f:jB},ya(t,function(l,c,u){switch(u){case 156:i.SheetNames.push(l.name),r.Sheets.push(l);break;case 153:r.WBProps=l;break;case 39:l.Sheet!=null&&(e.SID=l.Sheet),l.Ref=Fr(l.Ptg,null,null,i,e),delete e.SID,delete l.Ptg,a.push(l);break;case 1036:break;case 357:case 358:case 355:case 667:i[0].length?i.push([u,l]):i[0]=[u,l],i[i.length-1].XTI=[];break;case 362:i.length===0&&(i[0]=[],i[0].XTI=[]),i[i.length-1].XTI=i[i.length-1].XTI.concat(l),i.XTI=i.XTI.concat(l);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:n.push(u),s=!0;break;case 36:n.pop(),s=!1;break;case 37:n.push(u),s=!0;break;case 38:n.pop(),s=!1;break;case 16:break;default:if(!c.T){if(!s||e.WTF&&n[n.length-1]!=37&&n[n.length-1]!=35)throw new Error("Unexpected record 0x"+u.toString(16))}}},e),yI(r),r.Names=a,r.supbooks=i,r}function BB(t,e,r){return e.slice(-4)===".bin"?UB(t,r):OB(t,r)}function zB(t,e,r,n,s,a,i,o){return e.slice(-4)===".bin"?TB(t,n,r,s,a,i,o):MU(t,n,r,s,a,i,o)}function $B(t,e,r,n,s,a,i,o){return e.slice(-4)===".bin"?CB(t,n,r,s,a):AB(t,n,r,s,a)}function WB(t,e,r,n,s,a,i,o){return e.slice(-4)===".bin"?J9():Z9()}function HB(t,e,r,n,s,a,i,o){return e.slice(-4)===".bin"?Y9():Q9()}function GB(t,e,r,n){return e.slice(-4)===".bin"?d9(t,r,n):o9(t,r,n)}function KB(t,e,r){return iI(t,r)}function qB(t,e,r){return e.slice(-4)===".bin"?Rj(t,r):Ij(t,r)}function XB(t,e,r){return e.slice(-4)===".bin"?K9(t,r):z9(t,r)}function YB(t,e,r){return e.slice(-4)===".bin"?V9(t):L9(t)}function QB(t,e,r,n){return r.slice(-4)===".bin"?U9(t,e,r,n):void 0}function JB(t,e,r){return e.slice(-4)===".bin"?O9(t,e,r):M9(t,e,r)}var wI=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,EI=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function qn(t,e){var r=t.split(/\s+/),n=[];if(n[0]=r[0],r.length===1)return n;var s=t.match(wI),a,i,o,l;if(s)for(l=0;l!=s.length;++l)a=s[l].match(EI),(i=a[1].indexOf(":"))===-1?n[a[1]]=a[2].slice(1,a[2].length-1):(a[1].slice(0,6)==="xmlns:"?o="xmlns"+a[1].slice(6):o=a[1].slice(i+1),n[o]=a[2].slice(1,a[2].length-1));return n}function ZB(t){var e=t.split(/\s+/),r={};if(e.length===1)return r;var n=t.match(wI),s,a,i,o;if(n)for(o=0;o!=n.length;++o)s=n[o].match(EI),(a=s[1].indexOf(":"))===-1?r[s[1]]=s[2].slice(1,s[2].length-1):(s[1].slice(0,6)==="xmlns:"?i="xmlns"+s[1].slice(6):i=s[1].slice(a+1),r[i]=s[2].slice(1,s[2].length-1));return r}var Rc;function e7(t,e){var r=Rc[t]||it(t);return r==="General"?qi(e):$n(r,e)}function t7(t,e,r,n){var s=n;switch((r[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":s=Pt(n);break;case"i2":case"int":s=parseInt(n,10);break;case"r4":case"float":s=parseFloat(n);break;case"date":case"dateTime.tz":s=dr(n);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+r[0])}t[it(e)]=s}function r7(t,e,r){if(t.t!=="z"){if(!r||r.cellText!==!1)try{t.t==="e"?t.w=t.w||oo[t.v]:e==="General"?t.t==="n"?(t.v|0)===t.v?t.w=t.v.toString(10):t.w=iu(t.v):t.w=qi(t.v):t.w=e7(e||"General",t.v)}catch(a){if(r.WTF)throw a}try{var n=Rc[e]||e||"General";if(r.cellNF&&(t.z=n),r.cellDates&&t.t=="n"&&Tl(n)){var s=Pi(t.v);s&&(t.t="d",t.v=new Date(s.y,s.m-1,s.d,s.H,s.M,s.S,s.u))}}catch(a){if(r.WTF)throw a}}}function n7(t,e,r){if(r.cellStyles&&e.Interior){var n=e.Interior;n.Pattern&&(n.patternType=t9[n.Pattern]||n.Pattern)}t[e.ID]=e}function s7(t,e,r,n,s,a,i,o,l,c){var u="General",h=n.StyleID,m={};c=c||{};var p=[],x=0;for(h===void 0&&o&&(h=o.StyleID),h===void 0&&i&&(h=i.StyleID);a[h]!==void 0&&(a[h].nf&&(u=a[h].nf),a[h].Interior&&p.push(a[h].Interior),!!a[h].Parent);)h=a[h].Parent;switch(r.Type){case"Boolean":n.t="b",n.v=Pt(t);break;case"String":n.t="s",n.r=ow(it(t)),n.v=t.indexOf("<")>-1?it(e||t).replace(/<.*?>/g,""):n.r;break;case"DateTime":t.slice(-1)!="Z"&&(t+="Z"),n.v=(dr(t)-new Date(Date.UTC(1899,11,30)))/(24*60*60*1e3),n.v!==n.v?n.v=it(t):n.v<60&&(n.v=n.v-1),(!u||u=="General")&&(u="yyyy-mm-dd");case"Number":n.v===void 0&&(n.v=+t),n.t||(n.t="n");break;case"Error":n.t="e",n.v=jA[t],c.cellText!==!1&&(n.w=t);break;default:t==""&&e==""?n.t="z":(n.t="s",n.v=ow(e||t));break}if(r7(n,u,c),c.cellFormula!==!1)if(n.Formula){var v=it(n.Formula);v.charCodeAt(0)==61&&(v=v.slice(1)),n.f=Ko(v,s),delete n.Formula,n.ArrayRange=="RC"?n.F=Ko("RC:RC",s):n.ArrayRange&&(n.F=Ko(n.ArrayRange,s),l.push([Bt(n.F),n.F]))}else for(x=0;x<l.length;++x)s.r>=l[x][0].s.r&&s.r<=l[x][0].e.r&&s.c>=l[x][0].s.c&&s.c<=l[x][0].e.c&&(n.F=l[x][1]);c.cellStyles&&(p.forEach(function(w){!m.patternType&&w.patternType&&(m.patternType=w.patternType)}),n.s=m),n.StyleID!==void 0&&(n.ixfe=n.StyleID)}function a7(t){t.t=t.v||"",t.t=t.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),t.v=t.w=t.ixfe=void 0}function tm(t,e){var r=e||{};uA();var n=rc(Zv(t));(r.type=="binary"||r.type=="array"||r.type=="base64")&&(n=Et(n));var s=n.slice(0,1024).toLowerCase(),a=!1;if(s=s.replace(/".*?"/g,""),(s.indexOf(">")&1023)>Math.min(s.indexOf(",")&1023,s.indexOf(";")&1023)){var i=Er(r);return i.type="string",cu.to_workbook(n,i)}if(s.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(Tt){s.indexOf("<"+Tt)>=0&&(a=!0)}),a)return m7(n,r);Rc={"General Number":"General","General Date":ze[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":ze[15],"Short Date":ze[14],"Long Time":ze[19],"Medium Time":ze[18],"Short Time":ze[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:ze[2],Standard:ze[4],Percent:ze[10],Scientific:ze[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var o,l=[],c,u={},h=[],m=r.dense?[]:{},p="",x={},v={},w=qn('<Data ss:Type="String">'),k=0,T=0,E=0,N={s:{r:2e6,c:2e6},e:{r:0,c:0}},O={},M={},g="",y=0,S=[],R={},P={},b=0,C=[],oe=[],ae={},he=[],me,ee=!1,H=[],ue=[],de={},B=0,K=0,X={Sheets:[],WBProps:{date1904:!1}},q={};lu.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"");for(var le="";o=lu.exec(n);)switch(o[3]=(le=o[3]).toLowerCase()){case"data":if(le=="data"){if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&l.push([o[3],!0]);break}if(l[l.length-1][1])break;o[1]==="/"?s7(n.slice(k,o.index),g,w,l[l.length-1][0]=="comment"?ae:x,{c:T,r:E},O,he[T],v,H,r):(g="",w=qn(o[0]),k=o.index+o[0].length);break;case"cell":if(o[1]==="/")if(oe.length>0&&(x.c=oe),(!r.sheetRows||r.sheetRows>E)&&x.v!==void 0&&(r.dense?(m[E]||(m[E]=[]),m[E][T]=x):m[sr(T)+Tr(E)]=x),x.HRef&&(x.l={Target:it(x.HRef)},x.HRefScreenTip&&(x.l.Tooltip=x.HRefScreenTip),delete x.HRef,delete x.HRefScreenTip),(x.MergeAcross||x.MergeDown)&&(B=T+(parseInt(x.MergeAcross,10)|0),K=E+(parseInt(x.MergeDown,10)|0),S.push({s:{c:T,r:E},e:{c:B,r:K}})),!r.sheetStubs)x.MergeAcross?T=B+1:++T;else if(x.MergeAcross||x.MergeDown){for(var _e=T;_e<=B;++_e)for(var Ce=E;Ce<=K;++Ce)(_e>T||Ce>E)&&(r.dense?(m[Ce]||(m[Ce]=[]),m[Ce][_e]={t:"z"}):m[sr(_e)+Tr(Ce)]={t:"z"});T=B+1}else++T;else x=ZB(o[0]),x.Index&&(T=+x.Index-1),T<N.s.c&&(N.s.c=T),T>N.e.c&&(N.e.c=T),o[0].slice(-2)==="/>"&&++T,oe=[];break;case"row":o[1]==="/"||o[0].slice(-2)==="/>"?(E<N.s.r&&(N.s.r=E),E>N.e.r&&(N.e.r=E),o[0].slice(-2)==="/>"&&(v=qn(o[0]),v.Index&&(E=+v.Index-1)),T=0,++E):(v=qn(o[0]),v.Index&&(E=+v.Index-1),de={},(v.AutoFitHeight=="0"||v.Height)&&(de.hpx=parseInt(v.Height,10),de.hpt=aI(de.hpx),ue[E]=de),v.Hidden=="1"&&(de.hidden=!0,ue[E]=de));break;case"worksheet":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"));h.push(p),N.s.r<=N.e.r&&N.s.c<=N.e.c&&(m["!ref"]=rt(N),r.sheetRows&&r.sheetRows<=N.e.r&&(m["!fullref"]=m["!ref"],N.e.r=r.sheetRows-1,m["!ref"]=rt(N))),S.length&&(m["!merges"]=S),he.length>0&&(m["!cols"]=he),ue.length>0&&(m["!rows"]=ue),u[p]=m}else N={s:{r:2e6,c:2e6},e:{r:0,c:0}},E=T=0,l.push([o[3],!1]),c=qn(o[0]),p=it(c.Name),m=r.dense?[]:{},S=[],H=[],ue=[],q={name:p,Hidden:0},X.Sheets.push(q);break;case"table":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else{if(o[0].slice(-2)=="/>")break;l.push([o[3],!1]),he=[],ee=!1}break;case"style":o[1]==="/"?n7(O,M,r):M=qn(o[0]);break;case"numberformat":M.nf=it(qn(o[0]).Format||"General"),Rc[M.nf]&&(M.nf=Rc[M.nf]);for(var Te=0;Te!=392&&ze[Te]!=M.nf;++Te);if(Te==392){for(Te=57;Te!=392;++Te)if(ze[Te]==null){Mi(M.nf,Te);break}}break;case"column":if(l[l.length-1][0]!=="table")break;if(me=qn(o[0]),me.Hidden&&(me.hidden=!0,delete me.Hidden),me.Width&&(me.wpx=parseInt(me.Width,10)),!ee&&me.wpx>10){ee=!0,Kr=nI;for(var xe=0;xe<he.length;++xe)he[xe]&&ml(he[xe])}ee&&ml(me),he[me.Index-1||he.length]=me;for(var $e=0;$e<+me.Span;++$e)he[he.length]=Er(me);break;case"namedrange":if(o[1]==="/")break;X.Names||(X.Names=[]);var z=Oe(o[0]),ot={Name:z.Name,Ref:Ko(z.RefersTo.slice(1),{r:0,c:0})};X.Sheets.length>0&&(ot.Sheet=X.Sheets.length-1),X.Names.push(ot);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(o[0].slice(-2)==="/>")break;o[1]==="/"?g+=n.slice(y,o.index):y=o.index+o[0].length;break;case"interior":if(!r.cellStyles)break;M.Interior=qn(o[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(o[0].slice(-2)==="/>")break;o[1]==="/"?z8(R,le,n.slice(b,o.index)):b=o.index+o[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else l.push([o[3],!1]);break;case"comment":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"));a7(ae),oe.push(ae)}else l.push([o[3],!1]),c=qn(o[0]),ae={a:c.Author};break;case"autofilter":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else if(o[0].charAt(o[0].length-2)!=="/"){var He=qn(o[0]);m["!autofilter"]={ref:Ko(He.Range).replace(/\$/g,"")},l.push([o[3],!0])}break;case"name":break;case"datavalidation":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&l.push([o[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&l.push([o[3],!0]);break;case"null":break;default:if(l.length==0&&o[3]=="document"||l.length==0&&o[3]=="uof")return Hw(n,r);var nt=!0;switch(l[l.length-1][0]){case"officedocumentsettings":switch(o[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:nt=!1}break;case"componentoptions":switch(o[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:nt=!1}break;case"excelworkbook":switch(o[3]){case"date1904":X.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:nt=!1}break;case"workbookoptions":switch(o[3]){case"owcversion":break;case"height":break;case"width":break;default:nt=!1}break;case"worksheetoptions":switch(o[3]){case"visible":if(o[0].slice(-2)!=="/>")if(o[1]==="/")switch(n.slice(b,o.index)){case"SheetHidden":q.Hidden=1;break;case"SheetVeryHidden":q.Hidden=2;break}else b=o.index+o[0].length;break;case"header":m["!margins"]||Cc(m["!margins"]={},"xlml"),isNaN(+Oe(o[0]).Margin)||(m["!margins"].header=+Oe(o[0]).Margin);break;case"footer":m["!margins"]||Cc(m["!margins"]={},"xlml"),isNaN(+Oe(o[0]).Margin)||(m["!margins"].footer=+Oe(o[0]).Margin);break;case"pagemargins":var Fe=Oe(o[0]);m["!margins"]||Cc(m["!margins"]={},"xlml"),isNaN(+Fe.Top)||(m["!margins"].top=+Fe.Top),isNaN(+Fe.Left)||(m["!margins"].left=+Fe.Left),isNaN(+Fe.Right)||(m["!margins"].right=+Fe.Right),isNaN(+Fe.Bottom)||(m["!margins"].bottom=+Fe.Bottom);break;case"displayrighttoleft":X.Views||(X.Views=[]),X.Views[0]||(X.Views[0]={}),X.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":m["!outline"]||(m["!outline"]={}),m["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":m["!outline"]||(m["!outline"]={}),m["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:nt=!1}break;case"pivottable":case"pivotcache":switch(o[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:nt=!1}break;case"pagebreaks":switch(o[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:nt=!1}break;case"autofilter":switch(o[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:nt=!1}break;case"querytable":switch(o[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:nt=!1}break;case"datavalidation":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:nt=!1}break;case"sorting":case"conditionalformatting":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:nt=!1}break;case"mapinfo":case"schema":case"data":switch(o[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:nt=!1}break;case"smarttags":break;default:nt=!1;break}if(nt||o[3].match(/!\[CDATA/))break;if(!l[l.length-1][1])throw"Unrecognized tag: "+o[3]+"|"+l.join("|");if(l[l.length-1][0]==="customdocumentproperties"){if(o[0].slice(-2)==="/>")break;o[1]==="/"?t7(P,le,C,n.slice(b,o.index)):(C=o,b=o.index+o[0].length);break}if(r.WTF)throw"Unrecognized tag: "+o[3]+"|"+l.join("|")}var Ae={};return!r.bookSheets&&!r.bookProps&&(Ae.Sheets=u),Ae.SheetNames=h,Ae.Workbook=X,Ae.SSF=Er(ze),Ae.Props=R,Ae.Custprops=P,Ae}function Fp(t,e){switch(mx(e=e||{}),e.type||"base64"){case"base64":return tm(An(t),e);case"binary":case"buffer":case"file":return tm(t,e);case"array":return tm(so(t),e)}}function i7(t){var e={},r=t.content;if(r.l=28,e.AnsiUserType=r.read_shift(0,"lpstr-ansi"),e.AnsiClipboardFormat=y8(r),r.length-r.l<=4)return e;var n=r.read_shift(4);if(n==0||n>40||(r.l-=4,e.Reserved1=r.read_shift(0,"lpstr-ansi"),r.length-r.l<=4)||(n=r.read_shift(4),n!==1907505652)||(e.UnicodeClipboardFormat=w8(r),n=r.read_shift(4),n==0||n>40))return e;r.l-=4,e.Reserved2=r.read_shift(0,"lpwstr")}var o7=[60,1084,2066,2165,2175];function l7(t,e,r,n,s){var a=n,i=[],o=r.slice(r.l,r.l+a);if(s&&s.enc&&s.enc.insitu&&o.length>0)switch(t){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:s.enc.insitu(o)}i.push(o),r.l+=a;for(var l=Js(r,r.l),c=Op[l],u=0;c!=null&&o7.indexOf(l)>-1;)a=Js(r,r.l+2),u=r.l+4,l==2066?u+=4:(l==2165||l==2175)&&(u+=12),o=r.slice(u,r.l+4+a),i.push(o),r.l+=4+a,c=Op[l=Js(r,r.l)];var h=Oa(i);xr(h,0);var m=0;h.lens=[];for(var p=0;p<i.length;++p)h.lens.push(m),m+=i[p].length;if(h.length<n)throw"XLS Record 0x"+t.toString(16)+" Truncated: "+h.length+" < "+n;return e.f(h,h.length,s)}function gs(t,e,r){if(t.t!=="z"&&t.XF){var n=0;try{n=t.z||t.XF.numFmtId||0,e.cellNF&&(t.z=ze[n])}catch(a){if(e.WTF)throw a}if(!e||e.cellText!==!1)try{t.t==="e"?t.w=t.w||oo[t.v]:n===0||n=="General"?t.t==="n"?(t.v|0)===t.v?t.w=t.v.toString(10):t.w=iu(t.v):t.w=qi(t.v):t.w=$n(n,t.v,{date1904:!!r,dateNF:e&&e.dateNF})}catch(a){if(e.WTF)throw a}if(e.cellDates&&n&&t.t=="n"&&Tl(ze[n]||String(n))){var s=Pi(t.v);s&&(t.t="d",t.v=new Date(s.y,s.m-1,s.d,s.H,s.M,s.S,s.u))}}}function Df(t,e,r){return{v:t,ixfe:e,t:r}}function c7(t,e){var r={opts:{}},n={},s=e.dense?[]:{},a={},i={},o=null,l=[],c="",u={},h,m="",p,x,v,w,k={},T=[],E,N,O=[],M=[],g={Sheets:[],WBProps:{date1904:!1},Views:[{}]},y={},S=function(je){return je<8?Li[je]:je<64&&M[je-8]||Li[je]},R=function(je,xt,Gt){var ut=xt.XF.data;if(!(!ut||!ut.patternType||!Gt||!Gt.cellStyles)){xt.s={},xt.s.patternType=ut.patternType;var pn;(pn=uu(S(ut.icvFore)))&&(xt.s.fgColor={rgb:pn}),(pn=uu(S(ut.icvBack)))&&(xt.s.bgColor={rgb:pn})}},P=function(je,xt,Gt){if(!(de>1)&&!(Gt.sheetRows&&je.r>=Gt.sheetRows)){if(Gt.cellStyles&&xt.XF&&xt.XF.data&&R(je,xt,Gt),delete xt.ixfe,delete xt.XF,h=je,m=Ue(je),(!i||!i.s||!i.e)&&(i={s:{r:0,c:0},e:{r:0,c:0}}),je.r<i.s.r&&(i.s.r=je.r),je.c<i.s.c&&(i.s.c=je.c),je.r+1>i.e.r&&(i.e.r=je.r+1),je.c+1>i.e.c&&(i.e.c=je.c+1),Gt.cellFormula&&xt.f){for(var ut=0;ut<T.length;++ut)if(!(T[ut][0].s.c>je.c||T[ut][0].s.r>je.r)&&!(T[ut][0].e.c<je.c||T[ut][0].e.r<je.r)){xt.F=rt(T[ut][0]),(T[ut][0].s.c!=je.c||T[ut][0].s.r!=je.r)&&delete xt.f,xt.f&&(xt.f=""+Fr(T[ut][1],i,je,H,b));break}}Gt.dense?(s[je.r]||(s[je.r]=[]),s[je.r][je.c]=xt):s[m]=xt}},b={enc:!1,sbcch:0,snames:[],sharedf:k,arrayf:T,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!e&&!!e.cellStyles,WTF:!!e&&!!e.wtf};e.password&&(b.password=e.password);var C,oe=[],ae=[],he=[],me=[],ee=!1,H=[];H.SheetNames=b.snames,H.sharedf=b.sharedf,H.arrayf=b.arrayf,H.names=[],H.XTI=[];var ue=0,de=0,B=0,K=[],X=[],q;b.codepage=1200,ns(1200);for(var le=!1;t.l<t.length-1;){var _e=t.l,Ce=t.read_shift(2);if(Ce===0&&ue===10)break;var Te=t.l===t.length?0:t.read_shift(2),xe=Op[Ce];if(xe&&xe.f){if(e.bookSheets&&ue===133&&Ce!==133)break;if(ue=Ce,xe.r===2||xe.r==12){var $e=t.read_shift(2);if(Te-=2,!b.enc&&$e!==Ce&&(($e&255)<<8|$e>>8)!==Ce)throw new Error("rt mismatch: "+$e+"!="+Ce);xe.r==12&&(t.l+=10,Te-=10)}var z={};if(Ce===10?z=xe.f(t,Te,b):z=l7(Ce,xe,t,Te,b),de==0&&[9,521,1033,2057].indexOf(ue)===-1)continue;switch(Ce){case 34:r.opts.Date1904=g.WBProps.date1904=z;break;case 134:r.opts.WriteProtect=!0;break;case 47:if(b.enc||(t.l=0),b.enc=z,!e.password)throw new Error("File is password-protected");if(z.valid==null)throw new Error("Encryption scheme unsupported");if(!z.valid)throw new Error("Password is incorrect");break;case 92:b.lastuser=z;break;case 66:var ot=Number(z);switch(ot){case 21010:ot=1200;break;case 32768:ot=1e4;break;case 32769:ot=1252;break}ns(b.codepage=ot),le=!0;break;case 317:b.rrtabid=z;break;case 25:b.winlocked=z;break;case 439:r.opts.RefreshAll=z;break;case 12:r.opts.CalcCount=z;break;case 16:r.opts.CalcDelta=z;break;case 17:r.opts.CalcIter=z;break;case 13:r.opts.CalcMode=z;break;case 14:r.opts.CalcPrecision=z;break;case 95:r.opts.CalcSaveRecalc=z;break;case 15:b.CalcRefMode=z;break;case 2211:r.opts.FullCalc=z;break;case 129:z.fDialog&&(s["!type"]="dialog"),z.fBelow||((s["!outline"]||(s["!outline"]={})).above=!0),z.fRight||((s["!outline"]||(s["!outline"]={})).left=!0);break;case 224:O.push(z);break;case 430:H.push([z]),H[H.length-1].XTI=[];break;case 35:case 547:H[H.length-1].push(z);break;case 24:case 536:q={Name:z.Name,Ref:Fr(z.rgce,i,null,H,b)},z.itab>0&&(q.Sheet=z.itab-1),H.names.push(q),H[0]||(H[0]=[],H[0].XTI=[]),H[H.length-1].push(z),z.Name=="_xlnm._FilterDatabase"&&z.itab>0&&z.rgce&&z.rgce[0]&&z.rgce[0][0]&&z.rgce[0][0][0]=="PtgArea3d"&&(X[z.itab-1]={ref:rt(z.rgce[0][0][1][2])});break;case 22:b.ExternCount=z;break;case 23:H.length==0&&(H[0]=[],H[0].XTI=[]),H[H.length-1].XTI=H[H.length-1].XTI.concat(z),H.XTI=H.XTI.concat(z);break;case 2196:if(b.biff<8)break;q!=null&&(q.Comment=z[1]);break;case 18:s["!protect"]=z;break;case 19:z!==0&&b.WTF&&console.error("Password verifier: "+z);break;case 133:a[z.pos]=z,b.snames.push(z.name);break;case 10:{if(--de)break;if(i.e){if(i.e.r>0&&i.e.c>0){if(i.e.r--,i.e.c--,s["!ref"]=rt(i),e.sheetRows&&e.sheetRows<=i.e.r){var He=i.e.r;i.e.r=e.sheetRows-1,s["!fullref"]=s["!ref"],s["!ref"]=rt(i),i.e.r=He}i.e.r++,i.e.c++}oe.length>0&&(s["!merges"]=oe),ae.length>0&&(s["!objects"]=ae),he.length>0&&(s["!cols"]=he),me.length>0&&(s["!rows"]=me),g.Sheets.push(y)}c===""?u=s:n[c]=s,s=e.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(b.biff===8&&(b.biff={9:2,521:3,1033:4}[Ce]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[z.BIFFVer]||8),b.biffguess=z.BIFFVer==0,z.BIFFVer==0&&z.dt==4096&&(b.biff=5,le=!0,ns(b.codepage=28591)),b.biff==8&&z.BIFFVer==0&&z.dt==16&&(b.biff=2),de++)break;if(s=e.dense?[]:{},b.biff<8&&!le&&(le=!0,ns(b.codepage=e.codepage||1252)),b.biff<5||z.BIFFVer==0&&z.dt==4096){c===""&&(c="Sheet1"),i={s:{r:0,c:0},e:{r:0,c:0}};var nt={pos:t.l-Te,name:c};a[nt.pos]=nt,b.snames.push(c)}else c=(a[_e]||{name:""}).name;z.dt==32&&(s["!type"]="chart"),z.dt==64&&(s["!type"]="macro"),oe=[],ae=[],b.arrayf=T=[],he=[],me=[],ee=!1,y={Hidden:(a[_e]||{hs:0}).hs,name:c}}break;case 515:case 3:case 2:s["!type"]=="chart"&&(e.dense?(s[z.r]||[])[z.c]:s[Ue({c:z.c,r:z.r})])&&++z.c,E={ixfe:z.ixfe,XF:O[z.ixfe]||{},v:z.val,t:"n"},B>0&&(E.z=K[E.ixfe>>8&63]),gs(E,e,r.opts.Date1904),P({c:z.c,r:z.r},E,e);break;case 5:case 517:E={ixfe:z.ixfe,XF:O[z.ixfe],v:z.val,t:z.t},B>0&&(E.z=K[E.ixfe>>8&63]),gs(E,e,r.opts.Date1904),P({c:z.c,r:z.r},E,e);break;case 638:E={ixfe:z.ixfe,XF:O[z.ixfe],v:z.rknum,t:"n"},B>0&&(E.z=K[E.ixfe>>8&63]),gs(E,e,r.opts.Date1904),P({c:z.c,r:z.r},E,e);break;case 189:for(var Fe=z.c;Fe<=z.C;++Fe){var Ae=z.rkrec[Fe-z.c][0];E={ixfe:Ae,XF:O[Ae],v:z.rkrec[Fe-z.c][1],t:"n"},B>0&&(E.z=K[E.ixfe>>8&63]),gs(E,e,r.opts.Date1904),P({c:Fe,r:z.r},E,e)}break;case 6:case 518:case 1030:{if(z.val=="String"){o=z;break}if(E=Df(z.val,z.cell.ixfe,z.tt),E.XF=O[E.ixfe],e.cellFormula){var Tt=z.formula;if(Tt&&Tt[0]&&Tt[0][0]&&Tt[0][0][0]=="PtgExp"){var or=Tt[0][0][1][0],Ar=Tt[0][0][1][1],tn=Ue({r:or,c:Ar});k[tn]?E.f=""+Fr(z.formula,i,z.cell,H,b):E.F=((e.dense?(s[or]||[])[Ar]:s[tn])||{}).F}else E.f=""+Fr(z.formula,i,z.cell,H,b)}B>0&&(E.z=K[E.ixfe>>8&63]),gs(E,e,r.opts.Date1904),P(z.cell,E,e),o=z}break;case 7:case 519:if(o)o.val=z,E=Df(z,o.cell.ixfe,"s"),E.XF=O[E.ixfe],e.cellFormula&&(E.f=""+Fr(o.formula,i,o.cell,H,b)),B>0&&(E.z=K[E.ixfe>>8&63]),gs(E,e,r.opts.Date1904),P(o.cell,E,e),o=null;else throw new Error("String record expects Formula");break;case 33:case 545:{T.push(z);var Ms=Ue(z[0].s);if(p=e.dense?(s[z[0].s.r]||[])[z[0].s.c]:s[Ms],e.cellFormula&&p){if(!o||!Ms||!p)break;p.f=""+Fr(z[1],i,z[0],H,b),p.F=rt(z[0])}}break;case 1212:{if(!e.cellFormula)break;if(m){if(!o)break;k[Ue(o.cell)]=z[0],p=e.dense?(s[o.cell.r]||[])[o.cell.c]:s[Ue(o.cell)],(p||{}).f=""+Fr(z[0],i,h,H,b)}}break;case 253:E=Df(l[z.isst].t,z.ixfe,"s"),l[z.isst].h&&(E.h=l[z.isst].h),E.XF=O[E.ixfe],B>0&&(E.z=K[E.ixfe>>8&63]),gs(E,e,r.opts.Date1904),P({c:z.c,r:z.r},E,e);break;case 513:e.sheetStubs&&(E={ixfe:z.ixfe,XF:O[z.ixfe],t:"z"},B>0&&(E.z=K[E.ixfe>>8&63]),gs(E,e,r.opts.Date1904),P({c:z.c,r:z.r},E,e));break;case 190:if(e.sheetStubs)for(var rn=z.c;rn<=z.C;++rn){var kt=z.ixfe[rn-z.c];E={ixfe:kt,XF:O[kt],t:"z"},B>0&&(E.z=K[E.ixfe>>8&63]),gs(E,e,r.opts.Date1904),P({c:rn,r:z.r},E,e)}break;case 214:case 516:case 4:E=Df(z.val,z.ixfe,"s"),E.XF=O[E.ixfe],B>0&&(E.z=K[E.ixfe>>8&63]),gs(E,e,r.opts.Date1904),P({c:z.c,r:z.r},E,e);break;case 0:case 512:de===1&&(i=z);break;case 252:l=z;break;case 1054:if(b.biff==4){K[B++]=z[1];for(var lr=0;lr<B+163&&ze[lr]!=z[1];++lr);lr>=163&&Mi(z[1],B+163)}else Mi(z[1],z[0]);break;case 30:{K[B++]=z;for(var vt=0;vt<B+163&&ze[vt]!=z;++vt);vt>=163&&Mi(z,B+163)}break;case 229:oe=oe.concat(z);break;case 93:ae[z.cmo[0]]=b.lastobj=z;break;case 438:b.lastobj.TxO=z;break;case 127:b.lastobj.ImData=z;break;case 440:for(w=z[0].s.r;w<=z[0].e.r;++w)for(v=z[0].s.c;v<=z[0].e.c;++v)p=e.dense?(s[w]||[])[v]:s[Ue({c:v,r:w})],p&&(p.l=z[1]);break;case 2048:for(w=z[0].s.r;w<=z[0].e.r;++w)for(v=z[0].s.c;v<=z[0].e.c;++v)p=e.dense?(s[w]||[])[v]:s[Ue({c:v,r:w})],p&&p.l&&(p.l.Tooltip=z[1]);break;case 28:{if(b.biff<=5&&b.biff>=2)break;p=e.dense?(s[z[0].r]||[])[z[0].c]:s[Ue(z[0])];var St=ae[z[2]];p||(e.dense?(s[z[0].r]||(s[z[0].r]=[]),p=s[z[0].r][z[0].c]={t:"z"}):p=s[Ue(z[0])]={t:"z"},i.e.r=Math.max(i.e.r,z[0].r),i.s.r=Math.min(i.s.r,z[0].r),i.e.c=Math.max(i.e.c,z[0].c),i.s.c=Math.min(i.s.c,z[0].c)),p.c||(p.c=[]),x={a:z[1],t:St.TxO.t},p.c.push(x)}break;case 2173:P9(O[z.ixfe],z.ext);break;case 125:{if(!b.cellStyles)break;for(;z.e>=z.s;)he[z.e--]={width:z.w/256,level:z.level||0,hidden:!!(z.flags&1)},ee||(ee=!0,cx(z.w/256)),ml(he[z.e+1])}break;case 520:{var ht={};z.level!=null&&(me[z.r]=ht,ht.level=z.level),z.hidden&&(me[z.r]=ht,ht.hidden=!0),z.hpt&&(me[z.r]=ht,ht.hpt=z.hpt,ht.hpx=fu(z.hpt))}break;case 38:case 39:case 40:case 41:s["!margins"]||Cc(s["!margins"]={}),s["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[Ce]]=z;break;case 161:s["!margins"]||Cc(s["!margins"]={}),s["!margins"].header=z.header,s["!margins"].footer=z.footer;break;case 574:z.RTL&&(g.Views[0].RTL=!0);break;case 146:M=z;break;case 2198:C=z;break;case 140:N=z;break;case 442:c?y.CodeName=z||y.name:g.WBProps.CodeName=z||"ThisWorkbook";break}}else xe||console.error("Missing Info for XLS Record 0x"+Ce.toString(16)),t.l+=Te}return r.SheetNames=Ns(a).sort(function(Dt,je){return Number(Dt)-Number(je)}).map(function(Dt){return a[Dt].name}),e.bookSheets||(r.Sheets=n),!r.SheetNames.length&&u["!ref"]?(r.SheetNames.push("Sheet1"),r.Sheets&&(r.Sheets.Sheet1=u)):r.Preamble=u,r.Sheets&&X.forEach(function(Dt,je){r.Sheets[r.SheetNames[je]]["!autofilter"]=Dt}),r.Strings=l,r.SSF=Er(ze),b.enc&&(r.Encryption=b.enc),C&&(r.Themes=C),r.Metadata={},N!==void 0&&(r.Metadata.Country=N),H.names.length>0&&(g.Names=H.names),r.Workbook=g,r}var Uw={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function u7(t,e,r){var n=tt.find(t,"/!DocumentSummaryInformation");if(n&&n.size>0)try{var s=Tw(n,I8,Uw.DSI);for(var a in s)e[a]=s[a]}catch(c){if(r.WTF)throw c}var i=tt.find(t,"/!SummaryInformation");if(i&&i.size>0)try{var o=Tw(i,C8,Uw.SI);for(var l in o)e[l]==null&&(e[l]=o[l])}catch(c){if(r.WTF)throw c}e.HeadingPairs&&e.TitlesOfParts&&(UA(e.HeadingPairs,e.TitlesOfParts,e,r),delete e.HeadingPairs,delete e.TitlesOfParts)}function TI(t,e){e||(e={}),mx(e),JS(),e.codepage&&Gv(e.codepage);var r,n;if(t.FullPaths){if(tt.find(t,"/encryption"))throw new Error("File is password-protected");r=tt.find(t,"!CompObj"),n=tt.find(t,"/Workbook")||tt.find(t,"/Book")}else{switch(e.type){case"base64":t=ts(An(t));break;case"binary":t=ts(t);break;case"buffer":break;case"array":Array.isArray(t)||(t=Array.prototype.slice.call(t));break}xr(t,0),n={content:t}}var s,a;if(r&&i7(r),e.bookProps&&!e.bookSheets)s={};else{var i=Qe?"buffer":"array";if(n&&n.content)s=c7(n.content,e);else if((a=tt.find(t,"PerfectOffice_MAIN"))&&a.content)s=Ac.to_workbook(a.content,(e.type=i,e));else if((a=tt.find(t,"NativeContent_MAIN"))&&a.content)s=Ac.to_workbook(a.content,(e.type=i,e));else throw(a=tt.find(t,"MN0"))&&a.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");e.bookVBA&&t.FullPaths&&tt.find(t,"/_VBA_PROJECT_CUR/VBA/dir")&&(s.vbaraw=X9(t))}var o={};return t.FullPaths&&u7(t,o,e),s.Props=s.Custprops=o,e.bookFiles&&(s.cfb=t),s}var od={0:{f:HU},1:{f:XU},2:{f:sB},3:{f:ZU},4:{f:QU},5:{f:nB},6:{f:oB},7:{f:tB},8:{f:hB},9:{f:fB},10:{f:cB},11:{f:uB},12:{f:YU},13:{f:aB},14:{f:eB},15:{f:JU},16:{f:xI},17:{f:lB},18:{f:rB},19:{f:nx},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:VB},40:{},42:{},43:{f:c9},44:{f:l9},45:{f:u9},46:{f:h9},47:{f:f9},48:{},49:{f:d8},50:{},51:{f:D9},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:JA},62:{f:iB},63:{f:j9},64:{f:wB},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:$r,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:yB},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:qU},148:{f:GU,p:16},151:{f:pB},152:{},153:{f:LB},154:{},155:{},156:{f:MB},157:{},158:{},159:{T:1,f:Cj},160:{T:-1},161:{T:1,f:io},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:dB},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:b9},336:{T:-1},337:{f:F9,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:Np},357:{},358:{},359:{},360:{T:1},361:{},362:{f:QA},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:gB},427:{f:vB},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:_B},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:KU},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:mB},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:Np},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:G9},633:{T:1},634:{T:-1},635:{T:1,f:H9},636:{T:-1},637:{f:p8},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:IB},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:EB},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},Op={6:{f:Z0},10:{f:Aa},12:{f:Yt},13:{f:Yt},14:{f:zt},15:{f:zt},16:{f:Lr},17:{f:zt},18:{f:zt},19:{f:Yt},20:{f:Iw},21:{f:Iw},23:{f:QA},24:{f:Rw},25:{f:zt},26:{},27:{},28:{f:$5},29:{},34:{f:zt},35:{f:Cw},38:{f:Lr},39:{f:Lr},40:{f:Lr},41:{f:Lr},42:{f:zt},43:{f:zt},47:{f:Kj},49:{f:k5},51:{f:Yt},60:{},61:{f:w5},64:{f:zt},65:{f:T5},66:{f:Yt},77:{},80:{},81:{},82:{},85:{f:Yt},89:{},90:{},91:{},92:{f:d5},93:{f:H5},94:{},95:{f:zt},96:{},97:{},99:{f:zt},125:{f:JA},128:{f:F5},129:{f:m5},130:{f:Yt},131:{f:zt},132:{f:zt},133:{f:p5},134:{},140:{f:Q5},141:{f:Yt},144:{},146:{f:Z5},151:{},152:{},153:{},154:{},155:{},156:{f:Yt},157:{},158:{},160:{f:sj},161:{f:tj},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:N5},190:{f:P5},193:{f:Aa},197:{},198:{},199:{},200:{},201:{},202:{f:zt},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:Yt},220:{},221:{f:zt},222:{},224:{f:D5},225:{f:h5},226:{f:Aa},227:{},229:{f:W5},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:g5},253:{f:S5},255:{f:v5},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:HA},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:zt},353:{f:Aa},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:M5},431:{f:zt},432:{},433:{},434:{},437:{},438:{f:q5},439:{f:zt},440:{f:X5},441:{},442:{f:ju},443:{},444:{f:Yt},445:{},446:{},448:{f:Aa},449:{f:y5,r:2},450:{f:Aa},512:{f:Sw},513:{f:nj},515:{f:O5},516:{f:A5},517:{f:Aw},519:{f:aj},520:{f:x5},523:{},545:{f:Nw},549:{f:kw},566:{},574:{f:E5},638:{f:R5},659:{},1048:{},1054:{f:I5},1084:{},1212:{f:U5},2048:{f:Y5},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:Nf},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:Aa},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:ej,r:12},2173:{f:N9,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:zt,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:V5,r:12},2197:{},2198:{f:k9,r:12},2199:{},2200:{},2201:{},2202:{f:B5,r:12},2203:{f:Aa},2204:{},2205:{},2206:{},2207:{},2211:{f:_5},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:Yt},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:rj},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:J5},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:Sw},1:{},2:{f:cj},3:{f:lj},4:{f:oj},5:{f:Aw},7:{f:uj},8:{},9:{f:Nf},11:{},22:{f:Yt},30:{f:C5},31:{},32:{},33:{f:Nw},36:{},37:{f:kw},50:{f:fj},62:{},52:{},67:{},68:{f:Yt},69:{},86:{},126:{},127:{f:ij},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:hj},223:{},234:{},354:{},421:{},518:{f:Z0},521:{f:Nf},536:{f:Rw},547:{f:Cw},561:{},579:{},1030:{f:Z0},1033:{f:Nf},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function Xn(t,e,r,n){var s=e;if(!isNaN(s)){var a=(r||[]).length||0,i=t.next(4);i.write_shift(2,s),i.write_shift(2,a),a>0&&bA(r)&&t.push(r)}}function Bw(t,e){var r=e||{},n=r.dense?[]:{};t=t.replace(/<!--.*?-->/g,"");var s=t.match(/<table/i);if(!s)throw new Error("Invalid HTML: could not find <table>");var a=t.match(/<\/table/i),i=s.index,o=a&&a.index||t.length,l=O6(t.slice(i,o),/(:?<tr[^>]*>)/i,"<tr>"),c=-1,u=0,h=0,m=0,p={s:{r:1e7,c:1e7},e:{r:0,c:0}},x=[];for(i=0;i<l.length;++i){var v=l[i].trim(),w=v.slice(0,3).toLowerCase();if(w=="<tr"){if(++c,r.sheetRows&&r.sheetRows<=c){--c;break}u=0;continue}if(!(w!="<td"&&w!="<th")){var k=v.split(/<\/t[dh]>/i);for(o=0;o<k.length;++o){var T=k[o].trim();if(T.match(/<t[dh]/i)){for(var E=T,N=0;E.charAt(0)=="<"&&(N=E.indexOf(">"))>-1;)E=E.slice(N+1);for(var O=0;O<x.length;++O){var M=x[O];M.s.c==u&&M.s.r<c&&c<=M.e.r&&(u=M.e.c+1,O=-1)}var g=Oe(T.slice(0,T.indexOf(">")));m=g.colspan?+g.colspan:1,((h=+g.rowspan)>1||m>1)&&x.push({s:{r:c,c:u},e:{r:c+(h||1)-1,c:u+m-1}});var y=g.t||g["data-t"]||"";if(!E.length){u+=m;continue}if(E=_A(E),p.s.r>c&&(p.s.r=c),p.e.r<c&&(p.e.r=c),p.s.c>u&&(p.s.c=u),p.e.c<u&&(p.e.c=u),!E.length){u+=m;continue}var S={t:"s",v:E};r.raw||!E.trim().length||y=="s"||(E==="TRUE"?S={t:"b",v:!0}:E==="FALSE"?S={t:"b",v:!1}:isNaN(ls(E))?isNaN(dl(E).getDate())||(S={t:"d",v:dr(E)},r.cellDates||(S={t:"n",v:Jr(S.v)}),S.z=r.dateNF||ze[14]):S={t:"n",v:ls(E)}),r.dense?(n[c]||(n[c]=[]),n[c][u]=S):n[Ue({r:c,c:u})]=S,u+=m}}}}return n["!ref"]=rt(p),x.length&&(n["!merges"]=x),n}function f7(t,e,r,n){for(var s=t["!merges"]||[],a=[],i=e.s.c;i<=e.e.c;++i){for(var o=0,l=0,c=0;c<s.length;++c)if(!(s[c].s.r>r||s[c].s.c>i)&&!(s[c].e.r<r||s[c].e.c<i)){if(s[c].s.r<r||s[c].s.c<i){o=-1;break}o=s[c].e.r-s[c].s.r+1,l=s[c].e.c-s[c].s.c+1;break}if(!(o<0)){var u=Ue({r,c:i}),h=n.dense?(t[r]||[])[i]:t[u],m=h&&h.v!=null&&(h.h||Jv(h.w||(ga(h),h.w)||""))||"",p={};o>1&&(p.rowspan=o),l>1&&(p.colspan=l),n.editable?m='<span contenteditable="true">'+m+"</span>":h&&(p["data-t"]=h&&h.t||"z",h.v!=null&&(p["data-v"]=h.v),h.z!=null&&(p["data-z"]=h.z),h.l&&(h.l.Target||"#").charAt(0)!="#"&&(m='<a href="'+h.l.Target+'">'+m+"</a>")),p.id=(n.id||"sjs")+"-"+u,a.push(Q6("td",m,p))}}var x="<tr>";return x+a.join("")+"</tr>"}var h7='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',d7="</body></html>";function m7(t,e){var r=t.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!r||r.length==0)throw new Error("Invalid HTML: could not find <table>");if(r.length==1)return pi(Bw(r[0],e),e);var n=gx();return r.forEach(function(s,a){vx(n,Bw(s,e),"Sheet"+(a+1))}),n}function p7(t,e,r){var n=[];return n.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function g7(t,e){var r=e||{},n=r.header!=null?r.header:h7,s=r.footer!=null?r.footer:d7,a=[n],i=kl(t["!ref"]);r.dense=Array.isArray(t),a.push(p7(t,i,r));for(var o=i.s.r;o<=i.e.r;++o)a.push(f7(t,i,o,r));return a.push("</table>"+s),a.join("")}function kI(t,e,r){var n=r||{},s=0,a=0;if(n.origin!=null)if(typeof n.origin=="number")s=n.origin;else{var i=typeof n.origin=="string"?qr(n.origin):n.origin;s=i.r,a=i.c}var o=e.getElementsByTagName("tr"),l=Math.min(n.sheetRows||1e7,o.length),c={s:{r:0,c:0},e:{r:s,c:a}};if(t["!ref"]){var u=kl(t["!ref"]);c.s.r=Math.min(c.s.r,u.s.r),c.s.c=Math.min(c.s.c,u.s.c),c.e.r=Math.max(c.e.r,u.e.r),c.e.c=Math.max(c.e.c,u.e.c),s==-1&&(c.e.r=s=u.e.r+1)}var h=[],m=0,p=t["!rows"]||(t["!rows"]=[]),x=0,v=0,w=0,k=0,T=0,E=0;for(t["!cols"]||(t["!cols"]=[]);x<o.length&&v<l;++x){var N=o[x];if(zw(N)){if(n.display)continue;p[v]={hidden:!0}}var O=N.children;for(w=k=0;w<O.length;++w){var M=O[w];if(!(n.display&&zw(M))){var g=M.hasAttribute("data-v")?M.getAttribute("data-v"):M.hasAttribute("v")?M.getAttribute("v"):_A(M.innerHTML),y=M.getAttribute("data-z")||M.getAttribute("z");for(m=0;m<h.length;++m){var S=h[m];S.s.c==k+a&&S.s.r<v+s&&v+s<=S.e.r&&(k=S.e.c+1-a,m=-1)}E=+M.getAttribute("colspan")||1,((T=+M.getAttribute("rowspan")||1)>1||E>1)&&h.push({s:{r:v+s,c:k+a},e:{r:v+s+(T||1)-1,c:k+a+(E||1)-1}});var R={t:"s",v:g},P=M.getAttribute("data-t")||M.getAttribute("t")||"";g!=null&&(g.length==0?R.t=P||"z":n.raw||g.trim().length==0||P=="s"||(g==="TRUE"?R={t:"b",v:!0}:g==="FALSE"?R={t:"b",v:!1}:isNaN(ls(g))?isNaN(dl(g).getDate())||(R={t:"d",v:dr(g)},n.cellDates||(R={t:"n",v:Jr(R.v)}),R.z=n.dateNF||ze[14]):R={t:"n",v:ls(g)})),R.z===void 0&&y!=null&&(R.z=y);var b="",C=M.getElementsByTagName("A");if(C&&C.length)for(var oe=0;oe<C.length&&!(C[oe].hasAttribute("href")&&(b=C[oe].getAttribute("href"),b.charAt(0)!="#"));++oe);b&&b.charAt(0)!="#"&&(R.l={Target:b}),n.dense?(t[v+s]||(t[v+s]=[]),t[v+s][k+a]=R):t[Ue({c:k+a,r:v+s})]=R,c.e.c<k+a&&(c.e.c=k+a),k+=E}}++v}return h.length&&(t["!merges"]=(t["!merges"]||[]).concat(h)),c.e.r=Math.max(c.e.r,v-1+s),t["!ref"]=rt(c),v>=l&&(t["!fullref"]=rt((c.e.r=o.length-x+v-1+s,c))),t}function SI(t,e){var r=e||{},n=r.dense?[]:{};return kI(n,t,e)}function v7(t,e){return pi(SI(t,e),e)}function zw(t){var e="",r=x7(t);return r&&(e=r(t).getPropertyValue("display")),e||(e=t.style&&t.style.display),e==="none"}function x7(t){return t.ownerDocument.defaultView&&typeof t.ownerDocument.defaultView.getComputedStyle=="function"?t.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function _7(t){var e=t.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(n,s){return Array(parseInt(s,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),r=it(e.replace(/<[^>]*>/g,""));return[r]}var $w={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function AI(t,e){var r=e||{},n=Zv(t),s=[],a,i,o={name:""},l="",c=0,u,h,m={},p=[],x=r.dense?[]:{},v,w,k={value:""},T="",E=0,N=[],O=-1,M=-1,g={s:{r:1e6,c:1e7},e:{r:0,c:0}},y=0,S={},R=[],P={},b=0,C=0,oe=[],ae=1,he=1,me=[],ee={Names:[]},H={},ue=["",""],de=[],B={},K="",X=0,q=!1,le=!1,_e=0;for(lu.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");v=lu.exec(n);)switch(v[3]=v[3].replace(/_.*$/,"")){case"table":case"":v[1]==="/"?(g.e.c>=g.s.c&&g.e.r>=g.s.r?x["!ref"]=rt(g):x["!ref"]="A1:A1",r.sheetRows>0&&r.sheetRows<=g.e.r&&(x["!fullref"]=x["!ref"],g.e.r=r.sheetRows-1,x["!ref"]=rt(g)),R.length&&(x["!merges"]=R),oe.length&&(x["!rows"]=oe),u.name=u.||u.name,typeof JSON<"u"&&JSON.stringify(u),p.push(u.name),m[u.name]=x,le=!1):v[0].charAt(v[0].length-2)!=="/"&&(u=Oe(v[0],!1),O=M=-1,g.s.r=g.s.c=1e7,g.e.r=g.e.c=0,x=r.dense?[]:{},R=[],oe=[],le=!0);break;case"table-row-group":v[1]==="/"?--y:++y;break;case"table-row":case"":if(v[1]==="/"){O+=ae,ae=1;break}if(h=Oe(v[0],!1),h.?O=h.-1:O==-1&&(O=0),ae=+h["number-rows-repeated"]||1,ae<10)for(_e=0;_e<ae;++_e)y>0&&(oe[O+_e]={level:y});M=-1;break;case"covered-table-cell":v[1]!=="/"&&++M,r.sheetStubs&&(r.dense?(x[O]||(x[O]=[]),x[O][M]={t:"z"}):x[Ue({r:O,c:M})]={t:"z"}),T="",N=[];break;case"table-cell":case"":if(v[0].charAt(v[0].length-2)==="/")++M,k=Oe(v[0],!1),he=parseInt(k["number-columns-repeated"]||"1",10),w={t:"z",v:null},k.formula&&r.cellFormula!=!1&&(w.f=Lw(it(k.formula))),(k.||k["value-type"])=="string"&&(w.t="s",w.v=it(k["string-value"]||""),r.dense?(x[O]||(x[O]=[]),x[O][M]=w):x[Ue({r:O,c:M})]=w),M+=he-1;else if(v[1]!=="/"){++M,T="",E=0,N=[],he=1;var Ce=ae?O+ae-1:O;if(M>g.e.c&&(g.e.c=M),M<g.s.c&&(g.s.c=M),O<g.s.r&&(g.s.r=O),Ce>g.e.r&&(g.e.r=Ce),k=Oe(v[0],!1),de=[],B={},w={t:k.||k["value-type"],v:null},r.cellFormula)if(k.formula&&(k.formula=it(k.formula)),k["number-matrix-columns-spanned"]&&k["number-matrix-rows-spanned"]&&(b=parseInt(k["number-matrix-rows-spanned"],10)||0,C=parseInt(k["number-matrix-columns-spanned"],10)||0,P={s:{r:O,c:M},e:{r:O+b-1,c:M+C-1}},w.F=rt(P),me.push([P,w.F])),k.formula)w.f=Lw(k.formula);else for(_e=0;_e<me.length;++_e)O>=me[_e][0].s.r&&O<=me[_e][0].e.r&&M>=me[_e][0].s.c&&M<=me[_e][0].e.c&&(w.F=me[_e][1]);switch((k["number-columns-spanned"]||k["number-rows-spanned"])&&(b=parseInt(k["number-rows-spanned"],10)||0,C=parseInt(k["number-columns-spanned"],10)||0,P={s:{r:O,c:M},e:{r:O+b-1,c:M+C-1}},R.push(P)),k["number-columns-repeated"]&&(he=parseInt(k["number-columns-repeated"],10)),w.t){case"boolean":w.t="b",w.v=Pt(k["boolean-value"]);break;case"float":w.t="n",w.v=parseFloat(k.value);break;case"percentage":w.t="n",w.v=parseFloat(k.value);break;case"currency":w.t="n",w.v=parseFloat(k.value);break;case"date":w.t="d",w.v=dr(k["date-value"]),r.cellDates||(w.t="n",w.v=Jr(w.v)),w.z="m/d/yy";break;case"time":w.t="n",w.v=b6(k["time-value"])/86400,r.cellDates&&(w.t="d",w.v=Jd(w.v)),w.z="HH:MM:SS";break;case"number":w.t="n",w.v=parseFloat(k.);break;default:if(w.t==="string"||w.t==="text"||!w.t)w.t="s",k["string-value"]!=null&&(T=it(k["string-value"]),N=[]);else throw new Error("Unsupported value type "+w.t)}}else{if(q=!1,w.t==="s"&&(w.v=T||"",N.length&&(w.R=N),q=E==0),H.Target&&(w.l=H),de.length>0&&(w.c=de,de=[]),T&&r.cellText!==!1&&(w.w=T),q&&(w.t="z",delete w.v),(!q||r.sheetStubs)&&!(r.sheetRows&&r.sheetRows<=O))for(var Te=0;Te<ae;++Te){if(he=parseInt(k["number-columns-repeated"]||"1",10),r.dense)for(x[O+Te]||(x[O+Te]=[]),x[O+Te][M]=Te==0?w:Er(w);--he>0;)x[O+Te][M+he]=Er(w);else for(x[Ue({r:O+Te,c:M})]=w;--he>0;)x[Ue({r:O+Te,c:M+he})]=Er(w);g.e.c<=M&&(g.e.c=M)}he=parseInt(k["number-columns-repeated"]||"1",10),M+=he-1,he=0,w={},T="",N=[]}H={};break;case"document":case"document-content":case"":case"spreadsheet":case"":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(v[1]==="/"){if((a=s.pop())[0]!==v[3])throw"Bad state: "+a}else v[0].charAt(v[0].length-2)!=="/"&&s.push([v[3],!0]);break;case"annotation":if(v[1]==="/"){if((a=s.pop())[0]!==v[3])throw"Bad state: "+a;B.t=T,N.length&&(B.R=N),B.a=K,de.push(B)}else v[0].charAt(v[0].length-2)!=="/"&&s.push([v[3],!1]);K="",X=0,T="",E=0,N=[];break;case"creator":v[1]==="/"?K=n.slice(X,v.index):X=v.index+v[0].length;break;case"meta":case"":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(v[1]==="/"){if((a=s.pop())[0]!==v[3])throw"Bad state: "+a}else v[0].charAt(v[0].length-2)!=="/"&&s.push([v[3],!1]);T="",E=0,N=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(v[1]==="/"){if(S[o.name]=l,(a=s.pop())[0]!==v[3])throw"Bad state: "+a}else v[0].charAt(v[0].length-2)!=="/"&&(l="",o=Oe(v[0],!1),s.push([v[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(s[s.length-1][0]){case"time-style":case"date-style":i=Oe(v[0],!1),l+=$w[v[3]][i.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(s[s.length-1][0]){case"time-style":case"date-style":i=Oe(v[0],!1),l+=$w[v[3]][i.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(v[0].slice(-2)==="/>")break;if(v[1]==="/")switch(s[s.length-1][0]){case"number-style":case"date-style":case"time-style":l+=n.slice(c,v.index);break}else c=v.index+v[0].length;break;case"named-range":i=Oe(v[0],!1),ue=em(i["cell-range-address"]);var xe={Name:i.name,Ref:ue[0]+"!"+ue[1]};le&&(xe.Sheet=p.length),ee.Names.push(xe);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"":if(["master-styles"].indexOf(s[s.length-1][0])>-1)break;if(v[1]==="/"&&(!k||!k["string-value"])){var $e=_7(n.slice(E,v.index));T=(T.length>0?T+`
`:"")+$e[0]}else Oe(v[0],!1),E=v.index+v[0].length;break;case"s":break;case"database-range":if(v[1]==="/")break;try{ue=em(Oe(v[0])["target-range-address"]),m[ue[0]]["!autofilter"]={ref:ue[1]}}catch{}break;case"date":break;case"object":break;case"title":case"":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(v[1]!=="/"){if(H=Oe(v[0],!1),!H.href)break;H.Target=it(H.href),delete H.href,H.Target.charAt(0)=="#"&&H.Target.indexOf(".")>-1?(ue=em(H.Target.slice(1)),H.Target="#"+ue[0]+"!"+ue[1]):H.Target.match(/^\.\.[\\\/]/)&&(H.Target=H.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(v[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case":":case":":break;default:if(r.WTF)throw new Error(v)}}var z={Sheets:m,SheetNames:p,Workbook:ee};return r.bookSheets&&delete z.Sheets,z}function Ww(t,e){e=e||{},Fn(t,"META-INF/manifest.xml")&&O8(Xt(t,"META-INF/manifest.xml"),e);var r=yn(t,"content.xml");if(!r)throw new Error("Missing content.xml in ODS / UOF file");var n=AI(Et(r),e);return Fn(t,"meta.xml")&&(n.Props=VA(Xt(t,"meta.xml"))),n}function Hw(t,e){return AI(t,e)}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function hx(t){return new DataView(t.buffer,t.byteOffset,t.byteLength)}function Mp(t){return typeof TextDecoder<"u"?new TextDecoder().decode(t):Et(so(t))}function Lp(t){var e=t.reduce(function(s,a){return s+a.length},0),r=new Uint8Array(e),n=0;return t.forEach(function(s){r.set(s,n),n+=s.length}),r}function Gw(t){return t-=t>>1&1431655765,t=(t&858993459)+(t>>2&858993459),(t+(t>>4)&252645135)*16843009>>>24}function y7(t,e){for(var r=(t[e+15]&127)<<7|t[e+14]>>1,n=t[e+14]&1,s=e+13;s>=e;--s)n=n*256+t[s];return(t[e+15]&128?-n:n)*Math.pow(10,r-6176)}function hu(t,e){var r=e?e[0]:0,n=t[r]&127;e:if(t[r++]>=128&&(n|=(t[r]&127)<<7,t[r++]<128||(n|=(t[r]&127)<<14,t[r++]<128)||(n|=(t[r]&127)<<21,t[r++]<128)||(n+=(t[r]&127)*Math.pow(2,28),++r,t[r++]<128)||(n+=(t[r]&127)*Math.pow(2,35),++r,t[r++]<128)||(n+=(t[r]&127)*Math.pow(2,42),++r,t[r++]<128)))break e;return e&&(e[0]=r),n}function ir(t){var e=0,r=t[e]&127;e:if(t[e++]>=128){if(r|=(t[e]&127)<<7,t[e++]<128||(r|=(t[e]&127)<<14,t[e++]<128)||(r|=(t[e]&127)<<21,t[e++]<128))break e;r|=(t[e]&127)<<28}return r}function jr(t){for(var e=[],r=[0];r[0]<t.length;){var n=r[0],s=hu(t,r),a=s&7;s=Math.floor(s/8);var i=0,o;if(s==0)break;switch(a){case 0:{for(var l=r[0];t[r[0]++]>=128;);o=t.slice(l,r[0])}break;case 5:i=4,o=t.slice(r[0],r[0]+i),r[0]+=i;break;case 1:i=8,o=t.slice(r[0],r[0]+i),r[0]+=i;break;case 2:i=hu(t,r),o=t.slice(r[0],r[0]+i),r[0]+=i;break;case 3:case 4:default:throw new Error("PB Type ".concat(a," for Field ").concat(s," at offset ").concat(n))}var c={data:o,type:a};e[s]==null?e[s]=[c]:e[s].push(c)}return e}function dx(t,e){return(t==null?void 0:t.map(function(r){return e(r.data)}))||[]}function w7(t){for(var e,r=[],n=[0];n[0]<t.length;){var s=hu(t,n),a=jr(t.slice(n[0],n[0]+s));n[0]+=s;var i={id:ir(a[1][0].data),messages:[]};a[2].forEach(function(o){var l=jr(o.data),c=ir(l[3][0].data);i.messages.push({meta:l,data:t.slice(n[0],n[0]+c)}),n[0]+=c}),(e=a[3])!=null&&e[0]&&(i.merge=ir(a[3][0].data)>>>0>0),r.push(i)}return r}function E7(t,e){if(t!=0)throw new Error("Unexpected Snappy chunk type ".concat(t));for(var r=[0],n=hu(e,r),s=[];r[0]<e.length;){var a=e[r[0]]&3;if(a==0){var i=e[r[0]++]>>2;if(i<60)++i;else{var o=i-59;i=e[r[0]],o>1&&(i|=e[r[0]+1]<<8),o>2&&(i|=e[r[0]+2]<<16),o>3&&(i|=e[r[0]+3]<<24),i>>>=0,i++,r[0]+=o}s.push(e.slice(r[0],r[0]+i)),r[0]+=i;continue}else{var l=0,c=0;if(a==1?(c=(e[r[0]]>>2&7)+4,l=(e[r[0]++]&224)<<3,l|=e[r[0]++]):(c=(e[r[0]++]>>2)+1,a==2?(l=e[r[0]]|e[r[0]+1]<<8,r[0]+=2):(l=(e[r[0]]|e[r[0]+1]<<8|e[r[0]+2]<<16|e[r[0]+3]<<24)>>>0,r[0]+=4)),s=[Lp(s)],l==0)throw new Error("Invalid offset 0");if(l>s[0].length)throw new Error("Invalid offset beyond length");if(c>=l)for(s.push(s[0].slice(-l)),c-=l;c>=s[s.length-1].length;)s.push(s[s.length-1]),c-=s[s.length-1].length;s.push(s[0].slice(-l,-l+c))}}var u=Lp(s);if(u.length!=n)throw new Error("Unexpected length: ".concat(u.length," != ").concat(n));return u}function T7(t){for(var e=[],r=0;r<t.length;){var n=t[r++],s=t[r]|t[r+1]<<8|t[r+2]<<16;r+=3,e.push(E7(n,t.slice(r,r+s))),r+=s}if(r!==t.length)throw new Error("data is not a valid framed stream!");return Lp(e)}function k7(t,e,r,n){var s=hx(t),a=s.getUint32(4,!0),i=(n>1?12:8)+Gw(a&(n>1?3470:398))*4,o=-1,l=-1,c=NaN,u=new Date(2001,0,1);a&512&&(o=s.getUint32(i,!0),i+=4),i+=Gw(a&(n>1?12288:4096))*4,a&16&&(l=s.getUint32(i,!0),i+=4),a&32&&(c=s.getFloat64(i,!0),i+=8),a&64&&(u.setTime(u.getTime()+s.getFloat64(i,!0)*1e3),i+=8);var h;switch(t[2]){case 0:break;case 2:h={t:"n",v:c};break;case 3:h={t:"s",v:e[l]};break;case 5:h={t:"d",v:u};break;case 6:h={t:"b",v:c>0};break;case 7:h={t:"n",v:c/86400};break;case 8:h={t:"e",v:0};break;case 9:if(o>-1)h={t:"s",v:r[o]};else if(l>-1)h={t:"s",v:e[l]};else if(!isNaN(c))h={t:"n",v:c};else throw new Error("Unsupported cell type ".concat(t.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(t.slice(0,4)))}return h}function S7(t,e,r){var n=hx(t),s=n.getUint32(8,!0),a=12,i=-1,o=-1,l=NaN,c=NaN,u=new Date(2001,0,1);s&1&&(l=y7(t,a),a+=16),s&2&&(c=n.getFloat64(a,!0),a+=8),s&4&&(u.setTime(u.getTime()+n.getFloat64(a,!0)*1e3),a+=8),s&8&&(o=n.getUint32(a,!0),a+=4),s&16&&(i=n.getUint32(a,!0),a+=4);var h;switch(t[1]){case 0:break;case 2:h={t:"n",v:l};break;case 3:h={t:"s",v:e[o]};break;case 5:h={t:"d",v:u};break;case 6:h={t:"b",v:c>0};break;case 7:h={t:"n",v:c/86400};break;case 8:h={t:"e",v:0};break;case 9:if(i>-1)h={t:"s",v:r[i]};else throw new Error("Unsupported cell type ".concat(t[1]," : ").concat(s&31," : ").concat(t.slice(0,4)));break;case 10:h={t:"n",v:l};break;default:throw new Error("Unsupported cell type ".concat(t[1]," : ").concat(s&31," : ").concat(t.slice(0,4)))}return h}function A7(t,e,r){switch(t[0]){case 0:case 1:case 2:case 3:return k7(t,e,r,t[0]);case 5:return S7(t,e,r);default:throw new Error("Unsupported payload version ".concat(t[0]))}}function Za(t){var e=jr(t);return hu(e[1][0].data)}function Kw(t,e){var r=jr(e.data),n=ir(r[1][0].data),s=r[3],a=[];return(s||[]).forEach(function(i){var o=jr(i.data),l=ir(o[1][0].data)>>>0;switch(n){case 1:a[l]=Mp(o[3][0].data);break;case 8:{var c=t[Za(o[9][0].data)][0],u=jr(c.data),h=t[Za(u[1][0].data)][0],m=ir(h.meta[1][0].data);if(m!=2001)throw new Error("2000 unexpected reference to ".concat(m));var p=jr(h.data);a[l]=p[3].map(function(x){return Mp(x.data)}).join("")}break}}),a}function I7(t,e){var r,n,s,a,i,o,l,c,u,h,m,p,x,v,w=jr(t),k=ir(w[1][0].data)>>>0,T=ir(w[2][0].data)>>>0,E=((n=(r=w[8])==null?void 0:r[0])==null?void 0:n.data)&&ir(w[8][0].data)>0||!1,N,O;if((a=(s=w[7])==null?void 0:s[0])!=null&&a.data&&e!=0)N=(o=(i=w[7])==null?void 0:i[0])==null?void 0:o.data,O=(c=(l=w[6])==null?void 0:l[0])==null?void 0:c.data;else if((h=(u=w[4])==null?void 0:u[0])!=null&&h.data&&e!=1)N=(p=(m=w[4])==null?void 0:m[0])==null?void 0:p.data,O=(v=(x=w[3])==null?void 0:x[0])==null?void 0:v.data;else throw"NUMBERS Tile missing ".concat(e," cell storage");for(var M=E?4:1,g=hx(N),y=[],S=0;S<N.length/2;++S){var R=g.getUint16(S*2,!0);R<65535&&y.push([S,R])}if(y.length!=T)throw"Expected ".concat(T," cells, found ").concat(y.length);var P=[];for(S=0;S<y.length-1;++S)P[y[S][0]]=O.subarray(y[S][1]*M,y[S+1][1]*M);return y.length>=1&&(P[y[y.length-1][0]]=O.subarray(y[y.length-1][1]*M)),{R:k,cells:P}}function C7(t,e){var r,n=jr(e.data),s=(r=n==null?void 0:n[7])!=null&&r[0]?ir(n[7][0].data)>>>0>0?1:0:-1,a=dx(n[5],function(i){return I7(i,s)});return{nrows:ir(n[4][0].data)>>>0,data:a.reduce(function(i,o){return i[o.R]||(i[o.R]=[]),o.cells.forEach(function(l,c){if(i[o.R][c])throw new Error("Duplicate cell r=".concat(o.R," c=").concat(c));i[o.R][c]=l}),i},[])}}function R7(t,e,r){var n,s=jr(e.data),a={s:{r:0,c:0},e:{r:0,c:0}};if(a.e.r=(ir(s[6][0].data)>>>0)-1,a.e.r<0)throw new Error("Invalid row varint ".concat(s[6][0].data));if(a.e.c=(ir(s[7][0].data)>>>0)-1,a.e.c<0)throw new Error("Invalid col varint ".concat(s[7][0].data));r["!ref"]=rt(a);var i=jr(s[4][0].data),o=Kw(t,t[Za(i[4][0].data)][0]),l=(n=i[17])!=null&&n[0]?Kw(t,t[Za(i[17][0].data)][0]):[],c=jr(i[3][0].data),u=0;c[1].forEach(function(h){var m=jr(h.data),p=t[Za(m[2][0].data)][0],x=ir(p.meta[1][0].data);if(x!=6002)throw new Error("6001 unexpected reference to ".concat(x));var v=C7(t,p);v.data.forEach(function(w,k){w.forEach(function(T,E){var N=Ue({r:u+k,c:E}),O=A7(T,o,l);O&&(r[N]=O)})}),u+=v.nrows})}function N7(t,e){var r=jr(e.data),n={"!ref":"A1"},s=t[Za(r[2][0].data)],a=ir(s[0].meta[1][0].data);if(a!=6001)throw new Error("6000 unexpected reference to ".concat(a));return R7(t,s[0],n),n}function P7(t,e){var r,n=jr(e.data),s={name:(r=n[1])!=null&&r[0]?Mp(n[1][0].data):"",sheets:[]},a=dx(n[2],Za);return a.forEach(function(i){t[i].forEach(function(o){var l=ir(o.meta[1][0].data);l==6e3&&s.sheets.push(N7(t,o))})}),s}function b7(t,e){var r=gx(),n=jr(e.data),s=dx(n[1],Za);if(s.forEach(function(a){t[a].forEach(function(i){var o=ir(i.meta[1][0].data);if(o==2){var l=P7(t,i);l.sheets.forEach(function(c,u){vx(r,c,u==0?l.name:l.name+"_"+u,!0)})}})}),r.SheetNames.length==0)throw new Error("Empty NUMBERS file");return r}function rm(t){var e,r,n,s,a={},i=[];if(t.FullPaths.forEach(function(l){if(l.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),t.FileIndex.forEach(function(l){if(l.name.match(/\.iwa$/)){var c;try{c=T7(l.content)}catch(h){return console.log("?? "+l.content.length+" "+(h.message||h))}var u;try{u=w7(c)}catch(h){return console.log("## "+(h.message||h))}u.forEach(function(h){a[h.id]=h.messages,i.push(h.id)})}}),!i.length)throw new Error("File has no messages");var o=((s=(n=(r=(e=a==null?void 0:a[1])==null?void 0:e[0])==null?void 0:r.meta)==null?void 0:n[1])==null?void 0:s[0].data)&&ir(a[1][0].meta[1][0].data)==1&&a[1][0];if(o||i.forEach(function(l){a[l].forEach(function(c){var u=ir(c.meta[1][0].data)>>>0;if(u==1)if(!o)o=c;else throw new Error("Document has multiple roots")})}),!o)throw new Error("Cannot find Document root");return b7(a,o)}function D7(t){return function(r){for(var n=0;n!=t.length;++n){var s=t[n];r[s[0]]===void 0&&(r[s[0]]=s[1]),s[2]==="n"&&(r[s[0]]=Number(r[s[0]]))}}}function mx(t){D7([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(t)}function F7(t){return Oo.WS.indexOf(t)>-1?"sheet":t==Oo.CS?"chart":t==Oo.DS?"dialog":t==Oo.MS?"macro":t&&t.length?t:"sheet"}function O7(t,e){if(!t)return 0;try{t=e.map(function(n){return n.id||(n.id=n.strRelID),[n.name,t["!id"][n.id].Target,F7(t["!id"][n.id].Type)]})}catch{return null}return!t||t.length===0?null:t}function M7(t,e,r,n,s,a,i,o,l,c,u,h){try{a[n]=kc(yn(t,r,!0),e);var m=Xt(t,e),p;switch(o){case"sheet":p=zB(m,e,s,l,a[n],c,u,h);break;case"chart":if(p=$B(m,e,s,l,a[n],c,u,h),!p||!p["!drawel"])break;var x=sc(p["!drawel"].Target,e),v=Pp(x),w=B9(yn(t,x,!0),kc(yn(t,v,!0),x)),k=sc(w,x),T=Pp(k);p=SB(yn(t,k,!0),k,l,kc(yn(t,T,!0),k),c,p);break;case"macro":p=WB(m,e,s,l,a[n],c,u,h);break;case"dialog":p=HB(m,e,s,l,a[n],c,u,h);break;default:throw new Error("Unrecognized sheet type "+o)}i[n]=p;var E=[];a&&a[n]&&Ns(a[n]).forEach(function(N){var O="";if(a[n][N].Type==Oo.CMNT){O=sc(a[n][N].Target,e);var M=XB(Xt(t,O,!0),O,l);if(!M||!M.length)return;bw(p,M,!1)}a[n][N].Type==Oo.TCMNT&&(O=sc(a[n][N].Target,e),E=E.concat($9(Xt(t,O,!0),l)))}),E&&E.length&&bw(p,E,!0,l.people||[])}catch(N){if(l.WTF)throw N}}function bn(t){return t.charAt(0)=="/"?t.slice(1):t}function L7(t,e){if(uA(),e=e||{},mx(e),Fn(t,"META-INF/manifest.xml")||Fn(t,"objectdata.xml"))return Ww(t,e);if(Fn(t,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof rm<"u"){if(t.FileIndex)return rm(t);var r=tt.utils.cfb_new();return aw(t).forEach(function(oe){j6(r,oe,L6(t,oe))}),rm(r)}throw new Error("Unsupported NUMBERS file")}if(!Fn(t,"[Content_Types].xml"))throw Fn(t,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):Fn(t,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var n=aw(t),s=D8(yn(t,"[Content_Types].xml")),a=!1,i,o;if(s.workbooks.length===0&&(o="xl/workbook.xml",Xt(t,o,!0)&&s.workbooks.push(o)),s.workbooks.length===0){if(o="xl/workbook.bin",!Xt(t,o,!0))throw new Error("Could not find workbook");s.workbooks.push(o),a=!0}s.workbooks[0].slice(-3)=="bin"&&(a=!0);var l={},c={};if(!e.bookSheets&&!e.bookProps){if(Ic=[],s.sst)try{Ic=qB(Xt(t,bn(s.sst)),s.sst,e)}catch(oe){if(e.WTF)throw oe}e.cellStyles&&s.themes.length&&(l=KB(yn(t,s.themes[0].replace(/^\//,""),!0)||"",s.themes[0],e)),s.style&&(c=GB(Xt(t,bn(s.style)),s.style,l,e))}s.links.map(function(oe){try{var ae=kc(yn(t,Pp(bn(oe))),oe);return QB(Xt(t,bn(oe)),ae,oe,e)}catch{}});var u=BB(Xt(t,bn(s.workbooks[0])),s.workbooks[0],e),h={},m="";s.coreprops.length&&(m=Xt(t,bn(s.coreprops[0]),!0),m&&(h=VA(m)),s.extprops.length!==0&&(m=Xt(t,bn(s.extprops[0]),!0),m&&j8(m,h,e)));var p={};(!e.bookSheets||e.bookProps)&&s.custprops.length!==0&&(m=yn(t,bn(s.custprops[0]),!0),m&&(p=U8(m,e)));var x={};if((e.bookSheets||e.bookProps)&&(u.Sheets?i=u.Sheets.map(function(ae){return ae.name}):h.Worksheets&&h.SheetNames.length>0&&(i=h.SheetNames),e.bookProps&&(x.Props=h,x.Custprops=p),e.bookSheets&&typeof i<"u"&&(x.SheetNames=i),e.bookSheets?x.SheetNames:e.bookProps))return x;i={};var v={};e.bookDeps&&s.calcchain&&(v=YB(Xt(t,bn(s.calcchain)),s.calcchain));var w=0,k={},T,E;{var N=u.Sheets;h.Worksheets=N.length,h.SheetNames=[];for(var O=0;O!=N.length;++O)h.SheetNames[O]=N[O].name}var M=a?"bin":"xml",g=s.workbooks[0].lastIndexOf("/"),y=(s.workbooks[0].slice(0,g+1)+"_rels/"+s.workbooks[0].slice(g+1)+".rels").replace(/^\//,"");Fn(t,y)||(y="xl/_rels/workbook."+M+".rels");var S=kc(yn(t,y,!0),y.replace(/_rels.*/,"s5s"));(s.metadata||[]).length>=1&&(e.xlmeta=JB(Xt(t,bn(s.metadata[0])),s.metadata[0],e)),(s.people||[]).length>=1&&(e.people=W9(Xt(t,bn(s.people[0])),e)),S&&(S=O7(S,u.Sheets));var R=Xt(t,"xl/worksheets/sheet.xml",!0)?1:0;e:for(w=0;w!=h.Worksheets;++w){var P="sheet";if(S&&S[w]?(T="xl/"+S[w][1].replace(/[\/]?xl\//,""),Fn(t,T)||(T=S[w][1]),Fn(t,T)||(T=y.replace(/_rels\/.*$/,"")+S[w][1]),P=S[w][2]):(T="xl/worksheets/sheet"+(w+1-R)+"."+M,T=T.replace(/sheet0\./,"sheet.")),E=T.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),e&&e.sheets!=null)switch(typeof e.sheets){case"number":if(w!=e.sheets)continue e;break;case"string":if(h.SheetNames[w].toLowerCase()!=e.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(e.sheets)){for(var b=!1,C=0;C!=e.sheets.length;++C)typeof e.sheets[C]=="number"&&e.sheets[C]==w&&(b=1),typeof e.sheets[C]=="string"&&e.sheets[C].toLowerCase()==h.SheetNames[w].toLowerCase()&&(b=1);if(!b)continue e}}M7(t,T,E,h.SheetNames[w],w,k,i,P,e,u,l,c)}return x={Directory:s,Workbook:u,Props:h,Custprops:p,Deps:v,Sheets:i,SheetNames:h.SheetNames,Strings:Ic,Styles:c,Themes:l,SSF:Er(ze)},e&&e.bookFiles&&(t.files?(x.keys=n,x.files=t.files):(x.keys=[],x.files={},t.FullPaths.forEach(function(oe,ae){oe=oe.replace(/^Root Entry[\/]/,""),x.keys.push(oe),x.files[oe]=t.FileIndex[ae]}))),e&&e.bookVBA&&(s.vba.length>0?x.vbaraw=Xt(t,bn(s.vba[0]),!0):s.defaults&&s.defaults.bin===q9&&(x.vbaraw=Xt(t,"xl/vbaProject.bin",!0))),x}function j7(t,e){var r=e||{},n="Workbook",s=tt.find(t,n);try{if(n="/!DataSpaces/Version",s=tt.find(t,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(Nj(s.content),n="/!DataSpaces/DataSpaceMap",s=tt.find(t,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);var a=bj(s.content);if(a.length!==1||a[0].comps.length!==1||a[0].comps[0].t!==0||a[0].name!=="StrongEncryptionDataSpace"||a[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",s=tt.find(t,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);var i=Dj(s.content);if(i.length!=1||i[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",s=tt.find(t,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);Oj(s.content)}catch{}if(n="/EncryptionInfo",s=tt.find(t,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);var o=Mj(s.content);if(n="/EncryptedPackage",s=tt.find(t,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(o[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(o[1],s.content,r.password||"",r);if(o[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(o[1],s.content,r.password||"",r);throw new Error("File is password-protected")}function px(t,e){var r="";switch((e||{}).type||"base64"){case"buffer":return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]];case"base64":r=An(t.slice(0,12));break;case"binary":r=t;break;case"array":return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]];default:throw new Error("Unrecognized type "+(e&&e.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function V7(t,e){return tt.find(t,"EncryptedPackage")?j7(t,e):TI(t,e)}function U7(t,e){var r,n=t,s=e||{};return s.type||(s.type=Qe&&Buffer.isBuffer(t)?"buffer":"base64"),r=gA(n,s),L7(r,s)}function II(t,e){var r=0;e:for(;r<t.length;)switch(t.charCodeAt(r)){case 10:case 13:case 32:++r;break;case 60:return Fp(t.slice(r),e);default:break e}return cu.to_workbook(t,e)}function B7(t,e){var r="",n=px(t,e);switch(e.type){case"base64":r=An(t);break;case"binary":r=t;break;case"buffer":r=t.toString("binary");break;case"array":r=Xi(t);break;default:throw new Error("Unrecognized type "+e.type)}return n[0]==239&&n[1]==187&&n[2]==191&&(r=Et(r)),e.type="binary",II(r,e)}function z7(t,e){var r=t;return e.type=="base64"&&(r=An(r)),r=au.utils.decode(1200,r.slice(2),"str"),e.type="binary",II(r,e)}function $7(t){return t.match(/[^\x00-\x7F]/)?ac(t):t}function nm(t,e,r,n){return n?(r.type="string",cu.to_workbook(t,r)):cu.to_workbook(e,r)}function jp(t,e){JS();var r=e||{};if(typeof ArrayBuffer<"u"&&t instanceof ArrayBuffer)return jp(new Uint8Array(t),(r=Er(r),r.type="array",r));typeof Uint8Array<"u"&&t instanceof Uint8Array&&!r.type&&(r.type=typeof Deno<"u"?"buffer":"array");var n=t,s=[0,0,0,0],a=!1;if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),qo={},r.dateNF&&(qo.dateNF=r.dateNF),r.type||(r.type=Qe&&Buffer.isBuffer(t)?"buffer":"base64"),r.type=="file"&&(r.type=Qe?"buffer":"binary",n=N6(t),typeof Uint8Array<"u"&&!Qe&&(r.type="array")),r.type=="string"&&(a=!0,r.type="binary",r.codepage=65001,n=$7(t)),r.type=="array"&&typeof Uint8Array<"u"&&t instanceof Uint8Array&&typeof ArrayBuffer<"u"){var i=new ArrayBuffer(3),o=new Uint8Array(i);if(o.foo="bar",!o.foo)return r=Er(r),r.type="array",jp(Kv(n),r)}switch((s=px(n,r))[0]){case 208:if(s[1]===207&&s[2]===17&&s[3]===224&&s[4]===161&&s[5]===177&&s[6]===26&&s[7]===225)return V7(tt.read(n,r),r);break;case 9:if(s[1]<=8)return TI(n,r);break;case 60:return Fp(n,r);case 73:if(s[1]===73&&s[2]===42&&s[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(s[1]===68)return vj(n,r);break;case 84:if(s[1]===65&&s[2]===66&&s[3]===76)return pj.to_workbook(n,r);break;case 80:return s[1]===75&&s[2]<9&&s[3]<9?U7(n,r):nm(t,n,r,a);case 239:return s[3]===60?Fp(n,r):nm(t,n,r,a);case 255:if(s[1]===254)return z7(n,r);if(s[1]===0&&s[2]===2&&s[3]===0)return Ac.to_workbook(n,r);break;case 0:if(s[1]===0&&(s[2]>=2&&s[3]===0||s[2]===0&&(s[3]===8||s[3]===9)))return Ac.to_workbook(n,r);break;case 3:case 131:case 139:case 140:return Pw.to_workbook(n,r);case 123:if(s[1]===92&&s[2]===114&&s[3]===116)return qj.to_workbook(n,r);break;case 10:case 13:case 32:return B7(n,r);case 137:if(s[1]===80&&s[2]===78&&s[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return dj.indexOf(s[0])>-1&&s[2]<=12&&s[3]<=31?Pw.to_workbook(n,r):nm(t,n,r,a)}function W7(t,e,r,n,s,a,i,o){var l=Tr(r),c=o.defval,u=o.raw||!Object.prototype.hasOwnProperty.call(o,"raw"),h=!0,m=s===1?[]:{};if(s!==1)if(Object.defineProperty)try{Object.defineProperty(m,"__rowNum__",{value:r,enumerable:!1})}catch{m.__rowNum__=r}else m.__rowNum__=r;if(!i||t[r])for(var p=e.s.c;p<=e.e.c;++p){var x=i?t[r][p]:t[n[p]+l];if(x===void 0||x.t===void 0){if(c===void 0)continue;a[p]!=null&&(m[a[p]]=c);continue}var v=x.v;switch(x.t){case"z":if(v==null)break;continue;case"e":v=v==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+x.t)}if(a[p]!=null){if(v==null)if(x.t=="e"&&v===null)m[a[p]]=null;else if(c!==void 0)m[a[p]]=c;else if(u&&v===null)m[a[p]]=null;else continue;else m[a[p]]=u&&(x.t!=="n"||x.t==="n"&&o.rawNumbers!==!1)?v:ga(x,v,o);v!=null&&(h=!1)}}return{row:m,isempty:h}}function Vp(t,e){if(t==null||t["!ref"]==null)return[];var r={t:"n",v:0},n=0,s=1,a=[],i=0,o="",l={s:{r:0,c:0},e:{r:0,c:0}},c=e||{},u=c.range!=null?c.range:t["!ref"];switch(c.header===1?n=1:c.header==="A"?n=2:Array.isArray(c.header)?n=3:c.header==null&&(n=0),typeof u){case"string":l=Bt(u);break;case"number":l=Bt(t["!ref"]),l.s.r=u;break;default:l=u}n>0&&(s=0);var h=Tr(l.s.r),m=[],p=[],x=0,v=0,w=Array.isArray(t),k=l.s.r,T=0,E={};w&&!t[k]&&(t[k]=[]);var N=c.skipHidden&&t["!cols"]||[],O=c.skipHidden&&t["!rows"]||[];for(T=l.s.c;T<=l.e.c;++T)if(!(N[T]||{}).hidden)switch(m[T]=sr(T),r=w?t[k][T]:t[m[T]+h],n){case 1:a[T]=T-l.s.c;break;case 2:a[T]=m[T];break;case 3:a[T]=c.header[T-l.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),o=i=ga(r,null,c),v=E[i]||0,!v)E[i]=1;else{do o=i+"_"+v++;while(E[o]);E[i]=v,E[o]=1}a[T]=o}for(k=l.s.r+s;k<=l.e.r;++k)if(!(O[k]||{}).hidden){var M=W7(t,l,k,m,n,a,w,c);(M.isempty===!1||(n===1?c.blankrows!==!1:c.blankrows))&&(p[x++]=M.row)}return p.length=x,p}var qw=/"/g;function H7(t,e,r,n,s,a,i,o){for(var l=!0,c=[],u="",h=Tr(r),m=e.s.c;m<=e.e.c;++m)if(n[m]){var p=o.dense?(t[r]||[])[m]:t[n[m]+h];if(p==null)u="";else if(p.v!=null){l=!1,u=""+(o.rawNumbers&&p.t=="n"?p.v:ga(p,null,o));for(var x=0,v=0;x!==u.length;++x)if((v=u.charCodeAt(x))===s||v===a||v===34||o.forceQuotes){u='"'+u.replace(qw,'""')+'"';break}u=="ID"&&(u='"ID"')}else p.f!=null&&!p.F?(l=!1,u="="+p.f,u.indexOf(",")>=0&&(u='"'+u.replace(qw,'""')+'"')):u="";c.push(u)}return o.blankrows===!1&&l?null:c.join(i)}function CI(t,e){var r=[],n=e??{};if(t==null||t["!ref"]==null)return"";var s=Bt(t["!ref"]),a=n.FS!==void 0?n.FS:",",i=a.charCodeAt(0),o=n.RS!==void 0?n.RS:`
`,l=o.charCodeAt(0),c=new RegExp((a=="|"?"\\|":a)+"+$"),u="",h=[];n.dense=Array.isArray(t);for(var m=n.skipHidden&&t["!cols"]||[],p=n.skipHidden&&t["!rows"]||[],x=s.s.c;x<=s.e.c;++x)(m[x]||{}).hidden||(h[x]=sr(x));for(var v=0,w=s.s.r;w<=s.e.r;++w)(p[w]||{}).hidden||(u=H7(t,s,w,h,i,l,a,n),u!=null&&(n.strip&&(u=u.replace(c,"")),(u||n.blankrows!==!1)&&r.push((v++?o:"")+u)));return delete n.dense,r.join("")}function G7(t,e){e||(e={}),e.FS="	",e.RS=`
`;var r=CI(t,e);return r}function K7(t){var e="",r,n="";if(t==null||t["!ref"]==null)return[];var s=Bt(t["!ref"]),a="",i=[],o,l=[],c=Array.isArray(t);for(o=s.s.c;o<=s.e.c;++o)i[o]=sr(o);for(var u=s.s.r;u<=s.e.r;++u)for(a=Tr(u),o=s.s.c;o<=s.e.c;++o)if(e=i[o]+a,r=c?(t[u]||[])[o]:t[e],n="",r!==void 0){if(r.F!=null){if(e=r.F,!r.f)continue;n=r.f,e.indexOf(":")==-1&&(e=e+":"+e)}if(r.f!=null)n=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)n=""+r.v;else if(r.t=="b")n=r.v?"TRUE":"FALSE";else if(r.w!==void 0)n="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?n="'"+r.v:n=""+r.v}}l[l.length]=e+"="+n}return l}function RI(t,e,r){var n=r||{},s=+!n.skipHeader,a=t||{},i=0,o=0;if(a&&n.origin!=null)if(typeof n.origin=="number")i=n.origin;else{var l=typeof n.origin=="string"?qr(n.origin):n.origin;i=l.r,o=l.c}var c,u={s:{c:0,r:0},e:{c:o,r:i+e.length-1+s}};if(a["!ref"]){var h=Bt(a["!ref"]);u.e.c=Math.max(u.e.c,h.e.c),u.e.r=Math.max(u.e.r,h.e.r),i==-1&&(i=h.e.r+1,u.e.r=i+e.length-1+s)}else i==-1&&(i=0,u.e.r=e.length-1+s);var m=n.header||[],p=0;e.forEach(function(v,w){Ns(v).forEach(function(k){(p=m.indexOf(k))==-1&&(m[p=m.length]=k);var T=v[k],E="z",N="",O=Ue({c:o+p,r:i+w+s});c=du(a,O),T&&typeof T=="object"&&!(T instanceof Date)?a[O]=T:(typeof T=="number"?E="n":typeof T=="boolean"?E="b":typeof T=="string"?E="s":T instanceof Date?(E="d",n.cellDates||(E="n",T=Jr(T)),N=n.dateNF||ze[14]):T===null&&n.nullError&&(E="e",T=0),c?(c.t=E,c.v=T,delete c.w,delete c.R,N&&(c.z=N)):a[O]=c={t:E,v:T},N&&(c.z=N))})}),u.e.c=Math.max(u.e.c,o+m.length-1);var x=Tr(i);if(s)for(p=0;p<m.length;++p)a[sr(p+o)+x]={t:"s",v:m[p]};return a["!ref"]=rt(u),a}function q7(t,e){return RI(null,t,e)}function du(t,e,r){if(typeof e=="string"){if(Array.isArray(t)){var n=qr(e);return t[n.r]||(t[n.r]=[]),t[n.r][n.c]||(t[n.r][n.c]={t:"z"})}return t[e]||(t[e]={t:"z"})}return typeof e!="number"?du(t,Ue(e)):du(t,Ue({r:e,c:r||0}))}function X7(t,e){if(typeof e=="number"){if(e>=0&&t.SheetNames.length>e)return e;throw new Error("Cannot find sheet # "+e)}else if(typeof e=="string"){var r=t.SheetNames.indexOf(e);if(r>-1)return r;throw new Error("Cannot find sheet name |"+e+"|")}else throw new Error("Cannot find sheet |"+e+"|")}function gx(){return{SheetNames:[],Sheets:{}}}function vx(t,e,r,n){var s=1;if(!r)for(;s<=65535&&t.SheetNames.indexOf(r="Sheet"+s)!=-1;++s,r=void 0);if(!r||t.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&t.SheetNames.indexOf(r)>=0){var a=r.match(/(^.*?)(\d+)$/);s=a&&+a[2]||0;var i=a&&a[1]||r;for(++s;s<=65535&&t.SheetNames.indexOf(r=i+s)!=-1;++s);}if(DB(r),t.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return t.SheetNames.push(r),t.Sheets[r]=e,r}function Y7(t,e,r){t.Workbook||(t.Workbook={}),t.Workbook.Sheets||(t.Workbook.Sheets=[]);var n=X7(t,e);switch(t.Workbook.Sheets[n]||(t.Workbook.Sheets[n]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}t.Workbook.Sheets[n].Hidden=r}function Q7(t,e){return t.z=e,t}function NI(t,e,r){return e?(t.l={Target:e},r&&(t.l.Tooltip=r)):delete t.l,t}function J7(t,e,r){return NI(t,"#"+e,r)}function Z7(t,e,r){t.c||(t.c=[]),t.c.push({t:e,a:r||"SheetJS"})}function ez(t,e,r,n){for(var s=typeof e!="string"?e:Bt(e),a=typeof e=="string"?e:rt(e),i=s.s.r;i<=s.e.r;++i)for(var o=s.s.c;o<=s.e.c;++o){var l=du(t,i,o);l.t="n",l.F=a,delete l.v,i==s.s.r&&o==s.s.c&&(l.f=r,n&&(l.D=!0))}return t}var tz={encode_col:sr,encode_row:Tr,encode_cell:Ue,encode_range:rt,decode_col:rx,decode_row:tx,split_cell:h8,decode_cell:qr,decode_range:kl,format_cell:ga,sheet_add_aoa:FA,sheet_add_json:RI,sheet_add_dom:kI,aoa_to_sheet:Sl,json_to_sheet:q7,table_to_sheet:SI,table_to_book:v7,sheet_to_csv:CI,sheet_to_txt:G7,sheet_to_json:Vp,sheet_to_html:g7,sheet_to_formulae:K7,sheet_to_row_object_array:Vp,sheet_get_cell:du,book_new:gx,book_append_sheet:vx,book_set_sheet_visibility:Y7,cell_set_number_format:Q7,cell_set_hyperlink:NI,cell_set_internal_link:J7,cell_add_comment:Z7,sheet_set_array_formula:ez,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};const rz=({tmdbApiKey:t,userId:e,onDone:r})=>{const[n,s]=W.useState(null),[a,i]=W.useState([]),[o,l]=W.useState([]),[c,u]=W.useState("upload"),[h,m]=W.useState(0),[p,x]=W.useState(0),[v,w]=W.useState(!1),[k,T]=W.useState(null),[E,N]=W.useState([]),[O,M]=W.useState(null),g=o.filter(C=>C.selected&&C.tmdbMatch).length,y=C=>{var he;const oe=(he=C.target.files)==null?void 0:he[0];if(!oe)return;s(oe);const ae=new FileReader;ae.onload=me=>{var B;const ee=jp((B=me.target)==null?void 0:B.result,{type:"binary"}),H=ee.Sheets[ee.SheetNames[0]],de=tz.sheet_to_json(H).map(K=>({title:K.title||K.Title||K.name||K.Name||"",releaseDate:K.releaseDate||K.ReleaseDate||K.release_date||K.year||K.Year||"",watched:K.watched||K.Watched||!1,rating:K.rating||K.Rating||null,review:K.review||K.Review||K.notes||K.Notes||""})).filter(K=>K.title);i(de)},ae.readAsBinaryString(oe)},S=async()=>{if(!a.length||!t){M("Missing data or TMDB key");return}try{w(!0),M(null),l([]),m(0);const C=[],oe=mn(_t,"movies");for(let ae=0;ae<a.length;ae++){const he=a[ae];try{const me=`${he.title} ${he.releaseDate||""}`.trim(),ee=await Cp(me,t);if(!ee.results.length)C.push({excelData:he,tmdbMatch:null,confidence:0,status:"unmatched",userMovieExists:!1,selected:!1});else{const H=await Yh(ee.results[0].id,t),ue=Hy(he,H),de=await kn(Gh(oe,Kh("tmdbId","==",H.id)));let B,K=!1;de.empty||(B=de.docs[0].id,K=!!await Ap(e,B)),C.push({excelData:he,tmdbMatch:H,confidence:ue,status:K?"duplicate":ue>=70?"matched":"manual",userMovieExists:K,movieId:B,selected:!K})}}catch{C.push({excelData:he,tmdbMatch:null,confidence:0,status:"unmatched",userMovieExists:!1,selected:!1})}m(Math.round((ae+1)/a.length*100))}l(C),u("review")}finally{w(!1)}},R=async(C,oe)=>{try{w(!0);const ae=o[C],he=oe||ae.excelData.title,me=await Cp(he,t);T(C),N(me.results)}finally{w(!1)}},P=async C=>{if(k!=null){w(!0);try{const oe=await Yh(C.id,t),ae=Hy(o[k].excelData,oe),he=mn(_t,"movies"),me=await kn(Gh(he,Kh("tmdbId","==",oe.id)));let ee,H=!1;me.empty||(ee=me.docs[0].id,H=!!await Ap(e,ee)),l(ue=>{const de=[...ue],B=de[k];return de[k]={...B,tmdbMatch:oe,confidence:ae,status:H?"duplicate":"matched",userMovieExists:H,movieId:ee,selected:!H},de}),T(null),N([])}finally{w(!1)}}},b=async()=>{const C=o.filter(ae=>ae.selected&&ae.tmdbMatch);if(!C.length)return;u("import"),x(0);const oe=mn(_t,"movies");for(let ae=0;ae<C.length;ae++){const he=C[ae];try{let me=he.movieId;me||(me=(await Uv(oe,{...Wv(he.tmdbMatch),addedAt:new Date,updatedAt:new Date})).id),await $v(e,me,{userId:e,movieId:me,watched:he.excelData.watched||!1,rating:he.excelData.rating||null,review:he.excelData.review||"",favorite:!1})}catch{}x(Math.round((ae+1)/C.length*100))}r==null||r()};return d.jsxs("div",{className:"space-y-6",children:[c==="upload"&&d.jsxs("div",{className:"space-y-4",children:[d.jsx("input",{type:"file",accept:".xlsx,.xls",className:"file-input file-input-bordered w-full",onChange:y}),!!a.length&&d.jsxs("div",{className:"text-sm opacity-80",children:[a.length," rows detected"]}),d.jsx("button",{className:"btn btn-primary",onClick:S,disabled:!t||!a.length||v,children:v?d.jsx("span",{className:"loading loading-spinner loading-sm"}):"Scan & Match"})]}),c==="review"&&d.jsxs("div",{className:"space-y-4",children:[d.jsxs("div",{className:"flex justify-between items-center",children:[d.jsx("div",{className:"font-bold",children:"Review Matches"}),d.jsx("button",{className:"btn btn-ghost btn-sm",onClick:()=>u("upload"),children:"Back"})]}),d.jsx("div",{className:"overflow-x-auto",children:d.jsxs("table",{className:"table table-zebra w-full",children:[d.jsx("thead",{children:d.jsxs("tr",{children:[d.jsx("th",{}),d.jsx("th",{children:"Excel"}),d.jsx("th",{children:"Match"}),d.jsx("th",{children:"Confidence"}),d.jsx("th",{children:"Status"}),d.jsx("th",{children:"Action"})]})}),d.jsx("tbody",{children:o.map((C,oe)=>{var ae;return d.jsxs("tr",{className:C.userMovieExists?"bg-warning bg-opacity-20":"",children:[d.jsx("td",{children:d.jsx("input",{type:"checkbox",className:"checkbox",checked:C.selected,disabled:!C.tmdbMatch,onChange:()=>{const he=[...o];he[oe].selected=!he[oe].selected,l(he)}})}),d.jsxs("td",{children:[d.jsx("div",{className:"font-semibold",children:C.excelData.title}),d.jsx("div",{className:"text-xs opacity-70",children:C.excelData.releaseDate||"-"})]}),d.jsx("td",{children:C.tmdbMatch?d.jsxs("div",{className:"flex items-center gap-3",children:[d.jsx("div",{className:"w-12 h-18",children:ws(C.tmdbMatch)?d.jsx("img",{src:ws(C.tmdbMatch),className:"object-cover"}):d.jsx("div",{className:"w-full h-full bg-base-200"})}),d.jsxs("div",{children:[d.jsx("div",{className:"font-semibold",children:C.tmdbMatch.title}),d.jsx("div",{className:"text-xs opacity-70",children:(ae=C.tmdbMatch.release_date)==null?void 0:ae.slice(0,4)})]})]}):d.jsx("span",{className:"text-error",children:"No match"})}),d.jsx("td",{children:C.tmdbMatch?d.jsxs("div",{className:"flex items-center",children:[d.jsx("progress",{className:`progress ${C.confidence>=70?"progress-success":C.confidence>=40?"progress-warning":"progress-error"}`,value:C.confidence,max:100}),d.jsxs("span",{className:"ml-2",children:[C.confidence,"%"]})]}):"-"}),d.jsxs("td",{children:[C.status==="matched"&&d.jsx("div",{className:"badge badge-success",children:"Matched"}),C.status==="unmatched"&&d.jsx("div",{className:"badge badge-error",children:"Unmatched"}),C.status==="duplicate"&&d.jsx("div",{className:"badge badge-warning",children:"Duplicate"}),C.status==="manual"&&d.jsx("div",{className:"badge badge-info",children:"Manual"})]}),d.jsx("td",{children:d.jsx("button",{className:"btn btn-sm btn-outline",onClick:()=>R(oe),children:d.jsx("i",{className:"fas fa-search"})})})]},oe)})})]})}),d.jsx("div",{className:"flex justify-end",children:d.jsxs("button",{className:"btn btn-primary",onClick:b,disabled:!g||v,children:["Import ",g," Movies"]})}),!!h&&h<100&&d.jsx("div",{children:d.jsx("progress",{className:"progress w-full",value:h,max:100})})]}),c==="import"&&d.jsxs("div",{className:"space-y-3",children:[d.jsx("div",{className:"font-bold",children:"Importing"}),d.jsx("progress",{className:"progress w-full",value:p,max:100})]}),k!==null&&d.jsx("div",{className:"modal modal-open",children:d.jsxs("div",{className:"modal-box max-w-4xl",children:[d.jsxs("h3",{className:"font-bold text-lg mb-4",children:["Manual match: ",o[k].excelData.title]}),d.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 mb-6",children:[d.jsx("input",{type:"text",className:"input input-bordered flex-1",placeholder:"Search for a movie...",defaultValue:o[k].excelData.title,onKeyDown:C=>C.key==="Enter"&&R(k,C.target.value)}),d.jsx("button",{className:"btn btn-primary w-full sm:w-auto",onClick:()=>{var C;return R(k,(C=document.querySelector(".modal input"))==null?void 0:C.value)},disabled:v,children:v?d.jsx("span",{className:"loading loading-spinner loading-sm"}):d.jsx("i",{className:"fas fa-search"})})]}),d.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-3 max-h-96 overflow-y-auto",children:E.map(C=>{var oe;return d.jsxs("div",{className:"card bg-base-100 shadow cursor-pointer",onClick:()=>P(C),children:[d.jsx("figure",{children:ws(C)?d.jsx("img",{src:ws(C)}):d.jsx("div",{className:"h-48 w-full bg-base-200"})}),d.jsxs("div",{className:"card-body p-3",children:[d.jsx("div",{className:"text-sm font-semibold",children:C.title}),d.jsx("div",{className:"text-xs opacity-70",children:(oe=C.release_date)==null?void 0:oe.slice(0,4)})]})]},C.id)})}),d.jsx("div",{className:"modal-action",children:d.jsx("button",{className:"btn",onClick:()=>{T(null),N([])},children:"Close"})})]})}),O&&d.jsx("div",{className:"alert alert-error",children:O})]})},nz=({selected:t,showDetails:e,loading:r,onToggleDetails:n,onAdd:s,onClose:a})=>{var i,o,l,c,u;return t?d.jsx("dialog",{className:"modal modal-open",children:d.jsxs("div",{className:"modal-box bg-xmas-card",children:[d.jsxs("div",{className:"flex gap-4",children:[d.jsx("div",{className:"w-24 shrink-0",children:ws(t)?d.jsx("img",{src:ws(t),alt:t.title,className:"w-full rounded-lg"}):d.jsx("div",{className:"w-full h-36 bg-base-200 flex items-center justify-center rounded-lg",children:d.jsx("i",{className:"fas fa-film text-2xl opacity-50"})})}),d.jsxs("div",{className:"flex-1",children:[d.jsx("h2",{className:"text-xl font-bold mb-1",children:t.title}),d.jsx("p",{className:"text-sm opacity-80 mb-1",children:(i=t.release_date)==null?void 0:i.slice(0,4)}),!e&&t.runtime&&d.jsxs("p",{className:"text-sm opacity-80 mb-1",children:["Runtime: ",t.runtime," min"]}),e&&d.jsxs("div",{className:"mt-3 space-y-2 text-sm opacity-90 max-h-48 overflow-auto pr-1",children:[t.overview&&d.jsxs("div",{children:[d.jsx("p",{className:"font-semibold mb-1",children:"Overview"}),d.jsx("p",{children:t.overview})]}),t.runtime&&d.jsxs("p",{children:[d.jsx("span",{className:"font-semibold",children:"Runtime:"})," ",t.runtime," min"]}),t.genres&&t.genres.length>0&&d.jsxs("p",{children:[d.jsx("span",{className:"font-semibold",children:"Genres:"})," ",t.genres.map(h=>typeof h=="string"?h:h.name).join(", ")]}),(((l=(o=t.credits)==null?void 0:o.cast)==null?void 0:l.length)||((c=t.cast)==null?void 0:c.length))&&d.jsxs("p",{children:[d.jsx("span",{className:"font-semibold",children:"Top cast:"})," ",((u=t.credits)!=null&&u.cast&&t.credits.cast.length>0?t.credits.cast.map(h=>h.name):t.cast).slice(0,5).join(", ")]})]})]})]}),d.jsxs("div",{className:"mt-4 space-y-3",children:[d.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-3",children:[d.jsx("div",{children:(t.overview||t.runtime||t.genres||t.credits||t.cast)&&d.jsxs("button",{type:"button",className:"btn btn-outline btn-sm sm:btn-md gap-2",onClick:n,disabled:r,children:[d.jsx("i",{className:"fas fa-info-circle"}),e?"Hide details":"View details"]})}),d.jsxs("div",{className:"flex justify-end gap-2",children:[d.jsxs("button",{className:"btn btn-primary btn-sm sm:btn-md",onClick:s,disabled:r,children:[r?d.jsx("span",{className:"loading loading-spinner loading-sm mr-2"}):d.jsx("i",{className:"fas fa-plus mr-2"}),"Add Movie"]}),d.jsx("button",{className:"btn btn-outline btn-sm sm:btn-md",onClick:a,disabled:r,children:"Cancel"})]})]}),t.id&&d.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center gap-2",children:[d.jsx("a",{href:`https://www.themoviedb.org/movie/${t.id}`,target:"_blank",rel:"noopener noreferrer",className:"btn btn-outline btn-xs sm:btn-sm flex items-center justify-center gap-2",children:d.jsx("img",{src:"/tmdb.svg",alt:"TMDB",className:"h-4 sm:h-5"})}),d.jsx("p",{className:"text-[10px] text-gray-400 max-w-xs",children:"This product uses the TMDB API but is not endorsed or certified by TMDB."})]})]}),d.jsx("form",{method:"dialog",className:"modal-backdrop",onClick:a,children:d.jsx("button",{children:"close"})})]})}):null},sz=()=>{const{currentUser:t,userProfile:e}=fs(),{isAdmin:r}=Ou(),[n,s]=W.useState(""),[a,i]=W.useState("local"),[o,l]=W.useState(null),[c,u]=W.useState(!1),[h,m]=W.useState(!1),[p,x]=W.useState(null),[v,w]=W.useState([]);W.useEffect(()=>{r&&(e!=null&&e.tmdbApiKey)?s(e.tmdbApiKey):s("")},[e,r]),W.useEffect(()=>{(async()=>{if(!t){w([]);return}try{const{userMovies:M}=await Qd(t.uid);w(Object.keys(M))}catch(M){console.error("Error loading user movies for import page:",M)}})()},[t]);const k=O=>{x(null),u(!1),l(O)},T=async O=>{if(!r){x({type:"error",text:"Only admins can import directly from TMDB."});return}if(!n){x({type:"error",text:"TMDB key required to fetch details."});return}try{m(!0),x(null),u(!1);const M=await Yh(O.id,n);l(M)}catch(M){x({type:"error",text:(M==null?void 0:M.message)??"Failed to fetch details"})}finally{m(!1)}},E=async()=>{if(!(!t||!o))try{m(!0),x(null);const O=mn(_t,"movies"),M=await kn(Gh(O,Kh("tmdbId","==",o.id)));let g;if(M.empty){if(!r){x({type:"error",text:"Only admins can add new catalogue movies."}),m(!1);return}g=(await Uv(O,{...Wv(o),addedAt:new Date,updatedAt:new Date})).id}else g=M.docs[0].id;await $v(t.uid,g,{userId:t.uid,movieId:g,watched:!1,favorite:!1}),w(y=>y.includes(g)?y:[...y,g]),x({type:"success",text:"Added to your collection!"}),u(!1),l(null)}catch(O){x({type:"error",text:(O==null?void 0:O.message)??"Failed to add movie"})}finally{m(!1)}},N=()=>{h||l(null)};return d.jsxs("div",{className:"container mx-auto px-4 py-8",children:[d.jsx("div",{className:"mb-4",children:d.jsxs(et,{to:"/movies",className:"btn btn-primary btn-sm sm:btn-md",children:[d.jsx("i",{className:"fas fa-arrow-left mr-2"})," Back to Movies"]})}),d.jsx("h1",{className:"font-christmas text-3xl md:text-4xl text-xmas-line mb-6",children:"Add Movies"}),p&&d.jsxs("div",{className:`alert ${p.type==="error"?"alert-error":"alert-success"} mb-4`,children:[d.jsx("i",{className:`fas ${p.type==="error"?"fa-exclamation-circle":"fa-check-circle"} mr-2`}),d.jsx("span",{children:p.text})]}),d.jsxs("div",{className:"tabs tabs-boxed mb-6",children:[d.jsxs("button",{className:`tab ${a==="local"?"tab-active":""}`,onClick:()=>i("local"),children:[d.jsx("i",{className:"fas fa-database mr-2"}),"Local"]}),r&&d.jsxs("button",{className:`tab ${a==="tmdb"?"tab-active":""}`,onClick:()=>i("tmdb"),children:[d.jsx("i",{className:"fas fa-search mr-2"}),"TMDB"]}),r&&d.jsxs("button",{className:`tab ${a==="excel"?"tab-active":""}`,onClick:()=>i("excel"),children:[d.jsx("i",{className:"fas fa-file-excel mr-2"}),"Excel"]})]}),a==="local"&&d.jsx("div",{className:"bg-xmas-card p-6 rounded-lg shadow-lg",children:d.jsx(XL,{onSelect:k,userMovieIds:v})}),a==="tmdb"&&r&&d.jsxs("div",{className:"bg-xmas-card p-6 rounded-lg shadow-lg",children:[!n&&d.jsxs("div",{className:"alert alert-warning mb-4",children:[d.jsx("i",{className:"fas fa-exclamation-triangle mr-2"}),d.jsx("span",{children:"Set your TMDB API key in Profile to search TMDB."})]}),d.jsx(ZL,{tmdbApiKey:n,onSelect:T})]}),a==="excel"&&r&&d.jsxs("div",{className:"bg-xmas-card p-6 rounded-lg shadow-lg",children:[!n&&d.jsxs("div",{className:"alert alert-warning mb-4",children:[d.jsx("i",{className:"fas fa-exclamation-triangle mr-2"}),d.jsx("span",{children:"TMDB key required for matching."})]}),t?d.jsx(rz,{tmdbApiKey:n,userId:t.uid,onDone:()=>i("local")}):d.jsx("div",{className:"alert alert-info",children:"Log in to import from Excel."})]}),o&&d.jsx(nz,{selected:o,showDetails:c,loading:h,onToggleDetails:()=>u(O=>!O),onAdd:E,onClose:N})]})},az=()=>{var w,k,T;const{currentUser:t}=fs(),[e,r]=W.useState([]),[n,s]=W.useState({}),[a,i]=W.useState(!0),[o,l]=W.useState(null),[c,u]=W.useState(null),[h,m]=W.useState(!1),[p,x]=W.useState(!1);W.useEffect(()=>{(async()=>{if(t)try{i(!0);const{userMovies:N,movies:O}=await Qd(t.uid);s(N),r(O)}catch(N){console.error("Error fetching movies:",N),l("Failed to load movies")}finally{i(!1)}})()},[t]);const v=()=>{if(e.length===0)return;x(!0),u(null);const E=e.filter(g=>{const y=n[g.id];return h||!y||!y.watched});if(E.length===0){l("No eligible movies found. Try including watched movies."),x(!1);return}let N=0;const O=25,M=setInterval(()=>{const g=Math.floor(Math.random()*E.length);u(E[g]),N++,N>=O&&(clearInterval(M),x(!1))},100)};return a?d.jsx("div",{className:"flex justify-center items-center min-h-[60vh]",children:d.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-xmas-gold"})}):d.jsxs("div",{className:"container mx-auto px-4 py-8",children:[d.jsx("div",{className:"mb-4",children:d.jsxs(et,{to:"/movies",className:"btn btn-primary btn-sm sm:btn-md",children:[d.jsx("i",{className:"fas fa-arrow-left mr-2"})," Back to Movies"]})}),d.jsx("h1",{className:"font-christmas text-3xl md:text-4xl text-xmas-line mb-6",children:"Christmas Movie Picker"}),o&&d.jsxs("div",{className:"alert alert-error mb-6",children:[d.jsx("i",{className:"fas fa-exclamation-circle mr-2"}),d.jsx("span",{children:o})]}),e.length===0?d.jsxs("div",{className:"bg-xmas-card p-8 rounded-lg text-center",children:[d.jsx("h3",{className:"text-xl mb-4",children:"No movies in your collection"}),d.jsx("p",{className:"mb-4",children:"Add some Christmas movies to use the random movie picker!"}),d.jsxs(et,{to:"/import",className:"btn btn-primary",children:[d.jsx("i",{className:"fas fa-file-import mr-2"})," Import Movies"]})]}):d.jsxs("div",{className:"bg-xmas-card p-8 rounded-lg shadow-lg",children:[d.jsxs("div",{className:"text-center mb-6",children:[d.jsx("p",{className:"mb-4",children:"Can't decide what Christmas movie to watch? Let us pick one for you!"}),d.jsx("div",{className:"form-control mb-6",children:d.jsxs("label",{className:"label cursor-pointer justify-center",children:[d.jsx("span",{className:"label-text mr-2",children:"Include watched movies"}),d.jsx("input",{type:"checkbox",className:"toggle toggle-primary",checked:h,onChange:()=>m(!h)})]})}),d.jsx("button",{className:"btn btn-primary btn-lg",onClick:v,disabled:p,children:p?d.jsxs(d.Fragment,{children:[d.jsx("span",{className:"loading loading-spinner loading-md mr-2"}),"Picking a movie..."]}):d.jsxs(d.Fragment,{children:[d.jsx("i",{className:"fas fa-random mr-2"}),"Pick a Random Movie"]})})]}),c&&d.jsx("div",{className:"mt-8 flex flex-col items-center",children:d.jsx("div",{className:"w-full max-w-md",children:d.jsxs("div",{className:"card bg-base-100 shadow-xl overflow-hidden",children:[d.jsxs("figure",{className:"relative",children:[c.posterUrl?d.jsx("img",{src:c.posterUrl,alt:c.title,className:"w-full object-contain",style:{aspectRatio:"2/3",maxHeight:"500px"},loading:"lazy"}):d.jsx("div",{className:"w-full flex items-center justify-center bg-gray-800",style:{aspectRatio:"2/3",maxHeight:"500px"},children:d.jsx("i",{className:"fas fa-film text-6xl text-gray-500"})}),((w=n[c.id])==null?void 0:w.watched)&&d.jsx("div",{className:"absolute top-4 left-4 badge badge-lg badge-success",children:"Already Watched"}),((k=n[c.id])==null?void 0:k.rating)&&d.jsxs("div",{className:"absolute top-4 right-4 badge badge-lg badge-warning",children:[d.jsx("i",{className:"fas fa-star mr-1"}),n[c.id].rating,"/10"]})]}),d.jsxs("div",{className:"card-body",children:[d.jsx("h2",{className:"card-title text-2xl font-christmas",children:c.title}),d.jsx("p",{className:"text-gray-400",children:(T=c.releaseDate)==null?void 0:T.substring(0,4)}),d.jsxs("div",{className:"card-actions justify-end mt-4",children:[d.jsx(et,{to:zv(c.title,c.id),className:"btn btn-primary",children:"View Details"}),d.jsx("button",{className:"btn btn-outline",onClick:v,disabled:p,children:"Pick Another"})]})]})]})})})]})]})},iz=(t,e)=>{const r=["Title","TMDB ID","Release Year","Watched","Watched Date","Rating","Review","Favorite","Date Added"].join(","),n=t.map(s=>{const a=e[s.id];if(!a)return null;const i=s.releaseDate?s.releaseDate.substring(0,4):"",o=a.watchedDate?Up(a.watchedDate):"",l=a.addedAt?Up(a.addedAt):"",c=Xw(s.title),u=a.review?Xw(a.review):"";return[c,s.tmdbId||"",i,a.watched?"Yes":"No",o,a.rating!==null&&a.rating!==void 0?a.rating:"",u,a.favorite?"Yes":"No",l].join(",")}).filter(Boolean);return[r,...n].join(`
`)},Up=t=>{if(!(t instanceof Date))try{t&&typeof t.toDate=="function"?t=t.toDate():t=new Date(t)}catch{return""}return t.toISOString().split("T")[0]},Xw=t=>t?t.includes(",")||t.includes('"')||t.includes(`
`)?`"${t.replace(/"/g,'""')}"`:t:"",oz=(t,e,r)=>{const n=document.createElement("a"),s=new Blob([t],{type:r});n.href=URL.createObjectURL(s),n.download=e,n.click(),URL.revokeObjectURL(n.href)},lz=async(t,e,r)=>{const n=iz(t,e),s=`${r.replace(/\s+/g,"_")}_christmas_movies_${Up(new Date)}.csv`;oz(n,s,"text/csv;charset=utf-8;")},cz=async()=>{const t=mn(_t,"movies"),e=await kn(t);let r=0;const n=e.size;for(const s of e.docs){const a=s.data();if(a.sortTitle)continue;const i=qS(a.title);i!==a.title&&(await hl(Yr(_t,"movies",s.id),{sortTitle:i,updatedAt:new Date}),r++)}return{updated:r,total:n}},uz=()=>{const{currentUser:t,userProfile:e,signOut:r}=fs(),{isAdmin:n}=Ou(),[s,a]=W.useState(!1),[i,o]=W.useState(""),[l,c]=W.useState(!1),[u,h]=W.useState(!1),[m,p]=W.useState(!1),[x,v]=W.useState(null),[w,k]=W.useState(null),[T,E]=W.useState({totalMovies:0,watchedMovies:0,unwatchedMovies:0,averageRating:0,favoriteMovies:0});W.useEffect(()=>{e!=null&&e.tmdbApiKey&&o(e.tmdbApiKey),(async()=>{if(t)try{const y=await KS(t.uid),S=y.length,R=y.filter(ae=>ae.watched).length,P=S-R,b=y.filter(ae=>ae.favorite).length,C=y.filter(ae=>ae.rating!==void 0&&ae.rating!==null),oe=C.length>0?C.reduce((ae,he)=>ae+(he.rating||0),0)/C.length:0;E({totalMovies:S,watchedMovies:R,unwatchedMovies:P,averageRating:oe,favoriteMovies:b})}catch(y){console.error("Error fetching user stats:",y)}})()},[t,e]);const N=async()=>{if(t)try{c(!0),v(null);const g=Yr(_t,"users",t.uid);await hl(g,{tmdbApiKey:i}),k("TMDB API key saved successfully!"),setTimeout(()=>{k(null)},3e3)}catch(g){console.error("Error saving API key:",g),v(g.message||"Failed to save API key")}finally{c(!1)}},O=async()=>{try{await r()}catch(g){console.error("Error signing out:",g)}},M=async()=>{if(t)try{h(!0),v(null);const{userMovies:g,movies:y}=await Qd(t.uid);await lz(y,g,e.displayName||"User"),k("Movies exported successfully!"),setTimeout(()=>{k(null)},3e3)}catch(g){console.error("Error exporting movies:",g),v(g.message||"Failed to export movies")}finally{h(!1)}};return!t||!e?d.jsx("div",{className:"flex justify-center items-center min-h-[60vh]",children:d.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-xmas-gold"})}):d.jsxs("div",{className:"container mx-auto px-4 py-8",children:[d.jsx("h1",{className:"font-christmas text-3xl md:text-4xl text-xmas-line mb-6",children:"Your Profile"}),x&&d.jsxs("div",{className:"alert alert-error mb-6",children:[d.jsx("i",{className:"fas fa-exclamation-circle mr-2"}),d.jsx("span",{children:x})]}),w&&d.jsxs("div",{className:"alert alert-success mb-6",children:[d.jsx("i",{className:"fas fa-check-circle mr-2"}),d.jsx("span",{children:w})]}),d.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-8",children:[d.jsx("div",{className:"md:col-span-1",children:d.jsxs("div",{className:"bg-xmas-card p-6 rounded-lg shadow-lg",children:[d.jsxs("div",{className:"flex flex-col items-center mb-6",children:[e.photoURL?d.jsx("img",{src:e.photoURL,alt:e.displayName,className:"w-24 h-24 rounded-full mb-4"}):d.jsx("div",{className:"w-24 h-24 rounded-full bg-gray-700 flex items-center justify-center mb-4",children:d.jsx("i",{className:"fas fa-user text-4xl text-gray-400"})}),d.jsx("h2",{className:"text-xl font-bold",children:e.displayName})]}),d.jsx("div",{className:"divider"}),d.jsxs("div",{className:"mb-6",children:[d.jsx("h3",{className:"text-lg font-bold mb-2",children:"Your Stats"}),d.jsxs("ul",{className:"space-y-2",children:[d.jsxs("li",{className:"flex justify-between",children:[d.jsx("span",{children:"Total Movies:"}),d.jsx("span",{className:"font-bold",children:T.totalMovies})]}),d.jsxs("li",{className:"flex justify-between",children:[d.jsx("span",{children:"Watched:"}),d.jsx("span",{className:"font-bold",children:T.watchedMovies})]}),d.jsxs("li",{className:"flex justify-between",children:[d.jsx("span",{children:"Unwatched:"}),d.jsx("span",{className:"font-bold",children:T.unwatchedMovies})]}),d.jsxs("li",{className:"flex justify-between",children:[d.jsx("span",{children:"Favorites:"}),d.jsx("span",{className:"font-bold",children:T.favoriteMovies})]}),d.jsxs("li",{className:"flex justify-between",children:[d.jsx("span",{children:"Average Rating:"}),d.jsxs("span",{className:"font-bold",children:[T.averageRating.toFixed(1),"/10"]})]})]})]}),d.jsx("div",{className:"divider"}),d.jsxs("div",{className:"mt-6 space-y-3",children:[d.jsxs("button",{className:"btn btn-outline btn-primary w-full",onClick:M,disabled:u||T.totalMovies===0,children:[u?d.jsx("span",{className:"loading loading-spinner loading-sm mr-2"}):d.jsx("i",{className:"fas fa-file-export mr-2"}),"Export Movie Data"]}),d.jsxs("button",{className:"btn btn-outline btn-error w-full",onClick:O,children:[d.jsx("i",{className:"fas fa-sign-out-alt mr-2"}),"Sign Out"]})]})]})}),d.jsx("div",{className:"md:col-span-2",children:d.jsxs("div",{className:"bg-xmas-card p-6 rounded-lg shadow-lg",children:[n&&d.jsxs(d.Fragment,{children:[d.jsx("h2",{className:"text-2xl font-bold mb-4",children:"Settings"}),d.jsxs("div",{className:"mb-6",children:[d.jsx("h3",{className:"text-lg font-bold mb-2",children:"TMDB API Key"}),d.jsxs("p",{className:"mb-4",children:["Your TMDB API key is used to fetch movies, cast and other details."," ",d.jsx("a",{href:"https://www.themoviedb.org/settings/api",target:"_blank",rel:"noopener noreferrer",className:"link link-primary",children:"The Movie Database"}),"."]}),d.jsxs("div",{className:"form-control",children:[d.jsx("label",{className:"label",children:d.jsx("span",{className:"label-text",children:"API Key"})}),d.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 items-stretch",children:[d.jsx("input",{type:s?"text":"password",className:"input input-bordered flex-1 h-12 text-lg",value:i,onChange:g=>o(g.target.value),placeholder:"Enter your TMDB API key",style:{letterSpacing:s?"normal":"3px"}}),d.jsx("button",{type:"button",className:"btn btn-ghost w-12",onClick:()=>a(g=>!g),children:d.jsx("i",{className:`fas ${s?"fa-eye-slash":"fa-eye"}`})}),d.jsx("button",{className:"btn btn-primary w-full sm:w-auto",onClick:N,disabled:l,children:l?d.jsx("span",{className:"loading loading-spinner loading-sm"}):d.jsx("i",{className:"fas fa-save"})})]})]})]}),d.jsx("div",{className:"divider"})]}),d.jsxs("div",{className:"mb-6",children:[d.jsx("h3",{className:"text-lg font-bold mb-2",children:"Quick Links"}),d.jsxs("div",{className:"flex flex-wrap gap-2",children:[d.jsxs(et,{to:"/movies",className:"btn btn-outline btn-sm",children:[d.jsx("i",{className:"fas fa-film mr-2"}),"My Movies"]}),d.jsxs(et,{to:"/import",className:"btn btn-outline btn-sm",children:[d.jsx("i",{className:"fas fa-file-import mr-2"}),"Import Movies"]}),d.jsxs(et,{to:"/random",className:"btn btn-outline btn-sm",children:[d.jsx("i",{className:"fas fa-random mr-2"}),"Random Movie Picker"]}),d.jsxs(et,{to:"/achievements",className:"btn btn-outline btn-sm",children:[d.jsx("i",{className:"fas fa-trophy mr-2"}),"Achievements"]})]})]}),n&&d.jsxs(d.Fragment,{children:[d.jsx("div",{className:"divider"}),d.jsxs("div",{className:"mb-6",children:[d.jsx("h3",{className:"text-lg font-bold mb-2",children:"Admin Tools"}),d.jsxs(et,{to:"/admin",className:"btn btn-primary btn-sm",children:[d.jsx("i",{className:"fas fa-tools mr-2"}),"Open Admin Dashboard"]})]})]})]})})]})]})},fz=()=>{const{currentUser:t}=fs(),[e,r]=W.useState(!0),[n,s]=W.useState([]);return W.useEffect(()=>{(async()=>{if(t)try{r(!0),await IL(t.uid);const i=mn(_t,`users/${t.uid}/achievements`),o=await kn(i),l=new Map;o.forEach(u=>{const h=u.data();let m=null;h.unlockedAt instanceof Date?m=h.unlockedAt:h.unlockedAt&&typeof h.unlockedAt.toDate=="function"&&(m=h.unlockedAt.toDate()),l.set(u.id,{unlockedAt:m,seen:h.seen})});const c=Bv.map(u=>{const h=l.get(u.id);return{id:u.id,name:u.name,description:u.description,hint:u.hint,icon:u.icon,unlocked:!!h,unlockedAt:(h==null?void 0:h.unlockedAt)??null}}).sort((u,h)=>u.unlocked===h.unlocked?u.name.localeCompare(h.name):u.unlocked?-1:1);s(c)}finally{r(!1)}})()},[t]),t?e?d.jsx("div",{className:"flex justify-center items-center min-h-[60vh]",children:d.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-xmas-gold"})}):d.jsxs("div",{className:"container mx-auto px-4 py-8",children:[d.jsx("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between mb-6",children:d.jsxs("div",{children:[d.jsx("h1",{className:"font-christmas text-3xl md:text-4xl text-xmas-line mb-2",children:"Achievements"}),d.jsx("p",{className:"text-sm text-xmas-text/80",children:"Unlock festive badges as you watch, rate and explore your Christmas movies."})]})}),d.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4",children:n.map(a=>d.jsxs("div",{className:"rounded-lg p-4 shadow-lg border transition-transform bg-xmas-card "+(a.unlocked?"border-xmas-gold hover:scale-[1.02]":"border-gray-700 opacity-70"),children:[d.jsxs("div",{className:"flex items-center mb-3",children:[d.jsx("div",{className:"text-3xl mr-3 flex items-center justify-center w-12 h-12 rounded-full "+(a.unlocked?"bg-xmas-gold/20":"bg-gray-700"),children:d.jsx("span",{children:a.icon})}),d.jsxs("div",{children:[d.jsxs("h2",{className:"text-lg font-bold flex items-center gap-2",children:[a.name,a.unlocked&&d.jsx("span",{className:"badge badge-success badge-sm",children:"Unlocked"})]}),a.unlocked&&a.unlockedAt&&d.jsxs("p",{className:"text-xs text-xmas-text/70 mt-1",children:["Unlocked on"," ",a.unlockedAt.toLocaleDateString(void 0,{year:"numeric",month:"short",day:"numeric"})]})]})]}),d.jsx("p",{className:"text-sm text-xmas-text mb-3",children:a.unlocked?a.description:a.hint}),!a.unlocked&&d.jsx("p",{className:"text-xs text-xmas-text/60 italic",children:"Locked  keep watching to reveal this badge."})]},a.id))})]}):d.jsx("div",{className:"flex justify-center items-center min-h-[60vh]",children:d.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-xmas-gold"})})},hz=()=>{const t=di(),{isAdmin:e,loading:r,currentUser:n}=Ou(),[s,a]=W.useState(!1),[i,o]=W.useState(null),l=!1;W.useEffect(()=>{e&&!r&&t("/admin")},[e,r,t]);const c=async()=>{o(null),a(!0);try{await vk(yc,wL)}catch(u){console.error("Login error:",u),u.code==="auth/popup-closed-by-user"?o("Sign-in popup was closed. Please try again."):u.code==="auth/cancelled-popup-request"?o("Another popup is already open. Please try again."):u.code==="auth/unauthorized-domain"?(console.error("Unauthorized domain error:",window.location.hostname),o("This domain is not authorized for OAuth operations. Please add "+window.location.hostname+" to your Firebase authorized domains list in the Firebase console under Authentication > Sign-in method > Authorized domains.")):o("Failed to sign in. Please try again."),a(!1)}};return r?d.jsx("div",{className:"flex justify-center items-center min-h-[60vh]",children:d.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-xmas-gold"})}):d.jsx("div",{className:"container mx-auto px-4 py-12",children:d.jsxs("div",{className:"max-w-md mx-auto",children:[d.jsxs("div",{className:"text-center mb-8",children:[d.jsx("h1",{className:"font-christmas text-4xl text-xmas-line mb-2",children:"Admin Login"}),d.jsx("p",{className:"text-xmas-mute",children:"Sign in to manage the Christmas Quiz"})]}),d.jsxs("div",{className:"bg-xmas-card rounded-lg shadow-lg p-6",children:[l,n&&d.jsxs("div",{className:"bg-info bg-opacity-10 border-l-4 border-info p-4 mb-6 rounded",children:[d.jsx("p",{className:"text-info font-bold mb-2",children:"User Authenticated"}),d.jsxs("p",{className:"text-info text-sm mb-1",children:["Email: ",n.email]}),d.jsxs("p",{className:"text-info text-sm mb-2",children:["UID: ",n.uid]}),d.jsxs("p",{className:"text-info text-sm",children:["To grant admin access, create a document in the ",d.jsx("code",{className:"bg-base-300 px-1 py-0.5 rounded",children:"admins"})," collection with this UID as the document ID."]}),l]}),i&&d.jsx("div",{className:"bg-error bg-opacity-10 border-l-4 border-error p-4 mb-6 rounded",children:d.jsx("p",{className:"text-error",children:i})}),d.jsxs("div",{className:"text-center mb-6",children:[d.jsx("p",{className:"mb-4",children:"Sign in with your Google account to access the admin panel."}),d.jsx("p",{className:"text-sm text-xmas-mute mb-6",children:"Only authorized administrators will be granted access."}),d.jsx("button",{onClick:c,className:"btn btn-primary w-full flex items-center justify-center gap-2",disabled:s,children:s?d.jsxs(d.Fragment,{children:[d.jsx("span",{className:"loading loading-spinner loading-sm"}),"Signing in..."]}):d.jsxs(d.Fragment,{children:[d.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 48 48",children:[d.jsx("path",{fill:"#FFC107",d:`M43.611,20.083H42V20H24v8h11.303c-1.649,4.657-6.08,8-11.303,8c-6.627,0-12-5.373-12-12
                      s5.373-12,12-12c3.059,0,5.842,1.154,7.961,3.039l5.657-5.657C34.046,6.053,29.268,4,24,4C12.955,4,4,12.955,4,24s8.955,20,20,20
                      s20-8.955,20-20C44,22.659,43.862,21.35,43.611,20.083z`}),d.jsx("path",{fill:"#FF3D00",d:`M6.306,14.691l6.571,4.819C14.655,15.108,18.961,12,24,12c3.059,0,5.842,1.154,7.961,3.039
                      l5.657-5.657C34.046,6.053,29.268,4,24,4C16.318,4,9.656,8.337,6.306,14.691z`}),d.jsx("path",{fill:"#4CAF50",d:`M24,44c5.166,0,9.86-1.977,13.409-5.192l-6.19-5.238C29.211,35.091,26.715,36,24,36
                      c-5.202,0-9.619-3.317-11.283-7.946l-6.522,5.025C9.505,39.556,16.227,44,24,44z`}),d.jsx("path",{fill:"#1976D2",d:`M43.611,20.083H42V20H24v8h11.303c-0.792,2.237-2.231,4.166-4.087,5.571
                      c0.001-0.001,0.002-0.001,0.003-0.002l6.19,5.238C36.971,39.205,44,34,44,24C44,22.659,43.862,21.35,43.611,20.083z`})]}),"Sign in with Google"]})})]})]}),d.jsx("div",{className:"text-center mt-6",children:d.jsx("button",{onClick:()=>t("/"),className:"btn btn-link text-xmas-mute",children:"Back to Home"})})]})})};async function dz(t,e){const r=await Yh(t,e),n=mn(_t,"movies"),s=Gh(n,Kh("tmdbId","==",r.id)),a=await kn(s),i={...Wv(r),updatedAt:new Date};if(a.empty){const o={...i,addedAt:new Date};return{movieId:(await Uv(n,o)).id,action:"created"}}else{const o=a.docs[0].id;return await ii(Yr(_t,"movies",o),i,{merge:!0}),{movieId:o,action:"updated"}}}const mz=t=>new Promise(e=>setTimeout(e,t));async function pz(t,e,r,n=200){let s=0,a=0,i=0,o=0;const l=[];for(let c=0;c<t.length;c++){const u=t[c];try{if(!u||Number.isNaN(u)){i++,r==null||r(c+1,t.length,"skipped");continue}const{movieId:h,action:m}=await dz(u,e);l.push(h),m==="created"?s++:a++,r==null||r(c+1,t.length,m),n>0&&await mz(n)}catch(h){console.error("Catalogue upsert error for TMDB",u,h),o++,r==null||r(c+1,t.length,"error")}}return{totalRequested:t.length,created:s,updated:a,skipped:i,errors:o,movieIds:l}}const gz=()=>{const t=di(),{isAdmin:e,loading:r}=Ou(),{userProfile:n}=fs(),[s,a]=W.useState(!0),[i,o]=W.useState(null),[l,c]=W.useState(null),[u,h]=W.useState(!1),[m,p]=W.useState({totalMovies:0,moviesWithSortTitle:0}),[x,v]=W.useState(""),[w,k]=W.useState(""),[T,E]=W.useState(!0),[N,O]=W.useState(!1),[M,g]=W.useState(0),[y,S]=W.useState("");W.useEffect(()=>{n!=null&&n.tmdbApiKey&&v(n.tmdbApiKey)},[n]),W.useEffect(()=>{!r&&!e&&t("/admin/login")},[e,r,t]),W.useEffect(()=>{e&&(async()=>{if(e){a(!0);try{const oe=await kn(mn(_t,"movies")),ae=oe.size;let he=0;oe.forEach(me=>{me.data().sortTitle&&he++}),p({totalMovies:ae,moviesWithSortTitle:he})}catch(oe){console.error("Error fetching movie data:",oe),o("Failed to load movie data")}finally{a(!1)}}})()},[e]);const R=async()=>{try{h(!0),o(null);const C=await cz();c(`Sort titles updated for ${C.updated} out of ${C.total} movies.`),p(oe=>({...oe,moviesWithSortTitle:oe.moviesWithSortTitle+C.updated})),setTimeout(()=>c(null),5e3)}catch(C){console.error("Error updating sort titles:",C),o(C.message||"Failed to update sort titles")}finally{h(!1)}},P=W.useMemo(()=>{const oe=w.split(/[\s,]+/).map(ae=>ae.trim()).filter(Boolean).map(ae=>Number(ae)).filter(ae=>Number.isInteger(ae)&&ae>0);return Array.from(new Set(oe))},[w]),b=async()=>{if(o(null),c(null),!x){o("TMDB API key required");return}if(P.length===0){o("Please paste at least one valid TMDB ID");return}try{O(!0),g(0),S(`Starting (0 / ${P.length})`);const C=await pz(P,x,(oe,ae,he)=>{const me=Math.round(oe/ae*100);g(me),S(`Processed ${oe} / ${ae} (${he})`)},T?300:0);c(`Catalogue updated. Created: ${C.created}, Updated: ${C.updated}, Skipped: ${C.skipped}, Errors: ${C.errors}.`)}catch(C){console.error(C),o((C==null?void 0:C.message)??"Catalogue import failed.")}finally{O(!1)}};return r||s?d.jsx("div",{className:"flex justify-center items-center min-h-[60vh]",children:d.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-xmas-gold"})}):d.jsxs("div",{className:"container mx-auto px-4 py-8",children:[d.jsxs("div",{className:"flex justify-between items-center mb-8",children:[d.jsx("h1",{className:"font-christmas text-3xl md:text-4xl text-xmas-line",children:"Admin Dashboard"}),d.jsx("div",{className:"flex gap-2",children:d.jsxs(et,{to:"/movies",className:"btn btn-outline",children:[d.jsx("i",{className:"fas fa-film mr-2"})," Movies"]})})]}),i&&d.jsxs("div",{className:"alert alert-error mb-6",children:[d.jsx("i",{className:"fas fa-exclamation-circle mr-2"}),d.jsx("span",{children:i})]}),l&&d.jsxs("div",{className:"alert alert-success mb-6",children:[d.jsx("i",{className:"fas fa-check-circle mr-2"}),d.jsx("span",{children:l})]}),d.jsxs("div",{className:"mb-8",children:[d.jsx("h2",{className:"text-2xl font-christmas mb-4 text-xmas-gold",children:"Movie Administration"}),d.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-8",children:[d.jsx("div",{className:"card bg-xmas-card shadow-xl",children:d.jsxs("div",{className:"card-body",children:[d.jsxs("h2",{className:"card-title font-christmas",children:[d.jsx("i",{className:"fas fa-sort-alpha-down text-primary mr-2"})," Sort Title Migration"]}),d.jsx("p",{className:"mb-4",children:'Update all movies to include sort titles (e.g., "The Grinch"  "Grinch") for better alphabetical sorting.'}),d.jsxs("div",{className:"flex flex-col gap-2",children:[d.jsxs("div",{className:"stats bg-base-200 text-base-content",children:[d.jsxs("div",{className:"stat",children:[d.jsx("div",{className:"stat-title",children:"Total Movies"}),d.jsx("div",{className:"stat-value",children:m.totalMovies})]}),d.jsxs("div",{className:"stat",children:[d.jsx("div",{className:"stat-title",children:"With Sort Titles"}),d.jsx("div",{className:"stat-value",children:m.moviesWithSortTitle}),d.jsx("div",{className:"stat-desc",children:m.totalMovies>0?`${Math.round(m.moviesWithSortTitle/m.totalMovies*100)}%`:"0%"})]})]}),d.jsxs("button",{className:"btn btn-primary w-full",onClick:R,disabled:u||m.moviesWithSortTitle===m.totalMovies,children:[u?d.jsx("span",{className:"loading loading-spinner loading-sm mr-2"}):d.jsx("i",{className:"fas fa-sync-alt mr-2"}),m.moviesWithSortTitle===m.totalMovies?"All Movies Updated":"Update Sort Titles"]})]})]})}),d.jsx("div",{className:"card bg-xmas-card shadow-xl",children:d.jsxs("div",{className:"card-body",children:[d.jsxs("h2",{className:"card-title font-christmas",children:[d.jsx("i",{className:"fas fa-database text-primary mr-2"})," Catalogue Builder (TMDB IDs)"]}),d.jsxs("p",{className:"mb-4",children:["Bulk-import TMDB titles into your ",d.jsx("code",{children:"movies"})," catalogue only  no user collections will be updated."]}),d.jsx("label",{className:"label mt-4",children:d.jsx("span",{className:"label-text",children:"TMDB IDs (comma / space / newline separated)"})}),d.jsx("textarea",{className:"textarea textarea-bordered w-full h-40",value:w,onChange:C=>k(C.target.value),placeholder:`e.g. 603, 497, 155, 27205
603
497 155
27205`}),d.jsxs("div",{className:"flex items-center gap-4 mt-4",children:[d.jsx("div",{className:"form-control",children:d.jsxs("label",{className:"label cursor-pointer gap-2",children:[d.jsx("span",{className:"label-text",children:"Slow mode (API friendly)"}),d.jsx("input",{type:"checkbox",className:"toggle",checked:T,onChange:C=>E(C.target.checked)})]})}),d.jsx("button",{className:"btn btn-primary ml-auto",onClick:b,disabled:N||P.length===0||!x,title:x?void 0:"Add your TMDB API key in Profile > Settings",children:N?d.jsxs(d.Fragment,{children:[d.jsx("span",{className:"loading loading-spinner loading-sm mr-2"}),"Importing ",P.length,""]}):d.jsxs(d.Fragment,{children:[d.jsx("i",{className:"fas fa-file-import mr-2"}),"Import ",P.length||0," to Catalogue"]})})]}),(N||M>0)&&d.jsxs("div",{className:"mt-4",children:[d.jsx("progress",{className:"progress w-full",value:M,max:100}),d.jsx("div",{className:"text-sm mt-1 opacity-80",children:y})]})]})})]})]})]})},vz=WN([{element:d.jsx(SL,{}),children:[{path:"/",element:d.jsx(CL,{})},{path:"/login",element:d.jsx(RL,{})},{element:d.jsx(zy,{}),children:[{path:"/movies",element:d.jsx(jL,{})},{path:"/movies/:movieId",element:d.jsx(qL,{})},{path:"/import",element:d.jsx(sz,{})},{path:"/random",element:d.jsx(az,{})},{path:"/profile",element:d.jsx(uz,{})},{path:"/achievements",element:d.jsx(fz,{})}]},{path:"/admin/login",element:d.jsx(hz,{})},{path:"/admin",element:d.jsx(zy,{children:d.jsx(gz,{})})}]}]);sm.createRoot(document.getElementById("root")).render(d.jsx(Hp.StrictMode,{children:d.jsx(EL,{children:d.jsx(JN,{router:vz})})}));
