function aE(e,t){for(var r=0;r<t.length;r++){const n=t[r];if(typeof n!="string"&&!Array.isArray(n)){for(const s in n)if(s!=="default"&&!(s in e)){const a=Object.getOwnPropertyDescriptor(n,s);a&&Object.defineProperty(e,s,a.get?a:{enumerable:!0,get:()=>n[s]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))n(s);new MutationObserver(s=>{for(const a of s)if(a.type==="childList")for(const i of a.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&n(i)}).observe(document,{childList:!0,subtree:!0});function r(s){const a={};return s.integrity&&(a.integrity=s.integrity),s.referrerPolicy&&(a.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?a.credentials="include":s.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function n(s){if(s.ep)return;s.ep=!0;const a=r(s);fetch(s.href,a)}})();function iE(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var oE={exports:{}},xd={},lE={exports:{}},Ye={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var _u=Symbol.for("react.element"),lN=Symbol.for("react.portal"),cN=Symbol.for("react.fragment"),uN=Symbol.for("react.strict_mode"),fN=Symbol.for("react.profiler"),hN=Symbol.for("react.provider"),dN=Symbol.for("react.context"),mN=Symbol.for("react.forward_ref"),pN=Symbol.for("react.suspense"),gN=Symbol.for("react.memo"),xN=Symbol.for("react.lazy"),e1=Symbol.iterator;function vN(e){return e===null||typeof e!="object"?null:(e=e1&&e[e1]||e["@@iterator"],typeof e=="function"?e:null)}var cE={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},uE=Object.assign,fE={};function _l(e,t,r){this.props=e,this.context=t,this.refs=fE,this.updater=r||cE}_l.prototype.isReactComponent={};_l.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};_l.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function hE(){}hE.prototype=_l.prototype;function Xp(e,t,r){this.props=e,this.context=t,this.refs=fE,this.updater=r||cE}var Qp=Xp.prototype=new hE;Qp.constructor=Xp;uE(Qp,_l.prototype);Qp.isPureReactComponent=!0;var t1=Array.isArray,dE=Object.prototype.hasOwnProperty,Jp={current:null},mE={key:!0,ref:!0,__self:!0,__source:!0};function pE(e,t,r){var n,s={},a=null,i=null;if(t!=null)for(n in t.ref!==void 0&&(i=t.ref),t.key!==void 0&&(a=""+t.key),t)dE.call(t,n)&&!mE.hasOwnProperty(n)&&(s[n]=t[n]);var o=arguments.length-2;if(o===1)s.children=r;else if(1<o){for(var l=Array(o),c=0;c<o;c++)l[c]=arguments[c+2];s.children=l}if(e&&e.defaultProps)for(n in o=e.defaultProps,o)s[n]===void 0&&(s[n]=o[n]);return{$$typeof:_u,type:e,key:a,ref:i,props:s,_owner:Jp.current}}function yN(e,t){return{$$typeof:_u,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function Zp(e){return typeof e=="object"&&e!==null&&e.$$typeof===_u}function _N(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(r){return t[r]})}var r1=/\/+/g;function g0(e,t){return typeof e=="object"&&e!==null&&e.key!=null?_N(""+e.key):t.toString(36)}function zf(e,t,r,n,s){var a=typeof e;(a==="undefined"||a==="boolean")&&(e=null);var i=!1;if(e===null)i=!0;else switch(a){case"string":case"number":i=!0;break;case"object":switch(e.$$typeof){case _u:case lN:i=!0}}if(i)return i=e,s=s(i),e=n===""?"."+g0(i,0):n,t1(s)?(r="",e!=null&&(r=e.replace(r1,"$&/")+"/"),zf(s,t,r,"",function(c){return c})):s!=null&&(Zp(s)&&(s=yN(s,r+(!s.key||i&&i.key===s.key?"":(""+s.key).replace(r1,"$&/")+"/")+e)),t.push(s)),1;if(i=0,n=n===""?".":n+":",t1(e))for(var o=0;o<e.length;o++){a=e[o];var l=n+g0(a,o);i+=zf(a,t,r,l,s)}else if(l=vN(e),typeof l=="function")for(e=l.call(e),o=0;!(a=e.next()).done;)a=a.value,l=n+g0(a,o++),i+=zf(a,t,r,l,s);else if(a==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return i}function uf(e,t,r){if(e==null)return e;var n=[],s=0;return zf(e,n,"","",function(a){return t.call(r,a,s++)}),n}function wN(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(r){(e._status===0||e._status===-1)&&(e._status=1,e._result=r)},function(r){(e._status===0||e._status===-1)&&(e._status=2,e._result=r)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var rn={current:null},$f={transition:null},EN={ReactCurrentDispatcher:rn,ReactCurrentBatchConfig:$f,ReactCurrentOwner:Jp};function gE(){throw Error("act(...) is not supported in production builds of React.")}Ye.Children={map:uf,forEach:function(e,t,r){uf(e,function(){t.apply(this,arguments)},r)},count:function(e){var t=0;return uf(e,function(){t++}),t},toArray:function(e){return uf(e,function(t){return t})||[]},only:function(e){if(!Zp(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};Ye.Component=_l;Ye.Fragment=cN;Ye.Profiler=fN;Ye.PureComponent=Xp;Ye.StrictMode=uN;Ye.Suspense=pN;Ye.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=EN;Ye.act=gE;Ye.cloneElement=function(e,t,r){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var n=uE({},e.props),s=e.key,a=e.ref,i=e._owner;if(t!=null){if(t.ref!==void 0&&(a=t.ref,i=Jp.current),t.key!==void 0&&(s=""+t.key),e.type&&e.type.defaultProps)var o=e.type.defaultProps;for(l in t)dE.call(t,l)&&!mE.hasOwnProperty(l)&&(n[l]=t[l]===void 0&&o!==void 0?o[l]:t[l])}var l=arguments.length-2;if(l===1)n.children=r;else if(1<l){o=Array(l);for(var c=0;c<l;c++)o[c]=arguments[c+2];n.children=o}return{$$typeof:_u,type:e.type,key:s,ref:a,props:n,_owner:i}};Ye.createContext=function(e){return e={$$typeof:dN,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:hN,_context:e},e.Consumer=e};Ye.createElement=pE;Ye.createFactory=function(e){var t=pE.bind(null,e);return t.type=e,t};Ye.createRef=function(){return{current:null}};Ye.forwardRef=function(e){return{$$typeof:mN,render:e}};Ye.isValidElement=Zp;Ye.lazy=function(e){return{$$typeof:xN,_payload:{_status:-1,_result:e},_init:wN}};Ye.memo=function(e,t){return{$$typeof:gN,type:e,compare:t===void 0?null:t}};Ye.startTransition=function(e){var t=$f.transition;$f.transition={};try{e()}finally{$f.transition=t}};Ye.unstable_act=gE;Ye.useCallback=function(e,t){return rn.current.useCallback(e,t)};Ye.useContext=function(e){return rn.current.useContext(e)};Ye.useDebugValue=function(){};Ye.useDeferredValue=function(e){return rn.current.useDeferredValue(e)};Ye.useEffect=function(e,t){return rn.current.useEffect(e,t)};Ye.useId=function(){return rn.current.useId()};Ye.useImperativeHandle=function(e,t,r){return rn.current.useImperativeHandle(e,t,r)};Ye.useInsertionEffect=function(e,t){return rn.current.useInsertionEffect(e,t)};Ye.useLayoutEffect=function(e,t){return rn.current.useLayoutEffect(e,t)};Ye.useMemo=function(e,t){return rn.current.useMemo(e,t)};Ye.useReducer=function(e,t,r){return rn.current.useReducer(e,t,r)};Ye.useRef=function(e){return rn.current.useRef(e)};Ye.useState=function(e){return rn.current.useState(e)};Ye.useSyncExternalStore=function(e,t,r){return rn.current.useSyncExternalStore(e,t,r)};Ye.useTransition=function(){return rn.current.useTransition()};Ye.version="18.3.1";lE.exports=Ye;var z=lE.exports;const wu=iE(z),TN=aE({__proto__:null,default:wu},[z]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var kN=z,SN=Symbol.for("react.element"),AN=Symbol.for("react.fragment"),IN=Object.prototype.hasOwnProperty,NN=kN.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,CN={key:!0,ref:!0,__self:!0,__source:!0};function xE(e,t,r){var n,s={},a=null,i=null;r!==void 0&&(a=""+r),t.key!==void 0&&(a=""+t.key),t.ref!==void 0&&(i=t.ref);for(n in t)IN.call(t,n)&&!CN.hasOwnProperty(n)&&(s[n]=t[n]);if(e&&e.defaultProps)for(n in t=e.defaultProps,t)s[n]===void 0&&(s[n]=t[n]);return{$$typeof:SN,type:e,key:a,ref:i,props:s,_owner:NN.current}}xd.Fragment=AN;xd.jsx=xE;xd.jsxs=xE;oE.exports=xd;var u=oE.exports,mm={},vE={exports:{}},Rn={},yE={exports:{}},_E={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(q,G){var ne=q.length;q.push(G);e:for(;0<ne;){var ce=ne-1>>>1,j=q[ce];if(0<s(j,G))q[ce]=G,q[ne]=j,ne=ce;else break e}}function r(q){return q.length===0?null:q[0]}function n(q){if(q.length===0)return null;var G=q[0],ne=q.pop();if(ne!==G){q[0]=ne;e:for(var ce=0,j=q.length,Y=j>>>1;ce<Y;){var K=2*(ce+1)-1,V=q[K],J=K+1,de=q[J];if(0>s(V,ne))J<j&&0>s(de,V)?(q[ce]=de,q[J]=ne,ce=J):(q[ce]=V,q[K]=ne,ce=K);else if(J<j&&0>s(de,ne))q[ce]=de,q[J]=ne,ce=J;else break e}}return G}function s(q,G){var ne=q.sortIndex-G.sortIndex;return ne!==0?ne:q.id-G.id}if(typeof performance=="object"&&typeof performance.now=="function"){var a=performance;e.unstable_now=function(){return a.now()}}else{var i=Date,o=i.now();e.unstable_now=function(){return i.now()-o}}var l=[],c=[],f=1,d=null,m=3,p=!1,x=!1,g=!1,w=typeof setTimeout=="function"?setTimeout:null,k=typeof clearTimeout=="function"?clearTimeout:null,E=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function y(q){for(var G=r(c);G!==null;){if(G.callback===null)n(c);else if(G.startTime<=q)n(c),G.sortIndex=G.expirationTime,t(l,G);else break;G=r(c)}}function I(q){if(g=!1,y(q),!x)if(r(l)!==null)x=!0,fe(M);else{var G=r(c);G!==null&&ue(I,G.startTime-q)}}function M(q,G){x=!1,g&&(g=!1,k(T),T=-1),p=!0;var ne=m;try{for(y(G),d=r(l);d!==null&&(!(d.expirationTime>G)||q&&!b());){var ce=d.callback;if(typeof ce=="function"){d.callback=null,m=d.priorityLevel;var j=ce(d.expirationTime<=G);G=e.unstable_now(),typeof j=="function"?d.callback=j:d===r(l)&&n(l),y(G)}else n(l);d=r(l)}if(d!==null)var Y=!0;else{var K=r(c);K!==null&&ue(I,K.startTime-G),Y=!1}return Y}finally{d=null,m=ne,p=!1}}var O=!1,v=null,T=-1,S=5,C=-1;function b(){return!(e.unstable_now()-C<S)}function P(){if(v!==null){var q=e.unstable_now();C=q;var G=!0;try{G=v(!0,q)}finally{G?D():(O=!1,v=null)}}else O=!1}var D;if(typeof E=="function")D=function(){E(P)};else if(typeof MessageChannel<"u"){var ie=new MessageChannel,Z=ie.port2;ie.port1.onmessage=P,D=function(){Z.postMessage(null)}}else D=function(){w(P,0)};function fe(q){v=q,O||(O=!0,D())}function ue(q,G){T=w(function(){q(e.unstable_now())},G)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(q){q.callback=null},e.unstable_continueExecution=function(){x||p||(x=!0,fe(M))},e.unstable_forceFrameRate=function(q){0>q||125<q?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):S=0<q?Math.floor(1e3/q):5},e.unstable_getCurrentPriorityLevel=function(){return m},e.unstable_getFirstCallbackNode=function(){return r(l)},e.unstable_next=function(q){switch(m){case 1:case 2:case 3:var G=3;break;default:G=m}var ne=m;m=G;try{return q()}finally{m=ne}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(q,G){switch(q){case 1:case 2:case 3:case 4:case 5:break;default:q=3}var ne=m;m=q;try{return G()}finally{m=ne}},e.unstable_scheduleCallback=function(q,G,ne){var ce=e.unstable_now();switch(typeof ne=="object"&&ne!==null?(ne=ne.delay,ne=typeof ne=="number"&&0<ne?ce+ne:ce):ne=ce,q){case 1:var j=-1;break;case 2:j=250;break;case 5:j=1073741823;break;case 4:j=1e4;break;default:j=5e3}return j=ne+j,q={id:f++,callback:G,priorityLevel:q,startTime:ne,expirationTime:j,sortIndex:-1},ne>ce?(q.sortIndex=ne,t(c,q),r(l)===null&&q===r(c)&&(g?(k(T),T=-1):g=!0,ue(I,ne-ce))):(q.sortIndex=j,t(l,q),x||p||(x=!0,fe(M))),q},e.unstable_shouldYield=b,e.unstable_wrapCallback=function(q){var G=m;return function(){var ne=m;m=G;try{return q.apply(this,arguments)}finally{m=ne}}}})(_E);yE.exports=_E;var bN=yE.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var RN=z,Cn=bN;function we(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,r=1;r<arguments.length;r++)t+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var wE=new Set,Oc={};function ro(e,t){tl(e,t),tl(e+"Capture",t)}function tl(e,t){for(Oc[e]=t,e=0;e<t.length;e++)wE.add(t[e])}var ua=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),pm=Object.prototype.hasOwnProperty,PN=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,n1={},s1={};function DN(e){return pm.call(s1,e)?!0:pm.call(n1,e)?!1:PN.test(e)?s1[e]=!0:(n1[e]=!0,!1)}function FN(e,t,r,n){if(r!==null&&r.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return n?!1:r!==null?!r.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function ON(e,t,r,n){if(t===null||typeof t>"u"||FN(e,t,r,n))return!0;if(n)return!1;if(r!==null)switch(r.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function nn(e,t,r,n,s,a,i){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=n,this.attributeNamespace=s,this.mustUseProperty=r,this.propertyName=e,this.type=t,this.sanitizeURL=a,this.removeEmptyString=i}var Ir={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){Ir[e]=new nn(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];Ir[t]=new nn(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){Ir[e]=new nn(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){Ir[e]=new nn(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){Ir[e]=new nn(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){Ir[e]=new nn(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){Ir[e]=new nn(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){Ir[e]=new nn(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){Ir[e]=new nn(e,5,!1,e.toLowerCase(),null,!1,!1)});var eg=/[\-:]([a-z])/g;function tg(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(eg,tg);Ir[t]=new nn(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(eg,tg);Ir[t]=new nn(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(eg,tg);Ir[t]=new nn(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){Ir[e]=new nn(e,1,!1,e.toLowerCase(),null,!1,!1)});Ir.xlinkHref=new nn("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){Ir[e]=new nn(e,1,!1,e.toLowerCase(),null,!0,!0)});function rg(e,t,r,n){var s=Ir.hasOwnProperty(t)?Ir[t]:null;(s!==null?s.type!==0:n||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(ON(t,r,s,n)&&(r=null),n||s===null?DN(t)&&(r===null?e.removeAttribute(t):e.setAttribute(t,""+r)):s.mustUseProperty?e[s.propertyName]=r===null?s.type===3?!1:"":r:(t=s.attributeName,n=s.attributeNamespace,r===null?e.removeAttribute(t):(s=s.type,r=s===3||s===4&&r===!0?"":""+r,n?e.setAttributeNS(n,t,r):e.setAttribute(t,r))))}var Ea=RN.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,ff=Symbol.for("react.element"),No=Symbol.for("react.portal"),Co=Symbol.for("react.fragment"),ng=Symbol.for("react.strict_mode"),gm=Symbol.for("react.profiler"),EE=Symbol.for("react.provider"),TE=Symbol.for("react.context"),sg=Symbol.for("react.forward_ref"),xm=Symbol.for("react.suspense"),vm=Symbol.for("react.suspense_list"),ag=Symbol.for("react.memo"),Da=Symbol.for("react.lazy"),kE=Symbol.for("react.offscreen"),a1=Symbol.iterator;function Vl(e){return e===null||typeof e!="object"?null:(e=a1&&e[a1]||e["@@iterator"],typeof e=="function"?e:null)}var jt=Object.assign,x0;function Jl(e){if(x0===void 0)try{throw Error()}catch(r){var t=r.stack.trim().match(/\n( *(at )?)/);x0=t&&t[1]||""}return`
`+x0+e}var v0=!1;function y0(e,t){if(!e||v0)return"";v0=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(c){var n=c}Reflect.construct(e,[],t)}else{try{t.call()}catch(c){n=c}e.call(t.prototype)}else{try{throw Error()}catch(c){n=c}e()}}catch(c){if(c&&n&&typeof c.stack=="string"){for(var s=c.stack.split(`
`),a=n.stack.split(`
`),i=s.length-1,o=a.length-1;1<=i&&0<=o&&s[i]!==a[o];)o--;for(;1<=i&&0<=o;i--,o--)if(s[i]!==a[o]){if(i!==1||o!==1)do if(i--,o--,0>o||s[i]!==a[o]){var l=`
`+s[i].replace(" at new "," at ");return e.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",e.displayName)),l}while(1<=i&&0<=o);break}}}finally{v0=!1,Error.prepareStackTrace=r}return(e=e?e.displayName||e.name:"")?Jl(e):""}function MN(e){switch(e.tag){case 5:return Jl(e.type);case 16:return Jl("Lazy");case 13:return Jl("Suspense");case 19:return Jl("SuspenseList");case 0:case 2:case 15:return e=y0(e.type,!1),e;case 11:return e=y0(e.type.render,!1),e;case 1:return e=y0(e.type,!0),e;default:return""}}function ym(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case Co:return"Fragment";case No:return"Portal";case gm:return"Profiler";case ng:return"StrictMode";case xm:return"Suspense";case vm:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case TE:return(e.displayName||"Context")+".Consumer";case EE:return(e._context.displayName||"Context")+".Provider";case sg:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case ag:return t=e.displayName||null,t!==null?t:ym(e.type)||"Memo";case Da:t=e._payload,e=e._init;try{return ym(e(t))}catch{}}return null}function LN(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return ym(t);case 8:return t===ng?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function ii(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function SE(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function jN(e){var t=SE(e)?"checked":"value",r=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),n=""+e[t];if(!e.hasOwnProperty(t)&&typeof r<"u"&&typeof r.get=="function"&&typeof r.set=="function"){var s=r.get,a=r.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return s.call(this)},set:function(i){n=""+i,a.call(this,i)}}),Object.defineProperty(e,t,{enumerable:r.enumerable}),{getValue:function(){return n},setValue:function(i){n=""+i},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function hf(e){e._valueTracker||(e._valueTracker=jN(e))}function AE(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var r=t.getValue(),n="";return e&&(n=SE(e)?e.checked?"true":"false":e.value),e=n,e!==r?(t.setValue(e),!0):!1}function hh(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function _m(e,t){var r=t.checked;return jt({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:r??e._wrapperState.initialChecked})}function i1(e,t){var r=t.defaultValue==null?"":t.defaultValue,n=t.checked!=null?t.checked:t.defaultChecked;r=ii(t.value!=null?t.value:r),e._wrapperState={initialChecked:n,initialValue:r,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function IE(e,t){t=t.checked,t!=null&&rg(e,"checked",t,!1)}function wm(e,t){IE(e,t);var r=ii(t.value),n=t.type;if(r!=null)n==="number"?(r===0&&e.value===""||e.value!=r)&&(e.value=""+r):e.value!==""+r&&(e.value=""+r);else if(n==="submit"||n==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?Em(e,t.type,r):t.hasOwnProperty("defaultValue")&&Em(e,t.type,ii(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function o1(e,t,r){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var n=t.type;if(!(n!=="submit"&&n!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,r||t===e.value||(e.value=t),e.defaultValue=t}r=e.name,r!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,r!==""&&(e.name=r)}function Em(e,t,r){(t!=="number"||hh(e.ownerDocument)!==e)&&(r==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+r&&(e.defaultValue=""+r))}var Zl=Array.isArray;function Bo(e,t,r,n){if(e=e.options,t){t={};for(var s=0;s<r.length;s++)t["$"+r[s]]=!0;for(r=0;r<e.length;r++)s=t.hasOwnProperty("$"+e[r].value),e[r].selected!==s&&(e[r].selected=s),s&&n&&(e[r].defaultSelected=!0)}else{for(r=""+ii(r),t=null,s=0;s<e.length;s++){if(e[s].value===r){e[s].selected=!0,n&&(e[s].defaultSelected=!0);return}t!==null||e[s].disabled||(t=e[s])}t!==null&&(t.selected=!0)}}function Tm(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(we(91));return jt({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function l1(e,t){var r=t.value;if(r==null){if(r=t.children,t=t.defaultValue,r!=null){if(t!=null)throw Error(we(92));if(Zl(r)){if(1<r.length)throw Error(we(93));r=r[0]}t=r}t==null&&(t=""),r=t}e._wrapperState={initialValue:ii(r)}}function NE(e,t){var r=ii(t.value),n=ii(t.defaultValue);r!=null&&(r=""+r,r!==e.value&&(e.value=r),t.defaultValue==null&&e.defaultValue!==r&&(e.defaultValue=r)),n!=null&&(e.defaultValue=""+n)}function c1(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function CE(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function km(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?CE(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var df,bE=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,r,n,s){MSApp.execUnsafeLocalFunction(function(){return e(t,r,n,s)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(df=df||document.createElement("div"),df.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=df.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function Mc(e,t){if(t){var r=e.firstChild;if(r&&r===e.lastChild&&r.nodeType===3){r.nodeValue=t;return}}e.textContent=t}var fc={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},UN=["Webkit","ms","Moz","O"];Object.keys(fc).forEach(function(e){UN.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),fc[t]=fc[e]})});function RE(e,t,r){return t==null||typeof t=="boolean"||t===""?"":r||typeof t!="number"||t===0||fc.hasOwnProperty(e)&&fc[e]?(""+t).trim():t+"px"}function PE(e,t){e=e.style;for(var r in t)if(t.hasOwnProperty(r)){var n=r.indexOf("--")===0,s=RE(r,t[r],n);r==="float"&&(r="cssFloat"),n?e.setProperty(r,s):e[r]=s}}var VN=jt({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Sm(e,t){if(t){if(VN[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(we(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(we(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(we(61))}if(t.style!=null&&typeof t.style!="object")throw Error(we(62))}}function Am(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Im=null;function ig(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var Nm=null,Wo=null,zo=null;function u1(e){if(e=ku(e)){if(typeof Nm!="function")throw Error(we(280));var t=e.stateNode;t&&(t=Ed(t),Nm(e.stateNode,e.type,t))}}function DE(e){Wo?zo?zo.push(e):zo=[e]:Wo=e}function FE(){if(Wo){var e=Wo,t=zo;if(zo=Wo=null,u1(e),t)for(e=0;e<t.length;e++)u1(t[e])}}function OE(e,t){return e(t)}function ME(){}var _0=!1;function LE(e,t,r){if(_0)return e(t,r);_0=!0;try{return OE(e,t,r)}finally{_0=!1,(Wo!==null||zo!==null)&&(ME(),FE())}}function Lc(e,t){var r=e.stateNode;if(r===null)return null;var n=Ed(r);if(n===null)return null;r=n[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(e=e.type,n=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!n;break e;default:e=!1}if(e)return null;if(r&&typeof r!="function")throw Error(we(231,t,typeof r));return r}var Cm=!1;if(ua)try{var Bl={};Object.defineProperty(Bl,"passive",{get:function(){Cm=!0}}),window.addEventListener("test",Bl,Bl),window.removeEventListener("test",Bl,Bl)}catch{Cm=!1}function BN(e,t,r,n,s,a,i,o,l){var c=Array.prototype.slice.call(arguments,3);try{t.apply(r,c)}catch(f){this.onError(f)}}var hc=!1,dh=null,mh=!1,bm=null,WN={onError:function(e){hc=!0,dh=e}};function zN(e,t,r,n,s,a,i,o,l){hc=!1,dh=null,BN.apply(WN,arguments)}function $N(e,t,r,n,s,a,i,o,l){if(zN.apply(this,arguments),hc){if(hc){var c=dh;hc=!1,dh=null}else throw Error(we(198));mh||(mh=!0,bm=c)}}function no(e){var t=e,r=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(r=t.return),e=t.return;while(e)}return t.tag===3?r:null}function jE(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function f1(e){if(no(e)!==e)throw Error(we(188))}function HN(e){var t=e.alternate;if(!t){if(t=no(e),t===null)throw Error(we(188));return t!==e?null:e}for(var r=e,n=t;;){var s=r.return;if(s===null)break;var a=s.alternate;if(a===null){if(n=s.return,n!==null){r=n;continue}break}if(s.child===a.child){for(a=s.child;a;){if(a===r)return f1(s),e;if(a===n)return f1(s),t;a=a.sibling}throw Error(we(188))}if(r.return!==n.return)r=s,n=a;else{for(var i=!1,o=s.child;o;){if(o===r){i=!0,r=s,n=a;break}if(o===n){i=!0,n=s,r=a;break}o=o.sibling}if(!i){for(o=a.child;o;){if(o===r){i=!0,r=a,n=s;break}if(o===n){i=!0,n=a,r=s;break}o=o.sibling}if(!i)throw Error(we(189))}}if(r.alternate!==n)throw Error(we(190))}if(r.tag!==3)throw Error(we(188));return r.stateNode.current===r?e:t}function UE(e){return e=HN(e),e!==null?VE(e):null}function VE(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=VE(e);if(t!==null)return t;e=e.sibling}return null}var BE=Cn.unstable_scheduleCallback,h1=Cn.unstable_cancelCallback,GN=Cn.unstable_shouldYield,KN=Cn.unstable_requestPaint,Kt=Cn.unstable_now,qN=Cn.unstable_getCurrentPriorityLevel,og=Cn.unstable_ImmediatePriority,WE=Cn.unstable_UserBlockingPriority,ph=Cn.unstable_NormalPriority,YN=Cn.unstable_LowPriority,zE=Cn.unstable_IdlePriority,vd=null,As=null;function XN(e){if(As&&typeof As.onCommitFiberRoot=="function")try{As.onCommitFiberRoot(vd,e,void 0,(e.current.flags&128)===128)}catch{}}var fs=Math.clz32?Math.clz32:ZN,QN=Math.log,JN=Math.LN2;function ZN(e){return e>>>=0,e===0?32:31-(QN(e)/JN|0)|0}var mf=64,pf=4194304;function ec(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function gh(e,t){var r=e.pendingLanes;if(r===0)return 0;var n=0,s=e.suspendedLanes,a=e.pingedLanes,i=r&268435455;if(i!==0){var o=i&~s;o!==0?n=ec(o):(a&=i,a!==0&&(n=ec(a)))}else i=r&~s,i!==0?n=ec(i):a!==0&&(n=ec(a));if(n===0)return 0;if(t!==0&&t!==n&&!(t&s)&&(s=n&-n,a=t&-t,s>=a||s===16&&(a&4194240)!==0))return t;if(n&4&&(n|=r&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=n;0<t;)r=31-fs(t),s=1<<r,n|=e[r],t&=~s;return n}function eC(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function tC(e,t){for(var r=e.suspendedLanes,n=e.pingedLanes,s=e.expirationTimes,a=e.pendingLanes;0<a;){var i=31-fs(a),o=1<<i,l=s[i];l===-1?(!(o&r)||o&n)&&(s[i]=eC(o,t)):l<=t&&(e.expiredLanes|=o),a&=~o}}function Rm(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function $E(){var e=mf;return mf<<=1,!(mf&4194240)&&(mf=64),e}function w0(e){for(var t=[],r=0;31>r;r++)t.push(e);return t}function Eu(e,t,r){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-fs(t),e[t]=r}function rC(e,t){var r=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var n=e.eventTimes;for(e=e.expirationTimes;0<r;){var s=31-fs(r),a=1<<s;t[s]=0,n[s]=-1,e[s]=-1,r&=~a}}function lg(e,t){var r=e.entangledLanes|=t;for(e=e.entanglements;r;){var n=31-fs(r),s=1<<n;s&t|e[n]&t&&(e[n]|=t),r&=~s}}var gt=0;function HE(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var GE,cg,KE,qE,YE,Pm=!1,gf=[],Ka=null,qa=null,Ya=null,jc=new Map,Uc=new Map,Oa=[],nC="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function d1(e,t){switch(e){case"focusin":case"focusout":Ka=null;break;case"dragenter":case"dragleave":qa=null;break;case"mouseover":case"mouseout":Ya=null;break;case"pointerover":case"pointerout":jc.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Uc.delete(t.pointerId)}}function Wl(e,t,r,n,s,a){return e===null||e.nativeEvent!==a?(e={blockedOn:t,domEventName:r,eventSystemFlags:n,nativeEvent:a,targetContainers:[s]},t!==null&&(t=ku(t),t!==null&&cg(t)),e):(e.eventSystemFlags|=n,t=e.targetContainers,s!==null&&t.indexOf(s)===-1&&t.push(s),e)}function sC(e,t,r,n,s){switch(t){case"focusin":return Ka=Wl(Ka,e,t,r,n,s),!0;case"dragenter":return qa=Wl(qa,e,t,r,n,s),!0;case"mouseover":return Ya=Wl(Ya,e,t,r,n,s),!0;case"pointerover":var a=s.pointerId;return jc.set(a,Wl(jc.get(a)||null,e,t,r,n,s)),!0;case"gotpointercapture":return a=s.pointerId,Uc.set(a,Wl(Uc.get(a)||null,e,t,r,n,s)),!0}return!1}function XE(e){var t=Ci(e.target);if(t!==null){var r=no(t);if(r!==null){if(t=r.tag,t===13){if(t=jE(r),t!==null){e.blockedOn=t,YE(e.priority,function(){KE(r)});return}}else if(t===3&&r.stateNode.current.memoizedState.isDehydrated){e.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}e.blockedOn=null}function Hf(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var r=Dm(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(r===null){r=e.nativeEvent;var n=new r.constructor(r.type,r);Im=n,r.target.dispatchEvent(n),Im=null}else return t=ku(r),t!==null&&cg(t),e.blockedOn=r,!1;t.shift()}return!0}function m1(e,t,r){Hf(e)&&r.delete(t)}function aC(){Pm=!1,Ka!==null&&Hf(Ka)&&(Ka=null),qa!==null&&Hf(qa)&&(qa=null),Ya!==null&&Hf(Ya)&&(Ya=null),jc.forEach(m1),Uc.forEach(m1)}function zl(e,t){e.blockedOn===t&&(e.blockedOn=null,Pm||(Pm=!0,Cn.unstable_scheduleCallback(Cn.unstable_NormalPriority,aC)))}function Vc(e){function t(s){return zl(s,e)}if(0<gf.length){zl(gf[0],e);for(var r=1;r<gf.length;r++){var n=gf[r];n.blockedOn===e&&(n.blockedOn=null)}}for(Ka!==null&&zl(Ka,e),qa!==null&&zl(qa,e),Ya!==null&&zl(Ya,e),jc.forEach(t),Uc.forEach(t),r=0;r<Oa.length;r++)n=Oa[r],n.blockedOn===e&&(n.blockedOn=null);for(;0<Oa.length&&(r=Oa[0],r.blockedOn===null);)XE(r),r.blockedOn===null&&Oa.shift()}var $o=Ea.ReactCurrentBatchConfig,xh=!0;function iC(e,t,r,n){var s=gt,a=$o.transition;$o.transition=null;try{gt=1,ug(e,t,r,n)}finally{gt=s,$o.transition=a}}function oC(e,t,r,n){var s=gt,a=$o.transition;$o.transition=null;try{gt=4,ug(e,t,r,n)}finally{gt=s,$o.transition=a}}function ug(e,t,r,n){if(xh){var s=Dm(e,t,r,n);if(s===null)R0(e,t,n,vh,r),d1(e,n);else if(sC(s,e,t,r,n))n.stopPropagation();else if(d1(e,n),t&4&&-1<nC.indexOf(e)){for(;s!==null;){var a=ku(s);if(a!==null&&GE(a),a=Dm(e,t,r,n),a===null&&R0(e,t,n,vh,r),a===s)break;s=a}s!==null&&n.stopPropagation()}else R0(e,t,n,null,r)}}var vh=null;function Dm(e,t,r,n){if(vh=null,e=ig(n),e=Ci(e),e!==null)if(t=no(e),t===null)e=null;else if(r=t.tag,r===13){if(e=jE(t),e!==null)return e;e=null}else if(r===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return vh=e,null}function QE(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(qN()){case og:return 1;case WE:return 4;case ph:case YN:return 16;case zE:return 536870912;default:return 16}default:return 16}}var Ba=null,fg=null,Gf=null;function JE(){if(Gf)return Gf;var e,t=fg,r=t.length,n,s="value"in Ba?Ba.value:Ba.textContent,a=s.length;for(e=0;e<r&&t[e]===s[e];e++);var i=r-e;for(n=1;n<=i&&t[r-n]===s[a-n];n++);return Gf=s.slice(e,1<n?1-n:void 0)}function Kf(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function xf(){return!0}function p1(){return!1}function Pn(e){function t(r,n,s,a,i){this._reactName=r,this._targetInst=s,this.type=n,this.nativeEvent=a,this.target=i,this.currentTarget=null;for(var o in e)e.hasOwnProperty(o)&&(r=e[o],this[o]=r?r(a):a[o]);return this.isDefaultPrevented=(a.defaultPrevented!=null?a.defaultPrevented:a.returnValue===!1)?xf:p1,this.isPropagationStopped=p1,this}return jt(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=xf)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=xf)},persist:function(){},isPersistent:xf}),t}var wl={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},hg=Pn(wl),Tu=jt({},wl,{view:0,detail:0}),lC=Pn(Tu),E0,T0,$l,yd=jt({},Tu,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:dg,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==$l&&($l&&e.type==="mousemove"?(E0=e.screenX-$l.screenX,T0=e.screenY-$l.screenY):T0=E0=0,$l=e),E0)},movementY:function(e){return"movementY"in e?e.movementY:T0}}),g1=Pn(yd),cC=jt({},yd,{dataTransfer:0}),uC=Pn(cC),fC=jt({},Tu,{relatedTarget:0}),k0=Pn(fC),hC=jt({},wl,{animationName:0,elapsedTime:0,pseudoElement:0}),dC=Pn(hC),mC=jt({},wl,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),pC=Pn(mC),gC=jt({},wl,{data:0}),x1=Pn(gC),xC={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},vC={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},yC={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function _C(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=yC[e])?!!t[e]:!1}function dg(){return _C}var wC=jt({},Tu,{key:function(e){if(e.key){var t=xC[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=Kf(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?vC[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:dg,charCode:function(e){return e.type==="keypress"?Kf(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?Kf(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),EC=Pn(wC),TC=jt({},yd,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),v1=Pn(TC),kC=jt({},Tu,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:dg}),SC=Pn(kC),AC=jt({},wl,{propertyName:0,elapsedTime:0,pseudoElement:0}),IC=Pn(AC),NC=jt({},yd,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),CC=Pn(NC),bC=[9,13,27,32],mg=ua&&"CompositionEvent"in window,dc=null;ua&&"documentMode"in document&&(dc=document.documentMode);var RC=ua&&"TextEvent"in window&&!dc,ZE=ua&&(!mg||dc&&8<dc&&11>=dc),y1=" ",_1=!1;function e2(e,t){switch(e){case"keyup":return bC.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function t2(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var bo=!1;function PC(e,t){switch(e){case"compositionend":return t2(t);case"keypress":return t.which!==32?null:(_1=!0,y1);case"textInput":return e=t.data,e===y1&&_1?null:e;default:return null}}function DC(e,t){if(bo)return e==="compositionend"||!mg&&e2(e,t)?(e=JE(),Gf=fg=Ba=null,bo=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return ZE&&t.locale!=="ko"?null:t.data;default:return null}}var FC={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function w1(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!FC[e.type]:t==="textarea"}function r2(e,t,r,n){DE(n),t=yh(t,"onChange"),0<t.length&&(r=new hg("onChange","change",null,r,n),e.push({event:r,listeners:t}))}var mc=null,Bc=null;function OC(e){d2(e,0)}function _d(e){var t=Do(e);if(AE(t))return e}function MC(e,t){if(e==="change")return t}var n2=!1;if(ua){var S0;if(ua){var A0="oninput"in document;if(!A0){var E1=document.createElement("div");E1.setAttribute("oninput","return;"),A0=typeof E1.oninput=="function"}S0=A0}else S0=!1;n2=S0&&(!document.documentMode||9<document.documentMode)}function T1(){mc&&(mc.detachEvent("onpropertychange",s2),Bc=mc=null)}function s2(e){if(e.propertyName==="value"&&_d(Bc)){var t=[];r2(t,Bc,e,ig(e)),LE(OC,t)}}function LC(e,t,r){e==="focusin"?(T1(),mc=t,Bc=r,mc.attachEvent("onpropertychange",s2)):e==="focusout"&&T1()}function jC(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return _d(Bc)}function UC(e,t){if(e==="click")return _d(t)}function VC(e,t){if(e==="input"||e==="change")return _d(t)}function BC(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var ps=typeof Object.is=="function"?Object.is:BC;function Wc(e,t){if(ps(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var r=Object.keys(e),n=Object.keys(t);if(r.length!==n.length)return!1;for(n=0;n<r.length;n++){var s=r[n];if(!pm.call(t,s)||!ps(e[s],t[s]))return!1}return!0}function k1(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function S1(e,t){var r=k1(e);e=0;for(var n;r;){if(r.nodeType===3){if(n=e+r.textContent.length,e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=k1(r)}}function a2(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?a2(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function i2(){for(var e=window,t=hh();t instanceof e.HTMLIFrameElement;){try{var r=typeof t.contentWindow.location.href=="string"}catch{r=!1}if(r)e=t.contentWindow;else break;t=hh(e.document)}return t}function pg(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function WC(e){var t=i2(),r=e.focusedElem,n=e.selectionRange;if(t!==r&&r&&r.ownerDocument&&a2(r.ownerDocument.documentElement,r)){if(n!==null&&pg(r)){if(t=n.start,e=n.end,e===void 0&&(e=t),"selectionStart"in r)r.selectionStart=t,r.selectionEnd=Math.min(e,r.value.length);else if(e=(t=r.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var s=r.textContent.length,a=Math.min(n.start,s);n=n.end===void 0?a:Math.min(n.end,s),!e.extend&&a>n&&(s=n,n=a,a=s),s=S1(r,a);var i=S1(r,n);s&&i&&(e.rangeCount!==1||e.anchorNode!==s.node||e.anchorOffset!==s.offset||e.focusNode!==i.node||e.focusOffset!==i.offset)&&(t=t.createRange(),t.setStart(s.node,s.offset),e.removeAllRanges(),a>n?(e.addRange(t),e.extend(i.node,i.offset)):(t.setEnd(i.node,i.offset),e.addRange(t)))}}for(t=[],e=r;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof r.focus=="function"&&r.focus(),r=0;r<t.length;r++)e=t[r],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var zC=ua&&"documentMode"in document&&11>=document.documentMode,Ro=null,Fm=null,pc=null,Om=!1;function A1(e,t,r){var n=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;Om||Ro==null||Ro!==hh(n)||(n=Ro,"selectionStart"in n&&pg(n)?n={start:n.selectionStart,end:n.selectionEnd}:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection(),n={anchorNode:n.anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset}),pc&&Wc(pc,n)||(pc=n,n=yh(Fm,"onSelect"),0<n.length&&(t=new hg("onSelect","select",null,t,r),e.push({event:t,listeners:n}),t.target=Ro)))}function vf(e,t){var r={};return r[e.toLowerCase()]=t.toLowerCase(),r["Webkit"+e]="webkit"+t,r["Moz"+e]="moz"+t,r}var Po={animationend:vf("Animation","AnimationEnd"),animationiteration:vf("Animation","AnimationIteration"),animationstart:vf("Animation","AnimationStart"),transitionend:vf("Transition","TransitionEnd")},I0={},o2={};ua&&(o2=document.createElement("div").style,"AnimationEvent"in window||(delete Po.animationend.animation,delete Po.animationiteration.animation,delete Po.animationstart.animation),"TransitionEvent"in window||delete Po.transitionend.transition);function wd(e){if(I0[e])return I0[e];if(!Po[e])return e;var t=Po[e],r;for(r in t)if(t.hasOwnProperty(r)&&r in o2)return I0[e]=t[r];return e}var l2=wd("animationend"),c2=wd("animationiteration"),u2=wd("animationstart"),f2=wd("transitionend"),h2=new Map,I1="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function pi(e,t){h2.set(e,t),ro(t,[e])}for(var N0=0;N0<I1.length;N0++){var C0=I1[N0],$C=C0.toLowerCase(),HC=C0[0].toUpperCase()+C0.slice(1);pi($C,"on"+HC)}pi(l2,"onAnimationEnd");pi(c2,"onAnimationIteration");pi(u2,"onAnimationStart");pi("dblclick","onDoubleClick");pi("focusin","onFocus");pi("focusout","onBlur");pi(f2,"onTransitionEnd");tl("onMouseEnter",["mouseout","mouseover"]);tl("onMouseLeave",["mouseout","mouseover"]);tl("onPointerEnter",["pointerout","pointerover"]);tl("onPointerLeave",["pointerout","pointerover"]);ro("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));ro("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));ro("onBeforeInput",["compositionend","keypress","textInput","paste"]);ro("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));ro("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));ro("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var tc="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),GC=new Set("cancel close invalid load scroll toggle".split(" ").concat(tc));function N1(e,t,r){var n=e.type||"unknown-event";e.currentTarget=r,$N(n,t,void 0,e),e.currentTarget=null}function d2(e,t){t=(t&4)!==0;for(var r=0;r<e.length;r++){var n=e[r],s=n.event;n=n.listeners;e:{var a=void 0;if(t)for(var i=n.length-1;0<=i;i--){var o=n[i],l=o.instance,c=o.currentTarget;if(o=o.listener,l!==a&&s.isPropagationStopped())break e;N1(s,o,c),a=l}else for(i=0;i<n.length;i++){if(o=n[i],l=o.instance,c=o.currentTarget,o=o.listener,l!==a&&s.isPropagationStopped())break e;N1(s,o,c),a=l}}}if(mh)throw e=bm,mh=!1,bm=null,e}function It(e,t){var r=t[Vm];r===void 0&&(r=t[Vm]=new Set);var n=e+"__bubble";r.has(n)||(m2(t,e,2,!1),r.add(n))}function b0(e,t,r){var n=0;t&&(n|=4),m2(r,e,n,t)}var yf="_reactListening"+Math.random().toString(36).slice(2);function zc(e){if(!e[yf]){e[yf]=!0,wE.forEach(function(r){r!=="selectionchange"&&(GC.has(r)||b0(r,!1,e),b0(r,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[yf]||(t[yf]=!0,b0("selectionchange",!1,t))}}function m2(e,t,r,n){switch(QE(t)){case 1:var s=iC;break;case 4:s=oC;break;default:s=ug}r=s.bind(null,t,r,e),s=void 0,!Cm||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(s=!0),n?s!==void 0?e.addEventListener(t,r,{capture:!0,passive:s}):e.addEventListener(t,r,!0):s!==void 0?e.addEventListener(t,r,{passive:s}):e.addEventListener(t,r,!1)}function R0(e,t,r,n,s){var a=n;if(!(t&1)&&!(t&2)&&n!==null)e:for(;;){if(n===null)return;var i=n.tag;if(i===3||i===4){var o=n.stateNode.containerInfo;if(o===s||o.nodeType===8&&o.parentNode===s)break;if(i===4)for(i=n.return;i!==null;){var l=i.tag;if((l===3||l===4)&&(l=i.stateNode.containerInfo,l===s||l.nodeType===8&&l.parentNode===s))return;i=i.return}for(;o!==null;){if(i=Ci(o),i===null)return;if(l=i.tag,l===5||l===6){n=a=i;continue e}o=o.parentNode}}n=n.return}LE(function(){var c=a,f=ig(r),d=[];e:{var m=h2.get(e);if(m!==void 0){var p=hg,x=e;switch(e){case"keypress":if(Kf(r)===0)break e;case"keydown":case"keyup":p=EC;break;case"focusin":x="focus",p=k0;break;case"focusout":x="blur",p=k0;break;case"beforeblur":case"afterblur":p=k0;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":p=g1;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":p=uC;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":p=SC;break;case l2:case c2:case u2:p=dC;break;case f2:p=IC;break;case"scroll":p=lC;break;case"wheel":p=CC;break;case"copy":case"cut":case"paste":p=pC;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":p=v1}var g=(t&4)!==0,w=!g&&e==="scroll",k=g?m!==null?m+"Capture":null:m;g=[];for(var E=c,y;E!==null;){y=E;var I=y.stateNode;if(y.tag===5&&I!==null&&(y=I,k!==null&&(I=Lc(E,k),I!=null&&g.push($c(E,I,y)))),w)break;E=E.return}0<g.length&&(m=new p(m,x,null,r,f),d.push({event:m,listeners:g}))}}if(!(t&7)){e:{if(m=e==="mouseover"||e==="pointerover",p=e==="mouseout"||e==="pointerout",m&&r!==Im&&(x=r.relatedTarget||r.fromElement)&&(Ci(x)||x[fa]))break e;if((p||m)&&(m=f.window===f?f:(m=f.ownerDocument)?m.defaultView||m.parentWindow:window,p?(x=r.relatedTarget||r.toElement,p=c,x=x?Ci(x):null,x!==null&&(w=no(x),x!==w||x.tag!==5&&x.tag!==6)&&(x=null)):(p=null,x=c),p!==x)){if(g=g1,I="onMouseLeave",k="onMouseEnter",E="mouse",(e==="pointerout"||e==="pointerover")&&(g=v1,I="onPointerLeave",k="onPointerEnter",E="pointer"),w=p==null?m:Do(p),y=x==null?m:Do(x),m=new g(I,E+"leave",p,r,f),m.target=w,m.relatedTarget=y,I=null,Ci(f)===c&&(g=new g(k,E+"enter",x,r,f),g.target=y,g.relatedTarget=w,I=g),w=I,p&&x)t:{for(g=p,k=x,E=0,y=g;y;y=wo(y))E++;for(y=0,I=k;I;I=wo(I))y++;for(;0<E-y;)g=wo(g),E--;for(;0<y-E;)k=wo(k),y--;for(;E--;){if(g===k||k!==null&&g===k.alternate)break t;g=wo(g),k=wo(k)}g=null}else g=null;p!==null&&C1(d,m,p,g,!1),x!==null&&w!==null&&C1(d,w,x,g,!0)}}e:{if(m=c?Do(c):window,p=m.nodeName&&m.nodeName.toLowerCase(),p==="select"||p==="input"&&m.type==="file")var M=MC;else if(w1(m))if(n2)M=VC;else{M=jC;var O=LC}else(p=m.nodeName)&&p.toLowerCase()==="input"&&(m.type==="checkbox"||m.type==="radio")&&(M=UC);if(M&&(M=M(e,c))){r2(d,M,r,f);break e}O&&O(e,m,c),e==="focusout"&&(O=m._wrapperState)&&O.controlled&&m.type==="number"&&Em(m,"number",m.value)}switch(O=c?Do(c):window,e){case"focusin":(w1(O)||O.contentEditable==="true")&&(Ro=O,Fm=c,pc=null);break;case"focusout":pc=Fm=Ro=null;break;case"mousedown":Om=!0;break;case"contextmenu":case"mouseup":case"dragend":Om=!1,A1(d,r,f);break;case"selectionchange":if(zC)break;case"keydown":case"keyup":A1(d,r,f)}var v;if(mg)e:{switch(e){case"compositionstart":var T="onCompositionStart";break e;case"compositionend":T="onCompositionEnd";break e;case"compositionupdate":T="onCompositionUpdate";break e}T=void 0}else bo?e2(e,r)&&(T="onCompositionEnd"):e==="keydown"&&r.keyCode===229&&(T="onCompositionStart");T&&(ZE&&r.locale!=="ko"&&(bo||T!=="onCompositionStart"?T==="onCompositionEnd"&&bo&&(v=JE()):(Ba=f,fg="value"in Ba?Ba.value:Ba.textContent,bo=!0)),O=yh(c,T),0<O.length&&(T=new x1(T,e,null,r,f),d.push({event:T,listeners:O}),v?T.data=v:(v=t2(r),v!==null&&(T.data=v)))),(v=RC?PC(e,r):DC(e,r))&&(c=yh(c,"onBeforeInput"),0<c.length&&(f=new x1("onBeforeInput","beforeinput",null,r,f),d.push({event:f,listeners:c}),f.data=v))}d2(d,t)})}function $c(e,t,r){return{instance:e,listener:t,currentTarget:r}}function yh(e,t){for(var r=t+"Capture",n=[];e!==null;){var s=e,a=s.stateNode;s.tag===5&&a!==null&&(s=a,a=Lc(e,r),a!=null&&n.unshift($c(e,a,s)),a=Lc(e,t),a!=null&&n.push($c(e,a,s))),e=e.return}return n}function wo(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function C1(e,t,r,n,s){for(var a=t._reactName,i=[];r!==null&&r!==n;){var o=r,l=o.alternate,c=o.stateNode;if(l!==null&&l===n)break;o.tag===5&&c!==null&&(o=c,s?(l=Lc(r,a),l!=null&&i.unshift($c(r,l,o))):s||(l=Lc(r,a),l!=null&&i.push($c(r,l,o)))),r=r.return}i.length!==0&&e.push({event:t,listeners:i})}var KC=/\r\n?/g,qC=/\u0000|\uFFFD/g;function b1(e){return(typeof e=="string"?e:""+e).replace(KC,`
`).replace(qC,"")}function _f(e,t,r){if(t=b1(t),b1(e)!==t&&r)throw Error(we(425))}function _h(){}var Mm=null,Lm=null;function jm(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var Um=typeof setTimeout=="function"?setTimeout:void 0,YC=typeof clearTimeout=="function"?clearTimeout:void 0,R1=typeof Promise=="function"?Promise:void 0,XC=typeof queueMicrotask=="function"?queueMicrotask:typeof R1<"u"?function(e){return R1.resolve(null).then(e).catch(QC)}:Um;function QC(e){setTimeout(function(){throw e})}function P0(e,t){var r=t,n=0;do{var s=r.nextSibling;if(e.removeChild(r),s&&s.nodeType===8)if(r=s.data,r==="/$"){if(n===0){e.removeChild(s),Vc(t);return}n--}else r!=="$"&&r!=="$?"&&r!=="$!"||n++;r=s}while(r);Vc(t)}function Xa(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function P1(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="$"||r==="$!"||r==="$?"){if(t===0)return e;t--}else r==="/$"&&t++}e=e.previousSibling}return null}var El=Math.random().toString(36).slice(2),ks="__reactFiber$"+El,Hc="__reactProps$"+El,fa="__reactContainer$"+El,Vm="__reactEvents$"+El,JC="__reactListeners$"+El,ZC="__reactHandles$"+El;function Ci(e){var t=e[ks];if(t)return t;for(var r=e.parentNode;r;){if(t=r[fa]||r[ks]){if(r=t.alternate,t.child!==null||r!==null&&r.child!==null)for(e=P1(e);e!==null;){if(r=e[ks])return r;e=P1(e)}return t}e=r,r=e.parentNode}return null}function ku(e){return e=e[ks]||e[fa],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function Do(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(we(33))}function Ed(e){return e[Hc]||null}var Bm=[],Fo=-1;function gi(e){return{current:e}}function Ct(e){0>Fo||(e.current=Bm[Fo],Bm[Fo]=null,Fo--)}function Et(e,t){Fo++,Bm[Fo]=e.current,e.current=t}var oi={},$r=gi(oi),mn=gi(!1),zi=oi;function rl(e,t){var r=e.type.contextTypes;if(!r)return oi;var n=e.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===t)return n.__reactInternalMemoizedMaskedChildContext;var s={},a;for(a in r)s[a]=t[a];return n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=s),s}function pn(e){return e=e.childContextTypes,e!=null}function wh(){Ct(mn),Ct($r)}function D1(e,t,r){if($r.current!==oi)throw Error(we(168));Et($r,t),Et(mn,r)}function p2(e,t,r){var n=e.stateNode;if(t=t.childContextTypes,typeof n.getChildContext!="function")return r;n=n.getChildContext();for(var s in n)if(!(s in t))throw Error(we(108,LN(e)||"Unknown",s));return jt({},r,n)}function Eh(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||oi,zi=$r.current,Et($r,e),Et(mn,mn.current),!0}function F1(e,t,r){var n=e.stateNode;if(!n)throw Error(we(169));r?(e=p2(e,t,zi),n.__reactInternalMemoizedMergedChildContext=e,Ct(mn),Ct($r),Et($r,e)):Ct(mn),Et(mn,r)}var Qs=null,Td=!1,D0=!1;function g2(e){Qs===null?Qs=[e]:Qs.push(e)}function eb(e){Td=!0,g2(e)}function xi(){if(!D0&&Qs!==null){D0=!0;var e=0,t=gt;try{var r=Qs;for(gt=1;e<r.length;e++){var n=r[e];do n=n(!0);while(n!==null)}Qs=null,Td=!1}catch(s){throw Qs!==null&&(Qs=Qs.slice(e+1)),BE(og,xi),s}finally{gt=t,D0=!1}}return null}var Oo=[],Mo=0,Th=null,kh=0,Vn=[],Bn=0,$i=null,Js=1,Zs="";function Ti(e,t){Oo[Mo++]=kh,Oo[Mo++]=Th,Th=e,kh=t}function x2(e,t,r){Vn[Bn++]=Js,Vn[Bn++]=Zs,Vn[Bn++]=$i,$i=e;var n=Js;e=Zs;var s=32-fs(n)-1;n&=~(1<<s),r+=1;var a=32-fs(t)+s;if(30<a){var i=s-s%5;a=(n&(1<<i)-1).toString(32),n>>=i,s-=i,Js=1<<32-fs(t)+s|r<<s|n,Zs=a+e}else Js=1<<a|r<<s|n,Zs=e}function gg(e){e.return!==null&&(Ti(e,1),x2(e,1,0))}function xg(e){for(;e===Th;)Th=Oo[--Mo],Oo[Mo]=null,kh=Oo[--Mo],Oo[Mo]=null;for(;e===$i;)$i=Vn[--Bn],Vn[Bn]=null,Zs=Vn[--Bn],Vn[Bn]=null,Js=Vn[--Bn],Vn[Bn]=null}var An=null,kn=null,Dt=!1,as=null;function v2(e,t){var r=Wn(5,null,null,0);r.elementType="DELETED",r.stateNode=t,r.return=e,t=e.deletions,t===null?(e.deletions=[r],e.flags|=16):t.push(r)}function O1(e,t){switch(e.tag){case 5:var r=e.type;return t=t.nodeType!==1||r.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,An=e,kn=Xa(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,An=e,kn=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(r=$i!==null?{id:Js,overflow:Zs}:null,e.memoizedState={dehydrated:t,treeContext:r,retryLane:1073741824},r=Wn(18,null,null,0),r.stateNode=t,r.return=e,e.child=r,An=e,kn=null,!0):!1;default:return!1}}function Wm(e){return(e.mode&1)!==0&&(e.flags&128)===0}function zm(e){if(Dt){var t=kn;if(t){var r=t;if(!O1(e,t)){if(Wm(e))throw Error(we(418));t=Xa(r.nextSibling);var n=An;t&&O1(e,t)?v2(n,r):(e.flags=e.flags&-4097|2,Dt=!1,An=e)}}else{if(Wm(e))throw Error(we(418));e.flags=e.flags&-4097|2,Dt=!1,An=e}}}function M1(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;An=e}function wf(e){if(e!==An)return!1;if(!Dt)return M1(e),Dt=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!jm(e.type,e.memoizedProps)),t&&(t=kn)){if(Wm(e))throw y2(),Error(we(418));for(;t;)v2(e,t),t=Xa(t.nextSibling)}if(M1(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(we(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="/$"){if(t===0){kn=Xa(e.nextSibling);break e}t--}else r!=="$"&&r!=="$!"&&r!=="$?"||t++}e=e.nextSibling}kn=null}}else kn=An?Xa(e.stateNode.nextSibling):null;return!0}function y2(){for(var e=kn;e;)e=Xa(e.nextSibling)}function nl(){kn=An=null,Dt=!1}function vg(e){as===null?as=[e]:as.push(e)}var tb=Ea.ReactCurrentBatchConfig;function Hl(e,t,r){if(e=r.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(r._owner){if(r=r._owner,r){if(r.tag!==1)throw Error(we(309));var n=r.stateNode}if(!n)throw Error(we(147,e));var s=n,a=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===a?t.ref:(t=function(i){var o=s.refs;i===null?delete o[a]:o[a]=i},t._stringRef=a,t)}if(typeof e!="string")throw Error(we(284));if(!r._owner)throw Error(we(290,e))}return e}function Ef(e,t){throw e=Object.prototype.toString.call(t),Error(we(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function L1(e){var t=e._init;return t(e._payload)}function _2(e){function t(k,E){if(e){var y=k.deletions;y===null?(k.deletions=[E],k.flags|=16):y.push(E)}}function r(k,E){if(!e)return null;for(;E!==null;)t(k,E),E=E.sibling;return null}function n(k,E){for(k=new Map;E!==null;)E.key!==null?k.set(E.key,E):k.set(E.index,E),E=E.sibling;return k}function s(k,E){return k=ei(k,E),k.index=0,k.sibling=null,k}function a(k,E,y){return k.index=y,e?(y=k.alternate,y!==null?(y=y.index,y<E?(k.flags|=2,E):y):(k.flags|=2,E)):(k.flags|=1048576,E)}function i(k){return e&&k.alternate===null&&(k.flags|=2),k}function o(k,E,y,I){return E===null||E.tag!==6?(E=V0(y,k.mode,I),E.return=k,E):(E=s(E,y),E.return=k,E)}function l(k,E,y,I){var M=y.type;return M===Co?f(k,E,y.props.children,I,y.key):E!==null&&(E.elementType===M||typeof M=="object"&&M!==null&&M.$$typeof===Da&&L1(M)===E.type)?(I=s(E,y.props),I.ref=Hl(k,E,y),I.return=k,I):(I=eh(y.type,y.key,y.props,null,k.mode,I),I.ref=Hl(k,E,y),I.return=k,I)}function c(k,E,y,I){return E===null||E.tag!==4||E.stateNode.containerInfo!==y.containerInfo||E.stateNode.implementation!==y.implementation?(E=B0(y,k.mode,I),E.return=k,E):(E=s(E,y.children||[]),E.return=k,E)}function f(k,E,y,I,M){return E===null||E.tag!==7?(E=Li(y,k.mode,I,M),E.return=k,E):(E=s(E,y),E.return=k,E)}function d(k,E,y){if(typeof E=="string"&&E!==""||typeof E=="number")return E=V0(""+E,k.mode,y),E.return=k,E;if(typeof E=="object"&&E!==null){switch(E.$$typeof){case ff:return y=eh(E.type,E.key,E.props,null,k.mode,y),y.ref=Hl(k,null,E),y.return=k,y;case No:return E=B0(E,k.mode,y),E.return=k,E;case Da:var I=E._init;return d(k,I(E._payload),y)}if(Zl(E)||Vl(E))return E=Li(E,k.mode,y,null),E.return=k,E;Ef(k,E)}return null}function m(k,E,y,I){var M=E!==null?E.key:null;if(typeof y=="string"&&y!==""||typeof y=="number")return M!==null?null:o(k,E,""+y,I);if(typeof y=="object"&&y!==null){switch(y.$$typeof){case ff:return y.key===M?l(k,E,y,I):null;case No:return y.key===M?c(k,E,y,I):null;case Da:return M=y._init,m(k,E,M(y._payload),I)}if(Zl(y)||Vl(y))return M!==null?null:f(k,E,y,I,null);Ef(k,y)}return null}function p(k,E,y,I,M){if(typeof I=="string"&&I!==""||typeof I=="number")return k=k.get(y)||null,o(E,k,""+I,M);if(typeof I=="object"&&I!==null){switch(I.$$typeof){case ff:return k=k.get(I.key===null?y:I.key)||null,l(E,k,I,M);case No:return k=k.get(I.key===null?y:I.key)||null,c(E,k,I,M);case Da:var O=I._init;return p(k,E,y,O(I._payload),M)}if(Zl(I)||Vl(I))return k=k.get(y)||null,f(E,k,I,M,null);Ef(E,I)}return null}function x(k,E,y,I){for(var M=null,O=null,v=E,T=E=0,S=null;v!==null&&T<y.length;T++){v.index>T?(S=v,v=null):S=v.sibling;var C=m(k,v,y[T],I);if(C===null){v===null&&(v=S);break}e&&v&&C.alternate===null&&t(k,v),E=a(C,E,T),O===null?M=C:O.sibling=C,O=C,v=S}if(T===y.length)return r(k,v),Dt&&Ti(k,T),M;if(v===null){for(;T<y.length;T++)v=d(k,y[T],I),v!==null&&(E=a(v,E,T),O===null?M=v:O.sibling=v,O=v);return Dt&&Ti(k,T),M}for(v=n(k,v);T<y.length;T++)S=p(v,k,T,y[T],I),S!==null&&(e&&S.alternate!==null&&v.delete(S.key===null?T:S.key),E=a(S,E,T),O===null?M=S:O.sibling=S,O=S);return e&&v.forEach(function(b){return t(k,b)}),Dt&&Ti(k,T),M}function g(k,E,y,I){var M=Vl(y);if(typeof M!="function")throw Error(we(150));if(y=M.call(y),y==null)throw Error(we(151));for(var O=M=null,v=E,T=E=0,S=null,C=y.next();v!==null&&!C.done;T++,C=y.next()){v.index>T?(S=v,v=null):S=v.sibling;var b=m(k,v,C.value,I);if(b===null){v===null&&(v=S);break}e&&v&&b.alternate===null&&t(k,v),E=a(b,E,T),O===null?M=b:O.sibling=b,O=b,v=S}if(C.done)return r(k,v),Dt&&Ti(k,T),M;if(v===null){for(;!C.done;T++,C=y.next())C=d(k,C.value,I),C!==null&&(E=a(C,E,T),O===null?M=C:O.sibling=C,O=C);return Dt&&Ti(k,T),M}for(v=n(k,v);!C.done;T++,C=y.next())C=p(v,k,T,C.value,I),C!==null&&(e&&C.alternate!==null&&v.delete(C.key===null?T:C.key),E=a(C,E,T),O===null?M=C:O.sibling=C,O=C);return e&&v.forEach(function(P){return t(k,P)}),Dt&&Ti(k,T),M}function w(k,E,y,I){if(typeof y=="object"&&y!==null&&y.type===Co&&y.key===null&&(y=y.props.children),typeof y=="object"&&y!==null){switch(y.$$typeof){case ff:e:{for(var M=y.key,O=E;O!==null;){if(O.key===M){if(M=y.type,M===Co){if(O.tag===7){r(k,O.sibling),E=s(O,y.props.children),E.return=k,k=E;break e}}else if(O.elementType===M||typeof M=="object"&&M!==null&&M.$$typeof===Da&&L1(M)===O.type){r(k,O.sibling),E=s(O,y.props),E.ref=Hl(k,O,y),E.return=k,k=E;break e}r(k,O);break}else t(k,O);O=O.sibling}y.type===Co?(E=Li(y.props.children,k.mode,I,y.key),E.return=k,k=E):(I=eh(y.type,y.key,y.props,null,k.mode,I),I.ref=Hl(k,E,y),I.return=k,k=I)}return i(k);case No:e:{for(O=y.key;E!==null;){if(E.key===O)if(E.tag===4&&E.stateNode.containerInfo===y.containerInfo&&E.stateNode.implementation===y.implementation){r(k,E.sibling),E=s(E,y.children||[]),E.return=k,k=E;break e}else{r(k,E);break}else t(k,E);E=E.sibling}E=B0(y,k.mode,I),E.return=k,k=E}return i(k);case Da:return O=y._init,w(k,E,O(y._payload),I)}if(Zl(y))return x(k,E,y,I);if(Vl(y))return g(k,E,y,I);Ef(k,y)}return typeof y=="string"&&y!==""||typeof y=="number"?(y=""+y,E!==null&&E.tag===6?(r(k,E.sibling),E=s(E,y),E.return=k,k=E):(r(k,E),E=V0(y,k.mode,I),E.return=k,k=E),i(k)):r(k,E)}return w}var sl=_2(!0),w2=_2(!1),Sh=gi(null),Ah=null,Lo=null,yg=null;function _g(){yg=Lo=Ah=null}function wg(e){var t=Sh.current;Ct(Sh),e._currentValue=t}function $m(e,t,r){for(;e!==null;){var n=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,n!==null&&(n.childLanes|=t)):n!==null&&(n.childLanes&t)!==t&&(n.childLanes|=t),e===r)break;e=e.return}}function Ho(e,t){Ah=e,yg=Lo=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(hn=!0),e.firstContext=null)}function Gn(e){var t=e._currentValue;if(yg!==e)if(e={context:e,memoizedValue:t,next:null},Lo===null){if(Ah===null)throw Error(we(308));Lo=e,Ah.dependencies={lanes:0,firstContext:e}}else Lo=Lo.next=e;return t}var bi=null;function Eg(e){bi===null?bi=[e]:bi.push(e)}function E2(e,t,r,n){var s=t.interleaved;return s===null?(r.next=r,Eg(t)):(r.next=s.next,s.next=r),t.interleaved=r,ha(e,n)}function ha(e,t){e.lanes|=t;var r=e.alternate;for(r!==null&&(r.lanes|=t),r=e,e=e.return;e!==null;)e.childLanes|=t,r=e.alternate,r!==null&&(r.childLanes|=t),r=e,e=e.return;return r.tag===3?r.stateNode:null}var Fa=!1;function Tg(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function T2(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function aa(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function Qa(e,t,r){var n=e.updateQueue;if(n===null)return null;if(n=n.shared,ot&2){var s=n.pending;return s===null?t.next=t:(t.next=s.next,s.next=t),n.pending=t,ha(e,r)}return s=n.interleaved,s===null?(t.next=t,Eg(n)):(t.next=s.next,s.next=t),n.interleaved=t,ha(e,r)}function qf(e,t,r){if(t=t.updateQueue,t!==null&&(t=t.shared,(r&4194240)!==0)){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,lg(e,r)}}function j1(e,t){var r=e.updateQueue,n=e.alternate;if(n!==null&&(n=n.updateQueue,r===n)){var s=null,a=null;if(r=r.firstBaseUpdate,r!==null){do{var i={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};a===null?s=a=i:a=a.next=i,r=r.next}while(r!==null);a===null?s=a=t:a=a.next=t}else s=a=t;r={baseState:n.baseState,firstBaseUpdate:s,lastBaseUpdate:a,shared:n.shared,effects:n.effects},e.updateQueue=r;return}e=r.lastBaseUpdate,e===null?r.firstBaseUpdate=t:e.next=t,r.lastBaseUpdate=t}function Ih(e,t,r,n){var s=e.updateQueue;Fa=!1;var a=s.firstBaseUpdate,i=s.lastBaseUpdate,o=s.shared.pending;if(o!==null){s.shared.pending=null;var l=o,c=l.next;l.next=null,i===null?a=c:i.next=c,i=l;var f=e.alternate;f!==null&&(f=f.updateQueue,o=f.lastBaseUpdate,o!==i&&(o===null?f.firstBaseUpdate=c:o.next=c,f.lastBaseUpdate=l))}if(a!==null){var d=s.baseState;i=0,f=c=l=null,o=a;do{var m=o.lane,p=o.eventTime;if((n&m)===m){f!==null&&(f=f.next={eventTime:p,lane:0,tag:o.tag,payload:o.payload,callback:o.callback,next:null});e:{var x=e,g=o;switch(m=t,p=r,g.tag){case 1:if(x=g.payload,typeof x=="function"){d=x.call(p,d,m);break e}d=x;break e;case 3:x.flags=x.flags&-65537|128;case 0:if(x=g.payload,m=typeof x=="function"?x.call(p,d,m):x,m==null)break e;d=jt({},d,m);break e;case 2:Fa=!0}}o.callback!==null&&o.lane!==0&&(e.flags|=64,m=s.effects,m===null?s.effects=[o]:m.push(o))}else p={eventTime:p,lane:m,tag:o.tag,payload:o.payload,callback:o.callback,next:null},f===null?(c=f=p,l=d):f=f.next=p,i|=m;if(o=o.next,o===null){if(o=s.shared.pending,o===null)break;m=o,o=m.next,m.next=null,s.lastBaseUpdate=m,s.shared.pending=null}}while(!0);if(f===null&&(l=d),s.baseState=l,s.firstBaseUpdate=c,s.lastBaseUpdate=f,t=s.shared.interleaved,t!==null){s=t;do i|=s.lane,s=s.next;while(s!==t)}else a===null&&(s.shared.lanes=0);Gi|=i,e.lanes=i,e.memoizedState=d}}function U1(e,t,r){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var n=e[t],s=n.callback;if(s!==null){if(n.callback=null,n=r,typeof s!="function")throw Error(we(191,s));s.call(n)}}}var Su={},Is=gi(Su),Gc=gi(Su),Kc=gi(Su);function Ri(e){if(e===Su)throw Error(we(174));return e}function kg(e,t){switch(Et(Kc,t),Et(Gc,e),Et(Is,Su),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:km(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=km(t,e)}Ct(Is),Et(Is,t)}function al(){Ct(Is),Ct(Gc),Ct(Kc)}function k2(e){Ri(Kc.current);var t=Ri(Is.current),r=km(t,e.type);t!==r&&(Et(Gc,e),Et(Is,r))}function Sg(e){Gc.current===e&&(Ct(Is),Ct(Gc))}var Mt=gi(0);function Nh(e){for(var t=e;t!==null;){if(t.tag===13){var r=t.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||r.data==="$?"||r.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var F0=[];function Ag(){for(var e=0;e<F0.length;e++)F0[e]._workInProgressVersionPrimary=null;F0.length=0}var Yf=Ea.ReactCurrentDispatcher,O0=Ea.ReactCurrentBatchConfig,Hi=0,Lt=null,ar=null,mr=null,Ch=!1,gc=!1,qc=0,rb=0;function Pr(){throw Error(we(321))}function Ig(e,t){if(t===null)return!1;for(var r=0;r<t.length&&r<e.length;r++)if(!ps(e[r],t[r]))return!1;return!0}function Ng(e,t,r,n,s,a){if(Hi=a,Lt=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,Yf.current=e===null||e.memoizedState===null?ib:ob,e=r(n,s),gc){a=0;do{if(gc=!1,qc=0,25<=a)throw Error(we(301));a+=1,mr=ar=null,t.updateQueue=null,Yf.current=lb,e=r(n,s)}while(gc)}if(Yf.current=bh,t=ar!==null&&ar.next!==null,Hi=0,mr=ar=Lt=null,Ch=!1,t)throw Error(we(300));return e}function Cg(){var e=qc!==0;return qc=0,e}function Ts(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return mr===null?Lt.memoizedState=mr=e:mr=mr.next=e,mr}function Kn(){if(ar===null){var e=Lt.alternate;e=e!==null?e.memoizedState:null}else e=ar.next;var t=mr===null?Lt.memoizedState:mr.next;if(t!==null)mr=t,ar=e;else{if(e===null)throw Error(we(310));ar=e,e={memoizedState:ar.memoizedState,baseState:ar.baseState,baseQueue:ar.baseQueue,queue:ar.queue,next:null},mr===null?Lt.memoizedState=mr=e:mr=mr.next=e}return mr}function Yc(e,t){return typeof t=="function"?t(e):t}function M0(e){var t=Kn(),r=t.queue;if(r===null)throw Error(we(311));r.lastRenderedReducer=e;var n=ar,s=n.baseQueue,a=r.pending;if(a!==null){if(s!==null){var i=s.next;s.next=a.next,a.next=i}n.baseQueue=s=a,r.pending=null}if(s!==null){a=s.next,n=n.baseState;var o=i=null,l=null,c=a;do{var f=c.lane;if((Hi&f)===f)l!==null&&(l=l.next={lane:0,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null}),n=c.hasEagerState?c.eagerState:e(n,c.action);else{var d={lane:f,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null};l===null?(o=l=d,i=n):l=l.next=d,Lt.lanes|=f,Gi|=f}c=c.next}while(c!==null&&c!==a);l===null?i=n:l.next=o,ps(n,t.memoizedState)||(hn=!0),t.memoizedState=n,t.baseState=i,t.baseQueue=l,r.lastRenderedState=n}if(e=r.interleaved,e!==null){s=e;do a=s.lane,Lt.lanes|=a,Gi|=a,s=s.next;while(s!==e)}else s===null&&(r.lanes=0);return[t.memoizedState,r.dispatch]}function L0(e){var t=Kn(),r=t.queue;if(r===null)throw Error(we(311));r.lastRenderedReducer=e;var n=r.dispatch,s=r.pending,a=t.memoizedState;if(s!==null){r.pending=null;var i=s=s.next;do a=e(a,i.action),i=i.next;while(i!==s);ps(a,t.memoizedState)||(hn=!0),t.memoizedState=a,t.baseQueue===null&&(t.baseState=a),r.lastRenderedState=a}return[a,n]}function S2(){}function A2(e,t){var r=Lt,n=Kn(),s=t(),a=!ps(n.memoizedState,s);if(a&&(n.memoizedState=s,hn=!0),n=n.queue,bg(C2.bind(null,r,n,e),[e]),n.getSnapshot!==t||a||mr!==null&&mr.memoizedState.tag&1){if(r.flags|=2048,Xc(9,N2.bind(null,r,n,s,t),void 0,null),pr===null)throw Error(we(349));Hi&30||I2(r,t,s)}return s}function I2(e,t,r){e.flags|=16384,e={getSnapshot:t,value:r},t=Lt.updateQueue,t===null?(t={lastEffect:null,stores:null},Lt.updateQueue=t,t.stores=[e]):(r=t.stores,r===null?t.stores=[e]:r.push(e))}function N2(e,t,r,n){t.value=r,t.getSnapshot=n,b2(t)&&R2(e)}function C2(e,t,r){return r(function(){b2(t)&&R2(e)})}function b2(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!ps(e,r)}catch{return!0}}function R2(e){var t=ha(e,1);t!==null&&hs(t,e,1,-1)}function V1(e){var t=Ts();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Yc,lastRenderedState:e},t.queue=e,e=e.dispatch=ab.bind(null,Lt,e),[t.memoizedState,e]}function Xc(e,t,r,n){return e={tag:e,create:t,destroy:r,deps:n,next:null},t=Lt.updateQueue,t===null?(t={lastEffect:null,stores:null},Lt.updateQueue=t,t.lastEffect=e.next=e):(r=t.lastEffect,r===null?t.lastEffect=e.next=e:(n=r.next,r.next=e,e.next=n,t.lastEffect=e)),e}function P2(){return Kn().memoizedState}function Xf(e,t,r,n){var s=Ts();Lt.flags|=e,s.memoizedState=Xc(1|t,r,void 0,n===void 0?null:n)}function kd(e,t,r,n){var s=Kn();n=n===void 0?null:n;var a=void 0;if(ar!==null){var i=ar.memoizedState;if(a=i.destroy,n!==null&&Ig(n,i.deps)){s.memoizedState=Xc(t,r,a,n);return}}Lt.flags|=e,s.memoizedState=Xc(1|t,r,a,n)}function B1(e,t){return Xf(8390656,8,e,t)}function bg(e,t){return kd(2048,8,e,t)}function D2(e,t){return kd(4,2,e,t)}function F2(e,t){return kd(4,4,e,t)}function O2(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function M2(e,t,r){return r=r!=null?r.concat([e]):null,kd(4,4,O2.bind(null,t,e),r)}function Rg(){}function L2(e,t){var r=Kn();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&Ig(t,n[1])?n[0]:(r.memoizedState=[e,t],e)}function j2(e,t){var r=Kn();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&Ig(t,n[1])?n[0]:(e=e(),r.memoizedState=[e,t],e)}function U2(e,t,r){return Hi&21?(ps(r,t)||(r=$E(),Lt.lanes|=r,Gi|=r,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,hn=!0),e.memoizedState=r)}function nb(e,t){var r=gt;gt=r!==0&&4>r?r:4,e(!0);var n=O0.transition;O0.transition={};try{e(!1),t()}finally{gt=r,O0.transition=n}}function V2(){return Kn().memoizedState}function sb(e,t,r){var n=Za(e);if(r={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null},B2(e))W2(t,r);else if(r=E2(e,t,r,n),r!==null){var s=Jr();hs(r,e,n,s),z2(r,t,n)}}function ab(e,t,r){var n=Za(e),s={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null};if(B2(e))W2(t,s);else{var a=e.alternate;if(e.lanes===0&&(a===null||a.lanes===0)&&(a=t.lastRenderedReducer,a!==null))try{var i=t.lastRenderedState,o=a(i,r);if(s.hasEagerState=!0,s.eagerState=o,ps(o,i)){var l=t.interleaved;l===null?(s.next=s,Eg(t)):(s.next=l.next,l.next=s),t.interleaved=s;return}}catch{}finally{}r=E2(e,t,s,n),r!==null&&(s=Jr(),hs(r,e,n,s),z2(r,t,n))}}function B2(e){var t=e.alternate;return e===Lt||t!==null&&t===Lt}function W2(e,t){gc=Ch=!0;var r=e.pending;r===null?t.next=t:(t.next=r.next,r.next=t),e.pending=t}function z2(e,t,r){if(r&4194240){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,lg(e,r)}}var bh={readContext:Gn,useCallback:Pr,useContext:Pr,useEffect:Pr,useImperativeHandle:Pr,useInsertionEffect:Pr,useLayoutEffect:Pr,useMemo:Pr,useReducer:Pr,useRef:Pr,useState:Pr,useDebugValue:Pr,useDeferredValue:Pr,useTransition:Pr,useMutableSource:Pr,useSyncExternalStore:Pr,useId:Pr,unstable_isNewReconciler:!1},ib={readContext:Gn,useCallback:function(e,t){return Ts().memoizedState=[e,t===void 0?null:t],e},useContext:Gn,useEffect:B1,useImperativeHandle:function(e,t,r){return r=r!=null?r.concat([e]):null,Xf(4194308,4,O2.bind(null,t,e),r)},useLayoutEffect:function(e,t){return Xf(4194308,4,e,t)},useInsertionEffect:function(e,t){return Xf(4,2,e,t)},useMemo:function(e,t){var r=Ts();return t=t===void 0?null:t,e=e(),r.memoizedState=[e,t],e},useReducer:function(e,t,r){var n=Ts();return t=r!==void 0?r(t):t,n.memoizedState=n.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},n.queue=e,e=e.dispatch=sb.bind(null,Lt,e),[n.memoizedState,e]},useRef:function(e){var t=Ts();return e={current:e},t.memoizedState=e},useState:V1,useDebugValue:Rg,useDeferredValue:function(e){return Ts().memoizedState=e},useTransition:function(){var e=V1(!1),t=e[0];return e=nb.bind(null,e[1]),Ts().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,r){var n=Lt,s=Ts();if(Dt){if(r===void 0)throw Error(we(407));r=r()}else{if(r=t(),pr===null)throw Error(we(349));Hi&30||I2(n,t,r)}s.memoizedState=r;var a={value:r,getSnapshot:t};return s.queue=a,B1(C2.bind(null,n,a,e),[e]),n.flags|=2048,Xc(9,N2.bind(null,n,a,r,t),void 0,null),r},useId:function(){var e=Ts(),t=pr.identifierPrefix;if(Dt){var r=Zs,n=Js;r=(n&~(1<<32-fs(n)-1)).toString(32)+r,t=":"+t+"R"+r,r=qc++,0<r&&(t+="H"+r.toString(32)),t+=":"}else r=rb++,t=":"+t+"r"+r.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},ob={readContext:Gn,useCallback:L2,useContext:Gn,useEffect:bg,useImperativeHandle:M2,useInsertionEffect:D2,useLayoutEffect:F2,useMemo:j2,useReducer:M0,useRef:P2,useState:function(){return M0(Yc)},useDebugValue:Rg,useDeferredValue:function(e){var t=Kn();return U2(t,ar.memoizedState,e)},useTransition:function(){var e=M0(Yc)[0],t=Kn().memoizedState;return[e,t]},useMutableSource:S2,useSyncExternalStore:A2,useId:V2,unstable_isNewReconciler:!1},lb={readContext:Gn,useCallback:L2,useContext:Gn,useEffect:bg,useImperativeHandle:M2,useInsertionEffect:D2,useLayoutEffect:F2,useMemo:j2,useReducer:L0,useRef:P2,useState:function(){return L0(Yc)},useDebugValue:Rg,useDeferredValue:function(e){var t=Kn();return ar===null?t.memoizedState=e:U2(t,ar.memoizedState,e)},useTransition:function(){var e=L0(Yc)[0],t=Kn().memoizedState;return[e,t]},useMutableSource:S2,useSyncExternalStore:A2,useId:V2,unstable_isNewReconciler:!1};function rs(e,t){if(e&&e.defaultProps){t=jt({},t),e=e.defaultProps;for(var r in e)t[r]===void 0&&(t[r]=e[r]);return t}return t}function Hm(e,t,r,n){t=e.memoizedState,r=r(n,t),r=r==null?t:jt({},t,r),e.memoizedState=r,e.lanes===0&&(e.updateQueue.baseState=r)}var Sd={isMounted:function(e){return(e=e._reactInternals)?no(e)===e:!1},enqueueSetState:function(e,t,r){e=e._reactInternals;var n=Jr(),s=Za(e),a=aa(n,s);a.payload=t,r!=null&&(a.callback=r),t=Qa(e,a,s),t!==null&&(hs(t,e,s,n),qf(t,e,s))},enqueueReplaceState:function(e,t,r){e=e._reactInternals;var n=Jr(),s=Za(e),a=aa(n,s);a.tag=1,a.payload=t,r!=null&&(a.callback=r),t=Qa(e,a,s),t!==null&&(hs(t,e,s,n),qf(t,e,s))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var r=Jr(),n=Za(e),s=aa(r,n);s.tag=2,t!=null&&(s.callback=t),t=Qa(e,s,n),t!==null&&(hs(t,e,n,r),qf(t,e,n))}};function W1(e,t,r,n,s,a,i){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(n,a,i):t.prototype&&t.prototype.isPureReactComponent?!Wc(r,n)||!Wc(s,a):!0}function $2(e,t,r){var n=!1,s=oi,a=t.contextType;return typeof a=="object"&&a!==null?a=Gn(a):(s=pn(t)?zi:$r.current,n=t.contextTypes,a=(n=n!=null)?rl(e,s):oi),t=new t(r,a),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=Sd,e.stateNode=t,t._reactInternals=e,n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=s,e.__reactInternalMemoizedMaskedChildContext=a),t}function z1(e,t,r,n){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(r,n),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(r,n),t.state!==e&&Sd.enqueueReplaceState(t,t.state,null)}function Gm(e,t,r,n){var s=e.stateNode;s.props=r,s.state=e.memoizedState,s.refs={},Tg(e);var a=t.contextType;typeof a=="object"&&a!==null?s.context=Gn(a):(a=pn(t)?zi:$r.current,s.context=rl(e,a)),s.state=e.memoizedState,a=t.getDerivedStateFromProps,typeof a=="function"&&(Hm(e,t,a,r),s.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof s.getSnapshotBeforeUpdate=="function"||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(t=s.state,typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount(),t!==s.state&&Sd.enqueueReplaceState(s,s.state,null),Ih(e,r,s,n),s.state=e.memoizedState),typeof s.componentDidMount=="function"&&(e.flags|=4194308)}function il(e,t){try{var r="",n=t;do r+=MN(n),n=n.return;while(n);var s=r}catch(a){s=`
Error generating stack: `+a.message+`
`+a.stack}return{value:e,source:t,stack:s,digest:null}}function j0(e,t,r){return{value:e,source:null,stack:r??null,digest:t??null}}function Km(e,t){try{console.error(t.value)}catch(r){setTimeout(function(){throw r})}}var cb=typeof WeakMap=="function"?WeakMap:Map;function H2(e,t,r){r=aa(-1,r),r.tag=3,r.payload={element:null};var n=t.value;return r.callback=function(){Ph||(Ph=!0,np=n),Km(e,t)},r}function G2(e,t,r){r=aa(-1,r),r.tag=3;var n=e.type.getDerivedStateFromError;if(typeof n=="function"){var s=t.value;r.payload=function(){return n(s)},r.callback=function(){Km(e,t)}}var a=e.stateNode;return a!==null&&typeof a.componentDidCatch=="function"&&(r.callback=function(){Km(e,t),typeof n!="function"&&(Ja===null?Ja=new Set([this]):Ja.add(this));var i=t.stack;this.componentDidCatch(t.value,{componentStack:i!==null?i:""})}),r}function $1(e,t,r){var n=e.pingCache;if(n===null){n=e.pingCache=new cb;var s=new Set;n.set(t,s)}else s=n.get(t),s===void 0&&(s=new Set,n.set(t,s));s.has(r)||(s.add(r),e=Tb.bind(null,e,t,r),t.then(e,e))}function H1(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function G1(e,t,r,n,s){return e.mode&1?(e.flags|=65536,e.lanes=s,e):(e===t?e.flags|=65536:(e.flags|=128,r.flags|=131072,r.flags&=-52805,r.tag===1&&(r.alternate===null?r.tag=17:(t=aa(-1,1),t.tag=2,Qa(r,t,1))),r.lanes|=1),e)}var ub=Ea.ReactCurrentOwner,hn=!1;function qr(e,t,r,n){t.child=e===null?w2(t,null,r,n):sl(t,e.child,r,n)}function K1(e,t,r,n,s){r=r.render;var a=t.ref;return Ho(t,s),n=Ng(e,t,r,n,a,s),r=Cg(),e!==null&&!hn?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~s,da(e,t,s)):(Dt&&r&&gg(t),t.flags|=1,qr(e,t,n,s),t.child)}function q1(e,t,r,n,s){if(e===null){var a=r.type;return typeof a=="function"&&!Ug(a)&&a.defaultProps===void 0&&r.compare===null&&r.defaultProps===void 0?(t.tag=15,t.type=a,K2(e,t,a,n,s)):(e=eh(r.type,null,n,t,t.mode,s),e.ref=t.ref,e.return=t,t.child=e)}if(a=e.child,!(e.lanes&s)){var i=a.memoizedProps;if(r=r.compare,r=r!==null?r:Wc,r(i,n)&&e.ref===t.ref)return da(e,t,s)}return t.flags|=1,e=ei(a,n),e.ref=t.ref,e.return=t,t.child=e}function K2(e,t,r,n,s){if(e!==null){var a=e.memoizedProps;if(Wc(a,n)&&e.ref===t.ref)if(hn=!1,t.pendingProps=n=a,(e.lanes&s)!==0)e.flags&131072&&(hn=!0);else return t.lanes=e.lanes,da(e,t,s)}return qm(e,t,r,n,s)}function q2(e,t,r){var n=t.pendingProps,s=n.children,a=e!==null?e.memoizedState:null;if(n.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},Et(Uo,_n),_n|=r;else{if(!(r&1073741824))return e=a!==null?a.baseLanes|r:r,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,Et(Uo,_n),_n|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=a!==null?a.baseLanes:r,Et(Uo,_n),_n|=n}else a!==null?(n=a.baseLanes|r,t.memoizedState=null):n=r,Et(Uo,_n),_n|=n;return qr(e,t,s,r),t.child}function Y2(e,t){var r=t.ref;(e===null&&r!==null||e!==null&&e.ref!==r)&&(t.flags|=512,t.flags|=2097152)}function qm(e,t,r,n,s){var a=pn(r)?zi:$r.current;return a=rl(t,a),Ho(t,s),r=Ng(e,t,r,n,a,s),n=Cg(),e!==null&&!hn?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~s,da(e,t,s)):(Dt&&n&&gg(t),t.flags|=1,qr(e,t,r,s),t.child)}function Y1(e,t,r,n,s){if(pn(r)){var a=!0;Eh(t)}else a=!1;if(Ho(t,s),t.stateNode===null)Qf(e,t),$2(t,r,n),Gm(t,r,n,s),n=!0;else if(e===null){var i=t.stateNode,o=t.memoizedProps;i.props=o;var l=i.context,c=r.contextType;typeof c=="object"&&c!==null?c=Gn(c):(c=pn(r)?zi:$r.current,c=rl(t,c));var f=r.getDerivedStateFromProps,d=typeof f=="function"||typeof i.getSnapshotBeforeUpdate=="function";d||typeof i.UNSAFE_componentWillReceiveProps!="function"&&typeof i.componentWillReceiveProps!="function"||(o!==n||l!==c)&&z1(t,i,n,c),Fa=!1;var m=t.memoizedState;i.state=m,Ih(t,n,i,s),l=t.memoizedState,o!==n||m!==l||mn.current||Fa?(typeof f=="function"&&(Hm(t,r,f,n),l=t.memoizedState),(o=Fa||W1(t,r,o,n,m,l,c))?(d||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount()),typeof i.componentDidMount=="function"&&(t.flags|=4194308)):(typeof i.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=n,t.memoizedState=l),i.props=n,i.state=l,i.context=c,n=o):(typeof i.componentDidMount=="function"&&(t.flags|=4194308),n=!1)}else{i=t.stateNode,T2(e,t),o=t.memoizedProps,c=t.type===t.elementType?o:rs(t.type,o),i.props=c,d=t.pendingProps,m=i.context,l=r.contextType,typeof l=="object"&&l!==null?l=Gn(l):(l=pn(r)?zi:$r.current,l=rl(t,l));var p=r.getDerivedStateFromProps;(f=typeof p=="function"||typeof i.getSnapshotBeforeUpdate=="function")||typeof i.UNSAFE_componentWillReceiveProps!="function"&&typeof i.componentWillReceiveProps!="function"||(o!==d||m!==l)&&z1(t,i,n,l),Fa=!1,m=t.memoizedState,i.state=m,Ih(t,n,i,s);var x=t.memoizedState;o!==d||m!==x||mn.current||Fa?(typeof p=="function"&&(Hm(t,r,p,n),x=t.memoizedState),(c=Fa||W1(t,r,c,n,m,x,l)||!1)?(f||typeof i.UNSAFE_componentWillUpdate!="function"&&typeof i.componentWillUpdate!="function"||(typeof i.componentWillUpdate=="function"&&i.componentWillUpdate(n,x,l),typeof i.UNSAFE_componentWillUpdate=="function"&&i.UNSAFE_componentWillUpdate(n,x,l)),typeof i.componentDidUpdate=="function"&&(t.flags|=4),typeof i.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof i.componentDidUpdate!="function"||o===e.memoizedProps&&m===e.memoizedState||(t.flags|=4),typeof i.getSnapshotBeforeUpdate!="function"||o===e.memoizedProps&&m===e.memoizedState||(t.flags|=1024),t.memoizedProps=n,t.memoizedState=x),i.props=n,i.state=x,i.context=l,n=c):(typeof i.componentDidUpdate!="function"||o===e.memoizedProps&&m===e.memoizedState||(t.flags|=4),typeof i.getSnapshotBeforeUpdate!="function"||o===e.memoizedProps&&m===e.memoizedState||(t.flags|=1024),n=!1)}return Ym(e,t,r,n,a,s)}function Ym(e,t,r,n,s,a){Y2(e,t);var i=(t.flags&128)!==0;if(!n&&!i)return s&&F1(t,r,!1),da(e,t,a);n=t.stateNode,ub.current=t;var o=i&&typeof r.getDerivedStateFromError!="function"?null:n.render();return t.flags|=1,e!==null&&i?(t.child=sl(t,e.child,null,a),t.child=sl(t,null,o,a)):qr(e,t,o,a),t.memoizedState=n.state,s&&F1(t,r,!0),t.child}function X2(e){var t=e.stateNode;t.pendingContext?D1(e,t.pendingContext,t.pendingContext!==t.context):t.context&&D1(e,t.context,!1),kg(e,t.containerInfo)}function X1(e,t,r,n,s){return nl(),vg(s),t.flags|=256,qr(e,t,r,n),t.child}var Xm={dehydrated:null,treeContext:null,retryLane:0};function Qm(e){return{baseLanes:e,cachePool:null,transitions:null}}function Q2(e,t,r){var n=t.pendingProps,s=Mt.current,a=!1,i=(t.flags&128)!==0,o;if((o=i)||(o=e!==null&&e.memoizedState===null?!1:(s&2)!==0),o?(a=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(s|=1),Et(Mt,s&1),e===null)return zm(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(i=n.children,e=n.fallback,a?(n=t.mode,a=t.child,i={mode:"hidden",children:i},!(n&1)&&a!==null?(a.childLanes=0,a.pendingProps=i):a=Nd(i,n,0,null),e=Li(e,n,r,null),a.return=t,e.return=t,a.sibling=e,t.child=a,t.child.memoizedState=Qm(r),t.memoizedState=Xm,e):Pg(t,i));if(s=e.memoizedState,s!==null&&(o=s.dehydrated,o!==null))return fb(e,t,i,n,o,s,r);if(a){a=n.fallback,i=t.mode,s=e.child,o=s.sibling;var l={mode:"hidden",children:n.children};return!(i&1)&&t.child!==s?(n=t.child,n.childLanes=0,n.pendingProps=l,t.deletions=null):(n=ei(s,l),n.subtreeFlags=s.subtreeFlags&14680064),o!==null?a=ei(o,a):(a=Li(a,i,r,null),a.flags|=2),a.return=t,n.return=t,n.sibling=a,t.child=n,n=a,a=t.child,i=e.child.memoizedState,i=i===null?Qm(r):{baseLanes:i.baseLanes|r,cachePool:null,transitions:i.transitions},a.memoizedState=i,a.childLanes=e.childLanes&~r,t.memoizedState=Xm,n}return a=e.child,e=a.sibling,n=ei(a,{mode:"visible",children:n.children}),!(t.mode&1)&&(n.lanes=r),n.return=t,n.sibling=null,e!==null&&(r=t.deletions,r===null?(t.deletions=[e],t.flags|=16):r.push(e)),t.child=n,t.memoizedState=null,n}function Pg(e,t){return t=Nd({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function Tf(e,t,r,n){return n!==null&&vg(n),sl(t,e.child,null,r),e=Pg(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function fb(e,t,r,n,s,a,i){if(r)return t.flags&256?(t.flags&=-257,n=j0(Error(we(422))),Tf(e,t,i,n)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(a=n.fallback,s=t.mode,n=Nd({mode:"visible",children:n.children},s,0,null),a=Li(a,s,i,null),a.flags|=2,n.return=t,a.return=t,n.sibling=a,t.child=n,t.mode&1&&sl(t,e.child,null,i),t.child.memoizedState=Qm(i),t.memoizedState=Xm,a);if(!(t.mode&1))return Tf(e,t,i,null);if(s.data==="$!"){if(n=s.nextSibling&&s.nextSibling.dataset,n)var o=n.dgst;return n=o,a=Error(we(419)),n=j0(a,n,void 0),Tf(e,t,i,n)}if(o=(i&e.childLanes)!==0,hn||o){if(n=pr,n!==null){switch(i&-i){case 4:s=2;break;case 16:s=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:s=32;break;case 536870912:s=268435456;break;default:s=0}s=s&(n.suspendedLanes|i)?0:s,s!==0&&s!==a.retryLane&&(a.retryLane=s,ha(e,s),hs(n,e,s,-1))}return jg(),n=j0(Error(we(421))),Tf(e,t,i,n)}return s.data==="$?"?(t.flags|=128,t.child=e.child,t=kb.bind(null,e),s._reactRetry=t,null):(e=a.treeContext,kn=Xa(s.nextSibling),An=t,Dt=!0,as=null,e!==null&&(Vn[Bn++]=Js,Vn[Bn++]=Zs,Vn[Bn++]=$i,Js=e.id,Zs=e.overflow,$i=t),t=Pg(t,n.children),t.flags|=4096,t)}function Q1(e,t,r){e.lanes|=t;var n=e.alternate;n!==null&&(n.lanes|=t),$m(e.return,t,r)}function U0(e,t,r,n,s){var a=e.memoizedState;a===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:n,tail:r,tailMode:s}:(a.isBackwards=t,a.rendering=null,a.renderingStartTime=0,a.last=n,a.tail=r,a.tailMode=s)}function J2(e,t,r){var n=t.pendingProps,s=n.revealOrder,a=n.tail;if(qr(e,t,n.children,r),n=Mt.current,n&2)n=n&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&Q1(e,r,t);else if(e.tag===19)Q1(e,r,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}n&=1}if(Et(Mt,n),!(t.mode&1))t.memoizedState=null;else switch(s){case"forwards":for(r=t.child,s=null;r!==null;)e=r.alternate,e!==null&&Nh(e)===null&&(s=r),r=r.sibling;r=s,r===null?(s=t.child,t.child=null):(s=r.sibling,r.sibling=null),U0(t,!1,s,r,a);break;case"backwards":for(r=null,s=t.child,t.child=null;s!==null;){if(e=s.alternate,e!==null&&Nh(e)===null){t.child=s;break}e=s.sibling,s.sibling=r,r=s,s=e}U0(t,!0,r,null,a);break;case"together":U0(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function Qf(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function da(e,t,r){if(e!==null&&(t.dependencies=e.dependencies),Gi|=t.lanes,!(r&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(we(153));if(t.child!==null){for(e=t.child,r=ei(e,e.pendingProps),t.child=r,r.return=t;e.sibling!==null;)e=e.sibling,r=r.sibling=ei(e,e.pendingProps),r.return=t;r.sibling=null}return t.child}function hb(e,t,r){switch(t.tag){case 3:X2(t),nl();break;case 5:k2(t);break;case 1:pn(t.type)&&Eh(t);break;case 4:kg(t,t.stateNode.containerInfo);break;case 10:var n=t.type._context,s=t.memoizedProps.value;Et(Sh,n._currentValue),n._currentValue=s;break;case 13:if(n=t.memoizedState,n!==null)return n.dehydrated!==null?(Et(Mt,Mt.current&1),t.flags|=128,null):r&t.child.childLanes?Q2(e,t,r):(Et(Mt,Mt.current&1),e=da(e,t,r),e!==null?e.sibling:null);Et(Mt,Mt.current&1);break;case 19:if(n=(r&t.childLanes)!==0,e.flags&128){if(n)return J2(e,t,r);t.flags|=128}if(s=t.memoizedState,s!==null&&(s.rendering=null,s.tail=null,s.lastEffect=null),Et(Mt,Mt.current),n)break;return null;case 22:case 23:return t.lanes=0,q2(e,t,r)}return da(e,t,r)}var Z2,Jm,eT,tT;Z2=function(e,t){for(var r=t.child;r!==null;){if(r.tag===5||r.tag===6)e.appendChild(r.stateNode);else if(r.tag!==4&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===t)break;for(;r.sibling===null;){if(r.return===null||r.return===t)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};Jm=function(){};eT=function(e,t,r,n){var s=e.memoizedProps;if(s!==n){e=t.stateNode,Ri(Is.current);var a=null;switch(r){case"input":s=_m(e,s),n=_m(e,n),a=[];break;case"select":s=jt({},s,{value:void 0}),n=jt({},n,{value:void 0}),a=[];break;case"textarea":s=Tm(e,s),n=Tm(e,n),a=[];break;default:typeof s.onClick!="function"&&typeof n.onClick=="function"&&(e.onclick=_h)}Sm(r,n);var i;r=null;for(c in s)if(!n.hasOwnProperty(c)&&s.hasOwnProperty(c)&&s[c]!=null)if(c==="style"){var o=s[c];for(i in o)o.hasOwnProperty(i)&&(r||(r={}),r[i]="")}else c!=="dangerouslySetInnerHTML"&&c!=="children"&&c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&c!=="autoFocus"&&(Oc.hasOwnProperty(c)?a||(a=[]):(a=a||[]).push(c,null));for(c in n){var l=n[c];if(o=s!=null?s[c]:void 0,n.hasOwnProperty(c)&&l!==o&&(l!=null||o!=null))if(c==="style")if(o){for(i in o)!o.hasOwnProperty(i)||l&&l.hasOwnProperty(i)||(r||(r={}),r[i]="");for(i in l)l.hasOwnProperty(i)&&o[i]!==l[i]&&(r||(r={}),r[i]=l[i])}else r||(a||(a=[]),a.push(c,r)),r=l;else c==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,o=o?o.__html:void 0,l!=null&&o!==l&&(a=a||[]).push(c,l)):c==="children"?typeof l!="string"&&typeof l!="number"||(a=a||[]).push(c,""+l):c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&(Oc.hasOwnProperty(c)?(l!=null&&c==="onScroll"&&It("scroll",e),a||o===l||(a=[])):(a=a||[]).push(c,l))}r&&(a=a||[]).push("style",r);var c=a;(t.updateQueue=c)&&(t.flags|=4)}};tT=function(e,t,r,n){r!==n&&(t.flags|=4)};function Gl(e,t){if(!Dt)switch(e.tailMode){case"hidden":t=e.tail;for(var r=null;t!==null;)t.alternate!==null&&(r=t),t=t.sibling;r===null?e.tail=null:r.sibling=null;break;case"collapsed":r=e.tail;for(var n=null;r!==null;)r.alternate!==null&&(n=r),r=r.sibling;n===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:n.sibling=null}}function Dr(e){var t=e.alternate!==null&&e.alternate.child===e.child,r=0,n=0;if(t)for(var s=e.child;s!==null;)r|=s.lanes|s.childLanes,n|=s.subtreeFlags&14680064,n|=s.flags&14680064,s.return=e,s=s.sibling;else for(s=e.child;s!==null;)r|=s.lanes|s.childLanes,n|=s.subtreeFlags,n|=s.flags,s.return=e,s=s.sibling;return e.subtreeFlags|=n,e.childLanes=r,t}function db(e,t,r){var n=t.pendingProps;switch(xg(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Dr(t),null;case 1:return pn(t.type)&&wh(),Dr(t),null;case 3:return n=t.stateNode,al(),Ct(mn),Ct($r),Ag(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(e===null||e.child===null)&&(wf(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,as!==null&&(ip(as),as=null))),Jm(e,t),Dr(t),null;case 5:Sg(t);var s=Ri(Kc.current);if(r=t.type,e!==null&&t.stateNode!=null)eT(e,t,r,n,s),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!n){if(t.stateNode===null)throw Error(we(166));return Dr(t),null}if(e=Ri(Is.current),wf(t)){n=t.stateNode,r=t.type;var a=t.memoizedProps;switch(n[ks]=t,n[Hc]=a,e=(t.mode&1)!==0,r){case"dialog":It("cancel",n),It("close",n);break;case"iframe":case"object":case"embed":It("load",n);break;case"video":case"audio":for(s=0;s<tc.length;s++)It(tc[s],n);break;case"source":It("error",n);break;case"img":case"image":case"link":It("error",n),It("load",n);break;case"details":It("toggle",n);break;case"input":i1(n,a),It("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!a.multiple},It("invalid",n);break;case"textarea":l1(n,a),It("invalid",n)}Sm(r,a),s=null;for(var i in a)if(a.hasOwnProperty(i)){var o=a[i];i==="children"?typeof o=="string"?n.textContent!==o&&(a.suppressHydrationWarning!==!0&&_f(n.textContent,o,e),s=["children",o]):typeof o=="number"&&n.textContent!==""+o&&(a.suppressHydrationWarning!==!0&&_f(n.textContent,o,e),s=["children",""+o]):Oc.hasOwnProperty(i)&&o!=null&&i==="onScroll"&&It("scroll",n)}switch(r){case"input":hf(n),o1(n,a,!0);break;case"textarea":hf(n),c1(n);break;case"select":case"option":break;default:typeof a.onClick=="function"&&(n.onclick=_h)}n=s,t.updateQueue=n,n!==null&&(t.flags|=4)}else{i=s.nodeType===9?s:s.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=CE(r)),e==="http://www.w3.org/1999/xhtml"?r==="script"?(e=i.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof n.is=="string"?e=i.createElement(r,{is:n.is}):(e=i.createElement(r),r==="select"&&(i=e,n.multiple?i.multiple=!0:n.size&&(i.size=n.size))):e=i.createElementNS(e,r),e[ks]=t,e[Hc]=n,Z2(e,t,!1,!1),t.stateNode=e;e:{switch(i=Am(r,n),r){case"dialog":It("cancel",e),It("close",e),s=n;break;case"iframe":case"object":case"embed":It("load",e),s=n;break;case"video":case"audio":for(s=0;s<tc.length;s++)It(tc[s],e);s=n;break;case"source":It("error",e),s=n;break;case"img":case"image":case"link":It("error",e),It("load",e),s=n;break;case"details":It("toggle",e),s=n;break;case"input":i1(e,n),s=_m(e,n),It("invalid",e);break;case"option":s=n;break;case"select":e._wrapperState={wasMultiple:!!n.multiple},s=jt({},n,{value:void 0}),It("invalid",e);break;case"textarea":l1(e,n),s=Tm(e,n),It("invalid",e);break;default:s=n}Sm(r,s),o=s;for(a in o)if(o.hasOwnProperty(a)){var l=o[a];a==="style"?PE(e,l):a==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&bE(e,l)):a==="children"?typeof l=="string"?(r!=="textarea"||l!=="")&&Mc(e,l):typeof l=="number"&&Mc(e,""+l):a!=="suppressContentEditableWarning"&&a!=="suppressHydrationWarning"&&a!=="autoFocus"&&(Oc.hasOwnProperty(a)?l!=null&&a==="onScroll"&&It("scroll",e):l!=null&&rg(e,a,l,i))}switch(r){case"input":hf(e),o1(e,n,!1);break;case"textarea":hf(e),c1(e);break;case"option":n.value!=null&&e.setAttribute("value",""+ii(n.value));break;case"select":e.multiple=!!n.multiple,a=n.value,a!=null?Bo(e,!!n.multiple,a,!1):n.defaultValue!=null&&Bo(e,!!n.multiple,n.defaultValue,!0);break;default:typeof s.onClick=="function"&&(e.onclick=_h)}switch(r){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}}n&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return Dr(t),null;case 6:if(e&&t.stateNode!=null)tT(e,t,e.memoizedProps,n);else{if(typeof n!="string"&&t.stateNode===null)throw Error(we(166));if(r=Ri(Kc.current),Ri(Is.current),wf(t)){if(n=t.stateNode,r=t.memoizedProps,n[ks]=t,(a=n.nodeValue!==r)&&(e=An,e!==null))switch(e.tag){case 3:_f(n.nodeValue,r,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&_f(n.nodeValue,r,(e.mode&1)!==0)}a&&(t.flags|=4)}else n=(r.nodeType===9?r:r.ownerDocument).createTextNode(n),n[ks]=t,t.stateNode=n}return Dr(t),null;case 13:if(Ct(Mt),n=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(Dt&&kn!==null&&t.mode&1&&!(t.flags&128))y2(),nl(),t.flags|=98560,a=!1;else if(a=wf(t),n!==null&&n.dehydrated!==null){if(e===null){if(!a)throw Error(we(318));if(a=t.memoizedState,a=a!==null?a.dehydrated:null,!a)throw Error(we(317));a[ks]=t}else nl(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;Dr(t),a=!1}else as!==null&&(ip(as),as=null),a=!0;if(!a)return t.flags&65536?t:null}return t.flags&128?(t.lanes=r,t):(n=n!==null,n!==(e!==null&&e.memoizedState!==null)&&n&&(t.child.flags|=8192,t.mode&1&&(e===null||Mt.current&1?ir===0&&(ir=3):jg())),t.updateQueue!==null&&(t.flags|=4),Dr(t),null);case 4:return al(),Jm(e,t),e===null&&zc(t.stateNode.containerInfo),Dr(t),null;case 10:return wg(t.type._context),Dr(t),null;case 17:return pn(t.type)&&wh(),Dr(t),null;case 19:if(Ct(Mt),a=t.memoizedState,a===null)return Dr(t),null;if(n=(t.flags&128)!==0,i=a.rendering,i===null)if(n)Gl(a,!1);else{if(ir!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(i=Nh(e),i!==null){for(t.flags|=128,Gl(a,!1),n=i.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),t.subtreeFlags=0,n=r,r=t.child;r!==null;)a=r,e=n,a.flags&=14680066,i=a.alternate,i===null?(a.childLanes=0,a.lanes=e,a.child=null,a.subtreeFlags=0,a.memoizedProps=null,a.memoizedState=null,a.updateQueue=null,a.dependencies=null,a.stateNode=null):(a.childLanes=i.childLanes,a.lanes=i.lanes,a.child=i.child,a.subtreeFlags=0,a.deletions=null,a.memoizedProps=i.memoizedProps,a.memoizedState=i.memoizedState,a.updateQueue=i.updateQueue,a.type=i.type,e=i.dependencies,a.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),r=r.sibling;return Et(Mt,Mt.current&1|2),t.child}e=e.sibling}a.tail!==null&&Kt()>ol&&(t.flags|=128,n=!0,Gl(a,!1),t.lanes=4194304)}else{if(!n)if(e=Nh(i),e!==null){if(t.flags|=128,n=!0,r=e.updateQueue,r!==null&&(t.updateQueue=r,t.flags|=4),Gl(a,!0),a.tail===null&&a.tailMode==="hidden"&&!i.alternate&&!Dt)return Dr(t),null}else 2*Kt()-a.renderingStartTime>ol&&r!==1073741824&&(t.flags|=128,n=!0,Gl(a,!1),t.lanes=4194304);a.isBackwards?(i.sibling=t.child,t.child=i):(r=a.last,r!==null?r.sibling=i:t.child=i,a.last=i)}return a.tail!==null?(t=a.tail,a.rendering=t,a.tail=t.sibling,a.renderingStartTime=Kt(),t.sibling=null,r=Mt.current,Et(Mt,n?r&1|2:r&1),t):(Dr(t),null);case 22:case 23:return Lg(),n=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==n&&(t.flags|=8192),n&&t.mode&1?_n&1073741824&&(Dr(t),t.subtreeFlags&6&&(t.flags|=8192)):Dr(t),null;case 24:return null;case 25:return null}throw Error(we(156,t.tag))}function mb(e,t){switch(xg(t),t.tag){case 1:return pn(t.type)&&wh(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return al(),Ct(mn),Ct($r),Ag(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return Sg(t),null;case 13:if(Ct(Mt),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(we(340));nl()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return Ct(Mt),null;case 4:return al(),null;case 10:return wg(t.type._context),null;case 22:case 23:return Lg(),null;case 24:return null;default:return null}}var kf=!1,jr=!1,pb=typeof WeakSet=="function"?WeakSet:Set,Ce=null;function jo(e,t){var r=e.ref;if(r!==null)if(typeof r=="function")try{r(null)}catch(n){Bt(e,t,n)}else r.current=null}function Zm(e,t,r){try{r()}catch(n){Bt(e,t,n)}}var J1=!1;function gb(e,t){if(Mm=xh,e=i2(),pg(e)){if("selectionStart"in e)var r={start:e.selectionStart,end:e.selectionEnd};else e:{r=(r=e.ownerDocument)&&r.defaultView||window;var n=r.getSelection&&r.getSelection();if(n&&n.rangeCount!==0){r=n.anchorNode;var s=n.anchorOffset,a=n.focusNode;n=n.focusOffset;try{r.nodeType,a.nodeType}catch{r=null;break e}var i=0,o=-1,l=-1,c=0,f=0,d=e,m=null;t:for(;;){for(var p;d!==r||s!==0&&d.nodeType!==3||(o=i+s),d!==a||n!==0&&d.nodeType!==3||(l=i+n),d.nodeType===3&&(i+=d.nodeValue.length),(p=d.firstChild)!==null;)m=d,d=p;for(;;){if(d===e)break t;if(m===r&&++c===s&&(o=i),m===a&&++f===n&&(l=i),(p=d.nextSibling)!==null)break;d=m,m=d.parentNode}d=p}r=o===-1||l===-1?null:{start:o,end:l}}else r=null}r=r||{start:0,end:0}}else r=null;for(Lm={focusedElem:e,selectionRange:r},xh=!1,Ce=t;Ce!==null;)if(t=Ce,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,Ce=e;else for(;Ce!==null;){t=Ce;try{var x=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(x!==null){var g=x.memoizedProps,w=x.memoizedState,k=t.stateNode,E=k.getSnapshotBeforeUpdate(t.elementType===t.type?g:rs(t.type,g),w);k.__reactInternalSnapshotBeforeUpdate=E}break;case 3:var y=t.stateNode.containerInfo;y.nodeType===1?y.textContent="":y.nodeType===9&&y.documentElement&&y.removeChild(y.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(we(163))}}catch(I){Bt(t,t.return,I)}if(e=t.sibling,e!==null){e.return=t.return,Ce=e;break}Ce=t.return}return x=J1,J1=!1,x}function xc(e,t,r){var n=t.updateQueue;if(n=n!==null?n.lastEffect:null,n!==null){var s=n=n.next;do{if((s.tag&e)===e){var a=s.destroy;s.destroy=void 0,a!==void 0&&Zm(t,r,a)}s=s.next}while(s!==n)}}function Ad(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var r=t=t.next;do{if((r.tag&e)===e){var n=r.create;r.destroy=n()}r=r.next}while(r!==t)}}function ep(e){var t=e.ref;if(t!==null){var r=e.stateNode;switch(e.tag){case 5:e=r;break;default:e=r}typeof t=="function"?t(e):t.current=e}}function rT(e){var t=e.alternate;t!==null&&(e.alternate=null,rT(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[ks],delete t[Hc],delete t[Vm],delete t[JC],delete t[ZC])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function nT(e){return e.tag===5||e.tag===3||e.tag===4}function Z1(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||nT(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function tp(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.nodeType===8?r.parentNode.insertBefore(e,t):r.insertBefore(e,t):(r.nodeType===8?(t=r.parentNode,t.insertBefore(e,r)):(t=r,t.appendChild(e)),r=r._reactRootContainer,r!=null||t.onclick!==null||(t.onclick=_h));else if(n!==4&&(e=e.child,e!==null))for(tp(e,t,r),e=e.sibling;e!==null;)tp(e,t,r),e=e.sibling}function rp(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.insertBefore(e,t):r.appendChild(e);else if(n!==4&&(e=e.child,e!==null))for(rp(e,t,r),e=e.sibling;e!==null;)rp(e,t,r),e=e.sibling}var yr=null,ns=!1;function Na(e,t,r){for(r=r.child;r!==null;)sT(e,t,r),r=r.sibling}function sT(e,t,r){if(As&&typeof As.onCommitFiberUnmount=="function")try{As.onCommitFiberUnmount(vd,r)}catch{}switch(r.tag){case 5:jr||jo(r,t);case 6:var n=yr,s=ns;yr=null,Na(e,t,r),yr=n,ns=s,yr!==null&&(ns?(e=yr,r=r.stateNode,e.nodeType===8?e.parentNode.removeChild(r):e.removeChild(r)):yr.removeChild(r.stateNode));break;case 18:yr!==null&&(ns?(e=yr,r=r.stateNode,e.nodeType===8?P0(e.parentNode,r):e.nodeType===1&&P0(e,r),Vc(e)):P0(yr,r.stateNode));break;case 4:n=yr,s=ns,yr=r.stateNode.containerInfo,ns=!0,Na(e,t,r),yr=n,ns=s;break;case 0:case 11:case 14:case 15:if(!jr&&(n=r.updateQueue,n!==null&&(n=n.lastEffect,n!==null))){s=n=n.next;do{var a=s,i=a.destroy;a=a.tag,i!==void 0&&(a&2||a&4)&&Zm(r,t,i),s=s.next}while(s!==n)}Na(e,t,r);break;case 1:if(!jr&&(jo(r,t),n=r.stateNode,typeof n.componentWillUnmount=="function"))try{n.props=r.memoizedProps,n.state=r.memoizedState,n.componentWillUnmount()}catch(o){Bt(r,t,o)}Na(e,t,r);break;case 21:Na(e,t,r);break;case 22:r.mode&1?(jr=(n=jr)||r.memoizedState!==null,Na(e,t,r),jr=n):Na(e,t,r);break;default:Na(e,t,r)}}function ey(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var r=e.stateNode;r===null&&(r=e.stateNode=new pb),t.forEach(function(n){var s=Sb.bind(null,e,n);r.has(n)||(r.add(n),n.then(s,s))})}}function Zn(e,t){var r=t.deletions;if(r!==null)for(var n=0;n<r.length;n++){var s=r[n];try{var a=e,i=t,o=i;e:for(;o!==null;){switch(o.tag){case 5:yr=o.stateNode,ns=!1;break e;case 3:yr=o.stateNode.containerInfo,ns=!0;break e;case 4:yr=o.stateNode.containerInfo,ns=!0;break e}o=o.return}if(yr===null)throw Error(we(160));sT(a,i,s),yr=null,ns=!1;var l=s.alternate;l!==null&&(l.return=null),s.return=null}catch(c){Bt(s,t,c)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)aT(t,e),t=t.sibling}function aT(e,t){var r=e.alternate,n=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(Zn(t,e),_s(e),n&4){try{xc(3,e,e.return),Ad(3,e)}catch(g){Bt(e,e.return,g)}try{xc(5,e,e.return)}catch(g){Bt(e,e.return,g)}}break;case 1:Zn(t,e),_s(e),n&512&&r!==null&&jo(r,r.return);break;case 5:if(Zn(t,e),_s(e),n&512&&r!==null&&jo(r,r.return),e.flags&32){var s=e.stateNode;try{Mc(s,"")}catch(g){Bt(e,e.return,g)}}if(n&4&&(s=e.stateNode,s!=null)){var a=e.memoizedProps,i=r!==null?r.memoizedProps:a,o=e.type,l=e.updateQueue;if(e.updateQueue=null,l!==null)try{o==="input"&&a.type==="radio"&&a.name!=null&&IE(s,a),Am(o,i);var c=Am(o,a);for(i=0;i<l.length;i+=2){var f=l[i],d=l[i+1];f==="style"?PE(s,d):f==="dangerouslySetInnerHTML"?bE(s,d):f==="children"?Mc(s,d):rg(s,f,d,c)}switch(o){case"input":wm(s,a);break;case"textarea":NE(s,a);break;case"select":var m=s._wrapperState.wasMultiple;s._wrapperState.wasMultiple=!!a.multiple;var p=a.value;p!=null?Bo(s,!!a.multiple,p,!1):m!==!!a.multiple&&(a.defaultValue!=null?Bo(s,!!a.multiple,a.defaultValue,!0):Bo(s,!!a.multiple,a.multiple?[]:"",!1))}s[Hc]=a}catch(g){Bt(e,e.return,g)}}break;case 6:if(Zn(t,e),_s(e),n&4){if(e.stateNode===null)throw Error(we(162));s=e.stateNode,a=e.memoizedProps;try{s.nodeValue=a}catch(g){Bt(e,e.return,g)}}break;case 3:if(Zn(t,e),_s(e),n&4&&r!==null&&r.memoizedState.isDehydrated)try{Vc(t.containerInfo)}catch(g){Bt(e,e.return,g)}break;case 4:Zn(t,e),_s(e);break;case 13:Zn(t,e),_s(e),s=e.child,s.flags&8192&&(a=s.memoizedState!==null,s.stateNode.isHidden=a,!a||s.alternate!==null&&s.alternate.memoizedState!==null||(Og=Kt())),n&4&&ey(e);break;case 22:if(f=r!==null&&r.memoizedState!==null,e.mode&1?(jr=(c=jr)||f,Zn(t,e),jr=c):Zn(t,e),_s(e),n&8192){if(c=e.memoizedState!==null,(e.stateNode.isHidden=c)&&!f&&e.mode&1)for(Ce=e,f=e.child;f!==null;){for(d=Ce=f;Ce!==null;){switch(m=Ce,p=m.child,m.tag){case 0:case 11:case 14:case 15:xc(4,m,m.return);break;case 1:jo(m,m.return);var x=m.stateNode;if(typeof x.componentWillUnmount=="function"){n=m,r=m.return;try{t=n,x.props=t.memoizedProps,x.state=t.memoizedState,x.componentWillUnmount()}catch(g){Bt(n,r,g)}}break;case 5:jo(m,m.return);break;case 22:if(m.memoizedState!==null){ry(d);continue}}p!==null?(p.return=m,Ce=p):ry(d)}f=f.sibling}e:for(f=null,d=e;;){if(d.tag===5){if(f===null){f=d;try{s=d.stateNode,c?(a=s.style,typeof a.setProperty=="function"?a.setProperty("display","none","important"):a.display="none"):(o=d.stateNode,l=d.memoizedProps.style,i=l!=null&&l.hasOwnProperty("display")?l.display:null,o.style.display=RE("display",i))}catch(g){Bt(e,e.return,g)}}}else if(d.tag===6){if(f===null)try{d.stateNode.nodeValue=c?"":d.memoizedProps}catch(g){Bt(e,e.return,g)}}else if((d.tag!==22&&d.tag!==23||d.memoizedState===null||d===e)&&d.child!==null){d.child.return=d,d=d.child;continue}if(d===e)break e;for(;d.sibling===null;){if(d.return===null||d.return===e)break e;f===d&&(f=null),d=d.return}f===d&&(f=null),d.sibling.return=d.return,d=d.sibling}}break;case 19:Zn(t,e),_s(e),n&4&&ey(e);break;case 21:break;default:Zn(t,e),_s(e)}}function _s(e){var t=e.flags;if(t&2){try{e:{for(var r=e.return;r!==null;){if(nT(r)){var n=r;break e}r=r.return}throw Error(we(160))}switch(n.tag){case 5:var s=n.stateNode;n.flags&32&&(Mc(s,""),n.flags&=-33);var a=Z1(e);rp(e,a,s);break;case 3:case 4:var i=n.stateNode.containerInfo,o=Z1(e);tp(e,o,i);break;default:throw Error(we(161))}}catch(l){Bt(e,e.return,l)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function xb(e,t,r){Ce=e,iT(e)}function iT(e,t,r){for(var n=(e.mode&1)!==0;Ce!==null;){var s=Ce,a=s.child;if(s.tag===22&&n){var i=s.memoizedState!==null||kf;if(!i){var o=s.alternate,l=o!==null&&o.memoizedState!==null||jr;o=kf;var c=jr;if(kf=i,(jr=l)&&!c)for(Ce=s;Ce!==null;)i=Ce,l=i.child,i.tag===22&&i.memoizedState!==null?ny(s):l!==null?(l.return=i,Ce=l):ny(s);for(;a!==null;)Ce=a,iT(a),a=a.sibling;Ce=s,kf=o,jr=c}ty(e)}else s.subtreeFlags&8772&&a!==null?(a.return=s,Ce=a):ty(e)}}function ty(e){for(;Ce!==null;){var t=Ce;if(t.flags&8772){var r=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:jr||Ad(5,t);break;case 1:var n=t.stateNode;if(t.flags&4&&!jr)if(r===null)n.componentDidMount();else{var s=t.elementType===t.type?r.memoizedProps:rs(t.type,r.memoizedProps);n.componentDidUpdate(s,r.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var a=t.updateQueue;a!==null&&U1(t,a,n);break;case 3:var i=t.updateQueue;if(i!==null){if(r=null,t.child!==null)switch(t.child.tag){case 5:r=t.child.stateNode;break;case 1:r=t.child.stateNode}U1(t,i,r)}break;case 5:var o=t.stateNode;if(r===null&&t.flags&4){r=o;var l=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&r.focus();break;case"img":l.src&&(r.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var c=t.alternate;if(c!==null){var f=c.memoizedState;if(f!==null){var d=f.dehydrated;d!==null&&Vc(d)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(we(163))}jr||t.flags&512&&ep(t)}catch(m){Bt(t,t.return,m)}}if(t===e){Ce=null;break}if(r=t.sibling,r!==null){r.return=t.return,Ce=r;break}Ce=t.return}}function ry(e){for(;Ce!==null;){var t=Ce;if(t===e){Ce=null;break}var r=t.sibling;if(r!==null){r.return=t.return,Ce=r;break}Ce=t.return}}function ny(e){for(;Ce!==null;){var t=Ce;try{switch(t.tag){case 0:case 11:case 15:var r=t.return;try{Ad(4,t)}catch(l){Bt(t,r,l)}break;case 1:var n=t.stateNode;if(typeof n.componentDidMount=="function"){var s=t.return;try{n.componentDidMount()}catch(l){Bt(t,s,l)}}var a=t.return;try{ep(t)}catch(l){Bt(t,a,l)}break;case 5:var i=t.return;try{ep(t)}catch(l){Bt(t,i,l)}}}catch(l){Bt(t,t.return,l)}if(t===e){Ce=null;break}var o=t.sibling;if(o!==null){o.return=t.return,Ce=o;break}Ce=t.return}}var vb=Math.ceil,Rh=Ea.ReactCurrentDispatcher,Dg=Ea.ReactCurrentOwner,zn=Ea.ReactCurrentBatchConfig,ot=0,pr=null,tr=null,Tr=0,_n=0,Uo=gi(0),ir=0,Qc=null,Gi=0,Id=0,Fg=0,vc=null,un=null,Og=0,ol=1/0,Xs=null,Ph=!1,np=null,Ja=null,Sf=!1,Wa=null,Dh=0,yc=0,sp=null,Jf=-1,Zf=0;function Jr(){return ot&6?Kt():Jf!==-1?Jf:Jf=Kt()}function Za(e){return e.mode&1?ot&2&&Tr!==0?Tr&-Tr:tb.transition!==null?(Zf===0&&(Zf=$E()),Zf):(e=gt,e!==0||(e=window.event,e=e===void 0?16:QE(e.type)),e):1}function hs(e,t,r,n){if(50<yc)throw yc=0,sp=null,Error(we(185));Eu(e,r,n),(!(ot&2)||e!==pr)&&(e===pr&&(!(ot&2)&&(Id|=r),ir===4&&Ma(e,Tr)),gn(e,n),r===1&&ot===0&&!(t.mode&1)&&(ol=Kt()+500,Td&&xi()))}function gn(e,t){var r=e.callbackNode;tC(e,t);var n=gh(e,e===pr?Tr:0);if(n===0)r!==null&&h1(r),e.callbackNode=null,e.callbackPriority=0;else if(t=n&-n,e.callbackPriority!==t){if(r!=null&&h1(r),t===1)e.tag===0?eb(sy.bind(null,e)):g2(sy.bind(null,e)),XC(function(){!(ot&6)&&xi()}),r=null;else{switch(HE(n)){case 1:r=og;break;case 4:r=WE;break;case 16:r=ph;break;case 536870912:r=zE;break;default:r=ph}r=mT(r,oT.bind(null,e))}e.callbackPriority=t,e.callbackNode=r}}function oT(e,t){if(Jf=-1,Zf=0,ot&6)throw Error(we(327));var r=e.callbackNode;if(Go()&&e.callbackNode!==r)return null;var n=gh(e,e===pr?Tr:0);if(n===0)return null;if(n&30||n&e.expiredLanes||t)t=Fh(e,n);else{t=n;var s=ot;ot|=2;var a=cT();(pr!==e||Tr!==t)&&(Xs=null,ol=Kt()+500,Mi(e,t));do try{wb();break}catch(o){lT(e,o)}while(!0);_g(),Rh.current=a,ot=s,tr!==null?t=0:(pr=null,Tr=0,t=ir)}if(t!==0){if(t===2&&(s=Rm(e),s!==0&&(n=s,t=ap(e,s))),t===1)throw r=Qc,Mi(e,0),Ma(e,n),gn(e,Kt()),r;if(t===6)Ma(e,n);else{if(s=e.current.alternate,!(n&30)&&!yb(s)&&(t=Fh(e,n),t===2&&(a=Rm(e),a!==0&&(n=a,t=ap(e,a))),t===1))throw r=Qc,Mi(e,0),Ma(e,n),gn(e,Kt()),r;switch(e.finishedWork=s,e.finishedLanes=n,t){case 0:case 1:throw Error(we(345));case 2:ki(e,un,Xs);break;case 3:if(Ma(e,n),(n&130023424)===n&&(t=Og+500-Kt(),10<t)){if(gh(e,0)!==0)break;if(s=e.suspendedLanes,(s&n)!==n){Jr(),e.pingedLanes|=e.suspendedLanes&s;break}e.timeoutHandle=Um(ki.bind(null,e,un,Xs),t);break}ki(e,un,Xs);break;case 4:if(Ma(e,n),(n&4194240)===n)break;for(t=e.eventTimes,s=-1;0<n;){var i=31-fs(n);a=1<<i,i=t[i],i>s&&(s=i),n&=~a}if(n=s,n=Kt()-n,n=(120>n?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*vb(n/1960))-n,10<n){e.timeoutHandle=Um(ki.bind(null,e,un,Xs),n);break}ki(e,un,Xs);break;case 5:ki(e,un,Xs);break;default:throw Error(we(329))}}}return gn(e,Kt()),e.callbackNode===r?oT.bind(null,e):null}function ap(e,t){var r=vc;return e.current.memoizedState.isDehydrated&&(Mi(e,t).flags|=256),e=Fh(e,t),e!==2&&(t=un,un=r,t!==null&&ip(t)),e}function ip(e){un===null?un=e:un.push.apply(un,e)}function yb(e){for(var t=e;;){if(t.flags&16384){var r=t.updateQueue;if(r!==null&&(r=r.stores,r!==null))for(var n=0;n<r.length;n++){var s=r[n],a=s.getSnapshot;s=s.value;try{if(!ps(a(),s))return!1}catch{return!1}}}if(r=t.child,t.subtreeFlags&16384&&r!==null)r.return=t,t=r;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function Ma(e,t){for(t&=~Fg,t&=~Id,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var r=31-fs(t),n=1<<r;e[r]=-1,t&=~n}}function sy(e){if(ot&6)throw Error(we(327));Go();var t=gh(e,0);if(!(t&1))return gn(e,Kt()),null;var r=Fh(e,t);if(e.tag!==0&&r===2){var n=Rm(e);n!==0&&(t=n,r=ap(e,n))}if(r===1)throw r=Qc,Mi(e,0),Ma(e,t),gn(e,Kt()),r;if(r===6)throw Error(we(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,ki(e,un,Xs),gn(e,Kt()),null}function Mg(e,t){var r=ot;ot|=1;try{return e(t)}finally{ot=r,ot===0&&(ol=Kt()+500,Td&&xi())}}function Ki(e){Wa!==null&&Wa.tag===0&&!(ot&6)&&Go();var t=ot;ot|=1;var r=zn.transition,n=gt;try{if(zn.transition=null,gt=1,e)return e()}finally{gt=n,zn.transition=r,ot=t,!(ot&6)&&xi()}}function Lg(){_n=Uo.current,Ct(Uo)}function Mi(e,t){e.finishedWork=null,e.finishedLanes=0;var r=e.timeoutHandle;if(r!==-1&&(e.timeoutHandle=-1,YC(r)),tr!==null)for(r=tr.return;r!==null;){var n=r;switch(xg(n),n.tag){case 1:n=n.type.childContextTypes,n!=null&&wh();break;case 3:al(),Ct(mn),Ct($r),Ag();break;case 5:Sg(n);break;case 4:al();break;case 13:Ct(Mt);break;case 19:Ct(Mt);break;case 10:wg(n.type._context);break;case 22:case 23:Lg()}r=r.return}if(pr=e,tr=e=ei(e.current,null),Tr=_n=t,ir=0,Qc=null,Fg=Id=Gi=0,un=vc=null,bi!==null){for(t=0;t<bi.length;t++)if(r=bi[t],n=r.interleaved,n!==null){r.interleaved=null;var s=n.next,a=r.pending;if(a!==null){var i=a.next;a.next=s,n.next=i}r.pending=n}bi=null}return e}function lT(e,t){do{var r=tr;try{if(_g(),Yf.current=bh,Ch){for(var n=Lt.memoizedState;n!==null;){var s=n.queue;s!==null&&(s.pending=null),n=n.next}Ch=!1}if(Hi=0,mr=ar=Lt=null,gc=!1,qc=0,Dg.current=null,r===null||r.return===null){ir=1,Qc=t,tr=null;break}e:{var a=e,i=r.return,o=r,l=t;if(t=Tr,o.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var c=l,f=o,d=f.tag;if(!(f.mode&1)&&(d===0||d===11||d===15)){var m=f.alternate;m?(f.updateQueue=m.updateQueue,f.memoizedState=m.memoizedState,f.lanes=m.lanes):(f.updateQueue=null,f.memoizedState=null)}var p=H1(i);if(p!==null){p.flags&=-257,G1(p,i,o,a,t),p.mode&1&&$1(a,c,t),t=p,l=c;var x=t.updateQueue;if(x===null){var g=new Set;g.add(l),t.updateQueue=g}else x.add(l);break e}else{if(!(t&1)){$1(a,c,t),jg();break e}l=Error(we(426))}}else if(Dt&&o.mode&1){var w=H1(i);if(w!==null){!(w.flags&65536)&&(w.flags|=256),G1(w,i,o,a,t),vg(il(l,o));break e}}a=l=il(l,o),ir!==4&&(ir=2),vc===null?vc=[a]:vc.push(a),a=i;do{switch(a.tag){case 3:a.flags|=65536,t&=-t,a.lanes|=t;var k=H2(a,l,t);j1(a,k);break e;case 1:o=l;var E=a.type,y=a.stateNode;if(!(a.flags&128)&&(typeof E.getDerivedStateFromError=="function"||y!==null&&typeof y.componentDidCatch=="function"&&(Ja===null||!Ja.has(y)))){a.flags|=65536,t&=-t,a.lanes|=t;var I=G2(a,o,t);j1(a,I);break e}}a=a.return}while(a!==null)}fT(r)}catch(M){t=M,tr===r&&r!==null&&(tr=r=r.return);continue}break}while(!0)}function cT(){var e=Rh.current;return Rh.current=bh,e===null?bh:e}function jg(){(ir===0||ir===3||ir===2)&&(ir=4),pr===null||!(Gi&268435455)&&!(Id&268435455)||Ma(pr,Tr)}function Fh(e,t){var r=ot;ot|=2;var n=cT();(pr!==e||Tr!==t)&&(Xs=null,Mi(e,t));do try{_b();break}catch(s){lT(e,s)}while(!0);if(_g(),ot=r,Rh.current=n,tr!==null)throw Error(we(261));return pr=null,Tr=0,ir}function _b(){for(;tr!==null;)uT(tr)}function wb(){for(;tr!==null&&!GN();)uT(tr)}function uT(e){var t=dT(e.alternate,e,_n);e.memoizedProps=e.pendingProps,t===null?fT(e):tr=t,Dg.current=null}function fT(e){var t=e;do{var r=t.alternate;if(e=t.return,t.flags&32768){if(r=mb(r,t),r!==null){r.flags&=32767,tr=r;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{ir=6,tr=null;return}}else if(r=db(r,t,_n),r!==null){tr=r;return}if(t=t.sibling,t!==null){tr=t;return}tr=t=e}while(t!==null);ir===0&&(ir=5)}function ki(e,t,r){var n=gt,s=zn.transition;try{zn.transition=null,gt=1,Eb(e,t,r,n)}finally{zn.transition=s,gt=n}return null}function Eb(e,t,r,n){do Go();while(Wa!==null);if(ot&6)throw Error(we(327));r=e.finishedWork;var s=e.finishedLanes;if(r===null)return null;if(e.finishedWork=null,e.finishedLanes=0,r===e.current)throw Error(we(177));e.callbackNode=null,e.callbackPriority=0;var a=r.lanes|r.childLanes;if(rC(e,a),e===pr&&(tr=pr=null,Tr=0),!(r.subtreeFlags&2064)&&!(r.flags&2064)||Sf||(Sf=!0,mT(ph,function(){return Go(),null})),a=(r.flags&15990)!==0,r.subtreeFlags&15990||a){a=zn.transition,zn.transition=null;var i=gt;gt=1;var o=ot;ot|=4,Dg.current=null,gb(e,r),aT(r,e),WC(Lm),xh=!!Mm,Lm=Mm=null,e.current=r,xb(r),KN(),ot=o,gt=i,zn.transition=a}else e.current=r;if(Sf&&(Sf=!1,Wa=e,Dh=s),a=e.pendingLanes,a===0&&(Ja=null),XN(r.stateNode),gn(e,Kt()),t!==null)for(n=e.onRecoverableError,r=0;r<t.length;r++)s=t[r],n(s.value,{componentStack:s.stack,digest:s.digest});if(Ph)throw Ph=!1,e=np,np=null,e;return Dh&1&&e.tag!==0&&Go(),a=e.pendingLanes,a&1?e===sp?yc++:(yc=0,sp=e):yc=0,xi(),null}function Go(){if(Wa!==null){var e=HE(Dh),t=zn.transition,r=gt;try{if(zn.transition=null,gt=16>e?16:e,Wa===null)var n=!1;else{if(e=Wa,Wa=null,Dh=0,ot&6)throw Error(we(331));var s=ot;for(ot|=4,Ce=e.current;Ce!==null;){var a=Ce,i=a.child;if(Ce.flags&16){var o=a.deletions;if(o!==null){for(var l=0;l<o.length;l++){var c=o[l];for(Ce=c;Ce!==null;){var f=Ce;switch(f.tag){case 0:case 11:case 15:xc(8,f,a)}var d=f.child;if(d!==null)d.return=f,Ce=d;else for(;Ce!==null;){f=Ce;var m=f.sibling,p=f.return;if(rT(f),f===c){Ce=null;break}if(m!==null){m.return=p,Ce=m;break}Ce=p}}}var x=a.alternate;if(x!==null){var g=x.child;if(g!==null){x.child=null;do{var w=g.sibling;g.sibling=null,g=w}while(g!==null)}}Ce=a}}if(a.subtreeFlags&2064&&i!==null)i.return=a,Ce=i;else e:for(;Ce!==null;){if(a=Ce,a.flags&2048)switch(a.tag){case 0:case 11:case 15:xc(9,a,a.return)}var k=a.sibling;if(k!==null){k.return=a.return,Ce=k;break e}Ce=a.return}}var E=e.current;for(Ce=E;Ce!==null;){i=Ce;var y=i.child;if(i.subtreeFlags&2064&&y!==null)y.return=i,Ce=y;else e:for(i=E;Ce!==null;){if(o=Ce,o.flags&2048)try{switch(o.tag){case 0:case 11:case 15:Ad(9,o)}}catch(M){Bt(o,o.return,M)}if(o===i){Ce=null;break e}var I=o.sibling;if(I!==null){I.return=o.return,Ce=I;break e}Ce=o.return}}if(ot=s,xi(),As&&typeof As.onPostCommitFiberRoot=="function")try{As.onPostCommitFiberRoot(vd,e)}catch{}n=!0}return n}finally{gt=r,zn.transition=t}}return!1}function ay(e,t,r){t=il(r,t),t=H2(e,t,1),e=Qa(e,t,1),t=Jr(),e!==null&&(Eu(e,1,t),gn(e,t))}function Bt(e,t,r){if(e.tag===3)ay(e,e,r);else for(;t!==null;){if(t.tag===3){ay(t,e,r);break}else if(t.tag===1){var n=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof n.componentDidCatch=="function"&&(Ja===null||!Ja.has(n))){e=il(r,e),e=G2(t,e,1),t=Qa(t,e,1),e=Jr(),t!==null&&(Eu(t,1,e),gn(t,e));break}}t=t.return}}function Tb(e,t,r){var n=e.pingCache;n!==null&&n.delete(t),t=Jr(),e.pingedLanes|=e.suspendedLanes&r,pr===e&&(Tr&r)===r&&(ir===4||ir===3&&(Tr&130023424)===Tr&&500>Kt()-Og?Mi(e,0):Fg|=r),gn(e,t)}function hT(e,t){t===0&&(e.mode&1?(t=pf,pf<<=1,!(pf&130023424)&&(pf=4194304)):t=1);var r=Jr();e=ha(e,t),e!==null&&(Eu(e,t,r),gn(e,r))}function kb(e){var t=e.memoizedState,r=0;t!==null&&(r=t.retryLane),hT(e,r)}function Sb(e,t){var r=0;switch(e.tag){case 13:var n=e.stateNode,s=e.memoizedState;s!==null&&(r=s.retryLane);break;case 19:n=e.stateNode;break;default:throw Error(we(314))}n!==null&&n.delete(t),hT(e,r)}var dT;dT=function(e,t,r){if(e!==null)if(e.memoizedProps!==t.pendingProps||mn.current)hn=!0;else{if(!(e.lanes&r)&&!(t.flags&128))return hn=!1,hb(e,t,r);hn=!!(e.flags&131072)}else hn=!1,Dt&&t.flags&1048576&&x2(t,kh,t.index);switch(t.lanes=0,t.tag){case 2:var n=t.type;Qf(e,t),e=t.pendingProps;var s=rl(t,$r.current);Ho(t,r),s=Ng(null,t,n,e,s,r);var a=Cg();return t.flags|=1,typeof s=="object"&&s!==null&&typeof s.render=="function"&&s.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,pn(n)?(a=!0,Eh(t)):a=!1,t.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,Tg(t),s.updater=Sd,t.stateNode=s,s._reactInternals=t,Gm(t,n,e,r),t=Ym(null,t,n,!0,a,r)):(t.tag=0,Dt&&a&&gg(t),qr(null,t,s,r),t=t.child),t;case 16:n=t.elementType;e:{switch(Qf(e,t),e=t.pendingProps,s=n._init,n=s(n._payload),t.type=n,s=t.tag=Ib(n),e=rs(n,e),s){case 0:t=qm(null,t,n,e,r);break e;case 1:t=Y1(null,t,n,e,r);break e;case 11:t=K1(null,t,n,e,r);break e;case 14:t=q1(null,t,n,rs(n.type,e),r);break e}throw Error(we(306,n,""))}return t;case 0:return n=t.type,s=t.pendingProps,s=t.elementType===n?s:rs(n,s),qm(e,t,n,s,r);case 1:return n=t.type,s=t.pendingProps,s=t.elementType===n?s:rs(n,s),Y1(e,t,n,s,r);case 3:e:{if(X2(t),e===null)throw Error(we(387));n=t.pendingProps,a=t.memoizedState,s=a.element,T2(e,t),Ih(t,n,null,r);var i=t.memoizedState;if(n=i.element,a.isDehydrated)if(a={element:n,isDehydrated:!1,cache:i.cache,pendingSuspenseBoundaries:i.pendingSuspenseBoundaries,transitions:i.transitions},t.updateQueue.baseState=a,t.memoizedState=a,t.flags&256){s=il(Error(we(423)),t),t=X1(e,t,n,r,s);break e}else if(n!==s){s=il(Error(we(424)),t),t=X1(e,t,n,r,s);break e}else for(kn=Xa(t.stateNode.containerInfo.firstChild),An=t,Dt=!0,as=null,r=w2(t,null,n,r),t.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if(nl(),n===s){t=da(e,t,r);break e}qr(e,t,n,r)}t=t.child}return t;case 5:return k2(t),e===null&&zm(t),n=t.type,s=t.pendingProps,a=e!==null?e.memoizedProps:null,i=s.children,jm(n,s)?i=null:a!==null&&jm(n,a)&&(t.flags|=32),Y2(e,t),qr(e,t,i,r),t.child;case 6:return e===null&&zm(t),null;case 13:return Q2(e,t,r);case 4:return kg(t,t.stateNode.containerInfo),n=t.pendingProps,e===null?t.child=sl(t,null,n,r):qr(e,t,n,r),t.child;case 11:return n=t.type,s=t.pendingProps,s=t.elementType===n?s:rs(n,s),K1(e,t,n,s,r);case 7:return qr(e,t,t.pendingProps,r),t.child;case 8:return qr(e,t,t.pendingProps.children,r),t.child;case 12:return qr(e,t,t.pendingProps.children,r),t.child;case 10:e:{if(n=t.type._context,s=t.pendingProps,a=t.memoizedProps,i=s.value,Et(Sh,n._currentValue),n._currentValue=i,a!==null)if(ps(a.value,i)){if(a.children===s.children&&!mn.current){t=da(e,t,r);break e}}else for(a=t.child,a!==null&&(a.return=t);a!==null;){var o=a.dependencies;if(o!==null){i=a.child;for(var l=o.firstContext;l!==null;){if(l.context===n){if(a.tag===1){l=aa(-1,r&-r),l.tag=2;var c=a.updateQueue;if(c!==null){c=c.shared;var f=c.pending;f===null?l.next=l:(l.next=f.next,f.next=l),c.pending=l}}a.lanes|=r,l=a.alternate,l!==null&&(l.lanes|=r),$m(a.return,r,t),o.lanes|=r;break}l=l.next}}else if(a.tag===10)i=a.type===t.type?null:a.child;else if(a.tag===18){if(i=a.return,i===null)throw Error(we(341));i.lanes|=r,o=i.alternate,o!==null&&(o.lanes|=r),$m(i,r,t),i=a.sibling}else i=a.child;if(i!==null)i.return=a;else for(i=a;i!==null;){if(i===t){i=null;break}if(a=i.sibling,a!==null){a.return=i.return,i=a;break}i=i.return}a=i}qr(e,t,s.children,r),t=t.child}return t;case 9:return s=t.type,n=t.pendingProps.children,Ho(t,r),s=Gn(s),n=n(s),t.flags|=1,qr(e,t,n,r),t.child;case 14:return n=t.type,s=rs(n,t.pendingProps),s=rs(n.type,s),q1(e,t,n,s,r);case 15:return K2(e,t,t.type,t.pendingProps,r);case 17:return n=t.type,s=t.pendingProps,s=t.elementType===n?s:rs(n,s),Qf(e,t),t.tag=1,pn(n)?(e=!0,Eh(t)):e=!1,Ho(t,r),$2(t,n,s),Gm(t,n,s,r),Ym(null,t,n,!0,e,r);case 19:return J2(e,t,r);case 22:return q2(e,t,r)}throw Error(we(156,t.tag))};function mT(e,t){return BE(e,t)}function Ab(e,t,r,n){this.tag=e,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Wn(e,t,r,n){return new Ab(e,t,r,n)}function Ug(e){return e=e.prototype,!(!e||!e.isReactComponent)}function Ib(e){if(typeof e=="function")return Ug(e)?1:0;if(e!=null){if(e=e.$$typeof,e===sg)return 11;if(e===ag)return 14}return 2}function ei(e,t){var r=e.alternate;return r===null?(r=Wn(e.tag,t,e.key,e.mode),r.elementType=e.elementType,r.type=e.type,r.stateNode=e.stateNode,r.alternate=e,e.alternate=r):(r.pendingProps=t,r.type=e.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=e.flags&14680064,r.childLanes=e.childLanes,r.lanes=e.lanes,r.child=e.child,r.memoizedProps=e.memoizedProps,r.memoizedState=e.memoizedState,r.updateQueue=e.updateQueue,t=e.dependencies,r.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},r.sibling=e.sibling,r.index=e.index,r.ref=e.ref,r}function eh(e,t,r,n,s,a){var i=2;if(n=e,typeof e=="function")Ug(e)&&(i=1);else if(typeof e=="string")i=5;else e:switch(e){case Co:return Li(r.children,s,a,t);case ng:i=8,s|=8;break;case gm:return e=Wn(12,r,t,s|2),e.elementType=gm,e.lanes=a,e;case xm:return e=Wn(13,r,t,s),e.elementType=xm,e.lanes=a,e;case vm:return e=Wn(19,r,t,s),e.elementType=vm,e.lanes=a,e;case kE:return Nd(r,s,a,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case EE:i=10;break e;case TE:i=9;break e;case sg:i=11;break e;case ag:i=14;break e;case Da:i=16,n=null;break e}throw Error(we(130,e==null?e:typeof e,""))}return t=Wn(i,r,t,s),t.elementType=e,t.type=n,t.lanes=a,t}function Li(e,t,r,n){return e=Wn(7,e,n,t),e.lanes=r,e}function Nd(e,t,r,n){return e=Wn(22,e,n,t),e.elementType=kE,e.lanes=r,e.stateNode={isHidden:!1},e}function V0(e,t,r){return e=Wn(6,e,null,t),e.lanes=r,e}function B0(e,t,r){return t=Wn(4,e.children!==null?e.children:[],e.key,t),t.lanes=r,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function Nb(e,t,r,n,s){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=w0(0),this.expirationTimes=w0(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=w0(0),this.identifierPrefix=n,this.onRecoverableError=s,this.mutableSourceEagerHydrationData=null}function Vg(e,t,r,n,s,a,i,o,l){return e=new Nb(e,t,r,o,l),t===1?(t=1,a===!0&&(t|=8)):t=0,a=Wn(3,null,null,t),e.current=a,a.stateNode=e,a.memoizedState={element:n,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},Tg(a),e}function Cb(e,t,r){var n=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:No,key:n==null?null:""+n,children:e,containerInfo:t,implementation:r}}function pT(e){if(!e)return oi;e=e._reactInternals;e:{if(no(e)!==e||e.tag!==1)throw Error(we(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(pn(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(we(171))}if(e.tag===1){var r=e.type;if(pn(r))return p2(e,r,t)}return t}function gT(e,t,r,n,s,a,i,o,l){return e=Vg(r,n,!0,e,s,a,i,o,l),e.context=pT(null),r=e.current,n=Jr(),s=Za(r),a=aa(n,s),a.callback=t??null,Qa(r,a,s),e.current.lanes=s,Eu(e,s,n),gn(e,n),e}function Cd(e,t,r,n){var s=t.current,a=Jr(),i=Za(s);return r=pT(r),t.context===null?t.context=r:t.pendingContext=r,t=aa(a,i),t.payload={element:e},n=n===void 0?null:n,n!==null&&(t.callback=n),e=Qa(s,t,i),e!==null&&(hs(e,s,i,a),qf(e,s,i)),i}function Oh(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function iy(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var r=e.retryLane;e.retryLane=r!==0&&r<t?r:t}}function Bg(e,t){iy(e,t),(e=e.alternate)&&iy(e,t)}function bb(){return null}var xT=typeof reportError=="function"?reportError:function(e){console.error(e)};function Wg(e){this._internalRoot=e}bd.prototype.render=Wg.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(we(409));Cd(e,t,null,null)};bd.prototype.unmount=Wg.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;Ki(function(){Cd(null,e,null,null)}),t[fa]=null}};function bd(e){this._internalRoot=e}bd.prototype.unstable_scheduleHydration=function(e){if(e){var t=qE();e={blockedOn:null,target:e,priority:t};for(var r=0;r<Oa.length&&t!==0&&t<Oa[r].priority;r++);Oa.splice(r,0,e),r===0&&XE(e)}};function zg(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function Rd(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function oy(){}function Rb(e,t,r,n,s){if(s){if(typeof n=="function"){var a=n;n=function(){var c=Oh(i);a.call(c)}}var i=gT(t,n,e,0,null,!1,!1,"",oy);return e._reactRootContainer=i,e[fa]=i.current,zc(e.nodeType===8?e.parentNode:e),Ki(),i}for(;s=e.lastChild;)e.removeChild(s);if(typeof n=="function"){var o=n;n=function(){var c=Oh(l);o.call(c)}}var l=Vg(e,0,!1,null,null,!1,!1,"",oy);return e._reactRootContainer=l,e[fa]=l.current,zc(e.nodeType===8?e.parentNode:e),Ki(function(){Cd(t,l,r,n)}),l}function Pd(e,t,r,n,s){var a=r._reactRootContainer;if(a){var i=a;if(typeof s=="function"){var o=s;s=function(){var l=Oh(i);o.call(l)}}Cd(t,i,e,s)}else i=Rb(r,t,e,s,n);return Oh(i)}GE=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var r=ec(t.pendingLanes);r!==0&&(lg(t,r|1),gn(t,Kt()),!(ot&6)&&(ol=Kt()+500,xi()))}break;case 13:Ki(function(){var n=ha(e,1);if(n!==null){var s=Jr();hs(n,e,1,s)}}),Bg(e,1)}};cg=function(e){if(e.tag===13){var t=ha(e,134217728);if(t!==null){var r=Jr();hs(t,e,134217728,r)}Bg(e,134217728)}};KE=function(e){if(e.tag===13){var t=Za(e),r=ha(e,t);if(r!==null){var n=Jr();hs(r,e,t,n)}Bg(e,t)}};qE=function(){return gt};YE=function(e,t){var r=gt;try{return gt=e,t()}finally{gt=r}};Nm=function(e,t,r){switch(t){case"input":if(wm(e,r),t=r.name,r.type==="radio"&&t!=null){for(r=e;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<r.length;t++){var n=r[t];if(n!==e&&n.form===e.form){var s=Ed(n);if(!s)throw Error(we(90));AE(n),wm(n,s)}}}break;case"textarea":NE(e,r);break;case"select":t=r.value,t!=null&&Bo(e,!!r.multiple,t,!1)}};OE=Mg;ME=Ki;var Pb={usingClientEntryPoint:!1,Events:[ku,Do,Ed,DE,FE,Mg]},Kl={findFiberByHostInstance:Ci,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},Db={bundleType:Kl.bundleType,version:Kl.version,rendererPackageName:Kl.rendererPackageName,rendererConfig:Kl.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Ea.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=UE(e),e===null?null:e.stateNode},findFiberByHostInstance:Kl.findFiberByHostInstance||bb,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Af=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Af.isDisabled&&Af.supportsFiber)try{vd=Af.inject(Db),As=Af}catch{}}Rn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Pb;Rn.createPortal=function(e,t){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!zg(t))throw Error(we(200));return Cb(e,t,null,r)};Rn.createRoot=function(e,t){if(!zg(e))throw Error(we(299));var r=!1,n="",s=xT;return t!=null&&(t.unstable_strictMode===!0&&(r=!0),t.identifierPrefix!==void 0&&(n=t.identifierPrefix),t.onRecoverableError!==void 0&&(s=t.onRecoverableError)),t=Vg(e,1,!1,null,null,r,!1,n,s),e[fa]=t.current,zc(e.nodeType===8?e.parentNode:e),new Wg(t)};Rn.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(we(188)):(e=Object.keys(e).join(","),Error(we(268,e)));return e=UE(t),e=e===null?null:e.stateNode,e};Rn.flushSync=function(e){return Ki(e)};Rn.hydrate=function(e,t,r){if(!Rd(t))throw Error(we(200));return Pd(null,e,t,!0,r)};Rn.hydrateRoot=function(e,t,r){if(!zg(e))throw Error(we(405));var n=r!=null&&r.hydratedSources||null,s=!1,a="",i=xT;if(r!=null&&(r.unstable_strictMode===!0&&(s=!0),r.identifierPrefix!==void 0&&(a=r.identifierPrefix),r.onRecoverableError!==void 0&&(i=r.onRecoverableError)),t=gT(t,null,e,1,r??null,s,!1,a,i),e[fa]=t.current,zc(e),n)for(e=0;e<n.length;e++)r=n[e],s=r._getVersion,s=s(r._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[r,s]:t.mutableSourceEagerHydrationData.push(r,s);return new bd(t)};Rn.render=function(e,t,r){if(!Rd(t))throw Error(we(200));return Pd(null,e,t,!1,r)};Rn.unmountComponentAtNode=function(e){if(!Rd(e))throw Error(we(40));return e._reactRootContainer?(Ki(function(){Pd(null,null,e,!1,function(){e._reactRootContainer=null,e[fa]=null})}),!0):!1};Rn.unstable_batchedUpdates=Mg;Rn.unstable_renderSubtreeIntoContainer=function(e,t,r,n){if(!Rd(r))throw Error(we(200));if(e==null||e._reactInternals===void 0)throw Error(we(38));return Pd(e,t,r,!1,n)};Rn.version="18.3.1-next-f1338f8080-20240426";function vT(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(vT)}catch(e){console.error(e)}}vT(),vE.exports=Rn;var $g=vE.exports;const Fb=iE($g),Ob=aE({__proto__:null,default:Fb},[$g]);var ly=$g;mm.createRoot=ly.createRoot,mm.hydrateRoot=ly.hydrateRoot;/**
 * @remix-run/router v1.23.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Rt(){return Rt=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Rt.apply(this,arguments)}var er;(function(e){e.Pop="POP",e.Push="PUSH",e.Replace="REPLACE"})(er||(er={}));const cy="popstate";function Mb(e){e===void 0&&(e={});function t(n,s){let{pathname:a,search:i,hash:o}=n.location;return Jc("",{pathname:a,search:i,hash:o},s.state&&s.state.usr||null,s.state&&s.state.key||"default")}function r(n,s){return typeof s=="string"?s:qi(s)}return jb(t,r,null,e)}function Ke(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}function ll(e,t){if(!e){typeof console<"u"&&console.warn(t);try{throw new Error(t)}catch{}}}function Lb(){return Math.random().toString(36).substr(2,8)}function uy(e,t){return{usr:e.state,key:e.key,idx:t}}function Jc(e,t,r,n){return r===void 0&&(r=null),Rt({pathname:typeof e=="string"?e:e.pathname,search:"",hash:""},typeof t=="string"?vi(t):t,{state:r,key:t&&t.key||n||Lb()})}function qi(e){let{pathname:t="/",search:r="",hash:n=""}=e;return r&&r!=="?"&&(t+=r.charAt(0)==="?"?r:"?"+r),n&&n!=="#"&&(t+=n.charAt(0)==="#"?n:"#"+n),t}function vi(e){let t={};if(e){let r=e.indexOf("#");r>=0&&(t.hash=e.substr(r),e=e.substr(0,r));let n=e.indexOf("?");n>=0&&(t.search=e.substr(n),e=e.substr(0,n)),e&&(t.pathname=e)}return t}function jb(e,t,r,n){n===void 0&&(n={});let{window:s=document.defaultView,v5Compat:a=!1}=n,i=s.history,o=er.Pop,l=null,c=f();c==null&&(c=0,i.replaceState(Rt({},i.state,{idx:c}),""));function f(){return(i.state||{idx:null}).idx}function d(){o=er.Pop;let w=f(),k=w==null?null:w-c;c=w,l&&l({action:o,location:g.location,delta:k})}function m(w,k){o=er.Push;let E=Jc(g.location,w,k);c=f()+1;let y=uy(E,c),I=g.createHref(E);try{i.pushState(y,"",I)}catch(M){if(M instanceof DOMException&&M.name==="DataCloneError")throw M;s.location.assign(I)}a&&l&&l({action:o,location:g.location,delta:1})}function p(w,k){o=er.Replace;let E=Jc(g.location,w,k);c=f();let y=uy(E,c),I=g.createHref(E);i.replaceState(y,"",I),a&&l&&l({action:o,location:g.location,delta:0})}function x(w){let k=s.location.origin!=="null"?s.location.origin:s.location.href,E=typeof w=="string"?w:qi(w);return E=E.replace(/ $/,"%20"),Ke(k,"No window.location.(origin|href) available to create URL for href: "+E),new URL(E,k)}let g={get action(){return o},get location(){return e(s,i)},listen(w){if(l)throw new Error("A history only accepts one active listener");return s.addEventListener(cy,d),l=w,()=>{s.removeEventListener(cy,d),l=null}},createHref(w){return t(s,w)},createURL:x,encodeLocation(w){let k=x(w);return{pathname:k.pathname,search:k.search,hash:k.hash}},push:m,replace:p,go(w){return i.go(w)}};return g}var pt;(function(e){e.data="data",e.deferred="deferred",e.redirect="redirect",e.error="error"})(pt||(pt={}));const Ub=new Set(["lazy","caseSensitive","path","id","index","children"]);function Vb(e){return e.index===!0}function Mh(e,t,r,n){return r===void 0&&(r=[]),n===void 0&&(n={}),e.map((s,a)=>{let i=[...r,String(a)],o=typeof s.id=="string"?s.id:i.join("-");if(Ke(s.index!==!0||!s.children,"Cannot specify children on an index route"),Ke(!n[o],'Found a route id collision on id "'+o+`".  Route id's must be globally unique within Data Router usages`),Vb(s)){let l=Rt({},s,t(s),{id:o});return n[o]=l,l}else{let l=Rt({},s,t(s),{id:o,children:void 0});return n[o]=l,s.children&&(l.children=Mh(s.children,t,i,n)),l}})}function Ai(e,t,r){return r===void 0&&(r="/"),th(e,t,r,!1)}function th(e,t,r,n){let s=typeof t=="string"?vi(t):t,a=ma(s.pathname||"/",r);if(a==null)return null;let i=yT(e);Wb(i);let o=null;for(let l=0;o==null&&l<i.length;++l){let c=Zb(a);o=Qb(i[l],c,n)}return o}function Bb(e,t){let{route:r,pathname:n,params:s}=e;return{id:r.id,pathname:n,params:s,data:t[r.id],handle:r.handle}}function yT(e,t,r,n){t===void 0&&(t=[]),r===void 0&&(r=[]),n===void 0&&(n="");let s=(a,i,o)=>{let l={relativePath:o===void 0?a.path||"":o,caseSensitive:a.caseSensitive===!0,childrenIndex:i,route:a};l.relativePath.startsWith("/")&&(Ke(l.relativePath.startsWith(n),'Absolute route path "'+l.relativePath+'" nested under path '+('"'+n+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),l.relativePath=l.relativePath.slice(n.length));let c=ia([n,l.relativePath]),f=r.concat(l);a.children&&a.children.length>0&&(Ke(a.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+c+'".')),yT(a.children,t,f,c)),!(a.path==null&&!a.index)&&t.push({path:c,score:Yb(c,a.index),routesMeta:f})};return e.forEach((a,i)=>{var o;if(a.path===""||!((o=a.path)!=null&&o.includes("?")))s(a,i);else for(let l of _T(a.path))s(a,i,l)}),t}function _T(e){let t=e.split("/");if(t.length===0)return[];let[r,...n]=t,s=r.endsWith("?"),a=r.replace(/\?$/,"");if(n.length===0)return s?[a,""]:[a];let i=_T(n.join("/")),o=[];return o.push(...i.map(l=>l===""?a:[a,l].join("/"))),s&&o.push(...i),o.map(l=>e.startsWith("/")&&l===""?"/":l)}function Wb(e){e.sort((t,r)=>t.score!==r.score?r.score-t.score:Xb(t.routesMeta.map(n=>n.childrenIndex),r.routesMeta.map(n=>n.childrenIndex)))}const zb=/^:[\w-]+$/,$b=3,Hb=2,Gb=1,Kb=10,qb=-2,fy=e=>e==="*";function Yb(e,t){let r=e.split("/"),n=r.length;return r.some(fy)&&(n+=qb),t&&(n+=Hb),r.filter(s=>!fy(s)).reduce((s,a)=>s+(zb.test(a)?$b:a===""?Gb:Kb),n)}function Xb(e,t){return e.length===t.length&&e.slice(0,-1).every((n,s)=>n===t[s])?e[e.length-1]-t[t.length-1]:0}function Qb(e,t,r){r===void 0&&(r=!1);let{routesMeta:n}=e,s={},a="/",i=[];for(let o=0;o<n.length;++o){let l=n[o],c=o===n.length-1,f=a==="/"?t:t.slice(a.length)||"/",d=Lh({path:l.relativePath,caseSensitive:l.caseSensitive,end:c},f),m=l.route;if(!d&&c&&r&&!n[n.length-1].route.index&&(d=Lh({path:l.relativePath,caseSensitive:l.caseSensitive,end:!1},f)),!d)return null;Object.assign(s,d.params),i.push({params:s,pathname:ia([a,d.pathname]),pathnameBase:rR(ia([a,d.pathnameBase])),route:m}),d.pathnameBase!=="/"&&(a=ia([a,d.pathnameBase]))}return i}function Lh(e,t){typeof e=="string"&&(e={path:e,caseSensitive:!1,end:!0});let[r,n]=Jb(e.path,e.caseSensitive,e.end),s=t.match(r);if(!s)return null;let a=s[0],i=a.replace(/(.)\/+$/,"$1"),o=s.slice(1);return{params:n.reduce((c,f,d)=>{let{paramName:m,isOptional:p}=f;if(m==="*"){let g=o[d]||"";i=a.slice(0,a.length-g.length).replace(/(.)\/+$/,"$1")}const x=o[d];return p&&!x?c[m]=void 0:c[m]=(x||"").replace(/%2F/g,"/"),c},{}),pathname:a,pathnameBase:i,pattern:e}}function Jb(e,t,r){t===void 0&&(t=!1),r===void 0&&(r=!0),ll(e==="*"||!e.endsWith("*")||e.endsWith("/*"),'Route path "'+e+'" will be treated as if it were '+('"'+e.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+e.replace(/\*$/,"/*")+'".'));let n=[],s="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(i,o,l)=>(n.push({paramName:o,isOptional:l!=null}),l?"/?([^\\/]+)?":"/([^\\/]+)"));return e.endsWith("*")?(n.push({paramName:"*"}),s+=e==="*"||e==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):r?s+="\\/*$":e!==""&&e!=="/"&&(s+="(?:(?=\\/|$))"),[new RegExp(s,t?void 0:"i"),n]}function Zb(e){try{return e.split("/").map(t=>decodeURIComponent(t).replace(/\//g,"%2F")).join("/")}catch(t){return ll(!1,'The URL path "'+e+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+t+").")),e}}function ma(e,t){if(t==="/")return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let r=t.endsWith("/")?t.length-1:t.length,n=e.charAt(r);return n&&n!=="/"?null:e.slice(r)||"/"}function eR(e,t){t===void 0&&(t="/");let{pathname:r,search:n="",hash:s=""}=typeof e=="string"?vi(e):e;return{pathname:r?r.startsWith("/")?r:tR(r,t):t,search:nR(n),hash:sR(s)}}function tR(e,t){let r=t.replace(/\/+$/,"").split("/");return e.split("/").forEach(s=>{s===".."?r.length>1&&r.pop():s!=="."&&r.push(s)}),r.length>1?r.join("/"):"/"}function W0(e,t,r,n){return"Cannot include a '"+e+"' character in a manually specified "+("`to."+t+"` field ["+JSON.stringify(n)+"].  Please separate it out to the ")+("`to."+r+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function wT(e){return e.filter((t,r)=>r===0||t.route.path&&t.route.path.length>0)}function Dd(e,t){let r=wT(e);return t?r.map((n,s)=>s===r.length-1?n.pathname:n.pathnameBase):r.map(n=>n.pathnameBase)}function Fd(e,t,r,n){n===void 0&&(n=!1);let s;typeof e=="string"?s=vi(e):(s=Rt({},e),Ke(!s.pathname||!s.pathname.includes("?"),W0("?","pathname","search",s)),Ke(!s.pathname||!s.pathname.includes("#"),W0("#","pathname","hash",s)),Ke(!s.search||!s.search.includes("#"),W0("#","search","hash",s)));let a=e===""||s.pathname==="",i=a?"/":s.pathname,o;if(i==null)o=r;else{let d=t.length-1;if(!n&&i.startsWith("..")){let m=i.split("/");for(;m[0]==="..";)m.shift(),d-=1;s.pathname=m.join("/")}o=d>=0?t[d]:"/"}let l=eR(s,o),c=i&&i!=="/"&&i.endsWith("/"),f=(a||i===".")&&r.endsWith("/");return!l.pathname.endsWith("/")&&(c||f)&&(l.pathname+="/"),l}const ia=e=>e.join("/").replace(/\/\/+/g,"/"),rR=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),nR=e=>!e||e==="?"?"":e.startsWith("?")?e:"?"+e,sR=e=>!e||e==="#"?"":e.startsWith("#")?e:"#"+e;class jh{constructor(t,r,n,s){s===void 0&&(s=!1),this.status=t,this.statusText=r||"",this.internal=s,n instanceof Error?(this.data=n.toString(),this.error=n):this.data=n}}function Zc(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.internal=="boolean"&&"data"in e}const ET=["post","put","patch","delete"],aR=new Set(ET),iR=["get",...ET],oR=new Set(iR),lR=new Set([301,302,303,307,308]),cR=new Set([307,308]),z0={state:"idle",location:void 0,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0},uR={state:"idle",data:void 0,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0},ql={state:"unblocked",proceed:void 0,reset:void 0,location:void 0},Hg=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,fR=e=>({hasErrorBoundary:!!e.hasErrorBoundary}),TT="remix-router-transitions";function hR(e){const t=e.window?e.window:typeof window<"u"?window:void 0,r=typeof t<"u"&&typeof t.document<"u"&&typeof t.document.createElement<"u",n=!r;Ke(e.routes.length>0,"You must provide a non-empty routes array to createRouter");let s;if(e.mapRouteProperties)s=e.mapRouteProperties;else if(e.detectErrorBoundary){let X=e.detectErrorBoundary;s=te=>({hasErrorBoundary:X(te)})}else s=fR;let a={},i=Mh(e.routes,s,void 0,a),o,l=e.basename||"/",c=e.dataStrategy||gR,f=e.patchRoutesOnNavigation,d=Rt({v7_fetcherPersist:!1,v7_normalizeFormMethod:!1,v7_partialHydration:!1,v7_prependBasename:!1,v7_relativeSplatPath:!1,v7_skipActionErrorRevalidation:!1},e.future),m=null,p=new Set,x=null,g=null,w=null,k=e.hydrationData!=null,E=Ai(i,e.history.location,l),y=!1,I=null;if(E==null&&!f){let X=ln(404,{pathname:e.history.location.pathname}),{matches:te,route:le}=Ey(i);E=te,I={[le.id]:X}}E&&!e.hydrationData&&Ks(E,i,e.history.location.pathname).active&&(E=null);let M;if(E)if(E.some(X=>X.route.lazy))M=!1;else if(!E.some(X=>X.route.loader))M=!0;else if(d.v7_partialHydration){let X=e.hydrationData?e.hydrationData.loaderData:null,te=e.hydrationData?e.hydrationData.errors:null;if(te){let le=E.findIndex(xe=>te[xe.route.id]!==void 0);M=E.slice(0,le+1).every(xe=>!lp(xe.route,X,te))}else M=E.every(le=>!lp(le.route,X,te))}else M=e.hydrationData!=null;else if(M=!1,E=[],d.v7_partialHydration){let X=Ks(null,i,e.history.location.pathname);X.active&&X.matches&&(y=!0,E=X.matches)}let O,v={historyAction:e.history.action,location:e.history.location,matches:E,initialized:M,navigation:z0,restoreScrollPosition:e.hydrationData!=null?!1:null,preventScrollReset:!1,revalidation:"idle",loaderData:e.hydrationData&&e.hydrationData.loaderData||{},actionData:e.hydrationData&&e.hydrationData.actionData||null,errors:e.hydrationData&&e.hydrationData.errors||I,fetchers:new Map,blockers:new Map},T=er.Pop,S=!1,C,b=!1,P=new Map,D=null,ie=!1,Z=!1,fe=[],ue=new Set,q=new Map,G=0,ne=-1,ce=new Map,j=new Set,Y=new Map,K=new Map,V=new Set,J=new Map,de=new Map,Ee;function _e(){if(m=e.history.listen(X=>{let{action:te,location:le,delta:xe}=X;if(Ee){Ee(),Ee=void 0;return}ll(de.size===0||xe!=null,"You are trying to use a blocker on a POP navigation to a location that was not created by @remix-run/router. This will fail silently in production. This can happen if you are navigating outside the router via `window.history.pushState`/`window.location.hash` instead of using router navigation APIs.  This can also happen if you are using createHashRouter and the user manually changes the URL.");let Ie=Sa({currentLocation:v.location,nextLocation:le,historyAction:te});if(Ie&&xe!=null){let N=new Promise(B=>{Ee=B});e.history.go(xe*-1),xs(Ie,{state:"blocked",location:le,proceed(){xs(Ie,{state:"proceeding",proceed:void 0,reset:void 0,location:le}),N.then(()=>e.history.go(xe))},reset(){let B=new Map(v.blockers);B.set(Ie,ql),H({blockers:B})}});return}return De(te,le)}),r){bR(t,P);let X=()=>RR(t,P);t.addEventListener("pagehide",X),D=()=>t.removeEventListener("pagehide",X)}return v.initialized||De(er.Pop,v.location,{initialHydration:!0}),O}function pe(){m&&m(),D&&D(),p.clear(),C&&C.abort(),v.fetchers.forEach((X,te)=>yt(te)),v.blockers.forEach((X,te)=>$s(te))}function Ue(X){return p.add(X),()=>p.delete(X)}function H(X,te){te===void 0&&(te={}),v=Rt({},v,X);let le=[],xe=[];d.v7_fetcherPersist&&v.fetchers.forEach((Ie,N)=>{Ie.state==="idle"&&(V.has(N)?xe.push(N):le.push(N))}),V.forEach(Ie=>{!v.fetchers.has(Ie)&&!q.has(Ie)&&xe.push(Ie)}),[...p].forEach(Ie=>Ie(v,{deletedFetchers:xe,viewTransitionOpts:te.viewTransitionOpts,flushSync:te.flushSync===!0})),d.v7_fetcherPersist?(le.forEach(Ie=>v.fetchers.delete(Ie)),xe.forEach(Ie=>yt(Ie))):xe.forEach(Ie=>V.delete(Ie))}function tt(X,te,le){var xe,Ie;let{flushSync:N}=le===void 0?{}:le,B=v.actionData!=null&&v.navigation.formMethod!=null&&ss(v.navigation.formMethod)&&v.navigation.state==="loading"&&((xe=X.state)==null?void 0:xe._isRedirect)!==!0,R;te.actionData?Object.keys(te.actionData).length>0?R=te.actionData:R=null:B?R=v.actionData:R=null;let F=te.loaderData?_y(v.loaderData,te.loaderData,te.matches||[],te.errors):v.loaderData,L=v.blockers;L.size>0&&(L=new Map(L),L.forEach((ae,se)=>L.set(se,ql)));let U=S===!0||v.navigation.formMethod!=null&&ss(v.navigation.formMethod)&&((Ie=X.state)==null?void 0:Ie._isRedirect)!==!0;o&&(i=o,o=void 0),ie||T===er.Pop||(T===er.Push?e.history.push(X,X.state):T===er.Replace&&e.history.replace(X,X.state));let Q;if(T===er.Pop){let ae=P.get(v.location.pathname);ae&&ae.has(X.pathname)?Q={currentLocation:v.location,nextLocation:X}:P.has(X.pathname)&&(Q={currentLocation:X,nextLocation:v.location})}else if(b){let ae=P.get(v.location.pathname);ae?ae.add(X.pathname):(ae=new Set([X.pathname]),P.set(v.location.pathname,ae)),Q={currentLocation:v.location,nextLocation:X}}H(Rt({},te,{actionData:R,loaderData:F,historyAction:T,location:X,initialized:!0,navigation:z0,revalidation:"idle",restoreScrollPosition:Gs(X,te.matches||v.matches),preventScrollReset:U,blockers:L}),{viewTransitionOpts:Q,flushSync:N===!0}),T=er.Pop,S=!1,b=!1,ie=!1,Z=!1,fe=[]}async function He(X,te){if(typeof X=="number"){e.history.go(X);return}let le=op(v.location,v.matches,l,d.v7_prependBasename,X,d.v7_relativeSplatPath,te==null?void 0:te.fromRouteId,te==null?void 0:te.relative),{path:xe,submission:Ie,error:N}=hy(d.v7_normalizeFormMethod,!1,le,te),B=v.location,R=Jc(v.location,xe,te&&te.state);R=Rt({},R,e.history.encodeLocation(R));let F=te&&te.replace!=null?te.replace:void 0,L=er.Push;F===!0?L=er.Replace:F===!1||Ie!=null&&ss(Ie.formMethod)&&Ie.formAction===v.location.pathname+v.location.search&&(L=er.Replace);let U=te&&"preventScrollReset"in te?te.preventScrollReset===!0:void 0,Q=(te&&te.flushSync)===!0,ae=Sa({currentLocation:B,nextLocation:R,historyAction:L});if(ae){xs(ae,{state:"blocked",location:R,proceed(){xs(ae,{state:"proceeding",proceed:void 0,reset:void 0,location:R}),He(X,te)},reset(){let se=new Map(v.blockers);se.set(ae,ql),H({blockers:se})}});return}return await De(L,R,{submission:Ie,pendingError:N,preventScrollReset:U,replace:te&&te.replace,enableViewTransition:te&&te.viewTransition,flushSync:Q})}function Je(){if(St(),H({revalidation:"loading"}),v.navigation.state!=="submitting"){if(v.navigation.state==="idle"){De(v.historyAction,v.location,{startUninterruptedRevalidation:!0});return}De(T||v.historyAction,v.navigation.location,{overrideNavigation:v.navigation,enableViewTransition:b===!0})}}async function De(X,te,le){C&&C.abort(),C=null,T=X,ie=(le&&le.startUninterruptedRevalidation)===!0,go(v.location,v.matches),S=(le&&le.preventScrollReset)===!0,b=(le&&le.enableViewTransition)===!0;let xe=o||i,Ie=le&&le.overrideNavigation,N=le!=null&&le.initialHydration&&v.matches&&v.matches.length>0&&!y?v.matches:Ai(xe,te,l),B=(le&&le.flushSync)===!0;if(N&&v.initialized&&!Z&&ER(v.location,te)&&!(le&&le.submission&&ss(le.submission.formMethod))){tt(te,{matches:N},{flushSync:B});return}let R=Ks(N,xe,te.pathname);if(R.active&&R.matches&&(N=R.matches),!N){let{error:re,notFoundMatches:ee,route:me}=Qn(te.pathname);tt(te,{matches:ee,loaderData:{},errors:{[me.id]:re}},{flushSync:B});return}C=new AbortController;let F=Eo(e.history,te,C.signal,le&&le.submission),L;if(le&&le.pendingError)L=[Ii(N).route.id,{type:pt.error,error:le.pendingError}];else if(le&&le.submission&&ss(le.submission.formMethod)){let re=await Ae(F,te,le.submission,N,R.active,{replace:le.replace,flushSync:B});if(re.shortCircuited)return;if(re.pendingActionResult){let[ee,me]=re.pendingActionResult;if(wn(me)&&Zc(me.error)&&me.error.status===404){C=null,tt(te,{matches:re.matches,loaderData:{},errors:{[ee]:me.error}});return}}N=re.matches||N,L=re.pendingActionResult,Ie=$0(te,le.submission),B=!1,R.active=!1,F=Eo(e.history,F.url,F.signal)}let{shortCircuited:U,matches:Q,loaderData:ae,errors:se}=await _t(F,te,N,R.active,Ie,le&&le.submission,le&&le.fetcherSubmission,le&&le.replace,le&&le.initialHydration===!0,B,L);U||(C=null,tt(te,Rt({matches:Q||N},wy(L),{loaderData:ae,errors:se})))}async function Ae(X,te,le,xe,Ie,N){N===void 0&&(N={}),St();let B=NR(te,le);if(H({navigation:B},{flushSync:N.flushSync===!0}),Ie){let L=await On(xe,te.pathname,X.signal);if(L.type==="aborted")return{shortCircuited:!0};if(L.type==="error"){let U=Ii(L.partialMatches).route.id;return{matches:L.partialMatches,pendingActionResult:[U,{type:pt.error,error:L.error}]}}else if(L.matches)xe=L.matches;else{let{notFoundMatches:U,error:Q,route:ae}=Qn(te.pathname);return{matches:U,pendingActionResult:[ae.id,{type:pt.error,error:Q}]}}}let R,F=rc(xe,te);if(!F.route.action&&!F.route.lazy)R={type:pt.error,error:ln(405,{method:X.method,pathname:te.pathname,routeId:F.route.id})};else if(R=(await fr("action",v,X,[F],xe,null))[F.route.id],X.signal.aborted)return{shortCircuited:!0};if(Pi(R)){let L;return N&&N.replace!=null?L=N.replace:L=xy(R.response.headers.get("Location"),new URL(X.url),l)===v.location.pathname+v.location.search,await kt(X,R,!0,{submission:le,replace:L}),{shortCircuited:!0}}if(za(R))throw ln(400,{type:"defer-action"});if(wn(R)){let L=Ii(xe,F.route.id);return(N&&N.replace)!==!0&&(T=er.Push),{matches:xe,pendingActionResult:[L.route.id,R]}}return{matches:xe,pendingActionResult:[F.route.id,R]}}async function _t(X,te,le,xe,Ie,N,B,R,F,L,U){let Q=Ie||$0(te,N),ae=N||B||ky(Q),se=!ie&&(!d.v7_partialHydration||!F);if(xe){if(se){let ht=ur(U);H(Rt({navigation:Q},ht!==void 0?{actionData:ht}:{}),{flushSync:L})}let Ge=await On(le,te.pathname,X.signal);if(Ge.type==="aborted")return{shortCircuited:!0};if(Ge.type==="error"){let ht=Ii(Ge.partialMatches).route.id;return{matches:Ge.partialMatches,loaderData:{},errors:{[ht]:Ge.error}}}else if(Ge.matches)le=Ge.matches;else{let{error:ht,notFoundMatches:xr,route:Mn}=Qn(te.pathname);return{matches:xr,loaderData:{},errors:{[Mn.id]:ht}}}}let re=o||i,[ee,me]=my(e.history,v,le,ae,te,d.v7_partialHydration&&F===!0,d.v7_skipActionErrorRevalidation,Z,fe,ue,V,Y,j,re,l,U);if(Hs(Ge=>!(le&&le.some(ht=>ht.route.id===Ge))||ee&&ee.some(ht=>ht.route.id===Ge)),ne=++G,ee.length===0&&me.length===0){let Ge=zs();return tt(te,Rt({matches:le,loaderData:{},errors:U&&wn(U[1])?{[U[0]]:U[1].error}:null},wy(U),Ge?{fetchers:new Map(v.fetchers)}:{}),{flushSync:L}),{shortCircuited:!0}}if(se){let Ge={};if(!xe){Ge.navigation=Q;let ht=ur(U);ht!==void 0&&(Ge.actionData=ht)}me.length>0&&(Ge.fetchers=Cr(me)),H(Ge,{flushSync:L})}me.forEach(Ge=>{ft(Ge.key),Ge.controller&&q.set(Ge.key,Ge.controller)});let Te=()=>me.forEach(Ge=>ft(Ge.key));C&&C.signal.addEventListener("abort",Te);let{loaderResults:Ne,fetcherResults:ve}=await vt(v,le,ee,me,X);if(X.signal.aborted)return{shortCircuited:!0};C&&C.signal.removeEventListener("abort",Te),me.forEach(Ge=>q.delete(Ge.key));let ke=If(Ne);if(ke)return await kt(X,ke.result,!0,{replace:R}),{shortCircuited:!0};if(ke=If(ve),ke)return j.add(ke.key),await kt(X,ke.result,!0,{replace:R}),{shortCircuited:!0};let{loaderData:Fe,errors:it}=yy(v,le,Ne,U,me,ve,J);J.forEach((Ge,ht)=>{Ge.subscribe(xr=>{(xr||Ge.done)&&J.delete(ht)})}),d.v7_partialHydration&&F&&v.errors&&(it=Rt({},v.errors,it));let qe=zs(),mt=po(ne),on=qe||mt||me.length>0;return Rt({matches:le,loaderData:Fe,errors:it},on?{fetchers:new Map(v.fetchers)}:{})}function ur(X){if(X&&!wn(X[1]))return{[X[0]]:X[1].data};if(v.actionData)return Object.keys(v.actionData).length===0?null:v.actionData}function Cr(X){return X.forEach(te=>{let le=v.fetchers.get(te.key),xe=Yl(void 0,le?le.data:void 0);v.fetchers.set(te.key,xe)}),new Map(v.fetchers)}function sn(X,te,le,xe){if(n)throw new Error("router.fetch() was called during the server render, but it shouldn't be. You are likely calling a useFetcher() method in the body of your component. Try moving it to a useEffect or a callback.");ft(X);let Ie=(xe&&xe.flushSync)===!0,N=o||i,B=op(v.location,v.matches,l,d.v7_prependBasename,le,d.v7_relativeSplatPath,te,xe==null?void 0:xe.relative),R=Ai(N,B,l),F=Ks(R,N,B);if(F.active&&F.matches&&(R=F.matches),!R){Ot(X,te,ln(404,{pathname:B}),{flushSync:Ie});return}let{path:L,submission:U,error:Q}=hy(d.v7_normalizeFormMethod,!0,B,xe);if(Q){Ot(X,te,Q,{flushSync:Ie});return}let ae=rc(R,L),se=(xe&&xe.preventScrollReset)===!0;if(U&&ss(U.formMethod)){Ws(X,te,L,ae,R,F.active,Ie,se,U);return}Y.set(X,{routeId:te,path:L}),an(X,te,L,ae,R,F.active,Ie,se,U)}async function Ws(X,te,le,xe,Ie,N,B,R,F){St(),Y.delete(X);function L(rt){if(!rt.route.action&&!rt.route.lazy){let ys=ln(405,{method:F.formMethod,pathname:le,routeId:te});return Ot(X,te,ys,{flushSync:B}),!0}return!1}if(!N&&L(xe))return;let U=v.fetchers.get(X);dt(X,CR(F,U),{flushSync:B});let Q=new AbortController,ae=Eo(e.history,le,Q.signal,F);if(N){let rt=await On(Ie,new URL(ae.url).pathname,ae.signal,X);if(rt.type==="aborted")return;if(rt.type==="error"){Ot(X,te,rt.error,{flushSync:B});return}else if(rt.matches){if(Ie=rt.matches,xe=rc(Ie,le),L(xe))return}else{Ot(X,te,ln(404,{pathname:le}),{flushSync:B});return}}q.set(X,Q);let se=G,ee=(await fr("action",v,ae,[xe],Ie,X))[xe.route.id];if(ae.signal.aborted){q.get(X)===Q&&q.delete(X);return}if(d.v7_fetcherPersist&&V.has(X)){if(Pi(ee)||wn(ee)){dt(X,Pa(void 0));return}}else{if(Pi(ee))if(q.delete(X),ne>se){dt(X,Pa(void 0));return}else return j.add(X),dt(X,Yl(F)),kt(ae,ee,!1,{fetcherSubmission:F,preventScrollReset:R});if(wn(ee)){Ot(X,te,ee.error);return}}if(za(ee))throw ln(400,{type:"defer-action"});let me=v.navigation.location||v.location,Te=Eo(e.history,me,Q.signal),Ne=o||i,ve=v.navigation.state!=="idle"?Ai(Ne,v.navigation.location,l):v.matches;Ke(ve,"Didn't find any matches after fetcher action");let ke=++G;ce.set(X,ke);let Fe=Yl(F,ee.data);v.fetchers.set(X,Fe);let[it,qe]=my(e.history,v,ve,F,me,!1,d.v7_skipActionErrorRevalidation,Z,fe,ue,V,Y,j,Ne,l,[xe.route.id,ee]);qe.filter(rt=>rt.key!==X).forEach(rt=>{let ys=rt.key,Pl=v.fetchers.get(ys),Qu=Yl(void 0,Pl?Pl.data:void 0);v.fetchers.set(ys,Qu),ft(ys),rt.controller&&q.set(ys,rt.controller)}),H({fetchers:new Map(v.fetchers)});let mt=()=>qe.forEach(rt=>ft(rt.key));Q.signal.addEventListener("abort",mt);let{loaderResults:on,fetcherResults:Ge}=await vt(v,ve,it,qe,Te);if(Q.signal.aborted)return;Q.signal.removeEventListener("abort",mt),ce.delete(X),q.delete(X),qe.forEach(rt=>q.delete(rt.key));let ht=If(on);if(ht)return kt(Te,ht.result,!1,{preventScrollReset:R});if(ht=If(Ge),ht)return j.add(ht.key),kt(Te,ht.result,!1,{preventScrollReset:R});let{loaderData:xr,errors:Mn}=yy(v,ve,on,void 0,qe,Ge,J);if(v.fetchers.has(X)){let rt=Pa(ee.data);v.fetchers.set(X,rt)}po(ke),v.navigation.state==="loading"&&ke>ne?(Ke(T,"Expected pending action"),C&&C.abort(),tt(v.navigation.location,{matches:ve,loaderData:xr,errors:Mn,fetchers:new Map(v.fetchers)})):(H({errors:Mn,loaderData:_y(v.loaderData,xr,ve,Mn),fetchers:new Map(v.fetchers)}),Z=!1)}async function an(X,te,le,xe,Ie,N,B,R,F){let L=v.fetchers.get(X);dt(X,Yl(F,L?L.data:void 0),{flushSync:B});let U=new AbortController,Q=Eo(e.history,le,U.signal);if(N){let ee=await On(Ie,new URL(Q.url).pathname,Q.signal,X);if(ee.type==="aborted")return;if(ee.type==="error"){Ot(X,te,ee.error,{flushSync:B});return}else if(ee.matches)Ie=ee.matches,xe=rc(Ie,le);else{Ot(X,te,ln(404,{pathname:le}),{flushSync:B});return}}q.set(X,U);let ae=G,re=(await fr("loader",v,Q,[xe],Ie,X))[xe.route.id];if(za(re)&&(re=await Gg(re,Q.signal,!0)||re),q.get(X)===U&&q.delete(X),!Q.signal.aborted){if(V.has(X)){dt(X,Pa(void 0));return}if(Pi(re))if(ne>ae){dt(X,Pa(void 0));return}else{j.add(X),await kt(Q,re,!1,{preventScrollReset:R});return}if(wn(re)){Ot(X,te,re.error);return}Ke(!za(re),"Unhandled fetcher deferred data"),dt(X,Pa(re.data))}}async function kt(X,te,le,xe){let{submission:Ie,fetcherSubmission:N,preventScrollReset:B,replace:R}=xe===void 0?{}:xe;te.response.headers.has("X-Remix-Revalidate")&&(Z=!0);let F=te.response.headers.get("Location");Ke(F,"Expected a Location header on the redirect Response"),F=xy(F,new URL(X.url),l);let L=Jc(v.location,F,{_isRedirect:!0});if(r){let ee=!1;if(te.response.headers.has("X-Remix-Reload-Document"))ee=!0;else if(Hg.test(F)){const me=e.history.createURL(F);ee=me.origin!==t.location.origin||ma(me.pathname,l)==null}if(ee){R?t.location.replace(F):t.location.assign(F);return}}C=null;let U=R===!0||te.response.headers.has("X-Remix-Replace")?er.Replace:er.Push,{formMethod:Q,formAction:ae,formEncType:se}=v.navigation;!Ie&&!N&&Q&&ae&&se&&(Ie=ky(v.navigation));let re=Ie||N;if(cR.has(te.response.status)&&re&&ss(re.formMethod))await De(U,L,{submission:Rt({},re,{formAction:F}),preventScrollReset:B||S,enableViewTransition:le?b:void 0});else{let ee=$0(L,Ie);await De(U,L,{overrideNavigation:ee,fetcherSubmission:N,preventScrollReset:B||S,enableViewTransition:le?b:void 0})}}async function fr(X,te,le,xe,Ie,N){let B,R={};try{B=await xR(c,X,te,le,xe,Ie,N,a,s)}catch(F){return xe.forEach(L=>{R[L.route.id]={type:pt.error,error:F}}),R}for(let[F,L]of Object.entries(B))if(TR(L)){let U=L.result;R[F]={type:pt.redirect,response:_R(U,le,F,Ie,l,d.v7_relativeSplatPath)}}else R[F]=await yR(L);return R}async function vt(X,te,le,xe,Ie){let N=X.matches,B=fr("loader",X,Ie,le,te,null),R=Promise.all(xe.map(async U=>{if(U.matches&&U.match&&U.controller){let ae=(await fr("loader",X,Eo(e.history,U.path,U.controller.signal),[U.match],U.matches,U.key))[U.match.route.id];return{[U.key]:ae}}else return Promise.resolve({[U.key]:{type:pt.error,error:ln(404,{pathname:U.path})}})})),F=await B,L=(await R).reduce((U,Q)=>Object.assign(U,Q),{});return await Promise.all([AR(te,F,Ie.signal,N,X.loaderData),IR(te,L,xe)]),{loaderResults:F,fetcherResults:L}}function St(){Z=!0,fe.push(...Hs()),Y.forEach((X,te)=>{q.has(te)&&ue.add(te),ft(te)})}function dt(X,te,le){le===void 0&&(le={}),v.fetchers.set(X,te),H({fetchers:new Map(v.fetchers)},{flushSync:(le&&le.flushSync)===!0})}function Ot(X,te,le,xe){xe===void 0&&(xe={});let Ie=Ii(v.matches,te);yt(X),H({errors:{[Ie.route.id]:le},fetchers:new Map(v.fetchers)},{flushSync:(xe&&xe.flushSync)===!0})}function Ve(X){return K.set(X,(K.get(X)||0)+1),V.has(X)&&V.delete(X),v.fetchers.get(X)||uR}function yt(X){let te=v.fetchers.get(X);q.has(X)&&!(te&&te.state==="loading"&&ce.has(X))&&ft(X),Y.delete(X),ce.delete(X),j.delete(X),d.v7_fetcherPersist&&V.delete(X),ue.delete(X),v.fetchers.delete(X)}function Yt(X){let te=(K.get(X)||0)-1;te<=0?(K.delete(X),V.add(X),d.v7_fetcherPersist||yt(X)):K.set(X,te),H({fetchers:new Map(v.fetchers)})}function ft(X){let te=q.get(X);te&&(te.abort(),q.delete(X))}function vn(X){for(let te of X){let le=Ve(te),xe=Pa(le.data);v.fetchers.set(te,xe)}}function zs(){let X=[],te=!1;for(let le of j){let xe=v.fetchers.get(le);Ke(xe,"Expected fetcher: "+le),xe.state==="loading"&&(j.delete(le),X.push(le),te=!0)}return vn(X),te}function po(X){let te=[];for(let[le,xe]of ce)if(xe<X){let Ie=v.fetchers.get(le);Ke(Ie,"Expected fetcher: "+le),Ie.state==="loading"&&(ft(le),ce.delete(le),te.push(le))}return vn(te),te.length>0}function Rl(X,te){let le=v.blockers.get(X)||ql;return de.get(X)!==te&&de.set(X,te),le}function $s(X){v.blockers.delete(X),de.delete(X)}function xs(X,te){let le=v.blockers.get(X)||ql;Ke(le.state==="unblocked"&&te.state==="blocked"||le.state==="blocked"&&te.state==="blocked"||le.state==="blocked"&&te.state==="proceeding"||le.state==="blocked"&&te.state==="unblocked"||le.state==="proceeding"&&te.state==="unblocked","Invalid blocker state transition: "+le.state+" -> "+te.state);let xe=new Map(v.blockers);xe.set(X,te),H({blockers:xe})}function Sa(X){let{currentLocation:te,nextLocation:le,historyAction:xe}=X;if(de.size===0)return;de.size>1&&ll(!1,"A router only supports one blocker at a time");let Ie=Array.from(de.entries()),[N,B]=Ie[Ie.length-1],R=v.blockers.get(N);if(!(R&&R.state==="proceeding")&&B({currentLocation:te,nextLocation:le,historyAction:xe}))return N}function Qn(X){let te=ln(404,{pathname:X}),le=o||i,{matches:xe,route:Ie}=Ey(le);return Hs(),{notFoundMatches:xe,route:Ie,error:te}}function Hs(X){let te=[];return J.forEach((le,xe)=>{(!X||X(xe))&&(le.cancel(),te.push(xe),J.delete(xe))}),te}function vs(X,te,le){if(x=X,w=te,g=le||null,!k&&v.navigation===z0){k=!0;let xe=Gs(v.location,v.matches);xe!=null&&H({restoreScrollPosition:xe})}return()=>{x=null,w=null,g=null}}function Fn(X,te){return g&&g(X,te.map(xe=>Bb(xe,v.loaderData)))||X.key}function go(X,te){if(x&&w){let le=Fn(X,te);x[le]=w()}}function Gs(X,te){if(x){let le=Fn(X,te),xe=x[le];if(typeof xe=="number")return xe}return null}function Ks(X,te,le){if(f)if(X){if(Object.keys(X[0].params).length>0)return{active:!0,matches:th(te,le,l,!0)}}else return{active:!0,matches:th(te,le,l,!0)||[]};return{active:!1,matches:null}}async function On(X,te,le,xe){if(!f)return{type:"success",matches:X};let Ie=X;for(;;){let N=o==null,B=o||i,R=a;try{await f({signal:le,path:te,matches:Ie,fetcherKey:xe,patch:(U,Q)=>{le.aborted||gy(U,Q,B,R,s)}})}catch(U){return{type:"error",error:U,partialMatches:Ie}}finally{N&&!le.aborted&&(i=[...i])}if(le.aborted)return{type:"aborted"};let F=Ai(B,te,l);if(F)return{type:"success",matches:F};let L=th(B,te,l,!0);if(!L||Ie.length===L.length&&Ie.every((U,Q)=>U.route.id===L[Q].route.id))return{type:"success",matches:null};Ie=L}}function xo(X){a={},o=Mh(X,s,void 0,a)}function nr(X,te){let le=o==null;gy(X,te,o||i,a,s),le&&(i=[...i],H({}))}return O={get basename(){return l},get future(){return d},get state(){return v},get routes(){return i},get window(){return t},initialize:_e,subscribe:Ue,enableScrollRestoration:vs,navigate:He,fetch:sn,revalidate:Je,createHref:X=>e.history.createHref(X),encodeLocation:X=>e.history.encodeLocation(X),getFetcher:Ve,deleteFetcher:Yt,dispose:pe,getBlocker:Rl,deleteBlocker:$s,patchRoutes:nr,_internalFetchControllers:q,_internalActiveDeferreds:J,_internalSetRoutes:xo},O}function dR(e){return e!=null&&("formData"in e&&e.formData!=null||"body"in e&&e.body!==void 0)}function op(e,t,r,n,s,a,i,o){let l,c;if(i){l=[];for(let d of t)if(l.push(d),d.route.id===i){c=d;break}}else l=t,c=t[t.length-1];let f=Fd(s||".",Dd(l,a),ma(e.pathname,r)||e.pathname,o==="path");if(s==null&&(f.search=e.search,f.hash=e.hash),(s==null||s===""||s===".")&&c){let d=Kg(f.search);if(c.route.index&&!d)f.search=f.search?f.search.replace(/^\?/,"?index&"):"?index";else if(!c.route.index&&d){let m=new URLSearchParams(f.search),p=m.getAll("index");m.delete("index"),p.filter(g=>g).forEach(g=>m.append("index",g));let x=m.toString();f.search=x?"?"+x:""}}return n&&r!=="/"&&(f.pathname=f.pathname==="/"?r:ia([r,f.pathname])),qi(f)}function hy(e,t,r,n){if(!n||!dR(n))return{path:r};if(n.formMethod&&!SR(n.formMethod))return{path:r,error:ln(405,{method:n.formMethod})};let s=()=>({path:r,error:ln(400,{type:"invalid-body"})}),a=n.formMethod||"get",i=e?a.toUpperCase():a.toLowerCase(),o=AT(r);if(n.body!==void 0){if(n.formEncType==="text/plain"){if(!ss(i))return s();let m=typeof n.body=="string"?n.body:n.body instanceof FormData||n.body instanceof URLSearchParams?Array.from(n.body.entries()).reduce((p,x)=>{let[g,w]=x;return""+p+g+"="+w+`
`},""):String(n.body);return{path:r,submission:{formMethod:i,formAction:o,formEncType:n.formEncType,formData:void 0,json:void 0,text:m}}}else if(n.formEncType==="application/json"){if(!ss(i))return s();try{let m=typeof n.body=="string"?JSON.parse(n.body):n.body;return{path:r,submission:{formMethod:i,formAction:o,formEncType:n.formEncType,formData:void 0,json:m,text:void 0}}}catch{return s()}}}Ke(typeof FormData=="function","FormData is not available in this environment");let l,c;if(n.formData)l=cp(n.formData),c=n.formData;else if(n.body instanceof FormData)l=cp(n.body),c=n.body;else if(n.body instanceof URLSearchParams)l=n.body,c=vy(l);else if(n.body==null)l=new URLSearchParams,c=new FormData;else try{l=new URLSearchParams(n.body),c=vy(l)}catch{return s()}let f={formMethod:i,formAction:o,formEncType:n&&n.formEncType||"application/x-www-form-urlencoded",formData:c,json:void 0,text:void 0};if(ss(f.formMethod))return{path:r,submission:f};let d=vi(r);return t&&d.search&&Kg(d.search)&&l.append("index",""),d.search="?"+l,{path:qi(d),submission:f}}function dy(e,t,r){r===void 0&&(r=!1);let n=e.findIndex(s=>s.route.id===t);return n>=0?e.slice(0,r?n+1:n):e}function my(e,t,r,n,s,a,i,o,l,c,f,d,m,p,x,g){let w=g?wn(g[1])?g[1].error:g[1].data:void 0,k=e.createURL(t.location),E=e.createURL(s),y=r;a&&t.errors?y=dy(r,Object.keys(t.errors)[0],!0):g&&wn(g[1])&&(y=dy(r,g[0]));let I=g?g[1].statusCode:void 0,M=i&&I&&I>=400,O=y.filter((T,S)=>{let{route:C}=T;if(C.lazy)return!0;if(C.loader==null)return!1;if(a)return lp(C,t.loaderData,t.errors);if(mR(t.loaderData,t.matches[S],T)||l.some(D=>D===T.route.id))return!0;let b=t.matches[S],P=T;return py(T,Rt({currentUrl:k,currentParams:b.params,nextUrl:E,nextParams:P.params},n,{actionResult:w,actionStatus:I,defaultShouldRevalidate:M?!1:o||k.pathname+k.search===E.pathname+E.search||k.search!==E.search||kT(b,P)}))}),v=[];return d.forEach((T,S)=>{if(a||!r.some(ie=>ie.route.id===T.routeId)||f.has(S))return;let C=Ai(p,T.path,x);if(!C){v.push({key:S,routeId:T.routeId,path:T.path,matches:null,match:null,controller:null});return}let b=t.fetchers.get(S),P=rc(C,T.path),D=!1;m.has(S)?D=!1:c.has(S)?(c.delete(S),D=!0):b&&b.state!=="idle"&&b.data===void 0?D=o:D=py(P,Rt({currentUrl:k,currentParams:t.matches[t.matches.length-1].params,nextUrl:E,nextParams:r[r.length-1].params},n,{actionResult:w,actionStatus:I,defaultShouldRevalidate:M?!1:o})),D&&v.push({key:S,routeId:T.routeId,path:T.path,matches:C,match:P,controller:new AbortController})}),[O,v]}function lp(e,t,r){if(e.lazy)return!0;if(!e.loader)return!1;let n=t!=null&&t[e.id]!==void 0,s=r!=null&&r[e.id]!==void 0;return!n&&s?!1:typeof e.loader=="function"&&e.loader.hydrate===!0?!0:!n&&!s}function mR(e,t,r){let n=!t||r.route.id!==t.route.id,s=e[r.route.id]===void 0;return n||s}function kT(e,t){let r=e.route.path;return e.pathname!==t.pathname||r!=null&&r.endsWith("*")&&e.params["*"]!==t.params["*"]}function py(e,t){if(e.route.shouldRevalidate){let r=e.route.shouldRevalidate(t);if(typeof r=="boolean")return r}return t.defaultShouldRevalidate}function gy(e,t,r,n,s){var a;let i;if(e){let c=n[e];Ke(c,"No route found to patch children into: routeId = "+e),c.children||(c.children=[]),i=c.children}else i=r;let o=t.filter(c=>!i.some(f=>ST(c,f))),l=Mh(o,s,[e||"_","patch",String(((a=i)==null?void 0:a.length)||"0")],n);i.push(...l)}function ST(e,t){return"id"in e&&"id"in t&&e.id===t.id?!0:e.index===t.index&&e.path===t.path&&e.caseSensitive===t.caseSensitive?(!e.children||e.children.length===0)&&(!t.children||t.children.length===0)?!0:e.children.every((r,n)=>{var s;return(s=t.children)==null?void 0:s.some(a=>ST(r,a))}):!1}async function pR(e,t,r){if(!e.lazy)return;let n=await e.lazy();if(!e.lazy)return;let s=r[e.id];Ke(s,"No route found in manifest");let a={};for(let i in n){let l=s[i]!==void 0&&i!=="hasErrorBoundary";ll(!l,'Route "'+s.id+'" has a static property "'+i+'" defined but its lazy function is also returning a value for this property. '+('The lazy route property "'+i+'" will be ignored.')),!l&&!Ub.has(i)&&(a[i]=n[i])}Object.assign(s,a),Object.assign(s,Rt({},t(s),{lazy:void 0}))}async function gR(e){let{matches:t}=e,r=t.filter(s=>s.shouldLoad);return(await Promise.all(r.map(s=>s.resolve()))).reduce((s,a,i)=>Object.assign(s,{[r[i].route.id]:a}),{})}async function xR(e,t,r,n,s,a,i,o,l,c){let f=a.map(p=>p.route.lazy?pR(p.route,l,o):void 0),d=a.map((p,x)=>{let g=f[x],w=s.some(E=>E.route.id===p.route.id);return Rt({},p,{shouldLoad:w,resolve:async E=>(E&&n.method==="GET"&&(p.route.lazy||p.route.loader)&&(w=!0),w?vR(t,n,p,g,E,c):Promise.resolve({type:pt.data,result:void 0}))})}),m=await e({matches:d,request:n,params:a[0].params,fetcherKey:i,context:c});try{await Promise.all(f)}catch{}return m}async function vR(e,t,r,n,s,a){let i,o,l=c=>{let f,d=new Promise((x,g)=>f=g);o=()=>f(),t.signal.addEventListener("abort",o);let m=x=>typeof c!="function"?Promise.reject(new Error("You cannot call the handler for a route which defines a boolean "+('"'+e+'" [routeId: '+r.route.id+"]"))):c({request:t,params:r.params,context:a},...x!==void 0?[x]:[]),p=(async()=>{try{return{type:"data",result:await(s?s(g=>m(g)):m())}}catch(x){return{type:"error",result:x}}})();return Promise.race([p,d])};try{let c=r.route[e];if(n)if(c){let f,[d]=await Promise.all([l(c).catch(m=>{f=m}),n]);if(f!==void 0)throw f;i=d}else if(await n,c=r.route[e],c)i=await l(c);else if(e==="action"){let f=new URL(t.url),d=f.pathname+f.search;throw ln(405,{method:t.method,pathname:d,routeId:r.route.id})}else return{type:pt.data,result:void 0};else if(c)i=await l(c);else{let f=new URL(t.url),d=f.pathname+f.search;throw ln(404,{pathname:d})}Ke(i.result!==void 0,"You defined "+(e==="action"?"an action":"a loader")+" for route "+('"'+r.route.id+"\" but didn't return anything from your `"+e+"` ")+"function. Please return a value or `null`.")}catch(c){return{type:pt.error,result:c}}finally{o&&t.signal.removeEventListener("abort",o)}return i}async function yR(e){let{result:t,type:r}=e;if(IT(t)){let d;try{let m=t.headers.get("Content-Type");m&&/\bapplication\/json\b/.test(m)?t.body==null?d=null:d=await t.json():d=await t.text()}catch(m){return{type:pt.error,error:m}}return r===pt.error?{type:pt.error,error:new jh(t.status,t.statusText,d),statusCode:t.status,headers:t.headers}:{type:pt.data,data:d,statusCode:t.status,headers:t.headers}}if(r===pt.error){if(Ty(t)){var n,s;if(t.data instanceof Error){var a,i;return{type:pt.error,error:t.data,statusCode:(a=t.init)==null?void 0:a.status,headers:(i=t.init)!=null&&i.headers?new Headers(t.init.headers):void 0}}return{type:pt.error,error:new jh(((n=t.init)==null?void 0:n.status)||500,void 0,t.data),statusCode:Zc(t)?t.status:void 0,headers:(s=t.init)!=null&&s.headers?new Headers(t.init.headers):void 0}}return{type:pt.error,error:t,statusCode:Zc(t)?t.status:void 0}}if(kR(t)){var o,l;return{type:pt.deferred,deferredData:t,statusCode:(o=t.init)==null?void 0:o.status,headers:((l=t.init)==null?void 0:l.headers)&&new Headers(t.init.headers)}}if(Ty(t)){var c,f;return{type:pt.data,data:t.data,statusCode:(c=t.init)==null?void 0:c.status,headers:(f=t.init)!=null&&f.headers?new Headers(t.init.headers):void 0}}return{type:pt.data,data:t}}function _R(e,t,r,n,s,a){let i=e.headers.get("Location");if(Ke(i,"Redirects returned/thrown from loaders/actions must have a Location header"),!Hg.test(i)){let o=n.slice(0,n.findIndex(l=>l.route.id===r)+1);i=op(new URL(t.url),o,s,!0,i,a),e.headers.set("Location",i)}return e}function xy(e,t,r){if(Hg.test(e)){let n=e,s=n.startsWith("//")?new URL(t.protocol+n):new URL(n),a=ma(s.pathname,r)!=null;if(s.origin===t.origin&&a)return s.pathname+s.search+s.hash}return e}function Eo(e,t,r,n){let s=e.createURL(AT(t)).toString(),a={signal:r};if(n&&ss(n.formMethod)){let{formMethod:i,formEncType:o}=n;a.method=i.toUpperCase(),o==="application/json"?(a.headers=new Headers({"Content-Type":o}),a.body=JSON.stringify(n.json)):o==="text/plain"?a.body=n.text:o==="application/x-www-form-urlencoded"&&n.formData?a.body=cp(n.formData):a.body=n.formData}return new Request(s,a)}function cp(e){let t=new URLSearchParams;for(let[r,n]of e.entries())t.append(r,typeof n=="string"?n:n.name);return t}function vy(e){let t=new FormData;for(let[r,n]of e.entries())t.append(r,n);return t}function wR(e,t,r,n,s){let a={},i=null,o,l=!1,c={},f=r&&wn(r[1])?r[1].error:void 0;return e.forEach(d=>{if(!(d.route.id in t))return;let m=d.route.id,p=t[m];if(Ke(!Pi(p),"Cannot handle redirect results in processLoaderData"),wn(p)){let x=p.error;f!==void 0&&(x=f,f=void 0),i=i||{};{let g=Ii(e,m);i[g.route.id]==null&&(i[g.route.id]=x)}a[m]=void 0,l||(l=!0,o=Zc(p.error)?p.error.status:500),p.headers&&(c[m]=p.headers)}else za(p)?(n.set(m,p.deferredData),a[m]=p.deferredData.data,p.statusCode!=null&&p.statusCode!==200&&!l&&(o=p.statusCode),p.headers&&(c[m]=p.headers)):(a[m]=p.data,p.statusCode&&p.statusCode!==200&&!l&&(o=p.statusCode),p.headers&&(c[m]=p.headers))}),f!==void 0&&r&&(i={[r[0]]:f},a[r[0]]=void 0),{loaderData:a,errors:i,statusCode:o||200,loaderHeaders:c}}function yy(e,t,r,n,s,a,i){let{loaderData:o,errors:l}=wR(t,r,n,i);return s.forEach(c=>{let{key:f,match:d,controller:m}=c,p=a[f];if(Ke(p,"Did not find corresponding fetcher result"),!(m&&m.signal.aborted))if(wn(p)){let x=Ii(e.matches,d==null?void 0:d.route.id);l&&l[x.route.id]||(l=Rt({},l,{[x.route.id]:p.error})),e.fetchers.delete(f)}else if(Pi(p))Ke(!1,"Unhandled fetcher revalidation redirect");else if(za(p))Ke(!1,"Unhandled fetcher deferred data");else{let x=Pa(p.data);e.fetchers.set(f,x)}}),{loaderData:o,errors:l}}function _y(e,t,r,n){let s=Rt({},t);for(let a of r){let i=a.route.id;if(t.hasOwnProperty(i)?t[i]!==void 0&&(s[i]=t[i]):e[i]!==void 0&&a.route.loader&&(s[i]=e[i]),n&&n.hasOwnProperty(i))break}return s}function wy(e){return e?wn(e[1])?{actionData:{}}:{actionData:{[e[0]]:e[1].data}}:{}}function Ii(e,t){return(t?e.slice(0,e.findIndex(n=>n.route.id===t)+1):[...e]).reverse().find(n=>n.route.hasErrorBoundary===!0)||e[0]}function Ey(e){let t=e.length===1?e[0]:e.find(r=>r.index||!r.path||r.path==="/")||{id:"__shim-error-route__"};return{matches:[{params:{},pathname:"",pathnameBase:"",route:t}],route:t}}function ln(e,t){let{pathname:r,routeId:n,method:s,type:a,message:i}=t===void 0?{}:t,o="Unknown Server Error",l="Unknown @remix-run/router error";return e===400?(o="Bad Request",s&&r&&n?l="You made a "+s+' request to "'+r+'" but '+('did not provide a `loader` for route "'+n+'", ')+"so there is no way to handle the request.":a==="defer-action"?l="defer() is not supported in actions":a==="invalid-body"&&(l="Unable to encode submission body")):e===403?(o="Forbidden",l='Route "'+n+'" does not match URL "'+r+'"'):e===404?(o="Not Found",l='No route matches URL "'+r+'"'):e===405&&(o="Method Not Allowed",s&&r&&n?l="You made a "+s.toUpperCase()+' request to "'+r+'" but '+('did not provide an `action` for route "'+n+'", ')+"so there is no way to handle the request.":s&&(l='Invalid request method "'+s.toUpperCase()+'"')),new jh(e||500,o,new Error(l),!0)}function If(e){let t=Object.entries(e);for(let r=t.length-1;r>=0;r--){let[n,s]=t[r];if(Pi(s))return{key:n,result:s}}}function AT(e){let t=typeof e=="string"?vi(e):e;return qi(Rt({},t,{hash:""}))}function ER(e,t){return e.pathname!==t.pathname||e.search!==t.search?!1:e.hash===""?t.hash!=="":e.hash===t.hash?!0:t.hash!==""}function TR(e){return IT(e.result)&&lR.has(e.result.status)}function za(e){return e.type===pt.deferred}function wn(e){return e.type===pt.error}function Pi(e){return(e&&e.type)===pt.redirect}function Ty(e){return typeof e=="object"&&e!=null&&"type"in e&&"data"in e&&"init"in e&&e.type==="DataWithResponseInit"}function kR(e){let t=e;return t&&typeof t=="object"&&typeof t.data=="object"&&typeof t.subscribe=="function"&&typeof t.cancel=="function"&&typeof t.resolveData=="function"}function IT(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.headers=="object"&&typeof e.body<"u"}function SR(e){return oR.has(e.toLowerCase())}function ss(e){return aR.has(e.toLowerCase())}async function AR(e,t,r,n,s){let a=Object.entries(t);for(let i=0;i<a.length;i++){let[o,l]=a[i],c=e.find(m=>(m==null?void 0:m.route.id)===o);if(!c)continue;let f=n.find(m=>m.route.id===c.route.id),d=f!=null&&!kT(f,c)&&(s&&s[c.route.id])!==void 0;za(l)&&d&&await Gg(l,r,!1).then(m=>{m&&(t[o]=m)})}}async function IR(e,t,r){for(let n=0;n<r.length;n++){let{key:s,routeId:a,controller:i}=r[n],o=t[s];e.find(c=>(c==null?void 0:c.route.id)===a)&&za(o)&&(Ke(i,"Expected an AbortController for revalidating fetcher deferred result"),await Gg(o,i.signal,!0).then(c=>{c&&(t[s]=c)}))}}async function Gg(e,t,r){if(r===void 0&&(r=!1),!await e.deferredData.resolveData(t)){if(r)try{return{type:pt.data,data:e.deferredData.unwrappedData}}catch(s){return{type:pt.error,error:s}}return{type:pt.data,data:e.deferredData.data}}}function Kg(e){return new URLSearchParams(e).getAll("index").some(t=>t==="")}function rc(e,t){let r=typeof t=="string"?vi(t).search:t.search;if(e[e.length-1].route.index&&Kg(r||""))return e[e.length-1];let n=wT(e);return n[n.length-1]}function ky(e){let{formMethod:t,formAction:r,formEncType:n,text:s,formData:a,json:i}=e;if(!(!t||!r||!n)){if(s!=null)return{formMethod:t,formAction:r,formEncType:n,formData:void 0,json:void 0,text:s};if(a!=null)return{formMethod:t,formAction:r,formEncType:n,formData:a,json:void 0,text:void 0};if(i!==void 0)return{formMethod:t,formAction:r,formEncType:n,formData:void 0,json:i,text:void 0}}}function $0(e,t){return t?{state:"loading",location:e,formMethod:t.formMethod,formAction:t.formAction,formEncType:t.formEncType,formData:t.formData,json:t.json,text:t.text}:{state:"loading",location:e,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0}}function NR(e,t){return{state:"submitting",location:e,formMethod:t.formMethod,formAction:t.formAction,formEncType:t.formEncType,formData:t.formData,json:t.json,text:t.text}}function Yl(e,t){return e?{state:"loading",formMethod:e.formMethod,formAction:e.formAction,formEncType:e.formEncType,formData:e.formData,json:e.json,text:e.text,data:t}:{state:"loading",formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0,data:t}}function CR(e,t){return{state:"submitting",formMethod:e.formMethod,formAction:e.formAction,formEncType:e.formEncType,formData:e.formData,json:e.json,text:e.text,data:t?t.data:void 0}}function Pa(e){return{state:"idle",formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0,data:e}}function bR(e,t){try{let r=e.sessionStorage.getItem(TT);if(r){let n=JSON.parse(r);for(let[s,a]of Object.entries(n||{}))a&&Array.isArray(a)&&t.set(s,new Set(a||[]))}}catch{}}function RR(e,t){if(t.size>0){let r={};for(let[n,s]of t)r[n]=[...s];try{e.sessionStorage.setItem(TT,JSON.stringify(r))}catch(n){ll(!1,"Failed to save applied view transitions in sessionStorage ("+n+").")}}}/**
 * React Router v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Uh(){return Uh=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Uh.apply(this,arguments)}const Au=z.createContext(null),qg=z.createContext(null),Ta=z.createContext(null),Yg=z.createContext(null),Os=z.createContext({outlet:null,matches:[],isDataRoute:!1}),NT=z.createContext(null);function PR(e,t){let{relative:r}=t===void 0?{}:t;Tl()||Ke(!1);let{basename:n,navigator:s}=z.useContext(Ta),{hash:a,pathname:i,search:o}=Od(e,{relative:r}),l=i;return n!=="/"&&(l=i==="/"?n:ia([n,i])),s.createHref({pathname:l,search:o,hash:a})}function Tl(){return z.useContext(Yg)!=null}function Ms(){return Tl()||Ke(!1),z.useContext(Yg).location}function CT(e){z.useContext(Ta).static||z.useLayoutEffect(e)}function Ls(){let{isDataRoute:e}=z.useContext(Os);return e?GR():DR()}function DR(){Tl()||Ke(!1);let e=z.useContext(Au),{basename:t,future:r,navigator:n}=z.useContext(Ta),{matches:s}=z.useContext(Os),{pathname:a}=Ms(),i=JSON.stringify(Dd(s,r.v7_relativeSplatPath)),o=z.useRef(!1);return CT(()=>{o.current=!0}),z.useCallback(function(c,f){if(f===void 0&&(f={}),!o.current)return;if(typeof c=="number"){n.go(c);return}let d=Fd(c,JSON.parse(i),a,f.relative==="path");e==null&&t!=="/"&&(d.pathname=d.pathname==="/"?t:ia([t,d.pathname])),(f.replace?n.replace:n.push)(d,f.state,f)},[t,n,i,a,e])}const FR=z.createContext(null);function OR(e){let t=z.useContext(Os).outlet;return t&&z.createElement(FR.Provider,{value:e},t)}function Xg(){let{matches:e}=z.useContext(Os),t=e[e.length-1];return t?t.params:{}}function Od(e,t){let{relative:r}=t===void 0?{}:t,{future:n}=z.useContext(Ta),{matches:s}=z.useContext(Os),{pathname:a}=Ms(),i=JSON.stringify(Dd(s,n.v7_relativeSplatPath));return z.useMemo(()=>Fd(e,JSON.parse(i),a,r==="path"),[e,i,a,r])}function MR(e,t,r,n){Tl()||Ke(!1);let{navigator:s}=z.useContext(Ta),{matches:a}=z.useContext(Os),i=a[a.length-1],o=i?i.params:{};i&&i.pathname;let l=i?i.pathnameBase:"/";i&&i.route;let c=Ms(),f;f=c;let d=f.pathname||"/",m=d;if(l!=="/"){let g=l.replace(/^\//,"").split("/");m="/"+d.replace(/^\//,"").split("/").slice(g.length).join("/")}let p=Ai(e,{pathname:m});return BR(p&&p.map(g=>Object.assign({},g,{params:Object.assign({},o,g.params),pathname:ia([l,s.encodeLocation?s.encodeLocation(g.pathname).pathname:g.pathname]),pathnameBase:g.pathnameBase==="/"?l:ia([l,s.encodeLocation?s.encodeLocation(g.pathnameBase).pathname:g.pathnameBase])})),a,r,n)}function LR(){let e=HR(),t=Zc(e)?e.status+" "+e.statusText:e instanceof Error?e.message:JSON.stringify(e),r=e instanceof Error?e.stack:null,s={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return z.createElement(z.Fragment,null,z.createElement("h2",null,"Unexpected Application Error!"),z.createElement("h3",{style:{fontStyle:"italic"}},t),r?z.createElement("pre",{style:s},r):null,null)}const jR=z.createElement(LR,null);class UR extends z.Component{constructor(t){super(t),this.state={location:t.location,revalidation:t.revalidation,error:t.error}}static getDerivedStateFromError(t){return{error:t}}static getDerivedStateFromProps(t,r){return r.location!==t.location||r.revalidation!=="idle"&&t.revalidation==="idle"?{error:t.error,location:t.location,revalidation:t.revalidation}:{error:t.error!==void 0?t.error:r.error,location:r.location,revalidation:t.revalidation||r.revalidation}}componentDidCatch(t,r){console.error("React Router caught the following error during render",t,r)}render(){return this.state.error!==void 0?z.createElement(Os.Provider,{value:this.props.routeContext},z.createElement(NT.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function VR(e){let{routeContext:t,match:r,children:n}=e,s=z.useContext(Au);return s&&s.static&&s.staticContext&&(r.route.errorElement||r.route.ErrorBoundary)&&(s.staticContext._deepestRenderedBoundaryId=r.route.id),z.createElement(Os.Provider,{value:t},n)}function BR(e,t,r,n){var s;if(t===void 0&&(t=[]),r===void 0&&(r=null),n===void 0&&(n=null),e==null){var a;if(!r)return null;if(r.errors)e=r.matches;else if((a=n)!=null&&a.v7_partialHydration&&t.length===0&&!r.initialized&&r.matches.length>0)e=r.matches;else return null}let i=e,o=(s=r)==null?void 0:s.errors;if(o!=null){let f=i.findIndex(d=>d.route.id&&(o==null?void 0:o[d.route.id])!==void 0);f>=0||Ke(!1),i=i.slice(0,Math.min(i.length,f+1))}let l=!1,c=-1;if(r&&n&&n.v7_partialHydration)for(let f=0;f<i.length;f++){let d=i[f];if((d.route.HydrateFallback||d.route.hydrateFallbackElement)&&(c=f),d.route.id){let{loaderData:m,errors:p}=r,x=d.route.loader&&m[d.route.id]===void 0&&(!p||p[d.route.id]===void 0);if(d.route.lazy||x){l=!0,c>=0?i=i.slice(0,c+1):i=[i[0]];break}}}return i.reduceRight((f,d,m)=>{let p,x=!1,g=null,w=null;r&&(p=o&&d.route.id?o[d.route.id]:void 0,g=d.route.errorElement||jR,l&&(c<0&&m===0?(KR("route-fallback"),x=!0,w=null):c===m&&(x=!0,w=d.route.hydrateFallbackElement||null)));let k=t.concat(i.slice(0,m+1)),E=()=>{let y;return p?y=g:x?y=w:d.route.Component?y=z.createElement(d.route.Component,null):d.route.element?y=d.route.element:y=f,z.createElement(VR,{match:d,routeContext:{outlet:f,matches:k,isDataRoute:r!=null},children:y})};return r&&(d.route.ErrorBoundary||d.route.errorElement||m===0)?z.createElement(UR,{location:r.location,revalidation:r.revalidation,component:g,error:p,children:E(),routeContext:{outlet:null,matches:k,isDataRoute:!0}}):E()},null)}var bT=function(e){return e.UseBlocker="useBlocker",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e}(bT||{}),RT=function(e){return e.UseBlocker="useBlocker",e.UseLoaderData="useLoaderData",e.UseActionData="useActionData",e.UseRouteError="useRouteError",e.UseNavigation="useNavigation",e.UseRouteLoaderData="useRouteLoaderData",e.UseMatches="useMatches",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e.UseRouteId="useRouteId",e}(RT||{});function WR(e){let t=z.useContext(Au);return t||Ke(!1),t}function zR(e){let t=z.useContext(qg);return t||Ke(!1),t}function $R(e){let t=z.useContext(Os);return t||Ke(!1),t}function PT(e){let t=$R(),r=t.matches[t.matches.length-1];return r.route.id||Ke(!1),r.route.id}function HR(){var e;let t=z.useContext(NT),r=zR(RT.UseRouteError),n=PT();return t!==void 0?t:(e=r.errors)==null?void 0:e[n]}function GR(){let{router:e}=WR(bT.UseNavigateStable),t=PT(),r=z.useRef(!1);return CT(()=>{r.current=!0}),z.useCallback(function(s,a){a===void 0&&(a={}),r.current&&(typeof s=="number"?e.navigate(s):e.navigate(s,Uh({fromRouteId:t},a)))},[e,t])}const Sy={};function KR(e,t,r){Sy[e]||(Sy[e]=!0)}function qR(e,t){e==null||e.v7_startTransition,(e==null?void 0:e.v7_relativeSplatPath)===void 0&&(!t||t.v7_relativeSplatPath),t&&(t.v7_fetcherPersist,t.v7_normalizeFormMethod,t.v7_partialHydration,t.v7_skipActionErrorRevalidation)}function YR(e){let{to:t,replace:r,state:n,relative:s}=e;Tl()||Ke(!1);let{future:a,static:i}=z.useContext(Ta),{matches:o}=z.useContext(Os),{pathname:l}=Ms(),c=Ls(),f=Fd(t,Dd(o,a.v7_relativeSplatPath),l,s==="path"),d=JSON.stringify(f);return z.useEffect(()=>c(JSON.parse(d),{replace:r,state:n,relative:s}),[c,d,s,r,n]),null}function DT(e){return OR(e.context)}function XR(e){let{basename:t="/",children:r=null,location:n,navigationType:s=er.Pop,navigator:a,static:i=!1,future:o}=e;Tl()&&Ke(!1);let l=t.replace(/^\/*/,"/"),c=z.useMemo(()=>({basename:l,navigator:a,static:i,future:Uh({v7_relativeSplatPath:!1},o)}),[l,o,a,i]);typeof n=="string"&&(n=vi(n));let{pathname:f="/",search:d="",hash:m="",state:p=null,key:x="default"}=n,g=z.useMemo(()=>{let w=ma(f,l);return w==null?null:{location:{pathname:w,search:d,hash:m,state:p,key:x},navigationType:s}},[l,f,d,m,p,x,s]);return g==null?null:z.createElement(Ta.Provider,{value:c},z.createElement(Yg.Provider,{children:r,value:g}))}new Promise(()=>{});function QR(e){let t={hasErrorBoundary:e.ErrorBoundary!=null||e.errorElement!=null};return e.Component&&Object.assign(t,{element:z.createElement(e.Component),Component:void 0}),e.HydrateFallback&&Object.assign(t,{hydrateFallbackElement:z.createElement(e.HydrateFallback),HydrateFallback:void 0}),e.ErrorBoundary&&Object.assign(t,{errorElement:z.createElement(e.ErrorBoundary),ErrorBoundary:void 0}),t}/**
 * React Router DOM v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function cl(){return cl=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},cl.apply(this,arguments)}function FT(e,t){if(e==null)return{};var r={},n=Object.keys(e),s,a;for(a=0;a<n.length;a++)s=n[a],!(t.indexOf(s)>=0)&&(r[s]=e[s]);return r}function JR(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}function ZR(e,t){return e.button===0&&(!t||t==="_self")&&!JR(e)}function up(e){return e===void 0&&(e=""),new URLSearchParams(typeof e=="string"||Array.isArray(e)||e instanceof URLSearchParams?e:Object.keys(e).reduce((t,r)=>{let n=e[r];return t.concat(Array.isArray(n)?n.map(s=>[r,s]):[[r,n]])},[]))}function e4(e,t){let r=up(e);return t&&t.forEach((n,s)=>{r.has(s)||t.getAll(s).forEach(a=>{r.append(s,a)})}),r}const t4=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],r4=["aria-current","caseSensitive","className","end","style","to","viewTransition","children"],n4="6";try{window.__reactRouterVersion=n4}catch{}function s4(e,t){return hR({basename:void 0,future:cl({},void 0,{v7_prependBasename:!0}),history:Mb({window:void 0}),hydrationData:a4(),routes:e,mapRouteProperties:QR,dataStrategy:void 0,patchRoutesOnNavigation:void 0,window:void 0}).initialize()}function a4(){var e;let t=(e=window)==null?void 0:e.__staticRouterHydrationData;return t&&t.errors&&(t=cl({},t,{errors:i4(t.errors)})),t}function i4(e){if(!e)return null;let t=Object.entries(e),r={};for(let[n,s]of t)if(s&&s.__type==="RouteErrorResponse")r[n]=new jh(s.status,s.statusText,s.data,s.internal===!0);else if(s&&s.__type==="Error"){if(s.__subType){let a=window[s.__subType];if(typeof a=="function")try{let i=new a(s.message);i.stack="",r[n]=i}catch{}}if(r[n]==null){let a=new Error(s.message);a.stack="",r[n]=a}}else r[n]=s;return r}const OT=z.createContext({isTransitioning:!1}),o4=z.createContext(new Map),l4="startTransition",Ay=TN[l4],c4="flushSync",Iy=Ob[c4];function u4(e){Ay?Ay(e):e()}function Xl(e){Iy?Iy(e):e()}let f4=class{constructor(){this.status="pending",this.promise=new Promise((t,r)=>{this.resolve=n=>{this.status==="pending"&&(this.status="resolved",t(n))},this.reject=n=>{this.status==="pending"&&(this.status="rejected",r(n))}})}};function h4(e){let{fallbackElement:t,router:r,future:n}=e,[s,a]=z.useState(r.state),[i,o]=z.useState(),[l,c]=z.useState({isTransitioning:!1}),[f,d]=z.useState(),[m,p]=z.useState(),[x,g]=z.useState(),w=z.useRef(new Map),{v7_startTransition:k}=n||{},E=z.useCallback(T=>{k?u4(T):T()},[k]),y=z.useCallback((T,S)=>{let{deletedFetchers:C,flushSync:b,viewTransitionOpts:P}=S;T.fetchers.forEach((ie,Z)=>{ie.data!==void 0&&w.current.set(Z,ie.data)}),C.forEach(ie=>w.current.delete(ie));let D=r.window==null||r.window.document==null||typeof r.window.document.startViewTransition!="function";if(!P||D){b?Xl(()=>a(T)):E(()=>a(T));return}if(b){Xl(()=>{m&&(f&&f.resolve(),m.skipTransition()),c({isTransitioning:!0,flushSync:!0,currentLocation:P.currentLocation,nextLocation:P.nextLocation})});let ie=r.window.document.startViewTransition(()=>{Xl(()=>a(T))});ie.finished.finally(()=>{Xl(()=>{d(void 0),p(void 0),o(void 0),c({isTransitioning:!1})})}),Xl(()=>p(ie));return}m?(f&&f.resolve(),m.skipTransition(),g({state:T,currentLocation:P.currentLocation,nextLocation:P.nextLocation})):(o(T),c({isTransitioning:!0,flushSync:!1,currentLocation:P.currentLocation,nextLocation:P.nextLocation}))},[r.window,m,f,w,E]);z.useLayoutEffect(()=>r.subscribe(y),[r,y]),z.useEffect(()=>{l.isTransitioning&&!l.flushSync&&d(new f4)},[l]),z.useEffect(()=>{if(f&&i&&r.window){let T=i,S=f.promise,C=r.window.document.startViewTransition(async()=>{E(()=>a(T)),await S});C.finished.finally(()=>{d(void 0),p(void 0),o(void 0),c({isTransitioning:!1})}),p(C)}},[E,i,f,r.window]),z.useEffect(()=>{f&&i&&s.location.key===i.location.key&&f.resolve()},[f,m,s.location,i]),z.useEffect(()=>{!l.isTransitioning&&x&&(o(x.state),c({isTransitioning:!0,flushSync:!1,currentLocation:x.currentLocation,nextLocation:x.nextLocation}),g(void 0))},[l.isTransitioning,x]),z.useEffect(()=>{},[]);let I=z.useMemo(()=>({createHref:r.createHref,encodeLocation:r.encodeLocation,go:T=>r.navigate(T),push:(T,S,C)=>r.navigate(T,{state:S,preventScrollReset:C==null?void 0:C.preventScrollReset}),replace:(T,S,C)=>r.navigate(T,{replace:!0,state:S,preventScrollReset:C==null?void 0:C.preventScrollReset})}),[r]),M=r.basename||"/",O=z.useMemo(()=>({router:r,navigator:I,static:!1,basename:M}),[r,I,M]),v=z.useMemo(()=>({v7_relativeSplatPath:r.future.v7_relativeSplatPath}),[r.future.v7_relativeSplatPath]);return z.useEffect(()=>qR(n,r.future),[n,r.future]),z.createElement(z.Fragment,null,z.createElement(Au.Provider,{value:O},z.createElement(qg.Provider,{value:s},z.createElement(o4.Provider,{value:w.current},z.createElement(OT.Provider,{value:l},z.createElement(XR,{basename:M,location:s.location,navigationType:s.historyAction,navigator:I,future:v},s.initialized||r.future.v7_partialHydration?z.createElement(d4,{routes:r.routes,future:r.future,state:s}):t))))),null)}const d4=z.memo(m4);function m4(e){let{routes:t,future:r,state:n}=e;return MR(t,void 0,n,r)}const p4=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",g4=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Xe=z.forwardRef(function(t,r){let{onClick:n,relative:s,reloadDocument:a,replace:i,state:o,target:l,to:c,preventScrollReset:f,viewTransition:d}=t,m=FT(t,t4),{basename:p}=z.useContext(Ta),x,g=!1;if(typeof c=="string"&&g4.test(c)&&(x=c,p4))try{let y=new URL(window.location.href),I=c.startsWith("//")?new URL(y.protocol+c):new URL(c),M=ma(I.pathname,p);I.origin===y.origin&&M!=null?c=M+I.search+I.hash:g=!0}catch{}let w=PR(c,{relative:s}),k=v4(c,{replace:i,state:o,target:l,preventScrollReset:f,relative:s,viewTransition:d});function E(y){n&&n(y),y.defaultPrevented||k(y)}return z.createElement("a",cl({},m,{href:x||w,onClick:g||a?n:E,ref:r,target:l}))}),Ca=z.forwardRef(function(t,r){let{"aria-current":n="page",caseSensitive:s=!1,className:a="",end:i=!1,style:o,to:l,viewTransition:c,children:f}=t,d=FT(t,r4),m=Od(l,{relative:d.relative}),p=Ms(),x=z.useContext(qg),{navigator:g,basename:w}=z.useContext(Ta),k=x!=null&&_4(m)&&c===!0,E=g.encodeLocation?g.encodeLocation(m).pathname:m.pathname,y=p.pathname,I=x&&x.navigation&&x.navigation.location?x.navigation.location.pathname:null;s||(y=y.toLowerCase(),I=I?I.toLowerCase():null,E=E.toLowerCase()),I&&w&&(I=ma(I,w)||I);const M=E!=="/"&&E.endsWith("/")?E.length-1:E.length;let O=y===E||!i&&y.startsWith(E)&&y.charAt(M)==="/",v=I!=null&&(I===E||!i&&I.startsWith(E)&&I.charAt(E.length)==="/"),T={isActive:O,isPending:v,isTransitioning:k},S=O?n:void 0,C;typeof a=="function"?C=a(T):C=[a,O?"active":null,v?"pending":null,k?"transitioning":null].filter(Boolean).join(" ");let b=typeof o=="function"?o(T):o;return z.createElement(Xe,cl({},d,{"aria-current":S,className:C,ref:r,style:b,to:l,viewTransition:c}),typeof f=="function"?f(T):f)});var fp;(function(e){e.UseScrollRestoration="useScrollRestoration",e.UseSubmit="useSubmit",e.UseSubmitFetcher="useSubmitFetcher",e.UseFetcher="useFetcher",e.useViewTransitionState="useViewTransitionState"})(fp||(fp={}));var Ny;(function(e){e.UseFetcher="useFetcher",e.UseFetchers="useFetchers",e.UseScrollRestoration="useScrollRestoration"})(Ny||(Ny={}));function x4(e){let t=z.useContext(Au);return t||Ke(!1),t}function v4(e,t){let{target:r,replace:n,state:s,preventScrollReset:a,relative:i,viewTransition:o}=t===void 0?{}:t,l=Ls(),c=Ms(),f=Od(e,{relative:i});return z.useCallback(d=>{if(ZR(d,r)){d.preventDefault();let m=n!==void 0?n:qi(c)===qi(f);l(e,{replace:m,state:s,preventScrollReset:a,relative:i,viewTransition:o})}},[c,l,f,n,s,r,e,a,i,o])}function y4(e){let t=z.useRef(up(e)),r=z.useRef(!1),n=Ms(),s=z.useMemo(()=>e4(n.search,r.current?null:t.current),[n.search]),a=Ls(),i=z.useCallback((o,l)=>{const c=up(typeof o=="function"?o(s):o);r.current=!0,a("?"+c,l)},[a,s]);return[s,i]}function _4(e,t){t===void 0&&(t={});let r=z.useContext(OT);r==null&&Ke(!1);let{basename:n}=x4(fp.useViewTransitionState),s=Od(e,{relative:t.relative});if(!r.isTransitioning)return!1;let a=ma(r.currentLocation.pathname,n)||r.currentLocation.pathname,i=ma(r.nextLocation.pathname,n)||r.nextLocation.pathname;return Lh(s.pathname,i)!=null||Lh(s.pathname,a)!=null}var Cy={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const MT=function(e){const t=[];let r=0;for(let n=0;n<e.length;n++){let s=e.charCodeAt(n);s<128?t[r++]=s:s<2048?(t[r++]=s>>6|192,t[r++]=s&63|128):(s&64512)===55296&&n+1<e.length&&(e.charCodeAt(n+1)&64512)===56320?(s=65536+((s&1023)<<10)+(e.charCodeAt(++n)&1023),t[r++]=s>>18|240,t[r++]=s>>12&63|128,t[r++]=s>>6&63|128,t[r++]=s&63|128):(t[r++]=s>>12|224,t[r++]=s>>6&63|128,t[r++]=s&63|128)}return t},w4=function(e){const t=[];let r=0,n=0;for(;r<e.length;){const s=e[r++];if(s<128)t[n++]=String.fromCharCode(s);else if(s>191&&s<224){const a=e[r++];t[n++]=String.fromCharCode((s&31)<<6|a&63)}else if(s>239&&s<365){const a=e[r++],i=e[r++],o=e[r++],l=((s&7)<<18|(a&63)<<12|(i&63)<<6|o&63)-65536;t[n++]=String.fromCharCode(55296+(l>>10)),t[n++]=String.fromCharCode(56320+(l&1023))}else{const a=e[r++],i=e[r++];t[n++]=String.fromCharCode((s&15)<<12|(a&63)<<6|i&63)}}return t.join("")},LT={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(e,t){if(!Array.isArray(e))throw Error("encodeByteArray takes an array as a parameter");this.init_();const r=t?this.byteToCharMapWebSafe_:this.byteToCharMap_,n=[];for(let s=0;s<e.length;s+=3){const a=e[s],i=s+1<e.length,o=i?e[s+1]:0,l=s+2<e.length,c=l?e[s+2]:0,f=a>>2,d=(a&3)<<4|o>>4;let m=(o&15)<<2|c>>6,p=c&63;l||(p=64,i||(m=64)),n.push(r[f],r[d],r[m],r[p])}return n.join("")},encodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?btoa(e):this.encodeByteArray(MT(e),t)},decodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?atob(e):w4(this.decodeStringToByteArray(e,t))},decodeStringToByteArray(e,t){this.init_();const r=t?this.charToByteMapWebSafe_:this.charToByteMap_,n=[];for(let s=0;s<e.length;){const a=r[e.charAt(s++)],o=s<e.length?r[e.charAt(s)]:0;++s;const c=s<e.length?r[e.charAt(s)]:64;++s;const d=s<e.length?r[e.charAt(s)]:64;if(++s,a==null||o==null||c==null||d==null)throw new E4;const m=a<<2|o>>4;if(n.push(m),c!==64){const p=o<<4&240|c>>2;if(n.push(p),d!==64){const x=c<<6&192|d;n.push(x)}}}return n},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let e=0;e<this.ENCODED_VALS.length;e++)this.byteToCharMap_[e]=this.ENCODED_VALS.charAt(e),this.charToByteMap_[this.byteToCharMap_[e]]=e,this.byteToCharMapWebSafe_[e]=this.ENCODED_VALS_WEBSAFE.charAt(e),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[e]]=e,e>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(e)]=e,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(e)]=e)}}};class E4 extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const T4=function(e){const t=MT(e);return LT.encodeByteArray(t,!0)},Vh=function(e){return T4(e).replace(/\./g,"")},jT=function(e){try{return LT.decodeString(e,!0)}catch(t){console.error("base64Decode failed: ",t)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function k4(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const S4=()=>k4().__FIREBASE_DEFAULTS__,A4=()=>{if(typeof process>"u"||typeof Cy>"u")return;const e=Cy.__FIREBASE_DEFAULTS__;if(e)return JSON.parse(e)},I4=()=>{if(typeof document>"u")return;let e;try{e=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const t=e&&jT(e[1]);return t&&JSON.parse(t)},Md=()=>{try{return S4()||A4()||I4()}catch(e){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${e}`);return}},UT=e=>{var t,r;return(r=(t=Md())===null||t===void 0?void 0:t.emulatorHosts)===null||r===void 0?void 0:r[e]},Qg=e=>{const t=UT(e);if(!t)return;const r=t.lastIndexOf(":");if(r<=0||r+1===t.length)throw new Error(`Invalid host ${t} with no separate hostname and port!`);const n=parseInt(t.substring(r+1),10);return t[0]==="["?[t.substring(1,r-1),n]:[t.substring(0,r),n]},VT=()=>{var e;return(e=Md())===null||e===void 0?void 0:e.config},BT=e=>{var t;return(t=Md())===null||t===void 0?void 0:t[`_${e}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class N4{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((t,r)=>{this.resolve=t,this.reject=r})}wrapCallback(t){return(r,n)=>{r?this.reject(r):this.resolve(n),typeof t=="function"&&(this.promise.catch(()=>{}),t.length===1?t(r):t(r,n))}}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function WT(e,t){if(e.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const r={alg:"none",type:"JWT"},n=t||"demo-project",s=e.iat||0,a=e.sub||e.user_id;if(!a)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const i=Object.assign({iss:`https://securetoken.google.com/${n}`,aud:n,iat:s,exp:s+3600,auth_time:s,sub:a,user_id:a,firebase:{sign_in_provider:"custom",identities:{}}},e);return[Vh(JSON.stringify(r)),Vh(JSON.stringify(i)),""].join(".")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Hr(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function C4(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Hr())}function b4(){var e;const t=(e=Md())===null||e===void 0?void 0:e.forceEnvironment;if(t==="node")return!0;if(t==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function R4(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function P4(){const e=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof e=="object"&&e.id!==void 0}function D4(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function F4(){const e=Hr();return e.indexOf("MSIE ")>=0||e.indexOf("Trident/")>=0}function O4(){return!b4()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function M4(){try{return typeof indexedDB=="object"}catch{return!1}}function L4(){return new Promise((e,t)=>{try{let r=!0;const n="validate-browser-context-for-indexeddb-analytics-module",s=self.indexedDB.open(n);s.onsuccess=()=>{s.result.close(),r||self.indexedDB.deleteDatabase(n),e(!0)},s.onupgradeneeded=()=>{r=!1},s.onerror=()=>{var a;t(((a=s.error)===null||a===void 0?void 0:a.message)||"")}}catch(r){t(r)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const j4="FirebaseError";class js extends Error{constructor(t,r,n){super(r),this.code=t,this.customData=n,this.name=j4,Object.setPrototypeOf(this,js.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Iu.prototype.create)}}class Iu{constructor(t,r,n){this.service=t,this.serviceName=r,this.errors=n}create(t,...r){const n=r[0]||{},s=`${this.service}/${t}`,a=this.errors[t],i=a?U4(a,n):"Error",o=`${this.serviceName}: ${i} (${s}).`;return new js(s,o,n)}}function U4(e,t){return e.replace(V4,(r,n)=>{const s=t[n];return s!=null?String(s):`<${n}?>`})}const V4=/\{\$([^}]+)}/g;function B4(e){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}function Bh(e,t){if(e===t)return!0;const r=Object.keys(e),n=Object.keys(t);for(const s of r){if(!n.includes(s))return!1;const a=e[s],i=t[s];if(by(a)&&by(i)){if(!Bh(a,i))return!1}else if(a!==i)return!1}for(const s of n)if(!r.includes(s))return!1;return!0}function by(e){return e!==null&&typeof e=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Nu(e){const t=[];for(const[r,n]of Object.entries(e))Array.isArray(n)?n.forEach(s=>{t.push(encodeURIComponent(r)+"="+encodeURIComponent(s))}):t.push(encodeURIComponent(r)+"="+encodeURIComponent(n));return t.length?"&"+t.join("&"):""}function W4(e,t){const r=new z4(e,t);return r.subscribe.bind(r)}class z4{constructor(t,r){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=r,this.task.then(()=>{t(this)}).catch(n=>{this.error(n)})}next(t){this.forEachObserver(r=>{r.next(t)})}error(t){this.forEachObserver(r=>{r.error(t)}),this.close(t)}complete(){this.forEachObserver(t=>{t.complete()}),this.close()}subscribe(t,r,n){let s;if(t===void 0&&r===void 0&&n===void 0)throw new Error("Missing Observer.");$4(t,["next","error","complete"])?s=t:s={next:t,error:r,complete:n},s.next===void 0&&(s.next=H0),s.error===void 0&&(s.error=H0),s.complete===void 0&&(s.complete=H0);const a=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?s.error(this.finalError):s.complete()}catch{}}),this.observers.push(s),a}unsubscribeOne(t){this.observers===void 0||this.observers[t]===void 0||(delete this.observers[t],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(t){if(!this.finalized)for(let r=0;r<this.observers.length;r++)this.sendOne(r,t)}sendOne(t,r){this.task.then(()=>{if(this.observers!==void 0&&this.observers[t]!==void 0)try{r(this.observers[t])}catch(n){typeof console<"u"&&console.error&&console.error(n)}})}close(t){this.finalized||(this.finalized=!0,t!==void 0&&(this.finalError=t),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function $4(e,t){if(typeof e!="object"||e===null)return!1;for(const r of t)if(r in e&&typeof e[r]=="function")return!0;return!1}function H0(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qt(e){return e&&e._delegate?e._delegate:e}class pa{constructor(t,r,n){this.name=t,this.instanceFactory=r,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(t){return this.instantiationMode=t,this}setMultipleInstances(t){return this.multipleInstances=t,this}setServiceProps(t){return this.serviceProps=t,this}setInstanceCreatedCallback(t){return this.onInstanceCreated=t,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Si="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class H4{constructor(t,r){this.name=t,this.container=r,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(t){const r=this.normalizeInstanceIdentifier(t);if(!this.instancesDeferred.has(r)){const n=new N4;if(this.instancesDeferred.set(r,n),this.isInitialized(r)||this.shouldAutoInitialize())try{const s=this.getOrInitializeService({instanceIdentifier:r});s&&n.resolve(s)}catch{}}return this.instancesDeferred.get(r).promise}getImmediate(t){var r;const n=this.normalizeInstanceIdentifier(t==null?void 0:t.identifier),s=(r=t==null?void 0:t.optional)!==null&&r!==void 0?r:!1;if(this.isInitialized(n)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:n})}catch(a){if(s)return null;throw a}else{if(s)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(t){if(t.name!==this.name)throw Error(`Mismatching Component ${t.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=t,!!this.shouldAutoInitialize()){if(K4(t))try{this.getOrInitializeService({instanceIdentifier:Si})}catch{}for(const[r,n]of this.instancesDeferred.entries()){const s=this.normalizeInstanceIdentifier(r);try{const a=this.getOrInitializeService({instanceIdentifier:s});n.resolve(a)}catch{}}}}clearInstance(t=Si){this.instancesDeferred.delete(t),this.instancesOptions.delete(t),this.instances.delete(t)}async delete(){const t=Array.from(this.instances.values());await Promise.all([...t.filter(r=>"INTERNAL"in r).map(r=>r.INTERNAL.delete()),...t.filter(r=>"_delete"in r).map(r=>r._delete())])}isComponentSet(){return this.component!=null}isInitialized(t=Si){return this.instances.has(t)}getOptions(t=Si){return this.instancesOptions.get(t)||{}}initialize(t={}){const{options:r={}}=t,n=this.normalizeInstanceIdentifier(t.instanceIdentifier);if(this.isInitialized(n))throw Error(`${this.name}(${n}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const s=this.getOrInitializeService({instanceIdentifier:n,options:r});for(const[a,i]of this.instancesDeferred.entries()){const o=this.normalizeInstanceIdentifier(a);n===o&&i.resolve(s)}return s}onInit(t,r){var n;const s=this.normalizeInstanceIdentifier(r),a=(n=this.onInitCallbacks.get(s))!==null&&n!==void 0?n:new Set;a.add(t),this.onInitCallbacks.set(s,a);const i=this.instances.get(s);return i&&t(i,s),()=>{a.delete(t)}}invokeOnInitCallbacks(t,r){const n=this.onInitCallbacks.get(r);if(n)for(const s of n)try{s(t,r)}catch{}}getOrInitializeService({instanceIdentifier:t,options:r={}}){let n=this.instances.get(t);if(!n&&this.component&&(n=this.component.instanceFactory(this.container,{instanceIdentifier:G4(t),options:r}),this.instances.set(t,n),this.instancesOptions.set(t,r),this.invokeOnInitCallbacks(n,t),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,t,n)}catch{}return n||null}normalizeInstanceIdentifier(t=Si){return this.component?this.component.multipleInstances?t:Si:t}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function G4(e){return e===Si?void 0:e}function K4(e){return e.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class q4{constructor(t){this.name=t,this.providers=new Map}addComponent(t){const r=this.getProvider(t.name);if(r.isComponentSet())throw new Error(`Component ${t.name} has already been registered with ${this.name}`);r.setComponent(t)}addOrOverwriteComponent(t){this.getProvider(t.name).isComponentSet()&&this.providers.delete(t.name),this.addComponent(t)}getProvider(t){if(this.providers.has(t))return this.providers.get(t);const r=new H4(t,this);return this.providers.set(t,r),r}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Ze;(function(e){e[e.DEBUG=0]="DEBUG",e[e.VERBOSE=1]="VERBOSE",e[e.INFO=2]="INFO",e[e.WARN=3]="WARN",e[e.ERROR=4]="ERROR",e[e.SILENT=5]="SILENT"})(Ze||(Ze={}));const Y4={debug:Ze.DEBUG,verbose:Ze.VERBOSE,info:Ze.INFO,warn:Ze.WARN,error:Ze.ERROR,silent:Ze.SILENT},X4=Ze.INFO,Q4={[Ze.DEBUG]:"log",[Ze.VERBOSE]:"log",[Ze.INFO]:"info",[Ze.WARN]:"warn",[Ze.ERROR]:"error"},J4=(e,t,...r)=>{if(t<e.logLevel)return;const n=new Date().toISOString(),s=Q4[t];if(s)console[s](`[${n}]  ${e.name}:`,...r);else throw new Error(`Attempted to log a message with an invalid logType (value: ${t})`)};class Jg{constructor(t){this.name=t,this._logLevel=X4,this._logHandler=J4,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(t){if(!(t in Ze))throw new TypeError(`Invalid value "${t}" assigned to \`logLevel\``);this._logLevel=t}setLogLevel(t){this._logLevel=typeof t=="string"?Y4[t]:t}get logHandler(){return this._logHandler}set logHandler(t){if(typeof t!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t}get userLogHandler(){return this._userLogHandler}set userLogHandler(t){this._userLogHandler=t}debug(...t){this._userLogHandler&&this._userLogHandler(this,Ze.DEBUG,...t),this._logHandler(this,Ze.DEBUG,...t)}log(...t){this._userLogHandler&&this._userLogHandler(this,Ze.VERBOSE,...t),this._logHandler(this,Ze.VERBOSE,...t)}info(...t){this._userLogHandler&&this._userLogHandler(this,Ze.INFO,...t),this._logHandler(this,Ze.INFO,...t)}warn(...t){this._userLogHandler&&this._userLogHandler(this,Ze.WARN,...t),this._logHandler(this,Ze.WARN,...t)}error(...t){this._userLogHandler&&this._userLogHandler(this,Ze.ERROR,...t),this._logHandler(this,Ze.ERROR,...t)}}const Z4=(e,t)=>t.some(r=>e instanceof r);let Ry,Py;function eP(){return Ry||(Ry=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function tP(){return Py||(Py=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const zT=new WeakMap,hp=new WeakMap,$T=new WeakMap,G0=new WeakMap,Zg=new WeakMap;function rP(e){const t=new Promise((r,n)=>{const s=()=>{e.removeEventListener("success",a),e.removeEventListener("error",i)},a=()=>{r(ti(e.result)),s()},i=()=>{n(e.error),s()};e.addEventListener("success",a),e.addEventListener("error",i)});return t.then(r=>{r instanceof IDBCursor&&zT.set(r,e)}).catch(()=>{}),Zg.set(t,e),t}function nP(e){if(hp.has(e))return;const t=new Promise((r,n)=>{const s=()=>{e.removeEventListener("complete",a),e.removeEventListener("error",i),e.removeEventListener("abort",i)},a=()=>{r(),s()},i=()=>{n(e.error||new DOMException("AbortError","AbortError")),s()};e.addEventListener("complete",a),e.addEventListener("error",i),e.addEventListener("abort",i)});hp.set(e,t)}let dp={get(e,t,r){if(e instanceof IDBTransaction){if(t==="done")return hp.get(e);if(t==="objectStoreNames")return e.objectStoreNames||$T.get(e);if(t==="store")return r.objectStoreNames[1]?void 0:r.objectStore(r.objectStoreNames[0])}return ti(e[t])},set(e,t,r){return e[t]=r,!0},has(e,t){return e instanceof IDBTransaction&&(t==="done"||t==="store")?!0:t in e}};function sP(e){dp=e(dp)}function aP(e){return e===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(t,...r){const n=e.call(K0(this),t,...r);return $T.set(n,t.sort?t.sort():[t]),ti(n)}:tP().includes(e)?function(...t){return e.apply(K0(this),t),ti(zT.get(this))}:function(...t){return ti(e.apply(K0(this),t))}}function iP(e){return typeof e=="function"?aP(e):(e instanceof IDBTransaction&&nP(e),Z4(e,eP())?new Proxy(e,dp):e)}function ti(e){if(e instanceof IDBRequest)return rP(e);if(G0.has(e))return G0.get(e);const t=iP(e);return t!==e&&(G0.set(e,t),Zg.set(t,e)),t}const K0=e=>Zg.get(e);function oP(e,t,{blocked:r,upgrade:n,blocking:s,terminated:a}={}){const i=indexedDB.open(e,t),o=ti(i);return n&&i.addEventListener("upgradeneeded",l=>{n(ti(i.result),l.oldVersion,l.newVersion,ti(i.transaction),l)}),r&&i.addEventListener("blocked",l=>r(l.oldVersion,l.newVersion,l)),o.then(l=>{a&&l.addEventListener("close",()=>a()),s&&l.addEventListener("versionchange",c=>s(c.oldVersion,c.newVersion,c))}).catch(()=>{}),o}const lP=["get","getKey","getAll","getAllKeys","count"],cP=["put","add","delete","clear"],q0=new Map;function Dy(e,t){if(!(e instanceof IDBDatabase&&!(t in e)&&typeof t=="string"))return;if(q0.get(t))return q0.get(t);const r=t.replace(/FromIndex$/,""),n=t!==r,s=cP.includes(r);if(!(r in(n?IDBIndex:IDBObjectStore).prototype)||!(s||lP.includes(r)))return;const a=async function(i,...o){const l=this.transaction(i,s?"readwrite":"readonly");let c=l.store;return n&&(c=c.index(o.shift())),(await Promise.all([c[r](...o),s&&l.done]))[0]};return q0.set(t,a),a}sP(e=>({...e,get:(t,r,n)=>Dy(t,r)||e.get(t,r,n),has:(t,r)=>!!Dy(t,r)||e.has(t,r)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uP{constructor(t){this.container=t}getPlatformInfoString(){return this.container.getProviders().map(r=>{if(fP(r)){const n=r.getImmediate();return`${n.library}/${n.version}`}else return null}).filter(r=>r).join(" ")}}function fP(e){const t=e.getComponent();return(t==null?void 0:t.type)==="VERSION"}const mp="@firebase/app",Fy="0.10.13";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ga=new Jg("@firebase/app"),hP="@firebase/app-compat",dP="@firebase/analytics-compat",mP="@firebase/analytics",pP="@firebase/app-check-compat",gP="@firebase/app-check",xP="@firebase/auth",vP="@firebase/auth-compat",yP="@firebase/database",_P="@firebase/data-connect",wP="@firebase/database-compat",EP="@firebase/functions",TP="@firebase/functions-compat",kP="@firebase/installations",SP="@firebase/installations-compat",AP="@firebase/messaging",IP="@firebase/messaging-compat",NP="@firebase/performance",CP="@firebase/performance-compat",bP="@firebase/remote-config",RP="@firebase/remote-config-compat",PP="@firebase/storage",DP="@firebase/storage-compat",FP="@firebase/firestore",OP="@firebase/vertexai-preview",MP="@firebase/firestore-compat",LP="firebase",jP="10.14.1";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pp="[DEFAULT]",UP={[mp]:"fire-core",[hP]:"fire-core-compat",[mP]:"fire-analytics",[dP]:"fire-analytics-compat",[gP]:"fire-app-check",[pP]:"fire-app-check-compat",[xP]:"fire-auth",[vP]:"fire-auth-compat",[yP]:"fire-rtdb",[_P]:"fire-data-connect",[wP]:"fire-rtdb-compat",[EP]:"fire-fn",[TP]:"fire-fn-compat",[kP]:"fire-iid",[SP]:"fire-iid-compat",[AP]:"fire-fcm",[IP]:"fire-fcm-compat",[NP]:"fire-perf",[CP]:"fire-perf-compat",[bP]:"fire-rc",[RP]:"fire-rc-compat",[PP]:"fire-gcs",[DP]:"fire-gcs-compat",[FP]:"fire-fst",[MP]:"fire-fst-compat",[OP]:"fire-vertex","fire-js":"fire-js",[LP]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Wh=new Map,VP=new Map,gp=new Map;function Oy(e,t){try{e.container.addComponent(t)}catch(r){ga.debug(`Component ${t.name} failed to register with FirebaseApp ${e.name}`,r)}}function li(e){const t=e.name;if(gp.has(t))return ga.debug(`There were multiple attempts to register component ${t}.`),!1;gp.set(t,e);for(const r of Wh.values())Oy(r,e);for(const r of VP.values())Oy(r,e);return!0}function Cu(e,t){const r=e.container.getProvider("heartbeat").getImmediate({optional:!0});return r&&r.triggerHeartbeat(),e.container.getProvider(t)}function ea(e){return e.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const BP={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},ri=new Iu("app","Firebase",BP);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class WP{constructor(t,r,n){this._isDeleted=!1,this._options=Object.assign({},t),this._config=Object.assign({},r),this._name=r.name,this._automaticDataCollectionEnabled=r.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new pa("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(t){this.checkDestroyed(),this._automaticDataCollectionEnabled=t}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(t){this._isDeleted=t}checkDestroyed(){if(this.isDeleted)throw ri.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const so=jP;function HT(e,t={}){let r=e;typeof t!="object"&&(t={name:t});const n=Object.assign({name:pp,automaticDataCollectionEnabled:!1},t),s=n.name;if(typeof s!="string"||!s)throw ri.create("bad-app-name",{appName:String(s)});if(r||(r=VT()),!r)throw ri.create("no-options");const a=Wh.get(s);if(a){if(Bh(r,a.options)&&Bh(n,a.config))return a;throw ri.create("duplicate-app",{appName:s})}const i=new q4(s);for(const l of gp.values())i.addComponent(l);const o=new WP(r,n,i);return Wh.set(s,o),o}function Ld(e=pp){const t=Wh.get(e);if(!t&&e===pp&&VT())return HT();if(!t)throw ri.create("no-app",{appName:e});return t}function $n(e,t,r){var n;let s=(n=UP[e])!==null&&n!==void 0?n:e;r&&(s+=`-${r}`);const a=s.match(/\s|\//),i=t.match(/\s|\//);if(a||i){const o=[`Unable to register library "${s}" with version "${t}":`];a&&o.push(`library name "${s}" contains illegal characters (whitespace or "/")`),a&&i&&o.push("and"),i&&o.push(`version name "${t}" contains illegal characters (whitespace or "/")`),ga.warn(o.join(" "));return}li(new pa(`${s}-version`,()=>({library:s,version:t}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zP="firebase-heartbeat-database",$P=1,eu="firebase-heartbeat-store";let Y0=null;function GT(){return Y0||(Y0=oP(zP,$P,{upgrade:(e,t)=>{switch(t){case 0:try{e.createObjectStore(eu)}catch(r){console.warn(r)}}}}).catch(e=>{throw ri.create("idb-open",{originalErrorMessage:e.message})})),Y0}async function HP(e){try{const r=(await GT()).transaction(eu),n=await r.objectStore(eu).get(KT(e));return await r.done,n}catch(t){if(t instanceof js)ga.warn(t.message);else{const r=ri.create("idb-get",{originalErrorMessage:t==null?void 0:t.message});ga.warn(r.message)}}}async function My(e,t){try{const n=(await GT()).transaction(eu,"readwrite");await n.objectStore(eu).put(t,KT(e)),await n.done}catch(r){if(r instanceof js)ga.warn(r.message);else{const n=ri.create("idb-set",{originalErrorMessage:r==null?void 0:r.message});ga.warn(n.message)}}}function KT(e){return`${e.name}!${e.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const GP=1024,KP=30*24*60*60*1e3;class qP{constructor(t){this.container=t,this._heartbeatsCache=null;const r=this.container.getProvider("app").getImmediate();this._storage=new XP(r),this._heartbeatsCachePromise=this._storage.read().then(n=>(this._heartbeatsCache=n,n))}async triggerHeartbeat(){var t,r;try{const s=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),a=Ly();return((t=this._heartbeatsCache)===null||t===void 0?void 0:t.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((r=this._heartbeatsCache)===null||r===void 0?void 0:r.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===a||this._heartbeatsCache.heartbeats.some(i=>i.date===a)?void 0:(this._heartbeatsCache.heartbeats.push({date:a,agent:s}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(i=>{const o=new Date(i.date).valueOf();return Date.now()-o<=KP}),this._storage.overwrite(this._heartbeatsCache))}catch(n){ga.warn(n)}}async getHeartbeatsHeader(){var t;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((t=this._heartbeatsCache)===null||t===void 0?void 0:t.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const r=Ly(),{heartbeatsToSend:n,unsentEntries:s}=YP(this._heartbeatsCache.heartbeats),a=Vh(JSON.stringify({version:2,heartbeats:n}));return this._heartbeatsCache.lastSentHeartbeatDate=r,s.length>0?(this._heartbeatsCache.heartbeats=s,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),a}catch(r){return ga.warn(r),""}}}function Ly(){return new Date().toISOString().substring(0,10)}function YP(e,t=GP){const r=[];let n=e.slice();for(const s of e){const a=r.find(i=>i.agent===s.agent);if(a){if(a.dates.push(s.date),jy(r)>t){a.dates.pop();break}}else if(r.push({agent:s.agent,dates:[s.date]}),jy(r)>t){r.pop();break}n=n.slice(1)}return{heartbeatsToSend:r,unsentEntries:n}}class XP{constructor(t){this.app=t,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return M4()?L4().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const r=await HP(this.app);return r!=null&&r.heartbeats?r:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(t){var r;if(await this._canUseIndexedDBPromise){const s=await this.read();return My(this.app,{lastSentHeartbeatDate:(r=t.lastSentHeartbeatDate)!==null&&r!==void 0?r:s.lastSentHeartbeatDate,heartbeats:t.heartbeats})}else return}async add(t){var r;if(await this._canUseIndexedDBPromise){const s=await this.read();return My(this.app,{lastSentHeartbeatDate:(r=t.lastSentHeartbeatDate)!==null&&r!==void 0?r:s.lastSentHeartbeatDate,heartbeats:[...s.heartbeats,...t.heartbeats]})}else return}}function jy(e){return Vh(JSON.stringify({version:2,heartbeats:e})).length}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function QP(e){li(new pa("platform-logger",t=>new uP(t),"PRIVATE")),li(new pa("heartbeat",t=>new qP(t),"PRIVATE")),$n(mp,Fy,e),$n(mp,Fy,"esm2017"),$n("fire-js","")}QP("");function ex(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,n=Object.getOwnPropertySymbols(e);s<n.length;s++)t.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(e,n[s])&&(r[n[s]]=e[n[s]]);return r}function qT(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const JP=qT,YT=new Iu("auth","Firebase",qT());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zh=new Jg("@firebase/auth");function ZP(e,...t){zh.logLevel<=Ze.WARN&&zh.warn(`Auth (${so}): ${e}`,...t)}function rh(e,...t){zh.logLevel<=Ze.ERROR&&zh.error(`Auth (${so}): ${e}`,...t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Rs(e,...t){throw rx(e,...t)}function ds(e,...t){return rx(e,...t)}function tx(e,t,r){const n=Object.assign(Object.assign({},JP()),{[t]:r});return new Iu("auth","Firebase",n).create(t,{appName:e.name})}function ji(e){return tx(e,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function eD(e,t,r){const n=r;if(!(t instanceof n))throw n.name!==t.constructor.name&&Rs(e,"argument-error"),tx(e,"argument-error",`Type of ${t.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function rx(e,...t){if(typeof e!="string"){const r=t[0],n=[...t.slice(1)];return n[0]&&(n[0].appName=e.name),e._errorFactory.create(r,...n)}return YT.create(e,...t)}function Le(e,t,...r){if(!e)throw rx(t,...r)}function ta(e){const t="INTERNAL ASSERTION FAILED: "+e;throw rh(t),new Error(t)}function xa(e,t){e||ta(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xp(){var e;return typeof self<"u"&&((e=self.location)===null||e===void 0?void 0:e.href)||""}function tD(){return Uy()==="http:"||Uy()==="https:"}function Uy(){var e;return typeof self<"u"&&((e=self.location)===null||e===void 0?void 0:e.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rD(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(tD()||P4()||"connection"in navigator)?navigator.onLine:!0}function nD(){if(typeof navigator>"u")return null;const e=navigator;return e.languages&&e.languages[0]||e.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bu{constructor(t,r){this.shortDelay=t,this.longDelay=r,xa(r>t,"Short delay should be less than long delay!"),this.isMobile=C4()||D4()}get(){return rD()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nx(e,t){xa(e.emulator,"Emulator should always be set here");const{url:r}=e.emulator;return t?`${r}${t.startsWith("/")?t.slice(1):t}`:r}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XT{static initialize(t,r,n){this.fetchImpl=t,r&&(this.headersImpl=r),n&&(this.responseImpl=n)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;ta("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;ta("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;ta("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sD={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const aD=new bu(3e4,6e4);function sx(e,t){return e.tenantId&&!t.tenantId?Object.assign(Object.assign({},t),{tenantId:e.tenantId}):t}async function kl(e,t,r,n,s={}){return QT(e,s,async()=>{let a={},i={};n&&(t==="GET"?i=n:a={body:JSON.stringify(n)});const o=Nu(Object.assign({key:e.config.apiKey},i)).slice(1),l=await e._getAdditionalHeaders();l["Content-Type"]="application/json",e.languageCode&&(l["X-Firebase-Locale"]=e.languageCode);const c=Object.assign({method:t,headers:l},a);return R4()||(c.referrerPolicy="no-referrer"),XT.fetch()(JT(e,e.config.apiHost,r,o),c)})}async function QT(e,t,r){e._canInitEmulator=!1;const n=Object.assign(Object.assign({},sD),t);try{const s=new oD(e),a=await Promise.race([r(),s.promise]);s.clearNetworkTimeout();const i=await a.json();if("needConfirmation"in i)throw Nf(e,"account-exists-with-different-credential",i);if(a.ok&&!("errorMessage"in i))return i;{const o=a.ok?i.errorMessage:i.error.message,[l,c]=o.split(" : ");if(l==="FEDERATED_USER_ID_ALREADY_LINKED")throw Nf(e,"credential-already-in-use",i);if(l==="EMAIL_EXISTS")throw Nf(e,"email-already-in-use",i);if(l==="USER_DISABLED")throw Nf(e,"user-disabled",i);const f=n[l]||l.toLowerCase().replace(/[_\s]+/g,"-");if(c)throw tx(e,f,c);Rs(e,f)}}catch(s){if(s instanceof js)throw s;Rs(e,"network-request-failed",{message:String(s)})}}async function iD(e,t,r,n,s={}){const a=await kl(e,t,r,n,s);return"mfaPendingCredential"in a&&Rs(e,"multi-factor-auth-required",{_serverResponse:a}),a}function JT(e,t,r,n){const s=`${t}${r}?${n}`;return e.config.emulator?nx(e.config,s):`${e.config.apiScheme}://${s}`}class oD{constructor(t){this.auth=t,this.timer=null,this.promise=new Promise((r,n)=>{this.timer=setTimeout(()=>n(ds(this.auth,"network-request-failed")),aD.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}}function Nf(e,t,r){const n={appName:e.name};r.email&&(n.email=r.email),r.phoneNumber&&(n.phoneNumber=r.phoneNumber);const s=ds(e,t,n);return s.customData._tokenResponse=r,s}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function lD(e,t){return kl(e,"POST","/v1/accounts:delete",t)}async function ZT(e,t){return kl(e,"POST","/v1/accounts:lookup",t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _c(e){if(e)try{const t=new Date(Number(e));if(!isNaN(t.getTime()))return t.toUTCString()}catch{}}async function ek(e,t=!1){const r=qt(e),n=await r.getIdToken(t),s=ax(n);Le(s&&s.exp&&s.auth_time&&s.iat,r.auth,"internal-error");const a=typeof s.firebase=="object"?s.firebase:void 0,i=a==null?void 0:a.sign_in_provider;return{claims:s,token:n,authTime:_c(X0(s.auth_time)),issuedAtTime:_c(X0(s.iat)),expirationTime:_c(X0(s.exp)),signInProvider:i||null,signInSecondFactor:(a==null?void 0:a.sign_in_second_factor)||null}}function X0(e){return Number(e)*1e3}function ax(e){const[t,r,n]=e.split(".");if(t===void 0||r===void 0||n===void 0)return rh("JWT malformed, contained fewer than 3 sections"),null;try{const s=jT(r);return s?JSON.parse(s):(rh("Failed to decode base64 JWT payload"),null)}catch(s){return rh("Caught error parsing JWT payload as JSON",s==null?void 0:s.toString()),null}}function Vy(e){const t=ax(e);return Le(t,"internal-error"),Le(typeof t.exp<"u","internal-error"),Le(typeof t.iat<"u","internal-error"),Number(t.exp)-Number(t.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function tu(e,t,r=!1){if(r)return t;try{return await t}catch(n){throw n instanceof js&&cD(n)&&e.auth.currentUser===e&&await e.auth.signOut(),n}}function cD({code:e}){return e==="auth/user-disabled"||e==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uD{constructor(t){this.user=t,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(t){var r;if(t){const n=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),n}else{this.errorBackoff=3e4;const s=((r=this.user.stsTokenManager.expirationTime)!==null&&r!==void 0?r:0)-Date.now()-3e5;return Math.max(0,s)}}schedule(t=!1){if(!this.isRunning)return;const r=this.getInterval(t);this.timerId=setTimeout(async()=>{await this.iteration()},r)}async iteration(){try{await this.user.getIdToken(!0)}catch(t){(t==null?void 0:t.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vp{constructor(t,r){this.createdAt=t,this.lastLoginAt=r,this._initializeTime()}_initializeTime(){this.lastSignInTime=_c(this.lastLoginAt),this.creationTime=_c(this.createdAt)}_copy(t){this.createdAt=t.createdAt,this.lastLoginAt=t.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function $h(e){var t;const r=e.auth,n=await e.getIdToken(),s=await tu(e,ZT(r,{idToken:n}));Le(s==null?void 0:s.users.length,r,"internal-error");const a=s.users[0];e._notifyReloadListener(a);const i=!((t=a.providerUserInfo)===null||t===void 0)&&t.length?tk(a.providerUserInfo):[],o=hD(e.providerData,i),l=e.isAnonymous,c=!(e.email&&a.passwordHash)&&!(o!=null&&o.length),f=l?c:!1,d={uid:a.localId,displayName:a.displayName||null,photoURL:a.photoUrl||null,email:a.email||null,emailVerified:a.emailVerified||!1,phoneNumber:a.phoneNumber||null,tenantId:a.tenantId||null,providerData:o,metadata:new vp(a.createdAt,a.lastLoginAt),isAnonymous:f};Object.assign(e,d)}async function fD(e){const t=qt(e);await $h(t),await t.auth._persistUserIfCurrent(t),t.auth._notifyListenersIfCurrent(t)}function hD(e,t){return[...e.filter(n=>!t.some(s=>s.providerId===n.providerId)),...t]}function tk(e){return e.map(t=>{var{providerId:r}=t,n=ex(t,["providerId"]);return{providerId:r,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function dD(e,t){const r=await QT(e,{},async()=>{const n=Nu({grant_type:"refresh_token",refresh_token:t}).slice(1),{tokenApiHost:s,apiKey:a}=e.config,i=JT(e,s,"/v1/token",`key=${a}`),o=await e._getAdditionalHeaders();return o["Content-Type"]="application/x-www-form-urlencoded",XT.fetch()(i,{method:"POST",headers:o,body:n})});return{accessToken:r.access_token,expiresIn:r.expires_in,refreshToken:r.refresh_token}}async function mD(e,t){return kl(e,"POST","/v2/accounts:revokeToken",sx(e,t))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ko{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(t){Le(t.idToken,"internal-error"),Le(typeof t.idToken<"u","internal-error"),Le(typeof t.refreshToken<"u","internal-error");const r="expiresIn"in t&&typeof t.expiresIn<"u"?Number(t.expiresIn):Vy(t.idToken);this.updateTokensAndExpiration(t.idToken,t.refreshToken,r)}updateFromIdToken(t){Le(t.length!==0,"internal-error");const r=Vy(t);this.updateTokensAndExpiration(t,null,r)}async getToken(t,r=!1){return!r&&this.accessToken&&!this.isExpired?this.accessToken:(Le(this.refreshToken,t,"user-token-expired"),this.refreshToken?(await this.refresh(t,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(t,r){const{accessToken:n,refreshToken:s,expiresIn:a}=await dD(t,r);this.updateTokensAndExpiration(n,s,Number(a))}updateTokensAndExpiration(t,r,n){this.refreshToken=r||null,this.accessToken=t||null,this.expirationTime=Date.now()+n*1e3}static fromJSON(t,r){const{refreshToken:n,accessToken:s,expirationTime:a}=r,i=new Ko;return n&&(Le(typeof n=="string","internal-error",{appName:t}),i.refreshToken=n),s&&(Le(typeof s=="string","internal-error",{appName:t}),i.accessToken=s),a&&(Le(typeof a=="number","internal-error",{appName:t}),i.expirationTime=a),i}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(t){this.accessToken=t.accessToken,this.refreshToken=t.refreshToken,this.expirationTime=t.expirationTime}_clone(){return Object.assign(new Ko,this.toJSON())}_performRefresh(){return ta("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ba(e,t){Le(typeof e=="string"||typeof e>"u","internal-error",{appName:t})}class ra{constructor(t){var{uid:r,auth:n,stsTokenManager:s}=t,a=ex(t,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new uD(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=r,this.auth=n,this.stsTokenManager=s,this.accessToken=s.accessToken,this.displayName=a.displayName||null,this.email=a.email||null,this.emailVerified=a.emailVerified||!1,this.phoneNumber=a.phoneNumber||null,this.photoURL=a.photoURL||null,this.isAnonymous=a.isAnonymous||!1,this.tenantId=a.tenantId||null,this.providerData=a.providerData?[...a.providerData]:[],this.metadata=new vp(a.createdAt||void 0,a.lastLoginAt||void 0)}async getIdToken(t){const r=await tu(this,this.stsTokenManager.getToken(this.auth,t));return Le(r,this.auth,"internal-error"),this.accessToken!==r&&(this.accessToken=r,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),r}getIdTokenResult(t){return ek(this,t)}reload(){return fD(this)}_assign(t){this!==t&&(Le(this.uid===t.uid,this.auth,"internal-error"),this.displayName=t.displayName,this.photoURL=t.photoURL,this.email=t.email,this.emailVerified=t.emailVerified,this.phoneNumber=t.phoneNumber,this.isAnonymous=t.isAnonymous,this.tenantId=t.tenantId,this.providerData=t.providerData.map(r=>Object.assign({},r)),this.metadata._copy(t.metadata),this.stsTokenManager._assign(t.stsTokenManager))}_clone(t){const r=new ra(Object.assign(Object.assign({},this),{auth:t,stsTokenManager:this.stsTokenManager._clone()}));return r.metadata._copy(this.metadata),r}_onReload(t){Le(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=t,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(t){this.reloadListener?this.reloadListener(t):this.reloadUserInfo=t}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(t,r=!1){let n=!1;t.idToken&&t.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(t),n=!0),r&&await $h(this),await this.auth._persistUserIfCurrent(this),n&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(ea(this.auth.app))return Promise.reject(ji(this.auth));const t=await this.getIdToken();return await tu(this,lD(this.auth,{idToken:t})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(t=>Object.assign({},t)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(t,r){var n,s,a,i,o,l,c,f;const d=(n=r.displayName)!==null&&n!==void 0?n:void 0,m=(s=r.email)!==null&&s!==void 0?s:void 0,p=(a=r.phoneNumber)!==null&&a!==void 0?a:void 0,x=(i=r.photoURL)!==null&&i!==void 0?i:void 0,g=(o=r.tenantId)!==null&&o!==void 0?o:void 0,w=(l=r._redirectEventId)!==null&&l!==void 0?l:void 0,k=(c=r.createdAt)!==null&&c!==void 0?c:void 0,E=(f=r.lastLoginAt)!==null&&f!==void 0?f:void 0,{uid:y,emailVerified:I,isAnonymous:M,providerData:O,stsTokenManager:v}=r;Le(y&&v,t,"internal-error");const T=Ko.fromJSON(this.name,v);Le(typeof y=="string",t,"internal-error"),ba(d,t.name),ba(m,t.name),Le(typeof I=="boolean",t,"internal-error"),Le(typeof M=="boolean",t,"internal-error"),ba(p,t.name),ba(x,t.name),ba(g,t.name),ba(w,t.name),ba(k,t.name),ba(E,t.name);const S=new ra({uid:y,auth:t,email:m,emailVerified:I,displayName:d,isAnonymous:M,photoURL:x,phoneNumber:p,tenantId:g,stsTokenManager:T,createdAt:k,lastLoginAt:E});return O&&Array.isArray(O)&&(S.providerData=O.map(C=>Object.assign({},C))),w&&(S._redirectEventId=w),S}static async _fromIdTokenResponse(t,r,n=!1){const s=new Ko;s.updateFromServerResponse(r);const a=new ra({uid:r.localId,auth:t,stsTokenManager:s,isAnonymous:n});return await $h(a),a}static async _fromGetAccountInfoResponse(t,r,n){const s=r.users[0];Le(s.localId!==void 0,"internal-error");const a=s.providerUserInfo!==void 0?tk(s.providerUserInfo):[],i=!(s.email&&s.passwordHash)&&!(a!=null&&a.length),o=new Ko;o.updateFromIdToken(n);const l=new ra({uid:s.localId,auth:t,stsTokenManager:o,isAnonymous:i}),c={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:a,metadata:new vp(s.createdAt,s.lastLoginAt),isAnonymous:!(s.email&&s.passwordHash)&&!(a!=null&&a.length)};return Object.assign(l,c),l}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const By=new Map;function na(e){xa(e instanceof Function,"Expected a class definition");let t=By.get(e);return t?(xa(t instanceof e,"Instance stored in cache mismatched with class"),t):(t=new e,By.set(e,t),t)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rk{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(t,r){this.storage[t]=r}async _get(t){const r=this.storage[t];return r===void 0?null:r}async _remove(t){delete this.storage[t]}_addListener(t,r){}_removeListener(t,r){}}rk.type="NONE";const Wy=rk;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nh(e,t,r){return`firebase:${e}:${t}:${r}`}class qo{constructor(t,r,n){this.persistence=t,this.auth=r,this.userKey=n;const{config:s,name:a}=this.auth;this.fullUserKey=nh(this.userKey,s.apiKey,a),this.fullPersistenceKey=nh("persistence",s.apiKey,a),this.boundEventHandler=r._onStorageEvent.bind(r),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(t){return this.persistence._set(this.fullUserKey,t.toJSON())}async getCurrentUser(){const t=await this.persistence._get(this.fullUserKey);return t?ra._fromJSON(this.auth,t):null}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(t){if(this.persistence===t)return;const r=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=t,r)return this.setCurrentUser(r)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(t,r,n="authUser"){if(!r.length)return new qo(na(Wy),t,n);const s=(await Promise.all(r.map(async c=>{if(await c._isAvailable())return c}))).filter(c=>c);let a=s[0]||na(Wy);const i=nh(n,t.config.apiKey,t.name);let o=null;for(const c of r)try{const f=await c._get(i);if(f){const d=ra._fromJSON(t,f);c!==a&&(o=d),a=c;break}}catch{}const l=s.filter(c=>c._shouldAllowMigration);return!a._shouldAllowMigration||!l.length?new qo(a,t,n):(a=l[0],o&&await a._set(i,o.toJSON()),await Promise.all(r.map(async c=>{if(c!==a)try{await c._remove(i)}catch{}})),new qo(a,t,n))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zy(e){const t=e.toLowerCase();if(t.includes("opera/")||t.includes("opr/")||t.includes("opios/"))return"Opera";if(ik(t))return"IEMobile";if(t.includes("msie")||t.includes("trident/"))return"IE";if(t.includes("edge/"))return"Edge";if(nk(t))return"Firefox";if(t.includes("silk/"))return"Silk";if(lk(t))return"Blackberry";if(ck(t))return"Webos";if(sk(t))return"Safari";if((t.includes("chrome/")||ak(t))&&!t.includes("edge/"))return"Chrome";if(ok(t))return"Android";{const r=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,n=e.match(r);if((n==null?void 0:n.length)===2)return n[1]}return"Other"}function nk(e=Hr()){return/firefox\//i.test(e)}function sk(e=Hr()){const t=e.toLowerCase();return t.includes("safari/")&&!t.includes("chrome/")&&!t.includes("crios/")&&!t.includes("android")}function ak(e=Hr()){return/crios\//i.test(e)}function ik(e=Hr()){return/iemobile/i.test(e)}function ok(e=Hr()){return/android/i.test(e)}function lk(e=Hr()){return/blackberry/i.test(e)}function ck(e=Hr()){return/webos/i.test(e)}function ix(e=Hr()){return/iphone|ipad|ipod/i.test(e)||/macintosh/i.test(e)&&/mobile/i.test(e)}function pD(e=Hr()){var t;return ix(e)&&!!(!((t=window.navigator)===null||t===void 0)&&t.standalone)}function gD(){return F4()&&document.documentMode===10}function uk(e=Hr()){return ix(e)||ok(e)||ck(e)||lk(e)||/windows phone/i.test(e)||ik(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fk(e,t=[]){let r;switch(e){case"Browser":r=zy(Hr());break;case"Worker":r=`${zy(Hr())}-${e}`;break;default:r=e}const n=t.length?t.join(","):"FirebaseCore-web";return`${r}/JsCore/${so}/${n}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xD{constructor(t){this.auth=t,this.queue=[]}pushCallback(t,r){const n=a=>new Promise((i,o)=>{try{const l=t(a);i(l)}catch(l){o(l)}});n.onAbort=r,this.queue.push(n);const s=this.queue.length-1;return()=>{this.queue[s]=()=>Promise.resolve()}}async runMiddleware(t){if(this.auth.currentUser===t)return;const r=[];try{for(const n of this.queue)await n(t),n.onAbort&&r.push(n.onAbort)}catch(n){r.reverse();for(const s of r)try{s()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:n==null?void 0:n.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function vD(e,t={}){return kl(e,"GET","/v2/passwordPolicy",sx(e,t))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yD=6;class _D{constructor(t){var r,n,s,a;const i=t.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(r=i.minPasswordLength)!==null&&r!==void 0?r:yD,i.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=i.maxPasswordLength),i.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=i.containsLowercaseCharacter),i.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=i.containsUppercaseCharacter),i.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=i.containsNumericCharacter),i.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=i.containsNonAlphanumericCharacter),this.enforcementState=t.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(s=(n=t.allowedNonAlphanumericCharacters)===null||n===void 0?void 0:n.join(""))!==null&&s!==void 0?s:"",this.forceUpgradeOnSignin=(a=t.forceUpgradeOnSignin)!==null&&a!==void 0?a:!1,this.schemaVersion=t.schemaVersion}validatePassword(t){var r,n,s,a,i,o;const l={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(t,l),this.validatePasswordCharacterOptions(t,l),l.isValid&&(l.isValid=(r=l.meetsMinPasswordLength)!==null&&r!==void 0?r:!0),l.isValid&&(l.isValid=(n=l.meetsMaxPasswordLength)!==null&&n!==void 0?n:!0),l.isValid&&(l.isValid=(s=l.containsLowercaseLetter)!==null&&s!==void 0?s:!0),l.isValid&&(l.isValid=(a=l.containsUppercaseLetter)!==null&&a!==void 0?a:!0),l.isValid&&(l.isValid=(i=l.containsNumericCharacter)!==null&&i!==void 0?i:!0),l.isValid&&(l.isValid=(o=l.containsNonAlphanumericCharacter)!==null&&o!==void 0?o:!0),l}validatePasswordLengthOptions(t,r){const n=this.customStrengthOptions.minPasswordLength,s=this.customStrengthOptions.maxPasswordLength;n&&(r.meetsMinPasswordLength=t.length>=n),s&&(r.meetsMaxPasswordLength=t.length<=s)}validatePasswordCharacterOptions(t,r){this.updatePasswordCharacterOptionsStatuses(r,!1,!1,!1,!1);let n;for(let s=0;s<t.length;s++)n=t.charAt(s),this.updatePasswordCharacterOptionsStatuses(r,n>="a"&&n<="z",n>="A"&&n<="Z",n>="0"&&n<="9",this.allowedNonAlphanumericCharacters.includes(n))}updatePasswordCharacterOptionsStatuses(t,r,n,s,a){this.customStrengthOptions.containsLowercaseLetter&&(t.containsLowercaseLetter||(t.containsLowercaseLetter=r)),this.customStrengthOptions.containsUppercaseLetter&&(t.containsUppercaseLetter||(t.containsUppercaseLetter=n)),this.customStrengthOptions.containsNumericCharacter&&(t.containsNumericCharacter||(t.containsNumericCharacter=s)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(t.containsNonAlphanumericCharacter||(t.containsNonAlphanumericCharacter=a))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wD{constructor(t,r,n,s){this.app=t,this.heartbeatServiceProvider=r,this.appCheckServiceProvider=n,this.config=s,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new $y(this),this.idTokenSubscription=new $y(this),this.beforeStateQueue=new xD(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=YT,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=t.name,this.clientVersion=s.sdkClientVersion}_initializeWithPersistence(t,r){return r&&(this._popupRedirectResolver=na(r)),this._initializationPromise=this.queue(async()=>{var n,s;if(!this._deleted&&(this.persistenceManager=await qo.create(this,t),!this._deleted)){if(!((n=this._popupRedirectResolver)===null||n===void 0)&&n._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(r),this.lastNotifiedUid=((s=this.currentUser)===null||s===void 0?void 0:s.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const t=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!t)){if(this.currentUser&&t&&this.currentUser.uid===t.uid){this._currentUser._assign(t),await this.currentUser.getIdToken();return}await this._updateCurrentUser(t,!0)}}async initializeCurrentUserFromIdToken(t){try{const r=await ZT(this,{idToken:t}),n=await ra._fromGetAccountInfoResponse(this,r,t);await this.directlySetCurrentUser(n)}catch(r){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",r),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(t){var r;if(ea(this.app)){const i=this.app.settings.authIdToken;return i?new Promise(o=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(i).then(o,o))}):this.directlySetCurrentUser(null)}const n=await this.assertedPersistence.getCurrentUser();let s=n,a=!1;if(t&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const i=(r=this.redirectUser)===null||r===void 0?void 0:r._redirectEventId,o=s==null?void 0:s._redirectEventId,l=await this.tryRedirectSignIn(t);(!i||i===o)&&(l!=null&&l.user)&&(s=l.user,a=!0)}if(!s)return this.directlySetCurrentUser(null);if(!s._redirectEventId){if(a)try{await this.beforeStateQueue.runMiddleware(s)}catch(i){s=n,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(i))}return s?this.reloadAndSetCurrentUserOrClear(s):this.directlySetCurrentUser(null)}return Le(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===s._redirectEventId?this.directlySetCurrentUser(s):this.reloadAndSetCurrentUserOrClear(s)}async tryRedirectSignIn(t){let r=null;try{r=await this._popupRedirectResolver._completeRedirectFn(this,t,!0)}catch{await this._setRedirectUser(null)}return r}async reloadAndSetCurrentUserOrClear(t){try{await $h(t)}catch(r){if((r==null?void 0:r.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(t)}useDeviceLanguage(){this.languageCode=nD()}async _delete(){this._deleted=!0}async updateCurrentUser(t){if(ea(this.app))return Promise.reject(ji(this));const r=t?qt(t):null;return r&&Le(r.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(r&&r._clone(this))}async _updateCurrentUser(t,r=!1){if(!this._deleted)return t&&Le(this.tenantId===t.tenantId,this,"tenant-id-mismatch"),r||await this.beforeStateQueue.runMiddleware(t),this.queue(async()=>{await this.directlySetCurrentUser(t),this.notifyAuthListeners()})}async signOut(){return ea(this.app)?Promise.reject(ji(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(t){return ea(this.app)?Promise.reject(ji(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(na(t))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(t){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const r=this._getPasswordPolicyInternal();return r.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):r.validatePassword(t)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const t=await vD(this),r=new _D(t);this.tenantId===null?this._projectPasswordPolicy=r:this._tenantPasswordPolicies[this.tenantId]=r}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(t){this._errorFactory=new Iu("auth","Firebase",t())}onAuthStateChanged(t,r,n){return this.registerStateListener(this.authStateSubscription,t,r,n)}beforeAuthStateChanged(t,r){return this.beforeStateQueue.pushCallback(t,r)}onIdTokenChanged(t,r,n){return this.registerStateListener(this.idTokenSubscription,t,r,n)}authStateReady(){return new Promise((t,r)=>{if(this.currentUser)t();else{const n=this.onAuthStateChanged(()=>{n(),t()},r)}})}async revokeAccessToken(t){if(this.currentUser){const r=await this.currentUser.getIdToken(),n={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:t,idToken:r};this.tenantId!=null&&(n.tenantId=this.tenantId),await mD(this,n)}}toJSON(){var t;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(t=this._currentUser)===null||t===void 0?void 0:t.toJSON()}}async _setRedirectUser(t,r){const n=await this.getOrInitRedirectPersistenceManager(r);return t===null?n.removeCurrentUser():n.setCurrentUser(t)}async getOrInitRedirectPersistenceManager(t){if(!this.redirectPersistenceManager){const r=t&&na(t)||this._popupRedirectResolver;Le(r,this,"argument-error"),this.redirectPersistenceManager=await qo.create(this,[na(r._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(t){var r,n;return this._isInitialized&&await this.queue(async()=>{}),((r=this._currentUser)===null||r===void 0?void 0:r._redirectEventId)===t?this._currentUser:((n=this.redirectUser)===null||n===void 0?void 0:n._redirectEventId)===t?this.redirectUser:null}async _persistUserIfCurrent(t){if(t===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(t))}_notifyListenersIfCurrent(t){t===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var t,r;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const n=(r=(t=this.currentUser)===null||t===void 0?void 0:t.uid)!==null&&r!==void 0?r:null;this.lastNotifiedUid!==n&&(this.lastNotifiedUid=n,this.authStateSubscription.next(this.currentUser))}registerStateListener(t,r,n,s){if(this._deleted)return()=>{};const a=typeof r=="function"?r:r.next.bind(r);let i=!1;const o=this._isInitialized?Promise.resolve():this._initializationPromise;if(Le(o,this,"internal-error"),o.then(()=>{i||a(this.currentUser)}),typeof r=="function"){const l=t.addObserver(r,n,s);return()=>{i=!0,l()}}else{const l=t.addObserver(r);return()=>{i=!0,l()}}}async directlySetCurrentUser(t){this.currentUser&&this.currentUser!==t&&this._currentUser._stopProactiveRefresh(),t&&this.isProactiveRefreshEnabled&&t._startProactiveRefresh(),this.currentUser=t,t?await this.assertedPersistence.setCurrentUser(t):await this.assertedPersistence.removeCurrentUser()}queue(t){return this.operations=this.operations.then(t,t),this.operations}get assertedPersistence(){return Le(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(t){!t||this.frameworks.includes(t)||(this.frameworks.push(t),this.frameworks.sort(),this.clientVersion=fk(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var t;const r={"X-Client-Version":this.clientVersion};this.app.options.appId&&(r["X-Firebase-gmpid"]=this.app.options.appId);const n=await((t=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||t===void 0?void 0:t.getHeartbeatsHeader());n&&(r["X-Firebase-Client"]=n);const s=await this._getAppCheckToken();return s&&(r["X-Firebase-AppCheck"]=s),r}async _getAppCheckToken(){var t;const r=await((t=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||t===void 0?void 0:t.getToken());return r!=null&&r.error&&ZP(`Error while retrieving App Check token: ${r.error}`),r==null?void 0:r.token}}function jd(e){return qt(e)}class $y{constructor(t){this.auth=t,this.observer=null,this.addObserver=W4(r=>this.observer=r)}get next(){return Le(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let ox={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function ED(e){ox=e}function TD(e){return ox.loadJS(e)}function kD(){return ox.gapiScript}function SD(e){return`__${e}${Math.floor(Math.random()*1e6)}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function AD(e,t){const r=Cu(e,"auth");if(r.isInitialized()){const s=r.getImmediate(),a=r.getOptions();if(Bh(a,t??{}))return s;Rs(s,"already-initialized")}return r.initialize({options:t})}function ID(e,t){const r=(t==null?void 0:t.persistence)||[],n=(Array.isArray(r)?r:[r]).map(na);t!=null&&t.errorMap&&e._updateErrorMap(t.errorMap),e._initializeWithPersistence(n,t==null?void 0:t.popupRedirectResolver)}function ND(e,t,r){const n=jd(e);Le(n._canInitEmulator,n,"emulator-config-failed"),Le(/^https?:\/\//.test(t),n,"invalid-emulator-scheme");const s=!1,a=hk(t),{host:i,port:o}=CD(t),l=o===null?"":`:${o}`;n.config.emulator={url:`${a}//${i}${l}/`},n.settings.appVerificationDisabledForTesting=!0,n.emulatorConfig=Object.freeze({host:i,port:o,protocol:a.replace(":",""),options:Object.freeze({disableWarnings:s})}),bD()}function hk(e){const t=e.indexOf(":");return t<0?"":e.substr(0,t+1)}function CD(e){const t=hk(e),r=/(\/\/)?([^?#/]+)/.exec(e.substr(t.length));if(!r)return{host:"",port:null};const n=r[2].split("@").pop()||"",s=/^(\[[^\]]+\])(:|$)/.exec(n);if(s){const a=s[1];return{host:a,port:Hy(n.substr(a.length+1))}}else{const[a,i]=n.split(":");return{host:a,port:Hy(i)}}}function Hy(e){if(!e)return null;const t=Number(e);return isNaN(t)?null:t}function bD(){function e(){const t=document.createElement("p"),r=t.style;t.innerText="Running in emulator mode. Do not use with production credentials.",r.position="fixed",r.width="100%",r.backgroundColor="#ffffff",r.border=".1em solid #000000",r.color="#b50000",r.bottom="0px",r.left="0px",r.margin="0px",r.zIndex="10000",r.textAlign="center",t.classList.add("firebase-emulator-warning"),document.body.appendChild(t)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",e):e())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dk{constructor(t,r){this.providerId=t,this.signInMethod=r}toJSON(){return ta("not implemented")}_getIdTokenResponse(t){return ta("not implemented")}_linkToIdToken(t,r){return ta("not implemented")}_getReauthenticationResolver(t){return ta("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Yo(e,t){return iD(e,"POST","/v1/accounts:signInWithIdp",sx(e,t))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const RD="http://localhost";class Yi extends dk{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(t){const r=new Yi(t.providerId,t.signInMethod);return t.idToken||t.accessToken?(t.idToken&&(r.idToken=t.idToken),t.accessToken&&(r.accessToken=t.accessToken),t.nonce&&!t.pendingToken&&(r.nonce=t.nonce),t.pendingToken&&(r.pendingToken=t.pendingToken)):t.oauthToken&&t.oauthTokenSecret?(r.accessToken=t.oauthToken,r.secret=t.oauthTokenSecret):Rs("argument-error"),r}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(t){const r=typeof t=="string"?JSON.parse(t):t,{providerId:n,signInMethod:s}=r,a=ex(r,["providerId","signInMethod"]);if(!n||!s)return null;const i=new Yi(n,s);return i.idToken=a.idToken||void 0,i.accessToken=a.accessToken||void 0,i.secret=a.secret,i.nonce=a.nonce,i.pendingToken=a.pendingToken||null,i}_getIdTokenResponse(t){const r=this.buildRequest();return Yo(t,r)}_linkToIdToken(t,r){const n=this.buildRequest();return n.idToken=r,Yo(t,n)}_getReauthenticationResolver(t){const r=this.buildRequest();return r.autoCreate=!1,Yo(t,r)}buildRequest(){const t={requestUri:RD,returnSecureToken:!0};if(this.pendingToken)t.pendingToken=this.pendingToken;else{const r={};this.idToken&&(r.id_token=this.idToken),this.accessToken&&(r.access_token=this.accessToken),this.secret&&(r.oauth_token_secret=this.secret),r.providerId=this.providerId,this.nonce&&!this.pendingToken&&(r.nonce=this.nonce),t.postBody=Nu(r)}return t}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lx{constructor(t){this.providerId=t,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(t){this.defaultLanguageCode=t}setCustomParameters(t){return this.customParameters=t,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ru extends lx{constructor(){super(...arguments),this.scopes=[]}addScope(t){return this.scopes.includes(t)||this.scopes.push(t),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class La extends Ru{constructor(){super("facebook.com")}static credential(t){return Yi._fromParams({providerId:La.PROVIDER_ID,signInMethod:La.FACEBOOK_SIGN_IN_METHOD,accessToken:t})}static credentialFromResult(t){return La.credentialFromTaggedObject(t)}static credentialFromError(t){return La.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t||!("oauthAccessToken"in t)||!t.oauthAccessToken)return null;try{return La.credential(t.oauthAccessToken)}catch{return null}}}La.FACEBOOK_SIGN_IN_METHOD="facebook.com";La.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ss extends Ru{constructor(){super("google.com"),this.addScope("profile")}static credential(t,r){return Yi._fromParams({providerId:Ss.PROVIDER_ID,signInMethod:Ss.GOOGLE_SIGN_IN_METHOD,idToken:t,accessToken:r})}static credentialFromResult(t){return Ss.credentialFromTaggedObject(t)}static credentialFromError(t){return Ss.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t)return null;const{oauthIdToken:r,oauthAccessToken:n}=t;if(!r&&!n)return null;try{return Ss.credential(r,n)}catch{return null}}}Ss.GOOGLE_SIGN_IN_METHOD="google.com";Ss.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ja extends Ru{constructor(){super("github.com")}static credential(t){return Yi._fromParams({providerId:ja.PROVIDER_ID,signInMethod:ja.GITHUB_SIGN_IN_METHOD,accessToken:t})}static credentialFromResult(t){return ja.credentialFromTaggedObject(t)}static credentialFromError(t){return ja.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t||!("oauthAccessToken"in t)||!t.oauthAccessToken)return null;try{return ja.credential(t.oauthAccessToken)}catch{return null}}}ja.GITHUB_SIGN_IN_METHOD="github.com";ja.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ua extends Ru{constructor(){super("twitter.com")}static credential(t,r){return Yi._fromParams({providerId:Ua.PROVIDER_ID,signInMethod:Ua.TWITTER_SIGN_IN_METHOD,oauthToken:t,oauthTokenSecret:r})}static credentialFromResult(t){return Ua.credentialFromTaggedObject(t)}static credentialFromError(t){return Ua.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t)return null;const{oauthAccessToken:r,oauthTokenSecret:n}=t;if(!r||!n)return null;try{return Ua.credential(r,n)}catch{return null}}}Ua.TWITTER_SIGN_IN_METHOD="twitter.com";Ua.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ul{constructor(t){this.user=t.user,this.providerId=t.providerId,this._tokenResponse=t._tokenResponse,this.operationType=t.operationType}static async _fromIdTokenResponse(t,r,n,s=!1){const a=await ra._fromIdTokenResponse(t,n,s),i=Gy(n);return new ul({user:a,providerId:i,_tokenResponse:n,operationType:r})}static async _forOperation(t,r,n){await t._updateTokensIfNecessary(n,!0);const s=Gy(n);return new ul({user:t,providerId:s,_tokenResponse:n,operationType:r})}}function Gy(e){return e.providerId?e.providerId:"phoneNumber"in e?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hh extends js{constructor(t,r,n,s){var a;super(r.code,r.message),this.operationType=n,this.user=s,Object.setPrototypeOf(this,Hh.prototype),this.customData={appName:t.name,tenantId:(a=t.tenantId)!==null&&a!==void 0?a:void 0,_serverResponse:r.customData._serverResponse,operationType:n}}static _fromErrorAndOperation(t,r,n,s){return new Hh(t,r,n,s)}}function mk(e,t,r,n){return(t==="reauthenticate"?r._getReauthenticationResolver(e):r._getIdTokenResponse(e)).catch(a=>{throw a.code==="auth/multi-factor-auth-required"?Hh._fromErrorAndOperation(e,a,t,n):a})}async function PD(e,t,r=!1){const n=await tu(e,t._linkToIdToken(e.auth,await e.getIdToken()),r);return ul._forOperation(e,"link",n)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function DD(e,t,r=!1){const{auth:n}=e;if(ea(n.app))return Promise.reject(ji(n));const s="reauthenticate";try{const a=await tu(e,mk(n,s,t,e),r);Le(a.idToken,n,"internal-error");const i=ax(a.idToken);Le(i,n,"internal-error");const{sub:o}=i;return Le(e.uid===o,n,"user-mismatch"),ul._forOperation(e,s,a)}catch(a){throw(a==null?void 0:a.code)==="auth/user-not-found"&&Rs(n,"user-mismatch"),a}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function FD(e,t,r=!1){if(ea(e.app))return Promise.reject(ji(e));const n="signIn",s=await mk(e,n,t),a=await ul._fromIdTokenResponse(e,n,s);return r||await e._updateCurrentUser(a.user),a}function OD(e,t,r,n){return qt(e).onIdTokenChanged(t,r,n)}function MD(e,t,r){return qt(e).beforeAuthStateChanged(t,r)}function pk(e,t,r,n){return qt(e).onAuthStateChanged(t,r,n)}function LD(e){return qt(e).signOut()}const Gh="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gk{constructor(t,r){this.storageRetriever=t,this.type=r}_isAvailable(){try{return this.storage?(this.storage.setItem(Gh,"1"),this.storage.removeItem(Gh),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(t,r){return this.storage.setItem(t,JSON.stringify(r)),Promise.resolve()}_get(t){const r=this.storage.getItem(t);return Promise.resolve(r?JSON.parse(r):null)}_remove(t){return this.storage.removeItem(t),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jD=1e3,UD=10;class xk extends gk{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(t,r)=>this.onStorageEvent(t,r),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=uk(),this._shouldAllowMigration=!0}forAllChangedKeys(t){for(const r of Object.keys(this.listeners)){const n=this.storage.getItem(r),s=this.localCache[r];n!==s&&t(r,s,n)}}onStorageEvent(t,r=!1){if(!t.key){this.forAllChangedKeys((i,o,l)=>{this.notifyListeners(i,l)});return}const n=t.key;r?this.detachListener():this.stopPolling();const s=()=>{const i=this.storage.getItem(n);!r&&this.localCache[n]===i||this.notifyListeners(n,i)},a=this.storage.getItem(n);gD()&&a!==t.newValue&&t.newValue!==t.oldValue?setTimeout(s,UD):s()}notifyListeners(t,r){this.localCache[t]=r;const n=this.listeners[t];if(n)for(const s of Array.from(n))s(r&&JSON.parse(r))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((t,r,n)=>{this.onStorageEvent(new StorageEvent("storage",{key:t,oldValue:r,newValue:n}),!0)})},jD)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(t,r){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[t]||(this.listeners[t]=new Set,this.localCache[t]=this.storage.getItem(t)),this.listeners[t].add(r)}_removeListener(t,r){this.listeners[t]&&(this.listeners[t].delete(r),this.listeners[t].size===0&&delete this.listeners[t]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(t,r){await super._set(t,r),this.localCache[t]=JSON.stringify(r)}async _get(t){const r=await super._get(t);return this.localCache[t]=JSON.stringify(r),r}async _remove(t){await super._remove(t),delete this.localCache[t]}}xk.type="LOCAL";const VD=xk;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vk extends gk{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(t,r){}_removeListener(t,r){}}vk.type="SESSION";const yk=vk;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function BD(e){return Promise.all(e.map(async t=>{try{return{fulfilled:!0,value:await t}}catch(r){return{fulfilled:!1,reason:r}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ud{constructor(t){this.eventTarget=t,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(t){const r=this.receivers.find(s=>s.isListeningto(t));if(r)return r;const n=new Ud(t);return this.receivers.push(n),n}isListeningto(t){return this.eventTarget===t}async handleEvent(t){const r=t,{eventId:n,eventType:s,data:a}=r.data,i=this.handlersMap[s];if(!(i!=null&&i.size))return;r.ports[0].postMessage({status:"ack",eventId:n,eventType:s});const o=Array.from(i).map(async c=>c(r.origin,a)),l=await BD(o);r.ports[0].postMessage({status:"done",eventId:n,eventType:s,response:l})}_subscribe(t,r){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[t]||(this.handlersMap[t]=new Set),this.handlersMap[t].add(r)}_unsubscribe(t,r){this.handlersMap[t]&&r&&this.handlersMap[t].delete(r),(!r||this.handlersMap[t].size===0)&&delete this.handlersMap[t],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}Ud.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cx(e="",t=10){let r="";for(let n=0;n<t;n++)r+=Math.floor(Math.random()*10);return e+r}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class WD{constructor(t){this.target=t,this.handlers=new Set}removeMessageHandler(t){t.messageChannel&&(t.messageChannel.port1.removeEventListener("message",t.onMessage),t.messageChannel.port1.close()),this.handlers.delete(t)}async _send(t,r,n=50){const s=typeof MessageChannel<"u"?new MessageChannel:null;if(!s)throw new Error("connection_unavailable");let a,i;return new Promise((o,l)=>{const c=cx("",20);s.port1.start();const f=setTimeout(()=>{l(new Error("unsupported_event"))},n);i={messageChannel:s,onMessage(d){const m=d;if(m.data.eventId===c)switch(m.data.status){case"ack":clearTimeout(f),a=setTimeout(()=>{l(new Error("timeout"))},3e3);break;case"done":clearTimeout(a),o(m.data.response);break;default:clearTimeout(f),clearTimeout(a),l(new Error("invalid_response"));break}}},this.handlers.add(i),s.port1.addEventListener("message",i.onMessage),this.target.postMessage({eventType:t,eventId:c,data:r},[s.port2])}).finally(()=>{i&&this.removeMessageHandler(i)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ns(){return window}function zD(e){Ns().location.href=e}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _k(){return typeof Ns().WorkerGlobalScope<"u"&&typeof Ns().importScripts=="function"}async function $D(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function HD(){var e;return((e=navigator==null?void 0:navigator.serviceWorker)===null||e===void 0?void 0:e.controller)||null}function GD(){return _k()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wk="firebaseLocalStorageDb",KD=1,Kh="firebaseLocalStorage",Ek="fbase_key";class Pu{constructor(t){this.request=t}toPromise(){return new Promise((t,r)=>{this.request.addEventListener("success",()=>{t(this.request.result)}),this.request.addEventListener("error",()=>{r(this.request.error)})})}}function Vd(e,t){return e.transaction([Kh],t?"readwrite":"readonly").objectStore(Kh)}function qD(){const e=indexedDB.deleteDatabase(wk);return new Pu(e).toPromise()}function yp(){const e=indexedDB.open(wk,KD);return new Promise((t,r)=>{e.addEventListener("error",()=>{r(e.error)}),e.addEventListener("upgradeneeded",()=>{const n=e.result;try{n.createObjectStore(Kh,{keyPath:Ek})}catch(s){r(s)}}),e.addEventListener("success",async()=>{const n=e.result;n.objectStoreNames.contains(Kh)?t(n):(n.close(),await qD(),t(await yp()))})})}async function Ky(e,t,r){const n=Vd(e,!0).put({[Ek]:t,value:r});return new Pu(n).toPromise()}async function YD(e,t){const r=Vd(e,!1).get(t),n=await new Pu(r).toPromise();return n===void 0?null:n.value}function qy(e,t){const r=Vd(e,!0).delete(t);return new Pu(r).toPromise()}const XD=800,QD=3;class Tk{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await yp(),this.db)}async _withRetries(t){let r=0;for(;;)try{const n=await this._openDb();return await t(n)}catch(n){if(r++>QD)throw n;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return _k()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=Ud._getInstance(GD()),this.receiver._subscribe("keyChanged",async(t,r)=>({keyProcessed:(await this._poll()).includes(r.key)})),this.receiver._subscribe("ping",async(t,r)=>["keyChanged"])}async initializeSender(){var t,r;if(this.activeServiceWorker=await $D(),!this.activeServiceWorker)return;this.sender=new WD(this.activeServiceWorker);const n=await this.sender._send("ping",{},800);n&&!((t=n[0])===null||t===void 0)&&t.fulfilled&&!((r=n[0])===null||r===void 0)&&r.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(t){if(!(!this.sender||!this.activeServiceWorker||HD()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:t},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const t=await yp();return await Ky(t,Gh,"1"),await qy(t,Gh),!0}catch{}return!1}async _withPendingWrite(t){this.pendingWrites++;try{await t()}finally{this.pendingWrites--}}async _set(t,r){return this._withPendingWrite(async()=>(await this._withRetries(n=>Ky(n,t,r)),this.localCache[t]=r,this.notifyServiceWorker(t)))}async _get(t){const r=await this._withRetries(n=>YD(n,t));return this.localCache[t]=r,r}async _remove(t){return this._withPendingWrite(async()=>(await this._withRetries(r=>qy(r,t)),delete this.localCache[t],this.notifyServiceWorker(t)))}async _poll(){const t=await this._withRetries(s=>{const a=Vd(s,!1).getAll();return new Pu(a).toPromise()});if(!t)return[];if(this.pendingWrites!==0)return[];const r=[],n=new Set;if(t.length!==0)for(const{fbase_key:s,value:a}of t)n.add(s),JSON.stringify(this.localCache[s])!==JSON.stringify(a)&&(this.notifyListeners(s,a),r.push(s));for(const s of Object.keys(this.localCache))this.localCache[s]&&!n.has(s)&&(this.notifyListeners(s,null),r.push(s));return r}notifyListeners(t,r){this.localCache[t]=r;const n=this.listeners[t];if(n)for(const s of Array.from(n))s(r)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),XD)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(t,r){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[t]||(this.listeners[t]=new Set,this._get(t)),this.listeners[t].add(r)}_removeListener(t,r){this.listeners[t]&&(this.listeners[t].delete(r),this.listeners[t].size===0&&delete this.listeners[t]),Object.keys(this.listeners).length===0&&this.stopPolling()}}Tk.type="LOCAL";const JD=Tk;new bu(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kk(e,t){return t?na(t):(Le(e._popupRedirectResolver,e,"argument-error"),e._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ux extends dk{constructor(t){super("custom","custom"),this.params=t}_getIdTokenResponse(t){return Yo(t,this._buildIdpRequest())}_linkToIdToken(t,r){return Yo(t,this._buildIdpRequest(r))}_getReauthenticationResolver(t){return Yo(t,this._buildIdpRequest())}_buildIdpRequest(t){const r={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return t&&(r.idToken=t),r}}function ZD(e){return FD(e.auth,new ux(e),e.bypassAuthState)}function e3(e){const{auth:t,user:r}=e;return Le(r,t,"internal-error"),DD(r,new ux(e),e.bypassAuthState)}async function t3(e){const{auth:t,user:r}=e;return Le(r,t,"internal-error"),PD(r,new ux(e),e.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sk{constructor(t,r,n,s,a=!1){this.auth=t,this.resolver=n,this.user=s,this.bypassAuthState=a,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(r)?r:[r]}execute(){return new Promise(async(t,r)=>{this.pendingPromise={resolve:t,reject:r};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(n){this.reject(n)}})}async onAuthEvent(t){const{urlResponse:r,sessionId:n,postBody:s,tenantId:a,error:i,type:o}=t;if(i){this.reject(i);return}const l={auth:this.auth,requestUri:r,sessionId:n,tenantId:a||void 0,postBody:s||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(o)(l))}catch(c){this.reject(c)}}onError(t){this.reject(t)}getIdpTask(t){switch(t){case"signInViaPopup":case"signInViaRedirect":return ZD;case"linkViaPopup":case"linkViaRedirect":return t3;case"reauthViaPopup":case"reauthViaRedirect":return e3;default:Rs(this.auth,"internal-error")}}resolve(t){xa(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(t),this.unregisterAndCleanUp()}reject(t){xa(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(t),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const r3=new bu(2e3,1e4);async function Ak(e,t,r){if(ea(e.app))return Promise.reject(ds(e,"operation-not-supported-in-this-environment"));const n=jd(e);eD(e,t,lx);const s=kk(n,r);return new Di(n,"signInViaPopup",t,s).executeNotNull()}class Di extends Sk{constructor(t,r,n,s,a){super(t,r,s,a),this.provider=n,this.authWindow=null,this.pollId=null,Di.currentPopupAction&&Di.currentPopupAction.cancel(),Di.currentPopupAction=this}async executeNotNull(){const t=await this.execute();return Le(t,this.auth,"internal-error"),t}async onExecution(){xa(this.filter.length===1,"Popup operations only handle one event");const t=cx();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],t),this.authWindow.associatedEvent=t,this.resolver._originValidation(this.auth).catch(r=>{this.reject(r)}),this.resolver._isIframeWebStorageSupported(this.auth,r=>{r||this.reject(ds(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var t;return((t=this.authWindow)===null||t===void 0?void 0:t.associatedEvent)||null}cancel(){this.reject(ds(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Di.currentPopupAction=null}pollUserCancellation(){const t=()=>{var r,n;if(!((n=(r=this.authWindow)===null||r===void 0?void 0:r.window)===null||n===void 0)&&n.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(ds(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(t,r3.get())};t()}}Di.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const n3="pendingRedirect",sh=new Map;class s3 extends Sk{constructor(t,r,n=!1){super(t,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],r,void 0,n),this.eventId=null}async execute(){let t=sh.get(this.auth._key());if(!t){try{const n=await a3(this.resolver,this.auth)?await super.execute():null;t=()=>Promise.resolve(n)}catch(r){t=()=>Promise.reject(r)}sh.set(this.auth._key(),t)}return this.bypassAuthState||sh.set(this.auth._key(),()=>Promise.resolve(null)),t()}async onAuthEvent(t){if(t.type==="signInViaRedirect")return super.onAuthEvent(t);if(t.type==="unknown"){this.resolve(null);return}if(t.eventId){const r=await this.auth._redirectUserForId(t.eventId);if(r)return this.user=r,super.onAuthEvent(t);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function a3(e,t){const r=l3(t),n=o3(e);if(!await n._isAvailable())return!1;const s=await n._get(r)==="true";return await n._remove(r),s}function i3(e,t){sh.set(e._key(),t)}function o3(e){return na(e._redirectPersistence)}function l3(e){return nh(n3,e.config.apiKey,e.name)}async function c3(e,t,r=!1){if(ea(e.app))return Promise.reject(ji(e));const n=jd(e),s=kk(n,t),i=await new s3(n,s,r).execute();return i&&!r&&(delete i.user._redirectEventId,await n._persistUserIfCurrent(i.user),await n._setRedirectUser(null,t)),i}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const u3=10*60*1e3;class f3{constructor(t){this.auth=t,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(t){this.consumers.add(t),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,t)&&(this.sendToConsumer(this.queuedRedirectEvent,t),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(t){this.consumers.delete(t)}onEvent(t){if(this.hasEventBeenHandled(t))return!1;let r=!1;return this.consumers.forEach(n=>{this.isEventForConsumer(t,n)&&(r=!0,this.sendToConsumer(t,n),this.saveEventToCache(t))}),this.hasHandledPotentialRedirect||!h3(t)||(this.hasHandledPotentialRedirect=!0,r||(this.queuedRedirectEvent=t,r=!0)),r}sendToConsumer(t,r){var n;if(t.error&&!Ik(t)){const s=((n=t.error.code)===null||n===void 0?void 0:n.split("auth/")[1])||"internal-error";r.onError(ds(this.auth,s))}else r.onAuthEvent(t)}isEventForConsumer(t,r){const n=r.eventId===null||!!t.eventId&&t.eventId===r.eventId;return r.filter.includes(t.type)&&n}hasEventBeenHandled(t){return Date.now()-this.lastProcessedEventTime>=u3&&this.cachedEventUids.clear(),this.cachedEventUids.has(Yy(t))}saveEventToCache(t){this.cachedEventUids.add(Yy(t)),this.lastProcessedEventTime=Date.now()}}function Yy(e){return[e.type,e.eventId,e.sessionId,e.tenantId].filter(t=>t).join("-")}function Ik({type:e,error:t}){return e==="unknown"&&(t==null?void 0:t.code)==="auth/no-auth-event"}function h3(e){switch(e.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return Ik(e);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function d3(e,t={}){return kl(e,"GET","/v1/projects",t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const m3=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,p3=/^https?/;async function g3(e){if(e.config.emulator)return;const{authorizedDomains:t}=await d3(e);for(const r of t)try{if(x3(r))return}catch{}Rs(e,"unauthorized-domain")}function x3(e){const t=xp(),{protocol:r,hostname:n}=new URL(t);if(e.startsWith("chrome-extension://")){const i=new URL(e);return i.hostname===""&&n===""?r==="chrome-extension:"&&e.replace("chrome-extension://","")===t.replace("chrome-extension://",""):r==="chrome-extension:"&&i.hostname===n}if(!p3.test(r))return!1;if(m3.test(e))return n===e;const s=e.replace(/\./g,"\\.");return new RegExp("^(.+\\."+s+"|"+s+")$","i").test(n)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const v3=new bu(3e4,6e4);function Xy(){const e=Ns().___jsl;if(e!=null&&e.H){for(const t of Object.keys(e.H))if(e.H[t].r=e.H[t].r||[],e.H[t].L=e.H[t].L||[],e.H[t].r=[...e.H[t].L],e.CP)for(let r=0;r<e.CP.length;r++)e.CP[r]=null}}function y3(e){return new Promise((t,r)=>{var n,s,a;function i(){Xy(),gapi.load("gapi.iframes",{callback:()=>{t(gapi.iframes.getContext())},ontimeout:()=>{Xy(),r(ds(e,"network-request-failed"))},timeout:v3.get()})}if(!((s=(n=Ns().gapi)===null||n===void 0?void 0:n.iframes)===null||s===void 0)&&s.Iframe)t(gapi.iframes.getContext());else if(!((a=Ns().gapi)===null||a===void 0)&&a.load)i();else{const o=SD("iframefcb");return Ns()[o]=()=>{gapi.load?i():r(ds(e,"network-request-failed"))},TD(`${kD()}?onload=${o}`).catch(l=>r(l))}}).catch(t=>{throw ah=null,t})}let ah=null;function _3(e){return ah=ah||y3(e),ah}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const w3=new bu(5e3,15e3),E3="__/auth/iframe",T3="emulator/auth/iframe",k3={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},S3=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function A3(e){const t=e.config;Le(t.authDomain,e,"auth-domain-config-required");const r=t.emulator?nx(t,T3):`https://${e.config.authDomain}/${E3}`,n={apiKey:t.apiKey,appName:e.name,v:so},s=S3.get(e.config.apiHost);s&&(n.eid=s);const a=e._getFrameworks();return a.length&&(n.fw=a.join(",")),`${r}?${Nu(n).slice(1)}`}async function I3(e){const t=await _3(e),r=Ns().gapi;return Le(r,e,"internal-error"),t.open({where:document.body,url:A3(e),messageHandlersFilter:r.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:k3,dontclear:!0},n=>new Promise(async(s,a)=>{await n.restyle({setHideOnLeave:!1});const i=ds(e,"network-request-failed"),o=Ns().setTimeout(()=>{a(i)},w3.get());function l(){Ns().clearTimeout(o),s(n)}n.ping(l).then(l,()=>{a(i)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const N3={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},C3=500,b3=600,R3="_blank",P3="http://localhost";class Qy{constructor(t){this.window=t,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function D3(e,t,r,n=C3,s=b3){const a=Math.max((window.screen.availHeight-s)/2,0).toString(),i=Math.max((window.screen.availWidth-n)/2,0).toString();let o="";const l=Object.assign(Object.assign({},N3),{width:n.toString(),height:s.toString(),top:a,left:i}),c=Hr().toLowerCase();r&&(o=ak(c)?R3:r),nk(c)&&(t=t||P3,l.scrollbars="yes");const f=Object.entries(l).reduce((m,[p,x])=>`${m}${p}=${x},`,"");if(pD(c)&&o!=="_self")return F3(t||"",o),new Qy(null);const d=window.open(t||"",o,f);Le(d,e,"popup-blocked");try{d.focus()}catch{}return new Qy(d)}function F3(e,t){const r=document.createElement("a");r.href=e,r.target=t;const n=document.createEvent("MouseEvent");n.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),r.dispatchEvent(n)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const O3="__/auth/handler",M3="emulator/auth/handler",L3=encodeURIComponent("fac");async function Jy(e,t,r,n,s,a){Le(e.config.authDomain,e,"auth-domain-config-required"),Le(e.config.apiKey,e,"invalid-api-key");const i={apiKey:e.config.apiKey,appName:e.name,authType:r,redirectUrl:n,v:so,eventId:s};if(t instanceof lx){t.setDefaultLanguage(e.languageCode),i.providerId=t.providerId||"",B4(t.getCustomParameters())||(i.customParameters=JSON.stringify(t.getCustomParameters()));for(const[f,d]of Object.entries({}))i[f]=d}if(t instanceof Ru){const f=t.getScopes().filter(d=>d!=="");f.length>0&&(i.scopes=f.join(","))}e.tenantId&&(i.tid=e.tenantId);const o=i;for(const f of Object.keys(o))o[f]===void 0&&delete o[f];const l=await e._getAppCheckToken(),c=l?`#${L3}=${encodeURIComponent(l)}`:"";return`${j3(e)}?${Nu(o).slice(1)}${c}`}function j3({config:e}){return e.emulator?nx(e,M3):`https://${e.authDomain}/${O3}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Q0="webStorageSupport";class U3{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=yk,this._completeRedirectFn=c3,this._overrideRedirectResult=i3}async _openPopup(t,r,n,s){var a;xa((a=this.eventManagers[t._key()])===null||a===void 0?void 0:a.manager,"_initialize() not called before _openPopup()");const i=await Jy(t,r,n,xp(),s);return D3(t,i,cx())}async _openRedirect(t,r,n,s){await this._originValidation(t);const a=await Jy(t,r,n,xp(),s);return zD(a),new Promise(()=>{})}_initialize(t){const r=t._key();if(this.eventManagers[r]){const{manager:s,promise:a}=this.eventManagers[r];return s?Promise.resolve(s):(xa(a,"If manager is not set, promise should be"),a)}const n=this.initAndGetManager(t);return this.eventManagers[r]={promise:n},n.catch(()=>{delete this.eventManagers[r]}),n}async initAndGetManager(t){const r=await I3(t),n=new f3(t);return r.register("authEvent",s=>(Le(s==null?void 0:s.authEvent,t,"invalid-auth-event"),{status:n.onEvent(s.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[t._key()]={manager:n},this.iframes[t._key()]=r,n}_isIframeWebStorageSupported(t,r){this.iframes[t._key()].send(Q0,{type:Q0},s=>{var a;const i=(a=s==null?void 0:s[0])===null||a===void 0?void 0:a[Q0];i!==void 0&&r(!!i),Rs(t,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(t){const r=t._key();return this.originValidationPromises[r]||(this.originValidationPromises[r]=g3(t)),this.originValidationPromises[r]}get _shouldInitProactively(){return uk()||sk()||ix()}}const V3=U3;var Zy="@firebase/auth",e_="1.7.9";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class B3{constructor(t){this.auth=t,this.internalListeners=new Map}getUid(){var t;return this.assertAuthConfigured(),((t=this.auth.currentUser)===null||t===void 0?void 0:t.uid)||null}async getToken(t){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(t)}:null}addAuthTokenListener(t){if(this.assertAuthConfigured(),this.internalListeners.has(t))return;const r=this.auth.onIdTokenChanged(n=>{t((n==null?void 0:n.stsTokenManager.accessToken)||null)});this.internalListeners.set(t,r),this.updateProactiveRefresh()}removeAuthTokenListener(t){this.assertAuthConfigured();const r=this.internalListeners.get(t);r&&(this.internalListeners.delete(t),r(),this.updateProactiveRefresh())}assertAuthConfigured(){Le(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function W3(e){switch(e){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function z3(e){li(new pa("auth",(t,{options:r})=>{const n=t.getProvider("app").getImmediate(),s=t.getProvider("heartbeat"),a=t.getProvider("app-check-internal"),{apiKey:i,authDomain:o}=n.options;Le(i&&!i.includes(":"),"invalid-api-key",{appName:n.name});const l={apiKey:i,authDomain:o,clientPlatform:e,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:fk(e)},c=new wD(n,s,a,l);return ID(c,r),c},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((t,r,n)=>{t.getProvider("auth-internal").initialize()})),li(new pa("auth-internal",t=>{const r=jd(t.getProvider("auth").getImmediate());return(n=>new B3(n))(r)},"PRIVATE").setInstantiationMode("EXPLICIT")),$n(Zy,e_,W3(e)),$n(Zy,e_,"esm2017")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $3=5*60,H3=BT("authIdTokenMaxAge")||$3;let t_=null;const G3=e=>async t=>{const r=t&&await t.getIdTokenResult(),n=r&&(new Date().getTime()-Date.parse(r.issuedAtTime))/1e3;if(n&&n>H3)return;const s=r==null?void 0:r.token;t_!==s&&(t_=s,await fetch(e,{method:s?"POST":"DELETE",headers:s?{Authorization:`Bearer ${s}`}:{}}))};function K3(e=Ld()){const t=Cu(e,"auth");if(t.isInitialized())return t.getImmediate();const r=AD(e,{popupRedirectResolver:V3,persistence:[JD,VD,yk]}),n=BT("authTokenSyncURL");if(n&&typeof isSecureContext=="boolean"&&isSecureContext){const a=new URL(n,location.origin);if(location.origin===a.origin){const i=G3(a.toString());MD(r,i,()=>i(r.currentUser)),OD(r,o=>i(o))}}const s=UT("auth");return s&&ND(r,`http://${s}`),r}function q3(){var e,t;return(t=(e=document.getElementsByTagName("head"))===null||e===void 0?void 0:e[0])!==null&&t!==void 0?t:document}ED({loadJS(e){return new Promise((t,r)=>{const n=document.createElement("script");n.setAttribute("src",e),n.onload=t,n.onerror=s=>{const a=ds("internal-error");a.customData=s,r(a)},n.type="text/javascript",n.charset="UTF-8",q3().appendChild(n)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});z3("Browser");var r_=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Ui,Nk;(function(){var e;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function t(v,T){function S(){}S.prototype=T.prototype,v.D=T.prototype,v.prototype=new S,v.prototype.constructor=v,v.C=function(C,b,P){for(var D=Array(arguments.length-2),ie=2;ie<arguments.length;ie++)D[ie-2]=arguments[ie];return T.prototype[b].apply(C,D)}}function r(){this.blockSize=-1}function n(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}t(n,r),n.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function s(v,T,S){S||(S=0);var C=Array(16);if(typeof T=="string")for(var b=0;16>b;++b)C[b]=T.charCodeAt(S++)|T.charCodeAt(S++)<<8|T.charCodeAt(S++)<<16|T.charCodeAt(S++)<<24;else for(b=0;16>b;++b)C[b]=T[S++]|T[S++]<<8|T[S++]<<16|T[S++]<<24;T=v.g[0],S=v.g[1],b=v.g[2];var P=v.g[3],D=T+(P^S&(b^P))+C[0]+3614090360&4294967295;T=S+(D<<7&4294967295|D>>>25),D=P+(b^T&(S^b))+C[1]+3905402710&4294967295,P=T+(D<<12&4294967295|D>>>20),D=b+(S^P&(T^S))+C[2]+606105819&4294967295,b=P+(D<<17&4294967295|D>>>15),D=S+(T^b&(P^T))+C[3]+3250441966&4294967295,S=b+(D<<22&4294967295|D>>>10),D=T+(P^S&(b^P))+C[4]+4118548399&4294967295,T=S+(D<<7&4294967295|D>>>25),D=P+(b^T&(S^b))+C[5]+1200080426&4294967295,P=T+(D<<12&4294967295|D>>>20),D=b+(S^P&(T^S))+C[6]+2821735955&4294967295,b=P+(D<<17&4294967295|D>>>15),D=S+(T^b&(P^T))+C[7]+4249261313&4294967295,S=b+(D<<22&4294967295|D>>>10),D=T+(P^S&(b^P))+C[8]+1770035416&4294967295,T=S+(D<<7&4294967295|D>>>25),D=P+(b^T&(S^b))+C[9]+2336552879&4294967295,P=T+(D<<12&4294967295|D>>>20),D=b+(S^P&(T^S))+C[10]+4294925233&4294967295,b=P+(D<<17&4294967295|D>>>15),D=S+(T^b&(P^T))+C[11]+2304563134&4294967295,S=b+(D<<22&4294967295|D>>>10),D=T+(P^S&(b^P))+C[12]+1804603682&4294967295,T=S+(D<<7&4294967295|D>>>25),D=P+(b^T&(S^b))+C[13]+4254626195&4294967295,P=T+(D<<12&4294967295|D>>>20),D=b+(S^P&(T^S))+C[14]+2792965006&4294967295,b=P+(D<<17&4294967295|D>>>15),D=S+(T^b&(P^T))+C[15]+1236535329&4294967295,S=b+(D<<22&4294967295|D>>>10),D=T+(b^P&(S^b))+C[1]+4129170786&4294967295,T=S+(D<<5&4294967295|D>>>27),D=P+(S^b&(T^S))+C[6]+3225465664&4294967295,P=T+(D<<9&4294967295|D>>>23),D=b+(T^S&(P^T))+C[11]+643717713&4294967295,b=P+(D<<14&4294967295|D>>>18),D=S+(P^T&(b^P))+C[0]+3921069994&4294967295,S=b+(D<<20&4294967295|D>>>12),D=T+(b^P&(S^b))+C[5]+3593408605&4294967295,T=S+(D<<5&4294967295|D>>>27),D=P+(S^b&(T^S))+C[10]+38016083&4294967295,P=T+(D<<9&4294967295|D>>>23),D=b+(T^S&(P^T))+C[15]+3634488961&4294967295,b=P+(D<<14&4294967295|D>>>18),D=S+(P^T&(b^P))+C[4]+3889429448&4294967295,S=b+(D<<20&4294967295|D>>>12),D=T+(b^P&(S^b))+C[9]+568446438&4294967295,T=S+(D<<5&4294967295|D>>>27),D=P+(S^b&(T^S))+C[14]+3275163606&4294967295,P=T+(D<<9&4294967295|D>>>23),D=b+(T^S&(P^T))+C[3]+4107603335&4294967295,b=P+(D<<14&4294967295|D>>>18),D=S+(P^T&(b^P))+C[8]+1163531501&4294967295,S=b+(D<<20&4294967295|D>>>12),D=T+(b^P&(S^b))+C[13]+2850285829&4294967295,T=S+(D<<5&4294967295|D>>>27),D=P+(S^b&(T^S))+C[2]+4243563512&4294967295,P=T+(D<<9&4294967295|D>>>23),D=b+(T^S&(P^T))+C[7]+1735328473&4294967295,b=P+(D<<14&4294967295|D>>>18),D=S+(P^T&(b^P))+C[12]+2368359562&4294967295,S=b+(D<<20&4294967295|D>>>12),D=T+(S^b^P)+C[5]+4294588738&4294967295,T=S+(D<<4&4294967295|D>>>28),D=P+(T^S^b)+C[8]+2272392833&4294967295,P=T+(D<<11&4294967295|D>>>21),D=b+(P^T^S)+C[11]+1839030562&4294967295,b=P+(D<<16&4294967295|D>>>16),D=S+(b^P^T)+C[14]+4259657740&4294967295,S=b+(D<<23&4294967295|D>>>9),D=T+(S^b^P)+C[1]+2763975236&4294967295,T=S+(D<<4&4294967295|D>>>28),D=P+(T^S^b)+C[4]+1272893353&4294967295,P=T+(D<<11&4294967295|D>>>21),D=b+(P^T^S)+C[7]+4139469664&4294967295,b=P+(D<<16&4294967295|D>>>16),D=S+(b^P^T)+C[10]+3200236656&4294967295,S=b+(D<<23&4294967295|D>>>9),D=T+(S^b^P)+C[13]+681279174&4294967295,T=S+(D<<4&4294967295|D>>>28),D=P+(T^S^b)+C[0]+3936430074&4294967295,P=T+(D<<11&4294967295|D>>>21),D=b+(P^T^S)+C[3]+3572445317&4294967295,b=P+(D<<16&4294967295|D>>>16),D=S+(b^P^T)+C[6]+76029189&4294967295,S=b+(D<<23&4294967295|D>>>9),D=T+(S^b^P)+C[9]+3654602809&4294967295,T=S+(D<<4&4294967295|D>>>28),D=P+(T^S^b)+C[12]+3873151461&4294967295,P=T+(D<<11&4294967295|D>>>21),D=b+(P^T^S)+C[15]+530742520&4294967295,b=P+(D<<16&4294967295|D>>>16),D=S+(b^P^T)+C[2]+3299628645&4294967295,S=b+(D<<23&4294967295|D>>>9),D=T+(b^(S|~P))+C[0]+4096336452&4294967295,T=S+(D<<6&4294967295|D>>>26),D=P+(S^(T|~b))+C[7]+1126891415&4294967295,P=T+(D<<10&4294967295|D>>>22),D=b+(T^(P|~S))+C[14]+2878612391&4294967295,b=P+(D<<15&4294967295|D>>>17),D=S+(P^(b|~T))+C[5]+4237533241&4294967295,S=b+(D<<21&4294967295|D>>>11),D=T+(b^(S|~P))+C[12]+1700485571&4294967295,T=S+(D<<6&4294967295|D>>>26),D=P+(S^(T|~b))+C[3]+2399980690&4294967295,P=T+(D<<10&4294967295|D>>>22),D=b+(T^(P|~S))+C[10]+4293915773&4294967295,b=P+(D<<15&4294967295|D>>>17),D=S+(P^(b|~T))+C[1]+2240044497&4294967295,S=b+(D<<21&4294967295|D>>>11),D=T+(b^(S|~P))+C[8]+1873313359&4294967295,T=S+(D<<6&4294967295|D>>>26),D=P+(S^(T|~b))+C[15]+4264355552&4294967295,P=T+(D<<10&4294967295|D>>>22),D=b+(T^(P|~S))+C[6]+2734768916&4294967295,b=P+(D<<15&4294967295|D>>>17),D=S+(P^(b|~T))+C[13]+1309151649&4294967295,S=b+(D<<21&4294967295|D>>>11),D=T+(b^(S|~P))+C[4]+4149444226&4294967295,T=S+(D<<6&4294967295|D>>>26),D=P+(S^(T|~b))+C[11]+3174756917&4294967295,P=T+(D<<10&4294967295|D>>>22),D=b+(T^(P|~S))+C[2]+718787259&4294967295,b=P+(D<<15&4294967295|D>>>17),D=S+(P^(b|~T))+C[9]+3951481745&4294967295,v.g[0]=v.g[0]+T&4294967295,v.g[1]=v.g[1]+(b+(D<<21&4294967295|D>>>11))&4294967295,v.g[2]=v.g[2]+b&4294967295,v.g[3]=v.g[3]+P&4294967295}n.prototype.u=function(v,T){T===void 0&&(T=v.length);for(var S=T-this.blockSize,C=this.B,b=this.h,P=0;P<T;){if(b==0)for(;P<=S;)s(this,v,P),P+=this.blockSize;if(typeof v=="string"){for(;P<T;)if(C[b++]=v.charCodeAt(P++),b==this.blockSize){s(this,C),b=0;break}}else for(;P<T;)if(C[b++]=v[P++],b==this.blockSize){s(this,C),b=0;break}}this.h=b,this.o+=T},n.prototype.v=function(){var v=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);v[0]=128;for(var T=1;T<v.length-8;++T)v[T]=0;var S=8*this.o;for(T=v.length-8;T<v.length;++T)v[T]=S&255,S/=256;for(this.u(v),v=Array(16),T=S=0;4>T;++T)for(var C=0;32>C;C+=8)v[S++]=this.g[T]>>>C&255;return v};function a(v,T){var S=o;return Object.prototype.hasOwnProperty.call(S,v)?S[v]:S[v]=T(v)}function i(v,T){this.h=T;for(var S=[],C=!0,b=v.length-1;0<=b;b--){var P=v[b]|0;C&&P==T||(S[b]=P,C=!1)}this.g=S}var o={};function l(v){return-128<=v&&128>v?a(v,function(T){return new i([T|0],0>T?-1:0)}):new i([v|0],0>v?-1:0)}function c(v){if(isNaN(v)||!isFinite(v))return d;if(0>v)return w(c(-v));for(var T=[],S=1,C=0;v>=S;C++)T[C]=v/S|0,S*=4294967296;return new i(T,0)}function f(v,T){if(v.length==0)throw Error("number format error: empty string");if(T=T||10,2>T||36<T)throw Error("radix out of range: "+T);if(v.charAt(0)=="-")return w(f(v.substring(1),T));if(0<=v.indexOf("-"))throw Error('number format error: interior "-" character');for(var S=c(Math.pow(T,8)),C=d,b=0;b<v.length;b+=8){var P=Math.min(8,v.length-b),D=parseInt(v.substring(b,b+P),T);8>P?(P=c(Math.pow(T,P)),C=C.j(P).add(c(D))):(C=C.j(S),C=C.add(c(D)))}return C}var d=l(0),m=l(1),p=l(16777216);e=i.prototype,e.m=function(){if(g(this))return-w(this).m();for(var v=0,T=1,S=0;S<this.g.length;S++){var C=this.i(S);v+=(0<=C?C:4294967296+C)*T,T*=4294967296}return v},e.toString=function(v){if(v=v||10,2>v||36<v)throw Error("radix out of range: "+v);if(x(this))return"0";if(g(this))return"-"+w(this).toString(v);for(var T=c(Math.pow(v,6)),S=this,C="";;){var b=I(S,T).g;S=k(S,b.j(T));var P=((0<S.g.length?S.g[0]:S.h)>>>0).toString(v);if(S=b,x(S))return P+C;for(;6>P.length;)P="0"+P;C=P+C}},e.i=function(v){return 0>v?0:v<this.g.length?this.g[v]:this.h};function x(v){if(v.h!=0)return!1;for(var T=0;T<v.g.length;T++)if(v.g[T]!=0)return!1;return!0}function g(v){return v.h==-1}e.l=function(v){return v=k(this,v),g(v)?-1:x(v)?0:1};function w(v){for(var T=v.g.length,S=[],C=0;C<T;C++)S[C]=~v.g[C];return new i(S,~v.h).add(m)}e.abs=function(){return g(this)?w(this):this},e.add=function(v){for(var T=Math.max(this.g.length,v.g.length),S=[],C=0,b=0;b<=T;b++){var P=C+(this.i(b)&65535)+(v.i(b)&65535),D=(P>>>16)+(this.i(b)>>>16)+(v.i(b)>>>16);C=D>>>16,P&=65535,D&=65535,S[b]=D<<16|P}return new i(S,S[S.length-1]&-2147483648?-1:0)};function k(v,T){return v.add(w(T))}e.j=function(v){if(x(this)||x(v))return d;if(g(this))return g(v)?w(this).j(w(v)):w(w(this).j(v));if(g(v))return w(this.j(w(v)));if(0>this.l(p)&&0>v.l(p))return c(this.m()*v.m());for(var T=this.g.length+v.g.length,S=[],C=0;C<2*T;C++)S[C]=0;for(C=0;C<this.g.length;C++)for(var b=0;b<v.g.length;b++){var P=this.i(C)>>>16,D=this.i(C)&65535,ie=v.i(b)>>>16,Z=v.i(b)&65535;S[2*C+2*b]+=D*Z,E(S,2*C+2*b),S[2*C+2*b+1]+=P*Z,E(S,2*C+2*b+1),S[2*C+2*b+1]+=D*ie,E(S,2*C+2*b+1),S[2*C+2*b+2]+=P*ie,E(S,2*C+2*b+2)}for(C=0;C<T;C++)S[C]=S[2*C+1]<<16|S[2*C];for(C=T;C<2*T;C++)S[C]=0;return new i(S,0)};function E(v,T){for(;(v[T]&65535)!=v[T];)v[T+1]+=v[T]>>>16,v[T]&=65535,T++}function y(v,T){this.g=v,this.h=T}function I(v,T){if(x(T))throw Error("division by zero");if(x(v))return new y(d,d);if(g(v))return T=I(w(v),T),new y(w(T.g),w(T.h));if(g(T))return T=I(v,w(T)),new y(w(T.g),T.h);if(30<v.g.length){if(g(v)||g(T))throw Error("slowDivide_ only works with positive integers.");for(var S=m,C=T;0>=C.l(v);)S=M(S),C=M(C);var b=O(S,1),P=O(C,1);for(C=O(C,2),S=O(S,2);!x(C);){var D=P.add(C);0>=D.l(v)&&(b=b.add(S),P=D),C=O(C,1),S=O(S,1)}return T=k(v,b.j(T)),new y(b,T)}for(b=d;0<=v.l(T);){for(S=Math.max(1,Math.floor(v.m()/T.m())),C=Math.ceil(Math.log(S)/Math.LN2),C=48>=C?1:Math.pow(2,C-48),P=c(S),D=P.j(T);g(D)||0<D.l(v);)S-=C,P=c(S),D=P.j(T);x(P)&&(P=m),b=b.add(P),v=k(v,D)}return new y(b,v)}e.A=function(v){return I(this,v).h},e.and=function(v){for(var T=Math.max(this.g.length,v.g.length),S=[],C=0;C<T;C++)S[C]=this.i(C)&v.i(C);return new i(S,this.h&v.h)},e.or=function(v){for(var T=Math.max(this.g.length,v.g.length),S=[],C=0;C<T;C++)S[C]=this.i(C)|v.i(C);return new i(S,this.h|v.h)},e.xor=function(v){for(var T=Math.max(this.g.length,v.g.length),S=[],C=0;C<T;C++)S[C]=this.i(C)^v.i(C);return new i(S,this.h^v.h)};function M(v){for(var T=v.g.length+1,S=[],C=0;C<T;C++)S[C]=v.i(C)<<1|v.i(C-1)>>>31;return new i(S,v.h)}function O(v,T){var S=T>>5;T%=32;for(var C=v.g.length-S,b=[],P=0;P<C;P++)b[P]=0<T?v.i(P+S)>>>T|v.i(P+S+1)<<32-T:v.i(P+S);return new i(b,v.h)}n.prototype.digest=n.prototype.v,n.prototype.reset=n.prototype.s,n.prototype.update=n.prototype.u,Nk=n,i.prototype.add=i.prototype.add,i.prototype.multiply=i.prototype.j,i.prototype.modulo=i.prototype.A,i.prototype.compare=i.prototype.l,i.prototype.toNumber=i.prototype.m,i.prototype.toString=i.prototype.toString,i.prototype.getBits=i.prototype.i,i.fromNumber=c,i.fromString=f,Ui=i}).apply(typeof r_<"u"?r_:typeof self<"u"?self:typeof window<"u"?window:{});var Cf=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Ck,nc,bk,ih,_p,Rk,Pk,Dk;(function(){var e,t=typeof Object.defineProperties=="function"?Object.defineProperty:function(h,_,A){return h==Array.prototype||h==Object.prototype||(h[_]=A.value),h};function r(h){h=[typeof globalThis=="object"&&globalThis,h,typeof window=="object"&&window,typeof self=="object"&&self,typeof Cf=="object"&&Cf];for(var _=0;_<h.length;++_){var A=h[_];if(A&&A.Math==Math)return A}throw Error("Cannot find global object")}var n=r(this);function s(h,_){if(_)e:{var A=n;h=h.split(".");for(var W=0;W<h.length-1;W++){var oe=h[W];if(!(oe in A))break e;A=A[oe]}h=h[h.length-1],W=A[h],_=_(W),_!=W&&_!=null&&t(A,h,{configurable:!0,writable:!0,value:_})}}function a(h,_){h instanceof String&&(h+="");var A=0,W=!1,oe={next:function(){if(!W&&A<h.length){var he=A++;return{value:_(he,h[he]),done:!1}}return W=!0,{done:!0,value:void 0}}};return oe[Symbol.iterator]=function(){return oe},oe}s("Array.prototype.values",function(h){return h||function(){return a(this,function(_,A){return A})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var i=i||{},o=this||self;function l(h){var _=typeof h;return _=_!="object"?_:h?Array.isArray(h)?"array":_:"null",_=="array"||_=="object"&&typeof h.length=="number"}function c(h){var _=typeof h;return _=="object"&&h!=null||_=="function"}function f(h,_,A){return h.call.apply(h.bind,arguments)}function d(h,_,A){if(!h)throw Error();if(2<arguments.length){var W=Array.prototype.slice.call(arguments,2);return function(){var oe=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(oe,W),h.apply(_,oe)}}return function(){return h.apply(_,arguments)}}function m(h,_,A){return m=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?f:d,m.apply(null,arguments)}function p(h,_){var A=Array.prototype.slice.call(arguments,1);return function(){var W=A.slice();return W.push.apply(W,arguments),h.apply(this,W)}}function x(h,_){function A(){}A.prototype=_.prototype,h.aa=_.prototype,h.prototype=new A,h.prototype.constructor=h,h.Qb=function(W,oe,he){for(var Se=Array(arguments.length-2),wt=2;wt<arguments.length;wt++)Se[wt-2]=arguments[wt];return _.prototype[oe].apply(W,Se)}}function g(h){const _=h.length;if(0<_){const A=Array(_);for(let W=0;W<_;W++)A[W]=h[W];return A}return[]}function w(h,_){for(let A=1;A<arguments.length;A++){const W=arguments[A];if(l(W)){const oe=h.length||0,he=W.length||0;h.length=oe+he;for(let Se=0;Se<he;Se++)h[oe+Se]=W[Se]}else h.push(W)}}class k{constructor(_,A){this.i=_,this.j=A,this.h=0,this.g=null}get(){let _;return 0<this.h?(this.h--,_=this.g,this.g=_.next,_.next=null):_=this.i(),_}}function E(h){return/^[\s\xa0]*$/.test(h)}function y(){var h=o.navigator;return h&&(h=h.userAgent)?h:""}function I(h){return I[" "](h),h}I[" "]=function(){};var M=y().indexOf("Gecko")!=-1&&!(y().toLowerCase().indexOf("webkit")!=-1&&y().indexOf("Edge")==-1)&&!(y().indexOf("Trident")!=-1||y().indexOf("MSIE")!=-1)&&y().indexOf("Edge")==-1;function O(h,_,A){for(const W in h)_.call(A,h[W],W,h)}function v(h,_){for(const A in h)_.call(void 0,h[A],A,h)}function T(h){const _={};for(const A in h)_[A]=h[A];return _}const S="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function C(h,_){let A,W;for(let oe=1;oe<arguments.length;oe++){W=arguments[oe];for(A in W)h[A]=W[A];for(let he=0;he<S.length;he++)A=S[he],Object.prototype.hasOwnProperty.call(W,A)&&(h[A]=W[A])}}function b(h){var _=1;h=h.split(":");const A=[];for(;0<_&&h.length;)A.push(h.shift()),_--;return h.length&&A.push(h.join(":")),A}function P(h){o.setTimeout(()=>{throw h},0)}function D(){var h=G;let _=null;return h.g&&(_=h.g,h.g=h.g.next,h.g||(h.h=null),_.next=null),_}class ie{constructor(){this.h=this.g=null}add(_,A){const W=Z.get();W.set(_,A),this.h?this.h.next=W:this.g=W,this.h=W}}var Z=new k(()=>new fe,h=>h.reset());class fe{constructor(){this.next=this.g=this.h=null}set(_,A){this.h=_,this.g=A,this.next=null}reset(){this.next=this.g=this.h=null}}let ue,q=!1,G=new ie,ne=()=>{const h=o.Promise.resolve(void 0);ue=()=>{h.then(ce)}};var ce=()=>{for(var h;h=D();){try{h.h.call(h.g)}catch(A){P(A)}var _=Z;_.j(h),100>_.h&&(_.h++,h.next=_.g,_.g=h)}q=!1};function j(){this.s=this.s,this.C=this.C}j.prototype.s=!1,j.prototype.ma=function(){this.s||(this.s=!0,this.N())},j.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function Y(h,_){this.type=h,this.g=this.target=_,this.defaultPrevented=!1}Y.prototype.h=function(){this.defaultPrevented=!0};var K=function(){if(!o.addEventListener||!Object.defineProperty)return!1;var h=!1,_=Object.defineProperty({},"passive",{get:function(){h=!0}});try{const A=()=>{};o.addEventListener("test",A,_),o.removeEventListener("test",A,_)}catch{}return h}();function V(h,_){if(Y.call(this,h?h.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,h){var A=this.type=h.type,W=h.changedTouches&&h.changedTouches.length?h.changedTouches[0]:null;if(this.target=h.target||h.srcElement,this.g=_,_=h.relatedTarget){if(M){e:{try{I(_.nodeName);var oe=!0;break e}catch{}oe=!1}oe||(_=null)}}else A=="mouseover"?_=h.fromElement:A=="mouseout"&&(_=h.toElement);this.relatedTarget=_,W?(this.clientX=W.clientX!==void 0?W.clientX:W.pageX,this.clientY=W.clientY!==void 0?W.clientY:W.pageY,this.screenX=W.screenX||0,this.screenY=W.screenY||0):(this.clientX=h.clientX!==void 0?h.clientX:h.pageX,this.clientY=h.clientY!==void 0?h.clientY:h.pageY,this.screenX=h.screenX||0,this.screenY=h.screenY||0),this.button=h.button,this.key=h.key||"",this.ctrlKey=h.ctrlKey,this.altKey=h.altKey,this.shiftKey=h.shiftKey,this.metaKey=h.metaKey,this.pointerId=h.pointerId||0,this.pointerType=typeof h.pointerType=="string"?h.pointerType:J[h.pointerType]||"",this.state=h.state,this.i=h,h.defaultPrevented&&V.aa.h.call(this)}}x(V,Y);var J={2:"touch",3:"pen",4:"mouse"};V.prototype.h=function(){V.aa.h.call(this);var h=this.i;h.preventDefault?h.preventDefault():h.returnValue=!1};var de="closure_listenable_"+(1e6*Math.random()|0),Ee=0;function _e(h,_,A,W,oe){this.listener=h,this.proxy=null,this.src=_,this.type=A,this.capture=!!W,this.ha=oe,this.key=++Ee,this.da=this.fa=!1}function pe(h){h.da=!0,h.listener=null,h.proxy=null,h.src=null,h.ha=null}function Ue(h){this.src=h,this.g={},this.h=0}Ue.prototype.add=function(h,_,A,W,oe){var he=h.toString();h=this.g[he],h||(h=this.g[he]=[],this.h++);var Se=tt(h,_,W,oe);return-1<Se?(_=h[Se],A||(_.fa=!1)):(_=new _e(_,this.src,he,!!W,oe),_.fa=A,h.push(_)),_};function H(h,_){var A=_.type;if(A in h.g){var W=h.g[A],oe=Array.prototype.indexOf.call(W,_,void 0),he;(he=0<=oe)&&Array.prototype.splice.call(W,oe,1),he&&(pe(_),h.g[A].length==0&&(delete h.g[A],h.h--))}}function tt(h,_,A,W){for(var oe=0;oe<h.length;++oe){var he=h[oe];if(!he.da&&he.listener==_&&he.capture==!!A&&he.ha==W)return oe}return-1}var He="closure_lm_"+(1e6*Math.random()|0),Je={};function De(h,_,A,W,oe){if(Array.isArray(_)){for(var he=0;he<_.length;he++)De(h,_[he],A,W,oe);return null}return A=fr(A),h&&h[de]?h.K(_,A,c(W)?!!W.capture:!1,oe):Ae(h,_,A,!1,W,oe)}function Ae(h,_,A,W,oe,he){if(!_)throw Error("Invalid event type");var Se=c(oe)?!!oe.capture:!!oe,wt=an(h);if(wt||(h[He]=wt=new Ue(h)),A=wt.add(_,A,W,Se,he),A.proxy)return A;if(W=_t(),A.proxy=W,W.src=h,W.listener=A,h.addEventListener)K||(oe=Se),oe===void 0&&(oe=!1),h.addEventListener(_.toString(),W,oe);else if(h.attachEvent)h.attachEvent(sn(_.toString()),W);else if(h.addListener&&h.removeListener)h.addListener(W);else throw Error("addEventListener and attachEvent are unavailable.");return A}function _t(){function h(A){return _.call(h.src,h.listener,A)}const _=Ws;return h}function ur(h,_,A,W,oe){if(Array.isArray(_))for(var he=0;he<_.length;he++)ur(h,_[he],A,W,oe);else W=c(W)?!!W.capture:!!W,A=fr(A),h&&h[de]?(h=h.i,_=String(_).toString(),_ in h.g&&(he=h.g[_],A=tt(he,A,W,oe),-1<A&&(pe(he[A]),Array.prototype.splice.call(he,A,1),he.length==0&&(delete h.g[_],h.h--)))):h&&(h=an(h))&&(_=h.g[_.toString()],h=-1,_&&(h=tt(_,A,W,oe)),(A=-1<h?_[h]:null)&&Cr(A))}function Cr(h){if(typeof h!="number"&&h&&!h.da){var _=h.src;if(_&&_[de])H(_.i,h);else{var A=h.type,W=h.proxy;_.removeEventListener?_.removeEventListener(A,W,h.capture):_.detachEvent?_.detachEvent(sn(A),W):_.addListener&&_.removeListener&&_.removeListener(W),(A=an(_))?(H(A,h),A.h==0&&(A.src=null,_[He]=null)):pe(h)}}}function sn(h){return h in Je?Je[h]:Je[h]="on"+h}function Ws(h,_){if(h.da)h=!0;else{_=new V(_,this);var A=h.listener,W=h.ha||h.src;h.fa&&Cr(h),h=A.call(W,_)}return h}function an(h){return h=h[He],h instanceof Ue?h:null}var kt="__closure_events_fn_"+(1e9*Math.random()>>>0);function fr(h){return typeof h=="function"?h:(h[kt]||(h[kt]=function(_){return h.handleEvent(_)}),h[kt])}function vt(){j.call(this),this.i=new Ue(this),this.M=this,this.F=null}x(vt,j),vt.prototype[de]=!0,vt.prototype.removeEventListener=function(h,_,A,W){ur(this,h,_,A,W)};function St(h,_){var A,W=h.F;if(W)for(A=[];W;W=W.F)A.push(W);if(h=h.M,W=_.type||_,typeof _=="string")_=new Y(_,h);else if(_ instanceof Y)_.target=_.target||h;else{var oe=_;_=new Y(W,h),C(_,oe)}if(oe=!0,A)for(var he=A.length-1;0<=he;he--){var Se=_.g=A[he];oe=dt(Se,W,!0,_)&&oe}if(Se=_.g=h,oe=dt(Se,W,!0,_)&&oe,oe=dt(Se,W,!1,_)&&oe,A)for(he=0;he<A.length;he++)Se=_.g=A[he],oe=dt(Se,W,!1,_)&&oe}vt.prototype.N=function(){if(vt.aa.N.call(this),this.i){var h=this.i,_;for(_ in h.g){for(var A=h.g[_],W=0;W<A.length;W++)pe(A[W]);delete h.g[_],h.h--}}this.F=null},vt.prototype.K=function(h,_,A,W){return this.i.add(String(h),_,!1,A,W)},vt.prototype.L=function(h,_,A,W){return this.i.add(String(h),_,!0,A,W)};function dt(h,_,A,W){if(_=h.i.g[String(_)],!_)return!0;_=_.concat();for(var oe=!0,he=0;he<_.length;++he){var Se=_[he];if(Se&&!Se.da&&Se.capture==A){var wt=Se.listener,vr=Se.ha||Se.src;Se.fa&&H(h.i,Se),oe=wt.call(vr,W)!==!1&&oe}}return oe&&!W.defaultPrevented}function Ot(h,_,A){if(typeof h=="function")A&&(h=m(h,A));else if(h&&typeof h.handleEvent=="function")h=m(h.handleEvent,h);else throw Error("Invalid listener argument");return 2147483647<Number(_)?-1:o.setTimeout(h,_||0)}function Ve(h){h.g=Ot(()=>{h.g=null,h.i&&(h.i=!1,Ve(h))},h.l);const _=h.h;h.h=null,h.m.apply(null,_)}class yt extends j{constructor(_,A){super(),this.m=_,this.l=A,this.h=null,this.i=!1,this.g=null}j(_){this.h=arguments,this.g?this.i=!0:Ve(this)}N(){super.N(),this.g&&(o.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Yt(h){j.call(this),this.h=h,this.g={}}x(Yt,j);var ft=[];function vn(h){O(h.g,function(_,A){this.g.hasOwnProperty(A)&&Cr(_)},h),h.g={}}Yt.prototype.N=function(){Yt.aa.N.call(this),vn(this)},Yt.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var zs=o.JSON.stringify,po=o.JSON.parse,Rl=class{stringify(h){return o.JSON.stringify(h,void 0)}parse(h){return o.JSON.parse(h,void 0)}};function $s(){}$s.prototype.h=null;function xs(h){return h.h||(h.h=h.i())}function Sa(){}var Qn={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function Hs(){Y.call(this,"d")}x(Hs,Y);function vs(){Y.call(this,"c")}x(vs,Y);var Fn={},go=null;function Gs(){return go=go||new vt}Fn.La="serverreachability";function Ks(h){Y.call(this,Fn.La,h)}x(Ks,Y);function On(h){const _=Gs();St(_,new Ks(_))}Fn.STAT_EVENT="statevent";function xo(h,_){Y.call(this,Fn.STAT_EVENT,h),this.stat=_}x(xo,Y);function nr(h){const _=Gs();St(_,new xo(_,h))}Fn.Ma="timingevent";function X(h,_){Y.call(this,Fn.Ma,h),this.size=_}x(X,Y);function te(h,_){if(typeof h!="function")throw Error("Fn must not be null and must be a function");return o.setTimeout(function(){h()},_)}function le(){this.g=!0}le.prototype.xa=function(){this.g=!1};function xe(h,_,A,W,oe,he){h.info(function(){if(h.g)if(he)for(var Se="",wt=he.split("&"),vr=0;vr<wt.length;vr++){var ct=wt[vr].split("=");if(1<ct.length){var br=ct[0];ct=ct[1];var Rr=br.split("_");Se=2<=Rr.length&&Rr[1]=="type"?Se+(br+"="+ct+"&"):Se+(br+"=redacted&")}}else Se=null;else Se=he;return"XMLHTTP REQ ("+W+") [attempt "+oe+"]: "+_+`
`+A+`
`+Se})}function Ie(h,_,A,W,oe,he,Se){h.info(function(){return"XMLHTTP RESP ("+W+") [ attempt "+oe+"]: "+_+`
`+A+`
`+he+" "+Se})}function N(h,_,A,W){h.info(function(){return"XMLHTTP TEXT ("+_+"): "+R(h,A)+(W?" "+W:"")})}function B(h,_){h.info(function(){return"TIMEOUT: "+_})}le.prototype.info=function(){};function R(h,_){if(!h.g)return _;if(!_)return null;try{var A=JSON.parse(_);if(A){for(h=0;h<A.length;h++)if(Array.isArray(A[h])){var W=A[h];if(!(2>W.length)){var oe=W[1];if(Array.isArray(oe)&&!(1>oe.length)){var he=oe[0];if(he!="noop"&&he!="stop"&&he!="close")for(var Se=1;Se<oe.length;Se++)oe[Se]=""}}}}return zs(A)}catch{return _}}var F={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},L={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},U;function Q(){}x(Q,$s),Q.prototype.g=function(){return new XMLHttpRequest},Q.prototype.i=function(){return{}},U=new Q;function ae(h,_,A,W){this.j=h,this.i=_,this.l=A,this.R=W||1,this.U=new Yt(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new se}function se(){this.i=null,this.g="",this.h=!1}var re={},ee={};function me(h,_,A){h.L=1,h.v=ef(qs(_)),h.m=A,h.P=!0,Te(h,null)}function Te(h,_){h.F=Date.now(),ke(h),h.A=qs(h.v);var A=h.A,W=h.R;Array.isArray(W)||(W=[String(W)]),Pv(A.i,"t",W),h.C=0,A=h.j.J,h.h=new se,h.g=Xv(h.j,A?_:null,!h.m),0<h.O&&(h.M=new yt(m(h.Y,h,h.g),h.O)),_=h.U,A=h.g,W=h.ca;var oe="readystatechange";Array.isArray(oe)||(oe&&(ft[0]=oe.toString()),oe=ft);for(var he=0;he<oe.length;he++){var Se=De(A,oe[he],W||_.handleEvent,!1,_.h||_);if(!Se)break;_.g[Se.key]=Se}_=h.H?T(h.H):{},h.m?(h.u||(h.u="POST"),_["Content-Type"]="application/x-www-form-urlencoded",h.g.ea(h.A,h.u,h.m,_)):(h.u="GET",h.g.ea(h.A,h.u,null,_)),On(),xe(h.i,h.u,h.A,h.l,h.R,h.m)}ae.prototype.ca=function(h){h=h.target;const _=this.M;_&&Ys(h)==3?_.j():this.Y(h)},ae.prototype.Y=function(h){try{if(h==this.g)e:{const Rr=Ys(this.g);var _=this.g.Ba();const _o=this.g.Z();if(!(3>Rr)&&(Rr!=3||this.g&&(this.h.h||this.g.oa()||Uv(this.g)))){this.J||Rr!=4||_==7||(_==8||0>=_o?On(3):On(2)),it(this);var A=this.g.Z();this.X=A;t:if(Ne(this)){var W=Uv(this.g);h="";var oe=W.length,he=Ys(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){mt(this),qe(this);var Se="";break t}this.h.i=new o.TextDecoder}for(_=0;_<oe;_++)this.h.h=!0,h+=this.h.i.decode(W[_],{stream:!(he&&_==oe-1)});W.length=0,this.h.g+=h,this.C=0,Se=this.h.g}else Se=this.g.oa();if(this.o=A==200,Ie(this.i,this.u,this.A,this.l,this.R,Rr,A),this.o){if(this.T&&!this.K){t:{if(this.g){var wt,vr=this.g;if((wt=vr.g?vr.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!E(wt)){var ct=wt;break t}}ct=null}if(A=ct)N(this.i,this.l,A,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,on(this,A);else{this.o=!1,this.s=3,nr(12),mt(this),qe(this);break e}}if(this.P){A=!0;let Jn;for(;!this.J&&this.C<Se.length;)if(Jn=ve(this,Se),Jn==ee){Rr==4&&(this.s=4,nr(14),A=!1),N(this.i,this.l,null,"[Incomplete Response]");break}else if(Jn==re){this.s=4,nr(15),N(this.i,this.l,Se,"[Invalid Chunk]"),A=!1;break}else N(this.i,this.l,Jn,null),on(this,Jn);if(Ne(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Rr!=4||Se.length!=0||this.h.h||(this.s=1,nr(16),A=!1),this.o=this.o&&A,!A)N(this.i,this.l,Se,"[Invalid Chunked Response]"),mt(this),qe(this);else if(0<Se.length&&!this.W){this.W=!0;var br=this.j;br.g==this&&br.ba&&!br.M&&(br.j.info("Great, no buffering proxy detected. Bytes received: "+Se.length),m0(br),br.M=!0,nr(11))}}else N(this.i,this.l,Se,null),on(this,Se);Rr==4&&mt(this),this.o&&!this.J&&(Rr==4?Gv(this.j,this):(this.o=!1,ke(this)))}else iN(this.g),A==400&&0<Se.indexOf("Unknown SID")?(this.s=3,nr(12)):(this.s=0,nr(13)),mt(this),qe(this)}}}catch{}finally{}};function Ne(h){return h.g?h.u=="GET"&&h.L!=2&&h.j.Ca:!1}function ve(h,_){var A=h.C,W=_.indexOf(`
`,A);return W==-1?ee:(A=Number(_.substring(A,W)),isNaN(A)?re:(W+=1,W+A>_.length?ee:(_=_.slice(W,W+A),h.C=W+A,_)))}ae.prototype.cancel=function(){this.J=!0,mt(this)};function ke(h){h.S=Date.now()+h.I,Fe(h,h.I)}function Fe(h,_){if(h.B!=null)throw Error("WatchDog timer not null");h.B=te(m(h.ba,h),_)}function it(h){h.B&&(o.clearTimeout(h.B),h.B=null)}ae.prototype.ba=function(){this.B=null;const h=Date.now();0<=h-this.S?(B(this.i,this.A),this.L!=2&&(On(),nr(17)),mt(this),this.s=2,qe(this)):Fe(this,this.S-h)};function qe(h){h.j.G==0||h.J||Gv(h.j,h)}function mt(h){it(h);var _=h.M;_&&typeof _.ma=="function"&&_.ma(),h.M=null,vn(h.U),h.g&&(_=h.g,h.g=null,_.abort(),_.ma())}function on(h,_){try{var A=h.j;if(A.G!=0&&(A.g==h||rt(A.h,h))){if(!h.K&&rt(A.h,h)&&A.G==3){try{var W=A.Da.g.parse(_)}catch{W=null}if(Array.isArray(W)&&W.length==3){var oe=W;if(oe[0]==0){e:if(!A.u){if(A.g)if(A.g.F+3e3<h.F)of(A),sf(A);else break e;d0(A),nr(18)}}else A.za=oe[1],0<A.za-A.T&&37500>oe[2]&&A.F&&A.v==0&&!A.C&&(A.C=te(m(A.Za,A),6e3));if(1>=Mn(A.h)&&A.ca){try{A.ca()}catch{}A.ca=void 0}}else Ei(A,11)}else if((h.K||A.g==h)&&of(A),!E(_))for(oe=A.Da.g.parse(_),_=0;_<oe.length;_++){let ct=oe[_];if(A.T=ct[0],ct=ct[1],A.G==2)if(ct[0]=="c"){A.K=ct[1],A.ia=ct[2];const br=ct[3];br!=null&&(A.la=br,A.j.info("VER="+A.la));const Rr=ct[4];Rr!=null&&(A.Aa=Rr,A.j.info("SVER="+A.Aa));const _o=ct[5];_o!=null&&typeof _o=="number"&&0<_o&&(W=1.5*_o,A.L=W,A.j.info("backChannelRequestTimeoutMs_="+W)),W=A;const Jn=h.g;if(Jn){const cf=Jn.g?Jn.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(cf){var he=W.h;he.g||cf.indexOf("spdy")==-1&&cf.indexOf("quic")==-1&&cf.indexOf("h2")==-1||(he.j=he.l,he.g=new Set,he.h&&(ys(he,he.h),he.h=null))}if(W.D){const p0=Jn.g?Jn.g.getResponseHeader("X-HTTP-Session-Id"):null;p0&&(W.ya=p0,At(W.I,W.D,p0))}}A.G=3,A.l&&A.l.ua(),A.ba&&(A.R=Date.now()-h.F,A.j.info("Handshake RTT: "+A.R+"ms")),W=A;var Se=h;if(W.qa=Yv(W,W.J?W.ia:null,W.W),Se.K){Pl(W.h,Se);var wt=Se,vr=W.L;vr&&(wt.I=vr),wt.B&&(it(wt),ke(wt)),W.g=Se}else $v(W);0<A.i.length&&af(A)}else ct[0]!="stop"&&ct[0]!="close"||Ei(A,7);else A.G==3&&(ct[0]=="stop"||ct[0]=="close"?ct[0]=="stop"?Ei(A,7):h0(A):ct[0]!="noop"&&A.l&&A.l.ta(ct),A.v=0)}}On(4)}catch{}}var Ge=class{constructor(h,_){this.g=h,this.map=_}};function ht(h){this.l=h||10,o.PerformanceNavigationTiming?(h=o.performance.getEntriesByType("navigation"),h=0<h.length&&(h[0].nextHopProtocol=="hq"||h[0].nextHopProtocol=="h2")):h=!!(o.chrome&&o.chrome.loadTimes&&o.chrome.loadTimes()&&o.chrome.loadTimes().wasFetchedViaSpdy),this.j=h?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function xr(h){return h.h?!0:h.g?h.g.size>=h.j:!1}function Mn(h){return h.h?1:h.g?h.g.size:0}function rt(h,_){return h.h?h.h==_:h.g?h.g.has(_):!1}function ys(h,_){h.g?h.g.add(_):h.h=_}function Pl(h,_){h.h&&h.h==_?h.h=null:h.g&&h.g.has(_)&&h.g.delete(_)}ht.prototype.cancel=function(){if(this.i=Qu(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const h of this.g.values())h.cancel();this.g.clear()}};function Qu(h){if(h.h!=null)return h.i.concat(h.h.D);if(h.g!=null&&h.g.size!==0){let _=h.i;for(const A of h.g.values())_=_.concat(A.D);return _}return g(h.i)}function HI(h){if(h.V&&typeof h.V=="function")return h.V();if(typeof Map<"u"&&h instanceof Map||typeof Set<"u"&&h instanceof Set)return Array.from(h.values());if(typeof h=="string")return h.split("");if(l(h)){for(var _=[],A=h.length,W=0;W<A;W++)_.push(h[W]);return _}_=[],A=0;for(W in h)_[A++]=h[W];return _}function GI(h){if(h.na&&typeof h.na=="function")return h.na();if(!h.V||typeof h.V!="function"){if(typeof Map<"u"&&h instanceof Map)return Array.from(h.keys());if(!(typeof Set<"u"&&h instanceof Set)){if(l(h)||typeof h=="string"){var _=[];h=h.length;for(var A=0;A<h;A++)_.push(A);return _}_=[],A=0;for(const W in h)_[A++]=W;return _}}}function Av(h,_){if(h.forEach&&typeof h.forEach=="function")h.forEach(_,void 0);else if(l(h)||typeof h=="string")Array.prototype.forEach.call(h,_,void 0);else for(var A=GI(h),W=HI(h),oe=W.length,he=0;he<oe;he++)_.call(void 0,W[he],A&&A[he],h)}var Iv=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function KI(h,_){if(h){h=h.split("&");for(var A=0;A<h.length;A++){var W=h[A].indexOf("="),oe=null;if(0<=W){var he=h[A].substring(0,W);oe=h[A].substring(W+1)}else he=h[A];_(he,oe?decodeURIComponent(oe.replace(/\+/g," ")):"")}}}function wi(h){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,h instanceof wi){this.h=h.h,Ju(this,h.j),this.o=h.o,this.g=h.g,Zu(this,h.s),this.l=h.l;var _=h.i,A=new Ol;A.i=_.i,_.g&&(A.g=new Map(_.g),A.h=_.h),Nv(this,A),this.m=h.m}else h&&(_=String(h).match(Iv))?(this.h=!1,Ju(this,_[1]||"",!0),this.o=Dl(_[2]||""),this.g=Dl(_[3]||"",!0),Zu(this,_[4]),this.l=Dl(_[5]||"",!0),Nv(this,_[6]||"",!0),this.m=Dl(_[7]||"")):(this.h=!1,this.i=new Ol(null,this.h))}wi.prototype.toString=function(){var h=[],_=this.j;_&&h.push(Fl(_,Cv,!0),":");var A=this.g;return(A||_=="file")&&(h.push("//"),(_=this.o)&&h.push(Fl(_,Cv,!0),"@"),h.push(encodeURIComponent(String(A)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),A=this.s,A!=null&&h.push(":",String(A))),(A=this.l)&&(this.g&&A.charAt(0)!="/"&&h.push("/"),h.push(Fl(A,A.charAt(0)=="/"?XI:YI,!0))),(A=this.i.toString())&&h.push("?",A),(A=this.m)&&h.push("#",Fl(A,JI)),h.join("")};function qs(h){return new wi(h)}function Ju(h,_,A){h.j=A?Dl(_,!0):_,h.j&&(h.j=h.j.replace(/:$/,""))}function Zu(h,_){if(_){if(_=Number(_),isNaN(_)||0>_)throw Error("Bad port number "+_);h.s=_}else h.s=null}function Nv(h,_,A){_ instanceof Ol?(h.i=_,ZI(h.i,h.h)):(A||(_=Fl(_,QI)),h.i=new Ol(_,h.h))}function At(h,_,A){h.i.set(_,A)}function ef(h){return At(h,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),h}function Dl(h,_){return h?_?decodeURI(h.replace(/%25/g,"%2525")):decodeURIComponent(h):""}function Fl(h,_,A){return typeof h=="string"?(h=encodeURI(h).replace(_,qI),A&&(h=h.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),h):null}function qI(h){return h=h.charCodeAt(0),"%"+(h>>4&15).toString(16)+(h&15).toString(16)}var Cv=/[#\/\?@]/g,YI=/[#\?:]/g,XI=/[#\?]/g,QI=/[#\?@]/g,JI=/#/g;function Ol(h,_){this.h=this.g=null,this.i=h||null,this.j=!!_}function Aa(h){h.g||(h.g=new Map,h.h=0,h.i&&KI(h.i,function(_,A){h.add(decodeURIComponent(_.replace(/\+/g," ")),A)}))}e=Ol.prototype,e.add=function(h,_){Aa(this),this.i=null,h=vo(this,h);var A=this.g.get(h);return A||this.g.set(h,A=[]),A.push(_),this.h+=1,this};function bv(h,_){Aa(h),_=vo(h,_),h.g.has(_)&&(h.i=null,h.h-=h.g.get(_).length,h.g.delete(_))}function Rv(h,_){return Aa(h),_=vo(h,_),h.g.has(_)}e.forEach=function(h,_){Aa(this),this.g.forEach(function(A,W){A.forEach(function(oe){h.call(_,oe,W,this)},this)},this)},e.na=function(){Aa(this);const h=Array.from(this.g.values()),_=Array.from(this.g.keys()),A=[];for(let W=0;W<_.length;W++){const oe=h[W];for(let he=0;he<oe.length;he++)A.push(_[W])}return A},e.V=function(h){Aa(this);let _=[];if(typeof h=="string")Rv(this,h)&&(_=_.concat(this.g.get(vo(this,h))));else{h=Array.from(this.g.values());for(let A=0;A<h.length;A++)_=_.concat(h[A])}return _},e.set=function(h,_){return Aa(this),this.i=null,h=vo(this,h),Rv(this,h)&&(this.h-=this.g.get(h).length),this.g.set(h,[_]),this.h+=1,this},e.get=function(h,_){return h?(h=this.V(h),0<h.length?String(h[0]):_):_};function Pv(h,_,A){bv(h,_),0<A.length&&(h.i=null,h.g.set(vo(h,_),g(A)),h.h+=A.length)}e.toString=function(){if(this.i)return this.i;if(!this.g)return"";const h=[],_=Array.from(this.g.keys());for(var A=0;A<_.length;A++){var W=_[A];const he=encodeURIComponent(String(W)),Se=this.V(W);for(W=0;W<Se.length;W++){var oe=he;Se[W]!==""&&(oe+="="+encodeURIComponent(String(Se[W]))),h.push(oe)}}return this.i=h.join("&")};function vo(h,_){return _=String(_),h.j&&(_=_.toLowerCase()),_}function ZI(h,_){_&&!h.j&&(Aa(h),h.i=null,h.g.forEach(function(A,W){var oe=W.toLowerCase();W!=oe&&(bv(this,W),Pv(this,oe,A))},h)),h.j=_}function eN(h,_){const A=new le;if(o.Image){const W=new Image;W.onload=p(Ia,A,"TestLoadImage: loaded",!0,_,W),W.onerror=p(Ia,A,"TestLoadImage: error",!1,_,W),W.onabort=p(Ia,A,"TestLoadImage: abort",!1,_,W),W.ontimeout=p(Ia,A,"TestLoadImage: timeout",!1,_,W),o.setTimeout(function(){W.ontimeout&&W.ontimeout()},1e4),W.src=h}else _(!1)}function tN(h,_){const A=new le,W=new AbortController,oe=setTimeout(()=>{W.abort(),Ia(A,"TestPingServer: timeout",!1,_)},1e4);fetch(h,{signal:W.signal}).then(he=>{clearTimeout(oe),he.ok?Ia(A,"TestPingServer: ok",!0,_):Ia(A,"TestPingServer: server error",!1,_)}).catch(()=>{clearTimeout(oe),Ia(A,"TestPingServer: error",!1,_)})}function Ia(h,_,A,W,oe){try{oe&&(oe.onload=null,oe.onerror=null,oe.onabort=null,oe.ontimeout=null),W(A)}catch{}}function rN(){this.g=new Rl}function nN(h,_,A){const W=A||"";try{Av(h,function(oe,he){let Se=oe;c(oe)&&(Se=zs(oe)),_.push(W+he+"="+encodeURIComponent(Se))})}catch(oe){throw _.push(W+"type="+encodeURIComponent("_badmap")),oe}}function tf(h){this.l=h.Ub||null,this.j=h.eb||!1}x(tf,$s),tf.prototype.g=function(){return new rf(this.l,this.j)},tf.prototype.i=function(h){return function(){return h}}({});function rf(h,_){vt.call(this),this.D=h,this.o=_,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}x(rf,vt),e=rf.prototype,e.open=function(h,_){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=h,this.A=_,this.readyState=1,Ll(this)},e.send=function(h){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const _={headers:this.u,method:this.B,credentials:this.m,cache:void 0};h&&(_.body=h),(this.D||o).fetch(new Request(this.A,_)).then(this.Sa.bind(this),this.ga.bind(this))},e.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,Ml(this)),this.readyState=0},e.Sa=function(h){if(this.g&&(this.l=h,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=h.headers,this.readyState=2,Ll(this)),this.g&&(this.readyState=3,Ll(this),this.g)))if(this.responseType==="arraybuffer")h.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof o.ReadableStream<"u"&&"body"in h){if(this.j=h.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;Dv(this)}else h.text().then(this.Ra.bind(this),this.ga.bind(this))};function Dv(h){h.j.read().then(h.Pa.bind(h)).catch(h.ga.bind(h))}e.Pa=function(h){if(this.g){if(this.o&&h.value)this.response.push(h.value);else if(!this.o){var _=h.value?h.value:new Uint8Array(0);(_=this.v.decode(_,{stream:!h.done}))&&(this.response=this.responseText+=_)}h.done?Ml(this):Ll(this),this.readyState==3&&Dv(this)}},e.Ra=function(h){this.g&&(this.response=this.responseText=h,Ml(this))},e.Qa=function(h){this.g&&(this.response=h,Ml(this))},e.ga=function(){this.g&&Ml(this)};function Ml(h){h.readyState=4,h.l=null,h.j=null,h.v=null,Ll(h)}e.setRequestHeader=function(h,_){this.u.append(h,_)},e.getResponseHeader=function(h){return this.h&&this.h.get(h.toLowerCase())||""},e.getAllResponseHeaders=function(){if(!this.h)return"";const h=[],_=this.h.entries();for(var A=_.next();!A.done;)A=A.value,h.push(A[0]+": "+A[1]),A=_.next();return h.join(`\r
`)};function Ll(h){h.onreadystatechange&&h.onreadystatechange.call(h)}Object.defineProperty(rf.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(h){this.m=h?"include":"same-origin"}});function Fv(h){let _="";return O(h,function(A,W){_+=W,_+=":",_+=A,_+=`\r
`}),_}function f0(h,_,A){e:{for(W in A){var W=!1;break e}W=!0}W||(A=Fv(A),typeof h=="string"?A!=null&&encodeURIComponent(String(A)):At(h,_,A))}function Vt(h){vt.call(this),this.headers=new Map,this.o=h||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}x(Vt,vt);var sN=/^https?$/i,aN=["POST","PUT"];e=Vt.prototype,e.Ha=function(h){this.J=h},e.ea=function(h,_,A,W){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+h);_=_?_.toUpperCase():"GET",this.D=h,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():U.g(),this.v=this.o?xs(this.o):xs(U),this.g.onreadystatechange=m(this.Ea,this);try{this.B=!0,this.g.open(_,String(h),!0),this.B=!1}catch(he){Ov(this,he);return}if(h=A||"",A=new Map(this.headers),W)if(Object.getPrototypeOf(W)===Object.prototype)for(var oe in W)A.set(oe,W[oe]);else if(typeof W.keys=="function"&&typeof W.get=="function")for(const he of W.keys())A.set(he,W.get(he));else throw Error("Unknown input type for opt_headers: "+String(W));W=Array.from(A.keys()).find(he=>he.toLowerCase()=="content-type"),oe=o.FormData&&h instanceof o.FormData,!(0<=Array.prototype.indexOf.call(aN,_,void 0))||W||oe||A.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[he,Se]of A)this.g.setRequestHeader(he,Se);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{jv(this),this.u=!0,this.g.send(h),this.u=!1}catch(he){Ov(this,he)}};function Ov(h,_){h.h=!1,h.g&&(h.j=!0,h.g.abort(),h.j=!1),h.l=_,h.m=5,Mv(h),nf(h)}function Mv(h){h.A||(h.A=!0,St(h,"complete"),St(h,"error"))}e.abort=function(h){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=h||7,St(this,"complete"),St(this,"abort"),nf(this))},e.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),nf(this,!0)),Vt.aa.N.call(this)},e.Ea=function(){this.s||(this.B||this.u||this.j?Lv(this):this.bb())},e.bb=function(){Lv(this)};function Lv(h){if(h.h&&typeof i<"u"&&(!h.v[1]||Ys(h)!=4||h.Z()!=2)){if(h.u&&Ys(h)==4)Ot(h.Ea,0,h);else if(St(h,"readystatechange"),Ys(h)==4){h.h=!1;try{const Se=h.Z();e:switch(Se){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var _=!0;break e;default:_=!1}var A;if(!(A=_)){var W;if(W=Se===0){var oe=String(h.D).match(Iv)[1]||null;!oe&&o.self&&o.self.location&&(oe=o.self.location.protocol.slice(0,-1)),W=!sN.test(oe?oe.toLowerCase():"")}A=W}if(A)St(h,"complete"),St(h,"success");else{h.m=6;try{var he=2<Ys(h)?h.g.statusText:""}catch{he=""}h.l=he+" ["+h.Z()+"]",Mv(h)}}finally{nf(h)}}}}function nf(h,_){if(h.g){jv(h);const A=h.g,W=h.v[0]?()=>{}:null;h.g=null,h.v=null,_||St(h,"ready");try{A.onreadystatechange=W}catch{}}}function jv(h){h.I&&(o.clearTimeout(h.I),h.I=null)}e.isActive=function(){return!!this.g};function Ys(h){return h.g?h.g.readyState:0}e.Z=function(){try{return 2<Ys(this)?this.g.status:-1}catch{return-1}},e.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},e.Oa=function(h){if(this.g){var _=this.g.responseText;return h&&_.indexOf(h)==0&&(_=_.substring(h.length)),po(_)}};function Uv(h){try{if(!h.g)return null;if("response"in h.g)return h.g.response;switch(h.H){case"":case"text":return h.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in h.g)return h.g.mozResponseArrayBuffer}return null}catch{return null}}function iN(h){const _={};h=(h.g&&2<=Ys(h)&&h.g.getAllResponseHeaders()||"").split(`\r
`);for(let W=0;W<h.length;W++){if(E(h[W]))continue;var A=b(h[W]);const oe=A[0];if(A=A[1],typeof A!="string")continue;A=A.trim();const he=_[oe]||[];_[oe]=he,he.push(A)}v(_,function(W){return W.join(", ")})}e.Ba=function(){return this.m},e.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function jl(h,_,A){return A&&A.internalChannelParams&&A.internalChannelParams[h]||_}function Vv(h){this.Aa=0,this.i=[],this.j=new le,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=jl("failFast",!1,h),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=jl("baseRetryDelayMs",5e3,h),this.cb=jl("retryDelaySeedMs",1e4,h),this.Wa=jl("forwardChannelMaxRetries",2,h),this.wa=jl("forwardChannelRequestTimeoutMs",2e4,h),this.pa=h&&h.xmlHttpFactory||void 0,this.Xa=h&&h.Tb||void 0,this.Ca=h&&h.useFetchStreams||!1,this.L=void 0,this.J=h&&h.supportsCrossDomainXhr||!1,this.K="",this.h=new ht(h&&h.concurrentRequestLimit),this.Da=new rN,this.P=h&&h.fastHandshake||!1,this.O=h&&h.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=h&&h.Rb||!1,h&&h.xa&&this.j.xa(),h&&h.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&h&&h.detectBufferingProxy||!1,this.ja=void 0,h&&h.longPollingTimeout&&0<h.longPollingTimeout&&(this.ja=h.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}e=Vv.prototype,e.la=8,e.G=1,e.connect=function(h,_,A,W){nr(0),this.W=h,this.H=_||{},A&&W!==void 0&&(this.H.OSID=A,this.H.OAID=W),this.F=this.X,this.I=Yv(this,null,this.W),af(this)};function h0(h){if(Bv(h),h.G==3){var _=h.U++,A=qs(h.I);if(At(A,"SID",h.K),At(A,"RID",_),At(A,"TYPE","terminate"),Ul(h,A),_=new ae(h,h.j,_),_.L=2,_.v=ef(qs(A)),A=!1,o.navigator&&o.navigator.sendBeacon)try{A=o.navigator.sendBeacon(_.v.toString(),"")}catch{}!A&&o.Image&&(new Image().src=_.v,A=!0),A||(_.g=Xv(_.j,null),_.g.ea(_.v)),_.F=Date.now(),ke(_)}qv(h)}function sf(h){h.g&&(m0(h),h.g.cancel(),h.g=null)}function Bv(h){sf(h),h.u&&(o.clearTimeout(h.u),h.u=null),of(h),h.h.cancel(),h.s&&(typeof h.s=="number"&&o.clearTimeout(h.s),h.s=null)}function af(h){if(!xr(h.h)&&!h.s){h.s=!0;var _=h.Ga;ue||ne(),q||(ue(),q=!0),G.add(_,h),h.B=0}}function oN(h,_){return Mn(h.h)>=h.h.j-(h.s?1:0)?!1:h.s?(h.i=_.D.concat(h.i),!0):h.G==1||h.G==2||h.B>=(h.Va?0:h.Wa)?!1:(h.s=te(m(h.Ga,h,_),Kv(h,h.B)),h.B++,!0)}e.Ga=function(h){if(this.s)if(this.s=null,this.G==1){if(!h){this.U=Math.floor(1e5*Math.random()),h=this.U++;const oe=new ae(this,this.j,h);let he=this.o;if(this.S&&(he?(he=T(he),C(he,this.S)):he=this.S),this.m!==null||this.O||(oe.H=he,he=null),this.P)e:{for(var _=0,A=0;A<this.i.length;A++){t:{var W=this.i[A];if("__data__"in W.map&&(W=W.map.__data__,typeof W=="string")){W=W.length;break t}W=void 0}if(W===void 0)break;if(_+=W,4096<_){_=A;break e}if(_===4096||A===this.i.length-1){_=A+1;break e}}_=1e3}else _=1e3;_=zv(this,oe,_),A=qs(this.I),At(A,"RID",h),At(A,"CVER",22),this.D&&At(A,"X-HTTP-Session-Id",this.D),Ul(this,A),he&&(this.O?_="headers="+encodeURIComponent(String(Fv(he)))+"&"+_:this.m&&f0(A,this.m,he)),ys(this.h,oe),this.Ua&&At(A,"TYPE","init"),this.P?(At(A,"$req",_),At(A,"SID","null"),oe.T=!0,me(oe,A,null)):me(oe,A,_),this.G=2}}else this.G==3&&(h?Wv(this,h):this.i.length==0||xr(this.h)||Wv(this))};function Wv(h,_){var A;_?A=_.l:A=h.U++;const W=qs(h.I);At(W,"SID",h.K),At(W,"RID",A),At(W,"AID",h.T),Ul(h,W),h.m&&h.o&&f0(W,h.m,h.o),A=new ae(h,h.j,A,h.B+1),h.m===null&&(A.H=h.o),_&&(h.i=_.D.concat(h.i)),_=zv(h,A,1e3),A.I=Math.round(.5*h.wa)+Math.round(.5*h.wa*Math.random()),ys(h.h,A),me(A,W,_)}function Ul(h,_){h.H&&O(h.H,function(A,W){At(_,W,A)}),h.l&&Av({},function(A,W){At(_,W,A)})}function zv(h,_,A){A=Math.min(h.i.length,A);var W=h.l?m(h.l.Na,h.l,h):null;e:{var oe=h.i;let he=-1;for(;;){const Se=["count="+A];he==-1?0<A?(he=oe[0].g,Se.push("ofs="+he)):he=0:Se.push("ofs="+he);let wt=!0;for(let vr=0;vr<A;vr++){let ct=oe[vr].g;const br=oe[vr].map;if(ct-=he,0>ct)he=Math.max(0,oe[vr].g-100),wt=!1;else try{nN(br,Se,"req"+ct+"_")}catch{W&&W(br)}}if(wt){W=Se.join("&");break e}}}return h=h.i.splice(0,A),_.D=h,W}function $v(h){if(!h.g&&!h.u){h.Y=1;var _=h.Fa;ue||ne(),q||(ue(),q=!0),G.add(_,h),h.v=0}}function d0(h){return h.g||h.u||3<=h.v?!1:(h.Y++,h.u=te(m(h.Fa,h),Kv(h,h.v)),h.v++,!0)}e.Fa=function(){if(this.u=null,Hv(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var h=2*this.R;this.j.info("BP detection timer enabled: "+h),this.A=te(m(this.ab,this),h)}},e.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,nr(10),sf(this),Hv(this))};function m0(h){h.A!=null&&(o.clearTimeout(h.A),h.A=null)}function Hv(h){h.g=new ae(h,h.j,"rpc",h.Y),h.m===null&&(h.g.H=h.o),h.g.O=0;var _=qs(h.qa);At(_,"RID","rpc"),At(_,"SID",h.K),At(_,"AID",h.T),At(_,"CI",h.F?"0":"1"),!h.F&&h.ja&&At(_,"TO",h.ja),At(_,"TYPE","xmlhttp"),Ul(h,_),h.m&&h.o&&f0(_,h.m,h.o),h.L&&(h.g.I=h.L);var A=h.g;h=h.ia,A.L=1,A.v=ef(qs(_)),A.m=null,A.P=!0,Te(A,h)}e.Za=function(){this.C!=null&&(this.C=null,sf(this),d0(this),nr(19))};function of(h){h.C!=null&&(o.clearTimeout(h.C),h.C=null)}function Gv(h,_){var A=null;if(h.g==_){of(h),m0(h),h.g=null;var W=2}else if(rt(h.h,_))A=_.D,Pl(h.h,_),W=1;else return;if(h.G!=0){if(_.o)if(W==1){A=_.m?_.m.length:0,_=Date.now()-_.F;var oe=h.B;W=Gs(),St(W,new X(W,A)),af(h)}else $v(h);else if(oe=_.s,oe==3||oe==0&&0<_.X||!(W==1&&oN(h,_)||W==2&&d0(h)))switch(A&&0<A.length&&(_=h.h,_.i=_.i.concat(A)),oe){case 1:Ei(h,5);break;case 4:Ei(h,10);break;case 3:Ei(h,6);break;default:Ei(h,2)}}}function Kv(h,_){let A=h.Ta+Math.floor(Math.random()*h.cb);return h.isActive()||(A*=2),A*_}function Ei(h,_){if(h.j.info("Error code "+_),_==2){var A=m(h.fb,h),W=h.Xa;const oe=!W;W=new wi(W||"//www.google.com/images/cleardot.gif"),o.location&&o.location.protocol=="http"||Ju(W,"https"),ef(W),oe?eN(W.toString(),A):tN(W.toString(),A)}else nr(2);h.G=0,h.l&&h.l.sa(_),qv(h),Bv(h)}e.fb=function(h){h?(this.j.info("Successfully pinged google.com"),nr(2)):(this.j.info("Failed to ping google.com"),nr(1))};function qv(h){if(h.G=0,h.ka=[],h.l){const _=Qu(h.h);(_.length!=0||h.i.length!=0)&&(w(h.ka,_),w(h.ka,h.i),h.h.i.length=0,g(h.i),h.i.length=0),h.l.ra()}}function Yv(h,_,A){var W=A instanceof wi?qs(A):new wi(A);if(W.g!="")_&&(W.g=_+"."+W.g),Zu(W,W.s);else{var oe=o.location;W=oe.protocol,_=_?_+"."+oe.hostname:oe.hostname,oe=+oe.port;var he=new wi(null);W&&Ju(he,W),_&&(he.g=_),oe&&Zu(he,oe),A&&(he.l=A),W=he}return A=h.D,_=h.ya,A&&_&&At(W,A,_),At(W,"VER",h.la),Ul(h,W),W}function Xv(h,_,A){if(_&&!h.J)throw Error("Can't create secondary domain capable XhrIo object.");return _=h.Ca&&!h.pa?new Vt(new tf({eb:A})):new Vt(h.pa),_.Ha(h.J),_}e.isActive=function(){return!!this.l&&this.l.isActive(this)};function Qv(){}e=Qv.prototype,e.ua=function(){},e.ta=function(){},e.sa=function(){},e.ra=function(){},e.isActive=function(){return!0},e.Na=function(){};function lf(){}lf.prototype.g=function(h,_){return new yn(h,_)};function yn(h,_){vt.call(this),this.g=new Vv(_),this.l=h,this.h=_&&_.messageUrlParams||null,h=_&&_.messageHeaders||null,_&&_.clientProtocolHeaderRequired&&(h?h["X-Client-Protocol"]="webchannel":h={"X-Client-Protocol":"webchannel"}),this.g.o=h,h=_&&_.initMessageHeaders||null,_&&_.messageContentType&&(h?h["X-WebChannel-Content-Type"]=_.messageContentType:h={"X-WebChannel-Content-Type":_.messageContentType}),_&&_.va&&(h?h["X-WebChannel-Client-Profile"]=_.va:h={"X-WebChannel-Client-Profile":_.va}),this.g.S=h,(h=_&&_.Sb)&&!E(h)&&(this.g.m=h),this.v=_&&_.supportsCrossDomainXhr||!1,this.u=_&&_.sendRawJson||!1,(_=_&&_.httpSessionIdParam)&&!E(_)&&(this.g.D=_,h=this.h,h!==null&&_ in h&&(h=this.h,_ in h&&delete h[_])),this.j=new yo(this)}x(yn,vt),yn.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},yn.prototype.close=function(){h0(this.g)},yn.prototype.o=function(h){var _=this.g;if(typeof h=="string"){var A={};A.__data__=h,h=A}else this.u&&(A={},A.__data__=zs(h),h=A);_.i.push(new Ge(_.Ya++,h)),_.G==3&&af(_)},yn.prototype.N=function(){this.g.l=null,delete this.j,h0(this.g),delete this.g,yn.aa.N.call(this)};function Jv(h){Hs.call(this),h.__headers__&&(this.headers=h.__headers__,this.statusCode=h.__status__,delete h.__headers__,delete h.__status__);var _=h.__sm__;if(_){e:{for(const A in _){h=A;break e}h=void 0}(this.i=h)&&(h=this.i,_=_!==null&&h in _?_[h]:void 0),this.data=_}else this.data=h}x(Jv,Hs);function Zv(){vs.call(this),this.status=1}x(Zv,vs);function yo(h){this.g=h}x(yo,Qv),yo.prototype.ua=function(){St(this.g,"a")},yo.prototype.ta=function(h){St(this.g,new Jv(h))},yo.prototype.sa=function(h){St(this.g,new Zv)},yo.prototype.ra=function(){St(this.g,"b")},lf.prototype.createWebChannel=lf.prototype.g,yn.prototype.send=yn.prototype.o,yn.prototype.open=yn.prototype.m,yn.prototype.close=yn.prototype.close,Dk=function(){return new lf},Pk=function(){return Gs()},Rk=Fn,_p={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},F.NO_ERROR=0,F.TIMEOUT=8,F.HTTP_ERROR=6,ih=F,L.COMPLETE="complete",bk=L,Sa.EventType=Qn,Qn.OPEN="a",Qn.CLOSE="b",Qn.ERROR="c",Qn.MESSAGE="d",vt.prototype.listen=vt.prototype.K,nc=Sa,Vt.prototype.listenOnce=Vt.prototype.L,Vt.prototype.getLastError=Vt.prototype.Ka,Vt.prototype.getLastErrorCode=Vt.prototype.Ba,Vt.prototype.getStatus=Vt.prototype.Z,Vt.prototype.getResponseJson=Vt.prototype.Oa,Vt.prototype.getResponseText=Vt.prototype.oa,Vt.prototype.send=Vt.prototype.ea,Vt.prototype.setWithCredentials=Vt.prototype.Ha,Ck=Vt}).apply(typeof Cf<"u"?Cf:typeof self<"u"?self:typeof window<"u"?window:{});const n_="@firebase/firestore";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mr{constructor(t){this.uid=t}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(t){return t.uid===this.uid}}Mr.UNAUTHENTICATED=new Mr(null),Mr.GOOGLE_CREDENTIALS=new Mr("google-credentials-uid"),Mr.FIRST_PARTY=new Mr("first-party-uid"),Mr.MOCK_USER=new Mr("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Sl="10.14.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xi=new Jg("@firebase/firestore");function Ql(){return Xi.logLevel}function Re(e,...t){if(Xi.logLevel<=Ze.DEBUG){const r=t.map(fx);Xi.debug(`Firestore (${Sl}): ${e}`,...r)}}function va(e,...t){if(Xi.logLevel<=Ze.ERROR){const r=t.map(fx);Xi.error(`Firestore (${Sl}): ${e}`,...r)}}function fl(e,...t){if(Xi.logLevel<=Ze.WARN){const r=t.map(fx);Xi.warn(`Firestore (${Sl}): ${e}`,...r)}}function fx(e){if(typeof e=="string")return e;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(r){return JSON.stringify(r)}(e)}catch{return e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function je(e="Unexpected state"){const t=`FIRESTORE (${Sl}) INTERNAL ASSERTION FAILED: `+e;throw va(t),new Error(t)}function xt(e,t){e||je()}function ze(e,t){return e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ge={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class be extends js{constructor(t,r){super(t,r),this.code=t,this.message=r,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oa{constructor(){this.promise=new Promise((t,r)=>{this.resolve=t,this.reject=r})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fk{constructor(t,r){this.user=r,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${t}`)}}class Y3{getToken(){return Promise.resolve(null)}invalidateToken(){}start(t,r){t.enqueueRetryable(()=>r(Mr.UNAUTHENTICATED))}shutdown(){}}class X3{constructor(t){this.token=t,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(t,r){this.changeListener=r,t.enqueueRetryable(()=>r(this.token.user))}shutdown(){this.changeListener=null}}class Q3{constructor(t){this.t=t,this.currentUser=Mr.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(t,r){xt(this.o===void 0);let n=this.i;const s=l=>this.i!==n?(n=this.i,r(l)):Promise.resolve();let a=new oa;this.o=()=>{this.i++,this.currentUser=this.u(),a.resolve(),a=new oa,t.enqueueRetryable(()=>s(this.currentUser))};const i=()=>{const l=a;t.enqueueRetryable(async()=>{await l.promise,await s(this.currentUser)})},o=l=>{Re("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=l,this.o&&(this.auth.addAuthTokenListener(this.o),i())};this.t.onInit(l=>o(l)),setTimeout(()=>{if(!this.auth){const l=this.t.getImmediate({optional:!0});l?o(l):(Re("FirebaseAuthCredentialsProvider","Auth not yet detected"),a.resolve(),a=new oa)}},0),i()}getToken(){const t=this.i,r=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(r).then(n=>this.i!==t?(Re("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):n?(xt(typeof n.accessToken=="string"),new Fk(n.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const t=this.auth&&this.auth.getUid();return xt(t===null||typeof t=="string"),new Mr(t)}}class J3{constructor(t,r,n){this.l=t,this.h=r,this.P=n,this.type="FirstParty",this.user=Mr.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);const t=this.T();return t&&this.I.set("Authorization",t),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}}class Z3{constructor(t,r,n){this.l=t,this.h=r,this.P=n}getToken(){return Promise.resolve(new J3(this.l,this.h,this.P))}start(t,r){t.enqueueRetryable(()=>r(Mr.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class eF{constructor(t){this.value=t,this.type="AppCheck",this.headers=new Map,t&&t.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class tF{constructor(t){this.A=t,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(t,r){xt(this.o===void 0);const n=a=>{a.error!=null&&Re("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${a.error.message}`);const i=a.token!==this.R;return this.R=a.token,Re("FirebaseAppCheckTokenProvider",`Received ${i?"new":"existing"} token.`),i?r(a.token):Promise.resolve()};this.o=a=>{t.enqueueRetryable(()=>n(a))};const s=a=>{Re("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=a,this.o&&this.appCheck.addTokenListener(this.o)};this.A.onInit(a=>s(a)),setTimeout(()=>{if(!this.appCheck){const a=this.A.getImmediate({optional:!0});a?s(a):Re("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const t=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(t).then(r=>r?(xt(typeof r.token=="string"),this.R=r.token,new eF(r.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rF(e){const t=typeof self<"u"&&(self.crypto||self.msCrypto),r=new Uint8Array(e);if(t&&typeof t.getRandomValues=="function")t.getRandomValues(r);else for(let n=0;n<e;n++)r[n]=Math.floor(256*Math.random());return r}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ok{static newId(){const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",r=Math.floor(256/t.length)*t.length;let n="";for(;n.length<20;){const s=rF(40);for(let a=0;a<s.length;++a)n.length<20&&s[a]<r&&(n+=t.charAt(s[a]%t.length))}return n}}function ut(e,t){return e<t?-1:e>t?1:0}function hl(e,t,r){return e.length===t.length&&e.every((n,s)=>r(n,t[s]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lr{constructor(t,r){if(this.seconds=t,this.nanoseconds=r,r<0)throw new be(ge.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+r);if(r>=1e9)throw new be(ge.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+r);if(t<-62135596800)throw new be(ge.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(t>=253402300800)throw new be(ge.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}static now(){return lr.fromMillis(Date.now())}static fromDate(t){return lr.fromMillis(t.getTime())}static fromMillis(t){const r=Math.floor(t/1e3),n=Math.floor(1e6*(t-1e3*r));return new lr(r,n)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(t){return this.seconds===t.seconds?ut(this.nanoseconds,t.nanoseconds):ut(this.seconds,t.seconds)}isEqual(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const t=this.seconds- -62135596800;return String(t).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Be{constructor(t){this.timestamp=t}static fromTimestamp(t){return new Be(t)}static min(){return new Be(new lr(0,0))}static max(){return new Be(new lr(253402300799,999999999))}compareTo(t){return this.timestamp._compareTo(t.timestamp)}isEqual(t){return this.timestamp.isEqual(t.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ru{constructor(t,r,n){r===void 0?r=0:r>t.length&&je(),n===void 0?n=t.length-r:n>t.length-r&&je(),this.segments=t,this.offset=r,this.len=n}get length(){return this.len}isEqual(t){return ru.comparator(this,t)===0}child(t){const r=this.segments.slice(this.offset,this.limit());return t instanceof ru?t.forEach(n=>{r.push(n)}):r.push(t),this.construct(r)}limit(){return this.offset+this.length}popFirst(t){return t=t===void 0?1:t,this.construct(this.segments,this.offset+t,this.length-t)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(t){return this.segments[this.offset+t]}isEmpty(){return this.length===0}isPrefixOf(t){if(t.length<this.length)return!1;for(let r=0;r<this.length;r++)if(this.get(r)!==t.get(r))return!1;return!0}isImmediateParentOf(t){if(this.length+1!==t.length)return!1;for(let r=0;r<this.length;r++)if(this.get(r)!==t.get(r))return!1;return!0}forEach(t){for(let r=this.offset,n=this.limit();r<n;r++)t(this.segments[r])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(t,r){const n=Math.min(t.length,r.length);for(let s=0;s<n;s++){const a=t.get(s),i=r.get(s);if(a<i)return-1;if(a>i)return 1}return t.length<r.length?-1:t.length>r.length?1:0}}class Nt extends ru{construct(t,r,n){return new Nt(t,r,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...t){const r=[];for(const n of t){if(n.indexOf("//")>=0)throw new be(ge.INVALID_ARGUMENT,`Invalid segment (${n}). Paths must not contain // in them.`);r.push(...n.split("/").filter(s=>s.length>0))}return new Nt(r)}static emptyPath(){return new Nt([])}}const nF=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Er extends ru{construct(t,r,n){return new Er(t,r,n)}static isValidIdentifier(t){return nF.test(t)}canonicalString(){return this.toArray().map(t=>(t=t.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Er.isValidIdentifier(t)||(t="`"+t+"`"),t)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new Er(["__name__"])}static fromServerFormat(t){const r=[];let n="",s=0;const a=()=>{if(n.length===0)throw new be(ge.INVALID_ARGUMENT,`Invalid field path (${t}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);r.push(n),n=""};let i=!1;for(;s<t.length;){const o=t[s];if(o==="\\"){if(s+1===t.length)throw new be(ge.INVALID_ARGUMENT,"Path has trailing escape character: "+t);const l=t[s+1];if(l!=="\\"&&l!=="."&&l!=="`")throw new be(ge.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);n+=l,s+=2}else o==="`"?(i=!i,s++):o!=="."||i?(n+=o,s++):(a(),s++)}if(a(),i)throw new be(ge.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new Er(r)}static emptyPath(){return new Er([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pe{constructor(t){this.path=t}static fromPath(t){return new Pe(Nt.fromString(t))}static fromName(t){return new Pe(Nt.fromString(t).popFirst(5))}static empty(){return new Pe(Nt.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(t){return this.path.length>=2&&this.path.get(this.path.length-2)===t}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(t){return t!==null&&Nt.comparator(this.path,t.path)===0}toString(){return this.path.toString()}static comparator(t,r){return Nt.comparator(t.path,r.path)}static isDocumentKey(t){return t.length%2==0}static fromSegments(t){return new Pe(new Nt(t.slice()))}}function sF(e,t){const r=e.toTimestamp().seconds,n=e.toTimestamp().nanoseconds+1,s=Be.fromTimestamp(n===1e9?new lr(r+1,0):new lr(r,n));return new ci(s,Pe.empty(),t)}function aF(e){return new ci(e.readTime,e.key,-1)}class ci{constructor(t,r,n){this.readTime=t,this.documentKey=r,this.largestBatchId=n}static min(){return new ci(Be.min(),Pe.empty(),-1)}static max(){return new ci(Be.max(),Pe.empty(),-1)}}function iF(e,t){let r=e.readTime.compareTo(t.readTime);return r!==0?r:(r=Pe.comparator(e.documentKey,t.documentKey),r!==0?r:ut(e.largestBatchId,t.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oF="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class lF{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(t){this.onCommittedListeners.push(t)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(t=>t())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Du(e){if(e.code!==ge.FAILED_PRECONDITION||e.message!==oF)throw e;Re("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ye{constructor(t){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,t(r=>{this.isDone=!0,this.result=r,this.nextCallback&&this.nextCallback(r)},r=>{this.isDone=!0,this.error=r,this.catchCallback&&this.catchCallback(r)})}catch(t){return this.next(void 0,t)}next(t,r){return this.callbackAttached&&je(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(r,this.error):this.wrapSuccess(t,this.result):new ye((n,s)=>{this.nextCallback=a=>{this.wrapSuccess(t,a).next(n,s)},this.catchCallback=a=>{this.wrapFailure(r,a).next(n,s)}})}toPromise(){return new Promise((t,r)=>{this.next(t,r)})}wrapUserFunction(t){try{const r=t();return r instanceof ye?r:ye.resolve(r)}catch(r){return ye.reject(r)}}wrapSuccess(t,r){return t?this.wrapUserFunction(()=>t(r)):ye.resolve(r)}wrapFailure(t,r){return t?this.wrapUserFunction(()=>t(r)):ye.reject(r)}static resolve(t){return new ye((r,n)=>{r(t)})}static reject(t){return new ye((r,n)=>{n(t)})}static waitFor(t){return new ye((r,n)=>{let s=0,a=0,i=!1;t.forEach(o=>{++s,o.next(()=>{++a,i&&a===s&&r()},l=>n(l))}),i=!0,a===s&&r()})}static or(t){let r=ye.resolve(!1);for(const n of t)r=r.next(s=>s?ye.resolve(s):n());return r}static forEach(t,r){const n=[];return t.forEach((s,a)=>{n.push(r.call(this,s,a))}),this.waitFor(n)}static mapArray(t,r){return new ye((n,s)=>{const a=t.length,i=new Array(a);let o=0;for(let l=0;l<a;l++){const c=l;r(t[c]).next(f=>{i[c]=f,++o,o===a&&n(i)},f=>s(f))}})}static doWhile(t,r){return new ye((n,s)=>{const a=()=>{t()===!0?r().next(()=>{a()},s):n()};a()})}}function cF(e){const t=e.match(/Android ([\d.]+)/i),r=t?t[1].split(".").slice(0,2).join("."):"-1";return Number(r)}function Fu(e){return e.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hx{constructor(t,r){this.previousValue=t,r&&(r.sequenceNumberHandler=n=>this.ie(n),this.se=n=>r.writeSequenceNumber(n))}ie(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue}next(){const t=++this.previousValue;return this.se&&this.se(t),t}}hx.oe=-1;function Bd(e){return e==null}function qh(e){return e===0&&1/e==-1/0}function uF(e){return typeof e=="number"&&Number.isInteger(e)&&!qh(e)&&e<=Number.MAX_SAFE_INTEGER&&e>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function s_(e){let t=0;for(const r in e)Object.prototype.hasOwnProperty.call(e,r)&&t++;return t}function ao(e,t){for(const r in e)Object.prototype.hasOwnProperty.call(e,r)&&t(r,e[r])}function Mk(e){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ut{constructor(t,r){this.comparator=t,this.root=r||_r.EMPTY}insert(t,r){return new Ut(this.comparator,this.root.insert(t,r,this.comparator).copy(null,null,_r.BLACK,null,null))}remove(t){return new Ut(this.comparator,this.root.remove(t,this.comparator).copy(null,null,_r.BLACK,null,null))}get(t){let r=this.root;for(;!r.isEmpty();){const n=this.comparator(t,r.key);if(n===0)return r.value;n<0?r=r.left:n>0&&(r=r.right)}return null}indexOf(t){let r=0,n=this.root;for(;!n.isEmpty();){const s=this.comparator(t,n.key);if(s===0)return r+n.left.size;s<0?n=n.left:(r+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(t){return this.root.inorderTraversal(t)}forEach(t){this.inorderTraversal((r,n)=>(t(r,n),!1))}toString(){const t=[];return this.inorderTraversal((r,n)=>(t.push(`${r}:${n}`),!1)),`{${t.join(", ")}}`}reverseTraversal(t){return this.root.reverseTraversal(t)}getIterator(){return new bf(this.root,null,this.comparator,!1)}getIteratorFrom(t){return new bf(this.root,t,this.comparator,!1)}getReverseIterator(){return new bf(this.root,null,this.comparator,!0)}getReverseIteratorFrom(t){return new bf(this.root,t,this.comparator,!0)}}class bf{constructor(t,r,n,s){this.isReverse=s,this.nodeStack=[];let a=1;for(;!t.isEmpty();)if(a=r?n(t.key,r):1,r&&s&&(a*=-1),a<0)t=this.isReverse?t.left:t.right;else{if(a===0){this.nodeStack.push(t);break}this.nodeStack.push(t),t=this.isReverse?t.right:t.left}}getNext(){let t=this.nodeStack.pop();const r={key:t.key,value:t.value};if(this.isReverse)for(t=t.left;!t.isEmpty();)this.nodeStack.push(t),t=t.right;else for(t=t.right;!t.isEmpty();)this.nodeStack.push(t),t=t.left;return r}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const t=this.nodeStack[this.nodeStack.length-1];return{key:t.key,value:t.value}}}class _r{constructor(t,r,n,s,a){this.key=t,this.value=r,this.color=n??_r.RED,this.left=s??_r.EMPTY,this.right=a??_r.EMPTY,this.size=this.left.size+1+this.right.size}copy(t,r,n,s,a){return new _r(t??this.key,r??this.value,n??this.color,s??this.left,a??this.right)}isEmpty(){return!1}inorderTraversal(t){return this.left.inorderTraversal(t)||t(this.key,this.value)||this.right.inorderTraversal(t)}reverseTraversal(t){return this.right.reverseTraversal(t)||t(this.key,this.value)||this.left.reverseTraversal(t)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(t,r,n){let s=this;const a=n(t,s.key);return s=a<0?s.copy(null,null,null,s.left.insert(t,r,n),null):a===0?s.copy(null,r,null,null,null):s.copy(null,null,null,null,s.right.insert(t,r,n)),s.fixUp()}removeMin(){if(this.left.isEmpty())return _r.EMPTY;let t=this;return t.left.isRed()||t.left.left.isRed()||(t=t.moveRedLeft()),t=t.copy(null,null,null,t.left.removeMin(),null),t.fixUp()}remove(t,r){let n,s=this;if(r(t,s.key)<0)s.left.isEmpty()||s.left.isRed()||s.left.left.isRed()||(s=s.moveRedLeft()),s=s.copy(null,null,null,s.left.remove(t,r),null);else{if(s.left.isRed()&&(s=s.rotateRight()),s.right.isEmpty()||s.right.isRed()||s.right.left.isRed()||(s=s.moveRedRight()),r(t,s.key)===0){if(s.right.isEmpty())return _r.EMPTY;n=s.right.min(),s=s.copy(n.key,n.value,null,null,s.right.removeMin())}s=s.copy(null,null,null,null,s.right.remove(t,r))}return s.fixUp()}isRed(){return this.color}fixUp(){let t=this;return t.right.isRed()&&!t.left.isRed()&&(t=t.rotateLeft()),t.left.isRed()&&t.left.left.isRed()&&(t=t.rotateRight()),t.left.isRed()&&t.right.isRed()&&(t=t.colorFlip()),t}moveRedLeft(){let t=this.colorFlip();return t.right.left.isRed()&&(t=t.copy(null,null,null,null,t.right.rotateRight()),t=t.rotateLeft(),t=t.colorFlip()),t}moveRedRight(){let t=this.colorFlip();return t.left.left.isRed()&&(t=t.rotateRight(),t=t.colorFlip()),t}rotateLeft(){const t=this.copy(null,null,_r.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)}rotateRight(){const t=this.copy(null,null,_r.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)}colorFlip(){const t=this.left.copy(null,null,!this.left.color,null,null),r=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,r)}checkMaxDepth(){const t=this.check();return Math.pow(2,t)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw je();const t=this.left.check();if(t!==this.right.check())throw je();return t+(this.isRed()?0:1)}}_r.EMPTY=null,_r.RED=!0,_r.BLACK=!1;_r.EMPTY=new class{constructor(){this.size=0}get key(){throw je()}get value(){throw je()}get color(){throw je()}get left(){throw je()}get right(){throw je()}copy(t,r,n,s,a){return this}insert(t,r,n){return new _r(t,r)}remove(t,r){return this}isEmpty(){return!0}inorderTraversal(t){return!1}reverseTraversal(t){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kr{constructor(t){this.comparator=t,this.data=new Ut(this.comparator)}has(t){return this.data.get(t)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(t){return this.data.indexOf(t)}forEach(t){this.data.inorderTraversal((r,n)=>(t(r),!1))}forEachInRange(t,r){const n=this.data.getIteratorFrom(t[0]);for(;n.hasNext();){const s=n.getNext();if(this.comparator(s.key,t[1])>=0)return;r(s.key)}}forEachWhile(t,r){let n;for(n=r!==void 0?this.data.getIteratorFrom(r):this.data.getIterator();n.hasNext();)if(!t(n.getNext().key))return}firstAfterOrEqual(t){const r=this.data.getIteratorFrom(t);return r.hasNext()?r.getNext().key:null}getIterator(){return new a_(this.data.getIterator())}getIteratorFrom(t){return new a_(this.data.getIteratorFrom(t))}add(t){return this.copy(this.data.remove(t).insert(t,!0))}delete(t){return this.has(t)?this.copy(this.data.remove(t)):this}isEmpty(){return this.data.isEmpty()}unionWith(t){let r=this;return r.size<t.size&&(r=t,t=this),t.forEach(n=>{r=r.add(n)}),r}isEqual(t){if(!(t instanceof kr)||this.size!==t.size)return!1;const r=this.data.getIterator(),n=t.data.getIterator();for(;r.hasNext();){const s=r.getNext().key,a=n.getNext().key;if(this.comparator(s,a)!==0)return!1}return!0}toArray(){const t=[];return this.forEach(r=>{t.push(r)}),t}toString(){const t=[];return this.forEach(r=>t.push(r)),"SortedSet("+t.toString()+")"}copy(t){const r=new kr(this.comparator);return r.data=t,r}}class a_{constructor(t){this.iter=t}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sn{constructor(t){this.fields=t,t.sort(Er.comparator)}static empty(){return new Sn([])}unionWith(t){let r=new kr(Er.comparator);for(const n of this.fields)r=r.add(n);for(const n of t)r=r.add(n);return new Sn(r.toArray())}covers(t){for(const r of this.fields)if(r.isPrefixOf(t))return!0;return!1}isEqual(t){return hl(this.fields,t.fields,(r,n)=>r.isEqual(n))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lk extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nr{constructor(t){this.binaryString=t}static fromBase64String(t){const r=function(s){try{return atob(s)}catch(a){throw typeof DOMException<"u"&&a instanceof DOMException?new Lk("Invalid base64 string: "+a):a}}(t);return new Nr(r)}static fromUint8Array(t){const r=function(s){let a="";for(let i=0;i<s.length;++i)a+=String.fromCharCode(s[i]);return a}(t);return new Nr(r)}[Symbol.iterator](){let t=0;return{next:()=>t<this.binaryString.length?{value:this.binaryString.charCodeAt(t++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(r){return btoa(r)}(this.binaryString)}toUint8Array(){return function(r){const n=new Uint8Array(r.length);for(let s=0;s<r.length;s++)n[s]=r.charCodeAt(s);return n}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(t){return ut(this.binaryString,t.binaryString)}isEqual(t){return this.binaryString===t.binaryString}}Nr.EMPTY_BYTE_STRING=new Nr("");const fF=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function ui(e){if(xt(!!e),typeof e=="string"){let t=0;const r=fF.exec(e);if(xt(!!r),r[1]){let s=r[1];s=(s+"000000000").substr(0,9),t=Number(s)}const n=new Date(e);return{seconds:Math.floor(n.getTime()/1e3),nanos:t}}return{seconds:Gt(e.seconds),nanos:Gt(e.nanos)}}function Gt(e){return typeof e=="number"?e:typeof e=="string"?Number(e):0}function Qi(e){return typeof e=="string"?Nr.fromBase64String(e):Nr.fromUint8Array(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function dx(e){var t,r;return((r=(((t=e==null?void 0:e.mapValue)===null||t===void 0?void 0:t.fields)||{}).__type__)===null||r===void 0?void 0:r.stringValue)==="server_timestamp"}function mx(e){const t=e.mapValue.fields.__previous_value__;return dx(t)?mx(t):t}function nu(e){const t=ui(e.mapValue.fields.__local_write_time__.timestampValue);return new lr(t.seconds,t.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hF{constructor(t,r,n,s,a,i,o,l,c){this.databaseId=t,this.appId=r,this.persistenceKey=n,this.host=s,this.ssl=a,this.forceLongPolling=i,this.autoDetectLongPolling=o,this.longPollingOptions=l,this.useFetchStreams=c}}class su{constructor(t,r){this.projectId=t,this.database=r||"(default)"}static empty(){return new su("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(t){return t instanceof su&&t.projectId===this.projectId&&t.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Rf={mapValue:{}};function Ji(e){return"nullValue"in e?0:"booleanValue"in e?1:"integerValue"in e||"doubleValue"in e?2:"timestampValue"in e?3:"stringValue"in e?5:"bytesValue"in e?6:"referenceValue"in e?7:"geoPointValue"in e?8:"arrayValue"in e?9:"mapValue"in e?dx(e)?4:mF(e)?9007199254740991:dF(e)?10:11:je()}function Ps(e,t){if(e===t)return!0;const r=Ji(e);if(r!==Ji(t))return!1;switch(r){case 0:case 9007199254740991:return!0;case 1:return e.booleanValue===t.booleanValue;case 4:return nu(e).isEqual(nu(t));case 3:return function(s,a){if(typeof s.timestampValue=="string"&&typeof a.timestampValue=="string"&&s.timestampValue.length===a.timestampValue.length)return s.timestampValue===a.timestampValue;const i=ui(s.timestampValue),o=ui(a.timestampValue);return i.seconds===o.seconds&&i.nanos===o.nanos}(e,t);case 5:return e.stringValue===t.stringValue;case 6:return function(s,a){return Qi(s.bytesValue).isEqual(Qi(a.bytesValue))}(e,t);case 7:return e.referenceValue===t.referenceValue;case 8:return function(s,a){return Gt(s.geoPointValue.latitude)===Gt(a.geoPointValue.latitude)&&Gt(s.geoPointValue.longitude)===Gt(a.geoPointValue.longitude)}(e,t);case 2:return function(s,a){if("integerValue"in s&&"integerValue"in a)return Gt(s.integerValue)===Gt(a.integerValue);if("doubleValue"in s&&"doubleValue"in a){const i=Gt(s.doubleValue),o=Gt(a.doubleValue);return i===o?qh(i)===qh(o):isNaN(i)&&isNaN(o)}return!1}(e,t);case 9:return hl(e.arrayValue.values||[],t.arrayValue.values||[],Ps);case 10:case 11:return function(s,a){const i=s.mapValue.fields||{},o=a.mapValue.fields||{};if(s_(i)!==s_(o))return!1;for(const l in i)if(i.hasOwnProperty(l)&&(o[l]===void 0||!Ps(i[l],o[l])))return!1;return!0}(e,t);default:return je()}}function au(e,t){return(e.values||[]).find(r=>Ps(r,t))!==void 0}function dl(e,t){if(e===t)return 0;const r=Ji(e),n=Ji(t);if(r!==n)return ut(r,n);switch(r){case 0:case 9007199254740991:return 0;case 1:return ut(e.booleanValue,t.booleanValue);case 2:return function(a,i){const o=Gt(a.integerValue||a.doubleValue),l=Gt(i.integerValue||i.doubleValue);return o<l?-1:o>l?1:o===l?0:isNaN(o)?isNaN(l)?0:-1:1}(e,t);case 3:return i_(e.timestampValue,t.timestampValue);case 4:return i_(nu(e),nu(t));case 5:return ut(e.stringValue,t.stringValue);case 6:return function(a,i){const o=Qi(a),l=Qi(i);return o.compareTo(l)}(e.bytesValue,t.bytesValue);case 7:return function(a,i){const o=a.split("/"),l=i.split("/");for(let c=0;c<o.length&&c<l.length;c++){const f=ut(o[c],l[c]);if(f!==0)return f}return ut(o.length,l.length)}(e.referenceValue,t.referenceValue);case 8:return function(a,i){const o=ut(Gt(a.latitude),Gt(i.latitude));return o!==0?o:ut(Gt(a.longitude),Gt(i.longitude))}(e.geoPointValue,t.geoPointValue);case 9:return o_(e.arrayValue,t.arrayValue);case 10:return function(a,i){var o,l,c,f;const d=a.fields||{},m=i.fields||{},p=(o=d.value)===null||o===void 0?void 0:o.arrayValue,x=(l=m.value)===null||l===void 0?void 0:l.arrayValue,g=ut(((c=p==null?void 0:p.values)===null||c===void 0?void 0:c.length)||0,((f=x==null?void 0:x.values)===null||f===void 0?void 0:f.length)||0);return g!==0?g:o_(p,x)}(e.mapValue,t.mapValue);case 11:return function(a,i){if(a===Rf.mapValue&&i===Rf.mapValue)return 0;if(a===Rf.mapValue)return 1;if(i===Rf.mapValue)return-1;const o=a.fields||{},l=Object.keys(o),c=i.fields||{},f=Object.keys(c);l.sort(),f.sort();for(let d=0;d<l.length&&d<f.length;++d){const m=ut(l[d],f[d]);if(m!==0)return m;const p=dl(o[l[d]],c[f[d]]);if(p!==0)return p}return ut(l.length,f.length)}(e.mapValue,t.mapValue);default:throw je()}}function i_(e,t){if(typeof e=="string"&&typeof t=="string"&&e.length===t.length)return ut(e,t);const r=ui(e),n=ui(t),s=ut(r.seconds,n.seconds);return s!==0?s:ut(r.nanos,n.nanos)}function o_(e,t){const r=e.values||[],n=t.values||[];for(let s=0;s<r.length&&s<n.length;++s){const a=dl(r[s],n[s]);if(a)return a}return ut(r.length,n.length)}function ml(e){return wp(e)}function wp(e){return"nullValue"in e?"null":"booleanValue"in e?""+e.booleanValue:"integerValue"in e?""+e.integerValue:"doubleValue"in e?""+e.doubleValue:"timestampValue"in e?function(r){const n=ui(r);return`time(${n.seconds},${n.nanos})`}(e.timestampValue):"stringValue"in e?e.stringValue:"bytesValue"in e?function(r){return Qi(r).toBase64()}(e.bytesValue):"referenceValue"in e?function(r){return Pe.fromName(r).toString()}(e.referenceValue):"geoPointValue"in e?function(r){return`geo(${r.latitude},${r.longitude})`}(e.geoPointValue):"arrayValue"in e?function(r){let n="[",s=!0;for(const a of r.values||[])s?s=!1:n+=",",n+=wp(a);return n+"]"}(e.arrayValue):"mapValue"in e?function(r){const n=Object.keys(r.fields||{}).sort();let s="{",a=!0;for(const i of n)a?a=!1:s+=",",s+=`${i}:${wp(r.fields[i])}`;return s+"}"}(e.mapValue):je()}function l_(e,t){return{referenceValue:`projects/${e.projectId}/databases/${e.database}/documents/${t.path.canonicalString()}`}}function Ep(e){return!!e&&"integerValue"in e}function px(e){return!!e&&"arrayValue"in e}function c_(e){return!!e&&"nullValue"in e}function u_(e){return!!e&&"doubleValue"in e&&isNaN(Number(e.doubleValue))}function oh(e){return!!e&&"mapValue"in e}function dF(e){var t,r;return((r=(((t=e==null?void 0:e.mapValue)===null||t===void 0?void 0:t.fields)||{}).__type__)===null||r===void 0?void 0:r.stringValue)==="__vector__"}function wc(e){if(e.geoPointValue)return{geoPointValue:Object.assign({},e.geoPointValue)};if(e.timestampValue&&typeof e.timestampValue=="object")return{timestampValue:Object.assign({},e.timestampValue)};if(e.mapValue){const t={mapValue:{fields:{}}};return ao(e.mapValue.fields,(r,n)=>t.mapValue.fields[r]=wc(n)),t}if(e.arrayValue){const t={arrayValue:{values:[]}};for(let r=0;r<(e.arrayValue.values||[]).length;++r)t.arrayValue.values[r]=wc(e.arrayValue.values[r]);return t}return Object.assign({},e)}function mF(e){return(((e.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fn{constructor(t){this.value=t}static empty(){return new fn({mapValue:{}})}field(t){if(t.isEmpty())return this.value;{let r=this.value;for(let n=0;n<t.length-1;++n)if(r=(r.mapValue.fields||{})[t.get(n)],!oh(r))return null;return r=(r.mapValue.fields||{})[t.lastSegment()],r||null}}set(t,r){this.getFieldsMap(t.popLast())[t.lastSegment()]=wc(r)}setAll(t){let r=Er.emptyPath(),n={},s=[];t.forEach((i,o)=>{if(!r.isImmediateParentOf(o)){const l=this.getFieldsMap(r);this.applyChanges(l,n,s),n={},s=[],r=o.popLast()}i?n[o.lastSegment()]=wc(i):s.push(o.lastSegment())});const a=this.getFieldsMap(r);this.applyChanges(a,n,s)}delete(t){const r=this.field(t.popLast());oh(r)&&r.mapValue.fields&&delete r.mapValue.fields[t.lastSegment()]}isEqual(t){return Ps(this.value,t.value)}getFieldsMap(t){let r=this.value;r.mapValue.fields||(r.mapValue={fields:{}});for(let n=0;n<t.length;++n){let s=r.mapValue.fields[t.get(n)];oh(s)&&s.mapValue.fields||(s={mapValue:{fields:{}}},r.mapValue.fields[t.get(n)]=s),r=s}return r.mapValue.fields}applyChanges(t,r,n){ao(r,(s,a)=>t[s]=a);for(const s of n)delete t[s]}clone(){return new fn(wc(this.value))}}function jk(e){const t=[];return ao(e.fields,(r,n)=>{const s=new Er([r]);if(oh(n)){const a=jk(n.mapValue).fields;if(a.length===0)t.push(s);else for(const i of a)t.push(s.child(i))}else t.push(s)}),new Sn(t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ur{constructor(t,r,n,s,a,i,o){this.key=t,this.documentType=r,this.version=n,this.readTime=s,this.createTime=a,this.data=i,this.documentState=o}static newInvalidDocument(t){return new Ur(t,0,Be.min(),Be.min(),Be.min(),fn.empty(),0)}static newFoundDocument(t,r,n,s){return new Ur(t,1,r,Be.min(),n,s,0)}static newNoDocument(t,r){return new Ur(t,2,r,Be.min(),Be.min(),fn.empty(),0)}static newUnknownDocument(t,r){return new Ur(t,3,r,Be.min(),Be.min(),fn.empty(),2)}convertToFoundDocument(t,r){return!this.createTime.isEqual(Be.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=t),this.version=t,this.documentType=1,this.data=r,this.documentState=0,this}convertToNoDocument(t){return this.version=t,this.documentType=2,this.data=fn.empty(),this.documentState=0,this}convertToUnknownDocument(t){return this.version=t,this.documentType=3,this.data=fn.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Be.min(),this}setReadTime(t){return this.readTime=t,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(t){return t instanceof Ur&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.documentType===t.documentType&&this.documentState===t.documentState&&this.data.isEqual(t.data)}mutableCopy(){return new Ur(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yh{constructor(t,r){this.position=t,this.inclusive=r}}function f_(e,t,r){let n=0;for(let s=0;s<e.position.length;s++){const a=t[s],i=e.position[s];if(a.field.isKeyField()?n=Pe.comparator(Pe.fromName(i.referenceValue),r.key):n=dl(i,r.data.field(a.field)),a.dir==="desc"&&(n*=-1),n!==0)break}return n}function h_(e,t){if(e===null)return t===null;if(t===null||e.inclusive!==t.inclusive||e.position.length!==t.position.length)return!1;for(let r=0;r<e.position.length;r++)if(!Ps(e.position[r],t.position[r]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xh{constructor(t,r="asc"){this.field=t,this.dir=r}}function pF(e,t){return e.dir===t.dir&&e.field.isEqual(t.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Uk{}class rr extends Uk{constructor(t,r,n){super(),this.field=t,this.op=r,this.value=n}static create(t,r,n){return t.isKeyField()?r==="in"||r==="not-in"?this.createKeyFieldInFilter(t,r,n):new xF(t,r,n):r==="array-contains"?new _F(t,n):r==="in"?new wF(t,n):r==="not-in"?new EF(t,n):r==="array-contains-any"?new TF(t,n):new rr(t,r,n)}static createKeyFieldInFilter(t,r,n){return r==="in"?new vF(t,n):new yF(t,n)}matches(t){const r=t.data.field(this.field);return this.op==="!="?r!==null&&this.matchesComparison(dl(r,this.value)):r!==null&&Ji(this.value)===Ji(r)&&this.matchesComparison(dl(r,this.value))}matchesComparison(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return t===0;case"!=":return t!==0;case">":return t>0;case">=":return t>=0;default:return je()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class gs extends Uk{constructor(t,r){super(),this.filters=t,this.op=r,this.ae=null}static create(t,r){return new gs(t,r)}matches(t){return Vk(this)?this.filters.find(r=>!r.matches(t))===void 0:this.filters.find(r=>r.matches(t))!==void 0}getFlattenedFilters(){return this.ae!==null||(this.ae=this.filters.reduce((t,r)=>t.concat(r.getFlattenedFilters()),[])),this.ae}getFilters(){return Object.assign([],this.filters)}}function Vk(e){return e.op==="and"}function Bk(e){return gF(e)&&Vk(e)}function gF(e){for(const t of e.filters)if(t instanceof gs)return!1;return!0}function Tp(e){if(e instanceof rr)return e.field.canonicalString()+e.op.toString()+ml(e.value);if(Bk(e))return e.filters.map(t=>Tp(t)).join(",");{const t=e.filters.map(r=>Tp(r)).join(",");return`${e.op}(${t})`}}function Wk(e,t){return e instanceof rr?function(n,s){return s instanceof rr&&n.op===s.op&&n.field.isEqual(s.field)&&Ps(n.value,s.value)}(e,t):e instanceof gs?function(n,s){return s instanceof gs&&n.op===s.op&&n.filters.length===s.filters.length?n.filters.reduce((a,i,o)=>a&&Wk(i,s.filters[o]),!0):!1}(e,t):void je()}function zk(e){return e instanceof rr?function(r){return`${r.field.canonicalString()} ${r.op} ${ml(r.value)}`}(e):e instanceof gs?function(r){return r.op.toString()+" {"+r.getFilters().map(zk).join(" ,")+"}"}(e):"Filter"}class xF extends rr{constructor(t,r,n){super(t,r,n),this.key=Pe.fromName(n.referenceValue)}matches(t){const r=Pe.comparator(t.key,this.key);return this.matchesComparison(r)}}class vF extends rr{constructor(t,r){super(t,"in",r),this.keys=$k("in",r)}matches(t){return this.keys.some(r=>r.isEqual(t.key))}}class yF extends rr{constructor(t,r){super(t,"not-in",r),this.keys=$k("not-in",r)}matches(t){return!this.keys.some(r=>r.isEqual(t.key))}}function $k(e,t){var r;return(((r=t.arrayValue)===null||r===void 0?void 0:r.values)||[]).map(n=>Pe.fromName(n.referenceValue))}class _F extends rr{constructor(t,r){super(t,"array-contains",r)}matches(t){const r=t.data.field(this.field);return px(r)&&au(r.arrayValue,this.value)}}class wF extends rr{constructor(t,r){super(t,"in",r)}matches(t){const r=t.data.field(this.field);return r!==null&&au(this.value.arrayValue,r)}}class EF extends rr{constructor(t,r){super(t,"not-in",r)}matches(t){if(au(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const r=t.data.field(this.field);return r!==null&&!au(this.value.arrayValue,r)}}class TF extends rr{constructor(t,r){super(t,"array-contains-any",r)}matches(t){const r=t.data.field(this.field);return!(!px(r)||!r.arrayValue.values)&&r.arrayValue.values.some(n=>au(this.value.arrayValue,n))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kF{constructor(t,r=null,n=[],s=[],a=null,i=null,o=null){this.path=t,this.collectionGroup=r,this.orderBy=n,this.filters=s,this.limit=a,this.startAt=i,this.endAt=o,this.ue=null}}function d_(e,t=null,r=[],n=[],s=null,a=null,i=null){return new kF(e,t,r,n,s,a,i)}function gx(e){const t=ze(e);if(t.ue===null){let r=t.path.canonicalString();t.collectionGroup!==null&&(r+="|cg:"+t.collectionGroup),r+="|f:",r+=t.filters.map(n=>Tp(n)).join(","),r+="|ob:",r+=t.orderBy.map(n=>function(a){return a.field.canonicalString()+a.dir}(n)).join(","),Bd(t.limit)||(r+="|l:",r+=t.limit),t.startAt&&(r+="|lb:",r+=t.startAt.inclusive?"b:":"a:",r+=t.startAt.position.map(n=>ml(n)).join(",")),t.endAt&&(r+="|ub:",r+=t.endAt.inclusive?"a:":"b:",r+=t.endAt.position.map(n=>ml(n)).join(",")),t.ue=r}return t.ue}function xx(e,t){if(e.limit!==t.limit||e.orderBy.length!==t.orderBy.length)return!1;for(let r=0;r<e.orderBy.length;r++)if(!pF(e.orderBy[r],t.orderBy[r]))return!1;if(e.filters.length!==t.filters.length)return!1;for(let r=0;r<e.filters.length;r++)if(!Wk(e.filters[r],t.filters[r]))return!1;return e.collectionGroup===t.collectionGroup&&!!e.path.isEqual(t.path)&&!!h_(e.startAt,t.startAt)&&h_(e.endAt,t.endAt)}function kp(e){return Pe.isDocumentKey(e.path)&&e.collectionGroup===null&&e.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ou{constructor(t,r=null,n=[],s=[],a=null,i="F",o=null,l=null){this.path=t,this.collectionGroup=r,this.explicitOrderBy=n,this.filters=s,this.limit=a,this.limitType=i,this.startAt=o,this.endAt=l,this.ce=null,this.le=null,this.he=null,this.startAt,this.endAt}}function SF(e,t,r,n,s,a,i,o){return new Ou(e,t,r,n,s,a,i,o)}function Wd(e){return new Ou(e)}function m_(e){return e.filters.length===0&&e.limit===null&&e.startAt==null&&e.endAt==null&&(e.explicitOrderBy.length===0||e.explicitOrderBy.length===1&&e.explicitOrderBy[0].field.isKeyField())}function Hk(e){return e.collectionGroup!==null}function Ec(e){const t=ze(e);if(t.ce===null){t.ce=[];const r=new Set;for(const a of t.explicitOrderBy)t.ce.push(a),r.add(a.field.canonicalString());const n=t.explicitOrderBy.length>0?t.explicitOrderBy[t.explicitOrderBy.length-1].dir:"asc";(function(i){let o=new kr(Er.comparator);return i.filters.forEach(l=>{l.getFlattenedFilters().forEach(c=>{c.isInequality()&&(o=o.add(c.field))})}),o})(t).forEach(a=>{r.has(a.canonicalString())||a.isKeyField()||t.ce.push(new Xh(a,n))}),r.has(Er.keyField().canonicalString())||t.ce.push(new Xh(Er.keyField(),n))}return t.ce}function Cs(e){const t=ze(e);return t.le||(t.le=AF(t,Ec(e))),t.le}function AF(e,t){if(e.limitType==="F")return d_(e.path,e.collectionGroup,t,e.filters,e.limit,e.startAt,e.endAt);{t=t.map(s=>{const a=s.dir==="desc"?"asc":"desc";return new Xh(s.field,a)});const r=e.endAt?new Yh(e.endAt.position,e.endAt.inclusive):null,n=e.startAt?new Yh(e.startAt.position,e.startAt.inclusive):null;return d_(e.path,e.collectionGroup,t,e.filters,e.limit,r,n)}}function Sp(e,t){const r=e.filters.concat([t]);return new Ou(e.path,e.collectionGroup,e.explicitOrderBy.slice(),r,e.limit,e.limitType,e.startAt,e.endAt)}function Ap(e,t,r){return new Ou(e.path,e.collectionGroup,e.explicitOrderBy.slice(),e.filters.slice(),t,r,e.startAt,e.endAt)}function zd(e,t){return xx(Cs(e),Cs(t))&&e.limitType===t.limitType}function Gk(e){return`${gx(Cs(e))}|lt:${e.limitType}`}function ko(e){return`Query(target=${function(r){let n=r.path.canonicalString();return r.collectionGroup!==null&&(n+=" collectionGroup="+r.collectionGroup),r.filters.length>0&&(n+=`, filters: [${r.filters.map(s=>zk(s)).join(", ")}]`),Bd(r.limit)||(n+=", limit: "+r.limit),r.orderBy.length>0&&(n+=`, orderBy: [${r.orderBy.map(s=>function(i){return`${i.field.canonicalString()} (${i.dir})`}(s)).join(", ")}]`),r.startAt&&(n+=", startAt: ",n+=r.startAt.inclusive?"b:":"a:",n+=r.startAt.position.map(s=>ml(s)).join(",")),r.endAt&&(n+=", endAt: ",n+=r.endAt.inclusive?"a:":"b:",n+=r.endAt.position.map(s=>ml(s)).join(",")),`Target(${n})`}(Cs(e))}; limitType=${e.limitType})`}function $d(e,t){return t.isFoundDocument()&&function(n,s){const a=s.key.path;return n.collectionGroup!==null?s.key.hasCollectionId(n.collectionGroup)&&n.path.isPrefixOf(a):Pe.isDocumentKey(n.path)?n.path.isEqual(a):n.path.isImmediateParentOf(a)}(e,t)&&function(n,s){for(const a of Ec(n))if(!a.field.isKeyField()&&s.data.field(a.field)===null)return!1;return!0}(e,t)&&function(n,s){for(const a of n.filters)if(!a.matches(s))return!1;return!0}(e,t)&&function(n,s){return!(n.startAt&&!function(i,o,l){const c=f_(i,o,l);return i.inclusive?c<=0:c<0}(n.startAt,Ec(n),s)||n.endAt&&!function(i,o,l){const c=f_(i,o,l);return i.inclusive?c>=0:c>0}(n.endAt,Ec(n),s))}(e,t)}function IF(e){return e.collectionGroup||(e.path.length%2==1?e.path.lastSegment():e.path.get(e.path.length-2))}function Kk(e){return(t,r)=>{let n=!1;for(const s of Ec(e)){const a=NF(s,t,r);if(a!==0)return a;n=n||s.field.isKeyField()}return 0}}function NF(e,t,r){const n=e.field.isKeyField()?Pe.comparator(t.key,r.key):function(a,i,o){const l=i.data.field(a),c=o.data.field(a);return l!==null&&c!==null?dl(l,c):je()}(e.field,t,r);switch(e.dir){case"asc":return n;case"desc":return-1*n;default:return je()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Al{constructor(t,r){this.mapKeyFn=t,this.equalsFn=r,this.inner={},this.innerSize=0}get(t){const r=this.mapKeyFn(t),n=this.inner[r];if(n!==void 0){for(const[s,a]of n)if(this.equalsFn(s,t))return a}}has(t){return this.get(t)!==void 0}set(t,r){const n=this.mapKeyFn(t),s=this.inner[n];if(s===void 0)return this.inner[n]=[[t,r]],void this.innerSize++;for(let a=0;a<s.length;a++)if(this.equalsFn(s[a][0],t))return void(s[a]=[t,r]);s.push([t,r]),this.innerSize++}delete(t){const r=this.mapKeyFn(t),n=this.inner[r];if(n===void 0)return!1;for(let s=0;s<n.length;s++)if(this.equalsFn(n[s][0],t))return n.length===1?delete this.inner[r]:n.splice(s,1),this.innerSize--,!0;return!1}forEach(t){ao(this.inner,(r,n)=>{for(const[s,a]of n)t(s,a)})}isEmpty(){return Mk(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const CF=new Ut(Pe.comparator);function ya(){return CF}const qk=new Ut(Pe.comparator);function sc(...e){let t=qk;for(const r of e)t=t.insert(r.key,r);return t}function Yk(e){let t=qk;return e.forEach((r,n)=>t=t.insert(r,n.overlayedDocument)),t}function Fi(){return Tc()}function Xk(){return Tc()}function Tc(){return new Al(e=>e.toString(),(e,t)=>e.isEqual(t))}const bF=new Ut(Pe.comparator),RF=new kr(Pe.comparator);function Qe(...e){let t=RF;for(const r of e)t=t.add(r);return t}const PF=new kr(ut);function DF(){return PF}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vx(e,t){if(e.useProto3Json){if(isNaN(t))return{doubleValue:"NaN"};if(t===1/0)return{doubleValue:"Infinity"};if(t===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:qh(t)?"-0":t}}function Qk(e){return{integerValue:""+e}}function Jk(e,t){return uF(t)?Qk(t):vx(e,t)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hd{constructor(){this._=void 0}}function FF(e,t,r){return e instanceof iu?function(s,a){const i={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:s.seconds,nanos:s.nanoseconds}}}};return a&&dx(a)&&(a=mx(a)),a&&(i.fields.__previous_value__=a),{mapValue:i}}(r,t):e instanceof ou?eS(e,t):e instanceof lu?tS(e,t):function(s,a){const i=Zk(s,a),o=p_(i)+p_(s.Pe);return Ep(i)&&Ep(s.Pe)?Qk(o):vx(s.serializer,o)}(e,t)}function OF(e,t,r){return e instanceof ou?eS(e,t):e instanceof lu?tS(e,t):r}function Zk(e,t){return e instanceof cu?function(n){return Ep(n)||function(a){return!!a&&"doubleValue"in a}(n)}(t)?t:{integerValue:0}:null}class iu extends Hd{}class ou extends Hd{constructor(t){super(),this.elements=t}}function eS(e,t){const r=rS(t);for(const n of e.elements)r.some(s=>Ps(s,n))||r.push(n);return{arrayValue:{values:r}}}class lu extends Hd{constructor(t){super(),this.elements=t}}function tS(e,t){let r=rS(t);for(const n of e.elements)r=r.filter(s=>!Ps(s,n));return{arrayValue:{values:r}}}class cu extends Hd{constructor(t,r){super(),this.serializer=t,this.Pe=r}}function p_(e){return Gt(e.integerValue||e.doubleValue)}function rS(e){return px(e)&&e.arrayValue.values?e.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nS{constructor(t,r){this.field=t,this.transform=r}}function MF(e,t){return e.field.isEqual(t.field)&&function(n,s){return n instanceof ou&&s instanceof ou||n instanceof lu&&s instanceof lu?hl(n.elements,s.elements,Ps):n instanceof cu&&s instanceof cu?Ps(n.Pe,s.Pe):n instanceof iu&&s instanceof iu}(e.transform,t.transform)}class LF{constructor(t,r){this.version=t,this.transformResults=r}}class Hn{constructor(t,r){this.updateTime=t,this.exists=r}static none(){return new Hn}static exists(t){return new Hn(void 0,t)}static updateTime(t){return new Hn(t)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)}}function lh(e,t){return e.updateTime!==void 0?t.isFoundDocument()&&t.version.isEqual(e.updateTime):e.exists===void 0||e.exists===t.isFoundDocument()}class Gd{}function sS(e,t){if(!e.hasLocalMutations||t&&t.fields.length===0)return null;if(t===null)return e.isNoDocument()?new yx(e.key,Hn.none()):new Mu(e.key,e.data,Hn.none());{const r=e.data,n=fn.empty();let s=new kr(Er.comparator);for(let a of t.fields)if(!s.has(a)){let i=r.field(a);i===null&&a.length>1&&(a=a.popLast(),i=r.field(a)),i===null?n.delete(a):n.set(a,i),s=s.add(a)}return new yi(e.key,n,new Sn(s.toArray()),Hn.none())}}function jF(e,t,r){e instanceof Mu?function(s,a,i){const o=s.value.clone(),l=x_(s.fieldTransforms,a,i.transformResults);o.setAll(l),a.convertToFoundDocument(i.version,o).setHasCommittedMutations()}(e,t,r):e instanceof yi?function(s,a,i){if(!lh(s.precondition,a))return void a.convertToUnknownDocument(i.version);const o=x_(s.fieldTransforms,a,i.transformResults),l=a.data;l.setAll(aS(s)),l.setAll(o),a.convertToFoundDocument(i.version,l).setHasCommittedMutations()}(e,t,r):function(s,a,i){a.convertToNoDocument(i.version).setHasCommittedMutations()}(0,t,r)}function kc(e,t,r,n){return e instanceof Mu?function(a,i,o,l){if(!lh(a.precondition,i))return o;const c=a.value.clone(),f=v_(a.fieldTransforms,l,i);return c.setAll(f),i.convertToFoundDocument(i.version,c).setHasLocalMutations(),null}(e,t,r,n):e instanceof yi?function(a,i,o,l){if(!lh(a.precondition,i))return o;const c=v_(a.fieldTransforms,l,i),f=i.data;return f.setAll(aS(a)),f.setAll(c),i.convertToFoundDocument(i.version,f).setHasLocalMutations(),o===null?null:o.unionWith(a.fieldMask.fields).unionWith(a.fieldTransforms.map(d=>d.field))}(e,t,r,n):function(a,i,o){return lh(a.precondition,i)?(i.convertToNoDocument(i.version).setHasLocalMutations(),null):o}(e,t,r)}function UF(e,t){let r=null;for(const n of e.fieldTransforms){const s=t.data.field(n.field),a=Zk(n.transform,s||null);a!=null&&(r===null&&(r=fn.empty()),r.set(n.field,a))}return r||null}function g_(e,t){return e.type===t.type&&!!e.key.isEqual(t.key)&&!!e.precondition.isEqual(t.precondition)&&!!function(n,s){return n===void 0&&s===void 0||!(!n||!s)&&hl(n,s,(a,i)=>MF(a,i))}(e.fieldTransforms,t.fieldTransforms)&&(e.type===0?e.value.isEqual(t.value):e.type!==1||e.data.isEqual(t.data)&&e.fieldMask.isEqual(t.fieldMask))}class Mu extends Gd{constructor(t,r,n,s=[]){super(),this.key=t,this.value=r,this.precondition=n,this.fieldTransforms=s,this.type=0}getFieldMask(){return null}}class yi extends Gd{constructor(t,r,n,s,a=[]){super(),this.key=t,this.data=r,this.fieldMask=n,this.precondition=s,this.fieldTransforms=a,this.type=1}getFieldMask(){return this.fieldMask}}function aS(e){const t=new Map;return e.fieldMask.fields.forEach(r=>{if(!r.isEmpty()){const n=e.data.field(r);t.set(r,n)}}),t}function x_(e,t,r){const n=new Map;xt(e.length===r.length);for(let s=0;s<r.length;s++){const a=e[s],i=a.transform,o=t.data.field(a.field);n.set(a.field,OF(i,o,r[s]))}return n}function v_(e,t,r){const n=new Map;for(const s of e){const a=s.transform,i=r.data.field(s.field);n.set(s.field,FF(a,i,t))}return n}class yx extends Gd{constructor(t,r){super(),this.key=t,this.precondition=r,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class VF extends Gd{constructor(t,r){super(),this.key=t,this.precondition=r,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BF{constructor(t,r,n,s){this.batchId=t,this.localWriteTime=r,this.baseMutations=n,this.mutations=s}applyToRemoteDocument(t,r){const n=r.mutationResults;for(let s=0;s<this.mutations.length;s++){const a=this.mutations[s];a.key.isEqual(t.key)&&jF(a,t,n[s])}}applyToLocalView(t,r){for(const n of this.baseMutations)n.key.isEqual(t.key)&&(r=kc(n,t,r,this.localWriteTime));for(const n of this.mutations)n.key.isEqual(t.key)&&(r=kc(n,t,r,this.localWriteTime));return r}applyToLocalDocumentSet(t,r){const n=Xk();return this.mutations.forEach(s=>{const a=t.get(s.key),i=a.overlayedDocument;let o=this.applyToLocalView(i,a.mutatedFields);o=r.has(s.key)?null:o;const l=sS(i,o);l!==null&&n.set(s.key,l),i.isValidDocument()||i.convertToNoDocument(Be.min())}),n}keys(){return this.mutations.reduce((t,r)=>t.add(r.key),Qe())}isEqual(t){return this.batchId===t.batchId&&hl(this.mutations,t.mutations,(r,n)=>g_(r,n))&&hl(this.baseMutations,t.baseMutations,(r,n)=>g_(r,n))}}class _x{constructor(t,r,n,s){this.batch=t,this.commitVersion=r,this.mutationResults=n,this.docVersions=s}static from(t,r,n){xt(t.mutations.length===n.length);let s=function(){return bF}();const a=t.mutations;for(let i=0;i<a.length;i++)s=s.insert(a[i].key,n[i].version);return new _x(t,r,n,s)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class WF{constructor(t,r){this.largestBatchId=t,this.mutation=r}getKey(){return this.mutation.key}isEqual(t){return t!==null&&this.mutation===t.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zF{constructor(t,r){this.count=t,this.unchangedNames=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Qt,nt;function $F(e){switch(e){default:return je();case ge.CANCELLED:case ge.UNKNOWN:case ge.DEADLINE_EXCEEDED:case ge.RESOURCE_EXHAUSTED:case ge.INTERNAL:case ge.UNAVAILABLE:case ge.UNAUTHENTICATED:return!1;case ge.INVALID_ARGUMENT:case ge.NOT_FOUND:case ge.ALREADY_EXISTS:case ge.PERMISSION_DENIED:case ge.FAILED_PRECONDITION:case ge.ABORTED:case ge.OUT_OF_RANGE:case ge.UNIMPLEMENTED:case ge.DATA_LOSS:return!0}}function iS(e){if(e===void 0)return va("GRPC error has no .code"),ge.UNKNOWN;switch(e){case Qt.OK:return ge.OK;case Qt.CANCELLED:return ge.CANCELLED;case Qt.UNKNOWN:return ge.UNKNOWN;case Qt.DEADLINE_EXCEEDED:return ge.DEADLINE_EXCEEDED;case Qt.RESOURCE_EXHAUSTED:return ge.RESOURCE_EXHAUSTED;case Qt.INTERNAL:return ge.INTERNAL;case Qt.UNAVAILABLE:return ge.UNAVAILABLE;case Qt.UNAUTHENTICATED:return ge.UNAUTHENTICATED;case Qt.INVALID_ARGUMENT:return ge.INVALID_ARGUMENT;case Qt.NOT_FOUND:return ge.NOT_FOUND;case Qt.ALREADY_EXISTS:return ge.ALREADY_EXISTS;case Qt.PERMISSION_DENIED:return ge.PERMISSION_DENIED;case Qt.FAILED_PRECONDITION:return ge.FAILED_PRECONDITION;case Qt.ABORTED:return ge.ABORTED;case Qt.OUT_OF_RANGE:return ge.OUT_OF_RANGE;case Qt.UNIMPLEMENTED:return ge.UNIMPLEMENTED;case Qt.DATA_LOSS:return ge.DATA_LOSS;default:return je()}}(nt=Qt||(Qt={}))[nt.OK=0]="OK",nt[nt.CANCELLED=1]="CANCELLED",nt[nt.UNKNOWN=2]="UNKNOWN",nt[nt.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",nt[nt.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",nt[nt.NOT_FOUND=5]="NOT_FOUND",nt[nt.ALREADY_EXISTS=6]="ALREADY_EXISTS",nt[nt.PERMISSION_DENIED=7]="PERMISSION_DENIED",nt[nt.UNAUTHENTICATED=16]="UNAUTHENTICATED",nt[nt.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",nt[nt.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",nt[nt.ABORTED=10]="ABORTED",nt[nt.OUT_OF_RANGE=11]="OUT_OF_RANGE",nt[nt.UNIMPLEMENTED=12]="UNIMPLEMENTED",nt[nt.INTERNAL=13]="INTERNAL",nt[nt.UNAVAILABLE=14]="UNAVAILABLE",nt[nt.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function HF(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const GF=new Ui([4294967295,4294967295],0);function y_(e){const t=HF().encode(e),r=new Nk;return r.update(t),new Uint8Array(r.digest())}function __(e){const t=new DataView(e.buffer),r=t.getUint32(0,!0),n=t.getUint32(4,!0),s=t.getUint32(8,!0),a=t.getUint32(12,!0);return[new Ui([r,n],0),new Ui([s,a],0)]}class wx{constructor(t,r,n){if(this.bitmap=t,this.padding=r,this.hashCount=n,r<0||r>=8)throw new ac(`Invalid padding: ${r}`);if(n<0)throw new ac(`Invalid hash count: ${n}`);if(t.length>0&&this.hashCount===0)throw new ac(`Invalid hash count: ${n}`);if(t.length===0&&r!==0)throw new ac(`Invalid padding when bitmap length is 0: ${r}`);this.Ie=8*t.length-r,this.Te=Ui.fromNumber(this.Ie)}Ee(t,r,n){let s=t.add(r.multiply(Ui.fromNumber(n)));return s.compare(GF)===1&&(s=new Ui([s.getBits(0),s.getBits(1)],0)),s.modulo(this.Te).toNumber()}de(t){return(this.bitmap[Math.floor(t/8)]&1<<t%8)!=0}mightContain(t){if(this.Ie===0)return!1;const r=y_(t),[n,s]=__(r);for(let a=0;a<this.hashCount;a++){const i=this.Ee(n,s,a);if(!this.de(i))return!1}return!0}static create(t,r,n){const s=t%8==0?0:8-t%8,a=new Uint8Array(Math.ceil(t/8)),i=new wx(a,s,r);return n.forEach(o=>i.insert(o)),i}insert(t){if(this.Ie===0)return;const r=y_(t),[n,s]=__(r);for(let a=0;a<this.hashCount;a++){const i=this.Ee(n,s,a);this.Ae(i)}}Ae(t){const r=Math.floor(t/8),n=t%8;this.bitmap[r]|=1<<n}}class ac extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kd{constructor(t,r,n,s,a){this.snapshotVersion=t,this.targetChanges=r,this.targetMismatches=n,this.documentUpdates=s,this.resolvedLimboDocuments=a}static createSynthesizedRemoteEventForCurrentChange(t,r,n){const s=new Map;return s.set(t,Lu.createSynthesizedTargetChangeForCurrentChange(t,r,n)),new Kd(Be.min(),s,new Ut(ut),ya(),Qe())}}class Lu{constructor(t,r,n,s,a){this.resumeToken=t,this.current=r,this.addedDocuments=n,this.modifiedDocuments=s,this.removedDocuments=a}static createSynthesizedTargetChangeForCurrentChange(t,r,n){return new Lu(n,r,Qe(),Qe(),Qe())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ch{constructor(t,r,n,s){this.Re=t,this.removedTargetIds=r,this.key=n,this.Ve=s}}class oS{constructor(t,r){this.targetId=t,this.me=r}}class lS{constructor(t,r,n=Nr.EMPTY_BYTE_STRING,s=null){this.state=t,this.targetIds=r,this.resumeToken=n,this.cause=s}}class w_{constructor(){this.fe=0,this.ge=T_(),this.pe=Nr.EMPTY_BYTE_STRING,this.ye=!1,this.we=!0}get current(){return this.ye}get resumeToken(){return this.pe}get Se(){return this.fe!==0}get be(){return this.we}De(t){t.approximateByteSize()>0&&(this.we=!0,this.pe=t)}ve(){let t=Qe(),r=Qe(),n=Qe();return this.ge.forEach((s,a)=>{switch(a){case 0:t=t.add(s);break;case 2:r=r.add(s);break;case 1:n=n.add(s);break;default:je()}}),new Lu(this.pe,this.ye,t,r,n)}Ce(){this.we=!1,this.ge=T_()}Fe(t,r){this.we=!0,this.ge=this.ge.insert(t,r)}Me(t){this.we=!0,this.ge=this.ge.remove(t)}xe(){this.fe+=1}Oe(){this.fe-=1,xt(this.fe>=0)}Ne(){this.we=!0,this.ye=!0}}class KF{constructor(t){this.Le=t,this.Be=new Map,this.ke=ya(),this.qe=E_(),this.Qe=new Ut(ut)}Ke(t){for(const r of t.Re)t.Ve&&t.Ve.isFoundDocument()?this.$e(r,t.Ve):this.Ue(r,t.key,t.Ve);for(const r of t.removedTargetIds)this.Ue(r,t.key,t.Ve)}We(t){this.forEachTarget(t,r=>{const n=this.Ge(r);switch(t.state){case 0:this.ze(r)&&n.De(t.resumeToken);break;case 1:n.Oe(),n.Se||n.Ce(),n.De(t.resumeToken);break;case 2:n.Oe(),n.Se||this.removeTarget(r);break;case 3:this.ze(r)&&(n.Ne(),n.De(t.resumeToken));break;case 4:this.ze(r)&&(this.je(r),n.De(t.resumeToken));break;default:je()}})}forEachTarget(t,r){t.targetIds.length>0?t.targetIds.forEach(r):this.Be.forEach((n,s)=>{this.ze(s)&&r(s)})}He(t){const r=t.targetId,n=t.me.count,s=this.Je(r);if(s){const a=s.target;if(kp(a))if(n===0){const i=new Pe(a.path);this.Ue(r,i,Ur.newNoDocument(i,Be.min()))}else xt(n===1);else{const i=this.Ye(r);if(i!==n){const o=this.Ze(t),l=o?this.Xe(o,t,i):1;if(l!==0){this.je(r);const c=l===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Qe=this.Qe.insert(r,c)}}}}}Ze(t){const r=t.me.unchangedNames;if(!r||!r.bits)return null;const{bits:{bitmap:n="",padding:s=0},hashCount:a=0}=r;let i,o;try{i=Qi(n).toUint8Array()}catch(l){if(l instanceof Lk)return fl("Decoding the base64 bloom filter in existence filter failed ("+l.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw l}try{o=new wx(i,s,a)}catch(l){return fl(l instanceof ac?"BloomFilter error: ":"Applying bloom filter failed: ",l),null}return o.Ie===0?null:o}Xe(t,r,n){return r.me.count===n-this.nt(t,r.targetId)?0:2}nt(t,r){const n=this.Le.getRemoteKeysForTarget(r);let s=0;return n.forEach(a=>{const i=this.Le.tt(),o=`projects/${i.projectId}/databases/${i.database}/documents/${a.path.canonicalString()}`;t.mightContain(o)||(this.Ue(r,a,null),s++)}),s}rt(t){const r=new Map;this.Be.forEach((a,i)=>{const o=this.Je(i);if(o){if(a.current&&kp(o.target)){const l=new Pe(o.target.path);this.ke.get(l)!==null||this.it(i,l)||this.Ue(i,l,Ur.newNoDocument(l,t))}a.be&&(r.set(i,a.ve()),a.Ce())}});let n=Qe();this.qe.forEach((a,i)=>{let o=!0;i.forEachWhile(l=>{const c=this.Je(l);return!c||c.purpose==="TargetPurposeLimboResolution"||(o=!1,!1)}),o&&(n=n.add(a))}),this.ke.forEach((a,i)=>i.setReadTime(t));const s=new Kd(t,r,this.Qe,this.ke,n);return this.ke=ya(),this.qe=E_(),this.Qe=new Ut(ut),s}$e(t,r){if(!this.ze(t))return;const n=this.it(t,r.key)?2:0;this.Ge(t).Fe(r.key,n),this.ke=this.ke.insert(r.key,r),this.qe=this.qe.insert(r.key,this.st(r.key).add(t))}Ue(t,r,n){if(!this.ze(t))return;const s=this.Ge(t);this.it(t,r)?s.Fe(r,1):s.Me(r),this.qe=this.qe.insert(r,this.st(r).delete(t)),n&&(this.ke=this.ke.insert(r,n))}removeTarget(t){this.Be.delete(t)}Ye(t){const r=this.Ge(t).ve();return this.Le.getRemoteKeysForTarget(t).size+r.addedDocuments.size-r.removedDocuments.size}xe(t){this.Ge(t).xe()}Ge(t){let r=this.Be.get(t);return r||(r=new w_,this.Be.set(t,r)),r}st(t){let r=this.qe.get(t);return r||(r=new kr(ut),this.qe=this.qe.insert(t,r)),r}ze(t){const r=this.Je(t)!==null;return r||Re("WatchChangeAggregator","Detected inactive target",t),r}Je(t){const r=this.Be.get(t);return r&&r.Se?null:this.Le.ot(t)}je(t){this.Be.set(t,new w_),this.Le.getRemoteKeysForTarget(t).forEach(r=>{this.Ue(t,r,null)})}it(t,r){return this.Le.getRemoteKeysForTarget(t).has(r)}}function E_(){return new Ut(Pe.comparator)}function T_(){return new Ut(Pe.comparator)}const qF={asc:"ASCENDING",desc:"DESCENDING"},YF={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},XF={and:"AND",or:"OR"};class QF{constructor(t,r){this.databaseId=t,this.useProto3Json=r}}function Ip(e,t){return e.useProto3Json||Bd(t)?t:{value:t}}function Qh(e,t){return e.useProto3Json?`${new Date(1e3*t.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+t.nanoseconds).slice(-9)}Z`:{seconds:""+t.seconds,nanos:t.nanoseconds}}function cS(e,t){return e.useProto3Json?t.toBase64():t.toUint8Array()}function JF(e,t){return Qh(e,t.toTimestamp())}function bs(e){return xt(!!e),Be.fromTimestamp(function(r){const n=ui(r);return new lr(n.seconds,n.nanos)}(e))}function Ex(e,t){return Np(e,t).canonicalString()}function Np(e,t){const r=function(s){return new Nt(["projects",s.projectId,"databases",s.database])}(e).child("documents");return t===void 0?r:r.child(t)}function uS(e){const t=Nt.fromString(e);return xt(pS(t)),t}function Cp(e,t){return Ex(e.databaseId,t.path)}function J0(e,t){const r=uS(t);if(r.get(1)!==e.databaseId.projectId)throw new be(ge.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+r.get(1)+" vs "+e.databaseId.projectId);if(r.get(3)!==e.databaseId.database)throw new be(ge.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+r.get(3)+" vs "+e.databaseId.database);return new Pe(hS(r))}function fS(e,t){return Ex(e.databaseId,t)}function ZF(e){const t=uS(e);return t.length===4?Nt.emptyPath():hS(t)}function bp(e){return new Nt(["projects",e.databaseId.projectId,"databases",e.databaseId.database]).canonicalString()}function hS(e){return xt(e.length>4&&e.get(4)==="documents"),e.popFirst(5)}function k_(e,t,r){return{name:Cp(e,t),fields:r.value.mapValue.fields}}function eO(e,t){let r;if("targetChange"in t){t.targetChange;const n=function(c){return c==="NO_CHANGE"?0:c==="ADD"?1:c==="REMOVE"?2:c==="CURRENT"?3:c==="RESET"?4:je()}(t.targetChange.targetChangeType||"NO_CHANGE"),s=t.targetChange.targetIds||[],a=function(c,f){return c.useProto3Json?(xt(f===void 0||typeof f=="string"),Nr.fromBase64String(f||"")):(xt(f===void 0||f instanceof Buffer||f instanceof Uint8Array),Nr.fromUint8Array(f||new Uint8Array))}(e,t.targetChange.resumeToken),i=t.targetChange.cause,o=i&&function(c){const f=c.code===void 0?ge.UNKNOWN:iS(c.code);return new be(f,c.message||"")}(i);r=new lS(n,s,a,o||null)}else if("documentChange"in t){t.documentChange;const n=t.documentChange;n.document,n.document.name,n.document.updateTime;const s=J0(e,n.document.name),a=bs(n.document.updateTime),i=n.document.createTime?bs(n.document.createTime):Be.min(),o=new fn({mapValue:{fields:n.document.fields}}),l=Ur.newFoundDocument(s,a,i,o),c=n.targetIds||[],f=n.removedTargetIds||[];r=new ch(c,f,l.key,l)}else if("documentDelete"in t){t.documentDelete;const n=t.documentDelete;n.document;const s=J0(e,n.document),a=n.readTime?bs(n.readTime):Be.min(),i=Ur.newNoDocument(s,a),o=n.removedTargetIds||[];r=new ch([],o,i.key,i)}else if("documentRemove"in t){t.documentRemove;const n=t.documentRemove;n.document;const s=J0(e,n.document),a=n.removedTargetIds||[];r=new ch([],a,s,null)}else{if(!("filter"in t))return je();{t.filter;const n=t.filter;n.targetId;const{count:s=0,unchangedNames:a}=n,i=new zF(s,a),o=n.targetId;r=new oS(o,i)}}return r}function tO(e,t){let r;if(t instanceof Mu)r={update:k_(e,t.key,t.value)};else if(t instanceof yx)r={delete:Cp(e,t.key)};else if(t instanceof yi)r={update:k_(e,t.key,t.data),updateMask:uO(t.fieldMask)};else{if(!(t instanceof VF))return je();r={verify:Cp(e,t.key)}}return t.fieldTransforms.length>0&&(r.updateTransforms=t.fieldTransforms.map(n=>function(a,i){const o=i.transform;if(o instanceof iu)return{fieldPath:i.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(o instanceof ou)return{fieldPath:i.field.canonicalString(),appendMissingElements:{values:o.elements}};if(o instanceof lu)return{fieldPath:i.field.canonicalString(),removeAllFromArray:{values:o.elements}};if(o instanceof cu)return{fieldPath:i.field.canonicalString(),increment:o.Pe};throw je()}(0,n))),t.precondition.isNone||(r.currentDocument=function(s,a){return a.updateTime!==void 0?{updateTime:JF(s,a.updateTime)}:a.exists!==void 0?{exists:a.exists}:je()}(e,t.precondition)),r}function rO(e,t){return e&&e.length>0?(xt(t!==void 0),e.map(r=>function(s,a){let i=s.updateTime?bs(s.updateTime):bs(a);return i.isEqual(Be.min())&&(i=bs(a)),new LF(i,s.transformResults||[])}(r,t))):[]}function nO(e,t){return{documents:[fS(e,t.path)]}}function sO(e,t){const r={structuredQuery:{}},n=t.path;let s;t.collectionGroup!==null?(s=n,r.structuredQuery.from=[{collectionId:t.collectionGroup,allDescendants:!0}]):(s=n.popLast(),r.structuredQuery.from=[{collectionId:n.lastSegment()}]),r.parent=fS(e,s);const a=function(c){if(c.length!==0)return mS(gs.create(c,"and"))}(t.filters);a&&(r.structuredQuery.where=a);const i=function(c){if(c.length!==0)return c.map(f=>function(m){return{field:So(m.field),direction:oO(m.dir)}}(f))}(t.orderBy);i&&(r.structuredQuery.orderBy=i);const o=Ip(e,t.limit);return o!==null&&(r.structuredQuery.limit=o),t.startAt&&(r.structuredQuery.startAt=function(c){return{before:c.inclusive,values:c.position}}(t.startAt)),t.endAt&&(r.structuredQuery.endAt=function(c){return{before:!c.inclusive,values:c.position}}(t.endAt)),{_t:r,parent:s}}function aO(e){let t=ZF(e.parent);const r=e.structuredQuery,n=r.from?r.from.length:0;let s=null;if(n>0){xt(n===1);const f=r.from[0];f.allDescendants?s=f.collectionId:t=t.child(f.collectionId)}let a=[];r.where&&(a=function(d){const m=dS(d);return m instanceof gs&&Bk(m)?m.getFilters():[m]}(r.where));let i=[];r.orderBy&&(i=function(d){return d.map(m=>function(x){return new Xh(Ao(x.field),function(w){switch(w){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(x.direction))}(m))}(r.orderBy));let o=null;r.limit&&(o=function(d){let m;return m=typeof d=="object"?d.value:d,Bd(m)?null:m}(r.limit));let l=null;r.startAt&&(l=function(d){const m=!!d.before,p=d.values||[];return new Yh(p,m)}(r.startAt));let c=null;return r.endAt&&(c=function(d){const m=!d.before,p=d.values||[];return new Yh(p,m)}(r.endAt)),SF(t,s,i,a,o,"F",l,c)}function iO(e,t){const r=function(s){switch(s){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return je()}}(t.purpose);return r==null?null:{"goog-listen-tags":r}}function dS(e){return e.unaryFilter!==void 0?function(r){switch(r.unaryFilter.op){case"IS_NAN":const n=Ao(r.unaryFilter.field);return rr.create(n,"==",{doubleValue:NaN});case"IS_NULL":const s=Ao(r.unaryFilter.field);return rr.create(s,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const a=Ao(r.unaryFilter.field);return rr.create(a,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const i=Ao(r.unaryFilter.field);return rr.create(i,"!=",{nullValue:"NULL_VALUE"});default:return je()}}(e):e.fieldFilter!==void 0?function(r){return rr.create(Ao(r.fieldFilter.field),function(s){switch(s){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return je()}}(r.fieldFilter.op),r.fieldFilter.value)}(e):e.compositeFilter!==void 0?function(r){return gs.create(r.compositeFilter.filters.map(n=>dS(n)),function(s){switch(s){case"AND":return"and";case"OR":return"or";default:return je()}}(r.compositeFilter.op))}(e):je()}function oO(e){return qF[e]}function lO(e){return YF[e]}function cO(e){return XF[e]}function So(e){return{fieldPath:e.canonicalString()}}function Ao(e){return Er.fromServerFormat(e.fieldPath)}function mS(e){return e instanceof rr?function(r){if(r.op==="=="){if(u_(r.value))return{unaryFilter:{field:So(r.field),op:"IS_NAN"}};if(c_(r.value))return{unaryFilter:{field:So(r.field),op:"IS_NULL"}}}else if(r.op==="!="){if(u_(r.value))return{unaryFilter:{field:So(r.field),op:"IS_NOT_NAN"}};if(c_(r.value))return{unaryFilter:{field:So(r.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:So(r.field),op:lO(r.op),value:r.value}}}(e):e instanceof gs?function(r){const n=r.getFilters().map(s=>mS(s));return n.length===1?n[0]:{compositeFilter:{op:cO(r.op),filters:n}}}(e):je()}function uO(e){const t=[];return e.fields.forEach(r=>t.push(r.canonicalString())),{fieldPaths:t}}function pS(e){return e.length>=4&&e.get(0)==="projects"&&e.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $a{constructor(t,r,n,s,a=Be.min(),i=Be.min(),o=Nr.EMPTY_BYTE_STRING,l=null){this.target=t,this.targetId=r,this.purpose=n,this.sequenceNumber=s,this.snapshotVersion=a,this.lastLimboFreeSnapshotVersion=i,this.resumeToken=o,this.expectedCount=l}withSequenceNumber(t){return new $a(this.target,this.targetId,this.purpose,t,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(t,r){return new $a(this.target,this.targetId,this.purpose,this.sequenceNumber,r,this.lastLimboFreeSnapshotVersion,t,null)}withExpectedCount(t){return new $a(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,t)}withLastLimboFreeSnapshotVersion(t){return new $a(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,t,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fO{constructor(t){this.ct=t}}function hO(e){const t=aO({parent:e.parent,structuredQuery:e.structuredQuery});return e.limitType==="LAST"?Ap(t,t.limit,"L"):t}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dO{constructor(){this.un=new mO}addToCollectionParentIndex(t,r){return this.un.add(r),ye.resolve()}getCollectionParents(t,r){return ye.resolve(this.un.getEntries(r))}addFieldIndex(t,r){return ye.resolve()}deleteFieldIndex(t,r){return ye.resolve()}deleteAllFieldIndexes(t){return ye.resolve()}createTargetIndexes(t,r){return ye.resolve()}getDocumentsMatchingTarget(t,r){return ye.resolve(null)}getIndexType(t,r){return ye.resolve(0)}getFieldIndexes(t,r){return ye.resolve([])}getNextCollectionGroupToUpdate(t){return ye.resolve(null)}getMinOffset(t,r){return ye.resolve(ci.min())}getMinOffsetFromCollectionGroup(t,r){return ye.resolve(ci.min())}updateCollectionGroup(t,r,n){return ye.resolve()}updateIndexEntries(t,r){return ye.resolve()}}class mO{constructor(){this.index={}}add(t){const r=t.lastSegment(),n=t.popLast(),s=this.index[r]||new kr(Nt.comparator),a=!s.has(n);return this.index[r]=s.add(n),a}has(t){const r=t.lastSegment(),n=t.popLast(),s=this.index[r];return s&&s.has(n)}getEntries(t){return(this.index[t]||new kr(Nt.comparator)).toArray()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pl{constructor(t){this.Ln=t}next(){return this.Ln+=2,this.Ln}static Bn(){return new pl(0)}static kn(){return new pl(-1)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pO{constructor(){this.changes=new Al(t=>t.toString(),(t,r)=>t.isEqual(r)),this.changesApplied=!1}addEntry(t){this.assertNotApplied(),this.changes.set(t.key,t)}removeEntry(t,r){this.assertNotApplied(),this.changes.set(t,Ur.newInvalidDocument(t).setReadTime(r))}getEntry(t,r){this.assertNotApplied();const n=this.changes.get(r);return n!==void 0?ye.resolve(n):this.getFromCache(t,r)}getEntries(t,r){return this.getAllFromCache(t,r)}apply(t){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(t)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gO{constructor(t,r){this.overlayedDocument=t,this.mutatedFields=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xO{constructor(t,r,n,s){this.remoteDocumentCache=t,this.mutationQueue=r,this.documentOverlayCache=n,this.indexManager=s}getDocument(t,r){let n=null;return this.documentOverlayCache.getOverlay(t,r).next(s=>(n=s,this.remoteDocumentCache.getEntry(t,r))).next(s=>(n!==null&&kc(n.mutation,s,Sn.empty(),lr.now()),s))}getDocuments(t,r){return this.remoteDocumentCache.getEntries(t,r).next(n=>this.getLocalViewOfDocuments(t,n,Qe()).next(()=>n))}getLocalViewOfDocuments(t,r,n=Qe()){const s=Fi();return this.populateOverlays(t,s,r).next(()=>this.computeViews(t,r,s,n).next(a=>{let i=sc();return a.forEach((o,l)=>{i=i.insert(o,l.overlayedDocument)}),i}))}getOverlayedDocuments(t,r){const n=Fi();return this.populateOverlays(t,n,r).next(()=>this.computeViews(t,r,n,Qe()))}populateOverlays(t,r,n){const s=[];return n.forEach(a=>{r.has(a)||s.push(a)}),this.documentOverlayCache.getOverlays(t,s).next(a=>{a.forEach((i,o)=>{r.set(i,o)})})}computeViews(t,r,n,s){let a=ya();const i=Tc(),o=function(){return Tc()}();return r.forEach((l,c)=>{const f=n.get(c.key);s.has(c.key)&&(f===void 0||f.mutation instanceof yi)?a=a.insert(c.key,c):f!==void 0?(i.set(c.key,f.mutation.getFieldMask()),kc(f.mutation,c,f.mutation.getFieldMask(),lr.now())):i.set(c.key,Sn.empty())}),this.recalculateAndSaveOverlays(t,a).next(l=>(l.forEach((c,f)=>i.set(c,f)),r.forEach((c,f)=>{var d;return o.set(c,new gO(f,(d=i.get(c))!==null&&d!==void 0?d:null))}),o))}recalculateAndSaveOverlays(t,r){const n=Tc();let s=new Ut((i,o)=>i-o),a=Qe();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(t,r).next(i=>{for(const o of i)o.keys().forEach(l=>{const c=r.get(l);if(c===null)return;let f=n.get(l)||Sn.empty();f=o.applyToLocalView(c,f),n.set(l,f);const d=(s.get(o.batchId)||Qe()).add(l);s=s.insert(o.batchId,d)})}).next(()=>{const i=[],o=s.getReverseIterator();for(;o.hasNext();){const l=o.getNext(),c=l.key,f=l.value,d=Xk();f.forEach(m=>{if(!a.has(m)){const p=sS(r.get(m),n.get(m));p!==null&&d.set(m,p),a=a.add(m)}}),i.push(this.documentOverlayCache.saveOverlays(t,c,d))}return ye.waitFor(i)}).next(()=>n)}recalculateAndSaveOverlaysForDocumentKeys(t,r){return this.remoteDocumentCache.getEntries(t,r).next(n=>this.recalculateAndSaveOverlays(t,n))}getDocumentsMatchingQuery(t,r,n,s){return function(i){return Pe.isDocumentKey(i.path)&&i.collectionGroup===null&&i.filters.length===0}(r)?this.getDocumentsMatchingDocumentQuery(t,r.path):Hk(r)?this.getDocumentsMatchingCollectionGroupQuery(t,r,n,s):this.getDocumentsMatchingCollectionQuery(t,r,n,s)}getNextDocuments(t,r,n,s){return this.remoteDocumentCache.getAllFromCollectionGroup(t,r,n,s).next(a=>{const i=s-a.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(t,r,n.largestBatchId,s-a.size):ye.resolve(Fi());let o=-1,l=a;return i.next(c=>ye.forEach(c,(f,d)=>(o<d.largestBatchId&&(o=d.largestBatchId),a.get(f)?ye.resolve():this.remoteDocumentCache.getEntry(t,f).next(m=>{l=l.insert(f,m)}))).next(()=>this.populateOverlays(t,c,a)).next(()=>this.computeViews(t,l,c,Qe())).next(f=>({batchId:o,changes:Yk(f)})))})}getDocumentsMatchingDocumentQuery(t,r){return this.getDocument(t,new Pe(r)).next(n=>{let s=sc();return n.isFoundDocument()&&(s=s.insert(n.key,n)),s})}getDocumentsMatchingCollectionGroupQuery(t,r,n,s){const a=r.collectionGroup;let i=sc();return this.indexManager.getCollectionParents(t,a).next(o=>ye.forEach(o,l=>{const c=function(d,m){return new Ou(m,null,d.explicitOrderBy.slice(),d.filters.slice(),d.limit,d.limitType,d.startAt,d.endAt)}(r,l.child(a));return this.getDocumentsMatchingCollectionQuery(t,c,n,s).next(f=>{f.forEach((d,m)=>{i=i.insert(d,m)})})}).next(()=>i))}getDocumentsMatchingCollectionQuery(t,r,n,s){let a;return this.documentOverlayCache.getOverlaysForCollection(t,r.path,n.largestBatchId).next(i=>(a=i,this.remoteDocumentCache.getDocumentsMatchingQuery(t,r,n,a,s))).next(i=>{a.forEach((l,c)=>{const f=c.getKey();i.get(f)===null&&(i=i.insert(f,Ur.newInvalidDocument(f)))});let o=sc();return i.forEach((l,c)=>{const f=a.get(l);f!==void 0&&kc(f.mutation,c,Sn.empty(),lr.now()),$d(r,c)&&(o=o.insert(l,c))}),o})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vO{constructor(t){this.serializer=t,this.hr=new Map,this.Pr=new Map}getBundleMetadata(t,r){return ye.resolve(this.hr.get(r))}saveBundleMetadata(t,r){return this.hr.set(r.id,function(s){return{id:s.id,version:s.version,createTime:bs(s.createTime)}}(r)),ye.resolve()}getNamedQuery(t,r){return ye.resolve(this.Pr.get(r))}saveNamedQuery(t,r){return this.Pr.set(r.name,function(s){return{name:s.name,query:hO(s.bundledQuery),readTime:bs(s.readTime)}}(r)),ye.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yO{constructor(){this.overlays=new Ut(Pe.comparator),this.Ir=new Map}getOverlay(t,r){return ye.resolve(this.overlays.get(r))}getOverlays(t,r){const n=Fi();return ye.forEach(r,s=>this.getOverlay(t,s).next(a=>{a!==null&&n.set(s,a)})).next(()=>n)}saveOverlays(t,r,n){return n.forEach((s,a)=>{this.ht(t,r,a)}),ye.resolve()}removeOverlaysForBatchId(t,r,n){const s=this.Ir.get(n);return s!==void 0&&(s.forEach(a=>this.overlays=this.overlays.remove(a)),this.Ir.delete(n)),ye.resolve()}getOverlaysForCollection(t,r,n){const s=Fi(),a=r.length+1,i=new Pe(r.child("")),o=this.overlays.getIteratorFrom(i);for(;o.hasNext();){const l=o.getNext().value,c=l.getKey();if(!r.isPrefixOf(c.path))break;c.path.length===a&&l.largestBatchId>n&&s.set(l.getKey(),l)}return ye.resolve(s)}getOverlaysForCollectionGroup(t,r,n,s){let a=new Ut((c,f)=>c-f);const i=this.overlays.getIterator();for(;i.hasNext();){const c=i.getNext().value;if(c.getKey().getCollectionGroup()===r&&c.largestBatchId>n){let f=a.get(c.largestBatchId);f===null&&(f=Fi(),a=a.insert(c.largestBatchId,f)),f.set(c.getKey(),c)}}const o=Fi(),l=a.getIterator();for(;l.hasNext()&&(l.getNext().value.forEach((c,f)=>o.set(c,f)),!(o.size()>=s)););return ye.resolve(o)}ht(t,r,n){const s=this.overlays.get(n.key);if(s!==null){const i=this.Ir.get(s.largestBatchId).delete(n.key);this.Ir.set(s.largestBatchId,i)}this.overlays=this.overlays.insert(n.key,new WF(r,n));let a=this.Ir.get(r);a===void 0&&(a=Qe(),this.Ir.set(r,a)),this.Ir.set(r,a.add(n.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _O{constructor(){this.sessionToken=Nr.EMPTY_BYTE_STRING}getSessionToken(t){return ye.resolve(this.sessionToken)}setSessionToken(t,r){return this.sessionToken=r,ye.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tx{constructor(){this.Tr=new kr(hr.Er),this.dr=new kr(hr.Ar)}isEmpty(){return this.Tr.isEmpty()}addReference(t,r){const n=new hr(t,r);this.Tr=this.Tr.add(n),this.dr=this.dr.add(n)}Rr(t,r){t.forEach(n=>this.addReference(n,r))}removeReference(t,r){this.Vr(new hr(t,r))}mr(t,r){t.forEach(n=>this.removeReference(n,r))}gr(t){const r=new Pe(new Nt([])),n=new hr(r,t),s=new hr(r,t+1),a=[];return this.dr.forEachInRange([n,s],i=>{this.Vr(i),a.push(i.key)}),a}pr(){this.Tr.forEach(t=>this.Vr(t))}Vr(t){this.Tr=this.Tr.delete(t),this.dr=this.dr.delete(t)}yr(t){const r=new Pe(new Nt([])),n=new hr(r,t),s=new hr(r,t+1);let a=Qe();return this.dr.forEachInRange([n,s],i=>{a=a.add(i.key)}),a}containsKey(t){const r=new hr(t,0),n=this.Tr.firstAfterOrEqual(r);return n!==null&&t.isEqual(n.key)}}class hr{constructor(t,r){this.key=t,this.wr=r}static Er(t,r){return Pe.comparator(t.key,r.key)||ut(t.wr,r.wr)}static Ar(t,r){return ut(t.wr,r.wr)||Pe.comparator(t.key,r.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wO{constructor(t,r){this.indexManager=t,this.referenceDelegate=r,this.mutationQueue=[],this.Sr=1,this.br=new kr(hr.Er)}checkEmpty(t){return ye.resolve(this.mutationQueue.length===0)}addMutationBatch(t,r,n,s){const a=this.Sr;this.Sr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const i=new BF(a,r,n,s);this.mutationQueue.push(i);for(const o of s)this.br=this.br.add(new hr(o.key,a)),this.indexManager.addToCollectionParentIndex(t,o.key.path.popLast());return ye.resolve(i)}lookupMutationBatch(t,r){return ye.resolve(this.Dr(r))}getNextMutationBatchAfterBatchId(t,r){const n=r+1,s=this.vr(n),a=s<0?0:s;return ye.resolve(this.mutationQueue.length>a?this.mutationQueue[a]:null)}getHighestUnacknowledgedBatchId(){return ye.resolve(this.mutationQueue.length===0?-1:this.Sr-1)}getAllMutationBatches(t){return ye.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(t,r){const n=new hr(r,0),s=new hr(r,Number.POSITIVE_INFINITY),a=[];return this.br.forEachInRange([n,s],i=>{const o=this.Dr(i.wr);a.push(o)}),ye.resolve(a)}getAllMutationBatchesAffectingDocumentKeys(t,r){let n=new kr(ut);return r.forEach(s=>{const a=new hr(s,0),i=new hr(s,Number.POSITIVE_INFINITY);this.br.forEachInRange([a,i],o=>{n=n.add(o.wr)})}),ye.resolve(this.Cr(n))}getAllMutationBatchesAffectingQuery(t,r){const n=r.path,s=n.length+1;let a=n;Pe.isDocumentKey(a)||(a=a.child(""));const i=new hr(new Pe(a),0);let o=new kr(ut);return this.br.forEachWhile(l=>{const c=l.key.path;return!!n.isPrefixOf(c)&&(c.length===s&&(o=o.add(l.wr)),!0)},i),ye.resolve(this.Cr(o))}Cr(t){const r=[];return t.forEach(n=>{const s=this.Dr(n);s!==null&&r.push(s)}),r}removeMutationBatch(t,r){xt(this.Fr(r.batchId,"removed")===0),this.mutationQueue.shift();let n=this.br;return ye.forEach(r.mutations,s=>{const a=new hr(s.key,r.batchId);return n=n.delete(a),this.referenceDelegate.markPotentiallyOrphaned(t,s.key)}).next(()=>{this.br=n})}On(t){}containsKey(t,r){const n=new hr(r,0),s=this.br.firstAfterOrEqual(n);return ye.resolve(r.isEqual(s&&s.key))}performConsistencyCheck(t){return this.mutationQueue.length,ye.resolve()}Fr(t,r){return this.vr(t)}vr(t){return this.mutationQueue.length===0?0:t-this.mutationQueue[0].batchId}Dr(t){const r=this.vr(t);return r<0||r>=this.mutationQueue.length?null:this.mutationQueue[r]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class EO{constructor(t){this.Mr=t,this.docs=function(){return new Ut(Pe.comparator)}(),this.size=0}setIndexManager(t){this.indexManager=t}addEntry(t,r){const n=r.key,s=this.docs.get(n),a=s?s.size:0,i=this.Mr(r);return this.docs=this.docs.insert(n,{document:r.mutableCopy(),size:i}),this.size+=i-a,this.indexManager.addToCollectionParentIndex(t,n.path.popLast())}removeEntry(t){const r=this.docs.get(t);r&&(this.docs=this.docs.remove(t),this.size-=r.size)}getEntry(t,r){const n=this.docs.get(r);return ye.resolve(n?n.document.mutableCopy():Ur.newInvalidDocument(r))}getEntries(t,r){let n=ya();return r.forEach(s=>{const a=this.docs.get(s);n=n.insert(s,a?a.document.mutableCopy():Ur.newInvalidDocument(s))}),ye.resolve(n)}getDocumentsMatchingQuery(t,r,n,s){let a=ya();const i=r.path,o=new Pe(i.child("")),l=this.docs.getIteratorFrom(o);for(;l.hasNext();){const{key:c,value:{document:f}}=l.getNext();if(!i.isPrefixOf(c.path))break;c.path.length>i.length+1||iF(aF(f),n)<=0||(s.has(f.key)||$d(r,f))&&(a=a.insert(f.key,f.mutableCopy()))}return ye.resolve(a)}getAllFromCollectionGroup(t,r,n,s){je()}Or(t,r){return ye.forEach(this.docs,n=>r(n))}newChangeBuffer(t){return new TO(this)}getSize(t){return ye.resolve(this.size)}}class TO extends pO{constructor(t){super(),this.cr=t}applyChanges(t){const r=[];return this.changes.forEach((n,s)=>{s.isValidDocument()?r.push(this.cr.addEntry(t,s)):this.cr.removeEntry(n)}),ye.waitFor(r)}getFromCache(t,r){return this.cr.getEntry(t,r)}getAllFromCache(t,r){return this.cr.getEntries(t,r)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kO{constructor(t){this.persistence=t,this.Nr=new Al(r=>gx(r),xx),this.lastRemoteSnapshotVersion=Be.min(),this.highestTargetId=0,this.Lr=0,this.Br=new Tx,this.targetCount=0,this.kr=pl.Bn()}forEachTarget(t,r){return this.Nr.forEach((n,s)=>r(s)),ye.resolve()}getLastRemoteSnapshotVersion(t){return ye.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(t){return ye.resolve(this.Lr)}allocateTargetId(t){return this.highestTargetId=this.kr.next(),ye.resolve(this.highestTargetId)}setTargetsMetadata(t,r,n){return n&&(this.lastRemoteSnapshotVersion=n),r>this.Lr&&(this.Lr=r),ye.resolve()}Kn(t){this.Nr.set(t.target,t);const r=t.targetId;r>this.highestTargetId&&(this.kr=new pl(r),this.highestTargetId=r),t.sequenceNumber>this.Lr&&(this.Lr=t.sequenceNumber)}addTargetData(t,r){return this.Kn(r),this.targetCount+=1,ye.resolve()}updateTargetData(t,r){return this.Kn(r),ye.resolve()}removeTargetData(t,r){return this.Nr.delete(r.target),this.Br.gr(r.targetId),this.targetCount-=1,ye.resolve()}removeTargets(t,r,n){let s=0;const a=[];return this.Nr.forEach((i,o)=>{o.sequenceNumber<=r&&n.get(o.targetId)===null&&(this.Nr.delete(i),a.push(this.removeMatchingKeysForTargetId(t,o.targetId)),s++)}),ye.waitFor(a).next(()=>s)}getTargetCount(t){return ye.resolve(this.targetCount)}getTargetData(t,r){const n=this.Nr.get(r)||null;return ye.resolve(n)}addMatchingKeys(t,r,n){return this.Br.Rr(r,n),ye.resolve()}removeMatchingKeys(t,r,n){this.Br.mr(r,n);const s=this.persistence.referenceDelegate,a=[];return s&&r.forEach(i=>{a.push(s.markPotentiallyOrphaned(t,i))}),ye.waitFor(a)}removeMatchingKeysForTargetId(t,r){return this.Br.gr(r),ye.resolve()}getMatchingKeysForTargetId(t,r){const n=this.Br.yr(r);return ye.resolve(n)}containsKey(t,r){return ye.resolve(this.Br.containsKey(r))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SO{constructor(t,r){this.qr={},this.overlays={},this.Qr=new hx(0),this.Kr=!1,this.Kr=!0,this.$r=new _O,this.referenceDelegate=t(this),this.Ur=new kO(this),this.indexManager=new dO,this.remoteDocumentCache=function(s){return new EO(s)}(n=>this.referenceDelegate.Wr(n)),this.serializer=new fO(r),this.Gr=new vO(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.Kr=!1,Promise.resolve()}get started(){return this.Kr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(t){return this.indexManager}getDocumentOverlayCache(t){let r=this.overlays[t.toKey()];return r||(r=new yO,this.overlays[t.toKey()]=r),r}getMutationQueue(t,r){let n=this.qr[t.toKey()];return n||(n=new wO(r,this.referenceDelegate),this.qr[t.toKey()]=n),n}getGlobalsCache(){return this.$r}getTargetCache(){return this.Ur}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Gr}runTransaction(t,r,n){Re("MemoryPersistence","Starting transaction:",t);const s=new AO(this.Qr.next());return this.referenceDelegate.zr(),n(s).next(a=>this.referenceDelegate.jr(s).next(()=>a)).toPromise().then(a=>(s.raiseOnCommittedEvent(),a))}Hr(t,r){return ye.or(Object.values(this.qr).map(n=>()=>n.containsKey(t,r)))}}class AO extends lF{constructor(t){super(),this.currentSequenceNumber=t}}class kx{constructor(t){this.persistence=t,this.Jr=new Tx,this.Yr=null}static Zr(t){return new kx(t)}get Xr(){if(this.Yr)return this.Yr;throw je()}addReference(t,r,n){return this.Jr.addReference(n,r),this.Xr.delete(n.toString()),ye.resolve()}removeReference(t,r,n){return this.Jr.removeReference(n,r),this.Xr.add(n.toString()),ye.resolve()}markPotentiallyOrphaned(t,r){return this.Xr.add(r.toString()),ye.resolve()}removeTarget(t,r){this.Jr.gr(r.targetId).forEach(s=>this.Xr.add(s.toString()));const n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(t,r.targetId).next(s=>{s.forEach(a=>this.Xr.add(a.toString()))}).next(()=>n.removeTargetData(t,r))}zr(){this.Yr=new Set}jr(t){const r=this.persistence.getRemoteDocumentCache().newChangeBuffer();return ye.forEach(this.Xr,n=>{const s=Pe.fromPath(n);return this.ei(t,s).next(a=>{a||r.removeEntry(s,Be.min())})}).next(()=>(this.Yr=null,r.apply(t)))}updateLimboDocument(t,r){return this.ei(t,r).next(n=>{n?this.Xr.delete(r.toString()):this.Xr.add(r.toString())})}Wr(t){return 0}ei(t,r){return ye.or([()=>ye.resolve(this.Jr.containsKey(r)),()=>this.persistence.getTargetCache().containsKey(t,r),()=>this.persistence.Hr(t,r)])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sx{constructor(t,r,n,s){this.targetId=t,this.fromCache=r,this.$i=n,this.Ui=s}static Wi(t,r){let n=Qe(),s=Qe();for(const a of r.docChanges)switch(a.type){case 0:n=n.add(a.doc.key);break;case 1:s=s.add(a.doc.key)}return new Sx(t,r.fromCache,n,s)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class IO{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(t){this._documentReadCount+=t}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class NO{constructor(){this.Gi=!1,this.zi=!1,this.ji=100,this.Hi=function(){return O4()?8:cF(Hr())>0?6:4}()}initialize(t,r){this.Ji=t,this.indexManager=r,this.Gi=!0}getDocumentsMatchingQuery(t,r,n,s){const a={result:null};return this.Yi(t,r).next(i=>{a.result=i}).next(()=>{if(!a.result)return this.Zi(t,r,s,n).next(i=>{a.result=i})}).next(()=>{if(a.result)return;const i=new IO;return this.Xi(t,r,i).next(o=>{if(a.result=o,this.zi)return this.es(t,r,i,o.size)})}).next(()=>a.result)}es(t,r,n,s){return n.documentReadCount<this.ji?(Ql()<=Ze.DEBUG&&Re("QueryEngine","SDK will not create cache indexes for query:",ko(r),"since it only creates cache indexes for collection contains","more than or equal to",this.ji,"documents"),ye.resolve()):(Ql()<=Ze.DEBUG&&Re("QueryEngine","Query:",ko(r),"scans",n.documentReadCount,"local documents and returns",s,"documents as results."),n.documentReadCount>this.Hi*s?(Ql()<=Ze.DEBUG&&Re("QueryEngine","The SDK decides to create cache indexes for query:",ko(r),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(t,Cs(r))):ye.resolve())}Yi(t,r){if(m_(r))return ye.resolve(null);let n=Cs(r);return this.indexManager.getIndexType(t,n).next(s=>s===0?null:(r.limit!==null&&s===1&&(r=Ap(r,null,"F"),n=Cs(r)),this.indexManager.getDocumentsMatchingTarget(t,n).next(a=>{const i=Qe(...a);return this.Ji.getDocuments(t,i).next(o=>this.indexManager.getMinOffset(t,n).next(l=>{const c=this.ts(r,o);return this.ns(r,c,i,l.readTime)?this.Yi(t,Ap(r,null,"F")):this.rs(t,c,r,l)}))})))}Zi(t,r,n,s){return m_(r)||s.isEqual(Be.min())?ye.resolve(null):this.Ji.getDocuments(t,n).next(a=>{const i=this.ts(r,a);return this.ns(r,i,n,s)?ye.resolve(null):(Ql()<=Ze.DEBUG&&Re("QueryEngine","Re-using previous result from %s to execute query: %s",s.toString(),ko(r)),this.rs(t,i,r,sF(s,-1)).next(o=>o))})}ts(t,r){let n=new kr(Kk(t));return r.forEach((s,a)=>{$d(t,a)&&(n=n.add(a))}),n}ns(t,r,n,s){if(t.limit===null)return!1;if(n.size!==r.size)return!0;const a=t.limitType==="F"?r.last():r.first();return!!a&&(a.hasPendingWrites||a.version.compareTo(s)>0)}Xi(t,r,n){return Ql()<=Ze.DEBUG&&Re("QueryEngine","Using full collection scan to execute query:",ko(r)),this.Ji.getDocumentsMatchingQuery(t,r,ci.min(),n)}rs(t,r,n,s){return this.Ji.getDocumentsMatchingQuery(t,n,s).next(a=>(r.forEach(i=>{a=a.insert(i.key,i)}),a))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class CO{constructor(t,r,n,s){this.persistence=t,this.ss=r,this.serializer=s,this.os=new Ut(ut),this._s=new Al(a=>gx(a),xx),this.us=new Map,this.cs=t.getRemoteDocumentCache(),this.Ur=t.getTargetCache(),this.Gr=t.getBundleCache(),this.ls(n)}ls(t){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(t),this.indexManager=this.persistence.getIndexManager(t),this.mutationQueue=this.persistence.getMutationQueue(t,this.indexManager),this.localDocuments=new xO(this.cs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.cs.setIndexManager(this.indexManager),this.ss.initialize(this.localDocuments,this.indexManager)}collectGarbage(t){return this.persistence.runTransaction("Collect garbage","readwrite-primary",r=>t.collect(r,this.os))}}function bO(e,t,r,n){return new CO(e,t,r,n)}async function gS(e,t){const r=ze(e);return await r.persistence.runTransaction("Handle user change","readonly",n=>{let s;return r.mutationQueue.getAllMutationBatches(n).next(a=>(s=a,r.ls(t),r.mutationQueue.getAllMutationBatches(n))).next(a=>{const i=[],o=[];let l=Qe();for(const c of s){i.push(c.batchId);for(const f of c.mutations)l=l.add(f.key)}for(const c of a){o.push(c.batchId);for(const f of c.mutations)l=l.add(f.key)}return r.localDocuments.getDocuments(n,l).next(c=>({hs:c,removedBatchIds:i,addedBatchIds:o}))})})}function RO(e,t){const r=ze(e);return r.persistence.runTransaction("Acknowledge batch","readwrite-primary",n=>{const s=t.batch.keys(),a=r.cs.newChangeBuffer({trackRemovals:!0});return function(o,l,c,f){const d=c.batch,m=d.keys();let p=ye.resolve();return m.forEach(x=>{p=p.next(()=>f.getEntry(l,x)).next(g=>{const w=c.docVersions.get(x);xt(w!==null),g.version.compareTo(w)<0&&(d.applyToRemoteDocument(g,c),g.isValidDocument()&&(g.setReadTime(c.commitVersion),f.addEntry(g)))})}),p.next(()=>o.mutationQueue.removeMutationBatch(l,d))}(r,n,t,a).next(()=>a.apply(n)).next(()=>r.mutationQueue.performConsistencyCheck(n)).next(()=>r.documentOverlayCache.removeOverlaysForBatchId(n,s,t.batch.batchId)).next(()=>r.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(n,function(o){let l=Qe();for(let c=0;c<o.mutationResults.length;++c)o.mutationResults[c].transformResults.length>0&&(l=l.add(o.batch.mutations[c].key));return l}(t))).next(()=>r.localDocuments.getDocuments(n,s))})}function xS(e){const t=ze(e);return t.persistence.runTransaction("Get last remote snapshot version","readonly",r=>t.Ur.getLastRemoteSnapshotVersion(r))}function PO(e,t){const r=ze(e),n=t.snapshotVersion;let s=r.os;return r.persistence.runTransaction("Apply remote event","readwrite-primary",a=>{const i=r.cs.newChangeBuffer({trackRemovals:!0});s=r.os;const o=[];t.targetChanges.forEach((f,d)=>{const m=s.get(d);if(!m)return;o.push(r.Ur.removeMatchingKeys(a,f.removedDocuments,d).next(()=>r.Ur.addMatchingKeys(a,f.addedDocuments,d)));let p=m.withSequenceNumber(a.currentSequenceNumber);t.targetMismatches.get(d)!==null?p=p.withResumeToken(Nr.EMPTY_BYTE_STRING,Be.min()).withLastLimboFreeSnapshotVersion(Be.min()):f.resumeToken.approximateByteSize()>0&&(p=p.withResumeToken(f.resumeToken,n)),s=s.insert(d,p),function(g,w,k){return g.resumeToken.approximateByteSize()===0||w.snapshotVersion.toMicroseconds()-g.snapshotVersion.toMicroseconds()>=3e8?!0:k.addedDocuments.size+k.modifiedDocuments.size+k.removedDocuments.size>0}(m,p,f)&&o.push(r.Ur.updateTargetData(a,p))});let l=ya(),c=Qe();if(t.documentUpdates.forEach(f=>{t.resolvedLimboDocuments.has(f)&&o.push(r.persistence.referenceDelegate.updateLimboDocument(a,f))}),o.push(DO(a,i,t.documentUpdates).next(f=>{l=f.Ps,c=f.Is})),!n.isEqual(Be.min())){const f=r.Ur.getLastRemoteSnapshotVersion(a).next(d=>r.Ur.setTargetsMetadata(a,a.currentSequenceNumber,n));o.push(f)}return ye.waitFor(o).next(()=>i.apply(a)).next(()=>r.localDocuments.getLocalViewOfDocuments(a,l,c)).next(()=>l)}).then(a=>(r.os=s,a))}function DO(e,t,r){let n=Qe(),s=Qe();return r.forEach(a=>n=n.add(a)),t.getEntries(e,n).next(a=>{let i=ya();return r.forEach((o,l)=>{const c=a.get(o);l.isFoundDocument()!==c.isFoundDocument()&&(s=s.add(o)),l.isNoDocument()&&l.version.isEqual(Be.min())?(t.removeEntry(o,l.readTime),i=i.insert(o,l)):!c.isValidDocument()||l.version.compareTo(c.version)>0||l.version.compareTo(c.version)===0&&c.hasPendingWrites?(t.addEntry(l),i=i.insert(o,l)):Re("LocalStore","Ignoring outdated watch update for ",o,". Current version:",c.version," Watch version:",l.version)}),{Ps:i,Is:s}})}function FO(e,t){const r=ze(e);return r.persistence.runTransaction("Get next mutation batch","readonly",n=>(t===void 0&&(t=-1),r.mutationQueue.getNextMutationBatchAfterBatchId(n,t)))}function OO(e,t){const r=ze(e);return r.persistence.runTransaction("Allocate target","readwrite",n=>{let s;return r.Ur.getTargetData(n,t).next(a=>a?(s=a,ye.resolve(s)):r.Ur.allocateTargetId(n).next(i=>(s=new $a(t,i,"TargetPurposeListen",n.currentSequenceNumber),r.Ur.addTargetData(n,s).next(()=>s))))}).then(n=>{const s=r.os.get(n.targetId);return(s===null||n.snapshotVersion.compareTo(s.snapshotVersion)>0)&&(r.os=r.os.insert(n.targetId,n),r._s.set(t,n.targetId)),n})}async function Rp(e,t,r){const n=ze(e),s=n.os.get(t),a=r?"readwrite":"readwrite-primary";try{r||await n.persistence.runTransaction("Release target",a,i=>n.persistence.referenceDelegate.removeTarget(i,s))}catch(i){if(!Fu(i))throw i;Re("LocalStore",`Failed to update sequence numbers for target ${t}: ${i}`)}n.os=n.os.remove(t),n._s.delete(s.target)}function S_(e,t,r){const n=ze(e);let s=Be.min(),a=Qe();return n.persistence.runTransaction("Execute query","readwrite",i=>function(l,c,f){const d=ze(l),m=d._s.get(f);return m!==void 0?ye.resolve(d.os.get(m)):d.Ur.getTargetData(c,f)}(n,i,Cs(t)).next(o=>{if(o)return s=o.lastLimboFreeSnapshotVersion,n.Ur.getMatchingKeysForTargetId(i,o.targetId).next(l=>{a=l})}).next(()=>n.ss.getDocumentsMatchingQuery(i,t,r?s:Be.min(),r?a:Qe())).next(o=>(MO(n,IF(t),o),{documents:o,Ts:a})))}function MO(e,t,r){let n=e.us.get(t)||Be.min();r.forEach((s,a)=>{a.readTime.compareTo(n)>0&&(n=a.readTime)}),e.us.set(t,n)}class A_{constructor(){this.activeTargetIds=DF()}fs(t){this.activeTargetIds=this.activeTargetIds.add(t)}gs(t){this.activeTargetIds=this.activeTargetIds.delete(t)}Vs(){const t={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(t)}}class LO{constructor(){this.so=new A_,this.oo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(t){}updateMutationState(t,r,n){}addLocalQueryTarget(t,r=!0){return r&&this.so.fs(t),this.oo[t]||"not-current"}updateQueryState(t,r,n){this.oo[t]=r}removeLocalQueryTarget(t){this.so.gs(t)}isLocalQueryTarget(t){return this.so.activeTargetIds.has(t)}clearQueryState(t){delete this.oo[t]}getAllActiveQueryTargets(){return this.so.activeTargetIds}isActiveQueryTarget(t){return this.so.activeTargetIds.has(t)}start(){return this.so=new A_,Promise.resolve()}handleUserChange(t,r,n){}setOnlineState(t){}shutdown(){}writeSequenceNumber(t){}notifyBundleLoaded(t){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jO{_o(t){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class I_{constructor(){this.ao=()=>this.uo(),this.co=()=>this.lo(),this.ho=[],this.Po()}_o(t){this.ho.push(t)}shutdown(){window.removeEventListener("online",this.ao),window.removeEventListener("offline",this.co)}Po(){window.addEventListener("online",this.ao),window.addEventListener("offline",this.co)}uo(){Re("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const t of this.ho)t(0)}lo(){Re("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const t of this.ho)t(1)}static D(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Pf=null;function Z0(){return Pf===null?Pf=function(){return 268435456+Math.round(2147483648*Math.random())}():Pf++,"0x"+Pf.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const UO={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VO{constructor(t){this.Io=t.Io,this.To=t.To}Eo(t){this.Ao=t}Ro(t){this.Vo=t}mo(t){this.fo=t}onMessage(t){this.po=t}close(){this.To()}send(t){this.Io(t)}yo(){this.Ao()}wo(){this.Vo()}So(t){this.fo(t)}bo(t){this.po(t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Fr="WebChannelConnection";class BO extends class{constructor(r){this.databaseInfo=r,this.databaseId=r.databaseId;const n=r.ssl?"https":"http",s=encodeURIComponent(this.databaseId.projectId),a=encodeURIComponent(this.databaseId.database);this.Do=n+"://"+r.host,this.vo=`projects/${s}/databases/${a}`,this.Co=this.databaseId.database==="(default)"?`project_id=${s}`:`project_id=${s}&database_id=${a}`}get Fo(){return!1}Mo(r,n,s,a,i){const o=Z0(),l=this.xo(r,n.toUriEncodedString());Re("RestConnection",`Sending RPC '${r}' ${o}:`,l,s);const c={"google-cloud-resource-prefix":this.vo,"x-goog-request-params":this.Co};return this.Oo(c,a,i),this.No(r,l,c,s).then(f=>(Re("RestConnection",`Received RPC '${r}' ${o}: `,f),f),f=>{throw fl("RestConnection",`RPC '${r}' ${o} failed with error: `,f,"url: ",l,"request:",s),f})}Lo(r,n,s,a,i,o){return this.Mo(r,n,s,a,i)}Oo(r,n,s){r["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+Sl}(),r["Content-Type"]="text/plain",this.databaseInfo.appId&&(r["X-Firebase-GMPID"]=this.databaseInfo.appId),n&&n.headers.forEach((a,i)=>r[i]=a),s&&s.headers.forEach((a,i)=>r[i]=a)}xo(r,n){const s=UO[r];return`${this.Do}/v1/${n}:${s}`}terminate(){}}{constructor(t){super(t),this.forceLongPolling=t.forceLongPolling,this.autoDetectLongPolling=t.autoDetectLongPolling,this.useFetchStreams=t.useFetchStreams,this.longPollingOptions=t.longPollingOptions}No(t,r,n,s){const a=Z0();return new Promise((i,o)=>{const l=new Ck;l.setWithCredentials(!0),l.listenOnce(bk.COMPLETE,()=>{try{switch(l.getLastErrorCode()){case ih.NO_ERROR:const f=l.getResponseJson();Re(Fr,`XHR for RPC '${t}' ${a} received:`,JSON.stringify(f)),i(f);break;case ih.TIMEOUT:Re(Fr,`RPC '${t}' ${a} timed out`),o(new be(ge.DEADLINE_EXCEEDED,"Request time out"));break;case ih.HTTP_ERROR:const d=l.getStatus();if(Re(Fr,`RPC '${t}' ${a} failed with status:`,d,"response text:",l.getResponseText()),d>0){let m=l.getResponseJson();Array.isArray(m)&&(m=m[0]);const p=m==null?void 0:m.error;if(p&&p.status&&p.message){const x=function(w){const k=w.toLowerCase().replace(/_/g,"-");return Object.values(ge).indexOf(k)>=0?k:ge.UNKNOWN}(p.status);o(new be(x,p.message))}else o(new be(ge.UNKNOWN,"Server responded with status "+l.getStatus()))}else o(new be(ge.UNAVAILABLE,"Connection failed."));break;default:je()}}finally{Re(Fr,`RPC '${t}' ${a} completed.`)}});const c=JSON.stringify(s);Re(Fr,`RPC '${t}' ${a} sending request:`,s),l.send(r,"POST",c,n,15)})}Bo(t,r,n){const s=Z0(),a=[this.Do,"/","google.firestore.v1.Firestore","/",t,"/channel"],i=Dk(),o=Pk(),l={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},c=this.longPollingOptions.timeoutSeconds;c!==void 0&&(l.longPollingTimeout=Math.round(1e3*c)),this.useFetchStreams&&(l.useFetchStreams=!0),this.Oo(l.initMessageHeaders,r,n),l.encodeInitMessageHeaders=!0;const f=a.join("");Re(Fr,`Creating RPC '${t}' stream ${s}: ${f}`,l);const d=i.createWebChannel(f,l);let m=!1,p=!1;const x=new VO({Io:w=>{p?Re(Fr,`Not sending because RPC '${t}' stream ${s} is closed:`,w):(m||(Re(Fr,`Opening RPC '${t}' stream ${s} transport.`),d.open(),m=!0),Re(Fr,`RPC '${t}' stream ${s} sending:`,w),d.send(w))},To:()=>d.close()}),g=(w,k,E)=>{w.listen(k,y=>{try{E(y)}catch(I){setTimeout(()=>{throw I},0)}})};return g(d,nc.EventType.OPEN,()=>{p||(Re(Fr,`RPC '${t}' stream ${s} transport opened.`),x.yo())}),g(d,nc.EventType.CLOSE,()=>{p||(p=!0,Re(Fr,`RPC '${t}' stream ${s} transport closed`),x.So())}),g(d,nc.EventType.ERROR,w=>{p||(p=!0,fl(Fr,`RPC '${t}' stream ${s} transport errored:`,w),x.So(new be(ge.UNAVAILABLE,"The operation could not be completed")))}),g(d,nc.EventType.MESSAGE,w=>{var k;if(!p){const E=w.data[0];xt(!!E);const y=E,I=y.error||((k=y[0])===null||k===void 0?void 0:k.error);if(I){Re(Fr,`RPC '${t}' stream ${s} received error:`,I);const M=I.status;let O=function(S){const C=Qt[S];if(C!==void 0)return iS(C)}(M),v=I.message;O===void 0&&(O=ge.INTERNAL,v="Unknown error status: "+M+" with message "+I.message),p=!0,x.So(new be(O,v)),d.close()}else Re(Fr,`RPC '${t}' stream ${s} received:`,E),x.bo(E)}}),g(o,Rk.STAT_EVENT,w=>{w.stat===_p.PROXY?Re(Fr,`RPC '${t}' stream ${s} detected buffering proxy`):w.stat===_p.NOPROXY&&Re(Fr,`RPC '${t}' stream ${s} detected no buffering proxy`)}),setTimeout(()=>{x.wo()},0),x}}function em(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qd(e){return new QF(e,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vS{constructor(t,r,n=1e3,s=1.5,a=6e4){this.ui=t,this.timerId=r,this.ko=n,this.qo=s,this.Qo=a,this.Ko=0,this.$o=null,this.Uo=Date.now(),this.reset()}reset(){this.Ko=0}Wo(){this.Ko=this.Qo}Go(t){this.cancel();const r=Math.floor(this.Ko+this.zo()),n=Math.max(0,Date.now()-this.Uo),s=Math.max(0,r-n);s>0&&Re("ExponentialBackoff",`Backing off for ${s} ms (base delay: ${this.Ko} ms, delay with jitter: ${r} ms, last attempt: ${n} ms ago)`),this.$o=this.ui.enqueueAfterDelay(this.timerId,s,()=>(this.Uo=Date.now(),t())),this.Ko*=this.qo,this.Ko<this.ko&&(this.Ko=this.ko),this.Ko>this.Qo&&(this.Ko=this.Qo)}jo(){this.$o!==null&&(this.$o.skipDelay(),this.$o=null)}cancel(){this.$o!==null&&(this.$o.cancel(),this.$o=null)}zo(){return(Math.random()-.5)*this.Ko}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yS{constructor(t,r,n,s,a,i,o,l){this.ui=t,this.Ho=n,this.Jo=s,this.connection=a,this.authCredentialsProvider=i,this.appCheckCredentialsProvider=o,this.listener=l,this.state=0,this.Yo=0,this.Zo=null,this.Xo=null,this.stream=null,this.e_=0,this.t_=new vS(t,r)}n_(){return this.state===1||this.state===5||this.r_()}r_(){return this.state===2||this.state===3}start(){this.e_=0,this.state!==4?this.auth():this.i_()}async stop(){this.n_()&&await this.close(0)}s_(){this.state=0,this.t_.reset()}o_(){this.r_()&&this.Zo===null&&(this.Zo=this.ui.enqueueAfterDelay(this.Ho,6e4,()=>this.__()))}a_(t){this.u_(),this.stream.send(t)}async __(){if(this.r_())return this.close(0)}u_(){this.Zo&&(this.Zo.cancel(),this.Zo=null)}c_(){this.Xo&&(this.Xo.cancel(),this.Xo=null)}async close(t,r){this.u_(),this.c_(),this.t_.cancel(),this.Yo++,t!==4?this.t_.reset():r&&r.code===ge.RESOURCE_EXHAUSTED?(va(r.toString()),va("Using maximum backoff delay to prevent overloading the backend."),this.t_.Wo()):r&&r.code===ge.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.l_(),this.stream.close(),this.stream=null),this.state=t,await this.listener.mo(r)}l_(){}auth(){this.state=1;const t=this.h_(this.Yo),r=this.Yo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([n,s])=>{this.Yo===r&&this.P_(n,s)},n=>{t(()=>{const s=new be(ge.UNKNOWN,"Fetching auth token failed: "+n.message);return this.I_(s)})})}P_(t,r){const n=this.h_(this.Yo);this.stream=this.T_(t,r),this.stream.Eo(()=>{n(()=>this.listener.Eo())}),this.stream.Ro(()=>{n(()=>(this.state=2,this.Xo=this.ui.enqueueAfterDelay(this.Jo,1e4,()=>(this.r_()&&(this.state=3),Promise.resolve())),this.listener.Ro()))}),this.stream.mo(s=>{n(()=>this.I_(s))}),this.stream.onMessage(s=>{n(()=>++this.e_==1?this.E_(s):this.onNext(s))})}i_(){this.state=5,this.t_.Go(async()=>{this.state=0,this.start()})}I_(t){return Re("PersistentStream",`close with error: ${t}`),this.stream=null,this.close(4,t)}h_(t){return r=>{this.ui.enqueueAndForget(()=>this.Yo===t?r():(Re("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class WO extends yS{constructor(t,r,n,s,a,i){super(t,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",r,n,s,i),this.serializer=a}T_(t,r){return this.connection.Bo("Listen",t,r)}E_(t){return this.onNext(t)}onNext(t){this.t_.reset();const r=eO(this.serializer,t),n=function(a){if(!("targetChange"in a))return Be.min();const i=a.targetChange;return i.targetIds&&i.targetIds.length?Be.min():i.readTime?bs(i.readTime):Be.min()}(t);return this.listener.d_(r,n)}A_(t){const r={};r.database=bp(this.serializer),r.addTarget=function(a,i){let o;const l=i.target;if(o=kp(l)?{documents:nO(a,l)}:{query:sO(a,l)._t},o.targetId=i.targetId,i.resumeToken.approximateByteSize()>0){o.resumeToken=cS(a,i.resumeToken);const c=Ip(a,i.expectedCount);c!==null&&(o.expectedCount=c)}else if(i.snapshotVersion.compareTo(Be.min())>0){o.readTime=Qh(a,i.snapshotVersion.toTimestamp());const c=Ip(a,i.expectedCount);c!==null&&(o.expectedCount=c)}return o}(this.serializer,t);const n=iO(this.serializer,t);n&&(r.labels=n),this.a_(r)}R_(t){const r={};r.database=bp(this.serializer),r.removeTarget=t,this.a_(r)}}class zO extends yS{constructor(t,r,n,s,a,i){super(t,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",r,n,s,i),this.serializer=a}get V_(){return this.e_>0}start(){this.lastStreamToken=void 0,super.start()}l_(){this.V_&&this.m_([])}T_(t,r){return this.connection.Bo("Write",t,r)}E_(t){return xt(!!t.streamToken),this.lastStreamToken=t.streamToken,xt(!t.writeResults||t.writeResults.length===0),this.listener.f_()}onNext(t){xt(!!t.streamToken),this.lastStreamToken=t.streamToken,this.t_.reset();const r=rO(t.writeResults,t.commitTime),n=bs(t.commitTime);return this.listener.g_(n,r)}p_(){const t={};t.database=bp(this.serializer),this.a_(t)}m_(t){const r={streamToken:this.lastStreamToken,writes:t.map(n=>tO(this.serializer,n))};this.a_(r)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $O extends class{}{constructor(t,r,n,s){super(),this.authCredentials=t,this.appCheckCredentials=r,this.connection=n,this.serializer=s,this.y_=!1}w_(){if(this.y_)throw new be(ge.FAILED_PRECONDITION,"The client has already been terminated.")}Mo(t,r,n,s){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([a,i])=>this.connection.Mo(t,Np(r,n),s,a,i)).catch(a=>{throw a.name==="FirebaseError"?(a.code===ge.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),a):new be(ge.UNKNOWN,a.toString())})}Lo(t,r,n,s,a){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([i,o])=>this.connection.Lo(t,Np(r,n),s,i,o,a)).catch(i=>{throw i.name==="FirebaseError"?(i.code===ge.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),i):new be(ge.UNKNOWN,i.toString())})}terminate(){this.y_=!0,this.connection.terminate()}}class HO{constructor(t,r){this.asyncQueue=t,this.onlineStateHandler=r,this.state="Unknown",this.S_=0,this.b_=null,this.D_=!0}v_(){this.S_===0&&(this.C_("Unknown"),this.b_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.b_=null,this.F_("Backend didn't respond within 10 seconds."),this.C_("Offline"),Promise.resolve())))}M_(t){this.state==="Online"?this.C_("Unknown"):(this.S_++,this.S_>=1&&(this.x_(),this.F_(`Connection failed 1 times. Most recent error: ${t.toString()}`),this.C_("Offline")))}set(t){this.x_(),this.S_=0,t==="Online"&&(this.D_=!1),this.C_(t)}C_(t){t!==this.state&&(this.state=t,this.onlineStateHandler(t))}F_(t){const r=`Could not reach Cloud Firestore backend. ${t}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.D_?(va(r),this.D_=!1):Re("OnlineStateTracker",r)}x_(){this.b_!==null&&(this.b_.cancel(),this.b_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GO{constructor(t,r,n,s,a){this.localStore=t,this.datastore=r,this.asyncQueue=n,this.remoteSyncer={},this.O_=[],this.N_=new Map,this.L_=new Set,this.B_=[],this.k_=a,this.k_._o(i=>{n.enqueueAndForget(async()=>{io(this)&&(Re("RemoteStore","Restarting streams for network reachability change."),await async function(l){const c=ze(l);c.L_.add(4),await ju(c),c.q_.set("Unknown"),c.L_.delete(4),await Yd(c)}(this))})}),this.q_=new HO(n,s)}}async function Yd(e){if(io(e))for(const t of e.B_)await t(!0)}async function ju(e){for(const t of e.B_)await t(!1)}function _S(e,t){const r=ze(e);r.N_.has(t.targetId)||(r.N_.set(t.targetId,t),Cx(r)?Nx(r):Il(r).r_()&&Ix(r,t))}function Ax(e,t){const r=ze(e),n=Il(r);r.N_.delete(t),n.r_()&&wS(r,t),r.N_.size===0&&(n.r_()?n.o_():io(r)&&r.q_.set("Unknown"))}function Ix(e,t){if(e.Q_.xe(t.targetId),t.resumeToken.approximateByteSize()>0||t.snapshotVersion.compareTo(Be.min())>0){const r=e.remoteSyncer.getRemoteKeysForTarget(t.targetId).size;t=t.withExpectedCount(r)}Il(e).A_(t)}function wS(e,t){e.Q_.xe(t),Il(e).R_(t)}function Nx(e){e.Q_=new KF({getRemoteKeysForTarget:t=>e.remoteSyncer.getRemoteKeysForTarget(t),ot:t=>e.N_.get(t)||null,tt:()=>e.datastore.serializer.databaseId}),Il(e).start(),e.q_.v_()}function Cx(e){return io(e)&&!Il(e).n_()&&e.N_.size>0}function io(e){return ze(e).L_.size===0}function ES(e){e.Q_=void 0}async function KO(e){e.q_.set("Online")}async function qO(e){e.N_.forEach((t,r)=>{Ix(e,t)})}async function YO(e,t){ES(e),Cx(e)?(e.q_.M_(t),Nx(e)):e.q_.set("Unknown")}async function XO(e,t,r){if(e.q_.set("Online"),t instanceof lS&&t.state===2&&t.cause)try{await async function(s,a){const i=a.cause;for(const o of a.targetIds)s.N_.has(o)&&(await s.remoteSyncer.rejectListen(o,i),s.N_.delete(o),s.Q_.removeTarget(o))}(e,t)}catch(n){Re("RemoteStore","Failed to remove targets %s: %s ",t.targetIds.join(","),n),await Jh(e,n)}else if(t instanceof ch?e.Q_.Ke(t):t instanceof oS?e.Q_.He(t):e.Q_.We(t),!r.isEqual(Be.min()))try{const n=await xS(e.localStore);r.compareTo(n)>=0&&await function(a,i){const o=a.Q_.rt(i);return o.targetChanges.forEach((l,c)=>{if(l.resumeToken.approximateByteSize()>0){const f=a.N_.get(c);f&&a.N_.set(c,f.withResumeToken(l.resumeToken,i))}}),o.targetMismatches.forEach((l,c)=>{const f=a.N_.get(l);if(!f)return;a.N_.set(l,f.withResumeToken(Nr.EMPTY_BYTE_STRING,f.snapshotVersion)),wS(a,l);const d=new $a(f.target,l,c,f.sequenceNumber);Ix(a,d)}),a.remoteSyncer.applyRemoteEvent(o)}(e,r)}catch(n){Re("RemoteStore","Failed to raise snapshot:",n),await Jh(e,n)}}async function Jh(e,t,r){if(!Fu(t))throw t;e.L_.add(1),await ju(e),e.q_.set("Offline"),r||(r=()=>xS(e.localStore)),e.asyncQueue.enqueueRetryable(async()=>{Re("RemoteStore","Retrying IndexedDB access"),await r(),e.L_.delete(1),await Yd(e)})}function TS(e,t){return t().catch(r=>Jh(e,r,t))}async function Xd(e){const t=ze(e),r=fi(t);let n=t.O_.length>0?t.O_[t.O_.length-1].batchId:-1;for(;QO(t);)try{const s=await FO(t.localStore,n);if(s===null){t.O_.length===0&&r.o_();break}n=s.batchId,JO(t,s)}catch(s){await Jh(t,s)}kS(t)&&SS(t)}function QO(e){return io(e)&&e.O_.length<10}function JO(e,t){e.O_.push(t);const r=fi(e);r.r_()&&r.V_&&r.m_(t.mutations)}function kS(e){return io(e)&&!fi(e).n_()&&e.O_.length>0}function SS(e){fi(e).start()}async function ZO(e){fi(e).p_()}async function eM(e){const t=fi(e);for(const r of e.O_)t.m_(r.mutations)}async function tM(e,t,r){const n=e.O_.shift(),s=_x.from(n,t,r);await TS(e,()=>e.remoteSyncer.applySuccessfulWrite(s)),await Xd(e)}async function rM(e,t){t&&fi(e).V_&&await async function(n,s){if(function(i){return $F(i)&&i!==ge.ABORTED}(s.code)){const a=n.O_.shift();fi(n).s_(),await TS(n,()=>n.remoteSyncer.rejectFailedWrite(a.batchId,s)),await Xd(n)}}(e,t),kS(e)&&SS(e)}async function N_(e,t){const r=ze(e);r.asyncQueue.verifyOperationInProgress(),Re("RemoteStore","RemoteStore received new credentials");const n=io(r);r.L_.add(3),await ju(r),n&&r.q_.set("Unknown"),await r.remoteSyncer.handleCredentialChange(t),r.L_.delete(3),await Yd(r)}async function nM(e,t){const r=ze(e);t?(r.L_.delete(2),await Yd(r)):t||(r.L_.add(2),await ju(r),r.q_.set("Unknown"))}function Il(e){return e.K_||(e.K_=function(r,n,s){const a=ze(r);return a.w_(),new WO(n,a.connection,a.authCredentials,a.appCheckCredentials,a.serializer,s)}(e.datastore,e.asyncQueue,{Eo:KO.bind(null,e),Ro:qO.bind(null,e),mo:YO.bind(null,e),d_:XO.bind(null,e)}),e.B_.push(async t=>{t?(e.K_.s_(),Cx(e)?Nx(e):e.q_.set("Unknown")):(await e.K_.stop(),ES(e))})),e.K_}function fi(e){return e.U_||(e.U_=function(r,n,s){const a=ze(r);return a.w_(),new zO(n,a.connection,a.authCredentials,a.appCheckCredentials,a.serializer,s)}(e.datastore,e.asyncQueue,{Eo:()=>Promise.resolve(),Ro:ZO.bind(null,e),mo:rM.bind(null,e),f_:eM.bind(null,e),g_:tM.bind(null,e)}),e.B_.push(async t=>{t?(e.U_.s_(),await Xd(e)):(await e.U_.stop(),e.O_.length>0&&(Re("RemoteStore",`Stopping write stream with ${e.O_.length} pending writes`),e.O_=[]))})),e.U_}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bx{constructor(t,r,n,s,a){this.asyncQueue=t,this.timerId=r,this.targetTimeMs=n,this.op=s,this.removalCallback=a,this.deferred=new oa,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(i=>{})}get promise(){return this.deferred.promise}static createAndSchedule(t,r,n,s,a){const i=Date.now()+n,o=new bx(t,r,i,s,a);return o.start(n),o}start(t){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),t)}skipDelay(){return this.handleDelayElapsed()}cancel(t){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new be(ge.CANCELLED,"Operation cancelled"+(t?": "+t:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(t=>this.deferred.resolve(t))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Rx(e,t){if(va("AsyncQueue",`${t}: ${e}`),Fu(e))return new be(ge.UNAVAILABLE,`${t}: ${e}`);throw e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xo{constructor(t){this.comparator=t?(r,n)=>t(r,n)||Pe.comparator(r.key,n.key):(r,n)=>Pe.comparator(r.key,n.key),this.keyedMap=sc(),this.sortedSet=new Ut(this.comparator)}static emptySet(t){return new Xo(t.comparator)}has(t){return this.keyedMap.get(t)!=null}get(t){return this.keyedMap.get(t)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(t){const r=this.keyedMap.get(t);return r?this.sortedSet.indexOf(r):-1}get size(){return this.sortedSet.size}forEach(t){this.sortedSet.inorderTraversal((r,n)=>(t(r),!1))}add(t){const r=this.delete(t.key);return r.copy(r.keyedMap.insert(t.key,t),r.sortedSet.insert(t,null))}delete(t){const r=this.get(t);return r?this.copy(this.keyedMap.remove(t),this.sortedSet.remove(r)):this}isEqual(t){if(!(t instanceof Xo)||this.size!==t.size)return!1;const r=this.sortedSet.getIterator(),n=t.sortedSet.getIterator();for(;r.hasNext();){const s=r.getNext().key,a=n.getNext().key;if(!s.isEqual(a))return!1}return!0}toString(){const t=[];return this.forEach(r=>{t.push(r.toString())}),t.length===0?"DocumentSet ()":`DocumentSet (
  `+t.join(`  
`)+`
)`}copy(t,r){const n=new Xo;return n.comparator=this.comparator,n.keyedMap=t,n.sortedSet=r,n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class C_{constructor(){this.W_=new Ut(Pe.comparator)}track(t){const r=t.doc.key,n=this.W_.get(r);n?t.type!==0&&n.type===3?this.W_=this.W_.insert(r,t):t.type===3&&n.type!==1?this.W_=this.W_.insert(r,{type:n.type,doc:t.doc}):t.type===2&&n.type===2?this.W_=this.W_.insert(r,{type:2,doc:t.doc}):t.type===2&&n.type===0?this.W_=this.W_.insert(r,{type:0,doc:t.doc}):t.type===1&&n.type===0?this.W_=this.W_.remove(r):t.type===1&&n.type===2?this.W_=this.W_.insert(r,{type:1,doc:n.doc}):t.type===0&&n.type===1?this.W_=this.W_.insert(r,{type:2,doc:t.doc}):je():this.W_=this.W_.insert(r,t)}G_(){const t=[];return this.W_.inorderTraversal((r,n)=>{t.push(n)}),t}}class gl{constructor(t,r,n,s,a,i,o,l,c){this.query=t,this.docs=r,this.oldDocs=n,this.docChanges=s,this.mutatedKeys=a,this.fromCache=i,this.syncStateChanged=o,this.excludesMetadataChanges=l,this.hasCachedResults=c}static fromInitialDocuments(t,r,n,s,a){const i=[];return r.forEach(o=>{i.push({type:0,doc:o})}),new gl(t,r,Xo.emptySet(r),i,n,s,!0,!1,a)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(t){if(!(this.fromCache===t.fromCache&&this.hasCachedResults===t.hasCachedResults&&this.syncStateChanged===t.syncStateChanged&&this.mutatedKeys.isEqual(t.mutatedKeys)&&zd(this.query,t.query)&&this.docs.isEqual(t.docs)&&this.oldDocs.isEqual(t.oldDocs)))return!1;const r=this.docChanges,n=t.docChanges;if(r.length!==n.length)return!1;for(let s=0;s<r.length;s++)if(r[s].type!==n[s].type||!r[s].doc.isEqual(n[s].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sM{constructor(){this.z_=void 0,this.j_=[]}H_(){return this.j_.some(t=>t.J_())}}class aM{constructor(){this.queries=b_(),this.onlineState="Unknown",this.Y_=new Set}terminate(){(function(r,n){const s=ze(r),a=s.queries;s.queries=b_(),a.forEach((i,o)=>{for(const l of o.j_)l.onError(n)})})(this,new be(ge.ABORTED,"Firestore shutting down"))}}function b_(){return new Al(e=>Gk(e),zd)}async function Px(e,t){const r=ze(e);let n=3;const s=t.query;let a=r.queries.get(s);a?!a.H_()&&t.J_()&&(n=2):(a=new sM,n=t.J_()?0:1);try{switch(n){case 0:a.z_=await r.onListen(s,!0);break;case 1:a.z_=await r.onListen(s,!1);break;case 2:await r.onFirstRemoteStoreListen(s)}}catch(i){const o=Rx(i,`Initialization of query '${ko(t.query)}' failed`);return void t.onError(o)}r.queries.set(s,a),a.j_.push(t),t.Z_(r.onlineState),a.z_&&t.X_(a.z_)&&Fx(r)}async function Dx(e,t){const r=ze(e),n=t.query;let s=3;const a=r.queries.get(n);if(a){const i=a.j_.indexOf(t);i>=0&&(a.j_.splice(i,1),a.j_.length===0?s=t.J_()?0:1:!a.H_()&&t.J_()&&(s=2))}switch(s){case 0:return r.queries.delete(n),r.onUnlisten(n,!0);case 1:return r.queries.delete(n),r.onUnlisten(n,!1);case 2:return r.onLastRemoteStoreUnlisten(n);default:return}}function iM(e,t){const r=ze(e);let n=!1;for(const s of t){const a=s.query,i=r.queries.get(a);if(i){for(const o of i.j_)o.X_(s)&&(n=!0);i.z_=s}}n&&Fx(r)}function oM(e,t,r){const n=ze(e),s=n.queries.get(t);if(s)for(const a of s.j_)a.onError(r);n.queries.delete(t)}function Fx(e){e.Y_.forEach(t=>{t.next()})}var Pp,R_;(R_=Pp||(Pp={})).ea="default",R_.Cache="cache";class Ox{constructor(t,r,n){this.query=t,this.ta=r,this.na=!1,this.ra=null,this.onlineState="Unknown",this.options=n||{}}X_(t){if(!this.options.includeMetadataChanges){const n=[];for(const s of t.docChanges)s.type!==3&&n.push(s);t=new gl(t.query,t.docs,t.oldDocs,n,t.mutatedKeys,t.fromCache,t.syncStateChanged,!0,t.hasCachedResults)}let r=!1;return this.na?this.ia(t)&&(this.ta.next(t),r=!0):this.sa(t,this.onlineState)&&(this.oa(t),r=!0),this.ra=t,r}onError(t){this.ta.error(t)}Z_(t){this.onlineState=t;let r=!1;return this.ra&&!this.na&&this.sa(this.ra,t)&&(this.oa(this.ra),r=!0),r}sa(t,r){if(!t.fromCache||!this.J_())return!0;const n=r!=="Offline";return(!this.options._a||!n)&&(!t.docs.isEmpty()||t.hasCachedResults||r==="Offline")}ia(t){if(t.docChanges.length>0)return!0;const r=this.ra&&this.ra.hasPendingWrites!==t.hasPendingWrites;return!(!t.syncStateChanged&&!r)&&this.options.includeMetadataChanges===!0}oa(t){t=gl.fromInitialDocuments(t.query,t.docs,t.mutatedKeys,t.fromCache,t.hasCachedResults),this.na=!0,this.ta.next(t)}J_(){return this.options.source!==Pp.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AS{constructor(t){this.key=t}}class IS{constructor(t){this.key=t}}class lM{constructor(t,r){this.query=t,this.Ta=r,this.Ea=null,this.hasCachedResults=!1,this.current=!1,this.da=Qe(),this.mutatedKeys=Qe(),this.Aa=Kk(t),this.Ra=new Xo(this.Aa)}get Va(){return this.Ta}ma(t,r){const n=r?r.fa:new C_,s=r?r.Ra:this.Ra;let a=r?r.mutatedKeys:this.mutatedKeys,i=s,o=!1;const l=this.query.limitType==="F"&&s.size===this.query.limit?s.last():null,c=this.query.limitType==="L"&&s.size===this.query.limit?s.first():null;if(t.inorderTraversal((f,d)=>{const m=s.get(f),p=$d(this.query,d)?d:null,x=!!m&&this.mutatedKeys.has(m.key),g=!!p&&(p.hasLocalMutations||this.mutatedKeys.has(p.key)&&p.hasCommittedMutations);let w=!1;m&&p?m.data.isEqual(p.data)?x!==g&&(n.track({type:3,doc:p}),w=!0):this.ga(m,p)||(n.track({type:2,doc:p}),w=!0,(l&&this.Aa(p,l)>0||c&&this.Aa(p,c)<0)&&(o=!0)):!m&&p?(n.track({type:0,doc:p}),w=!0):m&&!p&&(n.track({type:1,doc:m}),w=!0,(l||c)&&(o=!0)),w&&(p?(i=i.add(p),a=g?a.add(f):a.delete(f)):(i=i.delete(f),a=a.delete(f)))}),this.query.limit!==null)for(;i.size>this.query.limit;){const f=this.query.limitType==="F"?i.last():i.first();i=i.delete(f.key),a=a.delete(f.key),n.track({type:1,doc:f})}return{Ra:i,fa:n,ns:o,mutatedKeys:a}}ga(t,r){return t.hasLocalMutations&&r.hasCommittedMutations&&!r.hasLocalMutations}applyChanges(t,r,n,s){const a=this.Ra;this.Ra=t.Ra,this.mutatedKeys=t.mutatedKeys;const i=t.fa.G_();i.sort((f,d)=>function(p,x){const g=w=>{switch(w){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return je()}};return g(p)-g(x)}(f.type,d.type)||this.Aa(f.doc,d.doc)),this.pa(n),s=s!=null&&s;const o=r&&!s?this.ya():[],l=this.da.size===0&&this.current&&!s?1:0,c=l!==this.Ea;return this.Ea=l,i.length!==0||c?{snapshot:new gl(this.query,t.Ra,a,i,t.mutatedKeys,l===0,c,!1,!!n&&n.resumeToken.approximateByteSize()>0),wa:o}:{wa:o}}Z_(t){return this.current&&t==="Offline"?(this.current=!1,this.applyChanges({Ra:this.Ra,fa:new C_,mutatedKeys:this.mutatedKeys,ns:!1},!1)):{wa:[]}}Sa(t){return!this.Ta.has(t)&&!!this.Ra.has(t)&&!this.Ra.get(t).hasLocalMutations}pa(t){t&&(t.addedDocuments.forEach(r=>this.Ta=this.Ta.add(r)),t.modifiedDocuments.forEach(r=>{}),t.removedDocuments.forEach(r=>this.Ta=this.Ta.delete(r)),this.current=t.current)}ya(){if(!this.current)return[];const t=this.da;this.da=Qe(),this.Ra.forEach(n=>{this.Sa(n.key)&&(this.da=this.da.add(n.key))});const r=[];return t.forEach(n=>{this.da.has(n)||r.push(new IS(n))}),this.da.forEach(n=>{t.has(n)||r.push(new AS(n))}),r}ba(t){this.Ta=t.Ts,this.da=Qe();const r=this.ma(t.documents);return this.applyChanges(r,!0)}Da(){return gl.fromInitialDocuments(this.query,this.Ra,this.mutatedKeys,this.Ea===0,this.hasCachedResults)}}class cM{constructor(t,r,n){this.query=t,this.targetId=r,this.view=n}}class uM{constructor(t){this.key=t,this.va=!1}}class fM{constructor(t,r,n,s,a,i){this.localStore=t,this.remoteStore=r,this.eventManager=n,this.sharedClientState=s,this.currentUser=a,this.maxConcurrentLimboResolutions=i,this.Ca={},this.Fa=new Al(o=>Gk(o),zd),this.Ma=new Map,this.xa=new Set,this.Oa=new Ut(Pe.comparator),this.Na=new Map,this.La=new Tx,this.Ba={},this.ka=new Map,this.qa=pl.kn(),this.onlineState="Unknown",this.Qa=void 0}get isPrimaryClient(){return this.Qa===!0}}async function hM(e,t,r=!0){const n=DS(e);let s;const a=n.Fa.get(t);return a?(n.sharedClientState.addLocalQueryTarget(a.targetId),s=a.view.Da()):s=await NS(n,t,r,!0),s}async function dM(e,t){const r=DS(e);await NS(r,t,!0,!1)}async function NS(e,t,r,n){const s=await OO(e.localStore,Cs(t)),a=s.targetId,i=e.sharedClientState.addLocalQueryTarget(a,r);let o;return n&&(o=await mM(e,t,a,i==="current",s.resumeToken)),e.isPrimaryClient&&r&&_S(e.remoteStore,s),o}async function mM(e,t,r,n,s){e.Ka=(d,m,p)=>async function(g,w,k,E){let y=w.view.ma(k);y.ns&&(y=await S_(g.localStore,w.query,!1).then(({documents:v})=>w.view.ma(v,y)));const I=E&&E.targetChanges.get(w.targetId),M=E&&E.targetMismatches.get(w.targetId)!=null,O=w.view.applyChanges(y,g.isPrimaryClient,I,M);return D_(g,w.targetId,O.wa),O.snapshot}(e,d,m,p);const a=await S_(e.localStore,t,!0),i=new lM(t,a.Ts),o=i.ma(a.documents),l=Lu.createSynthesizedTargetChangeForCurrentChange(r,n&&e.onlineState!=="Offline",s),c=i.applyChanges(o,e.isPrimaryClient,l);D_(e,r,c.wa);const f=new cM(t,r,i);return e.Fa.set(t,f),e.Ma.has(r)?e.Ma.get(r).push(t):e.Ma.set(r,[t]),c.snapshot}async function pM(e,t,r){const n=ze(e),s=n.Fa.get(t),a=n.Ma.get(s.targetId);if(a.length>1)return n.Ma.set(s.targetId,a.filter(i=>!zd(i,t))),void n.Fa.delete(t);n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(s.targetId),n.sharedClientState.isActiveQueryTarget(s.targetId)||await Rp(n.localStore,s.targetId,!1).then(()=>{n.sharedClientState.clearQueryState(s.targetId),r&&Ax(n.remoteStore,s.targetId),Dp(n,s.targetId)}).catch(Du)):(Dp(n,s.targetId),await Rp(n.localStore,s.targetId,!0))}async function gM(e,t){const r=ze(e),n=r.Fa.get(t),s=r.Ma.get(n.targetId);r.isPrimaryClient&&s.length===1&&(r.sharedClientState.removeLocalQueryTarget(n.targetId),Ax(r.remoteStore,n.targetId))}async function xM(e,t,r){const n=kM(e);try{const s=await function(i,o){const l=ze(i),c=lr.now(),f=o.reduce((p,x)=>p.add(x.key),Qe());let d,m;return l.persistence.runTransaction("Locally write mutations","readwrite",p=>{let x=ya(),g=Qe();return l.cs.getEntries(p,f).next(w=>{x=w,x.forEach((k,E)=>{E.isValidDocument()||(g=g.add(k))})}).next(()=>l.localDocuments.getOverlayedDocuments(p,x)).next(w=>{d=w;const k=[];for(const E of o){const y=UF(E,d.get(E.key).overlayedDocument);y!=null&&k.push(new yi(E.key,y,jk(y.value.mapValue),Hn.exists(!0)))}return l.mutationQueue.addMutationBatch(p,c,k,o)}).next(w=>{m=w;const k=w.applyToLocalDocumentSet(d,g);return l.documentOverlayCache.saveOverlays(p,w.batchId,k)})}).then(()=>({batchId:m.batchId,changes:Yk(d)}))}(n.localStore,t);n.sharedClientState.addPendingMutation(s.batchId),function(i,o,l){let c=i.Ba[i.currentUser.toKey()];c||(c=new Ut(ut)),c=c.insert(o,l),i.Ba[i.currentUser.toKey()]=c}(n,s.batchId,r),await Uu(n,s.changes),await Xd(n.remoteStore)}catch(s){const a=Rx(s,"Failed to persist write");r.reject(a)}}async function CS(e,t){const r=ze(e);try{const n=await PO(r.localStore,t);t.targetChanges.forEach((s,a)=>{const i=r.Na.get(a);i&&(xt(s.addedDocuments.size+s.modifiedDocuments.size+s.removedDocuments.size<=1),s.addedDocuments.size>0?i.va=!0:s.modifiedDocuments.size>0?xt(i.va):s.removedDocuments.size>0&&(xt(i.va),i.va=!1))}),await Uu(r,n,t)}catch(n){await Du(n)}}function P_(e,t,r){const n=ze(e);if(n.isPrimaryClient&&r===0||!n.isPrimaryClient&&r===1){const s=[];n.Fa.forEach((a,i)=>{const o=i.view.Z_(t);o.snapshot&&s.push(o.snapshot)}),function(i,o){const l=ze(i);l.onlineState=o;let c=!1;l.queries.forEach((f,d)=>{for(const m of d.j_)m.Z_(o)&&(c=!0)}),c&&Fx(l)}(n.eventManager,t),s.length&&n.Ca.d_(s),n.onlineState=t,n.isPrimaryClient&&n.sharedClientState.setOnlineState(t)}}async function vM(e,t,r){const n=ze(e);n.sharedClientState.updateQueryState(t,"rejected",r);const s=n.Na.get(t),a=s&&s.key;if(a){let i=new Ut(Pe.comparator);i=i.insert(a,Ur.newNoDocument(a,Be.min()));const o=Qe().add(a),l=new Kd(Be.min(),new Map,new Ut(ut),i,o);await CS(n,l),n.Oa=n.Oa.remove(a),n.Na.delete(t),Mx(n)}else await Rp(n.localStore,t,!1).then(()=>Dp(n,t,r)).catch(Du)}async function yM(e,t){const r=ze(e),n=t.batch.batchId;try{const s=await RO(r.localStore,t);RS(r,n,null),bS(r,n),r.sharedClientState.updateMutationState(n,"acknowledged"),await Uu(r,s)}catch(s){await Du(s)}}async function _M(e,t,r){const n=ze(e);try{const s=await function(i,o){const l=ze(i);return l.persistence.runTransaction("Reject batch","readwrite-primary",c=>{let f;return l.mutationQueue.lookupMutationBatch(c,o).next(d=>(xt(d!==null),f=d.keys(),l.mutationQueue.removeMutationBatch(c,d))).next(()=>l.mutationQueue.performConsistencyCheck(c)).next(()=>l.documentOverlayCache.removeOverlaysForBatchId(c,f,o)).next(()=>l.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(c,f)).next(()=>l.localDocuments.getDocuments(c,f))})}(n.localStore,t);RS(n,t,r),bS(n,t),n.sharedClientState.updateMutationState(t,"rejected",r),await Uu(n,s)}catch(s){await Du(s)}}function bS(e,t){(e.ka.get(t)||[]).forEach(r=>{r.resolve()}),e.ka.delete(t)}function RS(e,t,r){const n=ze(e);let s=n.Ba[n.currentUser.toKey()];if(s){const a=s.get(t);a&&(r?a.reject(r):a.resolve(),s=s.remove(t)),n.Ba[n.currentUser.toKey()]=s}}function Dp(e,t,r=null){e.sharedClientState.removeLocalQueryTarget(t);for(const n of e.Ma.get(t))e.Fa.delete(n),r&&e.Ca.$a(n,r);e.Ma.delete(t),e.isPrimaryClient&&e.La.gr(t).forEach(n=>{e.La.containsKey(n)||PS(e,n)})}function PS(e,t){e.xa.delete(t.path.canonicalString());const r=e.Oa.get(t);r!==null&&(Ax(e.remoteStore,r),e.Oa=e.Oa.remove(t),e.Na.delete(r),Mx(e))}function D_(e,t,r){for(const n of r)n instanceof AS?(e.La.addReference(n.key,t),wM(e,n)):n instanceof IS?(Re("SyncEngine","Document no longer in limbo: "+n.key),e.La.removeReference(n.key,t),e.La.containsKey(n.key)||PS(e,n.key)):je()}function wM(e,t){const r=t.key,n=r.path.canonicalString();e.Oa.get(r)||e.xa.has(n)||(Re("SyncEngine","New document in limbo: "+r),e.xa.add(n),Mx(e))}function Mx(e){for(;e.xa.size>0&&e.Oa.size<e.maxConcurrentLimboResolutions;){const t=e.xa.values().next().value;e.xa.delete(t);const r=new Pe(Nt.fromString(t)),n=e.qa.next();e.Na.set(n,new uM(r)),e.Oa=e.Oa.insert(r,n),_S(e.remoteStore,new $a(Cs(Wd(r.path)),n,"TargetPurposeLimboResolution",hx.oe))}}async function Uu(e,t,r){const n=ze(e),s=[],a=[],i=[];n.Fa.isEmpty()||(n.Fa.forEach((o,l)=>{i.push(n.Ka(l,t,r).then(c=>{var f;if((c||r)&&n.isPrimaryClient){const d=c?!c.fromCache:(f=r==null?void 0:r.targetChanges.get(l.targetId))===null||f===void 0?void 0:f.current;n.sharedClientState.updateQueryState(l.targetId,d?"current":"not-current")}if(c){s.push(c);const d=Sx.Wi(l.targetId,c);a.push(d)}}))}),await Promise.all(i),n.Ca.d_(s),await async function(l,c){const f=ze(l);try{await f.persistence.runTransaction("notifyLocalViewChanges","readwrite",d=>ye.forEach(c,m=>ye.forEach(m.$i,p=>f.persistence.referenceDelegate.addReference(d,m.targetId,p)).next(()=>ye.forEach(m.Ui,p=>f.persistence.referenceDelegate.removeReference(d,m.targetId,p)))))}catch(d){if(!Fu(d))throw d;Re("LocalStore","Failed to update sequence numbers: "+d)}for(const d of c){const m=d.targetId;if(!d.fromCache){const p=f.os.get(m),x=p.snapshotVersion,g=p.withLastLimboFreeSnapshotVersion(x);f.os=f.os.insert(m,g)}}}(n.localStore,a))}async function EM(e,t){const r=ze(e);if(!r.currentUser.isEqual(t)){Re("SyncEngine","User change. New user:",t.toKey());const n=await gS(r.localStore,t);r.currentUser=t,function(a,i){a.ka.forEach(o=>{o.forEach(l=>{l.reject(new be(ge.CANCELLED,i))})}),a.ka.clear()}(r,"'waitForPendingWrites' promise is rejected due to a user change."),r.sharedClientState.handleUserChange(t,n.removedBatchIds,n.addedBatchIds),await Uu(r,n.hs)}}function TM(e,t){const r=ze(e),n=r.Na.get(t);if(n&&n.va)return Qe().add(n.key);{let s=Qe();const a=r.Ma.get(t);if(!a)return s;for(const i of a){const o=r.Fa.get(i);s=s.unionWith(o.view.Va)}return s}}function DS(e){const t=ze(e);return t.remoteStore.remoteSyncer.applyRemoteEvent=CS.bind(null,t),t.remoteStore.remoteSyncer.getRemoteKeysForTarget=TM.bind(null,t),t.remoteStore.remoteSyncer.rejectListen=vM.bind(null,t),t.Ca.d_=iM.bind(null,t.eventManager),t.Ca.$a=oM.bind(null,t.eventManager),t}function kM(e){const t=ze(e);return t.remoteStore.remoteSyncer.applySuccessfulWrite=yM.bind(null,t),t.remoteStore.remoteSyncer.rejectFailedWrite=_M.bind(null,t),t}class Zh{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(t){this.serializer=qd(t.databaseInfo.databaseId),this.sharedClientState=this.Wa(t),this.persistence=this.Ga(t),await this.persistence.start(),this.localStore=this.za(t),this.gcScheduler=this.ja(t,this.localStore),this.indexBackfillerScheduler=this.Ha(t,this.localStore)}ja(t,r){return null}Ha(t,r){return null}za(t){return bO(this.persistence,new NO,t.initialUser,this.serializer)}Ga(t){return new SO(kx.Zr,this.serializer)}Wa(t){return new LO}async terminate(){var t,r;(t=this.gcScheduler)===null||t===void 0||t.stop(),(r=this.indexBackfillerScheduler)===null||r===void 0||r.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}Zh.provider={build:()=>new Zh};class Fp{async initialize(t,r){this.localStore||(this.localStore=t.localStore,this.sharedClientState=t.sharedClientState,this.datastore=this.createDatastore(r),this.remoteStore=this.createRemoteStore(r),this.eventManager=this.createEventManager(r),this.syncEngine=this.createSyncEngine(r,!t.synchronizeTabs),this.sharedClientState.onlineStateHandler=n=>P_(this.syncEngine,n,1),this.remoteStore.remoteSyncer.handleCredentialChange=EM.bind(null,this.syncEngine),await nM(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(t){return function(){return new aM}()}createDatastore(t){const r=qd(t.databaseInfo.databaseId),n=function(a){return new BO(a)}(t.databaseInfo);return function(a,i,o,l){return new $O(a,i,o,l)}(t.authCredentials,t.appCheckCredentials,n,r)}createRemoteStore(t){return function(n,s,a,i,o){return new GO(n,s,a,i,o)}(this.localStore,this.datastore,t.asyncQueue,r=>P_(this.syncEngine,r,0),function(){return I_.D()?new I_:new jO}())}createSyncEngine(t,r){return function(s,a,i,o,l,c,f){const d=new fM(s,a,i,o,l,c);return f&&(d.Qa=!0),d}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,t.initialUser,t.maxConcurrentLimboResolutions,r)}async terminate(){var t,r;await async function(s){const a=ze(s);Re("RemoteStore","RemoteStore shutting down."),a.L_.add(5),await ju(a),a.k_.shutdown(),a.q_.set("Unknown")}(this.remoteStore),(t=this.datastore)===null||t===void 0||t.terminate(),(r=this.eventManager)===null||r===void 0||r.terminate()}}Fp.provider={build:()=>new Fp};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lx{constructor(t){this.observer=t,this.muted=!1}next(t){this.muted||this.observer.next&&this.Ya(this.observer.next,t)}error(t){this.muted||(this.observer.error?this.Ya(this.observer.error,t):va("Uncaught Error in snapshot listener:",t.toString()))}Za(){this.muted=!0}Ya(t,r){setTimeout(()=>{this.muted||t(r)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SM{constructor(t,r,n,s,a){this.authCredentials=t,this.appCheckCredentials=r,this.asyncQueue=n,this.databaseInfo=s,this.user=Mr.UNAUTHENTICATED,this.clientId=Ok.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=a,this.authCredentials.start(n,async i=>{Re("FirestoreClient","Received user=",i.uid),await this.authCredentialListener(i),this.user=i}),this.appCheckCredentials.start(n,i=>(Re("FirestoreClient","Received new app check token=",i),this.appCheckCredentialListener(i,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(t){this.authCredentialListener=t}setAppCheckTokenChangeListener(t){this.appCheckCredentialListener=t}terminate(){this.asyncQueue.enterRestrictedMode();const t=new oa;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),t.resolve()}catch(r){const n=Rx(r,"Failed to shutdown persistence");t.reject(n)}}),t.promise}}async function tm(e,t){e.asyncQueue.verifyOperationInProgress(),Re("FirestoreClient","Initializing OfflineComponentProvider");const r=e.configuration;await t.initialize(r);let n=r.initialUser;e.setCredentialChangeListener(async s=>{n.isEqual(s)||(await gS(t.localStore,s),n=s)}),t.persistence.setDatabaseDeletedListener(()=>e.terminate()),e._offlineComponents=t}async function F_(e,t){e.asyncQueue.verifyOperationInProgress();const r=await AM(e);Re("FirestoreClient","Initializing OnlineComponentProvider"),await t.initialize(r,e.configuration),e.setCredentialChangeListener(n=>N_(t.remoteStore,n)),e.setAppCheckTokenChangeListener((n,s)=>N_(t.remoteStore,s)),e._onlineComponents=t}async function AM(e){if(!e._offlineComponents)if(e._uninitializedComponentsProvider){Re("FirestoreClient","Using user provided OfflineComponentProvider");try{await tm(e,e._uninitializedComponentsProvider._offline)}catch(t){const r=t;if(!function(s){return s.name==="FirebaseError"?s.code===ge.FAILED_PRECONDITION||s.code===ge.UNIMPLEMENTED:!(typeof DOMException<"u"&&s instanceof DOMException)||s.code===22||s.code===20||s.code===11}(r))throw r;fl("Error using user provided cache. Falling back to memory cache: "+r),await tm(e,new Zh)}}else Re("FirestoreClient","Using default OfflineComponentProvider"),await tm(e,new Zh);return e._offlineComponents}async function FS(e){return e._onlineComponents||(e._uninitializedComponentsProvider?(Re("FirestoreClient","Using user provided OnlineComponentProvider"),await F_(e,e._uninitializedComponentsProvider._online)):(Re("FirestoreClient","Using default OnlineComponentProvider"),await F_(e,new Fp))),e._onlineComponents}function IM(e){return FS(e).then(t=>t.syncEngine)}async function ed(e){const t=await FS(e),r=t.eventManager;return r.onListen=hM.bind(null,t.syncEngine),r.onUnlisten=pM.bind(null,t.syncEngine),r.onFirstRemoteStoreListen=dM.bind(null,t.syncEngine),r.onLastRemoteStoreUnlisten=gM.bind(null,t.syncEngine),r}function NM(e,t,r={}){const n=new oa;return e.asyncQueue.enqueueAndForget(async()=>function(a,i,o,l,c){const f=new Lx({next:m=>{f.Za(),i.enqueueAndForget(()=>Dx(a,d));const p=m.docs.has(o);!p&&m.fromCache?c.reject(new be(ge.UNAVAILABLE,"Failed to get document because the client is offline.")):p&&m.fromCache&&l&&l.source==="server"?c.reject(new be(ge.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):c.resolve(m)},error:m=>c.reject(m)}),d=new Ox(Wd(o.path),f,{includeMetadataChanges:!0,_a:!0});return Px(a,d)}(await ed(e),e.asyncQueue,t,r,n)),n.promise}function CM(e,t,r={}){const n=new oa;return e.asyncQueue.enqueueAndForget(async()=>function(a,i,o,l,c){const f=new Lx({next:m=>{f.Za(),i.enqueueAndForget(()=>Dx(a,d)),m.fromCache&&l.source==="server"?c.reject(new be(ge.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):c.resolve(m)},error:m=>c.reject(m)}),d=new Ox(o,f,{includeMetadataChanges:!0,_a:!0});return Px(a,d)}(await ed(e),e.asyncQueue,t,r,n)),n.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function OS(e){const t={};return e.timeoutSeconds!==void 0&&(t.timeoutSeconds=e.timeoutSeconds),t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const O_=new Map;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function MS(e,t,r){if(!r)throw new be(ge.INVALID_ARGUMENT,`Function ${e}() cannot be called with an empty ${t}.`)}function bM(e,t,r,n){if(t===!0&&n===!0)throw new be(ge.INVALID_ARGUMENT,`${e} and ${r} cannot be used together.`)}function M_(e){if(!Pe.isDocumentKey(e))throw new be(ge.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${e} has ${e.length}.`)}function L_(e){if(Pe.isDocumentKey(e))throw new be(ge.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${e} has ${e.length}.`)}function Qd(e){if(e===void 0)return"undefined";if(e===null)return"null";if(typeof e=="string")return e.length>20&&(e=`${e.substring(0,20)}...`),JSON.stringify(e);if(typeof e=="number"||typeof e=="boolean")return""+e;if(typeof e=="object"){if(e instanceof Array)return"an array";{const t=function(n){return n.constructor?n.constructor.name:null}(e);return t?`a custom ${t} object`:"an object"}}return typeof e=="function"?"a function":je()}function xn(e,t){if("_delegate"in e&&(e=e._delegate),!(e instanceof t)){if(t.name===e.constructor.name)throw new be(ge.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const r=Qd(e);throw new be(ge.INVALID_ARGUMENT,`Expected type '${t.name}', but it was: ${r}`)}}return e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class j_{constructor(t){var r,n;if(t.host===void 0){if(t.ssl!==void 0)throw new be(ge.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=t.host,this.ssl=(r=t.ssl)===null||r===void 0||r;if(this.credentials=t.credentials,this.ignoreUndefinedProperties=!!t.ignoreUndefinedProperties,this.localCache=t.localCache,t.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(t.cacheSizeBytes!==-1&&t.cacheSizeBytes<1048576)throw new be(ge.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=t.cacheSizeBytes}bM("experimentalForceLongPolling",t.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",t.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!t.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:t.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!t.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=OS((n=t.experimentalLongPollingOptions)!==null&&n!==void 0?n:{}),function(a){if(a.timeoutSeconds!==void 0){if(isNaN(a.timeoutSeconds))throw new be(ge.INVALID_ARGUMENT,`invalid long polling timeout: ${a.timeoutSeconds} (must not be NaN)`);if(a.timeoutSeconds<5)throw new be(ge.INVALID_ARGUMENT,`invalid long polling timeout: ${a.timeoutSeconds} (minimum allowed value is 5)`);if(a.timeoutSeconds>30)throw new be(ge.INVALID_ARGUMENT,`invalid long polling timeout: ${a.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!t.useFetchStreams}isEqual(t){return this.host===t.host&&this.ssl===t.ssl&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.experimentalForceLongPolling===t.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===t.experimentalAutoDetectLongPolling&&function(n,s){return n.timeoutSeconds===s.timeoutSeconds}(this.experimentalLongPollingOptions,t.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties&&this.useFetchStreams===t.useFetchStreams}}class Jd{constructor(t,r,n,s){this._authCredentials=t,this._appCheckCredentials=r,this._databaseId=n,this._app=s,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new j_({}),this._settingsFrozen=!1,this._terminateTask="notTerminated"}get app(){if(!this._app)throw new be(ge.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(t){if(this._settingsFrozen)throw new be(ge.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new j_(t),t.credentials!==void 0&&(this._authCredentials=function(n){if(!n)return new Y3;switch(n.type){case"firstParty":return new Z3(n.sessionIndex||"0",n.iamToken||null,n.authTokenFactory||null);case"provider":return n.client;default:throw new be(ge.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(t.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(r){const n=O_.get(r);n&&(Re("ComponentProvider","Removing Datastore"),O_.delete(r),n.terminate())}(this),Promise.resolve()}}function RM(e,t,r,n={}){var s;const a=(e=xn(e,Jd))._getSettings(),i=`${t}:${r}`;if(a.host!=="firestore.googleapis.com"&&a.host!==i&&fl("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),e._setSettings(Object.assign(Object.assign({},a),{host:i,ssl:!1})),n.mockUserToken){let o,l;if(typeof n.mockUserToken=="string")o=n.mockUserToken,l=Mr.MOCK_USER;else{o=WT(n.mockUserToken,(s=e._app)===null||s===void 0?void 0:s.options.projectId);const c=n.mockUserToken.sub||n.mockUserToken.user_id;if(!c)throw new be(ge.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");l=new Mr(c)}e._authCredentials=new X3(new Fk(o,l))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oo{constructor(t,r,n){this.converter=r,this._query=n,this.type="query",this.firestore=t}withConverter(t){return new oo(this.firestore,t,this._query)}}class Wr{constructor(t,r,n){this.converter=r,this._key=n,this.type="document",this.firestore=t}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new ni(this.firestore,this.converter,this._key.path.popLast())}withConverter(t){return new Wr(this.firestore,t,this._key)}}class ni extends oo{constructor(t,r,n){super(t,r,Wd(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const t=this._path.popLast();return t.isEmpty()?null:new Wr(this.firestore,null,new Pe(t))}withConverter(t){return new ni(this.firestore,t,this._path)}}function bt(e,t,...r){if(e=qt(e),MS("collection","path",t),e instanceof Jd){const n=Nt.fromString(t,...r);return L_(n),new ni(e,null,n)}{if(!(e instanceof Wr||e instanceof ni))throw new be(ge.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=e._path.child(Nt.fromString(t,...r));return L_(n),new ni(e.firestore,null,n)}}function Ft(e,t,...r){if(e=qt(e),arguments.length===1&&(t=Ok.newId()),MS("doc","path",t),e instanceof Jd){const n=Nt.fromString(t,...r);return M_(n),new Wr(e,null,new Pe(n))}{if(!(e instanceof Wr||e instanceof ni))throw new be(ge.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=e._path.child(Nt.fromString(t,...r));return M_(n),new Wr(e.firestore,e instanceof ni?e.converter:null,new Pe(n))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class U_{constructor(t=Promise.resolve()){this.Pu=[],this.Iu=!1,this.Tu=[],this.Eu=null,this.du=!1,this.Au=!1,this.Ru=[],this.t_=new vS(this,"async_queue_retry"),this.Vu=()=>{const n=em();n&&Re("AsyncQueue","Visibility state changed to "+n.visibilityState),this.t_.jo()},this.mu=t;const r=em();r&&typeof r.addEventListener=="function"&&r.addEventListener("visibilitychange",this.Vu)}get isShuttingDown(){return this.Iu}enqueueAndForget(t){this.enqueue(t)}enqueueAndForgetEvenWhileRestricted(t){this.fu(),this.gu(t)}enterRestrictedMode(t){if(!this.Iu){this.Iu=!0,this.Au=t||!1;const r=em();r&&typeof r.removeEventListener=="function"&&r.removeEventListener("visibilitychange",this.Vu)}}enqueue(t){if(this.fu(),this.Iu)return new Promise(()=>{});const r=new oa;return this.gu(()=>this.Iu&&this.Au?Promise.resolve():(t().then(r.resolve,r.reject),r.promise)).then(()=>r.promise)}enqueueRetryable(t){this.enqueueAndForget(()=>(this.Pu.push(t),this.pu()))}async pu(){if(this.Pu.length!==0){try{await this.Pu[0](),this.Pu.shift(),this.t_.reset()}catch(t){if(!Fu(t))throw t;Re("AsyncQueue","Operation failed with retryable error: "+t)}this.Pu.length>0&&this.t_.Go(()=>this.pu())}}gu(t){const r=this.mu.then(()=>(this.du=!0,t().catch(n=>{this.Eu=n,this.du=!1;const s=function(i){let o=i.message||"";return i.stack&&(o=i.stack.includes(i.message)?i.stack:i.message+`
`+i.stack),o}(n);throw va("INTERNAL UNHANDLED ERROR: ",s),n}).then(n=>(this.du=!1,n))));return this.mu=r,r}enqueueAfterDelay(t,r,n){this.fu(),this.Ru.indexOf(t)>-1&&(r=0);const s=bx.createAndSchedule(this,t,r,n,a=>this.yu(a));return this.Tu.push(s),s}fu(){this.Eu&&je()}verifyOperationInProgress(){}async wu(){let t;do t=this.mu,await t;while(t!==this.mu)}Su(t){for(const r of this.Tu)if(r.timerId===t)return!0;return!1}bu(t){return this.wu().then(()=>{this.Tu.sort((r,n)=>r.targetTimeMs-n.targetTimeMs);for(const r of this.Tu)if(r.skipDelay(),t!=="all"&&r.timerId===t)break;return this.wu()})}Du(t){this.Ru.push(t)}yu(t){const r=this.Tu.indexOf(t);this.Tu.splice(r,1)}}function V_(e){return function(r,n){if(typeof r!="object"||r===null)return!1;const s=r;for(const a of n)if(a in s&&typeof s[a]=="function")return!0;return!1}(e,["next","error","complete"])}class _a extends Jd{constructor(t,r,n,s){super(t,r,n,s),this.type="firestore",this._queue=new U_,this._persistenceKey=(s==null?void 0:s.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const t=this._firestoreClient.terminate();this._queue=new U_(t),this._firestoreClient=void 0,await t}}}function PM(e,t){const r=typeof e=="object"?e:Ld(),n=typeof e=="string"?e:"(default)",s=Cu(r,"firestore").getImmediate({identifier:n});if(!s._initialized){const a=Qg("firestore");a&&RM(s,...a)}return s}function Zd(e){if(e._terminated)throw new be(ge.FAILED_PRECONDITION,"The client has already been terminated.");return e._firestoreClient||DM(e),e._firestoreClient}function DM(e){var t,r,n;const s=e._freezeSettings(),a=function(o,l,c,f){return new hF(o,l,c,f.host,f.ssl,f.experimentalForceLongPolling,f.experimentalAutoDetectLongPolling,OS(f.experimentalLongPollingOptions),f.useFetchStreams)}(e._databaseId,((t=e._app)===null||t===void 0?void 0:t.options.appId)||"",e._persistenceKey,s);e._componentsProvider||!((r=s.localCache)===null||r===void 0)&&r._offlineComponentProvider&&(!((n=s.localCache)===null||n===void 0)&&n._onlineComponentProvider)&&(e._componentsProvider={_offline:s.localCache._offlineComponentProvider,_online:s.localCache._onlineComponentProvider}),e._firestoreClient=new SM(e._authCredentials,e._appCheckCredentials,e._queue,a,e._componentsProvider&&function(o){const l=o==null?void 0:o._online.build();return{_offline:o==null?void 0:o._offline.build(l),_online:l}}(e._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xl{constructor(t){this._byteString=t}static fromBase64String(t){try{return new xl(Nr.fromBase64String(t))}catch(r){throw new be(ge.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+r)}}static fromUint8Array(t){return new xl(Nr.fromUint8Array(t))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(t){return this._byteString.isEqual(t._byteString)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class e0{constructor(...t){for(let r=0;r<t.length;++r)if(t[r].length===0)throw new be(ge.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Er(t)}isEqual(t){return this._internalPath.isEqual(t._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vu{constructor(t){this._methodName=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jx{constructor(t,r){if(!isFinite(t)||t<-90||t>90)throw new be(ge.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(r)||r<-180||r>180)throw new be(ge.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+r);this._lat=t,this._long=r}get latitude(){return this._lat}get longitude(){return this._long}isEqual(t){return this._lat===t._lat&&this._long===t._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(t){return ut(this._lat,t._lat)||ut(this._long,t._long)}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ux{constructor(t){this._values=(t||[]).map(r=>r)}toArray(){return this._values.map(t=>t)}isEqual(t){return function(n,s){if(n.length!==s.length)return!1;for(let a=0;a<n.length;++a)if(n[a]!==s[a])return!1;return!0}(this._values,t._values)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const FM=/^__.*__$/;class OM{constructor(t,r,n){this.data=t,this.fieldMask=r,this.fieldTransforms=n}toMutation(t,r){return this.fieldMask!==null?new yi(t,this.data,this.fieldMask,r,this.fieldTransforms):new Mu(t,this.data,r,this.fieldTransforms)}}class LS{constructor(t,r,n){this.data=t,this.fieldMask=r,this.fieldTransforms=n}toMutation(t,r){return new yi(t,this.data,this.fieldMask,r,this.fieldTransforms)}}function jS(e){switch(e){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw je()}}class Vx{constructor(t,r,n,s,a,i){this.settings=t,this.databaseId=r,this.serializer=n,this.ignoreUndefinedProperties=s,a===void 0&&this.vu(),this.fieldTransforms=a||[],this.fieldMask=i||[]}get path(){return this.settings.path}get Cu(){return this.settings.Cu}Fu(t){return new Vx(Object.assign(Object.assign({},this.settings),t),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Mu(t){var r;const n=(r=this.path)===null||r===void 0?void 0:r.child(t),s=this.Fu({path:n,xu:!1});return s.Ou(t),s}Nu(t){var r;const n=(r=this.path)===null||r===void 0?void 0:r.child(t),s=this.Fu({path:n,xu:!1});return s.vu(),s}Lu(t){return this.Fu({path:void 0,xu:!0})}Bu(t){return td(t,this.settings.methodName,this.settings.ku||!1,this.path,this.settings.qu)}contains(t){return this.fieldMask.find(r=>t.isPrefixOf(r))!==void 0||this.fieldTransforms.find(r=>t.isPrefixOf(r.field))!==void 0}vu(){if(this.path)for(let t=0;t<this.path.length;t++)this.Ou(this.path.get(t))}Ou(t){if(t.length===0)throw this.Bu("Document fields must not be empty");if(jS(this.Cu)&&FM.test(t))throw this.Bu('Document fields cannot begin and end with "__"')}}class MM{constructor(t,r,n){this.databaseId=t,this.ignoreUndefinedProperties=r,this.serializer=n||qd(t)}Qu(t,r,n,s=!1){return new Vx({Cu:t,methodName:r,qu:n,path:Er.emptyPath(),xu:!1,ku:s},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function t0(e){const t=e._freezeSettings(),r=qd(e._databaseId);return new MM(e._databaseId,!!t.ignoreUndefinedProperties,r)}function US(e,t,r,n,s,a={}){const i=e.Qu(a.merge||a.mergeFields?2:0,t,r,s);zx("Data must be an object, but it was:",i,n);const o=VS(n,i);let l,c;if(a.merge)l=new Sn(i.fieldMask),c=i.fieldTransforms;else if(a.mergeFields){const f=[];for(const d of a.mergeFields){const m=Op(t,d,r);if(!i.contains(m))throw new be(ge.INVALID_ARGUMENT,`Field '${m}' is specified in your field mask but missing from your input data.`);WS(f,m)||f.push(m)}l=new Sn(f),c=i.fieldTransforms.filter(d=>l.covers(d.field))}else l=null,c=i.fieldTransforms;return new OM(new fn(o),l,c)}class r0 extends Vu{_toFieldTransform(t){if(t.Cu!==2)throw t.Cu===1?t.Bu(`${this._methodName}() can only appear at the top level of your update data`):t.Bu(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return t.fieldMask.push(t.path),null}isEqual(t){return t instanceof r0}}class Bx extends Vu{_toFieldTransform(t){return new nS(t.path,new iu)}isEqual(t){return t instanceof Bx}}class Wx extends Vu{constructor(t,r){super(t),this.$u=r}_toFieldTransform(t){const r=new cu(t.serializer,Jk(t.serializer,this.$u));return new nS(t.path,r)}isEqual(t){return t instanceof Wx&&this.$u===t.$u}}function LM(e,t,r,n){const s=e.Qu(1,t,r);zx("Data must be an object, but it was:",s,n);const a=[],i=fn.empty();ao(n,(l,c)=>{const f=$x(t,l,r);c=qt(c);const d=s.Nu(f);if(c instanceof r0)a.push(f);else{const m=Bu(c,d);m!=null&&(a.push(f),i.set(f,m))}});const o=new Sn(a);return new LS(i,o,s.fieldTransforms)}function jM(e,t,r,n,s,a){const i=e.Qu(1,t,r),o=[Op(t,n,r)],l=[s];if(a.length%2!=0)throw new be(ge.INVALID_ARGUMENT,`Function ${t}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let m=0;m<a.length;m+=2)o.push(Op(t,a[m])),l.push(a[m+1]);const c=[],f=fn.empty();for(let m=o.length-1;m>=0;--m)if(!WS(c,o[m])){const p=o[m];let x=l[m];x=qt(x);const g=i.Nu(p);if(x instanceof r0)c.push(p);else{const w=Bu(x,g);w!=null&&(c.push(p),f.set(p,w))}}const d=new Sn(c);return new LS(f,d,i.fieldTransforms)}function UM(e,t,r,n=!1){return Bu(r,e.Qu(n?4:3,t))}function Bu(e,t){if(BS(e=qt(e)))return zx("Unsupported field value:",t,e),VS(e,t);if(e instanceof Vu)return function(n,s){if(!jS(s.Cu))throw s.Bu(`${n._methodName}() can only be used with update() and set()`);if(!s.path)throw s.Bu(`${n._methodName}() is not currently supported inside arrays`);const a=n._toFieldTransform(s);a&&s.fieldTransforms.push(a)}(e,t),null;if(e===void 0&&t.ignoreUndefinedProperties)return null;if(t.path&&t.fieldMask.push(t.path),e instanceof Array){if(t.settings.xu&&t.Cu!==4)throw t.Bu("Nested arrays are not supported");return function(n,s){const a=[];let i=0;for(const o of n){let l=Bu(o,s.Lu(i));l==null&&(l={nullValue:"NULL_VALUE"}),a.push(l),i++}return{arrayValue:{values:a}}}(e,t)}return function(n,s){if((n=qt(n))===null)return{nullValue:"NULL_VALUE"};if(typeof n=="number")return Jk(s.serializer,n);if(typeof n=="boolean")return{booleanValue:n};if(typeof n=="string")return{stringValue:n};if(n instanceof Date){const a=lr.fromDate(n);return{timestampValue:Qh(s.serializer,a)}}if(n instanceof lr){const a=new lr(n.seconds,1e3*Math.floor(n.nanoseconds/1e3));return{timestampValue:Qh(s.serializer,a)}}if(n instanceof jx)return{geoPointValue:{latitude:n.latitude,longitude:n.longitude}};if(n instanceof xl)return{bytesValue:cS(s.serializer,n._byteString)};if(n instanceof Wr){const a=s.databaseId,i=n.firestore._databaseId;if(!i.isEqual(a))throw s.Bu(`Document reference is for database ${i.projectId}/${i.database} but should be for database ${a.projectId}/${a.database}`);return{referenceValue:Ex(n.firestore._databaseId||s.databaseId,n._key.path)}}if(n instanceof Ux)return function(i,o){return{mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{values:i.toArray().map(l=>{if(typeof l!="number")throw o.Bu("VectorValues must only contain numeric values.");return vx(o.serializer,l)})}}}}}}(n,s);throw s.Bu(`Unsupported field value: ${Qd(n)}`)}(e,t)}function VS(e,t){const r={};return Mk(e)?t.path&&t.path.length>0&&t.fieldMask.push(t.path):ao(e,(n,s)=>{const a=Bu(s,t.Mu(n));a!=null&&(r[n]=a)}),{mapValue:{fields:r}}}function BS(e){return!(typeof e!="object"||e===null||e instanceof Array||e instanceof Date||e instanceof lr||e instanceof jx||e instanceof xl||e instanceof Wr||e instanceof Vu||e instanceof Ux)}function zx(e,t,r){if(!BS(r)||!function(s){return typeof s=="object"&&s!==null&&(Object.getPrototypeOf(s)===Object.prototype||Object.getPrototypeOf(s)===null)}(r)){const n=Qd(r);throw n==="an object"?t.Bu(e+" a custom object"):t.Bu(e+" "+n)}}function Op(e,t,r){if((t=qt(t))instanceof e0)return t._internalPath;if(typeof t=="string")return $x(e,t);throw td("Field path arguments must be of type string or ",e,!1,void 0,r)}const VM=new RegExp("[~\\*/\\[\\]]");function $x(e,t,r){if(t.search(VM)>=0)throw td(`Invalid field path (${t}). Paths must not contain '~', '*', '/', '[', or ']'`,e,!1,void 0,r);try{return new e0(...t.split("."))._internalPath}catch{throw td(`Invalid field path (${t}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,e,!1,void 0,r)}}function td(e,t,r,n,s){const a=n&&!n.isEmpty(),i=s!==void 0;let o=`Function ${t}() called with invalid data`;r&&(o+=" (via `toFirestore()`)"),o+=". ";let l="";return(a||i)&&(l+=" (found",a&&(l+=` in field ${n}`),i&&(l+=` in document ${s}`),l+=")"),new be(ge.INVALID_ARGUMENT,o+e+l)}function WS(e,t){return e.some(r=>r.isEqual(t))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zS{constructor(t,r,n,s,a){this._firestore=t,this._userDataWriter=r,this._key=n,this._document=s,this._converter=a}get id(){return this._key.path.lastSegment()}get ref(){return new Wr(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const t=new BM(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(t)}return this._userDataWriter.convertValue(this._document.data.value)}}get(t){if(this._document){const r=this._document.data.field(Hx("DocumentSnapshot.get",t));if(r!==null)return this._userDataWriter.convertValue(r)}}}class BM extends zS{data(){return super.data()}}function Hx(e,t){return typeof t=="string"?$x(e,t):t instanceof e0?t._internalPath:t._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $S(e){if(e.limitType==="L"&&e.explicitOrderBy.length===0)throw new be(ge.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class Gx{}class WM extends Gx{}function In(e,t,...r){let n=[];t instanceof Gx&&n.push(t),n=n.concat(r),function(a){const i=a.filter(l=>l instanceof Kx).length,o=a.filter(l=>l instanceof n0).length;if(i>1||i>0&&o>0)throw new be(ge.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(n);for(const s of n)e=s._apply(e);return e}class n0 extends WM{constructor(t,r,n){super(),this._field=t,this._op=r,this._value=n,this.type="where"}static _create(t,r,n){return new n0(t,r,n)}_apply(t){const r=this._parse(t);return HS(t._query,r),new oo(t.firestore,t.converter,Sp(t._query,r))}_parse(t){const r=t0(t.firestore);return function(a,i,o,l,c,f,d){let m;if(c.isKeyField()){if(f==="array-contains"||f==="array-contains-any")throw new be(ge.INVALID_ARGUMENT,`Invalid Query. You can't perform '${f}' queries on documentId().`);if(f==="in"||f==="not-in"){W_(d,f);const p=[];for(const x of d)p.push(B_(l,a,x));m={arrayValue:{values:p}}}else m=B_(l,a,d)}else f!=="in"&&f!=="not-in"&&f!=="array-contains-any"||W_(d,f),m=UM(o,i,d,f==="in"||f==="not-in");return rr.create(c,f,m)}(t._query,"where",r,t.firestore._databaseId,this._field,this._op,this._value)}}function Zr(e,t,r){const n=t,s=Hx("where",e);return n0._create(s,n,r)}class Kx extends Gx{constructor(t,r){super(),this.type=t,this._queryConstraints=r}static _create(t,r){return new Kx(t,r)}_parse(t){const r=this._queryConstraints.map(n=>n._parse(t)).filter(n=>n.getFilters().length>0);return r.length===1?r[0]:gs.create(r,this._getOperator())}_apply(t){const r=this._parse(t);return r.getFilters().length===0?t:(function(s,a){let i=s;const o=a.getFlattenedFilters();for(const l of o)HS(i,l),i=Sp(i,l)}(t._query,r),new oo(t.firestore,t.converter,Sp(t._query,r)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}function B_(e,t,r){if(typeof(r=qt(r))=="string"){if(r==="")throw new be(ge.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!Hk(t)&&r.indexOf("/")!==-1)throw new be(ge.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${r}' contains a '/' character.`);const n=t.path.child(Nt.fromString(r));if(!Pe.isDocumentKey(n))throw new be(ge.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${n}' is not because it has an odd number of segments (${n.length}).`);return l_(e,new Pe(n))}if(r instanceof Wr)return l_(e,r._key);throw new be(ge.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${Qd(r)}.`)}function W_(e,t){if(!Array.isArray(e)||e.length===0)throw new be(ge.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${t.toString()}' filters.`)}function HS(e,t){const r=function(s,a){for(const i of s)for(const o of i.getFlattenedFilters())if(a.indexOf(o.op)>=0)return o.op;return null}(e.filters,function(s){switch(s){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(t.op));if(r!==null)throw r===t.op?new be(ge.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${t.op.toString()}' filter.`):new be(ge.INVALID_ARGUMENT,`Invalid query. You cannot use '${t.op.toString()}' filters with '${r.toString()}' filters.`)}class zM{convertValue(t,r="none"){switch(Ji(t)){case 0:return null;case 1:return t.booleanValue;case 2:return Gt(t.integerValue||t.doubleValue);case 3:return this.convertTimestamp(t.timestampValue);case 4:return this.convertServerTimestamp(t,r);case 5:return t.stringValue;case 6:return this.convertBytes(Qi(t.bytesValue));case 7:return this.convertReference(t.referenceValue);case 8:return this.convertGeoPoint(t.geoPointValue);case 9:return this.convertArray(t.arrayValue,r);case 11:return this.convertObject(t.mapValue,r);case 10:return this.convertVectorValue(t.mapValue);default:throw je()}}convertObject(t,r){return this.convertObjectMap(t.fields,r)}convertObjectMap(t,r="none"){const n={};return ao(t,(s,a)=>{n[s]=this.convertValue(a,r)}),n}convertVectorValue(t){var r,n,s;const a=(s=(n=(r=t.fields)===null||r===void 0?void 0:r.value.arrayValue)===null||n===void 0?void 0:n.values)===null||s===void 0?void 0:s.map(i=>Gt(i.doubleValue));return new Ux(a)}convertGeoPoint(t){return new jx(Gt(t.latitude),Gt(t.longitude))}convertArray(t,r){return(t.values||[]).map(n=>this.convertValue(n,r))}convertServerTimestamp(t,r){switch(r){case"previous":const n=mx(t);return n==null?null:this.convertValue(n,r);case"estimate":return this.convertTimestamp(nu(t));default:return null}}convertTimestamp(t){const r=ui(t);return new lr(r.seconds,r.nanos)}convertDocumentKey(t,r){const n=Nt.fromString(t);xt(pS(n));const s=new su(n.get(1),n.get(3)),a=new Pe(n.popFirst(5));return s.isEqual(r)||va(`Document ${a} contains a document reference within a different database (${s.projectId}/${s.database}) which is not supported. It will be treated as a reference in the current database (${r.projectId}/${r.database}) instead.`),a}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function GS(e,t,r){let n;return n=e?r&&(r.merge||r.mergeFields)?e.toFirestore(t,r):e.toFirestore(t):t,n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ic{constructor(t,r){this.hasPendingWrites=t,this.fromCache=r}isEqual(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache}}class KS extends zS{constructor(t,r,n,s,a,i){super(t,r,n,s,i),this._firestore=t,this._firestoreImpl=t,this.metadata=a}exists(){return super.exists()}data(t={}){if(this._document){if(this._converter){const r=new uh(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(r,t)}return this._userDataWriter.convertValue(this._document.data.value,t.serverTimestamps)}}get(t,r={}){if(this._document){const n=this._document.data.field(Hx("DocumentSnapshot.get",t));if(n!==null)return this._userDataWriter.convertValue(n,r.serverTimestamps)}}}class uh extends KS{data(t={}){return super.data(t)}}class qS{constructor(t,r,n,s){this._firestore=t,this._userDataWriter=r,this._snapshot=s,this.metadata=new ic(s.hasPendingWrites,s.fromCache),this.query=n}get docs(){const t=[];return this.forEach(r=>t.push(r)),t}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(t,r){this._snapshot.docs.forEach(n=>{t.call(r,new uh(this._firestore,this._userDataWriter,n.key,n,new ic(this._snapshot.mutatedKeys.has(n.key),this._snapshot.fromCache),this.query.converter))})}docChanges(t={}){const r=!!t.includeMetadataChanges;if(r&&this._snapshot.excludesMetadataChanges)throw new be(ge.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===r||(this._cachedChanges=function(s,a){if(s._snapshot.oldDocs.isEmpty()){let i=0;return s._snapshot.docChanges.map(o=>{const l=new uh(s._firestore,s._userDataWriter,o.doc.key,o.doc,new ic(s._snapshot.mutatedKeys.has(o.doc.key),s._snapshot.fromCache),s.query.converter);return o.doc,{type:"added",doc:l,oldIndex:-1,newIndex:i++}})}{let i=s._snapshot.oldDocs;return s._snapshot.docChanges.filter(o=>a||o.type!==3).map(o=>{const l=new uh(s._firestore,s._userDataWriter,o.doc.key,o.doc,new ic(s._snapshot.mutatedKeys.has(o.doc.key),s._snapshot.fromCache),s.query.converter);let c=-1,f=-1;return o.type!==0&&(c=i.indexOf(o.doc.key),i=i.delete(o.doc.key)),o.type!==1&&(i=i.add(o.doc),f=i.indexOf(o.doc.key)),{type:$M(o.type),doc:l,oldIndex:c,newIndex:f}})}}(this,r),this._cachedChangesIncludeMetadataChanges=r),this._cachedChanges}}function $M(e){switch(e){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return je()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Nn(e){e=xn(e,Wr);const t=xn(e.firestore,_a);return NM(Zd(t),e._key).then(r=>YS(t,e,r))}class qx extends zM{constructor(t){super(),this.firestore=t}convertBytes(t){return new xl(t)}convertReference(t){const r=this.convertDocumentKey(t,this.firestore._databaseId);return new Wr(this.firestore,null,r)}}function zt(e){e=xn(e,oo);const t=xn(e.firestore,_a),r=Zd(t),n=new qx(t);return $S(e._query),CM(r,e._query).then(s=>new qS(t,n,e,s))}function qn(e,t,r){e=xn(e,Wr);const n=xn(e.firestore,_a),s=GS(e.converter,t,r);return s0(n,[US(t0(n),"setDoc",e._key,s,e.converter!==null,r).toMutation(e._key,Hn.none())])}function hi(e,t,r,...n){e=xn(e,Wr);const s=xn(e.firestore,_a),a=t0(s);let i;return i=typeof(t=qt(t))=="string"||t instanceof e0?jM(a,"updateDoc",e._key,t,r,n):LM(a,"updateDoc",e._key,t),s0(s,[i.toMutation(e._key,Hn.exists(!0))])}function HM(e){return s0(xn(e.firestore,_a),[new yx(e._key,Hn.none())])}function Wu(e,t){const r=xn(e.firestore,_a),n=Ft(e),s=GS(e.converter,t);return s0(r,[US(t0(e.firestore),"addDoc",n._key,s,e.converter!==null,{}).toMutation(n._key,Hn.exists(!1))]).then(()=>n)}function GM(e,...t){var r,n,s;e=qt(e);let a={includeMetadataChanges:!1,source:"default"},i=0;typeof t[i]!="object"||V_(t[i])||(a=t[i],i++);const o={includeMetadataChanges:a.includeMetadataChanges,source:a.source};if(V_(t[i])){const d=t[i];t[i]=(r=d.next)===null||r===void 0?void 0:r.bind(d),t[i+1]=(n=d.error)===null||n===void 0?void 0:n.bind(d),t[i+2]=(s=d.complete)===null||s===void 0?void 0:s.bind(d)}let l,c,f;if(e instanceof Wr)c=xn(e.firestore,_a),f=Wd(e._key.path),l={next:d=>{t[i]&&t[i](YS(c,e,d))},error:t[i+1],complete:t[i+2]};else{const d=xn(e,oo);c=xn(d.firestore,_a),f=d._query;const m=new qx(c);l={next:p=>{t[i]&&t[i](new qS(c,m,d,p))},error:t[i+1],complete:t[i+2]},$S(e._query)}return function(m,p,x,g){const w=new Lx(g),k=new Ox(p,w,x);return m.asyncQueue.enqueueAndForget(async()=>Px(await ed(m),k)),()=>{w.Za(),m.asyncQueue.enqueueAndForget(async()=>Dx(await ed(m),k))}}(Zd(c),f,o,l)}function s0(e,t){return function(n,s){const a=new oa;return n.asyncQueue.enqueueAndForget(async()=>xM(await IM(n),s,a)),a.promise}(Zd(e),t)}function YS(e,t,r){const n=r.docs.get(t._key),s=new qx(e);return new KS(e,s,t._key,n,new ic(r.hasPendingWrites,r.fromCache),t.converter)}function KM(){return new Bx("serverTimestamp")}function qM(e){return new Wx("increment",e)}(function(t,r=!0){(function(s){Sl=s})(so),li(new pa("firestore",(n,{instanceIdentifier:s,options:a})=>{const i=n.getProvider("app").getImmediate(),o=new _a(new Q3(n.getProvider("auth-internal")),new tF(n.getProvider("app-check-internal")),function(c,f){if(!Object.prototype.hasOwnProperty.apply(c.options,["projectId"]))throw new be(ge.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new su(c.options.projectId,f)}(i,s),i);return a=Object.assign({useFetchStreams:r},a),o._setSettings(a),o},"PUBLIC").setMultipleInstances(!0)),$n(n_,"4.7.3",t),$n(n_,"4.7.3","esm2017")})();var YM="firebase",XM="10.14.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */$n(YM,XM,"app");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const XS="firebasestorage.googleapis.com",QM="storageBucket",JM=2*60*1e3,ZM=10*60*1e3;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Us extends js{constructor(t,r,n=0){super(rm(t),`Firebase Storage: ${r} (${rm(t)})`),this.status_=n,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,Us.prototype)}get status(){return this.status_}set status(t){this.status_=t}_codeEquals(t){return rm(t)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(t){this.customData.serverResponse=t,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}var Ds;(function(e){e.UNKNOWN="unknown",e.OBJECT_NOT_FOUND="object-not-found",e.BUCKET_NOT_FOUND="bucket-not-found",e.PROJECT_NOT_FOUND="project-not-found",e.QUOTA_EXCEEDED="quota-exceeded",e.UNAUTHENTICATED="unauthenticated",e.UNAUTHORIZED="unauthorized",e.UNAUTHORIZED_APP="unauthorized-app",e.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",e.INVALID_CHECKSUM="invalid-checksum",e.CANCELED="canceled",e.INVALID_EVENT_NAME="invalid-event-name",e.INVALID_URL="invalid-url",e.INVALID_DEFAULT_BUCKET="invalid-default-bucket",e.NO_DEFAULT_BUCKET="no-default-bucket",e.CANNOT_SLICE_BLOB="cannot-slice-blob",e.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",e.NO_DOWNLOAD_URL="no-download-url",e.INVALID_ARGUMENT="invalid-argument",e.INVALID_ARGUMENT_COUNT="invalid-argument-count",e.APP_DELETED="app-deleted",e.INVALID_ROOT_OPERATION="invalid-root-operation",e.INVALID_FORMAT="invalid-format",e.INTERNAL_ERROR="internal-error",e.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})(Ds||(Ds={}));function rm(e){return"storage/"+e}function eL(){const e="An unknown error occurred, please check the error payload for server response.";return new Us(Ds.UNKNOWN,e)}function tL(){return new Us(Ds.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function rL(){return new Us(Ds.CANCELED,"User canceled the upload/download.")}function nL(e){return new Us(Ds.INVALID_URL,"Invalid URL '"+e+"'.")}function sL(e){return new Us(Ds.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+e+"'.")}function z_(e){return new Us(Ds.INVALID_ARGUMENT,e)}function QS(){return new Us(Ds.APP_DELETED,"The Firebase app was deleted.")}function aL(e){return new Us(Ds.INVALID_ROOT_OPERATION,"The operation '"+e+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ls{constructor(t,r){this.bucket=t,this.path_=r}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const t=encodeURIComponent;return"/b/"+t(this.bucket)+"/o/"+t(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(t,r){let n;try{n=ls.makeFromUrl(t,r)}catch{return new ls(t,"")}if(n.path==="")return n;throw sL(t)}static makeFromUrl(t,r){let n=null;const s="([A-Za-z0-9.\\-_]+)";function a(I){I.path.charAt(I.path.length-1)==="/"&&(I.path_=I.path_.slice(0,-1))}const i="(/(.*))?$",o=new RegExp("^gs://"+s+i,"i"),l={bucket:1,path:3};function c(I){I.path_=decodeURIComponent(I.path)}const f="v[A-Za-z0-9_]+",d=r.replace(/[.]/g,"\\."),m="(/([^?#]*).*)?$",p=new RegExp(`^https?://${d}/${f}/b/${s}/o${m}`,"i"),x={bucket:1,path:3},g=r===XS?"(?:storage.googleapis.com|storage.cloud.google.com)":r,w="([^?#]*)",k=new RegExp(`^https?://${g}/${s}/${w}`,"i"),y=[{regex:o,indices:l,postModify:a},{regex:p,indices:x,postModify:c},{regex:k,indices:{bucket:1,path:2},postModify:c}];for(let I=0;I<y.length;I++){const M=y[I],O=M.regex.exec(t);if(O){const v=O[M.indices.bucket];let T=O[M.indices.path];T||(T=""),n=new ls(v,T),M.postModify(n);break}}if(n==null)throw nL(t);return n}}class iL{constructor(t){this.promise_=Promise.reject(t)}getPromise(){return this.promise_}cancel(t=!1){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function oL(e,t,r){let n=1,s=null,a=null,i=!1,o=0;function l(){return o===2}let c=!1;function f(...w){c||(c=!0,t.apply(null,w))}function d(w){s=setTimeout(()=>{s=null,e(p,l())},w)}function m(){a&&clearTimeout(a)}function p(w,...k){if(c){m();return}if(w){m(),f.call(null,w,...k);return}if(l()||i){m(),f.call(null,w,...k);return}n<64&&(n*=2);let y;o===1?(o=2,y=0):y=(n+Math.random())*1e3,d(y)}let x=!1;function g(w){x||(x=!0,m(),!c&&(s!==null?(w||(o=2),clearTimeout(s),d(0)):w||(o=1)))}return d(0),a=setTimeout(()=>{i=!0,g(!0)},r),g}function lL(e){e(!1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cL(e){return e!==void 0}function $_(e,t,r,n){if(n<t)throw z_(`Invalid value for '${e}'. Expected ${t} or greater.`);if(n>r)throw z_(`Invalid value for '${e}'. Expected ${r} or less.`)}function uL(e){const t=encodeURIComponent;let r="?";for(const n in e)if(e.hasOwnProperty(n)){const s=t(n)+"="+t(e[n]);r=r+s+"&"}return r=r.slice(0,-1),r}var rd;(function(e){e[e.NO_ERROR=0]="NO_ERROR",e[e.NETWORK_ERROR=1]="NETWORK_ERROR",e[e.ABORT=2]="ABORT"})(rd||(rd={}));/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fL(e,t){const r=e>=500&&e<600,s=[408,429].indexOf(e)!==-1,a=t.indexOf(e)!==-1;return r||s||a}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hL{constructor(t,r,n,s,a,i,o,l,c,f,d,m=!0){this.url_=t,this.method_=r,this.headers_=n,this.body_=s,this.successCodes_=a,this.additionalRetryCodes_=i,this.callback_=o,this.errorCallback_=l,this.timeout_=c,this.progressCallback_=f,this.connectionFactory_=d,this.retry=m,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((p,x)=>{this.resolve_=p,this.reject_=x,this.start_()})}start_(){const t=(n,s)=>{if(s){n(!1,new Df(!1,null,!0));return}const a=this.connectionFactory_();this.pendingConnection_=a;const i=o=>{const l=o.loaded,c=o.lengthComputable?o.total:-1;this.progressCallback_!==null&&this.progressCallback_(l,c)};this.progressCallback_!==null&&a.addUploadProgressListener(i),a.send(this.url_,this.method_,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&a.removeUploadProgressListener(i),this.pendingConnection_=null;const o=a.getErrorCode()===rd.NO_ERROR,l=a.getStatus();if(!o||fL(l,this.additionalRetryCodes_)&&this.retry){const f=a.getErrorCode()===rd.ABORT;n(!1,new Df(!1,null,f));return}const c=this.successCodes_.indexOf(l)!==-1;n(!0,new Df(c,a))})},r=(n,s)=>{const a=this.resolve_,i=this.reject_,o=s.connection;if(s.wasSuccessCode)try{const l=this.callback_(o,o.getResponse());cL(l)?a(l):a()}catch(l){i(l)}else if(o!==null){const l=eL();l.serverResponse=o.getErrorText(),this.errorCallback_?i(this.errorCallback_(o,l)):i(l)}else if(s.canceled){const l=this.appDelete_?QS():rL();i(l)}else{const l=tL();i(l)}};this.canceled_?r(!1,new Df(!1,null,!0)):this.backoffId_=oL(t,r,this.timeout_)}getPromise(){return this.promise_}cancel(t){this.canceled_=!0,this.appDelete_=t||!1,this.backoffId_!==null&&lL(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}}class Df{constructor(t,r,n){this.wasSuccessCode=t,this.connection=r,this.canceled=!!n}}function dL(e,t){t!==null&&t.length>0&&(e.Authorization="Firebase "+t)}function mL(e,t){e["X-Firebase-Storage-Version"]="webjs/"+(t??"AppManager")}function pL(e,t){t&&(e["X-Firebase-GMPID"]=t)}function gL(e,t){t!==null&&(e["X-Firebase-AppCheck"]=t)}function xL(e,t,r,n,s,a,i=!0){const o=uL(e.urlParams),l=e.url+o,c=Object.assign({},e.headers);return pL(c,t),dL(c,r),mL(c,a),gL(c,n),new hL(l,e.method,c,e.body,e.successCodes,e.additionalRetryCodes,e.handler,e.errorHandler,e.timeout,e.progressCallback,s,i)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vL(e){if(e.length===0)return null;const t=e.lastIndexOf("/");return t===-1?"":e.slice(0,t)}function yL(e){const t=e.lastIndexOf("/",e.length-2);return t===-1?e:e.slice(t+1)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nd{constructor(t,r){this._service=t,r instanceof ls?this._location=r:this._location=ls.makeFromUrl(r,t.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(t,r){return new nd(t,r)}get root(){const t=new ls(this._location.bucket,"");return this._newRef(this._service,t)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return yL(this._location.path)}get storage(){return this._service}get parent(){const t=vL(this._location.path);if(t===null)return null;const r=new ls(this._location.bucket,t);return new nd(this._service,r)}_throwIfRoot(t){if(this._location.path==="")throw aL(t)}}function H_(e,t){const r=t==null?void 0:t[QM];return r==null?null:ls.makeFromBucketSpec(r,e)}function _L(e,t,r,n={}){e.host=`${t}:${r}`,e._protocol="http";const{mockUserToken:s}=n;s&&(e._overrideAuthToken=typeof s=="string"?s:WT(s,e.app.options.projectId))}class wL{constructor(t,r,n,s,a){this.app=t,this._authProvider=r,this._appCheckProvider=n,this._url=s,this._firebaseVersion=a,this._bucket=null,this._host=XS,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=JM,this._maxUploadRetryTime=ZM,this._requests=new Set,s!=null?this._bucket=ls.makeFromBucketSpec(s,this._host):this._bucket=H_(this._host,this.app.options)}get host(){return this._host}set host(t){this._host=t,this._url!=null?this._bucket=ls.makeFromBucketSpec(this._url,t):this._bucket=H_(t,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(t){$_("time",0,Number.POSITIVE_INFINITY,t),this._maxUploadRetryTime=t}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(t){$_("time",0,Number.POSITIVE_INFINITY,t),this._maxOperationRetryTime=t}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const t=this._authProvider.getImmediate({optional:!0});if(t){const r=await t.getToken();if(r!==null)return r.accessToken}return null}async _getAppCheckToken(){const t=this._appCheckProvider.getImmediate({optional:!0});return t?(await t.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(t=>t.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(t){return new nd(this,t)}_makeRequest(t,r,n,s,a=!0){if(this._deleted)return new iL(QS());{const i=xL(t,this._appId,n,s,r,this._firebaseVersion,a);return this._requests.add(i),i.getPromise().then(()=>this._requests.delete(i),()=>this._requests.delete(i)),i}}async makeRequestWithTokens(t,r){const[n,s]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(t,r,n,s).getPromise()}}const G_="@firebase/storage",K_="0.13.2";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const JS="storage";function EL(e=Ld(),t){e=qt(e);const n=Cu(e,JS).getImmediate({identifier:t}),s=Qg("storage");return s&&TL(n,...s),n}function TL(e,t,r,n={}){_L(e,t,r,n)}function kL(e,{instanceIdentifier:t}){const r=e.getProvider("app").getImmediate(),n=e.getProvider("auth-internal"),s=e.getProvider("app-check-internal");return new wL(r,n,s,t,so)}function SL(){li(new pa(JS,kL,"PUBLIC").setMultipleInstances(!0)),$n(G_,K_,""),$n(G_,K_,"esm2017")}SL();/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ZS="functions";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AL{constructor(t,r,n){this.auth=null,this.messaging=null,this.appCheck=null,this.auth=t.getImmediate({optional:!0}),this.messaging=r.getImmediate({optional:!0}),this.auth||t.get().then(s=>this.auth=s,()=>{}),this.messaging||r.get().then(s=>this.messaging=s,()=>{}),this.appCheck||n.get().then(s=>this.appCheck=s,()=>{})}async getAuthToken(){if(this.auth)try{const t=await this.auth.getToken();return t==null?void 0:t.accessToken}catch{return}}async getMessagingToken(){if(!(!this.messaging||!("Notification"in self)||Notification.permission!=="granted"))try{return await this.messaging.getToken()}catch{return}}async getAppCheckToken(t){if(this.appCheck){const r=t?await this.appCheck.getLimitedUseToken():await this.appCheck.getToken();return r.error?null:r.token}return null}async getContext(t){const r=await this.getAuthToken(),n=await this.getMessagingToken(),s=await this.getAppCheckToken(t);return{authToken:r,messagingToken:n,appCheckToken:s}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Mp="us-central1";class IL{constructor(t,r,n,s,a=Mp,i){this.app=t,this.fetchImpl=i,this.emulatorOrigin=null,this.contextProvider=new AL(r,n,s),this.cancelAllRequests=new Promise(o=>{this.deleteService=()=>Promise.resolve(o())});try{const o=new URL(a);this.customDomain=o.origin+(o.pathname==="/"?"":o.pathname),this.region=Mp}catch{this.customDomain=null,this.region=a}}_delete(){return this.deleteService()}_url(t){const r=this.app.options.projectId;return this.emulatorOrigin!==null?`${this.emulatorOrigin}/${r}/${this.region}/${t}`:this.customDomain!==null?`${this.customDomain}/${t}`:`https://${this.region}-${r}.cloudfunctions.net/${t}`}}function NL(e,t,r){e.emulatorOrigin=`http://${t}:${r}`}const q_="@firebase/functions",Y_="0.11.8";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const CL="auth-internal",bL="app-check-internal",RL="messaging-internal";function PL(e,t){const r=(n,{instanceIdentifier:s})=>{const a=n.getProvider("app").getImmediate(),i=n.getProvider(CL),o=n.getProvider(RL),l=n.getProvider(bL);return new IL(a,i,o,l,s,e)};li(new pa(ZS,r,"PUBLIC").setMultipleInstances(!0)),$n(q_,Y_,t),$n(q_,Y_,"esm2017")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function DL(e=Ld(),t=Mp){const n=Cu(qt(e),ZS).getImmediate({identifier:t}),s=Qg("functions");return s&&FL(n,...s),n}function FL(e,t,r){NL(qt(e),t,r)}PL(fetch.bind(self));const OL={apiKey:"AIzaSyD5-h96WDy4SzuP1XqClyBbpd1CL_tNZQw",authDomain:"my-xmas-movies.firebaseapp.com",projectId:"my-xmas-movies",storageBucket:"my-xmas-movies.firebasestorage.app",messagingSenderId:"534280822678",appId:"1:534280822678:web:5e91b52cb61b7ed71a47b7"},a0=HT(OL),Sc=K3(a0),eA=new Ss;eA.setCustomParameters({prompt:"select_account"});const ML=eA,Me=PM(a0);EL(a0);DL(a0);const tA=z.createContext(void 0),Dn=()=>{const e=z.useContext(tA);if(e===void 0)throw new Error("useAuth must be used within an AuthProvider");return e},LL=({children:e})=>{const[t,r]=z.useState(null),[n,s]=z.useState(null),[a,i]=z.useState(!0),[o,l]=z.useState(null);z.useEffect(()=>{const m=pk(Sc,async p=>{if(r(p),l(null),p)try{const x=Ft(Me,"users",p.uid),g=await Nn(x);if(g.exists())await qn(x,{lastLoginAt:KM()},{merge:!0}),s(g.data());else{const w={email:p.email||"",displayName:p.displayName||"User",photoURL:p.photoURL||void 0,createdAt:new Date,lastLoginAt:new Date};await qn(x,w),s({id:p.uid,...w})}}catch(x){console.error("Error fetching user profile:",x),l("Failed to load user profile")}else s(null);i(!1)});return()=>m()},[]);const d={currentUser:t,userProfile:n,isLoading:a,error:o,signInWithGoogle:async()=>{try{l(null),i(!0);const m=new Ss;await Ak(Sc,m)}catch(m){console.error("Login error:",m),l(m.message||"Failed to sign in")}finally{i(!1)}},signOut:async()=>{try{await LD(Sc)}catch(m){console.error("Sign out error:",m),l(m.message||"Failed to sign out")}}};return u.jsx(tA.Provider,{value:d,children:e})},zu=()=>{const[e,t]=z.useState(!1),[r,n]=z.useState(!0),[s,a]=z.useState(null),[i,o]=z.useState(null);return z.useEffect(()=>{const l=pk(Sc,async c=>{if(n(!0),a(null),!c){t(!1),o(null),n(!1);return}o({uid:c.uid,email:c.email});try{const d=(await ek(c,!0)).claims.admin===!0;t(d)}catch(f){console.error("Error checking admin status:",f),a("Failed to verify admin status"),t(!1)}finally{n(!1)}});return()=>l()},[]),{isAdmin:e,loading:r,error:s,currentUser:i}},jL=({snowflakeCount:e=100,mobileSnowflakeCount:t=50})=>{const[r,n]=z.useState(!1),[s,a]=z.useState(e),i=z.useRef(null),o=z.useRef([]),l=z.useRef(0);return z.useEffect(()=>{const c=()=>{const f=window.matchMedia("(max-width: 768px)").matches;n(f),a(f?t:e)};return c(),window.addEventListener("resize",c),()=>{window.removeEventListener("resize",c)}},[e,t]),z.useEffect(()=>{const c=i.current;if(!c)return;const f=c.getContext("2d");if(!f)return;const d=()=>{c.width=window.innerWidth,c.height=window.innerHeight},m=()=>{o.current=[];for(let w=0;w<s;w++)o.current.push({x:Math.random()*c.width,y:Math.random()*c.height,size:r?Math.random()*3+1:Math.random()*4+1,speed:r?Math.random()*.8+.3:Math.random()*1+.5,opacity:r?Math.random()*.5+.2:Math.random()*.6+.3,wind:r?Math.random()*.3-.15:Math.random()*.5-.25})},p=w=>{f.beginPath(),f.arc(w.x,w.y,w.size,0,Math.PI*2),f.fillStyle=`rgba(255, 255, 255, ${w.opacity})`,f.fill()},x=w=>{w.y+=w.speed,w.x+=w.wind,w.y>c.height&&(w.y=-10,w.x=Math.random()*c.width),w.x>c.width?w.x=0:w.x<0&&(w.x=c.width)},g=()=>{f.clearRect(0,0,c.width,c.height),o.current.forEach(w=>{p(w),x(w)}),l.current=requestAnimationFrame(g)};return window.addEventListener("resize",d),d(),m(),g(),()=>{window.removeEventListener("resize",d),cancelAnimationFrame(l.current)}},[s]),u.jsx("canvas",{ref:i,className:"fixed top-0 left-0 w-full h-full pointer-events-none z-10","aria-hidden":"true"})},UL=()=>{const[e,t]=z.useState(!1),[r,n]=z.useState(null),[s,a]=z.useState(!1);z.useEffect(()=>{const l=/iPad|iPhone|iPod/.test(navigator.userAgent)&&!window.MSStream;a(l);const c=f=>{f.preventDefault(),n(f),t(!0)};return window.addEventListener("beforeinstallprompt",c),window.matchMedia("(display-mode: standalone)").matches&&t(!1),()=>{window.removeEventListener("beforeinstallprompt",c)}},[]);const i=async()=>{if(!r)return;r.prompt();const{outcome:l}=await r.userChoice;n(null),t(!1),console.log(`User ${l==="accepted"?"accepted":"dismissed"} the install prompt`)},o=()=>{t(!1),localStorage.setItem("installPromptDismissed","true")};return e?u.jsxs("div",{className:"fixed bottom-0 left-0 right-0 bg-green-800 text-white p-4 shadow-lg z-50 flex items-center justify-between",children:[u.jsxs("div",{className:"flex items-center",children:[u.jsx("div",{className:"mr-3 text-2xl",children:u.jsx("i",{className:"fas fa-gift"})}),u.jsx("div",{children:s?u.jsxs("p",{children:["Install this app on your device: tap ",u.jsx("i",{className:"fas fa-share"}),' and then "Add to Home Screen"']}):u.jsx("p",{children:"Add Christmas Movies to your home screen!"})})]}),u.jsxs("div",{className:"flex items-center",children:[!s&&u.jsx("button",{onClick:i,className:"bg-red-700 hover:bg-red-800 text-white py-1 px-4 rounded-full mr-2",children:"Install"}),u.jsx("button",{onClick:o,className:"bg-transparent hover:bg-green-700 text-white py-1 px-2 rounded-full",children:u.jsx("i",{className:"fas fa-times"})})]})]}):null};function VL(){const{currentUser:e}=Dn(),{isAdmin:t}=zu(),[r,n]=z.useState(!1),s=Ms();z.useEffect(()=>(r?document.body.style.overflow="hidden":document.body.style.overflow="",()=>{document.body.style.overflow=""}),[r]),z.useEffect(()=>{r&&n(!1)},[s.pathname]);const a=()=>{n(!r)};return u.jsxs("div",{className:"min-h-screen bg-gradient-to-b from-xmas-bg to-xmas-card bg-opacity-95",children:[u.jsx(jL,{snowflakeCount:150,mobileSnowflakeCount:40}),u.jsx(UL,{}),u.jsxs("div",{className:"navbar bg-gradient-to-r from-xmas-card via-xmas-card to-xmas-bg border-b border-xmas-gold px-2 sm:px-4 shadow-lg relative overflow-hidden",children:[u.jsx("div",{className:"absolute top-0 left-0 w-full h-1 bg-gradient-to-r from-xmas-gold via-transparent to-xmas-gold opacity-60"}),u.jsx("div",{className:"absolute -bottom-4 left-0 right-0 h-8 snow-accumulation-fast"}),u.jsxs("div",{className:"flex items-center",children:[u.jsx("button",{className:"btn btn-ghost btn-sm md:hidden relative z-10",onClick:a,"aria-label":"Toggle navigation menu",children:u.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",className:"inline-block w-5 h-5 stroke-current",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M4 6h16M4 12h16M4 18h16"})})}),u.jsxs(Xe,{to:"/",className:"hidden sm:flex items-center group",children:[u.jsxs("div",{className:"relative",children:[u.jsx("div",{className:"absolute -inset-1 bg-gradient-to-r from-xmas-gold to-xmas-line rounded-full opacity-70 group-hover:opacity-100 blur transition duration-200"}),u.jsx("div",{className:"relative flex items-center justify-center w-10 h-10 bg-xmas-card rounded-full border border-xmas-gold overflow-hidden",children:u.jsx("img",{src:"/Santa.png",alt:"Santa",className:"w-full h-full object-cover group-hover:scale-110 transition-transform duration-300"})})]}),u.jsx("div",{className:"ml-3 font-christmas text-xl sm:text-2xl bg-gradient-to-br from-xmas-gold via-xmas-snow to-xmas-gold bg-clip-text text-transparent font-bold",children:"Christmas Movies"})]}),u.jsxs(Xe,{to:"/",className:"sm:hidden flex items-center",children:[u.jsx("div",{className:"w-8 h-8 flex items-center justify-center rounded-full bg-xmas-card border border-xmas-gold overflow-hidden",children:u.jsx("img",{src:"/Santa.png",alt:"Santa",className:"w-full h-full object-cover"})}),u.jsx("span",{className:"ml-2 font-christmas text-lg text-xmas-gold",children:"Christmas Movies"})]})]}),u.jsx("div",{className:"flex-1"}),u.jsxs("div",{className:"flex items-center gap-1 sm:gap-2",children:[e&&u.jsxs(Xe,{to:"/profile",className:"btn btn-primary btn-sm hidden md:flex",children:[u.jsx("i",{className:"fas fa-user-circle mr-1"})," Profile"]}),e?u.jsxs("div",{className:"dropdown dropdown-end",children:[u.jsx("label",{tabIndex:0,className:"btn btn-ghost btn-circle avatar cursor-pointer",children:u.jsx("div",{className:"w-10 rounded-full border border-xmas-gold",children:e.photoURL?u.jsx("img",{src:e.photoURL,alt:"Profile"}):u.jsx("div",{className:"bg-xmas-card flex items-center justify-center h-full",children:u.jsx("i",{className:"fas fa-user text-xmas-gold"})})})}),u.jsxs("ul",{tabIndex:0,className:"dropdown-content menu menu-sm mt-3 z-[1] p-2 shadow bg-xmas-card rounded-box w-52 border border-xmas-gold",children:[u.jsx("li",{children:u.jsxs(Xe,{to:"/profile",className:"justify-between",children:["Profile",u.jsx("i",{className:"fas fa-user-circle"})]})}),u.jsx("li",{children:u.jsxs(Xe,{to:"/movies",children:["My Movies",u.jsx("i",{className:"fas fa-film"})]})}),u.jsx("li",{children:u.jsxs(Xe,{to:"/random",children:["Random Movie",u.jsx("i",{className:"fas fa-random"})]})}),u.jsx("li",{children:u.jsxs(Xe,{to:"/import",children:["Import Movies",u.jsx("i",{className:"fas fa-file-import"})]})}),t&&u.jsx("li",{children:u.jsxs(Xe,{to:"/admin",className:"text-xmas-gold",children:["Admin Dashboard",u.jsx("i",{className:"fas fa-crown"})]})})]})]}):u.jsxs(Xe,{to:"/login",className:"btn btn-primary btn-sm",children:[u.jsx("i",{className:"fas fa-sign-in-alt mr-1"})," Sign In"]})]})]}),u.jsx("div",{className:`fixed inset-0 bg-black bg-opacity-70 z-20 transition-opacity duration-300 md:hidden ${r?"opacity-100":"opacity-0 pointer-events-none"}`,onClick:a}),u.jsxs("div",{className:`fixed top-0 left-0 h-full w-72 bg-gradient-to-b from-xmas-bg to-xmas-card border-r border-xmas-gold z-30 transform transition-transform duration-300 ease-in-out md:hidden shadow-xl ${r?"translate-x-0":"-translate-x-full"}`,children:[u.jsxs("div",{className:"relative overflow-hidden",children:[u.jsx("div",{className:"absolute top-0 left-0 w-full h-1 bg-gradient-to-r from-xmas-gold via-transparent to-xmas-gold opacity-60"}),u.jsxs("div",{className:"flex justify-between items-center p-4 border-b border-xmas-gold bg-xmas-card bg-opacity-80",children:[u.jsxs("div",{className:"flex items-center",children:[u.jsx("div",{className:"w-9 h-9 flex items-center justify-center rounded-full bg-xmas-card border border-xmas-gold shadow-lg overflow-hidden",children:u.jsx("img",{src:"/Santa.png",alt:"Santa",className:"w-full h-full object-cover"})}),u.jsx("div",{className:"ml-3 font-christmas text-xl bg-gradient-to-br from-xmas-gold via-xmas-snow to-xmas-gold bg-clip-text text-transparent font-bold",children:"Christmas Movies"})]}),u.jsx("button",{className:"btn btn-ghost btn-sm text-xmas-text hover:text-xmas-line",onClick:a,"aria-label":"Close navigation menu",children:u.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})]}),u.jsx("div",{className:"overflow-y-auto h-full pb-20",children:u.jsx("div",{className:"p-4 pt-6",children:u.jsxs("div",{className:"mb-6",children:[u.jsx("h3",{className:"font-christmas text-xl text-xmas-gold mb-4 pl-2 border-l-2 border-xmas-line",children:"Navigation"}),u.jsxs("ul",{className:"space-y-3",children:[u.jsx("li",{children:u.jsx(Ca,{to:"/",onClick:a,className:({isActive:i})=>i?"flex items-center p-2 pl-3 rounded-md bg-gradient-to-r from-xmas-card to-transparent border-l-2 border-xmas-gold text-xmas-gold font-medium":"flex items-center p-2 pl-3 rounded-md hover:bg-xmas-card hover:bg-opacity-50 text-xmas-text hover:text-xmas-gold transition-all duration-200",children:({isActive:i})=>u.jsxs(u.Fragment,{children:[u.jsx("i",{className:"fas fa-home mr-3 text-xmas-gold"}),u.jsx("span",{children:"Home"}),u.jsx("i",{className:`fas fa-snowflake ml-auto text-xmas-gold opacity-70 ${i?"visible":"invisible"}`})]})})}),e?u.jsxs(u.Fragment,{children:[u.jsx("li",{children:u.jsx(Ca,{to:"/movies",onClick:a,className:({isActive:i})=>i?"flex items-center p-2 pl-3 rounded-md bg-gradient-to-r from-xmas-card to-transparent border-l-2 border-xmas-gold text-xmas-gold font-medium":"flex items-center p-2 pl-3 rounded-md hover:bg-xmas-card hover:bg-opacity-50 text-xmas-text hover:text-xmas-gold transition-all duration-200",children:({isActive:i})=>u.jsxs(u.Fragment,{children:[u.jsx("i",{className:"fas fa-film mr-3 text-xmas-gold"}),u.jsx("span",{children:"My Movies"}),u.jsx("i",{className:`fas fa-snowflake ml-auto text-xmas-gold opacity-70 ${i?"visible":"invisible"}`})]})})}),u.jsx("li",{children:u.jsx(Ca,{to:"/random",onClick:a,className:({isActive:i})=>i?"flex items-center p-2 pl-3 rounded-md bg-gradient-to-r from-xmas-card to-transparent border-l-2 border-xmas-gold text-xmas-gold font-medium":"flex items-center p-2 pl-3 rounded-md hover:bg-xmas-card hover:bg-opacity-50 text-xmas-text hover:text-xmas-gold transition-all duration-200",children:({isActive:i})=>u.jsxs(u.Fragment,{children:[u.jsx("i",{className:"fas fa-random mr-3 text-xmas-gold"}),u.jsx("span",{children:"Random Movie"}),u.jsx("i",{className:`fas fa-snowflake ml-auto text-xmas-gold opacity-70 ${i?"visible":"invisible"}`})]})})}),u.jsx("li",{children:u.jsx(Ca,{to:"/achievements",onClick:a,className:({isActive:i})=>i?"flex items-center p-2 pl-3 rounded-md bg-gradient-to-r from-xmas-card to-transparent border-l-2 border-xmas-gold text-xmas-gold font-medium":"flex items-center p-2 pl-3 rounded-md hover:bg-xmas-card hover:bg-opacity-50 text-xmas-text hover:text-xmas-gold transition-all duration-200",children:({isActive:i})=>u.jsxs(u.Fragment,{children:[u.jsx("i",{className:"fas fa-trophy mr-3 text-xmas-gold"}),u.jsx("span",{children:"Achievements"}),u.jsx("i",{className:`fas fa-snowflake ml-auto text-xmas-gold opacity-70 ${i?"visible":"invisible"}`})]})})}),u.jsx("li",{children:u.jsx(Ca,{to:"/import",onClick:a,className:({isActive:i})=>i?"flex items-center p-2 pl-3 rounded-md bg-gradient-to-r from-xmas-card to-transparent border-l-2 border-xmas-gold text-xmas-gold font-medium":"flex items-center p-2 pl-3 rounded-md hover:bg-xmas-card hover:bg-opacity-50 text-xmas-text hover:text-xmas-gold transition-all duration-200",children:({isActive:i})=>u.jsxs(u.Fragment,{children:[u.jsx("i",{className:"fas fa-file-import mr-3 text-xmas-gold"}),u.jsx("span",{children:"Add Movies"}),u.jsx("i",{className:`fas fa-snowflake ml-auto text-xmas-gold opacity-70 ${i?"visible":"invisible"}`})]})})}),u.jsx("li",{children:u.jsx(Ca,{to:"/profile",onClick:a,className:({isActive:i})=>i?"flex items-center p-2 pl-3 rounded-md bg-gradient-to-r from-xmas-card to-transparent border-l-2 border-xmas-gold text-xmas-gold font-medium":"flex items-center p-2 pl-3 rounded-md hover:bg-xmas-card hover:bg-opacity-50 text-xmas-text hover:text-xmas-gold transition-all duration-200",children:({isActive:i})=>u.jsxs(u.Fragment,{children:[u.jsx("i",{className:"fas fa-user-circle mr-3 text-xmas-gold"}),u.jsx("span",{children:"Profile"}),u.jsx("i",{className:`fas fa-snowflake ml-auto text-xmas-gold opacity-70 ${i?"visible":"invisible"}`})]})})}),t&&u.jsx("li",{children:u.jsx(Ca,{to:"/admin",onClick:a,className:({isActive:i})=>i?"flex items-center p-2 pl-3 rounded-md bg-gradient-to-r from-xmas-card to-transparent border-l-2 border-xmas-gold text-xmas-gold font-medium":"flex items-center p-2 pl-3 rounded-md hover:bg-xmas-card hover:bg-opacity-50 text-xmas-text hover:text-xmas-gold transition-all duration-200",children:({isActive:i})=>u.jsxs(u.Fragment,{children:[u.jsx("i",{className:"fas fa-crown mr-3 text-xmas-gold"}),u.jsx("span",{children:"Admin Dashboard"}),u.jsx("i",{className:`fas fa-snowflake ml-auto text-xmas-gold opacity-70 ${i?"visible":"invisible"}`})]})})})]}):u.jsx("li",{children:u.jsx(Ca,{to:"/login",onClick:a,className:({isActive:i})=>i?"flex items-center p-2 pl-3 rounded-md bg-gradient-to-r from-xmas-card to-transparent border-l-2 border-xmas-gold text-xmas-gold font-medium":"flex items-center p-2 pl-3 rounded-md hover:bg-xmas-card hover:bg-opacity-50 text-xmas-text hover:text-xmas-gold transition-all duration-200",children:({isActive:i})=>u.jsxs(u.Fragment,{children:[u.jsx("i",{className:"fas fa-sign-in-alt mr-3 text-xmas-gold"}),u.jsx("span",{children:"Sign In"}),u.jsx("i",{className:`fas fa-snowflake ml-auto text-xmas-gold opacity-70 ${i?"visible":"invisible"}`})]})})})]})]})})})]}),u.jsx("main",{className:"p-4",children:u.jsx(DT,{})}),u.jsx("div",{className:"fixed bottom-0 left-0 w-full pointer-events-none",children:u.jsx("div",{className:"container mx-auto",children:u.jsxs("div",{className:"relative h-16",children:[u.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-px bg-gradient-to-r from-xmas-gold via-transparent to-xmas-gold opacity-40"}),u.jsx("div",{className:"absolute bottom-4 left-4 opacity-30",children:u.jsx("i",{className:"fas fa-tree text-4xl text-xmas-gold"})}),u.jsx("div",{className:"absolute bottom-4 right-4 opacity-30",children:u.jsx("i",{className:"fas fa-star text-4xl text-xmas-gold"})})]})})})]})}const rA=z.createContext(null);function BL({children:e}){const[t,r]=z.useState([]),n=z.useCallback(i=>{r(o=>o.filter(l=>l.id!==i))},[]),s=z.useCallback((i,o)=>{const l=Math.random().toString(36).slice(2);r(c=>[...c,{id:l,kind:i,message:o}]),setTimeout(()=>n(l),3e3)},[n]),a=z.useMemo(()=>({push:s}),[s]);return u.jsxs(rA.Provider,{value:a,children:[e,u.jsx("div",{className:"fixed top-4 left-1/2 -translate-x-1/2 z-50 space-y-2",children:t.map(i=>u.jsxs("div",{className:`alert shadow-lg max-w-sm border-2 rounded-xl bg-gradient-to-r ${i.kind==="success"?"from-green-700/90 to-emerald-600/90 border-green-300":i.kind==="error"?"from-red-800/90 to-rose-700/90 border-red-300":"from-sky-700/90 to-cyan-600/90 border-sky-300"} text-white`,children:[u.jsxs("div",{className:"flex items-center",children:[u.jsx("span",{className:"text-lg mr-2",children:i.kind==="success"?"":i.kind==="error"?"":""}),u.jsx("span",{className:"ml-1",children:i.message})]}),u.jsx("button",{className:"btn btn-ghost btn-xs text-white/80 hover:text-white",onClick:()=>n(i.id),children:""})]},i.id))})]})}function nA(){const e=z.useContext(rA);if(!e)throw new Error("useToast must be used inside <ToastProvider>");return{success:t=>e.push("success",t),error:t=>e.push("error",t),info:t=>e.push("info",t)}}const X_=({children:e})=>{const{currentUser:t,isLoading:r}=Dn();return r?u.jsx("div",{className:"flex justify-center items-center min-h-[60vh]",children:u.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-xmas-gold"})}):t?e?u.jsx(u.Fragment,{children:e}):u.jsx(DT,{}):u.jsx(YR,{to:"/login"})},Qo=[{id:"first_snowflake",name:"First Snowflake",description:"You logged your very first watched Christmas movie.",hint:"Watch 1 movie.",icon:"",check:e=>e.totalWatched>=1},{id:"snowball_starter",name:"Snowball Starter",description:"You have started to build your festive watchlist.",hint:"Watch 5 movies.",icon:"",check:e=>e.totalWatched>=5},{id:"blizzard_binger",name:"Blizzard Binger",description:"You powered through a flurry of festive films.",hint:"Watch 20 movies.",icon:"",check:e=>e.totalWatched>=20},{id:"christmas_marathoner",name:"Christmas Marathoner",description:"You turned Christmas movies into a marathon event.",hint:"Watch 50 movies.",icon:"",check:e=>e.totalWatched>=50},{id:"twelve_days",name:"12 Days of Christmas",description:"You kept the festive streak going for 12 days.",hint:"Watch a movie daily for 12 days.",icon:"",check:e=>e.hasTwelveDayStreak},{id:"the_grinch",name:"The Grinch",description:"Not every movie can be a Christmas miracle.",hint:"Give a movie 1.",icon:"",check:e=>e.lowRatingAny},{id:"santas_favourite",name:"Santa's Favourite",description:"You found a film worthy of Santa himself.",hint:"Give a movie a perfect 10.",icon:"",check:e=>e.highRatingAny},{id:"the_critic",name:"The Critic",description:"You have opinions on a lot of movies.",hint:"Rate 20 movies.",icon:"",check:e=>e.totalRated>=20},{id:"nice_list",name:"Nice List",description:"You are generous with your festive ratings.",hint:"Keep your average rating above 5.",icon:"",check:e=>e.averageRating>5},{id:"classic_connoisseur",name:"Classic Connoisseur",description:"You appreciate the classics before Y2K.",hint:"Watch 5 movies released before 2000.",icon:"",check:e=>e.classicWatched>=5},{id:"animated_joy",name:"Animated Joy",description:"You love animated festive adventures.",hint:"Watch 5 animated Christmas movies.",icon:"",check:e=>e.animatedCount>=5},{id:"romcom_reindeer",name:"Rom-Com Reindeer",description:"You love a festive rom-com.",hint:"Watch 5 Christmas romance movies.",icon:"",check:e=>e.romanceCount>=5},{id:"decorator",name:"Decorator",description:"You have a whole row of favourites lit up.",hint:"Mark 10 movies as favourite.",icon:"",check:e=>e.favoriteCount>=10},{id:"elf_mode",name:"Elf Mode",description:"You keep coming back like a dedicated Christmas elf.",hint:"Use the app on 10 different days.",icon:"",check:e=>e.usageDistinctDays>=10},{id:"christmas_eve_watcher",name:"Christmas Eve Watcher",description:"You watched a movie on Christmas Eve.",hint:"Watch a movie on Dec 24.",icon:"",check:e=>e.hasChristmasEveWatch},{id:"new_years_cozy",name:"New Year's Cozy",description:"You started the year with a cozy movie.",hint:"Watch a movie on Jan 1.",icon:"",check:e=>e.hasNewYearsWatch}];function Q_(e){if(!e)return null;if(e instanceof Date)return e;if(typeof e.toDate=="function")return e.toDate();if(typeof e=="object"&&"seconds"in e)return new Date(e.seconds*1e3);if(typeof e=="string"){const t=new Date(e);if(!isNaN(t.getTime()))return t}return null}function WL(e,t){let r=0,n=0,s=0,a=0,i=0,o=0,l=0,c=!1,f=!1;const d=new Set,m=new Set,p=new Set;for(const M of e){if(M.watched){r++;const v=Q_(M.watchedDate);if(v){const S=v.toISOString().split("T")[0];p.add(S);const C=v.getMonth();v.getDate(),C===11&&d.add(S)}const T=t[M.movieId];T&&T.releaseDate&&T.releaseDate.substring(0,4)<"2000"&&a++,T&&T.genres&&T.genres.includes("Romance")&&i++,T&&T.genres&&T.genres.includes("Animation")&&o++}M.favorite&&l++,typeof M.rating=="number"&&(n++,s+=M.rating,M.rating<=1&&(c=!0),M.rating>=10&&(f=!0));const O=Q_(M.updatedAt||M.addedAt);if(O){const v=O.toISOString().split("T")[0];m.add(v)}}const x=Array.from(p).map(M=>{const O=new Date(M+"T00:00:00Z");return Math.floor(O.getTime()/864e5)}).sort((M,O)=>M-O);let g=!1,w=0,k=null;for(const M of x){if(k===null||M===k+1?w+=1:M!==k&&(w=1),w>=12){g=!0;break}k=M}let E=!1,y=!1;for(const M of p){const O=new Date(M+"T00:00:00Z"),v=O.getMonth(),T=O.getDate();v===11&&T===24&&(E=!0),v===0&&T===1&&(y=!0)}const I=n>0?s/n:0;return{totalWatched:r,totalRated:n,averageRating:I,lowRatingAny:c,highRatingAny:f,classicWatched:a,romanceCount:i,animatedCount:o,favoriteCount:l,usageDistinctDays:m.size,decemberDistinctDays:d.size,hasChristmasEveWatch:E,hasNewYearsWatch:y,hasTwelveDayStreak:g}}async function fh(e){const t=await zt(bt(Me,`users/${e}/movies`)),r=[],n=new Set;t.forEach(f=>{const d=f.data();r.push({id:f.id,...d}),d.movieId&&n.add(d.movieId)});const s={};if(n.size){const f=Array.from(n);for(const d of f){(await zt(bt(Me,"movies"))).forEach(p=>{const x=p.data();s[p.id]={id:p.id,...x}});break}}const a=WL(r,s),i=bt(Me,`users/${e}/achievements`),o=await zt(i),l=new Set;o.forEach(f=>l.add(f.id));const c=[];for(const f of Qo)!l.has(f.id)&&f.check(a)&&(c.push(f.id),await qn(Ft(Me,`users/${e}/achievements`,f.id),{unlockedAt:new Date,seen:!1}));return c}const zL=()=>{const{currentUser:e}=Dn(),[t,r]=z.useState(new Date),[n,s]=z.useState(null),[a,i]=z.useState(null),o=Qo.length;z.useEffect(()=>{const f=setInterval(()=>r(new Date),1e3);return()=>clearInterval(f)},[]);const l=z.useMemo(()=>{const f=t.getFullYear(),d=new Date(f,11,25,0,0,0);return t>d?new Date(f+1,11,25,0,0,0):d},[t]),c=z.useMemo(()=>{const f=l.getTime()-t.getTime(),d=Math.max(0,Math.floor(f/1e3)),m=Math.floor(d/86400),p=Math.floor(d%86400/3600),x=Math.floor(d%3600/60),g=d%60;return{days:m,hours:p,minutes:x,seconds:g}},[t,l]);return z.useEffect(()=>{const f=Ft(Me,"stats","global"),d=GM(f,m=>{const p=m.data();s(typeof(p==null?void 0:p.watchedTotal)=="number"?p.watchedTotal:0)});return()=>d()},[]),z.useEffect(()=>{if(!e){i(null);return}(async()=>{try{const d=bt(Me,`users/${e.uid}/achievements`),m=await zt(d);i(m.size)}catch(d){console.error("Error loading achievements count",d),i(null)}})()},[e]),u.jsxs("div",{className:"container mx-auto px-4 py-8",children:[u.jsxs("div",{className:"text-center mb-12",children:[u.jsx("h1",{className:"font-christmas text-5xl md:text-7xl text-xmas-line mb-4",children:"My Christmas Movies"}),u.jsx("p",{className:"text-xl md:text-2xl text-xmas-snow mb-8",children:"Track, rate, and discover your favourite Christmas movies!"}),u.jsx("div",{className:"flex flex-col md:flex-row justify-center gap-6 mb-4 md:mb-6",children:e?u.jsxs(u.Fragment,{children:[u.jsxs(Xe,{to:"/movies",className:"btn btn-primary btn-lg text-xl px-8 py-3 rounded-md shadow-lg hover:shadow-xl transition-all duration-300 border border-xmas-gold border-opacity-30",children:[u.jsx("i",{className:"fas fa-film mr-2"})," My Movies"]}),u.jsxs(Xe,{to:"/random",className:"btn btn-primary btn-lg text-xl px-8 py-3 rounded-md shadow-lg hover:shadow-xl transition-all duration-300 border border-xmas-gold border-opacity-30",children:[u.jsx("i",{className:"fas fa-random mr-2"})," Random Movie"]}),u.jsxs(Xe,{to:"/achievements",className:"btn btn-primary btn-lg text-xl px-8 py-3 rounded-md shadow-lg hover:shadow-xl transition-all duration-300 border border-xmas-gold border-opacity-30",children:[u.jsx("i",{className:"fas fa-trophy mr-2"})," Achievements"]})]}):u.jsxs(Xe,{to:"/login",className:"btn btn-primary btn-lg text-xl px-8 py-3 rounded-md shadow-lg hover:shadow-xl transition-all duration-300 border border-xmas-gold border-opacity-30",children:[u.jsx("i",{className:"fas fa-sign-in-alt mr-2"})," Sign In"]})})]}),u.jsx("div",{className:"w-full max-w-4xl mx-auto mb-8",children:u.jsx("div",{className:"h-px bg-gradient-to-r from-transparent via-xmas-gold to-transparent"})}),u.jsxs("div",{className:"bg-xmas-card rounded-lg shadow-xl p-6 mb-12 border border-xmas-gold border-opacity-30 relative",children:[u.jsx("h2",{className:"font-christmas text-3xl text-xmas-gold text-center mb-6",children:"Countdown to Christmas"}),u.jsxs("div",{className:"grid md:grid-cols-2 gap-6 items-stretch",children:[u.jsxs("div",{className:"bg-xmas-card bg-opacity-70 p-6 rounded-lg shadow-md border-l-2 border-xmas-line flex flex-col items-center justify-center",children:[u.jsxs("div",{className:"text-5xl md:text-6xl font-bold text-xmas-line mb-2",children:[c.days,"d ",c.hours,"h ",c.minutes,"m ",c.seconds,"s"]}),u.jsx("p",{className:"text-xmas-text text-opacity-80",children:"until Christmas Day"})]}),u.jsxs("div",{className:"bg-xmas-card bg-opacity-70 p-6 rounded-lg shadow-md border-l-2 border-xmas-gold flex flex-col items-center justify-center",children:[u.jsx("div",{className:"text-5xl md:text-6xl font-bold text-xmas-gold mb-2",children:n??""}),u.jsx("p",{className:"text-xmas-text text-opacity-80 text-center",children:"total movies watched"})]})]})]}),u.jsxs("div",{className:"bg-xmas-card rounded-lg shadow-xl p-6 mb-12 border border-xmas-gold border-opacity-20 snow-accumulation snow-accumulation-slow relative",children:[u.jsx("h2",{className:"font-christmas text-3xl text-xmas-line mb-6 text-center",children:"Features"}),u.jsxs("div",{className:"grid md:grid-cols-4 gap-6",children:[u.jsxs("div",{className:"bg-xmas-card bg-opacity-70 p-6 rounded-lg shadow-md border-l-2 border-xmas-line",children:[u.jsx("div",{className:"text-3xl text-xmas-gold mb-4 text-center",children:u.jsx("i",{className:"fas fa-search"})}),u.jsx("h3",{className:"font-christmas text-xl text-center mb-3",children:"Find Movies"}),u.jsx("p",{className:"text-center text-xmas-text text-opacity-80",children:"Search and discover Christmas movies using OMDb data"})]}),u.jsxs("div",{className:"bg-xmas-card bg-opacity-70 p-6 rounded-lg shadow-md border-l-2 border-xmas-gold",children:[u.jsx("div",{className:"text-3xl text-xmas-gold mb-4 text-center",children:u.jsx("i",{className:"fas fa-star"})}),u.jsx("h3",{className:"font-christmas text-xl text-center mb-3",children:"Rate & Review"}),u.jsx("p",{className:"text-center text-xmas-text text-opacity-80",children:"Keep track of movies you've watched and rate them"})]}),u.jsxs("div",{className:"bg-xmas-card bg-opacity-70 p-6 rounded-lg shadow-md border-l-2 border-xmas-line",children:[u.jsx("div",{className:"text-3xl text-xmas-gold mb-4 text-center",children:u.jsx("i",{className:"fas fa-random"})}),u.jsx("h3",{className:"font-christmas text-xl text-center mb-3",children:"Random Picker"}),u.jsx("p",{className:"text-center text-xmas-text text-opacity-80",children:"Can't decide what to watch? Let our random movie picker help!"})]}),u.jsxs("div",{className:"bg-xmas-card bg-opacity-70 p-6 rounded-lg shadow-md border-l-2 border-xmas-line",children:[u.jsx("div",{className:"text-3xl text-xmas-gold mb-4 text-center",children:u.jsx("i",{className:"fas fa-trophy"})}),u.jsx("h3",{className:"font-christmas text-xl text-center mb-3",children:"Achievements"}),u.jsx("p",{className:"text-center text-xmas-text text-opacity-80 mb-2",children:"Unlock festive badges as you watch, rate, and explore."}),e&&u.jsx("p",{className:"text-center text-xmas-text text-opacity-80 font-medium",children:typeof a=="number"?`${a} / ${o} unlocked`:`${o} to discover`})]})]})]}),u.jsx("div",{className:"bg-xmas-card rounded-lg shadow-xl p-6 mb-12 border border-xmas-gold border-opacity-30 snow-accumulation snow-accumulation-fast relative",children:u.jsxs("div",{className:"mb-6 text-center",children:[u.jsxs("h2",{className:"font-christmas text-3xl md:text-4xl text-xmas-gold inline-block relative",children:[u.jsx("span",{className:"relative z-10",children:"Create Your Collection"}),u.jsx("span",{className:"absolute -bottom-2 left-0 right-0 h-1 bg-xmas-gold opacity-30 rounded-full"})]}),u.jsx("p",{className:"mt-4 mb-6",children:"Add movies to your collection and rate them"}),e?u.jsxs(Xe,{to:"/import",className:"btn btn-primary",children:[u.jsx("i",{className:"fas fa-file-import mr-2"})," Add Movies"]}):u.jsxs(Xe,{to:"/login",className:"btn btn-primary",children:[u.jsx("i",{className:"fas fa-sign-in-alt mr-2"})," Sign In to Add"]})]})}),u.jsx("div",{className:"w-full max-w-4xl mx-auto mb-8",children:u.jsx("div",{className:"h-px bg-gradient-to-r from-transparent via-xmas-gold to-transparent"})}),u.jsxs("footer",{className:"text-center text-xmas-mute mt-12 pb-8 space-y-4",children:[u.jsxs("p",{children:[" ",new Date().getFullYear()," Christmas Movie Database"]}),u.jsxs("div",{className:"flex flex-col items-center justify-center gap-2 text-xs md:text-sm text-xmas-mute/80",children:[u.jsx("a",{href:"https://www.omdbapi.com/",target:"_blank",rel:"noopener noreferrer",className:"link link-hover",children:"OMDb API"}),u.jsx("p",{className:"max-w-xl px-4 text-center",children:"This product uses the OMDb API but is not endorsed or certified by OMDb."})]})]})]})},$L=()=>{const e=Ls(),{currentUser:t,isLoading:r,error:n,signInWithGoogle:s}=Dn();z.useEffect(()=>{t&&!r&&e("/")},[t,r,e]);const a=async()=>{try{await s()}catch(i){console.error("Login failed:",i)}};return r?u.jsx("div",{className:"flex justify-center items-center min-h-[60vh]",children:u.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-xmas-gold"})}):u.jsx("div",{className:"container mx-auto px-4 py-12",children:u.jsxs("div",{className:"max-w-md mx-auto",children:[u.jsxs("div",{className:"text-center mb-8",children:[u.jsx("h1",{className:"font-christmas text-4xl text-xmas-line mb-2",children:"Christmas Movie Database"}),u.jsx("p",{className:"text-xmas-mute",children:"Sign in to manage your Christmas movie collection"})]}),u.jsxs("div",{className:"bg-xmas-card rounded-lg shadow-lg p-6",children:[n&&u.jsx("div",{className:"bg-error bg-opacity-10 border-l-4 border-error p-4 mb-6 rounded",children:u.jsx("p",{className:"text-error",children:n})}),u.jsxs("div",{className:"text-center mb-6",children:[u.jsx("p",{className:"mb-4",children:"Sign in with your Google account to access your Christmas movie collection."}),u.jsx("p",{className:"text-sm text-xmas-mute mb-6",children:"Track, rate, and discover Christmas movies!"}),u.jsxs("button",{onClick:a,className:"btn btn-primary w-full flex items-center justify-center gap-2",children:[u.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 48 48",children:[u.jsx("path",{fill:"#FFC107",d:`M43.611,20.083H42V20H24v8h11.303c-1.649,4.657-6.08,8-11.303,8c-6.627,0-12-5.373-12-12\r
                  s5.373-12,12-12c3.059,0,5.842,1.154,7.961,3.039l5.657-5.657C34.046,6.053,29.268,4,24,4C12.955,4,4,12.955,4,24s8.955,20,20,20\r
                  s20-8.955,20-20C44,22.659,43.862,21.35,43.611,20.083z`}),u.jsx("path",{fill:"#FF3D00",d:`M6.306,14.691l6.571,4.819C14.655,15.108,18.961,12,24,12c3.059,0,5.842,1.154,7.961,3.039\r
                  l5.657-5.657C34.046,6.053,29.268,4,24,4C16.318,4,9.656,8.337,6.306,14.691z`}),u.jsx("path",{fill:"#4CAF50",d:`M24,44c5.166,0,9.86-1.977,13.409-5.192l-6.19-5.238C29.211,35.091,26.715,36,24,36\r
                  c-5.202,0-9.619-3.317-11.283-7.946l-6.522,5.025C9.505,39.556,16.227,44,24,44z`}),u.jsx("path",{fill:"#1976D2",d:`M43.611,20.083H42V20H24v8h11.303c-0.792,2.237-2.231,4.166-4.087,5.571\r
                  c0.001-0.001,0.002-0.001,0.003-0.002l6.19,5.238C36.971,39.205,44,34,44,24C44,22.659,43.862,21.35,43.611,20.083z`})]}),"Sign in with Google"]})]})]}),u.jsx("div",{className:"text-center mt-6",children:u.jsx("p",{className:"text-sm text-xmas-mute",children:"By signing in, you agree to our Terms of Service and Privacy Policy."})})]})})},sA=e=>e.toLowerCase().replace(/[^\w\s-]/g,"").replace(/\s+/g,"-").replace(/-+/g,"-").trim(),Yx=(e,t)=>`/movies/${sA(e)}?id=${t}`,HL=e=>new URLSearchParams(e).get("id"),GL=5*60*1e3;let is=null;const KL=(e,t,r)=>{is={userMovies:t,movies:r,timestamp:Date.now(),userId:e}},qL=e=>!is||is.userId!==e||Date.now()-is.timestamp>GL?null:{userMovies:is.userMovies,movies:is.movies},aA=()=>{is=null},YL=(e,t,r)=>{is&&is.userId===e&&(is.userMovies[t]=r,is.timestamp=Date.now())},i0=async(e,t,r)=>{const n=Ft(Me,`users/${e}/movies`,t);if((await Nn(n)).exists()){const o={...r,updatedAt:new Date};r.rating===null&&(o.rating=null),r.watchedDate===null&&(o.watchedDate=null),r.review===null&&(o.review=null),await hi(n,o)}else{const o={userId:e,movieId:t,watched:r.watched||!1,favorite:r.favorite||!1,addedAt:new Date,updatedAt:new Date,...r};await qn(n,o)}const a=await Nn(n),i={id:a.id,...a.data()};return YL(e,t,i),i},Lp=async(e,t)=>{const r=Ft(Me,`users/${e}/movies`,t),n=await Nn(r);return n.exists()?{id:n.id,...n.data()}:null},iA=async e=>{const t=bt(Me,`users/${e}/movies`),r=await zt(t),n=[];return r.forEach(s=>{n.push({id:s.id,...s.data()})}),n},XL=async(e,t)=>{const r=Ft(Me,`users/${e}/movies`,t);await HM(r),aA()},$u=async e=>{const t=qL(e);if(t)return t;const r=await iA(e),n={},s=[];r.forEach(o=>{n[o.movieId]=o,s.push(o.movieId)});const a=[];if(s.length>0)for(let l=0;l<s.length;l+=10){const f=s.slice(l,l+10).map(m=>Nn(Ft(Me,"movies",m)).then(p=>p.exists()?{id:p.id,...p.data()}:null).catch(p=>(console.error(`Error fetching movie ${m}:`,p),null))),d=await Promise.all(f);a.push(...d.filter(Boolean))}const i={userMovies:n,movies:a};return KL(e,n,a),i},QL=()=>{const{currentUser:e,userProfile:t}=Dn(),r=nA(),[n,s]=z.useState([]),[a,i]=z.useState({}),[o,l]=z.useState(!0),[c,f]=z.useState(!0),[d,m]=z.useState(null),[p,x]=z.useState("all"),[g,w]=z.useState({option:"title",direction:"asc"}),[k,E]=z.useState(""),[y,I]=z.useState("all"),[M,O]=z.useState(!1),[v,T]=z.useState(!1),[S,C]=z.useState(""),[b,P]=z.useState(""),[D,ie]=z.useState(""),[Z,fe]=z.useState(!1),ue=Ms();Ls();const q=V=>V.toLowerCase().trim().replace(/[^a-z0-9]+/g,"-").replace(/^-+|-+$/g,""),G=async()=>{if(e)try{fe(!0);const V=Ft(Me,"users",e.uid),J={isPublicWatchlist:v,publicWatchlistName:S||null,publicWatchlistTagline:b||null,publicWatchlistSlug:D||null};if(v&&!J.publicWatchlistSlug){const de=S||(t==null?void 0:t.displayName)||"xmas-watchlist";J.publicWatchlistSlug=q(de),ie(J.publicWatchlistSlug)}if(await hi(V,J),v&&J.publicWatchlistSlug){const de=Ft(Me,"publicProfiles",J.publicWatchlistSlug);await qn(de,{userId:e.uid,displayName:(t==null?void 0:t.displayName)||"",photoURL:(t==null?void 0:t.photoURL)||null,publicWatchlistName:J.publicWatchlistName||null,publicWatchlistTagline:J.publicWatchlistTagline||null,publicWatchlistSlug:J.publicWatchlistSlug,isPublicWatchlist:!0},{merge:!0})}else if(!v&&D){const de=Ft(Me,"publicProfiles",D);await qn(de,{userId:e.uid,isPublicWatchlist:!1,publicWatchlistName:null,publicWatchlistTagline:null},{merge:!0})}r.success("Sharing settings saved")}catch(V){console.error("Error saving sharing settings:",V),r.error("Failed to save sharing settings")}finally{fe(!1)}},ne=async()=>{if(D)try{const J=`${window.location.origin}/u/${D}`;await navigator.clipboard.writeText(J),r.success("Link copied to clipboard")}catch(V){console.error("Failed to copy link",V),r.error("Failed to copy link")}};z.useEffect(()=>{const V=new URLSearchParams(ue.search),J=V.get("q")||"",de=V.get("field")||"all";J!==k&&E(J),de!==y&&I(de)},[ue.search]),z.useEffect(()=>{t&&(T(!!t.isPublicWatchlist),C(t.publicWatchlistName||""),P(t.publicWatchlistTagline||""),ie(t.publicWatchlistSlug||""))},[t]),z.useEffect(()=>{v&&S&&(D||ie(q(S)))},[v,S,D]),z.useEffect(()=>{(async()=>{if(e)try{f(!0);const{userMovies:J,movies:de}=await $u(e.uid);i(J),s(de)}catch(J){console.error("Error fetching movies:",J),m("Failed to load movies")}finally{f(!1),l(!1)}})()},[e,ue.key]);const ce=V=>{w(J=>J.option===V?{option:V,direction:J.direction==="asc"?"desc":"asc"}:{option:V,direction:"asc"})},j=z.useCallback(V=>{if(!k.trim())return!0;const J=k.toLowerCase().trim(),de=J.split(",").map(pe=>pe.trim()).filter(Boolean),Ee=pe=>V.cast&&V.cast.some(Ue=>Ue.toLowerCase().includes(pe)),_e=a[V.id];switch(y){case"title":return V.title.toLowerCase().includes(J)||V.sortTitle&&V.sortTitle.toLowerCase().includes(J)||V.originalTitle&&V.originalTitle.toLowerCase().includes(J);case"year":return V.releaseDate&&V.releaseDate.substring(0,4).includes(J);case"cast":return de.length?de.some(pe=>Ee(pe)):Ee(J);case"all":default:return V.title.toLowerCase().includes(J)||V.sortTitle&&V.sortTitle.toLowerCase().includes(J)||V.originalTitle&&V.originalTitle.toLowerCase().includes(J)||V.releaseDate&&V.releaseDate.substring(0,4).includes(J)||V.overview&&V.overview.toLowerCase().includes(J)||V.genres&&V.genres.some(pe=>pe.toLowerCase().includes(J))||V.directors&&V.directors.some(pe=>pe.toLowerCase().includes(J))||V.cast&&V.cast.some(pe=>pe.toLowerCase().includes(J))||_e&&_e.review&&_e.review.toLowerCase().includes(J)}},[k,y,a]),Y=z.useMemo(()=>{if(c)return[];l(!0);const V=n.filter(J=>{const de=a[J.id];let Ee=!0;switch(p){case"watched":Ee=de&&de.watched;break;case"unwatched":Ee=!de||!de.watched;break;case"favorites":Ee=de&&de.favorite;break}return Ee&&j(J)}).sort((J,de)=>{const Ee=a[J.id],_e=a[de.id],pe=g.direction==="asc"?1:-1;switch(g.option){case"title":const Ue=J.sortTitle||J.title,H=de.sortTitle||de.title;return Ue.localeCompare(H)*pe;case"year":const tt=J.releaseDate?parseInt(J.releaseDate.substring(0,4)):0,He=de.releaseDate?parseInt(de.releaseDate.substring(0,4)):0;return(tt-He)*pe;case"rating":const Je=(Ee==null?void 0:Ee.rating)||0,De=(_e==null?void 0:_e.rating)||0;return(Je-De)*pe;case"watched":const Ae=Ee!=null&&Ee.watched?1:0,_t=_e!=null&&_e.watched?1:0;return(Ae-_t)*pe;default:return 0}});return l(!1),V},[n,a,p,g,k,y,c]),K=Y;return c?u.jsx("div",{className:"flex justify-center items-center min-h-[60vh]",children:u.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-xmas-gold"})}):u.jsxs("div",{className:"container mx-auto px-2 sm:px-4 py-4 sm:py-8",children:[u.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-center mb-4 sm:mb-8 gap-3",children:[u.jsx("h1",{className:"font-christmas text-2xl sm:text-3xl md:text-4xl text-xmas-line",children:"My Christmas Movies"}),u.jsxs("div",{className:"flex gap-2 w-full sm:w-auto justify-center",children:[u.jsxs(Xe,{to:"/random",className:"btn btn-primary btn-sm sm:btn-md",children:[u.jsx("i",{className:"fas fa-random mr-1 sm:mr-2"})," ",u.jsx("span",{className:"hidden xs:inline",children:"Random Movie"}),u.jsx("span",{className:"xs:hidden",children:"Random"})]}),u.jsxs(Xe,{to:"/import",className:"btn btn-primary btn-sm sm:btn-md",children:[u.jsx("i",{className:"fas fa-file-import mr-1 sm:mr-2"})," ",u.jsx("span",{className:"hidden xs:inline",children:"Add Movies"}),u.jsx("span",{className:"xs:hidden",children:"Import"})]}),u.jsxs("button",{type:"button",className:"btn btn-primary btn-sm sm:btn-md",onClick:()=>O(!0),children:[u.jsx("i",{className:"fas fa-share-alt mr-1 sm:mr-2"}),u.jsx("span",{className:"hidden xs:inline",children:"Share"}),u.jsx("span",{className:"xs:hidden",children:"Share"})]})]})]}),d&&u.jsxs("div",{className:"alert alert-error mb-6",children:[u.jsx("i",{className:"fas fa-exclamation-circle mr-2"}),u.jsx("span",{children:d})]}),u.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 mb-3",children:[u.jsxs("div",{className:"relative flex-grow",children:[u.jsx("div",{className:"absolute inset-y-0 left-0 pl-2 flex items-center pointer-events-none",children:u.jsx("i",{className:"fas fa-search text-gray-400"})}),u.jsx("input",{type:"text",className:"input input-bordered input-sm sm:input-md w-full pl-8 pr-8",placeholder:"   Search movies...",value:k,onChange:V=>E(V.target.value)}),k&&u.jsx("button",{className:"absolute inset-y-0 right-0 pr-2 flex items-center",onClick:()=>E(""),children:u.jsx("i",{className:"fas fa-times text-gray-400 hover:text-gray-600"})})]}),u.jsxs("select",{className:"select select-bordered select-sm sm:select-md w-full sm:w-36",value:y,onChange:V=>I(V.target.value),children:[u.jsx("option",{value:"all",children:"All Fields"}),u.jsx("option",{value:"title",children:"Title Only"}),u.jsx("option",{value:"year",children:"Year Only"}),u.jsx("option",{value:"cast",children:"Cast Only"})]})]}),u.jsxs("div",{className:"tabs tabs-boxed mb-3 text-xs sm:text-sm overflow-x-auto",children:[u.jsx("button",{className:`tab ${p==="all"?"tab-active":""}`,onClick:()=>x("all"),children:"All Movies"}),u.jsx("button",{className:`tab ${p==="watched"?"tab-active":""}`,onClick:()=>x("watched"),children:"Watched"}),u.jsx("button",{className:`tab ${p==="unwatched"?"tab-active":""}`,onClick:()=>x("unwatched"),children:"Watch"}),u.jsxs("button",{className:`tab ${p==="favorites"?"tab-active":""}`,onClick:()=>x("favorites"),children:[u.jsx("span",{className:"hidden sm:inline",children:"Favourites"}),u.jsx("span",{className:"sm:hidden",children:"Favs"})]})]}),u.jsxs("div",{className:"flex flex-wrap items-center gap-1 mb-3 bg-xmas-card bg-opacity-50 p-2 rounded-lg overflow-x-auto",children:[u.jsx("span",{className:"text-xs sm:text-sm font-medium mr-1",children:"Sort:"}),u.jsxs("div",{className:"flex flex-nowrap gap-1 overflow-x-auto",children:[u.jsxs("button",{className:`btn btn-xs ${g.option==="title"?"btn-primary":"btn-ghost"}`,onClick:()=>ce("title"),children:["Title ",g.option==="title"&&u.jsx("i",{className:`fas fa-sort-${g.direction==="asc"?"up":"down"} ml-1`})]}),u.jsxs("button",{className:`btn btn-xs ${g.option==="year"?"btn-primary":"btn-ghost"}`,onClick:()=>ce("year"),children:["Year ",g.option==="year"&&u.jsx("i",{className:`fas fa-sort-${g.direction==="asc"?"up":"down"} ml-1`})]}),u.jsxs("button",{className:`btn btn-xs ${g.option==="rating"?"btn-primary":"btn-ghost"}`,onClick:()=>ce("rating"),children:["Rating ",g.option==="rating"&&u.jsx("i",{className:`fas fa-sort-${g.direction==="asc"?"up":"down"} ml-1`})]}),u.jsxs("button",{className:`btn btn-xs ${g.option==="watched"?"btn-primary":"btn-ghost"}`,onClick:()=>ce("watched"),children:[u.jsx("span",{className:"hidden sm:inline",children:"Watched Status"}),u.jsx("span",{className:"sm:hidden",children:"Watched"}),g.option==="watched"&&u.jsx("i",{className:`fas fa-sort-${g.direction==="asc"?"up":"down"} ml-1`})]})]})]}),u.jsxs("div",{className:"flex flex-col xs:flex-row justify-between items-start xs:items-center mb-3 text-xs sm:text-sm",children:[u.jsxs("div",{children:[u.jsx("span",{className:"font-medium",children:Y.length})," ",Y.length===1?"movie":"movies"," found",k&&u.jsxs("span",{className:"ml-1 text-xmas-mute",children:["for: ",u.jsxs("span",{className:"font-medium",children:['"',k,'"']})]})]}),g.option&&u.jsxs("div",{className:"text-xmas-mute",children:["Sorted by ",u.jsx("span",{className:"font-medium",children:g.option})," (",g.direction==="asc"?"asc":"desc",")"]})]}),o&&!c&&u.jsx("div",{className:"flex justify-center items-center py-4",children:u.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-t-2 border-b-2 border-xmas-gold"})}),Y.length===0?u.jsxs("div",{className:"bg-xmas-card p-8 rounded-lg text-center",children:[u.jsx("h3",{className:"text-xl mb-4",children:"No movies found"}),u.jsx("p",{className:"mb-4",children:p==="all"?"You haven't added any Christmas movies yet.":`You don't have any ${p} Christmas movies.`}),u.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 justify-center",children:[u.jsxs(Xe,{to:"/import",className:"btn btn-primary",children:[u.jsx("i",{className:"fas fa-file-import mr-2"})," Add Movies"]}),n.length>0&&u.jsxs(Xe,{to:"/random",className:"btn btn-primary",children:[u.jsx("i",{className:"fas fa-random mr-2"})," Random Movie"]})]})]}):u.jsx("div",{className:"grid grid-cols-3 sm:grid-cols-4 md:grid-cols-5 lg:grid-cols-6 gap-2 sm:gap-3",children:K.map(V=>{var de;const J=a[V.id];return u.jsx(Xe,{to:Yx(V.title,V.id),state:{from:"movies"},className:"block transition-transform hover:scale-[1.02] hover:shadow-xl",children:u.jsxs("div",{className:"relative rounded-lg overflow-hidden bg-xmas-card shadow-md h-full flex flex-col",children:[u.jsxs("div",{className:"relative",children:[V.posterUrl?u.jsx("img",{src:V.posterUrl,alt:V.title,className:"w-full h-auto object-cover",style:{aspectRatio:"2/3"},loading:"lazy"}):u.jsx("div",{className:"w-full flex items-center justify-center bg-gray-800",style:{aspectRatio:"2/3"},children:u.jsx("i",{className:"fas fa-film text-2xl text-gray-500"})}),J&&J.watched&&u.jsx("div",{className:"absolute top-1 right-1 bg-primary rounded-full p-1 shadow-md",children:u.jsx("i",{className:"fas fa-check text-xs text-white"})}),J&&J.favorite&&u.jsx("div",{className:"absolute top-1 left-1 text-yellow-400 drop-shadow-md",children:u.jsx("i",{className:"fas fa-star text-sm"})})]}),u.jsxs("div",{className:"p-1 sm:p-2 flex-grow flex flex-col",children:[u.jsx("h3",{className:"text-xs sm:text-sm font-medium line-clamp-2",children:V.title}),u.jsxs("div",{className:"flex justify-between items-center mt-1",children:[u.jsx("p",{className:"text-xs text-gray-400",children:(de=V.releaseDate)==null?void 0:de.substring(0,4)}),J&&J.rating&&u.jsxs("div",{className:"flex items-center",children:[u.jsx("span",{className:"text-yellow-400 mr-0.5",children:u.jsx("i",{className:"fas fa-star text-xs"})}),u.jsx("span",{className:"text-xs",children:J.rating})]})]})]})]})},V.id)})}),M&&u.jsxs("dialog",{className:"modal modal-open",children:[u.jsxs("div",{className:"modal-box max-w-lg",children:[u.jsx("h3",{className:"font-bold text-lg mb-2",children:"Share your watchlist"}),u.jsx("p",{className:"text-sm mb-4",children:"Create a shareable page that shows your watched Christmas movies, ratings and vibes."}),u.jsx("div",{className:"form-control mb-4",children:u.jsxs("label",{className:"label cursor-pointer",children:[u.jsx("span",{className:"label-text",children:"Make my watchlist public"}),u.jsx("input",{type:"checkbox",className:"toggle toggle-primary",checked:v,onChange:V=>T(V.target.checked)})]})}),u.jsxs("div",{className:"grid grid-cols-1 gap-3",children:[u.jsxs("div",{className:"form-control",children:[u.jsx("label",{className:"label",children:u.jsx("span",{className:"label-text",children:"Public display name"})}),u.jsx("input",{type:"text",className:"input input-bordered input-sm sm:input-md",value:S,onChange:V=>C(V.target.value),placeholder:"My Xmas Movies"})]}),u.jsxs("div",{className:"form-control",children:[u.jsx("label",{className:"label",children:u.jsx("span",{className:"label-text",children:"Tagline / bio (optional)"})}),u.jsx("input",{type:"text",className:"input input-bordered input-sm sm:input-md",value:b,onChange:V=>P(V.target.value),placeholder:"Only the coziest Xmas movies allowed"})]}),D&&u.jsxs("div",{className:"mt-1 text-xs text-xmas-mute",children:["Your public link: ",u.jsxs("span",{className:"font-mono",children:["/u/",D]})]})]}),u.jsxs("div",{className:"modal-action flex flex-wrap gap-2 justify-between",children:[u.jsxs("div",{className:"flex gap-2",children:[u.jsxs("button",{className:"btn btn-primary btn-sm",onClick:G,disabled:Z,children:[Z&&u.jsx("span",{className:"loading loading-spinner loading-xs mr-1"}),"Save"]}),u.jsxs("button",{type:"button",className:"btn btn-outline btn-sm",onClick:ne,disabled:!D,children:[u.jsx("i",{className:"fas fa-link mr-2"}),"Copy link"]})]}),u.jsx("button",{type:"button",className:"btn btn-ghost btn-sm",onClick:()=>O(!1),children:"Close"})]})]}),u.jsx("form",{method:"dialog",className:"modal-backdrop",onClick:()=>O(!1),children:u.jsx("button",{children:"close"})})]})]})},jp=Ft(Me,"stats","global");async function JL(){(await Nn(jp)).exists()||await qn(jp,{watchedTotal:0,updatedAt:new Date},{merge:!0})}async function ZL(e){await JL(),await hi(jp,{watchedTotal:qM(e),updatedAt:new Date})}const e6=[{id:"heartwarming",label:"Heartwarming",emoji:"",type:"positive"},{id:"very_christmassy",label:"Very Christmassy",emoji:"",type:"positive"},{id:"snowy",label:"Snowy Setting",emoji:"",type:"positive"},{id:"funny",label:"Funny",emoji:"",type:"positive"},{id:"cheesy",label:"Cheesy (Good Way)",emoji:"",type:"positive"},{id:"romantic",label:"Romantic",emoji:"",type:"positive"},{id:"family_friendly",label:"Family Friendly",emoji:"",type:"positive"},{id:"background",label:"Good Background Watch",emoji:"",type:"positive"},{id:"tearjerker",label:"Emotional",emoji:"",type:"positive"},{id:"rewatch",label:"Would Rewatch",emoji:"",type:"positive"}],t6=[{id:"slow",label:"Slow Pacing",emoji:"",type:"negative"},{id:"boring",label:"A Bit Boring",emoji:"",type:"negative"},{id:"low_christmas",label:"Low Xmas Vibes",emoji:"",type:"negative"},{id:"weak_chemistry",label:"Weak Chemistry",emoji:"",type:"negative"},{id:"confusing",label:"Confusing Plot",emoji:"",type:"negative"},{id:"too_long",label:"Too Long",emoji:"",type:"negative"},{id:"cringey",label:"Cringey",emoji:"",type:"negative"},{id:"fake_snow",label:"Fake Snow",emoji:"",type:"negative"},{id:"hammy",label:"Hammy",emoji:"",type:"negative"}],r6={heartwarming:"heartwarming",very_christmassy:"full of Christmas vibes",snowy:"with a lovely snowy setting",funny:"with some funny moments",cheesy:"a bit cheesy in a good way",romantic:"with sweet romantic moments",family_friendly:"very family friendly",background:"great as a cosy background watch",tearjerker:"quite emotional at times",rewatch:"something I'd happily rewatch"},n6={slow:"quite slow in places",boring:"a bit boring overall",low_christmas:"lighter on Christmas vibes than expected",weak_chemistry:"with weak chemistry between the leads",confusing:"a bit confusing at times",too_long:"longer than it needed to be",cringey:"a bit cringey in parts",fake_snow:"with fake snow",hammy:"hammy overacting"};function s6(e){return!e||e<=0?"An easy-going Christmas movie.":e>=9?"Absolutely loved this Christmas movie.":e>=8?"Really enjoyed this festive watch.":e>=7?"A good Christmas movie I liked overall.":e>=6?"A decent cosy watch with some nice moments.":e>=5?"An okay Christmas movie, but nothing special.":e>=3?"Not really my thing, it had a few issues.":"I didn't enjoy this Christmas movie very much."}function J_(e){if(e.length===0)return"";if(e.length===1)return e[0];const t=e[e.length-1];return`${e.slice(0,-1).join(", ")} and ${t}`}function a6(e){const t=e.map(s=>r6[s]).filter(Boolean),r=e.map(s=>n6[s]).filter(Boolean);let n="";return t.length&&(n+=` It felt ${J_(t)}.`),r.length&&(n+=` However, it was ${J_(r)}.`),n}const i6=({rating:e,initialTags:t=[],initialAutoReview:r="",onChange:n})=>{const[s,a]=z.useState(t),[i,o]=z.useState(r);z.useEffect(()=>{a(t)},[t.join("|")]),z.useEffect(()=>{o(r)},[r]);const l=d=>{a(m=>m.includes(d)?m.filter(p=>p!==d):[...m,d])},c=()=>{const d=s6(e),m=a6(s),p=(d+m).trim();o(p),n&&n({tags:s,autoReview:p})},f=d=>s.includes(d);return u.jsxs("div",{className:"mt-4",children:[u.jsxs("div",{className:"flex items-center justify-between mb-2",children:[u.jsx("h3",{className:"text-lg font-semibold text-primary",children:"Quick Vibe Review"}),u.jsx("span",{className:"text-xs opacity-80",children:"Pick a few that fit, then generate."})]}),u.jsx("p",{className:"text-xs mb-1 opacity-80",children:"What worked?"}),u.jsx("div",{className:"flex flex-wrap gap-2 mb-3",children:e6.map(d=>u.jsxs("button",{type:"button",onClick:()=>l(d.id),className:`btn btn-xs rounded-full border ${f(d.id)?"btn-accent text-base-100":"btn-ghost border-base-300 text-sm"}`,children:[u.jsx("span",{className:"mr-1",children:d.emoji}),d.label]},d.id))}),u.jsx("p",{className:"text-xs mb-1 opacity-80",children:"What didn't?"}),u.jsx("div",{className:"flex flex-wrap gap-2 mb-3",children:t6.map(d=>u.jsxs("button",{type:"button",onClick:()=>l(d.id),className:`btn btn-xs rounded-full border ${f(d.id)?"btn-error text-base-100":"btn-ghost border-base-300 text-sm"}`,children:[u.jsx("span",{className:"mr-1",children:d.emoji}),d.label]},d.id))}),u.jsx("button",{type:"button",onClick:c,className:"btn btn-sm btn-primary",children:" Generate Review From Tags"}),i&&u.jsxs("p",{className:"mt-3 text-sm opacity-90 italic",children:["Generated preview: ",i,""]})]})},o6=({watched:e,watchedDate:t,onWatchedDateChange:r,rating:n,onRatingChange:s,review:a,onReviewChange:i,vibeTags:o,onVibeChange:l,saving:c,onSave:f})=>u.jsxs(u.Fragment,{children:[u.jsx("h2",{className:"text-2xl font-christmas text-xmas-gold mb-4",children:"Your Rating & Review"}),e&&u.jsxs("div",{className:"form-control mb-4",children:[u.jsx("label",{className:"label",children:u.jsx("span",{className:"label-text",children:"Date Watched"})}),u.jsx("input",{type:"date",className:"input input-bordered",value:t,onChange:d=>r(d.target.value)})]}),u.jsxs("div",{className:"form-control mb-4",children:[u.jsx("label",{className:"label",children:u.jsx("span",{className:"label-text",children:"Your Rating"})}),u.jsx("div",{className:"rating rating-lg",children:[1,2,3,4,5,6,7,8,9,10].map(d=>u.jsx("input",{type:"radio",name:"rating",className:`mask mask-star-2 ${d<=5?"bg-orange-400":"bg-yellow-400"}`,checked:n===d,onChange:()=>s(d)},d))}),n&&u.jsx("div",{className:"mt-2",children:u.jsx("button",{className:"btn btn-xs btn-ghost",onClick:()=>s(null),children:"Clear Rating"})})]}),u.jsx(i6,{rating:n,initialTags:o,initialAutoReview:a,onChange:l}),u.jsxs("div",{className:"form-control mb-6 mt-4",children:[u.jsx("label",{className:"label",children:u.jsx("span",{className:"label-text",children:"Your Review"})}),u.jsx("textarea",{className:"textarea textarea-bordered h-32",placeholder:"Write your thoughts about this movie...",value:a,onChange:d=>i(d.target.value)})]}),u.jsx("div",{className:"flex justify-end",children:u.jsx("button",{className:"btn btn-primary btn-sm sm:btn-md",onClick:f,disabled:c,children:c?u.jsxs(u.Fragment,{children:[u.jsx("span",{className:"loading loading-spinner loading-sm mr-2"}),"Saving..."]}):u.jsxs(u.Fragment,{children:[u.jsx("i",{className:"fas fa-save mr-2"}),"Save Changes"]})})})]}),l6=()=>{var G;const{movieId:e}=Xg(),t=Ms(),r=Ls(),{currentUser:n}=Dn(),s=nA(),a=HL(t.search),o=((G=t.state)==null?void 0:G.from)==="import"?"/import":"/movies",[l,c]=z.useState(null),[f,d]=z.useState(null),[m,p]=z.useState(!0),[x,g]=z.useState(null),[w,k]=z.useState(!1),[E,y]=z.useState(!1),[I,M]=z.useState(""),[O,v]=z.useState(null),[T,S]=z.useState(""),[C,b]=z.useState(!1),[P,D]=z.useState([]),ie=z.useRef(null);z.useEffect(()=>{(async()=>{if(!n||!a){g("Movie not found"),p(!1);return}try{p(!0);const ce=await Nn(Ft(Me,"movies",a));if(!ce.exists()){g("Movie not found"),p(!1);return}const j={id:ce.id,...ce.data()};c(j);const Y=await Lp(n.uid,a);if(Y){d(Y),y(Y.watched);let K="";if(Y.watchedDate)try{if(Y.watchedDate instanceof Date)K=Y.watchedDate.toISOString().split("T")[0];else{const V=Y.watchedDate;if(typeof V=="object"&&V!==null&&"seconds"in V){const J=V;K=new Date(J.seconds*1e3).toISOString().split("T")[0]}else{const J=new Date(Y.watchedDate);isNaN(J.getTime())||(K=J.toISOString().split("T")[0])}}}catch(V){console.error("Error parsing watchedDate:",V)}M(K),v(Y.rating||null),S(Y.review||""),b(Y.favorite),D(Y.vibeTags||[])}}catch(ce){console.error("Error fetching movie data:",ce),g("Failed to load movie data")}finally{p(!1)}})()},[n,a]),z.useEffect(()=>{E&&ie.current&&typeof window<"u"&&window.innerWidth<768&&ie.current.scrollIntoView({behavior:"smooth",block:"start"})},[E]);const Z=async()=>{if(!(!n||!a||!l))try{k(!0);const ne={userId:n.uid,movieId:a,watched:E,favorite:C,updatedAt:new Date,vibeTags:P};if(E&&I)try{ne.watchedDate=new Date(I),isNaN(ne.watchedDate.getTime())&&delete ne.watchedDate}catch(Y){console.error("Error parsing watchedDate for save:",Y),delete ne.watchedDate}else E||(ne.watchedDate=null);ne.rating=O,ne.review=T||null;const ce=await i0(n.uid,a,ne);d(ce);const j=await fh(n.uid);if(j.length){const Y=j.map(K=>{var V;return((V=Qo.find(J=>J.id===K))==null?void 0:V.name)||K}).join(", ");s.success(`You unlocked: ${Y}! `)}}catch(ne){console.error("Error saving movie data:",ne),g("Failed to save movie data")}finally{k(!1)}},fe=async()=>{if(!n||!a)return;const ne=!C;b(ne);try{const ce=Ft(Me,"users",n.uid,"movies",a);(await Nn(ce)).exists()?await hi(ce,{favorite:ne,updatedAt:new Date}):await qn(ce,{userId:n.uid,movieId:a,favorite:ne,watched:!1,rating:null,review:"",vibeTags:[],addedAt:new Date,updatedAt:new Date},{merge:!0}),d(K=>K&&{...K,favorite:ne});const Y=await fh(n.uid);if(Y.length){const K=Y.map(V=>{var J;return((J=Qo.find(de=>de.id===V))==null?void 0:J.name)||V}).join(", ");s.success(`You unlocked: ${K}! `)}}catch(ce){console.error("Failed to toggle favorite",ce),b(!ne)}},ue=async()=>{if(!(!n||!a||!window.confirm("Are you sure you want to remove this movie from your collection?")))try{k(!0),await XL(n.uid,a),r("/movies")}catch(ne){console.error("Error deleting movie:",ne),g("Failed to delete movie"),k(!1)}},q=async()=>{if(!n||!a)return;const ne=!E;y(ne);try{const ce=Ft(Me,"users",n.uid,"movies",a),j=await Nn(ce),Y=j.exists()?!!j.data().watched:!1;j.exists()?await hi(ce,{watched:ne,...ne?{}:{watchedDate:null},updatedAt:new Date}):await qn(ce,{userId:n.uid,movieId:a,watched:ne,favorite:!1,rating:null,review:"",vibeTags:[],addedAt:new Date,updatedAt:new Date},{merge:!0}),d(V=>V&&{...V,watched:ne}),Y!==ne&&await ZL(ne?1:-1);const K=await fh(n.uid);if(K.length){const V=K.map(J=>{var de;return((de=Qo.find(Ee=>Ee.id===J))==null?void 0:de.name)||J}).join(", ");s.success(`You unlocked: ${V}! `)}}catch(ce){console.error("Failed to toggle watched",ce),y(!ne)}};return m?u.jsx("div",{className:"flex justify-center items-center min-h-[60vh]",children:u.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-xmas-gold"})}):l?u.jsxs("div",{className:"container mx-auto px-4 py-8",children:[u.jsx("div",{className:"mb-4",children:u.jsxs(Xe,{to:o,className:"btn btn-primary btn-sm sm:btn-md",children:[u.jsx("i",{className:"fas fa-arrow-left mr-2"})," Back to Movies"]})}),x&&u.jsxs("div",{className:"alert alert-error mb-6",children:[u.jsx("i",{className:"fas fa-exclamation-circle mr-2"}),u.jsx("span",{children:x})]}),u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-8",children:[u.jsxs("div",{className:"md:col-span-1",children:[u.jsx("div",{className:"rounded-lg overflow-hidden shadow-xl",children:l.posterUrl?u.jsx("img",{src:l.posterUrl,alt:l.title,className:"w-full object-contain",style:{aspectRatio:"2/3"}}):u.jsx("div",{className:"w-full flex items-center justify-center bg-gray-800",style:{aspectRatio:"2/3"},children:u.jsx("i",{className:"fas fa-film text-6xl text-gray-500"})})}),u.jsxs("div",{className:"mt-4 flex flex-col gap-2",children:[u.jsxs("button",{className:`btn ${C?"btn-primary":"btn-outline"} w-full`,onClick:fe,children:[u.jsx("i",{className:`fas fa-star mr-2 ${C?"text-white":""}`}),C?"Favourited":"Add to Favourites"]}),u.jsxs("button",{className:`btn ${E?"btn-success":"btn-outline"} w-full`,onClick:q,children:[u.jsx("i",{className:`fas fa-check mr-2 ${E?"text-white":""}`}),E?"Watched":"Mark as Watched"]}),u.jsxs("button",{className:"btn btn-error btn-outline w-full",onClick:ue,disabled:w,children:[u.jsx("i",{className:"fas fa-trash mr-2"}),"Remove from Collection"]})]})]}),u.jsxs("div",{className:"md:col-span-2",children:[u.jsx("h1",{className:"font-christmas text-3xl md:text-4xl text-xmas-line mb-2",children:l.title}),l.releaseDate&&u.jsx("p",{className:"text-lg text-gray-400 mb-4",children:new Date(l.releaseDate).getFullYear()}),l.genres&&l.genres.length>0&&u.jsx("div",{className:"flex flex-wrap gap-2 mb-4",children:l.genres.map((ne,ce)=>u.jsx("span",{className:"badge badge-outline",children:ne},ce))}),l.runtime&&u.jsxs("p",{className:"mb-4",children:[u.jsx("i",{className:"fas fa-clock mr-2 text-xmas-gold"}),Math.floor(l.runtime/60),"h ",l.runtime%60,"m"]}),l.overview&&u.jsxs("div",{className:"mb-6",children:[u.jsx("h2",{className:"text-xl font-bold mb-2",children:"Overview"}),u.jsx("p",{className:"text-gray-300",children:l.overview})]}),l.directors&&l.directors.length>0&&u.jsxs("div",{className:"mb-4",children:[u.jsxs("h2",{className:"text-xl font-bold mb-2",children:["Director",l.directors.length>1?"s":""]}),u.jsx("p",{children:l.directors.join(", ")})]}),l.cast&&l.cast.length>0&&u.jsxs("div",{className:"mb-6",children:[u.jsx("h2",{className:"text-xl font-bold mb-2",children:"Cast"}),u.jsx("p",{className:"flex flex-wrap gap-1",children:l.cast.slice(0,10).map((ne,ce)=>u.jsxs(wu.Fragment,{children:[u.jsx(Xe,{to:`/movies?q=${encodeURIComponent(ne)}&field=cast`,className:"link link-primary",children:ne}),ce<Math.min(l.cast.length,10)-1&&u.jsx("span",{children:","})]},ne))})]}),u.jsxs("div",{ref:ie,children:[u.jsx("div",{className:"divider"}),E&&u.jsx(o6,{watched:E,watchedDate:I,onWatchedDateChange:M,rating:O,onRatingChange:v,review:T,onReviewChange:S,vibeTags:P,onVibeChange:({tags:ne,autoReview:ce})=>{D(ne),S(ce)},saving:w,onSave:Z})]})]})]})]}):u.jsxs("div",{className:"container mx-auto px-4 py-8",children:[u.jsxs("div",{className:"alert alert-error",children:[u.jsx("i",{className:"fas fa-exclamation-circle mr-2"}),u.jsx("span",{children:"Movie not found"})]}),u.jsx("div",{className:"mt-4",children:u.jsxs(Xe,{to:o,className:"btn btn-primary btn-sm sm:btn-md",children:[u.jsx("i",{className:"fas fa-arrow-left mr-2"})," Back to Movies"]})})]})};function sd(e,t){let r=0;const n=(e.title||"").toLowerCase(),s=(t.Title||"").toLowerCase();if(n&&s)if(n===s)r+=60;else if(s.includes(n)||n.includes(s))r+=40;else{const a=n.split(" "),i=s.split(" "),o=a.filter(l=>i.includes(l));r+=o.length/Math.max(a.length,i.length)*40}if(e.releaseDate!=null&&t.Year){const a=String(e.releaseDate).slice(0,4),i=String(t.Year).slice(0,4),o=parseInt(a,10),l=parseInt(i,10);!isNaN(o)&&!isNaN(l)&&(o===l?r+=40:Math.abs(o-l)<=1&&(r+=20))}return Math.min(Math.round(r),100)}const dn=e=>e!=null&&e.Poster&&e.Poster!=="N/A"?e.Poster:(e==null?void 0:e.posterUrl)||"",c6=({onSelect:e,userMovieIds:t})=>{const r=Ls(),[n,s]=z.useState([]),[a,i]=z.useState(!0),[o,l]=z.useState(null),[c,f]=z.useState(""),[d,m]=z.useState("all"),[p,x]=z.useState("title-asc"),[g,w]=z.useState(!1);z.useEffect(()=>{(async()=>{try{i(!0),l(null);const O=(await zt(bt(Me,"movies"))).docs.map(v=>{var S;const T=v.data();return T.imdbId?{id:T.imdbId,title:T.title,release_date:T.releaseDate,poster_path:(S=T.posterUrl)!=null&&S.startsWith("https://image.tmdb.org/t/p/")?T.posterUrl.replace("https://image.tmdb.org/t/p/w500",""):null,posterUrl:T.posterUrl||null,source:"local",firestoreId:v.id,cast:T.cast||[],runtime:T.runtime,genres:T.genres||[],overview:T.overview}:null}).filter(Boolean);s(O)}catch(M){console.error("Error loading local catalogue:",M),l((M==null?void 0:M.message)??"Failed to load local catalogue")}finally{i(!1)}})()},[]);const k=z.useCallback(I=>{if(!c.trim())return!0;const M=c.toLowerCase().trim(),O=M.split(",").map(T=>T.trim()).filter(Boolean),v=T=>I.cast&&I.cast.some(S=>S.toLowerCase().includes(T));switch(d){case"title":return I.title.toLowerCase().includes(M);case"year":return I.release_date&&I.release_date.substring(0,4).includes(M);case"cast":return O.length?O.some(T=>v(T)):v(M);case"all":default:return I.title.toLowerCase().includes(M)||I.release_date&&I.release_date.substring(0,4).includes(M)||I.cast&&I.cast.some(T=>T.toLowerCase().includes(M))}},[c,d]),E=z.useMemo(()=>n.filter(I=>{if(!k(I))return!1;const M=!!I.firestoreId&&t.includes(I.firestoreId);return!(g&&M)}),[n,k,t,g]),y=z.useMemo(()=>{const I=[...E],M=O=>{if(!O.release_date)return 0;const v=parseInt(O.release_date.slice(0,4),10);return Number.isNaN(v)?0:v};return I.sort((O,v)=>{switch(p){case"title-asc":return O.title.localeCompare(v.title);case"title-desc":return v.title.localeCompare(O.title);case"year-desc":{const T=M(O);return M(v)-T||O.title.localeCompare(v.title)}case"year-asc":{const T=M(O),S=M(v);return T-S||O.title.localeCompare(v.title)}default:return 0}}),I},[E,p]);return u.jsxs("div",{className:"space-y-4",children:[u.jsxs("div",{className:"flex flex-col lg:flex-row gap-2",children:[u.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 flex-1",children:[u.jsxs("div",{className:"relative flex-grow",children:[u.jsx("div",{className:"absolute inset-y-0 left-0 pl-2 flex items-center pointer-events-none",children:u.jsx("i",{className:"fas fa-search text-gray-400"})}),u.jsx("input",{type:"text",className:"input input-bordered input-sm sm:input-md w-full pl-8 pr-8",placeholder:"   Search catalogue by title, cast, year...",value:c,onChange:I=>f(I.target.value)}),c&&u.jsx("button",{className:"absolute inset-y-0 right-0 pr-2 flex items-center",onClick:()=>f(""),children:u.jsx("i",{className:"fas fa-times text-gray-400 hover:text-gray-600"})})]}),u.jsxs("select",{className:"select select-bordered select-sm sm:select-md w-full sm:w-40",value:d,onChange:I=>m(I.target.value),children:[u.jsx("option",{value:"all",children:"All Fields"}),u.jsx("option",{value:"title",children:"Title Only"}),u.jsx("option",{value:"year",children:"Year Only"}),u.jsx("option",{value:"cast",children:"Cast Only"})]})]}),u.jsx("div",{className:"flex items-center justify-end",children:u.jsxs("select",{className:"select select-bordered select-sm sm:select-md w-full sm:w-52",value:p,onChange:I=>x(I.target.value),children:[u.jsx("option",{value:"title-asc",children:"Sort: Title (A  Z)"}),u.jsx("option",{value:"title-desc",children:"Sort: Title (Z  A)"}),u.jsx("option",{value:"year-desc",children:"Sort: Year (Newest  Oldest)"}),u.jsx("option",{value:"year-asc",children:"Sort: Year (Oldest  Newest)"})]})})]}),u.jsxs("div",{className:"flex flex-col xs:flex-row justify-between items-start xs:items-center text-xs sm:text-sm gap-2",children:[u.jsx("div",{children:a?u.jsx("span",{children:"Loading catalogue"}):u.jsxs(u.Fragment,{children:[u.jsx("span",{className:"font-medium",children:y.length})," ",y.length===1?"movie":"movies"," in catalogue",c&&u.jsxs("span",{className:"ml-1 opacity-70",children:["for: ",u.jsxs("span",{className:"font-medium",children:['"',c,'"']})]})]})}),u.jsxs("label",{className:"flex items-center gap-1 cursor-pointer select-none",children:[u.jsx("input",{type:"checkbox",className:"checkbox checkbox-xs sm:checkbox-sm",checked:g,onChange:I=>w(I.target.checked)}),u.jsx("span",{children:"Hide owned movies"})]})]}),o&&u.jsx("div",{className:"alert alert-error",children:o}),a&&u.jsx("div",{className:"flex justify-center p-6",children:u.jsx("span",{className:"loading loading-spinner loading-lg"})}),!a&&y.length===0&&!o&&u.jsxs("div",{className:"bg-xmas-card bg-opacity-60 rounded-lg p-6 text-center",children:[u.jsx("h3",{className:"text-lg font-semibold mb-2",children:"No movies found"}),u.jsx("p",{className:"text-sm opacity-80 mb-2",children:"Try changing your search text, field, or sort order."})]}),!a&&y.length>0&&u.jsx("div",{className:"grid grid-cols-3 sm:grid-cols-4 md:grid-cols-5 lg:grid-cols-6 gap-2 sm:gap-3",children:y.map(I=>{var O;const M=!!I.firestoreId&&t.includes(I.firestoreId);return u.jsx("div",{className:`block transition-transform hover:scale-[1.02] hover:shadow-xl ${M?"opacity-60 cursor-pointer":"cursor-pointer"}`,onClick:()=>{M&&I.firestoreId?r(Yx(I.title,I.firestoreId),{state:{from:"import"}}):e(I)},children:u.jsxs("div",{className:"relative rounded-lg overflow-hidden bg-xmas-card shadow-md h-full flex flex-col",children:[u.jsxs("div",{className:"relative",children:[dn(I)?u.jsx("img",{src:dn(I),alt:I.title,className:"w-full h-auto object-cover",style:{aspectRatio:"2/3"},loading:"lazy"}):u.jsx("div",{className:"w-full flex items-center justify-center bg-gray-800",style:{aspectRatio:"2/3"},children:u.jsx("i",{className:"fas fa-film text-2xl text-gray-500"})}),M&&u.jsxs("div",{className:`\r
                          absolute top-1 left-1 \r
                          badge badge-success \r
                          px-2 py-0.5 \r
                          text-[0.6rem] leading-none \r
                          whitespace-nowrap \r
                          flex items-center gap-1 \r
                          shadow\r
                        `,children:[u.jsx("i",{className:"fas fa-check text-[0.6rem]"}),u.jsx("span",{children:"Owned"})]})]}),u.jsxs("div",{className:"p-1 sm:p-2 flex-grow flex flex-col",children:[u.jsx("h3",{className:"text-xs sm:text-sm font-medium line-clamp-2",children:I.title}),u.jsx("p",{className:"text-xs text-gray-400 mt-1",children:(O=I.release_date)==null?void 0:O.slice(0,4)})]})]})},I.firestoreId||I.id)})})]})},oA=e=>{const t=e.trim();return/^The\s+/i.test(t)?t.replace(/^The\s+/i,"").trim():/^A\s+/i.test(t)?t.replace(/^A\s+/i,"").trim():/^An\s+/i.test(t)?t.replace(/^An\s+/i,"").trim():t},lA="https://www.omdbapi.com/",cA=e=>(e||"").toLowerCase().replace(/^(the|a|an)\s+/,"").replace(/[^a-z0-9]+/g," ").trim(),u6=e=>{const t=new Set,r=n=>{const s=cA(n||"");s&&(t.add(s),s.split(" ").forEach(a=>a&&t.add(a)))};return r(e.Title),e.Year&&t.add(e.Year),e.Genre&&e.Genre.split(",").forEach(n=>r(n)),e.Actors&&e.Actors.split(",").forEach(n=>r(n)),e.Director&&e.Director.split(",").forEach(n=>r(n)),Array.from(t).slice(0,200)},Vi=async(e,t)=>{const r=`${lA}?apikey=${t}&s=${encodeURIComponent(e)}&type=movie`,n=await fetch(r);if(!n.ok)throw new Error(`OMDb API error: ${n.status}`);const s=await n.json();if(s.Response==="False"||!s.Search)throw new Error(s.Error||"No results from OMDb");return s.Search},si=async(e,t)=>{const r=`${lA}?apikey=${t}&i=${encodeURIComponent(e)}&plot=full`,n=await fetch(r);if(!n.ok)throw new Error(`OMDb API error: ${n.status}`);const s=await n.json();if(s.Response==="False")throw new Error(s.Error||"Failed to fetch OMDb details");return s},uu=e=>{const t=e.Title,r=oA(t),n=cA(r),s=e.Year,a=e.Released&&e.Released!=="N/A"?e.Released:s&&s!=="N/A"?`${s}-01-01`:null,i=e.Runtime&&e.Runtime!=="N/A"?parseInt(e.Runtime,10):null,o=e.Genre&&e.Genre!=="N/A"?e.Genre.split(",").map(d=>d.trim()).filter(Boolean):[],l=e.Director&&e.Director!=="N/A"?e.Director.split(",").map(d=>d.trim()).filter(Boolean):[],c=e.Actors&&e.Actors!=="N/A"?e.Actors.split(",").map(d=>d.trim()).filter(Boolean):[],f=e.Plot&&e.Plot!=="N/A"?e.Plot:null;return{imdbId:e.imdbID,title:t,sortTitle:r,sortTitleLower:n,originalTitle:t,releaseDate:a,posterUrl:e.Poster&&e.Poster!=="N/A"?e.Poster:null,backdropUrl:null,overview:f,runtime:i,genres:o,directors:l,cast:c,isChristmas:!0,keywords:u6(e),updatedAt:new Date}},f6=({omdbApiKey:e,onSelect:t})=>{const[r,n]=z.useState(""),[s,a]=z.useState(!1),[i,o]=z.useState([]),[l,c]=z.useState(null),f=async()=>{if(r.trim())try{a(!0),c(null);const d=await Vi(r,e);o(d)}catch(d){c((d==null?void 0:d.message)??"OMDb search failed")}finally{a(!1)}};return u.jsxs("div",{className:"space-y-3",children:[u.jsxs("div",{className:"flex gap-2",children:[u.jsx("input",{className:"input input-bordered flex-1",value:r,onChange:d=>n(d.target.value),placeholder:"Search OMDb...",onKeyDown:d=>d.key==="Enter"&&f()}),u.jsx("button",{className:"btn btn-primary",onClick:f,disabled:s||!e,children:s?u.jsx("span",{className:"loading loading-spinner loading-sm"}):"Search"})]}),l&&u.jsx("div",{className:"alert alert-error",children:l}),i.length>0&&u.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-3",children:i.map(d=>u.jsxs("div",{className:"card bg-base-100 shadow cursor-pointer hover:shadow-lg transition-shadow",onClick:()=>t(d),children:[u.jsx("figure",{children:dn(d)?u.jsx("img",{src:dn(d),alt:d.Title,className:"w-full h-64 object-contain"}):u.jsx("div",{className:"h-64 w-full flex items-center justify-center bg-base-200",children:u.jsx("i",{className:"fas fa-film text-3xl opacity-50"})})}),u.jsxs("div",{className:"card-body p-3",children:[u.jsx("div",{className:"font-semibold",children:d.Title}),u.jsx("div",{className:"text-xs opacity-70",children:d.Year})]})]},d.imdbID))})]})};/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var uA=1252,h6=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],Xx={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},Qx=function(e){h6.indexOf(e)!=-1&&(uA=Xx[0]=e)};function d6(){Qx(1252)}var cs=function(e){Qx(e)};function fA(){cs(1200),d6()}function Z_(e){for(var t=[],r=0,n=e.length;r<n;++r)t[r]=e.charCodeAt(r);return t}function m6(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r)+(e.charCodeAt(2*r+1)<<8));return t.join("")}function hA(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r+1)+(e.charCodeAt(2*r)<<8));return t.join("")}var oc=function(e){var t=e.charCodeAt(0),r=e.charCodeAt(1);return t==255&&r==254?m6(e.slice(2)):t==254&&r==255?hA(e.slice(2)):t==65279?e.slice(1):e},Ff=function(t){return String.fromCharCode(t)},ew=function(t){return String.fromCharCode(t)},fu,Ha="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function tw(e){for(var t="",r=0,n=0,s=0,a=0,i=0,o=0,l=0,c=0;c<e.length;)r=e.charCodeAt(c++),a=r>>2,n=e.charCodeAt(c++),i=(r&3)<<4|n>>4,s=e.charCodeAt(c++),o=(n&15)<<2|s>>6,l=s&63,isNaN(n)?o=l=64:isNaN(s)&&(l=64),t+=Ha.charAt(a)+Ha.charAt(i)+Ha.charAt(o)+Ha.charAt(l);return t}function bn(e){var t="",r=0,n=0,s=0,a=0,i=0,o=0,l=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var c=0;c<e.length;)a=Ha.indexOf(e.charAt(c++)),i=Ha.indexOf(e.charAt(c++)),r=a<<2|i>>4,t+=String.fromCharCode(r),o=Ha.indexOf(e.charAt(c++)),n=(i&15)<<4|o>>2,o!==64&&(t+=String.fromCharCode(n)),l=Ha.indexOf(e.charAt(c++)),s=(o&3)<<6|l,l!==64&&(t+=String.fromCharCode(s));return t}var et=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),lo=function(){if(typeof Buffer<"u"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(t,r){return r?new Buffer(t,r):new Buffer(t)}:Buffer.from.bind(Buffer)}return function(){}}();function di(e){return et?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}function rw(e){return et?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}var os=function(t){return et?lo(t,"binary"):t.split("").map(function(r){return r.charCodeAt(0)&255})};function co(e){if(Array.isArray(e))return e.map(function(n){return String.fromCharCode(n)}).join("");for(var t=[],r=0;r<e.length;++r)t[r]=String.fromCharCode(e[r]);return t.join("")}function Jx(e){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(e instanceof ArrayBuffer)return Jx(new Uint8Array(e));for(var t=new Array(e.length),r=0;r<e.length;++r)t[r]=e[r];return t}var Va=et?function(e){return Buffer.concat(e.map(function(t){return Buffer.isBuffer(t)?t:lo(t)}))}:function(e){if(typeof Uint8Array<"u"){var t=0,r=0;for(t=0;t<e.length;++t)r+=e[t].length;var n=new Uint8Array(r),s=0;for(t=0,r=0;t<e.length;r+=s,++t)if(s=e[t].length,e[t]instanceof Uint8Array)n.set(e[t],r);else{if(typeof e[t]=="string")throw"wtf";n.set(new Uint8Array(e[t]),r)}return n}return[].concat.apply([],e.map(function(a){return Array.isArray(a)?a:[].slice.call(a)}))};function p6(e){for(var t=[],r=0,n=e.length+250,s=di(e.length+255),a=0;a<e.length;++a){var i=e.charCodeAt(a);if(i<128)s[r++]=i;else if(i<2048)s[r++]=192|i>>6&31,s[r++]=128|i&63;else if(i>=55296&&i<57344){i=(i&1023)+64;var o=e.charCodeAt(++a)&1023;s[r++]=240|i>>8&7,s[r++]=128|i>>2&63,s[r++]=128|o>>6&15|(i&3)<<4,s[r++]=128|o&63}else s[r++]=224|i>>12&15,s[r++]=128|i>>6&63,s[r++]=128|i&63;r>n&&(t.push(s.slice(0,r)),r=0,s=di(65535),n=65530)}return t.push(s.slice(0,r)),Va(t)}var en=/\u0000/g,lc=/[\u0001-\u0006]/g;function Jo(e){for(var t="",r=e.length-1;r>=0;)t+=e.charAt(r--);return t}function us(e,t){var r=""+e;return r.length>=t?r:Wt("0",t-r.length)+r}function Zx(e,t){var r=""+e;return r.length>=t?r:Wt(" ",t-r.length)+r}function ad(e,t){var r=""+e;return r.length>=t?r:r+Wt(" ",t-r.length)}function g6(e,t){var r=""+Math.round(e);return r.length>=t?r:Wt("0",t-r.length)+r}function x6(e,t){var r=""+e;return r.length>=t?r:Wt("0",t-r.length)+r}var nw=Math.pow(2,32);function To(e,t){if(e>nw||e<-nw)return g6(e,t);var r=Math.round(e);return x6(r,t)}function id(e,t){return t=t||0,e.length>=7+t&&(e.charCodeAt(t)|32)===103&&(e.charCodeAt(t+1)|32)===101&&(e.charCodeAt(t+2)|32)===110&&(e.charCodeAt(t+3)|32)===101&&(e.charCodeAt(t+4)|32)===114&&(e.charCodeAt(t+5)|32)===97&&(e.charCodeAt(t+6)|32)===108}var sw=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],nm=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function v6(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"/ "hh""mm""ss" "',e}var $e={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},aw={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},y6={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function od(e,t,r){for(var n=e<0?-1:1,s=e*n,a=0,i=1,o=0,l=1,c=0,f=0,d=Math.floor(s);c<t&&(d=Math.floor(s),o=d*i+a,f=d*c+l,!(s-d<5e-8));)s=1/(s-d),a=i,i=o,l=c,c=f;if(f>t&&(c>t?(f=l,o=a):(f=c,o=i)),!r)return[0,n*o,f];var m=Math.floor(n*o/f);return[m,n*o-m*f,f]}function Oi(e,t,r){if(e>2958465||e<0)return null;var n=e|0,s=Math.floor(86400*(e-n)),a=0,i=[],o={D:n,T:s,u:86400*(e-n)-s,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(o.u)<1e-6&&(o.u=0),t&&t.date1904&&(n+=1462),o.u>.9999&&(o.u=0,++s==86400&&(o.T=s=0,++n,++o.D)),n===60)i=r?[1317,10,29]:[1900,2,29],a=3;else if(n===0)i=r?[1317,8,29]:[1900,1,0],a=6;else{n>60&&--n;var l=new Date(1900,0,1);l.setDate(l.getDate()+n-1),i=[l.getFullYear(),l.getMonth()+1,l.getDate()],a=l.getDay(),n<60&&(a=(a+6)%7),r&&(a=S6(l,i))}return o.y=i[0],o.m=i[1],o.d=i[2],o.S=s%60,s=Math.floor(s/60),o.M=s%60,s=Math.floor(s/60),o.H=s,o.q=a,o}var dA=new Date(1899,11,31,0,0,0),_6=dA.getTime(),w6=new Date(1900,2,1,0,0,0);function mA(e,t){var r=e.getTime();return t?r-=1461*24*60*60*1e3:e>=w6&&(r+=24*60*60*1e3),(r-(_6+(e.getTimezoneOffset()-dA.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function ev(e){return e.indexOf(".")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function E6(e){return e.indexOf("E")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function T6(e){var t=e<0?12:11,r=ev(e.toFixed(12));return r.length<=t||(r=e.toPrecision(10),r.length<=t)?r:e.toExponential(5)}function k6(e){var t=ev(e.toFixed(11));return t.length>(e<0?12:11)||t==="0"||t==="-0"?e.toPrecision(6):t}function hu(e){var t=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),r;return t>=-4&&t<=-1?r=e.toPrecision(10+t):Math.abs(t)<=9?r=T6(e):t===10?r=e.toFixed(10).substr(0,12):r=k6(e),ev(E6(r.toUpperCase()))}function Zi(e,t){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):hu(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return Yn(14,mA(e,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+e)}function S6(e,t){t[0]-=581;var r=e.getDay();return e<60&&(r=(r+6)%7),r}function A6(e,t,r,n){var s="",a=0,i=0,o=r.y,l,c=0;switch(e){case 98:o=r.y+543;case 121:switch(t.length){case 1:case 2:l=o%100,c=2;break;default:l=o%1e4,c=4;break}break;case 109:switch(t.length){case 1:case 2:l=r.m,c=t.length;break;case 3:return nm[r.m-1][1];case 5:return nm[r.m-1][0];default:return nm[r.m-1][2]}break;case 100:switch(t.length){case 1:case 2:l=r.d,c=t.length;break;case 3:return sw[r.q][0];default:return sw[r.q][1]}break;case 104:switch(t.length){case 1:case 2:l=1+(r.H+11)%12,c=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:l=r.H,c=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:l=r.M,c=t.length;break;default:throw"bad minute format: "+t}break;case 115:if(t!="s"&&t!="ss"&&t!=".0"&&t!=".00"&&t!=".000")throw"bad second format: "+t;return r.u===0&&(t=="s"||t=="ss")?us(r.S,t.length):(n>=2?i=n===3?1e3:100:i=n===1?10:1,a=Math.round(i*(r.S+r.u)),a>=60*i&&(a=0),t==="s"?a===0?"0":""+a/i:(s=us(a,2+n),t==="ss"?s.substr(0,2):"."+s.substr(2,t.length-1)));case 90:switch(t){case"[h]":case"[hh]":l=r.D*24+r.H;break;case"[m]":case"[mm]":l=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":l=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+t}c=t.length===3?1:2;break;case 101:l=o,c=1;break}var f=c>0?us(l,c):"";return f}function Ga(e){var t=3;if(e.length<=t)return e;for(var r=e.length%t,n=e.substr(0,r);r!=e.length;r+=t)n+=(n.length>0?",":"")+e.substr(r,t);return n}var pA=/%/g;function I6(e,t,r){var n=t.replace(pA,""),s=t.length-n.length;return la(e,n,r*Math.pow(10,2*s))+Wt("%",s)}function N6(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return la(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function gA(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+gA(e,-t);var s=e.indexOf(".");s===-1&&(s=e.indexOf("E"));var a=Math.floor(Math.log(t)*Math.LOG10E)%s;if(a<0&&(a+=s),r=(t/Math.pow(10,a)).toPrecision(n+1+(s+a)%s),r.indexOf("e")===-1){var i=Math.floor(Math.log(t)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(i-r.length+a):r+="E+"+(i-a);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,s)+"."+r.substr(2+s),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,l,c,f){return l+c+f.substr(0,(s+a)%s)+"."+f.substr(a)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var xA=/# (\?+)( ?)\/( ?)(\d+)/;function C6(e,t,r){var n=parseInt(e[4],10),s=Math.round(t*n),a=Math.floor(s/n),i=s-a*n,o=n;return r+(a===0?"":""+a)+" "+(i===0?Wt(" ",e[1].length+1+e[4].length):Zx(i,e[1].length)+e[2]+"/"+e[3]+us(o,e[4].length))}function b6(e,t,r){return r+(t===0?"":""+t)+Wt(" ",e[1].length+2+e[4].length)}var vA=/^#*0*\.([0#]+)/,yA=/\).*[0#]/,_A=/\(###\) ###\\?-####/;function Yr(e){for(var t="",r,n=0;n!=e.length;++n)switch(r=e.charCodeAt(n)){case 35:break;case 63:t+=" ";break;case 48:t+="0";break;default:t+=String.fromCharCode(r)}return t}function iw(e,t){var r=Math.pow(10,t);return""+Math.round(e*r)/r}function ow(e,t){var r=e-Math.floor(e),n=Math.pow(10,t);return t<(""+Math.round(r*n)).length?0:Math.round(r*n)}function R6(e,t){return t<(""+Math.round((e-Math.floor(e))*Math.pow(10,t))).length?1:0}function P6(e){return e<2147483647&&e>-2147483648?""+(e>=0?e|0:e-1|0):""+Math.floor(e)}function jn(e,t,r){if(e.charCodeAt(0)===40&&!t.match(yA)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?jn("n",n,r):"("+jn("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return N6(e,t,r);if(t.indexOf("%")!==-1)return I6(e,t,r);if(t.indexOf("E")!==-1)return gA(t,r);if(t.charCodeAt(0)===36)return"$"+jn(e,t.substr(t.charAt(1)==" "?2:1),r);var s,a,i,o,l=Math.abs(r),c=r<0?"-":"";if(t.match(/^00+$/))return c+To(l,t.length);if(t.match(/^[#?]+$/))return s=To(r,0),s==="0"&&(s=""),s.length>t.length?s:Yr(t.substr(0,t.length-s.length))+s;if(a=t.match(xA))return C6(a,l,c);if(t.match(/^#+0+$/))return c+To(l,t.length-t.indexOf("0"));if(a=t.match(vA))return s=iw(r,a[1].length).replace(/^([^\.]+)$/,"$1."+Yr(a[1])).replace(/\.$/,"."+Yr(a[1])).replace(/\.(\d*)$/,function(x,g){return"."+g+Wt("0",Yr(a[1]).length-g.length)}),t.indexOf("0.")!==-1?s:s.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),a=t.match(/^(0*)\.(#*)$/))return c+iw(l,a[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,a[1].length?"0.":".");if(a=t.match(/^#{1,3},##0(\.?)$/))return c+Ga(To(l,0));if(a=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+jn(e,t,-r):Ga(""+(Math.floor(r)+R6(r,a[1].length)))+"."+us(ow(r,a[1].length),a[1].length);if(a=t.match(/^#,#*,#0/))return jn(e,t.replace(/^#,#*,/,""),r);if(a=t.match(/^([0#]+)(\\?-([0#]+))+$/))return s=Jo(jn(e,t.replace(/[\\-]/g,""),r)),i=0,Jo(Jo(t.replace(/\\/g,"")).replace(/[0#]/g,function(x){return i<s.length?s.charAt(i++):x==="0"?"0":""}));if(t.match(_A))return s=jn(e,"##########",r),"("+s.substr(0,3)+") "+s.substr(3,3)+"-"+s.substr(6);var f="";if(a=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(a[4].length,7),o=od(l,Math.pow(10,i)-1,!1),s=""+c,f=la("n",a[1],o[1]),f.charAt(f.length-1)==" "&&(f=f.substr(0,f.length-1)+"0"),s+=f+a[2]+"/"+a[3],f=ad(o[2],i),f.length<a[4].length&&(f=Yr(a[4].substr(a[4].length-f.length))+f),s+=f,s;if(a=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(Math.max(a[1].length,a[4].length),7),o=od(l,Math.pow(10,i)-1,!0),c+(o[0]||(o[1]?"":"0"))+" "+(o[1]?Zx(o[1],i)+a[2]+"/"+a[3]+ad(o[2],i):Wt(" ",2*i+1+a[2].length+a[3].length));if(a=t.match(/^[#0?]+$/))return s=To(r,0),t.length<=s.length?s:Yr(t.substr(0,t.length-s.length))+s;if(a=t.match(/^([#0?]+)\.([#0]+)$/)){s=""+r.toFixed(Math.min(a[2].length,10)).replace(/([^0])0+$/,"$1"),i=s.indexOf(".");var d=t.indexOf(".")-i,m=t.length-s.length-d;return Yr(t.substr(0,d)+s+t.substr(t.length-m))}if(a=t.match(/^00,000\.([#0]*0)$/))return i=ow(r,a[1].length),r<0?"-"+jn(e,t,-r):Ga(P6(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(x){return"00,"+(x.length<3?us(0,3-x.length):"")+x})+"."+us(i,a[1].length);switch(t){case"###,##0.00":return jn(e,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var p=Ga(To(l,0));return p!=="0"?c+p:"";case"###,###.00":return jn(e,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return jn(e,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+t+"|")}function D6(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return la(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function F6(e,t,r){var n=t.replace(pA,""),s=t.length-n.length;return la(e,n,r*Math.pow(10,2*s))+Wt("%",s)}function wA(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+wA(e,-t);var s=e.indexOf(".");s===-1&&(s=e.indexOf("E"));var a=Math.floor(Math.log(t)*Math.LOG10E)%s;if(a<0&&(a+=s),r=(t/Math.pow(10,a)).toPrecision(n+1+(s+a)%s),!r.match(/[Ee]/)){var i=Math.floor(Math.log(t)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(i-r.length+a):r+="E+"+(i-a),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,l,c,f){return l+c+f.substr(0,(s+a)%s)+"."+f.substr(a)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function Es(e,t,r){if(e.charCodeAt(0)===40&&!t.match(yA)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Es("n",n,r):"("+Es("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return D6(e,t,r);if(t.indexOf("%")!==-1)return F6(e,t,r);if(t.indexOf("E")!==-1)return wA(t,r);if(t.charCodeAt(0)===36)return"$"+Es(e,t.substr(t.charAt(1)==" "?2:1),r);var s,a,i,o,l=Math.abs(r),c=r<0?"-":"";if(t.match(/^00+$/))return c+us(l,t.length);if(t.match(/^[#?]+$/))return s=""+r,r===0&&(s=""),s.length>t.length?s:Yr(t.substr(0,t.length-s.length))+s;if(a=t.match(xA))return b6(a,l,c);if(t.match(/^#+0+$/))return c+us(l,t.length-t.indexOf("0"));if(a=t.match(vA))return s=(""+r).replace(/^([^\.]+)$/,"$1."+Yr(a[1])).replace(/\.$/,"."+Yr(a[1])),s=s.replace(/\.(\d*)$/,function(x,g){return"."+g+Wt("0",Yr(a[1]).length-g.length)}),t.indexOf("0.")!==-1?s:s.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),a=t.match(/^(0*)\.(#*)$/))return c+(""+l).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,a[1].length?"0.":".");if(a=t.match(/^#{1,3},##0(\.?)$/))return c+Ga(""+l);if(a=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Es(e,t,-r):Ga(""+r)+"."+Wt("0",a[1].length);if(a=t.match(/^#,#*,#0/))return Es(e,t.replace(/^#,#*,/,""),r);if(a=t.match(/^([0#]+)(\\?-([0#]+))+$/))return s=Jo(Es(e,t.replace(/[\\-]/g,""),r)),i=0,Jo(Jo(t.replace(/\\/g,"")).replace(/[0#]/g,function(x){return i<s.length?s.charAt(i++):x==="0"?"0":""}));if(t.match(_A))return s=Es(e,"##########",r),"("+s.substr(0,3)+") "+s.substr(3,3)+"-"+s.substr(6);var f="";if(a=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(a[4].length,7),o=od(l,Math.pow(10,i)-1,!1),s=""+c,f=la("n",a[1],o[1]),f.charAt(f.length-1)==" "&&(f=f.substr(0,f.length-1)+"0"),s+=f+a[2]+"/"+a[3],f=ad(o[2],i),f.length<a[4].length&&(f=Yr(a[4].substr(a[4].length-f.length))+f),s+=f,s;if(a=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(Math.max(a[1].length,a[4].length),7),o=od(l,Math.pow(10,i)-1,!0),c+(o[0]||(o[1]?"":"0"))+" "+(o[1]?Zx(o[1],i)+a[2]+"/"+a[3]+ad(o[2],i):Wt(" ",2*i+1+a[2].length+a[3].length));if(a=t.match(/^[#0?]+$/))return s=""+r,t.length<=s.length?s:Yr(t.substr(0,t.length-s.length))+s;if(a=t.match(/^([#0]+)\.([#0]+)$/)){s=""+r.toFixed(Math.min(a[2].length,10)).replace(/([^0])0+$/,"$1"),i=s.indexOf(".");var d=t.indexOf(".")-i,m=t.length-s.length-d;return Yr(t.substr(0,d)+s+t.substr(t.length-m))}if(a=t.match(/^00,000\.([#0]*0)$/))return r<0?"-"+Es(e,t,-r):Ga(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(x){return"00,"+(x.length<3?us(0,3-x.length):"")+x})+"."+us(0,a[1].length);switch(t){case"###,###":case"##,###":case"#,###":var p=Ga(""+l);return p!=="0"?c+p:"";default:if(t.match(/\.[0#?]*$/))return Es(e,t.slice(0,t.lastIndexOf(".")),r)+Yr(t.slice(t.lastIndexOf(".")))}throw new Error("unsupported format |"+t+"|")}function la(e,t,r){return(r|0)===r?Es(e,t,r):jn(e,t,r)}function O6(e){for(var t=[],r=!1,n=0,s=0;n<e.length;++n)switch(e.charCodeAt(n)){case 34:r=!r;break;case 95:case 42:case 92:++n;break;case 59:t[t.length]=e.substr(s,n-s),s=n+1}if(t[t.length]=e.substr(s),r===!0)throw new Error("Format |"+e+"| unterminated string ");return t}var EA=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function Nl(e){for(var t=0,r="",n="";t<e.length;)switch(r=e.charAt(t)){case"G":id(e,t)&&(t+=6),t++;break;case'"':for(;e.charCodeAt(++t)!==34&&t<e.length;);++t;break;case"\\":t+=2;break;case"_":t+=2;break;case"@":++t;break;case"B":case"b":if(e.charAt(t+1)==="1"||e.charAt(t+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(e.substr(t,3).toUpperCase()==="A/P"||e.substr(t,5).toUpperCase()==="AM/PM"||e.substr(t,5).toUpperCase()==="/")return!0;++t;break;case"[":for(n=r;e.charAt(t++)!=="]"&&t<e.length;)n+=e.charAt(t);if(n.match(EA))return!0;break;case".":case"0":case"#":for(;t<e.length&&("0#?.,E+-%".indexOf(r=e.charAt(++t))>-1||r=="\\"&&e.charAt(t+1)=="-"&&"0#".indexOf(e.charAt(t+2))>-1););break;case"?":for(;e.charAt(++t)===r;);break;case"*":++t,(e.charAt(t)==" "||e.charAt(t)=="*")&&++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<e.length&&"0123456789".indexOf(e.charAt(++t))>-1;);break;case" ":++t;break;default:++t;break}return!1}function M6(e,t,r,n){for(var s=[],a="",i=0,o="",l="t",c,f,d,m="H";i<e.length;)switch(o=e.charAt(i)){case"G":if(!id(e,i))throw new Error("unrecognized character "+o+" in "+e);s[s.length]={t:"G",v:"General"},i+=7;break;case'"':for(a="";(d=e.charCodeAt(++i))!==34&&i<e.length;)a+=String.fromCharCode(d);s[s.length]={t:"t",v:a},++i;break;case"\\":var p=e.charAt(++i),x=p==="("||p===")"?p:"t";s[s.length]={t:x,v:p},++i;break;case"_":s[s.length]={t:"t",v:" "},i+=2;break;case"@":s[s.length]={t:"T",v:t},++i;break;case"B":case"b":if(e.charAt(i+1)==="1"||e.charAt(i+1)==="2"){if(c==null&&(c=Oi(t,r,e.charAt(i+1)==="2"),c==null))return"";s[s.length]={t:"X",v:e.substr(i,2)},l=o,i+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":o=o.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0||c==null&&(c=Oi(t,r),c==null))return"";for(a=o;++i<e.length&&e.charAt(i).toLowerCase()===o;)a+=o;o==="m"&&l.toLowerCase()==="h"&&(o="M"),o==="h"&&(o=m),s[s.length]={t:o,v:a},l=o;break;case"A":case"a":case"":var g={t:o,v:o};if(c==null&&(c=Oi(t,r)),e.substr(i,3).toUpperCase()==="A/P"?(c!=null&&(g.v=c.H>=12?"P":"A"),g.t="T",m="h",i+=3):e.substr(i,5).toUpperCase()==="AM/PM"?(c!=null&&(g.v=c.H>=12?"PM":"AM"),g.t="T",i+=5,m="h"):e.substr(i,5).toUpperCase()==="/"?(c!=null&&(g.v=c.H>=12?"":""),g.t="T",i+=5,m="h"):(g.t="t",++i),c==null&&g.t==="T")return"";s[s.length]=g,l=o;break;case"[":for(a=o;e.charAt(i++)!=="]"&&i<e.length;)a+=e.charAt(i);if(a.slice(-1)!=="]")throw'unterminated "[" block: |'+a+"|";if(a.match(EA)){if(c==null&&(c=Oi(t,r),c==null))return"";s[s.length]={t:"Z",v:a.toLowerCase()},l=a.charAt(1)}else a.indexOf("$")>-1&&(a=(a.match(/\$([^-\[\]]*)/)||[])[1]||"$",Nl(e)||(s[s.length]={t:"t",v:a}));break;case".":if(c!=null){for(a=o;++i<e.length&&(o=e.charAt(i))==="0";)a+=o;s[s.length]={t:"s",v:a};break}case"0":case"#":for(a=o;++i<e.length&&"0#?.,E+-%".indexOf(o=e.charAt(i))>-1;)a+=o;s[s.length]={t:"n",v:a};break;case"?":for(a=o;e.charAt(++i)===o;)a+=o;s[s.length]={t:o,v:a},l=o;break;case"*":++i,(e.charAt(i)==" "||e.charAt(i)=="*")&&++i;break;case"(":case")":s[s.length]={t:n===1?"t":o,v:o},++i;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(a=o;i<e.length&&"0123456789".indexOf(e.charAt(++i))>-1;)a+=e.charAt(i);s[s.length]={t:"D",v:a};break;case" ":s[s.length]={t:o,v:o},++i;break;case"$":s[s.length]={t:"t",v:"$"},++i;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(o)===-1)throw new Error("unrecognized character "+o+" in "+e);s[s.length]={t:"t",v:o},++i;break}var w=0,k=0,E;for(i=s.length-1,l="t";i>=0;--i)switch(s[i].t){case"h":case"H":s[i].t=m,l="h",w<1&&(w=1);break;case"s":(E=s[i].v.match(/\.0+$/))&&(k=Math.max(k,E[0].length-1)),w<3&&(w=3);case"d":case"y":case"M":case"e":l=s[i].t;break;case"m":l==="s"&&(s[i].t="M",w<2&&(w=2));break;case"X":break;case"Z":w<1&&s[i].v.match(/[Hh]/)&&(w=1),w<2&&s[i].v.match(/[Mm]/)&&(w=2),w<3&&s[i].v.match(/[Ss]/)&&(w=3)}switch(w){case 0:break;case 1:c.u>=.5&&(c.u=0,++c.S),c.S>=60&&(c.S=0,++c.M),c.M>=60&&(c.M=0,++c.H);break;case 2:c.u>=.5&&(c.u=0,++c.S),c.S>=60&&(c.S=0,++c.M);break}var y="",I;for(i=0;i<s.length;++i)switch(s[i].t){case"t":case"T":case" ":case"D":break;case"X":s[i].v="",s[i].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":s[i].v=A6(s[i].t.charCodeAt(0),s[i].v,c,k),s[i].t="t";break;case"n":case"?":for(I=i+1;s[I]!=null&&((o=s[I].t)==="?"||o==="D"||(o===" "||o==="t")&&s[I+1]!=null&&(s[I+1].t==="?"||s[I+1].t==="t"&&s[I+1].v==="/")||s[i].t==="("&&(o===" "||o==="n"||o===")")||o==="t"&&(s[I].v==="/"||s[I].v===" "&&s[I+1]!=null&&s[I+1].t=="?"));)s[i].v+=s[I].v,s[I]={v:"",t:";"},++I;y+=s[i].v,i=I-1;break;case"G":s[i].t="t",s[i].v=Zi(t,r);break}var M="",O,v;if(y.length>0){y.charCodeAt(0)==40?(O=t<0&&y.charCodeAt(0)===45?-t:t,v=la("n",y,O)):(O=t<0&&n>1?-t:t,v=la("n",y,O),O<0&&s[0]&&s[0].t=="t"&&(v=v.substr(1),s[0].v="-"+s[0].v)),I=v.length-1;var T=s.length;for(i=0;i<s.length;++i)if(s[i]!=null&&s[i].t!="t"&&s[i].v.indexOf(".")>-1){T=i;break}var S=s.length;if(T===s.length&&v.indexOf("E")===-1){for(i=s.length-1;i>=0;--i)s[i]==null||"n?".indexOf(s[i].t)===-1||(I>=s[i].v.length-1?(I-=s[i].v.length,s[i].v=v.substr(I+1,s[i].v.length)):I<0?s[i].v="":(s[i].v=v.substr(0,I+1),I=-1),s[i].t="t",S=i);I>=0&&S<s.length&&(s[S].v=v.substr(0,I+1)+s[S].v)}else if(T!==s.length&&v.indexOf("E")===-1){for(I=v.indexOf(".")-1,i=T;i>=0;--i)if(!(s[i]==null||"n?".indexOf(s[i].t)===-1)){for(f=s[i].v.indexOf(".")>-1&&i===T?s[i].v.indexOf(".")-1:s[i].v.length-1,M=s[i].v.substr(f+1);f>=0;--f)I>=0&&(s[i].v.charAt(f)==="0"||s[i].v.charAt(f)==="#")&&(M=v.charAt(I--)+M);s[i].v=M,s[i].t="t",S=i}for(I>=0&&S<s.length&&(s[S].v=v.substr(0,I+1)+s[S].v),I=v.indexOf(".")+1,i=T;i<s.length;++i)if(!(s[i]==null||"n?(".indexOf(s[i].t)===-1&&i!==T)){for(f=s[i].v.indexOf(".")>-1&&i===T?s[i].v.indexOf(".")+1:0,M=s[i].v.substr(0,f);f<s[i].v.length;++f)I<v.length&&(M+=v.charAt(I++));s[i].v=M,s[i].t="t",S=i}}}for(i=0;i<s.length;++i)s[i]!=null&&"n?".indexOf(s[i].t)>-1&&(O=n>1&&t<0&&i>0&&s[i-1].v==="-"?-t:t,s[i].v=la(s[i].t,s[i].v,O),s[i].t="t");var C="";for(i=0;i!==s.length;++i)s[i]!=null&&(C+=s[i].v);return C}var lw=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function cw(e,t){if(t==null)return!1;var r=parseFloat(t[2]);switch(t[1]){case"=":if(e==r)return!0;break;case">":if(e>r)return!0;break;case"<":if(e<r)return!0;break;case"<>":if(e!=r)return!0;break;case">=":if(e>=r)return!0;break;case"<=":if(e<=r)return!0;break}return!1}function L6(e,t){var r=O6(e),n=r.length,s=r[n-1].indexOf("@");if(n<4&&s>-1&&--n,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof t!="number")return[4,r.length===4||s>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=s>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=s>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=s>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var a=t>0?r[0]:t<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[n,a];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var i=r[0].match(lw),o=r[1].match(lw);return cw(t,i)?[n,r[0]]:cw(t,o)?[n,r[1]]:[n,r[i!=null&&o!=null?2:1]]}return[n,a]}function Yn(e,t,r){r==null&&(r={});var n="";switch(typeof e){case"string":e=="m/d/yy"&&r.dateNF?n=r.dateNF:n=e;break;case"number":e==14&&r.dateNF?n=r.dateNF:n=(r.table!=null?r.table:$e)[e],n==null&&(n=r.table&&r.table[aw[e]]||$e[aw[e]]),n==null&&(n=y6[e]||"General");break}if(id(n,0))return Zi(t,r);t instanceof Date&&(t=mA(t,r.date1904));var s=L6(n,t);if(id(s[1]))return Zi(t,r);if(t===!0)t="TRUE";else if(t===!1)t="FALSE";else if(t===""||t==null)return"";return M6(s[1],t,r,s[0])}function Bi(e,t){if(typeof t!="number"){t=+t||-1;for(var r=0;r<392;++r){if($e[r]==null){t<0&&(t=r);continue}if($e[r]==e){t=r;break}}t<0&&(t=391)}return $e[t]=e,t}function TA(){$e=v6()}var j6={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},kA=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function U6(e){var t=typeof e=="number"?$e[e]:e;return t=t.replace(kA,"(\\d+)"),new RegExp("^"+t+"$")}function V6(e,t,r){var n=-1,s=-1,a=-1,i=-1,o=-1,l=-1;(t.match(kA)||[]).forEach(function(d,m){var p=parseInt(r[m+1],10);switch(d.toLowerCase().charAt(0)){case"y":n=p;break;case"d":a=p;break;case"h":i=p;break;case"s":l=p;break;case"m":i>=0?o=p:s=p;break}}),l>=0&&o==-1&&s>=0&&(o=s,s=-1);var c=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(s>=1?s:1)).slice(-2)+"-"+("00"+(a>=1?a:1)).slice(-2);c.length==7&&(c="0"+c),c.length==8&&(c="20"+c);var f=("00"+(i>=0?i:0)).slice(-2)+":"+("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(l>=0?l:0)).slice(-2);return i==-1&&o==-1&&l==-1?c:n==-1&&s==-1&&a==-1?f:c+"T"+f}var B6=function(){var e={};e.version="1.2.0";function t(){for(var v=0,T=new Array(256),S=0;S!=256;++S)v=S,v=v&1?-306674912^v>>>1:v>>>1,v=v&1?-306674912^v>>>1:v>>>1,v=v&1?-306674912^v>>>1:v>>>1,v=v&1?-306674912^v>>>1:v>>>1,v=v&1?-306674912^v>>>1:v>>>1,v=v&1?-306674912^v>>>1:v>>>1,v=v&1?-306674912^v>>>1:v>>>1,v=v&1?-306674912^v>>>1:v>>>1,T[S]=v;return typeof Int32Array<"u"?new Int32Array(T):T}var r=t();function n(v){var T=0,S=0,C=0,b=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(C=0;C!=256;++C)b[C]=v[C];for(C=0;C!=256;++C)for(S=v[C],T=256+C;T<4096;T+=256)S=b[T]=S>>>8^v[S&255];var P=[];for(C=1;C!=16;++C)P[C-1]=typeof Int32Array<"u"?b.subarray(C*256,C*256+256):b.slice(C*256,C*256+256);return P}var s=n(r),a=s[0],i=s[1],o=s[2],l=s[3],c=s[4],f=s[5],d=s[6],m=s[7],p=s[8],x=s[9],g=s[10],w=s[11],k=s[12],E=s[13],y=s[14];function I(v,T){for(var S=T^-1,C=0,b=v.length;C<b;)S=S>>>8^r[(S^v.charCodeAt(C++))&255];return~S}function M(v,T){for(var S=T^-1,C=v.length-15,b=0;b<C;)S=y[v[b++]^S&255]^E[v[b++]^S>>8&255]^k[v[b++]^S>>16&255]^w[v[b++]^S>>>24]^g[v[b++]]^x[v[b++]]^p[v[b++]]^m[v[b++]]^d[v[b++]]^f[v[b++]]^c[v[b++]]^l[v[b++]]^o[v[b++]]^i[v[b++]]^a[v[b++]]^r[v[b++]];for(C+=15;b<C;)S=S>>>8^r[(S^v[b++])&255];return~S}function O(v,T){for(var S=T^-1,C=0,b=v.length,P=0,D=0;C<b;)P=v.charCodeAt(C++),P<128?S=S>>>8^r[(S^P)&255]:P<2048?(S=S>>>8^r[(S^(192|P>>6&31))&255],S=S>>>8^r[(S^(128|P&63))&255]):P>=55296&&P<57344?(P=(P&1023)+64,D=v.charCodeAt(C++)&1023,S=S>>>8^r[(S^(240|P>>8&7))&255],S=S>>>8^r[(S^(128|P>>2&63))&255],S=S>>>8^r[(S^(128|D>>6&15|(P&3)<<4))&255],S=S>>>8^r[(S^(128|D&63))&255]):(S=S>>>8^r[(S^(224|P>>12&15))&255],S=S>>>8^r[(S^(128|P>>6&63))&255],S=S>>>8^r[(S^(128|P&63))&255]);return~S}return e.table=r,e.bstr=I,e.buf=M,e.str=O,e}(),st=function(){var t={};t.version="1.2.1";function r(N,B){for(var R=N.split("/"),F=B.split("/"),L=0,U=0,Q=Math.min(R.length,F.length);L<Q;++L){if(U=R[L].length-F[L].length)return U;if(R[L]!=F[L])return R[L]<F[L]?-1:1}return R.length-F.length}function n(N){if(N.charAt(N.length-1)=="/")return N.slice(0,-1).indexOf("/")===-1?N:n(N.slice(0,-1));var B=N.lastIndexOf("/");return B===-1?N:N.slice(0,B+1)}function s(N){if(N.charAt(N.length-1)=="/")return s(N.slice(0,-1));var B=N.lastIndexOf("/");return B===-1?N:N.slice(B+1)}function a(N,B){typeof B=="string"&&(B=new Date(B));var R=B.getHours();R=R<<6|B.getMinutes(),R=R<<5|B.getSeconds()>>>1,N.write_shift(2,R);var F=B.getFullYear()-1980;F=F<<4|B.getMonth()+1,F=F<<5|B.getDate(),N.write_shift(2,F)}function i(N){var B=N.read_shift(2)&65535,R=N.read_shift(2)&65535,F=new Date,L=R&31;R>>>=5;var U=R&15;R>>>=4,F.setMilliseconds(0),F.setFullYear(R+1980),F.setMonth(U-1),F.setDate(L);var Q=B&31;B>>>=5;var ae=B&63;return B>>>=6,F.setHours(B),F.setMinutes(ae),F.setSeconds(Q<<1),F}function o(N){wr(N,0);for(var B={},R=0;N.l<=N.length-4;){var F=N.read_shift(2),L=N.read_shift(2),U=N.l+L,Q={};switch(F){case 21589:R=N.read_shift(1),R&1&&(Q.mtime=N.read_shift(4)),L>5&&(R&2&&(Q.atime=N.read_shift(4)),R&4&&(Q.ctime=N.read_shift(4))),Q.mtime&&(Q.mt=new Date(Q.mtime*1e3));break}N.l=U,B[F]=Q}return B}var l;function c(){return l||(l={})}function f(N,B){if(N[0]==80&&N[1]==75)return Sa(N,B);if((N[0]|32)==109&&(N[1]|32)==105)return xo(N,B);if(N.length<512)throw new Error("CFB file size "+N.length+" < 512");var R=3,F=512,L=0,U=0,Q=0,ae=0,se=0,re=[],ee=N.slice(0,512);wr(ee,0);var me=d(ee);switch(R=me[0],R){case 3:F=512;break;case 4:F=4096;break;case 0:if(me[1]==0)return Sa(N,B);default:throw new Error("Major Version: Expected 3 or 4 saw "+R)}F!==512&&(ee=N.slice(0,F),wr(ee,28));var Te=N.slice(0,F);m(ee,R);var Ne=ee.read_shift(4,"i");if(R===3&&Ne!==0)throw new Error("# Directory Sectors: Expected 0 saw "+Ne);ee.l+=4,Q=ee.read_shift(4,"i"),ee.l+=4,ee.chk("00100000","Mini Stream Cutoff Size: "),ae=ee.read_shift(4,"i"),L=ee.read_shift(4,"i"),se=ee.read_shift(4,"i"),U=ee.read_shift(4,"i");for(var ve=-1,ke=0;ke<109&&(ve=ee.read_shift(4,"i"),!(ve<0));++ke)re[ke]=ve;var Fe=p(N,F);w(se,U,Fe,F,re);var it=E(Fe,Q,re,F);it[Q].name="!Directory",L>0&&ae!==D&&(it[ae].name="!MiniFAT"),it[re[0]].name="!FAT",it.fat_addrs=re,it.ssz=F;var qe={},mt=[],on=[],Ge=[];y(Q,it,Fe,mt,L,qe,on,ae),x(on,Ge,mt),mt.shift();var ht={FileIndex:on,FullPaths:Ge};return B&&B.raw&&(ht.raw={header:Te,sectors:Fe}),ht}function d(N){if(N[N.l]==80&&N[N.l+1]==75)return[0,0];N.chk(ie,"Header Signature: "),N.l+=16;var B=N.read_shift(2,"u");return[N.read_shift(2,"u"),B]}function m(N,B){var R=9;switch(N.l+=2,R=N.read_shift(2)){case 9:if(B!=3)throw new Error("Sector Shift: Expected 9 saw "+R);break;case 12:if(B!=4)throw new Error("Sector Shift: Expected 12 saw "+R);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+R)}N.chk("0600","Mini Sector Shift: "),N.chk("000000000000","Reserved: ")}function p(N,B){for(var R=Math.ceil(N.length/B)-1,F=[],L=1;L<R;++L)F[L-1]=N.slice(L*B,(L+1)*B);return F[R-1]=N.slice(R*B),F}function x(N,B,R){for(var F=0,L=0,U=0,Q=0,ae=0,se=R.length,re=[],ee=[];F<se;++F)re[F]=ee[F]=F,B[F]=R[F];for(;ae<ee.length;++ae)F=ee[ae],L=N[F].L,U=N[F].R,Q=N[F].C,re[F]===F&&(L!==-1&&re[L]!==L&&(re[F]=re[L]),U!==-1&&re[U]!==U&&(re[F]=re[U])),Q!==-1&&(re[Q]=F),L!==-1&&F!=re[F]&&(re[L]=re[F],ee.lastIndexOf(L)<ae&&ee.push(L)),U!==-1&&F!=re[F]&&(re[U]=re[F],ee.lastIndexOf(U)<ae&&ee.push(U));for(F=1;F<se;++F)re[F]===F&&(U!==-1&&re[U]!==U?re[F]=re[U]:L!==-1&&re[L]!==L&&(re[F]=re[L]));for(F=1;F<se;++F)if(N[F].type!==0){if(ae=F,ae!=re[ae])do ae=re[ae],B[F]=B[ae]+"/"+B[F];while(ae!==0&&re[ae]!==-1&&ae!=re[ae]);re[F]=-1}for(B[0]+="/",F=1;F<se;++F)N[F].type!==2&&(B[F]+="/")}function g(N,B,R){for(var F=N.start,L=N.size,U=[],Q=F;R&&L>0&&Q>=0;)U.push(B.slice(Q*P,Q*P+P)),L-=P,Q=Ni(R,Q*4);return U.length===0?sr(0):Va(U).slice(0,N.size)}function w(N,B,R,F,L){var U=D;if(N===D){if(B!==0)throw new Error("DIFAT chain shorter than expected")}else if(N!==-1){var Q=R[N],ae=(F>>>2)-1;if(!Q)return;for(var se=0;se<ae&&(U=Ni(Q,se*4))!==D;++se)L.push(U);w(Ni(Q,F-4),B-1,R,F,L)}}function k(N,B,R,F,L){var U=[],Q=[];L||(L=[]);var ae=F-1,se=0,re=0;for(se=B;se>=0;){L[se]=!0,U[U.length]=se,Q.push(N[se]);var ee=R[Math.floor(se*4/F)];if(re=se*4&ae,F<4+re)throw new Error("FAT boundary crossed: "+se+" 4 "+F);if(!N[ee])break;se=Ni(N[ee],re)}return{nodes:U,data:yw([Q])}}function E(N,B,R,F){var L=N.length,U=[],Q=[],ae=[],se=[],re=F-1,ee=0,me=0,Te=0,Ne=0;for(ee=0;ee<L;++ee)if(ae=[],Te=ee+B,Te>=L&&(Te-=L),!Q[Te]){se=[];var ve=[];for(me=Te;me>=0;){ve[me]=!0,Q[me]=!0,ae[ae.length]=me,se.push(N[me]);var ke=R[Math.floor(me*4/F)];if(Ne=me*4&re,F<4+Ne)throw new Error("FAT boundary crossed: "+me+" 4 "+F);if(!N[ke]||(me=Ni(N[ke],Ne),ve[me]))break}U[Te]={nodes:ae,data:yw([se])}}return U}function y(N,B,R,F,L,U,Q,ae){for(var se=0,re=F.length?2:0,ee=B[N].data,me=0,Te=0,Ne;me<ee.length;me+=128){var ve=ee.slice(me,me+128);wr(ve,64),Te=ve.read_shift(2),Ne=av(ve,0,Te-re),F.push(Ne);var ke={name:Ne,type:ve.read_shift(1),color:ve.read_shift(1),L:ve.read_shift(4,"i"),R:ve.read_shift(4,"i"),C:ve.read_shift(4,"i"),clsid:ve.read_shift(16),state:ve.read_shift(4,"i"),start:0,size:0},Fe=ve.read_shift(2)+ve.read_shift(2)+ve.read_shift(2)+ve.read_shift(2);Fe!==0&&(ke.ct=I(ve,ve.l-8));var it=ve.read_shift(2)+ve.read_shift(2)+ve.read_shift(2)+ve.read_shift(2);it!==0&&(ke.mt=I(ve,ve.l-8)),ke.start=ve.read_shift(4,"i"),ke.size=ve.read_shift(4,"i"),ke.size<0&&ke.start<0&&(ke.size=ke.type=0,ke.start=D,ke.name=""),ke.type===5?(se=ke.start,L>0&&se!==D&&(B[se].name="!StreamData")):ke.size>=4096?(ke.storage="fat",B[ke.start]===void 0&&(B[ke.start]=k(R,ke.start,B.fat_addrs,B.ssz)),B[ke.start].name=ke.name,ke.content=B[ke.start].data.slice(0,ke.size)):(ke.storage="minifat",ke.size<0?ke.size=0:se!==D&&ke.start!==D&&B[se]&&(ke.content=g(ke,B[se].data,(B[ae]||{}).data))),ke.content&&wr(ke.content,0),U[Ne]=ke,Q.push(ke)}}function I(N,B){return new Date((En(N,B+4)/1e7*Math.pow(2,32)+En(N,B)/1e7-11644473600)*1e3)}function M(N,B){return c(),f(l.readFileSync(N),B)}function O(N,B){var R=B&&B.type;switch(R||et&&Buffer.isBuffer(N)&&(R="buffer"),R||"base64"){case"file":return M(N,B);case"base64":return f(os(bn(N)),B);case"binary":return f(os(N),B)}return f(N,B)}function v(N,B){var R=B||{},F=R.root||"Root Entry";if(N.FullPaths||(N.FullPaths=[]),N.FileIndex||(N.FileIndex=[]),N.FullPaths.length!==N.FileIndex.length)throw new Error("inconsistent CFB structure");N.FullPaths.length===0&&(N.FullPaths[0]=F+"/",N.FileIndex[0]={name:F,type:5}),R.CLSID&&(N.FileIndex[0].clsid=R.CLSID),T(N)}function T(N){var B="Sh33tJ5";if(!st.find(N,"/"+B)){var R=sr(4);R[0]=55,R[1]=R[3]=50,R[2]=54,N.FileIndex.push({name:B,type:2,content:R,size:4,L:69,R:69,C:69}),N.FullPaths.push(N.FullPaths[0]+B),S(N)}}function S(N,B){v(N);for(var R=!1,F=!1,L=N.FullPaths.length-1;L>=0;--L){var U=N.FileIndex[L];switch(U.type){case 0:F?R=!0:(N.FileIndex.pop(),N.FullPaths.pop());break;case 1:case 2:case 5:F=!0,isNaN(U.R*U.L*U.C)&&(R=!0),U.R>-1&&U.L>-1&&U.R==U.L&&(R=!0);break;default:R=!0;break}}if(!(!R&&!B)){var Q=new Date(1987,1,19),ae=0,se=Object.create?Object.create(null):{},re=[];for(L=0;L<N.FullPaths.length;++L)se[N.FullPaths[L]]=!0,N.FileIndex[L].type!==0&&re.push([N.FullPaths[L],N.FileIndex[L]]);for(L=0;L<re.length;++L){var ee=n(re[L][0]);F=se[ee],F||(re.push([ee,{name:s(ee).replace("/",""),type:1,clsid:fe,ct:Q,mt:Q,content:null}]),se[ee]=!0)}for(re.sort(function(Ne,ve){return r(Ne[0],ve[0])}),N.FullPaths=[],N.FileIndex=[],L=0;L<re.length;++L)N.FullPaths[L]=re[L][0],N.FileIndex[L]=re[L][1];for(L=0;L<re.length;++L){var me=N.FileIndex[L],Te=N.FullPaths[L];if(me.name=s(Te).replace("/",""),me.L=me.R=me.C=-(me.color=1),me.size=me.content?me.content.length:0,me.start=0,me.clsid=me.clsid||fe,L===0)me.C=re.length>1?1:-1,me.size=0,me.type=5;else if(Te.slice(-1)=="/"){for(ae=L+1;ae<re.length&&n(N.FullPaths[ae])!=Te;++ae);for(me.C=ae>=re.length?-1:ae,ae=L+1;ae<re.length&&n(N.FullPaths[ae])!=n(Te);++ae);me.R=ae>=re.length?-1:ae,me.type=1}else n(N.FullPaths[L+1]||"")==n(Te)&&(me.R=L+1),me.type=2}}}function C(N,B){var R=B||{};if(R.fileType=="mad")return nr(N,R);switch(S(N),R.fileType){case"zip":return Hs(N,R)}var F=function(Ne){for(var ve=0,ke=0,Fe=0;Fe<Ne.FileIndex.length;++Fe){var it=Ne.FileIndex[Fe];if(it.content){var qe=it.content.length;qe>0&&(qe<4096?ve+=qe+63>>6:ke+=qe+511>>9)}}for(var mt=Ne.FullPaths.length+3>>2,on=ve+7>>3,Ge=ve+127>>7,ht=on+ke+mt+Ge,xr=ht+127>>7,Mn=xr<=109?0:Math.ceil((xr-109)/127);ht+xr+Mn+127>>7>xr;)Mn=++xr<=109?0:Math.ceil((xr-109)/127);var rt=[1,Mn,xr,Ge,mt,ke,ve,0];return Ne.FileIndex[0].size=ve<<6,rt[7]=(Ne.FileIndex[0].start=rt[0]+rt[1]+rt[2]+rt[3]+rt[4]+rt[5])+(rt[6]+7>>3),rt}(N),L=sr(F[7]<<9),U=0,Q=0;{for(U=0;U<8;++U)L.write_shift(1,Z[U]);for(U=0;U<8;++U)L.write_shift(2,0);for(L.write_shift(2,62),L.write_shift(2,3),L.write_shift(2,65534),L.write_shift(2,9),L.write_shift(2,6),U=0;U<3;++U)L.write_shift(2,0);for(L.write_shift(4,0),L.write_shift(4,F[2]),L.write_shift(4,F[0]+F[1]+F[2]+F[3]-1),L.write_shift(4,0),L.write_shift(4,4096),L.write_shift(4,F[3]?F[0]+F[1]+F[2]-1:D),L.write_shift(4,F[3]),L.write_shift(-4,F[1]?F[0]-1:D),L.write_shift(4,F[1]),U=0;U<109;++U)L.write_shift(-4,U<F[2]?F[1]+U:-1)}if(F[1])for(Q=0;Q<F[1];++Q){for(;U<236+Q*127;++U)L.write_shift(-4,U<F[2]?F[1]+U:-1);L.write_shift(-4,Q===F[1]-1?D:Q+1)}var ae=function(Ne){for(Q+=Ne;U<Q-1;++U)L.write_shift(-4,U+1);Ne&&(++U,L.write_shift(-4,D))};for(Q=U=0,Q+=F[1];U<Q;++U)L.write_shift(-4,ue.DIFSECT);for(Q+=F[2];U<Q;++U)L.write_shift(-4,ue.FATSECT);ae(F[3]),ae(F[4]);for(var se=0,re=0,ee=N.FileIndex[0];se<N.FileIndex.length;++se)ee=N.FileIndex[se],ee.content&&(re=ee.content.length,!(re<4096)&&(ee.start=Q,ae(re+511>>9)));for(ae(F[6]+7>>3);L.l&511;)L.write_shift(-4,ue.ENDOFCHAIN);for(Q=U=0,se=0;se<N.FileIndex.length;++se)ee=N.FileIndex[se],ee.content&&(re=ee.content.length,!(!re||re>=4096)&&(ee.start=Q,ae(re+63>>6)));for(;L.l&511;)L.write_shift(-4,ue.ENDOFCHAIN);for(U=0;U<F[4]<<2;++U){var me=N.FullPaths[U];if(!me||me.length===0){for(se=0;se<17;++se)L.write_shift(4,0);for(se=0;se<3;++se)L.write_shift(4,-1);for(se=0;se<12;++se)L.write_shift(4,0);continue}ee=N.FileIndex[U],U===0&&(ee.start=ee.size?ee.start-1:D);var Te=U===0&&R.root||ee.name;if(re=2*(Te.length+1),L.write_shift(64,Te,"utf16le"),L.write_shift(2,re),L.write_shift(1,ee.type),L.write_shift(1,ee.color),L.write_shift(-4,ee.L),L.write_shift(-4,ee.R),L.write_shift(-4,ee.C),ee.clsid)L.write_shift(16,ee.clsid,"hex");else for(se=0;se<4;++se)L.write_shift(4,0);L.write_shift(4,ee.state||0),L.write_shift(4,0),L.write_shift(4,0),L.write_shift(4,0),L.write_shift(4,0),L.write_shift(4,ee.start),L.write_shift(4,ee.size),L.write_shift(4,0)}for(U=1;U<N.FileIndex.length;++U)if(ee=N.FileIndex[U],ee.size>=4096)if(L.l=ee.start+1<<9,et&&Buffer.isBuffer(ee.content))ee.content.copy(L,L.l,0,ee.size),L.l+=ee.size+511&-512;else{for(se=0;se<ee.size;++se)L.write_shift(1,ee.content[se]);for(;se&511;++se)L.write_shift(1,0)}for(U=1;U<N.FileIndex.length;++U)if(ee=N.FileIndex[U],ee.size>0&&ee.size<4096)if(et&&Buffer.isBuffer(ee.content))ee.content.copy(L,L.l,0,ee.size),L.l+=ee.size+63&-64;else{for(se=0;se<ee.size;++se)L.write_shift(1,ee.content[se]);for(;se&63;++se)L.write_shift(1,0)}if(et)L.l=L.length;else for(;L.l<L.length;)L.write_shift(1,0);return L}function b(N,B){var R=N.FullPaths.map(function(se){return se.toUpperCase()}),F=R.map(function(se){var re=se.split("/");return re[re.length-(se.slice(-1)=="/"?2:1)]}),L=!1;B.charCodeAt(0)===47?(L=!0,B=R[0].slice(0,-1)+B):L=B.indexOf("/")!==-1;var U=B.toUpperCase(),Q=L===!0?R.indexOf(U):F.indexOf(U);if(Q!==-1)return N.FileIndex[Q];var ae=!U.match(lc);for(U=U.replace(en,""),ae&&(U=U.replace(lc,"!")),Q=0;Q<R.length;++Q)if((ae?R[Q].replace(lc,"!"):R[Q]).replace(en,"")==U||(ae?F[Q].replace(lc,"!"):F[Q]).replace(en,"")==U)return N.FileIndex[Q];return null}var P=64,D=-2,ie="d0cf11e0a1b11ae1",Z=[208,207,17,224,161,177,26,225],fe="00000000000000000000000000000000",ue={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:D,FREESECT:-1,HEADER_SIGNATURE:ie,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:fe,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function q(N,B,R){c();var F=C(N,R);l.writeFileSync(B,F)}function G(N){for(var B=new Array(N.length),R=0;R<N.length;++R)B[R]=String.fromCharCode(N[R]);return B.join("")}function ne(N,B){var R=C(N,B);switch(B&&B.type||"buffer"){case"file":return c(),l.writeFileSync(B.filename,R),R;case"binary":return typeof R=="string"?R:G(R);case"base64":return tw(typeof R=="string"?R:G(R));case"buffer":if(et)return Buffer.isBuffer(R)?R:lo(R);case"array":return typeof R=="string"?os(R):R}return R}var ce;function j(N){try{var B=N.InflateRaw,R=new B;if(R._processChunk(new Uint8Array([3,0]),R._finishFlushFlag),R.bytesRead)ce=N;else throw new Error("zlib does not expose bytesRead")}catch(F){console.error("cannot use native zlib: "+(F.message||F))}}function Y(N,B){if(!ce)return $s(N,B);var R=ce.InflateRaw,F=new R,L=F._processChunk(N.slice(N.l),F._finishFlushFlag);return N.l+=F.bytesRead,L}function K(N){return ce?ce.deflateRawSync(N):Ve(N)}var V=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],J=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],de=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function Ee(N){var B=(N<<1|N<<11)&139536|(N<<5|N<<15)&558144;return(B>>16|B>>8|B)&255}for(var _e=typeof Uint8Array<"u",pe=_e?new Uint8Array(256):[],Ue=0;Ue<256;++Ue)pe[Ue]=Ee(Ue);function H(N,B){var R=pe[N&255];return B<=8?R>>>8-B:(R=R<<8|pe[N>>8&255],B<=16?R>>>16-B:(R=R<<8|pe[N>>16&255],R>>>24-B))}function tt(N,B){var R=B&7,F=B>>>3;return(N[F]|(R<=6?0:N[F+1]<<8))>>>R&3}function He(N,B){var R=B&7,F=B>>>3;return(N[F]|(R<=5?0:N[F+1]<<8))>>>R&7}function Je(N,B){var R=B&7,F=B>>>3;return(N[F]|(R<=4?0:N[F+1]<<8))>>>R&15}function De(N,B){var R=B&7,F=B>>>3;return(N[F]|(R<=3?0:N[F+1]<<8))>>>R&31}function Ae(N,B){var R=B&7,F=B>>>3;return(N[F]|(R<=1?0:N[F+1]<<8))>>>R&127}function _t(N,B,R){var F=B&7,L=B>>>3,U=(1<<R)-1,Q=N[L]>>>F;return R<8-F||(Q|=N[L+1]<<8-F,R<16-F)||(Q|=N[L+2]<<16-F,R<24-F)||(Q|=N[L+3]<<24-F),Q&U}function ur(N,B,R){var F=B&7,L=B>>>3;return F<=5?N[L]|=(R&7)<<F:(N[L]|=R<<F&255,N[L+1]=(R&7)>>8-F),B+3}function Cr(N,B,R){var F=B&7,L=B>>>3;return R=(R&1)<<F,N[L]|=R,B+1}function sn(N,B,R){var F=B&7,L=B>>>3;return R<<=F,N[L]|=R&255,R>>>=8,N[L+1]=R,B+8}function Ws(N,B,R){var F=B&7,L=B>>>3;return R<<=F,N[L]|=R&255,R>>>=8,N[L+1]=R&255,N[L+2]=R>>>8,B+16}function an(N,B){var R=N.length,F=2*R>B?2*R:B+5,L=0;if(R>=B)return N;if(et){var U=rw(F);if(N.copy)N.copy(U);else for(;L<N.length;++L)U[L]=N[L];return U}else if(_e){var Q=new Uint8Array(F);if(Q.set)Q.set(N);else for(;L<R;++L)Q[L]=N[L];return Q}return N.length=F,N}function kt(N){for(var B=new Array(N),R=0;R<N;++R)B[R]=0;return B}function fr(N,B,R){var F=1,L=0,U=0,Q=0,ae=0,se=N.length,re=_e?new Uint16Array(32):kt(32);for(U=0;U<32;++U)re[U]=0;for(U=se;U<R;++U)N[U]=0;se=N.length;var ee=_e?new Uint16Array(se):kt(se);for(U=0;U<se;++U)re[L=N[U]]++,F<L&&(F=L),ee[U]=0;for(re[0]=0,U=1;U<=F;++U)re[U+16]=ae=ae+re[U-1]<<1;for(U=0;U<se;++U)ae=N[U],ae!=0&&(ee[U]=re[ae+16]++);var me=0;for(U=0;U<se;++U)if(me=N[U],me!=0)for(ae=H(ee[U],F)>>F-me,Q=(1<<F+4-me)-1;Q>=0;--Q)B[ae|Q<<me]=me&15|U<<4;return F}var vt=_e?new Uint16Array(512):kt(512),St=_e?new Uint16Array(32):kt(32);if(!_e){for(var dt=0;dt<512;++dt)vt[dt]=0;for(dt=0;dt<32;++dt)St[dt]=0}(function(){for(var N=[],B=0;B<32;B++)N.push(5);fr(N,St,32);var R=[];for(B=0;B<=143;B++)R.push(8);for(;B<=255;B++)R.push(9);for(;B<=279;B++)R.push(7);for(;B<=287;B++)R.push(8);fr(R,vt,288)})();var Ot=function(){for(var B=_e?new Uint8Array(32768):[],R=0,F=0;R<de.length-1;++R)for(;F<de[R+1];++F)B[F]=R;for(;F<32768;++F)B[F]=29;var L=_e?new Uint8Array(259):[];for(R=0,F=0;R<J.length-1;++R)for(;F<J[R+1];++F)L[F]=R;function U(ae,se){for(var re=0;re<ae.length;){var ee=Math.min(65535,ae.length-re),me=re+ee==ae.length;for(se.write_shift(1,+me),se.write_shift(2,ee),se.write_shift(2,~ee&65535);ee-- >0;)se[se.l++]=ae[re++]}return se.l}function Q(ae,se){for(var re=0,ee=0,me=_e?new Uint16Array(32768):[];ee<ae.length;){var Te=Math.min(65535,ae.length-ee);if(Te<10){for(re=ur(se,re,+(ee+Te==ae.length)),re&7&&(re+=8-(re&7)),se.l=re/8|0,se.write_shift(2,Te),se.write_shift(2,~Te&65535);Te-- >0;)se[se.l++]=ae[ee++];re=se.l*8;continue}re=ur(se,re,+(ee+Te==ae.length)+2);for(var Ne=0;Te-- >0;){var ve=ae[ee];Ne=(Ne<<5^ve)&32767;var ke=-1,Fe=0;if((ke=me[Ne])&&(ke|=ee&-32768,ke>ee&&(ke-=32768),ke<ee))for(;ae[ke+Fe]==ae[ee+Fe]&&Fe<250;)++Fe;if(Fe>2){ve=L[Fe],ve<=22?re=sn(se,re,pe[ve+1]>>1)-1:(sn(se,re,3),re+=5,sn(se,re,pe[ve-23]>>5),re+=3);var it=ve<8?0:ve-4>>2;it>0&&(Ws(se,re,Fe-J[ve]),re+=it),ve=B[ee-ke],re=sn(se,re,pe[ve]>>3),re-=3;var qe=ve<4?0:ve-2>>1;qe>0&&(Ws(se,re,ee-ke-de[ve]),re+=qe);for(var mt=0;mt<Fe;++mt)me[Ne]=ee&32767,Ne=(Ne<<5^ae[ee])&32767,++ee;Te-=Fe-1}else ve<=143?ve=ve+48:re=Cr(se,re,1),re=sn(se,re,pe[ve]),me[Ne]=ee&32767,++ee}re=sn(se,re,0)-1}return se.l=(re+7)/8|0,se.l}return function(se,re){return se.length<8?U(se,re):Q(se,re)}}();function Ve(N){var B=sr(50+Math.floor(N.length*1.1)),R=Ot(N,B);return B.slice(0,R)}var yt=_e?new Uint16Array(32768):kt(32768),Yt=_e?new Uint16Array(32768):kt(32768),ft=_e?new Uint16Array(128):kt(128),vn=1,zs=1;function po(N,B){var R=De(N,B)+257;B+=5;var F=De(N,B)+1;B+=5;var L=Je(N,B)+4;B+=4;for(var U=0,Q=_e?new Uint8Array(19):kt(19),ae=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],se=1,re=_e?new Uint8Array(8):kt(8),ee=_e?new Uint8Array(8):kt(8),me=Q.length,Te=0;Te<L;++Te)Q[V[Te]]=U=He(N,B),se<U&&(se=U),re[U]++,B+=3;var Ne=0;for(re[0]=0,Te=1;Te<=se;++Te)ee[Te]=Ne=Ne+re[Te-1]<<1;for(Te=0;Te<me;++Te)(Ne=Q[Te])!=0&&(ae[Te]=ee[Ne]++);var ve=0;for(Te=0;Te<me;++Te)if(ve=Q[Te],ve!=0){Ne=pe[ae[Te]]>>8-ve;for(var ke=(1<<7-ve)-1;ke>=0;--ke)ft[Ne|ke<<ve]=ve&7|Te<<3}var Fe=[];for(se=1;Fe.length<R+F;)switch(Ne=ft[Ae(N,B)],B+=Ne&7,Ne>>>=3){case 16:for(U=3+tt(N,B),B+=2,Ne=Fe[Fe.length-1];U-- >0;)Fe.push(Ne);break;case 17:for(U=3+He(N,B),B+=3;U-- >0;)Fe.push(0);break;case 18:for(U=11+Ae(N,B),B+=7;U-- >0;)Fe.push(0);break;default:Fe.push(Ne),se<Ne&&(se=Ne);break}var it=Fe.slice(0,R),qe=Fe.slice(R);for(Te=R;Te<286;++Te)it[Te]=0;for(Te=F;Te<30;++Te)qe[Te]=0;return vn=fr(it,yt,286),zs=fr(qe,Yt,30),B}function Rl(N,B){if(N[0]==3&&!(N[1]&3))return[di(B),2];for(var R=0,F=0,L=rw(B||1<<18),U=0,Q=L.length>>>0,ae=0,se=0;!(F&1);){if(F=He(N,R),R+=3,F>>>1)F>>1==1?(ae=9,se=5):(R=po(N,R),ae=vn,se=zs);else{R&7&&(R+=8-(R&7));var re=N[R>>>3]|N[(R>>>3)+1]<<8;if(R+=32,re>0)for(!B&&Q<U+re&&(L=an(L,U+re),Q=L.length);re-- >0;)L[U++]=N[R>>>3],R+=8;continue}for(;;){!B&&Q<U+32767&&(L=an(L,U+32767),Q=L.length);var ee=_t(N,R,ae),me=F>>>1==1?vt[ee]:yt[ee];if(R+=me&15,me>>>=4,!(me>>>8&255))L[U++]=me;else{if(me==256)break;me-=257;var Te=me<8?0:me-4>>2;Te>5&&(Te=0);var Ne=U+J[me];Te>0&&(Ne+=_t(N,R,Te),R+=Te),ee=_t(N,R,se),me=F>>>1==1?St[ee]:Yt[ee],R+=me&15,me>>>=4;var ve=me<4?0:me-2>>1,ke=de[me];for(ve>0&&(ke+=_t(N,R,ve),R+=ve),!B&&Q<Ne&&(L=an(L,Ne+100),Q=L.length);U<Ne;)L[U]=L[U-ke],++U}}}return B?[L,R+7>>>3]:[L.slice(0,U),R+7>>>3]}function $s(N,B){var R=N.slice(N.l||0),F=Rl(R,B);return N.l+=F[1],F[0]}function xs(N,B){if(N)typeof console<"u"&&console.error(B);else throw new Error(B)}function Sa(N,B){var R=N;wr(R,0);var F=[],L=[],U={FileIndex:F,FullPaths:L};v(U,{root:B.root});for(var Q=R.length-4;(R[Q]!=80||R[Q+1]!=75||R[Q+2]!=5||R[Q+3]!=6)&&Q>=0;)--Q;R.l=Q+4,R.l+=4;var ae=R.read_shift(2);R.l+=6;var se=R.read_shift(4);for(R.l=se,Q=0;Q<ae;++Q){R.l+=20;var re=R.read_shift(4),ee=R.read_shift(4),me=R.read_shift(2),Te=R.read_shift(2),Ne=R.read_shift(2);R.l+=8;var ve=R.read_shift(4),ke=o(R.slice(R.l+me,R.l+me+Te));R.l+=me+Te+Ne;var Fe=R.l;R.l=ve+4,Qn(R,re,ee,U,ke),R.l=Fe}return U}function Qn(N,B,R,F,L){N.l+=2;var U=N.read_shift(2),Q=N.read_shift(2),ae=i(N);if(U&8257)throw new Error("Unsupported ZIP encryption");for(var se=N.read_shift(4),re=N.read_shift(4),ee=N.read_shift(4),me=N.read_shift(2),Te=N.read_shift(2),Ne="",ve=0;ve<me;++ve)Ne+=String.fromCharCode(N[N.l++]);if(Te){var ke=o(N.slice(N.l,N.l+Te));(ke[21589]||{}).mt&&(ae=ke[21589].mt),((L||{})[21589]||{}).mt&&(ae=L[21589].mt)}N.l+=Te;var Fe=N.slice(N.l,N.l+re);switch(Q){case 8:Fe=Y(N,ee);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+Q)}var it=!1;U&8&&(se=N.read_shift(4),se==134695760&&(se=N.read_shift(4),it=!0),re=N.read_shift(4),ee=N.read_shift(4)),re!=B&&xs(it,"Bad compressed size: "+B+" != "+re),ee!=R&&xs(it,"Bad uncompressed size: "+R+" != "+ee),te(F,Ne,Fe,{unsafe:!0,mt:ae})}function Hs(N,B){var R=B||{},F=[],L=[],U=sr(1),Q=R.compression?8:0,ae=0,se=0,re=0,ee=0,me=0,Te=N.FullPaths[0],Ne=Te,ve=N.FileIndex[0],ke=[],Fe=0;for(se=1;se<N.FullPaths.length;++se)if(Ne=N.FullPaths[se].slice(Te.length),ve=N.FileIndex[se],!(!ve.size||!ve.content||Ne=="Sh33tJ5")){var it=ee,qe=sr(Ne.length);for(re=0;re<Ne.length;++re)qe.write_shift(1,Ne.charCodeAt(re)&127);qe=qe.slice(0,qe.l),ke[me]=B6.buf(ve.content,0);var mt=ve.content;Q==8&&(mt=K(mt)),U=sr(30),U.write_shift(4,67324752),U.write_shift(2,20),U.write_shift(2,ae),U.write_shift(2,Q),ve.mt?a(U,ve.mt):U.write_shift(4,0),U.write_shift(-4,ke[me]),U.write_shift(4,mt.length),U.write_shift(4,ve.content.length),U.write_shift(2,qe.length),U.write_shift(2,0),ee+=U.length,F.push(U),ee+=qe.length,F.push(qe),ee+=mt.length,F.push(mt),U=sr(46),U.write_shift(4,33639248),U.write_shift(2,0),U.write_shift(2,20),U.write_shift(2,ae),U.write_shift(2,Q),U.write_shift(4,0),U.write_shift(-4,ke[me]),U.write_shift(4,mt.length),U.write_shift(4,ve.content.length),U.write_shift(2,qe.length),U.write_shift(2,0),U.write_shift(2,0),U.write_shift(2,0),U.write_shift(2,0),U.write_shift(4,0),U.write_shift(4,it),Fe+=U.l,L.push(U),Fe+=qe.length,L.push(qe),++me}return U=sr(22),U.write_shift(4,101010256),U.write_shift(2,0),U.write_shift(2,0),U.write_shift(2,me),U.write_shift(2,me),U.write_shift(4,Fe),U.write_shift(4,ee),U.write_shift(2,0),Va([Va(F),Va(L),U])}var vs={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function Fn(N,B){if(N.ctype)return N.ctype;var R=N.name||"",F=R.match(/\.([^\.]+)$/);return F&&vs[F[1]]||B&&(F=(R=B).match(/[\.\\]([^\.\\])+$/),F&&vs[F[1]])?vs[F[1]]:"application/octet-stream"}function go(N){for(var B=tw(N),R=[],F=0;F<B.length;F+=76)R.push(B.slice(F,F+76));return R.join(`\r
`)+`\r
`}function Gs(N){var B=N.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(re){var ee=re.charCodeAt(0).toString(16).toUpperCase();return"="+(ee.length==1?"0"+ee:ee)});B=B.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),B.charAt(0)==`
`&&(B="=0D"+B.slice(1)),B=B.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var R=[],F=B.split(`\r
`),L=0;L<F.length;++L){var U=F[L];if(U.length==0){R.push("");continue}for(var Q=0;Q<U.length;){var ae=76,se=U.slice(Q,Q+ae);se.charAt(ae-1)=="="?ae--:se.charAt(ae-2)=="="?ae-=2:se.charAt(ae-3)=="="&&(ae-=3),se=U.slice(Q,Q+ae),Q+=ae,Q<U.length&&(se+="="),R.push(se)}}return R.join(`\r
`)}function Ks(N){for(var B=[],R=0;R<N.length;++R){for(var F=N[R];R<=N.length&&F.charAt(F.length-1)=="=";)F=F.slice(0,F.length-1)+N[++R];B.push(F)}for(var L=0;L<B.length;++L)B[L]=B[L].replace(/[=][0-9A-Fa-f]{2}/g,function(U){return String.fromCharCode(parseInt(U.slice(1),16))});return os(B.join(`\r
`))}function On(N,B,R){for(var F="",L="",U="",Q,ae=0;ae<10;++ae){var se=B[ae];if(!se||se.match(/^\s*$/))break;var re=se.match(/^(.*?):\s*([^\s].*)$/);if(re)switch(re[1].toLowerCase()){case"content-location":F=re[2].trim();break;case"content-type":U=re[2].trim();break;case"content-transfer-encoding":L=re[2].trim();break}}switch(++ae,L.toLowerCase()){case"base64":Q=os(bn(B.slice(ae).join("")));break;case"quoted-printable":Q=Ks(B.slice(ae));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+L)}var ee=te(N,F.slice(R.length),Q,{unsafe:!0});U&&(ee.ctype=U)}function xo(N,B){if(G(N.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var R=B&&B.root||"",F=(et&&Buffer.isBuffer(N)?N.toString("binary"):G(N)).split(`\r
`),L=0,U="";for(L=0;L<F.length;++L)if(U=F[L],!!/^Content-Location:/i.test(U)&&(U=U.slice(U.indexOf("file")),R||(R=U.slice(0,U.lastIndexOf("/")+1)),U.slice(0,R.length)!=R))for(;R.length>0&&(R=R.slice(0,R.length-1),R=R.slice(0,R.lastIndexOf("/")+1),U.slice(0,R.length)!=R););var Q=(F[1]||"").match(/boundary="(.*?)"/);if(!Q)throw new Error("MAD cannot find boundary");var ae="--"+(Q[1]||""),se=[],re=[],ee={FileIndex:se,FullPaths:re};v(ee);var me,Te=0;for(L=0;L<F.length;++L){var Ne=F[L];Ne!==ae&&Ne!==ae+"--"||(Te++&&On(ee,F.slice(me,L),R),me=L)}return ee}function nr(N,B){var R=B||{},F=R.boundary||"SheetJS";F="------="+F;for(var L=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+F.slice(2)+'"',"","",""],U=N.FullPaths[0],Q=U,ae=N.FileIndex[0],se=1;se<N.FullPaths.length;++se)if(Q=N.FullPaths[se].slice(U.length),ae=N.FileIndex[se],!(!ae.size||!ae.content||Q=="Sh33tJ5")){Q=Q.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(Fe){return"_x"+Fe.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(Fe){return"_u"+Fe.charCodeAt(0).toString(16)+"_"});for(var re=ae.content,ee=et&&Buffer.isBuffer(re)?re.toString("binary"):G(re),me=0,Te=Math.min(1024,ee.length),Ne=0,ve=0;ve<=Te;++ve)(Ne=ee.charCodeAt(ve))>=32&&Ne<128&&++me;var ke=me>=Te*4/5;L.push(F),L.push("Content-Location: "+(R.root||"file:///C:/SheetJS/")+Q),L.push("Content-Transfer-Encoding: "+(ke?"quoted-printable":"base64")),L.push("Content-Type: "+Fn(ae,Q)),L.push(""),L.push(ke?Gs(ee):go(ee))}return L.push(F+`--\r
`),L.join(`\r
`)}function X(N){var B={};return v(B,N),B}function te(N,B,R,F){var L=F&&F.unsafe;L||v(N);var U=!L&&st.find(N,B);if(!U){var Q=N.FullPaths[0];B.slice(0,Q.length)==Q?Q=B:(Q.slice(-1)!="/"&&(Q+="/"),Q=(Q+B).replace("//","/")),U={name:s(B),type:2},N.FileIndex.push(U),N.FullPaths.push(Q),L||st.utils.cfb_gc(N)}return U.content=R,U.size=R?R.length:0,F&&(F.CLSID&&(U.clsid=F.CLSID),F.mt&&(U.mt=F.mt),F.ct&&(U.ct=F.ct)),U}function le(N,B){v(N);var R=st.find(N,B);if(R){for(var F=0;F<N.FileIndex.length;++F)if(N.FileIndex[F]==R)return N.FileIndex.splice(F,1),N.FullPaths.splice(F,1),!0}return!1}function xe(N,B,R){v(N);var F=st.find(N,B);if(F){for(var L=0;L<N.FileIndex.length;++L)if(N.FileIndex[L]==F)return N.FileIndex[L].name=s(R),N.FullPaths[L]=R,!0}return!1}function Ie(N){S(N,!0)}return t.find=b,t.read=O,t.parse=f,t.write=ne,t.writeFile=q,t.utils={cfb_new:X,cfb_add:te,cfb_del:le,cfb_mov:xe,cfb_gc:Ie,ReadShift:Ac,CheckField:GA,prep_blob:wr,bconcat:Va,use_zlib:j,_deflateRaw:Ve,_inflateRaw:$s,consts:ue},t}();function W6(e){if(typeof Deno<"u")return Deno.readFileSync(e);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var t=File(e);t.open("r"),t.encoding="binary";var r=t.read();return t.close(),r}catch(n){if(!n.message||!n.message.match(/onstruct/))throw n}throw new Error("Cannot access file "+e)}function Fs(e){for(var t=Object.keys(e),r=[],n=0;n<t.length;++n)Object.prototype.hasOwnProperty.call(e,t[n])&&r.push(t[n]);return r}function tv(e){for(var t=[],r=Fs(e),n=0;n!==r.length;++n)t[e[r[n]]]=r[n];return t}var ld=new Date(1899,11,30,0,0,0);function tn(e,t){var r=e.getTime(),n=ld.getTime()+(e.getTimezoneOffset()-ld.getTimezoneOffset())*6e4;return(r-n)/(24*60*60*1e3)}var SA=new Date,z6=ld.getTime()+(SA.getTimezoneOffset()-ld.getTimezoneOffset())*6e4,uw=SA.getTimezoneOffset();function o0(e){var t=new Date;return t.setTime(e*24*60*60*1e3+z6),t.getTimezoneOffset()!==uw&&t.setTime(t.getTime()+(t.getTimezoneOffset()-uw)*6e4),t}function $6(e){var t=0,r=0,n=!1,s=e.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!s)throw new Error("|"+e+"| is not an ISO8601 Duration");for(var a=1;a!=s.length;++a)if(s[a]){switch(r=1,a>3&&(n=!0),s[a].slice(s[a].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+s[a].slice(s[a].length-1));case"D":r*=24;case"H":r*=60;case"M":if(n)r*=60;else throw new Error("Unsupported ISO Duration Field: M")}t+=r*parseInt(s[a],10)}return t}var fw=new Date("2017-02-19T19:06:09.000Z"),AA=isNaN(fw.getFullYear())?new Date("2/19/17"):fw,H6=AA.getFullYear()==2017;function gr(e,t){var r=new Date(e);if(H6)return t>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):t<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(e instanceof Date)return e;if(AA.getFullYear()==1917&&!isNaN(r.getFullYear())){var n=r.getFullYear();return e.indexOf(""+n)>-1||r.setFullYear(r.getFullYear()+100),r}var s=e.match(/\d+/g)||["2017","2","19","0","0","0"],a=new Date(+s[0],+s[1]-1,+s[2],+s[3]||0,+s[4]||0,+s[5]||0);return e.indexOf("Z")>-1&&(a=new Date(a.getTime()-a.getTimezoneOffset()*60*1e3)),a}function eo(e,t){if(et&&Buffer.isBuffer(e)){if(t){if(e[0]==255&&e[1]==254)return uc(e.slice(2).toString("utf16le"));if(e[1]==254&&e[2]==255)return uc(hA(e.slice(2).toString("binary")))}return e.toString("binary")}if(typeof TextDecoder<"u")try{if(t){if(e[0]==255&&e[1]==254)return uc(new TextDecoder("utf-16le").decode(e.slice(2)));if(e[0]==254&&e[1]==255)return uc(new TextDecoder("utf-16be").decode(e.slice(2)))}var r={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[]/g,function(a){return r[a]||a})}catch{}for(var n=[],s=0;s!=e.length;++s)n.push(String.fromCharCode(e[s]));return n.join("")}function Sr(e){if(typeof JSON<"u"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=Sr(e[r]));return t}function Wt(e,t){for(var r="";r.length<t;)r+=e;return r}function ms(e){var t=Number(e);if(!isNaN(t))return isFinite(t)?t:NaN;if(!/\d/.test(e))return t;var r=1,n=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(t=Number(n))||(n=n.replace(/[(](.*)[)]/,function(s,a){return r=-r,a}),!isNaN(t=Number(n)))?t/r:t}var G6=["january","february","march","april","may","june","july","august","september","october","november","december"];function vl(e){var t=new Date(e),r=new Date(NaN),n=t.getYear(),s=t.getMonth(),a=t.getDate();if(isNaN(a))return r;var i=e.toLowerCase();if(i.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(i=i.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),i.length>3&&G6.indexOf(i)==-1)return r}else if(i.match(/[a-z]/))return r;return n<0||n>8099?r:(s>0||a>1)&&n!=101?t:e.match(/[^-0-9:,\/\\]/)?r:t}var K6=function(){var e="abacaba".split(/(:?b)/i).length==5;return function(r,n,s){if(e||typeof n=="string")return r.split(n);for(var a=r.split(n),i=[a[0]],o=1;o<a.length;++o)i.push(s),i.push(a[o]);return i}}();function IA(e){return e?e.content&&e.type?eo(e.content,!0):e.data?oc(e.data):e.asNodeBuffer&&et?oc(e.asNodeBuffer().toString("binary")):e.asBinary?oc(e.asBinary()):e._data&&e._data.getContent?oc(eo(Array.prototype.slice.call(e._data.getContent(),0))):null:null}function NA(e){if(!e)return null;if(e.data)return Z_(e.data);if(e.asNodeBuffer&&et)return e.asNodeBuffer();if(e._data&&e._data.getContent){var t=e._data.getContent();return typeof t=="string"?Z_(t):Array.prototype.slice.call(t)}return e.content&&e.type?e.content:null}function q6(e){return e&&e.name.slice(-4)===".bin"?NA(e):IA(e)}function Un(e,t){for(var r=e.FullPaths||Fs(e.files),n=t.toLowerCase().replace(/[\/]/g,"\\"),s=n.replace(/\\/g,"/"),a=0;a<r.length;++a){var i=r[a].replace(/^Root Entry[\/]/,"").toLowerCase();if(n==i||s==i)return e.files?e.files[r[a]]:e.FileIndex[a]}return null}function rv(e,t){var r=Un(e,t);if(r==null)throw new Error("Cannot find file "+t+" in zip");return r}function Jt(e,t,r){if(!r)return q6(rv(e,t));if(!t)return null;try{return Jt(e,t)}catch{return null}}function Tn(e,t,r){if(!r)return IA(rv(e,t));if(!t)return null;try{return Tn(e,t)}catch{return null}}function Y6(e,t,r){return NA(rv(e,t))}function hw(e){for(var t=e.FullPaths||Fs(e.files),r=[],n=0;n<t.length;++n)t[n].slice(-1)!="/"&&r.push(t[n].replace(/^Root Entry[\/]/,""));return r.sort()}function X6(e,t,r){if(e.FullPaths){if(typeof r=="string"){var n;return et?n=lo(r):n=p6(r),st.utils.cfb_add(e,t,n)}st.utils.cfb_add(e,t,r)}else e.file(t,r)}function CA(e,t){switch(t.type){case"base64":return st.read(e,{type:"base64"});case"binary":return st.read(e,{type:"binary"});case"buffer":case"array":return st.read(e,{type:"buffer"})}throw new Error("Unrecognized type "+t.type)}function cc(e,t){if(e.charAt(0)=="/")return e.slice(1);var r=t.split("/");t.slice(-1)!="/"&&r.pop();for(var n=e.split("/");n.length!==0;){var s=n.shift();s===".."?r.pop():s!=="."&&r.push(s)}return r.join("/")}var bA=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,Q6=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,dw=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,J6=/<[^>]*>/g,Kr=bA.match(dw)?dw:J6,Z6=/<\w*:/,ej=/<(\/?)\w+:/;function Oe(e,t,r){for(var n={},s=0,a=0;s!==e.length&&!((a=e.charCodeAt(s))===32||a===10||a===13);++s);if(t||(n[0]=e.slice(0,s)),s===e.length)return n;var i=e.match(Q6),o=0,l="",c=0,f="",d="",m=1;if(i)for(c=0;c!=i.length;++c){for(d=i[c],a=0;a!=d.length&&d.charCodeAt(a)!==61;++a);for(f=d.slice(0,a).trim();d.charCodeAt(a+1)==32;)++a;for(m=(s=d.charCodeAt(a+1))==34||s==39?1:0,l=d.slice(a+1+m,d.length-m),o=0;o!=f.length&&f.charCodeAt(o)!==58;++o);if(o===f.length)f.indexOf("_")>0&&(f=f.slice(0,f.indexOf("_"))),n[f]=l,n[f.toLowerCase()]=l;else{var p=(o===5&&f.slice(0,5)==="xmlns"?"xmlns":"")+f.slice(o+1);if(n[p]&&f.slice(o-3,o)=="ext")continue;n[p]=l,n[p.toLowerCase()]=l}}return n}function Vs(e){return e.replace(ej,"<$1")}var RA={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},tj=tv(RA),lt=function(){var e=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,t=/_x([\da-fA-F]{4})_/ig;return function r(n){var s=n+"",a=s.indexOf("<![CDATA[");if(a==-1)return s.replace(e,function(o,l){return RA[o]||String.fromCharCode(parseInt(l,o.indexOf("x")>-1?16:10))||o}).replace(t,function(o,l){return String.fromCharCode(parseInt(l,16))});var i=s.indexOf("]]>");return r(s.slice(0,a))+s.slice(a+9,i)+r(s.slice(i+3))}}(),rj=/[&<>'"]/g,nj=/[\u0000-\u001f]/g;function nv(e){var t=e+"";return t.replace(rj,function(r){return tj[r]}).replace(/\n/g,"<br/>").replace(nj,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}var mw=function(){var e=/&#(\d+);/g;function t(r,n){return String.fromCharCode(parseInt(n,10))}return function(n){return n.replace(e,t)}}();function Pt(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function sm(e){for(var t="",r=0,n=0,s=0,a=0,i=0,o=0;r<e.length;){if(n=e.charCodeAt(r++),n<128){t+=String.fromCharCode(n);continue}if(s=e.charCodeAt(r++),n>191&&n<224){i=(n&31)<<6,i|=s&63,t+=String.fromCharCode(i);continue}if(a=e.charCodeAt(r++),n<240){t+=String.fromCharCode((n&15)<<12|(s&63)<<6|a&63);continue}i=e.charCodeAt(r++),o=((n&7)<<18|(s&63)<<12|(a&63)<<6|i&63)-65536,t+=String.fromCharCode(55296+(o>>>10&1023)),t+=String.fromCharCode(56320+(o&1023))}return t}function pw(e){var t=di(2*e.length),r,n,s=1,a=0,i=0,o;for(n=0;n<e.length;n+=s)s=1,(o=e.charCodeAt(n))<128?r=o:o<224?(r=(o&31)*64+(e.charCodeAt(n+1)&63),s=2):o<240?(r=(o&15)*4096+(e.charCodeAt(n+1)&63)*64+(e.charCodeAt(n+2)&63),s=3):(s=4,r=(o&7)*262144+(e.charCodeAt(n+1)&63)*4096+(e.charCodeAt(n+2)&63)*64+(e.charCodeAt(n+3)&63),r-=65536,i=55296+(r>>>10&1023),r=56320+(r&1023)),i!==0&&(t[a++]=i&255,t[a++]=i>>>8,i=0),t[a++]=r%256,t[a++]=r>>>8;return t.slice(0,a).toString("ucs2")}function gw(e){return lo(e,"binary").toString("utf8")}var Of="foo bar baz",Tt=et&&(gw(Of)==sm(Of)&&gw||pw(Of)==sm(Of)&&pw)||sm,uc=et?function(e){return lo(e,"utf8").toString("binary")}:function(e){for(var t=[],r=0,n=0,s=0;r<e.length;)switch(n=e.charCodeAt(r++),!0){case n<128:t.push(String.fromCharCode(n));break;case n<2048:t.push(String.fromCharCode(192+(n>>6))),t.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,s=e.charCodeAt(r++)-56320+(n<<10),t.push(String.fromCharCode(240+(s>>18&7))),t.push(String.fromCharCode(144+(s>>12&63))),t.push(String.fromCharCode(128+(s>>6&63))),t.push(String.fromCharCode(128+(s&63)));break;default:t.push(String.fromCharCode(224+(n>>12))),t.push(String.fromCharCode(128+(n>>6&63))),t.push(String.fromCharCode(128+(n&63)))}return t.join("")},du=function(){var e={};return function(r,n){var s=r+"|"+(n||"");return e[s]?e[s]:e[s]=new RegExp("<(?:\\w+:)?"+r+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+r+">",n||"")}}(),PA=function(){var e=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(t){return[new RegExp("&"+t[0]+";","ig"),t[1]]});return function(r){for(var n=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),s=0;s<e.length;++s)n=n.replace(e[s][0],e[s][1]);return n}}(),sj=function(){var e={};return function(r){return e[r]!==void 0?e[r]:e[r]=new RegExp("<(?:vt:)?"+r+">([\\s\\S]*?)</(?:vt:)?"+r+">","g")}}(),aj=/<\/?(?:vt:)?variant>/g,ij=/<(?:vt:)([^>]*)>([\s\S]*)</;function xw(e,t){var r=Oe(e),n=e.match(sj(r.baseType))||[],s=[];if(n.length!=r.size){if(t.WTF)throw new Error("unexpected vector length "+n.length+" != "+r.size);return s}return n.forEach(function(a){var i=a.replace(aj,"").match(ij);i&&s.push({v:Tt(i[2]),t:i[1]})}),s}var oj=/(^\s|\s$|\n)/;function lj(e){return Fs(e).map(function(t){return" "+t+'="'+e[t]+'"'}).join("")}function cj(e,t,r){return"<"+e+(r!=null?lj(r):"")+(t!=null?(t.match(oj)?' xml:space="preserve"':"")+">"+t+"</"+e:"/")+">"}function sv(e){if(et&&Buffer.isBuffer(e))return e.toString("utf8");if(typeof e=="string")return e;if(typeof Uint8Array<"u"&&e instanceof Uint8Array)return Tt(co(Jx(e)));throw new Error("Bad input format: expected Buffer or string")}var mu=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,uj={CT:"http://schemas.openxmlformats.org/package/2006/content-types"},fj=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"];function hj(e,t){for(var r=1-2*(e[t+7]>>>7),n=((e[t+7]&127)<<4)+(e[t+6]>>>4&15),s=e[t+6]&15,a=5;a>=0;--a)s=s*256+e[t+a];return n==2047?s==0?r*(1/0):NaN:(n==0?n=-1022:(n-=1023,s+=Math.pow(2,52)),r*Math.pow(2,n-52)*s)}function dj(e,t,r){var n=(t<0||1/t==-1/0?1:0)<<7,s=0,a=0,i=n?-t:t;isFinite(i)?i==0?s=a=0:(s=Math.floor(Math.log(i)/Math.LN2),a=i*Math.pow(2,52-s),s<=-1023&&(!isFinite(a)||a<Math.pow(2,52))?s=-1022:(a-=Math.pow(2,52),s+=1023)):(s=2047,a=isNaN(t)?26985:0);for(var o=0;o<=5;++o,a/=256)e[r+o]=a&255;e[r+6]=(s&15)<<4|a&15,e[r+7]=s>>4|n}var vw=function(e){for(var t=[],r=10240,n=0;n<e[0].length;++n)if(e[0][n])for(var s=0,a=e[0][n].length;s<a;s+=r)t.push.apply(t,e[0][n].slice(s,s+r));return t},yw=et?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(t){return Buffer.isBuffer(t)?t:lo(t)})):vw(e)}:vw,_w=function(e,t,r){for(var n=[],s=t;s<r;s+=2)n.push(String.fromCharCode(sa(e,s)));return n.join("").replace(en,"")},av=et?function(e,t,r){return Buffer.isBuffer(e)?e.toString("utf16le",t,r).replace(en,""):_w(e,t,r)}:_w,ww=function(e,t,r){for(var n=[],s=t;s<t+r;++s)n.push(("0"+e[s].toString(16)).slice(-2));return n.join("")},DA=et?function(e,t,r){return Buffer.isBuffer(e)?e.toString("hex",t,t+r):ww(e,t,r)}:ww,Ew=function(e,t,r){for(var n=[],s=t;s<r;s++)n.push(String.fromCharCode(Io(e,s)));return n.join("")},Hu=et?function(t,r,n){return Buffer.isBuffer(t)?t.toString("utf8",r,n):Ew(t,r,n)}:Ew,FA=function(e,t){var r=En(e,t);return r>0?Hu(e,t+4,t+4+r-1):""},OA=FA,MA=function(e,t){var r=En(e,t);return r>0?Hu(e,t+4,t+4+r-1):""},LA=MA,jA=function(e,t){var r=2*En(e,t);return r>0?Hu(e,t+4,t+4+r-1):""},UA=jA,VA=function(t,r){var n=En(t,r);return n>0?av(t,r+4,r+4+n):""},BA=VA,WA=function(e,t){var r=En(e,t);return r>0?Hu(e,t+4,t+4+r):""},zA=WA,$A=function(e,t){return hj(e,t)},cd=$A,HA=function(t){return Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array};et&&(OA=function(t,r){if(!Buffer.isBuffer(t))return FA(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},LA=function(t,r){if(!Buffer.isBuffer(t))return MA(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},UA=function(t,r){if(!Buffer.isBuffer(t))return jA(t,r);var n=2*t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n-1)},BA=function(t,r){if(!Buffer.isBuffer(t))return VA(t,r);var n=t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n)},zA=function(t,r){if(!Buffer.isBuffer(t))return WA(t,r);var n=t.readUInt32LE(r);return t.toString("utf8",r+4,r+4+n)},cd=function(t,r){return Buffer.isBuffer(t)?t.readDoubleLE(r):$A(t,r)},HA=function(t){return Buffer.isBuffer(t)||Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array});var Io=function(e,t){return e[t]},sa=function(e,t){return e[t+1]*256+e[t]},mj=function(e,t){var r=e[t+1]*256+e[t];return r<32768?r:(65535-r+1)*-1},En=function(e,t){return e[t+3]*(1<<24)+(e[t+2]<<16)+(e[t+1]<<8)+e[t]},Ni=function(e,t){return e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]},pj=function(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]};function Ac(e,t){var r="",n,s,a=[],i,o,l,c;switch(t){case"dbcs":if(c=this.l,et&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*e).toString("utf16le");else for(l=0;l<e;++l)r+=String.fromCharCode(sa(this,c)),c+=2;e*=2;break;case"utf8":r=Hu(this,this.l,this.l+e);break;case"utf16le":e*=2,r=av(this,this.l,this.l+e);break;case"wstr":return Ac.call(this,e,"dbcs");case"lpstr-ansi":r=OA(this,this.l),e=4+En(this,this.l);break;case"lpstr-cp":r=LA(this,this.l),e=4+En(this,this.l);break;case"lpwstr":r=UA(this,this.l),e=4+2*En(this,this.l);break;case"lpp4":e=4+En(this,this.l),r=BA(this,this.l),e&2&&(e+=2);break;case"8lpp4":e=4+En(this,this.l),r=zA(this,this.l),e&3&&(e+=4-(e&3));break;case"cstr":for(e=0,r="";(i=Io(this,this.l+e++))!==0;)a.push(Ff(i));r=a.join("");break;case"_wstr":for(e=0,r="";(i=sa(this,this.l+e))!==0;)a.push(Ff(i)),e+=2;e+=2,r=a.join("");break;case"dbcs-cont":for(r="",c=this.l,l=0;l<e;++l){if(this.lens&&this.lens.indexOf(c)!==-1)return i=Io(this,c),this.l=c+1,o=Ac.call(this,e-l,i?"dbcs-cont":"sbcs-cont"),a.join("")+o;a.push(Ff(sa(this,c))),c+=2}r=a.join(""),e*=2;break;case"cpstr":case"sbcs-cont":for(r="",c=this.l,l=0;l!=e;++l){if(this.lens&&this.lens.indexOf(c)!==-1)return i=Io(this,c),this.l=c+1,o=Ac.call(this,e-l,i?"dbcs-cont":"sbcs-cont"),a.join("")+o;a.push(Ff(Io(this,c))),c+=1}r=a.join("");break;default:switch(e){case 1:return n=Io(this,this.l),this.l++,n;case 2:return n=(t==="i"?mj:sa)(this,this.l),this.l+=2,n;case 4:case-4:return t==="i"||!(this[this.l+3]&128)?(n=(e>0?Ni:pj)(this,this.l),this.l+=4,n):(s=En(this,this.l),this.l+=4,s);case 8:case-8:if(t==="f")return e==8?s=cd(this,this.l):s=cd([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,s;e=8;case 16:r=DA(this,this.l,e);break}}return this.l+=e,r}var gj=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24&255},xj=function(e,t,r){e[r]=t&255,e[r+1]=t>>8&255,e[r+2]=t>>16&255,e[r+3]=t>>24&255},vj=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255};function yj(e,t,r){var n=0,s=0;if(r==="dbcs"){for(s=0;s!=t.length;++s)vj(this,t.charCodeAt(s),this.l+2*s);n=2*t.length}else if(r==="sbcs"){for(t=t.replace(/[^\x00-\x7F]/g,"_"),s=0;s!=t.length;++s)this[this.l+s]=t.charCodeAt(s)&255;n=t.length}else if(r==="hex"){for(;s<e;++s)this[this.l++]=parseInt(t.slice(2*s,2*s+2),16)||0;return this}else if(r==="utf16le"){var a=Math.min(this.l+e,this.length);for(s=0;s<Math.min(t.length,e);++s){var i=t.charCodeAt(s);this[this.l++]=i&255,this[this.l++]=i>>8}for(;this.l<a;)this[this.l++]=0;return this}else switch(e){case 1:n=1,this[this.l]=t&255;break;case 2:n=2,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255;break;case 3:n=3,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255,t>>>=8,this[this.l+2]=t&255;break;case 4:n=4,gj(this,t,this.l);break;case 8:if(n=8,r==="f"){dj(this,t,this.l);break}case 16:break;case-4:n=4,xj(this,t,this.l);break}return this.l+=n,this}function GA(e,t){var r=DA(this,this.l,e.length>>1);if(r!==e)throw new Error(t+"Expected "+e+" saw "+r);this.l+=e.length>>1}function wr(e,t){e.l=t,e.read_shift=Ac,e.chk=GA,e.write_shift=yj}function Gr(e,t){e.l+=t}function sr(e){var t=di(e);return wr(t,0),t}function ka(e,t,r){if(e){var n,s,a;wr(e,e.l||0);for(var i=e.length,o=0,l=0;e.l<i;){o=e.read_shift(1),o&128&&(o=(o&127)+((e.read_shift(1)&127)<<7));var c=pd[o]||pd[65535];for(n=e.read_shift(1),a=n&127,s=1;s<4&&n&128;++s)a+=((n=e.read_shift(1))&127)<<7*s;l=e.l+a;var f=c.f&&c.f(e,a,r);if(e.l=l,t(f,c,o))return}}}function Up(){var e=[],t=et?256:2048,r=function(c){var f=sr(c);return wr(f,0),f},n=r(t),s=function(){n&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&e.push(n),n=null)},a=function(c){return n&&c<n.length-n.l?n:(s(),n=r(Math.max(c+1,t)))},i=function(){return s(),Va(e)},o=function(c){s(),n=c,n.l==null&&(n.l=n.length),a(t)};return{next:a,push:o,end:i,_bufs:e}}function Ic(e,t,r){var n=Sr(e);if(t.s?(n.cRel&&(n.c+=t.s.c),n.rRel&&(n.r+=t.s.r)):(n.cRel&&(n.c+=t.c),n.rRel&&(n.r+=t.r)),!r||r.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function Tw(e,t,r){var n=Sr(e);return n.s=Ic(n.s,t.s,r),n.e=Ic(n.e,t.s,r),n}function Nc(e,t){if(e.cRel&&e.c<0)for(e=Sr(e);e.c<0;)e.c+=t>8?16384:256;if(e.rRel&&e.r<0)for(e=Sr(e);e.r<0;)e.r+=t>8?1048576:t>5?65536:16384;var r=We(e);return!e.cRel&&e.cRel!=null&&(r=Ej(r)),!e.rRel&&e.rRel!=null&&(r=_j(r)),r}function am(e,t){return e.s.r==0&&!e.s.rRel&&e.e.r==(t.biff>=12?1048575:t.biff>=8?65536:16384)&&!e.e.rRel?(e.s.cRel?"":"$")+or(e.s.c)+":"+(e.e.cRel?"":"$")+or(e.e.c):e.s.c==0&&!e.s.cRel&&e.e.c==(t.biff>=12?16383:255)&&!e.e.cRel?(e.s.rRel?"":"$")+Ar(e.s.r)+":"+(e.e.rRel?"":"$")+Ar(e.e.r):Nc(e.s,t.biff)+":"+Nc(e.e,t.biff)}function iv(e){return parseInt(wj(e),10)-1}function Ar(e){return""+(e+1)}function _j(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function wj(e){return e.replace(/\$(\d+)$/,"$1")}function ov(e){for(var t=Tj(e),r=0,n=0;n!==t.length;++n)r=26*r+t.charCodeAt(n)-64;return r-1}function or(e){if(e<0)throw new Error("invalid column "+e);var t="";for(++e;e;e=Math.floor((e-1)/26))t=String.fromCharCode((e-1)%26+65)+t;return t}function Ej(e){return e.replace(/^([A-Z])/,"$$$1")}function Tj(e){return e.replace(/^\$([A-Z])/,"$1")}function kj(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function Qr(e){for(var t=0,r=0,n=0;n<e.length;++n){var s=e.charCodeAt(n);s>=48&&s<=57?t=10*t+(s-48):s>=65&&s<=90&&(r=26*r+(s-64))}return{c:r-1,r:t-1}}function We(e){for(var t=e.c+1,r="";t;t=(t-1)/26|0)r=String.fromCharCode((t-1)%26+65)+r;return r+(e.r+1)}function Cl(e){var t=e.indexOf(":");return t==-1?{s:Qr(e),e:Qr(e)}:{s:Qr(e.slice(0,t)),e:Qr(e.slice(t+1))}}function at(e,t){return typeof t>"u"||typeof t=="number"?at(e.s,e.e):(typeof e!="string"&&(e=We(e)),typeof t!="string"&&(t=We(t)),e==t?e:e+":"+t)}function $t(e){var t={s:{c:0,r:0},e:{c:0,r:0}},r=0,n=0,s=0,a=e.length;for(r=0;n<a&&!((s=e.charCodeAt(n)-64)<1||s>26);++n)r=26*r+s;for(t.s.c=--r,r=0;n<a&&!((s=e.charCodeAt(n)-48)<0||s>9);++n)r=10*r+s;if(t.s.r=--r,n===a||s!=10)return t.e.c=t.s.c,t.e.r=t.s.r,t;for(++n,r=0;n!=a&&!((s=e.charCodeAt(n)-64)<1||s>26);++n)r=26*r+s;for(t.e.c=--r,r=0;n!=a&&!((s=e.charCodeAt(n)-48)<0||s>9);++n)r=10*r+s;return t.e.r=--r,t}function kw(e,t){var r=e.t=="d"&&t instanceof Date;if(e.z!=null)try{return e.w=Yn(e.z,r?tn(t):t)}catch{}try{return e.w=Yn((e.XF||{}).numFmtId||(r?14:0),r?tn(t):t)}catch{return""+t}}function wa(e,t,r){return e==null||e.t==null||e.t=="z"?"":e.w!==void 0?e.w:(e.t=="d"&&!e.z&&r&&r.dateNF&&(e.z=r.dateNF),e.t=="e"?ho[e.v]||e.v:t==null?kw(e,e.v):kw(e,t))}function _i(e,t){var r=t&&t.sheet?t.sheet:"Sheet1",n={};return n[r]=e,{SheetNames:[r],Sheets:n}}function KA(e,t,r){var n=r||{},s=e?Array.isArray(e):n.dense,a=e||(s?[]:{}),i=0,o=0;if(a&&n.origin!=null){if(typeof n.origin=="number")i=n.origin;else{var l=typeof n.origin=="string"?Qr(n.origin):n.origin;i=l.r,o=l.c}a["!ref"]||(a["!ref"]="A1:A1")}var c={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(a["!ref"]){var f=$t(a["!ref"]);c.s.c=f.s.c,c.s.r=f.s.r,c.e.c=Math.max(c.e.c,f.e.c),c.e.r=Math.max(c.e.r,f.e.r),i==-1&&(c.e.r=i=f.e.r+1)}for(var d=0;d!=t.length;++d)if(t[d]){if(!Array.isArray(t[d]))throw new Error("aoa_to_sheet expects an array of arrays");for(var m=0;m!=t[d].length;++m)if(!(typeof t[d][m]>"u")){var p={v:t[d][m]},x=i+d,g=o+m;if(c.s.r>x&&(c.s.r=x),c.s.c>g&&(c.s.c=g),c.e.r<x&&(c.e.r=x),c.e.c<g&&(c.e.c=g),t[d][m]&&typeof t[d][m]=="object"&&!Array.isArray(t[d][m])&&!(t[d][m]instanceof Date))p=t[d][m];else if(Array.isArray(p.v)&&(p.f=t[d][m][1],p.v=p.v[0]),p.v===null)if(p.f)p.t="n";else if(n.nullError)p.t="e",p.v=0;else if(n.sheetStubs)p.t="z";else continue;else typeof p.v=="number"?p.t="n":typeof p.v=="boolean"?p.t="b":p.v instanceof Date?(p.z=n.dateNF||$e[14],n.cellDates?(p.t="d",p.w=Yn(p.z,tn(p.v))):(p.t="n",p.v=tn(p.v),p.w=Yn(p.z,p.v))):p.t="s";if(s)a[x]||(a[x]=[]),a[x][g]&&a[x][g].z&&(p.z=a[x][g].z),a[x][g]=p;else{var w=We({c:g,r:x});a[w]&&a[w].z&&(p.z=a[w].z),a[w]=p}}}return c.s.c<1e7&&(a["!ref"]=at(c)),a}function bl(e,t){return KA(null,e,t)}function Sj(e){return e.read_shift(4,"i")}function zr(e){var t=e.read_shift(4);return t===0?"":e.read_shift(t,"dbcs")}function Aj(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function lv(e,t){var r=e.l,n=e.read_shift(1),s=zr(e),a=[],i={t:s,h:s};if(n&1){for(var o=e.read_shift(4),l=0;l!=o;++l)a.push(Aj(e));i.r=a}else i.r=[{ich:0,ifnt:0}];return e.l=r+t,i}var Ij=lv;function Xn(e){var t=e.read_shift(4),r=e.read_shift(2);return r+=e.read_shift(1)<<16,e.l++,{c:t,iStyleRef:r}}function uo(e){var t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:t}}var Nj=zr;function cv(e){var t=e.read_shift(4);return t===0||t===4294967295?"":e.read_shift(t,"dbcs")}var Cj=zr,Vp=cv;function uv(e){var t=e.slice(e.l,e.l+4),r=t[0]&1,n=t[0]&2;e.l+=4;var s=n===0?cd([0,0,0,0,t[0]&252,t[1],t[2],t[3]],0):Ni(t,0)>>2;return r?s/100:s}function qA(e){var t={s:{},e:{}};return t.s.r=e.read_shift(4),t.e.r=e.read_shift(4),t.s.c=e.read_shift(4),t.e.c=e.read_shift(4),t}var fo=qA;function Vr(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function bj(e){var t={},r=e.read_shift(1),n=r>>>1,s=e.read_shift(1),a=e.read_shift(2,"i"),i=e.read_shift(1),o=e.read_shift(1),l=e.read_shift(1);switch(e.l++,n){case 0:t.auto=1;break;case 1:t.index=s;var c=Wi[s];c&&(t.rgb=gu(c));break;case 2:t.rgb=gu([i,o,l]);break;case 3:t.theme=s;break}return a!=0&&(t.tint=a>0?a/32767:a/32768),t}function Rj(e){var t=e.read_shift(1);e.l++;var r={fBold:t&1,fItalic:t&2,fUnderline:t&4,fStrikeout:t&8,fOutline:t&16,fShadow:t&32,fCondense:t&64,fExtend:t&128};return r}function YA(e,t){var r={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},n=e.read_shift(4);switch(n){case 0:return"";case 4294967295:case 4294967294:return r[e.read_shift(4)]||""}if(n>400)throw new Error("Unsupported Clipboard: "+n.toString(16));return e.l-=4,e.read_shift(0,t==1?"lpstr":"lpwstr")}function Pj(e){return YA(e,1)}function Dj(e){return YA(e,2)}var fv=2,cn=3,Mf=11,Sw=12,ud=19,Lf=64,Fj=65,Oj=71,Mj=4108,Lj=4126,dr=80,XA=81,jj=[dr,XA],Uj={1:{n:"CodePage",t:fv},2:{n:"Category",t:dr},3:{n:"PresentationFormat",t:dr},4:{n:"ByteCount",t:cn},5:{n:"LineCount",t:cn},6:{n:"ParagraphCount",t:cn},7:{n:"SlideCount",t:cn},8:{n:"NoteCount",t:cn},9:{n:"HiddenCount",t:cn},10:{n:"MultimediaClipCount",t:cn},11:{n:"ScaleCrop",t:Mf},12:{n:"HeadingPairs",t:Mj},13:{n:"TitlesOfParts",t:Lj},14:{n:"Manager",t:dr},15:{n:"Company",t:dr},16:{n:"LinksUpToDate",t:Mf},17:{n:"CharacterCount",t:cn},19:{n:"SharedDoc",t:Mf},22:{n:"HyperlinksChanged",t:Mf},23:{n:"AppVersion",t:cn,p:"version"},24:{n:"DigSig",t:Fj},26:{n:"ContentType",t:dr},27:{n:"ContentStatus",t:dr},28:{n:"Language",t:dr},29:{n:"Version",t:dr},255:{},2147483648:{n:"Locale",t:ud},2147483651:{n:"Behavior",t:ud},1919054434:{}},Vj={1:{n:"CodePage",t:fv},2:{n:"Title",t:dr},3:{n:"Subject",t:dr},4:{n:"Author",t:dr},5:{n:"Keywords",t:dr},6:{n:"Comments",t:dr},7:{n:"Template",t:dr},8:{n:"LastAuthor",t:dr},9:{n:"RevNumber",t:dr},10:{n:"EditTime",t:Lf},11:{n:"LastPrinted",t:Lf},12:{n:"CreatedDate",t:Lf},13:{n:"ModifiedDate",t:Lf},14:{n:"PageCount",t:cn},15:{n:"WordCount",t:cn},16:{n:"CharCount",t:cn},17:{n:"Thumbnail",t:Oj},18:{n:"Application",t:dr},19:{n:"DocSecurity",t:cn},255:{},2147483648:{n:"Locale",t:ud},2147483651:{n:"Behavior",t:ud},1919054434:{}},Aw={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},Bj=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function Wj(e){return e.map(function(t){return[t>>16&255,t>>8&255,t&255]})}var zj=Wj([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Wi=Sr(zj),ho={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},QA={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},Iw={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"};function $j(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function Hj(e){var t=$j();if(!e||!e.match)return t;var r={};if((e.match(Kr)||[]).forEach(function(n){var s=Oe(n);switch(s[0].replace(Z6,"<")){case"<?xml":break;case"<Types":t.xmlns=s["xmlns"+(s[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":r[s.Extension]=s.ContentType;break;case"<Override":t[Iw[s.ContentType]]!==void 0&&t[Iw[s.ContentType]].push(s.PartName);break}}),t.xmlns!==uj.CT)throw new Error("Unknown Namespace: "+t.xmlns);return t.calcchain=t.calcchains.length>0?t.calcchains[0]:"",t.sst=t.strs.length>0?t.strs[0]:"",t.style=t.styles.length>0?t.styles[0]:"",t.defaults=r,delete t.calcchains,t}var Vo={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function Bp(e){var t=e.lastIndexOf("/");return e.slice(0,t+1)+"_rels/"+e.slice(t+1)+".rels"}function Cc(e,t){var r={"!id":{}};if(!e)return r;t.charAt(0)!=="/"&&(t="/"+t);var n={};return(e.match(Kr)||[]).forEach(function(s){var a=Oe(s);if(a[0]==="<Relationship"){var i={};i.Type=a.Type,i.Target=a.Target,i.Id=a.Id,a.TargetMode&&(i.TargetMode=a.TargetMode);var o=a.TargetMode==="External"?a.Target:cc(a.Target,t);r[o]=i,n[a.Id]=i}}),r["!id"]=n,r}var Gj="application/vnd.oasis.opendocument.spreadsheet";function Kj(e,t){for(var r=sv(e),n,s;n=mu.exec(r);)switch(n[3]){case"manifest":break;case"file-entry":if(s=Oe(n[0],!1),s.path=="/"&&s.type!==Gj)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(t&&t.WTF)throw n}}var bc=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],qj=function(){for(var e=new Array(bc.length),t=0;t<bc.length;++t){var r=bc[t],n="(?:"+r[0].slice(0,r[0].indexOf(":"))+":)"+r[0].slice(r[0].indexOf(":")+1);e[t]=new RegExp("<"+n+"[^>]*>([\\s\\S]*?)</"+n+">")}return e}();function JA(e){var t={};e=Tt(e);for(var r=0;r<bc.length;++r){var n=bc[r],s=e.match(qj[r]);s!=null&&s.length>0&&(t[n[1]]=lt(s[1])),n[2]==="date"&&t[n[1]]&&(t[n[1]]=gr(t[n[1]]))}return t}var Yj=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]];function ZA(e,t,r,n){var s=[];if(typeof e=="string")s=xw(e,n);else for(var a=0;a<e.length;++a)s=s.concat(e[a].map(function(f){return{v:f}}));var i=typeof t=="string"?xw(t,n).map(function(f){return f.v}):t,o=0,l=0;if(i.length>0)for(var c=0;c!==s.length;c+=2){switch(l=+s[c+1].v,s[c].v){case"Worksheets":case"":case"":case" ":case"":case" ":case"Arbeitsbltter":case"alma Sayfalar":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de clculo":case"Planilhas":case"Regneark":case"Hojas de clculo":case"Werkbladen":r.Worksheets=l,r.SheetNames=i.slice(o,o+l);break;case"Named Ranges":case"Rangos con nombre":case"":case"Benannte Bereiche":case"Navngivne omrder":r.NamedRanges=l,r.DefinedNames=i.slice(o,o+l);break;case"Charts":case"Diagramme":r.Chartsheets=l,r.ChartNames=i.slice(o,o+l);break}o+=l}}function Xj(e,t,r){var n={};return t||(t={}),e=Tt(e),Yj.forEach(function(s){var a=(e.match(du(s[0]))||[])[1];switch(s[2]){case"string":a&&(t[s[1]]=lt(a));break;case"bool":t[s[1]]=a==="true";break;case"raw":var i=e.match(new RegExp("<"+s[0]+"[^>]*>([\\s\\S]*?)</"+s[0]+">"));i&&i.length>0&&(n[s[1]]=i[1]);break}}),n.HeadingPairs&&n.TitlesOfParts&&ZA(n.HeadingPairs,n.TitlesOfParts,t,r),t}var Qj=/<[^>]+>[^<]*/g;function Jj(e,t){var r={},n="",s=e.match(Qj);if(s)for(var a=0;a!=s.length;++a){var i=s[a],o=Oe(i);switch(o[0]){case"<?xml":break;case"<Properties":break;case"<property":n=lt(o.name);break;case"</property>":n=null;break;default:if(i.indexOf("<vt:")===0){var l=i.split(">"),c=l[0].slice(4),f=l[1];switch(c){case"lpstr":case"bstr":case"lpwstr":r[n]=lt(f);break;case"bool":r[n]=Pt(f);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":r[n]=parseInt(f,10);break;case"r4":case"r8":case"decimal":r[n]=parseFloat(f);break;case"filetime":case"date":r[n]=gr(f);break;case"cy":case"error":r[n]=lt(f);break;default:if(c.slice(-1)=="/")break;t.WTF&&typeof console<"u"&&console.warn("Unexpected",i,c,l)}}else if(i.slice(0,2)!=="</"){if(t.WTF)throw new Error(i)}}}return r}var Zj={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},im;function e8(e,t,r){im||(im=tv(Zj)),t=im[t]||t,e[t]=r}function hv(e){var t=e.read_shift(4),r=e.read_shift(4);return new Date((r/1e7*Math.pow(2,32)+t/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function eI(e,t,r){var n=e.l,s=e.read_shift(0,"lpstr-cp");if(r)for(;e.l-n&3;)++e.l;return s}function tI(e,t,r){var n=e.read_shift(0,"lpwstr");return n}function rI(e,t,r){return t===31?tI(e):eI(e,t,r)}function Wp(e,t,r){return rI(e,t,r===!1?0:4)}function t8(e,t){if(!t)throw new Error("VtUnalignedString must have positive length");return rI(e,t,0)}function r8(e){for(var t=e.read_shift(4),r=[],n=0;n!=t;++n){var s=e.l;r[n]=e.read_shift(0,"lpwstr").replace(en,""),e.l-s&2&&(e.l+=2)}return r}function n8(e){for(var t=e.read_shift(4),r=[],n=0;n!=t;++n)r[n]=e.read_shift(0,"lpstr-cp").replace(en,"");return r}function s8(e){var t=e.l,r=fd(e,XA);e[e.l]==0&&e[e.l+1]==0&&e.l-t&2&&(e.l+=2);var n=fd(e,cn);return[r,n]}function a8(e){for(var t=e.read_shift(4),r=[],n=0;n<t/2;++n)r.push(s8(e));return r}function Nw(e,t){for(var r=e.read_shift(4),n={},s=0;s!=r;++s){var a=e.read_shift(4),i=e.read_shift(4);n[a]=e.read_shift(i,t===1200?"utf16le":"utf8").replace(en,"").replace(lc,"!"),t===1200&&i%2&&(e.l+=2)}return e.l&3&&(e.l=e.l>>3<<2),n}function nI(e){var t=e.read_shift(4),r=e.slice(e.l,e.l+t);return e.l+=t,(t&3)>0&&(e.l+=4-(t&3)&3),r}function i8(e){var t={};return t.Size=e.read_shift(4),e.l+=t.Size+3-(t.Size-1)%4,t}function fd(e,t,r){var n=e.read_shift(2),s,a=r||{};if(e.l+=2,t!==Sw&&n!==t&&jj.indexOf(t)===-1&&!((t&65534)==4126&&(n&65534)==4126))throw new Error("Expected type "+t+" saw "+n);switch(t===Sw?n:t){case 2:return s=e.read_shift(2,"i"),a.raw||(e.l+=2),s;case 3:return s=e.read_shift(4,"i"),s;case 11:return e.read_shift(4)!==0;case 19:return s=e.read_shift(4),s;case 30:return eI(e,n,4).replace(en,"");case 31:return tI(e);case 64:return hv(e);case 65:return nI(e);case 71:return i8(e);case 80:return Wp(e,n,!a.raw).replace(en,"");case 81:return t8(e,n).replace(en,"");case 4108:return a8(e);case 4126:case 4127:return n==4127?r8(e):n8(e);default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+n)}}function Cw(e,t){var r=e.l,n=e.read_shift(4),s=e.read_shift(4),a=[],i=0,o=0,l=-1,c={};for(i=0;i!=s;++i){var f=e.read_shift(4),d=e.read_shift(4);a[i]=[f,d+r]}a.sort(function(E,y){return E[1]-y[1]});var m={};for(i=0;i!=s;++i){if(e.l!==a[i][1]){var p=!0;if(i>0&&t)switch(t[a[i-1][0]].t){case 2:e.l+2===a[i][1]&&(e.l+=2,p=!1);break;case 80:e.l<=a[i][1]&&(e.l=a[i][1],p=!1);break;case 4108:e.l<=a[i][1]&&(e.l=a[i][1],p=!1);break}if((!t||i==0)&&e.l<=a[i][1]&&(p=!1,e.l=a[i][1]),p)throw new Error("Read Error: Expected address "+a[i][1]+" at "+e.l+" :"+i)}if(t){var x=t[a[i][0]];if(m[x.n]=fd(e,x.t,{raw:!0}),x.p==="version"&&(m[x.n]=String(m[x.n]>>16)+"."+("0000"+String(m[x.n]&65535)).slice(-4)),x.n=="CodePage")switch(m[x.n]){case 0:m[x.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:cs(o=m[x.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+m[x.n])}}else if(a[i][0]===1){if(o=m.CodePage=fd(e,fv),cs(o),l!==-1){var g=e.l;e.l=a[l][1],c=Nw(e,o),e.l=g}}else if(a[i][0]===0){if(o===0){l=i,e.l=a[i+1][1];continue}c=Nw(e,o)}else{var w=c[a[i][0]],k;switch(e[e.l]){case 65:e.l+=4,k=nI(e);break;case 30:e.l+=4,k=Wp(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 31:e.l+=4,k=Wp(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 3:e.l+=4,k=e.read_shift(4,"i");break;case 19:e.l+=4,k=e.read_shift(4);break;case 5:e.l+=4,k=e.read_shift(8,"f");break;case 11:e.l+=4,k=Ht(e,4);break;case 64:e.l+=4,k=gr(hv(e));break;default:throw new Error("unparsed value: "+e[e.l])}m[w]=k}}return e.l=r+n,m}function bw(e,t,r){var n=e.content;if(!n)return{};wr(n,0);var s,a,i,o,l=0;n.chk("feff","Byte Order: "),n.read_shift(2);var c=n.read_shift(4),f=n.read_shift(16);if(f!==st.utils.consts.HEADER_CLSID&&f!==r)throw new Error("Bad PropertySet CLSID "+f);if(s=n.read_shift(4),s!==1&&s!==2)throw new Error("Unrecognized #Sets: "+s);if(a=n.read_shift(16),o=n.read_shift(4),s===1&&o!==n.l)throw new Error("Length mismatch: "+o+" !== "+n.l);s===2&&(i=n.read_shift(16),l=n.read_shift(4));var d=Cw(n,t),m={SystemIdentifier:c};for(var p in d)m[p]=d[p];if(m.FMTID=a,s===1)return m;if(l-n.l==2&&(n.l+=2),n.l!==l)throw new Error("Length mismatch 2: "+n.l+" !== "+l);var x;try{x=Cw(n,null)}catch{}for(p in x)m[p]=x[p];return m.FMTID=[a,i],m}function Ra(e,t){return e.read_shift(t),null}function o8(e,t,r){for(var n=[],s=e.l+t;e.l<s;)n.push(r(e,s-e.l));if(s!==e.l)throw new Error("Slurp error");return n}function Ht(e,t){return e.read_shift(t)===1}function Zt(e){return e.read_shift(2,"u")}function sI(e,t){return o8(e,t,Zt)}function l8(e){var t=e.read_shift(1),r=e.read_shift(1);return r===1?t:t===1}function Gu(e,t,r){var n=e.read_shift(r&&r.biff>=12?2:1),s="sbcs-cont";if(r&&r.biff>=8,!r||r.biff==8){var a=e.read_shift(1);a&&(s="dbcs-cont")}else r.biff==12&&(s="wstr");r.biff>=2&&r.biff<=5&&(s="cpstr");var i=n?e.read_shift(n,s):"";return i}function c8(e){var t=e.read_shift(2),r=e.read_shift(1),n=r&4,s=r&8,a=1+(r&1),i=0,o,l={};s&&(i=e.read_shift(2)),n&&(o=e.read_shift(4));var c=a==2?"dbcs-cont":"sbcs-cont",f=t===0?"":e.read_shift(t,c);return s&&(e.l+=4*i),n&&(e.l+=o),l.t=f,s||(l.raw="<t>"+l.t+"</t>",l.r=l.t),l}function to(e,t,r){var n;if(r){if(r.biff>=2&&r.biff<=5)return e.read_shift(t,"cpstr");if(r.biff>=12)return e.read_shift(t,"dbcs-cont")}var s=e.read_shift(1);return s===0?n=e.read_shift(t,"sbcs-cont"):n=e.read_shift(t,"dbcs-cont"),n}function Ku(e,t,r){var n=e.read_shift(r&&r.biff==2?1:2);return n===0?(e.l++,""):to(e,n,r)}function mo(e,t,r){if(r.biff>5)return Ku(e,t,r);var n=e.read_shift(1);return n===0?(e.l++,""):e.read_shift(n,r.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function u8(e){var t=e.read_shift(1);e.l++;var r=e.read_shift(2);return e.l+=2,[t,r]}function f8(e){var t=e.read_shift(4),r=e.l,n=!1;t>24&&(e.l+=t-24,e.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(n=!0),e.l=r);var s=e.read_shift((n?t-24:t)>>1,"utf16le").replace(en,"");return n&&(e.l+=24),s}function h8(e){for(var t=e.read_shift(2),r="";t-- >0;)r+="../";var n=e.read_shift(0,"lpstr-ansi");if(e.l+=2,e.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var s=e.read_shift(4);if(s===0)return r+n.replace(/\\/g,"/");var a=e.read_shift(4);if(e.read_shift(2)!=3)throw new Error("Bad FileMoniker");var i=e.read_shift(a>>1,"utf16le").replace(en,"");return r+i}function d8(e,t){var r=e.read_shift(16);switch(r){case"e0c9ea79f9bace118c8200aa004ba90b":return f8(e);case"0303000000000000c000000000000046":return h8(e);default:throw new Error("Unsupported Moniker "+r)}}function jf(e){var t=e.read_shift(4),r=t>0?e.read_shift(t,"utf16le").replace(en,""):"";return r}function m8(e,t){var r=e.l+t,n=e.read_shift(4);if(n!==2)throw new Error("Unrecognized streamVersion: "+n);var s=e.read_shift(2);e.l+=2;var a,i,o,l,c="",f,d;s&16&&(a=jf(e,r-e.l)),s&128&&(i=jf(e,r-e.l)),(s&257)===257&&(o=jf(e,r-e.l)),(s&257)===1&&(l=d8(e,r-e.l)),s&8&&(c=jf(e,r-e.l)),s&32&&(f=e.read_shift(16)),s&64&&(d=hv(e)),e.l=r;var m=i||o||l||"";m&&c&&(m+="#"+c),m||(m="#"+c),s&2&&m.charAt(0)=="/"&&m.charAt(1)!="/"&&(m="file://"+m);var p={Target:m};return f&&(p.guid=f),d&&(p.time=d),a&&(p.Tooltip=a),p}function aI(e){var t=e.read_shift(1),r=e.read_shift(1),n=e.read_shift(1),s=e.read_shift(1);return[t,r,n,s]}function iI(e,t){var r=aI(e);return r[3]=0,r}function Bs(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2);return{r:t,c:r,ixfe:n}}function p8(e){var t=e.read_shift(2),r=e.read_shift(2);return e.l+=8,{type:t,flags:r}}function g8(e,t,r){return t===0?"":mo(e,t,r)}function x8(e,t,r){var n=r.biff>8?4:2,s=e.read_shift(n),a=e.read_shift(n,"i"),i=e.read_shift(n,"i");return[s,a,i]}function oI(e){var t=e.read_shift(2),r=uv(e);return[t,r]}function v8(e,t,r){e.l+=4,t-=4;var n=e.l+t,s=Gu(e,t,r),a=e.read_shift(2);if(n-=e.l,a!==n)throw new Error("Malformed AddinUdf: padding = "+n+" != "+a);return e.l+=a,s}function l0(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2),s=e.read_shift(2);return{s:{c:n,r:t},e:{c:s,r}}}function lI(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(1),s=e.read_shift(1);return{s:{c:n,r:t},e:{c:s,r}}}var y8=lI;function cI(e){e.l+=4;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2);return e.l+=12,[r,t,n]}function _8(e){var t={};return e.l+=4,e.l+=16,t.fSharedNote=e.read_shift(2),e.l+=4,t}function w8(e){var t={};return e.l+=4,e.cf=e.read_shift(2),t}function Or(e){e.l+=2,e.l+=e.read_shift(2)}var E8={0:Or,4:Or,5:Or,6:Or,7:w8,8:Or,9:Or,10:Or,11:Or,12:Or,13:_8,14:Or,15:Or,16:Or,17:Or,18:Or,19:Or,20:Or,21:cI};function T8(e,t){for(var r=e.l+t,n=[];e.l<r;){var s=e.read_shift(2);e.l-=2;try{n.push(E8[s](e,r-e.l))}catch{return e.l=r,n}}return e.l!=r&&(e.l=r),n}function Uf(e,t){var r={BIFFVer:0,dt:0};switch(r.BIFFVer=e.read_shift(2),t-=2,t>=2&&(r.dt=e.read_shift(2),e.l-=2),r.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(t>6)throw new Error("Unexpected BIFF Ver "+r.BIFFVer)}return e.read_shift(t),r}function k8(e,t){return t===0||e.read_shift(2),1200}function S8(e,t,r){if(r.enc)return e.l+=t,"";var n=e.l,s=mo(e,0,r);return e.read_shift(t+n-e.l),s}function A8(e,t,r){var n=r&&r.biff==8||t==2?e.read_shift(2):(e.l+=t,0);return{fDialog:n&16,fBelow:n&64,fRight:n&128}}function I8(e,t,r){var n=e.read_shift(4),s=e.read_shift(1)&3,a=e.read_shift(1);switch(a){case 0:a="Worksheet";break;case 1:a="Macrosheet";break;case 2:a="Chartsheet";break;case 6:a="VBAModule";break}var i=Gu(e,0,r);return i.length===0&&(i="Sheet1"),{pos:n,hs:s,dt:a,name:i}}function N8(e,t){for(var r=e.l+t,n=e.read_shift(4),s=e.read_shift(4),a=[],i=0;i!=s&&e.l<r;++i)a.push(c8(e));return a.Count=n,a.Unique=s,a}function C8(e,t){var r={};return r.dsst=e.read_shift(2),e.l+=t-2,r}function b8(e){var t={};t.r=e.read_shift(2),t.c=e.read_shift(2),t.cnt=e.read_shift(2)-t.c;var r=e.read_shift(2);e.l+=4;var n=e.read_shift(1);return e.l+=3,n&7&&(t.level=n&7),n&32&&(t.hidden=!0),n&64&&(t.hpt=r/20),t}function R8(e){var t=p8(e);if(t.type!=2211)throw new Error("Invalid Future Record "+t.type);var r=e.read_shift(4);return r!==0}function P8(e){return e.read_shift(2),e.read_shift(4)}function Rw(e,t,r){var n=0;r&&r.biff==2||(n=e.read_shift(2));var s=e.read_shift(2);r&&r.biff==2&&(n=1-(s>>15),s&=32767);var a={Unsynced:n&1,DyZero:(n&2)>>1,ExAsc:(n&4)>>2,ExDsc:(n&8)>>3};return[a,s]}function D8(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2),s=e.read_shift(2),a=e.read_shift(2),i=e.read_shift(2),o=e.read_shift(2),l=e.read_shift(2),c=e.read_shift(2);return{Pos:[t,r],Dim:[n,s],Flags:a,CurTab:i,FirstTab:o,Selected:l,TabRatio:c}}function F8(e,t,r){if(r&&r.biff>=2&&r.biff<5)return{};var n=e.read_shift(2);return{RTL:n&64}}function O8(){}function M8(e,t,r){var n={dyHeight:e.read_shift(2),fl:e.read_shift(2)};switch(r&&r.biff||8){case 2:break;case 3:case 4:e.l+=2;break;default:e.l+=10;break}return n.name=Gu(e,0,r),n}function L8(e){var t=Bs(e);return t.isst=e.read_shift(4),t}function j8(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=e.l+t,s=Bs(e);r.biff==2&&e.l++;var a=Ku(e,n-e.l,r);return s.val=a,s}function U8(e,t,r){var n=e.read_shift(2),s=mo(e,0,r);return[n,s]}var V8=mo;function Pw(e,t,r){var n=e.l+t,s=r.biff==8||!r.biff?4:2,a=e.read_shift(s),i=e.read_shift(s),o=e.read_shift(2),l=e.read_shift(2);return e.l=n,{s:{r:a,c:o},e:{r:i,c:l}}}function B8(e){var t=e.read_shift(2),r=e.read_shift(2),n=oI(e);return{r:t,c:r,ixfe:n[0],rknum:n[1]}}function W8(e,t){for(var r=e.l+t-2,n=e.read_shift(2),s=e.read_shift(2),a=[];e.l<r;)a.push(oI(e));if(e.l!==r)throw new Error("MulRK read error");var i=e.read_shift(2);if(a.length!=i-s+1)throw new Error("MulRK length mismatch");return{r:n,c:s,C:i,rkrec:a}}function z8(e,t){for(var r=e.l+t-2,n=e.read_shift(2),s=e.read_shift(2),a=[];e.l<r;)a.push(e.read_shift(2));if(e.l!==r)throw new Error("MulBlank read error");var i=e.read_shift(2);if(a.length!=i-s+1)throw new Error("MulBlank length mismatch");return{r:n,c:s,C:i,ixfe:a}}function $8(e,t,r,n){var s={},a=e.read_shift(4),i=e.read_shift(4),o=e.read_shift(4),l=e.read_shift(2);return s.patternType=Bj[o>>26],n.cellStyles&&(s.alc=a&7,s.fWrap=a>>3&1,s.alcV=a>>4&7,s.fJustLast=a>>7&1,s.trot=a>>8&255,s.cIndent=a>>16&15,s.fShrinkToFit=a>>20&1,s.iReadOrder=a>>22&2,s.fAtrNum=a>>26&1,s.fAtrFnt=a>>27&1,s.fAtrAlc=a>>28&1,s.fAtrBdr=a>>29&1,s.fAtrPat=a>>30&1,s.fAtrProt=a>>31&1,s.dgLeft=i&15,s.dgRight=i>>4&15,s.dgTop=i>>8&15,s.dgBottom=i>>12&15,s.icvLeft=i>>16&127,s.icvRight=i>>23&127,s.grbitDiag=i>>30&3,s.icvTop=o&127,s.icvBottom=o>>7&127,s.icvDiag=o>>14&127,s.dgDiag=o>>21&15,s.icvFore=l&127,s.icvBack=l>>7&127,s.fsxButton=l>>14&1),s}function H8(e,t,r){var n={};return n.ifnt=e.read_shift(2),n.numFmtId=e.read_shift(2),n.flags=e.read_shift(2),n.fStyle=n.flags>>2&1,t-=6,n.data=$8(e,t,n.fStyle,r),n}function G8(e){e.l+=4;var t=[e.read_shift(2),e.read_shift(2)];if(t[0]!==0&&t[0]--,t[1]!==0&&t[1]--,t[0]>7||t[1]>7)throw new Error("Bad Gutters: "+t.join("|"));return t}function Dw(e,t,r){var n=Bs(e);(r.biff==2||t==9)&&++e.l;var s=l8(e);return n.val=s,n.t=s===!0||s===!1?"b":"e",n}function K8(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=Bs(e),s=Vr(e);return n.val=s,n}var Fw=g8;function q8(e,t,r){var n=e.l+t,s=e.read_shift(2),a=e.read_shift(2);if(r.sbcch=a,a==1025||a==14849)return[a,s];if(a<1||a>255)throw new Error("Unexpected SupBook type: "+a);for(var i=to(e,a),o=[];n>e.l;)o.push(Ku(e));return[a,s,i,o]}function Ow(e,t,r){var n=e.read_shift(2),s,a={fBuiltIn:n&1,fWantAdvise:n>>>1&1,fWantPict:n>>>2&1,fOle:n>>>3&1,fOleLink:n>>>4&1,cf:n>>>5&1023,fIcon:n>>>15&1};return r.sbcch===14849&&(s=v8(e,t-2,r)),a.body=s||e.read_shift(t-2),typeof s=="string"&&(a.Name=s),a}var Y8=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function Mw(e,t,r){var n=e.l+t,s=e.read_shift(2),a=e.read_shift(1),i=e.read_shift(1),o=e.read_shift(r&&r.biff==2?1:2),l=0;(!r||r.biff>=5)&&(r.biff!=5&&(e.l+=2),l=e.read_shift(2),r.biff==5&&(e.l+=2),e.l+=4);var c=to(e,i,r);s&32&&(c=Y8[c.charCodeAt(0)]);var f=n-e.l;r&&r.biff==2&&--f;var d=n==e.l||o===0||!(f>0)?[]:bV(e,f,r,o);return{chKey:a,Name:c,itab:l,rgce:d}}function uI(e,t,r){if(r.biff<8)return X8(e,t,r);for(var n=[],s=e.l+t,a=e.read_shift(r.biff>8?4:2);a--!==0;)n.push(x8(e,r.biff>8?12:6,r));if(e.l!=s)throw new Error("Bad ExternSheet: "+e.l+" != "+s);return n}function X8(e,t,r){e[e.l+1]==3&&e[e.l]++;var n=Gu(e,t,r);return n.charCodeAt(0)==3?n.slice(1):n}function Q8(e,t,r){if(r.biff<8){e.l+=t;return}var n=e.read_shift(2),s=e.read_shift(2),a=to(e,n,r),i=to(e,s,r);return[a,i]}function J8(e,t,r){var n=lI(e);e.l++;var s=e.read_shift(1);return t-=8,[RV(e,t,r),s,n]}function Lw(e,t,r){var n=y8(e);switch(r.biff){case 2:e.l++,t-=7;break;case 3:case 4:e.l+=2,t-=8;break;default:e.l+=6,t-=12}return[n,NV(e,t,r)]}function Z8(e){var t=e.read_shift(4)!==0,r=e.read_shift(4)!==0,n=e.read_shift(4);return[t,r,n]}function e5(e,t,r){if(!(r.biff<8)){var n=e.read_shift(2),s=e.read_shift(2),a=e.read_shift(2),i=e.read_shift(2),o=mo(e,0,r);return r.biff<8&&e.read_shift(1),[{r:n,c:s},o,i,a]}}function t5(e,t,r){return e5(e,t,r)}function r5(e,t){for(var r=[],n=e.read_shift(2);n--;)r.push(l0(e));return r}function n5(e,t,r){if(r&&r.biff<8)return a5(e,t,r);var n=cI(e),s=T8(e,t-22,n[1]);return{cmo:n,ft:s}}var s5={8:function(e,t){var r=e.l+t;e.l+=10;var n=e.read_shift(2);e.l+=4,e.l+=2,e.l+=2,e.l+=2,e.l+=4;var s=e.read_shift(1);return e.l+=s,e.l=r,{fmt:n}}};function a5(e,t,r){e.l+=4;var n=e.read_shift(2),s=e.read_shift(2),a=e.read_shift(2);e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=6,t-=36;var i=[];return i.push((s5[n]||Gr)(e,t,r)),{cmo:[s,n,a],ft:i}}function i5(e,t,r){var n=e.l,s="";try{e.l+=4;var a=(r.lastobj||{cmo:[0,0]}).cmo[1],i;[0,5,7,11,12,14].indexOf(a)==-1?e.l+=6:i=u8(e,6,r);var o=e.read_shift(2);e.read_shift(2),Zt(e,2);var l=e.read_shift(2);e.l+=l;for(var c=1;c<e.lens.length-1;++c){if(e.l-n!=e.lens[c])throw new Error("TxO: bad continue record");var f=e[e.l],d=to(e,e.lens[c+1]-e.lens[c]-1);if(s+=d,s.length>=(f?o:2*o))break}if(s.length!==o&&s.length!==o*2)throw new Error("cchText: "+o+" != "+s.length);return e.l=n+t,{t:s}}catch{return e.l=n+t,{t:s}}}function o5(e,t){var r=l0(e);e.l+=16;var n=m8(e,t-24);return[r,n]}function l5(e,t){e.read_shift(2);var r=l0(e),n=e.read_shift((t-10)/2,"dbcs-cont");return n=n.replace(en,""),[r,n]}function c5(e){var t=[0,0],r;return r=e.read_shift(2),t[0]=Aw[r]||r,r=e.read_shift(2),t[1]=Aw[r]||r,t}function u5(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(iI(e));return r}function f5(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(iI(e));return r}function h5(e){e.l+=2;var t={cxfs:0,crc:0};return t.cxfs=e.read_shift(2),t.crc=e.read_shift(4),t}function fI(e,t,r){if(!r.cellStyles)return Gr(e,t);var n=r&&r.biff>=12?4:2,s=e.read_shift(n),a=e.read_shift(n),i=e.read_shift(n),o=e.read_shift(n),l=e.read_shift(2);n==2&&(e.l+=2);var c={s,e:a,w:i,ixfe:o,flags:l};return(r.biff>=5||!r.biff)&&(c.level=l>>8&7),c}function d5(e,t){var r={};return t<32||(e.l+=16,r.header=Vr(e),r.footer=Vr(e),e.l+=2),r}function m5(e,t,r){var n={area:!1};if(r.biff!=5)return e.l+=t,n;var s=e.read_shift(1);return e.l+=3,s&16&&(n.area=!0),n}var p5=Bs,g5=sI,x5=Ku;function v5(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),s={fmt:t,env:r,len:n,data:e.slice(e.l,e.l+n)};return e.l+=n,s}function y5(e,t,r){r.biffguess&&r.biff==5&&(r.biff=2);var n=Bs(e);++e.l;var s=mo(e,t-7,r);return n.t="str",n.val=s,n}function _5(e){var t=Bs(e);++e.l;var r=Vr(e);return t.t="n",t.val=r,t}function w5(e){var t=Bs(e);++e.l;var r=e.read_shift(2);return t.t="n",t.val=r,t}function E5(e){var t=e.read_shift(1);return t===0?(e.l++,""):e.read_shift(t,"sbcs-cont")}function T5(e,t){e.l+=6,e.l+=2,e.l+=1,e.l+=3,e.l+=1,e.l+=t-13}function k5(e,t,r){var n=e.l+t,s=Bs(e),a=e.read_shift(2),i=to(e,a,r);return e.l=n,s.t="str",s.val=i,s}var S5=[2,3,48,49,131,139,140,245],jw=function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},t=tv({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(o,l){var c=[],f=di(1);switch(l.type){case"base64":f=os(bn(o));break;case"binary":f=os(o);break;case"buffer":case"array":f=o;break}wr(f,0);var d=f.read_shift(1),m=!!(d&136),p=!1,x=!1;switch(d){case 2:break;case 3:break;case 48:p=!0,m=!0;break;case 49:p=!0,m=!0;break;case 131:break;case 139:break;case 140:x=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+d.toString(16))}var g=0,w=521;d==2&&(g=f.read_shift(2)),f.l+=3,d!=2&&(g=f.read_shift(4)),g>1048576&&(g=1e6),d!=2&&(w=f.read_shift(2));var k=f.read_shift(2),E=l.codepage||1252;d!=2&&(f.l+=16,f.read_shift(1),f[f.l]!==0&&(E=e[f[f.l]]),f.l+=1,f.l+=2),x&&(f.l+=36);for(var y=[],I={},M=Math.min(f.length,d==2?521:w-10-(p?264:0)),O=x?32:11;f.l<M&&f[f.l]!=13;)switch(I={},I.name=fu.utils.decode(E,f.slice(f.l,f.l+O)).replace(/[\u0000\r\n].*$/g,""),f.l+=O,I.type=String.fromCharCode(f.read_shift(1)),d!=2&&!x&&(I.offset=f.read_shift(4)),I.len=f.read_shift(1),d==2&&(I.offset=f.read_shift(2)),I.dec=f.read_shift(1),I.name.length&&y.push(I),d!=2&&(f.l+=x?13:14),I.type){case"B":(!p||I.len!=8)&&l.WTF&&console.log("Skipping "+I.name+":"+I.type);break;case"G":case"P":l.WTF&&console.log("Skipping "+I.name+":"+I.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+I.type)}if(f[f.l]!==13&&(f.l=w-1),f.read_shift(1)!==13)throw new Error("DBF Terminator not found "+f.l+" "+f[f.l]);f.l=w;var v=0,T=0;for(c[0]=[],T=0;T!=y.length;++T)c[0][T]=y[T].name;for(;g-- >0;){if(f[f.l]===42){f.l+=k;continue}for(++f.l,c[++v]=[],T=0,T=0;T!=y.length;++T){var S=f.slice(f.l,f.l+y[T].len);f.l+=y[T].len,wr(S,0);var C=fu.utils.decode(E,S);switch(y[T].type){case"C":C.trim().length&&(c[v][T]=C.replace(/\s+$/,""));break;case"D":C.length===8?c[v][T]=new Date(+C.slice(0,4),+C.slice(4,6)-1,+C.slice(6,8)):c[v][T]=C;break;case"F":c[v][T]=parseFloat(C.trim());break;case"+":case"I":c[v][T]=x?S.read_shift(-4,"i")^2147483648:S.read_shift(4,"i");break;case"L":switch(C.trim().toUpperCase()){case"Y":case"T":c[v][T]=!0;break;case"N":case"F":c[v][T]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+C+"|")}break;case"M":if(!m)throw new Error("DBF Unexpected MEMO for type "+d.toString(16));c[v][T]="##MEMO##"+(x?parseInt(C.trim(),10):S.read_shift(4));break;case"N":C=C.replace(/\u0000/g,"").trim(),C&&C!="."&&(c[v][T]=+C||0);break;case"@":c[v][T]=new Date(S.read_shift(-8,"f")-621356832e5);break;case"T":c[v][T]=new Date((S.read_shift(4)-2440588)*864e5+S.read_shift(4));break;case"Y":c[v][T]=S.read_shift(4,"i")/1e4+S.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":c[v][T]=-S.read_shift(-8,"f");break;case"B":if(p&&y[T].len==8){c[v][T]=S.read_shift(8,"f");break}case"G":case"P":S.l+=y[T].len;break;case"0":if(y[T].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+y[T].type)}}}if(d!=2&&f.l<f.length&&f[f.l++]!=26)throw new Error("DBF EOF Marker missing "+(f.l-1)+" of "+f.length+" "+f[f.l-1].toString(16));return l&&l.sheetRows&&(c=c.slice(0,l.sheetRows)),l.DBF=y,c}function n(o,l){var c=l||{};c.dateNF||(c.dateNF="yyyymmdd");var f=bl(r(o,c),c);return f["!cols"]=c.DBF.map(function(d){return{wch:d.len,DBF:d}}),delete c.DBF,f}function s(o,l){try{return _i(n(o,l),l)}catch(c){if(l&&l.WTF)throw c}return{SheetNames:[],Sheets:{}}}var a={B:8,C:250,L:1,D:8,"?":0,"":0};function i(o,l){var c=l||{};if(+c.codepage>=0&&cs(+c.codepage),c.type=="string")throw new Error("Cannot write DBF to JS string");var f=Up(),d=qp(o,{header:1,raw:!0,cellDates:!0}),m=d[0],p=d.slice(1),x=o["!cols"]||[],g=0,w=0,k=0,E=1;for(g=0;g<m.length;++g){if(((x[g]||{}).DBF||{}).name){m[g]=x[g].DBF.name,++k;continue}if(m[g]!=null){if(++k,typeof m[g]=="number"&&(m[g]=m[g].toString(10)),typeof m[g]!="string")throw new Error("DBF Invalid column name "+m[g]+" |"+typeof m[g]+"|");if(m.indexOf(m[g])!==g){for(w=0;w<1024;++w)if(m.indexOf(m[g]+"_"+w)==-1){m[g]+="_"+w;break}}}}var y=$t(o["!ref"]),I=[],M=[],O=[];for(g=0;g<=y.e.c-y.s.c;++g){var v="",T="",S=0,C=[];for(w=0;w<p.length;++w)p[w][g]!=null&&C.push(p[w][g]);if(C.length==0||m[g]==null){I[g]="?";continue}for(w=0;w<C.length;++w){switch(typeof C[w]){case"number":T="B";break;case"string":T="C";break;case"boolean":T="L";break;case"object":T=C[w]instanceof Date?"D":"C";break;default:T="C"}S=Math.max(S,String(C[w]).length),v=v&&v!=T?"C":T}S>250&&(S=250),T=((x[g]||{}).DBF||{}).type,T=="C"&&x[g].DBF.len>S&&(S=x[g].DBF.len),v=="B"&&T=="N"&&(v="N",O[g]=x[g].DBF.dec,S=x[g].DBF.len),M[g]=v=="C"||T=="N"?S:a[v]||0,E+=M[g],I[g]=v}var b=f.next(32);for(b.write_shift(4,318902576),b.write_shift(4,p.length),b.write_shift(2,296+32*k),b.write_shift(2,E),g=0;g<4;++g)b.write_shift(4,0);for(b.write_shift(4,0|(+t[uA]||3)<<8),g=0,w=0;g<m.length;++g)if(m[g]!=null){var P=f.next(32),D=(m[g].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);P.write_shift(1,D,"sbcs"),P.write_shift(1,I[g]=="?"?"C":I[g],"sbcs"),P.write_shift(4,w),P.write_shift(1,M[g]||a[I[g]]||0),P.write_shift(1,O[g]||0),P.write_shift(1,2),P.write_shift(4,0),P.write_shift(1,0),P.write_shift(4,0),P.write_shift(4,0),w+=M[g]||a[I[g]]||0}var ie=f.next(264);for(ie.write_shift(4,13),g=0;g<65;++g)ie.write_shift(4,0);for(g=0;g<p.length;++g){var Z=f.next(E);for(Z.write_shift(1,0),w=0;w<m.length;++w)if(m[w]!=null)switch(I[w]){case"L":Z.write_shift(1,p[g][w]==null?63:p[g][w]?84:70);break;case"B":Z.write_shift(8,p[g][w]||0,"f");break;case"N":var fe="0";for(typeof p[g][w]=="number"&&(fe=p[g][w].toFixed(O[w]||0)),k=0;k<M[w]-fe.length;++k)Z.write_shift(1,32);Z.write_shift(1,fe,"sbcs");break;case"D":p[g][w]?(Z.write_shift(4,("0000"+p[g][w].getFullYear()).slice(-4),"sbcs"),Z.write_shift(2,("00"+(p[g][w].getMonth()+1)).slice(-2),"sbcs"),Z.write_shift(2,("00"+p[g][w].getDate()).slice(-2),"sbcs")):Z.write_shift(8,"00000000","sbcs");break;case"C":var ue=String(p[g][w]!=null?p[g][w]:"").slice(0,M[w]);for(Z.write_shift(1,ue,"sbcs"),k=0;k<M[w]-ue.length;++k)Z.write_shift(1,32);break}}return f.next(1).write_shift(1,26),f.end()}return{to_workbook:s,to_sheet:n,from_sheet:i}}(),A5=function(){var e={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},t=new RegExp("\x1BN("+Fs(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(m,p){var x=e[p];return typeof x=="number"?ew(x):x},n=function(m,p,x){var g=p.charCodeAt(0)-32<<4|x.charCodeAt(0)-48;return g==59?m:ew(g)};e["|"]=254;function s(m,p){switch(p.type){case"base64":return a(bn(m),p);case"binary":return a(m,p);case"buffer":return a(et&&Buffer.isBuffer(m)?m.toString("binary"):co(m),p);case"array":return a(eo(m),p)}throw new Error("Unrecognized type "+p.type)}function a(m,p){var x=m.split(/[\n\r]+/),g=-1,w=-1,k=0,E=0,y=[],I=[],M=null,O={},v=[],T=[],S=[],C=0,b;for(+p.codepage>=0&&cs(+p.codepage);k!==x.length;++k){C=0;var P=x[k].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(t,r),D=P.replace(/;;/g,"\0").split(";").map(function(V){return V.replace(/\u0000/g,";")}),ie=D[0],Z;if(P.length>0)switch(ie){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":D[1].charAt(0)=="P"&&I.push(P.slice(3).replace(/;;/g,";"));break;case"C":var fe=!1,ue=!1,q=!1,G=!1,ne=-1,ce=-1;for(E=1;E<D.length;++E)switch(D[E].charAt(0)){case"A":break;case"X":w=parseInt(D[E].slice(1))-1,ue=!0;break;case"Y":for(g=parseInt(D[E].slice(1))-1,ue||(w=0),b=y.length;b<=g;++b)y[b]=[];break;case"K":Z=D[E].slice(1),Z.charAt(0)==='"'?Z=Z.slice(1,Z.length-1):Z==="TRUE"?Z=!0:Z==="FALSE"?Z=!1:isNaN(ms(Z))?isNaN(vl(Z).getDate())||(Z=gr(Z)):(Z=ms(Z),M!==null&&Nl(M)&&(Z=o0(Z))),fe=!0;break;case"E":G=!0;var j=Zo(D[E].slice(1),{r:g,c:w});y[g][w]=[y[g][w],j];break;case"S":q=!0,y[g][w]=[y[g][w],"S5S"];break;case"G":break;case"R":ne=parseInt(D[E].slice(1))-1;break;case"C":ce=parseInt(D[E].slice(1))-1;break;default:if(p&&p.WTF)throw new Error("SYLK bad record "+P)}if(fe&&(y[g][w]&&y[g][w].length==2?y[g][w][0]=Z:y[g][w]=Z,M=null),q){if(G)throw new Error("SYLK shared formula cannot have own formula");var Y=ne>-1&&y[ne][ce];if(!Y||!Y[1])throw new Error("SYLK shared formula cannot find base");y[g][w][1]=wI(Y[1],{r:g-ne,c:w-ce})}break;case"F":var K=0;for(E=1;E<D.length;++E)switch(D[E].charAt(0)){case"X":w=parseInt(D[E].slice(1))-1,++K;break;case"Y":for(g=parseInt(D[E].slice(1))-1,b=y.length;b<=g;++b)y[b]=[];break;case"M":C=parseInt(D[E].slice(1))/20;break;case"F":break;case"G":break;case"P":M=I[parseInt(D[E].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(S=D[E].slice(1).split(" "),b=parseInt(S[0],10);b<=parseInt(S[1],10);++b)C=parseInt(S[2],10),T[b-1]=C===0?{hidden:!0}:{wch:C},yl(T[b-1]);break;case"C":w=parseInt(D[E].slice(1))-1,T[w]||(T[w]={});break;case"R":g=parseInt(D[E].slice(1))-1,v[g]||(v[g]={}),C>0?(v[g].hpt=C,v[g].hpx=xu(C)):C===0&&(v[g].hidden=!0);break;default:if(p&&p.WTF)throw new Error("SYLK bad record "+P)}K<1&&(M=null);break;default:if(p&&p.WTF)throw new Error("SYLK bad record "+P)}}return v.length>0&&(O["!rows"]=v),T.length>0&&(O["!cols"]=T),p&&p.sheetRows&&(y=y.slice(0,p.sheetRows)),[y,O]}function i(m,p){var x=s(m,p),g=x[0],w=x[1],k=bl(g,p);return Fs(w).forEach(function(E){k[E]=w[E]}),k}function o(m,p){return _i(i(m,p),p)}function l(m,p,x,g){var w="C;Y"+(x+1)+";X"+(g+1)+";K";switch(m.t){case"n":w+=m.v||0,m.f&&!m.F&&(w+=";E"+hU(m.f,{r:x,c:g}));break;case"b":w+=m.v?"TRUE":"FALSE";break;case"e":w+=m.w||m.v;break;case"d":w+='"'+(m.w||m.v)+'"';break;case"s":w+='"'+m.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return w}function c(m,p){p.forEach(function(x,g){var w="F;W"+(g+1)+" "+(g+1)+" ";x.hidden?w+="0":(typeof x.width=="number"&&!x.wpx&&(x.wpx=dd(x.width)),typeof x.wpx=="number"&&!x.wch&&(x.wch=md(x.wpx)),typeof x.wch=="number"&&(w+=Math.round(x.wch))),w.charAt(w.length-1)!=" "&&m.push(w)})}function f(m,p){p.forEach(function(x,g){var w="F;";x.hidden?w+="M0;":x.hpt?w+="M"+20*x.hpt+";":x.hpx&&(w+="M"+20*vI(x.hpx)+";"),w.length>2&&m.push(w+"R"+(g+1))})}function d(m,p){var x=["ID;PWXL;N;E"],g=[],w=$t(m["!ref"]),k,E=Array.isArray(m),y=`\r
`;x.push("P;PGeneral"),x.push("F;P0;DG0G8;M255"),m["!cols"]&&c(x,m["!cols"]),m["!rows"]&&f(x,m["!rows"]),x.push("B;Y"+(w.e.r-w.s.r+1)+";X"+(w.e.c-w.s.c+1)+";D"+[w.s.c,w.s.r,w.e.c,w.e.r].join(" "));for(var I=w.s.r;I<=w.e.r;++I)for(var M=w.s.c;M<=w.e.c;++M){var O=We({r:I,c:M});k=E?(m[I]||[])[M]:m[O],!(!k||k.v==null&&(!k.f||k.F))&&g.push(l(k,m,I,M))}return x.join(y)+y+g.join(y)+y+"E"+y}return{to_workbook:o,to_sheet:i,from_sheet:d}}(),I5=function(){function e(a,i){switch(i.type){case"base64":return t(bn(a),i);case"binary":return t(a,i);case"buffer":return t(et&&Buffer.isBuffer(a)?a.toString("binary"):co(a),i);case"array":return t(eo(a),i)}throw new Error("Unrecognized type "+i.type)}function t(a,i){for(var o=a.split(`
`),l=-1,c=-1,f=0,d=[];f!==o.length;++f){if(o[f].trim()==="BOT"){d[++l]=[],c=0;continue}if(!(l<0)){var m=o[f].trim().split(","),p=m[0],x=m[1];++f;for(var g=o[f]||"";(g.match(/["]/g)||[]).length&1&&f<o.length-1;)g+=`
`+o[++f];switch(g=g.trim(),+p){case-1:if(g==="BOT"){d[++l]=[],c=0;continue}else if(g!=="EOD")throw new Error("Unrecognized DIF special command "+g);break;case 0:g==="TRUE"?d[l][c]=!0:g==="FALSE"?d[l][c]=!1:isNaN(ms(x))?isNaN(vl(x).getDate())?d[l][c]=x:d[l][c]=gr(x):d[l][c]=ms(x),++c;break;case 1:g=g.slice(1,g.length-1),g=g.replace(/""/g,'"'),g&&g.match(/^=".*"$/)&&(g=g.slice(2,-1)),d[l][c++]=g!==""?g:null;break}if(g==="EOD")break}}return i&&i.sheetRows&&(d=d.slice(0,i.sheetRows)),d}function r(a,i){return bl(e(a,i),i)}function n(a,i){return _i(r(a,i),i)}var s=function(){var a=function(l,c,f,d,m){l.push(c),l.push(f+","+d),l.push('"'+m.replace(/"/g,'""')+'"')},i=function(l,c,f,d){l.push(c+","+f),l.push(c==1?'"'+d.replace(/"/g,'""')+'"':d)};return function(l){var c=[],f=$t(l["!ref"]),d,m=Array.isArray(l);a(c,"TABLE",0,1,"sheetjs"),a(c,"VECTORS",0,f.e.r-f.s.r+1,""),a(c,"TUPLES",0,f.e.c-f.s.c+1,""),a(c,"DATA",0,0,"");for(var p=f.s.r;p<=f.e.r;++p){i(c,-1,0,"BOT");for(var x=f.s.c;x<=f.e.c;++x){var g=We({r:p,c:x});if(d=m?(l[p]||[])[x]:l[g],!d){i(c,1,0,"");continue}switch(d.t){case"n":var w=d.w;!w&&d.v!=null&&(w=d.v),w==null?d.f&&!d.F?i(c,1,0,"="+d.f):i(c,1,0,""):i(c,0,w,"V");break;case"b":i(c,0,d.v?1:0,d.v?"TRUE":"FALSE");break;case"s":i(c,1,0,isNaN(d.v)?d.v:'="'+d.v+'"');break;case"d":d.w||(d.w=Yn(d.z||$e[14],tn(gr(d.v)))),i(c,0,d.w,"V");break;default:i(c,1,0,"")}}}i(c,-1,0,"EOD");var k=`\r
`,E=c.join(k);return E}}();return{to_workbook:n,to_sheet:r,from_sheet:s}}(),N5=function(){function e(d){return d.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function t(d){return d.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(d,m){for(var p=d.split(`
`),x=-1,g=-1,w=0,k=[];w!==p.length;++w){var E=p[w].trim().split(":");if(E[0]==="cell"){var y=Qr(E[1]);if(k.length<=y.r)for(x=k.length;x<=y.r;++x)k[x]||(k[x]=[]);switch(x=y.r,g=y.c,E[2]){case"t":k[x][g]=e(E[3]);break;case"v":k[x][g]=+E[3];break;case"vtf":var I=E[E.length-1];case"vtc":switch(E[3]){case"nl":k[x][g]=!!+E[4];break;default:k[x][g]=+E[4];break}E[2]=="vtf"&&(k[x][g]=[k[x][g],I])}}}return m&&m.sheetRows&&(k=k.slice(0,m.sheetRows)),k}function n(d,m){return bl(r(d,m),m)}function s(d,m){return _i(n(d,m),m)}var a=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),i=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,o=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),l="--SocialCalcSpreadsheetControlSave--";function c(d){if(!d||!d["!ref"])return"";for(var m=[],p=[],x,g="",w=Cl(d["!ref"]),k=Array.isArray(d),E=w.s.r;E<=w.e.r;++E)for(var y=w.s.c;y<=w.e.c;++y)if(g=We({r:E,c:y}),x=k?(d[E]||[])[y]:d[g],!(!x||x.v==null||x.t==="z")){switch(p=["cell",g,"t"],x.t){case"s":case"str":p.push(t(x.v));break;case"n":x.f?(p[2]="vtf",p[3]="n",p[4]=x.v,p[5]=t(x.f)):(p[2]="v",p[3]=x.v);break;case"b":p[2]="vt"+(x.f?"f":"c"),p[3]="nl",p[4]=x.v?"1":"0",p[5]=t(x.f||(x.v?"TRUE":"FALSE"));break;case"d":var I=tn(gr(x.v));p[2]="vtc",p[3]="nd",p[4]=""+I,p[5]=x.w||Yn(x.z||$e[14],I);break;case"e":continue}m.push(p.join(":"))}return m.push("sheet:c:"+(w.e.c-w.s.c+1)+":r:"+(w.e.r-w.s.r+1)+":tvf:1"),m.push("valueformat:1:text-wiki"),m.join(`
`)}function f(d){return[a,i,o,i,c(d),l].join(`
`)}return{to_workbook:s,to_sheet:n,from_sheet:f}}(),pu=function(){function e(f,d,m,p,x){x.raw?d[m][p]=f:f===""||(f==="TRUE"?d[m][p]=!0:f==="FALSE"?d[m][p]=!1:isNaN(ms(f))?isNaN(vl(f).getDate())?d[m][p]=f:d[m][p]=gr(f):d[m][p]=ms(f))}function t(f,d){var m=d||{},p=[];if(!f||f.length===0)return p;for(var x=f.split(/[\r\n]/),g=x.length-1;g>=0&&x[g].length===0;)--g;for(var w=10,k=0,E=0;E<=g;++E)k=x[E].indexOf(" "),k==-1?k=x[E].length:k++,w=Math.max(w,k);for(E=0;E<=g;++E){p[E]=[];var y=0;for(e(x[E].slice(0,w).trim(),p,E,y,m),y=1;y<=(x[E].length-w)/10+1;++y)e(x[E].slice(w+(y-1)*10,w+y*10).trim(),p,E,y,m)}return m.sheetRows&&(p=p.slice(0,m.sheetRows)),p}var r={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function s(f){for(var d={},m=!1,p=0,x=0;p<f.length;++p)(x=f.charCodeAt(p))==34?m=!m:!m&&x in r&&(d[x]=(d[x]||0)+1);x=[];for(p in d)Object.prototype.hasOwnProperty.call(d,p)&&x.push([d[p],p]);if(!x.length){d=n;for(p in d)Object.prototype.hasOwnProperty.call(d,p)&&x.push([d[p],p])}return x.sort(function(g,w){return g[0]-w[0]||n[g[1]]-n[w[1]]}),r[x.pop()[1]]||44}function a(f,d){var m=d||{},p="",x=m.dense?[]:{},g={s:{c:0,r:0},e:{c:0,r:0}};f.slice(0,4)=="sep="?f.charCodeAt(5)==13&&f.charCodeAt(6)==10?(p=f.charAt(4),f=f.slice(7)):f.charCodeAt(5)==13||f.charCodeAt(5)==10?(p=f.charAt(4),f=f.slice(6)):p=s(f.slice(0,1024)):m&&m.FS?p=m.FS:p=s(f.slice(0,1024));var w=0,k=0,E=0,y=0,I=0,M=p.charCodeAt(0),O=!1,v=0,T=f.charCodeAt(0);f=f.replace(/\r\n/mg,`
`);var S=m.dateNF!=null?U6(m.dateNF):null;function C(){var b=f.slice(y,I),P={};if(b.charAt(0)=='"'&&b.charAt(b.length-1)=='"'&&(b=b.slice(1,-1).replace(/""/g,'"')),b.length===0)P.t="z";else if(m.raw)P.t="s",P.v=b;else if(b.trim().length===0)P.t="s",P.v=b;else if(b.charCodeAt(0)==61)b.charCodeAt(1)==34&&b.charCodeAt(b.length-1)==34?(P.t="s",P.v=b.slice(2,-1).replace(/""/g,'"')):mU(b)?(P.t="n",P.f=b.slice(1)):(P.t="s",P.v=b);else if(b=="TRUE")P.t="b",P.v=!0;else if(b=="FALSE")P.t="b",P.v=!1;else if(!isNaN(E=ms(b)))P.t="n",m.cellText!==!1&&(P.w=b),P.v=E;else if(!isNaN(vl(b).getDate())||S&&b.match(S)){P.z=m.dateNF||$e[14];var D=0;S&&b.match(S)&&(b=V6(b,m.dateNF,b.match(S)||[]),D=1),m.cellDates?(P.t="d",P.v=gr(b,D)):(P.t="n",P.v=tn(gr(b,D))),m.cellText!==!1&&(P.w=Yn(P.z,P.v instanceof Date?tn(P.v):P.v)),m.cellNF||delete P.z}else P.t="s",P.v=b;if(P.t=="z"||(m.dense?(x[w]||(x[w]=[]),x[w][k]=P):x[We({c:k,r:w})]=P),y=I+1,T=f.charCodeAt(y),g.e.c<k&&(g.e.c=k),g.e.r<w&&(g.e.r=w),v==M)++k;else if(k=0,++w,m.sheetRows&&m.sheetRows<=w)return!0}e:for(;I<f.length;++I)switch(v=f.charCodeAt(I)){case 34:T===34&&(O=!O);break;case M:case 10:case 13:if(!O&&C())break e;break}return I-y>0&&C(),x["!ref"]=at(g),x}function i(f,d){return!(d&&d.PRN)||d.FS||f.slice(0,4)=="sep="||f.indexOf("	")>=0||f.indexOf(",")>=0||f.indexOf(";")>=0?a(f,d):bl(t(f,d),d)}function o(f,d){var m="",p=d.type=="string"?[0,0,0,0]:_v(f,d);switch(d.type){case"base64":m=bn(f);break;case"binary":m=f;break;case"buffer":d.codepage==65001?m=f.toString("utf8"):d.codepage&&typeof fu<"u"||(m=et&&Buffer.isBuffer(f)?f.toString("binary"):co(f));break;case"array":m=eo(f);break;case"string":m=f;break;default:throw new Error("Unrecognized type "+d.type)}return p[0]==239&&p[1]==187&&p[2]==191?m=Tt(m.slice(3)):d.type!="string"&&d.type!="buffer"&&d.codepage==65001?m=Tt(m):d.type=="binary"&&typeof fu<"u",m.slice(0,19)=="socialcalc:version:"?N5.to_sheet(d.type=="string"?m:Tt(m),d):i(m,d)}function l(f,d){return _i(o(f,d),d)}function c(f){for(var d=[],m=$t(f["!ref"]),p,x=Array.isArray(f),g=m.s.r;g<=m.e.r;++g){for(var w=[],k=m.s.c;k<=m.e.c;++k){var E=We({r:g,c:k});if(p=x?(f[g]||[])[k]:f[E],!p||p.v==null){w.push("          ");continue}for(var y=(p.w||(wa(p),p.w)||"").slice(0,10);y.length<10;)y+=" ";w.push(y+(k===0?" ":""))}d.push(w.join(""))}return d.join(`
`)}return{to_workbook:l,to_sheet:o,from_sheet:c}}();function C5(e,t){var r=t||{},n=!!r.WTF;r.WTF=!0;try{var s=A5.to_workbook(e,r);return r.WTF=n,s}catch(a){if(r.WTF=n,!a.message.match(/SYLK bad record ID/)&&n)throw a;return pu.to_workbook(e,t)}}var Rc=function(){function e(j,Y,K){if(j){wr(j,j.l||0);for(var V=K.Enum||ne;j.l<j.length;){var J=j.read_shift(2),de=V[J]||V[65535],Ee=j.read_shift(2),_e=j.l+Ee,pe=de.f&&de.f(j,Ee,K);if(j.l=_e,Y(pe,de,J))return}}}function t(j,Y){switch(Y.type){case"base64":return r(os(bn(j)),Y);case"binary":return r(os(j),Y);case"buffer":case"array":return r(j,Y)}throw"Unsupported type "+Y.type}function r(j,Y){if(!j)return j;var K=Y||{},V=K.dense?[]:{},J="Sheet1",de="",Ee=0,_e={},pe=[],Ue=[],H={s:{r:0,c:0},e:{r:0,c:0}},tt=K.sheetRows||0;if(j[2]==0&&(j[3]==8||j[3]==9)&&j.length>=16&&j[14]==5&&j[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(j[2]==2)K.Enum=ne,e(j,function(Ae,_t,ur){switch(ur){case 0:K.vers=Ae,Ae>=4096&&(K.qpro=!0);break;case 6:H=Ae;break;case 204:Ae&&(de=Ae);break;case 222:de=Ae;break;case 15:case 51:K.qpro||(Ae[1].v=Ae[1].v.slice(1));case 13:case 14:case 16:ur==14&&(Ae[2]&112)==112&&(Ae[2]&15)>1&&(Ae[2]&15)<15&&(Ae[1].z=K.dateNF||$e[14],K.cellDates&&(Ae[1].t="d",Ae[1].v=o0(Ae[1].v))),K.qpro&&Ae[3]>Ee&&(V["!ref"]=at(H),_e[J]=V,pe.push(J),V=K.dense?[]:{},H={s:{r:0,c:0},e:{r:0,c:0}},Ee=Ae[3],J=de||"Sheet"+(Ee+1),de="");var Cr=K.dense?(V[Ae[0].r]||[])[Ae[0].c]:V[We(Ae[0])];if(Cr){Cr.t=Ae[1].t,Cr.v=Ae[1].v,Ae[1].z!=null&&(Cr.z=Ae[1].z),Ae[1].f!=null&&(Cr.f=Ae[1].f);break}K.dense?(V[Ae[0].r]||(V[Ae[0].r]=[]),V[Ae[0].r][Ae[0].c]=Ae[1]):V[We(Ae[0])]=Ae[1];break}},K);else if(j[2]==26||j[2]==14)K.Enum=ce,j[2]==14&&(K.qpro=!0,j.l=0),e(j,function(Ae,_t,ur){switch(ur){case 204:J=Ae;break;case 22:Ae[1].v=Ae[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(Ae[3]>Ee&&(V["!ref"]=at(H),_e[J]=V,pe.push(J),V=K.dense?[]:{},H={s:{r:0,c:0},e:{r:0,c:0}},Ee=Ae[3],J="Sheet"+(Ee+1)),tt>0&&Ae[0].r>=tt)break;K.dense?(V[Ae[0].r]||(V[Ae[0].r]=[]),V[Ae[0].r][Ae[0].c]=Ae[1]):V[We(Ae[0])]=Ae[1],H.e.c<Ae[0].c&&(H.e.c=Ae[0].c),H.e.r<Ae[0].r&&(H.e.r=Ae[0].r);break;case 27:Ae[14e3]&&(Ue[Ae[14e3][0]]=Ae[14e3][1]);break;case 1537:Ue[Ae[0]]=Ae[1],Ae[0]==Ee&&(J=Ae[1]);break}},K);else throw new Error("Unrecognized LOTUS BOF "+j[2]);if(V["!ref"]=at(H),_e[de||J]=V,pe.push(de||J),!Ue.length)return{SheetNames:pe,Sheets:_e};for(var He={},Je=[],De=0;De<Ue.length;++De)_e[pe[De]]?(Je.push(Ue[De]||pe[De]),He[Ue[De]]=_e[Ue[De]]||_e[pe[De]]):(Je.push(Ue[De]),He[Ue[De]]={"!ref":"A1"});return{SheetNames:Je,Sheets:He}}function n(j,Y){var K=Y||{};if(+K.codepage>=0&&cs(+K.codepage),K.type=="string")throw new Error("Cannot write WK1 to JS string");var V=Up(),J=$t(j["!ref"]),de=Array.isArray(j),Ee=[];ts(V,0,a(1030)),ts(V,6,l(J));for(var _e=Math.min(J.e.r,8191),pe=J.s.r;pe<=_e;++pe)for(var Ue=Ar(pe),H=J.s.c;H<=J.e.c;++H){pe===J.s.r&&(Ee[H]=or(H));var tt=Ee[H]+Ue,He=de?(j[pe]||[])[H]:j[tt];if(!(!He||He.t=="z"))if(He.t=="n")(He.v|0)==He.v&&He.v>=-32768&&He.v<=32767?ts(V,13,p(pe,H,He.v)):ts(V,14,g(pe,H,He.v));else{var Je=wa(He);ts(V,15,d(pe,H,Je.slice(0,239)))}}return ts(V,1),V.end()}function s(j,Y){var K=Y||{};if(+K.codepage>=0&&cs(+K.codepage),K.type=="string")throw new Error("Cannot write WK3 to JS string");var V=Up();ts(V,0,i(j));for(var J=0,de=0;J<j.SheetNames.length;++J)(j.Sheets[j.SheetNames[J]]||{})["!ref"]&&ts(V,27,G(j.SheetNames[J],de++));var Ee=0;for(J=0;J<j.SheetNames.length;++J){var _e=j.Sheets[j.SheetNames[J]];if(!(!_e||!_e["!ref"])){for(var pe=$t(_e["!ref"]),Ue=Array.isArray(_e),H=[],tt=Math.min(pe.e.r,8191),He=pe.s.r;He<=tt;++He)for(var Je=Ar(He),De=pe.s.c;De<=pe.e.c;++De){He===pe.s.r&&(H[De]=or(De));var Ae=H[De]+Je,_t=Ue?(_e[He]||[])[De]:_e[Ae];if(!(!_t||_t.t=="z"))if(_t.t=="n")ts(V,23,C(He,De,Ee,_t.v));else{var ur=wa(_t);ts(V,22,v(He,De,Ee,ur.slice(0,239)))}}++Ee}}return ts(V,1),V.end()}function a(j){var Y=sr(2);return Y.write_shift(2,j),Y}function i(j){var Y=sr(26);Y.write_shift(2,4096),Y.write_shift(2,4),Y.write_shift(4,0);for(var K=0,V=0,J=0,de=0;de<j.SheetNames.length;++de){var Ee=j.SheetNames[de],_e=j.Sheets[Ee];if(!(!_e||!_e["!ref"])){++J;var pe=Cl(_e["!ref"]);K<pe.e.r&&(K=pe.e.r),V<pe.e.c&&(V=pe.e.c)}}return K>8191&&(K=8191),Y.write_shift(2,K),Y.write_shift(1,J),Y.write_shift(1,V),Y.write_shift(2,0),Y.write_shift(2,0),Y.write_shift(1,1),Y.write_shift(1,2),Y.write_shift(4,0),Y.write_shift(4,0),Y}function o(j,Y,K){var V={s:{c:0,r:0},e:{c:0,r:0}};return Y==8&&K.qpro?(V.s.c=j.read_shift(1),j.l++,V.s.r=j.read_shift(2),V.e.c=j.read_shift(1),j.l++,V.e.r=j.read_shift(2),V):(V.s.c=j.read_shift(2),V.s.r=j.read_shift(2),Y==12&&K.qpro&&(j.l+=2),V.e.c=j.read_shift(2),V.e.r=j.read_shift(2),Y==12&&K.qpro&&(j.l+=2),V.s.c==65535&&(V.s.c=V.e.c=V.s.r=V.e.r=0),V)}function l(j){var Y=sr(8);return Y.write_shift(2,j.s.c),Y.write_shift(2,j.s.r),Y.write_shift(2,j.e.c),Y.write_shift(2,j.e.r),Y}function c(j,Y,K){var V=[{c:0,r:0},{t:"n",v:0},0,0];return K.qpro&&K.vers!=20768?(V[0].c=j.read_shift(1),V[3]=j.read_shift(1),V[0].r=j.read_shift(2),j.l+=2):(V[2]=j.read_shift(1),V[0].c=j.read_shift(2),V[0].r=j.read_shift(2)),V}function f(j,Y,K){var V=j.l+Y,J=c(j,Y,K);if(J[1].t="s",K.vers==20768){j.l++;var de=j.read_shift(1);return J[1].v=j.read_shift(de,"utf8"),J}return K.qpro&&j.l++,J[1].v=j.read_shift(V-j.l,"cstr"),J}function d(j,Y,K){var V=sr(7+K.length);V.write_shift(1,255),V.write_shift(2,Y),V.write_shift(2,j),V.write_shift(1,39);for(var J=0;J<V.length;++J){var de=K.charCodeAt(J);V.write_shift(1,de>=128?95:de)}return V.write_shift(1,0),V}function m(j,Y,K){var V=c(j,Y,K);return V[1].v=j.read_shift(2,"i"),V}function p(j,Y,K){var V=sr(7);return V.write_shift(1,255),V.write_shift(2,Y),V.write_shift(2,j),V.write_shift(2,K,"i"),V}function x(j,Y,K){var V=c(j,Y,K);return V[1].v=j.read_shift(8,"f"),V}function g(j,Y,K){var V=sr(13);return V.write_shift(1,255),V.write_shift(2,Y),V.write_shift(2,j),V.write_shift(8,K,"f"),V}function w(j,Y,K){var V=j.l+Y,J=c(j,Y,K);if(J[1].v=j.read_shift(8,"f"),K.qpro)j.l=V;else{var de=j.read_shift(2);I(j.slice(j.l,j.l+de),J),j.l+=de}return J}function k(j,Y,K){var V=Y&32768;return Y&=-32769,Y=(V?j:0)+(Y>=8192?Y-16384:Y),(V?"":"$")+(K?or(Y):Ar(Y))}var E={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},y=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function I(j,Y){wr(j,0);for(var K=[],V=0,J="",de="",Ee="",_e="";j.l<j.length;){var pe=j[j.l++];switch(pe){case 0:K.push(j.read_shift(8,"f"));break;case 1:de=k(Y[0].c,j.read_shift(2),!0),J=k(Y[0].r,j.read_shift(2),!1),K.push(de+J);break;case 2:{var Ue=k(Y[0].c,j.read_shift(2),!0),H=k(Y[0].r,j.read_shift(2),!1);de=k(Y[0].c,j.read_shift(2),!0),J=k(Y[0].r,j.read_shift(2),!1),K.push(Ue+H+":"+de+J)}break;case 3:if(j.l<j.length){console.error("WK1 premature formula end");return}break;case 4:K.push("("+K.pop()+")");break;case 5:K.push(j.read_shift(2));break;case 6:{for(var tt="";pe=j[j.l++];)tt+=String.fromCharCode(pe);K.push('"'+tt.replace(/"/g,'""')+'"')}break;case 8:K.push("-"+K.pop());break;case 23:K.push("+"+K.pop());break;case 22:K.push("NOT("+K.pop()+")");break;case 20:case 21:_e=K.pop(),Ee=K.pop(),K.push(["AND","OR"][pe-20]+"("+Ee+","+_e+")");break;default:if(pe<32&&y[pe])_e=K.pop(),Ee=K.pop(),K.push(Ee+y[pe]+_e);else if(E[pe]){if(V=E[pe][1],V==69&&(V=j[j.l++]),V>K.length){console.error("WK1 bad formula parse 0x"+pe.toString(16)+":|"+K.join("|")+"|");return}var He=K.slice(-V);K.length-=V,K.push(E[pe][0]+"("+He.join(",")+")")}else return pe<=7?console.error("WK1 invalid opcode "+pe.toString(16)):pe<=24?console.error("WK1 unsupported op "+pe.toString(16)):pe<=30?console.error("WK1 invalid opcode "+pe.toString(16)):pe<=115?console.error("WK1 unsupported function opcode "+pe.toString(16)):console.error("WK1 unrecognized opcode "+pe.toString(16))}}K.length==1?Y[1].f=""+K[0]:console.error("WK1 bad formula parse |"+K.join("|")+"|")}function M(j){var Y=[{c:0,r:0},{t:"n",v:0},0];return Y[0].r=j.read_shift(2),Y[3]=j[j.l++],Y[0].c=j[j.l++],Y}function O(j,Y){var K=M(j);return K[1].t="s",K[1].v=j.read_shift(Y-4,"cstr"),K}function v(j,Y,K,V){var J=sr(6+V.length);J.write_shift(2,j),J.write_shift(1,K),J.write_shift(1,Y),J.write_shift(1,39);for(var de=0;de<V.length;++de){var Ee=V.charCodeAt(de);J.write_shift(1,Ee>=128?95:Ee)}return J.write_shift(1,0),J}function T(j,Y){var K=M(j);K[1].v=j.read_shift(2);var V=K[1].v>>1;if(K[1].v&1)switch(V&7){case 0:V=(V>>3)*5e3;break;case 1:V=(V>>3)*500;break;case 2:V=(V>>3)/20;break;case 3:V=(V>>3)/200;break;case 4:V=(V>>3)/2e3;break;case 5:V=(V>>3)/2e4;break;case 6:V=(V>>3)/16;break;case 7:V=(V>>3)/64;break}return K[1].v=V,K}function S(j,Y){var K=M(j),V=j.read_shift(4),J=j.read_shift(4),de=j.read_shift(2);if(de==65535)return V===0&&J===3221225472?(K[1].t="e",K[1].v=15):V===0&&J===3489660928?(K[1].t="e",K[1].v=42):K[1].v=0,K;var Ee=de&32768;return de=(de&32767)-16446,K[1].v=(1-Ee*2)*(J*Math.pow(2,de+32)+V*Math.pow(2,de)),K}function C(j,Y,K,V){var J=sr(14);if(J.write_shift(2,j),J.write_shift(1,K),J.write_shift(1,Y),V==0)return J.write_shift(4,0),J.write_shift(4,0),J.write_shift(2,65535),J;var de=0,Ee=0,_e=0,pe=0;return V<0&&(de=1,V=-V),Ee=Math.log2(V)|0,V/=Math.pow(2,Ee-31),pe=V>>>0,pe&2147483648||(V/=2,++Ee,pe=V>>>0),V-=pe,pe|=2147483648,pe>>>=0,V*=Math.pow(2,32),_e=V>>>0,J.write_shift(4,_e),J.write_shift(4,pe),Ee+=16383+(de?32768:0),J.write_shift(2,Ee),J}function b(j,Y){var K=S(j);return j.l+=Y-14,K}function P(j,Y){var K=M(j),V=j.read_shift(4);return K[1].v=V>>6,K}function D(j,Y){var K=M(j),V=j.read_shift(8,"f");return K[1].v=V,K}function ie(j,Y){var K=D(j);return j.l+=Y-10,K}function Z(j,Y){return j[j.l+Y-1]==0?j.read_shift(Y,"cstr"):""}function fe(j,Y){var K=j[j.l++];K>Y-1&&(K=Y-1);for(var V="";V.length<K;)V+=String.fromCharCode(j[j.l++]);return V}function ue(j,Y,K){if(!(!K.qpro||Y<21)){var V=j.read_shift(1);j.l+=17,j.l+=1,j.l+=2;var J=j.read_shift(Y-21,"cstr");return[V,J]}}function q(j,Y){for(var K={},V=j.l+Y;j.l<V;){var J=j.read_shift(2);if(J==14e3){for(K[J]=[0,""],K[J][0]=j.read_shift(2);j[j.l];)K[J][1]+=String.fromCharCode(j[j.l]),j.l++;j.l++}}return K}function G(j,Y){var K=sr(5+j.length);K.write_shift(2,14e3),K.write_shift(2,Y);for(var V=0;V<j.length;++V){var J=j.charCodeAt(V);K[K.l++]=J>127?95:J}return K[K.l++]=0,K}var ne={0:{n:"BOF",f:Zt},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:o},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:m},14:{n:"NUMBER",f:x},15:{n:"LABEL",f},16:{n:"FORMULA",f:w},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:Z},222:{n:"SHEETNAMELP",f:fe},65535:{n:""}},ce={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:O},23:{n:"NUMBER17",f:S},24:{n:"NUMBER18",f:T},25:{n:"FORMULA19",f:b},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:q},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:P},38:{n:"??"},39:{n:"NUMBER27",f:D},40:{n:"FORMULA28",f:ie},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:Z},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:ue},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:n,book_to_wk3:s,to_workbook:t}}();function b5(e){var t={},r=e.match(Kr),n=0,s=!1;if(r)for(;n!=r.length;++n){var a=Oe(r[n]);switch(a[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!a.val)break;case"<shadow>":case"<shadow/>":t.shadow=1;break;case"</shadow>":break;case"<charset":if(a.val=="1")break;t.cp=Xx[parseInt(a.val,10)];break;case"<outline":if(!a.val)break;case"<outline>":case"<outline/>":t.outline=1;break;case"</outline>":break;case"<rFont":t.name=a.val;break;case"<sz":t.sz=a.val;break;case"<strike":if(!a.val)break;case"<strike>":case"<strike/>":t.strike=1;break;case"</strike>":break;case"<u":if(!a.val)break;switch(a.val){case"double":t.uval="double";break;case"singleAccounting":t.uval="single-accounting";break;case"doubleAccounting":t.uval="double-accounting";break}case"<u>":case"<u/>":t.u=1;break;case"</u>":break;case"<b":if(a.val=="0")break;case"<b>":case"<b/>":t.b=1;break;case"</b>":break;case"<i":if(a.val=="0")break;case"<i>":case"<i/>":t.i=1;break;case"</i>":break;case"<color":a.rgb&&(t.color=a.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":t.family=a.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":t.valign=a.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(a[0].charCodeAt(1)!==47&&!s)throw new Error("Unrecognized rich format "+a[0])}}return t}var R5=function(){var e=du("t"),t=du("rPr");function r(a){var i=a.match(e);if(!i)return{t:"s",v:""};var o={t:"s",v:lt(i[1])},l=a.match(t);return l&&(o.s=b5(l[1])),o}var n=/<(?:\w+:)?r>/g,s=/<\/(?:\w+:)?r>/;return function(i){return i.replace(n,"").split(s).map(r).filter(function(o){return o.v})}}(),P5=function(){var t=/(\r\n|\n)/g;function r(s,a,i){var o=[];s.u&&o.push("text-decoration: underline;"),s.uval&&o.push("text-underline-style:"+s.uval+";"),s.sz&&o.push("font-size:"+s.sz+"pt;"),s.outline&&o.push("text-effect: outline;"),s.shadow&&o.push("text-shadow: auto;"),a.push('<span style="'+o.join("")+'">'),s.b&&(a.push("<b>"),i.push("</b>")),s.i&&(a.push("<i>"),i.push("</i>")),s.strike&&(a.push("<s>"),i.push("</s>"));var l=s.valign||"";return l=="superscript"||l=="super"?l="sup":l=="subscript"&&(l="sub"),l!=""&&(a.push("<"+l+">"),i.push("</"+l+">")),i.push("</span>"),s}function n(s){var a=[[],s.v,[]];return s.v?(s.s&&r(s.s,a[0],a[2]),a[0].join("")+a[1].replace(t,"<br/>")+a[2].join("")):""}return function(a){return a.map(n).join("")}}(),D5=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,F5=/<(?:\w+:)?r>/,O5=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function dv(e,t){var r=t?t.cellHTML:!0,n={};return e?(e.match(/^\s*<(?:\w+:)?t[^>]*>/)?(n.t=lt(Tt(e.slice(e.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),n.r=Tt(e),r&&(n.h=nv(n.t))):e.match(F5)&&(n.r=Tt(e),n.t=lt(Tt((e.replace(O5,"").match(D5)||[]).join("").replace(Kr,""))),r&&(n.h=P5(R5(n.r)))),n):{t:""}}var M5=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,L5=/<(?:\w+:)?(?:si|sstItem)>/g,j5=/<\/(?:\w+:)?(?:si|sstItem)>/;function U5(e,t){var r=[],n="";if(!e)return r;var s=e.match(M5);if(s){n=s[2].replace(L5,"").split(j5);for(var a=0;a!=n.length;++a){var i=dv(n[a].trim(),t);i!=null&&(r[r.length]=i)}s=Oe(s[1]),r.Count=s.count,r.Unique=s.uniqueCount}return r}function V5(e){return[e.read_shift(4),e.read_shift(4)]}function B5(e,t){var r=[],n=!1;return ka(e,function(a,i,o){switch(o){case 159:r.Count=a[0],r.Unique=a[1];break;case 19:r.push(a);break;case 160:return!0;case 35:n=!0;break;case 36:n=!1;break;default:if(i.T,!n||t.WTF)throw new Error("Unexpected record 0x"+o.toString(16))}}),r}function hI(e){for(var t=[],r=e.split(""),n=0;n<r.length;++n)t[n]=r[n].charCodeAt(0);return t}function ca(e,t){var r={};return r.Major=e.read_shift(2),r.Minor=e.read_shift(2),t>=4&&(e.l+=t-4),r}function W5(e){var t={};return t.id=e.read_shift(0,"lpp4"),t.R=ca(e,4),t.U=ca(e,4),t.W=ca(e,4),t}function z5(e){for(var t=e.read_shift(4),r=e.l+t-4,n={},s=e.read_shift(4),a=[];s-- >0;)a.push({t:e.read_shift(4),v:e.read_shift(0,"lpp4")});if(n.name=e.read_shift(0,"lpp4"),n.comps=a,e.l!=r)throw new Error("Bad DataSpaceMapEntry: "+e.l+" != "+r);return n}function $5(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(z5(e));return t}function H5(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(e.read_shift(0,"lpp4"));return t}function G5(e){var t={};return e.read_shift(4),e.l+=4,t.id=e.read_shift(0,"lpp4"),t.name=e.read_shift(0,"lpp4"),t.R=ca(e,4),t.U=ca(e,4),t.W=ca(e,4),t}function K5(e){var t=G5(e);if(t.ename=e.read_shift(0,"8lpp4"),t.blksz=e.read_shift(4),t.cmode=e.read_shift(4),e.read_shift(4)!=4)throw new Error("Bad !Primary record");return t}function dI(e,t){var r=e.l+t,n={};n.Flags=e.read_shift(4)&63,e.l+=4,n.AlgID=e.read_shift(4);var s=!1;switch(n.AlgID){case 26126:case 26127:case 26128:s=n.Flags==36;break;case 26625:s=n.Flags==4;break;case 0:s=n.Flags==16||n.Flags==4||n.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+n.AlgID}if(!s)throw new Error("Encryption Flags/AlgID mismatch");return n.AlgIDHash=e.read_shift(4),n.KeySize=e.read_shift(4),n.ProviderType=e.read_shift(4),e.l+=8,n.CSPName=e.read_shift(r-e.l>>1,"utf16le"),e.l=r,n}function mI(e,t){var r={},n=e.l+t;return e.l+=4,r.Salt=e.slice(e.l,e.l+16),e.l+=16,r.Verifier=e.slice(e.l,e.l+16),e.l+=16,e.read_shift(4),r.VerifierHash=e.slice(e.l,n),e.l=n,r}function q5(e){var t=ca(e);switch(t.Minor){case 2:return[t.Minor,Y5(e)];case 3:return[t.Minor,X5()];case 4:return[t.Minor,Q5(e)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+t.Minor)}function Y5(e){var t=e.read_shift(4);if((t&63)!=36)throw new Error("EncryptionInfo mismatch");var r=e.read_shift(4),n=dI(e,r),s=mI(e,e.length-e.l);return{t:"Std",h:n,v:s}}function X5(){throw new Error("File is password-protected: ECMA-376 Extensible")}function Q5(e){var t=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];e.l+=4;var r=e.read_shift(e.length-e.l,"utf8"),n={};return r.replace(Kr,function(a){var i=Oe(a);switch(Vs(i[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":t.forEach(function(o){n[o]=i[o]});break;case"<dataIntegrity":n.encryptedHmacKey=i.encryptedHmacKey,n.encryptedHmacValue=i.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":n.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":n.uri=i.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":n.encs.push(i);break;default:throw i[0]}}),n}function J5(e,t){var r={},n=r.EncryptionVersionInfo=ca(e,4);if(t-=4,n.Minor!=2)throw new Error("unrecognized minor version code: "+n.Minor);if(n.Major>4||n.Major<2)throw new Error("unrecognized major version code: "+n.Major);r.Flags=e.read_shift(4),t-=4;var s=e.read_shift(4);return t-=4,r.EncryptionHeader=dI(e,s),t-=s,r.EncryptionVerifier=mI(e,t),r}function Z5(e){var t={},r=t.EncryptionVersionInfo=ca(e,4);if(r.Major!=1||r.Minor!=1)throw"unrecognized version code "+r.Major+" : "+r.Minor;return t.Salt=e.read_shift(16),t.EncryptedVerifier=e.read_shift(16),t.EncryptedVerifierHash=e.read_shift(16),t}function e9(e){var t=0,r,n=hI(e),s=n.length+1,a,i,o,l,c;for(r=di(s),r[0]=n.length,a=1;a!=s;++a)r[a]=n[a-1];for(a=s-1;a>=0;--a)i=r[a],o=t&16384?1:0,l=t<<1&32767,c=o|l,t=c^i;return t^52811}var pI=function(){var e=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],t=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],r=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],n=function(i){return(i/2|i*128)&255},s=function(i,o){return n(i^o)},a=function(i){for(var o=t[i.length-1],l=104,c=i.length-1;c>=0;--c)for(var f=i[c],d=0;d!=7;++d)f&64&&(o^=r[l]),f*=2,--l;return o};return function(i){for(var o=hI(i),l=a(o),c=o.length,f=di(16),d=0;d!=16;++d)f[d]=0;var m,p,x;for((c&1)===1&&(m=l>>8,f[c]=s(e[0],m),--c,m=l&255,p=o[o.length-1],f[c]=s(p,m));c>0;)--c,m=l>>8,f[c]=s(o[c],m),--c,m=l&255,f[c]=s(o[c],m);for(c=15,x=15-o.length;x>0;)m=l>>8,f[c]=s(e[x],m),--c,--x,m=l&255,f[c]=s(o[c],m),--c,--x;return f}}(),t9=function(e,t,r,n,s){s||(s=t),n||(n=pI(e));var a,i;for(a=0;a!=t.length;++a)i=t[a],i^=n[r],i=(i>>5|i<<3)&255,s[a]=i,++r;return[s,r,n]},r9=function(e){var t=0,r=pI(e);return function(n){var s=t9("",n,t,r);return t=s[1],s[0]}};function n9(e,t,r,n){var s={key:Zt(e),verificationBytes:Zt(e)};return r.password&&(s.verifier=e9(r.password)),n.valid=s.verificationBytes===s.verifier,n.valid&&(n.insitu=r9(r.password)),s}function s9(e,t,r){var n=r||{};return n.Info=e.read_shift(2),e.l-=2,n.Info===1?n.Data=Z5(e):n.Data=J5(e,t),n}function a9(e,t,r){var n={Type:r.biff>=8?e.read_shift(2):0};return n.Type?s9(e,t-2,n):n9(e,r.biff>=8?t:t-2,r,n),n}var i9=function(){function e(s,a){switch(a.type){case"base64":return t(bn(s),a);case"binary":return t(s,a);case"buffer":return t(et&&Buffer.isBuffer(s)?s.toString("binary"):co(s),a);case"array":return t(eo(s),a)}throw new Error("Unrecognized type "+a.type)}function t(s,a){var i=a||{},o=i.dense?[]:{},l=s.match(/\\trowd.*?\\row\b/g);if(!l.length)throw new Error("RTF missing table");var c={s:{c:0,r:0},e:{c:0,r:l.length-1}};return l.forEach(function(f,d){Array.isArray(o)&&(o[d]=[]);for(var m=/\\\w+\b/g,p=0,x,g=-1;x=m.exec(f);){switch(x[0]){case"\\cell":var w=f.slice(p,m.lastIndex-x[0].length);if(w[0]==" "&&(w=w.slice(1)),++g,w.length){var k={v:w,t:"s"};Array.isArray(o)?o[d][g]=k:o[We({r:d,c:g})]=k}break}p=m.lastIndex}g>c.e.c&&(c.e.c=g)}),o["!ref"]=at(c),o}function r(s,a){return _i(e(s,a),a)}function n(s){for(var a=["{\\rtf1\\ansi"],i=$t(s["!ref"]),o,l=Array.isArray(s),c=i.s.r;c<=i.e.r;++c){a.push("\\trowd\\trautofit1");for(var f=i.s.c;f<=i.e.c;++f)a.push("\\cellx"+(f+1));for(a.push("\\pard\\intbl"),f=i.s.c;f<=i.e.c;++f){var d=We({r:c,c:f});o=l?(s[c]||[])[f]:s[d],!(!o||o.v==null&&(!o.f||o.F))&&(a.push(" "+(o.w||(wa(o),o.w))),a.push("\\cell"))}a.push("\\pard\\intbl\\row")}return a.join("")+"}"}return{to_workbook:r,to_sheet:e,from_sheet:n}}();function o9(e){var t=e.slice(e[0]==="#"?1:0).slice(0,6);return[parseInt(t.slice(0,2),16),parseInt(t.slice(2,4),16),parseInt(t.slice(4,6),16)]}function gu(e){for(var t=0,r=1;t!=3;++t)r=r*256+(e[t]>255?255:e[t]<0?0:e[t]);return r.toString(16).toUpperCase().slice(1)}function l9(e){var t=e[0]/255,r=e[1]/255,n=e[2]/255,s=Math.max(t,r,n),a=Math.min(t,r,n),i=s-a;if(i===0)return[0,0,t];var o=0,l=0,c=s+a;switch(l=i/(c>1?2-c:c),s){case t:o=((r-n)/i+6)%6;break;case r:o=(n-t)/i+2;break;case n:o=(t-r)/i+4;break}return[o/6,l,c/2]}function c9(e){var t=e[0],r=e[1],n=e[2],s=r*2*(n<.5?n:1-n),a=n-s/2,i=[a,a,a],o=6*t,l;if(r!==0)switch(o|0){case 0:case 6:l=s*o,i[0]+=s,i[1]+=l;break;case 1:l=s*(2-o),i[0]+=l,i[1]+=s;break;case 2:l=s*(o-2),i[1]+=s,i[2]+=l;break;case 3:l=s*(4-o),i[1]+=l,i[2]+=s;break;case 4:l=s*(o-4),i[2]+=s,i[0]+=l;break;case 5:l=s*(6-o),i[2]+=l,i[0]+=s;break}for(var c=0;c!=3;++c)i[c]=Math.round(i[c]*255);return i}function hd(e,t){if(t===0)return e;var r=l9(o9(e));return t<0?r[2]=r[2]*(1+t):r[2]=1-(1-r[2])*(1-t),gu(c9(r))}var gI=6,u9=15,f9=1,Xr=gI;function dd(e){return Math.floor((e+Math.round(128/Xr)/256)*Xr)}function md(e){return Math.floor((e-5)/Xr*100+.5)/100}function zp(e){return Math.round((e*Xr+5)/Xr*256)/256}function om(e){return zp(md(dd(e)))}function mv(e){var t=Math.abs(e-om(e)),r=Xr;if(t>.005)for(Xr=f9;Xr<u9;++Xr)Math.abs(e-om(e))<=t&&(t=Math.abs(e-om(e)),r=Xr);Xr=r}function yl(e){e.width?(e.wpx=dd(e.width),e.wch=md(e.wpx),e.MDW=Xr):e.wpx?(e.wch=md(e.wpx),e.width=zp(e.wch),e.MDW=Xr):typeof e.wch=="number"&&(e.width=zp(e.wch),e.wpx=dd(e.width),e.MDW=Xr),e.customWidth&&delete e.customWidth}var h9=96,xI=h9;function vI(e){return e*96/xI}function xu(e){return e*xI/96}var d9={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function m9(e,t,r,n){t.Borders=[];var s={},a=!1;(e[0].match(Kr)||[]).forEach(function(i){var o=Oe(i);switch(Vs(o[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":s={},o.diagonalUp&&(s.diagonalUp=Pt(o.diagonalUp)),o.diagonalDown&&(s.diagonalDown=Pt(o.diagonalDown)),t.Borders.push(s);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(n&&n.WTF&&!a)throw new Error("unrecognized "+o[0]+" in borders")}})}function p9(e,t,r,n){t.Fills=[];var s={},a=!1;(e[0].match(Kr)||[]).forEach(function(i){var o=Oe(i);switch(Vs(o[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":s={},t.Fills.push(s);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":t.Fills.push(s),s={};break;case"<patternFill":case"<patternFill>":o.patternType&&(s.patternType=o.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":s.bgColor||(s.bgColor={}),o.indexed&&(s.bgColor.indexed=parseInt(o.indexed,10)),o.theme&&(s.bgColor.theme=parseInt(o.theme,10)),o.tint&&(s.bgColor.tint=parseFloat(o.tint)),o.rgb&&(s.bgColor.rgb=o.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":s.fgColor||(s.fgColor={}),o.theme&&(s.fgColor.theme=parseInt(o.theme,10)),o.tint&&(s.fgColor.tint=parseFloat(o.tint)),o.rgb!=null&&(s.fgColor.rgb=o.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(n&&n.WTF&&!a)throw new Error("unrecognized "+o[0]+" in fills")}})}function g9(e,t,r,n){t.Fonts=[];var s={},a=!1;(e[0].match(Kr)||[]).forEach(function(i){var o=Oe(i);switch(Vs(o[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":t.Fonts.push(s),s={};break;case"<name":o.val&&(s.name=Tt(o.val));break;case"<name/>":case"</name>":break;case"<b":s.bold=o.val?Pt(o.val):1;break;case"<b/>":s.bold=1;break;case"<i":s.italic=o.val?Pt(o.val):1;break;case"<i/>":s.italic=1;break;case"<u":switch(o.val){case"none":s.underline=0;break;case"single":s.underline=1;break;case"double":s.underline=2;break;case"singleAccounting":s.underline=33;break;case"doubleAccounting":s.underline=34;break}break;case"<u/>":s.underline=1;break;case"<strike":s.strike=o.val?Pt(o.val):1;break;case"<strike/>":s.strike=1;break;case"<outline":s.outline=o.val?Pt(o.val):1;break;case"<outline/>":s.outline=1;break;case"<shadow":s.shadow=o.val?Pt(o.val):1;break;case"<shadow/>":s.shadow=1;break;case"<condense":s.condense=o.val?Pt(o.val):1;break;case"<condense/>":s.condense=1;break;case"<extend":s.extend=o.val?Pt(o.val):1;break;case"<extend/>":s.extend=1;break;case"<sz":o.val&&(s.sz=+o.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":o.val&&(s.vertAlign=o.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":o.val&&(s.family=parseInt(o.val,10));break;case"<family/>":case"</family>":break;case"<scheme":o.val&&(s.scheme=o.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(o.val=="1")break;o.codepage=Xx[parseInt(o.val,10)];break;case"<color":if(s.color||(s.color={}),o.auto&&(s.color.auto=Pt(o.auto)),o.rgb)s.color.rgb=o.rgb.slice(-6);else if(o.indexed){s.color.index=parseInt(o.indexed,10);var l=Wi[s.color.index];s.color.index==81&&(l=Wi[1]),l||(l=Wi[1]),s.color.rgb=l[0].toString(16)+l[1].toString(16)+l[2].toString(16)}else o.theme&&(s.color.theme=parseInt(o.theme,10),o.tint&&(s.color.tint=parseFloat(o.tint)),o.theme&&r.themeElements&&r.themeElements.clrScheme&&(s.color.rgb=hd(r.themeElements.clrScheme[s.color.theme].rgb,s.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":a=!0;break;case"</AlternateContent>":a=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(n&&n.WTF&&!a)throw new Error("unrecognized "+o[0]+" in fonts")}})}function x9(e,t,r){t.NumberFmt=[];for(var n=Fs($e),s=0;s<n.length;++s)t.NumberFmt[n[s]]=$e[n[s]];var a=e[0].match(Kr);if(a)for(s=0;s<a.length;++s){var i=Oe(a[s]);switch(Vs(i[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var o=lt(Tt(i.formatCode)),l=parseInt(i.numFmtId,10);if(t.NumberFmt[l]=o,l>0){if(l>392){for(l=392;l>60&&t.NumberFmt[l]!=null;--l);t.NumberFmt[l]=o}Bi(o,l)}}break;case"</numFmt>":break;default:if(r.WTF)throw new Error("unrecognized "+i[0]+" in numFmts")}}}var Vf=["numFmtId","fillId","fontId","borderId","xfId"],Bf=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function v9(e,t,r){t.CellXf=[];var n,s=!1;(e[0].match(Kr)||[]).forEach(function(a){var i=Oe(a),o=0;switch(Vs(i[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(n=i,delete n[0],o=0;o<Vf.length;++o)n[Vf[o]]&&(n[Vf[o]]=parseInt(n[Vf[o]],10));for(o=0;o<Bf.length;++o)n[Bf[o]]&&(n[Bf[o]]=Pt(n[Bf[o]]));if(t.NumberFmt&&n.numFmtId>392){for(o=392;o>60;--o)if(t.NumberFmt[n.numFmtId]==t.NumberFmt[o]){n.numFmtId=o;break}}t.CellXf.push(n);break;case"</xf>":break;case"<alignment":case"<alignment/>":var l={};i.vertical&&(l.vertical=i.vertical),i.horizontal&&(l.horizontal=i.horizontal),i.textRotation!=null&&(l.textRotation=i.textRotation),i.indent&&(l.indent=i.indent),i.wrapText&&(l.wrapText=Pt(i.wrapText)),n.alignment=l;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":s=!0;break;case"</AlternateContent>":s=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(r&&r.WTF&&!s)throw new Error("unrecognized "+i[0]+" in cellXfs")}})}var y9=function(){var t=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,r=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,n=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,s=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,a=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(o,l,c){var f={};if(!o)return f;o=o.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var d;return(d=o.match(t))&&x9(d,f,c),(d=o.match(s))&&g9(d,f,l,c),(d=o.match(n))&&p9(d,f,l,c),(d=o.match(a))&&m9(d,f,l,c),(d=o.match(r))&&v9(d,f,c),f}}();function _9(e,t){var r=e.read_shift(2),n=zr(e);return[r,n]}function w9(e,t,r){var n={};n.sz=e.read_shift(2)/20;var s=Rj(e);s.fItalic&&(n.italic=1),s.fCondense&&(n.condense=1),s.fExtend&&(n.extend=1),s.fShadow&&(n.shadow=1),s.fOutline&&(n.outline=1),s.fStrikeout&&(n.strike=1);var a=e.read_shift(2);switch(a===700&&(n.bold=1),e.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var i=e.read_shift(1);i!=0&&(n.underline=i);var o=e.read_shift(1);o>0&&(n.family=o);var l=e.read_shift(1);switch(l>0&&(n.charset=l),e.l++,n.color=bj(e),e.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=zr(e),n}var E9=Gr;function T9(e,t){var r=e.l+t,n=e.read_shift(2),s=e.read_shift(2);return e.l=r,{ixfe:n,numFmtId:s}}var k9=Gr;function S9(e,t,r){var n={};n.NumberFmt=[];for(var s in $e)n.NumberFmt[s]=$e[s];n.CellXf=[],n.Fonts=[];var a=[],i=!1;return ka(e,function(l,c,f){switch(f){case 44:n.NumberFmt[l[0]]=l[1],Bi(l[1],l[0]);break;case 43:n.Fonts.push(l),l.color.theme!=null&&t&&t.themeElements&&t.themeElements.clrScheme&&(l.color.rgb=hd(t.themeElements.clrScheme[l.color.theme].rgb,l.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:a[a.length-1]==617&&n.CellXf.push(l);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:i=!0;break;case 36:i=!1;break;case 37:a.push(f),i=!0;break;case 38:a.pop(),i=!1;break;default:if(c.T>0)a.push(f);else if(c.T<0)a.pop();else if(!i||r.WTF&&a[a.length-1]!=37)throw new Error("Unexpected record 0x"+f.toString(16))}}),n}var A9=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function I9(e,t,r){t.themeElements.clrScheme=[];var n={};(e[0].match(Kr)||[]).forEach(function(s){var a=Oe(s);switch(a[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":n.rgb=a.val;break;case"<a:sysClr":n.rgb=a.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":a[0].charAt(1)==="/"?(t.themeElements.clrScheme[A9.indexOf(a[0])]=n,n={}):n.name=a[0].slice(3,a[0].length-1);break;default:if(r&&r.WTF)throw new Error("Unrecognized "+a[0]+" in clrScheme")}})}function N9(){}function C9(){}var b9=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,R9=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,P9=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function D9(e,t,r){t.themeElements={};var n;[["clrScheme",b9,I9],["fontScheme",R9,N9],["fmtScheme",P9,C9]].forEach(function(s){if(!(n=e.match(s[1])))throw new Error(s[0]+" not found in themeElements");s[2](n,t,r)})}var F9=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function yI(e,t){(!e||e.length===0)&&(e=O9());var r,n={};if(!(r=e.match(F9)))throw new Error("themeElements not found in theme");return D9(r[0],n,t),n.raw=e,n}function O9(e,t){var r=[bA];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function M9(e,t,r){var n=e.l+t,s=e.read_shift(4);if(s!==124226){if(!r.cellStyles){e.l=n;return}var a=e.slice(e.l);e.l=n;var i;try{i=CA(a,{type:"array"})}catch{return}var o=Tn(i,"theme/theme/theme1.xml",!0);if(o)return yI(o,r)}}function L9(e){return e.read_shift(4)}function j9(e){var t={};switch(t.xclrType=e.read_shift(2),t.nTintShade=e.read_shift(2),t.xclrType){case 0:e.l+=4;break;case 1:t.xclrValue=U9(e,4);break;case 2:t.xclrValue=aI(e);break;case 3:t.xclrValue=L9(e);break;case 4:e.l+=4;break}return e.l+=8,t}function U9(e,t){return Gr(e,t)}function V9(e,t){return Gr(e,t)}function B9(e){var t=e.read_shift(2),r=e.read_shift(2)-4,n=[t];switch(t){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:n[1]=j9(e);break;case 6:n[1]=V9(e,r);break;case 14:case 15:n[1]=e.read_shift(r===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+t+" "+r)}return n}function W9(e,t){var r=e.l+t;e.l+=2;var n=e.read_shift(2);e.l+=2;for(var s=e.read_shift(2),a=[];s-- >0;)a.push(B9(e,r-e.l));return{ixfe:n,ext:a}}function z9(e,t){t.forEach(function(r){switch(r[0]){}})}function $9(e,t){return{flags:e.read_shift(4),version:e.read_shift(4),name:zr(e)}}function H9(e){for(var t=[],r=e.read_shift(4);r-- >0;)t.push([e.read_shift(4),e.read_shift(4)]);return t}function G9(e){return e.l+=4,e.read_shift(4)!=0}function K9(e,t,r){var n={Types:[],Cell:[],Value:[]},s=r||{},a=[],i=!1,o=2;return ka(e,function(l,c,f){switch(f){case 335:n.Types.push({name:l.name});break;case 51:l.forEach(function(d){o==1?n.Cell.push({type:n.Types[d[0]-1].name,index:d[1]}):o==0&&n.Value.push({type:n.Types[d[0]-1].name,index:d[1]})});break;case 337:o=l?1:0;break;case 338:o=2;break;case 35:a.push(f),i=!0;break;case 36:a.pop(),i=!1;break;default:if(!c.T){if(!i||s.WTF&&a[a.length-1]!=35)throw new Error("Unexpected record 0x"+f.toString(16))}}}),n}function q9(e,t,r){var n={Types:[],Cell:[],Value:[]};if(!e)return n;var s=!1,a=2,i;return e.replace(Kr,function(o){var l=Oe(o);switch(Vs(l[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":n.Types.push({name:l.name});break;case"</metadataType>":break;case"<futureMetadata":for(var c=0;c<n.Types.length;++c)n.Types[c].name==l.name&&(i=n.Types[c]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":a==1?n.Cell.push({type:n.Types[l.t-1].name,index:+l.v}):a==0&&n.Value.push({type:n.Types[l.t-1].name,index:+l.v});break;case"</rc>":break;case"<cellMetadata":a=1;break;case"</cellMetadata>":a=2;break;case"<valueMetadata":a=0;break;case"</valueMetadata>":a=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;case"<rvb":if(!i)break;i.offsets||(i.offsets=[]),i.offsets.push(+l.i);break;default:if(!s&&r.WTF)throw new Error("unrecognized "+l[0]+" in metadata")}return o}),n}function Y9(e){var t=[];if(!e)return t;var r=1;return(e.match(Kr)||[]).forEach(function(n){var s=Oe(n);switch(s[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete s[0],s.i?r=s.i:s.i=r,t.push(s);break}}),t}function X9(e){var t={};t.i=e.read_shift(4);var r={};r.r=e.read_shift(4),r.c=e.read_shift(4),t.r=We(r);var n=e.read_shift(1);return n&2&&(t.l="1"),n&8&&(t.a="1"),t}function Q9(e,t,r){var n=[];return ka(e,function(a,i,o){switch(o){case 63:n.push(a);break;default:if(!i.T)throw new Error("Unexpected record 0x"+o.toString(16))}}),n}function J9(e,t,r,n){if(!e)return e;var s=n||{},a=!1;ka(e,function(o,l,c){switch(c){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:a=!0;break;case 36:a=!1;break;default:if(!l.T){if(!a||s.WTF)throw new Error("Unexpected record 0x"+c.toString(16))}}},s)}function Z9(e,t){if(!e)return"??";var r=(e.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return t["!id"][r].Target}function Uw(e,t,r,n){var s=Array.isArray(e),a;t.forEach(function(i){var o=Qr(i.ref);if(s?(e[o.r]||(e[o.r]=[]),a=e[o.r][o.c]):a=e[i.ref],!a){a={t:"z"},s?e[o.r][o.c]=a:e[i.ref]=a;var l=$t(e["!ref"]||"BDWGO1000001:A1");l.s.r>o.r&&(l.s.r=o.r),l.e.r<o.r&&(l.e.r=o.r),l.s.c>o.c&&(l.s.c=o.c),l.e.c<o.c&&(l.e.c=o.c);var c=at(l);c!==e["!ref"]&&(e["!ref"]=c)}a.c||(a.c=[]);var f={a:i.author,t:i.t,r:i.r,T:r};i.h&&(f.h=i.h);for(var d=a.c.length-1;d>=0;--d){if(!r&&a.c[d].T)return;r&&!a.c[d].T&&a.c.splice(d,1)}if(r&&n){for(d=0;d<n.length;++d)if(f.a==n[d].id){f.a=n[d].name||f.a;break}}a.c.push(f)})}function eU(e,t){if(e.match(/<(?:\w+:)?comments *\/>/))return[];var r=[],n=[],s=e.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);s&&s[1]&&s[1].split(/<\/\w*:?author>/).forEach(function(i){if(!(i===""||i.trim()==="")){var o=i.match(/<(?:\w+:)?author[^>]*>(.*)/);o&&r.push(o[1])}});var a=e.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return a&&a[1]&&a[1].split(/<\/\w*:?comment>/).forEach(function(i){if(!(i===""||i.trim()==="")){var o=i.match(/<(?:\w+:)?comment[^>]*>/);if(o){var l=Oe(o[0]),c={author:l.authorId&&r[l.authorId]||"sheetjsghost",ref:l.ref,guid:l.guid},f=Qr(l.ref);if(!(t.sheetRows&&t.sheetRows<=f.r)){var d=i.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),m=!!d&&!!d[1]&&dv(d[1])||{r:"",t:"",h:""};c.r=m.r,m.r=="<t></t>"&&(m.t=m.h=""),c.t=(m.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),t.cellHTML&&(c.h=m.h),n.push(c)}}}}),n}function tU(e,t){var r=[],n=!1,s={},a=0;return e.replace(Kr,function(o,l){var c=Oe(o);switch(Vs(c[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":s={author:c.personId,guid:c.id,ref:c.ref,T:1};break;case"</threadedComment>":s.t!=null&&r.push(s);break;case"<text>":case"<text":a=l+o.length;break;case"</text>":s.t=e.slice(a,l).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":n=!0;break;case"</mentions>":n=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&t.WTF)throw new Error("unrecognized "+c[0]+" in threaded comments")}return o}),r}function rU(e,t){var r=[],n=!1;return e.replace(Kr,function(a){var i=Oe(a);switch(Vs(i[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":r.push({name:i.displayname,id:i.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&t.WTF)throw new Error("unrecognized "+i[0]+" in threaded comments")}return a}),r}function nU(e){var t={};t.iauthor=e.read_shift(4);var r=fo(e);return t.rfx=r.s,t.ref=We(r.s),e.l+=16,t}var sU=zr;function aU(e,t){var r=[],n=[],s={},a=!1;return ka(e,function(o,l,c){switch(c){case 632:n.push(o);break;case 635:s=o;break;case 637:s.t=o.t,s.h=o.h,s.r=o.r;break;case 636:if(s.author=n[s.iauthor],delete s.iauthor,t.sheetRows&&s.rfx&&t.sheetRows<=s.rfx.r)break;s.t||(s.t=""),delete s.rfx,r.push(s);break;case 3072:break;case 35:a=!0;break;case 36:a=!1;break;case 37:break;case 38:break;default:if(!l.T){if(!a||t.WTF)throw new Error("Unexpected record 0x"+c.toString(16))}}}),r}var iU="application/vnd.ms-office.vbaProject";function oU(e){var t=st.utils.cfb_new({root:"R"});return e.FullPaths.forEach(function(r,n){if(!(r.slice(-1)==="/"||!r.match(/_VBA_PROJECT_CUR/))){var s=r.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");st.utils.cfb_add(t,s,e.FileIndex[n].content)}}),st.write(t)}function lU(){return{"!type":"dialog"}}function cU(){return{"!type":"dialog"}}function uU(){return{"!type":"macro"}}function fU(){return{"!type":"macro"}}var Zo=function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,t={r:0,c:0};function r(n,s,a,i){var o=!1,l=!1;a.length==0?l=!0:a.charAt(0)=="["&&(l=!0,a=a.slice(1,-1)),i.length==0?o=!0:i.charAt(0)=="["&&(o=!0,i=i.slice(1,-1));var c=a.length>0?parseInt(a,10)|0:0,f=i.length>0?parseInt(i,10)|0:0;return o?f+=t.c:--f,l?c+=t.r:--c,s+(o?"":"$")+or(f)+(l?"":"$")+Ar(c)}return function(s,a){return t=a,s.replace(e,r)}}(),_I=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,hU=function(){return function(t,r){return t.replace(_I,function(n,s,a,i,o,l){var c=ov(i)-(a?0:r.c),f=iv(l)-(o?0:r.r),d=f==0?"":o?f+1:"["+f+"]",m=c==0?"":a?c+1:"["+c+"]";return s+"R"+d+"C"+m})}}();function wI(e,t){return e.replace(_I,function(r,n,s,a,i,o){return n+(s=="$"?s+a:or(ov(a)+t.c))+(i=="$"?i+o:Ar(iv(o)+t.r))})}function dU(e,t,r){var n=Cl(t),s=n.s,a=Qr(r),i={r:a.r-s.r,c:a.c-s.c};return wI(e,i)}function mU(e){return e.length!=1}function Vw(e){return e.replace(/_xlfn\./g,"")}function Xt(e){e.l+=1}function mi(e,t){var r=e.read_shift(2);return[r&16383,r>>14&1,r>>15&1]}function EI(e,t,r){var n=2;if(r){if(r.biff>=2&&r.biff<=5)return TI(e);r.biff==12&&(n=4)}var s=e.read_shift(n),a=e.read_shift(n),i=mi(e),o=mi(e);return{s:{r:s,c:i[0],cRel:i[1],rRel:i[2]},e:{r:a,c:o[0],cRel:o[1],rRel:o[2]}}}function TI(e){var t=mi(e),r=mi(e),n=e.read_shift(1),s=e.read_shift(1);return{s:{r:t[0],c:n,cRel:t[1],rRel:t[2]},e:{r:r[0],c:s,cRel:r[1],rRel:r[2]}}}function pU(e,t,r){if(r.biff<8)return TI(e);var n=e.read_shift(r.biff==12?4:2),s=e.read_shift(r.biff==12?4:2),a=mi(e),i=mi(e);return{s:{r:n,c:a[0],cRel:a[1],rRel:a[2]},e:{r:s,c:i[0],cRel:i[1],rRel:i[2]}}}function kI(e,t,r){if(r&&r.biff>=2&&r.biff<=5)return gU(e);var n=e.read_shift(r&&r.biff==12?4:2),s=mi(e);return{r:n,c:s[0],cRel:s[1],rRel:s[2]}}function gU(e){var t=mi(e),r=e.read_shift(1);return{r:t[0],c:r,cRel:t[1],rRel:t[2]}}function xU(e){var t=e.read_shift(2),r=e.read_shift(2);return{r:t,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function vU(e,t,r){var n=r&&r.biff?r.biff:8;if(n>=2&&n<=5)return yU(e);var s=e.read_shift(n>=12?4:2),a=e.read_shift(2),i=(a&16384)>>14,o=(a&32768)>>15;if(a&=16383,o==1)for(;s>524287;)s-=1048576;if(i==1)for(;a>8191;)a=a-16384;return{r:s,c:a,cRel:i,rRel:o}}function yU(e){var t=e.read_shift(2),r=e.read_shift(1),n=(t&32768)>>15,s=(t&16384)>>14;return t&=16383,n==1&&t>=8192&&(t=t-16384),s==1&&r>=128&&(r=r-256),{r:t,c:r,cRel:s,rRel:n}}function _U(e,t,r){var n=(e[e.l++]&96)>>5,s=EI(e,r.biff>=2&&r.biff<=5?6:8,r);return[n,s]}function wU(e,t,r){var n=(e[e.l++]&96)>>5,s=e.read_shift(2,"i"),a=8;if(r)switch(r.biff){case 5:e.l+=12,a=6;break;case 12:a=12;break}var i=EI(e,a,r);return[n,s,i]}function EU(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r&&r.biff>8?12:r.biff<8?6:8,[n]}function TU(e,t,r){var n=(e[e.l++]&96)>>5,s=e.read_shift(2),a=8;if(r)switch(r.biff){case 5:e.l+=12,a=6;break;case 12:a=12;break}return e.l+=a,[n,s]}function kU(e,t,r){var n=(e[e.l++]&96)>>5,s=pU(e,t-1,r);return[n,s]}function SU(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r.biff==2?6:r.biff==12?14:7,[n]}function Bw(e){var t=e[e.l+1]&1,r=1;return e.l+=4,[t,r]}function AU(e,t,r){e.l+=2;for(var n=e.read_shift(r&&r.biff==2?1:2),s=[],a=0;a<=n;++a)s.push(e.read_shift(r&&r.biff==2?1:2));return s}function IU(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function NU(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function CU(e){var t=e[e.l+1]&255?1:0;return e.l+=2,[t,e.read_shift(2)]}function bU(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=r&&r.biff==2?3:4,[n]}function SI(e){var t=e.read_shift(1),r=e.read_shift(1);return[t,r]}function RU(e){return e.read_shift(2),SI(e)}function PU(e){return e.read_shift(2),SI(e)}function DU(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var s=kI(e,0,r);return[n,s]}function FU(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var s=vU(e,0,r);return[n,s]}function OU(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var s=e.read_shift(2);r&&r.biff==5&&(e.l+=12);var a=kI(e,0,r);return[n,s,a]}function MU(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var s=e.read_shift(r&&r.biff<=3?1:2);return[LV[s],NI[s],n]}function LU(e,t,r){var n=e[e.l++],s=e.read_shift(1),a=r&&r.biff<=3?[n==88?-1:0,e.read_shift(1)]:jU(e);return[s,(a[0]===0?NI:MV)[a[1]]]}function jU(e){return[e[e.l+1]>>7,e.read_shift(2)&32767]}function UU(e,t,r){e.l+=r&&r.biff==2?3:4}function VU(e,t,r){if(e.l++,r&&r.biff==12)return[e.read_shift(4,"i"),0];var n=e.read_shift(2),s=e.read_shift(r&&r.biff==2?1:2);return[n,s]}function BU(e){return e.l++,ho[e.read_shift(1)]}function WU(e){return e.l++,e.read_shift(2)}function zU(e){return e.l++,e.read_shift(1)!==0}function $U(e){return e.l++,Vr(e)}function HU(e,t,r){return e.l++,Gu(e,t-1,r)}function GU(e,t){var r=[e.read_shift(1)];if(t==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=Ht(e,1)?"TRUE":"FALSE",t!=12&&(e.l+=7);break;case 37:case 16:r[1]=ho[e[e.l]],e.l+=t==12?4:8;break;case 0:e.l+=8;break;case 1:r[1]=Vr(e);break;case 2:r[1]=mo(e,0,{biff:t>0&&t<8?2:t});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function KU(e,t,r){for(var n=e.read_shift(r.biff==12?4:2),s=[],a=0;a!=n;++a)s.push((r.biff==12?fo:l0)(e));return s}function qU(e,t,r){var n=0,s=0;r.biff==12?(n=e.read_shift(4),s=e.read_shift(4)):(s=1+e.read_shift(1),n=1+e.read_shift(2)),r.biff>=2&&r.biff<8&&(--n,--s==0&&(s=256));for(var a=0,i=[];a!=n&&(i[a]=[]);++a)for(var o=0;o!=s;++o)i[a][o]=GU(e,r.biff);return i}function YU(e,t,r){var n=e.read_shift(1)>>>5&3,s=!r||r.biff>=8?4:2,a=e.read_shift(s);switch(r.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[n,0,a]}function XU(e,t,r){if(r.biff==5)return QU(e);var n=e.read_shift(1)>>>5&3,s=e.read_shift(2),a=e.read_shift(4);return[n,s,a]}function QU(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2,"i");e.l+=8;var n=e.read_shift(2);return e.l+=12,[t,r,n]}function JU(e,t,r){var n=e.read_shift(1)>>>5&3;e.l+=r&&r.biff==2?3:4;var s=e.read_shift(r&&r.biff==2?1:2);return[n,s]}function ZU(e,t,r){var n=e.read_shift(1)>>>5&3,s=e.read_shift(r&&r.biff==2?1:2);return[n,s]}function eV(e,t,r){var n=e.read_shift(1)>>>5&3;return e.l+=4,r.biff<8&&e.l--,r.biff==12&&(e.l+=2),[n]}function tV(e,t,r){var n=(e[e.l++]&96)>>5,s=e.read_shift(2),a=4;if(r)switch(r.biff){case 5:a=15;break;case 12:a=6;break}return e.l+=a,[n,s]}var rV=Gr,nV=Gr,sV=Gr;function qu(e,t,r){return e.l+=2,[xU(e)]}function pv(e){return e.l+=6,[]}var aV=qu,iV=pv,oV=pv,lV=qu;function AI(e){return e.l+=2,[Zt(e),e.read_shift(2)&1]}var cV=qu,uV=AI,fV=pv,hV=qu,dV=qu,mV=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function pV(e){e.l+=2;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),s=e.read_shift(2),a=e.read_shift(2),i=mV[r>>2&31];return{ixti:t,coltype:r&3,rt:i,idx:n,c:s,C:a}}function gV(e){return e.l+=2,[e.read_shift(4)]}function xV(e,t,r){return e.l+=5,e.l+=2,e.l+=r.biff==2?1:4,["PTGSHEET"]}function vV(e,t,r){return e.l+=r.biff==2?4:5,["PTGENDSHEET"]}function yV(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function _V(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function wV(e){return e.l+=4,[0,0]}var Ww={1:{n:"PtgExp",f:VU},2:{n:"PtgTbl",f:sV},3:{n:"PtgAdd",f:Xt},4:{n:"PtgSub",f:Xt},5:{n:"PtgMul",f:Xt},6:{n:"PtgDiv",f:Xt},7:{n:"PtgPower",f:Xt},8:{n:"PtgConcat",f:Xt},9:{n:"PtgLt",f:Xt},10:{n:"PtgLe",f:Xt},11:{n:"PtgEq",f:Xt},12:{n:"PtgGe",f:Xt},13:{n:"PtgGt",f:Xt},14:{n:"PtgNe",f:Xt},15:{n:"PtgIsect",f:Xt},16:{n:"PtgUnion",f:Xt},17:{n:"PtgRange",f:Xt},18:{n:"PtgUplus",f:Xt},19:{n:"PtgUminus",f:Xt},20:{n:"PtgPercent",f:Xt},21:{n:"PtgParen",f:Xt},22:{n:"PtgMissArg",f:Xt},23:{n:"PtgStr",f:HU},26:{n:"PtgSheet",f:xV},27:{n:"PtgEndSheet",f:vV},28:{n:"PtgErr",f:BU},29:{n:"PtgBool",f:zU},30:{n:"PtgInt",f:WU},31:{n:"PtgNum",f:$U},32:{n:"PtgArray",f:SU},33:{n:"PtgFunc",f:MU},34:{n:"PtgFuncVar",f:LU},35:{n:"PtgName",f:YU},36:{n:"PtgRef",f:DU},37:{n:"PtgArea",f:_U},38:{n:"PtgMemArea",f:JU},39:{n:"PtgMemErr",f:rV},40:{n:"PtgMemNoMem",f:nV},41:{n:"PtgMemFunc",f:ZU},42:{n:"PtgRefErr",f:eV},43:{n:"PtgAreaErr",f:EU},44:{n:"PtgRefN",f:FU},45:{n:"PtgAreaN",f:kU},46:{n:"PtgMemAreaN",f:yV},47:{n:"PtgMemNoMemN",f:_V},57:{n:"PtgNameX",f:XU},58:{n:"PtgRef3d",f:OU},59:{n:"PtgArea3d",f:wU},60:{n:"PtgRefErr3d",f:tV},61:{n:"PtgAreaErr3d",f:TU},255:{}},EV={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},TV={1:{n:"PtgElfLel",f:AI},2:{n:"PtgElfRw",f:hV},3:{n:"PtgElfCol",f:aV},6:{n:"PtgElfRwV",f:dV},7:{n:"PtgElfColV",f:lV},10:{n:"PtgElfRadical",f:cV},11:{n:"PtgElfRadicalS",f:fV},13:{n:"PtgElfColS",f:iV},15:{n:"PtgElfColSV",f:oV},16:{n:"PtgElfRadicalLel",f:uV},25:{n:"PtgList",f:pV},29:{n:"PtgSxName",f:gV},255:{}},kV={0:{n:"PtgAttrNoop",f:wV},1:{n:"PtgAttrSemi",f:bU},2:{n:"PtgAttrIf",f:NU},4:{n:"PtgAttrChoose",f:AU},8:{n:"PtgAttrGoto",f:IU},16:{n:"PtgAttrSum",f:UU},32:{n:"PtgAttrBaxcel",f:Bw},33:{n:"PtgAttrBaxcel",f:Bw},64:{n:"PtgAttrSpace",f:RU},65:{n:"PtgAttrSpaceSemi",f:PU},128:{n:"PtgAttrIfError",f:CU},255:{}};function Yu(e,t,r,n){if(n.biff<8)return Gr(e,t);for(var s=e.l+t,a=[],i=0;i!==r.length;++i)switch(r[i][0]){case"PtgArray":r[i][1]=qU(e,0,n),a.push(r[i][1]);break;case"PtgMemArea":r[i][2]=KU(e,r[i][1],n),a.push(r[i][2]);break;case"PtgExp":n&&n.biff==12&&(r[i][1][1]=e.read_shift(4),a.push(r[i][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[i][0]}return t=s-e.l,t!==0&&a.push(Gr(e,t)),a}function Xu(e,t,r){for(var n=e.l+t,s,a,i=[];n!=e.l;)t=n-e.l,a=e[e.l],s=Ww[a]||Ww[EV[a]],(a===24||a===25)&&(s=(a===24?TV:kV)[e[e.l+1]]),!s||!s.f?Gr(e,t):i.push([s.n,s.f(e,t,r)]);return i}function SV(e){for(var t=[],r=0;r<e.length;++r){for(var n=e[r],s=[],a=0;a<n.length;++a){var i=n[a];if(i)switch(i[0]){case 2:s.push('"'+i[1].replace(/"/g,'""')+'"');break;default:s.push(i[1])}else s.push("")}t.push(s.join(","))}return t.join(";")}var AV={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function IV(e,t){if(!e&&!(t&&t.biff<=5&&t.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}function II(e,t,r){if(!e)return"SH33TJSERR0";if(r.biff>8&&(!e.XTI||!e.XTI[t]))return e.SheetNames[t];if(!e.XTI)return"SH33TJSERR6";var n=e.XTI[t];if(r.biff<8)return t>1e4&&(t-=65536),t<0&&(t=-t),t==0?"":e.XTI[t-1];if(!n)return"SH33TJSERR1";var s="";if(r.biff>8)switch(e[n[0]][0]){case 357:return s=n[1]==-1?"#REF":e.SheetNames[n[1]],n[1]==n[2]?s:s+":"+e.SheetNames[n[2]];case 358:return r.SID!=null?e.SheetNames[r.SID]:"SH33TJSSAME"+e[n[0]][0];case 355:default:return"SH33TJSSRC"+e[n[0]][0]}switch(e[n[0]][0][0]){case 1025:return s=n[1]==-1?"#REF":e.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?s:s+":"+e.SheetNames[n[2]];case 14849:return e[n[0]].slice(1).map(function(a){return a.Name}).join(";;");default:return e[n[0]][0][3]?(s=n[1]==-1?"#REF":e[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?s:s+":"+e[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function zw(e,t,r){var n=II(e,t,r);return n=="#REF"?n:IV(n,r)}function Lr(e,t,r,n,s){var a=s&&s.biff||8,i={s:{c:0,r:0}},o=[],l,c,f,d=0,m=0,p,x="";if(!e[0]||!e[0][0])return"";for(var g=-1,w="",k=0,E=e[0].length;k<E;++k){var y=e[0][k];switch(y[0]){case"PtgUminus":o.push("-"+o.pop());break;case"PtgUplus":o.push("+"+o.pop());break;case"PtgPercent":o.push(o.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(l=o.pop(),c=o.pop(),g>=0){switch(e[0][g][1][0]){case 0:w=Wt(" ",e[0][g][1][1]);break;case 1:w=Wt("\r",e[0][g][1][1]);break;default:if(w="",s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][g][1][0])}c=c+w,g=-1}o.push(c+AV[y[0]]+l);break;case"PtgIsect":l=o.pop(),c=o.pop(),o.push(c+" "+l);break;case"PtgUnion":l=o.pop(),c=o.pop(),o.push(c+","+l);break;case"PtgRange":l=o.pop(),c=o.pop(),o.push(c+":"+l);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":f=Ic(y[1][1],i,s),o.push(Nc(f,a));break;case"PtgRefN":f=r?Ic(y[1][1],r,s):y[1][1],o.push(Nc(f,a));break;case"PtgRef3d":d=y[1][1],f=Ic(y[1][2],i,s),x=zw(n,d,s),o.push(x+"!"+Nc(f,a));break;case"PtgFunc":case"PtgFuncVar":var I=y[1][0],M=y[1][1];I||(I=0),I&=127;var O=I==0?[]:o.slice(-I);o.length-=I,M==="User"&&(M=O.shift()),o.push(M+"("+O.join(",")+")");break;case"PtgBool":o.push(y[1]?"TRUE":"FALSE");break;case"PtgInt":o.push(y[1]);break;case"PtgNum":o.push(String(y[1]));break;case"PtgStr":o.push('"'+y[1].replace(/"/g,'""')+'"');break;case"PtgErr":o.push(y[1]);break;case"PtgAreaN":p=Tw(y[1][1],r?{s:r}:i,s),o.push(am(p,s));break;case"PtgArea":p=Tw(y[1][1],i,s),o.push(am(p,s));break;case"PtgArea3d":d=y[1][1],p=y[1][2],x=zw(n,d,s),o.push(x+"!"+am(p,s));break;case"PtgAttrSum":o.push("SUM("+o.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":m=y[1][2];var v=(n.names||[])[m-1]||(n[0]||[])[m],T=v?v.Name:"SH33TJSNAME"+String(m);T&&T.slice(0,6)=="_xlfn."&&!s.xlfn&&(T=T.slice(6)),o.push(T);break;case"PtgNameX":var S=y[1][1];m=y[1][2];var C;if(s.biff<=5)S<0&&(S=-S),n[S]&&(C=n[S][m]);else{var b="";if(((n[S]||[])[0]||[])[0]==14849||(((n[S]||[])[0]||[])[0]==1025?n[S][m]&&n[S][m].itab>0&&(b=n.SheetNames[n[S][m].itab-1]+"!"):b=n.SheetNames[m-1]+"!"),n[S]&&n[S][m])b+=n[S][m].Name;else if(n[0]&&n[0][m])b+=n[0][m].Name;else{var P=(II(n,S,s)||"").split(";;");P[m-1]?b=P[m-1]:b+="SH33TJSERRX"}o.push(b);break}C||(C={Name:"SH33TJSERRY"}),o.push(C.Name);break;case"PtgParen":var D="(",ie=")";if(g>=0){switch(w="",e[0][g][1][0]){case 2:D=Wt(" ",e[0][g][1][1])+D;break;case 3:D=Wt("\r",e[0][g][1][1])+D;break;case 4:ie=Wt(" ",e[0][g][1][1])+ie;break;case 5:ie=Wt("\r",e[0][g][1][1])+ie;break;default:if(s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][g][1][0])}g=-1}o.push(D+o.pop()+ie);break;case"PtgRefErr":o.push("#REF!");break;case"PtgRefErr3d":o.push("#REF!");break;case"PtgExp":f={c:y[1][1],r:y[1][0]};var Z={c:r.c,r:r.r};if(n.sharedf[We(f)]){var fe=n.sharedf[We(f)];o.push(Lr(fe,i,Z,n,s))}else{var ue=!1;for(l=0;l!=n.arrayf.length;++l)if(c=n.arrayf[l],!(f.c<c[0].s.c||f.c>c[0].e.c)&&!(f.r<c[0].s.r||f.r>c[0].e.r)){o.push(Lr(c[1],i,Z,n,s)),ue=!0;break}ue||o.push(y[1])}break;case"PtgArray":o.push("{"+SV(y[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":g=k;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":o.push("");break;case"PtgAreaErr":o.push("#REF!");break;case"PtgAreaErr3d":o.push("#REF!");break;case"PtgList":o.push("Table"+y[1].idx+"[#"+y[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(y));default:throw new Error("Unrecognized Formula Token: "+String(y))}var q=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(s.biff!=3&&g>=0&&q.indexOf(e[0][k][0])==-1){y=e[0][g];var G=!0;switch(y[1][0]){case 4:G=!1;case 0:w=Wt(" ",y[1][1]);break;case 5:G=!1;case 1:w=Wt("\r",y[1][1]);break;default:if(w="",s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+y[1][0])}o.push((G?w:"")+o.pop()+(G?"":w)),g=-1}}if(o.length>1&&s.WTF)throw new Error("bad formula stack");return o[0]}function NV(e,t,r){var n=e.l+t,s=r.biff==2?1:2,a,i=e.read_shift(s);if(i==65535)return[[],Gr(e,t-2)];var o=Xu(e,i,r);return t!==i+s&&(a=Yu(e,t-i-s,o,r)),e.l=n,[o,a]}function CV(e,t,r){var n=e.l+t,s=r.biff==2?1:2,a,i=e.read_shift(s);if(i==65535)return[[],Gr(e,t-2)];var o=Xu(e,i,r);return t!==i+s&&(a=Yu(e,t-i-s,o,r)),e.l=n,[o,a]}function bV(e,t,r,n){var s=e.l+t,a=Xu(e,n,r),i;return s!==e.l&&(i=Yu(e,s-e.l,a,r)),[a,i]}function RV(e,t,r){var n=e.l+t,s,a=e.read_shift(2),i=Xu(e,a,r);return a==65535?[[],Gr(e,t-2)]:(t!==a+2&&(s=Yu(e,n-a-2,i,r)),[i,s])}function PV(e){var t;if(sa(e,e.l+6)!==65535)return[Vr(e),"n"];switch(e[e.l]){case 0:return e.l+=8,["String","s"];case 1:return t=e[e.l+2]===1,e.l+=8,[t,"b"];case 2:return t=e[e.l+2],e.l+=8,[t,"e"];case 3:return e.l+=8,["","s"]}return[]}function lm(e,t,r){var n=e.l+t,s=Bs(e);r.biff==2&&++e.l;var a=PV(e),i=e.read_shift(1);r.biff!=2&&(e.read_shift(1),r.biff>=5&&e.read_shift(4));var o=CV(e,n-e.l,r);return{cell:s,val:a[0],formula:o,shared:i>>3&1,tt:a[1]}}function c0(e,t,r){var n=e.read_shift(4),s=Xu(e,n,r),a=e.read_shift(4),i=a>0?Yu(e,a,s,r):null;return[s,i]}var DV=c0,u0=c0,FV=c0,OV=c0,MV={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},NI={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},LV={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function $w(e){return e.slice(0,3)=="of:"&&(e=e.slice(3)),e.charCodeAt(0)==61&&(e=e.slice(1),e.charCodeAt(0)==61&&(e=e.slice(1))),e=e.replace(/COM\.MICROSOFT\./g,""),e=e.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(t,r){return r.replace(/\./g,"")}),e=e.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),e.replace(/[;~]/g,",").replace(/\|/g,";")}function cm(e){var t=e.split(":"),r=t[0].split(".")[0];return[r,t[0].split(".")[1]+(t.length>1?":"+(t[1].split(".")[1]||t[1].split(".")[0]):"")]}var Pc={},el={};function Dc(e,t){if(e){var r=[.7,.7,.75,.75,.3,.3];t=="xlml"&&(r=[1,1,1,1,.5,.5]),e.left==null&&(e.left=r[0]),e.right==null&&(e.right=r[1]),e.top==null&&(e.top=r[2]),e.bottom==null&&(e.bottom=r[3]),e.header==null&&(e.header=r[4]),e.footer==null&&(e.footer=r[5])}}function CI(e,t,r,n,s,a){try{n.cellNF&&(e.z=$e[t])}catch(o){if(n.WTF)throw o}if(!(e.t==="z"&&!n.cellStyles)){if(e.t==="d"&&typeof e.v=="string"&&(e.v=gr(e.v)),(!n||n.cellText!==!1)&&e.t!=="z")try{if($e[t]==null&&Bi(j6[t]||"General",t),e.t==="e")e.w=e.w||ho[e.v];else if(t===0)if(e.t==="n")(e.v|0)===e.v?e.w=e.v.toString(10):e.w=hu(e.v);else if(e.t==="d"){var i=tn(e.v);(i|0)===i?e.w=i.toString(10):e.w=hu(i)}else{if(e.v===void 0)return"";e.w=Zi(e.v,el)}else e.t==="d"?e.w=Yn(t,tn(e.v),el):e.w=Yn(t,e.v,el)}catch(o){if(n.WTF)throw o}if(n.cellStyles&&r!=null)try{e.s=a.Fills[r],e.s.fgColor&&e.s.fgColor.theme&&!e.s.fgColor.rgb&&(e.s.fgColor.rgb=hd(s.themeElements.clrScheme[e.s.fgColor.theme].rgb,e.s.fgColor.tint||0),n.WTF&&(e.s.fgColor.raw_rgb=s.themeElements.clrScheme[e.s.fgColor.theme].rgb)),e.s.bgColor&&e.s.bgColor.theme&&(e.s.bgColor.rgb=hd(s.themeElements.clrScheme[e.s.bgColor.theme].rgb,e.s.bgColor.tint||0),n.WTF&&(e.s.bgColor.raw_rgb=s.themeElements.clrScheme[e.s.bgColor.theme].rgb))}catch(o){if(n.WTF&&a.Fills)throw o}}}function jV(e,t){var r=$t(t);r.s.r<=r.e.r&&r.s.c<=r.e.c&&r.s.r>=0&&r.s.c>=0&&(e["!ref"]=at(r))}var UV=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,VV=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,BV=/<(?:\w:)?hyperlink [^>]*>/mg,WV=/"(\w*:\w*)"/,zV=/<(?:\w:)?col\b[^>]*[\/]?>/g,$V=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,HV=/<(?:\w:)?pageMargins[^>]*\/>/g,bI=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,GV=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,KV=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function qV(e,t,r,n,s,a,i){if(!e)return e;n||(n={"!id":{}});var o=t.dense?[]:{},l={s:{r:2e6,c:2e6},e:{r:0,c:0}},c="",f="",d=e.match(VV);d?(c=e.slice(0,d.index),f=e.slice(d.index+d[0].length)):c=f=e;var m=c.match(bI);m?gv(m[0],o,s,r):(m=c.match(GV))&&YV(m[0],m[1]||"",o,s,r);var p=(c.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(p>0){var x=c.slice(p,p+50).match(WV);x&&jV(o,x[1])}var g=c.match(KV);g&&g[1]&&t7(g[1],s);var w=[];if(t.cellStyles){var k=c.match(zV);k&&JV(w,k)}d&&r7(d[1],o,t,l,a,i);var E=f.match($V);E&&(o["!autofilter"]=ZV(E[0]));var y=[],I=f.match(UV);if(I)for(p=0;p!=I.length;++p)y[p]=$t(I[p].slice(I[p].indexOf('"')+1));var M=f.match(BV);M&&XV(o,M,n);var O=f.match(HV);if(O&&(o["!margins"]=QV(Oe(O[0]))),!o["!ref"]&&l.e.c>=l.s.c&&l.e.r>=l.s.r&&(o["!ref"]=at(l)),t.sheetRows>0&&o["!ref"]){var v=$t(o["!ref"]);t.sheetRows<=+v.e.r&&(v.e.r=t.sheetRows-1,v.e.r>l.e.r&&(v.e.r=l.e.r),v.e.r<v.s.r&&(v.s.r=v.e.r),v.e.c>l.e.c&&(v.e.c=l.e.c),v.e.c<v.s.c&&(v.s.c=v.e.c),o["!fullref"]=o["!ref"],o["!ref"]=at(v))}return w.length>0&&(o["!cols"]=w),y.length>0&&(o["!merges"]=y),o}function gv(e,t,r,n){var s=Oe(e);r.Sheets[n]||(r.Sheets[n]={}),s.codeName&&(r.Sheets[n].CodeName=lt(Tt(s.codeName)))}function YV(e,t,r,n,s){gv(e.slice(0,e.indexOf(">")),r,n,s)}function XV(e,t,r){for(var n=Array.isArray(e),s=0;s!=t.length;++s){var a=Oe(Tt(t[s]),!0);if(!a.ref)return;var i=((r||{})["!id"]||[])[a.id];i?(a.Target=i.Target,a.location&&(a.Target+="#"+lt(a.location))):(a.Target="#"+lt(a.location),i={Target:a.Target,TargetMode:"Internal"}),a.Rel=i,a.tooltip&&(a.Tooltip=a.tooltip,delete a.tooltip);for(var o=$t(a.ref),l=o.s.r;l<=o.e.r;++l)for(var c=o.s.c;c<=o.e.c;++c){var f=We({c,r:l});n?(e[l]||(e[l]=[]),e[l][c]||(e[l][c]={t:"z",v:void 0}),e[l][c].l=a):(e[f]||(e[f]={t:"z",v:void 0}),e[f].l=a)}}}function QV(e){var t={};return["left","right","top","bottom","header","footer"].forEach(function(r){e[r]&&(t[r]=parseFloat(e[r]))}),t}function JV(e,t){for(var r=!1,n=0;n!=t.length;++n){var s=Oe(t[n],!0);s.hidden&&(s.hidden=Pt(s.hidden));var a=parseInt(s.min,10)-1,i=parseInt(s.max,10)-1;for(s.outlineLevel&&(s.level=+s.outlineLevel||0),delete s.min,delete s.max,s.width=+s.width,!r&&s.width&&(r=!0,mv(s.width)),yl(s);a<=i;)e[a++]=Sr(s)}}function ZV(e){var t={ref:(e.match(/ref="([^"]*)"/)||[])[1]};return t}var e7=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function t7(e,t){t.Views||(t.Views=[{}]),(e.match(e7)||[]).forEach(function(r,n){var s=Oe(r);t.Views[n]||(t.Views[n]={}),+s.zoomScale&&(t.Views[n].zoom=+s.zoomScale),Pt(s.rightToLeft)&&(t.Views[n].RTL=!0)})}var r7=function(){var e=/<(?:\w+:)?c[ \/>]/,t=/<\/(?:\w+:)?row>/,r=/r=["']([^"']*)["']/,n=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,s=/ref=["']([^"']*)["']/,a=du("v"),i=du("f");return function(l,c,f,d,m,p){for(var x=0,g="",w=[],k=[],E=0,y=0,I=0,M="",O,v,T=0,S=0,C,b,P=0,D=0,ie=Array.isArray(p.CellXf),Z,fe=[],ue=[],q=Array.isArray(c),G=[],ne={},ce=!1,j=!!f.sheetStubs,Y=l.split(t),K=0,V=Y.length;K!=V;++K){g=Y[K].trim();var J=g.length;if(J!==0){var de=0;e:for(x=0;x<J;++x)switch(g[x]){case">":if(g[x-1]!="/"){++x;break e}if(f&&f.cellStyles){if(v=Oe(g.slice(de,x),!0),T=v.r!=null?parseInt(v.r,10):T+1,S=-1,f.sheetRows&&f.sheetRows<T)continue;ne={},ce=!1,v.ht&&(ce=!0,ne.hpt=parseFloat(v.ht),ne.hpx=xu(ne.hpt)),v.hidden=="1"&&(ce=!0,ne.hidden=!0),v.outlineLevel!=null&&(ce=!0,ne.level=+v.outlineLevel),ce&&(G[T-1]=ne)}break;case"<":de=x;break}if(de>=x)break;if(v=Oe(g.slice(de,x),!0),T=v.r!=null?parseInt(v.r,10):T+1,S=-1,!(f.sheetRows&&f.sheetRows<T)){d.s.r>T-1&&(d.s.r=T-1),d.e.r<T-1&&(d.e.r=T-1),f&&f.cellStyles&&(ne={},ce=!1,v.ht&&(ce=!0,ne.hpt=parseFloat(v.ht),ne.hpx=xu(ne.hpt)),v.hidden=="1"&&(ce=!0,ne.hidden=!0),v.outlineLevel!=null&&(ce=!0,ne.level=+v.outlineLevel),ce&&(G[T-1]=ne)),w=g.slice(x).split(e);for(var Ee=0;Ee!=w.length&&w[Ee].trim().charAt(0)=="<";++Ee);for(w=w.slice(Ee),x=0;x!=w.length;++x)if(g=w[x].trim(),g.length!==0){if(k=g.match(r),E=x,y=0,I=0,g="<c "+(g.slice(0,1)=="<"?">":"")+g,k!=null&&k.length===2){for(E=0,M=k[1],y=0;y!=M.length&&!((I=M.charCodeAt(y)-64)<1||I>26);++y)E=26*E+I;--E,S=E}else++S;for(y=0;y!=g.length&&g.charCodeAt(y)!==62;++y);if(++y,v=Oe(g.slice(0,y),!0),v.r||(v.r=We({r:T-1,c:S})),M=g.slice(y),O={t:""},(k=M.match(a))!=null&&k[1]!==""&&(O.v=lt(k[1])),f.cellFormula){if((k=M.match(i))!=null&&k[1]!==""){if(O.f=lt(Tt(k[1])).replace(/\r\n/g,`
`),f.xlfn||(O.f=Vw(O.f)),k[0].indexOf('t="array"')>-1)O.F=(M.match(s)||[])[1],O.F.indexOf(":")>-1&&fe.push([$t(O.F),O.F]);else if(k[0].indexOf('t="shared"')>-1){b=Oe(k[0]);var _e=lt(Tt(k[1]));f.xlfn||(_e=Vw(_e)),ue[parseInt(b.si,10)]=[b,_e,v.r]}}else(k=M.match(/<f[^>]*\/>/))&&(b=Oe(k[0]),ue[b.si]&&(O.f=dU(ue[b.si][1],ue[b.si][2],v.r)));var pe=Qr(v.r);for(y=0;y<fe.length;++y)pe.r>=fe[y][0].s.r&&pe.r<=fe[y][0].e.r&&pe.c>=fe[y][0].s.c&&pe.c<=fe[y][0].e.c&&(O.F=fe[y][1])}if(v.t==null&&O.v===void 0)if(O.f||O.F)O.v=0,O.t="n";else if(j)O.t="z";else continue;else O.t=v.t||"n";switch(d.s.c>S&&(d.s.c=S),d.e.c<S&&(d.e.c=S),O.t){case"n":if(O.v==""||O.v==null){if(!j)continue;O.t="z"}else O.v=parseFloat(O.v);break;case"s":if(typeof O.v>"u"){if(!j)continue;O.t="z"}else C=Pc[parseInt(O.v,10)],O.v=C.t,O.r=C.r,f.cellHTML&&(O.h=C.h);break;case"str":O.t="s",O.v=O.v!=null?Tt(O.v):"",f.cellHTML&&(O.h=nv(O.v));break;case"inlineStr":k=M.match(n),O.t="s",k!=null&&(C=dv(k[1]))?(O.v=C.t,f.cellHTML&&(O.h=C.h)):O.v="";break;case"b":O.v=Pt(O.v);break;case"d":f.cellDates?O.v=gr(O.v,1):(O.v=tn(gr(O.v,1)),O.t="n");break;case"e":(!f||f.cellText!==!1)&&(O.w=O.v),O.v=QA[O.v];break}if(P=D=0,Z=null,ie&&v.s!==void 0&&(Z=p.CellXf[v.s],Z!=null&&(Z.numFmtId!=null&&(P=Z.numFmtId),f.cellStyles&&Z.fillId!=null&&(D=Z.fillId))),CI(O,P,D,f,m,p),f.cellDates&&ie&&O.t=="n"&&Nl($e[P])&&(O.t="d",O.v=o0(O.v)),v.cm&&f.xlmeta){var Ue=(f.xlmeta.Cell||[])[+v.cm-1];Ue&&Ue.type=="XLDAPR"&&(O.D=!0)}if(q){var H=Qr(v.r);c[H.r]||(c[H.r]=[]),c[H.r][H.c]=O}else c[v.r]=O}}}}G.length>0&&(c["!rows"]=G)}}();function n7(e,t){var r={},n=e.l+t;r.r=e.read_shift(4),e.l+=4;var s=e.read_shift(2);e.l+=1;var a=e.read_shift(1);return e.l=n,a&7&&(r.level=a&7),a&16&&(r.hidden=!0),a&32&&(r.hpt=s/20),r}var s7=fo;function a7(){}function i7(e,t){var r={},n=e[e.l];return++e.l,r.above=!(n&64),r.left=!(n&128),e.l+=18,r.name=Nj(e),r}function o7(e){var t=Xn(e);return[t]}function l7(e){var t=uo(e);return[t]}function c7(e){var t=Xn(e),r=e.read_shift(1);return[t,r,"b"]}function u7(e){var t=uo(e),r=e.read_shift(1);return[t,r,"b"]}function f7(e){var t=Xn(e),r=e.read_shift(1);return[t,r,"e"]}function h7(e){var t=uo(e),r=e.read_shift(1);return[t,r,"e"]}function d7(e){var t=Xn(e),r=e.read_shift(4);return[t,r,"s"]}function m7(e){var t=uo(e),r=e.read_shift(4);return[t,r,"s"]}function p7(e){var t=Xn(e),r=Vr(e);return[t,r,"n"]}function RI(e){var t=uo(e),r=Vr(e);return[t,r,"n"]}function g7(e){var t=Xn(e),r=uv(e);return[t,r,"n"]}function x7(e){var t=uo(e),r=uv(e);return[t,r,"n"]}function v7(e){var t=Xn(e),r=lv(e);return[t,r,"is"]}function y7(e){var t=Xn(e),r=zr(e);return[t,r,"str"]}function _7(e){var t=uo(e),r=zr(e);return[t,r,"str"]}function w7(e,t,r){var n=e.l+t,s=Xn(e);s.r=r["!row"];var a=e.read_shift(1),i=[s,a,"b"];if(r.cellFormula){e.l+=2;var o=u0(e,n-e.l,r);i[3]=Lr(o,null,s,r.supbooks,r)}else e.l=n;return i}function E7(e,t,r){var n=e.l+t,s=Xn(e);s.r=r["!row"];var a=e.read_shift(1),i=[s,a,"e"];if(r.cellFormula){e.l+=2;var o=u0(e,n-e.l,r);i[3]=Lr(o,null,s,r.supbooks,r)}else e.l=n;return i}function T7(e,t,r){var n=e.l+t,s=Xn(e);s.r=r["!row"];var a=Vr(e),i=[s,a,"n"];if(r.cellFormula){e.l+=2;var o=u0(e,n-e.l,r);i[3]=Lr(o,null,s,r.supbooks,r)}else e.l=n;return i}function k7(e,t,r){var n=e.l+t,s=Xn(e);s.r=r["!row"];var a=zr(e),i=[s,a,"str"];if(r.cellFormula){e.l+=2;var o=u0(e,n-e.l,r);i[3]=Lr(o,null,s,r.supbooks,r)}else e.l=n;return i}var S7=fo;function A7(e,t){var r=e.l+t,n=fo(e),s=cv(e),a=zr(e),i=zr(e),o=zr(e);e.l=r;var l={rfx:n,relId:s,loc:a,display:o};return i&&(l.Tooltip=i),l}function I7(){}function N7(e,t,r){var n=e.l+t,s=qA(e),a=e.read_shift(1),i=[s];if(i[2]=a,r.cellFormula){var o=DV(e,n-e.l,r);i[1]=o}else e.l=n;return i}function C7(e,t,r){var n=e.l+t,s=fo(e),a=[s];if(r.cellFormula){var i=OV(e,n-e.l,r);a[1]=i,e.l=n}else e.l=n;return a}var b7=["left","right","top","bottom","header","footer"];function R7(e){var t={};return b7.forEach(function(r){t[r]=Vr(e)}),t}function P7(e){var t=e.read_shift(2);return e.l+=28,{RTL:t&32}}function D7(){}function F7(){}function O7(e,t,r,n,s,a,i){if(!e)return e;var o=t||{};n||(n={"!id":{}});var l=o.dense?[]:{},c,f={s:{r:2e6,c:2e6},e:{r:0,c:0}},d=!1,m=!1,p,x,g,w,k,E,y,I,M,O=[];o.biff=12,o["!row"]=0;var v=0,T=!1,S=[],C={},b=o.supbooks||s.supbooks||[[]];if(b.sharedf=C,b.arrayf=S,b.SheetNames=s.SheetNames||s.Sheets.map(function(q){return q.name}),!o.supbooks&&(o.supbooks=b,s.Names))for(var P=0;P<s.Names.length;++P)b[0][P+1]=s.Names[P];var D=[],ie=[],Z=!1;pd[16]={n:"BrtShortReal",f:RI};var fe;if(ka(e,function(G,ne,ce){if(!m)switch(ce){case 148:c=G;break;case 0:p=G,o.sheetRows&&o.sheetRows<=p.r&&(m=!0),I=Ar(w=p.r),o["!row"]=p.r,(G.hidden||G.hpt||G.level!=null)&&(G.hpt&&(G.hpx=xu(G.hpt)),ie[G.r]=G);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(x={t:G[2]},G[2]){case"n":x.v=G[1];break;case"s":y=Pc[G[1]],x.v=y.t,x.r=y.r;break;case"b":x.v=!!G[1];break;case"e":x.v=G[1],o.cellText!==!1&&(x.w=ho[x.v]);break;case"str":x.t="s",x.v=G[1];break;case"is":x.t="s",x.v=G[1].t;break}if((g=i.CellXf[G[0].iStyleRef])&&CI(x,g.numFmtId,null,o,a,i),k=G[0].c==-1?k+1:G[0].c,o.dense?(l[w]||(l[w]=[]),l[w][k]=x):l[or(k)+I]=x,o.cellFormula){for(T=!1,v=0;v<S.length;++v){var j=S[v];p.r>=j[0].s.r&&p.r<=j[0].e.r&&k>=j[0].s.c&&k<=j[0].e.c&&(x.F=at(j[0]),T=!0)}!T&&G.length>3&&(x.f=G[3])}if(f.s.r>p.r&&(f.s.r=p.r),f.s.c>k&&(f.s.c=k),f.e.r<p.r&&(f.e.r=p.r),f.e.c<k&&(f.e.c=k),o.cellDates&&g&&x.t=="n"&&Nl($e[g.numFmtId])){var Y=Oi(x.v);Y&&(x.t="d",x.v=new Date(Y.y,Y.m-1,Y.d,Y.H,Y.M,Y.S,Y.u))}fe&&(fe.type=="XLDAPR"&&(x.D=!0),fe=void 0);break;case 1:case 12:if(!o.sheetStubs||d)break;x={t:"z",v:void 0},k=G[0].c==-1?k+1:G[0].c,o.dense?(l[w]||(l[w]=[]),l[w][k]=x):l[or(k)+I]=x,f.s.r>p.r&&(f.s.r=p.r),f.s.c>k&&(f.s.c=k),f.e.r<p.r&&(f.e.r=p.r),f.e.c<k&&(f.e.c=k),fe&&(fe.type=="XLDAPR"&&(x.D=!0),fe=void 0);break;case 176:O.push(G);break;case 49:fe=((o.xlmeta||{}).Cell||[])[G-1];break;case 494:var K=n["!id"][G.relId];for(K?(G.Target=K.Target,G.loc&&(G.Target+="#"+G.loc),G.Rel=K):G.relId==""&&(G.Target="#"+G.loc),w=G.rfx.s.r;w<=G.rfx.e.r;++w)for(k=G.rfx.s.c;k<=G.rfx.e.c;++k)o.dense?(l[w]||(l[w]=[]),l[w][k]||(l[w][k]={t:"z",v:void 0}),l[w][k].l=G):(E=We({c:k,r:w}),l[E]||(l[E]={t:"z",v:void 0}),l[E].l=G);break;case 426:if(!o.cellFormula)break;S.push(G),M=o.dense?l[w][k]:l[or(k)+I],M.f=Lr(G[1],f,{r:p.r,c:k},b,o),M.F=at(G[0]);break;case 427:if(!o.cellFormula)break;C[We(G[0].s)]=G[1],M=o.dense?l[w][k]:l[or(k)+I],M.f=Lr(G[1],f,{r:p.r,c:k},b,o);break;case 60:if(!o.cellStyles)break;for(;G.e>=G.s;)D[G.e--]={width:G.w/256,hidden:!!(G.flags&1),level:G.level},Z||(Z=!0,mv(G.w/256)),yl(D[G.e+1]);break;case 161:l["!autofilter"]={ref:at(G)};break;case 476:l["!margins"]=G;break;case 147:s.Sheets[r]||(s.Sheets[r]={}),G.name&&(s.Sheets[r].CodeName=G.name),(G.above||G.left)&&(l["!outline"]={above:G.above,left:G.left});break;case 137:s.Views||(s.Views=[{}]),s.Views[0]||(s.Views[0]={}),G.RTL&&(s.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:d=!0;break;case 36:d=!1;break;case 37:d=!0;break;case 38:d=!1;break;default:if(!ne.T){if(!d||o.WTF)throw new Error("Unexpected record 0x"+ce.toString(16))}}},o),delete o.supbooks,delete o["!row"],!l["!ref"]&&(f.s.r<2e6||c&&(c.e.r>0||c.e.c>0||c.s.r>0||c.s.c>0))&&(l["!ref"]=at(c||f)),o.sheetRows&&l["!ref"]){var ue=$t(l["!ref"]);o.sheetRows<=+ue.e.r&&(ue.e.r=o.sheetRows-1,ue.e.r>f.e.r&&(ue.e.r=f.e.r),ue.e.r<ue.s.r&&(ue.s.r=ue.e.r),ue.e.c>f.e.c&&(ue.e.c=f.e.c),ue.e.c<ue.s.c&&(ue.s.c=ue.e.c),l["!fullref"]=l["!ref"],l["!ref"]=at(ue))}return O.length>0&&(l["!merges"]=O),D.length>0&&(l["!cols"]=D),ie.length>0&&(l["!rows"]=ie),l}function M7(e){var t=[],r=e.match(/^<c:numCache>/),n;(e.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(a){var i=a.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);i&&(t[+i[1]]=r?+i[2]:i[2])});var s=lt((e.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(e.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(a){n=a.replace(/<.*?>/g,"")}),[t,s,n]}function L7(e,t,r,n,s,a){var i=a||{"!type":"chart"};if(!e)return a;var o=0,l=0,c="A",f={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(e.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(d){var m=M7(d);f.s.r=f.s.c=0,f.e.c=o,c=or(o),m[0].forEach(function(p,x){i[c+Ar(x)]={t:"n",v:p,z:m[1]},l=x}),f.e.r<l&&(f.e.r=l),++o}),o>0&&(i["!ref"]=at(f)),i}function j7(e,t,r,n,s){if(!e)return e;n||(n={"!id":{}});var a={"!type":"chart","!drawel":null,"!rel":""},i,o=e.match(bI);return o&&gv(o[0],a,s,r),(i=e.match(/drawing r:id="(.*?)"/))&&(a["!rel"]=i[1]),n["!id"][a["!rel"]]&&(a["!drawel"]=n["!id"][a["!rel"]]),a}function U7(e,t){e.l+=10;var r=zr(e);return{name:r}}function V7(e,t,r,n,s){if(!e)return e;n||(n={"!id":{}});var a={"!type":"chart","!drawel":null,"!rel":""},i=!1;return ka(e,function(l,c,f){switch(f){case 550:a["!rel"]=l;break;case 651:s.Sheets[r]||(s.Sheets[r]={}),l.name&&(s.Sheets[r].CodeName=l.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:i=!0;break;case 36:i=!1;break;case 37:break;case 38:break;default:if(!(c.T>0)){if(!(c.T<0)){if(!i||t.WTF)throw new Error("Unexpected record 0x"+f.toString(16))}}}},t),n["!id"][a["!rel"]]&&(a["!drawel"]=n["!id"][a["!rel"]]),a}var PI=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],B7=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],W7=[],z7=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function Hw(e,t){for(var r=0;r!=e.length;++r)for(var n=e[r],s=0;s!=t.length;++s){var a=t[s];if(n[a[0]]==null)n[a[0]]=a[1];else switch(a[2]){case"bool":typeof n[a[0]]=="string"&&(n[a[0]]=Pt(n[a[0]]));break;case"int":typeof n[a[0]]=="string"&&(n[a[0]]=parseInt(n[a[0]],10));break}}}function Gw(e,t){for(var r=0;r!=t.length;++r){var n=t[r];if(e[n[0]]==null)e[n[0]]=n[1];else switch(n[2]){case"bool":typeof e[n[0]]=="string"&&(e[n[0]]=Pt(e[n[0]]));break;case"int":typeof e[n[0]]=="string"&&(e[n[0]]=parseInt(e[n[0]],10));break}}}function DI(e){Gw(e.WBProps,PI),Gw(e.CalcPr,z7),Hw(e.WBView,B7),Hw(e.Sheets,W7),el.date1904=Pt(e.WBProps.date1904)}var $7="][*?/\\".split("");function H7(e,t){if(e.length>31)throw new Error("Sheet names cannot exceed 31 chars");var r=!0;return $7.forEach(function(n){if(e.indexOf(n)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),r}var G7=/<\w+:workbook/;function K7(e,t){if(!e)throw new Error("Could not find file");var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},n=!1,s="xmlns",a={},i=0;if(e.replace(Kr,function(l,c){var f=Oe(l);switch(Vs(f[0])){case"<?xml":break;case"<workbook":l.match(G7)&&(s="xmlns"+l.match(/<(\w+):/)[1]),r.xmlns=f[s];break;case"</workbook>":break;case"<fileVersion":delete f[0],r.AppVersion=f;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":PI.forEach(function(d){if(f[d[0]]!=null)switch(d[2]){case"bool":r.WBProps[d[0]]=Pt(f[d[0]]);break;case"int":r.WBProps[d[0]]=parseInt(f[d[0]],10);break;default:r.WBProps[d[0]]=f[d[0]]}}),f.codeName&&(r.WBProps.CodeName=Tt(f.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete f[0],r.WBView.push(f);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(f.state){case"hidden":f.Hidden=1;break;case"veryHidden":f.Hidden=2;break;default:f.Hidden=0}delete f.state,f.name=lt(Tt(f.name)),delete f[0],r.Sheets.push(f);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":n=!0;break;case"</definedNames>":n=!1;break;case"<definedName":a={},a.Name=Tt(f.name),f.comment&&(a.Comment=f.comment),f.localSheetId&&(a.Sheet=+f.localSheetId),Pt(f.hidden||"0")&&(a.Hidden=!0),i=c+l.length;break;case"</definedName>":a.Ref=lt(Tt(e.slice(i,c))),r.Names.push(a);break;case"<definedName/>":break;case"<calcPr":delete f[0],r.CalcPr=f;break;case"<calcPr/>":delete f[0],r.CalcPr=f;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":n=!0;break;case"</AlternateContent>":n=!1;break;case"<revisionPtr":break;default:if(!n&&t.WTF)throw new Error("unrecognized "+f[0]+" in workbook")}return l}),fj.indexOf(r.xmlns)===-1)throw new Error("Unknown Namespace: "+r.xmlns);return DI(r),r}function q7(e,t){var r={};return r.Hidden=e.read_shift(4),r.iTabID=e.read_shift(4),r.strRelID=Vp(e),r.name=zr(e),r}function Y7(e,t){var r={},n=e.read_shift(4);r.defaultThemeVersion=e.read_shift(4);var s=t>8?zr(e):"";return s.length>0&&(r.CodeName=s),r.autoCompressPictures=!!(n&65536),r.backupFile=!!(n&64),r.checkCompatibility=!!(n&4096),r.date1904=!!(n&1),r.filterPrivacy=!!(n&8),r.hidePivotFieldList=!!(n&1024),r.promptedSolutions=!!(n&16),r.publishItems=!!(n&2048),r.refreshAllConnections=!!(n&262144),r.saveExternalLinkValues=!!(n&128),r.showBorderUnselectedTables=!!(n&4),r.showInkAnnotation=!!(n&32),r.showObjects=["all","placeholders","none"][n>>13&3],r.showPivotChartFilter=!!(n&32768),r.updateLinks=["userSet","never","always"][n>>8&3],r}function X7(e,t){var r={};return e.read_shift(4),r.ArchID=e.read_shift(4),e.l+=t-8,r}function Q7(e,t,r){var n=e.l+t;e.l+=4,e.l+=1;var s=e.read_shift(4),a=Cj(e),i=FV(e,0,r),o=cv(e);e.l=n;var l={Name:a,Ptg:i};return s<268435455&&(l.Sheet=s),o&&(l.Comment=o),l}function J7(e,t){var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},n=[],s=!1;t||(t={}),t.biff=12;var a=[],i=[[]];return i.SheetNames=[],i.XTI=[],pd[16]={n:"BrtFRTArchID$",f:X7},ka(e,function(l,c,f){switch(f){case 156:i.SheetNames.push(l.name),r.Sheets.push(l);break;case 153:r.WBProps=l;break;case 39:l.Sheet!=null&&(t.SID=l.Sheet),l.Ref=Lr(l.Ptg,null,null,i,t),delete t.SID,delete l.Ptg,a.push(l);break;case 1036:break;case 357:case 358:case 355:case 667:i[0].length?i.push([f,l]):i[0]=[f,l],i[i.length-1].XTI=[];break;case 362:i.length===0&&(i[0]=[],i[0].XTI=[]),i[i.length-1].XTI=i[i.length-1].XTI.concat(l),i.XTI=i.XTI.concat(l);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:n.push(f),s=!0;break;case 36:n.pop(),s=!1;break;case 37:n.push(f),s=!0;break;case 38:n.pop(),s=!1;break;case 16:break;default:if(!c.T){if(!s||t.WTF&&n[n.length-1]!=37&&n[n.length-1]!=35)throw new Error("Unexpected record 0x"+f.toString(16))}}},t),DI(r),r.Names=a,r.supbooks=i,r}function Z7(e,t,r){return t.slice(-4)===".bin"?J7(e,r):K7(e,r)}function eB(e,t,r,n,s,a,i,o){return t.slice(-4)===".bin"?O7(e,n,r,s,a,i,o):qV(e,n,r,s,a,i,o)}function tB(e,t,r,n,s,a,i,o){return t.slice(-4)===".bin"?V7(e,n,r,s,a):j7(e,n,r,s,a)}function rB(e,t,r,n,s,a,i,o){return t.slice(-4)===".bin"?uU():fU()}function nB(e,t,r,n,s,a,i,o){return t.slice(-4)===".bin"?lU():cU()}function sB(e,t,r,n){return t.slice(-4)===".bin"?S9(e,r,n):y9(e,r,n)}function aB(e,t,r){return yI(e,r)}function iB(e,t,r){return t.slice(-4)===".bin"?B5(e,r):U5(e,r)}function oB(e,t,r){return t.slice(-4)===".bin"?aU(e,r):eU(e,r)}function lB(e,t,r){return t.slice(-4)===".bin"?Q9(e):Y9(e)}function cB(e,t,r,n){return r.slice(-4)===".bin"?J9(e,t,r,n):void 0}function uB(e,t,r){return t.slice(-4)===".bin"?K9(e,t,r):q9(e,t,r)}var FI=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,OI=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function es(e,t){var r=e.split(/\s+/),n=[];if(n[0]=r[0],r.length===1)return n;var s=e.match(FI),a,i,o,l;if(s)for(l=0;l!=s.length;++l)a=s[l].match(OI),(i=a[1].indexOf(":"))===-1?n[a[1]]=a[2].slice(1,a[2].length-1):(a[1].slice(0,6)==="xmlns:"?o="xmlns"+a[1].slice(6):o=a[1].slice(i+1),n[o]=a[2].slice(1,a[2].length-1));return n}function fB(e){var t=e.split(/\s+/),r={};if(t.length===1)return r;var n=e.match(FI),s,a,i,o;if(n)for(o=0;o!=n.length;++o)s=n[o].match(OI),(a=s[1].indexOf(":"))===-1?r[s[1]]=s[2].slice(1,s[2].length-1):(s[1].slice(0,6)==="xmlns:"?i="xmlns"+s[1].slice(6):i=s[1].slice(a+1),r[i]=s[2].slice(1,s[2].length-1));return r}var Fc;function hB(e,t){var r=Fc[e]||lt(e);return r==="General"?Zi(t):Yn(r,t)}function dB(e,t,r,n){var s=n;switch((r[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":s=Pt(n);break;case"i2":case"int":s=parseInt(n,10);break;case"r4":case"float":s=parseFloat(n);break;case"date":case"dateTime.tz":s=gr(n);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+r[0])}e[lt(t)]=s}function mB(e,t,r){if(e.t!=="z"){if(!r||r.cellText!==!1)try{e.t==="e"?e.w=e.w||ho[e.v]:t==="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=hu(e.v):e.w=Zi(e.v):e.w=hB(t||"General",e.v)}catch(a){if(r.WTF)throw a}try{var n=Fc[t]||t||"General";if(r.cellNF&&(e.z=n),r.cellDates&&e.t=="n"&&Nl(n)){var s=Oi(e.v);s&&(e.t="d",e.v=new Date(s.y,s.m-1,s.d,s.H,s.M,s.S,s.u))}}catch(a){if(r.WTF)throw a}}}function pB(e,t,r){if(r.cellStyles&&t.Interior){var n=t.Interior;n.Pattern&&(n.patternType=d9[n.Pattern]||n.Pattern)}e[t.ID]=t}function gB(e,t,r,n,s,a,i,o,l,c){var f="General",d=n.StyleID,m={};c=c||{};var p=[],x=0;for(d===void 0&&o&&(d=o.StyleID),d===void 0&&i&&(d=i.StyleID);a[d]!==void 0&&(a[d].nf&&(f=a[d].nf),a[d].Interior&&p.push(a[d].Interior),!!a[d].Parent);)d=a[d].Parent;switch(r.Type){case"Boolean":n.t="b",n.v=Pt(e);break;case"String":n.t="s",n.r=mw(lt(e)),n.v=e.indexOf("<")>-1?lt(t||e).replace(/<.*?>/g,""):n.r;break;case"DateTime":e.slice(-1)!="Z"&&(e+="Z"),n.v=(gr(e)-new Date(Date.UTC(1899,11,30)))/(24*60*60*1e3),n.v!==n.v?n.v=lt(e):n.v<60&&(n.v=n.v-1),(!f||f=="General")&&(f="yyyy-mm-dd");case"Number":n.v===void 0&&(n.v=+e),n.t||(n.t="n");break;case"Error":n.t="e",n.v=QA[e],c.cellText!==!1&&(n.w=e);break;default:e==""&&t==""?n.t="z":(n.t="s",n.v=mw(t||e));break}if(mB(n,f,c),c.cellFormula!==!1)if(n.Formula){var g=lt(n.Formula);g.charCodeAt(0)==61&&(g=g.slice(1)),n.f=Zo(g,s),delete n.Formula,n.ArrayRange=="RC"?n.F=Zo("RC:RC",s):n.ArrayRange&&(n.F=Zo(n.ArrayRange,s),l.push([$t(n.F),n.F]))}else for(x=0;x<l.length;++x)s.r>=l[x][0].s.r&&s.r<=l[x][0].e.r&&s.c>=l[x][0].s.c&&s.c<=l[x][0].e.c&&(n.F=l[x][1]);c.cellStyles&&(p.forEach(function(w){!m.patternType&&w.patternType&&(m.patternType=w.patternType)}),n.s=m),n.StyleID!==void 0&&(n.ixfe=n.StyleID)}function xB(e){e.t=e.v||"",e.t=e.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.v=e.w=e.ixfe=void 0}function um(e,t){var r=t||{};TA();var n=oc(sv(e));(r.type=="binary"||r.type=="array"||r.type=="base64")&&(n=Tt(n));var s=n.slice(0,1024).toLowerCase(),a=!1;if(s=s.replace(/".*?"/g,""),(s.indexOf(">")&1023)>Math.min(s.indexOf(",")&1023,s.indexOf(";")&1023)){var i=Sr(r);return i.type="string",pu.to_workbook(n,i)}if(s.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(_t){s.indexOf("<"+_t)>=0&&(a=!0)}),a)return AB(n,r);Fc={"General Number":"General","General Date":$e[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":$e[15],"Short Date":$e[14],"Long Time":$e[19],"Medium Time":$e[18],"Short Time":$e[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:$e[2],Standard:$e[4],Percent:$e[10],Scientific:$e[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var o,l=[],c,f={},d=[],m=r.dense?[]:{},p="",x={},g={},w=es('<Data ss:Type="String">'),k=0,E=0,y=0,I={s:{r:2e6,c:2e6},e:{r:0,c:0}},M={},O={},v="",T=0,S=[],C={},b={},P=0,D=[],ie=[],Z={},fe=[],ue,q=!1,G=[],ne=[],ce={},j=0,Y=0,K={Sheets:[],WBProps:{date1904:!1}},V={};mu.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"");for(var J="";o=mu.exec(n);)switch(o[3]=(J=o[3]).toLowerCase()){case"data":if(J=="data"){if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&l.push([o[3],!0]);break}if(l[l.length-1][1])break;o[1]==="/"?gB(n.slice(k,o.index),v,w,l[l.length-1][0]=="comment"?Z:x,{c:E,r:y},M,fe[E],g,G,r):(v="",w=es(o[0]),k=o.index+o[0].length);break;case"cell":if(o[1]==="/")if(ie.length>0&&(x.c=ie),(!r.sheetRows||r.sheetRows>y)&&x.v!==void 0&&(r.dense?(m[y]||(m[y]=[]),m[y][E]=x):m[or(E)+Ar(y)]=x),x.HRef&&(x.l={Target:lt(x.HRef)},x.HRefScreenTip&&(x.l.Tooltip=x.HRefScreenTip),delete x.HRef,delete x.HRefScreenTip),(x.MergeAcross||x.MergeDown)&&(j=E+(parseInt(x.MergeAcross,10)|0),Y=y+(parseInt(x.MergeDown,10)|0),S.push({s:{c:E,r:y},e:{c:j,r:Y}})),!r.sheetStubs)x.MergeAcross?E=j+1:++E;else if(x.MergeAcross||x.MergeDown){for(var de=E;de<=j;++de)for(var Ee=y;Ee<=Y;++Ee)(de>E||Ee>y)&&(r.dense?(m[Ee]||(m[Ee]=[]),m[Ee][de]={t:"z"}):m[or(de)+Ar(Ee)]={t:"z"});E=j+1}else++E;else x=fB(o[0]),x.Index&&(E=+x.Index-1),E<I.s.c&&(I.s.c=E),E>I.e.c&&(I.e.c=E),o[0].slice(-2)==="/>"&&++E,ie=[];break;case"row":o[1]==="/"||o[0].slice(-2)==="/>"?(y<I.s.r&&(I.s.r=y),y>I.e.r&&(I.e.r=y),o[0].slice(-2)==="/>"&&(g=es(o[0]),g.Index&&(y=+g.Index-1)),E=0,++y):(g=es(o[0]),g.Index&&(y=+g.Index-1),ce={},(g.AutoFitHeight=="0"||g.Height)&&(ce.hpx=parseInt(g.Height,10),ce.hpt=vI(ce.hpx),ne[y]=ce),g.Hidden=="1"&&(ce.hidden=!0,ne[y]=ce));break;case"worksheet":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"));d.push(p),I.s.r<=I.e.r&&I.s.c<=I.e.c&&(m["!ref"]=at(I),r.sheetRows&&r.sheetRows<=I.e.r&&(m["!fullref"]=m["!ref"],I.e.r=r.sheetRows-1,m["!ref"]=at(I))),S.length&&(m["!merges"]=S),fe.length>0&&(m["!cols"]=fe),ne.length>0&&(m["!rows"]=ne),f[p]=m}else I={s:{r:2e6,c:2e6},e:{r:0,c:0}},y=E=0,l.push([o[3],!1]),c=es(o[0]),p=lt(c.Name),m=r.dense?[]:{},S=[],G=[],ne=[],V={name:p,Hidden:0},K.Sheets.push(V);break;case"table":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else{if(o[0].slice(-2)=="/>")break;l.push([o[3],!1]),fe=[],q=!1}break;case"style":o[1]==="/"?pB(M,O,r):O=es(o[0]);break;case"numberformat":O.nf=lt(es(o[0]).Format||"General"),Fc[O.nf]&&(O.nf=Fc[O.nf]);for(var _e=0;_e!=392&&$e[_e]!=O.nf;++_e);if(_e==392){for(_e=57;_e!=392;++_e)if($e[_e]==null){Bi(O.nf,_e);break}}break;case"column":if(l[l.length-1][0]!=="table")break;if(ue=es(o[0]),ue.Hidden&&(ue.hidden=!0,delete ue.Hidden),ue.Width&&(ue.wpx=parseInt(ue.Width,10)),!q&&ue.wpx>10){q=!0,Xr=gI;for(var pe=0;pe<fe.length;++pe)fe[pe]&&yl(fe[pe])}q&&yl(ue),fe[ue.Index-1||fe.length]=ue;for(var Ue=0;Ue<+ue.Span;++Ue)fe[fe.length]=Sr(ue);break;case"namedrange":if(o[1]==="/")break;K.Names||(K.Names=[]);var H=Oe(o[0]),tt={Name:H.Name,Ref:Zo(H.RefersTo.slice(1),{r:0,c:0})};K.Sheets.length>0&&(tt.Sheet=K.Sheets.length-1),K.Names.push(tt);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(o[0].slice(-2)==="/>")break;o[1]==="/"?v+=n.slice(T,o.index):T=o.index+o[0].length;break;case"interior":if(!r.cellStyles)break;O.Interior=es(o[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(o[0].slice(-2)==="/>")break;o[1]==="/"?e8(C,J,n.slice(P,o.index)):P=o.index+o[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else l.push([o[3],!1]);break;case"comment":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"));xB(Z),ie.push(Z)}else l.push([o[3],!1]),c=es(o[0]),Z={a:c.Author};break;case"autofilter":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else if(o[0].charAt(o[0].length-2)!=="/"){var He=es(o[0]);m["!autofilter"]={ref:Zo(He.Range).replace(/\$/g,"")},l.push([o[3],!0])}break;case"name":break;case"datavalidation":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&l.push([o[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&l.push([o[3],!0]);break;case"null":break;default:if(l.length==0&&o[3]=="document"||l.length==0&&o[3]=="uof")return Jw(n,r);var Je=!0;switch(l[l.length-1][0]){case"officedocumentsettings":switch(o[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:Je=!1}break;case"componentoptions":switch(o[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:Je=!1}break;case"excelworkbook":switch(o[3]){case"date1904":K.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:Je=!1}break;case"workbookoptions":switch(o[3]){case"owcversion":break;case"height":break;case"width":break;default:Je=!1}break;case"worksheetoptions":switch(o[3]){case"visible":if(o[0].slice(-2)!=="/>")if(o[1]==="/")switch(n.slice(P,o.index)){case"SheetHidden":V.Hidden=1;break;case"SheetVeryHidden":V.Hidden=2;break}else P=o.index+o[0].length;break;case"header":m["!margins"]||Dc(m["!margins"]={},"xlml"),isNaN(+Oe(o[0]).Margin)||(m["!margins"].header=+Oe(o[0]).Margin);break;case"footer":m["!margins"]||Dc(m["!margins"]={},"xlml"),isNaN(+Oe(o[0]).Margin)||(m["!margins"].footer=+Oe(o[0]).Margin);break;case"pagemargins":var De=Oe(o[0]);m["!margins"]||Dc(m["!margins"]={},"xlml"),isNaN(+De.Top)||(m["!margins"].top=+De.Top),isNaN(+De.Left)||(m["!margins"].left=+De.Left),isNaN(+De.Right)||(m["!margins"].right=+De.Right),isNaN(+De.Bottom)||(m["!margins"].bottom=+De.Bottom);break;case"displayrighttoleft":K.Views||(K.Views=[]),K.Views[0]||(K.Views[0]={}),K.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":m["!outline"]||(m["!outline"]={}),m["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":m["!outline"]||(m["!outline"]={}),m["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:Je=!1}break;case"pivottable":case"pivotcache":switch(o[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:Je=!1}break;case"pagebreaks":switch(o[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:Je=!1}break;case"autofilter":switch(o[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:Je=!1}break;case"querytable":switch(o[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:Je=!1}break;case"datavalidation":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:Je=!1}break;case"sorting":case"conditionalformatting":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:Je=!1}break;case"mapinfo":case"schema":case"data":switch(o[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:Je=!1}break;case"smarttags":break;default:Je=!1;break}if(Je||o[3].match(/!\[CDATA/))break;if(!l[l.length-1][1])throw"Unrecognized tag: "+o[3]+"|"+l.join("|");if(l[l.length-1][0]==="customdocumentproperties"){if(o[0].slice(-2)==="/>")break;o[1]==="/"?dB(b,J,D,n.slice(P,o.index)):(D=o,P=o.index+o[0].length);break}if(r.WTF)throw"Unrecognized tag: "+o[3]+"|"+l.join("|")}var Ae={};return!r.bookSheets&&!r.bookProps&&(Ae.Sheets=f),Ae.SheetNames=d,Ae.Workbook=K,Ae.SSF=Sr($e),Ae.Props=C,Ae.Custprops=b,Ae}function $p(e,t){switch(yv(t=t||{}),t.type||"base64"){case"base64":return um(bn(e),t);case"binary":case"buffer":case"file":return um(e,t);case"array":return um(co(e),t)}}function vB(e){var t={},r=e.content;if(r.l=28,t.AnsiUserType=r.read_shift(0,"lpstr-ansi"),t.AnsiClipboardFormat=Pj(r),r.length-r.l<=4)return t;var n=r.read_shift(4);if(n==0||n>40||(r.l-=4,t.Reserved1=r.read_shift(0,"lpstr-ansi"),r.length-r.l<=4)||(n=r.read_shift(4),n!==1907505652)||(t.UnicodeClipboardFormat=Dj(r),n=r.read_shift(4),n==0||n>40))return t;r.l-=4,t.Reserved2=r.read_shift(0,"lpwstr")}var yB=[60,1084,2066,2165,2175];function _B(e,t,r,n,s){var a=n,i=[],o=r.slice(r.l,r.l+a);if(s&&s.enc&&s.enc.insitu&&o.length>0)switch(e){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:s.enc.insitu(o)}i.push(o),r.l+=a;for(var l=sa(r,r.l),c=Hp[l],f=0;c!=null&&yB.indexOf(l)>-1;)a=sa(r,r.l+2),f=r.l+4,l==2066?f+=4:(l==2165||l==2175)&&(f+=12),o=r.slice(f,r.l+4+a),i.push(o),r.l+=4+a,c=Hp[l=sa(r,r.l)];var d=Va(i);wr(d,0);var m=0;d.lens=[];for(var p=0;p<i.length;++p)d.lens.push(m),m+=i[p].length;if(d.length<n)throw"XLS Record 0x"+e.toString(16)+" Truncated: "+d.length+" < "+n;return t.f(d,d.length,s)}function ws(e,t,r){if(e.t!=="z"&&e.XF){var n=0;try{n=e.z||e.XF.numFmtId||0,t.cellNF&&(e.z=$e[n])}catch(a){if(t.WTF)throw a}if(!t||t.cellText!==!1)try{e.t==="e"?e.w=e.w||ho[e.v]:n===0||n=="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=hu(e.v):e.w=Zi(e.v):e.w=Yn(n,e.v,{date1904:!!r,dateNF:t&&t.dateNF})}catch(a){if(t.WTF)throw a}if(t.cellDates&&n&&e.t=="n"&&Nl($e[n]||String(n))){var s=Oi(e.v);s&&(e.t="d",e.v=new Date(s.y,s.m-1,s.d,s.H,s.M,s.S,s.u))}}}function Wf(e,t,r){return{v:e,ixfe:t,t:r}}function wB(e,t){var r={opts:{}},n={},s=t.dense?[]:{},a={},i={},o=null,l=[],c="",f={},d,m="",p,x,g,w,k={},E=[],y,I,M=[],O=[],v={Sheets:[],WBProps:{date1904:!1},Views:[{}]},T={},S=function(Ve){return Ve<8?Wi[Ve]:Ve<64&&O[Ve-8]||Wi[Ve]},C=function(Ve,yt,Yt){var ft=yt.XF.data;if(!(!ft||!ft.patternType||!Yt||!Yt.cellStyles)){yt.s={},yt.s.patternType=ft.patternType;var vn;(vn=gu(S(ft.icvFore)))&&(yt.s.fgColor={rgb:vn}),(vn=gu(S(ft.icvBack)))&&(yt.s.bgColor={rgb:vn})}},b=function(Ve,yt,Yt){if(!(ce>1)&&!(Yt.sheetRows&&Ve.r>=Yt.sheetRows)){if(Yt.cellStyles&&yt.XF&&yt.XF.data&&C(Ve,yt,Yt),delete yt.ixfe,delete yt.XF,d=Ve,m=We(Ve),(!i||!i.s||!i.e)&&(i={s:{r:0,c:0},e:{r:0,c:0}}),Ve.r<i.s.r&&(i.s.r=Ve.r),Ve.c<i.s.c&&(i.s.c=Ve.c),Ve.r+1>i.e.r&&(i.e.r=Ve.r+1),Ve.c+1>i.e.c&&(i.e.c=Ve.c+1),Yt.cellFormula&&yt.f){for(var ft=0;ft<E.length;++ft)if(!(E[ft][0].s.c>Ve.c||E[ft][0].s.r>Ve.r)&&!(E[ft][0].e.c<Ve.c||E[ft][0].e.r<Ve.r)){yt.F=at(E[ft][0]),(E[ft][0].s.c!=Ve.c||E[ft][0].s.r!=Ve.r)&&delete yt.f,yt.f&&(yt.f=""+Lr(E[ft][1],i,Ve,G,P));break}}Yt.dense?(s[Ve.r]||(s[Ve.r]=[]),s[Ve.r][Ve.c]=yt):s[m]=yt}},P={enc:!1,sbcch:0,snames:[],sharedf:k,arrayf:E,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!t&&!!t.cellStyles,WTF:!!t&&!!t.wtf};t.password&&(P.password=t.password);var D,ie=[],Z=[],fe=[],ue=[],q=!1,G=[];G.SheetNames=P.snames,G.sharedf=P.sharedf,G.arrayf=P.arrayf,G.names=[],G.XTI=[];var ne=0,ce=0,j=0,Y=[],K=[],V;P.codepage=1200,cs(1200);for(var J=!1;e.l<e.length-1;){var de=e.l,Ee=e.read_shift(2);if(Ee===0&&ne===10)break;var _e=e.l===e.length?0:e.read_shift(2),pe=Hp[Ee];if(pe&&pe.f){if(t.bookSheets&&ne===133&&Ee!==133)break;if(ne=Ee,pe.r===2||pe.r==12){var Ue=e.read_shift(2);if(_e-=2,!P.enc&&Ue!==Ee&&((Ue&255)<<8|Ue>>8)!==Ee)throw new Error("rt mismatch: "+Ue+"!="+Ee);pe.r==12&&(e.l+=10,_e-=10)}var H={};if(Ee===10?H=pe.f(e,_e,P):H=_B(Ee,pe,e,_e,P),ce==0&&[9,521,1033,2057].indexOf(ne)===-1)continue;switch(Ee){case 34:r.opts.Date1904=v.WBProps.date1904=H;break;case 134:r.opts.WriteProtect=!0;break;case 47:if(P.enc||(e.l=0),P.enc=H,!t.password)throw new Error("File is password-protected");if(H.valid==null)throw new Error("Encryption scheme unsupported");if(!H.valid)throw new Error("Password is incorrect");break;case 92:P.lastuser=H;break;case 66:var tt=Number(H);switch(tt){case 21010:tt=1200;break;case 32768:tt=1e4;break;case 32769:tt=1252;break}cs(P.codepage=tt),J=!0;break;case 317:P.rrtabid=H;break;case 25:P.winlocked=H;break;case 439:r.opts.RefreshAll=H;break;case 12:r.opts.CalcCount=H;break;case 16:r.opts.CalcDelta=H;break;case 17:r.opts.CalcIter=H;break;case 13:r.opts.CalcMode=H;break;case 14:r.opts.CalcPrecision=H;break;case 95:r.opts.CalcSaveRecalc=H;break;case 15:P.CalcRefMode=H;break;case 2211:r.opts.FullCalc=H;break;case 129:H.fDialog&&(s["!type"]="dialog"),H.fBelow||((s["!outline"]||(s["!outline"]={})).above=!0),H.fRight||((s["!outline"]||(s["!outline"]={})).left=!0);break;case 224:M.push(H);break;case 430:G.push([H]),G[G.length-1].XTI=[];break;case 35:case 547:G[G.length-1].push(H);break;case 24:case 536:V={Name:H.Name,Ref:Lr(H.rgce,i,null,G,P)},H.itab>0&&(V.Sheet=H.itab-1),G.names.push(V),G[0]||(G[0]=[],G[0].XTI=[]),G[G.length-1].push(H),H.Name=="_xlnm._FilterDatabase"&&H.itab>0&&H.rgce&&H.rgce[0]&&H.rgce[0][0]&&H.rgce[0][0][0]=="PtgArea3d"&&(K[H.itab-1]={ref:at(H.rgce[0][0][1][2])});break;case 22:P.ExternCount=H;break;case 23:G.length==0&&(G[0]=[],G[0].XTI=[]),G[G.length-1].XTI=G[G.length-1].XTI.concat(H),G.XTI=G.XTI.concat(H);break;case 2196:if(P.biff<8)break;V!=null&&(V.Comment=H[1]);break;case 18:s["!protect"]=H;break;case 19:H!==0&&P.WTF&&console.error("Password verifier: "+H);break;case 133:a[H.pos]=H,P.snames.push(H.name);break;case 10:{if(--ce)break;if(i.e){if(i.e.r>0&&i.e.c>0){if(i.e.r--,i.e.c--,s["!ref"]=at(i),t.sheetRows&&t.sheetRows<=i.e.r){var He=i.e.r;i.e.r=t.sheetRows-1,s["!fullref"]=s["!ref"],s["!ref"]=at(i),i.e.r=He}i.e.r++,i.e.c++}ie.length>0&&(s["!merges"]=ie),Z.length>0&&(s["!objects"]=Z),fe.length>0&&(s["!cols"]=fe),ue.length>0&&(s["!rows"]=ue),v.Sheets.push(T)}c===""?f=s:n[c]=s,s=t.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(P.biff===8&&(P.biff={9:2,521:3,1033:4}[Ee]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[H.BIFFVer]||8),P.biffguess=H.BIFFVer==0,H.BIFFVer==0&&H.dt==4096&&(P.biff=5,J=!0,cs(P.codepage=28591)),P.biff==8&&H.BIFFVer==0&&H.dt==16&&(P.biff=2),ce++)break;if(s=t.dense?[]:{},P.biff<8&&!J&&(J=!0,cs(P.codepage=t.codepage||1252)),P.biff<5||H.BIFFVer==0&&H.dt==4096){c===""&&(c="Sheet1"),i={s:{r:0,c:0},e:{r:0,c:0}};var Je={pos:e.l-_e,name:c};a[Je.pos]=Je,P.snames.push(c)}else c=(a[de]||{name:""}).name;H.dt==32&&(s["!type"]="chart"),H.dt==64&&(s["!type"]="macro"),ie=[],Z=[],P.arrayf=E=[],fe=[],ue=[],q=!1,T={Hidden:(a[de]||{hs:0}).hs,name:c}}break;case 515:case 3:case 2:s["!type"]=="chart"&&(t.dense?(s[H.r]||[])[H.c]:s[We({c:H.c,r:H.r})])&&++H.c,y={ixfe:H.ixfe,XF:M[H.ixfe]||{},v:H.val,t:"n"},j>0&&(y.z=Y[y.ixfe>>8&63]),ws(y,t,r.opts.Date1904),b({c:H.c,r:H.r},y,t);break;case 5:case 517:y={ixfe:H.ixfe,XF:M[H.ixfe],v:H.val,t:H.t},j>0&&(y.z=Y[y.ixfe>>8&63]),ws(y,t,r.opts.Date1904),b({c:H.c,r:H.r},y,t);break;case 638:y={ixfe:H.ixfe,XF:M[H.ixfe],v:H.rknum,t:"n"},j>0&&(y.z=Y[y.ixfe>>8&63]),ws(y,t,r.opts.Date1904),b({c:H.c,r:H.r},y,t);break;case 189:for(var De=H.c;De<=H.C;++De){var Ae=H.rkrec[De-H.c][0];y={ixfe:Ae,XF:M[Ae],v:H.rkrec[De-H.c][1],t:"n"},j>0&&(y.z=Y[y.ixfe>>8&63]),ws(y,t,r.opts.Date1904),b({c:De,r:H.r},y,t)}break;case 6:case 518:case 1030:{if(H.val=="String"){o=H;break}if(y=Wf(H.val,H.cell.ixfe,H.tt),y.XF=M[y.ixfe],t.cellFormula){var _t=H.formula;if(_t&&_t[0]&&_t[0][0]&&_t[0][0][0]=="PtgExp"){var ur=_t[0][0][1][0],Cr=_t[0][0][1][1],sn=We({r:ur,c:Cr});k[sn]?y.f=""+Lr(H.formula,i,H.cell,G,P):y.F=((t.dense?(s[ur]||[])[Cr]:s[sn])||{}).F}else y.f=""+Lr(H.formula,i,H.cell,G,P)}j>0&&(y.z=Y[y.ixfe>>8&63]),ws(y,t,r.opts.Date1904),b(H.cell,y,t),o=H}break;case 7:case 519:if(o)o.val=H,y=Wf(H,o.cell.ixfe,"s"),y.XF=M[y.ixfe],t.cellFormula&&(y.f=""+Lr(o.formula,i,o.cell,G,P)),j>0&&(y.z=Y[y.ixfe>>8&63]),ws(y,t,r.opts.Date1904),b(o.cell,y,t),o=null;else throw new Error("String record expects Formula");break;case 33:case 545:{E.push(H);var Ws=We(H[0].s);if(p=t.dense?(s[H[0].s.r]||[])[H[0].s.c]:s[Ws],t.cellFormula&&p){if(!o||!Ws||!p)break;p.f=""+Lr(H[1],i,H[0],G,P),p.F=at(H[0])}}break;case 1212:{if(!t.cellFormula)break;if(m){if(!o)break;k[We(o.cell)]=H[0],p=t.dense?(s[o.cell.r]||[])[o.cell.c]:s[We(o.cell)],(p||{}).f=""+Lr(H[0],i,d,G,P)}}break;case 253:y=Wf(l[H.isst].t,H.ixfe,"s"),l[H.isst].h&&(y.h=l[H.isst].h),y.XF=M[y.ixfe],j>0&&(y.z=Y[y.ixfe>>8&63]),ws(y,t,r.opts.Date1904),b({c:H.c,r:H.r},y,t);break;case 513:t.sheetStubs&&(y={ixfe:H.ixfe,XF:M[H.ixfe],t:"z"},j>0&&(y.z=Y[y.ixfe>>8&63]),ws(y,t,r.opts.Date1904),b({c:H.c,r:H.r},y,t));break;case 190:if(t.sheetStubs)for(var an=H.c;an<=H.C;++an){var kt=H.ixfe[an-H.c];y={ixfe:kt,XF:M[kt],t:"z"},j>0&&(y.z=Y[y.ixfe>>8&63]),ws(y,t,r.opts.Date1904),b({c:an,r:H.r},y,t)}break;case 214:case 516:case 4:y=Wf(H.val,H.ixfe,"s"),y.XF=M[y.ixfe],j>0&&(y.z=Y[y.ixfe>>8&63]),ws(y,t,r.opts.Date1904),b({c:H.c,r:H.r},y,t);break;case 0:case 512:ce===1&&(i=H);break;case 252:l=H;break;case 1054:if(P.biff==4){Y[j++]=H[1];for(var fr=0;fr<j+163&&$e[fr]!=H[1];++fr);fr>=163&&Bi(H[1],j+163)}else Bi(H[1],H[0]);break;case 30:{Y[j++]=H;for(var vt=0;vt<j+163&&$e[vt]!=H;++vt);vt>=163&&Bi(H,j+163)}break;case 229:ie=ie.concat(H);break;case 93:Z[H.cmo[0]]=P.lastobj=H;break;case 438:P.lastobj.TxO=H;break;case 127:P.lastobj.ImData=H;break;case 440:for(w=H[0].s.r;w<=H[0].e.r;++w)for(g=H[0].s.c;g<=H[0].e.c;++g)p=t.dense?(s[w]||[])[g]:s[We({c:g,r:w})],p&&(p.l=H[1]);break;case 2048:for(w=H[0].s.r;w<=H[0].e.r;++w)for(g=H[0].s.c;g<=H[0].e.c;++g)p=t.dense?(s[w]||[])[g]:s[We({c:g,r:w})],p&&p.l&&(p.l.Tooltip=H[1]);break;case 28:{if(P.biff<=5&&P.biff>=2)break;p=t.dense?(s[H[0].r]||[])[H[0].c]:s[We(H[0])];var St=Z[H[2]];p||(t.dense?(s[H[0].r]||(s[H[0].r]=[]),p=s[H[0].r][H[0].c]={t:"z"}):p=s[We(H[0])]={t:"z"},i.e.r=Math.max(i.e.r,H[0].r),i.s.r=Math.min(i.s.r,H[0].r),i.e.c=Math.max(i.e.c,H[0].c),i.s.c=Math.min(i.s.c,H[0].c)),p.c||(p.c=[]),x={a:H[1],t:St.TxO.t},p.c.push(x)}break;case 2173:z9(M[H.ixfe],H.ext);break;case 125:{if(!P.cellStyles)break;for(;H.e>=H.s;)fe[H.e--]={width:H.w/256,level:H.level||0,hidden:!!(H.flags&1)},q||(q=!0,mv(H.w/256)),yl(fe[H.e+1])}break;case 520:{var dt={};H.level!=null&&(ue[H.r]=dt,dt.level=H.level),H.hidden&&(ue[H.r]=dt,dt.hidden=!0),H.hpt&&(ue[H.r]=dt,dt.hpt=H.hpt,dt.hpx=xu(H.hpt))}break;case 38:case 39:case 40:case 41:s["!margins"]||Dc(s["!margins"]={}),s["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[Ee]]=H;break;case 161:s["!margins"]||Dc(s["!margins"]={}),s["!margins"].header=H.header,s["!margins"].footer=H.footer;break;case 574:H.RTL&&(v.Views[0].RTL=!0);break;case 146:O=H;break;case 2198:D=H;break;case 140:I=H;break;case 442:c?T.CodeName=H||T.name:v.WBProps.CodeName=H||"ThisWorkbook";break}}else pe||console.error("Missing Info for XLS Record 0x"+Ee.toString(16)),e.l+=_e}return r.SheetNames=Fs(a).sort(function(Ot,Ve){return Number(Ot)-Number(Ve)}).map(function(Ot){return a[Ot].name}),t.bookSheets||(r.Sheets=n),!r.SheetNames.length&&f["!ref"]?(r.SheetNames.push("Sheet1"),r.Sheets&&(r.Sheets.Sheet1=f)):r.Preamble=f,r.Sheets&&K.forEach(function(Ot,Ve){r.Sheets[r.SheetNames[Ve]]["!autofilter"]=Ot}),r.Strings=l,r.SSF=Sr($e),P.enc&&(r.Encryption=P.enc),D&&(r.Themes=D),r.Metadata={},I!==void 0&&(r.Metadata.Country=I),G.names.length>0&&(v.Names=G.names),r.Workbook=v,r}var Kw={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function EB(e,t,r){var n=st.find(e,"/!DocumentSummaryInformation");if(n&&n.size>0)try{var s=bw(n,Uj,Kw.DSI);for(var a in s)t[a]=s[a]}catch(c){if(r.WTF)throw c}var i=st.find(e,"/!SummaryInformation");if(i&&i.size>0)try{var o=bw(i,Vj,Kw.SI);for(var l in o)t[l]==null&&(t[l]=o[l])}catch(c){if(r.WTF)throw c}t.HeadingPairs&&t.TitlesOfParts&&(ZA(t.HeadingPairs,t.TitlesOfParts,t,r),delete t.HeadingPairs,delete t.TitlesOfParts)}function MI(e,t){t||(t={}),yv(t),fA(),t.codepage&&Qx(t.codepage);var r,n;if(e.FullPaths){if(st.find(e,"/encryption"))throw new Error("File is password-protected");r=st.find(e,"!CompObj"),n=st.find(e,"/Workbook")||st.find(e,"/Book")}else{switch(t.type){case"base64":e=os(bn(e));break;case"binary":e=os(e);break;case"buffer":break;case"array":Array.isArray(e)||(e=Array.prototype.slice.call(e));break}wr(e,0),n={content:e}}var s,a;if(r&&vB(r),t.bookProps&&!t.bookSheets)s={};else{var i=et?"buffer":"array";if(n&&n.content)s=wB(n.content,t);else if((a=st.find(e,"PerfectOffice_MAIN"))&&a.content)s=Rc.to_workbook(a.content,(t.type=i,t));else if((a=st.find(e,"NativeContent_MAIN"))&&a.content)s=Rc.to_workbook(a.content,(t.type=i,t));else throw(a=st.find(e,"MN0"))&&a.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");t.bookVBA&&e.FullPaths&&st.find(e,"/_VBA_PROJECT_CUR/VBA/dir")&&(s.vbaraw=oU(e))}var o={};return e.FullPaths&&EB(e,o,t),s.Props=s.Custprops=o,t.bookFiles&&(s.cfb=e),s}var pd={0:{f:n7},1:{f:o7},2:{f:g7},3:{f:f7},4:{f:c7},5:{f:p7},6:{f:y7},7:{f:d7},8:{f:k7},9:{f:T7},10:{f:w7},11:{f:E7},12:{f:l7},13:{f:x7},14:{f:h7},15:{f:u7},16:{f:RI},17:{f:_7},18:{f:m7},19:{f:lv},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:Q7},40:{},42:{},43:{f:w9},44:{f:_9},45:{f:E9},46:{f:k9},47:{f:T9},48:{},49:{f:Sj},50:{},51:{f:H9},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:fI},62:{f:v7},63:{f:X9},64:{f:D7},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:Gr,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:P7},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:i7},148:{f:s7,p:16},151:{f:I7},152:{},153:{f:Y7},154:{},155:{},156:{f:q7},157:{},158:{},159:{T:1,f:V5},160:{T:-1},161:{T:1,f:fo},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:S7},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:$9},336:{T:-1},337:{f:G9,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:Vp},357:{},358:{},359:{},360:{T:1},361:{},362:{f:uI},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:N7},427:{f:C7},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:R7},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:a7},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:A7},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:Vp},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:sU},633:{T:1},634:{T:-1},635:{T:1,f:nU},636:{T:-1},637:{f:Ij},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:U7},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:F7},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},Hp={6:{f:lm},10:{f:Ra},12:{f:Zt},13:{f:Zt},14:{f:Ht},15:{f:Ht},16:{f:Vr},17:{f:Ht},18:{f:Ht},19:{f:Zt},20:{f:Fw},21:{f:Fw},23:{f:uI},24:{f:Mw},25:{f:Ht},26:{},27:{},28:{f:t5},29:{},34:{f:Ht},35:{f:Ow},38:{f:Vr},39:{f:Vr},40:{f:Vr},41:{f:Vr},42:{f:Ht},43:{f:Ht},47:{f:a9},49:{f:M8},51:{f:Zt},60:{},61:{f:D8},64:{f:Ht},65:{f:O8},66:{f:Zt},77:{},80:{},81:{},82:{},85:{f:Zt},89:{},90:{},91:{},92:{f:S8},93:{f:n5},94:{},95:{f:Ht},96:{},97:{},99:{f:Ht},125:{f:fI},128:{f:G8},129:{f:A8},130:{f:Zt},131:{f:Ht},132:{f:Ht},133:{f:I8},134:{},140:{f:c5},141:{f:Zt},144:{},146:{f:f5},151:{},152:{},153:{},154:{},155:{},156:{f:Zt},157:{},158:{},160:{f:g5},161:{f:d5},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:W8},190:{f:z8},193:{f:Ra},197:{},198:{},199:{},200:{},201:{},202:{f:Ht},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:Zt},220:{},221:{f:Ht},222:{},224:{f:H8},225:{f:k8},226:{f:Ra},227:{},229:{f:r5},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:N8},253:{f:L8},255:{f:C8},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:sI},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:Ht},353:{f:Ra},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:q8},431:{f:Ht},432:{},433:{},434:{},437:{},438:{f:i5},439:{f:Ht},440:{f:o5},441:{},442:{f:Ku},443:{},444:{f:Zt},445:{},446:{},448:{f:Ra},449:{f:P8,r:2},450:{f:Ra},512:{f:Pw},513:{f:p5},515:{f:K8},516:{f:j8},517:{f:Dw},519:{f:x5},520:{f:b8},523:{},545:{f:Lw},549:{f:Rw},566:{},574:{f:F8},638:{f:B8},659:{},1048:{},1054:{f:U8},1084:{},1212:{f:J8},2048:{f:l5},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:Uf},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:Ra},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:h5,r:12},2173:{f:W9,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:Ht,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:Q8,r:12},2197:{},2198:{f:M9,r:12},2199:{},2200:{},2201:{},2202:{f:Z8,r:12},2203:{f:Ra},2204:{},2205:{},2206:{},2207:{},2211:{f:R8},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:Zt},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:m5},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:u5},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:Pw},1:{},2:{f:w5},3:{f:_5},4:{f:y5},5:{f:Dw},7:{f:E5},8:{},9:{f:Uf},11:{},22:{f:Zt},30:{f:V8},31:{},32:{},33:{f:Lw},36:{},37:{f:Rw},50:{f:T5},62:{},52:{},67:{},68:{f:Zt},69:{},86:{},126:{},127:{f:v5},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:k5},223:{},234:{},354:{},421:{},518:{f:lm},521:{f:Uf},536:{f:Mw},547:{f:Ow},561:{},579:{},1030:{f:lm},1033:{f:Uf},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function ts(e,t,r,n){var s=t;if(!isNaN(s)){var a=(r||[]).length||0,i=e.next(4);i.write_shift(2,s),i.write_shift(2,a),a>0&&HA(r)&&e.push(r)}}function qw(e,t){var r=t||{},n=r.dense?[]:{};e=e.replace(/<!--.*?-->/g,"");var s=e.match(/<table/i);if(!s)throw new Error("Invalid HTML: could not find <table>");var a=e.match(/<\/table/i),i=s.index,o=a&&a.index||e.length,l=K6(e.slice(i,o),/(:?<tr[^>]*>)/i,"<tr>"),c=-1,f=0,d=0,m=0,p={s:{r:1e7,c:1e7},e:{r:0,c:0}},x=[];for(i=0;i<l.length;++i){var g=l[i].trim(),w=g.slice(0,3).toLowerCase();if(w=="<tr"){if(++c,r.sheetRows&&r.sheetRows<=c){--c;break}f=0;continue}if(!(w!="<td"&&w!="<th")){var k=g.split(/<\/t[dh]>/i);for(o=0;o<k.length;++o){var E=k[o].trim();if(E.match(/<t[dh]/i)){for(var y=E,I=0;y.charAt(0)=="<"&&(I=y.indexOf(">"))>-1;)y=y.slice(I+1);for(var M=0;M<x.length;++M){var O=x[M];O.s.c==f&&O.s.r<c&&c<=O.e.r&&(f=O.e.c+1,M=-1)}var v=Oe(E.slice(0,E.indexOf(">")));m=v.colspan?+v.colspan:1,((d=+v.rowspan)>1||m>1)&&x.push({s:{r:c,c:f},e:{r:c+(d||1)-1,c:f+m-1}});var T=v.t||v["data-t"]||"";if(!y.length){f+=m;continue}if(y=PA(y),p.s.r>c&&(p.s.r=c),p.e.r<c&&(p.e.r=c),p.s.c>f&&(p.s.c=f),p.e.c<f&&(p.e.c=f),!y.length){f+=m;continue}var S={t:"s",v:y};r.raw||!y.trim().length||T=="s"||(y==="TRUE"?S={t:"b",v:!0}:y==="FALSE"?S={t:"b",v:!1}:isNaN(ms(y))?isNaN(vl(y).getDate())||(S={t:"d",v:gr(y)},r.cellDates||(S={t:"n",v:tn(S.v)}),S.z=r.dateNF||$e[14]):S={t:"n",v:ms(y)}),r.dense?(n[c]||(n[c]=[]),n[c][f]=S):n[We({r:c,c:f})]=S,f+=m}}}}return n["!ref"]=at(p),x.length&&(n["!merges"]=x),n}function TB(e,t,r,n){for(var s=e["!merges"]||[],a=[],i=t.s.c;i<=t.e.c;++i){for(var o=0,l=0,c=0;c<s.length;++c)if(!(s[c].s.r>r||s[c].s.c>i)&&!(s[c].e.r<r||s[c].e.c<i)){if(s[c].s.r<r||s[c].s.c<i){o=-1;break}o=s[c].e.r-s[c].s.r+1,l=s[c].e.c-s[c].s.c+1;break}if(!(o<0)){var f=We({r,c:i}),d=n.dense?(e[r]||[])[i]:e[f],m=d&&d.v!=null&&(d.h||nv(d.w||(wa(d),d.w)||""))||"",p={};o>1&&(p.rowspan=o),l>1&&(p.colspan=l),n.editable?m='<span contenteditable="true">'+m+"</span>":d&&(p["data-t"]=d&&d.t||"z",d.v!=null&&(p["data-v"]=d.v),d.z!=null&&(p["data-z"]=d.z),d.l&&(d.l.Target||"#").charAt(0)!="#"&&(m='<a href="'+d.l.Target+'">'+m+"</a>")),p.id=(n.id||"sjs")+"-"+f,a.push(cj("td",m,p))}}var x="<tr>";return x+a.join("")+"</tr>"}var kB='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',SB="</body></html>";function AB(e,t){var r=e.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!r||r.length==0)throw new Error("Invalid HTML: could not find <table>");if(r.length==1)return _i(qw(r[0],t),t);var n=wv();return r.forEach(function(s,a){Ev(n,qw(s,t),"Sheet"+(a+1))}),n}function IB(e,t,r){var n=[];return n.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function NB(e,t){var r=t||{},n=r.header!=null?r.header:kB,s=r.footer!=null?r.footer:SB,a=[n],i=Cl(e["!ref"]);r.dense=Array.isArray(e),a.push(IB(e,i,r));for(var o=i.s.r;o<=i.e.r;++o)a.push(TB(e,i,o,r));return a.push("</table>"+s),a.join("")}function LI(e,t,r){var n=r||{},s=0,a=0;if(n.origin!=null)if(typeof n.origin=="number")s=n.origin;else{var i=typeof n.origin=="string"?Qr(n.origin):n.origin;s=i.r,a=i.c}var o=t.getElementsByTagName("tr"),l=Math.min(n.sheetRows||1e7,o.length),c={s:{r:0,c:0},e:{r:s,c:a}};if(e["!ref"]){var f=Cl(e["!ref"]);c.s.r=Math.min(c.s.r,f.s.r),c.s.c=Math.min(c.s.c,f.s.c),c.e.r=Math.max(c.e.r,f.e.r),c.e.c=Math.max(c.e.c,f.e.c),s==-1&&(c.e.r=s=f.e.r+1)}var d=[],m=0,p=e["!rows"]||(e["!rows"]=[]),x=0,g=0,w=0,k=0,E=0,y=0;for(e["!cols"]||(e["!cols"]=[]);x<o.length&&g<l;++x){var I=o[x];if(Yw(I)){if(n.display)continue;p[g]={hidden:!0}}var M=I.children;for(w=k=0;w<M.length;++w){var O=M[w];if(!(n.display&&Yw(O))){var v=O.hasAttribute("data-v")?O.getAttribute("data-v"):O.hasAttribute("v")?O.getAttribute("v"):PA(O.innerHTML),T=O.getAttribute("data-z")||O.getAttribute("z");for(m=0;m<d.length;++m){var S=d[m];S.s.c==k+a&&S.s.r<g+s&&g+s<=S.e.r&&(k=S.e.c+1-a,m=-1)}y=+O.getAttribute("colspan")||1,((E=+O.getAttribute("rowspan")||1)>1||y>1)&&d.push({s:{r:g+s,c:k+a},e:{r:g+s+(E||1)-1,c:k+a+(y||1)-1}});var C={t:"s",v},b=O.getAttribute("data-t")||O.getAttribute("t")||"";v!=null&&(v.length==0?C.t=b||"z":n.raw||v.trim().length==0||b=="s"||(v==="TRUE"?C={t:"b",v:!0}:v==="FALSE"?C={t:"b",v:!1}:isNaN(ms(v))?isNaN(vl(v).getDate())||(C={t:"d",v:gr(v)},n.cellDates||(C={t:"n",v:tn(C.v)}),C.z=n.dateNF||$e[14]):C={t:"n",v:ms(v)})),C.z===void 0&&T!=null&&(C.z=T);var P="",D=O.getElementsByTagName("A");if(D&&D.length)for(var ie=0;ie<D.length&&!(D[ie].hasAttribute("href")&&(P=D[ie].getAttribute("href"),P.charAt(0)!="#"));++ie);P&&P.charAt(0)!="#"&&(C.l={Target:P}),n.dense?(e[g+s]||(e[g+s]=[]),e[g+s][k+a]=C):e[We({c:k+a,r:g+s})]=C,c.e.c<k+a&&(c.e.c=k+a),k+=y}}++g}return d.length&&(e["!merges"]=(e["!merges"]||[]).concat(d)),c.e.r=Math.max(c.e.r,g-1+s),e["!ref"]=at(c),g>=l&&(e["!fullref"]=at((c.e.r=o.length-x+g-1+s,c))),e}function jI(e,t){var r=t||{},n=r.dense?[]:{};return LI(n,e,t)}function CB(e,t){return _i(jI(e,t),t)}function Yw(e){var t="",r=bB(e);return r&&(t=r(e).getPropertyValue("display")),t||(t=e.style&&e.style.display),t==="none"}function bB(e){return e.ownerDocument.defaultView&&typeof e.ownerDocument.defaultView.getComputedStyle=="function"?e.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function RB(e){var t=e.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(n,s){return Array(parseInt(s,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),r=lt(t.replace(/<[^>]*>/g,""));return[r]}var Xw={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function UI(e,t){var r=t||{},n=sv(e),s=[],a,i,o={name:""},l="",c=0,f,d,m={},p=[],x=r.dense?[]:{},g,w,k={value:""},E="",y=0,I=[],M=-1,O=-1,v={s:{r:1e6,c:1e7},e:{r:0,c:0}},T=0,S={},C=[],b={},P=0,D=0,ie=[],Z=1,fe=1,ue=[],q={Names:[]},G={},ne=["",""],ce=[],j={},Y="",K=0,V=!1,J=!1,de=0;for(mu.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");g=mu.exec(n);)switch(g[3]=g[3].replace(/_.*$/,"")){case"table":case"":g[1]==="/"?(v.e.c>=v.s.c&&v.e.r>=v.s.r?x["!ref"]=at(v):x["!ref"]="A1:A1",r.sheetRows>0&&r.sheetRows<=v.e.r&&(x["!fullref"]=x["!ref"],v.e.r=r.sheetRows-1,x["!ref"]=at(v)),C.length&&(x["!merges"]=C),ie.length&&(x["!rows"]=ie),f.name=f.||f.name,typeof JSON<"u"&&JSON.stringify(f),p.push(f.name),m[f.name]=x,J=!1):g[0].charAt(g[0].length-2)!=="/"&&(f=Oe(g[0],!1),M=O=-1,v.s.r=v.s.c=1e7,v.e.r=v.e.c=0,x=r.dense?[]:{},C=[],ie=[],J=!0);break;case"table-row-group":g[1]==="/"?--T:++T;break;case"table-row":case"":if(g[1]==="/"){M+=Z,Z=1;break}if(d=Oe(g[0],!1),d.?M=d.-1:M==-1&&(M=0),Z=+d["number-rows-repeated"]||1,Z<10)for(de=0;de<Z;++de)T>0&&(ie[M+de]={level:T});O=-1;break;case"covered-table-cell":g[1]!=="/"&&++O,r.sheetStubs&&(r.dense?(x[M]||(x[M]=[]),x[M][O]={t:"z"}):x[We({r:M,c:O})]={t:"z"}),E="",I=[];break;case"table-cell":case"":if(g[0].charAt(g[0].length-2)==="/")++O,k=Oe(g[0],!1),fe=parseInt(k["number-columns-repeated"]||"1",10),w={t:"z",v:null},k.formula&&r.cellFormula!=!1&&(w.f=$w(lt(k.formula))),(k.||k["value-type"])=="string"&&(w.t="s",w.v=lt(k["string-value"]||""),r.dense?(x[M]||(x[M]=[]),x[M][O]=w):x[We({r:M,c:O})]=w),O+=fe-1;else if(g[1]!=="/"){++O,E="",y=0,I=[],fe=1;var Ee=Z?M+Z-1:M;if(O>v.e.c&&(v.e.c=O),O<v.s.c&&(v.s.c=O),M<v.s.r&&(v.s.r=M),Ee>v.e.r&&(v.e.r=Ee),k=Oe(g[0],!1),ce=[],j={},w={t:k.||k["value-type"],v:null},r.cellFormula)if(k.formula&&(k.formula=lt(k.formula)),k["number-matrix-columns-spanned"]&&k["number-matrix-rows-spanned"]&&(P=parseInt(k["number-matrix-rows-spanned"],10)||0,D=parseInt(k["number-matrix-columns-spanned"],10)||0,b={s:{r:M,c:O},e:{r:M+P-1,c:O+D-1}},w.F=at(b),ue.push([b,w.F])),k.formula)w.f=$w(k.formula);else for(de=0;de<ue.length;++de)M>=ue[de][0].s.r&&M<=ue[de][0].e.r&&O>=ue[de][0].s.c&&O<=ue[de][0].e.c&&(w.F=ue[de][1]);switch((k["number-columns-spanned"]||k["number-rows-spanned"])&&(P=parseInt(k["number-rows-spanned"],10)||0,D=parseInt(k["number-columns-spanned"],10)||0,b={s:{r:M,c:O},e:{r:M+P-1,c:O+D-1}},C.push(b)),k["number-columns-repeated"]&&(fe=parseInt(k["number-columns-repeated"],10)),w.t){case"boolean":w.t="b",w.v=Pt(k["boolean-value"]);break;case"float":w.t="n",w.v=parseFloat(k.value);break;case"percentage":w.t="n",w.v=parseFloat(k.value);break;case"currency":w.t="n",w.v=parseFloat(k.value);break;case"date":w.t="d",w.v=gr(k["date-value"]),r.cellDates||(w.t="n",w.v=tn(w.v)),w.z="m/d/yy";break;case"time":w.t="n",w.v=$6(k["time-value"])/86400,r.cellDates&&(w.t="d",w.v=o0(w.v)),w.z="HH:MM:SS";break;case"number":w.t="n",w.v=parseFloat(k.);break;default:if(w.t==="string"||w.t==="text"||!w.t)w.t="s",k["string-value"]!=null&&(E=lt(k["string-value"]),I=[]);else throw new Error("Unsupported value type "+w.t)}}else{if(V=!1,w.t==="s"&&(w.v=E||"",I.length&&(w.R=I),V=y==0),G.Target&&(w.l=G),ce.length>0&&(w.c=ce,ce=[]),E&&r.cellText!==!1&&(w.w=E),V&&(w.t="z",delete w.v),(!V||r.sheetStubs)&&!(r.sheetRows&&r.sheetRows<=M))for(var _e=0;_e<Z;++_e){if(fe=parseInt(k["number-columns-repeated"]||"1",10),r.dense)for(x[M+_e]||(x[M+_e]=[]),x[M+_e][O]=_e==0?w:Sr(w);--fe>0;)x[M+_e][O+fe]=Sr(w);else for(x[We({r:M+_e,c:O})]=w;--fe>0;)x[We({r:M+_e,c:O+fe})]=Sr(w);v.e.c<=O&&(v.e.c=O)}fe=parseInt(k["number-columns-repeated"]||"1",10),O+=fe-1,fe=0,w={},E="",I=[]}G={};break;case"document":case"document-content":case"":case"spreadsheet":case"":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(g[1]==="/"){if((a=s.pop())[0]!==g[3])throw"Bad state: "+a}else g[0].charAt(g[0].length-2)!=="/"&&s.push([g[3],!0]);break;case"annotation":if(g[1]==="/"){if((a=s.pop())[0]!==g[3])throw"Bad state: "+a;j.t=E,I.length&&(j.R=I),j.a=Y,ce.push(j)}else g[0].charAt(g[0].length-2)!=="/"&&s.push([g[3],!1]);Y="",K=0,E="",y=0,I=[];break;case"creator":g[1]==="/"?Y=n.slice(K,g.index):K=g.index+g[0].length;break;case"meta":case"":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(g[1]==="/"){if((a=s.pop())[0]!==g[3])throw"Bad state: "+a}else g[0].charAt(g[0].length-2)!=="/"&&s.push([g[3],!1]);E="",y=0,I=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(g[1]==="/"){if(S[o.name]=l,(a=s.pop())[0]!==g[3])throw"Bad state: "+a}else g[0].charAt(g[0].length-2)!=="/"&&(l="",o=Oe(g[0],!1),s.push([g[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(s[s.length-1][0]){case"time-style":case"date-style":i=Oe(g[0],!1),l+=Xw[g[3]][i.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(s[s.length-1][0]){case"time-style":case"date-style":i=Oe(g[0],!1),l+=Xw[g[3]][i.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(g[0].slice(-2)==="/>")break;if(g[1]==="/")switch(s[s.length-1][0]){case"number-style":case"date-style":case"time-style":l+=n.slice(c,g.index);break}else c=g.index+g[0].length;break;case"named-range":i=Oe(g[0],!1),ne=cm(i["cell-range-address"]);var pe={Name:i.name,Ref:ne[0]+"!"+ne[1]};J&&(pe.Sheet=p.length),q.Names.push(pe);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"":if(["master-styles"].indexOf(s[s.length-1][0])>-1)break;if(g[1]==="/"&&(!k||!k["string-value"])){var Ue=RB(n.slice(y,g.index));E=(E.length>0?E+`
`:"")+Ue[0]}else Oe(g[0],!1),y=g.index+g[0].length;break;case"s":break;case"database-range":if(g[1]==="/")break;try{ne=cm(Oe(g[0])["target-range-address"]),m[ne[0]]["!autofilter"]={ref:ne[1]}}catch{}break;case"date":break;case"object":break;case"title":case"":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(g[1]!=="/"){if(G=Oe(g[0],!1),!G.href)break;G.Target=lt(G.href),delete G.href,G.Target.charAt(0)=="#"&&G.Target.indexOf(".")>-1?(ne=cm(G.Target.slice(1)),G.Target="#"+ne[0]+"!"+ne[1]):G.Target.match(/^\.\.[\\\/]/)&&(G.Target=G.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(g[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case":":case":":break;default:if(r.WTF)throw new Error(g)}}var H={Sheets:m,SheetNames:p,Workbook:q};return r.bookSheets&&delete H.Sheets,H}function Qw(e,t){t=t||{},Un(e,"META-INF/manifest.xml")&&Kj(Jt(e,"META-INF/manifest.xml"),t);var r=Tn(e,"content.xml");if(!r)throw new Error("Missing content.xml in ODS / UOF file");var n=UI(Tt(r),t);return Un(e,"meta.xml")&&(n.Props=JA(Jt(e,"meta.xml"))),n}function Jw(e,t){return UI(e,t)}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function xv(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function Gp(e){return typeof TextDecoder<"u"?new TextDecoder().decode(e):Tt(co(e))}function Kp(e){var t=e.reduce(function(s,a){return s+a.length},0),r=new Uint8Array(t),n=0;return e.forEach(function(s){r.set(s,n),n+=s.length}),r}function Zw(e){return e-=e>>1&1431655765,e=(e&858993459)+(e>>2&858993459),(e+(e>>4)&252645135)*16843009>>>24}function PB(e,t){for(var r=(e[t+15]&127)<<7|e[t+14]>>1,n=e[t+14]&1,s=t+13;s>=t;--s)n=n*256+e[s];return(e[t+15]&128?-n:n)*Math.pow(10,r-6176)}function vu(e,t){var r=t?t[0]:0,n=e[r]&127;e:if(e[r++]>=128&&(n|=(e[r]&127)<<7,e[r++]<128||(n|=(e[r]&127)<<14,e[r++]<128)||(n|=(e[r]&127)<<21,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,28),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,35),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,42),++r,e[r++]<128)))break e;return t&&(t[0]=r),n}function cr(e){var t=0,r=e[t]&127;e:if(e[t++]>=128){if(r|=(e[t]&127)<<7,e[t++]<128||(r|=(e[t]&127)<<14,e[t++]<128)||(r|=(e[t]&127)<<21,e[t++]<128))break e;r|=(e[t]&127)<<28}return r}function Br(e){for(var t=[],r=[0];r[0]<e.length;){var n=r[0],s=vu(e,r),a=s&7;s=Math.floor(s/8);var i=0,o;if(s==0)break;switch(a){case 0:{for(var l=r[0];e[r[0]++]>=128;);o=e.slice(l,r[0])}break;case 5:i=4,o=e.slice(r[0],r[0]+i),r[0]+=i;break;case 1:i=8,o=e.slice(r[0],r[0]+i),r[0]+=i;break;case 2:i=vu(e,r),o=e.slice(r[0],r[0]+i),r[0]+=i;break;case 3:case 4:default:throw new Error("PB Type ".concat(a," for Field ").concat(s," at offset ").concat(n))}var c={data:o,type:a};t[s]==null?t[s]=[c]:t[s].push(c)}return t}function vv(e,t){return(e==null?void 0:e.map(function(r){return t(r.data)}))||[]}function DB(e){for(var t,r=[],n=[0];n[0]<e.length;){var s=vu(e,n),a=Br(e.slice(n[0],n[0]+s));n[0]+=s;var i={id:cr(a[1][0].data),messages:[]};a[2].forEach(function(o){var l=Br(o.data),c=cr(l[3][0].data);i.messages.push({meta:l,data:e.slice(n[0],n[0]+c)}),n[0]+=c}),(t=a[3])!=null&&t[0]&&(i.merge=cr(a[3][0].data)>>>0>0),r.push(i)}return r}function FB(e,t){if(e!=0)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var r=[0],n=vu(t,r),s=[];r[0]<t.length;){var a=t[r[0]]&3;if(a==0){var i=t[r[0]++]>>2;if(i<60)++i;else{var o=i-59;i=t[r[0]],o>1&&(i|=t[r[0]+1]<<8),o>2&&(i|=t[r[0]+2]<<16),o>3&&(i|=t[r[0]+3]<<24),i>>>=0,i++,r[0]+=o}s.push(t.slice(r[0],r[0]+i)),r[0]+=i;continue}else{var l=0,c=0;if(a==1?(c=(t[r[0]]>>2&7)+4,l=(t[r[0]++]&224)<<3,l|=t[r[0]++]):(c=(t[r[0]++]>>2)+1,a==2?(l=t[r[0]]|t[r[0]+1]<<8,r[0]+=2):(l=(t[r[0]]|t[r[0]+1]<<8|t[r[0]+2]<<16|t[r[0]+3]<<24)>>>0,r[0]+=4)),s=[Kp(s)],l==0)throw new Error("Invalid offset 0");if(l>s[0].length)throw new Error("Invalid offset beyond length");if(c>=l)for(s.push(s[0].slice(-l)),c-=l;c>=s[s.length-1].length;)s.push(s[s.length-1]),c-=s[s.length-1].length;s.push(s[0].slice(-l,-l+c))}}var f=Kp(s);if(f.length!=n)throw new Error("Unexpected length: ".concat(f.length," != ").concat(n));return f}function OB(e){for(var t=[],r=0;r<e.length;){var n=e[r++],s=e[r]|e[r+1]<<8|e[r+2]<<16;r+=3,t.push(FB(n,e.slice(r,r+s))),r+=s}if(r!==e.length)throw new Error("data is not a valid framed stream!");return Kp(t)}function MB(e,t,r,n){var s=xv(e),a=s.getUint32(4,!0),i=(n>1?12:8)+Zw(a&(n>1?3470:398))*4,o=-1,l=-1,c=NaN,f=new Date(2001,0,1);a&512&&(o=s.getUint32(i,!0),i+=4),i+=Zw(a&(n>1?12288:4096))*4,a&16&&(l=s.getUint32(i,!0),i+=4),a&32&&(c=s.getFloat64(i,!0),i+=8),a&64&&(f.setTime(f.getTime()+s.getFloat64(i,!0)*1e3),i+=8);var d;switch(e[2]){case 0:break;case 2:d={t:"n",v:c};break;case 3:d={t:"s",v:t[l]};break;case 5:d={t:"d",v:f};break;case 6:d={t:"b",v:c>0};break;case 7:d={t:"n",v:c/86400};break;case 8:d={t:"e",v:0};break;case 9:if(o>-1)d={t:"s",v:r[o]};else if(l>-1)d={t:"s",v:t[l]};else if(!isNaN(c))d={t:"n",v:c};else throw new Error("Unsupported cell type ".concat(e.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(e.slice(0,4)))}return d}function LB(e,t,r){var n=xv(e),s=n.getUint32(8,!0),a=12,i=-1,o=-1,l=NaN,c=NaN,f=new Date(2001,0,1);s&1&&(l=PB(e,a),a+=16),s&2&&(c=n.getFloat64(a,!0),a+=8),s&4&&(f.setTime(f.getTime()+n.getFloat64(a,!0)*1e3),a+=8),s&8&&(o=n.getUint32(a,!0),a+=4),s&16&&(i=n.getUint32(a,!0),a+=4);var d;switch(e[1]){case 0:break;case 2:d={t:"n",v:l};break;case 3:d={t:"s",v:t[o]};break;case 5:d={t:"d",v:f};break;case 6:d={t:"b",v:c>0};break;case 7:d={t:"n",v:c/86400};break;case 8:d={t:"e",v:0};break;case 9:if(i>-1)d={t:"s",v:r[i]};else throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(s&31," : ").concat(e.slice(0,4)));break;case 10:d={t:"n",v:l};break;default:throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(s&31," : ").concat(e.slice(0,4)))}return d}function jB(e,t,r){switch(e[0]){case 0:case 1:case 2:case 3:return MB(e,t,r,e[0]);case 5:return LB(e,t,r);default:throw new Error("Unsupported payload version ".concat(e[0]))}}function ai(e){var t=Br(e);return vu(t[1][0].data)}function eE(e,t){var r=Br(t.data),n=cr(r[1][0].data),s=r[3],a=[];return(s||[]).forEach(function(i){var o=Br(i.data),l=cr(o[1][0].data)>>>0;switch(n){case 1:a[l]=Gp(o[3][0].data);break;case 8:{var c=e[ai(o[9][0].data)][0],f=Br(c.data),d=e[ai(f[1][0].data)][0],m=cr(d.meta[1][0].data);if(m!=2001)throw new Error("2000 unexpected reference to ".concat(m));var p=Br(d.data);a[l]=p[3].map(function(x){return Gp(x.data)}).join("")}break}}),a}function UB(e,t){var r,n,s,a,i,o,l,c,f,d,m,p,x,g,w=Br(e),k=cr(w[1][0].data)>>>0,E=cr(w[2][0].data)>>>0,y=((n=(r=w[8])==null?void 0:r[0])==null?void 0:n.data)&&cr(w[8][0].data)>0||!1,I,M;if((a=(s=w[7])==null?void 0:s[0])!=null&&a.data&&t!=0)I=(o=(i=w[7])==null?void 0:i[0])==null?void 0:o.data,M=(c=(l=w[6])==null?void 0:l[0])==null?void 0:c.data;else if((d=(f=w[4])==null?void 0:f[0])!=null&&d.data&&t!=1)I=(p=(m=w[4])==null?void 0:m[0])==null?void 0:p.data,M=(g=(x=w[3])==null?void 0:x[0])==null?void 0:g.data;else throw"NUMBERS Tile missing ".concat(t," cell storage");for(var O=y?4:1,v=xv(I),T=[],S=0;S<I.length/2;++S){var C=v.getUint16(S*2,!0);C<65535&&T.push([S,C])}if(T.length!=E)throw"Expected ".concat(E," cells, found ").concat(T.length);var b=[];for(S=0;S<T.length-1;++S)b[T[S][0]]=M.subarray(T[S][1]*O,T[S+1][1]*O);return T.length>=1&&(b[T[T.length-1][0]]=M.subarray(T[T.length-1][1]*O)),{R:k,cells:b}}function VB(e,t){var r,n=Br(t.data),s=(r=n==null?void 0:n[7])!=null&&r[0]?cr(n[7][0].data)>>>0>0?1:0:-1,a=vv(n[5],function(i){return UB(i,s)});return{nrows:cr(n[4][0].data)>>>0,data:a.reduce(function(i,o){return i[o.R]||(i[o.R]=[]),o.cells.forEach(function(l,c){if(i[o.R][c])throw new Error("Duplicate cell r=".concat(o.R," c=").concat(c));i[o.R][c]=l}),i},[])}}function BB(e,t,r){var n,s=Br(t.data),a={s:{r:0,c:0},e:{r:0,c:0}};if(a.e.r=(cr(s[6][0].data)>>>0)-1,a.e.r<0)throw new Error("Invalid row varint ".concat(s[6][0].data));if(a.e.c=(cr(s[7][0].data)>>>0)-1,a.e.c<0)throw new Error("Invalid col varint ".concat(s[7][0].data));r["!ref"]=at(a);var i=Br(s[4][0].data),o=eE(e,e[ai(i[4][0].data)][0]),l=(n=i[17])!=null&&n[0]?eE(e,e[ai(i[17][0].data)][0]):[],c=Br(i[3][0].data),f=0;c[1].forEach(function(d){var m=Br(d.data),p=e[ai(m[2][0].data)][0],x=cr(p.meta[1][0].data);if(x!=6002)throw new Error("6001 unexpected reference to ".concat(x));var g=VB(e,p);g.data.forEach(function(w,k){w.forEach(function(E,y){var I=We({r:f+k,c:y}),M=jB(E,o,l);M&&(r[I]=M)})}),f+=g.nrows})}function WB(e,t){var r=Br(t.data),n={"!ref":"A1"},s=e[ai(r[2][0].data)],a=cr(s[0].meta[1][0].data);if(a!=6001)throw new Error("6000 unexpected reference to ".concat(a));return BB(e,s[0],n),n}function zB(e,t){var r,n=Br(t.data),s={name:(r=n[1])!=null&&r[0]?Gp(n[1][0].data):"",sheets:[]},a=vv(n[2],ai);return a.forEach(function(i){e[i].forEach(function(o){var l=cr(o.meta[1][0].data);l==6e3&&s.sheets.push(WB(e,o))})}),s}function $B(e,t){var r=wv(),n=Br(t.data),s=vv(n[1],ai);if(s.forEach(function(a){e[a].forEach(function(i){var o=cr(i.meta[1][0].data);if(o==2){var l=zB(e,i);l.sheets.forEach(function(c,f){Ev(r,c,f==0?l.name:l.name+"_"+f,!0)})}})}),r.SheetNames.length==0)throw new Error("Empty NUMBERS file");return r}function fm(e){var t,r,n,s,a={},i=[];if(e.FullPaths.forEach(function(l){if(l.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),e.FileIndex.forEach(function(l){if(l.name.match(/\.iwa$/)){var c;try{c=OB(l.content)}catch(d){return console.log("?? "+l.content.length+" "+(d.message||d))}var f;try{f=DB(c)}catch(d){return console.log("## "+(d.message||d))}f.forEach(function(d){a[d.id]=d.messages,i.push(d.id)})}}),!i.length)throw new Error("File has no messages");var o=((s=(n=(r=(t=a==null?void 0:a[1])==null?void 0:t[0])==null?void 0:r.meta)==null?void 0:n[1])==null?void 0:s[0].data)&&cr(a[1][0].meta[1][0].data)==1&&a[1][0];if(o||i.forEach(function(l){a[l].forEach(function(c){var f=cr(c.meta[1][0].data)>>>0;if(f==1)if(!o)o=c;else throw new Error("Document has multiple roots")})}),!o)throw new Error("Cannot find Document root");return $B(a,o)}function HB(e){return function(r){for(var n=0;n!=e.length;++n){var s=e[n];r[s[0]]===void 0&&(r[s[0]]=s[1]),s[2]==="n"&&(r[s[0]]=Number(r[s[0]]))}}}function yv(e){HB([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(e)}function GB(e){return Vo.WS.indexOf(e)>-1?"sheet":e==Vo.CS?"chart":e==Vo.DS?"dialog":e==Vo.MS?"macro":e&&e.length?e:"sheet"}function KB(e,t){if(!e)return 0;try{e=t.map(function(n){return n.id||(n.id=n.strRelID),[n.name,e["!id"][n.id].Target,GB(e["!id"][n.id].Type)]})}catch{return null}return!e||e.length===0?null:e}function qB(e,t,r,n,s,a,i,o,l,c,f,d){try{a[n]=Cc(Tn(e,r,!0),t);var m=Jt(e,t),p;switch(o){case"sheet":p=eB(m,t,s,l,a[n],c,f,d);break;case"chart":if(p=tB(m,t,s,l,a[n],c,f,d),!p||!p["!drawel"])break;var x=cc(p["!drawel"].Target,t),g=Bp(x),w=Z9(Tn(e,x,!0),Cc(Tn(e,g,!0),x)),k=cc(w,x),E=Bp(k);p=L7(Tn(e,k,!0),k,l,Cc(Tn(e,E,!0),k),c,p);break;case"macro":p=rB(m,t,s,l,a[n],c,f,d);break;case"dialog":p=nB(m,t,s,l,a[n],c,f,d);break;default:throw new Error("Unrecognized sheet type "+o)}i[n]=p;var y=[];a&&a[n]&&Fs(a[n]).forEach(function(I){var M="";if(a[n][I].Type==Vo.CMNT){M=cc(a[n][I].Target,t);var O=oB(Jt(e,M,!0),M,l);if(!O||!O.length)return;Uw(p,O,!1)}a[n][I].Type==Vo.TCMNT&&(M=cc(a[n][I].Target,t),y=y.concat(tU(Jt(e,M,!0),l)))}),y&&y.length&&Uw(p,y,!0,l.people||[])}catch(I){if(l.WTF)throw I}}function Ln(e){return e.charAt(0)=="/"?e.slice(1):e}function YB(e,t){if(TA(),t=t||{},yv(t),Un(e,"META-INF/manifest.xml")||Un(e,"objectdata.xml"))return Qw(e,t);if(Un(e,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof fm<"u"){if(e.FileIndex)return fm(e);var r=st.utils.cfb_new();return hw(e).forEach(function(ie){X6(r,ie,Y6(e,ie))}),fm(r)}throw new Error("Unsupported NUMBERS file")}if(!Un(e,"[Content_Types].xml"))throw Un(e,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):Un(e,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var n=hw(e),s=Hj(Tn(e,"[Content_Types].xml")),a=!1,i,o;if(s.workbooks.length===0&&(o="xl/workbook.xml",Jt(e,o,!0)&&s.workbooks.push(o)),s.workbooks.length===0){if(o="xl/workbook.bin",!Jt(e,o,!0))throw new Error("Could not find workbook");s.workbooks.push(o),a=!0}s.workbooks[0].slice(-3)=="bin"&&(a=!0);var l={},c={};if(!t.bookSheets&&!t.bookProps){if(Pc=[],s.sst)try{Pc=iB(Jt(e,Ln(s.sst)),s.sst,t)}catch(ie){if(t.WTF)throw ie}t.cellStyles&&s.themes.length&&(l=aB(Tn(e,s.themes[0].replace(/^\//,""),!0)||"",s.themes[0],t)),s.style&&(c=sB(Jt(e,Ln(s.style)),s.style,l,t))}s.links.map(function(ie){try{var Z=Cc(Tn(e,Bp(Ln(ie))),ie);return cB(Jt(e,Ln(ie)),Z,ie,t)}catch{}});var f=Z7(Jt(e,Ln(s.workbooks[0])),s.workbooks[0],t),d={},m="";s.coreprops.length&&(m=Jt(e,Ln(s.coreprops[0]),!0),m&&(d=JA(m)),s.extprops.length!==0&&(m=Jt(e,Ln(s.extprops[0]),!0),m&&Xj(m,d,t)));var p={};(!t.bookSheets||t.bookProps)&&s.custprops.length!==0&&(m=Tn(e,Ln(s.custprops[0]),!0),m&&(p=Jj(m,t)));var x={};if((t.bookSheets||t.bookProps)&&(f.Sheets?i=f.Sheets.map(function(Z){return Z.name}):d.Worksheets&&d.SheetNames.length>0&&(i=d.SheetNames),t.bookProps&&(x.Props=d,x.Custprops=p),t.bookSheets&&typeof i<"u"&&(x.SheetNames=i),t.bookSheets?x.SheetNames:t.bookProps))return x;i={};var g={};t.bookDeps&&s.calcchain&&(g=lB(Jt(e,Ln(s.calcchain)),s.calcchain));var w=0,k={},E,y;{var I=f.Sheets;d.Worksheets=I.length,d.SheetNames=[];for(var M=0;M!=I.length;++M)d.SheetNames[M]=I[M].name}var O=a?"bin":"xml",v=s.workbooks[0].lastIndexOf("/"),T=(s.workbooks[0].slice(0,v+1)+"_rels/"+s.workbooks[0].slice(v+1)+".rels").replace(/^\//,"");Un(e,T)||(T="xl/_rels/workbook."+O+".rels");var S=Cc(Tn(e,T,!0),T.replace(/_rels.*/,"s5s"));(s.metadata||[]).length>=1&&(t.xlmeta=uB(Jt(e,Ln(s.metadata[0])),s.metadata[0],t)),(s.people||[]).length>=1&&(t.people=rU(Jt(e,Ln(s.people[0])),t)),S&&(S=KB(S,f.Sheets));var C=Jt(e,"xl/worksheets/sheet.xml",!0)?1:0;e:for(w=0;w!=d.Worksheets;++w){var b="sheet";if(S&&S[w]?(E="xl/"+S[w][1].replace(/[\/]?xl\//,""),Un(e,E)||(E=S[w][1]),Un(e,E)||(E=T.replace(/_rels\/.*$/,"")+S[w][1]),b=S[w][2]):(E="xl/worksheets/sheet"+(w+1-C)+"."+O,E=E.replace(/sheet0\./,"sheet.")),y=E.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),t&&t.sheets!=null)switch(typeof t.sheets){case"number":if(w!=t.sheets)continue e;break;case"string":if(d.SheetNames[w].toLowerCase()!=t.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(t.sheets)){for(var P=!1,D=0;D!=t.sheets.length;++D)typeof t.sheets[D]=="number"&&t.sheets[D]==w&&(P=1),typeof t.sheets[D]=="string"&&t.sheets[D].toLowerCase()==d.SheetNames[w].toLowerCase()&&(P=1);if(!P)continue e}}qB(e,E,y,d.SheetNames[w],w,k,i,b,t,f,l,c)}return x={Directory:s,Workbook:f,Props:d,Custprops:p,Deps:g,Sheets:i,SheetNames:d.SheetNames,Strings:Pc,Styles:c,Themes:l,SSF:Sr($e)},t&&t.bookFiles&&(e.files?(x.keys=n,x.files=e.files):(x.keys=[],x.files={},e.FullPaths.forEach(function(ie,Z){ie=ie.replace(/^Root Entry[\/]/,""),x.keys.push(ie),x.files[ie]=e.FileIndex[Z]}))),t&&t.bookVBA&&(s.vba.length>0?x.vbaraw=Jt(e,Ln(s.vba[0]),!0):s.defaults&&s.defaults.bin===iU&&(x.vbaraw=Jt(e,"xl/vbaProject.bin",!0))),x}function XB(e,t){var r=t||{},n="Workbook",s=st.find(e,n);try{if(n="/!DataSpaces/Version",s=st.find(e,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(W5(s.content),n="/!DataSpaces/DataSpaceMap",s=st.find(e,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);var a=$5(s.content);if(a.length!==1||a[0].comps.length!==1||a[0].comps[0].t!==0||a[0].name!=="StrongEncryptionDataSpace"||a[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",s=st.find(e,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);var i=H5(s.content);if(i.length!=1||i[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",s=st.find(e,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);K5(s.content)}catch{}if(n="/EncryptionInfo",s=st.find(e,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);var o=q5(s.content);if(n="/EncryptedPackage",s=st.find(e,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(o[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(o[1],s.content,r.password||"",r);if(o[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(o[1],s.content,r.password||"",r);throw new Error("File is password-protected")}function _v(e,t){var r="";switch((t||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":r=bn(e.slice(0,12));break;case"binary":r=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(t&&t.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function QB(e,t){return st.find(e,"EncryptedPackage")?XB(e,t):MI(e,t)}function JB(e,t){var r,n=e,s=t||{};return s.type||(s.type=et&&Buffer.isBuffer(e)?"buffer":"base64"),r=CA(n,s),YB(r,s)}function VI(e,t){var r=0;e:for(;r<e.length;)switch(e.charCodeAt(r)){case 10:case 13:case 32:++r;break;case 60:return $p(e.slice(r),t);default:break e}return pu.to_workbook(e,t)}function ZB(e,t){var r="",n=_v(e,t);switch(t.type){case"base64":r=bn(e);break;case"binary":r=e;break;case"buffer":r=e.toString("binary");break;case"array":r=eo(e);break;default:throw new Error("Unrecognized type "+t.type)}return n[0]==239&&n[1]==187&&n[2]==191&&(r=Tt(r)),t.type="binary",VI(r,t)}function eW(e,t){var r=e;return t.type=="base64"&&(r=bn(r)),r=fu.utils.decode(1200,r.slice(2),"str"),t.type="binary",VI(r,t)}function tW(e){return e.match(/[^\x00-\x7F]/)?uc(e):e}function hm(e,t,r,n){return n?(r.type="string",pu.to_workbook(e,r)):pu.to_workbook(t,r)}function gd(e,t){fA();var r=t||{};if(typeof ArrayBuffer<"u"&&e instanceof ArrayBuffer)return gd(new Uint8Array(e),(r=Sr(r),r.type="array",r));typeof Uint8Array<"u"&&e instanceof Uint8Array&&!r.type&&(r.type=typeof Deno<"u"?"buffer":"array");var n=e,s=[0,0,0,0],a=!1;if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),el={},r.dateNF&&(el.dateNF=r.dateNF),r.type||(r.type=et&&Buffer.isBuffer(e)?"buffer":"base64"),r.type=="file"&&(r.type=et?"buffer":"binary",n=W6(e),typeof Uint8Array<"u"&&!et&&(r.type="array")),r.type=="string"&&(a=!0,r.type="binary",r.codepage=65001,n=tW(e)),r.type=="array"&&typeof Uint8Array<"u"&&e instanceof Uint8Array&&typeof ArrayBuffer<"u"){var i=new ArrayBuffer(3),o=new Uint8Array(i);if(o.foo="bar",!o.foo)return r=Sr(r),r.type="array",gd(Jx(n),r)}switch((s=_v(n,r))[0]){case 208:if(s[1]===207&&s[2]===17&&s[3]===224&&s[4]===161&&s[5]===177&&s[6]===26&&s[7]===225)return QB(st.read(n,r),r);break;case 9:if(s[1]<=8)return MI(n,r);break;case 60:return $p(n,r);case 73:if(s[1]===73&&s[2]===42&&s[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(s[1]===68)return C5(n,r);break;case 84:if(s[1]===65&&s[2]===66&&s[3]===76)return I5.to_workbook(n,r);break;case 80:return s[1]===75&&s[2]<9&&s[3]<9?JB(n,r):hm(e,n,r,a);case 239:return s[3]===60?$p(n,r):hm(e,n,r,a);case 255:if(s[1]===254)return eW(n,r);if(s[1]===0&&s[2]===2&&s[3]===0)return Rc.to_workbook(n,r);break;case 0:if(s[1]===0&&(s[2]>=2&&s[3]===0||s[2]===0&&(s[3]===8||s[3]===9)))return Rc.to_workbook(n,r);break;case 3:case 131:case 139:case 140:return jw.to_workbook(n,r);case 123:if(s[1]===92&&s[2]===114&&s[3]===116)return i9.to_workbook(n,r);break;case 10:case 13:case 32:return ZB(n,r);case 137:if(s[1]===80&&s[2]===78&&s[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return S5.indexOf(s[0])>-1&&s[2]<=12&&s[3]<=31?jw.to_workbook(n,r):hm(e,n,r,a)}function rW(e,t,r,n,s,a,i,o){var l=Ar(r),c=o.defval,f=o.raw||!Object.prototype.hasOwnProperty.call(o,"raw"),d=!0,m=s===1?[]:{};if(s!==1)if(Object.defineProperty)try{Object.defineProperty(m,"__rowNum__",{value:r,enumerable:!1})}catch{m.__rowNum__=r}else m.__rowNum__=r;if(!i||e[r])for(var p=t.s.c;p<=t.e.c;++p){var x=i?e[r][p]:e[n[p]+l];if(x===void 0||x.t===void 0){if(c===void 0)continue;a[p]!=null&&(m[a[p]]=c);continue}var g=x.v;switch(x.t){case"z":if(g==null)break;continue;case"e":g=g==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+x.t)}if(a[p]!=null){if(g==null)if(x.t=="e"&&g===null)m[a[p]]=null;else if(c!==void 0)m[a[p]]=c;else if(f&&g===null)m[a[p]]=null;else continue;else m[a[p]]=f&&(x.t!=="n"||x.t==="n"&&o.rawNumbers!==!1)?g:wa(x,g,o);g!=null&&(d=!1)}}return{row:m,isempty:d}}function qp(e,t){if(e==null||e["!ref"]==null)return[];var r={t:"n",v:0},n=0,s=1,a=[],i=0,o="",l={s:{r:0,c:0},e:{r:0,c:0}},c=t||{},f=c.range!=null?c.range:e["!ref"];switch(c.header===1?n=1:c.header==="A"?n=2:Array.isArray(c.header)?n=3:c.header==null&&(n=0),typeof f){case"string":l=$t(f);break;case"number":l=$t(e["!ref"]),l.s.r=f;break;default:l=f}n>0&&(s=0);var d=Ar(l.s.r),m=[],p=[],x=0,g=0,w=Array.isArray(e),k=l.s.r,E=0,y={};w&&!e[k]&&(e[k]=[]);var I=c.skipHidden&&e["!cols"]||[],M=c.skipHidden&&e["!rows"]||[];for(E=l.s.c;E<=l.e.c;++E)if(!(I[E]||{}).hidden)switch(m[E]=or(E),r=w?e[k][E]:e[m[E]+d],n){case 1:a[E]=E-l.s.c;break;case 2:a[E]=m[E];break;case 3:a[E]=c.header[E-l.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),o=i=wa(r,null,c),g=y[i]||0,!g)y[i]=1;else{do o=i+"_"+g++;while(y[o]);y[i]=g,y[o]=1}a[E]=o}for(k=l.s.r+s;k<=l.e.r;++k)if(!(M[k]||{}).hidden){var O=rW(e,l,k,m,n,a,w,c);(O.isempty===!1||(n===1?c.blankrows!==!1:c.blankrows))&&(p[x++]=O.row)}return p.length=x,p}var tE=/"/g;function nW(e,t,r,n,s,a,i,o){for(var l=!0,c=[],f="",d=Ar(r),m=t.s.c;m<=t.e.c;++m)if(n[m]){var p=o.dense?(e[r]||[])[m]:e[n[m]+d];if(p==null)f="";else if(p.v!=null){l=!1,f=""+(o.rawNumbers&&p.t=="n"?p.v:wa(p,null,o));for(var x=0,g=0;x!==f.length;++x)if((g=f.charCodeAt(x))===s||g===a||g===34||o.forceQuotes){f='"'+f.replace(tE,'""')+'"';break}f=="ID"&&(f='"ID"')}else p.f!=null&&!p.F?(l=!1,f="="+p.f,f.indexOf(",")>=0&&(f='"'+f.replace(tE,'""')+'"')):f="";c.push(f)}return o.blankrows===!1&&l?null:c.join(i)}function BI(e,t){var r=[],n=t??{};if(e==null||e["!ref"]==null)return"";var s=$t(e["!ref"]),a=n.FS!==void 0?n.FS:",",i=a.charCodeAt(0),o=n.RS!==void 0?n.RS:`
`,l=o.charCodeAt(0),c=new RegExp((a=="|"?"\\|":a)+"+$"),f="",d=[];n.dense=Array.isArray(e);for(var m=n.skipHidden&&e["!cols"]||[],p=n.skipHidden&&e["!rows"]||[],x=s.s.c;x<=s.e.c;++x)(m[x]||{}).hidden||(d[x]=or(x));for(var g=0,w=s.s.r;w<=s.e.r;++w)(p[w]||{}).hidden||(f=nW(e,s,w,d,i,l,a,n),f!=null&&(n.strip&&(f=f.replace(c,"")),(f||n.blankrows!==!1)&&r.push((g++?o:"")+f)));return delete n.dense,r.join("")}function sW(e,t){t||(t={}),t.FS="	",t.RS=`
`;var r=BI(e,t);return r}function aW(e){var t="",r,n="";if(e==null||e["!ref"]==null)return[];var s=$t(e["!ref"]),a="",i=[],o,l=[],c=Array.isArray(e);for(o=s.s.c;o<=s.e.c;++o)i[o]=or(o);for(var f=s.s.r;f<=s.e.r;++f)for(a=Ar(f),o=s.s.c;o<=s.e.c;++o)if(t=i[o]+a,r=c?(e[f]||[])[o]:e[t],n="",r!==void 0){if(r.F!=null){if(t=r.F,!r.f)continue;n=r.f,t.indexOf(":")==-1&&(t=t+":"+t)}if(r.f!=null)n=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)n=""+r.v;else if(r.t=="b")n=r.v?"TRUE":"FALSE";else if(r.w!==void 0)n="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?n="'"+r.v:n=""+r.v}}l[l.length]=t+"="+n}return l}function WI(e,t,r){var n=r||{},s=+!n.skipHeader,a=e||{},i=0,o=0;if(a&&n.origin!=null)if(typeof n.origin=="number")i=n.origin;else{var l=typeof n.origin=="string"?Qr(n.origin):n.origin;i=l.r,o=l.c}var c,f={s:{c:0,r:0},e:{c:o,r:i+t.length-1+s}};if(a["!ref"]){var d=$t(a["!ref"]);f.e.c=Math.max(f.e.c,d.e.c),f.e.r=Math.max(f.e.r,d.e.r),i==-1&&(i=d.e.r+1,f.e.r=i+t.length-1+s)}else i==-1&&(i=0,f.e.r=t.length-1+s);var m=n.header||[],p=0;t.forEach(function(g,w){Fs(g).forEach(function(k){(p=m.indexOf(k))==-1&&(m[p=m.length]=k);var E=g[k],y="z",I="",M=We({c:o+p,r:i+w+s});c=yu(a,M),E&&typeof E=="object"&&!(E instanceof Date)?a[M]=E:(typeof E=="number"?y="n":typeof E=="boolean"?y="b":typeof E=="string"?y="s":E instanceof Date?(y="d",n.cellDates||(y="n",E=tn(E)),I=n.dateNF||$e[14]):E===null&&n.nullError&&(y="e",E=0),c?(c.t=y,c.v=E,delete c.w,delete c.R,I&&(c.z=I)):a[M]=c={t:y,v:E},I&&(c.z=I))})}),f.e.c=Math.max(f.e.c,o+m.length-1);var x=Ar(i);if(s)for(p=0;p<m.length;++p)a[or(p+o)+x]={t:"s",v:m[p]};return a["!ref"]=at(f),a}function iW(e,t){return WI(null,e,t)}function yu(e,t,r){if(typeof t=="string"){if(Array.isArray(e)){var n=Qr(t);return e[n.r]||(e[n.r]=[]),e[n.r][n.c]||(e[n.r][n.c]={t:"z"})}return e[t]||(e[t]={t:"z"})}return typeof t!="number"?yu(e,We(t)):yu(e,We({r:t,c:r||0}))}function oW(e,t){if(typeof t=="number"){if(t>=0&&e.SheetNames.length>t)return t;throw new Error("Cannot find sheet # "+t)}else if(typeof t=="string"){var r=e.SheetNames.indexOf(t);if(r>-1)return r;throw new Error("Cannot find sheet name |"+t+"|")}else throw new Error("Cannot find sheet |"+t+"|")}function wv(){return{SheetNames:[],Sheets:{}}}function Ev(e,t,r,n){var s=1;if(!r)for(;s<=65535&&e.SheetNames.indexOf(r="Sheet"+s)!=-1;++s,r=void 0);if(!r||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&e.SheetNames.indexOf(r)>=0){var a=r.match(/(^.*?)(\d+)$/);s=a&&+a[2]||0;var i=a&&a[1]||r;for(++s;s<=65535&&e.SheetNames.indexOf(r=i+s)!=-1;++s);}if(H7(r),e.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return e.SheetNames.push(r),e.Sheets[r]=t,r}function lW(e,t,r){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var n=oW(e,t);switch(e.Workbook.Sheets[n]||(e.Workbook.Sheets[n]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}e.Workbook.Sheets[n].Hidden=r}function cW(e,t){return e.z=t,e}function zI(e,t,r){return t?(e.l={Target:t},r&&(e.l.Tooltip=r)):delete e.l,e}function uW(e,t,r){return zI(e,"#"+t,r)}function fW(e,t,r){e.c||(e.c=[]),e.c.push({t,a:r||"SheetJS"})}function hW(e,t,r,n){for(var s=typeof t!="string"?t:$t(t),a=typeof t=="string"?t:at(t),i=s.s.r;i<=s.e.r;++i)for(var o=s.s.c;o<=s.e.c;++o){var l=yu(e,i,o);l.t="n",l.F=a,delete l.v,i==s.s.r&&o==s.s.c&&(l.f=r,n&&(l.D=!0))}return e}var $I={encode_col:or,encode_row:Ar,encode_cell:We,encode_range:at,decode_col:ov,decode_row:iv,split_cell:kj,decode_cell:Qr,decode_range:Cl,format_cell:wa,sheet_add_aoa:KA,sheet_add_json:WI,sheet_add_dom:LI,aoa_to_sheet:bl,json_to_sheet:iW,table_to_sheet:jI,table_to_book:CB,sheet_to_csv:BI,sheet_to_txt:sW,sheet_to_json:qp,sheet_to_html:NB,sheet_to_formulae:aW,sheet_to_row_object_array:qp,sheet_get_cell:yu,book_new:wv,book_append_sheet:Ev,book_set_sheet_visibility:lW,cell_set_number_format:cW,cell_set_hyperlink:zI,cell_set_internal_link:uW,cell_add_comment:fW,sheet_set_array_formula:hW,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};const dW=({omdbApiKey:e,userId:t,onDone:r})=>{const[n,s]=z.useState(null),[a,i]=z.useState([]),[o,l]=z.useState([]),[c,f]=z.useState("upload"),[d,m]=z.useState(0),[p,x]=z.useState(null),[g,w]=z.useState(0),[k,E]=z.useState(!1),[y,I]=z.useState(null),[M,O]=z.useState([]),[v,T]=z.useState(null),S=o.filter(Z=>Z.selected&&Z.tmdbMatch).length,C=Z=>{var q;const fe=(q=Z.target.files)==null?void 0:q[0];if(!fe)return;s(fe);const ue=new FileReader;ue.onload=G=>{var K;const ne=gd((K=G.target)==null?void 0:K.result,{type:"binary"}),ce=ne.Sheets[ne.SheetNames[0]],Y=$I.sheet_to_json(ce).map(V=>({title:V.title||V.Title||V.name||V.Name||"",imdbId:V.imdb||V.IMDB||V.Imdb||V.imdbId||V.imdbID||"",releaseDate:V.year||V.Year||V.releaseDate||V.ReleaseDate||V.release_date||"",watched:V.watched||V.Watched||!1,rating:V.rating||V.Rating||null,review:V.review||V.Review||V.notes||V.Notes||""})).filter(V=>V.title);i(Y)},ue.readAsBinaryString(fe)},b=async()=>{if(!a.length||!e){T("Missing data or OMDb key");return}try{E(!0),T(null),l([]),m(0),x(null);const Z=[],fe=bt(Me,"movies");for(let ue=0;ue<a.length;ue++){const q=a[ue];x(q.title||null);try{let G=null;if(q.imdbId)G=await si(q.imdbId,e);else{const ne=`${q.title} ${q.releaseDate||""}`.trim();let ce=ne||q.title,j=[];try{j=await Vi(ce,e)}catch{j=[]}if(!j.length&&ne&&q.title&&ne!==q.title){ce=q.title;try{j=await Vi(ce,e)}catch{j=[]}}if(!j.length){Z.push({excelData:q,tmdbMatch:null,confidence:0,status:"unmatched",userMovieExists:!1,selected:!1});continue}G=await si(j[0].imdbID,e)}if(!G)Z.push({excelData:q,tmdbMatch:null,confidence:0,status:"unmatched",userMovieExists:!1,selected:!1});else{const ne=sd(q,G),ce=await zt(In(fe,Zr("imdbId","==",G.imdbID)));let j,Y=!1;ce.empty||(j=ce.docs[0].id,Y=!!await Lp(t,j)),Z.push({excelData:q,tmdbMatch:G,confidence:ne,status:Y?"duplicate":ne>=70?"matched":"manual",userMovieExists:Y,movieId:j,selected:!Y})}}catch{Z.push({excelData:q,tmdbMatch:null,confidence:0,status:"unmatched",userMovieExists:!1,selected:!1})}m(Math.round((ue+1)/a.length*100))}l(Z),f("review")}finally{E(!1),x(null)}},P=async(Z,fe)=>{try{E(!0);const ue=o[Z],q=fe||ue.excelData.title,G=await Vi(q,e);I(Z),O(G)}finally{E(!1)}},D=async Z=>{if(y!=null){E(!0);try{const fe=await si(Z.imdbID,e),ue=sd(o[y].excelData,fe),q=bt(Me,"movies"),G=await zt(In(q,Zr("imdbId","==",fe.imdbID)));let ne,ce=!1;G.empty||(ne=G.docs[0].id,ce=!!await Lp(t,ne)),l(j=>{const Y=[...j],K=Y[y];return Y[y]={...K,tmdbMatch:fe,confidence:ue,status:ce?"duplicate":"matched",userMovieExists:ce,movieId:ne,selected:!ce},Y}),I(null),O([])}finally{E(!1)}}},ie=async()=>{const Z=o.filter(ue=>ue.selected&&ue.tmdbMatch);if(!Z.length)return;f("import"),w(0);const fe=bt(Me,"movies");for(let ue=0;ue<Z.length;ue++){const q=Z[ue];try{let G=q.movieId;G||(G=(await Wu(fe,{...uu(q.tmdbMatch),addedAt:new Date,updatedAt:new Date})).id),await i0(t,G,{userId:t,movieId:G,watched:q.excelData.watched||!1,rating:q.excelData.rating||null,review:q.excelData.review||"",favorite:!1})}catch{}w(Math.round((ue+1)/Z.length*100))}r==null||r()};return u.jsxs("div",{className:"space-y-6",children:[c==="upload"&&u.jsxs("div",{className:"space-y-4",children:[u.jsx("input",{type:"file",accept:".xlsx,.xls",className:"file-input file-input-bordered w-full",onChange:C}),!!a.length&&u.jsxs("div",{className:"text-sm opacity-80",children:[a.length," rows detected"]}),u.jsx("button",{className:"btn btn-primary",onClick:b,disabled:!e||!a.length||k,children:k?u.jsx("span",{className:"loading loading-spinner loading-sm"}):"Scan & Match"}),k&&!!d&&d<100&&u.jsxs("div",{className:"space-y-1",children:[u.jsxs("div",{className:"text-sm",children:["Scanning ",d,"%"]}),u.jsx("progress",{className:"progress w-full",value:d,max:100}),p&&u.jsxs("div",{className:"text-xs opacity-70 truncate",children:["Current: ",p]})]})]}),c==="review"&&u.jsxs("div",{className:"space-y-4",children:[u.jsxs("div",{className:"flex justify-between items-center",children:[u.jsx("div",{className:"font-bold",children:"Review Matches"}),u.jsx("button",{className:"btn btn-ghost btn-sm",onClick:()=>f("upload"),children:"Back"})]}),u.jsx("div",{className:"overflow-x-auto",children:u.jsxs("table",{className:"table table-zebra w-full",children:[u.jsx("thead",{children:u.jsxs("tr",{children:[u.jsx("th",{}),u.jsx("th",{children:"Excel"}),u.jsx("th",{children:"Match"}),u.jsx("th",{children:"Confidence"}),u.jsx("th",{children:"Status"}),u.jsx("th",{children:"Action"})]})}),u.jsx("tbody",{children:o.map((Z,fe)=>u.jsxs("tr",{className:Z.userMovieExists?"bg-warning bg-opacity-20":"",children:[u.jsx("td",{children:u.jsx("input",{type:"checkbox",className:"checkbox",checked:Z.selected,disabled:!Z.tmdbMatch,onChange:()=>{const ue=[...o];ue[fe].selected=!ue[fe].selected,l(ue)}})}),u.jsxs("td",{children:[u.jsx("div",{className:"font-semibold",children:Z.excelData.title}),u.jsx("div",{className:"text-xs opacity-70",children:Z.excelData.releaseDate||"-"})]}),u.jsx("td",{children:Z.tmdbMatch?u.jsxs("div",{className:"flex items-center gap-3",children:[u.jsx("div",{className:"w-12 h-18",children:dn(Z.tmdbMatch)?u.jsx("img",{src:dn(Z.tmdbMatch),className:"object-cover"}):u.jsx("div",{className:"w-full h-full bg-base-200"})}),u.jsxs("div",{children:[u.jsx("div",{className:"font-semibold",children:Z.tmdbMatch.Title}),u.jsx("div",{className:"text-xs opacity-70",children:Z.tmdbMatch.Year})]})]}):u.jsx("span",{className:"text-error",children:"No match"})}),u.jsx("td",{children:Z.tmdbMatch?u.jsxs("div",{className:"flex items-center",children:[u.jsx("progress",{className:`progress ${Z.confidence>=70?"progress-success":Z.confidence>=40?"progress-warning":"progress-error"}`,value:Z.confidence,max:100}),u.jsxs("span",{className:"ml-2",children:[Z.confidence,"%"]})]}):"-"}),u.jsxs("td",{children:[Z.status==="matched"&&u.jsx("div",{className:"badge badge-success",children:"Matched"}),Z.status==="unmatched"&&u.jsx("div",{className:"badge badge-error",children:"Unmatched"}),Z.status==="duplicate"&&u.jsx("div",{className:"badge badge-warning",children:"Duplicate"}),Z.status==="manual"&&u.jsx("div",{className:"badge badge-info",children:"Manual"})]}),u.jsx("td",{children:u.jsx("button",{className:"btn btn-sm btn-outline",onClick:()=>P(fe),children:u.jsx("i",{className:"fas fa-search"})})})]},fe))})]})}),u.jsx("div",{className:"flex justify-end",children:u.jsxs("button",{className:"btn btn-primary",onClick:ie,disabled:!S||k,children:["Import ",S," Movies"]})}),!!d&&d<100&&u.jsx("div",{children:u.jsx("progress",{className:"progress w-full",value:d,max:100})})]}),c==="import"&&u.jsxs("div",{className:"space-y-3",children:[u.jsx("div",{className:"font-bold",children:"Importing"}),u.jsx("progress",{className:"progress w-full",value:g,max:100})]}),y!==null&&u.jsx("div",{className:"modal modal-open",children:u.jsxs("div",{className:"modal-box max-w-4xl",children:[u.jsxs("h3",{className:"font-bold text-lg mb-4",children:["Manual match: ",o[y].excelData.title]}),u.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 mb-6",children:[u.jsx("input",{type:"text",className:"input input-bordered flex-1",placeholder:"Search for a movie...",defaultValue:o[y].excelData.title,onKeyDown:Z=>Z.key==="Enter"&&P(y,Z.target.value)}),u.jsx("button",{className:"btn btn-primary w-full sm:w-auto",onClick:()=>{var Z;return P(y,(Z=document.querySelector(".modal input"))==null?void 0:Z.value)},disabled:k,children:k?u.jsx("span",{className:"loading loading-spinner loading-sm"}):u.jsx("i",{className:"fas fa-search"})})]}),u.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-3 max-h-96 overflow-y-auto",children:M.map(Z=>u.jsxs("div",{className:"card bg-base-100 shadow cursor-pointer",onClick:()=>D(Z),children:[u.jsx("figure",{children:dn(Z)?u.jsx("img",{src:dn(Z)}):u.jsx("div",{className:"h-48 w-full bg-base-200"})}),u.jsxs("div",{className:"card-body p-3",children:[u.jsx("div",{className:"text-sm font-semibold",children:Z.Title}),u.jsx("div",{className:"text-xs opacity-70",children:Z.Year})]})]},Z.imdbID))}),u.jsx("div",{className:"modal-action",children:u.jsx("button",{className:"btn",onClick:()=>{I(null),O([])},children:"Close"})})]})}),v&&u.jsx("div",{className:"alert alert-error",children:v})]})},mW=({selected:e,showDetails:t,loading:r,onToggleDetails:n,onAdd:s,onClose:a})=>{var i,o,l,c,f;return e?u.jsx("dialog",{className:"modal modal-open",children:u.jsxs("div",{className:"modal-box bg-xmas-card",children:[u.jsxs("div",{className:"flex gap-4",children:[u.jsx("div",{className:"w-24 shrink-0",children:dn(e)?u.jsx("img",{src:dn(e),alt:e.title,className:"w-full rounded-lg"}):u.jsx("div",{className:"w-full h-36 bg-base-200 flex items-center justify-center rounded-lg",children:u.jsx("i",{className:"fas fa-film text-2xl opacity-50"})})}),u.jsxs("div",{className:"flex-1",children:[u.jsx("h2",{className:"text-xl font-bold mb-1",children:e.title}),u.jsx("p",{className:"text-sm opacity-80 mb-1",children:(i=e.release_date)==null?void 0:i.slice(0,4)}),!t&&e.runtime&&u.jsxs("p",{className:"text-sm opacity-80 mb-1",children:["Runtime: ",e.runtime," min"]}),t&&u.jsxs("div",{className:"mt-3 space-y-2 text-sm opacity-90 max-h-48 overflow-auto pr-1",children:[e.overview&&u.jsxs("div",{children:[u.jsx("p",{className:"font-semibold mb-1",children:"Overview"}),u.jsx("p",{children:e.overview})]}),e.runtime&&u.jsxs("p",{children:[u.jsx("span",{className:"font-semibold",children:"Runtime:"})," ",e.runtime," min"]}),e.genres&&e.genres.length>0&&u.jsxs("p",{children:[u.jsx("span",{className:"font-semibold",children:"Genres:"})," ",e.genres.map(d=>typeof d=="string"?d:d.name).join(", ")]}),(((l=(o=e.credits)==null?void 0:o.cast)==null?void 0:l.length)||((c=e.cast)==null?void 0:c.length))&&u.jsxs("p",{children:[u.jsx("span",{className:"font-semibold",children:"Top cast:"})," ",((f=e.credits)!=null&&f.cast&&e.credits.cast.length>0?e.credits.cast.map(d=>d.name):e.cast).slice(0,5).join(", ")]})]})]})]}),u.jsx("div",{className:"mt-4 space-y-3",children:u.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-3",children:[u.jsx("div",{children:(e.overview||e.runtime||e.genres||e.credits||e.cast)&&u.jsxs("button",{type:"button",className:"btn btn-outline btn-sm sm:btn-md gap-2",onClick:n,disabled:r,children:[u.jsx("i",{className:"fas fa-info-circle"}),t?"Hide details":"View details"]})}),u.jsxs("div",{className:"flex justify-end gap-2",children:[u.jsxs("button",{className:"btn btn-primary btn-sm sm:btn-md",onClick:s,disabled:r,children:[r?u.jsx("span",{className:"loading loading-spinner loading-sm mr-2"}):u.jsx("i",{className:"fas fa-plus mr-2"}),"Add Movie"]}),u.jsx("button",{className:"btn btn-outline btn-sm sm:btn-md",onClick:a,disabled:r,children:"Cancel"})]})]})}),u.jsx("form",{method:"dialog",className:"modal-backdrop",onClick:a,children:u.jsx("button",{children:"close"})})]})}):null},pW=()=>{const{currentUser:e,userProfile:t}=Dn(),[r,n]=z.useState(!1),[s,a]=z.useState(""),[i,o]=z.useState(""),[l,c]=z.useState(""),[f,d]=z.useState(""),[m,p]=z.useState(""),[x,g]=z.useState(!1),[w,k]=z.useState(null),[E,y]=z.useState(null);z.useEffect(()=>{i&&!l&&c(`https://www.themoviedb.org/movie/${i}`)},[i,l]);const I=()=>{a(""),o(""),c(""),d(""),p(""),k(null)},M=()=>{if(k(null),y(null),!e){k("Please sign in to request a movie.");return}n(!0)},O=()=>{x||(n(!1),I())},v=async T=>{if(T.preventDefault(),!e){k("You must be signed in to submit a request.");return}if(!s.trim()){k("Please enter a movie title.");return}try{g(!0),k(null),await Wu(bt(Me,"Requests"),{title:s.trim(),tmdbId:i?Number(i):null,tmdbUrl:l.trim()||null,year:f.trim()||null,notes:m.trim()||null,userId:e.uid,userDisplayName:(t==null?void 0:t.displayName)||e.displayName||null,status:"pending",createdAt:new Date}),y("Request submitted! Thank you."),I(),n(!1)}catch(S){console.error("Failed to submit movie request:",S),k((S==null?void 0:S.message)||"Failed to submit request. Please try again.")}finally{g(!1)}};return u.jsxs(u.Fragment,{children:[u.jsxs("button",{type:"button",className:"btn btn-outline btn-sm sm:btn-md mb-4",onClick:M,children:[u.jsx("i",{className:"fas fa-gift mr-2"}),"Request a movie"]}),w&&!r&&u.jsxs("div",{className:"alert alert-warning mb-4",children:[u.jsx("i",{className:"fas fa-exclamation-triangle mr-2"}),u.jsx("span",{children:w})]}),E&&!r&&u.jsxs("div",{className:"alert alert-success mb-4",children:[u.jsx("i",{className:"fas fa-check-circle mr-2"}),u.jsx("span",{children:E})]}),r&&u.jsx("dialog",{className:"modal modal-open",children:u.jsxs("div",{className:"modal-box bg-xmas-card max-w-lg",children:[u.jsx("h2",{className:"font-christmas text-2xl mb-2 text-xmas-gold",children:"Request a Movie"}),u.jsx("p",{className:"text-sm mb-4 opacity-80",children:"Can't find a movie in the catalogue? Tell us about it so we can add it."}),w&&u.jsxs("div",{className:"alert alert-error mb-3",children:[u.jsx("i",{className:"fas fa-exclamation-circle mr-2"}),u.jsx("span",{children:w})]}),u.jsxs("form",{className:"space-y-3",onSubmit:v,children:[u.jsxs("div",{children:[u.jsx("label",{className:"label",children:u.jsx("span",{className:"label-text",children:"Movie title *"})}),u.jsx("input",{type:"text",className:"input input-bordered w-full",value:s,onChange:T=>a(T.target.value),required:!0,disabled:x,placeholder:"e.g. The Grinch"})]}),u.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:[u.jsxs("div",{children:[u.jsx("label",{className:"label",children:u.jsx("span",{className:"label-text",children:"TMDB ID (optional)"})}),u.jsx("input",{type:"number",className:"input input-bordered w-full",value:i,onChange:T=>o(T.target.value),disabled:x,placeholder:"e.g. 8871"})]}),u.jsxs("div",{children:[u.jsx("label",{className:"label",children:u.jsx("span",{className:"label-text",children:"Release year (optional)"})}),u.jsx("input",{type:"number",className:"input input-bordered w-full",value:f,onChange:T=>d(T.target.value),disabled:x,placeholder:"e.g. 2000"})]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"label",children:u.jsx("span",{className:"label-text",children:"TMDB URL (optional)"})}),u.jsx("input",{type:"url",className:"input input-bordered w-full",value:l,onChange:T=>c(T.target.value),disabled:x,placeholder:"https://www.themoviedb.org/movie/..."}),u.jsx("p",{className:"text-xs opacity-70 mt-1",children:"If you provide a TMDB ID, the URL will be auto-filled. You can also paste a URL directly."})]}),u.jsxs("div",{children:[u.jsx("label",{className:"label",children:u.jsx("span",{className:"label-text",children:"Anything else that helps? (optional)"})}),u.jsx("textarea",{className:"textarea textarea-bordered w-full",rows:3,value:m,onChange:T=>p(T.target.value),disabled:x,placeholder:"Actors, streaming service, or where you heard about it."})]}),u.jsxs("div",{className:"modal-action flex justify-end gap-2",children:[u.jsx("button",{type:"button",className:"btn btn-ghost",onClick:O,disabled:x,children:"Cancel"}),u.jsxs("button",{type:"submit",className:"btn btn-primary",disabled:x,children:[x&&u.jsx("span",{className:"loading loading-spinner loading-sm mr-2"}),"Submit request"]})]})]}),u.jsx("form",{method:"dialog",className:"modal-backdrop",onClick:O,children:u.jsx("button",{children:"close"})})]})})]})},gW=()=>{const{currentUser:e,userProfile:t}=Dn(),{isAdmin:r}=zu(),[n,s]=z.useState(""),[a,i]=z.useState("local"),[o,l]=z.useState(null),[c,f]=z.useState(!1),[d,m]=z.useState(!1),[p,x]=z.useState(null),[g,w]=z.useState([]);z.useEffect(()=>{r&&(t!=null&&t.omdbApiKey)?s(t.omdbApiKey):s("")},[t,r]),z.useEffect(()=>{(async()=>{if(!e){w([]);return}try{const{userMovies:O}=await $u(e.uid);w(Object.keys(O))}catch(O){console.error("Error loading user movies for import page:",O)}})()},[e]);const k=M=>{x(null),f(!1),l(M)},E=async M=>{if(!r){x({type:"error",text:"Only admins can import directly from OMDb."});return}if(!n){x({type:"error",text:"OMDb key required to fetch details."});return}try{m(!0),x(null),f(!1);const O=await si(M.imdbID,n);l(O)}catch(O){x({type:"error",text:(O==null?void 0:O.message)??"Failed to fetch details"})}finally{m(!1)}},y=async()=>{if(!(!e||!o))try{m(!0),x(null);const M=bt(Me,"movies");let O;if(o.firestoreId)O=o.firestoreId;else{const v=o.imdbID||o.imdbId;if(!v){x({type:"error",text:"Cannot add movie: missing IMDb id."}),m(!1);return}const T=await zt(In(M,Zr("imdbId","==",v)));if(T.empty){if(!r){x({type:"error",text:"Only admins can add new catalogue movies."}),m(!1);return}O=(await Wu(M,{...uu(o),addedAt:new Date,updatedAt:new Date})).id}else O=T.docs[0].id}await i0(e.uid,O,{userId:e.uid,movieId:O,watched:!1,favorite:!1}),w(v=>v.includes(O)?v:[...v,O]),aA(),x({type:"success",text:"Added to your collection!"}),f(!1),l(null)}catch(M){x({type:"error",text:(M==null?void 0:M.message)??"Failed to add movie"})}finally{m(!1)}},I=()=>{d||l(null)};return u.jsxs("div",{className:"container mx-auto px-4 py-8",children:[u.jsx("div",{className:"mb-4",children:u.jsxs(Xe,{to:"/movies",className:"btn btn-primary btn-sm sm:btn-md",children:[u.jsx("i",{className:"fas fa-arrow-left mr-2"})," Back to Movies"]})}),u.jsx("h1",{className:"font-christmas text-3xl md:text-4xl text-xmas-line mb-6",children:"Add Movies"}),p&&u.jsxs("div",{className:`alert ${p.type==="error"?"alert-error":"alert-success"} mb-4`,children:[u.jsx("i",{className:`fas ${p.type==="error"?"fa-exclamation-circle":"fa-check-circle"} mr-2`}),u.jsx("span",{children:p.text})]}),u.jsx("div",{className:"mb-4",children:u.jsx(pW,{})}),r&&u.jsxs("div",{className:"tabs tabs-boxed mb-6",children:[u.jsxs("button",{className:`tab ${a==="local"?"tab-active":""}`,onClick:()=>i("local"),children:[u.jsx("i",{className:"fas fa-database mr-2"}),"Local"]}),u.jsxs("button",{className:`tab ${a==="tmdb"?"tab-active":""}`,onClick:()=>i("tmdb"),children:[u.jsx("i",{className:"fas fa-search mr-2"}),"OMDb"]}),u.jsxs("button",{className:`tab ${a==="excel"?"tab-active":""}`,onClick:()=>i("excel"),children:[u.jsx("i",{className:"fas fa-file-excel mr-2"}),"Excel"]})]}),a==="local"&&u.jsx("div",{className:"bg-xmas-card p-6 rounded-lg shadow-lg",children:u.jsx(c6,{onSelect:k,userMovieIds:g})}),a==="tmdb"&&r&&u.jsxs("div",{className:"bg-xmas-card p-6 rounded-lg shadow-lg",children:[!n&&u.jsxs("div",{className:"alert alert-warning mb-4",children:[u.jsx("i",{className:"fas fa-exclamation-triangle mr-2"}),u.jsx("span",{children:"Set your OMDb API key in Profile to search OMDb."})]}),u.jsx(f6,{omdbApiKey:n,onSelect:E})]}),a==="excel"&&r&&u.jsxs("div",{className:"bg-xmas-card p-6 rounded-lg shadow-lg",children:[!n&&u.jsxs("div",{className:"alert alert-warning mb-4",children:[u.jsx("i",{className:"fas fa-exclamation-triangle mr-2"}),u.jsx("span",{children:"OMDb key required for matching."})]}),e?u.jsx(dW,{omdbApiKey:n,userId:e.uid,onDone:()=>i("local")}):u.jsx("div",{className:"alert alert-info",children:"Log in to import from Excel."})]}),o&&u.jsx(mW,{selected:o,showDetails:c,loading:d,onToggleDetails:()=>f(M=>!M),onAdd:y,onClose:I})]})},xW=()=>{var w,k,E;const{currentUser:e}=Dn(),[t,r]=z.useState([]),[n,s]=z.useState({}),[a,i]=z.useState(!0),[o,l]=z.useState(null),[c,f]=z.useState(null),[d,m]=z.useState(!1),[p,x]=z.useState(!1);z.useEffect(()=>{(async()=>{if(e)try{i(!0);const{userMovies:I,movies:M}=await $u(e.uid);s(I),r(M)}catch(I){console.error("Error fetching movies:",I),l("Failed to load movies")}finally{i(!1)}})()},[e]);const g=()=>{if(t.length===0)return;x(!0),f(null);const y=t.filter(v=>{const T=n[v.id];return d||!T||!T.watched});if(y.length===0){l("No eligible movies found. Try including watched movies."),x(!1);return}let I=0;const M=25,O=setInterval(()=>{const v=Math.floor(Math.random()*y.length);f(y[v]),I++,I>=M&&(clearInterval(O),x(!1))},100)};return a?u.jsx("div",{className:"flex justify-center items-center min-h-[60vh]",children:u.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-xmas-gold"})}):u.jsxs("div",{className:"container mx-auto px-4 py-8",children:[u.jsx("div",{className:"mb-4",children:u.jsxs(Xe,{to:"/movies",className:"btn btn-primary btn-sm sm:btn-md",children:[u.jsx("i",{className:"fas fa-arrow-left mr-2"})," Back to Movies"]})}),u.jsx("h1",{className:"font-christmas text-3xl md:text-4xl text-xmas-line mb-6",children:"Christmas Movie Picker"}),o&&u.jsxs("div",{className:"alert alert-error mb-6",children:[u.jsx("i",{className:"fas fa-exclamation-circle mr-2"}),u.jsx("span",{children:o})]}),t.length===0?u.jsxs("div",{className:"bg-xmas-card p-8 rounded-lg text-center",children:[u.jsx("h3",{className:"text-xl mb-4",children:"No movies in your collection"}),u.jsx("p",{className:"mb-4",children:"Add some Christmas movies to use the random movie picker!"}),u.jsxs(Xe,{to:"/import",className:"btn btn-primary",children:[u.jsx("i",{className:"fas fa-file-import mr-2"})," Import Movies"]})]}):u.jsxs("div",{className:"bg-xmas-card p-8 rounded-lg shadow-lg",children:[u.jsxs("div",{className:"text-center mb-6",children:[u.jsx("p",{className:"mb-4",children:"Can't decide what Christmas movie to watch? Let us pick one for you!"}),u.jsx("div",{className:"form-control mb-6",children:u.jsxs("label",{className:"label cursor-pointer justify-center",children:[u.jsx("span",{className:"label-text mr-2",children:"Include watched movies"}),u.jsx("input",{type:"checkbox",className:"toggle toggle-primary",checked:d,onChange:()=>m(!d)})]})}),u.jsx("button",{className:"btn btn-primary btn-lg",onClick:g,disabled:p,children:p?u.jsxs(u.Fragment,{children:[u.jsx("span",{className:"loading loading-spinner loading-md mr-2"}),"Picking a movie..."]}):u.jsxs(u.Fragment,{children:[u.jsx("i",{className:"fas fa-random mr-2"}),"Pick a Random Movie"]})})]}),c&&u.jsx("div",{className:"mt-8 flex flex-col items-center",children:u.jsx("div",{className:"w-full max-w-md",children:u.jsxs("div",{className:"card bg-base-100 shadow-xl overflow-hidden",children:[u.jsxs("figure",{className:"relative",children:[c.posterUrl?u.jsx("img",{src:c.posterUrl,alt:c.title,className:"w-full object-contain",style:{aspectRatio:"2/3",maxHeight:"500px"},loading:"lazy"}):u.jsx("div",{className:"w-full flex items-center justify-center bg-gray-800",style:{aspectRatio:"2/3",maxHeight:"500px"},children:u.jsx("i",{className:"fas fa-film text-6xl text-gray-500"})}),((w=n[c.id])==null?void 0:w.watched)&&u.jsx("div",{className:"absolute top-4 left-4 badge badge-lg badge-success",children:"Already Watched"}),((k=n[c.id])==null?void 0:k.rating)&&u.jsxs("div",{className:"absolute top-4 right-4 badge badge-lg badge-warning",children:[u.jsx("i",{className:"fas fa-star mr-1"}),n[c.id].rating,"/10"]})]}),u.jsxs("div",{className:"card-body",children:[u.jsx("h2",{className:"card-title text-2xl font-christmas",children:c.title}),u.jsx("p",{className:"text-gray-400",children:(E=c.releaseDate)==null?void 0:E.substring(0,4)}),u.jsxs("div",{className:"card-actions justify-end mt-4",children:[u.jsx(Xe,{to:Yx(c.title,c.id),className:"btn btn-primary",children:"View Details"}),u.jsx("button",{className:"btn btn-outline",onClick:g,disabled:p,children:"Pick Another"})]})]})]})})})]})]})},vW=(e,t)=>{const r=["Title","TMDB ID","Release Year","Watched","Watched Date","Rating","Review","Favorite","Date Added"].join(","),n=e.map(s=>{const a=t[s.id];if(!a)return null;const i=s.releaseDate?s.releaseDate.substring(0,4):"",o=a.watchedDate?Yp(a.watchedDate):"",l=a.addedAt?Yp(a.addedAt):"",c=rE(s.title),f=a.review?rE(a.review):"";return[c,s.imdbId||"",i,a.watched?"Yes":"No",o,a.rating!==null&&a.rating!==void 0?a.rating:"",f,a.favorite?"Yes":"No",l].join(",")}).filter(Boolean);return[r,...n].join(`
`)},Yp=e=>{if(!(e instanceof Date))try{e&&typeof e.toDate=="function"?e=e.toDate():e=new Date(e)}catch{return""}return e.toISOString().split("T")[0]},rE=e=>e?e.includes(",")||e.includes('"')||e.includes(`
`)?`"${e.replace(/"/g,'""')}"`:e:"",yW=(e,t,r)=>{const n=document.createElement("a"),s=new Blob([e],{type:r});n.href=URL.createObjectURL(s),n.download=t,n.click(),URL.revokeObjectURL(n.href)},_W=async(e,t,r)=>{const n=vW(e,t),s=`${r.replace(/\s+/g,"_")}_christmas_movies_${Yp(new Date)}.csv`;yW(n,s,"text/csv;charset=utf-8;")},wW=async()=>{const e=bt(Me,"movies"),t=await zt(e);let r=0;const n=t.size;for(const s of t.docs){const a=s.data();if(a.sortTitle)continue;const i=oA(a.title);i!==a.title&&(await hi(Ft(Me,"movies",s.id),{sortTitle:i,updatedAt:new Date}),r++)}return{updated:r,total:n}},EW=()=>{const{currentUser:e}=Dn(),[t,r]=z.useState([]),[n,s]=z.useState(!1),[a,i]=z.useState(null),[o,l]=z.useState(null),[c,f]=z.useState(new Set);z.useEffect(()=>{(async()=>{if(e){s(!0),i(null);try{const g=In(bt(Me,"Requests"),Zr("userId","==",e.uid)),k=(await zt(g)).docs.map(E=>{const y=E.data();return{id:E.id,title:y.title,year:y.year??null,status:y.status,tmdbId:y.tmdbId??null,createdAt:y.createdAt,updatedAt:y.updatedAt}});if(r(k),e&&k.length>0){const E=[];for(const y of k){if(y.status!=="fulfilled"||!y.tmdbId)continue;const I=bt(Me,"movies"),M=In(I,Zr("tmdbId","==",y.tmdbId)),O=await zt(M);if(O.empty)continue;const T=O.docs[0].id,S=Ft(Me,`users/${e.uid}/movies`,T);(await Nn(S)).exists()&&E.push(y.id)}E.length>0&&f(new Set(E))}}catch(g){console.error("Error loading your movie requests:",g),i(g.message||"Failed to load your movie requests")}finally{s(!1)}}})()},[e]);const d=x=>{if(!x)return"";const g=x!=null&&x.toDate?x.toDate():x;try{return new Date(g).toLocaleString()}catch{return""}},m=x=>x==="fulfilled"?"badge badge-success":x==="dismissed"?"badge badge-ghost":"badge badge-warning",p=async x=>{if(e){if(!x.tmdbId){i("This request does not have a TMDB ID to match a movie.");return}try{i(null),l(x.id);const g=bt(Me,"movies"),w=In(g,Zr("tmdbId","==",x.tmdbId)),k=await zt(w);if(k.empty){i("Could not find this movie in the catalogue yet.");return}const y=k.docs[0].id;await i0(e.uid,y,{userId:e.uid,movieId:y,watched:!1,favorite:!1}),f(I=>new Set(I).add(x.id))}catch(g){console.error("Failed to add movie to your collection:",g),i(g.message||"Failed to add movie to your collection")}finally{l(null)}}};return u.jsxs("div",{className:"mt-8",children:[u.jsx("h3",{className:"text-lg font-bold mb-2",children:"My Movie Requests"}),u.jsx("p",{className:"text-sm opacity-80 mb-4",children:"These are movies you've asked to be added to the catalogue."}),n&&u.jsx("div",{className:"flex justify-center py-4",children:u.jsx("span",{className:"loading loading-spinner loading-md"})}),a&&u.jsxs("div",{className:"alert alert-error mb-4",children:[u.jsx("i",{className:"fas fa-exclamation-circle mr-2"}),u.jsx("span",{children:a})]}),!n&&!a&&t.length===0&&u.jsx("p",{className:"text-sm opacity-80",children:"You haven't requested any movies yet."}),!n&&!a&&t.length>0&&u.jsx("div",{className:"overflow-x-auto",children:u.jsxs("table",{className:"table table-zebra table-sm",children:[u.jsx("thead",{children:u.jsxs("tr",{children:[u.jsx("th",{children:"Title"}),u.jsx("th",{children:"Year"}),u.jsx("th",{children:"Status"}),u.jsx("th",{children:"Last Updated"}),u.jsx("th",{})]})}),u.jsx("tbody",{children:t.map(x=>u.jsxs("tr",{children:[u.jsx("td",{children:x.title}),u.jsx("td",{children:x.year||"-"}),u.jsx("td",{children:u.jsx("span",{className:m(x.status),children:x.status})}),u.jsx("td",{className:"text-xs",children:d(x.updatedAt||x.createdAt)}),u.jsx("td",{children:x.status==="fulfilled"&&x.tmdbId&&(c.has(x.id)?u.jsx("span",{className:"badge badge-success text-xs",children:"In collection"}):u.jsxs("button",{className:"btn btn-xs btn-primary",onClick:()=>p(x),disabled:o===x.id,children:[o===x.id&&u.jsx("span",{className:"loading loading-spinner loading-xs mr-1"}),"Add to my movies"]}))})]},x.id))})]})})]})},TW=()=>{const{currentUser:e,userProfile:t,signOut:r}=Dn(),{isAdmin:n}=zu(),[s,a]=z.useState(!1),[i,o]=z.useState(""),[l,c]=z.useState(!1),[f,d]=z.useState(!1),[m,p]=z.useState(!1),[x,g]=z.useState(null),[w,k]=z.useState(null),[E,y]=z.useState({totalMovies:0,watchedMovies:0,unwatchedMovies:0,averageRating:0,favoriteMovies:0});z.useEffect(()=>{t!=null&&t.omdbApiKey&&o(t.omdbApiKey),(async()=>{if(e)try{const T=await iA(e.uid),S=T.length,C=T.filter(Z=>Z.watched).length,b=S-C,P=T.filter(Z=>Z.favorite).length,D=T.filter(Z=>Z.rating!==void 0&&Z.rating!==null),ie=D.length>0?D.reduce((Z,fe)=>Z+(fe.rating||0),0)/D.length:0;y({totalMovies:S,watchedMovies:C,unwatchedMovies:b,averageRating:ie,favoriteMovies:P})}catch(T){console.error("Error fetching user stats:",T)}})()},[e,t]);const I=async()=>{if(e)try{c(!0),g(null);const v=Ft(Me,"users",e.uid);await hi(v,{omdbApiKey:i}),k("OMDb API key saved successfully!"),setTimeout(()=>{k(null)},3e3)}catch(v){console.error("Error saving API key:",v),g(v.message||"Failed to save API key")}finally{c(!1)}},M=async()=>{try{await r()}catch(v){console.error("Error signing out:",v)}},O=async()=>{if(e)try{d(!0),g(null);const{userMovies:v,movies:T}=await $u(e.uid);await _W(T,v,t.displayName||"User"),k("Movies exported successfully!"),setTimeout(()=>{k(null)},3e3)}catch(v){console.error("Error exporting movies:",v),g(v.message||"Failed to export movies")}finally{d(!1)}};return!e||!t?u.jsx("div",{className:"flex justify-center items-center min-h-[60vh]",children:u.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-xmas-gold"})}):u.jsxs("div",{className:"container mx-auto px-4 py-8",children:[u.jsx("h1",{className:"font-christmas text-3xl md:text-4xl text-xmas-line mb-6",children:"Your Profile"}),x&&u.jsxs("div",{className:"alert alert-error mb-6",children:[u.jsx("i",{className:"fas fa-exclamation-circle mr-2"}),u.jsx("span",{children:x})]}),w&&u.jsxs("div",{className:"alert alert-success mb-6",children:[u.jsx("i",{className:"fas fa-check-circle mr-2"}),u.jsx("span",{children:w})]}),u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-8",children:[u.jsx("div",{className:"md:col-span-1",children:u.jsxs("div",{className:"bg-xmas-card p-6 rounded-lg shadow-lg",children:[u.jsxs("div",{className:"flex flex-col items-center mb-6",children:[t.photoURL?u.jsx("img",{src:t.photoURL,alt:t.displayName,className:"w-24 h-24 rounded-full mb-4"}):u.jsx("div",{className:"w-24 h-24 rounded-full bg-gray-700 flex items-center justify-center mb-4",children:u.jsx("i",{className:"fas fa-user text-4xl text-gray-400"})}),u.jsx("h2",{className:"text-xl font-bold",children:t.displayName})]}),u.jsx("div",{className:"divider"}),u.jsxs("div",{className:"mb-6",children:[u.jsx("h3",{className:"text-lg font-bold mb-2",children:"Your Stats"}),u.jsxs("ul",{className:"space-y-2",children:[u.jsxs("li",{className:"flex justify-between",children:[u.jsx("span",{children:"Total Movies:"}),u.jsx("span",{className:"font-bold",children:E.totalMovies})]}),u.jsxs("li",{className:"flex justify-between",children:[u.jsx("span",{children:"Watched:"}),u.jsx("span",{className:"font-bold",children:E.watchedMovies})]}),u.jsxs("li",{className:"flex justify-between",children:[u.jsx("span",{children:"Unwatched:"}),u.jsx("span",{className:"font-bold",children:E.unwatchedMovies})]}),u.jsxs("li",{className:"flex justify-between",children:[u.jsx("span",{children:"Favorites:"}),u.jsx("span",{className:"font-bold",children:E.favoriteMovies})]}),u.jsxs("li",{className:"flex justify-between",children:[u.jsx("span",{children:"Average Rating:"}),u.jsxs("span",{className:"font-bold",children:[E.averageRating.toFixed(1),"/10"]})]})]})]}),u.jsx("div",{className:"divider"}),u.jsxs("div",{className:"mt-6 space-y-3",children:[u.jsxs("button",{className:"btn btn-outline btn-primary w-full",onClick:O,disabled:f||E.totalMovies===0,children:[f?u.jsx("span",{className:"loading loading-spinner loading-sm mr-2"}):u.jsx("i",{className:"fas fa-file-export mr-2"}),"Export Movie Data"]}),u.jsxs("button",{className:"btn btn-outline btn-error w-full",onClick:M,children:[u.jsx("i",{className:"fas fa-sign-out-alt mr-2"}),"Sign Out"]})]})]})}),u.jsx("div",{className:"md:col-span-2",children:u.jsxs("div",{className:"bg-xmas-card p-6 rounded-lg shadow-lg",children:[n&&u.jsxs(u.Fragment,{children:[u.jsx("h2",{className:"text-2xl font-bold mb-4",children:"Settings"}),u.jsxs("div",{className:"mb-6",children:[u.jsx("h3",{className:"text-lg font-bold mb-2",children:"OMDb API Key"}),u.jsx("p",{className:"mb-4",children:"Your OMDb API key is used to fetch movies and other details from the Open Movie Database."}),u.jsxs("div",{className:"form-control",children:[u.jsx("label",{className:"label",children:u.jsx("span",{className:"label-text",children:"API Key"})}),u.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 items-stretch",children:[u.jsx("input",{type:s?"text":"password",className:"input input-bordered flex-1 h-12 text-lg",value:i,onChange:v=>o(v.target.value),placeholder:"Enter your OMDb API key",style:{letterSpacing:s?"normal":"3px"}}),u.jsx("button",{type:"button",className:"btn btn-ghost w-12",onClick:()=>a(v=>!v),children:u.jsx("i",{className:`fas ${s?"fa-eye-slash":"fa-eye"}`})}),u.jsx("button",{className:"btn btn-primary w-full sm:w-auto",onClick:I,disabled:l,children:l?u.jsx("span",{className:"loading loading-spinner loading-sm"}):u.jsx("i",{className:"fas fa-save"})})]})]})]}),u.jsx("div",{className:"divider"})]}),u.jsxs("div",{className:"mb-6",children:[u.jsx("h3",{className:"text-lg font-bold mb-2",children:"Quick Links"}),u.jsxs("div",{className:"flex flex-wrap gap-2",children:[u.jsxs(Xe,{to:"/movies",className:"btn btn-outline btn-sm",children:[u.jsx("i",{className:"fas fa-film mr-2"}),"My Movies"]}),u.jsxs(Xe,{to:"/import",className:"btn btn-outline btn-sm",children:[u.jsx("i",{className:"fas fa-file-import mr-2"}),"Add Movies"]}),u.jsxs(Xe,{to:"/random",className:"btn btn-outline btn-sm",children:[u.jsx("i",{className:"fas fa-random mr-2"}),"Random Movie Picker"]}),u.jsxs(Xe,{to:"/achievements",className:"btn btn-outline btn-sm",children:[u.jsx("i",{className:"fas fa-trophy mr-2"}),"Achievements"]})]})]}),u.jsx(EW,{}),n&&u.jsxs(u.Fragment,{children:[u.jsx("div",{className:"divider"}),u.jsxs("div",{className:"mb-6",children:[u.jsx("h3",{className:"text-lg font-bold mb-2",children:"Admin Tools"}),u.jsxs(Xe,{to:"/admin",className:"btn btn-primary btn-sm",children:[u.jsx("i",{className:"fas fa-tools mr-2"}),"Open Admin Dashboard"]})]})]})]})})]})]})},kW=({item:e})=>{const[t,r]=wu.useState(!1);return u.jsxs("div",{className:"rounded-lg p-4 shadow-lg border transition-transform bg-xmas-card "+(e.unlocked?"border-xmas-gold hover:scale-[1.02]":"border-gray-700 opacity-70"),children:[u.jsxs("div",{className:"flex items-center mb-3",children:[u.jsx("div",{className:"relative mr-3 w-16 h-16 rounded-full overflow-hidden border border-xmas-gold/60 bg-gray-800 flex items-center justify-center",children:t?u.jsx("span",{className:"text-3xl",children:e.icon}):u.jsx("img",{src:`/achievements/${e.id}.png`,alt:e.name,className:"w-full h-full object-cover",loading:"lazy",onError:()=>r(!0)})}),u.jsxs("div",{children:[u.jsxs("h2",{className:"text-lg font-bold flex items-center gap-2",children:[e.name,e.unlocked&&u.jsx("span",{className:"badge badge-success badge-sm",children:"Unlocked"})]}),e.unlocked&&e.unlockedAt&&u.jsxs("p",{className:"text-xs text-xmas-text/70 mt-1",children:["Unlocked on"," ",e.unlockedAt.toLocaleDateString(void 0,{year:"numeric",month:"short",day:"numeric"})]})]})]}),u.jsx("p",{className:"text-sm text-xmas-text mb-3",children:e.unlocked?e.description:e.hint}),!e.unlocked&&u.jsx("p",{className:"text-xs text-xmas-text/60 italic",children:"Locked  keep watching to reveal this badge."})]})},SW=()=>{const{currentUser:e}=Dn(),[t,r]=z.useState(!0),[n,s]=z.useState([]);return z.useEffect(()=>{(async()=>{if(e)try{r(!0),await fh(e.uid);const i=bt(Me,`users/${e.uid}/achievements`),o=await zt(i),l=new Map;o.forEach(f=>{const d=f.data();let m=null;d.unlockedAt instanceof Date?m=d.unlockedAt:d.unlockedAt&&typeof d.unlockedAt.toDate=="function"&&(m=d.unlockedAt.toDate()),l.set(f.id,{unlockedAt:m,seen:d.seen})});const c=Qo.map(f=>{const d=l.get(f.id);return{id:f.id,name:f.name,description:f.description,hint:f.hint,icon:f.icon,unlocked:!!d,unlockedAt:(d==null?void 0:d.unlockedAt)??null}}).sort((f,d)=>{if(f.unlocked!==d.unlocked)return f.unlocked?-1:1;if(f.unlocked&&d.unlocked){const m=f.unlockedAt?f.unlockedAt.getTime():0,p=d.unlockedAt?d.unlockedAt.getTime():0;if(m!==p)return m-p}return f.name.localeCompare(d.name)});s(c)}finally{r(!1)}})()},[e]),e?t?u.jsx("div",{className:"flex justify-center items-center min-h-[60vh]",children:u.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-xmas-gold"})}):u.jsxs("div",{className:"container mx-auto px-4 py-8",children:[u.jsx("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between mb-6",children:u.jsxs("div",{children:[u.jsx("h1",{className:"font-christmas text-3xl md:text-4xl text-xmas-line mb-2",children:"Achievements"}),u.jsx("p",{className:"text-sm text-xmas-text/80",children:"Unlock festive badges as you watch, rate and explore your Christmas movies."})]})}),u.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-3 gap-6",children:n.map(a=>u.jsx(kW,{item:a},a.id))})]}):u.jsx("div",{className:"flex justify-center items-center min-h-[60vh]",children:u.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-xmas-gold"})})},AW=()=>{const{slug:e}=Xg(),[t,r]=z.useState(null),[n,s]=z.useState([]),[a,i]=z.useState({}),[o,l]=z.useState(null),[c,f]=z.useState(!0),[d,m]=z.useState(null);if(z.useEffect(()=>{(async()=>{if(e)try{f(!0),m(null);const w=bt(Me,"publicProfiles"),k=In(w,Zr("publicWatchlistSlug","==",e),Zr("isPublicWatchlist","==",!0)),E=await zt(k);if(E.empty){m("This watchlist isn't public (or no longer exists)."),f(!1);return}const y=E.docs[0],I={id:y.id,...y.data()};r(I);const M=I.userId,{userMovies:O,movies:v}=await $u(M),T=v.filter(D=>{const ie=O[D.id];return ie&&ie.watched}).sort((D,ie)=>{const Z=O[D.id],fe=O[ie.id],ue=(Z==null?void 0:Z.rating)??0,q=(fe==null?void 0:fe.rating)??0;return q!==ue?q-ue:D.title.localeCompare(ie.title)}),S={};T.forEach(D=>{S[D.id]=O[D.id]});const C=T.map(D=>S[D.id]).filter(D=>D&&D.rating!=null),b=C.length>0?C.reduce((D,ie)=>D+(ie.rating||0),0)/C.length:0,P=T.filter(D=>{var ie;return(ie=S[D.id])==null?void 0:ie.favorite}).length;s(T),i(S),l({totalWatched:T.length,averageRating:b,favoriteMovies:P})}catch(w){console.error("Error loading public watchlist:",w),m("This watchlist isn't public (or no longer exists).")}finally{f(!1)}})()},[e]),z.useEffect(()=>{if(!(typeof document>"u"))if(t){const g=t.publicWatchlistName||`${t.displayName}'s Xmas Watchlist`;document.title=`${g}  Christmas Movies`}else document.title="Christmas Movies"},[t]),c)return u.jsx("div",{className:"flex justify-center items-center min-h-[60vh]",children:u.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-xmas-gold"})});if(d||!t)return u.jsx("div",{className:"container mx-auto px-4 py-16",children:u.jsxs("div",{className:"bg-xmas-card p-8 rounded-lg text-center max-w-xl mx-auto",children:[u.jsx("h1",{className:"font-christmas text-3xl text-xmas-line mb-4",children:"Watchlist Not Available"}),u.jsx("p",{className:"mb-4",children:d||"This watchlist isn't public (or no longer exists)."}),u.jsxs(Xe,{to:"/",className:"btn btn-primary",children:[u.jsx("i",{className:"fas fa-home mr-2"}),"Go to Home"]})]})});const p=t.publicWatchlistName||`${t.displayName}'s Xmas Watchlist`,x=t.publicWatchlistTagline;return u.jsxs("div",{className:"container mx-auto px-2 sm:px-4 py-6 sm:py-10",children:[u.jsxs("header",{className:"mb-6 sm:mb-8 flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[u.jsxs("div",{className:"flex items-center gap-4",children:[t.photoURL?u.jsx("img",{src:t.photoURL,alt:t.displayName,className:"w-16 h-16 sm:w-20 sm:h-20 rounded-full border-2 border-xmas-gold shadow-lg"}):u.jsx("div",{className:"w-16 h-16 sm:w-20 sm:h-20 rounded-full bg-gray-700 flex items-center justify-center border-2 border-xmas-gold shadow-lg",children:u.jsx("i",{className:"fas fa-user text-2xl text-gray-300"})}),u.jsxs("div",{children:[u.jsx("h1",{className:"font-christmas text-2xl sm:text-3xl md:text-4xl text-xmas-line mb-1",children:p}),x&&u.jsx("p",{className:"text-sm sm:text-base text-xmas-mute",children:x})]})]}),o&&u.jsxs("div",{className:"bg-xmas-card px-4 py-3 rounded-lg shadow-md flex flex-wrap gap-4 text-sm sm:text-base",children:[u.jsxs("div",{children:[u.jsx("div",{className:"text-xs uppercase tracking-wide text-xmas-mute",children:"Watched"}),u.jsx("div",{className:"font-bold text-lg",children:o.totalWatched})]}),u.jsxs("div",{children:[u.jsx("div",{className:"text-xs uppercase tracking-wide text-xmas-mute",children:"Average Rating"}),u.jsxs("div",{className:"font-bold text-lg",children:[o.averageRating.toFixed(1),"/10"]})]}),u.jsxs("div",{children:[u.jsx("div",{className:"text-xs uppercase tracking-wide text-xmas-mute",children:"Favorites"}),u.jsx("div",{className:"font-bold text-lg",children:o.favoriteMovies})]})]})]}),n.length===0?u.jsxs("div",{className:"bg-xmas-card p-8 rounded-lg text-center max-w-xl mx-auto",children:[u.jsx("h2",{className:"text-xl mb-3",children:"No watched movies yet"}),u.jsx("p",{className:"text-sm text-xmas-mute",children:"As soon as they start marking movies as watched, they'll show up here."})]}):u.jsx("div",{className:"grid grid-cols-3 sm:grid-cols-4 md:grid-cols-5 lg:grid-cols-6 gap-2 sm:gap-3",children:n.map(g=>{var k;const w=a[g.id];return u.jsx(Xe,{to:`/u/${e}/m/${sA(g.title)}?id=${g.id}`,className:"block transition-transform hover:scale-[1.02] hover:shadow-xl",children:u.jsxs("div",{className:"relative rounded-lg overflow-hidden bg-xmas-card shadow-md h-full flex flex-col",children:[u.jsxs("div",{className:"relative",children:[g.posterUrl?u.jsx("img",{src:g.posterUrl,alt:g.title,className:"w-full h-auto object-cover",style:{aspectRatio:"2/3"},loading:"lazy"}):u.jsx("div",{className:"w-full flex items-center justify-center bg-gray-800",style:{aspectRatio:"2/3"},children:u.jsx("i",{className:"fas fa-film text-2xl text-gray-500"})}),w&&w.watched&&u.jsx("div",{className:"absolute top-1 right-1 bg-primary rounded-full p-1 shadow-md",children:u.jsx("i",{className:"fas fa-check text-xs text-white"})}),w&&w.favorite&&u.jsx("div",{className:"absolute top-1 left-1 text-yellow-400 drop-shadow-md",children:u.jsx("i",{className:"fas fa-star text-sm"})})]}),u.jsxs("div",{className:"p-1 sm:p-2 flex-grow flex flex-col",children:[u.jsx("h3",{className:"text-xs sm:text-sm font-medium line-clamp-2",children:g.title}),u.jsxs("div",{className:"flex justify-between items-center mt-1",children:[u.jsx("p",{className:"text-xs text-gray-400",children:(k=g.releaseDate)==null?void 0:k.substring(0,4)}),w&&w.rating!=null&&u.jsxs("div",{className:"flex items-center",children:[u.jsx("span",{className:"text-yellow-400 mr-0.5",children:u.jsx("i",{className:"fas fa-star text-xs"})}),u.jsx("span",{className:"text-xs",children:w.rating})]})]})]})]})},g.id)})})]})},Tv="https://api.watchmode.com/v1",nE=["GB","US","CA"],sE="GB",IW=24*60*60*1e3,kv="jg4HbDMFz2bE6i1YPoqDMFqo5Rmh6AEqP9mqqQdO";let dm=null;async function Sv(e){const t=await fetch(e);if(!t.ok)throw new Error(`Watchmode API error ${t.status}`);return await t.json()}async function NW(e){var t;try{const r=e.releaseDate?new Date(e.releaseDate).getFullYear():void 0,n=new URLSearchParams({apiKey:kv,search_field:"name",search_value:e.title}),s=`${Tv}/search/?${n.toString()}`,a=await Sv(s);if(!((t=a.title_results)!=null&&t.length))return null;if(r){const i=a.title_results.find(o=>o.year===r);if(i)return i.id}return a.title_results[0].id}catch(r){return console.error("Watchmode name search failed",r),null}}async function CW(e){const t=new URLSearchParams({apiKey:kv,regions:nE.join(",")}),r=`${Tv}/title/${e}/sources/?${t.toString()}`,n=await Sv(r),s=new Set(nE.map(a=>a.toUpperCase()));return n.filter(a=>s.has((a.region||"").toUpperCase())&&!!a.name)}async function bW(){if(dm)return dm;try{const e=`${Tv}/sources/?apiKey=${kv}`,t=await Sv(e),r={};for(const n of t)r[n.id]=n;return dm=r,r}catch(e){return console.error("Failed to load Watchmode source metadata",e),null}}async function RW(e){var o;if(!(e!=null&&e.id))return null;const t=Ft(bt(Me,"watchmodeSources"),e.id);try{const l=await Nn(t);if(l.exists()){const c=l.data(),f=(o=c.updatedAt)!=null&&o.toDate?c.updatedAt.toDate():new Date(c.updatedAt),d=Date.now()-f.getTime()<IW,m=Array.isArray(c.sources)&&c.sources.length>0;if(d&&m)return{movieId:e.id,region:c.region||sE,watchmodeTitleId:c.watchmodeTitleId??void 0,sources:c.sources||[],updatedAt:f,errorCode:c.errorCode??null}}}catch(l){console.error("Error reading Watchmode cache",l)}const r=await NW(e);let n=[],s=null;if(r)try{n=await CW(r)}catch(l){console.error("Error fetching Watchmode sources",l),s="sources_fetch_failed"}else s="title_not_found";const a=n.map(({ios_url:l,android_url:c,...f})=>f),i={movieId:e.id,region:sE,watchmodeTitleId:r||null,sources:a,updatedAt:new Date,errorCode:s};try{await qn(t,i,{merge:!0})}catch(l){console.error("Error updating Watchmode cache",l)}return{movieId:i.movieId,region:i.region,watchmodeTitleId:r||void 0,sources:a,updatedAt:i.updatedAt,errorCode:s}}function PW(e){const[t,r]=z.useState({loading:!1,error:null,data:null});return z.useEffect(()=>{let n=!1;return(async()=>{if(!e){r({loading:!1,error:null,data:null});return}r(a=>({...a,loading:!0,error:null}));try{const a=await RW(e);if(n)return;r({loading:!1,error:null,data:a})}catch(a){if(console.error("useWatchmodeSources error",a),n)return;r({loading:!1,error:"Failed to load streaming info",data:null})}})(),()=>{n=!0}},[e==null?void 0:e.id]),t}const DW=({movie:e})=>{const{loading:t,error:r,data:n}=PW(e),[s,a]=z.useState(null),[i,o]=z.useState(!1);if(z.useEffect(()=>{let p=!1;return(async()=>{const g=await bW();p||a(g)})(),()=>{p=!0}},[]),!e)return null;if(t&&!n)return u.jsx("div",{className:"mt-6 text-sm text-xmas-mute",children:"Looking up where to watch"});if(r)return null;const l=(n==null?void 0:n.sources)||[],c=["GB","US","CA"],f={};for(const p of l){const x=(p.region||"").toUpperCase();f[x]||(f[x]=[]),f[x].push(p)}const d=p=>{const x=new Map;for(const g of p)x.has(g.name)||x.set(g.name,g);return Array.from(x.values())},m=()=>u.jsx("div",{className:"grid gap-4 sm:gap-5 md:grid-cols-3",children:c.map(p=>{const x=f[p];if(!x||!x.length)return null;const g=x.filter(y=>y.type==="sub"||y.type==="subscription"),w=x.filter(y=>y.type==="buy"||y.type==="rent"||y.type==="purchase"||y.type==="buy/rent"),k=x.filter(y=>y.type==="free");if(!g.length&&!w.length&&!k.length)return null;const E=p==="GB"?"UK":p;return u.jsxs("div",{className:"bg-black/10 rounded-md p-3 sm:p-4 flex flex-col gap-3",children:[u.jsx("h3",{className:"text-sm font-semibold mb-1",children:E}),k.length>0&&u.jsxs("div",{children:[u.jsx("div",{className:"text-xs uppercase tracking-wide text-xmas-mute mb-1",children:"Free"}),u.jsx("div",{className:"flex flex-wrap gap-3",children:d(k).map(y=>{const I=s?s[y.source_id]:void 0;return I!=null&&I.logo_100px?u.jsx("a",{href:y.web_url||void 0,target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center justify-center rounded-lg overflow-hidden bg-white/5 hover:bg-white/10 transition-colors",children:u.jsx("img",{src:I.logo_100px,alt:y.name,className:"h-10 w-10 sm:h-12 sm:w-12 object-contain",loading:"lazy"})},y.name+y.web_url):null})})]}),g.length>0&&u.jsxs("div",{children:[u.jsx("div",{className:"text-xs uppercase tracking-wide text-xmas-mute mb-1",children:"Streaming"}),u.jsx("div",{className:"flex flex-wrap gap-3",children:d(g).map(y=>{const I=s?s[y.source_id]:void 0;return I!=null&&I.logo_100px?u.jsx("a",{href:y.web_url||void 0,target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center justify-center rounded-lg overflow-hidden bg-white/5 hover:bg-white/10 transition-colors",children:u.jsx("img",{src:I.logo_100px,alt:y.name,className:"h-10 w-10 sm:h-12 sm:w-12 object-contain",loading:"lazy"})},y.name+y.web_url):null})})]}),w.length>0&&u.jsxs("div",{children:[u.jsx("div",{className:"text-xs uppercase tracking-wide text-xmas-mute mb-1",children:"Buy / Rent"}),u.jsx("div",{className:"flex flex-wrap gap-3",children:d(w).map(y=>{const I=s?s[y.source_id]:void 0;return I!=null&&I.logo_100px?u.jsx("a",{href:y.web_url||void 0,target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center justify-center rounded-lg overflow-hidden bg-white/5 hover:bg-white/10 transition-colors",children:u.jsx("img",{src:I.logo_100px,alt:y.name,className:"h-10 w-10 sm:h-12 sm:w-12 object-contain",loading:"lazy"})},y.name+y.web_url):null})})]})]},p)})});return l.length?u.jsxs("div",{className:"mt-6",children:[u.jsx("div",{className:"divider"}),u.jsxs("div",{className:"bg-xmas-card/40 border border-xmas-gold/40 rounded-lg overflow-hidden",children:[u.jsxs("button",{type:"button",className:"w-full flex items-center justify-between text-left px-4 py-3 sm:px-5 sm:py-4 bg-xmas-card/60 hover:bg-xmas-card transition-colors cursor-pointer",onClick:()=>o(p=>!p),children:[u.jsxs("div",{className:"flex items-center gap-3",children:[u.jsx("i",{className:"fas fa-tv text-xmas-gold"}),u.jsx("h2",{className:"text-lg sm:text-xl font-bold flex-1",children:"Where to watch"})]}),u.jsx("span",{className:`ml-3 text-sm text-xmas-mute transition-transform duration-200 ${i?"rotate-180":"rotate-0"}`,children:u.jsx("i",{className:"fas fa-chevron-down"})})]}),i&&u.jsxs("div",{className:"px-4 py-3 sm:px-5 sm:py-5",children:[u.jsx("p",{className:"text-xs text-xmas-mute mb-4",children:"Powered by Watchmode. Availability can change, so please double-check on the provider's site."}),m()]})]})]}):u.jsxs("div",{className:"mt-6",children:[u.jsx("div",{className:"divider"}),u.jsxs("div",{className:"bg-xmas-card/40 border border-xmas-gold/40 rounded-lg overflow-hidden",children:[u.jsxs("button",{type:"button",className:"w-full flex items-center justify-between text-left px-4 py-3 sm:px-5 sm:py-4 bg-xmas-card/60 hover:bg-xmas-card transition-colors cursor-pointer",onClick:()=>o(p=>!p),children:[u.jsxs("div",{className:"flex items-center gap-3",children:[u.jsx("i",{className:"fas fa-tv text-xmas-gold"}),u.jsx("h2",{className:"text-lg sm:text-xl font-bold flex-1",children:"Where to watch"})]}),u.jsx("span",{className:`ml-3 text-sm text-xmas-mute transition-transform duration-200 ${i?"rotate-180":"rotate-0"}`,children:u.jsx("i",{className:"fas fa-chevron-down"})})]}),i&&u.jsxs("div",{className:"px-4 py-3 sm:px-5 sm:py-5 text-xs text-xmas-mute",children:[u.jsx("p",{className:"mb-2",children:"Powered by Watchmode. Availability can change, so please double-check on the provider's site."}),u.jsx("p",{children:"We couldn't find any current streaming options via Watchmode for this title."})]})]})]})},FW=()=>{const{slug:e}=Xg(),[t]=y4(),r=Ls(),[n,s]=z.useState(null),[a,i]=z.useState(null),[o,l]=z.useState(null),[c,f]=z.useState(!0),[d,m]=z.useState(null);if(z.useEffect(()=>{(async()=>{const w=t.get("id");if(!(!e||!w))try{f(!0),m(null);const k=bt(Me,"publicProfiles"),E=In(k,Zr("publicWatchlistSlug","==",e),Zr("isPublicWatchlist","==",!0)),y=await zt(E);if(y.empty){m("This watchlist isn't public (or no longer exists)."),f(!1);return}const I=y.docs[0],M={id:I.id,...I.data()};s(M);const O=M.userId,v=Ft(Me,"movies",w),T=await Nn(v);if(!T.exists()){m("Movie not found"),f(!1);return}const S={id:T.id,...T.data()};i(S);const C=Ft(Me,"users",O,"movies",w),b=await Nn(C);b.exists()?l({id:b.id,...b.data()}):l(null)}catch(k){console.error("Error loading public movie",k),m("Failed to load this movie.")}finally{f(!1)}})()},[e,t]),z.useEffect(()=>{if(!(typeof document>"u"))if(a&&n){const g=n.publicWatchlistName||`${n.displayName}'s Xmas Watchlist`;document.title=`${a.title}  ${g}`}else document.title="Christmas Movies"},[a,n]),c)return u.jsx("div",{className:"flex justify-center items-center min-h-[60vh]",children:u.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-xmas-gold"})});if(d||!n||!a)return u.jsx("div",{className:"container mx-auto px-4 py-16",children:u.jsxs("div",{className:"bg-xmas-card p-8 rounded-lg text-center max-w-xl mx-auto",children:[u.jsx("h1",{className:"font-christmas text-3xl text-xmas-line mb-4",children:"Movie Not Available"}),u.jsx("p",{className:"mb-4",children:d||"This movie could not be found for this watchlist."}),e&&u.jsxs("button",{className:"btn btn-primary",onClick:()=>r(`/u/${e}`),children:[u.jsx("i",{className:"fas fa-arrow-left mr-2"}),"Back to Watchlist"]})]})});const p=n.publicWatchlistName||`${n.displayName}'s Xmas Watchlist`,x=o!=null&&o.watched?"Watched":"Not watched yet";return u.jsxs("div",{className:"container mx-auto px-2 sm:px-4 py-6 sm:py-10",children:[u.jsx("div",{className:"mb-4 flex flex-wrap justify-between items-center gap-2",children:u.jsxs("div",{className:"flex items-center gap-3",children:[n.photoURL?u.jsx("img",{src:n.photoURL,alt:n.displayName,className:"w-10 h-10 rounded-full border border-xmas-gold"}):u.jsx("div",{className:"w-10 h-10 rounded-full bg-gray-700 flex items-center justify-center border border-xmas-gold",children:u.jsx("i",{className:"fas fa-user text-sm text-gray-300"})}),u.jsxs("div",{className:"text-sm",children:[u.jsx("div",{className:"font-semibold mb-1",children:p}),u.jsxs("button",{className:"btn btn-primary btn-sm px-4 py-2 rounded-md shadow-lg hover:shadow-xl transition-all duration-300 border border-xmas-gold border-opacity-30 flex items-center gap-2",onClick:()=>r(`/u/${e}`),children:[u.jsx("i",{className:"fas fa-arrow-left"}),u.jsx("span",{children:"Back to watchlist"})]})]})]})}),u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-8",children:[u.jsxs("div",{className:"md:col-span-1",children:[u.jsx("div",{className:"rounded-lg overflow-hidden shadow-xl",children:a.posterUrl?u.jsx("img",{src:a.posterUrl,alt:a.title,className:"w-full object-contain",style:{aspectRatio:"2/3"}}):u.jsx("div",{className:"w-full flex items-center justify-center bg-gray-800",style:{aspectRatio:"2/3"},children:u.jsx("i",{className:"fas fa-film text-6xl text-gray-500"})})}),o&&u.jsxs("div",{className:"mt-4 space-y-2 text-sm",children:[u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsx("span",{className:"text-xs uppercase tracking-wide text-xmas-mute",children:"Status"}),u.jsx("span",{className:"font-semibold",children:x})]}),o.rating!=null&&u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsx("span",{className:"text-xs uppercase tracking-wide text-xmas-mute",children:"Rating"}),u.jsxs("div",{className:"flex items-center gap-1",children:[u.jsx("span",{className:"text-yellow-400",children:u.jsx("i",{className:"fas fa-star"})}),u.jsxs("span",{className:"font-semibold",children:[o.rating,"/10"]})]})]}),o.watchedDate&&u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsx("span",{className:"text-xs uppercase tracking-wide text-xmas-mute",children:"Watched on"}),u.jsx("span",{className:"font-semibold",children:(()=>{var w;const g=(w=o.watchedDate)!=null&&w.toDate?o.watchedDate.toDate():new Date(o.watchedDate);return isNaN(g.getTime())?"":g.toLocaleDateString()})()})]}),o.vibeTags&&o.vibeTags.length>0&&u.jsxs("div",{children:[u.jsx("div",{className:"text-xs uppercase tracking-wide text-xmas-mute mb-1",children:"Vibe review"}),u.jsx("div",{className:"flex flex-wrap gap-1.5",children:o.vibeTags.map(g=>u.jsx("span",{className:"badge badge-sm bg-xmas-gold bg-opacity-20 text-[0.7rem] border-xmas-gold",children:g},g))})]})]})]}),u.jsxs("div",{className:"md:col-span-2",children:[u.jsx("h1",{className:"font-christmas text-3xl md:text-4xl text-xmas-line mb-2",children:a.title}),a.releaseDate&&u.jsx("p",{className:"text-lg text-gray-400 mb-4",children:new Date(a.releaseDate).getFullYear()}),a.genres&&a.genres.length>0&&u.jsx("div",{className:"flex flex-wrap gap-2 mb-4",children:a.genres.map(g=>u.jsx("span",{className:"badge badge-outline",children:g},g))}),a.runtime&&u.jsxs("p",{className:"mb-4",children:[u.jsx("i",{className:"fas fa-clock mr-2 text-xmas-gold"}),Math.floor(a.runtime/60),"h ",a.runtime%60,"m"]}),a.overview&&u.jsxs("div",{className:"mb-6",children:[u.jsx("h2",{className:"text-xl font-bold mb-2",children:"Overview"}),u.jsx("p",{className:"text-gray-300",children:a.overview})]}),a.directors&&a.directors.length>0&&u.jsxs("div",{className:"mb-4",children:[u.jsxs("h2",{className:"text-xl font-bold mb-2",children:["Director",a.directors.length>1?"s":""]}),u.jsx("p",{children:a.directors.join(", ")})]}),a.cast&&a.cast.length>0&&u.jsxs("div",{className:"mb-6",children:[u.jsx("h2",{className:"text-xl font-bold mb-2",children:"Cast"}),u.jsx("p",{className:"flex flex-wrap gap-1",children:a.cast.slice(0,10).map((g,w)=>u.jsxs(wu.Fragment,{children:[u.jsx("span",{children:g}),w<Math.min(a.cast.length,10)-1&&u.jsx("span",{children:","})]},g))})]}),o&&o.review&&u.jsxs("div",{className:"mt-6",children:[u.jsx("div",{className:"divider"}),u.jsx("h2",{className:"text-xl font-bold mb-2",children:"Their Thoughts"}),u.jsx("p",{className:"whitespace-pre-line text-gray-200 text-sm sm:text-base",children:o.review})]}),u.jsx(DW,{movie:a})]})]})]})},OW=()=>{const e=Ls(),{isAdmin:t,loading:r,currentUser:n}=zu(),[s,a]=z.useState(!1),[i,o]=z.useState(null),l=!1;z.useEffect(()=>{t&&!r&&e("/admin")},[t,r,e]);const c=async()=>{o(null),a(!0);try{await Ak(Sc,ML)}catch(f){console.error("Login error:",f),f.code==="auth/popup-closed-by-user"?o("Sign-in popup was closed. Please try again."):f.code==="auth/cancelled-popup-request"?o("Another popup is already open. Please try again."):f.code==="auth/unauthorized-domain"?(console.error("Unauthorized domain error:",window.location.hostname),o("This domain is not authorized for OAuth operations. Please add "+window.location.hostname+" to your Firebase authorized domains list in the Firebase console under Authentication > Sign-in method > Authorized domains.")):o("Failed to sign in. Please try again."),a(!1)}};return r?u.jsx("div",{className:"flex justify-center items-center min-h-[60vh]",children:u.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-xmas-gold"})}):u.jsx("div",{className:"container mx-auto px-4 py-12",children:u.jsxs("div",{className:"max-w-md mx-auto",children:[u.jsxs("div",{className:"text-center mb-8",children:[u.jsx("h1",{className:"font-christmas text-4xl text-xmas-line mb-2",children:"Admin Login"}),u.jsx("p",{className:"text-xmas-mute",children:"Sign in to manage the Christmas Quiz"})]}),u.jsxs("div",{className:"bg-xmas-card rounded-lg shadow-lg p-6",children:[l,n&&u.jsxs("div",{className:"bg-info bg-opacity-10 border-l-4 border-info p-4 mb-6 rounded",children:[u.jsx("p",{className:"text-info font-bold mb-2",children:"User Authenticated"}),u.jsxs("p",{className:"text-info text-sm mb-1",children:["Email: ",n.email]}),u.jsxs("p",{className:"text-info text-sm mb-2",children:["UID: ",n.uid]}),u.jsxs("p",{className:"text-info text-sm",children:["To grant admin access, create a document in the ",u.jsx("code",{className:"bg-base-300 px-1 py-0.5 rounded",children:"admins"})," collection with this UID as the document ID."]}),l]}),i&&u.jsx("div",{className:"bg-error bg-opacity-10 border-l-4 border-error p-4 mb-6 rounded",children:u.jsx("p",{className:"text-error",children:i})}),u.jsxs("div",{className:"text-center mb-6",children:[u.jsx("p",{className:"mb-4",children:"Sign in with your Google account to access the admin panel."}),u.jsx("p",{className:"text-sm text-xmas-mute mb-6",children:"Only authorized administrators will be granted access."}),u.jsx("button",{onClick:c,className:"btn btn-primary w-full flex items-center justify-center gap-2",disabled:s,children:s?u.jsxs(u.Fragment,{children:[u.jsx("span",{className:"loading loading-spinner loading-sm"}),"Signing in..."]}):u.jsxs(u.Fragment,{children:[u.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 48 48",children:[u.jsx("path",{fill:"#FFC107",d:`M43.611,20.083H42V20H24v8h11.303c-1.649,4.657-6.08,8-11.303,8c-6.627,0-12-5.373-12-12\r
                      s5.373-12,12-12c3.059,0,5.842,1.154,7.961,3.039l5.657-5.657C34.046,6.053,29.268,4,24,4C12.955,4,4,12.955,4,24s8.955,20,20,20\r
                      s20-8.955,20-20C44,22.659,43.862,21.35,43.611,20.083z`}),u.jsx("path",{fill:"#FF3D00",d:`M6.306,14.691l6.571,4.819C14.655,15.108,18.961,12,24,12c3.059,0,5.842,1.154,7.961,3.039\r
                      l5.657-5.657C34.046,6.053,29.268,4,24,4C16.318,4,9.656,8.337,6.306,14.691z`}),u.jsx("path",{fill:"#4CAF50",d:`M24,44c5.166,0,9.86-1.977,13.409-5.192l-6.19-5.238C29.211,35.091,26.715,36,24,36\r
                      c-5.202,0-9.619-3.317-11.283-7.946l-6.522,5.025C9.505,39.556,16.227,44,24,44z`}),u.jsx("path",{fill:"#1976D2",d:`M43.611,20.083H42V20H24v8h11.303c-0.792,2.237-2.231,4.166-4.087,5.571\r
                      c0.001-0.001,0.002-0.001,0.003-0.002l6.19,5.238C36.971,39.205,44,34,44,24C44,22.659,43.862,21.35,43.611,20.083z`})]}),"Sign in with Google"]})})]})]}),u.jsx("div",{className:"text-center mt-6",children:u.jsx("button",{onClick:()=>e("/"),className:"btn btn-link text-xmas-mute",children:"Back to Home"})})]})})};async function MW(e,t){const r=await si(e,t),n=bt(Me,"movies"),s=In(n,Zr("imdbId","==",r.imdbID)),a=await zt(s),i={...uu(r),updatedAt:new Date};if(a.empty){const o={...i,addedAt:new Date};return{movieId:(await Wu(n,o)).id,action:"created"}}else{const o=a.docs[0].id;return await qn(Ft(Me,"movies",o),i,{merge:!0}),{movieId:o,action:"updated"}}}const LW=e=>new Promise(t=>setTimeout(t,e));async function jW(e,t,r,n=200){let s=0,a=0,i=0,o=0;const l=[];for(let c=0;c<e.length;c++){const f=e[c];try{if(!f){i++,r==null||r(c+1,e.length,"skipped");continue}const{movieId:d,action:m}=await MW(f,t);l.push(d),m==="created"?s++:a++,r==null||r(c+1,e.length,m),n>0&&await LW(n)}catch(d){console.error("Catalogue upsert error for IMDb",f,d),o++,r==null||r(c+1,e.length,"error")}}return{totalRequested:e.length,created:s,updated:a,skipped:i,errors:o,movieIds:l}}const UW=({omdbApiKey:e,onDone:t})=>{const[r,n]=z.useState(null),[s,a]=z.useState([]),[i,o]=z.useState([]),[l,c]=z.useState("upload"),[f,d]=z.useState(0),[m,p]=z.useState(null),[x,g]=z.useState(0),[w,k]=z.useState(!1),[E,y]=z.useState(null),[I,M]=z.useState([]),[O,v]=z.useState(null),T=i.filter(ie=>ie.selected&&ie.tmdbMatch).length,S=ie=>{var ue;const Z=(ue=ie.target.files)==null?void 0:ue[0];if(!Z)return;n(Z);const fe=new FileReader;fe.onload=q=>{var Y;const G=gd((Y=q.target)==null?void 0:Y.result,{type:"binary"}),ne=G.Sheets[G.SheetNames[0]],j=$I.sheet_to_json(ne).map(K=>({title:K.title||K.Title||K.name||K.Name||"",imdbId:K.imdb||K.IMDB||K.Imdb||K.imdbId||K.imdbID||"",releaseDate:K.year||K.Year||K.releaseDate||K.ReleaseDate||K.release_date||"",watched:K.watched||K.Watched||!1,rating:K.rating||K.Rating||null,review:K.review||K.Review||K.notes||K.Notes||""})).filter(K=>K.title);a(j)},fe.readAsBinaryString(Z)},C=async()=>{if(!s.length||!e){v("Missing data or OMDb key");return}try{k(!0),v(null),o([]),d(0),p(null);const ie=[],Z=bt(Me,"movies");for(let fe=0;fe<s.length;fe++){const ue=s[fe];p(ue.title||null);try{let q=null;if(ue.imdbId)q=await si(ue.imdbId,e);else{const G=`${ue.title} ${ue.releaseDate||""}`.trim();let ne=G||ue.title,ce=[];try{ce=await Vi(ne,e)}catch{ce=[]}if(!ce.length&&G&&ue.title&&G!==ue.title){ne=ue.title;try{ce=await Vi(ne,e)}catch{ce=[]}}if(!ce.length){ie.push({excelData:ue,tmdbMatch:null,confidence:0,status:"unmatched",movieId:void 0,selected:!1});continue}q=await si(ce[0].imdbID,e)}if(!q)ie.push({excelData:ue,tmdbMatch:null,confidence:0,status:"unmatched",movieId:void 0,selected:!1});else{const G=sd(ue,q),ne=await zt(In(Z,Zr("imdbId","==",q.imdbID)));let ce,j="matched";ne.empty?G<70&&(j="manual"):(ce=ne.docs[0].id,j=G>=70?"duplicate":"manual"),ie.push({excelData:ue,tmdbMatch:q,confidence:G,status:j,movieId:ce,selected:!0})}}catch{ie.push({excelData:ue,tmdbMatch:null,confidence:0,status:"unmatched",movieId:void 0,selected:!1})}d(Math.round((fe+1)/s.length*100))}o(ie),c("review")}finally{k(!1),p(null)}},b=async(ie,Z)=>{try{k(!0);const fe=i[ie],ue=Z||fe.excelData.title,q=await Vi(ue,e);y(ie),M(q)}finally{k(!1)}},P=async ie=>{if(E!=null){k(!0);try{const Z=await si(ie.imdbID,e),fe=sd(i[E].excelData,Z),ue=bt(Me,"movies"),q=await zt(In(ue,Zr("imdbId","==",Z.imdbID)));let G,ne="matched";q.empty?fe<70&&(ne="manual"):(G=q.docs[0].id,ne=fe>=70?"duplicate":"manual"),o(ce=>{const j=[...ce];return j[E]={excelData:ce[E].excelData,tmdbMatch:Z,confidence:fe,status:ne,movieId:G,selected:!0},j}),y(null),M([])}finally{k(!1)}}},D=async()=>{const ie=i.filter(fe=>fe.selected&&fe.tmdbMatch);if(!ie.length)return;c("import"),g(0);const Z=bt(Me,"movies");for(let fe=0;fe<ie.length;fe++){const ue=ie[fe];try{const q=ue.tmdbMatch,G=await zt(In(Z,Zr("imdbId","==",q.imdbID)));if(G.empty)await Wu(Z,{...uu(q),addedAt:new Date,updatedAt:new Date});else{const ne=G.docs[0].id;await qn(Ft(Me,"movies",ne),{...uu(q),updatedAt:new Date},{merge:!0})}}catch{}g(Math.round((fe+1)/ie.length*100))}t==null||t()};return u.jsxs("div",{className:"space-y-6",children:[l==="upload"&&u.jsxs("div",{className:"space-y-4",children:[u.jsx("input",{type:"file",accept:".xlsx,.xls",className:"file-input file-input-bordered w-full",onChange:S}),!!s.length&&u.jsxs("div",{className:"text-sm opacity-80",children:[s.length," rows detected"]}),u.jsx("button",{className:"btn btn-primary",onClick:C,disabled:!e||!s.length||w,children:w?u.jsx("span",{className:"loading loading-spinner loading-sm"}):"Scan & Match to Catalogue"}),w&&!!f&&f<100&&u.jsxs("div",{className:"space-y-1",children:[u.jsxs("div",{className:"text-sm",children:["Scanning ",f,"%"]}),u.jsx("progress",{className:"progress w-full",value:f,max:100}),m&&u.jsxs("div",{className:"text-xs opacity-70 truncate",children:["Current: ",m]})]})]}),l==="review"&&u.jsxs("div",{className:"space-y-4",children:[u.jsxs("div",{className:"flex justify-between items-center",children:[u.jsx("div",{className:"font-bold",children:"Review Catalogue Matches"}),u.jsx("button",{className:"btn btn-ghost btn-sm",onClick:()=>c("upload"),children:"Back"})]}),u.jsx("div",{className:"overflow-x-auto",children:u.jsxs("table",{className:"table table-zebra w-full",children:[u.jsx("thead",{children:u.jsxs("tr",{children:[u.jsx("th",{}),u.jsx("th",{children:"Excel"}),u.jsx("th",{children:"Match"}),u.jsx("th",{children:"Confidence"}),u.jsx("th",{children:"Status"}),u.jsx("th",{children:"Action"})]})}),u.jsx("tbody",{children:i.map((ie,Z)=>u.jsxs("tr",{children:[u.jsx("td",{children:u.jsx("input",{type:"checkbox",className:"checkbox",checked:ie.selected,disabled:!ie.tmdbMatch,onChange:()=>{const fe=[...i];fe[Z].selected=!fe[Z].selected,o(fe)}})}),u.jsxs("td",{children:[u.jsx("div",{className:"font-semibold",children:ie.excelData.title}),u.jsx("div",{className:"text-xs opacity-70",children:ie.excelData.releaseDate||"-"})]}),u.jsx("td",{children:ie.tmdbMatch?u.jsxs("div",{className:"flex items-center gap-3",children:[u.jsx("div",{className:"w-12 h-18",children:dn(ie.tmdbMatch)?u.jsx("img",{src:dn(ie.tmdbMatch),className:"object-cover"}):u.jsx("div",{className:"w-full h-full bg-base-200"})}),u.jsxs("div",{children:[u.jsx("div",{className:"font-semibold",children:ie.tmdbMatch.Title}),u.jsx("div",{className:"text-xs opacity-70",children:ie.tmdbMatch.Year})]})]}):u.jsx("span",{className:"text-error",children:"No match"})}),u.jsx("td",{children:ie.tmdbMatch?u.jsxs("div",{className:"flex items-center",children:[u.jsx("progress",{className:`progress ${ie.confidence>=70?"progress-success":ie.confidence>=40?"progress-warning":"progress-error"}`,value:ie.confidence,max:100}),u.jsxs("span",{className:"ml-2",children:[ie.confidence,"%"]})]}):"-"}),u.jsxs("td",{children:[ie.status==="matched"&&u.jsx("div",{className:"badge badge-success",children:"New"}),ie.status==="unmatched"&&u.jsx("div",{className:"badge badge-error",children:"Unmatched"}),ie.status==="duplicate"&&u.jsx("div",{className:"badge badge-warning",children:"Existing"}),ie.status==="manual"&&u.jsx("div",{className:"badge badge-info",children:"Manual"})]}),u.jsx("td",{children:u.jsx("button",{className:"btn btn-sm btn-outline",onClick:()=>b(Z),children:u.jsx("i",{className:"fas fa-search"})})})]},Z))})]})}),u.jsx("div",{className:"flex justify-end",children:u.jsxs("button",{className:"btn btn-primary",onClick:D,disabled:!T||w,children:["Import ",T," to Catalogue"]})}),!!f&&f<100&&u.jsx("div",{children:u.jsx("progress",{className:"progress w-full",value:f,max:100})})]}),l==="import"&&u.jsxs("div",{className:"space-y-3",children:[u.jsx("div",{className:"font-bold",children:"Importing to Catalogue"}),u.jsx("progress",{className:"progress w-full",value:x,max:100})]}),E!==null&&u.jsx("div",{className:"modal modal-open",children:u.jsxs("div",{className:"modal-box max-w-4xl",children:[u.jsxs("h3",{className:"font-bold text-lg mb-4",children:["Manual match: ",i[E].excelData.title]}),u.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 mb-6",children:[u.jsx("input",{type:"text",className:"input input-bordered flex-1",placeholder:"Search for a movie...",defaultValue:i[E].excelData.title,onKeyDown:ie=>ie.key==="Enter"&&b(E,ie.target.value)}),u.jsx("button",{className:"btn btn-primary w-full sm:w-auto",onClick:()=>{var ie;return b(E,(ie=document.querySelector(".modal input"))==null?void 0:ie.value)},disabled:w,children:w?u.jsx("span",{className:"loading loading-spinner loading-sm"}):u.jsx("i",{className:"fas fa-search"})})]}),u.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-3 max-h-96 overflow-y-auto",children:I.map(ie=>u.jsxs("div",{className:"card bg-base-100 shadow cursor-pointer",onClick:()=>P(ie),children:[u.jsx("figure",{children:dn(ie)?u.jsx("img",{src:dn(ie)}):u.jsx("div",{className:"h-48 w-full bg-base-200"})}),u.jsxs("div",{className:"card-body p-3",children:[u.jsx("div",{className:"text-sm font-semibold",children:ie.Title}),u.jsx("div",{className:"text-xs opacity-70",children:ie.Year})]})]},ie.imdbID))}),u.jsx("div",{className:"modal-action",children:u.jsx("button",{className:"btn",onClick:()=>{y(null),M([])},children:"Close"})})]})}),O&&u.jsx("div",{className:"alert alert-error",children:O})]})},VW=()=>{const e=Ls(),{isAdmin:t,loading:r}=zu(),{userProfile:n}=Dn(),[s,a]=z.useState(!0),[i,o]=z.useState(null),[l,c]=z.useState(null),[f,d]=z.useState(!1),[m,p]=z.useState({totalMovies:0,moviesWithSortTitle:0}),[x,g]=z.useState([]),[w,k]=z.useState(!1),[E,y]=z.useState(""),[I,M]=z.useState(""),[O,v]=z.useState(!0),[T,S]=z.useState(!1),[C,b]=z.useState(0),[P,D]=z.useState("");z.useEffect(()=>{n!=null&&n.omdbApiKey&&y(n.omdbApiKey)},[n]),z.useEffect(()=>{!r&&!t&&e("/admin/login")},[t,r,e]),z.useEffect(()=>{t&&(async()=>{if(t){a(!0);try{const G=await zt(bt(Me,"movies")),ne=G.size;let ce=0;G.forEach(j=>{j.data().sortTitle&&ce++}),p({totalMovies:ne,moviesWithSortTitle:ce})}catch(G){console.error("Error fetching movie data:",G),o("Failed to load movie data")}finally{a(!1)}}})()},[t]),z.useEffect(()=>{t&&(async()=>{if(t){k(!0);try{const G=In(bt(Me,"Requests"),Zr("status","==","pending")),ce=(await zt(G)).docs.map(j=>({id:j.id,...j.data()}));g(ce)}catch(G){console.error("Error fetching movie requests:",G),o("Failed to load movie requests")}finally{k(!1)}}})()},[t]);const ie=async()=>{try{d(!0),o(null);const q=await wW();c(`Sort titles updated for ${q.updated} out of ${q.total} movies.`),p(G=>({...G,moviesWithSortTitle:G.moviesWithSortTitle+q.updated})),setTimeout(()=>c(null),5e3)}catch(q){console.error("Error updating sort titles:",q),o(q.message||"Failed to update sort titles")}finally{d(!1)}},Z=async(q,G)=>{try{o(null),await hi(Ft(Me,"Requests",q),{status:G,updatedAt:new Date}),g(ne=>ne.filter(ce=>ce.id!==q)),c(`Request marked as ${G}.`),setTimeout(()=>c(null),4e3)}catch(ne){console.error("Error updating request status:",ne),o(ne.message||"Failed to update request")}},fe=z.useMemo(()=>{const q=I.split(/[\s,]+/).map(G=>G.trim()).filter(Boolean);return Array.from(new Set(q))},[I]),ue=async()=>{if(o(null),c(null),!E){o("OMDb API key required");return}if(fe.length===0){o("Please paste at least one valid IMDb ID");return}try{S(!0),b(0),D(`Starting (0 / ${fe.length})`);const q=await jW(fe,E,(G,ne,ce)=>{const j=Math.round(G/ne*100);b(j),D(`Processed ${G} / ${ne} (${ce})`)},O?300:0);c(`Catalogue updated. Created: ${q.created}, Updated: ${q.updated}, Skipped: ${q.skipped}, Errors: ${q.errors}.`)}catch(q){console.error(q),o((q==null?void 0:q.message)??"Catalogue import failed.")}finally{S(!1)}};return r||s?u.jsx("div",{className:"flex justify-center items-center min-h-[60vh]",children:u.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-xmas-gold"})}):u.jsxs("div",{className:"container mx-auto px-4 py-8",children:[u.jsxs("div",{className:"flex justify-between items-center mb-8",children:[u.jsx("h1",{className:"font-christmas text-3xl md:text-4xl text-xmas-line",children:"Admin Dashboard"}),u.jsx("div",{className:"flex gap-2",children:u.jsxs(Xe,{to:"/movies",className:"btn btn-outline",children:[u.jsx("i",{className:"fas fa-film mr-2"})," Movies"]})})]}),i&&u.jsxs("div",{className:"alert alert-error mb-6",children:[u.jsx("i",{className:"fas fa-exclamation-circle mr-2"}),u.jsx("span",{children:i})]}),l&&u.jsxs("div",{className:"alert alert-success mb-6",children:[u.jsx("i",{className:"fas fa-check-circle mr-2"}),u.jsx("span",{children:l})]}),u.jsxs("div",{className:"mb-8",children:[u.jsx("h2",{className:"text-2xl font-christmas mb-4 text-xmas-gold",children:"Movie Administration"}),u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-8",children:[u.jsx("div",{className:"card bg-xmas-card shadow-xl",children:u.jsxs("div",{className:"card-body",children:[u.jsxs("h2",{className:"card-title font-christmas",children:[u.jsx("i",{className:"fas fa-sort-alpha-down text-primary mr-2"})," Sort Title Migration"]}),u.jsx("p",{className:"mb-4",children:'Update all movies to include sort titles (e.g., "The Grinch"  "Grinch") for better alphabetical sorting.'}),u.jsxs("div",{className:"flex flex-col gap-2",children:[u.jsxs("div",{className:"stats bg-base-200 text-base-content",children:[u.jsxs("div",{className:"stat",children:[u.jsx("div",{className:"stat-title",children:"Total Movies"}),u.jsx("div",{className:"stat-value",children:m.totalMovies})]}),u.jsxs("div",{className:"stat",children:[u.jsx("div",{className:"stat-title",children:"With Sort Titles"}),u.jsx("div",{className:"stat-value",children:m.moviesWithSortTitle}),u.jsx("div",{className:"stat-desc",children:m.totalMovies>0?`${Math.round(m.moviesWithSortTitle/m.totalMovies*100)}%`:"0%"})]})]}),u.jsxs("button",{className:"btn btn-primary w-full",onClick:ie,disabled:f||m.moviesWithSortTitle===m.totalMovies,children:[f?u.jsx("span",{className:"loading loading-spinner loading-sm mr-2"}):u.jsx("i",{className:"fas fa-sync-alt mr-2"}),m.moviesWithSortTitle===m.totalMovies?"All Movies Updated":"Update Sort Titles"]})]})]})}),u.jsx("div",{className:"card bg-xmas-card shadow-xl",children:u.jsxs("div",{className:"card-body",children:[u.jsxs("h2",{className:"card-title font-christmas",children:[u.jsx("i",{className:"fas fa-database text-primary mr-2"})," Catalogue Builder (IMDb IDs)"]}),u.jsxs("p",{className:"mb-4",children:["Bulk-import titles by IMDb ID into your ",u.jsx("code",{children:"movies"})," catalogue only  no user collections will be updated."]}),u.jsx("label",{className:"label mt-4",children:u.jsx("span",{className:"label-text",children:"IMDb IDs (comma / space / newline separated)"})}),u.jsx("textarea",{className:"textarea textarea-bordered w-full h-40",value:I,onChange:q=>M(q.target.value),placeholder:`e.g. tt0096061, tt0107688
tt0096061
tt0107688`}),u.jsxs("div",{className:"flex items-center gap-4 mt-4",children:[u.jsx("div",{className:"form-control",children:u.jsxs("label",{className:"label cursor-pointer gap-2",children:[u.jsx("span",{className:"label-text",children:"Slow mode (API friendly)"}),u.jsx("input",{type:"checkbox",className:"toggle",checked:O,onChange:q=>v(q.target.checked)})]})}),u.jsx("button",{className:"btn btn-primary ml-auto",onClick:ue,disabled:T||fe.length===0||!E,title:E?void 0:"Add your OMDb API key in Profile > Settings",children:T?u.jsxs(u.Fragment,{children:[u.jsx("span",{className:"loading loading-spinner loading-sm mr-2"}),"Importing ",fe.length,""]}):u.jsxs(u.Fragment,{children:[u.jsx("i",{className:"fas fa-file-import mr-2"}),"Import ",fe.length||0," to Catalogue"]})})]}),(T||C>0)&&u.jsxs("div",{className:"mt-4",children:[u.jsx("progress",{className:"progress w-full",value:C,max:100}),u.jsx("div",{className:"text-sm mt-1 opacity-80",children:P})]})]})})]}),u.jsx("div",{className:"card bg-xmas-card shadow-xl",children:u.jsxs("div",{className:"card-body",children:[u.jsxs("h2",{className:"card-title font-christmas",children:[u.jsx("i",{className:"fas fa-file-excel text-primary mr-2"})," Excel Catalogue Import"]}),u.jsxs("p",{className:"mb-4 text-sm opacity-80",children:["Use an Excel file (title / year / optional IMDb id) to populate or refresh the main",u.jsx("code",{className:"mx-1",children:"movies"})," catalogue via OMDb."]}),!E&&u.jsxs("div",{className:"alert alert-warning mb-4",children:[u.jsx("i",{className:"fas fa-exclamation-triangle mr-2"}),u.jsx("span",{children:"Add your OMDb API key in Profile to enable Excel catalogue import."})]}),E&&u.jsx(UW,{omdbApiKey:E,onDone:()=>{c("Excel catalogue import completed."),setTimeout(()=>c(null),4e3)}})]})})]}),u.jsxs("div",{className:"mb-8",children:[u.jsx("h2",{className:"text-2xl font-christmas mb-4 text-xmas-gold",children:"Movie Requests"}),u.jsx("div",{className:"card bg-xmas-card shadow-xl",children:u.jsxs("div",{className:"card-body",children:[u.jsxs("h2",{className:"card-title font-christmas flex items-center gap-2",children:[u.jsx("i",{className:"fas fa-gift text-primary"}),"Pending Requests"]}),u.jsx("p",{className:"text-sm opacity-80 mb-4",children:"These are movies users have asked to be added to the catalogue."}),w?u.jsx("div",{className:"flex justify-center py-8",children:u.jsx("span",{className:"loading loading-spinner loading-md"})}):x.length===0?u.jsx("p",{className:"text-sm opacity-80",children:"No pending requests right now."}):u.jsx("div",{className:"overflow-x-auto",children:u.jsxs("table",{className:"table table-zebra table-sm",children:[u.jsx("thead",{children:u.jsxs("tr",{children:[u.jsx("th",{children:"Title"}),u.jsx("th",{children:"Year"}),u.jsx("th",{children:"TMDB"}),u.jsx("th",{children:"Requested By"}),u.jsx("th",{children:"Notes"}),u.jsx("th",{})]})}),u.jsx("tbody",{children:x.map(q=>{var ne;const G=(ne=q.createdAt)!=null&&ne.toDate?q.createdAt.toDate():q.createdAt;return u.jsxs("tr",{children:[u.jsxs("td",{children:[u.jsx("div",{className:"font-semibold",children:q.title}),G&&u.jsx("div",{className:"text-xs opacity-70",children:new Date(G).toLocaleString()})]}),u.jsx("td",{children:q.year||"-"}),u.jsxs("td",{children:[q.tmdbId&&u.jsxs("div",{className:"text-xs",children:["ID: ",q.tmdbId]}),q.tmdbUrl&&u.jsx("a",{href:q.tmdbUrl,target:"_blank",rel:"noopener noreferrer",className:"link link-primary text-xs",children:"View TMDB"})]}),u.jsxs("td",{children:[u.jsx("div",{className:"text-sm",children:q.userDisplayName||q.userEmail||q.userId}),q.userEmail&&u.jsx("div",{className:"text-xs opacity-70",children:q.userEmail})]}),u.jsx("td",{className:"max-w-xs whitespace-pre-wrap text-xs",children:q.notes||"-"}),u.jsxs("td",{className:"flex flex-col gap-1",children:[u.jsx("button",{className:"btn btn-xs btn-success",onClick:()=>Z(q.id,"fulfilled"),children:"Fulfilled"}),u.jsx("button",{className:"btn btn-xs btn-ghost",onClick:()=>Z(q.id,"dismissed"),children:"Dismiss"})]})]},q.id)})})]})})]})})]})]})},BW=s4([{element:u.jsx(VL,{}),children:[{path:"/",element:u.jsx(zL,{})},{path:"/login",element:u.jsx($L,{})},{path:"/u/:slug",element:u.jsx(AW,{})},{path:"/u/:slug/m/:movieSlug",element:u.jsx(FW,{})},{element:u.jsx(X_,{}),children:[{path:"/movies",element:u.jsx(QL,{})},{path:"/movies/:movieId",element:u.jsx(l6,{})},{path:"/import",element:u.jsx(gW,{})},{path:"/random",element:u.jsx(xW,{})},{path:"/profile",element:u.jsx(TW,{})},{path:"/achievements",element:u.jsx(SW,{})}]},{path:"/admin/login",element:u.jsx(OW,{})},{path:"/admin",element:u.jsx(X_,{children:u.jsx(VW,{})})}]}]);mm.createRoot(document.getElementById("root")).render(u.jsx(wu.StrictMode,{children:u.jsx(LL,{children:u.jsx(BL,{children:u.jsx(h4,{router:BW})})})}));
