function Pw(t,e){for(var r=0;r<e.length;r++){const n=e[r];if(typeof n!="string"&&!Array.isArray(n)){for(const i in n)if(i!=="default"&&!(i in t)){const s=Object.getOwnPropertyDescriptor(n,i);s&&Object.defineProperty(t,i,s.get?s:{enumerable:!0,get:()=>n[i]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const a of s.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&n(a)}).observe(document,{childList:!0,subtree:!0});function r(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function n(i){if(i.ep)return;i.ep=!0;const s=r(i);fetch(i.href,s)}})();function Fw(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var Dw={exports:{}},e0={},bw={exports:{}},qe={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var uu=Symbol.for("react.element"),FI=Symbol.for("react.portal"),DI=Symbol.for("react.fragment"),bI=Symbol.for("react.strict_mode"),OI=Symbol.for("react.profiler"),LI=Symbol.for("react.provider"),MI=Symbol.for("react.context"),VI=Symbol.for("react.forward_ref"),UI=Symbol.for("react.suspense"),jI=Symbol.for("react.memo"),BI=Symbol.for("react.lazy"),I1=Symbol.iterator;function zI(t){return t===null||typeof t!="object"?null:(t=I1&&t[I1]||t["@@iterator"],typeof t=="function"?t:null)}var Ow={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},Lw=Object.assign,Mw={};function cl(t,e,r){this.props=t,this.context=e,this.refs=Mw,this.updater=r||Ow}cl.prototype.isReactComponent={};cl.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};cl.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function Vw(){}Vw.prototype=cl.prototype;function Pm(t,e,r){this.props=t,this.context=e,this.refs=Mw,this.updater=r||Ow}var Fm=Pm.prototype=new Vw;Fm.constructor=Pm;Lw(Fm,cl.prototype);Fm.isPureReactComponent=!0;var C1=Array.isArray,Uw=Object.prototype.hasOwnProperty,Dm={current:null},jw={key:!0,ref:!0,__self:!0,__source:!0};function Bw(t,e,r){var n,i={},s=null,a=null;if(e!=null)for(n in e.ref!==void 0&&(a=e.ref),e.key!==void 0&&(s=""+e.key),e)Uw.call(e,n)&&!jw.hasOwnProperty(n)&&(i[n]=e[n]);var o=arguments.length-2;if(o===1)i.children=r;else if(1<o){for(var l=Array(o),c=0;c<o;c++)l[c]=arguments[c+2];i.children=l}if(t&&t.defaultProps)for(n in o=t.defaultProps,o)i[n]===void 0&&(i[n]=o[n]);return{$$typeof:uu,type:t,key:s,ref:a,props:i,_owner:Dm.current}}function $I(t,e){return{$$typeof:uu,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function bm(t){return typeof t=="object"&&t!==null&&t.$$typeof===uu}function HI(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(r){return e[r]})}var R1=/\/+/g;function J0(t,e){return typeof t=="object"&&t!==null&&t.key!=null?HI(""+t.key):e.toString(36)}function If(t,e,r,n,i){var s=typeof t;(s==="undefined"||s==="boolean")&&(t=null);var a=!1;if(t===null)a=!0;else switch(s){case"string":case"number":a=!0;break;case"object":switch(t.$$typeof){case uu:case FI:a=!0}}if(a)return a=t,i=i(a),t=n===""?"."+J0(a,0):n,C1(i)?(r="",t!=null&&(r=t.replace(R1,"$&/")+"/"),If(i,e,r,"",function(c){return c})):i!=null&&(bm(i)&&(i=$I(i,r+(!i.key||a&&a.key===i.key?"":(""+i.key).replace(R1,"$&/")+"/")+t)),e.push(i)),1;if(a=0,n=n===""?".":n+":",C1(t))for(var o=0;o<t.length;o++){s=t[o];var l=n+J0(s,o);a+=If(s,e,r,l,i)}else if(l=zI(t),typeof l=="function")for(t=l.call(t),o=0;!(s=t.next()).done;)s=s.value,l=n+J0(s,o++),a+=If(s,e,r,l,i);else if(s==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return a}function Ku(t,e,r){if(t==null)return t;var n=[],i=0;return If(t,n,"","",function(s){return e.call(r,s,i++)}),n}function WI(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(r){(t._status===0||t._status===-1)&&(t._status=1,t._result=r)},function(r){(t._status===0||t._status===-1)&&(t._status=2,t._result=r)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var Qr={current:null},Cf={transition:null},GI={ReactCurrentDispatcher:Qr,ReactCurrentBatchConfig:Cf,ReactCurrentOwner:Dm};function zw(){throw Error("act(...) is not supported in production builds of React.")}qe.Children={map:Ku,forEach:function(t,e,r){Ku(t,function(){e.apply(this,arguments)},r)},count:function(t){var e=0;return Ku(t,function(){e++}),e},toArray:function(t){return Ku(t,function(e){return e})||[]},only:function(t){if(!bm(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};qe.Component=cl;qe.Fragment=DI;qe.Profiler=OI;qe.PureComponent=Pm;qe.StrictMode=bI;qe.Suspense=UI;qe.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=GI;qe.act=zw;qe.cloneElement=function(t,e,r){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var n=Lw({},t.props),i=t.key,s=t.ref,a=t._owner;if(e!=null){if(e.ref!==void 0&&(s=e.ref,a=Dm.current),e.key!==void 0&&(i=""+e.key),t.type&&t.type.defaultProps)var o=t.type.defaultProps;for(l in e)Uw.call(e,l)&&!jw.hasOwnProperty(l)&&(n[l]=e[l]===void 0&&o!==void 0?o[l]:e[l])}var l=arguments.length-2;if(l===1)n.children=r;else if(1<l){o=Array(l);for(var c=0;c<l;c++)o[c]=arguments[c+2];n.children=o}return{$$typeof:uu,type:t.type,key:i,ref:s,props:n,_owner:a}};qe.createContext=function(t){return t={$$typeof:MI,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:LI,_context:t},t.Consumer=t};qe.createElement=Bw;qe.createFactory=function(t){var e=Bw.bind(null,t);return e.type=t,e};qe.createRef=function(){return{current:null}};qe.forwardRef=function(t){return{$$typeof:VI,render:t}};qe.isValidElement=bm;qe.lazy=function(t){return{$$typeof:BI,_payload:{_status:-1,_result:t},_init:WI}};qe.memo=function(t,e){return{$$typeof:jI,type:t,compare:e===void 0?null:e}};qe.startTransition=function(t){var e=Cf.transition;Cf.transition={};try{t()}finally{Cf.transition=e}};qe.unstable_act=zw;qe.useCallback=function(t,e){return Qr.current.useCallback(t,e)};qe.useContext=function(t){return Qr.current.useContext(t)};qe.useDebugValue=function(){};qe.useDeferredValue=function(t){return Qr.current.useDeferredValue(t)};qe.useEffect=function(t,e){return Qr.current.useEffect(t,e)};qe.useId=function(){return Qr.current.useId()};qe.useImperativeHandle=function(t,e,r){return Qr.current.useImperativeHandle(t,e,r)};qe.useInsertionEffect=function(t,e){return Qr.current.useInsertionEffect(t,e)};qe.useLayoutEffect=function(t,e){return Qr.current.useLayoutEffect(t,e)};qe.useMemo=function(t,e){return Qr.current.useMemo(t,e)};qe.useReducer=function(t,e,r){return Qr.current.useReducer(t,e,r)};qe.useRef=function(t){return Qr.current.useRef(t)};qe.useState=function(t){return Qr.current.useState(t)};qe.useSyncExternalStore=function(t,e,r){return Qr.current.useSyncExternalStore(t,e,r)};qe.useTransition=function(){return Qr.current.useTransition()};qe.version="18.3.1";bw.exports=qe;var Z=bw.exports;const $w=Fw(Z),KI=Pw({__proto__:null,default:$w},[Z]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var qI=Z,XI=Symbol.for("react.element"),YI=Symbol.for("react.fragment"),QI=Object.prototype.hasOwnProperty,JI=qI.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,ZI={key:!0,ref:!0,__self:!0,__source:!0};function Hw(t,e,r){var n,i={},s=null,a=null;r!==void 0&&(s=""+r),e.key!==void 0&&(s=""+e.key),e.ref!==void 0&&(a=e.ref);for(n in e)QI.call(e,n)&&!ZI.hasOwnProperty(n)&&(i[n]=e[n]);if(t&&t.defaultProps)for(n in e=t.defaultProps,e)i[n]===void 0&&(i[n]=e[n]);return{$$typeof:XI,type:t,key:s,ref:a,props:i,_owner:JI.current}}e0.Fragment=YI;e0.jsx=Hw;e0.jsxs=Hw;Dw.exports=e0;var m=Dw.exports,Xd={},Ww={exports:{}},Tn={},Gw={exports:{}},Kw={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(ie,G){var ue=ie.length;ie.push(G);e:for(;0<ue;){var Ee=ue-1>>>1,B=ie[Ee];if(0<i(B,G))ie[Ee]=G,ie[ue]=B,ue=Ee;else break e}}function r(ie){return ie.length===0?null:ie[0]}function n(ie){if(ie.length===0)return null;var G=ie[0],ue=ie.pop();if(ue!==G){ie[0]=ue;e:for(var Ee=0,B=ie.length,X=B>>>1;Ee<X;){var K=2*(Ee+1)-1,W=ie[K],ae=K+1,xe=ie[ae];if(0>i(W,ue))ae<B&&0>i(xe,W)?(ie[Ee]=xe,ie[ae]=ue,Ee=ae):(ie[Ee]=W,ie[K]=ue,Ee=K);else if(ae<B&&0>i(xe,ue))ie[Ee]=xe,ie[ae]=ue,Ee=ae;else break e}}return G}function i(ie,G){var ue=ie.sortIndex-G.sortIndex;return ue!==0?ue:ie.id-G.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;t.unstable_now=function(){return s.now()}}else{var a=Date,o=a.now();t.unstable_now=function(){return a.now()-o}}var l=[],c=[],u=1,h=null,d=3,p=!1,x=!1,v=!1,E=typeof setTimeout=="function"?setTimeout:null,T=typeof clearTimeout=="function"?clearTimeout:null,w=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function y(ie){for(var G=r(c);G!==null;){if(G.callback===null)n(c);else if(G.startTime<=ie)n(c),G.sortIndex=G.expirationTime,e(l,G);else break;G=r(c)}}function R(ie){if(v=!1,y(ie),!x)if(r(l)!==null)x=!0,Se(M);else{var G=r(c);G!==null&&oe(R,G.startTime-ie)}}function M(ie,G){x=!1,v&&(v=!1,T(k),k=-1),p=!0;var ue=d;try{for(y(G),h=r(l);h!==null&&(!(h.expirationTime>G)||ie&&!F());){var Ee=h.callback;if(typeof Ee=="function"){h.callback=null,d=h.priorityLevel;var B=Ee(h.expirationTime<=G);G=t.unstable_now(),typeof B=="function"?h.callback=B:h===r(l)&&n(l),y(G)}else n(l);h=r(l)}if(h!==null)var X=!0;else{var K=r(c);K!==null&&oe(R,K.startTime-G),X=!1}return X}finally{h=null,d=ue,p=!1}}var j=!1,g=null,k=-1,S=5,C=-1;function F(){return!(t.unstable_now()-C<S)}function P(){if(g!==null){var ie=t.unstable_now();C=ie;var G=!0;try{G=g(!0,ie)}finally{G?b():(j=!1,g=null)}}else j=!1}var b;if(typeof w=="function")b=function(){w(P)};else if(typeof MessageChannel<"u"){var ve=new MessageChannel,he=ve.port2;ve.port1.onmessage=P,b=function(){he.postMessage(null)}}else b=function(){E(P,0)};function Se(ie){g=ie,j||(j=!0,b())}function oe(ie,G){k=E(function(){ie(t.unstable_now())},G)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(ie){ie.callback=null},t.unstable_continueExecution=function(){x||p||(x=!0,Se(M))},t.unstable_forceFrameRate=function(ie){0>ie||125<ie?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):S=0<ie?Math.floor(1e3/ie):5},t.unstable_getCurrentPriorityLevel=function(){return d},t.unstable_getFirstCallbackNode=function(){return r(l)},t.unstable_next=function(ie){switch(d){case 1:case 2:case 3:var G=3;break;default:G=d}var ue=d;d=G;try{return ie()}finally{d=ue}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(ie,G){switch(ie){case 1:case 2:case 3:case 4:case 5:break;default:ie=3}var ue=d;d=ie;try{return G()}finally{d=ue}},t.unstable_scheduleCallback=function(ie,G,ue){var Ee=t.unstable_now();switch(typeof ue=="object"&&ue!==null?(ue=ue.delay,ue=typeof ue=="number"&&0<ue?Ee+ue:Ee):ue=Ee,ie){case 1:var B=-1;break;case 2:B=250;break;case 5:B=1073741823;break;case 4:B=1e4;break;default:B=5e3}return B=ue+B,ie={id:u++,callback:G,priorityLevel:ie,startTime:ue,expirationTime:B,sortIndex:-1},ue>Ee?(ie.sortIndex=ue,e(c,ie),r(l)===null&&ie===r(c)&&(v?(T(k),k=-1):v=!0,oe(R,ue-Ee))):(ie.sortIndex=B,e(l,ie),x||p||(x=!0,Se(M))),ie},t.unstable_shouldYield=F,t.unstable_wrapCallback=function(ie){var G=d;return function(){var ue=d;d=G;try{return ie.apply(this,arguments)}finally{d=ue}}}})(Kw);Gw.exports=Kw;var eC=Gw.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var tC=Z,wn=eC;function _e(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,r=1;r<arguments.length;r++)e+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var qw=new Set,Ac={};function za(t,e){Ho(t,e),Ho(t+"Capture",e)}function Ho(t,e){for(Ac[t]=e,t=0;t<e.length;t++)qw.add(e[t])}var Zi=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Yd=Object.prototype.hasOwnProperty,rC=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,N1={},P1={};function nC(t){return Yd.call(P1,t)?!0:Yd.call(N1,t)?!1:rC.test(t)?P1[t]=!0:(N1[t]=!0,!1)}function iC(t,e,r,n){if(r!==null&&r.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return n?!1:r!==null?!r.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function sC(t,e,r,n){if(e===null||typeof e>"u"||iC(t,e,r,n))return!0;if(n)return!1;if(r!==null)switch(r.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function Jr(t,e,r,n,i,s,a){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=n,this.attributeNamespace=i,this.mustUseProperty=r,this.propertyName=t,this.type=e,this.sanitizeURL=s,this.removeEmptyString=a}var Tr={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){Tr[t]=new Jr(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];Tr[e]=new Jr(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){Tr[t]=new Jr(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){Tr[t]=new Jr(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){Tr[t]=new Jr(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){Tr[t]=new Jr(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){Tr[t]=new Jr(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){Tr[t]=new Jr(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){Tr[t]=new Jr(t,5,!1,t.toLowerCase(),null,!1,!1)});var Om=/[\-:]([a-z])/g;function Lm(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(Om,Lm);Tr[e]=new Jr(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(Om,Lm);Tr[e]=new Jr(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(Om,Lm);Tr[e]=new Jr(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){Tr[t]=new Jr(t,1,!1,t.toLowerCase(),null,!1,!1)});Tr.xlinkHref=new Jr("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){Tr[t]=new Jr(t,1,!1,t.toLowerCase(),null,!0,!0)});function Mm(t,e,r,n){var i=Tr.hasOwnProperty(e)?Tr[e]:null;(i!==null?i.type!==0:n||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(sC(e,r,i,n)&&(r=null),n||i===null?nC(e)&&(r===null?t.removeAttribute(e):t.setAttribute(e,""+r)):i.mustUseProperty?t[i.propertyName]=r===null?i.type===3?!1:"":r:(e=i.attributeName,n=i.attributeNamespace,r===null?t.removeAttribute(e):(i=i.type,r=i===3||i===4&&r===!0?"":""+r,n?t.setAttributeNS(n,e,r):t.setAttribute(e,r))))}var us=tC.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,qu=Symbol.for("react.element"),xo=Symbol.for("react.portal"),_o=Symbol.for("react.fragment"),Vm=Symbol.for("react.strict_mode"),Qd=Symbol.for("react.profiler"),Xw=Symbol.for("react.provider"),Yw=Symbol.for("react.context"),Um=Symbol.for("react.forward_ref"),Jd=Symbol.for("react.suspense"),Zd=Symbol.for("react.suspense_list"),jm=Symbol.for("react.memo"),ws=Symbol.for("react.lazy"),Qw=Symbol.for("react.offscreen"),F1=Symbol.iterator;function Nl(t){return t===null||typeof t!="object"?null:(t=F1&&t[F1]||t["@@iterator"],typeof t=="function"?t:null)}var Ot=Object.assign,Z0;function zl(t){if(Z0===void 0)try{throw Error()}catch(r){var e=r.stack.trim().match(/\n( *(at )?)/);Z0=e&&e[1]||""}return`
`+Z0+t}var ed=!1;function td(t,e){if(!t||ed)return"";ed=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(c){var n=c}Reflect.construct(t,[],e)}else{try{e.call()}catch(c){n=c}t.call(e.prototype)}else{try{throw Error()}catch(c){n=c}t()}}catch(c){if(c&&n&&typeof c.stack=="string"){for(var i=c.stack.split(`
`),s=n.stack.split(`
`),a=i.length-1,o=s.length-1;1<=a&&0<=o&&i[a]!==s[o];)o--;for(;1<=a&&0<=o;a--,o--)if(i[a]!==s[o]){if(a!==1||o!==1)do if(a--,o--,0>o||i[a]!==s[o]){var l=`
`+i[a].replace(" at new "," at ");return t.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",t.displayName)),l}while(1<=a&&0<=o);break}}}finally{ed=!1,Error.prepareStackTrace=r}return(t=t?t.displayName||t.name:"")?zl(t):""}function aC(t){switch(t.tag){case 5:return zl(t.type);case 16:return zl("Lazy");case 13:return zl("Suspense");case 19:return zl("SuspenseList");case 0:case 2:case 15:return t=td(t.type,!1),t;case 11:return t=td(t.type.render,!1),t;case 1:return t=td(t.type,!0),t;default:return""}}function ep(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case _o:return"Fragment";case xo:return"Portal";case Qd:return"Profiler";case Vm:return"StrictMode";case Jd:return"Suspense";case Zd:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case Yw:return(t.displayName||"Context")+".Consumer";case Xw:return(t._context.displayName||"Context")+".Provider";case Um:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case jm:return e=t.displayName||null,e!==null?e:ep(t.type)||"Memo";case ws:e=t._payload,t=t._init;try{return ep(t(e))}catch{}}return null}function oC(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return ep(e);case 8:return e===Vm?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function Ks(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function Jw(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function lC(t){var e=Jw(t)?"checked":"value",r=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),n=""+t[e];if(!t.hasOwnProperty(e)&&typeof r<"u"&&typeof r.get=="function"&&typeof r.set=="function"){var i=r.get,s=r.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return i.call(this)},set:function(a){n=""+a,s.call(this,a)}}),Object.defineProperty(t,e,{enumerable:r.enumerable}),{getValue:function(){return n},setValue:function(a){n=""+a},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function Xu(t){t._valueTracker||(t._valueTracker=lC(t))}function Zw(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var r=e.getValue(),n="";return t&&(n=Jw(t)?t.checked?"true":"false":t.value),t=n,t!==r?(e.setValue(t),!0):!1}function Xf(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function tp(t,e){var r=e.checked;return Ot({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:r??t._wrapperState.initialChecked})}function D1(t,e){var r=e.defaultValue==null?"":e.defaultValue,n=e.checked!=null?e.checked:e.defaultChecked;r=Ks(e.value!=null?e.value:r),t._wrapperState={initialChecked:n,initialValue:r,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function eE(t,e){e=e.checked,e!=null&&Mm(t,"checked",e,!1)}function rp(t,e){eE(t,e);var r=Ks(e.value),n=e.type;if(r!=null)n==="number"?(r===0&&t.value===""||t.value!=r)&&(t.value=""+r):t.value!==""+r&&(t.value=""+r);else if(n==="submit"||n==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?np(t,e.type,r):e.hasOwnProperty("defaultValue")&&np(t,e.type,Ks(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function b1(t,e,r){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var n=e.type;if(!(n!=="submit"&&n!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,r||e===t.value||(t.value=e),t.defaultValue=e}r=t.name,r!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,r!==""&&(t.name=r)}function np(t,e,r){(e!=="number"||Xf(t.ownerDocument)!==t)&&(r==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+r&&(t.defaultValue=""+r))}var $l=Array.isArray;function Po(t,e,r,n){if(t=t.options,e){e={};for(var i=0;i<r.length;i++)e["$"+r[i]]=!0;for(r=0;r<t.length;r++)i=e.hasOwnProperty("$"+t[r].value),t[r].selected!==i&&(t[r].selected=i),i&&n&&(t[r].defaultSelected=!0)}else{for(r=""+Ks(r),e=null,i=0;i<t.length;i++){if(t[i].value===r){t[i].selected=!0,n&&(t[i].defaultSelected=!0);return}e!==null||t[i].disabled||(e=t[i])}e!==null&&(e.selected=!0)}}function ip(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(_e(91));return Ot({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function O1(t,e){var r=e.value;if(r==null){if(r=e.children,e=e.defaultValue,r!=null){if(e!=null)throw Error(_e(92));if($l(r)){if(1<r.length)throw Error(_e(93));r=r[0]}e=r}e==null&&(e=""),r=e}t._wrapperState={initialValue:Ks(r)}}function tE(t,e){var r=Ks(e.value),n=Ks(e.defaultValue);r!=null&&(r=""+r,r!==t.value&&(t.value=r),e.defaultValue==null&&t.defaultValue!==r&&(t.defaultValue=r)),n!=null&&(t.defaultValue=""+n)}function L1(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function rE(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function sp(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?rE(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var Yu,nE=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,r,n,i){MSApp.execUnsafeLocalFunction(function(){return t(e,r,n,i)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(Yu=Yu||document.createElement("div"),Yu.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=Yu.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function Ic(t,e){if(e){var r=t.firstChild;if(r&&r===t.lastChild&&r.nodeType===3){r.nodeValue=e;return}}t.textContent=e}var rc={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},cC=["Webkit","ms","Moz","O"];Object.keys(rc).forEach(function(t){cC.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),rc[e]=rc[t]})});function iE(t,e,r){return e==null||typeof e=="boolean"||e===""?"":r||typeof e!="number"||e===0||rc.hasOwnProperty(t)&&rc[t]?(""+e).trim():e+"px"}function sE(t,e){t=t.style;for(var r in e)if(e.hasOwnProperty(r)){var n=r.indexOf("--")===0,i=iE(r,e[r],n);r==="float"&&(r="cssFloat"),n?t.setProperty(r,i):t[r]=i}}var uC=Ot({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function ap(t,e){if(e){if(uC[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(_e(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(_e(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(_e(61))}if(e.style!=null&&typeof e.style!="object")throw Error(_e(62))}}function op(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var lp=null;function Bm(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var cp=null,Fo=null,Do=null;function M1(t){if(t=du(t)){if(typeof cp!="function")throw Error(_e(280));var e=t.stateNode;e&&(e=s0(e),cp(t.stateNode,t.type,e))}}function aE(t){Fo?Do?Do.push(t):Do=[t]:Fo=t}function oE(){if(Fo){var t=Fo,e=Do;if(Do=Fo=null,M1(t),e)for(t=0;t<e.length;t++)M1(e[t])}}function lE(t,e){return t(e)}function cE(){}var rd=!1;function uE(t,e,r){if(rd)return t(e,r);rd=!0;try{return lE(t,e,r)}finally{rd=!1,(Fo!==null||Do!==null)&&(cE(),oE())}}function Cc(t,e){var r=t.stateNode;if(r===null)return null;var n=s0(r);if(n===null)return null;r=n[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(t=t.type,n=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!n;break e;default:t=!1}if(t)return null;if(r&&typeof r!="function")throw Error(_e(231,e,typeof r));return r}var up=!1;if(Zi)try{var Pl={};Object.defineProperty(Pl,"passive",{get:function(){up=!0}}),window.addEventListener("test",Pl,Pl),window.removeEventListener("test",Pl,Pl)}catch{up=!1}function fC(t,e,r,n,i,s,a,o,l){var c=Array.prototype.slice.call(arguments,3);try{e.apply(r,c)}catch(u){this.onError(u)}}var nc=!1,Yf=null,Qf=!1,fp=null,hC={onError:function(t){nc=!0,Yf=t}};function dC(t,e,r,n,i,s,a,o,l){nc=!1,Yf=null,fC.apply(hC,arguments)}function pC(t,e,r,n,i,s,a,o,l){if(dC.apply(this,arguments),nc){if(nc){var c=Yf;nc=!1,Yf=null}else throw Error(_e(198));Qf||(Qf=!0,fp=c)}}function $a(t){var e=t,r=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(r=e.return),t=e.return;while(t)}return e.tag===3?r:null}function fE(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function V1(t){if($a(t)!==t)throw Error(_e(188))}function mC(t){var e=t.alternate;if(!e){if(e=$a(t),e===null)throw Error(_e(188));return e!==t?null:t}for(var r=t,n=e;;){var i=r.return;if(i===null)break;var s=i.alternate;if(s===null){if(n=i.return,n!==null){r=n;continue}break}if(i.child===s.child){for(s=i.child;s;){if(s===r)return V1(i),t;if(s===n)return V1(i),e;s=s.sibling}throw Error(_e(188))}if(r.return!==n.return)r=i,n=s;else{for(var a=!1,o=i.child;o;){if(o===r){a=!0,r=i,n=s;break}if(o===n){a=!0,n=i,r=s;break}o=o.sibling}if(!a){for(o=s.child;o;){if(o===r){a=!0,r=s,n=i;break}if(o===n){a=!0,n=s,r=i;break}o=o.sibling}if(!a)throw Error(_e(189))}}if(r.alternate!==n)throw Error(_e(190))}if(r.tag!==3)throw Error(_e(188));return r.stateNode.current===r?t:e}function hE(t){return t=mC(t),t!==null?dE(t):null}function dE(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=dE(t);if(e!==null)return e;t=t.sibling}return null}var pE=wn.unstable_scheduleCallback,U1=wn.unstable_cancelCallback,gC=wn.unstable_shouldYield,vC=wn.unstable_requestPaint,$t=wn.unstable_now,xC=wn.unstable_getCurrentPriorityLevel,zm=wn.unstable_ImmediatePriority,mE=wn.unstable_UserBlockingPriority,Jf=wn.unstable_NormalPriority,_C=wn.unstable_LowPriority,gE=wn.unstable_IdlePriority,t0=null,gi=null;function yC(t){if(gi&&typeof gi.onCommitFiberRoot=="function")try{gi.onCommitFiberRoot(t0,t,void 0,(t.current.flags&128)===128)}catch{}}var ei=Math.clz32?Math.clz32:TC,wC=Math.log,EC=Math.LN2;function TC(t){return t>>>=0,t===0?32:31-(wC(t)/EC|0)|0}var Qu=64,Ju=4194304;function Hl(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function Zf(t,e){var r=t.pendingLanes;if(r===0)return 0;var n=0,i=t.suspendedLanes,s=t.pingedLanes,a=r&268435455;if(a!==0){var o=a&~i;o!==0?n=Hl(o):(s&=a,s!==0&&(n=Hl(s)))}else a=r&~i,a!==0?n=Hl(a):s!==0&&(n=Hl(s));if(n===0)return 0;if(e!==0&&e!==n&&!(e&i)&&(i=n&-n,s=e&-e,i>=s||i===16&&(s&4194240)!==0))return e;if(n&4&&(n|=r&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=n;0<e;)r=31-ei(e),i=1<<r,n|=t[r],e&=~i;return n}function kC(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function SC(t,e){for(var r=t.suspendedLanes,n=t.pingedLanes,i=t.expirationTimes,s=t.pendingLanes;0<s;){var a=31-ei(s),o=1<<a,l=i[a];l===-1?(!(o&r)||o&n)&&(i[a]=kC(o,e)):l<=e&&(t.expiredLanes|=o),s&=~o}}function hp(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function vE(){var t=Qu;return Qu<<=1,!(Qu&4194240)&&(Qu=64),t}function nd(t){for(var e=[],r=0;31>r;r++)e.push(t);return e}function fu(t,e,r){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-ei(e),t[e]=r}function AC(t,e){var r=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var n=t.eventTimes;for(t=t.expirationTimes;0<r;){var i=31-ei(r),s=1<<i;e[i]=0,n[i]=-1,t[i]=-1,r&=~s}}function $m(t,e){var r=t.entangledLanes|=e;for(t=t.entanglements;r;){var n=31-ei(r),i=1<<n;i&e|t[n]&e&&(t[n]|=e),r&=~i}}var mt=0;function xE(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var _E,Hm,yE,wE,EE,dp=!1,Zu=[],Os=null,Ls=null,Ms=null,Rc=new Map,Nc=new Map,Ts=[],IC="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function j1(t,e){switch(t){case"focusin":case"focusout":Os=null;break;case"dragenter":case"dragleave":Ls=null;break;case"mouseover":case"mouseout":Ms=null;break;case"pointerover":case"pointerout":Rc.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":Nc.delete(e.pointerId)}}function Fl(t,e,r,n,i,s){return t===null||t.nativeEvent!==s?(t={blockedOn:e,domEventName:r,eventSystemFlags:n,nativeEvent:s,targetContainers:[i]},e!==null&&(e=du(e),e!==null&&Hm(e)),t):(t.eventSystemFlags|=n,e=t.targetContainers,i!==null&&e.indexOf(i)===-1&&e.push(i),t)}function CC(t,e,r,n,i){switch(e){case"focusin":return Os=Fl(Os,t,e,r,n,i),!0;case"dragenter":return Ls=Fl(Ls,t,e,r,n,i),!0;case"mouseover":return Ms=Fl(Ms,t,e,r,n,i),!0;case"pointerover":var s=i.pointerId;return Rc.set(s,Fl(Rc.get(s)||null,t,e,r,n,i)),!0;case"gotpointercapture":return s=i.pointerId,Nc.set(s,Fl(Nc.get(s)||null,t,e,r,n,i)),!0}return!1}function TE(t){var e=ma(t.target);if(e!==null){var r=$a(e);if(r!==null){if(e=r.tag,e===13){if(e=fE(r),e!==null){t.blockedOn=e,EE(t.priority,function(){yE(r)});return}}else if(e===3&&r.stateNode.current.memoizedState.isDehydrated){t.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}t.blockedOn=null}function Rf(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var r=pp(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(r===null){r=t.nativeEvent;var n=new r.constructor(r.type,r);lp=n,r.target.dispatchEvent(n),lp=null}else return e=du(r),e!==null&&Hm(e),t.blockedOn=r,!1;e.shift()}return!0}function B1(t,e,r){Rf(t)&&r.delete(e)}function RC(){dp=!1,Os!==null&&Rf(Os)&&(Os=null),Ls!==null&&Rf(Ls)&&(Ls=null),Ms!==null&&Rf(Ms)&&(Ms=null),Rc.forEach(B1),Nc.forEach(B1)}function Dl(t,e){t.blockedOn===e&&(t.blockedOn=null,dp||(dp=!0,wn.unstable_scheduleCallback(wn.unstable_NormalPriority,RC)))}function Pc(t){function e(i){return Dl(i,t)}if(0<Zu.length){Dl(Zu[0],t);for(var r=1;r<Zu.length;r++){var n=Zu[r];n.blockedOn===t&&(n.blockedOn=null)}}for(Os!==null&&Dl(Os,t),Ls!==null&&Dl(Ls,t),Ms!==null&&Dl(Ms,t),Rc.forEach(e),Nc.forEach(e),r=0;r<Ts.length;r++)n=Ts[r],n.blockedOn===t&&(n.blockedOn=null);for(;0<Ts.length&&(r=Ts[0],r.blockedOn===null);)TE(r),r.blockedOn===null&&Ts.shift()}var bo=us.ReactCurrentBatchConfig,eh=!0;function NC(t,e,r,n){var i=mt,s=bo.transition;bo.transition=null;try{mt=1,Wm(t,e,r,n)}finally{mt=i,bo.transition=s}}function PC(t,e,r,n){var i=mt,s=bo.transition;bo.transition=null;try{mt=4,Wm(t,e,r,n)}finally{mt=i,bo.transition=s}}function Wm(t,e,r,n){if(eh){var i=pp(t,e,r,n);if(i===null)dd(t,e,n,th,r),j1(t,n);else if(CC(i,t,e,r,n))n.stopPropagation();else if(j1(t,n),e&4&&-1<IC.indexOf(t)){for(;i!==null;){var s=du(i);if(s!==null&&_E(s),s=pp(t,e,r,n),s===null&&dd(t,e,n,th,r),s===i)break;i=s}i!==null&&n.stopPropagation()}else dd(t,e,n,null,r)}}var th=null;function pp(t,e,r,n){if(th=null,t=Bm(n),t=ma(t),t!==null)if(e=$a(t),e===null)t=null;else if(r=e.tag,r===13){if(t=fE(e),t!==null)return t;t=null}else if(r===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return th=t,null}function kE(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(xC()){case zm:return 1;case mE:return 4;case Jf:case _C:return 16;case gE:return 536870912;default:return 16}default:return 16}}var Rs=null,Gm=null,Nf=null;function SE(){if(Nf)return Nf;var t,e=Gm,r=e.length,n,i="value"in Rs?Rs.value:Rs.textContent,s=i.length;for(t=0;t<r&&e[t]===i[t];t++);var a=r-t;for(n=1;n<=a&&e[r-n]===i[s-n];n++);return Nf=i.slice(t,1<n?1-n:void 0)}function Pf(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function ef(){return!0}function z1(){return!1}function kn(t){function e(r,n,i,s,a){this._reactName=r,this._targetInst=i,this.type=n,this.nativeEvent=s,this.target=a,this.currentTarget=null;for(var o in t)t.hasOwnProperty(o)&&(r=t[o],this[o]=r?r(s):s[o]);return this.isDefaultPrevented=(s.defaultPrevented!=null?s.defaultPrevented:s.returnValue===!1)?ef:z1,this.isPropagationStopped=z1,this}return Ot(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=ef)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=ef)},persist:function(){},isPersistent:ef}),e}var ul={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Km=kn(ul),hu=Ot({},ul,{view:0,detail:0}),FC=kn(hu),id,sd,bl,r0=Ot({},hu,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:qm,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==bl&&(bl&&t.type==="mousemove"?(id=t.screenX-bl.screenX,sd=t.screenY-bl.screenY):sd=id=0,bl=t),id)},movementY:function(t){return"movementY"in t?t.movementY:sd}}),$1=kn(r0),DC=Ot({},r0,{dataTransfer:0}),bC=kn(DC),OC=Ot({},hu,{relatedTarget:0}),ad=kn(OC),LC=Ot({},ul,{animationName:0,elapsedTime:0,pseudoElement:0}),MC=kn(LC),VC=Ot({},ul,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),UC=kn(VC),jC=Ot({},ul,{data:0}),H1=kn(jC),BC={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},zC={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},$C={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function HC(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=$C[t])?!!e[t]:!1}function qm(){return HC}var WC=Ot({},hu,{key:function(t){if(t.key){var e=BC[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=Pf(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?zC[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:qm,charCode:function(t){return t.type==="keypress"?Pf(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?Pf(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),GC=kn(WC),KC=Ot({},r0,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),W1=kn(KC),qC=Ot({},hu,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:qm}),XC=kn(qC),YC=Ot({},ul,{propertyName:0,elapsedTime:0,pseudoElement:0}),QC=kn(YC),JC=Ot({},r0,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),ZC=kn(JC),e4=[9,13,27,32],Xm=Zi&&"CompositionEvent"in window,ic=null;Zi&&"documentMode"in document&&(ic=document.documentMode);var t4=Zi&&"TextEvent"in window&&!ic,AE=Zi&&(!Xm||ic&&8<ic&&11>=ic),G1=" ",K1=!1;function IE(t,e){switch(t){case"keyup":return e4.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function CE(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var yo=!1;function r4(t,e){switch(t){case"compositionend":return CE(e);case"keypress":return e.which!==32?null:(K1=!0,G1);case"textInput":return t=e.data,t===G1&&K1?null:t;default:return null}}function n4(t,e){if(yo)return t==="compositionend"||!Xm&&IE(t,e)?(t=SE(),Nf=Gm=Rs=null,yo=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return AE&&e.locale!=="ko"?null:e.data;default:return null}}var i4={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function q1(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!i4[t.type]:e==="textarea"}function RE(t,e,r,n){aE(n),e=rh(e,"onChange"),0<e.length&&(r=new Km("onChange","change",null,r,n),t.push({event:r,listeners:e}))}var sc=null,Fc=null;function s4(t){jE(t,0)}function n0(t){var e=To(t);if(Zw(e))return t}function a4(t,e){if(t==="change")return e}var NE=!1;if(Zi){var od;if(Zi){var ld="oninput"in document;if(!ld){var X1=document.createElement("div");X1.setAttribute("oninput","return;"),ld=typeof X1.oninput=="function"}od=ld}else od=!1;NE=od&&(!document.documentMode||9<document.documentMode)}function Y1(){sc&&(sc.detachEvent("onpropertychange",PE),Fc=sc=null)}function PE(t){if(t.propertyName==="value"&&n0(Fc)){var e=[];RE(e,Fc,t,Bm(t)),uE(s4,e)}}function o4(t,e,r){t==="focusin"?(Y1(),sc=e,Fc=r,sc.attachEvent("onpropertychange",PE)):t==="focusout"&&Y1()}function l4(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return n0(Fc)}function c4(t,e){if(t==="click")return n0(e)}function u4(t,e){if(t==="input"||t==="change")return n0(e)}function f4(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var ii=typeof Object.is=="function"?Object.is:f4;function Dc(t,e){if(ii(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var r=Object.keys(t),n=Object.keys(e);if(r.length!==n.length)return!1;for(n=0;n<r.length;n++){var i=r[n];if(!Yd.call(e,i)||!ii(t[i],e[i]))return!1}return!0}function Q1(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function J1(t,e){var r=Q1(t);t=0;for(var n;r;){if(r.nodeType===3){if(n=t+r.textContent.length,t<=e&&n>=e)return{node:r,offset:e-t};t=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=Q1(r)}}function FE(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?FE(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function DE(){for(var t=window,e=Xf();e instanceof t.HTMLIFrameElement;){try{var r=typeof e.contentWindow.location.href=="string"}catch{r=!1}if(r)t=e.contentWindow;else break;e=Xf(t.document)}return e}function Ym(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function h4(t){var e=DE(),r=t.focusedElem,n=t.selectionRange;if(e!==r&&r&&r.ownerDocument&&FE(r.ownerDocument.documentElement,r)){if(n!==null&&Ym(r)){if(e=n.start,t=n.end,t===void 0&&(t=e),"selectionStart"in r)r.selectionStart=e,r.selectionEnd=Math.min(t,r.value.length);else if(t=(e=r.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var i=r.textContent.length,s=Math.min(n.start,i);n=n.end===void 0?s:Math.min(n.end,i),!t.extend&&s>n&&(i=n,n=s,s=i),i=J1(r,s);var a=J1(r,n);i&&a&&(t.rangeCount!==1||t.anchorNode!==i.node||t.anchorOffset!==i.offset||t.focusNode!==a.node||t.focusOffset!==a.offset)&&(e=e.createRange(),e.setStart(i.node,i.offset),t.removeAllRanges(),s>n?(t.addRange(e),t.extend(a.node,a.offset)):(e.setEnd(a.node,a.offset),t.addRange(e)))}}for(e=[],t=r;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof r.focus=="function"&&r.focus(),r=0;r<e.length;r++)t=e[r],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var d4=Zi&&"documentMode"in document&&11>=document.documentMode,wo=null,mp=null,ac=null,gp=!1;function Z1(t,e,r){var n=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;gp||wo==null||wo!==Xf(n)||(n=wo,"selectionStart"in n&&Ym(n)?n={start:n.selectionStart,end:n.selectionEnd}:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection(),n={anchorNode:n.anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset}),ac&&Dc(ac,n)||(ac=n,n=rh(mp,"onSelect"),0<n.length&&(e=new Km("onSelect","select",null,e,r),t.push({event:e,listeners:n}),e.target=wo)))}function tf(t,e){var r={};return r[t.toLowerCase()]=e.toLowerCase(),r["Webkit"+t]="webkit"+e,r["Moz"+t]="moz"+e,r}var Eo={animationend:tf("Animation","AnimationEnd"),animationiteration:tf("Animation","AnimationIteration"),animationstart:tf("Animation","AnimationStart"),transitionend:tf("Transition","TransitionEnd")},cd={},bE={};Zi&&(bE=document.createElement("div").style,"AnimationEvent"in window||(delete Eo.animationend.animation,delete Eo.animationiteration.animation,delete Eo.animationstart.animation),"TransitionEvent"in window||delete Eo.transitionend.transition);function i0(t){if(cd[t])return cd[t];if(!Eo[t])return t;var e=Eo[t],r;for(r in e)if(e.hasOwnProperty(r)&&r in bE)return cd[t]=e[r];return t}var OE=i0("animationend"),LE=i0("animationiteration"),ME=i0("animationstart"),VE=i0("transitionend"),UE=new Map,ex="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function ta(t,e){UE.set(t,e),za(e,[t])}for(var ud=0;ud<ex.length;ud++){var fd=ex[ud],p4=fd.toLowerCase(),m4=fd[0].toUpperCase()+fd.slice(1);ta(p4,"on"+m4)}ta(OE,"onAnimationEnd");ta(LE,"onAnimationIteration");ta(ME,"onAnimationStart");ta("dblclick","onDoubleClick");ta("focusin","onFocus");ta("focusout","onBlur");ta(VE,"onTransitionEnd");Ho("onMouseEnter",["mouseout","mouseover"]);Ho("onMouseLeave",["mouseout","mouseover"]);Ho("onPointerEnter",["pointerout","pointerover"]);Ho("onPointerLeave",["pointerout","pointerover"]);za("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));za("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));za("onBeforeInput",["compositionend","keypress","textInput","paste"]);za("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));za("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));za("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Wl="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),g4=new Set("cancel close invalid load scroll toggle".split(" ").concat(Wl));function tx(t,e,r){var n=t.type||"unknown-event";t.currentTarget=r,pC(n,e,void 0,t),t.currentTarget=null}function jE(t,e){e=(e&4)!==0;for(var r=0;r<t.length;r++){var n=t[r],i=n.event;n=n.listeners;e:{var s=void 0;if(e)for(var a=n.length-1;0<=a;a--){var o=n[a],l=o.instance,c=o.currentTarget;if(o=o.listener,l!==s&&i.isPropagationStopped())break e;tx(i,o,c),s=l}else for(a=0;a<n.length;a++){if(o=n[a],l=o.instance,c=o.currentTarget,o=o.listener,l!==s&&i.isPropagationStopped())break e;tx(i,o,c),s=l}}}if(Qf)throw t=fp,Qf=!1,fp=null,t}function At(t,e){var r=e[wp];r===void 0&&(r=e[wp]=new Set);var n=t+"__bubble";r.has(n)||(BE(e,t,2,!1),r.add(n))}function hd(t,e,r){var n=0;e&&(n|=4),BE(r,t,n,e)}var rf="_reactListening"+Math.random().toString(36).slice(2);function bc(t){if(!t[rf]){t[rf]=!0,qw.forEach(function(r){r!=="selectionchange"&&(g4.has(r)||hd(r,!1,t),hd(r,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[rf]||(e[rf]=!0,hd("selectionchange",!1,e))}}function BE(t,e,r,n){switch(kE(e)){case 1:var i=NC;break;case 4:i=PC;break;default:i=Wm}r=i.bind(null,e,r,t),i=void 0,!up||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(i=!0),n?i!==void 0?t.addEventListener(e,r,{capture:!0,passive:i}):t.addEventListener(e,r,!0):i!==void 0?t.addEventListener(e,r,{passive:i}):t.addEventListener(e,r,!1)}function dd(t,e,r,n,i){var s=n;if(!(e&1)&&!(e&2)&&n!==null)e:for(;;){if(n===null)return;var a=n.tag;if(a===3||a===4){var o=n.stateNode.containerInfo;if(o===i||o.nodeType===8&&o.parentNode===i)break;if(a===4)for(a=n.return;a!==null;){var l=a.tag;if((l===3||l===4)&&(l=a.stateNode.containerInfo,l===i||l.nodeType===8&&l.parentNode===i))return;a=a.return}for(;o!==null;){if(a=ma(o),a===null)return;if(l=a.tag,l===5||l===6){n=s=a;continue e}o=o.parentNode}}n=n.return}uE(function(){var c=s,u=Bm(r),h=[];e:{var d=UE.get(t);if(d!==void 0){var p=Km,x=t;switch(t){case"keypress":if(Pf(r)===0)break e;case"keydown":case"keyup":p=GC;break;case"focusin":x="focus",p=ad;break;case"focusout":x="blur",p=ad;break;case"beforeblur":case"afterblur":p=ad;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":p=$1;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":p=bC;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":p=XC;break;case OE:case LE:case ME:p=MC;break;case VE:p=QC;break;case"scroll":p=FC;break;case"wheel":p=ZC;break;case"copy":case"cut":case"paste":p=UC;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":p=W1}var v=(e&4)!==0,E=!v&&t==="scroll",T=v?d!==null?d+"Capture":null:d;v=[];for(var w=c,y;w!==null;){y=w;var R=y.stateNode;if(y.tag===5&&R!==null&&(y=R,T!==null&&(R=Cc(w,T),R!=null&&v.push(Oc(w,R,y)))),E)break;w=w.return}0<v.length&&(d=new p(d,x,null,r,u),h.push({event:d,listeners:v}))}}if(!(e&7)){e:{if(d=t==="mouseover"||t==="pointerover",p=t==="mouseout"||t==="pointerout",d&&r!==lp&&(x=r.relatedTarget||r.fromElement)&&(ma(x)||x[es]))break e;if((p||d)&&(d=u.window===u?u:(d=u.ownerDocument)?d.defaultView||d.parentWindow:window,p?(x=r.relatedTarget||r.toElement,p=c,x=x?ma(x):null,x!==null&&(E=$a(x),x!==E||x.tag!==5&&x.tag!==6)&&(x=null)):(p=null,x=c),p!==x)){if(v=$1,R="onMouseLeave",T="onMouseEnter",w="mouse",(t==="pointerout"||t==="pointerover")&&(v=W1,R="onPointerLeave",T="onPointerEnter",w="pointer"),E=p==null?d:To(p),y=x==null?d:To(x),d=new v(R,w+"leave",p,r,u),d.target=E,d.relatedTarget=y,R=null,ma(u)===c&&(v=new v(T,w+"enter",x,r,u),v.target=y,v.relatedTarget=E,R=v),E=R,p&&x)t:{for(v=p,T=x,w=0,y=v;y;y=co(y))w++;for(y=0,R=T;R;R=co(R))y++;for(;0<w-y;)v=co(v),w--;for(;0<y-w;)T=co(T),y--;for(;w--;){if(v===T||T!==null&&v===T.alternate)break t;v=co(v),T=co(T)}v=null}else v=null;p!==null&&rx(h,d,p,v,!1),x!==null&&E!==null&&rx(h,E,x,v,!0)}}e:{if(d=c?To(c):window,p=d.nodeName&&d.nodeName.toLowerCase(),p==="select"||p==="input"&&d.type==="file")var M=a4;else if(q1(d))if(NE)M=u4;else{M=l4;var j=o4}else(p=d.nodeName)&&p.toLowerCase()==="input"&&(d.type==="checkbox"||d.type==="radio")&&(M=c4);if(M&&(M=M(t,c))){RE(h,M,r,u);break e}j&&j(t,d,c),t==="focusout"&&(j=d._wrapperState)&&j.controlled&&d.type==="number"&&np(d,"number",d.value)}switch(j=c?To(c):window,t){case"focusin":(q1(j)||j.contentEditable==="true")&&(wo=j,mp=c,ac=null);break;case"focusout":ac=mp=wo=null;break;case"mousedown":gp=!0;break;case"contextmenu":case"mouseup":case"dragend":gp=!1,Z1(h,r,u);break;case"selectionchange":if(d4)break;case"keydown":case"keyup":Z1(h,r,u)}var g;if(Xm)e:{switch(t){case"compositionstart":var k="onCompositionStart";break e;case"compositionend":k="onCompositionEnd";break e;case"compositionupdate":k="onCompositionUpdate";break e}k=void 0}else yo?IE(t,r)&&(k="onCompositionEnd"):t==="keydown"&&r.keyCode===229&&(k="onCompositionStart");k&&(AE&&r.locale!=="ko"&&(yo||k!=="onCompositionStart"?k==="onCompositionEnd"&&yo&&(g=SE()):(Rs=u,Gm="value"in Rs?Rs.value:Rs.textContent,yo=!0)),j=rh(c,k),0<j.length&&(k=new H1(k,t,null,r,u),h.push({event:k,listeners:j}),g?k.data=g:(g=CE(r),g!==null&&(k.data=g)))),(g=t4?r4(t,r):n4(t,r))&&(c=rh(c,"onBeforeInput"),0<c.length&&(u=new H1("onBeforeInput","beforeinput",null,r,u),h.push({event:u,listeners:c}),u.data=g))}jE(h,e)})}function Oc(t,e,r){return{instance:t,listener:e,currentTarget:r}}function rh(t,e){for(var r=e+"Capture",n=[];t!==null;){var i=t,s=i.stateNode;i.tag===5&&s!==null&&(i=s,s=Cc(t,r),s!=null&&n.unshift(Oc(t,s,i)),s=Cc(t,e),s!=null&&n.push(Oc(t,s,i))),t=t.return}return n}function co(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function rx(t,e,r,n,i){for(var s=e._reactName,a=[];r!==null&&r!==n;){var o=r,l=o.alternate,c=o.stateNode;if(l!==null&&l===n)break;o.tag===5&&c!==null&&(o=c,i?(l=Cc(r,s),l!=null&&a.unshift(Oc(r,l,o))):i||(l=Cc(r,s),l!=null&&a.push(Oc(r,l,o)))),r=r.return}a.length!==0&&t.push({event:e,listeners:a})}var v4=/\r\n?/g,x4=/\u0000|\uFFFD/g;function nx(t){return(typeof t=="string"?t:""+t).replace(v4,`
`).replace(x4,"")}function nf(t,e,r){if(e=nx(e),nx(t)!==e&&r)throw Error(_e(425))}function nh(){}var vp=null,xp=null;function _p(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var yp=typeof setTimeout=="function"?setTimeout:void 0,_4=typeof clearTimeout=="function"?clearTimeout:void 0,ix=typeof Promise=="function"?Promise:void 0,y4=typeof queueMicrotask=="function"?queueMicrotask:typeof ix<"u"?function(t){return ix.resolve(null).then(t).catch(w4)}:yp;function w4(t){setTimeout(function(){throw t})}function pd(t,e){var r=e,n=0;do{var i=r.nextSibling;if(t.removeChild(r),i&&i.nodeType===8)if(r=i.data,r==="/$"){if(n===0){t.removeChild(i),Pc(e);return}n--}else r!=="$"&&r!=="$?"&&r!=="$!"||n++;r=i}while(r);Pc(e)}function Vs(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function sx(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var r=t.data;if(r==="$"||r==="$!"||r==="$?"){if(e===0)return t;e--}else r==="/$"&&e++}t=t.previousSibling}return null}var fl=Math.random().toString(36).slice(2),pi="__reactFiber$"+fl,Lc="__reactProps$"+fl,es="__reactContainer$"+fl,wp="__reactEvents$"+fl,E4="__reactListeners$"+fl,T4="__reactHandles$"+fl;function ma(t){var e=t[pi];if(e)return e;for(var r=t.parentNode;r;){if(e=r[es]||r[pi]){if(r=e.alternate,e.child!==null||r!==null&&r.child!==null)for(t=sx(t);t!==null;){if(r=t[pi])return r;t=sx(t)}return e}t=r,r=t.parentNode}return null}function du(t){return t=t[pi]||t[es],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function To(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(_e(33))}function s0(t){return t[Lc]||null}var Ep=[],ko=-1;function ra(t){return{current:t}}function Ct(t){0>ko||(t.current=Ep[ko],Ep[ko]=null,ko--)}function yt(t,e){ko++,Ep[ko]=t.current,t.current=e}var qs={},Ur=ra(qs),ln=ra(!1),Ca=qs;function Wo(t,e){var r=t.type.contextTypes;if(!r)return qs;var n=t.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===e)return n.__reactInternalMemoizedMaskedChildContext;var i={},s;for(s in r)i[s]=e[s];return n&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=i),i}function cn(t){return t=t.childContextTypes,t!=null}function ih(){Ct(ln),Ct(Ur)}function ax(t,e,r){if(Ur.current!==qs)throw Error(_e(168));yt(Ur,e),yt(ln,r)}function zE(t,e,r){var n=t.stateNode;if(e=e.childContextTypes,typeof n.getChildContext!="function")return r;n=n.getChildContext();for(var i in n)if(!(i in e))throw Error(_e(108,oC(t)||"Unknown",i));return Ot({},r,n)}function sh(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||qs,Ca=Ur.current,yt(Ur,t),yt(ln,ln.current),!0}function ox(t,e,r){var n=t.stateNode;if(!n)throw Error(_e(169));r?(t=zE(t,e,Ca),n.__reactInternalMemoizedMergedChildContext=t,Ct(ln),Ct(Ur),yt(Ur,t)):Ct(ln),yt(ln,r)}var ji=null,a0=!1,md=!1;function $E(t){ji===null?ji=[t]:ji.push(t)}function k4(t){a0=!0,$E(t)}function na(){if(!md&&ji!==null){md=!0;var t=0,e=mt;try{var r=ji;for(mt=1;t<r.length;t++){var n=r[t];do n=n(!0);while(n!==null)}ji=null,a0=!1}catch(i){throw ji!==null&&(ji=ji.slice(t+1)),pE(zm,na),i}finally{mt=e,md=!1}}return null}var So=[],Ao=0,ah=null,oh=0,Pn=[],Fn=0,Ra=null,Bi=1,zi="";function ca(t,e){So[Ao++]=oh,So[Ao++]=ah,ah=t,oh=e}function HE(t,e,r){Pn[Fn++]=Bi,Pn[Fn++]=zi,Pn[Fn++]=Ra,Ra=t;var n=Bi;t=zi;var i=32-ei(n)-1;n&=~(1<<i),r+=1;var s=32-ei(e)+i;if(30<s){var a=i-i%5;s=(n&(1<<a)-1).toString(32),n>>=a,i-=a,Bi=1<<32-ei(e)+i|r<<i|n,zi=s+t}else Bi=1<<s|r<<i|n,zi=t}function Qm(t){t.return!==null&&(ca(t,1),HE(t,1,0))}function Jm(t){for(;t===ah;)ah=So[--Ao],So[Ao]=null,oh=So[--Ao],So[Ao]=null;for(;t===Ra;)Ra=Pn[--Fn],Pn[Fn]=null,zi=Pn[--Fn],Pn[Fn]=null,Bi=Pn[--Fn],Pn[Fn]=null}var _n=null,vn=null,Pt=!1,Xn=null;function WE(t,e){var r=Dn(5,null,null,0);r.elementType="DELETED",r.stateNode=e,r.return=t,e=t.deletions,e===null?(t.deletions=[r],t.flags|=16):e.push(r)}function lx(t,e){switch(t.tag){case 5:var r=t.type;return e=e.nodeType!==1||r.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,_n=t,vn=Vs(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,_n=t,vn=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(r=Ra!==null?{id:Bi,overflow:zi}:null,t.memoizedState={dehydrated:e,treeContext:r,retryLane:1073741824},r=Dn(18,null,null,0),r.stateNode=e,r.return=t,t.child=r,_n=t,vn=null,!0):!1;default:return!1}}function Tp(t){return(t.mode&1)!==0&&(t.flags&128)===0}function kp(t){if(Pt){var e=vn;if(e){var r=e;if(!lx(t,e)){if(Tp(t))throw Error(_e(418));e=Vs(r.nextSibling);var n=_n;e&&lx(t,e)?WE(n,r):(t.flags=t.flags&-4097|2,Pt=!1,_n=t)}}else{if(Tp(t))throw Error(_e(418));t.flags=t.flags&-4097|2,Pt=!1,_n=t}}}function cx(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;_n=t}function sf(t){if(t!==_n)return!1;if(!Pt)return cx(t),Pt=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!_p(t.type,t.memoizedProps)),e&&(e=vn)){if(Tp(t))throw GE(),Error(_e(418));for(;e;)WE(t,e),e=Vs(e.nextSibling)}if(cx(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(_e(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var r=t.data;if(r==="/$"){if(e===0){vn=Vs(t.nextSibling);break e}e--}else r!=="$"&&r!=="$!"&&r!=="$?"||e++}t=t.nextSibling}vn=null}}else vn=_n?Vs(t.stateNode.nextSibling):null;return!0}function GE(){for(var t=vn;t;)t=Vs(t.nextSibling)}function Go(){vn=_n=null,Pt=!1}function Zm(t){Xn===null?Xn=[t]:Xn.push(t)}var S4=us.ReactCurrentBatchConfig;function Ol(t,e,r){if(t=r.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(r._owner){if(r=r._owner,r){if(r.tag!==1)throw Error(_e(309));var n=r.stateNode}if(!n)throw Error(_e(147,t));var i=n,s=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===s?e.ref:(e=function(a){var o=i.refs;a===null?delete o[s]:o[s]=a},e._stringRef=s,e)}if(typeof t!="string")throw Error(_e(284));if(!r._owner)throw Error(_e(290,t))}return t}function af(t,e){throw t=Object.prototype.toString.call(e),Error(_e(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function ux(t){var e=t._init;return e(t._payload)}function KE(t){function e(T,w){if(t){var y=T.deletions;y===null?(T.deletions=[w],T.flags|=16):y.push(w)}}function r(T,w){if(!t)return null;for(;w!==null;)e(T,w),w=w.sibling;return null}function n(T,w){for(T=new Map;w!==null;)w.key!==null?T.set(w.key,w):T.set(w.index,w),w=w.sibling;return T}function i(T,w){return T=zs(T,w),T.index=0,T.sibling=null,T}function s(T,w,y){return T.index=y,t?(y=T.alternate,y!==null?(y=y.index,y<w?(T.flags|=2,w):y):(T.flags|=2,w)):(T.flags|=1048576,w)}function a(T){return t&&T.alternate===null&&(T.flags|=2),T}function o(T,w,y,R){return w===null||w.tag!==6?(w=Ed(y,T.mode,R),w.return=T,w):(w=i(w,y),w.return=T,w)}function l(T,w,y,R){var M=y.type;return M===_o?u(T,w,y.props.children,R,y.key):w!==null&&(w.elementType===M||typeof M=="object"&&M!==null&&M.$$typeof===ws&&ux(M)===w.type)?(R=i(w,y.props),R.ref=Ol(T,w,y),R.return=T,R):(R=Vf(y.type,y.key,y.props,null,T.mode,R),R.ref=Ol(T,w,y),R.return=T,R)}function c(T,w,y,R){return w===null||w.tag!==4||w.stateNode.containerInfo!==y.containerInfo||w.stateNode.implementation!==y.implementation?(w=Td(y,T.mode,R),w.return=T,w):(w=i(w,y.children||[]),w.return=T,w)}function u(T,w,y,R,M){return w===null||w.tag!==7?(w=Ta(y,T.mode,R,M),w.return=T,w):(w=i(w,y),w.return=T,w)}function h(T,w,y){if(typeof w=="string"&&w!==""||typeof w=="number")return w=Ed(""+w,T.mode,y),w.return=T,w;if(typeof w=="object"&&w!==null){switch(w.$$typeof){case qu:return y=Vf(w.type,w.key,w.props,null,T.mode,y),y.ref=Ol(T,null,w),y.return=T,y;case xo:return w=Td(w,T.mode,y),w.return=T,w;case ws:var R=w._init;return h(T,R(w._payload),y)}if($l(w)||Nl(w))return w=Ta(w,T.mode,y,null),w.return=T,w;af(T,w)}return null}function d(T,w,y,R){var M=w!==null?w.key:null;if(typeof y=="string"&&y!==""||typeof y=="number")return M!==null?null:o(T,w,""+y,R);if(typeof y=="object"&&y!==null){switch(y.$$typeof){case qu:return y.key===M?l(T,w,y,R):null;case xo:return y.key===M?c(T,w,y,R):null;case ws:return M=y._init,d(T,w,M(y._payload),R)}if($l(y)||Nl(y))return M!==null?null:u(T,w,y,R,null);af(T,y)}return null}function p(T,w,y,R,M){if(typeof R=="string"&&R!==""||typeof R=="number")return T=T.get(y)||null,o(w,T,""+R,M);if(typeof R=="object"&&R!==null){switch(R.$$typeof){case qu:return T=T.get(R.key===null?y:R.key)||null,l(w,T,R,M);case xo:return T=T.get(R.key===null?y:R.key)||null,c(w,T,R,M);case ws:var j=R._init;return p(T,w,y,j(R._payload),M)}if($l(R)||Nl(R))return T=T.get(y)||null,u(w,T,R,M,null);af(w,R)}return null}function x(T,w,y,R){for(var M=null,j=null,g=w,k=w=0,S=null;g!==null&&k<y.length;k++){g.index>k?(S=g,g=null):S=g.sibling;var C=d(T,g,y[k],R);if(C===null){g===null&&(g=S);break}t&&g&&C.alternate===null&&e(T,g),w=s(C,w,k),j===null?M=C:j.sibling=C,j=C,g=S}if(k===y.length)return r(T,g),Pt&&ca(T,k),M;if(g===null){for(;k<y.length;k++)g=h(T,y[k],R),g!==null&&(w=s(g,w,k),j===null?M=g:j.sibling=g,j=g);return Pt&&ca(T,k),M}for(g=n(T,g);k<y.length;k++)S=p(g,T,k,y[k],R),S!==null&&(t&&S.alternate!==null&&g.delete(S.key===null?k:S.key),w=s(S,w,k),j===null?M=S:j.sibling=S,j=S);return t&&g.forEach(function(F){return e(T,F)}),Pt&&ca(T,k),M}function v(T,w,y,R){var M=Nl(y);if(typeof M!="function")throw Error(_e(150));if(y=M.call(y),y==null)throw Error(_e(151));for(var j=M=null,g=w,k=w=0,S=null,C=y.next();g!==null&&!C.done;k++,C=y.next()){g.index>k?(S=g,g=null):S=g.sibling;var F=d(T,g,C.value,R);if(F===null){g===null&&(g=S);break}t&&g&&F.alternate===null&&e(T,g),w=s(F,w,k),j===null?M=F:j.sibling=F,j=F,g=S}if(C.done)return r(T,g),Pt&&ca(T,k),M;if(g===null){for(;!C.done;k++,C=y.next())C=h(T,C.value,R),C!==null&&(w=s(C,w,k),j===null?M=C:j.sibling=C,j=C);return Pt&&ca(T,k),M}for(g=n(T,g);!C.done;k++,C=y.next())C=p(g,T,k,C.value,R),C!==null&&(t&&C.alternate!==null&&g.delete(C.key===null?k:C.key),w=s(C,w,k),j===null?M=C:j.sibling=C,j=C);return t&&g.forEach(function(P){return e(T,P)}),Pt&&ca(T,k),M}function E(T,w,y,R){if(typeof y=="object"&&y!==null&&y.type===_o&&y.key===null&&(y=y.props.children),typeof y=="object"&&y!==null){switch(y.$$typeof){case qu:e:{for(var M=y.key,j=w;j!==null;){if(j.key===M){if(M=y.type,M===_o){if(j.tag===7){r(T,j.sibling),w=i(j,y.props.children),w.return=T,T=w;break e}}else if(j.elementType===M||typeof M=="object"&&M!==null&&M.$$typeof===ws&&ux(M)===j.type){r(T,j.sibling),w=i(j,y.props),w.ref=Ol(T,j,y),w.return=T,T=w;break e}r(T,j);break}else e(T,j);j=j.sibling}y.type===_o?(w=Ta(y.props.children,T.mode,R,y.key),w.return=T,T=w):(R=Vf(y.type,y.key,y.props,null,T.mode,R),R.ref=Ol(T,w,y),R.return=T,T=R)}return a(T);case xo:e:{for(j=y.key;w!==null;){if(w.key===j)if(w.tag===4&&w.stateNode.containerInfo===y.containerInfo&&w.stateNode.implementation===y.implementation){r(T,w.sibling),w=i(w,y.children||[]),w.return=T,T=w;break e}else{r(T,w);break}else e(T,w);w=w.sibling}w=Td(y,T.mode,R),w.return=T,T=w}return a(T);case ws:return j=y._init,E(T,w,j(y._payload),R)}if($l(y))return x(T,w,y,R);if(Nl(y))return v(T,w,y,R);af(T,y)}return typeof y=="string"&&y!==""||typeof y=="number"?(y=""+y,w!==null&&w.tag===6?(r(T,w.sibling),w=i(w,y),w.return=T,T=w):(r(T,w),w=Ed(y,T.mode,R),w.return=T,T=w),a(T)):r(T,w)}return E}var Ko=KE(!0),qE=KE(!1),lh=ra(null),ch=null,Io=null,eg=null;function tg(){eg=Io=ch=null}function rg(t){var e=lh.current;Ct(lh),t._currentValue=e}function Sp(t,e,r){for(;t!==null;){var n=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,n!==null&&(n.childLanes|=e)):n!==null&&(n.childLanes&e)!==e&&(n.childLanes|=e),t===r)break;t=t.return}}function Oo(t,e){ch=t,eg=Io=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(on=!0),t.firstContext=null)}function Mn(t){var e=t._currentValue;if(eg!==t)if(t={context:t,memoizedValue:e,next:null},Io===null){if(ch===null)throw Error(_e(308));Io=t,ch.dependencies={lanes:0,firstContext:t}}else Io=Io.next=t;return e}var ga=null;function ng(t){ga===null?ga=[t]:ga.push(t)}function XE(t,e,r,n){var i=e.interleaved;return i===null?(r.next=r,ng(e)):(r.next=i.next,i.next=r),e.interleaved=r,ts(t,n)}function ts(t,e){t.lanes|=e;var r=t.alternate;for(r!==null&&(r.lanes|=e),r=t,t=t.return;t!==null;)t.childLanes|=e,r=t.alternate,r!==null&&(r.childLanes|=e),r=t,t=t.return;return r.tag===3?r.stateNode:null}var Es=!1;function ig(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function YE(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function qi(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function Us(t,e,r){var n=t.updateQueue;if(n===null)return null;if(n=n.shared,st&2){var i=n.pending;return i===null?e.next=e:(e.next=i.next,i.next=e),n.pending=e,ts(t,r)}return i=n.interleaved,i===null?(e.next=e,ng(n)):(e.next=i.next,i.next=e),n.interleaved=e,ts(t,r)}function Ff(t,e,r){if(e=e.updateQueue,e!==null&&(e=e.shared,(r&4194240)!==0)){var n=e.lanes;n&=t.pendingLanes,r|=n,e.lanes=r,$m(t,r)}}function fx(t,e){var r=t.updateQueue,n=t.alternate;if(n!==null&&(n=n.updateQueue,r===n)){var i=null,s=null;if(r=r.firstBaseUpdate,r!==null){do{var a={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};s===null?i=s=a:s=s.next=a,r=r.next}while(r!==null);s===null?i=s=e:s=s.next=e}else i=s=e;r={baseState:n.baseState,firstBaseUpdate:i,lastBaseUpdate:s,shared:n.shared,effects:n.effects},t.updateQueue=r;return}t=r.lastBaseUpdate,t===null?r.firstBaseUpdate=e:t.next=e,r.lastBaseUpdate=e}function uh(t,e,r,n){var i=t.updateQueue;Es=!1;var s=i.firstBaseUpdate,a=i.lastBaseUpdate,o=i.shared.pending;if(o!==null){i.shared.pending=null;var l=o,c=l.next;l.next=null,a===null?s=c:a.next=c,a=l;var u=t.alternate;u!==null&&(u=u.updateQueue,o=u.lastBaseUpdate,o!==a&&(o===null?u.firstBaseUpdate=c:o.next=c,u.lastBaseUpdate=l))}if(s!==null){var h=i.baseState;a=0,u=c=l=null,o=s;do{var d=o.lane,p=o.eventTime;if((n&d)===d){u!==null&&(u=u.next={eventTime:p,lane:0,tag:o.tag,payload:o.payload,callback:o.callback,next:null});e:{var x=t,v=o;switch(d=e,p=r,v.tag){case 1:if(x=v.payload,typeof x=="function"){h=x.call(p,h,d);break e}h=x;break e;case 3:x.flags=x.flags&-65537|128;case 0:if(x=v.payload,d=typeof x=="function"?x.call(p,h,d):x,d==null)break e;h=Ot({},h,d);break e;case 2:Es=!0}}o.callback!==null&&o.lane!==0&&(t.flags|=64,d=i.effects,d===null?i.effects=[o]:d.push(o))}else p={eventTime:p,lane:d,tag:o.tag,payload:o.payload,callback:o.callback,next:null},u===null?(c=u=p,l=h):u=u.next=p,a|=d;if(o=o.next,o===null){if(o=i.shared.pending,o===null)break;d=o,o=d.next,d.next=null,i.lastBaseUpdate=d,i.shared.pending=null}}while(!0);if(u===null&&(l=h),i.baseState=l,i.firstBaseUpdate=c,i.lastBaseUpdate=u,e=i.shared.interleaved,e!==null){i=e;do a|=i.lane,i=i.next;while(i!==e)}else s===null&&(i.shared.lanes=0);Pa|=a,t.lanes=a,t.memoizedState=h}}function hx(t,e,r){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var n=t[e],i=n.callback;if(i!==null){if(n.callback=null,n=r,typeof i!="function")throw Error(_e(191,i));i.call(n)}}}var pu={},vi=ra(pu),Mc=ra(pu),Vc=ra(pu);function va(t){if(t===pu)throw Error(_e(174));return t}function sg(t,e){switch(yt(Vc,e),yt(Mc,t),yt(vi,pu),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:sp(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=sp(e,t)}Ct(vi),yt(vi,e)}function qo(){Ct(vi),Ct(Mc),Ct(Vc)}function QE(t){va(Vc.current);var e=va(vi.current),r=sp(e,t.type);e!==r&&(yt(Mc,t),yt(vi,r))}function ag(t){Mc.current===t&&(Ct(vi),Ct(Mc))}var Dt=ra(0);function fh(t){for(var e=t;e!==null;){if(e.tag===13){var r=e.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||r.data==="$?"||r.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var gd=[];function og(){for(var t=0;t<gd.length;t++)gd[t]._workInProgressVersionPrimary=null;gd.length=0}var Df=us.ReactCurrentDispatcher,vd=us.ReactCurrentBatchConfig,Na=0,bt=null,tr=null,ur=null,hh=!1,oc=!1,Uc=0,A4=0;function Cr(){throw Error(_e(321))}function lg(t,e){if(e===null)return!1;for(var r=0;r<e.length&&r<t.length;r++)if(!ii(t[r],e[r]))return!1;return!0}function cg(t,e,r,n,i,s){if(Na=s,bt=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,Df.current=t===null||t.memoizedState===null?N4:P4,t=r(n,i),oc){s=0;do{if(oc=!1,Uc=0,25<=s)throw Error(_e(301));s+=1,ur=tr=null,e.updateQueue=null,Df.current=F4,t=r(n,i)}while(oc)}if(Df.current=dh,e=tr!==null&&tr.next!==null,Na=0,ur=tr=bt=null,hh=!1,e)throw Error(_e(300));return t}function ug(){var t=Uc!==0;return Uc=0,t}function di(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return ur===null?bt.memoizedState=ur=t:ur=ur.next=t,ur}function Vn(){if(tr===null){var t=bt.alternate;t=t!==null?t.memoizedState:null}else t=tr.next;var e=ur===null?bt.memoizedState:ur.next;if(e!==null)ur=e,tr=t;else{if(t===null)throw Error(_e(310));tr=t,t={memoizedState:tr.memoizedState,baseState:tr.baseState,baseQueue:tr.baseQueue,queue:tr.queue,next:null},ur===null?bt.memoizedState=ur=t:ur=ur.next=t}return ur}function jc(t,e){return typeof e=="function"?e(t):e}function xd(t){var e=Vn(),r=e.queue;if(r===null)throw Error(_e(311));r.lastRenderedReducer=t;var n=tr,i=n.baseQueue,s=r.pending;if(s!==null){if(i!==null){var a=i.next;i.next=s.next,s.next=a}n.baseQueue=i=s,r.pending=null}if(i!==null){s=i.next,n=n.baseState;var o=a=null,l=null,c=s;do{var u=c.lane;if((Na&u)===u)l!==null&&(l=l.next={lane:0,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null}),n=c.hasEagerState?c.eagerState:t(n,c.action);else{var h={lane:u,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null};l===null?(o=l=h,a=n):l=l.next=h,bt.lanes|=u,Pa|=u}c=c.next}while(c!==null&&c!==s);l===null?a=n:l.next=o,ii(n,e.memoizedState)||(on=!0),e.memoizedState=n,e.baseState=a,e.baseQueue=l,r.lastRenderedState=n}if(t=r.interleaved,t!==null){i=t;do s=i.lane,bt.lanes|=s,Pa|=s,i=i.next;while(i!==t)}else i===null&&(r.lanes=0);return[e.memoizedState,r.dispatch]}function _d(t){var e=Vn(),r=e.queue;if(r===null)throw Error(_e(311));r.lastRenderedReducer=t;var n=r.dispatch,i=r.pending,s=e.memoizedState;if(i!==null){r.pending=null;var a=i=i.next;do s=t(s,a.action),a=a.next;while(a!==i);ii(s,e.memoizedState)||(on=!0),e.memoizedState=s,e.baseQueue===null&&(e.baseState=s),r.lastRenderedState=s}return[s,n]}function JE(){}function ZE(t,e){var r=bt,n=Vn(),i=e(),s=!ii(n.memoizedState,i);if(s&&(n.memoizedState=i,on=!0),n=n.queue,fg(r2.bind(null,r,n,t),[t]),n.getSnapshot!==e||s||ur!==null&&ur.memoizedState.tag&1){if(r.flags|=2048,Bc(9,t2.bind(null,r,n,i,e),void 0,null),fr===null)throw Error(_e(349));Na&30||e2(r,e,i)}return i}function e2(t,e,r){t.flags|=16384,t={getSnapshot:e,value:r},e=bt.updateQueue,e===null?(e={lastEffect:null,stores:null},bt.updateQueue=e,e.stores=[t]):(r=e.stores,r===null?e.stores=[t]:r.push(t))}function t2(t,e,r,n){e.value=r,e.getSnapshot=n,n2(e)&&i2(t)}function r2(t,e,r){return r(function(){n2(e)&&i2(t)})}function n2(t){var e=t.getSnapshot;t=t.value;try{var r=e();return!ii(t,r)}catch{return!0}}function i2(t){var e=ts(t,1);e!==null&&ti(e,t,1,-1)}function dx(t){var e=di();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:jc,lastRenderedState:t},e.queue=t,t=t.dispatch=R4.bind(null,bt,t),[e.memoizedState,t]}function Bc(t,e,r,n){return t={tag:t,create:e,destroy:r,deps:n,next:null},e=bt.updateQueue,e===null?(e={lastEffect:null,stores:null},bt.updateQueue=e,e.lastEffect=t.next=t):(r=e.lastEffect,r===null?e.lastEffect=t.next=t:(n=r.next,r.next=t,t.next=n,e.lastEffect=t)),t}function s2(){return Vn().memoizedState}function bf(t,e,r,n){var i=di();bt.flags|=t,i.memoizedState=Bc(1|e,r,void 0,n===void 0?null:n)}function o0(t,e,r,n){var i=Vn();n=n===void 0?null:n;var s=void 0;if(tr!==null){var a=tr.memoizedState;if(s=a.destroy,n!==null&&lg(n,a.deps)){i.memoizedState=Bc(e,r,s,n);return}}bt.flags|=t,i.memoizedState=Bc(1|e,r,s,n)}function px(t,e){return bf(8390656,8,t,e)}function fg(t,e){return o0(2048,8,t,e)}function a2(t,e){return o0(4,2,t,e)}function o2(t,e){return o0(4,4,t,e)}function l2(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function c2(t,e,r){return r=r!=null?r.concat([t]):null,o0(4,4,l2.bind(null,e,t),r)}function hg(){}function u2(t,e){var r=Vn();e=e===void 0?null:e;var n=r.memoizedState;return n!==null&&e!==null&&lg(e,n[1])?n[0]:(r.memoizedState=[t,e],t)}function f2(t,e){var r=Vn();e=e===void 0?null:e;var n=r.memoizedState;return n!==null&&e!==null&&lg(e,n[1])?n[0]:(t=t(),r.memoizedState=[t,e],t)}function h2(t,e,r){return Na&21?(ii(r,e)||(r=vE(),bt.lanes|=r,Pa|=r,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,on=!0),t.memoizedState=r)}function I4(t,e){var r=mt;mt=r!==0&&4>r?r:4,t(!0);var n=vd.transition;vd.transition={};try{t(!1),e()}finally{mt=r,vd.transition=n}}function d2(){return Vn().memoizedState}function C4(t,e,r){var n=Bs(t);if(r={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null},p2(t))m2(e,r);else if(r=XE(t,e,r,n),r!==null){var i=Kr();ti(r,t,n,i),g2(r,e,n)}}function R4(t,e,r){var n=Bs(t),i={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null};if(p2(t))m2(e,i);else{var s=t.alternate;if(t.lanes===0&&(s===null||s.lanes===0)&&(s=e.lastRenderedReducer,s!==null))try{var a=e.lastRenderedState,o=s(a,r);if(i.hasEagerState=!0,i.eagerState=o,ii(o,a)){var l=e.interleaved;l===null?(i.next=i,ng(e)):(i.next=l.next,l.next=i),e.interleaved=i;return}}catch{}finally{}r=XE(t,e,i,n),r!==null&&(i=Kr(),ti(r,t,n,i),g2(r,e,n))}}function p2(t){var e=t.alternate;return t===bt||e!==null&&e===bt}function m2(t,e){oc=hh=!0;var r=t.pending;r===null?e.next=e:(e.next=r.next,r.next=e),t.pending=e}function g2(t,e,r){if(r&4194240){var n=e.lanes;n&=t.pendingLanes,r|=n,e.lanes=r,$m(t,r)}}var dh={readContext:Mn,useCallback:Cr,useContext:Cr,useEffect:Cr,useImperativeHandle:Cr,useInsertionEffect:Cr,useLayoutEffect:Cr,useMemo:Cr,useReducer:Cr,useRef:Cr,useState:Cr,useDebugValue:Cr,useDeferredValue:Cr,useTransition:Cr,useMutableSource:Cr,useSyncExternalStore:Cr,useId:Cr,unstable_isNewReconciler:!1},N4={readContext:Mn,useCallback:function(t,e){return di().memoizedState=[t,e===void 0?null:e],t},useContext:Mn,useEffect:px,useImperativeHandle:function(t,e,r){return r=r!=null?r.concat([t]):null,bf(4194308,4,l2.bind(null,e,t),r)},useLayoutEffect:function(t,e){return bf(4194308,4,t,e)},useInsertionEffect:function(t,e){return bf(4,2,t,e)},useMemo:function(t,e){var r=di();return e=e===void 0?null:e,t=t(),r.memoizedState=[t,e],t},useReducer:function(t,e,r){var n=di();return e=r!==void 0?r(e):e,n.memoizedState=n.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},n.queue=t,t=t.dispatch=C4.bind(null,bt,t),[n.memoizedState,t]},useRef:function(t){var e=di();return t={current:t},e.memoizedState=t},useState:dx,useDebugValue:hg,useDeferredValue:function(t){return di().memoizedState=t},useTransition:function(){var t=dx(!1),e=t[0];return t=I4.bind(null,t[1]),di().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,r){var n=bt,i=di();if(Pt){if(r===void 0)throw Error(_e(407));r=r()}else{if(r=e(),fr===null)throw Error(_e(349));Na&30||e2(n,e,r)}i.memoizedState=r;var s={value:r,getSnapshot:e};return i.queue=s,px(r2.bind(null,n,s,t),[t]),n.flags|=2048,Bc(9,t2.bind(null,n,s,r,e),void 0,null),r},useId:function(){var t=di(),e=fr.identifierPrefix;if(Pt){var r=zi,n=Bi;r=(n&~(1<<32-ei(n)-1)).toString(32)+r,e=":"+e+"R"+r,r=Uc++,0<r&&(e+="H"+r.toString(32)),e+=":"}else r=A4++,e=":"+e+"r"+r.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},P4={readContext:Mn,useCallback:u2,useContext:Mn,useEffect:fg,useImperativeHandle:c2,useInsertionEffect:a2,useLayoutEffect:o2,useMemo:f2,useReducer:xd,useRef:s2,useState:function(){return xd(jc)},useDebugValue:hg,useDeferredValue:function(t){var e=Vn();return h2(e,tr.memoizedState,t)},useTransition:function(){var t=xd(jc)[0],e=Vn().memoizedState;return[t,e]},useMutableSource:JE,useSyncExternalStore:ZE,useId:d2,unstable_isNewReconciler:!1},F4={readContext:Mn,useCallback:u2,useContext:Mn,useEffect:fg,useImperativeHandle:c2,useInsertionEffect:a2,useLayoutEffect:o2,useMemo:f2,useReducer:_d,useRef:s2,useState:function(){return _d(jc)},useDebugValue:hg,useDeferredValue:function(t){var e=Vn();return tr===null?e.memoizedState=t:h2(e,tr.memoizedState,t)},useTransition:function(){var t=_d(jc)[0],e=Vn().memoizedState;return[t,e]},useMutableSource:JE,useSyncExternalStore:ZE,useId:d2,unstable_isNewReconciler:!1};function Gn(t,e){if(t&&t.defaultProps){e=Ot({},e),t=t.defaultProps;for(var r in t)e[r]===void 0&&(e[r]=t[r]);return e}return e}function Ap(t,e,r,n){e=t.memoizedState,r=r(n,e),r=r==null?e:Ot({},e,r),t.memoizedState=r,t.lanes===0&&(t.updateQueue.baseState=r)}var l0={isMounted:function(t){return(t=t._reactInternals)?$a(t)===t:!1},enqueueSetState:function(t,e,r){t=t._reactInternals;var n=Kr(),i=Bs(t),s=qi(n,i);s.payload=e,r!=null&&(s.callback=r),e=Us(t,s,i),e!==null&&(ti(e,t,i,n),Ff(e,t,i))},enqueueReplaceState:function(t,e,r){t=t._reactInternals;var n=Kr(),i=Bs(t),s=qi(n,i);s.tag=1,s.payload=e,r!=null&&(s.callback=r),e=Us(t,s,i),e!==null&&(ti(e,t,i,n),Ff(e,t,i))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var r=Kr(),n=Bs(t),i=qi(r,n);i.tag=2,e!=null&&(i.callback=e),e=Us(t,i,n),e!==null&&(ti(e,t,n,r),Ff(e,t,n))}};function mx(t,e,r,n,i,s,a){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(n,s,a):e.prototype&&e.prototype.isPureReactComponent?!Dc(r,n)||!Dc(i,s):!0}function v2(t,e,r){var n=!1,i=qs,s=e.contextType;return typeof s=="object"&&s!==null?s=Mn(s):(i=cn(e)?Ca:Ur.current,n=e.contextTypes,s=(n=n!=null)?Wo(t,i):qs),e=new e(r,s),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=l0,t.stateNode=e,e._reactInternals=t,n&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=i,t.__reactInternalMemoizedMaskedChildContext=s),e}function gx(t,e,r,n){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(r,n),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(r,n),e.state!==t&&l0.enqueueReplaceState(e,e.state,null)}function Ip(t,e,r,n){var i=t.stateNode;i.props=r,i.state=t.memoizedState,i.refs={},ig(t);var s=e.contextType;typeof s=="object"&&s!==null?i.context=Mn(s):(s=cn(e)?Ca:Ur.current,i.context=Wo(t,s)),i.state=t.memoizedState,s=e.getDerivedStateFromProps,typeof s=="function"&&(Ap(t,e,s,r),i.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(e=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),e!==i.state&&l0.enqueueReplaceState(i,i.state,null),uh(t,r,i,n),i.state=t.memoizedState),typeof i.componentDidMount=="function"&&(t.flags|=4194308)}function Xo(t,e){try{var r="",n=e;do r+=aC(n),n=n.return;while(n);var i=r}catch(s){i=`
Error generating stack: `+s.message+`
`+s.stack}return{value:t,source:e,stack:i,digest:null}}function yd(t,e,r){return{value:t,source:null,stack:r??null,digest:e??null}}function Cp(t,e){try{console.error(e.value)}catch(r){setTimeout(function(){throw r})}}var D4=typeof WeakMap=="function"?WeakMap:Map;function x2(t,e,r){r=qi(-1,r),r.tag=3,r.payload={element:null};var n=e.value;return r.callback=function(){mh||(mh=!0,Vp=n),Cp(t,e)},r}function _2(t,e,r){r=qi(-1,r),r.tag=3;var n=t.type.getDerivedStateFromError;if(typeof n=="function"){var i=e.value;r.payload=function(){return n(i)},r.callback=function(){Cp(t,e)}}var s=t.stateNode;return s!==null&&typeof s.componentDidCatch=="function"&&(r.callback=function(){Cp(t,e),typeof n!="function"&&(js===null?js=new Set([this]):js.add(this));var a=e.stack;this.componentDidCatch(e.value,{componentStack:a!==null?a:""})}),r}function vx(t,e,r){var n=t.pingCache;if(n===null){n=t.pingCache=new D4;var i=new Set;n.set(e,i)}else i=n.get(e),i===void 0&&(i=new Set,n.set(e,i));i.has(r)||(i.add(r),t=K4.bind(null,t,e,r),e.then(t,t))}function xx(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function _x(t,e,r,n,i){return t.mode&1?(t.flags|=65536,t.lanes=i,t):(t===e?t.flags|=65536:(t.flags|=128,r.flags|=131072,r.flags&=-52805,r.tag===1&&(r.alternate===null?r.tag=17:(e=qi(-1,1),e.tag=2,Us(r,e,1))),r.lanes|=1),t)}var b4=us.ReactCurrentOwner,on=!1;function $r(t,e,r,n){e.child=t===null?qE(e,null,r,n):Ko(e,t.child,r,n)}function yx(t,e,r,n,i){r=r.render;var s=e.ref;return Oo(e,i),n=cg(t,e,r,n,s,i),r=ug(),t!==null&&!on?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,rs(t,e,i)):(Pt&&r&&Qm(e),e.flags|=1,$r(t,e,n,i),e.child)}function wx(t,e,r,n,i){if(t===null){var s=r.type;return typeof s=="function"&&!yg(s)&&s.defaultProps===void 0&&r.compare===null&&r.defaultProps===void 0?(e.tag=15,e.type=s,y2(t,e,s,n,i)):(t=Vf(r.type,null,n,e,e.mode,i),t.ref=e.ref,t.return=e,e.child=t)}if(s=t.child,!(t.lanes&i)){var a=s.memoizedProps;if(r=r.compare,r=r!==null?r:Dc,r(a,n)&&t.ref===e.ref)return rs(t,e,i)}return e.flags|=1,t=zs(s,n),t.ref=e.ref,t.return=e,e.child=t}function y2(t,e,r,n,i){if(t!==null){var s=t.memoizedProps;if(Dc(s,n)&&t.ref===e.ref)if(on=!1,e.pendingProps=n=s,(t.lanes&i)!==0)t.flags&131072&&(on=!0);else return e.lanes=t.lanes,rs(t,e,i)}return Rp(t,e,r,n,i)}function w2(t,e,r){var n=e.pendingProps,i=n.children,s=t!==null?t.memoizedState:null;if(n.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},yt(Ro,dn),dn|=r;else{if(!(r&1073741824))return t=s!==null?s.baseLanes|r:r,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,yt(Ro,dn),dn|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=s!==null?s.baseLanes:r,yt(Ro,dn),dn|=n}else s!==null?(n=s.baseLanes|r,e.memoizedState=null):n=r,yt(Ro,dn),dn|=n;return $r(t,e,i,r),e.child}function E2(t,e){var r=e.ref;(t===null&&r!==null||t!==null&&t.ref!==r)&&(e.flags|=512,e.flags|=2097152)}function Rp(t,e,r,n,i){var s=cn(r)?Ca:Ur.current;return s=Wo(e,s),Oo(e,i),r=cg(t,e,r,n,s,i),n=ug(),t!==null&&!on?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,rs(t,e,i)):(Pt&&n&&Qm(e),e.flags|=1,$r(t,e,r,i),e.child)}function Ex(t,e,r,n,i){if(cn(r)){var s=!0;sh(e)}else s=!1;if(Oo(e,i),e.stateNode===null)Of(t,e),v2(e,r,n),Ip(e,r,n,i),n=!0;else if(t===null){var a=e.stateNode,o=e.memoizedProps;a.props=o;var l=a.context,c=r.contextType;typeof c=="object"&&c!==null?c=Mn(c):(c=cn(r)?Ca:Ur.current,c=Wo(e,c));var u=r.getDerivedStateFromProps,h=typeof u=="function"||typeof a.getSnapshotBeforeUpdate=="function";h||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(o!==n||l!==c)&&gx(e,a,n,c),Es=!1;var d=e.memoizedState;a.state=d,uh(e,n,a,i),l=e.memoizedState,o!==n||d!==l||ln.current||Es?(typeof u=="function"&&(Ap(e,r,u,n),l=e.memoizedState),(o=Es||mx(e,r,o,n,d,l,c))?(h||typeof a.UNSAFE_componentWillMount!="function"&&typeof a.componentWillMount!="function"||(typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount()),typeof a.componentDidMount=="function"&&(e.flags|=4194308)):(typeof a.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=n,e.memoizedState=l),a.props=n,a.state=l,a.context=c,n=o):(typeof a.componentDidMount=="function"&&(e.flags|=4194308),n=!1)}else{a=e.stateNode,YE(t,e),o=e.memoizedProps,c=e.type===e.elementType?o:Gn(e.type,o),a.props=c,h=e.pendingProps,d=a.context,l=r.contextType,typeof l=="object"&&l!==null?l=Mn(l):(l=cn(r)?Ca:Ur.current,l=Wo(e,l));var p=r.getDerivedStateFromProps;(u=typeof p=="function"||typeof a.getSnapshotBeforeUpdate=="function")||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(o!==h||d!==l)&&gx(e,a,n,l),Es=!1,d=e.memoizedState,a.state=d,uh(e,n,a,i);var x=e.memoizedState;o!==h||d!==x||ln.current||Es?(typeof p=="function"&&(Ap(e,r,p,n),x=e.memoizedState),(c=Es||mx(e,r,c,n,d,x,l)||!1)?(u||typeof a.UNSAFE_componentWillUpdate!="function"&&typeof a.componentWillUpdate!="function"||(typeof a.componentWillUpdate=="function"&&a.componentWillUpdate(n,x,l),typeof a.UNSAFE_componentWillUpdate=="function"&&a.UNSAFE_componentWillUpdate(n,x,l)),typeof a.componentDidUpdate=="function"&&(e.flags|=4),typeof a.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof a.componentDidUpdate!="function"||o===t.memoizedProps&&d===t.memoizedState||(e.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||o===t.memoizedProps&&d===t.memoizedState||(e.flags|=1024),e.memoizedProps=n,e.memoizedState=x),a.props=n,a.state=x,a.context=l,n=c):(typeof a.componentDidUpdate!="function"||o===t.memoizedProps&&d===t.memoizedState||(e.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||o===t.memoizedProps&&d===t.memoizedState||(e.flags|=1024),n=!1)}return Np(t,e,r,n,s,i)}function Np(t,e,r,n,i,s){E2(t,e);var a=(e.flags&128)!==0;if(!n&&!a)return i&&ox(e,r,!1),rs(t,e,s);n=e.stateNode,b4.current=e;var o=a&&typeof r.getDerivedStateFromError!="function"?null:n.render();return e.flags|=1,t!==null&&a?(e.child=Ko(e,t.child,null,s),e.child=Ko(e,null,o,s)):$r(t,e,o,s),e.memoizedState=n.state,i&&ox(e,r,!0),e.child}function T2(t){var e=t.stateNode;e.pendingContext?ax(t,e.pendingContext,e.pendingContext!==e.context):e.context&&ax(t,e.context,!1),sg(t,e.containerInfo)}function Tx(t,e,r,n,i){return Go(),Zm(i),e.flags|=256,$r(t,e,r,n),e.child}var Pp={dehydrated:null,treeContext:null,retryLane:0};function Fp(t){return{baseLanes:t,cachePool:null,transitions:null}}function k2(t,e,r){var n=e.pendingProps,i=Dt.current,s=!1,a=(e.flags&128)!==0,o;if((o=a)||(o=t!==null&&t.memoizedState===null?!1:(i&2)!==0),o?(s=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(i|=1),yt(Dt,i&1),t===null)return kp(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(a=n.children,t=n.fallback,s?(n=e.mode,s=e.child,a={mode:"hidden",children:a},!(n&1)&&s!==null?(s.childLanes=0,s.pendingProps=a):s=f0(a,n,0,null),t=Ta(t,n,r,null),s.return=e,t.return=e,s.sibling=t,e.child=s,e.child.memoizedState=Fp(r),e.memoizedState=Pp,t):dg(e,a));if(i=t.memoizedState,i!==null&&(o=i.dehydrated,o!==null))return O4(t,e,a,n,o,i,r);if(s){s=n.fallback,a=e.mode,i=t.child,o=i.sibling;var l={mode:"hidden",children:n.children};return!(a&1)&&e.child!==i?(n=e.child,n.childLanes=0,n.pendingProps=l,e.deletions=null):(n=zs(i,l),n.subtreeFlags=i.subtreeFlags&14680064),o!==null?s=zs(o,s):(s=Ta(s,a,r,null),s.flags|=2),s.return=e,n.return=e,n.sibling=s,e.child=n,n=s,s=e.child,a=t.child.memoizedState,a=a===null?Fp(r):{baseLanes:a.baseLanes|r,cachePool:null,transitions:a.transitions},s.memoizedState=a,s.childLanes=t.childLanes&~r,e.memoizedState=Pp,n}return s=t.child,t=s.sibling,n=zs(s,{mode:"visible",children:n.children}),!(e.mode&1)&&(n.lanes=r),n.return=e,n.sibling=null,t!==null&&(r=e.deletions,r===null?(e.deletions=[t],e.flags|=16):r.push(t)),e.child=n,e.memoizedState=null,n}function dg(t,e){return e=f0({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function of(t,e,r,n){return n!==null&&Zm(n),Ko(e,t.child,null,r),t=dg(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function O4(t,e,r,n,i,s,a){if(r)return e.flags&256?(e.flags&=-257,n=yd(Error(_e(422))),of(t,e,a,n)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(s=n.fallback,i=e.mode,n=f0({mode:"visible",children:n.children},i,0,null),s=Ta(s,i,a,null),s.flags|=2,n.return=e,s.return=e,n.sibling=s,e.child=n,e.mode&1&&Ko(e,t.child,null,a),e.child.memoizedState=Fp(a),e.memoizedState=Pp,s);if(!(e.mode&1))return of(t,e,a,null);if(i.data==="$!"){if(n=i.nextSibling&&i.nextSibling.dataset,n)var o=n.dgst;return n=o,s=Error(_e(419)),n=yd(s,n,void 0),of(t,e,a,n)}if(o=(a&t.childLanes)!==0,on||o){if(n=fr,n!==null){switch(a&-a){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=i&(n.suspendedLanes|a)?0:i,i!==0&&i!==s.retryLane&&(s.retryLane=i,ts(t,i),ti(n,t,i,-1))}return _g(),n=yd(Error(_e(421))),of(t,e,a,n)}return i.data==="$?"?(e.flags|=128,e.child=t.child,e=q4.bind(null,t),i._reactRetry=e,null):(t=s.treeContext,vn=Vs(i.nextSibling),_n=e,Pt=!0,Xn=null,t!==null&&(Pn[Fn++]=Bi,Pn[Fn++]=zi,Pn[Fn++]=Ra,Bi=t.id,zi=t.overflow,Ra=e),e=dg(e,n.children),e.flags|=4096,e)}function kx(t,e,r){t.lanes|=e;var n=t.alternate;n!==null&&(n.lanes|=e),Sp(t.return,e,r)}function wd(t,e,r,n,i){var s=t.memoizedState;s===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:n,tail:r,tailMode:i}:(s.isBackwards=e,s.rendering=null,s.renderingStartTime=0,s.last=n,s.tail=r,s.tailMode=i)}function S2(t,e,r){var n=e.pendingProps,i=n.revealOrder,s=n.tail;if($r(t,e,n.children,r),n=Dt.current,n&2)n=n&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&kx(t,r,e);else if(t.tag===19)kx(t,r,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}n&=1}if(yt(Dt,n),!(e.mode&1))e.memoizedState=null;else switch(i){case"forwards":for(r=e.child,i=null;r!==null;)t=r.alternate,t!==null&&fh(t)===null&&(i=r),r=r.sibling;r=i,r===null?(i=e.child,e.child=null):(i=r.sibling,r.sibling=null),wd(e,!1,i,r,s);break;case"backwards":for(r=null,i=e.child,e.child=null;i!==null;){if(t=i.alternate,t!==null&&fh(t)===null){e.child=i;break}t=i.sibling,i.sibling=r,r=i,i=t}wd(e,!0,r,null,s);break;case"together":wd(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function Of(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function rs(t,e,r){if(t!==null&&(e.dependencies=t.dependencies),Pa|=e.lanes,!(r&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(_e(153));if(e.child!==null){for(t=e.child,r=zs(t,t.pendingProps),e.child=r,r.return=e;t.sibling!==null;)t=t.sibling,r=r.sibling=zs(t,t.pendingProps),r.return=e;r.sibling=null}return e.child}function L4(t,e,r){switch(e.tag){case 3:T2(e),Go();break;case 5:QE(e);break;case 1:cn(e.type)&&sh(e);break;case 4:sg(e,e.stateNode.containerInfo);break;case 10:var n=e.type._context,i=e.memoizedProps.value;yt(lh,n._currentValue),n._currentValue=i;break;case 13:if(n=e.memoizedState,n!==null)return n.dehydrated!==null?(yt(Dt,Dt.current&1),e.flags|=128,null):r&e.child.childLanes?k2(t,e,r):(yt(Dt,Dt.current&1),t=rs(t,e,r),t!==null?t.sibling:null);yt(Dt,Dt.current&1);break;case 19:if(n=(r&e.childLanes)!==0,t.flags&128){if(n)return S2(t,e,r);e.flags|=128}if(i=e.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),yt(Dt,Dt.current),n)break;return null;case 22:case 23:return e.lanes=0,w2(t,e,r)}return rs(t,e,r)}var A2,Dp,I2,C2;A2=function(t,e){for(var r=e.child;r!==null;){if(r.tag===5||r.tag===6)t.appendChild(r.stateNode);else if(r.tag!==4&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===e)break;for(;r.sibling===null;){if(r.return===null||r.return===e)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};Dp=function(){};I2=function(t,e,r,n){var i=t.memoizedProps;if(i!==n){t=e.stateNode,va(vi.current);var s=null;switch(r){case"input":i=tp(t,i),n=tp(t,n),s=[];break;case"select":i=Ot({},i,{value:void 0}),n=Ot({},n,{value:void 0}),s=[];break;case"textarea":i=ip(t,i),n=ip(t,n),s=[];break;default:typeof i.onClick!="function"&&typeof n.onClick=="function"&&(t.onclick=nh)}ap(r,n);var a;r=null;for(c in i)if(!n.hasOwnProperty(c)&&i.hasOwnProperty(c)&&i[c]!=null)if(c==="style"){var o=i[c];for(a in o)o.hasOwnProperty(a)&&(r||(r={}),r[a]="")}else c!=="dangerouslySetInnerHTML"&&c!=="children"&&c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&c!=="autoFocus"&&(Ac.hasOwnProperty(c)?s||(s=[]):(s=s||[]).push(c,null));for(c in n){var l=n[c];if(o=i!=null?i[c]:void 0,n.hasOwnProperty(c)&&l!==o&&(l!=null||o!=null))if(c==="style")if(o){for(a in o)!o.hasOwnProperty(a)||l&&l.hasOwnProperty(a)||(r||(r={}),r[a]="");for(a in l)l.hasOwnProperty(a)&&o[a]!==l[a]&&(r||(r={}),r[a]=l[a])}else r||(s||(s=[]),s.push(c,r)),r=l;else c==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,o=o?o.__html:void 0,l!=null&&o!==l&&(s=s||[]).push(c,l)):c==="children"?typeof l!="string"&&typeof l!="number"||(s=s||[]).push(c,""+l):c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&(Ac.hasOwnProperty(c)?(l!=null&&c==="onScroll"&&At("scroll",t),s||o===l||(s=[])):(s=s||[]).push(c,l))}r&&(s=s||[]).push("style",r);var c=s;(e.updateQueue=c)&&(e.flags|=4)}};C2=function(t,e,r,n){r!==n&&(e.flags|=4)};function Ll(t,e){if(!Pt)switch(t.tailMode){case"hidden":e=t.tail;for(var r=null;e!==null;)e.alternate!==null&&(r=e),e=e.sibling;r===null?t.tail=null:r.sibling=null;break;case"collapsed":r=t.tail;for(var n=null;r!==null;)r.alternate!==null&&(n=r),r=r.sibling;n===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:n.sibling=null}}function Rr(t){var e=t.alternate!==null&&t.alternate.child===t.child,r=0,n=0;if(e)for(var i=t.child;i!==null;)r|=i.lanes|i.childLanes,n|=i.subtreeFlags&14680064,n|=i.flags&14680064,i.return=t,i=i.sibling;else for(i=t.child;i!==null;)r|=i.lanes|i.childLanes,n|=i.subtreeFlags,n|=i.flags,i.return=t,i=i.sibling;return t.subtreeFlags|=n,t.childLanes=r,e}function M4(t,e,r){var n=e.pendingProps;switch(Jm(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Rr(e),null;case 1:return cn(e.type)&&ih(),Rr(e),null;case 3:return n=e.stateNode,qo(),Ct(ln),Ct(Ur),og(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(t===null||t.child===null)&&(sf(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,Xn!==null&&(Bp(Xn),Xn=null))),Dp(t,e),Rr(e),null;case 5:ag(e);var i=va(Vc.current);if(r=e.type,t!==null&&e.stateNode!=null)I2(t,e,r,n,i),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!n){if(e.stateNode===null)throw Error(_e(166));return Rr(e),null}if(t=va(vi.current),sf(e)){n=e.stateNode,r=e.type;var s=e.memoizedProps;switch(n[pi]=e,n[Lc]=s,t=(e.mode&1)!==0,r){case"dialog":At("cancel",n),At("close",n);break;case"iframe":case"object":case"embed":At("load",n);break;case"video":case"audio":for(i=0;i<Wl.length;i++)At(Wl[i],n);break;case"source":At("error",n);break;case"img":case"image":case"link":At("error",n),At("load",n);break;case"details":At("toggle",n);break;case"input":D1(n,s),At("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!s.multiple},At("invalid",n);break;case"textarea":O1(n,s),At("invalid",n)}ap(r,s),i=null;for(var a in s)if(s.hasOwnProperty(a)){var o=s[a];a==="children"?typeof o=="string"?n.textContent!==o&&(s.suppressHydrationWarning!==!0&&nf(n.textContent,o,t),i=["children",o]):typeof o=="number"&&n.textContent!==""+o&&(s.suppressHydrationWarning!==!0&&nf(n.textContent,o,t),i=["children",""+o]):Ac.hasOwnProperty(a)&&o!=null&&a==="onScroll"&&At("scroll",n)}switch(r){case"input":Xu(n),b1(n,s,!0);break;case"textarea":Xu(n),L1(n);break;case"select":case"option":break;default:typeof s.onClick=="function"&&(n.onclick=nh)}n=i,e.updateQueue=n,n!==null&&(e.flags|=4)}else{a=i.nodeType===9?i:i.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=rE(r)),t==="http://www.w3.org/1999/xhtml"?r==="script"?(t=a.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof n.is=="string"?t=a.createElement(r,{is:n.is}):(t=a.createElement(r),r==="select"&&(a=t,n.multiple?a.multiple=!0:n.size&&(a.size=n.size))):t=a.createElementNS(t,r),t[pi]=e,t[Lc]=n,A2(t,e,!1,!1),e.stateNode=t;e:{switch(a=op(r,n),r){case"dialog":At("cancel",t),At("close",t),i=n;break;case"iframe":case"object":case"embed":At("load",t),i=n;break;case"video":case"audio":for(i=0;i<Wl.length;i++)At(Wl[i],t);i=n;break;case"source":At("error",t),i=n;break;case"img":case"image":case"link":At("error",t),At("load",t),i=n;break;case"details":At("toggle",t),i=n;break;case"input":D1(t,n),i=tp(t,n),At("invalid",t);break;case"option":i=n;break;case"select":t._wrapperState={wasMultiple:!!n.multiple},i=Ot({},n,{value:void 0}),At("invalid",t);break;case"textarea":O1(t,n),i=ip(t,n),At("invalid",t);break;default:i=n}ap(r,i),o=i;for(s in o)if(o.hasOwnProperty(s)){var l=o[s];s==="style"?sE(t,l):s==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&nE(t,l)):s==="children"?typeof l=="string"?(r!=="textarea"||l!=="")&&Ic(t,l):typeof l=="number"&&Ic(t,""+l):s!=="suppressContentEditableWarning"&&s!=="suppressHydrationWarning"&&s!=="autoFocus"&&(Ac.hasOwnProperty(s)?l!=null&&s==="onScroll"&&At("scroll",t):l!=null&&Mm(t,s,l,a))}switch(r){case"input":Xu(t),b1(t,n,!1);break;case"textarea":Xu(t),L1(t);break;case"option":n.value!=null&&t.setAttribute("value",""+Ks(n.value));break;case"select":t.multiple=!!n.multiple,s=n.value,s!=null?Po(t,!!n.multiple,s,!1):n.defaultValue!=null&&Po(t,!!n.multiple,n.defaultValue,!0);break;default:typeof i.onClick=="function"&&(t.onclick=nh)}switch(r){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}}n&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return Rr(e),null;case 6:if(t&&e.stateNode!=null)C2(t,e,t.memoizedProps,n);else{if(typeof n!="string"&&e.stateNode===null)throw Error(_e(166));if(r=va(Vc.current),va(vi.current),sf(e)){if(n=e.stateNode,r=e.memoizedProps,n[pi]=e,(s=n.nodeValue!==r)&&(t=_n,t!==null))switch(t.tag){case 3:nf(n.nodeValue,r,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&nf(n.nodeValue,r,(t.mode&1)!==0)}s&&(e.flags|=4)}else n=(r.nodeType===9?r:r.ownerDocument).createTextNode(n),n[pi]=e,e.stateNode=n}return Rr(e),null;case 13:if(Ct(Dt),n=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(Pt&&vn!==null&&e.mode&1&&!(e.flags&128))GE(),Go(),e.flags|=98560,s=!1;else if(s=sf(e),n!==null&&n.dehydrated!==null){if(t===null){if(!s)throw Error(_e(318));if(s=e.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(_e(317));s[pi]=e}else Go(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;Rr(e),s=!1}else Xn!==null&&(Bp(Xn),Xn=null),s=!0;if(!s)return e.flags&65536?e:null}return e.flags&128?(e.lanes=r,e):(n=n!==null,n!==(t!==null&&t.memoizedState!==null)&&n&&(e.child.flags|=8192,e.mode&1&&(t===null||Dt.current&1?rr===0&&(rr=3):_g())),e.updateQueue!==null&&(e.flags|=4),Rr(e),null);case 4:return qo(),Dp(t,e),t===null&&bc(e.stateNode.containerInfo),Rr(e),null;case 10:return rg(e.type._context),Rr(e),null;case 17:return cn(e.type)&&ih(),Rr(e),null;case 19:if(Ct(Dt),s=e.memoizedState,s===null)return Rr(e),null;if(n=(e.flags&128)!==0,a=s.rendering,a===null)if(n)Ll(s,!1);else{if(rr!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(a=fh(t),a!==null){for(e.flags|=128,Ll(s,!1),n=a.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),e.subtreeFlags=0,n=r,r=e.child;r!==null;)s=r,t=n,s.flags&=14680066,a=s.alternate,a===null?(s.childLanes=0,s.lanes=t,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=a.childLanes,s.lanes=a.lanes,s.child=a.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=a.memoizedProps,s.memoizedState=a.memoizedState,s.updateQueue=a.updateQueue,s.type=a.type,t=a.dependencies,s.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),r=r.sibling;return yt(Dt,Dt.current&1|2),e.child}t=t.sibling}s.tail!==null&&$t()>Yo&&(e.flags|=128,n=!0,Ll(s,!1),e.lanes=4194304)}else{if(!n)if(t=fh(a),t!==null){if(e.flags|=128,n=!0,r=t.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),Ll(s,!0),s.tail===null&&s.tailMode==="hidden"&&!a.alternate&&!Pt)return Rr(e),null}else 2*$t()-s.renderingStartTime>Yo&&r!==1073741824&&(e.flags|=128,n=!0,Ll(s,!1),e.lanes=4194304);s.isBackwards?(a.sibling=e.child,e.child=a):(r=s.last,r!==null?r.sibling=a:e.child=a,s.last=a)}return s.tail!==null?(e=s.tail,s.rendering=e,s.tail=e.sibling,s.renderingStartTime=$t(),e.sibling=null,r=Dt.current,yt(Dt,n?r&1|2:r&1),e):(Rr(e),null);case 22:case 23:return xg(),n=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==n&&(e.flags|=8192),n&&e.mode&1?dn&1073741824&&(Rr(e),e.subtreeFlags&6&&(e.flags|=8192)):Rr(e),null;case 24:return null;case 25:return null}throw Error(_e(156,e.tag))}function V4(t,e){switch(Jm(e),e.tag){case 1:return cn(e.type)&&ih(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return qo(),Ct(ln),Ct(Ur),og(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return ag(e),null;case 13:if(Ct(Dt),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(_e(340));Go()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return Ct(Dt),null;case 4:return qo(),null;case 10:return rg(e.type._context),null;case 22:case 23:return xg(),null;case 24:return null;default:return null}}var lf=!1,br=!1,U4=typeof WeakSet=="function"?WeakSet:Set,Ne=null;function Co(t,e){var r=t.ref;if(r!==null)if(typeof r=="function")try{r(null)}catch(n){Vt(t,e,n)}else r.current=null}function bp(t,e,r){try{r()}catch(n){Vt(t,e,n)}}var Sx=!1;function j4(t,e){if(vp=eh,t=DE(),Ym(t)){if("selectionStart"in t)var r={start:t.selectionStart,end:t.selectionEnd};else e:{r=(r=t.ownerDocument)&&r.defaultView||window;var n=r.getSelection&&r.getSelection();if(n&&n.rangeCount!==0){r=n.anchorNode;var i=n.anchorOffset,s=n.focusNode;n=n.focusOffset;try{r.nodeType,s.nodeType}catch{r=null;break e}var a=0,o=-1,l=-1,c=0,u=0,h=t,d=null;t:for(;;){for(var p;h!==r||i!==0&&h.nodeType!==3||(o=a+i),h!==s||n!==0&&h.nodeType!==3||(l=a+n),h.nodeType===3&&(a+=h.nodeValue.length),(p=h.firstChild)!==null;)d=h,h=p;for(;;){if(h===t)break t;if(d===r&&++c===i&&(o=a),d===s&&++u===n&&(l=a),(p=h.nextSibling)!==null)break;h=d,d=h.parentNode}h=p}r=o===-1||l===-1?null:{start:o,end:l}}else r=null}r=r||{start:0,end:0}}else r=null;for(xp={focusedElem:t,selectionRange:r},eh=!1,Ne=e;Ne!==null;)if(e=Ne,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,Ne=t;else for(;Ne!==null;){e=Ne;try{var x=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(x!==null){var v=x.memoizedProps,E=x.memoizedState,T=e.stateNode,w=T.getSnapshotBeforeUpdate(e.elementType===e.type?v:Gn(e.type,v),E);T.__reactInternalSnapshotBeforeUpdate=w}break;case 3:var y=e.stateNode.containerInfo;y.nodeType===1?y.textContent="":y.nodeType===9&&y.documentElement&&y.removeChild(y.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(_e(163))}}catch(R){Vt(e,e.return,R)}if(t=e.sibling,t!==null){t.return=e.return,Ne=t;break}Ne=e.return}return x=Sx,Sx=!1,x}function lc(t,e,r){var n=e.updateQueue;if(n=n!==null?n.lastEffect:null,n!==null){var i=n=n.next;do{if((i.tag&t)===t){var s=i.destroy;i.destroy=void 0,s!==void 0&&bp(e,r,s)}i=i.next}while(i!==n)}}function c0(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var r=e=e.next;do{if((r.tag&t)===t){var n=r.create;r.destroy=n()}r=r.next}while(r!==e)}}function Op(t){var e=t.ref;if(e!==null){var r=t.stateNode;switch(t.tag){case 5:t=r;break;default:t=r}typeof e=="function"?e(t):e.current=t}}function R2(t){var e=t.alternate;e!==null&&(t.alternate=null,R2(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[pi],delete e[Lc],delete e[wp],delete e[E4],delete e[T4])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function N2(t){return t.tag===5||t.tag===3||t.tag===4}function Ax(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||N2(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function Lp(t,e,r){var n=t.tag;if(n===5||n===6)t=t.stateNode,e?r.nodeType===8?r.parentNode.insertBefore(t,e):r.insertBefore(t,e):(r.nodeType===8?(e=r.parentNode,e.insertBefore(t,r)):(e=r,e.appendChild(t)),r=r._reactRootContainer,r!=null||e.onclick!==null||(e.onclick=nh));else if(n!==4&&(t=t.child,t!==null))for(Lp(t,e,r),t=t.sibling;t!==null;)Lp(t,e,r),t=t.sibling}function Mp(t,e,r){var n=t.tag;if(n===5||n===6)t=t.stateNode,e?r.insertBefore(t,e):r.appendChild(t);else if(n!==4&&(t=t.child,t!==null))for(Mp(t,e,r),t=t.sibling;t!==null;)Mp(t,e,r),t=t.sibling}var mr=null,Kn=!1;function vs(t,e,r){for(r=r.child;r!==null;)P2(t,e,r),r=r.sibling}function P2(t,e,r){if(gi&&typeof gi.onCommitFiberUnmount=="function")try{gi.onCommitFiberUnmount(t0,r)}catch{}switch(r.tag){case 5:br||Co(r,e);case 6:var n=mr,i=Kn;mr=null,vs(t,e,r),mr=n,Kn=i,mr!==null&&(Kn?(t=mr,r=r.stateNode,t.nodeType===8?t.parentNode.removeChild(r):t.removeChild(r)):mr.removeChild(r.stateNode));break;case 18:mr!==null&&(Kn?(t=mr,r=r.stateNode,t.nodeType===8?pd(t.parentNode,r):t.nodeType===1&&pd(t,r),Pc(t)):pd(mr,r.stateNode));break;case 4:n=mr,i=Kn,mr=r.stateNode.containerInfo,Kn=!0,vs(t,e,r),mr=n,Kn=i;break;case 0:case 11:case 14:case 15:if(!br&&(n=r.updateQueue,n!==null&&(n=n.lastEffect,n!==null))){i=n=n.next;do{var s=i,a=s.destroy;s=s.tag,a!==void 0&&(s&2||s&4)&&bp(r,e,a),i=i.next}while(i!==n)}vs(t,e,r);break;case 1:if(!br&&(Co(r,e),n=r.stateNode,typeof n.componentWillUnmount=="function"))try{n.props=r.memoizedProps,n.state=r.memoizedState,n.componentWillUnmount()}catch(o){Vt(r,e,o)}vs(t,e,r);break;case 21:vs(t,e,r);break;case 22:r.mode&1?(br=(n=br)||r.memoizedState!==null,vs(t,e,r),br=n):vs(t,e,r);break;default:vs(t,e,r)}}function Ix(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var r=t.stateNode;r===null&&(r=t.stateNode=new U4),e.forEach(function(n){var i=X4.bind(null,t,n);r.has(n)||(r.add(n),n.then(i,i))})}}function $n(t,e){var r=e.deletions;if(r!==null)for(var n=0;n<r.length;n++){var i=r[n];try{var s=t,a=e,o=a;e:for(;o!==null;){switch(o.tag){case 5:mr=o.stateNode,Kn=!1;break e;case 3:mr=o.stateNode.containerInfo,Kn=!0;break e;case 4:mr=o.stateNode.containerInfo,Kn=!0;break e}o=o.return}if(mr===null)throw Error(_e(160));P2(s,a,i),mr=null,Kn=!1;var l=i.alternate;l!==null&&(l.return=null),i.return=null}catch(c){Vt(i,e,c)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)F2(e,t),e=e.sibling}function F2(t,e){var r=t.alternate,n=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if($n(e,t),ui(t),n&4){try{lc(3,t,t.return),c0(3,t)}catch(v){Vt(t,t.return,v)}try{lc(5,t,t.return)}catch(v){Vt(t,t.return,v)}}break;case 1:$n(e,t),ui(t),n&512&&r!==null&&Co(r,r.return);break;case 5:if($n(e,t),ui(t),n&512&&r!==null&&Co(r,r.return),t.flags&32){var i=t.stateNode;try{Ic(i,"")}catch(v){Vt(t,t.return,v)}}if(n&4&&(i=t.stateNode,i!=null)){var s=t.memoizedProps,a=r!==null?r.memoizedProps:s,o=t.type,l=t.updateQueue;if(t.updateQueue=null,l!==null)try{o==="input"&&s.type==="radio"&&s.name!=null&&eE(i,s),op(o,a);var c=op(o,s);for(a=0;a<l.length;a+=2){var u=l[a],h=l[a+1];u==="style"?sE(i,h):u==="dangerouslySetInnerHTML"?nE(i,h):u==="children"?Ic(i,h):Mm(i,u,h,c)}switch(o){case"input":rp(i,s);break;case"textarea":tE(i,s);break;case"select":var d=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!s.multiple;var p=s.value;p!=null?Po(i,!!s.multiple,p,!1):d!==!!s.multiple&&(s.defaultValue!=null?Po(i,!!s.multiple,s.defaultValue,!0):Po(i,!!s.multiple,s.multiple?[]:"",!1))}i[Lc]=s}catch(v){Vt(t,t.return,v)}}break;case 6:if($n(e,t),ui(t),n&4){if(t.stateNode===null)throw Error(_e(162));i=t.stateNode,s=t.memoizedProps;try{i.nodeValue=s}catch(v){Vt(t,t.return,v)}}break;case 3:if($n(e,t),ui(t),n&4&&r!==null&&r.memoizedState.isDehydrated)try{Pc(e.containerInfo)}catch(v){Vt(t,t.return,v)}break;case 4:$n(e,t),ui(t);break;case 13:$n(e,t),ui(t),i=t.child,i.flags&8192&&(s=i.memoizedState!==null,i.stateNode.isHidden=s,!s||i.alternate!==null&&i.alternate.memoizedState!==null||(gg=$t())),n&4&&Ix(t);break;case 22:if(u=r!==null&&r.memoizedState!==null,t.mode&1?(br=(c=br)||u,$n(e,t),br=c):$n(e,t),ui(t),n&8192){if(c=t.memoizedState!==null,(t.stateNode.isHidden=c)&&!u&&t.mode&1)for(Ne=t,u=t.child;u!==null;){for(h=Ne=u;Ne!==null;){switch(d=Ne,p=d.child,d.tag){case 0:case 11:case 14:case 15:lc(4,d,d.return);break;case 1:Co(d,d.return);var x=d.stateNode;if(typeof x.componentWillUnmount=="function"){n=d,r=d.return;try{e=n,x.props=e.memoizedProps,x.state=e.memoizedState,x.componentWillUnmount()}catch(v){Vt(n,r,v)}}break;case 5:Co(d,d.return);break;case 22:if(d.memoizedState!==null){Rx(h);continue}}p!==null?(p.return=d,Ne=p):Rx(h)}u=u.sibling}e:for(u=null,h=t;;){if(h.tag===5){if(u===null){u=h;try{i=h.stateNode,c?(s=i.style,typeof s.setProperty=="function"?s.setProperty("display","none","important"):s.display="none"):(o=h.stateNode,l=h.memoizedProps.style,a=l!=null&&l.hasOwnProperty("display")?l.display:null,o.style.display=iE("display",a))}catch(v){Vt(t,t.return,v)}}}else if(h.tag===6){if(u===null)try{h.stateNode.nodeValue=c?"":h.memoizedProps}catch(v){Vt(t,t.return,v)}}else if((h.tag!==22&&h.tag!==23||h.memoizedState===null||h===t)&&h.child!==null){h.child.return=h,h=h.child;continue}if(h===t)break e;for(;h.sibling===null;){if(h.return===null||h.return===t)break e;u===h&&(u=null),h=h.return}u===h&&(u=null),h.sibling.return=h.return,h=h.sibling}}break;case 19:$n(e,t),ui(t),n&4&&Ix(t);break;case 21:break;default:$n(e,t),ui(t)}}function ui(t){var e=t.flags;if(e&2){try{e:{for(var r=t.return;r!==null;){if(N2(r)){var n=r;break e}r=r.return}throw Error(_e(160))}switch(n.tag){case 5:var i=n.stateNode;n.flags&32&&(Ic(i,""),n.flags&=-33);var s=Ax(t);Mp(t,s,i);break;case 3:case 4:var a=n.stateNode.containerInfo,o=Ax(t);Lp(t,o,a);break;default:throw Error(_e(161))}}catch(l){Vt(t,t.return,l)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function B4(t,e,r){Ne=t,D2(t)}function D2(t,e,r){for(var n=(t.mode&1)!==0;Ne!==null;){var i=Ne,s=i.child;if(i.tag===22&&n){var a=i.memoizedState!==null||lf;if(!a){var o=i.alternate,l=o!==null&&o.memoizedState!==null||br;o=lf;var c=br;if(lf=a,(br=l)&&!c)for(Ne=i;Ne!==null;)a=Ne,l=a.child,a.tag===22&&a.memoizedState!==null?Nx(i):l!==null?(l.return=a,Ne=l):Nx(i);for(;s!==null;)Ne=s,D2(s),s=s.sibling;Ne=i,lf=o,br=c}Cx(t)}else i.subtreeFlags&8772&&s!==null?(s.return=i,Ne=s):Cx(t)}}function Cx(t){for(;Ne!==null;){var e=Ne;if(e.flags&8772){var r=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:br||c0(5,e);break;case 1:var n=e.stateNode;if(e.flags&4&&!br)if(r===null)n.componentDidMount();else{var i=e.elementType===e.type?r.memoizedProps:Gn(e.type,r.memoizedProps);n.componentDidUpdate(i,r.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var s=e.updateQueue;s!==null&&hx(e,s,n);break;case 3:var a=e.updateQueue;if(a!==null){if(r=null,e.child!==null)switch(e.child.tag){case 5:r=e.child.stateNode;break;case 1:r=e.child.stateNode}hx(e,a,r)}break;case 5:var o=e.stateNode;if(r===null&&e.flags&4){r=o;var l=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&r.focus();break;case"img":l.src&&(r.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var c=e.alternate;if(c!==null){var u=c.memoizedState;if(u!==null){var h=u.dehydrated;h!==null&&Pc(h)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(_e(163))}br||e.flags&512&&Op(e)}catch(d){Vt(e,e.return,d)}}if(e===t){Ne=null;break}if(r=e.sibling,r!==null){r.return=e.return,Ne=r;break}Ne=e.return}}function Rx(t){for(;Ne!==null;){var e=Ne;if(e===t){Ne=null;break}var r=e.sibling;if(r!==null){r.return=e.return,Ne=r;break}Ne=e.return}}function Nx(t){for(;Ne!==null;){var e=Ne;try{switch(e.tag){case 0:case 11:case 15:var r=e.return;try{c0(4,e)}catch(l){Vt(e,r,l)}break;case 1:var n=e.stateNode;if(typeof n.componentDidMount=="function"){var i=e.return;try{n.componentDidMount()}catch(l){Vt(e,i,l)}}var s=e.return;try{Op(e)}catch(l){Vt(e,s,l)}break;case 5:var a=e.return;try{Op(e)}catch(l){Vt(e,a,l)}}}catch(l){Vt(e,e.return,l)}if(e===t){Ne=null;break}var o=e.sibling;if(o!==null){o.return=e.return,Ne=o;break}Ne=e.return}}var z4=Math.ceil,ph=us.ReactCurrentDispatcher,pg=us.ReactCurrentOwner,bn=us.ReactCurrentBatchConfig,st=0,fr=null,Yt=null,_r=0,dn=0,Ro=ra(0),rr=0,zc=null,Pa=0,u0=0,mg=0,cc=null,sn=null,gg=0,Yo=1/0,Ui=null,mh=!1,Vp=null,js=null,cf=!1,Ns=null,gh=0,uc=0,Up=null,Lf=-1,Mf=0;function Kr(){return st&6?$t():Lf!==-1?Lf:Lf=$t()}function Bs(t){return t.mode&1?st&2&&_r!==0?_r&-_r:S4.transition!==null?(Mf===0&&(Mf=vE()),Mf):(t=mt,t!==0||(t=window.event,t=t===void 0?16:kE(t.type)),t):1}function ti(t,e,r,n){if(50<uc)throw uc=0,Up=null,Error(_e(185));fu(t,r,n),(!(st&2)||t!==fr)&&(t===fr&&(!(st&2)&&(u0|=r),rr===4&&ks(t,_r)),un(t,n),r===1&&st===0&&!(e.mode&1)&&(Yo=$t()+500,a0&&na()))}function un(t,e){var r=t.callbackNode;SC(t,e);var n=Zf(t,t===fr?_r:0);if(n===0)r!==null&&U1(r),t.callbackNode=null,t.callbackPriority=0;else if(e=n&-n,t.callbackPriority!==e){if(r!=null&&U1(r),e===1)t.tag===0?k4(Px.bind(null,t)):$E(Px.bind(null,t)),y4(function(){!(st&6)&&na()}),r=null;else{switch(xE(n)){case 1:r=zm;break;case 4:r=mE;break;case 16:r=Jf;break;case 536870912:r=gE;break;default:r=Jf}r=B2(r,b2.bind(null,t))}t.callbackPriority=e,t.callbackNode=r}}function b2(t,e){if(Lf=-1,Mf=0,st&6)throw Error(_e(327));var r=t.callbackNode;if(Lo()&&t.callbackNode!==r)return null;var n=Zf(t,t===fr?_r:0);if(n===0)return null;if(n&30||n&t.expiredLanes||e)e=vh(t,n);else{e=n;var i=st;st|=2;var s=L2();(fr!==t||_r!==e)&&(Ui=null,Yo=$t()+500,Ea(t,e));do try{W4();break}catch(o){O2(t,o)}while(!0);tg(),ph.current=s,st=i,Yt!==null?e=0:(fr=null,_r=0,e=rr)}if(e!==0){if(e===2&&(i=hp(t),i!==0&&(n=i,e=jp(t,i))),e===1)throw r=zc,Ea(t,0),ks(t,n),un(t,$t()),r;if(e===6)ks(t,n);else{if(i=t.current.alternate,!(n&30)&&!$4(i)&&(e=vh(t,n),e===2&&(s=hp(t),s!==0&&(n=s,e=jp(t,s))),e===1))throw r=zc,Ea(t,0),ks(t,n),un(t,$t()),r;switch(t.finishedWork=i,t.finishedLanes=n,e){case 0:case 1:throw Error(_e(345));case 2:ua(t,sn,Ui);break;case 3:if(ks(t,n),(n&130023424)===n&&(e=gg+500-$t(),10<e)){if(Zf(t,0)!==0)break;if(i=t.suspendedLanes,(i&n)!==n){Kr(),t.pingedLanes|=t.suspendedLanes&i;break}t.timeoutHandle=yp(ua.bind(null,t,sn,Ui),e);break}ua(t,sn,Ui);break;case 4:if(ks(t,n),(n&4194240)===n)break;for(e=t.eventTimes,i=-1;0<n;){var a=31-ei(n);s=1<<a,a=e[a],a>i&&(i=a),n&=~s}if(n=i,n=$t()-n,n=(120>n?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*z4(n/1960))-n,10<n){t.timeoutHandle=yp(ua.bind(null,t,sn,Ui),n);break}ua(t,sn,Ui);break;case 5:ua(t,sn,Ui);break;default:throw Error(_e(329))}}}return un(t,$t()),t.callbackNode===r?b2.bind(null,t):null}function jp(t,e){var r=cc;return t.current.memoizedState.isDehydrated&&(Ea(t,e).flags|=256),t=vh(t,e),t!==2&&(e=sn,sn=r,e!==null&&Bp(e)),t}function Bp(t){sn===null?sn=t:sn.push.apply(sn,t)}function $4(t){for(var e=t;;){if(e.flags&16384){var r=e.updateQueue;if(r!==null&&(r=r.stores,r!==null))for(var n=0;n<r.length;n++){var i=r[n],s=i.getSnapshot;i=i.value;try{if(!ii(s(),i))return!1}catch{return!1}}}if(r=e.child,e.subtreeFlags&16384&&r!==null)r.return=e,e=r;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function ks(t,e){for(e&=~mg,e&=~u0,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var r=31-ei(e),n=1<<r;t[r]=-1,e&=~n}}function Px(t){if(st&6)throw Error(_e(327));Lo();var e=Zf(t,0);if(!(e&1))return un(t,$t()),null;var r=vh(t,e);if(t.tag!==0&&r===2){var n=hp(t);n!==0&&(e=n,r=jp(t,n))}if(r===1)throw r=zc,Ea(t,0),ks(t,e),un(t,$t()),r;if(r===6)throw Error(_e(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,ua(t,sn,Ui),un(t,$t()),null}function vg(t,e){var r=st;st|=1;try{return t(e)}finally{st=r,st===0&&(Yo=$t()+500,a0&&na())}}function Fa(t){Ns!==null&&Ns.tag===0&&!(st&6)&&Lo();var e=st;st|=1;var r=bn.transition,n=mt;try{if(bn.transition=null,mt=1,t)return t()}finally{mt=n,bn.transition=r,st=e,!(st&6)&&na()}}function xg(){dn=Ro.current,Ct(Ro)}function Ea(t,e){t.finishedWork=null,t.finishedLanes=0;var r=t.timeoutHandle;if(r!==-1&&(t.timeoutHandle=-1,_4(r)),Yt!==null)for(r=Yt.return;r!==null;){var n=r;switch(Jm(n),n.tag){case 1:n=n.type.childContextTypes,n!=null&&ih();break;case 3:qo(),Ct(ln),Ct(Ur),og();break;case 5:ag(n);break;case 4:qo();break;case 13:Ct(Dt);break;case 19:Ct(Dt);break;case 10:rg(n.type._context);break;case 22:case 23:xg()}r=r.return}if(fr=t,Yt=t=zs(t.current,null),_r=dn=e,rr=0,zc=null,mg=u0=Pa=0,sn=cc=null,ga!==null){for(e=0;e<ga.length;e++)if(r=ga[e],n=r.interleaved,n!==null){r.interleaved=null;var i=n.next,s=r.pending;if(s!==null){var a=s.next;s.next=i,n.next=a}r.pending=n}ga=null}return t}function O2(t,e){do{var r=Yt;try{if(tg(),Df.current=dh,hh){for(var n=bt.memoizedState;n!==null;){var i=n.queue;i!==null&&(i.pending=null),n=n.next}hh=!1}if(Na=0,ur=tr=bt=null,oc=!1,Uc=0,pg.current=null,r===null||r.return===null){rr=1,zc=e,Yt=null;break}e:{var s=t,a=r.return,o=r,l=e;if(e=_r,o.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var c=l,u=o,h=u.tag;if(!(u.mode&1)&&(h===0||h===11||h===15)){var d=u.alternate;d?(u.updateQueue=d.updateQueue,u.memoizedState=d.memoizedState,u.lanes=d.lanes):(u.updateQueue=null,u.memoizedState=null)}var p=xx(a);if(p!==null){p.flags&=-257,_x(p,a,o,s,e),p.mode&1&&vx(s,c,e),e=p,l=c;var x=e.updateQueue;if(x===null){var v=new Set;v.add(l),e.updateQueue=v}else x.add(l);break e}else{if(!(e&1)){vx(s,c,e),_g();break e}l=Error(_e(426))}}else if(Pt&&o.mode&1){var E=xx(a);if(E!==null){!(E.flags&65536)&&(E.flags|=256),_x(E,a,o,s,e),Zm(Xo(l,o));break e}}s=l=Xo(l,o),rr!==4&&(rr=2),cc===null?cc=[s]:cc.push(s),s=a;do{switch(s.tag){case 3:s.flags|=65536,e&=-e,s.lanes|=e;var T=x2(s,l,e);fx(s,T);break e;case 1:o=l;var w=s.type,y=s.stateNode;if(!(s.flags&128)&&(typeof w.getDerivedStateFromError=="function"||y!==null&&typeof y.componentDidCatch=="function"&&(js===null||!js.has(y)))){s.flags|=65536,e&=-e,s.lanes|=e;var R=_2(s,o,e);fx(s,R);break e}}s=s.return}while(s!==null)}V2(r)}catch(M){e=M,Yt===r&&r!==null&&(Yt=r=r.return);continue}break}while(!0)}function L2(){var t=ph.current;return ph.current=dh,t===null?dh:t}function _g(){(rr===0||rr===3||rr===2)&&(rr=4),fr===null||!(Pa&268435455)&&!(u0&268435455)||ks(fr,_r)}function vh(t,e){var r=st;st|=2;var n=L2();(fr!==t||_r!==e)&&(Ui=null,Ea(t,e));do try{H4();break}catch(i){O2(t,i)}while(!0);if(tg(),st=r,ph.current=n,Yt!==null)throw Error(_e(261));return fr=null,_r=0,rr}function H4(){for(;Yt!==null;)M2(Yt)}function W4(){for(;Yt!==null&&!gC();)M2(Yt)}function M2(t){var e=j2(t.alternate,t,dn);t.memoizedProps=t.pendingProps,e===null?V2(t):Yt=e,pg.current=null}function V2(t){var e=t;do{var r=e.alternate;if(t=e.return,e.flags&32768){if(r=V4(r,e),r!==null){r.flags&=32767,Yt=r;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{rr=6,Yt=null;return}}else if(r=M4(r,e,dn),r!==null){Yt=r;return}if(e=e.sibling,e!==null){Yt=e;return}Yt=e=t}while(e!==null);rr===0&&(rr=5)}function ua(t,e,r){var n=mt,i=bn.transition;try{bn.transition=null,mt=1,G4(t,e,r,n)}finally{bn.transition=i,mt=n}return null}function G4(t,e,r,n){do Lo();while(Ns!==null);if(st&6)throw Error(_e(327));r=t.finishedWork;var i=t.finishedLanes;if(r===null)return null;if(t.finishedWork=null,t.finishedLanes=0,r===t.current)throw Error(_e(177));t.callbackNode=null,t.callbackPriority=0;var s=r.lanes|r.childLanes;if(AC(t,s),t===fr&&(Yt=fr=null,_r=0),!(r.subtreeFlags&2064)&&!(r.flags&2064)||cf||(cf=!0,B2(Jf,function(){return Lo(),null})),s=(r.flags&15990)!==0,r.subtreeFlags&15990||s){s=bn.transition,bn.transition=null;var a=mt;mt=1;var o=st;st|=4,pg.current=null,j4(t,r),F2(r,t),h4(xp),eh=!!vp,xp=vp=null,t.current=r,B4(r),vC(),st=o,mt=a,bn.transition=s}else t.current=r;if(cf&&(cf=!1,Ns=t,gh=i),s=t.pendingLanes,s===0&&(js=null),yC(r.stateNode),un(t,$t()),e!==null)for(n=t.onRecoverableError,r=0;r<e.length;r++)i=e[r],n(i.value,{componentStack:i.stack,digest:i.digest});if(mh)throw mh=!1,t=Vp,Vp=null,t;return gh&1&&t.tag!==0&&Lo(),s=t.pendingLanes,s&1?t===Up?uc++:(uc=0,Up=t):uc=0,na(),null}function Lo(){if(Ns!==null){var t=xE(gh),e=bn.transition,r=mt;try{if(bn.transition=null,mt=16>t?16:t,Ns===null)var n=!1;else{if(t=Ns,Ns=null,gh=0,st&6)throw Error(_e(331));var i=st;for(st|=4,Ne=t.current;Ne!==null;){var s=Ne,a=s.child;if(Ne.flags&16){var o=s.deletions;if(o!==null){for(var l=0;l<o.length;l++){var c=o[l];for(Ne=c;Ne!==null;){var u=Ne;switch(u.tag){case 0:case 11:case 15:lc(8,u,s)}var h=u.child;if(h!==null)h.return=u,Ne=h;else for(;Ne!==null;){u=Ne;var d=u.sibling,p=u.return;if(R2(u),u===c){Ne=null;break}if(d!==null){d.return=p,Ne=d;break}Ne=p}}}var x=s.alternate;if(x!==null){var v=x.child;if(v!==null){x.child=null;do{var E=v.sibling;v.sibling=null,v=E}while(v!==null)}}Ne=s}}if(s.subtreeFlags&2064&&a!==null)a.return=s,Ne=a;else e:for(;Ne!==null;){if(s=Ne,s.flags&2048)switch(s.tag){case 0:case 11:case 15:lc(9,s,s.return)}var T=s.sibling;if(T!==null){T.return=s.return,Ne=T;break e}Ne=s.return}}var w=t.current;for(Ne=w;Ne!==null;){a=Ne;var y=a.child;if(a.subtreeFlags&2064&&y!==null)y.return=a,Ne=y;else e:for(a=w;Ne!==null;){if(o=Ne,o.flags&2048)try{switch(o.tag){case 0:case 11:case 15:c0(9,o)}}catch(M){Vt(o,o.return,M)}if(o===a){Ne=null;break e}var R=o.sibling;if(R!==null){R.return=o.return,Ne=R;break e}Ne=o.return}}if(st=i,na(),gi&&typeof gi.onPostCommitFiberRoot=="function")try{gi.onPostCommitFiberRoot(t0,t)}catch{}n=!0}return n}finally{mt=r,bn.transition=e}}return!1}function Fx(t,e,r){e=Xo(r,e),e=x2(t,e,1),t=Us(t,e,1),e=Kr(),t!==null&&(fu(t,1,e),un(t,e))}function Vt(t,e,r){if(t.tag===3)Fx(t,t,r);else for(;e!==null;){if(e.tag===3){Fx(e,t,r);break}else if(e.tag===1){var n=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof n.componentDidCatch=="function"&&(js===null||!js.has(n))){t=Xo(r,t),t=_2(e,t,1),e=Us(e,t,1),t=Kr(),e!==null&&(fu(e,1,t),un(e,t));break}}e=e.return}}function K4(t,e,r){var n=t.pingCache;n!==null&&n.delete(e),e=Kr(),t.pingedLanes|=t.suspendedLanes&r,fr===t&&(_r&r)===r&&(rr===4||rr===3&&(_r&130023424)===_r&&500>$t()-gg?Ea(t,0):mg|=r),un(t,e)}function U2(t,e){e===0&&(t.mode&1?(e=Ju,Ju<<=1,!(Ju&130023424)&&(Ju=4194304)):e=1);var r=Kr();t=ts(t,e),t!==null&&(fu(t,e,r),un(t,r))}function q4(t){var e=t.memoizedState,r=0;e!==null&&(r=e.retryLane),U2(t,r)}function X4(t,e){var r=0;switch(t.tag){case 13:var n=t.stateNode,i=t.memoizedState;i!==null&&(r=i.retryLane);break;case 19:n=t.stateNode;break;default:throw Error(_e(314))}n!==null&&n.delete(e),U2(t,r)}var j2;j2=function(t,e,r){if(t!==null)if(t.memoizedProps!==e.pendingProps||ln.current)on=!0;else{if(!(t.lanes&r)&&!(e.flags&128))return on=!1,L4(t,e,r);on=!!(t.flags&131072)}else on=!1,Pt&&e.flags&1048576&&HE(e,oh,e.index);switch(e.lanes=0,e.tag){case 2:var n=e.type;Of(t,e),t=e.pendingProps;var i=Wo(e,Ur.current);Oo(e,r),i=cg(null,e,n,t,i,r);var s=ug();return e.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,cn(n)?(s=!0,sh(e)):s=!1,e.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,ig(e),i.updater=l0,e.stateNode=i,i._reactInternals=e,Ip(e,n,t,r),e=Np(null,e,n,!0,s,r)):(e.tag=0,Pt&&s&&Qm(e),$r(null,e,i,r),e=e.child),e;case 16:n=e.elementType;e:{switch(Of(t,e),t=e.pendingProps,i=n._init,n=i(n._payload),e.type=n,i=e.tag=Q4(n),t=Gn(n,t),i){case 0:e=Rp(null,e,n,t,r);break e;case 1:e=Ex(null,e,n,t,r);break e;case 11:e=yx(null,e,n,t,r);break e;case 14:e=wx(null,e,n,Gn(n.type,t),r);break e}throw Error(_e(306,n,""))}return e;case 0:return n=e.type,i=e.pendingProps,i=e.elementType===n?i:Gn(n,i),Rp(t,e,n,i,r);case 1:return n=e.type,i=e.pendingProps,i=e.elementType===n?i:Gn(n,i),Ex(t,e,n,i,r);case 3:e:{if(T2(e),t===null)throw Error(_e(387));n=e.pendingProps,s=e.memoizedState,i=s.element,YE(t,e),uh(e,n,null,r);var a=e.memoizedState;if(n=a.element,s.isDehydrated)if(s={element:n,isDehydrated:!1,cache:a.cache,pendingSuspenseBoundaries:a.pendingSuspenseBoundaries,transitions:a.transitions},e.updateQueue.baseState=s,e.memoizedState=s,e.flags&256){i=Xo(Error(_e(423)),e),e=Tx(t,e,n,r,i);break e}else if(n!==i){i=Xo(Error(_e(424)),e),e=Tx(t,e,n,r,i);break e}else for(vn=Vs(e.stateNode.containerInfo.firstChild),_n=e,Pt=!0,Xn=null,r=qE(e,null,n,r),e.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if(Go(),n===i){e=rs(t,e,r);break e}$r(t,e,n,r)}e=e.child}return e;case 5:return QE(e),t===null&&kp(e),n=e.type,i=e.pendingProps,s=t!==null?t.memoizedProps:null,a=i.children,_p(n,i)?a=null:s!==null&&_p(n,s)&&(e.flags|=32),E2(t,e),$r(t,e,a,r),e.child;case 6:return t===null&&kp(e),null;case 13:return k2(t,e,r);case 4:return sg(e,e.stateNode.containerInfo),n=e.pendingProps,t===null?e.child=Ko(e,null,n,r):$r(t,e,n,r),e.child;case 11:return n=e.type,i=e.pendingProps,i=e.elementType===n?i:Gn(n,i),yx(t,e,n,i,r);case 7:return $r(t,e,e.pendingProps,r),e.child;case 8:return $r(t,e,e.pendingProps.children,r),e.child;case 12:return $r(t,e,e.pendingProps.children,r),e.child;case 10:e:{if(n=e.type._context,i=e.pendingProps,s=e.memoizedProps,a=i.value,yt(lh,n._currentValue),n._currentValue=a,s!==null)if(ii(s.value,a)){if(s.children===i.children&&!ln.current){e=rs(t,e,r);break e}}else for(s=e.child,s!==null&&(s.return=e);s!==null;){var o=s.dependencies;if(o!==null){a=s.child;for(var l=o.firstContext;l!==null;){if(l.context===n){if(s.tag===1){l=qi(-1,r&-r),l.tag=2;var c=s.updateQueue;if(c!==null){c=c.shared;var u=c.pending;u===null?l.next=l:(l.next=u.next,u.next=l),c.pending=l}}s.lanes|=r,l=s.alternate,l!==null&&(l.lanes|=r),Sp(s.return,r,e),o.lanes|=r;break}l=l.next}}else if(s.tag===10)a=s.type===e.type?null:s.child;else if(s.tag===18){if(a=s.return,a===null)throw Error(_e(341));a.lanes|=r,o=a.alternate,o!==null&&(o.lanes|=r),Sp(a,r,e),a=s.sibling}else a=s.child;if(a!==null)a.return=s;else for(a=s;a!==null;){if(a===e){a=null;break}if(s=a.sibling,s!==null){s.return=a.return,a=s;break}a=a.return}s=a}$r(t,e,i.children,r),e=e.child}return e;case 9:return i=e.type,n=e.pendingProps.children,Oo(e,r),i=Mn(i),n=n(i),e.flags|=1,$r(t,e,n,r),e.child;case 14:return n=e.type,i=Gn(n,e.pendingProps),i=Gn(n.type,i),wx(t,e,n,i,r);case 15:return y2(t,e,e.type,e.pendingProps,r);case 17:return n=e.type,i=e.pendingProps,i=e.elementType===n?i:Gn(n,i),Of(t,e),e.tag=1,cn(n)?(t=!0,sh(e)):t=!1,Oo(e,r),v2(e,n,i),Ip(e,n,i,r),Np(null,e,n,!0,t,r);case 19:return S2(t,e,r);case 22:return w2(t,e,r)}throw Error(_e(156,e.tag))};function B2(t,e){return pE(t,e)}function Y4(t,e,r,n){this.tag=t,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Dn(t,e,r,n){return new Y4(t,e,r,n)}function yg(t){return t=t.prototype,!(!t||!t.isReactComponent)}function Q4(t){if(typeof t=="function")return yg(t)?1:0;if(t!=null){if(t=t.$$typeof,t===Um)return 11;if(t===jm)return 14}return 2}function zs(t,e){var r=t.alternate;return r===null?(r=Dn(t.tag,e,t.key,t.mode),r.elementType=t.elementType,r.type=t.type,r.stateNode=t.stateNode,r.alternate=t,t.alternate=r):(r.pendingProps=e,r.type=t.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=t.flags&14680064,r.childLanes=t.childLanes,r.lanes=t.lanes,r.child=t.child,r.memoizedProps=t.memoizedProps,r.memoizedState=t.memoizedState,r.updateQueue=t.updateQueue,e=t.dependencies,r.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},r.sibling=t.sibling,r.index=t.index,r.ref=t.ref,r}function Vf(t,e,r,n,i,s){var a=2;if(n=t,typeof t=="function")yg(t)&&(a=1);else if(typeof t=="string")a=5;else e:switch(t){case _o:return Ta(r.children,i,s,e);case Vm:a=8,i|=8;break;case Qd:return t=Dn(12,r,e,i|2),t.elementType=Qd,t.lanes=s,t;case Jd:return t=Dn(13,r,e,i),t.elementType=Jd,t.lanes=s,t;case Zd:return t=Dn(19,r,e,i),t.elementType=Zd,t.lanes=s,t;case Qw:return f0(r,i,s,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case Xw:a=10;break e;case Yw:a=9;break e;case Um:a=11;break e;case jm:a=14;break e;case ws:a=16,n=null;break e}throw Error(_e(130,t==null?t:typeof t,""))}return e=Dn(a,r,e,i),e.elementType=t,e.type=n,e.lanes=s,e}function Ta(t,e,r,n){return t=Dn(7,t,n,e),t.lanes=r,t}function f0(t,e,r,n){return t=Dn(22,t,n,e),t.elementType=Qw,t.lanes=r,t.stateNode={isHidden:!1},t}function Ed(t,e,r){return t=Dn(6,t,null,e),t.lanes=r,t}function Td(t,e,r){return e=Dn(4,t.children!==null?t.children:[],t.key,e),e.lanes=r,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function J4(t,e,r,n,i){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=nd(0),this.expirationTimes=nd(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=nd(0),this.identifierPrefix=n,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function wg(t,e,r,n,i,s,a,o,l){return t=new J4(t,e,r,o,l),e===1?(e=1,s===!0&&(e|=8)):e=0,s=Dn(3,null,null,e),t.current=s,s.stateNode=t,s.memoizedState={element:n,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},ig(s),t}function Z4(t,e,r){var n=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:xo,key:n==null?null:""+n,children:t,containerInfo:e,implementation:r}}function z2(t){if(!t)return qs;t=t._reactInternals;e:{if($a(t)!==t||t.tag!==1)throw Error(_e(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(cn(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(_e(171))}if(t.tag===1){var r=t.type;if(cn(r))return zE(t,r,e)}return e}function $2(t,e,r,n,i,s,a,o,l){return t=wg(r,n,!0,t,i,s,a,o,l),t.context=z2(null),r=t.current,n=Kr(),i=Bs(r),s=qi(n,i),s.callback=e??null,Us(r,s,i),t.current.lanes=i,fu(t,i,n),un(t,n),t}function h0(t,e,r,n){var i=e.current,s=Kr(),a=Bs(i);return r=z2(r),e.context===null?e.context=r:e.pendingContext=r,e=qi(s,a),e.payload={element:t},n=n===void 0?null:n,n!==null&&(e.callback=n),t=Us(i,e,a),t!==null&&(ti(t,i,a,s),Ff(t,i,a)),a}function xh(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function Dx(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var r=t.retryLane;t.retryLane=r!==0&&r<e?r:e}}function Eg(t,e){Dx(t,e),(t=t.alternate)&&Dx(t,e)}function eR(){return null}var H2=typeof reportError=="function"?reportError:function(t){console.error(t)};function Tg(t){this._internalRoot=t}d0.prototype.render=Tg.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(_e(409));h0(t,e,null,null)};d0.prototype.unmount=Tg.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;Fa(function(){h0(null,t,null,null)}),e[es]=null}};function d0(t){this._internalRoot=t}d0.prototype.unstable_scheduleHydration=function(t){if(t){var e=wE();t={blockedOn:null,target:t,priority:e};for(var r=0;r<Ts.length&&e!==0&&e<Ts[r].priority;r++);Ts.splice(r,0,t),r===0&&TE(t)}};function kg(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function p0(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function bx(){}function tR(t,e,r,n,i){if(i){if(typeof n=="function"){var s=n;n=function(){var c=xh(a);s.call(c)}}var a=$2(e,n,t,0,null,!1,!1,"",bx);return t._reactRootContainer=a,t[es]=a.current,bc(t.nodeType===8?t.parentNode:t),Fa(),a}for(;i=t.lastChild;)t.removeChild(i);if(typeof n=="function"){var o=n;n=function(){var c=xh(l);o.call(c)}}var l=wg(t,0,!1,null,null,!1,!1,"",bx);return t._reactRootContainer=l,t[es]=l.current,bc(t.nodeType===8?t.parentNode:t),Fa(function(){h0(e,l,r,n)}),l}function m0(t,e,r,n,i){var s=r._reactRootContainer;if(s){var a=s;if(typeof i=="function"){var o=i;i=function(){var l=xh(a);o.call(l)}}h0(e,a,t,i)}else a=tR(r,e,t,i,n);return xh(a)}_E=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var r=Hl(e.pendingLanes);r!==0&&($m(e,r|1),un(e,$t()),!(st&6)&&(Yo=$t()+500,na()))}break;case 13:Fa(function(){var n=ts(t,1);if(n!==null){var i=Kr();ti(n,t,1,i)}}),Eg(t,1)}};Hm=function(t){if(t.tag===13){var e=ts(t,134217728);if(e!==null){var r=Kr();ti(e,t,134217728,r)}Eg(t,134217728)}};yE=function(t){if(t.tag===13){var e=Bs(t),r=ts(t,e);if(r!==null){var n=Kr();ti(r,t,e,n)}Eg(t,e)}};wE=function(){return mt};EE=function(t,e){var r=mt;try{return mt=t,e()}finally{mt=r}};cp=function(t,e,r){switch(e){case"input":if(rp(t,r),e=r.name,r.type==="radio"&&e!=null){for(r=t;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<r.length;e++){var n=r[e];if(n!==t&&n.form===t.form){var i=s0(n);if(!i)throw Error(_e(90));Zw(n),rp(n,i)}}}break;case"textarea":tE(t,r);break;case"select":e=r.value,e!=null&&Po(t,!!r.multiple,e,!1)}};lE=vg;cE=Fa;var rR={usingClientEntryPoint:!1,Events:[du,To,s0,aE,oE,vg]},Ml={findFiberByHostInstance:ma,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},nR={bundleType:Ml.bundleType,version:Ml.version,rendererPackageName:Ml.rendererPackageName,rendererConfig:Ml.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:us.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=hE(t),t===null?null:t.stateNode},findFiberByHostInstance:Ml.findFiberByHostInstance||eR,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var uf=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!uf.isDisabled&&uf.supportsFiber)try{t0=uf.inject(nR),gi=uf}catch{}}Tn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=rR;Tn.createPortal=function(t,e){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!kg(e))throw Error(_e(200));return Z4(t,e,null,r)};Tn.createRoot=function(t,e){if(!kg(t))throw Error(_e(299));var r=!1,n="",i=H2;return e!=null&&(e.unstable_strictMode===!0&&(r=!0),e.identifierPrefix!==void 0&&(n=e.identifierPrefix),e.onRecoverableError!==void 0&&(i=e.onRecoverableError)),e=wg(t,1,!1,null,null,r,!1,n,i),t[es]=e.current,bc(t.nodeType===8?t.parentNode:t),new Tg(e)};Tn.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(_e(188)):(t=Object.keys(t).join(","),Error(_e(268,t)));return t=hE(e),t=t===null?null:t.stateNode,t};Tn.flushSync=function(t){return Fa(t)};Tn.hydrate=function(t,e,r){if(!p0(e))throw Error(_e(200));return m0(null,t,e,!0,r)};Tn.hydrateRoot=function(t,e,r){if(!kg(t))throw Error(_e(405));var n=r!=null&&r.hydratedSources||null,i=!1,s="",a=H2;if(r!=null&&(r.unstable_strictMode===!0&&(i=!0),r.identifierPrefix!==void 0&&(s=r.identifierPrefix),r.onRecoverableError!==void 0&&(a=r.onRecoverableError)),e=$2(e,null,t,1,r??null,i,!1,s,a),t[es]=e.current,bc(t),n)for(t=0;t<n.length;t++)r=n[t],i=r._getVersion,i=i(r._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[r,i]:e.mutableSourceEagerHydrationData.push(r,i);return new d0(e)};Tn.render=function(t,e,r){if(!p0(e))throw Error(_e(200));return m0(null,t,e,!1,r)};Tn.unmountComponentAtNode=function(t){if(!p0(t))throw Error(_e(40));return t._reactRootContainer?(Fa(function(){m0(null,null,t,!1,function(){t._reactRootContainer=null,t[es]=null})}),!0):!1};Tn.unstable_batchedUpdates=vg;Tn.unstable_renderSubtreeIntoContainer=function(t,e,r,n){if(!p0(r))throw Error(_e(200));if(t==null||t._reactInternals===void 0)throw Error(_e(38));return m0(t,e,r,!1,n)};Tn.version="18.3.1-next-f1338f8080-20240426";function W2(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(W2)}catch(t){console.error(t)}}W2(),Ww.exports=Tn;var Sg=Ww.exports;const iR=Fw(Sg),sR=Pw({__proto__:null,default:iR},[Sg]);var Ox=Sg;Xd.createRoot=Ox.createRoot,Xd.hydrateRoot=Ox.hydrateRoot;/**
 * @remix-run/router v1.23.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Rt(){return Rt=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},Rt.apply(this,arguments)}var Xt;(function(t){t.Pop="POP",t.Push="PUSH",t.Replace="REPLACE"})(Xt||(Xt={}));const Lx="popstate";function aR(t){t===void 0&&(t={});function e(n,i){let{pathname:s,search:a,hash:o}=n.location;return $c("",{pathname:s,search:a,hash:o},i.state&&i.state.usr||null,i.state&&i.state.key||"default")}function r(n,i){return typeof i=="string"?i:Da(i)}return lR(e,r,null,t)}function Ge(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function Qo(t,e){if(!t){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function oR(){return Math.random().toString(36).substr(2,8)}function Mx(t,e){return{usr:t.state,key:t.key,idx:e}}function $c(t,e,r,n){return r===void 0&&(r=null),Rt({pathname:typeof t=="string"?t:t.pathname,search:"",hash:""},typeof e=="string"?ia(e):e,{state:r,key:e&&e.key||n||oR()})}function Da(t){let{pathname:e="/",search:r="",hash:n=""}=t;return r&&r!=="?"&&(e+=r.charAt(0)==="?"?r:"?"+r),n&&n!=="#"&&(e+=n.charAt(0)==="#"?n:"#"+n),e}function ia(t){let e={};if(t){let r=t.indexOf("#");r>=0&&(e.hash=t.substr(r),t=t.substr(0,r));let n=t.indexOf("?");n>=0&&(e.search=t.substr(n),t=t.substr(0,n)),t&&(e.pathname=t)}return e}function lR(t,e,r,n){n===void 0&&(n={});let{window:i=document.defaultView,v5Compat:s=!1}=n,a=i.history,o=Xt.Pop,l=null,c=u();c==null&&(c=0,a.replaceState(Rt({},a.state,{idx:c}),""));function u(){return(a.state||{idx:null}).idx}function h(){o=Xt.Pop;let E=u(),T=E==null?null:E-c;c=E,l&&l({action:o,location:v.location,delta:T})}function d(E,T){o=Xt.Push;let w=$c(v.location,E,T);c=u()+1;let y=Mx(w,c),R=v.createHref(w);try{a.pushState(y,"",R)}catch(M){if(M instanceof DOMException&&M.name==="DataCloneError")throw M;i.location.assign(R)}s&&l&&l({action:o,location:v.location,delta:1})}function p(E,T){o=Xt.Replace;let w=$c(v.location,E,T);c=u();let y=Mx(w,c),R=v.createHref(w);a.replaceState(y,"",R),s&&l&&l({action:o,location:v.location,delta:0})}function x(E){let T=i.location.origin!=="null"?i.location.origin:i.location.href,w=typeof E=="string"?E:Da(E);return w=w.replace(/ $/,"%20"),Ge(T,"No window.location.(origin|href) available to create URL for href: "+w),new URL(w,T)}let v={get action(){return o},get location(){return t(i,a)},listen(E){if(l)throw new Error("A history only accepts one active listener");return i.addEventListener(Lx,h),l=E,()=>{i.removeEventListener(Lx,h),l=null}},createHref(E){return e(i,E)},createURL:x,encodeLocation(E){let T=x(E);return{pathname:T.pathname,search:T.search,hash:T.hash}},push:d,replace:p,go(E){return a.go(E)}};return v}var pt;(function(t){t.data="data",t.deferred="deferred",t.redirect="redirect",t.error="error"})(pt||(pt={}));const cR=new Set(["lazy","caseSensitive","path","id","index","children"]);function uR(t){return t.index===!0}function _h(t,e,r,n){return r===void 0&&(r=[]),n===void 0&&(n={}),t.map((i,s)=>{let a=[...r,String(s)],o=typeof i.id=="string"?i.id:a.join("-");if(Ge(i.index!==!0||!i.children,"Cannot specify children on an index route"),Ge(!n[o],'Found a route id collision on id "'+o+`".  Route id's must be globally unique within Data Router usages`),uR(i)){let l=Rt({},i,e(i),{id:o});return n[o]=l,l}else{let l=Rt({},i,e(i),{id:o,children:void 0});return n[o]=l,i.children&&(l.children=_h(i.children,e,a,n)),l}})}function ha(t,e,r){return r===void 0&&(r="/"),Uf(t,e,r,!1)}function Uf(t,e,r,n){let i=typeof e=="string"?ia(e):e,s=ns(i.pathname||"/",r);if(s==null)return null;let a=G2(t);hR(a);let o=null;for(let l=0;o==null&&l<a.length;++l){let c=TR(s);o=wR(a[l],c,n)}return o}function fR(t,e){let{route:r,pathname:n,params:i}=t;return{id:r.id,pathname:n,params:i,data:e[r.id],handle:r.handle}}function G2(t,e,r,n){e===void 0&&(e=[]),r===void 0&&(r=[]),n===void 0&&(n="");let i=(s,a,o)=>{let l={relativePath:o===void 0?s.path||"":o,caseSensitive:s.caseSensitive===!0,childrenIndex:a,route:s};l.relativePath.startsWith("/")&&(Ge(l.relativePath.startsWith(n),'Absolute route path "'+l.relativePath+'" nested under path '+('"'+n+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),l.relativePath=l.relativePath.slice(n.length));let c=Xi([n,l.relativePath]),u=r.concat(l);s.children&&s.children.length>0&&(Ge(s.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+c+'".')),G2(s.children,e,u,c)),!(s.path==null&&!s.index)&&e.push({path:c,score:_R(c,s.index),routesMeta:u})};return t.forEach((s,a)=>{var o;if(s.path===""||!((o=s.path)!=null&&o.includes("?")))i(s,a);else for(let l of K2(s.path))i(s,a,l)}),e}function K2(t){let e=t.split("/");if(e.length===0)return[];let[r,...n]=e,i=r.endsWith("?"),s=r.replace(/\?$/,"");if(n.length===0)return i?[s,""]:[s];let a=K2(n.join("/")),o=[];return o.push(...a.map(l=>l===""?s:[s,l].join("/"))),i&&o.push(...a),o.map(l=>t.startsWith("/")&&l===""?"/":l)}function hR(t){t.sort((e,r)=>e.score!==r.score?r.score-e.score:yR(e.routesMeta.map(n=>n.childrenIndex),r.routesMeta.map(n=>n.childrenIndex)))}const dR=/^:[\w-]+$/,pR=3,mR=2,gR=1,vR=10,xR=-2,Vx=t=>t==="*";function _R(t,e){let r=t.split("/"),n=r.length;return r.some(Vx)&&(n+=xR),e&&(n+=mR),r.filter(i=>!Vx(i)).reduce((i,s)=>i+(dR.test(s)?pR:s===""?gR:vR),n)}function yR(t,e){return t.length===e.length&&t.slice(0,-1).every((n,i)=>n===e[i])?t[t.length-1]-e[e.length-1]:0}function wR(t,e,r){r===void 0&&(r=!1);let{routesMeta:n}=t,i={},s="/",a=[];for(let o=0;o<n.length;++o){let l=n[o],c=o===n.length-1,u=s==="/"?e:e.slice(s.length)||"/",h=yh({path:l.relativePath,caseSensitive:l.caseSensitive,end:c},u),d=l.route;if(!h&&c&&r&&!n[n.length-1].route.index&&(h=yh({path:l.relativePath,caseSensitive:l.caseSensitive,end:!1},u)),!h)return null;Object.assign(i,h.params),a.push({params:i,pathname:Xi([s,h.pathname]),pathnameBase:AR(Xi([s,h.pathnameBase])),route:d}),h.pathnameBase!=="/"&&(s=Xi([s,h.pathnameBase]))}return a}function yh(t,e){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[r,n]=ER(t.path,t.caseSensitive,t.end),i=e.match(r);if(!i)return null;let s=i[0],a=s.replace(/(.)\/+$/,"$1"),o=i.slice(1);return{params:n.reduce((c,u,h)=>{let{paramName:d,isOptional:p}=u;if(d==="*"){let v=o[h]||"";a=s.slice(0,s.length-v.length).replace(/(.)\/+$/,"$1")}const x=o[h];return p&&!x?c[d]=void 0:c[d]=(x||"").replace(/%2F/g,"/"),c},{}),pathname:s,pathnameBase:a,pattern:t}}function ER(t,e,r){e===void 0&&(e=!1),r===void 0&&(r=!0),Qo(t==="*"||!t.endsWith("*")||t.endsWith("/*"),'Route path "'+t+'" will be treated as if it were '+('"'+t.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+t.replace(/\*$/,"/*")+'".'));let n=[],i="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(a,o,l)=>(n.push({paramName:o,isOptional:l!=null}),l?"/?([^\\/]+)?":"/([^\\/]+)"));return t.endsWith("*")?(n.push({paramName:"*"}),i+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):r?i+="\\/*$":t!==""&&t!=="/"&&(i+="(?:(?=\\/|$))"),[new RegExp(i,e?void 0:"i"),n]}function TR(t){try{return t.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return Qo(!1,'The URL path "'+t+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+e+").")),t}}function ns(t,e){if(e==="/")return t;if(!t.toLowerCase().startsWith(e.toLowerCase()))return null;let r=e.endsWith("/")?e.length-1:e.length,n=t.charAt(r);return n&&n!=="/"?null:t.slice(r)||"/"}function kR(t,e){e===void 0&&(e="/");let{pathname:r,search:n="",hash:i=""}=typeof t=="string"?ia(t):t;return{pathname:r?r.startsWith("/")?r:SR(r,e):e,search:IR(n),hash:CR(i)}}function SR(t,e){let r=e.replace(/\/+$/,"").split("/");return t.split("/").forEach(i=>{i===".."?r.length>1&&r.pop():i!=="."&&r.push(i)}),r.length>1?r.join("/"):"/"}function kd(t,e,r,n){return"Cannot include a '"+t+"' character in a manually specified "+("`to."+e+"` field ["+JSON.stringify(n)+"].  Please separate it out to the ")+("`to."+r+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function q2(t){return t.filter((e,r)=>r===0||e.route.path&&e.route.path.length>0)}function g0(t,e){let r=q2(t);return e?r.map((n,i)=>i===r.length-1?n.pathname:n.pathnameBase):r.map(n=>n.pathnameBase)}function v0(t,e,r,n){n===void 0&&(n=!1);let i;typeof t=="string"?i=ia(t):(i=Rt({},t),Ge(!i.pathname||!i.pathname.includes("?"),kd("?","pathname","search",i)),Ge(!i.pathname||!i.pathname.includes("#"),kd("#","pathname","hash",i)),Ge(!i.search||!i.search.includes("#"),kd("#","search","hash",i)));let s=t===""||i.pathname==="",a=s?"/":i.pathname,o;if(a==null)o=r;else{let h=e.length-1;if(!n&&a.startsWith("..")){let d=a.split("/");for(;d[0]==="..";)d.shift(),h-=1;i.pathname=d.join("/")}o=h>=0?e[h]:"/"}let l=kR(i,o),c=a&&a!=="/"&&a.endsWith("/"),u=(s||a===".")&&r.endsWith("/");return!l.pathname.endsWith("/")&&(c||u)&&(l.pathname+="/"),l}const Xi=t=>t.join("/").replace(/\/\/+/g,"/"),AR=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),IR=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,CR=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t;class wh{constructor(e,r,n,i){i===void 0&&(i=!1),this.status=e,this.statusText=r||"",this.internal=i,n instanceof Error?(this.data=n.toString(),this.error=n):this.data=n}}function Hc(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}const X2=["post","put","patch","delete"],RR=new Set(X2),NR=["get",...X2],PR=new Set(NR),FR=new Set([301,302,303,307,308]),DR=new Set([307,308]),Sd={state:"idle",location:void 0,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0},bR={state:"idle",data:void 0,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0},Vl={state:"unblocked",proceed:void 0,reset:void 0,location:void 0},Ag=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,OR=t=>({hasErrorBoundary:!!t.hasErrorBoundary}),Y2="remix-router-transitions";function LR(t){const e=t.window?t.window:typeof window<"u"?window:void 0,r=typeof e<"u"&&typeof e.document<"u"&&typeof e.document.createElement<"u",n=!r;Ge(t.routes.length>0,"You must provide a non-empty routes array to createRouter");let i;if(t.mapRouteProperties)i=t.mapRouteProperties;else if(t.detectErrorBoundary){let H=t.detectErrorBoundary;i=Q=>({hasErrorBoundary:H(Q)})}else i=OR;let s={},a=_h(t.routes,i,void 0,s),o,l=t.basename||"/",c=t.dataStrategy||jR,u=t.patchRoutesOnNavigation,h=Rt({v7_fetcherPersist:!1,v7_normalizeFormMethod:!1,v7_partialHydration:!1,v7_prependBasename:!1,v7_relativeSplatPath:!1,v7_skipActionErrorRevalidation:!1},t.future),d=null,p=new Set,x=null,v=null,E=null,T=t.hydrationData!=null,w=ha(a,t.history.location,l),y=!1,R=null;if(w==null&&!u){let H=rn(404,{pathname:t.history.location.pathname}),{matches:Q,route:ne}=Xx(a);w=Q,R={[ne.id]:H}}w&&!t.hydrationData&&Li(w,a,t.history.location.pathname).active&&(w=null);let M;if(w)if(w.some(H=>H.route.lazy))M=!1;else if(!w.some(H=>H.route.loader))M=!0;else if(h.v7_partialHydration){let H=t.hydrationData?t.hydrationData.loaderData:null,Q=t.hydrationData?t.hydrationData.errors:null;if(Q){let ne=w.findIndex(de=>Q[de.route.id]!==void 0);M=w.slice(0,ne+1).every(de=>!$p(de.route,H,Q))}else M=w.every(ne=>!$p(ne.route,H,Q))}else M=t.hydrationData!=null;else if(M=!1,w=[],h.v7_partialHydration){let H=Li(null,a,t.history.location.pathname);H.active&&H.matches&&(y=!0,w=H.matches)}let j,g={historyAction:t.history.action,location:t.history.location,matches:w,initialized:M,navigation:Sd,restoreScrollPosition:t.hydrationData!=null?!1:null,preventScrollReset:!1,revalidation:"idle",loaderData:t.hydrationData&&t.hydrationData.loaderData||{},actionData:t.hydrationData&&t.hydrationData.actionData||null,errors:t.hydrationData&&t.hydrationData.errors||R,fetchers:new Map,blockers:new Map},k=Xt.Pop,S=!1,C,F=!1,P=new Map,b=null,ve=!1,he=!1,Se=[],oe=new Set,ie=new Map,G=0,ue=-1,Ee=new Map,B=new Set,X=new Map,K=new Map,W=new Set,ae=new Map,xe=new Map,ke;function fe(){if(d=t.history.listen(H=>{let{action:Q,location:ne,delta:de}=H;if(ke){ke(),ke=void 0;return}Qo(xe.size===0||de!=null,"You are trying to use a blocker on a POP navigation to a location that was not created by @remix-run/router. This will fail silently in production. This can happen if you are navigating outside the router via `window.history.pushState`/`window.location.hash` instead of using router navigation APIs.  This can also happen if you are using createHashRouter and the user manually changes the URL.");let Ae=ps({currentLocation:g.location,nextLocation:ne,historyAction:Q});if(Ae&&de!=null){let I=new Promise(V=>{ke=V});t.history.go(de*-1),oi(Ae,{state:"blocked",location:ne,proceed(){oi(Ae,{state:"proceeding",proceed:void 0,reset:void 0,location:ne}),I.then(()=>t.history.go(de))},reset(){let V=new Map(g.blockers);V.set(Ae,Vl),z({blockers:V})}});return}return be(Q,ne)}),r){eN(e,P);let H=()=>tN(e,P);e.addEventListener("pagehide",H),b=()=>e.removeEventListener("pagehide",H)}return g.initialized||be(Xt.Pop,g.location,{initialHydration:!0}),j}function pe(){d&&d(),b&&b(),p.clear(),C&&C.abort(),g.fetchers.forEach((H,Q)=>xt(Q)),g.blockers.forEach((H,Q)=>Di(Q))}function $e(H){return p.add(H),()=>p.delete(H)}function z(H,Q){Q===void 0&&(Q={}),g=Rt({},g,H);let ne=[],de=[];h.v7_fetcherPersist&&g.fetchers.forEach((Ae,I)=>{Ae.state==="idle"&&(W.has(I)?de.push(I):ne.push(I))}),W.forEach(Ae=>{!g.fetchers.has(Ae)&&!ie.has(Ae)&&de.push(Ae)}),[...p].forEach(Ae=>Ae(g,{deletedFetchers:de,viewTransitionOpts:Q.viewTransitionOpts,flushSync:Q.flushSync===!0})),h.v7_fetcherPersist?(ne.forEach(Ae=>g.fetchers.delete(Ae)),de.forEach(Ae=>xt(Ae))):de.forEach(Ae=>W.delete(Ae))}function ot(H,Q,ne){var de,Ae;let{flushSync:I}=ne===void 0?{}:ne,V=g.actionData!=null&&g.navigation.formMethod!=null&&qn(g.navigation.formMethod)&&g.navigation.state==="loading"&&((de=H.state)==null?void 0:de._isRedirect)!==!0,N;Q.actionData?Object.keys(Q.actionData).length>0?N=Q.actionData:N=null:V?N=g.actionData:N=null;let D=Q.loaderData?Kx(g.loaderData,Q.loaderData,Q.matches||[],Q.errors):g.loaderData,O=g.blockers;O.size>0&&(O=new Map(O),O.forEach((te,ee)=>O.set(ee,Vl)));let L=S===!0||g.navigation.formMethod!=null&&qn(g.navigation.formMethod)&&((Ae=H.state)==null?void 0:Ae._isRedirect)!==!0;o&&(a=o,o=void 0),ve||k===Xt.Pop||(k===Xt.Push?t.history.push(H,H.state):k===Xt.Replace&&t.history.replace(H,H.state));let q;if(k===Xt.Pop){let te=P.get(g.location.pathname);te&&te.has(H.pathname)?q={currentLocation:g.location,nextLocation:H}:P.has(H.pathname)&&(q={currentLocation:H,nextLocation:g.location})}else if(F){let te=P.get(g.location.pathname);te?te.add(H.pathname):(te=new Set([H.pathname]),P.set(g.location.pathname,te)),q={currentLocation:g.location,nextLocation:H}}z(Rt({},Q,{actionData:N,loaderData:D,historyAction:k,location:H,initialized:!0,navigation:Sd,revalidation:"idle",restoreScrollPosition:Oi(H,Q.matches||g.matches),preventScrollReset:L,blockers:O}),{viewTransitionOpts:q,flushSync:I===!0}),k=Xt.Pop,S=!1,F=!1,ve=!1,he=!1,Se=[]}async function We(H,Q){if(typeof H=="number"){t.history.go(H);return}let ne=zp(g.location,g.matches,l,h.v7_prependBasename,H,h.v7_relativeSplatPath,Q==null?void 0:Q.fromRouteId,Q==null?void 0:Q.relative),{path:de,submission:Ae,error:I}=Ux(h.v7_normalizeFormMethod,!1,ne,Q),V=g.location,N=$c(g.location,de,Q&&Q.state);N=Rt({},N,t.history.encodeLocation(N));let D=Q&&Q.replace!=null?Q.replace:void 0,O=Xt.Push;D===!0?O=Xt.Replace:D===!1||Ae!=null&&qn(Ae.formMethod)&&Ae.formAction===g.location.pathname+g.location.search&&(O=Xt.Replace);let L=Q&&"preventScrollReset"in Q?Q.preventScrollReset===!0:void 0,q=(Q&&Q.flushSync)===!0,te=ps({currentLocation:V,nextLocation:N,historyAction:O});if(te){oi(te,{state:"blocked",location:N,proceed(){oi(te,{state:"proceeding",proceed:void 0,reset:void 0,location:N}),We(H,Q)},reset(){let ee=new Map(g.blockers);ee.set(te,Vl),z({blockers:ee})}});return}return await be(O,N,{submission:Ae,pendingError:I,preventScrollReset:L,replace:Q&&Q.replace,enableViewTransition:Q&&Q.viewTransition,flushSync:q})}function nt(){if(kt(),z({revalidation:"loading"}),g.navigation.state!=="submitting"){if(g.navigation.state==="idle"){be(g.historyAction,g.location,{startUninterruptedRevalidation:!0});return}be(k||g.historyAction,g.navigation.location,{overrideNavigation:g.navigation,enableViewTransition:F===!0})}}async function be(H,Q,ne){C&&C.abort(),C=null,k=H,ve=(ne&&ne.startUninterruptedRevalidation)===!0,io(g.location,g.matches),S=(ne&&ne.preventScrollReset)===!0,F=(ne&&ne.enableViewTransition)===!0;let de=o||a,Ae=ne&&ne.overrideNavigation,I=ne!=null&&ne.initialHydration&&g.matches&&g.matches.length>0&&!y?g.matches:ha(de,Q,l),V=(ne&&ne.flushSync)===!0;if(I&&g.initialized&&!he&&GR(g.location,Q)&&!(ne&&ne.submission&&qn(ne.submission.formMethod))){ot(Q,{matches:I},{flushSync:V});return}let N=Li(I,de,Q.pathname);if(N.active&&N.matches&&(I=N.matches),!I){let{error:J,notFoundMatches:Y,route:le}=Bn(Q.pathname);ot(Q,{matches:Y,loaderData:{},errors:{[le.id]:J}},{flushSync:V});return}C=new AbortController;let D=uo(t.history,Q,C.signal,ne&&ne.submission),O;if(ne&&ne.pendingError)O=[da(I).route.id,{type:pt.error,error:ne.pendingError}];else if(ne&&ne.submission&&qn(ne.submission.formMethod)){let J=await Ie(D,Q,ne.submission,I,N.active,{replace:ne.replace,flushSync:V});if(J.shortCircuited)return;if(J.pendingActionResult){let[Y,le]=J.pendingActionResult;if(pn(le)&&Hc(le.error)&&le.error.status===404){C=null,ot(Q,{matches:J.matches,loaderData:{},errors:{[Y]:le.error}});return}}I=J.matches||I,O=J.pendingActionResult,Ae=Ad(Q,ne.submission),V=!1,N.active=!1,D=uo(t.history,D.url,D.signal)}let{shortCircuited:L,matches:q,loaderData:te,errors:ee}=await Et(D,Q,I,N.active,Ae,ne&&ne.submission,ne&&ne.fetcherSubmission,ne&&ne.replace,ne&&ne.initialHydration===!0,V,O);L||(C=null,ot(Q,Rt({matches:q||I},qx(O),{loaderData:te,errors:ee})))}async function Ie(H,Q,ne,de,Ae,I){I===void 0&&(I={}),kt();let V=JR(Q,ne);if(z({navigation:V},{flushSync:I.flushSync===!0}),Ae){let O=await An(de,Q.pathname,H.signal);if(O.type==="aborted")return{shortCircuited:!0};if(O.type==="error"){let L=da(O.partialMatches).route.id;return{matches:O.partialMatches,pendingActionResult:[L,{type:pt.error,error:O.error}]}}else if(O.matches)de=O.matches;else{let{notFoundMatches:L,error:q,route:te}=Bn(Q.pathname);return{matches:L,pendingActionResult:[te.id,{type:pt.error,error:q}]}}}let N,D=Gl(de,Q);if(!D.route.action&&!D.route.lazy)N={type:pt.error,error:rn(405,{method:H.method,pathname:Q.pathname,routeId:D.route.id})};else if(N=(await or("action",g,H,[D],de,null))[D.route.id],H.signal.aborted)return{shortCircuited:!0};if(xa(N)){let O;return I&&I.replace!=null?O=I.replace:O=Hx(N.response.headers.get("Location"),new URL(H.url),l)===g.location.pathname+g.location.search,await Tt(H,N,!0,{submission:ne,replace:O}),{shortCircuited:!0}}if(Ps(N))throw rn(400,{type:"defer-action"});if(pn(N)){let O=da(de,D.route.id);return(I&&I.replace)!==!0&&(k=Xt.Push),{matches:de,pendingActionResult:[O.route.id,N]}}return{matches:de,pendingActionResult:[D.route.id,N]}}async function Et(H,Q,ne,de,Ae,I,V,N,D,O,L){let q=Ae||Ad(Q,I),te=I||V||Qx(q),ee=!ve&&(!h.v7_partialHydration||!D);if(de){if(ee){let ft=ar(L);z(Rt({navigation:q},ft!==void 0?{actionData:ft}:{}),{flushSync:O})}let He=await An(ne,Q.pathname,H.signal);if(He.type==="aborted")return{shortCircuited:!0};if(He.type==="error"){let ft=da(He.partialMatches).route.id;return{matches:He.partialMatches,loaderData:{},errors:{[ft]:He.error}}}else if(He.matches)ne=He.matches;else{let{error:ft,notFoundMatches:dr,route:In}=Bn(Q.pathname);return{matches:dr,loaderData:{},errors:{[In.id]:ft}}}}let J=o||a,[Y,le]=Bx(t.history,g,ne,te,Q,h.v7_partialHydration&&D===!0,h.v7_skipActionErrorRevalidation,he,Se,oe,W,X,B,J,l,L);if(bi(He=>!(ne&&ne.some(ft=>ft.route.id===He))||Y&&Y.some(ft=>ft.route.id===He)),ue=++G,Y.length===0&&le.length===0){let He=Fi();return ot(Q,Rt({matches:ne,loaderData:{},errors:L&&pn(L[1])?{[L[0]]:L[1].error}:null},qx(L),He?{fetchers:new Map(g.fetchers)}:{}),{flushSync:O}),{shortCircuited:!0}}if(ee){let He={};if(!de){He.navigation=q;let ft=ar(L);ft!==void 0&&(He.actionData=ft)}le.length>0&&(He.fetchers=Sr(le)),z(He,{flushSync:O})}le.forEach(He=>{ut(He.key),He.controller&&ie.set(He.key,He.controller)});let ye=()=>le.forEach(He=>ut(He.key));C&&C.signal.addEventListener("abort",ye);let{loaderResults:Ce,fetcherResults:me}=await vt(g,ne,Y,le,H);if(H.signal.aborted)return{shortCircuited:!0};C&&C.signal.removeEventListener("abort",ye),le.forEach(He=>ie.delete(He.key));let we=ff(Ce);if(we)return await Tt(H,we.result,!0,{replace:N}),{shortCircuited:!0};if(we=ff(me),we)return B.add(we.key),await Tt(H,we.result,!0,{replace:N}),{shortCircuited:!0};let{loaderData:De,errors:it}=Gx(g,ne,Ce,L,le,me,ae);ae.forEach((He,ft)=>{He.subscribe(dr=>{(dr||He.done)&&ae.delete(ft)})}),h.v7_partialHydration&&D&&g.errors&&(it=Rt({},g.errors,it));let Ke=Fi(),dt=no(ue),tn=Ke||dt||le.length>0;return Rt({matches:ne,loaderData:De,errors:it},tn?{fetchers:new Map(g.fetchers)}:{})}function ar(H){if(H&&!pn(H[1]))return{[H[0]]:H[1].data};if(g.actionData)return Object.keys(g.actionData).length===0?null:g.actionData}function Sr(H){return H.forEach(Q=>{let ne=g.fetchers.get(Q.key),de=Ul(void 0,ne?ne.data:void 0);g.fetchers.set(Q.key,de)}),new Map(g.fetchers)}function Zr(H,Q,ne,de){if(n)throw new Error("router.fetch() was called during the server render, but it shouldn't be. You are likely calling a useFetcher() method in the body of your component. Try moving it to a useEffect or a callback.");ut(H);let Ae=(de&&de.flushSync)===!0,I=o||a,V=zp(g.location,g.matches,l,h.v7_prependBasename,ne,h.v7_relativeSplatPath,Q,de==null?void 0:de.relative),N=ha(I,V,l),D=Li(N,I,V);if(D.active&&D.matches&&(N=D.matches),!N){Ft(H,Q,rn(404,{pathname:V}),{flushSync:Ae});return}let{path:O,submission:L,error:q}=Ux(h.v7_normalizeFormMethod,!0,V,de);if(q){Ft(H,Q,q,{flushSync:Ae});return}let te=Gl(N,O),ee=(de&&de.preventScrollReset)===!0;if(L&&qn(L.formMethod)){Pi(H,Q,O,te,N,D.active,Ae,ee,L);return}X.set(H,{routeId:Q,path:O}),en(H,Q,O,te,N,D.active,Ae,ee,L)}async function Pi(H,Q,ne,de,Ae,I,V,N,D){kt(),X.delete(H);function O(Ze){if(!Ze.route.action&&!Ze.route.lazy){let ci=rn(405,{method:D.formMethod,pathname:ne,routeId:Q});return Ft(H,Q,ci,{flushSync:V}),!0}return!1}if(!I&&O(de))return;let L=g.fetchers.get(H);ht(H,ZR(D,L),{flushSync:V});let q=new AbortController,te=uo(t.history,ne,q.signal,D);if(I){let Ze=await An(Ae,new URL(te.url).pathname,te.signal,H);if(Ze.type==="aborted")return;if(Ze.type==="error"){Ft(H,Q,Ze.error,{flushSync:V});return}else if(Ze.matches){if(Ae=Ze.matches,de=Gl(Ae,ne),O(de))return}else{Ft(H,Q,rn(404,{pathname:ne}),{flushSync:V});return}}ie.set(H,q);let ee=G,Y=(await or("action",g,te,[de],Ae,H))[de.route.id];if(te.signal.aborted){ie.get(H)===q&&ie.delete(H);return}if(h.v7_fetcherPersist&&W.has(H)){if(xa(Y)||pn(Y)){ht(H,ys(void 0));return}}else{if(xa(Y))if(ie.delete(H),ue>ee){ht(H,ys(void 0));return}else return B.add(H),ht(H,Ul(D)),Tt(te,Y,!1,{fetcherSubmission:D,preventScrollReset:N});if(pn(Y)){Ft(H,Q,Y.error);return}}if(Ps(Y))throw rn(400,{type:"defer-action"});let le=g.navigation.location||g.location,ye=uo(t.history,le,q.signal),Ce=o||a,me=g.navigation.state!=="idle"?ha(Ce,g.navigation.location,l):g.matches;Ge(me,"Didn't find any matches after fetcher action");let we=++G;Ee.set(H,we);let De=Ul(D,Y.data);g.fetchers.set(H,De);let[it,Ke]=Bx(t.history,g,me,D,le,!1,h.v7_skipActionErrorRevalidation,he,Se,oe,W,X,B,Ce,l,[de.route.id,Y]);Ke.filter(Ze=>Ze.key!==H).forEach(Ze=>{let ci=Ze.key,El=g.fetchers.get(ci),Ou=Ul(void 0,El?El.data:void 0);g.fetchers.set(ci,Ou),ut(ci),Ze.controller&&ie.set(ci,Ze.controller)}),z({fetchers:new Map(g.fetchers)});let dt=()=>Ke.forEach(Ze=>ut(Ze.key));q.signal.addEventListener("abort",dt);let{loaderResults:tn,fetcherResults:He}=await vt(g,me,it,Ke,ye);if(q.signal.aborted)return;q.signal.removeEventListener("abort",dt),Ee.delete(H),ie.delete(H),Ke.forEach(Ze=>ie.delete(Ze.key));let ft=ff(tn);if(ft)return Tt(ye,ft.result,!1,{preventScrollReset:N});if(ft=ff(He),ft)return B.add(ft.key),Tt(ye,ft.result,!1,{preventScrollReset:N});let{loaderData:dr,errors:In}=Gx(g,me,tn,void 0,Ke,He,ae);if(g.fetchers.has(H)){let Ze=ys(Y.data);g.fetchers.set(H,Ze)}no(we),g.navigation.state==="loading"&&we>ue?(Ge(k,"Expected pending action"),C&&C.abort(),ot(g.navigation.location,{matches:me,loaderData:dr,errors:In,fetchers:new Map(g.fetchers)})):(z({errors:In,loaderData:Kx(g.loaderData,dr,me,In),fetchers:new Map(g.fetchers)}),he=!1)}async function en(H,Q,ne,de,Ae,I,V,N,D){let O=g.fetchers.get(H);ht(H,Ul(D,O?O.data:void 0),{flushSync:V});let L=new AbortController,q=uo(t.history,ne,L.signal);if(I){let Y=await An(Ae,new URL(q.url).pathname,q.signal,H);if(Y.type==="aborted")return;if(Y.type==="error"){Ft(H,Q,Y.error,{flushSync:V});return}else if(Y.matches)Ae=Y.matches,de=Gl(Ae,ne);else{Ft(H,Q,rn(404,{pathname:ne}),{flushSync:V});return}}ie.set(H,L);let te=G,J=(await or("loader",g,q,[de],Ae,H))[de.route.id];if(Ps(J)&&(J=await Ig(J,q.signal,!0)||J),ie.get(H)===L&&ie.delete(H),!q.signal.aborted){if(W.has(H)){ht(H,ys(void 0));return}if(xa(J))if(ue>te){ht(H,ys(void 0));return}else{B.add(H),await Tt(q,J,!1,{preventScrollReset:N});return}if(pn(J)){Ft(H,Q,J.error);return}Ge(!Ps(J),"Unhandled fetcher deferred data"),ht(H,ys(J.data))}}async function Tt(H,Q,ne,de){let{submission:Ae,fetcherSubmission:I,preventScrollReset:V,replace:N}=de===void 0?{}:de;Q.response.headers.has("X-Remix-Revalidate")&&(he=!0);let D=Q.response.headers.get("Location");Ge(D,"Expected a Location header on the redirect Response"),D=Hx(D,new URL(H.url),l);let O=$c(g.location,D,{_isRedirect:!0});if(r){let Y=!1;if(Q.response.headers.has("X-Remix-Reload-Document"))Y=!0;else if(Ag.test(D)){const le=t.history.createURL(D);Y=le.origin!==e.location.origin||ns(le.pathname,l)==null}if(Y){N?e.location.replace(D):e.location.assign(D);return}}C=null;let L=N===!0||Q.response.headers.has("X-Remix-Replace")?Xt.Replace:Xt.Push,{formMethod:q,formAction:te,formEncType:ee}=g.navigation;!Ae&&!I&&q&&te&&ee&&(Ae=Qx(g.navigation));let J=Ae||I;if(DR.has(Q.response.status)&&J&&qn(J.formMethod))await be(L,O,{submission:Rt({},J,{formAction:D}),preventScrollReset:V||S,enableViewTransition:ne?F:void 0});else{let Y=Ad(O,Ae);await be(L,O,{overrideNavigation:Y,fetcherSubmission:I,preventScrollReset:V||S,enableViewTransition:ne?F:void 0})}}async function or(H,Q,ne,de,Ae,I){let V,N={};try{V=await BR(c,H,Q,ne,de,Ae,I,s,i)}catch(D){return de.forEach(O=>{N[O.route.id]={type:pt.error,error:D}}),N}for(let[D,O]of Object.entries(V))if(KR(O)){let L=O.result;N[D]={type:pt.redirect,response:HR(L,ne,D,Ae,l,h.v7_relativeSplatPath)}}else N[D]=await $R(O);return N}async function vt(H,Q,ne,de,Ae){let I=H.matches,V=or("loader",H,Ae,ne,Q,null),N=Promise.all(de.map(async L=>{if(L.matches&&L.match&&L.controller){let te=(await or("loader",H,uo(t.history,L.path,L.controller.signal),[L.match],L.matches,L.key))[L.match.route.id];return{[L.key]:te}}else return Promise.resolve({[L.key]:{type:pt.error,error:rn(404,{pathname:L.path})}})})),D=await V,O=(await N).reduce((L,q)=>Object.assign(L,q),{});return await Promise.all([YR(Q,D,Ae.signal,I,H.loaderData),QR(Q,O,de)]),{loaderResults:D,fetcherResults:O}}function kt(){he=!0,Se.push(...bi()),X.forEach((H,Q)=>{ie.has(Q)&&oe.add(Q),ut(Q)})}function ht(H,Q,ne){ne===void 0&&(ne={}),g.fetchers.set(H,Q),z({fetchers:new Map(g.fetchers)},{flushSync:(ne&&ne.flushSync)===!0})}function Ft(H,Q,ne,de){de===void 0&&(de={});let Ae=da(g.matches,Q);xt(H),z({errors:{[Ae.route.id]:ne},fetchers:new Map(g.fetchers)},{flushSync:(de&&de.flushSync)===!0})}function Ve(H){return K.set(H,(K.get(H)||0)+1),W.has(H)&&W.delete(H),g.fetchers.get(H)||bR}function xt(H){let Q=g.fetchers.get(H);ie.has(H)&&!(Q&&Q.state==="loading"&&Ee.has(H))&&ut(H),X.delete(H),Ee.delete(H),B.delete(H),h.v7_fetcherPersist&&W.delete(H),oe.delete(H),g.fetchers.delete(H)}function Ht(H){let Q=(K.get(H)||0)-1;Q<=0?(K.delete(H),W.add(H),h.v7_fetcherPersist||xt(H)):K.set(H,Q),z({fetchers:new Map(g.fetchers)})}function ut(H){let Q=ie.get(H);Q&&(Q.abort(),ie.delete(H))}function fn(H){for(let Q of H){let ne=Ve(Q),de=ys(ne.data);g.fetchers.set(Q,de)}}function Fi(){let H=[],Q=!1;for(let ne of B){let de=g.fetchers.get(ne);Ge(de,"Expected fetcher: "+ne),de.state==="loading"&&(B.delete(ne),H.push(ne),Q=!0)}return fn(H),Q}function no(H){let Q=[];for(let[ne,de]of Ee)if(de<H){let Ae=g.fetchers.get(ne);Ge(Ae,"Expected fetcher: "+ne),Ae.state==="loading"&&(ut(ne),Ee.delete(ne),Q.push(ne))}return fn(Q),Q.length>0}function wl(H,Q){let ne=g.blockers.get(H)||Vl;return xe.get(H)!==Q&&xe.set(H,Q),ne}function Di(H){g.blockers.delete(H),xe.delete(H)}function oi(H,Q){let ne=g.blockers.get(H)||Vl;Ge(ne.state==="unblocked"&&Q.state==="blocked"||ne.state==="blocked"&&Q.state==="blocked"||ne.state==="blocked"&&Q.state==="proceeding"||ne.state==="blocked"&&Q.state==="unblocked"||ne.state==="proceeding"&&Q.state==="unblocked","Invalid blocker state transition: "+ne.state+" -> "+Q.state);let de=new Map(g.blockers);de.set(H,Q),z({blockers:de})}function ps(H){let{currentLocation:Q,nextLocation:ne,historyAction:de}=H;if(xe.size===0)return;xe.size>1&&Qo(!1,"A router only supports one blocker at a time");let Ae=Array.from(xe.entries()),[I,V]=Ae[Ae.length-1],N=g.blockers.get(I);if(!(N&&N.state==="proceeding")&&V({currentLocation:Q,nextLocation:ne,historyAction:de}))return I}function Bn(H){let Q=rn(404,{pathname:H}),ne=o||a,{matches:de,route:Ae}=Xx(ne);return bi(),{notFoundMatches:de,route:Ae,error:Q}}function bi(H){let Q=[];return ae.forEach((ne,de)=>{(!H||H(de))&&(ne.cancel(),Q.push(de),ae.delete(de))}),Q}function li(H,Q,ne){if(x=H,E=Q,v=ne||null,!T&&g.navigation===Sd){T=!0;let de=Oi(g.location,g.matches);de!=null&&z({restoreScrollPosition:de})}return()=>{x=null,E=null,v=null}}function Sn(H,Q){return v&&v(H,Q.map(de=>fR(de,g.loaderData)))||H.key}function io(H,Q){if(x&&E){let ne=Sn(H,Q);x[ne]=E()}}function Oi(H,Q){if(x){let ne=Sn(H,Q),de=x[ne];if(typeof de=="number")return de}return null}function Li(H,Q,ne){if(u)if(H){if(Object.keys(H[0].params).length>0)return{active:!0,matches:Uf(Q,ne,l,!0)}}else return{active:!0,matches:Uf(Q,ne,l,!0)||[]};return{active:!1,matches:null}}async function An(H,Q,ne,de){if(!u)return{type:"success",matches:H};let Ae=H;for(;;){let I=o==null,V=o||a,N=s;try{await u({signal:ne,path:Q,matches:Ae,fetcherKey:de,patch:(L,q)=>{ne.aborted||$x(L,q,V,N,i)}})}catch(L){return{type:"error",error:L,partialMatches:Ae}}finally{I&&!ne.aborted&&(a=[...a])}if(ne.aborted)return{type:"aborted"};let D=ha(V,Q,l);if(D)return{type:"success",matches:D};let O=Uf(V,Q,l,!0);if(!O||Ae.length===O.length&&Ae.every((L,q)=>L.route.id===O[q].route.id))return{type:"success",matches:null};Ae=O}}function so(H){s={},o=_h(H,i,void 0,s)}function Zt(H,Q){let ne=o==null;$x(H,Q,o||a,s,i),ne&&(a=[...a],z({}))}return j={get basename(){return l},get future(){return h},get state(){return g},get routes(){return a},get window(){return e},initialize:fe,subscribe:$e,enableScrollRestoration:li,navigate:We,fetch:Zr,revalidate:nt,createHref:H=>t.history.createHref(H),encodeLocation:H=>t.history.encodeLocation(H),getFetcher:Ve,deleteFetcher:Ht,dispose:pe,getBlocker:wl,deleteBlocker:Di,patchRoutes:Zt,_internalFetchControllers:ie,_internalActiveDeferreds:ae,_internalSetRoutes:so},j}function MR(t){return t!=null&&("formData"in t&&t.formData!=null||"body"in t&&t.body!==void 0)}function zp(t,e,r,n,i,s,a,o){let l,c;if(a){l=[];for(let h of e)if(l.push(h),h.route.id===a){c=h;break}}else l=e,c=e[e.length-1];let u=v0(i||".",g0(l,s),ns(t.pathname,r)||t.pathname,o==="path");if(i==null&&(u.search=t.search,u.hash=t.hash),(i==null||i===""||i===".")&&c){let h=Cg(u.search);if(c.route.index&&!h)u.search=u.search?u.search.replace(/^\?/,"?index&"):"?index";else if(!c.route.index&&h){let d=new URLSearchParams(u.search),p=d.getAll("index");d.delete("index"),p.filter(v=>v).forEach(v=>d.append("index",v));let x=d.toString();u.search=x?"?"+x:""}}return n&&r!=="/"&&(u.pathname=u.pathname==="/"?r:Xi([r,u.pathname])),Da(u)}function Ux(t,e,r,n){if(!n||!MR(n))return{path:r};if(n.formMethod&&!XR(n.formMethod))return{path:r,error:rn(405,{method:n.formMethod})};let i=()=>({path:r,error:rn(400,{type:"invalid-body"})}),s=n.formMethod||"get",a=t?s.toUpperCase():s.toLowerCase(),o=Z2(r);if(n.body!==void 0){if(n.formEncType==="text/plain"){if(!qn(a))return i();let d=typeof n.body=="string"?n.body:n.body instanceof FormData||n.body instanceof URLSearchParams?Array.from(n.body.entries()).reduce((p,x)=>{let[v,E]=x;return""+p+v+"="+E+`
`},""):String(n.body);return{path:r,submission:{formMethod:a,formAction:o,formEncType:n.formEncType,formData:void 0,json:void 0,text:d}}}else if(n.formEncType==="application/json"){if(!qn(a))return i();try{let d=typeof n.body=="string"?JSON.parse(n.body):n.body;return{path:r,submission:{formMethod:a,formAction:o,formEncType:n.formEncType,formData:void 0,json:d,text:void 0}}}catch{return i()}}}Ge(typeof FormData=="function","FormData is not available in this environment");let l,c;if(n.formData)l=Hp(n.formData),c=n.formData;else if(n.body instanceof FormData)l=Hp(n.body),c=n.body;else if(n.body instanceof URLSearchParams)l=n.body,c=Wx(l);else if(n.body==null)l=new URLSearchParams,c=new FormData;else try{l=new URLSearchParams(n.body),c=Wx(l)}catch{return i()}let u={formMethod:a,formAction:o,formEncType:n&&n.formEncType||"application/x-www-form-urlencoded",formData:c,json:void 0,text:void 0};if(qn(u.formMethod))return{path:r,submission:u};let h=ia(r);return e&&h.search&&Cg(h.search)&&l.append("index",""),h.search="?"+l,{path:Da(h),submission:u}}function jx(t,e,r){r===void 0&&(r=!1);let n=t.findIndex(i=>i.route.id===e);return n>=0?t.slice(0,r?n+1:n):t}function Bx(t,e,r,n,i,s,a,o,l,c,u,h,d,p,x,v){let E=v?pn(v[1])?v[1].error:v[1].data:void 0,T=t.createURL(e.location),w=t.createURL(i),y=r;s&&e.errors?y=jx(r,Object.keys(e.errors)[0],!0):v&&pn(v[1])&&(y=jx(r,v[0]));let R=v?v[1].statusCode:void 0,M=a&&R&&R>=400,j=y.filter((k,S)=>{let{route:C}=k;if(C.lazy)return!0;if(C.loader==null)return!1;if(s)return $p(C,e.loaderData,e.errors);if(VR(e.loaderData,e.matches[S],k)||l.some(b=>b===k.route.id))return!0;let F=e.matches[S],P=k;return zx(k,Rt({currentUrl:T,currentParams:F.params,nextUrl:w,nextParams:P.params},n,{actionResult:E,actionStatus:R,defaultShouldRevalidate:M?!1:o||T.pathname+T.search===w.pathname+w.search||T.search!==w.search||Q2(F,P)}))}),g=[];return h.forEach((k,S)=>{if(s||!r.some(ve=>ve.route.id===k.routeId)||u.has(S))return;let C=ha(p,k.path,x);if(!C){g.push({key:S,routeId:k.routeId,path:k.path,matches:null,match:null,controller:null});return}let F=e.fetchers.get(S),P=Gl(C,k.path),b=!1;d.has(S)?b=!1:c.has(S)?(c.delete(S),b=!0):F&&F.state!=="idle"&&F.data===void 0?b=o:b=zx(P,Rt({currentUrl:T,currentParams:e.matches[e.matches.length-1].params,nextUrl:w,nextParams:r[r.length-1].params},n,{actionResult:E,actionStatus:R,defaultShouldRevalidate:M?!1:o})),b&&g.push({key:S,routeId:k.routeId,path:k.path,matches:C,match:P,controller:new AbortController})}),[j,g]}function $p(t,e,r){if(t.lazy)return!0;if(!t.loader)return!1;let n=e!=null&&e[t.id]!==void 0,i=r!=null&&r[t.id]!==void 0;return!n&&i?!1:typeof t.loader=="function"&&t.loader.hydrate===!0?!0:!n&&!i}function VR(t,e,r){let n=!e||r.route.id!==e.route.id,i=t[r.route.id]===void 0;return n||i}function Q2(t,e){let r=t.route.path;return t.pathname!==e.pathname||r!=null&&r.endsWith("*")&&t.params["*"]!==e.params["*"]}function zx(t,e){if(t.route.shouldRevalidate){let r=t.route.shouldRevalidate(e);if(typeof r=="boolean")return r}return e.defaultShouldRevalidate}function $x(t,e,r,n,i){var s;let a;if(t){let c=n[t];Ge(c,"No route found to patch children into: routeId = "+t),c.children||(c.children=[]),a=c.children}else a=r;let o=e.filter(c=>!a.some(u=>J2(c,u))),l=_h(o,i,[t||"_","patch",String(((s=a)==null?void 0:s.length)||"0")],n);a.push(...l)}function J2(t,e){return"id"in t&&"id"in e&&t.id===e.id?!0:t.index===e.index&&t.path===e.path&&t.caseSensitive===e.caseSensitive?(!t.children||t.children.length===0)&&(!e.children||e.children.length===0)?!0:t.children.every((r,n)=>{var i;return(i=e.children)==null?void 0:i.some(s=>J2(r,s))}):!1}async function UR(t,e,r){if(!t.lazy)return;let n=await t.lazy();if(!t.lazy)return;let i=r[t.id];Ge(i,"No route found in manifest");let s={};for(let a in n){let l=i[a]!==void 0&&a!=="hasErrorBoundary";Qo(!l,'Route "'+i.id+'" has a static property "'+a+'" defined but its lazy function is also returning a value for this property. '+('The lazy route property "'+a+'" will be ignored.')),!l&&!cR.has(a)&&(s[a]=n[a])}Object.assign(i,s),Object.assign(i,Rt({},e(i),{lazy:void 0}))}async function jR(t){let{matches:e}=t,r=e.filter(i=>i.shouldLoad);return(await Promise.all(r.map(i=>i.resolve()))).reduce((i,s,a)=>Object.assign(i,{[r[a].route.id]:s}),{})}async function BR(t,e,r,n,i,s,a,o,l,c){let u=s.map(p=>p.route.lazy?UR(p.route,l,o):void 0),h=s.map((p,x)=>{let v=u[x],E=i.some(w=>w.route.id===p.route.id);return Rt({},p,{shouldLoad:E,resolve:async w=>(w&&n.method==="GET"&&(p.route.lazy||p.route.loader)&&(E=!0),E?zR(e,n,p,v,w,c):Promise.resolve({type:pt.data,result:void 0}))})}),d=await t({matches:h,request:n,params:s[0].params,fetcherKey:a,context:c});try{await Promise.all(u)}catch{}return d}async function zR(t,e,r,n,i,s){let a,o,l=c=>{let u,h=new Promise((x,v)=>u=v);o=()=>u(),e.signal.addEventListener("abort",o);let d=x=>typeof c!="function"?Promise.reject(new Error("You cannot call the handler for a route which defines a boolean "+('"'+t+'" [routeId: '+r.route.id+"]"))):c({request:e,params:r.params,context:s},...x!==void 0?[x]:[]),p=(async()=>{try{return{type:"data",result:await(i?i(v=>d(v)):d())}}catch(x){return{type:"error",result:x}}})();return Promise.race([p,h])};try{let c=r.route[t];if(n)if(c){let u,[h]=await Promise.all([l(c).catch(d=>{u=d}),n]);if(u!==void 0)throw u;a=h}else if(await n,c=r.route[t],c)a=await l(c);else if(t==="action"){let u=new URL(e.url),h=u.pathname+u.search;throw rn(405,{method:e.method,pathname:h,routeId:r.route.id})}else return{type:pt.data,result:void 0};else if(c)a=await l(c);else{let u=new URL(e.url),h=u.pathname+u.search;throw rn(404,{pathname:h})}Ge(a.result!==void 0,"You defined "+(t==="action"?"an action":"a loader")+" for route "+('"'+r.route.id+"\" but didn't return anything from your `"+t+"` ")+"function. Please return a value or `null`.")}catch(c){return{type:pt.error,result:c}}finally{o&&e.signal.removeEventListener("abort",o)}return a}async function $R(t){let{result:e,type:r}=t;if(eT(e)){let h;try{let d=e.headers.get("Content-Type");d&&/\bapplication\/json\b/.test(d)?e.body==null?h=null:h=await e.json():h=await e.text()}catch(d){return{type:pt.error,error:d}}return r===pt.error?{type:pt.error,error:new wh(e.status,e.statusText,h),statusCode:e.status,headers:e.headers}:{type:pt.data,data:h,statusCode:e.status,headers:e.headers}}if(r===pt.error){if(Yx(e)){var n,i;if(e.data instanceof Error){var s,a;return{type:pt.error,error:e.data,statusCode:(s=e.init)==null?void 0:s.status,headers:(a=e.init)!=null&&a.headers?new Headers(e.init.headers):void 0}}return{type:pt.error,error:new wh(((n=e.init)==null?void 0:n.status)||500,void 0,e.data),statusCode:Hc(e)?e.status:void 0,headers:(i=e.init)!=null&&i.headers?new Headers(e.init.headers):void 0}}return{type:pt.error,error:e,statusCode:Hc(e)?e.status:void 0}}if(qR(e)){var o,l;return{type:pt.deferred,deferredData:e,statusCode:(o=e.init)==null?void 0:o.status,headers:((l=e.init)==null?void 0:l.headers)&&new Headers(e.init.headers)}}if(Yx(e)){var c,u;return{type:pt.data,data:e.data,statusCode:(c=e.init)==null?void 0:c.status,headers:(u=e.init)!=null&&u.headers?new Headers(e.init.headers):void 0}}return{type:pt.data,data:e}}function HR(t,e,r,n,i,s){let a=t.headers.get("Location");if(Ge(a,"Redirects returned/thrown from loaders/actions must have a Location header"),!Ag.test(a)){let o=n.slice(0,n.findIndex(l=>l.route.id===r)+1);a=zp(new URL(e.url),o,i,!0,a,s),t.headers.set("Location",a)}return t}function Hx(t,e,r){if(Ag.test(t)){let n=t,i=n.startsWith("//")?new URL(e.protocol+n):new URL(n),s=ns(i.pathname,r)!=null;if(i.origin===e.origin&&s)return i.pathname+i.search+i.hash}return t}function uo(t,e,r,n){let i=t.createURL(Z2(e)).toString(),s={signal:r};if(n&&qn(n.formMethod)){let{formMethod:a,formEncType:o}=n;s.method=a.toUpperCase(),o==="application/json"?(s.headers=new Headers({"Content-Type":o}),s.body=JSON.stringify(n.json)):o==="text/plain"?s.body=n.text:o==="application/x-www-form-urlencoded"&&n.formData?s.body=Hp(n.formData):s.body=n.formData}return new Request(i,s)}function Hp(t){let e=new URLSearchParams;for(let[r,n]of t.entries())e.append(r,typeof n=="string"?n:n.name);return e}function Wx(t){let e=new FormData;for(let[r,n]of t.entries())e.append(r,n);return e}function WR(t,e,r,n,i){let s={},a=null,o,l=!1,c={},u=r&&pn(r[1])?r[1].error:void 0;return t.forEach(h=>{if(!(h.route.id in e))return;let d=h.route.id,p=e[d];if(Ge(!xa(p),"Cannot handle redirect results in processLoaderData"),pn(p)){let x=p.error;u!==void 0&&(x=u,u=void 0),a=a||{};{let v=da(t,d);a[v.route.id]==null&&(a[v.route.id]=x)}s[d]=void 0,l||(l=!0,o=Hc(p.error)?p.error.status:500),p.headers&&(c[d]=p.headers)}else Ps(p)?(n.set(d,p.deferredData),s[d]=p.deferredData.data,p.statusCode!=null&&p.statusCode!==200&&!l&&(o=p.statusCode),p.headers&&(c[d]=p.headers)):(s[d]=p.data,p.statusCode&&p.statusCode!==200&&!l&&(o=p.statusCode),p.headers&&(c[d]=p.headers))}),u!==void 0&&r&&(a={[r[0]]:u},s[r[0]]=void 0),{loaderData:s,errors:a,statusCode:o||200,loaderHeaders:c}}function Gx(t,e,r,n,i,s,a){let{loaderData:o,errors:l}=WR(e,r,n,a);return i.forEach(c=>{let{key:u,match:h,controller:d}=c,p=s[u];if(Ge(p,"Did not find corresponding fetcher result"),!(d&&d.signal.aborted))if(pn(p)){let x=da(t.matches,h==null?void 0:h.route.id);l&&l[x.route.id]||(l=Rt({},l,{[x.route.id]:p.error})),t.fetchers.delete(u)}else if(xa(p))Ge(!1,"Unhandled fetcher revalidation redirect");else if(Ps(p))Ge(!1,"Unhandled fetcher deferred data");else{let x=ys(p.data);t.fetchers.set(u,x)}}),{loaderData:o,errors:l}}function Kx(t,e,r,n){let i=Rt({},e);for(let s of r){let a=s.route.id;if(e.hasOwnProperty(a)?e[a]!==void 0&&(i[a]=e[a]):t[a]!==void 0&&s.route.loader&&(i[a]=t[a]),n&&n.hasOwnProperty(a))break}return i}function qx(t){return t?pn(t[1])?{actionData:{}}:{actionData:{[t[0]]:t[1].data}}:{}}function da(t,e){return(e?t.slice(0,t.findIndex(n=>n.route.id===e)+1):[...t]).reverse().find(n=>n.route.hasErrorBoundary===!0)||t[0]}function Xx(t){let e=t.length===1?t[0]:t.find(r=>r.index||!r.path||r.path==="/")||{id:"__shim-error-route__"};return{matches:[{params:{},pathname:"",pathnameBase:"",route:e}],route:e}}function rn(t,e){let{pathname:r,routeId:n,method:i,type:s,message:a}=e===void 0?{}:e,o="Unknown Server Error",l="Unknown @remix-run/router error";return t===400?(o="Bad Request",i&&r&&n?l="You made a "+i+' request to "'+r+'" but '+('did not provide a `loader` for route "'+n+'", ')+"so there is no way to handle the request.":s==="defer-action"?l="defer() is not supported in actions":s==="invalid-body"&&(l="Unable to encode submission body")):t===403?(o="Forbidden",l='Route "'+n+'" does not match URL "'+r+'"'):t===404?(o="Not Found",l='No route matches URL "'+r+'"'):t===405&&(o="Method Not Allowed",i&&r&&n?l="You made a "+i.toUpperCase()+' request to "'+r+'" but '+('did not provide an `action` for route "'+n+'", ')+"so there is no way to handle the request.":i&&(l='Invalid request method "'+i.toUpperCase()+'"')),new wh(t||500,o,new Error(l),!0)}function ff(t){let e=Object.entries(t);for(let r=e.length-1;r>=0;r--){let[n,i]=e[r];if(xa(i))return{key:n,result:i}}}function Z2(t){let e=typeof t=="string"?ia(t):t;return Da(Rt({},e,{hash:""}))}function GR(t,e){return t.pathname!==e.pathname||t.search!==e.search?!1:t.hash===""?e.hash!=="":t.hash===e.hash?!0:e.hash!==""}function KR(t){return eT(t.result)&&FR.has(t.result.status)}function Ps(t){return t.type===pt.deferred}function pn(t){return t.type===pt.error}function xa(t){return(t&&t.type)===pt.redirect}function Yx(t){return typeof t=="object"&&t!=null&&"type"in t&&"data"in t&&"init"in t&&t.type==="DataWithResponseInit"}function qR(t){let e=t;return e&&typeof e=="object"&&typeof e.data=="object"&&typeof e.subscribe=="function"&&typeof e.cancel=="function"&&typeof e.resolveData=="function"}function eT(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.headers=="object"&&typeof t.body<"u"}function XR(t){return PR.has(t.toLowerCase())}function qn(t){return RR.has(t.toLowerCase())}async function YR(t,e,r,n,i){let s=Object.entries(e);for(let a=0;a<s.length;a++){let[o,l]=s[a],c=t.find(d=>(d==null?void 0:d.route.id)===o);if(!c)continue;let u=n.find(d=>d.route.id===c.route.id),h=u!=null&&!Q2(u,c)&&(i&&i[c.route.id])!==void 0;Ps(l)&&h&&await Ig(l,r,!1).then(d=>{d&&(e[o]=d)})}}async function QR(t,e,r){for(let n=0;n<r.length;n++){let{key:i,routeId:s,controller:a}=r[n],o=e[i];t.find(c=>(c==null?void 0:c.route.id)===s)&&Ps(o)&&(Ge(a,"Expected an AbortController for revalidating fetcher deferred result"),await Ig(o,a.signal,!0).then(c=>{c&&(e[i]=c)}))}}async function Ig(t,e,r){if(r===void 0&&(r=!1),!await t.deferredData.resolveData(e)){if(r)try{return{type:pt.data,data:t.deferredData.unwrappedData}}catch(i){return{type:pt.error,error:i}}return{type:pt.data,data:t.deferredData.data}}}function Cg(t){return new URLSearchParams(t).getAll("index").some(e=>e==="")}function Gl(t,e){let r=typeof e=="string"?ia(e).search:e.search;if(t[t.length-1].route.index&&Cg(r||""))return t[t.length-1];let n=q2(t);return n[n.length-1]}function Qx(t){let{formMethod:e,formAction:r,formEncType:n,text:i,formData:s,json:a}=t;if(!(!e||!r||!n)){if(i!=null)return{formMethod:e,formAction:r,formEncType:n,formData:void 0,json:void 0,text:i};if(s!=null)return{formMethod:e,formAction:r,formEncType:n,formData:s,json:void 0,text:void 0};if(a!==void 0)return{formMethod:e,formAction:r,formEncType:n,formData:void 0,json:a,text:void 0}}}function Ad(t,e){return e?{state:"loading",location:t,formMethod:e.formMethod,formAction:e.formAction,formEncType:e.formEncType,formData:e.formData,json:e.json,text:e.text}:{state:"loading",location:t,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0}}function JR(t,e){return{state:"submitting",location:t,formMethod:e.formMethod,formAction:e.formAction,formEncType:e.formEncType,formData:e.formData,json:e.json,text:e.text}}function Ul(t,e){return t?{state:"loading",formMethod:t.formMethod,formAction:t.formAction,formEncType:t.formEncType,formData:t.formData,json:t.json,text:t.text,data:e}:{state:"loading",formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0,data:e}}function ZR(t,e){return{state:"submitting",formMethod:t.formMethod,formAction:t.formAction,formEncType:t.formEncType,formData:t.formData,json:t.json,text:t.text,data:e?e.data:void 0}}function ys(t){return{state:"idle",formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0,data:t}}function eN(t,e){try{let r=t.sessionStorage.getItem(Y2);if(r){let n=JSON.parse(r);for(let[i,s]of Object.entries(n||{}))s&&Array.isArray(s)&&e.set(i,new Set(s||[]))}}catch{}}function tN(t,e){if(e.size>0){let r={};for(let[n,i]of e)r[n]=[...i];try{t.sessionStorage.setItem(Y2,JSON.stringify(r))}catch(n){Qo(!1,"Failed to save applied view transitions in sessionStorage ("+n+").")}}}/**
 * React Router v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Eh(){return Eh=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},Eh.apply(this,arguments)}const mu=Z.createContext(null),Rg=Z.createContext(null),fs=Z.createContext(null),Ng=Z.createContext(null),Si=Z.createContext({outlet:null,matches:[],isDataRoute:!1}),tT=Z.createContext(null);function rN(t,e){let{relative:r}=e===void 0?{}:e;hl()||Ge(!1);let{basename:n,navigator:i}=Z.useContext(fs),{hash:s,pathname:a,search:o}=x0(t,{relative:r}),l=a;return n!=="/"&&(l=a==="/"?n:Xi([n,a])),i.createHref({pathname:l,search:o,hash:s})}function hl(){return Z.useContext(Ng)!=null}function Ha(){return hl()||Ge(!1),Z.useContext(Ng).location}function rT(t){Z.useContext(fs).static||Z.useLayoutEffect(t)}function Wa(){let{isDataRoute:t}=Z.useContext(Si);return t?vN():nN()}function nN(){hl()||Ge(!1);let t=Z.useContext(mu),{basename:e,future:r,navigator:n}=Z.useContext(fs),{matches:i}=Z.useContext(Si),{pathname:s}=Ha(),a=JSON.stringify(g0(i,r.v7_relativeSplatPath)),o=Z.useRef(!1);return rT(()=>{o.current=!0}),Z.useCallback(function(c,u){if(u===void 0&&(u={}),!o.current)return;if(typeof c=="number"){n.go(c);return}let h=v0(c,JSON.parse(a),s,u.relative==="path");t==null&&e!=="/"&&(h.pathname=h.pathname==="/"?e:Xi([e,h.pathname])),(u.replace?n.replace:n.push)(h,u.state,u)},[e,n,a,s,t])}const iN=Z.createContext(null);function sN(t){let e=Z.useContext(Si).outlet;return e&&Z.createElement(iN.Provider,{value:t},e)}function aN(){let{matches:t}=Z.useContext(Si),e=t[t.length-1];return e?e.params:{}}function x0(t,e){let{relative:r}=e===void 0?{}:e,{future:n}=Z.useContext(fs),{matches:i}=Z.useContext(Si),{pathname:s}=Ha(),a=JSON.stringify(g0(i,n.v7_relativeSplatPath));return Z.useMemo(()=>v0(t,JSON.parse(a),s,r==="path"),[t,a,s,r])}function oN(t,e,r,n){hl()||Ge(!1);let{navigator:i}=Z.useContext(fs),{matches:s}=Z.useContext(Si),a=s[s.length-1],o=a?a.params:{};a&&a.pathname;let l=a?a.pathnameBase:"/";a&&a.route;let c=Ha(),u;u=c;let h=u.pathname||"/",d=h;if(l!=="/"){let v=l.replace(/^\//,"").split("/");d="/"+h.replace(/^\//,"").split("/").slice(v.length).join("/")}let p=ha(t,{pathname:d});return hN(p&&p.map(v=>Object.assign({},v,{params:Object.assign({},o,v.params),pathname:Xi([l,i.encodeLocation?i.encodeLocation(v.pathname).pathname:v.pathname]),pathnameBase:v.pathnameBase==="/"?l:Xi([l,i.encodeLocation?i.encodeLocation(v.pathnameBase).pathname:v.pathnameBase])})),s,r,n)}function lN(){let t=gN(),e=Hc(t)?t.status+" "+t.statusText:t instanceof Error?t.message:JSON.stringify(t),r=t instanceof Error?t.stack:null,i={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return Z.createElement(Z.Fragment,null,Z.createElement("h2",null,"Unexpected Application Error!"),Z.createElement("h3",{style:{fontStyle:"italic"}},e),r?Z.createElement("pre",{style:i},r):null,null)}const cN=Z.createElement(lN,null);class uN extends Z.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,r){return r.location!==e.location||r.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:r.error,location:r.location,revalidation:e.revalidation||r.revalidation}}componentDidCatch(e,r){console.error("React Router caught the following error during render",e,r)}render(){return this.state.error!==void 0?Z.createElement(Si.Provider,{value:this.props.routeContext},Z.createElement(tT.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function fN(t){let{routeContext:e,match:r,children:n}=t,i=Z.useContext(mu);return i&&i.static&&i.staticContext&&(r.route.errorElement||r.route.ErrorBoundary)&&(i.staticContext._deepestRenderedBoundaryId=r.route.id),Z.createElement(Si.Provider,{value:e},n)}function hN(t,e,r,n){var i;if(e===void 0&&(e=[]),r===void 0&&(r=null),n===void 0&&(n=null),t==null){var s;if(!r)return null;if(r.errors)t=r.matches;else if((s=n)!=null&&s.v7_partialHydration&&e.length===0&&!r.initialized&&r.matches.length>0)t=r.matches;else return null}let a=t,o=(i=r)==null?void 0:i.errors;if(o!=null){let u=a.findIndex(h=>h.route.id&&(o==null?void 0:o[h.route.id])!==void 0);u>=0||Ge(!1),a=a.slice(0,Math.min(a.length,u+1))}let l=!1,c=-1;if(r&&n&&n.v7_partialHydration)for(let u=0;u<a.length;u++){let h=a[u];if((h.route.HydrateFallback||h.route.hydrateFallbackElement)&&(c=u),h.route.id){let{loaderData:d,errors:p}=r,x=h.route.loader&&d[h.route.id]===void 0&&(!p||p[h.route.id]===void 0);if(h.route.lazy||x){l=!0,c>=0?a=a.slice(0,c+1):a=[a[0]];break}}}return a.reduceRight((u,h,d)=>{let p,x=!1,v=null,E=null;r&&(p=o&&h.route.id?o[h.route.id]:void 0,v=h.route.errorElement||cN,l&&(c<0&&d===0?(xN("route-fallback"),x=!0,E=null):c===d&&(x=!0,E=h.route.hydrateFallbackElement||null)));let T=e.concat(a.slice(0,d+1)),w=()=>{let y;return p?y=v:x?y=E:h.route.Component?y=Z.createElement(h.route.Component,null):h.route.element?y=h.route.element:y=u,Z.createElement(fN,{match:h,routeContext:{outlet:u,matches:T,isDataRoute:r!=null},children:y})};return r&&(h.route.ErrorBoundary||h.route.errorElement||d===0)?Z.createElement(uN,{location:r.location,revalidation:r.revalidation,component:v,error:p,children:w(),routeContext:{outlet:null,matches:T,isDataRoute:!0}}):w()},null)}var nT=function(t){return t.UseBlocker="useBlocker",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t}(nT||{}),iT=function(t){return t.UseBlocker="useBlocker",t.UseLoaderData="useLoaderData",t.UseActionData="useActionData",t.UseRouteError="useRouteError",t.UseNavigation="useNavigation",t.UseRouteLoaderData="useRouteLoaderData",t.UseMatches="useMatches",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t.UseRouteId="useRouteId",t}(iT||{});function dN(t){let e=Z.useContext(mu);return e||Ge(!1),e}function pN(t){let e=Z.useContext(Rg);return e||Ge(!1),e}function mN(t){let e=Z.useContext(Si);return e||Ge(!1),e}function sT(t){let e=mN(),r=e.matches[e.matches.length-1];return r.route.id||Ge(!1),r.route.id}function gN(){var t;let e=Z.useContext(tT),r=pN(iT.UseRouteError),n=sT();return e!==void 0?e:(t=r.errors)==null?void 0:t[n]}function vN(){let{router:t}=dN(nT.UseNavigateStable),e=sT(),r=Z.useRef(!1);return rT(()=>{r.current=!0}),Z.useCallback(function(i,s){s===void 0&&(s={}),r.current&&(typeof i=="number"?t.navigate(i):t.navigate(i,Eh({fromRouteId:e},s)))},[t,e])}const Jx={};function xN(t,e,r){Jx[t]||(Jx[t]=!0)}function _N(t,e){t==null||t.v7_startTransition,(t==null?void 0:t.v7_relativeSplatPath)===void 0&&(!e||e.v7_relativeSplatPath),e&&(e.v7_fetcherPersist,e.v7_normalizeFormMethod,e.v7_partialHydration,e.v7_skipActionErrorRevalidation)}function yN(t){let{to:e,replace:r,state:n,relative:i}=t;hl()||Ge(!1);let{future:s,static:a}=Z.useContext(fs),{matches:o}=Z.useContext(Si),{pathname:l}=Ha(),c=Wa(),u=v0(e,g0(o,s.v7_relativeSplatPath),l,i==="path"),h=JSON.stringify(u);return Z.useEffect(()=>c(JSON.parse(h),{replace:r,state:n,relative:i}),[c,h,i,r,n]),null}function aT(t){return sN(t.context)}function wN(t){let{basename:e="/",children:r=null,location:n,navigationType:i=Xt.Pop,navigator:s,static:a=!1,future:o}=t;hl()&&Ge(!1);let l=e.replace(/^\/*/,"/"),c=Z.useMemo(()=>({basename:l,navigator:s,static:a,future:Eh({v7_relativeSplatPath:!1},o)}),[l,o,s,a]);typeof n=="string"&&(n=ia(n));let{pathname:u="/",search:h="",hash:d="",state:p=null,key:x="default"}=n,v=Z.useMemo(()=>{let E=ns(u,l);return E==null?null:{location:{pathname:E,search:h,hash:d,state:p,key:x},navigationType:i}},[l,u,h,d,p,x,i]);return v==null?null:Z.createElement(fs.Provider,{value:c},Z.createElement(Ng.Provider,{children:r,value:v}))}new Promise(()=>{});function EN(t){let e={hasErrorBoundary:t.ErrorBoundary!=null||t.errorElement!=null};return t.Component&&Object.assign(e,{element:Z.createElement(t.Component),Component:void 0}),t.HydrateFallback&&Object.assign(e,{hydrateFallbackElement:Z.createElement(t.HydrateFallback),HydrateFallback:void 0}),t.ErrorBoundary&&Object.assign(e,{errorElement:Z.createElement(t.ErrorBoundary),ErrorBoundary:void 0}),e}/**
 * React Router DOM v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Jo(){return Jo=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},Jo.apply(this,arguments)}function oT(t,e){if(t==null)return{};var r={},n=Object.keys(t),i,s;for(s=0;s<n.length;s++)i=n[s],!(e.indexOf(i)>=0)&&(r[i]=t[i]);return r}function TN(t){return!!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}function kN(t,e){return t.button===0&&(!e||e==="_self")&&!TN(t)}const SN=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],AN=["aria-current","caseSensitive","className","end","style","to","viewTransition","children"],IN="6";try{window.__reactRouterVersion=IN}catch{}function CN(t,e){return LR({basename:void 0,future:Jo({},void 0,{v7_prependBasename:!0}),history:aR({window:void 0}),hydrationData:RN(),routes:t,mapRouteProperties:EN,dataStrategy:void 0,patchRoutesOnNavigation:void 0,window:void 0}).initialize()}function RN(){var t;let e=(t=window)==null?void 0:t.__staticRouterHydrationData;return e&&e.errors&&(e=Jo({},e,{errors:NN(e.errors)})),e}function NN(t){if(!t)return null;let e=Object.entries(t),r={};for(let[n,i]of e)if(i&&i.__type==="RouteErrorResponse")r[n]=new wh(i.status,i.statusText,i.data,i.internal===!0);else if(i&&i.__type==="Error"){if(i.__subType){let s=window[i.__subType];if(typeof s=="function")try{let a=new s(i.message);a.stack="",r[n]=a}catch{}}if(r[n]==null){let s=new Error(i.message);s.stack="",r[n]=s}}else r[n]=i;return r}const lT=Z.createContext({isTransitioning:!1}),PN=Z.createContext(new Map),FN="startTransition",Zx=KI[FN],DN="flushSync",e_=sR[DN];function bN(t){Zx?Zx(t):t()}function jl(t){e_?e_(t):t()}let ON=class{constructor(){this.status="pending",this.promise=new Promise((e,r)=>{this.resolve=n=>{this.status==="pending"&&(this.status="resolved",e(n))},this.reject=n=>{this.status==="pending"&&(this.status="rejected",r(n))}})}};function LN(t){let{fallbackElement:e,router:r,future:n}=t,[i,s]=Z.useState(r.state),[a,o]=Z.useState(),[l,c]=Z.useState({isTransitioning:!1}),[u,h]=Z.useState(),[d,p]=Z.useState(),[x,v]=Z.useState(),E=Z.useRef(new Map),{v7_startTransition:T}=n||{},w=Z.useCallback(k=>{T?bN(k):k()},[T]),y=Z.useCallback((k,S)=>{let{deletedFetchers:C,flushSync:F,viewTransitionOpts:P}=S;k.fetchers.forEach((ve,he)=>{ve.data!==void 0&&E.current.set(he,ve.data)}),C.forEach(ve=>E.current.delete(ve));let b=r.window==null||r.window.document==null||typeof r.window.document.startViewTransition!="function";if(!P||b){F?jl(()=>s(k)):w(()=>s(k));return}if(F){jl(()=>{d&&(u&&u.resolve(),d.skipTransition()),c({isTransitioning:!0,flushSync:!0,currentLocation:P.currentLocation,nextLocation:P.nextLocation})});let ve=r.window.document.startViewTransition(()=>{jl(()=>s(k))});ve.finished.finally(()=>{jl(()=>{h(void 0),p(void 0),o(void 0),c({isTransitioning:!1})})}),jl(()=>p(ve));return}d?(u&&u.resolve(),d.skipTransition(),v({state:k,currentLocation:P.currentLocation,nextLocation:P.nextLocation})):(o(k),c({isTransitioning:!0,flushSync:!1,currentLocation:P.currentLocation,nextLocation:P.nextLocation}))},[r.window,d,u,E,w]);Z.useLayoutEffect(()=>r.subscribe(y),[r,y]),Z.useEffect(()=>{l.isTransitioning&&!l.flushSync&&h(new ON)},[l]),Z.useEffect(()=>{if(u&&a&&r.window){let k=a,S=u.promise,C=r.window.document.startViewTransition(async()=>{w(()=>s(k)),await S});C.finished.finally(()=>{h(void 0),p(void 0),o(void 0),c({isTransitioning:!1})}),p(C)}},[w,a,u,r.window]),Z.useEffect(()=>{u&&a&&i.location.key===a.location.key&&u.resolve()},[u,d,i.location,a]),Z.useEffect(()=>{!l.isTransitioning&&x&&(o(x.state),c({isTransitioning:!0,flushSync:!1,currentLocation:x.currentLocation,nextLocation:x.nextLocation}),v(void 0))},[l.isTransitioning,x]),Z.useEffect(()=>{},[]);let R=Z.useMemo(()=>({createHref:r.createHref,encodeLocation:r.encodeLocation,go:k=>r.navigate(k),push:(k,S,C)=>r.navigate(k,{state:S,preventScrollReset:C==null?void 0:C.preventScrollReset}),replace:(k,S,C)=>r.navigate(k,{replace:!0,state:S,preventScrollReset:C==null?void 0:C.preventScrollReset})}),[r]),M=r.basename||"/",j=Z.useMemo(()=>({router:r,navigator:R,static:!1,basename:M}),[r,R,M]),g=Z.useMemo(()=>({v7_relativeSplatPath:r.future.v7_relativeSplatPath}),[r.future.v7_relativeSplatPath]);return Z.useEffect(()=>_N(n,r.future),[n,r.future]),Z.createElement(Z.Fragment,null,Z.createElement(mu.Provider,{value:j},Z.createElement(Rg.Provider,{value:i},Z.createElement(PN.Provider,{value:E.current},Z.createElement(lT.Provider,{value:l},Z.createElement(wN,{basename:M,location:i.location,navigationType:i.historyAction,navigator:R,future:g},i.initialized||r.future.v7_partialHydration?Z.createElement(MN,{routes:r.routes,future:r.future,state:i}):e))))),null)}const MN=Z.memo(VN);function VN(t){let{routes:e,future:r,state:n}=t;return oN(e,void 0,n,r)}const UN=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",jN=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Qe=Z.forwardRef(function(e,r){let{onClick:n,relative:i,reloadDocument:s,replace:a,state:o,target:l,to:c,preventScrollReset:u,viewTransition:h}=e,d=oT(e,SN),{basename:p}=Z.useContext(fs),x,v=!1;if(typeof c=="string"&&jN.test(c)&&(x=c,UN))try{let y=new URL(window.location.href),R=c.startsWith("//")?new URL(y.protocol+c):new URL(c),M=ns(R.pathname,p);R.origin===y.origin&&M!=null?c=M+R.search+R.hash:v=!0}catch{}let E=rN(c,{relative:i}),T=zN(c,{replace:a,state:o,target:l,preventScrollReset:u,relative:i,viewTransition:h});function w(y){n&&n(y),y.defaultPrevented||T(y)}return Z.createElement("a",Jo({},d,{href:x||E,onClick:v||s?n:w,ref:r,target:l}))}),fo=Z.forwardRef(function(e,r){let{"aria-current":n="page",caseSensitive:i=!1,className:s="",end:a=!1,style:o,to:l,viewTransition:c,children:u}=e,h=oT(e,AN),d=x0(l,{relative:h.relative}),p=Ha(),x=Z.useContext(Rg),{navigator:v,basename:E}=Z.useContext(fs),T=x!=null&&$N(d)&&c===!0,w=v.encodeLocation?v.encodeLocation(d).pathname:d.pathname,y=p.pathname,R=x&&x.navigation&&x.navigation.location?x.navigation.location.pathname:null;i||(y=y.toLowerCase(),R=R?R.toLowerCase():null,w=w.toLowerCase()),R&&E&&(R=ns(R,E)||R);const M=w!=="/"&&w.endsWith("/")?w.length-1:w.length;let j=y===w||!a&&y.startsWith(w)&&y.charAt(M)==="/",g=R!=null&&(R===w||!a&&R.startsWith(w)&&R.charAt(w.length)==="/"),k={isActive:j,isPending:g,isTransitioning:T},S=j?n:void 0,C;typeof s=="function"?C=s(k):C=[s,j?"active":null,g?"pending":null,T?"transitioning":null].filter(Boolean).join(" ");let F=typeof o=="function"?o(k):o;return Z.createElement(Qe,Jo({},h,{"aria-current":S,className:C,ref:r,style:F,to:l,viewTransition:c}),typeof u=="function"?u(k):u)});var Wp;(function(t){t.UseScrollRestoration="useScrollRestoration",t.UseSubmit="useSubmit",t.UseSubmitFetcher="useSubmitFetcher",t.UseFetcher="useFetcher",t.useViewTransitionState="useViewTransitionState"})(Wp||(Wp={}));var t_;(function(t){t.UseFetcher="useFetcher",t.UseFetchers="useFetchers",t.UseScrollRestoration="useScrollRestoration"})(t_||(t_={}));function BN(t){let e=Z.useContext(mu);return e||Ge(!1),e}function zN(t,e){let{target:r,replace:n,state:i,preventScrollReset:s,relative:a,viewTransition:o}=e===void 0?{}:e,l=Wa(),c=Ha(),u=x0(t,{relative:a});return Z.useCallback(h=>{if(kN(h,r)){h.preventDefault();let d=n!==void 0?n:Da(c)===Da(u);l(t,{replace:d,state:i,preventScrollReset:s,relative:a,viewTransition:o})}},[c,l,u,n,i,r,t,s,a,o])}function $N(t,e){e===void 0&&(e={});let r=Z.useContext(lT);r==null&&Ge(!1);let{basename:n}=BN(Wp.useViewTransitionState),i=x0(t,{relative:e.relative});if(!r.isTransitioning)return!1;let s=ns(r.currentLocation.pathname,n)||r.currentLocation.pathname,a=ns(r.nextLocation.pathname,n)||r.nextLocation.pathname;return yh(i.pathname,a)!=null||yh(i.pathname,s)!=null}var r_={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cT=function(t){const e=[];let r=0;for(let n=0;n<t.length;n++){let i=t.charCodeAt(n);i<128?e[r++]=i:i<2048?(e[r++]=i>>6|192,e[r++]=i&63|128):(i&64512)===55296&&n+1<t.length&&(t.charCodeAt(n+1)&64512)===56320?(i=65536+((i&1023)<<10)+(t.charCodeAt(++n)&1023),e[r++]=i>>18|240,e[r++]=i>>12&63|128,e[r++]=i>>6&63|128,e[r++]=i&63|128):(e[r++]=i>>12|224,e[r++]=i>>6&63|128,e[r++]=i&63|128)}return e},HN=function(t){const e=[];let r=0,n=0;for(;r<t.length;){const i=t[r++];if(i<128)e[n++]=String.fromCharCode(i);else if(i>191&&i<224){const s=t[r++];e[n++]=String.fromCharCode((i&31)<<6|s&63)}else if(i>239&&i<365){const s=t[r++],a=t[r++],o=t[r++],l=((i&7)<<18|(s&63)<<12|(a&63)<<6|o&63)-65536;e[n++]=String.fromCharCode(55296+(l>>10)),e[n++]=String.fromCharCode(56320+(l&1023))}else{const s=t[r++],a=t[r++];e[n++]=String.fromCharCode((i&15)<<12|(s&63)<<6|a&63)}}return e.join("")},uT={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const r=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,n=[];for(let i=0;i<t.length;i+=3){const s=t[i],a=i+1<t.length,o=a?t[i+1]:0,l=i+2<t.length,c=l?t[i+2]:0,u=s>>2,h=(s&3)<<4|o>>4;let d=(o&15)<<2|c>>6,p=c&63;l||(p=64,a||(d=64)),n.push(r[u],r[h],r[d],r[p])}return n.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(cT(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):HN(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const r=e?this.charToByteMapWebSafe_:this.charToByteMap_,n=[];for(let i=0;i<t.length;){const s=r[t.charAt(i++)],o=i<t.length?r[t.charAt(i)]:0;++i;const c=i<t.length?r[t.charAt(i)]:64;++i;const h=i<t.length?r[t.charAt(i)]:64;if(++i,s==null||o==null||c==null||h==null)throw new WN;const d=s<<2|o>>4;if(n.push(d),c!==64){const p=o<<4&240|c>>2;if(n.push(p),h!==64){const x=c<<6&192|h;n.push(x)}}}return n},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class WN extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const GN=function(t){const e=cT(t);return uT.encodeByteArray(e,!0)},Th=function(t){return GN(t).replace(/\./g,"")},fT=function(t){try{return uT.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function KN(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qN=()=>KN().__FIREBASE_DEFAULTS__,XN=()=>{if(typeof process>"u"||typeof r_>"u")return;const t=r_.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},YN=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&fT(t[1]);return e&&JSON.parse(e)},_0=()=>{try{return qN()||XN()||YN()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},hT=t=>{var e,r;return(r=(e=_0())===null||e===void 0?void 0:e.emulatorHosts)===null||r===void 0?void 0:r[t]},Pg=t=>{const e=hT(t);if(!e)return;const r=e.lastIndexOf(":");if(r<=0||r+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const n=parseInt(e.substring(r+1),10);return e[0]==="["?[e.substring(1,r-1),n]:[e.substring(0,r),n]},dT=()=>{var t;return(t=_0())===null||t===void 0?void 0:t.config},pT=t=>{var e;return(e=_0())===null||e===void 0?void 0:e[`_${t}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QN{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,r)=>{this.resolve=e,this.reject=r})}wrapCallback(e){return(r,n)=>{r?this.reject(r):this.resolve(n),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(r):e(r,n))}}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mT(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const r={alg:"none",type:"JWT"},n=e||"demo-project",i=t.iat||0,s=t.sub||t.user_id;if(!s)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const a=Object.assign({iss:`https://securetoken.google.com/${n}`,aud:n,iat:i,exp:i+3600,auth_time:i,sub:s,user_id:s,firebase:{sign_in_provider:"custom",identities:{}}},t);return[Th(JSON.stringify(r)),Th(JSON.stringify(a)),""].join(".")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jr(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function JN(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(jr())}function ZN(){var t;const e=(t=_0())===null||t===void 0?void 0:t.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function eP(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function tP(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function rP(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function nP(){const t=jr();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function iP(){return!ZN()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function sP(){try{return typeof indexedDB=="object"}catch{return!1}}function aP(){return new Promise((t,e)=>{try{let r=!0;const n="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(n);i.onsuccess=()=>{i.result.close(),r||self.indexedDB.deleteDatabase(n),t(!0)},i.onupgradeneeded=()=>{r=!1},i.onerror=()=>{var s;e(((s=i.error)===null||s===void 0?void 0:s.message)||"")}}catch(r){e(r)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oP="FirebaseError";class Ai extends Error{constructor(e,r,n){super(r),this.code=e,this.customData=n,this.name=oP,Object.setPrototypeOf(this,Ai.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,gu.prototype.create)}}class gu{constructor(e,r,n){this.service=e,this.serviceName=r,this.errors=n}create(e,...r){const n=r[0]||{},i=`${this.service}/${e}`,s=this.errors[e],a=s?lP(s,n):"Error",o=`${this.serviceName}: ${a} (${i}).`;return new Ai(i,o,n)}}function lP(t,e){return t.replace(cP,(r,n)=>{const i=e[n];return i!=null?String(i):`<${n}?>`})}const cP=/\{\$([^}]+)}/g;function uP(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function kh(t,e){if(t===e)return!0;const r=Object.keys(t),n=Object.keys(e);for(const i of r){if(!n.includes(i))return!1;const s=t[i],a=e[i];if(n_(s)&&n_(a)){if(!kh(s,a))return!1}else if(s!==a)return!1}for(const i of n)if(!r.includes(i))return!1;return!0}function n_(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vu(t){const e=[];for(const[r,n]of Object.entries(t))Array.isArray(n)?n.forEach(i=>{e.push(encodeURIComponent(r)+"="+encodeURIComponent(i))}):e.push(encodeURIComponent(r)+"="+encodeURIComponent(n));return e.length?"&"+e.join("&"):""}function fP(t,e){const r=new hP(t,e);return r.subscribe.bind(r)}class hP{constructor(e,r){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=r,this.task.then(()=>{e(this)}).catch(n=>{this.error(n)})}next(e){this.forEachObserver(r=>{r.next(e)})}error(e){this.forEachObserver(r=>{r.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,r,n){let i;if(e===void 0&&r===void 0&&n===void 0)throw new Error("Missing Observer.");dP(e,["next","error","complete"])?i=e:i={next:e,error:r,complete:n},i.next===void 0&&(i.next=Id),i.error===void 0&&(i.error=Id),i.complete===void 0&&(i.complete=Id);const s=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch{}}),this.observers.push(i),s}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let r=0;r<this.observers.length;r++)this.sendOne(r,e)}sendOne(e,r){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{r(this.observers[e])}catch(n){typeof console<"u"&&console.error&&console.error(n)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function dP(t,e){if(typeof t!="object"||t===null)return!1;for(const r of e)if(r in t&&typeof t[r]=="function")return!0;return!1}function Id(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Jt(t){return t&&t._delegate?t._delegate:t}class is{constructor(e,r,n){this.name=e,this.instanceFactory=r,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fa="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pP{constructor(e,r){this.name=e,this.container=r,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const r=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(r)){const n=new QN;if(this.instancesDeferred.set(r,n),this.isInitialized(r)||this.shouldAutoInitialize())try{const i=this.getOrInitializeService({instanceIdentifier:r});i&&n.resolve(i)}catch{}}return this.instancesDeferred.get(r).promise}getImmediate(e){var r;const n=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),i=(r=e==null?void 0:e.optional)!==null&&r!==void 0?r:!1;if(this.isInitialized(n)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:n})}catch(s){if(i)return null;throw s}else{if(i)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(gP(e))try{this.getOrInitializeService({instanceIdentifier:fa})}catch{}for(const[r,n]of this.instancesDeferred.entries()){const i=this.normalizeInstanceIdentifier(r);try{const s=this.getOrInitializeService({instanceIdentifier:i});n.resolve(s)}catch{}}}}clearInstance(e=fa){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(r=>"INTERNAL"in r).map(r=>r.INTERNAL.delete()),...e.filter(r=>"_delete"in r).map(r=>r._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=fa){return this.instances.has(e)}getOptions(e=fa){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:r={}}=e,n=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(n))throw Error(`${this.name}(${n}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const i=this.getOrInitializeService({instanceIdentifier:n,options:r});for(const[s,a]of this.instancesDeferred.entries()){const o=this.normalizeInstanceIdentifier(s);n===o&&a.resolve(i)}return i}onInit(e,r){var n;const i=this.normalizeInstanceIdentifier(r),s=(n=this.onInitCallbacks.get(i))!==null&&n!==void 0?n:new Set;s.add(e),this.onInitCallbacks.set(i,s);const a=this.instances.get(i);return a&&e(a,i),()=>{s.delete(e)}}invokeOnInitCallbacks(e,r){const n=this.onInitCallbacks.get(r);if(n)for(const i of n)try{i(e,r)}catch{}}getOrInitializeService({instanceIdentifier:e,options:r={}}){let n=this.instances.get(e);if(!n&&this.component&&(n=this.component.instanceFactory(this.container,{instanceIdentifier:mP(e),options:r}),this.instances.set(e,n),this.instancesOptions.set(e,r),this.invokeOnInitCallbacks(n,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,n)}catch{}return n||null}normalizeInstanceIdentifier(e=fa){return this.component?this.component.multipleInstances?e:fa:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function mP(t){return t===fa?void 0:t}function gP(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vP{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const r=this.getProvider(e.name);if(r.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);r.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const r=new pP(e,this);return this.providers.set(e,r),r}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Ye;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(Ye||(Ye={}));const xP={debug:Ye.DEBUG,verbose:Ye.VERBOSE,info:Ye.INFO,warn:Ye.WARN,error:Ye.ERROR,silent:Ye.SILENT},_P=Ye.INFO,yP={[Ye.DEBUG]:"log",[Ye.VERBOSE]:"log",[Ye.INFO]:"info",[Ye.WARN]:"warn",[Ye.ERROR]:"error"},wP=(t,e,...r)=>{if(e<t.logLevel)return;const n=new Date().toISOString(),i=yP[e];if(i)console[i](`[${n}]  ${t.name}:`,...r);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class Fg{constructor(e){this.name=e,this._logLevel=_P,this._logHandler=wP,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Ye))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?xP[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Ye.DEBUG,...e),this._logHandler(this,Ye.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Ye.VERBOSE,...e),this._logHandler(this,Ye.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Ye.INFO,...e),this._logHandler(this,Ye.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Ye.WARN,...e),this._logHandler(this,Ye.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Ye.ERROR,...e),this._logHandler(this,Ye.ERROR,...e)}}const EP=(t,e)=>e.some(r=>t instanceof r);let i_,s_;function TP(){return i_||(i_=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function kP(){return s_||(s_=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const gT=new WeakMap,Gp=new WeakMap,vT=new WeakMap,Cd=new WeakMap,Dg=new WeakMap;function SP(t){const e=new Promise((r,n)=>{const i=()=>{t.removeEventListener("success",s),t.removeEventListener("error",a)},s=()=>{r($s(t.result)),i()},a=()=>{n(t.error),i()};t.addEventListener("success",s),t.addEventListener("error",a)});return e.then(r=>{r instanceof IDBCursor&&gT.set(r,t)}).catch(()=>{}),Dg.set(e,t),e}function AP(t){if(Gp.has(t))return;const e=new Promise((r,n)=>{const i=()=>{t.removeEventListener("complete",s),t.removeEventListener("error",a),t.removeEventListener("abort",a)},s=()=>{r(),i()},a=()=>{n(t.error||new DOMException("AbortError","AbortError")),i()};t.addEventListener("complete",s),t.addEventListener("error",a),t.addEventListener("abort",a)});Gp.set(t,e)}let Kp={get(t,e,r){if(t instanceof IDBTransaction){if(e==="done")return Gp.get(t);if(e==="objectStoreNames")return t.objectStoreNames||vT.get(t);if(e==="store")return r.objectStoreNames[1]?void 0:r.objectStore(r.objectStoreNames[0])}return $s(t[e])},set(t,e,r){return t[e]=r,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function IP(t){Kp=t(Kp)}function CP(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...r){const n=t.call(Rd(this),e,...r);return vT.set(n,e.sort?e.sort():[e]),$s(n)}:kP().includes(t)?function(...e){return t.apply(Rd(this),e),$s(gT.get(this))}:function(...e){return $s(t.apply(Rd(this),e))}}function RP(t){return typeof t=="function"?CP(t):(t instanceof IDBTransaction&&AP(t),EP(t,TP())?new Proxy(t,Kp):t)}function $s(t){if(t instanceof IDBRequest)return SP(t);if(Cd.has(t))return Cd.get(t);const e=RP(t);return e!==t&&(Cd.set(t,e),Dg.set(e,t)),e}const Rd=t=>Dg.get(t);function NP(t,e,{blocked:r,upgrade:n,blocking:i,terminated:s}={}){const a=indexedDB.open(t,e),o=$s(a);return n&&a.addEventListener("upgradeneeded",l=>{n($s(a.result),l.oldVersion,l.newVersion,$s(a.transaction),l)}),r&&a.addEventListener("blocked",l=>r(l.oldVersion,l.newVersion,l)),o.then(l=>{s&&l.addEventListener("close",()=>s()),i&&l.addEventListener("versionchange",c=>i(c.oldVersion,c.newVersion,c))}).catch(()=>{}),o}const PP=["get","getKey","getAll","getAllKeys","count"],FP=["put","add","delete","clear"],Nd=new Map;function a_(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(Nd.get(e))return Nd.get(e);const r=e.replace(/FromIndex$/,""),n=e!==r,i=FP.includes(r);if(!(r in(n?IDBIndex:IDBObjectStore).prototype)||!(i||PP.includes(r)))return;const s=async function(a,...o){const l=this.transaction(a,i?"readwrite":"readonly");let c=l.store;return n&&(c=c.index(o.shift())),(await Promise.all([c[r](...o),i&&l.done]))[0]};return Nd.set(e,s),s}IP(t=>({...t,get:(e,r,n)=>a_(e,r)||t.get(e,r,n),has:(e,r)=>!!a_(e,r)||t.has(e,r)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DP{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(r=>{if(bP(r)){const n=r.getImmediate();return`${n.library}/${n.version}`}else return null}).filter(r=>r).join(" ")}}function bP(t){const e=t.getComponent();return(e==null?void 0:e.type)==="VERSION"}const qp="@firebase/app",o_="0.10.13";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ss=new Fg("@firebase/app"),OP="@firebase/app-compat",LP="@firebase/analytics-compat",MP="@firebase/analytics",VP="@firebase/app-check-compat",UP="@firebase/app-check",jP="@firebase/auth",BP="@firebase/auth-compat",zP="@firebase/database",$P="@firebase/data-connect",HP="@firebase/database-compat",WP="@firebase/functions",GP="@firebase/functions-compat",KP="@firebase/installations",qP="@firebase/installations-compat",XP="@firebase/messaging",YP="@firebase/messaging-compat",QP="@firebase/performance",JP="@firebase/performance-compat",ZP="@firebase/remote-config",eF="@firebase/remote-config-compat",tF="@firebase/storage",rF="@firebase/storage-compat",nF="@firebase/firestore",iF="@firebase/vertexai-preview",sF="@firebase/firestore-compat",aF="firebase",oF="10.14.1";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xp="[DEFAULT]",lF={[qp]:"fire-core",[OP]:"fire-core-compat",[MP]:"fire-analytics",[LP]:"fire-analytics-compat",[UP]:"fire-app-check",[VP]:"fire-app-check-compat",[jP]:"fire-auth",[BP]:"fire-auth-compat",[zP]:"fire-rtdb",[$P]:"fire-data-connect",[HP]:"fire-rtdb-compat",[WP]:"fire-fn",[GP]:"fire-fn-compat",[KP]:"fire-iid",[qP]:"fire-iid-compat",[XP]:"fire-fcm",[YP]:"fire-fcm-compat",[QP]:"fire-perf",[JP]:"fire-perf-compat",[ZP]:"fire-rc",[eF]:"fire-rc-compat",[tF]:"fire-gcs",[rF]:"fire-gcs-compat",[nF]:"fire-fst",[sF]:"fire-fst-compat",[iF]:"fire-vertex","fire-js":"fire-js",[aF]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Sh=new Map,cF=new Map,Yp=new Map;function l_(t,e){try{t.container.addComponent(e)}catch(r){ss.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,r)}}function Xs(t){const e=t.name;if(Yp.has(e))return ss.debug(`There were multiple attempts to register component ${e}.`),!1;Yp.set(e,t);for(const r of Sh.values())l_(r,t);for(const r of cF.values())l_(r,t);return!0}function xu(t,e){const r=t.container.getProvider("heartbeat").getImmediate({optional:!0});return r&&r.triggerHeartbeat(),t.container.getProvider(e)}function $i(t){return t.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uF={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Hs=new gu("app","Firebase",uF);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fF{constructor(e,r,n){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},r),this._name=r.name,this._automaticDataCollectionEnabled=r.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new is("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Hs.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ga=oF;function xT(t,e={}){let r=t;typeof e!="object"&&(e={name:e});const n=Object.assign({name:Xp,automaticDataCollectionEnabled:!1},e),i=n.name;if(typeof i!="string"||!i)throw Hs.create("bad-app-name",{appName:String(i)});if(r||(r=dT()),!r)throw Hs.create("no-options");const s=Sh.get(i);if(s){if(kh(r,s.options)&&kh(n,s.config))return s;throw Hs.create("duplicate-app",{appName:i})}const a=new vP(i);for(const l of Yp.values())a.addComponent(l);const o=new fF(r,n,a);return Sh.set(i,o),o}function y0(t=Xp){const e=Sh.get(t);if(!e&&t===Xp&&dT())return xT();if(!e)throw Hs.create("no-app",{appName:t});return e}function On(t,e,r){var n;let i=(n=lF[t])!==null&&n!==void 0?n:t;r&&(i+=`-${r}`);const s=i.match(/\s|\//),a=e.match(/\s|\//);if(s||a){const o=[`Unable to register library "${i}" with version "${e}":`];s&&o.push(`library name "${i}" contains illegal characters (whitespace or "/")`),s&&a&&o.push("and"),a&&o.push(`version name "${e}" contains illegal characters (whitespace or "/")`),ss.warn(o.join(" "));return}Xs(new is(`${i}-version`,()=>({library:i,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hF="firebase-heartbeat-database",dF=1,Wc="firebase-heartbeat-store";let Pd=null;function _T(){return Pd||(Pd=NP(hF,dF,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(Wc)}catch(r){console.warn(r)}}}}).catch(t=>{throw Hs.create("idb-open",{originalErrorMessage:t.message})})),Pd}async function pF(t){try{const r=(await _T()).transaction(Wc),n=await r.objectStore(Wc).get(yT(t));return await r.done,n}catch(e){if(e instanceof Ai)ss.warn(e.message);else{const r=Hs.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});ss.warn(r.message)}}}async function c_(t,e){try{const n=(await _T()).transaction(Wc,"readwrite");await n.objectStore(Wc).put(e,yT(t)),await n.done}catch(r){if(r instanceof Ai)ss.warn(r.message);else{const n=Hs.create("idb-set",{originalErrorMessage:r==null?void 0:r.message});ss.warn(n.message)}}}function yT(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mF=1024,gF=30*24*60*60*1e3;class vF{constructor(e){this.container=e,this._heartbeatsCache=null;const r=this.container.getProvider("app").getImmediate();this._storage=new _F(r),this._heartbeatsCachePromise=this._storage.read().then(n=>(this._heartbeatsCache=n,n))}async triggerHeartbeat(){var e,r;try{const i=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),s=u_();return((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((r=this._heartbeatsCache)===null||r===void 0?void 0:r.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===s||this._heartbeatsCache.heartbeats.some(a=>a.date===s)?void 0:(this._heartbeatsCache.heartbeats.push({date:s,agent:i}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(a=>{const o=new Date(a.date).valueOf();return Date.now()-o<=gF}),this._storage.overwrite(this._heartbeatsCache))}catch(n){ss.warn(n)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const r=u_(),{heartbeatsToSend:n,unsentEntries:i}=xF(this._heartbeatsCache.heartbeats),s=Th(JSON.stringify({version:2,heartbeats:n}));return this._heartbeatsCache.lastSentHeartbeatDate=r,i.length>0?(this._heartbeatsCache.heartbeats=i,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),s}catch(r){return ss.warn(r),""}}}function u_(){return new Date().toISOString().substring(0,10)}function xF(t,e=mF){const r=[];let n=t.slice();for(const i of t){const s=r.find(a=>a.agent===i.agent);if(s){if(s.dates.push(i.date),f_(r)>e){s.dates.pop();break}}else if(r.push({agent:i.agent,dates:[i.date]}),f_(r)>e){r.pop();break}n=n.slice(1)}return{heartbeatsToSend:r,unsentEntries:n}}class _F{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return sP()?aP().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const r=await pF(this.app);return r!=null&&r.heartbeats?r:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){var r;if(await this._canUseIndexedDBPromise){const i=await this.read();return c_(this.app,{lastSentHeartbeatDate:(r=e.lastSentHeartbeatDate)!==null&&r!==void 0?r:i.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var r;if(await this._canUseIndexedDBPromise){const i=await this.read();return c_(this.app,{lastSentHeartbeatDate:(r=e.lastSentHeartbeatDate)!==null&&r!==void 0?r:i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...e.heartbeats]})}else return}}function f_(t){return Th(JSON.stringify({version:2,heartbeats:t})).length}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yF(t){Xs(new is("platform-logger",e=>new DP(e),"PRIVATE")),Xs(new is("heartbeat",e=>new vF(e),"PRIVATE")),On(qp,o_,t),On(qp,o_,"esm2017"),On("fire-js","")}yF("");function bg(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(t);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(t,n[i])&&(r[n[i]]=t[n[i]]);return r}function wT(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const wF=wT,ET=new gu("auth","Firebase",wT());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ah=new Fg("@firebase/auth");function EF(t,...e){Ah.logLevel<=Ye.WARN&&Ah.warn(`Auth (${Ga}): ${t}`,...e)}function jf(t,...e){Ah.logLevel<=Ye.ERROR&&Ah.error(`Auth (${Ga}): ${t}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wi(t,...e){throw Lg(t,...e)}function ri(t,...e){return Lg(t,...e)}function Og(t,e,r){const n=Object.assign(Object.assign({},wF()),{[e]:r});return new gu("auth","Firebase",n).create(e,{appName:t.name})}function ka(t){return Og(t,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function TF(t,e,r){const n=r;if(!(e instanceof n))throw n.name!==e.constructor.name&&wi(t,"argument-error"),Og(t,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function Lg(t,...e){if(typeof t!="string"){const r=e[0],n=[...e.slice(1)];return n[0]&&(n[0].appName=t.name),t._errorFactory.create(r,...n)}return ET.create(t,...e)}function Le(t,e,...r){if(!t)throw Lg(e,...r)}function Hi(t){const e="INTERNAL ASSERTION FAILED: "+t;throw jf(e),new Error(e)}function as(t,e){t||Hi(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Qp(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.href)||""}function kF(){return h_()==="http:"||h_()==="https:"}function h_(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function SF(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(kF()||tP()||"connection"in navigator)?navigator.onLine:!0}function AF(){if(typeof navigator>"u")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _u{constructor(e,r){this.shortDelay=e,this.longDelay=r,as(r>e,"Short delay should be less than long delay!"),this.isMobile=JN()||rP()}get(){return SF()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Mg(t,e){as(t.emulator,"Emulator should always be set here");const{url:r}=t.emulator;return e?`${r}${e.startsWith("/")?e.slice(1):e}`:r}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TT{static initialize(e,r,n){this.fetchImpl=e,r&&(this.headersImpl=r),n&&(this.responseImpl=n)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Hi("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Hi("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Hi("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const IF={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const CF=new _u(3e4,6e4);function Vg(t,e){return t.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:t.tenantId}):e}async function dl(t,e,r,n,i={}){return kT(t,i,async()=>{let s={},a={};n&&(e==="GET"?a=n:s={body:JSON.stringify(n)});const o=vu(Object.assign({key:t.config.apiKey},a)).slice(1),l=await t._getAdditionalHeaders();l["Content-Type"]="application/json",t.languageCode&&(l["X-Firebase-Locale"]=t.languageCode);const c=Object.assign({method:e,headers:l},s);return eP()||(c.referrerPolicy="no-referrer"),TT.fetch()(ST(t,t.config.apiHost,r,o),c)})}async function kT(t,e,r){t._canInitEmulator=!1;const n=Object.assign(Object.assign({},IF),e);try{const i=new NF(t),s=await Promise.race([r(),i.promise]);i.clearNetworkTimeout();const a=await s.json();if("needConfirmation"in a)throw hf(t,"account-exists-with-different-credential",a);if(s.ok&&!("errorMessage"in a))return a;{const o=s.ok?a.errorMessage:a.error.message,[l,c]=o.split(" : ");if(l==="FEDERATED_USER_ID_ALREADY_LINKED")throw hf(t,"credential-already-in-use",a);if(l==="EMAIL_EXISTS")throw hf(t,"email-already-in-use",a);if(l==="USER_DISABLED")throw hf(t,"user-disabled",a);const u=n[l]||l.toLowerCase().replace(/[_\s]+/g,"-");if(c)throw Og(t,u,c);wi(t,u)}}catch(i){if(i instanceof Ai)throw i;wi(t,"network-request-failed",{message:String(i)})}}async function RF(t,e,r,n,i={}){const s=await dl(t,e,r,n,i);return"mfaPendingCredential"in s&&wi(t,"multi-factor-auth-required",{_serverResponse:s}),s}function ST(t,e,r,n){const i=`${e}${r}?${n}`;return t.config.emulator?Mg(t.config,i):`${t.config.apiScheme}://${i}`}class NF{constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((r,n)=>{this.timer=setTimeout(()=>n(ri(this.auth,"network-request-failed")),CF.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}}function hf(t,e,r){const n={appName:t.name};r.email&&(n.email=r.email),r.phoneNumber&&(n.phoneNumber=r.phoneNumber);const i=ri(t,e,n);return i.customData._tokenResponse=r,i}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function PF(t,e){return dl(t,"POST","/v1/accounts:delete",e)}async function AT(t,e){return dl(t,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fc(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function IT(t,e=!1){const r=Jt(t),n=await r.getIdToken(e),i=Ug(n);Le(i&&i.exp&&i.auth_time&&i.iat,r.auth,"internal-error");const s=typeof i.firebase=="object"?i.firebase:void 0,a=s==null?void 0:s.sign_in_provider;return{claims:i,token:n,authTime:fc(Fd(i.auth_time)),issuedAtTime:fc(Fd(i.iat)),expirationTime:fc(Fd(i.exp)),signInProvider:a||null,signInSecondFactor:(s==null?void 0:s.sign_in_second_factor)||null}}function Fd(t){return Number(t)*1e3}function Ug(t){const[e,r,n]=t.split(".");if(e===void 0||r===void 0||n===void 0)return jf("JWT malformed, contained fewer than 3 sections"),null;try{const i=fT(r);return i?JSON.parse(i):(jf("Failed to decode base64 JWT payload"),null)}catch(i){return jf("Caught error parsing JWT payload as JSON",i==null?void 0:i.toString()),null}}function d_(t){const e=Ug(t);return Le(e,"internal-error"),Le(typeof e.exp<"u","internal-error"),Le(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Gc(t,e,r=!1){if(r)return e;try{return await e}catch(n){throw n instanceof Ai&&FF(n)&&t.auth.currentUser===t&&await t.auth.signOut(),n}}function FF({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DF{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var r;if(e){const n=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),n}else{this.errorBackoff=3e4;const i=((r=this.user.stsTokenManager.expirationTime)!==null&&r!==void 0?r:0)-Date.now()-3e5;return Math.max(0,i)}}schedule(e=!1){if(!this.isRunning)return;const r=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},r)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jp{constructor(e,r){this.createdAt=e,this.lastLoginAt=r,this._initializeTime()}_initializeTime(){this.lastSignInTime=fc(this.lastLoginAt),this.creationTime=fc(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Ih(t){var e;const r=t.auth,n=await t.getIdToken(),i=await Gc(t,AT(r,{idToken:n}));Le(i==null?void 0:i.users.length,r,"internal-error");const s=i.users[0];t._notifyReloadListener(s);const a=!((e=s.providerUserInfo)===null||e===void 0)&&e.length?CT(s.providerUserInfo):[],o=OF(t.providerData,a),l=t.isAnonymous,c=!(t.email&&s.passwordHash)&&!(o!=null&&o.length),u=l?c:!1,h={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:o,metadata:new Jp(s.createdAt,s.lastLoginAt),isAnonymous:u};Object.assign(t,h)}async function bF(t){const e=Jt(t);await Ih(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function OF(t,e){return[...t.filter(n=>!e.some(i=>i.providerId===n.providerId)),...e]}function CT(t){return t.map(e=>{var{providerId:r}=e,n=bg(e,["providerId"]);return{providerId:r,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function LF(t,e){const r=await kT(t,{},async()=>{const n=vu({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:i,apiKey:s}=t.config,a=ST(t,i,"/v1/token",`key=${s}`),o=await t._getAdditionalHeaders();return o["Content-Type"]="application/x-www-form-urlencoded",TT.fetch()(a,{method:"POST",headers:o,body:n})});return{accessToken:r.access_token,expiresIn:r.expires_in,refreshToken:r.refresh_token}}async function MF(t,e){return dl(t,"POST","/v2/accounts:revokeToken",Vg(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mo{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){Le(e.idToken,"internal-error"),Le(typeof e.idToken<"u","internal-error"),Le(typeof e.refreshToken<"u","internal-error");const r="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):d_(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,r)}updateFromIdToken(e){Le(e.length!==0,"internal-error");const r=d_(e);this.updateTokensAndExpiration(e,null,r)}async getToken(e,r=!1){return!r&&this.accessToken&&!this.isExpired?this.accessToken:(Le(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,r){const{accessToken:n,refreshToken:i,expiresIn:s}=await LF(e,r);this.updateTokensAndExpiration(n,i,Number(s))}updateTokensAndExpiration(e,r,n){this.refreshToken=r||null,this.accessToken=e||null,this.expirationTime=Date.now()+n*1e3}static fromJSON(e,r){const{refreshToken:n,accessToken:i,expirationTime:s}=r,a=new Mo;return n&&(Le(typeof n=="string","internal-error",{appName:e}),a.refreshToken=n),i&&(Le(typeof i=="string","internal-error",{appName:e}),a.accessToken=i),s&&(Le(typeof s=="number","internal-error",{appName:e}),a.expirationTime=s),a}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new Mo,this.toJSON())}_performRefresh(){return Hi("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xs(t,e){Le(typeof t=="string"||typeof t>"u","internal-error",{appName:e})}class Wi{constructor(e){var{uid:r,auth:n,stsTokenManager:i}=e,s=bg(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new DF(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=r,this.auth=n,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=s.displayName||null,this.email=s.email||null,this.emailVerified=s.emailVerified||!1,this.phoneNumber=s.phoneNumber||null,this.photoURL=s.photoURL||null,this.isAnonymous=s.isAnonymous||!1,this.tenantId=s.tenantId||null,this.providerData=s.providerData?[...s.providerData]:[],this.metadata=new Jp(s.createdAt||void 0,s.lastLoginAt||void 0)}async getIdToken(e){const r=await Gc(this,this.stsTokenManager.getToken(this.auth,e));return Le(r,this.auth,"internal-error"),this.accessToken!==r&&(this.accessToken=r,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),r}getIdTokenResult(e){return IT(this,e)}reload(){return bF(this)}_assign(e){this!==e&&(Le(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(r=>Object.assign({},r)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const r=new Wi(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return r.metadata._copy(this.metadata),r}_onReload(e){Le(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,r=!1){let n=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),n=!0),r&&await Ih(this),await this.auth._persistUserIfCurrent(this),n&&this.auth._notifyListenersIfCurrent(this)}async delete(){if($i(this.auth.app))return Promise.reject(ka(this.auth));const e=await this.getIdToken();return await Gc(this,PF(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,r){var n,i,s,a,o,l,c,u;const h=(n=r.displayName)!==null&&n!==void 0?n:void 0,d=(i=r.email)!==null&&i!==void 0?i:void 0,p=(s=r.phoneNumber)!==null&&s!==void 0?s:void 0,x=(a=r.photoURL)!==null&&a!==void 0?a:void 0,v=(o=r.tenantId)!==null&&o!==void 0?o:void 0,E=(l=r._redirectEventId)!==null&&l!==void 0?l:void 0,T=(c=r.createdAt)!==null&&c!==void 0?c:void 0,w=(u=r.lastLoginAt)!==null&&u!==void 0?u:void 0,{uid:y,emailVerified:R,isAnonymous:M,providerData:j,stsTokenManager:g}=r;Le(y&&g,e,"internal-error");const k=Mo.fromJSON(this.name,g);Le(typeof y=="string",e,"internal-error"),xs(h,e.name),xs(d,e.name),Le(typeof R=="boolean",e,"internal-error"),Le(typeof M=="boolean",e,"internal-error"),xs(p,e.name),xs(x,e.name),xs(v,e.name),xs(E,e.name),xs(T,e.name),xs(w,e.name);const S=new Wi({uid:y,auth:e,email:d,emailVerified:R,displayName:h,isAnonymous:M,photoURL:x,phoneNumber:p,tenantId:v,stsTokenManager:k,createdAt:T,lastLoginAt:w});return j&&Array.isArray(j)&&(S.providerData=j.map(C=>Object.assign({},C))),E&&(S._redirectEventId=E),S}static async _fromIdTokenResponse(e,r,n=!1){const i=new Mo;i.updateFromServerResponse(r);const s=new Wi({uid:r.localId,auth:e,stsTokenManager:i,isAnonymous:n});return await Ih(s),s}static async _fromGetAccountInfoResponse(e,r,n){const i=r.users[0];Le(i.localId!==void 0,"internal-error");const s=i.providerUserInfo!==void 0?CT(i.providerUserInfo):[],a=!(i.email&&i.passwordHash)&&!(s!=null&&s.length),o=new Mo;o.updateFromIdToken(n);const l=new Wi({uid:i.localId,auth:e,stsTokenManager:o,isAnonymous:a}),c={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:s,metadata:new Jp(i.createdAt,i.lastLoginAt),isAnonymous:!(i.email&&i.passwordHash)&&!(s!=null&&s.length)};return Object.assign(l,c),l}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const p_=new Map;function Gi(t){as(t instanceof Function,"Expected a class definition");let e=p_.get(t);return e?(as(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,p_.set(t,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RT{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,r){this.storage[e]=r}async _get(e){const r=this.storage[e];return r===void 0?null:r}async _remove(e){delete this.storage[e]}_addListener(e,r){}_removeListener(e,r){}}RT.type="NONE";const m_=RT;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Bf(t,e,r){return`firebase:${t}:${e}:${r}`}class Vo{constructor(e,r,n){this.persistence=e,this.auth=r,this.userKey=n;const{config:i,name:s}=this.auth;this.fullUserKey=Bf(this.userKey,i.apiKey,s),this.fullPersistenceKey=Bf("persistence",i.apiKey,s),this.boundEventHandler=r._onStorageEvent.bind(r),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);return e?Wi._fromJSON(this.auth,e):null}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const r=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,r)return this.setCurrentUser(r)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,r,n="authUser"){if(!r.length)return new Vo(Gi(m_),e,n);const i=(await Promise.all(r.map(async c=>{if(await c._isAvailable())return c}))).filter(c=>c);let s=i[0]||Gi(m_);const a=Bf(n,e.config.apiKey,e.name);let o=null;for(const c of r)try{const u=await c._get(a);if(u){const h=Wi._fromJSON(e,u);c!==s&&(o=h),s=c;break}}catch{}const l=i.filter(c=>c._shouldAllowMigration);return!s._shouldAllowMigration||!l.length?new Vo(s,e,n):(s=l[0],o&&await s._set(a,o.toJSON()),await Promise.all(r.map(async c=>{if(c!==s)try{await c._remove(a)}catch{}})),new Vo(s,e,n))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function g_(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(DT(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(NT(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(OT(e))return"Blackberry";if(LT(e))return"Webos";if(PT(e))return"Safari";if((e.includes("chrome/")||FT(e))&&!e.includes("edge/"))return"Chrome";if(bT(e))return"Android";{const r=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,n=t.match(r);if((n==null?void 0:n.length)===2)return n[1]}return"Other"}function NT(t=jr()){return/firefox\//i.test(t)}function PT(t=jr()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function FT(t=jr()){return/crios\//i.test(t)}function DT(t=jr()){return/iemobile/i.test(t)}function bT(t=jr()){return/android/i.test(t)}function OT(t=jr()){return/blackberry/i.test(t)}function LT(t=jr()){return/webos/i.test(t)}function jg(t=jr()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function VF(t=jr()){var e;return jg(t)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function UF(){return nP()&&document.documentMode===10}function MT(t=jr()){return jg(t)||bT(t)||LT(t)||OT(t)||/windows phone/i.test(t)||DT(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function VT(t,e=[]){let r;switch(t){case"Browser":r=g_(jr());break;case"Worker":r=`${g_(jr())}-${t}`;break;default:r=t}const n=e.length?e.join(","):"FirebaseCore-web";return`${r}/JsCore/${Ga}/${n}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jF{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,r){const n=s=>new Promise((a,o)=>{try{const l=e(s);a(l)}catch(l){o(l)}});n.onAbort=r,this.queue.push(n);const i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const r=[];try{for(const n of this.queue)await n(e),n.onAbort&&r.push(n.onAbort)}catch(n){r.reverse();for(const i of r)try{i()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:n==null?void 0:n.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function BF(t,e={}){return dl(t,"GET","/v2/passwordPolicy",Vg(t,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zF=6;class $F{constructor(e){var r,n,i,s;const a=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(r=a.minPasswordLength)!==null&&r!==void 0?r:zF,a.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=a.maxPasswordLength),a.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=a.containsLowercaseCharacter),a.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=a.containsUppercaseCharacter),a.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=a.containsNumericCharacter),a.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=a.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(i=(n=e.allowedNonAlphanumericCharacters)===null||n===void 0?void 0:n.join(""))!==null&&i!==void 0?i:"",this.forceUpgradeOnSignin=(s=e.forceUpgradeOnSignin)!==null&&s!==void 0?s:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var r,n,i,s,a,o;const l={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,l),this.validatePasswordCharacterOptions(e,l),l.isValid&&(l.isValid=(r=l.meetsMinPasswordLength)!==null&&r!==void 0?r:!0),l.isValid&&(l.isValid=(n=l.meetsMaxPasswordLength)!==null&&n!==void 0?n:!0),l.isValid&&(l.isValid=(i=l.containsLowercaseLetter)!==null&&i!==void 0?i:!0),l.isValid&&(l.isValid=(s=l.containsUppercaseLetter)!==null&&s!==void 0?s:!0),l.isValid&&(l.isValid=(a=l.containsNumericCharacter)!==null&&a!==void 0?a:!0),l.isValid&&(l.isValid=(o=l.containsNonAlphanumericCharacter)!==null&&o!==void 0?o:!0),l}validatePasswordLengthOptions(e,r){const n=this.customStrengthOptions.minPasswordLength,i=this.customStrengthOptions.maxPasswordLength;n&&(r.meetsMinPasswordLength=e.length>=n),i&&(r.meetsMaxPasswordLength=e.length<=i)}validatePasswordCharacterOptions(e,r){this.updatePasswordCharacterOptionsStatuses(r,!1,!1,!1,!1);let n;for(let i=0;i<e.length;i++)n=e.charAt(i),this.updatePasswordCharacterOptionsStatuses(r,n>="a"&&n<="z",n>="A"&&n<="Z",n>="0"&&n<="9",this.allowedNonAlphanumericCharacters.includes(n))}updatePasswordCharacterOptionsStatuses(e,r,n,i,s){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=r)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=n)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=i)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HF{constructor(e,r,n,i){this.app=e,this.heartbeatServiceProvider=r,this.appCheckServiceProvider=n,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new v_(this),this.idTokenSubscription=new v_(this),this.beforeStateQueue=new jF(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=ET,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=i.sdkClientVersion}_initializeWithPersistence(e,r){return r&&(this._popupRedirectResolver=Gi(r)),this._initializationPromise=this.queue(async()=>{var n,i;if(!this._deleted&&(this.persistenceManager=await Vo.create(this,e),!this._deleted)){if(!((n=this._popupRedirectResolver)===null||n===void 0)&&n._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(r),this.lastNotifiedUid=((i=this.currentUser)===null||i===void 0?void 0:i.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const r=await AT(this,{idToken:e}),n=await Wi._fromGetAccountInfoResponse(this,r,e);await this.directlySetCurrentUser(n)}catch(r){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",r),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var r;if($i(this.app)){const a=this.app.settings.authIdToken;return a?new Promise(o=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(a).then(o,o))}):this.directlySetCurrentUser(null)}const n=await this.assertedPersistence.getCurrentUser();let i=n,s=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const a=(r=this.redirectUser)===null||r===void 0?void 0:r._redirectEventId,o=i==null?void 0:i._redirectEventId,l=await this.tryRedirectSignIn(e);(!a||a===o)&&(l!=null&&l.user)&&(i=l.user,s=!0)}if(!i)return this.directlySetCurrentUser(null);if(!i._redirectEventId){if(s)try{await this.beforeStateQueue.runMiddleware(i)}catch(a){i=n,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(a))}return i?this.reloadAndSetCurrentUserOrClear(i):this.directlySetCurrentUser(null)}return Le(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===i._redirectEventId?this.directlySetCurrentUser(i):this.reloadAndSetCurrentUserOrClear(i)}async tryRedirectSignIn(e){let r=null;try{r=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return r}async reloadAndSetCurrentUserOrClear(e){try{await Ih(e)}catch(r){if((r==null?void 0:r.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=AF()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if($i(this.app))return Promise.reject(ka(this));const r=e?Jt(e):null;return r&&Le(r.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(r&&r._clone(this))}async _updateCurrentUser(e,r=!1){if(!this._deleted)return e&&Le(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),r||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return $i(this.app)?Promise.reject(ka(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return $i(this.app)?Promise.reject(ka(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(Gi(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const r=this._getPasswordPolicyInternal();return r.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):r.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await BF(this),r=new $F(e);this.tenantId===null?this._projectPasswordPolicy=r:this._tenantPasswordPolicies[this.tenantId]=r}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(e){this._errorFactory=new gu("auth","Firebase",e())}onAuthStateChanged(e,r,n){return this.registerStateListener(this.authStateSubscription,e,r,n)}beforeAuthStateChanged(e,r){return this.beforeStateQueue.pushCallback(e,r)}onIdTokenChanged(e,r,n){return this.registerStateListener(this.idTokenSubscription,e,r,n)}authStateReady(){return new Promise((e,r)=>{if(this.currentUser)e();else{const n=this.onAuthStateChanged(()=>{n(),e()},r)}})}async revokeAccessToken(e){if(this.currentUser){const r=await this.currentUser.getIdToken(),n={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:r};this.tenantId!=null&&(n.tenantId=this.tenantId),await MF(this,n)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}async _setRedirectUser(e,r){const n=await this.getOrInitRedirectPersistenceManager(r);return e===null?n.removeCurrentUser():n.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const r=e&&Gi(e)||this._popupRedirectResolver;Le(r,this,"argument-error"),this.redirectPersistenceManager=await Vo.create(this,[Gi(r._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var r,n;return this._isInitialized&&await this.queue(async()=>{}),((r=this._currentUser)===null||r===void 0?void 0:r._redirectEventId)===e?this._currentUser:((n=this.redirectUser)===null||n===void 0?void 0:n._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,r;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const n=(r=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&r!==void 0?r:null;this.lastNotifiedUid!==n&&(this.lastNotifiedUid=n,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,r,n,i){if(this._deleted)return()=>{};const s=typeof r=="function"?r:r.next.bind(r);let a=!1;const o=this._isInitialized?Promise.resolve():this._initializationPromise;if(Le(o,this,"internal-error"),o.then(()=>{a||s(this.currentUser)}),typeof r=="function"){const l=e.addObserver(r,n,i);return()=>{a=!0,l()}}else{const l=e.addObserver(r);return()=>{a=!0,l()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return Le(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=VT(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const r={"X-Client-Version":this.clientVersion};this.app.options.appId&&(r["X-Firebase-gmpid"]=this.app.options.appId);const n=await((e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader());n&&(r["X-Firebase-Client"]=n);const i=await this._getAppCheckToken();return i&&(r["X-Firebase-AppCheck"]=i),r}async _getAppCheckToken(){var e;const r=await((e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken());return r!=null&&r.error&&EF(`Error while retrieving App Check token: ${r.error}`),r==null?void 0:r.token}}function w0(t){return Jt(t)}class v_{constructor(e){this.auth=e,this.observer=null,this.addObserver=fP(r=>this.observer=r)}get next(){return Le(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Bg={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function WF(t){Bg=t}function GF(t){return Bg.loadJS(t)}function KF(){return Bg.gapiScript}function qF(t){return`__${t}${Math.floor(Math.random()*1e6)}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function XF(t,e){const r=xu(t,"auth");if(r.isInitialized()){const i=r.getImmediate(),s=r.getOptions();if(kh(s,e??{}))return i;wi(i,"already-initialized")}return r.initialize({options:e})}function YF(t,e){const r=(e==null?void 0:e.persistence)||[],n=(Array.isArray(r)?r:[r]).map(Gi);e!=null&&e.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(n,e==null?void 0:e.popupRedirectResolver)}function QF(t,e,r){const n=w0(t);Le(n._canInitEmulator,n,"emulator-config-failed"),Le(/^https?:\/\//.test(e),n,"invalid-emulator-scheme");const i=!1,s=UT(e),{host:a,port:o}=JF(e),l=o===null?"":`:${o}`;n.config.emulator={url:`${s}//${a}${l}/`},n.settings.appVerificationDisabledForTesting=!0,n.emulatorConfig=Object.freeze({host:a,port:o,protocol:s.replace(":",""),options:Object.freeze({disableWarnings:i})}),ZF()}function UT(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function JF(t){const e=UT(t),r=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!r)return{host:"",port:null};const n=r[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(n);if(i){const s=i[1];return{host:s,port:x_(n.substr(s.length+1))}}else{const[s,a]=n.split(":");return{host:s,port:x_(a)}}}function x_(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}function ZF(){function t(){const e=document.createElement("p"),r=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",r.position="fixed",r.width="100%",r.backgroundColor="#ffffff",r.border=".1em solid #000000",r.color="#b50000",r.bottom="0px",r.left="0px",r.margin="0px",r.zIndex="10000",r.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",t):t())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jT{constructor(e,r){this.providerId=e,this.signInMethod=r}toJSON(){return Hi("not implemented")}_getIdTokenResponse(e){return Hi("not implemented")}_linkToIdToken(e,r){return Hi("not implemented")}_getReauthenticationResolver(e){return Hi("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Uo(t,e){return RF(t,"POST","/v1/accounts:signInWithIdp",Vg(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const eD="http://localhost";class ba extends jT{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const r=new ba(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(r.idToken=e.idToken),e.accessToken&&(r.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(r.nonce=e.nonce),e.pendingToken&&(r.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(r.accessToken=e.oauthToken,r.secret=e.oauthTokenSecret):wi("argument-error"),r}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const r=typeof e=="string"?JSON.parse(e):e,{providerId:n,signInMethod:i}=r,s=bg(r,["providerId","signInMethod"]);if(!n||!i)return null;const a=new ba(n,i);return a.idToken=s.idToken||void 0,a.accessToken=s.accessToken||void 0,a.secret=s.secret,a.nonce=s.nonce,a.pendingToken=s.pendingToken||null,a}_getIdTokenResponse(e){const r=this.buildRequest();return Uo(e,r)}_linkToIdToken(e,r){const n=this.buildRequest();return n.idToken=r,Uo(e,n)}_getReauthenticationResolver(e){const r=this.buildRequest();return r.autoCreate=!1,Uo(e,r)}buildRequest(){const e={requestUri:eD,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const r={};this.idToken&&(r.id_token=this.idToken),this.accessToken&&(r.access_token=this.accessToken),this.secret&&(r.oauth_token_secret=this.secret),r.providerId=this.providerId,this.nonce&&!this.pendingToken&&(r.nonce=this.nonce),e.postBody=vu(r)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zg{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yu extends zg{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ss extends yu{constructor(){super("facebook.com")}static credential(e){return ba._fromParams({providerId:Ss.PROVIDER_ID,signInMethod:Ss.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Ss.credentialFromTaggedObject(e)}static credentialFromError(e){return Ss.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Ss.credential(e.oauthAccessToken)}catch{return null}}}Ss.FACEBOOK_SIGN_IN_METHOD="facebook.com";Ss.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mi extends yu{constructor(){super("google.com"),this.addScope("profile")}static credential(e,r){return ba._fromParams({providerId:mi.PROVIDER_ID,signInMethod:mi.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:r})}static credentialFromResult(e){return mi.credentialFromTaggedObject(e)}static credentialFromError(e){return mi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:r,oauthAccessToken:n}=e;if(!r&&!n)return null;try{return mi.credential(r,n)}catch{return null}}}mi.GOOGLE_SIGN_IN_METHOD="google.com";mi.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class As extends yu{constructor(){super("github.com")}static credential(e){return ba._fromParams({providerId:As.PROVIDER_ID,signInMethod:As.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return As.credentialFromTaggedObject(e)}static credentialFromError(e){return As.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return As.credential(e.oauthAccessToken)}catch{return null}}}As.GITHUB_SIGN_IN_METHOD="github.com";As.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Is extends yu{constructor(){super("twitter.com")}static credential(e,r){return ba._fromParams({providerId:Is.PROVIDER_ID,signInMethod:Is.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:r})}static credentialFromResult(e){return Is.credentialFromTaggedObject(e)}static credentialFromError(e){return Is.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:r,oauthTokenSecret:n}=e;if(!r||!n)return null;try{return Is.credential(r,n)}catch{return null}}}Is.TWITTER_SIGN_IN_METHOD="twitter.com";Is.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zo{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,r,n,i=!1){const s=await Wi._fromIdTokenResponse(e,n,i),a=__(n);return new Zo({user:s,providerId:a,_tokenResponse:n,operationType:r})}static async _forOperation(e,r,n){await e._updateTokensIfNecessary(n,!0);const i=__(n);return new Zo({user:e,providerId:i,_tokenResponse:n,operationType:r})}}function __(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ch extends Ai{constructor(e,r,n,i){var s;super(r.code,r.message),this.operationType=n,this.user=i,Object.setPrototypeOf(this,Ch.prototype),this.customData={appName:e.name,tenantId:(s=e.tenantId)!==null&&s!==void 0?s:void 0,_serverResponse:r.customData._serverResponse,operationType:n}}static _fromErrorAndOperation(e,r,n,i){return new Ch(e,r,n,i)}}function BT(t,e,r,n){return(e==="reauthenticate"?r._getReauthenticationResolver(t):r._getIdTokenResponse(t)).catch(s=>{throw s.code==="auth/multi-factor-auth-required"?Ch._fromErrorAndOperation(t,s,e,n):s})}async function tD(t,e,r=!1){const n=await Gc(t,e._linkToIdToken(t.auth,await t.getIdToken()),r);return Zo._forOperation(t,"link",n)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function rD(t,e,r=!1){const{auth:n}=t;if($i(n.app))return Promise.reject(ka(n));const i="reauthenticate";try{const s=await Gc(t,BT(n,i,e,t),r);Le(s.idToken,n,"internal-error");const a=Ug(s.idToken);Le(a,n,"internal-error");const{sub:o}=a;return Le(t.uid===o,n,"user-mismatch"),Zo._forOperation(t,i,s)}catch(s){throw(s==null?void 0:s.code)==="auth/user-not-found"&&wi(n,"user-mismatch"),s}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function nD(t,e,r=!1){if($i(t.app))return Promise.reject(ka(t));const n="signIn",i=await BT(t,n,e),s=await Zo._fromIdTokenResponse(t,n,i);return r||await t._updateCurrentUser(s.user),s}function iD(t,e,r,n){return Jt(t).onIdTokenChanged(e,r,n)}function sD(t,e,r){return Jt(t).beforeAuthStateChanged(e,r)}function zT(t,e,r,n){return Jt(t).onAuthStateChanged(e,r,n)}function aD(t){return Jt(t).signOut()}const Rh="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $T{constructor(e,r){this.storageRetriever=e,this.type=r}_isAvailable(){try{return this.storage?(this.storage.setItem(Rh,"1"),this.storage.removeItem(Rh),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,r){return this.storage.setItem(e,JSON.stringify(r)),Promise.resolve()}_get(e){const r=this.storage.getItem(e);return Promise.resolve(r?JSON.parse(r):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oD=1e3,lD=10;class HT extends $T{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,r)=>this.onStorageEvent(e,r),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=MT(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const r of Object.keys(this.listeners)){const n=this.storage.getItem(r),i=this.localCache[r];n!==i&&e(r,i,n)}}onStorageEvent(e,r=!1){if(!e.key){this.forAllChangedKeys((a,o,l)=>{this.notifyListeners(a,l)});return}const n=e.key;r?this.detachListener():this.stopPolling();const i=()=>{const a=this.storage.getItem(n);!r&&this.localCache[n]===a||this.notifyListeners(n,a)},s=this.storage.getItem(n);UF()&&s!==e.newValue&&e.newValue!==e.oldValue?setTimeout(i,lD):i()}notifyListeners(e,r){this.localCache[e]=r;const n=this.listeners[e];if(n)for(const i of Array.from(n))i(r&&JSON.parse(r))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,r,n)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:r,newValue:n}),!0)})},oD)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,r){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(r)}_removeListener(e,r){this.listeners[e]&&(this.listeners[e].delete(r),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,r){await super._set(e,r),this.localCache[e]=JSON.stringify(r)}async _get(e){const r=await super._get(e);return this.localCache[e]=JSON.stringify(r),r}async _remove(e){await super._remove(e),delete this.localCache[e]}}HT.type="LOCAL";const cD=HT;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class WT extends $T{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,r){}_removeListener(e,r){}}WT.type="SESSION";const GT=WT;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function uD(t){return Promise.all(t.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(r){return{fulfilled:!1,reason:r}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class E0{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const r=this.receivers.find(i=>i.isListeningto(e));if(r)return r;const n=new E0(e);return this.receivers.push(n),n}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const r=e,{eventId:n,eventType:i,data:s}=r.data,a=this.handlersMap[i];if(!(a!=null&&a.size))return;r.ports[0].postMessage({status:"ack",eventId:n,eventType:i});const o=Array.from(a).map(async c=>c(r.origin,s)),l=await uD(o);r.ports[0].postMessage({status:"done",eventId:n,eventType:i,response:l})}_subscribe(e,r){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(r)}_unsubscribe(e,r){this.handlersMap[e]&&r&&this.handlersMap[e].delete(r),(!r||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}E0.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $g(t="",e=10){let r="";for(let n=0;n<e;n++)r+=Math.floor(Math.random()*10);return t+r}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fD{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,r,n=50){const i=typeof MessageChannel<"u"?new MessageChannel:null;if(!i)throw new Error("connection_unavailable");let s,a;return new Promise((o,l)=>{const c=$g("",20);i.port1.start();const u=setTimeout(()=>{l(new Error("unsupported_event"))},n);a={messageChannel:i,onMessage(h){const d=h;if(d.data.eventId===c)switch(d.data.status){case"ack":clearTimeout(u),s=setTimeout(()=>{l(new Error("timeout"))},3e3);break;case"done":clearTimeout(s),o(d.data.response);break;default:clearTimeout(u),clearTimeout(s),l(new Error("invalid_response"));break}}},this.handlers.add(a),i.port1.addEventListener("message",a.onMessage),this.target.postMessage({eventType:e,eventId:c,data:r},[i.port2])}).finally(()=>{a&&this.removeMessageHandler(a)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xi(){return window}function hD(t){xi().location.href=t}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function KT(){return typeof xi().WorkerGlobalScope<"u"&&typeof xi().importScripts=="function"}async function dD(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function pD(){var t;return((t=navigator==null?void 0:navigator.serviceWorker)===null||t===void 0?void 0:t.controller)||null}function mD(){return KT()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qT="firebaseLocalStorageDb",gD=1,Nh="firebaseLocalStorage",XT="fbase_key";class wu{constructor(e){this.request=e}toPromise(){return new Promise((e,r)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{r(this.request.error)})})}}function T0(t,e){return t.transaction([Nh],e?"readwrite":"readonly").objectStore(Nh)}function vD(){const t=indexedDB.deleteDatabase(qT);return new wu(t).toPromise()}function Zp(){const t=indexedDB.open(qT,gD);return new Promise((e,r)=>{t.addEventListener("error",()=>{r(t.error)}),t.addEventListener("upgradeneeded",()=>{const n=t.result;try{n.createObjectStore(Nh,{keyPath:XT})}catch(i){r(i)}}),t.addEventListener("success",async()=>{const n=t.result;n.objectStoreNames.contains(Nh)?e(n):(n.close(),await vD(),e(await Zp()))})})}async function y_(t,e,r){const n=T0(t,!0).put({[XT]:e,value:r});return new wu(n).toPromise()}async function xD(t,e){const r=T0(t,!1).get(e),n=await new wu(r).toPromise();return n===void 0?null:n.value}function w_(t,e){const r=T0(t,!0).delete(e);return new wu(r).toPromise()}const _D=800,yD=3;class YT{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await Zp(),this.db)}async _withRetries(e){let r=0;for(;;)try{const n=await this._openDb();return await e(n)}catch(n){if(r++>yD)throw n;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return KT()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=E0._getInstance(mD()),this.receiver._subscribe("keyChanged",async(e,r)=>({keyProcessed:(await this._poll()).includes(r.key)})),this.receiver._subscribe("ping",async(e,r)=>["keyChanged"])}async initializeSender(){var e,r;if(this.activeServiceWorker=await dD(),!this.activeServiceWorker)return;this.sender=new fD(this.activeServiceWorker);const n=await this.sender._send("ping",{},800);n&&!((e=n[0])===null||e===void 0)&&e.fulfilled&&!((r=n[0])===null||r===void 0)&&r.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||pD()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await Zp();return await y_(e,Rh,"1"),await w_(e,Rh),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,r){return this._withPendingWrite(async()=>(await this._withRetries(n=>y_(n,e,r)),this.localCache[e]=r,this.notifyServiceWorker(e)))}async _get(e){const r=await this._withRetries(n=>xD(n,e));return this.localCache[e]=r,r}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(r=>w_(r,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(i=>{const s=T0(i,!1).getAll();return new wu(s).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const r=[],n=new Set;if(e.length!==0)for(const{fbase_key:i,value:s}of e)n.add(i),JSON.stringify(this.localCache[i])!==JSON.stringify(s)&&(this.notifyListeners(i,s),r.push(i));for(const i of Object.keys(this.localCache))this.localCache[i]&&!n.has(i)&&(this.notifyListeners(i,null),r.push(i));return r}notifyListeners(e,r){this.localCache[e]=r;const n=this.listeners[e];if(n)for(const i of Array.from(n))i(r)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),_D)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,r){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(r)}_removeListener(e,r){this.listeners[e]&&(this.listeners[e].delete(r),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}YT.type="LOCAL";const wD=YT;new _u(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function QT(t,e){return e?Gi(e):(Le(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hg extends jT{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Uo(e,this._buildIdpRequest())}_linkToIdToken(e,r){return Uo(e,this._buildIdpRequest(r))}_getReauthenticationResolver(e){return Uo(e,this._buildIdpRequest())}_buildIdpRequest(e){const r={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(r.idToken=e),r}}function ED(t){return nD(t.auth,new Hg(t),t.bypassAuthState)}function TD(t){const{auth:e,user:r}=t;return Le(r,e,"internal-error"),rD(r,new Hg(t),t.bypassAuthState)}async function kD(t){const{auth:e,user:r}=t;return Le(r,e,"internal-error"),tD(r,new Hg(t),t.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JT{constructor(e,r,n,i,s=!1){this.auth=e,this.resolver=n,this.user=i,this.bypassAuthState=s,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(r)?r:[r]}execute(){return new Promise(async(e,r)=>{this.pendingPromise={resolve:e,reject:r};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(n){this.reject(n)}})}async onAuthEvent(e){const{urlResponse:r,sessionId:n,postBody:i,tenantId:s,error:a,type:o}=e;if(a){this.reject(a);return}const l={auth:this.auth,requestUri:r,sessionId:n,tenantId:s||void 0,postBody:i||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(o)(l))}catch(c){this.reject(c)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return ED;case"linkViaPopup":case"linkViaRedirect":return kD;case"reauthViaPopup":case"reauthViaRedirect":return TD;default:wi(this.auth,"internal-error")}}resolve(e){as(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){as(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const SD=new _u(2e3,1e4);async function ZT(t,e,r){if($i(t.app))return Promise.reject(ri(t,"operation-not-supported-in-this-environment"));const n=w0(t);TF(t,e,zg);const i=QT(n,r);return new _a(n,"signInViaPopup",e,i).executeNotNull()}class _a extends JT{constructor(e,r,n,i,s){super(e,r,i,s),this.provider=n,this.authWindow=null,this.pollId=null,_a.currentPopupAction&&_a.currentPopupAction.cancel(),_a.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return Le(e,this.auth,"internal-error"),e}async onExecution(){as(this.filter.length===1,"Popup operations only handle one event");const e=$g();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(r=>{this.reject(r)}),this.resolver._isIframeWebStorageSupported(this.auth,r=>{r||this.reject(ri(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)===null||e===void 0?void 0:e.associatedEvent)||null}cancel(){this.reject(ri(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,_a.currentPopupAction=null}pollUserCancellation(){const e=()=>{var r,n;if(!((n=(r=this.authWindow)===null||r===void 0?void 0:r.window)===null||n===void 0)&&n.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(ri(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,SD.get())};e()}}_a.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const AD="pendingRedirect",zf=new Map;class ID extends JT{constructor(e,r,n=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],r,void 0,n),this.eventId=null}async execute(){let e=zf.get(this.auth._key());if(!e){try{const n=await CD(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(n)}catch(r){e=()=>Promise.reject(r)}zf.set(this.auth._key(),e)}return this.bypassAuthState||zf.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const r=await this.auth._redirectUserForId(e.eventId);if(r)return this.user=r,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function CD(t,e){const r=PD(e),n=ND(t);if(!await n._isAvailable())return!1;const i=await n._get(r)==="true";return await n._remove(r),i}function RD(t,e){zf.set(t._key(),e)}function ND(t){return Gi(t._redirectPersistence)}function PD(t){return Bf(AD,t.config.apiKey,t.name)}async function FD(t,e,r=!1){if($i(t.app))return Promise.reject(ka(t));const n=w0(t),i=QT(n,e),a=await new ID(n,i,r).execute();return a&&!r&&(delete a.user._redirectEventId,await n._persistUserIfCurrent(a.user),await n._setRedirectUser(null,e)),a}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const DD=10*60*1e3;class bD{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let r=!1;return this.consumers.forEach(n=>{this.isEventForConsumer(e,n)&&(r=!0,this.sendToConsumer(e,n),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!OD(e)||(this.hasHandledPotentialRedirect=!0,r||(this.queuedRedirectEvent=e,r=!0)),r}sendToConsumer(e,r){var n;if(e.error&&!ek(e)){const i=((n=e.error.code)===null||n===void 0?void 0:n.split("auth/")[1])||"internal-error";r.onError(ri(this.auth,i))}else r.onAuthEvent(e)}isEventForConsumer(e,r){const n=r.eventId===null||!!e.eventId&&e.eventId===r.eventId;return r.filter.includes(e.type)&&n}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=DD&&this.cachedEventUids.clear(),this.cachedEventUids.has(E_(e))}saveEventToCache(e){this.cachedEventUids.add(E_(e)),this.lastProcessedEventTime=Date.now()}}function E_(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function ek({type:t,error:e}){return t==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function OD(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return ek(t);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function LD(t,e={}){return dl(t,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const MD=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,VD=/^https?/;async function UD(t){if(t.config.emulator)return;const{authorizedDomains:e}=await LD(t);for(const r of e)try{if(jD(r))return}catch{}wi(t,"unauthorized-domain")}function jD(t){const e=Qp(),{protocol:r,hostname:n}=new URL(e);if(t.startsWith("chrome-extension://")){const a=new URL(t);return a.hostname===""&&n===""?r==="chrome-extension:"&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):r==="chrome-extension:"&&a.hostname===n}if(!VD.test(r))return!1;if(MD.test(t))return n===t;const i=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+i+"|"+i+")$","i").test(n)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const BD=new _u(3e4,6e4);function T_(){const t=xi().___jsl;if(t!=null&&t.H){for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let r=0;r<t.CP.length;r++)t.CP[r]=null}}function zD(t){return new Promise((e,r)=>{var n,i,s;function a(){T_(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{T_(),r(ri(t,"network-request-failed"))},timeout:BD.get()})}if(!((i=(n=xi().gapi)===null||n===void 0?void 0:n.iframes)===null||i===void 0)&&i.Iframe)e(gapi.iframes.getContext());else if(!((s=xi().gapi)===null||s===void 0)&&s.load)a();else{const o=qF("iframefcb");return xi()[o]=()=>{gapi.load?a():r(ri(t,"network-request-failed"))},GF(`${KF()}?onload=${o}`).catch(l=>r(l))}}).catch(e=>{throw $f=null,e})}let $f=null;function $D(t){return $f=$f||zD(t),$f}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const HD=new _u(5e3,15e3),WD="__/auth/iframe",GD="emulator/auth/iframe",KD={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},qD=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function XD(t){const e=t.config;Le(e.authDomain,t,"auth-domain-config-required");const r=e.emulator?Mg(e,GD):`https://${t.config.authDomain}/${WD}`,n={apiKey:e.apiKey,appName:t.name,v:Ga},i=qD.get(t.config.apiHost);i&&(n.eid=i);const s=t._getFrameworks();return s.length&&(n.fw=s.join(",")),`${r}?${vu(n).slice(1)}`}async function YD(t){const e=await $D(t),r=xi().gapi;return Le(r,t,"internal-error"),e.open({where:document.body,url:XD(t),messageHandlersFilter:r.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:KD,dontclear:!0},n=>new Promise(async(i,s)=>{await n.restyle({setHideOnLeave:!1});const a=ri(t,"network-request-failed"),o=xi().setTimeout(()=>{s(a)},HD.get());function l(){xi().clearTimeout(o),i(n)}n.ping(l).then(l,()=>{s(a)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const QD={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},JD=500,ZD=600,e3="_blank",t3="http://localhost";class k_{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function r3(t,e,r,n=JD,i=ZD){const s=Math.max((window.screen.availHeight-i)/2,0).toString(),a=Math.max((window.screen.availWidth-n)/2,0).toString();let o="";const l=Object.assign(Object.assign({},QD),{width:n.toString(),height:i.toString(),top:s,left:a}),c=jr().toLowerCase();r&&(o=FT(c)?e3:r),NT(c)&&(e=e||t3,l.scrollbars="yes");const u=Object.entries(l).reduce((d,[p,x])=>`${d}${p}=${x},`,"");if(VF(c)&&o!=="_self")return n3(e||"",o),new k_(null);const h=window.open(e||"",o,u);Le(h,t,"popup-blocked");try{h.focus()}catch{}return new k_(h)}function n3(t,e){const r=document.createElement("a");r.href=t,r.target=e;const n=document.createEvent("MouseEvent");n.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),r.dispatchEvent(n)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const i3="__/auth/handler",s3="emulator/auth/handler",a3=encodeURIComponent("fac");async function S_(t,e,r,n,i,s){Le(t.config.authDomain,t,"auth-domain-config-required"),Le(t.config.apiKey,t,"invalid-api-key");const a={apiKey:t.config.apiKey,appName:t.name,authType:r,redirectUrl:n,v:Ga,eventId:i};if(e instanceof zg){e.setDefaultLanguage(t.languageCode),a.providerId=e.providerId||"",uP(e.getCustomParameters())||(a.customParameters=JSON.stringify(e.getCustomParameters()));for(const[u,h]of Object.entries({}))a[u]=h}if(e instanceof yu){const u=e.getScopes().filter(h=>h!=="");u.length>0&&(a.scopes=u.join(","))}t.tenantId&&(a.tid=t.tenantId);const o=a;for(const u of Object.keys(o))o[u]===void 0&&delete o[u];const l=await t._getAppCheckToken(),c=l?`#${a3}=${encodeURIComponent(l)}`:"";return`${o3(t)}?${vu(o).slice(1)}${c}`}function o3({config:t}){return t.emulator?Mg(t,s3):`https://${t.authDomain}/${i3}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Dd="webStorageSupport";class l3{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=GT,this._completeRedirectFn=FD,this._overrideRedirectResult=RD}async _openPopup(e,r,n,i){var s;as((s=this.eventManagers[e._key()])===null||s===void 0?void 0:s.manager,"_initialize() not called before _openPopup()");const a=await S_(e,r,n,Qp(),i);return r3(e,a,$g())}async _openRedirect(e,r,n,i){await this._originValidation(e);const s=await S_(e,r,n,Qp(),i);return hD(s),new Promise(()=>{})}_initialize(e){const r=e._key();if(this.eventManagers[r]){const{manager:i,promise:s}=this.eventManagers[r];return i?Promise.resolve(i):(as(s,"If manager is not set, promise should be"),s)}const n=this.initAndGetManager(e);return this.eventManagers[r]={promise:n},n.catch(()=>{delete this.eventManagers[r]}),n}async initAndGetManager(e){const r=await YD(e),n=new bD(e);return r.register("authEvent",i=>(Le(i==null?void 0:i.authEvent,e,"invalid-auth-event"),{status:n.onEvent(i.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:n},this.iframes[e._key()]=r,n}_isIframeWebStorageSupported(e,r){this.iframes[e._key()].send(Dd,{type:Dd},i=>{var s;const a=(s=i==null?void 0:i[0])===null||s===void 0?void 0:s[Dd];a!==void 0&&r(!!a),wi(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const r=e._key();return this.originValidationPromises[r]||(this.originValidationPromises[r]=UD(e)),this.originValidationPromises[r]}get _shouldInitProactively(){return MT()||PT()||jg()}}const c3=l3;var A_="@firebase/auth",I_="1.7.9";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class u3{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const r=this.auth.onIdTokenChanged(n=>{e((n==null?void 0:n.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,r),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const r=this.internalListeners.get(e);r&&(this.internalListeners.delete(e),r(),this.updateProactiveRefresh())}assertAuthConfigured(){Le(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function f3(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function h3(t){Xs(new is("auth",(e,{options:r})=>{const n=e.getProvider("app").getImmediate(),i=e.getProvider("heartbeat"),s=e.getProvider("app-check-internal"),{apiKey:a,authDomain:o}=n.options;Le(a&&!a.includes(":"),"invalid-api-key",{appName:n.name});const l={apiKey:a,authDomain:o,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:VT(t)},c=new HF(n,i,s,l);return YF(c,r),c},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,r,n)=>{e.getProvider("auth-internal").initialize()})),Xs(new is("auth-internal",e=>{const r=w0(e.getProvider("auth").getImmediate());return(n=>new u3(n))(r)},"PRIVATE").setInstantiationMode("EXPLICIT")),On(A_,I_,f3(t)),On(A_,I_,"esm2017")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const d3=5*60,p3=pT("authIdTokenMaxAge")||d3;let C_=null;const m3=t=>async e=>{const r=e&&await e.getIdTokenResult(),n=r&&(new Date().getTime()-Date.parse(r.issuedAtTime))/1e3;if(n&&n>p3)return;const i=r==null?void 0:r.token;C_!==i&&(C_=i,await fetch(t,{method:i?"POST":"DELETE",headers:i?{Authorization:`Bearer ${i}`}:{}}))};function g3(t=y0()){const e=xu(t,"auth");if(e.isInitialized())return e.getImmediate();const r=XF(t,{popupRedirectResolver:c3,persistence:[wD,cD,GT]}),n=pT("authTokenSyncURL");if(n&&typeof isSecureContext=="boolean"&&isSecureContext){const s=new URL(n,location.origin);if(location.origin===s.origin){const a=m3(s.toString());sD(r,a,()=>a(r.currentUser)),iD(r,o=>a(o))}}const i=hT("auth");return i&&QF(r,`http://${i}`),r}function v3(){var t,e;return(e=(t=document.getElementsByTagName("head"))===null||t===void 0?void 0:t[0])!==null&&e!==void 0?e:document}WF({loadJS(t){return new Promise((e,r)=>{const n=document.createElement("script");n.setAttribute("src",t),n.onload=e,n.onerror=i=>{const s=ri("internal-error");s.customData=i,r(s)},n.type="text/javascript",n.charset="UTF-8",v3().appendChild(n)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});h3("Browser");var R_=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Sa,tk;(function(){var t;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(g,k){function S(){}S.prototype=k.prototype,g.D=k.prototype,g.prototype=new S,g.prototype.constructor=g,g.C=function(C,F,P){for(var b=Array(arguments.length-2),ve=2;ve<arguments.length;ve++)b[ve-2]=arguments[ve];return k.prototype[F].apply(C,b)}}function r(){this.blockSize=-1}function n(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(n,r),n.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function i(g,k,S){S||(S=0);var C=Array(16);if(typeof k=="string")for(var F=0;16>F;++F)C[F]=k.charCodeAt(S++)|k.charCodeAt(S++)<<8|k.charCodeAt(S++)<<16|k.charCodeAt(S++)<<24;else for(F=0;16>F;++F)C[F]=k[S++]|k[S++]<<8|k[S++]<<16|k[S++]<<24;k=g.g[0],S=g.g[1],F=g.g[2];var P=g.g[3],b=k+(P^S&(F^P))+C[0]+3614090360&4294967295;k=S+(b<<7&4294967295|b>>>25),b=P+(F^k&(S^F))+C[1]+3905402710&4294967295,P=k+(b<<12&4294967295|b>>>20),b=F+(S^P&(k^S))+C[2]+606105819&4294967295,F=P+(b<<17&4294967295|b>>>15),b=S+(k^F&(P^k))+C[3]+3250441966&4294967295,S=F+(b<<22&4294967295|b>>>10),b=k+(P^S&(F^P))+C[4]+4118548399&4294967295,k=S+(b<<7&4294967295|b>>>25),b=P+(F^k&(S^F))+C[5]+1200080426&4294967295,P=k+(b<<12&4294967295|b>>>20),b=F+(S^P&(k^S))+C[6]+2821735955&4294967295,F=P+(b<<17&4294967295|b>>>15),b=S+(k^F&(P^k))+C[7]+4249261313&4294967295,S=F+(b<<22&4294967295|b>>>10),b=k+(P^S&(F^P))+C[8]+1770035416&4294967295,k=S+(b<<7&4294967295|b>>>25),b=P+(F^k&(S^F))+C[9]+2336552879&4294967295,P=k+(b<<12&4294967295|b>>>20),b=F+(S^P&(k^S))+C[10]+4294925233&4294967295,F=P+(b<<17&4294967295|b>>>15),b=S+(k^F&(P^k))+C[11]+2304563134&4294967295,S=F+(b<<22&4294967295|b>>>10),b=k+(P^S&(F^P))+C[12]+1804603682&4294967295,k=S+(b<<7&4294967295|b>>>25),b=P+(F^k&(S^F))+C[13]+4254626195&4294967295,P=k+(b<<12&4294967295|b>>>20),b=F+(S^P&(k^S))+C[14]+2792965006&4294967295,F=P+(b<<17&4294967295|b>>>15),b=S+(k^F&(P^k))+C[15]+1236535329&4294967295,S=F+(b<<22&4294967295|b>>>10),b=k+(F^P&(S^F))+C[1]+4129170786&4294967295,k=S+(b<<5&4294967295|b>>>27),b=P+(S^F&(k^S))+C[6]+3225465664&4294967295,P=k+(b<<9&4294967295|b>>>23),b=F+(k^S&(P^k))+C[11]+643717713&4294967295,F=P+(b<<14&4294967295|b>>>18),b=S+(P^k&(F^P))+C[0]+3921069994&4294967295,S=F+(b<<20&4294967295|b>>>12),b=k+(F^P&(S^F))+C[5]+3593408605&4294967295,k=S+(b<<5&4294967295|b>>>27),b=P+(S^F&(k^S))+C[10]+38016083&4294967295,P=k+(b<<9&4294967295|b>>>23),b=F+(k^S&(P^k))+C[15]+3634488961&4294967295,F=P+(b<<14&4294967295|b>>>18),b=S+(P^k&(F^P))+C[4]+3889429448&4294967295,S=F+(b<<20&4294967295|b>>>12),b=k+(F^P&(S^F))+C[9]+568446438&4294967295,k=S+(b<<5&4294967295|b>>>27),b=P+(S^F&(k^S))+C[14]+3275163606&4294967295,P=k+(b<<9&4294967295|b>>>23),b=F+(k^S&(P^k))+C[3]+4107603335&4294967295,F=P+(b<<14&4294967295|b>>>18),b=S+(P^k&(F^P))+C[8]+1163531501&4294967295,S=F+(b<<20&4294967295|b>>>12),b=k+(F^P&(S^F))+C[13]+2850285829&4294967295,k=S+(b<<5&4294967295|b>>>27),b=P+(S^F&(k^S))+C[2]+4243563512&4294967295,P=k+(b<<9&4294967295|b>>>23),b=F+(k^S&(P^k))+C[7]+1735328473&4294967295,F=P+(b<<14&4294967295|b>>>18),b=S+(P^k&(F^P))+C[12]+2368359562&4294967295,S=F+(b<<20&4294967295|b>>>12),b=k+(S^F^P)+C[5]+4294588738&4294967295,k=S+(b<<4&4294967295|b>>>28),b=P+(k^S^F)+C[8]+2272392833&4294967295,P=k+(b<<11&4294967295|b>>>21),b=F+(P^k^S)+C[11]+1839030562&4294967295,F=P+(b<<16&4294967295|b>>>16),b=S+(F^P^k)+C[14]+4259657740&4294967295,S=F+(b<<23&4294967295|b>>>9),b=k+(S^F^P)+C[1]+2763975236&4294967295,k=S+(b<<4&4294967295|b>>>28),b=P+(k^S^F)+C[4]+1272893353&4294967295,P=k+(b<<11&4294967295|b>>>21),b=F+(P^k^S)+C[7]+4139469664&4294967295,F=P+(b<<16&4294967295|b>>>16),b=S+(F^P^k)+C[10]+3200236656&4294967295,S=F+(b<<23&4294967295|b>>>9),b=k+(S^F^P)+C[13]+681279174&4294967295,k=S+(b<<4&4294967295|b>>>28),b=P+(k^S^F)+C[0]+3936430074&4294967295,P=k+(b<<11&4294967295|b>>>21),b=F+(P^k^S)+C[3]+3572445317&4294967295,F=P+(b<<16&4294967295|b>>>16),b=S+(F^P^k)+C[6]+76029189&4294967295,S=F+(b<<23&4294967295|b>>>9),b=k+(S^F^P)+C[9]+3654602809&4294967295,k=S+(b<<4&4294967295|b>>>28),b=P+(k^S^F)+C[12]+3873151461&4294967295,P=k+(b<<11&4294967295|b>>>21),b=F+(P^k^S)+C[15]+530742520&4294967295,F=P+(b<<16&4294967295|b>>>16),b=S+(F^P^k)+C[2]+3299628645&4294967295,S=F+(b<<23&4294967295|b>>>9),b=k+(F^(S|~P))+C[0]+4096336452&4294967295,k=S+(b<<6&4294967295|b>>>26),b=P+(S^(k|~F))+C[7]+1126891415&4294967295,P=k+(b<<10&4294967295|b>>>22),b=F+(k^(P|~S))+C[14]+2878612391&4294967295,F=P+(b<<15&4294967295|b>>>17),b=S+(P^(F|~k))+C[5]+4237533241&4294967295,S=F+(b<<21&4294967295|b>>>11),b=k+(F^(S|~P))+C[12]+1700485571&4294967295,k=S+(b<<6&4294967295|b>>>26),b=P+(S^(k|~F))+C[3]+2399980690&4294967295,P=k+(b<<10&4294967295|b>>>22),b=F+(k^(P|~S))+C[10]+4293915773&4294967295,F=P+(b<<15&4294967295|b>>>17),b=S+(P^(F|~k))+C[1]+2240044497&4294967295,S=F+(b<<21&4294967295|b>>>11),b=k+(F^(S|~P))+C[8]+1873313359&4294967295,k=S+(b<<6&4294967295|b>>>26),b=P+(S^(k|~F))+C[15]+4264355552&4294967295,P=k+(b<<10&4294967295|b>>>22),b=F+(k^(P|~S))+C[6]+2734768916&4294967295,F=P+(b<<15&4294967295|b>>>17),b=S+(P^(F|~k))+C[13]+1309151649&4294967295,S=F+(b<<21&4294967295|b>>>11),b=k+(F^(S|~P))+C[4]+4149444226&4294967295,k=S+(b<<6&4294967295|b>>>26),b=P+(S^(k|~F))+C[11]+3174756917&4294967295,P=k+(b<<10&4294967295|b>>>22),b=F+(k^(P|~S))+C[2]+718787259&4294967295,F=P+(b<<15&4294967295|b>>>17),b=S+(P^(F|~k))+C[9]+3951481745&4294967295,g.g[0]=g.g[0]+k&4294967295,g.g[1]=g.g[1]+(F+(b<<21&4294967295|b>>>11))&4294967295,g.g[2]=g.g[2]+F&4294967295,g.g[3]=g.g[3]+P&4294967295}n.prototype.u=function(g,k){k===void 0&&(k=g.length);for(var S=k-this.blockSize,C=this.B,F=this.h,P=0;P<k;){if(F==0)for(;P<=S;)i(this,g,P),P+=this.blockSize;if(typeof g=="string"){for(;P<k;)if(C[F++]=g.charCodeAt(P++),F==this.blockSize){i(this,C),F=0;break}}else for(;P<k;)if(C[F++]=g[P++],F==this.blockSize){i(this,C),F=0;break}}this.h=F,this.o+=k},n.prototype.v=function(){var g=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);g[0]=128;for(var k=1;k<g.length-8;++k)g[k]=0;var S=8*this.o;for(k=g.length-8;k<g.length;++k)g[k]=S&255,S/=256;for(this.u(g),g=Array(16),k=S=0;4>k;++k)for(var C=0;32>C;C+=8)g[S++]=this.g[k]>>>C&255;return g};function s(g,k){var S=o;return Object.prototype.hasOwnProperty.call(S,g)?S[g]:S[g]=k(g)}function a(g,k){this.h=k;for(var S=[],C=!0,F=g.length-1;0<=F;F--){var P=g[F]|0;C&&P==k||(S[F]=P,C=!1)}this.g=S}var o={};function l(g){return-128<=g&&128>g?s(g,function(k){return new a([k|0],0>k?-1:0)}):new a([g|0],0>g?-1:0)}function c(g){if(isNaN(g)||!isFinite(g))return h;if(0>g)return E(c(-g));for(var k=[],S=1,C=0;g>=S;C++)k[C]=g/S|0,S*=4294967296;return new a(k,0)}function u(g,k){if(g.length==0)throw Error("number format error: empty string");if(k=k||10,2>k||36<k)throw Error("radix out of range: "+k);if(g.charAt(0)=="-")return E(u(g.substring(1),k));if(0<=g.indexOf("-"))throw Error('number format error: interior "-" character');for(var S=c(Math.pow(k,8)),C=h,F=0;F<g.length;F+=8){var P=Math.min(8,g.length-F),b=parseInt(g.substring(F,F+P),k);8>P?(P=c(Math.pow(k,P)),C=C.j(P).add(c(b))):(C=C.j(S),C=C.add(c(b)))}return C}var h=l(0),d=l(1),p=l(16777216);t=a.prototype,t.m=function(){if(v(this))return-E(this).m();for(var g=0,k=1,S=0;S<this.g.length;S++){var C=this.i(S);g+=(0<=C?C:4294967296+C)*k,k*=4294967296}return g},t.toString=function(g){if(g=g||10,2>g||36<g)throw Error("radix out of range: "+g);if(x(this))return"0";if(v(this))return"-"+E(this).toString(g);for(var k=c(Math.pow(g,6)),S=this,C="";;){var F=R(S,k).g;S=T(S,F.j(k));var P=((0<S.g.length?S.g[0]:S.h)>>>0).toString(g);if(S=F,x(S))return P+C;for(;6>P.length;)P="0"+P;C=P+C}},t.i=function(g){return 0>g?0:g<this.g.length?this.g[g]:this.h};function x(g){if(g.h!=0)return!1;for(var k=0;k<g.g.length;k++)if(g.g[k]!=0)return!1;return!0}function v(g){return g.h==-1}t.l=function(g){return g=T(this,g),v(g)?-1:x(g)?0:1};function E(g){for(var k=g.g.length,S=[],C=0;C<k;C++)S[C]=~g.g[C];return new a(S,~g.h).add(d)}t.abs=function(){return v(this)?E(this):this},t.add=function(g){for(var k=Math.max(this.g.length,g.g.length),S=[],C=0,F=0;F<=k;F++){var P=C+(this.i(F)&65535)+(g.i(F)&65535),b=(P>>>16)+(this.i(F)>>>16)+(g.i(F)>>>16);C=b>>>16,P&=65535,b&=65535,S[F]=b<<16|P}return new a(S,S[S.length-1]&-2147483648?-1:0)};function T(g,k){return g.add(E(k))}t.j=function(g){if(x(this)||x(g))return h;if(v(this))return v(g)?E(this).j(E(g)):E(E(this).j(g));if(v(g))return E(this.j(E(g)));if(0>this.l(p)&&0>g.l(p))return c(this.m()*g.m());for(var k=this.g.length+g.g.length,S=[],C=0;C<2*k;C++)S[C]=0;for(C=0;C<this.g.length;C++)for(var F=0;F<g.g.length;F++){var P=this.i(C)>>>16,b=this.i(C)&65535,ve=g.i(F)>>>16,he=g.i(F)&65535;S[2*C+2*F]+=b*he,w(S,2*C+2*F),S[2*C+2*F+1]+=P*he,w(S,2*C+2*F+1),S[2*C+2*F+1]+=b*ve,w(S,2*C+2*F+1),S[2*C+2*F+2]+=P*ve,w(S,2*C+2*F+2)}for(C=0;C<k;C++)S[C]=S[2*C+1]<<16|S[2*C];for(C=k;C<2*k;C++)S[C]=0;return new a(S,0)};function w(g,k){for(;(g[k]&65535)!=g[k];)g[k+1]+=g[k]>>>16,g[k]&=65535,k++}function y(g,k){this.g=g,this.h=k}function R(g,k){if(x(k))throw Error("division by zero");if(x(g))return new y(h,h);if(v(g))return k=R(E(g),k),new y(E(k.g),E(k.h));if(v(k))return k=R(g,E(k)),new y(E(k.g),k.h);if(30<g.g.length){if(v(g)||v(k))throw Error("slowDivide_ only works with positive integers.");for(var S=d,C=k;0>=C.l(g);)S=M(S),C=M(C);var F=j(S,1),P=j(C,1);for(C=j(C,2),S=j(S,2);!x(C);){var b=P.add(C);0>=b.l(g)&&(F=F.add(S),P=b),C=j(C,1),S=j(S,1)}return k=T(g,F.j(k)),new y(F,k)}for(F=h;0<=g.l(k);){for(S=Math.max(1,Math.floor(g.m()/k.m())),C=Math.ceil(Math.log(S)/Math.LN2),C=48>=C?1:Math.pow(2,C-48),P=c(S),b=P.j(k);v(b)||0<b.l(g);)S-=C,P=c(S),b=P.j(k);x(P)&&(P=d),F=F.add(P),g=T(g,b)}return new y(F,g)}t.A=function(g){return R(this,g).h},t.and=function(g){for(var k=Math.max(this.g.length,g.g.length),S=[],C=0;C<k;C++)S[C]=this.i(C)&g.i(C);return new a(S,this.h&g.h)},t.or=function(g){for(var k=Math.max(this.g.length,g.g.length),S=[],C=0;C<k;C++)S[C]=this.i(C)|g.i(C);return new a(S,this.h|g.h)},t.xor=function(g){for(var k=Math.max(this.g.length,g.g.length),S=[],C=0;C<k;C++)S[C]=this.i(C)^g.i(C);return new a(S,this.h^g.h)};function M(g){for(var k=g.g.length+1,S=[],C=0;C<k;C++)S[C]=g.i(C)<<1|g.i(C-1)>>>31;return new a(S,g.h)}function j(g,k){var S=k>>5;k%=32;for(var C=g.g.length-S,F=[],P=0;P<C;P++)F[P]=0<k?g.i(P+S)>>>k|g.i(P+S+1)<<32-k:g.i(P+S);return new a(F,g.h)}n.prototype.digest=n.prototype.v,n.prototype.reset=n.prototype.s,n.prototype.update=n.prototype.u,tk=n,a.prototype.add=a.prototype.add,a.prototype.multiply=a.prototype.j,a.prototype.modulo=a.prototype.A,a.prototype.compare=a.prototype.l,a.prototype.toNumber=a.prototype.m,a.prototype.toString=a.prototype.toString,a.prototype.getBits=a.prototype.i,a.fromNumber=c,a.fromString=u,Sa=a}).apply(typeof R_<"u"?R_:typeof self<"u"?self:typeof window<"u"?window:{});var df=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var rk,Kl,nk,Hf,em,ik,sk,ak;(function(){var t,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(f,_,A){return f==Array.prototype||f==Object.prototype||(f[_]=A.value),f};function r(f){f=[typeof globalThis=="object"&&globalThis,f,typeof window=="object"&&window,typeof self=="object"&&self,typeof df=="object"&&df];for(var _=0;_<f.length;++_){var A=f[_];if(A&&A.Math==Math)return A}throw Error("Cannot find global object")}var n=r(this);function i(f,_){if(_)e:{var A=n;f=f.split(".");for(var U=0;U<f.length-1;U++){var re=f[U];if(!(re in A))break e;A=A[re]}f=f[f.length-1],U=A[f],_=_(U),_!=U&&_!=null&&e(A,f,{configurable:!0,writable:!0,value:_})}}function s(f,_){f instanceof String&&(f+="");var A=0,U=!1,re={next:function(){if(!U&&A<f.length){var se=A++;return{value:_(se,f[se]),done:!1}}return U=!0,{done:!0,value:void 0}}};return re[Symbol.iterator]=function(){return re},re}i("Array.prototype.values",function(f){return f||function(){return s(this,function(_,A){return A})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var a=a||{},o=this||self;function l(f){var _=typeof f;return _=_!="object"?_:f?Array.isArray(f)?"array":_:"null",_=="array"||_=="object"&&typeof f.length=="number"}function c(f){var _=typeof f;return _=="object"&&f!=null||_=="function"}function u(f,_,A){return f.call.apply(f.bind,arguments)}function h(f,_,A){if(!f)throw Error();if(2<arguments.length){var U=Array.prototype.slice.call(arguments,2);return function(){var re=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(re,U),f.apply(_,re)}}return function(){return f.apply(_,arguments)}}function d(f,_,A){return d=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?u:h,d.apply(null,arguments)}function p(f,_){var A=Array.prototype.slice.call(arguments,1);return function(){var U=A.slice();return U.push.apply(U,arguments),f.apply(this,U)}}function x(f,_){function A(){}A.prototype=_.prototype,f.aa=_.prototype,f.prototype=new A,f.prototype.constructor=f,f.Qb=function(U,re,se){for(var Te=Array(arguments.length-2),_t=2;_t<arguments.length;_t++)Te[_t-2]=arguments[_t];return _.prototype[re].apply(U,Te)}}function v(f){const _=f.length;if(0<_){const A=Array(_);for(let U=0;U<_;U++)A[U]=f[U];return A}return[]}function E(f,_){for(let A=1;A<arguments.length;A++){const U=arguments[A];if(l(U)){const re=f.length||0,se=U.length||0;f.length=re+se;for(let Te=0;Te<se;Te++)f[re+Te]=U[Te]}else f.push(U)}}class T{constructor(_,A){this.i=_,this.j=A,this.h=0,this.g=null}get(){let _;return 0<this.h?(this.h--,_=this.g,this.g=_.next,_.next=null):_=this.i(),_}}function w(f){return/^[\s\xa0]*$/.test(f)}function y(){var f=o.navigator;return f&&(f=f.userAgent)?f:""}function R(f){return R[" "](f),f}R[" "]=function(){};var M=y().indexOf("Gecko")!=-1&&!(y().toLowerCase().indexOf("webkit")!=-1&&y().indexOf("Edge")==-1)&&!(y().indexOf("Trident")!=-1||y().indexOf("MSIE")!=-1)&&y().indexOf("Edge")==-1;function j(f,_,A){for(const U in f)_.call(A,f[U],U,f)}function g(f,_){for(const A in f)_.call(void 0,f[A],A,f)}function k(f){const _={};for(const A in f)_[A]=f[A];return _}const S="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function C(f,_){let A,U;for(let re=1;re<arguments.length;re++){U=arguments[re];for(A in U)f[A]=U[A];for(let se=0;se<S.length;se++)A=S[se],Object.prototype.hasOwnProperty.call(U,A)&&(f[A]=U[A])}}function F(f){var _=1;f=f.split(":");const A=[];for(;0<_&&f.length;)A.push(f.shift()),_--;return f.length&&A.push(f.join(":")),A}function P(f){o.setTimeout(()=>{throw f},0)}function b(){var f=G;let _=null;return f.g&&(_=f.g,f.g=f.g.next,f.g||(f.h=null),_.next=null),_}class ve{constructor(){this.h=this.g=null}add(_,A){const U=he.get();U.set(_,A),this.h?this.h.next=U:this.g=U,this.h=U}}var he=new T(()=>new Se,f=>f.reset());class Se{constructor(){this.next=this.g=this.h=null}set(_,A){this.h=_,this.g=A,this.next=null}reset(){this.next=this.g=this.h=null}}let oe,ie=!1,G=new ve,ue=()=>{const f=o.Promise.resolve(void 0);oe=()=>{f.then(Ee)}};var Ee=()=>{for(var f;f=b();){try{f.h.call(f.g)}catch(A){P(A)}var _=he;_.j(f),100>_.h&&(_.h++,f.next=_.g,_.g=f)}ie=!1};function B(){this.s=this.s,this.C=this.C}B.prototype.s=!1,B.prototype.ma=function(){this.s||(this.s=!0,this.N())},B.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function X(f,_){this.type=f,this.g=this.target=_,this.defaultPrevented=!1}X.prototype.h=function(){this.defaultPrevented=!0};var K=function(){if(!o.addEventListener||!Object.defineProperty)return!1;var f=!1,_=Object.defineProperty({},"passive",{get:function(){f=!0}});try{const A=()=>{};o.addEventListener("test",A,_),o.removeEventListener("test",A,_)}catch{}return f}();function W(f,_){if(X.call(this,f?f.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,f){var A=this.type=f.type,U=f.changedTouches&&f.changedTouches.length?f.changedTouches[0]:null;if(this.target=f.target||f.srcElement,this.g=_,_=f.relatedTarget){if(M){e:{try{R(_.nodeName);var re=!0;break e}catch{}re=!1}re||(_=null)}}else A=="mouseover"?_=f.fromElement:A=="mouseout"&&(_=f.toElement);this.relatedTarget=_,U?(this.clientX=U.clientX!==void 0?U.clientX:U.pageX,this.clientY=U.clientY!==void 0?U.clientY:U.pageY,this.screenX=U.screenX||0,this.screenY=U.screenY||0):(this.clientX=f.clientX!==void 0?f.clientX:f.pageX,this.clientY=f.clientY!==void 0?f.clientY:f.pageY,this.screenX=f.screenX||0,this.screenY=f.screenY||0),this.button=f.button,this.key=f.key||"",this.ctrlKey=f.ctrlKey,this.altKey=f.altKey,this.shiftKey=f.shiftKey,this.metaKey=f.metaKey,this.pointerId=f.pointerId||0,this.pointerType=typeof f.pointerType=="string"?f.pointerType:ae[f.pointerType]||"",this.state=f.state,this.i=f,f.defaultPrevented&&W.aa.h.call(this)}}x(W,X);var ae={2:"touch",3:"pen",4:"mouse"};W.prototype.h=function(){W.aa.h.call(this);var f=this.i;f.preventDefault?f.preventDefault():f.returnValue=!1};var xe="closure_listenable_"+(1e6*Math.random()|0),ke=0;function fe(f,_,A,U,re){this.listener=f,this.proxy=null,this.src=_,this.type=A,this.capture=!!U,this.ha=re,this.key=++ke,this.da=this.fa=!1}function pe(f){f.da=!0,f.listener=null,f.proxy=null,f.src=null,f.ha=null}function $e(f){this.src=f,this.g={},this.h=0}$e.prototype.add=function(f,_,A,U,re){var se=f.toString();f=this.g[se],f||(f=this.g[se]=[],this.h++);var Te=ot(f,_,U,re);return-1<Te?(_=f[Te],A||(_.fa=!1)):(_=new fe(_,this.src,se,!!U,re),_.fa=A,f.push(_)),_};function z(f,_){var A=_.type;if(A in f.g){var U=f.g[A],re=Array.prototype.indexOf.call(U,_,void 0),se;(se=0<=re)&&Array.prototype.splice.call(U,re,1),se&&(pe(_),f.g[A].length==0&&(delete f.g[A],f.h--))}}function ot(f,_,A,U){for(var re=0;re<f.length;++re){var se=f[re];if(!se.da&&se.listener==_&&se.capture==!!A&&se.ha==U)return re}return-1}var We="closure_lm_"+(1e6*Math.random()|0),nt={};function be(f,_,A,U,re){if(Array.isArray(_)){for(var se=0;se<_.length;se++)be(f,_[se],A,U,re);return null}return A=or(A),f&&f[xe]?f.K(_,A,c(U)?!!U.capture:!1,re):Ie(f,_,A,!1,U,re)}function Ie(f,_,A,U,re,se){if(!_)throw Error("Invalid event type");var Te=c(re)?!!re.capture:!!re,_t=en(f);if(_t||(f[We]=_t=new $e(f)),A=_t.add(_,A,U,Te,se),A.proxy)return A;if(U=Et(),A.proxy=U,U.src=f,U.listener=A,f.addEventListener)K||(re=Te),re===void 0&&(re=!1),f.addEventListener(_.toString(),U,re);else if(f.attachEvent)f.attachEvent(Zr(_.toString()),U);else if(f.addListener&&f.removeListener)f.addListener(U);else throw Error("addEventListener and attachEvent are unavailable.");return A}function Et(){function f(A){return _.call(f.src,f.listener,A)}const _=Pi;return f}function ar(f,_,A,U,re){if(Array.isArray(_))for(var se=0;se<_.length;se++)ar(f,_[se],A,U,re);else U=c(U)?!!U.capture:!!U,A=or(A),f&&f[xe]?(f=f.i,_=String(_).toString(),_ in f.g&&(se=f.g[_],A=ot(se,A,U,re),-1<A&&(pe(se[A]),Array.prototype.splice.call(se,A,1),se.length==0&&(delete f.g[_],f.h--)))):f&&(f=en(f))&&(_=f.g[_.toString()],f=-1,_&&(f=ot(_,A,U,re)),(A=-1<f?_[f]:null)&&Sr(A))}function Sr(f){if(typeof f!="number"&&f&&!f.da){var _=f.src;if(_&&_[xe])z(_.i,f);else{var A=f.type,U=f.proxy;_.removeEventListener?_.removeEventListener(A,U,f.capture):_.detachEvent?_.detachEvent(Zr(A),U):_.addListener&&_.removeListener&&_.removeListener(U),(A=en(_))?(z(A,f),A.h==0&&(A.src=null,_[We]=null)):pe(f)}}}function Zr(f){return f in nt?nt[f]:nt[f]="on"+f}function Pi(f,_){if(f.da)f=!0;else{_=new W(_,this);var A=f.listener,U=f.ha||f.src;f.fa&&Sr(f),f=A.call(U,_)}return f}function en(f){return f=f[We],f instanceof $e?f:null}var Tt="__closure_events_fn_"+(1e9*Math.random()>>>0);function or(f){return typeof f=="function"?f:(f[Tt]||(f[Tt]=function(_){return f.handleEvent(_)}),f[Tt])}function vt(){B.call(this),this.i=new $e(this),this.M=this,this.F=null}x(vt,B),vt.prototype[xe]=!0,vt.prototype.removeEventListener=function(f,_,A,U){ar(this,f,_,A,U)};function kt(f,_){var A,U=f.F;if(U)for(A=[];U;U=U.F)A.push(U);if(f=f.M,U=_.type||_,typeof _=="string")_=new X(_,f);else if(_ instanceof X)_.target=_.target||f;else{var re=_;_=new X(U,f),C(_,re)}if(re=!0,A)for(var se=A.length-1;0<=se;se--){var Te=_.g=A[se];re=ht(Te,U,!0,_)&&re}if(Te=_.g=f,re=ht(Te,U,!0,_)&&re,re=ht(Te,U,!1,_)&&re,A)for(se=0;se<A.length;se++)Te=_.g=A[se],re=ht(Te,U,!1,_)&&re}vt.prototype.N=function(){if(vt.aa.N.call(this),this.i){var f=this.i,_;for(_ in f.g){for(var A=f.g[_],U=0;U<A.length;U++)pe(A[U]);delete f.g[_],f.h--}}this.F=null},vt.prototype.K=function(f,_,A,U){return this.i.add(String(f),_,!1,A,U)},vt.prototype.L=function(f,_,A,U){return this.i.add(String(f),_,!0,A,U)};function ht(f,_,A,U){if(_=f.i.g[String(_)],!_)return!0;_=_.concat();for(var re=!0,se=0;se<_.length;++se){var Te=_[se];if(Te&&!Te.da&&Te.capture==A){var _t=Te.listener,pr=Te.ha||Te.src;Te.fa&&z(f.i,Te),re=_t.call(pr,U)!==!1&&re}}return re&&!U.defaultPrevented}function Ft(f,_,A){if(typeof f=="function")A&&(f=d(f,A));else if(f&&typeof f.handleEvent=="function")f=d(f.handleEvent,f);else throw Error("Invalid listener argument");return 2147483647<Number(_)?-1:o.setTimeout(f,_||0)}function Ve(f){f.g=Ft(()=>{f.g=null,f.i&&(f.i=!1,Ve(f))},f.l);const _=f.h;f.h=null,f.m.apply(null,_)}class xt extends B{constructor(_,A){super(),this.m=_,this.l=A,this.h=null,this.i=!1,this.g=null}j(_){this.h=arguments,this.g?this.i=!0:Ve(this)}N(){super.N(),this.g&&(o.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Ht(f){B.call(this),this.h=f,this.g={}}x(Ht,B);var ut=[];function fn(f){j(f.g,function(_,A){this.g.hasOwnProperty(A)&&Sr(_)},f),f.g={}}Ht.prototype.N=function(){Ht.aa.N.call(this),fn(this)},Ht.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Fi=o.JSON.stringify,no=o.JSON.parse,wl=class{stringify(f){return o.JSON.stringify(f,void 0)}parse(f){return o.JSON.parse(f,void 0)}};function Di(){}Di.prototype.h=null;function oi(f){return f.h||(f.h=f.i())}function ps(){}var Bn={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function bi(){X.call(this,"d")}x(bi,X);function li(){X.call(this,"c")}x(li,X);var Sn={},io=null;function Oi(){return io=io||new vt}Sn.La="serverreachability";function Li(f){X.call(this,Sn.La,f)}x(Li,X);function An(f){const _=Oi();kt(_,new Li(_))}Sn.STAT_EVENT="statevent";function so(f,_){X.call(this,Sn.STAT_EVENT,f),this.stat=_}x(so,X);function Zt(f){const _=Oi();kt(_,new so(_,f))}Sn.Ma="timingevent";function H(f,_){X.call(this,Sn.Ma,f),this.size=_}x(H,X);function Q(f,_){if(typeof f!="function")throw Error("Fn must not be null and must be a function");return o.setTimeout(function(){f()},_)}function ne(){this.g=!0}ne.prototype.xa=function(){this.g=!1};function de(f,_,A,U,re,se){f.info(function(){if(f.g)if(se)for(var Te="",_t=se.split("&"),pr=0;pr<_t.length;pr++){var lt=_t[pr].split("=");if(1<lt.length){var Ar=lt[0];lt=lt[1];var Ir=Ar.split("_");Te=2<=Ir.length&&Ir[1]=="type"?Te+(Ar+"="+lt+"&"):Te+(Ar+"=redacted&")}}else Te=null;else Te=se;return"XMLHTTP REQ ("+U+") [attempt "+re+"]: "+_+`
`+A+`
`+Te})}function Ae(f,_,A,U,re,se,Te){f.info(function(){return"XMLHTTP RESP ("+U+") [ attempt "+re+"]: "+_+`
`+A+`
`+se+" "+Te})}function I(f,_,A,U){f.info(function(){return"XMLHTTP TEXT ("+_+"): "+N(f,A)+(U?" "+U:"")})}function V(f,_){f.info(function(){return"TIMEOUT: "+_})}ne.prototype.info=function(){};function N(f,_){if(!f.g)return _;if(!_)return null;try{var A=JSON.parse(_);if(A){for(f=0;f<A.length;f++)if(Array.isArray(A[f])){var U=A[f];if(!(2>U.length)){var re=U[1];if(Array.isArray(re)&&!(1>re.length)){var se=re[0];if(se!="noop"&&se!="stop"&&se!="close")for(var Te=1;Te<re.length;Te++)re[Te]=""}}}}return Fi(A)}catch{return _}}var D={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},O={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},L;function q(){}x(q,Di),q.prototype.g=function(){return new XMLHttpRequest},q.prototype.i=function(){return{}},L=new q;function te(f,_,A,U){this.j=f,this.i=_,this.l=A,this.R=U||1,this.U=new Ht(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new ee}function ee(){this.i=null,this.g="",this.h=!1}var J={},Y={};function le(f,_,A){f.L=1,f.v=Vu(Mi(_)),f.m=A,f.P=!0,ye(f,null)}function ye(f,_){f.F=Date.now(),we(f),f.A=Mi(f.v);var A=f.A,U=f.R;Array.isArray(U)||(U=[String(U)]),s1(A.i,"t",U),f.C=0,A=f.j.J,f.h=new ee,f.g=T1(f.j,A?_:null,!f.m),0<f.O&&(f.M=new xt(d(f.Y,f,f.g),f.O)),_=f.U,A=f.g,U=f.ca;var re="readystatechange";Array.isArray(re)||(re&&(ut[0]=re.toString()),re=ut);for(var se=0;se<re.length;se++){var Te=be(A,re[se],U||_.handleEvent,!1,_.h||_);if(!Te)break;_.g[Te.key]=Te}_=f.H?k(f.H):{},f.m?(f.u||(f.u="POST"),_["Content-Type"]="application/x-www-form-urlencoded",f.g.ea(f.A,f.u,f.m,_)):(f.u="GET",f.g.ea(f.A,f.u,null,_)),An(),de(f.i,f.u,f.A,f.l,f.R,f.m)}te.prototype.ca=function(f){f=f.target;const _=this.M;_&&Vi(f)==3?_.j():this.Y(f)},te.prototype.Y=function(f){try{if(f==this.g)e:{const Ir=Vi(this.g);var _=this.g.Ba();const lo=this.g.Z();if(!(3>Ir)&&(Ir!=3||this.g&&(this.h.h||this.g.oa()||h1(this.g)))){this.J||Ir!=4||_==7||(_==8||0>=lo?An(3):An(2)),it(this);var A=this.g.Z();this.X=A;t:if(Ce(this)){var U=h1(this.g);f="";var re=U.length,se=Vi(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){dt(this),Ke(this);var Te="";break t}this.h.i=new o.TextDecoder}for(_=0;_<re;_++)this.h.h=!0,f+=this.h.i.decode(U[_],{stream:!(se&&_==re-1)});U.length=0,this.h.g+=f,this.C=0,Te=this.h.g}else Te=this.g.oa();if(this.o=A==200,Ae(this.i,this.u,this.A,this.l,this.R,Ir,A),this.o){if(this.T&&!this.K){t:{if(this.g){var _t,pr=this.g;if((_t=pr.g?pr.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!w(_t)){var lt=_t;break t}}lt=null}if(A=lt)I(this.i,this.l,A,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,tn(this,A);else{this.o=!1,this.s=3,Zt(12),dt(this),Ke(this);break e}}if(this.P){A=!0;let zn;for(;!this.J&&this.C<Te.length;)if(zn=me(this,Te),zn==Y){Ir==4&&(this.s=4,Zt(14),A=!1),I(this.i,this.l,null,"[Incomplete Response]");break}else if(zn==J){this.s=4,Zt(15),I(this.i,this.l,Te,"[Invalid Chunk]"),A=!1;break}else I(this.i,this.l,zn,null),tn(this,zn);if(Ce(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Ir!=4||Te.length!=0||this.h.h||(this.s=1,Zt(16),A=!1),this.o=this.o&&A,!A)I(this.i,this.l,Te,"[Invalid Chunked Response]"),dt(this),Ke(this);else if(0<Te.length&&!this.W){this.W=!0;var Ar=this.j;Ar.g==this&&Ar.ba&&!Ar.M&&(Ar.j.info("Great, no buffering proxy detected. Bytes received: "+Te.length),Y0(Ar),Ar.M=!0,Zt(11))}}else I(this.i,this.l,Te,null),tn(this,Te);Ir==4&&dt(this),this.o&&!this.J&&(Ir==4?_1(this.j,this):(this.o=!1,we(this)))}else NI(this.g),A==400&&0<Te.indexOf("Unknown SID")?(this.s=3,Zt(12)):(this.s=0,Zt(13)),dt(this),Ke(this)}}}catch{}finally{}};function Ce(f){return f.g?f.u=="GET"&&f.L!=2&&f.j.Ca:!1}function me(f,_){var A=f.C,U=_.indexOf(`
`,A);return U==-1?Y:(A=Number(_.substring(A,U)),isNaN(A)?J:(U+=1,U+A>_.length?Y:(_=_.slice(U,U+A),f.C=U+A,_)))}te.prototype.cancel=function(){this.J=!0,dt(this)};function we(f){f.S=Date.now()+f.I,De(f,f.I)}function De(f,_){if(f.B!=null)throw Error("WatchDog timer not null");f.B=Q(d(f.ba,f),_)}function it(f){f.B&&(o.clearTimeout(f.B),f.B=null)}te.prototype.ba=function(){this.B=null;const f=Date.now();0<=f-this.S?(V(this.i,this.A),this.L!=2&&(An(),Zt(17)),dt(this),this.s=2,Ke(this)):De(this,this.S-f)};function Ke(f){f.j.G==0||f.J||_1(f.j,f)}function dt(f){it(f);var _=f.M;_&&typeof _.ma=="function"&&_.ma(),f.M=null,fn(f.U),f.g&&(_=f.g,f.g=null,_.abort(),_.ma())}function tn(f,_){try{var A=f.j;if(A.G!=0&&(A.g==f||Ze(A.h,f))){if(!f.K&&Ze(A.h,f)&&A.G==3){try{var U=A.Da.g.parse(_)}catch{U=null}if(Array.isArray(U)&&U.length==3){var re=U;if(re[0]==0){e:if(!A.u){if(A.g)if(A.g.F+3e3<f.F)Hu(A),zu(A);else break e;X0(A),Zt(18)}}else A.za=re[1],0<A.za-A.T&&37500>re[2]&&A.F&&A.v==0&&!A.C&&(A.C=Q(d(A.Za,A),6e3));if(1>=In(A.h)&&A.ca){try{A.ca()}catch{}A.ca=void 0}}else la(A,11)}else if((f.K||A.g==f)&&Hu(A),!w(_))for(re=A.Da.g.parse(_),_=0;_<re.length;_++){let lt=re[_];if(A.T=lt[0],lt=lt[1],A.G==2)if(lt[0]=="c"){A.K=lt[1],A.ia=lt[2];const Ar=lt[3];Ar!=null&&(A.la=Ar,A.j.info("VER="+A.la));const Ir=lt[4];Ir!=null&&(A.Aa=Ir,A.j.info("SVER="+A.Aa));const lo=lt[5];lo!=null&&typeof lo=="number"&&0<lo&&(U=1.5*lo,A.L=U,A.j.info("backChannelRequestTimeoutMs_="+U)),U=A;const zn=f.g;if(zn){const Gu=zn.g?zn.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Gu){var se=U.h;se.g||Gu.indexOf("spdy")==-1&&Gu.indexOf("quic")==-1&&Gu.indexOf("h2")==-1||(se.j=se.l,se.g=new Set,se.h&&(ci(se,se.h),se.h=null))}if(U.D){const Q0=zn.g?zn.g.getResponseHeader("X-HTTP-Session-Id"):null;Q0&&(U.ya=Q0,St(U.I,U.D,Q0))}}A.G=3,A.l&&A.l.ua(),A.ba&&(A.R=Date.now()-f.F,A.j.info("Handshake RTT: "+A.R+"ms")),U=A;var Te=f;if(U.qa=E1(U,U.J?U.ia:null,U.W),Te.K){El(U.h,Te);var _t=Te,pr=U.L;pr&&(_t.I=pr),_t.B&&(it(_t),we(_t)),U.g=Te}else v1(U);0<A.i.length&&$u(A)}else lt[0]!="stop"&&lt[0]!="close"||la(A,7);else A.G==3&&(lt[0]=="stop"||lt[0]=="close"?lt[0]=="stop"?la(A,7):q0(A):lt[0]!="noop"&&A.l&&A.l.ta(lt),A.v=0)}}An(4)}catch{}}var He=class{constructor(f,_){this.g=f,this.map=_}};function ft(f){this.l=f||10,o.PerformanceNavigationTiming?(f=o.performance.getEntriesByType("navigation"),f=0<f.length&&(f[0].nextHopProtocol=="hq"||f[0].nextHopProtocol=="h2")):f=!!(o.chrome&&o.chrome.loadTimes&&o.chrome.loadTimes()&&o.chrome.loadTimes().wasFetchedViaSpdy),this.j=f?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function dr(f){return f.h?!0:f.g?f.g.size>=f.j:!1}function In(f){return f.h?1:f.g?f.g.size:0}function Ze(f,_){return f.h?f.h==_:f.g?f.g.has(_):!1}function ci(f,_){f.g?f.g.add(_):f.h=_}function El(f,_){f.h&&f.h==_?f.h=null:f.g&&f.g.has(_)&&f.g.delete(_)}ft.prototype.cancel=function(){if(this.i=Ou(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const f of this.g.values())f.cancel();this.g.clear()}};function Ou(f){if(f.h!=null)return f.i.concat(f.h.D);if(f.g!=null&&f.g.size!==0){let _=f.i;for(const A of f.g.values())_=_.concat(A.D);return _}return v(f.i)}function mI(f){if(f.V&&typeof f.V=="function")return f.V();if(typeof Map<"u"&&f instanceof Map||typeof Set<"u"&&f instanceof Set)return Array.from(f.values());if(typeof f=="string")return f.split("");if(l(f)){for(var _=[],A=f.length,U=0;U<A;U++)_.push(f[U]);return _}_=[],A=0;for(U in f)_[A++]=f[U];return _}function gI(f){if(f.na&&typeof f.na=="function")return f.na();if(!f.V||typeof f.V!="function"){if(typeof Map<"u"&&f instanceof Map)return Array.from(f.keys());if(!(typeof Set<"u"&&f instanceof Set)){if(l(f)||typeof f=="string"){var _=[];f=f.length;for(var A=0;A<f;A++)_.push(A);return _}_=[],A=0;for(const U in f)_[A++]=U;return _}}}function Zv(f,_){if(f.forEach&&typeof f.forEach=="function")f.forEach(_,void 0);else if(l(f)||typeof f=="string")Array.prototype.forEach.call(f,_,void 0);else for(var A=gI(f),U=mI(f),re=U.length,se=0;se<re;se++)_.call(void 0,U[se],A&&A[se],f)}var e1=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function vI(f,_){if(f){f=f.split("&");for(var A=0;A<f.length;A++){var U=f[A].indexOf("="),re=null;if(0<=U){var se=f[A].substring(0,U);re=f[A].substring(U+1)}else se=f[A];_(se,re?decodeURIComponent(re.replace(/\+/g," ")):"")}}}function oa(f){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,f instanceof oa){this.h=f.h,Lu(this,f.j),this.o=f.o,this.g=f.g,Mu(this,f.s),this.l=f.l;var _=f.i,A=new Sl;A.i=_.i,_.g&&(A.g=new Map(_.g),A.h=_.h),t1(this,A),this.m=f.m}else f&&(_=String(f).match(e1))?(this.h=!1,Lu(this,_[1]||"",!0),this.o=Tl(_[2]||""),this.g=Tl(_[3]||"",!0),Mu(this,_[4]),this.l=Tl(_[5]||"",!0),t1(this,_[6]||"",!0),this.m=Tl(_[7]||"")):(this.h=!1,this.i=new Sl(null,this.h))}oa.prototype.toString=function(){var f=[],_=this.j;_&&f.push(kl(_,r1,!0),":");var A=this.g;return(A||_=="file")&&(f.push("//"),(_=this.o)&&f.push(kl(_,r1,!0),"@"),f.push(encodeURIComponent(String(A)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),A=this.s,A!=null&&f.push(":",String(A))),(A=this.l)&&(this.g&&A.charAt(0)!="/"&&f.push("/"),f.push(kl(A,A.charAt(0)=="/"?yI:_I,!0))),(A=this.i.toString())&&f.push("?",A),(A=this.m)&&f.push("#",kl(A,EI)),f.join("")};function Mi(f){return new oa(f)}function Lu(f,_,A){f.j=A?Tl(_,!0):_,f.j&&(f.j=f.j.replace(/:$/,""))}function Mu(f,_){if(_){if(_=Number(_),isNaN(_)||0>_)throw Error("Bad port number "+_);f.s=_}else f.s=null}function t1(f,_,A){_ instanceof Sl?(f.i=_,TI(f.i,f.h)):(A||(_=kl(_,wI)),f.i=new Sl(_,f.h))}function St(f,_,A){f.i.set(_,A)}function Vu(f){return St(f,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),f}function Tl(f,_){return f?_?decodeURI(f.replace(/%25/g,"%2525")):decodeURIComponent(f):""}function kl(f,_,A){return typeof f=="string"?(f=encodeURI(f).replace(_,xI),A&&(f=f.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),f):null}function xI(f){return f=f.charCodeAt(0),"%"+(f>>4&15).toString(16)+(f&15).toString(16)}var r1=/[#\/\?@]/g,_I=/[#\?:]/g,yI=/[#\?]/g,wI=/[#\?@]/g,EI=/#/g;function Sl(f,_){this.h=this.g=null,this.i=f||null,this.j=!!_}function ms(f){f.g||(f.g=new Map,f.h=0,f.i&&vI(f.i,function(_,A){f.add(decodeURIComponent(_.replace(/\+/g," ")),A)}))}t=Sl.prototype,t.add=function(f,_){ms(this),this.i=null,f=ao(this,f);var A=this.g.get(f);return A||this.g.set(f,A=[]),A.push(_),this.h+=1,this};function n1(f,_){ms(f),_=ao(f,_),f.g.has(_)&&(f.i=null,f.h-=f.g.get(_).length,f.g.delete(_))}function i1(f,_){return ms(f),_=ao(f,_),f.g.has(_)}t.forEach=function(f,_){ms(this),this.g.forEach(function(A,U){A.forEach(function(re){f.call(_,re,U,this)},this)},this)},t.na=function(){ms(this);const f=Array.from(this.g.values()),_=Array.from(this.g.keys()),A=[];for(let U=0;U<_.length;U++){const re=f[U];for(let se=0;se<re.length;se++)A.push(_[U])}return A},t.V=function(f){ms(this);let _=[];if(typeof f=="string")i1(this,f)&&(_=_.concat(this.g.get(ao(this,f))));else{f=Array.from(this.g.values());for(let A=0;A<f.length;A++)_=_.concat(f[A])}return _},t.set=function(f,_){return ms(this),this.i=null,f=ao(this,f),i1(this,f)&&(this.h-=this.g.get(f).length),this.g.set(f,[_]),this.h+=1,this},t.get=function(f,_){return f?(f=this.V(f),0<f.length?String(f[0]):_):_};function s1(f,_,A){n1(f,_),0<A.length&&(f.i=null,f.g.set(ao(f,_),v(A)),f.h+=A.length)}t.toString=function(){if(this.i)return this.i;if(!this.g)return"";const f=[],_=Array.from(this.g.keys());for(var A=0;A<_.length;A++){var U=_[A];const se=encodeURIComponent(String(U)),Te=this.V(U);for(U=0;U<Te.length;U++){var re=se;Te[U]!==""&&(re+="="+encodeURIComponent(String(Te[U]))),f.push(re)}}return this.i=f.join("&")};function ao(f,_){return _=String(_),f.j&&(_=_.toLowerCase()),_}function TI(f,_){_&&!f.j&&(ms(f),f.i=null,f.g.forEach(function(A,U){var re=U.toLowerCase();U!=re&&(n1(this,U),s1(this,re,A))},f)),f.j=_}function kI(f,_){const A=new ne;if(o.Image){const U=new Image;U.onload=p(gs,A,"TestLoadImage: loaded",!0,_,U),U.onerror=p(gs,A,"TestLoadImage: error",!1,_,U),U.onabort=p(gs,A,"TestLoadImage: abort",!1,_,U),U.ontimeout=p(gs,A,"TestLoadImage: timeout",!1,_,U),o.setTimeout(function(){U.ontimeout&&U.ontimeout()},1e4),U.src=f}else _(!1)}function SI(f,_){const A=new ne,U=new AbortController,re=setTimeout(()=>{U.abort(),gs(A,"TestPingServer: timeout",!1,_)},1e4);fetch(f,{signal:U.signal}).then(se=>{clearTimeout(re),se.ok?gs(A,"TestPingServer: ok",!0,_):gs(A,"TestPingServer: server error",!1,_)}).catch(()=>{clearTimeout(re),gs(A,"TestPingServer: error",!1,_)})}function gs(f,_,A,U,re){try{re&&(re.onload=null,re.onerror=null,re.onabort=null,re.ontimeout=null),U(A)}catch{}}function AI(){this.g=new wl}function II(f,_,A){const U=A||"";try{Zv(f,function(re,se){let Te=re;c(re)&&(Te=Fi(re)),_.push(U+se+"="+encodeURIComponent(Te))})}catch(re){throw _.push(U+"type="+encodeURIComponent("_badmap")),re}}function Uu(f){this.l=f.Ub||null,this.j=f.eb||!1}x(Uu,Di),Uu.prototype.g=function(){return new ju(this.l,this.j)},Uu.prototype.i=function(f){return function(){return f}}({});function ju(f,_){vt.call(this),this.D=f,this.o=_,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}x(ju,vt),t=ju.prototype,t.open=function(f,_){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=f,this.A=_,this.readyState=1,Il(this)},t.send=function(f){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const _={headers:this.u,method:this.B,credentials:this.m,cache:void 0};f&&(_.body=f),(this.D||o).fetch(new Request(this.A,_)).then(this.Sa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,Al(this)),this.readyState=0},t.Sa=function(f){if(this.g&&(this.l=f,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=f.headers,this.readyState=2,Il(this)),this.g&&(this.readyState=3,Il(this),this.g)))if(this.responseType==="arraybuffer")f.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof o.ReadableStream<"u"&&"body"in f){if(this.j=f.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;a1(this)}else f.text().then(this.Ra.bind(this),this.ga.bind(this))};function a1(f){f.j.read().then(f.Pa.bind(f)).catch(f.ga.bind(f))}t.Pa=function(f){if(this.g){if(this.o&&f.value)this.response.push(f.value);else if(!this.o){var _=f.value?f.value:new Uint8Array(0);(_=this.v.decode(_,{stream:!f.done}))&&(this.response=this.responseText+=_)}f.done?Al(this):Il(this),this.readyState==3&&a1(this)}},t.Ra=function(f){this.g&&(this.response=this.responseText=f,Al(this))},t.Qa=function(f){this.g&&(this.response=f,Al(this))},t.ga=function(){this.g&&Al(this)};function Al(f){f.readyState=4,f.l=null,f.j=null,f.v=null,Il(f)}t.setRequestHeader=function(f,_){this.u.append(f,_)},t.getResponseHeader=function(f){return this.h&&this.h.get(f.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";const f=[],_=this.h.entries();for(var A=_.next();!A.done;)A=A.value,f.push(A[0]+": "+A[1]),A=_.next();return f.join(`\r
`)};function Il(f){f.onreadystatechange&&f.onreadystatechange.call(f)}Object.defineProperty(ju.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(f){this.m=f?"include":"same-origin"}});function o1(f){let _="";return j(f,function(A,U){_+=U,_+=":",_+=A,_+=`\r
`}),_}function K0(f,_,A){e:{for(U in A){var U=!1;break e}U=!0}U||(A=o1(A),typeof f=="string"?A!=null&&encodeURIComponent(String(A)):St(f,_,A))}function Mt(f){vt.call(this),this.headers=new Map,this.o=f||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}x(Mt,vt);var CI=/^https?$/i,RI=["POST","PUT"];t=Mt.prototype,t.Ha=function(f){this.J=f},t.ea=function(f,_,A,U){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+f);_=_?_.toUpperCase():"GET",this.D=f,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():L.g(),this.v=this.o?oi(this.o):oi(L),this.g.onreadystatechange=d(this.Ea,this);try{this.B=!0,this.g.open(_,String(f),!0),this.B=!1}catch(se){l1(this,se);return}if(f=A||"",A=new Map(this.headers),U)if(Object.getPrototypeOf(U)===Object.prototype)for(var re in U)A.set(re,U[re]);else if(typeof U.keys=="function"&&typeof U.get=="function")for(const se of U.keys())A.set(se,U.get(se));else throw Error("Unknown input type for opt_headers: "+String(U));U=Array.from(A.keys()).find(se=>se.toLowerCase()=="content-type"),re=o.FormData&&f instanceof o.FormData,!(0<=Array.prototype.indexOf.call(RI,_,void 0))||U||re||A.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[se,Te]of A)this.g.setRequestHeader(se,Te);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{f1(this),this.u=!0,this.g.send(f),this.u=!1}catch(se){l1(this,se)}};function l1(f,_){f.h=!1,f.g&&(f.j=!0,f.g.abort(),f.j=!1),f.l=_,f.m=5,c1(f),Bu(f)}function c1(f){f.A||(f.A=!0,kt(f,"complete"),kt(f,"error"))}t.abort=function(f){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=f||7,kt(this,"complete"),kt(this,"abort"),Bu(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Bu(this,!0)),Mt.aa.N.call(this)},t.Ea=function(){this.s||(this.B||this.u||this.j?u1(this):this.bb())},t.bb=function(){u1(this)};function u1(f){if(f.h&&typeof a<"u"&&(!f.v[1]||Vi(f)!=4||f.Z()!=2)){if(f.u&&Vi(f)==4)Ft(f.Ea,0,f);else if(kt(f,"readystatechange"),Vi(f)==4){f.h=!1;try{const Te=f.Z();e:switch(Te){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var _=!0;break e;default:_=!1}var A;if(!(A=_)){var U;if(U=Te===0){var re=String(f.D).match(e1)[1]||null;!re&&o.self&&o.self.location&&(re=o.self.location.protocol.slice(0,-1)),U=!CI.test(re?re.toLowerCase():"")}A=U}if(A)kt(f,"complete"),kt(f,"success");else{f.m=6;try{var se=2<Vi(f)?f.g.statusText:""}catch{se=""}f.l=se+" ["+f.Z()+"]",c1(f)}}finally{Bu(f)}}}}function Bu(f,_){if(f.g){f1(f);const A=f.g,U=f.v[0]?()=>{}:null;f.g=null,f.v=null,_||kt(f,"ready");try{A.onreadystatechange=U}catch{}}}function f1(f){f.I&&(o.clearTimeout(f.I),f.I=null)}t.isActive=function(){return!!this.g};function Vi(f){return f.g?f.g.readyState:0}t.Z=function(){try{return 2<Vi(this)?this.g.status:-1}catch{return-1}},t.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},t.Oa=function(f){if(this.g){var _=this.g.responseText;return f&&_.indexOf(f)==0&&(_=_.substring(f.length)),no(_)}};function h1(f){try{if(!f.g)return null;if("response"in f.g)return f.g.response;switch(f.H){case"":case"text":return f.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in f.g)return f.g.mozResponseArrayBuffer}return null}catch{return null}}function NI(f){const _={};f=(f.g&&2<=Vi(f)&&f.g.getAllResponseHeaders()||"").split(`\r
`);for(let U=0;U<f.length;U++){if(w(f[U]))continue;var A=F(f[U]);const re=A[0];if(A=A[1],typeof A!="string")continue;A=A.trim();const se=_[re]||[];_[re]=se,se.push(A)}g(_,function(U){return U.join(", ")})}t.Ba=function(){return this.m},t.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function Cl(f,_,A){return A&&A.internalChannelParams&&A.internalChannelParams[f]||_}function d1(f){this.Aa=0,this.i=[],this.j=new ne,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=Cl("failFast",!1,f),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=Cl("baseRetryDelayMs",5e3,f),this.cb=Cl("retryDelaySeedMs",1e4,f),this.Wa=Cl("forwardChannelMaxRetries",2,f),this.wa=Cl("forwardChannelRequestTimeoutMs",2e4,f),this.pa=f&&f.xmlHttpFactory||void 0,this.Xa=f&&f.Tb||void 0,this.Ca=f&&f.useFetchStreams||!1,this.L=void 0,this.J=f&&f.supportsCrossDomainXhr||!1,this.K="",this.h=new ft(f&&f.concurrentRequestLimit),this.Da=new AI,this.P=f&&f.fastHandshake||!1,this.O=f&&f.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=f&&f.Rb||!1,f&&f.xa&&this.j.xa(),f&&f.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&f&&f.detectBufferingProxy||!1,this.ja=void 0,f&&f.longPollingTimeout&&0<f.longPollingTimeout&&(this.ja=f.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}t=d1.prototype,t.la=8,t.G=1,t.connect=function(f,_,A,U){Zt(0),this.W=f,this.H=_||{},A&&U!==void 0&&(this.H.OSID=A,this.H.OAID=U),this.F=this.X,this.I=E1(this,null,this.W),$u(this)};function q0(f){if(p1(f),f.G==3){var _=f.U++,A=Mi(f.I);if(St(A,"SID",f.K),St(A,"RID",_),St(A,"TYPE","terminate"),Rl(f,A),_=new te(f,f.j,_),_.L=2,_.v=Vu(Mi(A)),A=!1,o.navigator&&o.navigator.sendBeacon)try{A=o.navigator.sendBeacon(_.v.toString(),"")}catch{}!A&&o.Image&&(new Image().src=_.v,A=!0),A||(_.g=T1(_.j,null),_.g.ea(_.v)),_.F=Date.now(),we(_)}w1(f)}function zu(f){f.g&&(Y0(f),f.g.cancel(),f.g=null)}function p1(f){zu(f),f.u&&(o.clearTimeout(f.u),f.u=null),Hu(f),f.h.cancel(),f.s&&(typeof f.s=="number"&&o.clearTimeout(f.s),f.s=null)}function $u(f){if(!dr(f.h)&&!f.s){f.s=!0;var _=f.Ga;oe||ue(),ie||(oe(),ie=!0),G.add(_,f),f.B=0}}function PI(f,_){return In(f.h)>=f.h.j-(f.s?1:0)?!1:f.s?(f.i=_.D.concat(f.i),!0):f.G==1||f.G==2||f.B>=(f.Va?0:f.Wa)?!1:(f.s=Q(d(f.Ga,f,_),y1(f,f.B)),f.B++,!0)}t.Ga=function(f){if(this.s)if(this.s=null,this.G==1){if(!f){this.U=Math.floor(1e5*Math.random()),f=this.U++;const re=new te(this,this.j,f);let se=this.o;if(this.S&&(se?(se=k(se),C(se,this.S)):se=this.S),this.m!==null||this.O||(re.H=se,se=null),this.P)e:{for(var _=0,A=0;A<this.i.length;A++){t:{var U=this.i[A];if("__data__"in U.map&&(U=U.map.__data__,typeof U=="string")){U=U.length;break t}U=void 0}if(U===void 0)break;if(_+=U,4096<_){_=A;break e}if(_===4096||A===this.i.length-1){_=A+1;break e}}_=1e3}else _=1e3;_=g1(this,re,_),A=Mi(this.I),St(A,"RID",f),St(A,"CVER",22),this.D&&St(A,"X-HTTP-Session-Id",this.D),Rl(this,A),se&&(this.O?_="headers="+encodeURIComponent(String(o1(se)))+"&"+_:this.m&&K0(A,this.m,se)),ci(this.h,re),this.Ua&&St(A,"TYPE","init"),this.P?(St(A,"$req",_),St(A,"SID","null"),re.T=!0,le(re,A,null)):le(re,A,_),this.G=2}}else this.G==3&&(f?m1(this,f):this.i.length==0||dr(this.h)||m1(this))};function m1(f,_){var A;_?A=_.l:A=f.U++;const U=Mi(f.I);St(U,"SID",f.K),St(U,"RID",A),St(U,"AID",f.T),Rl(f,U),f.m&&f.o&&K0(U,f.m,f.o),A=new te(f,f.j,A,f.B+1),f.m===null&&(A.H=f.o),_&&(f.i=_.D.concat(f.i)),_=g1(f,A,1e3),A.I=Math.round(.5*f.wa)+Math.round(.5*f.wa*Math.random()),ci(f.h,A),le(A,U,_)}function Rl(f,_){f.H&&j(f.H,function(A,U){St(_,U,A)}),f.l&&Zv({},function(A,U){St(_,U,A)})}function g1(f,_,A){A=Math.min(f.i.length,A);var U=f.l?d(f.l.Na,f.l,f):null;e:{var re=f.i;let se=-1;for(;;){const Te=["count="+A];se==-1?0<A?(se=re[0].g,Te.push("ofs="+se)):se=0:Te.push("ofs="+se);let _t=!0;for(let pr=0;pr<A;pr++){let lt=re[pr].g;const Ar=re[pr].map;if(lt-=se,0>lt)se=Math.max(0,re[pr].g-100),_t=!1;else try{II(Ar,Te,"req"+lt+"_")}catch{U&&U(Ar)}}if(_t){U=Te.join("&");break e}}}return f=f.i.splice(0,A),_.D=f,U}function v1(f){if(!f.g&&!f.u){f.Y=1;var _=f.Fa;oe||ue(),ie||(oe(),ie=!0),G.add(_,f),f.v=0}}function X0(f){return f.g||f.u||3<=f.v?!1:(f.Y++,f.u=Q(d(f.Fa,f),y1(f,f.v)),f.v++,!0)}t.Fa=function(){if(this.u=null,x1(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var f=2*this.R;this.j.info("BP detection timer enabled: "+f),this.A=Q(d(this.ab,this),f)}},t.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,Zt(10),zu(this),x1(this))};function Y0(f){f.A!=null&&(o.clearTimeout(f.A),f.A=null)}function x1(f){f.g=new te(f,f.j,"rpc",f.Y),f.m===null&&(f.g.H=f.o),f.g.O=0;var _=Mi(f.qa);St(_,"RID","rpc"),St(_,"SID",f.K),St(_,"AID",f.T),St(_,"CI",f.F?"0":"1"),!f.F&&f.ja&&St(_,"TO",f.ja),St(_,"TYPE","xmlhttp"),Rl(f,_),f.m&&f.o&&K0(_,f.m,f.o),f.L&&(f.g.I=f.L);var A=f.g;f=f.ia,A.L=1,A.v=Vu(Mi(_)),A.m=null,A.P=!0,ye(A,f)}t.Za=function(){this.C!=null&&(this.C=null,zu(this),X0(this),Zt(19))};function Hu(f){f.C!=null&&(o.clearTimeout(f.C),f.C=null)}function _1(f,_){var A=null;if(f.g==_){Hu(f),Y0(f),f.g=null;var U=2}else if(Ze(f.h,_))A=_.D,El(f.h,_),U=1;else return;if(f.G!=0){if(_.o)if(U==1){A=_.m?_.m.length:0,_=Date.now()-_.F;var re=f.B;U=Oi(),kt(U,new H(U,A)),$u(f)}else v1(f);else if(re=_.s,re==3||re==0&&0<_.X||!(U==1&&PI(f,_)||U==2&&X0(f)))switch(A&&0<A.length&&(_=f.h,_.i=_.i.concat(A)),re){case 1:la(f,5);break;case 4:la(f,10);break;case 3:la(f,6);break;default:la(f,2)}}}function y1(f,_){let A=f.Ta+Math.floor(Math.random()*f.cb);return f.isActive()||(A*=2),A*_}function la(f,_){if(f.j.info("Error code "+_),_==2){var A=d(f.fb,f),U=f.Xa;const re=!U;U=new oa(U||"//www.google.com/images/cleardot.gif"),o.location&&o.location.protocol=="http"||Lu(U,"https"),Vu(U),re?kI(U.toString(),A):SI(U.toString(),A)}else Zt(2);f.G=0,f.l&&f.l.sa(_),w1(f),p1(f)}t.fb=function(f){f?(this.j.info("Successfully pinged google.com"),Zt(2)):(this.j.info("Failed to ping google.com"),Zt(1))};function w1(f){if(f.G=0,f.ka=[],f.l){const _=Ou(f.h);(_.length!=0||f.i.length!=0)&&(E(f.ka,_),E(f.ka,f.i),f.h.i.length=0,v(f.i),f.i.length=0),f.l.ra()}}function E1(f,_,A){var U=A instanceof oa?Mi(A):new oa(A);if(U.g!="")_&&(U.g=_+"."+U.g),Mu(U,U.s);else{var re=o.location;U=re.protocol,_=_?_+"."+re.hostname:re.hostname,re=+re.port;var se=new oa(null);U&&Lu(se,U),_&&(se.g=_),re&&Mu(se,re),A&&(se.l=A),U=se}return A=f.D,_=f.ya,A&&_&&St(U,A,_),St(U,"VER",f.la),Rl(f,U),U}function T1(f,_,A){if(_&&!f.J)throw Error("Can't create secondary domain capable XhrIo object.");return _=f.Ca&&!f.pa?new Mt(new Uu({eb:A})):new Mt(f.pa),_.Ha(f.J),_}t.isActive=function(){return!!this.l&&this.l.isActive(this)};function k1(){}t=k1.prototype,t.ua=function(){},t.ta=function(){},t.sa=function(){},t.ra=function(){},t.isActive=function(){return!0},t.Na=function(){};function Wu(){}Wu.prototype.g=function(f,_){return new hn(f,_)};function hn(f,_){vt.call(this),this.g=new d1(_),this.l=f,this.h=_&&_.messageUrlParams||null,f=_&&_.messageHeaders||null,_&&_.clientProtocolHeaderRequired&&(f?f["X-Client-Protocol"]="webchannel":f={"X-Client-Protocol":"webchannel"}),this.g.o=f,f=_&&_.initMessageHeaders||null,_&&_.messageContentType&&(f?f["X-WebChannel-Content-Type"]=_.messageContentType:f={"X-WebChannel-Content-Type":_.messageContentType}),_&&_.va&&(f?f["X-WebChannel-Client-Profile"]=_.va:f={"X-WebChannel-Client-Profile":_.va}),this.g.S=f,(f=_&&_.Sb)&&!w(f)&&(this.g.m=f),this.v=_&&_.supportsCrossDomainXhr||!1,this.u=_&&_.sendRawJson||!1,(_=_&&_.httpSessionIdParam)&&!w(_)&&(this.g.D=_,f=this.h,f!==null&&_ in f&&(f=this.h,_ in f&&delete f[_])),this.j=new oo(this)}x(hn,vt),hn.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},hn.prototype.close=function(){q0(this.g)},hn.prototype.o=function(f){var _=this.g;if(typeof f=="string"){var A={};A.__data__=f,f=A}else this.u&&(A={},A.__data__=Fi(f),f=A);_.i.push(new He(_.Ya++,f)),_.G==3&&$u(_)},hn.prototype.N=function(){this.g.l=null,delete this.j,q0(this.g),delete this.g,hn.aa.N.call(this)};function S1(f){bi.call(this),f.__headers__&&(this.headers=f.__headers__,this.statusCode=f.__status__,delete f.__headers__,delete f.__status__);var _=f.__sm__;if(_){e:{for(const A in _){f=A;break e}f=void 0}(this.i=f)&&(f=this.i,_=_!==null&&f in _?_[f]:void 0),this.data=_}else this.data=f}x(S1,bi);function A1(){li.call(this),this.status=1}x(A1,li);function oo(f){this.g=f}x(oo,k1),oo.prototype.ua=function(){kt(this.g,"a")},oo.prototype.ta=function(f){kt(this.g,new S1(f))},oo.prototype.sa=function(f){kt(this.g,new A1)},oo.prototype.ra=function(){kt(this.g,"b")},Wu.prototype.createWebChannel=Wu.prototype.g,hn.prototype.send=hn.prototype.o,hn.prototype.open=hn.prototype.m,hn.prototype.close=hn.prototype.close,ak=function(){return new Wu},sk=function(){return Oi()},ik=Sn,em={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},D.NO_ERROR=0,D.TIMEOUT=8,D.HTTP_ERROR=6,Hf=D,O.COMPLETE="complete",nk=O,ps.EventType=Bn,Bn.OPEN="a",Bn.CLOSE="b",Bn.ERROR="c",Bn.MESSAGE="d",vt.prototype.listen=vt.prototype.K,Kl=ps,Mt.prototype.listenOnce=Mt.prototype.L,Mt.prototype.getLastError=Mt.prototype.Ka,Mt.prototype.getLastErrorCode=Mt.prototype.Ba,Mt.prototype.getStatus=Mt.prototype.Z,Mt.prototype.getResponseJson=Mt.prototype.Oa,Mt.prototype.getResponseText=Mt.prototype.oa,Mt.prototype.send=Mt.prototype.ea,Mt.prototype.setWithCredentials=Mt.prototype.Ha,rk=Mt}).apply(typeof df<"u"?df:typeof self<"u"?self:typeof window<"u"?window:{});const N_="@firebase/firestore";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fr{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}Fr.UNAUTHENTICATED=new Fr(null),Fr.GOOGLE_CREDENTIALS=new Fr("google-credentials-uid"),Fr.FIRST_PARTY=new Fr("first-party-uid"),Fr.MOCK_USER=new Fr("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let pl="10.14.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Oa=new Fg("@firebase/firestore");function Bl(){return Oa.logLevel}function Pe(t,...e){if(Oa.logLevel<=Ye.DEBUG){const r=e.map(Wg);Oa.debug(`Firestore (${pl}): ${t}`,...r)}}function os(t,...e){if(Oa.logLevel<=Ye.ERROR){const r=e.map(Wg);Oa.error(`Firestore (${pl}): ${t}`,...r)}}function el(t,...e){if(Oa.logLevel<=Ye.WARN){const r=e.map(Wg);Oa.warn(`Firestore (${pl}): ${t}`,...r)}}function Wg(t){if(typeof t=="string")return t;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(r){return JSON.stringify(r)}(t)}catch{return t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Me(t="Unexpected state"){const e=`FIRESTORE (${pl}) INTERNAL ASSERTION FAILED: `+t;throw os(e),new Error(e)}function gt(t,e){t||Me()}function Be(t,e){return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ce={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Re extends Ai{constructor(e,r){super(e,r),this.code=e,this.message=r,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yi{constructor(){this.promise=new Promise((e,r)=>{this.resolve=e,this.reject=r})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ok{constructor(e,r){this.user=r,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class x3{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,r){e.enqueueRetryable(()=>r(Fr.UNAUTHENTICATED))}shutdown(){}}class _3{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,r){this.changeListener=r,e.enqueueRetryable(()=>r(this.token.user))}shutdown(){this.changeListener=null}}class y3{constructor(e){this.t=e,this.currentUser=Fr.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,r){gt(this.o===void 0);let n=this.i;const i=l=>this.i!==n?(n=this.i,r(l)):Promise.resolve();let s=new Yi;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new Yi,e.enqueueRetryable(()=>i(this.currentUser))};const a=()=>{const l=s;e.enqueueRetryable(async()=>{await l.promise,await i(this.currentUser)})},o=l=>{Pe("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=l,this.o&&(this.auth.addAuthTokenListener(this.o),a())};this.t.onInit(l=>o(l)),setTimeout(()=>{if(!this.auth){const l=this.t.getImmediate({optional:!0});l?o(l):(Pe("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new Yi)}},0),a()}getToken(){const e=this.i,r=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(r).then(n=>this.i!==e?(Pe("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):n?(gt(typeof n.accessToken=="string"),new ok(n.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return gt(e===null||typeof e=="string"),new Fr(e)}}class w3{constructor(e,r,n){this.l=e,this.h=r,this.P=n,this.type="FirstParty",this.user=Fr.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);const e=this.T();return e&&this.I.set("Authorization",e),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}}class E3{constructor(e,r,n){this.l=e,this.h=r,this.P=n}getToken(){return Promise.resolve(new w3(this.l,this.h,this.P))}start(e,r){e.enqueueRetryable(()=>r(Fr.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class T3{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class k3{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,r){gt(this.o===void 0);const n=s=>{s.error!=null&&Pe("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);const a=s.token!==this.R;return this.R=s.token,Pe("FirebaseAppCheckTokenProvider",`Received ${a?"new":"existing"} token.`),a?r(s.token):Promise.resolve()};this.o=s=>{e.enqueueRetryable(()=>n(s))};const i=s=>{Pe("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.o&&this.appCheck.addTokenListener(this.o)};this.A.onInit(s=>i(s)),setTimeout(()=>{if(!this.appCheck){const s=this.A.getImmediate({optional:!0});s?i(s):Pe("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(r=>r?(gt(typeof r.token=="string"),this.R=r.token,new T3(r.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function S3(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),r=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(r);else for(let n=0;n<t;n++)r[n]=Math.floor(256*Math.random());return r}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lk{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",r=Math.floor(256/e.length)*e.length;let n="";for(;n.length<20;){const i=S3(40);for(let s=0;s<i.length;++s)n.length<20&&i[s]<r&&(n+=e.charAt(i[s]%e.length))}return n}}function ct(t,e){return t<e?-1:t>e?1:0}function tl(t,e,r){return t.length===e.length&&t.every((n,i)=>r(n,e[i]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ir{constructor(e,r){if(this.seconds=e,this.nanoseconds=r,r<0)throw new Re(ce.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+r);if(r>=1e9)throw new Re(ce.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+r);if(e<-62135596800)throw new Re(ce.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new Re(ce.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return ir.fromMillis(Date.now())}static fromDate(e){return ir.fromMillis(e.getTime())}static fromMillis(e){const r=Math.floor(e/1e3),n=Math.floor(1e6*(e-1e3*r));return new ir(r,n)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?ct(this.nanoseconds,e.nanoseconds):ct(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ue{constructor(e){this.timestamp=e}static fromTimestamp(e){return new Ue(e)}static min(){return new Ue(new ir(0,0))}static max(){return new Ue(new ir(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kc{constructor(e,r,n){r===void 0?r=0:r>e.length&&Me(),n===void 0?n=e.length-r:n>e.length-r&&Me(),this.segments=e,this.offset=r,this.len=n}get length(){return this.len}isEqual(e){return Kc.comparator(this,e)===0}child(e){const r=this.segments.slice(this.offset,this.limit());return e instanceof Kc?e.forEach(n=>{r.push(n)}):r.push(e),this.construct(r)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let r=0;r<this.length;r++)if(this.get(r)!==e.get(r))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let r=0;r<this.length;r++)if(this.get(r)!==e.get(r))return!1;return!0}forEach(e){for(let r=this.offset,n=this.limit();r<n;r++)e(this.segments[r])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,r){const n=Math.min(e.length,r.length);for(let i=0;i<n;i++){const s=e.get(i),a=r.get(i);if(s<a)return-1;if(s>a)return 1}return e.length<r.length?-1:e.length>r.length?1:0}}class It extends Kc{construct(e,r,n){return new It(e,r,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const r=[];for(const n of e){if(n.indexOf("//")>=0)throw new Re(ce.INVALID_ARGUMENT,`Invalid segment (${n}). Paths must not contain // in them.`);r.push(...n.split("/").filter(i=>i.length>0))}return new It(r)}static emptyPath(){return new It([])}}const A3=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class xr extends Kc{construct(e,r,n){return new xr(e,r,n)}static isValidIdentifier(e){return A3.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),xr.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new xr(["__name__"])}static fromServerFormat(e){const r=[];let n="",i=0;const s=()=>{if(n.length===0)throw new Re(ce.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);r.push(n),n=""};let a=!1;for(;i<e.length;){const o=e[i];if(o==="\\"){if(i+1===e.length)throw new Re(ce.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const l=e[i+1];if(l!=="\\"&&l!=="."&&l!=="`")throw new Re(ce.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);n+=l,i+=2}else o==="`"?(a=!a,i++):o!=="."||a?(n+=o,i++):(s(),i++)}if(s(),a)throw new Re(ce.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new xr(r)}static emptyPath(){return new xr([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fe{constructor(e){this.path=e}static fromPath(e){return new Fe(It.fromString(e))}static fromName(e){return new Fe(It.fromString(e).popFirst(5))}static empty(){return new Fe(It.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&It.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,r){return It.comparator(e.path,r.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new Fe(new It(e.slice()))}}function I3(t,e){const r=t.toTimestamp().seconds,n=t.toTimestamp().nanoseconds+1,i=Ue.fromTimestamp(n===1e9?new ir(r+1,0):new ir(r,n));return new Ys(i,Fe.empty(),e)}function C3(t){return new Ys(t.readTime,t.key,-1)}class Ys{constructor(e,r,n){this.readTime=e,this.documentKey=r,this.largestBatchId=n}static min(){return new Ys(Ue.min(),Fe.empty(),-1)}static max(){return new Ys(Ue.max(),Fe.empty(),-1)}}function R3(t,e){let r=t.readTime.compareTo(e.readTime);return r!==0?r:(r=Fe.comparator(t.documentKey,e.documentKey),r!==0?r:ct(t.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const N3="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class P3{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Eu(t){if(t.code!==ce.FAILED_PRECONDITION||t.message!==N3)throw t;Pe("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ge{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(r=>{this.isDone=!0,this.result=r,this.nextCallback&&this.nextCallback(r)},r=>{this.isDone=!0,this.error=r,this.catchCallback&&this.catchCallback(r)})}catch(e){return this.next(void 0,e)}next(e,r){return this.callbackAttached&&Me(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(r,this.error):this.wrapSuccess(e,this.result):new ge((n,i)=>{this.nextCallback=s=>{this.wrapSuccess(e,s).next(n,i)},this.catchCallback=s=>{this.wrapFailure(r,s).next(n,i)}})}toPromise(){return new Promise((e,r)=>{this.next(e,r)})}wrapUserFunction(e){try{const r=e();return r instanceof ge?r:ge.resolve(r)}catch(r){return ge.reject(r)}}wrapSuccess(e,r){return e?this.wrapUserFunction(()=>e(r)):ge.resolve(r)}wrapFailure(e,r){return e?this.wrapUserFunction(()=>e(r)):ge.reject(r)}static resolve(e){return new ge((r,n)=>{r(e)})}static reject(e){return new ge((r,n)=>{n(e)})}static waitFor(e){return new ge((r,n)=>{let i=0,s=0,a=!1;e.forEach(o=>{++i,o.next(()=>{++s,a&&s===i&&r()},l=>n(l))}),a=!0,s===i&&r()})}static or(e){let r=ge.resolve(!1);for(const n of e)r=r.next(i=>i?ge.resolve(i):n());return r}static forEach(e,r){const n=[];return e.forEach((i,s)=>{n.push(r.call(this,i,s))}),this.waitFor(n)}static mapArray(e,r){return new ge((n,i)=>{const s=e.length,a=new Array(s);let o=0;for(let l=0;l<s;l++){const c=l;r(e[c]).next(u=>{a[c]=u,++o,o===s&&n(a)},u=>i(u))}})}static doWhile(e,r){return new ge((n,i)=>{const s=()=>{e()===!0?r().next(()=>{s()},i):n()};s()})}}function F3(t){const e=t.match(/Android ([\d.]+)/i),r=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(r)}function Tu(t){return t.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gg{constructor(e,r){this.previousValue=e,r&&(r.sequenceNumberHandler=n=>this.ie(n),this.se=n=>r.writeSequenceNumber(n))}ie(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.se&&this.se(e),e}}Gg.oe=-1;function k0(t){return t==null}function Ph(t){return t===0&&1/t==-1/0}function D3(t){return typeof t=="number"&&Number.isInteger(t)&&!Ph(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function P_(t){let e=0;for(const r in t)Object.prototype.hasOwnProperty.call(t,r)&&e++;return e}function Ka(t,e){for(const r in t)Object.prototype.hasOwnProperty.call(t,r)&&e(r,t[r])}function ck(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lt{constructor(e,r){this.comparator=e,this.root=r||gr.EMPTY}insert(e,r){return new Lt(this.comparator,this.root.insert(e,r,this.comparator).copy(null,null,gr.BLACK,null,null))}remove(e){return new Lt(this.comparator,this.root.remove(e,this.comparator).copy(null,null,gr.BLACK,null,null))}get(e){let r=this.root;for(;!r.isEmpty();){const n=this.comparator(e,r.key);if(n===0)return r.value;n<0?r=r.left:n>0&&(r=r.right)}return null}indexOf(e){let r=0,n=this.root;for(;!n.isEmpty();){const i=this.comparator(e,n.key);if(i===0)return r+n.left.size;i<0?n=n.left:(r+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((r,n)=>(e(r,n),!1))}toString(){const e=[];return this.inorderTraversal((r,n)=>(e.push(`${r}:${n}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new pf(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new pf(this.root,e,this.comparator,!1)}getReverseIterator(){return new pf(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new pf(this.root,e,this.comparator,!0)}}class pf{constructor(e,r,n,i){this.isReverse=i,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=r?n(e.key,r):1,r&&i&&(s*=-1),s<0)e=this.isReverse?e.left:e.right;else{if(s===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const r={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return r}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class gr{constructor(e,r,n,i,s){this.key=e,this.value=r,this.color=n??gr.RED,this.left=i??gr.EMPTY,this.right=s??gr.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,r,n,i,s){return new gr(e??this.key,r??this.value,n??this.color,i??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,r,n){let i=this;const s=n(e,i.key);return i=s<0?i.copy(null,null,null,i.left.insert(e,r,n),null):s===0?i.copy(null,r,null,null,null):i.copy(null,null,null,null,i.right.insert(e,r,n)),i.fixUp()}removeMin(){if(this.left.isEmpty())return gr.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,r){let n,i=this;if(r(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,r),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),r(e,i.key)===0){if(i.right.isEmpty())return gr.EMPTY;n=i.right.min(),i=i.copy(n.key,n.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,r))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,gr.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,gr.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),r=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,r)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw Me();const e=this.left.check();if(e!==this.right.check())throw Me();return e+(this.isRed()?0:1)}}gr.EMPTY=null,gr.RED=!0,gr.BLACK=!1;gr.EMPTY=new class{constructor(){this.size=0}get key(){throw Me()}get value(){throw Me()}get color(){throw Me()}get left(){throw Me()}get right(){throw Me()}copy(e,r,n,i,s){return this}insert(e,r,n){return new gr(e,r)}remove(e,r){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yr{constructor(e){this.comparator=e,this.data=new Lt(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((r,n)=>(e(r),!1))}forEachInRange(e,r){const n=this.data.getIteratorFrom(e[0]);for(;n.hasNext();){const i=n.getNext();if(this.comparator(i.key,e[1])>=0)return;r(i.key)}}forEachWhile(e,r){let n;for(n=r!==void 0?this.data.getIteratorFrom(r):this.data.getIterator();n.hasNext();)if(!e(n.getNext().key))return}firstAfterOrEqual(e){const r=this.data.getIteratorFrom(e);return r.hasNext()?r.getNext().key:null}getIterator(){return new F_(this.data.getIterator())}getIteratorFrom(e){return new F_(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let r=this;return r.size<e.size&&(r=e,e=this),e.forEach(n=>{r=r.add(n)}),r}isEqual(e){if(!(e instanceof yr)||this.size!==e.size)return!1;const r=this.data.getIterator(),n=e.data.getIterator();for(;r.hasNext();){const i=r.getNext().key,s=n.getNext().key;if(this.comparator(i,s)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(r=>{e.push(r)}),e}toString(){const e=[];return this.forEach(r=>e.push(r)),"SortedSet("+e.toString()+")"}copy(e){const r=new yr(this.comparator);return r.data=e,r}}class F_{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xn{constructor(e){this.fields=e,e.sort(xr.comparator)}static empty(){return new xn([])}unionWith(e){let r=new yr(xr.comparator);for(const n of this.fields)r=r.add(n);for(const n of e)r=r.add(n);return new xn(r.toArray())}covers(e){for(const r of this.fields)if(r.isPrefixOf(e))return!0;return!1}isEqual(e){return tl(this.fields,e.fields,(r,n)=>r.isEqual(n))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uk extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kr{constructor(e){this.binaryString=e}static fromBase64String(e){const r=function(i){try{return atob(i)}catch(s){throw typeof DOMException<"u"&&s instanceof DOMException?new uk("Invalid base64 string: "+s):s}}(e);return new kr(r)}static fromUint8Array(e){const r=function(i){let s="";for(let a=0;a<i.length;++a)s+=String.fromCharCode(i[a]);return s}(e);return new kr(r)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(r){return btoa(r)}(this.binaryString)}toUint8Array(){return function(r){const n=new Uint8Array(r.length);for(let i=0;i<r.length;i++)n[i]=r.charCodeAt(i);return n}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return ct(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}kr.EMPTY_BYTE_STRING=new kr("");const b3=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Qs(t){if(gt(!!t),typeof t=="string"){let e=0;const r=b3.exec(t);if(gt(!!r),r[1]){let i=r[1];i=(i+"000000000").substr(0,9),e=Number(i)}const n=new Date(t);return{seconds:Math.floor(n.getTime()/1e3),nanos:e}}return{seconds:zt(t.seconds),nanos:zt(t.nanos)}}function zt(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function La(t){return typeof t=="string"?kr.fromBase64String(t):kr.fromUint8Array(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Kg(t){var e,r;return((r=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||r===void 0?void 0:r.stringValue)==="server_timestamp"}function qg(t){const e=t.mapValue.fields.__previous_value__;return Kg(e)?qg(e):e}function qc(t){const e=Qs(t.mapValue.fields.__local_write_time__.timestampValue);return new ir(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class O3{constructor(e,r,n,i,s,a,o,l,c){this.databaseId=e,this.appId=r,this.persistenceKey=n,this.host=i,this.ssl=s,this.forceLongPolling=a,this.autoDetectLongPolling=o,this.longPollingOptions=l,this.useFetchStreams=c}}class Xc{constructor(e,r){this.projectId=e,this.database=r||"(default)"}static empty(){return new Xc("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(e){return e instanceof Xc&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mf={mapValue:{}};function Ma(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?Kg(t)?4:M3(t)?9007199254740991:L3(t)?10:11:Me()}function Ei(t,e){if(t===e)return!0;const r=Ma(t);if(r!==Ma(e))return!1;switch(r){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return qc(t).isEqual(qc(e));case 3:return function(i,s){if(typeof i.timestampValue=="string"&&typeof s.timestampValue=="string"&&i.timestampValue.length===s.timestampValue.length)return i.timestampValue===s.timestampValue;const a=Qs(i.timestampValue),o=Qs(s.timestampValue);return a.seconds===o.seconds&&a.nanos===o.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(i,s){return La(i.bytesValue).isEqual(La(s.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(i,s){return zt(i.geoPointValue.latitude)===zt(s.geoPointValue.latitude)&&zt(i.geoPointValue.longitude)===zt(s.geoPointValue.longitude)}(t,e);case 2:return function(i,s){if("integerValue"in i&&"integerValue"in s)return zt(i.integerValue)===zt(s.integerValue);if("doubleValue"in i&&"doubleValue"in s){const a=zt(i.doubleValue),o=zt(s.doubleValue);return a===o?Ph(a)===Ph(o):isNaN(a)&&isNaN(o)}return!1}(t,e);case 9:return tl(t.arrayValue.values||[],e.arrayValue.values||[],Ei);case 10:case 11:return function(i,s){const a=i.mapValue.fields||{},o=s.mapValue.fields||{};if(P_(a)!==P_(o))return!1;for(const l in a)if(a.hasOwnProperty(l)&&(o[l]===void 0||!Ei(a[l],o[l])))return!1;return!0}(t,e);default:return Me()}}function Yc(t,e){return(t.values||[]).find(r=>Ei(r,e))!==void 0}function rl(t,e){if(t===e)return 0;const r=Ma(t),n=Ma(e);if(r!==n)return ct(r,n);switch(r){case 0:case 9007199254740991:return 0;case 1:return ct(t.booleanValue,e.booleanValue);case 2:return function(s,a){const o=zt(s.integerValue||s.doubleValue),l=zt(a.integerValue||a.doubleValue);return o<l?-1:o>l?1:o===l?0:isNaN(o)?isNaN(l)?0:-1:1}(t,e);case 3:return D_(t.timestampValue,e.timestampValue);case 4:return D_(qc(t),qc(e));case 5:return ct(t.stringValue,e.stringValue);case 6:return function(s,a){const o=La(s),l=La(a);return o.compareTo(l)}(t.bytesValue,e.bytesValue);case 7:return function(s,a){const o=s.split("/"),l=a.split("/");for(let c=0;c<o.length&&c<l.length;c++){const u=ct(o[c],l[c]);if(u!==0)return u}return ct(o.length,l.length)}(t.referenceValue,e.referenceValue);case 8:return function(s,a){const o=ct(zt(s.latitude),zt(a.latitude));return o!==0?o:ct(zt(s.longitude),zt(a.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return b_(t.arrayValue,e.arrayValue);case 10:return function(s,a){var o,l,c,u;const h=s.fields||{},d=a.fields||{},p=(o=h.value)===null||o===void 0?void 0:o.arrayValue,x=(l=d.value)===null||l===void 0?void 0:l.arrayValue,v=ct(((c=p==null?void 0:p.values)===null||c===void 0?void 0:c.length)||0,((u=x==null?void 0:x.values)===null||u===void 0?void 0:u.length)||0);return v!==0?v:b_(p,x)}(t.mapValue,e.mapValue);case 11:return function(s,a){if(s===mf.mapValue&&a===mf.mapValue)return 0;if(s===mf.mapValue)return 1;if(a===mf.mapValue)return-1;const o=s.fields||{},l=Object.keys(o),c=a.fields||{},u=Object.keys(c);l.sort(),u.sort();for(let h=0;h<l.length&&h<u.length;++h){const d=ct(l[h],u[h]);if(d!==0)return d;const p=rl(o[l[h]],c[u[h]]);if(p!==0)return p}return ct(l.length,u.length)}(t.mapValue,e.mapValue);default:throw Me()}}function D_(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return ct(t,e);const r=Qs(t),n=Qs(e),i=ct(r.seconds,n.seconds);return i!==0?i:ct(r.nanos,n.nanos)}function b_(t,e){const r=t.values||[],n=e.values||[];for(let i=0;i<r.length&&i<n.length;++i){const s=rl(r[i],n[i]);if(s)return s}return ct(r.length,n.length)}function nl(t){return tm(t)}function tm(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(r){const n=Qs(r);return`time(${n.seconds},${n.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(r){return La(r).toBase64()}(t.bytesValue):"referenceValue"in t?function(r){return Fe.fromName(r).toString()}(t.referenceValue):"geoPointValue"in t?function(r){return`geo(${r.latitude},${r.longitude})`}(t.geoPointValue):"arrayValue"in t?function(r){let n="[",i=!0;for(const s of r.values||[])i?i=!1:n+=",",n+=tm(s);return n+"]"}(t.arrayValue):"mapValue"in t?function(r){const n=Object.keys(r.fields||{}).sort();let i="{",s=!0;for(const a of n)s?s=!1:i+=",",i+=`${a}:${tm(r.fields[a])}`;return i+"}"}(t.mapValue):Me()}function O_(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function rm(t){return!!t&&"integerValue"in t}function Xg(t){return!!t&&"arrayValue"in t}function L_(t){return!!t&&"nullValue"in t}function M_(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function Wf(t){return!!t&&"mapValue"in t}function L3(t){var e,r;return((r=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||r===void 0?void 0:r.stringValue)==="__vector__"}function hc(t){if(t.geoPointValue)return{geoPointValue:Object.assign({},t.geoPointValue)};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:Object.assign({},t.timestampValue)};if(t.mapValue){const e={mapValue:{fields:{}}};return Ka(t.mapValue.fields,(r,n)=>e.mapValue.fields[r]=hc(n)),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let r=0;r<(t.arrayValue.values||[]).length;++r)e.arrayValue.values[r]=hc(t.arrayValue.values[r]);return e}return Object.assign({},t)}function M3(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class an{constructor(e){this.value=e}static empty(){return new an({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let r=this.value;for(let n=0;n<e.length-1;++n)if(r=(r.mapValue.fields||{})[e.get(n)],!Wf(r))return null;return r=(r.mapValue.fields||{})[e.lastSegment()],r||null}}set(e,r){this.getFieldsMap(e.popLast())[e.lastSegment()]=hc(r)}setAll(e){let r=xr.emptyPath(),n={},i=[];e.forEach((a,o)=>{if(!r.isImmediateParentOf(o)){const l=this.getFieldsMap(r);this.applyChanges(l,n,i),n={},i=[],r=o.popLast()}a?n[o.lastSegment()]=hc(a):i.push(o.lastSegment())});const s=this.getFieldsMap(r);this.applyChanges(s,n,i)}delete(e){const r=this.field(e.popLast());Wf(r)&&r.mapValue.fields&&delete r.mapValue.fields[e.lastSegment()]}isEqual(e){return Ei(this.value,e.value)}getFieldsMap(e){let r=this.value;r.mapValue.fields||(r.mapValue={fields:{}});for(let n=0;n<e.length;++n){let i=r.mapValue.fields[e.get(n)];Wf(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},r.mapValue.fields[e.get(n)]=i),r=i}return r.mapValue.fields}applyChanges(e,r,n){Ka(r,(i,s)=>e[i]=s);for(const i of n)delete e[i]}clone(){return new an(hc(this.value))}}function fk(t){const e=[];return Ka(t.fields,(r,n)=>{const i=new xr([r]);if(Wf(n)){const s=fk(n.mapValue).fields;if(s.length===0)e.push(i);else for(const a of s)e.push(i.child(a))}else e.push(i)}),new xn(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Or{constructor(e,r,n,i,s,a,o){this.key=e,this.documentType=r,this.version=n,this.readTime=i,this.createTime=s,this.data=a,this.documentState=o}static newInvalidDocument(e){return new Or(e,0,Ue.min(),Ue.min(),Ue.min(),an.empty(),0)}static newFoundDocument(e,r,n,i){return new Or(e,1,r,Ue.min(),n,i,0)}static newNoDocument(e,r){return new Or(e,2,r,Ue.min(),Ue.min(),an.empty(),0)}static newUnknownDocument(e,r){return new Or(e,3,r,Ue.min(),Ue.min(),an.empty(),2)}convertToFoundDocument(e,r){return!this.createTime.isEqual(Ue.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=r,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=an.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=an.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Ue.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof Or&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Or(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fh{constructor(e,r){this.position=e,this.inclusive=r}}function V_(t,e,r){let n=0;for(let i=0;i<t.position.length;i++){const s=e[i],a=t.position[i];if(s.field.isKeyField()?n=Fe.comparator(Fe.fromName(a.referenceValue),r.key):n=rl(a,r.data.field(s.field)),s.dir==="desc"&&(n*=-1),n!==0)break}return n}function U_(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let r=0;r<t.position.length;r++)if(!Ei(t.position[r],e.position[r]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qc{constructor(e,r="asc"){this.field=e,this.dir=r}}function V3(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hk{}class Qt extends hk{constructor(e,r,n){super(),this.field=e,this.op=r,this.value=n}static create(e,r,n){return e.isKeyField()?r==="in"||r==="not-in"?this.createKeyFieldInFilter(e,r,n):new j3(e,r,n):r==="array-contains"?new $3(e,n):r==="in"?new H3(e,n):r==="not-in"?new W3(e,n):r==="array-contains-any"?new G3(e,n):new Qt(e,r,n)}static createKeyFieldInFilter(e,r,n){return r==="in"?new B3(e,n):new z3(e,n)}matches(e){const r=e.data.field(this.field);return this.op==="!="?r!==null&&this.matchesComparison(rl(r,this.value)):r!==null&&Ma(this.value)===Ma(r)&&this.matchesComparison(rl(r,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return Me()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class si extends hk{constructor(e,r){super(),this.filters=e,this.op=r,this.ae=null}static create(e,r){return new si(e,r)}matches(e){return dk(this)?this.filters.find(r=>!r.matches(e))===void 0:this.filters.find(r=>r.matches(e))!==void 0}getFlattenedFilters(){return this.ae!==null||(this.ae=this.filters.reduce((e,r)=>e.concat(r.getFlattenedFilters()),[])),this.ae}getFilters(){return Object.assign([],this.filters)}}function dk(t){return t.op==="and"}function pk(t){return U3(t)&&dk(t)}function U3(t){for(const e of t.filters)if(e instanceof si)return!1;return!0}function nm(t){if(t instanceof Qt)return t.field.canonicalString()+t.op.toString()+nl(t.value);if(pk(t))return t.filters.map(e=>nm(e)).join(",");{const e=t.filters.map(r=>nm(r)).join(",");return`${t.op}(${e})`}}function mk(t,e){return t instanceof Qt?function(n,i){return i instanceof Qt&&n.op===i.op&&n.field.isEqual(i.field)&&Ei(n.value,i.value)}(t,e):t instanceof si?function(n,i){return i instanceof si&&n.op===i.op&&n.filters.length===i.filters.length?n.filters.reduce((s,a,o)=>s&&mk(a,i.filters[o]),!0):!1}(t,e):void Me()}function gk(t){return t instanceof Qt?function(r){return`${r.field.canonicalString()} ${r.op} ${nl(r.value)}`}(t):t instanceof si?function(r){return r.op.toString()+" {"+r.getFilters().map(gk).join(" ,")+"}"}(t):"Filter"}class j3 extends Qt{constructor(e,r,n){super(e,r,n),this.key=Fe.fromName(n.referenceValue)}matches(e){const r=Fe.comparator(e.key,this.key);return this.matchesComparison(r)}}class B3 extends Qt{constructor(e,r){super(e,"in",r),this.keys=vk("in",r)}matches(e){return this.keys.some(r=>r.isEqual(e.key))}}class z3 extends Qt{constructor(e,r){super(e,"not-in",r),this.keys=vk("not-in",r)}matches(e){return!this.keys.some(r=>r.isEqual(e.key))}}function vk(t,e){var r;return(((r=e.arrayValue)===null||r===void 0?void 0:r.values)||[]).map(n=>Fe.fromName(n.referenceValue))}class $3 extends Qt{constructor(e,r){super(e,"array-contains",r)}matches(e){const r=e.data.field(this.field);return Xg(r)&&Yc(r.arrayValue,this.value)}}class H3 extends Qt{constructor(e,r){super(e,"in",r)}matches(e){const r=e.data.field(this.field);return r!==null&&Yc(this.value.arrayValue,r)}}class W3 extends Qt{constructor(e,r){super(e,"not-in",r)}matches(e){if(Yc(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const r=e.data.field(this.field);return r!==null&&!Yc(this.value.arrayValue,r)}}class G3 extends Qt{constructor(e,r){super(e,"array-contains-any",r)}matches(e){const r=e.data.field(this.field);return!(!Xg(r)||!r.arrayValue.values)&&r.arrayValue.values.some(n=>Yc(this.value.arrayValue,n))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class K3{constructor(e,r=null,n=[],i=[],s=null,a=null,o=null){this.path=e,this.collectionGroup=r,this.orderBy=n,this.filters=i,this.limit=s,this.startAt=a,this.endAt=o,this.ue=null}}function j_(t,e=null,r=[],n=[],i=null,s=null,a=null){return new K3(t,e,r,n,i,s,a)}function Yg(t){const e=Be(t);if(e.ue===null){let r=e.path.canonicalString();e.collectionGroup!==null&&(r+="|cg:"+e.collectionGroup),r+="|f:",r+=e.filters.map(n=>nm(n)).join(","),r+="|ob:",r+=e.orderBy.map(n=>function(s){return s.field.canonicalString()+s.dir}(n)).join(","),k0(e.limit)||(r+="|l:",r+=e.limit),e.startAt&&(r+="|lb:",r+=e.startAt.inclusive?"b:":"a:",r+=e.startAt.position.map(n=>nl(n)).join(",")),e.endAt&&(r+="|ub:",r+=e.endAt.inclusive?"a:":"b:",r+=e.endAt.position.map(n=>nl(n)).join(",")),e.ue=r}return e.ue}function Qg(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let r=0;r<t.orderBy.length;r++)if(!V3(t.orderBy[r],e.orderBy[r]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let r=0;r<t.filters.length;r++)if(!mk(t.filters[r],e.filters[r]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!U_(t.startAt,e.startAt)&&U_(t.endAt,e.endAt)}function im(t){return Fe.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ml{constructor(e,r=null,n=[],i=[],s=null,a="F",o=null,l=null){this.path=e,this.collectionGroup=r,this.explicitOrderBy=n,this.filters=i,this.limit=s,this.limitType=a,this.startAt=o,this.endAt=l,this.ce=null,this.le=null,this.he=null,this.startAt,this.endAt}}function q3(t,e,r,n,i,s,a,o){return new ml(t,e,r,n,i,s,a,o)}function Jg(t){return new ml(t)}function B_(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function xk(t){return t.collectionGroup!==null}function dc(t){const e=Be(t);if(e.ce===null){e.ce=[];const r=new Set;for(const s of e.explicitOrderBy)e.ce.push(s),r.add(s.field.canonicalString());const n=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(a){let o=new yr(xr.comparator);return a.filters.forEach(l=>{l.getFlattenedFilters().forEach(c=>{c.isInequality()&&(o=o.add(c.field))})}),o})(e).forEach(s=>{r.has(s.canonicalString())||s.isKeyField()||e.ce.push(new Qc(s,n))}),r.has(xr.keyField().canonicalString())||e.ce.push(new Qc(xr.keyField(),n))}return e.ce}function _i(t){const e=Be(t);return e.le||(e.le=X3(e,dc(t))),e.le}function X3(t,e){if(t.limitType==="F")return j_(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map(i=>{const s=i.dir==="desc"?"asc":"desc";return new Qc(i.field,s)});const r=t.endAt?new Fh(t.endAt.position,t.endAt.inclusive):null,n=t.startAt?new Fh(t.startAt.position,t.startAt.inclusive):null;return j_(t.path,t.collectionGroup,e,t.filters,t.limit,r,n)}}function sm(t,e){const r=t.filters.concat([e]);return new ml(t.path,t.collectionGroup,t.explicitOrderBy.slice(),r,t.limit,t.limitType,t.startAt,t.endAt)}function am(t,e,r){return new ml(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,r,t.startAt,t.endAt)}function S0(t,e){return Qg(_i(t),_i(e))&&t.limitType===e.limitType}function _k(t){return`${Yg(_i(t))}|lt:${t.limitType}`}function po(t){return`Query(target=${function(r){let n=r.path.canonicalString();return r.collectionGroup!==null&&(n+=" collectionGroup="+r.collectionGroup),r.filters.length>0&&(n+=`, filters: [${r.filters.map(i=>gk(i)).join(", ")}]`),k0(r.limit)||(n+=", limit: "+r.limit),r.orderBy.length>0&&(n+=`, orderBy: [${r.orderBy.map(i=>function(a){return`${a.field.canonicalString()} (${a.dir})`}(i)).join(", ")}]`),r.startAt&&(n+=", startAt: ",n+=r.startAt.inclusive?"b:":"a:",n+=r.startAt.position.map(i=>nl(i)).join(",")),r.endAt&&(n+=", endAt: ",n+=r.endAt.inclusive?"a:":"b:",n+=r.endAt.position.map(i=>nl(i)).join(",")),`Target(${n})`}(_i(t))}; limitType=${t.limitType})`}function A0(t,e){return e.isFoundDocument()&&function(n,i){const s=i.key.path;return n.collectionGroup!==null?i.key.hasCollectionId(n.collectionGroup)&&n.path.isPrefixOf(s):Fe.isDocumentKey(n.path)?n.path.isEqual(s):n.path.isImmediateParentOf(s)}(t,e)&&function(n,i){for(const s of dc(n))if(!s.field.isKeyField()&&i.data.field(s.field)===null)return!1;return!0}(t,e)&&function(n,i){for(const s of n.filters)if(!s.matches(i))return!1;return!0}(t,e)&&function(n,i){return!(n.startAt&&!function(a,o,l){const c=V_(a,o,l);return a.inclusive?c<=0:c<0}(n.startAt,dc(n),i)||n.endAt&&!function(a,o,l){const c=V_(a,o,l);return a.inclusive?c>=0:c>0}(n.endAt,dc(n),i))}(t,e)}function Y3(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function yk(t){return(e,r)=>{let n=!1;for(const i of dc(t)){const s=Q3(i,e,r);if(s!==0)return s;n=n||i.field.isKeyField()}return 0}}function Q3(t,e,r){const n=t.field.isKeyField()?Fe.comparator(e.key,r.key):function(s,a,o){const l=a.data.field(s),c=o.data.field(s);return l!==null&&c!==null?rl(l,c):Me()}(t.field,e,r);switch(t.dir){case"asc":return n;case"desc":return-1*n;default:return Me()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gl{constructor(e,r){this.mapKeyFn=e,this.equalsFn=r,this.inner={},this.innerSize=0}get(e){const r=this.mapKeyFn(e),n=this.inner[r];if(n!==void 0){for(const[i,s]of n)if(this.equalsFn(i,e))return s}}has(e){return this.get(e)!==void 0}set(e,r){const n=this.mapKeyFn(e),i=this.inner[n];if(i===void 0)return this.inner[n]=[[e,r]],void this.innerSize++;for(let s=0;s<i.length;s++)if(this.equalsFn(i[s][0],e))return void(i[s]=[e,r]);i.push([e,r]),this.innerSize++}delete(e){const r=this.mapKeyFn(e),n=this.inner[r];if(n===void 0)return!1;for(let i=0;i<n.length;i++)if(this.equalsFn(n[i][0],e))return n.length===1?delete this.inner[r]:n.splice(i,1),this.innerSize--,!0;return!1}forEach(e){Ka(this.inner,(r,n)=>{for(const[i,s]of n)e(i,s)})}isEmpty(){return ck(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const J3=new Lt(Fe.comparator);function ls(){return J3}const wk=new Lt(Fe.comparator);function ql(...t){let e=wk;for(const r of t)e=e.insert(r.key,r);return e}function Ek(t){let e=wk;return t.forEach((r,n)=>e=e.insert(r,n.overlayedDocument)),e}function ya(){return pc()}function Tk(){return pc()}function pc(){return new gl(t=>t.toString(),(t,e)=>t.isEqual(e))}const Z3=new Lt(Fe.comparator),eb=new yr(Fe.comparator);function Xe(...t){let e=eb;for(const r of t)e=e.add(r);return e}const tb=new yr(ct);function rb(){return tb}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Zg(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Ph(e)?"-0":e}}function kk(t){return{integerValue:""+t}}function nb(t,e){return D3(e)?kk(e):Zg(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class I0{constructor(){this._=void 0}}function ib(t,e,r){return t instanceof Jc?function(i,s){const a={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return s&&Kg(s)&&(s=qg(s)),s&&(a.fields.__previous_value__=s),{mapValue:a}}(r,e):t instanceof Zc?Ak(t,e):t instanceof eu?Ik(t,e):function(i,s){const a=Sk(i,s),o=z_(a)+z_(i.Pe);return rm(a)&&rm(i.Pe)?kk(o):Zg(i.serializer,o)}(t,e)}function sb(t,e,r){return t instanceof Zc?Ak(t,e):t instanceof eu?Ik(t,e):r}function Sk(t,e){return t instanceof Dh?function(n){return rm(n)||function(s){return!!s&&"doubleValue"in s}(n)}(e)?e:{integerValue:0}:null}class Jc extends I0{}class Zc extends I0{constructor(e){super(),this.elements=e}}function Ak(t,e){const r=Ck(e);for(const n of t.elements)r.some(i=>Ei(i,n))||r.push(n);return{arrayValue:{values:r}}}class eu extends I0{constructor(e){super(),this.elements=e}}function Ik(t,e){let r=Ck(e);for(const n of t.elements)r=r.filter(i=>!Ei(i,n));return{arrayValue:{values:r}}}class Dh extends I0{constructor(e,r){super(),this.serializer=e,this.Pe=r}}function z_(t){return zt(t.integerValue||t.doubleValue)}function Ck(t){return Xg(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ab{constructor(e,r){this.field=e,this.transform=r}}function ob(t,e){return t.field.isEqual(e.field)&&function(n,i){return n instanceof Zc&&i instanceof Zc||n instanceof eu&&i instanceof eu?tl(n.elements,i.elements,Ei):n instanceof Dh&&i instanceof Dh?Ei(n.Pe,i.Pe):n instanceof Jc&&i instanceof Jc}(t.transform,e.transform)}class lb{constructor(e,r){this.version=e,this.transformResults=r}}class Ln{constructor(e,r){this.updateTime=e,this.exists=r}static none(){return new Ln}static exists(e){return new Ln(void 0,e)}static updateTime(e){return new Ln(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Gf(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class C0{}function Rk(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new ev(t.key,Ln.none()):new ku(t.key,t.data,Ln.none());{const r=t.data,n=an.empty();let i=new yr(xr.comparator);for(let s of e.fields)if(!i.has(s)){let a=r.field(s);a===null&&s.length>1&&(s=s.popLast(),a=r.field(s)),a===null?n.delete(s):n.set(s,a),i=i.add(s)}return new sa(t.key,n,new xn(i.toArray()),Ln.none())}}function cb(t,e,r){t instanceof ku?function(i,s,a){const o=i.value.clone(),l=H_(i.fieldTransforms,s,a.transformResults);o.setAll(l),s.convertToFoundDocument(a.version,o).setHasCommittedMutations()}(t,e,r):t instanceof sa?function(i,s,a){if(!Gf(i.precondition,s))return void s.convertToUnknownDocument(a.version);const o=H_(i.fieldTransforms,s,a.transformResults),l=s.data;l.setAll(Nk(i)),l.setAll(o),s.convertToFoundDocument(a.version,l).setHasCommittedMutations()}(t,e,r):function(i,s,a){s.convertToNoDocument(a.version).setHasCommittedMutations()}(0,e,r)}function mc(t,e,r,n){return t instanceof ku?function(s,a,o,l){if(!Gf(s.precondition,a))return o;const c=s.value.clone(),u=W_(s.fieldTransforms,l,a);return c.setAll(u),a.convertToFoundDocument(a.version,c).setHasLocalMutations(),null}(t,e,r,n):t instanceof sa?function(s,a,o,l){if(!Gf(s.precondition,a))return o;const c=W_(s.fieldTransforms,l,a),u=a.data;return u.setAll(Nk(s)),u.setAll(c),a.convertToFoundDocument(a.version,u).setHasLocalMutations(),o===null?null:o.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map(h=>h.field))}(t,e,r,n):function(s,a,o){return Gf(s.precondition,a)?(a.convertToNoDocument(a.version).setHasLocalMutations(),null):o}(t,e,r)}function ub(t,e){let r=null;for(const n of t.fieldTransforms){const i=e.data.field(n.field),s=Sk(n.transform,i||null);s!=null&&(r===null&&(r=an.empty()),r.set(n.field,s))}return r||null}function $_(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(n,i){return n===void 0&&i===void 0||!(!n||!i)&&tl(n,i,(s,a)=>ob(s,a))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class ku extends C0{constructor(e,r,n,i=[]){super(),this.key=e,this.value=r,this.precondition=n,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}}class sa extends C0{constructor(e,r,n,i,s=[]){super(),this.key=e,this.data=r,this.fieldMask=n,this.precondition=i,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}}function Nk(t){const e=new Map;return t.fieldMask.fields.forEach(r=>{if(!r.isEmpty()){const n=t.data.field(r);e.set(r,n)}}),e}function H_(t,e,r){const n=new Map;gt(t.length===r.length);for(let i=0;i<r.length;i++){const s=t[i],a=s.transform,o=e.data.field(s.field);n.set(s.field,sb(a,o,r[i]))}return n}function W_(t,e,r){const n=new Map;for(const i of t){const s=i.transform,a=r.data.field(i.field);n.set(i.field,ib(s,a,e))}return n}class ev extends C0{constructor(e,r){super(),this.key=e,this.precondition=r,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class fb extends C0{constructor(e,r){super(),this.key=e,this.precondition=r,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hb{constructor(e,r,n,i){this.batchId=e,this.localWriteTime=r,this.baseMutations=n,this.mutations=i}applyToRemoteDocument(e,r){const n=r.mutationResults;for(let i=0;i<this.mutations.length;i++){const s=this.mutations[i];s.key.isEqual(e.key)&&cb(s,e,n[i])}}applyToLocalView(e,r){for(const n of this.baseMutations)n.key.isEqual(e.key)&&(r=mc(n,e,r,this.localWriteTime));for(const n of this.mutations)n.key.isEqual(e.key)&&(r=mc(n,e,r,this.localWriteTime));return r}applyToLocalDocumentSet(e,r){const n=Tk();return this.mutations.forEach(i=>{const s=e.get(i.key),a=s.overlayedDocument;let o=this.applyToLocalView(a,s.mutatedFields);o=r.has(i.key)?null:o;const l=Rk(a,o);l!==null&&n.set(i.key,l),a.isValidDocument()||a.convertToNoDocument(Ue.min())}),n}keys(){return this.mutations.reduce((e,r)=>e.add(r.key),Xe())}isEqual(e){return this.batchId===e.batchId&&tl(this.mutations,e.mutations,(r,n)=>$_(r,n))&&tl(this.baseMutations,e.baseMutations,(r,n)=>$_(r,n))}}class tv{constructor(e,r,n,i){this.batch=e,this.commitVersion=r,this.mutationResults=n,this.docVersions=i}static from(e,r,n){gt(e.mutations.length===n.length);let i=function(){return Z3}();const s=e.mutations;for(let a=0;a<s.length;a++)i=i.insert(s[a].key,n[a].version);return new tv(e,r,n,i)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class db{constructor(e,r){this.largestBatchId=e,this.mutation=r}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pb{constructor(e,r){this.count=e,this.unchangedNames=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Gt,et;function mb(t){switch(t){default:return Me();case ce.CANCELLED:case ce.UNKNOWN:case ce.DEADLINE_EXCEEDED:case ce.RESOURCE_EXHAUSTED:case ce.INTERNAL:case ce.UNAVAILABLE:case ce.UNAUTHENTICATED:return!1;case ce.INVALID_ARGUMENT:case ce.NOT_FOUND:case ce.ALREADY_EXISTS:case ce.PERMISSION_DENIED:case ce.FAILED_PRECONDITION:case ce.ABORTED:case ce.OUT_OF_RANGE:case ce.UNIMPLEMENTED:case ce.DATA_LOSS:return!0}}function Pk(t){if(t===void 0)return os("GRPC error has no .code"),ce.UNKNOWN;switch(t){case Gt.OK:return ce.OK;case Gt.CANCELLED:return ce.CANCELLED;case Gt.UNKNOWN:return ce.UNKNOWN;case Gt.DEADLINE_EXCEEDED:return ce.DEADLINE_EXCEEDED;case Gt.RESOURCE_EXHAUSTED:return ce.RESOURCE_EXHAUSTED;case Gt.INTERNAL:return ce.INTERNAL;case Gt.UNAVAILABLE:return ce.UNAVAILABLE;case Gt.UNAUTHENTICATED:return ce.UNAUTHENTICATED;case Gt.INVALID_ARGUMENT:return ce.INVALID_ARGUMENT;case Gt.NOT_FOUND:return ce.NOT_FOUND;case Gt.ALREADY_EXISTS:return ce.ALREADY_EXISTS;case Gt.PERMISSION_DENIED:return ce.PERMISSION_DENIED;case Gt.FAILED_PRECONDITION:return ce.FAILED_PRECONDITION;case Gt.ABORTED:return ce.ABORTED;case Gt.OUT_OF_RANGE:return ce.OUT_OF_RANGE;case Gt.UNIMPLEMENTED:return ce.UNIMPLEMENTED;case Gt.DATA_LOSS:return ce.DATA_LOSS;default:return Me()}}(et=Gt||(Gt={}))[et.OK=0]="OK",et[et.CANCELLED=1]="CANCELLED",et[et.UNKNOWN=2]="UNKNOWN",et[et.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",et[et.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",et[et.NOT_FOUND=5]="NOT_FOUND",et[et.ALREADY_EXISTS=6]="ALREADY_EXISTS",et[et.PERMISSION_DENIED=7]="PERMISSION_DENIED",et[et.UNAUTHENTICATED=16]="UNAUTHENTICATED",et[et.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",et[et.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",et[et.ABORTED=10]="ABORTED",et[et.OUT_OF_RANGE=11]="OUT_OF_RANGE",et[et.UNIMPLEMENTED=12]="UNIMPLEMENTED",et[et.INTERNAL=13]="INTERNAL",et[et.UNAVAILABLE=14]="UNAVAILABLE",et[et.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gb(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vb=new Sa([4294967295,4294967295],0);function G_(t){const e=gb().encode(t),r=new tk;return r.update(e),new Uint8Array(r.digest())}function K_(t){const e=new DataView(t.buffer),r=e.getUint32(0,!0),n=e.getUint32(4,!0),i=e.getUint32(8,!0),s=e.getUint32(12,!0);return[new Sa([r,n],0),new Sa([i,s],0)]}class rv{constructor(e,r,n){if(this.bitmap=e,this.padding=r,this.hashCount=n,r<0||r>=8)throw new Xl(`Invalid padding: ${r}`);if(n<0)throw new Xl(`Invalid hash count: ${n}`);if(e.length>0&&this.hashCount===0)throw new Xl(`Invalid hash count: ${n}`);if(e.length===0&&r!==0)throw new Xl(`Invalid padding when bitmap length is 0: ${r}`);this.Ie=8*e.length-r,this.Te=Sa.fromNumber(this.Ie)}Ee(e,r,n){let i=e.add(r.multiply(Sa.fromNumber(n)));return i.compare(vb)===1&&(i=new Sa([i.getBits(0),i.getBits(1)],0)),i.modulo(this.Te).toNumber()}de(e){return(this.bitmap[Math.floor(e/8)]&1<<e%8)!=0}mightContain(e){if(this.Ie===0)return!1;const r=G_(e),[n,i]=K_(r);for(let s=0;s<this.hashCount;s++){const a=this.Ee(n,i,s);if(!this.de(a))return!1}return!0}static create(e,r,n){const i=e%8==0?0:8-e%8,s=new Uint8Array(Math.ceil(e/8)),a=new rv(s,i,r);return n.forEach(o=>a.insert(o)),a}insert(e){if(this.Ie===0)return;const r=G_(e),[n,i]=K_(r);for(let s=0;s<this.hashCount;s++){const a=this.Ee(n,i,s);this.Ae(a)}}Ae(e){const r=Math.floor(e/8),n=e%8;this.bitmap[r]|=1<<n}}class Xl extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class R0{constructor(e,r,n,i,s){this.snapshotVersion=e,this.targetChanges=r,this.targetMismatches=n,this.documentUpdates=i,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(e,r,n){const i=new Map;return i.set(e,Su.createSynthesizedTargetChangeForCurrentChange(e,r,n)),new R0(Ue.min(),i,new Lt(ct),ls(),Xe())}}class Su{constructor(e,r,n,i,s){this.resumeToken=e,this.current=r,this.addedDocuments=n,this.modifiedDocuments=i,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(e,r,n){return new Su(n,r,Xe(),Xe(),Xe())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kf{constructor(e,r,n,i){this.Re=e,this.removedTargetIds=r,this.key=n,this.Ve=i}}class Fk{constructor(e,r){this.targetId=e,this.me=r}}class Dk{constructor(e,r,n=kr.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=r,this.resumeToken=n,this.cause=i}}class q_{constructor(){this.fe=0,this.ge=Y_(),this.pe=kr.EMPTY_BYTE_STRING,this.ye=!1,this.we=!0}get current(){return this.ye}get resumeToken(){return this.pe}get Se(){return this.fe!==0}get be(){return this.we}De(e){e.approximateByteSize()>0&&(this.we=!0,this.pe=e)}ve(){let e=Xe(),r=Xe(),n=Xe();return this.ge.forEach((i,s)=>{switch(s){case 0:e=e.add(i);break;case 2:r=r.add(i);break;case 1:n=n.add(i);break;default:Me()}}),new Su(this.pe,this.ye,e,r,n)}Ce(){this.we=!1,this.ge=Y_()}Fe(e,r){this.we=!0,this.ge=this.ge.insert(e,r)}Me(e){this.we=!0,this.ge=this.ge.remove(e)}xe(){this.fe+=1}Oe(){this.fe-=1,gt(this.fe>=0)}Ne(){this.we=!0,this.ye=!0}}class xb{constructor(e){this.Le=e,this.Be=new Map,this.ke=ls(),this.qe=X_(),this.Qe=new Lt(ct)}Ke(e){for(const r of e.Re)e.Ve&&e.Ve.isFoundDocument()?this.$e(r,e.Ve):this.Ue(r,e.key,e.Ve);for(const r of e.removedTargetIds)this.Ue(r,e.key,e.Ve)}We(e){this.forEachTarget(e,r=>{const n=this.Ge(r);switch(e.state){case 0:this.ze(r)&&n.De(e.resumeToken);break;case 1:n.Oe(),n.Se||n.Ce(),n.De(e.resumeToken);break;case 2:n.Oe(),n.Se||this.removeTarget(r);break;case 3:this.ze(r)&&(n.Ne(),n.De(e.resumeToken));break;case 4:this.ze(r)&&(this.je(r),n.De(e.resumeToken));break;default:Me()}})}forEachTarget(e,r){e.targetIds.length>0?e.targetIds.forEach(r):this.Be.forEach((n,i)=>{this.ze(i)&&r(i)})}He(e){const r=e.targetId,n=e.me.count,i=this.Je(r);if(i){const s=i.target;if(im(s))if(n===0){const a=new Fe(s.path);this.Ue(r,a,Or.newNoDocument(a,Ue.min()))}else gt(n===1);else{const a=this.Ye(r);if(a!==n){const o=this.Ze(e),l=o?this.Xe(o,e,a):1;if(l!==0){this.je(r);const c=l===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Qe=this.Qe.insert(r,c)}}}}}Ze(e){const r=e.me.unchangedNames;if(!r||!r.bits)return null;const{bits:{bitmap:n="",padding:i=0},hashCount:s=0}=r;let a,o;try{a=La(n).toUint8Array()}catch(l){if(l instanceof uk)return el("Decoding the base64 bloom filter in existence filter failed ("+l.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw l}try{o=new rv(a,i,s)}catch(l){return el(l instanceof Xl?"BloomFilter error: ":"Applying bloom filter failed: ",l),null}return o.Ie===0?null:o}Xe(e,r,n){return r.me.count===n-this.nt(e,r.targetId)?0:2}nt(e,r){const n=this.Le.getRemoteKeysForTarget(r);let i=0;return n.forEach(s=>{const a=this.Le.tt(),o=`projects/${a.projectId}/databases/${a.database}/documents/${s.path.canonicalString()}`;e.mightContain(o)||(this.Ue(r,s,null),i++)}),i}rt(e){const r=new Map;this.Be.forEach((s,a)=>{const o=this.Je(a);if(o){if(s.current&&im(o.target)){const l=new Fe(o.target.path);this.ke.get(l)!==null||this.it(a,l)||this.Ue(a,l,Or.newNoDocument(l,e))}s.be&&(r.set(a,s.ve()),s.Ce())}});let n=Xe();this.qe.forEach((s,a)=>{let o=!0;a.forEachWhile(l=>{const c=this.Je(l);return!c||c.purpose==="TargetPurposeLimboResolution"||(o=!1,!1)}),o&&(n=n.add(s))}),this.ke.forEach((s,a)=>a.setReadTime(e));const i=new R0(e,r,this.Qe,this.ke,n);return this.ke=ls(),this.qe=X_(),this.Qe=new Lt(ct),i}$e(e,r){if(!this.ze(e))return;const n=this.it(e,r.key)?2:0;this.Ge(e).Fe(r.key,n),this.ke=this.ke.insert(r.key,r),this.qe=this.qe.insert(r.key,this.st(r.key).add(e))}Ue(e,r,n){if(!this.ze(e))return;const i=this.Ge(e);this.it(e,r)?i.Fe(r,1):i.Me(r),this.qe=this.qe.insert(r,this.st(r).delete(e)),n&&(this.ke=this.ke.insert(r,n))}removeTarget(e){this.Be.delete(e)}Ye(e){const r=this.Ge(e).ve();return this.Le.getRemoteKeysForTarget(e).size+r.addedDocuments.size-r.removedDocuments.size}xe(e){this.Ge(e).xe()}Ge(e){let r=this.Be.get(e);return r||(r=new q_,this.Be.set(e,r)),r}st(e){let r=this.qe.get(e);return r||(r=new yr(ct),this.qe=this.qe.insert(e,r)),r}ze(e){const r=this.Je(e)!==null;return r||Pe("WatchChangeAggregator","Detected inactive target",e),r}Je(e){const r=this.Be.get(e);return r&&r.Se?null:this.Le.ot(e)}je(e){this.Be.set(e,new q_),this.Le.getRemoteKeysForTarget(e).forEach(r=>{this.Ue(e,r,null)})}it(e,r){return this.Le.getRemoteKeysForTarget(e).has(r)}}function X_(){return new Lt(Fe.comparator)}function Y_(){return new Lt(Fe.comparator)}const _b={asc:"ASCENDING",desc:"DESCENDING"},yb={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},wb={and:"AND",or:"OR"};class Eb{constructor(e,r){this.databaseId=e,this.useProto3Json=r}}function om(t,e){return t.useProto3Json||k0(e)?e:{value:e}}function bh(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function bk(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function Tb(t,e){return bh(t,e.toTimestamp())}function yi(t){return gt(!!t),Ue.fromTimestamp(function(r){const n=Qs(r);return new ir(n.seconds,n.nanos)}(t))}function nv(t,e){return lm(t,e).canonicalString()}function lm(t,e){const r=function(i){return new It(["projects",i.projectId,"databases",i.database])}(t).child("documents");return e===void 0?r:r.child(e)}function Ok(t){const e=It.fromString(t);return gt(jk(e)),e}function cm(t,e){return nv(t.databaseId,e.path)}function bd(t,e){const r=Ok(e);if(r.get(1)!==t.databaseId.projectId)throw new Re(ce.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+r.get(1)+" vs "+t.databaseId.projectId);if(r.get(3)!==t.databaseId.database)throw new Re(ce.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+r.get(3)+" vs "+t.databaseId.database);return new Fe(Mk(r))}function Lk(t,e){return nv(t.databaseId,e)}function kb(t){const e=Ok(t);return e.length===4?It.emptyPath():Mk(e)}function um(t){return new It(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function Mk(t){return gt(t.length>4&&t.get(4)==="documents"),t.popFirst(5)}function Q_(t,e,r){return{name:cm(t,e),fields:r.value.mapValue.fields}}function Sb(t,e){let r;if("targetChange"in e){e.targetChange;const n=function(c){return c==="NO_CHANGE"?0:c==="ADD"?1:c==="REMOVE"?2:c==="CURRENT"?3:c==="RESET"?4:Me()}(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],s=function(c,u){return c.useProto3Json?(gt(u===void 0||typeof u=="string"),kr.fromBase64String(u||"")):(gt(u===void 0||u instanceof Buffer||u instanceof Uint8Array),kr.fromUint8Array(u||new Uint8Array))}(t,e.targetChange.resumeToken),a=e.targetChange.cause,o=a&&function(c){const u=c.code===void 0?ce.UNKNOWN:Pk(c.code);return new Re(u,c.message||"")}(a);r=new Dk(n,i,s,o||null)}else if("documentChange"in e){e.documentChange;const n=e.documentChange;n.document,n.document.name,n.document.updateTime;const i=bd(t,n.document.name),s=yi(n.document.updateTime),a=n.document.createTime?yi(n.document.createTime):Ue.min(),o=new an({mapValue:{fields:n.document.fields}}),l=Or.newFoundDocument(i,s,a,o),c=n.targetIds||[],u=n.removedTargetIds||[];r=new Kf(c,u,l.key,l)}else if("documentDelete"in e){e.documentDelete;const n=e.documentDelete;n.document;const i=bd(t,n.document),s=n.readTime?yi(n.readTime):Ue.min(),a=Or.newNoDocument(i,s),o=n.removedTargetIds||[];r=new Kf([],o,a.key,a)}else if("documentRemove"in e){e.documentRemove;const n=e.documentRemove;n.document;const i=bd(t,n.document),s=n.removedTargetIds||[];r=new Kf([],s,i,null)}else{if(!("filter"in e))return Me();{e.filter;const n=e.filter;n.targetId;const{count:i=0,unchangedNames:s}=n,a=new pb(i,s),o=n.targetId;r=new Fk(o,a)}}return r}function Ab(t,e){let r;if(e instanceof ku)r={update:Q_(t,e.key,e.value)};else if(e instanceof ev)r={delete:cm(t,e.key)};else if(e instanceof sa)r={update:Q_(t,e.key,e.data),updateMask:Ob(e.fieldMask)};else{if(!(e instanceof fb))return Me();r={verify:cm(t,e.key)}}return e.fieldTransforms.length>0&&(r.updateTransforms=e.fieldTransforms.map(n=>function(s,a){const o=a.transform;if(o instanceof Jc)return{fieldPath:a.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(o instanceof Zc)return{fieldPath:a.field.canonicalString(),appendMissingElements:{values:o.elements}};if(o instanceof eu)return{fieldPath:a.field.canonicalString(),removeAllFromArray:{values:o.elements}};if(o instanceof Dh)return{fieldPath:a.field.canonicalString(),increment:o.Pe};throw Me()}(0,n))),e.precondition.isNone||(r.currentDocument=function(i,s){return s.updateTime!==void 0?{updateTime:Tb(i,s.updateTime)}:s.exists!==void 0?{exists:s.exists}:Me()}(t,e.precondition)),r}function Ib(t,e){return t&&t.length>0?(gt(e!==void 0),t.map(r=>function(i,s){let a=i.updateTime?yi(i.updateTime):yi(s);return a.isEqual(Ue.min())&&(a=yi(s)),new lb(a,i.transformResults||[])}(r,e))):[]}function Cb(t,e){return{documents:[Lk(t,e.path)]}}function Rb(t,e){const r={structuredQuery:{}},n=e.path;let i;e.collectionGroup!==null?(i=n,r.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(i=n.popLast(),r.structuredQuery.from=[{collectionId:n.lastSegment()}]),r.parent=Lk(t,i);const s=function(c){if(c.length!==0)return Uk(si.create(c,"and"))}(e.filters);s&&(r.structuredQuery.where=s);const a=function(c){if(c.length!==0)return c.map(u=>function(d){return{field:mo(d.field),direction:Fb(d.dir)}}(u))}(e.orderBy);a&&(r.structuredQuery.orderBy=a);const o=om(t,e.limit);return o!==null&&(r.structuredQuery.limit=o),e.startAt&&(r.structuredQuery.startAt=function(c){return{before:c.inclusive,values:c.position}}(e.startAt)),e.endAt&&(r.structuredQuery.endAt=function(c){return{before:!c.inclusive,values:c.position}}(e.endAt)),{_t:r,parent:i}}function Nb(t){let e=kb(t.parent);const r=t.structuredQuery,n=r.from?r.from.length:0;let i=null;if(n>0){gt(n===1);const u=r.from[0];u.allDescendants?i=u.collectionId:e=e.child(u.collectionId)}let s=[];r.where&&(s=function(h){const d=Vk(h);return d instanceof si&&pk(d)?d.getFilters():[d]}(r.where));let a=[];r.orderBy&&(a=function(h){return h.map(d=>function(x){return new Qc(go(x.field),function(E){switch(E){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(x.direction))}(d))}(r.orderBy));let o=null;r.limit&&(o=function(h){let d;return d=typeof h=="object"?h.value:h,k0(d)?null:d}(r.limit));let l=null;r.startAt&&(l=function(h){const d=!!h.before,p=h.values||[];return new Fh(p,d)}(r.startAt));let c=null;return r.endAt&&(c=function(h){const d=!h.before,p=h.values||[];return new Fh(p,d)}(r.endAt)),q3(e,i,a,s,o,"F",l,c)}function Pb(t,e){const r=function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return Me()}}(e.purpose);return r==null?null:{"goog-listen-tags":r}}function Vk(t){return t.unaryFilter!==void 0?function(r){switch(r.unaryFilter.op){case"IS_NAN":const n=go(r.unaryFilter.field);return Qt.create(n,"==",{doubleValue:NaN});case"IS_NULL":const i=go(r.unaryFilter.field);return Qt.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const s=go(r.unaryFilter.field);return Qt.create(s,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const a=go(r.unaryFilter.field);return Qt.create(a,"!=",{nullValue:"NULL_VALUE"});default:return Me()}}(t):t.fieldFilter!==void 0?function(r){return Qt.create(go(r.fieldFilter.field),function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return Me()}}(r.fieldFilter.op),r.fieldFilter.value)}(t):t.compositeFilter!==void 0?function(r){return si.create(r.compositeFilter.filters.map(n=>Vk(n)),function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return Me()}}(r.compositeFilter.op))}(t):Me()}function Fb(t){return _b[t]}function Db(t){return yb[t]}function bb(t){return wb[t]}function mo(t){return{fieldPath:t.canonicalString()}}function go(t){return xr.fromServerFormat(t.fieldPath)}function Uk(t){return t instanceof Qt?function(r){if(r.op==="=="){if(M_(r.value))return{unaryFilter:{field:mo(r.field),op:"IS_NAN"}};if(L_(r.value))return{unaryFilter:{field:mo(r.field),op:"IS_NULL"}}}else if(r.op==="!="){if(M_(r.value))return{unaryFilter:{field:mo(r.field),op:"IS_NOT_NAN"}};if(L_(r.value))return{unaryFilter:{field:mo(r.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:mo(r.field),op:Db(r.op),value:r.value}}}(t):t instanceof si?function(r){const n=r.getFilters().map(i=>Uk(i));return n.length===1?n[0]:{compositeFilter:{op:bb(r.op),filters:n}}}(t):Me()}function Ob(t){const e=[];return t.fields.forEach(r=>e.push(r.canonicalString())),{fieldPaths:e}}function jk(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fs{constructor(e,r,n,i,s=Ue.min(),a=Ue.min(),o=kr.EMPTY_BYTE_STRING,l=null){this.target=e,this.targetId=r,this.purpose=n,this.sequenceNumber=i,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=a,this.resumeToken=o,this.expectedCount=l}withSequenceNumber(e){return new Fs(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,r){return new Fs(this.target,this.targetId,this.purpose,this.sequenceNumber,r,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Fs(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Fs(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lb{constructor(e){this.ct=e}}function Mb(t){const e=Nb({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?am(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vb{constructor(){this.un=new Ub}addToCollectionParentIndex(e,r){return this.un.add(r),ge.resolve()}getCollectionParents(e,r){return ge.resolve(this.un.getEntries(r))}addFieldIndex(e,r){return ge.resolve()}deleteFieldIndex(e,r){return ge.resolve()}deleteAllFieldIndexes(e){return ge.resolve()}createTargetIndexes(e,r){return ge.resolve()}getDocumentsMatchingTarget(e,r){return ge.resolve(null)}getIndexType(e,r){return ge.resolve(0)}getFieldIndexes(e,r){return ge.resolve([])}getNextCollectionGroupToUpdate(e){return ge.resolve(null)}getMinOffset(e,r){return ge.resolve(Ys.min())}getMinOffsetFromCollectionGroup(e,r){return ge.resolve(Ys.min())}updateCollectionGroup(e,r,n){return ge.resolve()}updateIndexEntries(e,r){return ge.resolve()}}class Ub{constructor(){this.index={}}add(e){const r=e.lastSegment(),n=e.popLast(),i=this.index[r]||new yr(It.comparator),s=!i.has(n);return this.index[r]=i.add(n),s}has(e){const r=e.lastSegment(),n=e.popLast(),i=this.index[r];return i&&i.has(n)}getEntries(e){return(this.index[e]||new yr(It.comparator)).toArray()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class il{constructor(e){this.Ln=e}next(){return this.Ln+=2,this.Ln}static Bn(){return new il(0)}static kn(){return new il(-1)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jb{constructor(){this.changes=new gl(e=>e.toString(),(e,r)=>e.isEqual(r)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,r){this.assertNotApplied(),this.changes.set(e,Or.newInvalidDocument(e).setReadTime(r))}getEntry(e,r){this.assertNotApplied();const n=this.changes.get(r);return n!==void 0?ge.resolve(n):this.getFromCache(e,r)}getEntries(e,r){return this.getAllFromCache(e,r)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bb{constructor(e,r){this.overlayedDocument=e,this.mutatedFields=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zb{constructor(e,r,n,i){this.remoteDocumentCache=e,this.mutationQueue=r,this.documentOverlayCache=n,this.indexManager=i}getDocument(e,r){let n=null;return this.documentOverlayCache.getOverlay(e,r).next(i=>(n=i,this.remoteDocumentCache.getEntry(e,r))).next(i=>(n!==null&&mc(n.mutation,i,xn.empty(),ir.now()),i))}getDocuments(e,r){return this.remoteDocumentCache.getEntries(e,r).next(n=>this.getLocalViewOfDocuments(e,n,Xe()).next(()=>n))}getLocalViewOfDocuments(e,r,n=Xe()){const i=ya();return this.populateOverlays(e,i,r).next(()=>this.computeViews(e,r,i,n).next(s=>{let a=ql();return s.forEach((o,l)=>{a=a.insert(o,l.overlayedDocument)}),a}))}getOverlayedDocuments(e,r){const n=ya();return this.populateOverlays(e,n,r).next(()=>this.computeViews(e,r,n,Xe()))}populateOverlays(e,r,n){const i=[];return n.forEach(s=>{r.has(s)||i.push(s)}),this.documentOverlayCache.getOverlays(e,i).next(s=>{s.forEach((a,o)=>{r.set(a,o)})})}computeViews(e,r,n,i){let s=ls();const a=pc(),o=function(){return pc()}();return r.forEach((l,c)=>{const u=n.get(c.key);i.has(c.key)&&(u===void 0||u.mutation instanceof sa)?s=s.insert(c.key,c):u!==void 0?(a.set(c.key,u.mutation.getFieldMask()),mc(u.mutation,c,u.mutation.getFieldMask(),ir.now())):a.set(c.key,xn.empty())}),this.recalculateAndSaveOverlays(e,s).next(l=>(l.forEach((c,u)=>a.set(c,u)),r.forEach((c,u)=>{var h;return o.set(c,new Bb(u,(h=a.get(c))!==null&&h!==void 0?h:null))}),o))}recalculateAndSaveOverlays(e,r){const n=pc();let i=new Lt((a,o)=>a-o),s=Xe();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,r).next(a=>{for(const o of a)o.keys().forEach(l=>{const c=r.get(l);if(c===null)return;let u=n.get(l)||xn.empty();u=o.applyToLocalView(c,u),n.set(l,u);const h=(i.get(o.batchId)||Xe()).add(l);i=i.insert(o.batchId,h)})}).next(()=>{const a=[],o=i.getReverseIterator();for(;o.hasNext();){const l=o.getNext(),c=l.key,u=l.value,h=Tk();u.forEach(d=>{if(!s.has(d)){const p=Rk(r.get(d),n.get(d));p!==null&&h.set(d,p),s=s.add(d)}}),a.push(this.documentOverlayCache.saveOverlays(e,c,h))}return ge.waitFor(a)}).next(()=>n)}recalculateAndSaveOverlaysForDocumentKeys(e,r){return this.remoteDocumentCache.getEntries(e,r).next(n=>this.recalculateAndSaveOverlays(e,n))}getDocumentsMatchingQuery(e,r,n,i){return function(a){return Fe.isDocumentKey(a.path)&&a.collectionGroup===null&&a.filters.length===0}(r)?this.getDocumentsMatchingDocumentQuery(e,r.path):xk(r)?this.getDocumentsMatchingCollectionGroupQuery(e,r,n,i):this.getDocumentsMatchingCollectionQuery(e,r,n,i)}getNextDocuments(e,r,n,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,r,n,i).next(s=>{const a=i-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,r,n.largestBatchId,i-s.size):ge.resolve(ya());let o=-1,l=s;return a.next(c=>ge.forEach(c,(u,h)=>(o<h.largestBatchId&&(o=h.largestBatchId),s.get(u)?ge.resolve():this.remoteDocumentCache.getEntry(e,u).next(d=>{l=l.insert(u,d)}))).next(()=>this.populateOverlays(e,c,s)).next(()=>this.computeViews(e,l,c,Xe())).next(u=>({batchId:o,changes:Ek(u)})))})}getDocumentsMatchingDocumentQuery(e,r){return this.getDocument(e,new Fe(r)).next(n=>{let i=ql();return n.isFoundDocument()&&(i=i.insert(n.key,n)),i})}getDocumentsMatchingCollectionGroupQuery(e,r,n,i){const s=r.collectionGroup;let a=ql();return this.indexManager.getCollectionParents(e,s).next(o=>ge.forEach(o,l=>{const c=function(h,d){return new ml(d,null,h.explicitOrderBy.slice(),h.filters.slice(),h.limit,h.limitType,h.startAt,h.endAt)}(r,l.child(s));return this.getDocumentsMatchingCollectionQuery(e,c,n,i).next(u=>{u.forEach((h,d)=>{a=a.insert(h,d)})})}).next(()=>a))}getDocumentsMatchingCollectionQuery(e,r,n,i){let s;return this.documentOverlayCache.getOverlaysForCollection(e,r.path,n.largestBatchId).next(a=>(s=a,this.remoteDocumentCache.getDocumentsMatchingQuery(e,r,n,s,i))).next(a=>{s.forEach((l,c)=>{const u=c.getKey();a.get(u)===null&&(a=a.insert(u,Or.newInvalidDocument(u)))});let o=ql();return a.forEach((l,c)=>{const u=s.get(l);u!==void 0&&mc(u.mutation,c,xn.empty(),ir.now()),A0(r,c)&&(o=o.insert(l,c))}),o})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $b{constructor(e){this.serializer=e,this.hr=new Map,this.Pr=new Map}getBundleMetadata(e,r){return ge.resolve(this.hr.get(r))}saveBundleMetadata(e,r){return this.hr.set(r.id,function(i){return{id:i.id,version:i.version,createTime:yi(i.createTime)}}(r)),ge.resolve()}getNamedQuery(e,r){return ge.resolve(this.Pr.get(r))}saveNamedQuery(e,r){return this.Pr.set(r.name,function(i){return{name:i.name,query:Mb(i.bundledQuery),readTime:yi(i.readTime)}}(r)),ge.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hb{constructor(){this.overlays=new Lt(Fe.comparator),this.Ir=new Map}getOverlay(e,r){return ge.resolve(this.overlays.get(r))}getOverlays(e,r){const n=ya();return ge.forEach(r,i=>this.getOverlay(e,i).next(s=>{s!==null&&n.set(i,s)})).next(()=>n)}saveOverlays(e,r,n){return n.forEach((i,s)=>{this.ht(e,r,s)}),ge.resolve()}removeOverlaysForBatchId(e,r,n){const i=this.Ir.get(n);return i!==void 0&&(i.forEach(s=>this.overlays=this.overlays.remove(s)),this.Ir.delete(n)),ge.resolve()}getOverlaysForCollection(e,r,n){const i=ya(),s=r.length+1,a=new Fe(r.child("")),o=this.overlays.getIteratorFrom(a);for(;o.hasNext();){const l=o.getNext().value,c=l.getKey();if(!r.isPrefixOf(c.path))break;c.path.length===s&&l.largestBatchId>n&&i.set(l.getKey(),l)}return ge.resolve(i)}getOverlaysForCollectionGroup(e,r,n,i){let s=new Lt((c,u)=>c-u);const a=this.overlays.getIterator();for(;a.hasNext();){const c=a.getNext().value;if(c.getKey().getCollectionGroup()===r&&c.largestBatchId>n){let u=s.get(c.largestBatchId);u===null&&(u=ya(),s=s.insert(c.largestBatchId,u)),u.set(c.getKey(),c)}}const o=ya(),l=s.getIterator();for(;l.hasNext()&&(l.getNext().value.forEach((c,u)=>o.set(c,u)),!(o.size()>=i)););return ge.resolve(o)}ht(e,r,n){const i=this.overlays.get(n.key);if(i!==null){const a=this.Ir.get(i.largestBatchId).delete(n.key);this.Ir.set(i.largestBatchId,a)}this.overlays=this.overlays.insert(n.key,new db(r,n));let s=this.Ir.get(r);s===void 0&&(s=Xe(),this.Ir.set(r,s)),this.Ir.set(r,s.add(n.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wb{constructor(){this.sessionToken=kr.EMPTY_BYTE_STRING}getSessionToken(e){return ge.resolve(this.sessionToken)}setSessionToken(e,r){return this.sessionToken=r,ge.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iv{constructor(){this.Tr=new yr(lr.Er),this.dr=new yr(lr.Ar)}isEmpty(){return this.Tr.isEmpty()}addReference(e,r){const n=new lr(e,r);this.Tr=this.Tr.add(n),this.dr=this.dr.add(n)}Rr(e,r){e.forEach(n=>this.addReference(n,r))}removeReference(e,r){this.Vr(new lr(e,r))}mr(e,r){e.forEach(n=>this.removeReference(n,r))}gr(e){const r=new Fe(new It([])),n=new lr(r,e),i=new lr(r,e+1),s=[];return this.dr.forEachInRange([n,i],a=>{this.Vr(a),s.push(a.key)}),s}pr(){this.Tr.forEach(e=>this.Vr(e))}Vr(e){this.Tr=this.Tr.delete(e),this.dr=this.dr.delete(e)}yr(e){const r=new Fe(new It([])),n=new lr(r,e),i=new lr(r,e+1);let s=Xe();return this.dr.forEachInRange([n,i],a=>{s=s.add(a.key)}),s}containsKey(e){const r=new lr(e,0),n=this.Tr.firstAfterOrEqual(r);return n!==null&&e.isEqual(n.key)}}class lr{constructor(e,r){this.key=e,this.wr=r}static Er(e,r){return Fe.comparator(e.key,r.key)||ct(e.wr,r.wr)}static Ar(e,r){return ct(e.wr,r.wr)||Fe.comparator(e.key,r.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gb{constructor(e,r){this.indexManager=e,this.referenceDelegate=r,this.mutationQueue=[],this.Sr=1,this.br=new yr(lr.Er)}checkEmpty(e){return ge.resolve(this.mutationQueue.length===0)}addMutationBatch(e,r,n,i){const s=this.Sr;this.Sr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const a=new hb(s,r,n,i);this.mutationQueue.push(a);for(const o of i)this.br=this.br.add(new lr(o.key,s)),this.indexManager.addToCollectionParentIndex(e,o.key.path.popLast());return ge.resolve(a)}lookupMutationBatch(e,r){return ge.resolve(this.Dr(r))}getNextMutationBatchAfterBatchId(e,r){const n=r+1,i=this.vr(n),s=i<0?0:i;return ge.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return ge.resolve(this.mutationQueue.length===0?-1:this.Sr-1)}getAllMutationBatches(e){return ge.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,r){const n=new lr(r,0),i=new lr(r,Number.POSITIVE_INFINITY),s=[];return this.br.forEachInRange([n,i],a=>{const o=this.Dr(a.wr);s.push(o)}),ge.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,r){let n=new yr(ct);return r.forEach(i=>{const s=new lr(i,0),a=new lr(i,Number.POSITIVE_INFINITY);this.br.forEachInRange([s,a],o=>{n=n.add(o.wr)})}),ge.resolve(this.Cr(n))}getAllMutationBatchesAffectingQuery(e,r){const n=r.path,i=n.length+1;let s=n;Fe.isDocumentKey(s)||(s=s.child(""));const a=new lr(new Fe(s),0);let o=new yr(ct);return this.br.forEachWhile(l=>{const c=l.key.path;return!!n.isPrefixOf(c)&&(c.length===i&&(o=o.add(l.wr)),!0)},a),ge.resolve(this.Cr(o))}Cr(e){const r=[];return e.forEach(n=>{const i=this.Dr(n);i!==null&&r.push(i)}),r}removeMutationBatch(e,r){gt(this.Fr(r.batchId,"removed")===0),this.mutationQueue.shift();let n=this.br;return ge.forEach(r.mutations,i=>{const s=new lr(i.key,r.batchId);return n=n.delete(s),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(()=>{this.br=n})}On(e){}containsKey(e,r){const n=new lr(r,0),i=this.br.firstAfterOrEqual(n);return ge.resolve(r.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,ge.resolve()}Fr(e,r){return this.vr(e)}vr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Dr(e){const r=this.vr(e);return r<0||r>=this.mutationQueue.length?null:this.mutationQueue[r]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kb{constructor(e){this.Mr=e,this.docs=function(){return new Lt(Fe.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,r){const n=r.key,i=this.docs.get(n),s=i?i.size:0,a=this.Mr(r);return this.docs=this.docs.insert(n,{document:r.mutableCopy(),size:a}),this.size+=a-s,this.indexManager.addToCollectionParentIndex(e,n.path.popLast())}removeEntry(e){const r=this.docs.get(e);r&&(this.docs=this.docs.remove(e),this.size-=r.size)}getEntry(e,r){const n=this.docs.get(r);return ge.resolve(n?n.document.mutableCopy():Or.newInvalidDocument(r))}getEntries(e,r){let n=ls();return r.forEach(i=>{const s=this.docs.get(i);n=n.insert(i,s?s.document.mutableCopy():Or.newInvalidDocument(i))}),ge.resolve(n)}getDocumentsMatchingQuery(e,r,n,i){let s=ls();const a=r.path,o=new Fe(a.child("")),l=this.docs.getIteratorFrom(o);for(;l.hasNext();){const{key:c,value:{document:u}}=l.getNext();if(!a.isPrefixOf(c.path))break;c.path.length>a.length+1||R3(C3(u),n)<=0||(i.has(u.key)||A0(r,u))&&(s=s.insert(u.key,u.mutableCopy()))}return ge.resolve(s)}getAllFromCollectionGroup(e,r,n,i){Me()}Or(e,r){return ge.forEach(this.docs,n=>r(n))}newChangeBuffer(e){return new qb(this)}getSize(e){return ge.resolve(this.size)}}class qb extends jb{constructor(e){super(),this.cr=e}applyChanges(e){const r=[];return this.changes.forEach((n,i)=>{i.isValidDocument()?r.push(this.cr.addEntry(e,i)):this.cr.removeEntry(n)}),ge.waitFor(r)}getFromCache(e,r){return this.cr.getEntry(e,r)}getAllFromCache(e,r){return this.cr.getEntries(e,r)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xb{constructor(e){this.persistence=e,this.Nr=new gl(r=>Yg(r),Qg),this.lastRemoteSnapshotVersion=Ue.min(),this.highestTargetId=0,this.Lr=0,this.Br=new iv,this.targetCount=0,this.kr=il.Bn()}forEachTarget(e,r){return this.Nr.forEach((n,i)=>r(i)),ge.resolve()}getLastRemoteSnapshotVersion(e){return ge.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return ge.resolve(this.Lr)}allocateTargetId(e){return this.highestTargetId=this.kr.next(),ge.resolve(this.highestTargetId)}setTargetsMetadata(e,r,n){return n&&(this.lastRemoteSnapshotVersion=n),r>this.Lr&&(this.Lr=r),ge.resolve()}Kn(e){this.Nr.set(e.target,e);const r=e.targetId;r>this.highestTargetId&&(this.kr=new il(r),this.highestTargetId=r),e.sequenceNumber>this.Lr&&(this.Lr=e.sequenceNumber)}addTargetData(e,r){return this.Kn(r),this.targetCount+=1,ge.resolve()}updateTargetData(e,r){return this.Kn(r),ge.resolve()}removeTargetData(e,r){return this.Nr.delete(r.target),this.Br.gr(r.targetId),this.targetCount-=1,ge.resolve()}removeTargets(e,r,n){let i=0;const s=[];return this.Nr.forEach((a,o)=>{o.sequenceNumber<=r&&n.get(o.targetId)===null&&(this.Nr.delete(a),s.push(this.removeMatchingKeysForTargetId(e,o.targetId)),i++)}),ge.waitFor(s).next(()=>i)}getTargetCount(e){return ge.resolve(this.targetCount)}getTargetData(e,r){const n=this.Nr.get(r)||null;return ge.resolve(n)}addMatchingKeys(e,r,n){return this.Br.Rr(r,n),ge.resolve()}removeMatchingKeys(e,r,n){this.Br.mr(r,n);const i=this.persistence.referenceDelegate,s=[];return i&&r.forEach(a=>{s.push(i.markPotentiallyOrphaned(e,a))}),ge.waitFor(s)}removeMatchingKeysForTargetId(e,r){return this.Br.gr(r),ge.resolve()}getMatchingKeysForTargetId(e,r){const n=this.Br.yr(r);return ge.resolve(n)}containsKey(e,r){return ge.resolve(this.Br.containsKey(r))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yb{constructor(e,r){this.qr={},this.overlays={},this.Qr=new Gg(0),this.Kr=!1,this.Kr=!0,this.$r=new Wb,this.referenceDelegate=e(this),this.Ur=new Xb(this),this.indexManager=new Vb,this.remoteDocumentCache=function(i){return new Kb(i)}(n=>this.referenceDelegate.Wr(n)),this.serializer=new Lb(r),this.Gr=new $b(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.Kr=!1,Promise.resolve()}get started(){return this.Kr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let r=this.overlays[e.toKey()];return r||(r=new Hb,this.overlays[e.toKey()]=r),r}getMutationQueue(e,r){let n=this.qr[e.toKey()];return n||(n=new Gb(r,this.referenceDelegate),this.qr[e.toKey()]=n),n}getGlobalsCache(){return this.$r}getTargetCache(){return this.Ur}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Gr}runTransaction(e,r,n){Pe("MemoryPersistence","Starting transaction:",e);const i=new Qb(this.Qr.next());return this.referenceDelegate.zr(),n(i).next(s=>this.referenceDelegate.jr(i).next(()=>s)).toPromise().then(s=>(i.raiseOnCommittedEvent(),s))}Hr(e,r){return ge.or(Object.values(this.qr).map(n=>()=>n.containsKey(e,r)))}}class Qb extends P3{constructor(e){super(),this.currentSequenceNumber=e}}class sv{constructor(e){this.persistence=e,this.Jr=new iv,this.Yr=null}static Zr(e){return new sv(e)}get Xr(){if(this.Yr)return this.Yr;throw Me()}addReference(e,r,n){return this.Jr.addReference(n,r),this.Xr.delete(n.toString()),ge.resolve()}removeReference(e,r,n){return this.Jr.removeReference(n,r),this.Xr.add(n.toString()),ge.resolve()}markPotentiallyOrphaned(e,r){return this.Xr.add(r.toString()),ge.resolve()}removeTarget(e,r){this.Jr.gr(r.targetId).forEach(i=>this.Xr.add(i.toString()));const n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(e,r.targetId).next(i=>{i.forEach(s=>this.Xr.add(s.toString()))}).next(()=>n.removeTargetData(e,r))}zr(){this.Yr=new Set}jr(e){const r=this.persistence.getRemoteDocumentCache().newChangeBuffer();return ge.forEach(this.Xr,n=>{const i=Fe.fromPath(n);return this.ei(e,i).next(s=>{s||r.removeEntry(i,Ue.min())})}).next(()=>(this.Yr=null,r.apply(e)))}updateLimboDocument(e,r){return this.ei(e,r).next(n=>{n?this.Xr.delete(r.toString()):this.Xr.add(r.toString())})}Wr(e){return 0}ei(e,r){return ge.or([()=>ge.resolve(this.Jr.containsKey(r)),()=>this.persistence.getTargetCache().containsKey(e,r),()=>this.persistence.Hr(e,r)])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class av{constructor(e,r,n,i){this.targetId=e,this.fromCache=r,this.$i=n,this.Ui=i}static Wi(e,r){let n=Xe(),i=Xe();for(const s of r.docChanges)switch(s.type){case 0:n=n.add(s.doc.key);break;case 1:i=i.add(s.doc.key)}return new av(e,r.fromCache,n,i)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jb{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zb{constructor(){this.Gi=!1,this.zi=!1,this.ji=100,this.Hi=function(){return iP()?8:F3(jr())>0?6:4}()}initialize(e,r){this.Ji=e,this.indexManager=r,this.Gi=!0}getDocumentsMatchingQuery(e,r,n,i){const s={result:null};return this.Yi(e,r).next(a=>{s.result=a}).next(()=>{if(!s.result)return this.Zi(e,r,i,n).next(a=>{s.result=a})}).next(()=>{if(s.result)return;const a=new Jb;return this.Xi(e,r,a).next(o=>{if(s.result=o,this.zi)return this.es(e,r,a,o.size)})}).next(()=>s.result)}es(e,r,n,i){return n.documentReadCount<this.ji?(Bl()<=Ye.DEBUG&&Pe("QueryEngine","SDK will not create cache indexes for query:",po(r),"since it only creates cache indexes for collection contains","more than or equal to",this.ji,"documents"),ge.resolve()):(Bl()<=Ye.DEBUG&&Pe("QueryEngine","Query:",po(r),"scans",n.documentReadCount,"local documents and returns",i,"documents as results."),n.documentReadCount>this.Hi*i?(Bl()<=Ye.DEBUG&&Pe("QueryEngine","The SDK decides to create cache indexes for query:",po(r),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,_i(r))):ge.resolve())}Yi(e,r){if(B_(r))return ge.resolve(null);let n=_i(r);return this.indexManager.getIndexType(e,n).next(i=>i===0?null:(r.limit!==null&&i===1&&(r=am(r,null,"F"),n=_i(r)),this.indexManager.getDocumentsMatchingTarget(e,n).next(s=>{const a=Xe(...s);return this.Ji.getDocuments(e,a).next(o=>this.indexManager.getMinOffset(e,n).next(l=>{const c=this.ts(r,o);return this.ns(r,c,a,l.readTime)?this.Yi(e,am(r,null,"F")):this.rs(e,c,r,l)}))})))}Zi(e,r,n,i){return B_(r)||i.isEqual(Ue.min())?ge.resolve(null):this.Ji.getDocuments(e,n).next(s=>{const a=this.ts(r,s);return this.ns(r,a,n,i)?ge.resolve(null):(Bl()<=Ye.DEBUG&&Pe("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),po(r)),this.rs(e,a,r,I3(i,-1)).next(o=>o))})}ts(e,r){let n=new yr(yk(e));return r.forEach((i,s)=>{A0(e,s)&&(n=n.add(s))}),n}ns(e,r,n,i){if(e.limit===null)return!1;if(n.size!==r.size)return!0;const s=e.limitType==="F"?r.last():r.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(i)>0)}Xi(e,r,n){return Bl()<=Ye.DEBUG&&Pe("QueryEngine","Using full collection scan to execute query:",po(r)),this.Ji.getDocumentsMatchingQuery(e,r,Ys.min(),n)}rs(e,r,n,i){return this.Ji.getDocumentsMatchingQuery(e,n,i).next(s=>(r.forEach(a=>{s=s.insert(a.key,a)}),s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eO{constructor(e,r,n,i){this.persistence=e,this.ss=r,this.serializer=i,this.os=new Lt(ct),this._s=new gl(s=>Yg(s),Qg),this.us=new Map,this.cs=e.getRemoteDocumentCache(),this.Ur=e.getTargetCache(),this.Gr=e.getBundleCache(),this.ls(n)}ls(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new zb(this.cs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.cs.setIndexManager(this.indexManager),this.ss.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",r=>e.collect(r,this.os))}}function tO(t,e,r,n){return new eO(t,e,r,n)}async function Bk(t,e){const r=Be(t);return await r.persistence.runTransaction("Handle user change","readonly",n=>{let i;return r.mutationQueue.getAllMutationBatches(n).next(s=>(i=s,r.ls(e),r.mutationQueue.getAllMutationBatches(n))).next(s=>{const a=[],o=[];let l=Xe();for(const c of i){a.push(c.batchId);for(const u of c.mutations)l=l.add(u.key)}for(const c of s){o.push(c.batchId);for(const u of c.mutations)l=l.add(u.key)}return r.localDocuments.getDocuments(n,l).next(c=>({hs:c,removedBatchIds:a,addedBatchIds:o}))})})}function rO(t,e){const r=Be(t);return r.persistence.runTransaction("Acknowledge batch","readwrite-primary",n=>{const i=e.batch.keys(),s=r.cs.newChangeBuffer({trackRemovals:!0});return function(o,l,c,u){const h=c.batch,d=h.keys();let p=ge.resolve();return d.forEach(x=>{p=p.next(()=>u.getEntry(l,x)).next(v=>{const E=c.docVersions.get(x);gt(E!==null),v.version.compareTo(E)<0&&(h.applyToRemoteDocument(v,c),v.isValidDocument()&&(v.setReadTime(c.commitVersion),u.addEntry(v)))})}),p.next(()=>o.mutationQueue.removeMutationBatch(l,h))}(r,n,e,s).next(()=>s.apply(n)).next(()=>r.mutationQueue.performConsistencyCheck(n)).next(()=>r.documentOverlayCache.removeOverlaysForBatchId(n,i,e.batch.batchId)).next(()=>r.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(n,function(o){let l=Xe();for(let c=0;c<o.mutationResults.length;++c)o.mutationResults[c].transformResults.length>0&&(l=l.add(o.batch.mutations[c].key));return l}(e))).next(()=>r.localDocuments.getDocuments(n,i))})}function zk(t){const e=Be(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",r=>e.Ur.getLastRemoteSnapshotVersion(r))}function nO(t,e){const r=Be(t),n=e.snapshotVersion;let i=r.os;return r.persistence.runTransaction("Apply remote event","readwrite-primary",s=>{const a=r.cs.newChangeBuffer({trackRemovals:!0});i=r.os;const o=[];e.targetChanges.forEach((u,h)=>{const d=i.get(h);if(!d)return;o.push(r.Ur.removeMatchingKeys(s,u.removedDocuments,h).next(()=>r.Ur.addMatchingKeys(s,u.addedDocuments,h)));let p=d.withSequenceNumber(s.currentSequenceNumber);e.targetMismatches.get(h)!==null?p=p.withResumeToken(kr.EMPTY_BYTE_STRING,Ue.min()).withLastLimboFreeSnapshotVersion(Ue.min()):u.resumeToken.approximateByteSize()>0&&(p=p.withResumeToken(u.resumeToken,n)),i=i.insert(h,p),function(v,E,T){return v.resumeToken.approximateByteSize()===0||E.snapshotVersion.toMicroseconds()-v.snapshotVersion.toMicroseconds()>=3e8?!0:T.addedDocuments.size+T.modifiedDocuments.size+T.removedDocuments.size>0}(d,p,u)&&o.push(r.Ur.updateTargetData(s,p))});let l=ls(),c=Xe();if(e.documentUpdates.forEach(u=>{e.resolvedLimboDocuments.has(u)&&o.push(r.persistence.referenceDelegate.updateLimboDocument(s,u))}),o.push(iO(s,a,e.documentUpdates).next(u=>{l=u.Ps,c=u.Is})),!n.isEqual(Ue.min())){const u=r.Ur.getLastRemoteSnapshotVersion(s).next(h=>r.Ur.setTargetsMetadata(s,s.currentSequenceNumber,n));o.push(u)}return ge.waitFor(o).next(()=>a.apply(s)).next(()=>r.localDocuments.getLocalViewOfDocuments(s,l,c)).next(()=>l)}).then(s=>(r.os=i,s))}function iO(t,e,r){let n=Xe(),i=Xe();return r.forEach(s=>n=n.add(s)),e.getEntries(t,n).next(s=>{let a=ls();return r.forEach((o,l)=>{const c=s.get(o);l.isFoundDocument()!==c.isFoundDocument()&&(i=i.add(o)),l.isNoDocument()&&l.version.isEqual(Ue.min())?(e.removeEntry(o,l.readTime),a=a.insert(o,l)):!c.isValidDocument()||l.version.compareTo(c.version)>0||l.version.compareTo(c.version)===0&&c.hasPendingWrites?(e.addEntry(l),a=a.insert(o,l)):Pe("LocalStore","Ignoring outdated watch update for ",o,". Current version:",c.version," Watch version:",l.version)}),{Ps:a,Is:i}})}function sO(t,e){const r=Be(t);return r.persistence.runTransaction("Get next mutation batch","readonly",n=>(e===void 0&&(e=-1),r.mutationQueue.getNextMutationBatchAfterBatchId(n,e)))}function aO(t,e){const r=Be(t);return r.persistence.runTransaction("Allocate target","readwrite",n=>{let i;return r.Ur.getTargetData(n,e).next(s=>s?(i=s,ge.resolve(i)):r.Ur.allocateTargetId(n).next(a=>(i=new Fs(e,a,"TargetPurposeListen",n.currentSequenceNumber),r.Ur.addTargetData(n,i).next(()=>i))))}).then(n=>{const i=r.os.get(n.targetId);return(i===null||n.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(r.os=r.os.insert(n.targetId,n),r._s.set(e,n.targetId)),n})}async function fm(t,e,r){const n=Be(t),i=n.os.get(e),s=r?"readwrite":"readwrite-primary";try{r||await n.persistence.runTransaction("Release target",s,a=>n.persistence.referenceDelegate.removeTarget(a,i))}catch(a){if(!Tu(a))throw a;Pe("LocalStore",`Failed to update sequence numbers for target ${e}: ${a}`)}n.os=n.os.remove(e),n._s.delete(i.target)}function J_(t,e,r){const n=Be(t);let i=Ue.min(),s=Xe();return n.persistence.runTransaction("Execute query","readwrite",a=>function(l,c,u){const h=Be(l),d=h._s.get(u);return d!==void 0?ge.resolve(h.os.get(d)):h.Ur.getTargetData(c,u)}(n,a,_i(e)).next(o=>{if(o)return i=o.lastLimboFreeSnapshotVersion,n.Ur.getMatchingKeysForTargetId(a,o.targetId).next(l=>{s=l})}).next(()=>n.ss.getDocumentsMatchingQuery(a,e,r?i:Ue.min(),r?s:Xe())).next(o=>(oO(n,Y3(e),o),{documents:o,Ts:s})))}function oO(t,e,r){let n=t.us.get(e)||Ue.min();r.forEach((i,s)=>{s.readTime.compareTo(n)>0&&(n=s.readTime)}),t.us.set(e,n)}class Z_{constructor(){this.activeTargetIds=rb()}fs(e){this.activeTargetIds=this.activeTargetIds.add(e)}gs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Vs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class lO{constructor(){this.so=new Z_,this.oo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,r,n){}addLocalQueryTarget(e,r=!0){return r&&this.so.fs(e),this.oo[e]||"not-current"}updateQueryState(e,r,n){this.oo[e]=r}removeLocalQueryTarget(e){this.so.gs(e)}isLocalQueryTarget(e){return this.so.activeTargetIds.has(e)}clearQueryState(e){delete this.oo[e]}getAllActiveQueryTargets(){return this.so.activeTargetIds}isActiveQueryTarget(e){return this.so.activeTargetIds.has(e)}start(){return this.so=new Z_,Promise.resolve()}handleUserChange(e,r,n){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cO{_o(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ey{constructor(){this.ao=()=>this.uo(),this.co=()=>this.lo(),this.ho=[],this.Po()}_o(e){this.ho.push(e)}shutdown(){window.removeEventListener("online",this.ao),window.removeEventListener("offline",this.co)}Po(){window.addEventListener("online",this.ao),window.addEventListener("offline",this.co)}uo(){Pe("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.ho)e(0)}lo(){Pe("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.ho)e(1)}static D(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let gf=null;function Od(){return gf===null?gf=function(){return 268435456+Math.round(2147483648*Math.random())}():gf++,"0x"+gf.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uO={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fO{constructor(e){this.Io=e.Io,this.To=e.To}Eo(e){this.Ao=e}Ro(e){this.Vo=e}mo(e){this.fo=e}onMessage(e){this.po=e}close(){this.To()}send(e){this.Io(e)}yo(){this.Ao()}wo(){this.Vo()}So(e){this.fo(e)}bo(e){this.po(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Nr="WebChannelConnection";class hO extends class{constructor(r){this.databaseInfo=r,this.databaseId=r.databaseId;const n=r.ssl?"https":"http",i=encodeURIComponent(this.databaseId.projectId),s=encodeURIComponent(this.databaseId.database);this.Do=n+"://"+r.host,this.vo=`projects/${i}/databases/${s}`,this.Co=this.databaseId.database==="(default)"?`project_id=${i}`:`project_id=${i}&database_id=${s}`}get Fo(){return!1}Mo(r,n,i,s,a){const o=Od(),l=this.xo(r,n.toUriEncodedString());Pe("RestConnection",`Sending RPC '${r}' ${o}:`,l,i);const c={"google-cloud-resource-prefix":this.vo,"x-goog-request-params":this.Co};return this.Oo(c,s,a),this.No(r,l,c,i).then(u=>(Pe("RestConnection",`Received RPC '${r}' ${o}: `,u),u),u=>{throw el("RestConnection",`RPC '${r}' ${o} failed with error: `,u,"url: ",l,"request:",i),u})}Lo(r,n,i,s,a,o){return this.Mo(r,n,i,s,a)}Oo(r,n,i){r["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+pl}(),r["Content-Type"]="text/plain",this.databaseInfo.appId&&(r["X-Firebase-GMPID"]=this.databaseInfo.appId),n&&n.headers.forEach((s,a)=>r[a]=s),i&&i.headers.forEach((s,a)=>r[a]=s)}xo(r,n){const i=uO[r];return`${this.Do}/v1/${n}:${i}`}terminate(){}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}No(e,r,n,i){const s=Od();return new Promise((a,o)=>{const l=new rk;l.setWithCredentials(!0),l.listenOnce(nk.COMPLETE,()=>{try{switch(l.getLastErrorCode()){case Hf.NO_ERROR:const u=l.getResponseJson();Pe(Nr,`XHR for RPC '${e}' ${s} received:`,JSON.stringify(u)),a(u);break;case Hf.TIMEOUT:Pe(Nr,`RPC '${e}' ${s} timed out`),o(new Re(ce.DEADLINE_EXCEEDED,"Request time out"));break;case Hf.HTTP_ERROR:const h=l.getStatus();if(Pe(Nr,`RPC '${e}' ${s} failed with status:`,h,"response text:",l.getResponseText()),h>0){let d=l.getResponseJson();Array.isArray(d)&&(d=d[0]);const p=d==null?void 0:d.error;if(p&&p.status&&p.message){const x=function(E){const T=E.toLowerCase().replace(/_/g,"-");return Object.values(ce).indexOf(T)>=0?T:ce.UNKNOWN}(p.status);o(new Re(x,p.message))}else o(new Re(ce.UNKNOWN,"Server responded with status "+l.getStatus()))}else o(new Re(ce.UNAVAILABLE,"Connection failed."));break;default:Me()}}finally{Pe(Nr,`RPC '${e}' ${s} completed.`)}});const c=JSON.stringify(i);Pe(Nr,`RPC '${e}' ${s} sending request:`,i),l.send(r,"POST",c,n,15)})}Bo(e,r,n){const i=Od(),s=[this.Do,"/","google.firestore.v1.Firestore","/",e,"/channel"],a=ak(),o=sk(),l={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},c=this.longPollingOptions.timeoutSeconds;c!==void 0&&(l.longPollingTimeout=Math.round(1e3*c)),this.useFetchStreams&&(l.useFetchStreams=!0),this.Oo(l.initMessageHeaders,r,n),l.encodeInitMessageHeaders=!0;const u=s.join("");Pe(Nr,`Creating RPC '${e}' stream ${i}: ${u}`,l);const h=a.createWebChannel(u,l);let d=!1,p=!1;const x=new fO({Io:E=>{p?Pe(Nr,`Not sending because RPC '${e}' stream ${i} is closed:`,E):(d||(Pe(Nr,`Opening RPC '${e}' stream ${i} transport.`),h.open(),d=!0),Pe(Nr,`RPC '${e}' stream ${i} sending:`,E),h.send(E))},To:()=>h.close()}),v=(E,T,w)=>{E.listen(T,y=>{try{w(y)}catch(R){setTimeout(()=>{throw R},0)}})};return v(h,Kl.EventType.OPEN,()=>{p||(Pe(Nr,`RPC '${e}' stream ${i} transport opened.`),x.yo())}),v(h,Kl.EventType.CLOSE,()=>{p||(p=!0,Pe(Nr,`RPC '${e}' stream ${i} transport closed`),x.So())}),v(h,Kl.EventType.ERROR,E=>{p||(p=!0,el(Nr,`RPC '${e}' stream ${i} transport errored:`,E),x.So(new Re(ce.UNAVAILABLE,"The operation could not be completed")))}),v(h,Kl.EventType.MESSAGE,E=>{var T;if(!p){const w=E.data[0];gt(!!w);const y=w,R=y.error||((T=y[0])===null||T===void 0?void 0:T.error);if(R){Pe(Nr,`RPC '${e}' stream ${i} received error:`,R);const M=R.status;let j=function(S){const C=Gt[S];if(C!==void 0)return Pk(C)}(M),g=R.message;j===void 0&&(j=ce.INTERNAL,g="Unknown error status: "+M+" with message "+R.message),p=!0,x.So(new Re(j,g)),h.close()}else Pe(Nr,`RPC '${e}' stream ${i} received:`,w),x.bo(w)}}),v(o,ik.STAT_EVENT,E=>{E.stat===em.PROXY?Pe(Nr,`RPC '${e}' stream ${i} detected buffering proxy`):E.stat===em.NOPROXY&&Pe(Nr,`RPC '${e}' stream ${i} detected no buffering proxy`)}),setTimeout(()=>{x.wo()},0),x}}function Ld(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function N0(t){return new Eb(t,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $k{constructor(e,r,n=1e3,i=1.5,s=6e4){this.ui=e,this.timerId=r,this.ko=n,this.qo=i,this.Qo=s,this.Ko=0,this.$o=null,this.Uo=Date.now(),this.reset()}reset(){this.Ko=0}Wo(){this.Ko=this.Qo}Go(e){this.cancel();const r=Math.floor(this.Ko+this.zo()),n=Math.max(0,Date.now()-this.Uo),i=Math.max(0,r-n);i>0&&Pe("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.Ko} ms, delay with jitter: ${r} ms, last attempt: ${n} ms ago)`),this.$o=this.ui.enqueueAfterDelay(this.timerId,i,()=>(this.Uo=Date.now(),e())),this.Ko*=this.qo,this.Ko<this.ko&&(this.Ko=this.ko),this.Ko>this.Qo&&(this.Ko=this.Qo)}jo(){this.$o!==null&&(this.$o.skipDelay(),this.$o=null)}cancel(){this.$o!==null&&(this.$o.cancel(),this.$o=null)}zo(){return(Math.random()-.5)*this.Ko}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hk{constructor(e,r,n,i,s,a,o,l){this.ui=e,this.Ho=n,this.Jo=i,this.connection=s,this.authCredentialsProvider=a,this.appCheckCredentialsProvider=o,this.listener=l,this.state=0,this.Yo=0,this.Zo=null,this.Xo=null,this.stream=null,this.e_=0,this.t_=new $k(e,r)}n_(){return this.state===1||this.state===5||this.r_()}r_(){return this.state===2||this.state===3}start(){this.e_=0,this.state!==4?this.auth():this.i_()}async stop(){this.n_()&&await this.close(0)}s_(){this.state=0,this.t_.reset()}o_(){this.r_()&&this.Zo===null&&(this.Zo=this.ui.enqueueAfterDelay(this.Ho,6e4,()=>this.__()))}a_(e){this.u_(),this.stream.send(e)}async __(){if(this.r_())return this.close(0)}u_(){this.Zo&&(this.Zo.cancel(),this.Zo=null)}c_(){this.Xo&&(this.Xo.cancel(),this.Xo=null)}async close(e,r){this.u_(),this.c_(),this.t_.cancel(),this.Yo++,e!==4?this.t_.reset():r&&r.code===ce.RESOURCE_EXHAUSTED?(os(r.toString()),os("Using maximum backoff delay to prevent overloading the backend."),this.t_.Wo()):r&&r.code===ce.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.l_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.mo(r)}l_(){}auth(){this.state=1;const e=this.h_(this.Yo),r=this.Yo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([n,i])=>{this.Yo===r&&this.P_(n,i)},n=>{e(()=>{const i=new Re(ce.UNKNOWN,"Fetching auth token failed: "+n.message);return this.I_(i)})})}P_(e,r){const n=this.h_(this.Yo);this.stream=this.T_(e,r),this.stream.Eo(()=>{n(()=>this.listener.Eo())}),this.stream.Ro(()=>{n(()=>(this.state=2,this.Xo=this.ui.enqueueAfterDelay(this.Jo,1e4,()=>(this.r_()&&(this.state=3),Promise.resolve())),this.listener.Ro()))}),this.stream.mo(i=>{n(()=>this.I_(i))}),this.stream.onMessage(i=>{n(()=>++this.e_==1?this.E_(i):this.onNext(i))})}i_(){this.state=5,this.t_.Go(async()=>{this.state=0,this.start()})}I_(e){return Pe("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}h_(e){return r=>{this.ui.enqueueAndForget(()=>this.Yo===e?r():(Pe("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class dO extends Hk{constructor(e,r,n,i,s,a){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",r,n,i,a),this.serializer=s}T_(e,r){return this.connection.Bo("Listen",e,r)}E_(e){return this.onNext(e)}onNext(e){this.t_.reset();const r=Sb(this.serializer,e),n=function(s){if(!("targetChange"in s))return Ue.min();const a=s.targetChange;return a.targetIds&&a.targetIds.length?Ue.min():a.readTime?yi(a.readTime):Ue.min()}(e);return this.listener.d_(r,n)}A_(e){const r={};r.database=um(this.serializer),r.addTarget=function(s,a){let o;const l=a.target;if(o=im(l)?{documents:Cb(s,l)}:{query:Rb(s,l)._t},o.targetId=a.targetId,a.resumeToken.approximateByteSize()>0){o.resumeToken=bk(s,a.resumeToken);const c=om(s,a.expectedCount);c!==null&&(o.expectedCount=c)}else if(a.snapshotVersion.compareTo(Ue.min())>0){o.readTime=bh(s,a.snapshotVersion.toTimestamp());const c=om(s,a.expectedCount);c!==null&&(o.expectedCount=c)}return o}(this.serializer,e);const n=Pb(this.serializer,e);n&&(r.labels=n),this.a_(r)}R_(e){const r={};r.database=um(this.serializer),r.removeTarget=e,this.a_(r)}}class pO extends Hk{constructor(e,r,n,i,s,a){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",r,n,i,a),this.serializer=s}get V_(){return this.e_>0}start(){this.lastStreamToken=void 0,super.start()}l_(){this.V_&&this.m_([])}T_(e,r){return this.connection.Bo("Write",e,r)}E_(e){return gt(!!e.streamToken),this.lastStreamToken=e.streamToken,gt(!e.writeResults||e.writeResults.length===0),this.listener.f_()}onNext(e){gt(!!e.streamToken),this.lastStreamToken=e.streamToken,this.t_.reset();const r=Ib(e.writeResults,e.commitTime),n=yi(e.commitTime);return this.listener.g_(n,r)}p_(){const e={};e.database=um(this.serializer),this.a_(e)}m_(e){const r={streamToken:this.lastStreamToken,writes:e.map(n=>Ab(this.serializer,n))};this.a_(r)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mO extends class{}{constructor(e,r,n,i){super(),this.authCredentials=e,this.appCheckCredentials=r,this.connection=n,this.serializer=i,this.y_=!1}w_(){if(this.y_)throw new Re(ce.FAILED_PRECONDITION,"The client has already been terminated.")}Mo(e,r,n,i){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,a])=>this.connection.Mo(e,lm(r,n),i,s,a)).catch(s=>{throw s.name==="FirebaseError"?(s.code===ce.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new Re(ce.UNKNOWN,s.toString())})}Lo(e,r,n,i,s){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([a,o])=>this.connection.Lo(e,lm(r,n),i,a,o,s)).catch(a=>{throw a.name==="FirebaseError"?(a.code===ce.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),a):new Re(ce.UNKNOWN,a.toString())})}terminate(){this.y_=!0,this.connection.terminate()}}class gO{constructor(e,r){this.asyncQueue=e,this.onlineStateHandler=r,this.state="Unknown",this.S_=0,this.b_=null,this.D_=!0}v_(){this.S_===0&&(this.C_("Unknown"),this.b_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.b_=null,this.F_("Backend didn't respond within 10 seconds."),this.C_("Offline"),Promise.resolve())))}M_(e){this.state==="Online"?this.C_("Unknown"):(this.S_++,this.S_>=1&&(this.x_(),this.F_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.C_("Offline")))}set(e){this.x_(),this.S_=0,e==="Online"&&(this.D_=!1),this.C_(e)}C_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}F_(e){const r=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.D_?(os(r),this.D_=!1):Pe("OnlineStateTracker",r)}x_(){this.b_!==null&&(this.b_.cancel(),this.b_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vO{constructor(e,r,n,i,s){this.localStore=e,this.datastore=r,this.asyncQueue=n,this.remoteSyncer={},this.O_=[],this.N_=new Map,this.L_=new Set,this.B_=[],this.k_=s,this.k_._o(a=>{n.enqueueAndForget(async()=>{qa(this)&&(Pe("RemoteStore","Restarting streams for network reachability change."),await async function(l){const c=Be(l);c.L_.add(4),await Au(c),c.q_.set("Unknown"),c.L_.delete(4),await P0(c)}(this))})}),this.q_=new gO(n,i)}}async function P0(t){if(qa(t))for(const e of t.B_)await e(!0)}async function Au(t){for(const e of t.B_)await e(!1)}function Wk(t,e){const r=Be(t);r.N_.has(e.targetId)||(r.N_.set(e.targetId,e),uv(r)?cv(r):vl(r).r_()&&lv(r,e))}function ov(t,e){const r=Be(t),n=vl(r);r.N_.delete(e),n.r_()&&Gk(r,e),r.N_.size===0&&(n.r_()?n.o_():qa(r)&&r.q_.set("Unknown"))}function lv(t,e){if(t.Q_.xe(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(Ue.min())>0){const r=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(r)}vl(t).A_(e)}function Gk(t,e){t.Q_.xe(e),vl(t).R_(e)}function cv(t){t.Q_=new xb({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),ot:e=>t.N_.get(e)||null,tt:()=>t.datastore.serializer.databaseId}),vl(t).start(),t.q_.v_()}function uv(t){return qa(t)&&!vl(t).n_()&&t.N_.size>0}function qa(t){return Be(t).L_.size===0}function Kk(t){t.Q_=void 0}async function xO(t){t.q_.set("Online")}async function _O(t){t.N_.forEach((e,r)=>{lv(t,e)})}async function yO(t,e){Kk(t),uv(t)?(t.q_.M_(e),cv(t)):t.q_.set("Unknown")}async function wO(t,e,r){if(t.q_.set("Online"),e instanceof Dk&&e.state===2&&e.cause)try{await async function(i,s){const a=s.cause;for(const o of s.targetIds)i.N_.has(o)&&(await i.remoteSyncer.rejectListen(o,a),i.N_.delete(o),i.Q_.removeTarget(o))}(t,e)}catch(n){Pe("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),n),await Oh(t,n)}else if(e instanceof Kf?t.Q_.Ke(e):e instanceof Fk?t.Q_.He(e):t.Q_.We(e),!r.isEqual(Ue.min()))try{const n=await zk(t.localStore);r.compareTo(n)>=0&&await function(s,a){const o=s.Q_.rt(a);return o.targetChanges.forEach((l,c)=>{if(l.resumeToken.approximateByteSize()>0){const u=s.N_.get(c);u&&s.N_.set(c,u.withResumeToken(l.resumeToken,a))}}),o.targetMismatches.forEach((l,c)=>{const u=s.N_.get(l);if(!u)return;s.N_.set(l,u.withResumeToken(kr.EMPTY_BYTE_STRING,u.snapshotVersion)),Gk(s,l);const h=new Fs(u.target,l,c,u.sequenceNumber);lv(s,h)}),s.remoteSyncer.applyRemoteEvent(o)}(t,r)}catch(n){Pe("RemoteStore","Failed to raise snapshot:",n),await Oh(t,n)}}async function Oh(t,e,r){if(!Tu(e))throw e;t.L_.add(1),await Au(t),t.q_.set("Offline"),r||(r=()=>zk(t.localStore)),t.asyncQueue.enqueueRetryable(async()=>{Pe("RemoteStore","Retrying IndexedDB access"),await r(),t.L_.delete(1),await P0(t)})}function qk(t,e){return e().catch(r=>Oh(t,r,e))}async function F0(t){const e=Be(t),r=Js(e);let n=e.O_.length>0?e.O_[e.O_.length-1].batchId:-1;for(;EO(e);)try{const i=await sO(e.localStore,n);if(i===null){e.O_.length===0&&r.o_();break}n=i.batchId,TO(e,i)}catch(i){await Oh(e,i)}Xk(e)&&Yk(e)}function EO(t){return qa(t)&&t.O_.length<10}function TO(t,e){t.O_.push(e);const r=Js(t);r.r_()&&r.V_&&r.m_(e.mutations)}function Xk(t){return qa(t)&&!Js(t).n_()&&t.O_.length>0}function Yk(t){Js(t).start()}async function kO(t){Js(t).p_()}async function SO(t){const e=Js(t);for(const r of t.O_)e.m_(r.mutations)}async function AO(t,e,r){const n=t.O_.shift(),i=tv.from(n,e,r);await qk(t,()=>t.remoteSyncer.applySuccessfulWrite(i)),await F0(t)}async function IO(t,e){e&&Js(t).V_&&await async function(n,i){if(function(a){return mb(a)&&a!==ce.ABORTED}(i.code)){const s=n.O_.shift();Js(n).s_(),await qk(n,()=>n.remoteSyncer.rejectFailedWrite(s.batchId,i)),await F0(n)}}(t,e),Xk(t)&&Yk(t)}async function ty(t,e){const r=Be(t);r.asyncQueue.verifyOperationInProgress(),Pe("RemoteStore","RemoteStore received new credentials");const n=qa(r);r.L_.add(3),await Au(r),n&&r.q_.set("Unknown"),await r.remoteSyncer.handleCredentialChange(e),r.L_.delete(3),await P0(r)}async function CO(t,e){const r=Be(t);e?(r.L_.delete(2),await P0(r)):e||(r.L_.add(2),await Au(r),r.q_.set("Unknown"))}function vl(t){return t.K_||(t.K_=function(r,n,i){const s=Be(r);return s.w_(),new dO(n,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(t.datastore,t.asyncQueue,{Eo:xO.bind(null,t),Ro:_O.bind(null,t),mo:yO.bind(null,t),d_:wO.bind(null,t)}),t.B_.push(async e=>{e?(t.K_.s_(),uv(t)?cv(t):t.q_.set("Unknown")):(await t.K_.stop(),Kk(t))})),t.K_}function Js(t){return t.U_||(t.U_=function(r,n,i){const s=Be(r);return s.w_(),new pO(n,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(t.datastore,t.asyncQueue,{Eo:()=>Promise.resolve(),Ro:kO.bind(null,t),mo:IO.bind(null,t),f_:SO.bind(null,t),g_:AO.bind(null,t)}),t.B_.push(async e=>{e?(t.U_.s_(),await F0(t)):(await t.U_.stop(),t.O_.length>0&&(Pe("RemoteStore",`Stopping write stream with ${t.O_.length} pending writes`),t.O_=[]))})),t.U_}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fv{constructor(e,r,n,i,s){this.asyncQueue=e,this.timerId=r,this.targetTimeMs=n,this.op=i,this.removalCallback=s,this.deferred=new Yi,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(a=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,r,n,i,s){const a=Date.now()+n,o=new fv(e,r,a,i,s);return o.start(n),o}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new Re(ce.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function hv(t,e){if(os("AsyncQueue",`${e}: ${t}`),Tu(t))return new Re(ce.UNAVAILABLE,`${e}: ${t}`);throw t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jo{constructor(e){this.comparator=e?(r,n)=>e(r,n)||Fe.comparator(r.key,n.key):(r,n)=>Fe.comparator(r.key,n.key),this.keyedMap=ql(),this.sortedSet=new Lt(this.comparator)}static emptySet(e){return new jo(e.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const r=this.keyedMap.get(e);return r?this.sortedSet.indexOf(r):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((r,n)=>(e(r),!1))}add(e){const r=this.delete(e.key);return r.copy(r.keyedMap.insert(e.key,e),r.sortedSet.insert(e,null))}delete(e){const r=this.get(e);return r?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(r)):this}isEqual(e){if(!(e instanceof jo)||this.size!==e.size)return!1;const r=this.sortedSet.getIterator(),n=e.sortedSet.getIterator();for(;r.hasNext();){const i=r.getNext().key,s=n.getNext().key;if(!i.isEqual(s))return!1}return!0}toString(){const e=[];return this.forEach(r=>{e.push(r.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,r){const n=new jo;return n.comparator=this.comparator,n.keyedMap=e,n.sortedSet=r,n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ry{constructor(){this.W_=new Lt(Fe.comparator)}track(e){const r=e.doc.key,n=this.W_.get(r);n?e.type!==0&&n.type===3?this.W_=this.W_.insert(r,e):e.type===3&&n.type!==1?this.W_=this.W_.insert(r,{type:n.type,doc:e.doc}):e.type===2&&n.type===2?this.W_=this.W_.insert(r,{type:2,doc:e.doc}):e.type===2&&n.type===0?this.W_=this.W_.insert(r,{type:0,doc:e.doc}):e.type===1&&n.type===0?this.W_=this.W_.remove(r):e.type===1&&n.type===2?this.W_=this.W_.insert(r,{type:1,doc:n.doc}):e.type===0&&n.type===1?this.W_=this.W_.insert(r,{type:2,doc:e.doc}):Me():this.W_=this.W_.insert(r,e)}G_(){const e=[];return this.W_.inorderTraversal((r,n)=>{e.push(n)}),e}}class sl{constructor(e,r,n,i,s,a,o,l,c){this.query=e,this.docs=r,this.oldDocs=n,this.docChanges=i,this.mutatedKeys=s,this.fromCache=a,this.syncStateChanged=o,this.excludesMetadataChanges=l,this.hasCachedResults=c}static fromInitialDocuments(e,r,n,i,s){const a=[];return r.forEach(o=>{a.push({type:0,doc:o})}),new sl(e,r,jo.emptySet(r),a,n,i,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&S0(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const r=this.docChanges,n=e.docChanges;if(r.length!==n.length)return!1;for(let i=0;i<r.length;i++)if(r[i].type!==n[i].type||!r[i].doc.isEqual(n[i].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RO{constructor(){this.z_=void 0,this.j_=[]}H_(){return this.j_.some(e=>e.J_())}}class NO{constructor(){this.queries=ny(),this.onlineState="Unknown",this.Y_=new Set}terminate(){(function(r,n){const i=Be(r),s=i.queries;i.queries=ny(),s.forEach((a,o)=>{for(const l of o.j_)l.onError(n)})})(this,new Re(ce.ABORTED,"Firestore shutting down"))}}function ny(){return new gl(t=>_k(t),S0)}async function Qk(t,e){const r=Be(t);let n=3;const i=e.query;let s=r.queries.get(i);s?!s.H_()&&e.J_()&&(n=2):(s=new RO,n=e.J_()?0:1);try{switch(n){case 0:s.z_=await r.onListen(i,!0);break;case 1:s.z_=await r.onListen(i,!1);break;case 2:await r.onFirstRemoteStoreListen(i)}}catch(a){const o=hv(a,`Initialization of query '${po(e.query)}' failed`);return void e.onError(o)}r.queries.set(i,s),s.j_.push(e),e.Z_(r.onlineState),s.z_&&e.X_(s.z_)&&dv(r)}async function Jk(t,e){const r=Be(t),n=e.query;let i=3;const s=r.queries.get(n);if(s){const a=s.j_.indexOf(e);a>=0&&(s.j_.splice(a,1),s.j_.length===0?i=e.J_()?0:1:!s.H_()&&e.J_()&&(i=2))}switch(i){case 0:return r.queries.delete(n),r.onUnlisten(n,!0);case 1:return r.queries.delete(n),r.onUnlisten(n,!1);case 2:return r.onLastRemoteStoreUnlisten(n);default:return}}function PO(t,e){const r=Be(t);let n=!1;for(const i of e){const s=i.query,a=r.queries.get(s);if(a){for(const o of a.j_)o.X_(i)&&(n=!0);a.z_=i}}n&&dv(r)}function FO(t,e,r){const n=Be(t),i=n.queries.get(e);if(i)for(const s of i.j_)s.onError(r);n.queries.delete(e)}function dv(t){t.Y_.forEach(e=>{e.next()})}var hm,iy;(iy=hm||(hm={})).ea="default",iy.Cache="cache";class Zk{constructor(e,r,n){this.query=e,this.ta=r,this.na=!1,this.ra=null,this.onlineState="Unknown",this.options=n||{}}X_(e){if(!this.options.includeMetadataChanges){const n=[];for(const i of e.docChanges)i.type!==3&&n.push(i);e=new sl(e.query,e.docs,e.oldDocs,n,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let r=!1;return this.na?this.ia(e)&&(this.ta.next(e),r=!0):this.sa(e,this.onlineState)&&(this.oa(e),r=!0),this.ra=e,r}onError(e){this.ta.error(e)}Z_(e){this.onlineState=e;let r=!1;return this.ra&&!this.na&&this.sa(this.ra,e)&&(this.oa(this.ra),r=!0),r}sa(e,r){if(!e.fromCache||!this.J_())return!0;const n=r!=="Offline";return(!this.options._a||!n)&&(!e.docs.isEmpty()||e.hasCachedResults||r==="Offline")}ia(e){if(e.docChanges.length>0)return!0;const r=this.ra&&this.ra.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!r)&&this.options.includeMetadataChanges===!0}oa(e){e=sl.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.na=!0,this.ta.next(e)}J_(){return this.options.source!==hm.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eS{constructor(e){this.key=e}}class tS{constructor(e){this.key=e}}class DO{constructor(e,r){this.query=e,this.Ta=r,this.Ea=null,this.hasCachedResults=!1,this.current=!1,this.da=Xe(),this.mutatedKeys=Xe(),this.Aa=yk(e),this.Ra=new jo(this.Aa)}get Va(){return this.Ta}ma(e,r){const n=r?r.fa:new ry,i=r?r.Ra:this.Ra;let s=r?r.mutatedKeys:this.mutatedKeys,a=i,o=!1;const l=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,c=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal((u,h)=>{const d=i.get(u),p=A0(this.query,h)?h:null,x=!!d&&this.mutatedKeys.has(d.key),v=!!p&&(p.hasLocalMutations||this.mutatedKeys.has(p.key)&&p.hasCommittedMutations);let E=!1;d&&p?d.data.isEqual(p.data)?x!==v&&(n.track({type:3,doc:p}),E=!0):this.ga(d,p)||(n.track({type:2,doc:p}),E=!0,(l&&this.Aa(p,l)>0||c&&this.Aa(p,c)<0)&&(o=!0)):!d&&p?(n.track({type:0,doc:p}),E=!0):d&&!p&&(n.track({type:1,doc:d}),E=!0,(l||c)&&(o=!0)),E&&(p?(a=a.add(p),s=v?s.add(u):s.delete(u)):(a=a.delete(u),s=s.delete(u)))}),this.query.limit!==null)for(;a.size>this.query.limit;){const u=this.query.limitType==="F"?a.last():a.first();a=a.delete(u.key),s=s.delete(u.key),n.track({type:1,doc:u})}return{Ra:a,fa:n,ns:o,mutatedKeys:s}}ga(e,r){return e.hasLocalMutations&&r.hasCommittedMutations&&!r.hasLocalMutations}applyChanges(e,r,n,i){const s=this.Ra;this.Ra=e.Ra,this.mutatedKeys=e.mutatedKeys;const a=e.fa.G_();a.sort((u,h)=>function(p,x){const v=E=>{switch(E){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Me()}};return v(p)-v(x)}(u.type,h.type)||this.Aa(u.doc,h.doc)),this.pa(n),i=i!=null&&i;const o=r&&!i?this.ya():[],l=this.da.size===0&&this.current&&!i?1:0,c=l!==this.Ea;return this.Ea=l,a.length!==0||c?{snapshot:new sl(this.query,e.Ra,s,a,e.mutatedKeys,l===0,c,!1,!!n&&n.resumeToken.approximateByteSize()>0),wa:o}:{wa:o}}Z_(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({Ra:this.Ra,fa:new ry,mutatedKeys:this.mutatedKeys,ns:!1},!1)):{wa:[]}}Sa(e){return!this.Ta.has(e)&&!!this.Ra.has(e)&&!this.Ra.get(e).hasLocalMutations}pa(e){e&&(e.addedDocuments.forEach(r=>this.Ta=this.Ta.add(r)),e.modifiedDocuments.forEach(r=>{}),e.removedDocuments.forEach(r=>this.Ta=this.Ta.delete(r)),this.current=e.current)}ya(){if(!this.current)return[];const e=this.da;this.da=Xe(),this.Ra.forEach(n=>{this.Sa(n.key)&&(this.da=this.da.add(n.key))});const r=[];return e.forEach(n=>{this.da.has(n)||r.push(new tS(n))}),this.da.forEach(n=>{e.has(n)||r.push(new eS(n))}),r}ba(e){this.Ta=e.Ts,this.da=Xe();const r=this.ma(e.documents);return this.applyChanges(r,!0)}Da(){return sl.fromInitialDocuments(this.query,this.Ra,this.mutatedKeys,this.Ea===0,this.hasCachedResults)}}class bO{constructor(e,r,n){this.query=e,this.targetId=r,this.view=n}}class OO{constructor(e){this.key=e,this.va=!1}}class LO{constructor(e,r,n,i,s,a){this.localStore=e,this.remoteStore=r,this.eventManager=n,this.sharedClientState=i,this.currentUser=s,this.maxConcurrentLimboResolutions=a,this.Ca={},this.Fa=new gl(o=>_k(o),S0),this.Ma=new Map,this.xa=new Set,this.Oa=new Lt(Fe.comparator),this.Na=new Map,this.La=new iv,this.Ba={},this.ka=new Map,this.qa=il.kn(),this.onlineState="Unknown",this.Qa=void 0}get isPrimaryClient(){return this.Qa===!0}}async function MO(t,e,r=!0){const n=oS(t);let i;const s=n.Fa.get(e);return s?(n.sharedClientState.addLocalQueryTarget(s.targetId),i=s.view.Da()):i=await rS(n,e,r,!0),i}async function VO(t,e){const r=oS(t);await rS(r,e,!0,!1)}async function rS(t,e,r,n){const i=await aO(t.localStore,_i(e)),s=i.targetId,a=t.sharedClientState.addLocalQueryTarget(s,r);let o;return n&&(o=await UO(t,e,s,a==="current",i.resumeToken)),t.isPrimaryClient&&r&&Wk(t.remoteStore,i),o}async function UO(t,e,r,n,i){t.Ka=(h,d,p)=>async function(v,E,T,w){let y=E.view.ma(T);y.ns&&(y=await J_(v.localStore,E.query,!1).then(({documents:g})=>E.view.ma(g,y)));const R=w&&w.targetChanges.get(E.targetId),M=w&&w.targetMismatches.get(E.targetId)!=null,j=E.view.applyChanges(y,v.isPrimaryClient,R,M);return ay(v,E.targetId,j.wa),j.snapshot}(t,h,d,p);const s=await J_(t.localStore,e,!0),a=new DO(e,s.Ts),o=a.ma(s.documents),l=Su.createSynthesizedTargetChangeForCurrentChange(r,n&&t.onlineState!=="Offline",i),c=a.applyChanges(o,t.isPrimaryClient,l);ay(t,r,c.wa);const u=new bO(e,r,a);return t.Fa.set(e,u),t.Ma.has(r)?t.Ma.get(r).push(e):t.Ma.set(r,[e]),c.snapshot}async function jO(t,e,r){const n=Be(t),i=n.Fa.get(e),s=n.Ma.get(i.targetId);if(s.length>1)return n.Ma.set(i.targetId,s.filter(a=>!S0(a,e))),void n.Fa.delete(e);n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(i.targetId),n.sharedClientState.isActiveQueryTarget(i.targetId)||await fm(n.localStore,i.targetId,!1).then(()=>{n.sharedClientState.clearQueryState(i.targetId),r&&ov(n.remoteStore,i.targetId),dm(n,i.targetId)}).catch(Eu)):(dm(n,i.targetId),await fm(n.localStore,i.targetId,!0))}async function BO(t,e){const r=Be(t),n=r.Fa.get(e),i=r.Ma.get(n.targetId);r.isPrimaryClient&&i.length===1&&(r.sharedClientState.removeLocalQueryTarget(n.targetId),ov(r.remoteStore,n.targetId))}async function zO(t,e,r){const n=XO(t);try{const i=await function(a,o){const l=Be(a),c=ir.now(),u=o.reduce((p,x)=>p.add(x.key),Xe());let h,d;return l.persistence.runTransaction("Locally write mutations","readwrite",p=>{let x=ls(),v=Xe();return l.cs.getEntries(p,u).next(E=>{x=E,x.forEach((T,w)=>{w.isValidDocument()||(v=v.add(T))})}).next(()=>l.localDocuments.getOverlayedDocuments(p,x)).next(E=>{h=E;const T=[];for(const w of o){const y=ub(w,h.get(w.key).overlayedDocument);y!=null&&T.push(new sa(w.key,y,fk(y.value.mapValue),Ln.exists(!0)))}return l.mutationQueue.addMutationBatch(p,c,T,o)}).next(E=>{d=E;const T=E.applyToLocalDocumentSet(h,v);return l.documentOverlayCache.saveOverlays(p,E.batchId,T)})}).then(()=>({batchId:d.batchId,changes:Ek(h)}))}(n.localStore,e);n.sharedClientState.addPendingMutation(i.batchId),function(a,o,l){let c=a.Ba[a.currentUser.toKey()];c||(c=new Lt(ct)),c=c.insert(o,l),a.Ba[a.currentUser.toKey()]=c}(n,i.batchId,r),await Iu(n,i.changes),await F0(n.remoteStore)}catch(i){const s=hv(i,"Failed to persist write");r.reject(s)}}async function nS(t,e){const r=Be(t);try{const n=await nO(r.localStore,e);e.targetChanges.forEach((i,s)=>{const a=r.Na.get(s);a&&(gt(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1),i.addedDocuments.size>0?a.va=!0:i.modifiedDocuments.size>0?gt(a.va):i.removedDocuments.size>0&&(gt(a.va),a.va=!1))}),await Iu(r,n,e)}catch(n){await Eu(n)}}function sy(t,e,r){const n=Be(t);if(n.isPrimaryClient&&r===0||!n.isPrimaryClient&&r===1){const i=[];n.Fa.forEach((s,a)=>{const o=a.view.Z_(e);o.snapshot&&i.push(o.snapshot)}),function(a,o){const l=Be(a);l.onlineState=o;let c=!1;l.queries.forEach((u,h)=>{for(const d of h.j_)d.Z_(o)&&(c=!0)}),c&&dv(l)}(n.eventManager,e),i.length&&n.Ca.d_(i),n.onlineState=e,n.isPrimaryClient&&n.sharedClientState.setOnlineState(e)}}async function $O(t,e,r){const n=Be(t);n.sharedClientState.updateQueryState(e,"rejected",r);const i=n.Na.get(e),s=i&&i.key;if(s){let a=new Lt(Fe.comparator);a=a.insert(s,Or.newNoDocument(s,Ue.min()));const o=Xe().add(s),l=new R0(Ue.min(),new Map,new Lt(ct),a,o);await nS(n,l),n.Oa=n.Oa.remove(s),n.Na.delete(e),pv(n)}else await fm(n.localStore,e,!1).then(()=>dm(n,e,r)).catch(Eu)}async function HO(t,e){const r=Be(t),n=e.batch.batchId;try{const i=await rO(r.localStore,e);sS(r,n,null),iS(r,n),r.sharedClientState.updateMutationState(n,"acknowledged"),await Iu(r,i)}catch(i){await Eu(i)}}async function WO(t,e,r){const n=Be(t);try{const i=await function(a,o){const l=Be(a);return l.persistence.runTransaction("Reject batch","readwrite-primary",c=>{let u;return l.mutationQueue.lookupMutationBatch(c,o).next(h=>(gt(h!==null),u=h.keys(),l.mutationQueue.removeMutationBatch(c,h))).next(()=>l.mutationQueue.performConsistencyCheck(c)).next(()=>l.documentOverlayCache.removeOverlaysForBatchId(c,u,o)).next(()=>l.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(c,u)).next(()=>l.localDocuments.getDocuments(c,u))})}(n.localStore,e);sS(n,e,r),iS(n,e),n.sharedClientState.updateMutationState(e,"rejected",r),await Iu(n,i)}catch(i){await Eu(i)}}function iS(t,e){(t.ka.get(e)||[]).forEach(r=>{r.resolve()}),t.ka.delete(e)}function sS(t,e,r){const n=Be(t);let i=n.Ba[n.currentUser.toKey()];if(i){const s=i.get(e);s&&(r?s.reject(r):s.resolve(),i=i.remove(e)),n.Ba[n.currentUser.toKey()]=i}}function dm(t,e,r=null){t.sharedClientState.removeLocalQueryTarget(e);for(const n of t.Ma.get(e))t.Fa.delete(n),r&&t.Ca.$a(n,r);t.Ma.delete(e),t.isPrimaryClient&&t.La.gr(e).forEach(n=>{t.La.containsKey(n)||aS(t,n)})}function aS(t,e){t.xa.delete(e.path.canonicalString());const r=t.Oa.get(e);r!==null&&(ov(t.remoteStore,r),t.Oa=t.Oa.remove(e),t.Na.delete(r),pv(t))}function ay(t,e,r){for(const n of r)n instanceof eS?(t.La.addReference(n.key,e),GO(t,n)):n instanceof tS?(Pe("SyncEngine","Document no longer in limbo: "+n.key),t.La.removeReference(n.key,e),t.La.containsKey(n.key)||aS(t,n.key)):Me()}function GO(t,e){const r=e.key,n=r.path.canonicalString();t.Oa.get(r)||t.xa.has(n)||(Pe("SyncEngine","New document in limbo: "+r),t.xa.add(n),pv(t))}function pv(t){for(;t.xa.size>0&&t.Oa.size<t.maxConcurrentLimboResolutions;){const e=t.xa.values().next().value;t.xa.delete(e);const r=new Fe(It.fromString(e)),n=t.qa.next();t.Na.set(n,new OO(r)),t.Oa=t.Oa.insert(r,n),Wk(t.remoteStore,new Fs(_i(Jg(r.path)),n,"TargetPurposeLimboResolution",Gg.oe))}}async function Iu(t,e,r){const n=Be(t),i=[],s=[],a=[];n.Fa.isEmpty()||(n.Fa.forEach((o,l)=>{a.push(n.Ka(l,e,r).then(c=>{var u;if((c||r)&&n.isPrimaryClient){const h=c?!c.fromCache:(u=r==null?void 0:r.targetChanges.get(l.targetId))===null||u===void 0?void 0:u.current;n.sharedClientState.updateQueryState(l.targetId,h?"current":"not-current")}if(c){i.push(c);const h=av.Wi(l.targetId,c);s.push(h)}}))}),await Promise.all(a),n.Ca.d_(i),await async function(l,c){const u=Be(l);try{await u.persistence.runTransaction("notifyLocalViewChanges","readwrite",h=>ge.forEach(c,d=>ge.forEach(d.$i,p=>u.persistence.referenceDelegate.addReference(h,d.targetId,p)).next(()=>ge.forEach(d.Ui,p=>u.persistence.referenceDelegate.removeReference(h,d.targetId,p)))))}catch(h){if(!Tu(h))throw h;Pe("LocalStore","Failed to update sequence numbers: "+h)}for(const h of c){const d=h.targetId;if(!h.fromCache){const p=u.os.get(d),x=p.snapshotVersion,v=p.withLastLimboFreeSnapshotVersion(x);u.os=u.os.insert(d,v)}}}(n.localStore,s))}async function KO(t,e){const r=Be(t);if(!r.currentUser.isEqual(e)){Pe("SyncEngine","User change. New user:",e.toKey());const n=await Bk(r.localStore,e);r.currentUser=e,function(s,a){s.ka.forEach(o=>{o.forEach(l=>{l.reject(new Re(ce.CANCELLED,a))})}),s.ka.clear()}(r,"'waitForPendingWrites' promise is rejected due to a user change."),r.sharedClientState.handleUserChange(e,n.removedBatchIds,n.addedBatchIds),await Iu(r,n.hs)}}function qO(t,e){const r=Be(t),n=r.Na.get(e);if(n&&n.va)return Xe().add(n.key);{let i=Xe();const s=r.Ma.get(e);if(!s)return i;for(const a of s){const o=r.Fa.get(a);i=i.unionWith(o.view.Va)}return i}}function oS(t){const e=Be(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=nS.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=qO.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=$O.bind(null,e),e.Ca.d_=PO.bind(null,e.eventManager),e.Ca.$a=FO.bind(null,e.eventManager),e}function XO(t){const e=Be(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=HO.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=WO.bind(null,e),e}class Lh{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=N0(e.databaseInfo.databaseId),this.sharedClientState=this.Wa(e),this.persistence=this.Ga(e),await this.persistence.start(),this.localStore=this.za(e),this.gcScheduler=this.ja(e,this.localStore),this.indexBackfillerScheduler=this.Ha(e,this.localStore)}ja(e,r){return null}Ha(e,r){return null}za(e){return tO(this.persistence,new Zb,e.initialUser,this.serializer)}Ga(e){return new Yb(sv.Zr,this.serializer)}Wa(e){return new lO}async terminate(){var e,r;(e=this.gcScheduler)===null||e===void 0||e.stop(),(r=this.indexBackfillerScheduler)===null||r===void 0||r.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}Lh.provider={build:()=>new Lh};class pm{async initialize(e,r){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(r),this.remoteStore=this.createRemoteStore(r),this.eventManager=this.createEventManager(r),this.syncEngine=this.createSyncEngine(r,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=n=>sy(this.syncEngine,n,1),this.remoteStore.remoteSyncer.handleCredentialChange=KO.bind(null,this.syncEngine),await CO(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new NO}()}createDatastore(e){const r=N0(e.databaseInfo.databaseId),n=function(s){return new hO(s)}(e.databaseInfo);return function(s,a,o,l){return new mO(s,a,o,l)}(e.authCredentials,e.appCheckCredentials,n,r)}createRemoteStore(e){return function(n,i,s,a,o){return new vO(n,i,s,a,o)}(this.localStore,this.datastore,e.asyncQueue,r=>sy(this.syncEngine,r,0),function(){return ey.D()?new ey:new cO}())}createSyncEngine(e,r){return function(i,s,a,o,l,c,u){const h=new LO(i,s,a,o,l,c);return u&&(h.Qa=!0),h}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,r)}async terminate(){var e,r;await async function(i){const s=Be(i);Pe("RemoteStore","RemoteStore shutting down."),s.L_.add(5),await Au(s),s.k_.shutdown(),s.q_.set("Unknown")}(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate(),(r=this.eventManager)===null||r===void 0||r.terminate()}}pm.provider={build:()=>new pm};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lS{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ya(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ya(this.observer.error,e):os("Uncaught Error in snapshot listener:",e.toString()))}Za(){this.muted=!0}Ya(e,r){setTimeout(()=>{this.muted||e(r)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YO{constructor(e,r,n,i,s){this.authCredentials=e,this.appCheckCredentials=r,this.asyncQueue=n,this.databaseInfo=i,this.user=Fr.UNAUTHENTICATED,this.clientId=lk.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=s,this.authCredentials.start(n,async a=>{Pe("FirestoreClient","Received user=",a.uid),await this.authCredentialListener(a),this.user=a}),this.appCheckCredentials.start(n,a=>(Pe("FirestoreClient","Received new app check token=",a),this.appCheckCredentialListener(a,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new Yi;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(r){const n=hv(r,"Failed to shutdown persistence");e.reject(n)}}),e.promise}}async function Md(t,e){t.asyncQueue.verifyOperationInProgress(),Pe("FirestoreClient","Initializing OfflineComponentProvider");const r=t.configuration;await e.initialize(r);let n=r.initialUser;t.setCredentialChangeListener(async i=>{n.isEqual(i)||(await Bk(e.localStore,i),n=i)}),e.persistence.setDatabaseDeletedListener(()=>t.terminate()),t._offlineComponents=e}async function oy(t,e){t.asyncQueue.verifyOperationInProgress();const r=await QO(t);Pe("FirestoreClient","Initializing OnlineComponentProvider"),await e.initialize(r,t.configuration),t.setCredentialChangeListener(n=>ty(e.remoteStore,n)),t.setAppCheckTokenChangeListener((n,i)=>ty(e.remoteStore,i)),t._onlineComponents=e}async function QO(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){Pe("FirestoreClient","Using user provided OfflineComponentProvider");try{await Md(t,t._uninitializedComponentsProvider._offline)}catch(e){const r=e;if(!function(i){return i.name==="FirebaseError"?i.code===ce.FAILED_PRECONDITION||i.code===ce.UNIMPLEMENTED:!(typeof DOMException<"u"&&i instanceof DOMException)||i.code===22||i.code===20||i.code===11}(r))throw r;el("Error using user provided cache. Falling back to memory cache: "+r),await Md(t,new Lh)}}else Pe("FirestoreClient","Using default OfflineComponentProvider"),await Md(t,new Lh);return t._offlineComponents}async function cS(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(Pe("FirestoreClient","Using user provided OnlineComponentProvider"),await oy(t,t._uninitializedComponentsProvider._online)):(Pe("FirestoreClient","Using default OnlineComponentProvider"),await oy(t,new pm))),t._onlineComponents}function JO(t){return cS(t).then(e=>e.syncEngine)}async function uS(t){const e=await cS(t),r=e.eventManager;return r.onListen=MO.bind(null,e.syncEngine),r.onUnlisten=jO.bind(null,e.syncEngine),r.onFirstRemoteStoreListen=VO.bind(null,e.syncEngine),r.onLastRemoteStoreUnlisten=BO.bind(null,e.syncEngine),r}function ZO(t,e,r={}){const n=new Yi;return t.asyncQueue.enqueueAndForget(async()=>function(s,a,o,l,c){const u=new lS({next:d=>{u.Za(),a.enqueueAndForget(()=>Jk(s,h));const p=d.docs.has(o);!p&&d.fromCache?c.reject(new Re(ce.UNAVAILABLE,"Failed to get document because the client is offline.")):p&&d.fromCache&&l&&l.source==="server"?c.reject(new Re(ce.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):c.resolve(d)},error:d=>c.reject(d)}),h=new Zk(Jg(o.path),u,{includeMetadataChanges:!0,_a:!0});return Qk(s,h)}(await uS(t),t.asyncQueue,e,r,n)),n.promise}function e6(t,e,r={}){const n=new Yi;return t.asyncQueue.enqueueAndForget(async()=>function(s,a,o,l,c){const u=new lS({next:d=>{u.Za(),a.enqueueAndForget(()=>Jk(s,h)),d.fromCache&&l.source==="server"?c.reject(new Re(ce.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):c.resolve(d)},error:d=>c.reject(d)}),h=new Zk(o,u,{includeMetadataChanges:!0,_a:!0});return Qk(s,h)}(await uS(t),t.asyncQueue,e,r,n)),n.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fS(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ly=new Map;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hS(t,e,r){if(!r)throw new Re(ce.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function t6(t,e,r,n){if(e===!0&&n===!0)throw new Re(ce.INVALID_ARGUMENT,`${t} and ${r} cannot be used together.`)}function cy(t){if(!Fe.isDocumentKey(t))throw new Re(ce.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function uy(t){if(Fe.isDocumentKey(t))throw new Re(ce.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function D0(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=function(n){return n.constructor?n.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":Me()}function ai(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new Re(ce.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const r=D0(t);throw new Re(ce.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${r}`)}}return t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fy{constructor(e){var r,n;if(e.host===void 0){if(e.ssl!==void 0)throw new Re(ce.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=(r=e.ssl)===null||r===void 0||r;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new Re(ce.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}t6("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=fS((n=e.experimentalLongPollingOptions)!==null&&n!==void 0?n:{}),function(s){if(s.timeoutSeconds!==void 0){if(isNaN(s.timeoutSeconds))throw new Re(ce.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (must not be NaN)`);if(s.timeoutSeconds<5)throw new Re(ce.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (minimum allowed value is 5)`);if(s.timeoutSeconds>30)throw new Re(ce.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(n,i){return n.timeoutSeconds===i.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class b0{constructor(e,r,n,i){this._authCredentials=e,this._appCheckCredentials=r,this._databaseId=n,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new fy({}),this._settingsFrozen=!1,this._terminateTask="notTerminated"}get app(){if(!this._app)throw new Re(ce.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new Re(ce.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new fy(e),e.credentials!==void 0&&(this._authCredentials=function(n){if(!n)return new x3;switch(n.type){case"firstParty":return new E3(n.sessionIndex||"0",n.iamToken||null,n.authTokenFactory||null);case"provider":return n.client;default:throw new Re(ce.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(r){const n=ly.get(r);n&&(Pe("ComponentProvider","Removing Datastore"),ly.delete(r),n.terminate())}(this),Promise.resolve()}}function r6(t,e,r,n={}){var i;const s=(t=ai(t,b0))._getSettings(),a=`${e}:${r}`;if(s.host!=="firestore.googleapis.com"&&s.host!==a&&el("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),t._setSettings(Object.assign(Object.assign({},s),{host:a,ssl:!1})),n.mockUserToken){let o,l;if(typeof n.mockUserToken=="string")o=n.mockUserToken,l=Fr.MOCK_USER;else{o=mT(n.mockUserToken,(i=t._app)===null||i===void 0?void 0:i.options.projectId);const c=n.mockUserToken.sub||n.mockUserToken.user_id;if(!c)throw new Re(ce.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");l=new Fr(c)}t._authCredentials=new _3(new ok(o,l))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xa{constructor(e,r,n){this.converter=r,this._query=n,this.type="query",this.firestore=e}withConverter(e){return new Xa(this.firestore,e,this._query)}}class qr{constructor(e,r,n){this.converter=r,this._key=n,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Ws(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new qr(this.firestore,e,this._key)}}class Ws extends Xa{constructor(e,r,n){super(e,r,Jg(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new qr(this.firestore,null,new Fe(e))}withConverter(e){return new Ws(this.firestore,e,this._path)}}function Mh(t,e,...r){if(t=Jt(t),hS("collection","path",e),t instanceof b0){const n=It.fromString(e,...r);return uy(n),new Ws(t,null,n)}{if(!(t instanceof qr||t instanceof Ws))throw new Re(ce.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=t._path.child(It.fromString(e,...r));return uy(n),new Ws(t.firestore,null,n)}}function Ii(t,e,...r){if(t=Jt(t),arguments.length===1&&(e=lk.newId()),hS("doc","path",e),t instanceof b0){const n=It.fromString(e,...r);return cy(n),new qr(t,null,new Fe(n))}{if(!(t instanceof qr||t instanceof Ws))throw new Re(ce.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=t._path.child(It.fromString(e,...r));return cy(n),new qr(t.firestore,t instanceof Ws?t.converter:null,new Fe(n))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hy{constructor(e=Promise.resolve()){this.Pu=[],this.Iu=!1,this.Tu=[],this.Eu=null,this.du=!1,this.Au=!1,this.Ru=[],this.t_=new $k(this,"async_queue_retry"),this.Vu=()=>{const n=Ld();n&&Pe("AsyncQueue","Visibility state changed to "+n.visibilityState),this.t_.jo()},this.mu=e;const r=Ld();r&&typeof r.addEventListener=="function"&&r.addEventListener("visibilitychange",this.Vu)}get isShuttingDown(){return this.Iu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.fu(),this.gu(e)}enterRestrictedMode(e){if(!this.Iu){this.Iu=!0,this.Au=e||!1;const r=Ld();r&&typeof r.removeEventListener=="function"&&r.removeEventListener("visibilitychange",this.Vu)}}enqueue(e){if(this.fu(),this.Iu)return new Promise(()=>{});const r=new Yi;return this.gu(()=>this.Iu&&this.Au?Promise.resolve():(e().then(r.resolve,r.reject),r.promise)).then(()=>r.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Pu.push(e),this.pu()))}async pu(){if(this.Pu.length!==0){try{await this.Pu[0](),this.Pu.shift(),this.t_.reset()}catch(e){if(!Tu(e))throw e;Pe("AsyncQueue","Operation failed with retryable error: "+e)}this.Pu.length>0&&this.t_.Go(()=>this.pu())}}gu(e){const r=this.mu.then(()=>(this.du=!0,e().catch(n=>{this.Eu=n,this.du=!1;const i=function(a){let o=a.message||"";return a.stack&&(o=a.stack.includes(a.message)?a.stack:a.message+`
`+a.stack),o}(n);throw os("INTERNAL UNHANDLED ERROR: ",i),n}).then(n=>(this.du=!1,n))));return this.mu=r,r}enqueueAfterDelay(e,r,n){this.fu(),this.Ru.indexOf(e)>-1&&(r=0);const i=fv.createAndSchedule(this,e,r,n,s=>this.yu(s));return this.Tu.push(i),i}fu(){this.Eu&&Me()}verifyOperationInProgress(){}async wu(){let e;do e=this.mu,await e;while(e!==this.mu)}Su(e){for(const r of this.Tu)if(r.timerId===e)return!0;return!1}bu(e){return this.wu().then(()=>{this.Tu.sort((r,n)=>r.targetTimeMs-n.targetTimeMs);for(const r of this.Tu)if(r.skipDelay(),e!=="all"&&r.timerId===e)break;return this.wu()})}Du(e){this.Ru.push(e)}yu(e){const r=this.Tu.indexOf(e);this.Tu.splice(r,1)}}class Ya extends b0{constructor(e,r,n,i){super(e,r,n,i),this.type="firestore",this._queue=new hy,this._persistenceKey=(i==null?void 0:i.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new hy(e),this._firestoreClient=void 0,await e}}}function n6(t,e){const r=typeof t=="object"?t:y0(),n=typeof t=="string"?t:"(default)",i=xu(r,"firestore").getImmediate({identifier:n});if(!i._initialized){const s=Pg("firestore");s&&r6(i,...s)}return i}function mv(t){if(t._terminated)throw new Re(ce.FAILED_PRECONDITION,"The client has already been terminated.");return t._firestoreClient||i6(t),t._firestoreClient}function i6(t){var e,r,n;const i=t._freezeSettings(),s=function(o,l,c,u){return new O3(o,l,c,u.host,u.ssl,u.experimentalForceLongPolling,u.experimentalAutoDetectLongPolling,fS(u.experimentalLongPollingOptions),u.useFetchStreams)}(t._databaseId,((e=t._app)===null||e===void 0?void 0:e.options.appId)||"",t._persistenceKey,i);t._componentsProvider||!((r=i.localCache)===null||r===void 0)&&r._offlineComponentProvider&&(!((n=i.localCache)===null||n===void 0)&&n._onlineComponentProvider)&&(t._componentsProvider={_offline:i.localCache._offlineComponentProvider,_online:i.localCache._onlineComponentProvider}),t._firestoreClient=new YO(t._authCredentials,t._appCheckCredentials,t._queue,s,t._componentsProvider&&function(o){const l=o==null?void 0:o._online.build();return{_offline:o==null?void 0:o._offline.build(l),_online:l}}(t._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class al{constructor(e){this._byteString=e}static fromBase64String(e){try{return new al(kr.fromBase64String(e))}catch(r){throw new Re(ce.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+r)}}static fromUint8Array(e){return new al(kr.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class O0{constructor(...e){for(let r=0;r<e.length;++r)if(e[r].length===0)throw new Re(ce.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new xr(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class L0{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gv{constructor(e,r){if(!isFinite(e)||e<-90||e>90)throw new Re(ce.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(r)||r<-180||r>180)throw new Re(ce.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+r);this._lat=e,this._long=r}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return ct(this._lat,e._lat)||ct(this._long,e._long)}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vv{constructor(e){this._values=(e||[]).map(r=>r)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(n,i){if(n.length!==i.length)return!1;for(let s=0;s<n.length;++s)if(n[s]!==i[s])return!1;return!0}(this._values,e._values)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const s6=/^__.*__$/;class a6{constructor(e,r,n){this.data=e,this.fieldMask=r,this.fieldTransforms=n}toMutation(e,r){return this.fieldMask!==null?new sa(e,this.data,this.fieldMask,r,this.fieldTransforms):new ku(e,this.data,r,this.fieldTransforms)}}class dS{constructor(e,r,n){this.data=e,this.fieldMask=r,this.fieldTransforms=n}toMutation(e,r){return new sa(e,this.data,this.fieldMask,r,this.fieldTransforms)}}function pS(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Me()}}class xv{constructor(e,r,n,i,s,a){this.settings=e,this.databaseId=r,this.serializer=n,this.ignoreUndefinedProperties=i,s===void 0&&this.vu(),this.fieldTransforms=s||[],this.fieldMask=a||[]}get path(){return this.settings.path}get Cu(){return this.settings.Cu}Fu(e){return new xv(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Mu(e){var r;const n=(r=this.path)===null||r===void 0?void 0:r.child(e),i=this.Fu({path:n,xu:!1});return i.Ou(e),i}Nu(e){var r;const n=(r=this.path)===null||r===void 0?void 0:r.child(e),i=this.Fu({path:n,xu:!1});return i.vu(),i}Lu(e){return this.Fu({path:void 0,xu:!0})}Bu(e){return Vh(e,this.settings.methodName,this.settings.ku||!1,this.path,this.settings.qu)}contains(e){return this.fieldMask.find(r=>e.isPrefixOf(r))!==void 0||this.fieldTransforms.find(r=>e.isPrefixOf(r.field))!==void 0}vu(){if(this.path)for(let e=0;e<this.path.length;e++)this.Ou(this.path.get(e))}Ou(e){if(e.length===0)throw this.Bu("Document fields must not be empty");if(pS(this.Cu)&&s6.test(e))throw this.Bu('Document fields cannot begin and end with "__"')}}class o6{constructor(e,r,n){this.databaseId=e,this.ignoreUndefinedProperties=r,this.serializer=n||N0(e)}Qu(e,r,n,i=!1){return new xv({Cu:e,methodName:r,qu:n,path:xr.emptyPath(),xu:!1,ku:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function M0(t){const e=t._freezeSettings(),r=N0(t._databaseId);return new o6(t._databaseId,!!e.ignoreUndefinedProperties,r)}function mS(t,e,r,n,i,s={}){const a=t.Qu(s.merge||s.mergeFields?2:0,e,r,i);yv("Data must be an object, but it was:",a,n);const o=gS(n,a);let l,c;if(s.merge)l=new xn(a.fieldMask),c=a.fieldTransforms;else if(s.mergeFields){const u=[];for(const h of s.mergeFields){const d=mm(e,h,r);if(!a.contains(d))throw new Re(ce.INVALID_ARGUMENT,`Field '${d}' is specified in your field mask but missing from your input data.`);xS(u,d)||u.push(d)}l=new xn(u),c=a.fieldTransforms.filter(h=>l.covers(h.field))}else l=null,c=a.fieldTransforms;return new a6(new an(o),l,c)}class V0 extends L0{_toFieldTransform(e){if(e.Cu!==2)throw e.Cu===1?e.Bu(`${this._methodName}() can only appear at the top level of your update data`):e.Bu(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof V0}}class _v extends L0{_toFieldTransform(e){return new ab(e.path,new Jc)}isEqual(e){return e instanceof _v}}function l6(t,e,r,n){const i=t.Qu(1,e,r);yv("Data must be an object, but it was:",i,n);const s=[],a=an.empty();Ka(n,(l,c)=>{const u=wv(e,l,r);c=Jt(c);const h=i.Nu(u);if(c instanceof V0)s.push(u);else{const d=Cu(c,h);d!=null&&(s.push(u),a.set(u,d))}});const o=new xn(s);return new dS(a,o,i.fieldTransforms)}function c6(t,e,r,n,i,s){const a=t.Qu(1,e,r),o=[mm(e,n,r)],l=[i];if(s.length%2!=0)throw new Re(ce.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let d=0;d<s.length;d+=2)o.push(mm(e,s[d])),l.push(s[d+1]);const c=[],u=an.empty();for(let d=o.length-1;d>=0;--d)if(!xS(c,o[d])){const p=o[d];let x=l[d];x=Jt(x);const v=a.Nu(p);if(x instanceof V0)c.push(p);else{const E=Cu(x,v);E!=null&&(c.push(p),u.set(p,E))}}const h=new xn(c);return new dS(u,h,a.fieldTransforms)}function u6(t,e,r,n=!1){return Cu(r,t.Qu(n?4:3,e))}function Cu(t,e){if(vS(t=Jt(t)))return yv("Unsupported field value:",e,t),gS(t,e);if(t instanceof L0)return function(n,i){if(!pS(i.Cu))throw i.Bu(`${n._methodName}() can only be used with update() and set()`);if(!i.path)throw i.Bu(`${n._methodName}() is not currently supported inside arrays`);const s=n._toFieldTransform(i);s&&i.fieldTransforms.push(s)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.xu&&e.Cu!==4)throw e.Bu("Nested arrays are not supported");return function(n,i){const s=[];let a=0;for(const o of n){let l=Cu(o,i.Lu(a));l==null&&(l={nullValue:"NULL_VALUE"}),s.push(l),a++}return{arrayValue:{values:s}}}(t,e)}return function(n,i){if((n=Jt(n))===null)return{nullValue:"NULL_VALUE"};if(typeof n=="number")return nb(i.serializer,n);if(typeof n=="boolean")return{booleanValue:n};if(typeof n=="string")return{stringValue:n};if(n instanceof Date){const s=ir.fromDate(n);return{timestampValue:bh(i.serializer,s)}}if(n instanceof ir){const s=new ir(n.seconds,1e3*Math.floor(n.nanoseconds/1e3));return{timestampValue:bh(i.serializer,s)}}if(n instanceof gv)return{geoPointValue:{latitude:n.latitude,longitude:n.longitude}};if(n instanceof al)return{bytesValue:bk(i.serializer,n._byteString)};if(n instanceof qr){const s=i.databaseId,a=n.firestore._databaseId;if(!a.isEqual(s))throw i.Bu(`Document reference is for database ${a.projectId}/${a.database} but should be for database ${s.projectId}/${s.database}`);return{referenceValue:nv(n.firestore._databaseId||i.databaseId,n._key.path)}}if(n instanceof vv)return function(a,o){return{mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{values:a.toArray().map(l=>{if(typeof l!="number")throw o.Bu("VectorValues must only contain numeric values.");return Zg(o.serializer,l)})}}}}}}(n,i);throw i.Bu(`Unsupported field value: ${D0(n)}`)}(t,e)}function gS(t,e){const r={};return ck(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Ka(t,(n,i)=>{const s=Cu(i,e.Mu(n));s!=null&&(r[n]=s)}),{mapValue:{fields:r}}}function vS(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof ir||t instanceof gv||t instanceof al||t instanceof qr||t instanceof L0||t instanceof vv)}function yv(t,e,r){if(!vS(r)||!function(i){return typeof i=="object"&&i!==null&&(Object.getPrototypeOf(i)===Object.prototype||Object.getPrototypeOf(i)===null)}(r)){const n=D0(r);throw n==="an object"?e.Bu(t+" a custom object"):e.Bu(t+" "+n)}}function mm(t,e,r){if((e=Jt(e))instanceof O0)return e._internalPath;if(typeof e=="string")return wv(t,e);throw Vh("Field path arguments must be of type string or ",t,!1,void 0,r)}const f6=new RegExp("[~\\*/\\[\\]]");function wv(t,e,r){if(e.search(f6)>=0)throw Vh(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,r);try{return new O0(...e.split("."))._internalPath}catch{throw Vh(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,r)}}function Vh(t,e,r,n,i){const s=n&&!n.isEmpty(),a=i!==void 0;let o=`Function ${e}() called with invalid data`;r&&(o+=" (via `toFirestore()`)"),o+=". ";let l="";return(s||a)&&(l+=" (found",s&&(l+=` in field ${n}`),a&&(l+=` in document ${i}`),l+=")"),new Re(ce.INVALID_ARGUMENT,o+t+l)}function xS(t,e){return t.some(r=>r.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _S{constructor(e,r,n,i,s){this._firestore=e,this._userDataWriter=r,this._key=n,this._document=i,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new qr(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new h6(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const r=this._document.data.field(U0("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r)}}}class h6 extends _S{data(){return super.data()}}function U0(t,e){return typeof e=="string"?wv(t,e):e instanceof O0?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function d6(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new Re(ce.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class Ev{}class yS extends Ev{}function gm(t,e,...r){let n=[];e instanceof Ev&&n.push(e),n=n.concat(r),function(s){const a=s.filter(l=>l instanceof Tv).length,o=s.filter(l=>l instanceof j0).length;if(a>1||a>0&&o>0)throw new Re(ce.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(n);for(const i of n)t=i._apply(t);return t}class j0 extends yS{constructor(e,r,n){super(),this._field=e,this._op=r,this._value=n,this.type="where"}static _create(e,r,n){return new j0(e,r,n)}_apply(e){const r=this._parse(e);return wS(e._query,r),new Xa(e.firestore,e.converter,sm(e._query,r))}_parse(e){const r=M0(e.firestore);return function(s,a,o,l,c,u,h){let d;if(c.isKeyField()){if(u==="array-contains"||u==="array-contains-any")throw new Re(ce.INVALID_ARGUMENT,`Invalid Query. You can't perform '${u}' queries on documentId().`);if(u==="in"||u==="not-in"){my(h,u);const p=[];for(const x of h)p.push(py(l,s,x));d={arrayValue:{values:p}}}else d=py(l,s,h)}else u!=="in"&&u!=="not-in"&&u!=="array-contains-any"||my(h,u),d=u6(o,a,h,u==="in"||u==="not-in");return Qt.create(c,u,d)}(e._query,"where",r,e.firestore._databaseId,this._field,this._op,this._value)}}function dy(t,e,r){const n=e,i=U0("where",t);return j0._create(i,n,r)}class Tv extends Ev{constructor(e,r){super(),this.type=e,this._queryConstraints=r}static _create(e,r){return new Tv(e,r)}_parse(e){const r=this._queryConstraints.map(n=>n._parse(e)).filter(n=>n.getFilters().length>0);return r.length===1?r[0]:si.create(r,this._getOperator())}_apply(e){const r=this._parse(e);return r.getFilters().length===0?e:(function(i,s){let a=i;const o=s.getFlattenedFilters();for(const l of o)wS(a,l),a=sm(a,l)}(e._query,r),new Xa(e.firestore,e.converter,sm(e._query,r)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class kv extends yS{constructor(e,r){super(),this._field=e,this._direction=r,this.type="orderBy"}static _create(e,r){return new kv(e,r)}_apply(e){const r=function(i,s,a){if(i.startAt!==null)throw new Re(ce.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(i.endAt!==null)throw new Re(ce.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new Qc(s,a)}(e._query,this._field,this._direction);return new Xa(e.firestore,e.converter,function(i,s){const a=i.explicitOrderBy.concat([s]);return new ml(i.path,i.collectionGroup,a,i.filters.slice(),i.limit,i.limitType,i.startAt,i.endAt)}(e._query,r))}}function p6(t,e="asc"){const r=e,n=U0("orderBy",t);return kv._create(n,r)}function py(t,e,r){if(typeof(r=Jt(r))=="string"){if(r==="")throw new Re(ce.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!xk(e)&&r.indexOf("/")!==-1)throw new Re(ce.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${r}' contains a '/' character.`);const n=e.path.child(It.fromString(r));if(!Fe.isDocumentKey(n))throw new Re(ce.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${n}' is not because it has an odd number of segments (${n.length}).`);return O_(t,new Fe(n))}if(r instanceof qr)return O_(t,r._key);throw new Re(ce.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${D0(r)}.`)}function my(t,e){if(!Array.isArray(t)||t.length===0)throw new Re(ce.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function wS(t,e){const r=function(i,s){for(const a of i)for(const o of a.getFlattenedFilters())if(s.indexOf(o.op)>=0)return o.op;return null}(t.filters,function(i){switch(i){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(r!==null)throw r===e.op?new Re(ce.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new Re(ce.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${r.toString()}' filters.`)}class m6{convertValue(e,r="none"){switch(Ma(e)){case 0:return null;case 1:return e.booleanValue;case 2:return zt(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,r);case 5:return e.stringValue;case 6:return this.convertBytes(La(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,r);case 11:return this.convertObject(e.mapValue,r);case 10:return this.convertVectorValue(e.mapValue);default:throw Me()}}convertObject(e,r){return this.convertObjectMap(e.fields,r)}convertObjectMap(e,r="none"){const n={};return Ka(e,(i,s)=>{n[i]=this.convertValue(s,r)}),n}convertVectorValue(e){var r,n,i;const s=(i=(n=(r=e.fields)===null||r===void 0?void 0:r.value.arrayValue)===null||n===void 0?void 0:n.values)===null||i===void 0?void 0:i.map(a=>zt(a.doubleValue));return new vv(s)}convertGeoPoint(e){return new gv(zt(e.latitude),zt(e.longitude))}convertArray(e,r){return(e.values||[]).map(n=>this.convertValue(n,r))}convertServerTimestamp(e,r){switch(r){case"previous":const n=qg(e);return n==null?null:this.convertValue(n,r);case"estimate":return this.convertTimestamp(qc(e));default:return null}}convertTimestamp(e){const r=Qs(e);return new ir(r.seconds,r.nanos)}convertDocumentKey(e,r){const n=It.fromString(e);gt(jk(n));const i=new Xc(n.get(1),n.get(3)),s=new Fe(n.popFirst(5));return i.isEqual(r)||os(`Document ${s} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${r.projectId}/${r.database}) instead.`),s}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ES(t,e,r){let n;return n=t?r&&(r.merge||r.mergeFields)?t.toFirestore(e,r):t.toFirestore(e):e,n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yl{constructor(e,r){this.hasPendingWrites=e,this.fromCache=r}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class TS extends _S{constructor(e,r,n,i,s,a){super(e,r,n,i,a),this._firestore=e,this._firestoreImpl=e,this.metadata=s}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const r=new qf(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(r,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,r={}){if(this._document){const n=this._document.data.field(U0("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n,r.serverTimestamps)}}}class qf extends TS{data(e={}){return super.data(e)}}class g6{constructor(e,r,n,i){this._firestore=e,this._userDataWriter=r,this._snapshot=i,this.metadata=new Yl(i.hasPendingWrites,i.fromCache),this.query=n}get docs(){const e=[];return this.forEach(r=>e.push(r)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,r){this._snapshot.docs.forEach(n=>{e.call(r,new qf(this._firestore,this._userDataWriter,n.key,n,new Yl(this._snapshot.mutatedKeys.has(n.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const r=!!e.includeMetadataChanges;if(r&&this._snapshot.excludesMetadataChanges)throw new Re(ce.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===r||(this._cachedChanges=function(i,s){if(i._snapshot.oldDocs.isEmpty()){let a=0;return i._snapshot.docChanges.map(o=>{const l=new qf(i._firestore,i._userDataWriter,o.doc.key,o.doc,new Yl(i._snapshot.mutatedKeys.has(o.doc.key),i._snapshot.fromCache),i.query.converter);return o.doc,{type:"added",doc:l,oldIndex:-1,newIndex:a++}})}{let a=i._snapshot.oldDocs;return i._snapshot.docChanges.filter(o=>s||o.type!==3).map(o=>{const l=new qf(i._firestore,i._userDataWriter,o.doc.key,o.doc,new Yl(i._snapshot.mutatedKeys.has(o.doc.key),i._snapshot.fromCache),i.query.converter);let c=-1,u=-1;return o.type!==0&&(c=a.indexOf(o.doc.key),a=a.delete(o.doc.key)),o.type!==1&&(a=a.add(o.doc),u=a.indexOf(o.doc.key)),{type:v6(o.type),doc:l,oldIndex:c,newIndex:u}})}}(this,r),this._cachedChangesIncludeMetadataChanges=r),this._cachedChanges}}function v6(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Me()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Va(t){t=ai(t,qr);const e=ai(t.firestore,Ya);return ZO(mv(e),t._key).then(r=>_6(e,t,r))}class kS extends m6{constructor(e){super(),this.firestore=e}convertBytes(e){return new al(e)}convertReference(e){const r=this.convertDocumentKey(e,this.firestore._databaseId);return new qr(this.firestore,null,r)}}function Uh(t){t=ai(t,Xa);const e=ai(t.firestore,Ya),r=mv(e),n=new kS(e);return d6(t._query),e6(r,t._query).then(i=>new g6(e,n,t,i))}function jh(t,e,r){t=ai(t,qr);const n=ai(t.firestore,Ya),i=ES(t.converter,e,r);return B0(n,[mS(M0(n),"setDoc",t._key,i,t.converter!==null,r).toMutation(t._key,Ln.none())])}function SS(t,e,r,...n){t=ai(t,qr);const i=ai(t.firestore,Ya),s=M0(i);let a;return a=typeof(e=Jt(e))=="string"||e instanceof O0?c6(s,"updateDoc",t._key,e,r,n):l6(s,"updateDoc",t._key,e),B0(i,[a.toMutation(t._key,Ln.exists(!0))])}function x6(t){return B0(ai(t.firestore,Ya),[new ev(t._key,Ln.none())])}function gy(t,e){const r=ai(t.firestore,Ya),n=Ii(t),i=ES(t.converter,e);return B0(r,[mS(M0(t.firestore),"addDoc",n._key,i,t.converter!==null,{}).toMutation(n._key,Ln.exists(!1))]).then(()=>n)}function B0(t,e){return function(n,i){const s=new Yi;return n.asyncQueue.enqueueAndForget(async()=>zO(await JO(n),i,s)),s.promise}(mv(t),e)}function _6(t,e,r){const n=r.docs.get(e._key),i=new kS(t);return new TS(t,i,e._key,n,new Yl(r.hasPendingWrites,r.fromCache),e.converter)}function y6(){return new _v("serverTimestamp")}(function(e,r=!0){(function(i){pl=i})(Ga),Xs(new is("firestore",(n,{instanceIdentifier:i,options:s})=>{const a=n.getProvider("app").getImmediate(),o=new Ya(new y3(n.getProvider("auth-internal")),new k3(n.getProvider("app-check-internal")),function(c,u){if(!Object.prototype.hasOwnProperty.apply(c.options,["projectId"]))throw new Re(ce.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Xc(c.options.projectId,u)}(a,i),a);return s=Object.assign({useFetchStreams:r},s),o._setSettings(s),o},"PUBLIC").setMultipleInstances(!0)),On(N_,"4.7.3",e),On(N_,"4.7.3","esm2017")})();var w6="firebase",E6="10.14.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */On(w6,E6,"app");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const AS="firebasestorage.googleapis.com",T6="storageBucket",k6=2*60*1e3,S6=10*60*1e3;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ci extends Ai{constructor(e,r,n=0){super(Vd(e),`Firebase Storage: ${r} (${Vd(e)})`),this.status_=n,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,Ci.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return Vd(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}var Ti;(function(t){t.UNKNOWN="unknown",t.OBJECT_NOT_FOUND="object-not-found",t.BUCKET_NOT_FOUND="bucket-not-found",t.PROJECT_NOT_FOUND="project-not-found",t.QUOTA_EXCEEDED="quota-exceeded",t.UNAUTHENTICATED="unauthenticated",t.UNAUTHORIZED="unauthorized",t.UNAUTHORIZED_APP="unauthorized-app",t.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",t.INVALID_CHECKSUM="invalid-checksum",t.CANCELED="canceled",t.INVALID_EVENT_NAME="invalid-event-name",t.INVALID_URL="invalid-url",t.INVALID_DEFAULT_BUCKET="invalid-default-bucket",t.NO_DEFAULT_BUCKET="no-default-bucket",t.CANNOT_SLICE_BLOB="cannot-slice-blob",t.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",t.NO_DOWNLOAD_URL="no-download-url",t.INVALID_ARGUMENT="invalid-argument",t.INVALID_ARGUMENT_COUNT="invalid-argument-count",t.APP_DELETED="app-deleted",t.INVALID_ROOT_OPERATION="invalid-root-operation",t.INVALID_FORMAT="invalid-format",t.INTERNAL_ERROR="internal-error",t.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})(Ti||(Ti={}));function Vd(t){return"storage/"+t}function A6(){const t="An unknown error occurred, please check the error payload for server response.";return new Ci(Ti.UNKNOWN,t)}function I6(){return new Ci(Ti.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function C6(){return new Ci(Ti.CANCELED,"User canceled the upload/download.")}function R6(t){return new Ci(Ti.INVALID_URL,"Invalid URL '"+t+"'.")}function N6(t){return new Ci(Ti.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+t+"'.")}function vy(t){return new Ci(Ti.INVALID_ARGUMENT,t)}function IS(){return new Ci(Ti.APP_DELETED,"The Firebase app was deleted.")}function P6(t){return new Ci(Ti.INVALID_ROOT_OPERATION,"The operation '"+t+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qn{constructor(e,r){this.bucket=e,this.path_=r}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,r){let n;try{n=Qn.makeFromUrl(e,r)}catch{return new Qn(e,"")}if(n.path==="")return n;throw N6(e)}static makeFromUrl(e,r){let n=null;const i="([A-Za-z0-9.\\-_]+)";function s(R){R.path.charAt(R.path.length-1)==="/"&&(R.path_=R.path_.slice(0,-1))}const a="(/(.*))?$",o=new RegExp("^gs://"+i+a,"i"),l={bucket:1,path:3};function c(R){R.path_=decodeURIComponent(R.path)}const u="v[A-Za-z0-9_]+",h=r.replace(/[.]/g,"\\."),d="(/([^?#]*).*)?$",p=new RegExp(`^https?://${h}/${u}/b/${i}/o${d}`,"i"),x={bucket:1,path:3},v=r===AS?"(?:storage.googleapis.com|storage.cloud.google.com)":r,E="([^?#]*)",T=new RegExp(`^https?://${v}/${i}/${E}`,"i"),y=[{regex:o,indices:l,postModify:s},{regex:p,indices:x,postModify:c},{regex:T,indices:{bucket:1,path:2},postModify:c}];for(let R=0;R<y.length;R++){const M=y[R],j=M.regex.exec(e);if(j){const g=j[M.indices.bucket];let k=j[M.indices.path];k||(k=""),n=new Qn(g,k),M.postModify(n);break}}if(n==null)throw R6(e);return n}}class F6{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function D6(t,e,r){let n=1,i=null,s=null,a=!1,o=0;function l(){return o===2}let c=!1;function u(...E){c||(c=!0,e.apply(null,E))}function h(E){i=setTimeout(()=>{i=null,t(p,l())},E)}function d(){s&&clearTimeout(s)}function p(E,...T){if(c){d();return}if(E){d(),u.call(null,E,...T);return}if(l()||a){d(),u.call(null,E,...T);return}n<64&&(n*=2);let y;o===1?(o=2,y=0):y=(n+Math.random())*1e3,h(y)}let x=!1;function v(E){x||(x=!0,d(),!c&&(i!==null?(E||(o=2),clearTimeout(i),h(0)):E||(o=1)))}return h(0),s=setTimeout(()=>{a=!0,v(!0)},r),v}function b6(t){t(!1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function O6(t){return t!==void 0}function xy(t,e,r,n){if(n<e)throw vy(`Invalid value for '${t}'. Expected ${e} or greater.`);if(n>r)throw vy(`Invalid value for '${t}'. Expected ${r} or less.`)}function L6(t){const e=encodeURIComponent;let r="?";for(const n in t)if(t.hasOwnProperty(n)){const i=e(n)+"="+e(t[n]);r=r+i+"&"}return r=r.slice(0,-1),r}var Bh;(function(t){t[t.NO_ERROR=0]="NO_ERROR",t[t.NETWORK_ERROR=1]="NETWORK_ERROR",t[t.ABORT=2]="ABORT"})(Bh||(Bh={}));/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function M6(t,e){const r=t>=500&&t<600,i=[408,429].indexOf(t)!==-1,s=e.indexOf(t)!==-1;return r||i||s}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class V6{constructor(e,r,n,i,s,a,o,l,c,u,h,d=!0){this.url_=e,this.method_=r,this.headers_=n,this.body_=i,this.successCodes_=s,this.additionalRetryCodes_=a,this.callback_=o,this.errorCallback_=l,this.timeout_=c,this.progressCallback_=u,this.connectionFactory_=h,this.retry=d,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((p,x)=>{this.resolve_=p,this.reject_=x,this.start_()})}start_(){const e=(n,i)=>{if(i){n(!1,new vf(!1,null,!0));return}const s=this.connectionFactory_();this.pendingConnection_=s;const a=o=>{const l=o.loaded,c=o.lengthComputable?o.total:-1;this.progressCallback_!==null&&this.progressCallback_(l,c)};this.progressCallback_!==null&&s.addUploadProgressListener(a),s.send(this.url_,this.method_,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&s.removeUploadProgressListener(a),this.pendingConnection_=null;const o=s.getErrorCode()===Bh.NO_ERROR,l=s.getStatus();if(!o||M6(l,this.additionalRetryCodes_)&&this.retry){const u=s.getErrorCode()===Bh.ABORT;n(!1,new vf(!1,null,u));return}const c=this.successCodes_.indexOf(l)!==-1;n(!0,new vf(c,s))})},r=(n,i)=>{const s=this.resolve_,a=this.reject_,o=i.connection;if(i.wasSuccessCode)try{const l=this.callback_(o,o.getResponse());O6(l)?s(l):s()}catch(l){a(l)}else if(o!==null){const l=A6();l.serverResponse=o.getErrorText(),this.errorCallback_?a(this.errorCallback_(o,l)):a(l)}else if(i.canceled){const l=this.appDelete_?IS():C6();a(l)}else{const l=I6();a(l)}};this.canceled_?r(!1,new vf(!1,null,!0)):this.backoffId_=D6(e,r,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&b6(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}}class vf{constructor(e,r,n){this.wasSuccessCode=e,this.connection=r,this.canceled=!!n}}function U6(t,e){e!==null&&e.length>0&&(t.Authorization="Firebase "+e)}function j6(t,e){t["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}function B6(t,e){e&&(t["X-Firebase-GMPID"]=e)}function z6(t,e){e!==null&&(t["X-Firebase-AppCheck"]=e)}function $6(t,e,r,n,i,s,a=!0){const o=L6(t.urlParams),l=t.url+o,c=Object.assign({},t.headers);return B6(c,e),U6(c,r),j6(c,s),z6(c,n),new V6(l,t.method,c,t.body,t.successCodes,t.additionalRetryCodes,t.handler,t.errorHandler,t.timeout,t.progressCallback,i,a)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function H6(t){if(t.length===0)return null;const e=t.lastIndexOf("/");return e===-1?"":t.slice(0,e)}function W6(t){const e=t.lastIndexOf("/",t.length-2);return e===-1?t:t.slice(e+1)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zh{constructor(e,r){this._service=e,r instanceof Qn?this._location=r:this._location=Qn.makeFromUrl(r,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,r){return new zh(e,r)}get root(){const e=new Qn(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return W6(this._location.path)}get storage(){return this._service}get parent(){const e=H6(this._location.path);if(e===null)return null;const r=new Qn(this._location.bucket,e);return new zh(this._service,r)}_throwIfRoot(e){if(this._location.path==="")throw P6(e)}}function _y(t,e){const r=e==null?void 0:e[T6];return r==null?null:Qn.makeFromBucketSpec(r,t)}function G6(t,e,r,n={}){t.host=`${e}:${r}`,t._protocol="http";const{mockUserToken:i}=n;i&&(t._overrideAuthToken=typeof i=="string"?i:mT(i,t.app.options.projectId))}class K6{constructor(e,r,n,i,s){this.app=e,this._authProvider=r,this._appCheckProvider=n,this._url=i,this._firebaseVersion=s,this._bucket=null,this._host=AS,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=k6,this._maxUploadRetryTime=S6,this._requests=new Set,i!=null?this._bucket=Qn.makeFromBucketSpec(i,this._host):this._bucket=_y(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=Qn.makeFromBucketSpec(this._url,e):this._bucket=_y(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){xy("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){xy("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const r=await e.getToken();if(r!==null)return r.accessToken}return null}async _getAppCheckToken(){const e=this._appCheckProvider.getImmediate({optional:!0});return e?(await e.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new zh(this,e)}_makeRequest(e,r,n,i,s=!0){if(this._deleted)return new F6(IS());{const a=$6(e,this._appId,n,i,r,this._firebaseVersion,s);return this._requests.add(a),a.getPromise().then(()=>this._requests.delete(a),()=>this._requests.delete(a)),a}}async makeRequestWithTokens(e,r){const[n,i]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,r,n,i).getPromise()}}const yy="@firebase/storage",wy="0.13.2";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const CS="storage";function q6(t=y0(),e){t=Jt(t);const n=xu(t,CS).getImmediate({identifier:e}),i=Pg("storage");return i&&X6(n,...i),n}function X6(t,e,r,n={}){G6(t,e,r,n)}function Y6(t,{instanceIdentifier:e}){const r=t.getProvider("app").getImmediate(),n=t.getProvider("auth-internal"),i=t.getProvider("app-check-internal");return new K6(r,n,i,e,Ga)}function Q6(){Xs(new is(CS,Y6,"PUBLIC").setMultipleInstances(!0)),On(yy,wy,""),On(yy,wy,"esm2017")}Q6();/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const RS="functions";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class J6{constructor(e,r,n){this.auth=null,this.messaging=null,this.appCheck=null,this.auth=e.getImmediate({optional:!0}),this.messaging=r.getImmediate({optional:!0}),this.auth||e.get().then(i=>this.auth=i,()=>{}),this.messaging||r.get().then(i=>this.messaging=i,()=>{}),this.appCheck||n.get().then(i=>this.appCheck=i,()=>{})}async getAuthToken(){if(this.auth)try{const e=await this.auth.getToken();return e==null?void 0:e.accessToken}catch{return}}async getMessagingToken(){if(!(!this.messaging||!("Notification"in self)||Notification.permission!=="granted"))try{return await this.messaging.getToken()}catch{return}}async getAppCheckToken(e){if(this.appCheck){const r=e?await this.appCheck.getLimitedUseToken():await this.appCheck.getToken();return r.error?null:r.token}return null}async getContext(e){const r=await this.getAuthToken(),n=await this.getMessagingToken(),i=await this.getAppCheckToken(e);return{authToken:r,messagingToken:n,appCheckToken:i}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vm="us-central1";class Z6{constructor(e,r,n,i,s=vm,a){this.app=e,this.fetchImpl=a,this.emulatorOrigin=null,this.contextProvider=new J6(r,n,i),this.cancelAllRequests=new Promise(o=>{this.deleteService=()=>Promise.resolve(o())});try{const o=new URL(s);this.customDomain=o.origin+(o.pathname==="/"?"":o.pathname),this.region=vm}catch{this.customDomain=null,this.region=s}}_delete(){return this.deleteService()}_url(e){const r=this.app.options.projectId;return this.emulatorOrigin!==null?`${this.emulatorOrigin}/${r}/${this.region}/${e}`:this.customDomain!==null?`${this.customDomain}/${e}`:`https://${this.region}-${r}.cloudfunctions.net/${e}`}}function eL(t,e,r){t.emulatorOrigin=`http://${e}:${r}`}const Ey="@firebase/functions",Ty="0.11.8";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tL="auth-internal",rL="app-check-internal",nL="messaging-internal";function iL(t,e){const r=(n,{instanceIdentifier:i})=>{const s=n.getProvider("app").getImmediate(),a=n.getProvider(tL),o=n.getProvider(nL),l=n.getProvider(rL);return new Z6(s,a,o,l,i,t)};Xs(new is(RS,r,"PUBLIC").setMultipleInstances(!0)),On(Ey,Ty,e),On(Ey,Ty,"esm2017")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sL(t=y0(),e=vm){const n=xu(Jt(t),RS).getImmediate({identifier:e}),i=Pg("functions");return i&&aL(n,...i),n}function aL(t,e,r){eL(Jt(t),e,r)}iL(fetch.bind(self));const oL={apiKey:"AIzaSyAnEPcQISz9FY68mib-0StN6NQtTF3oz1c",authDomain:"xmas-movies.firebaseapp.com",projectId:"xmas-movies",storageBucket:"xmas-movies.firebasestorage.app",messagingSenderId:"721037810395",appId:"1:721037810395:web:1126b377adcc225c944afe"},z0=xT(oL),gc=g3(z0),NS=new mi;NS.setCustomParameters({prompt:"select_account"});const lL=NS,yn=n6(z0);q6(z0);sL(z0);const PS=Z.createContext(void 0),hs=()=>{const t=Z.useContext(PS);if(t===void 0)throw new Error("useAuth must be used within an AuthProvider");return t},cL=({children:t})=>{const[e,r]=Z.useState(null),[n,i]=Z.useState(null),[s,a]=Z.useState(!0),[o,l]=Z.useState(null);Z.useEffect(()=>{const d=zT(gc,async p=>{if(r(p),l(null),p)try{const x=Ii(yn,"users",p.uid),v=await Va(x);if(v.exists())await jh(x,{lastLoginAt:y6()},{merge:!0}),i(v.data());else{const E={email:p.email||"",displayName:p.displayName||"User",photoURL:p.photoURL||void 0,createdAt:new Date,lastLoginAt:new Date};await jh(x,E),i({id:p.uid,...E})}}catch(x){console.error("Error fetching user profile:",x),l("Failed to load user profile")}else i(null);a(!1)});return()=>d()},[]);const h={currentUser:e,userProfile:n,isLoading:s,error:o,signInWithGoogle:async()=>{try{l(null),a(!0);const d=new mi;await ZT(gc,d)}catch(d){console.error("Login error:",d),l(d.message||"Failed to sign in")}finally{a(!1)}},signOut:async()=>{try{await aD(gc)}catch(d){console.error("Sign out error:",d),l(d.message||"Failed to sign out")}}};return m.jsx(PS.Provider,{value:h,children:t})},uL=({snowflakeCount:t=100})=>{const e=Z.useRef(null),r=Z.useRef([]),n=Z.useRef(0);return Z.useEffect(()=>{const i=e.current;if(!i)return;const s=i.getContext("2d");if(!s)return;const a=()=>{i.width=window.innerWidth,i.height=window.innerHeight},o=()=>{r.current=[];for(let h=0;h<t;h++)r.current.push({x:Math.random()*i.width,y:Math.random()*i.height,size:Math.random()*4+1,speed:Math.random()*1+.5,opacity:Math.random()*.6+.3,wind:Math.random()*.5-.25})},l=h=>{s.beginPath(),s.arc(h.x,h.y,h.size,0,Math.PI*2),s.fillStyle=`rgba(255, 255, 255, ${h.opacity})`,s.fill()},c=h=>{h.y+=h.speed,h.x+=h.wind,h.y>i.height&&(h.y=-10,h.x=Math.random()*i.width),h.x>i.width?h.x=0:h.x<0&&(h.x=i.width)},u=()=>{s.clearRect(0,0,i.width,i.height),r.current.forEach(h=>{l(h),c(h)}),n.current=requestAnimationFrame(u)};return window.addEventListener("resize",a),a(),o(),u(),()=>{window.removeEventListener("resize",a),cancelAnimationFrame(n.current)}},[t]),m.jsx("canvas",{ref:e,className:"fixed top-0 left-0 w-full h-full pointer-events-none z-10","aria-hidden":"true"})};function fL(){const{currentUser:t}=hs(),[e,r]=Z.useState(!1),n=Ha();Z.useEffect(()=>(e?document.body.style.overflow="hidden":document.body.style.overflow="",()=>{document.body.style.overflow=""}),[e]),Z.useEffect(()=>{e&&r(!1)},[n.pathname]);const i=()=>{r(!e)};return m.jsxs("div",{className:"min-h-screen bg-gradient-to-b from-xmas-bg to-xmas-card bg-opacity-95",children:[m.jsx(uL,{snowflakeCount:150}),m.jsxs("div",{className:"navbar bg-gradient-to-r from-xmas-card via-xmas-card to-xmas-bg border-b border-xmas-gold px-2 sm:px-4 shadow-lg relative overflow-hidden",children:[m.jsx("div",{className:"absolute top-0 left-0 w-full h-1 bg-gradient-to-r from-xmas-gold via-transparent to-xmas-gold opacity-60"}),m.jsx("div",{className:"absolute -bottom-4 left-0 right-0 h-8 snow-accumulation-fast"}),m.jsxs("div",{className:"flex items-center",children:[m.jsx("button",{className:"btn btn-ghost btn-sm md:hidden relative z-10",onClick:i,"aria-label":"Toggle navigation menu",children:m.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",className:"inline-block w-5 h-5 stroke-current",children:m.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M4 6h16M4 12h16M4 18h16"})})}),m.jsxs(Qe,{to:"/",className:"hidden sm:flex items-center group",children:[m.jsxs("div",{className:"relative",children:[m.jsx("div",{className:"absolute -inset-1 bg-gradient-to-r from-xmas-gold to-xmas-line rounded-full opacity-70 group-hover:opacity-100 blur transition duration-200"}),m.jsx("div",{className:"relative flex items-center justify-center w-10 h-10 bg-xmas-card rounded-full border border-xmas-gold overflow-hidden",children:m.jsx("img",{src:"/Santa.png",alt:"Santa",className:"w-full h-full object-cover group-hover:scale-110 transition-transform duration-300"})})]}),m.jsx("div",{className:"ml-3 font-christmas text-xl sm:text-2xl bg-gradient-to-br from-xmas-gold via-xmas-snow to-xmas-gold bg-clip-text text-transparent font-bold",children:"Christmas Movies"})]}),m.jsxs(Qe,{to:"/",className:"sm:hidden flex items-center",children:[m.jsx("div",{className:"w-8 h-8 flex items-center justify-center rounded-full bg-xmas-card border border-xmas-gold overflow-hidden",children:m.jsx("img",{src:"/Santa.png",alt:"Santa",className:"w-full h-full object-cover"})}),m.jsx("span",{className:"ml-2 font-christmas text-lg text-xmas-gold",children:"Christmas Movies"})]})]}),m.jsx("div",{className:"flex-1"}),m.jsxs("div",{className:"flex items-center gap-1 sm:gap-2",children:[t&&m.jsxs(Qe,{to:"/profile",className:"btn btn-primary btn-sm hidden md:flex",children:[m.jsx("i",{className:"fas fa-user-circle mr-1"})," Profile"]}),t?m.jsxs("div",{className:"dropdown dropdown-end",children:[m.jsx("label",{tabIndex:0,className:"btn btn-ghost btn-circle avatar cursor-pointer",children:m.jsx("div",{className:"w-10 rounded-full border border-xmas-gold",children:t.photoURL?m.jsx("img",{src:t.photoURL,alt:"Profile"}):m.jsx("div",{className:"bg-xmas-card flex items-center justify-center h-full",children:m.jsx("i",{className:"fas fa-user text-xmas-gold"})})})}),m.jsxs("ul",{tabIndex:0,className:"dropdown-content menu menu-sm mt-3 z-[1] p-2 shadow bg-xmas-card rounded-box w-52 border border-xmas-gold",children:[m.jsx("li",{children:m.jsxs(Qe,{to:"/profile",className:"justify-between",children:["Profile",m.jsx("i",{className:"fas fa-user-circle"})]})}),m.jsx("li",{children:m.jsxs(Qe,{to:"/movies",children:["My Movies",m.jsx("i",{className:"fas fa-film"})]})}),m.jsx("li",{children:m.jsxs(Qe,{to:"/random",children:["Random Movie",m.jsx("i",{className:"fas fa-random"})]})}),m.jsx("li",{children:m.jsxs(Qe,{to:"/import",children:["Import Movies",m.jsx("i",{className:"fas fa-file-import"})]})})]})]}):m.jsxs(Qe,{to:"/login",className:"btn btn-primary btn-sm",children:[m.jsx("i",{className:"fas fa-sign-in-alt mr-1"})," Sign In"]})]})]}),m.jsx("div",{className:`fixed inset-0 bg-black bg-opacity-70 z-20 transition-opacity duration-300 md:hidden ${e?"opacity-100":"opacity-0 pointer-events-none"}`,onClick:i}),m.jsxs("div",{className:`fixed top-0 left-0 h-full w-72 bg-gradient-to-b from-xmas-bg to-xmas-card border-r border-xmas-gold z-30 transform transition-transform duration-300 ease-in-out md:hidden shadow-xl ${e?"translate-x-0":"-translate-x-full"}`,children:[m.jsxs("div",{className:"relative overflow-hidden",children:[m.jsx("div",{className:"absolute top-0 left-0 w-full h-1 bg-gradient-to-r from-xmas-gold via-transparent to-xmas-gold opacity-60"}),m.jsxs("div",{className:"flex justify-between items-center p-4 border-b border-xmas-gold bg-xmas-card bg-opacity-80",children:[m.jsxs("div",{className:"flex items-center",children:[m.jsx("div",{className:"w-9 h-9 flex items-center justify-center rounded-full bg-xmas-card border border-xmas-gold shadow-lg overflow-hidden",children:m.jsx("img",{src:"/Santa.png",alt:"Santa",className:"w-full h-full object-cover"})}),m.jsx("div",{className:"ml-3 font-christmas text-xl bg-gradient-to-br from-xmas-gold via-xmas-snow to-xmas-gold bg-clip-text text-transparent font-bold",children:"Christmas Movies"})]}),m.jsx("button",{className:"btn btn-ghost btn-sm text-xmas-text hover:text-xmas-line",onClick:i,"aria-label":"Close navigation menu",children:m.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:m.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})]}),m.jsx("div",{className:"overflow-y-auto h-full pb-20",children:m.jsx("div",{className:"p-4 pt-6",children:m.jsxs("div",{className:"mb-6",children:[m.jsx("h3",{className:"font-christmas text-xl text-xmas-gold mb-4 pl-2 border-l-2 border-xmas-line",children:"Navigation"}),m.jsxs("ul",{className:"space-y-3",children:[m.jsx("li",{children:m.jsx(fo,{to:"/",onClick:i,className:({isActive:s})=>s?"flex items-center p-2 pl-3 rounded-md bg-gradient-to-r from-xmas-card to-transparent border-l-2 border-xmas-gold text-xmas-gold font-medium":"flex items-center p-2 pl-3 rounded-md hover:bg-xmas-card hover:bg-opacity-50 text-xmas-text hover:text-xmas-gold transition-all duration-200",children:({isActive:s})=>m.jsxs(m.Fragment,{children:[m.jsx("i",{className:"fas fa-home mr-3 text-xmas-gold"}),m.jsx("span",{children:"Home"}),m.jsx("i",{className:`fas fa-snowflake ml-auto text-xmas-gold opacity-70 ${s?"visible":"invisible"}`})]})})}),t?m.jsxs(m.Fragment,{children:[m.jsx("li",{children:m.jsx(fo,{to:"/movies",onClick:i,className:({isActive:s})=>s?"flex items-center p-2 pl-3 rounded-md bg-gradient-to-r from-xmas-card to-transparent border-l-2 border-xmas-gold text-xmas-gold font-medium":"flex items-center p-2 pl-3 rounded-md hover:bg-xmas-card hover:bg-opacity-50 text-xmas-text hover:text-xmas-gold transition-all duration-200",children:({isActive:s})=>m.jsxs(m.Fragment,{children:[m.jsx("i",{className:"fas fa-film mr-3 text-xmas-gold"}),m.jsx("span",{children:"My Movies"}),m.jsx("i",{className:`fas fa-snowflake ml-auto text-xmas-gold opacity-70 ${s?"visible":"invisible"}`})]})})}),m.jsx("li",{children:m.jsx(fo,{to:"/random",onClick:i,className:({isActive:s})=>s?"flex items-center p-2 pl-3 rounded-md bg-gradient-to-r from-xmas-card to-transparent border-l-2 border-xmas-gold text-xmas-gold font-medium":"flex items-center p-2 pl-3 rounded-md hover:bg-xmas-card hover:bg-opacity-50 text-xmas-text hover:text-xmas-gold transition-all duration-200",children:({isActive:s})=>m.jsxs(m.Fragment,{children:[m.jsx("i",{className:"fas fa-random mr-3 text-xmas-gold"}),m.jsx("span",{children:"Random Movie"}),m.jsx("i",{className:`fas fa-snowflake ml-auto text-xmas-gold opacity-70 ${s?"visible":"invisible"}`})]})})}),m.jsx("li",{children:m.jsx(fo,{to:"/import",onClick:i,className:({isActive:s})=>s?"flex items-center p-2 pl-3 rounded-md bg-gradient-to-r from-xmas-card to-transparent border-l-2 border-xmas-gold text-xmas-gold font-medium":"flex items-center p-2 pl-3 rounded-md hover:bg-xmas-card hover:bg-opacity-50 text-xmas-text hover:text-xmas-gold transition-all duration-200",children:({isActive:s})=>m.jsxs(m.Fragment,{children:[m.jsx("i",{className:"fas fa-file-import mr-3 text-xmas-gold"}),m.jsx("span",{children:"Import Movies"}),m.jsx("i",{className:`fas fa-snowflake ml-auto text-xmas-gold opacity-70 ${s?"visible":"invisible"}`})]})})}),m.jsx("li",{children:m.jsx(fo,{to:"/profile",onClick:i,className:({isActive:s})=>s?"flex items-center p-2 pl-3 rounded-md bg-gradient-to-r from-xmas-card to-transparent border-l-2 border-xmas-gold text-xmas-gold font-medium":"flex items-center p-2 pl-3 rounded-md hover:bg-xmas-card hover:bg-opacity-50 text-xmas-text hover:text-xmas-gold transition-all duration-200",children:({isActive:s})=>m.jsxs(m.Fragment,{children:[m.jsx("i",{className:"fas fa-user-circle mr-3 text-xmas-gold"}),m.jsx("span",{children:"Profile"}),m.jsx("i",{className:`fas fa-snowflake ml-auto text-xmas-gold opacity-70 ${s?"visible":"invisible"}`})]})})})]}):m.jsx("li",{children:m.jsx(fo,{to:"/login",onClick:i,className:({isActive:s})=>s?"flex items-center p-2 pl-3 rounded-md bg-gradient-to-r from-xmas-card to-transparent border-l-2 border-xmas-gold text-xmas-gold font-medium":"flex items-center p-2 pl-3 rounded-md hover:bg-xmas-card hover:bg-opacity-50 text-xmas-text hover:text-xmas-gold transition-all duration-200",children:({isActive:s})=>m.jsxs(m.Fragment,{children:[m.jsx("i",{className:"fas fa-sign-in-alt mr-3 text-xmas-gold"}),m.jsx("span",{children:"Sign In"}),m.jsx("i",{className:`fas fa-snowflake ml-auto text-xmas-gold opacity-70 ${s?"visible":"invisible"}`})]})})})]})]})})})]}),m.jsx("main",{className:"p-4",children:m.jsx(aT,{})}),m.jsx("div",{className:"fixed bottom-0 left-0 w-full pointer-events-none",children:m.jsx("div",{className:"container mx-auto",children:m.jsxs("div",{className:"relative h-16",children:[m.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-px bg-gradient-to-r from-xmas-gold via-transparent to-xmas-gold opacity-40"}),m.jsx("div",{className:"absolute bottom-4 left-4 opacity-30",children:m.jsx("i",{className:"fas fa-tree text-4xl text-xmas-gold"})}),m.jsx("div",{className:"absolute bottom-4 right-4 opacity-30",children:m.jsx("i",{className:"fas fa-star text-4xl text-xmas-gold"})})]})})})]})}const hL=({children:t})=>{const{currentUser:e,isLoading:r}=hs();return r?m.jsx("div",{className:"flex justify-center items-center min-h-[60vh]",children:m.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-xmas-gold"})}):e?t?m.jsx(m.Fragment,{children:t}):m.jsx(aT,{}):m.jsx(yN,{to:"/login"})},dL=()=>{const{currentUser:t}=hs();return m.jsxs("div",{className:"container mx-auto px-4 py-8",children:[m.jsxs("div",{className:"text-center mb-12",children:[m.jsx("h1",{className:"font-christmas text-5xl md:text-7xl text-xmas-line mb-4",children:"Christmas Movie Database"}),m.jsx("p",{className:"text-xl md:text-2xl text-xmas-snow mb-8",children:"Track, rate, and discover your favorite Christmas movies!"}),m.jsx("div",{className:"flex flex-col md:flex-row justify-center gap-6 mb-12",children:t?m.jsxs(m.Fragment,{children:[m.jsxs(Qe,{to:"/movies",className:"btn btn-primary btn-lg text-xl px-8 py-3 rounded-md shadow-lg hover:shadow-xl transition-all duration-300 border border-xmas-gold border-opacity-30",children:[m.jsx("i",{className:"fas fa-film mr-2"})," My Movies"]}),m.jsxs(Qe,{to:"/random",className:"btn btn-primary btn-lg text-xl px-8 py-3 rounded-md shadow-lg hover:shadow-xl transition-all duration-300 border border-xmas-gold border-opacity-30",children:[m.jsx("i",{className:"fas fa-random mr-2"})," Random Movie"]})]}):m.jsxs(Qe,{to:"/login",className:"btn btn-primary btn-lg text-xl px-8 py-3 rounded-md shadow-lg hover:shadow-xl transition-all duration-300 border border-xmas-gold border-opacity-30",children:[m.jsx("i",{className:"fas fa-sign-in-alt mr-2"})," Sign In"]})})]}),m.jsx("div",{className:"w-full max-w-4xl mx-auto mb-8",children:m.jsx("div",{className:"h-px bg-gradient-to-r from-transparent via-xmas-gold to-transparent"})}),m.jsxs("div",{className:"bg-xmas-card rounded-lg shadow-xl p-6 mb-12 border border-xmas-gold border-opacity-20 snow-accumulation snow-accumulation-slow relative",children:[m.jsx("h2",{className:"font-christmas text-3xl text-xmas-line mb-6 text-center",children:"Features"}),m.jsxs("div",{className:"grid md:grid-cols-3 gap-6",children:[m.jsxs("div",{className:"bg-xmas-card bg-opacity-70 p-6 rounded-lg shadow-md border-l-2 border-xmas-line",children:[m.jsx("div",{className:"text-3xl text-xmas-gold mb-4 text-center",children:m.jsx("i",{className:"fas fa-search"})}),m.jsx("h3",{className:"font-christmas text-xl text-center mb-3",children:"Find Movies"}),m.jsx("p",{className:"text-center text-xmas-text text-opacity-80",children:"Search and discover Christmas movies using TMDB integration"})]}),m.jsxs("div",{className:"bg-xmas-card bg-opacity-70 p-6 rounded-lg shadow-md border-l-2 border-xmas-gold",children:[m.jsx("div",{className:"text-3xl text-xmas-gold mb-4 text-center",children:m.jsx("i",{className:"fas fa-star"})}),m.jsx("h3",{className:"font-christmas text-xl text-center mb-3",children:"Rate & Review"}),m.jsx("p",{className:"text-center text-xmas-text text-opacity-80",children:"Keep track of movies you've watched and rate them"})]}),m.jsxs("div",{className:"bg-xmas-card bg-opacity-70 p-6 rounded-lg shadow-md border-l-2 border-xmas-line",children:[m.jsx("div",{className:"text-3xl text-xmas-gold mb-4 text-center",children:m.jsx("i",{className:"fas fa-random"})}),m.jsx("h3",{className:"font-christmas text-xl text-center mb-3",children:"Random Picker"}),m.jsx("p",{className:"text-center text-xmas-text text-opacity-80",children:"Can't decide what to watch? Let our random movie picker help!"})]})]})]}),m.jsx("div",{className:"bg-xmas-card rounded-lg shadow-xl p-6 mb-12 border border-xmas-gold border-opacity-30 snow-accumulation snow-accumulation-fast relative",children:m.jsxs("div",{className:"mb-6 text-center",children:[m.jsxs("h2",{className:"font-christmas text-3xl md:text-4xl text-xmas-gold inline-block relative",children:[m.jsx("span",{className:"relative z-10",children:"Import Your Collection"}),m.jsx("span",{className:"absolute -bottom-2 left-0 right-0 h-1 bg-xmas-gold opacity-30 rounded-full"})]}),m.jsx("p",{className:"mt-4 mb-6",children:"Already have a list of Christmas movies? Import them from Excel or search TMDB!"}),t?m.jsxs(Qe,{to:"/import",className:"btn btn-primary",children:[m.jsx("i",{className:"fas fa-file-import mr-2"})," Import Movies"]}):m.jsxs(Qe,{to:"/login",className:"btn btn-primary",children:[m.jsx("i",{className:"fas fa-sign-in-alt mr-2"})," Sign In to Import"]})]})}),m.jsx("div",{className:"w-full max-w-4xl mx-auto mb-8",children:m.jsx("div",{className:"h-px bg-gradient-to-r from-transparent via-xmas-gold to-transparent"})}),m.jsx("footer",{className:"text-center text-xmas-mute mt-12 pb-8",children:m.jsxs("p",{children:[" ",new Date().getFullYear()," Christmas Movie Database"]})})]})},pL=()=>{const t=Wa(),{currentUser:e,isLoading:r,error:n,signInWithGoogle:i}=hs();Z.useEffect(()=>{e&&!r&&t("/movies")},[e,r,t]);const s=async()=>{try{await i()}catch(a){console.error("Login failed:",a)}};return r?m.jsx("div",{className:"flex justify-center items-center min-h-[60vh]",children:m.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-xmas-gold"})}):m.jsx("div",{className:"container mx-auto px-4 py-12",children:m.jsxs("div",{className:"max-w-md mx-auto",children:[m.jsxs("div",{className:"text-center mb-8",children:[m.jsx("h1",{className:"font-christmas text-4xl text-xmas-line mb-2",children:"Christmas Movie Database"}),m.jsx("p",{className:"text-xmas-mute",children:"Sign in to manage your Christmas movie collection"})]}),m.jsxs("div",{className:"bg-xmas-card rounded-lg shadow-lg p-6",children:[n&&m.jsx("div",{className:"bg-error bg-opacity-10 border-l-4 border-error p-4 mb-6 rounded",children:m.jsx("p",{className:"text-error",children:n})}),m.jsxs("div",{className:"text-center mb-6",children:[m.jsx("p",{className:"mb-4",children:"Sign in with your Google account to access your Christmas movie collection."}),m.jsx("p",{className:"text-sm text-xmas-mute mb-6",children:"Track, rate, and discover Christmas movies!"}),m.jsxs("button",{onClick:s,className:"btn btn-primary w-full flex items-center justify-center gap-2",children:[m.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 48 48",children:[m.jsx("path",{fill:"#FFC107",d:`M43.611,20.083H42V20H24v8h11.303c-1.649,4.657-6.08,8-11.303,8c-6.627,0-12-5.373-12-12
                  s5.373-12,12-12c3.059,0,5.842,1.154,7.961,3.039l5.657-5.657C34.046,6.053,29.268,4,24,4C12.955,4,4,12.955,4,24s8.955,20,20,20
                  s20-8.955,20-20C44,22.659,43.862,21.35,43.611,20.083z`}),m.jsx("path",{fill:"#FF3D00",d:`M6.306,14.691l6.571,4.819C14.655,15.108,18.961,12,24,12c3.059,0,5.842,1.154,7.961,3.039
                  l5.657-5.657C34.046,6.053,29.268,4,24,4C16.318,4,9.656,8.337,6.306,14.691z`}),m.jsx("path",{fill:"#4CAF50",d:`M24,44c5.166,0,9.86-1.977,13.409-5.192l-6.19-5.238C29.211,35.091,26.715,36,24,36
                  c-5.202,0-9.619-3.317-11.283-7.946l-6.522,5.025C9.505,39.556,16.227,44,24,44z`}),m.jsx("path",{fill:"#1976D2",d:`M43.611,20.083H42V20H24v8h11.303c-0.792,2.237-2.231,4.166-4.087,5.571
                  c0.001-0.001,0.002-0.001,0.003-0.002l6.19,5.238C36.971,39.205,44,34,44,24C44,22.659,43.862,21.35,43.611,20.083z`})]}),"Sign in with Google"]})]})]}),m.jsx("div",{className:"text-center mt-6",children:m.jsx("p",{className:"text-sm text-xmas-mute",children:"By signing in, you agree to our Terms of Service and Privacy Policy."})})]})})},xm=async(t,e,r)=>{const n=Ii(yn,`users/${t}/movies`,e);if((await Va(n)).exists()){const a={...r,updatedAt:new Date};r.rating===null&&(a.rating=null),r.watchedDate===null&&(a.watchedDate=null),r.review===null&&(a.review=null),await SS(n,a)}else{const a={userId:t,movieId:e,watched:r.watched||!1,favorite:r.favorite||!1,addedAt:new Date,updatedAt:new Date,...r};await jh(n,a)}const s=await Va(n);return{id:s.id,...s.data()}},mL=async(t,e)=>{const r=Ii(yn,`users/${t}/movies`,e),n=await Va(r);return n.exists()?{id:n.id,...n.data()}:null},FS=async t=>{const e=Mh(yn,`users/${t}/movies`),r=await Uh(e),n=[];return r.forEach(i=>{n.push({id:i.id,...i.data()})}),n},gL=async(t,e)=>{const r=Ii(yn,`users/${t}/movies`,e);await x6(r)},Sv=async t=>{const e=await FS(t),r={},n=[];e.forEach(s=>{r[s.movieId]=s,n.push(s.movieId)});const i=[];if(n.length>0)for(const s of n)try{const a=await Va(Ii(yn,"movies",s));a.exists()&&i.push({id:a.id,...a.data()})}catch(a){console.error(`Error fetching movie ${s}:`,a)}return{userMovies:r,movies:i}},vL=()=>{const{currentUser:t}=hs(),[e,r]=Z.useState([]),[n,i]=Z.useState({}),[s,a]=Z.useState(!0),[o,l]=Z.useState(null),[c,u]=Z.useState("all"),[h,d]=Z.useState({option:"title",direction:"asc"}),[p,x]=Z.useState(""),[v,E]=Z.useState("all");Z.useEffect(()=>{(async()=>{if(t)try{a(!0);const{userMovies:M,movies:j}=await Sv(t.uid);i(M),r(j)}catch(M){console.error("Error fetching movies:",M),l("Failed to load movies")}finally{a(!1)}})()},[t]);const T=R=>{d(M=>M.option===R?{option:R,direction:M.direction==="asc"?"desc":"asc"}:{option:R,direction:"asc"})},w=Z.useCallback(R=>{if(!p.trim())return!0;const M=p.toLowerCase().trim(),j=n[R.id];switch(v){case"title":return R.title.toLowerCase().includes(M)||R.originalTitle&&R.originalTitle.toLowerCase().includes(M);case"year":return R.releaseDate&&R.releaseDate.substring(0,4).includes(M);case"all":default:return R.title.toLowerCase().includes(M)||R.originalTitle&&R.originalTitle.toLowerCase().includes(M)||R.releaseDate&&R.releaseDate.substring(0,4).includes(M)||R.overview&&R.overview.toLowerCase().includes(M)||R.genres&&R.genres.some(g=>g.toLowerCase().includes(M))||R.directors&&R.directors.some(g=>g.toLowerCase().includes(M))||R.cast&&R.cast.some(g=>g.toLowerCase().includes(M))||j&&j.review&&j.review.toLowerCase().includes(M)}},[p,v,n]),y=e.filter(R=>{const M=n[R.id];let j=!0;switch(c){case"watched":j=M&&M.watched;break;case"unwatched":j=!M||!M.watched;break;case"favorites":j=M&&M.favorite;break}return j&&w(R)}).sort((R,M)=>{const j=n[R.id],g=n[M.id],k=h.direction==="asc"?1:-1;switch(h.option){case"title":return R.title.localeCompare(M.title)*k;case"year":const S=R.releaseDate?parseInt(R.releaseDate.substring(0,4)):0,C=M.releaseDate?parseInt(M.releaseDate.substring(0,4)):0;return(S-C)*k;case"rating":const F=(j==null?void 0:j.rating)||0,P=(g==null?void 0:g.rating)||0;return(F-P)*k;case"watched":const b=j!=null&&j.watched?1:0,ve=g!=null&&g.watched?1:0;return(b-ve)*k;case"added":const he=j!=null&&j.addedAt?j.addedAt.getTime():0,Se=g!=null&&g.addedAt?g.addedAt.getTime():0;return(he-Se)*k;default:return 0}});return s?m.jsx("div",{className:"flex justify-center items-center min-h-[60vh]",children:m.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-xmas-gold"})}):m.jsxs("div",{className:"container mx-auto px-4 py-8",children:[m.jsxs("div",{className:"flex justify-between items-center mb-8",children:[m.jsx("h1",{className:"font-christmas text-3xl md:text-4xl text-xmas-line",children:"My Christmas Movies"}),m.jsxs("div",{className:"flex gap-2",children:[m.jsxs(Qe,{to:"/random",className:"btn btn-primary",children:[m.jsx("i",{className:"fas fa-random mr-2"})," Random Movie"]}),m.jsxs(Qe,{to:"/import",className:"btn btn-primary",children:[m.jsx("i",{className:"fas fa-file-import mr-2"})," Import Movies"]})]})]}),o&&m.jsxs("div",{className:"alert alert-error mb-6",children:[m.jsx("i",{className:"fas fa-exclamation-circle mr-2"}),m.jsx("span",{children:o})]}),m.jsxs("div",{className:"flex flex-col md:flex-row gap-3 mb-4",children:[m.jsxs("div",{className:"relative flex-grow",children:[m.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:m.jsx("i",{className:"fas fa-search text-gray-400"})}),m.jsx("input",{type:"text",className:"input input-bordered w-full pl-10 pr-16",placeholder:"Search movies...",value:p,onChange:R=>x(R.target.value)}),p&&m.jsx("button",{className:"absolute inset-y-0 right-0 pr-3 flex items-center",onClick:()=>x(""),children:m.jsx("i",{className:"fas fa-times text-gray-400 hover:text-gray-600"})})]}),m.jsxs("select",{className:"select select-bordered w-full md:w-48",value:v,onChange:R=>E(R.target.value),children:[m.jsx("option",{value:"all",children:"All Fields"}),m.jsx("option",{value:"title",children:"Title Only"}),m.jsx("option",{value:"year",children:"Year Only"})]})]}),m.jsxs("div",{className:"tabs tabs-boxed mb-4",children:[m.jsx("button",{className:`tab ${c==="all"?"tab-active":""}`,onClick:()=>u("all"),children:"All Movies"}),m.jsx("button",{className:`tab ${c==="watched"?"tab-active":""}`,onClick:()=>u("watched"),children:"Watched"}),m.jsx("button",{className:`tab ${c==="unwatched"?"tab-active":""}`,onClick:()=>u("unwatched"),children:"Unwatched"}),m.jsx("button",{className:`tab ${c==="favorites"?"tab-active":""}`,onClick:()=>u("favorites"),children:"Favorites"})]}),m.jsxs("div",{className:"flex flex-wrap items-center gap-2 mb-6 bg-xmas-card bg-opacity-50 p-3 rounded-lg",children:[m.jsx("span",{className:"text-sm font-medium mr-2",children:"Sort by:"}),m.jsxs("div",{className:"flex flex-wrap gap-2",children:[m.jsxs("button",{className:`btn btn-xs ${h.option==="title"?"btn-primary":"btn-ghost"}`,onClick:()=>T("title"),children:["Title ",h.option==="title"&&m.jsx("i",{className:`fas fa-sort-${h.direction==="asc"?"up":"down"} ml-1`})]}),m.jsxs("button",{className:`btn btn-xs ${h.option==="year"?"btn-primary":"btn-ghost"}`,onClick:()=>T("year"),children:["Year ",h.option==="year"&&m.jsx("i",{className:`fas fa-sort-${h.direction==="asc"?"up":"down"} ml-1`})]}),m.jsxs("button",{className:`btn btn-xs ${h.option==="rating"?"btn-primary":"btn-ghost"}`,onClick:()=>T("rating"),children:["Rating ",h.option==="rating"&&m.jsx("i",{className:`fas fa-sort-${h.direction==="asc"?"up":"down"} ml-1`})]}),m.jsxs("button",{className:`btn btn-xs ${h.option==="watched"?"btn-primary":"btn-ghost"}`,onClick:()=>T("watched"),children:["Watched Status ",h.option==="watched"&&m.jsx("i",{className:`fas fa-sort-${h.direction==="asc"?"up":"down"} ml-1`})]}),m.jsxs("button",{className:`btn btn-xs ${h.option==="added"?"btn-primary":"btn-ghost"}`,onClick:()=>T("added"),children:["Date Added ",h.option==="added"&&m.jsx("i",{className:`fas fa-sort-${h.direction==="asc"?"up":"down"} ml-1`})]})]})]}),m.jsxs("div",{className:"flex justify-between items-center mb-4",children:[m.jsxs("div",{className:"text-sm",children:[m.jsx("span",{className:"font-medium",children:y.length})," ",y.length===1?"movie":"movies"," found",p&&m.jsxs("span",{className:"ml-2 text-xmas-mute",children:["for search: ",m.jsxs("span",{className:"font-medium",children:['"',p,'"']})]})]}),h.option&&m.jsxs("div",{className:"text-sm text-xmas-mute",children:["Sorted by ",m.jsx("span",{className:"font-medium",children:h.option})," (",h.direction==="asc"?"ascending":"descending",")"]})]}),y.length===0?m.jsxs("div",{className:"bg-xmas-card p-8 rounded-lg text-center",children:[m.jsx("h3",{className:"text-xl mb-4",children:"No movies found"}),m.jsx("p",{className:"mb-4",children:c==="all"?"You haven't added any Christmas movies yet.":`You don't have any ${c} Christmas movies.`}),m.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 justify-center",children:[m.jsxs(Qe,{to:"/import",className:"btn btn-primary",children:[m.jsx("i",{className:"fas fa-file-import mr-2"})," Import Movies"]}),e.length>0&&m.jsxs(Qe,{to:"/random",className:"btn btn-primary",children:[m.jsx("i",{className:"fas fa-random mr-2"})," Random Movie"]})]})]}):m.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-6",children:y.map(R=>{var j;const M=n[R.id];return m.jsx(Qe,{to:`/movies/${R.id}`,className:"block transition-transform hover:scale-[1.02] hover:shadow-2xl",children:m.jsxs("div",{className:"card bg-xmas-card shadow-xl h-full",children:[m.jsxs("figure",{className:"relative",children:[R.posterUrl?m.jsx("img",{src:R.posterUrl,alt:R.title,className:"w-full object-contain",style:{aspectRatio:"2/3"}}):m.jsx("div",{className:"w-full flex items-center justify-center bg-gray-800",style:{aspectRatio:"2/3"},children:m.jsx("i",{className:"fas fa-film text-4xl text-gray-500"})}),M&&M.watched&&m.jsx("div",{className:"absolute top-2 left-2 badge badge-success",children:"Watched"}),M&&M.favorite&&m.jsx("div",{className:"absolute top-2 right-2 text-yellow-400",children:m.jsx("i",{className:"fas fa-star"})})]}),m.jsxs("div",{className:"card-body",children:[m.jsx("h2",{className:"card-title font-christmas",children:R.title}),m.jsx("p",{className:"text-sm text-gray-400",children:(j=R.releaseDate)==null?void 0:j.substring(0,4)}),M&&M.rating&&m.jsxs("div",{className:"flex items-center mt-2",children:[m.jsx("span",{className:"text-yellow-400 mr-1",children:m.jsx("i",{className:"fas fa-star"})}),m.jsxs("span",{children:[M.rating,"/10"]})]}),m.jsx("div",{className:"card-actions justify-end mt-4",children:m.jsx("span",{className:"btn btn-primary btn-sm",children:"View Details"})})]})]})},R.id)})})]})},xL=()=>{const{movieId:t}=aN(),e=Wa(),{currentUser:r}=hs(),[n,i]=Z.useState(null),[s,a]=Z.useState(null),[o,l]=Z.useState(!0),[c,u]=Z.useState(null),[h,d]=Z.useState(!1),[p,x]=Z.useState(!1),[v,E]=Z.useState(""),[T,w]=Z.useState(null),[y,R]=Z.useState(""),[M,j]=Z.useState(!1);Z.useEffect(()=>{(async()=>{if(!(!r||!t))try{l(!0);const C=await Va(Ii(yn,"movies",t));if(!C.exists()){u("Movie not found"),l(!1);return}const F={id:C.id,...C.data()};i(F);const P=await mL(r.uid,t);if(P){a(P),x(P.watched);let b="";if(P.watchedDate)try{if(P.watchedDate instanceof Date)b=P.watchedDate.toISOString().split("T")[0];else{const ve=P.watchedDate;if(typeof ve=="object"&&ve!==null&&"seconds"in ve){const he=ve;b=new Date(he.seconds*1e3).toISOString().split("T")[0]}else{const he=new Date(P.watchedDate);isNaN(he.getTime())||(b=he.toISOString().split("T")[0])}}}catch(ve){console.error("Error parsing watchedDate:",ve)}E(b),w(P.rating||null),R(P.review||""),j(P.favorite)}}catch(C){console.error("Error fetching movie data:",C),u("Failed to load movie data")}finally{l(!1)}})()},[r,t]);const g=async()=>{if(!(!r||!t||!n))try{d(!0);const S={userId:r.uid,movieId:t,watched:p,favorite:M,updatedAt:new Date};if(p&&v)try{S.watchedDate=new Date(v),isNaN(S.watchedDate.getTime())&&delete S.watchedDate}catch(F){console.error("Error parsing watchedDate for save:",F),delete S.watchedDate}else p||(S.watchedDate=null);S.rating=T,S.review=y||null;const C=await xm(r.uid,t,S);a(C)}catch(S){console.error("Error saving movie data:",S),u("Failed to save movie data")}finally{d(!1)}},k=async()=>{if(!(!r||!t||!window.confirm("Are you sure you want to remove this movie from your collection?")))try{d(!0),await gL(r.uid,t),e("/movies")}catch(S){console.error("Error deleting movie:",S),u("Failed to delete movie"),d(!1)}};return o?m.jsx("div",{className:"flex justify-center items-center min-h-[60vh]",children:m.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-xmas-gold"})}):n?m.jsxs("div",{className:"container mx-auto px-4 py-8",children:[m.jsx("div",{className:"mb-4",children:m.jsxs(Qe,{to:"/movies",className:"btn btn-ghost",children:[m.jsx("i",{className:"fas fa-arrow-left mr-2"})," Back to Movies"]})}),c&&m.jsxs("div",{className:"alert alert-error mb-6",children:[m.jsx("i",{className:"fas fa-exclamation-circle mr-2"}),m.jsx("span",{children:c})]}),m.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-8",children:[m.jsxs("div",{className:"md:col-span-1",children:[m.jsx("div",{className:"rounded-lg overflow-hidden shadow-xl",children:n.posterUrl?m.jsx("img",{src:n.posterUrl,alt:n.title,className:"w-full object-contain",style:{aspectRatio:"2/3"}}):m.jsx("div",{className:"w-full flex items-center justify-center bg-gray-800",style:{aspectRatio:"2/3"},children:m.jsx("i",{className:"fas fa-film text-6xl text-gray-500"})})}),m.jsxs("div",{className:"mt-4 flex flex-col gap-2",children:[m.jsxs("button",{className:`btn ${M?"btn-warning":"btn-outline"} w-full`,onClick:()=>j(!M),children:[m.jsx("i",{className:`fas fa-star mr-2 ${M?"text-white":""}`}),M?"Favorited":"Add to Favorites"]}),m.jsxs("button",{className:`btn ${p?"btn-success":"btn-outline"} w-full`,onClick:()=>x(!p),children:[m.jsx("i",{className:`fas fa-check mr-2 ${p?"text-white":""}`}),p?"Watched":"Mark as Watched"]}),m.jsxs("button",{className:"btn btn-error btn-outline w-full",onClick:k,disabled:h,children:[m.jsx("i",{className:"fas fa-trash mr-2"}),"Remove from Collection"]})]})]}),m.jsxs("div",{className:"md:col-span-2",children:[m.jsx("h1",{className:"font-christmas text-3xl md:text-4xl text-xmas-line mb-2",children:n.title}),n.releaseDate&&m.jsx("p",{className:"text-lg text-gray-400 mb-4",children:new Date(n.releaseDate).getFullYear()}),n.genres&&n.genres.length>0&&m.jsx("div",{className:"flex flex-wrap gap-2 mb-4",children:n.genres.map((S,C)=>m.jsx("span",{className:"badge badge-outline",children:S},C))}),n.runtime&&m.jsxs("p",{className:"mb-4",children:[m.jsx("i",{className:"fas fa-clock mr-2 text-xmas-gold"}),Math.floor(n.runtime/60),"h ",n.runtime%60,"m"]}),n.overview&&m.jsxs("div",{className:"mb-6",children:[m.jsx("h2",{className:"text-xl font-bold mb-2",children:"Overview"}),m.jsx("p",{className:"text-gray-300",children:n.overview})]}),n.directors&&n.directors.length>0&&m.jsxs("div",{className:"mb-4",children:[m.jsxs("h2",{className:"text-xl font-bold mb-2",children:["Director",n.directors.length>1?"s":""]}),m.jsx("p",{children:n.directors.join(", ")})]}),n.cast&&n.cast.length>0&&m.jsxs("div",{className:"mb-6",children:[m.jsx("h2",{className:"text-xl font-bold mb-2",children:"Cast"}),m.jsx("p",{children:n.cast.slice(0,10).join(", ")})]}),m.jsx("div",{className:"divider"}),m.jsx("h2",{className:"text-2xl font-christmas text-xmas-gold mb-4",children:"Your Rating & Review"}),p&&m.jsxs("div",{className:"form-control mb-4",children:[m.jsx("label",{className:"label",children:m.jsx("span",{className:"label-text",children:"Date Watched"})}),m.jsx("input",{type:"date",className:"input input-bordered",value:v,onChange:S=>E(S.target.value)})]}),m.jsxs("div",{className:"form-control mb-4",children:[m.jsx("label",{className:"label",children:m.jsx("span",{className:"label-text",children:"Your Rating"})}),m.jsx("div",{className:"rating rating-lg",children:[1,2,3,4,5,6,7,8,9,10].map(S=>m.jsx("input",{type:"radio",name:"rating",className:`mask mask-star-2 ${S<=5?"bg-orange-400":"bg-yellow-400"}`,checked:T===S,onChange:()=>w(S)},S))}),T&&m.jsx("div",{className:"mt-2",children:m.jsx("button",{className:"btn btn-xs btn-ghost",onClick:()=>w(null),children:"Clear Rating"})})]}),m.jsxs("div",{className:"form-control mb-6",children:[m.jsx("label",{className:"label",children:m.jsx("span",{className:"label-text",children:"Your Review"})}),m.jsx("textarea",{className:"textarea textarea-bordered h-32",placeholder:"Write your thoughts about this movie...",value:y,onChange:S=>R(S.target.value)})]}),m.jsx("div",{className:"flex justify-end",children:m.jsx("button",{className:"btn btn-primary",onClick:g,disabled:h,children:h?m.jsxs(m.Fragment,{children:[m.jsx("span",{className:"loading loading-spinner loading-sm mr-2"}),"Saving..."]}):m.jsxs(m.Fragment,{children:[m.jsx("i",{className:"fas fa-save mr-2"}),"Save Changes"]})})})]})]})]}):m.jsxs("div",{className:"container mx-auto px-4 py-8",children:[m.jsxs("div",{className:"alert alert-error",children:[m.jsx("i",{className:"fas fa-exclamation-circle mr-2"}),m.jsx("span",{children:"Movie not found"})]}),m.jsx("div",{className:"mt-4",children:m.jsx(Qe,{to:"/movies",className:"btn btn-primary",children:"Back to Movies"})})]})},DS="https://api.themoviedb.org/3",_L="https://image.tmdb.org/t/p/w500",yL="https://image.tmdb.org/t/p/original",ky=async(t,e)=>{try{const r=await fetch(`${DS}/search/movie?api_key=${e}&query=${encodeURIComponent(t)}&include_adult=false`);if(!r.ok)throw new Error(`TMDB API error: ${r.status}`);return await r.json()}catch(r){throw console.error("Error searching TMDB:",r),r}},Sy=async(t,e)=>{try{const r=await fetch(`${DS}/movie/${t}?api_key=${e}&append_to_response=credits`);if(!r.ok)throw new Error(`TMDB API error: ${r.status}`);return await r.json()}catch(r){throw console.error("Error fetching movie details:",r),r}},Ay=t=>{var e,r,n;return{tmdbId:t.id,title:t.title,originalTitle:t.original_title,releaseDate:t.release_date,posterUrl:t.poster_path?`${_L}${t.poster_path}`:void 0,backdropUrl:t.backdrop_path?`${yL}${t.backdrop_path}`:void 0,overview:t.overview,runtime:t.runtime,genres:((e=t.genres)==null?void 0:e.map(i=>i.name))||[],directors:((r=t.credits)==null?void 0:r.crew.filter(i=>i.job==="Director").map(i=>i.name))||[],cast:((n=t.credits)==null?void 0:n.cast.slice(0,10).map(i=>i.name))||[],isChristmas:!0}};/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var bS=1252,wL=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],Av={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},Iv=function(t){wL.indexOf(t)!=-1&&(bS=Av[0]=t)};function EL(){Iv(1252)}var Jn=function(t){Iv(t)};function OS(){Jn(1200),EL()}function Iy(t){for(var e=[],r=0,n=t.length;r<n;++r)e[r]=t.charCodeAt(r);return e}function TL(t){for(var e=[],r=0;r<t.length>>1;++r)e[r]=String.fromCharCode(t.charCodeAt(2*r)+(t.charCodeAt(2*r+1)<<8));return e.join("")}function LS(t){for(var e=[],r=0;r<t.length>>1;++r)e[r]=String.fromCharCode(t.charCodeAt(2*r+1)+(t.charCodeAt(2*r)<<8));return e.join("")}var Ql=function(t){var e=t.charCodeAt(0),r=t.charCodeAt(1);return e==255&&r==254?TL(t.slice(2)):e==254&&r==255?LS(t.slice(2)):e==65279?t.slice(1):t},xf=function(e){return String.fromCharCode(e)},Cy=function(e){return String.fromCharCode(e)},tu,Ds="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function Ry(t){for(var e="",r=0,n=0,i=0,s=0,a=0,o=0,l=0,c=0;c<t.length;)r=t.charCodeAt(c++),s=r>>2,n=t.charCodeAt(c++),a=(r&3)<<4|n>>4,i=t.charCodeAt(c++),o=(n&15)<<2|i>>6,l=i&63,isNaN(n)?o=l=64:isNaN(i)&&(l=64),e+=Ds.charAt(s)+Ds.charAt(a)+Ds.charAt(o)+Ds.charAt(l);return e}function En(t){var e="",r=0,n=0,i=0,s=0,a=0,o=0,l=0;t=t.replace(/[^\w\+\/\=]/g,"");for(var c=0;c<t.length;)s=Ds.indexOf(t.charAt(c++)),a=Ds.indexOf(t.charAt(c++)),r=s<<2|a>>4,e+=String.fromCharCode(r),o=Ds.indexOf(t.charAt(c++)),n=(a&15)<<4|o>>2,o!==64&&(e+=String.fromCharCode(n)),l=Ds.indexOf(t.charAt(c++)),i=(o&3)<<6|l,l!==64&&(e+=String.fromCharCode(i));return e}var Je=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),Qa=function(){if(typeof Buffer<"u"){var t=!Buffer.from;if(!t)try{Buffer.from("foo","utf8")}catch{t=!0}return t?function(e,r){return r?new Buffer(e,r):new Buffer(e)}:Buffer.from.bind(Buffer)}return function(){}}();function Zs(t){return Je?Buffer.alloc?Buffer.alloc(t):new Buffer(t):typeof Uint8Array<"u"?new Uint8Array(t):new Array(t)}function Ny(t){return Je?Buffer.allocUnsafe?Buffer.allocUnsafe(t):new Buffer(t):typeof Uint8Array<"u"?new Uint8Array(t):new Array(t)}var Yn=function(e){return Je?Qa(e,"binary"):e.split("").map(function(r){return r.charCodeAt(0)&255})};function Ja(t){if(Array.isArray(t))return t.map(function(n){return String.fromCharCode(n)}).join("");for(var e=[],r=0;r<t.length;++r)e[r]=String.fromCharCode(t[r]);return e.join("")}function Cv(t){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(t instanceof ArrayBuffer)return Cv(new Uint8Array(t));for(var e=new Array(t.length),r=0;r<t.length;++r)e[r]=t[r];return e}var Cs=Je?function(t){return Buffer.concat(t.map(function(e){return Buffer.isBuffer(e)?e:Qa(e)}))}:function(t){if(typeof Uint8Array<"u"){var e=0,r=0;for(e=0;e<t.length;++e)r+=t[e].length;var n=new Uint8Array(r),i=0;for(e=0,r=0;e<t.length;r+=i,++e)if(i=t[e].length,t[e]instanceof Uint8Array)n.set(t[e],r);else{if(typeof t[e]=="string")throw"wtf";n.set(new Uint8Array(t[e]),r)}return n}return[].concat.apply([],t.map(function(s){return Array.isArray(s)?s:[].slice.call(s)}))};function kL(t){for(var e=[],r=0,n=t.length+250,i=Zs(t.length+255),s=0;s<t.length;++s){var a=t.charCodeAt(s);if(a<128)i[r++]=a;else if(a<2048)i[r++]=192|a>>6&31,i[r++]=128|a&63;else if(a>=55296&&a<57344){a=(a&1023)+64;var o=t.charCodeAt(++s)&1023;i[r++]=240|a>>8&7,i[r++]=128|a>>2&63,i[r++]=128|o>>6&15|(a&3)<<4,i[r++]=128|o&63}else i[r++]=224|a>>12&15,i[r++]=128|a>>6&63,i[r++]=128|a&63;r>n&&(e.push(i.slice(0,r)),r=0,i=Zs(65535),n=65530)}return e.push(i.slice(0,r)),Cs(e)}var Xr=/\u0000/g,Jl=/[\u0001-\u0006]/g;function Bo(t){for(var e="",r=t.length-1;r>=0;)e+=t.charAt(r--);return e}function Zn(t,e){var r=""+t;return r.length>=e?r:Ut("0",e-r.length)+r}function Rv(t,e){var r=""+t;return r.length>=e?r:Ut(" ",e-r.length)+r}function $h(t,e){var r=""+t;return r.length>=e?r:r+Ut(" ",e-r.length)}function SL(t,e){var r=""+Math.round(t);return r.length>=e?r:Ut("0",e-r.length)+r}function AL(t,e){var r=""+t;return r.length>=e?r:Ut("0",e-r.length)+r}var Py=Math.pow(2,32);function ho(t,e){if(t>Py||t<-Py)return SL(t,e);var r=Math.round(t);return AL(r,e)}function Hh(t,e){return e=e||0,t.length>=7+e&&(t.charCodeAt(e)|32)===103&&(t.charCodeAt(e+1)|32)===101&&(t.charCodeAt(e+2)|32)===110&&(t.charCodeAt(e+3)|32)===101&&(t.charCodeAt(e+4)|32)===114&&(t.charCodeAt(e+5)|32)===97&&(t.charCodeAt(e+6)|32)===108}var Fy=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],Ud=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function IL(t){return t||(t={}),t[0]="General",t[1]="0",t[2]="0.00",t[3]="#,##0",t[4]="#,##0.00",t[9]="0%",t[10]="0.00%",t[11]="0.00E+00",t[12]="# ?/?",t[13]="# ??/??",t[14]="m/d/yy",t[15]="d-mmm-yy",t[16]="d-mmm",t[17]="mmm-yy",t[18]="h:mm AM/PM",t[19]="h:mm:ss AM/PM",t[20]="h:mm",t[21]="h:mm:ss",t[22]="m/d/yy h:mm",t[37]="#,##0 ;(#,##0)",t[38]="#,##0 ;[Red](#,##0)",t[39]="#,##0.00;(#,##0.00)",t[40]="#,##0.00;[Red](#,##0.00)",t[45]="mm:ss",t[46]="[h]:mm:ss",t[47]="mmss.0",t[48]="##0.0E+0",t[49]="@",t[56]='"/ "hh""mm""ss" "',t}var ze={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},Dy={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},CL={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function Wh(t,e,r){for(var n=t<0?-1:1,i=t*n,s=0,a=1,o=0,l=1,c=0,u=0,h=Math.floor(i);c<e&&(h=Math.floor(i),o=h*a+s,u=h*c+l,!(i-h<5e-8));)i=1/(i-h),s=a,a=o,l=c,c=u;if(u>e&&(c>e?(u=l,o=s):(u=c,o=a)),!r)return[0,n*o,u];var d=Math.floor(n*o/u);return[d,n*o-d*u,u]}function wa(t,e,r){if(t>2958465||t<0)return null;var n=t|0,i=Math.floor(86400*(t-n)),s=0,a=[],o={D:n,T:i,u:86400*(t-n)-i,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(o.u)<1e-6&&(o.u=0),e&&e.date1904&&(n+=1462),o.u>.9999&&(o.u=0,++i==86400&&(o.T=i=0,++n,++o.D)),n===60)a=r?[1317,10,29]:[1900,2,29],s=3;else if(n===0)a=r?[1317,8,29]:[1900,1,0],s=6;else{n>60&&--n;var l=new Date(1900,0,1);l.setDate(l.getDate()+n-1),a=[l.getFullYear(),l.getMonth()+1,l.getDate()],s=l.getDay(),n<60&&(s=(s+6)%7),r&&(s=bL(l,a))}return o.y=a[0],o.m=a[1],o.d=a[2],o.S=i%60,i=Math.floor(i/60),o.M=i%60,i=Math.floor(i/60),o.H=i,o.q=s,o}var MS=new Date(1899,11,31,0,0,0),RL=MS.getTime(),NL=new Date(1900,2,1,0,0,0);function VS(t,e){var r=t.getTime();return e?r-=1461*24*60*60*1e3:t>=NL&&(r+=24*60*60*1e3),(r-(RL+(t.getTimezoneOffset()-MS.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function Nv(t){return t.indexOf(".")==-1?t:t.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function PL(t){return t.indexOf("E")==-1?t:t.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function FL(t){var e=t<0?12:11,r=Nv(t.toFixed(12));return r.length<=e||(r=t.toPrecision(10),r.length<=e)?r:t.toExponential(5)}function DL(t){var e=Nv(t.toFixed(11));return e.length>(t<0?12:11)||e==="0"||e==="-0"?t.toPrecision(6):e}function ru(t){var e=Math.floor(Math.log(Math.abs(t))*Math.LOG10E),r;return e>=-4&&e<=-1?r=t.toPrecision(10+e):Math.abs(e)<=9?r=FL(t):e===10?r=t.toFixed(10).substr(0,12):r=DL(t),Nv(PL(r.toUpperCase()))}function Ua(t,e){switch(typeof t){case"string":return t;case"boolean":return t?"TRUE":"FALSE";case"number":return(t|0)===t?t.toString(10):ru(t);case"undefined":return"";case"object":if(t==null)return"";if(t instanceof Date)return Un(14,VS(t,e&&e.date1904),e)}throw new Error("unsupported value in General format: "+t)}function bL(t,e){e[0]-=581;var r=t.getDay();return t<60&&(r=(r+6)%7),r}function OL(t,e,r,n){var i="",s=0,a=0,o=r.y,l,c=0;switch(t){case 98:o=r.y+543;case 121:switch(e.length){case 1:case 2:l=o%100,c=2;break;default:l=o%1e4,c=4;break}break;case 109:switch(e.length){case 1:case 2:l=r.m,c=e.length;break;case 3:return Ud[r.m-1][1];case 5:return Ud[r.m-1][0];default:return Ud[r.m-1][2]}break;case 100:switch(e.length){case 1:case 2:l=r.d,c=e.length;break;case 3:return Fy[r.q][0];default:return Fy[r.q][1]}break;case 104:switch(e.length){case 1:case 2:l=1+(r.H+11)%12,c=e.length;break;default:throw"bad hour format: "+e}break;case 72:switch(e.length){case 1:case 2:l=r.H,c=e.length;break;default:throw"bad hour format: "+e}break;case 77:switch(e.length){case 1:case 2:l=r.M,c=e.length;break;default:throw"bad minute format: "+e}break;case 115:if(e!="s"&&e!="ss"&&e!=".0"&&e!=".00"&&e!=".000")throw"bad second format: "+e;return r.u===0&&(e=="s"||e=="ss")?Zn(r.S,e.length):(n>=2?a=n===3?1e3:100:a=n===1?10:1,s=Math.round(a*(r.S+r.u)),s>=60*a&&(s=0),e==="s"?s===0?"0":""+s/a:(i=Zn(s,2+n),e==="ss"?i.substr(0,2):"."+i.substr(2,e.length-1)));case 90:switch(e){case"[h]":case"[hh]":l=r.D*24+r.H;break;case"[m]":case"[mm]":l=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":l=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+e}c=e.length===3?1:2;break;case 101:l=o,c=1;break}var u=c>0?Zn(l,c):"";return u}function bs(t){var e=3;if(t.length<=e)return t;for(var r=t.length%e,n=t.substr(0,r);r!=t.length;r+=e)n+=(n.length>0?",":"")+t.substr(r,e);return n}var US=/%/g;function LL(t,e,r){var n=e.replace(US,""),i=e.length-n.length;return Qi(t,n,r*Math.pow(10,2*i))+Ut("%",i)}function ML(t,e,r){for(var n=e.length-1;e.charCodeAt(n-1)===44;)--n;return Qi(t,e.substr(0,n),r/Math.pow(10,3*(e.length-n)))}function jS(t,e){var r,n=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+jS(t,-e);var i=t.indexOf(".");i===-1&&(i=t.indexOf("E"));var s=Math.floor(Math.log(e)*Math.LOG10E)%i;if(s<0&&(s+=i),r=(e/Math.pow(10,s)).toPrecision(n+1+(i+s)%i),r.indexOf("e")===-1){var a=Math.floor(Math.log(e)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(a-r.length+s):r+="E+"+(a-s);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,i)+"."+r.substr(2+i),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,l,c,u){return l+c+u.substr(0,(i+s)%i)+"."+u.substr(s)+"E"})}else r=e.toExponential(n);return t.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),t.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var BS=/# (\?+)( ?)\/( ?)(\d+)/;function VL(t,e,r){var n=parseInt(t[4],10),i=Math.round(e*n),s=Math.floor(i/n),a=i-s*n,o=n;return r+(s===0?"":""+s)+" "+(a===0?Ut(" ",t[1].length+1+t[4].length):Rv(a,t[1].length)+t[2]+"/"+t[3]+Zn(o,t[4].length))}function UL(t,e,r){return r+(e===0?"":""+e)+Ut(" ",t[1].length+2+t[4].length)}var zS=/^#*0*\.([0#]+)/,$S=/\).*[0#]/,HS=/\(###\) ###\\?-####/;function Hr(t){for(var e="",r,n=0;n!=t.length;++n)switch(r=t.charCodeAt(n)){case 35:break;case 63:e+=" ";break;case 48:e+="0";break;default:e+=String.fromCharCode(r)}return e}function by(t,e){var r=Math.pow(10,e);return""+Math.round(t*r)/r}function Oy(t,e){var r=t-Math.floor(t),n=Math.pow(10,e);return e<(""+Math.round(r*n)).length?0:Math.round(r*n)}function jL(t,e){return e<(""+Math.round((t-Math.floor(t))*Math.pow(10,e))).length?1:0}function BL(t){return t<2147483647&&t>-2147483648?""+(t>=0?t|0:t-1|0):""+Math.floor(t)}function Rn(t,e,r){if(t.charCodeAt(0)===40&&!e.match($S)){var n=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Rn("n",n,r):"("+Rn("n",n,-r)+")"}if(e.charCodeAt(e.length-1)===44)return ML(t,e,r);if(e.indexOf("%")!==-1)return LL(t,e,r);if(e.indexOf("E")!==-1)return jS(e,r);if(e.charCodeAt(0)===36)return"$"+Rn(t,e.substr(e.charAt(1)==" "?2:1),r);var i,s,a,o,l=Math.abs(r),c=r<0?"-":"";if(e.match(/^00+$/))return c+ho(l,e.length);if(e.match(/^[#?]+$/))return i=ho(r,0),i==="0"&&(i=""),i.length>e.length?i:Hr(e.substr(0,e.length-i.length))+i;if(s=e.match(BS))return VL(s,l,c);if(e.match(/^#+0+$/))return c+ho(l,e.length-e.indexOf("0"));if(s=e.match(zS))return i=by(r,s[1].length).replace(/^([^\.]+)$/,"$1."+Hr(s[1])).replace(/\.$/,"."+Hr(s[1])).replace(/\.(\d*)$/,function(x,v){return"."+v+Ut("0",Hr(s[1]).length-v.length)}),e.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),s=e.match(/^(0*)\.(#*)$/))return c+by(l,s[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=e.match(/^#{1,3},##0(\.?)$/))return c+bs(ho(l,0));if(s=e.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Rn(t,e,-r):bs(""+(Math.floor(r)+jL(r,s[1].length)))+"."+Zn(Oy(r,s[1].length),s[1].length);if(s=e.match(/^#,#*,#0/))return Rn(t,e.replace(/^#,#*,/,""),r);if(s=e.match(/^([0#]+)(\\?-([0#]+))+$/))return i=Bo(Rn(t,e.replace(/[\\-]/g,""),r)),a=0,Bo(Bo(e.replace(/\\/g,"")).replace(/[0#]/g,function(x){return a<i.length?i.charAt(a++):x==="0"?"0":""}));if(e.match(HS))return i=Rn(t,"##########",r),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var u="";if(s=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(s[4].length,7),o=Wh(l,Math.pow(10,a)-1,!1),i=""+c,u=Qi("n",s[1],o[1]),u.charAt(u.length-1)==" "&&(u=u.substr(0,u.length-1)+"0"),i+=u+s[2]+"/"+s[3],u=$h(o[2],a),u.length<s[4].length&&(u=Hr(s[4].substr(s[4].length-u.length))+u),i+=u,i;if(s=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(Math.max(s[1].length,s[4].length),7),o=Wh(l,Math.pow(10,a)-1,!0),c+(o[0]||(o[1]?"":"0"))+" "+(o[1]?Rv(o[1],a)+s[2]+"/"+s[3]+$h(o[2],a):Ut(" ",2*a+1+s[2].length+s[3].length));if(s=e.match(/^[#0?]+$/))return i=ho(r,0),e.length<=i.length?i:Hr(e.substr(0,e.length-i.length))+i;if(s=e.match(/^([#0?]+)\.([#0]+)$/)){i=""+r.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),a=i.indexOf(".");var h=e.indexOf(".")-a,d=e.length-i.length-h;return Hr(e.substr(0,h)+i+e.substr(e.length-d))}if(s=e.match(/^00,000\.([#0]*0)$/))return a=Oy(r,s[1].length),r<0?"-"+Rn(t,e,-r):bs(BL(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(x){return"00,"+(x.length<3?Zn(0,3-x.length):"")+x})+"."+Zn(a,s[1].length);switch(e){case"###,##0.00":return Rn(t,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var p=bs(ho(l,0));return p!=="0"?c+p:"";case"###,###.00":return Rn(t,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return Rn(t,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+e+"|")}function zL(t,e,r){for(var n=e.length-1;e.charCodeAt(n-1)===44;)--n;return Qi(t,e.substr(0,n),r/Math.pow(10,3*(e.length-n)))}function $L(t,e,r){var n=e.replace(US,""),i=e.length-n.length;return Qi(t,n,r*Math.pow(10,2*i))+Ut("%",i)}function WS(t,e){var r,n=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+WS(t,-e);var i=t.indexOf(".");i===-1&&(i=t.indexOf("E"));var s=Math.floor(Math.log(e)*Math.LOG10E)%i;if(s<0&&(s+=i),r=(e/Math.pow(10,s)).toPrecision(n+1+(i+s)%i),!r.match(/[Ee]/)){var a=Math.floor(Math.log(e)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(a-r.length+s):r+="E+"+(a-s),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,l,c,u){return l+c+u.substr(0,(i+s)%i)+"."+u.substr(s)+"E"})}else r=e.toExponential(n);return t.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),t.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function hi(t,e,r){if(t.charCodeAt(0)===40&&!e.match($S)){var n=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?hi("n",n,r):"("+hi("n",n,-r)+")"}if(e.charCodeAt(e.length-1)===44)return zL(t,e,r);if(e.indexOf("%")!==-1)return $L(t,e,r);if(e.indexOf("E")!==-1)return WS(e,r);if(e.charCodeAt(0)===36)return"$"+hi(t,e.substr(e.charAt(1)==" "?2:1),r);var i,s,a,o,l=Math.abs(r),c=r<0?"-":"";if(e.match(/^00+$/))return c+Zn(l,e.length);if(e.match(/^[#?]+$/))return i=""+r,r===0&&(i=""),i.length>e.length?i:Hr(e.substr(0,e.length-i.length))+i;if(s=e.match(BS))return UL(s,l,c);if(e.match(/^#+0+$/))return c+Zn(l,e.length-e.indexOf("0"));if(s=e.match(zS))return i=(""+r).replace(/^([^\.]+)$/,"$1."+Hr(s[1])).replace(/\.$/,"."+Hr(s[1])),i=i.replace(/\.(\d*)$/,function(x,v){return"."+v+Ut("0",Hr(s[1]).length-v.length)}),e.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),s=e.match(/^(0*)\.(#*)$/))return c+(""+l).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=e.match(/^#{1,3},##0(\.?)$/))return c+bs(""+l);if(s=e.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+hi(t,e,-r):bs(""+r)+"."+Ut("0",s[1].length);if(s=e.match(/^#,#*,#0/))return hi(t,e.replace(/^#,#*,/,""),r);if(s=e.match(/^([0#]+)(\\?-([0#]+))+$/))return i=Bo(hi(t,e.replace(/[\\-]/g,""),r)),a=0,Bo(Bo(e.replace(/\\/g,"")).replace(/[0#]/g,function(x){return a<i.length?i.charAt(a++):x==="0"?"0":""}));if(e.match(HS))return i=hi(t,"##########",r),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var u="";if(s=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(s[4].length,7),o=Wh(l,Math.pow(10,a)-1,!1),i=""+c,u=Qi("n",s[1],o[1]),u.charAt(u.length-1)==" "&&(u=u.substr(0,u.length-1)+"0"),i+=u+s[2]+"/"+s[3],u=$h(o[2],a),u.length<s[4].length&&(u=Hr(s[4].substr(s[4].length-u.length))+u),i+=u,i;if(s=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(Math.max(s[1].length,s[4].length),7),o=Wh(l,Math.pow(10,a)-1,!0),c+(o[0]||(o[1]?"":"0"))+" "+(o[1]?Rv(o[1],a)+s[2]+"/"+s[3]+$h(o[2],a):Ut(" ",2*a+1+s[2].length+s[3].length));if(s=e.match(/^[#0?]+$/))return i=""+r,e.length<=i.length?i:Hr(e.substr(0,e.length-i.length))+i;if(s=e.match(/^([#0]+)\.([#0]+)$/)){i=""+r.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),a=i.indexOf(".");var h=e.indexOf(".")-a,d=e.length-i.length-h;return Hr(e.substr(0,h)+i+e.substr(e.length-d))}if(s=e.match(/^00,000\.([#0]*0)$/))return r<0?"-"+hi(t,e,-r):bs(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(x){return"00,"+(x.length<3?Zn(0,3-x.length):"")+x})+"."+Zn(0,s[1].length);switch(e){case"###,###":case"##,###":case"#,###":var p=bs(""+l);return p!=="0"?c+p:"";default:if(e.match(/\.[0#?]*$/))return hi(t,e.slice(0,e.lastIndexOf(".")),r)+Hr(e.slice(e.lastIndexOf(".")))}throw new Error("unsupported format |"+e+"|")}function Qi(t,e,r){return(r|0)===r?hi(t,e,r):Rn(t,e,r)}function HL(t){for(var e=[],r=!1,n=0,i=0;n<t.length;++n)switch(t.charCodeAt(n)){case 34:r=!r;break;case 95:case 42:case 92:++n;break;case 59:e[e.length]=t.substr(i,n-i),i=n+1}if(e[e.length]=t.substr(i),r===!0)throw new Error("Format |"+t+"| unterminated string ");return e}var GS=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function xl(t){for(var e=0,r="",n="";e<t.length;)switch(r=t.charAt(e)){case"G":Hh(t,e)&&(e+=6),e++;break;case'"':for(;t.charCodeAt(++e)!==34&&e<t.length;);++e;break;case"\\":e+=2;break;case"_":e+=2;break;case"@":++e;break;case"B":case"b":if(t.charAt(e+1)==="1"||t.charAt(e+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(t.substr(e,3).toUpperCase()==="A/P"||t.substr(e,5).toUpperCase()==="AM/PM"||t.substr(e,5).toUpperCase()==="/")return!0;++e;break;case"[":for(n=r;t.charAt(e++)!=="]"&&e<t.length;)n+=t.charAt(e);if(n.match(GS))return!0;break;case".":case"0":case"#":for(;e<t.length&&("0#?.,E+-%".indexOf(r=t.charAt(++e))>-1||r=="\\"&&t.charAt(e+1)=="-"&&"0#".indexOf(t.charAt(e+2))>-1););break;case"?":for(;t.charAt(++e)===r;);break;case"*":++e,(t.charAt(e)==" "||t.charAt(e)=="*")&&++e;break;case"(":case")":++e;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;e<t.length&&"0123456789".indexOf(t.charAt(++e))>-1;);break;case" ":++e;break;default:++e;break}return!1}function WL(t,e,r,n){for(var i=[],s="",a=0,o="",l="t",c,u,h,d="H";a<t.length;)switch(o=t.charAt(a)){case"G":if(!Hh(t,a))throw new Error("unrecognized character "+o+" in "+t);i[i.length]={t:"G",v:"General"},a+=7;break;case'"':for(s="";(h=t.charCodeAt(++a))!==34&&a<t.length;)s+=String.fromCharCode(h);i[i.length]={t:"t",v:s},++a;break;case"\\":var p=t.charAt(++a),x=p==="("||p===")"?p:"t";i[i.length]={t:x,v:p},++a;break;case"_":i[i.length]={t:"t",v:" "},a+=2;break;case"@":i[i.length]={t:"T",v:e},++a;break;case"B":case"b":if(t.charAt(a+1)==="1"||t.charAt(a+1)==="2"){if(c==null&&(c=wa(e,r,t.charAt(a+1)==="2"),c==null))return"";i[i.length]={t:"X",v:t.substr(a,2)},l=o,a+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":o=o.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(e<0||c==null&&(c=wa(e,r),c==null))return"";for(s=o;++a<t.length&&t.charAt(a).toLowerCase()===o;)s+=o;o==="m"&&l.toLowerCase()==="h"&&(o="M"),o==="h"&&(o=d),i[i.length]={t:o,v:s},l=o;break;case"A":case"a":case"":var v={t:o,v:o};if(c==null&&(c=wa(e,r)),t.substr(a,3).toUpperCase()==="A/P"?(c!=null&&(v.v=c.H>=12?"P":"A"),v.t="T",d="h",a+=3):t.substr(a,5).toUpperCase()==="AM/PM"?(c!=null&&(v.v=c.H>=12?"PM":"AM"),v.t="T",a+=5,d="h"):t.substr(a,5).toUpperCase()==="/"?(c!=null&&(v.v=c.H>=12?"":""),v.t="T",a+=5,d="h"):(v.t="t",++a),c==null&&v.t==="T")return"";i[i.length]=v,l=o;break;case"[":for(s=o;t.charAt(a++)!=="]"&&a<t.length;)s+=t.charAt(a);if(s.slice(-1)!=="]")throw'unterminated "[" block: |'+s+"|";if(s.match(GS)){if(c==null&&(c=wa(e,r),c==null))return"";i[i.length]={t:"Z",v:s.toLowerCase()},l=s.charAt(1)}else s.indexOf("$")>-1&&(s=(s.match(/\$([^-\[\]]*)/)||[])[1]||"$",xl(t)||(i[i.length]={t:"t",v:s}));break;case".":if(c!=null){for(s=o;++a<t.length&&(o=t.charAt(a))==="0";)s+=o;i[i.length]={t:"s",v:s};break}case"0":case"#":for(s=o;++a<t.length&&"0#?.,E+-%".indexOf(o=t.charAt(a))>-1;)s+=o;i[i.length]={t:"n",v:s};break;case"?":for(s=o;t.charAt(++a)===o;)s+=o;i[i.length]={t:o,v:s},l=o;break;case"*":++a,(t.charAt(a)==" "||t.charAt(a)=="*")&&++a;break;case"(":case")":i[i.length]={t:n===1?"t":o,v:o},++a;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(s=o;a<t.length&&"0123456789".indexOf(t.charAt(++a))>-1;)s+=t.charAt(a);i[i.length]={t:"D",v:s};break;case" ":i[i.length]={t:o,v:o},++a;break;case"$":i[i.length]={t:"t",v:"$"},++a;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(o)===-1)throw new Error("unrecognized character "+o+" in "+t);i[i.length]={t:"t",v:o},++a;break}var E=0,T=0,w;for(a=i.length-1,l="t";a>=0;--a)switch(i[a].t){case"h":case"H":i[a].t=d,l="h",E<1&&(E=1);break;case"s":(w=i[a].v.match(/\.0+$/))&&(T=Math.max(T,w[0].length-1)),E<3&&(E=3);case"d":case"y":case"M":case"e":l=i[a].t;break;case"m":l==="s"&&(i[a].t="M",E<2&&(E=2));break;case"X":break;case"Z":E<1&&i[a].v.match(/[Hh]/)&&(E=1),E<2&&i[a].v.match(/[Mm]/)&&(E=2),E<3&&i[a].v.match(/[Ss]/)&&(E=3)}switch(E){case 0:break;case 1:c.u>=.5&&(c.u=0,++c.S),c.S>=60&&(c.S=0,++c.M),c.M>=60&&(c.M=0,++c.H);break;case 2:c.u>=.5&&(c.u=0,++c.S),c.S>=60&&(c.S=0,++c.M);break}var y="",R;for(a=0;a<i.length;++a)switch(i[a].t){case"t":case"T":case" ":case"D":break;case"X":i[a].v="",i[a].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":i[a].v=OL(i[a].t.charCodeAt(0),i[a].v,c,T),i[a].t="t";break;case"n":case"?":for(R=a+1;i[R]!=null&&((o=i[R].t)==="?"||o==="D"||(o===" "||o==="t")&&i[R+1]!=null&&(i[R+1].t==="?"||i[R+1].t==="t"&&i[R+1].v==="/")||i[a].t==="("&&(o===" "||o==="n"||o===")")||o==="t"&&(i[R].v==="/"||i[R].v===" "&&i[R+1]!=null&&i[R+1].t=="?"));)i[a].v+=i[R].v,i[R]={v:"",t:";"},++R;y+=i[a].v,a=R-1;break;case"G":i[a].t="t",i[a].v=Ua(e,r);break}var M="",j,g;if(y.length>0){y.charCodeAt(0)==40?(j=e<0&&y.charCodeAt(0)===45?-e:e,g=Qi("n",y,j)):(j=e<0&&n>1?-e:e,g=Qi("n",y,j),j<0&&i[0]&&i[0].t=="t"&&(g=g.substr(1),i[0].v="-"+i[0].v)),R=g.length-1;var k=i.length;for(a=0;a<i.length;++a)if(i[a]!=null&&i[a].t!="t"&&i[a].v.indexOf(".")>-1){k=a;break}var S=i.length;if(k===i.length&&g.indexOf("E")===-1){for(a=i.length-1;a>=0;--a)i[a]==null||"n?".indexOf(i[a].t)===-1||(R>=i[a].v.length-1?(R-=i[a].v.length,i[a].v=g.substr(R+1,i[a].v.length)):R<0?i[a].v="":(i[a].v=g.substr(0,R+1),R=-1),i[a].t="t",S=a);R>=0&&S<i.length&&(i[S].v=g.substr(0,R+1)+i[S].v)}else if(k!==i.length&&g.indexOf("E")===-1){for(R=g.indexOf(".")-1,a=k;a>=0;--a)if(!(i[a]==null||"n?".indexOf(i[a].t)===-1)){for(u=i[a].v.indexOf(".")>-1&&a===k?i[a].v.indexOf(".")-1:i[a].v.length-1,M=i[a].v.substr(u+1);u>=0;--u)R>=0&&(i[a].v.charAt(u)==="0"||i[a].v.charAt(u)==="#")&&(M=g.charAt(R--)+M);i[a].v=M,i[a].t="t",S=a}for(R>=0&&S<i.length&&(i[S].v=g.substr(0,R+1)+i[S].v),R=g.indexOf(".")+1,a=k;a<i.length;++a)if(!(i[a]==null||"n?(".indexOf(i[a].t)===-1&&a!==k)){for(u=i[a].v.indexOf(".")>-1&&a===k?i[a].v.indexOf(".")+1:0,M=i[a].v.substr(0,u);u<i[a].v.length;++u)R<g.length&&(M+=g.charAt(R++));i[a].v=M,i[a].t="t",S=a}}}for(a=0;a<i.length;++a)i[a]!=null&&"n?".indexOf(i[a].t)>-1&&(j=n>1&&e<0&&a>0&&i[a-1].v==="-"?-e:e,i[a].v=Qi(i[a].t,i[a].v,j),i[a].t="t");var C="";for(a=0;a!==i.length;++a)i[a]!=null&&(C+=i[a].v);return C}var Ly=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function My(t,e){if(e==null)return!1;var r=parseFloat(e[2]);switch(e[1]){case"=":if(t==r)return!0;break;case">":if(t>r)return!0;break;case"<":if(t<r)return!0;break;case"<>":if(t!=r)return!0;break;case">=":if(t>=r)return!0;break;case"<=":if(t<=r)return!0;break}return!1}function GL(t,e){var r=HL(t),n=r.length,i=r[n-1].indexOf("@");if(n<4&&i>-1&&--n,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof e!="number")return[4,r.length===4||i>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=i>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=i>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=i>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var s=e>0?r[0]:e<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[n,s];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var a=r[0].match(Ly),o=r[1].match(Ly);return My(e,a)?[n,r[0]]:My(e,o)?[n,r[1]]:[n,r[a!=null&&o!=null?2:1]]}return[n,s]}function Un(t,e,r){r==null&&(r={});var n="";switch(typeof t){case"string":t=="m/d/yy"&&r.dateNF?n=r.dateNF:n=t;break;case"number":t==14&&r.dateNF?n=r.dateNF:n=(r.table!=null?r.table:ze)[t],n==null&&(n=r.table&&r.table[Dy[t]]||ze[Dy[t]]),n==null&&(n=CL[t]||"General");break}if(Hh(n,0))return Ua(e,r);e instanceof Date&&(e=VS(e,r.date1904));var i=GL(n,e);if(Hh(i[1]))return Ua(e,r);if(e===!0)e="TRUE";else if(e===!1)e="FALSE";else if(e===""||e==null)return"";return WL(i[1],e,r,i[0])}function Aa(t,e){if(typeof e!="number"){e=+e||-1;for(var r=0;r<392;++r){if(ze[r]==null){e<0&&(e=r);continue}if(ze[r]==t){e=r;break}}e<0&&(e=391)}return ze[e]=t,e}function KS(){ze=IL()}var KL={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},qS=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function qL(t){var e=typeof t=="number"?ze[t]:t;return e=e.replace(qS,"(\\d+)"),new RegExp("^"+e+"$")}function XL(t,e,r){var n=-1,i=-1,s=-1,a=-1,o=-1,l=-1;(e.match(qS)||[]).forEach(function(h,d){var p=parseInt(r[d+1],10);switch(h.toLowerCase().charAt(0)){case"y":n=p;break;case"d":s=p;break;case"h":a=p;break;case"s":l=p;break;case"m":a>=0?o=p:i=p;break}}),l>=0&&o==-1&&i>=0&&(o=i,i=-1);var c=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(i>=1?i:1)).slice(-2)+"-"+("00"+(s>=1?s:1)).slice(-2);c.length==7&&(c="0"+c),c.length==8&&(c="20"+c);var u=("00"+(a>=0?a:0)).slice(-2)+":"+("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(l>=0?l:0)).slice(-2);return a==-1&&o==-1&&l==-1?c:n==-1&&i==-1&&s==-1?u:c+"T"+u}var YL=function(){var t={};t.version="1.2.0";function e(){for(var g=0,k=new Array(256),S=0;S!=256;++S)g=S,g=g&1?-306674912^g>>>1:g>>>1,g=g&1?-306674912^g>>>1:g>>>1,g=g&1?-306674912^g>>>1:g>>>1,g=g&1?-306674912^g>>>1:g>>>1,g=g&1?-306674912^g>>>1:g>>>1,g=g&1?-306674912^g>>>1:g>>>1,g=g&1?-306674912^g>>>1:g>>>1,g=g&1?-306674912^g>>>1:g>>>1,k[S]=g;return typeof Int32Array<"u"?new Int32Array(k):k}var r=e();function n(g){var k=0,S=0,C=0,F=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(C=0;C!=256;++C)F[C]=g[C];for(C=0;C!=256;++C)for(S=g[C],k=256+C;k<4096;k+=256)S=F[k]=S>>>8^g[S&255];var P=[];for(C=1;C!=16;++C)P[C-1]=typeof Int32Array<"u"?F.subarray(C*256,C*256+256):F.slice(C*256,C*256+256);return P}var i=n(r),s=i[0],a=i[1],o=i[2],l=i[3],c=i[4],u=i[5],h=i[6],d=i[7],p=i[8],x=i[9],v=i[10],E=i[11],T=i[12],w=i[13],y=i[14];function R(g,k){for(var S=k^-1,C=0,F=g.length;C<F;)S=S>>>8^r[(S^g.charCodeAt(C++))&255];return~S}function M(g,k){for(var S=k^-1,C=g.length-15,F=0;F<C;)S=y[g[F++]^S&255]^w[g[F++]^S>>8&255]^T[g[F++]^S>>16&255]^E[g[F++]^S>>>24]^v[g[F++]]^x[g[F++]]^p[g[F++]]^d[g[F++]]^h[g[F++]]^u[g[F++]]^c[g[F++]]^l[g[F++]]^o[g[F++]]^a[g[F++]]^s[g[F++]]^r[g[F++]];for(C+=15;F<C;)S=S>>>8^r[(S^g[F++])&255];return~S}function j(g,k){for(var S=k^-1,C=0,F=g.length,P=0,b=0;C<F;)P=g.charCodeAt(C++),P<128?S=S>>>8^r[(S^P)&255]:P<2048?(S=S>>>8^r[(S^(192|P>>6&31))&255],S=S>>>8^r[(S^(128|P&63))&255]):P>=55296&&P<57344?(P=(P&1023)+64,b=g.charCodeAt(C++)&1023,S=S>>>8^r[(S^(240|P>>8&7))&255],S=S>>>8^r[(S^(128|P>>2&63))&255],S=S>>>8^r[(S^(128|b>>6&15|(P&3)<<4))&255],S=S>>>8^r[(S^(128|b&63))&255]):(S=S>>>8^r[(S^(224|P>>12&15))&255],S=S>>>8^r[(S^(128|P>>6&63))&255],S=S>>>8^r[(S^(128|P&63))&255]);return~S}return t.table=r,t.bstr=R,t.buf=M,t.str=j,t}(),tt=function(){var e={};e.version="1.2.1";function r(I,V){for(var N=I.split("/"),D=V.split("/"),O=0,L=0,q=Math.min(N.length,D.length);O<q;++O){if(L=N[O].length-D[O].length)return L;if(N[O]!=D[O])return N[O]<D[O]?-1:1}return N.length-D.length}function n(I){if(I.charAt(I.length-1)=="/")return I.slice(0,-1).indexOf("/")===-1?I:n(I.slice(0,-1));var V=I.lastIndexOf("/");return V===-1?I:I.slice(0,V+1)}function i(I){if(I.charAt(I.length-1)=="/")return i(I.slice(0,-1));var V=I.lastIndexOf("/");return V===-1?I:I.slice(V+1)}function s(I,V){typeof V=="string"&&(V=new Date(V));var N=V.getHours();N=N<<6|V.getMinutes(),N=N<<5|V.getSeconds()>>>1,I.write_shift(2,N);var D=V.getFullYear()-1980;D=D<<4|V.getMonth()+1,D=D<<5|V.getDate(),I.write_shift(2,D)}function a(I){var V=I.read_shift(2)&65535,N=I.read_shift(2)&65535,D=new Date,O=N&31;N>>>=5;var L=N&15;N>>>=4,D.setMilliseconds(0),D.setFullYear(N+1980),D.setMonth(L-1),D.setDate(O);var q=V&31;V>>>=5;var te=V&63;return V>>>=6,D.setHours(V),D.setMinutes(te),D.setSeconds(q<<1),D}function o(I){vr(I,0);for(var V={},N=0;I.l<=I.length-4;){var D=I.read_shift(2),O=I.read_shift(2),L=I.l+O,q={};switch(D){case 21589:N=I.read_shift(1),N&1&&(q.mtime=I.read_shift(4)),O>5&&(N&2&&(q.atime=I.read_shift(4)),N&4&&(q.ctime=I.read_shift(4))),q.mtime&&(q.mt=new Date(q.mtime*1e3));break}I.l=L,V[D]=q}return V}var l;function c(){return l||(l={})}function u(I,V){if(I[0]==80&&I[1]==75)return ps(I,V);if((I[0]|32)==109&&(I[1]|32)==105)return so(I,V);if(I.length<512)throw new Error("CFB file size "+I.length+" < 512");var N=3,D=512,O=0,L=0,q=0,te=0,ee=0,J=[],Y=I.slice(0,512);vr(Y,0);var le=h(Y);switch(N=le[0],N){case 3:D=512;break;case 4:D=4096;break;case 0:if(le[1]==0)return ps(I,V);default:throw new Error("Major Version: Expected 3 or 4 saw "+N)}D!==512&&(Y=I.slice(0,D),vr(Y,28));var ye=I.slice(0,D);d(Y,N);var Ce=Y.read_shift(4,"i");if(N===3&&Ce!==0)throw new Error("# Directory Sectors: Expected 0 saw "+Ce);Y.l+=4,q=Y.read_shift(4,"i"),Y.l+=4,Y.chk("00100000","Mini Stream Cutoff Size: "),te=Y.read_shift(4,"i"),O=Y.read_shift(4,"i"),ee=Y.read_shift(4,"i"),L=Y.read_shift(4,"i");for(var me=-1,we=0;we<109&&(me=Y.read_shift(4,"i"),!(me<0));++we)J[we]=me;var De=p(I,D);E(ee,L,De,D,J);var it=w(De,q,J,D);it[q].name="!Directory",O>0&&te!==b&&(it[te].name="!MiniFAT"),it[J[0]].name="!FAT",it.fat_addrs=J,it.ssz=D;var Ke={},dt=[],tn=[],He=[];y(q,it,De,dt,O,Ke,tn,te),x(tn,He,dt),dt.shift();var ft={FileIndex:tn,FullPaths:He};return V&&V.raw&&(ft.raw={header:ye,sectors:De}),ft}function h(I){if(I[I.l]==80&&I[I.l+1]==75)return[0,0];I.chk(ve,"Header Signature: "),I.l+=16;var V=I.read_shift(2,"u");return[I.read_shift(2,"u"),V]}function d(I,V){var N=9;switch(I.l+=2,N=I.read_shift(2)){case 9:if(V!=3)throw new Error("Sector Shift: Expected 9 saw "+N);break;case 12:if(V!=4)throw new Error("Sector Shift: Expected 12 saw "+N);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+N)}I.chk("0600","Mini Sector Shift: "),I.chk("000000000000","Reserved: ")}function p(I,V){for(var N=Math.ceil(I.length/V)-1,D=[],O=1;O<N;++O)D[O-1]=I.slice(O*V,(O+1)*V);return D[N-1]=I.slice(N*V),D}function x(I,V,N){for(var D=0,O=0,L=0,q=0,te=0,ee=N.length,J=[],Y=[];D<ee;++D)J[D]=Y[D]=D,V[D]=N[D];for(;te<Y.length;++te)D=Y[te],O=I[D].L,L=I[D].R,q=I[D].C,J[D]===D&&(O!==-1&&J[O]!==O&&(J[D]=J[O]),L!==-1&&J[L]!==L&&(J[D]=J[L])),q!==-1&&(J[q]=D),O!==-1&&D!=J[D]&&(J[O]=J[D],Y.lastIndexOf(O)<te&&Y.push(O)),L!==-1&&D!=J[D]&&(J[L]=J[D],Y.lastIndexOf(L)<te&&Y.push(L));for(D=1;D<ee;++D)J[D]===D&&(L!==-1&&J[L]!==L?J[D]=J[L]:O!==-1&&J[O]!==O&&(J[D]=J[O]));for(D=1;D<ee;++D)if(I[D].type!==0){if(te=D,te!=J[te])do te=J[te],V[D]=V[te]+"/"+V[D];while(te!==0&&J[te]!==-1&&te!=J[te]);J[D]=-1}for(V[0]+="/",D=1;D<ee;++D)I[D].type!==2&&(V[D]+="/")}function v(I,V,N){for(var D=I.start,O=I.size,L=[],q=D;N&&O>0&&q>=0;)L.push(V.slice(q*P,q*P+P)),O-=P,q=pa(N,q*4);return L.length===0?er(0):Cs(L).slice(0,I.size)}function E(I,V,N,D,O){var L=b;if(I===b){if(V!==0)throw new Error("DIFAT chain shorter than expected")}else if(I!==-1){var q=N[I],te=(D>>>2)-1;if(!q)return;for(var ee=0;ee<te&&(L=pa(q,ee*4))!==b;++ee)O.push(L);E(pa(q,D-4),V-1,N,D,O)}}function T(I,V,N,D,O){var L=[],q=[];O||(O=[]);var te=D-1,ee=0,J=0;for(ee=V;ee>=0;){O[ee]=!0,L[L.length]=ee,q.push(I[ee]);var Y=N[Math.floor(ee*4/D)];if(J=ee*4&te,D<4+J)throw new Error("FAT boundary crossed: "+ee+" 4 "+D);if(!I[Y])break;ee=pa(I[Y],J)}return{nodes:L,data:Ky([q])}}function w(I,V,N,D){var O=I.length,L=[],q=[],te=[],ee=[],J=D-1,Y=0,le=0,ye=0,Ce=0;for(Y=0;Y<O;++Y)if(te=[],ye=Y+V,ye>=O&&(ye-=O),!q[ye]){ee=[];var me=[];for(le=ye;le>=0;){me[le]=!0,q[le]=!0,te[te.length]=le,ee.push(I[le]);var we=N[Math.floor(le*4/D)];if(Ce=le*4&J,D<4+Ce)throw new Error("FAT boundary crossed: "+le+" 4 "+D);if(!I[we]||(le=pa(I[we],Ce),me[le]))break}L[ye]={nodes:te,data:Ky([ee])}}return L}function y(I,V,N,D,O,L,q,te){for(var ee=0,J=D.length?2:0,Y=V[I].data,le=0,ye=0,Ce;le<Y.length;le+=128){var me=Y.slice(le,le+128);vr(me,64),ye=me.read_shift(2),Ce=Ov(me,0,ye-J),D.push(Ce);var we={name:Ce,type:me.read_shift(1),color:me.read_shift(1),L:me.read_shift(4,"i"),R:me.read_shift(4,"i"),C:me.read_shift(4,"i"),clsid:me.read_shift(16),state:me.read_shift(4,"i"),start:0,size:0},De=me.read_shift(2)+me.read_shift(2)+me.read_shift(2)+me.read_shift(2);De!==0&&(we.ct=R(me,me.l-8));var it=me.read_shift(2)+me.read_shift(2)+me.read_shift(2)+me.read_shift(2);it!==0&&(we.mt=R(me,me.l-8)),we.start=me.read_shift(4,"i"),we.size=me.read_shift(4,"i"),we.size<0&&we.start<0&&(we.size=we.type=0,we.start=b,we.name=""),we.type===5?(ee=we.start,O>0&&ee!==b&&(V[ee].name="!StreamData")):we.size>=4096?(we.storage="fat",V[we.start]===void 0&&(V[we.start]=T(N,we.start,V.fat_addrs,V.ssz)),V[we.start].name=we.name,we.content=V[we.start].data.slice(0,we.size)):(we.storage="minifat",we.size<0?we.size=0:ee!==b&&we.start!==b&&V[ee]&&(we.content=v(we,V[ee].data,(V[te]||{}).data))),we.content&&vr(we.content,0),L[Ce]=we,q.push(we)}}function R(I,V){return new Date((mn(I,V+4)/1e7*Math.pow(2,32)+mn(I,V)/1e7-11644473600)*1e3)}function M(I,V){return c(),u(l.readFileSync(I),V)}function j(I,V){var N=V&&V.type;switch(N||Je&&Buffer.isBuffer(I)&&(N="buffer"),N||"base64"){case"file":return M(I,V);case"base64":return u(Yn(En(I)),V);case"binary":return u(Yn(I),V)}return u(I,V)}function g(I,V){var N=V||{},D=N.root||"Root Entry";if(I.FullPaths||(I.FullPaths=[]),I.FileIndex||(I.FileIndex=[]),I.FullPaths.length!==I.FileIndex.length)throw new Error("inconsistent CFB structure");I.FullPaths.length===0&&(I.FullPaths[0]=D+"/",I.FileIndex[0]={name:D,type:5}),N.CLSID&&(I.FileIndex[0].clsid=N.CLSID),k(I)}function k(I){var V="Sh33tJ5";if(!tt.find(I,"/"+V)){var N=er(4);N[0]=55,N[1]=N[3]=50,N[2]=54,I.FileIndex.push({name:V,type:2,content:N,size:4,L:69,R:69,C:69}),I.FullPaths.push(I.FullPaths[0]+V),S(I)}}function S(I,V){g(I);for(var N=!1,D=!1,O=I.FullPaths.length-1;O>=0;--O){var L=I.FileIndex[O];switch(L.type){case 0:D?N=!0:(I.FileIndex.pop(),I.FullPaths.pop());break;case 1:case 2:case 5:D=!0,isNaN(L.R*L.L*L.C)&&(N=!0),L.R>-1&&L.L>-1&&L.R==L.L&&(N=!0);break;default:N=!0;break}}if(!(!N&&!V)){var q=new Date(1987,1,19),te=0,ee=Object.create?Object.create(null):{},J=[];for(O=0;O<I.FullPaths.length;++O)ee[I.FullPaths[O]]=!0,I.FileIndex[O].type!==0&&J.push([I.FullPaths[O],I.FileIndex[O]]);for(O=0;O<J.length;++O){var Y=n(J[O][0]);D=ee[Y],D||(J.push([Y,{name:i(Y).replace("/",""),type:1,clsid:Se,ct:q,mt:q,content:null}]),ee[Y]=!0)}for(J.sort(function(Ce,me){return r(Ce[0],me[0])}),I.FullPaths=[],I.FileIndex=[],O=0;O<J.length;++O)I.FullPaths[O]=J[O][0],I.FileIndex[O]=J[O][1];for(O=0;O<J.length;++O){var le=I.FileIndex[O],ye=I.FullPaths[O];if(le.name=i(ye).replace("/",""),le.L=le.R=le.C=-(le.color=1),le.size=le.content?le.content.length:0,le.start=0,le.clsid=le.clsid||Se,O===0)le.C=J.length>1?1:-1,le.size=0,le.type=5;else if(ye.slice(-1)=="/"){for(te=O+1;te<J.length&&n(I.FullPaths[te])!=ye;++te);for(le.C=te>=J.length?-1:te,te=O+1;te<J.length&&n(I.FullPaths[te])!=n(ye);++te);le.R=te>=J.length?-1:te,le.type=1}else n(I.FullPaths[O+1]||"")==n(ye)&&(le.R=O+1),le.type=2}}}function C(I,V){var N=V||{};if(N.fileType=="mad")return Zt(I,N);switch(S(I),N.fileType){case"zip":return bi(I,N)}var D=function(Ce){for(var me=0,we=0,De=0;De<Ce.FileIndex.length;++De){var it=Ce.FileIndex[De];if(it.content){var Ke=it.content.length;Ke>0&&(Ke<4096?me+=Ke+63>>6:we+=Ke+511>>9)}}for(var dt=Ce.FullPaths.length+3>>2,tn=me+7>>3,He=me+127>>7,ft=tn+we+dt+He,dr=ft+127>>7,In=dr<=109?0:Math.ceil((dr-109)/127);ft+dr+In+127>>7>dr;)In=++dr<=109?0:Math.ceil((dr-109)/127);var Ze=[1,In,dr,He,dt,we,me,0];return Ce.FileIndex[0].size=me<<6,Ze[7]=(Ce.FileIndex[0].start=Ze[0]+Ze[1]+Ze[2]+Ze[3]+Ze[4]+Ze[5])+(Ze[6]+7>>3),Ze}(I),O=er(D[7]<<9),L=0,q=0;{for(L=0;L<8;++L)O.write_shift(1,he[L]);for(L=0;L<8;++L)O.write_shift(2,0);for(O.write_shift(2,62),O.write_shift(2,3),O.write_shift(2,65534),O.write_shift(2,9),O.write_shift(2,6),L=0;L<3;++L)O.write_shift(2,0);for(O.write_shift(4,0),O.write_shift(4,D[2]),O.write_shift(4,D[0]+D[1]+D[2]+D[3]-1),O.write_shift(4,0),O.write_shift(4,4096),O.write_shift(4,D[3]?D[0]+D[1]+D[2]-1:b),O.write_shift(4,D[3]),O.write_shift(-4,D[1]?D[0]-1:b),O.write_shift(4,D[1]),L=0;L<109;++L)O.write_shift(-4,L<D[2]?D[1]+L:-1)}if(D[1])for(q=0;q<D[1];++q){for(;L<236+q*127;++L)O.write_shift(-4,L<D[2]?D[1]+L:-1);O.write_shift(-4,q===D[1]-1?b:q+1)}var te=function(Ce){for(q+=Ce;L<q-1;++L)O.write_shift(-4,L+1);Ce&&(++L,O.write_shift(-4,b))};for(q=L=0,q+=D[1];L<q;++L)O.write_shift(-4,oe.DIFSECT);for(q+=D[2];L<q;++L)O.write_shift(-4,oe.FATSECT);te(D[3]),te(D[4]);for(var ee=0,J=0,Y=I.FileIndex[0];ee<I.FileIndex.length;++ee)Y=I.FileIndex[ee],Y.content&&(J=Y.content.length,!(J<4096)&&(Y.start=q,te(J+511>>9)));for(te(D[6]+7>>3);O.l&511;)O.write_shift(-4,oe.ENDOFCHAIN);for(q=L=0,ee=0;ee<I.FileIndex.length;++ee)Y=I.FileIndex[ee],Y.content&&(J=Y.content.length,!(!J||J>=4096)&&(Y.start=q,te(J+63>>6)));for(;O.l&511;)O.write_shift(-4,oe.ENDOFCHAIN);for(L=0;L<D[4]<<2;++L){var le=I.FullPaths[L];if(!le||le.length===0){for(ee=0;ee<17;++ee)O.write_shift(4,0);for(ee=0;ee<3;++ee)O.write_shift(4,-1);for(ee=0;ee<12;++ee)O.write_shift(4,0);continue}Y=I.FileIndex[L],L===0&&(Y.start=Y.size?Y.start-1:b);var ye=L===0&&N.root||Y.name;if(J=2*(ye.length+1),O.write_shift(64,ye,"utf16le"),O.write_shift(2,J),O.write_shift(1,Y.type),O.write_shift(1,Y.color),O.write_shift(-4,Y.L),O.write_shift(-4,Y.R),O.write_shift(-4,Y.C),Y.clsid)O.write_shift(16,Y.clsid,"hex");else for(ee=0;ee<4;++ee)O.write_shift(4,0);O.write_shift(4,Y.state||0),O.write_shift(4,0),O.write_shift(4,0),O.write_shift(4,0),O.write_shift(4,0),O.write_shift(4,Y.start),O.write_shift(4,Y.size),O.write_shift(4,0)}for(L=1;L<I.FileIndex.length;++L)if(Y=I.FileIndex[L],Y.size>=4096)if(O.l=Y.start+1<<9,Je&&Buffer.isBuffer(Y.content))Y.content.copy(O,O.l,0,Y.size),O.l+=Y.size+511&-512;else{for(ee=0;ee<Y.size;++ee)O.write_shift(1,Y.content[ee]);for(;ee&511;++ee)O.write_shift(1,0)}for(L=1;L<I.FileIndex.length;++L)if(Y=I.FileIndex[L],Y.size>0&&Y.size<4096)if(Je&&Buffer.isBuffer(Y.content))Y.content.copy(O,O.l,0,Y.size),O.l+=Y.size+63&-64;else{for(ee=0;ee<Y.size;++ee)O.write_shift(1,Y.content[ee]);for(;ee&63;++ee)O.write_shift(1,0)}if(Je)O.l=O.length;else for(;O.l<O.length;)O.write_shift(1,0);return O}function F(I,V){var N=I.FullPaths.map(function(ee){return ee.toUpperCase()}),D=N.map(function(ee){var J=ee.split("/");return J[J.length-(ee.slice(-1)=="/"?2:1)]}),O=!1;V.charCodeAt(0)===47?(O=!0,V=N[0].slice(0,-1)+V):O=V.indexOf("/")!==-1;var L=V.toUpperCase(),q=O===!0?N.indexOf(L):D.indexOf(L);if(q!==-1)return I.FileIndex[q];var te=!L.match(Jl);for(L=L.replace(Xr,""),te&&(L=L.replace(Jl,"!")),q=0;q<N.length;++q)if((te?N[q].replace(Jl,"!"):N[q]).replace(Xr,"")==L||(te?D[q].replace(Jl,"!"):D[q]).replace(Xr,"")==L)return I.FileIndex[q];return null}var P=64,b=-2,ve="d0cf11e0a1b11ae1",he=[208,207,17,224,161,177,26,225],Se="00000000000000000000000000000000",oe={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:b,FREESECT:-1,HEADER_SIGNATURE:ve,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:Se,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function ie(I,V,N){c();var D=C(I,N);l.writeFileSync(V,D)}function G(I){for(var V=new Array(I.length),N=0;N<I.length;++N)V[N]=String.fromCharCode(I[N]);return V.join("")}function ue(I,V){var N=C(I,V);switch(V&&V.type||"buffer"){case"file":return c(),l.writeFileSync(V.filename,N),N;case"binary":return typeof N=="string"?N:G(N);case"base64":return Ry(typeof N=="string"?N:G(N));case"buffer":if(Je)return Buffer.isBuffer(N)?N:Qa(N);case"array":return typeof N=="string"?Yn(N):N}return N}var Ee;function B(I){try{var V=I.InflateRaw,N=new V;if(N._processChunk(new Uint8Array([3,0]),N._finishFlushFlag),N.bytesRead)Ee=I;else throw new Error("zlib does not expose bytesRead")}catch(D){console.error("cannot use native zlib: "+(D.message||D))}}function X(I,V){if(!Ee)return Di(I,V);var N=Ee.InflateRaw,D=new N,O=D._processChunk(I.slice(I.l),D._finishFlushFlag);return I.l+=D.bytesRead,O}function K(I){return Ee?Ee.deflateRawSync(I):Ve(I)}var W=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],ae=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],xe=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function ke(I){var V=(I<<1|I<<11)&139536|(I<<5|I<<15)&558144;return(V>>16|V>>8|V)&255}for(var fe=typeof Uint8Array<"u",pe=fe?new Uint8Array(256):[],$e=0;$e<256;++$e)pe[$e]=ke($e);function z(I,V){var N=pe[I&255];return V<=8?N>>>8-V:(N=N<<8|pe[I>>8&255],V<=16?N>>>16-V:(N=N<<8|pe[I>>16&255],N>>>24-V))}function ot(I,V){var N=V&7,D=V>>>3;return(I[D]|(N<=6?0:I[D+1]<<8))>>>N&3}function We(I,V){var N=V&7,D=V>>>3;return(I[D]|(N<=5?0:I[D+1]<<8))>>>N&7}function nt(I,V){var N=V&7,D=V>>>3;return(I[D]|(N<=4?0:I[D+1]<<8))>>>N&15}function be(I,V){var N=V&7,D=V>>>3;return(I[D]|(N<=3?0:I[D+1]<<8))>>>N&31}function Ie(I,V){var N=V&7,D=V>>>3;return(I[D]|(N<=1?0:I[D+1]<<8))>>>N&127}function Et(I,V,N){var D=V&7,O=V>>>3,L=(1<<N)-1,q=I[O]>>>D;return N<8-D||(q|=I[O+1]<<8-D,N<16-D)||(q|=I[O+2]<<16-D,N<24-D)||(q|=I[O+3]<<24-D),q&L}function ar(I,V,N){var D=V&7,O=V>>>3;return D<=5?I[O]|=(N&7)<<D:(I[O]|=N<<D&255,I[O+1]=(N&7)>>8-D),V+3}function Sr(I,V,N){var D=V&7,O=V>>>3;return N=(N&1)<<D,I[O]|=N,V+1}function Zr(I,V,N){var D=V&7,O=V>>>3;return N<<=D,I[O]|=N&255,N>>>=8,I[O+1]=N,V+8}function Pi(I,V,N){var D=V&7,O=V>>>3;return N<<=D,I[O]|=N&255,N>>>=8,I[O+1]=N&255,I[O+2]=N>>>8,V+16}function en(I,V){var N=I.length,D=2*N>V?2*N:V+5,O=0;if(N>=V)return I;if(Je){var L=Ny(D);if(I.copy)I.copy(L);else for(;O<I.length;++O)L[O]=I[O];return L}else if(fe){var q=new Uint8Array(D);if(q.set)q.set(I);else for(;O<N;++O)q[O]=I[O];return q}return I.length=D,I}function Tt(I){for(var V=new Array(I),N=0;N<I;++N)V[N]=0;return V}function or(I,V,N){var D=1,O=0,L=0,q=0,te=0,ee=I.length,J=fe?new Uint16Array(32):Tt(32);for(L=0;L<32;++L)J[L]=0;for(L=ee;L<N;++L)I[L]=0;ee=I.length;var Y=fe?new Uint16Array(ee):Tt(ee);for(L=0;L<ee;++L)J[O=I[L]]++,D<O&&(D=O),Y[L]=0;for(J[0]=0,L=1;L<=D;++L)J[L+16]=te=te+J[L-1]<<1;for(L=0;L<ee;++L)te=I[L],te!=0&&(Y[L]=J[te+16]++);var le=0;for(L=0;L<ee;++L)if(le=I[L],le!=0)for(te=z(Y[L],D)>>D-le,q=(1<<D+4-le)-1;q>=0;--q)V[te|q<<le]=le&15|L<<4;return D}var vt=fe?new Uint16Array(512):Tt(512),kt=fe?new Uint16Array(32):Tt(32);if(!fe){for(var ht=0;ht<512;++ht)vt[ht]=0;for(ht=0;ht<32;++ht)kt[ht]=0}(function(){for(var I=[],V=0;V<32;V++)I.push(5);or(I,kt,32);var N=[];for(V=0;V<=143;V++)N.push(8);for(;V<=255;V++)N.push(9);for(;V<=279;V++)N.push(7);for(;V<=287;V++)N.push(8);or(N,vt,288)})();var Ft=function(){for(var V=fe?new Uint8Array(32768):[],N=0,D=0;N<xe.length-1;++N)for(;D<xe[N+1];++D)V[D]=N;for(;D<32768;++D)V[D]=29;var O=fe?new Uint8Array(259):[];for(N=0,D=0;N<ae.length-1;++N)for(;D<ae[N+1];++D)O[D]=N;function L(te,ee){for(var J=0;J<te.length;){var Y=Math.min(65535,te.length-J),le=J+Y==te.length;for(ee.write_shift(1,+le),ee.write_shift(2,Y),ee.write_shift(2,~Y&65535);Y-- >0;)ee[ee.l++]=te[J++]}return ee.l}function q(te,ee){for(var J=0,Y=0,le=fe?new Uint16Array(32768):[];Y<te.length;){var ye=Math.min(65535,te.length-Y);if(ye<10){for(J=ar(ee,J,+(Y+ye==te.length)),J&7&&(J+=8-(J&7)),ee.l=J/8|0,ee.write_shift(2,ye),ee.write_shift(2,~ye&65535);ye-- >0;)ee[ee.l++]=te[Y++];J=ee.l*8;continue}J=ar(ee,J,+(Y+ye==te.length)+2);for(var Ce=0;ye-- >0;){var me=te[Y];Ce=(Ce<<5^me)&32767;var we=-1,De=0;if((we=le[Ce])&&(we|=Y&-32768,we>Y&&(we-=32768),we<Y))for(;te[we+De]==te[Y+De]&&De<250;)++De;if(De>2){me=O[De],me<=22?J=Zr(ee,J,pe[me+1]>>1)-1:(Zr(ee,J,3),J+=5,Zr(ee,J,pe[me-23]>>5),J+=3);var it=me<8?0:me-4>>2;it>0&&(Pi(ee,J,De-ae[me]),J+=it),me=V[Y-we],J=Zr(ee,J,pe[me]>>3),J-=3;var Ke=me<4?0:me-2>>1;Ke>0&&(Pi(ee,J,Y-we-xe[me]),J+=Ke);for(var dt=0;dt<De;++dt)le[Ce]=Y&32767,Ce=(Ce<<5^te[Y])&32767,++Y;ye-=De-1}else me<=143?me=me+48:J=Sr(ee,J,1),J=Zr(ee,J,pe[me]),le[Ce]=Y&32767,++Y}J=Zr(ee,J,0)-1}return ee.l=(J+7)/8|0,ee.l}return function(ee,J){return ee.length<8?L(ee,J):q(ee,J)}}();function Ve(I){var V=er(50+Math.floor(I.length*1.1)),N=Ft(I,V);return V.slice(0,N)}var xt=fe?new Uint16Array(32768):Tt(32768),Ht=fe?new Uint16Array(32768):Tt(32768),ut=fe?new Uint16Array(128):Tt(128),fn=1,Fi=1;function no(I,V){var N=be(I,V)+257;V+=5;var D=be(I,V)+1;V+=5;var O=nt(I,V)+4;V+=4;for(var L=0,q=fe?new Uint8Array(19):Tt(19),te=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],ee=1,J=fe?new Uint8Array(8):Tt(8),Y=fe?new Uint8Array(8):Tt(8),le=q.length,ye=0;ye<O;++ye)q[W[ye]]=L=We(I,V),ee<L&&(ee=L),J[L]++,V+=3;var Ce=0;for(J[0]=0,ye=1;ye<=ee;++ye)Y[ye]=Ce=Ce+J[ye-1]<<1;for(ye=0;ye<le;++ye)(Ce=q[ye])!=0&&(te[ye]=Y[Ce]++);var me=0;for(ye=0;ye<le;++ye)if(me=q[ye],me!=0){Ce=pe[te[ye]]>>8-me;for(var we=(1<<7-me)-1;we>=0;--we)ut[Ce|we<<me]=me&7|ye<<3}var De=[];for(ee=1;De.length<N+D;)switch(Ce=ut[Ie(I,V)],V+=Ce&7,Ce>>>=3){case 16:for(L=3+ot(I,V),V+=2,Ce=De[De.length-1];L-- >0;)De.push(Ce);break;case 17:for(L=3+We(I,V),V+=3;L-- >0;)De.push(0);break;case 18:for(L=11+Ie(I,V),V+=7;L-- >0;)De.push(0);break;default:De.push(Ce),ee<Ce&&(ee=Ce);break}var it=De.slice(0,N),Ke=De.slice(N);for(ye=N;ye<286;++ye)it[ye]=0;for(ye=D;ye<30;++ye)Ke[ye]=0;return fn=or(it,xt,286),Fi=or(Ke,Ht,30),V}function wl(I,V){if(I[0]==3&&!(I[1]&3))return[Zs(V),2];for(var N=0,D=0,O=Ny(V||1<<18),L=0,q=O.length>>>0,te=0,ee=0;!(D&1);){if(D=We(I,N),N+=3,D>>>1)D>>1==1?(te=9,ee=5):(N=no(I,N),te=fn,ee=Fi);else{N&7&&(N+=8-(N&7));var J=I[N>>>3]|I[(N>>>3)+1]<<8;if(N+=32,J>0)for(!V&&q<L+J&&(O=en(O,L+J),q=O.length);J-- >0;)O[L++]=I[N>>>3],N+=8;continue}for(;;){!V&&q<L+32767&&(O=en(O,L+32767),q=O.length);var Y=Et(I,N,te),le=D>>>1==1?vt[Y]:xt[Y];if(N+=le&15,le>>>=4,!(le>>>8&255))O[L++]=le;else{if(le==256)break;le-=257;var ye=le<8?0:le-4>>2;ye>5&&(ye=0);var Ce=L+ae[le];ye>0&&(Ce+=Et(I,N,ye),N+=ye),Y=Et(I,N,ee),le=D>>>1==1?kt[Y]:Ht[Y],N+=le&15,le>>>=4;var me=le<4?0:le-2>>1,we=xe[le];for(me>0&&(we+=Et(I,N,me),N+=me),!V&&q<Ce&&(O=en(O,Ce+100),q=O.length);L<Ce;)O[L]=O[L-we],++L}}}return V?[O,N+7>>>3]:[O.slice(0,L),N+7>>>3]}function Di(I,V){var N=I.slice(I.l||0),D=wl(N,V);return I.l+=D[1],D[0]}function oi(I,V){if(I)typeof console<"u"&&console.error(V);else throw new Error(V)}function ps(I,V){var N=I;vr(N,0);var D=[],O=[],L={FileIndex:D,FullPaths:O};g(L,{root:V.root});for(var q=N.length-4;(N[q]!=80||N[q+1]!=75||N[q+2]!=5||N[q+3]!=6)&&q>=0;)--q;N.l=q+4,N.l+=4;var te=N.read_shift(2);N.l+=6;var ee=N.read_shift(4);for(N.l=ee,q=0;q<te;++q){N.l+=20;var J=N.read_shift(4),Y=N.read_shift(4),le=N.read_shift(2),ye=N.read_shift(2),Ce=N.read_shift(2);N.l+=8;var me=N.read_shift(4),we=o(N.slice(N.l+le,N.l+le+ye));N.l+=le+ye+Ce;var De=N.l;N.l=me+4,Bn(N,J,Y,L,we),N.l=De}return L}function Bn(I,V,N,D,O){I.l+=2;var L=I.read_shift(2),q=I.read_shift(2),te=a(I);if(L&8257)throw new Error("Unsupported ZIP encryption");for(var ee=I.read_shift(4),J=I.read_shift(4),Y=I.read_shift(4),le=I.read_shift(2),ye=I.read_shift(2),Ce="",me=0;me<le;++me)Ce+=String.fromCharCode(I[I.l++]);if(ye){var we=o(I.slice(I.l,I.l+ye));(we[21589]||{}).mt&&(te=we[21589].mt),((O||{})[21589]||{}).mt&&(te=O[21589].mt)}I.l+=ye;var De=I.slice(I.l,I.l+J);switch(q){case 8:De=X(I,Y);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+q)}var it=!1;L&8&&(ee=I.read_shift(4),ee==134695760&&(ee=I.read_shift(4),it=!0),J=I.read_shift(4),Y=I.read_shift(4)),J!=V&&oi(it,"Bad compressed size: "+V+" != "+J),Y!=N&&oi(it,"Bad uncompressed size: "+N+" != "+Y),Q(D,Ce,De,{unsafe:!0,mt:te})}function bi(I,V){var N=V||{},D=[],O=[],L=er(1),q=N.compression?8:0,te=0,ee=0,J=0,Y=0,le=0,ye=I.FullPaths[0],Ce=ye,me=I.FileIndex[0],we=[],De=0;for(ee=1;ee<I.FullPaths.length;++ee)if(Ce=I.FullPaths[ee].slice(ye.length),me=I.FileIndex[ee],!(!me.size||!me.content||Ce=="Sh33tJ5")){var it=Y,Ke=er(Ce.length);for(J=0;J<Ce.length;++J)Ke.write_shift(1,Ce.charCodeAt(J)&127);Ke=Ke.slice(0,Ke.l),we[le]=YL.buf(me.content,0);var dt=me.content;q==8&&(dt=K(dt)),L=er(30),L.write_shift(4,67324752),L.write_shift(2,20),L.write_shift(2,te),L.write_shift(2,q),me.mt?s(L,me.mt):L.write_shift(4,0),L.write_shift(-4,we[le]),L.write_shift(4,dt.length),L.write_shift(4,me.content.length),L.write_shift(2,Ke.length),L.write_shift(2,0),Y+=L.length,D.push(L),Y+=Ke.length,D.push(Ke),Y+=dt.length,D.push(dt),L=er(46),L.write_shift(4,33639248),L.write_shift(2,0),L.write_shift(2,20),L.write_shift(2,te),L.write_shift(2,q),L.write_shift(4,0),L.write_shift(-4,we[le]),L.write_shift(4,dt.length),L.write_shift(4,me.content.length),L.write_shift(2,Ke.length),L.write_shift(2,0),L.write_shift(2,0),L.write_shift(2,0),L.write_shift(2,0),L.write_shift(4,0),L.write_shift(4,it),De+=L.l,O.push(L),De+=Ke.length,O.push(Ke),++le}return L=er(22),L.write_shift(4,101010256),L.write_shift(2,0),L.write_shift(2,0),L.write_shift(2,le),L.write_shift(2,le),L.write_shift(4,De),L.write_shift(4,Y),L.write_shift(2,0),Cs([Cs(D),Cs(O),L])}var li={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function Sn(I,V){if(I.ctype)return I.ctype;var N=I.name||"",D=N.match(/\.([^\.]+)$/);return D&&li[D[1]]||V&&(D=(N=V).match(/[\.\\]([^\.\\])+$/),D&&li[D[1]])?li[D[1]]:"application/octet-stream"}function io(I){for(var V=Ry(I),N=[],D=0;D<V.length;D+=76)N.push(V.slice(D,D+76));return N.join(`\r
`)+`\r
`}function Oi(I){var V=I.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(J){var Y=J.charCodeAt(0).toString(16).toUpperCase();return"="+(Y.length==1?"0"+Y:Y)});V=V.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),V.charAt(0)==`
`&&(V="=0D"+V.slice(1)),V=V.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var N=[],D=V.split(`\r
`),O=0;O<D.length;++O){var L=D[O];if(L.length==0){N.push("");continue}for(var q=0;q<L.length;){var te=76,ee=L.slice(q,q+te);ee.charAt(te-1)=="="?te--:ee.charAt(te-2)=="="?te-=2:ee.charAt(te-3)=="="&&(te-=3),ee=L.slice(q,q+te),q+=te,q<L.length&&(ee+="="),N.push(ee)}}return N.join(`\r
`)}function Li(I){for(var V=[],N=0;N<I.length;++N){for(var D=I[N];N<=I.length&&D.charAt(D.length-1)=="=";)D=D.slice(0,D.length-1)+I[++N];V.push(D)}for(var O=0;O<V.length;++O)V[O]=V[O].replace(/[=][0-9A-Fa-f]{2}/g,function(L){return String.fromCharCode(parseInt(L.slice(1),16))});return Yn(V.join(`\r
`))}function An(I,V,N){for(var D="",O="",L="",q,te=0;te<10;++te){var ee=V[te];if(!ee||ee.match(/^\s*$/))break;var J=ee.match(/^(.*?):\s*([^\s].*)$/);if(J)switch(J[1].toLowerCase()){case"content-location":D=J[2].trim();break;case"content-type":L=J[2].trim();break;case"content-transfer-encoding":O=J[2].trim();break}}switch(++te,O.toLowerCase()){case"base64":q=Yn(En(V.slice(te).join("")));break;case"quoted-printable":q=Li(V.slice(te));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+O)}var Y=Q(I,D.slice(N.length),q,{unsafe:!0});L&&(Y.ctype=L)}function so(I,V){if(G(I.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var N=V&&V.root||"",D=(Je&&Buffer.isBuffer(I)?I.toString("binary"):G(I)).split(`\r
`),O=0,L="";for(O=0;O<D.length;++O)if(L=D[O],!!/^Content-Location:/i.test(L)&&(L=L.slice(L.indexOf("file")),N||(N=L.slice(0,L.lastIndexOf("/")+1)),L.slice(0,N.length)!=N))for(;N.length>0&&(N=N.slice(0,N.length-1),N=N.slice(0,N.lastIndexOf("/")+1),L.slice(0,N.length)!=N););var q=(D[1]||"").match(/boundary="(.*?)"/);if(!q)throw new Error("MAD cannot find boundary");var te="--"+(q[1]||""),ee=[],J=[],Y={FileIndex:ee,FullPaths:J};g(Y);var le,ye=0;for(O=0;O<D.length;++O){var Ce=D[O];Ce!==te&&Ce!==te+"--"||(ye++&&An(Y,D.slice(le,O),N),le=O)}return Y}function Zt(I,V){var N=V||{},D=N.boundary||"SheetJS";D="------="+D;for(var O=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+D.slice(2)+'"',"","",""],L=I.FullPaths[0],q=L,te=I.FileIndex[0],ee=1;ee<I.FullPaths.length;++ee)if(q=I.FullPaths[ee].slice(L.length),te=I.FileIndex[ee],!(!te.size||!te.content||q=="Sh33tJ5")){q=q.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(De){return"_x"+De.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(De){return"_u"+De.charCodeAt(0).toString(16)+"_"});for(var J=te.content,Y=Je&&Buffer.isBuffer(J)?J.toString("binary"):G(J),le=0,ye=Math.min(1024,Y.length),Ce=0,me=0;me<=ye;++me)(Ce=Y.charCodeAt(me))>=32&&Ce<128&&++le;var we=le>=ye*4/5;O.push(D),O.push("Content-Location: "+(N.root||"file:///C:/SheetJS/")+q),O.push("Content-Transfer-Encoding: "+(we?"quoted-printable":"base64")),O.push("Content-Type: "+Sn(te,q)),O.push(""),O.push(we?Oi(Y):io(Y))}return O.push(D+`--\r
`),O.join(`\r
`)}function H(I){var V={};return g(V,I),V}function Q(I,V,N,D){var O=D&&D.unsafe;O||g(I);var L=!O&&tt.find(I,V);if(!L){var q=I.FullPaths[0];V.slice(0,q.length)==q?q=V:(q.slice(-1)!="/"&&(q+="/"),q=(q+V).replace("//","/")),L={name:i(V),type:2},I.FileIndex.push(L),I.FullPaths.push(q),O||tt.utils.cfb_gc(I)}return L.content=N,L.size=N?N.length:0,D&&(D.CLSID&&(L.clsid=D.CLSID),D.mt&&(L.mt=D.mt),D.ct&&(L.ct=D.ct)),L}function ne(I,V){g(I);var N=tt.find(I,V);if(N){for(var D=0;D<I.FileIndex.length;++D)if(I.FileIndex[D]==N)return I.FileIndex.splice(D,1),I.FullPaths.splice(D,1),!0}return!1}function de(I,V,N){g(I);var D=tt.find(I,V);if(D){for(var O=0;O<I.FileIndex.length;++O)if(I.FileIndex[O]==D)return I.FileIndex[O].name=i(N),I.FullPaths[O]=N,!0}return!1}function Ae(I){S(I,!0)}return e.find=F,e.read=j,e.parse=u,e.write=ue,e.writeFile=ie,e.utils={cfb_new:H,cfb_add:Q,cfb_del:ne,cfb_mov:de,cfb_gc:Ae,ReadShift:vc,CheckField:gA,prep_blob:vr,bconcat:Cs,use_zlib:B,_deflateRaw:Ve,_inflateRaw:Di,consts:oe},e}();function QL(t){if(typeof Deno<"u")return Deno.readFileSync(t);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var e=File(t);e.open("r"),e.encoding="binary";var r=e.read();return e.close(),r}catch(n){if(!n.message||!n.message.match(/onstruct/))throw n}throw new Error("Cannot access file "+t)}function ki(t){for(var e=Object.keys(t),r=[],n=0;n<e.length;++n)Object.prototype.hasOwnProperty.call(t,e[n])&&r.push(e[n]);return r}function Pv(t){for(var e=[],r=ki(t),n=0;n!==r.length;++n)e[t[r[n]]]=r[n];return e}var Gh=new Date(1899,11,30,0,0,0);function Yr(t,e){var r=t.getTime(),n=Gh.getTime()+(t.getTimezoneOffset()-Gh.getTimezoneOffset())*6e4;return(r-n)/(24*60*60*1e3)}var XS=new Date,JL=Gh.getTime()+(XS.getTimezoneOffset()-Gh.getTimezoneOffset())*6e4,Vy=XS.getTimezoneOffset();function $0(t){var e=new Date;return e.setTime(t*24*60*60*1e3+JL),e.getTimezoneOffset()!==Vy&&e.setTime(e.getTime()+(e.getTimezoneOffset()-Vy)*6e4),e}function ZL(t){var e=0,r=0,n=!1,i=t.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!i)throw new Error("|"+t+"| is not an ISO8601 Duration");for(var s=1;s!=i.length;++s)if(i[s]){switch(r=1,s>3&&(n=!0),i[s].slice(i[s].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+i[s].slice(i[s].length-1));case"D":r*=24;case"H":r*=60;case"M":if(n)r*=60;else throw new Error("Unsupported ISO Duration Field: M")}e+=r*parseInt(i[s],10)}return e}var Uy=new Date("2017-02-19T19:06:09.000Z"),YS=isNaN(Uy.getFullYear())?new Date("2/19/17"):Uy,eM=YS.getFullYear()==2017;function hr(t,e){var r=new Date(t);if(eM)return e>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):e<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(t instanceof Date)return t;if(YS.getFullYear()==1917&&!isNaN(r.getFullYear())){var n=r.getFullYear();return t.indexOf(""+n)>-1||r.setFullYear(r.getFullYear()+100),r}var i=t.match(/\d+/g)||["2017","2","19","0","0","0"],s=new Date(+i[0],+i[1]-1,+i[2],+i[3]||0,+i[4]||0,+i[5]||0);return t.indexOf("Z")>-1&&(s=new Date(s.getTime()-s.getTimezoneOffset()*60*1e3)),s}function ja(t,e){if(Je&&Buffer.isBuffer(t)){if(e){if(t[0]==255&&t[1]==254)return ec(t.slice(2).toString("utf16le"));if(t[1]==254&&t[2]==255)return ec(LS(t.slice(2).toString("binary")))}return t.toString("binary")}if(typeof TextDecoder<"u")try{if(e){if(t[0]==255&&t[1]==254)return ec(new TextDecoder("utf-16le").decode(t.slice(2)));if(t[0]==254&&t[1]==255)return ec(new TextDecoder("utf-16be").decode(t.slice(2)))}var r={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(t)&&(t=new Uint8Array(t)),new TextDecoder("latin1").decode(t).replace(/[]/g,function(s){return r[s]||s})}catch{}for(var n=[],i=0;i!=t.length;++i)n.push(String.fromCharCode(t[i]));return n.join("")}function wr(t){if(typeof JSON<"u"&&!Array.isArray(t))return JSON.parse(JSON.stringify(t));if(typeof t!="object"||t==null)return t;if(t instanceof Date)return new Date(t.getTime());var e={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=wr(t[r]));return e}function Ut(t,e){for(var r="";r.length<e;)r+=t;return r}function ni(t){var e=Number(t);if(!isNaN(e))return isFinite(e)?e:NaN;if(!/\d/.test(t))return e;var r=1,n=t.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(e=Number(n))||(n=n.replace(/[(](.*)[)]/,function(i,s){return r=-r,s}),!isNaN(e=Number(n)))?e/r:e}var tM=["january","february","march","april","may","june","july","august","september","october","november","december"];function ol(t){var e=new Date(t),r=new Date(NaN),n=e.getYear(),i=e.getMonth(),s=e.getDate();if(isNaN(s))return r;var a=t.toLowerCase();if(a.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(a=a.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),a.length>3&&tM.indexOf(a)==-1)return r}else if(a.match(/[a-z]/))return r;return n<0||n>8099?r:(i>0||s>1)&&n!=101?e:t.match(/[^-0-9:,\/\\]/)?r:e}var rM=function(){var t="abacaba".split(/(:?b)/i).length==5;return function(r,n,i){if(t||typeof n=="string")return r.split(n);for(var s=r.split(n),a=[s[0]],o=1;o<s.length;++o)a.push(i),a.push(s[o]);return a}}();function QS(t){return t?t.content&&t.type?ja(t.content,!0):t.data?Ql(t.data):t.asNodeBuffer&&Je?Ql(t.asNodeBuffer().toString("binary")):t.asBinary?Ql(t.asBinary()):t._data&&t._data.getContent?Ql(ja(Array.prototype.slice.call(t._data.getContent(),0))):null:null}function JS(t){if(!t)return null;if(t.data)return Iy(t.data);if(t.asNodeBuffer&&Je)return t.asNodeBuffer();if(t._data&&t._data.getContent){var e=t._data.getContent();return typeof e=="string"?Iy(e):Array.prototype.slice.call(e)}return t.content&&t.type?t.content:null}function nM(t){return t&&t.name.slice(-4)===".bin"?JS(t):QS(t)}function Nn(t,e){for(var r=t.FullPaths||ki(t.files),n=e.toLowerCase().replace(/[\/]/g,"\\"),i=n.replace(/\\/g,"/"),s=0;s<r.length;++s){var a=r[s].replace(/^Root Entry[\/]/,"").toLowerCase();if(n==a||i==a)return t.files?t.files[r[s]]:t.FileIndex[s]}return null}function Fv(t,e){var r=Nn(t,e);if(r==null)throw new Error("Cannot find file "+e+" in zip");return r}function Kt(t,e,r){if(!r)return nM(Fv(t,e));if(!e)return null;try{return Kt(t,e)}catch{return null}}function gn(t,e,r){if(!r)return QS(Fv(t,e));if(!e)return null;try{return gn(t,e)}catch{return null}}function iM(t,e,r){return JS(Fv(t,e))}function jy(t){for(var e=t.FullPaths||ki(t.files),r=[],n=0;n<e.length;++n)e[n].slice(-1)!="/"&&r.push(e[n].replace(/^Root Entry[\/]/,""));return r.sort()}function sM(t,e,r){if(t.FullPaths){if(typeof r=="string"){var n;return Je?n=Qa(r):n=kL(r),tt.utils.cfb_add(t,e,n)}tt.utils.cfb_add(t,e,r)}else t.file(e,r)}function ZS(t,e){switch(e.type){case"base64":return tt.read(t,{type:"base64"});case"binary":return tt.read(t,{type:"binary"});case"buffer":case"array":return tt.read(t,{type:"buffer"})}throw new Error("Unrecognized type "+e.type)}function Zl(t,e){if(t.charAt(0)=="/")return t.slice(1);var r=e.split("/");e.slice(-1)!="/"&&r.pop();for(var n=t.split("/");n.length!==0;){var i=n.shift();i===".."?r.pop():i!=="."&&r.push(i)}return r.join("/")}var eA=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,aM=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,By=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,oM=/<[^>]*>/g,zr=eA.match(By)?By:oM,lM=/<\w*:/,cM=/<(\/?)\w+:/;function Oe(t,e,r){for(var n={},i=0,s=0;i!==t.length&&!((s=t.charCodeAt(i))===32||s===10||s===13);++i);if(e||(n[0]=t.slice(0,i)),i===t.length)return n;var a=t.match(aM),o=0,l="",c=0,u="",h="",d=1;if(a)for(c=0;c!=a.length;++c){for(h=a[c],s=0;s!=h.length&&h.charCodeAt(s)!==61;++s);for(u=h.slice(0,s).trim();h.charCodeAt(s+1)==32;)++s;for(d=(i=h.charCodeAt(s+1))==34||i==39?1:0,l=h.slice(s+1+d,h.length-d),o=0;o!=u.length&&u.charCodeAt(o)!==58;++o);if(o===u.length)u.indexOf("_")>0&&(u=u.slice(0,u.indexOf("_"))),n[u]=l,n[u.toLowerCase()]=l;else{var p=(o===5&&u.slice(0,5)==="xmlns"?"xmlns":"")+u.slice(o+1);if(n[p]&&u.slice(o-3,o)=="ext")continue;n[p]=l,n[p.toLowerCase()]=l}}return n}function Ri(t){return t.replace(cM,"<$1")}var tA={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},uM=Pv(tA),at=function(){var t=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,e=/_x([\da-fA-F]{4})_/ig;return function r(n){var i=n+"",s=i.indexOf("<![CDATA[");if(s==-1)return i.replace(t,function(o,l){return tA[o]||String.fromCharCode(parseInt(l,o.indexOf("x")>-1?16:10))||o}).replace(e,function(o,l){return String.fromCharCode(parseInt(l,16))});var a=i.indexOf("]]>");return r(i.slice(0,s))+i.slice(s+9,a)+r(i.slice(a+3))}}(),fM=/[&<>'"]/g,hM=/[\u0000-\u001f]/g;function Dv(t){var e=t+"";return e.replace(fM,function(r){return uM[r]}).replace(/\n/g,"<br/>").replace(hM,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}var zy=function(){var t=/&#(\d+);/g;function e(r,n){return String.fromCharCode(parseInt(n,10))}return function(n){return n.replace(t,e)}}();function Nt(t){switch(t){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function jd(t){for(var e="",r=0,n=0,i=0,s=0,a=0,o=0;r<t.length;){if(n=t.charCodeAt(r++),n<128){e+=String.fromCharCode(n);continue}if(i=t.charCodeAt(r++),n>191&&n<224){a=(n&31)<<6,a|=i&63,e+=String.fromCharCode(a);continue}if(s=t.charCodeAt(r++),n<240){e+=String.fromCharCode((n&15)<<12|(i&63)<<6|s&63);continue}a=t.charCodeAt(r++),o=((n&7)<<18|(i&63)<<12|(s&63)<<6|a&63)-65536,e+=String.fromCharCode(55296+(o>>>10&1023)),e+=String.fromCharCode(56320+(o&1023))}return e}function $y(t){var e=Zs(2*t.length),r,n,i=1,s=0,a=0,o;for(n=0;n<t.length;n+=i)i=1,(o=t.charCodeAt(n))<128?r=o:o<224?(r=(o&31)*64+(t.charCodeAt(n+1)&63),i=2):o<240?(r=(o&15)*4096+(t.charCodeAt(n+1)&63)*64+(t.charCodeAt(n+2)&63),i=3):(i=4,r=(o&7)*262144+(t.charCodeAt(n+1)&63)*4096+(t.charCodeAt(n+2)&63)*64+(t.charCodeAt(n+3)&63),r-=65536,a=55296+(r>>>10&1023),r=56320+(r&1023)),a!==0&&(e[s++]=a&255,e[s++]=a>>>8,a=0),e[s++]=r%256,e[s++]=r>>>8;return e.slice(0,s).toString("ucs2")}function Hy(t){return Qa(t,"binary").toString("utf8")}var _f="foo bar baz",wt=Je&&(Hy(_f)==jd(_f)&&Hy||$y(_f)==jd(_f)&&$y)||jd,ec=Je?function(t){return Qa(t,"utf8").toString("binary")}:function(t){for(var e=[],r=0,n=0,i=0;r<t.length;)switch(n=t.charCodeAt(r++),!0){case n<128:e.push(String.fromCharCode(n));break;case n<2048:e.push(String.fromCharCode(192+(n>>6))),e.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,i=t.charCodeAt(r++)-56320+(n<<10),e.push(String.fromCharCode(240+(i>>18&7))),e.push(String.fromCharCode(144+(i>>12&63))),e.push(String.fromCharCode(128+(i>>6&63))),e.push(String.fromCharCode(128+(i&63)));break;default:e.push(String.fromCharCode(224+(n>>12))),e.push(String.fromCharCode(128+(n>>6&63))),e.push(String.fromCharCode(128+(n&63)))}return e.join("")},nu=function(){var t={};return function(r,n){var i=r+"|"+(n||"");return t[i]?t[i]:t[i]=new RegExp("<(?:\\w+:)?"+r+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+r+">",n||"")}}(),rA=function(){var t=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(e){return[new RegExp("&"+e[0]+";","ig"),e[1]]});return function(r){for(var n=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),i=0;i<t.length;++i)n=n.replace(t[i][0],t[i][1]);return n}}(),dM=function(){var t={};return function(r){return t[r]!==void 0?t[r]:t[r]=new RegExp("<(?:vt:)?"+r+">([\\s\\S]*?)</(?:vt:)?"+r+">","g")}}(),pM=/<\/?(?:vt:)?variant>/g,mM=/<(?:vt:)([^>]*)>([\s\S]*)</;function Wy(t,e){var r=Oe(t),n=t.match(dM(r.baseType))||[],i=[];if(n.length!=r.size){if(e.WTF)throw new Error("unexpected vector length "+n.length+" != "+r.size);return i}return n.forEach(function(s){var a=s.replace(pM,"").match(mM);a&&i.push({v:wt(a[2]),t:a[1]})}),i}var gM=/(^\s|\s$|\n)/;function vM(t){return ki(t).map(function(e){return" "+e+'="'+t[e]+'"'}).join("")}function xM(t,e,r){return"<"+t+(r!=null?vM(r):"")+(e!=null?(e.match(gM)?' xml:space="preserve"':"")+">"+e+"</"+t:"/")+">"}function bv(t){if(Je&&Buffer.isBuffer(t))return t.toString("utf8");if(typeof t=="string")return t;if(typeof Uint8Array<"u"&&t instanceof Uint8Array)return wt(Ja(Cv(t)));throw new Error("Bad input format: expected Buffer or string")}var iu=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,_M={CT:"http://schemas.openxmlformats.org/package/2006/content-types"},yM=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"];function wM(t,e){for(var r=1-2*(t[e+7]>>>7),n=((t[e+7]&127)<<4)+(t[e+6]>>>4&15),i=t[e+6]&15,s=5;s>=0;--s)i=i*256+t[e+s];return n==2047?i==0?r*(1/0):NaN:(n==0?n=-1022:(n-=1023,i+=Math.pow(2,52)),r*Math.pow(2,n-52)*i)}function EM(t,e,r){var n=(e<0||1/e==-1/0?1:0)<<7,i=0,s=0,a=n?-e:e;isFinite(a)?a==0?i=s=0:(i=Math.floor(Math.log(a)/Math.LN2),s=a*Math.pow(2,52-i),i<=-1023&&(!isFinite(s)||s<Math.pow(2,52))?i=-1022:(s-=Math.pow(2,52),i+=1023)):(i=2047,s=isNaN(e)?26985:0);for(var o=0;o<=5;++o,s/=256)t[r+o]=s&255;t[r+6]=(i&15)<<4|s&15,t[r+7]=i>>4|n}var Gy=function(t){for(var e=[],r=10240,n=0;n<t[0].length;++n)if(t[0][n])for(var i=0,s=t[0][n].length;i<s;i+=r)e.push.apply(e,t[0][n].slice(i,i+r));return e},Ky=Je?function(t){return t[0].length>0&&Buffer.isBuffer(t[0][0])?Buffer.concat(t[0].map(function(e){return Buffer.isBuffer(e)?e:Qa(e)})):Gy(t)}:Gy,qy=function(t,e,r){for(var n=[],i=e;i<r;i+=2)n.push(String.fromCharCode(Ki(t,i)));return n.join("").replace(Xr,"")},Ov=Je?function(t,e,r){return Buffer.isBuffer(t)?t.toString("utf16le",e,r).replace(Xr,""):qy(t,e,r)}:qy,Xy=function(t,e,r){for(var n=[],i=e;i<e+r;++i)n.push(("0"+t[i].toString(16)).slice(-2));return n.join("")},nA=Je?function(t,e,r){return Buffer.isBuffer(t)?t.toString("hex",e,e+r):Xy(t,e,r)}:Xy,Yy=function(t,e,r){for(var n=[],i=e;i<r;i++)n.push(String.fromCharCode(vo(t,i)));return n.join("")},Ru=Je?function(e,r,n){return Buffer.isBuffer(e)?e.toString("utf8",r,n):Yy(e,r,n)}:Yy,iA=function(t,e){var r=mn(t,e);return r>0?Ru(t,e+4,e+4+r-1):""},sA=iA,aA=function(t,e){var r=mn(t,e);return r>0?Ru(t,e+4,e+4+r-1):""},oA=aA,lA=function(t,e){var r=2*mn(t,e);return r>0?Ru(t,e+4,e+4+r-1):""},cA=lA,uA=function(e,r){var n=mn(e,r);return n>0?Ov(e,r+4,r+4+n):""},fA=uA,hA=function(t,e){var r=mn(t,e);return r>0?Ru(t,e+4,e+4+r):""},dA=hA,pA=function(t,e){return wM(t,e)},Kh=pA,mA=function(e){return Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array};Je&&(sA=function(e,r){if(!Buffer.isBuffer(e))return iA(e,r);var n=e.readUInt32LE(r);return n>0?e.toString("utf8",r+4,r+4+n-1):""},oA=function(e,r){if(!Buffer.isBuffer(e))return aA(e,r);var n=e.readUInt32LE(r);return n>0?e.toString("utf8",r+4,r+4+n-1):""},cA=function(e,r){if(!Buffer.isBuffer(e))return lA(e,r);var n=2*e.readUInt32LE(r);return e.toString("utf16le",r+4,r+4+n-1)},fA=function(e,r){if(!Buffer.isBuffer(e))return uA(e,r);var n=e.readUInt32LE(r);return e.toString("utf16le",r+4,r+4+n)},dA=function(e,r){if(!Buffer.isBuffer(e))return hA(e,r);var n=e.readUInt32LE(r);return e.toString("utf8",r+4,r+4+n)},Kh=function(e,r){return Buffer.isBuffer(e)?e.readDoubleLE(r):pA(e,r)},mA=function(e){return Buffer.isBuffer(e)||Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array});var vo=function(t,e){return t[e]},Ki=function(t,e){return t[e+1]*256+t[e]},TM=function(t,e){var r=t[e+1]*256+t[e];return r<32768?r:(65535-r+1)*-1},mn=function(t,e){return t[e+3]*(1<<24)+(t[e+2]<<16)+(t[e+1]<<8)+t[e]},pa=function(t,e){return t[e+3]<<24|t[e+2]<<16|t[e+1]<<8|t[e]},kM=function(t,e){return t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3]};function vc(t,e){var r="",n,i,s=[],a,o,l,c;switch(e){case"dbcs":if(c=this.l,Je&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*t).toString("utf16le");else for(l=0;l<t;++l)r+=String.fromCharCode(Ki(this,c)),c+=2;t*=2;break;case"utf8":r=Ru(this,this.l,this.l+t);break;case"utf16le":t*=2,r=Ov(this,this.l,this.l+t);break;case"wstr":return vc.call(this,t,"dbcs");case"lpstr-ansi":r=sA(this,this.l),t=4+mn(this,this.l);break;case"lpstr-cp":r=oA(this,this.l),t=4+mn(this,this.l);break;case"lpwstr":r=cA(this,this.l),t=4+2*mn(this,this.l);break;case"lpp4":t=4+mn(this,this.l),r=fA(this,this.l),t&2&&(t+=2);break;case"8lpp4":t=4+mn(this,this.l),r=dA(this,this.l),t&3&&(t+=4-(t&3));break;case"cstr":for(t=0,r="";(a=vo(this,this.l+t++))!==0;)s.push(xf(a));r=s.join("");break;case"_wstr":for(t=0,r="";(a=Ki(this,this.l+t))!==0;)s.push(xf(a)),t+=2;t+=2,r=s.join("");break;case"dbcs-cont":for(r="",c=this.l,l=0;l<t;++l){if(this.lens&&this.lens.indexOf(c)!==-1)return a=vo(this,c),this.l=c+1,o=vc.call(this,t-l,a?"dbcs-cont":"sbcs-cont"),s.join("")+o;s.push(xf(Ki(this,c))),c+=2}r=s.join(""),t*=2;break;case"cpstr":case"sbcs-cont":for(r="",c=this.l,l=0;l!=t;++l){if(this.lens&&this.lens.indexOf(c)!==-1)return a=vo(this,c),this.l=c+1,o=vc.call(this,t-l,a?"dbcs-cont":"sbcs-cont"),s.join("")+o;s.push(xf(vo(this,c))),c+=1}r=s.join("");break;default:switch(t){case 1:return n=vo(this,this.l),this.l++,n;case 2:return n=(e==="i"?TM:Ki)(this,this.l),this.l+=2,n;case 4:case-4:return e==="i"||!(this[this.l+3]&128)?(n=(t>0?pa:kM)(this,this.l),this.l+=4,n):(i=mn(this,this.l),this.l+=4,i);case 8:case-8:if(e==="f")return t==8?i=Kh(this,this.l):i=Kh([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,i;t=8;case 16:r=nA(this,this.l,t);break}}return this.l+=t,r}var SM=function(t,e,r){t[r]=e&255,t[r+1]=e>>>8&255,t[r+2]=e>>>16&255,t[r+3]=e>>>24&255},AM=function(t,e,r){t[r]=e&255,t[r+1]=e>>8&255,t[r+2]=e>>16&255,t[r+3]=e>>24&255},IM=function(t,e,r){t[r]=e&255,t[r+1]=e>>>8&255};function CM(t,e,r){var n=0,i=0;if(r==="dbcs"){for(i=0;i!=e.length;++i)IM(this,e.charCodeAt(i),this.l+2*i);n=2*e.length}else if(r==="sbcs"){for(e=e.replace(/[^\x00-\x7F]/g,"_"),i=0;i!=e.length;++i)this[this.l+i]=e.charCodeAt(i)&255;n=e.length}else if(r==="hex"){for(;i<t;++i)this[this.l++]=parseInt(e.slice(2*i,2*i+2),16)||0;return this}else if(r==="utf16le"){var s=Math.min(this.l+t,this.length);for(i=0;i<Math.min(e.length,t);++i){var a=e.charCodeAt(i);this[this.l++]=a&255,this[this.l++]=a>>8}for(;this.l<s;)this[this.l++]=0;return this}else switch(t){case 1:n=1,this[this.l]=e&255;break;case 2:n=2,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255;break;case 3:n=3,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255,e>>>=8,this[this.l+2]=e&255;break;case 4:n=4,SM(this,e,this.l);break;case 8:if(n=8,r==="f"){EM(this,e,this.l);break}case 16:break;case-4:n=4,AM(this,e,this.l);break}return this.l+=n,this}function gA(t,e){var r=nA(this,this.l,t.length>>1);if(r!==t)throw new Error(e+"Expected "+t+" saw "+r);this.l+=t.length>>1}function vr(t,e){t.l=e,t.read_shift=vc,t.chk=gA,t.write_shift=CM}function Br(t,e){t.l+=e}function er(t){var e=Zs(t);return vr(e,0),e}function ds(t,e,r){if(t){var n,i,s;vr(t,t.l||0);for(var a=t.length,o=0,l=0;t.l<a;){o=t.read_shift(1),o&128&&(o=(o&127)+((t.read_shift(1)&127)<<7));var c=Zh[o]||Zh[65535];for(n=t.read_shift(1),s=n&127,i=1;i<4&&n&128;++i)s+=((n=t.read_shift(1))&127)<<7*i;l=t.l+s;var u=c.f&&c.f(t,s,r);if(t.l=l,e(u,c,o))return}}}function _m(){var t=[],e=Je?256:2048,r=function(c){var u=er(c);return vr(u,0),u},n=r(e),i=function(){n&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&t.push(n),n=null)},s=function(c){return n&&c<n.length-n.l?n:(i(),n=r(Math.max(c+1,e)))},a=function(){return i(),Cs(t)},o=function(c){i(),n=c,n.l==null&&(n.l=n.length),s(e)};return{next:s,push:o,end:a,_bufs:t}}function xc(t,e,r){var n=wr(t);if(e.s?(n.cRel&&(n.c+=e.s.c),n.rRel&&(n.r+=e.s.r)):(n.cRel&&(n.c+=e.c),n.rRel&&(n.r+=e.r)),!r||r.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function Qy(t,e,r){var n=wr(t);return n.s=xc(n.s,e.s,r),n.e=xc(n.e,e.s,r),n}function _c(t,e){if(t.cRel&&t.c<0)for(t=wr(t);t.c<0;)t.c+=e>8?16384:256;if(t.rRel&&t.r<0)for(t=wr(t);t.r<0;)t.r+=e>8?1048576:e>5?65536:16384;var r=je(t);return!t.cRel&&t.cRel!=null&&(r=PM(r)),!t.rRel&&t.rRel!=null&&(r=RM(r)),r}function Bd(t,e){return t.s.r==0&&!t.s.rRel&&t.e.r==(e.biff>=12?1048575:e.biff>=8?65536:16384)&&!t.e.rRel?(t.s.cRel?"":"$")+nr(t.s.c)+":"+(t.e.cRel?"":"$")+nr(t.e.c):t.s.c==0&&!t.s.cRel&&t.e.c==(e.biff>=12?16383:255)&&!t.e.cRel?(t.s.rRel?"":"$")+Er(t.s.r)+":"+(t.e.rRel?"":"$")+Er(t.e.r):_c(t.s,e.biff)+":"+_c(t.e,e.biff)}function Lv(t){return parseInt(NM(t),10)-1}function Er(t){return""+(t+1)}function RM(t){return t.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function NM(t){return t.replace(/\$(\d+)$/,"$1")}function Mv(t){for(var e=FM(t),r=0,n=0;n!==e.length;++n)r=26*r+e.charCodeAt(n)-64;return r-1}function nr(t){if(t<0)throw new Error("invalid column "+t);var e="";for(++t;t;t=Math.floor((t-1)/26))e=String.fromCharCode((t-1)%26+65)+e;return e}function PM(t){return t.replace(/^([A-Z])/,"$$$1")}function FM(t){return t.replace(/^\$([A-Z])/,"$1")}function DM(t){return t.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function Gr(t){for(var e=0,r=0,n=0;n<t.length;++n){var i=t.charCodeAt(n);i>=48&&i<=57?e=10*e+(i-48):i>=65&&i<=90&&(r=26*r+(i-64))}return{c:r-1,r:e-1}}function je(t){for(var e=t.c+1,r="";e;e=(e-1)/26|0)r=String.fromCharCode((e-1)%26+65)+r;return r+(t.r+1)}function _l(t){var e=t.indexOf(":");return e==-1?{s:Gr(t),e:Gr(t)}:{s:Gr(t.slice(0,e)),e:Gr(t.slice(e+1))}}function rt(t,e){return typeof e>"u"||typeof e=="number"?rt(t.s,t.e):(typeof t!="string"&&(t=je(t)),typeof e!="string"&&(e=je(e)),t==e?t:t+":"+e)}function jt(t){var e={s:{c:0,r:0},e:{c:0,r:0}},r=0,n=0,i=0,s=t.length;for(r=0;n<s&&!((i=t.charCodeAt(n)-64)<1||i>26);++n)r=26*r+i;for(e.s.c=--r,r=0;n<s&&!((i=t.charCodeAt(n)-48)<0||i>9);++n)r=10*r+i;if(e.s.r=--r,n===s||i!=10)return e.e.c=e.s.c,e.e.r=e.s.r,e;for(++n,r=0;n!=s&&!((i=t.charCodeAt(n)-64)<1||i>26);++n)r=26*r+i;for(e.e.c=--r,r=0;n!=s&&!((i=t.charCodeAt(n)-48)<0||i>9);++n)r=10*r+i;return e.e.r=--r,e}function Jy(t,e){var r=t.t=="d"&&e instanceof Date;if(t.z!=null)try{return t.w=Un(t.z,r?Yr(e):e)}catch{}try{return t.w=Un((t.XF||{}).numFmtId||(r?14:0),r?Yr(e):e)}catch{return""+e}}function cs(t,e,r){return t==null||t.t==null||t.t=="z"?"":t.w!==void 0?t.w:(t.t=="d"&&!t.z&&r&&r.dateNF&&(t.z=r.dateNF),t.t=="e"?to[t.v]||t.v:e==null?Jy(t,t.v):Jy(t,e))}function aa(t,e){var r=e&&e.sheet?e.sheet:"Sheet1",n={};return n[r]=t,{SheetNames:[r],Sheets:n}}function vA(t,e,r){var n=r||{},i=t?Array.isArray(t):n.dense,s=t||(i?[]:{}),a=0,o=0;if(s&&n.origin!=null){if(typeof n.origin=="number")a=n.origin;else{var l=typeof n.origin=="string"?Gr(n.origin):n.origin;a=l.r,o=l.c}s["!ref"]||(s["!ref"]="A1:A1")}var c={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(s["!ref"]){var u=jt(s["!ref"]);c.s.c=u.s.c,c.s.r=u.s.r,c.e.c=Math.max(c.e.c,u.e.c),c.e.r=Math.max(c.e.r,u.e.r),a==-1&&(c.e.r=a=u.e.r+1)}for(var h=0;h!=e.length;++h)if(e[h]){if(!Array.isArray(e[h]))throw new Error("aoa_to_sheet expects an array of arrays");for(var d=0;d!=e[h].length;++d)if(!(typeof e[h][d]>"u")){var p={v:e[h][d]},x=a+h,v=o+d;if(c.s.r>x&&(c.s.r=x),c.s.c>v&&(c.s.c=v),c.e.r<x&&(c.e.r=x),c.e.c<v&&(c.e.c=v),e[h][d]&&typeof e[h][d]=="object"&&!Array.isArray(e[h][d])&&!(e[h][d]instanceof Date))p=e[h][d];else if(Array.isArray(p.v)&&(p.f=e[h][d][1],p.v=p.v[0]),p.v===null)if(p.f)p.t="n";else if(n.nullError)p.t="e",p.v=0;else if(n.sheetStubs)p.t="z";else continue;else typeof p.v=="number"?p.t="n":typeof p.v=="boolean"?p.t="b":p.v instanceof Date?(p.z=n.dateNF||ze[14],n.cellDates?(p.t="d",p.w=Un(p.z,Yr(p.v))):(p.t="n",p.v=Yr(p.v),p.w=Un(p.z,p.v))):p.t="s";if(i)s[x]||(s[x]=[]),s[x][v]&&s[x][v].z&&(p.z=s[x][v].z),s[x][v]=p;else{var E=je({c:v,r:x});s[E]&&s[E].z&&(p.z=s[E].z),s[E]=p}}}return c.s.c<1e7&&(s["!ref"]=rt(c)),s}function yl(t,e){return vA(null,t,e)}function bM(t){return t.read_shift(4,"i")}function Vr(t){var e=t.read_shift(4);return e===0?"":t.read_shift(e,"dbcs")}function OM(t){return{ich:t.read_shift(2),ifnt:t.read_shift(2)}}function Vv(t,e){var r=t.l,n=t.read_shift(1),i=Vr(t),s=[],a={t:i,h:i};if(n&1){for(var o=t.read_shift(4),l=0;l!=o;++l)s.push(OM(t));a.r=s}else a.r=[{ich:0,ifnt:0}];return t.l=r+e,a}var LM=Vv;function jn(t){var e=t.read_shift(4),r=t.read_shift(2);return r+=t.read_shift(1)<<16,t.l++,{c:e,iStyleRef:r}}function Za(t){var e=t.read_shift(2);return e+=t.read_shift(1)<<16,t.l++,{c:-1,iStyleRef:e}}var MM=Vr;function Uv(t){var e=t.read_shift(4);return e===0||e===4294967295?"":t.read_shift(e,"dbcs")}var VM=Vr,ym=Uv;function jv(t){var e=t.slice(t.l,t.l+4),r=e[0]&1,n=e[0]&2;t.l+=4;var i=n===0?Kh([0,0,0,0,e[0]&252,e[1],e[2],e[3]],0):pa(e,0)>>2;return r?i/100:i}function xA(t){var e={s:{},e:{}};return e.s.r=t.read_shift(4),e.e.r=t.read_shift(4),e.s.c=t.read_shift(4),e.e.c=t.read_shift(4),e}var eo=xA;function Lr(t){if(t.length-t.l<8)throw"XLS Xnum Buffer underflow";return t.read_shift(8,"f")}function UM(t){var e={},r=t.read_shift(1),n=r>>>1,i=t.read_shift(1),s=t.read_shift(2,"i"),a=t.read_shift(1),o=t.read_shift(1),l=t.read_shift(1);switch(t.l++,n){case 0:e.auto=1;break;case 1:e.index=i;var c=Ia[i];c&&(e.rgb=au(c));break;case 2:e.rgb=au([a,o,l]);break;case 3:e.theme=i;break}return s!=0&&(e.tint=s>0?s/32767:s/32768),e}function jM(t){var e=t.read_shift(1);t.l++;var r={fBold:e&1,fItalic:e&2,fUnderline:e&4,fStrikeout:e&8,fOutline:e&16,fShadow:e&32,fCondense:e&64,fExtend:e&128};return r}function _A(t,e){var r={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},n=t.read_shift(4);switch(n){case 0:return"";case 4294967295:case 4294967294:return r[t.read_shift(4)]||""}if(n>400)throw new Error("Unsupported Clipboard: "+n.toString(16));return t.l-=4,t.read_shift(0,e==1?"lpstr":"lpwstr")}function BM(t){return _A(t,1)}function zM(t){return _A(t,2)}var Bv=2,nn=3,yf=11,Zy=12,qh=19,wf=64,$M=65,HM=71,WM=4108,GM=4126,cr=80,yA=81,KM=[cr,yA],qM={1:{n:"CodePage",t:Bv},2:{n:"Category",t:cr},3:{n:"PresentationFormat",t:cr},4:{n:"ByteCount",t:nn},5:{n:"LineCount",t:nn},6:{n:"ParagraphCount",t:nn},7:{n:"SlideCount",t:nn},8:{n:"NoteCount",t:nn},9:{n:"HiddenCount",t:nn},10:{n:"MultimediaClipCount",t:nn},11:{n:"ScaleCrop",t:yf},12:{n:"HeadingPairs",t:WM},13:{n:"TitlesOfParts",t:GM},14:{n:"Manager",t:cr},15:{n:"Company",t:cr},16:{n:"LinksUpToDate",t:yf},17:{n:"CharacterCount",t:nn},19:{n:"SharedDoc",t:yf},22:{n:"HyperlinksChanged",t:yf},23:{n:"AppVersion",t:nn,p:"version"},24:{n:"DigSig",t:$M},26:{n:"ContentType",t:cr},27:{n:"ContentStatus",t:cr},28:{n:"Language",t:cr},29:{n:"Version",t:cr},255:{},2147483648:{n:"Locale",t:qh},2147483651:{n:"Behavior",t:qh},1919054434:{}},XM={1:{n:"CodePage",t:Bv},2:{n:"Title",t:cr},3:{n:"Subject",t:cr},4:{n:"Author",t:cr},5:{n:"Keywords",t:cr},6:{n:"Comments",t:cr},7:{n:"Template",t:cr},8:{n:"LastAuthor",t:cr},9:{n:"RevNumber",t:cr},10:{n:"EditTime",t:wf},11:{n:"LastPrinted",t:wf},12:{n:"CreatedDate",t:wf},13:{n:"ModifiedDate",t:wf},14:{n:"PageCount",t:nn},15:{n:"WordCount",t:nn},16:{n:"CharCount",t:nn},17:{n:"Thumbnail",t:HM},18:{n:"Application",t:cr},19:{n:"DocSecurity",t:nn},255:{},2147483648:{n:"Locale",t:qh},2147483651:{n:"Behavior",t:qh},1919054434:{}},ew={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},YM=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function QM(t){return t.map(function(e){return[e>>16&255,e>>8&255,e&255]})}var JM=QM([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Ia=wr(JM),to={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},wA={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},tw={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"};function ZM(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function e8(t){var e=ZM();if(!t||!t.match)return e;var r={};if((t.match(zr)||[]).forEach(function(n){var i=Oe(n);switch(i[0].replace(lM,"<")){case"<?xml":break;case"<Types":e.xmlns=i["xmlns"+(i[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":r[i.Extension]=i.ContentType;break;case"<Override":e[tw[i.ContentType]]!==void 0&&e[tw[i.ContentType]].push(i.PartName);break}}),e.xmlns!==_M.CT)throw new Error("Unknown Namespace: "+e.xmlns);return e.calcchain=e.calcchains.length>0?e.calcchains[0]:"",e.sst=e.strs.length>0?e.strs[0]:"",e.style=e.styles.length>0?e.styles[0]:"",e.defaults=r,delete e.calcchains,e}var No={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function wm(t){var e=t.lastIndexOf("/");return t.slice(0,e+1)+"_rels/"+t.slice(e+1)+".rels"}function yc(t,e){var r={"!id":{}};if(!t)return r;e.charAt(0)!=="/"&&(e="/"+e);var n={};return(t.match(zr)||[]).forEach(function(i){var s=Oe(i);if(s[0]==="<Relationship"){var a={};a.Type=s.Type,a.Target=s.Target,a.Id=s.Id,s.TargetMode&&(a.TargetMode=s.TargetMode);var o=s.TargetMode==="External"?s.Target:Zl(s.Target,e);r[o]=a,n[s.Id]=a}}),r["!id"]=n,r}var t8="application/vnd.oasis.opendocument.spreadsheet";function r8(t,e){for(var r=bv(t),n,i;n=iu.exec(r);)switch(n[3]){case"manifest":break;case"file-entry":if(i=Oe(n[0],!1),i.path=="/"&&i.type!==t8)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(e&&e.WTF)throw n}}var wc=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],n8=function(){for(var t=new Array(wc.length),e=0;e<wc.length;++e){var r=wc[e],n="(?:"+r[0].slice(0,r[0].indexOf(":"))+":)"+r[0].slice(r[0].indexOf(":")+1);t[e]=new RegExp("<"+n+"[^>]*>([\\s\\S]*?)</"+n+">")}return t}();function EA(t){var e={};t=wt(t);for(var r=0;r<wc.length;++r){var n=wc[r],i=t.match(n8[r]);i!=null&&i.length>0&&(e[n[1]]=at(i[1])),n[2]==="date"&&e[n[1]]&&(e[n[1]]=hr(e[n[1]]))}return e}var i8=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]];function TA(t,e,r,n){var i=[];if(typeof t=="string")i=Wy(t,n);else for(var s=0;s<t.length;++s)i=i.concat(t[s].map(function(u){return{v:u}}));var a=typeof e=="string"?Wy(e,n).map(function(u){return u.v}):e,o=0,l=0;if(a.length>0)for(var c=0;c!==i.length;c+=2){switch(l=+i[c+1].v,i[c].v){case"Worksheets":case"":case"":case" ":case"":case" ":case"Arbeitsbltter":case"alma Sayfalar":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de clculo":case"Planilhas":case"Regneark":case"Hojas de clculo":case"Werkbladen":r.Worksheets=l,r.SheetNames=a.slice(o,o+l);break;case"Named Ranges":case"Rangos con nombre":case"":case"Benannte Bereiche":case"Navngivne omrder":r.NamedRanges=l,r.DefinedNames=a.slice(o,o+l);break;case"Charts":case"Diagramme":r.Chartsheets=l,r.ChartNames=a.slice(o,o+l);break}o+=l}}function s8(t,e,r){var n={};return e||(e={}),t=wt(t),i8.forEach(function(i){var s=(t.match(nu(i[0]))||[])[1];switch(i[2]){case"string":s&&(e[i[1]]=at(s));break;case"bool":e[i[1]]=s==="true";break;case"raw":var a=t.match(new RegExp("<"+i[0]+"[^>]*>([\\s\\S]*?)</"+i[0]+">"));a&&a.length>0&&(n[i[1]]=a[1]);break}}),n.HeadingPairs&&n.TitlesOfParts&&TA(n.HeadingPairs,n.TitlesOfParts,e,r),e}var a8=/<[^>]+>[^<]*/g;function o8(t,e){var r={},n="",i=t.match(a8);if(i)for(var s=0;s!=i.length;++s){var a=i[s],o=Oe(a);switch(o[0]){case"<?xml":break;case"<Properties":break;case"<property":n=at(o.name);break;case"</property>":n=null;break;default:if(a.indexOf("<vt:")===0){var l=a.split(">"),c=l[0].slice(4),u=l[1];switch(c){case"lpstr":case"bstr":case"lpwstr":r[n]=at(u);break;case"bool":r[n]=Nt(u);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":r[n]=parseInt(u,10);break;case"r4":case"r8":case"decimal":r[n]=parseFloat(u);break;case"filetime":case"date":r[n]=hr(u);break;case"cy":case"error":r[n]=at(u);break;default:if(c.slice(-1)=="/")break;e.WTF&&typeof console<"u"&&console.warn("Unexpected",a,c,l)}}else if(a.slice(0,2)!=="</"){if(e.WTF)throw new Error(a)}}}return r}var l8={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},zd;function c8(t,e,r){zd||(zd=Pv(l8)),e=zd[e]||e,t[e]=r}function zv(t){var e=t.read_shift(4),r=t.read_shift(4);return new Date((r/1e7*Math.pow(2,32)+e/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function kA(t,e,r){var n=t.l,i=t.read_shift(0,"lpstr-cp");if(r)for(;t.l-n&3;)++t.l;return i}function SA(t,e,r){var n=t.read_shift(0,"lpwstr");return n}function AA(t,e,r){return e===31?SA(t):kA(t,e,r)}function Em(t,e,r){return AA(t,e,r===!1?0:4)}function u8(t,e){if(!e)throw new Error("VtUnalignedString must have positive length");return AA(t,e,0)}function f8(t){for(var e=t.read_shift(4),r=[],n=0;n!=e;++n){var i=t.l;r[n]=t.read_shift(0,"lpwstr").replace(Xr,""),t.l-i&2&&(t.l+=2)}return r}function h8(t){for(var e=t.read_shift(4),r=[],n=0;n!=e;++n)r[n]=t.read_shift(0,"lpstr-cp").replace(Xr,"");return r}function d8(t){var e=t.l,r=Xh(t,yA);t[t.l]==0&&t[t.l+1]==0&&t.l-e&2&&(t.l+=2);var n=Xh(t,nn);return[r,n]}function p8(t){for(var e=t.read_shift(4),r=[],n=0;n<e/2;++n)r.push(d8(t));return r}function rw(t,e){for(var r=t.read_shift(4),n={},i=0;i!=r;++i){var s=t.read_shift(4),a=t.read_shift(4);n[s]=t.read_shift(a,e===1200?"utf16le":"utf8").replace(Xr,"").replace(Jl,"!"),e===1200&&a%2&&(t.l+=2)}return t.l&3&&(t.l=t.l>>3<<2),n}function IA(t){var e=t.read_shift(4),r=t.slice(t.l,t.l+e);return t.l+=e,(e&3)>0&&(t.l+=4-(e&3)&3),r}function m8(t){var e={};return e.Size=t.read_shift(4),t.l+=e.Size+3-(e.Size-1)%4,e}function Xh(t,e,r){var n=t.read_shift(2),i,s=r||{};if(t.l+=2,e!==Zy&&n!==e&&KM.indexOf(e)===-1&&!((e&65534)==4126&&(n&65534)==4126))throw new Error("Expected type "+e+" saw "+n);switch(e===Zy?n:e){case 2:return i=t.read_shift(2,"i"),s.raw||(t.l+=2),i;case 3:return i=t.read_shift(4,"i"),i;case 11:return t.read_shift(4)!==0;case 19:return i=t.read_shift(4),i;case 30:return kA(t,n,4).replace(Xr,"");case 31:return SA(t);case 64:return zv(t);case 65:return IA(t);case 71:return m8(t);case 80:return Em(t,n,!s.raw).replace(Xr,"");case 81:return u8(t,n).replace(Xr,"");case 4108:return p8(t);case 4126:case 4127:return n==4127?f8(t):h8(t);default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+n)}}function nw(t,e){var r=t.l,n=t.read_shift(4),i=t.read_shift(4),s=[],a=0,o=0,l=-1,c={};for(a=0;a!=i;++a){var u=t.read_shift(4),h=t.read_shift(4);s[a]=[u,h+r]}s.sort(function(w,y){return w[1]-y[1]});var d={};for(a=0;a!=i;++a){if(t.l!==s[a][1]){var p=!0;if(a>0&&e)switch(e[s[a-1][0]].t){case 2:t.l+2===s[a][1]&&(t.l+=2,p=!1);break;case 80:t.l<=s[a][1]&&(t.l=s[a][1],p=!1);break;case 4108:t.l<=s[a][1]&&(t.l=s[a][1],p=!1);break}if((!e||a==0)&&t.l<=s[a][1]&&(p=!1,t.l=s[a][1]),p)throw new Error("Read Error: Expected address "+s[a][1]+" at "+t.l+" :"+a)}if(e){var x=e[s[a][0]];if(d[x.n]=Xh(t,x.t,{raw:!0}),x.p==="version"&&(d[x.n]=String(d[x.n]>>16)+"."+("0000"+String(d[x.n]&65535)).slice(-4)),x.n=="CodePage")switch(d[x.n]){case 0:d[x.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:Jn(o=d[x.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+d[x.n])}}else if(s[a][0]===1){if(o=d.CodePage=Xh(t,Bv),Jn(o),l!==-1){var v=t.l;t.l=s[l][1],c=rw(t,o),t.l=v}}else if(s[a][0]===0){if(o===0){l=a,t.l=s[a+1][1];continue}c=rw(t,o)}else{var E=c[s[a][0]],T;switch(t[t.l]){case 65:t.l+=4,T=IA(t);break;case 30:t.l+=4,T=Em(t,t[t.l-4]).replace(/\u0000+$/,"");break;case 31:t.l+=4,T=Em(t,t[t.l-4]).replace(/\u0000+$/,"");break;case 3:t.l+=4,T=t.read_shift(4,"i");break;case 19:t.l+=4,T=t.read_shift(4);break;case 5:t.l+=4,T=t.read_shift(8,"f");break;case 11:t.l+=4,T=Bt(t,4);break;case 64:t.l+=4,T=hr(zv(t));break;default:throw new Error("unparsed value: "+t[t.l])}d[E]=T}}return t.l=r+n,d}function iw(t,e,r){var n=t.content;if(!n)return{};vr(n,0);var i,s,a,o,l=0;n.chk("feff","Byte Order: "),n.read_shift(2);var c=n.read_shift(4),u=n.read_shift(16);if(u!==tt.utils.consts.HEADER_CLSID&&u!==r)throw new Error("Bad PropertySet CLSID "+u);if(i=n.read_shift(4),i!==1&&i!==2)throw new Error("Unrecognized #Sets: "+i);if(s=n.read_shift(16),o=n.read_shift(4),i===1&&o!==n.l)throw new Error("Length mismatch: "+o+" !== "+n.l);i===2&&(a=n.read_shift(16),l=n.read_shift(4));var h=nw(n,e),d={SystemIdentifier:c};for(var p in h)d[p]=h[p];if(d.FMTID=s,i===1)return d;if(l-n.l==2&&(n.l+=2),n.l!==l)throw new Error("Length mismatch 2: "+n.l+" !== "+l);var x;try{x=nw(n,null)}catch{}for(p in x)d[p]=x[p];return d.FMTID=[s,a],d}function _s(t,e){return t.read_shift(e),null}function g8(t,e,r){for(var n=[],i=t.l+e;t.l<i;)n.push(r(t,i-t.l));if(i!==t.l)throw new Error("Slurp error");return n}function Bt(t,e){return t.read_shift(e)===1}function qt(t){return t.read_shift(2,"u")}function CA(t,e){return g8(t,e,qt)}function v8(t){var e=t.read_shift(1),r=t.read_shift(1);return r===1?e:e===1}function Nu(t,e,r){var n=t.read_shift(r&&r.biff>=12?2:1),i="sbcs-cont";if(r&&r.biff>=8,!r||r.biff==8){var s=t.read_shift(1);s&&(i="dbcs-cont")}else r.biff==12&&(i="wstr");r.biff>=2&&r.biff<=5&&(i="cpstr");var a=n?t.read_shift(n,i):"";return a}function x8(t){var e=t.read_shift(2),r=t.read_shift(1),n=r&4,i=r&8,s=1+(r&1),a=0,o,l={};i&&(a=t.read_shift(2)),n&&(o=t.read_shift(4));var c=s==2?"dbcs-cont":"sbcs-cont",u=e===0?"":t.read_shift(e,c);return i&&(t.l+=4*a),n&&(t.l+=o),l.t=u,i||(l.raw="<t>"+l.t+"</t>",l.r=l.t),l}function Ba(t,e,r){var n;if(r){if(r.biff>=2&&r.biff<=5)return t.read_shift(e,"cpstr");if(r.biff>=12)return t.read_shift(e,"dbcs-cont")}var i=t.read_shift(1);return i===0?n=t.read_shift(e,"sbcs-cont"):n=t.read_shift(e,"dbcs-cont"),n}function Pu(t,e,r){var n=t.read_shift(r&&r.biff==2?1:2);return n===0?(t.l++,""):Ba(t,n,r)}function ro(t,e,r){if(r.biff>5)return Pu(t,e,r);var n=t.read_shift(1);return n===0?(t.l++,""):t.read_shift(n,r.biff<=4||!t.lens?"cpstr":"sbcs-cont")}function _8(t){var e=t.read_shift(1);t.l++;var r=t.read_shift(2);return t.l+=2,[e,r]}function y8(t){var e=t.read_shift(4),r=t.l,n=!1;e>24&&(t.l+=e-24,t.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(n=!0),t.l=r);var i=t.read_shift((n?e-24:e)>>1,"utf16le").replace(Xr,"");return n&&(t.l+=24),i}function w8(t){for(var e=t.read_shift(2),r="";e-- >0;)r+="../";var n=t.read_shift(0,"lpstr-ansi");if(t.l+=2,t.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var i=t.read_shift(4);if(i===0)return r+n.replace(/\\/g,"/");var s=t.read_shift(4);if(t.read_shift(2)!=3)throw new Error("Bad FileMoniker");var a=t.read_shift(s>>1,"utf16le").replace(Xr,"");return r+a}function E8(t,e){var r=t.read_shift(16);switch(r){case"e0c9ea79f9bace118c8200aa004ba90b":return y8(t);case"0303000000000000c000000000000046":return w8(t);default:throw new Error("Unsupported Moniker "+r)}}function Ef(t){var e=t.read_shift(4),r=e>0?t.read_shift(e,"utf16le").replace(Xr,""):"";return r}function T8(t,e){var r=t.l+e,n=t.read_shift(4);if(n!==2)throw new Error("Unrecognized streamVersion: "+n);var i=t.read_shift(2);t.l+=2;var s,a,o,l,c="",u,h;i&16&&(s=Ef(t,r-t.l)),i&128&&(a=Ef(t,r-t.l)),(i&257)===257&&(o=Ef(t,r-t.l)),(i&257)===1&&(l=E8(t,r-t.l)),i&8&&(c=Ef(t,r-t.l)),i&32&&(u=t.read_shift(16)),i&64&&(h=zv(t)),t.l=r;var d=a||o||l||"";d&&c&&(d+="#"+c),d||(d="#"+c),i&2&&d.charAt(0)=="/"&&d.charAt(1)!="/"&&(d="file://"+d);var p={Target:d};return u&&(p.guid=u),h&&(p.time=h),s&&(p.Tooltip=s),p}function RA(t){var e=t.read_shift(1),r=t.read_shift(1),n=t.read_shift(1),i=t.read_shift(1);return[e,r,n,i]}function NA(t,e){var r=RA(t);return r[3]=0,r}function Ni(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2);return{r:e,c:r,ixfe:n}}function k8(t){var e=t.read_shift(2),r=t.read_shift(2);return t.l+=8,{type:e,flags:r}}function S8(t,e,r){return e===0?"":ro(t,e,r)}function A8(t,e,r){var n=r.biff>8?4:2,i=t.read_shift(n),s=t.read_shift(n,"i"),a=t.read_shift(n,"i");return[i,s,a]}function PA(t){var e=t.read_shift(2),r=jv(t);return[e,r]}function I8(t,e,r){t.l+=4,e-=4;var n=t.l+e,i=Nu(t,e,r),s=t.read_shift(2);if(n-=t.l,s!==n)throw new Error("Malformed AddinUdf: padding = "+n+" != "+s);return t.l+=s,i}function H0(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2),i=t.read_shift(2);return{s:{c:n,r:e},e:{c:i,r}}}function FA(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(1),i=t.read_shift(1);return{s:{c:n,r:e},e:{c:i,r}}}var C8=FA;function DA(t){t.l+=4;var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2);return t.l+=12,[r,e,n]}function R8(t){var e={};return t.l+=4,t.l+=16,e.fSharedNote=t.read_shift(2),t.l+=4,e}function N8(t){var e={};return t.l+=4,t.cf=t.read_shift(2),e}function Pr(t){t.l+=2,t.l+=t.read_shift(2)}var P8={0:Pr,4:Pr,5:Pr,6:Pr,7:N8,8:Pr,9:Pr,10:Pr,11:Pr,12:Pr,13:R8,14:Pr,15:Pr,16:Pr,17:Pr,18:Pr,19:Pr,20:Pr,21:DA};function F8(t,e){for(var r=t.l+e,n=[];t.l<r;){var i=t.read_shift(2);t.l-=2;try{n.push(P8[i](t,r-t.l))}catch{return t.l=r,n}}return t.l!=r&&(t.l=r),n}function Tf(t,e){var r={BIFFVer:0,dt:0};switch(r.BIFFVer=t.read_shift(2),e-=2,e>=2&&(r.dt=t.read_shift(2),t.l-=2),r.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(e>6)throw new Error("Unexpected BIFF Ver "+r.BIFFVer)}return t.read_shift(e),r}function D8(t,e){return e===0||t.read_shift(2),1200}function b8(t,e,r){if(r.enc)return t.l+=e,"";var n=t.l,i=ro(t,0,r);return t.read_shift(e+n-t.l),i}function O8(t,e,r){var n=r&&r.biff==8||e==2?t.read_shift(2):(t.l+=e,0);return{fDialog:n&16,fBelow:n&64,fRight:n&128}}function L8(t,e,r){var n=t.read_shift(4),i=t.read_shift(1)&3,s=t.read_shift(1);switch(s){case 0:s="Worksheet";break;case 1:s="Macrosheet";break;case 2:s="Chartsheet";break;case 6:s="VBAModule";break}var a=Nu(t,0,r);return a.length===0&&(a="Sheet1"),{pos:n,hs:i,dt:s,name:a}}function M8(t,e){for(var r=t.l+e,n=t.read_shift(4),i=t.read_shift(4),s=[],a=0;a!=i&&t.l<r;++a)s.push(x8(t));return s.Count=n,s.Unique=i,s}function V8(t,e){var r={};return r.dsst=t.read_shift(2),t.l+=e-2,r}function U8(t){var e={};e.r=t.read_shift(2),e.c=t.read_shift(2),e.cnt=t.read_shift(2)-e.c;var r=t.read_shift(2);t.l+=4;var n=t.read_shift(1);return t.l+=3,n&7&&(e.level=n&7),n&32&&(e.hidden=!0),n&64&&(e.hpt=r/20),e}function j8(t){var e=k8(t);if(e.type!=2211)throw new Error("Invalid Future Record "+e.type);var r=t.read_shift(4);return r!==0}function B8(t){return t.read_shift(2),t.read_shift(4)}function sw(t,e,r){var n=0;r&&r.biff==2||(n=t.read_shift(2));var i=t.read_shift(2);r&&r.biff==2&&(n=1-(i>>15),i&=32767);var s={Unsynced:n&1,DyZero:(n&2)>>1,ExAsc:(n&4)>>2,ExDsc:(n&8)>>3};return[s,i]}function z8(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2),i=t.read_shift(2),s=t.read_shift(2),a=t.read_shift(2),o=t.read_shift(2),l=t.read_shift(2),c=t.read_shift(2);return{Pos:[e,r],Dim:[n,i],Flags:s,CurTab:a,FirstTab:o,Selected:l,TabRatio:c}}function $8(t,e,r){if(r&&r.biff>=2&&r.biff<5)return{};var n=t.read_shift(2);return{RTL:n&64}}function H8(){}function W8(t,e,r){var n={dyHeight:t.read_shift(2),fl:t.read_shift(2)};switch(r&&r.biff||8){case 2:break;case 3:case 4:t.l+=2;break;default:t.l+=10;break}return n.name=Nu(t,0,r),n}function G8(t){var e=Ni(t);return e.isst=t.read_shift(4),e}function K8(t,e,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=t.l+e,i=Ni(t);r.biff==2&&t.l++;var s=Pu(t,n-t.l,r);return i.val=s,i}function q8(t,e,r){var n=t.read_shift(2),i=ro(t,0,r);return[n,i]}var X8=ro;function aw(t,e,r){var n=t.l+e,i=r.biff==8||!r.biff?4:2,s=t.read_shift(i),a=t.read_shift(i),o=t.read_shift(2),l=t.read_shift(2);return t.l=n,{s:{r:s,c:o},e:{r:a,c:l}}}function Y8(t){var e=t.read_shift(2),r=t.read_shift(2),n=PA(t);return{r:e,c:r,ixfe:n[0],rknum:n[1]}}function Q8(t,e){for(var r=t.l+e-2,n=t.read_shift(2),i=t.read_shift(2),s=[];t.l<r;)s.push(PA(t));if(t.l!==r)throw new Error("MulRK read error");var a=t.read_shift(2);if(s.length!=a-i+1)throw new Error("MulRK length mismatch");return{r:n,c:i,C:a,rkrec:s}}function J8(t,e){for(var r=t.l+e-2,n=t.read_shift(2),i=t.read_shift(2),s=[];t.l<r;)s.push(t.read_shift(2));if(t.l!==r)throw new Error("MulBlank read error");var a=t.read_shift(2);if(s.length!=a-i+1)throw new Error("MulBlank length mismatch");return{r:n,c:i,C:a,ixfe:s}}function Z8(t,e,r,n){var i={},s=t.read_shift(4),a=t.read_shift(4),o=t.read_shift(4),l=t.read_shift(2);return i.patternType=YM[o>>26],n.cellStyles&&(i.alc=s&7,i.fWrap=s>>3&1,i.alcV=s>>4&7,i.fJustLast=s>>7&1,i.trot=s>>8&255,i.cIndent=s>>16&15,i.fShrinkToFit=s>>20&1,i.iReadOrder=s>>22&2,i.fAtrNum=s>>26&1,i.fAtrFnt=s>>27&1,i.fAtrAlc=s>>28&1,i.fAtrBdr=s>>29&1,i.fAtrPat=s>>30&1,i.fAtrProt=s>>31&1,i.dgLeft=a&15,i.dgRight=a>>4&15,i.dgTop=a>>8&15,i.dgBottom=a>>12&15,i.icvLeft=a>>16&127,i.icvRight=a>>23&127,i.grbitDiag=a>>30&3,i.icvTop=o&127,i.icvBottom=o>>7&127,i.icvDiag=o>>14&127,i.dgDiag=o>>21&15,i.icvFore=l&127,i.icvBack=l>>7&127,i.fsxButton=l>>14&1),i}function e5(t,e,r){var n={};return n.ifnt=t.read_shift(2),n.numFmtId=t.read_shift(2),n.flags=t.read_shift(2),n.fStyle=n.flags>>2&1,e-=6,n.data=Z8(t,e,n.fStyle,r),n}function t5(t){t.l+=4;var e=[t.read_shift(2),t.read_shift(2)];if(e[0]!==0&&e[0]--,e[1]!==0&&e[1]--,e[0]>7||e[1]>7)throw new Error("Bad Gutters: "+e.join("|"));return e}function ow(t,e,r){var n=Ni(t);(r.biff==2||e==9)&&++t.l;var i=v8(t);return n.val=i,n.t=i===!0||i===!1?"b":"e",n}function r5(t,e,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=Ni(t),i=Lr(t);return n.val=i,n}var lw=S8;function n5(t,e,r){var n=t.l+e,i=t.read_shift(2),s=t.read_shift(2);if(r.sbcch=s,s==1025||s==14849)return[s,i];if(s<1||s>255)throw new Error("Unexpected SupBook type: "+s);for(var a=Ba(t,s),o=[];n>t.l;)o.push(Pu(t));return[s,i,a,o]}function cw(t,e,r){var n=t.read_shift(2),i,s={fBuiltIn:n&1,fWantAdvise:n>>>1&1,fWantPict:n>>>2&1,fOle:n>>>3&1,fOleLink:n>>>4&1,cf:n>>>5&1023,fIcon:n>>>15&1};return r.sbcch===14849&&(i=I8(t,e-2,r)),s.body=i||t.read_shift(e-2),typeof i=="string"&&(s.Name=i),s}var i5=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function uw(t,e,r){var n=t.l+e,i=t.read_shift(2),s=t.read_shift(1),a=t.read_shift(1),o=t.read_shift(r&&r.biff==2?1:2),l=0;(!r||r.biff>=5)&&(r.biff!=5&&(t.l+=2),l=t.read_shift(2),r.biff==5&&(t.l+=2),t.l+=4);var c=Ba(t,a,r);i&32&&(c=i5[c.charCodeAt(0)]);var u=n-t.l;r&&r.biff==2&&--u;var h=n==t.l||o===0||!(u>0)?[]:UU(t,u,r,o);return{chKey:s,Name:c,itab:l,rgce:h}}function bA(t,e,r){if(r.biff<8)return s5(t,e,r);for(var n=[],i=t.l+e,s=t.read_shift(r.biff>8?4:2);s--!==0;)n.push(A8(t,r.biff>8?12:6,r));if(t.l!=i)throw new Error("Bad ExternSheet: "+t.l+" != "+i);return n}function s5(t,e,r){t[t.l+1]==3&&t[t.l]++;var n=Nu(t,e,r);return n.charCodeAt(0)==3?n.slice(1):n}function a5(t,e,r){if(r.biff<8){t.l+=e;return}var n=t.read_shift(2),i=t.read_shift(2),s=Ba(t,n,r),a=Ba(t,i,r);return[s,a]}function o5(t,e,r){var n=FA(t);t.l++;var i=t.read_shift(1);return e-=8,[jU(t,e,r),i,n]}function fw(t,e,r){var n=C8(t);switch(r.biff){case 2:t.l++,e-=7;break;case 3:case 4:t.l+=2,e-=8;break;default:t.l+=6,e-=12}return[n,MU(t,e,r)]}function l5(t){var e=t.read_shift(4)!==0,r=t.read_shift(4)!==0,n=t.read_shift(4);return[e,r,n]}function c5(t,e,r){if(!(r.biff<8)){var n=t.read_shift(2),i=t.read_shift(2),s=t.read_shift(2),a=t.read_shift(2),o=ro(t,0,r);return r.biff<8&&t.read_shift(1),[{r:n,c:i},o,a,s]}}function u5(t,e,r){return c5(t,e,r)}function f5(t,e){for(var r=[],n=t.read_shift(2);n--;)r.push(H0(t));return r}function h5(t,e,r){if(r&&r.biff<8)return p5(t,e,r);var n=DA(t),i=F8(t,e-22,n[1]);return{cmo:n,ft:i}}var d5={8:function(t,e){var r=t.l+e;t.l+=10;var n=t.read_shift(2);t.l+=4,t.l+=2,t.l+=2,t.l+=2,t.l+=4;var i=t.read_shift(1);return t.l+=i,t.l=r,{fmt:n}}};function p5(t,e,r){t.l+=4;var n=t.read_shift(2),i=t.read_shift(2),s=t.read_shift(2);t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=6,e-=36;var a=[];return a.push((d5[n]||Br)(t,e,r)),{cmo:[i,n,s],ft:a}}function m5(t,e,r){var n=t.l,i="";try{t.l+=4;var s=(r.lastobj||{cmo:[0,0]}).cmo[1],a;[0,5,7,11,12,14].indexOf(s)==-1?t.l+=6:a=_8(t,6,r);var o=t.read_shift(2);t.read_shift(2),qt(t,2);var l=t.read_shift(2);t.l+=l;for(var c=1;c<t.lens.length-1;++c){if(t.l-n!=t.lens[c])throw new Error("TxO: bad continue record");var u=t[t.l],h=Ba(t,t.lens[c+1]-t.lens[c]-1);if(i+=h,i.length>=(u?o:2*o))break}if(i.length!==o&&i.length!==o*2)throw new Error("cchText: "+o+" != "+i.length);return t.l=n+e,{t:i}}catch{return t.l=n+e,{t:i}}}function g5(t,e){var r=H0(t);t.l+=16;var n=T8(t,e-24);return[r,n]}function v5(t,e){t.read_shift(2);var r=H0(t),n=t.read_shift((e-10)/2,"dbcs-cont");return n=n.replace(Xr,""),[r,n]}function x5(t){var e=[0,0],r;return r=t.read_shift(2),e[0]=ew[r]||r,r=t.read_shift(2),e[1]=ew[r]||r,e}function _5(t){for(var e=t.read_shift(2),r=[];e-- >0;)r.push(NA(t));return r}function y5(t){for(var e=t.read_shift(2),r=[];e-- >0;)r.push(NA(t));return r}function w5(t){t.l+=2;var e={cxfs:0,crc:0};return e.cxfs=t.read_shift(2),e.crc=t.read_shift(4),e}function OA(t,e,r){if(!r.cellStyles)return Br(t,e);var n=r&&r.biff>=12?4:2,i=t.read_shift(n),s=t.read_shift(n),a=t.read_shift(n),o=t.read_shift(n),l=t.read_shift(2);n==2&&(t.l+=2);var c={s:i,e:s,w:a,ixfe:o,flags:l};return(r.biff>=5||!r.biff)&&(c.level=l>>8&7),c}function E5(t,e){var r={};return e<32||(t.l+=16,r.header=Lr(t),r.footer=Lr(t),t.l+=2),r}function T5(t,e,r){var n={area:!1};if(r.biff!=5)return t.l+=e,n;var i=t.read_shift(1);return t.l+=3,i&16&&(n.area=!0),n}var k5=Ni,S5=CA,A5=Pu;function I5(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(4),i={fmt:e,env:r,len:n,data:t.slice(t.l,t.l+n)};return t.l+=n,i}function C5(t,e,r){r.biffguess&&r.biff==5&&(r.biff=2);var n=Ni(t);++t.l;var i=ro(t,e-7,r);return n.t="str",n.val=i,n}function R5(t){var e=Ni(t);++t.l;var r=Lr(t);return e.t="n",e.val=r,e}function N5(t){var e=Ni(t);++t.l;var r=t.read_shift(2);return e.t="n",e.val=r,e}function P5(t){var e=t.read_shift(1);return e===0?(t.l++,""):t.read_shift(e,"sbcs-cont")}function F5(t,e){t.l+=6,t.l+=2,t.l+=1,t.l+=3,t.l+=1,t.l+=e-13}function D5(t,e,r){var n=t.l+e,i=Ni(t),s=t.read_shift(2),a=Ba(t,s,r);return t.l=n,i.t="str",i.val=a,i}var b5=[2,3,48,49,131,139,140,245],hw=function(){var t={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},e=Pv({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(o,l){var c=[],u=Zs(1);switch(l.type){case"base64":u=Yn(En(o));break;case"binary":u=Yn(o);break;case"buffer":case"array":u=o;break}vr(u,0);var h=u.read_shift(1),d=!!(h&136),p=!1,x=!1;switch(h){case 2:break;case 3:break;case 48:p=!0,d=!0;break;case 49:p=!0,d=!0;break;case 131:break;case 139:break;case 140:x=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+h.toString(16))}var v=0,E=521;h==2&&(v=u.read_shift(2)),u.l+=3,h!=2&&(v=u.read_shift(4)),v>1048576&&(v=1e6),h!=2&&(E=u.read_shift(2));var T=u.read_shift(2),w=l.codepage||1252;h!=2&&(u.l+=16,u.read_shift(1),u[u.l]!==0&&(w=t[u[u.l]]),u.l+=1,u.l+=2),x&&(u.l+=36);for(var y=[],R={},M=Math.min(u.length,h==2?521:E-10-(p?264:0)),j=x?32:11;u.l<M&&u[u.l]!=13;)switch(R={},R.name=tu.utils.decode(w,u.slice(u.l,u.l+j)).replace(/[\u0000\r\n].*$/g,""),u.l+=j,R.type=String.fromCharCode(u.read_shift(1)),h!=2&&!x&&(R.offset=u.read_shift(4)),R.len=u.read_shift(1),h==2&&(R.offset=u.read_shift(2)),R.dec=u.read_shift(1),R.name.length&&y.push(R),h!=2&&(u.l+=x?13:14),R.type){case"B":(!p||R.len!=8)&&l.WTF&&console.log("Skipping "+R.name+":"+R.type);break;case"G":case"P":l.WTF&&console.log("Skipping "+R.name+":"+R.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+R.type)}if(u[u.l]!==13&&(u.l=E-1),u.read_shift(1)!==13)throw new Error("DBF Terminator not found "+u.l+" "+u[u.l]);u.l=E;var g=0,k=0;for(c[0]=[],k=0;k!=y.length;++k)c[0][k]=y[k].name;for(;v-- >0;){if(u[u.l]===42){u.l+=T;continue}for(++u.l,c[++g]=[],k=0,k=0;k!=y.length;++k){var S=u.slice(u.l,u.l+y[k].len);u.l+=y[k].len,vr(S,0);var C=tu.utils.decode(w,S);switch(y[k].type){case"C":C.trim().length&&(c[g][k]=C.replace(/\s+$/,""));break;case"D":C.length===8?c[g][k]=new Date(+C.slice(0,4),+C.slice(4,6)-1,+C.slice(6,8)):c[g][k]=C;break;case"F":c[g][k]=parseFloat(C.trim());break;case"+":case"I":c[g][k]=x?S.read_shift(-4,"i")^2147483648:S.read_shift(4,"i");break;case"L":switch(C.trim().toUpperCase()){case"Y":case"T":c[g][k]=!0;break;case"N":case"F":c[g][k]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+C+"|")}break;case"M":if(!d)throw new Error("DBF Unexpected MEMO for type "+h.toString(16));c[g][k]="##MEMO##"+(x?parseInt(C.trim(),10):S.read_shift(4));break;case"N":C=C.replace(/\u0000/g,"").trim(),C&&C!="."&&(c[g][k]=+C||0);break;case"@":c[g][k]=new Date(S.read_shift(-8,"f")-621356832e5);break;case"T":c[g][k]=new Date((S.read_shift(4)-2440588)*864e5+S.read_shift(4));break;case"Y":c[g][k]=S.read_shift(4,"i")/1e4+S.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":c[g][k]=-S.read_shift(-8,"f");break;case"B":if(p&&y[k].len==8){c[g][k]=S.read_shift(8,"f");break}case"G":case"P":S.l+=y[k].len;break;case"0":if(y[k].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+y[k].type)}}}if(h!=2&&u.l<u.length&&u[u.l++]!=26)throw new Error("DBF EOF Marker missing "+(u.l-1)+" of "+u.length+" "+u[u.l-1].toString(16));return l&&l.sheetRows&&(c=c.slice(0,l.sheetRows)),l.DBF=y,c}function n(o,l){var c=l||{};c.dateNF||(c.dateNF="yyyymmdd");var u=yl(r(o,c),c);return u["!cols"]=c.DBF.map(function(h){return{wch:h.len,DBF:h}}),delete c.DBF,u}function i(o,l){try{return aa(n(o,l),l)}catch(c){if(l&&l.WTF)throw c}return{SheetNames:[],Sheets:{}}}var s={B:8,C:250,L:1,D:8,"?":0,"":0};function a(o,l){var c=l||{};if(+c.codepage>=0&&Jn(+c.codepage),c.type=="string")throw new Error("Cannot write DBF to JS string");var u=_m(),h=Rm(o,{header:1,raw:!0,cellDates:!0}),d=h[0],p=h.slice(1),x=o["!cols"]||[],v=0,E=0,T=0,w=1;for(v=0;v<d.length;++v){if(((x[v]||{}).DBF||{}).name){d[v]=x[v].DBF.name,++T;continue}if(d[v]!=null){if(++T,typeof d[v]=="number"&&(d[v]=d[v].toString(10)),typeof d[v]!="string")throw new Error("DBF Invalid column name "+d[v]+" |"+typeof d[v]+"|");if(d.indexOf(d[v])!==v){for(E=0;E<1024;++E)if(d.indexOf(d[v]+"_"+E)==-1){d[v]+="_"+E;break}}}}var y=jt(o["!ref"]),R=[],M=[],j=[];for(v=0;v<=y.e.c-y.s.c;++v){var g="",k="",S=0,C=[];for(E=0;E<p.length;++E)p[E][v]!=null&&C.push(p[E][v]);if(C.length==0||d[v]==null){R[v]="?";continue}for(E=0;E<C.length;++E){switch(typeof C[E]){case"number":k="B";break;case"string":k="C";break;case"boolean":k="L";break;case"object":k=C[E]instanceof Date?"D":"C";break;default:k="C"}S=Math.max(S,String(C[E]).length),g=g&&g!=k?"C":k}S>250&&(S=250),k=((x[v]||{}).DBF||{}).type,k=="C"&&x[v].DBF.len>S&&(S=x[v].DBF.len),g=="B"&&k=="N"&&(g="N",j[v]=x[v].DBF.dec,S=x[v].DBF.len),M[v]=g=="C"||k=="N"?S:s[g]||0,w+=M[v],R[v]=g}var F=u.next(32);for(F.write_shift(4,318902576),F.write_shift(4,p.length),F.write_shift(2,296+32*T),F.write_shift(2,w),v=0;v<4;++v)F.write_shift(4,0);for(F.write_shift(4,0|(+e[bS]||3)<<8),v=0,E=0;v<d.length;++v)if(d[v]!=null){var P=u.next(32),b=(d[v].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);P.write_shift(1,b,"sbcs"),P.write_shift(1,R[v]=="?"?"C":R[v],"sbcs"),P.write_shift(4,E),P.write_shift(1,M[v]||s[R[v]]||0),P.write_shift(1,j[v]||0),P.write_shift(1,2),P.write_shift(4,0),P.write_shift(1,0),P.write_shift(4,0),P.write_shift(4,0),E+=M[v]||s[R[v]]||0}var ve=u.next(264);for(ve.write_shift(4,13),v=0;v<65;++v)ve.write_shift(4,0);for(v=0;v<p.length;++v){var he=u.next(w);for(he.write_shift(1,0),E=0;E<d.length;++E)if(d[E]!=null)switch(R[E]){case"L":he.write_shift(1,p[v][E]==null?63:p[v][E]?84:70);break;case"B":he.write_shift(8,p[v][E]||0,"f");break;case"N":var Se="0";for(typeof p[v][E]=="number"&&(Se=p[v][E].toFixed(j[E]||0)),T=0;T<M[E]-Se.length;++T)he.write_shift(1,32);he.write_shift(1,Se,"sbcs");break;case"D":p[v][E]?(he.write_shift(4,("0000"+p[v][E].getFullYear()).slice(-4),"sbcs"),he.write_shift(2,("00"+(p[v][E].getMonth()+1)).slice(-2),"sbcs"),he.write_shift(2,("00"+p[v][E].getDate()).slice(-2),"sbcs")):he.write_shift(8,"00000000","sbcs");break;case"C":var oe=String(p[v][E]!=null?p[v][E]:"").slice(0,M[E]);for(he.write_shift(1,oe,"sbcs"),T=0;T<M[E]-oe.length;++T)he.write_shift(1,32);break}}return u.next(1).write_shift(1,26),u.end()}return{to_workbook:i,to_sheet:n,from_sheet:a}}(),O5=function(){var t={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},e=new RegExp("\x1BN("+ki(t).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(d,p){var x=t[p];return typeof x=="number"?Cy(x):x},n=function(d,p,x){var v=p.charCodeAt(0)-32<<4|x.charCodeAt(0)-48;return v==59?d:Cy(v)};t["|"]=254;function i(d,p){switch(p.type){case"base64":return s(En(d),p);case"binary":return s(d,p);case"buffer":return s(Je&&Buffer.isBuffer(d)?d.toString("binary"):Ja(d),p);case"array":return s(ja(d),p)}throw new Error("Unrecognized type "+p.type)}function s(d,p){var x=d.split(/[\n\r]+/),v=-1,E=-1,T=0,w=0,y=[],R=[],M=null,j={},g=[],k=[],S=[],C=0,F;for(+p.codepage>=0&&Jn(+p.codepage);T!==x.length;++T){C=0;var P=x[T].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(e,r),b=P.replace(/;;/g,"\0").split(";").map(function(W){return W.replace(/\u0000/g,";")}),ve=b[0],he;if(P.length>0)switch(ve){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":b[1].charAt(0)=="P"&&R.push(P.slice(3).replace(/;;/g,";"));break;case"C":var Se=!1,oe=!1,ie=!1,G=!1,ue=-1,Ee=-1;for(w=1;w<b.length;++w)switch(b[w].charAt(0)){case"A":break;case"X":E=parseInt(b[w].slice(1))-1,oe=!0;break;case"Y":for(v=parseInt(b[w].slice(1))-1,oe||(E=0),F=y.length;F<=v;++F)y[F]=[];break;case"K":he=b[w].slice(1),he.charAt(0)==='"'?he=he.slice(1,he.length-1):he==="TRUE"?he=!0:he==="FALSE"?he=!1:isNaN(ni(he))?isNaN(ol(he).getDate())||(he=hr(he)):(he=ni(he),M!==null&&xl(M)&&(he=$0(he))),Se=!0;break;case"E":G=!0;var B=zo(b[w].slice(1),{r:v,c:E});y[v][E]=[y[v][E],B];break;case"S":ie=!0,y[v][E]=[y[v][E],"S5S"];break;case"G":break;case"R":ue=parseInt(b[w].slice(1))-1;break;case"C":Ee=parseInt(b[w].slice(1))-1;break;default:if(p&&p.WTF)throw new Error("SYLK bad record "+P)}if(Se&&(y[v][E]&&y[v][E].length==2?y[v][E][0]=he:y[v][E]=he,M=null),ie){if(G)throw new Error("SYLK shared formula cannot have own formula");var X=ue>-1&&y[ue][Ee];if(!X||!X[1])throw new Error("SYLK shared formula cannot find base");y[v][E][1]=WA(X[1],{r:v-ue,c:E-Ee})}break;case"F":var K=0;for(w=1;w<b.length;++w)switch(b[w].charAt(0)){case"X":E=parseInt(b[w].slice(1))-1,++K;break;case"Y":for(v=parseInt(b[w].slice(1))-1,F=y.length;F<=v;++F)y[F]=[];break;case"M":C=parseInt(b[w].slice(1))/20;break;case"F":break;case"G":break;case"P":M=R[parseInt(b[w].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(S=b[w].slice(1).split(" "),F=parseInt(S[0],10);F<=parseInt(S[1],10);++F)C=parseInt(S[2],10),k[F-1]=C===0?{hidden:!0}:{wch:C},ll(k[F-1]);break;case"C":E=parseInt(b[w].slice(1))-1,k[E]||(k[E]={});break;case"R":v=parseInt(b[w].slice(1))-1,g[v]||(g[v]={}),C>0?(g[v].hpt=C,g[v].hpx=ou(C)):C===0&&(g[v].hidden=!0);break;default:if(p&&p.WTF)throw new Error("SYLK bad record "+P)}K<1&&(M=null);break;default:if(p&&p.WTF)throw new Error("SYLK bad record "+P)}}return g.length>0&&(j["!rows"]=g),k.length>0&&(j["!cols"]=k),p&&p.sheetRows&&(y=y.slice(0,p.sheetRows)),[y,j]}function a(d,p){var x=i(d,p),v=x[0],E=x[1],T=yl(v,p);return ki(E).forEach(function(w){T[w]=E[w]}),T}function o(d,p){return aa(a(d,p),p)}function l(d,p,x,v){var E="C;Y"+(x+1)+";X"+(v+1)+";K";switch(d.t){case"n":E+=d.v||0,d.f&&!d.F&&(E+=";E"+wV(d.f,{r:x,c:v}));break;case"b":E+=d.v?"TRUE":"FALSE";break;case"e":E+=d.w||d.v;break;case"d":E+='"'+(d.w||d.v)+'"';break;case"s":E+='"'+d.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return E}function c(d,p){p.forEach(function(x,v){var E="F;W"+(v+1)+" "+(v+1)+" ";x.hidden?E+="0":(typeof x.width=="number"&&!x.wpx&&(x.wpx=Qh(x.width)),typeof x.wpx=="number"&&!x.wch&&(x.wch=Jh(x.wpx)),typeof x.wch=="number"&&(E+=Math.round(x.wch))),E.charAt(E.length-1)!=" "&&d.push(E)})}function u(d,p){p.forEach(function(x,v){var E="F;";x.hidden?E+="M0;":x.hpt?E+="M"+20*x.hpt+";":x.hpx&&(E+="M"+20*zA(x.hpx)+";"),E.length>2&&d.push(E+"R"+(v+1))})}function h(d,p){var x=["ID;PWXL;N;E"],v=[],E=jt(d["!ref"]),T,w=Array.isArray(d),y=`\r
`;x.push("P;PGeneral"),x.push("F;P0;DG0G8;M255"),d["!cols"]&&c(x,d["!cols"]),d["!rows"]&&u(x,d["!rows"]),x.push("B;Y"+(E.e.r-E.s.r+1)+";X"+(E.e.c-E.s.c+1)+";D"+[E.s.c,E.s.r,E.e.c,E.e.r].join(" "));for(var R=E.s.r;R<=E.e.r;++R)for(var M=E.s.c;M<=E.e.c;++M){var j=je({r:R,c:M});T=w?(d[R]||[])[M]:d[j],!(!T||T.v==null&&(!T.f||T.F))&&v.push(l(T,d,R,M))}return x.join(y)+y+v.join(y)+y+"E"+y}return{to_workbook:o,to_sheet:a,from_sheet:h}}(),L5=function(){function t(s,a){switch(a.type){case"base64":return e(En(s),a);case"binary":return e(s,a);case"buffer":return e(Je&&Buffer.isBuffer(s)?s.toString("binary"):Ja(s),a);case"array":return e(ja(s),a)}throw new Error("Unrecognized type "+a.type)}function e(s,a){for(var o=s.split(`
`),l=-1,c=-1,u=0,h=[];u!==o.length;++u){if(o[u].trim()==="BOT"){h[++l]=[],c=0;continue}if(!(l<0)){var d=o[u].trim().split(","),p=d[0],x=d[1];++u;for(var v=o[u]||"";(v.match(/["]/g)||[]).length&1&&u<o.length-1;)v+=`
`+o[++u];switch(v=v.trim(),+p){case-1:if(v==="BOT"){h[++l]=[],c=0;continue}else if(v!=="EOD")throw new Error("Unrecognized DIF special command "+v);break;case 0:v==="TRUE"?h[l][c]=!0:v==="FALSE"?h[l][c]=!1:isNaN(ni(x))?isNaN(ol(x).getDate())?h[l][c]=x:h[l][c]=hr(x):h[l][c]=ni(x),++c;break;case 1:v=v.slice(1,v.length-1),v=v.replace(/""/g,'"'),v&&v.match(/^=".*"$/)&&(v=v.slice(2,-1)),h[l][c++]=v!==""?v:null;break}if(v==="EOD")break}}return a&&a.sheetRows&&(h=h.slice(0,a.sheetRows)),h}function r(s,a){return yl(t(s,a),a)}function n(s,a){return aa(r(s,a),a)}var i=function(){var s=function(l,c,u,h,d){l.push(c),l.push(u+","+h),l.push('"'+d.replace(/"/g,'""')+'"')},a=function(l,c,u,h){l.push(c+","+u),l.push(c==1?'"'+h.replace(/"/g,'""')+'"':h)};return function(l){var c=[],u=jt(l["!ref"]),h,d=Array.isArray(l);s(c,"TABLE",0,1,"sheetjs"),s(c,"VECTORS",0,u.e.r-u.s.r+1,""),s(c,"TUPLES",0,u.e.c-u.s.c+1,""),s(c,"DATA",0,0,"");for(var p=u.s.r;p<=u.e.r;++p){a(c,-1,0,"BOT");for(var x=u.s.c;x<=u.e.c;++x){var v=je({r:p,c:x});if(h=d?(l[p]||[])[x]:l[v],!h){a(c,1,0,"");continue}switch(h.t){case"n":var E=h.w;!E&&h.v!=null&&(E=h.v),E==null?h.f&&!h.F?a(c,1,0,"="+h.f):a(c,1,0,""):a(c,0,E,"V");break;case"b":a(c,0,h.v?1:0,h.v?"TRUE":"FALSE");break;case"s":a(c,1,0,isNaN(h.v)?h.v:'="'+h.v+'"');break;case"d":h.w||(h.w=Un(h.z||ze[14],Yr(hr(h.v)))),a(c,0,h.w,"V");break;default:a(c,1,0,"")}}}a(c,-1,0,"EOD");var T=`\r
`,w=c.join(T);return w}}();return{to_workbook:n,to_sheet:r,from_sheet:i}}(),M5=function(){function t(h){return h.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function e(h){return h.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(h,d){for(var p=h.split(`
`),x=-1,v=-1,E=0,T=[];E!==p.length;++E){var w=p[E].trim().split(":");if(w[0]==="cell"){var y=Gr(w[1]);if(T.length<=y.r)for(x=T.length;x<=y.r;++x)T[x]||(T[x]=[]);switch(x=y.r,v=y.c,w[2]){case"t":T[x][v]=t(w[3]);break;case"v":T[x][v]=+w[3];break;case"vtf":var R=w[w.length-1];case"vtc":switch(w[3]){case"nl":T[x][v]=!!+w[4];break;default:T[x][v]=+w[4];break}w[2]=="vtf"&&(T[x][v]=[T[x][v],R])}}}return d&&d.sheetRows&&(T=T.slice(0,d.sheetRows)),T}function n(h,d){return yl(r(h,d),d)}function i(h,d){return aa(n(h,d),d)}var s=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),a=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,o=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),l="--SocialCalcSpreadsheetControlSave--";function c(h){if(!h||!h["!ref"])return"";for(var d=[],p=[],x,v="",E=_l(h["!ref"]),T=Array.isArray(h),w=E.s.r;w<=E.e.r;++w)for(var y=E.s.c;y<=E.e.c;++y)if(v=je({r:w,c:y}),x=T?(h[w]||[])[y]:h[v],!(!x||x.v==null||x.t==="z")){switch(p=["cell",v,"t"],x.t){case"s":case"str":p.push(e(x.v));break;case"n":x.f?(p[2]="vtf",p[3]="n",p[4]=x.v,p[5]=e(x.f)):(p[2]="v",p[3]=x.v);break;case"b":p[2]="vt"+(x.f?"f":"c"),p[3]="nl",p[4]=x.v?"1":"0",p[5]=e(x.f||(x.v?"TRUE":"FALSE"));break;case"d":var R=Yr(hr(x.v));p[2]="vtc",p[3]="nd",p[4]=""+R,p[5]=x.w||Un(x.z||ze[14],R);break;case"e":continue}d.push(p.join(":"))}return d.push("sheet:c:"+(E.e.c-E.s.c+1)+":r:"+(E.e.r-E.s.r+1)+":tvf:1"),d.push("valueformat:1:text-wiki"),d.join(`
`)}function u(h){return[s,a,o,a,c(h),l].join(`
`)}return{to_workbook:i,to_sheet:n,from_sheet:u}}(),su=function(){function t(u,h,d,p,x){x.raw?h[d][p]=u:u===""||(u==="TRUE"?h[d][p]=!0:u==="FALSE"?h[d][p]=!1:isNaN(ni(u))?isNaN(ol(u).getDate())?h[d][p]=u:h[d][p]=hr(u):h[d][p]=ni(u))}function e(u,h){var d=h||{},p=[];if(!u||u.length===0)return p;for(var x=u.split(/[\r\n]/),v=x.length-1;v>=0&&x[v].length===0;)--v;for(var E=10,T=0,w=0;w<=v;++w)T=x[w].indexOf(" "),T==-1?T=x[w].length:T++,E=Math.max(E,T);for(w=0;w<=v;++w){p[w]=[];var y=0;for(t(x[w].slice(0,E).trim(),p,w,y,d),y=1;y<=(x[w].length-E)/10+1;++y)t(x[w].slice(E+(y-1)*10,E+y*10).trim(),p,w,y,d)}return d.sheetRows&&(p=p.slice(0,d.sheetRows)),p}var r={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function i(u){for(var h={},d=!1,p=0,x=0;p<u.length;++p)(x=u.charCodeAt(p))==34?d=!d:!d&&x in r&&(h[x]=(h[x]||0)+1);x=[];for(p in h)Object.prototype.hasOwnProperty.call(h,p)&&x.push([h[p],p]);if(!x.length){h=n;for(p in h)Object.prototype.hasOwnProperty.call(h,p)&&x.push([h[p],p])}return x.sort(function(v,E){return v[0]-E[0]||n[v[1]]-n[E[1]]}),r[x.pop()[1]]||44}function s(u,h){var d=h||{},p="",x=d.dense?[]:{},v={s:{c:0,r:0},e:{c:0,r:0}};u.slice(0,4)=="sep="?u.charCodeAt(5)==13&&u.charCodeAt(6)==10?(p=u.charAt(4),u=u.slice(7)):u.charCodeAt(5)==13||u.charCodeAt(5)==10?(p=u.charAt(4),u=u.slice(6)):p=i(u.slice(0,1024)):d&&d.FS?p=d.FS:p=i(u.slice(0,1024));var E=0,T=0,w=0,y=0,R=0,M=p.charCodeAt(0),j=!1,g=0,k=u.charCodeAt(0);u=u.replace(/\r\n/mg,`
`);var S=d.dateNF!=null?qL(d.dateNF):null;function C(){var F=u.slice(y,R),P={};if(F.charAt(0)=='"'&&F.charAt(F.length-1)=='"'&&(F=F.slice(1,-1).replace(/""/g,'"')),F.length===0)P.t="z";else if(d.raw)P.t="s",P.v=F;else if(F.trim().length===0)P.t="s",P.v=F;else if(F.charCodeAt(0)==61)F.charCodeAt(1)==34&&F.charCodeAt(F.length-1)==34?(P.t="s",P.v=F.slice(2,-1).replace(/""/g,'"')):TV(F)?(P.t="n",P.f=F.slice(1)):(P.t="s",P.v=F);else if(F=="TRUE")P.t="b",P.v=!0;else if(F=="FALSE")P.t="b",P.v=!1;else if(!isNaN(w=ni(F)))P.t="n",d.cellText!==!1&&(P.w=F),P.v=w;else if(!isNaN(ol(F).getDate())||S&&F.match(S)){P.z=d.dateNF||ze[14];var b=0;S&&F.match(S)&&(F=XL(F,d.dateNF,F.match(S)||[]),b=1),d.cellDates?(P.t="d",P.v=hr(F,b)):(P.t="n",P.v=Yr(hr(F,b))),d.cellText!==!1&&(P.w=Un(P.z,P.v instanceof Date?Yr(P.v):P.v)),d.cellNF||delete P.z}else P.t="s",P.v=F;if(P.t=="z"||(d.dense?(x[E]||(x[E]=[]),x[E][T]=P):x[je({c:T,r:E})]=P),y=R+1,k=u.charCodeAt(y),v.e.c<T&&(v.e.c=T),v.e.r<E&&(v.e.r=E),g==M)++T;else if(T=0,++E,d.sheetRows&&d.sheetRows<=E)return!0}e:for(;R<u.length;++R)switch(g=u.charCodeAt(R)){case 34:k===34&&(j=!j);break;case M:case 10:case 13:if(!j&&C())break e;break}return R-y>0&&C(),x["!ref"]=rt(v),x}function a(u,h){return!(h&&h.PRN)||h.FS||u.slice(0,4)=="sep="||u.indexOf("	")>=0||u.indexOf(",")>=0||u.indexOf(";")>=0?s(u,h):yl(e(u,h),h)}function o(u,h){var d="",p=h.type=="string"?[0,0,0,0]:Yv(u,h);switch(h.type){case"base64":d=En(u);break;case"binary":d=u;break;case"buffer":h.codepage==65001?d=u.toString("utf8"):h.codepage&&typeof tu<"u"||(d=Je&&Buffer.isBuffer(u)?u.toString("binary"):Ja(u));break;case"array":d=ja(u);break;case"string":d=u;break;default:throw new Error("Unrecognized type "+h.type)}return p[0]==239&&p[1]==187&&p[2]==191?d=wt(d.slice(3)):h.type!="string"&&h.type!="buffer"&&h.codepage==65001?d=wt(d):h.type=="binary"&&typeof tu<"u",d.slice(0,19)=="socialcalc:version:"?M5.to_sheet(h.type=="string"?d:wt(d),h):a(d,h)}function l(u,h){return aa(o(u,h),h)}function c(u){for(var h=[],d=jt(u["!ref"]),p,x=Array.isArray(u),v=d.s.r;v<=d.e.r;++v){for(var E=[],T=d.s.c;T<=d.e.c;++T){var w=je({r:v,c:T});if(p=x?(u[v]||[])[T]:u[w],!p||p.v==null){E.push("          ");continue}for(var y=(p.w||(cs(p),p.w)||"").slice(0,10);y.length<10;)y+=" ";E.push(y+(T===0?" ":""))}h.push(E.join(""))}return h.join(`
`)}return{to_workbook:l,to_sheet:o,from_sheet:c}}();function V5(t,e){var r=e||{},n=!!r.WTF;r.WTF=!0;try{var i=O5.to_workbook(t,r);return r.WTF=n,i}catch(s){if(r.WTF=n,!s.message.match(/SYLK bad record ID/)&&n)throw s;return su.to_workbook(t,e)}}var Ec=function(){function t(B,X,K){if(B){vr(B,B.l||0);for(var W=K.Enum||ue;B.l<B.length;){var ae=B.read_shift(2),xe=W[ae]||W[65535],ke=B.read_shift(2),fe=B.l+ke,pe=xe.f&&xe.f(B,ke,K);if(B.l=fe,X(pe,xe,ae))return}}}function e(B,X){switch(X.type){case"base64":return r(Yn(En(B)),X);case"binary":return r(Yn(B),X);case"buffer":case"array":return r(B,X)}throw"Unsupported type "+X.type}function r(B,X){if(!B)return B;var K=X||{},W=K.dense?[]:{},ae="Sheet1",xe="",ke=0,fe={},pe=[],$e=[],z={s:{r:0,c:0},e:{r:0,c:0}},ot=K.sheetRows||0;if(B[2]==0&&(B[3]==8||B[3]==9)&&B.length>=16&&B[14]==5&&B[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(B[2]==2)K.Enum=ue,t(B,function(Ie,Et,ar){switch(ar){case 0:K.vers=Ie,Ie>=4096&&(K.qpro=!0);break;case 6:z=Ie;break;case 204:Ie&&(xe=Ie);break;case 222:xe=Ie;break;case 15:case 51:K.qpro||(Ie[1].v=Ie[1].v.slice(1));case 13:case 14:case 16:ar==14&&(Ie[2]&112)==112&&(Ie[2]&15)>1&&(Ie[2]&15)<15&&(Ie[1].z=K.dateNF||ze[14],K.cellDates&&(Ie[1].t="d",Ie[1].v=$0(Ie[1].v))),K.qpro&&Ie[3]>ke&&(W["!ref"]=rt(z),fe[ae]=W,pe.push(ae),W=K.dense?[]:{},z={s:{r:0,c:0},e:{r:0,c:0}},ke=Ie[3],ae=xe||"Sheet"+(ke+1),xe="");var Sr=K.dense?(W[Ie[0].r]||[])[Ie[0].c]:W[je(Ie[0])];if(Sr){Sr.t=Ie[1].t,Sr.v=Ie[1].v,Ie[1].z!=null&&(Sr.z=Ie[1].z),Ie[1].f!=null&&(Sr.f=Ie[1].f);break}K.dense?(W[Ie[0].r]||(W[Ie[0].r]=[]),W[Ie[0].r][Ie[0].c]=Ie[1]):W[je(Ie[0])]=Ie[1];break}},K);else if(B[2]==26||B[2]==14)K.Enum=Ee,B[2]==14&&(K.qpro=!0,B.l=0),t(B,function(Ie,Et,ar){switch(ar){case 204:ae=Ie;break;case 22:Ie[1].v=Ie[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(Ie[3]>ke&&(W["!ref"]=rt(z),fe[ae]=W,pe.push(ae),W=K.dense?[]:{},z={s:{r:0,c:0},e:{r:0,c:0}},ke=Ie[3],ae="Sheet"+(ke+1)),ot>0&&Ie[0].r>=ot)break;K.dense?(W[Ie[0].r]||(W[Ie[0].r]=[]),W[Ie[0].r][Ie[0].c]=Ie[1]):W[je(Ie[0])]=Ie[1],z.e.c<Ie[0].c&&(z.e.c=Ie[0].c),z.e.r<Ie[0].r&&(z.e.r=Ie[0].r);break;case 27:Ie[14e3]&&($e[Ie[14e3][0]]=Ie[14e3][1]);break;case 1537:$e[Ie[0]]=Ie[1],Ie[0]==ke&&(ae=Ie[1]);break}},K);else throw new Error("Unrecognized LOTUS BOF "+B[2]);if(W["!ref"]=rt(z),fe[xe||ae]=W,pe.push(xe||ae),!$e.length)return{SheetNames:pe,Sheets:fe};for(var We={},nt=[],be=0;be<$e.length;++be)fe[pe[be]]?(nt.push($e[be]||pe[be]),We[$e[be]]=fe[$e[be]]||fe[pe[be]]):(nt.push($e[be]),We[$e[be]]={"!ref":"A1"});return{SheetNames:nt,Sheets:We}}function n(B,X){var K=X||{};if(+K.codepage>=0&&Jn(+K.codepage),K.type=="string")throw new Error("Cannot write WK1 to JS string");var W=_m(),ae=jt(B["!ref"]),xe=Array.isArray(B),ke=[];Wn(W,0,s(1030)),Wn(W,6,l(ae));for(var fe=Math.min(ae.e.r,8191),pe=ae.s.r;pe<=fe;++pe)for(var $e=Er(pe),z=ae.s.c;z<=ae.e.c;++z){pe===ae.s.r&&(ke[z]=nr(z));var ot=ke[z]+$e,We=xe?(B[pe]||[])[z]:B[ot];if(!(!We||We.t=="z"))if(We.t=="n")(We.v|0)==We.v&&We.v>=-32768&&We.v<=32767?Wn(W,13,p(pe,z,We.v)):Wn(W,14,v(pe,z,We.v));else{var nt=cs(We);Wn(W,15,h(pe,z,nt.slice(0,239)))}}return Wn(W,1),W.end()}function i(B,X){var K=X||{};if(+K.codepage>=0&&Jn(+K.codepage),K.type=="string")throw new Error("Cannot write WK3 to JS string");var W=_m();Wn(W,0,a(B));for(var ae=0,xe=0;ae<B.SheetNames.length;++ae)(B.Sheets[B.SheetNames[ae]]||{})["!ref"]&&Wn(W,27,G(B.SheetNames[ae],xe++));var ke=0;for(ae=0;ae<B.SheetNames.length;++ae){var fe=B.Sheets[B.SheetNames[ae]];if(!(!fe||!fe["!ref"])){for(var pe=jt(fe["!ref"]),$e=Array.isArray(fe),z=[],ot=Math.min(pe.e.r,8191),We=pe.s.r;We<=ot;++We)for(var nt=Er(We),be=pe.s.c;be<=pe.e.c;++be){We===pe.s.r&&(z[be]=nr(be));var Ie=z[be]+nt,Et=$e?(fe[We]||[])[be]:fe[Ie];if(!(!Et||Et.t=="z"))if(Et.t=="n")Wn(W,23,C(We,be,ke,Et.v));else{var ar=cs(Et);Wn(W,22,g(We,be,ke,ar.slice(0,239)))}}++ke}}return Wn(W,1),W.end()}function s(B){var X=er(2);return X.write_shift(2,B),X}function a(B){var X=er(26);X.write_shift(2,4096),X.write_shift(2,4),X.write_shift(4,0);for(var K=0,W=0,ae=0,xe=0;xe<B.SheetNames.length;++xe){var ke=B.SheetNames[xe],fe=B.Sheets[ke];if(!(!fe||!fe["!ref"])){++ae;var pe=_l(fe["!ref"]);K<pe.e.r&&(K=pe.e.r),W<pe.e.c&&(W=pe.e.c)}}return K>8191&&(K=8191),X.write_shift(2,K),X.write_shift(1,ae),X.write_shift(1,W),X.write_shift(2,0),X.write_shift(2,0),X.write_shift(1,1),X.write_shift(1,2),X.write_shift(4,0),X.write_shift(4,0),X}function o(B,X,K){var W={s:{c:0,r:0},e:{c:0,r:0}};return X==8&&K.qpro?(W.s.c=B.read_shift(1),B.l++,W.s.r=B.read_shift(2),W.e.c=B.read_shift(1),B.l++,W.e.r=B.read_shift(2),W):(W.s.c=B.read_shift(2),W.s.r=B.read_shift(2),X==12&&K.qpro&&(B.l+=2),W.e.c=B.read_shift(2),W.e.r=B.read_shift(2),X==12&&K.qpro&&(B.l+=2),W.s.c==65535&&(W.s.c=W.e.c=W.s.r=W.e.r=0),W)}function l(B){var X=er(8);return X.write_shift(2,B.s.c),X.write_shift(2,B.s.r),X.write_shift(2,B.e.c),X.write_shift(2,B.e.r),X}function c(B,X,K){var W=[{c:0,r:0},{t:"n",v:0},0,0];return K.qpro&&K.vers!=20768?(W[0].c=B.read_shift(1),W[3]=B.read_shift(1),W[0].r=B.read_shift(2),B.l+=2):(W[2]=B.read_shift(1),W[0].c=B.read_shift(2),W[0].r=B.read_shift(2)),W}function u(B,X,K){var W=B.l+X,ae=c(B,X,K);if(ae[1].t="s",K.vers==20768){B.l++;var xe=B.read_shift(1);return ae[1].v=B.read_shift(xe,"utf8"),ae}return K.qpro&&B.l++,ae[1].v=B.read_shift(W-B.l,"cstr"),ae}function h(B,X,K){var W=er(7+K.length);W.write_shift(1,255),W.write_shift(2,X),W.write_shift(2,B),W.write_shift(1,39);for(var ae=0;ae<W.length;++ae){var xe=K.charCodeAt(ae);W.write_shift(1,xe>=128?95:xe)}return W.write_shift(1,0),W}function d(B,X,K){var W=c(B,X,K);return W[1].v=B.read_shift(2,"i"),W}function p(B,X,K){var W=er(7);return W.write_shift(1,255),W.write_shift(2,X),W.write_shift(2,B),W.write_shift(2,K,"i"),W}function x(B,X,K){var W=c(B,X,K);return W[1].v=B.read_shift(8,"f"),W}function v(B,X,K){var W=er(13);return W.write_shift(1,255),W.write_shift(2,X),W.write_shift(2,B),W.write_shift(8,K,"f"),W}function E(B,X,K){var W=B.l+X,ae=c(B,X,K);if(ae[1].v=B.read_shift(8,"f"),K.qpro)B.l=W;else{var xe=B.read_shift(2);R(B.slice(B.l,B.l+xe),ae),B.l+=xe}return ae}function T(B,X,K){var W=X&32768;return X&=-32769,X=(W?B:0)+(X>=8192?X-16384:X),(W?"":"$")+(K?nr(X):Er(X))}var w={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},y=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function R(B,X){vr(B,0);for(var K=[],W=0,ae="",xe="",ke="",fe="";B.l<B.length;){var pe=B[B.l++];switch(pe){case 0:K.push(B.read_shift(8,"f"));break;case 1:xe=T(X[0].c,B.read_shift(2),!0),ae=T(X[0].r,B.read_shift(2),!1),K.push(xe+ae);break;case 2:{var $e=T(X[0].c,B.read_shift(2),!0),z=T(X[0].r,B.read_shift(2),!1);xe=T(X[0].c,B.read_shift(2),!0),ae=T(X[0].r,B.read_shift(2),!1),K.push($e+z+":"+xe+ae)}break;case 3:if(B.l<B.length){console.error("WK1 premature formula end");return}break;case 4:K.push("("+K.pop()+")");break;case 5:K.push(B.read_shift(2));break;case 6:{for(var ot="";pe=B[B.l++];)ot+=String.fromCharCode(pe);K.push('"'+ot.replace(/"/g,'""')+'"')}break;case 8:K.push("-"+K.pop());break;case 23:K.push("+"+K.pop());break;case 22:K.push("NOT("+K.pop()+")");break;case 20:case 21:fe=K.pop(),ke=K.pop(),K.push(["AND","OR"][pe-20]+"("+ke+","+fe+")");break;default:if(pe<32&&y[pe])fe=K.pop(),ke=K.pop(),K.push(ke+y[pe]+fe);else if(w[pe]){if(W=w[pe][1],W==69&&(W=B[B.l++]),W>K.length){console.error("WK1 bad formula parse 0x"+pe.toString(16)+":|"+K.join("|")+"|");return}var We=K.slice(-W);K.length-=W,K.push(w[pe][0]+"("+We.join(",")+")")}else return pe<=7?console.error("WK1 invalid opcode "+pe.toString(16)):pe<=24?console.error("WK1 unsupported op "+pe.toString(16)):pe<=30?console.error("WK1 invalid opcode "+pe.toString(16)):pe<=115?console.error("WK1 unsupported function opcode "+pe.toString(16)):console.error("WK1 unrecognized opcode "+pe.toString(16))}}K.length==1?X[1].f=""+K[0]:console.error("WK1 bad formula parse |"+K.join("|")+"|")}function M(B){var X=[{c:0,r:0},{t:"n",v:0},0];return X[0].r=B.read_shift(2),X[3]=B[B.l++],X[0].c=B[B.l++],X}function j(B,X){var K=M(B);return K[1].t="s",K[1].v=B.read_shift(X-4,"cstr"),K}function g(B,X,K,W){var ae=er(6+W.length);ae.write_shift(2,B),ae.write_shift(1,K),ae.write_shift(1,X),ae.write_shift(1,39);for(var xe=0;xe<W.length;++xe){var ke=W.charCodeAt(xe);ae.write_shift(1,ke>=128?95:ke)}return ae.write_shift(1,0),ae}function k(B,X){var K=M(B);K[1].v=B.read_shift(2);var W=K[1].v>>1;if(K[1].v&1)switch(W&7){case 0:W=(W>>3)*5e3;break;case 1:W=(W>>3)*500;break;case 2:W=(W>>3)/20;break;case 3:W=(W>>3)/200;break;case 4:W=(W>>3)/2e3;break;case 5:W=(W>>3)/2e4;break;case 6:W=(W>>3)/16;break;case 7:W=(W>>3)/64;break}return K[1].v=W,K}function S(B,X){var K=M(B),W=B.read_shift(4),ae=B.read_shift(4),xe=B.read_shift(2);if(xe==65535)return W===0&&ae===3221225472?(K[1].t="e",K[1].v=15):W===0&&ae===3489660928?(K[1].t="e",K[1].v=42):K[1].v=0,K;var ke=xe&32768;return xe=(xe&32767)-16446,K[1].v=(1-ke*2)*(ae*Math.pow(2,xe+32)+W*Math.pow(2,xe)),K}function C(B,X,K,W){var ae=er(14);if(ae.write_shift(2,B),ae.write_shift(1,K),ae.write_shift(1,X),W==0)return ae.write_shift(4,0),ae.write_shift(4,0),ae.write_shift(2,65535),ae;var xe=0,ke=0,fe=0,pe=0;return W<0&&(xe=1,W=-W),ke=Math.log2(W)|0,W/=Math.pow(2,ke-31),pe=W>>>0,pe&2147483648||(W/=2,++ke,pe=W>>>0),W-=pe,pe|=2147483648,pe>>>=0,W*=Math.pow(2,32),fe=W>>>0,ae.write_shift(4,fe),ae.write_shift(4,pe),ke+=16383+(xe?32768:0),ae.write_shift(2,ke),ae}function F(B,X){var K=S(B);return B.l+=X-14,K}function P(B,X){var K=M(B),W=B.read_shift(4);return K[1].v=W>>6,K}function b(B,X){var K=M(B),W=B.read_shift(8,"f");return K[1].v=W,K}function ve(B,X){var K=b(B);return B.l+=X-10,K}function he(B,X){return B[B.l+X-1]==0?B.read_shift(X,"cstr"):""}function Se(B,X){var K=B[B.l++];K>X-1&&(K=X-1);for(var W="";W.length<K;)W+=String.fromCharCode(B[B.l++]);return W}function oe(B,X,K){if(!(!K.qpro||X<21)){var W=B.read_shift(1);B.l+=17,B.l+=1,B.l+=2;var ae=B.read_shift(X-21,"cstr");return[W,ae]}}function ie(B,X){for(var K={},W=B.l+X;B.l<W;){var ae=B.read_shift(2);if(ae==14e3){for(K[ae]=[0,""],K[ae][0]=B.read_shift(2);B[B.l];)K[ae][1]+=String.fromCharCode(B[B.l]),B.l++;B.l++}}return K}function G(B,X){var K=er(5+B.length);K.write_shift(2,14e3),K.write_shift(2,X);for(var W=0;W<B.length;++W){var ae=B.charCodeAt(W);K[K.l++]=ae>127?95:ae}return K[K.l++]=0,K}var ue={0:{n:"BOF",f:qt},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:o},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:d},14:{n:"NUMBER",f:x},15:{n:"LABEL",f:u},16:{n:"FORMULA",f:E},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:u},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:he},222:{n:"SHEETNAMELP",f:Se},65535:{n:""}},Ee={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:j},23:{n:"NUMBER17",f:S},24:{n:"NUMBER18",f:k},25:{n:"FORMULA19",f:F},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:ie},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:P},38:{n:"??"},39:{n:"NUMBER27",f:b},40:{n:"FORMULA28",f:ve},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:he},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:oe},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:n,book_to_wk3:i,to_workbook:e}}();function U5(t){var e={},r=t.match(zr),n=0,i=!1;if(r)for(;n!=r.length;++n){var s=Oe(r[n]);switch(s[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!s.val)break;case"<shadow>":case"<shadow/>":e.shadow=1;break;case"</shadow>":break;case"<charset":if(s.val=="1")break;e.cp=Av[parseInt(s.val,10)];break;case"<outline":if(!s.val)break;case"<outline>":case"<outline/>":e.outline=1;break;case"</outline>":break;case"<rFont":e.name=s.val;break;case"<sz":e.sz=s.val;break;case"<strike":if(!s.val)break;case"<strike>":case"<strike/>":e.strike=1;break;case"</strike>":break;case"<u":if(!s.val)break;switch(s.val){case"double":e.uval="double";break;case"singleAccounting":e.uval="single-accounting";break;case"doubleAccounting":e.uval="double-accounting";break}case"<u>":case"<u/>":e.u=1;break;case"</u>":break;case"<b":if(s.val=="0")break;case"<b>":case"<b/>":e.b=1;break;case"</b>":break;case"<i":if(s.val=="0")break;case"<i>":case"<i/>":e.i=1;break;case"</i>":break;case"<color":s.rgb&&(e.color=s.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":e.family=s.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":e.valign=s.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(s[0].charCodeAt(1)!==47&&!i)throw new Error("Unrecognized rich format "+s[0])}}return e}var j5=function(){var t=nu("t"),e=nu("rPr");function r(s){var a=s.match(t);if(!a)return{t:"s",v:""};var o={t:"s",v:at(a[1])},l=s.match(e);return l&&(o.s=U5(l[1])),o}var n=/<(?:\w+:)?r>/g,i=/<\/(?:\w+:)?r>/;return function(a){return a.replace(n,"").split(i).map(r).filter(function(o){return o.v})}}(),B5=function(){var e=/(\r\n|\n)/g;function r(i,s,a){var o=[];i.u&&o.push("text-decoration: underline;"),i.uval&&o.push("text-underline-style:"+i.uval+";"),i.sz&&o.push("font-size:"+i.sz+"pt;"),i.outline&&o.push("text-effect: outline;"),i.shadow&&o.push("text-shadow: auto;"),s.push('<span style="'+o.join("")+'">'),i.b&&(s.push("<b>"),a.push("</b>")),i.i&&(s.push("<i>"),a.push("</i>")),i.strike&&(s.push("<s>"),a.push("</s>"));var l=i.valign||"";return l=="superscript"||l=="super"?l="sup":l=="subscript"&&(l="sub"),l!=""&&(s.push("<"+l+">"),a.push("</"+l+">")),a.push("</span>"),i}function n(i){var s=[[],i.v,[]];return i.v?(i.s&&r(i.s,s[0],s[2]),s[0].join("")+s[1].replace(e,"<br/>")+s[2].join("")):""}return function(s){return s.map(n).join("")}}(),z5=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,$5=/<(?:\w+:)?r>/,H5=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function $v(t,e){var r=e?e.cellHTML:!0,n={};return t?(t.match(/^\s*<(?:\w+:)?t[^>]*>/)?(n.t=at(wt(t.slice(t.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),n.r=wt(t),r&&(n.h=Dv(n.t))):t.match($5)&&(n.r=wt(t),n.t=at(wt((t.replace(H5,"").match(z5)||[]).join("").replace(zr,""))),r&&(n.h=B5(j5(n.r)))),n):{t:""}}var W5=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,G5=/<(?:\w+:)?(?:si|sstItem)>/g,K5=/<\/(?:\w+:)?(?:si|sstItem)>/;function q5(t,e){var r=[],n="";if(!t)return r;var i=t.match(W5);if(i){n=i[2].replace(G5,"").split(K5);for(var s=0;s!=n.length;++s){var a=$v(n[s].trim(),e);a!=null&&(r[r.length]=a)}i=Oe(i[1]),r.Count=i.count,r.Unique=i.uniqueCount}return r}function X5(t){return[t.read_shift(4),t.read_shift(4)]}function Y5(t,e){var r=[],n=!1;return ds(t,function(s,a,o){switch(o){case 159:r.Count=s[0],r.Unique=s[1];break;case 19:r.push(s);break;case 160:return!0;case 35:n=!0;break;case 36:n=!1;break;default:if(a.T,!n||e.WTF)throw new Error("Unexpected record 0x"+o.toString(16))}}),r}function LA(t){for(var e=[],r=t.split(""),n=0;n<r.length;++n)e[n]=r[n].charCodeAt(0);return e}function Ji(t,e){var r={};return r.Major=t.read_shift(2),r.Minor=t.read_shift(2),e>=4&&(t.l+=e-4),r}function Q5(t){var e={};return e.id=t.read_shift(0,"lpp4"),e.R=Ji(t,4),e.U=Ji(t,4),e.W=Ji(t,4),e}function J5(t){for(var e=t.read_shift(4),r=t.l+e-4,n={},i=t.read_shift(4),s=[];i-- >0;)s.push({t:t.read_shift(4),v:t.read_shift(0,"lpp4")});if(n.name=t.read_shift(0,"lpp4"),n.comps=s,t.l!=r)throw new Error("Bad DataSpaceMapEntry: "+t.l+" != "+r);return n}function Z5(t){var e=[];t.l+=4;for(var r=t.read_shift(4);r-- >0;)e.push(J5(t));return e}function e9(t){var e=[];t.l+=4;for(var r=t.read_shift(4);r-- >0;)e.push(t.read_shift(0,"lpp4"));return e}function t9(t){var e={};return t.read_shift(4),t.l+=4,e.id=t.read_shift(0,"lpp4"),e.name=t.read_shift(0,"lpp4"),e.R=Ji(t,4),e.U=Ji(t,4),e.W=Ji(t,4),e}function r9(t){var e=t9(t);if(e.ename=t.read_shift(0,"8lpp4"),e.blksz=t.read_shift(4),e.cmode=t.read_shift(4),t.read_shift(4)!=4)throw new Error("Bad !Primary record");return e}function MA(t,e){var r=t.l+e,n={};n.Flags=t.read_shift(4)&63,t.l+=4,n.AlgID=t.read_shift(4);var i=!1;switch(n.AlgID){case 26126:case 26127:case 26128:i=n.Flags==36;break;case 26625:i=n.Flags==4;break;case 0:i=n.Flags==16||n.Flags==4||n.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+n.AlgID}if(!i)throw new Error("Encryption Flags/AlgID mismatch");return n.AlgIDHash=t.read_shift(4),n.KeySize=t.read_shift(4),n.ProviderType=t.read_shift(4),t.l+=8,n.CSPName=t.read_shift(r-t.l>>1,"utf16le"),t.l=r,n}function VA(t,e){var r={},n=t.l+e;return t.l+=4,r.Salt=t.slice(t.l,t.l+16),t.l+=16,r.Verifier=t.slice(t.l,t.l+16),t.l+=16,t.read_shift(4),r.VerifierHash=t.slice(t.l,n),t.l=n,r}function n9(t){var e=Ji(t);switch(e.Minor){case 2:return[e.Minor,i9(t)];case 3:return[e.Minor,s9()];case 4:return[e.Minor,a9(t)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+e.Minor)}function i9(t){var e=t.read_shift(4);if((e&63)!=36)throw new Error("EncryptionInfo mismatch");var r=t.read_shift(4),n=MA(t,r),i=VA(t,t.length-t.l);return{t:"Std",h:n,v:i}}function s9(){throw new Error("File is password-protected: ECMA-376 Extensible")}function a9(t){var e=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];t.l+=4;var r=t.read_shift(t.length-t.l,"utf8"),n={};return r.replace(zr,function(s){var a=Oe(s);switch(Ri(a[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":e.forEach(function(o){n[o]=a[o]});break;case"<dataIntegrity":n.encryptedHmacKey=a.encryptedHmacKey,n.encryptedHmacValue=a.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":n.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":n.uri=a.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":n.encs.push(a);break;default:throw a[0]}}),n}function o9(t,e){var r={},n=r.EncryptionVersionInfo=Ji(t,4);if(e-=4,n.Minor!=2)throw new Error("unrecognized minor version code: "+n.Minor);if(n.Major>4||n.Major<2)throw new Error("unrecognized major version code: "+n.Major);r.Flags=t.read_shift(4),e-=4;var i=t.read_shift(4);return e-=4,r.EncryptionHeader=MA(t,i),e-=i,r.EncryptionVerifier=VA(t,e),r}function l9(t){var e={},r=e.EncryptionVersionInfo=Ji(t,4);if(r.Major!=1||r.Minor!=1)throw"unrecognized version code "+r.Major+" : "+r.Minor;return e.Salt=t.read_shift(16),e.EncryptedVerifier=t.read_shift(16),e.EncryptedVerifierHash=t.read_shift(16),e}function c9(t){var e=0,r,n=LA(t),i=n.length+1,s,a,o,l,c;for(r=Zs(i),r[0]=n.length,s=1;s!=i;++s)r[s]=n[s-1];for(s=i-1;s>=0;--s)a=r[s],o=e&16384?1:0,l=e<<1&32767,c=o|l,e=c^a;return e^52811}var UA=function(){var t=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],e=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],r=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],n=function(a){return(a/2|a*128)&255},i=function(a,o){return n(a^o)},s=function(a){for(var o=e[a.length-1],l=104,c=a.length-1;c>=0;--c)for(var u=a[c],h=0;h!=7;++h)u&64&&(o^=r[l]),u*=2,--l;return o};return function(a){for(var o=LA(a),l=s(o),c=o.length,u=Zs(16),h=0;h!=16;++h)u[h]=0;var d,p,x;for((c&1)===1&&(d=l>>8,u[c]=i(t[0],d),--c,d=l&255,p=o[o.length-1],u[c]=i(p,d));c>0;)--c,d=l>>8,u[c]=i(o[c],d),--c,d=l&255,u[c]=i(o[c],d);for(c=15,x=15-o.length;x>0;)d=l>>8,u[c]=i(t[x],d),--c,--x,d=l&255,u[c]=i(o[c],d),--c,--x;return u}}(),u9=function(t,e,r,n,i){i||(i=e),n||(n=UA(t));var s,a;for(s=0;s!=e.length;++s)a=e[s],a^=n[r],a=(a>>5|a<<3)&255,i[s]=a,++r;return[i,r,n]},f9=function(t){var e=0,r=UA(t);return function(n){var i=u9("",n,e,r);return e=i[1],i[0]}};function h9(t,e,r,n){var i={key:qt(t),verificationBytes:qt(t)};return r.password&&(i.verifier=c9(r.password)),n.valid=i.verificationBytes===i.verifier,n.valid&&(n.insitu=f9(r.password)),i}function d9(t,e,r){var n=r||{};return n.Info=t.read_shift(2),t.l-=2,n.Info===1?n.Data=l9(t):n.Data=o9(t,e),n}function p9(t,e,r){var n={Type:r.biff>=8?t.read_shift(2):0};return n.Type?d9(t,e-2,n):h9(t,r.biff>=8?e:e-2,r,n),n}var m9=function(){function t(i,s){switch(s.type){case"base64":return e(En(i),s);case"binary":return e(i,s);case"buffer":return e(Je&&Buffer.isBuffer(i)?i.toString("binary"):Ja(i),s);case"array":return e(ja(i),s)}throw new Error("Unrecognized type "+s.type)}function e(i,s){var a=s||{},o=a.dense?[]:{},l=i.match(/\\trowd.*?\\row\b/g);if(!l.length)throw new Error("RTF missing table");var c={s:{c:0,r:0},e:{c:0,r:l.length-1}};return l.forEach(function(u,h){Array.isArray(o)&&(o[h]=[]);for(var d=/\\\w+\b/g,p=0,x,v=-1;x=d.exec(u);){switch(x[0]){case"\\cell":var E=u.slice(p,d.lastIndex-x[0].length);if(E[0]==" "&&(E=E.slice(1)),++v,E.length){var T={v:E,t:"s"};Array.isArray(o)?o[h][v]=T:o[je({r:h,c:v})]=T}break}p=d.lastIndex}v>c.e.c&&(c.e.c=v)}),o["!ref"]=rt(c),o}function r(i,s){return aa(t(i,s),s)}function n(i){for(var s=["{\\rtf1\\ansi"],a=jt(i["!ref"]),o,l=Array.isArray(i),c=a.s.r;c<=a.e.r;++c){s.push("\\trowd\\trautofit1");for(var u=a.s.c;u<=a.e.c;++u)s.push("\\cellx"+(u+1));for(s.push("\\pard\\intbl"),u=a.s.c;u<=a.e.c;++u){var h=je({r:c,c:u});o=l?(i[c]||[])[u]:i[h],!(!o||o.v==null&&(!o.f||o.F))&&(s.push(" "+(o.w||(cs(o),o.w))),s.push("\\cell"))}s.push("\\pard\\intbl\\row")}return s.join("")+"}"}return{to_workbook:r,to_sheet:t,from_sheet:n}}();function g9(t){var e=t.slice(t[0]==="#"?1:0).slice(0,6);return[parseInt(e.slice(0,2),16),parseInt(e.slice(2,4),16),parseInt(e.slice(4,6),16)]}function au(t){for(var e=0,r=1;e!=3;++e)r=r*256+(t[e]>255?255:t[e]<0?0:t[e]);return r.toString(16).toUpperCase().slice(1)}function v9(t){var e=t[0]/255,r=t[1]/255,n=t[2]/255,i=Math.max(e,r,n),s=Math.min(e,r,n),a=i-s;if(a===0)return[0,0,e];var o=0,l=0,c=i+s;switch(l=a/(c>1?2-c:c),i){case e:o=((r-n)/a+6)%6;break;case r:o=(n-e)/a+2;break;case n:o=(e-r)/a+4;break}return[o/6,l,c/2]}function x9(t){var e=t[0],r=t[1],n=t[2],i=r*2*(n<.5?n:1-n),s=n-i/2,a=[s,s,s],o=6*e,l;if(r!==0)switch(o|0){case 0:case 6:l=i*o,a[0]+=i,a[1]+=l;break;case 1:l=i*(2-o),a[0]+=l,a[1]+=i;break;case 2:l=i*(o-2),a[1]+=i,a[2]+=l;break;case 3:l=i*(4-o),a[1]+=l,a[2]+=i;break;case 4:l=i*(o-4),a[2]+=i,a[0]+=l;break;case 5:l=i*(6-o),a[2]+=l,a[0]+=i;break}for(var c=0;c!=3;++c)a[c]=Math.round(a[c]*255);return a}function Yh(t,e){if(e===0)return t;var r=v9(g9(t));return e<0?r[2]=r[2]*(1+e):r[2]=1-(1-r[2])*(1-e),au(x9(r))}var jA=6,_9=15,y9=1,Wr=jA;function Qh(t){return Math.floor((t+Math.round(128/Wr)/256)*Wr)}function Jh(t){return Math.floor((t-5)/Wr*100+.5)/100}function Tm(t){return Math.round((t*Wr+5)/Wr*256)/256}function $d(t){return Tm(Jh(Qh(t)))}function Hv(t){var e=Math.abs(t-$d(t)),r=Wr;if(e>.005)for(Wr=y9;Wr<_9;++Wr)Math.abs(t-$d(t))<=e&&(e=Math.abs(t-$d(t)),r=Wr);Wr=r}function ll(t){t.width?(t.wpx=Qh(t.width),t.wch=Jh(t.wpx),t.MDW=Wr):t.wpx?(t.wch=Jh(t.wpx),t.width=Tm(t.wch),t.MDW=Wr):typeof t.wch=="number"&&(t.width=Tm(t.wch),t.wpx=Qh(t.width),t.MDW=Wr),t.customWidth&&delete t.customWidth}var w9=96,BA=w9;function zA(t){return t*96/BA}function ou(t){return t*BA/96}var E9={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function T9(t,e,r,n){e.Borders=[];var i={},s=!1;(t[0].match(zr)||[]).forEach(function(a){var o=Oe(a);switch(Ri(o[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":i={},o.diagonalUp&&(i.diagonalUp=Nt(o.diagonalUp)),o.diagonalDown&&(i.diagonalDown=Nt(o.diagonalDown)),e.Borders.push(i);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+o[0]+" in borders")}})}function k9(t,e,r,n){e.Fills=[];var i={},s=!1;(t[0].match(zr)||[]).forEach(function(a){var o=Oe(a);switch(Ri(o[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":i={},e.Fills.push(i);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":e.Fills.push(i),i={};break;case"<patternFill":case"<patternFill>":o.patternType&&(i.patternType=o.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":i.bgColor||(i.bgColor={}),o.indexed&&(i.bgColor.indexed=parseInt(o.indexed,10)),o.theme&&(i.bgColor.theme=parseInt(o.theme,10)),o.tint&&(i.bgColor.tint=parseFloat(o.tint)),o.rgb&&(i.bgColor.rgb=o.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":i.fgColor||(i.fgColor={}),o.theme&&(i.fgColor.theme=parseInt(o.theme,10)),o.tint&&(i.fgColor.tint=parseFloat(o.tint)),o.rgb!=null&&(i.fgColor.rgb=o.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+o[0]+" in fills")}})}function S9(t,e,r,n){e.Fonts=[];var i={},s=!1;(t[0].match(zr)||[]).forEach(function(a){var o=Oe(a);switch(Ri(o[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":e.Fonts.push(i),i={};break;case"<name":o.val&&(i.name=wt(o.val));break;case"<name/>":case"</name>":break;case"<b":i.bold=o.val?Nt(o.val):1;break;case"<b/>":i.bold=1;break;case"<i":i.italic=o.val?Nt(o.val):1;break;case"<i/>":i.italic=1;break;case"<u":switch(o.val){case"none":i.underline=0;break;case"single":i.underline=1;break;case"double":i.underline=2;break;case"singleAccounting":i.underline=33;break;case"doubleAccounting":i.underline=34;break}break;case"<u/>":i.underline=1;break;case"<strike":i.strike=o.val?Nt(o.val):1;break;case"<strike/>":i.strike=1;break;case"<outline":i.outline=o.val?Nt(o.val):1;break;case"<outline/>":i.outline=1;break;case"<shadow":i.shadow=o.val?Nt(o.val):1;break;case"<shadow/>":i.shadow=1;break;case"<condense":i.condense=o.val?Nt(o.val):1;break;case"<condense/>":i.condense=1;break;case"<extend":i.extend=o.val?Nt(o.val):1;break;case"<extend/>":i.extend=1;break;case"<sz":o.val&&(i.sz=+o.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":o.val&&(i.vertAlign=o.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":o.val&&(i.family=parseInt(o.val,10));break;case"<family/>":case"</family>":break;case"<scheme":o.val&&(i.scheme=o.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(o.val=="1")break;o.codepage=Av[parseInt(o.val,10)];break;case"<color":if(i.color||(i.color={}),o.auto&&(i.color.auto=Nt(o.auto)),o.rgb)i.color.rgb=o.rgb.slice(-6);else if(o.indexed){i.color.index=parseInt(o.indexed,10);var l=Ia[i.color.index];i.color.index==81&&(l=Ia[1]),l||(l=Ia[1]),i.color.rgb=l[0].toString(16)+l[1].toString(16)+l[2].toString(16)}else o.theme&&(i.color.theme=parseInt(o.theme,10),o.tint&&(i.color.tint=parseFloat(o.tint)),o.theme&&r.themeElements&&r.themeElements.clrScheme&&(i.color.rgb=Yh(r.themeElements.clrScheme[i.color.theme].rgb,i.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":s=!0;break;case"</AlternateContent>":s=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+o[0]+" in fonts")}})}function A9(t,e,r){e.NumberFmt=[];for(var n=ki(ze),i=0;i<n.length;++i)e.NumberFmt[n[i]]=ze[n[i]];var s=t[0].match(zr);if(s)for(i=0;i<s.length;++i){var a=Oe(s[i]);switch(Ri(a[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var o=at(wt(a.formatCode)),l=parseInt(a.numFmtId,10);if(e.NumberFmt[l]=o,l>0){if(l>392){for(l=392;l>60&&e.NumberFmt[l]!=null;--l);e.NumberFmt[l]=o}Aa(o,l)}}break;case"</numFmt>":break;default:if(r.WTF)throw new Error("unrecognized "+a[0]+" in numFmts")}}}var kf=["numFmtId","fillId","fontId","borderId","xfId"],Sf=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function I9(t,e,r){e.CellXf=[];var n,i=!1;(t[0].match(zr)||[]).forEach(function(s){var a=Oe(s),o=0;switch(Ri(a[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(n=a,delete n[0],o=0;o<kf.length;++o)n[kf[o]]&&(n[kf[o]]=parseInt(n[kf[o]],10));for(o=0;o<Sf.length;++o)n[Sf[o]]&&(n[Sf[o]]=Nt(n[Sf[o]]));if(e.NumberFmt&&n.numFmtId>392){for(o=392;o>60;--o)if(e.NumberFmt[n.numFmtId]==e.NumberFmt[o]){n.numFmtId=o;break}}e.CellXf.push(n);break;case"</xf>":break;case"<alignment":case"<alignment/>":var l={};a.vertical&&(l.vertical=a.vertical),a.horizontal&&(l.horizontal=a.horizontal),a.textRotation!=null&&(l.textRotation=a.textRotation),a.indent&&(l.indent=a.indent),a.wrapText&&(l.wrapText=Nt(a.wrapText)),n.alignment=l;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":i=!0;break;case"</AlternateContent>":i=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(r&&r.WTF&&!i)throw new Error("unrecognized "+a[0]+" in cellXfs")}})}var C9=function(){var e=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,r=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,n=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,i=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,s=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(o,l,c){var u={};if(!o)return u;o=o.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var h;return(h=o.match(e))&&A9(h,u,c),(h=o.match(i))&&S9(h,u,l,c),(h=o.match(n))&&k9(h,u,l,c),(h=o.match(s))&&T9(h,u,l,c),(h=o.match(r))&&I9(h,u,c),u}}();function R9(t,e){var r=t.read_shift(2),n=Vr(t);return[r,n]}function N9(t,e,r){var n={};n.sz=t.read_shift(2)/20;var i=jM(t);i.fItalic&&(n.italic=1),i.fCondense&&(n.condense=1),i.fExtend&&(n.extend=1),i.fShadow&&(n.shadow=1),i.fOutline&&(n.outline=1),i.fStrikeout&&(n.strike=1);var s=t.read_shift(2);switch(s===700&&(n.bold=1),t.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var a=t.read_shift(1);a!=0&&(n.underline=a);var o=t.read_shift(1);o>0&&(n.family=o);var l=t.read_shift(1);switch(l>0&&(n.charset=l),t.l++,n.color=UM(t),t.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=Vr(t),n}var P9=Br;function F9(t,e){var r=t.l+e,n=t.read_shift(2),i=t.read_shift(2);return t.l=r,{ixfe:n,numFmtId:i}}var D9=Br;function b9(t,e,r){var n={};n.NumberFmt=[];for(var i in ze)n.NumberFmt[i]=ze[i];n.CellXf=[],n.Fonts=[];var s=[],a=!1;return ds(t,function(l,c,u){switch(u){case 44:n.NumberFmt[l[0]]=l[1],Aa(l[1],l[0]);break;case 43:n.Fonts.push(l),l.color.theme!=null&&e&&e.themeElements&&e.themeElements.clrScheme&&(l.color.rgb=Yh(e.themeElements.clrScheme[l.color.theme].rgb,l.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:s[s.length-1]==617&&n.CellXf.push(l);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:a=!0;break;case 36:a=!1;break;case 37:s.push(u),a=!0;break;case 38:s.pop(),a=!1;break;default:if(c.T>0)s.push(u);else if(c.T<0)s.pop();else if(!a||r.WTF&&s[s.length-1]!=37)throw new Error("Unexpected record 0x"+u.toString(16))}}),n}var O9=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function L9(t,e,r){e.themeElements.clrScheme=[];var n={};(t[0].match(zr)||[]).forEach(function(i){var s=Oe(i);switch(s[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":n.rgb=s.val;break;case"<a:sysClr":n.rgb=s.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":s[0].charAt(1)==="/"?(e.themeElements.clrScheme[O9.indexOf(s[0])]=n,n={}):n.name=s[0].slice(3,s[0].length-1);break;default:if(r&&r.WTF)throw new Error("Unrecognized "+s[0]+" in clrScheme")}})}function M9(){}function V9(){}var U9=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,j9=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,B9=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function z9(t,e,r){e.themeElements={};var n;[["clrScheme",U9,L9],["fontScheme",j9,M9],["fmtScheme",B9,V9]].forEach(function(i){if(!(n=t.match(i[1])))throw new Error(i[0]+" not found in themeElements");i[2](n,e,r)})}var $9=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function $A(t,e){(!t||t.length===0)&&(t=H9());var r,n={};if(!(r=t.match($9)))throw new Error("themeElements not found in theme");return z9(r[0],n,e),n.raw=t,n}function H9(t,e){var r=[eA];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function W9(t,e,r){var n=t.l+e,i=t.read_shift(4);if(i!==124226){if(!r.cellStyles){t.l=n;return}var s=t.slice(t.l);t.l=n;var a;try{a=ZS(s,{type:"array"})}catch{return}var o=gn(a,"theme/theme/theme1.xml",!0);if(o)return $A(o,r)}}function G9(t){return t.read_shift(4)}function K9(t){var e={};switch(e.xclrType=t.read_shift(2),e.nTintShade=t.read_shift(2),e.xclrType){case 0:t.l+=4;break;case 1:e.xclrValue=q9(t,4);break;case 2:e.xclrValue=RA(t);break;case 3:e.xclrValue=G9(t);break;case 4:t.l+=4;break}return t.l+=8,e}function q9(t,e){return Br(t,e)}function X9(t,e){return Br(t,e)}function Y9(t){var e=t.read_shift(2),r=t.read_shift(2)-4,n=[e];switch(e){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:n[1]=K9(t);break;case 6:n[1]=X9(t,r);break;case 14:case 15:n[1]=t.read_shift(r===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+e+" "+r)}return n}function Q9(t,e){var r=t.l+e;t.l+=2;var n=t.read_shift(2);t.l+=2;for(var i=t.read_shift(2),s=[];i-- >0;)s.push(Y9(t,r-t.l));return{ixfe:n,ext:s}}function J9(t,e){e.forEach(function(r){switch(r[0]){}})}function Z9(t,e){return{flags:t.read_shift(4),version:t.read_shift(4),name:Vr(t)}}function eV(t){for(var e=[],r=t.read_shift(4);r-- >0;)e.push([t.read_shift(4),t.read_shift(4)]);return e}function tV(t){return t.l+=4,t.read_shift(4)!=0}function rV(t,e,r){var n={Types:[],Cell:[],Value:[]},i=r||{},s=[],a=!1,o=2;return ds(t,function(l,c,u){switch(u){case 335:n.Types.push({name:l.name});break;case 51:l.forEach(function(h){o==1?n.Cell.push({type:n.Types[h[0]-1].name,index:h[1]}):o==0&&n.Value.push({type:n.Types[h[0]-1].name,index:h[1]})});break;case 337:o=l?1:0;break;case 338:o=2;break;case 35:s.push(u),a=!0;break;case 36:s.pop(),a=!1;break;default:if(!c.T){if(!a||i.WTF&&s[s.length-1]!=35)throw new Error("Unexpected record 0x"+u.toString(16))}}}),n}function nV(t,e,r){var n={Types:[],Cell:[],Value:[]};if(!t)return n;var i=!1,s=2,a;return t.replace(zr,function(o){var l=Oe(o);switch(Ri(l[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":n.Types.push({name:l.name});break;case"</metadataType>":break;case"<futureMetadata":for(var c=0;c<n.Types.length;++c)n.Types[c].name==l.name&&(a=n.Types[c]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":s==1?n.Cell.push({type:n.Types[l.t-1].name,index:+l.v}):s==0&&n.Value.push({type:n.Types[l.t-1].name,index:+l.v});break;case"</rc>":break;case"<cellMetadata":s=1;break;case"</cellMetadata>":s=2;break;case"<valueMetadata":s=0;break;case"</valueMetadata>":s=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;case"<rvb":if(!a)break;a.offsets||(a.offsets=[]),a.offsets.push(+l.i);break;default:if(!i&&r.WTF)throw new Error("unrecognized "+l[0]+" in metadata")}return o}),n}function iV(t){var e=[];if(!t)return e;var r=1;return(t.match(zr)||[]).forEach(function(n){var i=Oe(n);switch(i[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete i[0],i.i?r=i.i:i.i=r,e.push(i);break}}),e}function sV(t){var e={};e.i=t.read_shift(4);var r={};r.r=t.read_shift(4),r.c=t.read_shift(4),e.r=je(r);var n=t.read_shift(1);return n&2&&(e.l="1"),n&8&&(e.a="1"),e}function aV(t,e,r){var n=[];return ds(t,function(s,a,o){switch(o){case 63:n.push(s);break;default:if(!a.T)throw new Error("Unexpected record 0x"+o.toString(16))}}),n}function oV(t,e,r,n){if(!t)return t;var i=n||{},s=!1;ds(t,function(o,l,c){switch(c){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:s=!0;break;case 36:s=!1;break;default:if(!l.T){if(!s||i.WTF)throw new Error("Unexpected record 0x"+c.toString(16))}}},i)}function lV(t,e){if(!t)return"??";var r=(t.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return e["!id"][r].Target}function dw(t,e,r,n){var i=Array.isArray(t),s;e.forEach(function(a){var o=Gr(a.ref);if(i?(t[o.r]||(t[o.r]=[]),s=t[o.r][o.c]):s=t[a.ref],!s){s={t:"z"},i?t[o.r][o.c]=s:t[a.ref]=s;var l=jt(t["!ref"]||"BDWGO1000001:A1");l.s.r>o.r&&(l.s.r=o.r),l.e.r<o.r&&(l.e.r=o.r),l.s.c>o.c&&(l.s.c=o.c),l.e.c<o.c&&(l.e.c=o.c);var c=rt(l);c!==t["!ref"]&&(t["!ref"]=c)}s.c||(s.c=[]);var u={a:a.author,t:a.t,r:a.r,T:r};a.h&&(u.h=a.h);for(var h=s.c.length-1;h>=0;--h){if(!r&&s.c[h].T)return;r&&!s.c[h].T&&s.c.splice(h,1)}if(r&&n){for(h=0;h<n.length;++h)if(u.a==n[h].id){u.a=n[h].name||u.a;break}}s.c.push(u)})}function cV(t,e){if(t.match(/<(?:\w+:)?comments *\/>/))return[];var r=[],n=[],i=t.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);i&&i[1]&&i[1].split(/<\/\w*:?author>/).forEach(function(a){if(!(a===""||a.trim()==="")){var o=a.match(/<(?:\w+:)?author[^>]*>(.*)/);o&&r.push(o[1])}});var s=t.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return s&&s[1]&&s[1].split(/<\/\w*:?comment>/).forEach(function(a){if(!(a===""||a.trim()==="")){var o=a.match(/<(?:\w+:)?comment[^>]*>/);if(o){var l=Oe(o[0]),c={author:l.authorId&&r[l.authorId]||"sheetjsghost",ref:l.ref,guid:l.guid},u=Gr(l.ref);if(!(e.sheetRows&&e.sheetRows<=u.r)){var h=a.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),d=!!h&&!!h[1]&&$v(h[1])||{r:"",t:"",h:""};c.r=d.r,d.r=="<t></t>"&&(d.t=d.h=""),c.t=(d.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.cellHTML&&(c.h=d.h),n.push(c)}}}}),n}function uV(t,e){var r=[],n=!1,i={},s=0;return t.replace(zr,function(o,l){var c=Oe(o);switch(Ri(c[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":i={author:c.personId,guid:c.id,ref:c.ref,T:1};break;case"</threadedComment>":i.t!=null&&r.push(i);break;case"<text>":case"<text":s=l+o.length;break;case"</text>":i.t=t.slice(s,l).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":n=!0;break;case"</mentions>":n=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&e.WTF)throw new Error("unrecognized "+c[0]+" in threaded comments")}return o}),r}function fV(t,e){var r=[],n=!1;return t.replace(zr,function(s){var a=Oe(s);switch(Ri(a[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":r.push({name:a.displayname,id:a.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&e.WTF)throw new Error("unrecognized "+a[0]+" in threaded comments")}return s}),r}function hV(t){var e={};e.iauthor=t.read_shift(4);var r=eo(t);return e.rfx=r.s,e.ref=je(r.s),t.l+=16,e}var dV=Vr;function pV(t,e){var r=[],n=[],i={},s=!1;return ds(t,function(o,l,c){switch(c){case 632:n.push(o);break;case 635:i=o;break;case 637:i.t=o.t,i.h=o.h,i.r=o.r;break;case 636:if(i.author=n[i.iauthor],delete i.iauthor,e.sheetRows&&i.rfx&&e.sheetRows<=i.rfx.r)break;i.t||(i.t=""),delete i.rfx,r.push(i);break;case 3072:break;case 35:s=!0;break;case 36:s=!1;break;case 37:break;case 38:break;default:if(!l.T){if(!s||e.WTF)throw new Error("Unexpected record 0x"+c.toString(16))}}}),r}var mV="application/vnd.ms-office.vbaProject";function gV(t){var e=tt.utils.cfb_new({root:"R"});return t.FullPaths.forEach(function(r,n){if(!(r.slice(-1)==="/"||!r.match(/_VBA_PROJECT_CUR/))){var i=r.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");tt.utils.cfb_add(e,i,t.FileIndex[n].content)}}),tt.write(e)}function vV(){return{"!type":"dialog"}}function xV(){return{"!type":"dialog"}}function _V(){return{"!type":"macro"}}function yV(){return{"!type":"macro"}}var zo=function(){var t=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,e={r:0,c:0};function r(n,i,s,a){var o=!1,l=!1;s.length==0?l=!0:s.charAt(0)=="["&&(l=!0,s=s.slice(1,-1)),a.length==0?o=!0:a.charAt(0)=="["&&(o=!0,a=a.slice(1,-1));var c=s.length>0?parseInt(s,10)|0:0,u=a.length>0?parseInt(a,10)|0:0;return o?u+=e.c:--u,l?c+=e.r:--c,i+(o?"":"$")+nr(u)+(l?"":"$")+Er(c)}return function(i,s){return e=s,i.replace(t,r)}}(),HA=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,wV=function(){return function(e,r){return e.replace(HA,function(n,i,s,a,o,l){var c=Mv(a)-(s?0:r.c),u=Lv(l)-(o?0:r.r),h=u==0?"":o?u+1:"["+u+"]",d=c==0?"":s?c+1:"["+c+"]";return i+"R"+h+"C"+d})}}();function WA(t,e){return t.replace(HA,function(r,n,i,s,a,o){return n+(i=="$"?i+s:nr(Mv(s)+e.c))+(a=="$"?a+o:Er(Lv(o)+e.r))})}function EV(t,e,r){var n=_l(e),i=n.s,s=Gr(r),a={r:s.r-i.r,c:s.c-i.c};return WA(t,a)}function TV(t){return t.length!=1}function pw(t){return t.replace(/_xlfn\./g,"")}function Wt(t){t.l+=1}function ea(t,e){var r=t.read_shift(2);return[r&16383,r>>14&1,r>>15&1]}function GA(t,e,r){var n=2;if(r){if(r.biff>=2&&r.biff<=5)return KA(t);r.biff==12&&(n=4)}var i=t.read_shift(n),s=t.read_shift(n),a=ea(t),o=ea(t);return{s:{r:i,c:a[0],cRel:a[1],rRel:a[2]},e:{r:s,c:o[0],cRel:o[1],rRel:o[2]}}}function KA(t){var e=ea(t),r=ea(t),n=t.read_shift(1),i=t.read_shift(1);return{s:{r:e[0],c:n,cRel:e[1],rRel:e[2]},e:{r:r[0],c:i,cRel:r[1],rRel:r[2]}}}function kV(t,e,r){if(r.biff<8)return KA(t);var n=t.read_shift(r.biff==12?4:2),i=t.read_shift(r.biff==12?4:2),s=ea(t),a=ea(t);return{s:{r:n,c:s[0],cRel:s[1],rRel:s[2]},e:{r:i,c:a[0],cRel:a[1],rRel:a[2]}}}function qA(t,e,r){if(r&&r.biff>=2&&r.biff<=5)return SV(t);var n=t.read_shift(r&&r.biff==12?4:2),i=ea(t);return{r:n,c:i[0],cRel:i[1],rRel:i[2]}}function SV(t){var e=ea(t),r=t.read_shift(1);return{r:e[0],c:r,cRel:e[1],rRel:e[2]}}function AV(t){var e=t.read_shift(2),r=t.read_shift(2);return{r:e,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function IV(t,e,r){var n=r&&r.biff?r.biff:8;if(n>=2&&n<=5)return CV(t);var i=t.read_shift(n>=12?4:2),s=t.read_shift(2),a=(s&16384)>>14,o=(s&32768)>>15;if(s&=16383,o==1)for(;i>524287;)i-=1048576;if(a==1)for(;s>8191;)s=s-16384;return{r:i,c:s,cRel:a,rRel:o}}function CV(t){var e=t.read_shift(2),r=t.read_shift(1),n=(e&32768)>>15,i=(e&16384)>>14;return e&=16383,n==1&&e>=8192&&(e=e-16384),i==1&&r>=128&&(r=r-256),{r:e,c:r,cRel:i,rRel:n}}function RV(t,e,r){var n=(t[t.l++]&96)>>5,i=GA(t,r.biff>=2&&r.biff<=5?6:8,r);return[n,i]}function NV(t,e,r){var n=(t[t.l++]&96)>>5,i=t.read_shift(2,"i"),s=8;if(r)switch(r.biff){case 5:t.l+=12,s=6;break;case 12:s=12;break}var a=GA(t,s,r);return[n,i,a]}function PV(t,e,r){var n=(t[t.l++]&96)>>5;return t.l+=r&&r.biff>8?12:r.biff<8?6:8,[n]}function FV(t,e,r){var n=(t[t.l++]&96)>>5,i=t.read_shift(2),s=8;if(r)switch(r.biff){case 5:t.l+=12,s=6;break;case 12:s=12;break}return t.l+=s,[n,i]}function DV(t,e,r){var n=(t[t.l++]&96)>>5,i=kV(t,e-1,r);return[n,i]}function bV(t,e,r){var n=(t[t.l++]&96)>>5;return t.l+=r.biff==2?6:r.biff==12?14:7,[n]}function mw(t){var e=t[t.l+1]&1,r=1;return t.l+=4,[e,r]}function OV(t,e,r){t.l+=2;for(var n=t.read_shift(r&&r.biff==2?1:2),i=[],s=0;s<=n;++s)i.push(t.read_shift(r&&r.biff==2?1:2));return i}function LV(t,e,r){var n=t[t.l+1]&255?1:0;return t.l+=2,[n,t.read_shift(r&&r.biff==2?1:2)]}function MV(t,e,r){var n=t[t.l+1]&255?1:0;return t.l+=2,[n,t.read_shift(r&&r.biff==2?1:2)]}function VV(t){var e=t[t.l+1]&255?1:0;return t.l+=2,[e,t.read_shift(2)]}function UV(t,e,r){var n=t[t.l+1]&255?1:0;return t.l+=r&&r.biff==2?3:4,[n]}function XA(t){var e=t.read_shift(1),r=t.read_shift(1);return[e,r]}function jV(t){return t.read_shift(2),XA(t)}function BV(t){return t.read_shift(2),XA(t)}function zV(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var i=qA(t,0,r);return[n,i]}function $V(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var i=IV(t,0,r);return[n,i]}function HV(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var i=t.read_shift(2);r&&r.biff==5&&(t.l+=12);var s=qA(t,0,r);return[n,i,s]}function WV(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var i=t.read_shift(r&&r.biff<=3?1:2);return[GU[i],JA[i],n]}function GV(t,e,r){var n=t[t.l++],i=t.read_shift(1),s=r&&r.biff<=3?[n==88?-1:0,t.read_shift(1)]:KV(t);return[i,(s[0]===0?JA:WU)[s[1]]]}function KV(t){return[t[t.l+1]>>7,t.read_shift(2)&32767]}function qV(t,e,r){t.l+=r&&r.biff==2?3:4}function XV(t,e,r){if(t.l++,r&&r.biff==12)return[t.read_shift(4,"i"),0];var n=t.read_shift(2),i=t.read_shift(r&&r.biff==2?1:2);return[n,i]}function YV(t){return t.l++,to[t.read_shift(1)]}function QV(t){return t.l++,t.read_shift(2)}function JV(t){return t.l++,t.read_shift(1)!==0}function ZV(t){return t.l++,Lr(t)}function eU(t,e,r){return t.l++,Nu(t,e-1,r)}function tU(t,e){var r=[t.read_shift(1)];if(e==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=Bt(t,1)?"TRUE":"FALSE",e!=12&&(t.l+=7);break;case 37:case 16:r[1]=to[t[t.l]],t.l+=e==12?4:8;break;case 0:t.l+=8;break;case 1:r[1]=Lr(t);break;case 2:r[1]=ro(t,0,{biff:e>0&&e<8?2:e});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function rU(t,e,r){for(var n=t.read_shift(r.biff==12?4:2),i=[],s=0;s!=n;++s)i.push((r.biff==12?eo:H0)(t));return i}function nU(t,e,r){var n=0,i=0;r.biff==12?(n=t.read_shift(4),i=t.read_shift(4)):(i=1+t.read_shift(1),n=1+t.read_shift(2)),r.biff>=2&&r.biff<8&&(--n,--i==0&&(i=256));for(var s=0,a=[];s!=n&&(a[s]=[]);++s)for(var o=0;o!=i;++o)a[s][o]=tU(t,r.biff);return a}function iU(t,e,r){var n=t.read_shift(1)>>>5&3,i=!r||r.biff>=8?4:2,s=t.read_shift(i);switch(r.biff){case 2:t.l+=5;break;case 3:case 4:t.l+=8;break;case 5:t.l+=12;break}return[n,0,s]}function sU(t,e,r){if(r.biff==5)return aU(t);var n=t.read_shift(1)>>>5&3,i=t.read_shift(2),s=t.read_shift(4);return[n,i,s]}function aU(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2,"i");t.l+=8;var n=t.read_shift(2);return t.l+=12,[e,r,n]}function oU(t,e,r){var n=t.read_shift(1)>>>5&3;t.l+=r&&r.biff==2?3:4;var i=t.read_shift(r&&r.biff==2?1:2);return[n,i]}function lU(t,e,r){var n=t.read_shift(1)>>>5&3,i=t.read_shift(r&&r.biff==2?1:2);return[n,i]}function cU(t,e,r){var n=t.read_shift(1)>>>5&3;return t.l+=4,r.biff<8&&t.l--,r.biff==12&&(t.l+=2),[n]}function uU(t,e,r){var n=(t[t.l++]&96)>>5,i=t.read_shift(2),s=4;if(r)switch(r.biff){case 5:s=15;break;case 12:s=6;break}return t.l+=s,[n,i]}var fU=Br,hU=Br,dU=Br;function Fu(t,e,r){return t.l+=2,[AV(t)]}function Wv(t){return t.l+=6,[]}var pU=Fu,mU=Wv,gU=Wv,vU=Fu;function YA(t){return t.l+=2,[qt(t),t.read_shift(2)&1]}var xU=Fu,_U=YA,yU=Wv,wU=Fu,EU=Fu,TU=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function kU(t){t.l+=2;var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(4),i=t.read_shift(2),s=t.read_shift(2),a=TU[r>>2&31];return{ixti:e,coltype:r&3,rt:a,idx:n,c:i,C:s}}function SU(t){return t.l+=2,[t.read_shift(4)]}function AU(t,e,r){return t.l+=5,t.l+=2,t.l+=r.biff==2?1:4,["PTGSHEET"]}function IU(t,e,r){return t.l+=r.biff==2?4:5,["PTGENDSHEET"]}function CU(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2);return[e,r]}function RU(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2);return[e,r]}function NU(t){return t.l+=4,[0,0]}var gw={1:{n:"PtgExp",f:XV},2:{n:"PtgTbl",f:dU},3:{n:"PtgAdd",f:Wt},4:{n:"PtgSub",f:Wt},5:{n:"PtgMul",f:Wt},6:{n:"PtgDiv",f:Wt},7:{n:"PtgPower",f:Wt},8:{n:"PtgConcat",f:Wt},9:{n:"PtgLt",f:Wt},10:{n:"PtgLe",f:Wt},11:{n:"PtgEq",f:Wt},12:{n:"PtgGe",f:Wt},13:{n:"PtgGt",f:Wt},14:{n:"PtgNe",f:Wt},15:{n:"PtgIsect",f:Wt},16:{n:"PtgUnion",f:Wt},17:{n:"PtgRange",f:Wt},18:{n:"PtgUplus",f:Wt},19:{n:"PtgUminus",f:Wt},20:{n:"PtgPercent",f:Wt},21:{n:"PtgParen",f:Wt},22:{n:"PtgMissArg",f:Wt},23:{n:"PtgStr",f:eU},26:{n:"PtgSheet",f:AU},27:{n:"PtgEndSheet",f:IU},28:{n:"PtgErr",f:YV},29:{n:"PtgBool",f:JV},30:{n:"PtgInt",f:QV},31:{n:"PtgNum",f:ZV},32:{n:"PtgArray",f:bV},33:{n:"PtgFunc",f:WV},34:{n:"PtgFuncVar",f:GV},35:{n:"PtgName",f:iU},36:{n:"PtgRef",f:zV},37:{n:"PtgArea",f:RV},38:{n:"PtgMemArea",f:oU},39:{n:"PtgMemErr",f:fU},40:{n:"PtgMemNoMem",f:hU},41:{n:"PtgMemFunc",f:lU},42:{n:"PtgRefErr",f:cU},43:{n:"PtgAreaErr",f:PV},44:{n:"PtgRefN",f:$V},45:{n:"PtgAreaN",f:DV},46:{n:"PtgMemAreaN",f:CU},47:{n:"PtgMemNoMemN",f:RU},57:{n:"PtgNameX",f:sU},58:{n:"PtgRef3d",f:HV},59:{n:"PtgArea3d",f:NV},60:{n:"PtgRefErr3d",f:uU},61:{n:"PtgAreaErr3d",f:FV},255:{}},PU={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},FU={1:{n:"PtgElfLel",f:YA},2:{n:"PtgElfRw",f:wU},3:{n:"PtgElfCol",f:pU},6:{n:"PtgElfRwV",f:EU},7:{n:"PtgElfColV",f:vU},10:{n:"PtgElfRadical",f:xU},11:{n:"PtgElfRadicalS",f:yU},13:{n:"PtgElfColS",f:mU},15:{n:"PtgElfColSV",f:gU},16:{n:"PtgElfRadicalLel",f:_U},25:{n:"PtgList",f:kU},29:{n:"PtgSxName",f:SU},255:{}},DU={0:{n:"PtgAttrNoop",f:NU},1:{n:"PtgAttrSemi",f:UV},2:{n:"PtgAttrIf",f:MV},4:{n:"PtgAttrChoose",f:OV},8:{n:"PtgAttrGoto",f:LV},16:{n:"PtgAttrSum",f:qV},32:{n:"PtgAttrBaxcel",f:mw},33:{n:"PtgAttrBaxcel",f:mw},64:{n:"PtgAttrSpace",f:jV},65:{n:"PtgAttrSpaceSemi",f:BV},128:{n:"PtgAttrIfError",f:VV},255:{}};function Du(t,e,r,n){if(n.biff<8)return Br(t,e);for(var i=t.l+e,s=[],a=0;a!==r.length;++a)switch(r[a][0]){case"PtgArray":r[a][1]=nU(t,0,n),s.push(r[a][1]);break;case"PtgMemArea":r[a][2]=rU(t,r[a][1],n),s.push(r[a][2]);break;case"PtgExp":n&&n.biff==12&&(r[a][1][1]=t.read_shift(4),s.push(r[a][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[a][0]}return e=i-t.l,e!==0&&s.push(Br(t,e)),s}function bu(t,e,r){for(var n=t.l+e,i,s,a=[];n!=t.l;)e=n-t.l,s=t[t.l],i=gw[s]||gw[PU[s]],(s===24||s===25)&&(i=(s===24?FU:DU)[t[t.l+1]]),!i||!i.f?Br(t,e):a.push([i.n,i.f(t,e,r)]);return a}function bU(t){for(var e=[],r=0;r<t.length;++r){for(var n=t[r],i=[],s=0;s<n.length;++s){var a=n[s];if(a)switch(a[0]){case 2:i.push('"'+a[1].replace(/"/g,'""')+'"');break;default:i.push(a[1])}else i.push("")}e.push(i.join(","))}return e.join(";")}var OU={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function LU(t,e){if(!t&&!(e&&e.biff<=5&&e.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(t)?"'"+t+"'":t}function QA(t,e,r){if(!t)return"SH33TJSERR0";if(r.biff>8&&(!t.XTI||!t.XTI[e]))return t.SheetNames[e];if(!t.XTI)return"SH33TJSERR6";var n=t.XTI[e];if(r.biff<8)return e>1e4&&(e-=65536),e<0&&(e=-e),e==0?"":t.XTI[e-1];if(!n)return"SH33TJSERR1";var i="";if(r.biff>8)switch(t[n[0]][0]){case 357:return i=n[1]==-1?"#REF":t.SheetNames[n[1]],n[1]==n[2]?i:i+":"+t.SheetNames[n[2]];case 358:return r.SID!=null?t.SheetNames[r.SID]:"SH33TJSSAME"+t[n[0]][0];case 355:default:return"SH33TJSSRC"+t[n[0]][0]}switch(t[n[0]][0][0]){case 1025:return i=n[1]==-1?"#REF":t.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?i:i+":"+t.SheetNames[n[2]];case 14849:return t[n[0]].slice(1).map(function(s){return s.Name}).join(";;");default:return t[n[0]][0][3]?(i=n[1]==-1?"#REF":t[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?i:i+":"+t[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function vw(t,e,r){var n=QA(t,e,r);return n=="#REF"?n:LU(n,r)}function Dr(t,e,r,n,i){var s=i&&i.biff||8,a={s:{c:0,r:0}},o=[],l,c,u,h=0,d=0,p,x="";if(!t[0]||!t[0][0])return"";for(var v=-1,E="",T=0,w=t[0].length;T<w;++T){var y=t[0][T];switch(y[0]){case"PtgUminus":o.push("-"+o.pop());break;case"PtgUplus":o.push("+"+o.pop());break;case"PtgPercent":o.push(o.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(l=o.pop(),c=o.pop(),v>=0){switch(t[0][v][1][0]){case 0:E=Ut(" ",t[0][v][1][1]);break;case 1:E=Ut("\r",t[0][v][1][1]);break;default:if(E="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+t[0][v][1][0])}c=c+E,v=-1}o.push(c+OU[y[0]]+l);break;case"PtgIsect":l=o.pop(),c=o.pop(),o.push(c+" "+l);break;case"PtgUnion":l=o.pop(),c=o.pop(),o.push(c+","+l);break;case"PtgRange":l=o.pop(),c=o.pop(),o.push(c+":"+l);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":u=xc(y[1][1],a,i),o.push(_c(u,s));break;case"PtgRefN":u=r?xc(y[1][1],r,i):y[1][1],o.push(_c(u,s));break;case"PtgRef3d":h=y[1][1],u=xc(y[1][2],a,i),x=vw(n,h,i),o.push(x+"!"+_c(u,s));break;case"PtgFunc":case"PtgFuncVar":var R=y[1][0],M=y[1][1];R||(R=0),R&=127;var j=R==0?[]:o.slice(-R);o.length-=R,M==="User"&&(M=j.shift()),o.push(M+"("+j.join(",")+")");break;case"PtgBool":o.push(y[1]?"TRUE":"FALSE");break;case"PtgInt":o.push(y[1]);break;case"PtgNum":o.push(String(y[1]));break;case"PtgStr":o.push('"'+y[1].replace(/"/g,'""')+'"');break;case"PtgErr":o.push(y[1]);break;case"PtgAreaN":p=Qy(y[1][1],r?{s:r}:a,i),o.push(Bd(p,i));break;case"PtgArea":p=Qy(y[1][1],a,i),o.push(Bd(p,i));break;case"PtgArea3d":h=y[1][1],p=y[1][2],x=vw(n,h,i),o.push(x+"!"+Bd(p,i));break;case"PtgAttrSum":o.push("SUM("+o.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":d=y[1][2];var g=(n.names||[])[d-1]||(n[0]||[])[d],k=g?g.Name:"SH33TJSNAME"+String(d);k&&k.slice(0,6)=="_xlfn."&&!i.xlfn&&(k=k.slice(6)),o.push(k);break;case"PtgNameX":var S=y[1][1];d=y[1][2];var C;if(i.biff<=5)S<0&&(S=-S),n[S]&&(C=n[S][d]);else{var F="";if(((n[S]||[])[0]||[])[0]==14849||(((n[S]||[])[0]||[])[0]==1025?n[S][d]&&n[S][d].itab>0&&(F=n.SheetNames[n[S][d].itab-1]+"!"):F=n.SheetNames[d-1]+"!"),n[S]&&n[S][d])F+=n[S][d].Name;else if(n[0]&&n[0][d])F+=n[0][d].Name;else{var P=(QA(n,S,i)||"").split(";;");P[d-1]?F=P[d-1]:F+="SH33TJSERRX"}o.push(F);break}C||(C={Name:"SH33TJSERRY"}),o.push(C.Name);break;case"PtgParen":var b="(",ve=")";if(v>=0){switch(E="",t[0][v][1][0]){case 2:b=Ut(" ",t[0][v][1][1])+b;break;case 3:b=Ut("\r",t[0][v][1][1])+b;break;case 4:ve=Ut(" ",t[0][v][1][1])+ve;break;case 5:ve=Ut("\r",t[0][v][1][1])+ve;break;default:if(i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+t[0][v][1][0])}v=-1}o.push(b+o.pop()+ve);break;case"PtgRefErr":o.push("#REF!");break;case"PtgRefErr3d":o.push("#REF!");break;case"PtgExp":u={c:y[1][1],r:y[1][0]};var he={c:r.c,r:r.r};if(n.sharedf[je(u)]){var Se=n.sharedf[je(u)];o.push(Dr(Se,a,he,n,i))}else{var oe=!1;for(l=0;l!=n.arrayf.length;++l)if(c=n.arrayf[l],!(u.c<c[0].s.c||u.c>c[0].e.c)&&!(u.r<c[0].s.r||u.r>c[0].e.r)){o.push(Dr(c[1],a,he,n,i)),oe=!0;break}oe||o.push(y[1])}break;case"PtgArray":o.push("{"+bU(y[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":v=T;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":o.push("");break;case"PtgAreaErr":o.push("#REF!");break;case"PtgAreaErr3d":o.push("#REF!");break;case"PtgList":o.push("Table"+y[1].idx+"[#"+y[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(y));default:throw new Error("Unrecognized Formula Token: "+String(y))}var ie=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(i.biff!=3&&v>=0&&ie.indexOf(t[0][T][0])==-1){y=t[0][v];var G=!0;switch(y[1][0]){case 4:G=!1;case 0:E=Ut(" ",y[1][1]);break;case 5:G=!1;case 1:E=Ut("\r",y[1][1]);break;default:if(E="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+y[1][0])}o.push((G?E:"")+o.pop()+(G?"":E)),v=-1}}if(o.length>1&&i.WTF)throw new Error("bad formula stack");return o[0]}function MU(t,e,r){var n=t.l+e,i=r.biff==2?1:2,s,a=t.read_shift(i);if(a==65535)return[[],Br(t,e-2)];var o=bu(t,a,r);return e!==a+i&&(s=Du(t,e-a-i,o,r)),t.l=n,[o,s]}function VU(t,e,r){var n=t.l+e,i=r.biff==2?1:2,s,a=t.read_shift(i);if(a==65535)return[[],Br(t,e-2)];var o=bu(t,a,r);return e!==a+i&&(s=Du(t,e-a-i,o,r)),t.l=n,[o,s]}function UU(t,e,r,n){var i=t.l+e,s=bu(t,n,r),a;return i!==t.l&&(a=Du(t,i-t.l,s,r)),[s,a]}function jU(t,e,r){var n=t.l+e,i,s=t.read_shift(2),a=bu(t,s,r);return s==65535?[[],Br(t,e-2)]:(e!==s+2&&(i=Du(t,n-s-2,a,r)),[a,i])}function BU(t){var e;if(Ki(t,t.l+6)!==65535)return[Lr(t),"n"];switch(t[t.l]){case 0:return t.l+=8,["String","s"];case 1:return e=t[t.l+2]===1,t.l+=8,[e,"b"];case 2:return e=t[t.l+2],t.l+=8,[e,"e"];case 3:return t.l+=8,["","s"]}return[]}function Hd(t,e,r){var n=t.l+e,i=Ni(t);r.biff==2&&++t.l;var s=BU(t),a=t.read_shift(1);r.biff!=2&&(t.read_shift(1),r.biff>=5&&t.read_shift(4));var o=VU(t,n-t.l,r);return{cell:i,val:s[0],formula:o,shared:a>>3&1,tt:s[1]}}function W0(t,e,r){var n=t.read_shift(4),i=bu(t,n,r),s=t.read_shift(4),a=s>0?Du(t,s,i,r):null;return[i,a]}var zU=W0,G0=W0,$U=W0,HU=W0,WU={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},JA={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},GU={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function xw(t){return t.slice(0,3)=="of:"&&(t=t.slice(3)),t.charCodeAt(0)==61&&(t=t.slice(1),t.charCodeAt(0)==61&&(t=t.slice(1))),t=t.replace(/COM\.MICROSOFT\./g,""),t=t.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(e,r){return r.replace(/\./g,"")}),t=t.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),t.replace(/[;~]/g,",").replace(/\|/g,";")}function Wd(t){var e=t.split(":"),r=e[0].split(".")[0];return[r,e[0].split(".")[1]+(e.length>1?":"+(e[1].split(".")[1]||e[1].split(".")[0]):"")]}var Tc={},$o={};function kc(t,e){if(t){var r=[.7,.7,.75,.75,.3,.3];e=="xlml"&&(r=[1,1,1,1,.5,.5]),t.left==null&&(t.left=r[0]),t.right==null&&(t.right=r[1]),t.top==null&&(t.top=r[2]),t.bottom==null&&(t.bottom=r[3]),t.header==null&&(t.header=r[4]),t.footer==null&&(t.footer=r[5])}}function ZA(t,e,r,n,i,s){try{n.cellNF&&(t.z=ze[e])}catch(o){if(n.WTF)throw o}if(!(t.t==="z"&&!n.cellStyles)){if(t.t==="d"&&typeof t.v=="string"&&(t.v=hr(t.v)),(!n||n.cellText!==!1)&&t.t!=="z")try{if(ze[e]==null&&Aa(KL[e]||"General",e),t.t==="e")t.w=t.w||to[t.v];else if(e===0)if(t.t==="n")(t.v|0)===t.v?t.w=t.v.toString(10):t.w=ru(t.v);else if(t.t==="d"){var a=Yr(t.v);(a|0)===a?t.w=a.toString(10):t.w=ru(a)}else{if(t.v===void 0)return"";t.w=Ua(t.v,$o)}else t.t==="d"?t.w=Un(e,Yr(t.v),$o):t.w=Un(e,t.v,$o)}catch(o){if(n.WTF)throw o}if(n.cellStyles&&r!=null)try{t.s=s.Fills[r],t.s.fgColor&&t.s.fgColor.theme&&!t.s.fgColor.rgb&&(t.s.fgColor.rgb=Yh(i.themeElements.clrScheme[t.s.fgColor.theme].rgb,t.s.fgColor.tint||0),n.WTF&&(t.s.fgColor.raw_rgb=i.themeElements.clrScheme[t.s.fgColor.theme].rgb)),t.s.bgColor&&t.s.bgColor.theme&&(t.s.bgColor.rgb=Yh(i.themeElements.clrScheme[t.s.bgColor.theme].rgb,t.s.bgColor.tint||0),n.WTF&&(t.s.bgColor.raw_rgb=i.themeElements.clrScheme[t.s.bgColor.theme].rgb))}catch(o){if(n.WTF&&s.Fills)throw o}}}function KU(t,e){var r=jt(e);r.s.r<=r.e.r&&r.s.c<=r.e.c&&r.s.r>=0&&r.s.c>=0&&(t["!ref"]=rt(r))}var qU=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,XU=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,YU=/<(?:\w:)?hyperlink [^>]*>/mg,QU=/"(\w*:\w*)"/,JU=/<(?:\w:)?col\b[^>]*[\/]?>/g,ZU=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,ej=/<(?:\w:)?pageMargins[^>]*\/>/g,eI=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,tj=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,rj=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function nj(t,e,r,n,i,s,a){if(!t)return t;n||(n={"!id":{}});var o=e.dense?[]:{},l={s:{r:2e6,c:2e6},e:{r:0,c:0}},c="",u="",h=t.match(XU);h?(c=t.slice(0,h.index),u=t.slice(h.index+h[0].length)):c=u=t;var d=c.match(eI);d?Gv(d[0],o,i,r):(d=c.match(tj))&&ij(d[0],d[1]||"",o,i,r);var p=(c.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(p>0){var x=c.slice(p,p+50).match(QU);x&&KU(o,x[1])}var v=c.match(rj);v&&v[1]&&uj(v[1],i);var E=[];if(e.cellStyles){var T=c.match(JU);T&&oj(E,T)}h&&fj(h[1],o,e,l,s,a);var w=u.match(ZU);w&&(o["!autofilter"]=lj(w[0]));var y=[],R=u.match(qU);if(R)for(p=0;p!=R.length;++p)y[p]=jt(R[p].slice(R[p].indexOf('"')+1));var M=u.match(YU);M&&sj(o,M,n);var j=u.match(ej);if(j&&(o["!margins"]=aj(Oe(j[0]))),!o["!ref"]&&l.e.c>=l.s.c&&l.e.r>=l.s.r&&(o["!ref"]=rt(l)),e.sheetRows>0&&o["!ref"]){var g=jt(o["!ref"]);e.sheetRows<=+g.e.r&&(g.e.r=e.sheetRows-1,g.e.r>l.e.r&&(g.e.r=l.e.r),g.e.r<g.s.r&&(g.s.r=g.e.r),g.e.c>l.e.c&&(g.e.c=l.e.c),g.e.c<g.s.c&&(g.s.c=g.e.c),o["!fullref"]=o["!ref"],o["!ref"]=rt(g))}return E.length>0&&(o["!cols"]=E),y.length>0&&(o["!merges"]=y),o}function Gv(t,e,r,n){var i=Oe(t);r.Sheets[n]||(r.Sheets[n]={}),i.codeName&&(r.Sheets[n].CodeName=at(wt(i.codeName)))}function ij(t,e,r,n,i){Gv(t.slice(0,t.indexOf(">")),r,n,i)}function sj(t,e,r){for(var n=Array.isArray(t),i=0;i!=e.length;++i){var s=Oe(wt(e[i]),!0);if(!s.ref)return;var a=((r||{})["!id"]||[])[s.id];a?(s.Target=a.Target,s.location&&(s.Target+="#"+at(s.location))):(s.Target="#"+at(s.location),a={Target:s.Target,TargetMode:"Internal"}),s.Rel=a,s.tooltip&&(s.Tooltip=s.tooltip,delete s.tooltip);for(var o=jt(s.ref),l=o.s.r;l<=o.e.r;++l)for(var c=o.s.c;c<=o.e.c;++c){var u=je({c,r:l});n?(t[l]||(t[l]=[]),t[l][c]||(t[l][c]={t:"z",v:void 0}),t[l][c].l=s):(t[u]||(t[u]={t:"z",v:void 0}),t[u].l=s)}}}function aj(t){var e={};return["left","right","top","bottom","header","footer"].forEach(function(r){t[r]&&(e[r]=parseFloat(t[r]))}),e}function oj(t,e){for(var r=!1,n=0;n!=e.length;++n){var i=Oe(e[n],!0);i.hidden&&(i.hidden=Nt(i.hidden));var s=parseInt(i.min,10)-1,a=parseInt(i.max,10)-1;for(i.outlineLevel&&(i.level=+i.outlineLevel||0),delete i.min,delete i.max,i.width=+i.width,!r&&i.width&&(r=!0,Hv(i.width)),ll(i);s<=a;)t[s++]=wr(i)}}function lj(t){var e={ref:(t.match(/ref="([^"]*)"/)||[])[1]};return e}var cj=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function uj(t,e){e.Views||(e.Views=[{}]),(t.match(cj)||[]).forEach(function(r,n){var i=Oe(r);e.Views[n]||(e.Views[n]={}),+i.zoomScale&&(e.Views[n].zoom=+i.zoomScale),Nt(i.rightToLeft)&&(e.Views[n].RTL=!0)})}var fj=function(){var t=/<(?:\w+:)?c[ \/>]/,e=/<\/(?:\w+:)?row>/,r=/r=["']([^"']*)["']/,n=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,i=/ref=["']([^"']*)["']/,s=nu("v"),a=nu("f");return function(l,c,u,h,d,p){for(var x=0,v="",E=[],T=[],w=0,y=0,R=0,M="",j,g,k=0,S=0,C,F,P=0,b=0,ve=Array.isArray(p.CellXf),he,Se=[],oe=[],ie=Array.isArray(c),G=[],ue={},Ee=!1,B=!!u.sheetStubs,X=l.split(e),K=0,W=X.length;K!=W;++K){v=X[K].trim();var ae=v.length;if(ae!==0){var xe=0;e:for(x=0;x<ae;++x)switch(v[x]){case">":if(v[x-1]!="/"){++x;break e}if(u&&u.cellStyles){if(g=Oe(v.slice(xe,x),!0),k=g.r!=null?parseInt(g.r,10):k+1,S=-1,u.sheetRows&&u.sheetRows<k)continue;ue={},Ee=!1,g.ht&&(Ee=!0,ue.hpt=parseFloat(g.ht),ue.hpx=ou(ue.hpt)),g.hidden=="1"&&(Ee=!0,ue.hidden=!0),g.outlineLevel!=null&&(Ee=!0,ue.level=+g.outlineLevel),Ee&&(G[k-1]=ue)}break;case"<":xe=x;break}if(xe>=x)break;if(g=Oe(v.slice(xe,x),!0),k=g.r!=null?parseInt(g.r,10):k+1,S=-1,!(u.sheetRows&&u.sheetRows<k)){h.s.r>k-1&&(h.s.r=k-1),h.e.r<k-1&&(h.e.r=k-1),u&&u.cellStyles&&(ue={},Ee=!1,g.ht&&(Ee=!0,ue.hpt=parseFloat(g.ht),ue.hpx=ou(ue.hpt)),g.hidden=="1"&&(Ee=!0,ue.hidden=!0),g.outlineLevel!=null&&(Ee=!0,ue.level=+g.outlineLevel),Ee&&(G[k-1]=ue)),E=v.slice(x).split(t);for(var ke=0;ke!=E.length&&E[ke].trim().charAt(0)=="<";++ke);for(E=E.slice(ke),x=0;x!=E.length;++x)if(v=E[x].trim(),v.length!==0){if(T=v.match(r),w=x,y=0,R=0,v="<c "+(v.slice(0,1)=="<"?">":"")+v,T!=null&&T.length===2){for(w=0,M=T[1],y=0;y!=M.length&&!((R=M.charCodeAt(y)-64)<1||R>26);++y)w=26*w+R;--w,S=w}else++S;for(y=0;y!=v.length&&v.charCodeAt(y)!==62;++y);if(++y,g=Oe(v.slice(0,y),!0),g.r||(g.r=je({r:k-1,c:S})),M=v.slice(y),j={t:""},(T=M.match(s))!=null&&T[1]!==""&&(j.v=at(T[1])),u.cellFormula){if((T=M.match(a))!=null&&T[1]!==""){if(j.f=at(wt(T[1])).replace(/\r\n/g,`
`),u.xlfn||(j.f=pw(j.f)),T[0].indexOf('t="array"')>-1)j.F=(M.match(i)||[])[1],j.F.indexOf(":")>-1&&Se.push([jt(j.F),j.F]);else if(T[0].indexOf('t="shared"')>-1){F=Oe(T[0]);var fe=at(wt(T[1]));u.xlfn||(fe=pw(fe)),oe[parseInt(F.si,10)]=[F,fe,g.r]}}else(T=M.match(/<f[^>]*\/>/))&&(F=Oe(T[0]),oe[F.si]&&(j.f=EV(oe[F.si][1],oe[F.si][2],g.r)));var pe=Gr(g.r);for(y=0;y<Se.length;++y)pe.r>=Se[y][0].s.r&&pe.r<=Se[y][0].e.r&&pe.c>=Se[y][0].s.c&&pe.c<=Se[y][0].e.c&&(j.F=Se[y][1])}if(g.t==null&&j.v===void 0)if(j.f||j.F)j.v=0,j.t="n";else if(B)j.t="z";else continue;else j.t=g.t||"n";switch(h.s.c>S&&(h.s.c=S),h.e.c<S&&(h.e.c=S),j.t){case"n":if(j.v==""||j.v==null){if(!B)continue;j.t="z"}else j.v=parseFloat(j.v);break;case"s":if(typeof j.v>"u"){if(!B)continue;j.t="z"}else C=Tc[parseInt(j.v,10)],j.v=C.t,j.r=C.r,u.cellHTML&&(j.h=C.h);break;case"str":j.t="s",j.v=j.v!=null?wt(j.v):"",u.cellHTML&&(j.h=Dv(j.v));break;case"inlineStr":T=M.match(n),j.t="s",T!=null&&(C=$v(T[1]))?(j.v=C.t,u.cellHTML&&(j.h=C.h)):j.v="";break;case"b":j.v=Nt(j.v);break;case"d":u.cellDates?j.v=hr(j.v,1):(j.v=Yr(hr(j.v,1)),j.t="n");break;case"e":(!u||u.cellText!==!1)&&(j.w=j.v),j.v=wA[j.v];break}if(P=b=0,he=null,ve&&g.s!==void 0&&(he=p.CellXf[g.s],he!=null&&(he.numFmtId!=null&&(P=he.numFmtId),u.cellStyles&&he.fillId!=null&&(b=he.fillId))),ZA(j,P,b,u,d,p),u.cellDates&&ve&&j.t=="n"&&xl(ze[P])&&(j.t="d",j.v=$0(j.v)),g.cm&&u.xlmeta){var $e=(u.xlmeta.Cell||[])[+g.cm-1];$e&&$e.type=="XLDAPR"&&(j.D=!0)}if(ie){var z=Gr(g.r);c[z.r]||(c[z.r]=[]),c[z.r][z.c]=j}else c[g.r]=j}}}}G.length>0&&(c["!rows"]=G)}}();function hj(t,e){var r={},n=t.l+e;r.r=t.read_shift(4),t.l+=4;var i=t.read_shift(2);t.l+=1;var s=t.read_shift(1);return t.l=n,s&7&&(r.level=s&7),s&16&&(r.hidden=!0),s&32&&(r.hpt=i/20),r}var dj=eo;function pj(){}function mj(t,e){var r={},n=t[t.l];return++t.l,r.above=!(n&64),r.left=!(n&128),t.l+=18,r.name=MM(t),r}function gj(t){var e=jn(t);return[e]}function vj(t){var e=Za(t);return[e]}function xj(t){var e=jn(t),r=t.read_shift(1);return[e,r,"b"]}function _j(t){var e=Za(t),r=t.read_shift(1);return[e,r,"b"]}function yj(t){var e=jn(t),r=t.read_shift(1);return[e,r,"e"]}function wj(t){var e=Za(t),r=t.read_shift(1);return[e,r,"e"]}function Ej(t){var e=jn(t),r=t.read_shift(4);return[e,r,"s"]}function Tj(t){var e=Za(t),r=t.read_shift(4);return[e,r,"s"]}function kj(t){var e=jn(t),r=Lr(t);return[e,r,"n"]}function tI(t){var e=Za(t),r=Lr(t);return[e,r,"n"]}function Sj(t){var e=jn(t),r=jv(t);return[e,r,"n"]}function Aj(t){var e=Za(t),r=jv(t);return[e,r,"n"]}function Ij(t){var e=jn(t),r=Vv(t);return[e,r,"is"]}function Cj(t){var e=jn(t),r=Vr(t);return[e,r,"str"]}function Rj(t){var e=Za(t),r=Vr(t);return[e,r,"str"]}function Nj(t,e,r){var n=t.l+e,i=jn(t);i.r=r["!row"];var s=t.read_shift(1),a=[i,s,"b"];if(r.cellFormula){t.l+=2;var o=G0(t,n-t.l,r);a[3]=Dr(o,null,i,r.supbooks,r)}else t.l=n;return a}function Pj(t,e,r){var n=t.l+e,i=jn(t);i.r=r["!row"];var s=t.read_shift(1),a=[i,s,"e"];if(r.cellFormula){t.l+=2;var o=G0(t,n-t.l,r);a[3]=Dr(o,null,i,r.supbooks,r)}else t.l=n;return a}function Fj(t,e,r){var n=t.l+e,i=jn(t);i.r=r["!row"];var s=Lr(t),a=[i,s,"n"];if(r.cellFormula){t.l+=2;var o=G0(t,n-t.l,r);a[3]=Dr(o,null,i,r.supbooks,r)}else t.l=n;return a}function Dj(t,e,r){var n=t.l+e,i=jn(t);i.r=r["!row"];var s=Vr(t),a=[i,s,"str"];if(r.cellFormula){t.l+=2;var o=G0(t,n-t.l,r);a[3]=Dr(o,null,i,r.supbooks,r)}else t.l=n;return a}var bj=eo;function Oj(t,e){var r=t.l+e,n=eo(t),i=Uv(t),s=Vr(t),a=Vr(t),o=Vr(t);t.l=r;var l={rfx:n,relId:i,loc:s,display:o};return a&&(l.Tooltip=a),l}function Lj(){}function Mj(t,e,r){var n=t.l+e,i=xA(t),s=t.read_shift(1),a=[i];if(a[2]=s,r.cellFormula){var o=zU(t,n-t.l,r);a[1]=o}else t.l=n;return a}function Vj(t,e,r){var n=t.l+e,i=eo(t),s=[i];if(r.cellFormula){var a=HU(t,n-t.l,r);s[1]=a,t.l=n}else t.l=n;return s}var Uj=["left","right","top","bottom","header","footer"];function jj(t){var e={};return Uj.forEach(function(r){e[r]=Lr(t)}),e}function Bj(t){var e=t.read_shift(2);return t.l+=28,{RTL:e&32}}function zj(){}function $j(){}function Hj(t,e,r,n,i,s,a){if(!t)return t;var o=e||{};n||(n={"!id":{}});var l=o.dense?[]:{},c,u={s:{r:2e6,c:2e6},e:{r:0,c:0}},h=!1,d=!1,p,x,v,E,T,w,y,R,M,j=[];o.biff=12,o["!row"]=0;var g=0,k=!1,S=[],C={},F=o.supbooks||i.supbooks||[[]];if(F.sharedf=C,F.arrayf=S,F.SheetNames=i.SheetNames||i.Sheets.map(function(ie){return ie.name}),!o.supbooks&&(o.supbooks=F,i.Names))for(var P=0;P<i.Names.length;++P)F[0][P+1]=i.Names[P];var b=[],ve=[],he=!1;Zh[16]={n:"BrtShortReal",f:tI};var Se;if(ds(t,function(G,ue,Ee){if(!d)switch(Ee){case 148:c=G;break;case 0:p=G,o.sheetRows&&o.sheetRows<=p.r&&(d=!0),R=Er(E=p.r),o["!row"]=p.r,(G.hidden||G.hpt||G.level!=null)&&(G.hpt&&(G.hpx=ou(G.hpt)),ve[G.r]=G);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(x={t:G[2]},G[2]){case"n":x.v=G[1];break;case"s":y=Tc[G[1]],x.v=y.t,x.r=y.r;break;case"b":x.v=!!G[1];break;case"e":x.v=G[1],o.cellText!==!1&&(x.w=to[x.v]);break;case"str":x.t="s",x.v=G[1];break;case"is":x.t="s",x.v=G[1].t;break}if((v=a.CellXf[G[0].iStyleRef])&&ZA(x,v.numFmtId,null,o,s,a),T=G[0].c==-1?T+1:G[0].c,o.dense?(l[E]||(l[E]=[]),l[E][T]=x):l[nr(T)+R]=x,o.cellFormula){for(k=!1,g=0;g<S.length;++g){var B=S[g];p.r>=B[0].s.r&&p.r<=B[0].e.r&&T>=B[0].s.c&&T<=B[0].e.c&&(x.F=rt(B[0]),k=!0)}!k&&G.length>3&&(x.f=G[3])}if(u.s.r>p.r&&(u.s.r=p.r),u.s.c>T&&(u.s.c=T),u.e.r<p.r&&(u.e.r=p.r),u.e.c<T&&(u.e.c=T),o.cellDates&&v&&x.t=="n"&&xl(ze[v.numFmtId])){var X=wa(x.v);X&&(x.t="d",x.v=new Date(X.y,X.m-1,X.d,X.H,X.M,X.S,X.u))}Se&&(Se.type=="XLDAPR"&&(x.D=!0),Se=void 0);break;case 1:case 12:if(!o.sheetStubs||h)break;x={t:"z",v:void 0},T=G[0].c==-1?T+1:G[0].c,o.dense?(l[E]||(l[E]=[]),l[E][T]=x):l[nr(T)+R]=x,u.s.r>p.r&&(u.s.r=p.r),u.s.c>T&&(u.s.c=T),u.e.r<p.r&&(u.e.r=p.r),u.e.c<T&&(u.e.c=T),Se&&(Se.type=="XLDAPR"&&(x.D=!0),Se=void 0);break;case 176:j.push(G);break;case 49:Se=((o.xlmeta||{}).Cell||[])[G-1];break;case 494:var K=n["!id"][G.relId];for(K?(G.Target=K.Target,G.loc&&(G.Target+="#"+G.loc),G.Rel=K):G.relId==""&&(G.Target="#"+G.loc),E=G.rfx.s.r;E<=G.rfx.e.r;++E)for(T=G.rfx.s.c;T<=G.rfx.e.c;++T)o.dense?(l[E]||(l[E]=[]),l[E][T]||(l[E][T]={t:"z",v:void 0}),l[E][T].l=G):(w=je({c:T,r:E}),l[w]||(l[w]={t:"z",v:void 0}),l[w].l=G);break;case 426:if(!o.cellFormula)break;S.push(G),M=o.dense?l[E][T]:l[nr(T)+R],M.f=Dr(G[1],u,{r:p.r,c:T},F,o),M.F=rt(G[0]);break;case 427:if(!o.cellFormula)break;C[je(G[0].s)]=G[1],M=o.dense?l[E][T]:l[nr(T)+R],M.f=Dr(G[1],u,{r:p.r,c:T},F,o);break;case 60:if(!o.cellStyles)break;for(;G.e>=G.s;)b[G.e--]={width:G.w/256,hidden:!!(G.flags&1),level:G.level},he||(he=!0,Hv(G.w/256)),ll(b[G.e+1]);break;case 161:l["!autofilter"]={ref:rt(G)};break;case 476:l["!margins"]=G;break;case 147:i.Sheets[r]||(i.Sheets[r]={}),G.name&&(i.Sheets[r].CodeName=G.name),(G.above||G.left)&&(l["!outline"]={above:G.above,left:G.left});break;case 137:i.Views||(i.Views=[{}]),i.Views[0]||(i.Views[0]={}),G.RTL&&(i.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:h=!0;break;case 36:h=!1;break;case 37:h=!0;break;case 38:h=!1;break;default:if(!ue.T){if(!h||o.WTF)throw new Error("Unexpected record 0x"+Ee.toString(16))}}},o),delete o.supbooks,delete o["!row"],!l["!ref"]&&(u.s.r<2e6||c&&(c.e.r>0||c.e.c>0||c.s.r>0||c.s.c>0))&&(l["!ref"]=rt(c||u)),o.sheetRows&&l["!ref"]){var oe=jt(l["!ref"]);o.sheetRows<=+oe.e.r&&(oe.e.r=o.sheetRows-1,oe.e.r>u.e.r&&(oe.e.r=u.e.r),oe.e.r<oe.s.r&&(oe.s.r=oe.e.r),oe.e.c>u.e.c&&(oe.e.c=u.e.c),oe.e.c<oe.s.c&&(oe.s.c=oe.e.c),l["!fullref"]=l["!ref"],l["!ref"]=rt(oe))}return j.length>0&&(l["!merges"]=j),b.length>0&&(l["!cols"]=b),ve.length>0&&(l["!rows"]=ve),l}function Wj(t){var e=[],r=t.match(/^<c:numCache>/),n;(t.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(s){var a=s.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);a&&(e[+a[1]]=r?+a[2]:a[2])});var i=at((t.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(t.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(s){n=s.replace(/<.*?>/g,"")}),[e,i,n]}function Gj(t,e,r,n,i,s){var a=s||{"!type":"chart"};if(!t)return s;var o=0,l=0,c="A",u={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(t.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(h){var d=Wj(h);u.s.r=u.s.c=0,u.e.c=o,c=nr(o),d[0].forEach(function(p,x){a[c+Er(x)]={t:"n",v:p,z:d[1]},l=x}),u.e.r<l&&(u.e.r=l),++o}),o>0&&(a["!ref"]=rt(u)),a}function Kj(t,e,r,n,i){if(!t)return t;n||(n={"!id":{}});var s={"!type":"chart","!drawel":null,"!rel":""},a,o=t.match(eI);return o&&Gv(o[0],s,i,r),(a=t.match(/drawing r:id="(.*?)"/))&&(s["!rel"]=a[1]),n["!id"][s["!rel"]]&&(s["!drawel"]=n["!id"][s["!rel"]]),s}function qj(t,e){t.l+=10;var r=Vr(t);return{name:r}}function Xj(t,e,r,n,i){if(!t)return t;n||(n={"!id":{}});var s={"!type":"chart","!drawel":null,"!rel":""},a=!1;return ds(t,function(l,c,u){switch(u){case 550:s["!rel"]=l;break;case 651:i.Sheets[r]||(i.Sheets[r]={}),l.name&&(i.Sheets[r].CodeName=l.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:a=!0;break;case 36:a=!1;break;case 37:break;case 38:break;default:if(!(c.T>0)){if(!(c.T<0)){if(!a||e.WTF)throw new Error("Unexpected record 0x"+u.toString(16))}}}},e),n["!id"][s["!rel"]]&&(s["!drawel"]=n["!id"][s["!rel"]]),s}var rI=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],Yj=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],Qj=[],Jj=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function _w(t,e){for(var r=0;r!=t.length;++r)for(var n=t[r],i=0;i!=e.length;++i){var s=e[i];if(n[s[0]]==null)n[s[0]]=s[1];else switch(s[2]){case"bool":typeof n[s[0]]=="string"&&(n[s[0]]=Nt(n[s[0]]));break;case"int":typeof n[s[0]]=="string"&&(n[s[0]]=parseInt(n[s[0]],10));break}}}function yw(t,e){for(var r=0;r!=e.length;++r){var n=e[r];if(t[n[0]]==null)t[n[0]]=n[1];else switch(n[2]){case"bool":typeof t[n[0]]=="string"&&(t[n[0]]=Nt(t[n[0]]));break;case"int":typeof t[n[0]]=="string"&&(t[n[0]]=parseInt(t[n[0]],10));break}}}function nI(t){yw(t.WBProps,rI),yw(t.CalcPr,Jj),_w(t.WBView,Yj),_w(t.Sheets,Qj),$o.date1904=Nt(t.WBProps.date1904)}var Zj="][*?/\\".split("");function eB(t,e){if(t.length>31)throw new Error("Sheet names cannot exceed 31 chars");var r=!0;return Zj.forEach(function(n){if(t.indexOf(n)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),r}var tB=/<\w+:workbook/;function rB(t,e){if(!t)throw new Error("Could not find file");var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},n=!1,i="xmlns",s={},a=0;if(t.replace(zr,function(l,c){var u=Oe(l);switch(Ri(u[0])){case"<?xml":break;case"<workbook":l.match(tB)&&(i="xmlns"+l.match(/<(\w+):/)[1]),r.xmlns=u[i];break;case"</workbook>":break;case"<fileVersion":delete u[0],r.AppVersion=u;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":rI.forEach(function(h){if(u[h[0]]!=null)switch(h[2]){case"bool":r.WBProps[h[0]]=Nt(u[h[0]]);break;case"int":r.WBProps[h[0]]=parseInt(u[h[0]],10);break;default:r.WBProps[h[0]]=u[h[0]]}}),u.codeName&&(r.WBProps.CodeName=wt(u.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete u[0],r.WBView.push(u);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(u.state){case"hidden":u.Hidden=1;break;case"veryHidden":u.Hidden=2;break;default:u.Hidden=0}delete u.state,u.name=at(wt(u.name)),delete u[0],r.Sheets.push(u);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":n=!0;break;case"</definedNames>":n=!1;break;case"<definedName":s={},s.Name=wt(u.name),u.comment&&(s.Comment=u.comment),u.localSheetId&&(s.Sheet=+u.localSheetId),Nt(u.hidden||"0")&&(s.Hidden=!0),a=c+l.length;break;case"</definedName>":s.Ref=at(wt(t.slice(a,c))),r.Names.push(s);break;case"<definedName/>":break;case"<calcPr":delete u[0],r.CalcPr=u;break;case"<calcPr/>":delete u[0],r.CalcPr=u;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":n=!0;break;case"</AlternateContent>":n=!1;break;case"<revisionPtr":break;default:if(!n&&e.WTF)throw new Error("unrecognized "+u[0]+" in workbook")}return l}),yM.indexOf(r.xmlns)===-1)throw new Error("Unknown Namespace: "+r.xmlns);return nI(r),r}function nB(t,e){var r={};return r.Hidden=t.read_shift(4),r.iTabID=t.read_shift(4),r.strRelID=ym(t),r.name=Vr(t),r}function iB(t,e){var r={},n=t.read_shift(4);r.defaultThemeVersion=t.read_shift(4);var i=e>8?Vr(t):"";return i.length>0&&(r.CodeName=i),r.autoCompressPictures=!!(n&65536),r.backupFile=!!(n&64),r.checkCompatibility=!!(n&4096),r.date1904=!!(n&1),r.filterPrivacy=!!(n&8),r.hidePivotFieldList=!!(n&1024),r.promptedSolutions=!!(n&16),r.publishItems=!!(n&2048),r.refreshAllConnections=!!(n&262144),r.saveExternalLinkValues=!!(n&128),r.showBorderUnselectedTables=!!(n&4),r.showInkAnnotation=!!(n&32),r.showObjects=["all","placeholders","none"][n>>13&3],r.showPivotChartFilter=!!(n&32768),r.updateLinks=["userSet","never","always"][n>>8&3],r}function sB(t,e){var r={};return t.read_shift(4),r.ArchID=t.read_shift(4),t.l+=e-8,r}function aB(t,e,r){var n=t.l+e;t.l+=4,t.l+=1;var i=t.read_shift(4),s=VM(t),a=$U(t,0,r),o=Uv(t);t.l=n;var l={Name:s,Ptg:a};return i<268435455&&(l.Sheet=i),o&&(l.Comment=o),l}function oB(t,e){var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},n=[],i=!1;e||(e={}),e.biff=12;var s=[],a=[[]];return a.SheetNames=[],a.XTI=[],Zh[16]={n:"BrtFRTArchID$",f:sB},ds(t,function(l,c,u){switch(u){case 156:a.SheetNames.push(l.name),r.Sheets.push(l);break;case 153:r.WBProps=l;break;case 39:l.Sheet!=null&&(e.SID=l.Sheet),l.Ref=Dr(l.Ptg,null,null,a,e),delete e.SID,delete l.Ptg,s.push(l);break;case 1036:break;case 357:case 358:case 355:case 667:a[0].length?a.push([u,l]):a[0]=[u,l],a[a.length-1].XTI=[];break;case 362:a.length===0&&(a[0]=[],a[0].XTI=[]),a[a.length-1].XTI=a[a.length-1].XTI.concat(l),a.XTI=a.XTI.concat(l);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:n.push(u),i=!0;break;case 36:n.pop(),i=!1;break;case 37:n.push(u),i=!0;break;case 38:n.pop(),i=!1;break;case 16:break;default:if(!c.T){if(!i||e.WTF&&n[n.length-1]!=37&&n[n.length-1]!=35)throw new Error("Unexpected record 0x"+u.toString(16))}}},e),nI(r),r.Names=s,r.supbooks=a,r}function lB(t,e,r){return e.slice(-4)===".bin"?oB(t,r):rB(t,r)}function cB(t,e,r,n,i,s,a,o){return e.slice(-4)===".bin"?Hj(t,n,r,i,s,a,o):nj(t,n,r,i,s,a,o)}function uB(t,e,r,n,i,s,a,o){return e.slice(-4)===".bin"?Xj(t,n,r,i,s):Kj(t,n,r,i,s)}function fB(t,e,r,n,i,s,a,o){return e.slice(-4)===".bin"?_V():yV()}function hB(t,e,r,n,i,s,a,o){return e.slice(-4)===".bin"?vV():xV()}function dB(t,e,r,n){return e.slice(-4)===".bin"?b9(t,r,n):C9(t,r,n)}function pB(t,e,r){return $A(t,r)}function mB(t,e,r){return e.slice(-4)===".bin"?Y5(t,r):q5(t,r)}function gB(t,e,r){return e.slice(-4)===".bin"?pV(t,r):cV(t,r)}function vB(t,e,r){return e.slice(-4)===".bin"?aV(t):iV(t)}function xB(t,e,r,n){return r.slice(-4)===".bin"?oV(t,e,r,n):void 0}function _B(t,e,r){return e.slice(-4)===".bin"?rV(t,e,r):nV(t,e,r)}var iI=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,sI=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function Hn(t,e){var r=t.split(/\s+/),n=[];if(n[0]=r[0],r.length===1)return n;var i=t.match(iI),s,a,o,l;if(i)for(l=0;l!=i.length;++l)s=i[l].match(sI),(a=s[1].indexOf(":"))===-1?n[s[1]]=s[2].slice(1,s[2].length-1):(s[1].slice(0,6)==="xmlns:"?o="xmlns"+s[1].slice(6):o=s[1].slice(a+1),n[o]=s[2].slice(1,s[2].length-1));return n}function yB(t){var e=t.split(/\s+/),r={};if(e.length===1)return r;var n=t.match(iI),i,s,a,o;if(n)for(o=0;o!=n.length;++o)i=n[o].match(sI),(s=i[1].indexOf(":"))===-1?r[i[1]]=i[2].slice(1,i[2].length-1):(i[1].slice(0,6)==="xmlns:"?a="xmlns"+i[1].slice(6):a=i[1].slice(s+1),r[a]=i[2].slice(1,i[2].length-1));return r}var Sc;function wB(t,e){var r=Sc[t]||at(t);return r==="General"?Ua(e):Un(r,e)}function EB(t,e,r,n){var i=n;switch((r[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":i=Nt(n);break;case"i2":case"int":i=parseInt(n,10);break;case"r4":case"float":i=parseFloat(n);break;case"date":case"dateTime.tz":i=hr(n);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+r[0])}t[at(e)]=i}function TB(t,e,r){if(t.t!=="z"){if(!r||r.cellText!==!1)try{t.t==="e"?t.w=t.w||to[t.v]:e==="General"?t.t==="n"?(t.v|0)===t.v?t.w=t.v.toString(10):t.w=ru(t.v):t.w=Ua(t.v):t.w=wB(e||"General",t.v)}catch(s){if(r.WTF)throw s}try{var n=Sc[e]||e||"General";if(r.cellNF&&(t.z=n),r.cellDates&&t.t=="n"&&xl(n)){var i=wa(t.v);i&&(t.t="d",t.v=new Date(i.y,i.m-1,i.d,i.H,i.M,i.S,i.u))}}catch(s){if(r.WTF)throw s}}}function kB(t,e,r){if(r.cellStyles&&e.Interior){var n=e.Interior;n.Pattern&&(n.patternType=E9[n.Pattern]||n.Pattern)}t[e.ID]=e}function SB(t,e,r,n,i,s,a,o,l,c){var u="General",h=n.StyleID,d={};c=c||{};var p=[],x=0;for(h===void 0&&o&&(h=o.StyleID),h===void 0&&a&&(h=a.StyleID);s[h]!==void 0&&(s[h].nf&&(u=s[h].nf),s[h].Interior&&p.push(s[h].Interior),!!s[h].Parent);)h=s[h].Parent;switch(r.Type){case"Boolean":n.t="b",n.v=Nt(t);break;case"String":n.t="s",n.r=zy(at(t)),n.v=t.indexOf("<")>-1?at(e||t).replace(/<.*?>/g,""):n.r;break;case"DateTime":t.slice(-1)!="Z"&&(t+="Z"),n.v=(hr(t)-new Date(Date.UTC(1899,11,30)))/(24*60*60*1e3),n.v!==n.v?n.v=at(t):n.v<60&&(n.v=n.v-1),(!u||u=="General")&&(u="yyyy-mm-dd");case"Number":n.v===void 0&&(n.v=+t),n.t||(n.t="n");break;case"Error":n.t="e",n.v=wA[t],c.cellText!==!1&&(n.w=t);break;default:t==""&&e==""?n.t="z":(n.t="s",n.v=zy(e||t));break}if(TB(n,u,c),c.cellFormula!==!1)if(n.Formula){var v=at(n.Formula);v.charCodeAt(0)==61&&(v=v.slice(1)),n.f=zo(v,i),delete n.Formula,n.ArrayRange=="RC"?n.F=zo("RC:RC",i):n.ArrayRange&&(n.F=zo(n.ArrayRange,i),l.push([jt(n.F),n.F]))}else for(x=0;x<l.length;++x)i.r>=l[x][0].s.r&&i.r<=l[x][0].e.r&&i.c>=l[x][0].s.c&&i.c<=l[x][0].e.c&&(n.F=l[x][1]);c.cellStyles&&(p.forEach(function(E){!d.patternType&&E.patternType&&(d.patternType=E.patternType)}),n.s=d),n.StyleID!==void 0&&(n.ixfe=n.StyleID)}function AB(t){t.t=t.v||"",t.t=t.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),t.v=t.w=t.ixfe=void 0}function Gd(t,e){var r=e||{};KS();var n=Ql(bv(t));(r.type=="binary"||r.type=="array"||r.type=="base64")&&(n=wt(n));var i=n.slice(0,1024).toLowerCase(),s=!1;if(i=i.replace(/".*?"/g,""),(i.indexOf(">")&1023)>Math.min(i.indexOf(",")&1023,i.indexOf(";")&1023)){var a=wr(r);return a.type="string",su.to_workbook(n,a)}if(i.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(Et){i.indexOf("<"+Et)>=0&&(s=!0)}),s)return OB(n,r);Sc={"General Number":"General","General Date":ze[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":ze[15],"Short Date":ze[14],"Long Time":ze[19],"Medium Time":ze[18],"Short Time":ze[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:ze[2],Standard:ze[4],Percent:ze[10],Scientific:ze[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var o,l=[],c,u={},h=[],d=r.dense?[]:{},p="",x={},v={},E=Hn('<Data ss:Type="String">'),T=0,w=0,y=0,R={s:{r:2e6,c:2e6},e:{r:0,c:0}},M={},j={},g="",k=0,S=[],C={},F={},P=0,b=[],ve=[],he={},Se=[],oe,ie=!1,G=[],ue=[],Ee={},B=0,X=0,K={Sheets:[],WBProps:{date1904:!1}},W={};iu.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"");for(var ae="";o=iu.exec(n);)switch(o[3]=(ae=o[3]).toLowerCase()){case"data":if(ae=="data"){if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&l.push([o[3],!0]);break}if(l[l.length-1][1])break;o[1]==="/"?SB(n.slice(T,o.index),g,E,l[l.length-1][0]=="comment"?he:x,{c:w,r:y},M,Se[w],v,G,r):(g="",E=Hn(o[0]),T=o.index+o[0].length);break;case"cell":if(o[1]==="/")if(ve.length>0&&(x.c=ve),(!r.sheetRows||r.sheetRows>y)&&x.v!==void 0&&(r.dense?(d[y]||(d[y]=[]),d[y][w]=x):d[nr(w)+Er(y)]=x),x.HRef&&(x.l={Target:at(x.HRef)},x.HRefScreenTip&&(x.l.Tooltip=x.HRefScreenTip),delete x.HRef,delete x.HRefScreenTip),(x.MergeAcross||x.MergeDown)&&(B=w+(parseInt(x.MergeAcross,10)|0),X=y+(parseInt(x.MergeDown,10)|0),S.push({s:{c:w,r:y},e:{c:B,r:X}})),!r.sheetStubs)x.MergeAcross?w=B+1:++w;else if(x.MergeAcross||x.MergeDown){for(var xe=w;xe<=B;++xe)for(var ke=y;ke<=X;++ke)(xe>w||ke>y)&&(r.dense?(d[ke]||(d[ke]=[]),d[ke][xe]={t:"z"}):d[nr(xe)+Er(ke)]={t:"z"});w=B+1}else++w;else x=yB(o[0]),x.Index&&(w=+x.Index-1),w<R.s.c&&(R.s.c=w),w>R.e.c&&(R.e.c=w),o[0].slice(-2)==="/>"&&++w,ve=[];break;case"row":o[1]==="/"||o[0].slice(-2)==="/>"?(y<R.s.r&&(R.s.r=y),y>R.e.r&&(R.e.r=y),o[0].slice(-2)==="/>"&&(v=Hn(o[0]),v.Index&&(y=+v.Index-1)),w=0,++y):(v=Hn(o[0]),v.Index&&(y=+v.Index-1),Ee={},(v.AutoFitHeight=="0"||v.Height)&&(Ee.hpx=parseInt(v.Height,10),Ee.hpt=zA(Ee.hpx),ue[y]=Ee),v.Hidden=="1"&&(Ee.hidden=!0,ue[y]=Ee));break;case"worksheet":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"));h.push(p),R.s.r<=R.e.r&&R.s.c<=R.e.c&&(d["!ref"]=rt(R),r.sheetRows&&r.sheetRows<=R.e.r&&(d["!fullref"]=d["!ref"],R.e.r=r.sheetRows-1,d["!ref"]=rt(R))),S.length&&(d["!merges"]=S),Se.length>0&&(d["!cols"]=Se),ue.length>0&&(d["!rows"]=ue),u[p]=d}else R={s:{r:2e6,c:2e6},e:{r:0,c:0}},y=w=0,l.push([o[3],!1]),c=Hn(o[0]),p=at(c.Name),d=r.dense?[]:{},S=[],G=[],ue=[],W={name:p,Hidden:0},K.Sheets.push(W);break;case"table":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else{if(o[0].slice(-2)=="/>")break;l.push([o[3],!1]),Se=[],ie=!1}break;case"style":o[1]==="/"?kB(M,j,r):j=Hn(o[0]);break;case"numberformat":j.nf=at(Hn(o[0]).Format||"General"),Sc[j.nf]&&(j.nf=Sc[j.nf]);for(var fe=0;fe!=392&&ze[fe]!=j.nf;++fe);if(fe==392){for(fe=57;fe!=392;++fe)if(ze[fe]==null){Aa(j.nf,fe);break}}break;case"column":if(l[l.length-1][0]!=="table")break;if(oe=Hn(o[0]),oe.Hidden&&(oe.hidden=!0,delete oe.Hidden),oe.Width&&(oe.wpx=parseInt(oe.Width,10)),!ie&&oe.wpx>10){ie=!0,Wr=jA;for(var pe=0;pe<Se.length;++pe)Se[pe]&&ll(Se[pe])}ie&&ll(oe),Se[oe.Index-1||Se.length]=oe;for(var $e=0;$e<+oe.Span;++$e)Se[Se.length]=wr(oe);break;case"namedrange":if(o[1]==="/")break;K.Names||(K.Names=[]);var z=Oe(o[0]),ot={Name:z.Name,Ref:zo(z.RefersTo.slice(1),{r:0,c:0})};K.Sheets.length>0&&(ot.Sheet=K.Sheets.length-1),K.Names.push(ot);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(o[0].slice(-2)==="/>")break;o[1]==="/"?g+=n.slice(k,o.index):k=o.index+o[0].length;break;case"interior":if(!r.cellStyles)break;j.Interior=Hn(o[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(o[0].slice(-2)==="/>")break;o[1]==="/"?c8(C,ae,n.slice(P,o.index)):P=o.index+o[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else l.push([o[3],!1]);break;case"comment":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"));AB(he),ve.push(he)}else l.push([o[3],!1]),c=Hn(o[0]),he={a:c.Author};break;case"autofilter":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else if(o[0].charAt(o[0].length-2)!=="/"){var We=Hn(o[0]);d["!autofilter"]={ref:zo(We.Range).replace(/\$/g,"")},l.push([o[3],!0])}break;case"name":break;case"datavalidation":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&l.push([o[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&l.push([o[3],!0]);break;case"null":break;default:if(l.length==0&&o[3]=="document"||l.length==0&&o[3]=="uof")return Aw(n,r);var nt=!0;switch(l[l.length-1][0]){case"officedocumentsettings":switch(o[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:nt=!1}break;case"componentoptions":switch(o[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:nt=!1}break;case"excelworkbook":switch(o[3]){case"date1904":K.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:nt=!1}break;case"workbookoptions":switch(o[3]){case"owcversion":break;case"height":break;case"width":break;default:nt=!1}break;case"worksheetoptions":switch(o[3]){case"visible":if(o[0].slice(-2)!=="/>")if(o[1]==="/")switch(n.slice(P,o.index)){case"SheetHidden":W.Hidden=1;break;case"SheetVeryHidden":W.Hidden=2;break}else P=o.index+o[0].length;break;case"header":d["!margins"]||kc(d["!margins"]={},"xlml"),isNaN(+Oe(o[0]).Margin)||(d["!margins"].header=+Oe(o[0]).Margin);break;case"footer":d["!margins"]||kc(d["!margins"]={},"xlml"),isNaN(+Oe(o[0]).Margin)||(d["!margins"].footer=+Oe(o[0]).Margin);break;case"pagemargins":var be=Oe(o[0]);d["!margins"]||kc(d["!margins"]={},"xlml"),isNaN(+be.Top)||(d["!margins"].top=+be.Top),isNaN(+be.Left)||(d["!margins"].left=+be.Left),isNaN(+be.Right)||(d["!margins"].right=+be.Right),isNaN(+be.Bottom)||(d["!margins"].bottom=+be.Bottom);break;case"displayrighttoleft":K.Views||(K.Views=[]),K.Views[0]||(K.Views[0]={}),K.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":d["!outline"]||(d["!outline"]={}),d["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":d["!outline"]||(d["!outline"]={}),d["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:nt=!1}break;case"pivottable":case"pivotcache":switch(o[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:nt=!1}break;case"pagebreaks":switch(o[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:nt=!1}break;case"autofilter":switch(o[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:nt=!1}break;case"querytable":switch(o[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:nt=!1}break;case"datavalidation":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:nt=!1}break;case"sorting":case"conditionalformatting":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:nt=!1}break;case"mapinfo":case"schema":case"data":switch(o[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:nt=!1}break;case"smarttags":break;default:nt=!1;break}if(nt||o[3].match(/!\[CDATA/))break;if(!l[l.length-1][1])throw"Unrecognized tag: "+o[3]+"|"+l.join("|");if(l[l.length-1][0]==="customdocumentproperties"){if(o[0].slice(-2)==="/>")break;o[1]==="/"?EB(F,ae,b,n.slice(P,o.index)):(b=o,P=o.index+o[0].length);break}if(r.WTF)throw"Unrecognized tag: "+o[3]+"|"+l.join("|")}var Ie={};return!r.bookSheets&&!r.bookProps&&(Ie.Sheets=u),Ie.SheetNames=h,Ie.Workbook=K,Ie.SSF=wr(ze),Ie.Props=C,Ie.Custprops=F,Ie}function km(t,e){switch(Xv(e=e||{}),e.type||"base64"){case"base64":return Gd(En(t),e);case"binary":case"buffer":case"file":return Gd(t,e);case"array":return Gd(Ja(t),e)}}function IB(t){var e={},r=t.content;if(r.l=28,e.AnsiUserType=r.read_shift(0,"lpstr-ansi"),e.AnsiClipboardFormat=BM(r),r.length-r.l<=4)return e;var n=r.read_shift(4);if(n==0||n>40||(r.l-=4,e.Reserved1=r.read_shift(0,"lpstr-ansi"),r.length-r.l<=4)||(n=r.read_shift(4),n!==1907505652)||(e.UnicodeClipboardFormat=zM(r),n=r.read_shift(4),n==0||n>40))return e;r.l-=4,e.Reserved2=r.read_shift(0,"lpwstr")}var CB=[60,1084,2066,2165,2175];function RB(t,e,r,n,i){var s=n,a=[],o=r.slice(r.l,r.l+s);if(i&&i.enc&&i.enc.insitu&&o.length>0)switch(t){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:i.enc.insitu(o)}a.push(o),r.l+=s;for(var l=Ki(r,r.l),c=Sm[l],u=0;c!=null&&CB.indexOf(l)>-1;)s=Ki(r,r.l+2),u=r.l+4,l==2066?u+=4:(l==2165||l==2175)&&(u+=12),o=r.slice(u,r.l+4+s),a.push(o),r.l+=4+s,c=Sm[l=Ki(r,r.l)];var h=Cs(a);vr(h,0);var d=0;h.lens=[];for(var p=0;p<a.length;++p)h.lens.push(d),d+=a[p].length;if(h.length<n)throw"XLS Record 0x"+t.toString(16)+" Truncated: "+h.length+" < "+n;return e.f(h,h.length,i)}function fi(t,e,r){if(t.t!=="z"&&t.XF){var n=0;try{n=t.z||t.XF.numFmtId||0,e.cellNF&&(t.z=ze[n])}catch(s){if(e.WTF)throw s}if(!e||e.cellText!==!1)try{t.t==="e"?t.w=t.w||to[t.v]:n===0||n=="General"?t.t==="n"?(t.v|0)===t.v?t.w=t.v.toString(10):t.w=ru(t.v):t.w=Ua(t.v):t.w=Un(n,t.v,{date1904:!!r,dateNF:e&&e.dateNF})}catch(s){if(e.WTF)throw s}if(e.cellDates&&n&&t.t=="n"&&xl(ze[n]||String(n))){var i=wa(t.v);i&&(t.t="d",t.v=new Date(i.y,i.m-1,i.d,i.H,i.M,i.S,i.u))}}}function Af(t,e,r){return{v:t,ixfe:e,t:r}}function NB(t,e){var r={opts:{}},n={},i=e.dense?[]:{},s={},a={},o=null,l=[],c="",u={},h,d="",p,x,v,E,T={},w=[],y,R,M=[],j=[],g={Sheets:[],WBProps:{date1904:!1},Views:[{}]},k={},S=function(Ve){return Ve<8?Ia[Ve]:Ve<64&&j[Ve-8]||Ia[Ve]},C=function(Ve,xt,Ht){var ut=xt.XF.data;if(!(!ut||!ut.patternType||!Ht||!Ht.cellStyles)){xt.s={},xt.s.patternType=ut.patternType;var fn;(fn=au(S(ut.icvFore)))&&(xt.s.fgColor={rgb:fn}),(fn=au(S(ut.icvBack)))&&(xt.s.bgColor={rgb:fn})}},F=function(Ve,xt,Ht){if(!(Ee>1)&&!(Ht.sheetRows&&Ve.r>=Ht.sheetRows)){if(Ht.cellStyles&&xt.XF&&xt.XF.data&&C(Ve,xt,Ht),delete xt.ixfe,delete xt.XF,h=Ve,d=je(Ve),(!a||!a.s||!a.e)&&(a={s:{r:0,c:0},e:{r:0,c:0}}),Ve.r<a.s.r&&(a.s.r=Ve.r),Ve.c<a.s.c&&(a.s.c=Ve.c),Ve.r+1>a.e.r&&(a.e.r=Ve.r+1),Ve.c+1>a.e.c&&(a.e.c=Ve.c+1),Ht.cellFormula&&xt.f){for(var ut=0;ut<w.length;++ut)if(!(w[ut][0].s.c>Ve.c||w[ut][0].s.r>Ve.r)&&!(w[ut][0].e.c<Ve.c||w[ut][0].e.r<Ve.r)){xt.F=rt(w[ut][0]),(w[ut][0].s.c!=Ve.c||w[ut][0].s.r!=Ve.r)&&delete xt.f,xt.f&&(xt.f=""+Dr(w[ut][1],a,Ve,G,P));break}}Ht.dense?(i[Ve.r]||(i[Ve.r]=[]),i[Ve.r][Ve.c]=xt):i[d]=xt}},P={enc:!1,sbcch:0,snames:[],sharedf:T,arrayf:w,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!e&&!!e.cellStyles,WTF:!!e&&!!e.wtf};e.password&&(P.password=e.password);var b,ve=[],he=[],Se=[],oe=[],ie=!1,G=[];G.SheetNames=P.snames,G.sharedf=P.sharedf,G.arrayf=P.arrayf,G.names=[],G.XTI=[];var ue=0,Ee=0,B=0,X=[],K=[],W;P.codepage=1200,Jn(1200);for(var ae=!1;t.l<t.length-1;){var xe=t.l,ke=t.read_shift(2);if(ke===0&&ue===10)break;var fe=t.l===t.length?0:t.read_shift(2),pe=Sm[ke];if(pe&&pe.f){if(e.bookSheets&&ue===133&&ke!==133)break;if(ue=ke,pe.r===2||pe.r==12){var $e=t.read_shift(2);if(fe-=2,!P.enc&&$e!==ke&&(($e&255)<<8|$e>>8)!==ke)throw new Error("rt mismatch: "+$e+"!="+ke);pe.r==12&&(t.l+=10,fe-=10)}var z={};if(ke===10?z=pe.f(t,fe,P):z=RB(ke,pe,t,fe,P),Ee==0&&[9,521,1033,2057].indexOf(ue)===-1)continue;switch(ke){case 34:r.opts.Date1904=g.WBProps.date1904=z;break;case 134:r.opts.WriteProtect=!0;break;case 47:if(P.enc||(t.l=0),P.enc=z,!e.password)throw new Error("File is password-protected");if(z.valid==null)throw new Error("Encryption scheme unsupported");if(!z.valid)throw new Error("Password is incorrect");break;case 92:P.lastuser=z;break;case 66:var ot=Number(z);switch(ot){case 21010:ot=1200;break;case 32768:ot=1e4;break;case 32769:ot=1252;break}Jn(P.codepage=ot),ae=!0;break;case 317:P.rrtabid=z;break;case 25:P.winlocked=z;break;case 439:r.opts.RefreshAll=z;break;case 12:r.opts.CalcCount=z;break;case 16:r.opts.CalcDelta=z;break;case 17:r.opts.CalcIter=z;break;case 13:r.opts.CalcMode=z;break;case 14:r.opts.CalcPrecision=z;break;case 95:r.opts.CalcSaveRecalc=z;break;case 15:P.CalcRefMode=z;break;case 2211:r.opts.FullCalc=z;break;case 129:z.fDialog&&(i["!type"]="dialog"),z.fBelow||((i["!outline"]||(i["!outline"]={})).above=!0),z.fRight||((i["!outline"]||(i["!outline"]={})).left=!0);break;case 224:M.push(z);break;case 430:G.push([z]),G[G.length-1].XTI=[];break;case 35:case 547:G[G.length-1].push(z);break;case 24:case 536:W={Name:z.Name,Ref:Dr(z.rgce,a,null,G,P)},z.itab>0&&(W.Sheet=z.itab-1),G.names.push(W),G[0]||(G[0]=[],G[0].XTI=[]),G[G.length-1].push(z),z.Name=="_xlnm._FilterDatabase"&&z.itab>0&&z.rgce&&z.rgce[0]&&z.rgce[0][0]&&z.rgce[0][0][0]=="PtgArea3d"&&(K[z.itab-1]={ref:rt(z.rgce[0][0][1][2])});break;case 22:P.ExternCount=z;break;case 23:G.length==0&&(G[0]=[],G[0].XTI=[]),G[G.length-1].XTI=G[G.length-1].XTI.concat(z),G.XTI=G.XTI.concat(z);break;case 2196:if(P.biff<8)break;W!=null&&(W.Comment=z[1]);break;case 18:i["!protect"]=z;break;case 19:z!==0&&P.WTF&&console.error("Password verifier: "+z);break;case 133:s[z.pos]=z,P.snames.push(z.name);break;case 10:{if(--Ee)break;if(a.e){if(a.e.r>0&&a.e.c>0){if(a.e.r--,a.e.c--,i["!ref"]=rt(a),e.sheetRows&&e.sheetRows<=a.e.r){var We=a.e.r;a.e.r=e.sheetRows-1,i["!fullref"]=i["!ref"],i["!ref"]=rt(a),a.e.r=We}a.e.r++,a.e.c++}ve.length>0&&(i["!merges"]=ve),he.length>0&&(i["!objects"]=he),Se.length>0&&(i["!cols"]=Se),oe.length>0&&(i["!rows"]=oe),g.Sheets.push(k)}c===""?u=i:n[c]=i,i=e.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(P.biff===8&&(P.biff={9:2,521:3,1033:4}[ke]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[z.BIFFVer]||8),P.biffguess=z.BIFFVer==0,z.BIFFVer==0&&z.dt==4096&&(P.biff=5,ae=!0,Jn(P.codepage=28591)),P.biff==8&&z.BIFFVer==0&&z.dt==16&&(P.biff=2),Ee++)break;if(i=e.dense?[]:{},P.biff<8&&!ae&&(ae=!0,Jn(P.codepage=e.codepage||1252)),P.biff<5||z.BIFFVer==0&&z.dt==4096){c===""&&(c="Sheet1"),a={s:{r:0,c:0},e:{r:0,c:0}};var nt={pos:t.l-fe,name:c};s[nt.pos]=nt,P.snames.push(c)}else c=(s[xe]||{name:""}).name;z.dt==32&&(i["!type"]="chart"),z.dt==64&&(i["!type"]="macro"),ve=[],he=[],P.arrayf=w=[],Se=[],oe=[],ie=!1,k={Hidden:(s[xe]||{hs:0}).hs,name:c}}break;case 515:case 3:case 2:i["!type"]=="chart"&&(e.dense?(i[z.r]||[])[z.c]:i[je({c:z.c,r:z.r})])&&++z.c,y={ixfe:z.ixfe,XF:M[z.ixfe]||{},v:z.val,t:"n"},B>0&&(y.z=X[y.ixfe>>8&63]),fi(y,e,r.opts.Date1904),F({c:z.c,r:z.r},y,e);break;case 5:case 517:y={ixfe:z.ixfe,XF:M[z.ixfe],v:z.val,t:z.t},B>0&&(y.z=X[y.ixfe>>8&63]),fi(y,e,r.opts.Date1904),F({c:z.c,r:z.r},y,e);break;case 638:y={ixfe:z.ixfe,XF:M[z.ixfe],v:z.rknum,t:"n"},B>0&&(y.z=X[y.ixfe>>8&63]),fi(y,e,r.opts.Date1904),F({c:z.c,r:z.r},y,e);break;case 189:for(var be=z.c;be<=z.C;++be){var Ie=z.rkrec[be-z.c][0];y={ixfe:Ie,XF:M[Ie],v:z.rkrec[be-z.c][1],t:"n"},B>0&&(y.z=X[y.ixfe>>8&63]),fi(y,e,r.opts.Date1904),F({c:be,r:z.r},y,e)}break;case 6:case 518:case 1030:{if(z.val=="String"){o=z;break}if(y=Af(z.val,z.cell.ixfe,z.tt),y.XF=M[y.ixfe],e.cellFormula){var Et=z.formula;if(Et&&Et[0]&&Et[0][0]&&Et[0][0][0]=="PtgExp"){var ar=Et[0][0][1][0],Sr=Et[0][0][1][1],Zr=je({r:ar,c:Sr});T[Zr]?y.f=""+Dr(z.formula,a,z.cell,G,P):y.F=((e.dense?(i[ar]||[])[Sr]:i[Zr])||{}).F}else y.f=""+Dr(z.formula,a,z.cell,G,P)}B>0&&(y.z=X[y.ixfe>>8&63]),fi(y,e,r.opts.Date1904),F(z.cell,y,e),o=z}break;case 7:case 519:if(o)o.val=z,y=Af(z,o.cell.ixfe,"s"),y.XF=M[y.ixfe],e.cellFormula&&(y.f=""+Dr(o.formula,a,o.cell,G,P)),B>0&&(y.z=X[y.ixfe>>8&63]),fi(y,e,r.opts.Date1904),F(o.cell,y,e),o=null;else throw new Error("String record expects Formula");break;case 33:case 545:{w.push(z);var Pi=je(z[0].s);if(p=e.dense?(i[z[0].s.r]||[])[z[0].s.c]:i[Pi],e.cellFormula&&p){if(!o||!Pi||!p)break;p.f=""+Dr(z[1],a,z[0],G,P),p.F=rt(z[0])}}break;case 1212:{if(!e.cellFormula)break;if(d){if(!o)break;T[je(o.cell)]=z[0],p=e.dense?(i[o.cell.r]||[])[o.cell.c]:i[je(o.cell)],(p||{}).f=""+Dr(z[0],a,h,G,P)}}break;case 253:y=Af(l[z.isst].t,z.ixfe,"s"),l[z.isst].h&&(y.h=l[z.isst].h),y.XF=M[y.ixfe],B>0&&(y.z=X[y.ixfe>>8&63]),fi(y,e,r.opts.Date1904),F({c:z.c,r:z.r},y,e);break;case 513:e.sheetStubs&&(y={ixfe:z.ixfe,XF:M[z.ixfe],t:"z"},B>0&&(y.z=X[y.ixfe>>8&63]),fi(y,e,r.opts.Date1904),F({c:z.c,r:z.r},y,e));break;case 190:if(e.sheetStubs)for(var en=z.c;en<=z.C;++en){var Tt=z.ixfe[en-z.c];y={ixfe:Tt,XF:M[Tt],t:"z"},B>0&&(y.z=X[y.ixfe>>8&63]),fi(y,e,r.opts.Date1904),F({c:en,r:z.r},y,e)}break;case 214:case 516:case 4:y=Af(z.val,z.ixfe,"s"),y.XF=M[y.ixfe],B>0&&(y.z=X[y.ixfe>>8&63]),fi(y,e,r.opts.Date1904),F({c:z.c,r:z.r},y,e);break;case 0:case 512:Ee===1&&(a=z);break;case 252:l=z;break;case 1054:if(P.biff==4){X[B++]=z[1];for(var or=0;or<B+163&&ze[or]!=z[1];++or);or>=163&&Aa(z[1],B+163)}else Aa(z[1],z[0]);break;case 30:{X[B++]=z;for(var vt=0;vt<B+163&&ze[vt]!=z;++vt);vt>=163&&Aa(z,B+163)}break;case 229:ve=ve.concat(z);break;case 93:he[z.cmo[0]]=P.lastobj=z;break;case 438:P.lastobj.TxO=z;break;case 127:P.lastobj.ImData=z;break;case 440:for(E=z[0].s.r;E<=z[0].e.r;++E)for(v=z[0].s.c;v<=z[0].e.c;++v)p=e.dense?(i[E]||[])[v]:i[je({c:v,r:E})],p&&(p.l=z[1]);break;case 2048:for(E=z[0].s.r;E<=z[0].e.r;++E)for(v=z[0].s.c;v<=z[0].e.c;++v)p=e.dense?(i[E]||[])[v]:i[je({c:v,r:E})],p&&p.l&&(p.l.Tooltip=z[1]);break;case 28:{if(P.biff<=5&&P.biff>=2)break;p=e.dense?(i[z[0].r]||[])[z[0].c]:i[je(z[0])];var kt=he[z[2]];p||(e.dense?(i[z[0].r]||(i[z[0].r]=[]),p=i[z[0].r][z[0].c]={t:"z"}):p=i[je(z[0])]={t:"z"},a.e.r=Math.max(a.e.r,z[0].r),a.s.r=Math.min(a.s.r,z[0].r),a.e.c=Math.max(a.e.c,z[0].c),a.s.c=Math.min(a.s.c,z[0].c)),p.c||(p.c=[]),x={a:z[1],t:kt.TxO.t},p.c.push(x)}break;case 2173:J9(M[z.ixfe],z.ext);break;case 125:{if(!P.cellStyles)break;for(;z.e>=z.s;)Se[z.e--]={width:z.w/256,level:z.level||0,hidden:!!(z.flags&1)},ie||(ie=!0,Hv(z.w/256)),ll(Se[z.e+1])}break;case 520:{var ht={};z.level!=null&&(oe[z.r]=ht,ht.level=z.level),z.hidden&&(oe[z.r]=ht,ht.hidden=!0),z.hpt&&(oe[z.r]=ht,ht.hpt=z.hpt,ht.hpx=ou(z.hpt))}break;case 38:case 39:case 40:case 41:i["!margins"]||kc(i["!margins"]={}),i["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[ke]]=z;break;case 161:i["!margins"]||kc(i["!margins"]={}),i["!margins"].header=z.header,i["!margins"].footer=z.footer;break;case 574:z.RTL&&(g.Views[0].RTL=!0);break;case 146:j=z;break;case 2198:b=z;break;case 140:R=z;break;case 442:c?k.CodeName=z||k.name:g.WBProps.CodeName=z||"ThisWorkbook";break}}else pe||console.error("Missing Info for XLS Record 0x"+ke.toString(16)),t.l+=fe}return r.SheetNames=ki(s).sort(function(Ft,Ve){return Number(Ft)-Number(Ve)}).map(function(Ft){return s[Ft].name}),e.bookSheets||(r.Sheets=n),!r.SheetNames.length&&u["!ref"]?(r.SheetNames.push("Sheet1"),r.Sheets&&(r.Sheets.Sheet1=u)):r.Preamble=u,r.Sheets&&K.forEach(function(Ft,Ve){r.Sheets[r.SheetNames[Ve]]["!autofilter"]=Ft}),r.Strings=l,r.SSF=wr(ze),P.enc&&(r.Encryption=P.enc),b&&(r.Themes=b),r.Metadata={},R!==void 0&&(r.Metadata.Country=R),G.names.length>0&&(g.Names=G.names),r.Workbook=g,r}var ww={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function PB(t,e,r){var n=tt.find(t,"/!DocumentSummaryInformation");if(n&&n.size>0)try{var i=iw(n,qM,ww.DSI);for(var s in i)e[s]=i[s]}catch(c){if(r.WTF)throw c}var a=tt.find(t,"/!SummaryInformation");if(a&&a.size>0)try{var o=iw(a,XM,ww.SI);for(var l in o)e[l]==null&&(e[l]=o[l])}catch(c){if(r.WTF)throw c}e.HeadingPairs&&e.TitlesOfParts&&(TA(e.HeadingPairs,e.TitlesOfParts,e,r),delete e.HeadingPairs,delete e.TitlesOfParts)}function aI(t,e){e||(e={}),Xv(e),OS(),e.codepage&&Iv(e.codepage);var r,n;if(t.FullPaths){if(tt.find(t,"/encryption"))throw new Error("File is password-protected");r=tt.find(t,"!CompObj"),n=tt.find(t,"/Workbook")||tt.find(t,"/Book")}else{switch(e.type){case"base64":t=Yn(En(t));break;case"binary":t=Yn(t);break;case"buffer":break;case"array":Array.isArray(t)||(t=Array.prototype.slice.call(t));break}vr(t,0),n={content:t}}var i,s;if(r&&IB(r),e.bookProps&&!e.bookSheets)i={};else{var a=Je?"buffer":"array";if(n&&n.content)i=NB(n.content,e);else if((s=tt.find(t,"PerfectOffice_MAIN"))&&s.content)i=Ec.to_workbook(s.content,(e.type=a,e));else if((s=tt.find(t,"NativeContent_MAIN"))&&s.content)i=Ec.to_workbook(s.content,(e.type=a,e));else throw(s=tt.find(t,"MN0"))&&s.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");e.bookVBA&&t.FullPaths&&tt.find(t,"/_VBA_PROJECT_CUR/VBA/dir")&&(i.vbaraw=gV(t))}var o={};return t.FullPaths&&PB(t,o,e),i.Props=i.Custprops=o,e.bookFiles&&(i.cfb=t),i}var Zh={0:{f:hj},1:{f:gj},2:{f:Sj},3:{f:yj},4:{f:xj},5:{f:kj},6:{f:Cj},7:{f:Ej},8:{f:Dj},9:{f:Fj},10:{f:Nj},11:{f:Pj},12:{f:vj},13:{f:Aj},14:{f:wj},15:{f:_j},16:{f:tI},17:{f:Rj},18:{f:Tj},19:{f:Vv},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:aB},40:{},42:{},43:{f:N9},44:{f:R9},45:{f:P9},46:{f:D9},47:{f:F9},48:{},49:{f:bM},50:{},51:{f:eV},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:OA},62:{f:Ij},63:{f:sV},64:{f:zj},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:Br,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:Bj},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:mj},148:{f:dj,p:16},151:{f:Lj},152:{},153:{f:iB},154:{},155:{},156:{f:nB},157:{},158:{},159:{T:1,f:X5},160:{T:-1},161:{T:1,f:eo},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:bj},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:Z9},336:{T:-1},337:{f:tV,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:ym},357:{},358:{},359:{},360:{T:1},361:{},362:{f:bA},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:Mj},427:{f:Vj},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:jj},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:pj},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:Oj},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:ym},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:dV},633:{T:1},634:{T:-1},635:{T:1,f:hV},636:{T:-1},637:{f:LM},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:qj},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:$j},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},Sm={6:{f:Hd},10:{f:_s},12:{f:qt},13:{f:qt},14:{f:Bt},15:{f:Bt},16:{f:Lr},17:{f:Bt},18:{f:Bt},19:{f:qt},20:{f:lw},21:{f:lw},23:{f:bA},24:{f:uw},25:{f:Bt},26:{},27:{},28:{f:u5},29:{},34:{f:Bt},35:{f:cw},38:{f:Lr},39:{f:Lr},40:{f:Lr},41:{f:Lr},42:{f:Bt},43:{f:Bt},47:{f:p9},49:{f:W8},51:{f:qt},60:{},61:{f:z8},64:{f:Bt},65:{f:H8},66:{f:qt},77:{},80:{},81:{},82:{},85:{f:qt},89:{},90:{},91:{},92:{f:b8},93:{f:h5},94:{},95:{f:Bt},96:{},97:{},99:{f:Bt},125:{f:OA},128:{f:t5},129:{f:O8},130:{f:qt},131:{f:Bt},132:{f:Bt},133:{f:L8},134:{},140:{f:x5},141:{f:qt},144:{},146:{f:y5},151:{},152:{},153:{},154:{},155:{},156:{f:qt},157:{},158:{},160:{f:S5},161:{f:E5},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:Q8},190:{f:J8},193:{f:_s},197:{},198:{},199:{},200:{},201:{},202:{f:Bt},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:qt},220:{},221:{f:Bt},222:{},224:{f:e5},225:{f:D8},226:{f:_s},227:{},229:{f:f5},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:M8},253:{f:G8},255:{f:V8},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:CA},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:Bt},353:{f:_s},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:n5},431:{f:Bt},432:{},433:{},434:{},437:{},438:{f:m5},439:{f:Bt},440:{f:g5},441:{},442:{f:Pu},443:{},444:{f:qt},445:{},446:{},448:{f:_s},449:{f:B8,r:2},450:{f:_s},512:{f:aw},513:{f:k5},515:{f:r5},516:{f:K8},517:{f:ow},519:{f:A5},520:{f:U8},523:{},545:{f:fw},549:{f:sw},566:{},574:{f:$8},638:{f:Y8},659:{},1048:{},1054:{f:q8},1084:{},1212:{f:o5},2048:{f:v5},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:Tf},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:_s},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:w5,r:12},2173:{f:Q9,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:Bt,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:a5,r:12},2197:{},2198:{f:W9,r:12},2199:{},2200:{},2201:{},2202:{f:l5,r:12},2203:{f:_s},2204:{},2205:{},2206:{},2207:{},2211:{f:j8},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:qt},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:T5},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:_5},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:aw},1:{},2:{f:N5},3:{f:R5},4:{f:C5},5:{f:ow},7:{f:P5},8:{},9:{f:Tf},11:{},22:{f:qt},30:{f:X8},31:{},32:{},33:{f:fw},36:{},37:{f:sw},50:{f:F5},62:{},52:{},67:{},68:{f:qt},69:{},86:{},126:{},127:{f:I5},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:D5},223:{},234:{},354:{},421:{},518:{f:Hd},521:{f:Tf},536:{f:uw},547:{f:cw},561:{},579:{},1030:{f:Hd},1033:{f:Tf},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function Wn(t,e,r,n){var i=e;if(!isNaN(i)){var s=(r||[]).length||0,a=t.next(4);a.write_shift(2,i),a.write_shift(2,s),s>0&&mA(r)&&t.push(r)}}function Ew(t,e){var r=e||{},n=r.dense?[]:{};t=t.replace(/<!--.*?-->/g,"");var i=t.match(/<table/i);if(!i)throw new Error("Invalid HTML: could not find <table>");var s=t.match(/<\/table/i),a=i.index,o=s&&s.index||t.length,l=rM(t.slice(a,o),/(:?<tr[^>]*>)/i,"<tr>"),c=-1,u=0,h=0,d=0,p={s:{r:1e7,c:1e7},e:{r:0,c:0}},x=[];for(a=0;a<l.length;++a){var v=l[a].trim(),E=v.slice(0,3).toLowerCase();if(E=="<tr"){if(++c,r.sheetRows&&r.sheetRows<=c){--c;break}u=0;continue}if(!(E!="<td"&&E!="<th")){var T=v.split(/<\/t[dh]>/i);for(o=0;o<T.length;++o){var w=T[o].trim();if(w.match(/<t[dh]/i)){for(var y=w,R=0;y.charAt(0)=="<"&&(R=y.indexOf(">"))>-1;)y=y.slice(R+1);for(var M=0;M<x.length;++M){var j=x[M];j.s.c==u&&j.s.r<c&&c<=j.e.r&&(u=j.e.c+1,M=-1)}var g=Oe(w.slice(0,w.indexOf(">")));d=g.colspan?+g.colspan:1,((h=+g.rowspan)>1||d>1)&&x.push({s:{r:c,c:u},e:{r:c+(h||1)-1,c:u+d-1}});var k=g.t||g["data-t"]||"";if(!y.length){u+=d;continue}if(y=rA(y),p.s.r>c&&(p.s.r=c),p.e.r<c&&(p.e.r=c),p.s.c>u&&(p.s.c=u),p.e.c<u&&(p.e.c=u),!y.length){u+=d;continue}var S={t:"s",v:y};r.raw||!y.trim().length||k=="s"||(y==="TRUE"?S={t:"b",v:!0}:y==="FALSE"?S={t:"b",v:!1}:isNaN(ni(y))?isNaN(ol(y).getDate())||(S={t:"d",v:hr(y)},r.cellDates||(S={t:"n",v:Yr(S.v)}),S.z=r.dateNF||ze[14]):S={t:"n",v:ni(y)}),r.dense?(n[c]||(n[c]=[]),n[c][u]=S):n[je({r:c,c:u})]=S,u+=d}}}}return n["!ref"]=rt(p),x.length&&(n["!merges"]=x),n}function FB(t,e,r,n){for(var i=t["!merges"]||[],s=[],a=e.s.c;a<=e.e.c;++a){for(var o=0,l=0,c=0;c<i.length;++c)if(!(i[c].s.r>r||i[c].s.c>a)&&!(i[c].e.r<r||i[c].e.c<a)){if(i[c].s.r<r||i[c].s.c<a){o=-1;break}o=i[c].e.r-i[c].s.r+1,l=i[c].e.c-i[c].s.c+1;break}if(!(o<0)){var u=je({r,c:a}),h=n.dense?(t[r]||[])[a]:t[u],d=h&&h.v!=null&&(h.h||Dv(h.w||(cs(h),h.w)||""))||"",p={};o>1&&(p.rowspan=o),l>1&&(p.colspan=l),n.editable?d='<span contenteditable="true">'+d+"</span>":h&&(p["data-t"]=h&&h.t||"z",h.v!=null&&(p["data-v"]=h.v),h.z!=null&&(p["data-z"]=h.z),h.l&&(h.l.Target||"#").charAt(0)!="#"&&(d='<a href="'+h.l.Target+'">'+d+"</a>")),p.id=(n.id||"sjs")+"-"+u,s.push(xM("td",d,p))}}var x="<tr>";return x+s.join("")+"</tr>"}var DB='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',bB="</body></html>";function OB(t,e){var r=t.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!r||r.length==0)throw new Error("Invalid HTML: could not find <table>");if(r.length==1)return aa(Ew(r[0],e),e);var n=Qv();return r.forEach(function(i,s){Jv(n,Ew(i,e),"Sheet"+(s+1))}),n}function LB(t,e,r){var n=[];return n.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function MB(t,e){var r=e||{},n=r.header!=null?r.header:DB,i=r.footer!=null?r.footer:bB,s=[n],a=_l(t["!ref"]);r.dense=Array.isArray(t),s.push(LB(t,a,r));for(var o=a.s.r;o<=a.e.r;++o)s.push(FB(t,a,o,r));return s.push("</table>"+i),s.join("")}function oI(t,e,r){var n=r||{},i=0,s=0;if(n.origin!=null)if(typeof n.origin=="number")i=n.origin;else{var a=typeof n.origin=="string"?Gr(n.origin):n.origin;i=a.r,s=a.c}var o=e.getElementsByTagName("tr"),l=Math.min(n.sheetRows||1e7,o.length),c={s:{r:0,c:0},e:{r:i,c:s}};if(t["!ref"]){var u=_l(t["!ref"]);c.s.r=Math.min(c.s.r,u.s.r),c.s.c=Math.min(c.s.c,u.s.c),c.e.r=Math.max(c.e.r,u.e.r),c.e.c=Math.max(c.e.c,u.e.c),i==-1&&(c.e.r=i=u.e.r+1)}var h=[],d=0,p=t["!rows"]||(t["!rows"]=[]),x=0,v=0,E=0,T=0,w=0,y=0;for(t["!cols"]||(t["!cols"]=[]);x<o.length&&v<l;++x){var R=o[x];if(Tw(R)){if(n.display)continue;p[v]={hidden:!0}}var M=R.children;for(E=T=0;E<M.length;++E){var j=M[E];if(!(n.display&&Tw(j))){var g=j.hasAttribute("data-v")?j.getAttribute("data-v"):j.hasAttribute("v")?j.getAttribute("v"):rA(j.innerHTML),k=j.getAttribute("data-z")||j.getAttribute("z");for(d=0;d<h.length;++d){var S=h[d];S.s.c==T+s&&S.s.r<v+i&&v+i<=S.e.r&&(T=S.e.c+1-s,d=-1)}y=+j.getAttribute("colspan")||1,((w=+j.getAttribute("rowspan")||1)>1||y>1)&&h.push({s:{r:v+i,c:T+s},e:{r:v+i+(w||1)-1,c:T+s+(y||1)-1}});var C={t:"s",v:g},F=j.getAttribute("data-t")||j.getAttribute("t")||"";g!=null&&(g.length==0?C.t=F||"z":n.raw||g.trim().length==0||F=="s"||(g==="TRUE"?C={t:"b",v:!0}:g==="FALSE"?C={t:"b",v:!1}:isNaN(ni(g))?isNaN(ol(g).getDate())||(C={t:"d",v:hr(g)},n.cellDates||(C={t:"n",v:Yr(C.v)}),C.z=n.dateNF||ze[14]):C={t:"n",v:ni(g)})),C.z===void 0&&k!=null&&(C.z=k);var P="",b=j.getElementsByTagName("A");if(b&&b.length)for(var ve=0;ve<b.length&&!(b[ve].hasAttribute("href")&&(P=b[ve].getAttribute("href"),P.charAt(0)!="#"));++ve);P&&P.charAt(0)!="#"&&(C.l={Target:P}),n.dense?(t[v+i]||(t[v+i]=[]),t[v+i][T+s]=C):t[je({c:T+s,r:v+i})]=C,c.e.c<T+s&&(c.e.c=T+s),T+=y}}++v}return h.length&&(t["!merges"]=(t["!merges"]||[]).concat(h)),c.e.r=Math.max(c.e.r,v-1+i),t["!ref"]=rt(c),v>=l&&(t["!fullref"]=rt((c.e.r=o.length-x+v-1+i,c))),t}function lI(t,e){var r=e||{},n=r.dense?[]:{};return oI(n,t,e)}function VB(t,e){return aa(lI(t,e),e)}function Tw(t){var e="",r=UB(t);return r&&(e=r(t).getPropertyValue("display")),e||(e=t.style&&t.style.display),e==="none"}function UB(t){return t.ownerDocument.defaultView&&typeof t.ownerDocument.defaultView.getComputedStyle=="function"?t.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function jB(t){var e=t.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(n,i){return Array(parseInt(i,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),r=at(e.replace(/<[^>]*>/g,""));return[r]}var kw={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function cI(t,e){var r=e||{},n=bv(t),i=[],s,a,o={name:""},l="",c=0,u,h,d={},p=[],x=r.dense?[]:{},v,E,T={value:""},w="",y=0,R=[],M=-1,j=-1,g={s:{r:1e6,c:1e7},e:{r:0,c:0}},k=0,S={},C=[],F={},P=0,b=0,ve=[],he=1,Se=1,oe=[],ie={Names:[]},G={},ue=["",""],Ee=[],B={},X="",K=0,W=!1,ae=!1,xe=0;for(iu.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");v=iu.exec(n);)switch(v[3]=v[3].replace(/_.*$/,"")){case"table":case"":v[1]==="/"?(g.e.c>=g.s.c&&g.e.r>=g.s.r?x["!ref"]=rt(g):x["!ref"]="A1:A1",r.sheetRows>0&&r.sheetRows<=g.e.r&&(x["!fullref"]=x["!ref"],g.e.r=r.sheetRows-1,x["!ref"]=rt(g)),C.length&&(x["!merges"]=C),ve.length&&(x["!rows"]=ve),u.name=u.||u.name,typeof JSON<"u"&&JSON.stringify(u),p.push(u.name),d[u.name]=x,ae=!1):v[0].charAt(v[0].length-2)!=="/"&&(u=Oe(v[0],!1),M=j=-1,g.s.r=g.s.c=1e7,g.e.r=g.e.c=0,x=r.dense?[]:{},C=[],ve=[],ae=!0);break;case"table-row-group":v[1]==="/"?--k:++k;break;case"table-row":case"":if(v[1]==="/"){M+=he,he=1;break}if(h=Oe(v[0],!1),h.?M=h.-1:M==-1&&(M=0),he=+h["number-rows-repeated"]||1,he<10)for(xe=0;xe<he;++xe)k>0&&(ve[M+xe]={level:k});j=-1;break;case"covered-table-cell":v[1]!=="/"&&++j,r.sheetStubs&&(r.dense?(x[M]||(x[M]=[]),x[M][j]={t:"z"}):x[je({r:M,c:j})]={t:"z"}),w="",R=[];break;case"table-cell":case"":if(v[0].charAt(v[0].length-2)==="/")++j,T=Oe(v[0],!1),Se=parseInt(T["number-columns-repeated"]||"1",10),E={t:"z",v:null},T.formula&&r.cellFormula!=!1&&(E.f=xw(at(T.formula))),(T.||T["value-type"])=="string"&&(E.t="s",E.v=at(T["string-value"]||""),r.dense?(x[M]||(x[M]=[]),x[M][j]=E):x[je({r:M,c:j})]=E),j+=Se-1;else if(v[1]!=="/"){++j,w="",y=0,R=[],Se=1;var ke=he?M+he-1:M;if(j>g.e.c&&(g.e.c=j),j<g.s.c&&(g.s.c=j),M<g.s.r&&(g.s.r=M),ke>g.e.r&&(g.e.r=ke),T=Oe(v[0],!1),Ee=[],B={},E={t:T.||T["value-type"],v:null},r.cellFormula)if(T.formula&&(T.formula=at(T.formula)),T["number-matrix-columns-spanned"]&&T["number-matrix-rows-spanned"]&&(P=parseInt(T["number-matrix-rows-spanned"],10)||0,b=parseInt(T["number-matrix-columns-spanned"],10)||0,F={s:{r:M,c:j},e:{r:M+P-1,c:j+b-1}},E.F=rt(F),oe.push([F,E.F])),T.formula)E.f=xw(T.formula);else for(xe=0;xe<oe.length;++xe)M>=oe[xe][0].s.r&&M<=oe[xe][0].e.r&&j>=oe[xe][0].s.c&&j<=oe[xe][0].e.c&&(E.F=oe[xe][1]);switch((T["number-columns-spanned"]||T["number-rows-spanned"])&&(P=parseInt(T["number-rows-spanned"],10)||0,b=parseInt(T["number-columns-spanned"],10)||0,F={s:{r:M,c:j},e:{r:M+P-1,c:j+b-1}},C.push(F)),T["number-columns-repeated"]&&(Se=parseInt(T["number-columns-repeated"],10)),E.t){case"boolean":E.t="b",E.v=Nt(T["boolean-value"]);break;case"float":E.t="n",E.v=parseFloat(T.value);break;case"percentage":E.t="n",E.v=parseFloat(T.value);break;case"currency":E.t="n",E.v=parseFloat(T.value);break;case"date":E.t="d",E.v=hr(T["date-value"]),r.cellDates||(E.t="n",E.v=Yr(E.v)),E.z="m/d/yy";break;case"time":E.t="n",E.v=ZL(T["time-value"])/86400,r.cellDates&&(E.t="d",E.v=$0(E.v)),E.z="HH:MM:SS";break;case"number":E.t="n",E.v=parseFloat(T.);break;default:if(E.t==="string"||E.t==="text"||!E.t)E.t="s",T["string-value"]!=null&&(w=at(T["string-value"]),R=[]);else throw new Error("Unsupported value type "+E.t)}}else{if(W=!1,E.t==="s"&&(E.v=w||"",R.length&&(E.R=R),W=y==0),G.Target&&(E.l=G),Ee.length>0&&(E.c=Ee,Ee=[]),w&&r.cellText!==!1&&(E.w=w),W&&(E.t="z",delete E.v),(!W||r.sheetStubs)&&!(r.sheetRows&&r.sheetRows<=M))for(var fe=0;fe<he;++fe){if(Se=parseInt(T["number-columns-repeated"]||"1",10),r.dense)for(x[M+fe]||(x[M+fe]=[]),x[M+fe][j]=fe==0?E:wr(E);--Se>0;)x[M+fe][j+Se]=wr(E);else for(x[je({r:M+fe,c:j})]=E;--Se>0;)x[je({r:M+fe,c:j+Se})]=wr(E);g.e.c<=j&&(g.e.c=j)}Se=parseInt(T["number-columns-repeated"]||"1",10),j+=Se-1,Se=0,E={},w="",R=[]}G={};break;case"document":case"document-content":case"":case"spreadsheet":case"":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(v[1]==="/"){if((s=i.pop())[0]!==v[3])throw"Bad state: "+s}else v[0].charAt(v[0].length-2)!=="/"&&i.push([v[3],!0]);break;case"annotation":if(v[1]==="/"){if((s=i.pop())[0]!==v[3])throw"Bad state: "+s;B.t=w,R.length&&(B.R=R),B.a=X,Ee.push(B)}else v[0].charAt(v[0].length-2)!=="/"&&i.push([v[3],!1]);X="",K=0,w="",y=0,R=[];break;case"creator":v[1]==="/"?X=n.slice(K,v.index):K=v.index+v[0].length;break;case"meta":case"":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(v[1]==="/"){if((s=i.pop())[0]!==v[3])throw"Bad state: "+s}else v[0].charAt(v[0].length-2)!=="/"&&i.push([v[3],!1]);w="",y=0,R=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(v[1]==="/"){if(S[o.name]=l,(s=i.pop())[0]!==v[3])throw"Bad state: "+s}else v[0].charAt(v[0].length-2)!=="/"&&(l="",o=Oe(v[0],!1),i.push([v[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(i[i.length-1][0]){case"time-style":case"date-style":a=Oe(v[0],!1),l+=kw[v[3]][a.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(i[i.length-1][0]){case"time-style":case"date-style":a=Oe(v[0],!1),l+=kw[v[3]][a.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(v[0].slice(-2)==="/>")break;if(v[1]==="/")switch(i[i.length-1][0]){case"number-style":case"date-style":case"time-style":l+=n.slice(c,v.index);break}else c=v.index+v[0].length;break;case"named-range":a=Oe(v[0],!1),ue=Wd(a["cell-range-address"]);var pe={Name:a.name,Ref:ue[0]+"!"+ue[1]};ae&&(pe.Sheet=p.length),ie.Names.push(pe);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"":if(["master-styles"].indexOf(i[i.length-1][0])>-1)break;if(v[1]==="/"&&(!T||!T["string-value"])){var $e=jB(n.slice(y,v.index));w=(w.length>0?w+`
`:"")+$e[0]}else Oe(v[0],!1),y=v.index+v[0].length;break;case"s":break;case"database-range":if(v[1]==="/")break;try{ue=Wd(Oe(v[0])["target-range-address"]),d[ue[0]]["!autofilter"]={ref:ue[1]}}catch{}break;case"date":break;case"object":break;case"title":case"":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(v[1]!=="/"){if(G=Oe(v[0],!1),!G.href)break;G.Target=at(G.href),delete G.href,G.Target.charAt(0)=="#"&&G.Target.indexOf(".")>-1?(ue=Wd(G.Target.slice(1)),G.Target="#"+ue[0]+"!"+ue[1]):G.Target.match(/^\.\.[\\\/]/)&&(G.Target=G.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(v[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case":":case":":break;default:if(r.WTF)throw new Error(v)}}var z={Sheets:d,SheetNames:p,Workbook:ie};return r.bookSheets&&delete z.Sheets,z}function Sw(t,e){e=e||{},Nn(t,"META-INF/manifest.xml")&&r8(Kt(t,"META-INF/manifest.xml"),e);var r=gn(t,"content.xml");if(!r)throw new Error("Missing content.xml in ODS / UOF file");var n=cI(wt(r),e);return Nn(t,"meta.xml")&&(n.Props=EA(Kt(t,"meta.xml"))),n}function Aw(t,e){return cI(t,e)}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function Kv(t){return new DataView(t.buffer,t.byteOffset,t.byteLength)}function Am(t){return typeof TextDecoder<"u"?new TextDecoder().decode(t):wt(Ja(t))}function Im(t){var e=t.reduce(function(i,s){return i+s.length},0),r=new Uint8Array(e),n=0;return t.forEach(function(i){r.set(i,n),n+=i.length}),r}function Iw(t){return t-=t>>1&1431655765,t=(t&858993459)+(t>>2&858993459),(t+(t>>4)&252645135)*16843009>>>24}function BB(t,e){for(var r=(t[e+15]&127)<<7|t[e+14]>>1,n=t[e+14]&1,i=e+13;i>=e;--i)n=n*256+t[i];return(t[e+15]&128?-n:n)*Math.pow(10,r-6176)}function lu(t,e){var r=e?e[0]:0,n=t[r]&127;e:if(t[r++]>=128&&(n|=(t[r]&127)<<7,t[r++]<128||(n|=(t[r]&127)<<14,t[r++]<128)||(n|=(t[r]&127)<<21,t[r++]<128)||(n+=(t[r]&127)*Math.pow(2,28),++r,t[r++]<128)||(n+=(t[r]&127)*Math.pow(2,35),++r,t[r++]<128)||(n+=(t[r]&127)*Math.pow(2,42),++r,t[r++]<128)))break e;return e&&(e[0]=r),n}function sr(t){var e=0,r=t[e]&127;e:if(t[e++]>=128){if(r|=(t[e]&127)<<7,t[e++]<128||(r|=(t[e]&127)<<14,t[e++]<128)||(r|=(t[e]&127)<<21,t[e++]<128))break e;r|=(t[e]&127)<<28}return r}function Mr(t){for(var e=[],r=[0];r[0]<t.length;){var n=r[0],i=lu(t,r),s=i&7;i=Math.floor(i/8);var a=0,o;if(i==0)break;switch(s){case 0:{for(var l=r[0];t[r[0]++]>=128;);o=t.slice(l,r[0])}break;case 5:a=4,o=t.slice(r[0],r[0]+a),r[0]+=a;break;case 1:a=8,o=t.slice(r[0],r[0]+a),r[0]+=a;break;case 2:a=lu(t,r),o=t.slice(r[0],r[0]+a),r[0]+=a;break;case 3:case 4:default:throw new Error("PB Type ".concat(s," for Field ").concat(i," at offset ").concat(n))}var c={data:o,type:s};e[i]==null?e[i]=[c]:e[i].push(c)}return e}function qv(t,e){return(t==null?void 0:t.map(function(r){return e(r.data)}))||[]}function zB(t){for(var e,r=[],n=[0];n[0]<t.length;){var i=lu(t,n),s=Mr(t.slice(n[0],n[0]+i));n[0]+=i;var a={id:sr(s[1][0].data),messages:[]};s[2].forEach(function(o){var l=Mr(o.data),c=sr(l[3][0].data);a.messages.push({meta:l,data:t.slice(n[0],n[0]+c)}),n[0]+=c}),(e=s[3])!=null&&e[0]&&(a.merge=sr(s[3][0].data)>>>0>0),r.push(a)}return r}function $B(t,e){if(t!=0)throw new Error("Unexpected Snappy chunk type ".concat(t));for(var r=[0],n=lu(e,r),i=[];r[0]<e.length;){var s=e[r[0]]&3;if(s==0){var a=e[r[0]++]>>2;if(a<60)++a;else{var o=a-59;a=e[r[0]],o>1&&(a|=e[r[0]+1]<<8),o>2&&(a|=e[r[0]+2]<<16),o>3&&(a|=e[r[0]+3]<<24),a>>>=0,a++,r[0]+=o}i.push(e.slice(r[0],r[0]+a)),r[0]+=a;continue}else{var l=0,c=0;if(s==1?(c=(e[r[0]]>>2&7)+4,l=(e[r[0]++]&224)<<3,l|=e[r[0]++]):(c=(e[r[0]++]>>2)+1,s==2?(l=e[r[0]]|e[r[0]+1]<<8,r[0]+=2):(l=(e[r[0]]|e[r[0]+1]<<8|e[r[0]+2]<<16|e[r[0]+3]<<24)>>>0,r[0]+=4)),i=[Im(i)],l==0)throw new Error("Invalid offset 0");if(l>i[0].length)throw new Error("Invalid offset beyond length");if(c>=l)for(i.push(i[0].slice(-l)),c-=l;c>=i[i.length-1].length;)i.push(i[i.length-1]),c-=i[i.length-1].length;i.push(i[0].slice(-l,-l+c))}}var u=Im(i);if(u.length!=n)throw new Error("Unexpected length: ".concat(u.length," != ").concat(n));return u}function HB(t){for(var e=[],r=0;r<t.length;){var n=t[r++],i=t[r]|t[r+1]<<8|t[r+2]<<16;r+=3,e.push($B(n,t.slice(r,r+i))),r+=i}if(r!==t.length)throw new Error("data is not a valid framed stream!");return Im(e)}function WB(t,e,r,n){var i=Kv(t),s=i.getUint32(4,!0),a=(n>1?12:8)+Iw(s&(n>1?3470:398))*4,o=-1,l=-1,c=NaN,u=new Date(2001,0,1);s&512&&(o=i.getUint32(a,!0),a+=4),a+=Iw(s&(n>1?12288:4096))*4,s&16&&(l=i.getUint32(a,!0),a+=4),s&32&&(c=i.getFloat64(a,!0),a+=8),s&64&&(u.setTime(u.getTime()+i.getFloat64(a,!0)*1e3),a+=8);var h;switch(t[2]){case 0:break;case 2:h={t:"n",v:c};break;case 3:h={t:"s",v:e[l]};break;case 5:h={t:"d",v:u};break;case 6:h={t:"b",v:c>0};break;case 7:h={t:"n",v:c/86400};break;case 8:h={t:"e",v:0};break;case 9:if(o>-1)h={t:"s",v:r[o]};else if(l>-1)h={t:"s",v:e[l]};else if(!isNaN(c))h={t:"n",v:c};else throw new Error("Unsupported cell type ".concat(t.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(t.slice(0,4)))}return h}function GB(t,e,r){var n=Kv(t),i=n.getUint32(8,!0),s=12,a=-1,o=-1,l=NaN,c=NaN,u=new Date(2001,0,1);i&1&&(l=BB(t,s),s+=16),i&2&&(c=n.getFloat64(s,!0),s+=8),i&4&&(u.setTime(u.getTime()+n.getFloat64(s,!0)*1e3),s+=8),i&8&&(o=n.getUint32(s,!0),s+=4),i&16&&(a=n.getUint32(s,!0),s+=4);var h;switch(t[1]){case 0:break;case 2:h={t:"n",v:l};break;case 3:h={t:"s",v:e[o]};break;case 5:h={t:"d",v:u};break;case 6:h={t:"b",v:c>0};break;case 7:h={t:"n",v:c/86400};break;case 8:h={t:"e",v:0};break;case 9:if(a>-1)h={t:"s",v:r[a]};else throw new Error("Unsupported cell type ".concat(t[1]," : ").concat(i&31," : ").concat(t.slice(0,4)));break;case 10:h={t:"n",v:l};break;default:throw new Error("Unsupported cell type ".concat(t[1]," : ").concat(i&31," : ").concat(t.slice(0,4)))}return h}function KB(t,e,r){switch(t[0]){case 0:case 1:case 2:case 3:return WB(t,e,r,t[0]);case 5:return GB(t,e,r);default:throw new Error("Unsupported payload version ".concat(t[0]))}}function Gs(t){var e=Mr(t);return lu(e[1][0].data)}function Cw(t,e){var r=Mr(e.data),n=sr(r[1][0].data),i=r[3],s=[];return(i||[]).forEach(function(a){var o=Mr(a.data),l=sr(o[1][0].data)>>>0;switch(n){case 1:s[l]=Am(o[3][0].data);break;case 8:{var c=t[Gs(o[9][0].data)][0],u=Mr(c.data),h=t[Gs(u[1][0].data)][0],d=sr(h.meta[1][0].data);if(d!=2001)throw new Error("2000 unexpected reference to ".concat(d));var p=Mr(h.data);s[l]=p[3].map(function(x){return Am(x.data)}).join("")}break}}),s}function qB(t,e){var r,n,i,s,a,o,l,c,u,h,d,p,x,v,E=Mr(t),T=sr(E[1][0].data)>>>0,w=sr(E[2][0].data)>>>0,y=((n=(r=E[8])==null?void 0:r[0])==null?void 0:n.data)&&sr(E[8][0].data)>0||!1,R,M;if((s=(i=E[7])==null?void 0:i[0])!=null&&s.data&&e!=0)R=(o=(a=E[7])==null?void 0:a[0])==null?void 0:o.data,M=(c=(l=E[6])==null?void 0:l[0])==null?void 0:c.data;else if((h=(u=E[4])==null?void 0:u[0])!=null&&h.data&&e!=1)R=(p=(d=E[4])==null?void 0:d[0])==null?void 0:p.data,M=(v=(x=E[3])==null?void 0:x[0])==null?void 0:v.data;else throw"NUMBERS Tile missing ".concat(e," cell storage");for(var j=y?4:1,g=Kv(R),k=[],S=0;S<R.length/2;++S){var C=g.getUint16(S*2,!0);C<65535&&k.push([S,C])}if(k.length!=w)throw"Expected ".concat(w," cells, found ").concat(k.length);var F=[];for(S=0;S<k.length-1;++S)F[k[S][0]]=M.subarray(k[S][1]*j,k[S+1][1]*j);return k.length>=1&&(F[k[k.length-1][0]]=M.subarray(k[k.length-1][1]*j)),{R:T,cells:F}}function XB(t,e){var r,n=Mr(e.data),i=(r=n==null?void 0:n[7])!=null&&r[0]?sr(n[7][0].data)>>>0>0?1:0:-1,s=qv(n[5],function(a){return qB(a,i)});return{nrows:sr(n[4][0].data)>>>0,data:s.reduce(function(a,o){return a[o.R]||(a[o.R]=[]),o.cells.forEach(function(l,c){if(a[o.R][c])throw new Error("Duplicate cell r=".concat(o.R," c=").concat(c));a[o.R][c]=l}),a},[])}}function YB(t,e,r){var n,i=Mr(e.data),s={s:{r:0,c:0},e:{r:0,c:0}};if(s.e.r=(sr(i[6][0].data)>>>0)-1,s.e.r<0)throw new Error("Invalid row varint ".concat(i[6][0].data));if(s.e.c=(sr(i[7][0].data)>>>0)-1,s.e.c<0)throw new Error("Invalid col varint ".concat(i[7][0].data));r["!ref"]=rt(s);var a=Mr(i[4][0].data),o=Cw(t,t[Gs(a[4][0].data)][0]),l=(n=a[17])!=null&&n[0]?Cw(t,t[Gs(a[17][0].data)][0]):[],c=Mr(a[3][0].data),u=0;c[1].forEach(function(h){var d=Mr(h.data),p=t[Gs(d[2][0].data)][0],x=sr(p.meta[1][0].data);if(x!=6002)throw new Error("6001 unexpected reference to ".concat(x));var v=XB(t,p);v.data.forEach(function(E,T){E.forEach(function(w,y){var R=je({r:u+T,c:y}),M=KB(w,o,l);M&&(r[R]=M)})}),u+=v.nrows})}function QB(t,e){var r=Mr(e.data),n={"!ref":"A1"},i=t[Gs(r[2][0].data)],s=sr(i[0].meta[1][0].data);if(s!=6001)throw new Error("6000 unexpected reference to ".concat(s));return YB(t,i[0],n),n}function JB(t,e){var r,n=Mr(e.data),i={name:(r=n[1])!=null&&r[0]?Am(n[1][0].data):"",sheets:[]},s=qv(n[2],Gs);return s.forEach(function(a){t[a].forEach(function(o){var l=sr(o.meta[1][0].data);l==6e3&&i.sheets.push(QB(t,o))})}),i}function ZB(t,e){var r=Qv(),n=Mr(e.data),i=qv(n[1],Gs);if(i.forEach(function(s){t[s].forEach(function(a){var o=sr(a.meta[1][0].data);if(o==2){var l=JB(t,a);l.sheets.forEach(function(c,u){Jv(r,c,u==0?l.name:l.name+"_"+u,!0)})}})}),r.SheetNames.length==0)throw new Error("Empty NUMBERS file");return r}function Kd(t){var e,r,n,i,s={},a=[];if(t.FullPaths.forEach(function(l){if(l.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),t.FileIndex.forEach(function(l){if(l.name.match(/\.iwa$/)){var c;try{c=HB(l.content)}catch(h){return console.log("?? "+l.content.length+" "+(h.message||h))}var u;try{u=zB(c)}catch(h){return console.log("## "+(h.message||h))}u.forEach(function(h){s[h.id]=h.messages,a.push(h.id)})}}),!a.length)throw new Error("File has no messages");var o=((i=(n=(r=(e=s==null?void 0:s[1])==null?void 0:e[0])==null?void 0:r.meta)==null?void 0:n[1])==null?void 0:i[0].data)&&sr(s[1][0].meta[1][0].data)==1&&s[1][0];if(o||a.forEach(function(l){s[l].forEach(function(c){var u=sr(c.meta[1][0].data)>>>0;if(u==1)if(!o)o=c;else throw new Error("Document has multiple roots")})}),!o)throw new Error("Cannot find Document root");return ZB(s,o)}function e7(t){return function(r){for(var n=0;n!=t.length;++n){var i=t[n];r[i[0]]===void 0&&(r[i[0]]=i[1]),i[2]==="n"&&(r[i[0]]=Number(r[i[0]]))}}}function Xv(t){e7([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(t)}function t7(t){return No.WS.indexOf(t)>-1?"sheet":t==No.CS?"chart":t==No.DS?"dialog":t==No.MS?"macro":t&&t.length?t:"sheet"}function r7(t,e){if(!t)return 0;try{t=e.map(function(n){return n.id||(n.id=n.strRelID),[n.name,t["!id"][n.id].Target,t7(t["!id"][n.id].Type)]})}catch{return null}return!t||t.length===0?null:t}function n7(t,e,r,n,i,s,a,o,l,c,u,h){try{s[n]=yc(gn(t,r,!0),e);var d=Kt(t,e),p;switch(o){case"sheet":p=cB(d,e,i,l,s[n],c,u,h);break;case"chart":if(p=uB(d,e,i,l,s[n],c,u,h),!p||!p["!drawel"])break;var x=Zl(p["!drawel"].Target,e),v=wm(x),E=lV(gn(t,x,!0),yc(gn(t,v,!0),x)),T=Zl(E,x),w=wm(T);p=Gj(gn(t,T,!0),T,l,yc(gn(t,w,!0),T),c,p);break;case"macro":p=fB(d,e,i,l,s[n],c,u,h);break;case"dialog":p=hB(d,e,i,l,s[n],c,u,h);break;default:throw new Error("Unrecognized sheet type "+o)}a[n]=p;var y=[];s&&s[n]&&ki(s[n]).forEach(function(R){var M="";if(s[n][R].Type==No.CMNT){M=Zl(s[n][R].Target,e);var j=gB(Kt(t,M,!0),M,l);if(!j||!j.length)return;dw(p,j,!1)}s[n][R].Type==No.TCMNT&&(M=Zl(s[n][R].Target,e),y=y.concat(uV(Kt(t,M,!0),l)))}),y&&y.length&&dw(p,y,!0,l.people||[])}catch(R){if(l.WTF)throw R}}function Cn(t){return t.charAt(0)=="/"?t.slice(1):t}function i7(t,e){if(KS(),e=e||{},Xv(e),Nn(t,"META-INF/manifest.xml")||Nn(t,"objectdata.xml"))return Sw(t,e);if(Nn(t,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof Kd<"u"){if(t.FileIndex)return Kd(t);var r=tt.utils.cfb_new();return jy(t).forEach(function(ve){sM(r,ve,iM(t,ve))}),Kd(r)}throw new Error("Unsupported NUMBERS file")}if(!Nn(t,"[Content_Types].xml"))throw Nn(t,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):Nn(t,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var n=jy(t),i=e8(gn(t,"[Content_Types].xml")),s=!1,a,o;if(i.workbooks.length===0&&(o="xl/workbook.xml",Kt(t,o,!0)&&i.workbooks.push(o)),i.workbooks.length===0){if(o="xl/workbook.bin",!Kt(t,o,!0))throw new Error("Could not find workbook");i.workbooks.push(o),s=!0}i.workbooks[0].slice(-3)=="bin"&&(s=!0);var l={},c={};if(!e.bookSheets&&!e.bookProps){if(Tc=[],i.sst)try{Tc=mB(Kt(t,Cn(i.sst)),i.sst,e)}catch(ve){if(e.WTF)throw ve}e.cellStyles&&i.themes.length&&(l=pB(gn(t,i.themes[0].replace(/^\//,""),!0)||"",i.themes[0],e)),i.style&&(c=dB(Kt(t,Cn(i.style)),i.style,l,e))}i.links.map(function(ve){try{var he=yc(gn(t,wm(Cn(ve))),ve);return xB(Kt(t,Cn(ve)),he,ve,e)}catch{}});var u=lB(Kt(t,Cn(i.workbooks[0])),i.workbooks[0],e),h={},d="";i.coreprops.length&&(d=Kt(t,Cn(i.coreprops[0]),!0),d&&(h=EA(d)),i.extprops.length!==0&&(d=Kt(t,Cn(i.extprops[0]),!0),d&&s8(d,h,e)));var p={};(!e.bookSheets||e.bookProps)&&i.custprops.length!==0&&(d=gn(t,Cn(i.custprops[0]),!0),d&&(p=o8(d,e)));var x={};if((e.bookSheets||e.bookProps)&&(u.Sheets?a=u.Sheets.map(function(he){return he.name}):h.Worksheets&&h.SheetNames.length>0&&(a=h.SheetNames),e.bookProps&&(x.Props=h,x.Custprops=p),e.bookSheets&&typeof a<"u"&&(x.SheetNames=a),e.bookSheets?x.SheetNames:e.bookProps))return x;a={};var v={};e.bookDeps&&i.calcchain&&(v=vB(Kt(t,Cn(i.calcchain)),i.calcchain));var E=0,T={},w,y;{var R=u.Sheets;h.Worksheets=R.length,h.SheetNames=[];for(var M=0;M!=R.length;++M)h.SheetNames[M]=R[M].name}var j=s?"bin":"xml",g=i.workbooks[0].lastIndexOf("/"),k=(i.workbooks[0].slice(0,g+1)+"_rels/"+i.workbooks[0].slice(g+1)+".rels").replace(/^\//,"");Nn(t,k)||(k="xl/_rels/workbook."+j+".rels");var S=yc(gn(t,k,!0),k.replace(/_rels.*/,"s5s"));(i.metadata||[]).length>=1&&(e.xlmeta=_B(Kt(t,Cn(i.metadata[0])),i.metadata[0],e)),(i.people||[]).length>=1&&(e.people=fV(Kt(t,Cn(i.people[0])),e)),S&&(S=r7(S,u.Sheets));var C=Kt(t,"xl/worksheets/sheet.xml",!0)?1:0;e:for(E=0;E!=h.Worksheets;++E){var F="sheet";if(S&&S[E]?(w="xl/"+S[E][1].replace(/[\/]?xl\//,""),Nn(t,w)||(w=S[E][1]),Nn(t,w)||(w=k.replace(/_rels\/.*$/,"")+S[E][1]),F=S[E][2]):(w="xl/worksheets/sheet"+(E+1-C)+"."+j,w=w.replace(/sheet0\./,"sheet.")),y=w.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),e&&e.sheets!=null)switch(typeof e.sheets){case"number":if(E!=e.sheets)continue e;break;case"string":if(h.SheetNames[E].toLowerCase()!=e.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(e.sheets)){for(var P=!1,b=0;b!=e.sheets.length;++b)typeof e.sheets[b]=="number"&&e.sheets[b]==E&&(P=1),typeof e.sheets[b]=="string"&&e.sheets[b].toLowerCase()==h.SheetNames[E].toLowerCase()&&(P=1);if(!P)continue e}}n7(t,w,y,h.SheetNames[E],E,T,a,F,e,u,l,c)}return x={Directory:i,Workbook:u,Props:h,Custprops:p,Deps:v,Sheets:a,SheetNames:h.SheetNames,Strings:Tc,Styles:c,Themes:l,SSF:wr(ze)},e&&e.bookFiles&&(t.files?(x.keys=n,x.files=t.files):(x.keys=[],x.files={},t.FullPaths.forEach(function(ve,he){ve=ve.replace(/^Root Entry[\/]/,""),x.keys.push(ve),x.files[ve]=t.FileIndex[he]}))),e&&e.bookVBA&&(i.vba.length>0?x.vbaraw=Kt(t,Cn(i.vba[0]),!0):i.defaults&&i.defaults.bin===mV&&(x.vbaraw=Kt(t,"xl/vbaProject.bin",!0))),x}function s7(t,e){var r=e||{},n="Workbook",i=tt.find(t,n);try{if(n="/!DataSpaces/Version",i=tt.find(t,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(Q5(i.content),n="/!DataSpaces/DataSpaceMap",i=tt.find(t,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);var s=Z5(i.content);if(s.length!==1||s[0].comps.length!==1||s[0].comps[0].t!==0||s[0].name!=="StrongEncryptionDataSpace"||s[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",i=tt.find(t,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);var a=e9(i.content);if(a.length!=1||a[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",i=tt.find(t,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);r9(i.content)}catch{}if(n="/EncryptionInfo",i=tt.find(t,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);var o=n9(i.content);if(n="/EncryptedPackage",i=tt.find(t,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(o[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(o[1],i.content,r.password||"",r);if(o[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(o[1],i.content,r.password||"",r);throw new Error("File is password-protected")}function Yv(t,e){var r="";switch((e||{}).type||"base64"){case"buffer":return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]];case"base64":r=En(t.slice(0,12));break;case"binary":r=t;break;case"array":return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]];default:throw new Error("Unrecognized type "+(e&&e.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function a7(t,e){return tt.find(t,"EncryptedPackage")?s7(t,e):aI(t,e)}function o7(t,e){var r,n=t,i=e||{};return i.type||(i.type=Je&&Buffer.isBuffer(t)?"buffer":"base64"),r=ZS(n,i),i7(r,i)}function uI(t,e){var r=0;e:for(;r<t.length;)switch(t.charCodeAt(r)){case 10:case 13:case 32:++r;break;case 60:return km(t.slice(r),e);default:break e}return su.to_workbook(t,e)}function l7(t,e){var r="",n=Yv(t,e);switch(e.type){case"base64":r=En(t);break;case"binary":r=t;break;case"buffer":r=t.toString("binary");break;case"array":r=ja(t);break;default:throw new Error("Unrecognized type "+e.type)}return n[0]==239&&n[1]==187&&n[2]==191&&(r=wt(r)),e.type="binary",uI(r,e)}function c7(t,e){var r=t;return e.type=="base64"&&(r=En(r)),r=tu.utils.decode(1200,r.slice(2),"str"),e.type="binary",uI(r,e)}function u7(t){return t.match(/[^\x00-\x7F]/)?ec(t):t}function qd(t,e,r,n){return n?(r.type="string",su.to_workbook(t,r)):su.to_workbook(e,r)}function Cm(t,e){OS();var r=e||{};if(typeof ArrayBuffer<"u"&&t instanceof ArrayBuffer)return Cm(new Uint8Array(t),(r=wr(r),r.type="array",r));typeof Uint8Array<"u"&&t instanceof Uint8Array&&!r.type&&(r.type=typeof Deno<"u"?"buffer":"array");var n=t,i=[0,0,0,0],s=!1;if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),$o={},r.dateNF&&($o.dateNF=r.dateNF),r.type||(r.type=Je&&Buffer.isBuffer(t)?"buffer":"base64"),r.type=="file"&&(r.type=Je?"buffer":"binary",n=QL(t),typeof Uint8Array<"u"&&!Je&&(r.type="array")),r.type=="string"&&(s=!0,r.type="binary",r.codepage=65001,n=u7(t)),r.type=="array"&&typeof Uint8Array<"u"&&t instanceof Uint8Array&&typeof ArrayBuffer<"u"){var a=new ArrayBuffer(3),o=new Uint8Array(a);if(o.foo="bar",!o.foo)return r=wr(r),r.type="array",Cm(Cv(n),r)}switch((i=Yv(n,r))[0]){case 208:if(i[1]===207&&i[2]===17&&i[3]===224&&i[4]===161&&i[5]===177&&i[6]===26&&i[7]===225)return a7(tt.read(n,r),r);break;case 9:if(i[1]<=8)return aI(n,r);break;case 60:return km(n,r);case 73:if(i[1]===73&&i[2]===42&&i[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(i[1]===68)return V5(n,r);break;case 84:if(i[1]===65&&i[2]===66&&i[3]===76)return L5.to_workbook(n,r);break;case 80:return i[1]===75&&i[2]<9&&i[3]<9?o7(n,r):qd(t,n,r,s);case 239:return i[3]===60?km(n,r):qd(t,n,r,s);case 255:if(i[1]===254)return c7(n,r);if(i[1]===0&&i[2]===2&&i[3]===0)return Ec.to_workbook(n,r);break;case 0:if(i[1]===0&&(i[2]>=2&&i[3]===0||i[2]===0&&(i[3]===8||i[3]===9)))return Ec.to_workbook(n,r);break;case 3:case 131:case 139:case 140:return hw.to_workbook(n,r);case 123:if(i[1]===92&&i[2]===114&&i[3]===116)return m9.to_workbook(n,r);break;case 10:case 13:case 32:return l7(n,r);case 137:if(i[1]===80&&i[2]===78&&i[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return b5.indexOf(i[0])>-1&&i[2]<=12&&i[3]<=31?hw.to_workbook(n,r):qd(t,n,r,s)}function f7(t,e,r,n,i,s,a,o){var l=Er(r),c=o.defval,u=o.raw||!Object.prototype.hasOwnProperty.call(o,"raw"),h=!0,d=i===1?[]:{};if(i!==1)if(Object.defineProperty)try{Object.defineProperty(d,"__rowNum__",{value:r,enumerable:!1})}catch{d.__rowNum__=r}else d.__rowNum__=r;if(!a||t[r])for(var p=e.s.c;p<=e.e.c;++p){var x=a?t[r][p]:t[n[p]+l];if(x===void 0||x.t===void 0){if(c===void 0)continue;s[p]!=null&&(d[s[p]]=c);continue}var v=x.v;switch(x.t){case"z":if(v==null)break;continue;case"e":v=v==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+x.t)}if(s[p]!=null){if(v==null)if(x.t=="e"&&v===null)d[s[p]]=null;else if(c!==void 0)d[s[p]]=c;else if(u&&v===null)d[s[p]]=null;else continue;else d[s[p]]=u&&(x.t!=="n"||x.t==="n"&&o.rawNumbers!==!1)?v:cs(x,v,o);v!=null&&(h=!1)}}return{row:d,isempty:h}}function Rm(t,e){if(t==null||t["!ref"]==null)return[];var r={t:"n",v:0},n=0,i=1,s=[],a=0,o="",l={s:{r:0,c:0},e:{r:0,c:0}},c=e||{},u=c.range!=null?c.range:t["!ref"];switch(c.header===1?n=1:c.header==="A"?n=2:Array.isArray(c.header)?n=3:c.header==null&&(n=0),typeof u){case"string":l=jt(u);break;case"number":l=jt(t["!ref"]),l.s.r=u;break;default:l=u}n>0&&(i=0);var h=Er(l.s.r),d=[],p=[],x=0,v=0,E=Array.isArray(t),T=l.s.r,w=0,y={};E&&!t[T]&&(t[T]=[]);var R=c.skipHidden&&t["!cols"]||[],M=c.skipHidden&&t["!rows"]||[];for(w=l.s.c;w<=l.e.c;++w)if(!(R[w]||{}).hidden)switch(d[w]=nr(w),r=E?t[T][w]:t[d[w]+h],n){case 1:s[w]=w-l.s.c;break;case 2:s[w]=d[w];break;case 3:s[w]=c.header[w-l.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),o=a=cs(r,null,c),v=y[a]||0,!v)y[a]=1;else{do o=a+"_"+v++;while(y[o]);y[a]=v,y[o]=1}s[w]=o}for(T=l.s.r+i;T<=l.e.r;++T)if(!(M[T]||{}).hidden){var j=f7(t,l,T,d,n,s,E,c);(j.isempty===!1||(n===1?c.blankrows!==!1:c.blankrows))&&(p[x++]=j.row)}return p.length=x,p}var Rw=/"/g;function h7(t,e,r,n,i,s,a,o){for(var l=!0,c=[],u="",h=Er(r),d=e.s.c;d<=e.e.c;++d)if(n[d]){var p=o.dense?(t[r]||[])[d]:t[n[d]+h];if(p==null)u="";else if(p.v!=null){l=!1,u=""+(o.rawNumbers&&p.t=="n"?p.v:cs(p,null,o));for(var x=0,v=0;x!==u.length;++x)if((v=u.charCodeAt(x))===i||v===s||v===34||o.forceQuotes){u='"'+u.replace(Rw,'""')+'"';break}u=="ID"&&(u='"ID"')}else p.f!=null&&!p.F?(l=!1,u="="+p.f,u.indexOf(",")>=0&&(u='"'+u.replace(Rw,'""')+'"')):u="";c.push(u)}return o.blankrows===!1&&l?null:c.join(a)}function fI(t,e){var r=[],n=e??{};if(t==null||t["!ref"]==null)return"";var i=jt(t["!ref"]),s=n.FS!==void 0?n.FS:",",a=s.charCodeAt(0),o=n.RS!==void 0?n.RS:`
`,l=o.charCodeAt(0),c=new RegExp((s=="|"?"\\|":s)+"+$"),u="",h=[];n.dense=Array.isArray(t);for(var d=n.skipHidden&&t["!cols"]||[],p=n.skipHidden&&t["!rows"]||[],x=i.s.c;x<=i.e.c;++x)(d[x]||{}).hidden||(h[x]=nr(x));for(var v=0,E=i.s.r;E<=i.e.r;++E)(p[E]||{}).hidden||(u=h7(t,i,E,h,a,l,s,n),u!=null&&(n.strip&&(u=u.replace(c,"")),(u||n.blankrows!==!1)&&r.push((v++?o:"")+u)));return delete n.dense,r.join("")}function d7(t,e){e||(e={}),e.FS="	",e.RS=`
`;var r=fI(t,e);return r}function p7(t){var e="",r,n="";if(t==null||t["!ref"]==null)return[];var i=jt(t["!ref"]),s="",a=[],o,l=[],c=Array.isArray(t);for(o=i.s.c;o<=i.e.c;++o)a[o]=nr(o);for(var u=i.s.r;u<=i.e.r;++u)for(s=Er(u),o=i.s.c;o<=i.e.c;++o)if(e=a[o]+s,r=c?(t[u]||[])[o]:t[e],n="",r!==void 0){if(r.F!=null){if(e=r.F,!r.f)continue;n=r.f,e.indexOf(":")==-1&&(e=e+":"+e)}if(r.f!=null)n=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)n=""+r.v;else if(r.t=="b")n=r.v?"TRUE":"FALSE";else if(r.w!==void 0)n="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?n="'"+r.v:n=""+r.v}}l[l.length]=e+"="+n}return l}function hI(t,e,r){var n=r||{},i=+!n.skipHeader,s=t||{},a=0,o=0;if(s&&n.origin!=null)if(typeof n.origin=="number")a=n.origin;else{var l=typeof n.origin=="string"?Gr(n.origin):n.origin;a=l.r,o=l.c}var c,u={s:{c:0,r:0},e:{c:o,r:a+e.length-1+i}};if(s["!ref"]){var h=jt(s["!ref"]);u.e.c=Math.max(u.e.c,h.e.c),u.e.r=Math.max(u.e.r,h.e.r),a==-1&&(a=h.e.r+1,u.e.r=a+e.length-1+i)}else a==-1&&(a=0,u.e.r=e.length-1+i);var d=n.header||[],p=0;e.forEach(function(v,E){ki(v).forEach(function(T){(p=d.indexOf(T))==-1&&(d[p=d.length]=T);var w=v[T],y="z",R="",M=je({c:o+p,r:a+E+i});c=cu(s,M),w&&typeof w=="object"&&!(w instanceof Date)?s[M]=w:(typeof w=="number"?y="n":typeof w=="boolean"?y="b":typeof w=="string"?y="s":w instanceof Date?(y="d",n.cellDates||(y="n",w=Yr(w)),R=n.dateNF||ze[14]):w===null&&n.nullError&&(y="e",w=0),c?(c.t=y,c.v=w,delete c.w,delete c.R,R&&(c.z=R)):s[M]=c={t:y,v:w},R&&(c.z=R))})}),u.e.c=Math.max(u.e.c,o+d.length-1);var x=Er(a);if(i)for(p=0;p<d.length;++p)s[nr(p+o)+x]={t:"s",v:d[p]};return s["!ref"]=rt(u),s}function m7(t,e){return hI(null,t,e)}function cu(t,e,r){if(typeof e=="string"){if(Array.isArray(t)){var n=Gr(e);return t[n.r]||(t[n.r]=[]),t[n.r][n.c]||(t[n.r][n.c]={t:"z"})}return t[e]||(t[e]={t:"z"})}return typeof e!="number"?cu(t,je(e)):cu(t,je({r:e,c:r||0}))}function g7(t,e){if(typeof e=="number"){if(e>=0&&t.SheetNames.length>e)return e;throw new Error("Cannot find sheet # "+e)}else if(typeof e=="string"){var r=t.SheetNames.indexOf(e);if(r>-1)return r;throw new Error("Cannot find sheet name |"+e+"|")}else throw new Error("Cannot find sheet |"+e+"|")}function Qv(){return{SheetNames:[],Sheets:{}}}function Jv(t,e,r,n){var i=1;if(!r)for(;i<=65535&&t.SheetNames.indexOf(r="Sheet"+i)!=-1;++i,r=void 0);if(!r||t.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&t.SheetNames.indexOf(r)>=0){var s=r.match(/(^.*?)(\d+)$/);i=s&&+s[2]||0;var a=s&&s[1]||r;for(++i;i<=65535&&t.SheetNames.indexOf(r=a+i)!=-1;++i);}if(eB(r),t.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return t.SheetNames.push(r),t.Sheets[r]=e,r}function v7(t,e,r){t.Workbook||(t.Workbook={}),t.Workbook.Sheets||(t.Workbook.Sheets=[]);var n=g7(t,e);switch(t.Workbook.Sheets[n]||(t.Workbook.Sheets[n]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}t.Workbook.Sheets[n].Hidden=r}function x7(t,e){return t.z=e,t}function dI(t,e,r){return e?(t.l={Target:e},r&&(t.l.Tooltip=r)):delete t.l,t}function _7(t,e,r){return dI(t,"#"+e,r)}function y7(t,e,r){t.c||(t.c=[]),t.c.push({t:e,a:r||"SheetJS"})}function w7(t,e,r,n){for(var i=typeof e!="string"?e:jt(e),s=typeof e=="string"?e:rt(e),a=i.s.r;a<=i.e.r;++a)for(var o=i.s.c;o<=i.e.c;++o){var l=cu(t,a,o);l.t="n",l.F=s,delete l.v,a==i.s.r&&o==i.s.c&&(l.f=r,n&&(l.D=!0))}return t}var E7={encode_col:nr,encode_row:Er,encode_cell:je,encode_range:rt,decode_col:Mv,decode_row:Lv,split_cell:DM,decode_cell:Gr,decode_range:_l,format_cell:cs,sheet_add_aoa:vA,sheet_add_json:hI,sheet_add_dom:oI,aoa_to_sheet:yl,json_to_sheet:m7,table_to_sheet:lI,table_to_book:VB,sheet_to_csv:fI,sheet_to_txt:d7,sheet_to_json:Rm,sheet_to_html:MB,sheet_to_formulae:p7,sheet_to_row_object_array:Rm,sheet_get_cell:cu,book_new:Qv,book_append_sheet:Jv,book_set_sheet_visibility:v7,cell_set_number_format:x7,cell_set_hyperlink:dI,cell_set_internal_link:_7,cell_add_comment:y7,sheet_set_array_formula:w7,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};const T7=()=>{var Se;const t=Wa(),{currentUser:e,userProfile:r}=hs(),[n,i]=Z.useState("tmdb"),[s,a]=Z.useState(!1),[o,l]=Z.useState(null),[c,u]=Z.useState(null),[h,d]=Z.useState(""),[p,x]=Z.useState([]),[v,E]=Z.useState(null),[T,w]=Z.useState(""),[y,R]=Z.useState(null),[M,j]=Z.useState([]),[g,k]=Z.useState(0),[S,C]=Z.useState(0);Z.useEffect(()=>{r!=null&&r.tmdbApiKey&&w(r.tmdbApiKey)},[r]);const F=async()=>{if(!(!h.trim()||!T))try{a(!0),l(null),E(null);const oe=await ky(h,T);x(oe.results)}catch(oe){console.error("Search error:",oe),l(oe.message||"Failed to search movies")}finally{a(!1)}},P=async oe=>{try{a(!0),l(null);const ie=await Sy(oe.id,T);E(ie)}catch(ie){console.error("Error fetching movie details:",ie),l(ie.message||"Failed to fetch movie details")}finally{a(!1)}},b=async()=>{if(!(!e||!v))try{a(!0),l(null);const oe=Mh(yn,"movies"),ie=gm(oe,dy("tmdbId","==",v.id)),G=await Uh(ie);let ue;if(G.empty){const Ee={...Ay(v),addedAt:new Date,updatedAt:new Date};ue=(await gy(oe,Ee)).id}else ue=G.docs[0].id;if(await xm(e.uid,ue,{userId:e.uid,movieId:ue,watched:!1,favorite:!1}),u("Movie added to your collection!"),E(null),x([]),d(""),T&&T!==(r==null?void 0:r.tmdbApiKey)){const Ee=Ii(yn,"users",e.uid);await jh(Ee,{tmdbApiKey:T},{merge:!0})}setTimeout(()=>{t(`/movies/${ue}`)},1500)}catch(oe){console.error("Error adding movie:",oe),l(oe.message||"Failed to add movie to collection")}finally{a(!1)}},ve=oe=>{var ue;const ie=(ue=oe.target.files)==null?void 0:ue[0];if(!ie)return;R(ie);const G=new FileReader;G.onload=Ee=>{var B;try{const X=(B=Ee.target)==null?void 0:B.result,K=Cm(X,{type:"binary"}),W=K.SheetNames[0],ae=K.Sheets[W],ke=E7.sheet_to_json(ae).map(fe=>({title:fe.title||fe.Title||fe.name||fe.Name||"",releaseDate:fe.releaseDate||fe.ReleaseDate||fe.release_date||fe.year||fe.Year||"",watched:fe.watched||fe.Watched||!1,rating:fe.rating||fe.Rating||null,review:fe.review||fe.Review||fe.notes||fe.Notes||""})).filter(fe=>fe.title);j(ke),C(ke.length)}catch(X){console.error("Error parsing Excel file:",X),l("Failed to parse Excel file. Please check the format.")}},G.onerror=()=>{l("Failed to read Excel file")},G.readAsBinaryString(ie)},he=async()=>{if(!e||!M.length||!T){T||l("TMDB API key is required for Excel import to match movies");return}try{a(!0),l(null),k(0);const oe=Mh(yn,"movies");let ie=0,G=0,ue=0;for(const B of M){try{const X=`${B.title} ${B.releaseDate||""}`,K=await ky(X.trim(),T);if(K.results.length===0){console.warn(`No TMDB match found for: ${B.title}`),G++;continue}const W=K.results[0],ae=await Sy(W.id,T),xe=gm(oe,dy("tmdbId","==",ae.id)),ke=await Uh(xe);let fe;if(ke.empty){const pe={...Ay(ae),addedAt:new Date,updatedAt:new Date};fe=(await gy(oe,pe)).id}else fe=ke.docs[0].id;await xm(e.uid,fe,{userId:e.uid,movieId:fe,watched:B.watched||!1,rating:B.rating||null,review:B.review||"",favorite:!1}),ie++}catch(X){console.error(`Error importing movie ${B.title}:`,X),ue++}k(Math.round((ie+G+ue)/M.length*100))}const Ee=`Import complete: ${ie} movies imported, ${G} skipped, ${ue} errors.`;u(Ee),j([]),R(null),setTimeout(()=>{t("/movies")},2e3)}catch(oe){console.error("Error importing movies:",oe),l(oe.message||"Failed to import movies")}finally{a(!1)}};return m.jsxs("div",{className:"container mx-auto px-4 py-8",children:[m.jsxs("div",{className:"flex justify-between items-center mb-6",children:[m.jsxs(Qe,{to:"/movies",className:"btn btn-ghost",children:[m.jsx("i",{className:"fas fa-arrow-left mr-2"})," Back to Movies"]}),m.jsxs(Qe,{to:"/profile",className:"btn btn-outline btn-primary",children:[m.jsx("i",{className:"fas fa-user-cog mr-2"})," Profile Settings"]})]}),m.jsx("h1",{className:"font-christmas text-3xl md:text-4xl text-xmas-line mb-6",children:"Import Movies"}),o&&m.jsxs("div",{className:"alert alert-error mb-6",children:[m.jsx("i",{className:"fas fa-exclamation-circle mr-2"}),m.jsx("span",{children:o})]}),c&&m.jsxs("div",{className:"alert alert-success mb-6",children:[m.jsx("i",{className:"fas fa-check-circle mr-2"}),m.jsx("span",{children:c})]}),m.jsxs("div",{className:"tabs tabs-boxed mb-6",children:[m.jsxs("button",{className:`tab ${n==="tmdb"?"tab-active":""}`,onClick:()=>i("tmdb"),children:[m.jsx("i",{className:"fas fa-search mr-2"})," Search TMDB"]}),m.jsxs("button",{className:`tab ${n==="excel"?"tab-active":""}`,onClick:()=>i("excel"),children:[m.jsx("i",{className:"fas fa-file-excel mr-2"})," Import from Excel"]})]}),n==="tmdb"&&m.jsxs("div",{className:"bg-xmas-card p-6 rounded-lg shadow-lg",children:[T?null:m.jsxs("div",{className:"alert alert-warning mb-6",children:[m.jsx("i",{className:"fas fa-exclamation-triangle mr-2"}),m.jsxs("div",{className:"flex-1",children:[m.jsx("h3",{className:"font-bold",children:"TMDB API Key Required"}),m.jsx("p",{className:"text-sm",children:"You need to set your TMDB API key in your profile settings to search for movies."})]}),m.jsxs(Qe,{to:"/profile",className:"btn btn-sm btn-primary",children:[m.jsx("i",{className:"fas fa-user-cog mr-2"})," Set API Key"]})]}),m.jsxs("div",{className:"flex gap-2 mb-6",children:[m.jsx("input",{type:"text",className:"input input-bordered flex-1",placeholder:"Search for a Christmas movie...",value:h,onChange:oe=>d(oe.target.value),onKeyDown:oe=>oe.key==="Enter"&&F()}),m.jsx("button",{className:"btn btn-primary",onClick:F,disabled:s||!T,children:s?m.jsx("span",{className:"loading loading-spinner loading-sm"}):m.jsx("i",{className:"fas fa-search"})})]}),p.length>0&&!v&&m.jsxs("div",{className:"mb-6",children:[m.jsx("h2",{className:"text-xl font-bold mb-4",children:"Search Results"}),m.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-4",children:p.map(oe=>{var ie;return m.jsxs("div",{className:"card bg-base-100 shadow-xl cursor-pointer hover:shadow-2xl transition-shadow",onClick:()=>P(oe),children:[m.jsx("figure",{className:"h-48",children:oe.poster_path?m.jsx("img",{src:`https://image.tmdb.org/t/p/w500${oe.poster_path}`,alt:oe.title,className:"w-full h-full object-cover"}):m.jsx("div",{className:"w-full h-full flex items-center justify-center bg-gray-800",children:m.jsx("i",{className:"fas fa-film text-4xl text-gray-500"})})}),m.jsxs("div",{className:"card-body p-4",children:[m.jsx("h3",{className:"card-title text-lg",children:oe.title}),m.jsx("p",{className:"text-sm text-gray-400",children:(ie=oe.release_date)==null?void 0:ie.substring(0,4)})]})]},oe.id)})})]}),v&&m.jsxs("div",{className:"mb-6",children:[m.jsx("h2",{className:"text-xl font-bold mb-4",children:"Selected Movie"}),m.jsxs("div",{className:"flex flex-col md:flex-row gap-6",children:[m.jsx("div",{className:"md:w-1/3",children:v.poster_path?m.jsx("img",{src:`https://image.tmdb.org/t/p/w500${v.poster_path}`,alt:v.title,className:"w-full rounded-lg shadow-lg"}):m.jsx("div",{className:"w-full h-96 flex items-center justify-center bg-gray-800 rounded-lg",children:m.jsx("i",{className:"fas fa-film text-6xl text-gray-500"})})}),m.jsxs("div",{className:"md:w-2/3",children:[m.jsx("h3",{className:"text-2xl font-bold mb-2",children:v.title}),m.jsx("p",{className:"text-gray-400 mb-4",children:(Se=v.release_date)==null?void 0:Se.substring(0,4)}),v.genres&&m.jsx("div",{className:"flex flex-wrap gap-2 mb-4",children:v.genres.map(oe=>m.jsx("span",{className:"badge badge-outline",children:oe.name},oe.id))}),m.jsx("p",{className:"mb-6",children:v.overview}),m.jsx("button",{className:"btn btn-primary",onClick:b,disabled:s,children:s?m.jsxs(m.Fragment,{children:[m.jsx("span",{className:"loading loading-spinner loading-sm mr-2"}),"Adding..."]}):m.jsxs(m.Fragment,{children:[m.jsx("i",{className:"fas fa-plus mr-2"}),"Add to Collection"]})}),m.jsx("button",{className:"btn btn-ghost ml-2",onClick:()=>E(null),disabled:s,children:"Cancel"})]})]})]})]}),n==="excel"&&m.jsxs("div",{className:"bg-xmas-card p-6 rounded-lg shadow-lg",children:[T?null:m.jsxs("div",{className:"alert alert-warning mb-6",children:[m.jsx("i",{className:"fas fa-exclamation-triangle mr-2"}),m.jsxs("div",{className:"flex-1",children:[m.jsx("h3",{className:"font-bold",children:"TMDB API Key Required"}),m.jsx("p",{className:"text-sm",children:"You need to set your TMDB API key in your profile settings to import movies from Excel."})]}),m.jsxs(Qe,{to:"/profile",className:"btn btn-sm btn-primary",children:[m.jsx("i",{className:"fas fa-user-cog mr-2"})," Set API Key"]})]}),m.jsxs("div",{className:"mb-6",children:[m.jsx("h2",{className:"text-xl font-bold mb-4",children:"Import from Excel"}),m.jsx("p",{className:"mb-4",children:"Upload an Excel file with your Christmas movie list. The file should have columns for:"}),m.jsxs("ul",{className:"list-disc pl-6 mb-4",children:[m.jsx("li",{children:"Title (required)"}),m.jsx("li",{children:"Release Date/Year (optional)"}),m.jsx("li",{children:"Watched (optional, true/false)"}),m.jsx("li",{children:"Rating (optional, 1-10)"}),m.jsx("li",{children:"Review/Notes (optional)"})]})]}),m.jsx("div",{className:"mb-6",children:m.jsx("input",{type:"file",className:"file-input file-input-bordered w-full",accept:".xlsx,.xls",onChange:ve,disabled:s})}),M.length>0&&m.jsxs("div",{className:"mb-6",children:[m.jsxs("h3",{className:"text-lg font-bold mb-2",children:["Preview (",M.length," movies found)"]}),m.jsx("div",{className:"overflow-x-auto",children:m.jsxs("table",{className:"table table-zebra w-full",children:[m.jsx("thead",{children:m.jsxs("tr",{children:[m.jsx("th",{children:"Title"}),m.jsx("th",{children:"Year"}),m.jsx("th",{children:"Watched"}),m.jsx("th",{children:"Rating"})]})}),m.jsxs("tbody",{children:[M.slice(0,10).map((oe,ie)=>m.jsxs("tr",{children:[m.jsx("td",{children:oe.title}),m.jsx("td",{children:oe.releaseDate}),m.jsx("td",{children:oe.watched?"Yes":"No"}),m.jsx("td",{children:oe.rating||"-"})]},ie)),M.length>10&&m.jsx("tr",{children:m.jsxs("td",{colSpan:4,className:"text-center",children:["...and ",M.length-10," more"]})})]})]})}),g>0&&m.jsxs("div",{className:"mt-4",children:[m.jsx("progress",{className:"progress progress-primary w-full",value:g,max:"100"}),m.jsxs("p",{className:"text-center mt-2",children:[g,"% complete"]})]}),m.jsx("div",{className:"mt-6 flex justify-end",children:m.jsx("button",{className:"btn btn-primary",onClick:he,disabled:s||!T,children:s?m.jsxs(m.Fragment,{children:[m.jsx("span",{className:"loading loading-spinner loading-sm mr-2"}),"Importing..."]}):m.jsxs(m.Fragment,{children:[m.jsx("i",{className:"fas fa-file-import mr-2"}),"Import ",M.length," Movies"]})})})]})]})]})},k7=()=>{var E,T,w;const{currentUser:t}=hs(),[e,r]=Z.useState([]),[n,i]=Z.useState({}),[s,a]=Z.useState(!0),[o,l]=Z.useState(null),[c,u]=Z.useState(null),[h,d]=Z.useState(!1),[p,x]=Z.useState(!1);Z.useEffect(()=>{(async()=>{if(t)try{a(!0);const{userMovies:R,movies:M}=await Sv(t.uid);i(R),r(M)}catch(R){console.error("Error fetching movies:",R),l("Failed to load movies")}finally{a(!1)}})()},[t]);const v=()=>{if(e.length===0)return;x(!0),u(null);const y=e.filter(g=>{const k=n[g.id];return h||!k||!k.watched});if(y.length===0){l("No eligible movies found. Try including watched movies."),x(!1);return}let R=0;const M=20,j=setInterval(()=>{const g=Math.floor(Math.random()*y.length);u(y[g]),R++,R>=M&&(clearInterval(j),x(!1))},100)};return s?m.jsx("div",{className:"flex justify-center items-center min-h-[60vh]",children:m.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-xmas-gold"})}):m.jsxs("div",{className:"container mx-auto px-4 py-8",children:[m.jsx("div",{className:"mb-4",children:m.jsxs(Qe,{to:"/movies",className:"btn btn-ghost",children:[m.jsx("i",{className:"fas fa-arrow-left mr-2"})," Back to Movies"]})}),m.jsx("h1",{className:"font-christmas text-3xl md:text-4xl text-xmas-line mb-6",children:"Christmas Movie Picker"}),o&&m.jsxs("div",{className:"alert alert-error mb-6",children:[m.jsx("i",{className:"fas fa-exclamation-circle mr-2"}),m.jsx("span",{children:o})]}),e.length===0?m.jsxs("div",{className:"bg-xmas-card p-8 rounded-lg text-center",children:[m.jsx("h3",{className:"text-xl mb-4",children:"No movies in your collection"}),m.jsx("p",{className:"mb-4",children:"Add some Christmas movies to use the random movie picker!"}),m.jsxs(Qe,{to:"/import",className:"btn btn-primary",children:[m.jsx("i",{className:"fas fa-file-import mr-2"})," Import Movies"]})]}):m.jsxs("div",{className:"bg-xmas-card p-8 rounded-lg shadow-lg",children:[m.jsxs("div",{className:"text-center mb-6",children:[m.jsx("p",{className:"mb-4",children:"Can't decide what Christmas movie to watch? Let us pick one for you!"}),m.jsx("div",{className:"form-control mb-6",children:m.jsxs("label",{className:"label cursor-pointer justify-center",children:[m.jsx("span",{className:"label-text mr-2",children:"Include watched movies"}),m.jsx("input",{type:"checkbox",className:"toggle toggle-primary",checked:h,onChange:()=>d(!h)})]})}),m.jsx("button",{className:"btn btn-primary btn-lg",onClick:v,disabled:p,children:p?m.jsxs(m.Fragment,{children:[m.jsx("span",{className:"loading loading-spinner loading-md mr-2"}),"Picking a movie..."]}):m.jsxs(m.Fragment,{children:[m.jsx("i",{className:"fas fa-random mr-2"}),"Pick a Random Movie"]})})]}),c&&m.jsx("div",{className:"mt-8 flex flex-col items-center",children:m.jsx("div",{className:"w-full max-w-md",children:m.jsxs("div",{className:"card bg-base-100 shadow-xl overflow-hidden",children:[m.jsxs("figure",{className:"relative",children:[c.posterUrl?m.jsx("img",{src:c.posterUrl,alt:c.title,className:"w-full object-contain",style:{aspectRatio:"2/3",maxHeight:"500px"}}):m.jsx("div",{className:"w-full flex items-center justify-center bg-gray-800",style:{aspectRatio:"2/3",maxHeight:"500px"},children:m.jsx("i",{className:"fas fa-film text-6xl text-gray-500"})}),((E=n[c.id])==null?void 0:E.watched)&&m.jsx("div",{className:"absolute top-4 left-4 badge badge-lg badge-success",children:"Already Watched"}),((T=n[c.id])==null?void 0:T.rating)&&m.jsxs("div",{className:"absolute top-4 right-4 badge badge-lg badge-warning",children:[m.jsx("i",{className:"fas fa-star mr-1"}),n[c.id].rating,"/10"]})]}),m.jsxs("div",{className:"card-body",children:[m.jsx("h2",{className:"card-title text-2xl font-christmas",children:c.title}),m.jsx("p",{className:"text-gray-400",children:(w=c.releaseDate)==null?void 0:w.substring(0,4)}),c.overview&&m.jsx("p",{className:"mt-2",children:c.overview}),m.jsxs("div",{className:"card-actions justify-end mt-4",children:[m.jsx(Qe,{to:`/movies/${c.id}`,className:"btn btn-primary",children:"View Details"}),m.jsx("button",{className:"btn btn-outline",onClick:v,disabled:p,children:"Pick Another"})]})]})]})})})]})]})},S7=(t,e)=>{const r=["Title","TMDB ID","Release Year","Watched","Watched Date","Rating","Review","Favorite","Date Added"].join(","),n=t.map(i=>{const s=e[i.id];if(!s)return null;const a=i.releaseDate?i.releaseDate.substring(0,4):"",o=s.watchedDate?Nm(s.watchedDate):"",l=s.addedAt?Nm(s.addedAt):"",c=Nw(i.title),u=s.review?Nw(s.review):"";return[c,i.tmdbId||"",a,s.watched?"Yes":"No",o,s.rating!==null&&s.rating!==void 0?s.rating:"",u,s.favorite?"Yes":"No",l].join(",")}).filter(Boolean);return[r,...n].join(`
`)},Nm=t=>{if(!(t instanceof Date))try{t&&typeof t.toDate=="function"?t=t.toDate():t=new Date(t)}catch{return""}return t.toISOString().split("T")[0]},Nw=t=>t?t.includes(",")||t.includes('"')||t.includes(`
`)?`"${t.replace(/"/g,'""')}"`:t:"",A7=(t,e,r)=>{const n=document.createElement("a"),i=new Blob([t],{type:r});n.href=URL.createObjectURL(i),n.download=e,n.click(),URL.revokeObjectURL(n.href)},I7=async(t,e,r)=>{const n=S7(t,e),i=`${r.replace(/\s+/g,"_")}_christmas_movies_${Nm(new Date)}.csv`;A7(n,i,"text/csv;charset=utf-8;")},C7=()=>{const{currentUser:t,userProfile:e,signOut:r}=hs(),[n,i]=Z.useState(""),[s,a]=Z.useState(!1),[o,l]=Z.useState(!1),[c,u]=Z.useState(null),[h,d]=Z.useState(null),[p,x]=Z.useState({totalMovies:0,watchedMovies:0,unwatchedMovies:0,averageRating:0,favoriteMovies:0});Z.useEffect(()=>{e!=null&&e.tmdbApiKey&&i(e.tmdbApiKey),(async()=>{if(t)try{const y=await FS(t.uid),R=y.length,M=y.filter(C=>C.watched).length,j=R-M,g=y.filter(C=>C.favorite).length,k=y.filter(C=>C.rating!==void 0&&C.rating!==null),S=k.length>0?k.reduce((C,F)=>C+(F.rating||0),0)/k.length:0;x({totalMovies:R,watchedMovies:M,unwatchedMovies:j,averageRating:S,favoriteMovies:g})}catch(y){console.error("Error fetching user stats:",y)}})()},[t,e]);const v=async()=>{if(t)try{a(!0),u(null);const w=Ii(yn,"users",t.uid);await SS(w,{tmdbApiKey:n}),d("TMDB API key saved successfully!"),setTimeout(()=>{d(null)},3e3)}catch(w){console.error("Error saving API key:",w),u(w.message||"Failed to save API key")}finally{a(!1)}},E=async()=>{try{await r()}catch(w){console.error("Error signing out:",w)}},T=async()=>{if(t)try{l(!0),u(null);const{userMovies:w,movies:y}=await Sv(t.uid);await I7(y,w,e.displayName||"User"),d("Movies exported successfully!"),setTimeout(()=>{d(null)},3e3)}catch(w){console.error("Error exporting movies:",w),u(w.message||"Failed to export movies")}finally{l(!1)}};return!t||!e?m.jsx("div",{className:"flex justify-center items-center min-h-[60vh]",children:m.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-xmas-gold"})}):m.jsxs("div",{className:"container mx-auto px-4 py-8",children:[m.jsx("h1",{className:"font-christmas text-3xl md:text-4xl text-xmas-line mb-6",children:"Your Profile"}),c&&m.jsxs("div",{className:"alert alert-error mb-6",children:[m.jsx("i",{className:"fas fa-exclamation-circle mr-2"}),m.jsx("span",{children:c})]}),h&&m.jsxs("div",{className:"alert alert-success mb-6",children:[m.jsx("i",{className:"fas fa-check-circle mr-2"}),m.jsx("span",{children:h})]}),m.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-8",children:[m.jsx("div",{className:"md:col-span-1",children:m.jsxs("div",{className:"bg-xmas-card p-6 rounded-lg shadow-lg",children:[m.jsxs("div",{className:"flex flex-col items-center mb-6",children:[e.photoURL?m.jsx("img",{src:e.photoURL,alt:e.displayName,className:"w-24 h-24 rounded-full mb-4"}):m.jsx("div",{className:"w-24 h-24 rounded-full bg-gray-700 flex items-center justify-center mb-4",children:m.jsx("i",{className:"fas fa-user text-4xl text-gray-400"})}),m.jsx("h2",{className:"text-xl font-bold",children:e.displayName}),m.jsx("p",{className:"text-gray-400",children:e.email})]}),m.jsx("div",{className:"divider"}),m.jsxs("div",{className:"mb-6",children:[m.jsx("h3",{className:"text-lg font-bold mb-2",children:"Your Stats"}),m.jsxs("ul",{className:"space-y-2",children:[m.jsxs("li",{className:"flex justify-between",children:[m.jsx("span",{children:"Total Movies:"}),m.jsx("span",{className:"font-bold",children:p.totalMovies})]}),m.jsxs("li",{className:"flex justify-between",children:[m.jsx("span",{children:"Watched:"}),m.jsx("span",{className:"font-bold",children:p.watchedMovies})]}),m.jsxs("li",{className:"flex justify-between",children:[m.jsx("span",{children:"Unwatched:"}),m.jsx("span",{className:"font-bold",children:p.unwatchedMovies})]}),m.jsxs("li",{className:"flex justify-between",children:[m.jsx("span",{children:"Favorites:"}),m.jsx("span",{className:"font-bold",children:p.favoriteMovies})]}),m.jsxs("li",{className:"flex justify-between",children:[m.jsx("span",{children:"Average Rating:"}),m.jsxs("span",{className:"font-bold",children:[p.averageRating.toFixed(1),"/10"]})]})]})]}),m.jsx("div",{className:"divider"}),m.jsxs("div",{className:"mt-6 space-y-3",children:[m.jsxs("button",{className:"btn btn-outline btn-primary w-full",onClick:T,disabled:o||p.totalMovies===0,children:[o?m.jsx("span",{className:"loading loading-spinner loading-sm mr-2"}):m.jsx("i",{className:"fas fa-file-export mr-2"}),"Export Movie Data"]}),m.jsxs("button",{className:"btn btn-outline btn-error w-full",onClick:E,children:[m.jsx("i",{className:"fas fa-sign-out-alt mr-2"}),"Sign Out"]})]})]})}),m.jsx("div",{className:"md:col-span-2",children:m.jsxs("div",{className:"bg-xmas-card p-6 rounded-lg shadow-lg",children:[m.jsx("h2",{className:"text-2xl font-bold mb-4",children:"Settings"}),m.jsxs("div",{className:"mb-6",children:[m.jsx("h3",{className:"text-lg font-bold mb-2",children:"TMDB API Key"}),m.jsxs("p",{className:"mb-4",children:["Your TMDB API key is used to search for movies and fetch movie details. If you don't have one, you can get it for free from ",m.jsx("a",{href:"https://www.themoviedb.org/settings/api",target:"_blank",rel:"noopener noreferrer",className:"link link-primary",children:"The Movie Database"}),"."]}),m.jsxs("div",{className:"form-control",children:[m.jsx("label",{className:"label",children:m.jsx("span",{className:"label-text",children:"API Key"})}),m.jsxs("div",{className:"flex gap-2",children:[m.jsx("input",{type:"text",className:"input input-bordered flex-1",value:n,onChange:w=>i(w.target.value),placeholder:"Enter your TMDB API key"}),m.jsx("button",{className:"btn btn-primary",onClick:v,disabled:s,children:s?m.jsx("span",{className:"loading loading-spinner loading-sm"}):m.jsx("i",{className:"fas fa-save"})})]})]})]}),m.jsx("div",{className:"divider"}),m.jsxs("div",{className:"mb-6",children:[m.jsx("h3",{className:"text-lg font-bold mb-2",children:"Quick Links"}),m.jsxs("div",{className:"flex flex-wrap gap-2",children:[m.jsxs(Qe,{to:"/movies",className:"btn btn-outline btn-sm",children:[m.jsx("i",{className:"fas fa-film mr-2"}),"My Movies"]}),m.jsxs(Qe,{to:"/import",className:"btn btn-outline btn-sm",children:[m.jsx("i",{className:"fas fa-file-import mr-2"}),"Import Movies"]}),m.jsxs(Qe,{to:"/random",className:"btn btn-outline btn-sm",children:[m.jsx("i",{className:"fas fa-random mr-2"}),"Random Movie Picker"]})]})]})]})})]})]})},pI=()=>{const[t,e]=Z.useState(!1),[r,n]=Z.useState(!0),[i,s]=Z.useState(null),[a,o]=Z.useState(null);return Z.useEffect(()=>{const l=zT(gc,async c=>{if(n(!0),s(null),!c){e(!1),o(null),n(!1);return}o({uid:c.uid,email:c.email});try{if((await IT(c)).claims.admin===!0){e(!0),n(!1);return}const d=Ii(yn,"admins",c.uid),p=await Va(d);e(p.exists())}catch(u){console.error("Error checking admin status:",u),s("Failed to verify admin status"),e(!1)}finally{n(!1)}});return()=>l()},[]),{isAdmin:t,loading:r,error:i,currentUser:a}},R7=()=>{const t=Wa(),{isAdmin:e,loading:r,currentUser:n}=pI(),[i,s]=Z.useState(!1),[a,o]=Z.useState(null),l=!1;Z.useEffect(()=>{e&&!r&&t("/admin")},[e,r,t]);const c=async()=>{o(null),s(!0);try{await ZT(gc,lL)}catch(u){console.error("Login error:",u),u.code==="auth/popup-closed-by-user"?o("Sign-in popup was closed. Please try again."):u.code==="auth/cancelled-popup-request"?o("Another popup is already open. Please try again."):u.code==="auth/unauthorized-domain"?(console.error("Unauthorized domain error:",window.location.hostname),o("This domain is not authorized for OAuth operations. Please add "+window.location.hostname+" to your Firebase authorized domains list in the Firebase console under Authentication > Sign-in method > Authorized domains.")):o("Failed to sign in. Please try again."),s(!1)}};return r?m.jsx("div",{className:"flex justify-center items-center min-h-[60vh]",children:m.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-xmas-gold"})}):m.jsx("div",{className:"container mx-auto px-4 py-12",children:m.jsxs("div",{className:"max-w-md mx-auto",children:[m.jsxs("div",{className:"text-center mb-8",children:[m.jsx("h1",{className:"font-christmas text-4xl text-xmas-line mb-2",children:"Admin Login"}),m.jsx("p",{className:"text-xmas-mute",children:"Sign in to manage the Christmas Quiz"})]}),m.jsxs("div",{className:"bg-xmas-card rounded-lg shadow-lg p-6",children:[l,n&&m.jsxs("div",{className:"bg-info bg-opacity-10 border-l-4 border-info p-4 mb-6 rounded",children:[m.jsx("p",{className:"text-info font-bold mb-2",children:"User Authenticated"}),m.jsxs("p",{className:"text-info text-sm mb-1",children:["Email: ",n.email]}),m.jsxs("p",{className:"text-info text-sm mb-2",children:["UID: ",n.uid]}),m.jsxs("p",{className:"text-info text-sm",children:["To grant admin access, create a document in the ",m.jsx("code",{className:"bg-base-300 px-1 py-0.5 rounded",children:"admins"})," collection with this UID as the document ID."]}),l]}),a&&m.jsx("div",{className:"bg-error bg-opacity-10 border-l-4 border-error p-4 mb-6 rounded",children:m.jsx("p",{className:"text-error",children:a})}),m.jsxs("div",{className:"text-center mb-6",children:[m.jsx("p",{className:"mb-4",children:"Sign in with your Google account to access the admin panel."}),m.jsx("p",{className:"text-sm text-xmas-mute mb-6",children:"Only authorized administrators will be granted access."}),m.jsx("button",{onClick:c,className:"btn btn-primary w-full flex items-center justify-center gap-2",disabled:i,children:i?m.jsxs(m.Fragment,{children:[m.jsx("span",{className:"loading loading-spinner loading-sm"}),"Signing in..."]}):m.jsxs(m.Fragment,{children:[m.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 48 48",children:[m.jsx("path",{fill:"#FFC107",d:`M43.611,20.083H42V20H24v8h11.303c-1.649,4.657-6.08,8-11.303,8c-6.627,0-12-5.373-12-12
                      s5.373-12,12-12c3.059,0,5.842,1.154,7.961,3.039l5.657-5.657C34.046,6.053,29.268,4,24,4C12.955,4,4,12.955,4,24s8.955,20,20,20
                      s20-8.955,20-20C44,22.659,43.862,21.35,43.611,20.083z`}),m.jsx("path",{fill:"#FF3D00",d:`M6.306,14.691l6.571,4.819C14.655,15.108,18.961,12,24,12c3.059,0,5.842,1.154,7.961,3.039
                      l5.657-5.657C34.046,6.053,29.268,4,24,4C16.318,4,9.656,8.337,6.306,14.691z`}),m.jsx("path",{fill:"#4CAF50",d:`M24,44c5.166,0,9.86-1.977,13.409-5.192l-6.19-5.238C29.211,35.091,26.715,36,24,36
                      c-5.202,0-9.619-3.317-11.283-7.946l-6.522,5.025C9.505,39.556,16.227,44,24,44z`}),m.jsx("path",{fill:"#1976D2",d:`M43.611,20.083H42V20H24v8h11.303c-0.792,2.237-2.231,4.166-4.087,5.571
                      c0.001-0.001,0.002-0.001,0.003-0.002l6.19,5.238C36.971,39.205,44,34,44,24C44,22.659,43.862,21.35,43.611,20.083z`})]}),"Sign in with Google"]})})]})]}),m.jsx("div",{className:"text-center mt-6",children:m.jsx("button",{onClick:()=>t("/"),className:"btn btn-link text-xmas-mute",children:"Back to Home"})})]})})};var tc=(t=>(t.GENERAL="general",t.PICTURE="picture",t.MUSIC="music",t.TRIVIA="trivia",t.CHRISTMAS="christmas",t))(tc||{});const N7=()=>{const t=Wa(),{isAdmin:e,loading:r}=pI(),[n,i]=Z.useState([]),[s,a]=Z.useState(!0),[o,l]=Z.useState(null);Z.useEffect(()=>{!r&&!e&&t("/admin/login")},[e,r,t]),Z.useEffect(()=>{e&&(async()=>{if(e){a(!0);try{const h=await Uh(gm(Mh(yn,"rounds"),p6("order","asc"))),d=[];h.forEach(p=>{const x=p.data();d.push({id:p.id,...x})}),i(d)}catch(h){console.error("Error fetching rounds:",h),l("Failed to load rounds")}finally{a(!1)}}})()},[e]);const c=u=>{switch(u){case tc.PICTURE:return m.jsx("i",{className:"fas fa-image text-info"});case tc.MUSIC:return m.jsx("i",{className:"fas fa-music text-success"});case tc.TRIVIA:return m.jsx("i",{className:"fas fa-lightbulb text-warning"});case tc.CHRISTMAS:return m.jsx("i",{className:"fas fa-holly-berry text-error"});default:return m.jsx("i",{className:"fas fa-question-circle text-primary"})}};return r||s?m.jsx("div",{className:"flex justify-center items-center min-h-[60vh]",children:m.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-xmas-gold"})}):m.jsxs("div",{className:"container mx-auto px-4 py-8",children:[m.jsxs("div",{className:"flex justify-between items-center mb-8",children:[m.jsx("h1",{className:"font-christmas text-3xl md:text-4xl text-xmas-line",children:"Admin Dashboard"}),m.jsx("div",{className:"flex gap-2",children:m.jsxs(Qe,{to:"/admin/results",className:"btn btn-outline",children:[m.jsx("i",{className:"fas fa-trophy mr-2"})," View Results"]})})]}),o&&m.jsxs("div",{className:"alert alert-error mb-6",children:[m.jsx("i",{className:"fas fa-exclamation-circle mr-2"}),m.jsx("span",{children:o})]}),m.jsxs("div",{className:"mb-8",children:[m.jsx("h2",{className:"text-2xl font-christmas mb-4 text-xmas-gold",children:"Quiz Rounds"}),n.length===0?m.jsxs("div",{className:"bg-xmas-card p-8 rounded-lg text-center",children:[m.jsx("h3",{className:"text-xl mb-4",children:"No rounds yet"}),m.jsx("p",{className:"mb-4",children:"Start by adding your first quiz round!"}),m.jsxs(Qe,{to:"/admin/rounds",className:"btn btn-primary",children:[m.jsx("i",{className:"fas fa-plus mr-2"})," Add Round"]})]}):m.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[n.map(u=>m.jsx("div",{className:"card bg-xmas-card shadow-xl",children:m.jsxs("div",{className:"card-body",children:[m.jsxs("div",{className:"flex justify-between items-center",children:[m.jsxs("h2",{className:"card-title font-christmas",children:[c(u.type)," ",u.title]}),m.jsxs("div",{className:"badge badge-outline",children:["#",u.order]})]}),m.jsx("p",{className:"text-sm mb-4",children:u.description}),m.jsx("div",{className:"card-actions justify-end",children:m.jsxs(Qe,{to:`/admin/questions/${u.id}`,className:"btn btn-primary btn-sm",children:[m.jsx("i",{className:"fas fa-list mr-1"})," Manage Questions"]})})]})},u.id)),m.jsx("div",{className:"card bg-base-100 border-2 border-dashed border-base-300 shadow-xl flex items-center justify-center",children:m.jsxs("div",{className:"card-body items-center text-center",children:[m.jsx("h2",{className:"card-title font-christmas",children:"Add New Round"}),m.jsx("p",{children:"Create a new quiz round"}),m.jsx("div",{className:"card-actions justify-center mt-4",children:m.jsxs(Qe,{to:"/admin/rounds",className:"btn btn-primary",children:[m.jsx("i",{className:"fas fa-plus mr-2"})," Add Round"]})})]})})]})]})]})},P7=CN([{element:m.jsx(fL,{}),children:[{path:"/",element:m.jsx(dL,{})},{path:"/login",element:m.jsx(pL,{})},{element:m.jsx(hL,{}),children:[{path:"/movies",element:m.jsx(vL,{})},{path:"/movies/:movieId",element:m.jsx(xL,{})},{path:"/import",element:m.jsx(T7,{})},{path:"/random",element:m.jsx(k7,{})},{path:"/profile",element:m.jsx(C7,{})}]},{path:"/admin/login",element:m.jsx(R7,{})},{path:"/admin",element:m.jsx(N7,{})}]}]);Xd.createRoot(document.getElementById("root")).render(m.jsx($w.StrictMode,{children:m.jsx(cL,{children:m.jsx(LN,{router:P7})})}));
