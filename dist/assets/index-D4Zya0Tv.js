function fb(t,e){for(var r=0;r<e.length;r++){const n=e[r];if(typeof n!="string"&&!Array.isArray(n)){for(const a in n)if(a!=="default"&&!(a in t)){const l=Object.getOwnPropertyDescriptor(n,a);l&&Object.defineProperty(t,a,l.get?l:{enumerable:!0,get:()=>n[a]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))n(a);new MutationObserver(a=>{for(const l of a)if(l.type==="childList")for(const o of l.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&n(o)}).observe(document,{childList:!0,subtree:!0});function r(a){const l={};return a.integrity&&(l.integrity=a.integrity),a.referrerPolicy&&(l.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?l.credentials="include":a.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function n(a){if(a.ep)return;a.ep=!0;const l=r(a);fetch(a.href,l)}})();function Xx(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var Sg={exports:{}},Wu={};var a2;function Rk(){if(a2)return Wu;a2=1;var t=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function r(n,a,l){var o=null;if(l!==void 0&&(o=""+l),a.key!==void 0&&(o=""+a.key),"key"in a){l={};for(var u in a)u!=="key"&&(l[u]=a[u])}else l=a;return a=l.ref,{$$typeof:t,type:n,key:o,ref:a!==void 0?a:null,props:l}}return Wu.Fragment=e,Wu.jsx=r,Wu.jsxs=r,Wu}var s2;function Dk(){return s2||(s2=1,Sg.exports=Rk()),Sg.exports}var d=Dk(),Ag={exports:{}},ft={};var i2;function Ik(){if(i2)return ft;i2=1;var t=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),r=Symbol.for("react.fragment"),n=Symbol.for("react.strict_mode"),a=Symbol.for("react.profiler"),l=Symbol.for("react.consumer"),o=Symbol.for("react.context"),u=Symbol.for("react.forward_ref"),h=Symbol.for("react.suspense"),m=Symbol.for("react.memo"),p=Symbol.for("react.lazy"),v=Symbol.for("react.activity"),_=Symbol.iterator;function w(Q){return Q===null||typeof Q!="object"?null:(Q=_&&Q[_]||Q["@@iterator"],typeof Q=="function"?Q:null)}var E={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},T=Object.assign,A={};function M(Q,I,Z){this.props=Q,this.context=I,this.refs=A,this.updater=Z||E}M.prototype.isReactComponent={},M.prototype.setState=function(Q,I){if(typeof Q!="object"&&typeof Q!="function"&&Q!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,Q,I,"setState")},M.prototype.forceUpdate=function(Q){this.updater.enqueueForceUpdate(this,Q,"forceUpdate")};function F(){}F.prototype=M.prototype;function R(Q,I,Z){this.props=Q,this.context=I,this.refs=A,this.updater=Z||E}var z=R.prototype=new F;z.constructor=R,T(z,M.prototype),z.isPureReactComponent=!0;var re=Array.isArray;function te(){}var b={H:null,A:null,T:null,S:null},N=Object.prototype.hasOwnProperty;function k(Q,I,Z){var ee=Z.ref;return{$$typeof:t,type:Q,key:I,ref:ee!==void 0?ee:null,props:Z}}function j(Q,I){return k(Q.type,I,Q.props)}function L(Q){return typeof Q=="object"&&Q!==null&&Q.$$typeof===t}function P(Q){var I={"=":"=0",":":"=2"};return"$"+Q.replace(/[=:]/g,function(Z){return I[Z]})}var U=/\/+/g;function Ce(Q,I){return typeof Q=="object"&&Q!==null&&Q.key!=null?P(""+Q.key):I.toString(36)}function Ne(Q){switch(Q.status){case"fulfilled":return Q.value;case"rejected":throw Q.reason;default:switch(typeof Q.status=="string"?Q.then(te,te):(Q.status="pending",Q.then(function(I){Q.status==="pending"&&(Q.status="fulfilled",Q.value=I)},function(I){Q.status==="pending"&&(Q.status="rejected",Q.reason=I)})),Q.status){case"fulfilled":return Q.value;case"rejected":throw Q.reason}}throw Q}function ae(Q,I,Z,ee,B){var se=typeof Q;(se==="undefined"||se==="boolean")&&(Q=null);var _e=!1;if(Q===null)_e=!0;else switch(se){case"bigint":case"string":case"number":_e=!0;break;case"object":switch(Q.$$typeof){case t:case e:_e=!0;break;case p:return _e=Q._init,ae(_e(Q._payload),I,Z,ee,B)}}if(_e)return B=B(Q),_e=ee===""?"."+Ce(Q,0):ee,re(B)?(Z="",_e!=null&&(Z=_e.replace(U,"$&/")+"/"),ae(B,I,Z,"",function(we){return we})):B!=null&&(L(B)&&(B=j(B,Z+(B.key==null||Q&&Q.key===B.key?"":(""+B.key).replace(U,"$&/")+"/")+_e)),I.push(B)),1;_e=0;var Pe=ee===""?".":ee+":";if(re(Q))for(var he=0;he<Q.length;he++)ee=Q[he],se=Pe+Ce(ee,he),_e+=ae(ee,I,Z,se,B);else if(he=w(Q),typeof he=="function")for(Q=he.call(Q),he=0;!(ee=Q.next()).done;)ee=ee.value,se=Pe+Ce(ee,he++),_e+=ae(ee,I,Z,se,B);else if(se==="object"){if(typeof Q.then=="function")return ae(Ne(Q),I,Z,ee,B);throw I=String(Q),Error("Objects are not valid as a React child (found: "+(I==="[object Object]"?"object with keys {"+Object.keys(Q).join(", ")+"}":I)+"). If you meant to render a collection of children, use an array instead.")}return _e}function ue(Q,I,Z){if(Q==null)return Q;var ee=[],B=0;return ae(Q,ee,"","",function(se){return I.call(Z,se,B++)}),ee}function pe(Q){if(Q._status===-1){var I=Q._result;I=I(),I.then(function(Z){(Q._status===0||Q._status===-1)&&(Q._status=1,Q._result=Z)},function(Z){(Q._status===0||Q._status===-1)&&(Q._status=2,Q._result=Z)}),Q._status===-1&&(Q._status=0,Q._result=I)}if(Q._status===1)return Q._result.default;throw Q._result}var ne=typeof reportError=="function"?reportError:function(Q){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var I=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof Q=="object"&&Q!==null&&typeof Q.message=="string"?String(Q.message):String(Q),error:Q});if(!window.dispatchEvent(I))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",Q);return}console.error(Q)},be={map:ue,forEach:function(Q,I,Z){ue(Q,function(){I.apply(this,arguments)},Z)},count:function(Q){var I=0;return ue(Q,function(){I++}),I},toArray:function(Q){return ue(Q,function(I){return I})||[]},only:function(Q){if(!L(Q))throw Error("React.Children.only expected to receive a single React element child.");return Q}};return ft.Activity=v,ft.Children=be,ft.Component=M,ft.Fragment=r,ft.Profiler=a,ft.PureComponent=R,ft.StrictMode=n,ft.Suspense=h,ft.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=b,ft.__COMPILER_RUNTIME={__proto__:null,c:function(Q){return b.H.useMemoCache(Q)}},ft.cache=function(Q){return function(){return Q.apply(null,arguments)}},ft.cacheSignal=function(){return null},ft.cloneElement=function(Q,I,Z){if(Q==null)throw Error("The argument must be a React element, but you passed "+Q+".");var ee=T({},Q.props),B=Q.key;if(I!=null)for(se in I.key!==void 0&&(B=""+I.key),I)!N.call(I,se)||se==="key"||se==="__self"||se==="__source"||se==="ref"&&I.ref===void 0||(ee[se]=I[se]);var se=arguments.length-2;if(se===1)ee.children=Z;else if(1<se){for(var _e=Array(se),Pe=0;Pe<se;Pe++)_e[Pe]=arguments[Pe+2];ee.children=_e}return k(Q.type,B,ee)},ft.createContext=function(Q){return Q={$$typeof:o,_currentValue:Q,_currentValue2:Q,_threadCount:0,Provider:null,Consumer:null},Q.Provider=Q,Q.Consumer={$$typeof:l,_context:Q},Q},ft.createElement=function(Q,I,Z){var ee,B={},se=null;if(I!=null)for(ee in I.key!==void 0&&(se=""+I.key),I)N.call(I,ee)&&ee!=="key"&&ee!=="__self"&&ee!=="__source"&&(B[ee]=I[ee]);var _e=arguments.length-2;if(_e===1)B.children=Z;else if(1<_e){for(var Pe=Array(_e),he=0;he<_e;he++)Pe[he]=arguments[he+2];B.children=Pe}if(Q&&Q.defaultProps)for(ee in _e=Q.defaultProps,_e)B[ee]===void 0&&(B[ee]=_e[ee]);return k(Q,se,B)},ft.createRef=function(){return{current:null}},ft.forwardRef=function(Q){return{$$typeof:u,render:Q}},ft.isValidElement=L,ft.lazy=function(Q){return{$$typeof:p,_payload:{_status:-1,_result:Q},_init:pe}},ft.memo=function(Q,I){return{$$typeof:m,type:Q,compare:I===void 0?null:I}},ft.startTransition=function(Q){var I=b.T,Z={};b.T=Z;try{var ee=Q(),B=b.S;B!==null&&B(Z,ee),typeof ee=="object"&&ee!==null&&typeof ee.then=="function"&&ee.then(te,ne)}catch(se){ne(se)}finally{I!==null&&Z.types!==null&&(I.types=Z.types),b.T=I}},ft.unstable_useCacheRefresh=function(){return b.H.useCacheRefresh()},ft.use=function(Q){return b.H.use(Q)},ft.useActionState=function(Q,I,Z){return b.H.useActionState(Q,I,Z)},ft.useCallback=function(Q,I){return b.H.useCallback(Q,I)},ft.useContext=function(Q){return b.H.useContext(Q)},ft.useDebugValue=function(){},ft.useDeferredValue=function(Q,I){return b.H.useDeferredValue(Q,I)},ft.useEffect=function(Q,I){return b.H.useEffect(Q,I)},ft.useEffectEvent=function(Q){return b.H.useEffectEvent(Q)},ft.useId=function(){return b.H.useId()},ft.useImperativeHandle=function(Q,I,Z){return b.H.useImperativeHandle(Q,I,Z)},ft.useInsertionEffect=function(Q,I){return b.H.useInsertionEffect(Q,I)},ft.useLayoutEffect=function(Q,I){return b.H.useLayoutEffect(Q,I)},ft.useMemo=function(Q,I){return b.H.useMemo(Q,I)},ft.useOptimistic=function(Q,I){return b.H.useOptimistic(Q,I)},ft.useReducer=function(Q,I,Z){return b.H.useReducer(Q,I,Z)},ft.useRef=function(Q){return b.H.useRef(Q)},ft.useState=function(Q){return b.H.useState(Q)},ft.useSyncExternalStore=function(Q,I,Z){return b.H.useSyncExternalStore(Q,I,Z)},ft.useTransition=function(){return b.H.useTransition()},ft.version="19.2.1",ft}var l2;function Qx(){return l2||(l2=1,Ag.exports=Ik()),Ag.exports}var q=Qx();const Kf=Xx(q),Ok=fb({__proto__:null,default:Kf},[q]);var Ng={exports:{}},Ku={},Cg={exports:{}},kg={};var o2;function Mk(){return o2||(o2=1,(function(t){function e(ae,ue){var pe=ae.length;ae.push(ue);e:for(;0<pe;){var ne=pe-1>>>1,be=ae[ne];if(0<a(be,ue))ae[ne]=ue,ae[pe]=be,pe=ne;else break e}}function r(ae){return ae.length===0?null:ae[0]}function n(ae){if(ae.length===0)return null;var ue=ae[0],pe=ae.pop();if(pe!==ue){ae[0]=pe;e:for(var ne=0,be=ae.length,Q=be>>>1;ne<Q;){var I=2*(ne+1)-1,Z=ae[I],ee=I+1,B=ae[ee];if(0>a(Z,pe))ee<be&&0>a(B,Z)?(ae[ne]=B,ae[ee]=pe,ne=ee):(ae[ne]=Z,ae[I]=pe,ne=I);else if(ee<be&&0>a(B,pe))ae[ne]=B,ae[ee]=pe,ne=ee;else break e}}return ue}function a(ae,ue){var pe=ae.sortIndex-ue.sortIndex;return pe!==0?pe:ae.id-ue.id}if(t.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var l=performance;t.unstable_now=function(){return l.now()}}else{var o=Date,u=o.now();t.unstable_now=function(){return o.now()-u}}var h=[],m=[],p=1,v=null,_=3,w=!1,E=!1,T=!1,A=!1,M=typeof setTimeout=="function"?setTimeout:null,F=typeof clearTimeout=="function"?clearTimeout:null,R=typeof setImmediate<"u"?setImmediate:null;function z(ae){for(var ue=r(m);ue!==null;){if(ue.callback===null)n(m);else if(ue.startTime<=ae)n(m),ue.sortIndex=ue.expirationTime,e(h,ue);else break;ue=r(m)}}function re(ae){if(T=!1,z(ae),!E)if(r(h)!==null)E=!0,te||(te=!0,P());else{var ue=r(m);ue!==null&&Ne(re,ue.startTime-ae)}}var te=!1,b=-1,N=5,k=-1;function j(){return A?!0:!(t.unstable_now()-k<N)}function L(){if(A=!1,te){var ae=t.unstable_now();k=ae;var ue=!0;try{e:{E=!1,T&&(T=!1,F(b),b=-1),w=!0;var pe=_;try{t:{for(z(ae),v=r(h);v!==null&&!(v.expirationTime>ae&&j());){var ne=v.callback;if(typeof ne=="function"){v.callback=null,_=v.priorityLevel;var be=ne(v.expirationTime<=ae);if(ae=t.unstable_now(),typeof be=="function"){v.callback=be,z(ae),ue=!0;break t}v===r(h)&&n(h),z(ae)}else n(h);v=r(h)}if(v!==null)ue=!0;else{var Q=r(m);Q!==null&&Ne(re,Q.startTime-ae),ue=!1}}break e}finally{v=null,_=pe,w=!1}ue=void 0}}finally{ue?P():te=!1}}}var P;if(typeof R=="function")P=function(){R(L)};else if(typeof MessageChannel<"u"){var U=new MessageChannel,Ce=U.port2;U.port1.onmessage=L,P=function(){Ce.postMessage(null)}}else P=function(){M(L,0)};function Ne(ae,ue){b=M(function(){ae(t.unstable_now())},ue)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(ae){ae.callback=null},t.unstable_forceFrameRate=function(ae){0>ae||125<ae?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):N=0<ae?Math.floor(1e3/ae):5},t.unstable_getCurrentPriorityLevel=function(){return _},t.unstable_next=function(ae){switch(_){case 1:case 2:case 3:var ue=3;break;default:ue=_}var pe=_;_=ue;try{return ae()}finally{_=pe}},t.unstable_requestPaint=function(){A=!0},t.unstable_runWithPriority=function(ae,ue){switch(ae){case 1:case 2:case 3:case 4:case 5:break;default:ae=3}var pe=_;_=ae;try{return ue()}finally{_=pe}},t.unstable_scheduleCallback=function(ae,ue,pe){var ne=t.unstable_now();switch(typeof pe=="object"&&pe!==null?(pe=pe.delay,pe=typeof pe=="number"&&0<pe?ne+pe:ne):pe=ne,ae){case 1:var be=-1;break;case 2:be=250;break;case 5:be=1073741823;break;case 4:be=1e4;break;default:be=5e3}return be=pe+be,ae={id:p++,callback:ue,priorityLevel:ae,startTime:pe,expirationTime:be,sortIndex:-1},pe>ne?(ae.sortIndex=pe,e(m,ae),r(h)===null&&ae===r(m)&&(T?(F(b),b=-1):T=!0,Ne(re,pe-ne))):(ae.sortIndex=be,e(h,ae),E||w||(E=!0,te||(te=!0,P()))),ae},t.unstable_shouldYield=j,t.unstable_wrapCallback=function(ae){var ue=_;return function(){var pe=_;_=ue;try{return ae.apply(this,arguments)}finally{_=pe}}}})(kg)),kg}var c2;function jk(){return c2||(c2=1,Cg.exports=Mk()),Cg.exports}var Rg={exports:{}},Rn={};var u2;function Fk(){if(u2)return Rn;u2=1;var t=Qx();function e(h){var m="https://react.dev/errors/"+h;if(1<arguments.length){m+="?args[]="+encodeURIComponent(arguments[1]);for(var p=2;p<arguments.length;p++)m+="&args[]="+encodeURIComponent(arguments[p])}return"Minified React error #"+h+"; visit "+m+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function r(){}var n={d:{f:r,r:function(){throw Error(e(522))},D:r,C:r,L:r,m:r,X:r,S:r,M:r},p:0,findDOMNode:null},a=Symbol.for("react.portal");function l(h,m,p){var v=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:a,key:v==null?null:""+v,children:h,containerInfo:m,implementation:p}}var o=t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function u(h,m){if(h==="font")return"";if(typeof m=="string")return m==="use-credentials"?m:""}return Rn.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=n,Rn.createPortal=function(h,m){var p=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!m||m.nodeType!==1&&m.nodeType!==9&&m.nodeType!==11)throw Error(e(299));return l(h,m,null,p)},Rn.flushSync=function(h){var m=o.T,p=n.p;try{if(o.T=null,n.p=2,h)return h()}finally{o.T=m,n.p=p,n.d.f()}},Rn.preconnect=function(h,m){typeof h=="string"&&(m?(m=m.crossOrigin,m=typeof m=="string"?m==="use-credentials"?m:"":void 0):m=null,n.d.C(h,m))},Rn.prefetchDNS=function(h){typeof h=="string"&&n.d.D(h)},Rn.preinit=function(h,m){if(typeof h=="string"&&m&&typeof m.as=="string"){var p=m.as,v=u(p,m.crossOrigin),_=typeof m.integrity=="string"?m.integrity:void 0,w=typeof m.fetchPriority=="string"?m.fetchPriority:void 0;p==="style"?n.d.S(h,typeof m.precedence=="string"?m.precedence:void 0,{crossOrigin:v,integrity:_,fetchPriority:w}):p==="script"&&n.d.X(h,{crossOrigin:v,integrity:_,fetchPriority:w,nonce:typeof m.nonce=="string"?m.nonce:void 0})}},Rn.preinitModule=function(h,m){if(typeof h=="string")if(typeof m=="object"&&m!==null){if(m.as==null||m.as==="script"){var p=u(m.as,m.crossOrigin);n.d.M(h,{crossOrigin:p,integrity:typeof m.integrity=="string"?m.integrity:void 0,nonce:typeof m.nonce=="string"?m.nonce:void 0})}}else m==null&&n.d.M(h)},Rn.preload=function(h,m){if(typeof h=="string"&&typeof m=="object"&&m!==null&&typeof m.as=="string"){var p=m.as,v=u(p,m.crossOrigin);n.d.L(h,p,{crossOrigin:v,integrity:typeof m.integrity=="string"?m.integrity:void 0,nonce:typeof m.nonce=="string"?m.nonce:void 0,type:typeof m.type=="string"?m.type:void 0,fetchPriority:typeof m.fetchPriority=="string"?m.fetchPriority:void 0,referrerPolicy:typeof m.referrerPolicy=="string"?m.referrerPolicy:void 0,imageSrcSet:typeof m.imageSrcSet=="string"?m.imageSrcSet:void 0,imageSizes:typeof m.imageSizes=="string"?m.imageSizes:void 0,media:typeof m.media=="string"?m.media:void 0})}},Rn.preloadModule=function(h,m){if(typeof h=="string")if(m){var p=u(m.as,m.crossOrigin);n.d.m(h,{as:typeof m.as=="string"&&m.as!=="script"?m.as:void 0,crossOrigin:p,integrity:typeof m.integrity=="string"?m.integrity:void 0})}else n.d.m(h)},Rn.requestFormReset=function(h){n.d.r(h)},Rn.unstable_batchedUpdates=function(h,m){return h(m)},Rn.useFormState=function(h,m,p){return o.H.useFormState(h,m,p)},Rn.useFormStatus=function(){return o.H.useHostTransitionStatus()},Rn.version="19.2.1",Rn}var f2;function hb(){if(f2)return Rg.exports;f2=1;function t(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(t)}catch(e){console.error(e)}}return t(),Rg.exports=Fk(),Rg.exports}var h2;function Pk(){if(h2)return Ku;h2=1;var t=jk(),e=Qx(),r=hb();function n(s){var i="https://react.dev/errors/"+s;if(1<arguments.length){i+="?args[]="+encodeURIComponent(arguments[1]);for(var c=2;c<arguments.length;c++)i+="&args[]="+encodeURIComponent(arguments[c])}return"Minified React error #"+s+"; visit "+i+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function a(s){return!(!s||s.nodeType!==1&&s.nodeType!==9&&s.nodeType!==11)}function l(s){var i=s,c=s;if(s.alternate)for(;i.return;)i=i.return;else{s=i;do i=s,(i.flags&4098)!==0&&(c=i.return),s=i.return;while(s)}return i.tag===3?c:null}function o(s){if(s.tag===13){var i=s.memoizedState;if(i===null&&(s=s.alternate,s!==null&&(i=s.memoizedState)),i!==null)return i.dehydrated}return null}function u(s){if(s.tag===31){var i=s.memoizedState;if(i===null&&(s=s.alternate,s!==null&&(i=s.memoizedState)),i!==null)return i.dehydrated}return null}function h(s){if(l(s)!==s)throw Error(n(188))}function m(s){var i=s.alternate;if(!i){if(i=l(s),i===null)throw Error(n(188));return i!==s?null:s}for(var c=s,f=i;;){var x=c.return;if(x===null)break;var y=x.alternate;if(y===null){if(f=x.return,f!==null){c=f;continue}break}if(x.child===y.child){for(y=x.child;y;){if(y===c)return h(x),s;if(y===f)return h(x),i;y=y.sibling}throw Error(n(188))}if(c.return!==f.return)c=x,f=y;else{for(var C=!1,G=x.child;G;){if(G===c){C=!0,c=x,f=y;break}if(G===f){C=!0,f=x,c=y;break}G=G.sibling}if(!C){for(G=y.child;G;){if(G===c){C=!0,c=y,f=x;break}if(G===f){C=!0,f=y,c=x;break}G=G.sibling}if(!C)throw Error(n(189))}}if(c.alternate!==f)throw Error(n(190))}if(c.tag!==3)throw Error(n(188));return c.stateNode.current===c?s:i}function p(s){var i=s.tag;if(i===5||i===26||i===27||i===6)return s;for(s=s.child;s!==null;){if(i=p(s),i!==null)return i;s=s.sibling}return null}var v=Object.assign,_=Symbol.for("react.element"),w=Symbol.for("react.transitional.element"),E=Symbol.for("react.portal"),T=Symbol.for("react.fragment"),A=Symbol.for("react.strict_mode"),M=Symbol.for("react.profiler"),F=Symbol.for("react.consumer"),R=Symbol.for("react.context"),z=Symbol.for("react.forward_ref"),re=Symbol.for("react.suspense"),te=Symbol.for("react.suspense_list"),b=Symbol.for("react.memo"),N=Symbol.for("react.lazy"),k=Symbol.for("react.activity"),j=Symbol.for("react.memo_cache_sentinel"),L=Symbol.iterator;function P(s){return s===null||typeof s!="object"?null:(s=L&&s[L]||s["@@iterator"],typeof s=="function"?s:null)}var U=Symbol.for("react.client.reference");function Ce(s){if(s==null)return null;if(typeof s=="function")return s.$$typeof===U?null:s.displayName||s.name||null;if(typeof s=="string")return s;switch(s){case T:return"Fragment";case M:return"Profiler";case A:return"StrictMode";case re:return"Suspense";case te:return"SuspenseList";case k:return"Activity"}if(typeof s=="object")switch(s.$$typeof){case E:return"Portal";case R:return s.displayName||"Context";case F:return(s._context.displayName||"Context")+".Consumer";case z:var i=s.render;return s=s.displayName,s||(s=i.displayName||i.name||"",s=s!==""?"ForwardRef("+s+")":"ForwardRef"),s;case b:return i=s.displayName||null,i!==null?i:Ce(s.type)||"Memo";case N:i=s._payload,s=s._init;try{return Ce(s(i))}catch{}}return null}var Ne=Array.isArray,ae=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,ue=r.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,pe={pending:!1,data:null,method:null,action:null},ne=[],be=-1;function Q(s){return{current:s}}function I(s){0>be||(s.current=ne[be],ne[be]=null,be--)}function Z(s,i){be++,ne[be]=s.current,s.current=i}var ee=Q(null),B=Q(null),se=Q(null),_e=Q(null);function Pe(s,i){switch(Z(se,i),Z(B,s),Z(ee,null),i.nodeType){case 9:case 11:s=(s=i.documentElement)&&(s=s.namespaceURI)?Nw(s):0;break;default:if(s=i.tagName,i=i.namespaceURI)i=Nw(i),s=Cw(i,s);else switch(s){case"svg":s=1;break;case"math":s=2;break;default:s=0}}I(ee),Z(ee,s)}function he(){I(ee),I(B),I(se)}function we(s){s.memoizedState!==null&&Z(_e,s);var i=ee.current,c=Cw(i,s.type);i!==c&&(Z(B,s),Z(ee,c))}function He(s){B.current===s&&(I(ee),I(B)),_e.current===s&&(I(_e),zu._currentValue=pe)}var J,Qe;function $e(s){if(J===void 0)try{throw Error()}catch(c){var i=c.stack.trim().match(/\n( *(at )?)/);J=i&&i[1]||"",Qe=-1<c.stack.indexOf(`
    at`)?" (<anonymous>)":-1<c.stack.indexOf("@")?"@unknown:0:0":""}return`
`+J+s+Qe}var Fe=!1;function Ue(s,i){if(!s||Fe)return"";Fe=!0;var c=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var f={DetermineComponentFrameRoot:function(){try{if(i){var je=function(){throw Error()};if(Object.defineProperty(je.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(je,[])}catch(ke){var Se=ke}Reflect.construct(s,[],je)}else{try{je.call()}catch(ke){Se=ke}s.call(je.prototype)}}else{try{throw Error()}catch(ke){Se=ke}(je=s())&&typeof je.catch=="function"&&je.catch(function(){})}}catch(ke){if(ke&&Se&&typeof ke.stack=="string")return[ke.stack,Se.stack]}return[null,null]}};f.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var x=Object.getOwnPropertyDescriptor(f.DetermineComponentFrameRoot,"name");x&&x.configurable&&Object.defineProperty(f.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var y=f.DetermineComponentFrameRoot(),C=y[0],G=y[1];if(C&&G){var ie=C.split(`
`),Ee=G.split(`
`);for(x=f=0;f<ie.length&&!ie[f].includes("DetermineComponentFrameRoot");)f++;for(;x<Ee.length&&!Ee[x].includes("DetermineComponentFrameRoot");)x++;if(f===ie.length||x===Ee.length)for(f=ie.length-1,x=Ee.length-1;1<=f&&0<=x&&ie[f]!==Ee[x];)x--;for(;1<=f&&0<=x;f--,x--)if(ie[f]!==Ee[x]){if(f!==1||x!==1)do if(f--,x--,0>x||ie[f]!==Ee[x]){var Ie=`
`+ie[f].replace(" at new "," at ");return s.displayName&&Ie.includes("<anonymous>")&&(Ie=Ie.replace("<anonymous>",s.displayName)),Ie}while(1<=f&&0<=x);break}}}finally{Fe=!1,Error.prepareStackTrace=c}return(c=s?s.displayName||s.name:"")?$e(c):""}function De(s,i){switch(s.tag){case 26:case 27:case 5:return $e(s.type);case 16:return $e("Lazy");case 13:return s.child!==i&&i!==null?$e("Suspense Fallback"):$e("Suspense");case 19:return $e("SuspenseList");case 0:case 15:return Ue(s.type,!1);case 11:return Ue(s.type.render,!1);case 1:return Ue(s.type,!0);case 31:return $e("Activity");default:return""}}function ut(s){try{var i="",c=null;do i+=De(s,c),c=s,s=s.return;while(s);return i}catch(f){return`
Error generating stack: `+f.message+`
`+f.stack}}var Lt=Object.prototype.hasOwnProperty,Qt=t.unstable_scheduleCallback,yr=t.unstable_cancelCallback,Hn=t.unstable_shouldYield,Jt=t.unstable_requestPaint,pt=t.unstable_now,hr=t.unstable_getCurrentPriorityLevel,kt=t.unstable_ImmediatePriority,$t=t.unstable_UserBlockingPriority,Ut=t.unstable_NormalPriority,dr=t.unstable_LowPriority,lt=t.unstable_IdlePriority,Zt=t.log,Sr=t.unstable_setDisableYieldValue,St=null,or=null;function nn(s){if(typeof Zt=="function"&&Sr(s),or&&typeof or.setStrictMode=="function")try{or.setStrictMode(St,s)}catch{}}var Ur=Math.clz32?Math.clz32:ja,Dl=Math.log,rs=Math.LN2;function ja(s){return s>>>=0,s===0?32:31-(Dl(s)/rs|0)|0}var ga=256,Nn=262144,na=4194304;function an(s){var i=s&42;if(i!==0)return i;switch(s&-s){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return s&261888;case 262144:case 524288:case 1048576:case 2097152:return s&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return s&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return s}}function dn(s,i,c){var f=s.pendingLanes;if(f===0)return 0;var x=0,y=s.suspendedLanes,C=s.pingedLanes;s=s.warmLanes;var G=f&134217727;return G!==0?(f=G&~y,f!==0?x=an(f):(C&=G,C!==0?x=an(C):c||(c=G&~s,c!==0&&(x=an(c))))):(G=f&~y,G!==0?x=an(G):C!==0?x=an(C):c||(c=f&~s,c!==0&&(x=an(c)))),x===0?0:i!==0&&i!==x&&(i&y)===0&&(y=x&-x,c=i&-i,y>=c||y===32&&(c&4194048)!==0)?i:x}function Fa(s,i){return(s.pendingLanes&~(s.suspendedLanes&~s.pingedLanes)&i)===0}function ns(s,i){switch(s){case 1:case 2:case 4:case 8:case 64:return i+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return i+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Pa(){var s=na;return na<<=1,(na&62914560)===0&&(na=4194304),s}function Cn(s){for(var i=[],c=0;31>c;c++)i.push(s);return i}function La(s,i){s.pendingLanes|=i,i!==268435456&&(s.suspendedLanes=0,s.pingedLanes=0,s.warmLanes=0)}function Or(s,i,c,f,x,y){var C=s.pendingLanes;s.pendingLanes=c,s.suspendedLanes=0,s.pingedLanes=0,s.warmLanes=0,s.expiredLanes&=c,s.entangledLanes&=c,s.errorRecoveryDisabledLanes&=c,s.shellSuspendCounter=0;var G=s.entanglements,ie=s.expirationTimes,Ee=s.hiddenUpdates;for(c=C&~c;0<c;){var Ie=31-Ur(c),je=1<<Ie;G[Ie]=0,ie[Ie]=-1;var Se=Ee[Ie];if(Se!==null)for(Ee[Ie]=null,Ie=0;Ie<Se.length;Ie++){var ke=Se[Ie];ke!==null&&(ke.lane&=-536870913)}c&=~je}f!==0&&le(s,f,0),y!==0&&x===0&&s.tag!==0&&(s.suspendedLanes|=y&~(C&~i))}function le(s,i,c){s.pendingLanes|=i,s.suspendedLanes&=~i;var f=31-Ur(i);s.entangledLanes|=i,s.entanglements[f]=s.entanglements[f]|1073741824|c&261930}function de(s,i){var c=s.entangledLanes|=i;for(s=s.entanglements;c;){var f=31-Ur(c),x=1<<f;x&i|s[f]&i&&(s[f]|=i),c&=~x}}function Ae(s,i){var c=i&-i;return c=(c&42)!==0?1:Be(c),(c&(s.suspendedLanes|i))!==0?0:c}function Be(s){switch(s){case 2:s=1;break;case 8:s=4;break;case 32:s=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:s=128;break;case 268435456:s=134217728;break;default:s=0}return s}function Ke(s){return s&=-s,2<s?8<s?(s&134217727)!==0?32:268435456:8:2}function O(){var s=ue.p;return s!==0?s:(s=window.event,s===void 0?32:Qw(s.type))}function Y(s,i){var c=ue.p;try{return ue.p=s,i()}finally{ue.p=c}}var V=Math.random().toString(36).slice(2),H="__reactFiber$"+V,W="__reactProps$"+V,K="__reactContainer$"+V,oe="__reactEvents$"+V,ve="__reactListeners$"+V,xe="__reactHandles$"+V,me="__reactResources$"+V,fe="__reactMarker$"+V;function Oe(s){delete s[H],delete s[W],delete s[oe],delete s[ve],delete s[xe]}function Ge(s){var i=s[H];if(i)return i;for(var c=s.parentNode;c;){if(i=c[K]||c[H]){if(c=i.alternate,i.child!==null||c!==null&&c.child!==null)for(s=jw(s);s!==null;){if(c=s[H])return c;s=jw(s)}return i}s=c,c=s.parentNode}return null}function Ye(s){if(s=s[H]||s[K]){var i=s.tag;if(i===5||i===6||i===13||i===31||i===26||i===27||i===3)return s}return null}function Ve(s){var i=s.tag;if(i===5||i===26||i===27||i===6)return s.stateNode;throw Error(n(33))}function qe(s){var i=s[me];return i||(i=s[me]={hoistableStyles:new Map,hoistableScripts:new Map}),i}function Xe(s){s[fe]=!0}var Rt=new Set,wt={};function At(s,i){Mr(s,i),Mr(s+"Capture",i)}function Mr(s,i){for(wt[s]=i,s=0;s<i.length;s++)Rt.add(i[s])}var xt=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),Bt={},Br={};function aa(s){return Lt.call(Br,s)?!0:Lt.call(Bt,s)?!1:xt.test(s)?Br[s]=!0:(Bt[s]=!0,!1)}function Tt(s,i,c){if(aa(i))if(c===null)s.removeAttribute(i);else{switch(typeof c){case"undefined":case"function":case"symbol":s.removeAttribute(i);return;case"boolean":var f=i.toLowerCase().slice(0,5);if(f!=="data-"&&f!=="aria-"){s.removeAttribute(i);return}}s.setAttribute(i,""+c)}}function Gn(s,i,c){if(c===null)s.removeAttribute(i);else{switch(typeof c){case"undefined":case"function":case"symbol":case"boolean":s.removeAttribute(i);return}s.setAttribute(i,""+c)}}function qn(s,i,c,f){if(f===null)s.removeAttribute(c);else{switch(typeof f){case"undefined":case"function":case"symbol":case"boolean":s.removeAttribute(c);return}s.setAttributeNS(i,c,""+f)}}function mn(s){switch(typeof s){case"bigint":case"boolean":case"number":case"string":case"undefined":return s;case"object":return s;default:return""}}function xh(s){var i=s.type;return(s=s.nodeName)&&s.toLowerCase()==="input"&&(i==="checkbox"||i==="radio")}function Nm(s,i,c){var f=Object.getOwnPropertyDescriptor(s.constructor.prototype,i);if(!s.hasOwnProperty(i)&&typeof f<"u"&&typeof f.get=="function"&&typeof f.set=="function"){var x=f.get,y=f.set;return Object.defineProperty(s,i,{configurable:!0,get:function(){return x.call(this)},set:function(C){c=""+C,y.call(this,C)}}),Object.defineProperty(s,i,{enumerable:f.enumerable}),{getValue:function(){return c},setValue:function(C){c=""+C},stopTracking:function(){s._valueTracker=null,delete s[i]}}}}function jo(s){if(!s._valueTracker){var i=xh(s)?"checked":"value";s._valueTracker=Nm(s,i,""+s[i])}}function tu(s){if(!s)return!1;var i=s._valueTracker;if(!i)return!0;var c=i.getValue(),f="";return s&&(f=xh(s)?s.checked?"true":"false":s.value),s=f,s!==c?(i.setValue(s),!0):!1}function Fo(s){if(s=s||(typeof document<"u"?document:void 0),typeof s>"u")return null;try{return s.activeElement||s.body}catch{return s.body}}var zs=/[\n"\\]/g;function Ar(s){return s.replace(zs,function(i){return"\\"+i.charCodeAt(0).toString(16)+" "})}function Ni(s,i,c,f,x,y,C,G){s.name="",C!=null&&typeof C!="function"&&typeof C!="symbol"&&typeof C!="boolean"?s.type=C:s.removeAttribute("type"),i!=null?C==="number"?(i===0&&s.value===""||s.value!=i)&&(s.value=""+mn(i)):s.value!==""+mn(i)&&(s.value=""+mn(i)):C!=="submit"&&C!=="reset"||s.removeAttribute("value"),i!=null?Po(s,C,mn(i)):c!=null?Po(s,C,mn(c)):f!=null&&s.removeAttribute("value"),x==null&&y!=null&&(s.defaultChecked=!!y),x!=null&&(s.checked=x&&typeof x!="function"&&typeof x!="symbol"),G!=null&&typeof G!="function"&&typeof G!="symbol"&&typeof G!="boolean"?s.name=""+mn(G):s.removeAttribute("name")}function Il(s,i,c,f,x,y,C,G){if(y!=null&&typeof y!="function"&&typeof y!="symbol"&&typeof y!="boolean"&&(s.type=y),i!=null||c!=null){if(!(y!=="submit"&&y!=="reset"||i!=null)){jo(s);return}c=c!=null?""+mn(c):"",i=i!=null?""+mn(i):c,G||i===s.value||(s.value=i),s.defaultValue=i}f=f??x,f=typeof f!="function"&&typeof f!="symbol"&&!!f,s.checked=G?s.checked:!!f,s.defaultChecked=!!f,C!=null&&typeof C!="function"&&typeof C!="symbol"&&typeof C!="boolean"&&(s.name=C),jo(s)}function Po(s,i,c){i==="number"&&Fo(s.ownerDocument)===s||s.defaultValue===""+c||(s.defaultValue=""+c)}function qt(s,i,c,f){if(s=s.options,i){i={};for(var x=0;x<c.length;x++)i["$"+c[x]]=!0;for(c=0;c<s.length;c++)x=i.hasOwnProperty("$"+s[c].value),s[c].selected!==x&&(s[c].selected=x),x&&f&&(s[c].defaultSelected=!0)}else{for(c=""+mn(c),i=null,x=0;x<s.length;x++){if(s[x].value===c){s[x].selected=!0,f&&(s[x].defaultSelected=!0);return}i!==null||s[x].disabled||(i=s[x])}i!==null&&(i.selected=!0)}}function Ol(s,i,c){if(i!=null&&(i=""+mn(i),i!==s.value&&(s.value=i),c==null)){s.defaultValue!==i&&(s.defaultValue=i);return}s.defaultValue=c!=null?""+mn(c):""}function Ci(s,i,c,f){if(i==null){if(f!=null){if(c!=null)throw Error(n(92));if(Ne(f)){if(1<f.length)throw Error(n(93));f=f[0]}c=f}c==null&&(c=""),i=c}c=mn(i),s.defaultValue=c,f=s.textContent,f===c&&f!==""&&f!==null&&(s.value=f),jo(s)}function Ua(s,i){if(i){var c=s.firstChild;if(c&&c===s.lastChild&&c.nodeType===3){c.nodeValue=i;return}}s.textContent=i}var Cm=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function ru(s,i,c){var f=i.indexOf("--")===0;c==null||typeof c=="boolean"||c===""?f?s.setProperty(i,""):i==="float"?s.cssFloat="":s[i]="":f?s.setProperty(i,c):typeof c!="number"||c===0||Cm.has(i)?i==="float"?s.cssFloat=c:s[i]=(""+c).trim():s[i]=c+"px"}function vh(s,i,c){if(i!=null&&typeof i!="object")throw Error(n(62));if(s=s.style,c!=null){for(var f in c)!c.hasOwnProperty(f)||i!=null&&i.hasOwnProperty(f)||(f.indexOf("--")===0?s.setProperty(f,""):f==="float"?s.cssFloat="":s[f]="");for(var x in i)f=i[x],i.hasOwnProperty(x)&&c[x]!==f&&ru(s,x,f)}else for(var y in i)i.hasOwnProperty(y)&&ru(s,y,i[y])}function nu(s){if(s.indexOf("-")===-1)return!1;switch(s){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var km=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),Rm=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function ws(s){return Rm.test(""+s)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":s}function sn(){}var Lo=null;function Uo(s){return s=s.target||s.srcElement||window,s.correspondingUseElement&&(s=s.correspondingUseElement),s.nodeType===3?s.parentNode:s}var Hs=null,xa=null;function yh(s){var i=Ye(s);if(i&&(s=i.stateNode)){var c=s[W]||null;e:switch(s=i.stateNode,i.type){case"input":if(Ni(s,c.value,c.defaultValue,c.defaultValue,c.checked,c.defaultChecked,c.type,c.name),i=c.name,c.type==="radio"&&i!=null){for(c=s;c.parentNode;)c=c.parentNode;for(c=c.querySelectorAll('input[name="'+Ar(""+i)+'"][type="radio"]'),i=0;i<c.length;i++){var f=c[i];if(f!==s&&f.form===s.form){var x=f[W]||null;if(!x)throw Error(n(90));Ni(f,x.value,x.defaultValue,x.defaultValue,x.checked,x.defaultChecked,x.type,x.name)}}for(i=0;i<c.length;i++)f=c[i],f.form===s.form&&tu(f)}break e;case"textarea":Ol(s,c.value,c.defaultValue);break e;case"select":i=c.value,i!=null&&qt(s,!!c.multiple,i,!1)}}}var au=!1;function _h(s,i,c){if(au)return s(i,c);au=!0;try{var f=s(i);return f}finally{if(au=!1,(Hs!==null||xa!==null)&&(gd(),Hs&&(i=Hs,s=xa,xa=Hs=null,yh(i),s)))for(i=0;i<s.length;i++)yh(s[i])}}function sa(s,i){var c=s.stateNode;if(c===null)return null;var f=c[W]||null;if(f===null)return null;c=f[i];e:switch(i){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(f=!f.disabled)||(s=s.type,f=!(s==="button"||s==="input"||s==="select"||s==="textarea")),s=!f;break e;default:s=!1}if(s)return null;if(c&&typeof c!="function")throw Error(n(231,i,typeof c));return c}var as=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),su=!1;if(as)try{var Ts={};Object.defineProperty(Ts,"passive",{get:function(){su=!0}}),window.addEventListener("test",Ts,Ts),window.removeEventListener("test",Ts,Ts)}catch{su=!1}var va=null,Bo=null,Es=null;function ki(){if(Es)return Es;var s,i=Bo,c=i.length,f,x="value"in va?va.value:va.textContent,y=x.length;for(s=0;s<c&&i[s]===x[s];s++);var C=c-s;for(f=1;f<=C&&i[c-f]===x[y-f];f++);return Es=x.slice(s,1<f?1-f:void 0)}function Ml(s){var i=s.keyCode;return"charCode"in s?(s=s.charCode,s===0&&i===13&&(s=13)):s=i,s===10&&(s=13),32<=s||s===13?s:0}function Ri(){return!0}function mr(){return!1}function kn(s){function i(c,f,x,y,C){this._reactName=c,this._targetInst=x,this.type=f,this.nativeEvent=y,this.target=C,this.currentTarget=null;for(var G in s)s.hasOwnProperty(G)&&(c=s[G],this[G]=c?c(y):y[G]);return this.isDefaultPrevented=(y.defaultPrevented!=null?y.defaultPrevented:y.returnValue===!1)?Ri:mr,this.isPropagationStopped=mr,this}return v(i.prototype,{preventDefault:function(){this.defaultPrevented=!0;var c=this.nativeEvent;c&&(c.preventDefault?c.preventDefault():typeof c.returnValue!="unknown"&&(c.returnValue=!1),this.isDefaultPrevented=Ri)},stopPropagation:function(){var c=this.nativeEvent;c&&(c.stopPropagation?c.stopPropagation():typeof c.cancelBubble!="unknown"&&(c.cancelBubble=!0),this.isPropagationStopped=Ri)},persist:function(){},isPersistent:Ri}),i}var Gs={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(s){return s.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},jl=kn(Gs),Di=v({},Gs,{view:0,detail:0}),wh=kn(Di),Ii,Vo,Wn,Fl=v({},Di,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Mi,button:0,buttons:0,relatedTarget:function(s){return s.relatedTarget===void 0?s.fromElement===s.srcElement?s.toElement:s.fromElement:s.relatedTarget},movementX:function(s){return"movementX"in s?s.movementX:(s!==Wn&&(Wn&&s.type==="mousemove"?(Ii=s.screenX-Wn.screenX,Vo=s.screenY-Wn.screenY):Vo=Ii=0,Wn=s),Ii)},movementY:function(s){return"movementY"in s?s.movementY:Vo}}),Th=kn(Fl),Pl=v({},Fl,{dataTransfer:0}),Eh=kn(Pl),iu=v({},Di,{relatedTarget:0}),Oi=kn(iu),bh=v({},Gs,{animationName:0,elapsedTime:0,pseudoElement:0}),zo=kn(bh),Dm=v({},Gs,{clipboardData:function(s){return"clipboardData"in s?s.clipboardData:window.clipboardData}}),Sh=kn(Dm),Ll=v({},Gs,{data:0}),lu=kn(Ll),Ah={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},ou={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},cu={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Nh(s){var i=this.nativeEvent;return i.getModifierState?i.getModifierState(s):(s=cu[s])?!!i[s]:!1}function Mi(){return Nh}var Ch=v({},Di,{key:function(s){if(s.key){var i=Ah[s.key]||s.key;if(i!=="Unidentified")return i}return s.type==="keypress"?(s=Ml(s),s===13?"Enter":String.fromCharCode(s)):s.type==="keydown"||s.type==="keyup"?ou[s.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Mi,charCode:function(s){return s.type==="keypress"?Ml(s):0},keyCode:function(s){return s.type==="keydown"||s.type==="keyup"?s.keyCode:0},which:function(s){return s.type==="keypress"?Ml(s):s.type==="keydown"||s.type==="keyup"?s.keyCode:0}}),kh=kn(Ch),qs=v({},Fl,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),uu=kn(qs),Rh=v({},Di,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Mi}),Dh=kn(Rh),Ih=v({},Gs,{propertyName:0,elapsedTime:0,pseudoElement:0}),Ho=kn(Ih),Kn=v({},Fl,{deltaX:function(s){return"deltaX"in s?s.deltaX:"wheelDeltaX"in s?-s.wheelDeltaX:0},deltaY:function(s){return"deltaY"in s?s.deltaY:"wheelDeltaY"in s?-s.wheelDeltaY:"wheelDelta"in s?-s.wheelDelta:0},deltaZ:0,deltaMode:0}),Oh=kn(Kn),Mh=v({},Gs,{newState:0,oldState:0}),ji=kn(Mh),g=[9,13,27,32],S=as&&"CompositionEvent"in window,D=null;as&&"documentMode"in document&&(D=document.documentMode);var X=as&&"TextEvent"in window&&!D,ye=as&&(!S||D&&8<D&&11>=D),Re=" ",We=!1;function er(s,i){switch(s){case"keyup":return g.indexOf(i.keyCode)!==-1;case"keydown":return i.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Vr(s){return s=s.detail,typeof s=="object"&&"data"in s?s.data:null}var Et=!1;function ln(s,i){switch(s){case"compositionend":return Vr(i);case"keypress":return i.which!==32?null:(We=!0,Re);case"textInput":return s=i.data,s===Re&&We?null:s;default:return null}}function on(s,i){if(Et)return s==="compositionend"||!S&&er(s,i)?(s=ki(),Es=Bo=va=null,Et=!1,s):null;switch(s){case"paste":return null;case"keypress":if(!(i.ctrlKey||i.altKey||i.metaKey)||i.ctrlKey&&i.altKey){if(i.char&&1<i.char.length)return i.char;if(i.which)return String.fromCharCode(i.which)}return null;case"compositionend":return ye&&i.locale!=="ko"?null:i.data;default:return null}}var Fi={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function ia(s){var i=s&&s.nodeName&&s.nodeName.toLowerCase();return i==="input"?!!Fi[s.type]:i==="textarea"}function Ul(s,i,c,f){Hs?xa?xa.push(f):xa=[f]:Hs=f,i=Ed(i,"onChange"),0<i.length&&(c=new jl("onChange","change",null,c,f),s.push({event:c,listeners:i}))}var Ws=null,fu=null;function n4(s){ww(s,0)}function jh(s){var i=Ve(s);if(tu(i))return s}function B1(s,i){if(s==="change")return i}var V1=!1;if(as){var Im;if(as){var Om="oninput"in document;if(!Om){var z1=document.createElement("div");z1.setAttribute("oninput","return;"),Om=typeof z1.oninput=="function"}Im=Om}else Im=!1;V1=Im&&(!document.documentMode||9<document.documentMode)}function H1(){Ws&&(Ws.detachEvent("onpropertychange",G1),fu=Ws=null)}function G1(s){if(s.propertyName==="value"&&jh(fu)){var i=[];Ul(i,fu,s,Uo(s)),_h(n4,i)}}function a4(s,i,c){s==="focusin"?(H1(),Ws=i,fu=c,Ws.attachEvent("onpropertychange",G1)):s==="focusout"&&H1()}function s4(s){if(s==="selectionchange"||s==="keyup"||s==="keydown")return jh(fu)}function i4(s,i){if(s==="click")return jh(i)}function l4(s,i){if(s==="input"||s==="change")return jh(i)}function o4(s,i){return s===i&&(s!==0||1/s===1/i)||s!==s&&i!==i}var ya=typeof Object.is=="function"?Object.is:o4;function hu(s,i){if(ya(s,i))return!0;if(typeof s!="object"||s===null||typeof i!="object"||i===null)return!1;var c=Object.keys(s),f=Object.keys(i);if(c.length!==f.length)return!1;for(f=0;f<c.length;f++){var x=c[f];if(!Lt.call(i,x)||!ya(s[x],i[x]))return!1}return!0}function q1(s){for(;s&&s.firstChild;)s=s.firstChild;return s}function W1(s,i){var c=q1(s);s=0;for(var f;c;){if(c.nodeType===3){if(f=s+c.textContent.length,s<=i&&f>=i)return{node:c,offset:i-s};s=f}e:{for(;c;){if(c.nextSibling){c=c.nextSibling;break e}c=c.parentNode}c=void 0}c=q1(c)}}function K1(s,i){return s&&i?s===i?!0:s&&s.nodeType===3?!1:i&&i.nodeType===3?K1(s,i.parentNode):"contains"in s?s.contains(i):s.compareDocumentPosition?!!(s.compareDocumentPosition(i)&16):!1:!1}function Y1(s){s=s!=null&&s.ownerDocument!=null&&s.ownerDocument.defaultView!=null?s.ownerDocument.defaultView:window;for(var i=Fo(s.document);i instanceof s.HTMLIFrameElement;){try{var c=typeof i.contentWindow.location.href=="string"}catch{c=!1}if(c)s=i.contentWindow;else break;i=Fo(s.document)}return i}function Mm(s){var i=s&&s.nodeName&&s.nodeName.toLowerCase();return i&&(i==="input"&&(s.type==="text"||s.type==="search"||s.type==="tel"||s.type==="url"||s.type==="password")||i==="textarea"||s.contentEditable==="true")}var c4=as&&"documentMode"in document&&11>=document.documentMode,Go=null,jm=null,du=null,Fm=!1;function $1(s,i,c){var f=c.window===c?c.document:c.nodeType===9?c:c.ownerDocument;Fm||Go==null||Go!==Fo(f)||(f=Go,"selectionStart"in f&&Mm(f)?f={start:f.selectionStart,end:f.selectionEnd}:(f=(f.ownerDocument&&f.ownerDocument.defaultView||window).getSelection(),f={anchorNode:f.anchorNode,anchorOffset:f.anchorOffset,focusNode:f.focusNode,focusOffset:f.focusOffset}),du&&hu(du,f)||(du=f,f=Ed(jm,"onSelect"),0<f.length&&(i=new jl("onSelect","select",null,i,c),s.push({event:i,listeners:f}),i.target=Go)))}function Bl(s,i){var c={};return c[s.toLowerCase()]=i.toLowerCase(),c["Webkit"+s]="webkit"+i,c["Moz"+s]="moz"+i,c}var qo={animationend:Bl("Animation","AnimationEnd"),animationiteration:Bl("Animation","AnimationIteration"),animationstart:Bl("Animation","AnimationStart"),transitionrun:Bl("Transition","TransitionRun"),transitionstart:Bl("Transition","TransitionStart"),transitioncancel:Bl("Transition","TransitionCancel"),transitionend:Bl("Transition","TransitionEnd")},Pm={},X1={};as&&(X1=document.createElement("div").style,"AnimationEvent"in window||(delete qo.animationend.animation,delete qo.animationiteration.animation,delete qo.animationstart.animation),"TransitionEvent"in window||delete qo.transitionend.transition);function Vl(s){if(Pm[s])return Pm[s];if(!qo[s])return s;var i=qo[s],c;for(c in i)if(i.hasOwnProperty(c)&&c in X1)return Pm[s]=i[c];return s}var Q1=Vl("animationend"),J1=Vl("animationiteration"),Z1=Vl("animationstart"),u4=Vl("transitionrun"),f4=Vl("transitionstart"),h4=Vl("transitioncancel"),ey=Vl("transitionend"),ty=new Map,Lm="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");Lm.push("scrollEnd");function ss(s,i){ty.set(s,i),At(i,[s])}var Fh=typeof reportError=="function"?reportError:function(s){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var i=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof s=="object"&&s!==null&&typeof s.message=="string"?String(s.message):String(s),error:s});if(!window.dispatchEvent(i))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",s);return}console.error(s)},Ba=[],Wo=0,Um=0;function Ph(){for(var s=Wo,i=Um=Wo=0;i<s;){var c=Ba[i];Ba[i++]=null;var f=Ba[i];Ba[i++]=null;var x=Ba[i];Ba[i++]=null;var y=Ba[i];if(Ba[i++]=null,f!==null&&x!==null){var C=f.pending;C===null?x.next=x:(x.next=C.next,C.next=x),f.pending=x}y!==0&&ry(c,x,y)}}function Lh(s,i,c,f){Ba[Wo++]=s,Ba[Wo++]=i,Ba[Wo++]=c,Ba[Wo++]=f,Um|=f,s.lanes|=f,s=s.alternate,s!==null&&(s.lanes|=f)}function Bm(s,i,c,f){return Lh(s,i,c,f),Uh(s)}function zl(s,i){return Lh(s,null,null,i),Uh(s)}function ry(s,i,c){s.lanes|=c;var f=s.alternate;f!==null&&(f.lanes|=c);for(var x=!1,y=s.return;y!==null;)y.childLanes|=c,f=y.alternate,f!==null&&(f.childLanes|=c),y.tag===22&&(s=y.stateNode,s===null||s._visibility&1||(x=!0)),s=y,y=y.return;return s.tag===3?(y=s.stateNode,x&&i!==null&&(x=31-Ur(c),s=y.hiddenUpdates,f=s[x],f===null?s[x]=[i]:f.push(i),i.lane=c|536870912),y):null}function Uh(s){if(50<ju)throw ju=0,$p=null,Error(n(185));for(var i=s.return;i!==null;)s=i,i=s.return;return s.tag===3?s.stateNode:null}var Ko={};function d4(s,i,c,f){this.tag=s,this.key=c,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=i,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=f,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function _a(s,i,c,f){return new d4(s,i,c,f)}function Vm(s){return s=s.prototype,!(!s||!s.isReactComponent)}function Ks(s,i){var c=s.alternate;return c===null?(c=_a(s.tag,i,s.key,s.mode),c.elementType=s.elementType,c.type=s.type,c.stateNode=s.stateNode,c.alternate=s,s.alternate=c):(c.pendingProps=i,c.type=s.type,c.flags=0,c.subtreeFlags=0,c.deletions=null),c.flags=s.flags&65011712,c.childLanes=s.childLanes,c.lanes=s.lanes,c.child=s.child,c.memoizedProps=s.memoizedProps,c.memoizedState=s.memoizedState,c.updateQueue=s.updateQueue,i=s.dependencies,c.dependencies=i===null?null:{lanes:i.lanes,firstContext:i.firstContext},c.sibling=s.sibling,c.index=s.index,c.ref=s.ref,c.refCleanup=s.refCleanup,c}function ny(s,i){s.flags&=65011714;var c=s.alternate;return c===null?(s.childLanes=0,s.lanes=i,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=c.childLanes,s.lanes=c.lanes,s.child=c.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=c.memoizedProps,s.memoizedState=c.memoizedState,s.updateQueue=c.updateQueue,s.type=c.type,i=c.dependencies,s.dependencies=i===null?null:{lanes:i.lanes,firstContext:i.firstContext}),s}function Bh(s,i,c,f,x,y){var C=0;if(f=s,typeof s=="function")Vm(s)&&(C=1);else if(typeof s=="string")C=vk(s,c,ee.current)?26:s==="html"||s==="head"||s==="body"?27:5;else e:switch(s){case k:return s=_a(31,c,i,x),s.elementType=k,s.lanes=y,s;case T:return Hl(c.children,x,y,i);case A:C=8,x|=24;break;case M:return s=_a(12,c,i,x|2),s.elementType=M,s.lanes=y,s;case re:return s=_a(13,c,i,x),s.elementType=re,s.lanes=y,s;case te:return s=_a(19,c,i,x),s.elementType=te,s.lanes=y,s;default:if(typeof s=="object"&&s!==null)switch(s.$$typeof){case R:C=10;break e;case F:C=9;break e;case z:C=11;break e;case b:C=14;break e;case N:C=16,f=null;break e}C=29,c=Error(n(130,s===null?"null":typeof s,"")),f=null}return i=_a(C,c,i,x),i.elementType=s,i.type=f,i.lanes=y,i}function Hl(s,i,c,f){return s=_a(7,s,f,i),s.lanes=c,s}function zm(s,i,c){return s=_a(6,s,null,i),s.lanes=c,s}function ay(s){var i=_a(18,null,null,0);return i.stateNode=s,i}function Hm(s,i,c){return i=_a(4,s.children!==null?s.children:[],s.key,i),i.lanes=c,i.stateNode={containerInfo:s.containerInfo,pendingChildren:null,implementation:s.implementation},i}var sy=new WeakMap;function Va(s,i){if(typeof s=="object"&&s!==null){var c=sy.get(s);return c!==void 0?c:(i={value:s,source:i,stack:ut(i)},sy.set(s,i),i)}return{value:s,source:i,stack:ut(i)}}var Yo=[],$o=0,Vh=null,mu=0,za=[],Ha=0,Pi=null,bs=1,Ss="";function Ys(s,i){Yo[$o++]=mu,Yo[$o++]=Vh,Vh=s,mu=i}function iy(s,i,c){za[Ha++]=bs,za[Ha++]=Ss,za[Ha++]=Pi,Pi=s;var f=bs;s=Ss;var x=32-Ur(f)-1;f&=~(1<<x),c+=1;var y=32-Ur(i)+x;if(30<y){var C=x-x%5;y=(f&(1<<C)-1).toString(32),f>>=C,x-=C,bs=1<<32-Ur(i)+x|c<<x|f,Ss=y+s}else bs=1<<y|c<<x|f,Ss=s}function Gm(s){s.return!==null&&(Ys(s,1),iy(s,1,0))}function qm(s){for(;s===Vh;)Vh=Yo[--$o],Yo[$o]=null,mu=Yo[--$o],Yo[$o]=null;for(;s===Pi;)Pi=za[--Ha],za[Ha]=null,Ss=za[--Ha],za[Ha]=null,bs=za[--Ha],za[Ha]=null}function ly(s,i){za[Ha++]=bs,za[Ha++]=Ss,za[Ha++]=Pi,bs=i.id,Ss=i.overflow,Pi=s}var pn=null,pr=null,Mt=!1,Li=null,Ga=!1,Wm=Error(n(519));function Ui(s){var i=Error(n(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw pu(Va(i,s)),Wm}function oy(s){var i=s.stateNode,c=s.type,f=s.memoizedProps;switch(i[H]=s,i[W]=f,c){case"dialog":Ct("cancel",i),Ct("close",i);break;case"iframe":case"object":case"embed":Ct("load",i);break;case"video":case"audio":for(c=0;c<Pu.length;c++)Ct(Pu[c],i);break;case"source":Ct("error",i);break;case"img":case"image":case"link":Ct("error",i),Ct("load",i);break;case"details":Ct("toggle",i);break;case"input":Ct("invalid",i),Il(i,f.value,f.defaultValue,f.checked,f.defaultChecked,f.type,f.name,!0);break;case"select":Ct("invalid",i);break;case"textarea":Ct("invalid",i),Ci(i,f.value,f.defaultValue,f.children)}c=f.children,typeof c!="string"&&typeof c!="number"&&typeof c!="bigint"||i.textContent===""+c||f.suppressHydrationWarning===!0||Sw(i.textContent,c)?(f.popover!=null&&(Ct("beforetoggle",i),Ct("toggle",i)),f.onScroll!=null&&Ct("scroll",i),f.onScrollEnd!=null&&Ct("scrollend",i),f.onClick!=null&&(i.onclick=sn),i=!0):i=!1,i||Ui(s,!0)}function cy(s){for(pn=s.return;pn;)switch(pn.tag){case 5:case 31:case 13:Ga=!1;return;case 27:case 3:Ga=!0;return;default:pn=pn.return}}function Xo(s){if(s!==pn)return!1;if(!Mt)return cy(s),Mt=!0,!1;var i=s.tag,c;if((c=i!==3&&i!==27)&&((c=i===5)&&(c=s.type,c=!(c!=="form"&&c!=="button")||ug(s.type,s.memoizedProps)),c=!c),c&&pr&&Ui(s),cy(s),i===13){if(s=s.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(n(317));pr=Mw(s)}else if(i===31){if(s=s.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(n(317));pr=Mw(s)}else i===27?(i=pr,Zi(s.type)?(s=pg,pg=null,pr=s):pr=i):pr=pn?Wa(s.stateNode.nextSibling):null;return!0}function Gl(){pr=pn=null,Mt=!1}function Km(){var s=Li;return s!==null&&(ua===null?ua=s:ua.push.apply(ua,s),Li=null),s}function pu(s){Li===null?Li=[s]:Li.push(s)}var Ym=Q(null),ql=null,$s=null;function Bi(s,i,c){Z(Ym,i._currentValue),i._currentValue=c}function Xs(s){s._currentValue=Ym.current,I(Ym)}function $m(s,i,c){for(;s!==null;){var f=s.alternate;if((s.childLanes&i)!==i?(s.childLanes|=i,f!==null&&(f.childLanes|=i)):f!==null&&(f.childLanes&i)!==i&&(f.childLanes|=i),s===c)break;s=s.return}}function Xm(s,i,c,f){var x=s.child;for(x!==null&&(x.return=s);x!==null;){var y=x.dependencies;if(y!==null){var C=x.child;y=y.firstContext;e:for(;y!==null;){var G=y;y=x;for(var ie=0;ie<i.length;ie++)if(G.context===i[ie]){y.lanes|=c,G=y.alternate,G!==null&&(G.lanes|=c),$m(y.return,c,s),f||(C=null);break e}y=G.next}}else if(x.tag===18){if(C=x.return,C===null)throw Error(n(341));C.lanes|=c,y=C.alternate,y!==null&&(y.lanes|=c),$m(C,c,s),C=null}else C=x.child;if(C!==null)C.return=x;else for(C=x;C!==null;){if(C===s){C=null;break}if(x=C.sibling,x!==null){x.return=C.return,C=x;break}C=C.return}x=C}}function Qo(s,i,c,f){s=null;for(var x=i,y=!1;x!==null;){if(!y){if((x.flags&524288)!==0)y=!0;else if((x.flags&262144)!==0)break}if(x.tag===10){var C=x.alternate;if(C===null)throw Error(n(387));if(C=C.memoizedProps,C!==null){var G=x.type;ya(x.pendingProps.value,C.value)||(s!==null?s.push(G):s=[G])}}else if(x===_e.current){if(C=x.alternate,C===null)throw Error(n(387));C.memoizedState.memoizedState!==x.memoizedState.memoizedState&&(s!==null?s.push(zu):s=[zu])}x=x.return}s!==null&&Xm(i,s,c,f),i.flags|=262144}function zh(s){for(s=s.firstContext;s!==null;){if(!ya(s.context._currentValue,s.memoizedValue))return!0;s=s.next}return!1}function Wl(s){ql=s,$s=null,s=s.dependencies,s!==null&&(s.firstContext=null)}function gn(s){return uy(ql,s)}function Hh(s,i){return ql===null&&Wl(s),uy(s,i)}function uy(s,i){var c=i._currentValue;if(i={context:i,memoizedValue:c,next:null},$s===null){if(s===null)throw Error(n(308));$s=i,s.dependencies={lanes:0,firstContext:i},s.flags|=524288}else $s=$s.next=i;return c}var m4=typeof AbortController<"u"?AbortController:function(){var s=[],i=this.signal={aborted:!1,addEventListener:function(c,f){s.push(f)}};this.abort=function(){i.aborted=!0,s.forEach(function(c){return c()})}},p4=t.unstable_scheduleCallback,g4=t.unstable_NormalPriority,zr={$$typeof:R,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Qm(){return{controller:new m4,data:new Map,refCount:0}}function gu(s){s.refCount--,s.refCount===0&&p4(g4,function(){s.controller.abort()})}var xu=null,Jm=0,Jo=0,Zo=null;function x4(s,i){if(xu===null){var c=xu=[];Jm=0,Jo=tg(),Zo={status:"pending",value:void 0,then:function(f){c.push(f)}}}return Jm++,i.then(fy,fy),i}function fy(){if(--Jm===0&&xu!==null){Zo!==null&&(Zo.status="fulfilled");var s=xu;xu=null,Jo=0,Zo=null;for(var i=0;i<s.length;i++)(0,s[i])()}}function v4(s,i){var c=[],f={status:"pending",value:null,reason:null,then:function(x){c.push(x)}};return s.then(function(){f.status="fulfilled",f.value=i;for(var x=0;x<c.length;x++)(0,c[x])(i)},function(x){for(f.status="rejected",f.reason=x,x=0;x<c.length;x++)(0,c[x])(void 0)}),f}var hy=ae.S;ae.S=function(s,i){$_=pt(),typeof i=="object"&&i!==null&&typeof i.then=="function"&&x4(s,i),hy!==null&&hy(s,i)};var Kl=Q(null);function Zm(){var s=Kl.current;return s!==null?s:cr.pooledCache}function Gh(s,i){i===null?Z(Kl,Kl.current):Z(Kl,i.pool)}function dy(){var s=Zm();return s===null?null:{parent:zr._currentValue,pool:s}}var ec=Error(n(460)),ep=Error(n(474)),qh=Error(n(542)),Wh={then:function(){}};function my(s){return s=s.status,s==="fulfilled"||s==="rejected"}function py(s,i,c){switch(c=s[c],c===void 0?s.push(i):c!==i&&(i.then(sn,sn),i=c),i.status){case"fulfilled":return i.value;case"rejected":throw s=i.reason,xy(s),s;default:if(typeof i.status=="string")i.then(sn,sn);else{if(s=cr,s!==null&&100<s.shellSuspendCounter)throw Error(n(482));s=i,s.status="pending",s.then(function(f){if(i.status==="pending"){var x=i;x.status="fulfilled",x.value=f}},function(f){if(i.status==="pending"){var x=i;x.status="rejected",x.reason=f}})}switch(i.status){case"fulfilled":return i.value;case"rejected":throw s=i.reason,xy(s),s}throw $l=i,ec}}function Yl(s){try{var i=s._init;return i(s._payload)}catch(c){throw c!==null&&typeof c=="object"&&typeof c.then=="function"?($l=c,ec):c}}var $l=null;function gy(){if($l===null)throw Error(n(459));var s=$l;return $l=null,s}function xy(s){if(s===ec||s===qh)throw Error(n(483))}var tc=null,vu=0;function Kh(s){var i=vu;return vu+=1,tc===null&&(tc=[]),py(tc,s,i)}function yu(s,i){i=i.props.ref,s.ref=i!==void 0?i:null}function Yh(s,i){throw i.$$typeof===_?Error(n(525)):(s=Object.prototype.toString.call(i),Error(n(31,s==="[object Object]"?"object with keys {"+Object.keys(i).join(", ")+"}":s)))}function vy(s){function i(ge,ce){if(s){var Te=ge.deletions;Te===null?(ge.deletions=[ce],ge.flags|=16):Te.push(ce)}}function c(ge,ce){if(!s)return null;for(;ce!==null;)i(ge,ce),ce=ce.sibling;return null}function f(ge){for(var ce=new Map;ge!==null;)ge.key!==null?ce.set(ge.key,ge):ce.set(ge.index,ge),ge=ge.sibling;return ce}function x(ge,ce){return ge=Ks(ge,ce),ge.index=0,ge.sibling=null,ge}function y(ge,ce,Te){return ge.index=Te,s?(Te=ge.alternate,Te!==null?(Te=Te.index,Te<ce?(ge.flags|=67108866,ce):Te):(ge.flags|=67108866,ce)):(ge.flags|=1048576,ce)}function C(ge){return s&&ge.alternate===null&&(ge.flags|=67108866),ge}function G(ge,ce,Te,Me){return ce===null||ce.tag!==6?(ce=zm(Te,ge.mode,Me),ce.return=ge,ce):(ce=x(ce,Te),ce.return=ge,ce)}function ie(ge,ce,Te,Me){var nt=Te.type;return nt===T?Ie(ge,ce,Te.props.children,Me,Te.key):ce!==null&&(ce.elementType===nt||typeof nt=="object"&&nt!==null&&nt.$$typeof===N&&Yl(nt)===ce.type)?(ce=x(ce,Te.props),yu(ce,Te),ce.return=ge,ce):(ce=Bh(Te.type,Te.key,Te.props,null,ge.mode,Me),yu(ce,Te),ce.return=ge,ce)}function Ee(ge,ce,Te,Me){return ce===null||ce.tag!==4||ce.stateNode.containerInfo!==Te.containerInfo||ce.stateNode.implementation!==Te.implementation?(ce=Hm(Te,ge.mode,Me),ce.return=ge,ce):(ce=x(ce,Te.children||[]),ce.return=ge,ce)}function Ie(ge,ce,Te,Me,nt){return ce===null||ce.tag!==7?(ce=Hl(Te,ge.mode,Me,nt),ce.return=ge,ce):(ce=x(ce,Te),ce.return=ge,ce)}function je(ge,ce,Te){if(typeof ce=="string"&&ce!==""||typeof ce=="number"||typeof ce=="bigint")return ce=zm(""+ce,ge.mode,Te),ce.return=ge,ce;if(typeof ce=="object"&&ce!==null){switch(ce.$$typeof){case w:return Te=Bh(ce.type,ce.key,ce.props,null,ge.mode,Te),yu(Te,ce),Te.return=ge,Te;case E:return ce=Hm(ce,ge.mode,Te),ce.return=ge,ce;case N:return ce=Yl(ce),je(ge,ce,Te)}if(Ne(ce)||P(ce))return ce=Hl(ce,ge.mode,Te,null),ce.return=ge,ce;if(typeof ce.then=="function")return je(ge,Kh(ce),Te);if(ce.$$typeof===R)return je(ge,Hh(ge,ce),Te);Yh(ge,ce)}return null}function Se(ge,ce,Te,Me){var nt=ce!==null?ce.key:null;if(typeof Te=="string"&&Te!==""||typeof Te=="number"||typeof Te=="bigint")return nt!==null?null:G(ge,ce,""+Te,Me);if(typeof Te=="object"&&Te!==null){switch(Te.$$typeof){case w:return Te.key===nt?ie(ge,ce,Te,Me):null;case E:return Te.key===nt?Ee(ge,ce,Te,Me):null;case N:return Te=Yl(Te),Se(ge,ce,Te,Me)}if(Ne(Te)||P(Te))return nt!==null?null:Ie(ge,ce,Te,Me,null);if(typeof Te.then=="function")return Se(ge,ce,Kh(Te),Me);if(Te.$$typeof===R)return Se(ge,ce,Hh(ge,Te),Me);Yh(ge,Te)}return null}function ke(ge,ce,Te,Me,nt){if(typeof Me=="string"&&Me!==""||typeof Me=="number"||typeof Me=="bigint")return ge=ge.get(Te)||null,G(ce,ge,""+Me,nt);if(typeof Me=="object"&&Me!==null){switch(Me.$$typeof){case w:return ge=ge.get(Me.key===null?Te:Me.key)||null,ie(ce,ge,Me,nt);case E:return ge=ge.get(Me.key===null?Te:Me.key)||null,Ee(ce,ge,Me,nt);case N:return Me=Yl(Me),ke(ge,ce,Te,Me,nt)}if(Ne(Me)||P(Me))return ge=ge.get(Te)||null,Ie(ce,ge,Me,nt,null);if(typeof Me.then=="function")return ke(ge,ce,Te,Kh(Me),nt);if(Me.$$typeof===R)return ke(ge,ce,Te,Hh(ce,Me),nt);Yh(ce,Me)}return null}function Ze(ge,ce,Te,Me){for(var nt=null,Wt=null,tt=ce,_t=ce=0,It=null;tt!==null&&_t<Te.length;_t++){tt.index>_t?(It=tt,tt=null):It=tt.sibling;var Kt=Se(ge,tt,Te[_t],Me);if(Kt===null){tt===null&&(tt=It);break}s&&tt&&Kt.alternate===null&&i(ge,tt),ce=y(Kt,ce,_t),Wt===null?nt=Kt:Wt.sibling=Kt,Wt=Kt,tt=It}if(_t===Te.length)return c(ge,tt),Mt&&Ys(ge,_t),nt;if(tt===null){for(;_t<Te.length;_t++)tt=je(ge,Te[_t],Me),tt!==null&&(ce=y(tt,ce,_t),Wt===null?nt=tt:Wt.sibling=tt,Wt=tt);return Mt&&Ys(ge,_t),nt}for(tt=f(tt);_t<Te.length;_t++)It=ke(tt,ge,_t,Te[_t],Me),It!==null&&(s&&It.alternate!==null&&tt.delete(It.key===null?_t:It.key),ce=y(It,ce,_t),Wt===null?nt=It:Wt.sibling=It,Wt=It);return s&&tt.forEach(function(al){return i(ge,al)}),Mt&&Ys(ge,_t),nt}function st(ge,ce,Te,Me){if(Te==null)throw Error(n(151));for(var nt=null,Wt=null,tt=ce,_t=ce=0,It=null,Kt=Te.next();tt!==null&&!Kt.done;_t++,Kt=Te.next()){tt.index>_t?(It=tt,tt=null):It=tt.sibling;var al=Se(ge,tt,Kt.value,Me);if(al===null){tt===null&&(tt=It);break}s&&tt&&al.alternate===null&&i(ge,tt),ce=y(al,ce,_t),Wt===null?nt=al:Wt.sibling=al,Wt=al,tt=It}if(Kt.done)return c(ge,tt),Mt&&Ys(ge,_t),nt;if(tt===null){for(;!Kt.done;_t++,Kt=Te.next())Kt=je(ge,Kt.value,Me),Kt!==null&&(ce=y(Kt,ce,_t),Wt===null?nt=Kt:Wt.sibling=Kt,Wt=Kt);return Mt&&Ys(ge,_t),nt}for(tt=f(tt);!Kt.done;_t++,Kt=Te.next())Kt=ke(tt,ge,_t,Kt.value,Me),Kt!==null&&(s&&Kt.alternate!==null&&tt.delete(Kt.key===null?_t:Kt.key),ce=y(Kt,ce,_t),Wt===null?nt=Kt:Wt.sibling=Kt,Wt=Kt);return s&&tt.forEach(function(kk){return i(ge,kk)}),Mt&&Ys(ge,_t),nt}function lr(ge,ce,Te,Me){if(typeof Te=="object"&&Te!==null&&Te.type===T&&Te.key===null&&(Te=Te.props.children),typeof Te=="object"&&Te!==null){switch(Te.$$typeof){case w:e:{for(var nt=Te.key;ce!==null;){if(ce.key===nt){if(nt=Te.type,nt===T){if(ce.tag===7){c(ge,ce.sibling),Me=x(ce,Te.props.children),Me.return=ge,ge=Me;break e}}else if(ce.elementType===nt||typeof nt=="object"&&nt!==null&&nt.$$typeof===N&&Yl(nt)===ce.type){c(ge,ce.sibling),Me=x(ce,Te.props),yu(Me,Te),Me.return=ge,ge=Me;break e}c(ge,ce);break}else i(ge,ce);ce=ce.sibling}Te.type===T?(Me=Hl(Te.props.children,ge.mode,Me,Te.key),Me.return=ge,ge=Me):(Me=Bh(Te.type,Te.key,Te.props,null,ge.mode,Me),yu(Me,Te),Me.return=ge,ge=Me)}return C(ge);case E:e:{for(nt=Te.key;ce!==null;){if(ce.key===nt)if(ce.tag===4&&ce.stateNode.containerInfo===Te.containerInfo&&ce.stateNode.implementation===Te.implementation){c(ge,ce.sibling),Me=x(ce,Te.children||[]),Me.return=ge,ge=Me;break e}else{c(ge,ce);break}else i(ge,ce);ce=ce.sibling}Me=Hm(Te,ge.mode,Me),Me.return=ge,ge=Me}return C(ge);case N:return Te=Yl(Te),lr(ge,ce,Te,Me)}if(Ne(Te))return Ze(ge,ce,Te,Me);if(P(Te)){if(nt=P(Te),typeof nt!="function")throw Error(n(150));return Te=nt.call(Te),st(ge,ce,Te,Me)}if(typeof Te.then=="function")return lr(ge,ce,Kh(Te),Me);if(Te.$$typeof===R)return lr(ge,ce,Hh(ge,Te),Me);Yh(ge,Te)}return typeof Te=="string"&&Te!==""||typeof Te=="number"||typeof Te=="bigint"?(Te=""+Te,ce!==null&&ce.tag===6?(c(ge,ce.sibling),Me=x(ce,Te),Me.return=ge,ge=Me):(c(ge,ce),Me=zm(Te,ge.mode,Me),Me.return=ge,ge=Me),C(ge)):c(ge,ce)}return function(ge,ce,Te,Me){try{vu=0;var nt=lr(ge,ce,Te,Me);return tc=null,nt}catch(tt){if(tt===ec||tt===qh)throw tt;var Wt=_a(29,tt,null,ge.mode);return Wt.lanes=Me,Wt.return=ge,Wt}finally{}}}var Xl=vy(!0),yy=vy(!1),Vi=!1;function tp(s){s.updateQueue={baseState:s.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function rp(s,i){s=s.updateQueue,i.updateQueue===s&&(i.updateQueue={baseState:s.baseState,firstBaseUpdate:s.firstBaseUpdate,lastBaseUpdate:s.lastBaseUpdate,shared:s.shared,callbacks:null})}function zi(s){return{lane:s,tag:0,payload:null,callback:null,next:null}}function Hi(s,i,c){var f=s.updateQueue;if(f===null)return null;if(f=f.shared,(Xt&2)!==0){var x=f.pending;return x===null?i.next=i:(i.next=x.next,x.next=i),f.pending=i,i=Uh(s),ry(s,null,c),i}return Lh(s,f,i,c),Uh(s)}function _u(s,i,c){if(i=i.updateQueue,i!==null&&(i=i.shared,(c&4194048)!==0)){var f=i.lanes;f&=s.pendingLanes,c|=f,i.lanes=c,de(s,c)}}function np(s,i){var c=s.updateQueue,f=s.alternate;if(f!==null&&(f=f.updateQueue,c===f)){var x=null,y=null;if(c=c.firstBaseUpdate,c!==null){do{var C={lane:c.lane,tag:c.tag,payload:c.payload,callback:null,next:null};y===null?x=y=C:y=y.next=C,c=c.next}while(c!==null);y===null?x=y=i:y=y.next=i}else x=y=i;c={baseState:f.baseState,firstBaseUpdate:x,lastBaseUpdate:y,shared:f.shared,callbacks:f.callbacks},s.updateQueue=c;return}s=c.lastBaseUpdate,s===null?c.firstBaseUpdate=i:s.next=i,c.lastBaseUpdate=i}var ap=!1;function wu(){if(ap){var s=Zo;if(s!==null)throw s}}function Tu(s,i,c,f){ap=!1;var x=s.updateQueue;Vi=!1;var y=x.firstBaseUpdate,C=x.lastBaseUpdate,G=x.shared.pending;if(G!==null){x.shared.pending=null;var ie=G,Ee=ie.next;ie.next=null,C===null?y=Ee:C.next=Ee,C=ie;var Ie=s.alternate;Ie!==null&&(Ie=Ie.updateQueue,G=Ie.lastBaseUpdate,G!==C&&(G===null?Ie.firstBaseUpdate=Ee:G.next=Ee,Ie.lastBaseUpdate=ie))}if(y!==null){var je=x.baseState;C=0,Ie=Ee=ie=null,G=y;do{var Se=G.lane&-536870913,ke=Se!==G.lane;if(ke?(Dt&Se)===Se:(f&Se)===Se){Se!==0&&Se===Jo&&(ap=!0),Ie!==null&&(Ie=Ie.next={lane:0,tag:G.tag,payload:G.payload,callback:null,next:null});e:{var Ze=s,st=G;Se=i;var lr=c;switch(st.tag){case 1:if(Ze=st.payload,typeof Ze=="function"){je=Ze.call(lr,je,Se);break e}je=Ze;break e;case 3:Ze.flags=Ze.flags&-65537|128;case 0:if(Ze=st.payload,Se=typeof Ze=="function"?Ze.call(lr,je,Se):Ze,Se==null)break e;je=v({},je,Se);break e;case 2:Vi=!0}}Se=G.callback,Se!==null&&(s.flags|=64,ke&&(s.flags|=8192),ke=x.callbacks,ke===null?x.callbacks=[Se]:ke.push(Se))}else ke={lane:Se,tag:G.tag,payload:G.payload,callback:G.callback,next:null},Ie===null?(Ee=Ie=ke,ie=je):Ie=Ie.next=ke,C|=Se;if(G=G.next,G===null){if(G=x.shared.pending,G===null)break;ke=G,G=ke.next,ke.next=null,x.lastBaseUpdate=ke,x.shared.pending=null}}while(!0);Ie===null&&(ie=je),x.baseState=ie,x.firstBaseUpdate=Ee,x.lastBaseUpdate=Ie,y===null&&(x.shared.lanes=0),Yi|=C,s.lanes=C,s.memoizedState=je}}function _y(s,i){if(typeof s!="function")throw Error(n(191,s));s.call(i)}function wy(s,i){var c=s.callbacks;if(c!==null)for(s.callbacks=null,s=0;s<c.length;s++)_y(c[s],i)}var rc=Q(null),$h=Q(0);function Ty(s,i){s=si,Z($h,s),Z(rc,i),si=s|i.baseLanes}function sp(){Z($h,si),Z(rc,rc.current)}function ip(){si=$h.current,I(rc),I($h)}var wa=Q(null),qa=null;function Gi(s){var i=s.alternate;Z(jr,jr.current&1),Z(wa,s),qa===null&&(i===null||rc.current!==null||i.memoizedState!==null)&&(qa=s)}function lp(s){Z(jr,jr.current),Z(wa,s),qa===null&&(qa=s)}function Ey(s){s.tag===22?(Z(jr,jr.current),Z(wa,s),qa===null&&(qa=s)):qi()}function qi(){Z(jr,jr.current),Z(wa,wa.current)}function Ta(s){I(wa),qa===s&&(qa=null),I(jr)}var jr=Q(0);function Xh(s){for(var i=s;i!==null;){if(i.tag===13){var c=i.memoizedState;if(c!==null&&(c=c.dehydrated,c===null||dg(c)||mg(c)))return i}else if(i.tag===19&&(i.memoizedProps.revealOrder==="forwards"||i.memoizedProps.revealOrder==="backwards"||i.memoizedProps.revealOrder==="unstable_legacy-backwards"||i.memoizedProps.revealOrder==="together")){if((i.flags&128)!==0)return i}else if(i.child!==null){i.child.return=i,i=i.child;continue}if(i===s)break;for(;i.sibling===null;){if(i.return===null||i.return===s)return null;i=i.return}i.sibling.return=i.return,i=i.sibling}return null}var Qs=0,vt=null,sr=null,Hr=null,Qh=!1,nc=!1,Ql=!1,Jh=0,Eu=0,ac=null,y4=0;function Nr(){throw Error(n(321))}function op(s,i){if(i===null)return!1;for(var c=0;c<i.length&&c<s.length;c++)if(!ya(s[c],i[c]))return!1;return!0}function cp(s,i,c,f,x,y){return Qs=y,vt=i,i.memoizedState=null,i.updateQueue=null,i.lanes=0,ae.H=s===null||s.memoizedState===null?i_:bp,Ql=!1,y=c(f,x),Ql=!1,nc&&(y=Sy(i,c,f,x)),by(s),y}function by(s){ae.H=Au;var i=sr!==null&&sr.next!==null;if(Qs=0,Hr=sr=vt=null,Qh=!1,Eu=0,ac=null,i)throw Error(n(300));s===null||Gr||(s=s.dependencies,s!==null&&zh(s)&&(Gr=!0))}function Sy(s,i,c,f){vt=s;var x=0;do{if(nc&&(ac=null),Eu=0,nc=!1,25<=x)throw Error(n(301));if(x+=1,Hr=sr=null,s.updateQueue!=null){var y=s.updateQueue;y.lastEffect=null,y.events=null,y.stores=null,y.memoCache!=null&&(y.memoCache.index=0)}ae.H=l_,y=i(c,f)}while(nc);return y}function _4(){var s=ae.H,i=s.useState()[0];return i=typeof i.then=="function"?bu(i):i,s=s.useState()[0],(sr!==null?sr.memoizedState:null)!==s&&(vt.flags|=1024),i}function up(){var s=Jh!==0;return Jh=0,s}function fp(s,i,c){i.updateQueue=s.updateQueue,i.flags&=-2053,s.lanes&=~c}function hp(s){if(Qh){for(s=s.memoizedState;s!==null;){var i=s.queue;i!==null&&(i.pending=null),s=s.next}Qh=!1}Qs=0,Hr=sr=vt=null,nc=!1,Eu=Jh=0,ac=null}function Yn(){var s={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Hr===null?vt.memoizedState=Hr=s:Hr=Hr.next=s,Hr}function Fr(){if(sr===null){var s=vt.alternate;s=s!==null?s.memoizedState:null}else s=sr.next;var i=Hr===null?vt.memoizedState:Hr.next;if(i!==null)Hr=i,sr=s;else{if(s===null)throw vt.alternate===null?Error(n(467)):Error(n(310));sr=s,s={memoizedState:sr.memoizedState,baseState:sr.baseState,baseQueue:sr.baseQueue,queue:sr.queue,next:null},Hr===null?vt.memoizedState=Hr=s:Hr=Hr.next=s}return Hr}function Zh(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function bu(s){var i=Eu;return Eu+=1,ac===null&&(ac=[]),s=py(ac,s,i),i=vt,(Hr===null?i.memoizedState:Hr.next)===null&&(i=i.alternate,ae.H=i===null||i.memoizedState===null?i_:bp),s}function ed(s){if(s!==null&&typeof s=="object"){if(typeof s.then=="function")return bu(s);if(s.$$typeof===R)return gn(s)}throw Error(n(438,String(s)))}function dp(s){var i=null,c=vt.updateQueue;if(c!==null&&(i=c.memoCache),i==null){var f=vt.alternate;f!==null&&(f=f.updateQueue,f!==null&&(f=f.memoCache,f!=null&&(i={data:f.data.map(function(x){return x.slice()}),index:0})))}if(i==null&&(i={data:[],index:0}),c===null&&(c=Zh(),vt.updateQueue=c),c.memoCache=i,c=i.data[i.index],c===void 0)for(c=i.data[i.index]=Array(s),f=0;f<s;f++)c[f]=j;return i.index++,c}function Js(s,i){return typeof i=="function"?i(s):i}function td(s){var i=Fr();return mp(i,sr,s)}function mp(s,i,c){var f=s.queue;if(f===null)throw Error(n(311));f.lastRenderedReducer=c;var x=s.baseQueue,y=f.pending;if(y!==null){if(x!==null){var C=x.next;x.next=y.next,y.next=C}i.baseQueue=x=y,f.pending=null}if(y=s.baseState,x===null)s.memoizedState=y;else{i=x.next;var G=C=null,ie=null,Ee=i,Ie=!1;do{var je=Ee.lane&-536870913;if(je!==Ee.lane?(Dt&je)===je:(Qs&je)===je){var Se=Ee.revertLane;if(Se===0)ie!==null&&(ie=ie.next={lane:0,revertLane:0,gesture:null,action:Ee.action,hasEagerState:Ee.hasEagerState,eagerState:Ee.eagerState,next:null}),je===Jo&&(Ie=!0);else if((Qs&Se)===Se){Ee=Ee.next,Se===Jo&&(Ie=!0);continue}else je={lane:0,revertLane:Ee.revertLane,gesture:null,action:Ee.action,hasEagerState:Ee.hasEagerState,eagerState:Ee.eagerState,next:null},ie===null?(G=ie=je,C=y):ie=ie.next=je,vt.lanes|=Se,Yi|=Se;je=Ee.action,Ql&&c(y,je),y=Ee.hasEagerState?Ee.eagerState:c(y,je)}else Se={lane:je,revertLane:Ee.revertLane,gesture:Ee.gesture,action:Ee.action,hasEagerState:Ee.hasEagerState,eagerState:Ee.eagerState,next:null},ie===null?(G=ie=Se,C=y):ie=ie.next=Se,vt.lanes|=je,Yi|=je;Ee=Ee.next}while(Ee!==null&&Ee!==i);if(ie===null?C=y:ie.next=G,!ya(y,s.memoizedState)&&(Gr=!0,Ie&&(c=Zo,c!==null)))throw c;s.memoizedState=y,s.baseState=C,s.baseQueue=ie,f.lastRenderedState=y}return x===null&&(f.lanes=0),[s.memoizedState,f.dispatch]}function pp(s){var i=Fr(),c=i.queue;if(c===null)throw Error(n(311));c.lastRenderedReducer=s;var f=c.dispatch,x=c.pending,y=i.memoizedState;if(x!==null){c.pending=null;var C=x=x.next;do y=s(y,C.action),C=C.next;while(C!==x);ya(y,i.memoizedState)||(Gr=!0),i.memoizedState=y,i.baseQueue===null&&(i.baseState=y),c.lastRenderedState=y}return[y,f]}function Ay(s,i,c){var f=vt,x=Fr(),y=Mt;if(y){if(c===void 0)throw Error(n(407));c=c()}else c=i();var C=!ya((sr||x).memoizedState,c);if(C&&(x.memoizedState=c,Gr=!0),x=x.queue,vp(ky.bind(null,f,x,s),[s]),x.getSnapshot!==i||C||Hr!==null&&Hr.memoizedState.tag&1){if(f.flags|=2048,sc(9,{destroy:void 0},Cy.bind(null,f,x,c,i),null),cr===null)throw Error(n(349));y||(Qs&127)!==0||Ny(f,i,c)}return c}function Ny(s,i,c){s.flags|=16384,s={getSnapshot:i,value:c},i=vt.updateQueue,i===null?(i=Zh(),vt.updateQueue=i,i.stores=[s]):(c=i.stores,c===null?i.stores=[s]:c.push(s))}function Cy(s,i,c,f){i.value=c,i.getSnapshot=f,Ry(i)&&Dy(s)}function ky(s,i,c){return c(function(){Ry(i)&&Dy(s)})}function Ry(s){var i=s.getSnapshot;s=s.value;try{var c=i();return!ya(s,c)}catch{return!0}}function Dy(s){var i=zl(s,2);i!==null&&fa(i,s,2)}function gp(s){var i=Yn();if(typeof s=="function"){var c=s;if(s=c(),Ql){nn(!0);try{c()}finally{nn(!1)}}}return i.memoizedState=i.baseState=s,i.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Js,lastRenderedState:s},i}function Iy(s,i,c,f){return s.baseState=c,mp(s,sr,typeof f=="function"?f:Js)}function w4(s,i,c,f,x){if(ad(s))throw Error(n(485));if(s=i.action,s!==null){var y={payload:x,action:s,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(C){y.listeners.push(C)}};ae.T!==null?c(!0):y.isTransition=!1,f(y),c=i.pending,c===null?(y.next=i.pending=y,Oy(i,y)):(y.next=c.next,i.pending=c.next=y)}}function Oy(s,i){var c=i.action,f=i.payload,x=s.state;if(i.isTransition){var y=ae.T,C={};ae.T=C;try{var G=c(x,f),ie=ae.S;ie!==null&&ie(C,G),My(s,i,G)}catch(Ee){xp(s,i,Ee)}finally{y!==null&&C.types!==null&&(y.types=C.types),ae.T=y}}else try{y=c(x,f),My(s,i,y)}catch(Ee){xp(s,i,Ee)}}function My(s,i,c){c!==null&&typeof c=="object"&&typeof c.then=="function"?c.then(function(f){jy(s,i,f)},function(f){return xp(s,i,f)}):jy(s,i,c)}function jy(s,i,c){i.status="fulfilled",i.value=c,Fy(i),s.state=c,i=s.pending,i!==null&&(c=i.next,c===i?s.pending=null:(c=c.next,i.next=c,Oy(s,c)))}function xp(s,i,c){var f=s.pending;if(s.pending=null,f!==null){f=f.next;do i.status="rejected",i.reason=c,Fy(i),i=i.next;while(i!==f)}s.action=null}function Fy(s){s=s.listeners;for(var i=0;i<s.length;i++)(0,s[i])()}function Py(s,i){return i}function Ly(s,i){if(Mt){var c=cr.formState;if(c!==null){e:{var f=vt;if(Mt){if(pr){t:{for(var x=pr,y=Ga;x.nodeType!==8;){if(!y){x=null;break t}if(x=Wa(x.nextSibling),x===null){x=null;break t}}y=x.data,x=y==="F!"||y==="F"?x:null}if(x){pr=Wa(x.nextSibling),f=x.data==="F!";break e}}Ui(f)}f=!1}f&&(i=c[0])}}return c=Yn(),c.memoizedState=c.baseState=i,f={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Py,lastRenderedState:i},c.queue=f,c=n_.bind(null,vt,f),f.dispatch=c,f=gp(!1),y=Ep.bind(null,vt,!1,f.queue),f=Yn(),x={state:i,dispatch:null,action:s,pending:null},f.queue=x,c=w4.bind(null,vt,x,y,c),x.dispatch=c,f.memoizedState=s,[i,c,!1]}function Uy(s){var i=Fr();return By(i,sr,s)}function By(s,i,c){if(i=mp(s,i,Py)[0],s=td(Js)[0],typeof i=="object"&&i!==null&&typeof i.then=="function")try{var f=bu(i)}catch(C){throw C===ec?qh:C}else f=i;i=Fr();var x=i.queue,y=x.dispatch;return c!==i.memoizedState&&(vt.flags|=2048,sc(9,{destroy:void 0},T4.bind(null,x,c),null)),[f,y,s]}function T4(s,i){s.action=i}function Vy(s){var i=Fr(),c=sr;if(c!==null)return By(i,c,s);Fr(),i=i.memoizedState,c=Fr();var f=c.queue.dispatch;return c.memoizedState=s,[i,f,!1]}function sc(s,i,c,f){return s={tag:s,create:c,deps:f,inst:i,next:null},i=vt.updateQueue,i===null&&(i=Zh(),vt.updateQueue=i),c=i.lastEffect,c===null?i.lastEffect=s.next=s:(f=c.next,c.next=s,s.next=f,i.lastEffect=s),s}function zy(){return Fr().memoizedState}function rd(s,i,c,f){var x=Yn();vt.flags|=s,x.memoizedState=sc(1|i,{destroy:void 0},c,f===void 0?null:f)}function nd(s,i,c,f){var x=Fr();f=f===void 0?null:f;var y=x.memoizedState.inst;sr!==null&&f!==null&&op(f,sr.memoizedState.deps)?x.memoizedState=sc(i,y,c,f):(vt.flags|=s,x.memoizedState=sc(1|i,y,c,f))}function Hy(s,i){rd(8390656,8,s,i)}function vp(s,i){nd(2048,8,s,i)}function E4(s){vt.flags|=4;var i=vt.updateQueue;if(i===null)i=Zh(),vt.updateQueue=i,i.events=[s];else{var c=i.events;c===null?i.events=[s]:c.push(s)}}function Gy(s){var i=Fr().memoizedState;return E4({ref:i,nextImpl:s}),function(){if((Xt&2)!==0)throw Error(n(440));return i.impl.apply(void 0,arguments)}}function qy(s,i){return nd(4,2,s,i)}function Wy(s,i){return nd(4,4,s,i)}function Ky(s,i){if(typeof i=="function"){s=s();var c=i(s);return function(){typeof c=="function"?c():i(null)}}if(i!=null)return s=s(),i.current=s,function(){i.current=null}}function Yy(s,i,c){c=c!=null?c.concat([s]):null,nd(4,4,Ky.bind(null,i,s),c)}function yp(){}function $y(s,i){var c=Fr();i=i===void 0?null:i;var f=c.memoizedState;return i!==null&&op(i,f[1])?f[0]:(c.memoizedState=[s,i],s)}function Xy(s,i){var c=Fr();i=i===void 0?null:i;var f=c.memoizedState;if(i!==null&&op(i,f[1]))return f[0];if(f=s(),Ql){nn(!0);try{s()}finally{nn(!1)}}return c.memoizedState=[f,i],f}function _p(s,i,c){return c===void 0||(Qs&1073741824)!==0&&(Dt&261930)===0?s.memoizedState=i:(s.memoizedState=c,s=Q_(),vt.lanes|=s,Yi|=s,c)}function Qy(s,i,c,f){return ya(c,i)?c:rc.current!==null?(s=_p(s,c,f),ya(s,i)||(Gr=!0),s):(Qs&42)===0||(Qs&1073741824)!==0&&(Dt&261930)===0?(Gr=!0,s.memoizedState=c):(s=Q_(),vt.lanes|=s,Yi|=s,i)}function Jy(s,i,c,f,x){var y=ue.p;ue.p=y!==0&&8>y?y:8;var C=ae.T,G={};ae.T=G,Ep(s,!1,i,c);try{var ie=x(),Ee=ae.S;if(Ee!==null&&Ee(G,ie),ie!==null&&typeof ie=="object"&&typeof ie.then=="function"){var Ie=v4(ie,f);Su(s,i,Ie,Sa(s))}else Su(s,i,f,Sa(s))}catch(je){Su(s,i,{then:function(){},status:"rejected",reason:je},Sa())}finally{ue.p=y,C!==null&&G.types!==null&&(C.types=G.types),ae.T=C}}function b4(){}function wp(s,i,c,f){if(s.tag!==5)throw Error(n(476));var x=Zy(s).queue;Jy(s,x,i,pe,c===null?b4:function(){return e_(s),c(f)})}function Zy(s){var i=s.memoizedState;if(i!==null)return i;i={memoizedState:pe,baseState:pe,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Js,lastRenderedState:pe},next:null};var c={};return i.next={memoizedState:c,baseState:c,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Js,lastRenderedState:c},next:null},s.memoizedState=i,s=s.alternate,s!==null&&(s.memoizedState=i),i}function e_(s){var i=Zy(s);i.next===null&&(i=s.alternate.memoizedState),Su(s,i.next.queue,{},Sa())}function Tp(){return gn(zu)}function t_(){return Fr().memoizedState}function r_(){return Fr().memoizedState}function S4(s){for(var i=s.return;i!==null;){switch(i.tag){case 24:case 3:var c=Sa();s=zi(c);var f=Hi(i,s,c);f!==null&&(fa(f,i,c),_u(f,i,c)),i={cache:Qm()},s.payload=i;return}i=i.return}}function A4(s,i,c){var f=Sa();c={lane:f,revertLane:0,gesture:null,action:c,hasEagerState:!1,eagerState:null,next:null},ad(s)?a_(i,c):(c=Bm(s,i,c,f),c!==null&&(fa(c,s,f),s_(c,i,f)))}function n_(s,i,c){var f=Sa();Su(s,i,c,f)}function Su(s,i,c,f){var x={lane:f,revertLane:0,gesture:null,action:c,hasEagerState:!1,eagerState:null,next:null};if(ad(s))a_(i,x);else{var y=s.alternate;if(s.lanes===0&&(y===null||y.lanes===0)&&(y=i.lastRenderedReducer,y!==null))try{var C=i.lastRenderedState,G=y(C,c);if(x.hasEagerState=!0,x.eagerState=G,ya(G,C))return Lh(s,i,x,0),cr===null&&Ph(),!1}catch{}finally{}if(c=Bm(s,i,x,f),c!==null)return fa(c,s,f),s_(c,i,f),!0}return!1}function Ep(s,i,c,f){if(f={lane:2,revertLane:tg(),gesture:null,action:f,hasEagerState:!1,eagerState:null,next:null},ad(s)){if(i)throw Error(n(479))}else i=Bm(s,c,f,2),i!==null&&fa(i,s,2)}function ad(s){var i=s.alternate;return s===vt||i!==null&&i===vt}function a_(s,i){nc=Qh=!0;var c=s.pending;c===null?i.next=i:(i.next=c.next,c.next=i),s.pending=i}function s_(s,i,c){if((c&4194048)!==0){var f=i.lanes;f&=s.pendingLanes,c|=f,i.lanes=c,de(s,c)}}var Au={readContext:gn,use:ed,useCallback:Nr,useContext:Nr,useEffect:Nr,useImperativeHandle:Nr,useLayoutEffect:Nr,useInsertionEffect:Nr,useMemo:Nr,useReducer:Nr,useRef:Nr,useState:Nr,useDebugValue:Nr,useDeferredValue:Nr,useTransition:Nr,useSyncExternalStore:Nr,useId:Nr,useHostTransitionStatus:Nr,useFormState:Nr,useActionState:Nr,useOptimistic:Nr,useMemoCache:Nr,useCacheRefresh:Nr};Au.useEffectEvent=Nr;var i_={readContext:gn,use:ed,useCallback:function(s,i){return Yn().memoizedState=[s,i===void 0?null:i],s},useContext:gn,useEffect:Hy,useImperativeHandle:function(s,i,c){c=c!=null?c.concat([s]):null,rd(4194308,4,Ky.bind(null,i,s),c)},useLayoutEffect:function(s,i){return rd(4194308,4,s,i)},useInsertionEffect:function(s,i){rd(4,2,s,i)},useMemo:function(s,i){var c=Yn();i=i===void 0?null:i;var f=s();if(Ql){nn(!0);try{s()}finally{nn(!1)}}return c.memoizedState=[f,i],f},useReducer:function(s,i,c){var f=Yn();if(c!==void 0){var x=c(i);if(Ql){nn(!0);try{c(i)}finally{nn(!1)}}}else x=i;return f.memoizedState=f.baseState=x,s={pending:null,lanes:0,dispatch:null,lastRenderedReducer:s,lastRenderedState:x},f.queue=s,s=s.dispatch=A4.bind(null,vt,s),[f.memoizedState,s]},useRef:function(s){var i=Yn();return s={current:s},i.memoizedState=s},useState:function(s){s=gp(s);var i=s.queue,c=n_.bind(null,vt,i);return i.dispatch=c,[s.memoizedState,c]},useDebugValue:yp,useDeferredValue:function(s,i){var c=Yn();return _p(c,s,i)},useTransition:function(){var s=gp(!1);return s=Jy.bind(null,vt,s.queue,!0,!1),Yn().memoizedState=s,[!1,s]},useSyncExternalStore:function(s,i,c){var f=vt,x=Yn();if(Mt){if(c===void 0)throw Error(n(407));c=c()}else{if(c=i(),cr===null)throw Error(n(349));(Dt&127)!==0||Ny(f,i,c)}x.memoizedState=c;var y={value:c,getSnapshot:i};return x.queue=y,Hy(ky.bind(null,f,y,s),[s]),f.flags|=2048,sc(9,{destroy:void 0},Cy.bind(null,f,y,c,i),null),c},useId:function(){var s=Yn(),i=cr.identifierPrefix;if(Mt){var c=Ss,f=bs;c=(f&~(1<<32-Ur(f)-1)).toString(32)+c,i="_"+i+"R_"+c,c=Jh++,0<c&&(i+="H"+c.toString(32)),i+="_"}else c=y4++,i="_"+i+"r_"+c.toString(32)+"_";return s.memoizedState=i},useHostTransitionStatus:Tp,useFormState:Ly,useActionState:Ly,useOptimistic:function(s){var i=Yn();i.memoizedState=i.baseState=s;var c={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return i.queue=c,i=Ep.bind(null,vt,!0,c),c.dispatch=i,[s,i]},useMemoCache:dp,useCacheRefresh:function(){return Yn().memoizedState=S4.bind(null,vt)},useEffectEvent:function(s){var i=Yn(),c={impl:s};return i.memoizedState=c,function(){if((Xt&2)!==0)throw Error(n(440));return c.impl.apply(void 0,arguments)}}},bp={readContext:gn,use:ed,useCallback:$y,useContext:gn,useEffect:vp,useImperativeHandle:Yy,useInsertionEffect:qy,useLayoutEffect:Wy,useMemo:Xy,useReducer:td,useRef:zy,useState:function(){return td(Js)},useDebugValue:yp,useDeferredValue:function(s,i){var c=Fr();return Qy(c,sr.memoizedState,s,i)},useTransition:function(){var s=td(Js)[0],i=Fr().memoizedState;return[typeof s=="boolean"?s:bu(s),i]},useSyncExternalStore:Ay,useId:t_,useHostTransitionStatus:Tp,useFormState:Uy,useActionState:Uy,useOptimistic:function(s,i){var c=Fr();return Iy(c,sr,s,i)},useMemoCache:dp,useCacheRefresh:r_};bp.useEffectEvent=Gy;var l_={readContext:gn,use:ed,useCallback:$y,useContext:gn,useEffect:vp,useImperativeHandle:Yy,useInsertionEffect:qy,useLayoutEffect:Wy,useMemo:Xy,useReducer:pp,useRef:zy,useState:function(){return pp(Js)},useDebugValue:yp,useDeferredValue:function(s,i){var c=Fr();return sr===null?_p(c,s,i):Qy(c,sr.memoizedState,s,i)},useTransition:function(){var s=pp(Js)[0],i=Fr().memoizedState;return[typeof s=="boolean"?s:bu(s),i]},useSyncExternalStore:Ay,useId:t_,useHostTransitionStatus:Tp,useFormState:Vy,useActionState:Vy,useOptimistic:function(s,i){var c=Fr();return sr!==null?Iy(c,sr,s,i):(c.baseState=s,[s,c.queue.dispatch])},useMemoCache:dp,useCacheRefresh:r_};l_.useEffectEvent=Gy;function Sp(s,i,c,f){i=s.memoizedState,c=c(f,i),c=c==null?i:v({},i,c),s.memoizedState=c,s.lanes===0&&(s.updateQueue.baseState=c)}var Ap={enqueueSetState:function(s,i,c){s=s._reactInternals;var f=Sa(),x=zi(f);x.payload=i,c!=null&&(x.callback=c),i=Hi(s,x,f),i!==null&&(fa(i,s,f),_u(i,s,f))},enqueueReplaceState:function(s,i,c){s=s._reactInternals;var f=Sa(),x=zi(f);x.tag=1,x.payload=i,c!=null&&(x.callback=c),i=Hi(s,x,f),i!==null&&(fa(i,s,f),_u(i,s,f))},enqueueForceUpdate:function(s,i){s=s._reactInternals;var c=Sa(),f=zi(c);f.tag=2,i!=null&&(f.callback=i),i=Hi(s,f,c),i!==null&&(fa(i,s,c),_u(i,s,c))}};function o_(s,i,c,f,x,y,C){return s=s.stateNode,typeof s.shouldComponentUpdate=="function"?s.shouldComponentUpdate(f,y,C):i.prototype&&i.prototype.isPureReactComponent?!hu(c,f)||!hu(x,y):!0}function c_(s,i,c,f){s=i.state,typeof i.componentWillReceiveProps=="function"&&i.componentWillReceiveProps(c,f),typeof i.UNSAFE_componentWillReceiveProps=="function"&&i.UNSAFE_componentWillReceiveProps(c,f),i.state!==s&&Ap.enqueueReplaceState(i,i.state,null)}function Jl(s,i){var c=i;if("ref"in i){c={};for(var f in i)f!=="ref"&&(c[f]=i[f])}if(s=s.defaultProps){c===i&&(c=v({},c));for(var x in s)c[x]===void 0&&(c[x]=s[x])}return c}function u_(s){Fh(s)}function f_(s){console.error(s)}function h_(s){Fh(s)}function sd(s,i){try{var c=s.onUncaughtError;c(i.value,{componentStack:i.stack})}catch(f){setTimeout(function(){throw f})}}function d_(s,i,c){try{var f=s.onCaughtError;f(c.value,{componentStack:c.stack,errorBoundary:i.tag===1?i.stateNode:null})}catch(x){setTimeout(function(){throw x})}}function Np(s,i,c){return c=zi(c),c.tag=3,c.payload={element:null},c.callback=function(){sd(s,i)},c}function m_(s){return s=zi(s),s.tag=3,s}function p_(s,i,c,f){var x=c.type.getDerivedStateFromError;if(typeof x=="function"){var y=f.value;s.payload=function(){return x(y)},s.callback=function(){d_(i,c,f)}}var C=c.stateNode;C!==null&&typeof C.componentDidCatch=="function"&&(s.callback=function(){d_(i,c,f),typeof x!="function"&&($i===null?$i=new Set([this]):$i.add(this));var G=f.stack;this.componentDidCatch(f.value,{componentStack:G!==null?G:""})})}function N4(s,i,c,f,x){if(c.flags|=32768,f!==null&&typeof f=="object"&&typeof f.then=="function"){if(i=c.alternate,i!==null&&Qo(i,c,x,!0),c=wa.current,c!==null){switch(c.tag){case 31:case 13:return qa===null?xd():c.alternate===null&&Cr===0&&(Cr=3),c.flags&=-257,c.flags|=65536,c.lanes=x,f===Wh?c.flags|=16384:(i=c.updateQueue,i===null?c.updateQueue=new Set([f]):i.add(f),Jp(s,f,x)),!1;case 22:return c.flags|=65536,f===Wh?c.flags|=16384:(i=c.updateQueue,i===null?(i={transitions:null,markerInstances:null,retryQueue:new Set([f])},c.updateQueue=i):(c=i.retryQueue,c===null?i.retryQueue=new Set([f]):c.add(f)),Jp(s,f,x)),!1}throw Error(n(435,c.tag))}return Jp(s,f,x),xd(),!1}if(Mt)return i=wa.current,i!==null?((i.flags&65536)===0&&(i.flags|=256),i.flags|=65536,i.lanes=x,f!==Wm&&(s=Error(n(422),{cause:f}),pu(Va(s,c)))):(f!==Wm&&(i=Error(n(423),{cause:f}),pu(Va(i,c))),s=s.current.alternate,s.flags|=65536,x&=-x,s.lanes|=x,f=Va(f,c),x=Np(s.stateNode,f,x),np(s,x),Cr!==4&&(Cr=2)),!1;var y=Error(n(520),{cause:f});if(y=Va(y,c),Mu===null?Mu=[y]:Mu.push(y),Cr!==4&&(Cr=2),i===null)return!0;f=Va(f,c),c=i;do{switch(c.tag){case 3:return c.flags|=65536,s=x&-x,c.lanes|=s,s=Np(c.stateNode,f,s),np(c,s),!1;case 1:if(i=c.type,y=c.stateNode,(c.flags&128)===0&&(typeof i.getDerivedStateFromError=="function"||y!==null&&typeof y.componentDidCatch=="function"&&($i===null||!$i.has(y))))return c.flags|=65536,x&=-x,c.lanes|=x,x=m_(x),p_(x,s,c,f),np(c,x),!1}c=c.return}while(c!==null);return!1}var Cp=Error(n(461)),Gr=!1;function xn(s,i,c,f){i.child=s===null?yy(i,null,c,f):Xl(i,s.child,c,f)}function g_(s,i,c,f,x){c=c.render;var y=i.ref;if("ref"in f){var C={};for(var G in f)G!=="ref"&&(C[G]=f[G])}else C=f;return Wl(i),f=cp(s,i,c,C,y,x),G=up(),s!==null&&!Gr?(fp(s,i,x),Zs(s,i,x)):(Mt&&G&&Gm(i),i.flags|=1,xn(s,i,f,x),i.child)}function x_(s,i,c,f,x){if(s===null){var y=c.type;return typeof y=="function"&&!Vm(y)&&y.defaultProps===void 0&&c.compare===null?(i.tag=15,i.type=y,v_(s,i,y,f,x)):(s=Bh(c.type,null,f,i,i.mode,x),s.ref=i.ref,s.return=i,i.child=s)}if(y=s.child,!Fp(s,x)){var C=y.memoizedProps;if(c=c.compare,c=c!==null?c:hu,c(C,f)&&s.ref===i.ref)return Zs(s,i,x)}return i.flags|=1,s=Ks(y,f),s.ref=i.ref,s.return=i,i.child=s}function v_(s,i,c,f,x){if(s!==null){var y=s.memoizedProps;if(hu(y,f)&&s.ref===i.ref)if(Gr=!1,i.pendingProps=f=y,Fp(s,x))(s.flags&131072)!==0&&(Gr=!0);else return i.lanes=s.lanes,Zs(s,i,x)}return kp(s,i,c,f,x)}function y_(s,i,c,f){var x=f.children,y=s!==null?s.memoizedState:null;if(s===null&&i.stateNode===null&&(i.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),f.mode==="hidden"){if((i.flags&128)!==0){if(y=y!==null?y.baseLanes|c:c,s!==null){for(f=i.child=s.child,x=0;f!==null;)x=x|f.lanes|f.childLanes,f=f.sibling;f=x&~y}else f=0,i.child=null;return __(s,i,y,c,f)}if((c&536870912)!==0)i.memoizedState={baseLanes:0,cachePool:null},s!==null&&Gh(i,y!==null?y.cachePool:null),y!==null?Ty(i,y):sp(),Ey(i);else return f=i.lanes=536870912,__(s,i,y!==null?y.baseLanes|c:c,c,f)}else y!==null?(Gh(i,y.cachePool),Ty(i,y),qi(),i.memoizedState=null):(s!==null&&Gh(i,null),sp(),qi());return xn(s,i,x,c),i.child}function Nu(s,i){return s!==null&&s.tag===22||i.stateNode!==null||(i.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),i.sibling}function __(s,i,c,f,x){var y=Zm();return y=y===null?null:{parent:zr._currentValue,pool:y},i.memoizedState={baseLanes:c,cachePool:y},s!==null&&Gh(i,null),sp(),Ey(i),s!==null&&Qo(s,i,f,!0),i.childLanes=x,null}function id(s,i){return i=od({mode:i.mode,children:i.children},s.mode),i.ref=s.ref,s.child=i,i.return=s,i}function w_(s,i,c){return Xl(i,s.child,null,c),s=id(i,i.pendingProps),s.flags|=2,Ta(i),i.memoizedState=null,s}function C4(s,i,c){var f=i.pendingProps,x=(i.flags&128)!==0;if(i.flags&=-129,s===null){if(Mt){if(f.mode==="hidden")return s=id(i,f),i.lanes=536870912,Nu(null,s);if(lp(i),(s=pr)?(s=Ow(s,Ga),s=s!==null&&s.data==="&"?s:null,s!==null&&(i.memoizedState={dehydrated:s,treeContext:Pi!==null?{id:bs,overflow:Ss}:null,retryLane:536870912,hydrationErrors:null},c=ay(s),c.return=i,i.child=c,pn=i,pr=null)):s=null,s===null)throw Ui(i);return i.lanes=536870912,null}return id(i,f)}var y=s.memoizedState;if(y!==null){var C=y.dehydrated;if(lp(i),x)if(i.flags&256)i.flags&=-257,i=w_(s,i,c);else if(i.memoizedState!==null)i.child=s.child,i.flags|=128,i=null;else throw Error(n(558));else if(Gr||Qo(s,i,c,!1),x=(c&s.childLanes)!==0,Gr||x){if(f=cr,f!==null&&(C=Ae(f,c),C!==0&&C!==y.retryLane))throw y.retryLane=C,zl(s,C),fa(f,s,C),Cp;xd(),i=w_(s,i,c)}else s=y.treeContext,pr=Wa(C.nextSibling),pn=i,Mt=!0,Li=null,Ga=!1,s!==null&&ly(i,s),i=id(i,f),i.flags|=4096;return i}return s=Ks(s.child,{mode:f.mode,children:f.children}),s.ref=i.ref,i.child=s,s.return=i,s}function ld(s,i){var c=i.ref;if(c===null)s!==null&&s.ref!==null&&(i.flags|=4194816);else{if(typeof c!="function"&&typeof c!="object")throw Error(n(284));(s===null||s.ref!==c)&&(i.flags|=4194816)}}function kp(s,i,c,f,x){return Wl(i),c=cp(s,i,c,f,void 0,x),f=up(),s!==null&&!Gr?(fp(s,i,x),Zs(s,i,x)):(Mt&&f&&Gm(i),i.flags|=1,xn(s,i,c,x),i.child)}function T_(s,i,c,f,x,y){return Wl(i),i.updateQueue=null,c=Sy(i,f,c,x),by(s),f=up(),s!==null&&!Gr?(fp(s,i,y),Zs(s,i,y)):(Mt&&f&&Gm(i),i.flags|=1,xn(s,i,c,y),i.child)}function E_(s,i,c,f,x){if(Wl(i),i.stateNode===null){var y=Ko,C=c.contextType;typeof C=="object"&&C!==null&&(y=gn(C)),y=new c(f,y),i.memoizedState=y.state!==null&&y.state!==void 0?y.state:null,y.updater=Ap,i.stateNode=y,y._reactInternals=i,y=i.stateNode,y.props=f,y.state=i.memoizedState,y.refs={},tp(i),C=c.contextType,y.context=typeof C=="object"&&C!==null?gn(C):Ko,y.state=i.memoizedState,C=c.getDerivedStateFromProps,typeof C=="function"&&(Sp(i,c,C,f),y.state=i.memoizedState),typeof c.getDerivedStateFromProps=="function"||typeof y.getSnapshotBeforeUpdate=="function"||typeof y.UNSAFE_componentWillMount!="function"&&typeof y.componentWillMount!="function"||(C=y.state,typeof y.componentWillMount=="function"&&y.componentWillMount(),typeof y.UNSAFE_componentWillMount=="function"&&y.UNSAFE_componentWillMount(),C!==y.state&&Ap.enqueueReplaceState(y,y.state,null),Tu(i,f,y,x),wu(),y.state=i.memoizedState),typeof y.componentDidMount=="function"&&(i.flags|=4194308),f=!0}else if(s===null){y=i.stateNode;var G=i.memoizedProps,ie=Jl(c,G);y.props=ie;var Ee=y.context,Ie=c.contextType;C=Ko,typeof Ie=="object"&&Ie!==null&&(C=gn(Ie));var je=c.getDerivedStateFromProps;Ie=typeof je=="function"||typeof y.getSnapshotBeforeUpdate=="function",G=i.pendingProps!==G,Ie||typeof y.UNSAFE_componentWillReceiveProps!="function"&&typeof y.componentWillReceiveProps!="function"||(G||Ee!==C)&&c_(i,y,f,C),Vi=!1;var Se=i.memoizedState;y.state=Se,Tu(i,f,y,x),wu(),Ee=i.memoizedState,G||Se!==Ee||Vi?(typeof je=="function"&&(Sp(i,c,je,f),Ee=i.memoizedState),(ie=Vi||o_(i,c,ie,f,Se,Ee,C))?(Ie||typeof y.UNSAFE_componentWillMount!="function"&&typeof y.componentWillMount!="function"||(typeof y.componentWillMount=="function"&&y.componentWillMount(),typeof y.UNSAFE_componentWillMount=="function"&&y.UNSAFE_componentWillMount()),typeof y.componentDidMount=="function"&&(i.flags|=4194308)):(typeof y.componentDidMount=="function"&&(i.flags|=4194308),i.memoizedProps=f,i.memoizedState=Ee),y.props=f,y.state=Ee,y.context=C,f=ie):(typeof y.componentDidMount=="function"&&(i.flags|=4194308),f=!1)}else{y=i.stateNode,rp(s,i),C=i.memoizedProps,Ie=Jl(c,C),y.props=Ie,je=i.pendingProps,Se=y.context,Ee=c.contextType,ie=Ko,typeof Ee=="object"&&Ee!==null&&(ie=gn(Ee)),G=c.getDerivedStateFromProps,(Ee=typeof G=="function"||typeof y.getSnapshotBeforeUpdate=="function")||typeof y.UNSAFE_componentWillReceiveProps!="function"&&typeof y.componentWillReceiveProps!="function"||(C!==je||Se!==ie)&&c_(i,y,f,ie),Vi=!1,Se=i.memoizedState,y.state=Se,Tu(i,f,y,x),wu();var ke=i.memoizedState;C!==je||Se!==ke||Vi||s!==null&&s.dependencies!==null&&zh(s.dependencies)?(typeof G=="function"&&(Sp(i,c,G,f),ke=i.memoizedState),(Ie=Vi||o_(i,c,Ie,f,Se,ke,ie)||s!==null&&s.dependencies!==null&&zh(s.dependencies))?(Ee||typeof y.UNSAFE_componentWillUpdate!="function"&&typeof y.componentWillUpdate!="function"||(typeof y.componentWillUpdate=="function"&&y.componentWillUpdate(f,ke,ie),typeof y.UNSAFE_componentWillUpdate=="function"&&y.UNSAFE_componentWillUpdate(f,ke,ie)),typeof y.componentDidUpdate=="function"&&(i.flags|=4),typeof y.getSnapshotBeforeUpdate=="function"&&(i.flags|=1024)):(typeof y.componentDidUpdate!="function"||C===s.memoizedProps&&Se===s.memoizedState||(i.flags|=4),typeof y.getSnapshotBeforeUpdate!="function"||C===s.memoizedProps&&Se===s.memoizedState||(i.flags|=1024),i.memoizedProps=f,i.memoizedState=ke),y.props=f,y.state=ke,y.context=ie,f=Ie):(typeof y.componentDidUpdate!="function"||C===s.memoizedProps&&Se===s.memoizedState||(i.flags|=4),typeof y.getSnapshotBeforeUpdate!="function"||C===s.memoizedProps&&Se===s.memoizedState||(i.flags|=1024),f=!1)}return y=f,ld(s,i),f=(i.flags&128)!==0,y||f?(y=i.stateNode,c=f&&typeof c.getDerivedStateFromError!="function"?null:y.render(),i.flags|=1,s!==null&&f?(i.child=Xl(i,s.child,null,x),i.child=Xl(i,null,c,x)):xn(s,i,c,x),i.memoizedState=y.state,s=i.child):s=Zs(s,i,x),s}function b_(s,i,c,f){return Gl(),i.flags|=256,xn(s,i,c,f),i.child}var Rp={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function Dp(s){return{baseLanes:s,cachePool:dy()}}function Ip(s,i,c){return s=s!==null?s.childLanes&~c:0,i&&(s|=ba),s}function S_(s,i,c){var f=i.pendingProps,x=!1,y=(i.flags&128)!==0,C;if((C=y)||(C=s!==null&&s.memoizedState===null?!1:(jr.current&2)!==0),C&&(x=!0,i.flags&=-129),C=(i.flags&32)!==0,i.flags&=-33,s===null){if(Mt){if(x?Gi(i):qi(),(s=pr)?(s=Ow(s,Ga),s=s!==null&&s.data!=="&"?s:null,s!==null&&(i.memoizedState={dehydrated:s,treeContext:Pi!==null?{id:bs,overflow:Ss}:null,retryLane:536870912,hydrationErrors:null},c=ay(s),c.return=i,i.child=c,pn=i,pr=null)):s=null,s===null)throw Ui(i);return mg(s)?i.lanes=32:i.lanes=536870912,null}var G=f.children;return f=f.fallback,x?(qi(),x=i.mode,G=od({mode:"hidden",children:G},x),f=Hl(f,x,c,null),G.return=i,f.return=i,G.sibling=f,i.child=G,f=i.child,f.memoizedState=Dp(c),f.childLanes=Ip(s,C,c),i.memoizedState=Rp,Nu(null,f)):(Gi(i),Op(i,G))}var ie=s.memoizedState;if(ie!==null&&(G=ie.dehydrated,G!==null)){if(y)i.flags&256?(Gi(i),i.flags&=-257,i=Mp(s,i,c)):i.memoizedState!==null?(qi(),i.child=s.child,i.flags|=128,i=null):(qi(),G=f.fallback,x=i.mode,f=od({mode:"visible",children:f.children},x),G=Hl(G,x,c,null),G.flags|=2,f.return=i,G.return=i,f.sibling=G,i.child=f,Xl(i,s.child,null,c),f=i.child,f.memoizedState=Dp(c),f.childLanes=Ip(s,C,c),i.memoizedState=Rp,i=Nu(null,f));else if(Gi(i),mg(G)){if(C=G.nextSibling&&G.nextSibling.dataset,C)var Ee=C.dgst;C=Ee,f=Error(n(419)),f.stack="",f.digest=C,pu({value:f,source:null,stack:null}),i=Mp(s,i,c)}else if(Gr||Qo(s,i,c,!1),C=(c&s.childLanes)!==0,Gr||C){if(C=cr,C!==null&&(f=Ae(C,c),f!==0&&f!==ie.retryLane))throw ie.retryLane=f,zl(s,f),fa(C,s,f),Cp;dg(G)||xd(),i=Mp(s,i,c)}else dg(G)?(i.flags|=192,i.child=s.child,i=null):(s=ie.treeContext,pr=Wa(G.nextSibling),pn=i,Mt=!0,Li=null,Ga=!1,s!==null&&ly(i,s),i=Op(i,f.children),i.flags|=4096);return i}return x?(qi(),G=f.fallback,x=i.mode,ie=s.child,Ee=ie.sibling,f=Ks(ie,{mode:"hidden",children:f.children}),f.subtreeFlags=ie.subtreeFlags&65011712,Ee!==null?G=Ks(Ee,G):(G=Hl(G,x,c,null),G.flags|=2),G.return=i,f.return=i,f.sibling=G,i.child=f,Nu(null,f),f=i.child,G=s.child.memoizedState,G===null?G=Dp(c):(x=G.cachePool,x!==null?(ie=zr._currentValue,x=x.parent!==ie?{parent:ie,pool:ie}:x):x=dy(),G={baseLanes:G.baseLanes|c,cachePool:x}),f.memoizedState=G,f.childLanes=Ip(s,C,c),i.memoizedState=Rp,Nu(s.child,f)):(Gi(i),c=s.child,s=c.sibling,c=Ks(c,{mode:"visible",children:f.children}),c.return=i,c.sibling=null,s!==null&&(C=i.deletions,C===null?(i.deletions=[s],i.flags|=16):C.push(s)),i.child=c,i.memoizedState=null,c)}function Op(s,i){return i=od({mode:"visible",children:i},s.mode),i.return=s,s.child=i}function od(s,i){return s=_a(22,s,null,i),s.lanes=0,s}function Mp(s,i,c){return Xl(i,s.child,null,c),s=Op(i,i.pendingProps.children),s.flags|=2,i.memoizedState=null,s}function A_(s,i,c){s.lanes|=i;var f=s.alternate;f!==null&&(f.lanes|=i),$m(s.return,i,c)}function jp(s,i,c,f,x,y){var C=s.memoizedState;C===null?s.memoizedState={isBackwards:i,rendering:null,renderingStartTime:0,last:f,tail:c,tailMode:x,treeForkCount:y}:(C.isBackwards=i,C.rendering=null,C.renderingStartTime=0,C.last=f,C.tail=c,C.tailMode=x,C.treeForkCount=y)}function N_(s,i,c){var f=i.pendingProps,x=f.revealOrder,y=f.tail;f=f.children;var C=jr.current,G=(C&2)!==0;if(G?(C=C&1|2,i.flags|=128):C&=1,Z(jr,C),xn(s,i,f,c),f=Mt?mu:0,!G&&s!==null&&(s.flags&128)!==0)e:for(s=i.child;s!==null;){if(s.tag===13)s.memoizedState!==null&&A_(s,c,i);else if(s.tag===19)A_(s,c,i);else if(s.child!==null){s.child.return=s,s=s.child;continue}if(s===i)break e;for(;s.sibling===null;){if(s.return===null||s.return===i)break e;s=s.return}s.sibling.return=s.return,s=s.sibling}switch(x){case"forwards":for(c=i.child,x=null;c!==null;)s=c.alternate,s!==null&&Xh(s)===null&&(x=c),c=c.sibling;c=x,c===null?(x=i.child,i.child=null):(x=c.sibling,c.sibling=null),jp(i,!1,x,c,y,f);break;case"backwards":case"unstable_legacy-backwards":for(c=null,x=i.child,i.child=null;x!==null;){if(s=x.alternate,s!==null&&Xh(s)===null){i.child=x;break}s=x.sibling,x.sibling=c,c=x,x=s}jp(i,!0,c,null,y,f);break;case"together":jp(i,!1,null,null,void 0,f);break;default:i.memoizedState=null}return i.child}function Zs(s,i,c){if(s!==null&&(i.dependencies=s.dependencies),Yi|=i.lanes,(c&i.childLanes)===0)if(s!==null){if(Qo(s,i,c,!1),(c&i.childLanes)===0)return null}else return null;if(s!==null&&i.child!==s.child)throw Error(n(153));if(i.child!==null){for(s=i.child,c=Ks(s,s.pendingProps),i.child=c,c.return=i;s.sibling!==null;)s=s.sibling,c=c.sibling=Ks(s,s.pendingProps),c.return=i;c.sibling=null}return i.child}function Fp(s,i){return(s.lanes&i)!==0?!0:(s=s.dependencies,!!(s!==null&&zh(s)))}function k4(s,i,c){switch(i.tag){case 3:Pe(i,i.stateNode.containerInfo),Bi(i,zr,s.memoizedState.cache),Gl();break;case 27:case 5:we(i);break;case 4:Pe(i,i.stateNode.containerInfo);break;case 10:Bi(i,i.type,i.memoizedProps.value);break;case 31:if(i.memoizedState!==null)return i.flags|=128,lp(i),null;break;case 13:var f=i.memoizedState;if(f!==null)return f.dehydrated!==null?(Gi(i),i.flags|=128,null):(c&i.child.childLanes)!==0?S_(s,i,c):(Gi(i),s=Zs(s,i,c),s!==null?s.sibling:null);Gi(i);break;case 19:var x=(s.flags&128)!==0;if(f=(c&i.childLanes)!==0,f||(Qo(s,i,c,!1),f=(c&i.childLanes)!==0),x){if(f)return N_(s,i,c);i.flags|=128}if(x=i.memoizedState,x!==null&&(x.rendering=null,x.tail=null,x.lastEffect=null),Z(jr,jr.current),f)break;return null;case 22:return i.lanes=0,y_(s,i,c,i.pendingProps);case 24:Bi(i,zr,s.memoizedState.cache)}return Zs(s,i,c)}function C_(s,i,c){if(s!==null)if(s.memoizedProps!==i.pendingProps)Gr=!0;else{if(!Fp(s,c)&&(i.flags&128)===0)return Gr=!1,k4(s,i,c);Gr=(s.flags&131072)!==0}else Gr=!1,Mt&&(i.flags&1048576)!==0&&iy(i,mu,i.index);switch(i.lanes=0,i.tag){case 16:e:{var f=i.pendingProps;if(s=Yl(i.elementType),i.type=s,typeof s=="function")Vm(s)?(f=Jl(s,f),i.tag=1,i=E_(null,i,s,f,c)):(i.tag=0,i=kp(null,i,s,f,c));else{if(s!=null){var x=s.$$typeof;if(x===z){i.tag=11,i=g_(null,i,s,f,c);break e}else if(x===b){i.tag=14,i=x_(null,i,s,f,c);break e}}throw i=Ce(s)||s,Error(n(306,i,""))}}return i;case 0:return kp(s,i,i.type,i.pendingProps,c);case 1:return f=i.type,x=Jl(f,i.pendingProps),E_(s,i,f,x,c);case 3:e:{if(Pe(i,i.stateNode.containerInfo),s===null)throw Error(n(387));f=i.pendingProps;var y=i.memoizedState;x=y.element,rp(s,i),Tu(i,f,null,c);var C=i.memoizedState;if(f=C.cache,Bi(i,zr,f),f!==y.cache&&Xm(i,[zr],c,!0),wu(),f=C.element,y.isDehydrated)if(y={element:f,isDehydrated:!1,cache:C.cache},i.updateQueue.baseState=y,i.memoizedState=y,i.flags&256){i=b_(s,i,f,c);break e}else if(f!==x){x=Va(Error(n(424)),i),pu(x),i=b_(s,i,f,c);break e}else{switch(s=i.stateNode.containerInfo,s.nodeType){case 9:s=s.body;break;default:s=s.nodeName==="HTML"?s.ownerDocument.body:s}for(pr=Wa(s.firstChild),pn=i,Mt=!0,Li=null,Ga=!0,c=yy(i,null,f,c),i.child=c;c;)c.flags=c.flags&-3|4096,c=c.sibling}else{if(Gl(),f===x){i=Zs(s,i,c);break e}xn(s,i,f,c)}i=i.child}return i;case 26:return ld(s,i),s===null?(c=Uw(i.type,null,i.pendingProps,null))?i.memoizedState=c:Mt||(c=i.type,s=i.pendingProps,f=bd(se.current).createElement(c),f[H]=i,f[W]=s,vn(f,c,s),Xe(f),i.stateNode=f):i.memoizedState=Uw(i.type,s.memoizedProps,i.pendingProps,s.memoizedState),null;case 27:return we(i),s===null&&Mt&&(f=i.stateNode=Fw(i.type,i.pendingProps,se.current),pn=i,Ga=!0,x=pr,Zi(i.type)?(pg=x,pr=Wa(f.firstChild)):pr=x),xn(s,i,i.pendingProps.children,c),ld(s,i),s===null&&(i.flags|=4194304),i.child;case 5:return s===null&&Mt&&((x=f=pr)&&(f=sk(f,i.type,i.pendingProps,Ga),f!==null?(i.stateNode=f,pn=i,pr=Wa(f.firstChild),Ga=!1,x=!0):x=!1),x||Ui(i)),we(i),x=i.type,y=i.pendingProps,C=s!==null?s.memoizedProps:null,f=y.children,ug(x,y)?f=null:C!==null&&ug(x,C)&&(i.flags|=32),i.memoizedState!==null&&(x=cp(s,i,_4,null,null,c),zu._currentValue=x),ld(s,i),xn(s,i,f,c),i.child;case 6:return s===null&&Mt&&((s=c=pr)&&(c=ik(c,i.pendingProps,Ga),c!==null?(i.stateNode=c,pn=i,pr=null,s=!0):s=!1),s||Ui(i)),null;case 13:return S_(s,i,c);case 4:return Pe(i,i.stateNode.containerInfo),f=i.pendingProps,s===null?i.child=Xl(i,null,f,c):xn(s,i,f,c),i.child;case 11:return g_(s,i,i.type,i.pendingProps,c);case 7:return xn(s,i,i.pendingProps,c),i.child;case 8:return xn(s,i,i.pendingProps.children,c),i.child;case 12:return xn(s,i,i.pendingProps.children,c),i.child;case 10:return f=i.pendingProps,Bi(i,i.type,f.value),xn(s,i,f.children,c),i.child;case 9:return x=i.type._context,f=i.pendingProps.children,Wl(i),x=gn(x),f=f(x),i.flags|=1,xn(s,i,f,c),i.child;case 14:return x_(s,i,i.type,i.pendingProps,c);case 15:return v_(s,i,i.type,i.pendingProps,c);case 19:return N_(s,i,c);case 31:return C4(s,i,c);case 22:return y_(s,i,c,i.pendingProps);case 24:return Wl(i),f=gn(zr),s===null?(x=Zm(),x===null&&(x=cr,y=Qm(),x.pooledCache=y,y.refCount++,y!==null&&(x.pooledCacheLanes|=c),x=y),i.memoizedState={parent:f,cache:x},tp(i),Bi(i,zr,x)):((s.lanes&c)!==0&&(rp(s,i),Tu(i,null,null,c),wu()),x=s.memoizedState,y=i.memoizedState,x.parent!==f?(x={parent:f,cache:f},i.memoizedState=x,i.lanes===0&&(i.memoizedState=i.updateQueue.baseState=x),Bi(i,zr,f)):(f=y.cache,Bi(i,zr,f),f!==x.cache&&Xm(i,[zr],c,!0))),xn(s,i,i.pendingProps.children,c),i.child;case 29:throw i.pendingProps}throw Error(n(156,i.tag))}function ei(s){s.flags|=4}function Pp(s,i,c,f,x){if((i=(s.mode&32)!==0)&&(i=!1),i){if(s.flags|=16777216,(x&335544128)===x)if(s.stateNode.complete)s.flags|=8192;else if(tw())s.flags|=8192;else throw $l=Wh,ep}else s.flags&=-16777217}function k_(s,i){if(i.type!=="stylesheet"||(i.state.loading&4)!==0)s.flags&=-16777217;else if(s.flags|=16777216,!Gw(i))if(tw())s.flags|=8192;else throw $l=Wh,ep}function cd(s,i){i!==null&&(s.flags|=4),s.flags&16384&&(i=s.tag!==22?Pa():536870912,s.lanes|=i,cc|=i)}function Cu(s,i){if(!Mt)switch(s.tailMode){case"hidden":i=s.tail;for(var c=null;i!==null;)i.alternate!==null&&(c=i),i=i.sibling;c===null?s.tail=null:c.sibling=null;break;case"collapsed":c=s.tail;for(var f=null;c!==null;)c.alternate!==null&&(f=c),c=c.sibling;f===null?i||s.tail===null?s.tail=null:s.tail.sibling=null:f.sibling=null}}function gr(s){var i=s.alternate!==null&&s.alternate.child===s.child,c=0,f=0;if(i)for(var x=s.child;x!==null;)c|=x.lanes|x.childLanes,f|=x.subtreeFlags&65011712,f|=x.flags&65011712,x.return=s,x=x.sibling;else for(x=s.child;x!==null;)c|=x.lanes|x.childLanes,f|=x.subtreeFlags,f|=x.flags,x.return=s,x=x.sibling;return s.subtreeFlags|=f,s.childLanes=c,i}function R4(s,i,c){var f=i.pendingProps;switch(qm(i),i.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return gr(i),null;case 1:return gr(i),null;case 3:return c=i.stateNode,f=null,s!==null&&(f=s.memoizedState.cache),i.memoizedState.cache!==f&&(i.flags|=2048),Xs(zr),he(),c.pendingContext&&(c.context=c.pendingContext,c.pendingContext=null),(s===null||s.child===null)&&(Xo(i)?ei(i):s===null||s.memoizedState.isDehydrated&&(i.flags&256)===0||(i.flags|=1024,Km())),gr(i),null;case 26:var x=i.type,y=i.memoizedState;return s===null?(ei(i),y!==null?(gr(i),k_(i,y)):(gr(i),Pp(i,x,null,f,c))):y?y!==s.memoizedState?(ei(i),gr(i),k_(i,y)):(gr(i),i.flags&=-16777217):(s=s.memoizedProps,s!==f&&ei(i),gr(i),Pp(i,x,s,f,c)),null;case 27:if(He(i),c=se.current,x=i.type,s!==null&&i.stateNode!=null)s.memoizedProps!==f&&ei(i);else{if(!f){if(i.stateNode===null)throw Error(n(166));return gr(i),null}s=ee.current,Xo(i)?oy(i):(s=Fw(x,f,c),i.stateNode=s,ei(i))}return gr(i),null;case 5:if(He(i),x=i.type,s!==null&&i.stateNode!=null)s.memoizedProps!==f&&ei(i);else{if(!f){if(i.stateNode===null)throw Error(n(166));return gr(i),null}if(y=ee.current,Xo(i))oy(i);else{var C=bd(se.current);switch(y){case 1:y=C.createElementNS("http://www.w3.org/2000/svg",x);break;case 2:y=C.createElementNS("http://www.w3.org/1998/Math/MathML",x);break;default:switch(x){case"svg":y=C.createElementNS("http://www.w3.org/2000/svg",x);break;case"math":y=C.createElementNS("http://www.w3.org/1998/Math/MathML",x);break;case"script":y=C.createElement("div"),y.innerHTML="<script><\/script>",y=y.removeChild(y.firstChild);break;case"select":y=typeof f.is=="string"?C.createElement("select",{is:f.is}):C.createElement("select"),f.multiple?y.multiple=!0:f.size&&(y.size=f.size);break;default:y=typeof f.is=="string"?C.createElement(x,{is:f.is}):C.createElement(x)}}y[H]=i,y[W]=f;e:for(C=i.child;C!==null;){if(C.tag===5||C.tag===6)y.appendChild(C.stateNode);else if(C.tag!==4&&C.tag!==27&&C.child!==null){C.child.return=C,C=C.child;continue}if(C===i)break e;for(;C.sibling===null;){if(C.return===null||C.return===i)break e;C=C.return}C.sibling.return=C.return,C=C.sibling}i.stateNode=y;e:switch(vn(y,x,f),x){case"button":case"input":case"select":case"textarea":f=!!f.autoFocus;break e;case"img":f=!0;break e;default:f=!1}f&&ei(i)}}return gr(i),Pp(i,i.type,s===null?null:s.memoizedProps,i.pendingProps,c),null;case 6:if(s&&i.stateNode!=null)s.memoizedProps!==f&&ei(i);else{if(typeof f!="string"&&i.stateNode===null)throw Error(n(166));if(s=se.current,Xo(i)){if(s=i.stateNode,c=i.memoizedProps,f=null,x=pn,x!==null)switch(x.tag){case 27:case 5:f=x.memoizedProps}s[H]=i,s=!!(s.nodeValue===c||f!==null&&f.suppressHydrationWarning===!0||Sw(s.nodeValue,c)),s||Ui(i,!0)}else s=bd(s).createTextNode(f),s[H]=i,i.stateNode=s}return gr(i),null;case 31:if(c=i.memoizedState,s===null||s.memoizedState!==null){if(f=Xo(i),c!==null){if(s===null){if(!f)throw Error(n(318));if(s=i.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(n(557));s[H]=i}else Gl(),(i.flags&128)===0&&(i.memoizedState=null),i.flags|=4;gr(i),s=!1}else c=Km(),s!==null&&s.memoizedState!==null&&(s.memoizedState.hydrationErrors=c),s=!0;if(!s)return i.flags&256?(Ta(i),i):(Ta(i),null);if((i.flags&128)!==0)throw Error(n(558))}return gr(i),null;case 13:if(f=i.memoizedState,s===null||s.memoizedState!==null&&s.memoizedState.dehydrated!==null){if(x=Xo(i),f!==null&&f.dehydrated!==null){if(s===null){if(!x)throw Error(n(318));if(x=i.memoizedState,x=x!==null?x.dehydrated:null,!x)throw Error(n(317));x[H]=i}else Gl(),(i.flags&128)===0&&(i.memoizedState=null),i.flags|=4;gr(i),x=!1}else x=Km(),s!==null&&s.memoizedState!==null&&(s.memoizedState.hydrationErrors=x),x=!0;if(!x)return i.flags&256?(Ta(i),i):(Ta(i),null)}return Ta(i),(i.flags&128)!==0?(i.lanes=c,i):(c=f!==null,s=s!==null&&s.memoizedState!==null,c&&(f=i.child,x=null,f.alternate!==null&&f.alternate.memoizedState!==null&&f.alternate.memoizedState.cachePool!==null&&(x=f.alternate.memoizedState.cachePool.pool),y=null,f.memoizedState!==null&&f.memoizedState.cachePool!==null&&(y=f.memoizedState.cachePool.pool),y!==x&&(f.flags|=2048)),c!==s&&c&&(i.child.flags|=8192),cd(i,i.updateQueue),gr(i),null);case 4:return he(),s===null&&sg(i.stateNode.containerInfo),gr(i),null;case 10:return Xs(i.type),gr(i),null;case 19:if(I(jr),f=i.memoizedState,f===null)return gr(i),null;if(x=(i.flags&128)!==0,y=f.rendering,y===null)if(x)Cu(f,!1);else{if(Cr!==0||s!==null&&(s.flags&128)!==0)for(s=i.child;s!==null;){if(y=Xh(s),y!==null){for(i.flags|=128,Cu(f,!1),s=y.updateQueue,i.updateQueue=s,cd(i,s),i.subtreeFlags=0,s=c,c=i.child;c!==null;)ny(c,s),c=c.sibling;return Z(jr,jr.current&1|2),Mt&&Ys(i,f.treeForkCount),i.child}s=s.sibling}f.tail!==null&&pt()>md&&(i.flags|=128,x=!0,Cu(f,!1),i.lanes=4194304)}else{if(!x)if(s=Xh(y),s!==null){if(i.flags|=128,x=!0,s=s.updateQueue,i.updateQueue=s,cd(i,s),Cu(f,!0),f.tail===null&&f.tailMode==="hidden"&&!y.alternate&&!Mt)return gr(i),null}else 2*pt()-f.renderingStartTime>md&&c!==536870912&&(i.flags|=128,x=!0,Cu(f,!1),i.lanes=4194304);f.isBackwards?(y.sibling=i.child,i.child=y):(s=f.last,s!==null?s.sibling=y:i.child=y,f.last=y)}return f.tail!==null?(s=f.tail,f.rendering=s,f.tail=s.sibling,f.renderingStartTime=pt(),s.sibling=null,c=jr.current,Z(jr,x?c&1|2:c&1),Mt&&Ys(i,f.treeForkCount),s):(gr(i),null);case 22:case 23:return Ta(i),ip(),f=i.memoizedState!==null,s!==null?s.memoizedState!==null!==f&&(i.flags|=8192):f&&(i.flags|=8192),f?(c&536870912)!==0&&(i.flags&128)===0&&(gr(i),i.subtreeFlags&6&&(i.flags|=8192)):gr(i),c=i.updateQueue,c!==null&&cd(i,c.retryQueue),c=null,s!==null&&s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(c=s.memoizedState.cachePool.pool),f=null,i.memoizedState!==null&&i.memoizedState.cachePool!==null&&(f=i.memoizedState.cachePool.pool),f!==c&&(i.flags|=2048),s!==null&&I(Kl),null;case 24:return c=null,s!==null&&(c=s.memoizedState.cache),i.memoizedState.cache!==c&&(i.flags|=2048),Xs(zr),gr(i),null;case 25:return null;case 30:return null}throw Error(n(156,i.tag))}function D4(s,i){switch(qm(i),i.tag){case 1:return s=i.flags,s&65536?(i.flags=s&-65537|128,i):null;case 3:return Xs(zr),he(),s=i.flags,(s&65536)!==0&&(s&128)===0?(i.flags=s&-65537|128,i):null;case 26:case 27:case 5:return He(i),null;case 31:if(i.memoizedState!==null){if(Ta(i),i.alternate===null)throw Error(n(340));Gl()}return s=i.flags,s&65536?(i.flags=s&-65537|128,i):null;case 13:if(Ta(i),s=i.memoizedState,s!==null&&s.dehydrated!==null){if(i.alternate===null)throw Error(n(340));Gl()}return s=i.flags,s&65536?(i.flags=s&-65537|128,i):null;case 19:return I(jr),null;case 4:return he(),null;case 10:return Xs(i.type),null;case 22:case 23:return Ta(i),ip(),s!==null&&I(Kl),s=i.flags,s&65536?(i.flags=s&-65537|128,i):null;case 24:return Xs(zr),null;case 25:return null;default:return null}}function R_(s,i){switch(qm(i),i.tag){case 3:Xs(zr),he();break;case 26:case 27:case 5:He(i);break;case 4:he();break;case 31:i.memoizedState!==null&&Ta(i);break;case 13:Ta(i);break;case 19:I(jr);break;case 10:Xs(i.type);break;case 22:case 23:Ta(i),ip(),s!==null&&I(Kl);break;case 24:Xs(zr)}}function ku(s,i){try{var c=i.updateQueue,f=c!==null?c.lastEffect:null;if(f!==null){var x=f.next;c=x;do{if((c.tag&s)===s){f=void 0;var y=c.create,C=c.inst;f=y(),C.destroy=f}c=c.next}while(c!==x)}}catch(G){rr(i,i.return,G)}}function Wi(s,i,c){try{var f=i.updateQueue,x=f!==null?f.lastEffect:null;if(x!==null){var y=x.next;f=y;do{if((f.tag&s)===s){var C=f.inst,G=C.destroy;if(G!==void 0){C.destroy=void 0,x=i;var ie=c,Ee=G;try{Ee()}catch(Ie){rr(x,ie,Ie)}}}f=f.next}while(f!==y)}}catch(Ie){rr(i,i.return,Ie)}}function D_(s){var i=s.updateQueue;if(i!==null){var c=s.stateNode;try{wy(i,c)}catch(f){rr(s,s.return,f)}}}function I_(s,i,c){c.props=Jl(s.type,s.memoizedProps),c.state=s.memoizedState;try{c.componentWillUnmount()}catch(f){rr(s,i,f)}}function Ru(s,i){try{var c=s.ref;if(c!==null){switch(s.tag){case 26:case 27:case 5:var f=s.stateNode;break;case 30:f=s.stateNode;break;default:f=s.stateNode}typeof c=="function"?s.refCleanup=c(f):c.current=f}}catch(x){rr(s,i,x)}}function As(s,i){var c=s.ref,f=s.refCleanup;if(c!==null)if(typeof f=="function")try{f()}catch(x){rr(s,i,x)}finally{s.refCleanup=null,s=s.alternate,s!=null&&(s.refCleanup=null)}else if(typeof c=="function")try{c(null)}catch(x){rr(s,i,x)}else c.current=null}function O_(s){var i=s.type,c=s.memoizedProps,f=s.stateNode;try{e:switch(i){case"button":case"input":case"select":case"textarea":c.autoFocus&&f.focus();break e;case"img":c.src?f.src=c.src:c.srcSet&&(f.srcset=c.srcSet)}}catch(x){rr(s,s.return,x)}}function Lp(s,i,c){try{var f=s.stateNode;Z4(f,s.type,c,i),f[W]=i}catch(x){rr(s,s.return,x)}}function M_(s){return s.tag===5||s.tag===3||s.tag===26||s.tag===27&&Zi(s.type)||s.tag===4}function Up(s){e:for(;;){for(;s.sibling===null;){if(s.return===null||M_(s.return))return null;s=s.return}for(s.sibling.return=s.return,s=s.sibling;s.tag!==5&&s.tag!==6&&s.tag!==18;){if(s.tag===27&&Zi(s.type)||s.flags&2||s.child===null||s.tag===4)continue e;s.child.return=s,s=s.child}if(!(s.flags&2))return s.stateNode}}function Bp(s,i,c){var f=s.tag;if(f===5||f===6)s=s.stateNode,i?(c.nodeType===9?c.body:c.nodeName==="HTML"?c.ownerDocument.body:c).insertBefore(s,i):(i=c.nodeType===9?c.body:c.nodeName==="HTML"?c.ownerDocument.body:c,i.appendChild(s),c=c._reactRootContainer,c!=null||i.onclick!==null||(i.onclick=sn));else if(f!==4&&(f===27&&Zi(s.type)&&(c=s.stateNode,i=null),s=s.child,s!==null))for(Bp(s,i,c),s=s.sibling;s!==null;)Bp(s,i,c),s=s.sibling}function ud(s,i,c){var f=s.tag;if(f===5||f===6)s=s.stateNode,i?c.insertBefore(s,i):c.appendChild(s);else if(f!==4&&(f===27&&Zi(s.type)&&(c=s.stateNode),s=s.child,s!==null))for(ud(s,i,c),s=s.sibling;s!==null;)ud(s,i,c),s=s.sibling}function j_(s){var i=s.stateNode,c=s.memoizedProps;try{for(var f=s.type,x=i.attributes;x.length;)i.removeAttributeNode(x[0]);vn(i,f,c),i[H]=s,i[W]=c}catch(y){rr(s,s.return,y)}}var ti=!1,qr=!1,Vp=!1,F_=typeof WeakSet=="function"?WeakSet:Set,cn=null;function I4(s,i){if(s=s.containerInfo,og=Dd,s=Y1(s),Mm(s)){if("selectionStart"in s)var c={start:s.selectionStart,end:s.selectionEnd};else e:{c=(c=s.ownerDocument)&&c.defaultView||window;var f=c.getSelection&&c.getSelection();if(f&&f.rangeCount!==0){c=f.anchorNode;var x=f.anchorOffset,y=f.focusNode;f=f.focusOffset;try{c.nodeType,y.nodeType}catch{c=null;break e}var C=0,G=-1,ie=-1,Ee=0,Ie=0,je=s,Se=null;t:for(;;){for(var ke;je!==c||x!==0&&je.nodeType!==3||(G=C+x),je!==y||f!==0&&je.nodeType!==3||(ie=C+f),je.nodeType===3&&(C+=je.nodeValue.length),(ke=je.firstChild)!==null;)Se=je,je=ke;for(;;){if(je===s)break t;if(Se===c&&++Ee===x&&(G=C),Se===y&&++Ie===f&&(ie=C),(ke=je.nextSibling)!==null)break;je=Se,Se=je.parentNode}je=ke}c=G===-1||ie===-1?null:{start:G,end:ie}}else c=null}c=c||{start:0,end:0}}else c=null;for(cg={focusedElem:s,selectionRange:c},Dd=!1,cn=i;cn!==null;)if(i=cn,s=i.child,(i.subtreeFlags&1028)!==0&&s!==null)s.return=i,cn=s;else for(;cn!==null;){switch(i=cn,y=i.alternate,s=i.flags,i.tag){case 0:if((s&4)!==0&&(s=i.updateQueue,s=s!==null?s.events:null,s!==null))for(c=0;c<s.length;c++)x=s[c],x.ref.impl=x.nextImpl;break;case 11:case 15:break;case 1:if((s&1024)!==0&&y!==null){s=void 0,c=i,x=y.memoizedProps,y=y.memoizedState,f=c.stateNode;try{var Ze=Jl(c.type,x);s=f.getSnapshotBeforeUpdate(Ze,y),f.__reactInternalSnapshotBeforeUpdate=s}catch(st){rr(c,c.return,st)}}break;case 3:if((s&1024)!==0){if(s=i.stateNode.containerInfo,c=s.nodeType,c===9)hg(s);else if(c===1)switch(s.nodeName){case"HEAD":case"HTML":case"BODY":hg(s);break;default:s.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((s&1024)!==0)throw Error(n(163))}if(s=i.sibling,s!==null){s.return=i.return,cn=s;break}cn=i.return}}function P_(s,i,c){var f=c.flags;switch(c.tag){case 0:case 11:case 15:ni(s,c),f&4&&ku(5,c);break;case 1:if(ni(s,c),f&4)if(s=c.stateNode,i===null)try{s.componentDidMount()}catch(C){rr(c,c.return,C)}else{var x=Jl(c.type,i.memoizedProps);i=i.memoizedState;try{s.componentDidUpdate(x,i,s.__reactInternalSnapshotBeforeUpdate)}catch(C){rr(c,c.return,C)}}f&64&&D_(c),f&512&&Ru(c,c.return);break;case 3:if(ni(s,c),f&64&&(s=c.updateQueue,s!==null)){if(i=null,c.child!==null)switch(c.child.tag){case 27:case 5:i=c.child.stateNode;break;case 1:i=c.child.stateNode}try{wy(s,i)}catch(C){rr(c,c.return,C)}}break;case 27:i===null&&f&4&&j_(c);case 26:case 5:ni(s,c),i===null&&f&4&&O_(c),f&512&&Ru(c,c.return);break;case 12:ni(s,c);break;case 31:ni(s,c),f&4&&B_(s,c);break;case 13:ni(s,c),f&4&&V_(s,c),f&64&&(s=c.memoizedState,s!==null&&(s=s.dehydrated,s!==null&&(c=V4.bind(null,c),lk(s,c))));break;case 22:if(f=c.memoizedState!==null||ti,!f){i=i!==null&&i.memoizedState!==null||qr,x=ti;var y=qr;ti=f,(qr=i)&&!y?ai(s,c,(c.subtreeFlags&8772)!==0):ni(s,c),ti=x,qr=y}break;case 30:break;default:ni(s,c)}}function L_(s){var i=s.alternate;i!==null&&(s.alternate=null,L_(i)),s.child=null,s.deletions=null,s.sibling=null,s.tag===5&&(i=s.stateNode,i!==null&&Oe(i)),s.stateNode=null,s.return=null,s.dependencies=null,s.memoizedProps=null,s.memoizedState=null,s.pendingProps=null,s.stateNode=null,s.updateQueue=null}var _r=null,la=!1;function ri(s,i,c){for(c=c.child;c!==null;)U_(s,i,c),c=c.sibling}function U_(s,i,c){if(or&&typeof or.onCommitFiberUnmount=="function")try{or.onCommitFiberUnmount(St,c)}catch{}switch(c.tag){case 26:qr||As(c,i),ri(s,i,c),c.memoizedState?c.memoizedState.count--:c.stateNode&&(c=c.stateNode,c.parentNode.removeChild(c));break;case 27:qr||As(c,i);var f=_r,x=la;Zi(c.type)&&(_r=c.stateNode,la=!1),ri(s,i,c),Uu(c.stateNode),_r=f,la=x;break;case 5:qr||As(c,i);case 6:if(f=_r,x=la,_r=null,ri(s,i,c),_r=f,la=x,_r!==null)if(la)try{(_r.nodeType===9?_r.body:_r.nodeName==="HTML"?_r.ownerDocument.body:_r).removeChild(c.stateNode)}catch(y){rr(c,i,y)}else try{_r.removeChild(c.stateNode)}catch(y){rr(c,i,y)}break;case 18:_r!==null&&(la?(s=_r,Dw(s.nodeType===9?s.body:s.nodeName==="HTML"?s.ownerDocument.body:s,c.stateNode),xc(s)):Dw(_r,c.stateNode));break;case 4:f=_r,x=la,_r=c.stateNode.containerInfo,la=!0,ri(s,i,c),_r=f,la=x;break;case 0:case 11:case 14:case 15:Wi(2,c,i),qr||Wi(4,c,i),ri(s,i,c);break;case 1:qr||(As(c,i),f=c.stateNode,typeof f.componentWillUnmount=="function"&&I_(c,i,f)),ri(s,i,c);break;case 21:ri(s,i,c);break;case 22:qr=(f=qr)||c.memoizedState!==null,ri(s,i,c),qr=f;break;default:ri(s,i,c)}}function B_(s,i){if(i.memoizedState===null&&(s=i.alternate,s!==null&&(s=s.memoizedState,s!==null))){s=s.dehydrated;try{xc(s)}catch(c){rr(i,i.return,c)}}}function V_(s,i){if(i.memoizedState===null&&(s=i.alternate,s!==null&&(s=s.memoizedState,s!==null&&(s=s.dehydrated,s!==null))))try{xc(s)}catch(c){rr(i,i.return,c)}}function O4(s){switch(s.tag){case 31:case 13:case 19:var i=s.stateNode;return i===null&&(i=s.stateNode=new F_),i;case 22:return s=s.stateNode,i=s._retryCache,i===null&&(i=s._retryCache=new F_),i;default:throw Error(n(435,s.tag))}}function fd(s,i){var c=O4(s);i.forEach(function(f){if(!c.has(f)){c.add(f);var x=z4.bind(null,s,f);f.then(x,x)}})}function oa(s,i){var c=i.deletions;if(c!==null)for(var f=0;f<c.length;f++){var x=c[f],y=s,C=i,G=C;e:for(;G!==null;){switch(G.tag){case 27:if(Zi(G.type)){_r=G.stateNode,la=!1;break e}break;case 5:_r=G.stateNode,la=!1;break e;case 3:case 4:_r=G.stateNode.containerInfo,la=!0;break e}G=G.return}if(_r===null)throw Error(n(160));U_(y,C,x),_r=null,la=!1,y=x.alternate,y!==null&&(y.return=null),x.return=null}if(i.subtreeFlags&13886)for(i=i.child;i!==null;)z_(i,s),i=i.sibling}var is=null;function z_(s,i){var c=s.alternate,f=s.flags;switch(s.tag){case 0:case 11:case 14:case 15:oa(i,s),ca(s),f&4&&(Wi(3,s,s.return),ku(3,s),Wi(5,s,s.return));break;case 1:oa(i,s),ca(s),f&512&&(qr||c===null||As(c,c.return)),f&64&&ti&&(s=s.updateQueue,s!==null&&(f=s.callbacks,f!==null&&(c=s.shared.hiddenCallbacks,s.shared.hiddenCallbacks=c===null?f:c.concat(f))));break;case 26:var x=is;if(oa(i,s),ca(s),f&512&&(qr||c===null||As(c,c.return)),f&4){var y=c!==null?c.memoizedState:null;if(f=s.memoizedState,c===null)if(f===null)if(s.stateNode===null){e:{f=s.type,c=s.memoizedProps,x=x.ownerDocument||x;t:switch(f){case"title":y=x.getElementsByTagName("title")[0],(!y||y[fe]||y[H]||y.namespaceURI==="http://www.w3.org/2000/svg"||y.hasAttribute("itemprop"))&&(y=x.createElement(f),x.head.insertBefore(y,x.querySelector("head > title"))),vn(y,f,c),y[H]=s,Xe(y),f=y;break e;case"link":var C=zw("link","href",x).get(f+(c.href||""));if(C){for(var G=0;G<C.length;G++)if(y=C[G],y.getAttribute("href")===(c.href==null||c.href===""?null:c.href)&&y.getAttribute("rel")===(c.rel==null?null:c.rel)&&y.getAttribute("title")===(c.title==null?null:c.title)&&y.getAttribute("crossorigin")===(c.crossOrigin==null?null:c.crossOrigin)){C.splice(G,1);break t}}y=x.createElement(f),vn(y,f,c),x.head.appendChild(y);break;case"meta":if(C=zw("meta","content",x).get(f+(c.content||""))){for(G=0;G<C.length;G++)if(y=C[G],y.getAttribute("content")===(c.content==null?null:""+c.content)&&y.getAttribute("name")===(c.name==null?null:c.name)&&y.getAttribute("property")===(c.property==null?null:c.property)&&y.getAttribute("http-equiv")===(c.httpEquiv==null?null:c.httpEquiv)&&y.getAttribute("charset")===(c.charSet==null?null:c.charSet)){C.splice(G,1);break t}}y=x.createElement(f),vn(y,f,c),x.head.appendChild(y);break;default:throw Error(n(468,f))}y[H]=s,Xe(y),f=y}s.stateNode=f}else Hw(x,s.type,s.stateNode);else s.stateNode=Vw(x,f,s.memoizedProps);else y!==f?(y===null?c.stateNode!==null&&(c=c.stateNode,c.parentNode.removeChild(c)):y.count--,f===null?Hw(x,s.type,s.stateNode):Vw(x,f,s.memoizedProps)):f===null&&s.stateNode!==null&&Lp(s,s.memoizedProps,c.memoizedProps)}break;case 27:oa(i,s),ca(s),f&512&&(qr||c===null||As(c,c.return)),c!==null&&f&4&&Lp(s,s.memoizedProps,c.memoizedProps);break;case 5:if(oa(i,s),ca(s),f&512&&(qr||c===null||As(c,c.return)),s.flags&32){x=s.stateNode;try{Ua(x,"")}catch(Ze){rr(s,s.return,Ze)}}f&4&&s.stateNode!=null&&(x=s.memoizedProps,Lp(s,x,c!==null?c.memoizedProps:x)),f&1024&&(Vp=!0);break;case 6:if(oa(i,s),ca(s),f&4){if(s.stateNode===null)throw Error(n(162));f=s.memoizedProps,c=s.stateNode;try{c.nodeValue=f}catch(Ze){rr(s,s.return,Ze)}}break;case 3:if(Nd=null,x=is,is=Sd(i.containerInfo),oa(i,s),is=x,ca(s),f&4&&c!==null&&c.memoizedState.isDehydrated)try{xc(i.containerInfo)}catch(Ze){rr(s,s.return,Ze)}Vp&&(Vp=!1,H_(s));break;case 4:f=is,is=Sd(s.stateNode.containerInfo),oa(i,s),ca(s),is=f;break;case 12:oa(i,s),ca(s);break;case 31:oa(i,s),ca(s),f&4&&(f=s.updateQueue,f!==null&&(s.updateQueue=null,fd(s,f)));break;case 13:oa(i,s),ca(s),s.child.flags&8192&&s.memoizedState!==null!=(c!==null&&c.memoizedState!==null)&&(dd=pt()),f&4&&(f=s.updateQueue,f!==null&&(s.updateQueue=null,fd(s,f)));break;case 22:x=s.memoizedState!==null;var ie=c!==null&&c.memoizedState!==null,Ee=ti,Ie=qr;if(ti=Ee||x,qr=Ie||ie,oa(i,s),qr=Ie,ti=Ee,ca(s),f&8192)e:for(i=s.stateNode,i._visibility=x?i._visibility&-2:i._visibility|1,x&&(c===null||ie||ti||qr||Zl(s)),c=null,i=s;;){if(i.tag===5||i.tag===26){if(c===null){ie=c=i;try{if(y=ie.stateNode,x)C=y.style,typeof C.setProperty=="function"?C.setProperty("display","none","important"):C.display="none";else{G=ie.stateNode;var je=ie.memoizedProps.style,Se=je!=null&&je.hasOwnProperty("display")?je.display:null;G.style.display=Se==null||typeof Se=="boolean"?"":(""+Se).trim()}}catch(Ze){rr(ie,ie.return,Ze)}}}else if(i.tag===6){if(c===null){ie=i;try{ie.stateNode.nodeValue=x?"":ie.memoizedProps}catch(Ze){rr(ie,ie.return,Ze)}}}else if(i.tag===18){if(c===null){ie=i;try{var ke=ie.stateNode;x?Iw(ke,!0):Iw(ie.stateNode,!1)}catch(Ze){rr(ie,ie.return,Ze)}}}else if((i.tag!==22&&i.tag!==23||i.memoizedState===null||i===s)&&i.child!==null){i.child.return=i,i=i.child;continue}if(i===s)break e;for(;i.sibling===null;){if(i.return===null||i.return===s)break e;c===i&&(c=null),i=i.return}c===i&&(c=null),i.sibling.return=i.return,i=i.sibling}f&4&&(f=s.updateQueue,f!==null&&(c=f.retryQueue,c!==null&&(f.retryQueue=null,fd(s,c))));break;case 19:oa(i,s),ca(s),f&4&&(f=s.updateQueue,f!==null&&(s.updateQueue=null,fd(s,f)));break;case 30:break;case 21:break;default:oa(i,s),ca(s)}}function ca(s){var i=s.flags;if(i&2){try{for(var c,f=s.return;f!==null;){if(M_(f)){c=f;break}f=f.return}if(c==null)throw Error(n(160));switch(c.tag){case 27:var x=c.stateNode,y=Up(s);ud(s,y,x);break;case 5:var C=c.stateNode;c.flags&32&&(Ua(C,""),c.flags&=-33);var G=Up(s);ud(s,G,C);break;case 3:case 4:var ie=c.stateNode.containerInfo,Ee=Up(s);Bp(s,Ee,ie);break;default:throw Error(n(161))}}catch(Ie){rr(s,s.return,Ie)}s.flags&=-3}i&4096&&(s.flags&=-4097)}function H_(s){if(s.subtreeFlags&1024)for(s=s.child;s!==null;){var i=s;H_(i),i.tag===5&&i.flags&1024&&i.stateNode.reset(),s=s.sibling}}function ni(s,i){if(i.subtreeFlags&8772)for(i=i.child;i!==null;)P_(s,i.alternate,i),i=i.sibling}function Zl(s){for(s=s.child;s!==null;){var i=s;switch(i.tag){case 0:case 11:case 14:case 15:Wi(4,i,i.return),Zl(i);break;case 1:As(i,i.return);var c=i.stateNode;typeof c.componentWillUnmount=="function"&&I_(i,i.return,c),Zl(i);break;case 27:Uu(i.stateNode);case 26:case 5:As(i,i.return),Zl(i);break;case 22:i.memoizedState===null&&Zl(i);break;case 30:Zl(i);break;default:Zl(i)}s=s.sibling}}function ai(s,i,c){for(c=c&&(i.subtreeFlags&8772)!==0,i=i.child;i!==null;){var f=i.alternate,x=s,y=i,C=y.flags;switch(y.tag){case 0:case 11:case 15:ai(x,y,c),ku(4,y);break;case 1:if(ai(x,y,c),f=y,x=f.stateNode,typeof x.componentDidMount=="function")try{x.componentDidMount()}catch(Ee){rr(f,f.return,Ee)}if(f=y,x=f.updateQueue,x!==null){var G=f.stateNode;try{var ie=x.shared.hiddenCallbacks;if(ie!==null)for(x.shared.hiddenCallbacks=null,x=0;x<ie.length;x++)_y(ie[x],G)}catch(Ee){rr(f,f.return,Ee)}}c&&C&64&&D_(y),Ru(y,y.return);break;case 27:j_(y);case 26:case 5:ai(x,y,c),c&&f===null&&C&4&&O_(y),Ru(y,y.return);break;case 12:ai(x,y,c);break;case 31:ai(x,y,c),c&&C&4&&B_(x,y);break;case 13:ai(x,y,c),c&&C&4&&V_(x,y);break;case 22:y.memoizedState===null&&ai(x,y,c),Ru(y,y.return);break;case 30:break;default:ai(x,y,c)}i=i.sibling}}function zp(s,i){var c=null;s!==null&&s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(c=s.memoizedState.cachePool.pool),s=null,i.memoizedState!==null&&i.memoizedState.cachePool!==null&&(s=i.memoizedState.cachePool.pool),s!==c&&(s!=null&&s.refCount++,c!=null&&gu(c))}function Hp(s,i){s=null,i.alternate!==null&&(s=i.alternate.memoizedState.cache),i=i.memoizedState.cache,i!==s&&(i.refCount++,s!=null&&gu(s))}function ls(s,i,c,f){if(i.subtreeFlags&10256)for(i=i.child;i!==null;)G_(s,i,c,f),i=i.sibling}function G_(s,i,c,f){var x=i.flags;switch(i.tag){case 0:case 11:case 15:ls(s,i,c,f),x&2048&&ku(9,i);break;case 1:ls(s,i,c,f);break;case 3:ls(s,i,c,f),x&2048&&(s=null,i.alternate!==null&&(s=i.alternate.memoizedState.cache),i=i.memoizedState.cache,i!==s&&(i.refCount++,s!=null&&gu(s)));break;case 12:if(x&2048){ls(s,i,c,f),s=i.stateNode;try{var y=i.memoizedProps,C=y.id,G=y.onPostCommit;typeof G=="function"&&G(C,i.alternate===null?"mount":"update",s.passiveEffectDuration,-0)}catch(ie){rr(i,i.return,ie)}}else ls(s,i,c,f);break;case 31:ls(s,i,c,f);break;case 13:ls(s,i,c,f);break;case 23:break;case 22:y=i.stateNode,C=i.alternate,i.memoizedState!==null?y._visibility&2?ls(s,i,c,f):Du(s,i):y._visibility&2?ls(s,i,c,f):(y._visibility|=2,ic(s,i,c,f,(i.subtreeFlags&10256)!==0||!1)),x&2048&&zp(C,i);break;case 24:ls(s,i,c,f),x&2048&&Hp(i.alternate,i);break;default:ls(s,i,c,f)}}function ic(s,i,c,f,x){for(x=x&&((i.subtreeFlags&10256)!==0||!1),i=i.child;i!==null;){var y=s,C=i,G=c,ie=f,Ee=C.flags;switch(C.tag){case 0:case 11:case 15:ic(y,C,G,ie,x),ku(8,C);break;case 23:break;case 22:var Ie=C.stateNode;C.memoizedState!==null?Ie._visibility&2?ic(y,C,G,ie,x):Du(y,C):(Ie._visibility|=2,ic(y,C,G,ie,x)),x&&Ee&2048&&zp(C.alternate,C);break;case 24:ic(y,C,G,ie,x),x&&Ee&2048&&Hp(C.alternate,C);break;default:ic(y,C,G,ie,x)}i=i.sibling}}function Du(s,i){if(i.subtreeFlags&10256)for(i=i.child;i!==null;){var c=s,f=i,x=f.flags;switch(f.tag){case 22:Du(c,f),x&2048&&zp(f.alternate,f);break;case 24:Du(c,f),x&2048&&Hp(f.alternate,f);break;default:Du(c,f)}i=i.sibling}}var Iu=8192;function lc(s,i,c){if(s.subtreeFlags&Iu)for(s=s.child;s!==null;)q_(s,i,c),s=s.sibling}function q_(s,i,c){switch(s.tag){case 26:lc(s,i,c),s.flags&Iu&&s.memoizedState!==null&&yk(c,is,s.memoizedState,s.memoizedProps);break;case 5:lc(s,i,c);break;case 3:case 4:var f=is;is=Sd(s.stateNode.containerInfo),lc(s,i,c),is=f;break;case 22:s.memoizedState===null&&(f=s.alternate,f!==null&&f.memoizedState!==null?(f=Iu,Iu=16777216,lc(s,i,c),Iu=f):lc(s,i,c));break;default:lc(s,i,c)}}function W_(s){var i=s.alternate;if(i!==null&&(s=i.child,s!==null)){i.child=null;do i=s.sibling,s.sibling=null,s=i;while(s!==null)}}function Ou(s){var i=s.deletions;if((s.flags&16)!==0){if(i!==null)for(var c=0;c<i.length;c++){var f=i[c];cn=f,Y_(f,s)}W_(s)}if(s.subtreeFlags&10256)for(s=s.child;s!==null;)K_(s),s=s.sibling}function K_(s){switch(s.tag){case 0:case 11:case 15:Ou(s),s.flags&2048&&Wi(9,s,s.return);break;case 3:Ou(s);break;case 12:Ou(s);break;case 22:var i=s.stateNode;s.memoizedState!==null&&i._visibility&2&&(s.return===null||s.return.tag!==13)?(i._visibility&=-3,hd(s)):Ou(s);break;default:Ou(s)}}function hd(s){var i=s.deletions;if((s.flags&16)!==0){if(i!==null)for(var c=0;c<i.length;c++){var f=i[c];cn=f,Y_(f,s)}W_(s)}for(s=s.child;s!==null;){switch(i=s,i.tag){case 0:case 11:case 15:Wi(8,i,i.return),hd(i);break;case 22:c=i.stateNode,c._visibility&2&&(c._visibility&=-3,hd(i));break;default:hd(i)}s=s.sibling}}function Y_(s,i){for(;cn!==null;){var c=cn;switch(c.tag){case 0:case 11:case 15:Wi(8,c,i);break;case 23:case 22:if(c.memoizedState!==null&&c.memoizedState.cachePool!==null){var f=c.memoizedState.cachePool.pool;f!=null&&f.refCount++}break;case 24:gu(c.memoizedState.cache)}if(f=c.child,f!==null)f.return=c,cn=f;else e:for(c=s;cn!==null;){f=cn;var x=f.sibling,y=f.return;if(L_(f),f===c){cn=null;break e}if(x!==null){x.return=y,cn=x;break e}cn=y}}}var M4={getCacheForType:function(s){var i=gn(zr),c=i.data.get(s);return c===void 0&&(c=s(),i.data.set(s,c)),c},cacheSignal:function(){return gn(zr).controller.signal}},j4=typeof WeakMap=="function"?WeakMap:Map,Xt=0,cr=null,Nt=null,Dt=0,tr=0,Ea=null,Ki=!1,oc=!1,Gp=!1,si=0,Cr=0,Yi=0,eo=0,qp=0,ba=0,cc=0,Mu=null,ua=null,Wp=!1,dd=0,$_=0,md=1/0,pd=null,$i=null,Jr=0,Xi=null,uc=null,ii=0,Kp=0,Yp=null,X_=null,ju=0,$p=null;function Sa(){return(Xt&2)!==0&&Dt!==0?Dt&-Dt:ae.T!==null?tg():O()}function Q_(){if(ba===0)if((Dt&536870912)===0||Mt){var s=Nn;Nn<<=1,(Nn&3932160)===0&&(Nn=262144),ba=s}else ba=536870912;return s=wa.current,s!==null&&(s.flags|=32),ba}function fa(s,i,c){(s===cr&&(tr===2||tr===9)||s.cancelPendingCommit!==null)&&(fc(s,0),Qi(s,Dt,ba,!1)),La(s,c),((Xt&2)===0||s!==cr)&&(s===cr&&((Xt&2)===0&&(eo|=c),Cr===4&&Qi(s,Dt,ba,!1)),Ns(s))}function J_(s,i,c){if((Xt&6)!==0)throw Error(n(327));var f=!c&&(i&127)===0&&(i&s.expiredLanes)===0||Fa(s,i),x=f?L4(s,i):Qp(s,i,!0),y=f;do{if(x===0){oc&&!f&&Qi(s,i,0,!1);break}else{if(c=s.current.alternate,y&&!F4(c)){x=Qp(s,i,!1),y=!1;continue}if(x===2){if(y=i,s.errorRecoveryDisabledLanes&y)var C=0;else C=s.pendingLanes&-536870913,C=C!==0?C:C&536870912?536870912:0;if(C!==0){i=C;e:{var G=s;x=Mu;var ie=G.current.memoizedState.isDehydrated;if(ie&&(fc(G,C).flags|=256),C=Qp(G,C,!1),C!==2){if(Gp&&!ie){G.errorRecoveryDisabledLanes|=y,eo|=y,x=4;break e}y=ua,ua=x,y!==null&&(ua===null?ua=y:ua.push.apply(ua,y))}x=C}if(y=!1,x!==2)continue}}if(x===1){fc(s,0),Qi(s,i,0,!0);break}e:{switch(f=s,y=x,y){case 0:case 1:throw Error(n(345));case 4:if((i&4194048)!==i)break;case 6:Qi(f,i,ba,!Ki);break e;case 2:ua=null;break;case 3:case 5:break;default:throw Error(n(329))}if((i&62914560)===i&&(x=dd+300-pt(),10<x)){if(Qi(f,i,ba,!Ki),dn(f,0,!0)!==0)break e;ii=i,f.timeoutHandle=kw(Z_.bind(null,f,c,ua,pd,Wp,i,ba,eo,cc,Ki,y,"Throttled",-0,0),x);break e}Z_(f,c,ua,pd,Wp,i,ba,eo,cc,Ki,y,null,-0,0)}}break}while(!0);Ns(s)}function Z_(s,i,c,f,x,y,C,G,ie,Ee,Ie,je,Se,ke){if(s.timeoutHandle=-1,je=i.subtreeFlags,je&8192||(je&16785408)===16785408){je={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:sn},q_(i,y,je);var Ze=(y&62914560)===y?dd-pt():(y&4194048)===y?$_-pt():0;if(Ze=_k(je,Ze),Ze!==null){ii=y,s.cancelPendingCommit=Ze(lw.bind(null,s,i,y,c,f,x,C,G,ie,Ie,je,null,Se,ke)),Qi(s,y,C,!Ee);return}}lw(s,i,y,c,f,x,C,G,ie)}function F4(s){for(var i=s;;){var c=i.tag;if((c===0||c===11||c===15)&&i.flags&16384&&(c=i.updateQueue,c!==null&&(c=c.stores,c!==null)))for(var f=0;f<c.length;f++){var x=c[f],y=x.getSnapshot;x=x.value;try{if(!ya(y(),x))return!1}catch{return!1}}if(c=i.child,i.subtreeFlags&16384&&c!==null)c.return=i,i=c;else{if(i===s)break;for(;i.sibling===null;){if(i.return===null||i.return===s)return!0;i=i.return}i.sibling.return=i.return,i=i.sibling}}return!0}function Qi(s,i,c,f){i&=~qp,i&=~eo,s.suspendedLanes|=i,s.pingedLanes&=~i,f&&(s.warmLanes|=i),f=s.expirationTimes;for(var x=i;0<x;){var y=31-Ur(x),C=1<<y;f[y]=-1,x&=~C}c!==0&&le(s,c,i)}function gd(){return(Xt&6)===0?(Fu(0),!1):!0}function Xp(){if(Nt!==null){if(tr===0)var s=Nt.return;else s=Nt,$s=ql=null,hp(s),tc=null,vu=0,s=Nt;for(;s!==null;)R_(s.alternate,s),s=s.return;Nt=null}}function fc(s,i){var c=s.timeoutHandle;c!==-1&&(s.timeoutHandle=-1,rk(c)),c=s.cancelPendingCommit,c!==null&&(s.cancelPendingCommit=null,c()),ii=0,Xp(),cr=s,Nt=c=Ks(s.current,null),Dt=i,tr=0,Ea=null,Ki=!1,oc=Fa(s,i),Gp=!1,cc=ba=qp=eo=Yi=Cr=0,ua=Mu=null,Wp=!1,(i&8)!==0&&(i|=i&32);var f=s.entangledLanes;if(f!==0)for(s=s.entanglements,f&=i;0<f;){var x=31-Ur(f),y=1<<x;i|=s[x],f&=~y}return si=i,Ph(),c}function ew(s,i){vt=null,ae.H=Au,i===ec||i===qh?(i=gy(),tr=3):i===ep?(i=gy(),tr=4):tr=i===Cp?8:i!==null&&typeof i=="object"&&typeof i.then=="function"?6:1,Ea=i,Nt===null&&(Cr=1,sd(s,Va(i,s.current)))}function tw(){var s=wa.current;return s===null?!0:(Dt&4194048)===Dt?qa===null:(Dt&62914560)===Dt||(Dt&536870912)!==0?s===qa:!1}function rw(){var s=ae.H;return ae.H=Au,s===null?Au:s}function nw(){var s=ae.A;return ae.A=M4,s}function xd(){Cr=4,Ki||(Dt&4194048)!==Dt&&wa.current!==null||(oc=!0),(Yi&134217727)===0&&(eo&134217727)===0||cr===null||Qi(cr,Dt,ba,!1)}function Qp(s,i,c){var f=Xt;Xt|=2;var x=rw(),y=nw();(cr!==s||Dt!==i)&&(pd=null,fc(s,i)),i=!1;var C=Cr;e:do try{if(tr!==0&&Nt!==null){var G=Nt,ie=Ea;switch(tr){case 8:Xp(),C=6;break e;case 3:case 2:case 9:case 6:wa.current===null&&(i=!0);var Ee=tr;if(tr=0,Ea=null,hc(s,G,ie,Ee),c&&oc){C=0;break e}break;default:Ee=tr,tr=0,Ea=null,hc(s,G,ie,Ee)}}P4(),C=Cr;break}catch(Ie){ew(s,Ie)}while(!0);return i&&s.shellSuspendCounter++,$s=ql=null,Xt=f,ae.H=x,ae.A=y,Nt===null&&(cr=null,Dt=0,Ph()),C}function P4(){for(;Nt!==null;)aw(Nt)}function L4(s,i){var c=Xt;Xt|=2;var f=rw(),x=nw();cr!==s||Dt!==i?(pd=null,md=pt()+500,fc(s,i)):oc=Fa(s,i);e:do try{if(tr!==0&&Nt!==null){i=Nt;var y=Ea;t:switch(tr){case 1:tr=0,Ea=null,hc(s,i,y,1);break;case 2:case 9:if(my(y)){tr=0,Ea=null,sw(i);break}i=function(){tr!==2&&tr!==9||cr!==s||(tr=7),Ns(s)},y.then(i,i);break e;case 3:tr=7;break e;case 4:tr=5;break e;case 7:my(y)?(tr=0,Ea=null,sw(i)):(tr=0,Ea=null,hc(s,i,y,7));break;case 5:var C=null;switch(Nt.tag){case 26:C=Nt.memoizedState;case 5:case 27:var G=Nt;if(C?Gw(C):G.stateNode.complete){tr=0,Ea=null;var ie=G.sibling;if(ie!==null)Nt=ie;else{var Ee=G.return;Ee!==null?(Nt=Ee,vd(Ee)):Nt=null}break t}}tr=0,Ea=null,hc(s,i,y,5);break;case 6:tr=0,Ea=null,hc(s,i,y,6);break;case 8:Xp(),Cr=6;break e;default:throw Error(n(462))}}U4();break}catch(Ie){ew(s,Ie)}while(!0);return $s=ql=null,ae.H=f,ae.A=x,Xt=c,Nt!==null?0:(cr=null,Dt=0,Ph(),Cr)}function U4(){for(;Nt!==null&&!Hn();)aw(Nt)}function aw(s){var i=C_(s.alternate,s,si);s.memoizedProps=s.pendingProps,i===null?vd(s):Nt=i}function sw(s){var i=s,c=i.alternate;switch(i.tag){case 15:case 0:i=T_(c,i,i.pendingProps,i.type,void 0,Dt);break;case 11:i=T_(c,i,i.pendingProps,i.type.render,i.ref,Dt);break;case 5:hp(i);default:R_(c,i),i=Nt=ny(i,si),i=C_(c,i,si)}s.memoizedProps=s.pendingProps,i===null?vd(s):Nt=i}function hc(s,i,c,f){$s=ql=null,hp(i),tc=null,vu=0;var x=i.return;try{if(N4(s,x,i,c,Dt)){Cr=1,sd(s,Va(c,s.current)),Nt=null;return}}catch(y){if(x!==null)throw Nt=x,y;Cr=1,sd(s,Va(c,s.current)),Nt=null;return}i.flags&32768?(Mt||f===1?s=!0:oc||(Dt&536870912)!==0?s=!1:(Ki=s=!0,(f===2||f===9||f===3||f===6)&&(f=wa.current,f!==null&&f.tag===13&&(f.flags|=16384))),iw(i,s)):vd(i)}function vd(s){var i=s;do{if((i.flags&32768)!==0){iw(i,Ki);return}s=i.return;var c=R4(i.alternate,i,si);if(c!==null){Nt=c;return}if(i=i.sibling,i!==null){Nt=i;return}Nt=i=s}while(i!==null);Cr===0&&(Cr=5)}function iw(s,i){do{var c=D4(s.alternate,s);if(c!==null){c.flags&=32767,Nt=c;return}if(c=s.return,c!==null&&(c.flags|=32768,c.subtreeFlags=0,c.deletions=null),!i&&(s=s.sibling,s!==null)){Nt=s;return}Nt=s=c}while(s!==null);Cr=6,Nt=null}function lw(s,i,c,f,x,y,C,G,ie){s.cancelPendingCommit=null;do yd();while(Jr!==0);if((Xt&6)!==0)throw Error(n(327));if(i!==null){if(i===s.current)throw Error(n(177));if(y=i.lanes|i.childLanes,y|=Um,Or(s,c,y,C,G,ie),s===cr&&(Nt=cr=null,Dt=0),uc=i,Xi=s,ii=c,Kp=y,Yp=x,X_=f,(i.subtreeFlags&10256)!==0||(i.flags&10256)!==0?(s.callbackNode=null,s.callbackPriority=0,H4(Ut,function(){return hw(),null})):(s.callbackNode=null,s.callbackPriority=0),f=(i.flags&13878)!==0,(i.subtreeFlags&13878)!==0||f){f=ae.T,ae.T=null,x=ue.p,ue.p=2,C=Xt,Xt|=4;try{I4(s,i,c)}finally{Xt=C,ue.p=x,ae.T=f}}Jr=1,ow(),cw(),uw()}}function ow(){if(Jr===1){Jr=0;var s=Xi,i=uc,c=(i.flags&13878)!==0;if((i.subtreeFlags&13878)!==0||c){c=ae.T,ae.T=null;var f=ue.p;ue.p=2;var x=Xt;Xt|=4;try{z_(i,s);var y=cg,C=Y1(s.containerInfo),G=y.focusedElem,ie=y.selectionRange;if(C!==G&&G&&G.ownerDocument&&K1(G.ownerDocument.documentElement,G)){if(ie!==null&&Mm(G)){var Ee=ie.start,Ie=ie.end;if(Ie===void 0&&(Ie=Ee),"selectionStart"in G)G.selectionStart=Ee,G.selectionEnd=Math.min(Ie,G.value.length);else{var je=G.ownerDocument||document,Se=je&&je.defaultView||window;if(Se.getSelection){var ke=Se.getSelection(),Ze=G.textContent.length,st=Math.min(ie.start,Ze),lr=ie.end===void 0?st:Math.min(ie.end,Ze);!ke.extend&&st>lr&&(C=lr,lr=st,st=C);var ge=W1(G,st),ce=W1(G,lr);if(ge&&ce&&(ke.rangeCount!==1||ke.anchorNode!==ge.node||ke.anchorOffset!==ge.offset||ke.focusNode!==ce.node||ke.focusOffset!==ce.offset)){var Te=je.createRange();Te.setStart(ge.node,ge.offset),ke.removeAllRanges(),st>lr?(ke.addRange(Te),ke.extend(ce.node,ce.offset)):(Te.setEnd(ce.node,ce.offset),ke.addRange(Te))}}}}for(je=[],ke=G;ke=ke.parentNode;)ke.nodeType===1&&je.push({element:ke,left:ke.scrollLeft,top:ke.scrollTop});for(typeof G.focus=="function"&&G.focus(),G=0;G<je.length;G++){var Me=je[G];Me.element.scrollLeft=Me.left,Me.element.scrollTop=Me.top}}Dd=!!og,cg=og=null}finally{Xt=x,ue.p=f,ae.T=c}}s.current=i,Jr=2}}function cw(){if(Jr===2){Jr=0;var s=Xi,i=uc,c=(i.flags&8772)!==0;if((i.subtreeFlags&8772)!==0||c){c=ae.T,ae.T=null;var f=ue.p;ue.p=2;var x=Xt;Xt|=4;try{P_(s,i.alternate,i)}finally{Xt=x,ue.p=f,ae.T=c}}Jr=3}}function uw(){if(Jr===4||Jr===3){Jr=0,Jt();var s=Xi,i=uc,c=ii,f=X_;(i.subtreeFlags&10256)!==0||(i.flags&10256)!==0?Jr=5:(Jr=0,uc=Xi=null,fw(s,s.pendingLanes));var x=s.pendingLanes;if(x===0&&($i=null),Ke(c),i=i.stateNode,or&&typeof or.onCommitFiberRoot=="function")try{or.onCommitFiberRoot(St,i,void 0,(i.current.flags&128)===128)}catch{}if(f!==null){i=ae.T,x=ue.p,ue.p=2,ae.T=null;try{for(var y=s.onRecoverableError,C=0;C<f.length;C++){var G=f[C];y(G.value,{componentStack:G.stack})}}finally{ae.T=i,ue.p=x}}(ii&3)!==0&&yd(),Ns(s),x=s.pendingLanes,(c&261930)!==0&&(x&42)!==0?s===$p?ju++:(ju=0,$p=s):ju=0,Fu(0)}}function fw(s,i){(s.pooledCacheLanes&=i)===0&&(i=s.pooledCache,i!=null&&(s.pooledCache=null,gu(i)))}function yd(){return ow(),cw(),uw(),hw()}function hw(){if(Jr!==5)return!1;var s=Xi,i=Kp;Kp=0;var c=Ke(ii),f=ae.T,x=ue.p;try{ue.p=32>c?32:c,ae.T=null,c=Yp,Yp=null;var y=Xi,C=ii;if(Jr=0,uc=Xi=null,ii=0,(Xt&6)!==0)throw Error(n(331));var G=Xt;if(Xt|=4,K_(y.current),G_(y,y.current,C,c),Xt=G,Fu(0,!1),or&&typeof or.onPostCommitFiberRoot=="function")try{or.onPostCommitFiberRoot(St,y)}catch{}return!0}finally{ue.p=x,ae.T=f,fw(s,i)}}function dw(s,i,c){i=Va(c,i),i=Np(s.stateNode,i,2),s=Hi(s,i,2),s!==null&&(La(s,2),Ns(s))}function rr(s,i,c){if(s.tag===3)dw(s,s,c);else for(;i!==null;){if(i.tag===3){dw(i,s,c);break}else if(i.tag===1){var f=i.stateNode;if(typeof i.type.getDerivedStateFromError=="function"||typeof f.componentDidCatch=="function"&&($i===null||!$i.has(f))){s=Va(c,s),c=m_(2),f=Hi(i,c,2),f!==null&&(p_(c,f,i,s),La(f,2),Ns(f));break}}i=i.return}}function Jp(s,i,c){var f=s.pingCache;if(f===null){f=s.pingCache=new j4;var x=new Set;f.set(i,x)}else x=f.get(i),x===void 0&&(x=new Set,f.set(i,x));x.has(c)||(Gp=!0,x.add(c),s=B4.bind(null,s,i,c),i.then(s,s))}function B4(s,i,c){var f=s.pingCache;f!==null&&f.delete(i),s.pingedLanes|=s.suspendedLanes&c,s.warmLanes&=~c,cr===s&&(Dt&c)===c&&(Cr===4||Cr===3&&(Dt&62914560)===Dt&&300>pt()-dd?(Xt&2)===0&&fc(s,0):qp|=c,cc===Dt&&(cc=0)),Ns(s)}function mw(s,i){i===0&&(i=Pa()),s=zl(s,i),s!==null&&(La(s,i),Ns(s))}function V4(s){var i=s.memoizedState,c=0;i!==null&&(c=i.retryLane),mw(s,c)}function z4(s,i){var c=0;switch(s.tag){case 31:case 13:var f=s.stateNode,x=s.memoizedState;x!==null&&(c=x.retryLane);break;case 19:f=s.stateNode;break;case 22:f=s.stateNode._retryCache;break;default:throw Error(n(314))}f!==null&&f.delete(i),mw(s,c)}function H4(s,i){return Qt(s,i)}var _d=null,dc=null,Zp=!1,wd=!1,eg=!1,Ji=0;function Ns(s){s!==dc&&s.next===null&&(dc===null?_d=dc=s:dc=dc.next=s),wd=!0,Zp||(Zp=!0,q4())}function Fu(s,i){if(!eg&&wd){eg=!0;do for(var c=!1,f=_d;f!==null;){if(s!==0){var x=f.pendingLanes;if(x===0)var y=0;else{var C=f.suspendedLanes,G=f.pingedLanes;y=(1<<31-Ur(42|s)+1)-1,y&=x&~(C&~G),y=y&201326741?y&201326741|1:y?y|2:0}y!==0&&(c=!0,vw(f,y))}else y=Dt,y=dn(f,f===cr?y:0,f.cancelPendingCommit!==null||f.timeoutHandle!==-1),(y&3)===0||Fa(f,y)||(c=!0,vw(f,y));f=f.next}while(c);eg=!1}}function G4(){pw()}function pw(){wd=Zp=!1;var s=0;Ji!==0&&tk()&&(s=Ji);for(var i=pt(),c=null,f=_d;f!==null;){var x=f.next,y=gw(f,i);y===0?(f.next=null,c===null?_d=x:c.next=x,x===null&&(dc=c)):(c=f,(s!==0||(y&3)!==0)&&(wd=!0)),f=x}Jr!==0&&Jr!==5||Fu(s),Ji!==0&&(Ji=0)}function gw(s,i){for(var c=s.suspendedLanes,f=s.pingedLanes,x=s.expirationTimes,y=s.pendingLanes&-62914561;0<y;){var C=31-Ur(y),G=1<<C,ie=x[C];ie===-1?((G&c)===0||(G&f)!==0)&&(x[C]=ns(G,i)):ie<=i&&(s.expiredLanes|=G),y&=~G}if(i=cr,c=Dt,c=dn(s,s===i?c:0,s.cancelPendingCommit!==null||s.timeoutHandle!==-1),f=s.callbackNode,c===0||s===i&&(tr===2||tr===9)||s.cancelPendingCommit!==null)return f!==null&&f!==null&&yr(f),s.callbackNode=null,s.callbackPriority=0;if((c&3)===0||Fa(s,c)){if(i=c&-c,i===s.callbackPriority)return i;switch(f!==null&&yr(f),Ke(c)){case 2:case 8:c=$t;break;case 32:c=Ut;break;case 268435456:c=lt;break;default:c=Ut}return f=xw.bind(null,s),c=Qt(c,f),s.callbackPriority=i,s.callbackNode=c,i}return f!==null&&f!==null&&yr(f),s.callbackPriority=2,s.callbackNode=null,2}function xw(s,i){if(Jr!==0&&Jr!==5)return s.callbackNode=null,s.callbackPriority=0,null;var c=s.callbackNode;if(yd()&&s.callbackNode!==c)return null;var f=Dt;return f=dn(s,s===cr?f:0,s.cancelPendingCommit!==null||s.timeoutHandle!==-1),f===0?null:(J_(s,f,i),gw(s,pt()),s.callbackNode!=null&&s.callbackNode===c?xw.bind(null,s):null)}function vw(s,i){if(yd())return null;J_(s,i,!0)}function q4(){nk(function(){(Xt&6)!==0?Qt(kt,G4):pw()})}function tg(){if(Ji===0){var s=Jo;s===0&&(s=ga,ga<<=1,(ga&261888)===0&&(ga=256)),Ji=s}return Ji}function yw(s){return s==null||typeof s=="symbol"||typeof s=="boolean"?null:typeof s=="function"?s:ws(""+s)}function _w(s,i){var c=i.ownerDocument.createElement("input");return c.name=i.name,c.value=i.value,s.id&&c.setAttribute("form",s.id),i.parentNode.insertBefore(c,i),s=new FormData(s),c.parentNode.removeChild(c),s}function W4(s,i,c,f,x){if(i==="submit"&&c&&c.stateNode===x){var y=yw((x[W]||null).action),C=f.submitter;C&&(i=(i=C[W]||null)?yw(i.formAction):C.getAttribute("formAction"),i!==null&&(y=i,C=null));var G=new jl("action","action",null,f,x);s.push({event:G,listeners:[{instance:null,listener:function(){if(f.defaultPrevented){if(Ji!==0){var ie=C?_w(x,C):new FormData(x);wp(c,{pending:!0,data:ie,method:x.method,action:y},null,ie)}}else typeof y=="function"&&(G.preventDefault(),ie=C?_w(x,C):new FormData(x),wp(c,{pending:!0,data:ie,method:x.method,action:y},y,ie))},currentTarget:x}]})}}for(var rg=0;rg<Lm.length;rg++){var ng=Lm[rg],K4=ng.toLowerCase(),Y4=ng[0].toUpperCase()+ng.slice(1);ss(K4,"on"+Y4)}ss(Q1,"onAnimationEnd"),ss(J1,"onAnimationIteration"),ss(Z1,"onAnimationStart"),ss("dblclick","onDoubleClick"),ss("focusin","onFocus"),ss("focusout","onBlur"),ss(u4,"onTransitionRun"),ss(f4,"onTransitionStart"),ss(h4,"onTransitionCancel"),ss(ey,"onTransitionEnd"),Mr("onMouseEnter",["mouseout","mouseover"]),Mr("onMouseLeave",["mouseout","mouseover"]),Mr("onPointerEnter",["pointerout","pointerover"]),Mr("onPointerLeave",["pointerout","pointerover"]),At("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),At("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),At("onBeforeInput",["compositionend","keypress","textInput","paste"]),At("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),At("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),At("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Pu="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),$4=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Pu));function ww(s,i){i=(i&4)!==0;for(var c=0;c<s.length;c++){var f=s[c],x=f.event;f=f.listeners;e:{var y=void 0;if(i)for(var C=f.length-1;0<=C;C--){var G=f[C],ie=G.instance,Ee=G.currentTarget;if(G=G.listener,ie!==y&&x.isPropagationStopped())break e;y=G,x.currentTarget=Ee;try{y(x)}catch(Ie){Fh(Ie)}x.currentTarget=null,y=ie}else for(C=0;C<f.length;C++){if(G=f[C],ie=G.instance,Ee=G.currentTarget,G=G.listener,ie!==y&&x.isPropagationStopped())break e;y=G,x.currentTarget=Ee;try{y(x)}catch(Ie){Fh(Ie)}x.currentTarget=null,y=ie}}}}function Ct(s,i){var c=i[oe];c===void 0&&(c=i[oe]=new Set);var f=s+"__bubble";c.has(f)||(Tw(i,s,2,!1),c.add(f))}function ag(s,i,c){var f=0;i&&(f|=4),Tw(c,s,f,i)}var Td="_reactListening"+Math.random().toString(36).slice(2);function sg(s){if(!s[Td]){s[Td]=!0,Rt.forEach(function(c){c!=="selectionchange"&&($4.has(c)||ag(c,!1,s),ag(c,!0,s))});var i=s.nodeType===9?s:s.ownerDocument;i===null||i[Td]||(i[Td]=!0,ag("selectionchange",!1,i))}}function Tw(s,i,c,f){switch(Qw(i)){case 2:var x=Ek;break;case 8:x=bk;break;default:x=_g}c=x.bind(null,i,c,s),x=void 0,!su||i!=="touchstart"&&i!=="touchmove"&&i!=="wheel"||(x=!0),f?x!==void 0?s.addEventListener(i,c,{capture:!0,passive:x}):s.addEventListener(i,c,!0):x!==void 0?s.addEventListener(i,c,{passive:x}):s.addEventListener(i,c,!1)}function ig(s,i,c,f,x){var y=f;if((i&1)===0&&(i&2)===0&&f!==null)e:for(;;){if(f===null)return;var C=f.tag;if(C===3||C===4){var G=f.stateNode.containerInfo;if(G===x)break;if(C===4)for(C=f.return;C!==null;){var ie=C.tag;if((ie===3||ie===4)&&C.stateNode.containerInfo===x)return;C=C.return}for(;G!==null;){if(C=Ge(G),C===null)return;if(ie=C.tag,ie===5||ie===6||ie===26||ie===27){f=y=C;continue e}G=G.parentNode}}f=f.return}_h(function(){var Ee=y,Ie=Uo(c),je=[];e:{var Se=ty.get(s);if(Se!==void 0){var ke=jl,Ze=s;switch(s){case"keypress":if(Ml(c)===0)break e;case"keydown":case"keyup":ke=kh;break;case"focusin":Ze="focus",ke=Oi;break;case"focusout":Ze="blur",ke=Oi;break;case"beforeblur":case"afterblur":ke=Oi;break;case"click":if(c.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":ke=Th;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":ke=Eh;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":ke=Dh;break;case Q1:case J1:case Z1:ke=zo;break;case ey:ke=Ho;break;case"scroll":case"scrollend":ke=wh;break;case"wheel":ke=Oh;break;case"copy":case"cut":case"paste":ke=Sh;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":ke=uu;break;case"toggle":case"beforetoggle":ke=ji}var st=(i&4)!==0,lr=!st&&(s==="scroll"||s==="scrollend"),ge=st?Se!==null?Se+"Capture":null:Se;st=[];for(var ce=Ee,Te;ce!==null;){var Me=ce;if(Te=Me.stateNode,Me=Me.tag,Me!==5&&Me!==26&&Me!==27||Te===null||ge===null||(Me=sa(ce,ge),Me!=null&&st.push(Lu(ce,Me,Te))),lr)break;ce=ce.return}0<st.length&&(Se=new ke(Se,Ze,null,c,Ie),je.push({event:Se,listeners:st}))}}if((i&7)===0){e:{if(Se=s==="mouseover"||s==="pointerover",ke=s==="mouseout"||s==="pointerout",Se&&c!==Lo&&(Ze=c.relatedTarget||c.fromElement)&&(Ge(Ze)||Ze[K]))break e;if((ke||Se)&&(Se=Ie.window===Ie?Ie:(Se=Ie.ownerDocument)?Se.defaultView||Se.parentWindow:window,ke?(Ze=c.relatedTarget||c.toElement,ke=Ee,Ze=Ze?Ge(Ze):null,Ze!==null&&(lr=l(Ze),st=Ze.tag,Ze!==lr||st!==5&&st!==27&&st!==6)&&(Ze=null)):(ke=null,Ze=Ee),ke!==Ze)){if(st=Th,Me="onMouseLeave",ge="onMouseEnter",ce="mouse",(s==="pointerout"||s==="pointerover")&&(st=uu,Me="onPointerLeave",ge="onPointerEnter",ce="pointer"),lr=ke==null?Se:Ve(ke),Te=Ze==null?Se:Ve(Ze),Se=new st(Me,ce+"leave",ke,c,Ie),Se.target=lr,Se.relatedTarget=Te,Me=null,Ge(Ie)===Ee&&(st=new st(ge,ce+"enter",Ze,c,Ie),st.target=Te,st.relatedTarget=lr,Me=st),lr=Me,ke&&Ze)t:{for(st=X4,ge=ke,ce=Ze,Te=0,Me=ge;Me;Me=st(Me))Te++;Me=0;for(var nt=ce;nt;nt=st(nt))Me++;for(;0<Te-Me;)ge=st(ge),Te--;for(;0<Me-Te;)ce=st(ce),Me--;for(;Te--;){if(ge===ce||ce!==null&&ge===ce.alternate){st=ge;break t}ge=st(ge),ce=st(ce)}st=null}else st=null;ke!==null&&Ew(je,Se,ke,st,!1),Ze!==null&&lr!==null&&Ew(je,lr,Ze,st,!0)}}e:{if(Se=Ee?Ve(Ee):window,ke=Se.nodeName&&Se.nodeName.toLowerCase(),ke==="select"||ke==="input"&&Se.type==="file")var Wt=B1;else if(ia(Se))if(V1)Wt=l4;else{Wt=s4;var tt=a4}else ke=Se.nodeName,!ke||ke.toLowerCase()!=="input"||Se.type!=="checkbox"&&Se.type!=="radio"?Ee&&nu(Ee.elementType)&&(Wt=B1):Wt=i4;if(Wt&&(Wt=Wt(s,Ee))){Ul(je,Wt,c,Ie);break e}tt&&tt(s,Se,Ee),s==="focusout"&&Ee&&Se.type==="number"&&Ee.memoizedProps.value!=null&&Po(Se,"number",Se.value)}switch(tt=Ee?Ve(Ee):window,s){case"focusin":(ia(tt)||tt.contentEditable==="true")&&(Go=tt,jm=Ee,du=null);break;case"focusout":du=jm=Go=null;break;case"mousedown":Fm=!0;break;case"contextmenu":case"mouseup":case"dragend":Fm=!1,$1(je,c,Ie);break;case"selectionchange":if(c4)break;case"keydown":case"keyup":$1(je,c,Ie)}var _t;if(S)e:{switch(s){case"compositionstart":var It="onCompositionStart";break e;case"compositionend":It="onCompositionEnd";break e;case"compositionupdate":It="onCompositionUpdate";break e}It=void 0}else Et?er(s,c)&&(It="onCompositionEnd"):s==="keydown"&&c.keyCode===229&&(It="onCompositionStart");It&&(ye&&c.locale!=="ko"&&(Et||It!=="onCompositionStart"?It==="onCompositionEnd"&&Et&&(_t=ki()):(va=Ie,Bo="value"in va?va.value:va.textContent,Et=!0)),tt=Ed(Ee,It),0<tt.length&&(It=new lu(It,s,null,c,Ie),je.push({event:It,listeners:tt}),_t?It.data=_t:(_t=Vr(c),_t!==null&&(It.data=_t)))),(_t=X?ln(s,c):on(s,c))&&(It=Ed(Ee,"onBeforeInput"),0<It.length&&(tt=new lu("onBeforeInput","beforeinput",null,c,Ie),je.push({event:tt,listeners:It}),tt.data=_t)),W4(je,s,Ee,c,Ie)}ww(je,i)})}function Lu(s,i,c){return{instance:s,listener:i,currentTarget:c}}function Ed(s,i){for(var c=i+"Capture",f=[];s!==null;){var x=s,y=x.stateNode;if(x=x.tag,x!==5&&x!==26&&x!==27||y===null||(x=sa(s,c),x!=null&&f.unshift(Lu(s,x,y)),x=sa(s,i),x!=null&&f.push(Lu(s,x,y))),s.tag===3)return f;s=s.return}return[]}function X4(s){if(s===null)return null;do s=s.return;while(s&&s.tag!==5&&s.tag!==27);return s||null}function Ew(s,i,c,f,x){for(var y=i._reactName,C=[];c!==null&&c!==f;){var G=c,ie=G.alternate,Ee=G.stateNode;if(G=G.tag,ie!==null&&ie===f)break;G!==5&&G!==26&&G!==27||Ee===null||(ie=Ee,x?(Ee=sa(c,y),Ee!=null&&C.unshift(Lu(c,Ee,ie))):x||(Ee=sa(c,y),Ee!=null&&C.push(Lu(c,Ee,ie)))),c=c.return}C.length!==0&&s.push({event:i,listeners:C})}var Q4=/\r\n?/g,J4=/\u0000|\uFFFD/g;function bw(s){return(typeof s=="string"?s:""+s).replace(Q4,`
`).replace(J4,"")}function Sw(s,i){return i=bw(i),bw(s)===i}function ir(s,i,c,f,x,y){switch(c){case"children":typeof f=="string"?i==="body"||i==="textarea"&&f===""||Ua(s,f):(typeof f=="number"||typeof f=="bigint")&&i!=="body"&&Ua(s,""+f);break;case"className":Gn(s,"class",f);break;case"tabIndex":Gn(s,"tabindex",f);break;case"dir":case"role":case"viewBox":case"width":case"height":Gn(s,c,f);break;case"style":vh(s,f,y);break;case"data":if(i!=="object"){Gn(s,"data",f);break}case"src":case"href":if(f===""&&(i!=="a"||c!=="href")){s.removeAttribute(c);break}if(f==null||typeof f=="function"||typeof f=="symbol"||typeof f=="boolean"){s.removeAttribute(c);break}f=ws(""+f),s.setAttribute(c,f);break;case"action":case"formAction":if(typeof f=="function"){s.setAttribute(c,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof y=="function"&&(c==="formAction"?(i!=="input"&&ir(s,i,"name",x.name,x,null),ir(s,i,"formEncType",x.formEncType,x,null),ir(s,i,"formMethod",x.formMethod,x,null),ir(s,i,"formTarget",x.formTarget,x,null)):(ir(s,i,"encType",x.encType,x,null),ir(s,i,"method",x.method,x,null),ir(s,i,"target",x.target,x,null)));if(f==null||typeof f=="symbol"||typeof f=="boolean"){s.removeAttribute(c);break}f=ws(""+f),s.setAttribute(c,f);break;case"onClick":f!=null&&(s.onclick=sn);break;case"onScroll":f!=null&&Ct("scroll",s);break;case"onScrollEnd":f!=null&&Ct("scrollend",s);break;case"dangerouslySetInnerHTML":if(f!=null){if(typeof f!="object"||!("__html"in f))throw Error(n(61));if(c=f.__html,c!=null){if(x.children!=null)throw Error(n(60));s.innerHTML=c}}break;case"multiple":s.multiple=f&&typeof f!="function"&&typeof f!="symbol";break;case"muted":s.muted=f&&typeof f!="function"&&typeof f!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(f==null||typeof f=="function"||typeof f=="boolean"||typeof f=="symbol"){s.removeAttribute("xlink:href");break}c=ws(""+f),s.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",c);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":f!=null&&typeof f!="function"&&typeof f!="symbol"?s.setAttribute(c,""+f):s.removeAttribute(c);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":f&&typeof f!="function"&&typeof f!="symbol"?s.setAttribute(c,""):s.removeAttribute(c);break;case"capture":case"download":f===!0?s.setAttribute(c,""):f!==!1&&f!=null&&typeof f!="function"&&typeof f!="symbol"?s.setAttribute(c,f):s.removeAttribute(c);break;case"cols":case"rows":case"size":case"span":f!=null&&typeof f!="function"&&typeof f!="symbol"&&!isNaN(f)&&1<=f?s.setAttribute(c,f):s.removeAttribute(c);break;case"rowSpan":case"start":f==null||typeof f=="function"||typeof f=="symbol"||isNaN(f)?s.removeAttribute(c):s.setAttribute(c,f);break;case"popover":Ct("beforetoggle",s),Ct("toggle",s),Tt(s,"popover",f);break;case"xlinkActuate":qn(s,"http://www.w3.org/1999/xlink","xlink:actuate",f);break;case"xlinkArcrole":qn(s,"http://www.w3.org/1999/xlink","xlink:arcrole",f);break;case"xlinkRole":qn(s,"http://www.w3.org/1999/xlink","xlink:role",f);break;case"xlinkShow":qn(s,"http://www.w3.org/1999/xlink","xlink:show",f);break;case"xlinkTitle":qn(s,"http://www.w3.org/1999/xlink","xlink:title",f);break;case"xlinkType":qn(s,"http://www.w3.org/1999/xlink","xlink:type",f);break;case"xmlBase":qn(s,"http://www.w3.org/XML/1998/namespace","xml:base",f);break;case"xmlLang":qn(s,"http://www.w3.org/XML/1998/namespace","xml:lang",f);break;case"xmlSpace":qn(s,"http://www.w3.org/XML/1998/namespace","xml:space",f);break;case"is":Tt(s,"is",f);break;case"innerText":case"textContent":break;default:(!(2<c.length)||c[0]!=="o"&&c[0]!=="O"||c[1]!=="n"&&c[1]!=="N")&&(c=km.get(c)||c,Tt(s,c,f))}}function lg(s,i,c,f,x,y){switch(c){case"style":vh(s,f,y);break;case"dangerouslySetInnerHTML":if(f!=null){if(typeof f!="object"||!("__html"in f))throw Error(n(61));if(c=f.__html,c!=null){if(x.children!=null)throw Error(n(60));s.innerHTML=c}}break;case"children":typeof f=="string"?Ua(s,f):(typeof f=="number"||typeof f=="bigint")&&Ua(s,""+f);break;case"onScroll":f!=null&&Ct("scroll",s);break;case"onScrollEnd":f!=null&&Ct("scrollend",s);break;case"onClick":f!=null&&(s.onclick=sn);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!wt.hasOwnProperty(c))e:{if(c[0]==="o"&&c[1]==="n"&&(x=c.endsWith("Capture"),i=c.slice(2,x?c.length-7:void 0),y=s[W]||null,y=y!=null?y[c]:null,typeof y=="function"&&s.removeEventListener(i,y,x),typeof f=="function")){typeof y!="function"&&y!==null&&(c in s?s[c]=null:s.hasAttribute(c)&&s.removeAttribute(c)),s.addEventListener(i,f,x);break e}c in s?s[c]=f:f===!0?s.setAttribute(c,""):Tt(s,c,f)}}}function vn(s,i,c){switch(i){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Ct("error",s),Ct("load",s);var f=!1,x=!1,y;for(y in c)if(c.hasOwnProperty(y)){var C=c[y];if(C!=null)switch(y){case"src":f=!0;break;case"srcSet":x=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(n(137,i));default:ir(s,i,y,C,c,null)}}x&&ir(s,i,"srcSet",c.srcSet,c,null),f&&ir(s,i,"src",c.src,c,null);return;case"input":Ct("invalid",s);var G=y=C=x=null,ie=null,Ee=null;for(f in c)if(c.hasOwnProperty(f)){var Ie=c[f];if(Ie!=null)switch(f){case"name":x=Ie;break;case"type":C=Ie;break;case"checked":ie=Ie;break;case"defaultChecked":Ee=Ie;break;case"value":y=Ie;break;case"defaultValue":G=Ie;break;case"children":case"dangerouslySetInnerHTML":if(Ie!=null)throw Error(n(137,i));break;default:ir(s,i,f,Ie,c,null)}}Il(s,y,G,ie,Ee,C,x,!1);return;case"select":Ct("invalid",s),f=C=y=null;for(x in c)if(c.hasOwnProperty(x)&&(G=c[x],G!=null))switch(x){case"value":y=G;break;case"defaultValue":C=G;break;case"multiple":f=G;default:ir(s,i,x,G,c,null)}i=y,c=C,s.multiple=!!f,i!=null?qt(s,!!f,i,!1):c!=null&&qt(s,!!f,c,!0);return;case"textarea":Ct("invalid",s),y=x=f=null;for(C in c)if(c.hasOwnProperty(C)&&(G=c[C],G!=null))switch(C){case"value":f=G;break;case"defaultValue":x=G;break;case"children":y=G;break;case"dangerouslySetInnerHTML":if(G!=null)throw Error(n(91));break;default:ir(s,i,C,G,c,null)}Ci(s,f,x,y);return;case"option":for(ie in c)if(c.hasOwnProperty(ie)&&(f=c[ie],f!=null))switch(ie){case"selected":s.selected=f&&typeof f!="function"&&typeof f!="symbol";break;default:ir(s,i,ie,f,c,null)}return;case"dialog":Ct("beforetoggle",s),Ct("toggle",s),Ct("cancel",s),Ct("close",s);break;case"iframe":case"object":Ct("load",s);break;case"video":case"audio":for(f=0;f<Pu.length;f++)Ct(Pu[f],s);break;case"image":Ct("error",s),Ct("load",s);break;case"details":Ct("toggle",s);break;case"embed":case"source":case"link":Ct("error",s),Ct("load",s);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(Ee in c)if(c.hasOwnProperty(Ee)&&(f=c[Ee],f!=null))switch(Ee){case"children":case"dangerouslySetInnerHTML":throw Error(n(137,i));default:ir(s,i,Ee,f,c,null)}return;default:if(nu(i)){for(Ie in c)c.hasOwnProperty(Ie)&&(f=c[Ie],f!==void 0&&lg(s,i,Ie,f,c,void 0));return}}for(G in c)c.hasOwnProperty(G)&&(f=c[G],f!=null&&ir(s,i,G,f,c,null))}function Z4(s,i,c,f){switch(i){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var x=null,y=null,C=null,G=null,ie=null,Ee=null,Ie=null;for(ke in c){var je=c[ke];if(c.hasOwnProperty(ke)&&je!=null)switch(ke){case"checked":break;case"value":break;case"defaultValue":ie=je;default:f.hasOwnProperty(ke)||ir(s,i,ke,null,f,je)}}for(var Se in f){var ke=f[Se];if(je=c[Se],f.hasOwnProperty(Se)&&(ke!=null||je!=null))switch(Se){case"type":y=ke;break;case"name":x=ke;break;case"checked":Ee=ke;break;case"defaultChecked":Ie=ke;break;case"value":C=ke;break;case"defaultValue":G=ke;break;case"children":case"dangerouslySetInnerHTML":if(ke!=null)throw Error(n(137,i));break;default:ke!==je&&ir(s,i,Se,ke,f,je)}}Ni(s,C,G,ie,Ee,Ie,y,x);return;case"select":ke=C=G=Se=null;for(y in c)if(ie=c[y],c.hasOwnProperty(y)&&ie!=null)switch(y){case"value":break;case"multiple":ke=ie;default:f.hasOwnProperty(y)||ir(s,i,y,null,f,ie)}for(x in f)if(y=f[x],ie=c[x],f.hasOwnProperty(x)&&(y!=null||ie!=null))switch(x){case"value":Se=y;break;case"defaultValue":G=y;break;case"multiple":C=y;default:y!==ie&&ir(s,i,x,y,f,ie)}i=G,c=C,f=ke,Se!=null?qt(s,!!c,Se,!1):!!f!=!!c&&(i!=null?qt(s,!!c,i,!0):qt(s,!!c,c?[]:"",!1));return;case"textarea":ke=Se=null;for(G in c)if(x=c[G],c.hasOwnProperty(G)&&x!=null&&!f.hasOwnProperty(G))switch(G){case"value":break;case"children":break;default:ir(s,i,G,null,f,x)}for(C in f)if(x=f[C],y=c[C],f.hasOwnProperty(C)&&(x!=null||y!=null))switch(C){case"value":Se=x;break;case"defaultValue":ke=x;break;case"children":break;case"dangerouslySetInnerHTML":if(x!=null)throw Error(n(91));break;default:x!==y&&ir(s,i,C,x,f,y)}Ol(s,Se,ke);return;case"option":for(var Ze in c)if(Se=c[Ze],c.hasOwnProperty(Ze)&&Se!=null&&!f.hasOwnProperty(Ze))switch(Ze){case"selected":s.selected=!1;break;default:ir(s,i,Ze,null,f,Se)}for(ie in f)if(Se=f[ie],ke=c[ie],f.hasOwnProperty(ie)&&Se!==ke&&(Se!=null||ke!=null))switch(ie){case"selected":s.selected=Se&&typeof Se!="function"&&typeof Se!="symbol";break;default:ir(s,i,ie,Se,f,ke)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var st in c)Se=c[st],c.hasOwnProperty(st)&&Se!=null&&!f.hasOwnProperty(st)&&ir(s,i,st,null,f,Se);for(Ee in f)if(Se=f[Ee],ke=c[Ee],f.hasOwnProperty(Ee)&&Se!==ke&&(Se!=null||ke!=null))switch(Ee){case"children":case"dangerouslySetInnerHTML":if(Se!=null)throw Error(n(137,i));break;default:ir(s,i,Ee,Se,f,ke)}return;default:if(nu(i)){for(var lr in c)Se=c[lr],c.hasOwnProperty(lr)&&Se!==void 0&&!f.hasOwnProperty(lr)&&lg(s,i,lr,void 0,f,Se);for(Ie in f)Se=f[Ie],ke=c[Ie],!f.hasOwnProperty(Ie)||Se===ke||Se===void 0&&ke===void 0||lg(s,i,Ie,Se,f,ke);return}}for(var ge in c)Se=c[ge],c.hasOwnProperty(ge)&&Se!=null&&!f.hasOwnProperty(ge)&&ir(s,i,ge,null,f,Se);for(je in f)Se=f[je],ke=c[je],!f.hasOwnProperty(je)||Se===ke||Se==null&&ke==null||ir(s,i,je,Se,f,ke)}function Aw(s){switch(s){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function ek(){if(typeof performance.getEntriesByType=="function"){for(var s=0,i=0,c=performance.getEntriesByType("resource"),f=0;f<c.length;f++){var x=c[f],y=x.transferSize,C=x.initiatorType,G=x.duration;if(y&&G&&Aw(C)){for(C=0,G=x.responseEnd,f+=1;f<c.length;f++){var ie=c[f],Ee=ie.startTime;if(Ee>G)break;var Ie=ie.transferSize,je=ie.initiatorType;Ie&&Aw(je)&&(ie=ie.responseEnd,C+=Ie*(ie<G?1:(G-Ee)/(ie-Ee)))}if(--f,i+=8*(y+C)/(x.duration/1e3),s++,10<s)break}}if(0<s)return i/s/1e6}return navigator.connection&&(s=navigator.connection.downlink,typeof s=="number")?s:5}var og=null,cg=null;function bd(s){return s.nodeType===9?s:s.ownerDocument}function Nw(s){switch(s){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function Cw(s,i){if(s===0)switch(i){case"svg":return 1;case"math":return 2;default:return 0}return s===1&&i==="foreignObject"?0:s}function ug(s,i){return s==="textarea"||s==="noscript"||typeof i.children=="string"||typeof i.children=="number"||typeof i.children=="bigint"||typeof i.dangerouslySetInnerHTML=="object"&&i.dangerouslySetInnerHTML!==null&&i.dangerouslySetInnerHTML.__html!=null}var fg=null;function tk(){var s=window.event;return s&&s.type==="popstate"?s===fg?!1:(fg=s,!0):(fg=null,!1)}var kw=typeof setTimeout=="function"?setTimeout:void 0,rk=typeof clearTimeout=="function"?clearTimeout:void 0,Rw=typeof Promise=="function"?Promise:void 0,nk=typeof queueMicrotask=="function"?queueMicrotask:typeof Rw<"u"?function(s){return Rw.resolve(null).then(s).catch(ak)}:kw;function ak(s){setTimeout(function(){throw s})}function Zi(s){return s==="head"}function Dw(s,i){var c=i,f=0;do{var x=c.nextSibling;if(s.removeChild(c),x&&x.nodeType===8)if(c=x.data,c==="/$"||c==="/&"){if(f===0){s.removeChild(x),xc(i);return}f--}else if(c==="$"||c==="$?"||c==="$~"||c==="$!"||c==="&")f++;else if(c==="html")Uu(s.ownerDocument.documentElement);else if(c==="head"){c=s.ownerDocument.head,Uu(c);for(var y=c.firstChild;y;){var C=y.nextSibling,G=y.nodeName;y[fe]||G==="SCRIPT"||G==="STYLE"||G==="LINK"&&y.rel.toLowerCase()==="stylesheet"||c.removeChild(y),y=C}}else c==="body"&&Uu(s.ownerDocument.body);c=x}while(c);xc(i)}function Iw(s,i){var c=s;s=0;do{var f=c.nextSibling;if(c.nodeType===1?i?(c._stashedDisplay=c.style.display,c.style.display="none"):(c.style.display=c._stashedDisplay||"",c.getAttribute("style")===""&&c.removeAttribute("style")):c.nodeType===3&&(i?(c._stashedText=c.nodeValue,c.nodeValue=""):c.nodeValue=c._stashedText||""),f&&f.nodeType===8)if(c=f.data,c==="/$"){if(s===0)break;s--}else c!=="$"&&c!=="$?"&&c!=="$~"&&c!=="$!"||s++;c=f}while(c)}function hg(s){var i=s.firstChild;for(i&&i.nodeType===10&&(i=i.nextSibling);i;){var c=i;switch(i=i.nextSibling,c.nodeName){case"HTML":case"HEAD":case"BODY":hg(c),Oe(c);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(c.rel.toLowerCase()==="stylesheet")continue}s.removeChild(c)}}function sk(s,i,c,f){for(;s.nodeType===1;){var x=c;if(s.nodeName.toLowerCase()!==i.toLowerCase()){if(!f&&(s.nodeName!=="INPUT"||s.type!=="hidden"))break}else if(f){if(!s[fe])switch(i){case"meta":if(!s.hasAttribute("itemprop"))break;return s;case"link":if(y=s.getAttribute("rel"),y==="stylesheet"&&s.hasAttribute("data-precedence"))break;if(y!==x.rel||s.getAttribute("href")!==(x.href==null||x.href===""?null:x.href)||s.getAttribute("crossorigin")!==(x.crossOrigin==null?null:x.crossOrigin)||s.getAttribute("title")!==(x.title==null?null:x.title))break;return s;case"style":if(s.hasAttribute("data-precedence"))break;return s;case"script":if(y=s.getAttribute("src"),(y!==(x.src==null?null:x.src)||s.getAttribute("type")!==(x.type==null?null:x.type)||s.getAttribute("crossorigin")!==(x.crossOrigin==null?null:x.crossOrigin))&&y&&s.hasAttribute("async")&&!s.hasAttribute("itemprop"))break;return s;default:return s}}else if(i==="input"&&s.type==="hidden"){var y=x.name==null?null:""+x.name;if(x.type==="hidden"&&s.getAttribute("name")===y)return s}else return s;if(s=Wa(s.nextSibling),s===null)break}return null}function ik(s,i,c){if(i==="")return null;for(;s.nodeType!==3;)if((s.nodeType!==1||s.nodeName!=="INPUT"||s.type!=="hidden")&&!c||(s=Wa(s.nextSibling),s===null))return null;return s}function Ow(s,i){for(;s.nodeType!==8;)if((s.nodeType!==1||s.nodeName!=="INPUT"||s.type!=="hidden")&&!i||(s=Wa(s.nextSibling),s===null))return null;return s}function dg(s){return s.data==="$?"||s.data==="$~"}function mg(s){return s.data==="$!"||s.data==="$?"&&s.ownerDocument.readyState!=="loading"}function lk(s,i){var c=s.ownerDocument;if(s.data==="$~")s._reactRetry=i;else if(s.data!=="$?"||c.readyState!=="loading")i();else{var f=function(){i(),c.removeEventListener("DOMContentLoaded",f)};c.addEventListener("DOMContentLoaded",f),s._reactRetry=f}}function Wa(s){for(;s!=null;s=s.nextSibling){var i=s.nodeType;if(i===1||i===3)break;if(i===8){if(i=s.data,i==="$"||i==="$!"||i==="$?"||i==="$~"||i==="&"||i==="F!"||i==="F")break;if(i==="/$"||i==="/&")return null}}return s}var pg=null;function Mw(s){s=s.nextSibling;for(var i=0;s;){if(s.nodeType===8){var c=s.data;if(c==="/$"||c==="/&"){if(i===0)return Wa(s.nextSibling);i--}else c!=="$"&&c!=="$!"&&c!=="$?"&&c!=="$~"&&c!=="&"||i++}s=s.nextSibling}return null}function jw(s){s=s.previousSibling;for(var i=0;s;){if(s.nodeType===8){var c=s.data;if(c==="$"||c==="$!"||c==="$?"||c==="$~"||c==="&"){if(i===0)return s;i--}else c!=="/$"&&c!=="/&"||i++}s=s.previousSibling}return null}function Fw(s,i,c){switch(i=bd(c),s){case"html":if(s=i.documentElement,!s)throw Error(n(452));return s;case"head":if(s=i.head,!s)throw Error(n(453));return s;case"body":if(s=i.body,!s)throw Error(n(454));return s;default:throw Error(n(451))}}function Uu(s){for(var i=s.attributes;i.length;)s.removeAttributeNode(i[0]);Oe(s)}var Ka=new Map,Pw=new Set;function Sd(s){return typeof s.getRootNode=="function"?s.getRootNode():s.nodeType===9?s:s.ownerDocument}var li=ue.d;ue.d={f:ok,r:ck,D:uk,C:fk,L:hk,m:dk,X:pk,S:mk,M:gk};function ok(){var s=li.f(),i=gd();return s||i}function ck(s){var i=Ye(s);i!==null&&i.tag===5&&i.type==="form"?e_(i):li.r(s)}var mc=typeof document>"u"?null:document;function Lw(s,i,c){var f=mc;if(f&&typeof i=="string"&&i){var x=Ar(i);x='link[rel="'+s+'"][href="'+x+'"]',typeof c=="string"&&(x+='[crossorigin="'+c+'"]'),Pw.has(x)||(Pw.add(x),s={rel:s,crossOrigin:c,href:i},f.querySelector(x)===null&&(i=f.createElement("link"),vn(i,"link",s),Xe(i),f.head.appendChild(i)))}}function uk(s){li.D(s),Lw("dns-prefetch",s,null)}function fk(s,i){li.C(s,i),Lw("preconnect",s,i)}function hk(s,i,c){li.L(s,i,c);var f=mc;if(f&&s&&i){var x='link[rel="preload"][as="'+Ar(i)+'"]';i==="image"&&c&&c.imageSrcSet?(x+='[imagesrcset="'+Ar(c.imageSrcSet)+'"]',typeof c.imageSizes=="string"&&(x+='[imagesizes="'+Ar(c.imageSizes)+'"]')):x+='[href="'+Ar(s)+'"]';var y=x;switch(i){case"style":y=pc(s);break;case"script":y=gc(s)}Ka.has(y)||(s=v({rel:"preload",href:i==="image"&&c&&c.imageSrcSet?void 0:s,as:i},c),Ka.set(y,s),f.querySelector(x)!==null||i==="style"&&f.querySelector(Bu(y))||i==="script"&&f.querySelector(Vu(y))||(i=f.createElement("link"),vn(i,"link",s),Xe(i),f.head.appendChild(i)))}}function dk(s,i){li.m(s,i);var c=mc;if(c&&s){var f=i&&typeof i.as=="string"?i.as:"script",x='link[rel="modulepreload"][as="'+Ar(f)+'"][href="'+Ar(s)+'"]',y=x;switch(f){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":y=gc(s)}if(!Ka.has(y)&&(s=v({rel:"modulepreload",href:s},i),Ka.set(y,s),c.querySelector(x)===null)){switch(f){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(c.querySelector(Vu(y)))return}f=c.createElement("link"),vn(f,"link",s),Xe(f),c.head.appendChild(f)}}}function mk(s,i,c){li.S(s,i,c);var f=mc;if(f&&s){var x=qe(f).hoistableStyles,y=pc(s);i=i||"default";var C=x.get(y);if(!C){var G={loading:0,preload:null};if(C=f.querySelector(Bu(y)))G.loading=5;else{s=v({rel:"stylesheet",href:s,"data-precedence":i},c),(c=Ka.get(y))&&gg(s,c);var ie=C=f.createElement("link");Xe(ie),vn(ie,"link",s),ie._p=new Promise(function(Ee,Ie){ie.onload=Ee,ie.onerror=Ie}),ie.addEventListener("load",function(){G.loading|=1}),ie.addEventListener("error",function(){G.loading|=2}),G.loading|=4,Ad(C,i,f)}C={type:"stylesheet",instance:C,count:1,state:G},x.set(y,C)}}}function pk(s,i){li.X(s,i);var c=mc;if(c&&s){var f=qe(c).hoistableScripts,x=gc(s),y=f.get(x);y||(y=c.querySelector(Vu(x)),y||(s=v({src:s,async:!0},i),(i=Ka.get(x))&&xg(s,i),y=c.createElement("script"),Xe(y),vn(y,"link",s),c.head.appendChild(y)),y={type:"script",instance:y,count:1,state:null},f.set(x,y))}}function gk(s,i){li.M(s,i);var c=mc;if(c&&s){var f=qe(c).hoistableScripts,x=gc(s),y=f.get(x);y||(y=c.querySelector(Vu(x)),y||(s=v({src:s,async:!0,type:"module"},i),(i=Ka.get(x))&&xg(s,i),y=c.createElement("script"),Xe(y),vn(y,"link",s),c.head.appendChild(y)),y={type:"script",instance:y,count:1,state:null},f.set(x,y))}}function Uw(s,i,c,f){var x=(x=se.current)?Sd(x):null;if(!x)throw Error(n(446));switch(s){case"meta":case"title":return null;case"style":return typeof c.precedence=="string"&&typeof c.href=="string"?(i=pc(c.href),c=qe(x).hoistableStyles,f=c.get(i),f||(f={type:"style",instance:null,count:0,state:null},c.set(i,f)),f):{type:"void",instance:null,count:0,state:null};case"link":if(c.rel==="stylesheet"&&typeof c.href=="string"&&typeof c.precedence=="string"){s=pc(c.href);var y=qe(x).hoistableStyles,C=y.get(s);if(C||(x=x.ownerDocument||x,C={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},y.set(s,C),(y=x.querySelector(Bu(s)))&&!y._p&&(C.instance=y,C.state.loading=5),Ka.has(s)||(c={rel:"preload",as:"style",href:c.href,crossOrigin:c.crossOrigin,integrity:c.integrity,media:c.media,hrefLang:c.hrefLang,referrerPolicy:c.referrerPolicy},Ka.set(s,c),y||xk(x,s,c,C.state))),i&&f===null)throw Error(n(528,""));return C}if(i&&f!==null)throw Error(n(529,""));return null;case"script":return i=c.async,c=c.src,typeof c=="string"&&i&&typeof i!="function"&&typeof i!="symbol"?(i=gc(c),c=qe(x).hoistableScripts,f=c.get(i),f||(f={type:"script",instance:null,count:0,state:null},c.set(i,f)),f):{type:"void",instance:null,count:0,state:null};default:throw Error(n(444,s))}}function pc(s){return'href="'+Ar(s)+'"'}function Bu(s){return'link[rel="stylesheet"]['+s+"]"}function Bw(s){return v({},s,{"data-precedence":s.precedence,precedence:null})}function xk(s,i,c,f){s.querySelector('link[rel="preload"][as="style"]['+i+"]")?f.loading=1:(i=s.createElement("link"),f.preload=i,i.addEventListener("load",function(){return f.loading|=1}),i.addEventListener("error",function(){return f.loading|=2}),vn(i,"link",c),Xe(i),s.head.appendChild(i))}function gc(s){return'[src="'+Ar(s)+'"]'}function Vu(s){return"script[async]"+s}function Vw(s,i,c){if(i.count++,i.instance===null)switch(i.type){case"style":var f=s.querySelector('style[data-href~="'+Ar(c.href)+'"]');if(f)return i.instance=f,Xe(f),f;var x=v({},c,{"data-href":c.href,"data-precedence":c.precedence,href:null,precedence:null});return f=(s.ownerDocument||s).createElement("style"),Xe(f),vn(f,"style",x),Ad(f,c.precedence,s),i.instance=f;case"stylesheet":x=pc(c.href);var y=s.querySelector(Bu(x));if(y)return i.state.loading|=4,i.instance=y,Xe(y),y;f=Bw(c),(x=Ka.get(x))&&gg(f,x),y=(s.ownerDocument||s).createElement("link"),Xe(y);var C=y;return C._p=new Promise(function(G,ie){C.onload=G,C.onerror=ie}),vn(y,"link",f),i.state.loading|=4,Ad(y,c.precedence,s),i.instance=y;case"script":return y=gc(c.src),(x=s.querySelector(Vu(y)))?(i.instance=x,Xe(x),x):(f=c,(x=Ka.get(y))&&(f=v({},c),xg(f,x)),s=s.ownerDocument||s,x=s.createElement("script"),Xe(x),vn(x,"link",f),s.head.appendChild(x),i.instance=x);case"void":return null;default:throw Error(n(443,i.type))}else i.type==="stylesheet"&&(i.state.loading&4)===0&&(f=i.instance,i.state.loading|=4,Ad(f,c.precedence,s));return i.instance}function Ad(s,i,c){for(var f=c.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),x=f.length?f[f.length-1]:null,y=x,C=0;C<f.length;C++){var G=f[C];if(G.dataset.precedence===i)y=G;else if(y!==x)break}y?y.parentNode.insertBefore(s,y.nextSibling):(i=c.nodeType===9?c.head:c,i.insertBefore(s,i.firstChild))}function gg(s,i){s.crossOrigin==null&&(s.crossOrigin=i.crossOrigin),s.referrerPolicy==null&&(s.referrerPolicy=i.referrerPolicy),s.title==null&&(s.title=i.title)}function xg(s,i){s.crossOrigin==null&&(s.crossOrigin=i.crossOrigin),s.referrerPolicy==null&&(s.referrerPolicy=i.referrerPolicy),s.integrity==null&&(s.integrity=i.integrity)}var Nd=null;function zw(s,i,c){if(Nd===null){var f=new Map,x=Nd=new Map;x.set(c,f)}else x=Nd,f=x.get(c),f||(f=new Map,x.set(c,f));if(f.has(s))return f;for(f.set(s,null),c=c.getElementsByTagName(s),x=0;x<c.length;x++){var y=c[x];if(!(y[fe]||y[H]||s==="link"&&y.getAttribute("rel")==="stylesheet")&&y.namespaceURI!=="http://www.w3.org/2000/svg"){var C=y.getAttribute(i)||"";C=s+C;var G=f.get(C);G?G.push(y):f.set(C,[y])}}return f}function Hw(s,i,c){s=s.ownerDocument||s,s.head.insertBefore(c,i==="title"?s.querySelector("head > title"):null)}function vk(s,i,c){if(c===1||i.itemProp!=null)return!1;switch(s){case"meta":case"title":return!0;case"style":if(typeof i.precedence!="string"||typeof i.href!="string"||i.href==="")break;return!0;case"link":if(typeof i.rel!="string"||typeof i.href!="string"||i.href===""||i.onLoad||i.onError)break;switch(i.rel){case"stylesheet":return s=i.disabled,typeof i.precedence=="string"&&s==null;default:return!0}case"script":if(i.async&&typeof i.async!="function"&&typeof i.async!="symbol"&&!i.onLoad&&!i.onError&&i.src&&typeof i.src=="string")return!0}return!1}function Gw(s){return!(s.type==="stylesheet"&&(s.state.loading&3)===0)}function yk(s,i,c,f){if(c.type==="stylesheet"&&(typeof f.media!="string"||matchMedia(f.media).matches!==!1)&&(c.state.loading&4)===0){if(c.instance===null){var x=pc(f.href),y=i.querySelector(Bu(x));if(y){i=y._p,i!==null&&typeof i=="object"&&typeof i.then=="function"&&(s.count++,s=Cd.bind(s),i.then(s,s)),c.state.loading|=4,c.instance=y,Xe(y);return}y=i.ownerDocument||i,f=Bw(f),(x=Ka.get(x))&&gg(f,x),y=y.createElement("link"),Xe(y);var C=y;C._p=new Promise(function(G,ie){C.onload=G,C.onerror=ie}),vn(y,"link",f),c.instance=y}s.stylesheets===null&&(s.stylesheets=new Map),s.stylesheets.set(c,i),(i=c.state.preload)&&(c.state.loading&3)===0&&(s.count++,c=Cd.bind(s),i.addEventListener("load",c),i.addEventListener("error",c))}}var vg=0;function _k(s,i){return s.stylesheets&&s.count===0&&Rd(s,s.stylesheets),0<s.count||0<s.imgCount?function(c){var f=setTimeout(function(){if(s.stylesheets&&Rd(s,s.stylesheets),s.unsuspend){var y=s.unsuspend;s.unsuspend=null,y()}},6e4+i);0<s.imgBytes&&vg===0&&(vg=62500*ek());var x=setTimeout(function(){if(s.waitingForImages=!1,s.count===0&&(s.stylesheets&&Rd(s,s.stylesheets),s.unsuspend)){var y=s.unsuspend;s.unsuspend=null,y()}},(s.imgBytes>vg?50:800)+i);return s.unsuspend=c,function(){s.unsuspend=null,clearTimeout(f),clearTimeout(x)}}:null}function Cd(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)Rd(this,this.stylesheets);else if(this.unsuspend){var s=this.unsuspend;this.unsuspend=null,s()}}}var kd=null;function Rd(s,i){s.stylesheets=null,s.unsuspend!==null&&(s.count++,kd=new Map,i.forEach(wk,s),kd=null,Cd.call(s))}function wk(s,i){if(!(i.state.loading&4)){var c=kd.get(s);if(c)var f=c.get(null);else{c=new Map,kd.set(s,c);for(var x=s.querySelectorAll("link[data-precedence],style[data-precedence]"),y=0;y<x.length;y++){var C=x[y];(C.nodeName==="LINK"||C.getAttribute("media")!=="not all")&&(c.set(C.dataset.precedence,C),f=C)}f&&c.set(null,f)}x=i.instance,C=x.getAttribute("data-precedence"),y=c.get(C)||f,y===f&&c.set(null,x),c.set(C,x),this.count++,f=Cd.bind(this),x.addEventListener("load",f),x.addEventListener("error",f),y?y.parentNode.insertBefore(x,y.nextSibling):(s=s.nodeType===9?s.head:s,s.insertBefore(x,s.firstChild)),i.state.loading|=4}}var zu={$$typeof:R,Provider:null,Consumer:null,_currentValue:pe,_currentValue2:pe,_threadCount:0};function Tk(s,i,c,f,x,y,C,G,ie){this.tag=1,this.containerInfo=s,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Cn(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Cn(0),this.hiddenUpdates=Cn(null),this.identifierPrefix=f,this.onUncaughtError=x,this.onCaughtError=y,this.onRecoverableError=C,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=ie,this.incompleteTransitions=new Map}function qw(s,i,c,f,x,y,C,G,ie,Ee,Ie,je){return s=new Tk(s,i,c,C,ie,Ee,Ie,je,G),i=1,y===!0&&(i|=24),y=_a(3,null,null,i),s.current=y,y.stateNode=s,i=Qm(),i.refCount++,s.pooledCache=i,i.refCount++,y.memoizedState={element:f,isDehydrated:c,cache:i},tp(y),s}function Ww(s){return s?(s=Ko,s):Ko}function Kw(s,i,c,f,x,y){x=Ww(x),f.context===null?f.context=x:f.pendingContext=x,f=zi(i),f.payload={element:c},y=y===void 0?null:y,y!==null&&(f.callback=y),c=Hi(s,f,i),c!==null&&(fa(c,s,i),_u(c,s,i))}function Yw(s,i){if(s=s.memoizedState,s!==null&&s.dehydrated!==null){var c=s.retryLane;s.retryLane=c!==0&&c<i?c:i}}function yg(s,i){Yw(s,i),(s=s.alternate)&&Yw(s,i)}function $w(s){if(s.tag===13||s.tag===31){var i=zl(s,67108864);i!==null&&fa(i,s,67108864),yg(s,67108864)}}function Xw(s){if(s.tag===13||s.tag===31){var i=Sa();i=Be(i);var c=zl(s,i);c!==null&&fa(c,s,i),yg(s,i)}}var Dd=!0;function Ek(s,i,c,f){var x=ae.T;ae.T=null;var y=ue.p;try{ue.p=2,_g(s,i,c,f)}finally{ue.p=y,ae.T=x}}function bk(s,i,c,f){var x=ae.T;ae.T=null;var y=ue.p;try{ue.p=8,_g(s,i,c,f)}finally{ue.p=y,ae.T=x}}function _g(s,i,c,f){if(Dd){var x=wg(f);if(x===null)ig(s,i,f,Id,c),Jw(s,f);else if(Ak(x,s,i,c,f))f.stopPropagation();else if(Jw(s,f),i&4&&-1<Sk.indexOf(s)){for(;x!==null;){var y=Ye(x);if(y!==null)switch(y.tag){case 3:if(y=y.stateNode,y.current.memoizedState.isDehydrated){var C=an(y.pendingLanes);if(C!==0){var G=y;for(G.pendingLanes|=2,G.entangledLanes|=2;C;){var ie=1<<31-Ur(C);G.entanglements[1]|=ie,C&=~ie}Ns(y),(Xt&6)===0&&(md=pt()+500,Fu(0))}}break;case 31:case 13:G=zl(y,2),G!==null&&fa(G,y,2),gd(),yg(y,2)}if(y=wg(f),y===null&&ig(s,i,f,Id,c),y===x)break;x=y}x!==null&&f.stopPropagation()}else ig(s,i,f,null,c)}}function wg(s){return s=Uo(s),Tg(s)}var Id=null;function Tg(s){if(Id=null,s=Ge(s),s!==null){var i=l(s);if(i===null)s=null;else{var c=i.tag;if(c===13){if(s=o(i),s!==null)return s;s=null}else if(c===31){if(s=u(i),s!==null)return s;s=null}else if(c===3){if(i.stateNode.current.memoizedState.isDehydrated)return i.tag===3?i.stateNode.containerInfo:null;s=null}else i!==s&&(s=null)}}return Id=s,null}function Qw(s){switch(s){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(hr()){case kt:return 2;case $t:return 8;case Ut:case dr:return 32;case lt:return 268435456;default:return 32}default:return 32}}var Eg=!1,el=null,tl=null,rl=null,Hu=new Map,Gu=new Map,nl=[],Sk="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function Jw(s,i){switch(s){case"focusin":case"focusout":el=null;break;case"dragenter":case"dragleave":tl=null;break;case"mouseover":case"mouseout":rl=null;break;case"pointerover":case"pointerout":Hu.delete(i.pointerId);break;case"gotpointercapture":case"lostpointercapture":Gu.delete(i.pointerId)}}function qu(s,i,c,f,x,y){return s===null||s.nativeEvent!==y?(s={blockedOn:i,domEventName:c,eventSystemFlags:f,nativeEvent:y,targetContainers:[x]},i!==null&&(i=Ye(i),i!==null&&$w(i)),s):(s.eventSystemFlags|=f,i=s.targetContainers,x!==null&&i.indexOf(x)===-1&&i.push(x),s)}function Ak(s,i,c,f,x){switch(i){case"focusin":return el=qu(el,s,i,c,f,x),!0;case"dragenter":return tl=qu(tl,s,i,c,f,x),!0;case"mouseover":return rl=qu(rl,s,i,c,f,x),!0;case"pointerover":var y=x.pointerId;return Hu.set(y,qu(Hu.get(y)||null,s,i,c,f,x)),!0;case"gotpointercapture":return y=x.pointerId,Gu.set(y,qu(Gu.get(y)||null,s,i,c,f,x)),!0}return!1}function Zw(s){var i=Ge(s.target);if(i!==null){var c=l(i);if(c!==null){if(i=c.tag,i===13){if(i=o(c),i!==null){s.blockedOn=i,Y(s.priority,function(){Xw(c)});return}}else if(i===31){if(i=u(c),i!==null){s.blockedOn=i,Y(s.priority,function(){Xw(c)});return}}else if(i===3&&c.stateNode.current.memoizedState.isDehydrated){s.blockedOn=c.tag===3?c.stateNode.containerInfo:null;return}}}s.blockedOn=null}function Od(s){if(s.blockedOn!==null)return!1;for(var i=s.targetContainers;0<i.length;){var c=wg(s.nativeEvent);if(c===null){c=s.nativeEvent;var f=new c.constructor(c.type,c);Lo=f,c.target.dispatchEvent(f),Lo=null}else return i=Ye(c),i!==null&&$w(i),s.blockedOn=c,!1;i.shift()}return!0}function e2(s,i,c){Od(s)&&c.delete(i)}function Nk(){Eg=!1,el!==null&&Od(el)&&(el=null),tl!==null&&Od(tl)&&(tl=null),rl!==null&&Od(rl)&&(rl=null),Hu.forEach(e2),Gu.forEach(e2)}function Md(s,i){s.blockedOn===i&&(s.blockedOn=null,Eg||(Eg=!0,t.unstable_scheduleCallback(t.unstable_NormalPriority,Nk)))}var jd=null;function t2(s){jd!==s&&(jd=s,t.unstable_scheduleCallback(t.unstable_NormalPriority,function(){jd===s&&(jd=null);for(var i=0;i<s.length;i+=3){var c=s[i],f=s[i+1],x=s[i+2];if(typeof f!="function"){if(Tg(f||c)===null)continue;break}var y=Ye(c);y!==null&&(s.splice(i,3),i-=3,wp(y,{pending:!0,data:x,method:c.method,action:f},f,x))}}))}function xc(s){function i(ie){return Md(ie,s)}el!==null&&Md(el,s),tl!==null&&Md(tl,s),rl!==null&&Md(rl,s),Hu.forEach(i),Gu.forEach(i);for(var c=0;c<nl.length;c++){var f=nl[c];f.blockedOn===s&&(f.blockedOn=null)}for(;0<nl.length&&(c=nl[0],c.blockedOn===null);)Zw(c),c.blockedOn===null&&nl.shift();if(c=(s.ownerDocument||s).$$reactFormReplay,c!=null)for(f=0;f<c.length;f+=3){var x=c[f],y=c[f+1],C=x[W]||null;if(typeof y=="function")C||t2(c);else if(C){var G=null;if(y&&y.hasAttribute("formAction")){if(x=y,C=y[W]||null)G=C.formAction;else if(Tg(x)!==null)continue}else G=C.action;typeof G=="function"?c[f+1]=G:(c.splice(f,3),f-=3),t2(c)}}}function r2(){function s(y){y.canIntercept&&y.info==="react-transition"&&y.intercept({handler:function(){return new Promise(function(C){return x=C})},focusReset:"manual",scroll:"manual"})}function i(){x!==null&&(x(),x=null),f||setTimeout(c,20)}function c(){if(!f&&!navigation.transition){var y=navigation.currentEntry;y&&y.url!=null&&navigation.navigate(y.url,{state:y.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var f=!1,x=null;return navigation.addEventListener("navigate",s),navigation.addEventListener("navigatesuccess",i),navigation.addEventListener("navigateerror",i),setTimeout(c,100),function(){f=!0,navigation.removeEventListener("navigate",s),navigation.removeEventListener("navigatesuccess",i),navigation.removeEventListener("navigateerror",i),x!==null&&(x(),x=null)}}}function bg(s){this._internalRoot=s}Fd.prototype.render=bg.prototype.render=function(s){var i=this._internalRoot;if(i===null)throw Error(n(409));var c=i.current,f=Sa();Kw(c,f,s,i,null,null)},Fd.prototype.unmount=bg.prototype.unmount=function(){var s=this._internalRoot;if(s!==null){this._internalRoot=null;var i=s.containerInfo;Kw(s.current,2,null,s,null,null),gd(),i[K]=null}};function Fd(s){this._internalRoot=s}Fd.prototype.unstable_scheduleHydration=function(s){if(s){var i=O();s={blockedOn:null,target:s,priority:i};for(var c=0;c<nl.length&&i!==0&&i<nl[c].priority;c++);nl.splice(c,0,s),c===0&&Zw(s)}};var n2=e.version;if(n2!=="19.2.1")throw Error(n(527,n2,"19.2.1"));ue.findDOMNode=function(s){var i=s._reactInternals;if(i===void 0)throw typeof s.render=="function"?Error(n(188)):(s=Object.keys(s).join(","),Error(n(268,s)));return s=m(i),s=s!==null?p(s):null,s=s===null?null:s.stateNode,s};var Ck={bundleType:0,version:"19.2.1",rendererPackageName:"react-dom",currentDispatcherRef:ae,reconcilerVersion:"19.2.1"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Pd=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Pd.isDisabled&&Pd.supportsFiber)try{St=Pd.inject(Ck),or=Pd}catch{}}return Ku.createRoot=function(s,i){if(!a(s))throw Error(n(299));var c=!1,f="",x=u_,y=f_,C=h_;return i!=null&&(i.unstable_strictMode===!0&&(c=!0),i.identifierPrefix!==void 0&&(f=i.identifierPrefix),i.onUncaughtError!==void 0&&(x=i.onUncaughtError),i.onCaughtError!==void 0&&(y=i.onCaughtError),i.onRecoverableError!==void 0&&(C=i.onRecoverableError)),i=qw(s,1,!1,null,null,c,f,null,x,y,C,r2),s[K]=i.current,sg(s),new bg(i)},Ku.hydrateRoot=function(s,i,c){if(!a(s))throw Error(n(299));var f=!1,x="",y=u_,C=f_,G=h_,ie=null;return c!=null&&(c.unstable_strictMode===!0&&(f=!0),c.identifierPrefix!==void 0&&(x=c.identifierPrefix),c.onUncaughtError!==void 0&&(y=c.onUncaughtError),c.onCaughtError!==void 0&&(C=c.onCaughtError),c.onRecoverableError!==void 0&&(G=c.onRecoverableError),c.formState!==void 0&&(ie=c.formState)),i=qw(s,1,!0,i,c??null,f,x,ie,y,C,G,r2),i.context=Ww(null),c=i.current,f=Sa(),f=Be(f),x=zi(f),x.callback=null,Hi(c,x,f),c=f,i.current.lanes=c,La(i,c),Ns(i),s[K]=i.current,sg(s),new Fd(i)},Ku.version="19.2.1",Ku}var d2;function Lk(){if(d2)return Ng.exports;d2=1;function t(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(t)}catch(e){console.error(e)}}return t(),Ng.exports=Pk(),Ng.exports}var Uk=Lk();const Bk=Xx(Uk);var db=hb();const Vk=Xx(db),zk=fb({__proto__:null,default:Vk},[db]);function wr(){return wr=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},wr.apply(this,arguments)}var Xr;(function(t){t.Pop="POP",t.Push="PUSH",t.Replace="REPLACE"})(Xr||(Xr={}));const m2="popstate";function Hk(t){t===void 0&&(t={});function e(n,a){let{pathname:l,search:o,hash:u}=n.location;return Af("",{pathname:l,search:o,hash:u},a.state&&a.state.usr||null,a.state&&a.state.key||"default")}function r(n,a){return typeof a=="string"?a:go(a)}return qk(e,r,null,t)}function bt(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function po(t,e){if(!t){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function Gk(){return Math.random().toString(36).substr(2,8)}function p2(t,e){return{usr:t.state,key:t.key,idx:e}}function Af(t,e,r,n){return r===void 0&&(r=null),wr({pathname:typeof t=="string"?t:t.pathname,search:"",hash:""},typeof e=="string"?Cl(e):e,{state:r,key:e&&e.key||n||Gk()})}function go(t){let{pathname:e="/",search:r="",hash:n=""}=t;return r&&r!=="?"&&(e+=r.charAt(0)==="?"?r:"?"+r),n&&n!=="#"&&(e+=n.charAt(0)==="#"?n:"#"+n),e}function Cl(t){let e={};if(t){let r=t.indexOf("#");r>=0&&(e.hash=t.substr(r),t=t.substr(0,r));let n=t.indexOf("?");n>=0&&(e.search=t.substr(n),t=t.substr(0,n)),t&&(e.pathname=t)}return e}function qk(t,e,r,n){n===void 0&&(n={});let{window:a=document.defaultView,v5Compat:l=!1}=n,o=a.history,u=Xr.Pop,h=null,m=p();m==null&&(m=0,o.replaceState(wr({},o.state,{idx:m}),""));function p(){return(o.state||{idx:null}).idx}function v(){u=Xr.Pop;let A=p(),M=A==null?null:A-m;m=A,h&&h({action:u,location:T.location,delta:M})}function _(A,M){u=Xr.Push;let F=Af(T.location,A,M);m=p()+1;let R=p2(F,m),z=T.createHref(F);try{o.pushState(R,"",z)}catch(re){if(re instanceof DOMException&&re.name==="DataCloneError")throw re;a.location.assign(z)}l&&h&&h({action:u,location:T.location,delta:1})}function w(A,M){u=Xr.Replace;let F=Af(T.location,A,M);m=p();let R=p2(F,m),z=T.createHref(F);o.replaceState(R,"",z),l&&h&&h({action:u,location:T.location,delta:0})}function E(A){let M=a.location.origin!=="null"?a.location.origin:a.location.href,F=typeof A=="string"?A:go(A);return F=F.replace(/ $/,"%20"),bt(M,"No window.location.(origin|href) available to create URL for href: "+F),new URL(F,M)}let T={get action(){return u},get location(){return t(a,o)},listen(A){if(h)throw new Error("A history only accepts one active listener");return a.addEventListener(m2,v),h=A,()=>{a.removeEventListener(m2,v),h=null}},createHref(A){return e(a,A)},createURL:E,encodeLocation(A){let M=E(A);return{pathname:M.pathname,search:M.search,hash:M.hash}},push:_,replace:w,go(A){return o.go(A)}};return T}var nr;(function(t){t.data="data",t.deferred="deferred",t.redirect="redirect",t.error="error"})(nr||(nr={}));const Wk=new Set(["lazy","caseSensitive","path","id","index","children"]);function Kk(t){return t.index===!0}function m0(t,e,r,n){return r===void 0&&(r=[]),n===void 0&&(n={}),t.map((a,l)=>{let o=[...r,String(l)],u=typeof a.id=="string"?a.id:o.join("-");if(bt(a.index!==!0||!a.children,"Cannot specify children on an index route"),bt(!n[u],'Found a route id collision on id "'+u+`".  Route id's must be globally unique within Data Router usages`),Kk(a)){let h=wr({},a,e(a),{id:u});return n[u]=h,h}else{let h=wr({},a,e(a),{id:u,children:void 0});return n[u]=h,a.children&&(h.children=m0(a.children,e,o,n)),h}})}function ro(t,e,r){return r===void 0&&(r="/"),r0(t,e,r,!1)}function r0(t,e,r,n){let a=typeof e=="string"?Cl(e):e,l=xi(a.pathname||"/",r);if(l==null)return null;let o=mb(t);$k(o);let u=null;for(let h=0;u==null&&h<o.length;++h){let m=iR(l);u=aR(o[h],m,n)}return u}function Yk(t,e){let{route:r,pathname:n,params:a}=t;return{id:r.id,pathname:n,params:a,data:e[r.id],handle:r.handle}}function mb(t,e,r,n){e===void 0&&(e=[]),r===void 0&&(r=[]),n===void 0&&(n="");let a=(l,o,u)=>{let h={relativePath:u===void 0?l.path||"":u,caseSensitive:l.caseSensitive===!0,childrenIndex:o,route:l};h.relativePath.startsWith("/")&&(bt(h.relativePath.startsWith(n),'Absolute route path "'+h.relativePath+'" nested under path '+('"'+n+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),h.relativePath=h.relativePath.slice(n.length));let m=di([n,h.relativePath]),p=r.concat(h);l.children&&l.children.length>0&&(bt(l.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+m+'".')),mb(l.children,e,p,m)),!(l.path==null&&!l.index)&&e.push({path:m,score:rR(m,l.index),routesMeta:p})};return t.forEach((l,o)=>{var u;if(l.path===""||!((u=l.path)!=null&&u.includes("?")))a(l,o);else for(let h of pb(l.path))a(l,o,h)}),e}function pb(t){let e=t.split("/");if(e.length===0)return[];let[r,...n]=e,a=r.endsWith("?"),l=r.replace(/\?$/,"");if(n.length===0)return a?[l,""]:[l];let o=pb(n.join("/")),u=[];return u.push(...o.map(h=>h===""?l:[l,h].join("/"))),a&&u.push(...o),u.map(h=>t.startsWith("/")&&h===""?"/":h)}function $k(t){t.sort((e,r)=>e.score!==r.score?r.score-e.score:nR(e.routesMeta.map(n=>n.childrenIndex),r.routesMeta.map(n=>n.childrenIndex)))}const Xk=/^:[\w-]+$/,Qk=3,Jk=2,Zk=1,eR=10,tR=-2,g2=t=>t==="*";function rR(t,e){let r=t.split("/"),n=r.length;return r.some(g2)&&(n+=tR),e&&(n+=Jk),r.filter(a=>!g2(a)).reduce((a,l)=>a+(Xk.test(l)?Qk:l===""?Zk:eR),n)}function nR(t,e){return t.length===e.length&&t.slice(0,-1).every((n,a)=>n===e[a])?t[t.length-1]-e[e.length-1]:0}function aR(t,e,r){r===void 0&&(r=!1);let{routesMeta:n}=t,a={},l="/",o=[];for(let u=0;u<n.length;++u){let h=n[u],m=u===n.length-1,p=l==="/"?e:e.slice(l.length)||"/",v=p0({path:h.relativePath,caseSensitive:h.caseSensitive,end:m},p),_=h.route;if(!v&&m&&r&&!n[n.length-1].route.index&&(v=p0({path:h.relativePath,caseSensitive:h.caseSensitive,end:!1},p)),!v)return null;Object.assign(a,v.params),o.push({params:a,pathname:di([l,v.pathname]),pathnameBase:uR(di([l,v.pathnameBase])),route:_}),v.pathnameBase!=="/"&&(l=di([l,v.pathnameBase]))}return o}function p0(t,e){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[r,n]=sR(t.path,t.caseSensitive,t.end),a=e.match(r);if(!a)return null;let l=a[0],o=l.replace(/(.)\/+$/,"$1"),u=a.slice(1);return{params:n.reduce((m,p,v)=>{let{paramName:_,isOptional:w}=p;if(_==="*"){let T=u[v]||"";o=l.slice(0,l.length-T.length).replace(/(.)\/+$/,"$1")}const E=u[v];return w&&!E?m[_]=void 0:m[_]=(E||"").replace(/%2F/g,"/"),m},{}),pathname:l,pathnameBase:o,pattern:t}}function sR(t,e,r){e===void 0&&(e=!1),r===void 0&&(r=!0),po(t==="*"||!t.endsWith("*")||t.endsWith("/*"),'Route path "'+t+'" will be treated as if it were '+('"'+t.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+t.replace(/\*$/,"/*")+'".'));let n=[],a="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(o,u,h)=>(n.push({paramName:u,isOptional:h!=null}),h?"/?([^\\/]+)?":"/([^\\/]+)"));return t.endsWith("*")?(n.push({paramName:"*"}),a+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):r?a+="\\/*$":t!==""&&t!=="/"&&(a+="(?:(?=\\/|$))"),[new RegExp(a,e?void 0:"i"),n]}function iR(t){try{return t.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return po(!1,'The URL path "'+t+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+e+").")),t}}function xi(t,e){if(e==="/")return t;if(!t.toLowerCase().startsWith(e.toLowerCase()))return null;let r=e.endsWith("/")?e.length-1:e.length,n=t.charAt(r);return n&&n!=="/"?null:t.slice(r)||"/"}const lR=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,oR=t=>lR.test(t);function cR(t,e){e===void 0&&(e="/");let{pathname:r,search:n="",hash:a=""}=typeof t=="string"?Cl(t):t,l;if(r)if(oR(r))l=r;else{if(r.includes("//")){let o=r;r=r.replace(/\/\/+/g,"/"),po(!1,"Pathnames cannot have embedded double slashes - normalizing "+(o+" -> "+r))}r.startsWith("/")?l=x2(r.substring(1),"/"):l=x2(r,e)}else l=e;return{pathname:l,search:fR(n),hash:hR(a)}}function x2(t,e){let r=e.replace(/\/+$/,"").split("/");return t.split("/").forEach(a=>{a===".."?r.length>1&&r.pop():a!=="."&&r.push(a)}),r.length>1?r.join("/"):"/"}function Dg(t,e,r,n){return"Cannot include a '"+t+"' character in a manually specified "+("`to."+e+"` field ["+JSON.stringify(n)+"].  Please separate it out to the ")+("`to."+r+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function gb(t){return t.filter((e,r)=>r===0||e.route.path&&e.route.path.length>0)}function W0(t,e){let r=gb(t);return e?r.map((n,a)=>a===r.length-1?n.pathname:n.pathnameBase):r.map(n=>n.pathnameBase)}function K0(t,e,r,n){n===void 0&&(n=!1);let a;typeof t=="string"?a=Cl(t):(a=wr({},t),bt(!a.pathname||!a.pathname.includes("?"),Dg("?","pathname","search",a)),bt(!a.pathname||!a.pathname.includes("#"),Dg("#","pathname","hash",a)),bt(!a.search||!a.search.includes("#"),Dg("#","search","hash",a)));let l=t===""||a.pathname==="",o=l?"/":a.pathname,u;if(o==null)u=r;else{let v=e.length-1;if(!n&&o.startsWith("..")){let _=o.split("/");for(;_[0]==="..";)_.shift(),v-=1;a.pathname=_.join("/")}u=v>=0?e[v]:"/"}let h=cR(a,u),m=o&&o!=="/"&&o.endsWith("/"),p=(l||o===".")&&r.endsWith("/");return!h.pathname.endsWith("/")&&(m||p)&&(h.pathname+="/"),h}const di=t=>t.join("/").replace(/\/\/+/g,"/"),uR=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),fR=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,hR=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t;class g0{constructor(e,r,n,a){a===void 0&&(a=!1),this.status=e,this.statusText=r||"",this.internal=a,n instanceof Error?(this.data=n.toString(),this.error=n):this.data=n}}function Nf(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}const xb=["post","put","patch","delete"],dR=new Set(xb),mR=["get",...xb],pR=new Set(mR),gR=new Set([301,302,303,307,308]),xR=new Set([307,308]),Ig={state:"idle",location:void 0,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0},vR={state:"idle",data:void 0,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0},Yu={state:"unblocked",proceed:void 0,reset:void 0,location:void 0},Jx=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,yR=t=>({hasErrorBoundary:!!t.hasErrorBoundary}),vb="remix-router-transitions";function _R(t){const e=t.window?t.window:typeof window<"u"?window:void 0,r=typeof e<"u"&&typeof e.document<"u"&&typeof e.document.createElement<"u",n=!r;bt(t.routes.length>0,"You must provide a non-empty routes array to createRouter");let a;if(t.mapRouteProperties)a=t.mapRouteProperties;else if(t.detectErrorBoundary){let le=t.detectErrorBoundary;a=de=>({hasErrorBoundary:le(de)})}else a=yR;let l={},o=m0(t.routes,a,void 0,l),u,h=t.basename||"/",m=t.dataStrategy||bR,p=t.patchRoutesOnNavigation,v=wr({v7_fetcherPersist:!1,v7_normalizeFormMethod:!1,v7_partialHydration:!1,v7_prependBasename:!1,v7_relativeSplatPath:!1,v7_skipActionErrorRevalidation:!1},t.future),_=null,w=new Set,E=null,T=null,A=null,M=t.hydrationData!=null,F=ro(o,t.history.location,h),R=!1,z=null;if(F==null&&!p){let le=ha(404,{pathname:t.history.location.pathname}),{matches:de,route:Ae}=C2(o);F=de,z={[Ae.id]:le}}F&&!t.hydrationData&&Pa(F,o,t.history.location.pathname).active&&(F=null);let re;if(F)if(F.some(le=>le.route.lazy))re=!1;else if(!F.some(le=>le.route.loader))re=!0;else if(v.v7_partialHydration){let le=t.hydrationData?t.hydrationData.loaderData:null,de=t.hydrationData?t.hydrationData.errors:null;if(de){let Ae=F.findIndex(Be=>de[Be.route.id]!==void 0);re=F.slice(0,Ae+1).every(Be=>!sx(Be.route,le,de))}else re=F.every(Ae=>!sx(Ae.route,le,de))}else re=t.hydrationData!=null;else if(re=!1,F=[],v.v7_partialHydration){let le=Pa(null,o,t.history.location.pathname);le.active&&le.matches&&(R=!0,F=le.matches)}let te,b={historyAction:t.history.action,location:t.history.location,matches:F,initialized:re,navigation:Ig,restoreScrollPosition:t.hydrationData!=null?!1:null,preventScrollReset:!1,revalidation:"idle",loaderData:t.hydrationData&&t.hydrationData.loaderData||{},actionData:t.hydrationData&&t.hydrationData.actionData||null,errors:t.hydrationData&&t.hydrationData.errors||z,fetchers:new Map,blockers:new Map},N=Xr.Pop,k=!1,j,L=!1,P=new Map,U=null,Ce=!1,Ne=!1,ae=[],ue=new Set,pe=new Map,ne=0,be=-1,Q=new Map,I=new Set,Z=new Map,ee=new Map,B=new Set,se=new Map,_e=new Map,Pe;function he(){if(_=t.history.listen(le=>{let{action:de,location:Ae,delta:Be}=le;if(Pe){Pe(),Pe=void 0;return}po(_e.size===0||Be!=null,"You are trying to use a blocker on a POP navigation to a location that was not created by @remix-run/router. This will fail silently in production. This can happen if you are navigating outside the router via `window.history.pushState`/`window.location.hash` instead of using router navigation APIs.  This can also happen if you are using createHashRouter and the user manually changes the URL.");let Ke=ga({currentLocation:b.location,nextLocation:Ae,historyAction:de});if(Ke&&Be!=null){let O=new Promise(Y=>{Pe=Y});t.history.go(Be*-1),ja(Ke,{state:"blocked",location:Ae,proceed(){ja(Ke,{state:"proceeding",proceed:void 0,reset:void 0,location:Ae}),O.then(()=>t.history.go(Be))},reset(){let Y=new Map(b.blockers);Y.set(Ke,Yu),J({blockers:Y})}});return}return Ue(de,Ae)}),r){LR(e,P);let le=()=>UR(e,P);e.addEventListener("pagehide",le),U=()=>e.removeEventListener("pagehide",le)}return b.initialized||Ue(Xr.Pop,b.location,{initialHydration:!0}),te}function we(){_&&_(),U&&U(),w.clear(),j&&j.abort(),b.fetchers.forEach((le,de)=>Zt(de)),b.blockers.forEach((le,de)=>rs(de))}function He(le){return w.add(le),()=>w.delete(le)}function J(le,de){de===void 0&&(de={}),b=wr({},b,le);let Ae=[],Be=[];v.v7_fetcherPersist&&b.fetchers.forEach((Ke,O)=>{Ke.state==="idle"&&(B.has(O)?Be.push(O):Ae.push(O))}),B.forEach(Ke=>{!b.fetchers.has(Ke)&&!pe.has(Ke)&&Be.push(Ke)}),[...w].forEach(Ke=>Ke(b,{deletedFetchers:Be,viewTransitionOpts:de.viewTransitionOpts,flushSync:de.flushSync===!0})),v.v7_fetcherPersist?(Ae.forEach(Ke=>b.fetchers.delete(Ke)),Be.forEach(Ke=>Zt(Ke))):Be.forEach(Ke=>B.delete(Ke))}function Qe(le,de,Ae){var Be,Ke;let{flushSync:O}=Ae===void 0?{}:Ae,Y=b.actionData!=null&&b.navigation.formMethod!=null&&us(b.navigation.formMethod)&&b.navigation.state==="loading"&&((Be=le.state)==null?void 0:Be._isRedirect)!==!0,V;de.actionData?Object.keys(de.actionData).length>0?V=de.actionData:V=null:Y?V=b.actionData:V=null;let H=de.loaderData?A2(b.loaderData,de.loaderData,de.matches||[],de.errors):b.loaderData,W=b.blockers;W.size>0&&(W=new Map(W),W.forEach((ve,xe)=>W.set(xe,Yu)));let K=k===!0||b.navigation.formMethod!=null&&us(b.navigation.formMethod)&&((Ke=le.state)==null?void 0:Ke._isRedirect)!==!0;u&&(o=u,u=void 0),Ce||N===Xr.Pop||(N===Xr.Push?t.history.push(le,le.state):N===Xr.Replace&&t.history.replace(le,le.state));let oe;if(N===Xr.Pop){let ve=P.get(b.location.pathname);ve&&ve.has(le.pathname)?oe={currentLocation:b.location,nextLocation:le}:P.has(le.pathname)&&(oe={currentLocation:le,nextLocation:b.location})}else if(L){let ve=P.get(b.location.pathname);ve?ve.add(le.pathname):(ve=new Set([le.pathname]),P.set(b.location.pathname,ve)),oe={currentLocation:b.location,nextLocation:le}}J(wr({},de,{actionData:V,loaderData:H,historyAction:N,location:le,initialized:!0,navigation:Ig,revalidation:"idle",restoreScrollPosition:ns(le,de.matches||b.matches),preventScrollReset:K,blockers:W}),{viewTransitionOpts:oe,flushSync:O===!0}),N=Xr.Pop,k=!1,L=!1,Ce=!1,Ne=!1,ae=[]}async function $e(le,de){if(typeof le=="number"){t.history.go(le);return}let Ae=ax(b.location,b.matches,h,v.v7_prependBasename,le,v.v7_relativeSplatPath,de?.fromRouteId,de?.relative),{path:Be,submission:Ke,error:O}=v2(v.v7_normalizeFormMethod,!1,Ae,de),Y=b.location,V=Af(b.location,Be,de&&de.state);V=wr({},V,t.history.encodeLocation(V));let H=de&&de.replace!=null?de.replace:void 0,W=Xr.Push;H===!0?W=Xr.Replace:H===!1||Ke!=null&&us(Ke.formMethod)&&Ke.formAction===b.location.pathname+b.location.search&&(W=Xr.Replace);let K=de&&"preventScrollReset"in de?de.preventScrollReset===!0:void 0,oe=(de&&de.flushSync)===!0,ve=ga({currentLocation:Y,nextLocation:V,historyAction:W});if(ve){ja(ve,{state:"blocked",location:V,proceed(){ja(ve,{state:"proceeding",proceed:void 0,reset:void 0,location:V}),$e(le,de)},reset(){let xe=new Map(b.blockers);xe.set(ve,Yu),J({blockers:xe})}});return}return await Ue(W,V,{submission:Ke,pendingError:O,preventScrollReset:K,replace:de&&de.replace,enableViewTransition:de&&de.viewTransition,flushSync:oe})}function Fe(){if($t(),J({revalidation:"loading"}),b.navigation.state!=="submitting"){if(b.navigation.state==="idle"){Ue(b.historyAction,b.location,{startUninterruptedRevalidation:!0});return}Ue(N||b.historyAction,b.navigation.location,{overrideNavigation:b.navigation,enableViewTransition:L===!0})}}async function Ue(le,de,Ae){j&&j.abort(),j=null,N=le,Ce=(Ae&&Ae.startUninterruptedRevalidation)===!0,Fa(b.location,b.matches),k=(Ae&&Ae.preventScrollReset)===!0,L=(Ae&&Ae.enableViewTransition)===!0;let Be=u||o,Ke=Ae&&Ae.overrideNavigation,O=Ae!=null&&Ae.initialHydration&&b.matches&&b.matches.length>0&&!R?b.matches:ro(Be,de,h),Y=(Ae&&Ae.flushSync)===!0;if(O&&b.initialized&&!Ne&&RR(b.location,de)&&!(Ae&&Ae.submission&&us(Ae.submission.formMethod))){Qe(de,{matches:O},{flushSync:Y});return}let V=Pa(O,Be,de.pathname);if(V.active&&V.matches&&(O=V.matches),!O){let{error:me,notFoundMatches:fe,route:Oe}=Nn(de.pathname);Qe(de,{matches:fe,loaderData:{},errors:{[Oe.id]:me}},{flushSync:Y});return}j=new AbortController;let H=vc(t.history,de,j.signal,Ae&&Ae.submission),W;if(Ae&&Ae.pendingError)W=[no(O).route.id,{type:nr.error,error:Ae.pendingError}];else if(Ae&&Ae.submission&&us(Ae.submission.formMethod)){let me=await De(H,de,Ae.submission,O,V.active,{replace:Ae.replace,flushSync:Y});if(me.shortCircuited)return;if(me.pendingActionResult){let[fe,Oe]=me.pendingActionResult;if(Aa(Oe)&&Nf(Oe.error)&&Oe.error.status===404){j=null,Qe(de,{matches:me.matches,loaderData:{},errors:{[fe]:Oe.error}});return}}O=me.matches||O,W=me.pendingActionResult,Ke=Og(de,Ae.submission),Y=!1,V.active=!1,H=vc(t.history,H.url,H.signal)}let{shortCircuited:K,matches:oe,loaderData:ve,errors:xe}=await ut(H,de,O,V.active,Ke,Ae&&Ae.submission,Ae&&Ae.fetcherSubmission,Ae&&Ae.replace,Ae&&Ae.initialHydration===!0,Y,W);K||(j=null,Qe(de,wr({matches:oe||O},N2(W),{loaderData:ve,errors:xe})))}async function De(le,de,Ae,Be,Ke,O){O===void 0&&(O={}),$t();let Y=FR(de,Ae);if(J({navigation:Y},{flushSync:O.flushSync===!0}),Ke){let W=await Cn(Be,de.pathname,le.signal);if(W.type==="aborted")return{shortCircuited:!0};if(W.type==="error"){let K=no(W.partialMatches).route.id;return{matches:W.partialMatches,pendingActionResult:[K,{type:nr.error,error:W.error}]}}else if(W.matches)Be=W.matches;else{let{notFoundMatches:K,error:oe,route:ve}=Nn(de.pathname);return{matches:K,pendingActionResult:[ve.id,{type:nr.error,error:oe}]}}}let V,H=Zu(Be,de);if(!H.route.action&&!H.route.lazy)V={type:nr.error,error:ha(405,{method:le.method,pathname:de.pathname,routeId:H.route.id})};else if(V=(await hr("action",b,le,[H],Be,null))[H.route.id],le.signal.aborted)return{shortCircuited:!0};if(so(V)){let W;return O&&O.replace!=null?W=O.replace:W=E2(V.response.headers.get("Location"),new URL(le.url),h)===b.location.pathname+b.location.search,await pt(le,V,!0,{submission:Ae,replace:W}),{shortCircuited:!0}}if(ml(V))throw ha(400,{type:"defer-action"});if(Aa(V)){let W=no(Be,H.route.id);return(O&&O.replace)!==!0&&(N=Xr.Push),{matches:Be,pendingActionResult:[W.route.id,V]}}return{matches:Be,pendingActionResult:[H.route.id,V]}}async function ut(le,de,Ae,Be,Ke,O,Y,V,H,W,K){let oe=Ke||Og(de,O),ve=O||Y||R2(oe),xe=!Ce&&(!v.v7_partialHydration||!H);if(Be){if(xe){let Bt=Lt(K);J(wr({navigation:oe},Bt!==void 0?{actionData:Bt}:{}),{flushSync:W})}let xt=await Cn(Ae,de.pathname,le.signal);if(xt.type==="aborted")return{shortCircuited:!0};if(xt.type==="error"){let Bt=no(xt.partialMatches).route.id;return{matches:xt.partialMatches,loaderData:{},errors:{[Bt]:xt.error}}}else if(xt.matches)Ae=xt.matches;else{let{error:Bt,notFoundMatches:Br,route:aa}=Nn(de.pathname);return{matches:Br,loaderData:{},errors:{[aa.id]:Bt}}}}let me=u||o,[fe,Oe]=_2(t.history,b,Ae,ve,de,v.v7_partialHydration&&H===!0,v.v7_skipActionErrorRevalidation,Ne,ae,ue,B,Z,I,me,h,K);if(na(xt=>!(Ae&&Ae.some(Bt=>Bt.route.id===xt))||fe&&fe.some(Bt=>Bt.route.id===xt)),be=++ne,fe.length===0&&Oe.length===0){let xt=nn();return Qe(de,wr({matches:Ae,loaderData:{},errors:K&&Aa(K[1])?{[K[0]]:K[1].error}:null},N2(K),xt?{fetchers:new Map(b.fetchers)}:{}),{flushSync:W}),{shortCircuited:!0}}if(xe){let xt={};if(!Be){xt.navigation=oe;let Bt=Lt(K);Bt!==void 0&&(xt.actionData=Bt)}Oe.length>0&&(xt.fetchers=Qt(Oe)),J(xt,{flushSync:W})}Oe.forEach(xt=>{St(xt.key),xt.controller&&pe.set(xt.key,xt.controller)});let Ge=()=>Oe.forEach(xt=>St(xt.key));j&&j.signal.addEventListener("abort",Ge);let{loaderResults:Ye,fetcherResults:Ve}=await kt(b,Ae,fe,Oe,le);if(le.signal.aborted)return{shortCircuited:!0};j&&j.signal.removeEventListener("abort",Ge),Oe.forEach(xt=>pe.delete(xt.key));let qe=Ld(Ye);if(qe)return await pt(le,qe.result,!0,{replace:V}),{shortCircuited:!0};if(qe=Ld(Ve),qe)return I.add(qe.key),await pt(le,qe.result,!0,{replace:V}),{shortCircuited:!0};let{loaderData:Xe,errors:Rt}=S2(b,Ae,Ye,K,Oe,Ve,se);se.forEach((xt,Bt)=>{xt.subscribe(Br=>{(Br||xt.done)&&se.delete(Bt)})}),v.v7_partialHydration&&H&&b.errors&&(Rt=wr({},b.errors,Rt));let wt=nn(),At=Ur(be),Mr=wt||At||Oe.length>0;return wr({matches:Ae,loaderData:Xe,errors:Rt},Mr?{fetchers:new Map(b.fetchers)}:{})}function Lt(le){if(le&&!Aa(le[1]))return{[le[0]]:le[1].data};if(b.actionData)return Object.keys(b.actionData).length===0?null:b.actionData}function Qt(le){return le.forEach(de=>{let Ae=b.fetchers.get(de.key),Be=$u(void 0,Ae?Ae.data:void 0);b.fetchers.set(de.key,Be)}),new Map(b.fetchers)}function yr(le,de,Ae,Be){if(n)throw new Error("router.fetch() was called during the server render, but it shouldn't be. You are likely calling a useFetcher() method in the body of your component. Try moving it to a useEffect or a callback.");St(le);let Ke=(Be&&Be.flushSync)===!0,O=u||o,Y=ax(b.location,b.matches,h,v.v7_prependBasename,Ae,v.v7_relativeSplatPath,de,Be?.relative),V=ro(O,Y,h),H=Pa(V,O,Y);if(H.active&&H.matches&&(V=H.matches),!V){dr(le,de,ha(404,{pathname:Y}),{flushSync:Ke});return}let{path:W,submission:K,error:oe}=v2(v.v7_normalizeFormMethod,!0,Y,Be);if(oe){dr(le,de,oe,{flushSync:Ke});return}let ve=Zu(V,W),xe=(Be&&Be.preventScrollReset)===!0;if(K&&us(K.formMethod)){Hn(le,de,W,ve,V,H.active,Ke,xe,K);return}Z.set(le,{routeId:de,path:W}),Jt(le,de,W,ve,V,H.active,Ke,xe,K)}async function Hn(le,de,Ae,Be,Ke,O,Y,V,H){$t(),Z.delete(le);function W(Tt){if(!Tt.route.action&&!Tt.route.lazy){let Gn=ha(405,{method:H.formMethod,pathname:Ae,routeId:de});return dr(le,de,Gn,{flushSync:Y}),!0}return!1}if(!O&&W(Be))return;let K=b.fetchers.get(le);Ut(le,PR(H,K),{flushSync:Y});let oe=new AbortController,ve=vc(t.history,Ae,oe.signal,H);if(O){let Tt=await Cn(Ke,new URL(ve.url).pathname,ve.signal,le);if(Tt.type==="aborted")return;if(Tt.type==="error"){dr(le,de,Tt.error,{flushSync:Y});return}else if(Tt.matches){if(Ke=Tt.matches,Be=Zu(Ke,Ae),W(Be))return}else{dr(le,de,ha(404,{pathname:Ae}),{flushSync:Y});return}}pe.set(le,oe);let xe=ne,fe=(await hr("action",b,ve,[Be],Ke,le))[Be.route.id];if(ve.signal.aborted){pe.get(le)===oe&&pe.delete(le);return}if(v.v7_fetcherPersist&&B.has(le)){if(so(fe)||Aa(fe)){Ut(le,ol(void 0));return}}else{if(so(fe))if(pe.delete(le),be>xe){Ut(le,ol(void 0));return}else return I.add(le),Ut(le,$u(H)),pt(ve,fe,!1,{fetcherSubmission:H,preventScrollReset:V});if(Aa(fe)){dr(le,de,fe.error);return}}if(ml(fe))throw ha(400,{type:"defer-action"});let Oe=b.navigation.location||b.location,Ge=vc(t.history,Oe,oe.signal),Ye=u||o,Ve=b.navigation.state!=="idle"?ro(Ye,b.navigation.location,h):b.matches;bt(Ve,"Didn't find any matches after fetcher action");let qe=++ne;Q.set(le,qe);let Xe=$u(H,fe.data);b.fetchers.set(le,Xe);let[Rt,wt]=_2(t.history,b,Ve,H,Oe,!1,v.v7_skipActionErrorRevalidation,Ne,ae,ue,B,Z,I,Ye,h,[Be.route.id,fe]);wt.filter(Tt=>Tt.key!==le).forEach(Tt=>{let Gn=Tt.key,qn=b.fetchers.get(Gn),mn=$u(void 0,qn?qn.data:void 0);b.fetchers.set(Gn,mn),St(Gn),Tt.controller&&pe.set(Gn,Tt.controller)}),J({fetchers:new Map(b.fetchers)});let At=()=>wt.forEach(Tt=>St(Tt.key));oe.signal.addEventListener("abort",At);let{loaderResults:Mr,fetcherResults:xt}=await kt(b,Ve,Rt,wt,Ge);if(oe.signal.aborted)return;oe.signal.removeEventListener("abort",At),Q.delete(le),pe.delete(le),wt.forEach(Tt=>pe.delete(Tt.key));let Bt=Ld(Mr);if(Bt)return pt(Ge,Bt.result,!1,{preventScrollReset:V});if(Bt=Ld(xt),Bt)return I.add(Bt.key),pt(Ge,Bt.result,!1,{preventScrollReset:V});let{loaderData:Br,errors:aa}=S2(b,Ve,Mr,void 0,wt,xt,se);if(b.fetchers.has(le)){let Tt=ol(fe.data);b.fetchers.set(le,Tt)}Ur(qe),b.navigation.state==="loading"&&qe>be?(bt(N,"Expected pending action"),j&&j.abort(),Qe(b.navigation.location,{matches:Ve,loaderData:Br,errors:aa,fetchers:new Map(b.fetchers)})):(J({errors:aa,loaderData:A2(b.loaderData,Br,Ve,aa),fetchers:new Map(b.fetchers)}),Ne=!1)}async function Jt(le,de,Ae,Be,Ke,O,Y,V,H){let W=b.fetchers.get(le);Ut(le,$u(H,W?W.data:void 0),{flushSync:Y});let K=new AbortController,oe=vc(t.history,Ae,K.signal);if(O){let fe=await Cn(Ke,new URL(oe.url).pathname,oe.signal,le);if(fe.type==="aborted")return;if(fe.type==="error"){dr(le,de,fe.error,{flushSync:Y});return}else if(fe.matches)Ke=fe.matches,Be=Zu(Ke,Ae);else{dr(le,de,ha(404,{pathname:Ae}),{flushSync:Y});return}}pe.set(le,K);let ve=ne,me=(await hr("loader",b,oe,[Be],Ke,le))[Be.route.id];if(ml(me)&&(me=await Zx(me,oe.signal,!0)||me),pe.get(le)===K&&pe.delete(le),!oe.signal.aborted){if(B.has(le)){Ut(le,ol(void 0));return}if(so(me))if(be>ve){Ut(le,ol(void 0));return}else{I.add(le),await pt(oe,me,!1,{preventScrollReset:V});return}if(Aa(me)){dr(le,de,me.error);return}bt(!ml(me),"Unhandled fetcher deferred data"),Ut(le,ol(me.data))}}async function pt(le,de,Ae,Be){let{submission:Ke,fetcherSubmission:O,preventScrollReset:Y,replace:V}=Be===void 0?{}:Be;de.response.headers.has("X-Remix-Revalidate")&&(Ne=!0);let H=de.response.headers.get("Location");bt(H,"Expected a Location header on the redirect Response"),H=E2(H,new URL(le.url),h);let W=Af(b.location,H,{_isRedirect:!0});if(r){let fe=!1;if(de.response.headers.has("X-Remix-Reload-Document"))fe=!0;else if(Jx.test(H)){const Oe=t.history.createURL(H);fe=Oe.origin!==e.location.origin||xi(Oe.pathname,h)==null}if(fe){V?e.location.replace(H):e.location.assign(H);return}}j=null;let K=V===!0||de.response.headers.has("X-Remix-Replace")?Xr.Replace:Xr.Push,{formMethod:oe,formAction:ve,formEncType:xe}=b.navigation;!Ke&&!O&&oe&&ve&&xe&&(Ke=R2(b.navigation));let me=Ke||O;if(xR.has(de.response.status)&&me&&us(me.formMethod))await Ue(K,W,{submission:wr({},me,{formAction:H}),preventScrollReset:Y||k,enableViewTransition:Ae?L:void 0});else{let fe=Og(W,Ke);await Ue(K,W,{overrideNavigation:fe,fetcherSubmission:O,preventScrollReset:Y||k,enableViewTransition:Ae?L:void 0})}}async function hr(le,de,Ae,Be,Ke,O){let Y,V={};try{Y=await SR(m,le,de,Ae,Be,Ke,O,l,a)}catch(H){return Be.forEach(W=>{V[W.route.id]={type:nr.error,error:H}}),V}for(let[H,W]of Object.entries(Y))if(DR(W)){let K=W.result;V[H]={type:nr.redirect,response:CR(K,Ae,H,Ke,h,v.v7_relativeSplatPath)}}else V[H]=await NR(W);return V}async function kt(le,de,Ae,Be,Ke){let O=le.matches,Y=hr("loader",le,Ke,Ae,de,null),V=Promise.all(Be.map(async K=>{if(K.matches&&K.match&&K.controller){let ve=(await hr("loader",le,vc(t.history,K.path,K.controller.signal),[K.match],K.matches,K.key))[K.match.route.id];return{[K.key]:ve}}else return Promise.resolve({[K.key]:{type:nr.error,error:ha(404,{pathname:K.path})}})})),H=await Y,W=(await V).reduce((K,oe)=>Object.assign(K,oe),{});return await Promise.all([MR(de,H,Ke.signal,O,le.loaderData),jR(de,W,Be)]),{loaderResults:H,fetcherResults:W}}function $t(){Ne=!0,ae.push(...na()),Z.forEach((le,de)=>{pe.has(de)&&ue.add(de),St(de)})}function Ut(le,de,Ae){Ae===void 0&&(Ae={}),b.fetchers.set(le,de),J({fetchers:new Map(b.fetchers)},{flushSync:(Ae&&Ae.flushSync)===!0})}function dr(le,de,Ae,Be){Be===void 0&&(Be={});let Ke=no(b.matches,de);Zt(le),J({errors:{[Ke.route.id]:Ae},fetchers:new Map(b.fetchers)},{flushSync:(Be&&Be.flushSync)===!0})}function lt(le){return ee.set(le,(ee.get(le)||0)+1),B.has(le)&&B.delete(le),b.fetchers.get(le)||vR}function Zt(le){let de=b.fetchers.get(le);pe.has(le)&&!(de&&de.state==="loading"&&Q.has(le))&&St(le),Z.delete(le),Q.delete(le),I.delete(le),v.v7_fetcherPersist&&B.delete(le),ue.delete(le),b.fetchers.delete(le)}function Sr(le){let de=(ee.get(le)||0)-1;de<=0?(ee.delete(le),B.add(le),v.v7_fetcherPersist||Zt(le)):ee.set(le,de),J({fetchers:new Map(b.fetchers)})}function St(le){let de=pe.get(le);de&&(de.abort(),pe.delete(le))}function or(le){for(let de of le){let Ae=lt(de),Be=ol(Ae.data);b.fetchers.set(de,Be)}}function nn(){let le=[],de=!1;for(let Ae of I){let Be=b.fetchers.get(Ae);bt(Be,"Expected fetcher: "+Ae),Be.state==="loading"&&(I.delete(Ae),le.push(Ae),de=!0)}return or(le),de}function Ur(le){let de=[];for(let[Ae,Be]of Q)if(Be<le){let Ke=b.fetchers.get(Ae);bt(Ke,"Expected fetcher: "+Ae),Ke.state==="loading"&&(St(Ae),Q.delete(Ae),de.push(Ae))}return or(de),de.length>0}function Dl(le,de){let Ae=b.blockers.get(le)||Yu;return _e.get(le)!==de&&_e.set(le,de),Ae}function rs(le){b.blockers.delete(le),_e.delete(le)}function ja(le,de){let Ae=b.blockers.get(le)||Yu;bt(Ae.state==="unblocked"&&de.state==="blocked"||Ae.state==="blocked"&&de.state==="blocked"||Ae.state==="blocked"&&de.state==="proceeding"||Ae.state==="blocked"&&de.state==="unblocked"||Ae.state==="proceeding"&&de.state==="unblocked","Invalid blocker state transition: "+Ae.state+" -> "+de.state);let Be=new Map(b.blockers);Be.set(le,de),J({blockers:Be})}function ga(le){let{currentLocation:de,nextLocation:Ae,historyAction:Be}=le;if(_e.size===0)return;_e.size>1&&po(!1,"A router only supports one blocker at a time");let Ke=Array.from(_e.entries()),[O,Y]=Ke[Ke.length-1],V=b.blockers.get(O);if(!(V&&V.state==="proceeding")&&Y({currentLocation:de,nextLocation:Ae,historyAction:Be}))return O}function Nn(le){let de=ha(404,{pathname:le}),Ae=u||o,{matches:Be,route:Ke}=C2(Ae);return na(),{notFoundMatches:Be,route:Ke,error:de}}function na(le){let de=[];return se.forEach((Ae,Be)=>{(!le||le(Be))&&(Ae.cancel(),de.push(Be),se.delete(Be))}),de}function an(le,de,Ae){if(E=le,A=de,T=Ae||null,!M&&b.navigation===Ig){M=!0;let Be=ns(b.location,b.matches);Be!=null&&J({restoreScrollPosition:Be})}return()=>{E=null,A=null,T=null}}function dn(le,de){return T&&T(le,de.map(Be=>Yk(Be,b.loaderData)))||le.key}function Fa(le,de){if(E&&A){let Ae=dn(le,de);E[Ae]=A()}}function ns(le,de){if(E){let Ae=dn(le,de),Be=E[Ae];if(typeof Be=="number")return Be}return null}function Pa(le,de,Ae){if(p)if(le){if(Object.keys(le[0].params).length>0)return{active:!0,matches:r0(de,Ae,h,!0)}}else return{active:!0,matches:r0(de,Ae,h,!0)||[]};return{active:!1,matches:null}}async function Cn(le,de,Ae,Be){if(!p)return{type:"success",matches:le};let Ke=le;for(;;){let O=u==null,Y=u||o,V=l;try{await p({signal:Ae,path:de,matches:Ke,fetcherKey:Be,patch:(K,oe)=>{Ae.aborted||T2(K,oe,Y,V,a)}})}catch(K){return{type:"error",error:K,partialMatches:Ke}}finally{O&&!Ae.aborted&&(o=[...o])}if(Ae.aborted)return{type:"aborted"};let H=ro(Y,de,h);if(H)return{type:"success",matches:H};let W=r0(Y,de,h,!0);if(!W||Ke.length===W.length&&Ke.every((K,oe)=>K.route.id===W[oe].route.id))return{type:"success",matches:null};Ke=W}}function La(le){l={},u=m0(le,a,void 0,l)}function Or(le,de){let Ae=u==null;T2(le,de,u||o,l,a),Ae&&(o=[...o],J({}))}return te={get basename(){return h},get future(){return v},get state(){return b},get routes(){return o},get window(){return e},initialize:he,subscribe:He,enableScrollRestoration:an,navigate:$e,fetch:yr,revalidate:Fe,createHref:le=>t.history.createHref(le),encodeLocation:le=>t.history.encodeLocation(le),getFetcher:lt,deleteFetcher:Sr,dispose:we,getBlocker:Dl,deleteBlocker:rs,patchRoutes:Or,_internalFetchControllers:pe,_internalActiveDeferreds:se,_internalSetRoutes:La},te}function wR(t){return t!=null&&("formData"in t&&t.formData!=null||"body"in t&&t.body!==void 0)}function ax(t,e,r,n,a,l,o,u){let h,m;if(o){h=[];for(let v of e)if(h.push(v),v.route.id===o){m=v;break}}else h=e,m=e[e.length-1];let p=K0(a||".",W0(h,l),xi(t.pathname,r)||t.pathname,u==="path");if(a==null&&(p.search=t.search,p.hash=t.hash),(a==null||a===""||a===".")&&m){let v=ev(p.search);if(m.route.index&&!v)p.search=p.search?p.search.replace(/^\?/,"?index&"):"?index";else if(!m.route.index&&v){let _=new URLSearchParams(p.search),w=_.getAll("index");_.delete("index"),w.filter(T=>T).forEach(T=>_.append("index",T));let E=_.toString();p.search=E?"?"+E:""}}return n&&r!=="/"&&(p.pathname=p.pathname==="/"?r:di([r,p.pathname])),go(p)}function v2(t,e,r,n){if(!n||!wR(n))return{path:r};if(n.formMethod&&!OR(n.formMethod))return{path:r,error:ha(405,{method:n.formMethod})};let a=()=>({path:r,error:ha(400,{type:"invalid-body"})}),l=n.formMethod||"get",o=t?l.toUpperCase():l.toLowerCase(),u=wb(r);if(n.body!==void 0){if(n.formEncType==="text/plain"){if(!us(o))return a();let _=typeof n.body=="string"?n.body:n.body instanceof FormData||n.body instanceof URLSearchParams?Array.from(n.body.entries()).reduce((w,E)=>{let[T,A]=E;return""+w+T+"="+A+`
`},""):String(n.body);return{path:r,submission:{formMethod:o,formAction:u,formEncType:n.formEncType,formData:void 0,json:void 0,text:_}}}else if(n.formEncType==="application/json"){if(!us(o))return a();try{let _=typeof n.body=="string"?JSON.parse(n.body):n.body;return{path:r,submission:{formMethod:o,formAction:u,formEncType:n.formEncType,formData:void 0,json:_,text:void 0}}}catch{return a()}}}bt(typeof FormData=="function","FormData is not available in this environment");let h,m;if(n.formData)h=ix(n.formData),m=n.formData;else if(n.body instanceof FormData)h=ix(n.body),m=n.body;else if(n.body instanceof URLSearchParams)h=n.body,m=b2(h);else if(n.body==null)h=new URLSearchParams,m=new FormData;else try{h=new URLSearchParams(n.body),m=b2(h)}catch{return a()}let p={formMethod:o,formAction:u,formEncType:n&&n.formEncType||"application/x-www-form-urlencoded",formData:m,json:void 0,text:void 0};if(us(p.formMethod))return{path:r,submission:p};let v=Cl(r);return e&&v.search&&ev(v.search)&&h.append("index",""),v.search="?"+h,{path:go(v),submission:p}}function y2(t,e,r){r===void 0&&(r=!1);let n=t.findIndex(a=>a.route.id===e);return n>=0?t.slice(0,r?n+1:n):t}function _2(t,e,r,n,a,l,o,u,h,m,p,v,_,w,E,T){let A=T?Aa(T[1])?T[1].error:T[1].data:void 0,M=t.createURL(e.location),F=t.createURL(a),R=r;l&&e.errors?R=y2(r,Object.keys(e.errors)[0],!0):T&&Aa(T[1])&&(R=y2(r,T[0]));let z=T?T[1].statusCode:void 0,re=o&&z&&z>=400,te=R.filter((N,k)=>{let{route:j}=N;if(j.lazy)return!0;if(j.loader==null)return!1;if(l)return sx(j,e.loaderData,e.errors);if(TR(e.loaderData,e.matches[k],N)||h.some(U=>U===N.route.id))return!0;let L=e.matches[k],P=N;return w2(N,wr({currentUrl:M,currentParams:L.params,nextUrl:F,nextParams:P.params},n,{actionResult:A,actionStatus:z,defaultShouldRevalidate:re?!1:u||M.pathname+M.search===F.pathname+F.search||M.search!==F.search||yb(L,P)}))}),b=[];return v.forEach((N,k)=>{if(l||!r.some(Ce=>Ce.route.id===N.routeId)||p.has(k))return;let j=ro(w,N.path,E);if(!j){b.push({key:k,routeId:N.routeId,path:N.path,matches:null,match:null,controller:null});return}let L=e.fetchers.get(k),P=Zu(j,N.path),U=!1;_.has(k)?U=!1:m.has(k)?(m.delete(k),U=!0):L&&L.state!=="idle"&&L.data===void 0?U=u:U=w2(P,wr({currentUrl:M,currentParams:e.matches[e.matches.length-1].params,nextUrl:F,nextParams:r[r.length-1].params},n,{actionResult:A,actionStatus:z,defaultShouldRevalidate:re?!1:u})),U&&b.push({key:k,routeId:N.routeId,path:N.path,matches:j,match:P,controller:new AbortController})}),[te,b]}function sx(t,e,r){if(t.lazy)return!0;if(!t.loader)return!1;let n=e!=null&&e[t.id]!==void 0,a=r!=null&&r[t.id]!==void 0;return!n&&a?!1:typeof t.loader=="function"&&t.loader.hydrate===!0?!0:!n&&!a}function TR(t,e,r){let n=!e||r.route.id!==e.route.id,a=t[r.route.id]===void 0;return n||a}function yb(t,e){let r=t.route.path;return t.pathname!==e.pathname||r!=null&&r.endsWith("*")&&t.params["*"]!==e.params["*"]}function w2(t,e){if(t.route.shouldRevalidate){let r=t.route.shouldRevalidate(e);if(typeof r=="boolean")return r}return e.defaultShouldRevalidate}function T2(t,e,r,n,a){var l;let o;if(t){let m=n[t];bt(m,"No route found to patch children into: routeId = "+t),m.children||(m.children=[]),o=m.children}else o=r;let u=e.filter(m=>!o.some(p=>_b(m,p))),h=m0(u,a,[t||"_","patch",String(((l=o)==null?void 0:l.length)||"0")],n);o.push(...h)}function _b(t,e){return"id"in t&&"id"in e&&t.id===e.id?!0:t.index===e.index&&t.path===e.path&&t.caseSensitive===e.caseSensitive?(!t.children||t.children.length===0)&&(!e.children||e.children.length===0)?!0:t.children.every((r,n)=>{var a;return(a=e.children)==null?void 0:a.some(l=>_b(r,l))}):!1}async function ER(t,e,r){if(!t.lazy)return;let n=await t.lazy();if(!t.lazy)return;let a=r[t.id];bt(a,"No route found in manifest");let l={};for(let o in n){let h=a[o]!==void 0&&o!=="hasErrorBoundary";po(!h,'Route "'+a.id+'" has a static property "'+o+'" defined but its lazy function is also returning a value for this property. '+('The lazy route property "'+o+'" will be ignored.')),!h&&!Wk.has(o)&&(l[o]=n[o])}Object.assign(a,l),Object.assign(a,wr({},e(a),{lazy:void 0}))}async function bR(t){let{matches:e}=t,r=e.filter(a=>a.shouldLoad);return(await Promise.all(r.map(a=>a.resolve()))).reduce((a,l,o)=>Object.assign(a,{[r[o].route.id]:l}),{})}async function SR(t,e,r,n,a,l,o,u,h,m){let p=l.map(w=>w.route.lazy?ER(w.route,h,u):void 0),v=l.map((w,E)=>{let T=p[E],A=a.some(F=>F.route.id===w.route.id);return wr({},w,{shouldLoad:A,resolve:async F=>(F&&n.method==="GET"&&(w.route.lazy||w.route.loader)&&(A=!0),A?AR(e,n,w,T,F,m):Promise.resolve({type:nr.data,result:void 0}))})}),_=await t({matches:v,request:n,params:l[0].params,fetcherKey:o,context:m});try{await Promise.all(p)}catch{}return _}async function AR(t,e,r,n,a,l){let o,u,h=m=>{let p,v=new Promise((E,T)=>p=T);u=()=>p(),e.signal.addEventListener("abort",u);let _=E=>typeof m!="function"?Promise.reject(new Error("You cannot call the handler for a route which defines a boolean "+('"'+t+'" [routeId: '+r.route.id+"]"))):m({request:e,params:r.params,context:l},...E!==void 0?[E]:[]),w=(async()=>{try{return{type:"data",result:await(a?a(T=>_(T)):_())}}catch(E){return{type:"error",result:E}}})();return Promise.race([w,v])};try{let m=r.route[t];if(n)if(m){let p,[v]=await Promise.all([h(m).catch(_=>{p=_}),n]);if(p!==void 0)throw p;o=v}else if(await n,m=r.route[t],m)o=await h(m);else if(t==="action"){let p=new URL(e.url),v=p.pathname+p.search;throw ha(405,{method:e.method,pathname:v,routeId:r.route.id})}else return{type:nr.data,result:void 0};else if(m)o=await h(m);else{let p=new URL(e.url),v=p.pathname+p.search;throw ha(404,{pathname:v})}bt(o.result!==void 0,"You defined "+(t==="action"?"an action":"a loader")+" for route "+('"'+r.route.id+"\" but didn't return anything from your `"+t+"` ")+"function. Please return a value or `null`.")}catch(m){return{type:nr.error,result:m}}finally{u&&e.signal.removeEventListener("abort",u)}return o}async function NR(t){let{result:e,type:r}=t;if(Tb(e)){let v;try{let _=e.headers.get("Content-Type");_&&/\bapplication\/json\b/.test(_)?e.body==null?v=null:v=await e.json():v=await e.text()}catch(_){return{type:nr.error,error:_}}return r===nr.error?{type:nr.error,error:new g0(e.status,e.statusText,v),statusCode:e.status,headers:e.headers}:{type:nr.data,data:v,statusCode:e.status,headers:e.headers}}if(r===nr.error){if(k2(e)){var n,a;if(e.data instanceof Error){var l,o;return{type:nr.error,error:e.data,statusCode:(l=e.init)==null?void 0:l.status,headers:(o=e.init)!=null&&o.headers?new Headers(e.init.headers):void 0}}return{type:nr.error,error:new g0(((n=e.init)==null?void 0:n.status)||500,void 0,e.data),statusCode:Nf(e)?e.status:void 0,headers:(a=e.init)!=null&&a.headers?new Headers(e.init.headers):void 0}}return{type:nr.error,error:e,statusCode:Nf(e)?e.status:void 0}}if(IR(e)){var u,h;return{type:nr.deferred,deferredData:e,statusCode:(u=e.init)==null?void 0:u.status,headers:((h=e.init)==null?void 0:h.headers)&&new Headers(e.init.headers)}}if(k2(e)){var m,p;return{type:nr.data,data:e.data,statusCode:(m=e.init)==null?void 0:m.status,headers:(p=e.init)!=null&&p.headers?new Headers(e.init.headers):void 0}}return{type:nr.data,data:e}}function CR(t,e,r,n,a,l){let o=t.headers.get("Location");if(bt(o,"Redirects returned/thrown from loaders/actions must have a Location header"),!Jx.test(o)){let u=n.slice(0,n.findIndex(h=>h.route.id===r)+1);o=ax(new URL(e.url),u,a,!0,o,l),t.headers.set("Location",o)}return t}function E2(t,e,r){if(Jx.test(t)){let n=t,a=n.startsWith("//")?new URL(e.protocol+n):new URL(n),l=xi(a.pathname,r)!=null;if(a.origin===e.origin&&l)return a.pathname+a.search+a.hash}return t}function vc(t,e,r,n){let a=t.createURL(wb(e)).toString(),l={signal:r};if(n&&us(n.formMethod)){let{formMethod:o,formEncType:u}=n;l.method=o.toUpperCase(),u==="application/json"?(l.headers=new Headers({"Content-Type":u}),l.body=JSON.stringify(n.json)):u==="text/plain"?l.body=n.text:u==="application/x-www-form-urlencoded"&&n.formData?l.body=ix(n.formData):l.body=n.formData}return new Request(a,l)}function ix(t){let e=new URLSearchParams;for(let[r,n]of t.entries())e.append(r,typeof n=="string"?n:n.name);return e}function b2(t){let e=new FormData;for(let[r,n]of t.entries())e.append(r,n);return e}function kR(t,e,r,n,a){let l={},o=null,u,h=!1,m={},p=r&&Aa(r[1])?r[1].error:void 0;return t.forEach(v=>{if(!(v.route.id in e))return;let _=v.route.id,w=e[_];if(bt(!so(w),"Cannot handle redirect results in processLoaderData"),Aa(w)){let E=w.error;p!==void 0&&(E=p,p=void 0),o=o||{};{let T=no(t,_);o[T.route.id]==null&&(o[T.route.id]=E)}l[_]=void 0,h||(h=!0,u=Nf(w.error)?w.error.status:500),w.headers&&(m[_]=w.headers)}else ml(w)?(n.set(_,w.deferredData),l[_]=w.deferredData.data,w.statusCode!=null&&w.statusCode!==200&&!h&&(u=w.statusCode),w.headers&&(m[_]=w.headers)):(l[_]=w.data,w.statusCode&&w.statusCode!==200&&!h&&(u=w.statusCode),w.headers&&(m[_]=w.headers))}),p!==void 0&&r&&(o={[r[0]]:p},l[r[0]]=void 0),{loaderData:l,errors:o,statusCode:u||200,loaderHeaders:m}}function S2(t,e,r,n,a,l,o){let{loaderData:u,errors:h}=kR(e,r,n,o);return a.forEach(m=>{let{key:p,match:v,controller:_}=m,w=l[p];if(bt(w,"Did not find corresponding fetcher result"),!(_&&_.signal.aborted))if(Aa(w)){let E=no(t.matches,v?.route.id);h&&h[E.route.id]||(h=wr({},h,{[E.route.id]:w.error})),t.fetchers.delete(p)}else if(so(w))bt(!1,"Unhandled fetcher revalidation redirect");else if(ml(w))bt(!1,"Unhandled fetcher deferred data");else{let E=ol(w.data);t.fetchers.set(p,E)}}),{loaderData:u,errors:h}}function A2(t,e,r,n){let a=wr({},e);for(let l of r){let o=l.route.id;if(e.hasOwnProperty(o)?e[o]!==void 0&&(a[o]=e[o]):t[o]!==void 0&&l.route.loader&&(a[o]=t[o]),n&&n.hasOwnProperty(o))break}return a}function N2(t){return t?Aa(t[1])?{actionData:{}}:{actionData:{[t[0]]:t[1].data}}:{}}function no(t,e){return(e?t.slice(0,t.findIndex(n=>n.route.id===e)+1):[...t]).reverse().find(n=>n.route.hasErrorBoundary===!0)||t[0]}function C2(t){let e=t.length===1?t[0]:t.find(r=>r.index||!r.path||r.path==="/")||{id:"__shim-error-route__"};return{matches:[{params:{},pathname:"",pathnameBase:"",route:e}],route:e}}function ha(t,e){let{pathname:r,routeId:n,method:a,type:l,message:o}=e===void 0?{}:e,u="Unknown Server Error",h="Unknown @remix-run/router error";return t===400?(u="Bad Request",a&&r&&n?h="You made a "+a+' request to "'+r+'" but '+('did not provide a `loader` for route "'+n+'", ')+"so there is no way to handle the request.":l==="defer-action"?h="defer() is not supported in actions":l==="invalid-body"&&(h="Unable to encode submission body")):t===403?(u="Forbidden",h='Route "'+n+'" does not match URL "'+r+'"'):t===404?(u="Not Found",h='No route matches URL "'+r+'"'):t===405&&(u="Method Not Allowed",a&&r&&n?h="You made a "+a.toUpperCase()+' request to "'+r+'" but '+('did not provide an `action` for route "'+n+'", ')+"so there is no way to handle the request.":a&&(h='Invalid request method "'+a.toUpperCase()+'"')),new g0(t||500,u,new Error(h),!0)}function Ld(t){let e=Object.entries(t);for(let r=e.length-1;r>=0;r--){let[n,a]=e[r];if(so(a))return{key:n,result:a}}}function wb(t){let e=typeof t=="string"?Cl(t):t;return go(wr({},e,{hash:""}))}function RR(t,e){return t.pathname!==e.pathname||t.search!==e.search?!1:t.hash===""?e.hash!=="":t.hash===e.hash?!0:e.hash!==""}function DR(t){return Tb(t.result)&&gR.has(t.result.status)}function ml(t){return t.type===nr.deferred}function Aa(t){return t.type===nr.error}function so(t){return(t&&t.type)===nr.redirect}function k2(t){return typeof t=="object"&&t!=null&&"type"in t&&"data"in t&&"init"in t&&t.type==="DataWithResponseInit"}function IR(t){let e=t;return e&&typeof e=="object"&&typeof e.data=="object"&&typeof e.subscribe=="function"&&typeof e.cancel=="function"&&typeof e.resolveData=="function"}function Tb(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.headers=="object"&&typeof t.body<"u"}function OR(t){return pR.has(t.toLowerCase())}function us(t){return dR.has(t.toLowerCase())}async function MR(t,e,r,n,a){let l=Object.entries(e);for(let o=0;o<l.length;o++){let[u,h]=l[o],m=t.find(_=>_?.route.id===u);if(!m)continue;let p=n.find(_=>_.route.id===m.route.id),v=p!=null&&!yb(p,m)&&(a&&a[m.route.id])!==void 0;ml(h)&&v&&await Zx(h,r,!1).then(_=>{_&&(e[u]=_)})}}async function jR(t,e,r){for(let n=0;n<r.length;n++){let{key:a,routeId:l,controller:o}=r[n],u=e[a];t.find(m=>m?.route.id===l)&&ml(u)&&(bt(o,"Expected an AbortController for revalidating fetcher deferred result"),await Zx(u,o.signal,!0).then(m=>{m&&(e[a]=m)}))}}async function Zx(t,e,r){if(r===void 0&&(r=!1),!await t.deferredData.resolveData(e)){if(r)try{return{type:nr.data,data:t.deferredData.unwrappedData}}catch(a){return{type:nr.error,error:a}}return{type:nr.data,data:t.deferredData.data}}}function ev(t){return new URLSearchParams(t).getAll("index").some(e=>e==="")}function Zu(t,e){let r=typeof e=="string"?Cl(e).search:e.search;if(t[t.length-1].route.index&&ev(r||""))return t[t.length-1];let n=gb(t);return n[n.length-1]}function R2(t){let{formMethod:e,formAction:r,formEncType:n,text:a,formData:l,json:o}=t;if(!(!e||!r||!n)){if(a!=null)return{formMethod:e,formAction:r,formEncType:n,formData:void 0,json:void 0,text:a};if(l!=null)return{formMethod:e,formAction:r,formEncType:n,formData:l,json:void 0,text:void 0};if(o!==void 0)return{formMethod:e,formAction:r,formEncType:n,formData:void 0,json:o,text:void 0}}}function Og(t,e){return e?{state:"loading",location:t,formMethod:e.formMethod,formAction:e.formAction,formEncType:e.formEncType,formData:e.formData,json:e.json,text:e.text}:{state:"loading",location:t,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0}}function FR(t,e){return{state:"submitting",location:t,formMethod:e.formMethod,formAction:e.formAction,formEncType:e.formEncType,formData:e.formData,json:e.json,text:e.text}}function $u(t,e){return t?{state:"loading",formMethod:t.formMethod,formAction:t.formAction,formEncType:t.formEncType,formData:t.formData,json:t.json,text:t.text,data:e}:{state:"loading",formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0,data:e}}function PR(t,e){return{state:"submitting",formMethod:t.formMethod,formAction:t.formAction,formEncType:t.formEncType,formData:t.formData,json:t.json,text:t.text,data:e?e.data:void 0}}function ol(t){return{state:"idle",formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0,data:t}}function LR(t,e){try{let r=t.sessionStorage.getItem(vb);if(r){let n=JSON.parse(r);for(let[a,l]of Object.entries(n||{}))l&&Array.isArray(l)&&e.set(a,new Set(l||[]))}}catch{}}function UR(t,e){if(e.size>0){let r={};for(let[n,a]of e)r[n]=[...a];try{t.sessionStorage.setItem(vb,JSON.stringify(r))}catch(n){po(!1,"Failed to save applied view transitions in sessionStorage ("+n+").")}}}function x0(){return x0=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},x0.apply(this,arguments)}const Yf=q.createContext(null),tv=q.createContext(null),Si=q.createContext(null),rv=q.createContext(null),Us=q.createContext({outlet:null,matches:[],isDataRoute:!1}),Eb=q.createContext(null);function BR(t,e){let{relative:r}=e===void 0?{}:e;Wc()||bt(!1);let{basename:n,navigator:a}=q.useContext(Si),{hash:l,pathname:o,search:u}=$0(t,{relative:r}),h=o;return n!=="/"&&(h=o==="/"?n:di([n,o])),a.createHref({pathname:h,search:u,hash:l})}function Wc(){return q.useContext(rv)!=null}function ys(){return Wc()||bt(!1),q.useContext(rv).location}function bb(t){q.useContext(Si).static||q.useLayoutEffect(t)}function Ma(){let{isDataRoute:t}=q.useContext(Us);return t?eD():VR()}function VR(){Wc()||bt(!1);let t=q.useContext(Yf),{basename:e,future:r,navigator:n}=q.useContext(Si),{matches:a}=q.useContext(Us),{pathname:l}=ys(),o=JSON.stringify(W0(a,r.v7_relativeSplatPath)),u=q.useRef(!1);return bb(()=>{u.current=!0}),q.useCallback(function(m,p){if(p===void 0&&(p={}),!u.current)return;if(typeof m=="number"){n.go(m);return}let v=K0(m,JSON.parse(o),l,p.relative==="path");t==null&&e!=="/"&&(v.pathname=v.pathname==="/"?e:di([e,v.pathname])),(p.replace?n.replace:n.push)(v,p.state,p)},[e,n,o,l,t])}const zR=q.createContext(null);function HR(t){let e=q.useContext(Us).outlet;return e&&q.createElement(zR.Provider,{value:t},e)}function Y0(){let{matches:t}=q.useContext(Us),e=t[t.length-1];return e?e.params:{}}function $0(t,e){let{relative:r}=e===void 0?{}:e,{future:n}=q.useContext(Si),{matches:a}=q.useContext(Us),{pathname:l}=ys(),o=JSON.stringify(W0(a,n.v7_relativeSplatPath));return q.useMemo(()=>K0(t,JSON.parse(o),l,r==="path"),[t,o,l,r])}function GR(t,e,r,n){Wc()||bt(!1);let{navigator:a}=q.useContext(Si),{matches:l}=q.useContext(Us),o=l[l.length-1],u=o?o.params:{};o&&o.pathname;let h=o?o.pathnameBase:"/";o&&o.route;let m=ys(),p;p=m;let v=p.pathname||"/",_=v;if(h!=="/"){let T=h.replace(/^\//,"").split("/");_="/"+v.replace(/^\//,"").split("/").slice(T.length).join("/")}let w=ro(t,{pathname:_});return $R(w&&w.map(T=>Object.assign({},T,{params:Object.assign({},u,T.params),pathname:di([h,a.encodeLocation?a.encodeLocation(T.pathname).pathname:T.pathname]),pathnameBase:T.pathnameBase==="/"?h:di([h,a.encodeLocation?a.encodeLocation(T.pathnameBase).pathname:T.pathnameBase])})),l,r,n)}function qR(){let t=ZR(),e=Nf(t)?t.status+" "+t.statusText:t instanceof Error?t.message:JSON.stringify(t),r=t instanceof Error?t.stack:null,a={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return q.createElement(q.Fragment,null,q.createElement("h2",null,"Unexpected Application Error!"),q.createElement("h3",{style:{fontStyle:"italic"}},e),r?q.createElement("pre",{style:a},r):null,null)}const WR=q.createElement(qR,null);class KR extends q.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,r){return r.location!==e.location||r.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:r.error,location:r.location,revalidation:e.revalidation||r.revalidation}}componentDidCatch(e,r){console.error("React Router caught the following error during render",e,r)}render(){return this.state.error!==void 0?q.createElement(Us.Provider,{value:this.props.routeContext},q.createElement(Eb.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function YR(t){let{routeContext:e,match:r,children:n}=t,a=q.useContext(Yf);return a&&a.static&&a.staticContext&&(r.route.errorElement||r.route.ErrorBoundary)&&(a.staticContext._deepestRenderedBoundaryId=r.route.id),q.createElement(Us.Provider,{value:e},n)}function $R(t,e,r,n){var a;if(e===void 0&&(e=[]),r===void 0&&(r=null),n===void 0&&(n=null),t==null){var l;if(!r)return null;if(r.errors)t=r.matches;else if((l=n)!=null&&l.v7_partialHydration&&e.length===0&&!r.initialized&&r.matches.length>0)t=r.matches;else return null}let o=t,u=(a=r)==null?void 0:a.errors;if(u!=null){let p=o.findIndex(v=>v.route.id&&u?.[v.route.id]!==void 0);p>=0||bt(!1),o=o.slice(0,Math.min(o.length,p+1))}let h=!1,m=-1;if(r&&n&&n.v7_partialHydration)for(let p=0;p<o.length;p++){let v=o[p];if((v.route.HydrateFallback||v.route.hydrateFallbackElement)&&(m=p),v.route.id){let{loaderData:_,errors:w}=r,E=v.route.loader&&_[v.route.id]===void 0&&(!w||w[v.route.id]===void 0);if(v.route.lazy||E){h=!0,m>=0?o=o.slice(0,m+1):o=[o[0]];break}}}return o.reduceRight((p,v,_)=>{let w,E=!1,T=null,A=null;r&&(w=u&&v.route.id?u[v.route.id]:void 0,T=v.route.errorElement||WR,h&&(m<0&&_===0?(tD("route-fallback"),E=!0,A=null):m===_&&(E=!0,A=v.route.hydrateFallbackElement||null)));let M=e.concat(o.slice(0,_+1)),F=()=>{let R;return w?R=T:E?R=A:v.route.Component?R=q.createElement(v.route.Component,null):v.route.element?R=v.route.element:R=p,q.createElement(YR,{match:v,routeContext:{outlet:p,matches:M,isDataRoute:r!=null},children:R})};return r&&(v.route.ErrorBoundary||v.route.errorElement||_===0)?q.createElement(KR,{location:r.location,revalidation:r.revalidation,component:T,error:w,children:F(),routeContext:{outlet:null,matches:M,isDataRoute:!0}}):F()},null)}var Sb=(function(t){return t.UseBlocker="useBlocker",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t})(Sb||{}),Ab=(function(t){return t.UseBlocker="useBlocker",t.UseLoaderData="useLoaderData",t.UseActionData="useActionData",t.UseRouteError="useRouteError",t.UseNavigation="useNavigation",t.UseRouteLoaderData="useRouteLoaderData",t.UseMatches="useMatches",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t.UseRouteId="useRouteId",t})(Ab||{});function XR(t){let e=q.useContext(Yf);return e||bt(!1),e}function QR(t){let e=q.useContext(tv);return e||bt(!1),e}function JR(t){let e=q.useContext(Us);return e||bt(!1),e}function Nb(t){let e=JR(),r=e.matches[e.matches.length-1];return r.route.id||bt(!1),r.route.id}function ZR(){var t;let e=q.useContext(Eb),r=QR(Ab.UseRouteError),n=Nb();return e!==void 0?e:(t=r.errors)==null?void 0:t[n]}function eD(){let{router:t}=XR(Sb.UseNavigateStable),e=Nb(),r=q.useRef(!1);return bb(()=>{r.current=!0}),q.useCallback(function(a,l){l===void 0&&(l={}),r.current&&(typeof a=="number"?t.navigate(a):t.navigate(a,x0({fromRouteId:e},l)))},[t,e])}const D2={};function tD(t,e,r){D2[t]||(D2[t]=!0)}function rD(t,e){t?.v7_startTransition,t?.v7_relativeSplatPath===void 0&&(!e||e.v7_relativeSplatPath),e&&(e.v7_fetcherPersist,e.v7_normalizeFormMethod,e.v7_partialHydration,e.v7_skipActionErrorRevalidation)}function nD(t){let{to:e,replace:r,state:n,relative:a}=t;Wc()||bt(!1);let{future:l,static:o}=q.useContext(Si),{matches:u}=q.useContext(Us),{pathname:h}=ys(),m=Ma(),p=K0(e,W0(u,l.v7_relativeSplatPath),h,a==="path"),v=JSON.stringify(p);return q.useEffect(()=>m(JSON.parse(v),{replace:r,state:n,relative:a}),[m,v,a,r,n]),null}function Cb(t){return HR(t.context)}function aD(t){let{basename:e="/",children:r=null,location:n,navigationType:a=Xr.Pop,navigator:l,static:o=!1,future:u}=t;Wc()&&bt(!1);let h=e.replace(/^\/*/,"/"),m=q.useMemo(()=>({basename:h,navigator:l,static:o,future:x0({v7_relativeSplatPath:!1},u)}),[h,u,l,o]);typeof n=="string"&&(n=Cl(n));let{pathname:p="/",search:v="",hash:_="",state:w=null,key:E="default"}=n,T=q.useMemo(()=>{let A=xi(p,h);return A==null?null:{location:{pathname:A,search:v,hash:_,state:w,key:E},navigationType:a}},[h,p,v,_,w,E,a]);return T==null?null:q.createElement(Si.Provider,{value:m},q.createElement(rv.Provider,{children:r,value:T}))}new Promise(()=>{});function sD(t){let e={hasErrorBoundary:t.ErrorBoundary!=null||t.errorElement!=null};return t.Component&&Object.assign(e,{element:q.createElement(t.Component),Component:void 0}),t.HydrateFallback&&Object.assign(e,{hydrateFallbackElement:q.createElement(t.HydrateFallback),HydrateFallback:void 0}),t.ErrorBoundary&&Object.assign(e,{errorElement:q.createElement(t.ErrorBoundary),ErrorBoundary:void 0}),e}function jc(){return jc=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},jc.apply(this,arguments)}function kb(t,e){if(t==null)return{};var r={},n=Object.keys(t),a,l;for(l=0;l<n.length;l++)a=n[l],!(e.indexOf(a)>=0)&&(r[a]=t[a]);return r}function iD(t){return!!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}function lD(t,e){return t.button===0&&(!e||e==="_self")&&!iD(t)}function lx(t){return t===void 0&&(t=""),new URLSearchParams(typeof t=="string"||Array.isArray(t)||t instanceof URLSearchParams?t:Object.keys(t).reduce((e,r)=>{let n=t[r];return e.concat(Array.isArray(n)?n.map(a=>[r,a]):[[r,n]])},[]))}function oD(t,e){let r=lx(t);return e&&e.forEach((n,a)=>{r.has(a)||e.getAll(a).forEach(l=>{r.append(a,l)})}),r}const cD=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],uD=["aria-current","caseSensitive","className","end","style","to","viewTransition","children"],fD="6";try{window.__reactRouterVersion=fD}catch{}function hD(t,e){return _R({basename:void 0,future:jc({},void 0,{v7_prependBasename:!0}),history:Hk({window:void 0}),hydrationData:dD(),routes:t,mapRouteProperties:sD,dataStrategy:void 0,patchRoutesOnNavigation:void 0,window:void 0}).initialize()}function dD(){var t;let e=(t=window)==null?void 0:t.__staticRouterHydrationData;return e&&e.errors&&(e=jc({},e,{errors:mD(e.errors)})),e}function mD(t){if(!t)return null;let e=Object.entries(t),r={};for(let[n,a]of e)if(a&&a.__type==="RouteErrorResponse")r[n]=new g0(a.status,a.statusText,a.data,a.internal===!0);else if(a&&a.__type==="Error"){if(a.__subType){let l=window[a.__subType];if(typeof l=="function")try{let o=new l(a.message);o.stack="",r[n]=o}catch{}}if(r[n]==null){let l=new Error(a.message);l.stack="",r[n]=l}}else r[n]=a;return r}const Rb=q.createContext({isTransitioning:!1}),pD=q.createContext(new Map),gD="startTransition",I2=Ok[gD],xD="flushSync",O2=zk[xD];function vD(t){I2?I2(t):t()}function Xu(t){O2?O2(t):t()}let yD=class{constructor(){this.status="pending",this.promise=new Promise((e,r)=>{this.resolve=n=>{this.status==="pending"&&(this.status="resolved",e(n))},this.reject=n=>{this.status==="pending"&&(this.status="rejected",r(n))}})}};function _D(t){let{fallbackElement:e,router:r,future:n}=t,[a,l]=q.useState(r.state),[o,u]=q.useState(),[h,m]=q.useState({isTransitioning:!1}),[p,v]=q.useState(),[_,w]=q.useState(),[E,T]=q.useState(),A=q.useRef(new Map),{v7_startTransition:M}=n||{},F=q.useCallback(N=>{M?vD(N):N()},[M]),R=q.useCallback((N,k)=>{let{deletedFetchers:j,flushSync:L,viewTransitionOpts:P}=k;N.fetchers.forEach((Ce,Ne)=>{Ce.data!==void 0&&A.current.set(Ne,Ce.data)}),j.forEach(Ce=>A.current.delete(Ce));let U=r.window==null||r.window.document==null||typeof r.window.document.startViewTransition!="function";if(!P||U){L?Xu(()=>l(N)):F(()=>l(N));return}if(L){Xu(()=>{_&&(p&&p.resolve(),_.skipTransition()),m({isTransitioning:!0,flushSync:!0,currentLocation:P.currentLocation,nextLocation:P.nextLocation})});let Ce=r.window.document.startViewTransition(()=>{Xu(()=>l(N))});Ce.finished.finally(()=>{Xu(()=>{v(void 0),w(void 0),u(void 0),m({isTransitioning:!1})})}),Xu(()=>w(Ce));return}_?(p&&p.resolve(),_.skipTransition(),T({state:N,currentLocation:P.currentLocation,nextLocation:P.nextLocation})):(u(N),m({isTransitioning:!0,flushSync:!1,currentLocation:P.currentLocation,nextLocation:P.nextLocation}))},[r.window,_,p,A,F]);q.useLayoutEffect(()=>r.subscribe(R),[r,R]),q.useEffect(()=>{h.isTransitioning&&!h.flushSync&&v(new yD)},[h]),q.useEffect(()=>{if(p&&o&&r.window){let N=o,k=p.promise,j=r.window.document.startViewTransition(async()=>{F(()=>l(N)),await k});j.finished.finally(()=>{v(void 0),w(void 0),u(void 0),m({isTransitioning:!1})}),w(j)}},[F,o,p,r.window]),q.useEffect(()=>{p&&o&&a.location.key===o.location.key&&p.resolve()},[p,_,a.location,o]),q.useEffect(()=>{!h.isTransitioning&&E&&(u(E.state),m({isTransitioning:!0,flushSync:!1,currentLocation:E.currentLocation,nextLocation:E.nextLocation}),T(void 0))},[h.isTransitioning,E]),q.useEffect(()=>{},[]);let z=q.useMemo(()=>({createHref:r.createHref,encodeLocation:r.encodeLocation,go:N=>r.navigate(N),push:(N,k,j)=>r.navigate(N,{state:k,preventScrollReset:j?.preventScrollReset}),replace:(N,k,j)=>r.navigate(N,{replace:!0,state:k,preventScrollReset:j?.preventScrollReset})}),[r]),re=r.basename||"/",te=q.useMemo(()=>({router:r,navigator:z,static:!1,basename:re}),[r,z,re]),b=q.useMemo(()=>({v7_relativeSplatPath:r.future.v7_relativeSplatPath}),[r.future.v7_relativeSplatPath]);return q.useEffect(()=>rD(n,r.future),[n,r.future]),q.createElement(q.Fragment,null,q.createElement(Yf.Provider,{value:te},q.createElement(tv.Provider,{value:a},q.createElement(pD.Provider,{value:A.current},q.createElement(Rb.Provider,{value:h},q.createElement(aD,{basename:re,location:a.location,navigationType:a.historyAction,navigator:z,future:b},a.initialized||r.future.v7_partialHydration?q.createElement(wD,{routes:r.routes,future:r.future,state:a}):e))))),null)}const wD=q.memo(TD);function TD(t){let{routes:e,future:r,state:n}=t;return GR(e,void 0,n,r)}const ED=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",bD=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,gt=q.forwardRef(function(e,r){let{onClick:n,relative:a,reloadDocument:l,replace:o,state:u,target:h,to:m,preventScrollReset:p,viewTransition:v}=e,_=kb(e,cD),{basename:w}=q.useContext(Si),E,T=!1;if(typeof m=="string"&&bD.test(m)&&(E=m,ED))try{let R=new URL(window.location.href),z=m.startsWith("//")?new URL(R.protocol+m):new URL(m),re=xi(z.pathname,w);z.origin===R.origin&&re!=null?m=re+z.search+z.hash:T=!0}catch{}let A=BR(m,{relative:a}),M=AD(m,{replace:o,state:u,target:h,preventScrollReset:p,relative:a,viewTransition:v});function F(R){n&&n(R),R.defaultPrevented||M(R)}return q.createElement("a",jc({},_,{href:E||A,onClick:T||l?n:F,ref:r,target:h}))}),sl=q.forwardRef(function(e,r){let{"aria-current":n="page",caseSensitive:a=!1,className:l="",end:o=!1,style:u,to:h,viewTransition:m,children:p}=e,v=kb(e,uD),_=$0(h,{relative:v.relative}),w=ys(),E=q.useContext(tv),{navigator:T,basename:A}=q.useContext(Si),M=E!=null&&CD(_)&&m===!0,F=T.encodeLocation?T.encodeLocation(_).pathname:_.pathname,R=w.pathname,z=E&&E.navigation&&E.navigation.location?E.navigation.location.pathname:null;a||(R=R.toLowerCase(),z=z?z.toLowerCase():null,F=F.toLowerCase()),z&&A&&(z=xi(z,A)||z);const re=F!=="/"&&F.endsWith("/")?F.length-1:F.length;let te=R===F||!o&&R.startsWith(F)&&R.charAt(re)==="/",b=z!=null&&(z===F||!o&&z.startsWith(F)&&z.charAt(F.length)==="/"),N={isActive:te,isPending:b,isTransitioning:M},k=te?n:void 0,j;typeof l=="function"?j=l(N):j=[l,te?"active":null,b?"pending":null,M?"transitioning":null].filter(Boolean).join(" ");let L=typeof u=="function"?u(N):u;return q.createElement(gt,jc({},v,{"aria-current":k,className:j,ref:r,style:L,to:h,viewTransition:m}),typeof p=="function"?p(N):p)});var ox;(function(t){t.UseScrollRestoration="useScrollRestoration",t.UseSubmit="useSubmit",t.UseSubmitFetcher="useSubmitFetcher",t.UseFetcher="useFetcher",t.useViewTransitionState="useViewTransitionState"})(ox||(ox={}));var M2;(function(t){t.UseFetcher="useFetcher",t.UseFetchers="useFetchers",t.UseScrollRestoration="useScrollRestoration"})(M2||(M2={}));function SD(t){let e=q.useContext(Yf);return e||bt(!1),e}function AD(t,e){let{target:r,replace:n,state:a,preventScrollReset:l,relative:o,viewTransition:u}=e===void 0?{}:e,h=Ma(),m=ys(),p=$0(t,{relative:o});return q.useCallback(v=>{if(lD(v,r)){v.preventDefault();let _=n!==void 0?n:go(m)===go(p);h(t,{replace:_,state:a,preventScrollReset:l,relative:o,viewTransition:u})}},[m,h,p,n,a,r,t,l,o,u])}function ND(t){let e=q.useRef(lx(t)),r=q.useRef(!1),n=ys(),a=q.useMemo(()=>oD(n.search,r.current?null:e.current),[n.search]),l=Ma(),o=q.useCallback((u,h)=>{const m=lx(typeof u=="function"?u(a):u);r.current=!0,l("?"+m,h)},[l,a]);return[a,o]}function CD(t,e){e===void 0&&(e={});let r=q.useContext(Rb);r==null&&bt(!1);let{basename:n}=SD(ox.useViewTransitionState),a=$0(t,{relative:e.relative});if(!r.isTransitioning)return!1;let l=xi(r.currentLocation.pathname,n)||r.currentLocation.pathname,o=xi(r.nextLocation.pathname,n)||r.nextLocation.pathname;return p0(a.pathname,o)!=null||p0(a.pathname,l)!=null}var j2={};const Db=function(t){const e=[];let r=0;for(let n=0;n<t.length;n++){let a=t.charCodeAt(n);a<128?e[r++]=a:a<2048?(e[r++]=a>>6|192,e[r++]=a&63|128):(a&64512)===55296&&n+1<t.length&&(t.charCodeAt(n+1)&64512)===56320?(a=65536+((a&1023)<<10)+(t.charCodeAt(++n)&1023),e[r++]=a>>18|240,e[r++]=a>>12&63|128,e[r++]=a>>6&63|128,e[r++]=a&63|128):(e[r++]=a>>12|224,e[r++]=a>>6&63|128,e[r++]=a&63|128)}return e},kD=function(t){const e=[];let r=0,n=0;for(;r<t.length;){const a=t[r++];if(a<128)e[n++]=String.fromCharCode(a);else if(a>191&&a<224){const l=t[r++];e[n++]=String.fromCharCode((a&31)<<6|l&63)}else if(a>239&&a<365){const l=t[r++],o=t[r++],u=t[r++],h=((a&7)<<18|(l&63)<<12|(o&63)<<6|u&63)-65536;e[n++]=String.fromCharCode(55296+(h>>10)),e[n++]=String.fromCharCode(56320+(h&1023))}else{const l=t[r++],o=t[r++];e[n++]=String.fromCharCode((a&15)<<12|(l&63)<<6|o&63)}}return e.join("")},Ib={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const r=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,n=[];for(let a=0;a<t.length;a+=3){const l=t[a],o=a+1<t.length,u=o?t[a+1]:0,h=a+2<t.length,m=h?t[a+2]:0,p=l>>2,v=(l&3)<<4|u>>4;let _=(u&15)<<2|m>>6,w=m&63;h||(w=64,o||(_=64)),n.push(r[p],r[v],r[_],r[w])}return n.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(Db(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):kD(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const r=e?this.charToByteMapWebSafe_:this.charToByteMap_,n=[];for(let a=0;a<t.length;){const l=r[t.charAt(a++)],u=a<t.length?r[t.charAt(a)]:0;++a;const m=a<t.length?r[t.charAt(a)]:64;++a;const v=a<t.length?r[t.charAt(a)]:64;if(++a,l==null||u==null||m==null||v==null)throw new RD;const _=l<<2|u>>4;if(n.push(_),m!==64){const w=u<<4&240|m>>2;if(n.push(w),v!==64){const E=m<<6&192|v;n.push(E)}}}return n},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class RD extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const DD=function(t){const e=Db(t);return Ib.encodeByteArray(e,!0)},v0=function(t){return DD(t).replace(/\./g,"")},Ob=function(t){try{return Ib.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function ID(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}const OD=()=>ID().__FIREBASE_DEFAULTS__,MD=()=>{if(typeof process>"u"||typeof j2>"u")return;const t=j2.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},jD=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&Ob(t[1]);return e&&JSON.parse(e)},X0=()=>{try{return OD()||MD()||jD()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},Mb=t=>{var e,r;return(r=(e=X0())===null||e===void 0?void 0:e.emulatorHosts)===null||r===void 0?void 0:r[t]},nv=t=>{const e=Mb(t);if(!e)return;const r=e.lastIndexOf(":");if(r<=0||r+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const n=parseInt(e.substring(r+1),10);return e[0]==="["?[e.substring(1,r-1),n]:[e.substring(0,r),n]},jb=()=>{var t;return(t=X0())===null||t===void 0?void 0:t.config},Fb=t=>{var e;return(e=X0())===null||e===void 0?void 0:e[`_${t}`]};class FD{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,r)=>{this.resolve=e,this.reject=r})}wrapCallback(e){return(r,n)=>{r?this.reject(r):this.resolve(n),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(r):e(r,n))}}}function Pb(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const r={alg:"none",type:"JWT"},n=e||"demo-project",a=t.iat||0,l=t.sub||t.user_id;if(!l)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o=Object.assign({iss:`https://securetoken.google.com/${n}`,aud:n,iat:a,exp:a+3600,auth_time:a,sub:l,user_id:l,firebase:{sign_in_provider:"custom",identities:{}}},t);return[v0(JSON.stringify(r)),v0(JSON.stringify(o)),""].join(".")}function Bn(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function PD(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Bn())}function LD(){var t;const e=(t=X0())===null||t===void 0?void 0:t.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function UD(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function BD(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function VD(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function zD(){const t=Bn();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function HD(){return!LD()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function GD(){try{return typeof indexedDB=="object"}catch{return!1}}function qD(){return new Promise((t,e)=>{try{let r=!0;const n="validate-browser-context-for-indexeddb-analytics-module",a=self.indexedDB.open(n);a.onsuccess=()=>{a.result.close(),r||self.indexedDB.deleteDatabase(n),t(!0)},a.onupgradeneeded=()=>{r=!1},a.onerror=()=>{var l;e(((l=a.error)===null||l===void 0?void 0:l.message)||"")}}catch(r){e(r)}})}const WD="FirebaseError";class _s extends Error{constructor(e,r,n){super(r),this.code=e,this.customData=n,this.name=WD,Object.setPrototypeOf(this,_s.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,$f.prototype.create)}}class $f{constructor(e,r,n){this.service=e,this.serviceName=r,this.errors=n}create(e,...r){const n=r[0]||{},a=`${this.service}/${e}`,l=this.errors[e],o=l?KD(l,n):"Error",u=`${this.serviceName}: ${o} (${a}).`;return new _s(a,u,n)}}function KD(t,e){return t.replace(YD,(r,n)=>{const a=e[n];return a!=null?String(a):`<${n}?>`})}const YD=/\{\$([^}]+)}/g;function $D(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function y0(t,e){if(t===e)return!0;const r=Object.keys(t),n=Object.keys(e);for(const a of r){if(!n.includes(a))return!1;const l=t[a],o=e[a];if(F2(l)&&F2(o)){if(!y0(l,o))return!1}else if(l!==o)return!1}for(const a of n)if(!r.includes(a))return!1;return!0}function F2(t){return t!==null&&typeof t=="object"}function Xf(t){const e=[];for(const[r,n]of Object.entries(t))Array.isArray(n)?n.forEach(a=>{e.push(encodeURIComponent(r)+"="+encodeURIComponent(a))}):e.push(encodeURIComponent(r)+"="+encodeURIComponent(n));return e.length?"&"+e.join("&"):""}function XD(t,e){const r=new QD(t,e);return r.subscribe.bind(r)}class QD{constructor(e,r){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=r,this.task.then(()=>{e(this)}).catch(n=>{this.error(n)})}next(e){this.forEachObserver(r=>{r.next(e)})}error(e){this.forEachObserver(r=>{r.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,r,n){let a;if(e===void 0&&r===void 0&&n===void 0)throw new Error("Missing Observer.");JD(e,["next","error","complete"])?a=e:a={next:e,error:r,complete:n},a.next===void 0&&(a.next=Mg),a.error===void 0&&(a.error=Mg),a.complete===void 0&&(a.complete=Mg);const l=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?a.error(this.finalError):a.complete()}catch{}}),this.observers.push(a),l}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let r=0;r<this.observers.length;r++)this.sendOne(r,e)}sendOne(e,r){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{r(this.observers[e])}catch(n){typeof console<"u"&&console.error&&console.error(n)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function JD(t,e){if(typeof t!="object"||t===null)return!1;for(const r of e)if(r in t&&typeof t[r]=="function")return!0;return!1}function Mg(){}function vr(t){return t&&t._delegate?t._delegate:t}class vi{constructor(e,r,n){this.name=e,this.instanceFactory=r,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}const to="[DEFAULT]";class ZD{constructor(e,r){this.name=e,this.container=r,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const r=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(r)){const n=new FD;if(this.instancesDeferred.set(r,n),this.isInitialized(r)||this.shouldAutoInitialize())try{const a=this.getOrInitializeService({instanceIdentifier:r});a&&n.resolve(a)}catch{}}return this.instancesDeferred.get(r).promise}getImmediate(e){var r;const n=this.normalizeInstanceIdentifier(e?.identifier),a=(r=e?.optional)!==null&&r!==void 0?r:!1;if(this.isInitialized(n)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:n})}catch(l){if(a)return null;throw l}else{if(a)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(tI(e))try{this.getOrInitializeService({instanceIdentifier:to})}catch{}for(const[r,n]of this.instancesDeferred.entries()){const a=this.normalizeInstanceIdentifier(r);try{const l=this.getOrInitializeService({instanceIdentifier:a});n.resolve(l)}catch{}}}}clearInstance(e=to){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(r=>"INTERNAL"in r).map(r=>r.INTERNAL.delete()),...e.filter(r=>"_delete"in r).map(r=>r._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=to){return this.instances.has(e)}getOptions(e=to){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:r={}}=e,n=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(n))throw Error(`${this.name}(${n}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const a=this.getOrInitializeService({instanceIdentifier:n,options:r});for(const[l,o]of this.instancesDeferred.entries()){const u=this.normalizeInstanceIdentifier(l);n===u&&o.resolve(a)}return a}onInit(e,r){var n;const a=this.normalizeInstanceIdentifier(r),l=(n=this.onInitCallbacks.get(a))!==null&&n!==void 0?n:new Set;l.add(e),this.onInitCallbacks.set(a,l);const o=this.instances.get(a);return o&&e(o,a),()=>{l.delete(e)}}invokeOnInitCallbacks(e,r){const n=this.onInitCallbacks.get(r);if(n)for(const a of n)try{a(e,r)}catch{}}getOrInitializeService({instanceIdentifier:e,options:r={}}){let n=this.instances.get(e);if(!n&&this.component&&(n=this.component.instanceFactory(this.container,{instanceIdentifier:eI(e),options:r}),this.instances.set(e,n),this.instancesOptions.set(e,r),this.invokeOnInitCallbacks(n,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,n)}catch{}return n||null}normalizeInstanceIdentifier(e=to){return this.component?this.component.multipleInstances?e:to:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function eI(t){return t===to?void 0:t}function tI(t){return t.instantiationMode==="EAGER"}class rI{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const r=this.getProvider(e.name);if(r.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);r.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const r=new ZD(e,this);return this.providers.set(e,r),r}getProviders(){return Array.from(this.providers.values())}}var jt;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(jt||(jt={}));const nI={debug:jt.DEBUG,verbose:jt.VERBOSE,info:jt.INFO,warn:jt.WARN,error:jt.ERROR,silent:jt.SILENT},aI=jt.INFO,sI={[jt.DEBUG]:"log",[jt.VERBOSE]:"log",[jt.INFO]:"info",[jt.WARN]:"warn",[jt.ERROR]:"error"},iI=(t,e,...r)=>{if(e<t.logLevel)return;const n=new Date().toISOString(),a=sI[e];if(a)console[a](`[${n}]  ${t.name}:`,...r);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class av{constructor(e){this.name=e,this._logLevel=aI,this._logHandler=iI,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in jt))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?nI[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,jt.DEBUG,...e),this._logHandler(this,jt.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,jt.VERBOSE,...e),this._logHandler(this,jt.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,jt.INFO,...e),this._logHandler(this,jt.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,jt.WARN,...e),this._logHandler(this,jt.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,jt.ERROR,...e),this._logHandler(this,jt.ERROR,...e)}}const lI=(t,e)=>e.some(r=>t instanceof r);let P2,L2;function oI(){return P2||(P2=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function cI(){return L2||(L2=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const Lb=new WeakMap,cx=new WeakMap,Ub=new WeakMap,jg=new WeakMap,sv=new WeakMap;function uI(t){const e=new Promise((r,n)=>{const a=()=>{t.removeEventListener("success",l),t.removeEventListener("error",o)},l=()=>{r(vl(t.result)),a()},o=()=>{n(t.error),a()};t.addEventListener("success",l),t.addEventListener("error",o)});return e.then(r=>{r instanceof IDBCursor&&Lb.set(r,t)}).catch(()=>{}),sv.set(e,t),e}function fI(t){if(cx.has(t))return;const e=new Promise((r,n)=>{const a=()=>{t.removeEventListener("complete",l),t.removeEventListener("error",o),t.removeEventListener("abort",o)},l=()=>{r(),a()},o=()=>{n(t.error||new DOMException("AbortError","AbortError")),a()};t.addEventListener("complete",l),t.addEventListener("error",o),t.addEventListener("abort",o)});cx.set(t,e)}let ux={get(t,e,r){if(t instanceof IDBTransaction){if(e==="done")return cx.get(t);if(e==="objectStoreNames")return t.objectStoreNames||Ub.get(t);if(e==="store")return r.objectStoreNames[1]?void 0:r.objectStore(r.objectStoreNames[0])}return vl(t[e])},set(t,e,r){return t[e]=r,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function hI(t){ux=t(ux)}function dI(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...r){const n=t.call(Fg(this),e,...r);return Ub.set(n,e.sort?e.sort():[e]),vl(n)}:cI().includes(t)?function(...e){return t.apply(Fg(this),e),vl(Lb.get(this))}:function(...e){return vl(t.apply(Fg(this),e))}}function mI(t){return typeof t=="function"?dI(t):(t instanceof IDBTransaction&&fI(t),lI(t,oI())?new Proxy(t,ux):t)}function vl(t){if(t instanceof IDBRequest)return uI(t);if(jg.has(t))return jg.get(t);const e=mI(t);return e!==t&&(jg.set(t,e),sv.set(e,t)),e}const Fg=t=>sv.get(t);function pI(t,e,{blocked:r,upgrade:n,blocking:a,terminated:l}={}){const o=indexedDB.open(t,e),u=vl(o);return n&&o.addEventListener("upgradeneeded",h=>{n(vl(o.result),h.oldVersion,h.newVersion,vl(o.transaction),h)}),r&&o.addEventListener("blocked",h=>r(h.oldVersion,h.newVersion,h)),u.then(h=>{l&&h.addEventListener("close",()=>l()),a&&h.addEventListener("versionchange",m=>a(m.oldVersion,m.newVersion,m))}).catch(()=>{}),u}const gI=["get","getKey","getAll","getAllKeys","count"],xI=["put","add","delete","clear"],Pg=new Map;function U2(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(Pg.get(e))return Pg.get(e);const r=e.replace(/FromIndex$/,""),n=e!==r,a=xI.includes(r);if(!(r in(n?IDBIndex:IDBObjectStore).prototype)||!(a||gI.includes(r)))return;const l=async function(o,...u){const h=this.transaction(o,a?"readwrite":"readonly");let m=h.store;return n&&(m=m.index(u.shift())),(await Promise.all([m[r](...u),a&&h.done]))[0]};return Pg.set(e,l),l}hI(t=>({...t,get:(e,r,n)=>U2(e,r)||t.get(e,r,n),has:(e,r)=>!!U2(e,r)||t.has(e,r)}));class vI{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(r=>{if(yI(r)){const n=r.getImmediate();return`${n.library}/${n.version}`}else return null}).filter(r=>r).join(" ")}}function yI(t){const e=t.getComponent();return e?.type==="VERSION"}const fx="@firebase/app",B2="0.10.13";const yi=new av("@firebase/app"),_I="@firebase/app-compat",wI="@firebase/analytics-compat",TI="@firebase/analytics",EI="@firebase/app-check-compat",bI="@firebase/app-check",SI="@firebase/auth",AI="@firebase/auth-compat",NI="@firebase/database",CI="@firebase/data-connect",kI="@firebase/database-compat",RI="@firebase/functions",DI="@firebase/functions-compat",II="@firebase/installations",OI="@firebase/installations-compat",MI="@firebase/messaging",jI="@firebase/messaging-compat",FI="@firebase/performance",PI="@firebase/performance-compat",LI="@firebase/remote-config",UI="@firebase/remote-config-compat",BI="@firebase/storage",VI="@firebase/storage-compat",zI="@firebase/firestore",HI="@firebase/vertexai-preview",GI="@firebase/firestore-compat",qI="firebase",WI="10.14.1";const hx="[DEFAULT]",KI={[fx]:"fire-core",[_I]:"fire-core-compat",[TI]:"fire-analytics",[wI]:"fire-analytics-compat",[bI]:"fire-app-check",[EI]:"fire-app-check-compat",[SI]:"fire-auth",[AI]:"fire-auth-compat",[NI]:"fire-rtdb",[CI]:"fire-data-connect",[kI]:"fire-rtdb-compat",[RI]:"fire-fn",[DI]:"fire-fn-compat",[II]:"fire-iid",[OI]:"fire-iid-compat",[MI]:"fire-fcm",[jI]:"fire-fcm-compat",[FI]:"fire-perf",[PI]:"fire-perf-compat",[LI]:"fire-rc",[UI]:"fire-rc-compat",[BI]:"fire-gcs",[VI]:"fire-gcs-compat",[zI]:"fire-fst",[GI]:"fire-fst-compat",[HI]:"fire-vertex","fire-js":"fire-js",[qI]:"fire-js-all"};const _0=new Map,YI=new Map,dx=new Map;function V2(t,e){try{t.container.addComponent(e)}catch(r){yi.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,r)}}function Tl(t){const e=t.name;if(dx.has(e))return yi.debug(`There were multiple attempts to register component ${e}.`),!1;dx.set(e,t);for(const r of _0.values())V2(r,t);for(const r of YI.values())V2(r,t);return!0}function Qf(t,e){const r=t.container.getProvider("heartbeat").getImmediate({optional:!0});return r&&r.triggerHeartbeat(),t.container.getProvider(e)}function oi(t){return t.settings!==void 0}const $I={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},yl=new $f("app","Firebase",$I);class XI{constructor(e,r,n){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},r),this._name=r.name,this._automaticDataCollectionEnabled=r.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new vi("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw yl.create("app-deleted",{appName:this._name})}}const So=WI;function Bb(t,e={}){let r=t;typeof e!="object"&&(e={name:e});const n=Object.assign({name:hx,automaticDataCollectionEnabled:!1},e),a=n.name;if(typeof a!="string"||!a)throw yl.create("bad-app-name",{appName:String(a)});if(r||(r=jb()),!r)throw yl.create("no-options");const l=_0.get(a);if(l){if(y0(r,l.options)&&y0(n,l.config))return l;throw yl.create("duplicate-app",{appName:a})}const o=new rI(a);for(const h of dx.values())o.addComponent(h);const u=new XI(r,n,o);return _0.set(a,u),u}function Q0(t=hx){const e=_0.get(t);if(!e&&t===hx&&jb())return Bb();if(!e)throw yl.create("no-app",{appName:t});return e}function Ja(t,e,r){var n;let a=(n=KI[t])!==null&&n!==void 0?n:t;r&&(a+=`-${r}`);const l=a.match(/\s|\//),o=e.match(/\s|\//);if(l||o){const u=[`Unable to register library "${a}" with version "${e}":`];l&&u.push(`library name "${a}" contains illegal characters (whitespace or "/")`),l&&o&&u.push("and"),o&&u.push(`version name "${e}" contains illegal characters (whitespace or "/")`),yi.warn(u.join(" "));return}Tl(new vi(`${a}-version`,()=>({library:a,version:e}),"VERSION"))}const QI="firebase-heartbeat-database",JI=1,Cf="firebase-heartbeat-store";let Lg=null;function Vb(){return Lg||(Lg=pI(QI,JI,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(Cf)}catch(r){console.warn(r)}}}}).catch(t=>{throw yl.create("idb-open",{originalErrorMessage:t.message})})),Lg}async function ZI(t){try{const r=(await Vb()).transaction(Cf),n=await r.objectStore(Cf).get(zb(t));return await r.done,n}catch(e){if(e instanceof _s)yi.warn(e.message);else{const r=yl.create("idb-get",{originalErrorMessage:e?.message});yi.warn(r.message)}}}async function z2(t,e){try{const n=(await Vb()).transaction(Cf,"readwrite");await n.objectStore(Cf).put(e,zb(t)),await n.done}catch(r){if(r instanceof _s)yi.warn(r.message);else{const n=yl.create("idb-set",{originalErrorMessage:r?.message});yi.warn(n.message)}}}function zb(t){return`${t.name}!${t.options.appId}`}const e3=1024,t3=720*60*60*1e3;class r3{constructor(e){this.container=e,this._heartbeatsCache=null;const r=this.container.getProvider("app").getImmediate();this._storage=new a3(r),this._heartbeatsCachePromise=this._storage.read().then(n=>(this._heartbeatsCache=n,n))}async triggerHeartbeat(){var e,r;try{const a=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),l=H2();return((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((r=this._heartbeatsCache)===null||r===void 0?void 0:r.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===l||this._heartbeatsCache.heartbeats.some(o=>o.date===l)?void 0:(this._heartbeatsCache.heartbeats.push({date:l,agent:a}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(o=>{const u=new Date(o.date).valueOf();return Date.now()-u<=t3}),this._storage.overwrite(this._heartbeatsCache))}catch(n){yi.warn(n)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const r=H2(),{heartbeatsToSend:n,unsentEntries:a}=n3(this._heartbeatsCache.heartbeats),l=v0(JSON.stringify({version:2,heartbeats:n}));return this._heartbeatsCache.lastSentHeartbeatDate=r,a.length>0?(this._heartbeatsCache.heartbeats=a,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),l}catch(r){return yi.warn(r),""}}}function H2(){return new Date().toISOString().substring(0,10)}function n3(t,e=e3){const r=[];let n=t.slice();for(const a of t){const l=r.find(o=>o.agent===a.agent);if(l){if(l.dates.push(a.date),G2(r)>e){l.dates.pop();break}}else if(r.push({agent:a.agent,dates:[a.date]}),G2(r)>e){r.pop();break}n=n.slice(1)}return{heartbeatsToSend:r,unsentEntries:n}}class a3{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return GD()?qD().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const r=await ZI(this.app);return r?.heartbeats?r:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){var r;if(await this._canUseIndexedDBPromise){const a=await this.read();return z2(this.app,{lastSentHeartbeatDate:(r=e.lastSentHeartbeatDate)!==null&&r!==void 0?r:a.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var r;if(await this._canUseIndexedDBPromise){const a=await this.read();return z2(this.app,{lastSentHeartbeatDate:(r=e.lastSentHeartbeatDate)!==null&&r!==void 0?r:a.lastSentHeartbeatDate,heartbeats:[...a.heartbeats,...e.heartbeats]})}else return}}function G2(t){return v0(JSON.stringify({version:2,heartbeats:t})).length}function s3(t){Tl(new vi("platform-logger",e=>new vI(e),"PRIVATE")),Tl(new vi("heartbeat",e=>new r3(e),"PRIVATE")),Ja(fx,B2,t),Ja(fx,B2,"esm2017"),Ja("fire-js","")}s3("");function iv(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,n=Object.getOwnPropertySymbols(t);a<n.length;a++)e.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(t,n[a])&&(r[n[a]]=t[n[a]]);return r}function Hb(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const i3=Hb,Gb=new $f("auth","Firebase",Hb());const w0=new av("@firebase/auth");function l3(t,...e){w0.logLevel<=jt.WARN&&w0.warn(`Auth (${So}): ${t}`,...e)}function n0(t,...e){w0.logLevel<=jt.ERROR&&w0.error(`Auth (${So}): ${t}`,...e)}function Fs(t,...e){throw ov(t,...e)}function ps(t,...e){return ov(t,...e)}function lv(t,e,r){const n=Object.assign(Object.assign({},i3()),{[e]:r});return new $f("auth","Firebase",n).create(e,{appName:t.name})}function co(t){return lv(t,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function o3(t,e,r){const n=r;if(!(e instanceof n))throw n.name!==e.constructor.name&&Fs(t,"argument-error"),lv(t,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function ov(t,...e){if(typeof t!="string"){const r=e[0],n=[...e.slice(1)];return n[0]&&(n[0].appName=t.name),t._errorFactory.create(r,...n)}return Gb.create(t,...e)}function ot(t,e,...r){if(!t)throw ov(e,...r)}function ci(t){const e="INTERNAL ASSERTION FAILED: "+t;throw n0(e),new Error(e)}function _i(t,e){t||ci(e)}function mx(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.href)||""}function c3(){return q2()==="http:"||q2()==="https:"}function q2(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.protocol)||null}function u3(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(c3()||BD()||"connection"in navigator)?navigator.onLine:!0}function f3(){if(typeof navigator>"u")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}class Jf{constructor(e,r){this.shortDelay=e,this.longDelay=r,_i(r>e,"Short delay should be less than long delay!"),this.isMobile=PD()||VD()}get(){return u3()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}function cv(t,e){_i(t.emulator,"Emulator should always be set here");const{url:r}=t.emulator;return e?`${r}${e.startsWith("/")?e.slice(1):e}`:r}class qb{static initialize(e,r,n){this.fetchImpl=e,r&&(this.headersImpl=r),n&&(this.responseImpl=n)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;ci("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;ci("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;ci("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const h3={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};const d3=new Jf(3e4,6e4);function uv(t,e){return t.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:t.tenantId}):e}async function Kc(t,e,r,n,a={}){return Wb(t,a,async()=>{let l={},o={};n&&(e==="GET"?o=n:l={body:JSON.stringify(n)});const u=Xf(Object.assign({key:t.config.apiKey},o)).slice(1),h=await t._getAdditionalHeaders();h["Content-Type"]="application/json",t.languageCode&&(h["X-Firebase-Locale"]=t.languageCode);const m=Object.assign({method:e,headers:h},l);return UD()||(m.referrerPolicy="no-referrer"),qb.fetch()(Kb(t,t.config.apiHost,r,u),m)})}async function Wb(t,e,r){t._canInitEmulator=!1;const n=Object.assign(Object.assign({},h3),e);try{const a=new p3(t),l=await Promise.race([r(),a.promise]);a.clearNetworkTimeout();const o=await l.json();if("needConfirmation"in o)throw Ud(t,"account-exists-with-different-credential",o);if(l.ok&&!("errorMessage"in o))return o;{const u=l.ok?o.errorMessage:o.error.message,[h,m]=u.split(" : ");if(h==="FEDERATED_USER_ID_ALREADY_LINKED")throw Ud(t,"credential-already-in-use",o);if(h==="EMAIL_EXISTS")throw Ud(t,"email-already-in-use",o);if(h==="USER_DISABLED")throw Ud(t,"user-disabled",o);const p=n[h]||h.toLowerCase().replace(/[_\s]+/g,"-");if(m)throw lv(t,p,m);Fs(t,p)}}catch(a){if(a instanceof _s)throw a;Fs(t,"network-request-failed",{message:String(a)})}}async function m3(t,e,r,n,a={}){const l=await Kc(t,e,r,n,a);return"mfaPendingCredential"in l&&Fs(t,"multi-factor-auth-required",{_serverResponse:l}),l}function Kb(t,e,r,n){const a=`${e}${r}?${n}`;return t.config.emulator?cv(t.config,a):`${t.config.apiScheme}://${a}`}class p3{constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((r,n)=>{this.timer=setTimeout(()=>n(ps(this.auth,"network-request-failed")),d3.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}}function Ud(t,e,r){const n={appName:t.name};r.email&&(n.email=r.email),r.phoneNumber&&(n.phoneNumber=r.phoneNumber);const a=ps(t,e,n);return a.customData._tokenResponse=r,a}async function g3(t,e){return Kc(t,"POST","/v1/accounts:delete",e)}async function Yb(t,e){return Kc(t,"POST","/v1/accounts:lookup",e)}function cf(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function $b(t,e=!1){const r=vr(t),n=await r.getIdToken(e),a=fv(n);ot(a&&a.exp&&a.auth_time&&a.iat,r.auth,"internal-error");const l=typeof a.firebase=="object"?a.firebase:void 0,o=l?.sign_in_provider;return{claims:a,token:n,authTime:cf(Ug(a.auth_time)),issuedAtTime:cf(Ug(a.iat)),expirationTime:cf(Ug(a.exp)),signInProvider:o||null,signInSecondFactor:l?.sign_in_second_factor||null}}function Ug(t){return Number(t)*1e3}function fv(t){const[e,r,n]=t.split(".");if(e===void 0||r===void 0||n===void 0)return n0("JWT malformed, contained fewer than 3 sections"),null;try{const a=Ob(r);return a?JSON.parse(a):(n0("Failed to decode base64 JWT payload"),null)}catch(a){return n0("Caught error parsing JWT payload as JSON",a?.toString()),null}}function W2(t){const e=fv(t);return ot(e,"internal-error"),ot(typeof e.exp<"u","internal-error"),ot(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}async function kf(t,e,r=!1){if(r)return e;try{return await e}catch(n){throw n instanceof _s&&x3(n)&&t.auth.currentUser===t&&await t.auth.signOut(),n}}function x3({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}class v3{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var r;if(e){const n=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),n}else{this.errorBackoff=3e4;const a=((r=this.user.stsTokenManager.expirationTime)!==null&&r!==void 0?r:0)-Date.now()-3e5;return Math.max(0,a)}}schedule(e=!1){if(!this.isRunning)return;const r=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},r)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){e?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}class px{constructor(e,r){this.createdAt=e,this.lastLoginAt=r,this._initializeTime()}_initializeTime(){this.lastSignInTime=cf(this.lastLoginAt),this.creationTime=cf(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}async function T0(t){var e;const r=t.auth,n=await t.getIdToken(),a=await kf(t,Yb(r,{idToken:n}));ot(a?.users.length,r,"internal-error");const l=a.users[0];t._notifyReloadListener(l);const o=!((e=l.providerUserInfo)===null||e===void 0)&&e.length?Xb(l.providerUserInfo):[],u=_3(t.providerData,o),h=t.isAnonymous,m=!(t.email&&l.passwordHash)&&!u?.length,p=h?m:!1,v={uid:l.localId,displayName:l.displayName||null,photoURL:l.photoUrl||null,email:l.email||null,emailVerified:l.emailVerified||!1,phoneNumber:l.phoneNumber||null,tenantId:l.tenantId||null,providerData:u,metadata:new px(l.createdAt,l.lastLoginAt),isAnonymous:p};Object.assign(t,v)}async function y3(t){const e=vr(t);await T0(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function _3(t,e){return[...t.filter(n=>!e.some(a=>a.providerId===n.providerId)),...e]}function Xb(t){return t.map(e=>{var{providerId:r}=e,n=iv(e,["providerId"]);return{providerId:r,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}})}async function w3(t,e){const r=await Wb(t,{},async()=>{const n=Xf({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:a,apiKey:l}=t.config,o=Kb(t,a,"/v1/token",`key=${l}`),u=await t._getAdditionalHeaders();return u["Content-Type"]="application/x-www-form-urlencoded",qb.fetch()(o,{method:"POST",headers:u,body:n})});return{accessToken:r.access_token,expiresIn:r.expires_in,refreshToken:r.refresh_token}}async function T3(t,e){return Kc(t,"POST","/v2/accounts:revokeToken",uv(t,e))}class Sc{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){ot(e.idToken,"internal-error"),ot(typeof e.idToken<"u","internal-error"),ot(typeof e.refreshToken<"u","internal-error");const r="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):W2(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,r)}updateFromIdToken(e){ot(e.length!==0,"internal-error");const r=W2(e);this.updateTokensAndExpiration(e,null,r)}async getToken(e,r=!1){return!r&&this.accessToken&&!this.isExpired?this.accessToken:(ot(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,r){const{accessToken:n,refreshToken:a,expiresIn:l}=await w3(e,r);this.updateTokensAndExpiration(n,a,Number(l))}updateTokensAndExpiration(e,r,n){this.refreshToken=r||null,this.accessToken=e||null,this.expirationTime=Date.now()+n*1e3}static fromJSON(e,r){const{refreshToken:n,accessToken:a,expirationTime:l}=r,o=new Sc;return n&&(ot(typeof n=="string","internal-error",{appName:e}),o.refreshToken=n),a&&(ot(typeof a=="string","internal-error",{appName:e}),o.accessToken=a),l&&(ot(typeof l=="number","internal-error",{appName:e}),o.expirationTime=l),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new Sc,this.toJSON())}_performRefresh(){return ci("not implemented")}}function il(t,e){ot(typeof t=="string"||typeof t>"u","internal-error",{appName:e})}class ui{constructor(e){var{uid:r,auth:n,stsTokenManager:a}=e,l=iv(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new v3(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=r,this.auth=n,this.stsTokenManager=a,this.accessToken=a.accessToken,this.displayName=l.displayName||null,this.email=l.email||null,this.emailVerified=l.emailVerified||!1,this.phoneNumber=l.phoneNumber||null,this.photoURL=l.photoURL||null,this.isAnonymous=l.isAnonymous||!1,this.tenantId=l.tenantId||null,this.providerData=l.providerData?[...l.providerData]:[],this.metadata=new px(l.createdAt||void 0,l.lastLoginAt||void 0)}async getIdToken(e){const r=await kf(this,this.stsTokenManager.getToken(this.auth,e));return ot(r,this.auth,"internal-error"),this.accessToken!==r&&(this.accessToken=r,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),r}getIdTokenResult(e){return $b(this,e)}reload(){return y3(this)}_assign(e){this!==e&&(ot(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(r=>Object.assign({},r)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const r=new ui(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return r.metadata._copy(this.metadata),r}_onReload(e){ot(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,r=!1){let n=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),n=!0),r&&await T0(this),await this.auth._persistUserIfCurrent(this),n&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(oi(this.auth.app))return Promise.reject(co(this.auth));const e=await this.getIdToken();return await kf(this,g3(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,r){var n,a,l,o,u,h,m,p;const v=(n=r.displayName)!==null&&n!==void 0?n:void 0,_=(a=r.email)!==null&&a!==void 0?a:void 0,w=(l=r.phoneNumber)!==null&&l!==void 0?l:void 0,E=(o=r.photoURL)!==null&&o!==void 0?o:void 0,T=(u=r.tenantId)!==null&&u!==void 0?u:void 0,A=(h=r._redirectEventId)!==null&&h!==void 0?h:void 0,M=(m=r.createdAt)!==null&&m!==void 0?m:void 0,F=(p=r.lastLoginAt)!==null&&p!==void 0?p:void 0,{uid:R,emailVerified:z,isAnonymous:re,providerData:te,stsTokenManager:b}=r;ot(R&&b,e,"internal-error");const N=Sc.fromJSON(this.name,b);ot(typeof R=="string",e,"internal-error"),il(v,e.name),il(_,e.name),ot(typeof z=="boolean",e,"internal-error"),ot(typeof re=="boolean",e,"internal-error"),il(w,e.name),il(E,e.name),il(T,e.name),il(A,e.name),il(M,e.name),il(F,e.name);const k=new ui({uid:R,auth:e,email:_,emailVerified:z,displayName:v,isAnonymous:re,photoURL:E,phoneNumber:w,tenantId:T,stsTokenManager:N,createdAt:M,lastLoginAt:F});return te&&Array.isArray(te)&&(k.providerData=te.map(j=>Object.assign({},j))),A&&(k._redirectEventId=A),k}static async _fromIdTokenResponse(e,r,n=!1){const a=new Sc;a.updateFromServerResponse(r);const l=new ui({uid:r.localId,auth:e,stsTokenManager:a,isAnonymous:n});return await T0(l),l}static async _fromGetAccountInfoResponse(e,r,n){const a=r.users[0];ot(a.localId!==void 0,"internal-error");const l=a.providerUserInfo!==void 0?Xb(a.providerUserInfo):[],o=!(a.email&&a.passwordHash)&&!l?.length,u=new Sc;u.updateFromIdToken(n);const h=new ui({uid:a.localId,auth:e,stsTokenManager:u,isAnonymous:o}),m={uid:a.localId,displayName:a.displayName||null,photoURL:a.photoUrl||null,email:a.email||null,emailVerified:a.emailVerified||!1,phoneNumber:a.phoneNumber||null,tenantId:a.tenantId||null,providerData:l,metadata:new px(a.createdAt,a.lastLoginAt),isAnonymous:!(a.email&&a.passwordHash)&&!l?.length};return Object.assign(h,m),h}}const K2=new Map;function fi(t){_i(t instanceof Function,"Expected a class definition");let e=K2.get(t);return e?(_i(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,K2.set(t,e),e)}class Qb{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,r){this.storage[e]=r}async _get(e){const r=this.storage[e];return r===void 0?null:r}async _remove(e){delete this.storage[e]}_addListener(e,r){}_removeListener(e,r){}}Qb.type="NONE";const Y2=Qb;function a0(t,e,r){return`firebase:${t}:${e}:${r}`}class Ac{constructor(e,r,n){this.persistence=e,this.auth=r,this.userKey=n;const{config:a,name:l}=this.auth;this.fullUserKey=a0(this.userKey,a.apiKey,l),this.fullPersistenceKey=a0("persistence",a.apiKey,l),this.boundEventHandler=r._onStorageEvent.bind(r),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);return e?ui._fromJSON(this.auth,e):null}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const r=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,r)return this.setCurrentUser(r)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,r,n="authUser"){if(!r.length)return new Ac(fi(Y2),e,n);const a=(await Promise.all(r.map(async m=>{if(await m._isAvailable())return m}))).filter(m=>m);let l=a[0]||fi(Y2);const o=a0(n,e.config.apiKey,e.name);let u=null;for(const m of r)try{const p=await m._get(o);if(p){const v=ui._fromJSON(e,p);m!==l&&(u=v),l=m;break}}catch{}const h=a.filter(m=>m._shouldAllowMigration);return!l._shouldAllowMigration||!h.length?new Ac(l,e,n):(l=h[0],u&&await l._set(o,u.toJSON()),await Promise.all(r.map(async m=>{if(m!==l)try{await m._remove(o)}catch{}})),new Ac(l,e,n))}}function $2(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(tS(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(Jb(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(nS(e))return"Blackberry";if(aS(e))return"Webos";if(Zb(e))return"Safari";if((e.includes("chrome/")||eS(e))&&!e.includes("edge/"))return"Chrome";if(rS(e))return"Android";{const r=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,n=t.match(r);if(n?.length===2)return n[1]}return"Other"}function Jb(t=Bn()){return/firefox\//i.test(t)}function Zb(t=Bn()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function eS(t=Bn()){return/crios\//i.test(t)}function tS(t=Bn()){return/iemobile/i.test(t)}function rS(t=Bn()){return/android/i.test(t)}function nS(t=Bn()){return/blackberry/i.test(t)}function aS(t=Bn()){return/webos/i.test(t)}function hv(t=Bn()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function E3(t=Bn()){var e;return hv(t)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function b3(){return zD()&&document.documentMode===10}function sS(t=Bn()){return hv(t)||rS(t)||aS(t)||nS(t)||/windows phone/i.test(t)||tS(t)}function iS(t,e=[]){let r;switch(t){case"Browser":r=$2(Bn());break;case"Worker":r=`${$2(Bn())}-${t}`;break;default:r=t}const n=e.length?e.join(","):"FirebaseCore-web";return`${r}/JsCore/${So}/${n}`}class S3{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,r){const n=l=>new Promise((o,u)=>{try{const h=e(l);o(h)}catch(h){u(h)}});n.onAbort=r,this.queue.push(n);const a=this.queue.length-1;return()=>{this.queue[a]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const r=[];try{for(const n of this.queue)await n(e),n.onAbort&&r.push(n.onAbort)}catch(n){r.reverse();for(const a of r)try{a()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:n?.message})}}}async function A3(t,e={}){return Kc(t,"GET","/v2/passwordPolicy",uv(t,e))}const N3=6;class C3{constructor(e){var r,n,a,l;const o=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(r=o.minPasswordLength)!==null&&r!==void 0?r:N3,o.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=o.maxPasswordLength),o.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=o.containsLowercaseCharacter),o.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=o.containsUppercaseCharacter),o.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=o.containsNumericCharacter),o.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=o.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(a=(n=e.allowedNonAlphanumericCharacters)===null||n===void 0?void 0:n.join(""))!==null&&a!==void 0?a:"",this.forceUpgradeOnSignin=(l=e.forceUpgradeOnSignin)!==null&&l!==void 0?l:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var r,n,a,l,o,u;const h={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,h),this.validatePasswordCharacterOptions(e,h),h.isValid&&(h.isValid=(r=h.meetsMinPasswordLength)!==null&&r!==void 0?r:!0),h.isValid&&(h.isValid=(n=h.meetsMaxPasswordLength)!==null&&n!==void 0?n:!0),h.isValid&&(h.isValid=(a=h.containsLowercaseLetter)!==null&&a!==void 0?a:!0),h.isValid&&(h.isValid=(l=h.containsUppercaseLetter)!==null&&l!==void 0?l:!0),h.isValid&&(h.isValid=(o=h.containsNumericCharacter)!==null&&o!==void 0?o:!0),h.isValid&&(h.isValid=(u=h.containsNonAlphanumericCharacter)!==null&&u!==void 0?u:!0),h}validatePasswordLengthOptions(e,r){const n=this.customStrengthOptions.minPasswordLength,a=this.customStrengthOptions.maxPasswordLength;n&&(r.meetsMinPasswordLength=e.length>=n),a&&(r.meetsMaxPasswordLength=e.length<=a)}validatePasswordCharacterOptions(e,r){this.updatePasswordCharacterOptionsStatuses(r,!1,!1,!1,!1);let n;for(let a=0;a<e.length;a++)n=e.charAt(a),this.updatePasswordCharacterOptionsStatuses(r,n>="a"&&n<="z",n>="A"&&n<="Z",n>="0"&&n<="9",this.allowedNonAlphanumericCharacters.includes(n))}updatePasswordCharacterOptionsStatuses(e,r,n,a,l){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=r)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=n)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=a)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=l))}}class k3{constructor(e,r,n,a){this.app=e,this.heartbeatServiceProvider=r,this.appCheckServiceProvider=n,this.config=a,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new X2(this),this.idTokenSubscription=new X2(this),this.beforeStateQueue=new S3(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=Gb,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=a.sdkClientVersion}_initializeWithPersistence(e,r){return r&&(this._popupRedirectResolver=fi(r)),this._initializationPromise=this.queue(async()=>{var n,a;if(!this._deleted&&(this.persistenceManager=await Ac.create(this,e),!this._deleted)){if(!((n=this._popupRedirectResolver)===null||n===void 0)&&n._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(r),this.lastNotifiedUid=((a=this.currentUser)===null||a===void 0?void 0:a.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const r=await Yb(this,{idToken:e}),n=await ui._fromGetAccountInfoResponse(this,r,e);await this.directlySetCurrentUser(n)}catch(r){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",r),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var r;if(oi(this.app)){const o=this.app.settings.authIdToken;return o?new Promise(u=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(o).then(u,u))}):this.directlySetCurrentUser(null)}const n=await this.assertedPersistence.getCurrentUser();let a=n,l=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const o=(r=this.redirectUser)===null||r===void 0?void 0:r._redirectEventId,u=a?._redirectEventId,h=await this.tryRedirectSignIn(e);(!o||o===u)&&h?.user&&(a=h.user,l=!0)}if(!a)return this.directlySetCurrentUser(null);if(!a._redirectEventId){if(l)try{await this.beforeStateQueue.runMiddleware(a)}catch(o){a=n,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(o))}return a?this.reloadAndSetCurrentUserOrClear(a):this.directlySetCurrentUser(null)}return ot(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===a._redirectEventId?this.directlySetCurrentUser(a):this.reloadAndSetCurrentUserOrClear(a)}async tryRedirectSignIn(e){let r=null;try{r=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return r}async reloadAndSetCurrentUserOrClear(e){try{await T0(e)}catch(r){if(r?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=f3()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(oi(this.app))return Promise.reject(co(this));const r=e?vr(e):null;return r&&ot(r.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(r&&r._clone(this))}async _updateCurrentUser(e,r=!1){if(!this._deleted)return e&&ot(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),r||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return oi(this.app)?Promise.reject(co(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return oi(this.app)?Promise.reject(co(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(fi(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const r=this._getPasswordPolicyInternal();return r.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):r.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await A3(this),r=new C3(e);this.tenantId===null?this._projectPasswordPolicy=r:this._tenantPasswordPolicies[this.tenantId]=r}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(e){this._errorFactory=new $f("auth","Firebase",e())}onAuthStateChanged(e,r,n){return this.registerStateListener(this.authStateSubscription,e,r,n)}beforeAuthStateChanged(e,r){return this.beforeStateQueue.pushCallback(e,r)}onIdTokenChanged(e,r,n){return this.registerStateListener(this.idTokenSubscription,e,r,n)}authStateReady(){return new Promise((e,r)=>{if(this.currentUser)e();else{const n=this.onAuthStateChanged(()=>{n(),e()},r)}})}async revokeAccessToken(e){if(this.currentUser){const r=await this.currentUser.getIdToken(),n={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:r};this.tenantId!=null&&(n.tenantId=this.tenantId),await T3(this,n)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}async _setRedirectUser(e,r){const n=await this.getOrInitRedirectPersistenceManager(r);return e===null?n.removeCurrentUser():n.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const r=e&&fi(e)||this._popupRedirectResolver;ot(r,this,"argument-error"),this.redirectPersistenceManager=await Ac.create(this,[fi(r._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var r,n;return this._isInitialized&&await this.queue(async()=>{}),((r=this._currentUser)===null||r===void 0?void 0:r._redirectEventId)===e?this._currentUser:((n=this.redirectUser)===null||n===void 0?void 0:n._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,r;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const n=(r=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&r!==void 0?r:null;this.lastNotifiedUid!==n&&(this.lastNotifiedUid=n,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,r,n,a){if(this._deleted)return()=>{};const l=typeof r=="function"?r:r.next.bind(r);let o=!1;const u=this._isInitialized?Promise.resolve():this._initializationPromise;if(ot(u,this,"internal-error"),u.then(()=>{o||l(this.currentUser)}),typeof r=="function"){const h=e.addObserver(r,n,a);return()=>{o=!0,h()}}else{const h=e.addObserver(r);return()=>{o=!0,h()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return ot(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=iS(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const r={"X-Client-Version":this.clientVersion};this.app.options.appId&&(r["X-Firebase-gmpid"]=this.app.options.appId);const n=await((e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader());n&&(r["X-Firebase-Client"]=n);const a=await this._getAppCheckToken();return a&&(r["X-Firebase-AppCheck"]=a),r}async _getAppCheckToken(){var e;const r=await((e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken());return r?.error&&l3(`Error while retrieving App Check token: ${r.error}`),r?.token}}function J0(t){return vr(t)}class X2{constructor(e){this.auth=e,this.observer=null,this.addObserver=XD(r=>this.observer=r)}get next(){return ot(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}let dv={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function R3(t){dv=t}function D3(t){return dv.loadJS(t)}function I3(){return dv.gapiScript}function O3(t){return`__${t}${Math.floor(Math.random()*1e6)}`}function M3(t,e){const r=Qf(t,"auth");if(r.isInitialized()){const a=r.getImmediate(),l=r.getOptions();if(y0(l,e??{}))return a;Fs(a,"already-initialized")}return r.initialize({options:e})}function j3(t,e){const r=e?.persistence||[],n=(Array.isArray(r)?r:[r]).map(fi);e?.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(n,e?.popupRedirectResolver)}function F3(t,e,r){const n=J0(t);ot(n._canInitEmulator,n,"emulator-config-failed"),ot(/^https?:\/\//.test(e),n,"invalid-emulator-scheme");const a=!1,l=lS(e),{host:o,port:u}=P3(e),h=u===null?"":`:${u}`;n.config.emulator={url:`${l}//${o}${h}/`},n.settings.appVerificationDisabledForTesting=!0,n.emulatorConfig=Object.freeze({host:o,port:u,protocol:l.replace(":",""),options:Object.freeze({disableWarnings:a})}),L3()}function lS(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function P3(t){const e=lS(t),r=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!r)return{host:"",port:null};const n=r[2].split("@").pop()||"",a=/^(\[[^\]]+\])(:|$)/.exec(n);if(a){const l=a[1];return{host:l,port:Q2(n.substr(l.length+1))}}else{const[l,o]=n.split(":");return{host:l,port:Q2(o)}}}function Q2(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}function L3(){function t(){const e=document.createElement("p"),r=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",r.position="fixed",r.width="100%",r.backgroundColor="#ffffff",r.border=".1em solid #000000",r.color="#b50000",r.bottom="0px",r.left="0px",r.margin="0px",r.zIndex="10000",r.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",t):t())}class oS{constructor(e,r){this.providerId=e,this.signInMethod=r}toJSON(){return ci("not implemented")}_getIdTokenResponse(e){return ci("not implemented")}_linkToIdToken(e,r){return ci("not implemented")}_getReauthenticationResolver(e){return ci("not implemented")}}async function Nc(t,e){return m3(t,"POST","/v1/accounts:signInWithIdp",uv(t,e))}const U3="http://localhost";class xo extends oS{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const r=new xo(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(r.idToken=e.idToken),e.accessToken&&(r.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(r.nonce=e.nonce),e.pendingToken&&(r.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(r.accessToken=e.oauthToken,r.secret=e.oauthTokenSecret):Fs("argument-error"),r}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const r=typeof e=="string"?JSON.parse(e):e,{providerId:n,signInMethod:a}=r,l=iv(r,["providerId","signInMethod"]);if(!n||!a)return null;const o=new xo(n,a);return o.idToken=l.idToken||void 0,o.accessToken=l.accessToken||void 0,o.secret=l.secret,o.nonce=l.nonce,o.pendingToken=l.pendingToken||null,o}_getIdTokenResponse(e){const r=this.buildRequest();return Nc(e,r)}_linkToIdToken(e,r){const n=this.buildRequest();return n.idToken=r,Nc(e,n)}_getReauthenticationResolver(e){const r=this.buildRequest();return r.autoCreate=!1,Nc(e,r)}buildRequest(){const e={requestUri:U3,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const r={};this.idToken&&(r.id_token=this.idToken),this.accessToken&&(r.access_token=this.accessToken),this.secret&&(r.oauth_token_secret=this.secret),r.providerId=this.providerId,this.nonce&&!this.pendingToken&&(r.nonce=this.nonce),e.postBody=Xf(r)}return e}}class mv{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}class Zf extends mv{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}class cl extends Zf{constructor(){super("facebook.com")}static credential(e){return xo._fromParams({providerId:cl.PROVIDER_ID,signInMethod:cl.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return cl.credentialFromTaggedObject(e)}static credentialFromError(e){return cl.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return cl.credential(e.oauthAccessToken)}catch{return null}}}cl.FACEBOOK_SIGN_IN_METHOD="facebook.com";cl.PROVIDER_ID="facebook.com";class Rs extends Zf{constructor(){super("google.com"),this.addScope("profile")}static credential(e,r){return xo._fromParams({providerId:Rs.PROVIDER_ID,signInMethod:Rs.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:r})}static credentialFromResult(e){return Rs.credentialFromTaggedObject(e)}static credentialFromError(e){return Rs.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:r,oauthAccessToken:n}=e;if(!r&&!n)return null;try{return Rs.credential(r,n)}catch{return null}}}Rs.GOOGLE_SIGN_IN_METHOD="google.com";Rs.PROVIDER_ID="google.com";class ul extends Zf{constructor(){super("github.com")}static credential(e){return xo._fromParams({providerId:ul.PROVIDER_ID,signInMethod:ul.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return ul.credentialFromTaggedObject(e)}static credentialFromError(e){return ul.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return ul.credential(e.oauthAccessToken)}catch{return null}}}ul.GITHUB_SIGN_IN_METHOD="github.com";ul.PROVIDER_ID="github.com";class fl extends Zf{constructor(){super("twitter.com")}static credential(e,r){return xo._fromParams({providerId:fl.PROVIDER_ID,signInMethod:fl.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:r})}static credentialFromResult(e){return fl.credentialFromTaggedObject(e)}static credentialFromError(e){return fl.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:r,oauthTokenSecret:n}=e;if(!r||!n)return null;try{return fl.credential(r,n)}catch{return null}}}fl.TWITTER_SIGN_IN_METHOD="twitter.com";fl.PROVIDER_ID="twitter.com";class Fc{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,r,n,a=!1){const l=await ui._fromIdTokenResponse(e,n,a),o=J2(n);return new Fc({user:l,providerId:o,_tokenResponse:n,operationType:r})}static async _forOperation(e,r,n){await e._updateTokensIfNecessary(n,!0);const a=J2(n);return new Fc({user:e,providerId:a,_tokenResponse:n,operationType:r})}}function J2(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}class E0 extends _s{constructor(e,r,n,a){var l;super(r.code,r.message),this.operationType=n,this.user=a,Object.setPrototypeOf(this,E0.prototype),this.customData={appName:e.name,tenantId:(l=e.tenantId)!==null&&l!==void 0?l:void 0,_serverResponse:r.customData._serverResponse,operationType:n}}static _fromErrorAndOperation(e,r,n,a){return new E0(e,r,n,a)}}function cS(t,e,r,n){return(e==="reauthenticate"?r._getReauthenticationResolver(t):r._getIdTokenResponse(t)).catch(l=>{throw l.code==="auth/multi-factor-auth-required"?E0._fromErrorAndOperation(t,l,e,n):l})}async function B3(t,e,r=!1){const n=await kf(t,e._linkToIdToken(t.auth,await t.getIdToken()),r);return Fc._forOperation(t,"link",n)}async function V3(t,e,r=!1){const{auth:n}=t;if(oi(n.app))return Promise.reject(co(n));const a="reauthenticate";try{const l=await kf(t,cS(n,a,e,t),r);ot(l.idToken,n,"internal-error");const o=fv(l.idToken);ot(o,n,"internal-error");const{sub:u}=o;return ot(t.uid===u,n,"user-mismatch"),Fc._forOperation(t,a,l)}catch(l){throw l?.code==="auth/user-not-found"&&Fs(n,"user-mismatch"),l}}async function z3(t,e,r=!1){if(oi(t.app))return Promise.reject(co(t));const n="signIn",a=await cS(t,n,e),l=await Fc._fromIdTokenResponse(t,n,a);return r||await t._updateCurrentUser(l.user),l}function H3(t,e,r,n){return vr(t).onIdTokenChanged(e,r,n)}function G3(t,e,r){return vr(t).beforeAuthStateChanged(e,r)}function uS(t,e,r,n){return vr(t).onAuthStateChanged(e,r,n)}function q3(t){return vr(t).signOut()}const b0="__sak";class fS{constructor(e,r){this.storageRetriever=e,this.type=r}_isAvailable(){try{return this.storage?(this.storage.setItem(b0,"1"),this.storage.removeItem(b0),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,r){return this.storage.setItem(e,JSON.stringify(r)),Promise.resolve()}_get(e){const r=this.storage.getItem(e);return Promise.resolve(r?JSON.parse(r):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}const W3=1e3,K3=10;class hS extends fS{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,r)=>this.onStorageEvent(e,r),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=sS(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const r of Object.keys(this.listeners)){const n=this.storage.getItem(r),a=this.localCache[r];n!==a&&e(r,a,n)}}onStorageEvent(e,r=!1){if(!e.key){this.forAllChangedKeys((o,u,h)=>{this.notifyListeners(o,h)});return}const n=e.key;r?this.detachListener():this.stopPolling();const a=()=>{const o=this.storage.getItem(n);!r&&this.localCache[n]===o||this.notifyListeners(n,o)},l=this.storage.getItem(n);b3()&&l!==e.newValue&&e.newValue!==e.oldValue?setTimeout(a,K3):a()}notifyListeners(e,r){this.localCache[e]=r;const n=this.listeners[e];if(n)for(const a of Array.from(n))a(r&&JSON.parse(r))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,r,n)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:r,newValue:n}),!0)})},W3)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,r){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(r)}_removeListener(e,r){this.listeners[e]&&(this.listeners[e].delete(r),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,r){await super._set(e,r),this.localCache[e]=JSON.stringify(r)}async _get(e){const r=await super._get(e);return this.localCache[e]=JSON.stringify(r),r}async _remove(e){await super._remove(e),delete this.localCache[e]}}hS.type="LOCAL";const Y3=hS;class dS extends fS{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,r){}_removeListener(e,r){}}dS.type="SESSION";const mS=dS;function $3(t){return Promise.all(t.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(r){return{fulfilled:!1,reason:r}}}))}class Z0{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const r=this.receivers.find(a=>a.isListeningto(e));if(r)return r;const n=new Z0(e);return this.receivers.push(n),n}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const r=e,{eventId:n,eventType:a,data:l}=r.data,o=this.handlersMap[a];if(!o?.size)return;r.ports[0].postMessage({status:"ack",eventId:n,eventType:a});const u=Array.from(o).map(async m=>m(r.origin,l)),h=await $3(u);r.ports[0].postMessage({status:"done",eventId:n,eventType:a,response:h})}_subscribe(e,r){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(r)}_unsubscribe(e,r){this.handlersMap[e]&&r&&this.handlersMap[e].delete(r),(!r||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}Z0.receivers=[];function pv(t="",e=10){let r="";for(let n=0;n<e;n++)r+=Math.floor(Math.random()*10);return t+r}class X3{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,r,n=50){const a=typeof MessageChannel<"u"?new MessageChannel:null;if(!a)throw new Error("connection_unavailable");let l,o;return new Promise((u,h)=>{const m=pv("",20);a.port1.start();const p=setTimeout(()=>{h(new Error("unsupported_event"))},n);o={messageChannel:a,onMessage(v){const _=v;if(_.data.eventId===m)switch(_.data.status){case"ack":clearTimeout(p),l=setTimeout(()=>{h(new Error("timeout"))},3e3);break;case"done":clearTimeout(l),u(_.data.response);break;default:clearTimeout(p),clearTimeout(l),h(new Error("invalid_response"));break}}},this.handlers.add(o),a.port1.addEventListener("message",o.onMessage),this.target.postMessage({eventType:e,eventId:m,data:r},[a.port2])}).finally(()=>{o&&this.removeMessageHandler(o)})}}function Os(){return window}function Q3(t){Os().location.href=t}function pS(){return typeof Os().WorkerGlobalScope<"u"&&typeof Os().importScripts=="function"}async function J3(){if(!navigator?.serviceWorker)return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function Z3(){var t;return((t=navigator?.serviceWorker)===null||t===void 0?void 0:t.controller)||null}function eO(){return pS()?self:null}const gS="firebaseLocalStorageDb",tO=1,S0="firebaseLocalStorage",xS="fbase_key";class eh{constructor(e){this.request=e}toPromise(){return new Promise((e,r)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{r(this.request.error)})})}}function em(t,e){return t.transaction([S0],e?"readwrite":"readonly").objectStore(S0)}function rO(){const t=indexedDB.deleteDatabase(gS);return new eh(t).toPromise()}function gx(){const t=indexedDB.open(gS,tO);return new Promise((e,r)=>{t.addEventListener("error",()=>{r(t.error)}),t.addEventListener("upgradeneeded",()=>{const n=t.result;try{n.createObjectStore(S0,{keyPath:xS})}catch(a){r(a)}}),t.addEventListener("success",async()=>{const n=t.result;n.objectStoreNames.contains(S0)?e(n):(n.close(),await rO(),e(await gx()))})})}async function Z2(t,e,r){const n=em(t,!0).put({[xS]:e,value:r});return new eh(n).toPromise()}async function nO(t,e){const r=em(t,!1).get(e),n=await new eh(r).toPromise();return n===void 0?null:n.value}function eT(t,e){const r=em(t,!0).delete(e);return new eh(r).toPromise()}const aO=800,sO=3;class vS{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await gx(),this.db)}async _withRetries(e){let r=0;for(;;)try{const n=await this._openDb();return await e(n)}catch(n){if(r++>sO)throw n;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return pS()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=Z0._getInstance(eO()),this.receiver._subscribe("keyChanged",async(e,r)=>({keyProcessed:(await this._poll()).includes(r.key)})),this.receiver._subscribe("ping",async(e,r)=>["keyChanged"])}async initializeSender(){var e,r;if(this.activeServiceWorker=await J3(),!this.activeServiceWorker)return;this.sender=new X3(this.activeServiceWorker);const n=await this.sender._send("ping",{},800);n&&!((e=n[0])===null||e===void 0)&&e.fulfilled&&!((r=n[0])===null||r===void 0)&&r.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||Z3()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await gx();return await Z2(e,b0,"1"),await eT(e,b0),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,r){return this._withPendingWrite(async()=>(await this._withRetries(n=>Z2(n,e,r)),this.localCache[e]=r,this.notifyServiceWorker(e)))}async _get(e){const r=await this._withRetries(n=>nO(n,e));return this.localCache[e]=r,r}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(r=>eT(r,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(a=>{const l=em(a,!1).getAll();return new eh(l).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const r=[],n=new Set;if(e.length!==0)for(const{fbase_key:a,value:l}of e)n.add(a),JSON.stringify(this.localCache[a])!==JSON.stringify(l)&&(this.notifyListeners(a,l),r.push(a));for(const a of Object.keys(this.localCache))this.localCache[a]&&!n.has(a)&&(this.notifyListeners(a,null),r.push(a));return r}notifyListeners(e,r){this.localCache[e]=r;const n=this.listeners[e];if(n)for(const a of Array.from(n))a(r)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),aO)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,r){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(r)}_removeListener(e,r){this.listeners[e]&&(this.listeners[e].delete(r),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}vS.type="LOCAL";const iO=vS;new Jf(3e4,6e4);function yS(t,e){return e?fi(e):(ot(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}class gv extends oS{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Nc(e,this._buildIdpRequest())}_linkToIdToken(e,r){return Nc(e,this._buildIdpRequest(r))}_getReauthenticationResolver(e){return Nc(e,this._buildIdpRequest())}_buildIdpRequest(e){const r={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(r.idToken=e),r}}function lO(t){return z3(t.auth,new gv(t),t.bypassAuthState)}function oO(t){const{auth:e,user:r}=t;return ot(r,e,"internal-error"),V3(r,new gv(t),t.bypassAuthState)}async function cO(t){const{auth:e,user:r}=t;return ot(r,e,"internal-error"),B3(r,new gv(t),t.bypassAuthState)}class _S{constructor(e,r,n,a,l=!1){this.auth=e,this.resolver=n,this.user=a,this.bypassAuthState=l,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(r)?r:[r]}execute(){return new Promise(async(e,r)=>{this.pendingPromise={resolve:e,reject:r};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(n){this.reject(n)}})}async onAuthEvent(e){const{urlResponse:r,sessionId:n,postBody:a,tenantId:l,error:o,type:u}=e;if(o){this.reject(o);return}const h={auth:this.auth,requestUri:r,sessionId:n,tenantId:l||void 0,postBody:a||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(u)(h))}catch(m){this.reject(m)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return lO;case"linkViaPopup":case"linkViaRedirect":return cO;case"reauthViaPopup":case"reauthViaRedirect":return oO;default:Fs(this.auth,"internal-error")}}resolve(e){_i(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){_i(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const uO=new Jf(2e3,1e4);async function wS(t,e,r){if(oi(t.app))return Promise.reject(ps(t,"operation-not-supported-in-this-environment"));const n=J0(t);o3(t,e,mv);const a=yS(n,r);return new io(n,"signInViaPopup",e,a).executeNotNull()}class io extends _S{constructor(e,r,n,a,l){super(e,r,a,l),this.provider=n,this.authWindow=null,this.pollId=null,io.currentPopupAction&&io.currentPopupAction.cancel(),io.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return ot(e,this.auth,"internal-error"),e}async onExecution(){_i(this.filter.length===1,"Popup operations only handle one event");const e=pv();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(r=>{this.reject(r)}),this.resolver._isIframeWebStorageSupported(this.auth,r=>{r||this.reject(ps(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)===null||e===void 0?void 0:e.associatedEvent)||null}cancel(){this.reject(ps(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,io.currentPopupAction=null}pollUserCancellation(){const e=()=>{var r,n;if(!((n=(r=this.authWindow)===null||r===void 0?void 0:r.window)===null||n===void 0)&&n.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(ps(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,uO.get())};e()}}io.currentPopupAction=null;const fO="pendingRedirect",s0=new Map;class hO extends _S{constructor(e,r,n=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],r,void 0,n),this.eventId=null}async execute(){let e=s0.get(this.auth._key());if(!e){try{const n=await dO(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(n)}catch(r){e=()=>Promise.reject(r)}s0.set(this.auth._key(),e)}return this.bypassAuthState||s0.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const r=await this.auth._redirectUserForId(e.eventId);if(r)return this.user=r,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function dO(t,e){const r=gO(e),n=pO(t);if(!await n._isAvailable())return!1;const a=await n._get(r)==="true";return await n._remove(r),a}function mO(t,e){s0.set(t._key(),e)}function pO(t){return fi(t._redirectPersistence)}function gO(t){return a0(fO,t.config.apiKey,t.name)}async function xO(t,e,r=!1){if(oi(t.app))return Promise.reject(co(t));const n=J0(t),a=yS(n,e),o=await new hO(n,a,r).execute();return o&&!r&&(delete o.user._redirectEventId,await n._persistUserIfCurrent(o.user),await n._setRedirectUser(null,e)),o}const vO=600*1e3;class yO{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let r=!1;return this.consumers.forEach(n=>{this.isEventForConsumer(e,n)&&(r=!0,this.sendToConsumer(e,n),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!_O(e)||(this.hasHandledPotentialRedirect=!0,r||(this.queuedRedirectEvent=e,r=!0)),r}sendToConsumer(e,r){var n;if(e.error&&!TS(e)){const a=((n=e.error.code)===null||n===void 0?void 0:n.split("auth/")[1])||"internal-error";r.onError(ps(this.auth,a))}else r.onAuthEvent(e)}isEventForConsumer(e,r){const n=r.eventId===null||!!e.eventId&&e.eventId===r.eventId;return r.filter.includes(e.type)&&n}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=vO&&this.cachedEventUids.clear(),this.cachedEventUids.has(tT(e))}saveEventToCache(e){this.cachedEventUids.add(tT(e)),this.lastProcessedEventTime=Date.now()}}function tT(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function TS({type:t,error:e}){return t==="unknown"&&e?.code==="auth/no-auth-event"}function _O(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return TS(t);default:return!1}}async function wO(t,e={}){return Kc(t,"GET","/v1/projects",e)}const TO=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,EO=/^https?/;async function bO(t){if(t.config.emulator)return;const{authorizedDomains:e}=await wO(t);for(const r of e)try{if(SO(r))return}catch{}Fs(t,"unauthorized-domain")}function SO(t){const e=mx(),{protocol:r,hostname:n}=new URL(e);if(t.startsWith("chrome-extension://")){const o=new URL(t);return o.hostname===""&&n===""?r==="chrome-extension:"&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):r==="chrome-extension:"&&o.hostname===n}if(!EO.test(r))return!1;if(TO.test(t))return n===t;const a=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+a+"|"+a+")$","i").test(n)}const AO=new Jf(3e4,6e4);function rT(){const t=Os().___jsl;if(t?.H){for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let r=0;r<t.CP.length;r++)t.CP[r]=null}}function NO(t){return new Promise((e,r)=>{var n,a,l;function o(){rT(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{rT(),r(ps(t,"network-request-failed"))},timeout:AO.get()})}if(!((a=(n=Os().gapi)===null||n===void 0?void 0:n.iframes)===null||a===void 0)&&a.Iframe)e(gapi.iframes.getContext());else if(!((l=Os().gapi)===null||l===void 0)&&l.load)o();else{const u=O3("iframefcb");return Os()[u]=()=>{gapi.load?o():r(ps(t,"network-request-failed"))},D3(`${I3()}?onload=${u}`).catch(h=>r(h))}}).catch(e=>{throw i0=null,e})}let i0=null;function CO(t){return i0=i0||NO(t),i0}const kO=new Jf(5e3,15e3),RO="__/auth/iframe",DO="emulator/auth/iframe",IO={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},OO=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function MO(t){const e=t.config;ot(e.authDomain,t,"auth-domain-config-required");const r=e.emulator?cv(e,DO):`https://${t.config.authDomain}/${RO}`,n={apiKey:e.apiKey,appName:t.name,v:So},a=OO.get(t.config.apiHost);a&&(n.eid=a);const l=t._getFrameworks();return l.length&&(n.fw=l.join(",")),`${r}?${Xf(n).slice(1)}`}async function jO(t){const e=await CO(t),r=Os().gapi;return ot(r,t,"internal-error"),e.open({where:document.body,url:MO(t),messageHandlersFilter:r.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:IO,dontclear:!0},n=>new Promise(async(a,l)=>{await n.restyle({setHideOnLeave:!1});const o=ps(t,"network-request-failed"),u=Os().setTimeout(()=>{l(o)},kO.get());function h(){Os().clearTimeout(u),a(n)}n.ping(h).then(h,()=>{l(o)})}))}const FO={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},PO=500,LO=600,UO="_blank",BO="http://localhost";class nT{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function VO(t,e,r,n=PO,a=LO){const l=Math.max((window.screen.availHeight-a)/2,0).toString(),o=Math.max((window.screen.availWidth-n)/2,0).toString();let u="";const h=Object.assign(Object.assign({},FO),{width:n.toString(),height:a.toString(),top:l,left:o}),m=Bn().toLowerCase();r&&(u=eS(m)?UO:r),Jb(m)&&(e=e||BO,h.scrollbars="yes");const p=Object.entries(h).reduce((_,[w,E])=>`${_}${w}=${E},`,"");if(E3(m)&&u!=="_self")return zO(e||"",u),new nT(null);const v=window.open(e||"",u,p);ot(v,t,"popup-blocked");try{v.focus()}catch{}return new nT(v)}function zO(t,e){const r=document.createElement("a");r.href=t,r.target=e;const n=document.createEvent("MouseEvent");n.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),r.dispatchEvent(n)}const HO="__/auth/handler",GO="emulator/auth/handler",qO=encodeURIComponent("fac");async function aT(t,e,r,n,a,l){ot(t.config.authDomain,t,"auth-domain-config-required"),ot(t.config.apiKey,t,"invalid-api-key");const o={apiKey:t.config.apiKey,appName:t.name,authType:r,redirectUrl:n,v:So,eventId:a};if(e instanceof mv){e.setDefaultLanguage(t.languageCode),o.providerId=e.providerId||"",$D(e.getCustomParameters())||(o.customParameters=JSON.stringify(e.getCustomParameters()));for(const[p,v]of Object.entries({}))o[p]=v}if(e instanceof Zf){const p=e.getScopes().filter(v=>v!=="");p.length>0&&(o.scopes=p.join(","))}t.tenantId&&(o.tid=t.tenantId);const u=o;for(const p of Object.keys(u))u[p]===void 0&&delete u[p];const h=await t._getAppCheckToken(),m=h?`#${qO}=${encodeURIComponent(h)}`:"";return`${WO(t)}?${Xf(u).slice(1)}${m}`}function WO({config:t}){return t.emulator?cv(t,GO):`https://${t.authDomain}/${HO}`}const Bg="webStorageSupport";class KO{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=mS,this._completeRedirectFn=xO,this._overrideRedirectResult=mO}async _openPopup(e,r,n,a){var l;_i((l=this.eventManagers[e._key()])===null||l===void 0?void 0:l.manager,"_initialize() not called before _openPopup()");const o=await aT(e,r,n,mx(),a);return VO(e,o,pv())}async _openRedirect(e,r,n,a){await this._originValidation(e);const l=await aT(e,r,n,mx(),a);return Q3(l),new Promise(()=>{})}_initialize(e){const r=e._key();if(this.eventManagers[r]){const{manager:a,promise:l}=this.eventManagers[r];return a?Promise.resolve(a):(_i(l,"If manager is not set, promise should be"),l)}const n=this.initAndGetManager(e);return this.eventManagers[r]={promise:n},n.catch(()=>{delete this.eventManagers[r]}),n}async initAndGetManager(e){const r=await jO(e),n=new yO(e);return r.register("authEvent",a=>(ot(a?.authEvent,e,"invalid-auth-event"),{status:n.onEvent(a.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:n},this.iframes[e._key()]=r,n}_isIframeWebStorageSupported(e,r){this.iframes[e._key()].send(Bg,{type:Bg},a=>{var l;const o=(l=a?.[0])===null||l===void 0?void 0:l[Bg];o!==void 0&&r(!!o),Fs(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const r=e._key();return this.originValidationPromises[r]||(this.originValidationPromises[r]=bO(e)),this.originValidationPromises[r]}get _shouldInitProactively(){return sS()||Zb()||hv()}}const YO=KO;var sT="@firebase/auth",iT="1.7.9";class $O{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const r=this.auth.onIdTokenChanged(n=>{e(n?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,r),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const r=this.internalListeners.get(e);r&&(this.internalListeners.delete(e),r(),this.updateProactiveRefresh())}assertAuthConfigured(){ot(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}function XO(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function QO(t){Tl(new vi("auth",(e,{options:r})=>{const n=e.getProvider("app").getImmediate(),a=e.getProvider("heartbeat"),l=e.getProvider("app-check-internal"),{apiKey:o,authDomain:u}=n.options;ot(o&&!o.includes(":"),"invalid-api-key",{appName:n.name});const h={apiKey:o,authDomain:u,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:iS(t)},m=new k3(n,a,l,h);return j3(m,r),m},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,r,n)=>{e.getProvider("auth-internal").initialize()})),Tl(new vi("auth-internal",e=>{const r=J0(e.getProvider("auth").getImmediate());return(n=>new $O(n))(r)},"PRIVATE").setInstantiationMode("EXPLICIT")),Ja(sT,iT,XO(t)),Ja(sT,iT,"esm2017")}const JO=300,ZO=Fb("authIdTokenMaxAge")||JO;let lT=null;const eM=t=>async e=>{const r=e&&await e.getIdTokenResult(),n=r&&(new Date().getTime()-Date.parse(r.issuedAtTime))/1e3;if(n&&n>ZO)return;const a=r?.token;lT!==a&&(lT=a,await fetch(t,{method:a?"POST":"DELETE",headers:a?{Authorization:`Bearer ${a}`}:{}}))};function tM(t=Q0()){const e=Qf(t,"auth");if(e.isInitialized())return e.getImmediate();const r=M3(t,{popupRedirectResolver:YO,persistence:[iO,Y3,mS]}),n=Fb("authTokenSyncURL");if(n&&typeof isSecureContext=="boolean"&&isSecureContext){const l=new URL(n,location.origin);if(location.origin===l.origin){const o=eM(l.toString());G3(r,o,()=>o(r.currentUser)),H3(r,u=>o(u))}}const a=Mb("auth");return a&&F3(r,`http://${a}`),r}function rM(){var t,e;return(e=(t=document.getElementsByTagName("head"))===null||t===void 0?void 0:t[0])!==null&&e!==void 0?e:document}R3({loadJS(t){return new Promise((e,r)=>{const n=document.createElement("script");n.setAttribute("src",t),n.onload=e,n.onerror=a=>{const l=ps("internal-error");l.customData=a,r(l)},n.type="text/javascript",n.charset="UTF-8",rM().appendChild(n)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});QO("Browser");var oT=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var uo,ES;(function(){var t;function e(b,N){function k(){}k.prototype=N.prototype,b.D=N.prototype,b.prototype=new k,b.prototype.constructor=b,b.C=function(j,L,P){for(var U=Array(arguments.length-2),Ce=2;Ce<arguments.length;Ce++)U[Ce-2]=arguments[Ce];return N.prototype[L].apply(j,U)}}function r(){this.blockSize=-1}function n(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(n,r),n.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function a(b,N,k){k||(k=0);var j=Array(16);if(typeof N=="string")for(var L=0;16>L;++L)j[L]=N.charCodeAt(k++)|N.charCodeAt(k++)<<8|N.charCodeAt(k++)<<16|N.charCodeAt(k++)<<24;else for(L=0;16>L;++L)j[L]=N[k++]|N[k++]<<8|N[k++]<<16|N[k++]<<24;N=b.g[0],k=b.g[1],L=b.g[2];var P=b.g[3],U=N+(P^k&(L^P))+j[0]+3614090360&4294967295;N=k+(U<<7&4294967295|U>>>25),U=P+(L^N&(k^L))+j[1]+3905402710&4294967295,P=N+(U<<12&4294967295|U>>>20),U=L+(k^P&(N^k))+j[2]+606105819&4294967295,L=P+(U<<17&4294967295|U>>>15),U=k+(N^L&(P^N))+j[3]+3250441966&4294967295,k=L+(U<<22&4294967295|U>>>10),U=N+(P^k&(L^P))+j[4]+4118548399&4294967295,N=k+(U<<7&4294967295|U>>>25),U=P+(L^N&(k^L))+j[5]+1200080426&4294967295,P=N+(U<<12&4294967295|U>>>20),U=L+(k^P&(N^k))+j[6]+2821735955&4294967295,L=P+(U<<17&4294967295|U>>>15),U=k+(N^L&(P^N))+j[7]+4249261313&4294967295,k=L+(U<<22&4294967295|U>>>10),U=N+(P^k&(L^P))+j[8]+1770035416&4294967295,N=k+(U<<7&4294967295|U>>>25),U=P+(L^N&(k^L))+j[9]+2336552879&4294967295,P=N+(U<<12&4294967295|U>>>20),U=L+(k^P&(N^k))+j[10]+4294925233&4294967295,L=P+(U<<17&4294967295|U>>>15),U=k+(N^L&(P^N))+j[11]+2304563134&4294967295,k=L+(U<<22&4294967295|U>>>10),U=N+(P^k&(L^P))+j[12]+1804603682&4294967295,N=k+(U<<7&4294967295|U>>>25),U=P+(L^N&(k^L))+j[13]+4254626195&4294967295,P=N+(U<<12&4294967295|U>>>20),U=L+(k^P&(N^k))+j[14]+2792965006&4294967295,L=P+(U<<17&4294967295|U>>>15),U=k+(N^L&(P^N))+j[15]+1236535329&4294967295,k=L+(U<<22&4294967295|U>>>10),U=N+(L^P&(k^L))+j[1]+4129170786&4294967295,N=k+(U<<5&4294967295|U>>>27),U=P+(k^L&(N^k))+j[6]+3225465664&4294967295,P=N+(U<<9&4294967295|U>>>23),U=L+(N^k&(P^N))+j[11]+643717713&4294967295,L=P+(U<<14&4294967295|U>>>18),U=k+(P^N&(L^P))+j[0]+3921069994&4294967295,k=L+(U<<20&4294967295|U>>>12),U=N+(L^P&(k^L))+j[5]+3593408605&4294967295,N=k+(U<<5&4294967295|U>>>27),U=P+(k^L&(N^k))+j[10]+38016083&4294967295,P=N+(U<<9&4294967295|U>>>23),U=L+(N^k&(P^N))+j[15]+3634488961&4294967295,L=P+(U<<14&4294967295|U>>>18),U=k+(P^N&(L^P))+j[4]+3889429448&4294967295,k=L+(U<<20&4294967295|U>>>12),U=N+(L^P&(k^L))+j[9]+568446438&4294967295,N=k+(U<<5&4294967295|U>>>27),U=P+(k^L&(N^k))+j[14]+3275163606&4294967295,P=N+(U<<9&4294967295|U>>>23),U=L+(N^k&(P^N))+j[3]+4107603335&4294967295,L=P+(U<<14&4294967295|U>>>18),U=k+(P^N&(L^P))+j[8]+1163531501&4294967295,k=L+(U<<20&4294967295|U>>>12),U=N+(L^P&(k^L))+j[13]+2850285829&4294967295,N=k+(U<<5&4294967295|U>>>27),U=P+(k^L&(N^k))+j[2]+4243563512&4294967295,P=N+(U<<9&4294967295|U>>>23),U=L+(N^k&(P^N))+j[7]+1735328473&4294967295,L=P+(U<<14&4294967295|U>>>18),U=k+(P^N&(L^P))+j[12]+2368359562&4294967295,k=L+(U<<20&4294967295|U>>>12),U=N+(k^L^P)+j[5]+4294588738&4294967295,N=k+(U<<4&4294967295|U>>>28),U=P+(N^k^L)+j[8]+2272392833&4294967295,P=N+(U<<11&4294967295|U>>>21),U=L+(P^N^k)+j[11]+1839030562&4294967295,L=P+(U<<16&4294967295|U>>>16),U=k+(L^P^N)+j[14]+4259657740&4294967295,k=L+(U<<23&4294967295|U>>>9),U=N+(k^L^P)+j[1]+2763975236&4294967295,N=k+(U<<4&4294967295|U>>>28),U=P+(N^k^L)+j[4]+1272893353&4294967295,P=N+(U<<11&4294967295|U>>>21),U=L+(P^N^k)+j[7]+4139469664&4294967295,L=P+(U<<16&4294967295|U>>>16),U=k+(L^P^N)+j[10]+3200236656&4294967295,k=L+(U<<23&4294967295|U>>>9),U=N+(k^L^P)+j[13]+681279174&4294967295,N=k+(U<<4&4294967295|U>>>28),U=P+(N^k^L)+j[0]+3936430074&4294967295,P=N+(U<<11&4294967295|U>>>21),U=L+(P^N^k)+j[3]+3572445317&4294967295,L=P+(U<<16&4294967295|U>>>16),U=k+(L^P^N)+j[6]+76029189&4294967295,k=L+(U<<23&4294967295|U>>>9),U=N+(k^L^P)+j[9]+3654602809&4294967295,N=k+(U<<4&4294967295|U>>>28),U=P+(N^k^L)+j[12]+3873151461&4294967295,P=N+(U<<11&4294967295|U>>>21),U=L+(P^N^k)+j[15]+530742520&4294967295,L=P+(U<<16&4294967295|U>>>16),U=k+(L^P^N)+j[2]+3299628645&4294967295,k=L+(U<<23&4294967295|U>>>9),U=N+(L^(k|~P))+j[0]+4096336452&4294967295,N=k+(U<<6&4294967295|U>>>26),U=P+(k^(N|~L))+j[7]+1126891415&4294967295,P=N+(U<<10&4294967295|U>>>22),U=L+(N^(P|~k))+j[14]+2878612391&4294967295,L=P+(U<<15&4294967295|U>>>17),U=k+(P^(L|~N))+j[5]+4237533241&4294967295,k=L+(U<<21&4294967295|U>>>11),U=N+(L^(k|~P))+j[12]+1700485571&4294967295,N=k+(U<<6&4294967295|U>>>26),U=P+(k^(N|~L))+j[3]+2399980690&4294967295,P=N+(U<<10&4294967295|U>>>22),U=L+(N^(P|~k))+j[10]+4293915773&4294967295,L=P+(U<<15&4294967295|U>>>17),U=k+(P^(L|~N))+j[1]+2240044497&4294967295,k=L+(U<<21&4294967295|U>>>11),U=N+(L^(k|~P))+j[8]+1873313359&4294967295,N=k+(U<<6&4294967295|U>>>26),U=P+(k^(N|~L))+j[15]+4264355552&4294967295,P=N+(U<<10&4294967295|U>>>22),U=L+(N^(P|~k))+j[6]+2734768916&4294967295,L=P+(U<<15&4294967295|U>>>17),U=k+(P^(L|~N))+j[13]+1309151649&4294967295,k=L+(U<<21&4294967295|U>>>11),U=N+(L^(k|~P))+j[4]+4149444226&4294967295,N=k+(U<<6&4294967295|U>>>26),U=P+(k^(N|~L))+j[11]+3174756917&4294967295,P=N+(U<<10&4294967295|U>>>22),U=L+(N^(P|~k))+j[2]+718787259&4294967295,L=P+(U<<15&4294967295|U>>>17),U=k+(P^(L|~N))+j[9]+3951481745&4294967295,b.g[0]=b.g[0]+N&4294967295,b.g[1]=b.g[1]+(L+(U<<21&4294967295|U>>>11))&4294967295,b.g[2]=b.g[2]+L&4294967295,b.g[3]=b.g[3]+P&4294967295}n.prototype.u=function(b,N){N===void 0&&(N=b.length);for(var k=N-this.blockSize,j=this.B,L=this.h,P=0;P<N;){if(L==0)for(;P<=k;)a(this,b,P),P+=this.blockSize;if(typeof b=="string"){for(;P<N;)if(j[L++]=b.charCodeAt(P++),L==this.blockSize){a(this,j),L=0;break}}else for(;P<N;)if(j[L++]=b[P++],L==this.blockSize){a(this,j),L=0;break}}this.h=L,this.o+=N},n.prototype.v=function(){var b=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);b[0]=128;for(var N=1;N<b.length-8;++N)b[N]=0;var k=8*this.o;for(N=b.length-8;N<b.length;++N)b[N]=k&255,k/=256;for(this.u(b),b=Array(16),N=k=0;4>N;++N)for(var j=0;32>j;j+=8)b[k++]=this.g[N]>>>j&255;return b};function l(b,N){var k=u;return Object.prototype.hasOwnProperty.call(k,b)?k[b]:k[b]=N(b)}function o(b,N){this.h=N;for(var k=[],j=!0,L=b.length-1;0<=L;L--){var P=b[L]|0;j&&P==N||(k[L]=P,j=!1)}this.g=k}var u={};function h(b){return-128<=b&&128>b?l(b,function(N){return new o([N|0],0>N?-1:0)}):new o([b|0],0>b?-1:0)}function m(b){if(isNaN(b)||!isFinite(b))return v;if(0>b)return A(m(-b));for(var N=[],k=1,j=0;b>=k;j++)N[j]=b/k|0,k*=4294967296;return new o(N,0)}function p(b,N){if(b.length==0)throw Error("number format error: empty string");if(N=N||10,2>N||36<N)throw Error("radix out of range: "+N);if(b.charAt(0)=="-")return A(p(b.substring(1),N));if(0<=b.indexOf("-"))throw Error('number format error: interior "-" character');for(var k=m(Math.pow(N,8)),j=v,L=0;L<b.length;L+=8){var P=Math.min(8,b.length-L),U=parseInt(b.substring(L,L+P),N);8>P?(P=m(Math.pow(N,P)),j=j.j(P).add(m(U))):(j=j.j(k),j=j.add(m(U)))}return j}var v=h(0),_=h(1),w=h(16777216);t=o.prototype,t.m=function(){if(T(this))return-A(this).m();for(var b=0,N=1,k=0;k<this.g.length;k++){var j=this.i(k);b+=(0<=j?j:4294967296+j)*N,N*=4294967296}return b},t.toString=function(b){if(b=b||10,2>b||36<b)throw Error("radix out of range: "+b);if(E(this))return"0";if(T(this))return"-"+A(this).toString(b);for(var N=m(Math.pow(b,6)),k=this,j="";;){var L=z(k,N).g;k=M(k,L.j(N));var P=((0<k.g.length?k.g[0]:k.h)>>>0).toString(b);if(k=L,E(k))return P+j;for(;6>P.length;)P="0"+P;j=P+j}},t.i=function(b){return 0>b?0:b<this.g.length?this.g[b]:this.h};function E(b){if(b.h!=0)return!1;for(var N=0;N<b.g.length;N++)if(b.g[N]!=0)return!1;return!0}function T(b){return b.h==-1}t.l=function(b){return b=M(this,b),T(b)?-1:E(b)?0:1};function A(b){for(var N=b.g.length,k=[],j=0;j<N;j++)k[j]=~b.g[j];return new o(k,~b.h).add(_)}t.abs=function(){return T(this)?A(this):this},t.add=function(b){for(var N=Math.max(this.g.length,b.g.length),k=[],j=0,L=0;L<=N;L++){var P=j+(this.i(L)&65535)+(b.i(L)&65535),U=(P>>>16)+(this.i(L)>>>16)+(b.i(L)>>>16);j=U>>>16,P&=65535,U&=65535,k[L]=U<<16|P}return new o(k,k[k.length-1]&-2147483648?-1:0)};function M(b,N){return b.add(A(N))}t.j=function(b){if(E(this)||E(b))return v;if(T(this))return T(b)?A(this).j(A(b)):A(A(this).j(b));if(T(b))return A(this.j(A(b)));if(0>this.l(w)&&0>b.l(w))return m(this.m()*b.m());for(var N=this.g.length+b.g.length,k=[],j=0;j<2*N;j++)k[j]=0;for(j=0;j<this.g.length;j++)for(var L=0;L<b.g.length;L++){var P=this.i(j)>>>16,U=this.i(j)&65535,Ce=b.i(L)>>>16,Ne=b.i(L)&65535;k[2*j+2*L]+=U*Ne,F(k,2*j+2*L),k[2*j+2*L+1]+=P*Ne,F(k,2*j+2*L+1),k[2*j+2*L+1]+=U*Ce,F(k,2*j+2*L+1),k[2*j+2*L+2]+=P*Ce,F(k,2*j+2*L+2)}for(j=0;j<N;j++)k[j]=k[2*j+1]<<16|k[2*j];for(j=N;j<2*N;j++)k[j]=0;return new o(k,0)};function F(b,N){for(;(b[N]&65535)!=b[N];)b[N+1]+=b[N]>>>16,b[N]&=65535,N++}function R(b,N){this.g=b,this.h=N}function z(b,N){if(E(N))throw Error("division by zero");if(E(b))return new R(v,v);if(T(b))return N=z(A(b),N),new R(A(N.g),A(N.h));if(T(N))return N=z(b,A(N)),new R(A(N.g),N.h);if(30<b.g.length){if(T(b)||T(N))throw Error("slowDivide_ only works with positive integers.");for(var k=_,j=N;0>=j.l(b);)k=re(k),j=re(j);var L=te(k,1),P=te(j,1);for(j=te(j,2),k=te(k,2);!E(j);){var U=P.add(j);0>=U.l(b)&&(L=L.add(k),P=U),j=te(j,1),k=te(k,1)}return N=M(b,L.j(N)),new R(L,N)}for(L=v;0<=b.l(N);){for(k=Math.max(1,Math.floor(b.m()/N.m())),j=Math.ceil(Math.log(k)/Math.LN2),j=48>=j?1:Math.pow(2,j-48),P=m(k),U=P.j(N);T(U)||0<U.l(b);)k-=j,P=m(k),U=P.j(N);E(P)&&(P=_),L=L.add(P),b=M(b,U)}return new R(L,b)}t.A=function(b){return z(this,b).h},t.and=function(b){for(var N=Math.max(this.g.length,b.g.length),k=[],j=0;j<N;j++)k[j]=this.i(j)&b.i(j);return new o(k,this.h&b.h)},t.or=function(b){for(var N=Math.max(this.g.length,b.g.length),k=[],j=0;j<N;j++)k[j]=this.i(j)|b.i(j);return new o(k,this.h|b.h)},t.xor=function(b){for(var N=Math.max(this.g.length,b.g.length),k=[],j=0;j<N;j++)k[j]=this.i(j)^b.i(j);return new o(k,this.h^b.h)};function re(b){for(var N=b.g.length+1,k=[],j=0;j<N;j++)k[j]=b.i(j)<<1|b.i(j-1)>>>31;return new o(k,b.h)}function te(b,N){var k=N>>5;N%=32;for(var j=b.g.length-k,L=[],P=0;P<j;P++)L[P]=0<N?b.i(P+k)>>>N|b.i(P+k+1)<<32-N:b.i(P+k);return new o(L,b.h)}n.prototype.digest=n.prototype.v,n.prototype.reset=n.prototype.s,n.prototype.update=n.prototype.u,ES=n,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.A,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=m,o.fromString=p,uo=o}).apply(typeof oT<"u"?oT:typeof self<"u"?self:typeof window<"u"?window:{});var Bd=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var bS,ef,SS,l0,xx,AS,NS,CS;(function(){var t,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(g,S,D){return g==Array.prototype||g==Object.prototype||(g[S]=D.value),g};function r(g){g=[typeof globalThis=="object"&&globalThis,g,typeof window=="object"&&window,typeof self=="object"&&self,typeof Bd=="object"&&Bd];for(var S=0;S<g.length;++S){var D=g[S];if(D&&D.Math==Math)return D}throw Error("Cannot find global object")}var n=r(this);function a(g,S){if(S)e:{var D=n;g=g.split(".");for(var X=0;X<g.length-1;X++){var ye=g[X];if(!(ye in D))break e;D=D[ye]}g=g[g.length-1],X=D[g],S=S(X),S!=X&&S!=null&&e(D,g,{configurable:!0,writable:!0,value:S})}}function l(g,S){g instanceof String&&(g+="");var D=0,X=!1,ye={next:function(){if(!X&&D<g.length){var Re=D++;return{value:S(Re,g[Re]),done:!1}}return X=!0,{done:!0,value:void 0}}};return ye[Symbol.iterator]=function(){return ye},ye}a("Array.prototype.values",function(g){return g||function(){return l(this,function(S,D){return D})}});var o=o||{},u=this||self;function h(g){var S=typeof g;return S=S!="object"?S:g?Array.isArray(g)?"array":S:"null",S=="array"||S=="object"&&typeof g.length=="number"}function m(g){var S=typeof g;return S=="object"&&g!=null||S=="function"}function p(g,S,D){return g.call.apply(g.bind,arguments)}function v(g,S,D){if(!g)throw Error();if(2<arguments.length){var X=Array.prototype.slice.call(arguments,2);return function(){var ye=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(ye,X),g.apply(S,ye)}}return function(){return g.apply(S,arguments)}}function _(g,S,D){return _=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?p:v,_.apply(null,arguments)}function w(g,S){var D=Array.prototype.slice.call(arguments,1);return function(){var X=D.slice();return X.push.apply(X,arguments),g.apply(this,X)}}function E(g,S){function D(){}D.prototype=S.prototype,g.aa=S.prototype,g.prototype=new D,g.prototype.constructor=g,g.Qb=function(X,ye,Re){for(var We=Array(arguments.length-2),er=2;er<arguments.length;er++)We[er-2]=arguments[er];return S.prototype[ye].apply(X,We)}}function T(g){const S=g.length;if(0<S){const D=Array(S);for(let X=0;X<S;X++)D[X]=g[X];return D}return[]}function A(g,S){for(let D=1;D<arguments.length;D++){const X=arguments[D];if(h(X)){const ye=g.length||0,Re=X.length||0;g.length=ye+Re;for(let We=0;We<Re;We++)g[ye+We]=X[We]}else g.push(X)}}class M{constructor(S,D){this.i=S,this.j=D,this.h=0,this.g=null}get(){let S;return 0<this.h?(this.h--,S=this.g,this.g=S.next,S.next=null):S=this.i(),S}}function F(g){return/^[\s\xa0]*$/.test(g)}function R(){var g=u.navigator;return g&&(g=g.userAgent)?g:""}function z(g){return z[" "](g),g}z[" "]=function(){};var re=R().indexOf("Gecko")!=-1&&!(R().toLowerCase().indexOf("webkit")!=-1&&R().indexOf("Edge")==-1)&&!(R().indexOf("Trident")!=-1||R().indexOf("MSIE")!=-1)&&R().indexOf("Edge")==-1;function te(g,S,D){for(const X in g)S.call(D,g[X],X,g)}function b(g,S){for(const D in g)S.call(void 0,g[D],D,g)}function N(g){const S={};for(const D in g)S[D]=g[D];return S}const k="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function j(g,S){let D,X;for(let ye=1;ye<arguments.length;ye++){X=arguments[ye];for(D in X)g[D]=X[D];for(let Re=0;Re<k.length;Re++)D=k[Re],Object.prototype.hasOwnProperty.call(X,D)&&(g[D]=X[D])}}function L(g){var S=1;g=g.split(":");const D=[];for(;0<S&&g.length;)D.push(g.shift()),S--;return g.length&&D.push(g.join(":")),D}function P(g){u.setTimeout(()=>{throw g},0)}function U(){var g=ne;let S=null;return g.g&&(S=g.g,g.g=g.g.next,g.g||(g.h=null),S.next=null),S}class Ce{constructor(){this.h=this.g=null}add(S,D){const X=Ne.get();X.set(S,D),this.h?this.h.next=X:this.g=X,this.h=X}}var Ne=new M(()=>new ae,g=>g.reset());class ae{constructor(){this.next=this.g=this.h=null}set(S,D){this.h=S,this.g=D,this.next=null}reset(){this.next=this.g=this.h=null}}let ue,pe=!1,ne=new Ce,be=()=>{const g=u.Promise.resolve(void 0);ue=()=>{g.then(Q)}};var Q=()=>{for(var g;g=U();){try{g.h.call(g.g)}catch(D){P(D)}var S=Ne;S.j(g),100>S.h&&(S.h++,g.next=S.g,S.g=g)}pe=!1};function I(){this.s=this.s,this.C=this.C}I.prototype.s=!1,I.prototype.ma=function(){this.s||(this.s=!0,this.N())},I.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function Z(g,S){this.type=g,this.g=this.target=S,this.defaultPrevented=!1}Z.prototype.h=function(){this.defaultPrevented=!0};var ee=(function(){if(!u.addEventListener||!Object.defineProperty)return!1;var g=!1,S=Object.defineProperty({},"passive",{get:function(){g=!0}});try{const D=()=>{};u.addEventListener("test",D,S),u.removeEventListener("test",D,S)}catch{}return g})();function B(g,S){if(Z.call(this,g?g.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,g){var D=this.type=g.type,X=g.changedTouches&&g.changedTouches.length?g.changedTouches[0]:null;if(this.target=g.target||g.srcElement,this.g=S,S=g.relatedTarget){if(re){e:{try{z(S.nodeName);var ye=!0;break e}catch{}ye=!1}ye||(S=null)}}else D=="mouseover"?S=g.fromElement:D=="mouseout"&&(S=g.toElement);this.relatedTarget=S,X?(this.clientX=X.clientX!==void 0?X.clientX:X.pageX,this.clientY=X.clientY!==void 0?X.clientY:X.pageY,this.screenX=X.screenX||0,this.screenY=X.screenY||0):(this.clientX=g.clientX!==void 0?g.clientX:g.pageX,this.clientY=g.clientY!==void 0?g.clientY:g.pageY,this.screenX=g.screenX||0,this.screenY=g.screenY||0),this.button=g.button,this.key=g.key||"",this.ctrlKey=g.ctrlKey,this.altKey=g.altKey,this.shiftKey=g.shiftKey,this.metaKey=g.metaKey,this.pointerId=g.pointerId||0,this.pointerType=typeof g.pointerType=="string"?g.pointerType:se[g.pointerType]||"",this.state=g.state,this.i=g,g.defaultPrevented&&B.aa.h.call(this)}}E(B,Z);var se={2:"touch",3:"pen",4:"mouse"};B.prototype.h=function(){B.aa.h.call(this);var g=this.i;g.preventDefault?g.preventDefault():g.returnValue=!1};var _e="closure_listenable_"+(1e6*Math.random()|0),Pe=0;function he(g,S,D,X,ye){this.listener=g,this.proxy=null,this.src=S,this.type=D,this.capture=!!X,this.ha=ye,this.key=++Pe,this.da=this.fa=!1}function we(g){g.da=!0,g.listener=null,g.proxy=null,g.src=null,g.ha=null}function He(g){this.src=g,this.g={},this.h=0}He.prototype.add=function(g,S,D,X,ye){var Re=g.toString();g=this.g[Re],g||(g=this.g[Re]=[],this.h++);var We=Qe(g,S,X,ye);return-1<We?(S=g[We],D||(S.fa=!1)):(S=new he(S,this.src,Re,!!X,ye),S.fa=D,g.push(S)),S};function J(g,S){var D=S.type;if(D in g.g){var X=g.g[D],ye=Array.prototype.indexOf.call(X,S,void 0),Re;(Re=0<=ye)&&Array.prototype.splice.call(X,ye,1),Re&&(we(S),g.g[D].length==0&&(delete g.g[D],g.h--))}}function Qe(g,S,D,X){for(var ye=0;ye<g.length;++ye){var Re=g[ye];if(!Re.da&&Re.listener==S&&Re.capture==!!D&&Re.ha==X)return ye}return-1}var $e="closure_lm_"+(1e6*Math.random()|0),Fe={};function Ue(g,S,D,X,ye){if(Array.isArray(S)){for(var Re=0;Re<S.length;Re++)Ue(g,S[Re],D,X,ye);return null}return D=hr(D),g&&g[_e]?g.K(S,D,m(X)?!!X.capture:!1,ye):De(g,S,D,!1,X,ye)}function De(g,S,D,X,ye,Re){if(!S)throw Error("Invalid event type");var We=m(ye)?!!ye.capture:!!ye,er=Jt(g);if(er||(g[$e]=er=new He(g)),D=er.add(S,D,X,We,Re),D.proxy)return D;if(X=ut(),D.proxy=X,X.src=g,X.listener=D,g.addEventListener)ee||(ye=We),ye===void 0&&(ye=!1),g.addEventListener(S.toString(),X,ye);else if(g.attachEvent)g.attachEvent(yr(S.toString()),X);else if(g.addListener&&g.removeListener)g.addListener(X);else throw Error("addEventListener and attachEvent are unavailable.");return D}function ut(){function g(D){return S.call(g.src,g.listener,D)}const S=Hn;return g}function Lt(g,S,D,X,ye){if(Array.isArray(S))for(var Re=0;Re<S.length;Re++)Lt(g,S[Re],D,X,ye);else X=m(X)?!!X.capture:!!X,D=hr(D),g&&g[_e]?(g=g.i,S=String(S).toString(),S in g.g&&(Re=g.g[S],D=Qe(Re,D,X,ye),-1<D&&(we(Re[D]),Array.prototype.splice.call(Re,D,1),Re.length==0&&(delete g.g[S],g.h--)))):g&&(g=Jt(g))&&(S=g.g[S.toString()],g=-1,S&&(g=Qe(S,D,X,ye)),(D=-1<g?S[g]:null)&&Qt(D))}function Qt(g){if(typeof g!="number"&&g&&!g.da){var S=g.src;if(S&&S[_e])J(S.i,g);else{var D=g.type,X=g.proxy;S.removeEventListener?S.removeEventListener(D,X,g.capture):S.detachEvent?S.detachEvent(yr(D),X):S.addListener&&S.removeListener&&S.removeListener(X),(D=Jt(S))?(J(D,g),D.h==0&&(D.src=null,S[$e]=null)):we(g)}}}function yr(g){return g in Fe?Fe[g]:Fe[g]="on"+g}function Hn(g,S){if(g.da)g=!0;else{S=new B(S,this);var D=g.listener,X=g.ha||g.src;g.fa&&Qt(g),g=D.call(X,S)}return g}function Jt(g){return g=g[$e],g instanceof He?g:null}var pt="__closure_events_fn_"+(1e9*Math.random()>>>0);function hr(g){return typeof g=="function"?g:(g[pt]||(g[pt]=function(S){return g.handleEvent(S)}),g[pt])}function kt(){I.call(this),this.i=new He(this),this.M=this,this.F=null}E(kt,I),kt.prototype[_e]=!0,kt.prototype.removeEventListener=function(g,S,D,X){Lt(this,g,S,D,X)};function $t(g,S){var D,X=g.F;if(X)for(D=[];X;X=X.F)D.push(X);if(g=g.M,X=S.type||S,typeof S=="string")S=new Z(S,g);else if(S instanceof Z)S.target=S.target||g;else{var ye=S;S=new Z(X,g),j(S,ye)}if(ye=!0,D)for(var Re=D.length-1;0<=Re;Re--){var We=S.g=D[Re];ye=Ut(We,X,!0,S)&&ye}if(We=S.g=g,ye=Ut(We,X,!0,S)&&ye,ye=Ut(We,X,!1,S)&&ye,D)for(Re=0;Re<D.length;Re++)We=S.g=D[Re],ye=Ut(We,X,!1,S)&&ye}kt.prototype.N=function(){if(kt.aa.N.call(this),this.i){var g=this.i,S;for(S in g.g){for(var D=g.g[S],X=0;X<D.length;X++)we(D[X]);delete g.g[S],g.h--}}this.F=null},kt.prototype.K=function(g,S,D,X){return this.i.add(String(g),S,!1,D,X)},kt.prototype.L=function(g,S,D,X){return this.i.add(String(g),S,!0,D,X)};function Ut(g,S,D,X){if(S=g.i.g[String(S)],!S)return!0;S=S.concat();for(var ye=!0,Re=0;Re<S.length;++Re){var We=S[Re];if(We&&!We.da&&We.capture==D){var er=We.listener,Vr=We.ha||We.src;We.fa&&J(g.i,We),ye=er.call(Vr,X)!==!1&&ye}}return ye&&!X.defaultPrevented}function dr(g,S,D){if(typeof g=="function")D&&(g=_(g,D));else if(g&&typeof g.handleEvent=="function")g=_(g.handleEvent,g);else throw Error("Invalid listener argument");return 2147483647<Number(S)?-1:u.setTimeout(g,S||0)}function lt(g){g.g=dr(()=>{g.g=null,g.i&&(g.i=!1,lt(g))},g.l);const S=g.h;g.h=null,g.m.apply(null,S)}class Zt extends I{constructor(S,D){super(),this.m=S,this.l=D,this.h=null,this.i=!1,this.g=null}j(S){this.h=arguments,this.g?this.i=!0:lt(this)}N(){super.N(),this.g&&(u.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Sr(g){I.call(this),this.h=g,this.g={}}E(Sr,I);var St=[];function or(g){te(g.g,function(S,D){this.g.hasOwnProperty(D)&&Qt(S)},g),g.g={}}Sr.prototype.N=function(){Sr.aa.N.call(this),or(this)},Sr.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var nn=u.JSON.stringify,Ur=u.JSON.parse,Dl=class{stringify(g){return u.JSON.stringify(g,void 0)}parse(g){return u.JSON.parse(g,void 0)}};function rs(){}rs.prototype.h=null;function ja(g){return g.h||(g.h=g.i())}function ga(){}var Nn={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function na(){Z.call(this,"d")}E(na,Z);function an(){Z.call(this,"c")}E(an,Z);var dn={},Fa=null;function ns(){return Fa=Fa||new kt}dn.La="serverreachability";function Pa(g){Z.call(this,dn.La,g)}E(Pa,Z);function Cn(g){const S=ns();$t(S,new Pa(S))}dn.STAT_EVENT="statevent";function La(g,S){Z.call(this,dn.STAT_EVENT,g),this.stat=S}E(La,Z);function Or(g){const S=ns();$t(S,new La(S,g))}dn.Ma="timingevent";function le(g,S){Z.call(this,dn.Ma,g),this.size=S}E(le,Z);function de(g,S){if(typeof g!="function")throw Error("Fn must not be null and must be a function");return u.setTimeout(function(){g()},S)}function Ae(){this.g=!0}Ae.prototype.xa=function(){this.g=!1};function Be(g,S,D,X,ye,Re){g.info(function(){if(g.g)if(Re)for(var We="",er=Re.split("&"),Vr=0;Vr<er.length;Vr++){var Et=er[Vr].split("=");if(1<Et.length){var ln=Et[0];Et=Et[1];var on=ln.split("_");We=2<=on.length&&on[1]=="type"?We+(ln+"="+Et+"&"):We+(ln+"=redacted&")}}else We=null;else We=Re;return"XMLHTTP REQ ("+X+") [attempt "+ye+"]: "+S+`
`+D+`
`+We})}function Ke(g,S,D,X,ye,Re,We){g.info(function(){return"XMLHTTP RESP ("+X+") [ attempt "+ye+"]: "+S+`
`+D+`
`+Re+" "+We})}function O(g,S,D,X){g.info(function(){return"XMLHTTP TEXT ("+S+"): "+V(g,D)+(X?" "+X:"")})}function Y(g,S){g.info(function(){return"TIMEOUT: "+S})}Ae.prototype.info=function(){};function V(g,S){if(!g.g)return S;if(!S)return null;try{var D=JSON.parse(S);if(D){for(g=0;g<D.length;g++)if(Array.isArray(D[g])){var X=D[g];if(!(2>X.length)){var ye=X[1];if(Array.isArray(ye)&&!(1>ye.length)){var Re=ye[0];if(Re!="noop"&&Re!="stop"&&Re!="close")for(var We=1;We<ye.length;We++)ye[We]=""}}}}return nn(D)}catch{return S}}var H={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},W={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},K;function oe(){}E(oe,rs),oe.prototype.g=function(){return new XMLHttpRequest},oe.prototype.i=function(){return{}},K=new oe;function ve(g,S,D,X){this.j=g,this.i=S,this.l=D,this.R=X||1,this.U=new Sr(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new xe}function xe(){this.i=null,this.g="",this.h=!1}var me={},fe={};function Oe(g,S,D){g.L=1,g.v=Ol(Ar(S)),g.m=D,g.P=!0,Ge(g,null)}function Ge(g,S){g.F=Date.now(),qe(g),g.A=Ar(g.v);var D=g.A,X=g.R;Array.isArray(X)||(X=[String(X)]),Hs(D.i,"t",X),g.C=0,D=g.j.J,g.h=new xe,g.g=Dh(g.j,D?S:null,!g.m),0<g.O&&(g.M=new Zt(_(g.Y,g,g.g),g.O)),S=g.U,D=g.g,X=g.ca;var ye="readystatechange";Array.isArray(ye)||(ye&&(St[0]=ye.toString()),ye=St);for(var Re=0;Re<ye.length;Re++){var We=Ue(D,ye[Re],X||S.handleEvent,!1,S.h||S);if(!We)break;S.g[We.key]=We}S=g.H?N(g.H):{},g.m?(g.u||(g.u="POST"),S["Content-Type"]="application/x-www-form-urlencoded",g.g.ea(g.A,g.u,g.m,S)):(g.u="GET",g.g.ea(g.A,g.u,null,S)),Cn(),Be(g.i,g.u,g.A,g.l,g.R,g.m)}ve.prototype.ca=function(g){g=g.target;const S=this.M;S&&Wn(g)==3?S.j():this.Y(g)},ve.prototype.Y=function(g){try{if(g==this.g)e:{const on=Wn(this.g);var S=this.g.Ba();const Fi=this.g.Z();if(!(3>on)&&(on!=3||this.g&&(this.h.h||this.g.oa()||Fl(this.g)))){this.J||on!=4||S==7||(S==8||0>=Fi?Cn(3):Cn(2)),Rt(this);var D=this.g.Z();this.X=D;t:if(Ye(this)){var X=Fl(this.g);g="";var ye=X.length,Re=Wn(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){At(this),wt(this);var We="";break t}this.h.i=new u.TextDecoder}for(S=0;S<ye;S++)this.h.h=!0,g+=this.h.i.decode(X[S],{stream:!(Re&&S==ye-1)});X.length=0,this.h.g+=g,this.C=0,We=this.h.g}else We=this.g.oa();if(this.o=D==200,Ke(this.i,this.u,this.A,this.l,this.R,on,D),this.o){if(this.T&&!this.K){t:{if(this.g){var er,Vr=this.g;if((er=Vr.g?Vr.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!F(er)){var Et=er;break t}}Et=null}if(D=Et)O(this.i,this.l,D,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,Mr(this,D);else{this.o=!1,this.s=3,Or(12),At(this),wt(this);break e}}if(this.P){D=!0;let ia;for(;!this.J&&this.C<We.length;)if(ia=Ve(this,We),ia==fe){on==4&&(this.s=4,Or(14),D=!1),O(this.i,this.l,null,"[Incomplete Response]");break}else if(ia==me){this.s=4,Or(15),O(this.i,this.l,We,"[Invalid Chunk]"),D=!1;break}else O(this.i,this.l,ia,null),Mr(this,ia);if(Ye(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),on!=4||We.length!=0||this.h.h||(this.s=1,Or(16),D=!1),this.o=this.o&&D,!D)O(this.i,this.l,We,"[Invalid Chunked Response]"),At(this),wt(this);else if(0<We.length&&!this.W){this.W=!0;var ln=this.j;ln.g==this&&ln.ba&&!ln.M&&(ln.j.info("Great, no buffering proxy detected. Bytes received: "+We.length),cu(ln),ln.M=!0,Or(11))}}else O(this.i,this.l,We,null),Mr(this,We);on==4&&At(this),this.o&&!this.J&&(on==4?Ch(this.j,this):(this.o=!1,qe(this)))}else Th(this.g),D==400&&0<We.indexOf("Unknown SID")?(this.s=3,Or(12)):(this.s=0,Or(13)),At(this),wt(this)}}}catch{}finally{}};function Ye(g){return g.g?g.u=="GET"&&g.L!=2&&g.j.Ca:!1}function Ve(g,S){var D=g.C,X=S.indexOf(`
`,D);return X==-1?fe:(D=Number(S.substring(D,X)),isNaN(D)?me:(X+=1,X+D>S.length?fe:(S=S.slice(X,X+D),g.C=X+D,S)))}ve.prototype.cancel=function(){this.J=!0,At(this)};function qe(g){g.S=Date.now()+g.I,Xe(g,g.I)}function Xe(g,S){if(g.B!=null)throw Error("WatchDog timer not null");g.B=de(_(g.ba,g),S)}function Rt(g){g.B&&(u.clearTimeout(g.B),g.B=null)}ve.prototype.ba=function(){this.B=null;const g=Date.now();0<=g-this.S?(Y(this.i,this.A),this.L!=2&&(Cn(),Or(17)),At(this),this.s=2,wt(this)):Xe(this,this.S-g)};function wt(g){g.j.G==0||g.J||Ch(g.j,g)}function At(g){Rt(g);var S=g.M;S&&typeof S.ma=="function"&&S.ma(),g.M=null,or(g.U),g.g&&(S=g.g,g.g=null,S.abort(),S.ma())}function Mr(g,S){try{var D=g.j;if(D.G!=0&&(D.g==g||Tt(D.h,g))){if(!g.K&&Tt(D.h,g)&&D.G==3){try{var X=D.Da.g.parse(S)}catch{X=null}if(Array.isArray(X)&&X.length==3){var ye=X;if(ye[0]==0){e:if(!D.u){if(D.g)if(D.g.F+3e3<g.F)Mi(D),Oi(D);else break e;ou(D),Or(18)}}else D.za=ye[1],0<D.za-D.T&&37500>ye[2]&&D.F&&D.v==0&&!D.C&&(D.C=de(_(D.Za,D),6e3));if(1>=aa(D.h)&&D.ca){try{D.ca()}catch{}D.ca=void 0}}else qs(D,11)}else if((g.K||D.g==g)&&Mi(D),!F(S))for(ye=D.Da.g.parse(S),S=0;S<ye.length;S++){let Et=ye[S];if(D.T=Et[0],Et=Et[1],D.G==2)if(Et[0]=="c"){D.K=Et[1],D.ia=Et[2];const ln=Et[3];ln!=null&&(D.la=ln,D.j.info("VER="+D.la));const on=Et[4];on!=null&&(D.Aa=on,D.j.info("SVER="+D.Aa));const Fi=Et[5];Fi!=null&&typeof Fi=="number"&&0<Fi&&(X=1.5*Fi,D.L=X,D.j.info("backChannelRequestTimeoutMs_="+X)),X=D;const ia=g.g;if(ia){const Ul=ia.g?ia.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Ul){var Re=X.h;Re.g||Ul.indexOf("spdy")==-1&&Ul.indexOf("quic")==-1&&Ul.indexOf("h2")==-1||(Re.j=Re.l,Re.g=new Set,Re.h&&(Gn(Re,Re.h),Re.h=null))}if(X.D){const Ws=ia.g?ia.g.getResponseHeader("X-HTTP-Session-Id"):null;Ws&&(X.ya=Ws,qt(X.I,X.D,Ws))}}D.G=3,D.l&&D.l.ua(),D.ba&&(D.R=Date.now()-g.F,D.j.info("Handshake RTT: "+D.R+"ms")),X=D;var We=g;if(X.qa=Rh(X,X.J?X.ia:null,X.W),We.K){qn(X.h,We);var er=We,Vr=X.L;Vr&&(er.I=Vr),er.B&&(Rt(er),qe(er)),X.g=We}else Ah(X);0<D.i.length&&zo(D)}else Et[0]!="stop"&&Et[0]!="close"||qs(D,7);else D.G==3&&(Et[0]=="stop"||Et[0]=="close"?Et[0]=="stop"?qs(D,7):iu(D):Et[0]!="noop"&&D.l&&D.l.ta(Et),D.v=0)}}Cn(4)}catch{}}var xt=class{constructor(g,S){this.g=g,this.map=S}};function Bt(g){this.l=g||10,u.PerformanceNavigationTiming?(g=u.performance.getEntriesByType("navigation"),g=0<g.length&&(g[0].nextHopProtocol=="hq"||g[0].nextHopProtocol=="h2")):g=!!(u.chrome&&u.chrome.loadTimes&&u.chrome.loadTimes()&&u.chrome.loadTimes().wasFetchedViaSpdy),this.j=g?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function Br(g){return g.h?!0:g.g?g.g.size>=g.j:!1}function aa(g){return g.h?1:g.g?g.g.size:0}function Tt(g,S){return g.h?g.h==S:g.g?g.g.has(S):!1}function Gn(g,S){g.g?g.g.add(S):g.h=S}function qn(g,S){g.h&&g.h==S?g.h=null:g.g&&g.g.has(S)&&g.g.delete(S)}Bt.prototype.cancel=function(){if(this.i=mn(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const g of this.g.values())g.cancel();this.g.clear()}};function mn(g){if(g.h!=null)return g.i.concat(g.h.D);if(g.g!=null&&g.g.size!==0){let S=g.i;for(const D of g.g.values())S=S.concat(D.D);return S}return T(g.i)}function xh(g){if(g.V&&typeof g.V=="function")return g.V();if(typeof Map<"u"&&g instanceof Map||typeof Set<"u"&&g instanceof Set)return Array.from(g.values());if(typeof g=="string")return g.split("");if(h(g)){for(var S=[],D=g.length,X=0;X<D;X++)S.push(g[X]);return S}S=[],D=0;for(X in g)S[D++]=g[X];return S}function Nm(g){if(g.na&&typeof g.na=="function")return g.na();if(!g.V||typeof g.V!="function"){if(typeof Map<"u"&&g instanceof Map)return Array.from(g.keys());if(!(typeof Set<"u"&&g instanceof Set)){if(h(g)||typeof g=="string"){var S=[];g=g.length;for(var D=0;D<g;D++)S.push(D);return S}S=[],D=0;for(const X in g)S[D++]=X;return S}}}function jo(g,S){if(g.forEach&&typeof g.forEach=="function")g.forEach(S,void 0);else if(h(g)||typeof g=="string")Array.prototype.forEach.call(g,S,void 0);else for(var D=Nm(g),X=xh(g),ye=X.length,Re=0;Re<ye;Re++)S.call(void 0,X[Re],D&&D[Re],g)}var tu=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Fo(g,S){if(g){g=g.split("&");for(var D=0;D<g.length;D++){var X=g[D].indexOf("="),ye=null;if(0<=X){var Re=g[D].substring(0,X);ye=g[D].substring(X+1)}else Re=g[D];S(Re,ye?decodeURIComponent(ye.replace(/\+/g," ")):"")}}}function zs(g){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,g instanceof zs){this.h=g.h,Ni(this,g.j),this.o=g.o,this.g=g.g,Il(this,g.s),this.l=g.l;var S=g.i,D=new ws;D.i=S.i,S.g&&(D.g=new Map(S.g),D.h=S.h),Po(this,D),this.m=g.m}else g&&(S=String(g).match(tu))?(this.h=!1,Ni(this,S[1]||"",!0),this.o=Ci(S[2]||""),this.g=Ci(S[3]||"",!0),Il(this,S[4]),this.l=Ci(S[5]||"",!0),Po(this,S[6]||"",!0),this.m=Ci(S[7]||"")):(this.h=!1,this.i=new ws(null,this.h))}zs.prototype.toString=function(){var g=[],S=this.j;S&&g.push(Ua(S,ru,!0),":");var D=this.g;return(D||S=="file")&&(g.push("//"),(S=this.o)&&g.push(Ua(S,ru,!0),"@"),g.push(encodeURIComponent(String(D)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),D=this.s,D!=null&&g.push(":",String(D))),(D=this.l)&&(this.g&&D.charAt(0)!="/"&&g.push("/"),g.push(Ua(D,D.charAt(0)=="/"?nu:vh,!0))),(D=this.i.toString())&&g.push("?",D),(D=this.m)&&g.push("#",Ua(D,Rm)),g.join("")};function Ar(g){return new zs(g)}function Ni(g,S,D){g.j=D?Ci(S,!0):S,g.j&&(g.j=g.j.replace(/:$/,""))}function Il(g,S){if(S){if(S=Number(S),isNaN(S)||0>S)throw Error("Bad port number "+S);g.s=S}else g.s=null}function Po(g,S,D){S instanceof ws?(g.i=S,yh(g.i,g.h)):(D||(S=Ua(S,km)),g.i=new ws(S,g.h))}function qt(g,S,D){g.i.set(S,D)}function Ol(g){return qt(g,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),g}function Ci(g,S){return g?S?decodeURI(g.replace(/%25/g,"%2525")):decodeURIComponent(g):""}function Ua(g,S,D){return typeof g=="string"?(g=encodeURI(g).replace(S,Cm),D&&(g=g.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),g):null}function Cm(g){return g=g.charCodeAt(0),"%"+(g>>4&15).toString(16)+(g&15).toString(16)}var ru=/[#\/\?@]/g,vh=/[#\?:]/g,nu=/[#\?]/g,km=/[#\?@]/g,Rm=/#/g;function ws(g,S){this.h=this.g=null,this.i=g||null,this.j=!!S}function sn(g){g.g||(g.g=new Map,g.h=0,g.i&&Fo(g.i,function(S,D){g.add(decodeURIComponent(S.replace(/\+/g," ")),D)}))}t=ws.prototype,t.add=function(g,S){sn(this),this.i=null,g=xa(this,g);var D=this.g.get(g);return D||this.g.set(g,D=[]),D.push(S),this.h+=1,this};function Lo(g,S){sn(g),S=xa(g,S),g.g.has(S)&&(g.i=null,g.h-=g.g.get(S).length,g.g.delete(S))}function Uo(g,S){return sn(g),S=xa(g,S),g.g.has(S)}t.forEach=function(g,S){sn(this),this.g.forEach(function(D,X){D.forEach(function(ye){g.call(S,ye,X,this)},this)},this)},t.na=function(){sn(this);const g=Array.from(this.g.values()),S=Array.from(this.g.keys()),D=[];for(let X=0;X<S.length;X++){const ye=g[X];for(let Re=0;Re<ye.length;Re++)D.push(S[X])}return D},t.V=function(g){sn(this);let S=[];if(typeof g=="string")Uo(this,g)&&(S=S.concat(this.g.get(xa(this,g))));else{g=Array.from(this.g.values());for(let D=0;D<g.length;D++)S=S.concat(g[D])}return S},t.set=function(g,S){return sn(this),this.i=null,g=xa(this,g),Uo(this,g)&&(this.h-=this.g.get(g).length),this.g.set(g,[S]),this.h+=1,this},t.get=function(g,S){return g?(g=this.V(g),0<g.length?String(g[0]):S):S};function Hs(g,S,D){Lo(g,S),0<D.length&&(g.i=null,g.g.set(xa(g,S),T(D)),g.h+=D.length)}t.toString=function(){if(this.i)return this.i;if(!this.g)return"";const g=[],S=Array.from(this.g.keys());for(var D=0;D<S.length;D++){var X=S[D];const Re=encodeURIComponent(String(X)),We=this.V(X);for(X=0;X<We.length;X++){var ye=Re;We[X]!==""&&(ye+="="+encodeURIComponent(String(We[X]))),g.push(ye)}}return this.i=g.join("&")};function xa(g,S){return S=String(S),g.j&&(S=S.toLowerCase()),S}function yh(g,S){S&&!g.j&&(sn(g),g.i=null,g.g.forEach(function(D,X){var ye=X.toLowerCase();X!=ye&&(Lo(this,X),Hs(this,ye,D))},g)),g.j=S}function au(g,S){const D=new Ae;if(u.Image){const X=new Image;X.onload=w(sa,D,"TestLoadImage: loaded",!0,S,X),X.onerror=w(sa,D,"TestLoadImage: error",!1,S,X),X.onabort=w(sa,D,"TestLoadImage: abort",!1,S,X),X.ontimeout=w(sa,D,"TestLoadImage: timeout",!1,S,X),u.setTimeout(function(){X.ontimeout&&X.ontimeout()},1e4),X.src=g}else S(!1)}function _h(g,S){const D=new Ae,X=new AbortController,ye=setTimeout(()=>{X.abort(),sa(D,"TestPingServer: timeout",!1,S)},1e4);fetch(g,{signal:X.signal}).then(Re=>{clearTimeout(ye),Re.ok?sa(D,"TestPingServer: ok",!0,S):sa(D,"TestPingServer: server error",!1,S)}).catch(()=>{clearTimeout(ye),sa(D,"TestPingServer: error",!1,S)})}function sa(g,S,D,X,ye){try{ye&&(ye.onload=null,ye.onerror=null,ye.onabort=null,ye.ontimeout=null),X(D)}catch{}}function as(){this.g=new Dl}function su(g,S,D){const X=D||"";try{jo(g,function(ye,Re){let We=ye;m(ye)&&(We=nn(ye)),S.push(X+Re+"="+encodeURIComponent(We))})}catch(ye){throw S.push(X+"type="+encodeURIComponent("_badmap")),ye}}function Ts(g){this.l=g.Ub||null,this.j=g.eb||!1}E(Ts,rs),Ts.prototype.g=function(){return new va(this.l,this.j)},Ts.prototype.i=(function(g){return function(){return g}})({});function va(g,S){kt.call(this),this.D=g,this.o=S,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}E(va,kt),t=va.prototype,t.open=function(g,S){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=g,this.A=S,this.readyState=1,ki(this)},t.send=function(g){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const S={headers:this.u,method:this.B,credentials:this.m,cache:void 0};g&&(S.body=g),(this.D||u).fetch(new Request(this.A,S)).then(this.Sa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,Es(this)),this.readyState=0},t.Sa=function(g){if(this.g&&(this.l=g,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=g.headers,this.readyState=2,ki(this)),this.g&&(this.readyState=3,ki(this),this.g)))if(this.responseType==="arraybuffer")g.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof u.ReadableStream<"u"&&"body"in g){if(this.j=g.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;Bo(this)}else g.text().then(this.Ra.bind(this),this.ga.bind(this))};function Bo(g){g.j.read().then(g.Pa.bind(g)).catch(g.ga.bind(g))}t.Pa=function(g){if(this.g){if(this.o&&g.value)this.response.push(g.value);else if(!this.o){var S=g.value?g.value:new Uint8Array(0);(S=this.v.decode(S,{stream:!g.done}))&&(this.response=this.responseText+=S)}g.done?Es(this):ki(this),this.readyState==3&&Bo(this)}},t.Ra=function(g){this.g&&(this.response=this.responseText=g,Es(this))},t.Qa=function(g){this.g&&(this.response=g,Es(this))},t.ga=function(){this.g&&Es(this)};function Es(g){g.readyState=4,g.l=null,g.j=null,g.v=null,ki(g)}t.setRequestHeader=function(g,S){this.u.append(g,S)},t.getResponseHeader=function(g){return this.h&&this.h.get(g.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";const g=[],S=this.h.entries();for(var D=S.next();!D.done;)D=D.value,g.push(D[0]+": "+D[1]),D=S.next();return g.join(`\r
`)};function ki(g){g.onreadystatechange&&g.onreadystatechange.call(g)}Object.defineProperty(va.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(g){this.m=g?"include":"same-origin"}});function Ml(g){let S="";return te(g,function(D,X){S+=X,S+=":",S+=D,S+=`\r
`}),S}function Ri(g,S,D){e:{for(X in D){var X=!1;break e}X=!0}X||(D=Ml(D),typeof g=="string"?D!=null&&encodeURIComponent(String(D)):qt(g,S,D))}function mr(g){kt.call(this),this.headers=new Map,this.o=g||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}E(mr,kt);var kn=/^https?$/i,Gs=["POST","PUT"];t=mr.prototype,t.Ha=function(g){this.J=g},t.ea=function(g,S,D,X){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+g);S=S?S.toUpperCase():"GET",this.D=g,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():K.g(),this.v=this.o?ja(this.o):ja(K),this.g.onreadystatechange=_(this.Ea,this);try{this.B=!0,this.g.open(S,String(g),!0),this.B=!1}catch(Re){jl(this,Re);return}if(g=D||"",D=new Map(this.headers),X)if(Object.getPrototypeOf(X)===Object.prototype)for(var ye in X)D.set(ye,X[ye]);else if(typeof X.keys=="function"&&typeof X.get=="function")for(const Re of X.keys())D.set(Re,X.get(Re));else throw Error("Unknown input type for opt_headers: "+String(X));X=Array.from(D.keys()).find(Re=>Re.toLowerCase()=="content-type"),ye=u.FormData&&g instanceof u.FormData,!(0<=Array.prototype.indexOf.call(Gs,S,void 0))||X||ye||D.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[Re,We]of D)this.g.setRequestHeader(Re,We);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{Vo(this),this.u=!0,this.g.send(g),this.u=!1}catch(Re){jl(this,Re)}};function jl(g,S){g.h=!1,g.g&&(g.j=!0,g.g.abort(),g.j=!1),g.l=S,g.m=5,Di(g),Ii(g)}function Di(g){g.A||(g.A=!0,$t(g,"complete"),$t(g,"error"))}t.abort=function(g){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=g||7,$t(this,"complete"),$t(this,"abort"),Ii(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Ii(this,!0)),mr.aa.N.call(this)},t.Ea=function(){this.s||(this.B||this.u||this.j?wh(this):this.bb())},t.bb=function(){wh(this)};function wh(g){if(g.h&&typeof o<"u"&&(!g.v[1]||Wn(g)!=4||g.Z()!=2)){if(g.u&&Wn(g)==4)dr(g.Ea,0,g);else if($t(g,"readystatechange"),Wn(g)==4){g.h=!1;try{const We=g.Z();e:switch(We){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var S=!0;break e;default:S=!1}var D;if(!(D=S)){var X;if(X=We===0){var ye=String(g.D).match(tu)[1]||null;!ye&&u.self&&u.self.location&&(ye=u.self.location.protocol.slice(0,-1)),X=!kn.test(ye?ye.toLowerCase():"")}D=X}if(D)$t(g,"complete"),$t(g,"success");else{g.m=6;try{var Re=2<Wn(g)?g.g.statusText:""}catch{Re=""}g.l=Re+" ["+g.Z()+"]",Di(g)}}finally{Ii(g)}}}}function Ii(g,S){if(g.g){Vo(g);const D=g.g,X=g.v[0]?()=>{}:null;g.g=null,g.v=null,S||$t(g,"ready");try{D.onreadystatechange=X}catch{}}}function Vo(g){g.I&&(u.clearTimeout(g.I),g.I=null)}t.isActive=function(){return!!this.g};function Wn(g){return g.g?g.g.readyState:0}t.Z=function(){try{return 2<Wn(this)?this.g.status:-1}catch{return-1}},t.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},t.Oa=function(g){if(this.g){var S=this.g.responseText;return g&&S.indexOf(g)==0&&(S=S.substring(g.length)),Ur(S)}};function Fl(g){try{if(!g.g)return null;if("response"in g.g)return g.g.response;switch(g.H){case"":case"text":return g.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in g.g)return g.g.mozResponseArrayBuffer}return null}catch{return null}}function Th(g){const S={};g=(g.g&&2<=Wn(g)&&g.g.getAllResponseHeaders()||"").split(`\r
`);for(let X=0;X<g.length;X++){if(F(g[X]))continue;var D=L(g[X]);const ye=D[0];if(D=D[1],typeof D!="string")continue;D=D.trim();const Re=S[ye]||[];S[ye]=Re,Re.push(D)}b(S,function(X){return X.join(", ")})}t.Ba=function(){return this.m},t.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function Pl(g,S,D){return D&&D.internalChannelParams&&D.internalChannelParams[g]||S}function Eh(g){this.Aa=0,this.i=[],this.j=new Ae,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=Pl("failFast",!1,g),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=Pl("baseRetryDelayMs",5e3,g),this.cb=Pl("retryDelaySeedMs",1e4,g),this.Wa=Pl("forwardChannelMaxRetries",2,g),this.wa=Pl("forwardChannelRequestTimeoutMs",2e4,g),this.pa=g&&g.xmlHttpFactory||void 0,this.Xa=g&&g.Tb||void 0,this.Ca=g&&g.useFetchStreams||!1,this.L=void 0,this.J=g&&g.supportsCrossDomainXhr||!1,this.K="",this.h=new Bt(g&&g.concurrentRequestLimit),this.Da=new as,this.P=g&&g.fastHandshake||!1,this.O=g&&g.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=g&&g.Rb||!1,g&&g.xa&&this.j.xa(),g&&g.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&g&&g.detectBufferingProxy||!1,this.ja=void 0,g&&g.longPollingTimeout&&0<g.longPollingTimeout&&(this.ja=g.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}t=Eh.prototype,t.la=8,t.G=1,t.connect=function(g,S,D,X){Or(0),this.W=g,this.H=S||{},D&&X!==void 0&&(this.H.OSID=D,this.H.OAID=X),this.F=this.X,this.I=Rh(this,null,this.W),zo(this)};function iu(g){if(bh(g),g.G==3){var S=g.U++,D=Ar(g.I);if(qt(D,"SID",g.K),qt(D,"RID",S),qt(D,"TYPE","terminate"),Ll(g,D),S=new ve(g,g.j,S),S.L=2,S.v=Ol(Ar(D)),D=!1,u.navigator&&u.navigator.sendBeacon)try{D=u.navigator.sendBeacon(S.v.toString(),"")}catch{}!D&&u.Image&&(new Image().src=S.v,D=!0),D||(S.g=Dh(S.j,null),S.g.ea(S.v)),S.F=Date.now(),qe(S)}uu(g)}function Oi(g){g.g&&(cu(g),g.g.cancel(),g.g=null)}function bh(g){Oi(g),g.u&&(u.clearTimeout(g.u),g.u=null),Mi(g),g.h.cancel(),g.s&&(typeof g.s=="number"&&u.clearTimeout(g.s),g.s=null)}function zo(g){if(!Br(g.h)&&!g.s){g.s=!0;var S=g.Ga;ue||be(),pe||(ue(),pe=!0),ne.add(S,g),g.B=0}}function Dm(g,S){return aa(g.h)>=g.h.j-(g.s?1:0)?!1:g.s?(g.i=S.D.concat(g.i),!0):g.G==1||g.G==2||g.B>=(g.Va?0:g.Wa)?!1:(g.s=de(_(g.Ga,g,S),kh(g,g.B)),g.B++,!0)}t.Ga=function(g){if(this.s)if(this.s=null,this.G==1){if(!g){this.U=Math.floor(1e5*Math.random()),g=this.U++;const ye=new ve(this,this.j,g);let Re=this.o;if(this.S&&(Re?(Re=N(Re),j(Re,this.S)):Re=this.S),this.m!==null||this.O||(ye.H=Re,Re=null),this.P)e:{for(var S=0,D=0;D<this.i.length;D++){t:{var X=this.i[D];if("__data__"in X.map&&(X=X.map.__data__,typeof X=="string")){X=X.length;break t}X=void 0}if(X===void 0)break;if(S+=X,4096<S){S=D;break e}if(S===4096||D===this.i.length-1){S=D+1;break e}}S=1e3}else S=1e3;S=lu(this,ye,S),D=Ar(this.I),qt(D,"RID",g),qt(D,"CVER",22),this.D&&qt(D,"X-HTTP-Session-Id",this.D),Ll(this,D),Re&&(this.O?S="headers="+encodeURIComponent(String(Ml(Re)))+"&"+S:this.m&&Ri(D,this.m,Re)),Gn(this.h,ye),this.Ua&&qt(D,"TYPE","init"),this.P?(qt(D,"$req",S),qt(D,"SID","null"),ye.T=!0,Oe(ye,D,null)):Oe(ye,D,S),this.G=2}}else this.G==3&&(g?Sh(this,g):this.i.length==0||Br(this.h)||Sh(this))};function Sh(g,S){var D;S?D=S.l:D=g.U++;const X=Ar(g.I);qt(X,"SID",g.K),qt(X,"RID",D),qt(X,"AID",g.T),Ll(g,X),g.m&&g.o&&Ri(X,g.m,g.o),D=new ve(g,g.j,D,g.B+1),g.m===null&&(D.H=g.o),S&&(g.i=S.D.concat(g.i)),S=lu(g,D,1e3),D.I=Math.round(.5*g.wa)+Math.round(.5*g.wa*Math.random()),Gn(g.h,D),Oe(D,X,S)}function Ll(g,S){g.H&&te(g.H,function(D,X){qt(S,X,D)}),g.l&&jo({},function(D,X){qt(S,X,D)})}function lu(g,S,D){D=Math.min(g.i.length,D);var X=g.l?_(g.l.Na,g.l,g):null;e:{var ye=g.i;let Re=-1;for(;;){const We=["count="+D];Re==-1?0<D?(Re=ye[0].g,We.push("ofs="+Re)):Re=0:We.push("ofs="+Re);let er=!0;for(let Vr=0;Vr<D;Vr++){let Et=ye[Vr].g;const ln=ye[Vr].map;if(Et-=Re,0>Et)Re=Math.max(0,ye[Vr].g-100),er=!1;else try{su(ln,We,"req"+Et+"_")}catch{X&&X(ln)}}if(er){X=We.join("&");break e}}}return g=g.i.splice(0,D),S.D=g,X}function Ah(g){if(!g.g&&!g.u){g.Y=1;var S=g.Fa;ue||be(),pe||(ue(),pe=!0),ne.add(S,g),g.v=0}}function ou(g){return g.g||g.u||3<=g.v?!1:(g.Y++,g.u=de(_(g.Fa,g),kh(g,g.v)),g.v++,!0)}t.Fa=function(){if(this.u=null,Nh(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var g=2*this.R;this.j.info("BP detection timer enabled: "+g),this.A=de(_(this.ab,this),g)}},t.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,Or(10),Oi(this),Nh(this))};function cu(g){g.A!=null&&(u.clearTimeout(g.A),g.A=null)}function Nh(g){g.g=new ve(g,g.j,"rpc",g.Y),g.m===null&&(g.g.H=g.o),g.g.O=0;var S=Ar(g.qa);qt(S,"RID","rpc"),qt(S,"SID",g.K),qt(S,"AID",g.T),qt(S,"CI",g.F?"0":"1"),!g.F&&g.ja&&qt(S,"TO",g.ja),qt(S,"TYPE","xmlhttp"),Ll(g,S),g.m&&g.o&&Ri(S,g.m,g.o),g.L&&(g.g.I=g.L);var D=g.g;g=g.ia,D.L=1,D.v=Ol(Ar(S)),D.m=null,D.P=!0,Ge(D,g)}t.Za=function(){this.C!=null&&(this.C=null,Oi(this),ou(this),Or(19))};function Mi(g){g.C!=null&&(u.clearTimeout(g.C),g.C=null)}function Ch(g,S){var D=null;if(g.g==S){Mi(g),cu(g),g.g=null;var X=2}else if(Tt(g.h,S))D=S.D,qn(g.h,S),X=1;else return;if(g.G!=0){if(S.o)if(X==1){D=S.m?S.m.length:0,S=Date.now()-S.F;var ye=g.B;X=ns(),$t(X,new le(X,D)),zo(g)}else Ah(g);else if(ye=S.s,ye==3||ye==0&&0<S.X||!(X==1&&Dm(g,S)||X==2&&ou(g)))switch(D&&0<D.length&&(S=g.h,S.i=S.i.concat(D)),ye){case 1:qs(g,5);break;case 4:qs(g,10);break;case 3:qs(g,6);break;default:qs(g,2)}}}function kh(g,S){let D=g.Ta+Math.floor(Math.random()*g.cb);return g.isActive()||(D*=2),D*S}function qs(g,S){if(g.j.info("Error code "+S),S==2){var D=_(g.fb,g),X=g.Xa;const ye=!X;X=new zs(X||"//www.google.com/images/cleardot.gif"),u.location&&u.location.protocol=="http"||Ni(X,"https"),Ol(X),ye?au(X.toString(),D):_h(X.toString(),D)}else Or(2);g.G=0,g.l&&g.l.sa(S),uu(g),bh(g)}t.fb=function(g){g?(this.j.info("Successfully pinged google.com"),Or(2)):(this.j.info("Failed to ping google.com"),Or(1))};function uu(g){if(g.G=0,g.ka=[],g.l){const S=mn(g.h);(S.length!=0||g.i.length!=0)&&(A(g.ka,S),A(g.ka,g.i),g.h.i.length=0,T(g.i),g.i.length=0),g.l.ra()}}function Rh(g,S,D){var X=D instanceof zs?Ar(D):new zs(D);if(X.g!="")S&&(X.g=S+"."+X.g),Il(X,X.s);else{var ye=u.location;X=ye.protocol,S=S?S+"."+ye.hostname:ye.hostname,ye=+ye.port;var Re=new zs(null);X&&Ni(Re,X),S&&(Re.g=S),ye&&Il(Re,ye),D&&(Re.l=D),X=Re}return D=g.D,S=g.ya,D&&S&&qt(X,D,S),qt(X,"VER",g.la),Ll(g,X),X}function Dh(g,S,D){if(S&&!g.J)throw Error("Can't create secondary domain capable XhrIo object.");return S=g.Ca&&!g.pa?new mr(new Ts({eb:D})):new mr(g.pa),S.Ha(g.J),S}t.isActive=function(){return!!this.l&&this.l.isActive(this)};function Ih(){}t=Ih.prototype,t.ua=function(){},t.ta=function(){},t.sa=function(){},t.ra=function(){},t.isActive=function(){return!0},t.Na=function(){};function Ho(){}Ho.prototype.g=function(g,S){return new Kn(g,S)};function Kn(g,S){kt.call(this),this.g=new Eh(S),this.l=g,this.h=S&&S.messageUrlParams||null,g=S&&S.messageHeaders||null,S&&S.clientProtocolHeaderRequired&&(g?g["X-Client-Protocol"]="webchannel":g={"X-Client-Protocol":"webchannel"}),this.g.o=g,g=S&&S.initMessageHeaders||null,S&&S.messageContentType&&(g?g["X-WebChannel-Content-Type"]=S.messageContentType:g={"X-WebChannel-Content-Type":S.messageContentType}),S&&S.va&&(g?g["X-WebChannel-Client-Profile"]=S.va:g={"X-WebChannel-Client-Profile":S.va}),this.g.S=g,(g=S&&S.Sb)&&!F(g)&&(this.g.m=g),this.v=S&&S.supportsCrossDomainXhr||!1,this.u=S&&S.sendRawJson||!1,(S=S&&S.httpSessionIdParam)&&!F(S)&&(this.g.D=S,g=this.h,g!==null&&S in g&&(g=this.h,S in g&&delete g[S])),this.j=new ji(this)}E(Kn,kt),Kn.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},Kn.prototype.close=function(){iu(this.g)},Kn.prototype.o=function(g){var S=this.g;if(typeof g=="string"){var D={};D.__data__=g,g=D}else this.u&&(D={},D.__data__=nn(g),g=D);S.i.push(new xt(S.Ya++,g)),S.G==3&&zo(S)},Kn.prototype.N=function(){this.g.l=null,delete this.j,iu(this.g),delete this.g,Kn.aa.N.call(this)};function Oh(g){na.call(this),g.__headers__&&(this.headers=g.__headers__,this.statusCode=g.__status__,delete g.__headers__,delete g.__status__);var S=g.__sm__;if(S){e:{for(const D in S){g=D;break e}g=void 0}(this.i=g)&&(g=this.i,S=S!==null&&g in S?S[g]:void 0),this.data=S}else this.data=g}E(Oh,na);function Mh(){an.call(this),this.status=1}E(Mh,an);function ji(g){this.g=g}E(ji,Ih),ji.prototype.ua=function(){$t(this.g,"a")},ji.prototype.ta=function(g){$t(this.g,new Oh(g))},ji.prototype.sa=function(g){$t(this.g,new Mh)},ji.prototype.ra=function(){$t(this.g,"b")},Ho.prototype.createWebChannel=Ho.prototype.g,Kn.prototype.send=Kn.prototype.o,Kn.prototype.open=Kn.prototype.m,Kn.prototype.close=Kn.prototype.close,CS=function(){return new Ho},NS=function(){return ns()},AS=dn,xx={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},H.NO_ERROR=0,H.TIMEOUT=8,H.HTTP_ERROR=6,l0=H,W.COMPLETE="complete",SS=W,ga.EventType=Nn,Nn.OPEN="a",Nn.CLOSE="b",Nn.ERROR="c",Nn.MESSAGE="d",kt.prototype.listen=kt.prototype.K,ef=ga,mr.prototype.listenOnce=mr.prototype.L,mr.prototype.getLastError=mr.prototype.Ka,mr.prototype.getLastErrorCode=mr.prototype.Ba,mr.prototype.getStatus=mr.prototype.Z,mr.prototype.getResponseJson=mr.prototype.Oa,mr.prototype.getResponseText=mr.prototype.oa,mr.prototype.send=mr.prototype.ea,mr.prototype.setWithCredentials=mr.prototype.Ha,bS=mr}).apply(typeof Bd<"u"?Bd:typeof self<"u"?self:typeof window<"u"?window:{});const cT="@firebase/firestore";class On{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}On.UNAUTHENTICATED=new On(null),On.GOOGLE_CREDENTIALS=new On("google-credentials-uid"),On.FIRST_PARTY=new On("first-party-uid"),On.MOCK_USER=new On("mock-user");let Yc="10.14.0";const vo=new av("@firebase/firestore");function Qu(){return vo.logLevel}function et(t,...e){if(vo.logLevel<=jt.DEBUG){const r=e.map(xv);vo.debug(`Firestore (${Yc}): ${t}`,...r)}}function wi(t,...e){if(vo.logLevel<=jt.ERROR){const r=e.map(xv);vo.error(`Firestore (${Yc}): ${t}`,...r)}}function Pc(t,...e){if(vo.logLevel<=jt.WARN){const r=e.map(xv);vo.warn(`Firestore (${Yc}): ${t}`,...r)}}function xv(t){if(typeof t=="string")return t;try{return(function(r){return JSON.stringify(r)})(t)}catch{return t}}function ct(t="Unexpected state"){const e=`FIRESTORE (${Yc}) INTERNAL ASSERTION FAILED: `+t;throw wi(e),new Error(e)}function ar(t,e){t||ct()}function mt(t,e){return t}const Le={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Je extends _s{constructor(e,r){super(e,r),this.code=e,this.message=r,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class mi{constructor(){this.promise=new Promise(((e,r)=>{this.resolve=e,this.reject=r}))}}class kS{constructor(e,r){this.user=r,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class nM{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,r){e.enqueueRetryable((()=>r(On.UNAUTHENTICATED)))}shutdown(){}}class aM{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,r){this.changeListener=r,e.enqueueRetryable((()=>r(this.token.user)))}shutdown(){this.changeListener=null}}class sM{constructor(e){this.t=e,this.currentUser=On.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,r){ar(this.o===void 0);let n=this.i;const a=h=>this.i!==n?(n=this.i,r(h)):Promise.resolve();let l=new mi;this.o=()=>{this.i++,this.currentUser=this.u(),l.resolve(),l=new mi,e.enqueueRetryable((()=>a(this.currentUser)))};const o=()=>{const h=l;e.enqueueRetryable((async()=>{await h.promise,await a(this.currentUser)}))},u=h=>{et("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=h,this.o&&(this.auth.addAuthTokenListener(this.o),o())};this.t.onInit((h=>u(h))),setTimeout((()=>{if(!this.auth){const h=this.t.getImmediate({optional:!0});h?u(h):(et("FirebaseAuthCredentialsProvider","Auth not yet detected"),l.resolve(),l=new mi)}}),0),o()}getToken(){const e=this.i,r=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(r).then((n=>this.i!==e?(et("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):n?(ar(typeof n.accessToken=="string"),new kS(n.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return ar(e===null||typeof e=="string"),new On(e)}}class iM{constructor(e,r,n){this.l=e,this.h=r,this.P=n,this.type="FirstParty",this.user=On.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);const e=this.T();return e&&this.I.set("Authorization",e),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}}class lM{constructor(e,r,n){this.l=e,this.h=r,this.P=n}getToken(){return Promise.resolve(new iM(this.l,this.h,this.P))}start(e,r){e.enqueueRetryable((()=>r(On.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class oM{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class cM{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,r){ar(this.o===void 0);const n=l=>{l.error!=null&&et("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${l.error.message}`);const o=l.token!==this.R;return this.R=l.token,et("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?r(l.token):Promise.resolve()};this.o=l=>{e.enqueueRetryable((()=>n(l)))};const a=l=>{et("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=l,this.o&&this.appCheck.addTokenListener(this.o)};this.A.onInit((l=>a(l))),setTimeout((()=>{if(!this.appCheck){const l=this.A.getImmediate({optional:!0});l?a(l):et("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then((r=>r?(ar(typeof r.token=="string"),this.R=r.token,new oM(r.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}function uM(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),r=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(r);else for(let n=0;n<t;n++)r[n]=Math.floor(256*Math.random());return r}class RS{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",r=Math.floor(256/e.length)*e.length;let n="";for(;n.length<20;){const a=uM(40);for(let l=0;l<a.length;++l)n.length<20&&a[l]<r&&(n+=e.charAt(a[l]%e.length))}return n}}function Yt(t,e){return t<e?-1:t>e?1:0}function Lc(t,e,r){return t.length===e.length&&t.every(((n,a)=>r(n,e[a])))}class tn{constructor(e,r){if(this.seconds=e,this.nanoseconds=r,r<0)throw new Je(Le.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+r);if(r>=1e9)throw new Je(Le.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+r);if(e<-62135596800)throw new Je(Le.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new Je(Le.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return tn.fromMillis(Date.now())}static fromDate(e){return tn.fromMillis(e.getTime())}static fromMillis(e){const r=Math.floor(e/1e3),n=Math.floor(1e6*(e-1e3*r));return new tn(r,n)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?Yt(this.nanoseconds,e.nanoseconds):Yt(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}class ht{constructor(e){this.timestamp=e}static fromTimestamp(e){return new ht(e)}static min(){return new ht(new tn(0,0))}static max(){return new ht(new tn(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}class Rf{constructor(e,r,n){r===void 0?r=0:r>e.length&&ct(),n===void 0?n=e.length-r:n>e.length-r&&ct(),this.segments=e,this.offset=r,this.len=n}get length(){return this.len}isEqual(e){return Rf.comparator(this,e)===0}child(e){const r=this.segments.slice(this.offset,this.limit());return e instanceof Rf?e.forEach((n=>{r.push(n)})):r.push(e),this.construct(r)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let r=0;r<this.length;r++)if(this.get(r)!==e.get(r))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let r=0;r<this.length;r++)if(this.get(r)!==e.get(r))return!1;return!0}forEach(e){for(let r=this.offset,n=this.limit();r<n;r++)e(this.segments[r])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,r){const n=Math.min(e.length,r.length);for(let a=0;a<n;a++){const l=e.get(a),o=r.get(a);if(l<o)return-1;if(l>o)return 1}return e.length<r.length?-1:e.length>r.length?1:0}}class xr extends Rf{construct(e,r,n){return new xr(e,r,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const r=[];for(const n of e){if(n.indexOf("//")>=0)throw new Je(Le.INVALID_ARGUMENT,`Invalid segment (${n}). Paths must not contain // in them.`);r.push(...n.split("/").filter((a=>a.length>0)))}return new xr(r)}static emptyPath(){return new xr([])}}const fM=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class wn extends Rf{construct(e,r,n){return new wn(e,r,n)}static isValidIdentifier(e){return fM.test(e)}canonicalString(){return this.toArray().map((e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),wn.isValidIdentifier(e)||(e="`"+e+"`"),e))).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new wn(["__name__"])}static fromServerFormat(e){const r=[];let n="",a=0;const l=()=>{if(n.length===0)throw new Je(Le.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);r.push(n),n=""};let o=!1;for(;a<e.length;){const u=e[a];if(u==="\\"){if(a+1===e.length)throw new Je(Le.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const h=e[a+1];if(h!=="\\"&&h!=="."&&h!=="`")throw new Je(Le.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);n+=h,a+=2}else u==="`"?(o=!o,a++):u!=="."||o?(n+=u,a++):(l(),a++)}if(l(),o)throw new Je(Le.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new wn(r)}static emptyPath(){return new wn([])}}class at{constructor(e){this.path=e}static fromPath(e){return new at(xr.fromString(e))}static fromName(e){return new at(xr.fromString(e).popFirst(5))}static empty(){return new at(xr.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&xr.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,r){return xr.comparator(e.path,r.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new at(new xr(e.slice()))}}function hM(t,e){const r=t.toTimestamp().seconds,n=t.toTimestamp().nanoseconds+1,a=ht.fromTimestamp(n===1e9?new tn(r+1,0):new tn(r,n));return new El(a,at.empty(),e)}function dM(t){return new El(t.readTime,t.key,-1)}class El{constructor(e,r,n){this.readTime=e,this.documentKey=r,this.largestBatchId=n}static min(){return new El(ht.min(),at.empty(),-1)}static max(){return new El(ht.max(),at.empty(),-1)}}function mM(t,e){let r=t.readTime.compareTo(e.readTime);return r!==0?r:(r=at.comparator(t.documentKey,e.documentKey),r!==0?r:Yt(t.largestBatchId,e.largestBatchId))}const pM="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class gM{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((e=>e()))}}async function th(t){if(t.code!==Le.FAILED_PRECONDITION||t.message!==pM)throw t;et("LocalStore","Unexpectedly lost primary lease")}class ze{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e((r=>{this.isDone=!0,this.result=r,this.nextCallback&&this.nextCallback(r)}),(r=>{this.isDone=!0,this.error=r,this.catchCallback&&this.catchCallback(r)}))}catch(e){return this.next(void 0,e)}next(e,r){return this.callbackAttached&&ct(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(r,this.error):this.wrapSuccess(e,this.result):new ze(((n,a)=>{this.nextCallback=l=>{this.wrapSuccess(e,l).next(n,a)},this.catchCallback=l=>{this.wrapFailure(r,l).next(n,a)}}))}toPromise(){return new Promise(((e,r)=>{this.next(e,r)}))}wrapUserFunction(e){try{const r=e();return r instanceof ze?r:ze.resolve(r)}catch(r){return ze.reject(r)}}wrapSuccess(e,r){return e?this.wrapUserFunction((()=>e(r))):ze.resolve(r)}wrapFailure(e,r){return e?this.wrapUserFunction((()=>e(r))):ze.reject(r)}static resolve(e){return new ze(((r,n)=>{r(e)}))}static reject(e){return new ze(((r,n)=>{n(e)}))}static waitFor(e){return new ze(((r,n)=>{let a=0,l=0,o=!1;e.forEach((u=>{++a,u.next((()=>{++l,o&&l===a&&r()}),(h=>n(h)))})),o=!0,l===a&&r()}))}static or(e){let r=ze.resolve(!1);for(const n of e)r=r.next((a=>a?ze.resolve(a):n()));return r}static forEach(e,r){const n=[];return e.forEach(((a,l)=>{n.push(r.call(this,a,l))})),this.waitFor(n)}static mapArray(e,r){return new ze(((n,a)=>{const l=e.length,o=new Array(l);let u=0;for(let h=0;h<l;h++){const m=h;r(e[m]).next((p=>{o[m]=p,++u,u===l&&n(o)}),(p=>a(p)))}}))}static doWhile(e,r){return new ze(((n,a)=>{const l=()=>{e()===!0?r().next((()=>{l()}),a):n()};l()}))}}function xM(t){const e=t.match(/Android ([\d.]+)/i),r=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(r)}function rh(t){return t.name==="IndexedDbTransactionError"}class vv{constructor(e,r){this.previousValue=e,r&&(r.sequenceNumberHandler=n=>this.ie(n),this.se=n=>r.writeSequenceNumber(n))}ie(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.se&&this.se(e),e}}vv.oe=-1;function tm(t){return t==null}function A0(t){return t===0&&1/t==-1/0}function vM(t){return typeof t=="number"&&Number.isInteger(t)&&!A0(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}function uT(t){let e=0;for(const r in t)Object.prototype.hasOwnProperty.call(t,r)&&e++;return e}function Ao(t,e){for(const r in t)Object.prototype.hasOwnProperty.call(t,r)&&e(r,t[r])}function DS(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}class br{constructor(e,r){this.comparator=e,this.root=r||yn.EMPTY}insert(e,r){return new br(this.comparator,this.root.insert(e,r,this.comparator).copy(null,null,yn.BLACK,null,null))}remove(e){return new br(this.comparator,this.root.remove(e,this.comparator).copy(null,null,yn.BLACK,null,null))}get(e){let r=this.root;for(;!r.isEmpty();){const n=this.comparator(e,r.key);if(n===0)return r.value;n<0?r=r.left:n>0&&(r=r.right)}return null}indexOf(e){let r=0,n=this.root;for(;!n.isEmpty();){const a=this.comparator(e,n.key);if(a===0)return r+n.left.size;a<0?n=n.left:(r+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal(((r,n)=>(e(r,n),!1)))}toString(){const e=[];return this.inorderTraversal(((r,n)=>(e.push(`${r}:${n}`),!1))),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Vd(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Vd(this.root,e,this.comparator,!1)}getReverseIterator(){return new Vd(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Vd(this.root,e,this.comparator,!0)}}class Vd{constructor(e,r,n,a){this.isReverse=a,this.nodeStack=[];let l=1;for(;!e.isEmpty();)if(l=r?n(e.key,r):1,r&&a&&(l*=-1),l<0)e=this.isReverse?e.left:e.right;else{if(l===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const r={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return r}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class yn{constructor(e,r,n,a,l){this.key=e,this.value=r,this.color=n??yn.RED,this.left=a??yn.EMPTY,this.right=l??yn.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,r,n,a,l){return new yn(e??this.key,r??this.value,n??this.color,a??this.left,l??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,r,n){let a=this;const l=n(e,a.key);return a=l<0?a.copy(null,null,null,a.left.insert(e,r,n),null):l===0?a.copy(null,r,null,null,null):a.copy(null,null,null,null,a.right.insert(e,r,n)),a.fixUp()}removeMin(){if(this.left.isEmpty())return yn.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,r){let n,a=this;if(r(e,a.key)<0)a.left.isEmpty()||a.left.isRed()||a.left.left.isRed()||(a=a.moveRedLeft()),a=a.copy(null,null,null,a.left.remove(e,r),null);else{if(a.left.isRed()&&(a=a.rotateRight()),a.right.isEmpty()||a.right.isRed()||a.right.left.isRed()||(a=a.moveRedRight()),r(e,a.key)===0){if(a.right.isEmpty())return yn.EMPTY;n=a.right.min(),a=a.copy(n.key,n.value,null,null,a.right.removeMin())}a=a.copy(null,null,null,null,a.right.remove(e,r))}return a.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,yn.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,yn.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),r=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,r)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw ct();const e=this.left.check();if(e!==this.right.check())throw ct();return e+(this.isRed()?0:1)}}yn.EMPTY=null,yn.RED=!0,yn.BLACK=!1;yn.EMPTY=new class{constructor(){this.size=0}get key(){throw ct()}get value(){throw ct()}get color(){throw ct()}get left(){throw ct()}get right(){throw ct()}copy(e,r,n,a,l){return this}insert(e,r,n){return new yn(e,r)}remove(e,r){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class Tn{constructor(e){this.comparator=e,this.data=new br(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal(((r,n)=>(e(r),!1)))}forEachInRange(e,r){const n=this.data.getIteratorFrom(e[0]);for(;n.hasNext();){const a=n.getNext();if(this.comparator(a.key,e[1])>=0)return;r(a.key)}}forEachWhile(e,r){let n;for(n=r!==void 0?this.data.getIteratorFrom(r):this.data.getIterator();n.hasNext();)if(!e(n.getNext().key))return}firstAfterOrEqual(e){const r=this.data.getIteratorFrom(e);return r.hasNext()?r.getNext().key:null}getIterator(){return new fT(this.data.getIterator())}getIteratorFrom(e){return new fT(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let r=this;return r.size<e.size&&(r=e,e=this),e.forEach((n=>{r=r.add(n)})),r}isEqual(e){if(!(e instanceof Tn)||this.size!==e.size)return!1;const r=this.data.getIterator(),n=e.data.getIterator();for(;r.hasNext();){const a=r.getNext().key,l=n.getNext().key;if(this.comparator(a,l)!==0)return!1}return!0}toArray(){const e=[];return this.forEach((r=>{e.push(r)})),e}toString(){const e=[];return this.forEach((r=>e.push(r))),"SortedSet("+e.toString()+")"}copy(e){const r=new Tn(this.comparator);return r.data=e,r}}class fT{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}class ka{constructor(e){this.fields=e,e.sort(wn.comparator)}static empty(){return new ka([])}unionWith(e){let r=new Tn(wn.comparator);for(const n of this.fields)r=r.add(n);for(const n of e)r=r.add(n);return new ka(r.toArray())}covers(e){for(const r of this.fields)if(r.isPrefixOf(e))return!0;return!1}isEqual(e){return Lc(this.fields,e.fields,((r,n)=>r.isEqual(n)))}}class IS extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}class Sn{constructor(e){this.binaryString=e}static fromBase64String(e){const r=(function(a){try{return atob(a)}catch(l){throw typeof DOMException<"u"&&l instanceof DOMException?new IS("Invalid base64 string: "+l):l}})(e);return new Sn(r)}static fromUint8Array(e){const r=(function(a){let l="";for(let o=0;o<a.length;++o)l+=String.fromCharCode(a[o]);return l})(e);return new Sn(r)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return(function(r){return btoa(r)})(this.binaryString)}toUint8Array(){return(function(r){const n=new Uint8Array(r.length);for(let a=0;a<r.length;a++)n[a]=r.charCodeAt(a);return n})(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Yt(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Sn.EMPTY_BYTE_STRING=new Sn("");const yM=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function bl(t){if(ar(!!t),typeof t=="string"){let e=0;const r=yM.exec(t);if(ar(!!r),r[1]){let a=r[1];a=(a+"000000000").substr(0,9),e=Number(a)}const n=new Date(t);return{seconds:Math.floor(n.getTime()/1e3),nanos:e}}return{seconds:Lr(t.seconds),nanos:Lr(t.nanos)}}function Lr(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function yo(t){return typeof t=="string"?Sn.fromBase64String(t):Sn.fromUint8Array(t)}function yv(t){var e,r;return((r=(((e=t?.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||r===void 0?void 0:r.stringValue)==="server_timestamp"}function _v(t){const e=t.mapValue.fields.__previous_value__;return yv(e)?_v(e):e}function Df(t){const e=bl(t.mapValue.fields.__local_write_time__.timestampValue);return new tn(e.seconds,e.nanos)}class _M{constructor(e,r,n,a,l,o,u,h,m){this.databaseId=e,this.appId=r,this.persistenceKey=n,this.host=a,this.ssl=l,this.forceLongPolling=o,this.autoDetectLongPolling=u,this.longPollingOptions=h,this.useFetchStreams=m}}class If{constructor(e,r){this.projectId=e,this.database=r||"(default)"}static empty(){return new If("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(e){return e instanceof If&&e.projectId===this.projectId&&e.database===this.database}}const zd={mapValue:{}};function _o(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?yv(t)?4:TM(t)?9007199254740991:wM(t)?10:11:ct()}function Ps(t,e){if(t===e)return!0;const r=_o(t);if(r!==_o(e))return!1;switch(r){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return Df(t).isEqual(Df(e));case 3:return(function(a,l){if(typeof a.timestampValue=="string"&&typeof l.timestampValue=="string"&&a.timestampValue.length===l.timestampValue.length)return a.timestampValue===l.timestampValue;const o=bl(a.timestampValue),u=bl(l.timestampValue);return o.seconds===u.seconds&&o.nanos===u.nanos})(t,e);case 5:return t.stringValue===e.stringValue;case 6:return(function(a,l){return yo(a.bytesValue).isEqual(yo(l.bytesValue))})(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return(function(a,l){return Lr(a.geoPointValue.latitude)===Lr(l.geoPointValue.latitude)&&Lr(a.geoPointValue.longitude)===Lr(l.geoPointValue.longitude)})(t,e);case 2:return(function(a,l){if("integerValue"in a&&"integerValue"in l)return Lr(a.integerValue)===Lr(l.integerValue);if("doubleValue"in a&&"doubleValue"in l){const o=Lr(a.doubleValue),u=Lr(l.doubleValue);return o===u?A0(o)===A0(u):isNaN(o)&&isNaN(u)}return!1})(t,e);case 9:return Lc(t.arrayValue.values||[],e.arrayValue.values||[],Ps);case 10:case 11:return(function(a,l){const o=a.mapValue.fields||{},u=l.mapValue.fields||{};if(uT(o)!==uT(u))return!1;for(const h in o)if(o.hasOwnProperty(h)&&(u[h]===void 0||!Ps(o[h],u[h])))return!1;return!0})(t,e);default:return ct()}}function Of(t,e){return(t.values||[]).find((r=>Ps(r,e)))!==void 0}function Uc(t,e){if(t===e)return 0;const r=_o(t),n=_o(e);if(r!==n)return Yt(r,n);switch(r){case 0:case 9007199254740991:return 0;case 1:return Yt(t.booleanValue,e.booleanValue);case 2:return(function(l,o){const u=Lr(l.integerValue||l.doubleValue),h=Lr(o.integerValue||o.doubleValue);return u<h?-1:u>h?1:u===h?0:isNaN(u)?isNaN(h)?0:-1:1})(t,e);case 3:return hT(t.timestampValue,e.timestampValue);case 4:return hT(Df(t),Df(e));case 5:return Yt(t.stringValue,e.stringValue);case 6:return(function(l,o){const u=yo(l),h=yo(o);return u.compareTo(h)})(t.bytesValue,e.bytesValue);case 7:return(function(l,o){const u=l.split("/"),h=o.split("/");for(let m=0;m<u.length&&m<h.length;m++){const p=Yt(u[m],h[m]);if(p!==0)return p}return Yt(u.length,h.length)})(t.referenceValue,e.referenceValue);case 8:return(function(l,o){const u=Yt(Lr(l.latitude),Lr(o.latitude));return u!==0?u:Yt(Lr(l.longitude),Lr(o.longitude))})(t.geoPointValue,e.geoPointValue);case 9:return dT(t.arrayValue,e.arrayValue);case 10:return(function(l,o){var u,h,m,p;const v=l.fields||{},_=o.fields||{},w=(u=v.value)===null||u===void 0?void 0:u.arrayValue,E=(h=_.value)===null||h===void 0?void 0:h.arrayValue,T=Yt(((m=w?.values)===null||m===void 0?void 0:m.length)||0,((p=E?.values)===null||p===void 0?void 0:p.length)||0);return T!==0?T:dT(w,E)})(t.mapValue,e.mapValue);case 11:return(function(l,o){if(l===zd.mapValue&&o===zd.mapValue)return 0;if(l===zd.mapValue)return 1;if(o===zd.mapValue)return-1;const u=l.fields||{},h=Object.keys(u),m=o.fields||{},p=Object.keys(m);h.sort(),p.sort();for(let v=0;v<h.length&&v<p.length;++v){const _=Yt(h[v],p[v]);if(_!==0)return _;const w=Uc(u[h[v]],m[p[v]]);if(w!==0)return w}return Yt(h.length,p.length)})(t.mapValue,e.mapValue);default:throw ct()}}function hT(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return Yt(t,e);const r=bl(t),n=bl(e),a=Yt(r.seconds,n.seconds);return a!==0?a:Yt(r.nanos,n.nanos)}function dT(t,e){const r=t.values||[],n=e.values||[];for(let a=0;a<r.length&&a<n.length;++a){const l=Uc(r[a],n[a]);if(l)return l}return Yt(r.length,n.length)}function Bc(t){return vx(t)}function vx(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?(function(r){const n=bl(r);return`time(${n.seconds},${n.nanos})`})(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?(function(r){return yo(r).toBase64()})(t.bytesValue):"referenceValue"in t?(function(r){return at.fromName(r).toString()})(t.referenceValue):"geoPointValue"in t?(function(r){return`geo(${r.latitude},${r.longitude})`})(t.geoPointValue):"arrayValue"in t?(function(r){let n="[",a=!0;for(const l of r.values||[])a?a=!1:n+=",",n+=vx(l);return n+"]"})(t.arrayValue):"mapValue"in t?(function(r){const n=Object.keys(r.fields||{}).sort();let a="{",l=!0;for(const o of n)l?l=!1:a+=",",a+=`${o}:${vx(r.fields[o])}`;return a+"}"})(t.mapValue):ct()}function mT(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function yx(t){return!!t&&"integerValue"in t}function wv(t){return!!t&&"arrayValue"in t}function pT(t){return!!t&&"nullValue"in t}function gT(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function o0(t){return!!t&&"mapValue"in t}function wM(t){var e,r;return((r=(((e=t?.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||r===void 0?void 0:r.stringValue)==="__vector__"}function uf(t){if(t.geoPointValue)return{geoPointValue:Object.assign({},t.geoPointValue)};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:Object.assign({},t.timestampValue)};if(t.mapValue){const e={mapValue:{fields:{}}};return Ao(t.mapValue.fields,((r,n)=>e.mapValue.fields[r]=uf(n))),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let r=0;r<(t.arrayValue.values||[]).length;++r)e.arrayValue.values[r]=uf(t.arrayValue.values[r]);return e}return Object.assign({},t)}function TM(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}class ma{constructor(e){this.value=e}static empty(){return new ma({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let r=this.value;for(let n=0;n<e.length-1;++n)if(r=(r.mapValue.fields||{})[e.get(n)],!o0(r))return null;return r=(r.mapValue.fields||{})[e.lastSegment()],r||null}}set(e,r){this.getFieldsMap(e.popLast())[e.lastSegment()]=uf(r)}setAll(e){let r=wn.emptyPath(),n={},a=[];e.forEach(((o,u)=>{if(!r.isImmediateParentOf(u)){const h=this.getFieldsMap(r);this.applyChanges(h,n,a),n={},a=[],r=u.popLast()}o?n[u.lastSegment()]=uf(o):a.push(u.lastSegment())}));const l=this.getFieldsMap(r);this.applyChanges(l,n,a)}delete(e){const r=this.field(e.popLast());o0(r)&&r.mapValue.fields&&delete r.mapValue.fields[e.lastSegment()]}isEqual(e){return Ps(this.value,e.value)}getFieldsMap(e){let r=this.value;r.mapValue.fields||(r.mapValue={fields:{}});for(let n=0;n<e.length;++n){let a=r.mapValue.fields[e.get(n)];o0(a)&&a.mapValue.fields||(a={mapValue:{fields:{}}},r.mapValue.fields[e.get(n)]=a),r=a}return r.mapValue.fields}applyChanges(e,r,n){Ao(r,((a,l)=>e[a]=l));for(const a of n)delete e[a]}clone(){return new ma(uf(this.value))}}function OS(t){const e=[];return Ao(t.fields,((r,n)=>{const a=new wn([r]);if(o0(n)){const l=OS(n.mapValue).fields;if(l.length===0)e.push(a);else for(const o of l)e.push(a.child(o))}else e.push(a)})),new ka(e)}class jn{constructor(e,r,n,a,l,o,u){this.key=e,this.documentType=r,this.version=n,this.readTime=a,this.createTime=l,this.data=o,this.documentState=u}static newInvalidDocument(e){return new jn(e,0,ht.min(),ht.min(),ht.min(),ma.empty(),0)}static newFoundDocument(e,r,n,a){return new jn(e,1,r,ht.min(),n,a,0)}static newNoDocument(e,r){return new jn(e,2,r,ht.min(),ht.min(),ma.empty(),0)}static newUnknownDocument(e,r){return new jn(e,3,r,ht.min(),ht.min(),ma.empty(),2)}convertToFoundDocument(e,r){return!this.createTime.isEqual(ht.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=r,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=ma.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=ma.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=ht.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof jn&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new jn(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class N0{constructor(e,r){this.position=e,this.inclusive=r}}function xT(t,e,r){let n=0;for(let a=0;a<t.position.length;a++){const l=e[a],o=t.position[a];if(l.field.isKeyField()?n=at.comparator(at.fromName(o.referenceValue),r.key):n=Uc(o,r.data.field(l.field)),l.dir==="desc"&&(n*=-1),n!==0)break}return n}function vT(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let r=0;r<t.position.length;r++)if(!Ps(t.position[r],e.position[r]))return!1;return!0}class C0{constructor(e,r="asc"){this.field=e,this.dir=r}}function EM(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}class MS{}class Qr extends MS{constructor(e,r,n){super(),this.field=e,this.op=r,this.value=n}static create(e,r,n){return e.isKeyField()?r==="in"||r==="not-in"?this.createKeyFieldInFilter(e,r,n):new SM(e,r,n):r==="array-contains"?new CM(e,n):r==="in"?new kM(e,n):r==="not-in"?new RM(e,n):r==="array-contains-any"?new DM(e,n):new Qr(e,r,n)}static createKeyFieldInFilter(e,r,n){return r==="in"?new AM(e,n):new NM(e,n)}matches(e){const r=e.data.field(this.field);return this.op==="!="?r!==null&&this.matchesComparison(Uc(r,this.value)):r!==null&&_o(this.value)===_o(r)&&this.matchesComparison(Uc(r,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return ct()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class vs extends MS{constructor(e,r){super(),this.filters=e,this.op=r,this.ae=null}static create(e,r){return new vs(e,r)}matches(e){return jS(this)?this.filters.find((r=>!r.matches(e)))===void 0:this.filters.find((r=>r.matches(e)))!==void 0}getFlattenedFilters(){return this.ae!==null||(this.ae=this.filters.reduce(((e,r)=>e.concat(r.getFlattenedFilters())),[])),this.ae}getFilters(){return Object.assign([],this.filters)}}function jS(t){return t.op==="and"}function FS(t){return bM(t)&&jS(t)}function bM(t){for(const e of t.filters)if(e instanceof vs)return!1;return!0}function _x(t){if(t instanceof Qr)return t.field.canonicalString()+t.op.toString()+Bc(t.value);if(FS(t))return t.filters.map((e=>_x(e))).join(",");{const e=t.filters.map((r=>_x(r))).join(",");return`${t.op}(${e})`}}function PS(t,e){return t instanceof Qr?(function(n,a){return a instanceof Qr&&n.op===a.op&&n.field.isEqual(a.field)&&Ps(n.value,a.value)})(t,e):t instanceof vs?(function(n,a){return a instanceof vs&&n.op===a.op&&n.filters.length===a.filters.length?n.filters.reduce(((l,o,u)=>l&&PS(o,a.filters[u])),!0):!1})(t,e):void ct()}function LS(t){return t instanceof Qr?(function(r){return`${r.field.canonicalString()} ${r.op} ${Bc(r.value)}`})(t):t instanceof vs?(function(r){return r.op.toString()+" {"+r.getFilters().map(LS).join(" ,")+"}"})(t):"Filter"}class SM extends Qr{constructor(e,r,n){super(e,r,n),this.key=at.fromName(n.referenceValue)}matches(e){const r=at.comparator(e.key,this.key);return this.matchesComparison(r)}}class AM extends Qr{constructor(e,r){super(e,"in",r),this.keys=US("in",r)}matches(e){return this.keys.some((r=>r.isEqual(e.key)))}}class NM extends Qr{constructor(e,r){super(e,"not-in",r),this.keys=US("not-in",r)}matches(e){return!this.keys.some((r=>r.isEqual(e.key)))}}function US(t,e){var r;return(((r=e.arrayValue)===null||r===void 0?void 0:r.values)||[]).map((n=>at.fromName(n.referenceValue)))}class CM extends Qr{constructor(e,r){super(e,"array-contains",r)}matches(e){const r=e.data.field(this.field);return wv(r)&&Of(r.arrayValue,this.value)}}class kM extends Qr{constructor(e,r){super(e,"in",r)}matches(e){const r=e.data.field(this.field);return r!==null&&Of(this.value.arrayValue,r)}}class RM extends Qr{constructor(e,r){super(e,"not-in",r)}matches(e){if(Of(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const r=e.data.field(this.field);return r!==null&&!Of(this.value.arrayValue,r)}}class DM extends Qr{constructor(e,r){super(e,"array-contains-any",r)}matches(e){const r=e.data.field(this.field);return!(!wv(r)||!r.arrayValue.values)&&r.arrayValue.values.some((n=>Of(this.value.arrayValue,n)))}}class IM{constructor(e,r=null,n=[],a=[],l=null,o=null,u=null){this.path=e,this.collectionGroup=r,this.orderBy=n,this.filters=a,this.limit=l,this.startAt=o,this.endAt=u,this.ue=null}}function yT(t,e=null,r=[],n=[],a=null,l=null,o=null){return new IM(t,e,r,n,a,l,o)}function Tv(t){const e=mt(t);if(e.ue===null){let r=e.path.canonicalString();e.collectionGroup!==null&&(r+="|cg:"+e.collectionGroup),r+="|f:",r+=e.filters.map((n=>_x(n))).join(","),r+="|ob:",r+=e.orderBy.map((n=>(function(l){return l.field.canonicalString()+l.dir})(n))).join(","),tm(e.limit)||(r+="|l:",r+=e.limit),e.startAt&&(r+="|lb:",r+=e.startAt.inclusive?"b:":"a:",r+=e.startAt.position.map((n=>Bc(n))).join(",")),e.endAt&&(r+="|ub:",r+=e.endAt.inclusive?"a:":"b:",r+=e.endAt.position.map((n=>Bc(n))).join(",")),e.ue=r}return e.ue}function Ev(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let r=0;r<t.orderBy.length;r++)if(!EM(t.orderBy[r],e.orderBy[r]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let r=0;r<t.filters.length;r++)if(!PS(t.filters[r],e.filters[r]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!vT(t.startAt,e.startAt)&&vT(t.endAt,e.endAt)}function wx(t){return at.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}class nh{constructor(e,r=null,n=[],a=[],l=null,o="F",u=null,h=null){this.path=e,this.collectionGroup=r,this.explicitOrderBy=n,this.filters=a,this.limit=l,this.limitType=o,this.startAt=u,this.endAt=h,this.ce=null,this.le=null,this.he=null,this.startAt,this.endAt}}function OM(t,e,r,n,a,l,o,u){return new nh(t,e,r,n,a,l,o,u)}function rm(t){return new nh(t)}function _T(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function BS(t){return t.collectionGroup!==null}function ff(t){const e=mt(t);if(e.ce===null){e.ce=[];const r=new Set;for(const l of e.explicitOrderBy)e.ce.push(l),r.add(l.field.canonicalString());const n=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let u=new Tn(wn.comparator);return o.filters.forEach((h=>{h.getFlattenedFilters().forEach((m=>{m.isInequality()&&(u=u.add(m.field))}))})),u})(e).forEach((l=>{r.has(l.canonicalString())||l.isKeyField()||e.ce.push(new C0(l,n))})),r.has(wn.keyField().canonicalString())||e.ce.push(new C0(wn.keyField(),n))}return e.ce}function Ms(t){const e=mt(t);return e.le||(e.le=MM(e,ff(t))),e.le}function MM(t,e){if(t.limitType==="F")return yT(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map((a=>{const l=a.dir==="desc"?"asc":"desc";return new C0(a.field,l)}));const r=t.endAt?new N0(t.endAt.position,t.endAt.inclusive):null,n=t.startAt?new N0(t.startAt.position,t.startAt.inclusive):null;return yT(t.path,t.collectionGroup,e,t.filters,t.limit,r,n)}}function Tx(t,e){const r=t.filters.concat([e]);return new nh(t.path,t.collectionGroup,t.explicitOrderBy.slice(),r,t.limit,t.limitType,t.startAt,t.endAt)}function Ex(t,e,r){return new nh(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,r,t.startAt,t.endAt)}function nm(t,e){return Ev(Ms(t),Ms(e))&&t.limitType===e.limitType}function VS(t){return`${Tv(Ms(t))}|lt:${t.limitType}`}function _c(t){return`Query(target=${(function(r){let n=r.path.canonicalString();return r.collectionGroup!==null&&(n+=" collectionGroup="+r.collectionGroup),r.filters.length>0&&(n+=`, filters: [${r.filters.map((a=>LS(a))).join(", ")}]`),tm(r.limit)||(n+=", limit: "+r.limit),r.orderBy.length>0&&(n+=`, orderBy: [${r.orderBy.map((a=>(function(o){return`${o.field.canonicalString()} (${o.dir})`})(a))).join(", ")}]`),r.startAt&&(n+=", startAt: ",n+=r.startAt.inclusive?"b:":"a:",n+=r.startAt.position.map((a=>Bc(a))).join(",")),r.endAt&&(n+=", endAt: ",n+=r.endAt.inclusive?"a:":"b:",n+=r.endAt.position.map((a=>Bc(a))).join(",")),`Target(${n})`})(Ms(t))}; limitType=${t.limitType})`}function am(t,e){return e.isFoundDocument()&&(function(n,a){const l=a.key.path;return n.collectionGroup!==null?a.key.hasCollectionId(n.collectionGroup)&&n.path.isPrefixOf(l):at.isDocumentKey(n.path)?n.path.isEqual(l):n.path.isImmediateParentOf(l)})(t,e)&&(function(n,a){for(const l of ff(n))if(!l.field.isKeyField()&&a.data.field(l.field)===null)return!1;return!0})(t,e)&&(function(n,a){for(const l of n.filters)if(!l.matches(a))return!1;return!0})(t,e)&&(function(n,a){return!(n.startAt&&!(function(o,u,h){const m=xT(o,u,h);return o.inclusive?m<=0:m<0})(n.startAt,ff(n),a)||n.endAt&&!(function(o,u,h){const m=xT(o,u,h);return o.inclusive?m>=0:m>0})(n.endAt,ff(n),a))})(t,e)}function jM(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function zS(t){return(e,r)=>{let n=!1;for(const a of ff(t)){const l=FM(a,e,r);if(l!==0)return l;n=n||a.field.isKeyField()}return 0}}function FM(t,e,r){const n=t.field.isKeyField()?at.comparator(e.key,r.key):(function(l,o,u){const h=o.data.field(l),m=u.data.field(l);return h!==null&&m!==null?Uc(h,m):ct()})(t.field,e,r);switch(t.dir){case"asc":return n;case"desc":return-1*n;default:return ct()}}class $c{constructor(e,r){this.mapKeyFn=e,this.equalsFn=r,this.inner={},this.innerSize=0}get(e){const r=this.mapKeyFn(e),n=this.inner[r];if(n!==void 0){for(const[a,l]of n)if(this.equalsFn(a,e))return l}}has(e){return this.get(e)!==void 0}set(e,r){const n=this.mapKeyFn(e),a=this.inner[n];if(a===void 0)return this.inner[n]=[[e,r]],void this.innerSize++;for(let l=0;l<a.length;l++)if(this.equalsFn(a[l][0],e))return void(a[l]=[e,r]);a.push([e,r]),this.innerSize++}delete(e){const r=this.mapKeyFn(e),n=this.inner[r];if(n===void 0)return!1;for(let a=0;a<n.length;a++)if(this.equalsFn(n[a][0],e))return n.length===1?delete this.inner[r]:n.splice(a,1),this.innerSize--,!0;return!1}forEach(e){Ao(this.inner,((r,n)=>{for(const[a,l]of n)e(a,l)}))}isEmpty(){return DS(this.inner)}size(){return this.innerSize}}const PM=new br(at.comparator);function Ti(){return PM}const HS=new br(at.comparator);function tf(...t){let e=HS;for(const r of t)e=e.insert(r.key,r);return e}function GS(t){let e=HS;return t.forEach(((r,n)=>e=e.insert(r,n.overlayedDocument))),e}function lo(){return hf()}function qS(){return hf()}function hf(){return new $c((t=>t.toString()),((t,e)=>t.isEqual(e)))}const LM=new br(at.comparator),UM=new Tn(at.comparator);function Ot(...t){let e=UM;for(const r of t)e=e.add(r);return e}const BM=new Tn(Yt);function VM(){return BM}function bv(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:A0(e)?"-0":e}}function WS(t){return{integerValue:""+t}}function KS(t,e){return vM(e)?WS(e):bv(t,e)}class sm{constructor(){this._=void 0}}function zM(t,e,r){return t instanceof Mf?(function(a,l){const o={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:a.seconds,nanos:a.nanoseconds}}}};return l&&yv(l)&&(l=_v(l)),l&&(o.fields.__previous_value__=l),{mapValue:o}})(r,e):t instanceof jf?$S(t,e):t instanceof Ff?XS(t,e):(function(a,l){const o=YS(a,l),u=wT(o)+wT(a.Pe);return yx(o)&&yx(a.Pe)?WS(u):bv(a.serializer,u)})(t,e)}function HM(t,e,r){return t instanceof jf?$S(t,e):t instanceof Ff?XS(t,e):r}function YS(t,e){return t instanceof Pf?(function(n){return yx(n)||(function(l){return!!l&&"doubleValue"in l})(n)})(e)?e:{integerValue:0}:null}class Mf extends sm{}class jf extends sm{constructor(e){super(),this.elements=e}}function $S(t,e){const r=QS(e);for(const n of t.elements)r.some((a=>Ps(a,n)))||r.push(n);return{arrayValue:{values:r}}}class Ff extends sm{constructor(e){super(),this.elements=e}}function XS(t,e){let r=QS(e);for(const n of t.elements)r=r.filter((a=>!Ps(a,n)));return{arrayValue:{values:r}}}class Pf extends sm{constructor(e,r){super(),this.serializer=e,this.Pe=r}}function wT(t){return Lr(t.integerValue||t.doubleValue)}function QS(t){return wv(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}class JS{constructor(e,r){this.field=e,this.transform=r}}function GM(t,e){return t.field.isEqual(e.field)&&(function(n,a){return n instanceof jf&&a instanceof jf||n instanceof Ff&&a instanceof Ff?Lc(n.elements,a.elements,Ps):n instanceof Pf&&a instanceof Pf?Ps(n.Pe,a.Pe):n instanceof Mf&&a instanceof Mf})(t.transform,e.transform)}class qM{constructor(e,r){this.version=e,this.transformResults=r}}class Za{constructor(e,r){this.updateTime=e,this.exists=r}static none(){return new Za}static exists(e){return new Za(void 0,e)}static updateTime(e){return new Za(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function c0(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class im{}function ZS(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new Sv(t.key,Za.none()):new ah(t.key,t.data,Za.none());{const r=t.data,n=ma.empty();let a=new Tn(wn.comparator);for(let l of e.fields)if(!a.has(l)){let o=r.field(l);o===null&&l.length>1&&(l=l.popLast(),o=r.field(l)),o===null?n.delete(l):n.set(l,o),a=a.add(l)}return new kl(t.key,n,new ka(a.toArray()),Za.none())}}function WM(t,e,r){t instanceof ah?(function(a,l,o){const u=a.value.clone(),h=ET(a.fieldTransforms,l,o.transformResults);u.setAll(h),l.convertToFoundDocument(o.version,u).setHasCommittedMutations()})(t,e,r):t instanceof kl?(function(a,l,o){if(!c0(a.precondition,l))return void l.convertToUnknownDocument(o.version);const u=ET(a.fieldTransforms,l,o.transformResults),h=l.data;h.setAll(eA(a)),h.setAll(u),l.convertToFoundDocument(o.version,h).setHasCommittedMutations()})(t,e,r):(function(a,l,o){l.convertToNoDocument(o.version).setHasCommittedMutations()})(0,e,r)}function df(t,e,r,n){return t instanceof ah?(function(l,o,u,h){if(!c0(l.precondition,o))return u;const m=l.value.clone(),p=bT(l.fieldTransforms,h,o);return m.setAll(p),o.convertToFoundDocument(o.version,m).setHasLocalMutations(),null})(t,e,r,n):t instanceof kl?(function(l,o,u,h){if(!c0(l.precondition,o))return u;const m=bT(l.fieldTransforms,h,o),p=o.data;return p.setAll(eA(l)),p.setAll(m),o.convertToFoundDocument(o.version,p).setHasLocalMutations(),u===null?null:u.unionWith(l.fieldMask.fields).unionWith(l.fieldTransforms.map((v=>v.field)))})(t,e,r,n):(function(l,o,u){return c0(l.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):u})(t,e,r)}function KM(t,e){let r=null;for(const n of t.fieldTransforms){const a=e.data.field(n.field),l=YS(n.transform,a||null);l!=null&&(r===null&&(r=ma.empty()),r.set(n.field,l))}return r||null}function TT(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!(function(n,a){return n===void 0&&a===void 0||!(!n||!a)&&Lc(n,a,((l,o)=>GM(l,o)))})(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class ah extends im{constructor(e,r,n,a=[]){super(),this.key=e,this.value=r,this.precondition=n,this.fieldTransforms=a,this.type=0}getFieldMask(){return null}}class kl extends im{constructor(e,r,n,a,l=[]){super(),this.key=e,this.data=r,this.fieldMask=n,this.precondition=a,this.fieldTransforms=l,this.type=1}getFieldMask(){return this.fieldMask}}function eA(t){const e=new Map;return t.fieldMask.fields.forEach((r=>{if(!r.isEmpty()){const n=t.data.field(r);e.set(r,n)}})),e}function ET(t,e,r){const n=new Map;ar(t.length===r.length);for(let a=0;a<r.length;a++){const l=t[a],o=l.transform,u=e.data.field(l.field);n.set(l.field,HM(o,u,r[a]))}return n}function bT(t,e,r){const n=new Map;for(const a of t){const l=a.transform,o=r.data.field(a.field);n.set(a.field,zM(l,o,e))}return n}class Sv extends im{constructor(e,r){super(),this.key=e,this.precondition=r,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class YM extends im{constructor(e,r){super(),this.key=e,this.precondition=r,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class $M{constructor(e,r,n,a){this.batchId=e,this.localWriteTime=r,this.baseMutations=n,this.mutations=a}applyToRemoteDocument(e,r){const n=r.mutationResults;for(let a=0;a<this.mutations.length;a++){const l=this.mutations[a];l.key.isEqual(e.key)&&WM(l,e,n[a])}}applyToLocalView(e,r){for(const n of this.baseMutations)n.key.isEqual(e.key)&&(r=df(n,e,r,this.localWriteTime));for(const n of this.mutations)n.key.isEqual(e.key)&&(r=df(n,e,r,this.localWriteTime));return r}applyToLocalDocumentSet(e,r){const n=qS();return this.mutations.forEach((a=>{const l=e.get(a.key),o=l.overlayedDocument;let u=this.applyToLocalView(o,l.mutatedFields);u=r.has(a.key)?null:u;const h=ZS(o,u);h!==null&&n.set(a.key,h),o.isValidDocument()||o.convertToNoDocument(ht.min())})),n}keys(){return this.mutations.reduce(((e,r)=>e.add(r.key)),Ot())}isEqual(e){return this.batchId===e.batchId&&Lc(this.mutations,e.mutations,((r,n)=>TT(r,n)))&&Lc(this.baseMutations,e.baseMutations,((r,n)=>TT(r,n)))}}class Av{constructor(e,r,n,a){this.batch=e,this.commitVersion=r,this.mutationResults=n,this.docVersions=a}static from(e,r,n){ar(e.mutations.length===n.length);let a=(function(){return LM})();const l=e.mutations;for(let o=0;o<l.length;o++)a=a.insert(l[o].key,n[o].version);return new Av(e,r,n,a)}}class XM{constructor(e,r){this.largestBatchId=e,this.mutation=r}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}class QM{constructor(e,r){this.count=e,this.unchangedNames=r}}var Kr,Vt;function JM(t){switch(t){default:return ct();case Le.CANCELLED:case Le.UNKNOWN:case Le.DEADLINE_EXCEEDED:case Le.RESOURCE_EXHAUSTED:case Le.INTERNAL:case Le.UNAVAILABLE:case Le.UNAUTHENTICATED:return!1;case Le.INVALID_ARGUMENT:case Le.NOT_FOUND:case Le.ALREADY_EXISTS:case Le.PERMISSION_DENIED:case Le.FAILED_PRECONDITION:case Le.ABORTED:case Le.OUT_OF_RANGE:case Le.UNIMPLEMENTED:case Le.DATA_LOSS:return!0}}function tA(t){if(t===void 0)return wi("GRPC error has no .code"),Le.UNKNOWN;switch(t){case Kr.OK:return Le.OK;case Kr.CANCELLED:return Le.CANCELLED;case Kr.UNKNOWN:return Le.UNKNOWN;case Kr.DEADLINE_EXCEEDED:return Le.DEADLINE_EXCEEDED;case Kr.RESOURCE_EXHAUSTED:return Le.RESOURCE_EXHAUSTED;case Kr.INTERNAL:return Le.INTERNAL;case Kr.UNAVAILABLE:return Le.UNAVAILABLE;case Kr.UNAUTHENTICATED:return Le.UNAUTHENTICATED;case Kr.INVALID_ARGUMENT:return Le.INVALID_ARGUMENT;case Kr.NOT_FOUND:return Le.NOT_FOUND;case Kr.ALREADY_EXISTS:return Le.ALREADY_EXISTS;case Kr.PERMISSION_DENIED:return Le.PERMISSION_DENIED;case Kr.FAILED_PRECONDITION:return Le.FAILED_PRECONDITION;case Kr.ABORTED:return Le.ABORTED;case Kr.OUT_OF_RANGE:return Le.OUT_OF_RANGE;case Kr.UNIMPLEMENTED:return Le.UNIMPLEMENTED;case Kr.DATA_LOSS:return Le.DATA_LOSS;default:return ct()}}(Vt=Kr||(Kr={}))[Vt.OK=0]="OK",Vt[Vt.CANCELLED=1]="CANCELLED",Vt[Vt.UNKNOWN=2]="UNKNOWN",Vt[Vt.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Vt[Vt.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Vt[Vt.NOT_FOUND=5]="NOT_FOUND",Vt[Vt.ALREADY_EXISTS=6]="ALREADY_EXISTS",Vt[Vt.PERMISSION_DENIED=7]="PERMISSION_DENIED",Vt[Vt.UNAUTHENTICATED=16]="UNAUTHENTICATED",Vt[Vt.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Vt[Vt.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Vt[Vt.ABORTED=10]="ABORTED",Vt[Vt.OUT_OF_RANGE=11]="OUT_OF_RANGE",Vt[Vt.UNIMPLEMENTED=12]="UNIMPLEMENTED",Vt[Vt.INTERNAL=13]="INTERNAL",Vt[Vt.UNAVAILABLE=14]="UNAVAILABLE",Vt[Vt.DATA_LOSS=15]="DATA_LOSS";function ZM(){return new TextEncoder}const e6=new uo([4294967295,4294967295],0);function ST(t){const e=ZM().encode(t),r=new ES;return r.update(e),new Uint8Array(r.digest())}function AT(t){const e=new DataView(t.buffer),r=e.getUint32(0,!0),n=e.getUint32(4,!0),a=e.getUint32(8,!0),l=e.getUint32(12,!0);return[new uo([r,n],0),new uo([a,l],0)]}class Nv{constructor(e,r,n){if(this.bitmap=e,this.padding=r,this.hashCount=n,r<0||r>=8)throw new rf(`Invalid padding: ${r}`);if(n<0)throw new rf(`Invalid hash count: ${n}`);if(e.length>0&&this.hashCount===0)throw new rf(`Invalid hash count: ${n}`);if(e.length===0&&r!==0)throw new rf(`Invalid padding when bitmap length is 0: ${r}`);this.Ie=8*e.length-r,this.Te=uo.fromNumber(this.Ie)}Ee(e,r,n){let a=e.add(r.multiply(uo.fromNumber(n)));return a.compare(e6)===1&&(a=new uo([a.getBits(0),a.getBits(1)],0)),a.modulo(this.Te).toNumber()}de(e){return(this.bitmap[Math.floor(e/8)]&1<<e%8)!=0}mightContain(e){if(this.Ie===0)return!1;const r=ST(e),[n,a]=AT(r);for(let l=0;l<this.hashCount;l++){const o=this.Ee(n,a,l);if(!this.de(o))return!1}return!0}static create(e,r,n){const a=e%8==0?0:8-e%8,l=new Uint8Array(Math.ceil(e/8)),o=new Nv(l,a,r);return n.forEach((u=>o.insert(u))),o}insert(e){if(this.Ie===0)return;const r=ST(e),[n,a]=AT(r);for(let l=0;l<this.hashCount;l++){const o=this.Ee(n,a,l);this.Ae(o)}}Ae(e){const r=Math.floor(e/8),n=e%8;this.bitmap[r]|=1<<n}}class rf extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}class lm{constructor(e,r,n,a,l){this.snapshotVersion=e,this.targetChanges=r,this.targetMismatches=n,this.documentUpdates=a,this.resolvedLimboDocuments=l}static createSynthesizedRemoteEventForCurrentChange(e,r,n){const a=new Map;return a.set(e,sh.createSynthesizedTargetChangeForCurrentChange(e,r,n)),new lm(ht.min(),a,new br(Yt),Ti(),Ot())}}class sh{constructor(e,r,n,a,l){this.resumeToken=e,this.current=r,this.addedDocuments=n,this.modifiedDocuments=a,this.removedDocuments=l}static createSynthesizedTargetChangeForCurrentChange(e,r,n){return new sh(n,r,Ot(),Ot(),Ot())}}class u0{constructor(e,r,n,a){this.Re=e,this.removedTargetIds=r,this.key=n,this.Ve=a}}class rA{constructor(e,r){this.targetId=e,this.me=r}}class nA{constructor(e,r,n=Sn.EMPTY_BYTE_STRING,a=null){this.state=e,this.targetIds=r,this.resumeToken=n,this.cause=a}}class NT{constructor(){this.fe=0,this.ge=kT(),this.pe=Sn.EMPTY_BYTE_STRING,this.ye=!1,this.we=!0}get current(){return this.ye}get resumeToken(){return this.pe}get Se(){return this.fe!==0}get be(){return this.we}De(e){e.approximateByteSize()>0&&(this.we=!0,this.pe=e)}ve(){let e=Ot(),r=Ot(),n=Ot();return this.ge.forEach(((a,l)=>{switch(l){case 0:e=e.add(a);break;case 2:r=r.add(a);break;case 1:n=n.add(a);break;default:ct()}})),new sh(this.pe,this.ye,e,r,n)}Ce(){this.we=!1,this.ge=kT()}Fe(e,r){this.we=!0,this.ge=this.ge.insert(e,r)}Me(e){this.we=!0,this.ge=this.ge.remove(e)}xe(){this.fe+=1}Oe(){this.fe-=1,ar(this.fe>=0)}Ne(){this.we=!0,this.ye=!0}}class t6{constructor(e){this.Le=e,this.Be=new Map,this.ke=Ti(),this.qe=CT(),this.Qe=new br(Yt)}Ke(e){for(const r of e.Re)e.Ve&&e.Ve.isFoundDocument()?this.$e(r,e.Ve):this.Ue(r,e.key,e.Ve);for(const r of e.removedTargetIds)this.Ue(r,e.key,e.Ve)}We(e){this.forEachTarget(e,(r=>{const n=this.Ge(r);switch(e.state){case 0:this.ze(r)&&n.De(e.resumeToken);break;case 1:n.Oe(),n.Se||n.Ce(),n.De(e.resumeToken);break;case 2:n.Oe(),n.Se||this.removeTarget(r);break;case 3:this.ze(r)&&(n.Ne(),n.De(e.resumeToken));break;case 4:this.ze(r)&&(this.je(r),n.De(e.resumeToken));break;default:ct()}}))}forEachTarget(e,r){e.targetIds.length>0?e.targetIds.forEach(r):this.Be.forEach(((n,a)=>{this.ze(a)&&r(a)}))}He(e){const r=e.targetId,n=e.me.count,a=this.Je(r);if(a){const l=a.target;if(wx(l))if(n===0){const o=new at(l.path);this.Ue(r,o,jn.newNoDocument(o,ht.min()))}else ar(n===1);else{const o=this.Ye(r);if(o!==n){const u=this.Ze(e),h=u?this.Xe(u,e,o):1;if(h!==0){this.je(r);const m=h===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Qe=this.Qe.insert(r,m)}}}}}Ze(e){const r=e.me.unchangedNames;if(!r||!r.bits)return null;const{bits:{bitmap:n="",padding:a=0},hashCount:l=0}=r;let o,u;try{o=yo(n).toUint8Array()}catch(h){if(h instanceof IS)return Pc("Decoding the base64 bloom filter in existence filter failed ("+h.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw h}try{u=new Nv(o,a,l)}catch(h){return Pc(h instanceof rf?"BloomFilter error: ":"Applying bloom filter failed: ",h),null}return u.Ie===0?null:u}Xe(e,r,n){return r.me.count===n-this.nt(e,r.targetId)?0:2}nt(e,r){const n=this.Le.getRemoteKeysForTarget(r);let a=0;return n.forEach((l=>{const o=this.Le.tt(),u=`projects/${o.projectId}/databases/${o.database}/documents/${l.path.canonicalString()}`;e.mightContain(u)||(this.Ue(r,l,null),a++)})),a}rt(e){const r=new Map;this.Be.forEach(((l,o)=>{const u=this.Je(o);if(u){if(l.current&&wx(u.target)){const h=new at(u.target.path);this.ke.get(h)!==null||this.it(o,h)||this.Ue(o,h,jn.newNoDocument(h,e))}l.be&&(r.set(o,l.ve()),l.Ce())}}));let n=Ot();this.qe.forEach(((l,o)=>{let u=!0;o.forEachWhile((h=>{const m=this.Je(h);return!m||m.purpose==="TargetPurposeLimboResolution"||(u=!1,!1)})),u&&(n=n.add(l))})),this.ke.forEach(((l,o)=>o.setReadTime(e)));const a=new lm(e,r,this.Qe,this.ke,n);return this.ke=Ti(),this.qe=CT(),this.Qe=new br(Yt),a}$e(e,r){if(!this.ze(e))return;const n=this.it(e,r.key)?2:0;this.Ge(e).Fe(r.key,n),this.ke=this.ke.insert(r.key,r),this.qe=this.qe.insert(r.key,this.st(r.key).add(e))}Ue(e,r,n){if(!this.ze(e))return;const a=this.Ge(e);this.it(e,r)?a.Fe(r,1):a.Me(r),this.qe=this.qe.insert(r,this.st(r).delete(e)),n&&(this.ke=this.ke.insert(r,n))}removeTarget(e){this.Be.delete(e)}Ye(e){const r=this.Ge(e).ve();return this.Le.getRemoteKeysForTarget(e).size+r.addedDocuments.size-r.removedDocuments.size}xe(e){this.Ge(e).xe()}Ge(e){let r=this.Be.get(e);return r||(r=new NT,this.Be.set(e,r)),r}st(e){let r=this.qe.get(e);return r||(r=new Tn(Yt),this.qe=this.qe.insert(e,r)),r}ze(e){const r=this.Je(e)!==null;return r||et("WatchChangeAggregator","Detected inactive target",e),r}Je(e){const r=this.Be.get(e);return r&&r.Se?null:this.Le.ot(e)}je(e){this.Be.set(e,new NT),this.Le.getRemoteKeysForTarget(e).forEach((r=>{this.Ue(e,r,null)}))}it(e,r){return this.Le.getRemoteKeysForTarget(e).has(r)}}function CT(){return new br(at.comparator)}function kT(){return new br(at.comparator)}const r6={asc:"ASCENDING",desc:"DESCENDING"},n6={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},a6={and:"AND",or:"OR"};class s6{constructor(e,r){this.databaseId=e,this.useProto3Json=r}}function bx(t,e){return t.useProto3Json||tm(e)?e:{value:e}}function k0(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function aA(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function i6(t,e){return k0(t,e.toTimestamp())}function js(t){return ar(!!t),ht.fromTimestamp((function(r){const n=bl(r);return new tn(n.seconds,n.nanos)})(t))}function Cv(t,e){return Sx(t,e).canonicalString()}function Sx(t,e){const r=(function(a){return new xr(["projects",a.projectId,"databases",a.database])})(t).child("documents");return e===void 0?r:r.child(e)}function sA(t){const e=xr.fromString(t);return ar(uA(e)),e}function Ax(t,e){return Cv(t.databaseId,e.path)}function Vg(t,e){const r=sA(e);if(r.get(1)!==t.databaseId.projectId)throw new Je(Le.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+r.get(1)+" vs "+t.databaseId.projectId);if(r.get(3)!==t.databaseId.database)throw new Je(Le.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+r.get(3)+" vs "+t.databaseId.database);return new at(lA(r))}function iA(t,e){return Cv(t.databaseId,e)}function l6(t){const e=sA(t);return e.length===4?xr.emptyPath():lA(e)}function Nx(t){return new xr(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function lA(t){return ar(t.length>4&&t.get(4)==="documents"),t.popFirst(5)}function RT(t,e,r){return{name:Ax(t,e),fields:r.value.mapValue.fields}}function o6(t,e){let r;if("targetChange"in e){e.targetChange;const n=(function(m){return m==="NO_CHANGE"?0:m==="ADD"?1:m==="REMOVE"?2:m==="CURRENT"?3:m==="RESET"?4:ct()})(e.targetChange.targetChangeType||"NO_CHANGE"),a=e.targetChange.targetIds||[],l=(function(m,p){return m.useProto3Json?(ar(p===void 0||typeof p=="string"),Sn.fromBase64String(p||"")):(ar(p===void 0||p instanceof Buffer||p instanceof Uint8Array),Sn.fromUint8Array(p||new Uint8Array))})(t,e.targetChange.resumeToken),o=e.targetChange.cause,u=o&&(function(m){const p=m.code===void 0?Le.UNKNOWN:tA(m.code);return new Je(p,m.message||"")})(o);r=new nA(n,a,l,u||null)}else if("documentChange"in e){e.documentChange;const n=e.documentChange;n.document,n.document.name,n.document.updateTime;const a=Vg(t,n.document.name),l=js(n.document.updateTime),o=n.document.createTime?js(n.document.createTime):ht.min(),u=new ma({mapValue:{fields:n.document.fields}}),h=jn.newFoundDocument(a,l,o,u),m=n.targetIds||[],p=n.removedTargetIds||[];r=new u0(m,p,h.key,h)}else if("documentDelete"in e){e.documentDelete;const n=e.documentDelete;n.document;const a=Vg(t,n.document),l=n.readTime?js(n.readTime):ht.min(),o=jn.newNoDocument(a,l),u=n.removedTargetIds||[];r=new u0([],u,o.key,o)}else if("documentRemove"in e){e.documentRemove;const n=e.documentRemove;n.document;const a=Vg(t,n.document),l=n.removedTargetIds||[];r=new u0([],l,a,null)}else{if(!("filter"in e))return ct();{e.filter;const n=e.filter;n.targetId;const{count:a=0,unchangedNames:l}=n,o=new QM(a,l),u=n.targetId;r=new rA(u,o)}}return r}function c6(t,e){let r;if(e instanceof ah)r={update:RT(t,e.key,e.value)};else if(e instanceof Sv)r={delete:Ax(t,e.key)};else if(e instanceof kl)r={update:RT(t,e.key,e.data),updateMask:v6(e.fieldMask)};else{if(!(e instanceof YM))return ct();r={verify:Ax(t,e.key)}}return e.fieldTransforms.length>0&&(r.updateTransforms=e.fieldTransforms.map((n=>(function(l,o){const u=o.transform;if(u instanceof Mf)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(u instanceof jf)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:u.elements}};if(u instanceof Ff)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:u.elements}};if(u instanceof Pf)return{fieldPath:o.field.canonicalString(),increment:u.Pe};throw ct()})(0,n)))),e.precondition.isNone||(r.currentDocument=(function(a,l){return l.updateTime!==void 0?{updateTime:i6(a,l.updateTime)}:l.exists!==void 0?{exists:l.exists}:ct()})(t,e.precondition)),r}function u6(t,e){return t&&t.length>0?(ar(e!==void 0),t.map((r=>(function(a,l){let o=a.updateTime?js(a.updateTime):js(l);return o.isEqual(ht.min())&&(o=js(l)),new qM(o,a.transformResults||[])})(r,e)))):[]}function f6(t,e){return{documents:[iA(t,e.path)]}}function h6(t,e){const r={structuredQuery:{}},n=e.path;let a;e.collectionGroup!==null?(a=n,r.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(a=n.popLast(),r.structuredQuery.from=[{collectionId:n.lastSegment()}]),r.parent=iA(t,a);const l=(function(m){if(m.length!==0)return cA(vs.create(m,"and"))})(e.filters);l&&(r.structuredQuery.where=l);const o=(function(m){if(m.length!==0)return m.map((p=>(function(_){return{field:wc(_.field),direction:p6(_.dir)}})(p)))})(e.orderBy);o&&(r.structuredQuery.orderBy=o);const u=bx(t,e.limit);return u!==null&&(r.structuredQuery.limit=u),e.startAt&&(r.structuredQuery.startAt=(function(m){return{before:m.inclusive,values:m.position}})(e.startAt)),e.endAt&&(r.structuredQuery.endAt=(function(m){return{before:!m.inclusive,values:m.position}})(e.endAt)),{_t:r,parent:a}}function d6(t){let e=l6(t.parent);const r=t.structuredQuery,n=r.from?r.from.length:0;let a=null;if(n>0){ar(n===1);const p=r.from[0];p.allDescendants?a=p.collectionId:e=e.child(p.collectionId)}let l=[];r.where&&(l=(function(v){const _=oA(v);return _ instanceof vs&&FS(_)?_.getFilters():[_]})(r.where));let o=[];r.orderBy&&(o=(function(v){return v.map((_=>(function(E){return new C0(Tc(E.field),(function(A){switch(A){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}})(E.direction))})(_)))})(r.orderBy));let u=null;r.limit&&(u=(function(v){let _;return _=typeof v=="object"?v.value:v,tm(_)?null:_})(r.limit));let h=null;r.startAt&&(h=(function(v){const _=!!v.before,w=v.values||[];return new N0(w,_)})(r.startAt));let m=null;return r.endAt&&(m=(function(v){const _=!v.before,w=v.values||[];return new N0(w,_)})(r.endAt)),OM(e,a,o,l,u,"F",h,m)}function m6(t,e){const r=(function(a){switch(a){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return ct()}})(e.purpose);return r==null?null:{"goog-listen-tags":r}}function oA(t){return t.unaryFilter!==void 0?(function(r){switch(r.unaryFilter.op){case"IS_NAN":const n=Tc(r.unaryFilter.field);return Qr.create(n,"==",{doubleValue:NaN});case"IS_NULL":const a=Tc(r.unaryFilter.field);return Qr.create(a,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const l=Tc(r.unaryFilter.field);return Qr.create(l,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const o=Tc(r.unaryFilter.field);return Qr.create(o,"!=",{nullValue:"NULL_VALUE"});default:return ct()}})(t):t.fieldFilter!==void 0?(function(r){return Qr.create(Tc(r.fieldFilter.field),(function(a){switch(a){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return ct()}})(r.fieldFilter.op),r.fieldFilter.value)})(t):t.compositeFilter!==void 0?(function(r){return vs.create(r.compositeFilter.filters.map((n=>oA(n))),(function(a){switch(a){case"AND":return"and";case"OR":return"or";default:return ct()}})(r.compositeFilter.op))})(t):ct()}function p6(t){return r6[t]}function g6(t){return n6[t]}function x6(t){return a6[t]}function wc(t){return{fieldPath:t.canonicalString()}}function Tc(t){return wn.fromServerFormat(t.fieldPath)}function cA(t){return t instanceof Qr?(function(r){if(r.op==="=="){if(gT(r.value))return{unaryFilter:{field:wc(r.field),op:"IS_NAN"}};if(pT(r.value))return{unaryFilter:{field:wc(r.field),op:"IS_NULL"}}}else if(r.op==="!="){if(gT(r.value))return{unaryFilter:{field:wc(r.field),op:"IS_NOT_NAN"}};if(pT(r.value))return{unaryFilter:{field:wc(r.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:wc(r.field),op:g6(r.op),value:r.value}}})(t):t instanceof vs?(function(r){const n=r.getFilters().map((a=>cA(a)));return n.length===1?n[0]:{compositeFilter:{op:x6(r.op),filters:n}}})(t):ct()}function v6(t){const e=[];return t.fields.forEach((r=>e.push(r.canonicalString()))),{fieldPaths:e}}function uA(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}class pl{constructor(e,r,n,a,l=ht.min(),o=ht.min(),u=Sn.EMPTY_BYTE_STRING,h=null){this.target=e,this.targetId=r,this.purpose=n,this.sequenceNumber=a,this.snapshotVersion=l,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=u,this.expectedCount=h}withSequenceNumber(e){return new pl(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,r){return new pl(this.target,this.targetId,this.purpose,this.sequenceNumber,r,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new pl(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new pl(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}class y6{constructor(e){this.ct=e}}function _6(t){const e=d6({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?Ex(e,e.limit,"L"):e}class w6{constructor(){this.un=new T6}addToCollectionParentIndex(e,r){return this.un.add(r),ze.resolve()}getCollectionParents(e,r){return ze.resolve(this.un.getEntries(r))}addFieldIndex(e,r){return ze.resolve()}deleteFieldIndex(e,r){return ze.resolve()}deleteAllFieldIndexes(e){return ze.resolve()}createTargetIndexes(e,r){return ze.resolve()}getDocumentsMatchingTarget(e,r){return ze.resolve(null)}getIndexType(e,r){return ze.resolve(0)}getFieldIndexes(e,r){return ze.resolve([])}getNextCollectionGroupToUpdate(e){return ze.resolve(null)}getMinOffset(e,r){return ze.resolve(El.min())}getMinOffsetFromCollectionGroup(e,r){return ze.resolve(El.min())}updateCollectionGroup(e,r,n){return ze.resolve()}updateIndexEntries(e,r){return ze.resolve()}}class T6{constructor(){this.index={}}add(e){const r=e.lastSegment(),n=e.popLast(),a=this.index[r]||new Tn(xr.comparator),l=!a.has(n);return this.index[r]=a.add(n),l}has(e){const r=e.lastSegment(),n=e.popLast(),a=this.index[r];return a&&a.has(n)}getEntries(e){return(this.index[e]||new Tn(xr.comparator)).toArray()}}class Vc{constructor(e){this.Ln=e}next(){return this.Ln+=2,this.Ln}static Bn(){return new Vc(0)}static kn(){return new Vc(-1)}}class E6{constructor(){this.changes=new $c((e=>e.toString()),((e,r)=>e.isEqual(r))),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,r){this.assertNotApplied(),this.changes.set(e,jn.newInvalidDocument(e).setReadTime(r))}getEntry(e,r){this.assertNotApplied();const n=this.changes.get(r);return n!==void 0?ze.resolve(n):this.getFromCache(e,r)}getEntries(e,r){return this.getAllFromCache(e,r)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}class b6{constructor(e,r){this.overlayedDocument=e,this.mutatedFields=r}}class S6{constructor(e,r,n,a){this.remoteDocumentCache=e,this.mutationQueue=r,this.documentOverlayCache=n,this.indexManager=a}getDocument(e,r){let n=null;return this.documentOverlayCache.getOverlay(e,r).next((a=>(n=a,this.remoteDocumentCache.getEntry(e,r)))).next((a=>(n!==null&&df(n.mutation,a,ka.empty(),tn.now()),a)))}getDocuments(e,r){return this.remoteDocumentCache.getEntries(e,r).next((n=>this.getLocalViewOfDocuments(e,n,Ot()).next((()=>n))))}getLocalViewOfDocuments(e,r,n=Ot()){const a=lo();return this.populateOverlays(e,a,r).next((()=>this.computeViews(e,r,a,n).next((l=>{let o=tf();return l.forEach(((u,h)=>{o=o.insert(u,h.overlayedDocument)})),o}))))}getOverlayedDocuments(e,r){const n=lo();return this.populateOverlays(e,n,r).next((()=>this.computeViews(e,r,n,Ot())))}populateOverlays(e,r,n){const a=[];return n.forEach((l=>{r.has(l)||a.push(l)})),this.documentOverlayCache.getOverlays(e,a).next((l=>{l.forEach(((o,u)=>{r.set(o,u)}))}))}computeViews(e,r,n,a){let l=Ti();const o=hf(),u=(function(){return hf()})();return r.forEach(((h,m)=>{const p=n.get(m.key);a.has(m.key)&&(p===void 0||p.mutation instanceof kl)?l=l.insert(m.key,m):p!==void 0?(o.set(m.key,p.mutation.getFieldMask()),df(p.mutation,m,p.mutation.getFieldMask(),tn.now())):o.set(m.key,ka.empty())})),this.recalculateAndSaveOverlays(e,l).next((h=>(h.forEach(((m,p)=>o.set(m,p))),r.forEach(((m,p)=>{var v;return u.set(m,new b6(p,(v=o.get(m))!==null&&v!==void 0?v:null))})),u)))}recalculateAndSaveOverlays(e,r){const n=hf();let a=new br(((o,u)=>o-u)),l=Ot();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,r).next((o=>{for(const u of o)u.keys().forEach((h=>{const m=r.get(h);if(m===null)return;let p=n.get(h)||ka.empty();p=u.applyToLocalView(m,p),n.set(h,p);const v=(a.get(u.batchId)||Ot()).add(h);a=a.insert(u.batchId,v)}))})).next((()=>{const o=[],u=a.getReverseIterator();for(;u.hasNext();){const h=u.getNext(),m=h.key,p=h.value,v=qS();p.forEach((_=>{if(!l.has(_)){const w=ZS(r.get(_),n.get(_));w!==null&&v.set(_,w),l=l.add(_)}})),o.push(this.documentOverlayCache.saveOverlays(e,m,v))}return ze.waitFor(o)})).next((()=>n))}recalculateAndSaveOverlaysForDocumentKeys(e,r){return this.remoteDocumentCache.getEntries(e,r).next((n=>this.recalculateAndSaveOverlays(e,n)))}getDocumentsMatchingQuery(e,r,n,a){return(function(o){return at.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0})(r)?this.getDocumentsMatchingDocumentQuery(e,r.path):BS(r)?this.getDocumentsMatchingCollectionGroupQuery(e,r,n,a):this.getDocumentsMatchingCollectionQuery(e,r,n,a)}getNextDocuments(e,r,n,a){return this.remoteDocumentCache.getAllFromCollectionGroup(e,r,n,a).next((l=>{const o=a-l.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,r,n.largestBatchId,a-l.size):ze.resolve(lo());let u=-1,h=l;return o.next((m=>ze.forEach(m,((p,v)=>(u<v.largestBatchId&&(u=v.largestBatchId),l.get(p)?ze.resolve():this.remoteDocumentCache.getEntry(e,p).next((_=>{h=h.insert(p,_)}))))).next((()=>this.populateOverlays(e,m,l))).next((()=>this.computeViews(e,h,m,Ot()))).next((p=>({batchId:u,changes:GS(p)})))))}))}getDocumentsMatchingDocumentQuery(e,r){return this.getDocument(e,new at(r)).next((n=>{let a=tf();return n.isFoundDocument()&&(a=a.insert(n.key,n)),a}))}getDocumentsMatchingCollectionGroupQuery(e,r,n,a){const l=r.collectionGroup;let o=tf();return this.indexManager.getCollectionParents(e,l).next((u=>ze.forEach(u,(h=>{const m=(function(v,_){return new nh(_,null,v.explicitOrderBy.slice(),v.filters.slice(),v.limit,v.limitType,v.startAt,v.endAt)})(r,h.child(l));return this.getDocumentsMatchingCollectionQuery(e,m,n,a).next((p=>{p.forEach(((v,_)=>{o=o.insert(v,_)}))}))})).next((()=>o))))}getDocumentsMatchingCollectionQuery(e,r,n,a){let l;return this.documentOverlayCache.getOverlaysForCollection(e,r.path,n.largestBatchId).next((o=>(l=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,r,n,l,a)))).next((o=>{l.forEach(((h,m)=>{const p=m.getKey();o.get(p)===null&&(o=o.insert(p,jn.newInvalidDocument(p)))}));let u=tf();return o.forEach(((h,m)=>{const p=l.get(h);p!==void 0&&df(p.mutation,m,ka.empty(),tn.now()),am(r,m)&&(u=u.insert(h,m))})),u}))}}class A6{constructor(e){this.serializer=e,this.hr=new Map,this.Pr=new Map}getBundleMetadata(e,r){return ze.resolve(this.hr.get(r))}saveBundleMetadata(e,r){return this.hr.set(r.id,(function(a){return{id:a.id,version:a.version,createTime:js(a.createTime)}})(r)),ze.resolve()}getNamedQuery(e,r){return ze.resolve(this.Pr.get(r))}saveNamedQuery(e,r){return this.Pr.set(r.name,(function(a){return{name:a.name,query:_6(a.bundledQuery),readTime:js(a.readTime)}})(r)),ze.resolve()}}class N6{constructor(){this.overlays=new br(at.comparator),this.Ir=new Map}getOverlay(e,r){return ze.resolve(this.overlays.get(r))}getOverlays(e,r){const n=lo();return ze.forEach(r,(a=>this.getOverlay(e,a).next((l=>{l!==null&&n.set(a,l)})))).next((()=>n))}saveOverlays(e,r,n){return n.forEach(((a,l)=>{this.ht(e,r,l)})),ze.resolve()}removeOverlaysForBatchId(e,r,n){const a=this.Ir.get(n);return a!==void 0&&(a.forEach((l=>this.overlays=this.overlays.remove(l))),this.Ir.delete(n)),ze.resolve()}getOverlaysForCollection(e,r,n){const a=lo(),l=r.length+1,o=new at(r.child("")),u=this.overlays.getIteratorFrom(o);for(;u.hasNext();){const h=u.getNext().value,m=h.getKey();if(!r.isPrefixOf(m.path))break;m.path.length===l&&h.largestBatchId>n&&a.set(h.getKey(),h)}return ze.resolve(a)}getOverlaysForCollectionGroup(e,r,n,a){let l=new br(((m,p)=>m-p));const o=this.overlays.getIterator();for(;o.hasNext();){const m=o.getNext().value;if(m.getKey().getCollectionGroup()===r&&m.largestBatchId>n){let p=l.get(m.largestBatchId);p===null&&(p=lo(),l=l.insert(m.largestBatchId,p)),p.set(m.getKey(),m)}}const u=lo(),h=l.getIterator();for(;h.hasNext()&&(h.getNext().value.forEach(((m,p)=>u.set(m,p))),!(u.size()>=a)););return ze.resolve(u)}ht(e,r,n){const a=this.overlays.get(n.key);if(a!==null){const o=this.Ir.get(a.largestBatchId).delete(n.key);this.Ir.set(a.largestBatchId,o)}this.overlays=this.overlays.insert(n.key,new XM(r,n));let l=this.Ir.get(r);l===void 0&&(l=Ot(),this.Ir.set(r,l)),this.Ir.set(r,l.add(n.key))}}class C6{constructor(){this.sessionToken=Sn.EMPTY_BYTE_STRING}getSessionToken(e){return ze.resolve(this.sessionToken)}setSessionToken(e,r){return this.sessionToken=r,ze.resolve()}}class kv{constructor(){this.Tr=new Tn(un.Er),this.dr=new Tn(un.Ar)}isEmpty(){return this.Tr.isEmpty()}addReference(e,r){const n=new un(e,r);this.Tr=this.Tr.add(n),this.dr=this.dr.add(n)}Rr(e,r){e.forEach((n=>this.addReference(n,r)))}removeReference(e,r){this.Vr(new un(e,r))}mr(e,r){e.forEach((n=>this.removeReference(n,r)))}gr(e){const r=new at(new xr([])),n=new un(r,e),a=new un(r,e+1),l=[];return this.dr.forEachInRange([n,a],(o=>{this.Vr(o),l.push(o.key)})),l}pr(){this.Tr.forEach((e=>this.Vr(e)))}Vr(e){this.Tr=this.Tr.delete(e),this.dr=this.dr.delete(e)}yr(e){const r=new at(new xr([])),n=new un(r,e),a=new un(r,e+1);let l=Ot();return this.dr.forEachInRange([n,a],(o=>{l=l.add(o.key)})),l}containsKey(e){const r=new un(e,0),n=this.Tr.firstAfterOrEqual(r);return n!==null&&e.isEqual(n.key)}}class un{constructor(e,r){this.key=e,this.wr=r}static Er(e,r){return at.comparator(e.key,r.key)||Yt(e.wr,r.wr)}static Ar(e,r){return Yt(e.wr,r.wr)||at.comparator(e.key,r.key)}}class k6{constructor(e,r){this.indexManager=e,this.referenceDelegate=r,this.mutationQueue=[],this.Sr=1,this.br=new Tn(un.Er)}checkEmpty(e){return ze.resolve(this.mutationQueue.length===0)}addMutationBatch(e,r,n,a){const l=this.Sr;this.Sr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new $M(l,r,n,a);this.mutationQueue.push(o);for(const u of a)this.br=this.br.add(new un(u.key,l)),this.indexManager.addToCollectionParentIndex(e,u.key.path.popLast());return ze.resolve(o)}lookupMutationBatch(e,r){return ze.resolve(this.Dr(r))}getNextMutationBatchAfterBatchId(e,r){const n=r+1,a=this.vr(n),l=a<0?0:a;return ze.resolve(this.mutationQueue.length>l?this.mutationQueue[l]:null)}getHighestUnacknowledgedBatchId(){return ze.resolve(this.mutationQueue.length===0?-1:this.Sr-1)}getAllMutationBatches(e){return ze.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,r){const n=new un(r,0),a=new un(r,Number.POSITIVE_INFINITY),l=[];return this.br.forEachInRange([n,a],(o=>{const u=this.Dr(o.wr);l.push(u)})),ze.resolve(l)}getAllMutationBatchesAffectingDocumentKeys(e,r){let n=new Tn(Yt);return r.forEach((a=>{const l=new un(a,0),o=new un(a,Number.POSITIVE_INFINITY);this.br.forEachInRange([l,o],(u=>{n=n.add(u.wr)}))})),ze.resolve(this.Cr(n))}getAllMutationBatchesAffectingQuery(e,r){const n=r.path,a=n.length+1;let l=n;at.isDocumentKey(l)||(l=l.child(""));const o=new un(new at(l),0);let u=new Tn(Yt);return this.br.forEachWhile((h=>{const m=h.key.path;return!!n.isPrefixOf(m)&&(m.length===a&&(u=u.add(h.wr)),!0)}),o),ze.resolve(this.Cr(u))}Cr(e){const r=[];return e.forEach((n=>{const a=this.Dr(n);a!==null&&r.push(a)})),r}removeMutationBatch(e,r){ar(this.Fr(r.batchId,"removed")===0),this.mutationQueue.shift();let n=this.br;return ze.forEach(r.mutations,(a=>{const l=new un(a.key,r.batchId);return n=n.delete(l),this.referenceDelegate.markPotentiallyOrphaned(e,a.key)})).next((()=>{this.br=n}))}On(e){}containsKey(e,r){const n=new un(r,0),a=this.br.firstAfterOrEqual(n);return ze.resolve(r.isEqual(a&&a.key))}performConsistencyCheck(e){return this.mutationQueue.length,ze.resolve()}Fr(e,r){return this.vr(e)}vr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Dr(e){const r=this.vr(e);return r<0||r>=this.mutationQueue.length?null:this.mutationQueue[r]}}class R6{constructor(e){this.Mr=e,this.docs=(function(){return new br(at.comparator)})(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,r){const n=r.key,a=this.docs.get(n),l=a?a.size:0,o=this.Mr(r);return this.docs=this.docs.insert(n,{document:r.mutableCopy(),size:o}),this.size+=o-l,this.indexManager.addToCollectionParentIndex(e,n.path.popLast())}removeEntry(e){const r=this.docs.get(e);r&&(this.docs=this.docs.remove(e),this.size-=r.size)}getEntry(e,r){const n=this.docs.get(r);return ze.resolve(n?n.document.mutableCopy():jn.newInvalidDocument(r))}getEntries(e,r){let n=Ti();return r.forEach((a=>{const l=this.docs.get(a);n=n.insert(a,l?l.document.mutableCopy():jn.newInvalidDocument(a))})),ze.resolve(n)}getDocumentsMatchingQuery(e,r,n,a){let l=Ti();const o=r.path,u=new at(o.child("")),h=this.docs.getIteratorFrom(u);for(;h.hasNext();){const{key:m,value:{document:p}}=h.getNext();if(!o.isPrefixOf(m.path))break;m.path.length>o.length+1||mM(dM(p),n)<=0||(a.has(p.key)||am(r,p))&&(l=l.insert(p.key,p.mutableCopy()))}return ze.resolve(l)}getAllFromCollectionGroup(e,r,n,a){ct()}Or(e,r){return ze.forEach(this.docs,(n=>r(n)))}newChangeBuffer(e){return new D6(this)}getSize(e){return ze.resolve(this.size)}}class D6 extends E6{constructor(e){super(),this.cr=e}applyChanges(e){const r=[];return this.changes.forEach(((n,a)=>{a.isValidDocument()?r.push(this.cr.addEntry(e,a)):this.cr.removeEntry(n)})),ze.waitFor(r)}getFromCache(e,r){return this.cr.getEntry(e,r)}getAllFromCache(e,r){return this.cr.getEntries(e,r)}}class I6{constructor(e){this.persistence=e,this.Nr=new $c((r=>Tv(r)),Ev),this.lastRemoteSnapshotVersion=ht.min(),this.highestTargetId=0,this.Lr=0,this.Br=new kv,this.targetCount=0,this.kr=Vc.Bn()}forEachTarget(e,r){return this.Nr.forEach(((n,a)=>r(a))),ze.resolve()}getLastRemoteSnapshotVersion(e){return ze.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return ze.resolve(this.Lr)}allocateTargetId(e){return this.highestTargetId=this.kr.next(),ze.resolve(this.highestTargetId)}setTargetsMetadata(e,r,n){return n&&(this.lastRemoteSnapshotVersion=n),r>this.Lr&&(this.Lr=r),ze.resolve()}Kn(e){this.Nr.set(e.target,e);const r=e.targetId;r>this.highestTargetId&&(this.kr=new Vc(r),this.highestTargetId=r),e.sequenceNumber>this.Lr&&(this.Lr=e.sequenceNumber)}addTargetData(e,r){return this.Kn(r),this.targetCount+=1,ze.resolve()}updateTargetData(e,r){return this.Kn(r),ze.resolve()}removeTargetData(e,r){return this.Nr.delete(r.target),this.Br.gr(r.targetId),this.targetCount-=1,ze.resolve()}removeTargets(e,r,n){let a=0;const l=[];return this.Nr.forEach(((o,u)=>{u.sequenceNumber<=r&&n.get(u.targetId)===null&&(this.Nr.delete(o),l.push(this.removeMatchingKeysForTargetId(e,u.targetId)),a++)})),ze.waitFor(l).next((()=>a))}getTargetCount(e){return ze.resolve(this.targetCount)}getTargetData(e,r){const n=this.Nr.get(r)||null;return ze.resolve(n)}addMatchingKeys(e,r,n){return this.Br.Rr(r,n),ze.resolve()}removeMatchingKeys(e,r,n){this.Br.mr(r,n);const a=this.persistence.referenceDelegate,l=[];return a&&r.forEach((o=>{l.push(a.markPotentiallyOrphaned(e,o))})),ze.waitFor(l)}removeMatchingKeysForTargetId(e,r){return this.Br.gr(r),ze.resolve()}getMatchingKeysForTargetId(e,r){const n=this.Br.yr(r);return ze.resolve(n)}containsKey(e,r){return ze.resolve(this.Br.containsKey(r))}}class O6{constructor(e,r){this.qr={},this.overlays={},this.Qr=new vv(0),this.Kr=!1,this.Kr=!0,this.$r=new C6,this.referenceDelegate=e(this),this.Ur=new I6(this),this.indexManager=new w6,this.remoteDocumentCache=(function(a){return new R6(a)})((n=>this.referenceDelegate.Wr(n))),this.serializer=new y6(r),this.Gr=new A6(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.Kr=!1,Promise.resolve()}get started(){return this.Kr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let r=this.overlays[e.toKey()];return r||(r=new N6,this.overlays[e.toKey()]=r),r}getMutationQueue(e,r){let n=this.qr[e.toKey()];return n||(n=new k6(r,this.referenceDelegate),this.qr[e.toKey()]=n),n}getGlobalsCache(){return this.$r}getTargetCache(){return this.Ur}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Gr}runTransaction(e,r,n){et("MemoryPersistence","Starting transaction:",e);const a=new M6(this.Qr.next());return this.referenceDelegate.zr(),n(a).next((l=>this.referenceDelegate.jr(a).next((()=>l)))).toPromise().then((l=>(a.raiseOnCommittedEvent(),l)))}Hr(e,r){return ze.or(Object.values(this.qr).map((n=>()=>n.containsKey(e,r))))}}class M6 extends gM{constructor(e){super(),this.currentSequenceNumber=e}}class Rv{constructor(e){this.persistence=e,this.Jr=new kv,this.Yr=null}static Zr(e){return new Rv(e)}get Xr(){if(this.Yr)return this.Yr;throw ct()}addReference(e,r,n){return this.Jr.addReference(n,r),this.Xr.delete(n.toString()),ze.resolve()}removeReference(e,r,n){return this.Jr.removeReference(n,r),this.Xr.add(n.toString()),ze.resolve()}markPotentiallyOrphaned(e,r){return this.Xr.add(r.toString()),ze.resolve()}removeTarget(e,r){this.Jr.gr(r.targetId).forEach((a=>this.Xr.add(a.toString())));const n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(e,r.targetId).next((a=>{a.forEach((l=>this.Xr.add(l.toString())))})).next((()=>n.removeTargetData(e,r)))}zr(){this.Yr=new Set}jr(e){const r=this.persistence.getRemoteDocumentCache().newChangeBuffer();return ze.forEach(this.Xr,(n=>{const a=at.fromPath(n);return this.ei(e,a).next((l=>{l||r.removeEntry(a,ht.min())}))})).next((()=>(this.Yr=null,r.apply(e))))}updateLimboDocument(e,r){return this.ei(e,r).next((n=>{n?this.Xr.delete(r.toString()):this.Xr.add(r.toString())}))}Wr(e){return 0}ei(e,r){return ze.or([()=>ze.resolve(this.Jr.containsKey(r)),()=>this.persistence.getTargetCache().containsKey(e,r),()=>this.persistence.Hr(e,r)])}}class Dv{constructor(e,r,n,a){this.targetId=e,this.fromCache=r,this.$i=n,this.Ui=a}static Wi(e,r){let n=Ot(),a=Ot();for(const l of r.docChanges)switch(l.type){case 0:n=n.add(l.doc.key);break;case 1:a=a.add(l.doc.key)}return new Dv(e,r.fromCache,n,a)}}class j6{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}class F6{constructor(){this.Gi=!1,this.zi=!1,this.ji=100,this.Hi=(function(){return HD()?8:xM(Bn())>0?6:4})()}initialize(e,r){this.Ji=e,this.indexManager=r,this.Gi=!0}getDocumentsMatchingQuery(e,r,n,a){const l={result:null};return this.Yi(e,r).next((o=>{l.result=o})).next((()=>{if(!l.result)return this.Zi(e,r,a,n).next((o=>{l.result=o}))})).next((()=>{if(l.result)return;const o=new j6;return this.Xi(e,r,o).next((u=>{if(l.result=u,this.zi)return this.es(e,r,o,u.size)}))})).next((()=>l.result))}es(e,r,n,a){return n.documentReadCount<this.ji?(Qu()<=jt.DEBUG&&et("QueryEngine","SDK will not create cache indexes for query:",_c(r),"since it only creates cache indexes for collection contains","more than or equal to",this.ji,"documents"),ze.resolve()):(Qu()<=jt.DEBUG&&et("QueryEngine","Query:",_c(r),"scans",n.documentReadCount,"local documents and returns",a,"documents as results."),n.documentReadCount>this.Hi*a?(Qu()<=jt.DEBUG&&et("QueryEngine","The SDK decides to create cache indexes for query:",_c(r),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Ms(r))):ze.resolve())}Yi(e,r){if(_T(r))return ze.resolve(null);let n=Ms(r);return this.indexManager.getIndexType(e,n).next((a=>a===0?null:(r.limit!==null&&a===1&&(r=Ex(r,null,"F"),n=Ms(r)),this.indexManager.getDocumentsMatchingTarget(e,n).next((l=>{const o=Ot(...l);return this.Ji.getDocuments(e,o).next((u=>this.indexManager.getMinOffset(e,n).next((h=>{const m=this.ts(r,u);return this.ns(r,m,o,h.readTime)?this.Yi(e,Ex(r,null,"F")):this.rs(e,m,r,h)}))))})))))}Zi(e,r,n,a){return _T(r)||a.isEqual(ht.min())?ze.resolve(null):this.Ji.getDocuments(e,n).next((l=>{const o=this.ts(r,l);return this.ns(r,o,n,a)?ze.resolve(null):(Qu()<=jt.DEBUG&&et("QueryEngine","Re-using previous result from %s to execute query: %s",a.toString(),_c(r)),this.rs(e,o,r,hM(a,-1)).next((u=>u)))}))}ts(e,r){let n=new Tn(zS(e));return r.forEach(((a,l)=>{am(e,l)&&(n=n.add(l))})),n}ns(e,r,n,a){if(e.limit===null)return!1;if(n.size!==r.size)return!0;const l=e.limitType==="F"?r.last():r.first();return!!l&&(l.hasPendingWrites||l.version.compareTo(a)>0)}Xi(e,r,n){return Qu()<=jt.DEBUG&&et("QueryEngine","Using full collection scan to execute query:",_c(r)),this.Ji.getDocumentsMatchingQuery(e,r,El.min(),n)}rs(e,r,n,a){return this.Ji.getDocumentsMatchingQuery(e,n,a).next((l=>(r.forEach((o=>{l=l.insert(o.key,o)})),l)))}}class P6{constructor(e,r,n,a){this.persistence=e,this.ss=r,this.serializer=a,this.os=new br(Yt),this._s=new $c((l=>Tv(l)),Ev),this.us=new Map,this.cs=e.getRemoteDocumentCache(),this.Ur=e.getTargetCache(),this.Gr=e.getBundleCache(),this.ls(n)}ls(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new S6(this.cs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.cs.setIndexManager(this.indexManager),this.ss.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(r=>e.collect(r,this.os)))}}function L6(t,e,r,n){return new P6(t,e,r,n)}async function fA(t,e){const r=mt(t);return await r.persistence.runTransaction("Handle user change","readonly",(n=>{let a;return r.mutationQueue.getAllMutationBatches(n).next((l=>(a=l,r.ls(e),r.mutationQueue.getAllMutationBatches(n)))).next((l=>{const o=[],u=[];let h=Ot();for(const m of a){o.push(m.batchId);for(const p of m.mutations)h=h.add(p.key)}for(const m of l){u.push(m.batchId);for(const p of m.mutations)h=h.add(p.key)}return r.localDocuments.getDocuments(n,h).next((m=>({hs:m,removedBatchIds:o,addedBatchIds:u})))}))}))}function U6(t,e){const r=mt(t);return r.persistence.runTransaction("Acknowledge batch","readwrite-primary",(n=>{const a=e.batch.keys(),l=r.cs.newChangeBuffer({trackRemovals:!0});return(function(u,h,m,p){const v=m.batch,_=v.keys();let w=ze.resolve();return _.forEach((E=>{w=w.next((()=>p.getEntry(h,E))).next((T=>{const A=m.docVersions.get(E);ar(A!==null),T.version.compareTo(A)<0&&(v.applyToRemoteDocument(T,m),T.isValidDocument()&&(T.setReadTime(m.commitVersion),p.addEntry(T)))}))})),w.next((()=>u.mutationQueue.removeMutationBatch(h,v)))})(r,n,e,l).next((()=>l.apply(n))).next((()=>r.mutationQueue.performConsistencyCheck(n))).next((()=>r.documentOverlayCache.removeOverlaysForBatchId(n,a,e.batch.batchId))).next((()=>r.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(n,(function(u){let h=Ot();for(let m=0;m<u.mutationResults.length;++m)u.mutationResults[m].transformResults.length>0&&(h=h.add(u.batch.mutations[m].key));return h})(e)))).next((()=>r.localDocuments.getDocuments(n,a)))}))}function hA(t){const e=mt(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(r=>e.Ur.getLastRemoteSnapshotVersion(r)))}function B6(t,e){const r=mt(t),n=e.snapshotVersion;let a=r.os;return r.persistence.runTransaction("Apply remote event","readwrite-primary",(l=>{const o=r.cs.newChangeBuffer({trackRemovals:!0});a=r.os;const u=[];e.targetChanges.forEach(((p,v)=>{const _=a.get(v);if(!_)return;u.push(r.Ur.removeMatchingKeys(l,p.removedDocuments,v).next((()=>r.Ur.addMatchingKeys(l,p.addedDocuments,v))));let w=_.withSequenceNumber(l.currentSequenceNumber);e.targetMismatches.get(v)!==null?w=w.withResumeToken(Sn.EMPTY_BYTE_STRING,ht.min()).withLastLimboFreeSnapshotVersion(ht.min()):p.resumeToken.approximateByteSize()>0&&(w=w.withResumeToken(p.resumeToken,n)),a=a.insert(v,w),(function(T,A,M){return T.resumeToken.approximateByteSize()===0||A.snapshotVersion.toMicroseconds()-T.snapshotVersion.toMicroseconds()>=3e8?!0:M.addedDocuments.size+M.modifiedDocuments.size+M.removedDocuments.size>0})(_,w,p)&&u.push(r.Ur.updateTargetData(l,w))}));let h=Ti(),m=Ot();if(e.documentUpdates.forEach((p=>{e.resolvedLimboDocuments.has(p)&&u.push(r.persistence.referenceDelegate.updateLimboDocument(l,p))})),u.push(V6(l,o,e.documentUpdates).next((p=>{h=p.Ps,m=p.Is}))),!n.isEqual(ht.min())){const p=r.Ur.getLastRemoteSnapshotVersion(l).next((v=>r.Ur.setTargetsMetadata(l,l.currentSequenceNumber,n)));u.push(p)}return ze.waitFor(u).next((()=>o.apply(l))).next((()=>r.localDocuments.getLocalViewOfDocuments(l,h,m))).next((()=>h))})).then((l=>(r.os=a,l)))}function V6(t,e,r){let n=Ot(),a=Ot();return r.forEach((l=>n=n.add(l))),e.getEntries(t,n).next((l=>{let o=Ti();return r.forEach(((u,h)=>{const m=l.get(u);h.isFoundDocument()!==m.isFoundDocument()&&(a=a.add(u)),h.isNoDocument()&&h.version.isEqual(ht.min())?(e.removeEntry(u,h.readTime),o=o.insert(u,h)):!m.isValidDocument()||h.version.compareTo(m.version)>0||h.version.compareTo(m.version)===0&&m.hasPendingWrites?(e.addEntry(h),o=o.insert(u,h)):et("LocalStore","Ignoring outdated watch update for ",u,". Current version:",m.version," Watch version:",h.version)})),{Ps:o,Is:a}}))}function z6(t,e){const r=mt(t);return r.persistence.runTransaction("Get next mutation batch","readonly",(n=>(e===void 0&&(e=-1),r.mutationQueue.getNextMutationBatchAfterBatchId(n,e))))}function H6(t,e){const r=mt(t);return r.persistence.runTransaction("Allocate target","readwrite",(n=>{let a;return r.Ur.getTargetData(n,e).next((l=>l?(a=l,ze.resolve(a)):r.Ur.allocateTargetId(n).next((o=>(a=new pl(e,o,"TargetPurposeListen",n.currentSequenceNumber),r.Ur.addTargetData(n,a).next((()=>a)))))))})).then((n=>{const a=r.os.get(n.targetId);return(a===null||n.snapshotVersion.compareTo(a.snapshotVersion)>0)&&(r.os=r.os.insert(n.targetId,n),r._s.set(e,n.targetId)),n}))}async function Cx(t,e,r){const n=mt(t),a=n.os.get(e),l=r?"readwrite":"readwrite-primary";try{r||await n.persistence.runTransaction("Release target",l,(o=>n.persistence.referenceDelegate.removeTarget(o,a)))}catch(o){if(!rh(o))throw o;et("LocalStore",`Failed to update sequence numbers for target ${e}: ${o}`)}n.os=n.os.remove(e),n._s.delete(a.target)}function DT(t,e,r){const n=mt(t);let a=ht.min(),l=Ot();return n.persistence.runTransaction("Execute query","readwrite",(o=>(function(h,m,p){const v=mt(h),_=v._s.get(p);return _!==void 0?ze.resolve(v.os.get(_)):v.Ur.getTargetData(m,p)})(n,o,Ms(e)).next((u=>{if(u)return a=u.lastLimboFreeSnapshotVersion,n.Ur.getMatchingKeysForTargetId(o,u.targetId).next((h=>{l=h}))})).next((()=>n.ss.getDocumentsMatchingQuery(o,e,r?a:ht.min(),r?l:Ot()))).next((u=>(G6(n,jM(e),u),{documents:u,Ts:l})))))}function G6(t,e,r){let n=t.us.get(e)||ht.min();r.forEach(((a,l)=>{l.readTime.compareTo(n)>0&&(n=l.readTime)})),t.us.set(e,n)}class IT{constructor(){this.activeTargetIds=VM()}fs(e){this.activeTargetIds=this.activeTargetIds.add(e)}gs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Vs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class q6{constructor(){this.so=new IT,this.oo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,r,n){}addLocalQueryTarget(e,r=!0){return r&&this.so.fs(e),this.oo[e]||"not-current"}updateQueryState(e,r,n){this.oo[e]=r}removeLocalQueryTarget(e){this.so.gs(e)}isLocalQueryTarget(e){return this.so.activeTargetIds.has(e)}clearQueryState(e){delete this.oo[e]}getAllActiveQueryTargets(){return this.so.activeTargetIds}isActiveQueryTarget(e){return this.so.activeTargetIds.has(e)}start(){return this.so=new IT,Promise.resolve()}handleUserChange(e,r,n){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}class W6{_o(e){}shutdown(){}}class OT{constructor(){this.ao=()=>this.uo(),this.co=()=>this.lo(),this.ho=[],this.Po()}_o(e){this.ho.push(e)}shutdown(){window.removeEventListener("online",this.ao),window.removeEventListener("offline",this.co)}Po(){window.addEventListener("online",this.ao),window.addEventListener("offline",this.co)}uo(){et("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.ho)e(0)}lo(){et("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.ho)e(1)}static D(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}let Hd=null;function zg(){return Hd===null?Hd=(function(){return 268435456+Math.round(2147483648*Math.random())})():Hd++,"0x"+Hd.toString(16)}const K6={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class Y6{constructor(e){this.Io=e.Io,this.To=e.To}Eo(e){this.Ao=e}Ro(e){this.Vo=e}mo(e){this.fo=e}onMessage(e){this.po=e}close(){this.To()}send(e){this.Io(e)}yo(){this.Ao()}wo(){this.Vo()}So(e){this.fo(e)}bo(e){this.po(e)}}const Dn="WebChannelConnection";class $6 extends class{constructor(r){this.databaseInfo=r,this.databaseId=r.databaseId;const n=r.ssl?"https":"http",a=encodeURIComponent(this.databaseId.projectId),l=encodeURIComponent(this.databaseId.database);this.Do=n+"://"+r.host,this.vo=`projects/${a}/databases/${l}`,this.Co=this.databaseId.database==="(default)"?`project_id=${a}`:`project_id=${a}&database_id=${l}`}get Fo(){return!1}Mo(r,n,a,l,o){const u=zg(),h=this.xo(r,n.toUriEncodedString());et("RestConnection",`Sending RPC '${r}' ${u}:`,h,a);const m={"google-cloud-resource-prefix":this.vo,"x-goog-request-params":this.Co};return this.Oo(m,l,o),this.No(r,h,m,a).then((p=>(et("RestConnection",`Received RPC '${r}' ${u}: `,p),p)),(p=>{throw Pc("RestConnection",`RPC '${r}' ${u} failed with error: `,p,"url: ",h,"request:",a),p}))}Lo(r,n,a,l,o,u){return this.Mo(r,n,a,l,o)}Oo(r,n,a){r["X-Goog-Api-Client"]=(function(){return"gl-js/ fire/"+Yc})(),r["Content-Type"]="text/plain",this.databaseInfo.appId&&(r["X-Firebase-GMPID"]=this.databaseInfo.appId),n&&n.headers.forEach(((l,o)=>r[o]=l)),a&&a.headers.forEach(((l,o)=>r[o]=l))}xo(r,n){const a=K6[r];return`${this.Do}/v1/${n}:${a}`}terminate(){}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}No(e,r,n,a){const l=zg();return new Promise(((o,u)=>{const h=new bS;h.setWithCredentials(!0),h.listenOnce(SS.COMPLETE,(()=>{try{switch(h.getLastErrorCode()){case l0.NO_ERROR:const p=h.getResponseJson();et(Dn,`XHR for RPC '${e}' ${l} received:`,JSON.stringify(p)),o(p);break;case l0.TIMEOUT:et(Dn,`RPC '${e}' ${l} timed out`),u(new Je(Le.DEADLINE_EXCEEDED,"Request time out"));break;case l0.HTTP_ERROR:const v=h.getStatus();if(et(Dn,`RPC '${e}' ${l} failed with status:`,v,"response text:",h.getResponseText()),v>0){let _=h.getResponseJson();Array.isArray(_)&&(_=_[0]);const w=_?.error;if(w&&w.status&&w.message){const E=(function(A){const M=A.toLowerCase().replace(/_/g,"-");return Object.values(Le).indexOf(M)>=0?M:Le.UNKNOWN})(w.status);u(new Je(E,w.message))}else u(new Je(Le.UNKNOWN,"Server responded with status "+h.getStatus()))}else u(new Je(Le.UNAVAILABLE,"Connection failed."));break;default:ct()}}finally{et(Dn,`RPC '${e}' ${l} completed.`)}}));const m=JSON.stringify(a);et(Dn,`RPC '${e}' ${l} sending request:`,a),h.send(r,"POST",m,n,15)}))}Bo(e,r,n){const a=zg(),l=[this.Do,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=CS(),u=NS(),h={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},m=this.longPollingOptions.timeoutSeconds;m!==void 0&&(h.longPollingTimeout=Math.round(1e3*m)),this.useFetchStreams&&(h.useFetchStreams=!0),this.Oo(h.initMessageHeaders,r,n),h.encodeInitMessageHeaders=!0;const p=l.join("");et(Dn,`Creating RPC '${e}' stream ${a}: ${p}`,h);const v=o.createWebChannel(p,h);let _=!1,w=!1;const E=new Y6({Io:A=>{w?et(Dn,`Not sending because RPC '${e}' stream ${a} is closed:`,A):(_||(et(Dn,`Opening RPC '${e}' stream ${a} transport.`),v.open(),_=!0),et(Dn,`RPC '${e}' stream ${a} sending:`,A),v.send(A))},To:()=>v.close()}),T=(A,M,F)=>{A.listen(M,(R=>{try{F(R)}catch(z){setTimeout((()=>{throw z}),0)}}))};return T(v,ef.EventType.OPEN,(()=>{w||(et(Dn,`RPC '${e}' stream ${a} transport opened.`),E.yo())})),T(v,ef.EventType.CLOSE,(()=>{w||(w=!0,et(Dn,`RPC '${e}' stream ${a} transport closed`),E.So())})),T(v,ef.EventType.ERROR,(A=>{w||(w=!0,Pc(Dn,`RPC '${e}' stream ${a} transport errored:`,A),E.So(new Je(Le.UNAVAILABLE,"The operation could not be completed")))})),T(v,ef.EventType.MESSAGE,(A=>{var M;if(!w){const F=A.data[0];ar(!!F);const R=F,z=R.error||((M=R[0])===null||M===void 0?void 0:M.error);if(z){et(Dn,`RPC '${e}' stream ${a} received error:`,z);const re=z.status;let te=(function(k){const j=Kr[k];if(j!==void 0)return tA(j)})(re),b=z.message;te===void 0&&(te=Le.INTERNAL,b="Unknown error status: "+re+" with message "+z.message),w=!0,E.So(new Je(te,b)),v.close()}else et(Dn,`RPC '${e}' stream ${a} received:`,F),E.bo(F)}})),T(u,AS.STAT_EVENT,(A=>{A.stat===xx.PROXY?et(Dn,`RPC '${e}' stream ${a} detected buffering proxy`):A.stat===xx.NOPROXY&&et(Dn,`RPC '${e}' stream ${a} detected no buffering proxy`)})),setTimeout((()=>{E.wo()}),0),E}}function Hg(){return typeof document<"u"?document:null}function om(t){return new s6(t,!0)}class dA{constructor(e,r,n=1e3,a=1.5,l=6e4){this.ui=e,this.timerId=r,this.ko=n,this.qo=a,this.Qo=l,this.Ko=0,this.$o=null,this.Uo=Date.now(),this.reset()}reset(){this.Ko=0}Wo(){this.Ko=this.Qo}Go(e){this.cancel();const r=Math.floor(this.Ko+this.zo()),n=Math.max(0,Date.now()-this.Uo),a=Math.max(0,r-n);a>0&&et("ExponentialBackoff",`Backing off for ${a} ms (base delay: ${this.Ko} ms, delay with jitter: ${r} ms, last attempt: ${n} ms ago)`),this.$o=this.ui.enqueueAfterDelay(this.timerId,a,(()=>(this.Uo=Date.now(),e()))),this.Ko*=this.qo,this.Ko<this.ko&&(this.Ko=this.ko),this.Ko>this.Qo&&(this.Ko=this.Qo)}jo(){this.$o!==null&&(this.$o.skipDelay(),this.$o=null)}cancel(){this.$o!==null&&(this.$o.cancel(),this.$o=null)}zo(){return(Math.random()-.5)*this.Ko}}class mA{constructor(e,r,n,a,l,o,u,h){this.ui=e,this.Ho=n,this.Jo=a,this.connection=l,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=u,this.listener=h,this.state=0,this.Yo=0,this.Zo=null,this.Xo=null,this.stream=null,this.e_=0,this.t_=new dA(e,r)}n_(){return this.state===1||this.state===5||this.r_()}r_(){return this.state===2||this.state===3}start(){this.e_=0,this.state!==4?this.auth():this.i_()}async stop(){this.n_()&&await this.close(0)}s_(){this.state=0,this.t_.reset()}o_(){this.r_()&&this.Zo===null&&(this.Zo=this.ui.enqueueAfterDelay(this.Ho,6e4,(()=>this.__())))}a_(e){this.u_(),this.stream.send(e)}async __(){if(this.r_())return this.close(0)}u_(){this.Zo&&(this.Zo.cancel(),this.Zo=null)}c_(){this.Xo&&(this.Xo.cancel(),this.Xo=null)}async close(e,r){this.u_(),this.c_(),this.t_.cancel(),this.Yo++,e!==4?this.t_.reset():r&&r.code===Le.RESOURCE_EXHAUSTED?(wi(r.toString()),wi("Using maximum backoff delay to prevent overloading the backend."),this.t_.Wo()):r&&r.code===Le.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.l_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.mo(r)}l_(){}auth(){this.state=1;const e=this.h_(this.Yo),r=this.Yo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((([n,a])=>{this.Yo===r&&this.P_(n,a)}),(n=>{e((()=>{const a=new Je(Le.UNKNOWN,"Fetching auth token failed: "+n.message);return this.I_(a)}))}))}P_(e,r){const n=this.h_(this.Yo);this.stream=this.T_(e,r),this.stream.Eo((()=>{n((()=>this.listener.Eo()))})),this.stream.Ro((()=>{n((()=>(this.state=2,this.Xo=this.ui.enqueueAfterDelay(this.Jo,1e4,(()=>(this.r_()&&(this.state=3),Promise.resolve()))),this.listener.Ro())))})),this.stream.mo((a=>{n((()=>this.I_(a)))})),this.stream.onMessage((a=>{n((()=>++this.e_==1?this.E_(a):this.onNext(a)))}))}i_(){this.state=5,this.t_.Go((async()=>{this.state=0,this.start()}))}I_(e){return et("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}h_(e){return r=>{this.ui.enqueueAndForget((()=>this.Yo===e?r():(et("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class X6 extends mA{constructor(e,r,n,a,l,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",r,n,a,o),this.serializer=l}T_(e,r){return this.connection.Bo("Listen",e,r)}E_(e){return this.onNext(e)}onNext(e){this.t_.reset();const r=o6(this.serializer,e),n=(function(l){if(!("targetChange"in l))return ht.min();const o=l.targetChange;return o.targetIds&&o.targetIds.length?ht.min():o.readTime?js(o.readTime):ht.min()})(e);return this.listener.d_(r,n)}A_(e){const r={};r.database=Nx(this.serializer),r.addTarget=(function(l,o){let u;const h=o.target;if(u=wx(h)?{documents:f6(l,h)}:{query:h6(l,h)._t},u.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){u.resumeToken=aA(l,o.resumeToken);const m=bx(l,o.expectedCount);m!==null&&(u.expectedCount=m)}else if(o.snapshotVersion.compareTo(ht.min())>0){u.readTime=k0(l,o.snapshotVersion.toTimestamp());const m=bx(l,o.expectedCount);m!==null&&(u.expectedCount=m)}return u})(this.serializer,e);const n=m6(this.serializer,e);n&&(r.labels=n),this.a_(r)}R_(e){const r={};r.database=Nx(this.serializer),r.removeTarget=e,this.a_(r)}}class Q6 extends mA{constructor(e,r,n,a,l,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",r,n,a,o),this.serializer=l}get V_(){return this.e_>0}start(){this.lastStreamToken=void 0,super.start()}l_(){this.V_&&this.m_([])}T_(e,r){return this.connection.Bo("Write",e,r)}E_(e){return ar(!!e.streamToken),this.lastStreamToken=e.streamToken,ar(!e.writeResults||e.writeResults.length===0),this.listener.f_()}onNext(e){ar(!!e.streamToken),this.lastStreamToken=e.streamToken,this.t_.reset();const r=u6(e.writeResults,e.commitTime),n=js(e.commitTime);return this.listener.g_(n,r)}p_(){const e={};e.database=Nx(this.serializer),this.a_(e)}m_(e){const r={streamToken:this.lastStreamToken,writes:e.map((n=>c6(this.serializer,n)))};this.a_(r)}}class J6 extends class{}{constructor(e,r,n,a){super(),this.authCredentials=e,this.appCheckCredentials=r,this.connection=n,this.serializer=a,this.y_=!1}w_(){if(this.y_)throw new Je(Le.FAILED_PRECONDITION,"The client has already been terminated.")}Mo(e,r,n,a){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([l,o])=>this.connection.Mo(e,Sx(r,n),a,l,o))).catch((l=>{throw l.name==="FirebaseError"?(l.code===Le.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),l):new Je(Le.UNKNOWN,l.toString())}))}Lo(e,r,n,a,l){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([o,u])=>this.connection.Lo(e,Sx(r,n),a,o,u,l))).catch((o=>{throw o.name==="FirebaseError"?(o.code===Le.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new Je(Le.UNKNOWN,o.toString())}))}terminate(){this.y_=!0,this.connection.terminate()}}class Z6{constructor(e,r){this.asyncQueue=e,this.onlineStateHandler=r,this.state="Unknown",this.S_=0,this.b_=null,this.D_=!0}v_(){this.S_===0&&(this.C_("Unknown"),this.b_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this.b_=null,this.F_("Backend didn't respond within 10 seconds."),this.C_("Offline"),Promise.resolve()))))}M_(e){this.state==="Online"?this.C_("Unknown"):(this.S_++,this.S_>=1&&(this.x_(),this.F_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.C_("Offline")))}set(e){this.x_(),this.S_=0,e==="Online"&&(this.D_=!1),this.C_(e)}C_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}F_(e){const r=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.D_?(wi(r),this.D_=!1):et("OnlineStateTracker",r)}x_(){this.b_!==null&&(this.b_.cancel(),this.b_=null)}}class ej{constructor(e,r,n,a,l){this.localStore=e,this.datastore=r,this.asyncQueue=n,this.remoteSyncer={},this.O_=[],this.N_=new Map,this.L_=new Set,this.B_=[],this.k_=l,this.k_._o((o=>{n.enqueueAndForget((async()=>{No(this)&&(et("RemoteStore","Restarting streams for network reachability change."),await(async function(h){const m=mt(h);m.L_.add(4),await ih(m),m.q_.set("Unknown"),m.L_.delete(4),await cm(m)})(this))}))})),this.q_=new Z6(n,a)}}async function cm(t){if(No(t))for(const e of t.B_)await e(!0)}async function ih(t){for(const e of t.B_)await e(!1)}function pA(t,e){const r=mt(t);r.N_.has(e.targetId)||(r.N_.set(e.targetId,e),jv(r)?Mv(r):Xc(r).r_()&&Ov(r,e))}function Iv(t,e){const r=mt(t),n=Xc(r);r.N_.delete(e),n.r_()&&gA(r,e),r.N_.size===0&&(n.r_()?n.o_():No(r)&&r.q_.set("Unknown"))}function Ov(t,e){if(t.Q_.xe(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(ht.min())>0){const r=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(r)}Xc(t).A_(e)}function gA(t,e){t.Q_.xe(e),Xc(t).R_(e)}function Mv(t){t.Q_=new t6({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),ot:e=>t.N_.get(e)||null,tt:()=>t.datastore.serializer.databaseId}),Xc(t).start(),t.q_.v_()}function jv(t){return No(t)&&!Xc(t).n_()&&t.N_.size>0}function No(t){return mt(t).L_.size===0}function xA(t){t.Q_=void 0}async function tj(t){t.q_.set("Online")}async function rj(t){t.N_.forEach(((e,r)=>{Ov(t,e)}))}async function nj(t,e){xA(t),jv(t)?(t.q_.M_(e),Mv(t)):t.q_.set("Unknown")}async function aj(t,e,r){if(t.q_.set("Online"),e instanceof nA&&e.state===2&&e.cause)try{await(async function(a,l){const o=l.cause;for(const u of l.targetIds)a.N_.has(u)&&(await a.remoteSyncer.rejectListen(u,o),a.N_.delete(u),a.Q_.removeTarget(u))})(t,e)}catch(n){et("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),n),await R0(t,n)}else if(e instanceof u0?t.Q_.Ke(e):e instanceof rA?t.Q_.He(e):t.Q_.We(e),!r.isEqual(ht.min()))try{const n=await hA(t.localStore);r.compareTo(n)>=0&&await(function(l,o){const u=l.Q_.rt(o);return u.targetChanges.forEach(((h,m)=>{if(h.resumeToken.approximateByteSize()>0){const p=l.N_.get(m);p&&l.N_.set(m,p.withResumeToken(h.resumeToken,o))}})),u.targetMismatches.forEach(((h,m)=>{const p=l.N_.get(h);if(!p)return;l.N_.set(h,p.withResumeToken(Sn.EMPTY_BYTE_STRING,p.snapshotVersion)),gA(l,h);const v=new pl(p.target,h,m,p.sequenceNumber);Ov(l,v)})),l.remoteSyncer.applyRemoteEvent(u)})(t,r)}catch(n){et("RemoteStore","Failed to raise snapshot:",n),await R0(t,n)}}async function R0(t,e,r){if(!rh(e))throw e;t.L_.add(1),await ih(t),t.q_.set("Offline"),r||(r=()=>hA(t.localStore)),t.asyncQueue.enqueueRetryable((async()=>{et("RemoteStore","Retrying IndexedDB access"),await r(),t.L_.delete(1),await cm(t)}))}function vA(t,e){return e().catch((r=>R0(t,r,e)))}async function um(t){const e=mt(t),r=Sl(e);let n=e.O_.length>0?e.O_[e.O_.length-1].batchId:-1;for(;sj(e);)try{const a=await z6(e.localStore,n);if(a===null){e.O_.length===0&&r.o_();break}n=a.batchId,ij(e,a)}catch(a){await R0(e,a)}yA(e)&&_A(e)}function sj(t){return No(t)&&t.O_.length<10}function ij(t,e){t.O_.push(e);const r=Sl(t);r.r_()&&r.V_&&r.m_(e.mutations)}function yA(t){return No(t)&&!Sl(t).n_()&&t.O_.length>0}function _A(t){Sl(t).start()}async function lj(t){Sl(t).p_()}async function oj(t){const e=Sl(t);for(const r of t.O_)e.m_(r.mutations)}async function cj(t,e,r){const n=t.O_.shift(),a=Av.from(n,e,r);await vA(t,(()=>t.remoteSyncer.applySuccessfulWrite(a))),await um(t)}async function uj(t,e){e&&Sl(t).V_&&await(async function(n,a){if((function(o){return JM(o)&&o!==Le.ABORTED})(a.code)){const l=n.O_.shift();Sl(n).s_(),await vA(n,(()=>n.remoteSyncer.rejectFailedWrite(l.batchId,a))),await um(n)}})(t,e),yA(t)&&_A(t)}async function MT(t,e){const r=mt(t);r.asyncQueue.verifyOperationInProgress(),et("RemoteStore","RemoteStore received new credentials");const n=No(r);r.L_.add(3),await ih(r),n&&r.q_.set("Unknown"),await r.remoteSyncer.handleCredentialChange(e),r.L_.delete(3),await cm(r)}async function fj(t,e){const r=mt(t);e?(r.L_.delete(2),await cm(r)):e||(r.L_.add(2),await ih(r),r.q_.set("Unknown"))}function Xc(t){return t.K_||(t.K_=(function(r,n,a){const l=mt(r);return l.w_(),new X6(n,l.connection,l.authCredentials,l.appCheckCredentials,l.serializer,a)})(t.datastore,t.asyncQueue,{Eo:tj.bind(null,t),Ro:rj.bind(null,t),mo:nj.bind(null,t),d_:aj.bind(null,t)}),t.B_.push((async e=>{e?(t.K_.s_(),jv(t)?Mv(t):t.q_.set("Unknown")):(await t.K_.stop(),xA(t))}))),t.K_}function Sl(t){return t.U_||(t.U_=(function(r,n,a){const l=mt(r);return l.w_(),new Q6(n,l.connection,l.authCredentials,l.appCheckCredentials,l.serializer,a)})(t.datastore,t.asyncQueue,{Eo:()=>Promise.resolve(),Ro:lj.bind(null,t),mo:uj.bind(null,t),f_:oj.bind(null,t),g_:cj.bind(null,t)}),t.B_.push((async e=>{e?(t.U_.s_(),await um(t)):(await t.U_.stop(),t.O_.length>0&&(et("RemoteStore",`Stopping write stream with ${t.O_.length} pending writes`),t.O_=[]))}))),t.U_}class Fv{constructor(e,r,n,a,l){this.asyncQueue=e,this.timerId=r,this.targetTimeMs=n,this.op=a,this.removalCallback=l,this.deferred=new mi,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((o=>{}))}get promise(){return this.deferred.promise}static createAndSchedule(e,r,n,a,l){const o=Date.now()+n,u=new Fv(e,r,o,a,l);return u.start(n),u}start(e){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new Je(Le.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then((e=>this.deferred.resolve(e)))):Promise.resolve()))}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Pv(t,e){if(wi("AsyncQueue",`${e}: ${t}`),rh(t))return new Je(Le.UNAVAILABLE,`${e}: ${t}`);throw t}class Cc{constructor(e){this.comparator=e?(r,n)=>e(r,n)||at.comparator(r.key,n.key):(r,n)=>at.comparator(r.key,n.key),this.keyedMap=tf(),this.sortedSet=new br(this.comparator)}static emptySet(e){return new Cc(e.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const r=this.keyedMap.get(e);return r?this.sortedSet.indexOf(r):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal(((r,n)=>(e(r),!1)))}add(e){const r=this.delete(e.key);return r.copy(r.keyedMap.insert(e.key,e),r.sortedSet.insert(e,null))}delete(e){const r=this.get(e);return r?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(r)):this}isEqual(e){if(!(e instanceof Cc)||this.size!==e.size)return!1;const r=this.sortedSet.getIterator(),n=e.sortedSet.getIterator();for(;r.hasNext();){const a=r.getNext().key,l=n.getNext().key;if(!a.isEqual(l))return!1}return!0}toString(){const e=[];return this.forEach((r=>{e.push(r.toString())})),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,r){const n=new Cc;return n.comparator=this.comparator,n.keyedMap=e,n.sortedSet=r,n}}class jT{constructor(){this.W_=new br(at.comparator)}track(e){const r=e.doc.key,n=this.W_.get(r);n?e.type!==0&&n.type===3?this.W_=this.W_.insert(r,e):e.type===3&&n.type!==1?this.W_=this.W_.insert(r,{type:n.type,doc:e.doc}):e.type===2&&n.type===2?this.W_=this.W_.insert(r,{type:2,doc:e.doc}):e.type===2&&n.type===0?this.W_=this.W_.insert(r,{type:0,doc:e.doc}):e.type===1&&n.type===0?this.W_=this.W_.remove(r):e.type===1&&n.type===2?this.W_=this.W_.insert(r,{type:1,doc:n.doc}):e.type===0&&n.type===1?this.W_=this.W_.insert(r,{type:2,doc:e.doc}):ct():this.W_=this.W_.insert(r,e)}G_(){const e=[];return this.W_.inorderTraversal(((r,n)=>{e.push(n)})),e}}class zc{constructor(e,r,n,a,l,o,u,h,m){this.query=e,this.docs=r,this.oldDocs=n,this.docChanges=a,this.mutatedKeys=l,this.fromCache=o,this.syncStateChanged=u,this.excludesMetadataChanges=h,this.hasCachedResults=m}static fromInitialDocuments(e,r,n,a,l){const o=[];return r.forEach((u=>{o.push({type:0,doc:u})})),new zc(e,r,Cc.emptySet(r),o,n,a,!0,!1,l)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&nm(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const r=this.docChanges,n=e.docChanges;if(r.length!==n.length)return!1;for(let a=0;a<r.length;a++)if(r[a].type!==n[a].type||!r[a].doc.isEqual(n[a].doc))return!1;return!0}}class hj{constructor(){this.z_=void 0,this.j_=[]}H_(){return this.j_.some((e=>e.J_()))}}class dj{constructor(){this.queries=FT(),this.onlineState="Unknown",this.Y_=new Set}terminate(){(function(r,n){const a=mt(r),l=a.queries;a.queries=FT(),l.forEach(((o,u)=>{for(const h of u.j_)h.onError(n)}))})(this,new Je(Le.ABORTED,"Firestore shutting down"))}}function FT(){return new $c((t=>VS(t)),nm)}async function Lv(t,e){const r=mt(t);let n=3;const a=e.query;let l=r.queries.get(a);l?!l.H_()&&e.J_()&&(n=2):(l=new hj,n=e.J_()?0:1);try{switch(n){case 0:l.z_=await r.onListen(a,!0);break;case 1:l.z_=await r.onListen(a,!1);break;case 2:await r.onFirstRemoteStoreListen(a)}}catch(o){const u=Pv(o,`Initialization of query '${_c(e.query)}' failed`);return void e.onError(u)}r.queries.set(a,l),l.j_.push(e),e.Z_(r.onlineState),l.z_&&e.X_(l.z_)&&Bv(r)}async function Uv(t,e){const r=mt(t),n=e.query;let a=3;const l=r.queries.get(n);if(l){const o=l.j_.indexOf(e);o>=0&&(l.j_.splice(o,1),l.j_.length===0?a=e.J_()?0:1:!l.H_()&&e.J_()&&(a=2))}switch(a){case 0:return r.queries.delete(n),r.onUnlisten(n,!0);case 1:return r.queries.delete(n),r.onUnlisten(n,!1);case 2:return r.onLastRemoteStoreUnlisten(n);default:return}}function mj(t,e){const r=mt(t);let n=!1;for(const a of e){const l=a.query,o=r.queries.get(l);if(o){for(const u of o.j_)u.X_(a)&&(n=!0);o.z_=a}}n&&Bv(r)}function pj(t,e,r){const n=mt(t),a=n.queries.get(e);if(a)for(const l of a.j_)l.onError(r);n.queries.delete(e)}function Bv(t){t.Y_.forEach((e=>{e.next()}))}var kx,PT;(PT=kx||(kx={})).ea="default",PT.Cache="cache";class Vv{constructor(e,r,n){this.query=e,this.ta=r,this.na=!1,this.ra=null,this.onlineState="Unknown",this.options=n||{}}X_(e){if(!this.options.includeMetadataChanges){const n=[];for(const a of e.docChanges)a.type!==3&&n.push(a);e=new zc(e.query,e.docs,e.oldDocs,n,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let r=!1;return this.na?this.ia(e)&&(this.ta.next(e),r=!0):this.sa(e,this.onlineState)&&(this.oa(e),r=!0),this.ra=e,r}onError(e){this.ta.error(e)}Z_(e){this.onlineState=e;let r=!1;return this.ra&&!this.na&&this.sa(this.ra,e)&&(this.oa(this.ra),r=!0),r}sa(e,r){if(!e.fromCache||!this.J_())return!0;const n=r!=="Offline";return(!this.options._a||!n)&&(!e.docs.isEmpty()||e.hasCachedResults||r==="Offline")}ia(e){if(e.docChanges.length>0)return!0;const r=this.ra&&this.ra.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!r)&&this.options.includeMetadataChanges===!0}oa(e){e=zc.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.na=!0,this.ta.next(e)}J_(){return this.options.source!==kx.Cache}}class wA{constructor(e){this.key=e}}class TA{constructor(e){this.key=e}}class gj{constructor(e,r){this.query=e,this.Ta=r,this.Ea=null,this.hasCachedResults=!1,this.current=!1,this.da=Ot(),this.mutatedKeys=Ot(),this.Aa=zS(e),this.Ra=new Cc(this.Aa)}get Va(){return this.Ta}ma(e,r){const n=r?r.fa:new jT,a=r?r.Ra:this.Ra;let l=r?r.mutatedKeys:this.mutatedKeys,o=a,u=!1;const h=this.query.limitType==="F"&&a.size===this.query.limit?a.last():null,m=this.query.limitType==="L"&&a.size===this.query.limit?a.first():null;if(e.inorderTraversal(((p,v)=>{const _=a.get(p),w=am(this.query,v)?v:null,E=!!_&&this.mutatedKeys.has(_.key),T=!!w&&(w.hasLocalMutations||this.mutatedKeys.has(w.key)&&w.hasCommittedMutations);let A=!1;_&&w?_.data.isEqual(w.data)?E!==T&&(n.track({type:3,doc:w}),A=!0):this.ga(_,w)||(n.track({type:2,doc:w}),A=!0,(h&&this.Aa(w,h)>0||m&&this.Aa(w,m)<0)&&(u=!0)):!_&&w?(n.track({type:0,doc:w}),A=!0):_&&!w&&(n.track({type:1,doc:_}),A=!0,(h||m)&&(u=!0)),A&&(w?(o=o.add(w),l=T?l.add(p):l.delete(p)):(o=o.delete(p),l=l.delete(p)))})),this.query.limit!==null)for(;o.size>this.query.limit;){const p=this.query.limitType==="F"?o.last():o.first();o=o.delete(p.key),l=l.delete(p.key),n.track({type:1,doc:p})}return{Ra:o,fa:n,ns:u,mutatedKeys:l}}ga(e,r){return e.hasLocalMutations&&r.hasCommittedMutations&&!r.hasLocalMutations}applyChanges(e,r,n,a){const l=this.Ra;this.Ra=e.Ra,this.mutatedKeys=e.mutatedKeys;const o=e.fa.G_();o.sort(((p,v)=>(function(w,E){const T=A=>{switch(A){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return ct()}};return T(w)-T(E)})(p.type,v.type)||this.Aa(p.doc,v.doc))),this.pa(n),a=a!=null&&a;const u=r&&!a?this.ya():[],h=this.da.size===0&&this.current&&!a?1:0,m=h!==this.Ea;return this.Ea=h,o.length!==0||m?{snapshot:new zc(this.query,e.Ra,l,o,e.mutatedKeys,h===0,m,!1,!!n&&n.resumeToken.approximateByteSize()>0),wa:u}:{wa:u}}Z_(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({Ra:this.Ra,fa:new jT,mutatedKeys:this.mutatedKeys,ns:!1},!1)):{wa:[]}}Sa(e){return!this.Ta.has(e)&&!!this.Ra.has(e)&&!this.Ra.get(e).hasLocalMutations}pa(e){e&&(e.addedDocuments.forEach((r=>this.Ta=this.Ta.add(r))),e.modifiedDocuments.forEach((r=>{})),e.removedDocuments.forEach((r=>this.Ta=this.Ta.delete(r))),this.current=e.current)}ya(){if(!this.current)return[];const e=this.da;this.da=Ot(),this.Ra.forEach((n=>{this.Sa(n.key)&&(this.da=this.da.add(n.key))}));const r=[];return e.forEach((n=>{this.da.has(n)||r.push(new TA(n))})),this.da.forEach((n=>{e.has(n)||r.push(new wA(n))})),r}ba(e){this.Ta=e.Ts,this.da=Ot();const r=this.ma(e.documents);return this.applyChanges(r,!0)}Da(){return zc.fromInitialDocuments(this.query,this.Ra,this.mutatedKeys,this.Ea===0,this.hasCachedResults)}}class xj{constructor(e,r,n){this.query=e,this.targetId=r,this.view=n}}class vj{constructor(e){this.key=e,this.va=!1}}class yj{constructor(e,r,n,a,l,o){this.localStore=e,this.remoteStore=r,this.eventManager=n,this.sharedClientState=a,this.currentUser=l,this.maxConcurrentLimboResolutions=o,this.Ca={},this.Fa=new $c((u=>VS(u)),nm),this.Ma=new Map,this.xa=new Set,this.Oa=new br(at.comparator),this.Na=new Map,this.La=new kv,this.Ba={},this.ka=new Map,this.qa=Vc.kn(),this.onlineState="Unknown",this.Qa=void 0}get isPrimaryClient(){return this.Qa===!0}}async function _j(t,e,r=!0){const n=CA(t);let a;const l=n.Fa.get(e);return l?(n.sharedClientState.addLocalQueryTarget(l.targetId),a=l.view.Da()):a=await EA(n,e,r,!0),a}async function wj(t,e){const r=CA(t);await EA(r,e,!0,!1)}async function EA(t,e,r,n){const a=await H6(t.localStore,Ms(e)),l=a.targetId,o=t.sharedClientState.addLocalQueryTarget(l,r);let u;return n&&(u=await Tj(t,e,l,o==="current",a.resumeToken)),t.isPrimaryClient&&r&&pA(t.remoteStore,a),u}async function Tj(t,e,r,n,a){t.Ka=(v,_,w)=>(async function(T,A,M,F){let R=A.view.ma(M);R.ns&&(R=await DT(T.localStore,A.query,!1).then((({documents:b})=>A.view.ma(b,R))));const z=F&&F.targetChanges.get(A.targetId),re=F&&F.targetMismatches.get(A.targetId)!=null,te=A.view.applyChanges(R,T.isPrimaryClient,z,re);return UT(T,A.targetId,te.wa),te.snapshot})(t,v,_,w);const l=await DT(t.localStore,e,!0),o=new gj(e,l.Ts),u=o.ma(l.documents),h=sh.createSynthesizedTargetChangeForCurrentChange(r,n&&t.onlineState!=="Offline",a),m=o.applyChanges(u,t.isPrimaryClient,h);UT(t,r,m.wa);const p=new xj(e,r,o);return t.Fa.set(e,p),t.Ma.has(r)?t.Ma.get(r).push(e):t.Ma.set(r,[e]),m.snapshot}async function Ej(t,e,r){const n=mt(t),a=n.Fa.get(e),l=n.Ma.get(a.targetId);if(l.length>1)return n.Ma.set(a.targetId,l.filter((o=>!nm(o,e)))),void n.Fa.delete(e);n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(a.targetId),n.sharedClientState.isActiveQueryTarget(a.targetId)||await Cx(n.localStore,a.targetId,!1).then((()=>{n.sharedClientState.clearQueryState(a.targetId),r&&Iv(n.remoteStore,a.targetId),Rx(n,a.targetId)})).catch(th)):(Rx(n,a.targetId),await Cx(n.localStore,a.targetId,!0))}async function bj(t,e){const r=mt(t),n=r.Fa.get(e),a=r.Ma.get(n.targetId);r.isPrimaryClient&&a.length===1&&(r.sharedClientState.removeLocalQueryTarget(n.targetId),Iv(r.remoteStore,n.targetId))}async function Sj(t,e,r){const n=Ij(t);try{const a=await(function(o,u){const h=mt(o),m=tn.now(),p=u.reduce(((w,E)=>w.add(E.key)),Ot());let v,_;return h.persistence.runTransaction("Locally write mutations","readwrite",(w=>{let E=Ti(),T=Ot();return h.cs.getEntries(w,p).next((A=>{E=A,E.forEach(((M,F)=>{F.isValidDocument()||(T=T.add(M))}))})).next((()=>h.localDocuments.getOverlayedDocuments(w,E))).next((A=>{v=A;const M=[];for(const F of u){const R=KM(F,v.get(F.key).overlayedDocument);R!=null&&M.push(new kl(F.key,R,OS(R.value.mapValue),Za.exists(!0)))}return h.mutationQueue.addMutationBatch(w,m,M,u)})).next((A=>{_=A;const M=A.applyToLocalDocumentSet(v,T);return h.documentOverlayCache.saveOverlays(w,A.batchId,M)}))})).then((()=>({batchId:_.batchId,changes:GS(v)})))})(n.localStore,e);n.sharedClientState.addPendingMutation(a.batchId),(function(o,u,h){let m=o.Ba[o.currentUser.toKey()];m||(m=new br(Yt)),m=m.insert(u,h),o.Ba[o.currentUser.toKey()]=m})(n,a.batchId,r),await lh(n,a.changes),await um(n.remoteStore)}catch(a){const l=Pv(a,"Failed to persist write");r.reject(l)}}async function bA(t,e){const r=mt(t);try{const n=await B6(r.localStore,e);e.targetChanges.forEach(((a,l)=>{const o=r.Na.get(l);o&&(ar(a.addedDocuments.size+a.modifiedDocuments.size+a.removedDocuments.size<=1),a.addedDocuments.size>0?o.va=!0:a.modifiedDocuments.size>0?ar(o.va):a.removedDocuments.size>0&&(ar(o.va),o.va=!1))})),await lh(r,n,e)}catch(n){await th(n)}}function LT(t,e,r){const n=mt(t);if(n.isPrimaryClient&&r===0||!n.isPrimaryClient&&r===1){const a=[];n.Fa.forEach(((l,o)=>{const u=o.view.Z_(e);u.snapshot&&a.push(u.snapshot)})),(function(o,u){const h=mt(o);h.onlineState=u;let m=!1;h.queries.forEach(((p,v)=>{for(const _ of v.j_)_.Z_(u)&&(m=!0)})),m&&Bv(h)})(n.eventManager,e),a.length&&n.Ca.d_(a),n.onlineState=e,n.isPrimaryClient&&n.sharedClientState.setOnlineState(e)}}async function Aj(t,e,r){const n=mt(t);n.sharedClientState.updateQueryState(e,"rejected",r);const a=n.Na.get(e),l=a&&a.key;if(l){let o=new br(at.comparator);o=o.insert(l,jn.newNoDocument(l,ht.min()));const u=Ot().add(l),h=new lm(ht.min(),new Map,new br(Yt),o,u);await bA(n,h),n.Oa=n.Oa.remove(l),n.Na.delete(e),zv(n)}else await Cx(n.localStore,e,!1).then((()=>Rx(n,e,r))).catch(th)}async function Nj(t,e){const r=mt(t),n=e.batch.batchId;try{const a=await U6(r.localStore,e);AA(r,n,null),SA(r,n),r.sharedClientState.updateMutationState(n,"acknowledged"),await lh(r,a)}catch(a){await th(a)}}async function Cj(t,e,r){const n=mt(t);try{const a=await(function(o,u){const h=mt(o);return h.persistence.runTransaction("Reject batch","readwrite-primary",(m=>{let p;return h.mutationQueue.lookupMutationBatch(m,u).next((v=>(ar(v!==null),p=v.keys(),h.mutationQueue.removeMutationBatch(m,v)))).next((()=>h.mutationQueue.performConsistencyCheck(m))).next((()=>h.documentOverlayCache.removeOverlaysForBatchId(m,p,u))).next((()=>h.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(m,p))).next((()=>h.localDocuments.getDocuments(m,p)))}))})(n.localStore,e);AA(n,e,r),SA(n,e),n.sharedClientState.updateMutationState(e,"rejected",r),await lh(n,a)}catch(a){await th(a)}}function SA(t,e){(t.ka.get(e)||[]).forEach((r=>{r.resolve()})),t.ka.delete(e)}function AA(t,e,r){const n=mt(t);let a=n.Ba[n.currentUser.toKey()];if(a){const l=a.get(e);l&&(r?l.reject(r):l.resolve(),a=a.remove(e)),n.Ba[n.currentUser.toKey()]=a}}function Rx(t,e,r=null){t.sharedClientState.removeLocalQueryTarget(e);for(const n of t.Ma.get(e))t.Fa.delete(n),r&&t.Ca.$a(n,r);t.Ma.delete(e),t.isPrimaryClient&&t.La.gr(e).forEach((n=>{t.La.containsKey(n)||NA(t,n)}))}function NA(t,e){t.xa.delete(e.path.canonicalString());const r=t.Oa.get(e);r!==null&&(Iv(t.remoteStore,r),t.Oa=t.Oa.remove(e),t.Na.delete(r),zv(t))}function UT(t,e,r){for(const n of r)n instanceof wA?(t.La.addReference(n.key,e),kj(t,n)):n instanceof TA?(et("SyncEngine","Document no longer in limbo: "+n.key),t.La.removeReference(n.key,e),t.La.containsKey(n.key)||NA(t,n.key)):ct()}function kj(t,e){const r=e.key,n=r.path.canonicalString();t.Oa.get(r)||t.xa.has(n)||(et("SyncEngine","New document in limbo: "+r),t.xa.add(n),zv(t))}function zv(t){for(;t.xa.size>0&&t.Oa.size<t.maxConcurrentLimboResolutions;){const e=t.xa.values().next().value;t.xa.delete(e);const r=new at(xr.fromString(e)),n=t.qa.next();t.Na.set(n,new vj(r)),t.Oa=t.Oa.insert(r,n),pA(t.remoteStore,new pl(Ms(rm(r.path)),n,"TargetPurposeLimboResolution",vv.oe))}}async function lh(t,e,r){const n=mt(t),a=[],l=[],o=[];n.Fa.isEmpty()||(n.Fa.forEach(((u,h)=>{o.push(n.Ka(h,e,r).then((m=>{var p;if((m||r)&&n.isPrimaryClient){const v=m?!m.fromCache:(p=r?.targetChanges.get(h.targetId))===null||p===void 0?void 0:p.current;n.sharedClientState.updateQueryState(h.targetId,v?"current":"not-current")}if(m){a.push(m);const v=Dv.Wi(h.targetId,m);l.push(v)}})))})),await Promise.all(o),n.Ca.d_(a),await(async function(h,m){const p=mt(h);try{await p.persistence.runTransaction("notifyLocalViewChanges","readwrite",(v=>ze.forEach(m,(_=>ze.forEach(_.$i,(w=>p.persistence.referenceDelegate.addReference(v,_.targetId,w))).next((()=>ze.forEach(_.Ui,(w=>p.persistence.referenceDelegate.removeReference(v,_.targetId,w)))))))))}catch(v){if(!rh(v))throw v;et("LocalStore","Failed to update sequence numbers: "+v)}for(const v of m){const _=v.targetId;if(!v.fromCache){const w=p.os.get(_),E=w.snapshotVersion,T=w.withLastLimboFreeSnapshotVersion(E);p.os=p.os.insert(_,T)}}})(n.localStore,l))}async function Rj(t,e){const r=mt(t);if(!r.currentUser.isEqual(e)){et("SyncEngine","User change. New user:",e.toKey());const n=await fA(r.localStore,e);r.currentUser=e,(function(l,o){l.ka.forEach((u=>{u.forEach((h=>{h.reject(new Je(Le.CANCELLED,o))}))})),l.ka.clear()})(r,"'waitForPendingWrites' promise is rejected due to a user change."),r.sharedClientState.handleUserChange(e,n.removedBatchIds,n.addedBatchIds),await lh(r,n.hs)}}function Dj(t,e){const r=mt(t),n=r.Na.get(e);if(n&&n.va)return Ot().add(n.key);{let a=Ot();const l=r.Ma.get(e);if(!l)return a;for(const o of l){const u=r.Fa.get(o);a=a.unionWith(u.view.Va)}return a}}function CA(t){const e=mt(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=bA.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=Dj.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=Aj.bind(null,e),e.Ca.d_=mj.bind(null,e.eventManager),e.Ca.$a=pj.bind(null,e.eventManager),e}function Ij(t){const e=mt(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=Nj.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=Cj.bind(null,e),e}class D0{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=om(e.databaseInfo.databaseId),this.sharedClientState=this.Wa(e),this.persistence=this.Ga(e),await this.persistence.start(),this.localStore=this.za(e),this.gcScheduler=this.ja(e,this.localStore),this.indexBackfillerScheduler=this.Ha(e,this.localStore)}ja(e,r){return null}Ha(e,r){return null}za(e){return L6(this.persistence,new F6,e.initialUser,this.serializer)}Ga(e){return new O6(Rv.Zr,this.serializer)}Wa(e){return new q6}async terminate(){var e,r;(e=this.gcScheduler)===null||e===void 0||e.stop(),(r=this.indexBackfillerScheduler)===null||r===void 0||r.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}D0.provider={build:()=>new D0};class Dx{async initialize(e,r){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(r),this.remoteStore=this.createRemoteStore(r),this.eventManager=this.createEventManager(r),this.syncEngine=this.createSyncEngine(r,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=n=>LT(this.syncEngine,n,1),this.remoteStore.remoteSyncer.handleCredentialChange=Rj.bind(null,this.syncEngine),await fj(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return(function(){return new dj})()}createDatastore(e){const r=om(e.databaseInfo.databaseId),n=(function(l){return new $6(l)})(e.databaseInfo);return(function(l,o,u,h){return new J6(l,o,u,h)})(e.authCredentials,e.appCheckCredentials,n,r)}createRemoteStore(e){return(function(n,a,l,o,u){return new ej(n,a,l,o,u)})(this.localStore,this.datastore,e.asyncQueue,(r=>LT(this.syncEngine,r,0)),(function(){return OT.D()?new OT:new W6})())}createSyncEngine(e,r){return(function(a,l,o,u,h,m,p){const v=new yj(a,l,o,u,h,m);return p&&(v.Qa=!0),v})(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,r)}async terminate(){var e,r;await(async function(a){const l=mt(a);et("RemoteStore","RemoteStore shutting down."),l.L_.add(5),await ih(l),l.k_.shutdown(),l.q_.set("Unknown")})(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate(),(r=this.eventManager)===null||r===void 0||r.terminate()}}Dx.provider={build:()=>new Dx};class Hv{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ya(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ya(this.observer.error,e):wi("Uncaught Error in snapshot listener:",e.toString()))}Za(){this.muted=!0}Ya(e,r){setTimeout((()=>{this.muted||e(r)}),0)}}class Oj{constructor(e,r,n,a,l){this.authCredentials=e,this.appCheckCredentials=r,this.asyncQueue=n,this.databaseInfo=a,this.user=On.UNAUTHENTICATED,this.clientId=RS.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=l,this.authCredentials.start(n,(async o=>{et("FirestoreClient","Received user=",o.uid),await this.authCredentialListener(o),this.user=o})),this.appCheckCredentials.start(n,(o=>(et("FirestoreClient","Received new app check token=",o),this.appCheckCredentialListener(o,this.user))))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new mi;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(r){const n=Pv(r,"Failed to shutdown persistence");e.reject(n)}})),e.promise}}async function Gg(t,e){t.asyncQueue.verifyOperationInProgress(),et("FirestoreClient","Initializing OfflineComponentProvider");const r=t.configuration;await e.initialize(r);let n=r.initialUser;t.setCredentialChangeListener((async a=>{n.isEqual(a)||(await fA(e.localStore,a),n=a)})),e.persistence.setDatabaseDeletedListener((()=>t.terminate())),t._offlineComponents=e}async function BT(t,e){t.asyncQueue.verifyOperationInProgress();const r=await Mj(t);et("FirestoreClient","Initializing OnlineComponentProvider"),await e.initialize(r,t.configuration),t.setCredentialChangeListener((n=>MT(e.remoteStore,n))),t.setAppCheckTokenChangeListener(((n,a)=>MT(e.remoteStore,a))),t._onlineComponents=e}async function Mj(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){et("FirestoreClient","Using user provided OfflineComponentProvider");try{await Gg(t,t._uninitializedComponentsProvider._offline)}catch(e){const r=e;if(!(function(a){return a.name==="FirebaseError"?a.code===Le.FAILED_PRECONDITION||a.code===Le.UNIMPLEMENTED:!(typeof DOMException<"u"&&a instanceof DOMException)||a.code===22||a.code===20||a.code===11})(r))throw r;Pc("Error using user provided cache. Falling back to memory cache: "+r),await Gg(t,new D0)}}else et("FirestoreClient","Using default OfflineComponentProvider"),await Gg(t,new D0);return t._offlineComponents}async function kA(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(et("FirestoreClient","Using user provided OnlineComponentProvider"),await BT(t,t._uninitializedComponentsProvider._online)):(et("FirestoreClient","Using default OnlineComponentProvider"),await BT(t,new Dx))),t._onlineComponents}function jj(t){return kA(t).then((e=>e.syncEngine))}async function I0(t){const e=await kA(t),r=e.eventManager;return r.onListen=_j.bind(null,e.syncEngine),r.onUnlisten=Ej.bind(null,e.syncEngine),r.onFirstRemoteStoreListen=wj.bind(null,e.syncEngine),r.onLastRemoteStoreUnlisten=bj.bind(null,e.syncEngine),r}function Fj(t,e,r={}){const n=new mi;return t.asyncQueue.enqueueAndForget((async()=>(function(l,o,u,h,m){const p=new Hv({next:_=>{p.Za(),o.enqueueAndForget((()=>Uv(l,v)));const w=_.docs.has(u);!w&&_.fromCache?m.reject(new Je(Le.UNAVAILABLE,"Failed to get document because the client is offline.")):w&&_.fromCache&&h&&h.source==="server"?m.reject(new Je(Le.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):m.resolve(_)},error:_=>m.reject(_)}),v=new Vv(rm(u.path),p,{includeMetadataChanges:!0,_a:!0});return Lv(l,v)})(await I0(t),t.asyncQueue,e,r,n))),n.promise}function Pj(t,e,r={}){const n=new mi;return t.asyncQueue.enqueueAndForget((async()=>(function(l,o,u,h,m){const p=new Hv({next:_=>{p.Za(),o.enqueueAndForget((()=>Uv(l,v))),_.fromCache&&h.source==="server"?m.reject(new Je(Le.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):m.resolve(_)},error:_=>m.reject(_)}),v=new Vv(u,p,{includeMetadataChanges:!0,_a:!0});return Lv(l,v)})(await I0(t),t.asyncQueue,e,r,n))),n.promise}function RA(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}const VT=new Map;function DA(t,e,r){if(!r)throw new Je(Le.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function Lj(t,e,r,n){if(e===!0&&n===!0)throw new Je(Le.INVALID_ARGUMENT,`${t} and ${r} cannot be used together.`)}function zT(t){if(!at.isDocumentKey(t))throw new Je(Le.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function HT(t){if(at.isDocumentKey(t))throw new Je(Le.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function fm(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=(function(n){return n.constructor?n.constructor.name:null})(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":ct()}function pa(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new Je(Le.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const r=fm(t);throw new Je(Le.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${r}`)}}return t}class GT{constructor(e){var r,n;if(e.host===void 0){if(e.ssl!==void 0)throw new Je(Le.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=(r=e.ssl)===null||r===void 0||r;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new Je(Le.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}Lj("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=RA((n=e.experimentalLongPollingOptions)!==null&&n!==void 0?n:{}),(function(l){if(l.timeoutSeconds!==void 0){if(isNaN(l.timeoutSeconds))throw new Je(Le.INVALID_ARGUMENT,`invalid long polling timeout: ${l.timeoutSeconds} (must not be NaN)`);if(l.timeoutSeconds<5)throw new Je(Le.INVALID_ARGUMENT,`invalid long polling timeout: ${l.timeoutSeconds} (minimum allowed value is 5)`);if(l.timeoutSeconds>30)throw new Je(Le.INVALID_ARGUMENT,`invalid long polling timeout: ${l.timeoutSeconds} (maximum allowed value is 30)`)}})(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&(function(n,a){return n.timeoutSeconds===a.timeoutSeconds})(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class hm{constructor(e,r,n,a){this._authCredentials=e,this._appCheckCredentials=r,this._databaseId=n,this._app=a,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new GT({}),this._settingsFrozen=!1,this._terminateTask="notTerminated"}get app(){if(!this._app)throw new Je(Le.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new Je(Le.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new GT(e),e.credentials!==void 0&&(this._authCredentials=(function(n){if(!n)return new nM;switch(n.type){case"firstParty":return new lM(n.sessionIndex||"0",n.iamToken||null,n.authTokenFactory||null);case"provider":return n.client;default:throw new Je(Le.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}})(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return(function(r){const n=VT.get(r);n&&(et("ComponentProvider","Removing Datastore"),VT.delete(r),n.terminate())})(this),Promise.resolve()}}function Uj(t,e,r,n={}){var a;const l=(t=pa(t,hm))._getSettings(),o=`${e}:${r}`;if(l.host!=="firestore.googleapis.com"&&l.host!==o&&Pc("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),t._setSettings(Object.assign(Object.assign({},l),{host:o,ssl:!1})),n.mockUserToken){let u,h;if(typeof n.mockUserToken=="string")u=n.mockUserToken,h=On.MOCK_USER;else{u=Pb(n.mockUserToken,(a=t._app)===null||a===void 0?void 0:a.options.projectId);const m=n.mockUserToken.sub||n.mockUserToken.user_id;if(!m)throw new Je(Le.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");h=new On(m)}t._authCredentials=new aM(new kS(u,h))}}class Co{constructor(e,r,n){this.converter=r,this._query=n,this.type="query",this.firestore=e}withConverter(e){return new Co(this.firestore,e,this._query)}}class Ln{constructor(e,r,n){this.converter=r,this._key=n,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new _l(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Ln(this.firestore,e,this._key)}}class _l extends Co{constructor(e,r,n){super(e,r,rm(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Ln(this.firestore,null,new at(e))}withConverter(e){return new _l(this.firestore,e,this._path)}}function ur(t,e,...r){if(t=vr(t),DA("collection","path",e),t instanceof hm){const n=xr.fromString(e,...r);return HT(n),new _l(t,null,n)}{if(!(t instanceof Ln||t instanceof _l))throw new Je(Le.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=t._path.child(xr.fromString(e,...r));return HT(n),new _l(t.firestore,null,n)}}function Pt(t,e,...r){if(t=vr(t),arguments.length===1&&(e=RS.newId()),DA("doc","path",e),t instanceof hm){const n=xr.fromString(e,...r);return zT(n),new Ln(t,null,new at(n))}{if(!(t instanceof Ln||t instanceof _l))throw new Je(Le.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=t._path.child(xr.fromString(e,...r));return zT(n),new Ln(t.firestore,t instanceof _l?t.converter:null,new at(n))}}class qT{constructor(e=Promise.resolve()){this.Pu=[],this.Iu=!1,this.Tu=[],this.Eu=null,this.du=!1,this.Au=!1,this.Ru=[],this.t_=new dA(this,"async_queue_retry"),this.Vu=()=>{const n=Hg();n&&et("AsyncQueue","Visibility state changed to "+n.visibilityState),this.t_.jo()},this.mu=e;const r=Hg();r&&typeof r.addEventListener=="function"&&r.addEventListener("visibilitychange",this.Vu)}get isShuttingDown(){return this.Iu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.fu(),this.gu(e)}enterRestrictedMode(e){if(!this.Iu){this.Iu=!0,this.Au=e||!1;const r=Hg();r&&typeof r.removeEventListener=="function"&&r.removeEventListener("visibilitychange",this.Vu)}}enqueue(e){if(this.fu(),this.Iu)return new Promise((()=>{}));const r=new mi;return this.gu((()=>this.Iu&&this.Au?Promise.resolve():(e().then(r.resolve,r.reject),r.promise))).then((()=>r.promise))}enqueueRetryable(e){this.enqueueAndForget((()=>(this.Pu.push(e),this.pu())))}async pu(){if(this.Pu.length!==0){try{await this.Pu[0](),this.Pu.shift(),this.t_.reset()}catch(e){if(!rh(e))throw e;et("AsyncQueue","Operation failed with retryable error: "+e)}this.Pu.length>0&&this.t_.Go((()=>this.pu()))}}gu(e){const r=this.mu.then((()=>(this.du=!0,e().catch((n=>{this.Eu=n,this.du=!1;const a=(function(o){let u=o.message||"";return o.stack&&(u=o.stack.includes(o.message)?o.stack:o.message+`
`+o.stack),u})(n);throw wi("INTERNAL UNHANDLED ERROR: ",a),n})).then((n=>(this.du=!1,n))))));return this.mu=r,r}enqueueAfterDelay(e,r,n){this.fu(),this.Ru.indexOf(e)>-1&&(r=0);const a=Fv.createAndSchedule(this,e,r,n,(l=>this.yu(l)));return this.Tu.push(a),a}fu(){this.Eu&&ct()}verifyOperationInProgress(){}async wu(){let e;do e=this.mu,await e;while(e!==this.mu)}Su(e){for(const r of this.Tu)if(r.timerId===e)return!0;return!1}bu(e){return this.wu().then((()=>{this.Tu.sort(((r,n)=>r.targetTimeMs-n.targetTimeMs));for(const r of this.Tu)if(r.skipDelay(),e!=="all"&&r.timerId===e)break;return this.wu()}))}Du(e){this.Ru.push(e)}yu(e){const r=this.Tu.indexOf(e);this.Tu.splice(r,1)}}function WT(t){return(function(r,n){if(typeof r!="object"||r===null)return!1;const a=r;for(const l of n)if(l in a&&typeof a[l]=="function")return!0;return!1})(t,["next","error","complete"])}class Ei extends hm{constructor(e,r,n,a){super(e,r,n,a),this.type="firestore",this._queue=new qT,this._persistenceKey=a?.name||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new qT(e),this._firestoreClient=void 0,await e}}}function Bj(t,e){const r=typeof t=="object"?t:Q0(),n=typeof t=="string"?t:"(default)",a=Qf(r,"firestore").getImmediate({identifier:n});if(!a._initialized){const l=nv("firestore");l&&Uj(a,...l)}return a}function dm(t){if(t._terminated)throw new Je(Le.FAILED_PRECONDITION,"The client has already been terminated.");return t._firestoreClient||Vj(t),t._firestoreClient}function Vj(t){var e,r,n;const a=t._freezeSettings(),l=(function(u,h,m,p){return new _M(u,h,m,p.host,p.ssl,p.experimentalForceLongPolling,p.experimentalAutoDetectLongPolling,RA(p.experimentalLongPollingOptions),p.useFetchStreams)})(t._databaseId,((e=t._app)===null||e===void 0?void 0:e.options.appId)||"",t._persistenceKey,a);t._componentsProvider||!((r=a.localCache)===null||r===void 0)&&r._offlineComponentProvider&&(!((n=a.localCache)===null||n===void 0)&&n._onlineComponentProvider)&&(t._componentsProvider={_offline:a.localCache._offlineComponentProvider,_online:a.localCache._onlineComponentProvider}),t._firestoreClient=new Oj(t._authCredentials,t._appCheckCredentials,t._queue,l,t._componentsProvider&&(function(u){const h=u?._online.build();return{_offline:u?._offline.build(h),_online:h}})(t._componentsProvider))}class Hc{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Hc(Sn.fromBase64String(e))}catch(r){throw new Je(Le.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+r)}}static fromUint8Array(e){return new Hc(Sn.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}class mm{constructor(...e){for(let r=0;r<e.length;++r)if(e[r].length===0)throw new Je(Le.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new wn(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}class oh{constructor(e){this._methodName=e}}class Gv{constructor(e,r){if(!isFinite(e)||e<-90||e>90)throw new Je(Le.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(r)||r<-180||r>180)throw new Je(Le.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+r);this._lat=e,this._long=r}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return Yt(this._lat,e._lat)||Yt(this._long,e._long)}}class qv{constructor(e){this._values=(e||[]).map((r=>r))}toArray(){return this._values.map((e=>e))}isEqual(e){return(function(n,a){if(n.length!==a.length)return!1;for(let l=0;l<n.length;++l)if(n[l]!==a[l])return!1;return!0})(this._values,e._values)}}const zj=/^__.*__$/;class Hj{constructor(e,r,n){this.data=e,this.fieldMask=r,this.fieldTransforms=n}toMutation(e,r){return this.fieldMask!==null?new kl(e,this.data,this.fieldMask,r,this.fieldTransforms):new ah(e,this.data,r,this.fieldTransforms)}}class IA{constructor(e,r,n){this.data=e,this.fieldMask=r,this.fieldTransforms=n}toMutation(e,r){return new kl(e,this.data,this.fieldMask,r,this.fieldTransforms)}}function OA(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw ct()}}class Wv{constructor(e,r,n,a,l,o){this.settings=e,this.databaseId=r,this.serializer=n,this.ignoreUndefinedProperties=a,l===void 0&&this.vu(),this.fieldTransforms=l||[],this.fieldMask=o||[]}get path(){return this.settings.path}get Cu(){return this.settings.Cu}Fu(e){return new Wv(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Mu(e){var r;const n=(r=this.path)===null||r===void 0?void 0:r.child(e),a=this.Fu({path:n,xu:!1});return a.Ou(e),a}Nu(e){var r;const n=(r=this.path)===null||r===void 0?void 0:r.child(e),a=this.Fu({path:n,xu:!1});return a.vu(),a}Lu(e){return this.Fu({path:void 0,xu:!0})}Bu(e){return O0(e,this.settings.methodName,this.settings.ku||!1,this.path,this.settings.qu)}contains(e){return this.fieldMask.find((r=>e.isPrefixOf(r)))!==void 0||this.fieldTransforms.find((r=>e.isPrefixOf(r.field)))!==void 0}vu(){if(this.path)for(let e=0;e<this.path.length;e++)this.Ou(this.path.get(e))}Ou(e){if(e.length===0)throw this.Bu("Document fields must not be empty");if(OA(this.Cu)&&zj.test(e))throw this.Bu('Document fields cannot begin and end with "__"')}}class Gj{constructor(e,r,n){this.databaseId=e,this.ignoreUndefinedProperties=r,this.serializer=n||om(e)}Qu(e,r,n,a=!1){return new Wv({Cu:e,methodName:r,qu:n,path:wn.emptyPath(),xu:!1,ku:a},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function pm(t){const e=t._freezeSettings(),r=om(t._databaseId);return new Gj(t._databaseId,!!e.ignoreUndefinedProperties,r)}function MA(t,e,r,n,a,l={}){const o=t.Qu(l.merge||l.mergeFields?2:0,e,r,a);$v("Data must be an object, but it was:",o,n);const u=jA(n,o);let h,m;if(l.merge)h=new ka(o.fieldMask),m=o.fieldTransforms;else if(l.mergeFields){const p=[];for(const v of l.mergeFields){const _=Ix(e,v,r);if(!o.contains(_))throw new Je(Le.INVALID_ARGUMENT,`Field '${_}' is specified in your field mask but missing from your input data.`);PA(p,_)||p.push(_)}h=new ka(p),m=o.fieldTransforms.filter((v=>h.covers(v.field)))}else h=null,m=o.fieldTransforms;return new Hj(new ma(u),h,m)}class gm extends oh{_toFieldTransform(e){if(e.Cu!==2)throw e.Cu===1?e.Bu(`${this._methodName}() can only appear at the top level of your update data`):e.Bu(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof gm}}class Kv extends oh{_toFieldTransform(e){return new JS(e.path,new Mf)}isEqual(e){return e instanceof Kv}}class Yv extends oh{constructor(e,r){super(e),this.$u=r}_toFieldTransform(e){const r=new Pf(e.serializer,KS(e.serializer,this.$u));return new JS(e.path,r)}isEqual(e){return e instanceof Yv&&this.$u===e.$u}}function qj(t,e,r,n){const a=t.Qu(1,e,r);$v("Data must be an object, but it was:",a,n);const l=[],o=ma.empty();Ao(n,((h,m)=>{const p=Xv(e,h,r);m=vr(m);const v=a.Nu(p);if(m instanceof gm)l.push(p);else{const _=ch(m,v);_!=null&&(l.push(p),o.set(p,_))}}));const u=new ka(l);return new IA(o,u,a.fieldTransforms)}function Wj(t,e,r,n,a,l){const o=t.Qu(1,e,r),u=[Ix(e,n,r)],h=[a];if(l.length%2!=0)throw new Je(Le.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let _=0;_<l.length;_+=2)u.push(Ix(e,l[_])),h.push(l[_+1]);const m=[],p=ma.empty();for(let _=u.length-1;_>=0;--_)if(!PA(m,u[_])){const w=u[_];let E=h[_];E=vr(E);const T=o.Nu(w);if(E instanceof gm)m.push(w);else{const A=ch(E,T);A!=null&&(m.push(w),p.set(w,A))}}const v=new ka(m);return new IA(p,v,o.fieldTransforms)}function Kj(t,e,r,n=!1){return ch(r,t.Qu(n?4:3,e))}function ch(t,e){if(FA(t=vr(t)))return $v("Unsupported field value:",e,t),jA(t,e);if(t instanceof oh)return(function(n,a){if(!OA(a.Cu))throw a.Bu(`${n._methodName}() can only be used with update() and set()`);if(!a.path)throw a.Bu(`${n._methodName}() is not currently supported inside arrays`);const l=n._toFieldTransform(a);l&&a.fieldTransforms.push(l)})(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.xu&&e.Cu!==4)throw e.Bu("Nested arrays are not supported");return(function(n,a){const l=[];let o=0;for(const u of n){let h=ch(u,a.Lu(o));h==null&&(h={nullValue:"NULL_VALUE"}),l.push(h),o++}return{arrayValue:{values:l}}})(t,e)}return(function(n,a){if((n=vr(n))===null)return{nullValue:"NULL_VALUE"};if(typeof n=="number")return KS(a.serializer,n);if(typeof n=="boolean")return{booleanValue:n};if(typeof n=="string")return{stringValue:n};if(n instanceof Date){const l=tn.fromDate(n);return{timestampValue:k0(a.serializer,l)}}if(n instanceof tn){const l=new tn(n.seconds,1e3*Math.floor(n.nanoseconds/1e3));return{timestampValue:k0(a.serializer,l)}}if(n instanceof Gv)return{geoPointValue:{latitude:n.latitude,longitude:n.longitude}};if(n instanceof Hc)return{bytesValue:aA(a.serializer,n._byteString)};if(n instanceof Ln){const l=a.databaseId,o=n.firestore._databaseId;if(!o.isEqual(l))throw a.Bu(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${l.projectId}/${l.database}`);return{referenceValue:Cv(n.firestore._databaseId||a.databaseId,n._key.path)}}if(n instanceof qv)return(function(o,u){return{mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{values:o.toArray().map((h=>{if(typeof h!="number")throw u.Bu("VectorValues must only contain numeric values.");return bv(u.serializer,h)}))}}}}}})(n,a);throw a.Bu(`Unsupported field value: ${fm(n)}`)})(t,e)}function jA(t,e){const r={};return DS(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Ao(t,((n,a)=>{const l=ch(a,e.Mu(n));l!=null&&(r[n]=l)})),{mapValue:{fields:r}}}function FA(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof tn||t instanceof Gv||t instanceof Hc||t instanceof Ln||t instanceof oh||t instanceof qv)}function $v(t,e,r){if(!FA(r)||!(function(a){return typeof a=="object"&&a!==null&&(Object.getPrototypeOf(a)===Object.prototype||Object.getPrototypeOf(a)===null)})(r)){const n=fm(r);throw n==="an object"?e.Bu(t+" a custom object"):e.Bu(t+" "+n)}}function Ix(t,e,r){if((e=vr(e))instanceof mm)return e._internalPath;if(typeof e=="string")return Xv(t,e);throw O0("Field path arguments must be of type string or ",t,!1,void 0,r)}const Yj=new RegExp("[~\\*/\\[\\]]");function Xv(t,e,r){if(e.search(Yj)>=0)throw O0(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,r);try{return new mm(...e.split("."))._internalPath}catch{throw O0(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,r)}}function O0(t,e,r,n,a){const l=n&&!n.isEmpty(),o=a!==void 0;let u=`Function ${e}() called with invalid data`;r&&(u+=" (via `toFirestore()`)"),u+=". ";let h="";return(l||o)&&(h+=" (found",l&&(h+=` in field ${n}`),o&&(h+=` in document ${a}`),h+=")"),new Je(Le.INVALID_ARGUMENT,u+t+h)}function PA(t,e){return t.some((r=>r.isEqual(e)))}class LA{constructor(e,r,n,a,l){this._firestore=e,this._userDataWriter=r,this._key=n,this._document=a,this._converter=l}get id(){return this._key.path.lastSegment()}get ref(){return new Ln(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new $j(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const r=this._document.data.field(Qv("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r)}}}class $j extends LA{data(){return super.data()}}function Qv(t,e){return typeof e=="string"?Xv(t,e):e instanceof mm?e._internalPath:e._delegate._internalPath}function UA(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new Je(Le.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class Jv{}class Xj extends Jv{}function gs(t,e,...r){let n=[];e instanceof Jv&&n.push(e),n=n.concat(r),(function(l){const o=l.filter((h=>h instanceof Zv)).length,u=l.filter((h=>h instanceof xm)).length;if(o>1||o>0&&u>0)throw new Je(Le.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")})(n);for(const a of n)t=a._apply(t);return t}class xm extends Xj{constructor(e,r,n){super(),this._field=e,this._op=r,this._value=n,this.type="where"}static _create(e,r,n){return new xm(e,r,n)}_apply(e){const r=this._parse(e);return BA(e._query,r),new Co(e.firestore,e.converter,Tx(e._query,r))}_parse(e){const r=pm(e.firestore);return(function(l,o,u,h,m,p,v){let _;if(m.isKeyField()){if(p==="array-contains"||p==="array-contains-any")throw new Je(Le.INVALID_ARGUMENT,`Invalid Query. You can't perform '${p}' queries on documentId().`);if(p==="in"||p==="not-in"){YT(v,p);const w=[];for(const E of v)w.push(KT(h,l,E));_={arrayValue:{values:w}}}else _=KT(h,l,v)}else p!=="in"&&p!=="not-in"&&p!=="array-contains-any"||YT(v,p),_=Kj(u,o,v,p==="in"||p==="not-in");return Qr.create(m,p,_)})(e._query,"where",r,e.firestore._databaseId,this._field,this._op,this._value)}}function Da(t,e,r){const n=e,a=Qv("where",t);return xm._create(a,n,r)}class Zv extends Jv{constructor(e,r){super(),this.type=e,this._queryConstraints=r}static _create(e,r){return new Zv(e,r)}_parse(e){const r=this._queryConstraints.map((n=>n._parse(e))).filter((n=>n.getFilters().length>0));return r.length===1?r[0]:vs.create(r,this._getOperator())}_apply(e){const r=this._parse(e);return r.getFilters().length===0?e:((function(a,l){let o=a;const u=l.getFlattenedFilters();for(const h of u)BA(o,h),o=Tx(o,h)})(e._query,r),new Co(e.firestore,e.converter,Tx(e._query,r)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}function KT(t,e,r){if(typeof(r=vr(r))=="string"){if(r==="")throw new Je(Le.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!BS(e)&&r.indexOf("/")!==-1)throw new Je(Le.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${r}' contains a '/' character.`);const n=e.path.child(xr.fromString(r));if(!at.isDocumentKey(n))throw new Je(Le.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${n}' is not because it has an odd number of segments (${n.length}).`);return mT(t,new at(n))}if(r instanceof Ln)return mT(t,r._key);throw new Je(Le.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${fm(r)}.`)}function YT(t,e){if(!Array.isArray(t)||t.length===0)throw new Je(Le.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function BA(t,e){const r=(function(a,l){for(const o of a)for(const u of o.getFlattenedFilters())if(l.indexOf(u.op)>=0)return u.op;return null})(t.filters,(function(a){switch(a){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}})(e.op));if(r!==null)throw r===e.op?new Je(Le.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new Je(Le.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${r.toString()}' filters.`)}class Qj{convertValue(e,r="none"){switch(_o(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Lr(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,r);case 5:return e.stringValue;case 6:return this.convertBytes(yo(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,r);case 11:return this.convertObject(e.mapValue,r);case 10:return this.convertVectorValue(e.mapValue);default:throw ct()}}convertObject(e,r){return this.convertObjectMap(e.fields,r)}convertObjectMap(e,r="none"){const n={};return Ao(e,((a,l)=>{n[a]=this.convertValue(l,r)})),n}convertVectorValue(e){var r,n,a;const l=(a=(n=(r=e.fields)===null||r===void 0?void 0:r.value.arrayValue)===null||n===void 0?void 0:n.values)===null||a===void 0?void 0:a.map((o=>Lr(o.doubleValue)));return new qv(l)}convertGeoPoint(e){return new Gv(Lr(e.latitude),Lr(e.longitude))}convertArray(e,r){return(e.values||[]).map((n=>this.convertValue(n,r)))}convertServerTimestamp(e,r){switch(r){case"previous":const n=_v(e);return n==null?null:this.convertValue(n,r);case"estimate":return this.convertTimestamp(Df(e));default:return null}}convertTimestamp(e){const r=bl(e);return new tn(r.seconds,r.nanos)}convertDocumentKey(e,r){const n=xr.fromString(e);ar(uA(n));const a=new If(n.get(1),n.get(3)),l=new at(n.popFirst(5));return a.isEqual(r)||wi(`Document ${l} contains a document reference within a different database (${a.projectId}/${a.database}) which is not supported. It will be treated as a reference in the current database (${r.projectId}/${r.database}) instead.`),l}}function VA(t,e,r){let n;return n=t?r&&(r.merge||r.mergeFields)?t.toFirestore(e,r):t.toFirestore(e):e,n}class nf{constructor(e,r){this.hasPendingWrites=e,this.fromCache=r}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class zA extends LA{constructor(e,r,n,a,l,o){super(e,r,n,a,o),this._firestore=e,this._firestoreImpl=e,this.metadata=l}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const r=new f0(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(r,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,r={}){if(this._document){const n=this._document.data.field(Qv("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n,r.serverTimestamps)}}}class f0 extends zA{data(e={}){return super.data(e)}}class HA{constructor(e,r,n,a){this._firestore=e,this._userDataWriter=r,this._snapshot=a,this.metadata=new nf(a.hasPendingWrites,a.fromCache),this.query=n}get docs(){const e=[];return this.forEach((r=>e.push(r))),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,r){this._snapshot.docs.forEach((n=>{e.call(r,new f0(this._firestore,this._userDataWriter,n.key,n,new nf(this._snapshot.mutatedKeys.has(n.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(e={}){const r=!!e.includeMetadataChanges;if(r&&this._snapshot.excludesMetadataChanges)throw new Je(Le.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===r||(this._cachedChanges=(function(a,l){if(a._snapshot.oldDocs.isEmpty()){let o=0;return a._snapshot.docChanges.map((u=>{const h=new f0(a._firestore,a._userDataWriter,u.doc.key,u.doc,new nf(a._snapshot.mutatedKeys.has(u.doc.key),a._snapshot.fromCache),a.query.converter);return u.doc,{type:"added",doc:h,oldIndex:-1,newIndex:o++}}))}{let o=a._snapshot.oldDocs;return a._snapshot.docChanges.filter((u=>l||u.type!==3)).map((u=>{const h=new f0(a._firestore,a._userDataWriter,u.doc.key,u.doc,new nf(a._snapshot.mutatedKeys.has(u.doc.key),a._snapshot.fromCache),a.query.converter);let m=-1,p=-1;return u.type!==0&&(m=o.indexOf(u.doc.key),o=o.delete(u.doc.key)),u.type!==1&&(o=o.add(u.doc),p=o.indexOf(u.doc.key)),{type:Jj(u.type),doc:h,oldIndex:m,newIndex:p}}))}})(this,r),this._cachedChangesIncludeMetadataChanges=r),this._cachedChanges}}function Jj(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return ct()}}function Zn(t){t=pa(t,Ln);const e=pa(t.firestore,Ei);return Fj(dm(e),t._key).then((r=>qA(e,t,r)))}class e1 extends Qj{constructor(e){super(),this.firestore=e}convertBytes(e){return new Hc(e)}convertReference(e){const r=this.convertDocumentKey(e,this.firestore._databaseId);return new Ln(this.firestore,null,r)}}function Er(t){t=pa(t,Co);const e=pa(t.firestore,Ei),r=dm(e),n=new e1(e);return UA(t._query),Pj(r,t._query).then((a=>new HA(e,n,t,a)))}function Ia(t,e,r){t=pa(t,Ln);const n=pa(t.firestore,Ei),a=VA(t.converter,e,r);return ym(n,[MA(pm(n),"setDoc",t._key,a,t.converter!==null,r).toMutation(t._key,Za.none())])}function ea(t,e,r,...n){t=pa(t,Ln);const a=pa(t.firestore,Ei),l=pm(a);let o;return o=typeof(e=vr(e))=="string"||e instanceof mm?Wj(l,"updateDoc",t._key,e,r,n):qj(l,"updateDoc",t._key,e),ym(a,[o.toMutation(t._key,Za.exists(!0))])}function GA(t){return ym(pa(t.firestore,Ei),[new Sv(t._key,Za.none())])}function vm(t,e){const r=pa(t.firestore,Ei),n=Pt(t),a=VA(t.converter,e);return ym(r,[MA(pm(t.firestore),"addDoc",n._key,a,t.converter!==null,{}).toMutation(n._key,Za.exists(!1))]).then((()=>n))}function Zj(t,...e){var r,n,a;t=vr(t);let l={includeMetadataChanges:!1,source:"default"},o=0;typeof e[o]!="object"||WT(e[o])||(l=e[o],o++);const u={includeMetadataChanges:l.includeMetadataChanges,source:l.source};if(WT(e[o])){const v=e[o];e[o]=(r=v.next)===null||r===void 0?void 0:r.bind(v),e[o+1]=(n=v.error)===null||n===void 0?void 0:n.bind(v),e[o+2]=(a=v.complete)===null||a===void 0?void 0:a.bind(v)}let h,m,p;if(t instanceof Ln)m=pa(t.firestore,Ei),p=rm(t._key.path),h={next:v=>{e[o]&&e[o](qA(m,t,v))},error:e[o+1],complete:e[o+2]};else{const v=pa(t,Co);m=pa(v.firestore,Ei),p=v._query;const _=new e1(m);h={next:w=>{e[o]&&e[o](new HA(m,_,v,w))},error:e[o+1],complete:e[o+2]},UA(t._query)}return(function(_,w,E,T){const A=new Hv(T),M=new Vv(w,A,E);return _.asyncQueue.enqueueAndForget((async()=>Lv(await I0(_),M))),()=>{A.Za(),_.asyncQueue.enqueueAndForget((async()=>Uv(await I0(_),M)))}})(dm(m),p,u,h)}function ym(t,e){return(function(n,a){const l=new mi;return n.asyncQueue.enqueueAndForget((async()=>Sj(await jj(n),a,l))),l.promise})(dm(t),e)}function qA(t,e,r){const n=r.docs.get(e._key),a=new e1(t);return new zA(t,a,e._key,n,new nf(r.hasPendingWrites,r.fromCache),e.converter)}function eF(){return new Kv("serverTimestamp")}function tF(t){return new Yv("increment",t)}(function(e,r=!0){(function(a){Yc=a})(So),Tl(new vi("firestore",((n,{instanceIdentifier:a,options:l})=>{const o=n.getProvider("app").getImmediate(),u=new Ei(new sM(n.getProvider("auth-internal")),new cM(n.getProvider("app-check-internal")),(function(m,p){if(!Object.prototype.hasOwnProperty.apply(m.options,["projectId"]))throw new Je(Le.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new If(m.options.projectId,p)})(o,a),o);return l=Object.assign({useFetchStreams:r},l),u._setSettings(l),u}),"PUBLIC").setMultipleInstances(!0)),Ja(cT,"4.7.3",e),Ja(cT,"4.7.3","esm2017")})();var rF="firebase",nF="10.14.1";Ja(rF,nF,"app");const WA="firebasestorage.googleapis.com",KA="storageBucket",aF=120*1e3,sF=600*1e3;class Ir extends _s{constructor(e,r,n=0){super(qg(e),`Firebase Storage: ${r} (${qg(e)})`),this.status_=n,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,Ir.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return qg(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}var Rr;(function(t){t.UNKNOWN="unknown",t.OBJECT_NOT_FOUND="object-not-found",t.BUCKET_NOT_FOUND="bucket-not-found",t.PROJECT_NOT_FOUND="project-not-found",t.QUOTA_EXCEEDED="quota-exceeded",t.UNAUTHENTICATED="unauthenticated",t.UNAUTHORIZED="unauthorized",t.UNAUTHORIZED_APP="unauthorized-app",t.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",t.INVALID_CHECKSUM="invalid-checksum",t.CANCELED="canceled",t.INVALID_EVENT_NAME="invalid-event-name",t.INVALID_URL="invalid-url",t.INVALID_DEFAULT_BUCKET="invalid-default-bucket",t.NO_DEFAULT_BUCKET="no-default-bucket",t.CANNOT_SLICE_BLOB="cannot-slice-blob",t.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",t.NO_DOWNLOAD_URL="no-download-url",t.INVALID_ARGUMENT="invalid-argument",t.INVALID_ARGUMENT_COUNT="invalid-argument-count",t.APP_DELETED="app-deleted",t.INVALID_ROOT_OPERATION="invalid-root-operation",t.INVALID_FORMAT="invalid-format",t.INTERNAL_ERROR="internal-error",t.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})(Rr||(Rr={}));function qg(t){return"storage/"+t}function t1(){const t="An unknown error occurred, please check the error payload for server response.";return new Ir(Rr.UNKNOWN,t)}function iF(t){return new Ir(Rr.OBJECT_NOT_FOUND,"Object '"+t+"' does not exist.")}function lF(t){return new Ir(Rr.QUOTA_EXCEEDED,"Quota for bucket '"+t+"' exceeded, please view quota on https://firebase.google.com/pricing/.")}function oF(){const t="User is not authenticated, please authenticate using Firebase Authentication and try again.";return new Ir(Rr.UNAUTHENTICATED,t)}function cF(){return new Ir(Rr.UNAUTHORIZED_APP,"This app does not have permission to access Firebase Storage on this project.")}function uF(t){return new Ir(Rr.UNAUTHORIZED,"User does not have permission to access '"+t+"'.")}function fF(){return new Ir(Rr.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function hF(){return new Ir(Rr.CANCELED,"User canceled the upload/download.")}function dF(t){return new Ir(Rr.INVALID_URL,"Invalid URL '"+t+"'.")}function mF(t){return new Ir(Rr.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+t+"'.")}function pF(){return new Ir(Rr.NO_DEFAULT_BUCKET,"No default bucket found. Did you set the '"+KA+"' property when initializing the app?")}function gF(){return new Ir(Rr.CANNOT_SLICE_BLOB,"Cannot slice blob for upload. Please retry the upload.")}function xF(){return new Ir(Rr.NO_DOWNLOAD_URL,"The given file does not have any download URLs.")}function vF(t){return new Ir(Rr.UNSUPPORTED_ENVIRONMENT,`${t} is missing. Make sure to install the required polyfills. See https://firebase.google.com/docs/web/environments-js-sdk#polyfills for more information.`)}function Ox(t){return new Ir(Rr.INVALID_ARGUMENT,t)}function YA(){return new Ir(Rr.APP_DELETED,"The Firebase app was deleted.")}function yF(t){return new Ir(Rr.INVALID_ROOT_OPERATION,"The operation '"+t+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}function mf(t,e){return new Ir(Rr.INVALID_FORMAT,"String does not match format '"+t+"': "+e)}function Ju(t){throw new Ir(Rr.INTERNAL_ERROR,"Internal error: "+t)}class Ra{constructor(e,r){this.bucket=e,this.path_=r}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,r){let n;try{n=Ra.makeFromUrl(e,r)}catch{return new Ra(e,"")}if(n.path==="")return n;throw mF(e)}static makeFromUrl(e,r){let n=null;const a="([A-Za-z0-9.\\-_]+)";function l(z){z.path.charAt(z.path.length-1)==="/"&&(z.path_=z.path_.slice(0,-1))}const o="(/(.*))?$",u=new RegExp("^gs://"+a+o,"i"),h={bucket:1,path:3};function m(z){z.path_=decodeURIComponent(z.path)}const p="v[A-Za-z0-9_]+",v=r.replace(/[.]/g,"\\."),_="(/([^?#]*).*)?$",w=new RegExp(`^https?://${v}/${p}/b/${a}/o${_}`,"i"),E={bucket:1,path:3},T=r===WA?"(?:storage.googleapis.com|storage.cloud.google.com)":r,A="([^?#]*)",M=new RegExp(`^https?://${T}/${a}/${A}`,"i"),R=[{regex:u,indices:h,postModify:l},{regex:w,indices:E,postModify:m},{regex:M,indices:{bucket:1,path:2},postModify:m}];for(let z=0;z<R.length;z++){const re=R[z],te=re.regex.exec(e);if(te){const b=te[re.indices.bucket];let N=te[re.indices.path];N||(N=""),n=new Ra(b,N),re.postModify(n);break}}if(n==null)throw dF(e);return n}}class _F{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}function wF(t,e,r){let n=1,a=null,l=null,o=!1,u=0;function h(){return u===2}let m=!1;function p(...A){m||(m=!0,e.apply(null,A))}function v(A){a=setTimeout(()=>{a=null,t(w,h())},A)}function _(){l&&clearTimeout(l)}function w(A,...M){if(m){_();return}if(A){_(),p.call(null,A,...M);return}if(h()||o){_(),p.call(null,A,...M);return}n<64&&(n*=2);let R;u===1?(u=2,R=0):R=(n+Math.random())*1e3,v(R)}let E=!1;function T(A){E||(E=!0,_(),!m&&(a!==null?(A||(u=2),clearTimeout(a),v(0)):A||(u=1)))}return v(0),l=setTimeout(()=>{o=!0,T(!0)},r),T}function TF(t){t(!1)}function EF(t){return t!==void 0}function bF(t){return typeof t=="object"&&!Array.isArray(t)}function r1(t){return typeof t=="string"||t instanceof String}function $T(t){return n1()&&t instanceof Blob}function n1(){return typeof Blob<"u"}function XT(t,e,r,n){if(n<e)throw Ox(`Invalid value for '${t}'. Expected ${e} or greater.`);if(n>r)throw Ox(`Invalid value for '${t}'. Expected ${r} or less.`)}function a1(t,e,r){let n=e;return r==null&&(n=`https://${e}`),`${r}://${n}/v0${t}`}function $A(t){const e=encodeURIComponent;let r="?";for(const n in t)if(t.hasOwnProperty(n)){const a=e(n)+"="+e(t[n]);r=r+a+"&"}return r=r.slice(0,-1),r}var fo;(function(t){t[t.NO_ERROR=0]="NO_ERROR",t[t.NETWORK_ERROR=1]="NETWORK_ERROR",t[t.ABORT=2]="ABORT"})(fo||(fo={}));function SF(t,e){const r=t>=500&&t<600,a=[408,429].indexOf(t)!==-1,l=e.indexOf(t)!==-1;return r||a||l}class AF{constructor(e,r,n,a,l,o,u,h,m,p,v,_=!0){this.url_=e,this.method_=r,this.headers_=n,this.body_=a,this.successCodes_=l,this.additionalRetryCodes_=o,this.callback_=u,this.errorCallback_=h,this.timeout_=m,this.progressCallback_=p,this.connectionFactory_=v,this.retry=_,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((w,E)=>{this.resolve_=w,this.reject_=E,this.start_()})}start_(){const e=(n,a)=>{if(a){n(!1,new Gd(!1,null,!0));return}const l=this.connectionFactory_();this.pendingConnection_=l;const o=u=>{const h=u.loaded,m=u.lengthComputable?u.total:-1;this.progressCallback_!==null&&this.progressCallback_(h,m)};this.progressCallback_!==null&&l.addUploadProgressListener(o),l.send(this.url_,this.method_,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&l.removeUploadProgressListener(o),this.pendingConnection_=null;const u=l.getErrorCode()===fo.NO_ERROR,h=l.getStatus();if(!u||SF(h,this.additionalRetryCodes_)&&this.retry){const p=l.getErrorCode()===fo.ABORT;n(!1,new Gd(!1,null,p));return}const m=this.successCodes_.indexOf(h)!==-1;n(!0,new Gd(m,l))})},r=(n,a)=>{const l=this.resolve_,o=this.reject_,u=a.connection;if(a.wasSuccessCode)try{const h=this.callback_(u,u.getResponse());EF(h)?l(h):l()}catch(h){o(h)}else if(u!==null){const h=t1();h.serverResponse=u.getErrorText(),this.errorCallback_?o(this.errorCallback_(u,h)):o(h)}else if(a.canceled){const h=this.appDelete_?YA():hF();o(h)}else{const h=fF();o(h)}};this.canceled_?r(!1,new Gd(!1,null,!0)):this.backoffId_=wF(e,r,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&TF(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}}class Gd{constructor(e,r,n){this.wasSuccessCode=e,this.connection=r,this.canceled=!!n}}function NF(t,e){e!==null&&e.length>0&&(t.Authorization="Firebase "+e)}function CF(t,e){t["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}function kF(t,e){e&&(t["X-Firebase-GMPID"]=e)}function RF(t,e){e!==null&&(t["X-Firebase-AppCheck"]=e)}function DF(t,e,r,n,a,l,o=!0){const u=$A(t.urlParams),h=t.url+u,m=Object.assign({},t.headers);return kF(m,e),NF(m,r),CF(m,l),RF(m,n),new AF(h,t.method,m,t.body,t.successCodes,t.additionalRetryCodes,t.handler,t.errorHandler,t.timeout,t.progressCallback,a,o)}function IF(){return typeof BlobBuilder<"u"?BlobBuilder:typeof WebKitBlobBuilder<"u"?WebKitBlobBuilder:void 0}function OF(...t){const e=IF();if(e!==void 0){const r=new e;for(let n=0;n<t.length;n++)r.append(t[n]);return r.getBlob()}else{if(n1())return new Blob(t);throw new Ir(Rr.UNSUPPORTED_ENVIRONMENT,"This browser doesn't seem to support creating Blobs")}}function MF(t,e,r){return t.webkitSlice?t.webkitSlice(e,r):t.mozSlice?t.mozSlice(e,r):t.slice?t.slice(e,r):null}function jF(t){if(typeof atob>"u")throw vF("base-64");return atob(t)}const Ds={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"};class Wg{constructor(e,r){this.data=e,this.contentType=r||null}}function FF(t,e){switch(t){case Ds.RAW:return new Wg(XA(e));case Ds.BASE64:case Ds.BASE64URL:return new Wg(QA(t,e));case Ds.DATA_URL:return new Wg(LF(e),UF(e))}throw t1()}function XA(t){const e=[];for(let r=0;r<t.length;r++){let n=t.charCodeAt(r);if(n<=127)e.push(n);else if(n<=2047)e.push(192|n>>6,128|n&63);else if((n&64512)===55296)if(!(r<t.length-1&&(t.charCodeAt(r+1)&64512)===56320))e.push(239,191,189);else{const l=n,o=t.charCodeAt(++r);n=65536|(l&1023)<<10|o&1023,e.push(240|n>>18,128|n>>12&63,128|n>>6&63,128|n&63)}else(n&64512)===56320?e.push(239,191,189):e.push(224|n>>12,128|n>>6&63,128|n&63)}return new Uint8Array(e)}function PF(t){let e;try{e=decodeURIComponent(t)}catch{throw mf(Ds.DATA_URL,"Malformed data URL.")}return XA(e)}function QA(t,e){switch(t){case Ds.BASE64:{const a=e.indexOf("-")!==-1,l=e.indexOf("_")!==-1;if(a||l)throw mf(t,"Invalid character '"+(a?"-":"_")+"' found: is it base64url encoded?");break}case Ds.BASE64URL:{const a=e.indexOf("+")!==-1,l=e.indexOf("/")!==-1;if(a||l)throw mf(t,"Invalid character '"+(a?"+":"/")+"' found: is it base64 encoded?");e=e.replace(/-/g,"+").replace(/_/g,"/");break}}let r;try{r=jF(e)}catch(a){throw a.message.includes("polyfill")?a:mf(t,"Invalid character found")}const n=new Uint8Array(r.length);for(let a=0;a<r.length;a++)n[a]=r.charCodeAt(a);return n}class JA{constructor(e){this.base64=!1,this.contentType=null;const r=e.match(/^data:([^,]+)?,/);if(r===null)throw mf(Ds.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");const n=r[1]||null;n!=null&&(this.base64=BF(n,";base64"),this.contentType=this.base64?n.substring(0,n.length-7):n),this.rest=e.substring(e.indexOf(",")+1)}}function LF(t){const e=new JA(t);return e.base64?QA(Ds.BASE64,e.rest):PF(e.rest)}function UF(t){return new JA(t).contentType}function BF(t,e){return t.length>=e.length?t.substring(t.length-e.length)===e:!1}class hl{constructor(e,r){let n=0,a="";$T(e)?(this.data_=e,n=e.size,a=e.type):e instanceof ArrayBuffer?(r?this.data_=new Uint8Array(e):(this.data_=new Uint8Array(e.byteLength),this.data_.set(new Uint8Array(e))),n=this.data_.length):e instanceof Uint8Array&&(r?this.data_=e:(this.data_=new Uint8Array(e.length),this.data_.set(e)),n=e.length),this.size_=n,this.type_=a}size(){return this.size_}type(){return this.type_}slice(e,r){if($T(this.data_)){const n=this.data_,a=MF(n,e,r);return a===null?null:new hl(a)}else{const n=new Uint8Array(this.data_.buffer,e,r-e);return new hl(n,!0)}}static getBlob(...e){if(n1()){const r=e.map(n=>n instanceof hl?n.data_:n);return new hl(OF.apply(null,r))}else{const r=e.map(o=>r1(o)?FF(Ds.RAW,o).data:o.data_);let n=0;r.forEach(o=>{n+=o.byteLength});const a=new Uint8Array(n);let l=0;return r.forEach(o=>{for(let u=0;u<o.length;u++)a[l++]=o[u]}),new hl(a,!0)}}uploadData(){return this.data_}}function ZA(t){let e;try{e=JSON.parse(t)}catch{return null}return bF(e)?e:null}function VF(t){if(t.length===0)return null;const e=t.lastIndexOf("/");return e===-1?"":t.slice(0,e)}function zF(t,e){const r=e.split("/").filter(n=>n.length>0).join("/");return t.length===0?r:t+"/"+r}function eN(t){const e=t.lastIndexOf("/",t.length-2);return e===-1?t:t.slice(e+1)}function HF(t,e){return e}class $n{constructor(e,r,n,a){this.server=e,this.local=r||e,this.writable=!!n,this.xform=a||HF}}let qd=null;function GF(t){return!r1(t)||t.length<2?t:eN(t)}function tN(){if(qd)return qd;const t=[];t.push(new $n("bucket")),t.push(new $n("generation")),t.push(new $n("metageneration")),t.push(new $n("name","fullPath",!0));function e(l,o){return GF(o)}const r=new $n("name");r.xform=e,t.push(r);function n(l,o){return o!==void 0?Number(o):o}const a=new $n("size");return a.xform=n,t.push(a),t.push(new $n("timeCreated")),t.push(new $n("updated")),t.push(new $n("md5Hash",null,!0)),t.push(new $n("cacheControl",null,!0)),t.push(new $n("contentDisposition",null,!0)),t.push(new $n("contentEncoding",null,!0)),t.push(new $n("contentLanguage",null,!0)),t.push(new $n("contentType",null,!0)),t.push(new $n("metadata","customMetadata",!0)),qd=t,qd}function qF(t,e){function r(){const n=t.bucket,a=t.fullPath,l=new Ra(n,a);return e._makeStorageReference(l)}Object.defineProperty(t,"ref",{get:r})}function WF(t,e,r){const n={};n.type="file";const a=r.length;for(let l=0;l<a;l++){const o=r[l];n[o.local]=o.xform(n,e[o.server])}return qF(n,t),n}function rN(t,e,r){const n=ZA(e);return n===null?null:WF(t,n,r)}function KF(t,e,r,n){const a=ZA(e);if(a===null||!r1(a.downloadTokens))return null;const l=a.downloadTokens;if(l.length===0)return null;const o=encodeURIComponent;return l.split(",").map(m=>{const p=t.bucket,v=t.fullPath,_="/b/"+o(p)+"/o/"+o(v),w=a1(_,r,n),E=$A({alt:"media",token:m});return w+E})[0]}function YF(t,e){const r={},n=e.length;for(let a=0;a<n;a++){const l=e[a];l.writable&&(r[l.server]=t[l.local])}return JSON.stringify(r)}class nN{constructor(e,r,n,a){this.url=e,this.method=r,this.handler=n,this.timeout=a,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}}function aN(t){if(!t)throw t1()}function $F(t,e){function r(n,a){const l=rN(t,a,e);return aN(l!==null),l}return r}function XF(t,e){function r(n,a){const l=rN(t,a,e);return aN(l!==null),KF(l,a,t.host,t._protocol)}return r}function sN(t){function e(r,n){let a;return r.getStatus()===401?r.getErrorText().includes("Firebase App Check token is invalid")?a=cF():a=oF():r.getStatus()===402?a=lF(t.bucket):r.getStatus()===403?a=uF(t.path):a=n,a.status=r.getStatus(),a.serverResponse=n.serverResponse,a}return e}function QF(t){const e=sN(t);function r(n,a){let l=e(n,a);return n.getStatus()===404&&(l=iF(t.path)),l.serverResponse=a.serverResponse,l}return r}function JF(t,e,r){const n=e.fullServerUrl(),a=a1(n,t.host,t._protocol),l="GET",o=t.maxOperationRetryTime,u=new nN(a,l,XF(t,r),o);return u.errorHandler=QF(e),u}function ZF(t,e){return t&&t.contentType||e&&e.type()||"application/octet-stream"}function eP(t,e,r){const n=Object.assign({},r);return n.fullPath=t.path,n.size=e.size(),n.contentType||(n.contentType=ZF(null,e)),n}function tP(t,e,r,n,a){const l=e.bucketOnlyServerUrl(),o={"X-Goog-Upload-Protocol":"multipart"};function u(){let R="";for(let z=0;z<2;z++)R=R+Math.random().toString().slice(2);return R}const h=u();o["Content-Type"]="multipart/related; boundary="+h;const m=eP(e,n,a),p=YF(m,r),v="--"+h+`\r
Content-Type: application/json; charset=utf-8\r
\r
`+p+`\r
--`+h+`\r
Content-Type: `+m.contentType+`\r
\r
`,_=`\r
--`+h+"--",w=hl.getBlob(v,n,_);if(w===null)throw gF();const E={name:m.fullPath},T=a1(l,t.host,t._protocol),A="POST",M=t.maxUploadRetryTime,F=new nN(T,A,$F(t,r),M);return F.urlParams=E,F.headers=o,F.body=w.uploadData(),F.errorHandler=sN(e),F}class rP{constructor(){this.sent_=!1,this.xhr_=new XMLHttpRequest,this.initXhr(),this.errorCode_=fo.NO_ERROR,this.sendPromise_=new Promise(e=>{this.xhr_.addEventListener("abort",()=>{this.errorCode_=fo.ABORT,e()}),this.xhr_.addEventListener("error",()=>{this.errorCode_=fo.NETWORK_ERROR,e()}),this.xhr_.addEventListener("load",()=>{e()})})}send(e,r,n,a){if(this.sent_)throw Ju("cannot .send() more than once");if(this.sent_=!0,this.xhr_.open(r,e,!0),a!==void 0)for(const l in a)a.hasOwnProperty(l)&&this.xhr_.setRequestHeader(l,a[l].toString());return n!==void 0?this.xhr_.send(n):this.xhr_.send(),this.sendPromise_}getErrorCode(){if(!this.sent_)throw Ju("cannot .getErrorCode() before sending");return this.errorCode_}getStatus(){if(!this.sent_)throw Ju("cannot .getStatus() before sending");try{return this.xhr_.status}catch{return-1}}getResponse(){if(!this.sent_)throw Ju("cannot .getResponse() before sending");return this.xhr_.response}getErrorText(){if(!this.sent_)throw Ju("cannot .getErrorText() before sending");return this.xhr_.statusText}abort(){this.xhr_.abort()}getResponseHeader(e){return this.xhr_.getResponseHeader(e)}addUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.addEventListener("progress",e)}removeUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.removeEventListener("progress",e)}}class nP extends rP{initXhr(){this.xhr_.responseType="text"}}function iN(){return new nP}class wo{constructor(e,r){this._service=e,r instanceof Ra?this._location=r:this._location=Ra.makeFromUrl(r,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,r){return new wo(e,r)}get root(){const e=new Ra(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return eN(this._location.path)}get storage(){return this._service}get parent(){const e=VF(this._location.path);if(e===null)return null;const r=new Ra(this._location.bucket,e);return new wo(this._service,r)}_throwIfRoot(e){if(this._location.path==="")throw yF(e)}}function aP(t,e,r){t._throwIfRoot("uploadBytes");const n=tP(t.storage,t._location,tN(),new hl(e,!0),r);return t.storage.makeRequestWithTokens(n,iN).then(a=>({metadata:a,ref:t}))}function sP(t){t._throwIfRoot("getDownloadURL");const e=JF(t.storage,t._location,tN());return t.storage.makeRequestWithTokens(e,iN).then(r=>{if(r===null)throw xF();return r})}function iP(t,e){const r=zF(t._location.path,e),n=new Ra(t._location.bucket,r);return new wo(t.storage,n)}function lP(t){return/^[A-Za-z]+:\/\//.test(t)}function oP(t,e){return new wo(t,e)}function lN(t,e){if(t instanceof s1){const r=t;if(r._bucket==null)throw pF();const n=new wo(r,r._bucket);return e!=null?lN(n,e):n}else return e!==void 0?iP(t,e):t}function cP(t,e){if(e&&lP(e)){if(t instanceof s1)return oP(t,e);throw Ox("To use ref(service, url), the first argument must be a Storage instance.")}else return lN(t,e)}function QT(t,e){const r=e?.[KA];return r==null?null:Ra.makeFromBucketSpec(r,t)}function uP(t,e,r,n={}){t.host=`${e}:${r}`,t._protocol="http";const{mockUserToken:a}=n;a&&(t._overrideAuthToken=typeof a=="string"?a:Pb(a,t.app.options.projectId))}class s1{constructor(e,r,n,a,l){this.app=e,this._authProvider=r,this._appCheckProvider=n,this._url=a,this._firebaseVersion=l,this._bucket=null,this._host=WA,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=aF,this._maxUploadRetryTime=sF,this._requests=new Set,a!=null?this._bucket=Ra.makeFromBucketSpec(a,this._host):this._bucket=QT(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=Ra.makeFromBucketSpec(this._url,e):this._bucket=QT(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){XT("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){XT("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const r=await e.getToken();if(r!==null)return r.accessToken}return null}async _getAppCheckToken(){const e=this._appCheckProvider.getImmediate({optional:!0});return e?(await e.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new wo(this,e)}_makeRequest(e,r,n,a,l=!0){if(this._deleted)return new _F(YA());{const o=DF(e,this._appId,n,a,r,this._firebaseVersion,l);return this._requests.add(o),o.getPromise().then(()=>this._requests.delete(o),()=>this._requests.delete(o)),o}}async makeRequestWithTokens(e,r){const[n,a]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,r,n,a).getPromise()}}const JT="@firebase/storage",ZT="0.13.2";const oN="storage";function fP(t,e,r){return t=vr(t),aP(t,e,r)}function hP(t){return t=vr(t),sP(t)}function dP(t,e){return t=vr(t),cP(t,e)}function mP(t=Q0(),e){t=vr(t);const n=Qf(t,oN).getImmediate({identifier:e}),a=nv("storage");return a&&pP(n,...a),n}function pP(t,e,r,n={}){uP(t,e,r,n)}function gP(t,{instanceIdentifier:e}){const r=t.getProvider("app").getImmediate(),n=t.getProvider("auth-internal"),a=t.getProvider("app-check-internal");return new s1(r,n,a,e,So)}function xP(){Tl(new vi(oN,gP,"PUBLIC").setMultipleInstances(!0)),Ja(JT,ZT,""),Ja(JT,ZT,"esm2017")}xP();const vP="type.googleapis.com/google.protobuf.Int64Value",yP="type.googleapis.com/google.protobuf.UInt64Value";function cN(t,e){const r={};for(const n in t)t.hasOwnProperty(n)&&(r[n]=e(t[n]));return r}function Mx(t){if(t==null)return null;if(t instanceof Number&&(t=t.valueOf()),typeof t=="number"&&isFinite(t)||t===!0||t===!1||Object.prototype.toString.call(t)==="[object String]")return t;if(t instanceof Date)return t.toISOString();if(Array.isArray(t))return t.map(e=>Mx(e));if(typeof t=="function"||typeof t=="object")return cN(t,e=>Mx(e));throw new Error("Data cannot be encoded in JSON: "+t)}function M0(t){if(t==null)return t;if(t["@type"])switch(t["@type"]){case vP:case yP:{const e=Number(t.value);if(isNaN(e))throw new Error("Data cannot be decoded from JSON: "+t);return e}default:throw new Error("Data cannot be decoded from JSON: "+t)}return Array.isArray(t)?t.map(e=>M0(e)):typeof t=="function"||typeof t=="object"?cN(t,e=>M0(e)):t}const i1="functions";const eE={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class kc extends _s{constructor(e,r,n){super(`${i1}/${e}`,r||""),this.details=n}}function _P(t){if(t>=200&&t<300)return"ok";switch(t){case 0:return"internal";case 400:return"invalid-argument";case 401:return"unauthenticated";case 403:return"permission-denied";case 404:return"not-found";case 409:return"aborted";case 429:return"resource-exhausted";case 499:return"cancelled";case 500:return"internal";case 501:return"unimplemented";case 503:return"unavailable";case 504:return"deadline-exceeded"}return"unknown"}function wP(t,e){let r=_P(t),n=r,a;try{const l=e&&e.error;if(l){const o=l.status;if(typeof o=="string"){if(!eE[o])return new kc("internal","internal");r=eE[o],n=o}const u=l.message;typeof u=="string"&&(n=u),a=l.details,a!==void 0&&(a=M0(a))}}catch{}return r==="ok"?null:new kc(r,n,a)}class TP{constructor(e,r,n){this.auth=null,this.messaging=null,this.appCheck=null,this.auth=e.getImmediate({optional:!0}),this.messaging=r.getImmediate({optional:!0}),this.auth||e.get().then(a=>this.auth=a,()=>{}),this.messaging||r.get().then(a=>this.messaging=a,()=>{}),this.appCheck||n.get().then(a=>this.appCheck=a,()=>{})}async getAuthToken(){if(this.auth)try{const e=await this.auth.getToken();return e?.accessToken}catch{return}}async getMessagingToken(){if(!(!this.messaging||!("Notification"in self)||Notification.permission!=="granted"))try{return await this.messaging.getToken()}catch{return}}async getAppCheckToken(e){if(this.appCheck){const r=e?await this.appCheck.getLimitedUseToken():await this.appCheck.getToken();return r.error?null:r.token}return null}async getContext(e){const r=await this.getAuthToken(),n=await this.getMessagingToken(),a=await this.getAppCheckToken(e);return{authToken:r,messagingToken:n,appCheckToken:a}}}const jx="us-central1";function EP(t){let e=null;return{promise:new Promise((r,n)=>{e=setTimeout(()=>{n(new kc("deadline-exceeded","deadline-exceeded"))},t)}),cancel:()=>{e&&clearTimeout(e)}}}class bP{constructor(e,r,n,a,l=jx,o){this.app=e,this.fetchImpl=o,this.emulatorOrigin=null,this.contextProvider=new TP(r,n,a),this.cancelAllRequests=new Promise(u=>{this.deleteService=()=>Promise.resolve(u())});try{const u=new URL(l);this.customDomain=u.origin+(u.pathname==="/"?"":u.pathname),this.region=jx}catch{this.customDomain=null,this.region=l}}_delete(){return this.deleteService()}_url(e){const r=this.app.options.projectId;return this.emulatorOrigin!==null?`${this.emulatorOrigin}/${r}/${this.region}/${e}`:this.customDomain!==null?`${this.customDomain}/${e}`:`https://${this.region}-${r}.cloudfunctions.net/${e}`}}function SP(t,e,r){t.emulatorOrigin=`http://${e}:${r}`}function AP(t,e,r){return(n=>CP(t,e,n,{}))}async function NP(t,e,r,n){r["Content-Type"]="application/json";let a;try{a=await n(t,{method:"POST",body:JSON.stringify(e),headers:r})}catch{return{status:0,json:null}}let l=null;try{l=await a.json()}catch{}return{status:a.status,json:l}}function CP(t,e,r,n){const a=t._url(e);return kP(t,a,r,n)}async function kP(t,e,r,n){r=Mx(r);const a={data:r},l={},o=await t.contextProvider.getContext(n.limitedUseAppCheckTokens);o.authToken&&(l.Authorization="Bearer "+o.authToken),o.messagingToken&&(l["Firebase-Instance-ID-Token"]=o.messagingToken),o.appCheckToken!==null&&(l["X-Firebase-AppCheck"]=o.appCheckToken);const u=n.timeout||7e4,h=EP(u),m=await Promise.race([NP(e,a,l,t.fetchImpl),h.promise,t.cancelAllRequests]);if(h.cancel(),!m)throw new kc("cancelled","Firebase Functions instance was deleted.");const p=wP(m.status,m.json);if(p)throw p;if(!m.json)throw new kc("internal","Response is not valid JSON object.");let v=m.json.data;if(typeof v>"u"&&(v=m.json.result),typeof v>"u")throw new kc("internal","Response is missing data field.");return{data:M0(v)}}const tE="@firebase/functions",rE="0.11.8";const RP="auth-internal",DP="app-check-internal",IP="messaging-internal";function OP(t,e){const r=(n,{instanceIdentifier:a})=>{const l=n.getProvider("app").getImmediate(),o=n.getProvider(RP),u=n.getProvider(IP),h=n.getProvider(DP);return new bP(l,o,u,h,a,t)};Tl(new vi(i1,r,"PUBLIC").setMultipleInstances(!0)),Ja(tE,rE,e),Ja(tE,rE,"esm2017")}function MP(t=Q0(),e=jx){const n=Qf(vr(t),i1).getImmediate({identifier:e}),a=nv("functions");return a&&jP(n,...a),n}function jP(t,e,r){SP(vr(t),e,r)}function FP(t,e,r){return AP(vr(t),e)}OP(fetch.bind(self));const PP={apiKey:"AIzaSyD5-h96WDy4SzuP1XqClyBbpd1CL_tNZQw",authDomain:"my-xmas-movies.firebaseapp.com",projectId:"my-xmas-movies",storageBucket:"my-xmas-movies.firebasestorage.app",messagingSenderId:"534280822678",appId:"1:534280822678:web:5e91b52cb61b7ed71a47b7"},_m=Bb(PP),pf=tM(_m),uN=new Rs;uN.setCustomParameters({prompt:"select_account"});const LP=uN,rt=Bj(_m),UP=mP(_m),BP=MP(_m),fN=q.createContext(void 0),An=()=>{const t=q.useContext(fN);if(t===void 0)throw new Error("useAuth must be used within an AuthProvider");return t},VP=({children:t})=>{const[e,r]=q.useState(null),[n,a]=q.useState(null),[l,o]=q.useState(!0),[u,h]=q.useState(null);q.useEffect(()=>{const _=uS(pf,async w=>{if(r(w),h(null),w)try{const E=Pt(rt,"users",w.uid),T=await Zn(E);if(T.exists())await Ia(E,{lastLoginAt:eF()},{merge:!0}),a(T.data());else{const A={email:w.email||"",displayName:w.displayName||"User",photoURL:w.photoURL||void 0,createdAt:new Date,lastLoginAt:new Date};await Ia(E,A),a({id:w.uid,...A})}}catch(E){console.error("Error fetching user profile:",E),h("Failed to load user profile")}else a(null);o(!1)});return()=>_()},[]);const v={currentUser:e,userProfile:n,isLoading:l,error:u,signInWithGoogle:async()=>{try{h(null),o(!0);const _=new Rs;await wS(pf,_)}catch(_){console.error("Login error:",_),h(_.message||"Failed to sign in")}finally{o(!1)}},signOut:async()=>{try{await q3(pf)}catch(_){console.error("Sign out error:",_),h(_.message||"Failed to sign out")}}};return d.jsx(fN.Provider,{value:v,children:t})},Qc=()=>{const[t,e]=q.useState(!1),[r,n]=q.useState(!0),[a,l]=q.useState(null),[o,u]=q.useState(null);return q.useEffect(()=>{const h=uS(pf,async m=>{if(n(!0),l(null),!m){e(!1),u(null),n(!1);return}u({uid:m.uid,email:m.email});try{const v=(await $b(m,!0)).claims.admin===!0;e(v)}catch(p){console.error("Error checking admin status:",p),l("Failed to verify admin status"),e(!1)}finally{n(!1)}});return()=>h()},[]),{isAdmin:t,loading:r,error:a,currentUser:o}},zP=({snowflakeCount:t=100,mobileSnowflakeCount:e=50})=>{const[r,n]=q.useState(!1),[a,l]=q.useState(t),o=q.useRef(null),u=q.useRef([]),h=q.useRef(0);return q.useEffect(()=>{const m=()=>{const p=window.matchMedia("(max-width: 768px)").matches;n(p),l(p?e:t)};return m(),window.addEventListener("resize",m),()=>{window.removeEventListener("resize",m)}},[t,e]),q.useEffect(()=>{const m=o.current;if(!m)return;const p=m.getContext("2d");if(!p)return;const v=()=>{m.width=window.innerWidth,m.height=window.innerHeight},_=()=>{u.current=[];for(let A=0;A<a;A++)u.current.push({x:Math.random()*m.width,y:Math.random()*m.height,size:r?Math.random()*3+1:Math.random()*4+1,speed:r?Math.random()*.8+.3:Math.random()*1+.5,opacity:r?Math.random()*.5+.2:Math.random()*.6+.3,wind:r?Math.random()*.3-.15:Math.random()*.5-.25})},w=A=>{p.beginPath(),p.arc(A.x,A.y,A.size,0,Math.PI*2),p.fillStyle=`rgba(255, 255, 255, ${A.opacity})`,p.fill()},E=A=>{A.y+=A.speed,A.x+=A.wind,A.y>m.height&&(A.y=-10,A.x=Math.random()*m.width),A.x>m.width?A.x=0:A.x<0&&(A.x=m.width)},T=()=>{p.clearRect(0,0,m.width,m.height),u.current.forEach(A=>{w(A),E(A)}),h.current=requestAnimationFrame(T)};return window.addEventListener("resize",v),v(),_(),T(),()=>{window.removeEventListener("resize",v),cancelAnimationFrame(h.current)}},[a]),d.jsx("canvas",{ref:o,className:"fixed top-0 left-0 w-full h-full pointer-events-none z-10","aria-hidden":"true"})},HP=()=>{const[t,e]=q.useState(!1),[r,n]=q.useState(null),[a,l]=q.useState(!1);q.useEffect(()=>{const h=/iPad|iPhone|iPod/.test(navigator.userAgent)&&!window.MSStream;l(h);const m=p=>{p.preventDefault(),n(p),e(!0)};return window.addEventListener("beforeinstallprompt",m),window.matchMedia("(display-mode: standalone)").matches&&e(!1),()=>{window.removeEventListener("beforeinstallprompt",m)}},[]);const o=async()=>{if(!r)return;r.prompt();const{outcome:h}=await r.userChoice;n(null),e(!1),console.log(`User ${h==="accepted"?"accepted":"dismissed"} the install prompt`)},u=()=>{e(!1),localStorage.setItem("installPromptDismissed","true")};return t?d.jsxs("div",{className:"fixed bottom-0 left-0 right-0 bg-green-800 text-white p-4 shadow-lg z-50 flex items-center justify-between",children:[d.jsxs("div",{className:"flex items-center",children:[d.jsx("div",{className:"mr-3 text-2xl",children:d.jsx("i",{className:"fas fa-gift"})}),d.jsx("div",{children:a?d.jsxs("p",{children:["Install this app on your device: tap ",d.jsx("i",{className:"fas fa-share"}),' and then "Add to Home Screen"']}):d.jsx("p",{children:"Add Christmas Movies to your home screen!"})})]}),d.jsxs("div",{className:"flex items-center",children:[!a&&d.jsx("button",{onClick:o,className:"bg-red-700 hover:bg-red-800 text-white py-1 px-4 rounded-full mr-2",children:"Install"}),d.jsx("button",{onClick:u,className:"bg-transparent hover:bg-green-700 text-white py-1 px-2 rounded-full",children:d.jsx("i",{className:"fas fa-times"})})]})]}):null};function GP(){const{currentUser:t}=An(),{isAdmin:e}=Qc(),[r,n]=q.useState(!1),a=ys();q.useEffect(()=>(r?document.body.style.overflow="hidden":document.body.style.overflow="",()=>{document.body.style.overflow=""}),[r]),q.useEffect(()=>{r&&n(!1)},[a.pathname]);const l=()=>{n(!r)};return d.jsxs("div",{className:"min-h-screen bg-gradient-to-b from-xmas-bg to-xmas-card bg-opacity-95",children:[d.jsx(zP,{snowflakeCount:150,mobileSnowflakeCount:40}),d.jsx(HP,{}),d.jsxs("div",{className:"navbar bg-gradient-to-r from-xmas-card via-xmas-card to-xmas-bg border-b border-xmas-gold px-2 sm:px-4 shadow-lg relative overflow-hidden",children:[d.jsx("div",{className:"absolute top-0 left-0 w-full h-1 bg-gradient-to-r from-xmas-gold via-transparent to-xmas-gold opacity-60"}),d.jsx("div",{className:"absolute -bottom-4 left-0 right-0 h-8 snow-accumulation-fast"}),d.jsxs("div",{className:"flex items-center",children:[d.jsx("button",{className:"btn btn-ghost btn-sm md:hidden relative z-10",onClick:l,"aria-label":"Toggle navigation menu",children:d.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",className:"inline-block w-5 h-5 stroke-current",children:d.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M4 6h16M4 12h16M4 18h16"})})}),d.jsxs(gt,{to:"/",className:"hidden sm:flex items-center group",children:[d.jsxs("div",{className:"relative",children:[d.jsx("div",{className:"absolute -inset-1 bg-gradient-to-r from-xmas-gold to-xmas-line rounded-full opacity-70 group-hover:opacity-100 blur transition duration-200"}),d.jsx("div",{className:"relative flex items-center justify-center w-10 h-10 bg-xmas-card rounded-full border border-xmas-gold overflow-hidden",children:d.jsx("img",{src:"/Santa.png",alt:"Santa",className:"w-full h-full object-cover group-hover:scale-110 transition-transform duration-300"})})]}),d.jsx("div",{className:"ml-3 font-christmas text-xl sm:text-2xl bg-gradient-to-br from-xmas-gold via-xmas-snow to-xmas-gold bg-clip-text text-transparent font-bold",children:"Christmas Movies"})]}),d.jsxs(gt,{to:"/",className:"sm:hidden flex items-center",children:[d.jsx("div",{className:"w-8 h-8 flex items-center justify-center rounded-full bg-xmas-card border border-xmas-gold overflow-hidden",children:d.jsx("img",{src:"/Santa.png",alt:"Santa",className:"w-full h-full object-cover"})}),d.jsx("span",{className:"ml-2 font-christmas text-lg text-xmas-gold",children:"Christmas Movies"})]})]}),d.jsx("div",{className:"flex-1"}),d.jsxs("div",{className:"flex items-center gap-1 sm:gap-2",children:[t&&d.jsxs(gt,{to:"/profile",className:"btn btn-primary btn-sm hidden md:flex",children:[d.jsx("i",{className:"fas fa-user-circle mr-1"})," Profile"]}),t?d.jsxs("div",{className:"dropdown dropdown-end",children:[d.jsx("label",{tabIndex:0,className:"btn btn-ghost btn-circle avatar cursor-pointer",children:d.jsx("div",{className:"w-10 rounded-full border border-xmas-gold",children:t.photoURL?d.jsx("img",{src:t.photoURL,alt:"Profile"}):d.jsx("div",{className:"bg-xmas-card flex items-center justify-center h-full",children:d.jsx("i",{className:"fas fa-user text-xmas-gold"})})})}),d.jsxs("ul",{tabIndex:0,className:"dropdown-content menu menu-sm mt-3 z-[1] p-2 shadow bg-xmas-card rounded-box w-52 border border-xmas-gold",children:[d.jsx("li",{children:d.jsxs(gt,{to:"/profile",className:"justify-between",children:["Profile",d.jsx("i",{className:"fas fa-user-circle"})]})}),d.jsx("li",{children:d.jsxs(gt,{to:"/movies",children:["My Movies",d.jsx("i",{className:"fas fa-film"})]})}),d.jsx("li",{children:d.jsxs(gt,{to:"/random",children:["Random Movie",d.jsx("i",{className:"fas fa-random"})]})}),d.jsx("li",{children:d.jsxs(gt,{to:"/import",children:["Import Movies",d.jsx("i",{className:"fas fa-file-import"})]})}),e&&d.jsx("li",{children:d.jsxs(gt,{to:"/admin",className:"text-xmas-gold",children:["Admin Dashboard",d.jsx("i",{className:"fas fa-crown"})]})})]})]}):d.jsxs(gt,{to:"/login",className:"btn btn-primary btn-sm",children:[d.jsx("i",{className:"fas fa-sign-in-alt mr-1"})," Sign In"]})]})]}),d.jsx("div",{className:`fixed inset-0 bg-black bg-opacity-70 z-20 transition-opacity duration-300 md:hidden ${r?"opacity-100":"opacity-0 pointer-events-none"}`,onClick:l}),d.jsxs("div",{className:`fixed top-0 left-0 h-full w-72 bg-gradient-to-b from-xmas-bg to-xmas-card border-r border-xmas-gold z-30 transform transition-transform duration-300 ease-in-out md:hidden shadow-xl ${r?"translate-x-0":"-translate-x-full"}`,children:[d.jsxs("div",{className:"relative overflow-hidden",children:[d.jsx("div",{className:"absolute top-0 left-0 w-full h-1 bg-gradient-to-r from-xmas-gold via-transparent to-xmas-gold opacity-60"}),d.jsxs("div",{className:"flex justify-between items-center p-4 border-b border-xmas-gold bg-xmas-card bg-opacity-80",children:[d.jsxs("div",{className:"flex items-center",children:[d.jsx("div",{className:"w-9 h-9 flex items-center justify-center rounded-full bg-xmas-card border border-xmas-gold shadow-lg overflow-hidden",children:d.jsx("img",{src:"/Santa.png",alt:"Santa",className:"w-full h-full object-cover"})}),d.jsx("div",{className:"ml-3 font-christmas text-xl bg-gradient-to-br from-xmas-gold via-xmas-snow to-xmas-gold bg-clip-text text-transparent font-bold",children:"Christmas Movies"})]}),d.jsx("button",{className:"btn btn-ghost btn-sm text-xmas-text hover:text-xmas-line",onClick:l,"aria-label":"Close navigation menu",children:d.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:d.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})]}),d.jsx("div",{className:"overflow-y-auto h-full pb-20",children:d.jsx("div",{className:"p-4 pt-6",children:d.jsxs("div",{className:"mb-6",children:[d.jsx("h3",{className:"font-christmas text-xl text-xmas-gold mb-4 pl-2 border-l-2 border-xmas-line",children:"Navigation"}),d.jsxs("ul",{className:"space-y-3",children:[d.jsx("li",{children:d.jsx(sl,{to:"/",onClick:l,className:({isActive:o})=>o?"flex items-center p-2 pl-3 rounded-md bg-gradient-to-r from-xmas-card to-transparent border-l-2 border-xmas-gold text-xmas-gold font-medium":"flex items-center p-2 pl-3 rounded-md hover:bg-xmas-card hover:bg-opacity-50 text-xmas-text hover:text-xmas-gold transition-all duration-200",children:({isActive:o})=>d.jsxs(d.Fragment,{children:[d.jsx("i",{className:"fas fa-home mr-3 text-xmas-gold"}),d.jsx("span",{children:"Home"}),d.jsx("i",{className:`fas fa-snowflake ml-auto text-xmas-gold opacity-70 ${o?"visible":"invisible"}`})]})})}),t?d.jsxs(d.Fragment,{children:[d.jsx("li",{children:d.jsx(sl,{to:"/movies",onClick:l,className:({isActive:o})=>o?"flex items-center p-2 pl-3 rounded-md bg-gradient-to-r from-xmas-card to-transparent border-l-2 border-xmas-gold text-xmas-gold font-medium":"flex items-center p-2 pl-3 rounded-md hover:bg-xmas-card hover:bg-opacity-50 text-xmas-text hover:text-xmas-gold transition-all duration-200",children:({isActive:o})=>d.jsxs(d.Fragment,{children:[d.jsx("i",{className:"fas fa-film mr-3 text-xmas-gold"}),d.jsx("span",{children:"My Movies"}),d.jsx("i",{className:`fas fa-snowflake ml-auto text-xmas-gold opacity-70 ${o?"visible":"invisible"}`})]})})}),d.jsx("li",{children:d.jsx(sl,{to:"/random",onClick:l,className:({isActive:o})=>o?"flex items-center p-2 pl-3 rounded-md bg-gradient-to-r from-xmas-card to-transparent border-l-2 border-xmas-gold text-xmas-gold font-medium":"flex items-center p-2 pl-3 rounded-md hover:bg-xmas-card hover:bg-opacity-50 text-xmas-text hover:text-xmas-gold transition-all duration-200",children:({isActive:o})=>d.jsxs(d.Fragment,{children:[d.jsx("i",{className:"fas fa-random mr-3 text-xmas-gold"}),d.jsx("span",{children:"Random Movie"}),d.jsx("i",{className:`fas fa-snowflake ml-auto text-xmas-gold opacity-70 ${o?"visible":"invisible"}`})]})})}),d.jsx("li",{children:d.jsx(sl,{to:"/achievements",onClick:l,className:({isActive:o})=>o?"flex items-center p-2 pl-3 rounded-md bg-gradient-to-r from-xmas-card to-transparent border-l-2 border-xmas-gold text-xmas-gold font-medium":"flex items-center p-2 pl-3 rounded-md hover:bg-xmas-card hover:bg-opacity-50 text-xmas-text hover:text-xmas-gold transition-all duration-200",children:({isActive:o})=>d.jsxs(d.Fragment,{children:[d.jsx("i",{className:"fas fa-trophy mr-3 text-xmas-gold"}),d.jsx("span",{children:"Achievements"}),d.jsx("i",{className:`fas fa-snowflake ml-auto text-xmas-gold opacity-70 ${o?"visible":"invisible"}`})]})})}),d.jsx("li",{children:d.jsx(sl,{to:"/import",onClick:l,className:({isActive:o})=>o?"flex items-center p-2 pl-3 rounded-md bg-gradient-to-r from-xmas-card to-transparent border-l-2 border-xmas-gold text-xmas-gold font-medium":"flex items-center p-2 pl-3 rounded-md hover:bg-xmas-card hover:bg-opacity-50 text-xmas-text hover:text-xmas-gold transition-all duration-200",children:({isActive:o})=>d.jsxs(d.Fragment,{children:[d.jsx("i",{className:"fas fa-file-import mr-3 text-xmas-gold"}),d.jsx("span",{children:"Add Movies"}),d.jsx("i",{className:`fas fa-snowflake ml-auto text-xmas-gold opacity-70 ${o?"visible":"invisible"}`})]})})}),d.jsx("li",{children:d.jsx(sl,{to:"/profile",onClick:l,className:({isActive:o})=>o?"flex items-center p-2 pl-3 rounded-md bg-gradient-to-r from-xmas-card to-transparent border-l-2 border-xmas-gold text-xmas-gold font-medium":"flex items-center p-2 pl-3 rounded-md hover:bg-xmas-card hover:bg-opacity-50 text-xmas-text hover:text-xmas-gold transition-all duration-200",children:({isActive:o})=>d.jsxs(d.Fragment,{children:[d.jsx("i",{className:"fas fa-user-circle mr-3 text-xmas-gold"}),d.jsx("span",{children:"Profile"}),d.jsx("i",{className:`fas fa-snowflake ml-auto text-xmas-gold opacity-70 ${o?"visible":"invisible"}`})]})})}),e&&d.jsx("li",{children:d.jsx(sl,{to:"/admin",onClick:l,className:({isActive:o})=>o?"flex items-center p-2 pl-3 rounded-md bg-gradient-to-r from-xmas-card to-transparent border-l-2 border-xmas-gold text-xmas-gold font-medium":"flex items-center p-2 pl-3 rounded-md hover:bg-xmas-card hover:bg-opacity-50 text-xmas-text hover:text-xmas-gold transition-all duration-200",children:({isActive:o})=>d.jsxs(d.Fragment,{children:[d.jsx("i",{className:"fas fa-crown mr-3 text-xmas-gold"}),d.jsx("span",{children:"Admin Dashboard"}),d.jsx("i",{className:`fas fa-snowflake ml-auto text-xmas-gold opacity-70 ${o?"visible":"invisible"}`})]})})})]}):d.jsx("li",{children:d.jsx(sl,{to:"/login",onClick:l,className:({isActive:o})=>o?"flex items-center p-2 pl-3 rounded-md bg-gradient-to-r from-xmas-card to-transparent border-l-2 border-xmas-gold text-xmas-gold font-medium":"flex items-center p-2 pl-3 rounded-md hover:bg-xmas-card hover:bg-opacity-50 text-xmas-text hover:text-xmas-gold transition-all duration-200",children:({isActive:o})=>d.jsxs(d.Fragment,{children:[d.jsx("i",{className:"fas fa-sign-in-alt mr-3 text-xmas-gold"}),d.jsx("span",{children:"Sign In"}),d.jsx("i",{className:`fas fa-snowflake ml-auto text-xmas-gold opacity-70 ${o?"visible":"invisible"}`})]})})})]})]})})})]}),d.jsx("main",{className:"p-4",children:d.jsx(Cb,{})}),d.jsx("div",{className:"fixed bottom-0 left-0 w-full pointer-events-none",children:d.jsx("div",{className:"container mx-auto",children:d.jsxs("div",{className:"relative h-16",children:[d.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-px bg-gradient-to-r from-xmas-gold via-transparent to-xmas-gold opacity-40"}),d.jsx("div",{className:"absolute bottom-4 left-4 opacity-30",children:d.jsx("i",{className:"fas fa-tree text-4xl text-xmas-gold"})}),d.jsx("div",{className:"absolute bottom-4 right-4 opacity-30",children:d.jsx("i",{className:"fas fa-star text-4xl text-xmas-gold"})})]})})})]})}const hN=q.createContext(null);function qP({children:t}){const[e,r]=q.useState([]),n=q.useCallback(o=>{r(u=>u.filter(h=>h.id!==o))},[]),a=q.useCallback((o,u)=>{const h=Math.random().toString(36).slice(2);r(m=>[...m,{id:h,kind:o,message:u}]),setTimeout(()=>n(h),3e3)},[n]),l=q.useMemo(()=>({push:a}),[a]);return d.jsxs(hN.Provider,{value:l,children:[t,d.jsx("div",{className:"fixed top-4 left-1/2 -translate-x-1/2 z-50 space-y-2",children:e.map(o=>d.jsxs("div",{className:`alert shadow-lg max-w-sm border-2 rounded-xl bg-gradient-to-r ${o.kind==="success"?"from-green-700/90 to-emerald-600/90 border-green-300":o.kind==="error"?"from-red-800/90 to-rose-700/90 border-red-300":"from-sky-700/90 to-cyan-600/90 border-sky-300"} text-white`,children:[d.jsxs("div",{className:"flex items-center",children:[d.jsx("span",{className:"text-lg mr-2",children:o.kind==="success"?"":o.kind==="error"?"":""}),d.jsx("span",{className:"ml-1",children:o.message})]}),d.jsx("button",{className:"btn btn-ghost btn-xs text-white/80 hover:text-white",onClick:()=>n(o.id),children:""})]},o.id))})]})}function dN(){const t=q.useContext(hN);if(!t)throw new Error("useToast must be used inside <ToastProvider>");return{success:e=>t.push("success",e),error:e=>t.push("error",e),info:e=>t.push("info",e)}}const Wd=({children:t})=>{const{currentUser:e,isLoading:r}=An();return r?d.jsx("div",{className:"flex justify-center items-center min-h-[60vh]",children:d.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-xmas-gold"})}):e?t?d.jsx(d.Fragment,{children:t}):d.jsx(Cb,{}):d.jsx(nD,{to:"/login"})},Rc=[{id:"first_snowflake",name:"First Snowflake",description:"You logged your very first watched Christmas movie.",hint:"Watch 1 movie.",icon:"",check:t=>t.totalWatched>=1},{id:"snowball_starter",name:"Snowball Starter",description:"You have started to build your festive watchlist.",hint:"Watch 5 movies.",icon:"",check:t=>t.totalWatched>=5},{id:"blizzard_binger",name:"Blizzard Binger",description:"You powered through a flurry of festive films.",hint:"Watch 20 movies.",icon:"",check:t=>t.totalWatched>=20},{id:"polar_explorer",name:"Polar Explorer",description:"You have ventured deep into festive territory.",hint:"Watch 35 movies.",icon:"",check:t=>t.totalWatched>=35},{id:"christmas_marathoner",name:"Christmas Marathoner",description:"You turned Christmas movies into a marathon event.",hint:"Watch 50 movies.",icon:"",check:t=>t.totalWatched>=50},{id:"north_pole_resident",name:"North Pole Resident",description:"Christmas movies are basically your habitat now.",hint:"Watch 75 movies.",icon:"",check:t=>t.totalWatched>=75},{id:"twelve_days",name:"12 Days of Christmas",description:"You kept the festive streak going for 12 days.",hint:"Watch a movie daily for 12 days.",icon:"",check:t=>t.hasTwelveDayStreak},{id:"comfort_rewatch",name:"Comfort Rewatch",description:"Some Christmas movies never get old.",hint:"Rewatch the same movie 3 times.",icon:"",check:t=>t.maxRewatchCount>=3},{id:"the_grinch",name:"The Grinch",description:"Not every movie can be a Christmas miracle.",hint:"Give a movie 1.",icon:"",check:t=>t.lowRatingAny},{id:"santas_favourite",name:"Santa's Favourite",description:"You found a film worthy of Santa himself.",hint:"Give a movie a perfect 10.",icon:"",check:t=>t.highRatingAny},{id:"holiday_optimist",name:"Holiday Optimist",description:"You see the best in festive films.",hint:"Give 10 movies a rating of 8 or higher.",icon:"",check:t=>t.highRatingCount>=10},{id:"coal_giver",name:"Coal Giver",description:"Some movies really missed the mark.",hint:"Give 5 movies 2 or lower.",icon:"",check:t=>t.lowRatingCount>=5},{id:"the_critic",name:"The Critic",description:"You have opinions on a lot of movies.",hint:"Rate 20 movies.",icon:"",check:t=>t.totalRated>=20},{id:"nice_list",name:"Nice List",description:"You are generous with your festive ratings.",hint:"Keep your average rating above 5.",icon:"",check:t=>t.averageRating>5},{id:"classic_connoisseur",name:"Classic Connoisseur",description:"You appreciate the classics before Y2K.",hint:"Watch 5 movies released before 2000.",icon:"",check:t=>t.classicWatched>=5},{id:"genre_juggler",name:"Genre Juggler",description:"You sampled a bit of everything festive.",hint:"Watch movies from 5 different genres.",icon:"",check:t=>t.genreVariety>=5},{id:"decades_of_cheer",name:"Decades of Cheer",description:"You watched Christmas through the ages.",hint:"Watch movies from 4 different decades.",icon:"",check:t=>t.decadeVariety>=4},{id:"animated_joy",name:"Animated Joy",description:"You love animated festive adventures.",hint:"Watch 5 animated Christmas movies.",icon:"",check:t=>t.animatedCount>=5},{id:"romcom_reindeer",name:"Rom-Com Reindeer",description:"You love a festive rom-com.",hint:"Watch 5 Christmas romance movies.",icon:"",check:t=>t.romanceCount>=5},{id:"decorator",name:"Decorator",description:"You have a whole row of favourites lit up.",hint:"Mark 10 movies as favourite.",icon:"",check:t=>t.favoriteCount>=10},{id:"tree_full_of_lights",name:"Tree Full of Lights",description:"Your favourites list is glowing.",hint:"Mark 20 movies as favourite.",icon:"",check:t=>t.favoriteCount>=20},{id:"background_cheer",name:"Background Cheer",description:"Its on even if youre not really watching.",hint:"Log 3 movies in one day.",icon:"",check:t=>t.maxWatchedInDay>=3},{id:"elf_mode",name:"Elf Mode",description:"You keep coming back like a dedicated Christmas elf.",hint:"Use the app on 10 different days.",icon:"",check:t=>t.usageDistinctDays>=10},{id:"festive_weekender",name:"Festive Weekender",description:"A perfect weekend activity.",hint:"Watch movies on both Saturday and Sunday.",icon:"",check:t=>t.hasWeekendDouble},{id:"early_bird",name:"Early Bird",description:"You started Christmas early.",hint:"Watch a Christmas movie before December.",icon:"",check:t=>t.hasPreDecemberWatch},{id:"tradition_keeper",name:"Tradition Keeper",description:"A ritual worth repeating.",hint:"Watch the same movie in different years.",icon:"",check:t=>t.hasYearlyRewatch},{id:"christmas_eve_watcher",name:"Christmas Eve Watcher",description:"You watched a movie on Christmas Eve.",hint:"Watch a movie on Dec 24.",icon:"",check:t=>t.hasChristmasEveWatch},{id:"new_years_cozy",name:"New Year's Cozy",description:"You started the year with a cozy movie.",hint:"Watch a movie on Jan 1.",icon:"",check:t=>t.hasNewYearsWatch}];function gf(t){if(!t)return null;if(t instanceof Date)return t;if(typeof t.toDate=="function")return t.toDate();if(typeof t=="object"&&"seconds"in t)return new Date(t.seconds*1e3);if(typeof t=="string"){const e=new Date(t);if(!isNaN(e.getTime()))return e}return null}function WP(t,e){let r=0,n=0,a=0,l=0,o=0,u=0,h=0,m=!1,p=!1,v=0,_=0;const w=new Set,E=new Set;let T=0;const A={},M={};let F=0;const R=new Set,z=new Set,re=new Set;for(const ae of t){if(ae.watched){r++;const pe=ae.rewatchCount,ne=typeof pe=="number"&&pe>0?pe:1;ne>T&&(T=ne);const be=gf(ae.watchedDate);if(be){const I=be.toISOString().split("T")[0];re.add(I);const Z=(A[I]??0)+1;A[I]=Z,Z>F&&(F=Z);const ee=be.getMonth();be.getDate(),ee===11&&R.add(I)}const Q=e[ae.movieId];if(Q&&Q.releaseDate){const I=Q.releaseDate;let Z=null;if(/^\d{4}/.test(I))Z=Number(I.substring(0,4));else{const ee=new Date(I);isNaN(ee.getTime())||(Z=ee.getFullYear())}if(Z!==null&&Z<2e3&&l++,Z!==null){const ee=Math.floor(Z/10)*10;E.add(ee)}}if(Q&&Q.genres){for(const I of Q.genres)w.add(I);Q.genres.includes("Romance")&&o++,Q.genres.includes("Animation")&&u++}if(ae.movieId){const I=new Set;be&&I.add(be.getUTCFullYear());const Z=gf(ae.lastWatchedDate);if(Z&&I.add(Z.getUTCFullYear()),I.size>0){M[ae.movieId]||(M[ae.movieId]=new Set);for(const ee of I)M[ae.movieId].add(ee)}}}ae.favorite&&h++,typeof ae.rating=="number"&&(n++,a+=ae.rating,ae.rating<=1&&(m=!0),ae.rating>=10&&(p=!0),ae.rating<=2&&v++,ae.rating>=8&&_++);const ue=gf(ae.updatedAt||ae.addedAt);if(ue){const pe=ue.toISOString().split("T")[0];z.add(pe)}}const te=Array.from(re).map(ae=>{const ue=new Date(ae+"T00:00:00Z");return Math.floor(ue.getTime()/864e5)}).sort((ae,ue)=>ae-ue);let b=!1,N=0,k=null;for(const ae of te){if(k===null||ae===k+1?N+=1:ae!==k&&(N=1),N>=12){b=!0;break}k=ae}let j=!1,L=!1,P=!1,U=!1,Ce=!1;for(const ae of re){const ue=new Date(ae+"T00:00:00Z"),pe=ue.getUTCMonth(),ne=ue.getUTCDate(),be=ue.getUTCDay();if(pe===11&&ne===24&&(j=!0),pe===0&&ne===1&&(L=!0),pe<11&&(U=!0),!P){if(be===6){const Q=new Date(ue.getTime());Q.setUTCDate(Q.getUTCDate()+1);const I=Q.toISOString().split("T")[0];re.has(I)&&Q.getUTCDay()===0&&(P=!0)}else if(be===0){const Q=new Date(ue.getTime());Q.setUTCDate(Q.getUTCDate()-1);const I=Q.toISOString().split("T")[0];re.has(I)&&Q.getUTCDay()===6&&(P=!0)}}}for(const ae of Object.keys(M))if(M[ae].size>=2){Ce=!0;break}const Ne=n>0?a/n:0;return{totalWatched:r,totalRated:n,averageRating:Ne,lowRatingAny:m,highRatingAny:p,lowRatingCount:v,highRatingCount:_,classicWatched:l,romanceCount:o,animatedCount:u,favoriteCount:h,genreVariety:w.size,decadeVariety:E.size,maxRewatchCount:T,maxWatchedInDay:F,usageDistinctDays:z.size,decemberDistinctDays:R.size,hasChristmasEveWatch:j,hasNewYearsWatch:L,hasTwelveDayStreak:b,hasWeekendDouble:P,hasPreDecemberWatch:U,hasYearlyRewatch:Ce}}async function h0(t){const e=await Er(ur(rt,`users/${t}/movies`)),r=[],n=new Set;e.forEach(_=>{const w=_.data();r.push({id:_.id,...w}),w.movieId&&n.add(w.movieId)});const a={};if(n.size){const _=Array.from(n);for(const w of _){(await Er(ur(rt,"movies"))).forEach(T=>{const A=T.data();a[T.id]={id:T.id,...A}});break}}let l=null;try{const _=await Zn(Pt(rt,"users",t));if(_.exists()){const w=_.data();w.achievementsResetAfter&&(l=gf(w.achievementsResetAfter))}}catch(_){console.error("Error loading achievements reset meta",_)}let o=r;l&&(o=r.filter(_=>{const w=gf(_.updatedAt||_.addedAt||_.watchedDate);return!w||w>l}));const u=WP(o,a),h=ur(rt,`users/${t}/achievements`),m=await Er(h),p=new Set;m.forEach(_=>p.add(_.id));const v=[];for(const _ of Rc)!p.has(_.id)&&_.check(u)&&(v.push(_.id),await Ia(Pt(rt,`users/${t}/achievements`,_.id),{unlockedAt:new Date,seen:!1}));return v}const KP=()=>{const{currentUser:t}=An(),[e,r]=q.useState(new Date),[n,a]=q.useState(null),[l,o]=q.useState(null),u=Rc.length;q.useEffect(()=>{const p=setInterval(()=>r(new Date),1e3);return()=>clearInterval(p)},[]);const h=q.useMemo(()=>{const p=e.getFullYear(),v=new Date(p,11,25,0,0,0);return e>v?new Date(p+1,11,25,0,0,0):v},[e]),m=q.useMemo(()=>{const p=h.getTime()-e.getTime(),v=Math.max(0,Math.floor(p/1e3)),_=Math.floor(v/86400),w=Math.floor(v%86400/3600),E=Math.floor(v%3600/60),T=v%60;return{days:_,hours:w,minutes:E,seconds:T}},[e,h]);return q.useEffect(()=>{const p=Pt(rt,"stats","global"),v=Zj(p,_=>{const w=_.data();a(typeof w?.watchedTotal=="number"?w.watchedTotal:0)});return()=>v()},[]),q.useEffect(()=>{if(!t){o(null);return}(async()=>{try{const v=ur(rt,`users/${t.uid}/achievements`),_=await Er(v);o(_.size)}catch(v){console.error("Error loading achievements count",v),o(null)}})()},[t]),d.jsxs("div",{className:"container mx-auto px-4 py-8",children:[d.jsxs("div",{className:"text-center mb-12",children:[d.jsx("h1",{className:"font-christmas text-5xl md:text-7xl text-xmas-line mb-4",children:"My Christmas Movies"}),d.jsx("p",{className:"text-xl md:text-2xl text-xmas-snow mb-8",children:"Track, rate, and discover your favourite Christmas movies!"}),d.jsx("div",{className:"flex flex-col md:flex-row justify-center gap-6 mb-4 md:mb-6",children:t?d.jsxs(d.Fragment,{children:[d.jsxs(gt,{to:"/movies",className:"btn btn-primary btn-lg text-xl px-8 py-3 rounded-md shadow-lg hover:shadow-xl transition-all duration-300 border border-xmas-gold border-opacity-30",children:[d.jsx("i",{className:"fas fa-film mr-2"})," My Movies"]}),d.jsxs(gt,{to:"/random",className:"btn btn-primary btn-lg text-xl px-8 py-3 rounded-md shadow-lg hover:shadow-xl transition-all duration-300 border border-xmas-gold border-opacity-30",children:[d.jsx("i",{className:"fas fa-random mr-2"})," Random Movie"]}),d.jsxs(gt,{to:"/achievements",className:"btn btn-primary btn-lg text-xl px-8 py-3 rounded-md shadow-lg hover:shadow-xl transition-all duration-300 border border-xmas-gold border-opacity-30",children:[d.jsx("i",{className:"fas fa-trophy mr-2"})," Achievements"]})]}):d.jsxs(gt,{to:"/login",className:"btn btn-primary btn-lg text-xl px-8 py-3 rounded-md shadow-lg hover:shadow-xl transition-all duration-300 border border-xmas-gold border-opacity-30",children:[d.jsx("i",{className:"fas fa-sign-in-alt mr-2"})," Sign In"]})})]}),d.jsx("div",{className:"w-full max-w-4xl mx-auto mb-8",children:d.jsx("div",{className:"h-px bg-gradient-to-r from-transparent via-xmas-gold to-transparent"})}),d.jsxs("div",{className:"bg-xmas-card rounded-lg shadow-xl p-6 mb-12 border border-xmas-gold border-opacity-30 relative",children:[d.jsx("h2",{className:"font-christmas text-3xl text-xmas-gold text-center mb-6",children:"Countdown to Christmas"}),d.jsxs("div",{className:"grid md:grid-cols-2 gap-6 items-stretch",children:[d.jsxs("div",{className:"bg-xmas-card bg-opacity-70 p-6 rounded-lg shadow-md border-l-2 border-xmas-line flex flex-col items-center justify-center",children:[d.jsxs("div",{className:"text-5xl md:text-6xl font-bold text-xmas-line mb-2",children:[m.days,"d ",m.hours,"h ",m.minutes,"m ",m.seconds,"s"]}),d.jsx("p",{className:"text-xmas-text text-opacity-80",children:"until Christmas Day"})]}),d.jsxs("div",{className:"bg-xmas-card bg-opacity-70 p-6 rounded-lg shadow-md border-l-2 border-xmas-gold flex flex-col items-center justify-center",children:[d.jsx("div",{className:"text-5xl md:text-6xl font-bold text-xmas-gold mb-2",children:n??""}),d.jsx("p",{className:"text-xmas-text text-opacity-80 text-center",children:"total movies watched"})]})]})]}),d.jsxs("div",{className:"bg-xmas-card rounded-lg shadow-xl p-6 mb-12 border border-xmas-gold border-opacity-20 snow-accumulation snow-accumulation-slow relative",children:[d.jsx("h2",{className:"font-christmas text-3xl text-xmas-line mb-6 text-center",children:"Features"}),d.jsxs("div",{className:"grid md:grid-cols-4 gap-6",children:[d.jsxs("div",{className:"bg-xmas-card bg-opacity-70 p-6 rounded-lg shadow-md border-l-2 border-xmas-line",children:[d.jsx("div",{className:"text-3xl text-xmas-gold mb-4 text-center",children:d.jsx("i",{className:"fas fa-search"})}),d.jsx("h3",{className:"font-christmas text-xl text-center mb-3",children:"Find Movies"}),d.jsx("p",{className:"text-center text-xmas-text text-opacity-80",children:"Search and discover Christmas movies using OMDb data"})]}),d.jsxs("div",{className:"bg-xmas-card bg-opacity-70 p-6 rounded-lg shadow-md border-l-2 border-xmas-gold",children:[d.jsx("div",{className:"text-3xl text-xmas-gold mb-4 text-center",children:d.jsx("i",{className:"fas fa-star"})}),d.jsx("h3",{className:"font-christmas text-xl text-center mb-3",children:"Rate & Review"}),d.jsx("p",{className:"text-center text-xmas-text text-opacity-80",children:"Keep track of movies you've watched and rate them"})]}),d.jsxs("div",{className:"bg-xmas-card bg-opacity-70 p-6 rounded-lg shadow-md border-l-2 border-xmas-line",children:[d.jsx("div",{className:"text-3xl text-xmas-gold mb-4 text-center",children:d.jsx("i",{className:"fas fa-random"})}),d.jsx("h3",{className:"font-christmas text-xl text-center mb-3",children:"Random Picker"}),d.jsx("p",{className:"text-center text-xmas-text text-opacity-80",children:"Can't decide what to watch? Let our random movie picker help!"})]}),d.jsxs("div",{className:"bg-xmas-card bg-opacity-70 p-6 rounded-lg shadow-md border-l-2 border-xmas-line",children:[d.jsx("div",{className:"text-3xl text-xmas-gold mb-4 text-center",children:d.jsx("i",{className:"fas fa-trophy"})}),d.jsx("h3",{className:"font-christmas text-xl text-center mb-3",children:"Achievements"}),d.jsx("p",{className:"text-center text-xmas-text text-opacity-80 mb-2",children:"Unlock festive badges as you watch, rate, and explore."}),t&&d.jsx("p",{className:"text-center text-xmas-text text-opacity-80 font-medium",children:typeof l=="number"?`${l} / ${u} unlocked`:`${u} to discover`})]})]})]}),d.jsx("div",{className:"bg-xmas-card rounded-lg shadow-xl p-6 mb-12 border border-xmas-gold border-opacity-30 snow-accumulation snow-accumulation-fast relative",children:d.jsxs("div",{className:"mb-6 text-center",children:[d.jsxs("h2",{className:"font-christmas text-3xl md:text-4xl text-xmas-gold inline-block relative",children:[d.jsx("span",{className:"relative z-10",children:"Create Your Collection"}),d.jsx("span",{className:"absolute -bottom-2 left-0 right-0 h-1 bg-xmas-gold opacity-30 rounded-full"})]}),d.jsx("p",{className:"mt-4 mb-6",children:"Add movies to your collection and rate them"}),t?d.jsxs(gt,{to:"/import",className:"btn btn-primary",children:[d.jsx("i",{className:"fas fa-file-import mr-2"})," Add Movies"]}):d.jsxs(gt,{to:"/login",className:"btn btn-primary",children:[d.jsx("i",{className:"fas fa-sign-in-alt mr-2"})," Sign In to Add"]})]})}),d.jsx("div",{className:"w-full max-w-4xl mx-auto mb-8",children:d.jsx("div",{className:"h-px bg-gradient-to-r from-transparent via-xmas-gold to-transparent"})}),d.jsxs("footer",{className:"text-center text-xmas-mute mt-12 pb-8 space-y-4",children:[d.jsxs("p",{children:[" ",new Date().getFullYear()," Christmas Movie Database"]}),d.jsxs("div",{className:"flex flex-col items-center justify-center gap-2 text-xs md:text-sm text-xmas-mute/80",children:[d.jsx("a",{href:"https://www.omdbapi.com/",target:"_blank",rel:"noopener noreferrer",className:"link link-hover",children:"OMDb API"}),d.jsx("p",{className:"max-w-xl px-4 text-center",children:"This product uses the OMDb API but is not endorsed or certified by OMDb."})]})]})]})},YP=()=>{const t=Ma(),{currentUser:e,isLoading:r,error:n,signInWithGoogle:a}=An();q.useEffect(()=>{e&&!r&&t("/")},[e,r,t]);const l=async()=>{try{await a()}catch(o){console.error("Login failed:",o)}};return r?d.jsx("div",{className:"flex justify-center items-center min-h-[60vh]",children:d.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-xmas-gold"})}):d.jsx("div",{className:"container mx-auto px-4 py-12",children:d.jsxs("div",{className:"max-w-md mx-auto",children:[d.jsxs("div",{className:"text-center mb-8",children:[d.jsx("h1",{className:"font-christmas text-4xl text-xmas-line mb-2",children:"Christmas Movie Database"}),d.jsx("p",{className:"text-xmas-mute",children:"Sign in to manage your Christmas movie collection"})]}),d.jsxs("div",{className:"bg-xmas-card rounded-lg shadow-lg p-6",children:[n&&d.jsx("div",{className:"bg-error bg-opacity-10 border-l-4 border-error p-4 mb-6 rounded",children:d.jsx("p",{className:"text-error",children:n})}),d.jsxs("div",{className:"text-center mb-6",children:[d.jsx("p",{className:"mb-4",children:"Sign in with your Google account to access your Christmas movie collection."}),d.jsx("p",{className:"text-sm text-xmas-mute mb-6",children:"Track, rate, and discover Christmas movies!"}),d.jsxs("button",{onClick:l,className:"btn btn-primary w-full flex items-center justify-center gap-2",children:[d.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 48 48",children:[d.jsx("path",{fill:"#FFC107",d:`M43.611,20.083H42V20H24v8h11.303c-1.649,4.657-6.08,8-11.303,8c-6.627,0-12-5.373-12-12\r
                  s5.373-12,12-12c3.059,0,5.842,1.154,7.961,3.039l5.657-5.657C34.046,6.053,29.268,4,24,4C12.955,4,4,12.955,4,24s8.955,20,20,20\r
                  s20-8.955,20-20C44,22.659,43.862,21.35,43.611,20.083z`}),d.jsx("path",{fill:"#FF3D00",d:`M6.306,14.691l6.571,4.819C14.655,15.108,18.961,12,24,12c3.059,0,5.842,1.154,7.961,3.039\r
                  l5.657-5.657C34.046,6.053,29.268,4,24,4C16.318,4,9.656,8.337,6.306,14.691z`}),d.jsx("path",{fill:"#4CAF50",d:`M24,44c5.166,0,9.86-1.977,13.409-5.192l-6.19-5.238C29.211,35.091,26.715,36,24,36\r
                  c-5.202,0-9.619-3.317-11.283-7.946l-6.522,5.025C9.505,39.556,16.227,44,24,44z`}),d.jsx("path",{fill:"#1976D2",d:`M43.611,20.083H42V20H24v8h11.303c-0.792,2.237-2.231,4.166-4.087,5.571\r
                  c0.001-0.001,0.002-0.001,0.003-0.002l6.19,5.238C36.971,39.205,44,34,44,24C44,22.659,43.862,21.35,43.611,20.083z`})]}),"Sign in with Google"]})]})]}),d.jsx("div",{className:"text-center mt-6",children:d.jsx("p",{className:"text-sm text-xmas-mute",children:"By signing in, you agree to our Terms of Service and Privacy Policy."})})]})})},mN=t=>t.toLowerCase().replace(/[^\w\s-]/g,"").replace(/\s+/g,"-").replace(/-+/g,"-").trim(),l1=(t,e)=>`/movies/${mN(t)}?id=${e}`,pN=t=>new URLSearchParams(t).get("id"),$P=300*1e3;let fs=null;const XP=(t,e,r)=>{fs={userMovies:e,movies:r,timestamp:Date.now(),userId:t}},QP=t=>!fs||fs.userId!==t||Date.now()-fs.timestamp>$P?null:{userMovies:fs.userMovies,movies:fs.movies},o1=()=>{fs=null},JP=(t,e,r)=>{fs&&fs.userId===t&&(fs.userMovies[e]=r,fs.timestamp=Date.now())},wm=async(t,e,r)=>{const n=Pt(rt,`users/${t}/movies`,e),a=await Zn(n);if(a.exists()){const u=a.data(),h={...r,updatedAt:new Date};let m=typeof u.rewatchCount=="number"?u.rewatchCount:0;const p=r.watched??u.watched,v=!!u.watched,_=A=>{if(!A)return null;if(A instanceof Date)return A.toISOString().split("T")[0];if(typeof A.toDate=="function"){const F=A.toDate();return F instanceof Date&&!isNaN(F.getTime())?F.toISOString().split("T")[0]:null}const M=new Date(A);return isNaN(M.getTime())?null:M.toISOString().split("T")[0]},w=_(u.watchedDate),E=r.watchedDate??u.watchedDate,T=_(E);p&&(v?w&&T&&w!==T&&(m+=1):m+=1),m>0&&(h.rewatchCount=m),r.rating===null&&(h.rating=null),r.watchedDate===null&&(h.watchedDate=null),r.review===null&&(h.review=null),await ea(n,h)}else{const u={userId:t,movieId:e,watched:r.watched||!1,favorite:r.favorite||!1,addedAt:new Date,updatedAt:new Date,...r};await Ia(n,u)}const l=await Zn(n),o={id:l.id,...l.data()};return JP(t,e,o),o},gN=async(t,e)=>{const r=Pt(rt,`users/${t}/movies`,e),n=await Zn(r);return n.exists()?{id:n.id,...n.data()}:null},Fx=async t=>{const e=ur(rt,`users/${t}/movies`),r=await Er(e),n=[];return r.forEach(a=>{n.push({id:a.id,...a.data()})}),n},ZP=async(t,e)=>{const r=Pt(rt,`users/${t}/movies`,e);await GA(r),o1()},uh=async t=>{const e=QP(t);if(e)return e;const r=await Fx(t),n={},a=[];r.forEach(u=>{n[u.movieId]=u,a.push(u.movieId)});const l=[];if(a.length>0)for(let h=0;h<a.length;h+=10){const p=a.slice(h,h+10).map(_=>Zn(Pt(rt,"movies",_)).then(w=>w.exists()?{id:w.id,...w.data()}:null).catch(w=>(console.error(`Error fetching movie ${_}:`,w),null))),v=await Promise.all(p);l.push(...v.filter(Boolean))}const o={userMovies:n,movies:l};return XP(t,n,l),o},e8=async t=>{const e=ur(rt,`users/${t}/movies`),r=await Er(e),n=20;let a=[];r.forEach(l=>{const o=Pt(rt,`users/${t}/movies`,l.id),u=l.data(),h=u.watchedDate||u.lastWatchedDate||null,m={watched:!1,watchedDate:null};h&&(m.lastWatchedDate=h),a.push(ea(o,m))}),a.length>=n&&(a=[Promise.all(a)]),a.length&&await Promise.all(a),o1()},t8=async t=>{const e=ur(rt,`users/${t}/achievements`),r=await Er(e),n=[];r.forEach(l=>{n.push(GA(Pt(rt,`users/${t}/achievements`,l.id)))}),n.length&&await Promise.all(n);const a=Pt(rt,"users",t);await ea(a,{achievementsResetAfter:new Date})},r8="https://api.themoviedb.org/3",n8="https://image.tmdb.org/t/p/w500";function xN(t,e){if(!t)return t;const r="https://image.tmdb.org/t/p/";if(!t.startsWith(r))return t;const n=t.substring(r.length),a=n.indexOf("/");return a===-1||n.substring(0,a)===e?t:r+e+n.substring(a)}const Tm=async(t,e)=>{if(!e)throw new Error("TMDb API key is required.");const r=`${r8}/movie/${t}/images?api_key=${encodeURIComponent(e)}&include_image_language=en,null`,n=await fetch(r);if(!n.ok)throw new Error(`TMDb API error: ${n.status}`);const o=((await n.json()).posters||[]).filter(u=>!u.iso_639_1||u.iso_639_1==="en");return o.sort((u,h)=>h.vote_count-u.vote_count),o.map(u=>({url:`${n8}${u.file_path}`,iso_639_1:u.iso_639_1??null,width:u.width,height:u.height,voteAverage:u.vote_average,voteCount:u.vote_count}))},Qa=t=>{if(!t)return null;const e=t.trim();if(!e)return null;const r=e.match(/(\d{4})/);if(!r)return null;const n=parseInt(r[1],10);return Number.isFinite(n)?String(n):null},a8=()=>{const{currentUser:t,userProfile:e}=An(),r=dN(),[n,a]=q.useState([]),[l,o]=q.useState({}),[u,h]=q.useState(!0),[m,p]=q.useState(!0),[v,_]=q.useState(null),[w,E]=q.useState("all"),[T,A]=q.useState({option:"title",direction:"asc"}),[M,F]=q.useState(""),[R,z]=q.useState("all"),[re,te]=q.useState(!1),[b,N]=q.useState(!1),[k,j]=q.useState(""),[L,P]=q.useState(""),[U,Ce]=q.useState(""),[Ne,ae]=q.useState(!1),ue=ys();Ma();const pe=B=>B.toLowerCase().trim().replace(/[^a-z0-9]+/g,"-").replace(/^-+|-+$/g,""),ne=async()=>{if(t)try{ae(!0);const B=Pt(rt,"users",t.uid),se={isPublicWatchlist:b,publicWatchlistName:k||null,publicWatchlistTagline:L||null,publicWatchlistSlug:U||null};if(b&&!se.publicWatchlistSlug){const _e=k||e?.displayName||"xmas-watchlist";se.publicWatchlistSlug=pe(_e),Ce(se.publicWatchlistSlug)}if(await ea(B,se),b&&se.publicWatchlistSlug){const _e=Pt(rt,"publicProfiles",se.publicWatchlistSlug);await Ia(_e,{userId:t.uid,displayName:e?.displayName||"",photoURL:e?.photoURL||null,publicWatchlistName:se.publicWatchlistName||null,publicWatchlistTagline:se.publicWatchlistTagline||null,publicWatchlistSlug:se.publicWatchlistSlug,isPublicWatchlist:!0},{merge:!0})}else if(!b&&U){const _e=Pt(rt,"publicProfiles",U);await Ia(_e,{userId:t.uid,isPublicWatchlist:!1,publicWatchlistName:null,publicWatchlistTagline:null},{merge:!0})}r.success("Sharing settings saved")}catch(B){console.error("Error saving sharing settings:",B),r.error("Failed to save sharing settings")}finally{ae(!1)}},be=async()=>{if(U)try{const se=`${window.location.origin}/u/${U}`;await navigator.clipboard.writeText(se),r.success("Link copied to clipboard")}catch(B){console.error("Failed to copy link",B),r.error("Failed to copy link")}};q.useEffect(()=>{const B=new URLSearchParams(ue.search),se=B.get("q")||"",_e=B.get("field")||"all";se!==M&&F(se),_e!==R&&z(_e)},[ue.search]),q.useEffect(()=>{e&&(N(!!e.isPublicWatchlist),j(e.publicWatchlistName||""),P(e.publicWatchlistTagline||""),Ce(e.publicWatchlistSlug||""))},[e]),q.useEffect(()=>{b&&k&&(U||Ce(pe(k)))},[b,k,U]),q.useEffect(()=>{(async()=>{if(t)try{p(!0);const{userMovies:se,movies:_e}=await uh(t.uid);o(se),a(_e)}catch(se){console.error("Error fetching movies:",se),_("Failed to load movies")}finally{p(!1),h(!1)}})()},[t,ue.key]);const Q=B=>{A(se=>se.option===B?{option:B,direction:se.direction==="asc"?"desc":"asc"}:{option:B,direction:"asc"})},I=q.useCallback(B=>{if(!M.trim())return!0;const se=M.toLowerCase().trim(),_e=se.split(",").map(we=>we.trim()).filter(Boolean),Pe=we=>B.cast&&B.cast.some(He=>He.toLowerCase().includes(we)),he=l[B.id];switch(R){case"title":return B.title.toLowerCase().includes(se)||B.sortTitle&&B.sortTitle.toLowerCase().includes(se)||B.originalTitle&&B.originalTitle.toLowerCase().includes(se);case"year":return!!B.releaseDate&&!!Qa(B.releaseDate)?.includes(se);case"cast":return _e.length?_e.some(we=>Pe(we)):Pe(se);case"all":default:{const we=B.releaseDate&&Qa(B.releaseDate);return B.title.toLowerCase().includes(se)||B.sortTitle&&B.sortTitle.toLowerCase().includes(se)||B.originalTitle&&B.originalTitle.toLowerCase().includes(se)||we&&we.includes(se)||B.overview&&B.overview.toLowerCase().includes(se)||B.genres&&B.genres.some(He=>He.toLowerCase().includes(se))||B.directors&&B.directors.some(He=>He.toLowerCase().includes(se))||B.cast&&B.cast.some(He=>He.toLowerCase().includes(se))||he&&he.review&&he.review.toLowerCase().includes(se)}}},[M,R,l]),Z=q.useMemo(()=>{if(m)return[];h(!0);const B=n.filter(se=>{const _e=l[se.id];let Pe=!0;switch(w){case"watched":Pe=_e&&_e.watched;break;case"unwatched":Pe=!_e||!_e.watched;break;case"favorites":Pe=_e&&_e.favorite;break}return Pe&&I(se)}).sort((se,_e)=>{const Pe=l[se.id],he=l[_e.id],we=T.direction==="asc"?1:-1;switch(T.option){case"title":const He=se.sortTitle||se.title,J=_e.sortTitle||_e.title;return He.localeCompare(J)*we;case"year":{const De=se.releaseDate&&Qa(se.releaseDate),ut=_e.releaseDate&&Qa(_e.releaseDate),Lt=De?parseInt(De,10):0,Qt=ut?parseInt(ut,10):0;return(Lt-Qt)*we}case"rating":const Qe=Pe?.rating||0,$e=he?.rating||0;return(Qe-$e)*we;case"watched":const Fe=Pe?.watched?1:0,Ue=he?.watched?1:0;return(Fe-Ue)*we;default:return 0}});return h(!1),B},[n,l,w,T,M,R,m]),ee=Z;return m?d.jsx("div",{className:"flex justify-center items-center min-h-[60vh]",children:d.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-xmas-gold"})}):d.jsxs("div",{className:"container mx-auto px-2 sm:px-4 py-4 sm:py-8",children:[d.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-center mb-4 sm:mb-8 gap-3",children:[d.jsx("h1",{className:"font-christmas text-2xl sm:text-3xl md:text-4xl text-xmas-line",children:"My Christmas Movies"}),d.jsxs("div",{className:"flex gap-2 w-full sm:w-auto justify-center",children:[d.jsxs(gt,{to:"/random",className:"btn btn-primary btn-sm sm:btn-md",children:[d.jsx("i",{className:"fas fa-random mr-1 sm:mr-2"})," ",d.jsx("span",{className:"hidden xs:inline",children:"Random Movie"}),d.jsx("span",{className:"xs:hidden",children:"Random"})]}),d.jsxs(gt,{to:"/import",className:"btn btn-primary btn-sm sm:btn-md",children:[d.jsx("i",{className:"fas fa-file-import mr-1 sm:mr-2"})," ",d.jsx("span",{className:"hidden xs:inline",children:"Add Movies"}),d.jsx("span",{className:"xs:hidden",children:"Import"})]}),d.jsxs("button",{type:"button",className:"btn btn-primary btn-sm sm:btn-md",onClick:()=>te(!0),children:[d.jsx("i",{className:"fas fa-share-alt mr-1 sm:mr-2"}),d.jsx("span",{className:"hidden xs:inline",children:"Share"}),d.jsx("span",{className:"xs:hidden",children:"Share"})]})]})]}),v&&d.jsxs("div",{className:"alert alert-error mb-6",children:[d.jsx("i",{className:"fas fa-exclamation-circle mr-2"}),d.jsx("span",{children:v})]}),d.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 mb-3",children:[d.jsxs("div",{className:"relative flex-grow",children:[d.jsx("div",{className:"absolute inset-y-0 left-0 pl-2 flex items-center pointer-events-none",children:d.jsx("i",{className:"fas fa-search text-gray-400"})}),d.jsx("input",{type:"text",className:"input input-bordered input-sm sm:input-md w-full pl-8 pr-8",placeholder:"   Search movies...",value:M,onChange:B=>F(B.target.value)}),M&&d.jsx("button",{className:"absolute inset-y-0 right-0 pr-2 flex items-center",onClick:()=>F(""),children:d.jsx("i",{className:"fas fa-times text-gray-400 hover:text-gray-600"})})]}),d.jsxs("select",{className:"select select-bordered select-sm sm:select-md w-full sm:w-36",value:R,onChange:B=>z(B.target.value),children:[d.jsx("option",{value:"all",children:"All Fields"}),d.jsx("option",{value:"title",children:"Title Only"}),d.jsx("option",{value:"year",children:"Year Only"}),d.jsx("option",{value:"cast",children:"Cast Only"})]})]}),d.jsxs("div",{className:"tabs tabs-boxed mb-3 text-xs sm:text-sm overflow-x-auto",children:[d.jsx("button",{className:`tab ${w==="all"?"tab-active":""}`,onClick:()=>E("all"),children:"All Movies"}),d.jsx("button",{className:`tab ${w==="watched"?"tab-active":""}`,onClick:()=>E("watched"),children:"Watched"}),d.jsx("button",{className:`tab ${w==="unwatched"?"tab-active":""}`,onClick:()=>E("unwatched"),children:"Watch"}),d.jsxs("button",{className:`tab ${w==="favorites"?"tab-active":""}`,onClick:()=>E("favorites"),children:[d.jsx("span",{className:"hidden sm:inline",children:"Favourites"}),d.jsx("span",{className:"sm:hidden",children:"Favs"})]})]}),d.jsxs("div",{className:"flex flex-wrap items-center gap-1 mb-3 bg-xmas-card bg-opacity-50 p-2 rounded-lg overflow-x-auto",children:[d.jsx("span",{className:"text-xs sm:text-sm font-medium mr-1",children:"Sort:"}),d.jsxs("div",{className:"flex flex-nowrap gap-1 overflow-x-auto",children:[d.jsxs("button",{className:`btn btn-xs ${T.option==="title"?"btn-primary":"btn-ghost"}`,onClick:()=>Q("title"),children:["Title ",T.option==="title"&&d.jsx("i",{className:`fas fa-sort-${T.direction==="asc"?"up":"down"} ml-1`})]}),d.jsxs("button",{className:`btn btn-xs ${T.option==="year"?"btn-primary":"btn-ghost"}`,onClick:()=>Q("year"),children:["Year ",T.option==="year"&&d.jsx("i",{className:`fas fa-sort-${T.direction==="asc"?"up":"down"} ml-1`})]}),d.jsxs("button",{className:`btn btn-xs ${T.option==="rating"?"btn-primary":"btn-ghost"}`,onClick:()=>Q("rating"),children:["Rating ",T.option==="rating"&&d.jsx("i",{className:`fas fa-sort-${T.direction==="asc"?"up":"down"} ml-1`})]}),d.jsxs("button",{className:`btn btn-xs ${T.option==="watched"?"btn-primary":"btn-ghost"}`,onClick:()=>Q("watched"),children:[d.jsx("span",{className:"hidden sm:inline",children:"Watched Status"}),d.jsx("span",{className:"sm:hidden",children:"Watched"}),T.option==="watched"&&d.jsx("i",{className:`fas fa-sort-${T.direction==="asc"?"up":"down"} ml-1`})]})]})]}),d.jsxs("div",{className:"flex flex-col xs:flex-row justify-between items-start xs:items-center mb-3 text-xs sm:text-sm",children:[d.jsxs("div",{children:[d.jsx("span",{className:"font-medium",children:Z.length})," ",Z.length===1?"movie":"movies"," found",M&&d.jsxs("span",{className:"ml-1 text-xmas-mute",children:["for: ",d.jsxs("span",{className:"font-medium",children:['"',M,'"']})]})]}),T.option&&d.jsxs("div",{className:"text-xmas-mute",children:["Sorted by ",d.jsx("span",{className:"font-medium",children:T.option})," (",T.direction==="asc"?"asc":"desc",")"]})]}),u&&!m&&d.jsx("div",{className:"flex justify-center items-center py-4",children:d.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-t-2 border-b-2 border-xmas-gold"})}),Z.length===0?d.jsxs("div",{className:"bg-xmas-card p-8 rounded-lg text-center",children:[d.jsx("h3",{className:"text-xl mb-4",children:"No movies found"}),d.jsx("p",{className:"mb-4",children:w==="all"?"You haven't added any Christmas movies yet.":`You don't have any ${w} Christmas movies.`}),d.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 justify-center",children:[d.jsxs(gt,{to:"/import",className:"btn btn-primary",children:[d.jsx("i",{className:"fas fa-file-import mr-2"})," Add Movies"]}),n.length>0&&d.jsxs(gt,{to:"/random",className:"btn btn-primary",children:[d.jsx("i",{className:"fas fa-random mr-2"})," Random Movie"]})]})]}):d.jsx("div",{className:"grid grid-cols-3 sm:grid-cols-4 md:grid-cols-5 lg:grid-cols-6 gap-2 sm:gap-3",children:ee.map(B=>{const se=l[B.id],_e=se?.posterUrlOverride||null,he=_e?.includes("fanart.tv")?B.posterUrl:_e||B.posterUrl,we=xN(he||"","w185");return d.jsx(gt,{to:l1(B.title,B.id),state:{from:"movies"},className:"block transition-transform hover:scale-[1.02] hover:shadow-xl",children:d.jsxs("div",{className:"relative rounded-lg overflow-hidden bg-xmas-card shadow-md h-full flex flex-col",children:[d.jsxs("div",{className:"relative",children:[he?d.jsx("img",{src:we,alt:B.title,className:"w-full h-auto object-cover",style:{aspectRatio:"2/3"},loading:"lazy"}):d.jsx("div",{className:"w-full flex items-center justify-center bg-gray-800",style:{aspectRatio:"2/3"},children:d.jsx("i",{className:"fas fa-film text-2xl text-gray-500"})}),se&&se.watched&&d.jsx("div",{className:"absolute top-1 right-1 bg-primary rounded-full p-1 shadow-md",children:d.jsx("i",{className:"fas fa-check text-xs text-white"})}),se&&se.favorite&&d.jsx("div",{className:"absolute top-1 left-1 text-yellow-400 drop-shadow-md",children:d.jsx("i",{className:"fas fa-star text-sm"})})]}),d.jsxs("div",{className:"p-1 sm:p-2 flex-grow flex flex-col",children:[d.jsx("h3",{className:"text-xs sm:text-sm font-medium line-clamp-2",children:B.title}),d.jsxs("div",{className:"flex justify-between items-center mt-1",children:[d.jsx("p",{className:"text-xs text-gray-400",children:B.releaseDate&&Qa(B.releaseDate)}),se&&se.rating&&d.jsxs("div",{className:"flex items-center",children:[d.jsx("span",{className:"text-yellow-400 mr-0.5",children:d.jsx("i",{className:"fas fa-star text-xs"})}),d.jsx("span",{className:"text-xs",children:se.rating})]})]})]})]})},B.id)})}),re&&d.jsxs("dialog",{className:"modal modal-open",children:[d.jsxs("div",{className:"modal-box max-w-lg",children:[d.jsx("h3",{className:"font-bold text-lg mb-2",children:"Share your watchlist"}),d.jsx("p",{className:"text-sm mb-4",children:"Create a shareable page that shows your watched Christmas movies, ratings and vibes."}),d.jsx("div",{className:"form-control mb-4",children:d.jsxs("label",{className:"label cursor-pointer",children:[d.jsx("span",{className:"label-text",children:"Make my watchlist public"}),d.jsx("input",{type:"checkbox",className:"toggle toggle-primary",checked:b,onChange:B=>N(B.target.checked)})]})}),d.jsxs("div",{className:"grid grid-cols-1 gap-3",children:[d.jsxs("div",{className:"form-control",children:[d.jsx("label",{className:"label",children:d.jsx("span",{className:"label-text",children:"Public display name"})}),d.jsx("input",{type:"text",className:"input input-bordered input-sm sm:input-md",value:k,onChange:B=>j(B.target.value),placeholder:"My Xmas Movies"})]}),d.jsxs("div",{className:"form-control",children:[d.jsx("label",{className:"label",children:d.jsx("span",{className:"label-text",children:"Tagline / bio (optional)"})}),d.jsx("input",{type:"text",className:"input input-bordered input-sm sm:input-md",value:L,onChange:B=>P(B.target.value),placeholder:"Only the coziest Xmas movies allowed"})]}),U&&d.jsxs("div",{className:"mt-1 text-xs text-xmas-mute",children:["Your public link: ",d.jsxs("span",{className:"font-mono",children:["/u/",U]})]})]}),d.jsxs("div",{className:"modal-action flex flex-wrap gap-2 justify-between",children:[d.jsxs("div",{className:"flex gap-2",children:[d.jsxs("button",{className:"btn btn-primary btn-sm",onClick:ne,disabled:Ne,children:[Ne&&d.jsx("span",{className:"loading loading-spinner loading-xs mr-1"}),"Save"]}),d.jsxs("button",{type:"button",className:"btn btn-outline btn-sm",onClick:be,disabled:!U,children:[d.jsx("i",{className:"fas fa-link mr-2"}),"Copy link"]})]}),d.jsx("button",{type:"button",className:"btn btn-ghost btn-sm",onClick:()=>te(!1),children:"Close"})]})]}),d.jsx("form",{method:"dialog",className:"modal-backdrop",onClick:()=>te(!1),children:d.jsx("button",{children:"close"})})]})]})},Px=Pt(rt,"stats","global");async function s8(){(await Zn(Px)).exists()||await Ia(Px,{watchedTotal:0,updatedAt:new Date},{merge:!0})}async function i8(t){await s8(),await ea(Px,{watchedTotal:tF(t),updatedAt:new Date})}const l8=[{id:"heartwarming",label:"Heartwarming",emoji:"",type:"positive"},{id:"very_christmassy",label:"Very Christmassy",emoji:"",type:"positive"},{id:"snowy",label:"Snowy Setting",emoji:"",type:"positive"},{id:"funny",label:"Funny",emoji:"",type:"positive"},{id:"cheesy",label:"Cheesy (Good Way)",emoji:"",type:"positive"},{id:"romantic",label:"Romantic",emoji:"",type:"positive"},{id:"family_friendly",label:"Family Friendly",emoji:"",type:"positive"},{id:"background",label:"Good Background Watch",emoji:"",type:"positive"},{id:"tearjerker",label:"Emotional",emoji:"",type:"positive"},{id:"rewatch",label:"Would Rewatch",emoji:"",type:"positive"}],o8=[{id:"slow",label:"Slow Pacing",emoji:"",type:"negative"},{id:"boring",label:"A Bit Boring",emoji:"",type:"negative"},{id:"low_christmas",label:"Low Xmas Vibes",emoji:"",type:"negative"},{id:"weak_chemistry",label:"Weak Chemistry",emoji:"",type:"negative"},{id:"confusing",label:"Confusing Plot",emoji:"",type:"negative"},{id:"too_long",label:"Too Long",emoji:"",type:"negative"},{id:"cringey",label:"Cringey",emoji:"",type:"negative"},{id:"fake_snow",label:"Fake Snow",emoji:"",type:"negative"},{id:"hammy",label:"Hammy",emoji:"",type:"negative"}],c8={heartwarming:"heartwarming",very_christmassy:"full of Christmas vibes",snowy:"with a lovely snowy setting",funny:"with some funny moments",cheesy:"a bit cheesy in a good way",romantic:"with sweet romantic moments",family_friendly:"very family friendly",background:"great as a cosy background watch",tearjerker:"quite emotional at times",rewatch:"something I'd happily rewatch"},u8={slow:"quite slow in places",boring:"a bit boring overall",low_christmas:"lighter on Christmas vibes than expected",weak_chemistry:"with weak chemistry between the leads",confusing:"a bit confusing at times",too_long:"longer than it needed to be",cringey:"a bit cringey in parts",fake_snow:"with fake snow",hammy:"hammy overacting"};function f8(t){return!t||t<=0?"An easy-going Christmas movie.":t>=9?"Absolutely loved this Christmas movie.":t>=8?"Really enjoyed this festive watch.":t>=7?"A good Christmas movie I liked overall.":t>=6?"A decent cosy watch with some nice moments.":t>=5?"An okay Christmas movie, but nothing special.":t>=3?"Not really my thing, it had a few issues.":"I didn't enjoy this Christmas movie very much."}function nE(t){if(t.length===0)return"";if(t.length===1)return t[0];const e=t[t.length-1];return`${t.slice(0,-1).join(", ")} and ${e}`}function h8(t){const e=t.map(a=>c8[a]).filter(Boolean),r=t.map(a=>u8[a]).filter(Boolean);let n="";return e.length&&(n+=` It felt ${nE(e)}.`),r.length&&(n+=` However, it was ${nE(r)}.`),n}const d8=({rating:t,initialTags:e=[],initialAutoReview:r="",onChange:n})=>{const[a,l]=q.useState(e),[o,u]=q.useState(r);q.useEffect(()=>{l(e)},[e.join("|")]),q.useEffect(()=>{u(r)},[r]);const h=v=>{l(_=>_.includes(v)?_.filter(w=>w!==v):[..._,v])},m=()=>{const v=f8(t),_=h8(a),w=(v+_).trim();u(w),n&&n({tags:a,autoReview:w})},p=v=>a.includes(v);return d.jsxs("div",{className:"mt-4",children:[d.jsxs("div",{className:"flex items-center justify-between mb-2",children:[d.jsx("h3",{className:"text-lg font-semibold text-primary",children:"Quick Vibe Review"}),d.jsx("span",{className:"text-xs opacity-80",children:"Pick a few that fit, then generate."})]}),d.jsx("p",{className:"text-xs mb-1 opacity-80",children:"What worked?"}),d.jsx("div",{className:"flex flex-wrap gap-2 mb-3",children:l8.map(v=>d.jsxs("button",{type:"button",onClick:()=>h(v.id),className:`btn btn-xs rounded-full border ${p(v.id)?"btn-accent text-base-100":"btn-ghost border-base-300 text-sm"}`,children:[d.jsx("span",{className:"mr-1",children:v.emoji}),v.label]},v.id))}),d.jsx("p",{className:"text-xs mb-1 opacity-80",children:"What didn't?"}),d.jsx("div",{className:"flex flex-wrap gap-2 mb-3",children:o8.map(v=>d.jsxs("button",{type:"button",onClick:()=>h(v.id),className:`btn btn-xs rounded-full border ${p(v.id)?"btn-error text-base-100":"btn-ghost border-base-300 text-sm"}`,children:[d.jsx("span",{className:"mr-1",children:v.emoji}),v.label]},v.id))}),d.jsx("button",{type:"button",onClick:m,className:"btn btn-sm btn-primary",children:" Generate Review From Tags"}),o&&d.jsxs("p",{className:"mt-3 text-sm opacity-90 italic",children:["Generated preview: ",o,""]})]})},m8=({watched:t,watchedDate:e,onWatchedDateChange:r,rating:n,onRatingChange:a,review:l,onReviewChange:o,vibeTags:u,onVibeChange:h,saving:m,onSave:p})=>d.jsxs(d.Fragment,{children:[d.jsx("h2",{className:"text-2xl font-christmas text-xmas-gold mb-4",children:"Your Rating & Review"}),t&&d.jsxs("div",{className:"form-control mb-4",children:[d.jsx("label",{className:"label",children:d.jsx("span",{className:"label-text",children:"Date Watched"})}),d.jsx("input",{type:"date",className:"input input-bordered",value:e,onChange:v=>r(v.target.value)})]}),d.jsxs("div",{className:"form-control mb-4",children:[d.jsx("label",{className:"label",children:d.jsx("span",{className:"label-text",children:"Your Rating"})}),d.jsx("div",{className:"rating rating-lg",children:[1,2,3,4,5,6,7,8,9,10].map(v=>d.jsx("input",{type:"radio",name:"rating",className:`mask mask-star-2 ${v<=5?"bg-orange-400":"bg-yellow-400"}`,checked:n===v,onChange:()=>a(v)},v))}),n&&d.jsx("div",{className:"mt-2",children:d.jsx("button",{className:"btn btn-xs btn-ghost",onClick:()=>a(null),children:"Clear Rating"})})]}),d.jsx(d8,{rating:n,initialTags:u,initialAutoReview:l,onChange:h}),d.jsxs("div",{className:"form-control mb-6 mt-4",children:[d.jsx("label",{className:"label",children:d.jsx("span",{className:"label-text",children:"Your Review"})}),d.jsx("textarea",{className:"textarea textarea-bordered h-32",placeholder:"Write your thoughts about this movie...",value:l,onChange:v=>o(v.target.value)})]}),d.jsx("div",{className:"flex justify-end",children:d.jsx("button",{className:"btn btn-primary btn-sm sm:btn-md",onClick:p,disabled:m,children:m?d.jsxs(d.Fragment,{children:[d.jsx("span",{className:"loading loading-spinner loading-sm mr-2"}),"Saving..."]}):d.jsxs(d.Fragment,{children:[d.jsx("i",{className:"fas fa-save mr-2"}),"Save Changes"]})})})]}),p8=()=>{const{movieId:t}=Y0(),e=ys(),r=Ma(),{currentUser:n}=An(),a=dN(),l=pN(e.search),u=e.state?.from==="import"?"/import":"/movies",[h,m]=q.useState(null),[p,v]=q.useState(null),[_,w]=q.useState(!0),[E,T]=q.useState(null),[A,M]=q.useState(!1),[F,R]=q.useState(!1),[z,re]=q.useState(""),[te,b]=q.useState(null),[N,k]=q.useState(""),[j,L]=q.useState(!1),[P,U]=q.useState([]),Ce=q.useRef(null);q.useEffect(()=>{(async()=>{if(!n||!l){T("Movie not found"),w(!1);return}try{w(!0);const be=await Zn(Pt(rt,"movies",l));if(!be.exists()){T("Movie not found"),w(!1);return}const Q={id:be.id,...be.data()};m(Q);const I=await gN(n.uid,l);if(I){v(I),R(I.watched);let Z="";if(I.watchedDate)try{if(I.watchedDate instanceof Date)Z=I.watchedDate.toISOString().split("T")[0];else{const ee=I.watchedDate;if(typeof ee=="object"&&ee!==null&&"seconds"in ee){const B=ee;Z=new Date(B.seconds*1e3).toISOString().split("T")[0]}else{const B=new Date(I.watchedDate);isNaN(B.getTime())||(Z=B.toISOString().split("T")[0])}}}catch(ee){console.error("Error parsing watchedDate:",ee)}re(Z),b(I.rating||null),k(I.review||""),L(I.favorite),U(I.vibeTags||[])}}catch(be){console.error("Error fetching movie data:",be),T("Failed to load movie data")}finally{w(!1)}})()},[n,l]),q.useEffect(()=>{F&&Ce.current&&typeof window<"u"&&window.innerWidth<768&&Ce.current.scrollIntoView({behavior:"smooth",block:"start"})},[F]);const Ne=async()=>{if(!(!n||!l||!h))try{M(!0);const ne={userId:n.uid,movieId:l,watched:F,favorite:j,updatedAt:new Date,vibeTags:P};if(F&&z)try{ne.watchedDate=new Date(z),isNaN(ne.watchedDate.getTime())&&delete ne.watchedDate}catch(I){console.error("Error parsing watchedDate for save:",I),delete ne.watchedDate}else F||(ne.watchedDate=null);ne.rating=te,ne.review=N||null;const be=await wm(n.uid,l,ne);v(be);const Q=await h0(n.uid);if(Q.length){const I=Q.map(Z=>Rc.find(ee=>ee.id===Z)?.name||Z).join(", ");a.success(`You unlocked: ${I}! `)}}catch(ne){console.error("Error saving movie data:",ne),T("Failed to save movie data")}finally{M(!1)}},ae=async()=>{if(!n||!l)return;const ne=!j;L(ne);try{const be=Pt(rt,"users",n.uid,"movies",l);(await Zn(be)).exists()?await ea(be,{favorite:ne,updatedAt:new Date}):await Ia(be,{userId:n.uid,movieId:l,favorite:ne,watched:!1,rating:null,review:"",vibeTags:[],addedAt:new Date,updatedAt:new Date},{merge:!0}),v(Z=>Z&&{...Z,favorite:ne});const I=await h0(n.uid);if(I.length){const Z=I.map(ee=>Rc.find(B=>B.id===ee)?.name||ee).join(", ");a.success(`You unlocked: ${Z}! `)}}catch(be){console.error("Failed to toggle favorite",be),L(!ne)}},ue=async()=>{if(!(!n||!l||!window.confirm("Are you sure you want to remove this movie from your collection?")))try{M(!0),await ZP(n.uid,l),r("/movies")}catch(ne){console.error("Error deleting movie:",ne),T("Failed to delete movie"),M(!1)}},pe=async()=>{if(!n||!l)return;const ne=!F;R(ne);try{const be=Pt(rt,"users",n.uid,"movies",l),Q=await Zn(be),I=Q.exists()?Q.data():null,Z=I?!!I.watched:!1;let ee=I&&typeof I.rewatchCount=="number"?I.rewatchCount:0;if(Q.exists()){!Z&&ne&&(ee+=1);const se={watched:ne,...ne?{}:{watchedDate:null},updatedAt:new Date};ee>0&&(se.rewatchCount=ee),await ea(be,se)}else ne&&(ee+=1),await Ia(be,{userId:n.uid,movieId:l,watched:ne,favorite:!1,rating:null,review:"",vibeTags:[],addedAt:new Date,updatedAt:new Date},{merge:!0});v(se=>se&&{...se,watched:ne}),Z!==ne&&await i8(ne?1:-1);const B=await h0(n.uid);if(B.length){const se=B.map(_e=>Rc.find(Pe=>Pe.id===_e)?.name||_e).join(", ");a.success(`You unlocked: ${se}! `)}}catch(be){console.error("Failed to toggle watched",be),R(!ne)}};return _?d.jsx("div",{className:"flex justify-center items-center min-h-[60vh]",children:d.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-xmas-gold"})}):h?d.jsxs("div",{className:"container mx-auto px-4 py-8",children:[d.jsx("div",{className:"mb-4",children:d.jsxs(gt,{to:u,className:"btn btn-primary btn-sm sm:btn-md",children:[d.jsx("i",{className:"fas fa-arrow-left mr-2"})," Back to Movies"]})}),E&&d.jsxs("div",{className:"alert alert-error mb-6",children:[d.jsx("i",{className:"fas fa-exclamation-circle mr-2"}),d.jsx("span",{children:E})]}),d.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-8",children:[d.jsxs("div",{className:"md:col-span-1",children:[d.jsx("div",{className:"rounded-lg overflow-hidden shadow-xl",children:p?.posterUrlOverride||h.posterUrl?d.jsx("img",{src:p?.posterUrlOverride||h.posterUrl,alt:h.title,className:"w-full object-contain",style:{aspectRatio:"2/3"}}):d.jsx("div",{className:"w-full flex items-center justify-center bg-gray-800",style:{aspectRatio:"2/3"},children:d.jsx("i",{className:"fas fa-film text-6xl text-gray-500"})})}),d.jsxs("div",{className:"mt-4 flex flex-col gap-2",children:[d.jsxs("button",{className:`btn ${j?"btn-primary":"btn-outline"} w-full`,onClick:ae,children:[d.jsx("i",{className:`fas fa-star mr-2 ${j?"text-white":""}`}),j?"Favourited":"Add to Favourites"]}),d.jsxs(gt,{to:`/movies/${t}/edit-poster${e.search}`,className:"btn btn-outline w-full",children:[d.jsx("i",{className:"fas fa-image mr-2"}),"Edit Poster"]}),d.jsxs("button",{className:`btn ${F?"btn-success":"btn-outline"} w-full`,onClick:pe,children:[d.jsx("i",{className:`fas fa-check mr-2 ${F?"text-white":""}`}),F?"Watched":"Mark as Watched"]}),d.jsxs("button",{className:"btn btn-error btn-outline w-full",onClick:ue,disabled:A,children:[d.jsx("i",{className:"fas fa-trash mr-2"}),"Remove from Collection"]})]})]}),d.jsxs("div",{className:"md:col-span-2",children:[d.jsx("h1",{className:"font-christmas text-3xl md:text-4xl text-xmas-line mb-2",children:h.title}),h.releaseDate&&d.jsx("p",{className:"text-lg text-gray-400 mb-4",children:new Date(h.releaseDate).getFullYear()}),h.genres&&h.genres.length>0&&d.jsx("div",{className:"flex flex-wrap gap-2 mb-4",children:h.genres.map((ne,be)=>d.jsx("span",{className:"badge badge-outline",children:ne},be))}),h.runtime&&d.jsxs("p",{className:"mb-4",children:[d.jsx("i",{className:"fas fa-clock mr-2 text-xmas-gold"}),Math.floor(h.runtime/60),"h ",h.runtime%60,"m"]}),h.overview&&d.jsxs("div",{className:"mb-6",children:[d.jsx("h2",{className:"text-xl font-bold mb-2",children:"Overview"}),d.jsx("p",{className:"text-gray-300",children:h.overview})]}),h.directors&&h.directors.length>0&&d.jsxs("div",{className:"mb-4",children:[d.jsxs("h2",{className:"text-xl font-bold mb-2",children:["Director",h.directors.length>1?"s":""]}),d.jsx("p",{children:h.directors.join(", ")})]}),h.cast&&h.cast.length>0&&d.jsxs("div",{className:"mb-6",children:[d.jsx("h2",{className:"text-xl font-bold mb-2",children:"Cast"}),d.jsx("p",{className:"flex flex-wrap gap-1",children:h.cast.slice(0,10).map((ne,be)=>d.jsxs(Kf.Fragment,{children:[d.jsx(gt,{to:`/movies?q=${encodeURIComponent(ne)}&field=cast`,className:"link link-primary",children:ne}),be<Math.min(h.cast.length,10)-1&&d.jsx("span",{children:","})]},ne))})]}),d.jsxs("div",{ref:Ce,children:[d.jsx("div",{className:"divider"}),F&&d.jsx(m8,{watched:F,watchedDate:z,onWatchedDateChange:re,rating:te,onRatingChange:b,review:N,onReviewChange:k,vibeTags:P,onVibeChange:({tags:ne,autoReview:be})=>{U(ne),k(be)},saving:A,onSave:Ne})]})]})]})]}):d.jsxs("div",{className:"container mx-auto px-4 py-8",children:[d.jsxs("div",{className:"alert alert-error",children:[d.jsx("i",{className:"fas fa-exclamation-circle mr-2"}),d.jsx("span",{children:"Movie not found"})]}),d.jsx("div",{className:"mt-4",children:d.jsxs(gt,{to:u,className:"btn btn-primary btn-sm sm:btn-md",children:[d.jsx("i",{className:"fas fa-arrow-left mr-2"})," Back to Movies"]})})]})};function aE(t,e){let r=0;const n=(t.title||"").toLowerCase(),a=(e.Title||"").toLowerCase();if(n&&a)if(n===a)r+=60;else if(a.includes(n)||n.includes(a))r+=40;else{const l=n.split(" "),o=a.split(" "),u=l.filter(h=>o.includes(h));r+=u.length/Math.max(l.length,o.length)*40}if(t.releaseDate!=null&&e.Year){const l=String(t.releaseDate).slice(0,4),o=String(e.Year).slice(0,4),u=parseInt(l,10),h=parseInt(o,10);!isNaN(u)&&!isNaN(h)&&(u===h?r+=40:Math.abs(u-h)<=1&&(r+=20))}return Math.min(Math.round(r),100)}const Is=t=>t?.Poster&&t.Poster!=="N/A"?t.Poster:t?.posterUrl||"",g8=({onSelect:t,userMovieIds:e})=>{const r=Ma(),[n,a]=q.useState([]),[l,o]=q.useState(!0),[u,h]=q.useState(null),[m,p]=q.useState(""),[v,_]=q.useState("all"),[w,E]=q.useState("title-asc"),[T,A]=q.useState(!1);q.useEffect(()=>{(async()=>{try{o(!0),h(null);const te=(await Er(ur(rt,"movies"))).docs.map(b=>{const N=b.data();return N.imdbId?{id:N.imdbId,title:N.title,release_date:N.releaseDate,poster_path:N.posterUrl?.startsWith("https://image.tmdb.org/t/p/")?N.posterUrl.replace("https://image.tmdb.org/t/p/w500",""):null,posterUrl:N.posterUrl||null,source:"local",firestoreId:b.id,cast:N.cast||[],runtime:N.runtime,genres:N.genres||[],overview:N.overview}:null}).filter(Boolean);a(te)}catch(re){console.error("Error loading local catalogue:",re),h(re?.message??"Failed to load local catalogue")}finally{o(!1)}})()},[]);const M=q.useCallback(z=>{if(!m.trim())return!0;const re=m.toLowerCase().trim(),te=re.split(",").map(N=>N.trim()).filter(Boolean),b=N=>z.cast&&z.cast.some(k=>k.toLowerCase().includes(N));switch(v){case"title":return z.title.toLowerCase().includes(re);case"year":return!!z.release_date&&!!Qa(z.release_date)?.includes(re);case"cast":return te.length?te.some(N=>b(N)):b(re);case"all":default:{const N=z.release_date&&Qa(z.release_date);return z.title.toLowerCase().includes(re)||N&&N.includes(re)||z.cast&&z.cast.some(k=>k.toLowerCase().includes(re))}}},[m,v]),F=q.useMemo(()=>n.filter(z=>{if(!M(z))return!1;const re=!!z.firestoreId&&e.includes(z.firestoreId);return!(T&&re)}),[n,M,e,T]),R=q.useMemo(()=>{const z=[...F],re=te=>{if(!te.release_date)return 0;const b=Qa(te.release_date);if(!b)return 0;const N=parseInt(b,10);return Number.isNaN(N)?0:N};return z.sort((te,b)=>{switch(w){case"title-asc":return te.title.localeCompare(b.title);case"title-desc":return b.title.localeCompare(te.title);case"year-desc":{const N=re(te);return re(b)-N||te.title.localeCompare(b.title)}case"year-asc":{const N=re(te),k=re(b);return N-k||te.title.localeCompare(b.title)}default:return 0}}),z},[F,w]);return d.jsxs("div",{className:"space-y-4",children:[d.jsxs("div",{className:"flex flex-col lg:flex-row gap-2",children:[d.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 flex-1",children:[d.jsxs("div",{className:"relative flex-grow",children:[d.jsx("div",{className:"absolute inset-y-0 left-0 pl-2 flex items-center pointer-events-none",children:d.jsx("i",{className:"fas fa-search text-gray-400"})}),d.jsx("input",{type:"text",className:"input input-bordered input-sm sm:input-md w-full pl-8 pr-8",placeholder:"   Search catalogue by title, cast, year...",value:m,onChange:z=>p(z.target.value)}),m&&d.jsx("button",{className:"absolute inset-y-0 right-0 pr-2 flex items-center",onClick:()=>p(""),children:d.jsx("i",{className:"fas fa-times text-gray-400 hover:text-gray-600"})})]}),d.jsxs("select",{className:"select select-bordered select-sm sm:select-md w-full sm:w-40",value:v,onChange:z=>_(z.target.value),children:[d.jsx("option",{value:"all",children:"All Fields"}),d.jsx("option",{value:"title",children:"Title Only"}),d.jsx("option",{value:"year",children:"Year Only"}),d.jsx("option",{value:"cast",children:"Cast Only"})]})]}),d.jsx("div",{className:"flex items-center justify-end",children:d.jsxs("select",{className:"select select-bordered select-sm sm:select-md w-full sm:w-52",value:w,onChange:z=>E(z.target.value),children:[d.jsx("option",{value:"title-asc",children:"Sort: Title (A  Z)"}),d.jsx("option",{value:"title-desc",children:"Sort: Title (Z  A)"}),d.jsx("option",{value:"year-desc",children:"Sort: Year (Newest  Oldest)"}),d.jsx("option",{value:"year-asc",children:"Sort: Year (Oldest  Newest)"})]})})]}),d.jsxs("div",{className:"flex flex-col xs:flex-row justify-between items-start xs:items-center text-xs sm:text-sm gap-2",children:[d.jsx("div",{children:l?d.jsx("span",{children:"Loading catalogue"}):d.jsxs(d.Fragment,{children:[d.jsx("span",{className:"font-medium",children:R.length})," ",R.length===1?"movie":"movies"," in catalogue",m&&d.jsxs("span",{className:"ml-1 opacity-70",children:["for: ",d.jsxs("span",{className:"font-medium",children:['"',m,'"']})]})]})}),d.jsxs("label",{className:"flex items-center gap-1 cursor-pointer select-none",children:[d.jsx("input",{type:"checkbox",className:"checkbox checkbox-xs sm:checkbox-sm",checked:T,onChange:z=>A(z.target.checked)}),d.jsx("span",{children:"Hide owned movies"})]})]}),u&&d.jsx("div",{className:"alert alert-error",children:u}),l&&d.jsx("div",{className:"flex justify-center p-6",children:d.jsx("span",{className:"loading loading-spinner loading-lg"})}),!l&&R.length===0&&!u&&d.jsxs("div",{className:"bg-xmas-card bg-opacity-60 rounded-lg p-6 text-center",children:[d.jsx("h3",{className:"text-lg font-semibold mb-2",children:"No movies found"}),d.jsx("p",{className:"text-sm opacity-80 mb-2",children:"Try changing your search text, field, or sort order."})]}),!l&&R.length>0&&d.jsx("div",{className:"grid grid-cols-3 sm:grid-cols-4 md:grid-cols-5 lg:grid-cols-6 gap-2 sm:gap-3",children:R.map(z=>{const re=!!z.firestoreId&&e.includes(z.firestoreId);return d.jsx("div",{className:`block transition-transform hover:scale-[1.02] hover:shadow-xl ${re?"opacity-60 cursor-pointer":"cursor-pointer"}`,onClick:()=>{re&&z.firestoreId?r(l1(z.title,z.firestoreId),{state:{from:"import"}}):t(z)},children:d.jsxs("div",{className:"relative rounded-lg overflow-hidden bg-xmas-card shadow-md h-full flex flex-col",children:[d.jsxs("div",{className:"relative",children:[Is(z)?d.jsx("img",{src:Is(z),alt:z.title,className:"w-full h-auto object-cover",style:{aspectRatio:"2/3"},loading:"lazy"}):d.jsx("div",{className:"w-full flex items-center justify-center bg-gray-800",style:{aspectRatio:"2/3"},children:d.jsx("i",{className:"fas fa-film text-2xl text-gray-500"})}),re&&d.jsxs("div",{className:`\r
                          absolute top-1 left-1 \r
                          badge badge-success \r
                          px-2 py-0.5 \r
                          text-[0.6rem] leading-none \r
                          whitespace-nowrap \r
                          flex items-center gap-1 \r
                          shadow\r
                        `,children:[d.jsx("i",{className:"fas fa-check text-[0.6rem]"}),d.jsx("span",{children:"Owned"})]})]}),d.jsxs("div",{className:"p-1 sm:p-2 flex-grow flex flex-col",children:[d.jsx("h3",{className:"text-xs sm:text-sm font-medium line-clamp-2",children:z.title}),d.jsx("p",{className:"text-xs text-gray-400 mt-1",children:z.release_date&&Qa(z.release_date)})]})]})},z.firestoreId||z.id)})})]})},x8=({selected:t,showDetails:e,loading:r,onToggleDetails:n,onAdd:a,onClose:l})=>t?d.jsx("dialog",{className:"modal modal-open",children:d.jsxs("div",{className:"modal-box bg-xmas-card",children:[d.jsxs("div",{className:"flex gap-4",children:[d.jsx("div",{className:"w-24 shrink-0",children:Is(t)?d.jsx("img",{src:Is(t),alt:t.title,className:"w-full rounded-lg"}):d.jsx("div",{className:"w-full h-36 bg-base-200 flex items-center justify-center rounded-lg",children:d.jsx("i",{className:"fas fa-film text-2xl opacity-50"})})}),d.jsxs("div",{className:"flex-1",children:[d.jsx("h2",{className:"text-xl font-bold mb-1",children:t.title}),d.jsx("p",{className:"text-sm opacity-80 mb-1",children:Qa(t.release_date||t.releaseDate||t.Year||t.Released)}),!e&&t.runtime&&d.jsxs("p",{className:"text-sm opacity-80 mb-1",children:["Runtime: ",t.runtime," min"]}),e&&d.jsxs("div",{className:"mt-3 space-y-2 text-sm opacity-90 max-h-48 overflow-auto pr-1",children:[t.overview&&d.jsxs("div",{children:[d.jsx("p",{className:"font-semibold mb-1",children:"Overview"}),d.jsx("p",{children:t.overview})]}),t.runtime&&d.jsxs("p",{children:[d.jsx("span",{className:"font-semibold",children:"Runtime:"})," ",t.runtime," min"]}),t.genres&&t.genres.length>0&&d.jsxs("p",{children:[d.jsx("span",{className:"font-semibold",children:"Genres:"})," ",t.genres.map(o=>typeof o=="string"?o:o.name).join(", ")]}),(t.credits?.cast?.length||t.cast?.length)&&d.jsxs("p",{children:[d.jsx("span",{className:"font-semibold",children:"Top cast:"})," ",(t.credits?.cast&&t.credits.cast.length>0?t.credits.cast.map(o=>o.name):t.cast).slice(0,5).join(", ")]})]})]})]}),d.jsx("div",{className:"mt-4 space-y-3",children:d.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-3",children:[d.jsx("div",{children:(t.overview||t.runtime||t.genres||t.credits||t.cast)&&d.jsxs("button",{type:"button",className:"btn btn-outline btn-sm sm:btn-md gap-2",onClick:n,disabled:r,children:[d.jsx("i",{className:"fas fa-info-circle"}),e?"Hide details":"View details"]})}),d.jsxs("div",{className:"flex justify-end gap-2",children:[d.jsxs("button",{className:"btn btn-primary btn-sm sm:btn-md",onClick:a,disabled:r,children:[r?d.jsx("span",{className:"loading loading-spinner loading-sm mr-2"}):d.jsx("i",{className:"fas fa-plus mr-2"}),"Add Movie"]}),d.jsx("button",{className:"btn btn-outline btn-sm sm:btn-md",onClick:l,disabled:r,children:"Cancel"})]})]})}),d.jsx("form",{method:"dialog",className:"modal-backdrop",onClick:l,children:d.jsx("button",{children:"close"})})]})}):null,v8=()=>{const{currentUser:t,userProfile:e}=An(),[r,n]=q.useState(!1),[a,l]=q.useState(""),[o,u]=q.useState(""),[h,m]=q.useState(""),[p,v]=q.useState(""),[_,w]=q.useState(""),[E,T]=q.useState(""),[A,M]=q.useState(""),[F,R]=q.useState(!1),[z,re]=q.useState(null),[te,b]=q.useState(null);q.useEffect(()=>{p&&!_&&w(`https://www.themoviedb.org/movie/${p}`)},[p,_]);const N=()=>{l(""),u(""),m(""),v(""),w(""),T(""),M(""),re(null)},k=()=>{if(re(null),b(null),!t){re("Please sign in to request a movie.");return}n(!0)},j=()=>{F||(n(!1),N())},L=async P=>{if(P.preventDefault(),!t){re("You must be signed in to submit a request.");return}if(!a.trim()){re("Please enter a movie title.");return}try{R(!0),re(null),await vm(ur(rt,"Requests"),{title:a.trim(),imdbId:o.trim()||null,imdbUrl:h.trim()||null,tmdbId:p?Number(p):null,tmdbUrl:_.trim()||null,year:E.trim()||null,notes:A.trim()||null,userId:t.uid,userDisplayName:e?.displayName||t.displayName||null,status:"pending",createdAt:new Date}),b("Request submitted! Thank you."),N(),n(!1)}catch(U){console.error("Failed to submit movie request:",U),re(U?.message||"Failed to submit request. Please try again.")}finally{R(!1)}};return d.jsxs(d.Fragment,{children:[d.jsxs("button",{type:"button",className:"btn btn-outline btn-sm sm:btn-md mb-4",onClick:k,children:[d.jsx("i",{className:"fas fa-gift mr-2"}),"Request a movie"]}),z&&!r&&d.jsxs("div",{className:"alert alert-warning mb-4",children:[d.jsx("i",{className:"fas fa-exclamation-triangle mr-2"}),d.jsx("span",{children:z})]}),te&&!r&&d.jsxs("div",{className:"alert alert-success mb-4",children:[d.jsx("i",{className:"fas fa-check-circle mr-2"}),d.jsx("span",{children:te})]}),r&&d.jsx("dialog",{className:"modal modal-open",children:d.jsxs("div",{className:"modal-box bg-xmas-card max-w-lg",children:[d.jsx("h2",{className:"font-christmas text-2xl mb-2 text-xmas-gold",children:"Request a Movie"}),d.jsx("p",{className:"text-sm mb-4 opacity-80",children:"Can't find a movie in the catalogue? Tell us about it so we can add it."}),z&&d.jsxs("div",{className:"alert alert-error mb-3",children:[d.jsx("i",{className:"fas fa-exclamation-circle mr-2"}),d.jsx("span",{children:z})]}),d.jsxs("form",{className:"space-y-3",onSubmit:L,children:[d.jsxs("div",{children:[d.jsx("label",{className:"label",children:d.jsx("span",{className:"label-text",children:"Movie title *"})}),d.jsx("input",{type:"text",className:"input input-bordered w-full",value:a,onChange:P=>l(P.target.value),required:!0,disabled:F,placeholder:"e.g. The Grinch"})]}),d.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:[d.jsxs("div",{children:[d.jsx("label",{className:"label",children:d.jsx("span",{className:"label-text",children:"IMDb ID (optional)"})}),d.jsx("input",{type:"text",className:"input input-bordered w-full",value:o,onChange:P=>u(P.target.value),disabled:F,placeholder:"e.g. tt0096061"})]}),d.jsxs("div",{children:[d.jsx("label",{className:"label",children:d.jsx("span",{className:"label-text",children:"Release year (optional)"})}),d.jsx("input",{type:"number",className:"input input-bordered w-full",value:E,onChange:P=>T(P.target.value),disabled:F,placeholder:"e.g. 2000"})]})]}),d.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:[d.jsxs("div",{children:[d.jsx("label",{className:"label",children:d.jsx("span",{className:"label-text",children:"IMDb URL (optional)"})}),d.jsx("input",{type:"url",className:"input input-bordered w-full",value:h,onChange:P=>m(P.target.value),disabled:F,placeholder:"https://www.imdb.com/title/..."})]}),d.jsxs("div",{children:[d.jsx("label",{className:"label",children:d.jsx("span",{className:"label-text",children:"TMDB URL (optional)"})}),d.jsx("input",{type:"url",className:"input input-bordered w-full",value:_,onChange:P=>w(P.target.value),disabled:F,placeholder:"https://www.themoviedb.org/movie/..."}),d.jsx("p",{className:"text-xs opacity-70 mt-1",children:"If you provide a TMDB ID, the URL will be auto-filled. You can also paste a URL directly."})]})]}),d.jsxs("div",{children:[d.jsx("label",{className:"label",children:d.jsx("span",{className:"label-text",children:"Anything else that helps? (optional)"})}),d.jsx("textarea",{className:"textarea textarea-bordered w-full",rows:3,value:A,onChange:P=>M(P.target.value),disabled:F,placeholder:"Actors, streaming service, or where you heard about it."})]}),d.jsxs("div",{className:"modal-action flex justify-end gap-2",children:[d.jsx("button",{type:"button",className:"btn btn-ghost",onClick:j,disabled:F,children:"Cancel"}),d.jsxs("button",{type:"submit",className:"btn btn-primary",disabled:F,children:[F&&d.jsx("span",{className:"loading loading-spinner loading-sm mr-2"}),"Submit request"]})]})]}),d.jsx("form",{method:"dialog",className:"modal-backdrop",onClick:j,children:d.jsx("button",{children:"close"})})]})})]})},y8=()=>{const{currentUser:t}=An(),[e,r]=q.useState(null),[n,a]=q.useState(!1),[l,o]=q.useState(!1),[u,h]=q.useState(null),[m,p]=q.useState([]);q.useEffect(()=>{(async()=>{if(!t){p([]);return}try{const{userMovies:T}=await uh(t.uid);p(Object.keys(T))}catch(T){console.error("Error loading user movies for import page:",T)}})()},[t]);const v=E=>{h(null),a(!1),r(E)},_=async()=>{if(!(!t||!e))try{o(!0),h(null);const E=ur(rt,"movies");let T;if(e.firestoreId)T=e.firestoreId;else{h({type:"error",text:"Unable to add this movie from catalogue."}),o(!1);return}await wm(t.uid,T,{userId:t.uid,movieId:T,watched:!1,favorite:!1}),p(A=>A.includes(T)?A:[...A,T]),o1(),h({type:"success",text:"Added to your collection!"}),a(!1),r(null)}catch(E){h({type:"error",text:E?.message??"Failed to add movie"})}finally{o(!1)}},w=()=>{l||r(null)};return d.jsxs("div",{className:"container mx-auto px-4 py-8",children:[d.jsx("div",{className:"mb-4",children:d.jsxs(gt,{to:"/movies",className:"btn btn-primary btn-sm sm:btn-md",children:[d.jsx("i",{className:"fas fa-arrow-left mr-2"})," Back to Movies"]})}),d.jsx("h1",{className:"font-christmas text-3xl md:text-4xl text-xmas-line mb-6",children:"Add Movies"}),u&&d.jsxs("div",{className:`alert ${u.type==="error"?"alert-error":"alert-success"} mb-4`,children:[d.jsx("i",{className:`fas ${u.type==="error"?"fa-exclamation-circle":"fa-check-circle"} mr-2`}),d.jsx("span",{children:u.text})]}),d.jsx("div",{className:"mb-4",children:d.jsx(v8,{})}),d.jsx("div",{className:"bg-xmas-card p-6 rounded-lg shadow-lg",children:d.jsx(g8,{onSelect:v,userMovieIds:m})}),e&&d.jsx(x8,{selected:e,showDetails:n,loading:l,onToggleDetails:()=>a(E=>!E),onAdd:_,onClose:w})]})},_8=()=>{const{currentUser:t}=An(),[e,r]=q.useState([]),[n,a]=q.useState({}),[l,o]=q.useState(!0),[u,h]=q.useState(null),[m,p]=q.useState(null),[v,_]=q.useState(!1),[w,E]=q.useState(!1);q.useEffect(()=>{(async()=>{if(t)try{o(!0);const{userMovies:M,movies:F}=await uh(t.uid);a(M),r(F)}catch(M){console.error("Error fetching movies:",M),h("Failed to load movies")}finally{o(!1)}})()},[t]);const T=()=>{if(e.length===0)return;E(!0),p(null);const A=e.filter(z=>{const re=n[z.id];return v||!re||!re.watched});if(A.length===0){h("No eligible movies found. Try including watched movies."),E(!1);return}let M=0;const F=25,R=setInterval(()=>{const z=Math.floor(Math.random()*A.length);p(A[z]),M++,M>=F&&(clearInterval(R),E(!1))},100)};return l?d.jsx("div",{className:"flex justify-center items-center min-h-[60vh]",children:d.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-xmas-gold"})}):d.jsxs("div",{className:"container mx-auto px-4 py-8",children:[d.jsx("div",{className:"mb-4",children:d.jsxs(gt,{to:"/movies",className:"btn btn-primary btn-sm sm:btn-md",children:[d.jsx("i",{className:"fas fa-arrow-left mr-2"})," Back to Movies"]})}),d.jsx("h1",{className:"font-christmas text-3xl md:text-4xl text-xmas-line mb-6",children:"Christmas Movie Picker"}),u&&d.jsxs("div",{className:"alert alert-error mb-6",children:[d.jsx("i",{className:"fas fa-exclamation-circle mr-2"}),d.jsx("span",{children:u})]}),e.length===0?d.jsxs("div",{className:"bg-xmas-card p-8 rounded-lg text-center",children:[d.jsx("h3",{className:"text-xl mb-4",children:"No movies in your collection"}),d.jsx("p",{className:"mb-4",children:"Add some Christmas movies to use the random movie picker!"}),d.jsxs(gt,{to:"/import",className:"btn btn-primary",children:[d.jsx("i",{className:"fas fa-file-import mr-2"})," Import Movies"]})]}):d.jsxs("div",{className:"bg-xmas-card p-8 rounded-lg shadow-lg",children:[d.jsxs("div",{className:"text-center mb-6",children:[d.jsx("p",{className:"mb-4",children:"Can't decide what Christmas movie to watch? Let us pick one for you!"}),d.jsx("div",{className:"form-control mb-6",children:d.jsxs("label",{className:"label cursor-pointer justify-center",children:[d.jsx("span",{className:"label-text mr-2",children:"Include watched movies"}),d.jsx("input",{type:"checkbox",className:"toggle toggle-primary",checked:v,onChange:()=>_(!v)})]})}),d.jsx("button",{className:"btn btn-primary btn-lg",onClick:T,disabled:w,children:w?d.jsxs(d.Fragment,{children:[d.jsx("span",{className:"loading loading-spinner loading-md mr-2"}),"Picking a movie..."]}):d.jsxs(d.Fragment,{children:[d.jsx("i",{className:"fas fa-random mr-2"}),"Pick a Random Movie"]})})]}),m&&d.jsx("div",{className:"mt-8 flex flex-col items-center",children:d.jsx("div",{className:"w-full max-w-md",children:d.jsxs("div",{className:"card bg-base-100 shadow-xl overflow-hidden",children:[d.jsxs("figure",{className:"relative",children:[m.posterUrl?d.jsx("img",{src:m.posterUrl,alt:m.title,className:"w-full object-contain",style:{aspectRatio:"2/3",maxHeight:"500px"},loading:"lazy"}):d.jsx("div",{className:"w-full flex items-center justify-center bg-gray-800",style:{aspectRatio:"2/3",maxHeight:"500px"},children:d.jsx("i",{className:"fas fa-film text-6xl text-gray-500"})}),n[m.id]?.watched&&d.jsx("div",{className:"absolute top-4 left-4 badge badge-lg badge-success",children:"Already Watched"}),n[m.id]?.rating&&d.jsxs("div",{className:"absolute top-4 right-4 badge badge-lg badge-warning",children:[d.jsx("i",{className:"fas fa-star mr-1"}),n[m.id].rating,"/10"]})]}),d.jsxs("div",{className:"card-body",children:[d.jsx("h2",{className:"card-title text-2xl font-christmas",children:m.title}),d.jsx("p",{className:"text-gray-400",children:m.releaseDate&&Qa(m.releaseDate)}),d.jsxs("div",{className:"card-actions justify-end mt-4",children:[d.jsx(gt,{to:l1(m.title,m.id),className:"btn btn-primary",children:"View Details"}),d.jsx("button",{className:"btn btn-outline",onClick:T,disabled:w,children:"Pick Another"})]})]})]})})})]})]})},w8=(t,e)=>{const r=["Title","TMDB ID","Release Year","Watched","Watched Date","Rating","Review","Favorite","Date Added"].join(","),n=t.map(a=>{const l=e[a.id];if(!l)return null;const o=a.releaseDate?a.releaseDate.substring(0,4):"",u=l.watchedDate?Lx(l.watchedDate):"",h=l.addedAt?Lx(l.addedAt):"",m=sE(a.title),p=l.review?sE(l.review):"";return[m,a.imdbId||"",o,l.watched?"Yes":"No",u,l.rating!==null&&l.rating!==void 0?l.rating:"",p,l.favorite?"Yes":"No",h].join(",")}).filter(Boolean);return[r,...n].join(`
`)},Lx=t=>{if(!(t instanceof Date))try{t&&typeof t.toDate=="function"?t=t.toDate():t=new Date(t)}catch{return""}return t.toISOString().split("T")[0]},sE=t=>t?t.includes(",")||t.includes('"')||t.includes(`
`)?`"${t.replace(/"/g,'""')}"`:t:"",T8=(t,e,r)=>{const n=document.createElement("a"),a=new Blob([t],{type:r});n.href=URL.createObjectURL(a),n.download=e,n.click(),URL.revokeObjectURL(n.href)},E8=async(t,e,r)=>{const n=w8(t,e),a=`${r.replace(/\s+/g,"_")}_christmas_movies_${Lx(new Date)}.csv`;T8(n,a,"text/csv;charset=utf-8;")},vN=t=>{const e=t.trim();return/^The\s+/i.test(e)?e.replace(/^The\s+/i,"").trim():/^A\s+/i.test(e)?e.replace(/^A\s+/i,"").trim():/^An\s+/i.test(e)?e.replace(/^An\s+/i,"").trim():e},b8=async()=>{const t=ur(rt,"movies"),e=await Er(t);let r=0;const n=e.size;for(const a of e.docs){const l=a.data();if(l.sortTitle)continue;const o=vN(l.title);o!==l.title&&(await ea(Pt(rt,"movies",a.id),{sortTitle:o,updatedAt:new Date}),r++)}return{updated:r,total:n}},S8=()=>{const{currentUser:t}=An(),[e,r]=q.useState([]),[n,a]=q.useState(!1),[l,o]=q.useState(null),[u,h]=q.useState(null),[m,p]=q.useState(new Set);q.useEffect(()=>{(async()=>{if(t){a(!0),o(null);try{const T=gs(ur(rt,"Requests"),Da("userId","==",t.uid)),M=(await Er(T)).docs.map(F=>{const R=F.data();return{id:F.id,title:R.title,year:R.year??null,status:R.status,tmdbId:R.tmdbId??null,createdAt:R.createdAt,updatedAt:R.updatedAt}});if(r(M),t&&M.length>0){const F=[];for(const R of M){if(R.status!=="fulfilled"||!R.tmdbId)continue;const z=ur(rt,"movies"),re=gs(z,Da("tmdbId","==",R.tmdbId)),te=await Er(re);if(te.empty)continue;const N=te.docs[0].id,k=Pt(rt,`users/${t.uid}/movies`,N);(await Zn(k)).exists()&&F.push(R.id)}F.length>0&&p(new Set(F))}}catch(T){console.error("Error loading your movie requests:",T),o(T.message||"Failed to load your movie requests")}finally{a(!1)}}})()},[t]);const v=E=>{if(!E)return"";const T=E?.toDate?E.toDate():E;try{return new Date(T).toLocaleString()}catch{return""}},_=E=>E==="fulfilled"?"badge badge-success":E==="dismissed"?"badge badge-ghost":"badge badge-warning",w=async E=>{if(t){if(!E.tmdbId){o("This request does not have a TMDB ID to match a movie.");return}try{o(null),h(E.id);const T=ur(rt,"movies"),A=gs(T,Da("tmdbId","==",E.tmdbId)),M=await Er(A);if(M.empty){o("Could not find this movie in the catalogue yet.");return}const R=M.docs[0].id;await wm(t.uid,R,{userId:t.uid,movieId:R,watched:!1,favorite:!1}),p(z=>new Set(z).add(E.id))}catch(T){console.error("Failed to add movie to your collection:",T),o(T.message||"Failed to add movie to your collection")}finally{h(null)}}};return d.jsxs("div",{className:"mt-8",children:[d.jsx("h3",{className:"text-lg font-bold mb-2",children:"My Movie Requests"}),d.jsx("p",{className:"text-sm opacity-80 mb-4",children:"These are movies you've asked to be added to the catalogue."}),n&&d.jsx("div",{className:"flex justify-center py-4",children:d.jsx("span",{className:"loading loading-spinner loading-md"})}),l&&d.jsxs("div",{className:"alert alert-error mb-4",children:[d.jsx("i",{className:"fas fa-exclamation-circle mr-2"}),d.jsx("span",{children:l})]}),!n&&!l&&e.length===0&&d.jsx("p",{className:"text-sm opacity-80",children:"You haven't requested any movies yet."}),!n&&!l&&e.length>0&&d.jsx("div",{className:"overflow-x-auto",children:d.jsxs("table",{className:"table table-zebra table-sm",children:[d.jsx("thead",{children:d.jsxs("tr",{children:[d.jsx("th",{children:"Title"}),d.jsx("th",{children:"Year"}),d.jsx("th",{children:"Status"}),d.jsx("th",{children:"Last Updated"}),d.jsx("th",{})]})}),d.jsx("tbody",{children:e.map(E=>d.jsxs("tr",{children:[d.jsx("td",{children:E.title}),d.jsx("td",{children:E.year||"-"}),d.jsx("td",{children:d.jsx("span",{className:_(E.status),children:E.status})}),d.jsx("td",{className:"text-xs",children:v(E.updatedAt||E.createdAt)}),d.jsx("td",{children:E.status==="fulfilled"&&E.tmdbId&&(m.has(E.id)?d.jsx("span",{className:"badge badge-success text-xs",children:"In collection"}):d.jsxs("button",{className:"btn btn-xs btn-primary",onClick:()=>w(E),disabled:u===E.id,children:[u===E.id&&d.jsx("span",{className:"loading loading-spinner loading-xs mr-1"}),"Add to my movies"]}))})]},E.id))})]})})]})},A8=()=>{const{currentUser:t,userProfile:e,signOut:r}=An(),{isAdmin:n}=Qc(),[a,l]=q.useState(!1),[o,u]=q.useState(!1),[h,m]=q.useState(""),[p,v]=q.useState(""),[_,w]=q.useState(!1),[E,T]=q.useState(""),[A,M]=q.useState(!1),[F,R]=q.useState(!1),[z,re]=q.useState(!1),[te,b]=q.useState(!1),[N,k]=q.useState(null),[j,L]=q.useState(null),[P,U]=q.useState(!1),[Ce,Ne]=q.useState(!1),[ae,ue]=q.useState({totalMovies:0,watchedMovies:0,unwatchedMovies:0,averageRating:0,favoriteMovies:0});q.useEffect(()=>{e?.omdbApiKey&&m(e.omdbApiKey),e?.fanartApiKey&&v(e.fanartApiKey),e?.tmdbApiKey&&T(e.tmdbApiKey),(async()=>{if(t)try{const se=await Fx(t.uid),_e=se.length,Pe=se.filter(Qe=>Qe.watched).length,he=_e-Pe,we=se.filter(Qe=>Qe.favorite).length,He=se.filter(Qe=>Qe.rating!==void 0&&Qe.rating!==null),J=He.length>0?He.reduce((Qe,$e)=>Qe+($e.rating||0),0)/He.length:0;ue({totalMovies:_e,watchedMovies:Pe,unwatchedMovies:he,averageRating:J,favoriteMovies:we})}catch(se){console.error("Error fetching user stats:",se)}})()},[t,e]);const pe=()=>{Ne(!0)},ne=async()=>{if(t)try{re(!0),k(null),Ne(!1),await e8(t.uid),P&&await t8(t.uid);const B=await Fx(t.uid),se=B.length,_e=B.filter(J=>J.watched).length,Pe=se-_e,he=B.filter(J=>J.favorite).length,we=B.filter(J=>J.rating!==void 0&&J.rating!==null),He=we.length>0?we.reduce((J,Qe)=>J+(Qe.rating||0),0)/we.length:0;ue({totalMovies:se,watchedMovies:_e,unwatchedMovies:Pe,averageRating:He,favoriteMovies:he}),L(P?"Your watch status and achievements have been reset for a fresh start!":"Your watch status has been reset so you can start a new year fresh!"),setTimeout(()=>{L(null)},4e3)}catch(B){console.error("Error resetting user data:",B),k(B.message||"Failed to reset your watch status")}finally{re(!1)}},be=async()=>{if(t)try{M(!0),k(null);const B=Pt(rt,"users",t.uid);await ea(B,{tmdbApiKey:E||null}),L("TMDb API key saved successfully!"),setTimeout(()=>{L(null)},3e3)}catch(B){console.error("Error saving TMDb API key:",B),k(B.message||"Failed to save TMDb API key")}finally{M(!1)}},Q=async()=>{if(t)try{M(!0),k(null);const B=Pt(rt,"users",t.uid);await ea(B,{omdbApiKey:h}),L("OMDb API key saved successfully!"),setTimeout(()=>{L(null)},3e3)}catch(B){console.error("Error saving API key:",B),k(B.message||"Failed to save API key")}finally{M(!1)}},I=async()=>{if(t)try{M(!0),k(null);const B=Pt(rt,"users",t.uid);await ea(B,{fanartApiKey:p||null}),L("fanart.tv API key saved successfully!"),setTimeout(()=>{L(null)},3e3)}catch(B){console.error("Error saving fanart.tv API key:",B),k(B.message||"Failed to save fanart.tv API key")}finally{M(!1)}},Z=async()=>{try{await r()}catch(B){console.error("Error signing out:",B)}},ee=async()=>{if(t)try{R(!0),k(null);const{userMovies:B,movies:se}=await uh(t.uid);await E8(se,B,e.displayName||"User"),L("Movies exported successfully!"),setTimeout(()=>{L(null)},3e3)}catch(B){console.error("Error exporting movies:",B),k(B.message||"Failed to export movies")}finally{R(!1)}};return!t||!e?d.jsx("div",{className:"flex justify-center items-center min-h-[60vh]",children:d.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-xmas-gold"})}):d.jsxs("div",{className:"container mx-auto px-4 py-8",children:[d.jsx("h1",{className:"font-christmas text-3xl md:text-4xl text-xmas-line mb-6",children:"Your Profile"}),N&&d.jsxs("div",{className:"alert alert-error mb-6",children:[d.jsx("i",{className:"fas fa-exclamation-circle mr-2"}),d.jsx("span",{children:N})]}),j&&d.jsxs("div",{className:"alert alert-success mb-6",children:[d.jsx("i",{className:"fas fa-check-circle mr-2"}),d.jsx("span",{children:j})]}),Ce&&d.jsx("div",{className:"modal modal-open",children:d.jsxs("div",{className:"modal-box bg-xmas-card border border-xmas-gold/40",children:[d.jsx("h3",{className:"font-bold text-lg text-xmas-gold mb-2",children:"Start New Year Fresh?"}),d.jsx("p",{className:"text-sm mb-4",children:P?"This will mark all your movies as unwatched and reset all of your achievements so you can start again. Ratings, reviews and favourites will be kept.":"This will mark all your movies as unwatched so you can start a new year fresh. Ratings, reviews and favourites will be kept."}),d.jsxs("div",{className:"modal-action flex justify-end gap-2",children:[d.jsx("button",{className:"btn btn-ghost",type:"button",onClick:()=>Ne(!1),disabled:z,children:"Cancel"}),d.jsxs("button",{className:"btn btn-error",type:"button",onClick:ne,disabled:z,children:[z&&d.jsx("span",{className:"loading loading-spinner loading-sm mr-2"}),"Yes, reset"]})]})]})}),d.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-8",children:[d.jsx("div",{className:"md:col-span-1",children:d.jsxs("div",{className:"bg-xmas-card p-6 rounded-lg shadow-lg",children:[d.jsxs("div",{className:"flex flex-col items-center mb-6",children:[e.photoURL?d.jsx("img",{src:e.photoURL,alt:e.displayName,className:"w-24 h-24 rounded-full mb-4"}):d.jsx("div",{className:"w-24 h-24 rounded-full bg-gray-700 flex items-center justify-center mb-4",children:d.jsx("i",{className:"fas fa-user text-4xl text-gray-400"})}),d.jsx("h2",{className:"text-xl font-bold",children:e.displayName})]}),d.jsx("div",{className:"divider"}),d.jsxs("div",{className:"mb-6",children:[d.jsx("h3",{className:"text-lg font-bold mb-2",children:"Your Stats"}),d.jsxs("ul",{className:"space-y-2",children:[d.jsxs("li",{className:"flex justify-between",children:[d.jsx("span",{children:"Total Movies:"}),d.jsx("span",{className:"font-bold",children:ae.totalMovies})]}),d.jsxs("li",{className:"flex justify-between",children:[d.jsx("span",{children:"Watched:"}),d.jsx("span",{className:"font-bold",children:ae.watchedMovies})]}),d.jsxs("li",{className:"flex justify-between",children:[d.jsx("span",{children:"Unwatched:"}),d.jsx("span",{className:"font-bold",children:ae.unwatchedMovies})]}),d.jsxs("li",{className:"flex justify-between",children:[d.jsx("span",{children:"Favorites:"}),d.jsx("span",{className:"font-bold",children:ae.favoriteMovies})]}),d.jsxs("li",{className:"flex justify-between",children:[d.jsx("span",{children:"Average Rating:"}),d.jsxs("span",{className:"font-bold",children:[ae.averageRating.toFixed(1),"/10"]})]})]})]}),d.jsx("div",{className:"divider"}),d.jsxs("div",{className:"mt-6 space-y-3",children:[d.jsxs("button",{className:"btn btn-outline btn-primary w-full",onClick:ee,disabled:F||ae.totalMovies===0,children:[F?d.jsx("span",{className:"loading loading-spinner loading-sm mr-2"}):d.jsx("i",{className:"fas fa-file-export mr-2"}),"Export Movie Data"]}),d.jsxs("div",{className:"flex flex-col gap-2",children:[d.jsx("div",{className:"form-control",children:d.jsxs("label",{className:"cursor-pointer flex items-center justify-between gap-3 text-sm",children:[d.jsx("span",{className:"label-text",children:"Reset achievements"}),d.jsx("input",{type:"checkbox",className:"toggle toggle-warning",checked:P,onChange:B=>U(B.target.checked)})]})}),d.jsxs("button",{className:"btn btn-outline btn-error w-full",onClick:pe,disabled:z||ae.totalMovies===0,children:[z?d.jsx("span",{className:"loading loading-spinner loading-sm mr-2"}):d.jsx("i",{className:"fas fa-redo mr-2"}),"Start New Year Fresh"]})]}),d.jsxs("button",{className:"btn btn-outline btn-error w-full",onClick:Z,children:[d.jsx("i",{className:"fas fa-sign-out-alt mr-2"}),"Sign Out"]})]})]})}),d.jsx("div",{className:"md:col-span-2",children:d.jsxs("div",{className:"bg-xmas-card p-6 rounded-lg shadow-lg",children:[d.jsxs("div",{className:"mb-6",children:[d.jsx("h2",{className:"text-2xl font-bold mb-4",children:"Artwork Settings"}),d.jsxs("div",{className:"mb-6",children:[d.jsx("h3",{className:"text-lg font-bold mb-2",children:"fanart.tv API Key"}),d.jsx("p",{className:"mb-4",children:"If you have a fanart.tv account, you can add your personal API key here to fetch alternative posters for movies in your collection."}),d.jsxs("div",{className:"form-control",children:[d.jsx("label",{className:"label",children:d.jsx("span",{className:"label-text",children:"API Key"})}),d.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 items-stretch",children:[d.jsx("input",{type:_?"text":"password",className:"input input-bordered flex-1 h-12 text-lg",value:p,onChange:B=>v(B.target.value),placeholder:"Enter your fanart.tv API key",style:{letterSpacing:_?"normal":"3px"}}),d.jsx("button",{type:"button",className:"btn btn-ghost w-12",onClick:()=>w(B=>!B),children:d.jsx("i",{className:`fas ${_?"fa-eye-slash":"fa-eye"}`})}),d.jsx("button",{className:"btn btn-primary w-full sm:w-auto",onClick:I,disabled:A,children:A?d.jsx("span",{className:"loading loading-spinner loading-sm"}):d.jsx("i",{className:"fas fa-save"})})]})]})]})]}),n&&d.jsxs(d.Fragment,{children:[d.jsx("h2",{className:"text-2xl font-bold mb-4",children:"Settings"}),d.jsxs("div",{className:"mb-6",children:[d.jsx("h3",{className:"text-lg font-bold mb-2",children:"OMDb API Key"}),d.jsx("p",{className:"mb-4",children:"Your OMDb API key is used to fetch movies and other details from the Open Movie Database."}),d.jsxs("div",{className:"form-control",children:[d.jsx("label",{className:"label",children:d.jsx("span",{className:"label-text",children:"API Key"})}),d.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 items-stretch",children:[d.jsx("input",{type:o?"text":"password",className:"input input-bordered flex-1 h-12 text-lg",value:h,onChange:B=>m(B.target.value),placeholder:"Enter your OMDb API key",style:{letterSpacing:o?"normal":"3px"}}),d.jsx("button",{type:"button",className:"btn btn-ghost w-12",onClick:()=>u(B=>!B),children:d.jsx("i",{className:`fas ${o?"fa-eye-slash":"fa-eye"}`})}),d.jsx("button",{className:"btn btn-primary w-full sm:w-auto",onClick:Q,disabled:A,children:A?d.jsx("span",{className:"loading loading-spinner loading-sm"}):d.jsx("i",{className:"fas fa-save"})})]})]})]}),d.jsxs("div",{className:"mb-6",children:[d.jsx("h3",{className:"text-lg font-bold mb-2",children:"TMDb API Key (Admin posters)"}),d.jsx("p",{className:"mb-4",children:"Used only in the admin poster manager to fetch official posters from The Movie Database using stored tmdbIds."}),d.jsxs("div",{className:"form-control",children:[d.jsx("label",{className:"label",children:d.jsx("span",{className:"label-text",children:"API Key"})}),d.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 items-stretch",children:[d.jsx("input",{type:a?"text":"password",className:"input input-bordered flex-1 h-12 text-lg",value:E,onChange:B=>T(B.target.value),placeholder:"Enter your TMDb API key",style:{letterSpacing:a?"normal":"3px"}}),d.jsx("button",{type:"button",className:"btn btn-ghost w-12",onClick:()=>l(B=>!B),children:d.jsx("i",{className:`fas ${a?"fa-eye-slash":"fa-eye"}`})}),d.jsx("button",{className:"btn btn-primary w-full sm:w-auto",onClick:be,disabled:A,children:A?d.jsx("span",{className:"loading loading-spinner loading-sm"}):d.jsx("i",{className:"fas fa-save"})})]})]})]}),d.jsx("div",{className:"divider"})]}),d.jsxs("div",{className:"mb-6",children:[d.jsx("h3",{className:"text-lg font-bold mb-2",children:"Quick Links"}),d.jsxs("div",{className:"flex flex-wrap gap-2",children:[d.jsxs(gt,{to:"/movies",className:"btn btn-outline btn-sm",children:[d.jsx("i",{className:"fas fa-film mr-2"}),"My Movies"]}),d.jsxs(gt,{to:"/import",className:"btn btn-outline btn-sm",children:[d.jsx("i",{className:"fas fa-file-import mr-2"}),"Add Movies"]}),d.jsxs(gt,{to:"/random",className:"btn btn-outline btn-sm",children:[d.jsx("i",{className:"fas fa-random mr-2"}),"Random Movie Picker"]}),d.jsxs(gt,{to:"/achievements",className:"btn btn-outline btn-sm",children:[d.jsx("i",{className:"fas fa-trophy mr-2"}),"Achievements"]})]})]}),d.jsx(S8,{}),n&&d.jsxs(d.Fragment,{children:[d.jsx("div",{className:"divider"}),d.jsxs("div",{className:"mb-6",children:[d.jsx("h3",{className:"text-lg font-bold mb-2",children:"Admin Tools"}),d.jsxs(gt,{to:"/admin",className:"btn btn-primary btn-sm",children:[d.jsx("i",{className:"fas fa-tools mr-2"}),"Open Admin Dashboard"]})]})]})]})})]})]})},N8=({item:t})=>{const[e,r]=Kf.useState(!1);return d.jsxs("div",{className:"rounded-lg p-4 shadow-lg border transition-transform bg-xmas-card "+(t.unlocked?"border-xmas-gold hover:scale-[1.02]":"border-gray-700 opacity-70"),children:[d.jsxs("div",{className:"flex items-center mb-3",children:[d.jsx("div",{className:"relative mr-3 w-16 h-16 rounded-full overflow-hidden border border-xmas-gold/60 bg-gray-800 flex items-center justify-center",children:e?d.jsx("span",{className:"text-3xl",children:t.icon}):d.jsx("img",{src:`/achievements/${t.id}.png`,alt:t.name,className:"w-full h-full object-cover",loading:"lazy",onError:()=>r(!0)})}),d.jsxs("div",{children:[d.jsxs("h2",{className:"text-lg font-bold flex items-center gap-2",children:[t.name,t.unlocked&&d.jsx("span",{className:"badge badge-success badge-sm",children:"Unlocked"})]}),t.unlocked&&t.unlockedAt&&d.jsxs("p",{className:"text-xs text-xmas-text/70 mt-1",children:["Unlocked on"," ",t.unlockedAt.toLocaleDateString(void 0,{year:"numeric",month:"short",day:"numeric"})]})]})]}),d.jsx("p",{className:"text-sm text-xmas-text mb-3",children:t.unlocked?t.description:t.hint}),!t.unlocked&&d.jsx("p",{className:"text-xs text-xmas-text/60 italic",children:"Locked  keep watching to reveal this badge."})]})},C8=()=>{const{currentUser:t}=An(),[e,r]=q.useState(!0),[n,a]=q.useState([]);return q.useEffect(()=>{(async()=>{if(t)try{r(!0),await h0(t.uid);const o=ur(rt,`users/${t.uid}/achievements`),u=await Er(o),h=new Map;u.forEach(p=>{const v=p.data();let _=null;v.unlockedAt instanceof Date?_=v.unlockedAt:v.unlockedAt&&typeof v.unlockedAt.toDate=="function"&&(_=v.unlockedAt.toDate()),h.set(p.id,{unlockedAt:_,seen:v.seen})});const m=Rc.map(p=>{const v=h.get(p.id);return{id:p.id,name:p.name,description:p.description,hint:p.hint,icon:p.icon,unlocked:!!v,unlockedAt:v?.unlockedAt??null}}).sort((p,v)=>{if(p.unlocked!==v.unlocked)return p.unlocked?-1:1;if(p.unlocked&&v.unlocked){const _=p.unlockedAt?p.unlockedAt.getTime():0,w=v.unlockedAt?v.unlockedAt.getTime():0;if(_!==w)return _-w}return p.name.localeCompare(v.name)});a(m)}finally{r(!1)}})()},[t]),t?e?d.jsx("div",{className:"flex justify-center items-center min-h-[60vh]",children:d.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-xmas-gold"})}):d.jsxs("div",{className:"container mx-auto px-4 py-8",children:[d.jsx("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between mb-6",children:d.jsxs("div",{children:[d.jsx("h1",{className:"font-christmas text-3xl md:text-4xl text-xmas-line mb-2",children:"Achievements"}),d.jsx("p",{className:"text-sm text-xmas-text/80",children:"Unlock festive badges as you watch, rate and explore your Christmas movies."})]})}),d.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-3 gap-6",children:n.map(l=>d.jsx(N8,{item:l},l.id))})]}):d.jsx("div",{className:"flex justify-center items-center min-h-[60vh]",children:d.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-xmas-gold"})})},k8=()=>{const{slug:t}=Y0(),[e,r]=q.useState(null),[n,a]=q.useState([]),[l,o]=q.useState({}),[u,h]=q.useState(null),[m,p]=q.useState(!0),[v,_]=q.useState(null);if(q.useEffect(()=>{(async()=>{if(t)try{p(!0),_(null);const A=ur(rt,"publicProfiles"),M=gs(A,Da("publicWatchlistSlug","==",t),Da("isPublicWatchlist","==",!0)),F=await Er(M);if(F.empty){_("This watchlist isn't public (or no longer exists)."),p(!1);return}const R=F.docs[0],z={id:R.id,...R.data()};r(z);const re=z.userId,{userMovies:te,movies:b}=await uh(re),N=b.filter(U=>{const Ce=te[U.id];return Ce&&Ce.watched}).sort((U,Ce)=>{const Ne=te[U.id],ae=te[Ce.id],ue=Ne?.rating??0,pe=ae?.rating??0;return pe!==ue?pe-ue:U.title.localeCompare(Ce.title)}),k={};N.forEach(U=>{k[U.id]=te[U.id]});const j=N.map(U=>k[U.id]).filter(U=>U&&U.rating!=null),L=j.length>0?j.reduce((U,Ce)=>U+(Ce.rating||0),0)/j.length:0,P=N.filter(U=>k[U.id]?.favorite).length;a(N),o(k),h({totalWatched:N.length,averageRating:L,favoriteMovies:P})}catch(A){console.error("Error loading public watchlist:",A),_("This watchlist isn't public (or no longer exists).")}finally{p(!1)}})()},[t]),q.useEffect(()=>{if(!(typeof document>"u"))if(e){const T=e.publicWatchlistName||`${e.displayName}'s Xmas Watchlist`;document.title=`${T}  Christmas Movies`}else document.title="Christmas Movies"},[e]),m)return d.jsx("div",{className:"flex justify-center items-center min-h-[60vh]",children:d.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-xmas-gold"})});if(v||!e)return d.jsx("div",{className:"container mx-auto px-4 py-16",children:d.jsxs("div",{className:"bg-xmas-card p-8 rounded-lg text-center max-w-xl mx-auto",children:[d.jsx("h1",{className:"font-christmas text-3xl text-xmas-line mb-4",children:"Watchlist Not Available"}),d.jsx("p",{className:"mb-4",children:v||"This watchlist isn't public (or no longer exists)."}),d.jsxs(gt,{to:"/",className:"btn btn-primary",children:[d.jsx("i",{className:"fas fa-home mr-2"}),"Go to Home"]})]})});const w=e.publicWatchlistName||`${e.displayName}'s Xmas Watchlist`,E=e.publicWatchlistTagline;return d.jsxs("div",{className:"container mx-auto px-2 sm:px-4 py-6 sm:py-10",children:[d.jsxs("header",{className:"mb-6 sm:mb-8 flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[d.jsxs("div",{className:"flex items-center gap-4",children:[e.photoURL?d.jsx("img",{src:e.photoURL,alt:e.displayName,className:"w-16 h-16 sm:w-20 sm:h-20 rounded-full border-2 border-xmas-gold shadow-lg"}):d.jsx("div",{className:"w-16 h-16 sm:w-20 sm:h-20 rounded-full bg-gray-700 flex items-center justify-center border-2 border-xmas-gold shadow-lg",children:d.jsx("i",{className:"fas fa-user text-2xl text-gray-300"})}),d.jsxs("div",{children:[d.jsx("h1",{className:"font-christmas text-2xl sm:text-3xl md:text-4xl text-xmas-line mb-1",children:w}),E&&d.jsx("p",{className:"text-sm sm:text-base text-xmas-mute",children:E})]})]}),u&&d.jsxs("div",{className:"bg-xmas-card px-4 py-3 rounded-lg shadow-md flex flex-wrap gap-4 text-sm sm:text-base",children:[d.jsxs("div",{children:[d.jsx("div",{className:"text-xs uppercase tracking-wide text-xmas-mute",children:"Watched"}),d.jsx("div",{className:"font-bold text-lg",children:u.totalWatched})]}),d.jsxs("div",{children:[d.jsx("div",{className:"text-xs uppercase tracking-wide text-xmas-mute",children:"Average Rating"}),d.jsxs("div",{className:"font-bold text-lg",children:[u.averageRating.toFixed(1),"/10"]})]}),d.jsxs("div",{children:[d.jsx("div",{className:"text-xs uppercase tracking-wide text-xmas-mute",children:"Favorites"}),d.jsx("div",{className:"font-bold text-lg",children:u.favoriteMovies})]})]})]}),n.length===0?d.jsxs("div",{className:"bg-xmas-card p-8 rounded-lg text-center max-w-xl mx-auto",children:[d.jsx("h2",{className:"text-xl mb-3",children:"No watched movies yet"}),d.jsx("p",{className:"text-sm text-xmas-mute",children:"As soon as they start marking movies as watched, they'll show up here."})]}):d.jsx("div",{className:"grid grid-cols-3 sm:grid-cols-4 md:grid-cols-5 lg:grid-cols-6 gap-2 sm:gap-3",children:n.map(T=>{const A=l[T.id],M=T.posterUrl,F=xN(M||"","w185");return d.jsx(gt,{to:`/u/${t}/m/${mN(T.title)}?id=${T.id}`,className:"block transition-transform hover:scale-[1.02] hover:shadow-xl",children:d.jsxs("div",{className:"relative rounded-lg overflow-hidden bg-xmas-card shadow-md h-full flex flex-col",children:[d.jsxs("div",{className:"relative",children:[M?d.jsx("img",{src:F,alt:T.title,className:"w-full h-auto object-cover",style:{aspectRatio:"2/3"},loading:"lazy"}):d.jsx("div",{className:"w-full flex items-center justify-center bg-gray-800",style:{aspectRatio:"2/3"},children:d.jsx("i",{className:"fas fa-film text-2xl text-gray-500"})}),A&&A.watched&&d.jsx("div",{className:"absolute top-1 right-1 bg-primary rounded-full p-1 shadow-md",children:d.jsx("i",{className:"fas fa-check text-xs text-white"})}),A&&A.favorite&&d.jsx("div",{className:"absolute top-1 left-1 text-yellow-400 drop-shadow-md",children:d.jsx("i",{className:"fas fa-star text-sm"})})]}),d.jsxs("div",{className:"p-1 sm:p-2 flex-grow flex flex-col",children:[d.jsx("h3",{className:"text-xs sm:text-sm font-medium line-clamp-2",children:T.title}),d.jsxs("div",{className:"flex justify-between items-center mt-1",children:[d.jsx("p",{className:"text-xs text-gray-400",children:T.releaseDate&&Qa(T.releaseDate)}),A&&A.rating!=null&&d.jsxs("div",{className:"flex items-center",children:[d.jsx("span",{className:"text-yellow-400 mr-0.5",children:d.jsx("i",{className:"fas fa-star text-xs"})}),d.jsx("span",{className:"text-xs",children:A.rating})]})]})]})]})},T.id)})})]})},c1="https://api.watchmode.com/v1",iE=["GB","US","CA"],lE="GB",R8=1440*60*1e3,u1="jg4HbDMFz2bE6i1YPoqDMFqo5Rmh6AEqP9mqqQdO";let Kg=null;async function f1(t){const e=await fetch(t);if(!e.ok)throw new Error(`Watchmode API error ${e.status}`);return await e.json()}async function D8(t){try{const e=t.releaseDate?new Date(t.releaseDate).getFullYear():void 0,r=new URLSearchParams({apiKey:u1,search_field:"name",search_value:t.title}),n=`${c1}/search/?${r.toString()}`,a=await f1(n);if(!a.title_results?.length)return null;if(e){const l=a.title_results.find(o=>o.year===e);if(l)return l.id}return a.title_results[0].id}catch(e){return console.error("Watchmode name search failed",e),null}}async function I8(t){const e=new URLSearchParams({apiKey:u1,regions:iE.join(",")}),r=`${c1}/title/${t}/sources/?${e.toString()}`,n=await f1(r),a=new Set(iE.map(l=>l.toUpperCase()));return n.filter(l=>a.has((l.region||"").toUpperCase())&&!!l.name)}async function O8(){if(Kg)return Kg;try{const t=`${c1}/sources/?apiKey=${u1}`,e=await f1(t),r={};for(const n of e)r[n.id]=n;return Kg=r,r}catch(t){return console.error("Failed to load Watchmode source metadata",t),null}}async function M8(t){if(!t?.id)return null;const e=Pt(ur(rt,"watchmodeSources"),t.id);try{const u=await Zn(e);if(u.exists()){const h=u.data(),m=h.updatedAt?.toDate?h.updatedAt.toDate():new Date(h.updatedAt),p=Date.now()-m.getTime()<R8,v=Array.isArray(h.sources)&&h.sources.length>0;if(p&&v)return{movieId:t.id,region:h.region||lE,watchmodeTitleId:h.watchmodeTitleId??void 0,sources:h.sources||[],updatedAt:m,errorCode:h.errorCode??null}}}catch(u){console.error("Error reading Watchmode cache",u)}const r=await D8(t);let n=[],a=null;if(r)try{n=await I8(r)}catch(u){console.error("Error fetching Watchmode sources",u),a="sources_fetch_failed"}else a="title_not_found";const l=n.map(({ios_url:u,android_url:h,...m})=>m),o={movieId:t.id,region:lE,watchmodeTitleId:r||null,sources:l,updatedAt:new Date,errorCode:a};try{await Ia(e,o,{merge:!0})}catch(u){console.error("Error updating Watchmode cache",u)}return{movieId:o.movieId,region:o.region,watchmodeTitleId:r||void 0,sources:l,updatedAt:o.updatedAt,errorCode:a}}function j8(t){const[e,r]=q.useState({loading:!1,error:null,data:null});return q.useEffect(()=>{let n=!1;return(async()=>{if(!t){r({loading:!1,error:null,data:null});return}r(l=>({...l,loading:!0,error:null}));try{const l=await M8(t);if(n)return;r({loading:!1,error:null,data:l})}catch(l){if(console.error("useWatchmodeSources error",l),n)return;r({loading:!1,error:"Failed to load streaming info",data:null})}})(),()=>{n=!0}},[t?.id]),e}const F8=({movie:t})=>{const{loading:e,error:r,data:n}=j8(t),[a,l]=q.useState(null),[o,u]=q.useState(!1);if(q.useEffect(()=>{let w=!1;return(async()=>{const T=await O8();w||l(T)})(),()=>{w=!0}},[]),!t)return null;if(e&&!n)return d.jsx("div",{className:"mt-6 text-sm text-xmas-mute",children:"Looking up where to watch"});if(r)return null;const h=n?.sources||[],m=["GB","US","CA"],p={};for(const w of h){const E=(w.region||"").toUpperCase();p[E]||(p[E]=[]),p[E].push(w)}const v=w=>{const E=new Map;for(const T of w)E.has(T.name)||E.set(T.name,T);return Array.from(E.values())},_=()=>d.jsx("div",{className:"grid gap-4 sm:gap-5 md:grid-cols-3",children:m.map(w=>{const E=p[w];if(!E||!E.length)return null;const T=E.filter(R=>R.type==="sub"||R.type==="subscription"),A=E.filter(R=>R.type==="buy"||R.type==="rent"||R.type==="purchase"||R.type==="buy/rent"),M=E.filter(R=>R.type==="free");if(!T.length&&!A.length&&!M.length)return null;const F=w==="GB"?"UK":w;return d.jsxs("div",{className:"bg-black/10 rounded-md p-3 sm:p-4 flex flex-col gap-3",children:[d.jsx("h3",{className:"text-sm font-semibold mb-1",children:F}),M.length>0&&d.jsxs("div",{children:[d.jsx("div",{className:"text-xs uppercase tracking-wide text-xmas-mute mb-1",children:"Free"}),d.jsx("div",{className:"flex flex-wrap gap-3",children:v(M).map(R=>{const z=a?a[R.source_id]:void 0;return z?.logo_100px?d.jsx("a",{href:R.web_url||void 0,target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center justify-center rounded-lg overflow-hidden bg-white/5 hover:bg-white/10 transition-colors",children:d.jsx("img",{src:z.logo_100px,alt:R.name,className:"h-10 w-10 sm:h-12 sm:w-12 object-contain",loading:"lazy"})},R.name+R.web_url):null})})]}),T.length>0&&d.jsxs("div",{children:[d.jsx("div",{className:"text-xs uppercase tracking-wide text-xmas-mute mb-1",children:"Streaming"}),d.jsx("div",{className:"flex flex-wrap gap-3",children:v(T).map(R=>{const z=a?a[R.source_id]:void 0;return z?.logo_100px?d.jsx("a",{href:R.web_url||void 0,target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center justify-center rounded-lg overflow-hidden bg-white/5 hover:bg-white/10 transition-colors",children:d.jsx("img",{src:z.logo_100px,alt:R.name,className:"h-10 w-10 sm:h-12 sm:w-12 object-contain",loading:"lazy"})},R.name+R.web_url):null})})]}),A.length>0&&d.jsxs("div",{children:[d.jsx("div",{className:"text-xs uppercase tracking-wide text-xmas-mute mb-1",children:"Buy / Rent"}),d.jsx("div",{className:"flex flex-wrap gap-3",children:v(A).map(R=>{const z=a?a[R.source_id]:void 0;return z?.logo_100px?d.jsx("a",{href:R.web_url||void 0,target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center justify-center rounded-lg overflow-hidden bg-white/5 hover:bg-white/10 transition-colors",children:d.jsx("img",{src:z.logo_100px,alt:R.name,className:"h-10 w-10 sm:h-12 sm:w-12 object-contain",loading:"lazy"})},R.name+R.web_url):null})})]})]},w)})});return h.length?d.jsxs("div",{className:"mt-6",children:[d.jsx("div",{className:"divider"}),d.jsxs("div",{className:"bg-xmas-card/40 border border-xmas-gold/40 rounded-lg overflow-hidden",children:[d.jsxs("button",{type:"button",className:"w-full flex items-center justify-between text-left px-4 py-3 sm:px-5 sm:py-4 bg-xmas-card/60 hover:bg-xmas-card transition-colors cursor-pointer",onClick:()=>u(w=>!w),children:[d.jsxs("div",{className:"flex items-center gap-3",children:[d.jsx("i",{className:"fas fa-tv text-xmas-gold"}),d.jsx("h2",{className:"text-lg sm:text-xl font-bold flex-1",children:"Where to watch"})]}),d.jsx("span",{className:`ml-3 text-sm text-xmas-mute transition-transform duration-200 ${o?"rotate-180":"rotate-0"}`,children:d.jsx("i",{className:"fas fa-chevron-down"})})]}),o&&d.jsxs("div",{className:"px-4 py-3 sm:px-5 sm:py-5",children:[d.jsx("p",{className:"text-xs text-xmas-mute mb-4",children:"Powered by Watchmode. Availability can change, so please double-check on the provider's site."}),_()]})]})]}):d.jsxs("div",{className:"mt-6",children:[d.jsx("div",{className:"divider"}),d.jsxs("div",{className:"bg-xmas-card/40 border border-xmas-gold/40 rounded-lg overflow-hidden",children:[d.jsxs("button",{type:"button",className:"w-full flex items-center justify-between text-left px-4 py-3 sm:px-5 sm:py-4 bg-xmas-card/60 hover:bg-xmas-card transition-colors cursor-pointer",onClick:()=>u(w=>!w),children:[d.jsxs("div",{className:"flex items-center gap-3",children:[d.jsx("i",{className:"fas fa-tv text-xmas-gold"}),d.jsx("h2",{className:"text-lg sm:text-xl font-bold flex-1",children:"Where to watch"})]}),d.jsx("span",{className:`ml-3 text-sm text-xmas-mute transition-transform duration-200 ${o?"rotate-180":"rotate-0"}`,children:d.jsx("i",{className:"fas fa-chevron-down"})})]}),o&&d.jsxs("div",{className:"px-4 py-3 sm:px-5 sm:py-5 text-xs text-xmas-mute",children:[d.jsx("p",{className:"mb-2",children:"Powered by Watchmode. Availability can change, so please double-check on the provider's site."}),d.jsx("p",{children:"We couldn't find any current streaming options via Watchmode for this title."})]})]})]})},P8=()=>{const{slug:t}=Y0(),[e]=ND(),r=Ma(),[n,a]=q.useState(null),[l,o]=q.useState(null),[u,h]=q.useState(null),[m,p]=q.useState(!0),[v,_]=q.useState(null);if(q.useEffect(()=>{(async()=>{const A=e.get("id");if(!(!t||!A))try{p(!0),_(null);const M=ur(rt,"publicProfiles"),F=gs(M,Da("publicWatchlistSlug","==",t),Da("isPublicWatchlist","==",!0)),R=await Er(F);if(R.empty){_("This watchlist isn't public (or no longer exists)."),p(!1);return}const z=R.docs[0],re={id:z.id,...z.data()};a(re);const te=re.userId,b=Pt(rt,"movies",A),N=await Zn(b);if(!N.exists()){_("Movie not found"),p(!1);return}const k={id:N.id,...N.data()};o(k);const j=Pt(rt,"users",te,"movies",A),L=await Zn(j);L.exists()?h({id:L.id,...L.data()}):h(null)}catch(M){console.error("Error loading public movie",M),_("Failed to load this movie.")}finally{p(!1)}})()},[t,e]),q.useEffect(()=>{if(!(typeof document>"u"))if(l&&n){const T=n.publicWatchlistName||`${n.displayName}'s Xmas Watchlist`;document.title=`${l.title}  ${T}`}else document.title="Christmas Movies"},[l,n]),m)return d.jsx("div",{className:"flex justify-center items-center min-h-[60vh]",children:d.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-xmas-gold"})});if(v||!n||!l)return d.jsx("div",{className:"container mx-auto px-4 py-16",children:d.jsxs("div",{className:"bg-xmas-card p-8 rounded-lg text-center max-w-xl mx-auto",children:[d.jsx("h1",{className:"font-christmas text-3xl text-xmas-line mb-4",children:"Movie Not Available"}),d.jsx("p",{className:"mb-4",children:v||"This movie could not be found for this watchlist."}),t&&d.jsxs("button",{className:"btn btn-primary",onClick:()=>r(`/u/${t}`),children:[d.jsx("i",{className:"fas fa-arrow-left mr-2"}),"Back to Watchlist"]})]})});const w=n.publicWatchlistName||`${n.displayName}'s Xmas Watchlist`,E=u?.watched?"Watched":"Not watched yet";return d.jsxs("div",{className:"container mx-auto px-2 sm:px-4 py-6 sm:py-10",children:[d.jsx("div",{className:"mb-4 flex flex-wrap justify-between items-center gap-2",children:d.jsxs("div",{className:"flex items-center gap-3",children:[n.photoURL?d.jsx("img",{src:n.photoURL,alt:n.displayName,className:"w-10 h-10 rounded-full border border-xmas-gold"}):d.jsx("div",{className:"w-10 h-10 rounded-full bg-gray-700 flex items-center justify-center border border-xmas-gold",children:d.jsx("i",{className:"fas fa-user text-sm text-gray-300"})}),d.jsxs("div",{className:"text-sm",children:[d.jsx("div",{className:"font-semibold mb-1",children:w}),d.jsxs("button",{className:"btn btn-primary btn-sm px-4 py-2 rounded-md shadow-lg hover:shadow-xl transition-all duration-300 border border-xmas-gold border-opacity-30 flex items-center gap-2",onClick:()=>r(`/u/${t}`),children:[d.jsx("i",{className:"fas fa-arrow-left"}),d.jsx("span",{children:"Back to watchlist"})]})]})]})}),d.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-8",children:[d.jsxs("div",{className:"md:col-span-1",children:[d.jsx("div",{className:"rounded-lg overflow-hidden shadow-xl",children:l.posterUrl?d.jsx("img",{src:l.posterUrl,alt:l.title,className:"w-full object-contain",style:{aspectRatio:"2/3"}}):d.jsx("div",{className:"w-full flex items-center justify-center bg-gray-800",style:{aspectRatio:"2/3"},children:d.jsx("i",{className:"fas fa-film text-6xl text-gray-500"})})}),u&&d.jsxs("div",{className:"mt-4 space-y-2 text-sm",children:[d.jsxs("div",{className:"flex items-center justify-between",children:[d.jsx("span",{className:"text-xs uppercase tracking-wide text-xmas-mute",children:"Status"}),d.jsx("span",{className:"font-semibold",children:E})]}),u.rating!=null&&d.jsxs("div",{className:"flex items-center justify-between",children:[d.jsx("span",{className:"text-xs uppercase tracking-wide text-xmas-mute",children:"Rating"}),d.jsxs("div",{className:"flex items-center gap-1",children:[d.jsx("span",{className:"text-yellow-400",children:d.jsx("i",{className:"fas fa-star"})}),d.jsxs("span",{className:"font-semibold",children:[u.rating,"/10"]})]})]}),u.watchedDate&&d.jsxs("div",{className:"flex items-center justify-between",children:[d.jsx("span",{className:"text-xs uppercase tracking-wide text-xmas-mute",children:"Watched on"}),d.jsx("span",{className:"font-semibold",children:(()=>{const T=u.watchedDate?.toDate?u.watchedDate.toDate():new Date(u.watchedDate);return isNaN(T.getTime())?"":T.toLocaleDateString()})()})]}),u.vibeTags&&u.vibeTags.length>0&&d.jsxs("div",{children:[d.jsx("div",{className:"text-xs uppercase tracking-wide text-xmas-mute mb-1",children:"Vibe review"}),d.jsx("div",{className:"flex flex-wrap gap-1.5",children:u.vibeTags.map(T=>d.jsx("span",{className:"badge badge-sm bg-xmas-gold bg-opacity-20 text-[0.7rem] border-xmas-gold",children:T},T))})]})]})]}),d.jsxs("div",{className:"md:col-span-2",children:[d.jsx("h1",{className:"font-christmas text-3xl md:text-4xl text-xmas-line mb-2",children:l.title}),l.releaseDate&&d.jsx("p",{className:"text-lg text-gray-400 mb-4",children:new Date(l.releaseDate).getFullYear()}),l.genres&&l.genres.length>0&&d.jsx("div",{className:"flex flex-wrap gap-2 mb-4",children:l.genres.map(T=>d.jsx("span",{className:"badge badge-outline",children:T},T))}),l.runtime&&d.jsxs("p",{className:"mb-4",children:[d.jsx("i",{className:"fas fa-clock mr-2 text-xmas-gold"}),Math.floor(l.runtime/60),"h ",l.runtime%60,"m"]}),l.overview&&d.jsxs("div",{className:"mb-6",children:[d.jsx("h2",{className:"text-xl font-bold mb-2",children:"Overview"}),d.jsx("p",{className:"text-gray-300",children:l.overview})]}),l.directors&&l.directors.length>0&&d.jsxs("div",{className:"mb-4",children:[d.jsxs("h2",{className:"text-xl font-bold mb-2",children:["Director",l.directors.length>1?"s":""]}),d.jsx("p",{children:l.directors.join(", ")})]}),l.cast&&l.cast.length>0&&d.jsxs("div",{className:"mb-6",children:[d.jsx("h2",{className:"text-xl font-bold mb-2",children:"Cast"}),d.jsx("p",{className:"flex flex-wrap gap-1",children:l.cast.slice(0,10).map((T,A)=>d.jsxs(Kf.Fragment,{children:[d.jsx("span",{children:T}),A<Math.min(l.cast.length,10)-1&&d.jsx("span",{children:","})]},T))})]}),u&&u.review&&d.jsxs("div",{className:"mt-6",children:[d.jsx("div",{className:"divider"}),d.jsx("h2",{className:"text-xl font-bold mb-2",children:"Their Thoughts"}),d.jsx("p",{className:"whitespace-pre-line text-gray-200 text-sm sm:text-base",children:u.review})]}),d.jsx(F8,{movie:l})]})]})]})},L8=10080*60*1e3,U8=async(t,e,r)=>{if(e.fanartPosters&&e.fanartPosters.length>0&&e.lastFanartFetchAt){const a=e.lastFanartFetchAt instanceof Date?e.lastFanartFetchAt:new Date(e.lastFanartFetchAt.seconds*1e3);if(Date.now()-a.getTime()<L8)return e.fanartPosters.map(l=>({url:l}))}const n=!!e.imdbId||e.tmdbId!=null;if(!r||!n)return(e.fanartPosters||[]).map(a=>({url:a}));try{const a=FP(BP,"fanartProxy"),l=e.tmdbId,o=typeof l=="number"?l:typeof l=="string"&&l.trim()?Number(l):void 0,u=await a({imdbId:e.imdbId,tmdbId:o,apiKey:r}),h=Array.isArray(u.data.posters)?u.data.posters:[],m=Array.from(new Set(h.filter(p=>typeof p=="string"&&p)));try{const p=Pt(rt,"movies",t);await ea(p,{fanartPosters:m,lastFanartFetchAt:new Date})}catch(p){console.error("Failed to cache fanart posters on movie doc",p)}return m.map(p=>({url:p}))}catch(a){return console.error("fanartProxy callable failed",a),(e.fanartPosters||[]).map(l=>({url:l}))}},B8=()=>{const{movieId:t}=Y0(),e=ys(),r=Ma(),{currentUser:n,userProfile:a}=An(),l=pN(e.search),[o,u]=q.useState(null),[h,m]=q.useState(null),[p,v]=q.useState(""),[_,w]=q.useState([]),[E,T]=q.useState(!0),[A,M]=q.useState(!1),[F,R]=q.useState(null);q.useEffect(()=>{if(!n||!l)return;(async()=>{try{T(!0);const te=await Zn(Pt(rt,"movies",l));if(!te.exists()){R("Movie not found"),T(!1);return}const b={id:te.id,...te.data()};u(b);const N=await gN(n.uid,l);if(N?(m(N),v(N.posterUrlOverride||b.posterUrl||"")):v(b.posterUrl||""),(b.imdbId||b.tmdbId)&&a?.fanartApiKey)try{const k=await U8(l,b,a.fanartApiKey);w(k)}catch(k){console.error("Error loading fanart posters:",k)}}catch(te){console.error("Error loading movie/poster data:",te),R("Failed to load movie data")}finally{T(!1)}})()},[n,l,a]);const z=async()=>{if(!(!n||!l||!o))try{M(!0),R(null);const re={userId:n.uid,movieId:l,posterUrlOverride:p.trim()||null},te=await wm(n.uid,l,re);m(te),r(`/movies/${t}${e.search}`)}catch(re){console.error("Failed to save poster override:",re),R(re?.message||"Failed to save poster")}finally{M(!1)}};return E?d.jsx("div",{className:"flex justify-center items-center min-h-[60vh]",children:d.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-xmas-gold"})}):o?d.jsxs("div",{className:"container mx-auto px-4 py-8",children:[d.jsxs("div",{className:"mb-4 flex items-center gap-2",children:[d.jsxs(gt,{to:`/movies/${t}${e.search}`,className:"btn btn-primary btn-sm",children:[d.jsx("i",{className:"fas fa-arrow-left mr-2"}),"Back to Movie"]}),d.jsxs("h1",{className:"font-christmas text-2xl md:text-3xl text-xmas-line ml-2",children:["Edit Poster 	for ",o.title]})]}),F&&d.jsxs("div",{className:"alert alert-error mb-4",children:[d.jsx("i",{className:"fas fa-exclamation-circle mr-2"}),d.jsx("span",{children:F})]}),d.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-8",children:[d.jsx("div",{children:d.jsx("div",{className:"rounded-lg overflow-hidden shadow-xl",children:p?d.jsx("img",{src:p,alt:o.title,className:"w-full object-contain",style:{aspectRatio:"2/3"}}):d.jsx("div",{className:"w-full flex items-center justify-center bg-gray-800",style:{aspectRatio:"2/3"},children:d.jsx("i",{className:"fas fa-film text-6xl text-gray-500"})})})}),d.jsx("div",{className:"md:col-span-2",children:d.jsxs("div",{className:"bg-xmas-card p-6 rounded-lg shadow-lg space-y-4",children:[d.jsx("h2",{className:"text-xl font-bold mb-2",children:"Choose a Poster from fanart.tv"}),!a?.fanartApiKey&&d.jsx("p",{className:"text-sm text-warning mb-2",children:"Add your fanart.tv API key on your Profile page to see alternative posters."}),a?.fanartApiKey&&_.length===0&&d.jsx("p",{className:"text-sm text-gray-300 mb-2",children:"No posters were returned from fanart.tv for this movie. The default poster will be used."}),_.length>0&&d.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-4 gap-4",children:_.map(re=>d.jsxs("button",{type:"button",className:`relative rounded-lg overflow-hidden border-2 transition-transform hover:scale-105 ${p===re.url?"border-primary":"border-transparent"}`,onClick:()=>v(re.url),children:[d.jsx("img",{src:re.url,alt:o.title,className:"w-full h-full object-cover",style:{aspectRatio:"2/3"}}),p===re.url&&d.jsx("div",{className:"absolute inset-0 bg-black bg-opacity-30 flex items-center justify-center",children:d.jsx("i",{className:"fas fa-check text-2xl text-primary-content"})})]},re.url))}),d.jsxs("div",{className:"flex gap-2 mt-4",children:[d.jsxs("button",{className:"btn btn-primary",onClick:z,disabled:A||!p,children:[A?d.jsx("span",{className:"loading loading-spinner loading-sm mr-2"}):d.jsx("i",{className:"fas fa-save mr-2"}),"Save Poster"]}),d.jsx("button",{className:"btn btn-outline",type:"button",onClick:()=>v(o.posterUrl||""),children:"Reset to default"})]})]})})]})]}):d.jsxs("div",{className:"container mx-auto px-4 py-8",children:[d.jsx("div",{className:"alert alert-error mb-4",children:d.jsx("span",{children:"Movie not found"})}),d.jsxs(gt,{to:"/movies",className:"btn btn-primary btn-sm",children:[d.jsx("i",{className:"fas fa-arrow-left mr-2"}),"Back to Movies"]})]})},V8=()=>{const t=Ma(),{isAdmin:e,loading:r,currentUser:n}=Qc(),[a,l]=q.useState(!1),[o,u]=q.useState(null),h=!1;q.useEffect(()=>{e&&!r&&t("/admin")},[e,r,t]);const m=async()=>{u(null),l(!0);try{await wS(pf,LP)}catch(p){console.error("Login error:",p),p.code==="auth/popup-closed-by-user"?u("Sign-in popup was closed. Please try again."):p.code==="auth/cancelled-popup-request"?u("Another popup is already open. Please try again."):p.code==="auth/unauthorized-domain"?(console.error("Unauthorized domain error:",window.location.hostname),u("This domain is not authorized for OAuth operations. Please add "+window.location.hostname+" to your Firebase authorized domains list in the Firebase console under Authentication > Sign-in method > Authorized domains.")):u("Failed to sign in. Please try again."),l(!1)}};return r?d.jsx("div",{className:"flex justify-center items-center min-h-[60vh]",children:d.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-xmas-gold"})}):d.jsx("div",{className:"container mx-auto px-4 py-12",children:d.jsxs("div",{className:"max-w-md mx-auto",children:[d.jsxs("div",{className:"text-center mb-8",children:[d.jsx("h1",{className:"font-christmas text-4xl text-xmas-line mb-2",children:"Admin Login"}),d.jsx("p",{className:"text-xmas-mute",children:"Sign in to manage the Christmas Quiz"})]}),d.jsxs("div",{className:"bg-xmas-card rounded-lg shadow-lg p-6",children:[h,n&&d.jsxs("div",{className:"bg-info bg-opacity-10 border-l-4 border-info p-4 mb-6 rounded",children:[d.jsx("p",{className:"text-info font-bold mb-2",children:"User Authenticated"}),d.jsxs("p",{className:"text-info text-sm mb-1",children:["Email: ",n.email]}),d.jsxs("p",{className:"text-info text-sm mb-2",children:["UID: ",n.uid]}),d.jsxs("p",{className:"text-info text-sm",children:["To grant admin access, create a document in the ",d.jsx("code",{className:"bg-base-300 px-1 py-0.5 rounded",children:"admins"})," collection with this UID as the document ID."]}),h]}),o&&d.jsx("div",{className:"bg-error bg-opacity-10 border-l-4 border-error p-4 mb-6 rounded",children:d.jsx("p",{className:"text-error",children:o})}),d.jsxs("div",{className:"text-center mb-6",children:[d.jsx("p",{className:"mb-4",children:"Sign in with your Google account to access the admin panel."}),d.jsx("p",{className:"text-sm text-xmas-mute mb-6",children:"Only authorized administrators will be granted access."}),d.jsx("button",{onClick:m,className:"btn btn-primary w-full flex items-center justify-center gap-2",disabled:a,children:a?d.jsxs(d.Fragment,{children:[d.jsx("span",{className:"loading loading-spinner loading-sm"}),"Signing in..."]}):d.jsxs(d.Fragment,{children:[d.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 48 48",children:[d.jsx("path",{fill:"#FFC107",d:`M43.611,20.083H42V20H24v8h11.303c-1.649,4.657-6.08,8-11.303,8c-6.627,0-12-5.373-12-12\r
                      s5.373-12,12-12c3.059,0,5.842,1.154,7.961,3.039l5.657-5.657C34.046,6.053,29.268,4,24,4C12.955,4,4,12.955,4,24s8.955,20,20,20\r
                      s20-8.955,20-20C44,22.659,43.862,21.35,43.611,20.083z`}),d.jsx("path",{fill:"#FF3D00",d:`M6.306,14.691l6.571,4.819C14.655,15.108,18.961,12,24,12c3.059,0,5.842,1.154,7.961,3.039\r
                      l5.657-5.657C34.046,6.053,29.268,4,24,4C16.318,4,9.656,8.337,6.306,14.691z`}),d.jsx("path",{fill:"#4CAF50",d:`M24,44c5.166,0,9.86-1.977,13.409-5.192l-6.19-5.238C29.211,35.091,26.715,36,24,36\r
                      c-5.202,0-9.619-3.317-11.283-7.946l-6.522,5.025C9.505,39.556,16.227,44,24,44z`}),d.jsx("path",{fill:"#1976D2",d:`M43.611,20.083H42V20H24v8h11.303c-0.792,2.237-2.231,4.166-4.087,5.571\r
                      c0.001-0.001,0.002-0.001,0.003-0.002l6.19,5.238C36.971,39.205,44,34,44,24C44,22.659,43.862,21.35,43.611,20.083z`})]}),"Sign in with Google"]})})]})]}),d.jsx("div",{className:"text-center mt-6",children:d.jsx("button",{onClick:()=>t("/"),className:"btn btn-link text-xmas-mute",children:"Back to Home"})})]})})};var yN=1252,z8=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],h1={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},d1=function(t){z8.indexOf(t)!=-1&&(yN=h1[0]=t)};function H8(){d1(1252)}var ds=function(t){d1(t)};function _N(){ds(1200),H8()}function oE(t){for(var e=[],r=0,n=t.length;r<n;++r)e[r]=t.charCodeAt(r);return e}function G8(t){for(var e=[],r=0;r<t.length>>1;++r)e[r]=String.fromCharCode(t.charCodeAt(2*r)+(t.charCodeAt(2*r+1)<<8));return e.join("")}function wN(t){for(var e=[],r=0;r<t.length>>1;++r)e[r]=String.fromCharCode(t.charCodeAt(2*r+1)+(t.charCodeAt(2*r)<<8));return e.join("")}var af=function(t){var e=t.charCodeAt(0),r=t.charCodeAt(1);return e==255&&r==254?G8(t.slice(2)):e==254&&r==255?wN(t.slice(2)):e==65279?t.slice(1):t},Kd=function(e){return String.fromCharCode(e)},cE=function(e){return String.fromCharCode(e)},Lf,gl="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function uE(t){for(var e="",r=0,n=0,a=0,l=0,o=0,u=0,h=0,m=0;m<t.length;)r=t.charCodeAt(m++),l=r>>2,n=t.charCodeAt(m++),o=(r&3)<<4|n>>4,a=t.charCodeAt(m++),u=(n&15)<<2|a>>6,h=a&63,isNaN(n)?u=h=64:isNaN(a)&&(h=64),e+=gl.charAt(l)+gl.charAt(o)+gl.charAt(u)+gl.charAt(h);return e}function Oa(t){var e="",r=0,n=0,a=0,l=0,o=0,u=0,h=0;t=t.replace(/[^\w\+\/\=]/g,"");for(var m=0;m<t.length;)l=gl.indexOf(t.charAt(m++)),o=gl.indexOf(t.charAt(m++)),r=l<<2|o>>4,e+=String.fromCharCode(r),u=gl.indexOf(t.charAt(m++)),n=(o&15)<<4|u>>2,u!==64&&(e+=String.fromCharCode(n)),h=gl.indexOf(t.charAt(m++)),a=(u&3)<<6|h,h!==64&&(e+=String.fromCharCode(a));return e}var Ft=(function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node})(),ko=(function(){if(typeof Buffer<"u"){var t=!Buffer.from;if(!t)try{Buffer.from("foo","utf8")}catch{t=!0}return t?function(e,r){return r?new Buffer(e,r):new Buffer(e)}:Buffer.from.bind(Buffer)}return function(){}})();function Al(t){return Ft?Buffer.alloc?Buffer.alloc(t):new Buffer(t):typeof Uint8Array<"u"?new Uint8Array(t):new Array(t)}function fE(t){return Ft?Buffer.allocUnsafe?Buffer.allocUnsafe(t):new Buffer(t):typeof Uint8Array<"u"?new Uint8Array(t):new Array(t)}var hs=function(e){return Ft?ko(e,"binary"):e.split("").map(function(r){return r.charCodeAt(0)&255})};function Ro(t){if(Array.isArray(t))return t.map(function(n){return String.fromCharCode(n)}).join("");for(var e=[],r=0;r<t.length;++r)e[r]=String.fromCharCode(t[r]);return e.join("")}function m1(t){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(t instanceof ArrayBuffer)return m1(new Uint8Array(t));for(var e=new Array(t.length),r=0;r<t.length;++r)e[r]=t[r];return e}var dl=Ft?function(t){return Buffer.concat(t.map(function(e){return Buffer.isBuffer(e)?e:ko(e)}))}:function(t){if(typeof Uint8Array<"u"){var e=0,r=0;for(e=0;e<t.length;++e)r+=t[e].length;var n=new Uint8Array(r),a=0;for(e=0,r=0;e<t.length;r+=a,++e)if(a=t[e].length,t[e]instanceof Uint8Array)n.set(t[e],r);else{if(typeof t[e]=="string")throw"wtf";n.set(new Uint8Array(t[e]),r)}return n}return[].concat.apply([],t.map(function(l){return Array.isArray(l)?l:[].slice.call(l)}))};function q8(t){for(var e=[],r=0,n=t.length+250,a=Al(t.length+255),l=0;l<t.length;++l){var o=t.charCodeAt(l);if(o<128)a[r++]=o;else if(o<2048)a[r++]=192|o>>6&31,a[r++]=128|o&63;else if(o>=55296&&o<57344){o=(o&1023)+64;var u=t.charCodeAt(++l)&1023;a[r++]=240|o>>8&7,a[r++]=128|o>>2&63,a[r++]=128|u>>6&15|(o&3)<<4,a[r++]=128|u&63}else a[r++]=224|o>>12&15,a[r++]=128|o>>6&63,a[r++]=128|o&63;r>n&&(e.push(a.slice(0,r)),r=0,a=Al(65535),n=65530)}return e.push(a.slice(0,r)),dl(e)}var ta=/\u0000/g,sf=/[\u0001-\u0006]/g;function Dc(t){for(var e="",r=t.length-1;r>=0;)e+=t.charAt(r--);return e}function ms(t,e){var r=""+t;return r.length>=e?r:kr("0",e-r.length)+r}function p1(t,e){var r=""+t;return r.length>=e?r:kr(" ",e-r.length)+r}function j0(t,e){var r=""+t;return r.length>=e?r:r+kr(" ",e-r.length)}function W8(t,e){var r=""+Math.round(t);return r.length>=e?r:kr("0",e-r.length)+r}function K8(t,e){var r=""+t;return r.length>=e?r:kr("0",e-r.length)+r}var hE=Math.pow(2,32);function yc(t,e){if(t>hE||t<-hE)return W8(t,e);var r=Math.round(t);return K8(r,e)}function F0(t,e){return e=e||0,t.length>=7+e&&(t.charCodeAt(e)|32)===103&&(t.charCodeAt(e+1)|32)===101&&(t.charCodeAt(e+2)|32)===110&&(t.charCodeAt(e+3)|32)===101&&(t.charCodeAt(e+4)|32)===114&&(t.charCodeAt(e+5)|32)===97&&(t.charCodeAt(e+6)|32)===108}var dE=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],Yg=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function Y8(t){return t||(t={}),t[0]="General",t[1]="0",t[2]="0.00",t[3]="#,##0",t[4]="#,##0.00",t[9]="0%",t[10]="0.00%",t[11]="0.00E+00",t[12]="# ?/?",t[13]="# ??/??",t[14]="m/d/yy",t[15]="d-mmm-yy",t[16]="d-mmm",t[17]="mmm-yy",t[18]="h:mm AM/PM",t[19]="h:mm:ss AM/PM",t[20]="h:mm",t[21]="h:mm:ss",t[22]="m/d/yy h:mm",t[37]="#,##0 ;(#,##0)",t[38]="#,##0 ;[Red](#,##0)",t[39]="#,##0.00;(#,##0.00)",t[40]="#,##0.00;[Red](#,##0.00)",t[45]="mm:ss",t[46]="[h]:mm:ss",t[47]="mmss.0",t[48]="##0.0E+0",t[49]="@",t[56]='"/ "hh""mm""ss" "',t}var yt={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},mE={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},$8={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function P0(t,e,r){for(var n=t<0?-1:1,a=t*n,l=0,o=1,u=0,h=1,m=0,p=0,v=Math.floor(a);m<e&&(v=Math.floor(a),u=v*o+l,p=v*m+h,!(a-v<5e-8));)a=1/(a-v),l=o,o=u,h=m,m=p;if(p>e&&(m>e?(p=h,u=l):(p=m,u=o)),!r)return[0,n*u,p];var _=Math.floor(n*u/p);return[_,n*u-_*p,p]}function oo(t,e,r){if(t>2958465||t<0)return null;var n=t|0,a=Math.floor(86400*(t-n)),l=0,o=[],u={D:n,T:a,u:86400*(t-n)-a,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(u.u)<1e-6&&(u.u=0),e&&e.date1904&&(n+=1462),u.u>.9999&&(u.u=0,++a==86400&&(u.T=a=0,++n,++u.D)),n===60)o=r?[1317,10,29]:[1900,2,29],l=3;else if(n===0)o=r?[1317,8,29]:[1900,1,0],l=6;else{n>60&&--n;var h=new Date(1900,0,1);h.setDate(h.getDate()+n-1),o=[h.getFullYear(),h.getMonth()+1,h.getDate()],l=h.getDay(),n<60&&(l=(l+6)%7),r&&(l=tL(h,o))}return u.y=o[0],u.m=o[1],u.d=o[2],u.S=a%60,a=Math.floor(a/60),u.M=a%60,a=Math.floor(a/60),u.H=a,u.q=l,u}var TN=new Date(1899,11,31,0,0,0),X8=TN.getTime(),Q8=new Date(1900,2,1,0,0,0);function EN(t,e){var r=t.getTime();return e?r-=1461*24*60*60*1e3:t>=Q8&&(r+=1440*60*1e3),(r-(X8+(t.getTimezoneOffset()-TN.getTimezoneOffset())*6e4))/(1440*60*1e3)}function g1(t){return t.indexOf(".")==-1?t:t.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function J8(t){return t.indexOf("E")==-1?t:t.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function Z8(t){var e=t<0?12:11,r=g1(t.toFixed(12));return r.length<=e||(r=t.toPrecision(10),r.length<=e)?r:t.toExponential(5)}function eL(t){var e=g1(t.toFixed(11));return e.length>(t<0?12:11)||e==="0"||e==="-0"?t.toPrecision(6):e}function Uf(t){var e=Math.floor(Math.log(Math.abs(t))*Math.LOG10E),r;return e>=-4&&e<=-1?r=t.toPrecision(10+e):Math.abs(e)<=9?r=Z8(t):e===10?r=t.toFixed(10).substr(0,12):r=eL(t),g1(J8(r.toUpperCase()))}function To(t,e){switch(typeof t){case"string":return t;case"boolean":return t?"TRUE":"FALSE";case"number":return(t|0)===t?t.toString(10):Uf(t);case"undefined":return"";case"object":if(t==null)return"";if(t instanceof Date)return es(14,EN(t,e&&e.date1904),e)}throw new Error("unsupported value in General format: "+t)}function tL(t,e){e[0]-=581;var r=t.getDay();return t<60&&(r=(r+6)%7),r}function rL(t,e,r,n){var a="",l=0,o=0,u=r.y,h,m=0;switch(t){case 98:u=r.y+543;case 121:switch(e.length){case 1:case 2:h=u%100,m=2;break;default:h=u%1e4,m=4;break}break;case 109:switch(e.length){case 1:case 2:h=r.m,m=e.length;break;case 3:return Yg[r.m-1][1];case 5:return Yg[r.m-1][0];default:return Yg[r.m-1][2]}break;case 100:switch(e.length){case 1:case 2:h=r.d,m=e.length;break;case 3:return dE[r.q][0];default:return dE[r.q][1]}break;case 104:switch(e.length){case 1:case 2:h=1+(r.H+11)%12,m=e.length;break;default:throw"bad hour format: "+e}break;case 72:switch(e.length){case 1:case 2:h=r.H,m=e.length;break;default:throw"bad hour format: "+e}break;case 77:switch(e.length){case 1:case 2:h=r.M,m=e.length;break;default:throw"bad minute format: "+e}break;case 115:if(e!="s"&&e!="ss"&&e!=".0"&&e!=".00"&&e!=".000")throw"bad second format: "+e;return r.u===0&&(e=="s"||e=="ss")?ms(r.S,e.length):(n>=2?o=n===3?1e3:100:o=n===1?10:1,l=Math.round(o*(r.S+r.u)),l>=60*o&&(l=0),e==="s"?l===0?"0":""+l/o:(a=ms(l,2+n),e==="ss"?a.substr(0,2):"."+a.substr(2,e.length-1)));case 90:switch(e){case"[h]":case"[hh]":h=r.D*24+r.H;break;case"[m]":case"[mm]":h=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":h=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+e}m=e.length===3?1:2;break;case 101:h=u,m=1;break}var p=m>0?ms(h,m):"";return p}function xl(t){var e=3;if(t.length<=e)return t;for(var r=t.length%e,n=t.substr(0,r);r!=t.length;r+=e)n+=(n.length>0?",":"")+t.substr(r,e);return n}var bN=/%/g;function nL(t,e,r){var n=e.replace(bN,""),a=e.length-n.length;return pi(t,n,r*Math.pow(10,2*a))+kr("%",a)}function aL(t,e,r){for(var n=e.length-1;e.charCodeAt(n-1)===44;)--n;return pi(t,e.substr(0,n),r/Math.pow(10,3*(e.length-n)))}function SN(t,e){var r,n=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+SN(t,-e);var a=t.indexOf(".");a===-1&&(a=t.indexOf("E"));var l=Math.floor(Math.log(e)*Math.LOG10E)%a;if(l<0&&(l+=a),r=(e/Math.pow(10,l)).toPrecision(n+1+(a+l)%a),r.indexOf("e")===-1){var o=Math.floor(Math.log(e)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(o-r.length+l):r+="E+"+(o-l);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,a)+"."+r.substr(2+a),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(u,h,m,p){return h+m+p.substr(0,(a+l)%a)+"."+p.substr(l)+"E"})}else r=e.toExponential(n);return t.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),t.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var AN=/# (\?+)( ?)\/( ?)(\d+)/;function sL(t,e,r){var n=parseInt(t[4],10),a=Math.round(e*n),l=Math.floor(a/n),o=a-l*n,u=n;return r+(l===0?"":""+l)+" "+(o===0?kr(" ",t[1].length+1+t[4].length):p1(o,t[1].length)+t[2]+"/"+t[3]+ms(u,t[4].length))}function iL(t,e,r){return r+(e===0?"":""+e)+kr(" ",t[1].length+2+t[4].length)}var NN=/^#*0*\.([0#]+)/,CN=/\).*[0#]/,kN=/\(###\) ###\\?-####/;function Xn(t){for(var e="",r,n=0;n!=t.length;++n)switch(r=t.charCodeAt(n)){case 35:break;case 63:e+=" ";break;case 48:e+="0";break;default:e+=String.fromCharCode(r)}return e}function pE(t,e){var r=Math.pow(10,e);return""+Math.round(t*r)/r}function gE(t,e){var r=t-Math.floor(t),n=Math.pow(10,e);return e<(""+Math.round(r*n)).length?0:Math.round(r*n)}function lL(t,e){return e<(""+Math.round((t-Math.floor(t))*Math.pow(10,e))).length?1:0}function oL(t){return t<2147483647&&t>-2147483648?""+(t>=0?t|0:t-1|0):""+Math.floor(t)}function $a(t,e,r){if(t.charCodeAt(0)===40&&!e.match(CN)){var n=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?$a("n",n,r):"("+$a("n",n,-r)+")"}if(e.charCodeAt(e.length-1)===44)return aL(t,e,r);if(e.indexOf("%")!==-1)return nL(t,e,r);if(e.indexOf("E")!==-1)return SN(e,r);if(e.charCodeAt(0)===36)return"$"+$a(t,e.substr(e.charAt(1)==" "?2:1),r);var a,l,o,u,h=Math.abs(r),m=r<0?"-":"";if(e.match(/^00+$/))return m+yc(h,e.length);if(e.match(/^[#?]+$/))return a=yc(r,0),a==="0"&&(a=""),a.length>e.length?a:Xn(e.substr(0,e.length-a.length))+a;if(l=e.match(AN))return sL(l,h,m);if(e.match(/^#+0+$/))return m+yc(h,e.length-e.indexOf("0"));if(l=e.match(NN))return a=pE(r,l[1].length).replace(/^([^\.]+)$/,"$1."+Xn(l[1])).replace(/\.$/,"."+Xn(l[1])).replace(/\.(\d*)$/,function(E,T){return"."+T+kr("0",Xn(l[1]).length-T.length)}),e.indexOf("0.")!==-1?a:a.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),l=e.match(/^(0*)\.(#*)$/))return m+pE(h,l[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,l[1].length?"0.":".");if(l=e.match(/^#{1,3},##0(\.?)$/))return m+xl(yc(h,0));if(l=e.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+$a(t,e,-r):xl(""+(Math.floor(r)+lL(r,l[1].length)))+"."+ms(gE(r,l[1].length),l[1].length);if(l=e.match(/^#,#*,#0/))return $a(t,e.replace(/^#,#*,/,""),r);if(l=e.match(/^([0#]+)(\\?-([0#]+))+$/))return a=Dc($a(t,e.replace(/[\\-]/g,""),r)),o=0,Dc(Dc(e.replace(/\\/g,"")).replace(/[0#]/g,function(E){return o<a.length?a.charAt(o++):E==="0"?"0":""}));if(e.match(kN))return a=$a(t,"##########",r),"("+a.substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var p="";if(l=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(l[4].length,7),u=P0(h,Math.pow(10,o)-1,!1),a=""+m,p=pi("n",l[1],u[1]),p.charAt(p.length-1)==" "&&(p=p.substr(0,p.length-1)+"0"),a+=p+l[2]+"/"+l[3],p=j0(u[2],o),p.length<l[4].length&&(p=Xn(l[4].substr(l[4].length-p.length))+p),a+=p,a;if(l=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(Math.max(l[1].length,l[4].length),7),u=P0(h,Math.pow(10,o)-1,!0),m+(u[0]||(u[1]?"":"0"))+" "+(u[1]?p1(u[1],o)+l[2]+"/"+l[3]+j0(u[2],o):kr(" ",2*o+1+l[2].length+l[3].length));if(l=e.match(/^[#0?]+$/))return a=yc(r,0),e.length<=a.length?a:Xn(e.substr(0,e.length-a.length))+a;if(l=e.match(/^([#0?]+)\.([#0]+)$/)){a=""+r.toFixed(Math.min(l[2].length,10)).replace(/([^0])0+$/,"$1"),o=a.indexOf(".");var v=e.indexOf(".")-o,_=e.length-a.length-v;return Xn(e.substr(0,v)+a+e.substr(e.length-_))}if(l=e.match(/^00,000\.([#0]*0)$/))return o=gE(r,l[1].length),r<0?"-"+$a(t,e,-r):xl(oL(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(E){return"00,"+(E.length<3?ms(0,3-E.length):"")+E})+"."+ms(o,l[1].length);switch(e){case"###,##0.00":return $a(t,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var w=xl(yc(h,0));return w!=="0"?m+w:"";case"###,###.00":return $a(t,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return $a(t,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+e+"|")}function cL(t,e,r){for(var n=e.length-1;e.charCodeAt(n-1)===44;)--n;return pi(t,e.substr(0,n),r/Math.pow(10,3*(e.length-n)))}function uL(t,e,r){var n=e.replace(bN,""),a=e.length-n.length;return pi(t,n,r*Math.pow(10,2*a))+kr("%",a)}function RN(t,e){var r,n=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+RN(t,-e);var a=t.indexOf(".");a===-1&&(a=t.indexOf("E"));var l=Math.floor(Math.log(e)*Math.LOG10E)%a;if(l<0&&(l+=a),r=(e/Math.pow(10,l)).toPrecision(n+1+(a+l)%a),!r.match(/[Ee]/)){var o=Math.floor(Math.log(e)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(o-r.length+l):r+="E+"+(o-l),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(u,h,m,p){return h+m+p.substr(0,(a+l)%a)+"."+p.substr(l)+"E"})}else r=e.toExponential(n);return t.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),t.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function ks(t,e,r){if(t.charCodeAt(0)===40&&!e.match(CN)){var n=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?ks("n",n,r):"("+ks("n",n,-r)+")"}if(e.charCodeAt(e.length-1)===44)return cL(t,e,r);if(e.indexOf("%")!==-1)return uL(t,e,r);if(e.indexOf("E")!==-1)return RN(e,r);if(e.charCodeAt(0)===36)return"$"+ks(t,e.substr(e.charAt(1)==" "?2:1),r);var a,l,o,u,h=Math.abs(r),m=r<0?"-":"";if(e.match(/^00+$/))return m+ms(h,e.length);if(e.match(/^[#?]+$/))return a=""+r,r===0&&(a=""),a.length>e.length?a:Xn(e.substr(0,e.length-a.length))+a;if(l=e.match(AN))return iL(l,h,m);if(e.match(/^#+0+$/))return m+ms(h,e.length-e.indexOf("0"));if(l=e.match(NN))return a=(""+r).replace(/^([^\.]+)$/,"$1."+Xn(l[1])).replace(/\.$/,"."+Xn(l[1])),a=a.replace(/\.(\d*)$/,function(E,T){return"."+T+kr("0",Xn(l[1]).length-T.length)}),e.indexOf("0.")!==-1?a:a.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),l=e.match(/^(0*)\.(#*)$/))return m+(""+h).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,l[1].length?"0.":".");if(l=e.match(/^#{1,3},##0(\.?)$/))return m+xl(""+h);if(l=e.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+ks(t,e,-r):xl(""+r)+"."+kr("0",l[1].length);if(l=e.match(/^#,#*,#0/))return ks(t,e.replace(/^#,#*,/,""),r);if(l=e.match(/^([0#]+)(\\?-([0#]+))+$/))return a=Dc(ks(t,e.replace(/[\\-]/g,""),r)),o=0,Dc(Dc(e.replace(/\\/g,"")).replace(/[0#]/g,function(E){return o<a.length?a.charAt(o++):E==="0"?"0":""}));if(e.match(kN))return a=ks(t,"##########",r),"("+a.substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var p="";if(l=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(l[4].length,7),u=P0(h,Math.pow(10,o)-1,!1),a=""+m,p=pi("n",l[1],u[1]),p.charAt(p.length-1)==" "&&(p=p.substr(0,p.length-1)+"0"),a+=p+l[2]+"/"+l[3],p=j0(u[2],o),p.length<l[4].length&&(p=Xn(l[4].substr(l[4].length-p.length))+p),a+=p,a;if(l=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(Math.max(l[1].length,l[4].length),7),u=P0(h,Math.pow(10,o)-1,!0),m+(u[0]||(u[1]?"":"0"))+" "+(u[1]?p1(u[1],o)+l[2]+"/"+l[3]+j0(u[2],o):kr(" ",2*o+1+l[2].length+l[3].length));if(l=e.match(/^[#0?]+$/))return a=""+r,e.length<=a.length?a:Xn(e.substr(0,e.length-a.length))+a;if(l=e.match(/^([#0]+)\.([#0]+)$/)){a=""+r.toFixed(Math.min(l[2].length,10)).replace(/([^0])0+$/,"$1"),o=a.indexOf(".");var v=e.indexOf(".")-o,_=e.length-a.length-v;return Xn(e.substr(0,v)+a+e.substr(e.length-_))}if(l=e.match(/^00,000\.([#0]*0)$/))return r<0?"-"+ks(t,e,-r):xl(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(E){return"00,"+(E.length<3?ms(0,3-E.length):"")+E})+"."+ms(0,l[1].length);switch(e){case"###,###":case"##,###":case"#,###":var w=xl(""+h);return w!=="0"?m+w:"";default:if(e.match(/\.[0#?]*$/))return ks(t,e.slice(0,e.lastIndexOf(".")),r)+Xn(e.slice(e.lastIndexOf(".")))}throw new Error("unsupported format |"+e+"|")}function pi(t,e,r){return(r|0)===r?ks(t,e,r):$a(t,e,r)}function fL(t){for(var e=[],r=!1,n=0,a=0;n<t.length;++n)switch(t.charCodeAt(n)){case 34:r=!r;break;case 95:case 42:case 92:++n;break;case 59:e[e.length]=t.substr(a,n-a),a=n+1}if(e[e.length]=t.substr(a),r===!0)throw new Error("Format |"+t+"| unterminated string ");return e}var DN=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function Jc(t){for(var e=0,r="",n="";e<t.length;)switch(r=t.charAt(e)){case"G":F0(t,e)&&(e+=6),e++;break;case'"':for(;t.charCodeAt(++e)!==34&&e<t.length;);++e;break;case"\\":e+=2;break;case"_":e+=2;break;case"@":++e;break;case"B":case"b":if(t.charAt(e+1)==="1"||t.charAt(e+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(t.substr(e,3).toUpperCase()==="A/P"||t.substr(e,5).toUpperCase()==="AM/PM"||t.substr(e,5).toUpperCase()==="/")return!0;++e;break;case"[":for(n=r;t.charAt(e++)!=="]"&&e<t.length;)n+=t.charAt(e);if(n.match(DN))return!0;break;case".":case"0":case"#":for(;e<t.length&&("0#?.,E+-%".indexOf(r=t.charAt(++e))>-1||r=="\\"&&t.charAt(e+1)=="-"&&"0#".indexOf(t.charAt(e+2))>-1););break;case"?":for(;t.charAt(++e)===r;);break;case"*":++e,(t.charAt(e)==" "||t.charAt(e)=="*")&&++e;break;case"(":case")":++e;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;e<t.length&&"0123456789".indexOf(t.charAt(++e))>-1;);break;case" ":++e;break;default:++e;break}return!1}function hL(t,e,r,n){for(var a=[],l="",o=0,u="",h="t",m,p,v,_="H";o<t.length;)switch(u=t.charAt(o)){case"G":if(!F0(t,o))throw new Error("unrecognized character "+u+" in "+t);a[a.length]={t:"G",v:"General"},o+=7;break;case'"':for(l="";(v=t.charCodeAt(++o))!==34&&o<t.length;)l+=String.fromCharCode(v);a[a.length]={t:"t",v:l},++o;break;case"\\":var w=t.charAt(++o),E=w==="("||w===")"?w:"t";a[a.length]={t:E,v:w},++o;break;case"_":a[a.length]={t:"t",v:" "},o+=2;break;case"@":a[a.length]={t:"T",v:e},++o;break;case"B":case"b":if(t.charAt(o+1)==="1"||t.charAt(o+1)==="2"){if(m==null&&(m=oo(e,r,t.charAt(o+1)==="2"),m==null))return"";a[a.length]={t:"X",v:t.substr(o,2)},h=u,o+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":u=u.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(e<0||m==null&&(m=oo(e,r),m==null))return"";for(l=u;++o<t.length&&t.charAt(o).toLowerCase()===u;)l+=u;u==="m"&&h.toLowerCase()==="h"&&(u="M"),u==="h"&&(u=_),a[a.length]={t:u,v:l},h=u;break;case"A":case"a":case"":var T={t:u,v:u};if(m==null&&(m=oo(e,r)),t.substr(o,3).toUpperCase()==="A/P"?(m!=null&&(T.v=m.H>=12?"P":"A"),T.t="T",_="h",o+=3):t.substr(o,5).toUpperCase()==="AM/PM"?(m!=null&&(T.v=m.H>=12?"PM":"AM"),T.t="T",o+=5,_="h"):t.substr(o,5).toUpperCase()==="/"?(m!=null&&(T.v=m.H>=12?"":""),T.t="T",o+=5,_="h"):(T.t="t",++o),m==null&&T.t==="T")return"";a[a.length]=T,h=u;break;case"[":for(l=u;t.charAt(o++)!=="]"&&o<t.length;)l+=t.charAt(o);if(l.slice(-1)!=="]")throw'unterminated "[" block: |'+l+"|";if(l.match(DN)){if(m==null&&(m=oo(e,r),m==null))return"";a[a.length]={t:"Z",v:l.toLowerCase()},h=l.charAt(1)}else l.indexOf("$")>-1&&(l=(l.match(/\$([^-\[\]]*)/)||[])[1]||"$",Jc(t)||(a[a.length]={t:"t",v:l}));break;case".":if(m!=null){for(l=u;++o<t.length&&(u=t.charAt(o))==="0";)l+=u;a[a.length]={t:"s",v:l};break}case"0":case"#":for(l=u;++o<t.length&&"0#?.,E+-%".indexOf(u=t.charAt(o))>-1;)l+=u;a[a.length]={t:"n",v:l};break;case"?":for(l=u;t.charAt(++o)===u;)l+=u;a[a.length]={t:u,v:l},h=u;break;case"*":++o,(t.charAt(o)==" "||t.charAt(o)=="*")&&++o;break;case"(":case")":a[a.length]={t:n===1?"t":u,v:u},++o;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(l=u;o<t.length&&"0123456789".indexOf(t.charAt(++o))>-1;)l+=t.charAt(o);a[a.length]={t:"D",v:l};break;case" ":a[a.length]={t:u,v:u},++o;break;case"$":a[a.length]={t:"t",v:"$"},++o;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(u)===-1)throw new Error("unrecognized character "+u+" in "+t);a[a.length]={t:"t",v:u},++o;break}var A=0,M=0,F;for(o=a.length-1,h="t";o>=0;--o)switch(a[o].t){case"h":case"H":a[o].t=_,h="h",A<1&&(A=1);break;case"s":(F=a[o].v.match(/\.0+$/))&&(M=Math.max(M,F[0].length-1)),A<3&&(A=3);case"d":case"y":case"M":case"e":h=a[o].t;break;case"m":h==="s"&&(a[o].t="M",A<2&&(A=2));break;case"X":break;case"Z":A<1&&a[o].v.match(/[Hh]/)&&(A=1),A<2&&a[o].v.match(/[Mm]/)&&(A=2),A<3&&a[o].v.match(/[Ss]/)&&(A=3)}switch(A){case 0:break;case 1:m.u>=.5&&(m.u=0,++m.S),m.S>=60&&(m.S=0,++m.M),m.M>=60&&(m.M=0,++m.H);break;case 2:m.u>=.5&&(m.u=0,++m.S),m.S>=60&&(m.S=0,++m.M);break}var R="",z;for(o=0;o<a.length;++o)switch(a[o].t){case"t":case"T":case" ":case"D":break;case"X":a[o].v="",a[o].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":a[o].v=rL(a[o].t.charCodeAt(0),a[o].v,m,M),a[o].t="t";break;case"n":case"?":for(z=o+1;a[z]!=null&&((u=a[z].t)==="?"||u==="D"||(u===" "||u==="t")&&a[z+1]!=null&&(a[z+1].t==="?"||a[z+1].t==="t"&&a[z+1].v==="/")||a[o].t==="("&&(u===" "||u==="n"||u===")")||u==="t"&&(a[z].v==="/"||a[z].v===" "&&a[z+1]!=null&&a[z+1].t=="?"));)a[o].v+=a[z].v,a[z]={v:"",t:";"},++z;R+=a[o].v,o=z-1;break;case"G":a[o].t="t",a[o].v=To(e,r);break}var re="",te,b;if(R.length>0){R.charCodeAt(0)==40?(te=e<0&&R.charCodeAt(0)===45?-e:e,b=pi("n",R,te)):(te=e<0&&n>1?-e:e,b=pi("n",R,te),te<0&&a[0]&&a[0].t=="t"&&(b=b.substr(1),a[0].v="-"+a[0].v)),z=b.length-1;var N=a.length;for(o=0;o<a.length;++o)if(a[o]!=null&&a[o].t!="t"&&a[o].v.indexOf(".")>-1){N=o;break}var k=a.length;if(N===a.length&&b.indexOf("E")===-1){for(o=a.length-1;o>=0;--o)a[o]==null||"n?".indexOf(a[o].t)===-1||(z>=a[o].v.length-1?(z-=a[o].v.length,a[o].v=b.substr(z+1,a[o].v.length)):z<0?a[o].v="":(a[o].v=b.substr(0,z+1),z=-1),a[o].t="t",k=o);z>=0&&k<a.length&&(a[k].v=b.substr(0,z+1)+a[k].v)}else if(N!==a.length&&b.indexOf("E")===-1){for(z=b.indexOf(".")-1,o=N;o>=0;--o)if(!(a[o]==null||"n?".indexOf(a[o].t)===-1)){for(p=a[o].v.indexOf(".")>-1&&o===N?a[o].v.indexOf(".")-1:a[o].v.length-1,re=a[o].v.substr(p+1);p>=0;--p)z>=0&&(a[o].v.charAt(p)==="0"||a[o].v.charAt(p)==="#")&&(re=b.charAt(z--)+re);a[o].v=re,a[o].t="t",k=o}for(z>=0&&k<a.length&&(a[k].v=b.substr(0,z+1)+a[k].v),z=b.indexOf(".")+1,o=N;o<a.length;++o)if(!(a[o]==null||"n?(".indexOf(a[o].t)===-1&&o!==N)){for(p=a[o].v.indexOf(".")>-1&&o===N?a[o].v.indexOf(".")+1:0,re=a[o].v.substr(0,p);p<a[o].v.length;++p)z<b.length&&(re+=b.charAt(z++));a[o].v=re,a[o].t="t",k=o}}}for(o=0;o<a.length;++o)a[o]!=null&&"n?".indexOf(a[o].t)>-1&&(te=n>1&&e<0&&o>0&&a[o-1].v==="-"?-e:e,a[o].v=pi(a[o].t,a[o].v,te),a[o].t="t");var j="";for(o=0;o!==a.length;++o)a[o]!=null&&(j+=a[o].v);return j}var xE=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function vE(t,e){if(e==null)return!1;var r=parseFloat(e[2]);switch(e[1]){case"=":if(t==r)return!0;break;case">":if(t>r)return!0;break;case"<":if(t<r)return!0;break;case"<>":if(t!=r)return!0;break;case">=":if(t>=r)return!0;break;case"<=":if(t<=r)return!0;break}return!1}function dL(t,e){var r=fL(t),n=r.length,a=r[n-1].indexOf("@");if(n<4&&a>-1&&--n,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof e!="number")return[4,r.length===4||a>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=a>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=a>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=a>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var l=e>0?r[0]:e<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[n,l];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var o=r[0].match(xE),u=r[1].match(xE);return vE(e,o)?[n,r[0]]:vE(e,u)?[n,r[1]]:[n,r[o!=null&&u!=null?2:1]]}return[n,l]}function es(t,e,r){r==null&&(r={});var n="";switch(typeof t){case"string":t=="m/d/yy"&&r.dateNF?n=r.dateNF:n=t;break;case"number":t==14&&r.dateNF?n=r.dateNF:n=(r.table!=null?r.table:yt)[t],n==null&&(n=r.table&&r.table[mE[t]]||yt[mE[t]]),n==null&&(n=$8[t]||"General");break}if(F0(n,0))return To(e,r);e instanceof Date&&(e=EN(e,r.date1904));var a=dL(n,e);if(F0(a[1]))return To(e,r);if(e===!0)e="TRUE";else if(e===!1)e="FALSE";else if(e===""||e==null)return"";return hL(a[1],e,r,a[0])}function ho(t,e){if(typeof e!="number"){e=+e||-1;for(var r=0;r<392;++r){if(yt[r]==null){e<0&&(e=r);continue}if(yt[r]==t){e=r;break}}e<0&&(e=391)}return yt[e]=t,e}function IN(){yt=Y8()}var mL={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},ON=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function pL(t){var e=typeof t=="number"?yt[t]:t;return e=e.replace(ON,"(\\d+)"),new RegExp("^"+e+"$")}function gL(t,e,r){var n=-1,a=-1,l=-1,o=-1,u=-1,h=-1;(e.match(ON)||[]).forEach(function(v,_){var w=parseInt(r[_+1],10);switch(v.toLowerCase().charAt(0)){case"y":n=w;break;case"d":l=w;break;case"h":o=w;break;case"s":h=w;break;case"m":o>=0?u=w:a=w;break}}),h>=0&&u==-1&&a>=0&&(u=a,a=-1);var m=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(a>=1?a:1)).slice(-2)+"-"+("00"+(l>=1?l:1)).slice(-2);m.length==7&&(m="0"+m),m.length==8&&(m="20"+m);var p=("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(u>=0?u:0)).slice(-2)+":"+("00"+(h>=0?h:0)).slice(-2);return o==-1&&u==-1&&h==-1?m:n==-1&&a==-1&&l==-1?p:m+"T"+p}var xL=(function(){var t={};t.version="1.2.0";function e(){for(var b=0,N=new Array(256),k=0;k!=256;++k)b=k,b=b&1?-306674912^b>>>1:b>>>1,b=b&1?-306674912^b>>>1:b>>>1,b=b&1?-306674912^b>>>1:b>>>1,b=b&1?-306674912^b>>>1:b>>>1,b=b&1?-306674912^b>>>1:b>>>1,b=b&1?-306674912^b>>>1:b>>>1,b=b&1?-306674912^b>>>1:b>>>1,b=b&1?-306674912^b>>>1:b>>>1,N[k]=b;return typeof Int32Array<"u"?new Int32Array(N):N}var r=e();function n(b){var N=0,k=0,j=0,L=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(j=0;j!=256;++j)L[j]=b[j];for(j=0;j!=256;++j)for(k=b[j],N=256+j;N<4096;N+=256)k=L[N]=k>>>8^b[k&255];var P=[];for(j=1;j!=16;++j)P[j-1]=typeof Int32Array<"u"?L.subarray(j*256,j*256+256):L.slice(j*256,j*256+256);return P}var a=n(r),l=a[0],o=a[1],u=a[2],h=a[3],m=a[4],p=a[5],v=a[6],_=a[7],w=a[8],E=a[9],T=a[10],A=a[11],M=a[12],F=a[13],R=a[14];function z(b,N){for(var k=N^-1,j=0,L=b.length;j<L;)k=k>>>8^r[(k^b.charCodeAt(j++))&255];return~k}function re(b,N){for(var k=N^-1,j=b.length-15,L=0;L<j;)k=R[b[L++]^k&255]^F[b[L++]^k>>8&255]^M[b[L++]^k>>16&255]^A[b[L++]^k>>>24]^T[b[L++]]^E[b[L++]]^w[b[L++]]^_[b[L++]]^v[b[L++]]^p[b[L++]]^m[b[L++]]^h[b[L++]]^u[b[L++]]^o[b[L++]]^l[b[L++]]^r[b[L++]];for(j+=15;L<j;)k=k>>>8^r[(k^b[L++])&255];return~k}function te(b,N){for(var k=N^-1,j=0,L=b.length,P=0,U=0;j<L;)P=b.charCodeAt(j++),P<128?k=k>>>8^r[(k^P)&255]:P<2048?(k=k>>>8^r[(k^(192|P>>6&31))&255],k=k>>>8^r[(k^(128|P&63))&255]):P>=55296&&P<57344?(P=(P&1023)+64,U=b.charCodeAt(j++)&1023,k=k>>>8^r[(k^(240|P>>8&7))&255],k=k>>>8^r[(k^(128|P>>2&63))&255],k=k>>>8^r[(k^(128|U>>6&15|(P&3)<<4))&255],k=k>>>8^r[(k^(128|U&63))&255]):(k=k>>>8^r[(k^(224|P>>12&15))&255],k=k>>>8^r[(k^(128|P>>6&63))&255],k=k>>>8^r[(k^(128|P&63))&255]);return~k}return t.table=r,t.bstr=z,t.buf=re,t.str=te,t})(),zt=(function(){var e={};e.version="1.2.1";function r(O,Y){for(var V=O.split("/"),H=Y.split("/"),W=0,K=0,oe=Math.min(V.length,H.length);W<oe;++W){if(K=V[W].length-H[W].length)return K;if(V[W]!=H[W])return V[W]<H[W]?-1:1}return V.length-H.length}function n(O){if(O.charAt(O.length-1)=="/")return O.slice(0,-1).indexOf("/")===-1?O:n(O.slice(0,-1));var Y=O.lastIndexOf("/");return Y===-1?O:O.slice(0,Y+1)}function a(O){if(O.charAt(O.length-1)=="/")return a(O.slice(0,-1));var Y=O.lastIndexOf("/");return Y===-1?O:O.slice(Y+1)}function l(O,Y){typeof Y=="string"&&(Y=new Date(Y));var V=Y.getHours();V=V<<6|Y.getMinutes(),V=V<<5|Y.getSeconds()>>>1,O.write_shift(2,V);var H=Y.getFullYear()-1980;H=H<<4|Y.getMonth()+1,H=H<<5|Y.getDate(),O.write_shift(2,H)}function o(O){var Y=O.read_shift(2)&65535,V=O.read_shift(2)&65535,H=new Date,W=V&31;V>>>=5;var K=V&15;V>>>=4,H.setMilliseconds(0),H.setFullYear(V+1980),H.setMonth(K-1),H.setDate(W);var oe=Y&31;Y>>>=5;var ve=Y&63;return Y>>>=6,H.setHours(Y),H.setMinutes(ve),H.setSeconds(oe<<1),H}function u(O){_n(O,0);for(var Y={},V=0;O.l<=O.length-4;){var H=O.read_shift(2),W=O.read_shift(2),K=O.l+W,oe={};switch(H){case 21589:V=O.read_shift(1),V&1&&(oe.mtime=O.read_shift(4)),W>5&&(V&2&&(oe.atime=O.read_shift(4)),V&4&&(oe.ctime=O.read_shift(4))),oe.mtime&&(oe.mt=new Date(oe.mtime*1e3));break}O.l=K,Y[H]=oe}return Y}var h;function m(){return h||(h={})}function p(O,Y){if(O[0]==80&&O[1]==75)return ga(O,Y);if((O[0]|32)==109&&(O[1]|32)==105)return La(O,Y);if(O.length<512)throw new Error("CFB file size "+O.length+" < 512");var V=3,H=512,W=0,K=0,oe=0,ve=0,xe=0,me=[],fe=O.slice(0,512);_n(fe,0);var Oe=v(fe);switch(V=Oe[0],V){case 3:H=512;break;case 4:H=4096;break;case 0:if(Oe[1]==0)return ga(O,Y);default:throw new Error("Major Version: Expected 3 or 4 saw "+V)}H!==512&&(fe=O.slice(0,H),_n(fe,28));var Ge=O.slice(0,H);_(fe,V);var Ye=fe.read_shift(4,"i");if(V===3&&Ye!==0)throw new Error("# Directory Sectors: Expected 0 saw "+Ye);fe.l+=4,oe=fe.read_shift(4,"i"),fe.l+=4,fe.chk("00100000","Mini Stream Cutoff Size: "),ve=fe.read_shift(4,"i"),W=fe.read_shift(4,"i"),xe=fe.read_shift(4,"i"),K=fe.read_shift(4,"i");for(var Ve=-1,qe=0;qe<109&&(Ve=fe.read_shift(4,"i"),!(Ve<0));++qe)me[qe]=Ve;var Xe=w(O,H);A(xe,K,Xe,H,me);var Rt=F(Xe,oe,me,H);Rt[oe].name="!Directory",W>0&&ve!==U&&(Rt[ve].name="!MiniFAT"),Rt[me[0]].name="!FAT",Rt.fat_addrs=me,Rt.ssz=H;var wt={},At=[],Mr=[],xt=[];R(oe,Rt,Xe,At,W,wt,Mr,ve),E(Mr,xt,At),At.shift();var Bt={FileIndex:Mr,FullPaths:xt};return Y&&Y.raw&&(Bt.raw={header:Ge,sectors:Xe}),Bt}function v(O){if(O[O.l]==80&&O[O.l+1]==75)return[0,0];O.chk(Ce,"Header Signature: "),O.l+=16;var Y=O.read_shift(2,"u");return[O.read_shift(2,"u"),Y]}function _(O,Y){var V=9;switch(O.l+=2,V=O.read_shift(2)){case 9:if(Y!=3)throw new Error("Sector Shift: Expected 9 saw "+V);break;case 12:if(Y!=4)throw new Error("Sector Shift: Expected 12 saw "+V);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+V)}O.chk("0600","Mini Sector Shift: "),O.chk("000000000000","Reserved: ")}function w(O,Y){for(var V=Math.ceil(O.length/Y)-1,H=[],W=1;W<V;++W)H[W-1]=O.slice(W*Y,(W+1)*Y);return H[V-1]=O.slice(V*Y),H}function E(O,Y,V){for(var H=0,W=0,K=0,oe=0,ve=0,xe=V.length,me=[],fe=[];H<xe;++H)me[H]=fe[H]=H,Y[H]=V[H];for(;ve<fe.length;++ve)H=fe[ve],W=O[H].L,K=O[H].R,oe=O[H].C,me[H]===H&&(W!==-1&&me[W]!==W&&(me[H]=me[W]),K!==-1&&me[K]!==K&&(me[H]=me[K])),oe!==-1&&(me[oe]=H),W!==-1&&H!=me[H]&&(me[W]=me[H],fe.lastIndexOf(W)<ve&&fe.push(W)),K!==-1&&H!=me[H]&&(me[K]=me[H],fe.lastIndexOf(K)<ve&&fe.push(K));for(H=1;H<xe;++H)me[H]===H&&(K!==-1&&me[K]!==K?me[H]=me[K]:W!==-1&&me[W]!==W&&(me[H]=me[W]));for(H=1;H<xe;++H)if(O[H].type!==0){if(ve=H,ve!=me[ve])do ve=me[ve],Y[H]=Y[ve]+"/"+Y[H];while(ve!==0&&me[ve]!==-1&&ve!=me[ve]);me[H]=-1}for(Y[0]+="/",H=1;H<xe;++H)O[H].type!==2&&(Y[H]+="/")}function T(O,Y,V){for(var H=O.start,W=O.size,K=[],oe=H;V&&W>0&&oe>=0;)K.push(Y.slice(oe*P,oe*P+P)),W-=P,oe=ao(V,oe*4);return K.length===0?Zr(0):dl(K).slice(0,O.size)}function A(O,Y,V,H,W){var K=U;if(O===U){if(Y!==0)throw new Error("DIFAT chain shorter than expected")}else if(O!==-1){var oe=V[O],ve=(H>>>2)-1;if(!oe)return;for(var xe=0;xe<ve&&(K=ao(oe,xe*4))!==U;++xe)W.push(K);A(ao(oe,H-4),Y-1,V,H,W)}}function M(O,Y,V,H,W){var K=[],oe=[];W||(W=[]);var ve=H-1,xe=0,me=0;for(xe=Y;xe>=0;){W[xe]=!0,K[K.length]=xe,oe.push(O[xe]);var fe=V[Math.floor(xe*4/H)];if(me=xe*4&ve,H<4+me)throw new Error("FAT boundary crossed: "+xe+" 4 "+H);if(!O[fe])break;xe=ao(O[fe],me)}return{nodes:K,data:CE([oe])}}function F(O,Y,V,H){var W=O.length,K=[],oe=[],ve=[],xe=[],me=H-1,fe=0,Oe=0,Ge=0,Ye=0;for(fe=0;fe<W;++fe)if(ve=[],Ge=fe+Y,Ge>=W&&(Ge-=W),!oe[Ge]){xe=[];var Ve=[];for(Oe=Ge;Oe>=0;){Ve[Oe]=!0,oe[Oe]=!0,ve[ve.length]=Oe,xe.push(O[Oe]);var qe=V[Math.floor(Oe*4/H)];if(Ye=Oe*4&me,H<4+Ye)throw new Error("FAT boundary crossed: "+Oe+" 4 "+H);if(!O[qe]||(Oe=ao(O[qe],Ye),Ve[Oe]))break}K[Ge]={nodes:ve,data:CE([xe])}}return K}function R(O,Y,V,H,W,K,oe,ve){for(var xe=0,me=H.length?2:0,fe=Y[O].data,Oe=0,Ge=0,Ye;Oe<fe.length;Oe+=128){var Ve=fe.slice(Oe,Oe+128);_n(Ve,64),Ge=Ve.read_shift(2),Ye=w1(Ve,0,Ge-me),H.push(Ye);var qe={name:Ye,type:Ve.read_shift(1),color:Ve.read_shift(1),L:Ve.read_shift(4,"i"),R:Ve.read_shift(4,"i"),C:Ve.read_shift(4,"i"),clsid:Ve.read_shift(16),state:Ve.read_shift(4,"i"),start:0,size:0},Xe=Ve.read_shift(2)+Ve.read_shift(2)+Ve.read_shift(2)+Ve.read_shift(2);Xe!==0&&(qe.ct=z(Ve,Ve.l-8));var Rt=Ve.read_shift(2)+Ve.read_shift(2)+Ve.read_shift(2)+Ve.read_shift(2);Rt!==0&&(qe.mt=z(Ve,Ve.l-8)),qe.start=Ve.read_shift(4,"i"),qe.size=Ve.read_shift(4,"i"),qe.size<0&&qe.start<0&&(qe.size=qe.type=0,qe.start=U,qe.name=""),qe.type===5?(xe=qe.start,W>0&&xe!==U&&(Y[xe].name="!StreamData")):qe.size>=4096?(qe.storage="fat",Y[qe.start]===void 0&&(Y[qe.start]=M(V,qe.start,Y.fat_addrs,Y.ssz)),Y[qe.start].name=qe.name,qe.content=Y[qe.start].data.slice(0,qe.size)):(qe.storage="minifat",qe.size<0?qe.size=0:xe!==U&&qe.start!==U&&Y[xe]&&(qe.content=T(qe,Y[xe].data,(Y[ve]||{}).data))),qe.content&&_n(qe.content,0),K[Ye]=qe,oe.push(qe)}}function z(O,Y){return new Date((Na(O,Y+4)/1e7*Math.pow(2,32)+Na(O,Y)/1e7-11644473600)*1e3)}function re(O,Y){return m(),p(h.readFileSync(O),Y)}function te(O,Y){var V=Y&&Y.type;switch(V||Ft&&Buffer.isBuffer(O)&&(V="buffer"),V||"base64"){case"file":return re(O,Y);case"base64":return p(hs(Oa(O)),Y);case"binary":return p(hs(O),Y)}return p(O,Y)}function b(O,Y){var V=Y||{},H=V.root||"Root Entry";if(O.FullPaths||(O.FullPaths=[]),O.FileIndex||(O.FileIndex=[]),O.FullPaths.length!==O.FileIndex.length)throw new Error("inconsistent CFB structure");O.FullPaths.length===0&&(O.FullPaths[0]=H+"/",O.FileIndex[0]={name:H,type:5}),V.CLSID&&(O.FileIndex[0].clsid=V.CLSID),N(O)}function N(O){var Y="Sh33tJ5";if(!zt.find(O,"/"+Y)){var V=Zr(4);V[0]=55,V[1]=V[3]=50,V[2]=54,O.FileIndex.push({name:Y,type:2,content:V,size:4,L:69,R:69,C:69}),O.FullPaths.push(O.FullPaths[0]+Y),k(O)}}function k(O,Y){b(O);for(var V=!1,H=!1,W=O.FullPaths.length-1;W>=0;--W){var K=O.FileIndex[W];switch(K.type){case 0:H?V=!0:(O.FileIndex.pop(),O.FullPaths.pop());break;case 1:case 2:case 5:H=!0,isNaN(K.R*K.L*K.C)&&(V=!0),K.R>-1&&K.L>-1&&K.R==K.L&&(V=!0);break;default:V=!0;break}}if(!(!V&&!Y)){var oe=new Date(1987,1,19),ve=0,xe=Object.create?Object.create(null):{},me=[];for(W=0;W<O.FullPaths.length;++W)xe[O.FullPaths[W]]=!0,O.FileIndex[W].type!==0&&me.push([O.FullPaths[W],O.FileIndex[W]]);for(W=0;W<me.length;++W){var fe=n(me[W][0]);H=xe[fe],H||(me.push([fe,{name:a(fe).replace("/",""),type:1,clsid:ae,ct:oe,mt:oe,content:null}]),xe[fe]=!0)}for(me.sort(function(Ye,Ve){return r(Ye[0],Ve[0])}),O.FullPaths=[],O.FileIndex=[],W=0;W<me.length;++W)O.FullPaths[W]=me[W][0],O.FileIndex[W]=me[W][1];for(W=0;W<me.length;++W){var Oe=O.FileIndex[W],Ge=O.FullPaths[W];if(Oe.name=a(Ge).replace("/",""),Oe.L=Oe.R=Oe.C=-(Oe.color=1),Oe.size=Oe.content?Oe.content.length:0,Oe.start=0,Oe.clsid=Oe.clsid||ae,W===0)Oe.C=me.length>1?1:-1,Oe.size=0,Oe.type=5;else if(Ge.slice(-1)=="/"){for(ve=W+1;ve<me.length&&n(O.FullPaths[ve])!=Ge;++ve);for(Oe.C=ve>=me.length?-1:ve,ve=W+1;ve<me.length&&n(O.FullPaths[ve])!=n(Ge);++ve);Oe.R=ve>=me.length?-1:ve,Oe.type=1}else n(O.FullPaths[W+1]||"")==n(Ge)&&(Oe.R=W+1),Oe.type=2}}}function j(O,Y){var V=Y||{};if(V.fileType=="mad")return Or(O,V);switch(k(O),V.fileType){case"zip":return na(O,V)}var H=(function(Ye){for(var Ve=0,qe=0,Xe=0;Xe<Ye.FileIndex.length;++Xe){var Rt=Ye.FileIndex[Xe];if(Rt.content){var wt=Rt.content.length;wt>0&&(wt<4096?Ve+=wt+63>>6:qe+=wt+511>>9)}}for(var At=Ye.FullPaths.length+3>>2,Mr=Ve+7>>3,xt=Ve+127>>7,Bt=Mr+qe+At+xt,Br=Bt+127>>7,aa=Br<=109?0:Math.ceil((Br-109)/127);Bt+Br+aa+127>>7>Br;)aa=++Br<=109?0:Math.ceil((Br-109)/127);var Tt=[1,aa,Br,xt,At,qe,Ve,0];return Ye.FileIndex[0].size=Ve<<6,Tt[7]=(Ye.FileIndex[0].start=Tt[0]+Tt[1]+Tt[2]+Tt[3]+Tt[4]+Tt[5])+(Tt[6]+7>>3),Tt})(O),W=Zr(H[7]<<9),K=0,oe=0;{for(K=0;K<8;++K)W.write_shift(1,Ne[K]);for(K=0;K<8;++K)W.write_shift(2,0);for(W.write_shift(2,62),W.write_shift(2,3),W.write_shift(2,65534),W.write_shift(2,9),W.write_shift(2,6),K=0;K<3;++K)W.write_shift(2,0);for(W.write_shift(4,0),W.write_shift(4,H[2]),W.write_shift(4,H[0]+H[1]+H[2]+H[3]-1),W.write_shift(4,0),W.write_shift(4,4096),W.write_shift(4,H[3]?H[0]+H[1]+H[2]-1:U),W.write_shift(4,H[3]),W.write_shift(-4,H[1]?H[0]-1:U),W.write_shift(4,H[1]),K=0;K<109;++K)W.write_shift(-4,K<H[2]?H[1]+K:-1)}if(H[1])for(oe=0;oe<H[1];++oe){for(;K<236+oe*127;++K)W.write_shift(-4,K<H[2]?H[1]+K:-1);W.write_shift(-4,oe===H[1]-1?U:oe+1)}var ve=function(Ye){for(oe+=Ye;K<oe-1;++K)W.write_shift(-4,K+1);Ye&&(++K,W.write_shift(-4,U))};for(oe=K=0,oe+=H[1];K<oe;++K)W.write_shift(-4,ue.DIFSECT);for(oe+=H[2];K<oe;++K)W.write_shift(-4,ue.FATSECT);ve(H[3]),ve(H[4]);for(var xe=0,me=0,fe=O.FileIndex[0];xe<O.FileIndex.length;++xe)fe=O.FileIndex[xe],fe.content&&(me=fe.content.length,!(me<4096)&&(fe.start=oe,ve(me+511>>9)));for(ve(H[6]+7>>3);W.l&511;)W.write_shift(-4,ue.ENDOFCHAIN);for(oe=K=0,xe=0;xe<O.FileIndex.length;++xe)fe=O.FileIndex[xe],fe.content&&(me=fe.content.length,!(!me||me>=4096)&&(fe.start=oe,ve(me+63>>6)));for(;W.l&511;)W.write_shift(-4,ue.ENDOFCHAIN);for(K=0;K<H[4]<<2;++K){var Oe=O.FullPaths[K];if(!Oe||Oe.length===0){for(xe=0;xe<17;++xe)W.write_shift(4,0);for(xe=0;xe<3;++xe)W.write_shift(4,-1);for(xe=0;xe<12;++xe)W.write_shift(4,0);continue}fe=O.FileIndex[K],K===0&&(fe.start=fe.size?fe.start-1:U);var Ge=K===0&&V.root||fe.name;if(me=2*(Ge.length+1),W.write_shift(64,Ge,"utf16le"),W.write_shift(2,me),W.write_shift(1,fe.type),W.write_shift(1,fe.color),W.write_shift(-4,fe.L),W.write_shift(-4,fe.R),W.write_shift(-4,fe.C),fe.clsid)W.write_shift(16,fe.clsid,"hex");else for(xe=0;xe<4;++xe)W.write_shift(4,0);W.write_shift(4,fe.state||0),W.write_shift(4,0),W.write_shift(4,0),W.write_shift(4,0),W.write_shift(4,0),W.write_shift(4,fe.start),W.write_shift(4,fe.size),W.write_shift(4,0)}for(K=1;K<O.FileIndex.length;++K)if(fe=O.FileIndex[K],fe.size>=4096)if(W.l=fe.start+1<<9,Ft&&Buffer.isBuffer(fe.content))fe.content.copy(W,W.l,0,fe.size),W.l+=fe.size+511&-512;else{for(xe=0;xe<fe.size;++xe)W.write_shift(1,fe.content[xe]);for(;xe&511;++xe)W.write_shift(1,0)}for(K=1;K<O.FileIndex.length;++K)if(fe=O.FileIndex[K],fe.size>0&&fe.size<4096)if(Ft&&Buffer.isBuffer(fe.content))fe.content.copy(W,W.l,0,fe.size),W.l+=fe.size+63&-64;else{for(xe=0;xe<fe.size;++xe)W.write_shift(1,fe.content[xe]);for(;xe&63;++xe)W.write_shift(1,0)}if(Ft)W.l=W.length;else for(;W.l<W.length;)W.write_shift(1,0);return W}function L(O,Y){var V=O.FullPaths.map(function(xe){return xe.toUpperCase()}),H=V.map(function(xe){var me=xe.split("/");return me[me.length-(xe.slice(-1)=="/"?2:1)]}),W=!1;Y.charCodeAt(0)===47?(W=!0,Y=V[0].slice(0,-1)+Y):W=Y.indexOf("/")!==-1;var K=Y.toUpperCase(),oe=W===!0?V.indexOf(K):H.indexOf(K);if(oe!==-1)return O.FileIndex[oe];var ve=!K.match(sf);for(K=K.replace(ta,""),ve&&(K=K.replace(sf,"!")),oe=0;oe<V.length;++oe)if((ve?V[oe].replace(sf,"!"):V[oe]).replace(ta,"")==K||(ve?H[oe].replace(sf,"!"):H[oe]).replace(ta,"")==K)return O.FileIndex[oe];return null}var P=64,U=-2,Ce="d0cf11e0a1b11ae1",Ne=[208,207,17,224,161,177,26,225],ae="00000000000000000000000000000000",ue={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:U,FREESECT:-1,HEADER_SIGNATURE:Ce,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:ae,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function pe(O,Y,V){m();var H=j(O,V);h.writeFileSync(Y,H)}function ne(O){for(var Y=new Array(O.length),V=0;V<O.length;++V)Y[V]=String.fromCharCode(O[V]);return Y.join("")}function be(O,Y){var V=j(O,Y);switch(Y&&Y.type||"buffer"){case"file":return m(),h.writeFileSync(Y.filename,V),V;case"binary":return typeof V=="string"?V:ne(V);case"base64":return uE(typeof V=="string"?V:ne(V));case"buffer":if(Ft)return Buffer.isBuffer(V)?V:ko(V);case"array":return typeof V=="string"?hs(V):V}return V}var Q;function I(O){try{var Y=O.InflateRaw,V=new Y;if(V._processChunk(new Uint8Array([3,0]),V._finishFlushFlag),V.bytesRead)Q=O;else throw new Error("zlib does not expose bytesRead")}catch(H){console.error("cannot use native zlib: "+(H.message||H))}}function Z(O,Y){if(!Q)return rs(O,Y);var V=Q.InflateRaw,H=new V,W=H._processChunk(O.slice(O.l),H._finishFlushFlag);return O.l+=H.bytesRead,W}function ee(O){return Q?Q.deflateRawSync(O):lt(O)}var B=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],se=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],_e=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function Pe(O){var Y=(O<<1|O<<11)&139536|(O<<5|O<<15)&558144;return(Y>>16|Y>>8|Y)&255}for(var he=typeof Uint8Array<"u",we=he?new Uint8Array(256):[],He=0;He<256;++He)we[He]=Pe(He);function J(O,Y){var V=we[O&255];return Y<=8?V>>>8-Y:(V=V<<8|we[O>>8&255],Y<=16?V>>>16-Y:(V=V<<8|we[O>>16&255],V>>>24-Y))}function Qe(O,Y){var V=Y&7,H=Y>>>3;return(O[H]|(V<=6?0:O[H+1]<<8))>>>V&3}function $e(O,Y){var V=Y&7,H=Y>>>3;return(O[H]|(V<=5?0:O[H+1]<<8))>>>V&7}function Fe(O,Y){var V=Y&7,H=Y>>>3;return(O[H]|(V<=4?0:O[H+1]<<8))>>>V&15}function Ue(O,Y){var V=Y&7,H=Y>>>3;return(O[H]|(V<=3?0:O[H+1]<<8))>>>V&31}function De(O,Y){var V=Y&7,H=Y>>>3;return(O[H]|(V<=1?0:O[H+1]<<8))>>>V&127}function ut(O,Y,V){var H=Y&7,W=Y>>>3,K=(1<<V)-1,oe=O[W]>>>H;return V<8-H||(oe|=O[W+1]<<8-H,V<16-H)||(oe|=O[W+2]<<16-H,V<24-H)||(oe|=O[W+3]<<24-H),oe&K}function Lt(O,Y,V){var H=Y&7,W=Y>>>3;return H<=5?O[W]|=(V&7)<<H:(O[W]|=V<<H&255,O[W+1]=(V&7)>>8-H),Y+3}function Qt(O,Y,V){var H=Y&7,W=Y>>>3;return V=(V&1)<<H,O[W]|=V,Y+1}function yr(O,Y,V){var H=Y&7,W=Y>>>3;return V<<=H,O[W]|=V&255,V>>>=8,O[W+1]=V,Y+8}function Hn(O,Y,V){var H=Y&7,W=Y>>>3;return V<<=H,O[W]|=V&255,V>>>=8,O[W+1]=V&255,O[W+2]=V>>>8,Y+16}function Jt(O,Y){var V=O.length,H=2*V>Y?2*V:Y+5,W=0;if(V>=Y)return O;if(Ft){var K=fE(H);if(O.copy)O.copy(K);else for(;W<O.length;++W)K[W]=O[W];return K}else if(he){var oe=new Uint8Array(H);if(oe.set)oe.set(O);else for(;W<V;++W)oe[W]=O[W];return oe}return O.length=H,O}function pt(O){for(var Y=new Array(O),V=0;V<O;++V)Y[V]=0;return Y}function hr(O,Y,V){var H=1,W=0,K=0,oe=0,ve=0,xe=O.length,me=he?new Uint16Array(32):pt(32);for(K=0;K<32;++K)me[K]=0;for(K=xe;K<V;++K)O[K]=0;xe=O.length;var fe=he?new Uint16Array(xe):pt(xe);for(K=0;K<xe;++K)me[W=O[K]]++,H<W&&(H=W),fe[K]=0;for(me[0]=0,K=1;K<=H;++K)me[K+16]=ve=ve+me[K-1]<<1;for(K=0;K<xe;++K)ve=O[K],ve!=0&&(fe[K]=me[ve+16]++);var Oe=0;for(K=0;K<xe;++K)if(Oe=O[K],Oe!=0)for(ve=J(fe[K],H)>>H-Oe,oe=(1<<H+4-Oe)-1;oe>=0;--oe)Y[ve|oe<<Oe]=Oe&15|K<<4;return H}var kt=he?new Uint16Array(512):pt(512),$t=he?new Uint16Array(32):pt(32);if(!he){for(var Ut=0;Ut<512;++Ut)kt[Ut]=0;for(Ut=0;Ut<32;++Ut)$t[Ut]=0}(function(){for(var O=[],Y=0;Y<32;Y++)O.push(5);hr(O,$t,32);var V=[];for(Y=0;Y<=143;Y++)V.push(8);for(;Y<=255;Y++)V.push(9);for(;Y<=279;Y++)V.push(7);for(;Y<=287;Y++)V.push(8);hr(V,kt,288)})();var dr=(function(){for(var Y=he?new Uint8Array(32768):[],V=0,H=0;V<_e.length-1;++V)for(;H<_e[V+1];++H)Y[H]=V;for(;H<32768;++H)Y[H]=29;var W=he?new Uint8Array(259):[];for(V=0,H=0;V<se.length-1;++V)for(;H<se[V+1];++H)W[H]=V;function K(ve,xe){for(var me=0;me<ve.length;){var fe=Math.min(65535,ve.length-me),Oe=me+fe==ve.length;for(xe.write_shift(1,+Oe),xe.write_shift(2,fe),xe.write_shift(2,~fe&65535);fe-- >0;)xe[xe.l++]=ve[me++]}return xe.l}function oe(ve,xe){for(var me=0,fe=0,Oe=he?new Uint16Array(32768):[];fe<ve.length;){var Ge=Math.min(65535,ve.length-fe);if(Ge<10){for(me=Lt(xe,me,+(fe+Ge==ve.length)),me&7&&(me+=8-(me&7)),xe.l=me/8|0,xe.write_shift(2,Ge),xe.write_shift(2,~Ge&65535);Ge-- >0;)xe[xe.l++]=ve[fe++];me=xe.l*8;continue}me=Lt(xe,me,+(fe+Ge==ve.length)+2);for(var Ye=0;Ge-- >0;){var Ve=ve[fe];Ye=(Ye<<5^Ve)&32767;var qe=-1,Xe=0;if((qe=Oe[Ye])&&(qe|=fe&-32768,qe>fe&&(qe-=32768),qe<fe))for(;ve[qe+Xe]==ve[fe+Xe]&&Xe<250;)++Xe;if(Xe>2){Ve=W[Xe],Ve<=22?me=yr(xe,me,we[Ve+1]>>1)-1:(yr(xe,me,3),me+=5,yr(xe,me,we[Ve-23]>>5),me+=3);var Rt=Ve<8?0:Ve-4>>2;Rt>0&&(Hn(xe,me,Xe-se[Ve]),me+=Rt),Ve=Y[fe-qe],me=yr(xe,me,we[Ve]>>3),me-=3;var wt=Ve<4?0:Ve-2>>1;wt>0&&(Hn(xe,me,fe-qe-_e[Ve]),me+=wt);for(var At=0;At<Xe;++At)Oe[Ye]=fe&32767,Ye=(Ye<<5^ve[fe])&32767,++fe;Ge-=Xe-1}else Ve<=143?Ve=Ve+48:me=Qt(xe,me,1),me=yr(xe,me,we[Ve]),Oe[Ye]=fe&32767,++fe}me=yr(xe,me,0)-1}return xe.l=(me+7)/8|0,xe.l}return function(xe,me){return xe.length<8?K(xe,me):oe(xe,me)}})();function lt(O){var Y=Zr(50+Math.floor(O.length*1.1)),V=dr(O,Y);return Y.slice(0,V)}var Zt=he?new Uint16Array(32768):pt(32768),Sr=he?new Uint16Array(32768):pt(32768),St=he?new Uint16Array(128):pt(128),or=1,nn=1;function Ur(O,Y){var V=Ue(O,Y)+257;Y+=5;var H=Ue(O,Y)+1;Y+=5;var W=Fe(O,Y)+4;Y+=4;for(var K=0,oe=he?new Uint8Array(19):pt(19),ve=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],xe=1,me=he?new Uint8Array(8):pt(8),fe=he?new Uint8Array(8):pt(8),Oe=oe.length,Ge=0;Ge<W;++Ge)oe[B[Ge]]=K=$e(O,Y),xe<K&&(xe=K),me[K]++,Y+=3;var Ye=0;for(me[0]=0,Ge=1;Ge<=xe;++Ge)fe[Ge]=Ye=Ye+me[Ge-1]<<1;for(Ge=0;Ge<Oe;++Ge)(Ye=oe[Ge])!=0&&(ve[Ge]=fe[Ye]++);var Ve=0;for(Ge=0;Ge<Oe;++Ge)if(Ve=oe[Ge],Ve!=0){Ye=we[ve[Ge]]>>8-Ve;for(var qe=(1<<7-Ve)-1;qe>=0;--qe)St[Ye|qe<<Ve]=Ve&7|Ge<<3}var Xe=[];for(xe=1;Xe.length<V+H;)switch(Ye=St[De(O,Y)],Y+=Ye&7,Ye>>>=3){case 16:for(K=3+Qe(O,Y),Y+=2,Ye=Xe[Xe.length-1];K-- >0;)Xe.push(Ye);break;case 17:for(K=3+$e(O,Y),Y+=3;K-- >0;)Xe.push(0);break;case 18:for(K=11+De(O,Y),Y+=7;K-- >0;)Xe.push(0);break;default:Xe.push(Ye),xe<Ye&&(xe=Ye);break}var Rt=Xe.slice(0,V),wt=Xe.slice(V);for(Ge=V;Ge<286;++Ge)Rt[Ge]=0;for(Ge=H;Ge<30;++Ge)wt[Ge]=0;return or=hr(Rt,Zt,286),nn=hr(wt,Sr,30),Y}function Dl(O,Y){if(O[0]==3&&!(O[1]&3))return[Al(Y),2];for(var V=0,H=0,W=fE(Y||1<<18),K=0,oe=W.length>>>0,ve=0,xe=0;(H&1)==0;){if(H=$e(O,V),V+=3,H>>>1)H>>1==1?(ve=9,xe=5):(V=Ur(O,V),ve=or,xe=nn);else{V&7&&(V+=8-(V&7));var me=O[V>>>3]|O[(V>>>3)+1]<<8;if(V+=32,me>0)for(!Y&&oe<K+me&&(W=Jt(W,K+me),oe=W.length);me-- >0;)W[K++]=O[V>>>3],V+=8;continue}for(;;){!Y&&oe<K+32767&&(W=Jt(W,K+32767),oe=W.length);var fe=ut(O,V,ve),Oe=H>>>1==1?kt[fe]:Zt[fe];if(V+=Oe&15,Oe>>>=4,(Oe>>>8&255)===0)W[K++]=Oe;else{if(Oe==256)break;Oe-=257;var Ge=Oe<8?0:Oe-4>>2;Ge>5&&(Ge=0);var Ye=K+se[Oe];Ge>0&&(Ye+=ut(O,V,Ge),V+=Ge),fe=ut(O,V,xe),Oe=H>>>1==1?$t[fe]:Sr[fe],V+=Oe&15,Oe>>>=4;var Ve=Oe<4?0:Oe-2>>1,qe=_e[Oe];for(Ve>0&&(qe+=ut(O,V,Ve),V+=Ve),!Y&&oe<Ye&&(W=Jt(W,Ye+100),oe=W.length);K<Ye;)W[K]=W[K-qe],++K}}}return Y?[W,V+7>>>3]:[W.slice(0,K),V+7>>>3]}function rs(O,Y){var V=O.slice(O.l||0),H=Dl(V,Y);return O.l+=H[1],H[0]}function ja(O,Y){if(O)typeof console<"u"&&console.error(Y);else throw new Error(Y)}function ga(O,Y){var V=O;_n(V,0);var H=[],W=[],K={FileIndex:H,FullPaths:W};b(K,{root:Y.root});for(var oe=V.length-4;(V[oe]!=80||V[oe+1]!=75||V[oe+2]!=5||V[oe+3]!=6)&&oe>=0;)--oe;V.l=oe+4,V.l+=4;var ve=V.read_shift(2);V.l+=6;var xe=V.read_shift(4);for(V.l=xe,oe=0;oe<ve;++oe){V.l+=20;var me=V.read_shift(4),fe=V.read_shift(4),Oe=V.read_shift(2),Ge=V.read_shift(2),Ye=V.read_shift(2);V.l+=8;var Ve=V.read_shift(4),qe=u(V.slice(V.l+Oe,V.l+Oe+Ge));V.l+=Oe+Ge+Ye;var Xe=V.l;V.l=Ve+4,Nn(V,me,fe,K,qe),V.l=Xe}return K}function Nn(O,Y,V,H,W){O.l+=2;var K=O.read_shift(2),oe=O.read_shift(2),ve=o(O);if(K&8257)throw new Error("Unsupported ZIP encryption");for(var xe=O.read_shift(4),me=O.read_shift(4),fe=O.read_shift(4),Oe=O.read_shift(2),Ge=O.read_shift(2),Ye="",Ve=0;Ve<Oe;++Ve)Ye+=String.fromCharCode(O[O.l++]);if(Ge){var qe=u(O.slice(O.l,O.l+Ge));(qe[21589]||{}).mt&&(ve=qe[21589].mt),((W||{})[21589]||{}).mt&&(ve=W[21589].mt)}O.l+=Ge;var Xe=O.slice(O.l,O.l+me);switch(oe){case 8:Xe=Z(O,fe);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+oe)}var Rt=!1;K&8&&(xe=O.read_shift(4),xe==134695760&&(xe=O.read_shift(4),Rt=!0),me=O.read_shift(4),fe=O.read_shift(4)),me!=Y&&ja(Rt,"Bad compressed size: "+Y+" != "+me),fe!=V&&ja(Rt,"Bad uncompressed size: "+V+" != "+fe),de(H,Ye,Xe,{unsafe:!0,mt:ve})}function na(O,Y){var V=Y||{},H=[],W=[],K=Zr(1),oe=V.compression?8:0,ve=0,xe=0,me=0,fe=0,Oe=0,Ge=O.FullPaths[0],Ye=Ge,Ve=O.FileIndex[0],qe=[],Xe=0;for(xe=1;xe<O.FullPaths.length;++xe)if(Ye=O.FullPaths[xe].slice(Ge.length),Ve=O.FileIndex[xe],!(!Ve.size||!Ve.content||Ye=="Sh33tJ5")){var Rt=fe,wt=Zr(Ye.length);for(me=0;me<Ye.length;++me)wt.write_shift(1,Ye.charCodeAt(me)&127);wt=wt.slice(0,wt.l),qe[Oe]=xL.buf(Ve.content,0);var At=Ve.content;oe==8&&(At=ee(At)),K=Zr(30),K.write_shift(4,67324752),K.write_shift(2,20),K.write_shift(2,ve),K.write_shift(2,oe),Ve.mt?l(K,Ve.mt):K.write_shift(4,0),K.write_shift(-4,qe[Oe]),K.write_shift(4,At.length),K.write_shift(4,Ve.content.length),K.write_shift(2,wt.length),K.write_shift(2,0),fe+=K.length,H.push(K),fe+=wt.length,H.push(wt),fe+=At.length,H.push(At),K=Zr(46),K.write_shift(4,33639248),K.write_shift(2,0),K.write_shift(2,20),K.write_shift(2,ve),K.write_shift(2,oe),K.write_shift(4,0),K.write_shift(-4,qe[Oe]),K.write_shift(4,At.length),K.write_shift(4,Ve.content.length),K.write_shift(2,wt.length),K.write_shift(2,0),K.write_shift(2,0),K.write_shift(2,0),K.write_shift(2,0),K.write_shift(4,0),K.write_shift(4,Rt),Xe+=K.l,W.push(K),Xe+=wt.length,W.push(wt),++Oe}return K=Zr(22),K.write_shift(4,101010256),K.write_shift(2,0),K.write_shift(2,0),K.write_shift(2,Oe),K.write_shift(2,Oe),K.write_shift(4,Xe),K.write_shift(4,fe),K.write_shift(2,0),dl([dl(H),dl(W),K])}var an={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function dn(O,Y){if(O.ctype)return O.ctype;var V=O.name||"",H=V.match(/\.([^\.]+)$/);return H&&an[H[1]]||Y&&(H=(V=Y).match(/[\.\\]([^\.\\])+$/),H&&an[H[1]])?an[H[1]]:"application/octet-stream"}function Fa(O){for(var Y=uE(O),V=[],H=0;H<Y.length;H+=76)V.push(Y.slice(H,H+76));return V.join(`\r
`)+`\r
`}function ns(O){var Y=O.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(me){var fe=me.charCodeAt(0).toString(16).toUpperCase();return"="+(fe.length==1?"0"+fe:fe)});Y=Y.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),Y.charAt(0)==`
`&&(Y="=0D"+Y.slice(1)),Y=Y.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var V=[],H=Y.split(`\r
`),W=0;W<H.length;++W){var K=H[W];if(K.length==0){V.push("");continue}for(var oe=0;oe<K.length;){var ve=76,xe=K.slice(oe,oe+ve);xe.charAt(ve-1)=="="?ve--:xe.charAt(ve-2)=="="?ve-=2:xe.charAt(ve-3)=="="&&(ve-=3),xe=K.slice(oe,oe+ve),oe+=ve,oe<K.length&&(xe+="="),V.push(xe)}}return V.join(`\r
`)}function Pa(O){for(var Y=[],V=0;V<O.length;++V){for(var H=O[V];V<=O.length&&H.charAt(H.length-1)=="=";)H=H.slice(0,H.length-1)+O[++V];Y.push(H)}for(var W=0;W<Y.length;++W)Y[W]=Y[W].replace(/[=][0-9A-Fa-f]{2}/g,function(K){return String.fromCharCode(parseInt(K.slice(1),16))});return hs(Y.join(`\r
`))}function Cn(O,Y,V){for(var H="",W="",K="",oe,ve=0;ve<10;++ve){var xe=Y[ve];if(!xe||xe.match(/^\s*$/))break;var me=xe.match(/^(.*?):\s*([^\s].*)$/);if(me)switch(me[1].toLowerCase()){case"content-location":H=me[2].trim();break;case"content-type":K=me[2].trim();break;case"content-transfer-encoding":W=me[2].trim();break}}switch(++ve,W.toLowerCase()){case"base64":oe=hs(Oa(Y.slice(ve).join("")));break;case"quoted-printable":oe=Pa(Y.slice(ve));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+W)}var fe=de(O,H.slice(V.length),oe,{unsafe:!0});K&&(fe.ctype=K)}function La(O,Y){if(ne(O.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var V=Y&&Y.root||"",H=(Ft&&Buffer.isBuffer(O)?O.toString("binary"):ne(O)).split(`\r
`),W=0,K="";for(W=0;W<H.length;++W)if(K=H[W],!!/^Content-Location:/i.test(K)&&(K=K.slice(K.indexOf("file")),V||(V=K.slice(0,K.lastIndexOf("/")+1)),K.slice(0,V.length)!=V))for(;V.length>0&&(V=V.slice(0,V.length-1),V=V.slice(0,V.lastIndexOf("/")+1),K.slice(0,V.length)!=V););var oe=(H[1]||"").match(/boundary="(.*?)"/);if(!oe)throw new Error("MAD cannot find boundary");var ve="--"+(oe[1]||""),xe=[],me=[],fe={FileIndex:xe,FullPaths:me};b(fe);var Oe,Ge=0;for(W=0;W<H.length;++W){var Ye=H[W];Ye!==ve&&Ye!==ve+"--"||(Ge++&&Cn(fe,H.slice(Oe,W),V),Oe=W)}return fe}function Or(O,Y){var V=Y||{},H=V.boundary||"SheetJS";H="------="+H;for(var W=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+H.slice(2)+'"',"","",""],K=O.FullPaths[0],oe=K,ve=O.FileIndex[0],xe=1;xe<O.FullPaths.length;++xe)if(oe=O.FullPaths[xe].slice(K.length),ve=O.FileIndex[xe],!(!ve.size||!ve.content||oe=="Sh33tJ5")){oe=oe.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(Xe){return"_x"+Xe.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(Xe){return"_u"+Xe.charCodeAt(0).toString(16)+"_"});for(var me=ve.content,fe=Ft&&Buffer.isBuffer(me)?me.toString("binary"):ne(me),Oe=0,Ge=Math.min(1024,fe.length),Ye=0,Ve=0;Ve<=Ge;++Ve)(Ye=fe.charCodeAt(Ve))>=32&&Ye<128&&++Oe;var qe=Oe>=Ge*4/5;W.push(H),W.push("Content-Location: "+(V.root||"file:///C:/SheetJS/")+oe),W.push("Content-Transfer-Encoding: "+(qe?"quoted-printable":"base64")),W.push("Content-Type: "+dn(ve,oe)),W.push(""),W.push(qe?ns(fe):Fa(fe))}return W.push(H+`--\r
`),W.join(`\r
`)}function le(O){var Y={};return b(Y,O),Y}function de(O,Y,V,H){var W=H&&H.unsafe;W||b(O);var K=!W&&zt.find(O,Y);if(!K){var oe=O.FullPaths[0];Y.slice(0,oe.length)==oe?oe=Y:(oe.slice(-1)!="/"&&(oe+="/"),oe=(oe+Y).replace("//","/")),K={name:a(Y),type:2},O.FileIndex.push(K),O.FullPaths.push(oe),W||zt.utils.cfb_gc(O)}return K.content=V,K.size=V?V.length:0,H&&(H.CLSID&&(K.clsid=H.CLSID),H.mt&&(K.mt=H.mt),H.ct&&(K.ct=H.ct)),K}function Ae(O,Y){b(O);var V=zt.find(O,Y);if(V){for(var H=0;H<O.FileIndex.length;++H)if(O.FileIndex[H]==V)return O.FileIndex.splice(H,1),O.FullPaths.splice(H,1),!0}return!1}function Be(O,Y,V){b(O);var H=zt.find(O,Y);if(H){for(var W=0;W<O.FileIndex.length;++W)if(O.FileIndex[W]==H)return O.FileIndex[W].name=a(V),O.FullPaths[W]=V,!0}return!1}function Ke(O){k(O,!0)}return e.find=L,e.read=te,e.parse=p,e.write=be,e.writeFile=pe,e.utils={cfb_new:le,cfb_add:de,cfb_del:Ae,cfb_mov:Be,cfb_gc:Ke,ReadShift:xf,CheckField:tC,prep_blob:_n,bconcat:dl,use_zlib:I,_deflateRaw:lt,_inflateRaw:rs,consts:ue},e})();function vL(t){if(typeof Deno<"u")return Deno.readFileSync(t);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var e=File(t);e.open("r"),e.encoding="binary";var r=e.read();return e.close(),r}catch(n){if(!n.message||!n.message.match(/onstruct/))throw n}throw new Error("Cannot access file "+t)}function Ls(t){for(var e=Object.keys(t),r=[],n=0;n<e.length;++n)Object.prototype.hasOwnProperty.call(t,e[n])&&r.push(e[n]);return r}function x1(t){for(var e=[],r=Ls(t),n=0;n!==r.length;++n)e[t[r[n]]]=r[n];return e}var L0=new Date(1899,11,30,0,0,0);function ra(t,e){var r=t.getTime(),n=L0.getTime()+(t.getTimezoneOffset()-L0.getTimezoneOffset())*6e4;return(r-n)/(1440*60*1e3)}var MN=new Date,yL=L0.getTime()+(MN.getTimezoneOffset()-L0.getTimezoneOffset())*6e4,yE=MN.getTimezoneOffset();function Em(t){var e=new Date;return e.setTime(t*24*60*60*1e3+yL),e.getTimezoneOffset()!==yE&&e.setTime(e.getTime()+(e.getTimezoneOffset()-yE)*6e4),e}function _L(t){var e=0,r=0,n=!1,a=t.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!a)throw new Error("|"+t+"| is not an ISO8601 Duration");for(var l=1;l!=a.length;++l)if(a[l]){switch(r=1,l>3&&(n=!0),a[l].slice(a[l].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+a[l].slice(a[l].length-1));case"D":r*=24;case"H":r*=60;case"M":if(n)r*=60;else throw new Error("Unsupported ISO Duration Field: M")}e+=r*parseInt(a[l],10)}return e}var _E=new Date("2017-02-19T19:06:09.000Z"),jN=isNaN(_E.getFullYear())?new Date("2/19/17"):_E,wL=jN.getFullYear()==2017;function hn(t,e){var r=new Date(t);if(wL)return e>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):e<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(t instanceof Date)return t;if(jN.getFullYear()==1917&&!isNaN(r.getFullYear())){var n=r.getFullYear();return t.indexOf(""+n)>-1||r.setFullYear(r.getFullYear()+100),r}var a=t.match(/\d+/g)||["2017","2","19","0","0","0"],l=new Date(+a[0],+a[1]-1,+a[2],+a[3]||0,+a[4]||0,+a[5]||0);return t.indexOf("Z")>-1&&(l=new Date(l.getTime()-l.getTimezoneOffset()*60*1e3)),l}function Eo(t,e){if(Ft&&Buffer.isBuffer(t)){if(e){if(t[0]==255&&t[1]==254)return of(t.slice(2).toString("utf16le"));if(t[1]==254&&t[2]==255)return of(wN(t.slice(2).toString("binary")))}return t.toString("binary")}if(typeof TextDecoder<"u")try{if(e){if(t[0]==255&&t[1]==254)return of(new TextDecoder("utf-16le").decode(t.slice(2)));if(t[0]==254&&t[1]==255)return of(new TextDecoder("utf-16be").decode(t.slice(2)))}var r={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(t)&&(t=new Uint8Array(t)),new TextDecoder("latin1").decode(t).replace(/[]/g,function(l){return r[l]||l})}catch{}for(var n=[],a=0;a!=t.length;++a)n.push(String.fromCharCode(t[a]));return n.join("")}function En(t){if(typeof JSON<"u"&&!Array.isArray(t))return JSON.parse(JSON.stringify(t));if(typeof t!="object"||t==null)return t;if(t instanceof Date)return new Date(t.getTime());var e={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=En(t[r]));return e}function kr(t,e){for(var r="";r.length<e;)r+=t;return r}function xs(t){var e=Number(t);if(!isNaN(e))return isFinite(e)?e:NaN;if(!/\d/.test(t))return e;var r=1,n=t.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(e=Number(n))||(n=n.replace(/[(](.*)[)]/,function(a,l){return r=-r,l}),!isNaN(e=Number(n)))?e/r:e}var TL=["january","february","march","april","may","june","july","august","september","october","november","december"];function Gc(t){var e=new Date(t),r=new Date(NaN),n=e.getYear(),a=e.getMonth(),l=e.getDate();if(isNaN(l))return r;var o=t.toLowerCase();if(o.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(o=o.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),o.length>3&&TL.indexOf(o)==-1)return r}else if(o.match(/[a-z]/))return r;return n<0||n>8099?r:(a>0||l>1)&&n!=101?e:t.match(/[^-0-9:,\/\\]/)?r:e}var EL=(function(){var t="abacaba".split(/(:?b)/i).length==5;return function(r,n,a){if(t||typeof n=="string")return r.split(n);for(var l=r.split(n),o=[l[0]],u=1;u<l.length;++u)o.push(a),o.push(l[u]);return o}})();function FN(t){return t?t.content&&t.type?Eo(t.content,!0):t.data?af(t.data):t.asNodeBuffer&&Ft?af(t.asNodeBuffer().toString("binary")):t.asBinary?af(t.asBinary()):t._data&&t._data.getContent?af(Eo(Array.prototype.slice.call(t._data.getContent(),0))):null:null}function PN(t){if(!t)return null;if(t.data)return oE(t.data);if(t.asNodeBuffer&&Ft)return t.asNodeBuffer();if(t._data&&t._data.getContent){var e=t._data.getContent();return typeof e=="string"?oE(e):Array.prototype.slice.call(e)}return t.content&&t.type?t.content:null}function bL(t){return t&&t.name.slice(-4)===".bin"?PN(t):FN(t)}function Xa(t,e){for(var r=t.FullPaths||Ls(t.files),n=e.toLowerCase().replace(/[\/]/g,"\\"),a=n.replace(/\\/g,"/"),l=0;l<r.length;++l){var o=r[l].replace(/^Root Entry[\/]/,"").toLowerCase();if(n==o||a==o)return t.files?t.files[r[l]]:t.FileIndex[l]}return null}function v1(t,e){var r=Xa(t,e);if(r==null)throw new Error("Cannot find file "+e+" in zip");return r}function Yr(t,e,r){if(!r)return bL(v1(t,e));if(!e)return null;try{return Yr(t,e)}catch{return null}}function Ca(t,e,r){if(!r)return FN(v1(t,e));if(!e)return null;try{return Ca(t,e)}catch{return null}}function SL(t,e,r){return PN(v1(t,e))}function wE(t){for(var e=t.FullPaths||Ls(t.files),r=[],n=0;n<e.length;++n)e[n].slice(-1)!="/"&&r.push(e[n].replace(/^Root Entry[\/]/,""));return r.sort()}function AL(t,e,r){if(t.FullPaths){if(typeof r=="string"){var n;return Ft?n=ko(r):n=q8(r),zt.utils.cfb_add(t,e,n)}zt.utils.cfb_add(t,e,r)}else t.file(e,r)}function LN(t,e){switch(e.type){case"base64":return zt.read(t,{type:"base64"});case"binary":return zt.read(t,{type:"binary"});case"buffer":case"array":return zt.read(t,{type:"buffer"})}throw new Error("Unrecognized type "+e.type)}function lf(t,e){if(t.charAt(0)=="/")return t.slice(1);var r=e.split("/");e.slice(-1)!="/"&&r.pop();for(var n=t.split("/");n.length!==0;){var a=n.shift();a===".."?r.pop():a!=="."&&r.push(a)}return r.join("/")}var UN=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,NL=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,TE=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,CL=/<[^>]*>/g,zn=UN.match(TE)?TE:CL,kL=/<\w*:/,RL=/<(\/?)\w+:/;function it(t,e,r){for(var n={},a=0,l=0;a!==t.length&&!((l=t.charCodeAt(a))===32||l===10||l===13);++a);if(e||(n[0]=t.slice(0,a)),a===t.length)return n;var o=t.match(NL),u=0,h="",m=0,p="",v="",_=1;if(o)for(m=0;m!=o.length;++m){for(v=o[m],l=0;l!=v.length&&v.charCodeAt(l)!==61;++l);for(p=v.slice(0,l).trim();v.charCodeAt(l+1)==32;)++l;for(_=(a=v.charCodeAt(l+1))==34||a==39?1:0,h=v.slice(l+1+_,v.length-_),u=0;u!=p.length&&p.charCodeAt(u)!==58;++u);if(u===p.length)p.indexOf("_")>0&&(p=p.slice(0,p.indexOf("_"))),n[p]=h,n[p.toLowerCase()]=h;else{var w=(u===5&&p.slice(0,5)==="xmlns"?"xmlns":"")+p.slice(u+1);if(n[w]&&p.slice(u-3,u)=="ext")continue;n[w]=h,n[w.toLowerCase()]=h}}return n}function Bs(t){return t.replace(RL,"<$1")}var BN={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},DL=x1(BN),Gt=(function(){var t=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,e=/_x([\da-fA-F]{4})_/ig;return function r(n){var a=n+"",l=a.indexOf("<![CDATA[");if(l==-1)return a.replace(t,function(u,h){return BN[u]||String.fromCharCode(parseInt(h,u.indexOf("x")>-1?16:10))||u}).replace(e,function(u,h){return String.fromCharCode(parseInt(h,16))});var o=a.indexOf("]]>");return r(a.slice(0,l))+a.slice(l+9,o)+r(a.slice(o+3))}})(),IL=/[&<>'"]/g,OL=/[\u0000-\u001f]/g;function y1(t){var e=t+"";return e.replace(IL,function(r){return DL[r]}).replace(/\n/g,"<br/>").replace(OL,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}var EE=(function(){var t=/&#(\d+);/g;function e(r,n){return String.fromCharCode(parseInt(n,10))}return function(n){return n.replace(t,e)}})();function Tr(t){switch(t){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function $g(t){for(var e="",r=0,n=0,a=0,l=0,o=0,u=0;r<t.length;){if(n=t.charCodeAt(r++),n<128){e+=String.fromCharCode(n);continue}if(a=t.charCodeAt(r++),n>191&&n<224){o=(n&31)<<6,o|=a&63,e+=String.fromCharCode(o);continue}if(l=t.charCodeAt(r++),n<240){e+=String.fromCharCode((n&15)<<12|(a&63)<<6|l&63);continue}o=t.charCodeAt(r++),u=((n&7)<<18|(a&63)<<12|(l&63)<<6|o&63)-65536,e+=String.fromCharCode(55296+(u>>>10&1023)),e+=String.fromCharCode(56320+(u&1023))}return e}function bE(t){var e=Al(2*t.length),r,n,a=1,l=0,o=0,u;for(n=0;n<t.length;n+=a)a=1,(u=t.charCodeAt(n))<128?r=u:u<224?(r=(u&31)*64+(t.charCodeAt(n+1)&63),a=2):u<240?(r=(u&15)*4096+(t.charCodeAt(n+1)&63)*64+(t.charCodeAt(n+2)&63),a=3):(a=4,r=(u&7)*262144+(t.charCodeAt(n+1)&63)*4096+(t.charCodeAt(n+2)&63)*64+(t.charCodeAt(n+3)&63),r-=65536,o=55296+(r>>>10&1023),r=56320+(r&1023)),o!==0&&(e[l++]=o&255,e[l++]=o>>>8,o=0),e[l++]=r%256,e[l++]=r>>>8;return e.slice(0,l).toString("ucs2")}function SE(t){return ko(t,"binary").toString("utf8")}var Yd="foo bar baz",fr=Ft&&(SE(Yd)==$g(Yd)&&SE||bE(Yd)==$g(Yd)&&bE)||$g,of=Ft?function(t){return ko(t,"utf8").toString("binary")}:function(t){for(var e=[],r=0,n=0,a=0;r<t.length;)switch(n=t.charCodeAt(r++),!0){case n<128:e.push(String.fromCharCode(n));break;case n<2048:e.push(String.fromCharCode(192+(n>>6))),e.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,a=t.charCodeAt(r++)-56320+(n<<10),e.push(String.fromCharCode(240+(a>>18&7))),e.push(String.fromCharCode(144+(a>>12&63))),e.push(String.fromCharCode(128+(a>>6&63))),e.push(String.fromCharCode(128+(a&63)));break;default:e.push(String.fromCharCode(224+(n>>12))),e.push(String.fromCharCode(128+(n>>6&63))),e.push(String.fromCharCode(128+(n&63)))}return e.join("")},Bf=(function(){var t={};return function(r,n){var a=r+"|"+(n||"");return t[a]?t[a]:t[a]=new RegExp("<(?:\\w+:)?"+r+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+r+">",n||"")}})(),VN=(function(){var t=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(e){return[new RegExp("&"+e[0]+";","ig"),e[1]]});return function(r){for(var n=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),a=0;a<t.length;++a)n=n.replace(t[a][0],t[a][1]);return n}})(),ML=(function(){var t={};return function(r){return t[r]!==void 0?t[r]:t[r]=new RegExp("<(?:vt:)?"+r+">([\\s\\S]*?)</(?:vt:)?"+r+">","g")}})(),jL=/<\/?(?:vt:)?variant>/g,FL=/<(?:vt:)([^>]*)>([\s\S]*)</;function AE(t,e){var r=it(t),n=t.match(ML(r.baseType))||[],a=[];if(n.length!=r.size){if(e.WTF)throw new Error("unexpected vector length "+n.length+" != "+r.size);return a}return n.forEach(function(l){var o=l.replace(jL,"").match(FL);o&&a.push({v:fr(o[2]),t:o[1]})}),a}var PL=/(^\s|\s$|\n)/;function LL(t){return Ls(t).map(function(e){return" "+e+'="'+t[e]+'"'}).join("")}function UL(t,e,r){return"<"+t+(r!=null?LL(r):"")+(e!=null?(e.match(PL)?' xml:space="preserve"':"")+">"+e+"</"+t:"/")+">"}function _1(t){if(Ft&&Buffer.isBuffer(t))return t.toString("utf8");if(typeof t=="string")return t;if(typeof Uint8Array<"u"&&t instanceof Uint8Array)return fr(Ro(m1(t)));throw new Error("Bad input format: expected Buffer or string")}var Vf=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,BL={CT:"http://schemas.openxmlformats.org/package/2006/content-types"},VL=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"];function zL(t,e){for(var r=1-2*(t[e+7]>>>7),n=((t[e+7]&127)<<4)+(t[e+6]>>>4&15),a=t[e+6]&15,l=5;l>=0;--l)a=a*256+t[e+l];return n==2047?a==0?r*(1/0):NaN:(n==0?n=-1022:(n-=1023,a+=Math.pow(2,52)),r*Math.pow(2,n-52)*a)}function HL(t,e,r){var n=(e<0||1/e==-1/0?1:0)<<7,a=0,l=0,o=n?-e:e;isFinite(o)?o==0?a=l=0:(a=Math.floor(Math.log(o)/Math.LN2),l=o*Math.pow(2,52-a),a<=-1023&&(!isFinite(l)||l<Math.pow(2,52))?a=-1022:(l-=Math.pow(2,52),a+=1023)):(a=2047,l=isNaN(e)?26985:0);for(var u=0;u<=5;++u,l/=256)t[r+u]=l&255;t[r+6]=(a&15)<<4|l&15,t[r+7]=a>>4|n}var NE=function(t){for(var e=[],r=10240,n=0;n<t[0].length;++n)if(t[0][n])for(var a=0,l=t[0][n].length;a<l;a+=r)e.push.apply(e,t[0][n].slice(a,a+r));return e},CE=Ft?function(t){return t[0].length>0&&Buffer.isBuffer(t[0][0])?Buffer.concat(t[0].map(function(e){return Buffer.isBuffer(e)?e:ko(e)})):NE(t)}:NE,kE=function(t,e,r){for(var n=[],a=e;a<r;a+=2)n.push(String.fromCharCode(hi(t,a)));return n.join("").replace(ta,"")},w1=Ft?function(t,e,r){return Buffer.isBuffer(t)?t.toString("utf16le",e,r).replace(ta,""):kE(t,e,r)}:kE,RE=function(t,e,r){for(var n=[],a=e;a<e+r;++a)n.push(("0"+t[a].toString(16)).slice(-2));return n.join("")},zN=Ft?function(t,e,r){return Buffer.isBuffer(t)?t.toString("hex",e,e+r):RE(t,e,r)}:RE,DE=function(t,e,r){for(var n=[],a=e;a<r;a++)n.push(String.fromCharCode(Ec(t,a)));return n.join("")},fh=Ft?function(e,r,n){return Buffer.isBuffer(e)?e.toString("utf8",r,n):DE(e,r,n)}:DE,HN=function(t,e){var r=Na(t,e);return r>0?fh(t,e+4,e+4+r-1):""},GN=HN,qN=function(t,e){var r=Na(t,e);return r>0?fh(t,e+4,e+4+r-1):""},WN=qN,KN=function(t,e){var r=2*Na(t,e);return r>0?fh(t,e+4,e+4+r-1):""},YN=KN,$N=function(e,r){var n=Na(e,r);return n>0?w1(e,r+4,r+4+n):""},XN=$N,QN=function(t,e){var r=Na(t,e);return r>0?fh(t,e+4,e+4+r):""},JN=QN,ZN=function(t,e){return zL(t,e)},U0=ZN,eC=function(e){return Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array};Ft&&(GN=function(e,r){if(!Buffer.isBuffer(e))return HN(e,r);var n=e.readUInt32LE(r);return n>0?e.toString("utf8",r+4,r+4+n-1):""},WN=function(e,r){if(!Buffer.isBuffer(e))return qN(e,r);var n=e.readUInt32LE(r);return n>0?e.toString("utf8",r+4,r+4+n-1):""},YN=function(e,r){if(!Buffer.isBuffer(e))return KN(e,r);var n=2*e.readUInt32LE(r);return e.toString("utf16le",r+4,r+4+n-1)},XN=function(e,r){if(!Buffer.isBuffer(e))return $N(e,r);var n=e.readUInt32LE(r);return e.toString("utf16le",r+4,r+4+n)},JN=function(e,r){if(!Buffer.isBuffer(e))return QN(e,r);var n=e.readUInt32LE(r);return e.toString("utf8",r+4,r+4+n)},U0=function(e,r){return Buffer.isBuffer(e)?e.readDoubleLE(r):ZN(e,r)},eC=function(e){return Buffer.isBuffer(e)||Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array});var Ec=function(t,e){return t[e]},hi=function(t,e){return t[e+1]*256+t[e]},GL=function(t,e){var r=t[e+1]*256+t[e];return r<32768?r:(65535-r+1)*-1},Na=function(t,e){return t[e+3]*(1<<24)+(t[e+2]<<16)+(t[e+1]<<8)+t[e]},ao=function(t,e){return t[e+3]<<24|t[e+2]<<16|t[e+1]<<8|t[e]},qL=function(t,e){return t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3]};function xf(t,e){var r="",n,a,l=[],o,u,h,m;switch(e){case"dbcs":if(m=this.l,Ft&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*t).toString("utf16le");else for(h=0;h<t;++h)r+=String.fromCharCode(hi(this,m)),m+=2;t*=2;break;case"utf8":r=fh(this,this.l,this.l+t);break;case"utf16le":t*=2,r=w1(this,this.l,this.l+t);break;case"wstr":return xf.call(this,t,"dbcs");case"lpstr-ansi":r=GN(this,this.l),t=4+Na(this,this.l);break;case"lpstr-cp":r=WN(this,this.l),t=4+Na(this,this.l);break;case"lpwstr":r=YN(this,this.l),t=4+2*Na(this,this.l);break;case"lpp4":t=4+Na(this,this.l),r=XN(this,this.l),t&2&&(t+=2);break;case"8lpp4":t=4+Na(this,this.l),r=JN(this,this.l),t&3&&(t+=4-(t&3));break;case"cstr":for(t=0,r="";(o=Ec(this,this.l+t++))!==0;)l.push(Kd(o));r=l.join("");break;case"_wstr":for(t=0,r="";(o=hi(this,this.l+t))!==0;)l.push(Kd(o)),t+=2;t+=2,r=l.join("");break;case"dbcs-cont":for(r="",m=this.l,h=0;h<t;++h){if(this.lens&&this.lens.indexOf(m)!==-1)return o=Ec(this,m),this.l=m+1,u=xf.call(this,t-h,o?"dbcs-cont":"sbcs-cont"),l.join("")+u;l.push(Kd(hi(this,m))),m+=2}r=l.join(""),t*=2;break;case"cpstr":case"sbcs-cont":for(r="",m=this.l,h=0;h!=t;++h){if(this.lens&&this.lens.indexOf(m)!==-1)return o=Ec(this,m),this.l=m+1,u=xf.call(this,t-h,o?"dbcs-cont":"sbcs-cont"),l.join("")+u;l.push(Kd(Ec(this,m))),m+=1}r=l.join("");break;default:switch(t){case 1:return n=Ec(this,this.l),this.l++,n;case 2:return n=(e==="i"?GL:hi)(this,this.l),this.l+=2,n;case 4:case-4:return e==="i"||(this[this.l+3]&128)===0?(n=(t>0?ao:qL)(this,this.l),this.l+=4,n):(a=Na(this,this.l),this.l+=4,a);case 8:case-8:if(e==="f")return t==8?a=U0(this,this.l):a=U0([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,a;t=8;case 16:r=zN(this,this.l,t);break}}return this.l+=t,r}var WL=function(t,e,r){t[r]=e&255,t[r+1]=e>>>8&255,t[r+2]=e>>>16&255,t[r+3]=e>>>24&255},KL=function(t,e,r){t[r]=e&255,t[r+1]=e>>8&255,t[r+2]=e>>16&255,t[r+3]=e>>24&255},YL=function(t,e,r){t[r]=e&255,t[r+1]=e>>>8&255};function $L(t,e,r){var n=0,a=0;if(r==="dbcs"){for(a=0;a!=e.length;++a)YL(this,e.charCodeAt(a),this.l+2*a);n=2*e.length}else if(r==="sbcs"){for(e=e.replace(/[^\x00-\x7F]/g,"_"),a=0;a!=e.length;++a)this[this.l+a]=e.charCodeAt(a)&255;n=e.length}else if(r==="hex"){for(;a<t;++a)this[this.l++]=parseInt(e.slice(2*a,2*a+2),16)||0;return this}else if(r==="utf16le"){var l=Math.min(this.l+t,this.length);for(a=0;a<Math.min(e.length,t);++a){var o=e.charCodeAt(a);this[this.l++]=o&255,this[this.l++]=o>>8}for(;this.l<l;)this[this.l++]=0;return this}else switch(t){case 1:n=1,this[this.l]=e&255;break;case 2:n=2,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255;break;case 3:n=3,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255,e>>>=8,this[this.l+2]=e&255;break;case 4:n=4,WL(this,e,this.l);break;case 8:if(n=8,r==="f"){HL(this,e,this.l);break}case 16:break;case-4:n=4,KL(this,e,this.l);break}return this.l+=n,this}function tC(t,e){var r=zN(this,this.l,t.length>>1);if(r!==t)throw new Error(e+"Expected "+t+" saw "+r);this.l+=t.length>>1}function _n(t,e){t.l=e,t.read_shift=xf,t.chk=tC,t.write_shift=$L}function Vn(t,e){t.l+=e}function Zr(t){var e=Al(t);return _n(e,0),e}function Ai(t,e,r){if(t){var n,a,l;_n(t,t.l||0);for(var o=t.length,u=0,h=0;t.l<o;){u=t.read_shift(1),u&128&&(u=(u&127)+((t.read_shift(1)&127)<<7));var m=q0[u]||q0[65535];for(n=t.read_shift(1),l=n&127,a=1;a<4&&n&128;++a)l+=((n=t.read_shift(1))&127)<<7*a;h=t.l+l;var p=m.f&&m.f(t,l,r);if(t.l=h,e(p,m,u))return}}}function Ux(){var t=[],e=Ft?256:2048,r=function(m){var p=Zr(m);return _n(p,0),p},n=r(e),a=function(){n&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&t.push(n),n=null)},l=function(m){return n&&m<n.length-n.l?n:(a(),n=r(Math.max(m+1,e)))},o=function(){return a(),dl(t)},u=function(m){a(),n=m,n.l==null&&(n.l=n.length),l(e)};return{next:l,push:u,end:o,_bufs:t}}function vf(t,e,r){var n=En(t);if(e.s?(n.cRel&&(n.c+=e.s.c),n.rRel&&(n.r+=e.s.r)):(n.cRel&&(n.c+=e.c),n.rRel&&(n.r+=e.r)),!r||r.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function IE(t,e,r){var n=En(t);return n.s=vf(n.s,e.s,r),n.e=vf(n.e,e.s,r),n}function yf(t,e){if(t.cRel&&t.c<0)for(t=En(t);t.c<0;)t.c+=e>8?16384:256;if(t.rRel&&t.r<0)for(t=En(t);t.r<0;)t.r+=e>8?1048576:e>5?65536:16384;var r=dt(t);return!t.cRel&&t.cRel!=null&&(r=JL(r)),!t.rRel&&t.rRel!=null&&(r=XL(r)),r}function Xg(t,e){return t.s.r==0&&!t.s.rRel&&t.e.r==(e.biff>=12?1048575:e.biff>=8?65536:16384)&&!t.e.rRel?(t.s.cRel?"":"$")+en(t.s.c)+":"+(t.e.cRel?"":"$")+en(t.e.c):t.s.c==0&&!t.s.cRel&&t.e.c==(e.biff>=12?16383:255)&&!t.e.cRel?(t.s.rRel?"":"$")+bn(t.s.r)+":"+(t.e.rRel?"":"$")+bn(t.e.r):yf(t.s,e.biff)+":"+yf(t.e,e.biff)}function T1(t){return parseInt(QL(t),10)-1}function bn(t){return""+(t+1)}function XL(t){return t.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function QL(t){return t.replace(/\$(\d+)$/,"$1")}function E1(t){for(var e=ZL(t),r=0,n=0;n!==e.length;++n)r=26*r+e.charCodeAt(n)-64;return r-1}function en(t){if(t<0)throw new Error("invalid column "+t);var e="";for(++t;t;t=Math.floor((t-1)/26))e=String.fromCharCode((t-1)%26+65)+e;return e}function JL(t){return t.replace(/^([A-Z])/,"$$$1")}function ZL(t){return t.replace(/^\$([A-Z])/,"$1")}function e5(t){return t.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function Jn(t){for(var e=0,r=0,n=0;n<t.length;++n){var a=t.charCodeAt(n);a>=48&&a<=57?e=10*e+(a-48):a>=65&&a<=90&&(r=26*r+(a-64))}return{c:r-1,r:e-1}}function dt(t){for(var e=t.c+1,r="";e;e=(e-1)/26|0)r=String.fromCharCode((e-1)%26+65)+r;return r+(t.r+1)}function Zc(t){var e=t.indexOf(":");return e==-1?{s:Jn(t),e:Jn(t)}:{s:Jn(t.slice(0,e)),e:Jn(t.slice(e+1))}}function Ht(t,e){return typeof e>"u"||typeof e=="number"?Ht(t.s,t.e):(typeof t!="string"&&(t=dt(t)),typeof e!="string"&&(e=dt(e)),t==e?t:t+":"+e)}function Dr(t){var e={s:{c:0,r:0},e:{c:0,r:0}},r=0,n=0,a=0,l=t.length;for(r=0;n<l&&!((a=t.charCodeAt(n)-64)<1||a>26);++n)r=26*r+a;for(e.s.c=--r,r=0;n<l&&!((a=t.charCodeAt(n)-48)<0||a>9);++n)r=10*r+a;if(e.s.r=--r,n===l||a!=10)return e.e.c=e.s.c,e.e.r=e.s.r,e;for(++n,r=0;n!=l&&!((a=t.charCodeAt(n)-64)<1||a>26);++n)r=26*r+a;for(e.e.c=--r,r=0;n!=l&&!((a=t.charCodeAt(n)-48)<0||a>9);++n)r=10*r+a;return e.e.r=--r,e}function OE(t,e){var r=t.t=="d"&&e instanceof Date;if(t.z!=null)try{return t.w=es(t.z,r?ra(e):e)}catch{}try{return t.w=es((t.XF||{}).numFmtId||(r?14:0),r?ra(e):e)}catch{return""+e}}function bi(t,e,r){return t==null||t.t==null||t.t=="z"?"":t.w!==void 0?t.w:(t.t=="d"&&!t.z&&r&&r.dateNF&&(t.z=r.dateNF),t.t=="e"?Oo[t.v]||t.v:e==null?OE(t,t.v):OE(t,e))}function Rl(t,e){var r=e&&e.sheet?e.sheet:"Sheet1",n={};return n[r]=t,{SheetNames:[r],Sheets:n}}function rC(t,e,r){var n=r||{},a=t?Array.isArray(t):n.dense,l=t||(a?[]:{}),o=0,u=0;if(l&&n.origin!=null){if(typeof n.origin=="number")o=n.origin;else{var h=typeof n.origin=="string"?Jn(n.origin):n.origin;o=h.r,u=h.c}l["!ref"]||(l["!ref"]="A1:A1")}var m={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(l["!ref"]){var p=Dr(l["!ref"]);m.s.c=p.s.c,m.s.r=p.s.r,m.e.c=Math.max(m.e.c,p.e.c),m.e.r=Math.max(m.e.r,p.e.r),o==-1&&(m.e.r=o=p.e.r+1)}for(var v=0;v!=e.length;++v)if(e[v]){if(!Array.isArray(e[v]))throw new Error("aoa_to_sheet expects an array of arrays");for(var _=0;_!=e[v].length;++_)if(!(typeof e[v][_]>"u")){var w={v:e[v][_]},E=o+v,T=u+_;if(m.s.r>E&&(m.s.r=E),m.s.c>T&&(m.s.c=T),m.e.r<E&&(m.e.r=E),m.e.c<T&&(m.e.c=T),e[v][_]&&typeof e[v][_]=="object"&&!Array.isArray(e[v][_])&&!(e[v][_]instanceof Date))w=e[v][_];else if(Array.isArray(w.v)&&(w.f=e[v][_][1],w.v=w.v[0]),w.v===null)if(w.f)w.t="n";else if(n.nullError)w.t="e",w.v=0;else if(n.sheetStubs)w.t="z";else continue;else typeof w.v=="number"?w.t="n":typeof w.v=="boolean"?w.t="b":w.v instanceof Date?(w.z=n.dateNF||yt[14],n.cellDates?(w.t="d",w.w=es(w.z,ra(w.v))):(w.t="n",w.v=ra(w.v),w.w=es(w.z,w.v))):w.t="s";if(a)l[E]||(l[E]=[]),l[E][T]&&l[E][T].z&&(w.z=l[E][T].z),l[E][T]=w;else{var A=dt({c:T,r:E});l[A]&&l[A].z&&(w.z=l[A].z),l[A]=w}}}return m.s.c<1e7&&(l["!ref"]=Ht(m)),l}function eu(t,e){return rC(null,t,e)}function t5(t){return t.read_shift(4,"i")}function Un(t){var e=t.read_shift(4);return e===0?"":t.read_shift(e,"dbcs")}function r5(t){return{ich:t.read_shift(2),ifnt:t.read_shift(2)}}function b1(t,e){var r=t.l,n=t.read_shift(1),a=Un(t),l=[],o={t:a,h:a};if((n&1)!==0){for(var u=t.read_shift(4),h=0;h!=u;++h)l.push(r5(t));o.r=l}else o.r=[{ich:0,ifnt:0}];return t.l=r+e,o}var n5=b1;function ts(t){var e=t.read_shift(4),r=t.read_shift(2);return r+=t.read_shift(1)<<16,t.l++,{c:e,iStyleRef:r}}function Do(t){var e=t.read_shift(2);return e+=t.read_shift(1)<<16,t.l++,{c:-1,iStyleRef:e}}var a5=Un;function S1(t){var e=t.read_shift(4);return e===0||e===4294967295?"":t.read_shift(e,"dbcs")}var s5=Un,Bx=S1;function A1(t){var e=t.slice(t.l,t.l+4),r=e[0]&1,n=e[0]&2;t.l+=4;var a=n===0?U0([0,0,0,0,e[0]&252,e[1],e[2],e[3]],0):ao(e,0)>>2;return r?a/100:a}function nC(t){var e={s:{},e:{}};return e.s.r=t.read_shift(4),e.e.r=t.read_shift(4),e.s.c=t.read_shift(4),e.e.c=t.read_shift(4),e}var Io=nC;function Fn(t){if(t.length-t.l<8)throw"XLS Xnum Buffer underflow";return t.read_shift(8,"f")}function i5(t){var e={},r=t.read_shift(1),n=r>>>1,a=t.read_shift(1),l=t.read_shift(2,"i"),o=t.read_shift(1),u=t.read_shift(1),h=t.read_shift(1);switch(t.l++,n){case 0:e.auto=1;break;case 1:e.index=a;var m=mo[a];m&&(e.rgb=Hf(m));break;case 2:e.rgb=Hf([o,u,h]);break;case 3:e.theme=a;break}return l!=0&&(e.tint=l>0?l/32767:l/32768),e}function l5(t){var e=t.read_shift(1);t.l++;var r={fBold:e&1,fItalic:e&2,fUnderline:e&4,fStrikeout:e&8,fOutline:e&16,fShadow:e&32,fCondense:e&64,fExtend:e&128};return r}function aC(t,e){var r={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},n=t.read_shift(4);switch(n){case 0:return"";case 4294967295:case 4294967294:return r[t.read_shift(4)]||""}if(n>400)throw new Error("Unsupported Clipboard: "+n.toString(16));return t.l-=4,t.read_shift(0,e==1?"lpstr":"lpwstr")}function o5(t){return aC(t,1)}function c5(t){return aC(t,2)}var N1=2,da=3,$d=11,ME=12,B0=19,Xd=64,u5=65,f5=71,h5=4108,d5=4126,fn=80,sC=81,m5=[fn,sC],p5={1:{n:"CodePage",t:N1},2:{n:"Category",t:fn},3:{n:"PresentationFormat",t:fn},4:{n:"ByteCount",t:da},5:{n:"LineCount",t:da},6:{n:"ParagraphCount",t:da},7:{n:"SlideCount",t:da},8:{n:"NoteCount",t:da},9:{n:"HiddenCount",t:da},10:{n:"MultimediaClipCount",t:da},11:{n:"ScaleCrop",t:$d},12:{n:"HeadingPairs",t:h5},13:{n:"TitlesOfParts",t:d5},14:{n:"Manager",t:fn},15:{n:"Company",t:fn},16:{n:"LinksUpToDate",t:$d},17:{n:"CharacterCount",t:da},19:{n:"SharedDoc",t:$d},22:{n:"HyperlinksChanged",t:$d},23:{n:"AppVersion",t:da,p:"version"},24:{n:"DigSig",t:u5},26:{n:"ContentType",t:fn},27:{n:"ContentStatus",t:fn},28:{n:"Language",t:fn},29:{n:"Version",t:fn},255:{},2147483648:{n:"Locale",t:B0},2147483651:{n:"Behavior",t:B0},1919054434:{}},g5={1:{n:"CodePage",t:N1},2:{n:"Title",t:fn},3:{n:"Subject",t:fn},4:{n:"Author",t:fn},5:{n:"Keywords",t:fn},6:{n:"Comments",t:fn},7:{n:"Template",t:fn},8:{n:"LastAuthor",t:fn},9:{n:"RevNumber",t:fn},10:{n:"EditTime",t:Xd},11:{n:"LastPrinted",t:Xd},12:{n:"CreatedDate",t:Xd},13:{n:"ModifiedDate",t:Xd},14:{n:"PageCount",t:da},15:{n:"WordCount",t:da},16:{n:"CharCount",t:da},17:{n:"Thumbnail",t:f5},18:{n:"Application",t:fn},19:{n:"DocSecurity",t:da},255:{},2147483648:{n:"Locale",t:B0},2147483651:{n:"Behavior",t:B0},1919054434:{}},jE={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},x5=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function v5(t){return t.map(function(e){return[e>>16&255,e>>8&255,e&255]})}var y5=v5([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),mo=En(y5),Oo={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},iC={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},FE={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"};function _5(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function w5(t){var e=_5();if(!t||!t.match)return e;var r={};if((t.match(zn)||[]).forEach(function(n){var a=it(n);switch(a[0].replace(kL,"<")){case"<?xml":break;case"<Types":e.xmlns=a["xmlns"+(a[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":r[a.Extension]=a.ContentType;break;case"<Override":e[FE[a.ContentType]]!==void 0&&e[FE[a.ContentType]].push(a.PartName);break}}),e.xmlns!==BL.CT)throw new Error("Unknown Namespace: "+e.xmlns);return e.calcchain=e.calcchains.length>0?e.calcchains[0]:"",e.sst=e.strs.length>0?e.strs[0]:"",e.style=e.styles.length>0?e.styles[0]:"",e.defaults=r,delete e.calcchains,e}var bc={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function Vx(t){var e=t.lastIndexOf("/");return t.slice(0,e+1)+"_rels/"+t.slice(e+1)+".rels"}function _f(t,e){var r={"!id":{}};if(!t)return r;e.charAt(0)!=="/"&&(e="/"+e);var n={};return(t.match(zn)||[]).forEach(function(a){var l=it(a);if(l[0]==="<Relationship"){var o={};o.Type=l.Type,o.Target=l.Target,o.Id=l.Id,l.TargetMode&&(o.TargetMode=l.TargetMode);var u=l.TargetMode==="External"?l.Target:lf(l.Target,e);r[u]=o,n[l.Id]=o}}),r["!id"]=n,r}var T5="application/vnd.oasis.opendocument.spreadsheet";function E5(t,e){for(var r=_1(t),n,a;n=Vf.exec(r);)switch(n[3]){case"manifest":break;case"file-entry":if(a=it(n[0],!1),a.path=="/"&&a.type!==T5)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(e&&e.WTF)throw n}}var wf=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],b5=(function(){for(var t=new Array(wf.length),e=0;e<wf.length;++e){var r=wf[e],n="(?:"+r[0].slice(0,r[0].indexOf(":"))+":)"+r[0].slice(r[0].indexOf(":")+1);t[e]=new RegExp("<"+n+"[^>]*>([\\s\\S]*?)</"+n+">")}return t})();function lC(t){var e={};t=fr(t);for(var r=0;r<wf.length;++r){var n=wf[r],a=t.match(b5[r]);a!=null&&a.length>0&&(e[n[1]]=Gt(a[1])),n[2]==="date"&&e[n[1]]&&(e[n[1]]=hn(e[n[1]]))}return e}var S5=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]];function oC(t,e,r,n){var a=[];if(typeof t=="string")a=AE(t,n);else for(var l=0;l<t.length;++l)a=a.concat(t[l].map(function(p){return{v:p}}));var o=typeof e=="string"?AE(e,n).map(function(p){return p.v}):e,u=0,h=0;if(o.length>0)for(var m=0;m!==a.length;m+=2){switch(h=+a[m+1].v,a[m].v){case"Worksheets":case"":case"":case" ":case"":case" ":case"Arbeitsbltter":case"alma Sayfalar":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de clculo":case"Planilhas":case"Regneark":case"Hojas de clculo":case"Werkbladen":r.Worksheets=h,r.SheetNames=o.slice(u,u+h);break;case"Named Ranges":case"Rangos con nombre":case"":case"Benannte Bereiche":case"Navngivne omrder":r.NamedRanges=h,r.DefinedNames=o.slice(u,u+h);break;case"Charts":case"Diagramme":r.Chartsheets=h,r.ChartNames=o.slice(u,u+h);break}u+=h}}function A5(t,e,r){var n={};return e||(e={}),t=fr(t),S5.forEach(function(a){var l=(t.match(Bf(a[0]))||[])[1];switch(a[2]){case"string":l&&(e[a[1]]=Gt(l));break;case"bool":e[a[1]]=l==="true";break;case"raw":var o=t.match(new RegExp("<"+a[0]+"[^>]*>([\\s\\S]*?)</"+a[0]+">"));o&&o.length>0&&(n[a[1]]=o[1]);break}}),n.HeadingPairs&&n.TitlesOfParts&&oC(n.HeadingPairs,n.TitlesOfParts,e,r),e}var N5=/<[^>]+>[^<]*/g;function C5(t,e){var r={},n="",a=t.match(N5);if(a)for(var l=0;l!=a.length;++l){var o=a[l],u=it(o);switch(u[0]){case"<?xml":break;case"<Properties":break;case"<property":n=Gt(u.name);break;case"</property>":n=null;break;default:if(o.indexOf("<vt:")===0){var h=o.split(">"),m=h[0].slice(4),p=h[1];switch(m){case"lpstr":case"bstr":case"lpwstr":r[n]=Gt(p);break;case"bool":r[n]=Tr(p);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":r[n]=parseInt(p,10);break;case"r4":case"r8":case"decimal":r[n]=parseFloat(p);break;case"filetime":case"date":r[n]=hn(p);break;case"cy":case"error":r[n]=Gt(p);break;default:if(m.slice(-1)=="/")break;e.WTF&&typeof console<"u"&&console.warn("Unexpected",o,m,h)}}else if(o.slice(0,2)!=="</"){if(e.WTF)throw new Error(o)}}}return r}var k5={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},Qg;function R5(t,e,r){Qg||(Qg=x1(k5)),e=Qg[e]||e,t[e]=r}function C1(t){var e=t.read_shift(4),r=t.read_shift(4);return new Date((r/1e7*Math.pow(2,32)+e/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function cC(t,e,r){var n=t.l,a=t.read_shift(0,"lpstr-cp");if(r)for(;t.l-n&3;)++t.l;return a}function uC(t,e,r){var n=t.read_shift(0,"lpwstr");return n}function fC(t,e,r){return e===31?uC(t):cC(t,e,r)}function zx(t,e,r){return fC(t,e,r===!1?0:4)}function D5(t,e){if(!e)throw new Error("VtUnalignedString must have positive length");return fC(t,e,0)}function I5(t){for(var e=t.read_shift(4),r=[],n=0;n!=e;++n){var a=t.l;r[n]=t.read_shift(0,"lpwstr").replace(ta,""),t.l-a&2&&(t.l+=2)}return r}function O5(t){for(var e=t.read_shift(4),r=[],n=0;n!=e;++n)r[n]=t.read_shift(0,"lpstr-cp").replace(ta,"");return r}function M5(t){var e=t.l,r=V0(t,sC);t[t.l]==0&&t[t.l+1]==0&&t.l-e&2&&(t.l+=2);var n=V0(t,da);return[r,n]}function j5(t){for(var e=t.read_shift(4),r=[],n=0;n<e/2;++n)r.push(M5(t));return r}function PE(t,e){for(var r=t.read_shift(4),n={},a=0;a!=r;++a){var l=t.read_shift(4),o=t.read_shift(4);n[l]=t.read_shift(o,e===1200?"utf16le":"utf8").replace(ta,"").replace(sf,"!"),e===1200&&o%2&&(t.l+=2)}return t.l&3&&(t.l=t.l>>3<<2),n}function hC(t){var e=t.read_shift(4),r=t.slice(t.l,t.l+e);return t.l+=e,(e&3)>0&&(t.l+=4-(e&3)&3),r}function F5(t){var e={};return e.Size=t.read_shift(4),t.l+=e.Size+3-(e.Size-1)%4,e}function V0(t,e,r){var n=t.read_shift(2),a,l=r||{};if(t.l+=2,e!==ME&&n!==e&&m5.indexOf(e)===-1&&!((e&65534)==4126&&(n&65534)==4126))throw new Error("Expected type "+e+" saw "+n);switch(e===ME?n:e){case 2:return a=t.read_shift(2,"i"),l.raw||(t.l+=2),a;case 3:return a=t.read_shift(4,"i"),a;case 11:return t.read_shift(4)!==0;case 19:return a=t.read_shift(4),a;case 30:return cC(t,n,4).replace(ta,"");case 31:return uC(t);case 64:return C1(t);case 65:return hC(t);case 71:return F5(t);case 80:return zx(t,n,!l.raw).replace(ta,"");case 81:return D5(t,n).replace(ta,"");case 4108:return j5(t);case 4126:case 4127:return n==4127?I5(t):O5(t);default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+n)}}function LE(t,e){var r=t.l,n=t.read_shift(4),a=t.read_shift(4),l=[],o=0,u=0,h=-1,m={};for(o=0;o!=a;++o){var p=t.read_shift(4),v=t.read_shift(4);l[o]=[p,v+r]}l.sort(function(F,R){return F[1]-R[1]});var _={};for(o=0;o!=a;++o){if(t.l!==l[o][1]){var w=!0;if(o>0&&e)switch(e[l[o-1][0]].t){case 2:t.l+2===l[o][1]&&(t.l+=2,w=!1);break;case 80:t.l<=l[o][1]&&(t.l=l[o][1],w=!1);break;case 4108:t.l<=l[o][1]&&(t.l=l[o][1],w=!1);break}if((!e||o==0)&&t.l<=l[o][1]&&(w=!1,t.l=l[o][1]),w)throw new Error("Read Error: Expected address "+l[o][1]+" at "+t.l+" :"+o)}if(e){var E=e[l[o][0]];if(_[E.n]=V0(t,E.t,{raw:!0}),E.p==="version"&&(_[E.n]=String(_[E.n]>>16)+"."+("0000"+String(_[E.n]&65535)).slice(-4)),E.n=="CodePage")switch(_[E.n]){case 0:_[E.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:ds(u=_[E.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+_[E.n])}}else if(l[o][0]===1){if(u=_.CodePage=V0(t,N1),ds(u),h!==-1){var T=t.l;t.l=l[h][1],m=PE(t,u),t.l=T}}else if(l[o][0]===0){if(u===0){h=o,t.l=l[o+1][1];continue}m=PE(t,u)}else{var A=m[l[o][0]],M;switch(t[t.l]){case 65:t.l+=4,M=hC(t);break;case 30:t.l+=4,M=zx(t,t[t.l-4]).replace(/\u0000+$/,"");break;case 31:t.l+=4,M=zx(t,t[t.l-4]).replace(/\u0000+$/,"");break;case 3:t.l+=4,M=t.read_shift(4,"i");break;case 19:t.l+=4,M=t.read_shift(4);break;case 5:t.l+=4,M=t.read_shift(8,"f");break;case 11:t.l+=4,M=Pr(t,4);break;case 64:t.l+=4,M=hn(C1(t));break;default:throw new Error("unparsed value: "+t[t.l])}_[A]=M}}return t.l=r+n,_}function UE(t,e,r){var n=t.content;if(!n)return{};_n(n,0);var a,l,o,u,h=0;n.chk("feff","Byte Order: "),n.read_shift(2);var m=n.read_shift(4),p=n.read_shift(16);if(p!==zt.utils.consts.HEADER_CLSID&&p!==r)throw new Error("Bad PropertySet CLSID "+p);if(a=n.read_shift(4),a!==1&&a!==2)throw new Error("Unrecognized #Sets: "+a);if(l=n.read_shift(16),u=n.read_shift(4),a===1&&u!==n.l)throw new Error("Length mismatch: "+u+" !== "+n.l);a===2&&(o=n.read_shift(16),h=n.read_shift(4));var v=LE(n,e),_={SystemIdentifier:m};for(var w in v)_[w]=v[w];if(_.FMTID=l,a===1)return _;if(h-n.l==2&&(n.l+=2),n.l!==h)throw new Error("Length mismatch 2: "+n.l+" !== "+h);var E;try{E=LE(n,null)}catch{}for(w in E)_[w]=E[w];return _.FMTID=[l,o],_}function ll(t,e){return t.read_shift(e),null}function P5(t,e,r){for(var n=[],a=t.l+e;t.l<a;)n.push(r(t,a-t.l));if(a!==t.l)throw new Error("Slurp error");return n}function Pr(t,e){return t.read_shift(e)===1}function $r(t){return t.read_shift(2,"u")}function dC(t,e){return P5(t,e,$r)}function L5(t){var e=t.read_shift(1),r=t.read_shift(1);return r===1?e:e===1}function hh(t,e,r){var n=t.read_shift(r&&r.biff>=12?2:1),a="sbcs-cont";if(r&&r.biff>=8,!r||r.biff==8){var l=t.read_shift(1);l&&(a="dbcs-cont")}else r.biff==12&&(a="wstr");r.biff>=2&&r.biff<=5&&(a="cpstr");var o=n?t.read_shift(n,a):"";return o}function U5(t){var e=t.read_shift(2),r=t.read_shift(1),n=r&4,a=r&8,l=1+(r&1),o=0,u,h={};a&&(o=t.read_shift(2)),n&&(u=t.read_shift(4));var m=l==2?"dbcs-cont":"sbcs-cont",p=e===0?"":t.read_shift(e,m);return a&&(t.l+=4*o),n&&(t.l+=u),h.t=p,a||(h.raw="<t>"+h.t+"</t>",h.r=h.t),h}function bo(t,e,r){var n;if(r){if(r.biff>=2&&r.biff<=5)return t.read_shift(e,"cpstr");if(r.biff>=12)return t.read_shift(e,"dbcs-cont")}var a=t.read_shift(1);return a===0?n=t.read_shift(e,"sbcs-cont"):n=t.read_shift(e,"dbcs-cont"),n}function dh(t,e,r){var n=t.read_shift(r&&r.biff==2?1:2);return n===0?(t.l++,""):bo(t,n,r)}function Mo(t,e,r){if(r.biff>5)return dh(t,e,r);var n=t.read_shift(1);return n===0?(t.l++,""):t.read_shift(n,r.biff<=4||!t.lens?"cpstr":"sbcs-cont")}function B5(t){var e=t.read_shift(1);t.l++;var r=t.read_shift(2);return t.l+=2,[e,r]}function V5(t){var e=t.read_shift(4),r=t.l,n=!1;e>24&&(t.l+=e-24,t.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(n=!0),t.l=r);var a=t.read_shift((n?e-24:e)>>1,"utf16le").replace(ta,"");return n&&(t.l+=24),a}function z5(t){for(var e=t.read_shift(2),r="";e-- >0;)r+="../";var n=t.read_shift(0,"lpstr-ansi");if(t.l+=2,t.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var a=t.read_shift(4);if(a===0)return r+n.replace(/\\/g,"/");var l=t.read_shift(4);if(t.read_shift(2)!=3)throw new Error("Bad FileMoniker");var o=t.read_shift(l>>1,"utf16le").replace(ta,"");return r+o}function H5(t,e){var r=t.read_shift(16);switch(r){case"e0c9ea79f9bace118c8200aa004ba90b":return V5(t);case"0303000000000000c000000000000046":return z5(t);default:throw new Error("Unsupported Moniker "+r)}}function Qd(t){var e=t.read_shift(4),r=e>0?t.read_shift(e,"utf16le").replace(ta,""):"";return r}function G5(t,e){var r=t.l+e,n=t.read_shift(4);if(n!==2)throw new Error("Unrecognized streamVersion: "+n);var a=t.read_shift(2);t.l+=2;var l,o,u,h,m="",p,v;a&16&&(l=Qd(t,r-t.l)),a&128&&(o=Qd(t,r-t.l)),(a&257)===257&&(u=Qd(t,r-t.l)),(a&257)===1&&(h=H5(t,r-t.l)),a&8&&(m=Qd(t,r-t.l)),a&32&&(p=t.read_shift(16)),a&64&&(v=C1(t)),t.l=r;var _=o||u||h||"";_&&m&&(_+="#"+m),_||(_="#"+m),a&2&&_.charAt(0)=="/"&&_.charAt(1)!="/"&&(_="file://"+_);var w={Target:_};return p&&(w.guid=p),v&&(w.time=v),l&&(w.Tooltip=l),w}function mC(t){var e=t.read_shift(1),r=t.read_shift(1),n=t.read_shift(1),a=t.read_shift(1);return[e,r,n,a]}function pC(t,e){var r=mC(t);return r[3]=0,r}function Vs(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2);return{r:e,c:r,ixfe:n}}function q5(t){var e=t.read_shift(2),r=t.read_shift(2);return t.l+=8,{type:e,flags:r}}function W5(t,e,r){return e===0?"":Mo(t,e,r)}function K5(t,e,r){var n=r.biff>8?4:2,a=t.read_shift(n),l=t.read_shift(n,"i"),o=t.read_shift(n,"i");return[a,l,o]}function gC(t){var e=t.read_shift(2),r=A1(t);return[e,r]}function Y5(t,e,r){t.l+=4,e-=4;var n=t.l+e,a=hh(t,e,r),l=t.read_shift(2);if(n-=t.l,l!==n)throw new Error("Malformed AddinUdf: padding = "+n+" != "+l);return t.l+=l,a}function bm(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2),a=t.read_shift(2);return{s:{c:n,r:e},e:{c:a,r}}}function xC(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(1),a=t.read_shift(1);return{s:{c:n,r:e},e:{c:a,r}}}var $5=xC;function vC(t){t.l+=4;var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2);return t.l+=12,[r,e,n]}function X5(t){var e={};return t.l+=4,t.l+=16,e.fSharedNote=t.read_shift(2),t.l+=4,e}function Q5(t){var e={};return t.l+=4,t.cf=t.read_shift(2),e}function In(t){t.l+=2,t.l+=t.read_shift(2)}var J5={0:In,4:In,5:In,6:In,7:Q5,8:In,9:In,10:In,11:In,12:In,13:X5,14:In,15:In,16:In,17:In,18:In,19:In,20:In,21:vC};function Z5(t,e){for(var r=t.l+e,n=[];t.l<r;){var a=t.read_shift(2);t.l-=2;try{n.push(J5[a](t,r-t.l))}catch{return t.l=r,n}}return t.l!=r&&(t.l=r),n}function Jd(t,e){var r={BIFFVer:0,dt:0};switch(r.BIFFVer=t.read_shift(2),e-=2,e>=2&&(r.dt=t.read_shift(2),t.l-=2),r.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(e>6)throw new Error("Unexpected BIFF Ver "+r.BIFFVer)}return t.read_shift(e),r}function e9(t,e){return e===0||t.read_shift(2),1200}function t9(t,e,r){if(r.enc)return t.l+=e,"";var n=t.l,a=Mo(t,0,r);return t.read_shift(e+n-t.l),a}function r9(t,e,r){var n=r&&r.biff==8||e==2?t.read_shift(2):(t.l+=e,0);return{fDialog:n&16,fBelow:n&64,fRight:n&128}}function n9(t,e,r){var n=t.read_shift(4),a=t.read_shift(1)&3,l=t.read_shift(1);switch(l){case 0:l="Worksheet";break;case 1:l="Macrosheet";break;case 2:l="Chartsheet";break;case 6:l="VBAModule";break}var o=hh(t,0,r);return o.length===0&&(o="Sheet1"),{pos:n,hs:a,dt:l,name:o}}function a9(t,e){for(var r=t.l+e,n=t.read_shift(4),a=t.read_shift(4),l=[],o=0;o!=a&&t.l<r;++o)l.push(U5(t));return l.Count=n,l.Unique=a,l}function s9(t,e){var r={};return r.dsst=t.read_shift(2),t.l+=e-2,r}function i9(t){var e={};e.r=t.read_shift(2),e.c=t.read_shift(2),e.cnt=t.read_shift(2)-e.c;var r=t.read_shift(2);t.l+=4;var n=t.read_shift(1);return t.l+=3,n&7&&(e.level=n&7),n&32&&(e.hidden=!0),n&64&&(e.hpt=r/20),e}function l9(t){var e=q5(t);if(e.type!=2211)throw new Error("Invalid Future Record "+e.type);var r=t.read_shift(4);return r!==0}function o9(t){return t.read_shift(2),t.read_shift(4)}function BE(t,e,r){var n=0;r&&r.biff==2||(n=t.read_shift(2));var a=t.read_shift(2);r&&r.biff==2&&(n=1-(a>>15),a&=32767);var l={Unsynced:n&1,DyZero:(n&2)>>1,ExAsc:(n&4)>>2,ExDsc:(n&8)>>3};return[l,a]}function c9(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2),a=t.read_shift(2),l=t.read_shift(2),o=t.read_shift(2),u=t.read_shift(2),h=t.read_shift(2),m=t.read_shift(2);return{Pos:[e,r],Dim:[n,a],Flags:l,CurTab:o,FirstTab:u,Selected:h,TabRatio:m}}function u9(t,e,r){if(r&&r.biff>=2&&r.biff<5)return{};var n=t.read_shift(2);return{RTL:n&64}}function f9(){}function h9(t,e,r){var n={dyHeight:t.read_shift(2),fl:t.read_shift(2)};switch(r&&r.biff||8){case 2:break;case 3:case 4:t.l+=2;break;default:t.l+=10;break}return n.name=hh(t,0,r),n}function d9(t){var e=Vs(t);return e.isst=t.read_shift(4),e}function m9(t,e,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=t.l+e,a=Vs(t);r.biff==2&&t.l++;var l=dh(t,n-t.l,r);return a.val=l,a}function p9(t,e,r){var n=t.read_shift(2),a=Mo(t,0,r);return[n,a]}var g9=Mo;function VE(t,e,r){var n=t.l+e,a=r.biff==8||!r.biff?4:2,l=t.read_shift(a),o=t.read_shift(a),u=t.read_shift(2),h=t.read_shift(2);return t.l=n,{s:{r:l,c:u},e:{r:o,c:h}}}function x9(t){var e=t.read_shift(2),r=t.read_shift(2),n=gC(t);return{r:e,c:r,ixfe:n[0],rknum:n[1]}}function v9(t,e){for(var r=t.l+e-2,n=t.read_shift(2),a=t.read_shift(2),l=[];t.l<r;)l.push(gC(t));if(t.l!==r)throw new Error("MulRK read error");var o=t.read_shift(2);if(l.length!=o-a+1)throw new Error("MulRK length mismatch");return{r:n,c:a,C:o,rkrec:l}}function y9(t,e){for(var r=t.l+e-2,n=t.read_shift(2),a=t.read_shift(2),l=[];t.l<r;)l.push(t.read_shift(2));if(t.l!==r)throw new Error("MulBlank read error");var o=t.read_shift(2);if(l.length!=o-a+1)throw new Error("MulBlank length mismatch");return{r:n,c:a,C:o,ixfe:l}}function _9(t,e,r,n){var a={},l=t.read_shift(4),o=t.read_shift(4),u=t.read_shift(4),h=t.read_shift(2);return a.patternType=x5[u>>26],n.cellStyles&&(a.alc=l&7,a.fWrap=l>>3&1,a.alcV=l>>4&7,a.fJustLast=l>>7&1,a.trot=l>>8&255,a.cIndent=l>>16&15,a.fShrinkToFit=l>>20&1,a.iReadOrder=l>>22&2,a.fAtrNum=l>>26&1,a.fAtrFnt=l>>27&1,a.fAtrAlc=l>>28&1,a.fAtrBdr=l>>29&1,a.fAtrPat=l>>30&1,a.fAtrProt=l>>31&1,a.dgLeft=o&15,a.dgRight=o>>4&15,a.dgTop=o>>8&15,a.dgBottom=o>>12&15,a.icvLeft=o>>16&127,a.icvRight=o>>23&127,a.grbitDiag=o>>30&3,a.icvTop=u&127,a.icvBottom=u>>7&127,a.icvDiag=u>>14&127,a.dgDiag=u>>21&15,a.icvFore=h&127,a.icvBack=h>>7&127,a.fsxButton=h>>14&1),a}function w9(t,e,r){var n={};return n.ifnt=t.read_shift(2),n.numFmtId=t.read_shift(2),n.flags=t.read_shift(2),n.fStyle=n.flags>>2&1,e-=6,n.data=_9(t,e,n.fStyle,r),n}function T9(t){t.l+=4;var e=[t.read_shift(2),t.read_shift(2)];if(e[0]!==0&&e[0]--,e[1]!==0&&e[1]--,e[0]>7||e[1]>7)throw new Error("Bad Gutters: "+e.join("|"));return e}function zE(t,e,r){var n=Vs(t);(r.biff==2||e==9)&&++t.l;var a=L5(t);return n.val=a,n.t=a===!0||a===!1?"b":"e",n}function E9(t,e,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=Vs(t),a=Fn(t);return n.val=a,n}var HE=W5;function b9(t,e,r){var n=t.l+e,a=t.read_shift(2),l=t.read_shift(2);if(r.sbcch=l,l==1025||l==14849)return[l,a];if(l<1||l>255)throw new Error("Unexpected SupBook type: "+l);for(var o=bo(t,l),u=[];n>t.l;)u.push(dh(t));return[l,a,o,u]}function GE(t,e,r){var n=t.read_shift(2),a,l={fBuiltIn:n&1,fWantAdvise:n>>>1&1,fWantPict:n>>>2&1,fOle:n>>>3&1,fOleLink:n>>>4&1,cf:n>>>5&1023,fIcon:n>>>15&1};return r.sbcch===14849&&(a=Y5(t,e-2,r)),l.body=a||t.read_shift(e-2),typeof a=="string"&&(l.Name=a),l}var S9=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function qE(t,e,r){var n=t.l+e,a=t.read_shift(2),l=t.read_shift(1),o=t.read_shift(1),u=t.read_shift(r&&r.biff==2?1:2),h=0;(!r||r.biff>=5)&&(r.biff!=5&&(t.l+=2),h=t.read_shift(2),r.biff==5&&(t.l+=2),t.l+=4);var m=bo(t,o,r);a&32&&(m=S9[m.charCodeAt(0)]);var p=n-t.l;r&&r.biff==2&&--p;var v=n==t.l||u===0||!(p>0)?[]:iV(t,p,r,u);return{chKey:l,Name:m,itab:h,rgce:v}}function yC(t,e,r){if(r.biff<8)return A9(t,e,r);for(var n=[],a=t.l+e,l=t.read_shift(r.biff>8?4:2);l--!==0;)n.push(K5(t,r.biff>8?12:6,r));if(t.l!=a)throw new Error("Bad ExternSheet: "+t.l+" != "+a);return n}function A9(t,e,r){t[t.l+1]==3&&t[t.l]++;var n=hh(t,e,r);return n.charCodeAt(0)==3?n.slice(1):n}function N9(t,e,r){if(r.biff<8){t.l+=e;return}var n=t.read_shift(2),a=t.read_shift(2),l=bo(t,n,r),o=bo(t,a,r);return[l,o]}function C9(t,e,r){var n=xC(t);t.l++;var a=t.read_shift(1);return e-=8,[lV(t,e,r),a,n]}function WE(t,e,r){var n=$5(t);switch(r.biff){case 2:t.l++,e-=7;break;case 3:case 4:t.l+=2,e-=8;break;default:t.l+=6,e-=12}return[n,aV(t,e,r)]}function k9(t){var e=t.read_shift(4)!==0,r=t.read_shift(4)!==0,n=t.read_shift(4);return[e,r,n]}function R9(t,e,r){if(!(r.biff<8)){var n=t.read_shift(2),a=t.read_shift(2),l=t.read_shift(2),o=t.read_shift(2),u=Mo(t,0,r);return r.biff<8&&t.read_shift(1),[{r:n,c:a},u,o,l]}}function D9(t,e,r){return R9(t,e,r)}function I9(t,e){for(var r=[],n=t.read_shift(2);n--;)r.push(bm(t));return r}function O9(t,e,r){if(r&&r.biff<8)return j9(t,e,r);var n=vC(t),a=Z5(t,e-22,n[1]);return{cmo:n,ft:a}}var M9={8:function(t,e){var r=t.l+e;t.l+=10;var n=t.read_shift(2);t.l+=4,t.l+=2,t.l+=2,t.l+=2,t.l+=4;var a=t.read_shift(1);return t.l+=a,t.l=r,{fmt:n}}};function j9(t,e,r){t.l+=4;var n=t.read_shift(2),a=t.read_shift(2),l=t.read_shift(2);t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=6,e-=36;var o=[];return o.push((M9[n]||Vn)(t,e,r)),{cmo:[a,n,l],ft:o}}function F9(t,e,r){var n=t.l,a="";try{t.l+=4;var l=(r.lastobj||{cmo:[0,0]}).cmo[1],o;[0,5,7,11,12,14].indexOf(l)==-1?t.l+=6:o=B5(t,6,r);var u=t.read_shift(2);t.read_shift(2),$r(t,2);var h=t.read_shift(2);t.l+=h;for(var m=1;m<t.lens.length-1;++m){if(t.l-n!=t.lens[m])throw new Error("TxO: bad continue record");var p=t[t.l],v=bo(t,t.lens[m+1]-t.lens[m]-1);if(a+=v,a.length>=(p?u:2*u))break}if(a.length!==u&&a.length!==u*2)throw new Error("cchText: "+u+" != "+a.length);return t.l=n+e,{t:a}}catch{return t.l=n+e,{t:a}}}function P9(t,e){var r=bm(t);t.l+=16;var n=G5(t,e-24);return[r,n]}function L9(t,e){t.read_shift(2);var r=bm(t),n=t.read_shift((e-10)/2,"dbcs-cont");return n=n.replace(ta,""),[r,n]}function U9(t){var e=[0,0],r;return r=t.read_shift(2),e[0]=jE[r]||r,r=t.read_shift(2),e[1]=jE[r]||r,e}function B9(t){for(var e=t.read_shift(2),r=[];e-- >0;)r.push(pC(t));return r}function V9(t){for(var e=t.read_shift(2),r=[];e-- >0;)r.push(pC(t));return r}function z9(t){t.l+=2;var e={cxfs:0,crc:0};return e.cxfs=t.read_shift(2),e.crc=t.read_shift(4),e}function _C(t,e,r){if(!r.cellStyles)return Vn(t,e);var n=r&&r.biff>=12?4:2,a=t.read_shift(n),l=t.read_shift(n),o=t.read_shift(n),u=t.read_shift(n),h=t.read_shift(2);n==2&&(t.l+=2);var m={s:a,e:l,w:o,ixfe:u,flags:h};return(r.biff>=5||!r.biff)&&(m.level=h>>8&7),m}function H9(t,e){var r={};return e<32||(t.l+=16,r.header=Fn(t),r.footer=Fn(t),t.l+=2),r}function G9(t,e,r){var n={area:!1};if(r.biff!=5)return t.l+=e,n;var a=t.read_shift(1);return t.l+=3,a&16&&(n.area=!0),n}var q9=Vs,W9=dC,K9=dh;function Y9(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(4),a={fmt:e,env:r,len:n,data:t.slice(t.l,t.l+n)};return t.l+=n,a}function $9(t,e,r){r.biffguess&&r.biff==5&&(r.biff=2);var n=Vs(t);++t.l;var a=Mo(t,e-7,r);return n.t="str",n.val=a,n}function X9(t){var e=Vs(t);++t.l;var r=Fn(t);return e.t="n",e.val=r,e}function Q9(t){var e=Vs(t);++t.l;var r=t.read_shift(2);return e.t="n",e.val=r,e}function J9(t){var e=t.read_shift(1);return e===0?(t.l++,""):t.read_shift(e,"sbcs-cont")}function Z9(t,e){t.l+=6,t.l+=2,t.l+=1,t.l+=3,t.l+=1,t.l+=e-13}function eU(t,e,r){var n=t.l+e,a=Vs(t),l=t.read_shift(2),o=bo(t,l,r);return t.l=n,a.t="str",a.val=o,a}var tU=[2,3,48,49,131,139,140,245],KE=(function(){var t={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},e=x1({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(u,h){var m=[],p=Al(1);switch(h.type){case"base64":p=hs(Oa(u));break;case"binary":p=hs(u);break;case"buffer":case"array":p=u;break}_n(p,0);var v=p.read_shift(1),_=!!(v&136),w=!1,E=!1;switch(v){case 2:break;case 3:break;case 48:w=!0,_=!0;break;case 49:w=!0,_=!0;break;case 131:break;case 139:break;case 140:E=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+v.toString(16))}var T=0,A=521;v==2&&(T=p.read_shift(2)),p.l+=3,v!=2&&(T=p.read_shift(4)),T>1048576&&(T=1e6),v!=2&&(A=p.read_shift(2));var M=p.read_shift(2),F=h.codepage||1252;v!=2&&(p.l+=16,p.read_shift(1),p[p.l]!==0&&(F=t[p[p.l]]),p.l+=1,p.l+=2),E&&(p.l+=36);for(var R=[],z={},re=Math.min(p.length,v==2?521:A-10-(w?264:0)),te=E?32:11;p.l<re&&p[p.l]!=13;)switch(z={},z.name=Lf.utils.decode(F,p.slice(p.l,p.l+te)).replace(/[\u0000\r\n].*$/g,""),p.l+=te,z.type=String.fromCharCode(p.read_shift(1)),v!=2&&!E&&(z.offset=p.read_shift(4)),z.len=p.read_shift(1),v==2&&(z.offset=p.read_shift(2)),z.dec=p.read_shift(1),z.name.length&&R.push(z),v!=2&&(p.l+=E?13:14),z.type){case"B":(!w||z.len!=8)&&h.WTF&&console.log("Skipping "+z.name+":"+z.type);break;case"G":case"P":h.WTF&&console.log("Skipping "+z.name+":"+z.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+z.type)}if(p[p.l]!==13&&(p.l=A-1),p.read_shift(1)!==13)throw new Error("DBF Terminator not found "+p.l+" "+p[p.l]);p.l=A;var b=0,N=0;for(m[0]=[],N=0;N!=R.length;++N)m[0][N]=R[N].name;for(;T-- >0;){if(p[p.l]===42){p.l+=M;continue}for(++p.l,m[++b]=[],N=0,N=0;N!=R.length;++N){var k=p.slice(p.l,p.l+R[N].len);p.l+=R[N].len,_n(k,0);var j=Lf.utils.decode(F,k);switch(R[N].type){case"C":j.trim().length&&(m[b][N]=j.replace(/\s+$/,""));break;case"D":j.length===8?m[b][N]=new Date(+j.slice(0,4),+j.slice(4,6)-1,+j.slice(6,8)):m[b][N]=j;break;case"F":m[b][N]=parseFloat(j.trim());break;case"+":case"I":m[b][N]=E?k.read_shift(-4,"i")^2147483648:k.read_shift(4,"i");break;case"L":switch(j.trim().toUpperCase()){case"Y":case"T":m[b][N]=!0;break;case"N":case"F":m[b][N]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+j+"|")}break;case"M":if(!_)throw new Error("DBF Unexpected MEMO for type "+v.toString(16));m[b][N]="##MEMO##"+(E?parseInt(j.trim(),10):k.read_shift(4));break;case"N":j=j.replace(/\u0000/g,"").trim(),j&&j!="."&&(m[b][N]=+j||0);break;case"@":m[b][N]=new Date(k.read_shift(-8,"f")-621356832e5);break;case"T":m[b][N]=new Date((k.read_shift(4)-2440588)*864e5+k.read_shift(4));break;case"Y":m[b][N]=k.read_shift(4,"i")/1e4+k.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":m[b][N]=-k.read_shift(-8,"f");break;case"B":if(w&&R[N].len==8){m[b][N]=k.read_shift(8,"f");break}case"G":case"P":k.l+=R[N].len;break;case"0":if(R[N].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+R[N].type)}}}if(v!=2&&p.l<p.length&&p[p.l++]!=26)throw new Error("DBF EOF Marker missing "+(p.l-1)+" of "+p.length+" "+p[p.l-1].toString(16));return h&&h.sheetRows&&(m=m.slice(0,h.sheetRows)),h.DBF=R,m}function n(u,h){var m=h||{};m.dateNF||(m.dateNF="yyyymmdd");var p=eu(r(u,m),m);return p["!cols"]=m.DBF.map(function(v){return{wch:v.len,DBF:v}}),delete m.DBF,p}function a(u,h){try{return Rl(n(u,h),h)}catch(m){if(h&&h.WTF)throw m}return{SheetNames:[],Sheets:{}}}var l={B:8,C:250,L:1,D:8,"?":0,"":0};function o(u,h){var m=h||{};if(+m.codepage>=0&&ds(+m.codepage),m.type=="string")throw new Error("Cannot write DBF to JS string");var p=Ux(),v=$x(u,{header:1,raw:!0,cellDates:!0}),_=v[0],w=v.slice(1),E=u["!cols"]||[],T=0,A=0,M=0,F=1;for(T=0;T<_.length;++T){if(((E[T]||{}).DBF||{}).name){_[T]=E[T].DBF.name,++M;continue}if(_[T]!=null){if(++M,typeof _[T]=="number"&&(_[T]=_[T].toString(10)),typeof _[T]!="string")throw new Error("DBF Invalid column name "+_[T]+" |"+typeof _[T]+"|");if(_.indexOf(_[T])!==T){for(A=0;A<1024;++A)if(_.indexOf(_[T]+"_"+A)==-1){_[T]+="_"+A;break}}}}var R=Dr(u["!ref"]),z=[],re=[],te=[];for(T=0;T<=R.e.c-R.s.c;++T){var b="",N="",k=0,j=[];for(A=0;A<w.length;++A)w[A][T]!=null&&j.push(w[A][T]);if(j.length==0||_[T]==null){z[T]="?";continue}for(A=0;A<j.length;++A){switch(typeof j[A]){case"number":N="B";break;case"string":N="C";break;case"boolean":N="L";break;case"object":N=j[A]instanceof Date?"D":"C";break;default:N="C"}k=Math.max(k,String(j[A]).length),b=b&&b!=N?"C":N}k>250&&(k=250),N=((E[T]||{}).DBF||{}).type,N=="C"&&E[T].DBF.len>k&&(k=E[T].DBF.len),b=="B"&&N=="N"&&(b="N",te[T]=E[T].DBF.dec,k=E[T].DBF.len),re[T]=b=="C"||N=="N"?k:l[b]||0,F+=re[T],z[T]=b}var L=p.next(32);for(L.write_shift(4,318902576),L.write_shift(4,w.length),L.write_shift(2,296+32*M),L.write_shift(2,F),T=0;T<4;++T)L.write_shift(4,0);for(L.write_shift(4,0|(+e[yN]||3)<<8),T=0,A=0;T<_.length;++T)if(_[T]!=null){var P=p.next(32),U=(_[T].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);P.write_shift(1,U,"sbcs"),P.write_shift(1,z[T]=="?"?"C":z[T],"sbcs"),P.write_shift(4,A),P.write_shift(1,re[T]||l[z[T]]||0),P.write_shift(1,te[T]||0),P.write_shift(1,2),P.write_shift(4,0),P.write_shift(1,0),P.write_shift(4,0),P.write_shift(4,0),A+=re[T]||l[z[T]]||0}var Ce=p.next(264);for(Ce.write_shift(4,13),T=0;T<65;++T)Ce.write_shift(4,0);for(T=0;T<w.length;++T){var Ne=p.next(F);for(Ne.write_shift(1,0),A=0;A<_.length;++A)if(_[A]!=null)switch(z[A]){case"L":Ne.write_shift(1,w[T][A]==null?63:w[T][A]?84:70);break;case"B":Ne.write_shift(8,w[T][A]||0,"f");break;case"N":var ae="0";for(typeof w[T][A]=="number"&&(ae=w[T][A].toFixed(te[A]||0)),M=0;M<re[A]-ae.length;++M)Ne.write_shift(1,32);Ne.write_shift(1,ae,"sbcs");break;case"D":w[T][A]?(Ne.write_shift(4,("0000"+w[T][A].getFullYear()).slice(-4),"sbcs"),Ne.write_shift(2,("00"+(w[T][A].getMonth()+1)).slice(-2),"sbcs"),Ne.write_shift(2,("00"+w[T][A].getDate()).slice(-2),"sbcs")):Ne.write_shift(8,"00000000","sbcs");break;case"C":var ue=String(w[T][A]!=null?w[T][A]:"").slice(0,re[A]);for(Ne.write_shift(1,ue,"sbcs"),M=0;M<re[A]-ue.length;++M)Ne.write_shift(1,32);break}}return p.next(1).write_shift(1,26),p.end()}return{to_workbook:a,to_sheet:n,from_sheet:o}})(),rU=(function(){var t={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},e=new RegExp("\x1BN("+Ls(t).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(_,w){var E=t[w];return typeof E=="number"?cE(E):E},n=function(_,w,E){var T=w.charCodeAt(0)-32<<4|E.charCodeAt(0)-48;return T==59?_:cE(T)};t["|"]=254;function a(_,w){switch(w.type){case"base64":return l(Oa(_),w);case"binary":return l(_,w);case"buffer":return l(Ft&&Buffer.isBuffer(_)?_.toString("binary"):Ro(_),w);case"array":return l(Eo(_),w)}throw new Error("Unrecognized type "+w.type)}function l(_,w){var E=_.split(/[\n\r]+/),T=-1,A=-1,M=0,F=0,R=[],z=[],re=null,te={},b=[],N=[],k=[],j=0,L;for(+w.codepage>=0&&ds(+w.codepage);M!==E.length;++M){j=0;var P=E[M].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(e,r),U=P.replace(/;;/g,"\0").split(";").map(function(B){return B.replace(/\u0000/g,";")}),Ce=U[0],Ne;if(P.length>0)switch(Ce){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":U[1].charAt(0)=="P"&&z.push(P.slice(3).replace(/;;/g,";"));break;case"C":var ae=!1,ue=!1,pe=!1,ne=!1,be=-1,Q=-1;for(F=1;F<U.length;++F)switch(U[F].charAt(0)){case"A":break;case"X":A=parseInt(U[F].slice(1))-1,ue=!0;break;case"Y":for(T=parseInt(U[F].slice(1))-1,ue||(A=0),L=R.length;L<=T;++L)R[L]=[];break;case"K":Ne=U[F].slice(1),Ne.charAt(0)==='"'?Ne=Ne.slice(1,Ne.length-1):Ne==="TRUE"?Ne=!0:Ne==="FALSE"?Ne=!1:isNaN(xs(Ne))?isNaN(Gc(Ne).getDate())||(Ne=hn(Ne)):(Ne=xs(Ne),re!==null&&Jc(re)&&(Ne=Em(Ne))),ae=!0;break;case"E":ne=!0;var I=Ic(U[F].slice(1),{r:T,c:A});R[T][A]=[R[T][A],I];break;case"S":pe=!0,R[T][A]=[R[T][A],"S5S"];break;case"G":break;case"R":be=parseInt(U[F].slice(1))-1;break;case"C":Q=parseInt(U[F].slice(1))-1;break;default:if(w&&w.WTF)throw new Error("SYLK bad record "+P)}if(ae&&(R[T][A]&&R[T][A].length==2?R[T][A][0]=Ne:R[T][A]=Ne,re=null),pe){if(ne)throw new Error("SYLK shared formula cannot have own formula");var Z=be>-1&&R[be][Q];if(!Z||!Z[1])throw new Error("SYLK shared formula cannot find base");R[T][A][1]=RC(Z[1],{r:T-be,c:A-Q})}break;case"F":var ee=0;for(F=1;F<U.length;++F)switch(U[F].charAt(0)){case"X":A=parseInt(U[F].slice(1))-1,++ee;break;case"Y":for(T=parseInt(U[F].slice(1))-1,L=R.length;L<=T;++L)R[L]=[];break;case"M":j=parseInt(U[F].slice(1))/20;break;case"F":break;case"G":break;case"P":re=z[parseInt(U[F].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(k=U[F].slice(1).split(" "),L=parseInt(k[0],10);L<=parseInt(k[1],10);++L)j=parseInt(k[2],10),N[L-1]=j===0?{hidden:!0}:{wch:j},qc(N[L-1]);break;case"C":A=parseInt(U[F].slice(1))-1,N[A]||(N[A]={});break;case"R":T=parseInt(U[F].slice(1))-1,b[T]||(b[T]={}),j>0?(b[T].hpt=j,b[T].hpx=Gf(j)):j===0&&(b[T].hidden=!0);break;default:if(w&&w.WTF)throw new Error("SYLK bad record "+P)}ee<1&&(re=null);break;default:if(w&&w.WTF)throw new Error("SYLK bad record "+P)}}return b.length>0&&(te["!rows"]=b),N.length>0&&(te["!cols"]=N),w&&w.sheetRows&&(R=R.slice(0,w.sheetRows)),[R,te]}function o(_,w){var E=a(_,w),T=E[0],A=E[1],M=eu(T,w);return Ls(A).forEach(function(F){M[F]=A[F]}),M}function u(_,w){return Rl(o(_,w),w)}function h(_,w,E,T){var A="C;Y"+(E+1)+";X"+(T+1)+";K";switch(_.t){case"n":A+=_.v||0,_.f&&!_.F&&(A+=";E"+z7(_.f,{r:E,c:T}));break;case"b":A+=_.v?"TRUE":"FALSE";break;case"e":A+=_.w||_.v;break;case"d":A+='"'+(_.w||_.v)+'"';break;case"s":A+='"'+_.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return A}function m(_,w){w.forEach(function(E,T){var A="F;W"+(T+1)+" "+(T+1)+" ";E.hidden?A+="0":(typeof E.width=="number"&&!E.wpx&&(E.wpx=H0(E.width)),typeof E.wpx=="number"&&!E.wch&&(E.wch=G0(E.wpx)),typeof E.wch=="number"&&(A+=Math.round(E.wch))),A.charAt(A.length-1)!=" "&&_.push(A)})}function p(_,w){w.forEach(function(E,T){var A="F;";E.hidden?A+="M0;":E.hpt?A+="M"+20*E.hpt+";":E.hpx&&(A+="M"+20*NC(E.hpx)+";"),A.length>2&&_.push(A+"R"+(T+1))})}function v(_,w){var E=["ID;PWXL;N;E"],T=[],A=Dr(_["!ref"]),M,F=Array.isArray(_),R=`\r
`;E.push("P;PGeneral"),E.push("F;P0;DG0G8;M255"),_["!cols"]&&m(E,_["!cols"]),_["!rows"]&&p(E,_["!rows"]),E.push("B;Y"+(A.e.r-A.s.r+1)+";X"+(A.e.c-A.s.c+1)+";D"+[A.s.c,A.s.r,A.e.c,A.e.r].join(" "));for(var z=A.s.r;z<=A.e.r;++z)for(var re=A.s.c;re<=A.e.c;++re){var te=dt({r:z,c:re});M=F?(_[z]||[])[re]:_[te],!(!M||M.v==null&&(!M.f||M.F))&&T.push(h(M,_,z,re))}return E.join(R)+R+T.join(R)+R+"E"+R}return{to_workbook:u,to_sheet:o,from_sheet:v}})(),nU=(function(){function t(l,o){switch(o.type){case"base64":return e(Oa(l),o);case"binary":return e(l,o);case"buffer":return e(Ft&&Buffer.isBuffer(l)?l.toString("binary"):Ro(l),o);case"array":return e(Eo(l),o)}throw new Error("Unrecognized type "+o.type)}function e(l,o){for(var u=l.split(`
`),h=-1,m=-1,p=0,v=[];p!==u.length;++p){if(u[p].trim()==="BOT"){v[++h]=[],m=0;continue}if(!(h<0)){var _=u[p].trim().split(","),w=_[0],E=_[1];++p;for(var T=u[p]||"";(T.match(/["]/g)||[]).length&1&&p<u.length-1;)T+=`
`+u[++p];switch(T=T.trim(),+w){case-1:if(T==="BOT"){v[++h]=[],m=0;continue}else if(T!=="EOD")throw new Error("Unrecognized DIF special command "+T);break;case 0:T==="TRUE"?v[h][m]=!0:T==="FALSE"?v[h][m]=!1:isNaN(xs(E))?isNaN(Gc(E).getDate())?v[h][m]=E:v[h][m]=hn(E):v[h][m]=xs(E),++m;break;case 1:T=T.slice(1,T.length-1),T=T.replace(/""/g,'"'),T&&T.match(/^=".*"$/)&&(T=T.slice(2,-1)),v[h][m++]=T!==""?T:null;break}if(T==="EOD")break}}return o&&o.sheetRows&&(v=v.slice(0,o.sheetRows)),v}function r(l,o){return eu(t(l,o),o)}function n(l,o){return Rl(r(l,o),o)}var a=(function(){var l=function(h,m,p,v,_){h.push(m),h.push(p+","+v),h.push('"'+_.replace(/"/g,'""')+'"')},o=function(h,m,p,v){h.push(m+","+p),h.push(m==1?'"'+v.replace(/"/g,'""')+'"':v)};return function(h){var m=[],p=Dr(h["!ref"]),v,_=Array.isArray(h);l(m,"TABLE",0,1,"sheetjs"),l(m,"VECTORS",0,p.e.r-p.s.r+1,""),l(m,"TUPLES",0,p.e.c-p.s.c+1,""),l(m,"DATA",0,0,"");for(var w=p.s.r;w<=p.e.r;++w){o(m,-1,0,"BOT");for(var E=p.s.c;E<=p.e.c;++E){var T=dt({r:w,c:E});if(v=_?(h[w]||[])[E]:h[T],!v){o(m,1,0,"");continue}switch(v.t){case"n":var A=v.w;!A&&v.v!=null&&(A=v.v),A==null?v.f&&!v.F?o(m,1,0,"="+v.f):o(m,1,0,""):o(m,0,A,"V");break;case"b":o(m,0,v.v?1:0,v.v?"TRUE":"FALSE");break;case"s":o(m,1,0,isNaN(v.v)?v.v:'="'+v.v+'"');break;case"d":v.w||(v.w=es(v.z||yt[14],ra(hn(v.v)))),o(m,0,v.w,"V");break;default:o(m,1,0,"")}}}o(m,-1,0,"EOD");var M=`\r
`,F=m.join(M);return F}})();return{to_workbook:n,to_sheet:r,from_sheet:a}})(),aU=(function(){function t(v){return v.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function e(v){return v.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(v,_){for(var w=v.split(`
`),E=-1,T=-1,A=0,M=[];A!==w.length;++A){var F=w[A].trim().split(":");if(F[0]==="cell"){var R=Jn(F[1]);if(M.length<=R.r)for(E=M.length;E<=R.r;++E)M[E]||(M[E]=[]);switch(E=R.r,T=R.c,F[2]){case"t":M[E][T]=t(F[3]);break;case"v":M[E][T]=+F[3];break;case"vtf":var z=F[F.length-1];case"vtc":switch(F[3]){case"nl":M[E][T]=!!+F[4];break;default:M[E][T]=+F[4];break}F[2]=="vtf"&&(M[E][T]=[M[E][T],z])}}}return _&&_.sheetRows&&(M=M.slice(0,_.sheetRows)),M}function n(v,_){return eu(r(v,_),_)}function a(v,_){return Rl(n(v,_),_)}var l=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),o=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,u=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),h="--SocialCalcSpreadsheetControlSave--";function m(v){if(!v||!v["!ref"])return"";for(var _=[],w=[],E,T="",A=Zc(v["!ref"]),M=Array.isArray(v),F=A.s.r;F<=A.e.r;++F)for(var R=A.s.c;R<=A.e.c;++R)if(T=dt({r:F,c:R}),E=M?(v[F]||[])[R]:v[T],!(!E||E.v==null||E.t==="z")){switch(w=["cell",T,"t"],E.t){case"s":case"str":w.push(e(E.v));break;case"n":E.f?(w[2]="vtf",w[3]="n",w[4]=E.v,w[5]=e(E.f)):(w[2]="v",w[3]=E.v);break;case"b":w[2]="vt"+(E.f?"f":"c"),w[3]="nl",w[4]=E.v?"1":"0",w[5]=e(E.f||(E.v?"TRUE":"FALSE"));break;case"d":var z=ra(hn(E.v));w[2]="vtc",w[3]="nd",w[4]=""+z,w[5]=E.w||es(E.z||yt[14],z);break;case"e":continue}_.push(w.join(":"))}return _.push("sheet:c:"+(A.e.c-A.s.c+1)+":r:"+(A.e.r-A.s.r+1)+":tvf:1"),_.push("valueformat:1:text-wiki"),_.join(`
`)}function p(v){return[l,o,u,o,m(v),h].join(`
`)}return{to_workbook:a,to_sheet:n,from_sheet:p}})(),zf=(function(){function t(p,v,_,w,E){E.raw?v[_][w]=p:p===""||(p==="TRUE"?v[_][w]=!0:p==="FALSE"?v[_][w]=!1:isNaN(xs(p))?isNaN(Gc(p).getDate())?v[_][w]=p:v[_][w]=hn(p):v[_][w]=xs(p))}function e(p,v){var _=v||{},w=[];if(!p||p.length===0)return w;for(var E=p.split(/[\r\n]/),T=E.length-1;T>=0&&E[T].length===0;)--T;for(var A=10,M=0,F=0;F<=T;++F)M=E[F].indexOf(" "),M==-1?M=E[F].length:M++,A=Math.max(A,M);for(F=0;F<=T;++F){w[F]=[];var R=0;for(t(E[F].slice(0,A).trim(),w,F,R,_),R=1;R<=(E[F].length-A)/10+1;++R)t(E[F].slice(A+(R-1)*10,A+R*10).trim(),w,F,R,_)}return _.sheetRows&&(w=w.slice(0,_.sheetRows)),w}var r={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function a(p){for(var v={},_=!1,w=0,E=0;w<p.length;++w)(E=p.charCodeAt(w))==34?_=!_:!_&&E in r&&(v[E]=(v[E]||0)+1);E=[];for(w in v)Object.prototype.hasOwnProperty.call(v,w)&&E.push([v[w],w]);if(!E.length){v=n;for(w in v)Object.prototype.hasOwnProperty.call(v,w)&&E.push([v[w],w])}return E.sort(function(T,A){return T[0]-A[0]||n[T[1]]-n[A[1]]}),r[E.pop()[1]]||44}function l(p,v){var _=v||{},w="",E=_.dense?[]:{},T={s:{c:0,r:0},e:{c:0,r:0}};p.slice(0,4)=="sep="?p.charCodeAt(5)==13&&p.charCodeAt(6)==10?(w=p.charAt(4),p=p.slice(7)):p.charCodeAt(5)==13||p.charCodeAt(5)==10?(w=p.charAt(4),p=p.slice(6)):w=a(p.slice(0,1024)):_&&_.FS?w=_.FS:w=a(p.slice(0,1024));var A=0,M=0,F=0,R=0,z=0,re=w.charCodeAt(0),te=!1,b=0,N=p.charCodeAt(0);p=p.replace(/\r\n/mg,`
`);var k=_.dateNF!=null?pL(_.dateNF):null;function j(){var L=p.slice(R,z),P={};if(L.charAt(0)=='"'&&L.charAt(L.length-1)=='"'&&(L=L.slice(1,-1).replace(/""/g,'"')),L.length===0)P.t="z";else if(_.raw)P.t="s",P.v=L;else if(L.trim().length===0)P.t="s",P.v=L;else if(L.charCodeAt(0)==61)L.charCodeAt(1)==34&&L.charCodeAt(L.length-1)==34?(P.t="s",P.v=L.slice(2,-1).replace(/""/g,'"')):G7(L)?(P.t="n",P.f=L.slice(1)):(P.t="s",P.v=L);else if(L=="TRUE")P.t="b",P.v=!0;else if(L=="FALSE")P.t="b",P.v=!1;else if(!isNaN(F=xs(L)))P.t="n",_.cellText!==!1&&(P.w=L),P.v=F;else if(!isNaN(Gc(L).getDate())||k&&L.match(k)){P.z=_.dateNF||yt[14];var U=0;k&&L.match(k)&&(L=gL(L,_.dateNF,L.match(k)||[]),U=1),_.cellDates?(P.t="d",P.v=hn(L,U)):(P.t="n",P.v=ra(hn(L,U))),_.cellText!==!1&&(P.w=es(P.z,P.v instanceof Date?ra(P.v):P.v)),_.cellNF||delete P.z}else P.t="s",P.v=L;if(P.t=="z"||(_.dense?(E[A]||(E[A]=[]),E[A][M]=P):E[dt({c:M,r:A})]=P),R=z+1,N=p.charCodeAt(R),T.e.c<M&&(T.e.c=M),T.e.r<A&&(T.e.r=A),b==re)++M;else if(M=0,++A,_.sheetRows&&_.sheetRows<=A)return!0}e:for(;z<p.length;++z)switch(b=p.charCodeAt(z)){case 34:N===34&&(te=!te);break;case re:case 10:case 13:if(!te&&j())break e;break}return z-R>0&&j(),E["!ref"]=Ht(T),E}function o(p,v){return!(v&&v.PRN)||v.FS||p.slice(0,4)=="sep="||p.indexOf("	")>=0||p.indexOf(",")>=0||p.indexOf(";")>=0?l(p,v):eu(e(p,v),v)}function u(p,v){var _="",w=v.type=="string"?[0,0,0,0]:F1(p,v);switch(v.type){case"base64":_=Oa(p);break;case"binary":_=p;break;case"buffer":v.codepage==65001?_=p.toString("utf8"):v.codepage&&typeof Lf<"u"||(_=Ft&&Buffer.isBuffer(p)?p.toString("binary"):Ro(p));break;case"array":_=Eo(p);break;case"string":_=p;break;default:throw new Error("Unrecognized type "+v.type)}return w[0]==239&&w[1]==187&&w[2]==191?_=fr(_.slice(3)):v.type!="string"&&v.type!="buffer"&&v.codepage==65001?_=fr(_):v.type=="binary"&&typeof Lf<"u",_.slice(0,19)=="socialcalc:version:"?aU.to_sheet(v.type=="string"?_:fr(_),v):o(_,v)}function h(p,v){return Rl(u(p,v),v)}function m(p){for(var v=[],_=Dr(p["!ref"]),w,E=Array.isArray(p),T=_.s.r;T<=_.e.r;++T){for(var A=[],M=_.s.c;M<=_.e.c;++M){var F=dt({r:T,c:M});if(w=E?(p[T]||[])[M]:p[F],!w||w.v==null){A.push("          ");continue}for(var R=(w.w||(bi(w),w.w)||"").slice(0,10);R.length<10;)R+=" ";A.push(R+(M===0?" ":""))}v.push(A.join(""))}return v.join(`
`)}return{to_workbook:h,to_sheet:u,from_sheet:m}})();function sU(t,e){var r=e||{},n=!!r.WTF;r.WTF=!0;try{var a=rU.to_workbook(t,r);return r.WTF=n,a}catch(l){if(r.WTF=n,!l.message.match(/SYLK bad record ID/)&&n)throw l;return zf.to_workbook(t,e)}}var Tf=(function(){function t(I,Z,ee){if(I){_n(I,I.l||0);for(var B=ee.Enum||be;I.l<I.length;){var se=I.read_shift(2),_e=B[se]||B[65535],Pe=I.read_shift(2),he=I.l+Pe,we=_e.f&&_e.f(I,Pe,ee);if(I.l=he,Z(we,_e,se))return}}}function e(I,Z){switch(Z.type){case"base64":return r(hs(Oa(I)),Z);case"binary":return r(hs(I),Z);case"buffer":case"array":return r(I,Z)}throw"Unsupported type "+Z.type}function r(I,Z){if(!I)return I;var ee=Z||{},B=ee.dense?[]:{},se="Sheet1",_e="",Pe=0,he={},we=[],He=[],J={s:{r:0,c:0},e:{r:0,c:0}},Qe=ee.sheetRows||0;if(I[2]==0&&(I[3]==8||I[3]==9)&&I.length>=16&&I[14]==5&&I[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(I[2]==2)ee.Enum=be,t(I,function(De,ut,Lt){switch(Lt){case 0:ee.vers=De,De>=4096&&(ee.qpro=!0);break;case 6:J=De;break;case 204:De&&(_e=De);break;case 222:_e=De;break;case 15:case 51:ee.qpro||(De[1].v=De[1].v.slice(1));case 13:case 14:case 16:Lt==14&&(De[2]&112)==112&&(De[2]&15)>1&&(De[2]&15)<15&&(De[1].z=ee.dateNF||yt[14],ee.cellDates&&(De[1].t="d",De[1].v=Em(De[1].v))),ee.qpro&&De[3]>Pe&&(B["!ref"]=Ht(J),he[se]=B,we.push(se),B=ee.dense?[]:{},J={s:{r:0,c:0},e:{r:0,c:0}},Pe=De[3],se=_e||"Sheet"+(Pe+1),_e="");var Qt=ee.dense?(B[De[0].r]||[])[De[0].c]:B[dt(De[0])];if(Qt){Qt.t=De[1].t,Qt.v=De[1].v,De[1].z!=null&&(Qt.z=De[1].z),De[1].f!=null&&(Qt.f=De[1].f);break}ee.dense?(B[De[0].r]||(B[De[0].r]=[]),B[De[0].r][De[0].c]=De[1]):B[dt(De[0])]=De[1];break}},ee);else if(I[2]==26||I[2]==14)ee.Enum=Q,I[2]==14&&(ee.qpro=!0,I.l=0),t(I,function(De,ut,Lt){switch(Lt){case 204:se=De;break;case 22:De[1].v=De[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(De[3]>Pe&&(B["!ref"]=Ht(J),he[se]=B,we.push(se),B=ee.dense?[]:{},J={s:{r:0,c:0},e:{r:0,c:0}},Pe=De[3],se="Sheet"+(Pe+1)),Qe>0&&De[0].r>=Qe)break;ee.dense?(B[De[0].r]||(B[De[0].r]=[]),B[De[0].r][De[0].c]=De[1]):B[dt(De[0])]=De[1],J.e.c<De[0].c&&(J.e.c=De[0].c),J.e.r<De[0].r&&(J.e.r=De[0].r);break;case 27:De[14e3]&&(He[De[14e3][0]]=De[14e3][1]);break;case 1537:He[De[0]]=De[1],De[0]==Pe&&(se=De[1]);break}},ee);else throw new Error("Unrecognized LOTUS BOF "+I[2]);if(B["!ref"]=Ht(J),he[_e||se]=B,we.push(_e||se),!He.length)return{SheetNames:we,Sheets:he};for(var $e={},Fe=[],Ue=0;Ue<He.length;++Ue)he[we[Ue]]?(Fe.push(He[Ue]||we[Ue]),$e[He[Ue]]=he[He[Ue]]||he[we[Ue]]):(Fe.push(He[Ue]),$e[He[Ue]]={"!ref":"A1"});return{SheetNames:Fe,Sheets:$e}}function n(I,Z){var ee=Z||{};if(+ee.codepage>=0&&ds(+ee.codepage),ee.type=="string")throw new Error("Cannot write WK1 to JS string");var B=Ux(),se=Dr(I["!ref"]),_e=Array.isArray(I),Pe=[];cs(B,0,l(1030)),cs(B,6,h(se));for(var he=Math.min(se.e.r,8191),we=se.s.r;we<=he;++we)for(var He=bn(we),J=se.s.c;J<=se.e.c;++J){we===se.s.r&&(Pe[J]=en(J));var Qe=Pe[J]+He,$e=_e?(I[we]||[])[J]:I[Qe];if(!(!$e||$e.t=="z"))if($e.t=="n")($e.v|0)==$e.v&&$e.v>=-32768&&$e.v<=32767?cs(B,13,w(we,J,$e.v)):cs(B,14,T(we,J,$e.v));else{var Fe=bi($e);cs(B,15,v(we,J,Fe.slice(0,239)))}}return cs(B,1),B.end()}function a(I,Z){var ee=Z||{};if(+ee.codepage>=0&&ds(+ee.codepage),ee.type=="string")throw new Error("Cannot write WK3 to JS string");var B=Ux();cs(B,0,o(I));for(var se=0,_e=0;se<I.SheetNames.length;++se)(I.Sheets[I.SheetNames[se]]||{})["!ref"]&&cs(B,27,ne(I.SheetNames[se],_e++));var Pe=0;for(se=0;se<I.SheetNames.length;++se){var he=I.Sheets[I.SheetNames[se]];if(!(!he||!he["!ref"])){for(var we=Dr(he["!ref"]),He=Array.isArray(he),J=[],Qe=Math.min(we.e.r,8191),$e=we.s.r;$e<=Qe;++$e)for(var Fe=bn($e),Ue=we.s.c;Ue<=we.e.c;++Ue){$e===we.s.r&&(J[Ue]=en(Ue));var De=J[Ue]+Fe,ut=He?(he[$e]||[])[Ue]:he[De];if(!(!ut||ut.t=="z"))if(ut.t=="n")cs(B,23,j($e,Ue,Pe,ut.v));else{var Lt=bi(ut);cs(B,22,b($e,Ue,Pe,Lt.slice(0,239)))}}++Pe}}return cs(B,1),B.end()}function l(I){var Z=Zr(2);return Z.write_shift(2,I),Z}function o(I){var Z=Zr(26);Z.write_shift(2,4096),Z.write_shift(2,4),Z.write_shift(4,0);for(var ee=0,B=0,se=0,_e=0;_e<I.SheetNames.length;++_e){var Pe=I.SheetNames[_e],he=I.Sheets[Pe];if(!(!he||!he["!ref"])){++se;var we=Zc(he["!ref"]);ee<we.e.r&&(ee=we.e.r),B<we.e.c&&(B=we.e.c)}}return ee>8191&&(ee=8191),Z.write_shift(2,ee),Z.write_shift(1,se),Z.write_shift(1,B),Z.write_shift(2,0),Z.write_shift(2,0),Z.write_shift(1,1),Z.write_shift(1,2),Z.write_shift(4,0),Z.write_shift(4,0),Z}function u(I,Z,ee){var B={s:{c:0,r:0},e:{c:0,r:0}};return Z==8&&ee.qpro?(B.s.c=I.read_shift(1),I.l++,B.s.r=I.read_shift(2),B.e.c=I.read_shift(1),I.l++,B.e.r=I.read_shift(2),B):(B.s.c=I.read_shift(2),B.s.r=I.read_shift(2),Z==12&&ee.qpro&&(I.l+=2),B.e.c=I.read_shift(2),B.e.r=I.read_shift(2),Z==12&&ee.qpro&&(I.l+=2),B.s.c==65535&&(B.s.c=B.e.c=B.s.r=B.e.r=0),B)}function h(I){var Z=Zr(8);return Z.write_shift(2,I.s.c),Z.write_shift(2,I.s.r),Z.write_shift(2,I.e.c),Z.write_shift(2,I.e.r),Z}function m(I,Z,ee){var B=[{c:0,r:0},{t:"n",v:0},0,0];return ee.qpro&&ee.vers!=20768?(B[0].c=I.read_shift(1),B[3]=I.read_shift(1),B[0].r=I.read_shift(2),I.l+=2):(B[2]=I.read_shift(1),B[0].c=I.read_shift(2),B[0].r=I.read_shift(2)),B}function p(I,Z,ee){var B=I.l+Z,se=m(I,Z,ee);if(se[1].t="s",ee.vers==20768){I.l++;var _e=I.read_shift(1);return se[1].v=I.read_shift(_e,"utf8"),se}return ee.qpro&&I.l++,se[1].v=I.read_shift(B-I.l,"cstr"),se}function v(I,Z,ee){var B=Zr(7+ee.length);B.write_shift(1,255),B.write_shift(2,Z),B.write_shift(2,I),B.write_shift(1,39);for(var se=0;se<B.length;++se){var _e=ee.charCodeAt(se);B.write_shift(1,_e>=128?95:_e)}return B.write_shift(1,0),B}function _(I,Z,ee){var B=m(I,Z,ee);return B[1].v=I.read_shift(2,"i"),B}function w(I,Z,ee){var B=Zr(7);return B.write_shift(1,255),B.write_shift(2,Z),B.write_shift(2,I),B.write_shift(2,ee,"i"),B}function E(I,Z,ee){var B=m(I,Z,ee);return B[1].v=I.read_shift(8,"f"),B}function T(I,Z,ee){var B=Zr(13);return B.write_shift(1,255),B.write_shift(2,Z),B.write_shift(2,I),B.write_shift(8,ee,"f"),B}function A(I,Z,ee){var B=I.l+Z,se=m(I,Z,ee);if(se[1].v=I.read_shift(8,"f"),ee.qpro)I.l=B;else{var _e=I.read_shift(2);z(I.slice(I.l,I.l+_e),se),I.l+=_e}return se}function M(I,Z,ee){var B=Z&32768;return Z&=-32769,Z=(B?I:0)+(Z>=8192?Z-16384:Z),(B?"":"$")+(ee?en(Z):bn(Z))}var F={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},R=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function z(I,Z){_n(I,0);for(var ee=[],B=0,se="",_e="",Pe="",he="";I.l<I.length;){var we=I[I.l++];switch(we){case 0:ee.push(I.read_shift(8,"f"));break;case 1:_e=M(Z[0].c,I.read_shift(2),!0),se=M(Z[0].r,I.read_shift(2),!1),ee.push(_e+se);break;case 2:{var He=M(Z[0].c,I.read_shift(2),!0),J=M(Z[0].r,I.read_shift(2),!1);_e=M(Z[0].c,I.read_shift(2),!0),se=M(Z[0].r,I.read_shift(2),!1),ee.push(He+J+":"+_e+se)}break;case 3:if(I.l<I.length){console.error("WK1 premature formula end");return}break;case 4:ee.push("("+ee.pop()+")");break;case 5:ee.push(I.read_shift(2));break;case 6:{for(var Qe="";we=I[I.l++];)Qe+=String.fromCharCode(we);ee.push('"'+Qe.replace(/"/g,'""')+'"')}break;case 8:ee.push("-"+ee.pop());break;case 23:ee.push("+"+ee.pop());break;case 22:ee.push("NOT("+ee.pop()+")");break;case 20:case 21:he=ee.pop(),Pe=ee.pop(),ee.push(["AND","OR"][we-20]+"("+Pe+","+he+")");break;default:if(we<32&&R[we])he=ee.pop(),Pe=ee.pop(),ee.push(Pe+R[we]+he);else if(F[we]){if(B=F[we][1],B==69&&(B=I[I.l++]),B>ee.length){console.error("WK1 bad formula parse 0x"+we.toString(16)+":|"+ee.join("|")+"|");return}var $e=ee.slice(-B);ee.length-=B,ee.push(F[we][0]+"("+$e.join(",")+")")}else return we<=7?console.error("WK1 invalid opcode "+we.toString(16)):we<=24?console.error("WK1 unsupported op "+we.toString(16)):we<=30?console.error("WK1 invalid opcode "+we.toString(16)):we<=115?console.error("WK1 unsupported function opcode "+we.toString(16)):console.error("WK1 unrecognized opcode "+we.toString(16))}}ee.length==1?Z[1].f=""+ee[0]:console.error("WK1 bad formula parse |"+ee.join("|")+"|")}function re(I){var Z=[{c:0,r:0},{t:"n",v:0},0];return Z[0].r=I.read_shift(2),Z[3]=I[I.l++],Z[0].c=I[I.l++],Z}function te(I,Z){var ee=re(I);return ee[1].t="s",ee[1].v=I.read_shift(Z-4,"cstr"),ee}function b(I,Z,ee,B){var se=Zr(6+B.length);se.write_shift(2,I),se.write_shift(1,ee),se.write_shift(1,Z),se.write_shift(1,39);for(var _e=0;_e<B.length;++_e){var Pe=B.charCodeAt(_e);se.write_shift(1,Pe>=128?95:Pe)}return se.write_shift(1,0),se}function N(I,Z){var ee=re(I);ee[1].v=I.read_shift(2);var B=ee[1].v>>1;if(ee[1].v&1)switch(B&7){case 0:B=(B>>3)*5e3;break;case 1:B=(B>>3)*500;break;case 2:B=(B>>3)/20;break;case 3:B=(B>>3)/200;break;case 4:B=(B>>3)/2e3;break;case 5:B=(B>>3)/2e4;break;case 6:B=(B>>3)/16;break;case 7:B=(B>>3)/64;break}return ee[1].v=B,ee}function k(I,Z){var ee=re(I),B=I.read_shift(4),se=I.read_shift(4),_e=I.read_shift(2);if(_e==65535)return B===0&&se===3221225472?(ee[1].t="e",ee[1].v=15):B===0&&se===3489660928?(ee[1].t="e",ee[1].v=42):ee[1].v=0,ee;var Pe=_e&32768;return _e=(_e&32767)-16446,ee[1].v=(1-Pe*2)*(se*Math.pow(2,_e+32)+B*Math.pow(2,_e)),ee}function j(I,Z,ee,B){var se=Zr(14);if(se.write_shift(2,I),se.write_shift(1,ee),se.write_shift(1,Z),B==0)return se.write_shift(4,0),se.write_shift(4,0),se.write_shift(2,65535),se;var _e=0,Pe=0,he=0,we=0;return B<0&&(_e=1,B=-B),Pe=Math.log2(B)|0,B/=Math.pow(2,Pe-31),we=B>>>0,(we&2147483648)==0&&(B/=2,++Pe,we=B>>>0),B-=we,we|=2147483648,we>>>=0,B*=Math.pow(2,32),he=B>>>0,se.write_shift(4,he),se.write_shift(4,we),Pe+=16383+(_e?32768:0),se.write_shift(2,Pe),se}function L(I,Z){var ee=k(I);return I.l+=Z-14,ee}function P(I,Z){var ee=re(I),B=I.read_shift(4);return ee[1].v=B>>6,ee}function U(I,Z){var ee=re(I),B=I.read_shift(8,"f");return ee[1].v=B,ee}function Ce(I,Z){var ee=U(I);return I.l+=Z-10,ee}function Ne(I,Z){return I[I.l+Z-1]==0?I.read_shift(Z,"cstr"):""}function ae(I,Z){var ee=I[I.l++];ee>Z-1&&(ee=Z-1);for(var B="";B.length<ee;)B+=String.fromCharCode(I[I.l++]);return B}function ue(I,Z,ee){if(!(!ee.qpro||Z<21)){var B=I.read_shift(1);I.l+=17,I.l+=1,I.l+=2;var se=I.read_shift(Z-21,"cstr");return[B,se]}}function pe(I,Z){for(var ee={},B=I.l+Z;I.l<B;){var se=I.read_shift(2);if(se==14e3){for(ee[se]=[0,""],ee[se][0]=I.read_shift(2);I[I.l];)ee[se][1]+=String.fromCharCode(I[I.l]),I.l++;I.l++}}return ee}function ne(I,Z){var ee=Zr(5+I.length);ee.write_shift(2,14e3),ee.write_shift(2,Z);for(var B=0;B<I.length;++B){var se=I.charCodeAt(B);ee[ee.l++]=se>127?95:se}return ee[ee.l++]=0,ee}var be={0:{n:"BOF",f:$r},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:u},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:_},14:{n:"NUMBER",f:E},15:{n:"LABEL",f:p},16:{n:"FORMULA",f:A},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:p},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:Ne},222:{n:"SHEETNAMELP",f:ae},65535:{n:""}},Q={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:te},23:{n:"NUMBER17",f:k},24:{n:"NUMBER18",f:N},25:{n:"FORMULA19",f:L},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:pe},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:P},38:{n:"??"},39:{n:"NUMBER27",f:U},40:{n:"FORMULA28",f:Ce},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:Ne},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:ue},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:n,book_to_wk3:a,to_workbook:e}})();function iU(t){var e={},r=t.match(zn),n=0,a=!1;if(r)for(;n!=r.length;++n){var l=it(r[n]);switch(l[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!l.val)break;case"<shadow>":case"<shadow/>":e.shadow=1;break;case"</shadow>":break;case"<charset":if(l.val=="1")break;e.cp=h1[parseInt(l.val,10)];break;case"<outline":if(!l.val)break;case"<outline>":case"<outline/>":e.outline=1;break;case"</outline>":break;case"<rFont":e.name=l.val;break;case"<sz":e.sz=l.val;break;case"<strike":if(!l.val)break;case"<strike>":case"<strike/>":e.strike=1;break;case"</strike>":break;case"<u":if(!l.val)break;switch(l.val){case"double":e.uval="double";break;case"singleAccounting":e.uval="single-accounting";break;case"doubleAccounting":e.uval="double-accounting";break}case"<u>":case"<u/>":e.u=1;break;case"</u>":break;case"<b":if(l.val=="0")break;case"<b>":case"<b/>":e.b=1;break;case"</b>":break;case"<i":if(l.val=="0")break;case"<i>":case"<i/>":e.i=1;break;case"</i>":break;case"<color":l.rgb&&(e.color=l.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":e.family=l.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":e.valign=l.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(l[0].charCodeAt(1)!==47&&!a)throw new Error("Unrecognized rich format "+l[0])}}return e}var lU=(function(){var t=Bf("t"),e=Bf("rPr");function r(l){var o=l.match(t);if(!o)return{t:"s",v:""};var u={t:"s",v:Gt(o[1])},h=l.match(e);return h&&(u.s=iU(h[1])),u}var n=/<(?:\w+:)?r>/g,a=/<\/(?:\w+:)?r>/;return function(o){return o.replace(n,"").split(a).map(r).filter(function(u){return u.v})}})(),oU=(function(){var e=/(\r\n|\n)/g;function r(a,l,o){var u=[];a.u&&u.push("text-decoration: underline;"),a.uval&&u.push("text-underline-style:"+a.uval+";"),a.sz&&u.push("font-size:"+a.sz+"pt;"),a.outline&&u.push("text-effect: outline;"),a.shadow&&u.push("text-shadow: auto;"),l.push('<span style="'+u.join("")+'">'),a.b&&(l.push("<b>"),o.push("</b>")),a.i&&(l.push("<i>"),o.push("</i>")),a.strike&&(l.push("<s>"),o.push("</s>"));var h=a.valign||"";return h=="superscript"||h=="super"?h="sup":h=="subscript"&&(h="sub"),h!=""&&(l.push("<"+h+">"),o.push("</"+h+">")),o.push("</span>"),a}function n(a){var l=[[],a.v,[]];return a.v?(a.s&&r(a.s,l[0],l[2]),l[0].join("")+l[1].replace(e,"<br/>")+l[2].join("")):""}return function(l){return l.map(n).join("")}})(),cU=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,uU=/<(?:\w+:)?r>/,fU=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function k1(t,e){var r=e?e.cellHTML:!0,n={};return t?(t.match(/^\s*<(?:\w+:)?t[^>]*>/)?(n.t=Gt(fr(t.slice(t.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),n.r=fr(t),r&&(n.h=y1(n.t))):t.match(uU)&&(n.r=fr(t),n.t=Gt(fr((t.replace(fU,"").match(cU)||[]).join("").replace(zn,""))),r&&(n.h=oU(lU(n.r)))),n):{t:""}}var hU=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,dU=/<(?:\w+:)?(?:si|sstItem)>/g,mU=/<\/(?:\w+:)?(?:si|sstItem)>/;function pU(t,e){var r=[],n="";if(!t)return r;var a=t.match(hU);if(a){n=a[2].replace(dU,"").split(mU);for(var l=0;l!=n.length;++l){var o=k1(n[l].trim(),e);o!=null&&(r[r.length]=o)}a=it(a[1]),r.Count=a.count,r.Unique=a.uniqueCount}return r}function gU(t){return[t.read_shift(4),t.read_shift(4)]}function xU(t,e){var r=[],n=!1;return Ai(t,function(l,o,u){switch(u){case 159:r.Count=l[0],r.Unique=l[1];break;case 19:r.push(l);break;case 160:return!0;case 35:n=!0;break;case 36:n=!1;break;default:if(o.T,!n||e.WTF)throw new Error("Unexpected record 0x"+u.toString(16))}}),r}function wC(t){for(var e=[],r=t.split(""),n=0;n<r.length;++n)e[n]=r[n].charCodeAt(0);return e}function gi(t,e){var r={};return r.Major=t.read_shift(2),r.Minor=t.read_shift(2),e>=4&&(t.l+=e-4),r}function vU(t){var e={};return e.id=t.read_shift(0,"lpp4"),e.R=gi(t,4),e.U=gi(t,4),e.W=gi(t,4),e}function yU(t){for(var e=t.read_shift(4),r=t.l+e-4,n={},a=t.read_shift(4),l=[];a-- >0;)l.push({t:t.read_shift(4),v:t.read_shift(0,"lpp4")});if(n.name=t.read_shift(0,"lpp4"),n.comps=l,t.l!=r)throw new Error("Bad DataSpaceMapEntry: "+t.l+" != "+r);return n}function _U(t){var e=[];t.l+=4;for(var r=t.read_shift(4);r-- >0;)e.push(yU(t));return e}function wU(t){var e=[];t.l+=4;for(var r=t.read_shift(4);r-- >0;)e.push(t.read_shift(0,"lpp4"));return e}function TU(t){var e={};return t.read_shift(4),t.l+=4,e.id=t.read_shift(0,"lpp4"),e.name=t.read_shift(0,"lpp4"),e.R=gi(t,4),e.U=gi(t,4),e.W=gi(t,4),e}function EU(t){var e=TU(t);if(e.ename=t.read_shift(0,"8lpp4"),e.blksz=t.read_shift(4),e.cmode=t.read_shift(4),t.read_shift(4)!=4)throw new Error("Bad !Primary record");return e}function TC(t,e){var r=t.l+e,n={};n.Flags=t.read_shift(4)&63,t.l+=4,n.AlgID=t.read_shift(4);var a=!1;switch(n.AlgID){case 26126:case 26127:case 26128:a=n.Flags==36;break;case 26625:a=n.Flags==4;break;case 0:a=n.Flags==16||n.Flags==4||n.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+n.AlgID}if(!a)throw new Error("Encryption Flags/AlgID mismatch");return n.AlgIDHash=t.read_shift(4),n.KeySize=t.read_shift(4),n.ProviderType=t.read_shift(4),t.l+=8,n.CSPName=t.read_shift(r-t.l>>1,"utf16le"),t.l=r,n}function EC(t,e){var r={},n=t.l+e;return t.l+=4,r.Salt=t.slice(t.l,t.l+16),t.l+=16,r.Verifier=t.slice(t.l,t.l+16),t.l+=16,t.read_shift(4),r.VerifierHash=t.slice(t.l,n),t.l=n,r}function bU(t){var e=gi(t);switch(e.Minor){case 2:return[e.Minor,SU(t)];case 3:return[e.Minor,AU()];case 4:return[e.Minor,NU(t)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+e.Minor)}function SU(t){var e=t.read_shift(4);if((e&63)!=36)throw new Error("EncryptionInfo mismatch");var r=t.read_shift(4),n=TC(t,r),a=EC(t,t.length-t.l);return{t:"Std",h:n,v:a}}function AU(){throw new Error("File is password-protected: ECMA-376 Extensible")}function NU(t){var e=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];t.l+=4;var r=t.read_shift(t.length-t.l,"utf8"),n={};return r.replace(zn,function(l){var o=it(l);switch(Bs(o[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":e.forEach(function(u){n[u]=o[u]});break;case"<dataIntegrity":n.encryptedHmacKey=o.encryptedHmacKey,n.encryptedHmacValue=o.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":n.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":n.uri=o.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":n.encs.push(o);break;default:throw o[0]}}),n}function CU(t,e){var r={},n=r.EncryptionVersionInfo=gi(t,4);if(e-=4,n.Minor!=2)throw new Error("unrecognized minor version code: "+n.Minor);if(n.Major>4||n.Major<2)throw new Error("unrecognized major version code: "+n.Major);r.Flags=t.read_shift(4),e-=4;var a=t.read_shift(4);return e-=4,r.EncryptionHeader=TC(t,a),e-=a,r.EncryptionVerifier=EC(t,e),r}function kU(t){var e={},r=e.EncryptionVersionInfo=gi(t,4);if(r.Major!=1||r.Minor!=1)throw"unrecognized version code "+r.Major+" : "+r.Minor;return e.Salt=t.read_shift(16),e.EncryptedVerifier=t.read_shift(16),e.EncryptedVerifierHash=t.read_shift(16),e}function RU(t){var e=0,r,n=wC(t),a=n.length+1,l,o,u,h,m;for(r=Al(a),r[0]=n.length,l=1;l!=a;++l)r[l]=n[l-1];for(l=a-1;l>=0;--l)o=r[l],u=(e&16384)===0?0:1,h=e<<1&32767,m=u|h,e=m^o;return e^52811}var bC=(function(){var t=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],e=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],r=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],n=function(o){return(o/2|o*128)&255},a=function(o,u){return n(o^u)},l=function(o){for(var u=e[o.length-1],h=104,m=o.length-1;m>=0;--m)for(var p=o[m],v=0;v!=7;++v)p&64&&(u^=r[h]),p*=2,--h;return u};return function(o){for(var u=wC(o),h=l(u),m=u.length,p=Al(16),v=0;v!=16;++v)p[v]=0;var _,w,E;for((m&1)===1&&(_=h>>8,p[m]=a(t[0],_),--m,_=h&255,w=u[u.length-1],p[m]=a(w,_));m>0;)--m,_=h>>8,p[m]=a(u[m],_),--m,_=h&255,p[m]=a(u[m],_);for(m=15,E=15-u.length;E>0;)_=h>>8,p[m]=a(t[E],_),--m,--E,_=h&255,p[m]=a(u[m],_),--m,--E;return p}})(),DU=function(t,e,r,n,a){a||(a=e),n||(n=bC(t));var l,o;for(l=0;l!=e.length;++l)o=e[l],o^=n[r],o=(o>>5|o<<3)&255,a[l]=o,++r;return[a,r,n]},IU=function(t){var e=0,r=bC(t);return function(n){var a=DU("",n,e,r);return e=a[1],a[0]}};function OU(t,e,r,n){var a={key:$r(t),verificationBytes:$r(t)};return r.password&&(a.verifier=RU(r.password)),n.valid=a.verificationBytes===a.verifier,n.valid&&(n.insitu=IU(r.password)),a}function MU(t,e,r){var n=r||{};return n.Info=t.read_shift(2),t.l-=2,n.Info===1?n.Data=kU(t):n.Data=CU(t,e),n}function jU(t,e,r){var n={Type:r.biff>=8?t.read_shift(2):0};return n.Type?MU(t,e-2,n):OU(t,r.biff>=8?e:e-2,r,n),n}var FU=(function(){function t(a,l){switch(l.type){case"base64":return e(Oa(a),l);case"binary":return e(a,l);case"buffer":return e(Ft&&Buffer.isBuffer(a)?a.toString("binary"):Ro(a),l);case"array":return e(Eo(a),l)}throw new Error("Unrecognized type "+l.type)}function e(a,l){var o=l||{},u=o.dense?[]:{},h=a.match(/\\trowd.*?\\row\b/g);if(!h.length)throw new Error("RTF missing table");var m={s:{c:0,r:0},e:{c:0,r:h.length-1}};return h.forEach(function(p,v){Array.isArray(u)&&(u[v]=[]);for(var _=/\\\w+\b/g,w=0,E,T=-1;E=_.exec(p);){switch(E[0]){case"\\cell":var A=p.slice(w,_.lastIndex-E[0].length);if(A[0]==" "&&(A=A.slice(1)),++T,A.length){var M={v:A,t:"s"};Array.isArray(u)?u[v][T]=M:u[dt({r:v,c:T})]=M}break}w=_.lastIndex}T>m.e.c&&(m.e.c=T)}),u["!ref"]=Ht(m),u}function r(a,l){return Rl(t(a,l),l)}function n(a){for(var l=["{\\rtf1\\ansi"],o=Dr(a["!ref"]),u,h=Array.isArray(a),m=o.s.r;m<=o.e.r;++m){l.push("\\trowd\\trautofit1");for(var p=o.s.c;p<=o.e.c;++p)l.push("\\cellx"+(p+1));for(l.push("\\pard\\intbl"),p=o.s.c;p<=o.e.c;++p){var v=dt({r:m,c:p});u=h?(a[m]||[])[p]:a[v],!(!u||u.v==null&&(!u.f||u.F))&&(l.push(" "+(u.w||(bi(u),u.w))),l.push("\\cell"))}l.push("\\pard\\intbl\\row")}return l.join("")+"}"}return{to_workbook:r,to_sheet:t,from_sheet:n}})();function PU(t){var e=t.slice(t[0]==="#"?1:0).slice(0,6);return[parseInt(e.slice(0,2),16),parseInt(e.slice(2,4),16),parseInt(e.slice(4,6),16)]}function Hf(t){for(var e=0,r=1;e!=3;++e)r=r*256+(t[e]>255?255:t[e]<0?0:t[e]);return r.toString(16).toUpperCase().slice(1)}function LU(t){var e=t[0]/255,r=t[1]/255,n=t[2]/255,a=Math.max(e,r,n),l=Math.min(e,r,n),o=a-l;if(o===0)return[0,0,e];var u=0,h=0,m=a+l;switch(h=o/(m>1?2-m:m),a){case e:u=((r-n)/o+6)%6;break;case r:u=(n-e)/o+2;break;case n:u=(e-r)/o+4;break}return[u/6,h,m/2]}function UU(t){var e=t[0],r=t[1],n=t[2],a=r*2*(n<.5?n:1-n),l=n-a/2,o=[l,l,l],u=6*e,h;if(r!==0)switch(u|0){case 0:case 6:h=a*u,o[0]+=a,o[1]+=h;break;case 1:h=a*(2-u),o[0]+=h,o[1]+=a;break;case 2:h=a*(u-2),o[1]+=a,o[2]+=h;break;case 3:h=a*(4-u),o[1]+=h,o[2]+=a;break;case 4:h=a*(u-4),o[2]+=a,o[0]+=h;break;case 5:h=a*(6-u),o[2]+=h,o[0]+=a;break}for(var m=0;m!=3;++m)o[m]=Math.round(o[m]*255);return o}function z0(t,e){if(e===0)return t;var r=LU(PU(t));return e<0?r[2]=r[2]*(1+e):r[2]=1-(1-r[2])*(1-e),Hf(UU(r))}var SC=6,BU=15,VU=1,Qn=SC;function H0(t){return Math.floor((t+Math.round(128/Qn)/256)*Qn)}function G0(t){return Math.floor((t-5)/Qn*100+.5)/100}function Hx(t){return Math.round((t*Qn+5)/Qn*256)/256}function Jg(t){return Hx(G0(H0(t)))}function R1(t){var e=Math.abs(t-Jg(t)),r=Qn;if(e>.005)for(Qn=VU;Qn<BU;++Qn)Math.abs(t-Jg(t))<=e&&(e=Math.abs(t-Jg(t)),r=Qn);Qn=r}function qc(t){t.width?(t.wpx=H0(t.width),t.wch=G0(t.wpx),t.MDW=Qn):t.wpx?(t.wch=G0(t.wpx),t.width=Hx(t.wch),t.MDW=Qn):typeof t.wch=="number"&&(t.width=Hx(t.wch),t.wpx=H0(t.width),t.MDW=Qn),t.customWidth&&delete t.customWidth}var zU=96,AC=zU;function NC(t){return t*96/AC}function Gf(t){return t*AC/96}var HU={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function GU(t,e,r,n){e.Borders=[];var a={},l=!1;(t[0].match(zn)||[]).forEach(function(o){var u=it(o);switch(Bs(u[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":a={},u.diagonalUp&&(a.diagonalUp=Tr(u.diagonalUp)),u.diagonalDown&&(a.diagonalDown=Tr(u.diagonalDown)),e.Borders.push(a);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":l=!0;break;case"</ext>":l=!1;break;default:if(n&&n.WTF&&!l)throw new Error("unrecognized "+u[0]+" in borders")}})}function qU(t,e,r,n){e.Fills=[];var a={},l=!1;(t[0].match(zn)||[]).forEach(function(o){var u=it(o);switch(Bs(u[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":a={},e.Fills.push(a);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":e.Fills.push(a),a={};break;case"<patternFill":case"<patternFill>":u.patternType&&(a.patternType=u.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":a.bgColor||(a.bgColor={}),u.indexed&&(a.bgColor.indexed=parseInt(u.indexed,10)),u.theme&&(a.bgColor.theme=parseInt(u.theme,10)),u.tint&&(a.bgColor.tint=parseFloat(u.tint)),u.rgb&&(a.bgColor.rgb=u.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":a.fgColor||(a.fgColor={}),u.theme&&(a.fgColor.theme=parseInt(u.theme,10)),u.tint&&(a.fgColor.tint=parseFloat(u.tint)),u.rgb!=null&&(a.fgColor.rgb=u.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":l=!0;break;case"</ext>":l=!1;break;default:if(n&&n.WTF&&!l)throw new Error("unrecognized "+u[0]+" in fills")}})}function WU(t,e,r,n){e.Fonts=[];var a={},l=!1;(t[0].match(zn)||[]).forEach(function(o){var u=it(o);switch(Bs(u[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":e.Fonts.push(a),a={};break;case"<name":u.val&&(a.name=fr(u.val));break;case"<name/>":case"</name>":break;case"<b":a.bold=u.val?Tr(u.val):1;break;case"<b/>":a.bold=1;break;case"<i":a.italic=u.val?Tr(u.val):1;break;case"<i/>":a.italic=1;break;case"<u":switch(u.val){case"none":a.underline=0;break;case"single":a.underline=1;break;case"double":a.underline=2;break;case"singleAccounting":a.underline=33;break;case"doubleAccounting":a.underline=34;break}break;case"<u/>":a.underline=1;break;case"<strike":a.strike=u.val?Tr(u.val):1;break;case"<strike/>":a.strike=1;break;case"<outline":a.outline=u.val?Tr(u.val):1;break;case"<outline/>":a.outline=1;break;case"<shadow":a.shadow=u.val?Tr(u.val):1;break;case"<shadow/>":a.shadow=1;break;case"<condense":a.condense=u.val?Tr(u.val):1;break;case"<condense/>":a.condense=1;break;case"<extend":a.extend=u.val?Tr(u.val):1;break;case"<extend/>":a.extend=1;break;case"<sz":u.val&&(a.sz=+u.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":u.val&&(a.vertAlign=u.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":u.val&&(a.family=parseInt(u.val,10));break;case"<family/>":case"</family>":break;case"<scheme":u.val&&(a.scheme=u.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(u.val=="1")break;u.codepage=h1[parseInt(u.val,10)];break;case"<color":if(a.color||(a.color={}),u.auto&&(a.color.auto=Tr(u.auto)),u.rgb)a.color.rgb=u.rgb.slice(-6);else if(u.indexed){a.color.index=parseInt(u.indexed,10);var h=mo[a.color.index];a.color.index==81&&(h=mo[1]),h||(h=mo[1]),a.color.rgb=h[0].toString(16)+h[1].toString(16)+h[2].toString(16)}else u.theme&&(a.color.theme=parseInt(u.theme,10),u.tint&&(a.color.tint=parseFloat(u.tint)),u.theme&&r.themeElements&&r.themeElements.clrScheme&&(a.color.rgb=z0(r.themeElements.clrScheme[a.color.theme].rgb,a.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":l=!0;break;case"</AlternateContent>":l=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":l=!0;break;case"</ext>":l=!1;break;default:if(n&&n.WTF&&!l)throw new Error("unrecognized "+u[0]+" in fonts")}})}function KU(t,e,r){e.NumberFmt=[];for(var n=Ls(yt),a=0;a<n.length;++a)e.NumberFmt[n[a]]=yt[n[a]];var l=t[0].match(zn);if(l)for(a=0;a<l.length;++a){var o=it(l[a]);switch(Bs(o[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var u=Gt(fr(o.formatCode)),h=parseInt(o.numFmtId,10);if(e.NumberFmt[h]=u,h>0){if(h>392){for(h=392;h>60&&e.NumberFmt[h]!=null;--h);e.NumberFmt[h]=u}ho(u,h)}}break;case"</numFmt>":break;default:if(r.WTF)throw new Error("unrecognized "+o[0]+" in numFmts")}}}var Zd=["numFmtId","fillId","fontId","borderId","xfId"],e0=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function YU(t,e,r){e.CellXf=[];var n,a=!1;(t[0].match(zn)||[]).forEach(function(l){var o=it(l),u=0;switch(Bs(o[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(n=o,delete n[0],u=0;u<Zd.length;++u)n[Zd[u]]&&(n[Zd[u]]=parseInt(n[Zd[u]],10));for(u=0;u<e0.length;++u)n[e0[u]]&&(n[e0[u]]=Tr(n[e0[u]]));if(e.NumberFmt&&n.numFmtId>392){for(u=392;u>60;--u)if(e.NumberFmt[n.numFmtId]==e.NumberFmt[u]){n.numFmtId=u;break}}e.CellXf.push(n);break;case"</xf>":break;case"<alignment":case"<alignment/>":var h={};o.vertical&&(h.vertical=o.vertical),o.horizontal&&(h.horizontal=o.horizontal),o.textRotation!=null&&(h.textRotation=o.textRotation),o.indent&&(h.indent=o.indent),o.wrapText&&(h.wrapText=Tr(o.wrapText)),n.alignment=h;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":a=!0;break;case"</AlternateContent>":a=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(r&&r.WTF&&!a)throw new Error("unrecognized "+o[0]+" in cellXfs")}})}var $U=(function(){var e=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,r=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,n=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,a=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,l=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(u,h,m){var p={};if(!u)return p;u=u.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var v;return(v=u.match(e))&&KU(v,p,m),(v=u.match(a))&&WU(v,p,h,m),(v=u.match(n))&&qU(v,p,h,m),(v=u.match(l))&&GU(v,p,h,m),(v=u.match(r))&&YU(v,p,m),p}})();function XU(t,e){var r=t.read_shift(2),n=Un(t);return[r,n]}function QU(t,e,r){var n={};n.sz=t.read_shift(2)/20;var a=l5(t);a.fItalic&&(n.italic=1),a.fCondense&&(n.condense=1),a.fExtend&&(n.extend=1),a.fShadow&&(n.shadow=1),a.fOutline&&(n.outline=1),a.fStrikeout&&(n.strike=1);var l=t.read_shift(2);switch(l===700&&(n.bold=1),t.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var o=t.read_shift(1);o!=0&&(n.underline=o);var u=t.read_shift(1);u>0&&(n.family=u);var h=t.read_shift(1);switch(h>0&&(n.charset=h),t.l++,n.color=i5(t),t.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=Un(t),n}var JU=Vn;function ZU(t,e){var r=t.l+e,n=t.read_shift(2),a=t.read_shift(2);return t.l=r,{ixfe:n,numFmtId:a}}var e7=Vn;function t7(t,e,r){var n={};n.NumberFmt=[];for(var a in yt)n.NumberFmt[a]=yt[a];n.CellXf=[],n.Fonts=[];var l=[],o=!1;return Ai(t,function(h,m,p){switch(p){case 44:n.NumberFmt[h[0]]=h[1],ho(h[1],h[0]);break;case 43:n.Fonts.push(h),h.color.theme!=null&&e&&e.themeElements&&e.themeElements.clrScheme&&(h.color.rgb=z0(e.themeElements.clrScheme[h.color.theme].rgb,h.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:l[l.length-1]==617&&n.CellXf.push(h);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:o=!0;break;case 36:o=!1;break;case 37:l.push(p),o=!0;break;case 38:l.pop(),o=!1;break;default:if(m.T>0)l.push(p);else if(m.T<0)l.pop();else if(!o||r.WTF&&l[l.length-1]!=37)throw new Error("Unexpected record 0x"+p.toString(16))}}),n}var r7=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function n7(t,e,r){e.themeElements.clrScheme=[];var n={};(t[0].match(zn)||[]).forEach(function(a){var l=it(a);switch(l[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":n.rgb=l.val;break;case"<a:sysClr":n.rgb=l.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":l[0].charAt(1)==="/"?(e.themeElements.clrScheme[r7.indexOf(l[0])]=n,n={}):n.name=l[0].slice(3,l[0].length-1);break;default:if(r&&r.WTF)throw new Error("Unrecognized "+l[0]+" in clrScheme")}})}function a7(){}function s7(){}var i7=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,l7=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,o7=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function c7(t,e,r){e.themeElements={};var n;[["clrScheme",i7,n7],["fontScheme",l7,a7],["fmtScheme",o7,s7]].forEach(function(a){if(!(n=t.match(a[1])))throw new Error(a[0]+" not found in themeElements");a[2](n,e,r)})}var u7=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function CC(t,e){(!t||t.length===0)&&(t=f7());var r,n={};if(!(r=t.match(u7)))throw new Error("themeElements not found in theme");return c7(r[0],n,e),n.raw=t,n}function f7(t,e){var r=[UN];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function h7(t,e,r){var n=t.l+e,a=t.read_shift(4);if(a!==124226){if(!r.cellStyles){t.l=n;return}var l=t.slice(t.l);t.l=n;var o;try{o=LN(l,{type:"array"})}catch{return}var u=Ca(o,"theme/theme/theme1.xml",!0);if(u)return CC(u,r)}}function d7(t){return t.read_shift(4)}function m7(t){var e={};switch(e.xclrType=t.read_shift(2),e.nTintShade=t.read_shift(2),e.xclrType){case 0:t.l+=4;break;case 1:e.xclrValue=p7(t,4);break;case 2:e.xclrValue=mC(t);break;case 3:e.xclrValue=d7(t);break;case 4:t.l+=4;break}return t.l+=8,e}function p7(t,e){return Vn(t,e)}function g7(t,e){return Vn(t,e)}function x7(t){var e=t.read_shift(2),r=t.read_shift(2)-4,n=[e];switch(e){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:n[1]=m7(t);break;case 6:n[1]=g7(t,r);break;case 14:case 15:n[1]=t.read_shift(r===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+e+" "+r)}return n}function v7(t,e){var r=t.l+e;t.l+=2;var n=t.read_shift(2);t.l+=2;for(var a=t.read_shift(2),l=[];a-- >0;)l.push(x7(t,r-t.l));return{ixfe:n,ext:l}}function y7(t,e){e.forEach(function(r){r[0]})}function _7(t,e){return{flags:t.read_shift(4),version:t.read_shift(4),name:Un(t)}}function w7(t){for(var e=[],r=t.read_shift(4);r-- >0;)e.push([t.read_shift(4),t.read_shift(4)]);return e}function T7(t){return t.l+=4,t.read_shift(4)!=0}function E7(t,e,r){var n={Types:[],Cell:[],Value:[]},a=r||{},l=[],o=!1,u=2;return Ai(t,function(h,m,p){switch(p){case 335:n.Types.push({name:h.name});break;case 51:h.forEach(function(v){u==1?n.Cell.push({type:n.Types[v[0]-1].name,index:v[1]}):u==0&&n.Value.push({type:n.Types[v[0]-1].name,index:v[1]})});break;case 337:u=h?1:0;break;case 338:u=2;break;case 35:l.push(p),o=!0;break;case 36:l.pop(),o=!1;break;default:if(!m.T){if(!o||a.WTF&&l[l.length-1]!=35)throw new Error("Unexpected record 0x"+p.toString(16))}}}),n}function b7(t,e,r){var n={Types:[],Cell:[],Value:[]};if(!t)return n;var a=!1,l=2,o;return t.replace(zn,function(u){var h=it(u);switch(Bs(h[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":n.Types.push({name:h.name});break;case"</metadataType>":break;case"<futureMetadata":for(var m=0;m<n.Types.length;++m)n.Types[m].name==h.name&&(o=n.Types[m]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":l==1?n.Cell.push({type:n.Types[h.t-1].name,index:+h.v}):l==0&&n.Value.push({type:n.Types[h.t-1].name,index:+h.v});break;case"</rc>":break;case"<cellMetadata":l=1;break;case"</cellMetadata>":l=2;break;case"<valueMetadata":l=0;break;case"</valueMetadata>":l=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;case"<rvb":if(!o)break;o.offsets||(o.offsets=[]),o.offsets.push(+h.i);break;default:if(!a&&r.WTF)throw new Error("unrecognized "+h[0]+" in metadata")}return u}),n}function S7(t){var e=[];if(!t)return e;var r=1;return(t.match(zn)||[]).forEach(function(n){var a=it(n);switch(a[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete a[0],a.i?r=a.i:a.i=r,e.push(a);break}}),e}function A7(t){var e={};e.i=t.read_shift(4);var r={};r.r=t.read_shift(4),r.c=t.read_shift(4),e.r=dt(r);var n=t.read_shift(1);return n&2&&(e.l="1"),n&8&&(e.a="1"),e}function N7(t,e,r){var n=[];return Ai(t,function(l,o,u){switch(u){case 63:n.push(l);break;default:if(!o.T)throw new Error("Unexpected record 0x"+u.toString(16))}}),n}function C7(t,e,r,n){if(!t)return t;var a=n||{},l=!1;Ai(t,function(u,h,m){switch(m){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:l=!0;break;case 36:l=!1;break;default:if(!h.T){if(!l||a.WTF)throw new Error("Unexpected record 0x"+m.toString(16))}}},a)}function k7(t,e){if(!t)return"??";var r=(t.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return e["!id"][r].Target}function YE(t,e,r,n){var a=Array.isArray(t),l;e.forEach(function(o){var u=Jn(o.ref);if(a?(t[u.r]||(t[u.r]=[]),l=t[u.r][u.c]):l=t[o.ref],!l){l={t:"z"},a?t[u.r][u.c]=l:t[o.ref]=l;var h=Dr(t["!ref"]||"BDWGO1000001:A1");h.s.r>u.r&&(h.s.r=u.r),h.e.r<u.r&&(h.e.r=u.r),h.s.c>u.c&&(h.s.c=u.c),h.e.c<u.c&&(h.e.c=u.c);var m=Ht(h);m!==t["!ref"]&&(t["!ref"]=m)}l.c||(l.c=[]);var p={a:o.author,t:o.t,r:o.r,T:r};o.h&&(p.h=o.h);for(var v=l.c.length-1;v>=0;--v){if(!r&&l.c[v].T)return;r&&!l.c[v].T&&l.c.splice(v,1)}if(r&&n){for(v=0;v<n.length;++v)if(p.a==n[v].id){p.a=n[v].name||p.a;break}}l.c.push(p)})}function R7(t,e){if(t.match(/<(?:\w+:)?comments *\/>/))return[];var r=[],n=[],a=t.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);a&&a[1]&&a[1].split(/<\/\w*:?author>/).forEach(function(o){if(!(o===""||o.trim()==="")){var u=o.match(/<(?:\w+:)?author[^>]*>(.*)/);u&&r.push(u[1])}});var l=t.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return l&&l[1]&&l[1].split(/<\/\w*:?comment>/).forEach(function(o){if(!(o===""||o.trim()==="")){var u=o.match(/<(?:\w+:)?comment[^>]*>/);if(u){var h=it(u[0]),m={author:h.authorId&&r[h.authorId]||"sheetjsghost",ref:h.ref,guid:h.guid},p=Jn(h.ref);if(!(e.sheetRows&&e.sheetRows<=p.r)){var v=o.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),_=!!v&&!!v[1]&&k1(v[1])||{r:"",t:"",h:""};m.r=_.r,_.r=="<t></t>"&&(_.t=_.h=""),m.t=(_.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.cellHTML&&(m.h=_.h),n.push(m)}}}}),n}function D7(t,e){var r=[],n=!1,a={},l=0;return t.replace(zn,function(u,h){var m=it(u);switch(Bs(m[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":a={author:m.personId,guid:m.id,ref:m.ref,T:1};break;case"</threadedComment>":a.t!=null&&r.push(a);break;case"<text>":case"<text":l=h+u.length;break;case"</text>":a.t=t.slice(l,h).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":n=!0;break;case"</mentions>":n=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&e.WTF)throw new Error("unrecognized "+m[0]+" in threaded comments")}return u}),r}function I7(t,e){var r=[],n=!1;return t.replace(zn,function(l){var o=it(l);switch(Bs(o[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":r.push({name:o.displayname,id:o.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&e.WTF)throw new Error("unrecognized "+o[0]+" in threaded comments")}return l}),r}function O7(t){var e={};e.iauthor=t.read_shift(4);var r=Io(t);return e.rfx=r.s,e.ref=dt(r.s),t.l+=16,e}var M7=Un;function j7(t,e){var r=[],n=[],a={},l=!1;return Ai(t,function(u,h,m){switch(m){case 632:n.push(u);break;case 635:a=u;break;case 637:a.t=u.t,a.h=u.h,a.r=u.r;break;case 636:if(a.author=n[a.iauthor],delete a.iauthor,e.sheetRows&&a.rfx&&e.sheetRows<=a.rfx.r)break;a.t||(a.t=""),delete a.rfx,r.push(a);break;case 3072:break;case 35:l=!0;break;case 36:l=!1;break;case 37:break;case 38:break;default:if(!h.T){if(!l||e.WTF)throw new Error("Unexpected record 0x"+m.toString(16))}}}),r}var F7="application/vnd.ms-office.vbaProject";function P7(t){var e=zt.utils.cfb_new({root:"R"});return t.FullPaths.forEach(function(r,n){if(!(r.slice(-1)==="/"||!r.match(/_VBA_PROJECT_CUR/))){var a=r.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");zt.utils.cfb_add(e,a,t.FileIndex[n].content)}}),zt.write(e)}function L7(){return{"!type":"dialog"}}function U7(){return{"!type":"dialog"}}function B7(){return{"!type":"macro"}}function V7(){return{"!type":"macro"}}var Ic=(function(){var t=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,e={r:0,c:0};function r(n,a,l,o){var u=!1,h=!1;l.length==0?h=!0:l.charAt(0)=="["&&(h=!0,l=l.slice(1,-1)),o.length==0?u=!0:o.charAt(0)=="["&&(u=!0,o=o.slice(1,-1));var m=l.length>0?parseInt(l,10)|0:0,p=o.length>0?parseInt(o,10)|0:0;return u?p+=e.c:--p,h?m+=e.r:--m,a+(u?"":"$")+en(p)+(h?"":"$")+bn(m)}return function(a,l){return e=l,a.replace(t,r)}})(),kC=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,z7=(function(){return function(e,r){return e.replace(kC,function(n,a,l,o,u,h){var m=E1(o)-(l?0:r.c),p=T1(h)-(u?0:r.r),v=p==0?"":u?p+1:"["+p+"]",_=m==0?"":l?m+1:"["+m+"]";return a+"R"+v+"C"+_})}})();function RC(t,e){return t.replace(kC,function(r,n,a,l,o,u){return n+(a=="$"?a+l:en(E1(l)+e.c))+(o=="$"?o+u:bn(T1(u)+e.r))})}function H7(t,e,r){var n=Zc(e),a=n.s,l=Jn(r),o={r:l.r-a.r,c:l.c-a.c};return RC(t,o)}function G7(t){return t.length!=1}function $E(t){return t.replace(/_xlfn\./g,"")}function Wr(t){t.l+=1}function Nl(t,e){var r=t.read_shift(2);return[r&16383,r>>14&1,r>>15&1]}function DC(t,e,r){var n=2;if(r){if(r.biff>=2&&r.biff<=5)return IC(t);r.biff==12&&(n=4)}var a=t.read_shift(n),l=t.read_shift(n),o=Nl(t),u=Nl(t);return{s:{r:a,c:o[0],cRel:o[1],rRel:o[2]},e:{r:l,c:u[0],cRel:u[1],rRel:u[2]}}}function IC(t){var e=Nl(t),r=Nl(t),n=t.read_shift(1),a=t.read_shift(1);return{s:{r:e[0],c:n,cRel:e[1],rRel:e[2]},e:{r:r[0],c:a,cRel:r[1],rRel:r[2]}}}function q7(t,e,r){if(r.biff<8)return IC(t);var n=t.read_shift(r.biff==12?4:2),a=t.read_shift(r.biff==12?4:2),l=Nl(t),o=Nl(t);return{s:{r:n,c:l[0],cRel:l[1],rRel:l[2]},e:{r:a,c:o[0],cRel:o[1],rRel:o[2]}}}function OC(t,e,r){if(r&&r.biff>=2&&r.biff<=5)return W7(t);var n=t.read_shift(r&&r.biff==12?4:2),a=Nl(t);return{r:n,c:a[0],cRel:a[1],rRel:a[2]}}function W7(t){var e=Nl(t),r=t.read_shift(1);return{r:e[0],c:r,cRel:e[1],rRel:e[2]}}function K7(t){var e=t.read_shift(2),r=t.read_shift(2);return{r:e,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function Y7(t,e,r){var n=r&&r.biff?r.biff:8;if(n>=2&&n<=5)return $7(t);var a=t.read_shift(n>=12?4:2),l=t.read_shift(2),o=(l&16384)>>14,u=(l&32768)>>15;if(l&=16383,u==1)for(;a>524287;)a-=1048576;if(o==1)for(;l>8191;)l=l-16384;return{r:a,c:l,cRel:o,rRel:u}}function $7(t){var e=t.read_shift(2),r=t.read_shift(1),n=(e&32768)>>15,a=(e&16384)>>14;return e&=16383,n==1&&e>=8192&&(e=e-16384),a==1&&r>=128&&(r=r-256),{r:e,c:r,cRel:a,rRel:n}}function X7(t,e,r){var n=(t[t.l++]&96)>>5,a=DC(t,r.biff>=2&&r.biff<=5?6:8,r);return[n,a]}function Q7(t,e,r){var n=(t[t.l++]&96)>>5,a=t.read_shift(2,"i"),l=8;if(r)switch(r.biff){case 5:t.l+=12,l=6;break;case 12:l=12;break}var o=DC(t,l,r);return[n,a,o]}function J7(t,e,r){var n=(t[t.l++]&96)>>5;return t.l+=r&&r.biff>8?12:r.biff<8?6:8,[n]}function Z7(t,e,r){var n=(t[t.l++]&96)>>5,a=t.read_shift(2),l=8;if(r)switch(r.biff){case 5:t.l+=12,l=6;break;case 12:l=12;break}return t.l+=l,[n,a]}function eB(t,e,r){var n=(t[t.l++]&96)>>5,a=q7(t,e-1,r);return[n,a]}function tB(t,e,r){var n=(t[t.l++]&96)>>5;return t.l+=r.biff==2?6:r.biff==12?14:7,[n]}function XE(t){var e=t[t.l+1]&1,r=1;return t.l+=4,[e,r]}function rB(t,e,r){t.l+=2;for(var n=t.read_shift(r&&r.biff==2?1:2),a=[],l=0;l<=n;++l)a.push(t.read_shift(r&&r.biff==2?1:2));return a}function nB(t,e,r){var n=t[t.l+1]&255?1:0;return t.l+=2,[n,t.read_shift(r&&r.biff==2?1:2)]}function aB(t,e,r){var n=t[t.l+1]&255?1:0;return t.l+=2,[n,t.read_shift(r&&r.biff==2?1:2)]}function sB(t){var e=t[t.l+1]&255?1:0;return t.l+=2,[e,t.read_shift(2)]}function iB(t,e,r){var n=t[t.l+1]&255?1:0;return t.l+=r&&r.biff==2?3:4,[n]}function MC(t){var e=t.read_shift(1),r=t.read_shift(1);return[e,r]}function lB(t){return t.read_shift(2),MC(t)}function oB(t){return t.read_shift(2),MC(t)}function cB(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var a=OC(t,0,r);return[n,a]}function uB(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var a=Y7(t,0,r);return[n,a]}function fB(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var a=t.read_shift(2);r&&r.biff==5&&(t.l+=12);var l=OC(t,0,r);return[n,a,l]}function hB(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var a=t.read_shift(r&&r.biff<=3?1:2);return[dV[a],PC[a],n]}function dB(t,e,r){var n=t[t.l++],a=t.read_shift(1),l=r&&r.biff<=3?[n==88?-1:0,t.read_shift(1)]:mB(t);return[a,(l[0]===0?PC:hV)[l[1]]]}function mB(t){return[t[t.l+1]>>7,t.read_shift(2)&32767]}function pB(t,e,r){t.l+=r&&r.biff==2?3:4}function gB(t,e,r){if(t.l++,r&&r.biff==12)return[t.read_shift(4,"i"),0];var n=t.read_shift(2),a=t.read_shift(r&&r.biff==2?1:2);return[n,a]}function xB(t){return t.l++,Oo[t.read_shift(1)]}function vB(t){return t.l++,t.read_shift(2)}function yB(t){return t.l++,t.read_shift(1)!==0}function _B(t){return t.l++,Fn(t)}function wB(t,e,r){return t.l++,hh(t,e-1,r)}function TB(t,e){var r=[t.read_shift(1)];if(e==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=Pr(t,1)?"TRUE":"FALSE",e!=12&&(t.l+=7);break;case 37:case 16:r[1]=Oo[t[t.l]],t.l+=e==12?4:8;break;case 0:t.l+=8;break;case 1:r[1]=Fn(t);break;case 2:r[1]=Mo(t,0,{biff:e>0&&e<8?2:e});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function EB(t,e,r){for(var n=t.read_shift(r.biff==12?4:2),a=[],l=0;l!=n;++l)a.push((r.biff==12?Io:bm)(t));return a}function bB(t,e,r){var n=0,a=0;r.biff==12?(n=t.read_shift(4),a=t.read_shift(4)):(a=1+t.read_shift(1),n=1+t.read_shift(2)),r.biff>=2&&r.biff<8&&(--n,--a==0&&(a=256));for(var l=0,o=[];l!=n&&(o[l]=[]);++l)for(var u=0;u!=a;++u)o[l][u]=TB(t,r.biff);return o}function SB(t,e,r){var n=t.read_shift(1)>>>5&3,a=!r||r.biff>=8?4:2,l=t.read_shift(a);switch(r.biff){case 2:t.l+=5;break;case 3:case 4:t.l+=8;break;case 5:t.l+=12;break}return[n,0,l]}function AB(t,e,r){if(r.biff==5)return NB(t);var n=t.read_shift(1)>>>5&3,a=t.read_shift(2),l=t.read_shift(4);return[n,a,l]}function NB(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2,"i");t.l+=8;var n=t.read_shift(2);return t.l+=12,[e,r,n]}function CB(t,e,r){var n=t.read_shift(1)>>>5&3;t.l+=r&&r.biff==2?3:4;var a=t.read_shift(r&&r.biff==2?1:2);return[n,a]}function kB(t,e,r){var n=t.read_shift(1)>>>5&3,a=t.read_shift(r&&r.biff==2?1:2);return[n,a]}function RB(t,e,r){var n=t.read_shift(1)>>>5&3;return t.l+=4,r.biff<8&&t.l--,r.biff==12&&(t.l+=2),[n]}function DB(t,e,r){var n=(t[t.l++]&96)>>5,a=t.read_shift(2),l=4;if(r)switch(r.biff){case 5:l=15;break;case 12:l=6;break}return t.l+=l,[n,a]}var IB=Vn,OB=Vn,MB=Vn;function mh(t,e,r){return t.l+=2,[K7(t)]}function D1(t){return t.l+=6,[]}var jB=mh,FB=D1,PB=D1,LB=mh;function jC(t){return t.l+=2,[$r(t),t.read_shift(2)&1]}var UB=mh,BB=jC,VB=D1,zB=mh,HB=mh,GB=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function qB(t){t.l+=2;var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(4),a=t.read_shift(2),l=t.read_shift(2),o=GB[r>>2&31];return{ixti:e,coltype:r&3,rt:o,idx:n,c:a,C:l}}function WB(t){return t.l+=2,[t.read_shift(4)]}function KB(t,e,r){return t.l+=5,t.l+=2,t.l+=r.biff==2?1:4,["PTGSHEET"]}function YB(t,e,r){return t.l+=r.biff==2?4:5,["PTGENDSHEET"]}function $B(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2);return[e,r]}function XB(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2);return[e,r]}function QB(t){return t.l+=4,[0,0]}var QE={1:{n:"PtgExp",f:gB},2:{n:"PtgTbl",f:MB},3:{n:"PtgAdd",f:Wr},4:{n:"PtgSub",f:Wr},5:{n:"PtgMul",f:Wr},6:{n:"PtgDiv",f:Wr},7:{n:"PtgPower",f:Wr},8:{n:"PtgConcat",f:Wr},9:{n:"PtgLt",f:Wr},10:{n:"PtgLe",f:Wr},11:{n:"PtgEq",f:Wr},12:{n:"PtgGe",f:Wr},13:{n:"PtgGt",f:Wr},14:{n:"PtgNe",f:Wr},15:{n:"PtgIsect",f:Wr},16:{n:"PtgUnion",f:Wr},17:{n:"PtgRange",f:Wr},18:{n:"PtgUplus",f:Wr},19:{n:"PtgUminus",f:Wr},20:{n:"PtgPercent",f:Wr},21:{n:"PtgParen",f:Wr},22:{n:"PtgMissArg",f:Wr},23:{n:"PtgStr",f:wB},26:{n:"PtgSheet",f:KB},27:{n:"PtgEndSheet",f:YB},28:{n:"PtgErr",f:xB},29:{n:"PtgBool",f:yB},30:{n:"PtgInt",f:vB},31:{n:"PtgNum",f:_B},32:{n:"PtgArray",f:tB},33:{n:"PtgFunc",f:hB},34:{n:"PtgFuncVar",f:dB},35:{n:"PtgName",f:SB},36:{n:"PtgRef",f:cB},37:{n:"PtgArea",f:X7},38:{n:"PtgMemArea",f:CB},39:{n:"PtgMemErr",f:IB},40:{n:"PtgMemNoMem",f:OB},41:{n:"PtgMemFunc",f:kB},42:{n:"PtgRefErr",f:RB},43:{n:"PtgAreaErr",f:J7},44:{n:"PtgRefN",f:uB},45:{n:"PtgAreaN",f:eB},46:{n:"PtgMemAreaN",f:$B},47:{n:"PtgMemNoMemN",f:XB},57:{n:"PtgNameX",f:AB},58:{n:"PtgRef3d",f:fB},59:{n:"PtgArea3d",f:Q7},60:{n:"PtgRefErr3d",f:DB},61:{n:"PtgAreaErr3d",f:Z7},255:{}},JB={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},ZB={1:{n:"PtgElfLel",f:jC},2:{n:"PtgElfRw",f:zB},3:{n:"PtgElfCol",f:jB},6:{n:"PtgElfRwV",f:HB},7:{n:"PtgElfColV",f:LB},10:{n:"PtgElfRadical",f:UB},11:{n:"PtgElfRadicalS",f:VB},13:{n:"PtgElfColS",f:FB},15:{n:"PtgElfColSV",f:PB},16:{n:"PtgElfRadicalLel",f:BB},25:{n:"PtgList",f:qB},29:{n:"PtgSxName",f:WB},255:{}},eV={0:{n:"PtgAttrNoop",f:QB},1:{n:"PtgAttrSemi",f:iB},2:{n:"PtgAttrIf",f:aB},4:{n:"PtgAttrChoose",f:rB},8:{n:"PtgAttrGoto",f:nB},16:{n:"PtgAttrSum",f:pB},32:{n:"PtgAttrBaxcel",f:XE},33:{n:"PtgAttrBaxcel",f:XE},64:{n:"PtgAttrSpace",f:lB},65:{n:"PtgAttrSpaceSemi",f:oB},128:{n:"PtgAttrIfError",f:sB},255:{}};function ph(t,e,r,n){if(n.biff<8)return Vn(t,e);for(var a=t.l+e,l=[],o=0;o!==r.length;++o)switch(r[o][0]){case"PtgArray":r[o][1]=bB(t,0,n),l.push(r[o][1]);break;case"PtgMemArea":r[o][2]=EB(t,r[o][1],n),l.push(r[o][2]);break;case"PtgExp":n&&n.biff==12&&(r[o][1][1]=t.read_shift(4),l.push(r[o][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[o][0]}return e=a-t.l,e!==0&&l.push(Vn(t,e)),l}function gh(t,e,r){for(var n=t.l+e,a,l,o=[];n!=t.l;)e=n-t.l,l=t[t.l],a=QE[l]||QE[JB[l]],(l===24||l===25)&&(a=(l===24?ZB:eV)[t[t.l+1]]),!a||!a.f?Vn(t,e):o.push([a.n,a.f(t,e,r)]);return o}function tV(t){for(var e=[],r=0;r<t.length;++r){for(var n=t[r],a=[],l=0;l<n.length;++l){var o=n[l];if(o)switch(o[0]){case 2:a.push('"'+o[1].replace(/"/g,'""')+'"');break;default:a.push(o[1])}else a.push("")}e.push(a.join(","))}return e.join(";")}var rV={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function nV(t,e){if(!t&&!(e&&e.biff<=5&&e.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(t)?"'"+t+"'":t}function FC(t,e,r){if(!t)return"SH33TJSERR0";if(r.biff>8&&(!t.XTI||!t.XTI[e]))return t.SheetNames[e];if(!t.XTI)return"SH33TJSERR6";var n=t.XTI[e];if(r.biff<8)return e>1e4&&(e-=65536),e<0&&(e=-e),e==0?"":t.XTI[e-1];if(!n)return"SH33TJSERR1";var a="";if(r.biff>8)switch(t[n[0]][0]){case 357:return a=n[1]==-1?"#REF":t.SheetNames[n[1]],n[1]==n[2]?a:a+":"+t.SheetNames[n[2]];case 358:return r.SID!=null?t.SheetNames[r.SID]:"SH33TJSSAME"+t[n[0]][0];case 355:default:return"SH33TJSSRC"+t[n[0]][0]}switch(t[n[0]][0][0]){case 1025:return a=n[1]==-1?"#REF":t.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?a:a+":"+t.SheetNames[n[2]];case 14849:return t[n[0]].slice(1).map(function(l){return l.Name}).join(";;");default:return t[n[0]][0][3]?(a=n[1]==-1?"#REF":t[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?a:a+":"+t[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function JE(t,e,r){var n=FC(t,e,r);return n=="#REF"?n:nV(n,r)}function Mn(t,e,r,n,a){var l=a&&a.biff||8,o={s:{c:0,r:0}},u=[],h,m,p,v=0,_=0,w,E="";if(!t[0]||!t[0][0])return"";for(var T=-1,A="",M=0,F=t[0].length;M<F;++M){var R=t[0][M];switch(R[0]){case"PtgUminus":u.push("-"+u.pop());break;case"PtgUplus":u.push("+"+u.pop());break;case"PtgPercent":u.push(u.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(h=u.pop(),m=u.pop(),T>=0){switch(t[0][T][1][0]){case 0:A=kr(" ",t[0][T][1][1]);break;case 1:A=kr("\r",t[0][T][1][1]);break;default:if(A="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+t[0][T][1][0])}m=m+A,T=-1}u.push(m+rV[R[0]]+h);break;case"PtgIsect":h=u.pop(),m=u.pop(),u.push(m+" "+h);break;case"PtgUnion":h=u.pop(),m=u.pop(),u.push(m+","+h);break;case"PtgRange":h=u.pop(),m=u.pop(),u.push(m+":"+h);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":p=vf(R[1][1],o,a),u.push(yf(p,l));break;case"PtgRefN":p=r?vf(R[1][1],r,a):R[1][1],u.push(yf(p,l));break;case"PtgRef3d":v=R[1][1],p=vf(R[1][2],o,a),E=JE(n,v,a),u.push(E+"!"+yf(p,l));break;case"PtgFunc":case"PtgFuncVar":var z=R[1][0],re=R[1][1];z||(z=0),z&=127;var te=z==0?[]:u.slice(-z);u.length-=z,re==="User"&&(re=te.shift()),u.push(re+"("+te.join(",")+")");break;case"PtgBool":u.push(R[1]?"TRUE":"FALSE");break;case"PtgInt":u.push(R[1]);break;case"PtgNum":u.push(String(R[1]));break;case"PtgStr":u.push('"'+R[1].replace(/"/g,'""')+'"');break;case"PtgErr":u.push(R[1]);break;case"PtgAreaN":w=IE(R[1][1],r?{s:r}:o,a),u.push(Xg(w,a));break;case"PtgArea":w=IE(R[1][1],o,a),u.push(Xg(w,a));break;case"PtgArea3d":v=R[1][1],w=R[1][2],E=JE(n,v,a),u.push(E+"!"+Xg(w,a));break;case"PtgAttrSum":u.push("SUM("+u.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":_=R[1][2];var b=(n.names||[])[_-1]||(n[0]||[])[_],N=b?b.Name:"SH33TJSNAME"+String(_);N&&N.slice(0,6)=="_xlfn."&&!a.xlfn&&(N=N.slice(6)),u.push(N);break;case"PtgNameX":var k=R[1][1];_=R[1][2];var j;if(a.biff<=5)k<0&&(k=-k),n[k]&&(j=n[k][_]);else{var L="";if(((n[k]||[])[0]||[])[0]==14849||(((n[k]||[])[0]||[])[0]==1025?n[k][_]&&n[k][_].itab>0&&(L=n.SheetNames[n[k][_].itab-1]+"!"):L=n.SheetNames[_-1]+"!"),n[k]&&n[k][_])L+=n[k][_].Name;else if(n[0]&&n[0][_])L+=n[0][_].Name;else{var P=(FC(n,k,a)||"").split(";;");P[_-1]?L=P[_-1]:L+="SH33TJSERRX"}u.push(L);break}j||(j={Name:"SH33TJSERRY"}),u.push(j.Name);break;case"PtgParen":var U="(",Ce=")";if(T>=0){switch(A="",t[0][T][1][0]){case 2:U=kr(" ",t[0][T][1][1])+U;break;case 3:U=kr("\r",t[0][T][1][1])+U;break;case 4:Ce=kr(" ",t[0][T][1][1])+Ce;break;case 5:Ce=kr("\r",t[0][T][1][1])+Ce;break;default:if(a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+t[0][T][1][0])}T=-1}u.push(U+u.pop()+Ce);break;case"PtgRefErr":u.push("#REF!");break;case"PtgRefErr3d":u.push("#REF!");break;case"PtgExp":p={c:R[1][1],r:R[1][0]};var Ne={c:r.c,r:r.r};if(n.sharedf[dt(p)]){var ae=n.sharedf[dt(p)];u.push(Mn(ae,o,Ne,n,a))}else{var ue=!1;for(h=0;h!=n.arrayf.length;++h)if(m=n.arrayf[h],!(p.c<m[0].s.c||p.c>m[0].e.c)&&!(p.r<m[0].s.r||p.r>m[0].e.r)){u.push(Mn(m[1],o,Ne,n,a)),ue=!0;break}ue||u.push(R[1])}break;case"PtgArray":u.push("{"+tV(R[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":T=M;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":u.push("");break;case"PtgAreaErr":u.push("#REF!");break;case"PtgAreaErr3d":u.push("#REF!");break;case"PtgList":u.push("Table"+R[1].idx+"[#"+R[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(R));default:throw new Error("Unrecognized Formula Token: "+String(R))}var pe=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(a.biff!=3&&T>=0&&pe.indexOf(t[0][M][0])==-1){R=t[0][T];var ne=!0;switch(R[1][0]){case 4:ne=!1;case 0:A=kr(" ",R[1][1]);break;case 5:ne=!1;case 1:A=kr("\r",R[1][1]);break;default:if(A="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+R[1][0])}u.push((ne?A:"")+u.pop()+(ne?"":A)),T=-1}}if(u.length>1&&a.WTF)throw new Error("bad formula stack");return u[0]}function aV(t,e,r){var n=t.l+e,a=r.biff==2?1:2,l,o=t.read_shift(a);if(o==65535)return[[],Vn(t,e-2)];var u=gh(t,o,r);return e!==o+a&&(l=ph(t,e-o-a,u,r)),t.l=n,[u,l]}function sV(t,e,r){var n=t.l+e,a=r.biff==2?1:2,l,o=t.read_shift(a);if(o==65535)return[[],Vn(t,e-2)];var u=gh(t,o,r);return e!==o+a&&(l=ph(t,e-o-a,u,r)),t.l=n,[u,l]}function iV(t,e,r,n){var a=t.l+e,l=gh(t,n,r),o;return a!==t.l&&(o=ph(t,a-t.l,l,r)),[l,o]}function lV(t,e,r){var n=t.l+e,a,l=t.read_shift(2),o=gh(t,l,r);return l==65535?[[],Vn(t,e-2)]:(e!==l+2&&(a=ph(t,n-l-2,o,r)),[o,a])}function oV(t){var e;if(hi(t,t.l+6)!==65535)return[Fn(t),"n"];switch(t[t.l]){case 0:return t.l+=8,["String","s"];case 1:return e=t[t.l+2]===1,t.l+=8,[e,"b"];case 2:return e=t[t.l+2],t.l+=8,[e,"e"];case 3:return t.l+=8,["","s"]}return[]}function Zg(t,e,r){var n=t.l+e,a=Vs(t);r.biff==2&&++t.l;var l=oV(t),o=t.read_shift(1);r.biff!=2&&(t.read_shift(1),r.biff>=5&&t.read_shift(4));var u=sV(t,n-t.l,r);return{cell:a,val:l[0],formula:u,shared:o>>3&1,tt:l[1]}}function Sm(t,e,r){var n=t.read_shift(4),a=gh(t,n,r),l=t.read_shift(4),o=l>0?ph(t,l,a,r):null;return[a,o]}var cV=Sm,Am=Sm,uV=Sm,fV=Sm,hV={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},PC={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},dV={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function ZE(t){return t.slice(0,3)=="of:"&&(t=t.slice(3)),t.charCodeAt(0)==61&&(t=t.slice(1),t.charCodeAt(0)==61&&(t=t.slice(1))),t=t.replace(/COM\.MICROSOFT\./g,""),t=t.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(e,r){return r.replace(/\./g,"")}),t=t.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),t.replace(/[;~]/g,",").replace(/\|/g,";")}function ex(t){var e=t.split(":"),r=e[0].split(".")[0];return[r,e[0].split(".")[1]+(e.length>1?":"+(e[1].split(".")[1]||e[1].split(".")[0]):"")]}var Ef={},Oc={};function bf(t,e){if(t){var r=[.7,.7,.75,.75,.3,.3];e=="xlml"&&(r=[1,1,1,1,.5,.5]),t.left==null&&(t.left=r[0]),t.right==null&&(t.right=r[1]),t.top==null&&(t.top=r[2]),t.bottom==null&&(t.bottom=r[3]),t.header==null&&(t.header=r[4]),t.footer==null&&(t.footer=r[5])}}function LC(t,e,r,n,a,l){try{n.cellNF&&(t.z=yt[e])}catch(u){if(n.WTF)throw u}if(!(t.t==="z"&&!n.cellStyles)){if(t.t==="d"&&typeof t.v=="string"&&(t.v=hn(t.v)),(!n||n.cellText!==!1)&&t.t!=="z")try{if(yt[e]==null&&ho(mL[e]||"General",e),t.t==="e")t.w=t.w||Oo[t.v];else if(e===0)if(t.t==="n")(t.v|0)===t.v?t.w=t.v.toString(10):t.w=Uf(t.v);else if(t.t==="d"){var o=ra(t.v);(o|0)===o?t.w=o.toString(10):t.w=Uf(o)}else{if(t.v===void 0)return"";t.w=To(t.v,Oc)}else t.t==="d"?t.w=es(e,ra(t.v),Oc):t.w=es(e,t.v,Oc)}catch(u){if(n.WTF)throw u}if(n.cellStyles&&r!=null)try{t.s=l.Fills[r],t.s.fgColor&&t.s.fgColor.theme&&!t.s.fgColor.rgb&&(t.s.fgColor.rgb=z0(a.themeElements.clrScheme[t.s.fgColor.theme].rgb,t.s.fgColor.tint||0),n.WTF&&(t.s.fgColor.raw_rgb=a.themeElements.clrScheme[t.s.fgColor.theme].rgb)),t.s.bgColor&&t.s.bgColor.theme&&(t.s.bgColor.rgb=z0(a.themeElements.clrScheme[t.s.bgColor.theme].rgb,t.s.bgColor.tint||0),n.WTF&&(t.s.bgColor.raw_rgb=a.themeElements.clrScheme[t.s.bgColor.theme].rgb))}catch(u){if(n.WTF&&l.Fills)throw u}}}function mV(t,e){var r=Dr(e);r.s.r<=r.e.r&&r.s.c<=r.e.c&&r.s.r>=0&&r.s.c>=0&&(t["!ref"]=Ht(r))}var pV=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,gV=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,xV=/<(?:\w:)?hyperlink [^>]*>/mg,vV=/"(\w*:\w*)"/,yV=/<(?:\w:)?col\b[^>]*[\/]?>/g,_V=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,wV=/<(?:\w:)?pageMargins[^>]*\/>/g,UC=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,TV=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,EV=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function bV(t,e,r,n,a,l,o){if(!t)return t;n||(n={"!id":{}});var u=e.dense?[]:{},h={s:{r:2e6,c:2e6},e:{r:0,c:0}},m="",p="",v=t.match(gV);v?(m=t.slice(0,v.index),p=t.slice(v.index+v[0].length)):m=p=t;var _=m.match(UC);_?I1(_[0],u,a,r):(_=m.match(TV))&&SV(_[0],_[1]||"",u,a,r);var w=(m.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(w>0){var E=m.slice(w,w+50).match(vV);E&&mV(u,E[1])}var T=m.match(EV);T&&T[1]&&DV(T[1],a);var A=[];if(e.cellStyles){var M=m.match(yV);M&&CV(A,M)}v&&IV(v[1],u,e,h,l,o);var F=p.match(_V);F&&(u["!autofilter"]=kV(F[0]));var R=[],z=p.match(pV);if(z)for(w=0;w!=z.length;++w)R[w]=Dr(z[w].slice(z[w].indexOf('"')+1));var re=p.match(xV);re&&AV(u,re,n);var te=p.match(wV);if(te&&(u["!margins"]=NV(it(te[0]))),!u["!ref"]&&h.e.c>=h.s.c&&h.e.r>=h.s.r&&(u["!ref"]=Ht(h)),e.sheetRows>0&&u["!ref"]){var b=Dr(u["!ref"]);e.sheetRows<=+b.e.r&&(b.e.r=e.sheetRows-1,b.e.r>h.e.r&&(b.e.r=h.e.r),b.e.r<b.s.r&&(b.s.r=b.e.r),b.e.c>h.e.c&&(b.e.c=h.e.c),b.e.c<b.s.c&&(b.s.c=b.e.c),u["!fullref"]=u["!ref"],u["!ref"]=Ht(b))}return A.length>0&&(u["!cols"]=A),R.length>0&&(u["!merges"]=R),u}function I1(t,e,r,n){var a=it(t);r.Sheets[n]||(r.Sheets[n]={}),a.codeName&&(r.Sheets[n].CodeName=Gt(fr(a.codeName)))}function SV(t,e,r,n,a){I1(t.slice(0,t.indexOf(">")),r,n,a)}function AV(t,e,r){for(var n=Array.isArray(t),a=0;a!=e.length;++a){var l=it(fr(e[a]),!0);if(!l.ref)return;var o=((r||{})["!id"]||[])[l.id];o?(l.Target=o.Target,l.location&&(l.Target+="#"+Gt(l.location))):(l.Target="#"+Gt(l.location),o={Target:l.Target,TargetMode:"Internal"}),l.Rel=o,l.tooltip&&(l.Tooltip=l.tooltip,delete l.tooltip);for(var u=Dr(l.ref),h=u.s.r;h<=u.e.r;++h)for(var m=u.s.c;m<=u.e.c;++m){var p=dt({c:m,r:h});n?(t[h]||(t[h]=[]),t[h][m]||(t[h][m]={t:"z",v:void 0}),t[h][m].l=l):(t[p]||(t[p]={t:"z",v:void 0}),t[p].l=l)}}}function NV(t){var e={};return["left","right","top","bottom","header","footer"].forEach(function(r){t[r]&&(e[r]=parseFloat(t[r]))}),e}function CV(t,e){for(var r=!1,n=0;n!=e.length;++n){var a=it(e[n],!0);a.hidden&&(a.hidden=Tr(a.hidden));var l=parseInt(a.min,10)-1,o=parseInt(a.max,10)-1;for(a.outlineLevel&&(a.level=+a.outlineLevel||0),delete a.min,delete a.max,a.width=+a.width,!r&&a.width&&(r=!0,R1(a.width)),qc(a);l<=o;)t[l++]=En(a)}}function kV(t){var e={ref:(t.match(/ref="([^"]*)"/)||[])[1]};return e}var RV=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function DV(t,e){e.Views||(e.Views=[{}]),(t.match(RV)||[]).forEach(function(r,n){var a=it(r);e.Views[n]||(e.Views[n]={}),+a.zoomScale&&(e.Views[n].zoom=+a.zoomScale),Tr(a.rightToLeft)&&(e.Views[n].RTL=!0)})}var IV=(function(){var t=/<(?:\w+:)?c[ \/>]/,e=/<\/(?:\w+:)?row>/,r=/r=["']([^"']*)["']/,n=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,a=/ref=["']([^"']*)["']/,l=Bf("v"),o=Bf("f");return function(h,m,p,v,_,w){for(var E=0,T="",A=[],M=[],F=0,R=0,z=0,re="",te,b,N=0,k=0,j,L,P=0,U=0,Ce=Array.isArray(w.CellXf),Ne,ae=[],ue=[],pe=Array.isArray(m),ne=[],be={},Q=!1,I=!!p.sheetStubs,Z=h.split(e),ee=0,B=Z.length;ee!=B;++ee){T=Z[ee].trim();var se=T.length;if(se!==0){var _e=0;e:for(E=0;E<se;++E)switch(T[E]){case">":if(T[E-1]!="/"){++E;break e}if(p&&p.cellStyles){if(b=it(T.slice(_e,E),!0),N=b.r!=null?parseInt(b.r,10):N+1,k=-1,p.sheetRows&&p.sheetRows<N)continue;be={},Q=!1,b.ht&&(Q=!0,be.hpt=parseFloat(b.ht),be.hpx=Gf(be.hpt)),b.hidden=="1"&&(Q=!0,be.hidden=!0),b.outlineLevel!=null&&(Q=!0,be.level=+b.outlineLevel),Q&&(ne[N-1]=be)}break;case"<":_e=E;break}if(_e>=E)break;if(b=it(T.slice(_e,E),!0),N=b.r!=null?parseInt(b.r,10):N+1,k=-1,!(p.sheetRows&&p.sheetRows<N)){v.s.r>N-1&&(v.s.r=N-1),v.e.r<N-1&&(v.e.r=N-1),p&&p.cellStyles&&(be={},Q=!1,b.ht&&(Q=!0,be.hpt=parseFloat(b.ht),be.hpx=Gf(be.hpt)),b.hidden=="1"&&(Q=!0,be.hidden=!0),b.outlineLevel!=null&&(Q=!0,be.level=+b.outlineLevel),Q&&(ne[N-1]=be)),A=T.slice(E).split(t);for(var Pe=0;Pe!=A.length&&A[Pe].trim().charAt(0)=="<";++Pe);for(A=A.slice(Pe),E=0;E!=A.length;++E)if(T=A[E].trim(),T.length!==0){if(M=T.match(r),F=E,R=0,z=0,T="<c "+(T.slice(0,1)=="<"?">":"")+T,M!=null&&M.length===2){for(F=0,re=M[1],R=0;R!=re.length&&!((z=re.charCodeAt(R)-64)<1||z>26);++R)F=26*F+z;--F,k=F}else++k;for(R=0;R!=T.length&&T.charCodeAt(R)!==62;++R);if(++R,b=it(T.slice(0,R),!0),b.r||(b.r=dt({r:N-1,c:k})),re=T.slice(R),te={t:""},(M=re.match(l))!=null&&M[1]!==""&&(te.v=Gt(M[1])),p.cellFormula){if((M=re.match(o))!=null&&M[1]!==""){if(te.f=Gt(fr(M[1])).replace(/\r\n/g,`
`),p.xlfn||(te.f=$E(te.f)),M[0].indexOf('t="array"')>-1)te.F=(re.match(a)||[])[1],te.F.indexOf(":")>-1&&ae.push([Dr(te.F),te.F]);else if(M[0].indexOf('t="shared"')>-1){L=it(M[0]);var he=Gt(fr(M[1]));p.xlfn||(he=$E(he)),ue[parseInt(L.si,10)]=[L,he,b.r]}}else(M=re.match(/<f[^>]*\/>/))&&(L=it(M[0]),ue[L.si]&&(te.f=H7(ue[L.si][1],ue[L.si][2],b.r)));var we=Jn(b.r);for(R=0;R<ae.length;++R)we.r>=ae[R][0].s.r&&we.r<=ae[R][0].e.r&&we.c>=ae[R][0].s.c&&we.c<=ae[R][0].e.c&&(te.F=ae[R][1])}if(b.t==null&&te.v===void 0)if(te.f||te.F)te.v=0,te.t="n";else if(I)te.t="z";else continue;else te.t=b.t||"n";switch(v.s.c>k&&(v.s.c=k),v.e.c<k&&(v.e.c=k),te.t){case"n":if(te.v==""||te.v==null){if(!I)continue;te.t="z"}else te.v=parseFloat(te.v);break;case"s":if(typeof te.v>"u"){if(!I)continue;te.t="z"}else j=Ef[parseInt(te.v,10)],te.v=j.t,te.r=j.r,p.cellHTML&&(te.h=j.h);break;case"str":te.t="s",te.v=te.v!=null?fr(te.v):"",p.cellHTML&&(te.h=y1(te.v));break;case"inlineStr":M=re.match(n),te.t="s",M!=null&&(j=k1(M[1]))?(te.v=j.t,p.cellHTML&&(te.h=j.h)):te.v="";break;case"b":te.v=Tr(te.v);break;case"d":p.cellDates?te.v=hn(te.v,1):(te.v=ra(hn(te.v,1)),te.t="n");break;case"e":(!p||p.cellText!==!1)&&(te.w=te.v),te.v=iC[te.v];break}if(P=U=0,Ne=null,Ce&&b.s!==void 0&&(Ne=w.CellXf[b.s],Ne!=null&&(Ne.numFmtId!=null&&(P=Ne.numFmtId),p.cellStyles&&Ne.fillId!=null&&(U=Ne.fillId))),LC(te,P,U,p,_,w),p.cellDates&&Ce&&te.t=="n"&&Jc(yt[P])&&(te.t="d",te.v=Em(te.v)),b.cm&&p.xlmeta){var He=(p.xlmeta.Cell||[])[+b.cm-1];He&&He.type=="XLDAPR"&&(te.D=!0)}if(pe){var J=Jn(b.r);m[J.r]||(m[J.r]=[]),m[J.r][J.c]=te}else m[b.r]=te}}}}ne.length>0&&(m["!rows"]=ne)}})();function OV(t,e){var r={},n=t.l+e;r.r=t.read_shift(4),t.l+=4;var a=t.read_shift(2);t.l+=1;var l=t.read_shift(1);return t.l=n,l&7&&(r.level=l&7),l&16&&(r.hidden=!0),l&32&&(r.hpt=a/20),r}var MV=Io;function jV(){}function FV(t,e){var r={},n=t[t.l];return++t.l,r.above=!(n&64),r.left=!(n&128),t.l+=18,r.name=a5(t),r}function PV(t){var e=ts(t);return[e]}function LV(t){var e=Do(t);return[e]}function UV(t){var e=ts(t),r=t.read_shift(1);return[e,r,"b"]}function BV(t){var e=Do(t),r=t.read_shift(1);return[e,r,"b"]}function VV(t){var e=ts(t),r=t.read_shift(1);return[e,r,"e"]}function zV(t){var e=Do(t),r=t.read_shift(1);return[e,r,"e"]}function HV(t){var e=ts(t),r=t.read_shift(4);return[e,r,"s"]}function GV(t){var e=Do(t),r=t.read_shift(4);return[e,r,"s"]}function qV(t){var e=ts(t),r=Fn(t);return[e,r,"n"]}function BC(t){var e=Do(t),r=Fn(t);return[e,r,"n"]}function WV(t){var e=ts(t),r=A1(t);return[e,r,"n"]}function KV(t){var e=Do(t),r=A1(t);return[e,r,"n"]}function YV(t){var e=ts(t),r=b1(t);return[e,r,"is"]}function $V(t){var e=ts(t),r=Un(t);return[e,r,"str"]}function XV(t){var e=Do(t),r=Un(t);return[e,r,"str"]}function QV(t,e,r){var n=t.l+e,a=ts(t);a.r=r["!row"];var l=t.read_shift(1),o=[a,l,"b"];if(r.cellFormula){t.l+=2;var u=Am(t,n-t.l,r);o[3]=Mn(u,null,a,r.supbooks,r)}else t.l=n;return o}function JV(t,e,r){var n=t.l+e,a=ts(t);a.r=r["!row"];var l=t.read_shift(1),o=[a,l,"e"];if(r.cellFormula){t.l+=2;var u=Am(t,n-t.l,r);o[3]=Mn(u,null,a,r.supbooks,r)}else t.l=n;return o}function ZV(t,e,r){var n=t.l+e,a=ts(t);a.r=r["!row"];var l=Fn(t),o=[a,l,"n"];if(r.cellFormula){t.l+=2;var u=Am(t,n-t.l,r);o[3]=Mn(u,null,a,r.supbooks,r)}else t.l=n;return o}function ez(t,e,r){var n=t.l+e,a=ts(t);a.r=r["!row"];var l=Un(t),o=[a,l,"str"];if(r.cellFormula){t.l+=2;var u=Am(t,n-t.l,r);o[3]=Mn(u,null,a,r.supbooks,r)}else t.l=n;return o}var tz=Io;function rz(t,e){var r=t.l+e,n=Io(t),a=S1(t),l=Un(t),o=Un(t),u=Un(t);t.l=r;var h={rfx:n,relId:a,loc:l,display:u};return o&&(h.Tooltip=o),h}function nz(){}function az(t,e,r){var n=t.l+e,a=nC(t),l=t.read_shift(1),o=[a];if(o[2]=l,r.cellFormula){var u=cV(t,n-t.l,r);o[1]=u}else t.l=n;return o}function sz(t,e,r){var n=t.l+e,a=Io(t),l=[a];if(r.cellFormula){var o=fV(t,n-t.l,r);l[1]=o,t.l=n}else t.l=n;return l}var iz=["left","right","top","bottom","header","footer"];function lz(t){var e={};return iz.forEach(function(r){e[r]=Fn(t)}),e}function oz(t){var e=t.read_shift(2);return t.l+=28,{RTL:e&32}}function cz(){}function uz(){}function fz(t,e,r,n,a,l,o){if(!t)return t;var u=e||{};n||(n={"!id":{}});var h=u.dense?[]:{},m,p={s:{r:2e6,c:2e6},e:{r:0,c:0}},v=!1,_=!1,w,E,T,A,M,F,R,z,re,te=[];u.biff=12,u["!row"]=0;var b=0,N=!1,k=[],j={},L=u.supbooks||a.supbooks||[[]];if(L.sharedf=j,L.arrayf=k,L.SheetNames=a.SheetNames||a.Sheets.map(function(pe){return pe.name}),!u.supbooks&&(u.supbooks=L,a.Names))for(var P=0;P<a.Names.length;++P)L[0][P+1]=a.Names[P];var U=[],Ce=[],Ne=!1;q0[16]={n:"BrtShortReal",f:BC};var ae;if(Ai(t,function(ne,be,Q){if(!_)switch(Q){case 148:m=ne;break;case 0:w=ne,u.sheetRows&&u.sheetRows<=w.r&&(_=!0),z=bn(A=w.r),u["!row"]=w.r,(ne.hidden||ne.hpt||ne.level!=null)&&(ne.hpt&&(ne.hpx=Gf(ne.hpt)),Ce[ne.r]=ne);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(E={t:ne[2]},ne[2]){case"n":E.v=ne[1];break;case"s":R=Ef[ne[1]],E.v=R.t,E.r=R.r;break;case"b":E.v=!!ne[1];break;case"e":E.v=ne[1],u.cellText!==!1&&(E.w=Oo[E.v]);break;case"str":E.t="s",E.v=ne[1];break;case"is":E.t="s",E.v=ne[1].t;break}if((T=o.CellXf[ne[0].iStyleRef])&&LC(E,T.numFmtId,null,u,l,o),M=ne[0].c==-1?M+1:ne[0].c,u.dense?(h[A]||(h[A]=[]),h[A][M]=E):h[en(M)+z]=E,u.cellFormula){for(N=!1,b=0;b<k.length;++b){var I=k[b];w.r>=I[0].s.r&&w.r<=I[0].e.r&&M>=I[0].s.c&&M<=I[0].e.c&&(E.F=Ht(I[0]),N=!0)}!N&&ne.length>3&&(E.f=ne[3])}if(p.s.r>w.r&&(p.s.r=w.r),p.s.c>M&&(p.s.c=M),p.e.r<w.r&&(p.e.r=w.r),p.e.c<M&&(p.e.c=M),u.cellDates&&T&&E.t=="n"&&Jc(yt[T.numFmtId])){var Z=oo(E.v);Z&&(E.t="d",E.v=new Date(Z.y,Z.m-1,Z.d,Z.H,Z.M,Z.S,Z.u))}ae&&(ae.type=="XLDAPR"&&(E.D=!0),ae=void 0);break;case 1:case 12:if(!u.sheetStubs||v)break;E={t:"z",v:void 0},M=ne[0].c==-1?M+1:ne[0].c,u.dense?(h[A]||(h[A]=[]),h[A][M]=E):h[en(M)+z]=E,p.s.r>w.r&&(p.s.r=w.r),p.s.c>M&&(p.s.c=M),p.e.r<w.r&&(p.e.r=w.r),p.e.c<M&&(p.e.c=M),ae&&(ae.type=="XLDAPR"&&(E.D=!0),ae=void 0);break;case 176:te.push(ne);break;case 49:ae=((u.xlmeta||{}).Cell||[])[ne-1];break;case 494:var ee=n["!id"][ne.relId];for(ee?(ne.Target=ee.Target,ne.loc&&(ne.Target+="#"+ne.loc),ne.Rel=ee):ne.relId==""&&(ne.Target="#"+ne.loc),A=ne.rfx.s.r;A<=ne.rfx.e.r;++A)for(M=ne.rfx.s.c;M<=ne.rfx.e.c;++M)u.dense?(h[A]||(h[A]=[]),h[A][M]||(h[A][M]={t:"z",v:void 0}),h[A][M].l=ne):(F=dt({c:M,r:A}),h[F]||(h[F]={t:"z",v:void 0}),h[F].l=ne);break;case 426:if(!u.cellFormula)break;k.push(ne),re=u.dense?h[A][M]:h[en(M)+z],re.f=Mn(ne[1],p,{r:w.r,c:M},L,u),re.F=Ht(ne[0]);break;case 427:if(!u.cellFormula)break;j[dt(ne[0].s)]=ne[1],re=u.dense?h[A][M]:h[en(M)+z],re.f=Mn(ne[1],p,{r:w.r,c:M},L,u);break;case 60:if(!u.cellStyles)break;for(;ne.e>=ne.s;)U[ne.e--]={width:ne.w/256,hidden:!!(ne.flags&1),level:ne.level},Ne||(Ne=!0,R1(ne.w/256)),qc(U[ne.e+1]);break;case 161:h["!autofilter"]={ref:Ht(ne)};break;case 476:h["!margins"]=ne;break;case 147:a.Sheets[r]||(a.Sheets[r]={}),ne.name&&(a.Sheets[r].CodeName=ne.name),(ne.above||ne.left)&&(h["!outline"]={above:ne.above,left:ne.left});break;case 137:a.Views||(a.Views=[{}]),a.Views[0]||(a.Views[0]={}),ne.RTL&&(a.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:v=!0;break;case 36:v=!1;break;case 37:v=!0;break;case 38:v=!1;break;default:if(!be.T){if(!v||u.WTF)throw new Error("Unexpected record 0x"+Q.toString(16))}}},u),delete u.supbooks,delete u["!row"],!h["!ref"]&&(p.s.r<2e6||m&&(m.e.r>0||m.e.c>0||m.s.r>0||m.s.c>0))&&(h["!ref"]=Ht(m||p)),u.sheetRows&&h["!ref"]){var ue=Dr(h["!ref"]);u.sheetRows<=+ue.e.r&&(ue.e.r=u.sheetRows-1,ue.e.r>p.e.r&&(ue.e.r=p.e.r),ue.e.r<ue.s.r&&(ue.s.r=ue.e.r),ue.e.c>p.e.c&&(ue.e.c=p.e.c),ue.e.c<ue.s.c&&(ue.s.c=ue.e.c),h["!fullref"]=h["!ref"],h["!ref"]=Ht(ue))}return te.length>0&&(h["!merges"]=te),U.length>0&&(h["!cols"]=U),Ce.length>0&&(h["!rows"]=Ce),h}function hz(t){var e=[],r=t.match(/^<c:numCache>/),n;(t.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(l){var o=l.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);o&&(e[+o[1]]=r?+o[2]:o[2])});var a=Gt((t.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(t.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(l){n=l.replace(/<.*?>/g,"")}),[e,a,n]}function dz(t,e,r,n,a,l){var o=l||{"!type":"chart"};if(!t)return l;var u=0,h=0,m="A",p={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(t.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(v){var _=hz(v);p.s.r=p.s.c=0,p.e.c=u,m=en(u),_[0].forEach(function(w,E){o[m+bn(E)]={t:"n",v:w,z:_[1]},h=E}),p.e.r<h&&(p.e.r=h),++u}),u>0&&(o["!ref"]=Ht(p)),o}function mz(t,e,r,n,a){if(!t)return t;n||(n={"!id":{}});var l={"!type":"chart","!drawel":null,"!rel":""},o,u=t.match(UC);return u&&I1(u[0],l,a,r),(o=t.match(/drawing r:id="(.*?)"/))&&(l["!rel"]=o[1]),n["!id"][l["!rel"]]&&(l["!drawel"]=n["!id"][l["!rel"]]),l}function pz(t,e){t.l+=10;var r=Un(t);return{name:r}}function gz(t,e,r,n,a){if(!t)return t;n||(n={"!id":{}});var l={"!type":"chart","!drawel":null,"!rel":""},o=!1;return Ai(t,function(h,m,p){switch(p){case 550:l["!rel"]=h;break;case 651:a.Sheets[r]||(a.Sheets[r]={}),h.name&&(a.Sheets[r].CodeName=h.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:o=!0;break;case 36:o=!1;break;case 37:break;case 38:break;default:if(!(m.T>0)){if(!(m.T<0)){if(!o||e.WTF)throw new Error("Unexpected record 0x"+p.toString(16))}}}},e),n["!id"][l["!rel"]]&&(l["!drawel"]=n["!id"][l["!rel"]]),l}var VC=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],xz=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],vz=[],yz=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function eb(t,e){for(var r=0;r!=t.length;++r)for(var n=t[r],a=0;a!=e.length;++a){var l=e[a];if(n[l[0]]==null)n[l[0]]=l[1];else switch(l[2]){case"bool":typeof n[l[0]]=="string"&&(n[l[0]]=Tr(n[l[0]]));break;case"int":typeof n[l[0]]=="string"&&(n[l[0]]=parseInt(n[l[0]],10));break}}}function tb(t,e){for(var r=0;r!=e.length;++r){var n=e[r];if(t[n[0]]==null)t[n[0]]=n[1];else switch(n[2]){case"bool":typeof t[n[0]]=="string"&&(t[n[0]]=Tr(t[n[0]]));break;case"int":typeof t[n[0]]=="string"&&(t[n[0]]=parseInt(t[n[0]],10));break}}}function zC(t){tb(t.WBProps,VC),tb(t.CalcPr,yz),eb(t.WBView,xz),eb(t.Sheets,vz),Oc.date1904=Tr(t.WBProps.date1904)}var _z="][*?/\\".split("");function wz(t,e){if(t.length>31)throw new Error("Sheet names cannot exceed 31 chars");var r=!0;return _z.forEach(function(n){if(t.indexOf(n)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),r}var Tz=/<\w+:workbook/;function Ez(t,e){if(!t)throw new Error("Could not find file");var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},n=!1,a="xmlns",l={},o=0;if(t.replace(zn,function(h,m){var p=it(h);switch(Bs(p[0])){case"<?xml":break;case"<workbook":h.match(Tz)&&(a="xmlns"+h.match(/<(\w+):/)[1]),r.xmlns=p[a];break;case"</workbook>":break;case"<fileVersion":delete p[0],r.AppVersion=p;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":VC.forEach(function(v){if(p[v[0]]!=null)switch(v[2]){case"bool":r.WBProps[v[0]]=Tr(p[v[0]]);break;case"int":r.WBProps[v[0]]=parseInt(p[v[0]],10);break;default:r.WBProps[v[0]]=p[v[0]]}}),p.codeName&&(r.WBProps.CodeName=fr(p.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete p[0],r.WBView.push(p);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(p.state){case"hidden":p.Hidden=1;break;case"veryHidden":p.Hidden=2;break;default:p.Hidden=0}delete p.state,p.name=Gt(fr(p.name)),delete p[0],r.Sheets.push(p);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":n=!0;break;case"</definedNames>":n=!1;break;case"<definedName":l={},l.Name=fr(p.name),p.comment&&(l.Comment=p.comment),p.localSheetId&&(l.Sheet=+p.localSheetId),Tr(p.hidden||"0")&&(l.Hidden=!0),o=m+h.length;break;case"</definedName>":l.Ref=Gt(fr(t.slice(o,m))),r.Names.push(l);break;case"<definedName/>":break;case"<calcPr":delete p[0],r.CalcPr=p;break;case"<calcPr/>":delete p[0],r.CalcPr=p;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":n=!0;break;case"</AlternateContent>":n=!1;break;case"<revisionPtr":break;default:if(!n&&e.WTF)throw new Error("unrecognized "+p[0]+" in workbook")}return h}),VL.indexOf(r.xmlns)===-1)throw new Error("Unknown Namespace: "+r.xmlns);return zC(r),r}function bz(t,e){var r={};return r.Hidden=t.read_shift(4),r.iTabID=t.read_shift(4),r.strRelID=Bx(t),r.name=Un(t),r}function Sz(t,e){var r={},n=t.read_shift(4);r.defaultThemeVersion=t.read_shift(4);var a=e>8?Un(t):"";return a.length>0&&(r.CodeName=a),r.autoCompressPictures=!!(n&65536),r.backupFile=!!(n&64),r.checkCompatibility=!!(n&4096),r.date1904=!!(n&1),r.filterPrivacy=!!(n&8),r.hidePivotFieldList=!!(n&1024),r.promptedSolutions=!!(n&16),r.publishItems=!!(n&2048),r.refreshAllConnections=!!(n&262144),r.saveExternalLinkValues=!!(n&128),r.showBorderUnselectedTables=!!(n&4),r.showInkAnnotation=!!(n&32),r.showObjects=["all","placeholders","none"][n>>13&3],r.showPivotChartFilter=!!(n&32768),r.updateLinks=["userSet","never","always"][n>>8&3],r}function Az(t,e){var r={};return t.read_shift(4),r.ArchID=t.read_shift(4),t.l+=e-8,r}function Nz(t,e,r){var n=t.l+e;t.l+=4,t.l+=1;var a=t.read_shift(4),l=s5(t),o=uV(t,0,r),u=S1(t);t.l=n;var h={Name:l,Ptg:o};return a<268435455&&(h.Sheet=a),u&&(h.Comment=u),h}function Cz(t,e){var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},n=[],a=!1;e||(e={}),e.biff=12;var l=[],o=[[]];return o.SheetNames=[],o.XTI=[],q0[16]={n:"BrtFRTArchID$",f:Az},Ai(t,function(h,m,p){switch(p){case 156:o.SheetNames.push(h.name),r.Sheets.push(h);break;case 153:r.WBProps=h;break;case 39:h.Sheet!=null&&(e.SID=h.Sheet),h.Ref=Mn(h.Ptg,null,null,o,e),delete e.SID,delete h.Ptg,l.push(h);break;case 1036:break;case 357:case 358:case 355:case 667:o[0].length?o.push([p,h]):o[0]=[p,h],o[o.length-1].XTI=[];break;case 362:o.length===0&&(o[0]=[],o[0].XTI=[]),o[o.length-1].XTI=o[o.length-1].XTI.concat(h),o.XTI=o.XTI.concat(h);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:n.push(p),a=!0;break;case 36:n.pop(),a=!1;break;case 37:n.push(p),a=!0;break;case 38:n.pop(),a=!1;break;case 16:break;default:if(!m.T){if(!a||e.WTF&&n[n.length-1]!=37&&n[n.length-1]!=35)throw new Error("Unexpected record 0x"+p.toString(16))}}},e),zC(r),r.Names=l,r.supbooks=o,r}function kz(t,e,r){return e.slice(-4)===".bin"?Cz(t,r):Ez(t,r)}function Rz(t,e,r,n,a,l,o,u){return e.slice(-4)===".bin"?fz(t,n,r,a,l,o,u):bV(t,n,r,a,l,o,u)}function Dz(t,e,r,n,a,l,o,u){return e.slice(-4)===".bin"?gz(t,n,r,a,l):mz(t,n,r,a,l)}function Iz(t,e,r,n,a,l,o,u){return e.slice(-4)===".bin"?B7():V7()}function Oz(t,e,r,n,a,l,o,u){return e.slice(-4)===".bin"?L7():U7()}function Mz(t,e,r,n){return e.slice(-4)===".bin"?t7(t,r,n):$U(t,r,n)}function jz(t,e,r){return CC(t,r)}function Fz(t,e,r){return e.slice(-4)===".bin"?xU(t,r):pU(t,r)}function Pz(t,e,r){return e.slice(-4)===".bin"?j7(t,r):R7(t,r)}function Lz(t,e,r){return e.slice(-4)===".bin"?N7(t):S7(t)}function Uz(t,e,r,n){return r.slice(-4)===".bin"?C7(t,e,r,n):void 0}function Bz(t,e,r){return e.slice(-4)===".bin"?E7(t,e,r):b7(t,e,r)}var HC=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,GC=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function os(t,e){var r=t.split(/\s+/),n=[];if(n[0]=r[0],r.length===1)return n;var a=t.match(HC),l,o,u,h;if(a)for(h=0;h!=a.length;++h)l=a[h].match(GC),(o=l[1].indexOf(":"))===-1?n[l[1]]=l[2].slice(1,l[2].length-1):(l[1].slice(0,6)==="xmlns:"?u="xmlns"+l[1].slice(6):u=l[1].slice(o+1),n[u]=l[2].slice(1,l[2].length-1));return n}function Vz(t){var e=t.split(/\s+/),r={};if(e.length===1)return r;var n=t.match(HC),a,l,o,u;if(n)for(u=0;u!=n.length;++u)a=n[u].match(GC),(l=a[1].indexOf(":"))===-1?r[a[1]]=a[2].slice(1,a[2].length-1):(a[1].slice(0,6)==="xmlns:"?o="xmlns"+a[1].slice(6):o=a[1].slice(l+1),r[o]=a[2].slice(1,a[2].length-1));return r}var Sf;function zz(t,e){var r=Sf[t]||Gt(t);return r==="General"?To(e):es(r,e)}function Hz(t,e,r,n){var a=n;switch((r[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":a=Tr(n);break;case"i2":case"int":a=parseInt(n,10);break;case"r4":case"float":a=parseFloat(n);break;case"date":case"dateTime.tz":a=hn(n);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+r[0])}t[Gt(e)]=a}function Gz(t,e,r){if(t.t!=="z"){if(!r||r.cellText!==!1)try{t.t==="e"?t.w=t.w||Oo[t.v]:e==="General"?t.t==="n"?(t.v|0)===t.v?t.w=t.v.toString(10):t.w=Uf(t.v):t.w=To(t.v):t.w=zz(e||"General",t.v)}catch(l){if(r.WTF)throw l}try{var n=Sf[e]||e||"General";if(r.cellNF&&(t.z=n),r.cellDates&&t.t=="n"&&Jc(n)){var a=oo(t.v);a&&(t.t="d",t.v=new Date(a.y,a.m-1,a.d,a.H,a.M,a.S,a.u))}}catch(l){if(r.WTF)throw l}}}function qz(t,e,r){if(r.cellStyles&&e.Interior){var n=e.Interior;n.Pattern&&(n.patternType=HU[n.Pattern]||n.Pattern)}t[e.ID]=e}function Wz(t,e,r,n,a,l,o,u,h,m){var p="General",v=n.StyleID,_={};m=m||{};var w=[],E=0;for(v===void 0&&u&&(v=u.StyleID),v===void 0&&o&&(v=o.StyleID);l[v]!==void 0&&(l[v].nf&&(p=l[v].nf),l[v].Interior&&w.push(l[v].Interior),!!l[v].Parent);)v=l[v].Parent;switch(r.Type){case"Boolean":n.t="b",n.v=Tr(t);break;case"String":n.t="s",n.r=EE(Gt(t)),n.v=t.indexOf("<")>-1?Gt(e||t).replace(/<.*?>/g,""):n.r;break;case"DateTime":t.slice(-1)!="Z"&&(t+="Z"),n.v=(hn(t)-new Date(Date.UTC(1899,11,30)))/(1440*60*1e3),n.v!==n.v?n.v=Gt(t):n.v<60&&(n.v=n.v-1),(!p||p=="General")&&(p="yyyy-mm-dd");case"Number":n.v===void 0&&(n.v=+t),n.t||(n.t="n");break;case"Error":n.t="e",n.v=iC[t],m.cellText!==!1&&(n.w=t);break;default:t==""&&e==""?n.t="z":(n.t="s",n.v=EE(e||t));break}if(Gz(n,p,m),m.cellFormula!==!1)if(n.Formula){var T=Gt(n.Formula);T.charCodeAt(0)==61&&(T=T.slice(1)),n.f=Ic(T,a),delete n.Formula,n.ArrayRange=="RC"?n.F=Ic("RC:RC",a):n.ArrayRange&&(n.F=Ic(n.ArrayRange,a),h.push([Dr(n.F),n.F]))}else for(E=0;E<h.length;++E)a.r>=h[E][0].s.r&&a.r<=h[E][0].e.r&&a.c>=h[E][0].s.c&&a.c<=h[E][0].e.c&&(n.F=h[E][1]);m.cellStyles&&(w.forEach(function(A){!_.patternType&&A.patternType&&(_.patternType=A.patternType)}),n.s=_),n.StyleID!==void 0&&(n.ixfe=n.StyleID)}function Kz(t){t.t=t.v||"",t.t=t.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),t.v=t.w=t.ixfe=void 0}function tx(t,e){var r=e||{};IN();var n=af(_1(t));(r.type=="binary"||r.type=="array"||r.type=="base64")&&(n=fr(n));var a=n.slice(0,1024).toLowerCase(),l=!1;if(a=a.replace(/".*?"/g,""),(a.indexOf(">")&1023)>Math.min(a.indexOf(",")&1023,a.indexOf(";")&1023)){var o=En(r);return o.type="string",zf.to_workbook(n,o)}if(a.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(ut){a.indexOf("<"+ut)>=0&&(l=!0)}),l)return rH(n,r);Sf={"General Number":"General","General Date":yt[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":yt[15],"Short Date":yt[14],"Long Time":yt[19],"Medium Time":yt[18],"Short Time":yt[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:yt[2],Standard:yt[4],Percent:yt[10],Scientific:yt[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var u,h=[],m,p={},v=[],_=r.dense?[]:{},w="",E={},T={},A=os('<Data ss:Type="String">'),M=0,F=0,R=0,z={s:{r:2e6,c:2e6},e:{r:0,c:0}},re={},te={},b="",N=0,k=[],j={},L={},P=0,U=[],Ce=[],Ne={},ae=[],ue,pe=!1,ne=[],be=[],Q={},I=0,Z=0,ee={Sheets:[],WBProps:{date1904:!1}},B={};Vf.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"");for(var se="";u=Vf.exec(n);)switch(u[3]=(se=u[3]).toLowerCase()){case"data":if(se=="data"){if(u[1]==="/"){if((m=h.pop())[0]!==u[3])throw new Error("Bad state: "+m.join("|"))}else u[0].charAt(u[0].length-2)!=="/"&&h.push([u[3],!0]);break}if(h[h.length-1][1])break;u[1]==="/"?Wz(n.slice(M,u.index),b,A,h[h.length-1][0]=="comment"?Ne:E,{c:F,r:R},re,ae[F],T,ne,r):(b="",A=os(u[0]),M=u.index+u[0].length);break;case"cell":if(u[1]==="/")if(Ce.length>0&&(E.c=Ce),(!r.sheetRows||r.sheetRows>R)&&E.v!==void 0&&(r.dense?(_[R]||(_[R]=[]),_[R][F]=E):_[en(F)+bn(R)]=E),E.HRef&&(E.l={Target:Gt(E.HRef)},E.HRefScreenTip&&(E.l.Tooltip=E.HRefScreenTip),delete E.HRef,delete E.HRefScreenTip),(E.MergeAcross||E.MergeDown)&&(I=F+(parseInt(E.MergeAcross,10)|0),Z=R+(parseInt(E.MergeDown,10)|0),k.push({s:{c:F,r:R},e:{c:I,r:Z}})),!r.sheetStubs)E.MergeAcross?F=I+1:++F;else if(E.MergeAcross||E.MergeDown){for(var _e=F;_e<=I;++_e)for(var Pe=R;Pe<=Z;++Pe)(_e>F||Pe>R)&&(r.dense?(_[Pe]||(_[Pe]=[]),_[Pe][_e]={t:"z"}):_[en(_e)+bn(Pe)]={t:"z"});F=I+1}else++F;else E=Vz(u[0]),E.Index&&(F=+E.Index-1),F<z.s.c&&(z.s.c=F),F>z.e.c&&(z.e.c=F),u[0].slice(-2)==="/>"&&++F,Ce=[];break;case"row":u[1]==="/"||u[0].slice(-2)==="/>"?(R<z.s.r&&(z.s.r=R),R>z.e.r&&(z.e.r=R),u[0].slice(-2)==="/>"&&(T=os(u[0]),T.Index&&(R=+T.Index-1)),F=0,++R):(T=os(u[0]),T.Index&&(R=+T.Index-1),Q={},(T.AutoFitHeight=="0"||T.Height)&&(Q.hpx=parseInt(T.Height,10),Q.hpt=NC(Q.hpx),be[R]=Q),T.Hidden=="1"&&(Q.hidden=!0,be[R]=Q));break;case"worksheet":if(u[1]==="/"){if((m=h.pop())[0]!==u[3])throw new Error("Bad state: "+m.join("|"));v.push(w),z.s.r<=z.e.r&&z.s.c<=z.e.c&&(_["!ref"]=Ht(z),r.sheetRows&&r.sheetRows<=z.e.r&&(_["!fullref"]=_["!ref"],z.e.r=r.sheetRows-1,_["!ref"]=Ht(z))),k.length&&(_["!merges"]=k),ae.length>0&&(_["!cols"]=ae),be.length>0&&(_["!rows"]=be),p[w]=_}else z={s:{r:2e6,c:2e6},e:{r:0,c:0}},R=F=0,h.push([u[3],!1]),m=os(u[0]),w=Gt(m.Name),_=r.dense?[]:{},k=[],ne=[],be=[],B={name:w,Hidden:0},ee.Sheets.push(B);break;case"table":if(u[1]==="/"){if((m=h.pop())[0]!==u[3])throw new Error("Bad state: "+m.join("|"))}else{if(u[0].slice(-2)=="/>")break;h.push([u[3],!1]),ae=[],pe=!1}break;case"style":u[1]==="/"?qz(re,te,r):te=os(u[0]);break;case"numberformat":te.nf=Gt(os(u[0]).Format||"General"),Sf[te.nf]&&(te.nf=Sf[te.nf]);for(var he=0;he!=392&&yt[he]!=te.nf;++he);if(he==392){for(he=57;he!=392;++he)if(yt[he]==null){ho(te.nf,he);break}}break;case"column":if(h[h.length-1][0]!=="table")break;if(ue=os(u[0]),ue.Hidden&&(ue.hidden=!0,delete ue.Hidden),ue.Width&&(ue.wpx=parseInt(ue.Width,10)),!pe&&ue.wpx>10){pe=!0,Qn=SC;for(var we=0;we<ae.length;++we)ae[we]&&qc(ae[we])}pe&&qc(ue),ae[ue.Index-1||ae.length]=ue;for(var He=0;He<+ue.Span;++He)ae[ae.length]=En(ue);break;case"namedrange":if(u[1]==="/")break;ee.Names||(ee.Names=[]);var J=it(u[0]),Qe={Name:J.Name,Ref:Ic(J.RefersTo.slice(1),{r:0,c:0})};ee.Sheets.length>0&&(Qe.Sheet=ee.Sheets.length-1),ee.Names.push(Qe);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(u[0].slice(-2)==="/>")break;u[1]==="/"?b+=n.slice(N,u.index):N=u.index+u[0].length;break;case"interior":if(!r.cellStyles)break;te.Interior=os(u[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(u[0].slice(-2)==="/>")break;u[1]==="/"?R5(j,se,n.slice(P,u.index)):P=u.index+u[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(u[1]==="/"){if((m=h.pop())[0]!==u[3])throw new Error("Bad state: "+m.join("|"))}else h.push([u[3],!1]);break;case"comment":if(u[1]==="/"){if((m=h.pop())[0]!==u[3])throw new Error("Bad state: "+m.join("|"));Kz(Ne),Ce.push(Ne)}else h.push([u[3],!1]),m=os(u[0]),Ne={a:m.Author};break;case"autofilter":if(u[1]==="/"){if((m=h.pop())[0]!==u[3])throw new Error("Bad state: "+m.join("|"))}else if(u[0].charAt(u[0].length-2)!=="/"){var $e=os(u[0]);_["!autofilter"]={ref:Ic($e.Range).replace(/\$/g,"")},h.push([u[3],!0])}break;case"name":break;case"datavalidation":if(u[1]==="/"){if((m=h.pop())[0]!==u[3])throw new Error("Bad state: "+m.join("|"))}else u[0].charAt(u[0].length-2)!=="/"&&h.push([u[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(u[1]==="/"){if((m=h.pop())[0]!==u[3])throw new Error("Bad state: "+m.join("|"))}else u[0].charAt(u[0].length-2)!=="/"&&h.push([u[3],!0]);break;case"null":break;default:if(h.length==0&&u[3]=="document"||h.length==0&&u[3]=="uof")return lb(n,r);var Fe=!0;switch(h[h.length-1][0]){case"officedocumentsettings":switch(u[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:Fe=!1}break;case"componentoptions":switch(u[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:Fe=!1}break;case"excelworkbook":switch(u[3]){case"date1904":ee.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:Fe=!1}break;case"workbookoptions":switch(u[3]){case"owcversion":break;case"height":break;case"width":break;default:Fe=!1}break;case"worksheetoptions":switch(u[3]){case"visible":if(u[0].slice(-2)!=="/>")if(u[1]==="/")switch(n.slice(P,u.index)){case"SheetHidden":B.Hidden=1;break;case"SheetVeryHidden":B.Hidden=2;break}else P=u.index+u[0].length;break;case"header":_["!margins"]||bf(_["!margins"]={},"xlml"),isNaN(+it(u[0]).Margin)||(_["!margins"].header=+it(u[0]).Margin);break;case"footer":_["!margins"]||bf(_["!margins"]={},"xlml"),isNaN(+it(u[0]).Margin)||(_["!margins"].footer=+it(u[0]).Margin);break;case"pagemargins":var Ue=it(u[0]);_["!margins"]||bf(_["!margins"]={},"xlml"),isNaN(+Ue.Top)||(_["!margins"].top=+Ue.Top),isNaN(+Ue.Left)||(_["!margins"].left=+Ue.Left),isNaN(+Ue.Right)||(_["!margins"].right=+Ue.Right),isNaN(+Ue.Bottom)||(_["!margins"].bottom=+Ue.Bottom);break;case"displayrighttoleft":ee.Views||(ee.Views=[]),ee.Views[0]||(ee.Views[0]={}),ee.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":_["!outline"]||(_["!outline"]={}),_["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":_["!outline"]||(_["!outline"]={}),_["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:Fe=!1}break;case"pivottable":case"pivotcache":switch(u[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:Fe=!1}break;case"pagebreaks":switch(u[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:Fe=!1}break;case"autofilter":switch(u[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:Fe=!1}break;case"querytable":switch(u[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:Fe=!1}break;case"datavalidation":switch(u[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:Fe=!1}break;case"sorting":case"conditionalformatting":switch(u[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:Fe=!1}break;case"mapinfo":case"schema":case"data":switch(u[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:Fe=!1}break;case"smarttags":break;default:Fe=!1;break}if(Fe||u[3].match(/!\[CDATA/))break;if(!h[h.length-1][1])throw"Unrecognized tag: "+u[3]+"|"+h.join("|");if(h[h.length-1][0]==="customdocumentproperties"){if(u[0].slice(-2)==="/>")break;u[1]==="/"?Hz(L,se,U,n.slice(P,u.index)):(U=u,P=u.index+u[0].length);break}if(r.WTF)throw"Unrecognized tag: "+u[3]+"|"+h.join("|")}var De={};return!r.bookSheets&&!r.bookProps&&(De.Sheets=p),De.SheetNames=v,De.Workbook=ee,De.SSF=En(yt),De.Props=j,De.Custprops=L,De}function Gx(t,e){switch(j1(e=e||{}),e.type||"base64"){case"base64":return tx(Oa(t),e);case"binary":case"buffer":case"file":return tx(t,e);case"array":return tx(Ro(t),e)}}function Yz(t){var e={},r=t.content;if(r.l=28,e.AnsiUserType=r.read_shift(0,"lpstr-ansi"),e.AnsiClipboardFormat=o5(r),r.length-r.l<=4)return e;var n=r.read_shift(4);if(n==0||n>40||(r.l-=4,e.Reserved1=r.read_shift(0,"lpstr-ansi"),r.length-r.l<=4)||(n=r.read_shift(4),n!==1907505652)||(e.UnicodeClipboardFormat=c5(r),n=r.read_shift(4),n==0||n>40))return e;r.l-=4,e.Reserved2=r.read_shift(0,"lpwstr")}var $z=[60,1084,2066,2165,2175];function Xz(t,e,r,n,a){var l=n,o=[],u=r.slice(r.l,r.l+l);if(a&&a.enc&&a.enc.insitu&&u.length>0)switch(t){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:a.enc.insitu(u)}o.push(u),r.l+=l;for(var h=hi(r,r.l),m=qx[h],p=0;m!=null&&$z.indexOf(h)>-1;)l=hi(r,r.l+2),p=r.l+4,h==2066?p+=4:(h==2165||h==2175)&&(p+=12),u=r.slice(p,r.l+4+l),o.push(u),r.l+=4+l,m=qx[h=hi(r,r.l)];var v=dl(o);_n(v,0);var _=0;v.lens=[];for(var w=0;w<o.length;++w)v.lens.push(_),_+=o[w].length;if(v.length<n)throw"XLS Record 0x"+t.toString(16)+" Truncated: "+v.length+" < "+n;return e.f(v,v.length,a)}function Cs(t,e,r){if(t.t!=="z"&&t.XF){var n=0;try{n=t.z||t.XF.numFmtId||0,e.cellNF&&(t.z=yt[n])}catch(l){if(e.WTF)throw l}if(!e||e.cellText!==!1)try{t.t==="e"?t.w=t.w||Oo[t.v]:n===0||n=="General"?t.t==="n"?(t.v|0)===t.v?t.w=t.v.toString(10):t.w=Uf(t.v):t.w=To(t.v):t.w=es(n,t.v,{date1904:!!r,dateNF:e&&e.dateNF})}catch(l){if(e.WTF)throw l}if(e.cellDates&&n&&t.t=="n"&&Jc(yt[n]||String(n))){var a=oo(t.v);a&&(t.t="d",t.v=new Date(a.y,a.m-1,a.d,a.H,a.M,a.S,a.u))}}}function t0(t,e,r){return{v:t,ixfe:e,t:r}}function Qz(t,e){var r={opts:{}},n={},a=e.dense?[]:{},l={},o={},u=null,h=[],m="",p={},v,_="",w,E,T,A,M={},F=[],R,z,re=[],te=[],b={Sheets:[],WBProps:{date1904:!1},Views:[{}]},N={},k=function(lt){return lt<8?mo[lt]:lt<64&&te[lt-8]||mo[lt]},j=function(lt,Zt,Sr){var St=Zt.XF.data;if(!(!St||!St.patternType||!Sr||!Sr.cellStyles)){Zt.s={},Zt.s.patternType=St.patternType;var or;(or=Hf(k(St.icvFore)))&&(Zt.s.fgColor={rgb:or}),(or=Hf(k(St.icvBack)))&&(Zt.s.bgColor={rgb:or})}},L=function(lt,Zt,Sr){if(!(Q>1)&&!(Sr.sheetRows&&lt.r>=Sr.sheetRows)){if(Sr.cellStyles&&Zt.XF&&Zt.XF.data&&j(lt,Zt,Sr),delete Zt.ixfe,delete Zt.XF,v=lt,_=dt(lt),(!o||!o.s||!o.e)&&(o={s:{r:0,c:0},e:{r:0,c:0}}),lt.r<o.s.r&&(o.s.r=lt.r),lt.c<o.s.c&&(o.s.c=lt.c),lt.r+1>o.e.r&&(o.e.r=lt.r+1),lt.c+1>o.e.c&&(o.e.c=lt.c+1),Sr.cellFormula&&Zt.f){for(var St=0;St<F.length;++St)if(!(F[St][0].s.c>lt.c||F[St][0].s.r>lt.r)&&!(F[St][0].e.c<lt.c||F[St][0].e.r<lt.r)){Zt.F=Ht(F[St][0]),(F[St][0].s.c!=lt.c||F[St][0].s.r!=lt.r)&&delete Zt.f,Zt.f&&(Zt.f=""+Mn(F[St][1],o,lt,ne,P));break}}Sr.dense?(a[lt.r]||(a[lt.r]=[]),a[lt.r][lt.c]=Zt):a[_]=Zt}},P={enc:!1,sbcch:0,snames:[],sharedf:M,arrayf:F,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!e&&!!e.cellStyles,WTF:!!e&&!!e.wtf};e.password&&(P.password=e.password);var U,Ce=[],Ne=[],ae=[],ue=[],pe=!1,ne=[];ne.SheetNames=P.snames,ne.sharedf=P.sharedf,ne.arrayf=P.arrayf,ne.names=[],ne.XTI=[];var be=0,Q=0,I=0,Z=[],ee=[],B;P.codepage=1200,ds(1200);for(var se=!1;t.l<t.length-1;){var _e=t.l,Pe=t.read_shift(2);if(Pe===0&&be===10)break;var he=t.l===t.length?0:t.read_shift(2),we=qx[Pe];if(we&&we.f){if(e.bookSheets&&be===133&&Pe!==133)break;if(be=Pe,we.r===2||we.r==12){var He=t.read_shift(2);if(he-=2,!P.enc&&He!==Pe&&((He&255)<<8|He>>8)!==Pe)throw new Error("rt mismatch: "+He+"!="+Pe);we.r==12&&(t.l+=10,he-=10)}var J={};if(Pe===10?J=we.f(t,he,P):J=Xz(Pe,we,t,he,P),Q==0&&[9,521,1033,2057].indexOf(be)===-1)continue;switch(Pe){case 34:r.opts.Date1904=b.WBProps.date1904=J;break;case 134:r.opts.WriteProtect=!0;break;case 47:if(P.enc||(t.l=0),P.enc=J,!e.password)throw new Error("File is password-protected");if(J.valid==null)throw new Error("Encryption scheme unsupported");if(!J.valid)throw new Error("Password is incorrect");break;case 92:P.lastuser=J;break;case 66:var Qe=Number(J);switch(Qe){case 21010:Qe=1200;break;case 32768:Qe=1e4;break;case 32769:Qe=1252;break}ds(P.codepage=Qe),se=!0;break;case 317:P.rrtabid=J;break;case 25:P.winlocked=J;break;case 439:r.opts.RefreshAll=J;break;case 12:r.opts.CalcCount=J;break;case 16:r.opts.CalcDelta=J;break;case 17:r.opts.CalcIter=J;break;case 13:r.opts.CalcMode=J;break;case 14:r.opts.CalcPrecision=J;break;case 95:r.opts.CalcSaveRecalc=J;break;case 15:P.CalcRefMode=J;break;case 2211:r.opts.FullCalc=J;break;case 129:J.fDialog&&(a["!type"]="dialog"),J.fBelow||((a["!outline"]||(a["!outline"]={})).above=!0),J.fRight||((a["!outline"]||(a["!outline"]={})).left=!0);break;case 224:re.push(J);break;case 430:ne.push([J]),ne[ne.length-1].XTI=[];break;case 35:case 547:ne[ne.length-1].push(J);break;case 24:case 536:B={Name:J.Name,Ref:Mn(J.rgce,o,null,ne,P)},J.itab>0&&(B.Sheet=J.itab-1),ne.names.push(B),ne[0]||(ne[0]=[],ne[0].XTI=[]),ne[ne.length-1].push(J),J.Name=="_xlnm._FilterDatabase"&&J.itab>0&&J.rgce&&J.rgce[0]&&J.rgce[0][0]&&J.rgce[0][0][0]=="PtgArea3d"&&(ee[J.itab-1]={ref:Ht(J.rgce[0][0][1][2])});break;case 22:P.ExternCount=J;break;case 23:ne.length==0&&(ne[0]=[],ne[0].XTI=[]),ne[ne.length-1].XTI=ne[ne.length-1].XTI.concat(J),ne.XTI=ne.XTI.concat(J);break;case 2196:if(P.biff<8)break;B!=null&&(B.Comment=J[1]);break;case 18:a["!protect"]=J;break;case 19:J!==0&&P.WTF&&console.error("Password verifier: "+J);break;case 133:l[J.pos]=J,P.snames.push(J.name);break;case 10:{if(--Q)break;if(o.e){if(o.e.r>0&&o.e.c>0){if(o.e.r--,o.e.c--,a["!ref"]=Ht(o),e.sheetRows&&e.sheetRows<=o.e.r){var $e=o.e.r;o.e.r=e.sheetRows-1,a["!fullref"]=a["!ref"],a["!ref"]=Ht(o),o.e.r=$e}o.e.r++,o.e.c++}Ce.length>0&&(a["!merges"]=Ce),Ne.length>0&&(a["!objects"]=Ne),ae.length>0&&(a["!cols"]=ae),ue.length>0&&(a["!rows"]=ue),b.Sheets.push(N)}m===""?p=a:n[m]=a,a=e.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(P.biff===8&&(P.biff={9:2,521:3,1033:4}[Pe]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[J.BIFFVer]||8),P.biffguess=J.BIFFVer==0,J.BIFFVer==0&&J.dt==4096&&(P.biff=5,se=!0,ds(P.codepage=28591)),P.biff==8&&J.BIFFVer==0&&J.dt==16&&(P.biff=2),Q++)break;if(a=e.dense?[]:{},P.biff<8&&!se&&(se=!0,ds(P.codepage=e.codepage||1252)),P.biff<5||J.BIFFVer==0&&J.dt==4096){m===""&&(m="Sheet1"),o={s:{r:0,c:0},e:{r:0,c:0}};var Fe={pos:t.l-he,name:m};l[Fe.pos]=Fe,P.snames.push(m)}else m=(l[_e]||{name:""}).name;J.dt==32&&(a["!type"]="chart"),J.dt==64&&(a["!type"]="macro"),Ce=[],Ne=[],P.arrayf=F=[],ae=[],ue=[],pe=!1,N={Hidden:(l[_e]||{hs:0}).hs,name:m}}break;case 515:case 3:case 2:a["!type"]=="chart"&&(e.dense?(a[J.r]||[])[J.c]:a[dt({c:J.c,r:J.r})])&&++J.c,R={ixfe:J.ixfe,XF:re[J.ixfe]||{},v:J.val,t:"n"},I>0&&(R.z=Z[R.ixfe>>8&63]),Cs(R,e,r.opts.Date1904),L({c:J.c,r:J.r},R,e);break;case 5:case 517:R={ixfe:J.ixfe,XF:re[J.ixfe],v:J.val,t:J.t},I>0&&(R.z=Z[R.ixfe>>8&63]),Cs(R,e,r.opts.Date1904),L({c:J.c,r:J.r},R,e);break;case 638:R={ixfe:J.ixfe,XF:re[J.ixfe],v:J.rknum,t:"n"},I>0&&(R.z=Z[R.ixfe>>8&63]),Cs(R,e,r.opts.Date1904),L({c:J.c,r:J.r},R,e);break;case 189:for(var Ue=J.c;Ue<=J.C;++Ue){var De=J.rkrec[Ue-J.c][0];R={ixfe:De,XF:re[De],v:J.rkrec[Ue-J.c][1],t:"n"},I>0&&(R.z=Z[R.ixfe>>8&63]),Cs(R,e,r.opts.Date1904),L({c:Ue,r:J.r},R,e)}break;case 6:case 518:case 1030:{if(J.val=="String"){u=J;break}if(R=t0(J.val,J.cell.ixfe,J.tt),R.XF=re[R.ixfe],e.cellFormula){var ut=J.formula;if(ut&&ut[0]&&ut[0][0]&&ut[0][0][0]=="PtgExp"){var Lt=ut[0][0][1][0],Qt=ut[0][0][1][1],yr=dt({r:Lt,c:Qt});M[yr]?R.f=""+Mn(J.formula,o,J.cell,ne,P):R.F=((e.dense?(a[Lt]||[])[Qt]:a[yr])||{}).F}else R.f=""+Mn(J.formula,o,J.cell,ne,P)}I>0&&(R.z=Z[R.ixfe>>8&63]),Cs(R,e,r.opts.Date1904),L(J.cell,R,e),u=J}break;case 7:case 519:if(u)u.val=J,R=t0(J,u.cell.ixfe,"s"),R.XF=re[R.ixfe],e.cellFormula&&(R.f=""+Mn(u.formula,o,u.cell,ne,P)),I>0&&(R.z=Z[R.ixfe>>8&63]),Cs(R,e,r.opts.Date1904),L(u.cell,R,e),u=null;else throw new Error("String record expects Formula");break;case 33:case 545:{F.push(J);var Hn=dt(J[0].s);if(w=e.dense?(a[J[0].s.r]||[])[J[0].s.c]:a[Hn],e.cellFormula&&w){if(!u||!Hn||!w)break;w.f=""+Mn(J[1],o,J[0],ne,P),w.F=Ht(J[0])}}break;case 1212:{if(!e.cellFormula)break;if(_){if(!u)break;M[dt(u.cell)]=J[0],w=e.dense?(a[u.cell.r]||[])[u.cell.c]:a[dt(u.cell)],(w||{}).f=""+Mn(J[0],o,v,ne,P)}}break;case 253:R=t0(h[J.isst].t,J.ixfe,"s"),h[J.isst].h&&(R.h=h[J.isst].h),R.XF=re[R.ixfe],I>0&&(R.z=Z[R.ixfe>>8&63]),Cs(R,e,r.opts.Date1904),L({c:J.c,r:J.r},R,e);break;case 513:e.sheetStubs&&(R={ixfe:J.ixfe,XF:re[J.ixfe],t:"z"},I>0&&(R.z=Z[R.ixfe>>8&63]),Cs(R,e,r.opts.Date1904),L({c:J.c,r:J.r},R,e));break;case 190:if(e.sheetStubs)for(var Jt=J.c;Jt<=J.C;++Jt){var pt=J.ixfe[Jt-J.c];R={ixfe:pt,XF:re[pt],t:"z"},I>0&&(R.z=Z[R.ixfe>>8&63]),Cs(R,e,r.opts.Date1904),L({c:Jt,r:J.r},R,e)}break;case 214:case 516:case 4:R=t0(J.val,J.ixfe,"s"),R.XF=re[R.ixfe],I>0&&(R.z=Z[R.ixfe>>8&63]),Cs(R,e,r.opts.Date1904),L({c:J.c,r:J.r},R,e);break;case 0:case 512:Q===1&&(o=J);break;case 252:h=J;break;case 1054:if(P.biff==4){Z[I++]=J[1];for(var hr=0;hr<I+163&&yt[hr]!=J[1];++hr);hr>=163&&ho(J[1],I+163)}else ho(J[1],J[0]);break;case 30:{Z[I++]=J;for(var kt=0;kt<I+163&&yt[kt]!=J;++kt);kt>=163&&ho(J,I+163)}break;case 229:Ce=Ce.concat(J);break;case 93:Ne[J.cmo[0]]=P.lastobj=J;break;case 438:P.lastobj.TxO=J;break;case 127:P.lastobj.ImData=J;break;case 440:for(A=J[0].s.r;A<=J[0].e.r;++A)for(T=J[0].s.c;T<=J[0].e.c;++T)w=e.dense?(a[A]||[])[T]:a[dt({c:T,r:A})],w&&(w.l=J[1]);break;case 2048:for(A=J[0].s.r;A<=J[0].e.r;++A)for(T=J[0].s.c;T<=J[0].e.c;++T)w=e.dense?(a[A]||[])[T]:a[dt({c:T,r:A})],w&&w.l&&(w.l.Tooltip=J[1]);break;case 28:{if(P.biff<=5&&P.biff>=2)break;w=e.dense?(a[J[0].r]||[])[J[0].c]:a[dt(J[0])];var $t=Ne[J[2]];w||(e.dense?(a[J[0].r]||(a[J[0].r]=[]),w=a[J[0].r][J[0].c]={t:"z"}):w=a[dt(J[0])]={t:"z"},o.e.r=Math.max(o.e.r,J[0].r),o.s.r=Math.min(o.s.r,J[0].r),o.e.c=Math.max(o.e.c,J[0].c),o.s.c=Math.min(o.s.c,J[0].c)),w.c||(w.c=[]),E={a:J[1],t:$t.TxO.t},w.c.push(E)}break;case 2173:y7(re[J.ixfe],J.ext);break;case 125:{if(!P.cellStyles)break;for(;J.e>=J.s;)ae[J.e--]={width:J.w/256,level:J.level||0,hidden:!!(J.flags&1)},pe||(pe=!0,R1(J.w/256)),qc(ae[J.e+1])}break;case 520:{var Ut={};J.level!=null&&(ue[J.r]=Ut,Ut.level=J.level),J.hidden&&(ue[J.r]=Ut,Ut.hidden=!0),J.hpt&&(ue[J.r]=Ut,Ut.hpt=J.hpt,Ut.hpx=Gf(J.hpt))}break;case 38:case 39:case 40:case 41:a["!margins"]||bf(a["!margins"]={}),a["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[Pe]]=J;break;case 161:a["!margins"]||bf(a["!margins"]={}),a["!margins"].header=J.header,a["!margins"].footer=J.footer;break;case 574:J.RTL&&(b.Views[0].RTL=!0);break;case 146:te=J;break;case 2198:U=J;break;case 140:z=J;break;case 442:m?N.CodeName=J||N.name:b.WBProps.CodeName=J||"ThisWorkbook";break}}else we||console.error("Missing Info for XLS Record 0x"+Pe.toString(16)),t.l+=he}return r.SheetNames=Ls(l).sort(function(dr,lt){return Number(dr)-Number(lt)}).map(function(dr){return l[dr].name}),e.bookSheets||(r.Sheets=n),!r.SheetNames.length&&p["!ref"]?(r.SheetNames.push("Sheet1"),r.Sheets&&(r.Sheets.Sheet1=p)):r.Preamble=p,r.Sheets&&ee.forEach(function(dr,lt){r.Sheets[r.SheetNames[lt]]["!autofilter"]=dr}),r.Strings=h,r.SSF=En(yt),P.enc&&(r.Encryption=P.enc),U&&(r.Themes=U),r.Metadata={},z!==void 0&&(r.Metadata.Country=z),ne.names.length>0&&(b.Names=ne.names),r.Workbook=b,r}var rb={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function Jz(t,e,r){var n=zt.find(t,"/!DocumentSummaryInformation");if(n&&n.size>0)try{var a=UE(n,p5,rb.DSI);for(var l in a)e[l]=a[l]}catch(m){if(r.WTF)throw m}var o=zt.find(t,"/!SummaryInformation");if(o&&o.size>0)try{var u=UE(o,g5,rb.SI);for(var h in u)e[h]==null&&(e[h]=u[h])}catch(m){if(r.WTF)throw m}e.HeadingPairs&&e.TitlesOfParts&&(oC(e.HeadingPairs,e.TitlesOfParts,e,r),delete e.HeadingPairs,delete e.TitlesOfParts)}function qC(t,e){e||(e={}),j1(e),_N(),e.codepage&&d1(e.codepage);var r,n;if(t.FullPaths){if(zt.find(t,"/encryption"))throw new Error("File is password-protected");r=zt.find(t,"!CompObj"),n=zt.find(t,"/Workbook")||zt.find(t,"/Book")}else{switch(e.type){case"base64":t=hs(Oa(t));break;case"binary":t=hs(t);break;case"buffer":break;case"array":Array.isArray(t)||(t=Array.prototype.slice.call(t));break}_n(t,0),n={content:t}}var a,l;if(r&&Yz(r),e.bookProps&&!e.bookSheets)a={};else{var o=Ft?"buffer":"array";if(n&&n.content)a=Qz(n.content,e);else if((l=zt.find(t,"PerfectOffice_MAIN"))&&l.content)a=Tf.to_workbook(l.content,(e.type=o,e));else if((l=zt.find(t,"NativeContent_MAIN"))&&l.content)a=Tf.to_workbook(l.content,(e.type=o,e));else throw(l=zt.find(t,"MN0"))&&l.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");e.bookVBA&&t.FullPaths&&zt.find(t,"/_VBA_PROJECT_CUR/VBA/dir")&&(a.vbaraw=P7(t))}var u={};return t.FullPaths&&Jz(t,u,e),a.Props=a.Custprops=u,e.bookFiles&&(a.cfb=t),a}var q0={0:{f:OV},1:{f:PV},2:{f:WV},3:{f:VV},4:{f:UV},5:{f:qV},6:{f:$V},7:{f:HV},8:{f:ez},9:{f:ZV},10:{f:QV},11:{f:JV},12:{f:LV},13:{f:KV},14:{f:zV},15:{f:BV},16:{f:BC},17:{f:XV},18:{f:GV},19:{f:b1},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:Nz},40:{},42:{},43:{f:QU},44:{f:XU},45:{f:JU},46:{f:e7},47:{f:ZU},48:{},49:{f:t5},50:{},51:{f:w7},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:_C},62:{f:YV},63:{f:A7},64:{f:cz},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:Vn,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:oz},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:FV},148:{f:MV,p:16},151:{f:nz},152:{},153:{f:Sz},154:{},155:{},156:{f:bz},157:{},158:{},159:{T:1,f:gU},160:{T:-1},161:{T:1,f:Io},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:tz},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:_7},336:{T:-1},337:{f:T7,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:Bx},357:{},358:{},359:{},360:{T:1},361:{},362:{f:yC},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:az},427:{f:sz},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:lz},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:jV},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:rz},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:Bx},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:M7},633:{T:1},634:{T:-1},635:{T:1,f:O7},636:{T:-1},637:{f:n5},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:pz},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:uz},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},qx={6:{f:Zg},10:{f:ll},12:{f:$r},13:{f:$r},14:{f:Pr},15:{f:Pr},16:{f:Fn},17:{f:Pr},18:{f:Pr},19:{f:$r},20:{f:HE},21:{f:HE},23:{f:yC},24:{f:qE},25:{f:Pr},26:{},27:{},28:{f:D9},29:{},34:{f:Pr},35:{f:GE},38:{f:Fn},39:{f:Fn},40:{f:Fn},41:{f:Fn},42:{f:Pr},43:{f:Pr},47:{f:jU},49:{f:h9},51:{f:$r},60:{},61:{f:c9},64:{f:Pr},65:{f:f9},66:{f:$r},77:{},80:{},81:{},82:{},85:{f:$r},89:{},90:{},91:{},92:{f:t9},93:{f:O9},94:{},95:{f:Pr},96:{},97:{},99:{f:Pr},125:{f:_C},128:{f:T9},129:{f:r9},130:{f:$r},131:{f:Pr},132:{f:Pr},133:{f:n9},134:{},140:{f:U9},141:{f:$r},144:{},146:{f:V9},151:{},152:{},153:{},154:{},155:{},156:{f:$r},157:{},158:{},160:{f:W9},161:{f:H9},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:v9},190:{f:y9},193:{f:ll},197:{},198:{},199:{},200:{},201:{},202:{f:Pr},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:$r},220:{},221:{f:Pr},222:{},224:{f:w9},225:{f:e9},226:{f:ll},227:{},229:{f:I9},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:a9},253:{f:d9},255:{f:s9},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:dC},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:Pr},353:{f:ll},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:b9},431:{f:Pr},432:{},433:{},434:{},437:{},438:{f:F9},439:{f:Pr},440:{f:P9},441:{},442:{f:dh},443:{},444:{f:$r},445:{},446:{},448:{f:ll},449:{f:o9,r:2},450:{f:ll},512:{f:VE},513:{f:q9},515:{f:E9},516:{f:m9},517:{f:zE},519:{f:K9},520:{f:i9},523:{},545:{f:WE},549:{f:BE},566:{},574:{f:u9},638:{f:x9},659:{},1048:{},1054:{f:p9},1084:{},1212:{f:C9},2048:{f:L9},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:Jd},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:ll},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:z9,r:12},2173:{f:v7,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:Pr,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:N9,r:12},2197:{},2198:{f:h7,r:12},2199:{},2200:{},2201:{},2202:{f:k9,r:12},2203:{f:ll},2204:{},2205:{},2206:{},2207:{},2211:{f:l9},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:$r},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:G9},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:B9},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:VE},1:{},2:{f:Q9},3:{f:X9},4:{f:$9},5:{f:zE},7:{f:J9},8:{},9:{f:Jd},11:{},22:{f:$r},30:{f:g9},31:{},32:{},33:{f:WE},36:{},37:{f:BE},50:{f:Z9},62:{},52:{},67:{},68:{f:$r},69:{},86:{},126:{},127:{f:Y9},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:eU},223:{},234:{},354:{},421:{},518:{f:Zg},521:{f:Jd},536:{f:qE},547:{f:GE},561:{},579:{},1030:{f:Zg},1033:{f:Jd},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function cs(t,e,r,n){var a=e;if(!isNaN(a)){var l=(r||[]).length||0,o=t.next(4);o.write_shift(2,a),o.write_shift(2,l),l>0&&eC(r)&&t.push(r)}}function nb(t,e){var r=e||{},n=r.dense?[]:{};t=t.replace(/<!--.*?-->/g,"");var a=t.match(/<table/i);if(!a)throw new Error("Invalid HTML: could not find <table>");var l=t.match(/<\/table/i),o=a.index,u=l&&l.index||t.length,h=EL(t.slice(o,u),/(:?<tr[^>]*>)/i,"<tr>"),m=-1,p=0,v=0,_=0,w={s:{r:1e7,c:1e7},e:{r:0,c:0}},E=[];for(o=0;o<h.length;++o){var T=h[o].trim(),A=T.slice(0,3).toLowerCase();if(A=="<tr"){if(++m,r.sheetRows&&r.sheetRows<=m){--m;break}p=0;continue}if(!(A!="<td"&&A!="<th")){var M=T.split(/<\/t[dh]>/i);for(u=0;u<M.length;++u){var F=M[u].trim();if(F.match(/<t[dh]/i)){for(var R=F,z=0;R.charAt(0)=="<"&&(z=R.indexOf(">"))>-1;)R=R.slice(z+1);for(var re=0;re<E.length;++re){var te=E[re];te.s.c==p&&te.s.r<m&&m<=te.e.r&&(p=te.e.c+1,re=-1)}var b=it(F.slice(0,F.indexOf(">")));_=b.colspan?+b.colspan:1,((v=+b.rowspan)>1||_>1)&&E.push({s:{r:m,c:p},e:{r:m+(v||1)-1,c:p+_-1}});var N=b.t||b["data-t"]||"";if(!R.length){p+=_;continue}if(R=VN(R),w.s.r>m&&(w.s.r=m),w.e.r<m&&(w.e.r=m),w.s.c>p&&(w.s.c=p),w.e.c<p&&(w.e.c=p),!R.length){p+=_;continue}var k={t:"s",v:R};r.raw||!R.trim().length||N=="s"||(R==="TRUE"?k={t:"b",v:!0}:R==="FALSE"?k={t:"b",v:!1}:isNaN(xs(R))?isNaN(Gc(R).getDate())||(k={t:"d",v:hn(R)},r.cellDates||(k={t:"n",v:ra(k.v)}),k.z=r.dateNF||yt[14]):k={t:"n",v:xs(R)}),r.dense?(n[m]||(n[m]=[]),n[m][p]=k):n[dt({r:m,c:p})]=k,p+=_}}}}return n["!ref"]=Ht(w),E.length&&(n["!merges"]=E),n}function Zz(t,e,r,n){for(var a=t["!merges"]||[],l=[],o=e.s.c;o<=e.e.c;++o){for(var u=0,h=0,m=0;m<a.length;++m)if(!(a[m].s.r>r||a[m].s.c>o)&&!(a[m].e.r<r||a[m].e.c<o)){if(a[m].s.r<r||a[m].s.c<o){u=-1;break}u=a[m].e.r-a[m].s.r+1,h=a[m].e.c-a[m].s.c+1;break}if(!(u<0)){var p=dt({r,c:o}),v=n.dense?(t[r]||[])[o]:t[p],_=v&&v.v!=null&&(v.h||y1(v.w||(bi(v),v.w)||""))||"",w={};u>1&&(w.rowspan=u),h>1&&(w.colspan=h),n.editable?_='<span contenteditable="true">'+_+"</span>":v&&(w["data-t"]=v&&v.t||"z",v.v!=null&&(w["data-v"]=v.v),v.z!=null&&(w["data-z"]=v.z),v.l&&(v.l.Target||"#").charAt(0)!="#"&&(_='<a href="'+v.l.Target+'">'+_+"</a>")),w.id=(n.id||"sjs")+"-"+p,l.push(UL("td",_,w))}}var E="<tr>";return E+l.join("")+"</tr>"}var eH='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',tH="</body></html>";function rH(t,e){var r=t.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!r||r.length==0)throw new Error("Invalid HTML: could not find <table>");if(r.length==1)return Rl(nb(r[0],e),e);var n=P1();return r.forEach(function(a,l){L1(n,nb(a,e),"Sheet"+(l+1))}),n}function nH(t,e,r){var n=[];return n.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function aH(t,e){var r=e||{},n=r.header!=null?r.header:eH,a=r.footer!=null?r.footer:tH,l=[n],o=Zc(t["!ref"]);r.dense=Array.isArray(t),l.push(nH(t,o,r));for(var u=o.s.r;u<=o.e.r;++u)l.push(Zz(t,o,u,r));return l.push("</table>"+a),l.join("")}function WC(t,e,r){var n=r||{},a=0,l=0;if(n.origin!=null)if(typeof n.origin=="number")a=n.origin;else{var o=typeof n.origin=="string"?Jn(n.origin):n.origin;a=o.r,l=o.c}var u=e.getElementsByTagName("tr"),h=Math.min(n.sheetRows||1e7,u.length),m={s:{r:0,c:0},e:{r:a,c:l}};if(t["!ref"]){var p=Zc(t["!ref"]);m.s.r=Math.min(m.s.r,p.s.r),m.s.c=Math.min(m.s.c,p.s.c),m.e.r=Math.max(m.e.r,p.e.r),m.e.c=Math.max(m.e.c,p.e.c),a==-1&&(m.e.r=a=p.e.r+1)}var v=[],_=0,w=t["!rows"]||(t["!rows"]=[]),E=0,T=0,A=0,M=0,F=0,R=0;for(t["!cols"]||(t["!cols"]=[]);E<u.length&&T<h;++E){var z=u[E];if(ab(z)){if(n.display)continue;w[T]={hidden:!0}}var re=z.children;for(A=M=0;A<re.length;++A){var te=re[A];if(!(n.display&&ab(te))){var b=te.hasAttribute("data-v")?te.getAttribute("data-v"):te.hasAttribute("v")?te.getAttribute("v"):VN(te.innerHTML),N=te.getAttribute("data-z")||te.getAttribute("z");for(_=0;_<v.length;++_){var k=v[_];k.s.c==M+l&&k.s.r<T+a&&T+a<=k.e.r&&(M=k.e.c+1-l,_=-1)}R=+te.getAttribute("colspan")||1,((F=+te.getAttribute("rowspan")||1)>1||R>1)&&v.push({s:{r:T+a,c:M+l},e:{r:T+a+(F||1)-1,c:M+l+(R||1)-1}});var j={t:"s",v:b},L=te.getAttribute("data-t")||te.getAttribute("t")||"";b!=null&&(b.length==0?j.t=L||"z":n.raw||b.trim().length==0||L=="s"||(b==="TRUE"?j={t:"b",v:!0}:b==="FALSE"?j={t:"b",v:!1}:isNaN(xs(b))?isNaN(Gc(b).getDate())||(j={t:"d",v:hn(b)},n.cellDates||(j={t:"n",v:ra(j.v)}),j.z=n.dateNF||yt[14]):j={t:"n",v:xs(b)})),j.z===void 0&&N!=null&&(j.z=N);var P="",U=te.getElementsByTagName("A");if(U&&U.length)for(var Ce=0;Ce<U.length&&!(U[Ce].hasAttribute("href")&&(P=U[Ce].getAttribute("href"),P.charAt(0)!="#"));++Ce);P&&P.charAt(0)!="#"&&(j.l={Target:P}),n.dense?(t[T+a]||(t[T+a]=[]),t[T+a][M+l]=j):t[dt({c:M+l,r:T+a})]=j,m.e.c<M+l&&(m.e.c=M+l),M+=R}}++T}return v.length&&(t["!merges"]=(t["!merges"]||[]).concat(v)),m.e.r=Math.max(m.e.r,T-1+a),t["!ref"]=Ht(m),T>=h&&(t["!fullref"]=Ht((m.e.r=u.length-E+T-1+a,m))),t}function KC(t,e){var r=e||{},n=r.dense?[]:{};return WC(n,t,e)}function sH(t,e){return Rl(KC(t,e),e)}function ab(t){var e="",r=iH(t);return r&&(e=r(t).getPropertyValue("display")),e||(e=t.style&&t.style.display),e==="none"}function iH(t){return t.ownerDocument.defaultView&&typeof t.ownerDocument.defaultView.getComputedStyle=="function"?t.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function lH(t){var e=t.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(n,a){return Array(parseInt(a,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),r=Gt(e.replace(/<[^>]*>/g,""));return[r]}var sb={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function YC(t,e){var r=e||{},n=_1(t),a=[],l,o,u={name:""},h="",m=0,p,v,_={},w=[],E=r.dense?[]:{},T,A,M={value:""},F="",R=0,z=[],re=-1,te=-1,b={s:{r:1e6,c:1e7},e:{r:0,c:0}},N=0,k={},j=[],L={},P=0,U=0,Ce=[],Ne=1,ae=1,ue=[],pe={Names:[]},ne={},be=["",""],Q=[],I={},Z="",ee=0,B=!1,se=!1,_e=0;for(Vf.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");T=Vf.exec(n);)switch(T[3]=T[3].replace(/_.*$/,"")){case"table":case"":T[1]==="/"?(b.e.c>=b.s.c&&b.e.r>=b.s.r?E["!ref"]=Ht(b):E["!ref"]="A1:A1",r.sheetRows>0&&r.sheetRows<=b.e.r&&(E["!fullref"]=E["!ref"],b.e.r=r.sheetRows-1,E["!ref"]=Ht(b)),j.length&&(E["!merges"]=j),Ce.length&&(E["!rows"]=Ce),p.name=p.||p.name,typeof JSON<"u"&&JSON.stringify(p),w.push(p.name),_[p.name]=E,se=!1):T[0].charAt(T[0].length-2)!=="/"&&(p=it(T[0],!1),re=te=-1,b.s.r=b.s.c=1e7,b.e.r=b.e.c=0,E=r.dense?[]:{},j=[],Ce=[],se=!0);break;case"table-row-group":T[1]==="/"?--N:++N;break;case"table-row":case"":if(T[1]==="/"){re+=Ne,Ne=1;break}if(v=it(T[0],!1),v.?re=v.-1:re==-1&&(re=0),Ne=+v["number-rows-repeated"]||1,Ne<10)for(_e=0;_e<Ne;++_e)N>0&&(Ce[re+_e]={level:N});te=-1;break;case"covered-table-cell":T[1]!=="/"&&++te,r.sheetStubs&&(r.dense?(E[re]||(E[re]=[]),E[re][te]={t:"z"}):E[dt({r:re,c:te})]={t:"z"}),F="",z=[];break;case"table-cell":case"":if(T[0].charAt(T[0].length-2)==="/")++te,M=it(T[0],!1),ae=parseInt(M["number-columns-repeated"]||"1",10),A={t:"z",v:null},M.formula&&r.cellFormula!=!1&&(A.f=ZE(Gt(M.formula))),(M.||M["value-type"])=="string"&&(A.t="s",A.v=Gt(M["string-value"]||""),r.dense?(E[re]||(E[re]=[]),E[re][te]=A):E[dt({r:re,c:te})]=A),te+=ae-1;else if(T[1]!=="/"){++te,F="",R=0,z=[],ae=1;var Pe=Ne?re+Ne-1:re;if(te>b.e.c&&(b.e.c=te),te<b.s.c&&(b.s.c=te),re<b.s.r&&(b.s.r=re),Pe>b.e.r&&(b.e.r=Pe),M=it(T[0],!1),Q=[],I={},A={t:M.||M["value-type"],v:null},r.cellFormula)if(M.formula&&(M.formula=Gt(M.formula)),M["number-matrix-columns-spanned"]&&M["number-matrix-rows-spanned"]&&(P=parseInt(M["number-matrix-rows-spanned"],10)||0,U=parseInt(M["number-matrix-columns-spanned"],10)||0,L={s:{r:re,c:te},e:{r:re+P-1,c:te+U-1}},A.F=Ht(L),ue.push([L,A.F])),M.formula)A.f=ZE(M.formula);else for(_e=0;_e<ue.length;++_e)re>=ue[_e][0].s.r&&re<=ue[_e][0].e.r&&te>=ue[_e][0].s.c&&te<=ue[_e][0].e.c&&(A.F=ue[_e][1]);switch((M["number-columns-spanned"]||M["number-rows-spanned"])&&(P=parseInt(M["number-rows-spanned"],10)||0,U=parseInt(M["number-columns-spanned"],10)||0,L={s:{r:re,c:te},e:{r:re+P-1,c:te+U-1}},j.push(L)),M["number-columns-repeated"]&&(ae=parseInt(M["number-columns-repeated"],10)),A.t){case"boolean":A.t="b",A.v=Tr(M["boolean-value"]);break;case"float":A.t="n",A.v=parseFloat(M.value);break;case"percentage":A.t="n",A.v=parseFloat(M.value);break;case"currency":A.t="n",A.v=parseFloat(M.value);break;case"date":A.t="d",A.v=hn(M["date-value"]),r.cellDates||(A.t="n",A.v=ra(A.v)),A.z="m/d/yy";break;case"time":A.t="n",A.v=_L(M["time-value"])/86400,r.cellDates&&(A.t="d",A.v=Em(A.v)),A.z="HH:MM:SS";break;case"number":A.t="n",A.v=parseFloat(M.);break;default:if(A.t==="string"||A.t==="text"||!A.t)A.t="s",M["string-value"]!=null&&(F=Gt(M["string-value"]),z=[]);else throw new Error("Unsupported value type "+A.t)}}else{if(B=!1,A.t==="s"&&(A.v=F||"",z.length&&(A.R=z),B=R==0),ne.Target&&(A.l=ne),Q.length>0&&(A.c=Q,Q=[]),F&&r.cellText!==!1&&(A.w=F),B&&(A.t="z",delete A.v),(!B||r.sheetStubs)&&!(r.sheetRows&&r.sheetRows<=re))for(var he=0;he<Ne;++he){if(ae=parseInt(M["number-columns-repeated"]||"1",10),r.dense)for(E[re+he]||(E[re+he]=[]),E[re+he][te]=he==0?A:En(A);--ae>0;)E[re+he][te+ae]=En(A);else for(E[dt({r:re+he,c:te})]=A;--ae>0;)E[dt({r:re+he,c:te+ae})]=En(A);b.e.c<=te&&(b.e.c=te)}ae=parseInt(M["number-columns-repeated"]||"1",10),te+=ae-1,ae=0,A={},F="",z=[]}ne={};break;case"document":case"document-content":case"":case"spreadsheet":case"":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(T[1]==="/"){if((l=a.pop())[0]!==T[3])throw"Bad state: "+l}else T[0].charAt(T[0].length-2)!=="/"&&a.push([T[3],!0]);break;case"annotation":if(T[1]==="/"){if((l=a.pop())[0]!==T[3])throw"Bad state: "+l;I.t=F,z.length&&(I.R=z),I.a=Z,Q.push(I)}else T[0].charAt(T[0].length-2)!=="/"&&a.push([T[3],!1]);Z="",ee=0,F="",R=0,z=[];break;case"creator":T[1]==="/"?Z=n.slice(ee,T.index):ee=T.index+T[0].length;break;case"meta":case"":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(T[1]==="/"){if((l=a.pop())[0]!==T[3])throw"Bad state: "+l}else T[0].charAt(T[0].length-2)!=="/"&&a.push([T[3],!1]);F="",R=0,z=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(T[1]==="/"){if(k[u.name]=h,(l=a.pop())[0]!==T[3])throw"Bad state: "+l}else T[0].charAt(T[0].length-2)!=="/"&&(h="",u=it(T[0],!1),a.push([T[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(a[a.length-1][0]){case"time-style":case"date-style":o=it(T[0],!1),h+=sb[T[3]][o.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(a[a.length-1][0]){case"time-style":case"date-style":o=it(T[0],!1),h+=sb[T[3]][o.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(T[0].slice(-2)==="/>")break;if(T[1]==="/")switch(a[a.length-1][0]){case"number-style":case"date-style":case"time-style":h+=n.slice(m,T.index);break}else m=T.index+T[0].length;break;case"named-range":o=it(T[0],!1),be=ex(o["cell-range-address"]);var we={Name:o.name,Ref:be[0]+"!"+be[1]};se&&(we.Sheet=w.length),pe.Names.push(we);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"":if(["master-styles"].indexOf(a[a.length-1][0])>-1)break;if(T[1]==="/"&&(!M||!M["string-value"])){var He=lH(n.slice(R,T.index));F=(F.length>0?F+`
`:"")+He[0]}else it(T[0],!1),R=T.index+T[0].length;break;case"s":break;case"database-range":if(T[1]==="/")break;try{be=ex(it(T[0])["target-range-address"]),_[be[0]]["!autofilter"]={ref:be[1]}}catch{}break;case"date":break;case"object":break;case"title":case"":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(T[1]!=="/"){if(ne=it(T[0],!1),!ne.href)break;ne.Target=Gt(ne.href),delete ne.href,ne.Target.charAt(0)=="#"&&ne.Target.indexOf(".")>-1?(be=ex(ne.Target.slice(1)),ne.Target="#"+be[0]+"!"+be[1]):ne.Target.match(/^\.\.[\\\/]/)&&(ne.Target=ne.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(T[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case":":case":":break;default:if(r.WTF)throw new Error(T)}}var J={Sheets:_,SheetNames:w,Workbook:pe};return r.bookSheets&&delete J.Sheets,J}function ib(t,e){e=e||{},Xa(t,"META-INF/manifest.xml")&&E5(Yr(t,"META-INF/manifest.xml"),e);var r=Ca(t,"content.xml");if(!r)throw new Error("Missing content.xml in ODS / UOF file");var n=YC(fr(r),e);return Xa(t,"meta.xml")&&(n.Props=lC(Yr(t,"meta.xml"))),n}function lb(t,e){return YC(t,e)}function O1(t){return new DataView(t.buffer,t.byteOffset,t.byteLength)}function Wx(t){return typeof TextDecoder<"u"?new TextDecoder().decode(t):fr(Ro(t))}function Kx(t){var e=t.reduce(function(a,l){return a+l.length},0),r=new Uint8Array(e),n=0;return t.forEach(function(a){r.set(a,n),n+=a.length}),r}function ob(t){return t-=t>>1&1431655765,t=(t&858993459)+(t>>2&858993459),(t+(t>>4)&252645135)*16843009>>>24}function oH(t,e){for(var r=(t[e+15]&127)<<7|t[e+14]>>1,n=t[e+14]&1,a=e+13;a>=e;--a)n=n*256+t[a];return(t[e+15]&128?-n:n)*Math.pow(10,r-6176)}function qf(t,e){var r=e?e[0]:0,n=t[r]&127;e:if(t[r++]>=128&&(n|=(t[r]&127)<<7,t[r++]<128||(n|=(t[r]&127)<<14,t[r++]<128)||(n|=(t[r]&127)<<21,t[r++]<128)||(n+=(t[r]&127)*Math.pow(2,28),++r,t[r++]<128)||(n+=(t[r]&127)*Math.pow(2,35),++r,t[r++]<128)||(n+=(t[r]&127)*Math.pow(2,42),++r,t[r++]<128)))break e;return e&&(e[0]=r),n}function rn(t){var e=0,r=t[e]&127;e:if(t[e++]>=128){if(r|=(t[e]&127)<<7,t[e++]<128||(r|=(t[e]&127)<<14,t[e++]<128)||(r|=(t[e]&127)<<21,t[e++]<128))break e;r|=(t[e]&127)<<28}return r}function Pn(t){for(var e=[],r=[0];r[0]<t.length;){var n=r[0],a=qf(t,r),l=a&7;a=Math.floor(a/8);var o=0,u;if(a==0)break;switch(l){case 0:{for(var h=r[0];t[r[0]++]>=128;);u=t.slice(h,r[0])}break;case 5:o=4,u=t.slice(r[0],r[0]+o),r[0]+=o;break;case 1:o=8,u=t.slice(r[0],r[0]+o),r[0]+=o;break;case 2:o=qf(t,r),u=t.slice(r[0],r[0]+o),r[0]+=o;break;case 3:case 4:default:throw new Error("PB Type ".concat(l," for Field ").concat(a," at offset ").concat(n))}var m={data:u,type:l};e[a]==null?e[a]=[m]:e[a].push(m)}return e}function M1(t,e){return t?.map(function(r){return e(r.data)})||[]}function cH(t){for(var e,r=[],n=[0];n[0]<t.length;){var a=qf(t,n),l=Pn(t.slice(n[0],n[0]+a));n[0]+=a;var o={id:rn(l[1][0].data),messages:[]};l[2].forEach(function(u){var h=Pn(u.data),m=rn(h[3][0].data);o.messages.push({meta:h,data:t.slice(n[0],n[0]+m)}),n[0]+=m}),(e=l[3])!=null&&e[0]&&(o.merge=rn(l[3][0].data)>>>0>0),r.push(o)}return r}function uH(t,e){if(t!=0)throw new Error("Unexpected Snappy chunk type ".concat(t));for(var r=[0],n=qf(e,r),a=[];r[0]<e.length;){var l=e[r[0]]&3;if(l==0){var o=e[r[0]++]>>2;if(o<60)++o;else{var u=o-59;o=e[r[0]],u>1&&(o|=e[r[0]+1]<<8),u>2&&(o|=e[r[0]+2]<<16),u>3&&(o|=e[r[0]+3]<<24),o>>>=0,o++,r[0]+=u}a.push(e.slice(r[0],r[0]+o)),r[0]+=o;continue}else{var h=0,m=0;if(l==1?(m=(e[r[0]]>>2&7)+4,h=(e[r[0]++]&224)<<3,h|=e[r[0]++]):(m=(e[r[0]++]>>2)+1,l==2?(h=e[r[0]]|e[r[0]+1]<<8,r[0]+=2):(h=(e[r[0]]|e[r[0]+1]<<8|e[r[0]+2]<<16|e[r[0]+3]<<24)>>>0,r[0]+=4)),a=[Kx(a)],h==0)throw new Error("Invalid offset 0");if(h>a[0].length)throw new Error("Invalid offset beyond length");if(m>=h)for(a.push(a[0].slice(-h)),m-=h;m>=a[a.length-1].length;)a.push(a[a.length-1]),m-=a[a.length-1].length;a.push(a[0].slice(-h,-h+m))}}var p=Kx(a);if(p.length!=n)throw new Error("Unexpected length: ".concat(p.length," != ").concat(n));return p}function fH(t){for(var e=[],r=0;r<t.length;){var n=t[r++],a=t[r]|t[r+1]<<8|t[r+2]<<16;r+=3,e.push(uH(n,t.slice(r,r+a))),r+=a}if(r!==t.length)throw new Error("data is not a valid framed stream!");return Kx(e)}function hH(t,e,r,n){var a=O1(t),l=a.getUint32(4,!0),o=(n>1?12:8)+ob(l&(n>1?3470:398))*4,u=-1,h=-1,m=NaN,p=new Date(2001,0,1);l&512&&(u=a.getUint32(o,!0),o+=4),o+=ob(l&(n>1?12288:4096))*4,l&16&&(h=a.getUint32(o,!0),o+=4),l&32&&(m=a.getFloat64(o,!0),o+=8),l&64&&(p.setTime(p.getTime()+a.getFloat64(o,!0)*1e3),o+=8);var v;switch(t[2]){case 0:break;case 2:v={t:"n",v:m};break;case 3:v={t:"s",v:e[h]};break;case 5:v={t:"d",v:p};break;case 6:v={t:"b",v:m>0};break;case 7:v={t:"n",v:m/86400};break;case 8:v={t:"e",v:0};break;case 9:if(u>-1)v={t:"s",v:r[u]};else if(h>-1)v={t:"s",v:e[h]};else if(!isNaN(m))v={t:"n",v:m};else throw new Error("Unsupported cell type ".concat(t.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(t.slice(0,4)))}return v}function dH(t,e,r){var n=O1(t),a=n.getUint32(8,!0),l=12,o=-1,u=-1,h=NaN,m=NaN,p=new Date(2001,0,1);a&1&&(h=oH(t,l),l+=16),a&2&&(m=n.getFloat64(l,!0),l+=8),a&4&&(p.setTime(p.getTime()+n.getFloat64(l,!0)*1e3),l+=8),a&8&&(u=n.getUint32(l,!0),l+=4),a&16&&(o=n.getUint32(l,!0),l+=4);var v;switch(t[1]){case 0:break;case 2:v={t:"n",v:h};break;case 3:v={t:"s",v:e[u]};break;case 5:v={t:"d",v:p};break;case 6:v={t:"b",v:m>0};break;case 7:v={t:"n",v:m/86400};break;case 8:v={t:"e",v:0};break;case 9:if(o>-1)v={t:"s",v:r[o]};else throw new Error("Unsupported cell type ".concat(t[1]," : ").concat(a&31," : ").concat(t.slice(0,4)));break;case 10:v={t:"n",v:h};break;default:throw new Error("Unsupported cell type ".concat(t[1]," : ").concat(a&31," : ").concat(t.slice(0,4)))}return v}function mH(t,e,r){switch(t[0]){case 0:case 1:case 2:case 3:return hH(t,e,r,t[0]);case 5:return dH(t,e,r);default:throw new Error("Unsupported payload version ".concat(t[0]))}}function wl(t){var e=Pn(t);return qf(e[1][0].data)}function cb(t,e){var r=Pn(e.data),n=rn(r[1][0].data),a=r[3],l=[];return(a||[]).forEach(function(o){var u=Pn(o.data),h=rn(u[1][0].data)>>>0;switch(n){case 1:l[h]=Wx(u[3][0].data);break;case 8:{var m=t[wl(u[9][0].data)][0],p=Pn(m.data),v=t[wl(p[1][0].data)][0],_=rn(v.meta[1][0].data);if(_!=2001)throw new Error("2000 unexpected reference to ".concat(_));var w=Pn(v.data);l[h]=w[3].map(function(E){return Wx(E.data)}).join("")}break}}),l}function pH(t,e){var r,n,a,l,o,u,h,m,p,v,_,w,E,T,A=Pn(t),M=rn(A[1][0].data)>>>0,F=rn(A[2][0].data)>>>0,R=((n=(r=A[8])==null?void 0:r[0])==null?void 0:n.data)&&rn(A[8][0].data)>0||!1,z,re;if((l=(a=A[7])==null?void 0:a[0])!=null&&l.data&&e!=0)z=(u=(o=A[7])==null?void 0:o[0])==null?void 0:u.data,re=(m=(h=A[6])==null?void 0:h[0])==null?void 0:m.data;else if((v=(p=A[4])==null?void 0:p[0])!=null&&v.data&&e!=1)z=(w=(_=A[4])==null?void 0:_[0])==null?void 0:w.data,re=(T=(E=A[3])==null?void 0:E[0])==null?void 0:T.data;else throw"NUMBERS Tile missing ".concat(e," cell storage");for(var te=R?4:1,b=O1(z),N=[],k=0;k<z.length/2;++k){var j=b.getUint16(k*2,!0);j<65535&&N.push([k,j])}if(N.length!=F)throw"Expected ".concat(F," cells, found ").concat(N.length);var L=[];for(k=0;k<N.length-1;++k)L[N[k][0]]=re.subarray(N[k][1]*te,N[k+1][1]*te);return N.length>=1&&(L[N[N.length-1][0]]=re.subarray(N[N.length-1][1]*te)),{R:M,cells:L}}function gH(t,e){var r,n=Pn(e.data),a=(r=n?.[7])!=null&&r[0]?rn(n[7][0].data)>>>0>0?1:0:-1,l=M1(n[5],function(o){return pH(o,a)});return{nrows:rn(n[4][0].data)>>>0,data:l.reduce(function(o,u){return o[u.R]||(o[u.R]=[]),u.cells.forEach(function(h,m){if(o[u.R][m])throw new Error("Duplicate cell r=".concat(u.R," c=").concat(m));o[u.R][m]=h}),o},[])}}function xH(t,e,r){var n,a=Pn(e.data),l={s:{r:0,c:0},e:{r:0,c:0}};if(l.e.r=(rn(a[6][0].data)>>>0)-1,l.e.r<0)throw new Error("Invalid row varint ".concat(a[6][0].data));if(l.e.c=(rn(a[7][0].data)>>>0)-1,l.e.c<0)throw new Error("Invalid col varint ".concat(a[7][0].data));r["!ref"]=Ht(l);var o=Pn(a[4][0].data),u=cb(t,t[wl(o[4][0].data)][0]),h=(n=o[17])!=null&&n[0]?cb(t,t[wl(o[17][0].data)][0]):[],m=Pn(o[3][0].data),p=0;m[1].forEach(function(v){var _=Pn(v.data),w=t[wl(_[2][0].data)][0],E=rn(w.meta[1][0].data);if(E!=6002)throw new Error("6001 unexpected reference to ".concat(E));var T=gH(t,w);T.data.forEach(function(A,M){A.forEach(function(F,R){var z=dt({r:p+M,c:R}),re=mH(F,u,h);re&&(r[z]=re)})}),p+=T.nrows})}function vH(t,e){var r=Pn(e.data),n={"!ref":"A1"},a=t[wl(r[2][0].data)],l=rn(a[0].meta[1][0].data);if(l!=6001)throw new Error("6000 unexpected reference to ".concat(l));return xH(t,a[0],n),n}function yH(t,e){var r,n=Pn(e.data),a={name:(r=n[1])!=null&&r[0]?Wx(n[1][0].data):"",sheets:[]},l=M1(n[2],wl);return l.forEach(function(o){t[o].forEach(function(u){var h=rn(u.meta[1][0].data);h==6e3&&a.sheets.push(vH(t,u))})}),a}function _H(t,e){var r=P1(),n=Pn(e.data),a=M1(n[1],wl);if(a.forEach(function(l){t[l].forEach(function(o){var u=rn(o.meta[1][0].data);if(u==2){var h=yH(t,o);h.sheets.forEach(function(m,p){L1(r,m,p==0?h.name:h.name+"_"+p,!0)})}})}),r.SheetNames.length==0)throw new Error("Empty NUMBERS file");return r}function rx(t){var e,r,n,a,l={},o=[];if(t.FullPaths.forEach(function(h){if(h.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),t.FileIndex.forEach(function(h){if(h.name.match(/\.iwa$/)){var m;try{m=fH(h.content)}catch(v){return console.log("?? "+h.content.length+" "+(v.message||v))}var p;try{p=cH(m)}catch(v){return console.log("## "+(v.message||v))}p.forEach(function(v){l[v.id]=v.messages,o.push(v.id)})}}),!o.length)throw new Error("File has no messages");var u=((a=(n=(r=(e=l?.[1])==null?void 0:e[0])==null?void 0:r.meta)==null?void 0:n[1])==null?void 0:a[0].data)&&rn(l[1][0].meta[1][0].data)==1&&l[1][0];if(u||o.forEach(function(h){l[h].forEach(function(m){var p=rn(m.meta[1][0].data)>>>0;if(p==1)if(!u)u=m;else throw new Error("Document has multiple roots")})}),!u)throw new Error("Cannot find Document root");return _H(l,u)}function wH(t){return function(r){for(var n=0;n!=t.length;++n){var a=t[n];r[a[0]]===void 0&&(r[a[0]]=a[1]),a[2]==="n"&&(r[a[0]]=Number(r[a[0]]))}}}function j1(t){wH([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(t)}function TH(t){return bc.WS.indexOf(t)>-1?"sheet":t==bc.CS?"chart":t==bc.DS?"dialog":t==bc.MS?"macro":t&&t.length?t:"sheet"}function EH(t,e){if(!t)return 0;try{t=e.map(function(n){return n.id||(n.id=n.strRelID),[n.name,t["!id"][n.id].Target,TH(t["!id"][n.id].Type)]})}catch{return null}return!t||t.length===0?null:t}function bH(t,e,r,n,a,l,o,u,h,m,p,v){try{l[n]=_f(Ca(t,r,!0),e);var _=Yr(t,e),w;switch(u){case"sheet":w=Rz(_,e,a,h,l[n],m,p,v);break;case"chart":if(w=Dz(_,e,a,h,l[n],m,p,v),!w||!w["!drawel"])break;var E=lf(w["!drawel"].Target,e),T=Vx(E),A=k7(Ca(t,E,!0),_f(Ca(t,T,!0),E)),M=lf(A,E),F=Vx(M);w=dz(Ca(t,M,!0),M,h,_f(Ca(t,F,!0),M),m,w);break;case"macro":w=Iz(_,e,a,h,l[n],m,p,v);break;case"dialog":w=Oz(_,e,a,h,l[n],m,p,v);break;default:throw new Error("Unrecognized sheet type "+u)}o[n]=w;var R=[];l&&l[n]&&Ls(l[n]).forEach(function(z){var re="";if(l[n][z].Type==bc.CMNT){re=lf(l[n][z].Target,e);var te=Pz(Yr(t,re,!0),re,h);if(!te||!te.length)return;YE(w,te,!1)}l[n][z].Type==bc.TCMNT&&(re=lf(l[n][z].Target,e),R=R.concat(D7(Yr(t,re,!0),h)))}),R&&R.length&&YE(w,R,!0,h.people||[])}catch(z){if(h.WTF)throw z}}function Ya(t){return t.charAt(0)=="/"?t.slice(1):t}function SH(t,e){if(IN(),e=e||{},j1(e),Xa(t,"META-INF/manifest.xml")||Xa(t,"objectdata.xml"))return ib(t,e);if(Xa(t,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof rx<"u"){if(t.FileIndex)return rx(t);var r=zt.utils.cfb_new();return wE(t).forEach(function(Ce){AL(r,Ce,SL(t,Ce))}),rx(r)}throw new Error("Unsupported NUMBERS file")}if(!Xa(t,"[Content_Types].xml"))throw Xa(t,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):Xa(t,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var n=wE(t),a=w5(Ca(t,"[Content_Types].xml")),l=!1,o,u;if(a.workbooks.length===0&&(u="xl/workbook.xml",Yr(t,u,!0)&&a.workbooks.push(u)),a.workbooks.length===0){if(u="xl/workbook.bin",!Yr(t,u,!0))throw new Error("Could not find workbook");a.workbooks.push(u),l=!0}a.workbooks[0].slice(-3)=="bin"&&(l=!0);var h={},m={};if(!e.bookSheets&&!e.bookProps){if(Ef=[],a.sst)try{Ef=Fz(Yr(t,Ya(a.sst)),a.sst,e)}catch(Ce){if(e.WTF)throw Ce}e.cellStyles&&a.themes.length&&(h=jz(Ca(t,a.themes[0].replace(/^\//,""),!0)||"",a.themes[0],e)),a.style&&(m=Mz(Yr(t,Ya(a.style)),a.style,h,e))}a.links.map(function(Ce){try{var Ne=_f(Ca(t,Vx(Ya(Ce))),Ce);return Uz(Yr(t,Ya(Ce)),Ne,Ce,e)}catch{}});var p=kz(Yr(t,Ya(a.workbooks[0])),a.workbooks[0],e),v={},_="";a.coreprops.length&&(_=Yr(t,Ya(a.coreprops[0]),!0),_&&(v=lC(_)),a.extprops.length!==0&&(_=Yr(t,Ya(a.extprops[0]),!0),_&&A5(_,v,e)));var w={};(!e.bookSheets||e.bookProps)&&a.custprops.length!==0&&(_=Ca(t,Ya(a.custprops[0]),!0),_&&(w=C5(_,e)));var E={};if((e.bookSheets||e.bookProps)&&(p.Sheets?o=p.Sheets.map(function(Ne){return Ne.name}):v.Worksheets&&v.SheetNames.length>0&&(o=v.SheetNames),e.bookProps&&(E.Props=v,E.Custprops=w),e.bookSheets&&typeof o<"u"&&(E.SheetNames=o),e.bookSheets?E.SheetNames:e.bookProps))return E;o={};var T={};e.bookDeps&&a.calcchain&&(T=Lz(Yr(t,Ya(a.calcchain)),a.calcchain));var A=0,M={},F,R;{var z=p.Sheets;v.Worksheets=z.length,v.SheetNames=[];for(var re=0;re!=z.length;++re)v.SheetNames[re]=z[re].name}var te=l?"bin":"xml",b=a.workbooks[0].lastIndexOf("/"),N=(a.workbooks[0].slice(0,b+1)+"_rels/"+a.workbooks[0].slice(b+1)+".rels").replace(/^\//,"");Xa(t,N)||(N="xl/_rels/workbook."+te+".rels");var k=_f(Ca(t,N,!0),N.replace(/_rels.*/,"s5s"));(a.metadata||[]).length>=1&&(e.xlmeta=Bz(Yr(t,Ya(a.metadata[0])),a.metadata[0],e)),(a.people||[]).length>=1&&(e.people=I7(Yr(t,Ya(a.people[0])),e)),k&&(k=EH(k,p.Sheets));var j=Yr(t,"xl/worksheets/sheet.xml",!0)?1:0;e:for(A=0;A!=v.Worksheets;++A){var L="sheet";if(k&&k[A]?(F="xl/"+k[A][1].replace(/[\/]?xl\//,""),Xa(t,F)||(F=k[A][1]),Xa(t,F)||(F=N.replace(/_rels\/.*$/,"")+k[A][1]),L=k[A][2]):(F="xl/worksheets/sheet"+(A+1-j)+"."+te,F=F.replace(/sheet0\./,"sheet.")),R=F.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),e&&e.sheets!=null)switch(typeof e.sheets){case"number":if(A!=e.sheets)continue e;break;case"string":if(v.SheetNames[A].toLowerCase()!=e.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(e.sheets)){for(var P=!1,U=0;U!=e.sheets.length;++U)typeof e.sheets[U]=="number"&&e.sheets[U]==A&&(P=1),typeof e.sheets[U]=="string"&&e.sheets[U].toLowerCase()==v.SheetNames[A].toLowerCase()&&(P=1);if(!P)continue e}}bH(t,F,R,v.SheetNames[A],A,M,o,L,e,p,h,m)}return E={Directory:a,Workbook:p,Props:v,Custprops:w,Deps:T,Sheets:o,SheetNames:v.SheetNames,Strings:Ef,Styles:m,Themes:h,SSF:En(yt)},e&&e.bookFiles&&(t.files?(E.keys=n,E.files=t.files):(E.keys=[],E.files={},t.FullPaths.forEach(function(Ce,Ne){Ce=Ce.replace(/^Root Entry[\/]/,""),E.keys.push(Ce),E.files[Ce]=t.FileIndex[Ne]}))),e&&e.bookVBA&&(a.vba.length>0?E.vbaraw=Yr(t,Ya(a.vba[0]),!0):a.defaults&&a.defaults.bin===F7&&(E.vbaraw=Yr(t,"xl/vbaProject.bin",!0))),E}function AH(t,e){var r=e||{},n="Workbook",a=zt.find(t,n);try{if(n="/!DataSpaces/Version",a=zt.find(t,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(vU(a.content),n="/!DataSpaces/DataSpaceMap",a=zt.find(t,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);var l=_U(a.content);if(l.length!==1||l[0].comps.length!==1||l[0].comps[0].t!==0||l[0].name!=="StrongEncryptionDataSpace"||l[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",a=zt.find(t,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);var o=wU(a.content);if(o.length!=1||o[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",a=zt.find(t,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);EU(a.content)}catch{}if(n="/EncryptionInfo",a=zt.find(t,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);var u=bU(a.content);if(n="/EncryptedPackage",a=zt.find(t,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(u[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(u[1],a.content,r.password||"",r);if(u[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(u[1],a.content,r.password||"",r);throw new Error("File is password-protected")}function F1(t,e){var r="";switch((e||{}).type||"base64"){case"buffer":return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]];case"base64":r=Oa(t.slice(0,12));break;case"binary":r=t;break;case"array":return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]];default:throw new Error("Unrecognized type "+(e&&e.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function NH(t,e){return zt.find(t,"EncryptedPackage")?AH(t,e):qC(t,e)}function CH(t,e){var r,n=t,a=e||{};return a.type||(a.type=Ft&&Buffer.isBuffer(t)?"buffer":"base64"),r=LN(n,a),SH(r,a)}function $C(t,e){var r=0;e:for(;r<t.length;)switch(t.charCodeAt(r)){case 10:case 13:case 32:++r;break;case 60:return Gx(t.slice(r),e);default:break e}return zf.to_workbook(t,e)}function kH(t,e){var r="",n=F1(t,e);switch(e.type){case"base64":r=Oa(t);break;case"binary":r=t;break;case"buffer":r=t.toString("binary");break;case"array":r=Eo(t);break;default:throw new Error("Unrecognized type "+e.type)}return n[0]==239&&n[1]==187&&n[2]==191&&(r=fr(r)),e.type="binary",$C(r,e)}function RH(t,e){var r=t;return e.type=="base64"&&(r=Oa(r)),r=Lf.utils.decode(1200,r.slice(2),"str"),e.type="binary",$C(r,e)}function DH(t){return t.match(/[^\x00-\x7F]/)?of(t):t}function nx(t,e,r,n){return n?(r.type="string",zf.to_workbook(t,r)):zf.to_workbook(e,r)}function Yx(t,e){_N();var r=e||{};if(typeof ArrayBuffer<"u"&&t instanceof ArrayBuffer)return Yx(new Uint8Array(t),(r=En(r),r.type="array",r));typeof Uint8Array<"u"&&t instanceof Uint8Array&&!r.type&&(r.type=typeof Deno<"u"?"buffer":"array");var n=t,a=[0,0,0,0],l=!1;if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),Oc={},r.dateNF&&(Oc.dateNF=r.dateNF),r.type||(r.type=Ft&&Buffer.isBuffer(t)?"buffer":"base64"),r.type=="file"&&(r.type=Ft?"buffer":"binary",n=vL(t),typeof Uint8Array<"u"&&!Ft&&(r.type="array")),r.type=="string"&&(l=!0,r.type="binary",r.codepage=65001,n=DH(t)),r.type=="array"&&typeof Uint8Array<"u"&&t instanceof Uint8Array&&typeof ArrayBuffer<"u"){var o=new ArrayBuffer(3),u=new Uint8Array(o);if(u.foo="bar",!u.foo)return r=En(r),r.type="array",Yx(m1(n),r)}switch((a=F1(n,r))[0]){case 208:if(a[1]===207&&a[2]===17&&a[3]===224&&a[4]===161&&a[5]===177&&a[6]===26&&a[7]===225)return NH(zt.read(n,r),r);break;case 9:if(a[1]<=8)return qC(n,r);break;case 60:return Gx(n,r);case 73:if(a[1]===73&&a[2]===42&&a[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(a[1]===68)return sU(n,r);break;case 84:if(a[1]===65&&a[2]===66&&a[3]===76)return nU.to_workbook(n,r);break;case 80:return a[1]===75&&a[2]<9&&a[3]<9?CH(n,r):nx(t,n,r,l);case 239:return a[3]===60?Gx(n,r):nx(t,n,r,l);case 255:if(a[1]===254)return RH(n,r);if(a[1]===0&&a[2]===2&&a[3]===0)return Tf.to_workbook(n,r);break;case 0:if(a[1]===0&&(a[2]>=2&&a[3]===0||a[2]===0&&(a[3]===8||a[3]===9)))return Tf.to_workbook(n,r);break;case 3:case 131:case 139:case 140:return KE.to_workbook(n,r);case 123:if(a[1]===92&&a[2]===114&&a[3]===116)return FU.to_workbook(n,r);break;case 10:case 13:case 32:return kH(n,r);case 137:if(a[1]===80&&a[2]===78&&a[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return tU.indexOf(a[0])>-1&&a[2]<=12&&a[3]<=31?KE.to_workbook(n,r):nx(t,n,r,l)}function IH(t,e,r,n,a,l,o,u){var h=bn(r),m=u.defval,p=u.raw||!Object.prototype.hasOwnProperty.call(u,"raw"),v=!0,_=a===1?[]:{};if(a!==1)if(Object.defineProperty)try{Object.defineProperty(_,"__rowNum__",{value:r,enumerable:!1})}catch{_.__rowNum__=r}else _.__rowNum__=r;if(!o||t[r])for(var w=e.s.c;w<=e.e.c;++w){var E=o?t[r][w]:t[n[w]+h];if(E===void 0||E.t===void 0){if(m===void 0)continue;l[w]!=null&&(_[l[w]]=m);continue}var T=E.v;switch(E.t){case"z":if(T==null)break;continue;case"e":T=T==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+E.t)}if(l[w]!=null){if(T==null)if(E.t=="e"&&T===null)_[l[w]]=null;else if(m!==void 0)_[l[w]]=m;else if(p&&T===null)_[l[w]]=null;else continue;else _[l[w]]=p&&(E.t!=="n"||E.t==="n"&&u.rawNumbers!==!1)?T:bi(E,T,u);T!=null&&(v=!1)}}return{row:_,isempty:v}}function $x(t,e){if(t==null||t["!ref"]==null)return[];var r={t:"n",v:0},n=0,a=1,l=[],o=0,u="",h={s:{r:0,c:0},e:{r:0,c:0}},m=e||{},p=m.range!=null?m.range:t["!ref"];switch(m.header===1?n=1:m.header==="A"?n=2:Array.isArray(m.header)?n=3:m.header==null&&(n=0),typeof p){case"string":h=Dr(p);break;case"number":h=Dr(t["!ref"]),h.s.r=p;break;default:h=p}n>0&&(a=0);var v=bn(h.s.r),_=[],w=[],E=0,T=0,A=Array.isArray(t),M=h.s.r,F=0,R={};A&&!t[M]&&(t[M]=[]);var z=m.skipHidden&&t["!cols"]||[],re=m.skipHidden&&t["!rows"]||[];for(F=h.s.c;F<=h.e.c;++F)if(!(z[F]||{}).hidden)switch(_[F]=en(F),r=A?t[M][F]:t[_[F]+v],n){case 1:l[F]=F-h.s.c;break;case 2:l[F]=_[F];break;case 3:l[F]=m.header[F-h.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),u=o=bi(r,null,m),T=R[o]||0,!T)R[o]=1;else{do u=o+"_"+T++;while(R[u]);R[o]=T,R[u]=1}l[F]=u}for(M=h.s.r+a;M<=h.e.r;++M)if(!(re[M]||{}).hidden){var te=IH(t,h,M,_,n,l,A,m);(te.isempty===!1||(n===1?m.blankrows!==!1:m.blankrows))&&(w[E++]=te.row)}return w.length=E,w}var ub=/"/g;function OH(t,e,r,n,a,l,o,u){for(var h=!0,m=[],p="",v=bn(r),_=e.s.c;_<=e.e.c;++_)if(n[_]){var w=u.dense?(t[r]||[])[_]:t[n[_]+v];if(w==null)p="";else if(w.v!=null){h=!1,p=""+(u.rawNumbers&&w.t=="n"?w.v:bi(w,null,u));for(var E=0,T=0;E!==p.length;++E)if((T=p.charCodeAt(E))===a||T===l||T===34||u.forceQuotes){p='"'+p.replace(ub,'""')+'"';break}p=="ID"&&(p='"ID"')}else w.f!=null&&!w.F?(h=!1,p="="+w.f,p.indexOf(",")>=0&&(p='"'+p.replace(ub,'""')+'"')):p="";m.push(p)}return u.blankrows===!1&&h?null:m.join(o)}function XC(t,e){var r=[],n=e??{};if(t==null||t["!ref"]==null)return"";var a=Dr(t["!ref"]),l=n.FS!==void 0?n.FS:",",o=l.charCodeAt(0),u=n.RS!==void 0?n.RS:`
`,h=u.charCodeAt(0),m=new RegExp((l=="|"?"\\|":l)+"+$"),p="",v=[];n.dense=Array.isArray(t);for(var _=n.skipHidden&&t["!cols"]||[],w=n.skipHidden&&t["!rows"]||[],E=a.s.c;E<=a.e.c;++E)(_[E]||{}).hidden||(v[E]=en(E));for(var T=0,A=a.s.r;A<=a.e.r;++A)(w[A]||{}).hidden||(p=OH(t,a,A,v,o,h,l,n),p!=null&&(n.strip&&(p=p.replace(m,"")),(p||n.blankrows!==!1)&&r.push((T++?u:"")+p)));return delete n.dense,r.join("")}function MH(t,e){e||(e={}),e.FS="	",e.RS=`
`;var r=XC(t,e);return r}function jH(t){var e="",r,n="";if(t==null||t["!ref"]==null)return[];var a=Dr(t["!ref"]),l="",o=[],u,h=[],m=Array.isArray(t);for(u=a.s.c;u<=a.e.c;++u)o[u]=en(u);for(var p=a.s.r;p<=a.e.r;++p)for(l=bn(p),u=a.s.c;u<=a.e.c;++u)if(e=o[u]+l,r=m?(t[p]||[])[u]:t[e],n="",r!==void 0){if(r.F!=null){if(e=r.F,!r.f)continue;n=r.f,e.indexOf(":")==-1&&(e=e+":"+e)}if(r.f!=null)n=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)n=""+r.v;else if(r.t=="b")n=r.v?"TRUE":"FALSE";else if(r.w!==void 0)n="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?n="'"+r.v:n=""+r.v}}h[h.length]=e+"="+n}return h}function QC(t,e,r){var n=r||{},a=+!n.skipHeader,l=t||{},o=0,u=0;if(l&&n.origin!=null)if(typeof n.origin=="number")o=n.origin;else{var h=typeof n.origin=="string"?Jn(n.origin):n.origin;o=h.r,u=h.c}var m,p={s:{c:0,r:0},e:{c:u,r:o+e.length-1+a}};if(l["!ref"]){var v=Dr(l["!ref"]);p.e.c=Math.max(p.e.c,v.e.c),p.e.r=Math.max(p.e.r,v.e.r),o==-1&&(o=v.e.r+1,p.e.r=o+e.length-1+a)}else o==-1&&(o=0,p.e.r=e.length-1+a);var _=n.header||[],w=0;e.forEach(function(T,A){Ls(T).forEach(function(M){(w=_.indexOf(M))==-1&&(_[w=_.length]=M);var F=T[M],R="z",z="",re=dt({c:u+w,r:o+A+a});m=Wf(l,re),F&&typeof F=="object"&&!(F instanceof Date)?l[re]=F:(typeof F=="number"?R="n":typeof F=="boolean"?R="b":typeof F=="string"?R="s":F instanceof Date?(R="d",n.cellDates||(R="n",F=ra(F)),z=n.dateNF||yt[14]):F===null&&n.nullError&&(R="e",F=0),m?(m.t=R,m.v=F,delete m.w,delete m.R,z&&(m.z=z)):l[re]=m={t:R,v:F},z&&(m.z=z))})}),p.e.c=Math.max(p.e.c,u+_.length-1);var E=bn(o);if(a)for(w=0;w<_.length;++w)l[en(w+u)+E]={t:"s",v:_[w]};return l["!ref"]=Ht(p),l}function FH(t,e){return QC(null,t,e)}function Wf(t,e,r){if(typeof e=="string"){if(Array.isArray(t)){var n=Jn(e);return t[n.r]||(t[n.r]=[]),t[n.r][n.c]||(t[n.r][n.c]={t:"z"})}return t[e]||(t[e]={t:"z"})}return typeof e!="number"?Wf(t,dt(e)):Wf(t,dt({r:e,c:r||0}))}function PH(t,e){if(typeof e=="number"){if(e>=0&&t.SheetNames.length>e)return e;throw new Error("Cannot find sheet # "+e)}else if(typeof e=="string"){var r=t.SheetNames.indexOf(e);if(r>-1)return r;throw new Error("Cannot find sheet name |"+e+"|")}else throw new Error("Cannot find sheet |"+e+"|")}function P1(){return{SheetNames:[],Sheets:{}}}function L1(t,e,r,n){var a=1;if(!r)for(;a<=65535&&t.SheetNames.indexOf(r="Sheet"+a)!=-1;++a,r=void 0);if(!r||t.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&t.SheetNames.indexOf(r)>=0){var l=r.match(/(^.*?)(\d+)$/);a=l&&+l[2]||0;var o=l&&l[1]||r;for(++a;a<=65535&&t.SheetNames.indexOf(r=o+a)!=-1;++a);}if(wz(r),t.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return t.SheetNames.push(r),t.Sheets[r]=e,r}function LH(t,e,r){t.Workbook||(t.Workbook={}),t.Workbook.Sheets||(t.Workbook.Sheets=[]);var n=PH(t,e);switch(t.Workbook.Sheets[n]||(t.Workbook.Sheets[n]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}t.Workbook.Sheets[n].Hidden=r}function UH(t,e){return t.z=e,t}function JC(t,e,r){return e?(t.l={Target:e},r&&(t.l.Tooltip=r)):delete t.l,t}function BH(t,e,r){return JC(t,"#"+e,r)}function VH(t,e,r){t.c||(t.c=[]),t.c.push({t:e,a:r||"SheetJS"})}function zH(t,e,r,n){for(var a=typeof e!="string"?e:Dr(e),l=typeof e=="string"?e:Ht(e),o=a.s.r;o<=a.e.r;++o)for(var u=a.s.c;u<=a.e.c;++u){var h=Wf(t,o,u);h.t="n",h.F=l,delete h.v,o==a.s.r&&u==a.s.c&&(h.f=r,n&&(h.D=!0))}return t}var HH={encode_col:en,encode_row:bn,encode_cell:dt,encode_range:Ht,decode_col:E1,decode_row:T1,split_cell:e5,decode_cell:Jn,decode_range:Zc,format_cell:bi,sheet_add_aoa:rC,sheet_add_json:QC,sheet_add_dom:WC,aoa_to_sheet:eu,json_to_sheet:FH,table_to_sheet:KC,table_to_book:sH,sheet_to_csv:XC,sheet_to_txt:MH,sheet_to_json:$x,sheet_to_html:aH,sheet_to_formulae:jH,sheet_to_row_object_array:$x,sheet_get_cell:Wf,book_new:P1,book_append_sheet:L1,book_set_sheet_visibility:LH,cell_set_number_format:UH,cell_set_hyperlink:JC,cell_set_internal_link:BH,cell_add_comment:VH,sheet_set_array_formula:zH,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};const ZC="https://www.omdbapi.com/",e4=t=>(t||"").toLowerCase().replace(/^(the|a|an)\s+/,"").replace(/[^a-z0-9]+/g," ").trim(),GH=t=>{const e=new Set,r=n=>{const a=e4(n||"");a&&(e.add(a),a.split(" ").forEach(l=>l&&e.add(l)))};return r(t.Title),t.Year&&e.add(t.Year),t.Genre&&t.Genre.split(",").forEach(n=>r(n)),t.Actors&&t.Actors.split(",").forEach(n=>r(n)),t.Director&&t.Director.split(",").forEach(n=>r(n)),Array.from(e).slice(0,200)},d0=async(t,e)=>{const r=`${ZC}?apikey=${e}&s=${encodeURIComponent(t)}&type=movie`,n=await fetch(r);if(!n.ok)throw new Error(`OMDb API error: ${n.status}`);const a=await n.json();if(a.Response==="False"||!a.Search)throw new Error(a.Error||"No results from OMDb");return a.Search},Mc=async(t,e)=>{const r=`${ZC}?apikey=${e}&i=${encodeURIComponent(t)}&plot=full`,n=await fetch(r);if(!n.ok)throw new Error(`OMDb API error: ${n.status}`);const a=await n.json();if(a.Response==="False")throw new Error(a.Error||"Failed to fetch OMDb details");return a},U1=t=>{const e=t.Title,r=vN(e),n=e4(r),a=t.Year,l=t.Released&&t.Released!=="N/A"?t.Released:a&&a!=="N/A"?`${a}-01-01`:null,o=t.Runtime&&t.Runtime!=="N/A"?parseInt(t.Runtime,10):null,u=t.Genre&&t.Genre!=="N/A"?t.Genre.split(",").map(v=>v.trim()).filter(Boolean):[],h=t.Director&&t.Director!=="N/A"?t.Director.split(",").map(v=>v.trim()).filter(Boolean):[],m=t.Actors&&t.Actors!=="N/A"?t.Actors.split(",").map(v=>v.trim()).filter(Boolean):[],p=t.Plot&&t.Plot!=="N/A"?t.Plot:null;return{imdbId:t.imdbID,title:e,sortTitle:r,sortTitleLower:n,originalTitle:e,releaseDate:l,posterUrl:t.Poster&&t.Poster!=="N/A"?t.Poster:null,backdropUrl:null,overview:p,runtime:o,genres:u,directors:h,cast:m,isChristmas:!0,keywords:GH(t),updatedAt:new Date}},t4=({omdbApiKey:t,tmdbApiKey:e,onDone:r})=>{const{userProfile:n}=An(),[a,l]=q.useState(null),[o,u]=q.useState([]),[h,m]=q.useState([]),[p,v]=q.useState("upload"),[_,w]=q.useState(0),[E,T]=q.useState(null),[A,M]=q.useState(0),[F,R]=q.useState(!1),[z,re]=q.useState(null),[te,b]=q.useState([]),[N,k]=q.useState(null),[j,L]=q.useState(null),[P,U]=q.useState([]),[Ce,Ne]=q.useState(!1),[ae,ue]=q.useState(""),pe=h.filter(he=>he.selected&&he.tmdbMatch).length,ne=e||n?.tmdbApiKey||"",be=he=>{if(he==null||he==="")return null;const we=Number(he);return Number.isFinite(we)?we:null},Q=he=>{const we=he.target.files?.[0];if(!we)return;l(we);const He=new FileReader;He.onload=J=>{const Qe=Yx(J.target?.result,{type:"binary"}),$e=Qe.Sheets[Qe.SheetNames[0]],Ue=HH.sheet_to_json($e).map(De=>({title:De.title||De.Title||De.name||De.Name||"",imdbId:De.imdb||De.IMDB||De.Imdb||De.imdbId||De.imdbID||"",releaseDate:De.year||De.Year||De.releaseDate||De.ReleaseDate||De.release_date||"",tmdbId:De.tmdbId||De.TMDBId||De["TMDB ID"]||De.tmdb||De.TMDB||"",watched:De.watched||De.Watched||!1,rating:De.rating||De.Rating||null,review:De.review||De.Review||De.notes||De.Notes||""})).filter(De=>De.title);u(Ue)},He.readAsBinaryString(we)},I=he=>{const we=h[he],He=we.tmdbIdOverride??be(we.excelData.tmdbId??"");ue(He!=null?String(He):""),U([]),L(he)},Z=async()=>{if(j==null)return;if(!ne){k("TMDb API key is required. Set it on your Profile page.");return}const he=be(ae.trim());if(he==null){k("Enter a valid numeric TMDb ID before loading posters.");return}try{Ne(!0),k(null);const we=await Tm(he,ne);if(!we.length){k("No posters returned from TMDb for this id.");return}U(we),m(He=>{const J=[...He];return J[j]={...J[j],tmdbIdOverride:he},J})}catch(we){k(we?.message||"Failed to fetch TMDb posters.")}finally{Ne(!1)}},ee=he=>{j!=null&&(m(we=>{const He=[...we];return He[j]={...He[j],posterOverrideUrl:he.url},He}),L(null),U([]))},B=async()=>{if(!o.length||!t){k("Missing data or OMDb key");return}try{R(!0),k(null),m([]),w(0),T(null);const he=[],we=ur(rt,"movies");for(let He=0;He<o.length;He++){const J=o[He];T(J.title||null);try{let Qe=null;if(J.imdbId)Qe=await Mc(J.imdbId,t);else{const $e=`${J.title} ${J.releaseDate||""}`.trim();let Fe=$e||J.title,Ue=[];try{Ue=await d0(Fe,t)}catch{Ue=[]}if(!Ue.length&&$e&&J.title&&$e!==J.title){Fe=J.title;try{Ue=await d0(Fe,t)}catch{Ue=[]}}if(!Ue.length){he.push({excelData:J,tmdbMatch:null,confidence:0,status:"unmatched",movieId:void 0,selected:!1});continue}Qe=await Mc(Ue[0].imdbID,t)}if(!Qe)he.push({excelData:J,tmdbMatch:null,confidence:0,status:"unmatched",movieId:void 0,selected:!1});else{const $e=aE(J,Qe),Fe=await Er(gs(we,Da("imdbId","==",Qe.imdbID)));let Ue,De="matched";Fe.empty?$e<70&&(De="manual"):(Ue=Fe.docs[0].id,De=$e>=70?"duplicate":"manual"),he.push({excelData:J,tmdbMatch:Qe,confidence:$e,status:De,movieId:Ue,selected:!0})}}catch{he.push({excelData:J,tmdbMatch:null,confidence:0,status:"unmatched",movieId:void 0,selected:!1})}w(Math.round((He+1)/o.length*100))}m(he),v("review")}finally{R(!1),T(null)}},se=async(he,we)=>{try{R(!0);const He=h[he],J=we||He.excelData.title,Qe=await d0(J,t);re(he),b(Qe)}finally{R(!1)}},_e=async he=>{if(z!=null){R(!0);try{const we=await Mc(he.imdbID,t),He=aE(h[z].excelData,we),J=ur(rt,"movies"),Qe=await Er(gs(J,Da("imdbId","==",we.imdbID)));let $e,Fe="matched";Qe.empty?He<70&&(Fe="manual"):($e=Qe.docs[0].id,Fe=He>=70?"duplicate":"manual"),m(Ue=>{const De=[...Ue];return De[z]={excelData:Ue[z].excelData,tmdbMatch:we,confidence:He,status:Fe,movieId:$e,selected:!0},De}),re(null),b([])}finally{R(!1)}}},Pe=async()=>{const he=h.filter(He=>He.selected&&He.tmdbMatch);if(!he.length)return;v("import"),M(0);const we=ur(rt,"movies");for(let He=0;He<he.length;He++){const J=he[He];try{const Qe=J.tmdbMatch,$e=await Er(gs(we,Da("imdbId","==",Qe.imdbID)));let Fe=null;J.tmdbIdOverride!=null?Fe=J.tmdbIdOverride:Fe=be(J.excelData.tmdbId??"");const Ue={...U1(Qe),updatedAt:new Date};if(J.posterOverrideUrl&&(Ue.posterUrl=J.posterOverrideUrl),Fe!=null&&(Ue.tmdbId=Fe),$e.empty)await vm(we,{...Ue,addedAt:new Date});else{const De=$e.docs[0].id;await Ia(Pt(rt,"movies",De),Ue,{merge:!0})}}catch{}M(Math.round((He+1)/he.length*100))}r?.()};return d.jsxs("div",{className:"space-y-6",children:[p==="upload"&&d.jsxs("div",{className:"space-y-4",children:[d.jsx("input",{type:"file",accept:".xlsx,.xls",className:"file-input file-input-bordered w-full",onChange:Q}),!!o.length&&d.jsxs("div",{className:"text-sm opacity-80",children:[o.length," rows detected"]}),d.jsx("button",{className:"btn btn-primary",onClick:B,disabled:!t||!o.length||F,children:F?d.jsx("span",{className:"loading loading-spinner loading-sm"}):"Scan & Match to Catalogue"}),F&&!!_&&_<100&&d.jsxs("div",{className:"space-y-1",children:[d.jsxs("div",{className:"text-sm",children:["Scanning ",_,"%"]}),d.jsx("progress",{className:"progress w-full",value:_,max:100}),E&&d.jsxs("div",{className:"text-xs opacity-70 truncate",children:["Current: ",E]})]})]}),j!==null&&d.jsx("div",{className:"fixed inset-0 z-[100] flex items-center justify-center bg-black/60",children:d.jsxs("div",{className:"bg-base-100 rounded-box shadow-xl max-w-4xl w-full max-h-[90vh] overflow-hidden p-6",children:[d.jsxs("h3",{className:"font-bold text-lg mb-4",children:["TMDb poster for: ",h[j].excelData.title]}),d.jsxs("div",{className:"form-control mb-4",children:[d.jsx("label",{className:"label",children:d.jsx("span",{className:"label-text",children:"TMDb ID"})}),d.jsx("input",{type:"text",className:"input input-bordered w-full",value:ae,onChange:he=>ue(he.target.value),placeholder:"e.g. 603692"}),d.jsx("label",{className:"label",children:d.jsx("span",{className:"label-text-alt",children:"This id will be stored on the catalogue movie and used by the poster tools."})})]}),d.jsx("div",{className:"flex items-center gap-3 mb-4",children:d.jsx("button",{className:"btn btn-primary btn-sm",onClick:Z,disabled:Ce,children:Ce?d.jsxs(d.Fragment,{children:[d.jsx("span",{className:"loading loading-spinner loading-xs mr-2"}),"Loading TMDb posters"]}):d.jsxs(d.Fragment,{children:[d.jsx("i",{className:"fas fa-photo-video mr-2"}),"Load TMDb posters"]})})}),P.length>0&&d.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-3 max-h-96 overflow-y-auto mb-4",children:P.map(he=>d.jsx("button",{className:"border border-transparent hover:border-primary rounded-lg overflow-hidden bg-base-200",type:"button",onClick:()=>ee(he),children:d.jsx("img",{src:he.url,className:"w-full h-auto object-cover"})},he.url))}),d.jsx("div",{className:"flex justify-end mt-4",children:d.jsx("button",{className:"btn",onClick:()=>{L(null),U([])},children:"Close"})})]})}),p==="review"&&d.jsxs("div",{className:"space-y-4",children:[d.jsxs("div",{className:"flex justify-between items-center",children:[d.jsx("div",{className:"font-bold",children:"Review Catalogue Matches"}),d.jsx("button",{className:"btn btn-ghost btn-sm",onClick:()=>v("upload"),children:"Back"})]}),d.jsx("div",{className:"overflow-x-auto",children:d.jsxs("table",{className:"table table-zebra w-full",children:[d.jsx("thead",{children:d.jsxs("tr",{children:[d.jsx("th",{}),d.jsx("th",{children:"Excel"}),d.jsx("th",{children:"Match"}),d.jsx("th",{children:"Confidence"}),d.jsx("th",{children:"Status"}),d.jsx("th",{children:"Action"})]})}),d.jsx("tbody",{children:h.map((he,we)=>d.jsxs("tr",{children:[d.jsx("td",{children:d.jsx("input",{type:"checkbox",className:"checkbox",checked:he.selected,disabled:!he.tmdbMatch,onChange:()=>{const He=[...h];He[we].selected=!He[we].selected,m(He)}})}),d.jsxs("td",{children:[d.jsx("div",{className:"font-semibold",children:he.excelData.title}),d.jsx("div",{className:"text-xs opacity-70",children:he.excelData.releaseDate||"-"})]}),d.jsx("td",{children:he.tmdbMatch?d.jsxs("div",{className:"flex items-center gap-3",children:[d.jsx("div",{className:"w-12 h-18",children:Is(he.tmdbMatch)?d.jsx("img",{src:Is(he.tmdbMatch),className:"object-cover"}):d.jsx("div",{className:"w-full h-full bg-base-200"})}),d.jsxs("div",{children:[d.jsx("div",{className:"font-semibold",children:he.tmdbMatch.Title}),d.jsx("div",{className:"text-xs opacity-70",children:he.tmdbMatch.Year})]})]}):d.jsx("span",{className:"text-error",children:"No match"})}),d.jsxs("td",{children:[he.tmdbMatch?d.jsxs("div",{className:"flex items-center",children:[d.jsx("progress",{className:`progress ${he.confidence>=70?"progress-success":he.confidence>=40?"progress-warning":"progress-error"}`,value:he.confidence,max:100}),d.jsxs("span",{className:"ml-2",children:[he.confidence,"%"]})]}):"-",he.status==="manual"&&d.jsx("div",{className:"badge badge-info",children:"Manual"})]}),d.jsxs("td",{children:[d.jsx("button",{className:"btn btn-sm btn-outline",onClick:()=>se(we),children:d.jsx("i",{className:"fas fa-search"})}),d.jsx("button",{className:"btn btn-sm btn-outline ml-2",onClick:()=>I(we),children:d.jsx("i",{className:"fas fa-photo-video"})})]})]},we))})]})}),d.jsx("div",{className:"flex justify-end",children:d.jsxs("button",{className:"btn btn-primary",onClick:Pe,disabled:!pe||F,children:["Import ",pe," to Catalogue"]})}),!!_&&_<100&&d.jsx("div",{children:d.jsx("progress",{className:"progress w-full",value:_,max:100})})]}),p==="import"&&d.jsxs("div",{className:"space-y-3",children:[d.jsx("div",{className:"font-bold",children:"Importing to Catalogue"}),d.jsx("progress",{className:"progress w-full",value:A,max:100})]}),z!==null&&d.jsx("div",{className:"fixed inset-0 z-[100] flex items-center justify-center bg-black/60",children:d.jsxs("div",{className:"bg-base-100 rounded-box shadow-xl max-w-4xl w-full max-h-[90vh] overflow-hidden p-6",children:[d.jsxs("h3",{className:"font-bold text-lg mb-4",children:["Manual match: ",h[z].excelData.title]}),d.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 mb-6",children:[d.jsx("input",{type:"text",className:"input input-bordered flex-1",placeholder:"Search for a movie...",defaultValue:h[z].excelData.title,onKeyDown:he=>he.key==="Enter"&&se(z,he.target.value)}),d.jsx("button",{className:"btn btn-primary w-full sm:w-auto",onClick:()=>se(z,document.querySelector("[data-manual-search-input]")?.value),disabled:F,children:F?d.jsx("span",{className:"loading loading-spinner loading-sm"}):d.jsx("i",{className:"fas fa-search"})})]}),d.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-3 max-h-96 overflow-y-auto",children:te.map(he=>d.jsxs("div",{className:"card bg-base-100 shadow cursor-pointer",onClick:()=>_e(he),children:[d.jsx("figure",{children:Is(he)?d.jsx("img",{src:Is(he)}):d.jsx("div",{className:"h-48 w-full bg-base-200"})}),d.jsxs("div",{className:"card-body p-3",children:[d.jsx("div",{className:"text-sm font-semibold",children:he.Title}),d.jsx("div",{className:"text-xs opacity-70",children:he.Year})]})]},he.imdbID))}),d.jsx("div",{className:"flex justify-end mt-6",children:d.jsx("button",{className:"btn",onClick:()=>{re(null),b([])},children:"Close"})})]})}),N&&d.jsx("div",{className:"alert alert-error",children:N})]})},r4=({omdbApiKey:t,onSelect:e})=>{const[r,n]=q.useState(""),[a,l]=q.useState(!1),[o,u]=q.useState([]),[h,m]=q.useState(null),p=async()=>{const v=r.trim();if(!v)return;const _=v.toLowerCase().startsWith("tt")?v:`tt${v}`,w=/^tt\d+$/.test(_)?_:null;try{if(l(!0),m(null),w){const E=await Mc(w,t);u([E])}else{const E=await d0(v,t);u(E)}}catch(E){u([]),m(E?.message??"OMDb search failed")}finally{l(!1)}};return d.jsxs("div",{className:"space-y-3",children:[d.jsxs("div",{className:"flex gap-2",children:[d.jsx("input",{className:"input input-bordered flex-1",value:r,onChange:v=>n(v.target.value),placeholder:"Search OMDb by title or IMDb id...",onKeyDown:v=>v.key==="Enter"&&p()}),d.jsx("button",{className:"btn btn-primary",onClick:p,disabled:a||!t,children:a?d.jsx("span",{className:"loading loading-spinner loading-sm"}):"Search"})]}),h&&d.jsx("div",{className:"alert alert-error",children:h}),o.length>0&&d.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-3",children:o.map(v=>d.jsxs("div",{className:"card bg-base-100 shadow cursor-pointer hover:shadow-lg transition-shadow",onClick:()=>e(v),children:[d.jsx("figure",{children:Is(v)?d.jsx("img",{src:Is(v),alt:v.Title,className:"w-full h-64 object-contain"}):d.jsx("div",{className:"h-64 w-full flex items-center justify-center bg-base-200",children:d.jsx("i",{className:"fas fa-film text-3xl opacity-50"})})}),d.jsxs("div",{className:"card-body p-3",children:[d.jsx("div",{className:"font-semibold",children:v.Title}),d.jsx("div",{className:"text-xs opacity-70",children:v.Year})]})]},v.imdbID))})]})},qH=()=>{const t=Ma(),{isAdmin:e,loading:r}=Qc(),{userProfile:n}=An(),[a,l]=q.useState(!0),[o,u]=q.useState(null),[h,m]=q.useState(null),[p,v]=q.useState(!1),[_,w]=q.useState({totalMovies:0,moviesWithSortTitle:0}),[E,T]=q.useState([]),[A,M]=q.useState(!1),[F,R]=q.useState(!1),[z,re]=q.useState(""),[te,b]=q.useState(""),[N,k]=q.useState("single"),[j,L]=q.useState(null),[P,U]=q.useState(!1),[Ce,Ne]=q.useState(null),[ae,ue]=q.useState(""),[pe,ne]=q.useState([]),[be,Q]=q.useState(!1),[I,Z]=q.useState(!1),[ee,B]=q.useState(null),[se,_e]=q.useState(0);q.useEffect(()=>{n?.omdbApiKey&&re(n.omdbApiKey),n?.tmdbApiKey&&b(n.tmdbApiKey)},[n]),q.useEffect(()=>{!r&&!e&&t("/admin/login")},[e,r,t]),q.useEffect(()=>{e&&(async()=>{if(e){l(!0);try{const Ue=await Er(ur(rt,"movies")),De=Ue.size;let ut=0;Ue.forEach(Lt=>{Lt.data().sortTitle&&ut++}),w({totalMovies:De,moviesWithSortTitle:ut})}catch(Ue){console.error("Error fetching movie data:",Ue),u("Failed to load movie data")}finally{l(!1)}}})()},[e]);const Pe=async Fe=>{if(!z){Ne({type:"error",text:"OMDb API key required to fetch details."});return}try{U(!0),Ne(null);const Ue=await Mc(Fe.imdbID,z);L(Ue),ue(""),B(null),ne([]),Z(!1)}catch(Ue){Ne({type:"error",text:Ue?.message??"Failed to fetch OMDb details."})}finally{U(!1)}},he=async()=>{if(!j)return;if(!te){Ne({type:"error",text:"TMDb API key required to fetch posters. Set it on your Profile page."});return}const Fe=parseInt(ae.trim(),10);if(!Number.isFinite(Fe)){Ne({type:"error",text:"Enter a valid numeric TMDb ID before loading posters."});return}try{Q(!0),Ne(null);const Ue=await Tm(Fe,te);if(!Ue.length){Ne({type:"error",text:"No posters returned from TMDb for this id."});return}ne(Ue),Z(!0)}catch(Ue){Ne({type:"error",text:Ue?.message??"Failed to fetch TMDb posters."})}finally{Q(!1)}},we=Fe=>{B(Fe.url),Z(!1)},He=async()=>{if(j)try{U(!0),Ne(null);const Fe=ur(rt,"movies"),Ue=j.imdbID,De=await Er(gs(Fe,Da("imdbId","==",Ue))),ut={...U1(j),updatedAt:new Date},Lt=ae.trim()?parseInt(ae.trim(),10):NaN;if(Number.isFinite(Lt)&&(ut.tmdbId=Lt),ee&&(ut.posterUrl=ee),De.empty)await vm(Fe,{...ut,addedAt:new Date});else{const Qt=De.docs[0].id;await Ia(Pt(rt,"movies",Qt),ut,{merge:!0})}Ne({type:"success",text:`Catalogue updated: ${j.Title}`}),L(null),ue(""),B(null),ne([]),Z(!1),_e(Qt=>Qt+1)}catch(Fe){Ne({type:"error",text:Fe?.message??"Failed to save movie to catalogue."})}finally{U(!1)}},J=async()=>{try{u(null),R(!0);const Fe=await Er(ur(rt,"movies")),Ue=[];Ue.push("Title,IMDb ID,Year");const De=Hn=>{const Jt=(Hn??"").toString(),pt=/[",\n]/.test(Jt),hr=Jt.replace(/"/g,'""');return pt?`"${hr}"`:hr};Fe.forEach(Hn=>{const Jt=Hn.data(),pt=Jt.title||"",hr=Jt.imdbId||"";let kt="";if(Jt.releaseDate)try{const $t=Jt.releaseDate?.toDate?Jt.releaseDate.toDate():new Date(Jt.releaseDate);isNaN($t.getTime())?typeof Jt.releaseDate=="string"&&(kt=Jt.releaseDate.slice(0,4)):kt=String($t.getFullYear())}catch{typeof Jt.releaseDate=="string"&&(kt=Jt.releaseDate.slice(0,4))}Ue.push([De(pt),De(hr),De(kt)].join(","))});const ut=Ue.join(`
`),Lt=new Blob([ut],{type:"text/csv;charset=utf-8;"}),Qt=URL.createObjectURL(Lt),yr=document.createElement("a");yr.href=Qt,yr.download="movies_catalogue.csv",document.body.appendChild(yr),yr.click(),document.body.removeChild(yr),URL.revokeObjectURL(Qt)}catch(Fe){console.error("Error exporting catalogue CSV:",Fe),u(Fe.message||"Failed to export catalogue CSV")}finally{R(!1)}};q.useEffect(()=>{e&&(async()=>{if(e){M(!0);try{const Ue=gs(ur(rt,"Requests"),Da("status","==","pending")),ut=(await Er(Ue)).docs.map(Lt=>({id:Lt.id,...Lt.data()}));T(ut)}catch(Ue){console.error("Error fetching movie requests:",Ue),u("Failed to load movie requests")}finally{M(!1)}}})()},[e]);const Qe=async()=>{try{v(!0),u(null);const Fe=await b8();m(`Sort titles updated for ${Fe.updated} out of ${Fe.total} movies.`),w(Ue=>({...Ue,moviesWithSortTitle:Ue.moviesWithSortTitle+Fe.updated})),setTimeout(()=>m(null),5e3)}catch(Fe){console.error("Error updating sort titles:",Fe),u(Fe.message||"Failed to update sort titles")}finally{v(!1)}},$e=async(Fe,Ue)=>{try{u(null),await ea(Pt(rt,"Requests",Fe),{status:Ue,updatedAt:new Date}),T(De=>De.filter(ut=>ut.id!==Fe)),m(`Request marked as ${Ue}.`),setTimeout(()=>m(null),4e3)}catch(De){console.error("Error updating request status:",De),u(De.message||"Failed to update request")}};return r||a?d.jsx("div",{className:"flex justify-center items-center min-h-[60vh]",children:d.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-xmas-gold"})}):d.jsxs("div",{className:"container mx-auto px-4 py-8",children:[d.jsxs("div",{className:"flex justify-between items-center mb-8",children:[d.jsx("h1",{className:"font-christmas text-3xl md:text-4xl text-xmas-line",children:"Admin Dashboard"}),d.jsx("div",{className:"flex gap-2",children:d.jsxs(gt,{to:"/movies",className:"btn btn-outline",children:[d.jsx("i",{className:"fas fa-film mr-2"})," Movies"]})})]}),o&&d.jsxs("div",{className:"alert alert-error mb-6",children:[d.jsx("i",{className:"fas fa-exclamation-circle mr-2"}),d.jsx("span",{children:o})]}),h&&d.jsxs("div",{className:"alert alert-success mb-6",children:[d.jsx("i",{className:"fas fa-check-circle mr-2"}),d.jsx("span",{children:h})]}),d.jsxs("div",{className:"mb-8",children:[d.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between mb-4 gap-3",children:[d.jsx("h2",{className:"text-2xl font-christmas text-xmas-gold",children:"Movie Administration"}),d.jsx("div",{className:"flex flex-wrap gap-2 justify-start md:justify-end"})]}),d.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-6",children:[d.jsx("div",{className:"card bg-xmas-card shadow-xl",children:d.jsxs("div",{className:"card-body",children:[d.jsxs("h2",{className:"card-title font-christmas",children:[d.jsx("i",{className:"fas fa-sort-alpha-down text-primary mr-2"})," Sort Title Migration"]}),d.jsx("p",{className:"mb-4",children:'Update all movies to include sort titles (e.g., "The Grinch"  "Grinch") for better alphabetical sorting.'}),d.jsxs("div",{className:"flex flex-col gap-2",children:[d.jsxs("div",{className:"stats bg-base-200 text-base-content",children:[d.jsxs("div",{className:"stat",children:[d.jsx("div",{className:"stat-title",children:"Total Movies"}),d.jsx("div",{className:"stat-value",children:_.totalMovies})]}),d.jsxs("div",{className:"stat",children:[d.jsx("div",{className:"stat-title",children:"With Sort Titles"}),d.jsx("div",{className:"stat-value",children:_.moviesWithSortTitle}),d.jsx("div",{className:"stat-desc",children:_.totalMovies>0?`${Math.round(_.moviesWithSortTitle/_.totalMovies*100)}%`:"0%"})]})]}),d.jsxs("button",{className:"btn btn-primary w-full",onClick:Qe,disabled:p||_.moviesWithSortTitle===_.totalMovies,children:[p?d.jsx("span",{className:"loading loading-spinner loading-sm mr-2"}):d.jsx("i",{className:"fas fa-sync-alt mr-2"}),_.moviesWithSortTitle===_.totalMovies?"All Movies Updated":"Update Sort Titles"]})]})]})}),d.jsx("div",{className:"card bg-xmas-card shadow-xl",children:d.jsxs("div",{className:"card-body",children:[d.jsxs("h2",{className:"card-title font-christmas",children:[d.jsx("i",{className:"fas fa-tools text-primary mr-2"})," Catalogue Tools"]}),d.jsx("p",{className:"mb-4 text-sm opacity-80",children:"Use these tools to export your movie catalogue and manage advanced poster settings."}),d.jsxs("div",{className:"flex flex-col gap-3",children:[d.jsxs("div",{children:[d.jsxs(gt,{to:"/admin/posters",className:"btn btn-outline btn-sm w-full flex items-center gap-2 justify-center",children:[d.jsx("i",{className:"fas fa-image"}),"Poster Manager"]}),d.jsx("p",{className:"mt-1 text-xs opacity-80",children:"Open the poster manager to review and curate artwork for catalogue movies."})]}),d.jsxs("div",{children:[d.jsx("button",{className:"btn btn-outline btn-sm w-full flex items-center gap-2 justify-center",onClick:J,disabled:F,children:F?d.jsxs(d.Fragment,{children:[d.jsx("span",{className:"loading loading-spinner loading-xs"}),"Exporting"]}):d.jsxs(d.Fragment,{children:[d.jsx("i",{className:"fas fa-file-csv"}),"Export Catalogue CSV"]})}),d.jsx("p",{className:"mt-1 text-xs opacity-80",children:"Download a CSV snapshot of your current movies catalogue for backup or analysis."})]})]})]})})]}),d.jsx("div",{className:"card bg-xmas-card shadow-xl overflow-visible no-card-hover",children:d.jsxs("div",{className:"card-body",children:[d.jsxs("h2",{className:"card-title font-christmas",children:[d.jsx("i",{className:"fas fa-file-import text-primary mr-2"})," Import & Posters"]}),d.jsx("p",{className:"mb-4 text-sm opacity-80",children:"Import or update catalogue movies via OMDb or Excel, and attach TMDb ids and posters."}),Ce&&d.jsxs("div",{className:`alert ${Ce.type==="error"?"alert-error":"alert-success"} mb-4`,children:[d.jsx("i",{className:`fas ${Ce.type==="error"?"fa-exclamation-circle":"fa-check-circle"} mr-2`}),d.jsx("span",{children:Ce.text})]}),d.jsxs("div",{className:"tabs tabs-boxed mb-6",children:[d.jsxs("button",{className:`tab ${N==="single"?"tab-active":""}`,onClick:()=>k("single"),children:[d.jsx("i",{className:"fas fa-search mr-2"}),"Single OMDb Import"]}),d.jsxs("button",{className:`tab ${N==="excel"?"tab-active":""}`,onClick:()=>k("excel"),children:[d.jsx("i",{className:"fas fa-file-excel mr-2"}),"Excel Catalogue Import"]})]}),N==="single"&&d.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6 items-start",children:[d.jsxs("div",{children:[!z&&d.jsxs("div",{className:"alert alert-warning mb-4",children:[d.jsx("i",{className:"fas fa-exclamation-triangle mr-2"}),d.jsx("span",{children:"Set your OMDb API key in Profile to search OMDb."})]}),d.jsx("h3",{className:"font-christmas text-xl mb-4 text-xmas-gold",children:"Search OMDb"}),d.jsx(r4,{omdbApiKey:z,onSelect:Pe},se)]}),d.jsxs("div",{children:[d.jsx("h3",{className:"font-christmas text-xl mb-4 text-xmas-gold",children:"Selected Movie"}),j?d.jsxs("div",{className:"space-y-4",children:[d.jsxs("div",{className:"flex gap-4",children:[d.jsx("div",{className:"w-24 shrink-0",children:ee||j.Poster?d.jsx("img",{src:ee||j.Poster,alt:j.Title,className:"w-full rounded-lg"}):d.jsx("div",{className:"w-full h-36 bg-base-200 flex items-center justify-center rounded-lg",children:d.jsx("i",{className:"fas fa-film text-2xl opacity-50"})})}),d.jsxs("div",{className:"flex-1",children:[d.jsx("h4",{className:"text-lg font-bold mb-1",children:j.Title}),d.jsx("p",{className:"text-sm opacity-80 mb-1",children:j.Year}),j.Plot&&d.jsx("p",{className:"text-sm opacity-80 line-clamp-4",children:j.Plot})]})]}),d.jsxs("div",{className:"form-control",children:[d.jsx("label",{className:"label",children:d.jsx("span",{className:"label-text",children:"TMDb ID (manual)"})}),d.jsx("input",{type:"text",className:"input input-bordered w-full",value:ae,onChange:Fe=>ue(Fe.target.value),placeholder:"e.g. 603692"}),d.jsx("label",{className:"label",children:d.jsx("span",{className:"label-text-alt",children:"This id is stored on the catalogue movie and used by the poster tools."})})]}),d.jsx("div",{className:"flex flex-col sm:flex-row gap-3 items-start sm:items-center",children:d.jsx("button",{type:"button",className:"btn btn-outline btn-sm sm:btn-md",onClick:he,disabled:be,children:be?d.jsxs(d.Fragment,{children:[d.jsx("span",{className:"loading loading-spinner loading-xs mr-2"}),"Loading TMDb posters"]}):d.jsxs(d.Fragment,{children:[d.jsx("i",{className:"fas fa-photo-video mr-2"}),"Posters"]})})}),d.jsx("div",{className:"pt-2",children:d.jsxs("button",{type:"button",className:"btn btn-primary w-full sm:w-auto",onClick:He,disabled:P,children:[P?d.jsx("span",{className:"loading loading-spinner loading-sm mr-2"}):d.jsx("i",{className:"fas fa-save mr-2"}),"Save to Catalogue"]})})]}):d.jsx("p",{className:"text-sm opacity-80",children:"Search OMDb on the left and choose a result to review details, attach a TMDb id, and pick a poster."})]})]}),N==="excel"&&d.jsxs("div",{className:"mt-4",children:[!z&&d.jsxs("div",{className:"alert alert-warning mb-4",children:[d.jsx("i",{className:"fas fa-exclamation-triangle mr-2"}),d.jsx("span",{children:"OMDb key required for matching."})]}),z&&d.jsx(t4,{omdbApiKey:z,onDone:()=>{Ne({type:"success",text:"Excel catalogue import completed."})}})]})]})}),I&&pe.length>0&&d.jsx("dialog",{className:"modal modal-open",children:d.jsxs("div",{className:"modal-box max-w-5xl bg-xmas-card",children:[d.jsx("h3",{className:"font-bold text-lg mb-2",children:"Choose a TMDb poster"}),d.jsx("p",{className:"text-xs opacity-80 mb-4",children:"These posters come from The Movie Database for the TMDb id you entered."}),d.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-3 max-h-[60vh] overflow-y-auto",children:pe.map(Fe=>d.jsx("button",{type:"button",className:"border border-transparent hover:border-xmas-gold rounded-lg overflow-hidden bg-gray-900 focus:outline-none focus:ring-2 focus:ring-xmas-gold",onClick:()=>we(Fe),children:d.jsx("img",{src:Fe.url,alt:"TMDb poster option",className:"w-full h-auto object-cover",style:{aspectRatio:"2/3"}})},Fe.url))}),d.jsx("div",{className:"modal-action",children:d.jsx("button",{type:"button",className:"btn btn-sm",onClick:()=>{Z(!1)},children:"Close"})})]})})]}),d.jsxs("div",{className:"mb-8",children:[d.jsx("h2",{className:"text-2xl font-christmas mb-4 text-xmas-gold",children:"Movie Requests"}),d.jsx("div",{className:"card bg-xmas-card shadow-xl",children:d.jsxs("div",{className:"card-body",children:[d.jsxs("h2",{className:"card-title font-christmas flex items-center gap-2",children:[d.jsx("i",{className:"fas fa-gift text-primary"}),"Pending Requests"]}),d.jsx("p",{className:"text-sm opacity-80 mb-4",children:"These are movies users have asked to be added to the catalogue."}),A?d.jsx("div",{className:"flex justify-center py-8",children:d.jsx("span",{className:"loading loading-spinner loading-md"})}):E.length===0?d.jsx("p",{className:"text-sm opacity-80",children:"No pending requests right now."}):d.jsx("div",{className:"overflow-x-auto",children:d.jsxs("table",{className:"table table-zebra table-sm",children:[d.jsx("thead",{children:d.jsxs("tr",{children:[d.jsx("th",{children:"Title"}),d.jsx("th",{children:"Year"}),d.jsx("th",{children:"IMDb"}),d.jsx("th",{children:"TMDB"}),d.jsx("th",{children:"Requested By"}),d.jsx("th",{children:"Notes"}),d.jsx("th",{})]})}),d.jsx("tbody",{children:E.map(Fe=>{const Ue=Fe.createdAt?.toDate?Fe.createdAt.toDate():Fe.createdAt;return d.jsxs("tr",{children:[d.jsxs("td",{children:[d.jsx("div",{className:"font-semibold",children:Fe.title}),Ue&&d.jsx("div",{className:"text-xs opacity-70",children:new Date(Ue).toLocaleString()})]}),d.jsx("td",{children:Fe.year||"-"}),d.jsxs("td",{children:[Fe.imdbId&&d.jsxs("div",{className:"text-xs",children:["ID: ",Fe.imdbId]}),Fe.imdbUrl&&d.jsx("a",{href:Fe.imdbUrl,target:"_blank",rel:"noopener noreferrer",className:"link link-primary text-xs",children:"View IMDb"})]}),d.jsxs("td",{children:[Fe.tmdbId&&d.jsxs("div",{className:"text-xs",children:["ID: ",Fe.tmdbId]}),Fe.tmdbUrl&&d.jsx("a",{href:Fe.tmdbUrl,target:"_blank",rel:"noopener noreferrer",className:"link link-primary text-xs",children:"View TMDB"})]}),d.jsxs("td",{children:[d.jsx("div",{className:"text-sm",children:Fe.userDisplayName||Fe.userEmail||Fe.userId}),Fe.userEmail&&d.jsx("div",{className:"text-xs opacity-70",children:Fe.userEmail})]}),d.jsx("td",{className:"max-w-xs whitespace-pre-wrap text-xs",children:Fe.notes||"-"}),d.jsxs("td",{className:"flex flex-col gap-1",children:[d.jsx("button",{className:"btn btn-xs btn-success",onClick:()=>$e(Fe.id,"fulfilled"),children:"Fulfilled"}),d.jsx("button",{className:"btn btn-xs btn-ghost",onClick:()=>$e(Fe.id,"dismissed"),children:"Dismiss"})]})]},Fe.id)})})]})})]})})]})]})},WH=()=>{const t=Ma(),{isAdmin:e,loading:r}=Qc(),{userProfile:n}=An(),[a,l]=q.useState(!0),[o,u]=q.useState(null),[h,m]=q.useState(null),[p,v]=q.useState([]),[_,w]=q.useState({}),[E,T]=q.useState(null),[A,M]=q.useState(null),[F,R]=q.useState(null),[z,re]=q.useState([]),[te,b]=q.useState(""),[N,k]=q.useState("all"),j=q.useRef({});q.useEffect(()=>{!r&&!e&&t("/admin/login")},[e,r,t]),q.useEffect(()=>{e&&(async()=>{if(e){l(!0),u(null);try{const ne=await Er(ur(rt,"movies")),be=[];ne.forEach(Q=>{const I=Q.data();be.push({id:Q.id,title:I.title||"(Untitled)",releaseDate:I.releaseDate,posterUrl:I.posterUrl,tmdbId:I.tmdbId})}),be.sort((Q,I)=>Q.title.localeCompare(I.title)),v(be)}catch(ne){console.error("Error loading movies for poster manager:",ne),u(ne?.message||"Failed to load movies")}finally{l(!1)}}})()},[e]);const L=(pe,ne)=>{w(be=>({...be,[pe]:ne}))},P=pe=>{const ne=j.current[pe];ne&&ne.click()},U=async pe=>{const ne=_[pe.id];if(!ne){u("Please choose an image file to upload.");return}try{u(null),m(null),T(pe.id);const be=ne.name.match(/\.([a-zA-Z0-9]+)$/),Q=be?be[1]:"jpg",I=(pe.title||"movie").toLowerCase().replace(/[^a-z0-9]+/g,"-"),Z=dP(UP,`movies/${pe.id}/poster-${I}.${Q}`);await fP(Z,ne);const ee=await hP(Z);await ea(Pt(rt,"movies",pe.id),{posterUrl:ee,updatedAt:new Date}),v(B=>B.map(se=>se.id===pe.id?{...se,posterUrl:ee}:se)),m(`Poster updated for "${pe.title}".`),w(B=>({...B,[pe.id]:null}))}catch(be){console.error("Error uploading poster image:",be),u(be?.message||"Failed to upload poster image")}finally{T(null)}},Ce=q.useMemo(()=>{const pe=te.trim().toLowerCase();return p.filter(ne=>{if(N==="with"&&!ne.posterUrl||N==="without"&&ne.posterUrl)return!1;if(!pe)return!0;const be=ne.title.toLowerCase(),Q=ne.releaseDate?new Date(ne.releaseDate).getFullYear().toString():"";return be.includes(pe)||!!Q&&Q.includes(pe)})},[p,te,N]),Ne=n?.tmdbApiKey||"",ae=async pe=>{if(!Ne){u("TMDb API key is required. Set it on your Profile page.");return}if(!pe.tmdbId){u("No tmdbId stored for this movie.");return}try{u(null),m(null),M(pe.id);const ne=await Tm(pe.tmdbId,Ne);if(!ne.length){u("No posters returned from TMDb for this movie.");return}re(ne),R(pe.id)}catch(ne){console.error("Error fetching TMDb posters:",ne),u(ne?.message||"Failed to fetch TMDb posters")}finally{M(null)}},ue=async pe=>{if(!F)return;const ne=p.find(be=>be.id===F);if(ne)try{u(null),m(null),await ea(Pt(rt,"movies",ne.id),{posterUrl:pe.url,updatedAt:new Date}),v(be=>be.map(Q=>Q.id===ne.id?{...Q,posterUrl:pe.url}:Q)),m(`TMDb poster applied for "${ne.title}".`),R(null),re([])}catch(be){console.error("Error applying TMDb poster:",be),u(be?.message||"Failed to apply TMDb poster")}};return r||a?d.jsx("div",{className:"flex justify-center items-center min-h-[60vh]",children:d.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-xmas-gold"})}):d.jsxs("div",{className:"container mx-auto px-4 py-8",children:[d.jsxs("div",{className:"flex justify-between items-center mb-6",children:[d.jsxs("div",{children:[d.jsx("h1",{className:"font-christmas text-3xl md:text-4xl text-xmas-line",children:"Poster Image Manager"}),d.jsx("p",{className:"text-sm text-xmas-mute mt-1",children:"View current posters and upload replacements stored in Firebase Storage."})]}),d.jsx("div",{className:"flex gap-2",children:d.jsxs(gt,{to:"/admin",className:"btn btn-outline btn-sm md:btn-md",children:[d.jsx("i",{className:"fas fa-arrow-left mr-2"}),"Admin Dashboard"]})})]}),o&&d.jsxs("div",{className:"alert alert-error mb-4",children:[d.jsx("i",{className:"fas fa-exclamation-circle mr-2"}),d.jsx("span",{children:o})]}),h&&d.jsxs("div",{className:"alert alert-success mb-4",children:[d.jsx("i",{className:"fas fa-check-circle mr-2"}),d.jsx("span",{children:h})]}),p.length>0&&d.jsxs("div",{className:"flex flex-col md:flex-row md:items-center gap-2 mb-4",children:[d.jsx("div",{className:"flex-1",children:d.jsxs("div",{className:"relative",children:[d.jsx("span",{className:"absolute inset-y-0 left-0 pl-2 flex items-center pointer-events-none",children:d.jsx("i",{className:"fas fa-search text-gray-400"})}),d.jsx("input",{type:"text",className:"input input-bordered input-sm md:input-md w-full pl-8 pr-8",placeholder:"Search by title or year...",value:te,onChange:pe=>b(pe.target.value)}),te&&d.jsx("button",{type:"button",className:"absolute inset-y-0 right-0 pr-2 flex items-center",onClick:()=>b(""),children:d.jsx("i",{className:"fas fa-times text-gray-400 hover:text-gray-600"})})]})}),d.jsxs("div",{className:"flex gap-1",children:[d.jsx("button",{type:"button",className:`btn btn-xs md:btn-sm ${N==="all"?"btn-primary":"btn-ghost"}`,onClick:()=>k("all"),children:"All"}),d.jsx("button",{type:"button",className:`btn btn-xs md:btn-sm ${N==="with"?"btn-primary":"btn-ghost"}`,onClick:()=>k("with"),children:"With poster"}),d.jsx("button",{type:"button",className:`btn btn-xs md:btn-sm ${N==="without"?"btn-primary":"btn-ghost"}`,onClick:()=>k("without"),children:"No poster"})]})]}),Ce.length===0?d.jsx("p",{className:"text-sm opacity-80",children:"No movies found."}):d.jsx("div",{className:"grid grid-cols-3 sm:grid-cols-4 md:grid-cols-5 lg:grid-cols-6 gap-2 sm:gap-3",children:Ce.map(pe=>{const ne=_[pe.id]||null,be=pe.releaseDate?new Date(pe.releaseDate).getFullYear():void 0;return d.jsx("div",{className:"block transition-transform hover:scale-[1.02] hover:shadow-xl cursor-default",children:d.jsxs("div",{className:"relative rounded-lg overflow-hidden bg-xmas-card shadow-md h-full flex flex-col",children:[d.jsx("div",{className:"relative",children:pe.posterUrl?d.jsx("img",{src:pe.posterUrl,alt:pe.title,className:"w-full h-auto object-cover",style:{aspectRatio:"2/3"}}):d.jsx("div",{className:"w-full flex items-center justify-center bg-gray-800",style:{aspectRatio:"2/3"},children:d.jsx("i",{className:"fas fa-film text-2xl text-gray-500"})})}),d.jsxs("div",{className:"p-1 sm:p-2 flex-grow flex flex-col",children:[d.jsx("h2",{className:"text-xs sm:text-sm font-medium line-clamp-2",children:pe.title}),be&&d.jsx("p",{className:"text-xs text-gray-400 mt-1",children:be}),pe.posterUrl&&d.jsx("a",{href:pe.posterUrl,target:"_blank",rel:"noopener noreferrer",className:"link link-primary text-[10px] sm:text-xs mt-0.5 inline-block",children:"Open current poster"})]}),d.jsxs("div",{className:"px-1 sm:px-2 pb-2 space-y-1",children:[d.jsx("input",{type:"file",accept:"image/*",ref:Q=>{j.current[pe.id]=Q},className:"hidden",onChange:Q=>L(pe.id,Q.target.files&&Q.target.files[0]?Q.target.files[0]:null)}),d.jsx("button",{className:"btn btn-primary btn-xs w-full",type:"button",onClick:()=>ae(pe),disabled:A===pe.id||!Ne||!pe.tmdbId,children:A===pe.id?d.jsxs(d.Fragment,{children:[d.jsx("span",{className:"loading loading-spinner loading-xs mr-1"}),"TMDb..."]}):d.jsxs(d.Fragment,{children:[d.jsx("i",{className:"fas fa-photo-video mr-1"}),"TMDb posters"]})}),d.jsxs("button",{className:"btn btn-outline btn-xs w-full",type:"button",onClick:()=>P(pe.id),children:[d.jsx("i",{className:"fas fa-file-image mr-1"}),"Choose file"]}),d.jsx("button",{className:"btn btn-primary btn-xs w-full",type:"button",onClick:()=>U(pe),disabled:E===pe.id||!ne,children:E===pe.id?d.jsxs(d.Fragment,{children:[d.jsx("span",{className:"loading loading-spinner loading-xs mr-1"}),"Uploading..."]}):d.jsxs(d.Fragment,{children:[d.jsx("i",{className:"fas fa-upload mr-1"}),"Upload"]})})]})]})},pe.id)})}),F&&z.length>0&&d.jsx("dialog",{className:"modal modal-open",children:d.jsxs("div",{className:"modal-box max-w-5xl bg-xmas-card",children:[d.jsx("h3",{className:"font-bold text-lg mb-2",children:"Choose a TMDb poster"}),d.jsx("p",{className:"text-xs opacity-80 mb-4",children:"These posters come from The Movie Database for this movie's stored tmdbId."}),d.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-3 max-h-[60vh] overflow-y-auto",children:z.map(pe=>d.jsx("button",{type:"button",className:"border border-transparent hover:border-xmas-gold rounded-lg overflow-hidden bg-gray-900 focus:outline-none focus:ring-2 focus:ring-xmas-gold",onClick:()=>ue(pe),children:d.jsx("img",{src:pe.url,alt:"TMDb poster option",className:"w-full h-auto object-cover",style:{aspectRatio:"2/3"}})},pe.url))}),d.jsx("div",{className:"modal-action",children:d.jsx("button",{type:"button",className:"btn btn-sm",onClick:()=>{R(null),re([])},children:"Close"})})]})})]})},KH=()=>{const t=Ma(),{isAdmin:e,loading:r}=Qc(),{userProfile:n}=An(),[a,l]=q.useState(""),[o,u]=q.useState(""),[h,m]=q.useState("single"),[p,v]=q.useState(null),[_,w]=q.useState(!1),[E,T]=q.useState(null),[A,M]=q.useState(""),[F,R]=q.useState([]),[z,re]=q.useState(!1),[te,b]=q.useState(!1),[N,k]=q.useState(null);q.useEffect(()=>{!r&&!e&&t("/admin/login")},[e,r,t]),q.useEffect(()=>{n?.omdbApiKey&&l(n.omdbApiKey),n?.tmdbApiKey&&u(n.tmdbApiKey)},[n]);const j=async Ce=>{if(!a){T({type:"error",text:"OMDb API key required to fetch details."});return}try{w(!0),T(null);const Ne=await Mc(Ce.imdbID,a);v(Ne),M(""),k(null),R([]),b(!1)}catch(Ne){T({type:"error",text:Ne?.message??"Failed to fetch OMDb details."})}finally{w(!1)}},L=async()=>{if(!p)return;if(!o){T({type:"error",text:"TMDb API key required to fetch posters. Set it on your Profile page."});return}const Ce=parseInt(A.trim(),10);if(!Number.isFinite(Ce)){T({type:"error",text:"Enter a valid numeric TMDb ID before loading posters."});return}try{re(!0),T(null);const Ne=await Tm(Ce,o);if(!Ne.length){T({type:"error",text:"No posters returned from TMDb for this id."});return}R(Ne),b(!0)}catch(Ne){T({type:"error",text:Ne?.message??"Failed to fetch TMDb posters."})}finally{re(!1)}},P=Ce=>{k(Ce.url),b(!1)},U=async()=>{if(p)try{w(!0),T(null);const Ce=ur(rt,"movies"),Ne=p.imdbID,ae=await Er(gs(Ce,Da("imdbId","==",Ne))),ue={...U1(p),updatedAt:new Date},pe=A.trim()?parseInt(A.trim(),10):NaN;if(Number.isFinite(pe)&&(ue.tmdbId=pe),N&&(ue.posterUrl=N),ae.empty)await vm(Ce,{...ue,addedAt:new Date}),T({type:"success",text:"Catalogue movie created."});else{const ne=ae.docs[0].id;await Ia(Pt(rt,"movies",ne),ue,{merge:!0}),T({type:"success",text:"Catalogue movie updated."})}}catch(Ce){T({type:"error",text:Ce?.message??"Failed to save movie to catalogue."})}finally{w(!1)}};return r?d.jsx("div",{className:"flex justify-center items-center min-h-[60vh]",children:d.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-xmas-gold"})}):d.jsxs("div",{className:"container mx-auto px-4 py-8",children:[d.jsxs("div",{className:"flex justify-between items-center mb-6",children:[d.jsxs("div",{children:[d.jsx("h1",{className:"font-christmas text-3xl md:text-4xl text-xmas-line",children:"Admin Import & Posters"}),d.jsx("p",{className:"text-sm text-xmas-mute mt-1",children:"Import or update catalogue movies via OMDb or Excel, and attach TMDb ids and posters in one place."})]}),d.jsxs("div",{className:"flex gap-2",children:[d.jsxs(gt,{to:"/admin",className:"btn btn-outline btn-sm md:btn-md",children:[d.jsx("i",{className:"fas fa-arrow-left mr-2"}),"Admin Dashboard"]}),d.jsxs(gt,{to:"/admin/posters",className:"btn btn-outline btn-sm md:btn-md",children:[d.jsx("i",{className:"fas fa-image mr-2"}),"Poster Manager"]})]})]}),E&&d.jsxs("div",{className:`alert ${E.type==="error"?"alert-error":"alert-success"} mb-4`,children:[d.jsx("i",{className:`fas ${E.type==="error"?"fa-exclamation-circle":"fa-check-circle"} mr-2`}),d.jsx("span",{children:E.text})]}),d.jsxs("div",{className:"tabs tabs-boxed mb-6",children:[d.jsxs("button",{className:`tab ${h==="single"?"tab-active":""}`,onClick:()=>m("single"),children:[d.jsx("i",{className:"fas fa-search mr-2"}),"Single OMDb Import"]}),d.jsxs("button",{className:`tab ${h==="excel"?"tab-active":""}`,onClick:()=>m("excel"),children:[d.jsx("i",{className:"fas fa-file-excel mr-2"}),"Excel Catalogue Import"]})]}),h==="single"&&d.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6 items-start",children:[d.jsxs("div",{className:"bg-xmas-card p-6 rounded-lg shadow-lg",children:[!a&&d.jsxs("div",{className:"alert alert-warning mb-4",children:[d.jsx("i",{className:"fas fa-exclamation-triangle mr-2"}),d.jsx("span",{children:"Set your OMDb API key in Profile to search OMDb."})]}),d.jsx("h2",{className:"font-christmas text-2xl mb-4 text-xmas-gold",children:"Search OMDb"}),d.jsx(r4,{omdbApiKey:a,onSelect:j})]}),d.jsxs("div",{className:"bg-xmas-card p-6 rounded-lg shadow-lg",children:[d.jsx("h2",{className:"font-christmas text-2xl mb-4 text-xmas-gold",children:"Selected Movie"}),p?d.jsxs("div",{className:"space-y-4",children:[d.jsxs("div",{className:"flex gap-4",children:[d.jsx("div",{className:"w-24 shrink-0",children:N||p.Poster?d.jsx("img",{src:N||p.Poster,alt:p.Title,className:"w-full rounded-lg"}):d.jsx("div",{className:"w-full h-36 bg-base-200 flex items-center justify-center rounded-lg",children:d.jsx("i",{className:"fas fa-film text-2xl opacity-50"})})}),d.jsxs("div",{className:"flex-1",children:[d.jsx("h3",{className:"text-xl font-bold mb-1",children:p.Title}),d.jsx("p",{className:"text-sm opacity-80 mb-1",children:p.Year}),p.Plot&&d.jsx("p",{className:"text-sm opacity-80 line-clamp-4",children:p.Plot})]})]}),d.jsxs("div",{className:"form-control",children:[d.jsx("label",{className:"label",children:d.jsx("span",{className:"label-text",children:"TMDb ID (manual)"})}),d.jsx("input",{type:"text",className:"input input-bordered w-full",value:A,onChange:Ce=>M(Ce.target.value),placeholder:"e.g. 603692"}),d.jsx("label",{className:"label",children:d.jsx("span",{className:"label-text-alt",children:"This id is stored on the catalogue movie and used by the poster tools."})})]}),d.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 items-start sm:items-center",children:[d.jsx("button",{type:"button",className:"btn btn-outline btn-sm sm:btn-md",onClick:L,disabled:z,children:z?d.jsxs(d.Fragment,{children:[d.jsx("span",{className:"loading loading-spinner loading-xs mr-2"}),"Loading TMDb posters"]}):d.jsxs(d.Fragment,{children:[d.jsx("i",{className:"fas fa-photo-video mr-2"}),"Load TMDb posters"]})}),N&&d.jsxs("span",{className:"text-xs opacity-80 truncate max-w-xs",children:["Using poster: ",N]})]}),d.jsx("div",{className:"pt-2",children:d.jsxs("button",{type:"button",className:"btn btn-primary w-full sm:w-auto",onClick:U,disabled:_,children:[_?d.jsx("span",{className:"loading loading-spinner loading-sm mr-2"}):d.jsx("i",{className:"fas fa-save mr-2"}),"Save to Catalogue"]})})]}):d.jsx("p",{className:"text-sm opacity-80",children:"Search OMDb on the left and choose a result to review details, attach a TMDb id, and pick a poster."})]})]}),h==="excel"&&d.jsxs("div",{className:"bg-xmas-card p-6 rounded-lg shadow-lg",children:[!a&&d.jsxs("div",{className:"alert alert-warning mb-4",children:[d.jsx("i",{className:"fas fa-exclamation-triangle mr-2"}),d.jsx("span",{children:"OMDb key required for matching."})]}),a&&d.jsx(t4,{omdbApiKey:a,tmdbApiKey:o,onDone:()=>{T({type:"success",text:"Excel catalogue import completed."})}})]}),te&&F.length>0&&d.jsx("dialog",{className:"modal modal-open",children:d.jsxs("div",{className:"modal-box max-w-5xl bg-xmas-card",children:[d.jsx("h3",{className:"font-bold text-lg mb-2",children:"Choose a TMDb poster"}),d.jsx("p",{className:"text-xs opacity-80 mb-4",children:"These posters come from The Movie Database for the TMDb id you entered."}),d.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-3 max-h-[60vh] overflow-y-auto",children:F.map(Ce=>d.jsx("button",{type:"button",className:"border border-transparent hover:border-xmas-gold rounded-lg overflow-hidden bg-gray-900 focus:outline-none focus:ring-2 focus:ring-xmas-gold",onClick:()=>P(Ce),children:d.jsx("img",{src:Ce.url,alt:"TMDb poster option",className:"w-full h-auto object-cover",style:{aspectRatio:"2/3"}})},Ce.url))}),d.jsx("div",{className:"modal-action",children:d.jsx("button",{type:"button",className:"btn btn-sm",onClick:()=>{b(!1)},children:"Close"})})]})})]})},YH=hD([{element:d.jsx(GP,{}),children:[{path:"/",element:d.jsx(KP,{})},{path:"/login",element:d.jsx(YP,{})},{path:"/u/:slug",element:d.jsx(k8,{})},{path:"/u/:slug/m/:movieSlug",element:d.jsx(P8,{})},{element:d.jsx(Wd,{}),children:[{path:"/movies",element:d.jsx(a8,{})},{path:"/movies/:movieId",element:d.jsx(p8,{})},{path:"/movies/:movieId/edit-poster",element:d.jsx(B8,{})},{path:"/import",element:d.jsx(y8,{})},{path:"/random",element:d.jsx(_8,{})},{path:"/profile",element:d.jsx(A8,{})},{path:"/achievements",element:d.jsx(C8,{})}]},{path:"/admin/login",element:d.jsx(V8,{})},{path:"/admin",element:d.jsx(Wd,{children:d.jsx(qH,{})})},{path:"/admin/import",element:d.jsx(Wd,{children:d.jsx(KH,{})})},{path:"/admin/posters",element:d.jsx(Wd,{children:d.jsx(WH,{})})}]}]);Bk.createRoot(document.getElementById("root")).render(d.jsx(Kf.StrictMode,{children:d.jsx(VP,{children:d.jsx(qP,{children:d.jsx(_D,{router:YH})})})}));
