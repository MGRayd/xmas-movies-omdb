function kE(e,t){for(var r=0;r<t.length;r++){const n=t[r];if(typeof n!="string"&&!Array.isArray(n)){for(const s in n)if(s!=="default"&&!(s in e)){const a=Object.getOwnPropertyDescriptor(n,s);a&&Object.defineProperty(e,s,a.get?a:{enumerable:!0,get:()=>n[s]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))n(s);new MutationObserver(s=>{for(const a of s)if(a.type==="childList")for(const i of a.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&n(i)}).observe(document,{childList:!0,subtree:!0});function r(s){const a={};return s.integrity&&(a.integrity=s.integrity),s.referrerPolicy&&(a.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?a.credentials="include":s.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function n(s){if(s.ep)return;s.ep=!0;const a=r(s);fetch(s.href,a)}})();function SE(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var AE={exports:{}},bd={},bE={exports:{}},Qe={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Nu=Symbol.for("react.element"),WI=Symbol.for("react.portal"),zI=Symbol.for("react.fragment"),HI=Symbol.for("react.strict_mode"),GI=Symbol.for("react.profiler"),KI=Symbol.for("react.provider"),qI=Symbol.for("react.context"),XI=Symbol.for("react.forward_ref"),YI=Symbol.for("react.suspense"),QI=Symbol.for("react.memo"),JI=Symbol.for("react.lazy"),y1=Symbol.iterator;function ZI(e){return e===null||typeof e!="object"?null:(e=y1&&e[y1]||e["@@iterator"],typeof e=="function"?e:null)}var IE={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},NE=Object.assign,CE={};function bl(e,t,r){this.props=e,this.context=t,this.refs=CE,this.updater=r||IE}bl.prototype.isReactComponent={};bl.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};bl.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function RE(){}RE.prototype=bl.prototype;function ug(e,t,r){this.props=e,this.context=t,this.refs=CE,this.updater=r||IE}var fg=ug.prototype=new RE;fg.constructor=ug;NE(fg,bl.prototype);fg.isPureReactComponent=!0;var _1=Array.isArray,PE=Object.prototype.hasOwnProperty,hg={current:null},DE={key:!0,ref:!0,__self:!0,__source:!0};function FE(e,t,r){var n,s={},a=null,i=null;if(t!=null)for(n in t.ref!==void 0&&(i=t.ref),t.key!==void 0&&(a=""+t.key),t)PE.call(t,n)&&!DE.hasOwnProperty(n)&&(s[n]=t[n]);var o=arguments.length-2;if(o===1)s.children=r;else if(1<o){for(var l=Array(o),u=0;u<o;u++)l[u]=arguments[u+2];s.children=l}if(e&&e.defaultProps)for(n in o=e.defaultProps,o)s[n]===void 0&&(s[n]=o[n]);return{$$typeof:Nu,type:e,key:a,ref:i,props:s,_owner:hg.current}}function eN(e,t){return{$$typeof:Nu,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function dg(e){return typeof e=="object"&&e!==null&&e.$$typeof===Nu}function tN(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(r){return t[r]})}var w1=/\/+/g;function b0(e,t){return typeof e=="object"&&e!==null&&e.key!=null?tN(""+e.key):t.toString(36)}function Zf(e,t,r,n,s){var a=typeof e;(a==="undefined"||a==="boolean")&&(e=null);var i=!1;if(e===null)i=!0;else switch(a){case"string":case"number":i=!0;break;case"object":switch(e.$$typeof){case Nu:case WI:i=!0}}if(i)return i=e,s=s(i),e=n===""?"."+b0(i,0):n,_1(s)?(r="",e!=null&&(r=e.replace(w1,"$&/")+"/"),Zf(s,t,r,"",function(u){return u})):s!=null&&(dg(s)&&(s=eN(s,r+(!s.key||i&&i.key===s.key?"":(""+s.key).replace(w1,"$&/")+"/")+e)),t.push(s)),1;if(i=0,n=n===""?".":n+":",_1(e))for(var o=0;o<e.length;o++){a=e[o];var l=n+b0(a,o);i+=Zf(a,t,r,l,s)}else if(l=ZI(e),typeof l=="function")for(e=l.call(e),o=0;!(a=e.next()).done;)a=a.value,l=n+b0(a,o++),i+=Zf(a,t,r,l,s);else if(a==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return i}function yf(e,t,r){if(e==null)return e;var n=[],s=0;return Zf(e,n,"","",function(a){return t.call(r,a,s++)}),n}function rN(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(r){(e._status===0||e._status===-1)&&(e._status=1,e._result=r)},function(r){(e._status===0||e._status===-1)&&(e._status=2,e._result=r)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var an={current:null},eh={transition:null},nN={ReactCurrentDispatcher:an,ReactCurrentBatchConfig:eh,ReactCurrentOwner:hg};function OE(){throw Error("act(...) is not supported in production builds of React.")}Qe.Children={map:yf,forEach:function(e,t,r){yf(e,function(){t.apply(this,arguments)},r)},count:function(e){var t=0;return yf(e,function(){t++}),t},toArray:function(e){return yf(e,function(t){return t})||[]},only:function(e){if(!dg(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};Qe.Component=bl;Qe.Fragment=zI;Qe.Profiler=GI;Qe.PureComponent=ug;Qe.StrictMode=HI;Qe.Suspense=YI;Qe.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=nN;Qe.act=OE;Qe.cloneElement=function(e,t,r){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var n=NE({},e.props),s=e.key,a=e.ref,i=e._owner;if(t!=null){if(t.ref!==void 0&&(a=t.ref,i=hg.current),t.key!==void 0&&(s=""+t.key),e.type&&e.type.defaultProps)var o=e.type.defaultProps;for(l in t)PE.call(t,l)&&!DE.hasOwnProperty(l)&&(n[l]=t[l]===void 0&&o!==void 0?o[l]:t[l])}var l=arguments.length-2;if(l===1)n.children=r;else if(1<l){o=Array(l);for(var u=0;u<l;u++)o[u]=arguments[u+2];n.children=o}return{$$typeof:Nu,type:e.type,key:s,ref:a,props:n,_owner:i}};Qe.createContext=function(e){return e={$$typeof:qI,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:KI,_context:e},e.Consumer=e};Qe.createElement=FE;Qe.createFactory=function(e){var t=FE.bind(null,e);return t.type=e,t};Qe.createRef=function(){return{current:null}};Qe.forwardRef=function(e){return{$$typeof:XI,render:e}};Qe.isValidElement=dg;Qe.lazy=function(e){return{$$typeof:JI,_payload:{_status:-1,_result:e},_init:rN}};Qe.memo=function(e,t){return{$$typeof:QI,type:e,compare:t===void 0?null:t}};Qe.startTransition=function(e){var t=eh.transition;eh.transition={};try{e()}finally{eh.transition=t}};Qe.unstable_act=OE;Qe.useCallback=function(e,t){return an.current.useCallback(e,t)};Qe.useContext=function(e){return an.current.useContext(e)};Qe.useDebugValue=function(){};Qe.useDeferredValue=function(e){return an.current.useDeferredValue(e)};Qe.useEffect=function(e,t){return an.current.useEffect(e,t)};Qe.useId=function(){return an.current.useId()};Qe.useImperativeHandle=function(e,t,r){return an.current.useImperativeHandle(e,t,r)};Qe.useInsertionEffect=function(e,t){return an.current.useInsertionEffect(e,t)};Qe.useLayoutEffect=function(e,t){return an.current.useLayoutEffect(e,t)};Qe.useMemo=function(e,t){return an.current.useMemo(e,t)};Qe.useReducer=function(e,t,r){return an.current.useReducer(e,t,r)};Qe.useRef=function(e){return an.current.useRef(e)};Qe.useState=function(e){return an.current.useState(e)};Qe.useSyncExternalStore=function(e,t,r){return an.current.useSyncExternalStore(e,t,r)};Qe.useTransition=function(){return an.current.useTransition()};Qe.version="18.3.1";bE.exports=Qe;var U=bE.exports;const Cu=SE(U),sN=kE({__proto__:null,default:Cu},[U]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var aN=U,iN=Symbol.for("react.element"),oN=Symbol.for("react.fragment"),lN=Object.prototype.hasOwnProperty,cN=aN.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,uN={key:!0,ref:!0,__self:!0,__source:!0};function ME(e,t,r){var n,s={},a=null,i=null;r!==void 0&&(a=""+r),t.key!==void 0&&(a=""+t.key),t.ref!==void 0&&(i=t.ref);for(n in t)lN.call(t,n)&&!uN.hasOwnProperty(n)&&(s[n]=t[n]);if(e&&e.defaultProps)for(n in t=e.defaultProps,t)s[n]===void 0&&(s[n]=t[n]);return{$$typeof:iN,type:e,key:a,ref:i,props:s,_owner:cN.current}}bd.Fragment=oN;bd.jsx=ME;bd.jsxs=ME;AE.exports=bd;var c=AE.exports,bm={},jE={exports:{}},jn={},LE={exports:{}},UE={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(X,H){var Z=X.length;X.push(H);e:for(;0<Z;){var Y=Z-1>>>1,M=X[Y];if(0<s(M,H))X[Y]=H,X[Z]=M,Z=Y;else break e}}function r(X){return X.length===0?null:X[0]}function n(X){if(X.length===0)return null;var H=X[0],Z=X.pop();if(Z!==H){X[0]=Z;e:for(var Y=0,M=X.length,q=M>>>1;Y<q;){var K=2*(Y+1)-1,L=X[K],J=K+1,fe=X[J];if(0>s(L,Z))J<M&&0>s(fe,L)?(X[Y]=fe,X[J]=Z,Y=J):(X[Y]=L,X[K]=Z,Y=K);else if(J<M&&0>s(fe,Z))X[Y]=fe,X[J]=Z,Y=J;else break e}}return H}function s(X,H){var Z=X.sortIndex-H.sortIndex;return Z!==0?Z:X.id-H.id}if(typeof performance=="object"&&typeof performance.now=="function"){var a=performance;e.unstable_now=function(){return a.now()}}else{var i=Date,o=i.now();e.unstable_now=function(){return i.now()-o}}var l=[],u=[],f=1,d=null,m=3,p=!1,x=!1,g=!1,_=typeof setTimeout=="function"?setTimeout:null,k=typeof clearTimeout=="function"?clearTimeout:null,E=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function y(X){for(var H=r(u);H!==null;){if(H.callback===null)n(u);else if(H.startTime<=X)n(u),H.sortIndex=H.expirationTime,t(l,H);else break;H=r(u)}}function b(X){if(g=!1,y(X),!x)if(r(l)!==null)x=!0,de(O);else{var H=r(u);H!==null&&ae(b,H.startTime-X)}}function O(X,H){x=!1,g&&(g=!1,k(T),T=-1),p=!0;var Z=m;try{for(y(H),d=r(l);d!==null&&(!(d.expirationTime>H)||X&&!C());){var Y=d.callback;if(typeof Y=="function"){d.callback=null,m=d.priorityLevel;var M=Y(d.expirationTime<=H);H=e.unstable_now(),typeof M=="function"?d.callback=M:d===r(l)&&n(l),y(H)}else n(l);d=r(l)}if(d!==null)var q=!0;else{var K=r(u);K!==null&&ae(b,K.startTime-H),q=!1}return q}finally{d=null,m=Z,p=!1}}var D=!1,v=null,T=-1,S=5,N=-1;function C(){return!(e.unstable_now()-N<S)}function R(){if(v!==null){var X=e.unstable_now();N=X;var H=!0;try{H=v(!0,X)}finally{H?F():(D=!1,v=null)}}else D=!1}var F;if(typeof E=="function")F=function(){E(R)};else if(typeof MessageChannel<"u"){var oe=new MessageChannel,te=oe.port2;oe.port1.onmessage=R,F=function(){te.postMessage(null)}}else F=function(){_(R,0)};function de(X){v=X,D||(D=!0,F())}function ae(X,H){T=_(function(){X(e.unstable_now())},H)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(X){X.callback=null},e.unstable_continueExecution=function(){x||p||(x=!0,de(O))},e.unstable_forceFrameRate=function(X){0>X||125<X?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):S=0<X?Math.floor(1e3/X):5},e.unstable_getCurrentPriorityLevel=function(){return m},e.unstable_getFirstCallbackNode=function(){return r(l)},e.unstable_next=function(X){switch(m){case 1:case 2:case 3:var H=3;break;default:H=m}var Z=m;m=H;try{return X()}finally{m=Z}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(X,H){switch(X){case 1:case 2:case 3:case 4:case 5:break;default:X=3}var Z=m;m=X;try{return H()}finally{m=Z}},e.unstable_scheduleCallback=function(X,H,Z){var Y=e.unstable_now();switch(typeof Z=="object"&&Z!==null?(Z=Z.delay,Z=typeof Z=="number"&&0<Z?Y+Z:Y):Z=Y,X){case 1:var M=-1;break;case 2:M=250;break;case 5:M=1073741823;break;case 4:M=1e4;break;default:M=5e3}return M=Z+M,X={id:f++,callback:H,priorityLevel:X,startTime:Z,expirationTime:M,sortIndex:-1},Z>Y?(X.sortIndex=Z,t(u,X),r(l)===null&&X===r(u)&&(g?(k(T),T=-1):g=!0,ae(b,Z-Y))):(X.sortIndex=M,t(l,X),x||p||(x=!0,de(O))),X},e.unstable_shouldYield=C,e.unstable_wrapCallback=function(X){var H=m;return function(){var Z=m;m=H;try{return X.apply(this,arguments)}finally{m=Z}}}})(UE);LE.exports=UE;var fN=LE.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var hN=U,On=fN;function Ee(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,r=1;r<arguments.length;r++)t+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var VE=new Set,Hc={};function lo(e,t){ll(e,t),ll(e+"Capture",t)}function ll(e,t){for(Hc[e]=t,e=0;e<t.length;e++)VE.add(t[e])}var ma=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Im=Object.prototype.hasOwnProperty,dN=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,E1={},T1={};function mN(e){return Im.call(T1,e)?!0:Im.call(E1,e)?!1:dN.test(e)?T1[e]=!0:(E1[e]=!0,!1)}function pN(e,t,r,n){if(r!==null&&r.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return n?!1:r!==null?!r.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function gN(e,t,r,n){if(t===null||typeof t>"u"||pN(e,t,r,n))return!0;if(n)return!1;if(r!==null)switch(r.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function on(e,t,r,n,s,a,i){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=n,this.attributeNamespace=s,this.mustUseProperty=r,this.propertyName=e,this.type=t,this.sanitizeURL=a,this.removeEmptyString=i}var Cr={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){Cr[e]=new on(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];Cr[t]=new on(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){Cr[e]=new on(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){Cr[e]=new on(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){Cr[e]=new on(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){Cr[e]=new on(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){Cr[e]=new on(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){Cr[e]=new on(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){Cr[e]=new on(e,5,!1,e.toLowerCase(),null,!1,!1)});var mg=/[\-:]([a-z])/g;function pg(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(mg,pg);Cr[t]=new on(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(mg,pg);Cr[t]=new on(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(mg,pg);Cr[t]=new on(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){Cr[e]=new on(e,1,!1,e.toLowerCase(),null,!1,!1)});Cr.xlinkHref=new on("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){Cr[e]=new on(e,1,!1,e.toLowerCase(),null,!0,!0)});function gg(e,t,r,n){var s=Cr.hasOwnProperty(t)?Cr[t]:null;(s!==null?s.type!==0:n||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(gN(t,r,s,n)&&(r=null),n||s===null?mN(t)&&(r===null?e.removeAttribute(t):e.setAttribute(t,""+r)):s.mustUseProperty?e[s.propertyName]=r===null?s.type===3?!1:"":r:(t=s.attributeName,n=s.attributeNamespace,r===null?e.removeAttribute(t):(s=s.type,r=s===3||s===4&&r===!0?"":""+r,n?e.setAttributeNS(n,t,r):e.setAttribute(t,r))))}var Aa=hN.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,_f=Symbol.for("react.element"),Fo=Symbol.for("react.portal"),Oo=Symbol.for("react.fragment"),xg=Symbol.for("react.strict_mode"),Nm=Symbol.for("react.profiler"),BE=Symbol.for("react.provider"),$E=Symbol.for("react.context"),vg=Symbol.for("react.forward_ref"),Cm=Symbol.for("react.suspense"),Rm=Symbol.for("react.suspense_list"),yg=Symbol.for("react.memo"),ja=Symbol.for("react.lazy"),WE=Symbol.for("react.offscreen"),k1=Symbol.iterator;function ql(e){return e===null||typeof e!="object"?null:(e=k1&&e[k1]||e["@@iterator"],typeof e=="function"?e:null)}var Vt=Object.assign,I0;function oc(e){if(I0===void 0)try{throw Error()}catch(r){var t=r.stack.trim().match(/\n( *(at )?)/);I0=t&&t[1]||""}return`
`+I0+e}var N0=!1;function C0(e,t){if(!e||N0)return"";N0=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(u){var n=u}Reflect.construct(e,[],t)}else{try{t.call()}catch(u){n=u}e.call(t.prototype)}else{try{throw Error()}catch(u){n=u}e()}}catch(u){if(u&&n&&typeof u.stack=="string"){for(var s=u.stack.split(`
`),a=n.stack.split(`
`),i=s.length-1,o=a.length-1;1<=i&&0<=o&&s[i]!==a[o];)o--;for(;1<=i&&0<=o;i--,o--)if(s[i]!==a[o]){if(i!==1||o!==1)do if(i--,o--,0>o||s[i]!==a[o]){var l=`
`+s[i].replace(" at new "," at ");return e.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",e.displayName)),l}while(1<=i&&0<=o);break}}}finally{N0=!1,Error.prepareStackTrace=r}return(e=e?e.displayName||e.name:"")?oc(e):""}function xN(e){switch(e.tag){case 5:return oc(e.type);case 16:return oc("Lazy");case 13:return oc("Suspense");case 19:return oc("SuspenseList");case 0:case 2:case 15:return e=C0(e.type,!1),e;case 11:return e=C0(e.type.render,!1),e;case 1:return e=C0(e.type,!0),e;default:return""}}function Pm(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case Oo:return"Fragment";case Fo:return"Portal";case Nm:return"Profiler";case xg:return"StrictMode";case Cm:return"Suspense";case Rm:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case $E:return(e.displayName||"Context")+".Consumer";case BE:return(e._context.displayName||"Context")+".Provider";case vg:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case yg:return t=e.displayName||null,t!==null?t:Pm(e.type)||"Memo";case ja:t=e._payload,e=e._init;try{return Pm(e(t))}catch{}}return null}function vN(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Pm(t);case 8:return t===xg?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function fi(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function zE(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function yN(e){var t=zE(e)?"checked":"value",r=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),n=""+e[t];if(!e.hasOwnProperty(t)&&typeof r<"u"&&typeof r.get=="function"&&typeof r.set=="function"){var s=r.get,a=r.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return s.call(this)},set:function(i){n=""+i,a.call(this,i)}}),Object.defineProperty(e,t,{enumerable:r.enumerable}),{getValue:function(){return n},setValue:function(i){n=""+i},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function wf(e){e._valueTracker||(e._valueTracker=yN(e))}function HE(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var r=t.getValue(),n="";return e&&(n=zE(e)?e.checked?"true":"false":e.value),e=n,e!==r?(t.setValue(e),!0):!1}function Eh(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function Dm(e,t){var r=t.checked;return Vt({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:r??e._wrapperState.initialChecked})}function S1(e,t){var r=t.defaultValue==null?"":t.defaultValue,n=t.checked!=null?t.checked:t.defaultChecked;r=fi(t.value!=null?t.value:r),e._wrapperState={initialChecked:n,initialValue:r,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function GE(e,t){t=t.checked,t!=null&&gg(e,"checked",t,!1)}function Fm(e,t){GE(e,t);var r=fi(t.value),n=t.type;if(r!=null)n==="number"?(r===0&&e.value===""||e.value!=r)&&(e.value=""+r):e.value!==""+r&&(e.value=""+r);else if(n==="submit"||n==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?Om(e,t.type,r):t.hasOwnProperty("defaultValue")&&Om(e,t.type,fi(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function A1(e,t,r){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var n=t.type;if(!(n!=="submit"&&n!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,r||t===e.value||(e.value=t),e.defaultValue=t}r=e.name,r!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,r!==""&&(e.name=r)}function Om(e,t,r){(t!=="number"||Eh(e.ownerDocument)!==e)&&(r==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+r&&(e.defaultValue=""+r))}var lc=Array.isArray;function Ko(e,t,r,n){if(e=e.options,t){t={};for(var s=0;s<r.length;s++)t["$"+r[s]]=!0;for(r=0;r<e.length;r++)s=t.hasOwnProperty("$"+e[r].value),e[r].selected!==s&&(e[r].selected=s),s&&n&&(e[r].defaultSelected=!0)}else{for(r=""+fi(r),t=null,s=0;s<e.length;s++){if(e[s].value===r){e[s].selected=!0,n&&(e[s].defaultSelected=!0);return}t!==null||e[s].disabled||(t=e[s])}t!==null&&(t.selected=!0)}}function Mm(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(Ee(91));return Vt({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function b1(e,t){var r=t.value;if(r==null){if(r=t.children,t=t.defaultValue,r!=null){if(t!=null)throw Error(Ee(92));if(lc(r)){if(1<r.length)throw Error(Ee(93));r=r[0]}t=r}t==null&&(t=""),r=t}e._wrapperState={initialValue:fi(r)}}function KE(e,t){var r=fi(t.value),n=fi(t.defaultValue);r!=null&&(r=""+r,r!==e.value&&(e.value=r),t.defaultValue==null&&e.defaultValue!==r&&(e.defaultValue=r)),n!=null&&(e.defaultValue=""+n)}function I1(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function qE(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function jm(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?qE(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var Ef,XE=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,r,n,s){MSApp.execUnsafeLocalFunction(function(){return e(t,r,n,s)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(Ef=Ef||document.createElement("div"),Ef.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=Ef.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function Gc(e,t){if(t){var r=e.firstChild;if(r&&r===e.lastChild&&r.nodeType===3){r.nodeValue=t;return}}e.textContent=t}var _c={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},_N=["Webkit","ms","Moz","O"];Object.keys(_c).forEach(function(e){_N.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),_c[t]=_c[e]})});function YE(e,t,r){return t==null||typeof t=="boolean"||t===""?"":r||typeof t!="number"||t===0||_c.hasOwnProperty(e)&&_c[e]?(""+t).trim():t+"px"}function QE(e,t){e=e.style;for(var r in t)if(t.hasOwnProperty(r)){var n=r.indexOf("--")===0,s=YE(r,t[r],n);r==="float"&&(r="cssFloat"),n?e.setProperty(r,s):e[r]=s}}var wN=Vt({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Lm(e,t){if(t){if(wN[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(Ee(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(Ee(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(Ee(61))}if(t.style!=null&&typeof t.style!="object")throw Error(Ee(62))}}function Um(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Vm=null;function _g(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var Bm=null,qo=null,Xo=null;function N1(e){if(e=Du(e)){if(typeof Bm!="function")throw Error(Ee(280));var t=e.stateNode;t&&(t=Pd(t),Bm(e.stateNode,e.type,t))}}function JE(e){qo?Xo?Xo.push(e):Xo=[e]:qo=e}function ZE(){if(qo){var e=qo,t=Xo;if(Xo=qo=null,N1(e),t)for(e=0;e<t.length;e++)N1(t[e])}}function e2(e,t){return e(t)}function t2(){}var R0=!1;function r2(e,t,r){if(R0)return e(t,r);R0=!0;try{return e2(e,t,r)}finally{R0=!1,(qo!==null||Xo!==null)&&(t2(),ZE())}}function Kc(e,t){var r=e.stateNode;if(r===null)return null;var n=Pd(r);if(n===null)return null;r=n[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(e=e.type,n=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!n;break e;default:e=!1}if(e)return null;if(r&&typeof r!="function")throw Error(Ee(231,t,typeof r));return r}var $m=!1;if(ma)try{var Xl={};Object.defineProperty(Xl,"passive",{get:function(){$m=!0}}),window.addEventListener("test",Xl,Xl),window.removeEventListener("test",Xl,Xl)}catch{$m=!1}function EN(e,t,r,n,s,a,i,o,l){var u=Array.prototype.slice.call(arguments,3);try{t.apply(r,u)}catch(f){this.onError(f)}}var wc=!1,Th=null,kh=!1,Wm=null,TN={onError:function(e){wc=!0,Th=e}};function kN(e,t,r,n,s,a,i,o,l){wc=!1,Th=null,EN.apply(TN,arguments)}function SN(e,t,r,n,s,a,i,o,l){if(kN.apply(this,arguments),wc){if(wc){var u=Th;wc=!1,Th=null}else throw Error(Ee(198));kh||(kh=!0,Wm=u)}}function co(e){var t=e,r=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(r=t.return),e=t.return;while(e)}return t.tag===3?r:null}function n2(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function C1(e){if(co(e)!==e)throw Error(Ee(188))}function AN(e){var t=e.alternate;if(!t){if(t=co(e),t===null)throw Error(Ee(188));return t!==e?null:e}for(var r=e,n=t;;){var s=r.return;if(s===null)break;var a=s.alternate;if(a===null){if(n=s.return,n!==null){r=n;continue}break}if(s.child===a.child){for(a=s.child;a;){if(a===r)return C1(s),e;if(a===n)return C1(s),t;a=a.sibling}throw Error(Ee(188))}if(r.return!==n.return)r=s,n=a;else{for(var i=!1,o=s.child;o;){if(o===r){i=!0,r=s,n=a;break}if(o===n){i=!0,n=s,r=a;break}o=o.sibling}if(!i){for(o=a.child;o;){if(o===r){i=!0,r=a,n=s;break}if(o===n){i=!0,n=a,r=s;break}o=o.sibling}if(!i)throw Error(Ee(189))}}if(r.alternate!==n)throw Error(Ee(190))}if(r.tag!==3)throw Error(Ee(188));return r.stateNode.current===r?e:t}function s2(e){return e=AN(e),e!==null?a2(e):null}function a2(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=a2(e);if(t!==null)return t;e=e.sibling}return null}var i2=On.unstable_scheduleCallback,R1=On.unstable_cancelCallback,bN=On.unstable_shouldYield,IN=On.unstable_requestPaint,Yt=On.unstable_now,NN=On.unstable_getCurrentPriorityLevel,wg=On.unstable_ImmediatePriority,o2=On.unstable_UserBlockingPriority,Sh=On.unstable_NormalPriority,CN=On.unstable_LowPriority,l2=On.unstable_IdlePriority,Id=null,Os=null;function RN(e){if(Os&&typeof Os.onCommitFiberRoot=="function")try{Os.onCommitFiberRoot(Id,e,void 0,(e.current.flags&128)===128)}catch{}}var xs=Math.clz32?Math.clz32:FN,PN=Math.log,DN=Math.LN2;function FN(e){return e>>>=0,e===0?32:31-(PN(e)/DN|0)|0}var Tf=64,kf=4194304;function cc(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function Ah(e,t){var r=e.pendingLanes;if(r===0)return 0;var n=0,s=e.suspendedLanes,a=e.pingedLanes,i=r&268435455;if(i!==0){var o=i&~s;o!==0?n=cc(o):(a&=i,a!==0&&(n=cc(a)))}else i=r&~s,i!==0?n=cc(i):a!==0&&(n=cc(a));if(n===0)return 0;if(t!==0&&t!==n&&!(t&s)&&(s=n&-n,a=t&-t,s>=a||s===16&&(a&4194240)!==0))return t;if(n&4&&(n|=r&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=n;0<t;)r=31-xs(t),s=1<<r,n|=e[r],t&=~s;return n}function ON(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function MN(e,t){for(var r=e.suspendedLanes,n=e.pingedLanes,s=e.expirationTimes,a=e.pendingLanes;0<a;){var i=31-xs(a),o=1<<i,l=s[i];l===-1?(!(o&r)||o&n)&&(s[i]=ON(o,t)):l<=t&&(e.expiredLanes|=o),a&=~o}}function zm(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function c2(){var e=Tf;return Tf<<=1,!(Tf&4194240)&&(Tf=64),e}function P0(e){for(var t=[],r=0;31>r;r++)t.push(e);return t}function Ru(e,t,r){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-xs(t),e[t]=r}function jN(e,t){var r=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var n=e.eventTimes;for(e=e.expirationTimes;0<r;){var s=31-xs(r),a=1<<s;t[s]=0,n[s]=-1,e[s]=-1,r&=~a}}function Eg(e,t){var r=e.entangledLanes|=t;for(e=e.entanglements;r;){var n=31-xs(r),s=1<<n;s&t|e[n]&t&&(e[n]|=t),r&=~s}}var xt=0;function u2(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var f2,Tg,h2,d2,m2,Hm=!1,Sf=[],Ja=null,Za=null,ei=null,qc=new Map,Xc=new Map,Ua=[],LN="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function P1(e,t){switch(e){case"focusin":case"focusout":Ja=null;break;case"dragenter":case"dragleave":Za=null;break;case"mouseover":case"mouseout":ei=null;break;case"pointerover":case"pointerout":qc.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Xc.delete(t.pointerId)}}function Yl(e,t,r,n,s,a){return e===null||e.nativeEvent!==a?(e={blockedOn:t,domEventName:r,eventSystemFlags:n,nativeEvent:a,targetContainers:[s]},t!==null&&(t=Du(t),t!==null&&Tg(t)),e):(e.eventSystemFlags|=n,t=e.targetContainers,s!==null&&t.indexOf(s)===-1&&t.push(s),e)}function UN(e,t,r,n,s){switch(t){case"focusin":return Ja=Yl(Ja,e,t,r,n,s),!0;case"dragenter":return Za=Yl(Za,e,t,r,n,s),!0;case"mouseover":return ei=Yl(ei,e,t,r,n,s),!0;case"pointerover":var a=s.pointerId;return qc.set(a,Yl(qc.get(a)||null,e,t,r,n,s)),!0;case"gotpointercapture":return a=s.pointerId,Xc.set(a,Yl(Xc.get(a)||null,e,t,r,n,s)),!0}return!1}function p2(e){var t=Di(e.target);if(t!==null){var r=co(t);if(r!==null){if(t=r.tag,t===13){if(t=n2(r),t!==null){e.blockedOn=t,m2(e.priority,function(){h2(r)});return}}else if(t===3&&r.stateNode.current.memoizedState.isDehydrated){e.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}e.blockedOn=null}function th(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var r=Gm(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(r===null){r=e.nativeEvent;var n=new r.constructor(r.type,r);Vm=n,r.target.dispatchEvent(n),Vm=null}else return t=Du(r),t!==null&&Tg(t),e.blockedOn=r,!1;t.shift()}return!0}function D1(e,t,r){th(e)&&r.delete(t)}function VN(){Hm=!1,Ja!==null&&th(Ja)&&(Ja=null),Za!==null&&th(Za)&&(Za=null),ei!==null&&th(ei)&&(ei=null),qc.forEach(D1),Xc.forEach(D1)}function Ql(e,t){e.blockedOn===t&&(e.blockedOn=null,Hm||(Hm=!0,On.unstable_scheduleCallback(On.unstable_NormalPriority,VN)))}function Yc(e){function t(s){return Ql(s,e)}if(0<Sf.length){Ql(Sf[0],e);for(var r=1;r<Sf.length;r++){var n=Sf[r];n.blockedOn===e&&(n.blockedOn=null)}}for(Ja!==null&&Ql(Ja,e),Za!==null&&Ql(Za,e),ei!==null&&Ql(ei,e),qc.forEach(t),Xc.forEach(t),r=0;r<Ua.length;r++)n=Ua[r],n.blockedOn===e&&(n.blockedOn=null);for(;0<Ua.length&&(r=Ua[0],r.blockedOn===null);)p2(r),r.blockedOn===null&&Ua.shift()}var Yo=Aa.ReactCurrentBatchConfig,bh=!0;function BN(e,t,r,n){var s=xt,a=Yo.transition;Yo.transition=null;try{xt=1,kg(e,t,r,n)}finally{xt=s,Yo.transition=a}}function $N(e,t,r,n){var s=xt,a=Yo.transition;Yo.transition=null;try{xt=4,kg(e,t,r,n)}finally{xt=s,Yo.transition=a}}function kg(e,t,r,n){if(bh){var s=Gm(e,t,r,n);if(s===null)$0(e,t,n,Ih,r),P1(e,n);else if(UN(s,e,t,r,n))n.stopPropagation();else if(P1(e,n),t&4&&-1<LN.indexOf(e)){for(;s!==null;){var a=Du(s);if(a!==null&&f2(a),a=Gm(e,t,r,n),a===null&&$0(e,t,n,Ih,r),a===s)break;s=a}s!==null&&n.stopPropagation()}else $0(e,t,n,null,r)}}var Ih=null;function Gm(e,t,r,n){if(Ih=null,e=_g(n),e=Di(e),e!==null)if(t=co(e),t===null)e=null;else if(r=t.tag,r===13){if(e=n2(t),e!==null)return e;e=null}else if(r===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return Ih=e,null}function g2(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(NN()){case wg:return 1;case o2:return 4;case Sh:case CN:return 16;case l2:return 536870912;default:return 16}default:return 16}}var Ga=null,Sg=null,rh=null;function x2(){if(rh)return rh;var e,t=Sg,r=t.length,n,s="value"in Ga?Ga.value:Ga.textContent,a=s.length;for(e=0;e<r&&t[e]===s[e];e++);var i=r-e;for(n=1;n<=i&&t[r-n]===s[a-n];n++);return rh=s.slice(e,1<n?1-n:void 0)}function nh(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function Af(){return!0}function F1(){return!1}function Ln(e){function t(r,n,s,a,i){this._reactName=r,this._targetInst=s,this.type=n,this.nativeEvent=a,this.target=i,this.currentTarget=null;for(var o in e)e.hasOwnProperty(o)&&(r=e[o],this[o]=r?r(a):a[o]);return this.isDefaultPrevented=(a.defaultPrevented!=null?a.defaultPrevented:a.returnValue===!1)?Af:F1,this.isPropagationStopped=F1,this}return Vt(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=Af)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=Af)},persist:function(){},isPersistent:Af}),t}var Il={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Ag=Ln(Il),Pu=Vt({},Il,{view:0,detail:0}),WN=Ln(Pu),D0,F0,Jl,Nd=Vt({},Pu,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:bg,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==Jl&&(Jl&&e.type==="mousemove"?(D0=e.screenX-Jl.screenX,F0=e.screenY-Jl.screenY):F0=D0=0,Jl=e),D0)},movementY:function(e){return"movementY"in e?e.movementY:F0}}),O1=Ln(Nd),zN=Vt({},Nd,{dataTransfer:0}),HN=Ln(zN),GN=Vt({},Pu,{relatedTarget:0}),O0=Ln(GN),KN=Vt({},Il,{animationName:0,elapsedTime:0,pseudoElement:0}),qN=Ln(KN),XN=Vt({},Il,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),YN=Ln(XN),QN=Vt({},Il,{data:0}),M1=Ln(QN),JN={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},ZN={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},eC={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function tC(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=eC[e])?!!t[e]:!1}function bg(){return tC}var rC=Vt({},Pu,{key:function(e){if(e.key){var t=JN[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=nh(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?ZN[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:bg,charCode:function(e){return e.type==="keypress"?nh(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?nh(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),nC=Ln(rC),sC=Vt({},Nd,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),j1=Ln(sC),aC=Vt({},Pu,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:bg}),iC=Ln(aC),oC=Vt({},Il,{propertyName:0,elapsedTime:0,pseudoElement:0}),lC=Ln(oC),cC=Vt({},Nd,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),uC=Ln(cC),fC=[9,13,27,32],Ig=ma&&"CompositionEvent"in window,Ec=null;ma&&"documentMode"in document&&(Ec=document.documentMode);var hC=ma&&"TextEvent"in window&&!Ec,v2=ma&&(!Ig||Ec&&8<Ec&&11>=Ec),L1=" ",U1=!1;function y2(e,t){switch(e){case"keyup":return fC.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function _2(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var Mo=!1;function dC(e,t){switch(e){case"compositionend":return _2(t);case"keypress":return t.which!==32?null:(U1=!0,L1);case"textInput":return e=t.data,e===L1&&U1?null:e;default:return null}}function mC(e,t){if(Mo)return e==="compositionend"||!Ig&&y2(e,t)?(e=x2(),rh=Sg=Ga=null,Mo=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return v2&&t.locale!=="ko"?null:t.data;default:return null}}var pC={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function V1(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!pC[e.type]:t==="textarea"}function w2(e,t,r,n){JE(n),t=Nh(t,"onChange"),0<t.length&&(r=new Ag("onChange","change",null,r,n),e.push({event:r,listeners:t}))}var Tc=null,Qc=null;function gC(e){P2(e,0)}function Cd(e){var t=Uo(e);if(HE(t))return e}function xC(e,t){if(e==="change")return t}var E2=!1;if(ma){var M0;if(ma){var j0="oninput"in document;if(!j0){var B1=document.createElement("div");B1.setAttribute("oninput","return;"),j0=typeof B1.oninput=="function"}M0=j0}else M0=!1;E2=M0&&(!document.documentMode||9<document.documentMode)}function $1(){Tc&&(Tc.detachEvent("onpropertychange",T2),Qc=Tc=null)}function T2(e){if(e.propertyName==="value"&&Cd(Qc)){var t=[];w2(t,Qc,e,_g(e)),r2(gC,t)}}function vC(e,t,r){e==="focusin"?($1(),Tc=t,Qc=r,Tc.attachEvent("onpropertychange",T2)):e==="focusout"&&$1()}function yC(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return Cd(Qc)}function _C(e,t){if(e==="click")return Cd(t)}function wC(e,t){if(e==="input"||e==="change")return Cd(t)}function EC(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var ws=typeof Object.is=="function"?Object.is:EC;function Jc(e,t){if(ws(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var r=Object.keys(e),n=Object.keys(t);if(r.length!==n.length)return!1;for(n=0;n<r.length;n++){var s=r[n];if(!Im.call(t,s)||!ws(e[s],t[s]))return!1}return!0}function W1(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function z1(e,t){var r=W1(e);e=0;for(var n;r;){if(r.nodeType===3){if(n=e+r.textContent.length,e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=W1(r)}}function k2(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?k2(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function S2(){for(var e=window,t=Eh();t instanceof e.HTMLIFrameElement;){try{var r=typeof t.contentWindow.location.href=="string"}catch{r=!1}if(r)e=t.contentWindow;else break;t=Eh(e.document)}return t}function Ng(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function TC(e){var t=S2(),r=e.focusedElem,n=e.selectionRange;if(t!==r&&r&&r.ownerDocument&&k2(r.ownerDocument.documentElement,r)){if(n!==null&&Ng(r)){if(t=n.start,e=n.end,e===void 0&&(e=t),"selectionStart"in r)r.selectionStart=t,r.selectionEnd=Math.min(e,r.value.length);else if(e=(t=r.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var s=r.textContent.length,a=Math.min(n.start,s);n=n.end===void 0?a:Math.min(n.end,s),!e.extend&&a>n&&(s=n,n=a,a=s),s=z1(r,a);var i=z1(r,n);s&&i&&(e.rangeCount!==1||e.anchorNode!==s.node||e.anchorOffset!==s.offset||e.focusNode!==i.node||e.focusOffset!==i.offset)&&(t=t.createRange(),t.setStart(s.node,s.offset),e.removeAllRanges(),a>n?(e.addRange(t),e.extend(i.node,i.offset)):(t.setEnd(i.node,i.offset),e.addRange(t)))}}for(t=[],e=r;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof r.focus=="function"&&r.focus(),r=0;r<t.length;r++)e=t[r],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var kC=ma&&"documentMode"in document&&11>=document.documentMode,jo=null,Km=null,kc=null,qm=!1;function H1(e,t,r){var n=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;qm||jo==null||jo!==Eh(n)||(n=jo,"selectionStart"in n&&Ng(n)?n={start:n.selectionStart,end:n.selectionEnd}:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection(),n={anchorNode:n.anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset}),kc&&Jc(kc,n)||(kc=n,n=Nh(Km,"onSelect"),0<n.length&&(t=new Ag("onSelect","select",null,t,r),e.push({event:t,listeners:n}),t.target=jo)))}function bf(e,t){var r={};return r[e.toLowerCase()]=t.toLowerCase(),r["Webkit"+e]="webkit"+t,r["Moz"+e]="moz"+t,r}var Lo={animationend:bf("Animation","AnimationEnd"),animationiteration:bf("Animation","AnimationIteration"),animationstart:bf("Animation","AnimationStart"),transitionend:bf("Transition","TransitionEnd")},L0={},A2={};ma&&(A2=document.createElement("div").style,"AnimationEvent"in window||(delete Lo.animationend.animation,delete Lo.animationiteration.animation,delete Lo.animationstart.animation),"TransitionEvent"in window||delete Lo.transitionend.transition);function Rd(e){if(L0[e])return L0[e];if(!Lo[e])return e;var t=Lo[e],r;for(r in t)if(t.hasOwnProperty(r)&&r in A2)return L0[e]=t[r];return e}var b2=Rd("animationend"),I2=Rd("animationiteration"),N2=Rd("animationstart"),C2=Rd("transitionend"),R2=new Map,G1="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function yi(e,t){R2.set(e,t),lo(t,[e])}for(var U0=0;U0<G1.length;U0++){var V0=G1[U0],SC=V0.toLowerCase(),AC=V0[0].toUpperCase()+V0.slice(1);yi(SC,"on"+AC)}yi(b2,"onAnimationEnd");yi(I2,"onAnimationIteration");yi(N2,"onAnimationStart");yi("dblclick","onDoubleClick");yi("focusin","onFocus");yi("focusout","onBlur");yi(C2,"onTransitionEnd");ll("onMouseEnter",["mouseout","mouseover"]);ll("onMouseLeave",["mouseout","mouseover"]);ll("onPointerEnter",["pointerout","pointerover"]);ll("onPointerLeave",["pointerout","pointerover"]);lo("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));lo("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));lo("onBeforeInput",["compositionend","keypress","textInput","paste"]);lo("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));lo("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));lo("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var uc="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),bC=new Set("cancel close invalid load scroll toggle".split(" ").concat(uc));function K1(e,t,r){var n=e.type||"unknown-event";e.currentTarget=r,SN(n,t,void 0,e),e.currentTarget=null}function P2(e,t){t=(t&4)!==0;for(var r=0;r<e.length;r++){var n=e[r],s=n.event;n=n.listeners;e:{var a=void 0;if(t)for(var i=n.length-1;0<=i;i--){var o=n[i],l=o.instance,u=o.currentTarget;if(o=o.listener,l!==a&&s.isPropagationStopped())break e;K1(s,o,u),a=l}else for(i=0;i<n.length;i++){if(o=n[i],l=o.instance,u=o.currentTarget,o=o.listener,l!==a&&s.isPropagationStopped())break e;K1(s,o,u),a=l}}}if(kh)throw e=Wm,kh=!1,Wm=null,e}function Nt(e,t){var r=t[Zm];r===void 0&&(r=t[Zm]=new Set);var n=e+"__bubble";r.has(n)||(D2(t,e,2,!1),r.add(n))}function B0(e,t,r){var n=0;t&&(n|=4),D2(r,e,n,t)}var If="_reactListening"+Math.random().toString(36).slice(2);function Zc(e){if(!e[If]){e[If]=!0,VE.forEach(function(r){r!=="selectionchange"&&(bC.has(r)||B0(r,!1,e),B0(r,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[If]||(t[If]=!0,B0("selectionchange",!1,t))}}function D2(e,t,r,n){switch(g2(t)){case 1:var s=BN;break;case 4:s=$N;break;default:s=kg}r=s.bind(null,t,r,e),s=void 0,!$m||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(s=!0),n?s!==void 0?e.addEventListener(t,r,{capture:!0,passive:s}):e.addEventListener(t,r,!0):s!==void 0?e.addEventListener(t,r,{passive:s}):e.addEventListener(t,r,!1)}function $0(e,t,r,n,s){var a=n;if(!(t&1)&&!(t&2)&&n!==null)e:for(;;){if(n===null)return;var i=n.tag;if(i===3||i===4){var o=n.stateNode.containerInfo;if(o===s||o.nodeType===8&&o.parentNode===s)break;if(i===4)for(i=n.return;i!==null;){var l=i.tag;if((l===3||l===4)&&(l=i.stateNode.containerInfo,l===s||l.nodeType===8&&l.parentNode===s))return;i=i.return}for(;o!==null;){if(i=Di(o),i===null)return;if(l=i.tag,l===5||l===6){n=a=i;continue e}o=o.parentNode}}n=n.return}r2(function(){var u=a,f=_g(r),d=[];e:{var m=R2.get(e);if(m!==void 0){var p=Ag,x=e;switch(e){case"keypress":if(nh(r)===0)break e;case"keydown":case"keyup":p=nC;break;case"focusin":x="focus",p=O0;break;case"focusout":x="blur",p=O0;break;case"beforeblur":case"afterblur":p=O0;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":p=O1;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":p=HN;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":p=iC;break;case b2:case I2:case N2:p=qN;break;case C2:p=lC;break;case"scroll":p=WN;break;case"wheel":p=uC;break;case"copy":case"cut":case"paste":p=YN;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":p=j1}var g=(t&4)!==0,_=!g&&e==="scroll",k=g?m!==null?m+"Capture":null:m;g=[];for(var E=u,y;E!==null;){y=E;var b=y.stateNode;if(y.tag===5&&b!==null&&(y=b,k!==null&&(b=Kc(E,k),b!=null&&g.push(eu(E,b,y)))),_)break;E=E.return}0<g.length&&(m=new p(m,x,null,r,f),d.push({event:m,listeners:g}))}}if(!(t&7)){e:{if(m=e==="mouseover"||e==="pointerover",p=e==="mouseout"||e==="pointerout",m&&r!==Vm&&(x=r.relatedTarget||r.fromElement)&&(Di(x)||x[pa]))break e;if((p||m)&&(m=f.window===f?f:(m=f.ownerDocument)?m.defaultView||m.parentWindow:window,p?(x=r.relatedTarget||r.toElement,p=u,x=x?Di(x):null,x!==null&&(_=co(x),x!==_||x.tag!==5&&x.tag!==6)&&(x=null)):(p=null,x=u),p!==x)){if(g=O1,b="onMouseLeave",k="onMouseEnter",E="mouse",(e==="pointerout"||e==="pointerover")&&(g=j1,b="onPointerLeave",k="onPointerEnter",E="pointer"),_=p==null?m:Uo(p),y=x==null?m:Uo(x),m=new g(b,E+"leave",p,r,f),m.target=_,m.relatedTarget=y,b=null,Di(f)===u&&(g=new g(k,E+"enter",x,r,f),g.target=y,g.relatedTarget=_,b=g),_=b,p&&x)t:{for(g=p,k=x,E=0,y=g;y;y=bo(y))E++;for(y=0,b=k;b;b=bo(b))y++;for(;0<E-y;)g=bo(g),E--;for(;0<y-E;)k=bo(k),y--;for(;E--;){if(g===k||k!==null&&g===k.alternate)break t;g=bo(g),k=bo(k)}g=null}else g=null;p!==null&&q1(d,m,p,g,!1),x!==null&&_!==null&&q1(d,_,x,g,!0)}}e:{if(m=u?Uo(u):window,p=m.nodeName&&m.nodeName.toLowerCase(),p==="select"||p==="input"&&m.type==="file")var O=xC;else if(V1(m))if(E2)O=wC;else{O=yC;var D=vC}else(p=m.nodeName)&&p.toLowerCase()==="input"&&(m.type==="checkbox"||m.type==="radio")&&(O=_C);if(O&&(O=O(e,u))){w2(d,O,r,f);break e}D&&D(e,m,u),e==="focusout"&&(D=m._wrapperState)&&D.controlled&&m.type==="number"&&Om(m,"number",m.value)}switch(D=u?Uo(u):window,e){case"focusin":(V1(D)||D.contentEditable==="true")&&(jo=D,Km=u,kc=null);break;case"focusout":kc=Km=jo=null;break;case"mousedown":qm=!0;break;case"contextmenu":case"mouseup":case"dragend":qm=!1,H1(d,r,f);break;case"selectionchange":if(kC)break;case"keydown":case"keyup":H1(d,r,f)}var v;if(Ig)e:{switch(e){case"compositionstart":var T="onCompositionStart";break e;case"compositionend":T="onCompositionEnd";break e;case"compositionupdate":T="onCompositionUpdate";break e}T=void 0}else Mo?y2(e,r)&&(T="onCompositionEnd"):e==="keydown"&&r.keyCode===229&&(T="onCompositionStart");T&&(v2&&r.locale!=="ko"&&(Mo||T!=="onCompositionStart"?T==="onCompositionEnd"&&Mo&&(v=x2()):(Ga=f,Sg="value"in Ga?Ga.value:Ga.textContent,Mo=!0)),D=Nh(u,T),0<D.length&&(T=new M1(T,e,null,r,f),d.push({event:T,listeners:D}),v?T.data=v:(v=_2(r),v!==null&&(T.data=v)))),(v=hC?dC(e,r):mC(e,r))&&(u=Nh(u,"onBeforeInput"),0<u.length&&(f=new M1("onBeforeInput","beforeinput",null,r,f),d.push({event:f,listeners:u}),f.data=v))}P2(d,t)})}function eu(e,t,r){return{instance:e,listener:t,currentTarget:r}}function Nh(e,t){for(var r=t+"Capture",n=[];e!==null;){var s=e,a=s.stateNode;s.tag===5&&a!==null&&(s=a,a=Kc(e,r),a!=null&&n.unshift(eu(e,a,s)),a=Kc(e,t),a!=null&&n.push(eu(e,a,s))),e=e.return}return n}function bo(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function q1(e,t,r,n,s){for(var a=t._reactName,i=[];r!==null&&r!==n;){var o=r,l=o.alternate,u=o.stateNode;if(l!==null&&l===n)break;o.tag===5&&u!==null&&(o=u,s?(l=Kc(r,a),l!=null&&i.unshift(eu(r,l,o))):s||(l=Kc(r,a),l!=null&&i.push(eu(r,l,o)))),r=r.return}i.length!==0&&e.push({event:t,listeners:i})}var IC=/\r\n?/g,NC=/\u0000|\uFFFD/g;function X1(e){return(typeof e=="string"?e:""+e).replace(IC,`
`).replace(NC,"")}function Nf(e,t,r){if(t=X1(t),X1(e)!==t&&r)throw Error(Ee(425))}function Ch(){}var Xm=null,Ym=null;function Qm(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var Jm=typeof setTimeout=="function"?setTimeout:void 0,CC=typeof clearTimeout=="function"?clearTimeout:void 0,Y1=typeof Promise=="function"?Promise:void 0,RC=typeof queueMicrotask=="function"?queueMicrotask:typeof Y1<"u"?function(e){return Y1.resolve(null).then(e).catch(PC)}:Jm;function PC(e){setTimeout(function(){throw e})}function W0(e,t){var r=t,n=0;do{var s=r.nextSibling;if(e.removeChild(r),s&&s.nodeType===8)if(r=s.data,r==="/$"){if(n===0){e.removeChild(s),Yc(t);return}n--}else r!=="$"&&r!=="$?"&&r!=="$!"||n++;r=s}while(r);Yc(t)}function ti(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function Q1(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="$"||r==="$!"||r==="$?"){if(t===0)return e;t--}else r==="/$"&&t++}e=e.previousSibling}return null}var Nl=Math.random().toString(36).slice(2),Ps="__reactFiber$"+Nl,tu="__reactProps$"+Nl,pa="__reactContainer$"+Nl,Zm="__reactEvents$"+Nl,DC="__reactListeners$"+Nl,FC="__reactHandles$"+Nl;function Di(e){var t=e[Ps];if(t)return t;for(var r=e.parentNode;r;){if(t=r[pa]||r[Ps]){if(r=t.alternate,t.child!==null||r!==null&&r.child!==null)for(e=Q1(e);e!==null;){if(r=e[Ps])return r;e=Q1(e)}return t}e=r,r=e.parentNode}return null}function Du(e){return e=e[Ps]||e[pa],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function Uo(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(Ee(33))}function Pd(e){return e[tu]||null}var ep=[],Vo=-1;function _i(e){return{current:e}}function Rt(e){0>Vo||(e.current=ep[Vo],ep[Vo]=null,Vo--)}function kt(e,t){Vo++,ep[Vo]=e.current,e.current=t}var hi={},Gr=_i(hi),vn=_i(!1),qi=hi;function cl(e,t){var r=e.type.contextTypes;if(!r)return hi;var n=e.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===t)return n.__reactInternalMemoizedMaskedChildContext;var s={},a;for(a in r)s[a]=t[a];return n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=s),s}function yn(e){return e=e.childContextTypes,e!=null}function Rh(){Rt(vn),Rt(Gr)}function J1(e,t,r){if(Gr.current!==hi)throw Error(Ee(168));kt(Gr,t),kt(vn,r)}function F2(e,t,r){var n=e.stateNode;if(t=t.childContextTypes,typeof n.getChildContext!="function")return r;n=n.getChildContext();for(var s in n)if(!(s in t))throw Error(Ee(108,vN(e)||"Unknown",s));return Vt({},r,n)}function Ph(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||hi,qi=Gr.current,kt(Gr,e),kt(vn,vn.current),!0}function Z1(e,t,r){var n=e.stateNode;if(!n)throw Error(Ee(169));r?(e=F2(e,t,qi),n.__reactInternalMemoizedMergedChildContext=e,Rt(vn),Rt(Gr),kt(Gr,e)):Rt(vn),kt(vn,r)}var ta=null,Dd=!1,z0=!1;function O2(e){ta===null?ta=[e]:ta.push(e)}function OC(e){Dd=!0,O2(e)}function wi(){if(!z0&&ta!==null){z0=!0;var e=0,t=xt;try{var r=ta;for(xt=1;e<r.length;e++){var n=r[e];do n=n(!0);while(n!==null)}ta=null,Dd=!1}catch(s){throw ta!==null&&(ta=ta.slice(e+1)),i2(wg,wi),s}finally{xt=t,z0=!1}}return null}var Bo=[],$o=0,Dh=null,Fh=0,Hn=[],Gn=0,Xi=null,ra=1,na="";function bi(e,t){Bo[$o++]=Fh,Bo[$o++]=Dh,Dh=e,Fh=t}function M2(e,t,r){Hn[Gn++]=ra,Hn[Gn++]=na,Hn[Gn++]=Xi,Xi=e;var n=ra;e=na;var s=32-xs(n)-1;n&=~(1<<s),r+=1;var a=32-xs(t)+s;if(30<a){var i=s-s%5;a=(n&(1<<i)-1).toString(32),n>>=i,s-=i,ra=1<<32-xs(t)+s|r<<s|n,na=a+e}else ra=1<<a|r<<s|n,na=e}function Cg(e){e.return!==null&&(bi(e,1),M2(e,1,0))}function Rg(e){for(;e===Dh;)Dh=Bo[--$o],Bo[$o]=null,Fh=Bo[--$o],Bo[$o]=null;for(;e===Xi;)Xi=Hn[--Gn],Hn[Gn]=null,na=Hn[--Gn],Hn[Gn]=null,ra=Hn[--Gn],Hn[Gn]=null}var Pn=null,Nn=null,Ot=!1,fs=null;function j2(e,t){var r=Kn(5,null,null,0);r.elementType="DELETED",r.stateNode=t,r.return=e,t=e.deletions,t===null?(e.deletions=[r],e.flags|=16):t.push(r)}function ey(e,t){switch(e.tag){case 5:var r=e.type;return t=t.nodeType!==1||r.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,Pn=e,Nn=ti(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,Pn=e,Nn=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(r=Xi!==null?{id:ra,overflow:na}:null,e.memoizedState={dehydrated:t,treeContext:r,retryLane:1073741824},r=Kn(18,null,null,0),r.stateNode=t,r.return=e,e.child=r,Pn=e,Nn=null,!0):!1;default:return!1}}function tp(e){return(e.mode&1)!==0&&(e.flags&128)===0}function rp(e){if(Ot){var t=Nn;if(t){var r=t;if(!ey(e,t)){if(tp(e))throw Error(Ee(418));t=ti(r.nextSibling);var n=Pn;t&&ey(e,t)?j2(n,r):(e.flags=e.flags&-4097|2,Ot=!1,Pn=e)}}else{if(tp(e))throw Error(Ee(418));e.flags=e.flags&-4097|2,Ot=!1,Pn=e}}}function ty(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;Pn=e}function Cf(e){if(e!==Pn)return!1;if(!Ot)return ty(e),Ot=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!Qm(e.type,e.memoizedProps)),t&&(t=Nn)){if(tp(e))throw L2(),Error(Ee(418));for(;t;)j2(e,t),t=ti(t.nextSibling)}if(ty(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(Ee(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="/$"){if(t===0){Nn=ti(e.nextSibling);break e}t--}else r!=="$"&&r!=="$!"&&r!=="$?"||t++}e=e.nextSibling}Nn=null}}else Nn=Pn?ti(e.stateNode.nextSibling):null;return!0}function L2(){for(var e=Nn;e;)e=ti(e.nextSibling)}function ul(){Nn=Pn=null,Ot=!1}function Pg(e){fs===null?fs=[e]:fs.push(e)}var MC=Aa.ReactCurrentBatchConfig;function Zl(e,t,r){if(e=r.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(r._owner){if(r=r._owner,r){if(r.tag!==1)throw Error(Ee(309));var n=r.stateNode}if(!n)throw Error(Ee(147,e));var s=n,a=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===a?t.ref:(t=function(i){var o=s.refs;i===null?delete o[a]:o[a]=i},t._stringRef=a,t)}if(typeof e!="string")throw Error(Ee(284));if(!r._owner)throw Error(Ee(290,e))}return e}function Rf(e,t){throw e=Object.prototype.toString.call(t),Error(Ee(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function ry(e){var t=e._init;return t(e._payload)}function U2(e){function t(k,E){if(e){var y=k.deletions;y===null?(k.deletions=[E],k.flags|=16):y.push(E)}}function r(k,E){if(!e)return null;for(;E!==null;)t(k,E),E=E.sibling;return null}function n(k,E){for(k=new Map;E!==null;)E.key!==null?k.set(E.key,E):k.set(E.index,E),E=E.sibling;return k}function s(k,E){return k=ai(k,E),k.index=0,k.sibling=null,k}function a(k,E,y){return k.index=y,e?(y=k.alternate,y!==null?(y=y.index,y<E?(k.flags|=2,E):y):(k.flags|=2,E)):(k.flags|=1048576,E)}function i(k){return e&&k.alternate===null&&(k.flags|=2),k}function o(k,E,y,b){return E===null||E.tag!==6?(E=Q0(y,k.mode,b),E.return=k,E):(E=s(E,y),E.return=k,E)}function l(k,E,y,b){var O=y.type;return O===Oo?f(k,E,y.props.children,b,y.key):E!==null&&(E.elementType===O||typeof O=="object"&&O!==null&&O.$$typeof===ja&&ry(O)===E.type)?(b=s(E,y.props),b.ref=Zl(k,E,y),b.return=k,b):(b=uh(y.type,y.key,y.props,null,k.mode,b),b.ref=Zl(k,E,y),b.return=k,b)}function u(k,E,y,b){return E===null||E.tag!==4||E.stateNode.containerInfo!==y.containerInfo||E.stateNode.implementation!==y.implementation?(E=J0(y,k.mode,b),E.return=k,E):(E=s(E,y.children||[]),E.return=k,E)}function f(k,E,y,b,O){return E===null||E.tag!==7?(E=Bi(y,k.mode,b,O),E.return=k,E):(E=s(E,y),E.return=k,E)}function d(k,E,y){if(typeof E=="string"&&E!==""||typeof E=="number")return E=Q0(""+E,k.mode,y),E.return=k,E;if(typeof E=="object"&&E!==null){switch(E.$$typeof){case _f:return y=uh(E.type,E.key,E.props,null,k.mode,y),y.ref=Zl(k,null,E),y.return=k,y;case Fo:return E=J0(E,k.mode,y),E.return=k,E;case ja:var b=E._init;return d(k,b(E._payload),y)}if(lc(E)||ql(E))return E=Bi(E,k.mode,y,null),E.return=k,E;Rf(k,E)}return null}function m(k,E,y,b){var O=E!==null?E.key:null;if(typeof y=="string"&&y!==""||typeof y=="number")return O!==null?null:o(k,E,""+y,b);if(typeof y=="object"&&y!==null){switch(y.$$typeof){case _f:return y.key===O?l(k,E,y,b):null;case Fo:return y.key===O?u(k,E,y,b):null;case ja:return O=y._init,m(k,E,O(y._payload),b)}if(lc(y)||ql(y))return O!==null?null:f(k,E,y,b,null);Rf(k,y)}return null}function p(k,E,y,b,O){if(typeof b=="string"&&b!==""||typeof b=="number")return k=k.get(y)||null,o(E,k,""+b,O);if(typeof b=="object"&&b!==null){switch(b.$$typeof){case _f:return k=k.get(b.key===null?y:b.key)||null,l(E,k,b,O);case Fo:return k=k.get(b.key===null?y:b.key)||null,u(E,k,b,O);case ja:var D=b._init;return p(k,E,y,D(b._payload),O)}if(lc(b)||ql(b))return k=k.get(y)||null,f(E,k,b,O,null);Rf(E,b)}return null}function x(k,E,y,b){for(var O=null,D=null,v=E,T=E=0,S=null;v!==null&&T<y.length;T++){v.index>T?(S=v,v=null):S=v.sibling;var N=m(k,v,y[T],b);if(N===null){v===null&&(v=S);break}e&&v&&N.alternate===null&&t(k,v),E=a(N,E,T),D===null?O=N:D.sibling=N,D=N,v=S}if(T===y.length)return r(k,v),Ot&&bi(k,T),O;if(v===null){for(;T<y.length;T++)v=d(k,y[T],b),v!==null&&(E=a(v,E,T),D===null?O=v:D.sibling=v,D=v);return Ot&&bi(k,T),O}for(v=n(k,v);T<y.length;T++)S=p(v,k,T,y[T],b),S!==null&&(e&&S.alternate!==null&&v.delete(S.key===null?T:S.key),E=a(S,E,T),D===null?O=S:D.sibling=S,D=S);return e&&v.forEach(function(C){return t(k,C)}),Ot&&bi(k,T),O}function g(k,E,y,b){var O=ql(y);if(typeof O!="function")throw Error(Ee(150));if(y=O.call(y),y==null)throw Error(Ee(151));for(var D=O=null,v=E,T=E=0,S=null,N=y.next();v!==null&&!N.done;T++,N=y.next()){v.index>T?(S=v,v=null):S=v.sibling;var C=m(k,v,N.value,b);if(C===null){v===null&&(v=S);break}e&&v&&C.alternate===null&&t(k,v),E=a(C,E,T),D===null?O=C:D.sibling=C,D=C,v=S}if(N.done)return r(k,v),Ot&&bi(k,T),O;if(v===null){for(;!N.done;T++,N=y.next())N=d(k,N.value,b),N!==null&&(E=a(N,E,T),D===null?O=N:D.sibling=N,D=N);return Ot&&bi(k,T),O}for(v=n(k,v);!N.done;T++,N=y.next())N=p(v,k,T,N.value,b),N!==null&&(e&&N.alternate!==null&&v.delete(N.key===null?T:N.key),E=a(N,E,T),D===null?O=N:D.sibling=N,D=N);return e&&v.forEach(function(R){return t(k,R)}),Ot&&bi(k,T),O}function _(k,E,y,b){if(typeof y=="object"&&y!==null&&y.type===Oo&&y.key===null&&(y=y.props.children),typeof y=="object"&&y!==null){switch(y.$$typeof){case _f:e:{for(var O=y.key,D=E;D!==null;){if(D.key===O){if(O=y.type,O===Oo){if(D.tag===7){r(k,D.sibling),E=s(D,y.props.children),E.return=k,k=E;break e}}else if(D.elementType===O||typeof O=="object"&&O!==null&&O.$$typeof===ja&&ry(O)===D.type){r(k,D.sibling),E=s(D,y.props),E.ref=Zl(k,D,y),E.return=k,k=E;break e}r(k,D);break}else t(k,D);D=D.sibling}y.type===Oo?(E=Bi(y.props.children,k.mode,b,y.key),E.return=k,k=E):(b=uh(y.type,y.key,y.props,null,k.mode,b),b.ref=Zl(k,E,y),b.return=k,k=b)}return i(k);case Fo:e:{for(D=y.key;E!==null;){if(E.key===D)if(E.tag===4&&E.stateNode.containerInfo===y.containerInfo&&E.stateNode.implementation===y.implementation){r(k,E.sibling),E=s(E,y.children||[]),E.return=k,k=E;break e}else{r(k,E);break}else t(k,E);E=E.sibling}E=J0(y,k.mode,b),E.return=k,k=E}return i(k);case ja:return D=y._init,_(k,E,D(y._payload),b)}if(lc(y))return x(k,E,y,b);if(ql(y))return g(k,E,y,b);Rf(k,y)}return typeof y=="string"&&y!==""||typeof y=="number"?(y=""+y,E!==null&&E.tag===6?(r(k,E.sibling),E=s(E,y),E.return=k,k=E):(r(k,E),E=Q0(y,k.mode,b),E.return=k,k=E),i(k)):r(k,E)}return _}var fl=U2(!0),V2=U2(!1),Oh=_i(null),Mh=null,Wo=null,Dg=null;function Fg(){Dg=Wo=Mh=null}function Og(e){var t=Oh.current;Rt(Oh),e._currentValue=t}function np(e,t,r){for(;e!==null;){var n=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,n!==null&&(n.childLanes|=t)):n!==null&&(n.childLanes&t)!==t&&(n.childLanes|=t),e===r)break;e=e.return}}function Qo(e,t){Mh=e,Dg=Wo=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(gn=!0),e.firstContext=null)}function Qn(e){var t=e._currentValue;if(Dg!==e)if(e={context:e,memoizedValue:t,next:null},Wo===null){if(Mh===null)throw Error(Ee(308));Wo=e,Mh.dependencies={lanes:0,firstContext:e}}else Wo=Wo.next=e;return t}var Fi=null;function Mg(e){Fi===null?Fi=[e]:Fi.push(e)}function B2(e,t,r,n){var s=t.interleaved;return s===null?(r.next=r,Mg(t)):(r.next=s.next,s.next=r),t.interleaved=r,ga(e,n)}function ga(e,t){e.lanes|=t;var r=e.alternate;for(r!==null&&(r.lanes|=t),r=e,e=e.return;e!==null;)e.childLanes|=t,r=e.alternate,r!==null&&(r.childLanes|=t),r=e,e=e.return;return r.tag===3?r.stateNode:null}var La=!1;function jg(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function $2(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function ca(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function ri(e,t,r){var n=e.updateQueue;if(n===null)return null;if(n=n.shared,ot&2){var s=n.pending;return s===null?t.next=t:(t.next=s.next,s.next=t),n.pending=t,ga(e,r)}return s=n.interleaved,s===null?(t.next=t,Mg(n)):(t.next=s.next,s.next=t),n.interleaved=t,ga(e,r)}function sh(e,t,r){if(t=t.updateQueue,t!==null&&(t=t.shared,(r&4194240)!==0)){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,Eg(e,r)}}function ny(e,t){var r=e.updateQueue,n=e.alternate;if(n!==null&&(n=n.updateQueue,r===n)){var s=null,a=null;if(r=r.firstBaseUpdate,r!==null){do{var i={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};a===null?s=a=i:a=a.next=i,r=r.next}while(r!==null);a===null?s=a=t:a=a.next=t}else s=a=t;r={baseState:n.baseState,firstBaseUpdate:s,lastBaseUpdate:a,shared:n.shared,effects:n.effects},e.updateQueue=r;return}e=r.lastBaseUpdate,e===null?r.firstBaseUpdate=t:e.next=t,r.lastBaseUpdate=t}function jh(e,t,r,n){var s=e.updateQueue;La=!1;var a=s.firstBaseUpdate,i=s.lastBaseUpdate,o=s.shared.pending;if(o!==null){s.shared.pending=null;var l=o,u=l.next;l.next=null,i===null?a=u:i.next=u,i=l;var f=e.alternate;f!==null&&(f=f.updateQueue,o=f.lastBaseUpdate,o!==i&&(o===null?f.firstBaseUpdate=u:o.next=u,f.lastBaseUpdate=l))}if(a!==null){var d=s.baseState;i=0,f=u=l=null,o=a;do{var m=o.lane,p=o.eventTime;if((n&m)===m){f!==null&&(f=f.next={eventTime:p,lane:0,tag:o.tag,payload:o.payload,callback:o.callback,next:null});e:{var x=e,g=o;switch(m=t,p=r,g.tag){case 1:if(x=g.payload,typeof x=="function"){d=x.call(p,d,m);break e}d=x;break e;case 3:x.flags=x.flags&-65537|128;case 0:if(x=g.payload,m=typeof x=="function"?x.call(p,d,m):x,m==null)break e;d=Vt({},d,m);break e;case 2:La=!0}}o.callback!==null&&o.lane!==0&&(e.flags|=64,m=s.effects,m===null?s.effects=[o]:m.push(o))}else p={eventTime:p,lane:m,tag:o.tag,payload:o.payload,callback:o.callback,next:null},f===null?(u=f=p,l=d):f=f.next=p,i|=m;if(o=o.next,o===null){if(o=s.shared.pending,o===null)break;m=o,o=m.next,m.next=null,s.lastBaseUpdate=m,s.shared.pending=null}}while(!0);if(f===null&&(l=d),s.baseState=l,s.firstBaseUpdate=u,s.lastBaseUpdate=f,t=s.shared.interleaved,t!==null){s=t;do i|=s.lane,s=s.next;while(s!==t)}else a===null&&(s.shared.lanes=0);Qi|=i,e.lanes=i,e.memoizedState=d}}function sy(e,t,r){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var n=e[t],s=n.callback;if(s!==null){if(n.callback=null,n=r,typeof s!="function")throw Error(Ee(191,s));s.call(n)}}}var Fu={},Ms=_i(Fu),ru=_i(Fu),nu=_i(Fu);function Oi(e){if(e===Fu)throw Error(Ee(174));return e}function Lg(e,t){switch(kt(nu,t),kt(ru,e),kt(Ms,Fu),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:jm(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=jm(t,e)}Rt(Ms),kt(Ms,t)}function hl(){Rt(Ms),Rt(ru),Rt(nu)}function W2(e){Oi(nu.current);var t=Oi(Ms.current),r=jm(t,e.type);t!==r&&(kt(ru,e),kt(Ms,r))}function Ug(e){ru.current===e&&(Rt(Ms),Rt(ru))}var Lt=_i(0);function Lh(e){for(var t=e;t!==null;){if(t.tag===13){var r=t.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||r.data==="$?"||r.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var H0=[];function Vg(){for(var e=0;e<H0.length;e++)H0[e]._workInProgressVersionPrimary=null;H0.length=0}var ah=Aa.ReactCurrentDispatcher,G0=Aa.ReactCurrentBatchConfig,Yi=0,Ut=null,lr=null,xr=null,Uh=!1,Sc=!1,su=0,jC=0;function Fr(){throw Error(Ee(321))}function Bg(e,t){if(t===null)return!1;for(var r=0;r<t.length&&r<e.length;r++)if(!ws(e[r],t[r]))return!1;return!0}function $g(e,t,r,n,s,a){if(Yi=a,Ut=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,ah.current=e===null||e.memoizedState===null?BC:$C,e=r(n,s),Sc){a=0;do{if(Sc=!1,su=0,25<=a)throw Error(Ee(301));a+=1,xr=lr=null,t.updateQueue=null,ah.current=WC,e=r(n,s)}while(Sc)}if(ah.current=Vh,t=lr!==null&&lr.next!==null,Yi=0,xr=lr=Ut=null,Uh=!1,t)throw Error(Ee(300));return e}function Wg(){var e=su!==0;return su=0,e}function Rs(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return xr===null?Ut.memoizedState=xr=e:xr=xr.next=e,xr}function Jn(){if(lr===null){var e=Ut.alternate;e=e!==null?e.memoizedState:null}else e=lr.next;var t=xr===null?Ut.memoizedState:xr.next;if(t!==null)xr=t,lr=e;else{if(e===null)throw Error(Ee(310));lr=e,e={memoizedState:lr.memoizedState,baseState:lr.baseState,baseQueue:lr.baseQueue,queue:lr.queue,next:null},xr===null?Ut.memoizedState=xr=e:xr=xr.next=e}return xr}function au(e,t){return typeof t=="function"?t(e):t}function K0(e){var t=Jn(),r=t.queue;if(r===null)throw Error(Ee(311));r.lastRenderedReducer=e;var n=lr,s=n.baseQueue,a=r.pending;if(a!==null){if(s!==null){var i=s.next;s.next=a.next,a.next=i}n.baseQueue=s=a,r.pending=null}if(s!==null){a=s.next,n=n.baseState;var o=i=null,l=null,u=a;do{var f=u.lane;if((Yi&f)===f)l!==null&&(l=l.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),n=u.hasEagerState?u.eagerState:e(n,u.action);else{var d={lane:f,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};l===null?(o=l=d,i=n):l=l.next=d,Ut.lanes|=f,Qi|=f}u=u.next}while(u!==null&&u!==a);l===null?i=n:l.next=o,ws(n,t.memoizedState)||(gn=!0),t.memoizedState=n,t.baseState=i,t.baseQueue=l,r.lastRenderedState=n}if(e=r.interleaved,e!==null){s=e;do a=s.lane,Ut.lanes|=a,Qi|=a,s=s.next;while(s!==e)}else s===null&&(r.lanes=0);return[t.memoizedState,r.dispatch]}function q0(e){var t=Jn(),r=t.queue;if(r===null)throw Error(Ee(311));r.lastRenderedReducer=e;var n=r.dispatch,s=r.pending,a=t.memoizedState;if(s!==null){r.pending=null;var i=s=s.next;do a=e(a,i.action),i=i.next;while(i!==s);ws(a,t.memoizedState)||(gn=!0),t.memoizedState=a,t.baseQueue===null&&(t.baseState=a),r.lastRenderedState=a}return[a,n]}function z2(){}function H2(e,t){var r=Ut,n=Jn(),s=t(),a=!ws(n.memoizedState,s);if(a&&(n.memoizedState=s,gn=!0),n=n.queue,zg(q2.bind(null,r,n,e),[e]),n.getSnapshot!==t||a||xr!==null&&xr.memoizedState.tag&1){if(r.flags|=2048,iu(9,K2.bind(null,r,n,s,t),void 0,null),vr===null)throw Error(Ee(349));Yi&30||G2(r,t,s)}return s}function G2(e,t,r){e.flags|=16384,e={getSnapshot:t,value:r},t=Ut.updateQueue,t===null?(t={lastEffect:null,stores:null},Ut.updateQueue=t,t.stores=[e]):(r=t.stores,r===null?t.stores=[e]:r.push(e))}function K2(e,t,r,n){t.value=r,t.getSnapshot=n,X2(t)&&Y2(e)}function q2(e,t,r){return r(function(){X2(t)&&Y2(e)})}function X2(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!ws(e,r)}catch{return!0}}function Y2(e){var t=ga(e,1);t!==null&&vs(t,e,1,-1)}function ay(e){var t=Rs();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:au,lastRenderedState:e},t.queue=e,e=e.dispatch=VC.bind(null,Ut,e),[t.memoizedState,e]}function iu(e,t,r,n){return e={tag:e,create:t,destroy:r,deps:n,next:null},t=Ut.updateQueue,t===null?(t={lastEffect:null,stores:null},Ut.updateQueue=t,t.lastEffect=e.next=e):(r=t.lastEffect,r===null?t.lastEffect=e.next=e:(n=r.next,r.next=e,e.next=n,t.lastEffect=e)),e}function Q2(){return Jn().memoizedState}function ih(e,t,r,n){var s=Rs();Ut.flags|=e,s.memoizedState=iu(1|t,r,void 0,n===void 0?null:n)}function Fd(e,t,r,n){var s=Jn();n=n===void 0?null:n;var a=void 0;if(lr!==null){var i=lr.memoizedState;if(a=i.destroy,n!==null&&Bg(n,i.deps)){s.memoizedState=iu(t,r,a,n);return}}Ut.flags|=e,s.memoizedState=iu(1|t,r,a,n)}function iy(e,t){return ih(8390656,8,e,t)}function zg(e,t){return Fd(2048,8,e,t)}function J2(e,t){return Fd(4,2,e,t)}function Z2(e,t){return Fd(4,4,e,t)}function eT(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function tT(e,t,r){return r=r!=null?r.concat([e]):null,Fd(4,4,eT.bind(null,t,e),r)}function Hg(){}function rT(e,t){var r=Jn();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&Bg(t,n[1])?n[0]:(r.memoizedState=[e,t],e)}function nT(e,t){var r=Jn();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&Bg(t,n[1])?n[0]:(e=e(),r.memoizedState=[e,t],e)}function sT(e,t,r){return Yi&21?(ws(r,t)||(r=c2(),Ut.lanes|=r,Qi|=r,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,gn=!0),e.memoizedState=r)}function LC(e,t){var r=xt;xt=r!==0&&4>r?r:4,e(!0);var n=G0.transition;G0.transition={};try{e(!1),t()}finally{xt=r,G0.transition=n}}function aT(){return Jn().memoizedState}function UC(e,t,r){var n=si(e);if(r={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null},iT(e))oT(t,r);else if(r=B2(e,t,r,n),r!==null){var s=tn();vs(r,e,n,s),lT(r,t,n)}}function VC(e,t,r){var n=si(e),s={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null};if(iT(e))oT(t,s);else{var a=e.alternate;if(e.lanes===0&&(a===null||a.lanes===0)&&(a=t.lastRenderedReducer,a!==null))try{var i=t.lastRenderedState,o=a(i,r);if(s.hasEagerState=!0,s.eagerState=o,ws(o,i)){var l=t.interleaved;l===null?(s.next=s,Mg(t)):(s.next=l.next,l.next=s),t.interleaved=s;return}}catch{}finally{}r=B2(e,t,s,n),r!==null&&(s=tn(),vs(r,e,n,s),lT(r,t,n))}}function iT(e){var t=e.alternate;return e===Ut||t!==null&&t===Ut}function oT(e,t){Sc=Uh=!0;var r=e.pending;r===null?t.next=t:(t.next=r.next,r.next=t),e.pending=t}function lT(e,t,r){if(r&4194240){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,Eg(e,r)}}var Vh={readContext:Qn,useCallback:Fr,useContext:Fr,useEffect:Fr,useImperativeHandle:Fr,useInsertionEffect:Fr,useLayoutEffect:Fr,useMemo:Fr,useReducer:Fr,useRef:Fr,useState:Fr,useDebugValue:Fr,useDeferredValue:Fr,useTransition:Fr,useMutableSource:Fr,useSyncExternalStore:Fr,useId:Fr,unstable_isNewReconciler:!1},BC={readContext:Qn,useCallback:function(e,t){return Rs().memoizedState=[e,t===void 0?null:t],e},useContext:Qn,useEffect:iy,useImperativeHandle:function(e,t,r){return r=r!=null?r.concat([e]):null,ih(4194308,4,eT.bind(null,t,e),r)},useLayoutEffect:function(e,t){return ih(4194308,4,e,t)},useInsertionEffect:function(e,t){return ih(4,2,e,t)},useMemo:function(e,t){var r=Rs();return t=t===void 0?null:t,e=e(),r.memoizedState=[e,t],e},useReducer:function(e,t,r){var n=Rs();return t=r!==void 0?r(t):t,n.memoizedState=n.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},n.queue=e,e=e.dispatch=UC.bind(null,Ut,e),[n.memoizedState,e]},useRef:function(e){var t=Rs();return e={current:e},t.memoizedState=e},useState:ay,useDebugValue:Hg,useDeferredValue:function(e){return Rs().memoizedState=e},useTransition:function(){var e=ay(!1),t=e[0];return e=LC.bind(null,e[1]),Rs().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,r){var n=Ut,s=Rs();if(Ot){if(r===void 0)throw Error(Ee(407));r=r()}else{if(r=t(),vr===null)throw Error(Ee(349));Yi&30||G2(n,t,r)}s.memoizedState=r;var a={value:r,getSnapshot:t};return s.queue=a,iy(q2.bind(null,n,a,e),[e]),n.flags|=2048,iu(9,K2.bind(null,n,a,r,t),void 0,null),r},useId:function(){var e=Rs(),t=vr.identifierPrefix;if(Ot){var r=na,n=ra;r=(n&~(1<<32-xs(n)-1)).toString(32)+r,t=":"+t+"R"+r,r=su++,0<r&&(t+="H"+r.toString(32)),t+=":"}else r=jC++,t=":"+t+"r"+r.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},$C={readContext:Qn,useCallback:rT,useContext:Qn,useEffect:zg,useImperativeHandle:tT,useInsertionEffect:J2,useLayoutEffect:Z2,useMemo:nT,useReducer:K0,useRef:Q2,useState:function(){return K0(au)},useDebugValue:Hg,useDeferredValue:function(e){var t=Jn();return sT(t,lr.memoizedState,e)},useTransition:function(){var e=K0(au)[0],t=Jn().memoizedState;return[e,t]},useMutableSource:z2,useSyncExternalStore:H2,useId:aT,unstable_isNewReconciler:!1},WC={readContext:Qn,useCallback:rT,useContext:Qn,useEffect:zg,useImperativeHandle:tT,useInsertionEffect:J2,useLayoutEffect:Z2,useMemo:nT,useReducer:q0,useRef:Q2,useState:function(){return q0(au)},useDebugValue:Hg,useDeferredValue:function(e){var t=Jn();return lr===null?t.memoizedState=e:sT(t,lr.memoizedState,e)},useTransition:function(){var e=q0(au)[0],t=Jn().memoizedState;return[e,t]},useMutableSource:z2,useSyncExternalStore:H2,useId:aT,unstable_isNewReconciler:!1};function ls(e,t){if(e&&e.defaultProps){t=Vt({},t),e=e.defaultProps;for(var r in e)t[r]===void 0&&(t[r]=e[r]);return t}return t}function sp(e,t,r,n){t=e.memoizedState,r=r(n,t),r=r==null?t:Vt({},t,r),e.memoizedState=r,e.lanes===0&&(e.updateQueue.baseState=r)}var Od={isMounted:function(e){return(e=e._reactInternals)?co(e)===e:!1},enqueueSetState:function(e,t,r){e=e._reactInternals;var n=tn(),s=si(e),a=ca(n,s);a.payload=t,r!=null&&(a.callback=r),t=ri(e,a,s),t!==null&&(vs(t,e,s,n),sh(t,e,s))},enqueueReplaceState:function(e,t,r){e=e._reactInternals;var n=tn(),s=si(e),a=ca(n,s);a.tag=1,a.payload=t,r!=null&&(a.callback=r),t=ri(e,a,s),t!==null&&(vs(t,e,s,n),sh(t,e,s))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var r=tn(),n=si(e),s=ca(r,n);s.tag=2,t!=null&&(s.callback=t),t=ri(e,s,n),t!==null&&(vs(t,e,n,r),sh(t,e,n))}};function oy(e,t,r,n,s,a,i){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(n,a,i):t.prototype&&t.prototype.isPureReactComponent?!Jc(r,n)||!Jc(s,a):!0}function cT(e,t,r){var n=!1,s=hi,a=t.contextType;return typeof a=="object"&&a!==null?a=Qn(a):(s=yn(t)?qi:Gr.current,n=t.contextTypes,a=(n=n!=null)?cl(e,s):hi),t=new t(r,a),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=Od,e.stateNode=t,t._reactInternals=e,n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=s,e.__reactInternalMemoizedMaskedChildContext=a),t}function ly(e,t,r,n){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(r,n),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(r,n),t.state!==e&&Od.enqueueReplaceState(t,t.state,null)}function ap(e,t,r,n){var s=e.stateNode;s.props=r,s.state=e.memoizedState,s.refs={},jg(e);var a=t.contextType;typeof a=="object"&&a!==null?s.context=Qn(a):(a=yn(t)?qi:Gr.current,s.context=cl(e,a)),s.state=e.memoizedState,a=t.getDerivedStateFromProps,typeof a=="function"&&(sp(e,t,a,r),s.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof s.getSnapshotBeforeUpdate=="function"||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(t=s.state,typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount(),t!==s.state&&Od.enqueueReplaceState(s,s.state,null),jh(e,r,s,n),s.state=e.memoizedState),typeof s.componentDidMount=="function"&&(e.flags|=4194308)}function dl(e,t){try{var r="",n=t;do r+=xN(n),n=n.return;while(n);var s=r}catch(a){s=`
Error generating stack: `+a.message+`
`+a.stack}return{value:e,source:t,stack:s,digest:null}}function X0(e,t,r){return{value:e,source:null,stack:r??null,digest:t??null}}function ip(e,t){try{console.error(t.value)}catch(r){setTimeout(function(){throw r})}}var zC=typeof WeakMap=="function"?WeakMap:Map;function uT(e,t,r){r=ca(-1,r),r.tag=3,r.payload={element:null};var n=t.value;return r.callback=function(){$h||($h=!0,gp=n),ip(e,t)},r}function fT(e,t,r){r=ca(-1,r),r.tag=3;var n=e.type.getDerivedStateFromError;if(typeof n=="function"){var s=t.value;r.payload=function(){return n(s)},r.callback=function(){ip(e,t)}}var a=e.stateNode;return a!==null&&typeof a.componentDidCatch=="function"&&(r.callback=function(){ip(e,t),typeof n!="function"&&(ni===null?ni=new Set([this]):ni.add(this));var i=t.stack;this.componentDidCatch(t.value,{componentStack:i!==null?i:""})}),r}function cy(e,t,r){var n=e.pingCache;if(n===null){n=e.pingCache=new zC;var s=new Set;n.set(t,s)}else s=n.get(t),s===void 0&&(s=new Set,n.set(t,s));s.has(r)||(s.add(r),e=sR.bind(null,e,t,r),t.then(e,e))}function uy(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function fy(e,t,r,n,s){return e.mode&1?(e.flags|=65536,e.lanes=s,e):(e===t?e.flags|=65536:(e.flags|=128,r.flags|=131072,r.flags&=-52805,r.tag===1&&(r.alternate===null?r.tag=17:(t=ca(-1,1),t.tag=2,ri(r,t,1))),r.lanes|=1),e)}var HC=Aa.ReactCurrentOwner,gn=!1;function Qr(e,t,r,n){t.child=e===null?V2(t,null,r,n):fl(t,e.child,r,n)}function hy(e,t,r,n,s){r=r.render;var a=t.ref;return Qo(t,s),n=$g(e,t,r,n,a,s),r=Wg(),e!==null&&!gn?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~s,xa(e,t,s)):(Ot&&r&&Cg(t),t.flags|=1,Qr(e,t,n,s),t.child)}function dy(e,t,r,n,s){if(e===null){var a=r.type;return typeof a=="function"&&!Zg(a)&&a.defaultProps===void 0&&r.compare===null&&r.defaultProps===void 0?(t.tag=15,t.type=a,hT(e,t,a,n,s)):(e=uh(r.type,null,n,t,t.mode,s),e.ref=t.ref,e.return=t,t.child=e)}if(a=e.child,!(e.lanes&s)){var i=a.memoizedProps;if(r=r.compare,r=r!==null?r:Jc,r(i,n)&&e.ref===t.ref)return xa(e,t,s)}return t.flags|=1,e=ai(a,n),e.ref=t.ref,e.return=t,t.child=e}function hT(e,t,r,n,s){if(e!==null){var a=e.memoizedProps;if(Jc(a,n)&&e.ref===t.ref)if(gn=!1,t.pendingProps=n=a,(e.lanes&s)!==0)e.flags&131072&&(gn=!0);else return t.lanes=e.lanes,xa(e,t,s)}return op(e,t,r,n,s)}function dT(e,t,r){var n=t.pendingProps,s=n.children,a=e!==null?e.memoizedState:null;if(n.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},kt(Ho,Sn),Sn|=r;else{if(!(r&1073741824))return e=a!==null?a.baseLanes|r:r,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,kt(Ho,Sn),Sn|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=a!==null?a.baseLanes:r,kt(Ho,Sn),Sn|=n}else a!==null?(n=a.baseLanes|r,t.memoizedState=null):n=r,kt(Ho,Sn),Sn|=n;return Qr(e,t,s,r),t.child}function mT(e,t){var r=t.ref;(e===null&&r!==null||e!==null&&e.ref!==r)&&(t.flags|=512,t.flags|=2097152)}function op(e,t,r,n,s){var a=yn(r)?qi:Gr.current;return a=cl(t,a),Qo(t,s),r=$g(e,t,r,n,a,s),n=Wg(),e!==null&&!gn?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~s,xa(e,t,s)):(Ot&&n&&Cg(t),t.flags|=1,Qr(e,t,r,s),t.child)}function my(e,t,r,n,s){if(yn(r)){var a=!0;Ph(t)}else a=!1;if(Qo(t,s),t.stateNode===null)oh(e,t),cT(t,r,n),ap(t,r,n,s),n=!0;else if(e===null){var i=t.stateNode,o=t.memoizedProps;i.props=o;var l=i.context,u=r.contextType;typeof u=="object"&&u!==null?u=Qn(u):(u=yn(r)?qi:Gr.current,u=cl(t,u));var f=r.getDerivedStateFromProps,d=typeof f=="function"||typeof i.getSnapshotBeforeUpdate=="function";d||typeof i.UNSAFE_componentWillReceiveProps!="function"&&typeof i.componentWillReceiveProps!="function"||(o!==n||l!==u)&&ly(t,i,n,u),La=!1;var m=t.memoizedState;i.state=m,jh(t,n,i,s),l=t.memoizedState,o!==n||m!==l||vn.current||La?(typeof f=="function"&&(sp(t,r,f,n),l=t.memoizedState),(o=La||oy(t,r,o,n,m,l,u))?(d||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount()),typeof i.componentDidMount=="function"&&(t.flags|=4194308)):(typeof i.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=n,t.memoizedState=l),i.props=n,i.state=l,i.context=u,n=o):(typeof i.componentDidMount=="function"&&(t.flags|=4194308),n=!1)}else{i=t.stateNode,$2(e,t),o=t.memoizedProps,u=t.type===t.elementType?o:ls(t.type,o),i.props=u,d=t.pendingProps,m=i.context,l=r.contextType,typeof l=="object"&&l!==null?l=Qn(l):(l=yn(r)?qi:Gr.current,l=cl(t,l));var p=r.getDerivedStateFromProps;(f=typeof p=="function"||typeof i.getSnapshotBeforeUpdate=="function")||typeof i.UNSAFE_componentWillReceiveProps!="function"&&typeof i.componentWillReceiveProps!="function"||(o!==d||m!==l)&&ly(t,i,n,l),La=!1,m=t.memoizedState,i.state=m,jh(t,n,i,s);var x=t.memoizedState;o!==d||m!==x||vn.current||La?(typeof p=="function"&&(sp(t,r,p,n),x=t.memoizedState),(u=La||oy(t,r,u,n,m,x,l)||!1)?(f||typeof i.UNSAFE_componentWillUpdate!="function"&&typeof i.componentWillUpdate!="function"||(typeof i.componentWillUpdate=="function"&&i.componentWillUpdate(n,x,l),typeof i.UNSAFE_componentWillUpdate=="function"&&i.UNSAFE_componentWillUpdate(n,x,l)),typeof i.componentDidUpdate=="function"&&(t.flags|=4),typeof i.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof i.componentDidUpdate!="function"||o===e.memoizedProps&&m===e.memoizedState||(t.flags|=4),typeof i.getSnapshotBeforeUpdate!="function"||o===e.memoizedProps&&m===e.memoizedState||(t.flags|=1024),t.memoizedProps=n,t.memoizedState=x),i.props=n,i.state=x,i.context=l,n=u):(typeof i.componentDidUpdate!="function"||o===e.memoizedProps&&m===e.memoizedState||(t.flags|=4),typeof i.getSnapshotBeforeUpdate!="function"||o===e.memoizedProps&&m===e.memoizedState||(t.flags|=1024),n=!1)}return lp(e,t,r,n,a,s)}function lp(e,t,r,n,s,a){mT(e,t);var i=(t.flags&128)!==0;if(!n&&!i)return s&&Z1(t,r,!1),xa(e,t,a);n=t.stateNode,HC.current=t;var o=i&&typeof r.getDerivedStateFromError!="function"?null:n.render();return t.flags|=1,e!==null&&i?(t.child=fl(t,e.child,null,a),t.child=fl(t,null,o,a)):Qr(e,t,o,a),t.memoizedState=n.state,s&&Z1(t,r,!0),t.child}function pT(e){var t=e.stateNode;t.pendingContext?J1(e,t.pendingContext,t.pendingContext!==t.context):t.context&&J1(e,t.context,!1),Lg(e,t.containerInfo)}function py(e,t,r,n,s){return ul(),Pg(s),t.flags|=256,Qr(e,t,r,n),t.child}var cp={dehydrated:null,treeContext:null,retryLane:0};function up(e){return{baseLanes:e,cachePool:null,transitions:null}}function gT(e,t,r){var n=t.pendingProps,s=Lt.current,a=!1,i=(t.flags&128)!==0,o;if((o=i)||(o=e!==null&&e.memoizedState===null?!1:(s&2)!==0),o?(a=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(s|=1),kt(Lt,s&1),e===null)return rp(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(i=n.children,e=n.fallback,a?(n=t.mode,a=t.child,i={mode:"hidden",children:i},!(n&1)&&a!==null?(a.childLanes=0,a.pendingProps=i):a=Ld(i,n,0,null),e=Bi(e,n,r,null),a.return=t,e.return=t,a.sibling=e,t.child=a,t.child.memoizedState=up(r),t.memoizedState=cp,e):Gg(t,i));if(s=e.memoizedState,s!==null&&(o=s.dehydrated,o!==null))return GC(e,t,i,n,o,s,r);if(a){a=n.fallback,i=t.mode,s=e.child,o=s.sibling;var l={mode:"hidden",children:n.children};return!(i&1)&&t.child!==s?(n=t.child,n.childLanes=0,n.pendingProps=l,t.deletions=null):(n=ai(s,l),n.subtreeFlags=s.subtreeFlags&14680064),o!==null?a=ai(o,a):(a=Bi(a,i,r,null),a.flags|=2),a.return=t,n.return=t,n.sibling=a,t.child=n,n=a,a=t.child,i=e.child.memoizedState,i=i===null?up(r):{baseLanes:i.baseLanes|r,cachePool:null,transitions:i.transitions},a.memoizedState=i,a.childLanes=e.childLanes&~r,t.memoizedState=cp,n}return a=e.child,e=a.sibling,n=ai(a,{mode:"visible",children:n.children}),!(t.mode&1)&&(n.lanes=r),n.return=t,n.sibling=null,e!==null&&(r=t.deletions,r===null?(t.deletions=[e],t.flags|=16):r.push(e)),t.child=n,t.memoizedState=null,n}function Gg(e,t){return t=Ld({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function Pf(e,t,r,n){return n!==null&&Pg(n),fl(t,e.child,null,r),e=Gg(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function GC(e,t,r,n,s,a,i){if(r)return t.flags&256?(t.flags&=-257,n=X0(Error(Ee(422))),Pf(e,t,i,n)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(a=n.fallback,s=t.mode,n=Ld({mode:"visible",children:n.children},s,0,null),a=Bi(a,s,i,null),a.flags|=2,n.return=t,a.return=t,n.sibling=a,t.child=n,t.mode&1&&fl(t,e.child,null,i),t.child.memoizedState=up(i),t.memoizedState=cp,a);if(!(t.mode&1))return Pf(e,t,i,null);if(s.data==="$!"){if(n=s.nextSibling&&s.nextSibling.dataset,n)var o=n.dgst;return n=o,a=Error(Ee(419)),n=X0(a,n,void 0),Pf(e,t,i,n)}if(o=(i&e.childLanes)!==0,gn||o){if(n=vr,n!==null){switch(i&-i){case 4:s=2;break;case 16:s=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:s=32;break;case 536870912:s=268435456;break;default:s=0}s=s&(n.suspendedLanes|i)?0:s,s!==0&&s!==a.retryLane&&(a.retryLane=s,ga(e,s),vs(n,e,s,-1))}return Jg(),n=X0(Error(Ee(421))),Pf(e,t,i,n)}return s.data==="$?"?(t.flags|=128,t.child=e.child,t=aR.bind(null,e),s._reactRetry=t,null):(e=a.treeContext,Nn=ti(s.nextSibling),Pn=t,Ot=!0,fs=null,e!==null&&(Hn[Gn++]=ra,Hn[Gn++]=na,Hn[Gn++]=Xi,ra=e.id,na=e.overflow,Xi=t),t=Gg(t,n.children),t.flags|=4096,t)}function gy(e,t,r){e.lanes|=t;var n=e.alternate;n!==null&&(n.lanes|=t),np(e.return,t,r)}function Y0(e,t,r,n,s){var a=e.memoizedState;a===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:n,tail:r,tailMode:s}:(a.isBackwards=t,a.rendering=null,a.renderingStartTime=0,a.last=n,a.tail=r,a.tailMode=s)}function xT(e,t,r){var n=t.pendingProps,s=n.revealOrder,a=n.tail;if(Qr(e,t,n.children,r),n=Lt.current,n&2)n=n&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&gy(e,r,t);else if(e.tag===19)gy(e,r,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}n&=1}if(kt(Lt,n),!(t.mode&1))t.memoizedState=null;else switch(s){case"forwards":for(r=t.child,s=null;r!==null;)e=r.alternate,e!==null&&Lh(e)===null&&(s=r),r=r.sibling;r=s,r===null?(s=t.child,t.child=null):(s=r.sibling,r.sibling=null),Y0(t,!1,s,r,a);break;case"backwards":for(r=null,s=t.child,t.child=null;s!==null;){if(e=s.alternate,e!==null&&Lh(e)===null){t.child=s;break}e=s.sibling,s.sibling=r,r=s,s=e}Y0(t,!0,r,null,a);break;case"together":Y0(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function oh(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function xa(e,t,r){if(e!==null&&(t.dependencies=e.dependencies),Qi|=t.lanes,!(r&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(Ee(153));if(t.child!==null){for(e=t.child,r=ai(e,e.pendingProps),t.child=r,r.return=t;e.sibling!==null;)e=e.sibling,r=r.sibling=ai(e,e.pendingProps),r.return=t;r.sibling=null}return t.child}function KC(e,t,r){switch(t.tag){case 3:pT(t),ul();break;case 5:W2(t);break;case 1:yn(t.type)&&Ph(t);break;case 4:Lg(t,t.stateNode.containerInfo);break;case 10:var n=t.type._context,s=t.memoizedProps.value;kt(Oh,n._currentValue),n._currentValue=s;break;case 13:if(n=t.memoizedState,n!==null)return n.dehydrated!==null?(kt(Lt,Lt.current&1),t.flags|=128,null):r&t.child.childLanes?gT(e,t,r):(kt(Lt,Lt.current&1),e=xa(e,t,r),e!==null?e.sibling:null);kt(Lt,Lt.current&1);break;case 19:if(n=(r&t.childLanes)!==0,e.flags&128){if(n)return xT(e,t,r);t.flags|=128}if(s=t.memoizedState,s!==null&&(s.rendering=null,s.tail=null,s.lastEffect=null),kt(Lt,Lt.current),n)break;return null;case 22:case 23:return t.lanes=0,dT(e,t,r)}return xa(e,t,r)}var vT,fp,yT,_T;vT=function(e,t){for(var r=t.child;r!==null;){if(r.tag===5||r.tag===6)e.appendChild(r.stateNode);else if(r.tag!==4&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===t)break;for(;r.sibling===null;){if(r.return===null||r.return===t)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};fp=function(){};yT=function(e,t,r,n){var s=e.memoizedProps;if(s!==n){e=t.stateNode,Oi(Ms.current);var a=null;switch(r){case"input":s=Dm(e,s),n=Dm(e,n),a=[];break;case"select":s=Vt({},s,{value:void 0}),n=Vt({},n,{value:void 0}),a=[];break;case"textarea":s=Mm(e,s),n=Mm(e,n),a=[];break;default:typeof s.onClick!="function"&&typeof n.onClick=="function"&&(e.onclick=Ch)}Lm(r,n);var i;r=null;for(u in s)if(!n.hasOwnProperty(u)&&s.hasOwnProperty(u)&&s[u]!=null)if(u==="style"){var o=s[u];for(i in o)o.hasOwnProperty(i)&&(r||(r={}),r[i]="")}else u!=="dangerouslySetInnerHTML"&&u!=="children"&&u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&(Hc.hasOwnProperty(u)?a||(a=[]):(a=a||[]).push(u,null));for(u in n){var l=n[u];if(o=s!=null?s[u]:void 0,n.hasOwnProperty(u)&&l!==o&&(l!=null||o!=null))if(u==="style")if(o){for(i in o)!o.hasOwnProperty(i)||l&&l.hasOwnProperty(i)||(r||(r={}),r[i]="");for(i in l)l.hasOwnProperty(i)&&o[i]!==l[i]&&(r||(r={}),r[i]=l[i])}else r||(a||(a=[]),a.push(u,r)),r=l;else u==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,o=o?o.__html:void 0,l!=null&&o!==l&&(a=a||[]).push(u,l)):u==="children"?typeof l!="string"&&typeof l!="number"||(a=a||[]).push(u,""+l):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&(Hc.hasOwnProperty(u)?(l!=null&&u==="onScroll"&&Nt("scroll",e),a||o===l||(a=[])):(a=a||[]).push(u,l))}r&&(a=a||[]).push("style",r);var u=a;(t.updateQueue=u)&&(t.flags|=4)}};_T=function(e,t,r,n){r!==n&&(t.flags|=4)};function ec(e,t){if(!Ot)switch(e.tailMode){case"hidden":t=e.tail;for(var r=null;t!==null;)t.alternate!==null&&(r=t),t=t.sibling;r===null?e.tail=null:r.sibling=null;break;case"collapsed":r=e.tail;for(var n=null;r!==null;)r.alternate!==null&&(n=r),r=r.sibling;n===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:n.sibling=null}}function Or(e){var t=e.alternate!==null&&e.alternate.child===e.child,r=0,n=0;if(t)for(var s=e.child;s!==null;)r|=s.lanes|s.childLanes,n|=s.subtreeFlags&14680064,n|=s.flags&14680064,s.return=e,s=s.sibling;else for(s=e.child;s!==null;)r|=s.lanes|s.childLanes,n|=s.subtreeFlags,n|=s.flags,s.return=e,s=s.sibling;return e.subtreeFlags|=n,e.childLanes=r,t}function qC(e,t,r){var n=t.pendingProps;switch(Rg(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Or(t),null;case 1:return yn(t.type)&&Rh(),Or(t),null;case 3:return n=t.stateNode,hl(),Rt(vn),Rt(Gr),Vg(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(e===null||e.child===null)&&(Cf(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,fs!==null&&(yp(fs),fs=null))),fp(e,t),Or(t),null;case 5:Ug(t);var s=Oi(nu.current);if(r=t.type,e!==null&&t.stateNode!=null)yT(e,t,r,n,s),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!n){if(t.stateNode===null)throw Error(Ee(166));return Or(t),null}if(e=Oi(Ms.current),Cf(t)){n=t.stateNode,r=t.type;var a=t.memoizedProps;switch(n[Ps]=t,n[tu]=a,e=(t.mode&1)!==0,r){case"dialog":Nt("cancel",n),Nt("close",n);break;case"iframe":case"object":case"embed":Nt("load",n);break;case"video":case"audio":for(s=0;s<uc.length;s++)Nt(uc[s],n);break;case"source":Nt("error",n);break;case"img":case"image":case"link":Nt("error",n),Nt("load",n);break;case"details":Nt("toggle",n);break;case"input":S1(n,a),Nt("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!a.multiple},Nt("invalid",n);break;case"textarea":b1(n,a),Nt("invalid",n)}Lm(r,a),s=null;for(var i in a)if(a.hasOwnProperty(i)){var o=a[i];i==="children"?typeof o=="string"?n.textContent!==o&&(a.suppressHydrationWarning!==!0&&Nf(n.textContent,o,e),s=["children",o]):typeof o=="number"&&n.textContent!==""+o&&(a.suppressHydrationWarning!==!0&&Nf(n.textContent,o,e),s=["children",""+o]):Hc.hasOwnProperty(i)&&o!=null&&i==="onScroll"&&Nt("scroll",n)}switch(r){case"input":wf(n),A1(n,a,!0);break;case"textarea":wf(n),I1(n);break;case"select":case"option":break;default:typeof a.onClick=="function"&&(n.onclick=Ch)}n=s,t.updateQueue=n,n!==null&&(t.flags|=4)}else{i=s.nodeType===9?s:s.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=qE(r)),e==="http://www.w3.org/1999/xhtml"?r==="script"?(e=i.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof n.is=="string"?e=i.createElement(r,{is:n.is}):(e=i.createElement(r),r==="select"&&(i=e,n.multiple?i.multiple=!0:n.size&&(i.size=n.size))):e=i.createElementNS(e,r),e[Ps]=t,e[tu]=n,vT(e,t,!1,!1),t.stateNode=e;e:{switch(i=Um(r,n),r){case"dialog":Nt("cancel",e),Nt("close",e),s=n;break;case"iframe":case"object":case"embed":Nt("load",e),s=n;break;case"video":case"audio":for(s=0;s<uc.length;s++)Nt(uc[s],e);s=n;break;case"source":Nt("error",e),s=n;break;case"img":case"image":case"link":Nt("error",e),Nt("load",e),s=n;break;case"details":Nt("toggle",e),s=n;break;case"input":S1(e,n),s=Dm(e,n),Nt("invalid",e);break;case"option":s=n;break;case"select":e._wrapperState={wasMultiple:!!n.multiple},s=Vt({},n,{value:void 0}),Nt("invalid",e);break;case"textarea":b1(e,n),s=Mm(e,n),Nt("invalid",e);break;default:s=n}Lm(r,s),o=s;for(a in o)if(o.hasOwnProperty(a)){var l=o[a];a==="style"?QE(e,l):a==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&XE(e,l)):a==="children"?typeof l=="string"?(r!=="textarea"||l!=="")&&Gc(e,l):typeof l=="number"&&Gc(e,""+l):a!=="suppressContentEditableWarning"&&a!=="suppressHydrationWarning"&&a!=="autoFocus"&&(Hc.hasOwnProperty(a)?l!=null&&a==="onScroll"&&Nt("scroll",e):l!=null&&gg(e,a,l,i))}switch(r){case"input":wf(e),A1(e,n,!1);break;case"textarea":wf(e),I1(e);break;case"option":n.value!=null&&e.setAttribute("value",""+fi(n.value));break;case"select":e.multiple=!!n.multiple,a=n.value,a!=null?Ko(e,!!n.multiple,a,!1):n.defaultValue!=null&&Ko(e,!!n.multiple,n.defaultValue,!0);break;default:typeof s.onClick=="function"&&(e.onclick=Ch)}switch(r){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}}n&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return Or(t),null;case 6:if(e&&t.stateNode!=null)_T(e,t,e.memoizedProps,n);else{if(typeof n!="string"&&t.stateNode===null)throw Error(Ee(166));if(r=Oi(nu.current),Oi(Ms.current),Cf(t)){if(n=t.stateNode,r=t.memoizedProps,n[Ps]=t,(a=n.nodeValue!==r)&&(e=Pn,e!==null))switch(e.tag){case 3:Nf(n.nodeValue,r,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&Nf(n.nodeValue,r,(e.mode&1)!==0)}a&&(t.flags|=4)}else n=(r.nodeType===9?r:r.ownerDocument).createTextNode(n),n[Ps]=t,t.stateNode=n}return Or(t),null;case 13:if(Rt(Lt),n=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(Ot&&Nn!==null&&t.mode&1&&!(t.flags&128))L2(),ul(),t.flags|=98560,a=!1;else if(a=Cf(t),n!==null&&n.dehydrated!==null){if(e===null){if(!a)throw Error(Ee(318));if(a=t.memoizedState,a=a!==null?a.dehydrated:null,!a)throw Error(Ee(317));a[Ps]=t}else ul(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;Or(t),a=!1}else fs!==null&&(yp(fs),fs=null),a=!0;if(!a)return t.flags&65536?t:null}return t.flags&128?(t.lanes=r,t):(n=n!==null,n!==(e!==null&&e.memoizedState!==null)&&n&&(t.child.flags|=8192,t.mode&1&&(e===null||Lt.current&1?cr===0&&(cr=3):Jg())),t.updateQueue!==null&&(t.flags|=4),Or(t),null);case 4:return hl(),fp(e,t),e===null&&Zc(t.stateNode.containerInfo),Or(t),null;case 10:return Og(t.type._context),Or(t),null;case 17:return yn(t.type)&&Rh(),Or(t),null;case 19:if(Rt(Lt),a=t.memoizedState,a===null)return Or(t),null;if(n=(t.flags&128)!==0,i=a.rendering,i===null)if(n)ec(a,!1);else{if(cr!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(i=Lh(e),i!==null){for(t.flags|=128,ec(a,!1),n=i.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),t.subtreeFlags=0,n=r,r=t.child;r!==null;)a=r,e=n,a.flags&=14680066,i=a.alternate,i===null?(a.childLanes=0,a.lanes=e,a.child=null,a.subtreeFlags=0,a.memoizedProps=null,a.memoizedState=null,a.updateQueue=null,a.dependencies=null,a.stateNode=null):(a.childLanes=i.childLanes,a.lanes=i.lanes,a.child=i.child,a.subtreeFlags=0,a.deletions=null,a.memoizedProps=i.memoizedProps,a.memoizedState=i.memoizedState,a.updateQueue=i.updateQueue,a.type=i.type,e=i.dependencies,a.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),r=r.sibling;return kt(Lt,Lt.current&1|2),t.child}e=e.sibling}a.tail!==null&&Yt()>ml&&(t.flags|=128,n=!0,ec(a,!1),t.lanes=4194304)}else{if(!n)if(e=Lh(i),e!==null){if(t.flags|=128,n=!0,r=e.updateQueue,r!==null&&(t.updateQueue=r,t.flags|=4),ec(a,!0),a.tail===null&&a.tailMode==="hidden"&&!i.alternate&&!Ot)return Or(t),null}else 2*Yt()-a.renderingStartTime>ml&&r!==1073741824&&(t.flags|=128,n=!0,ec(a,!1),t.lanes=4194304);a.isBackwards?(i.sibling=t.child,t.child=i):(r=a.last,r!==null?r.sibling=i:t.child=i,a.last=i)}return a.tail!==null?(t=a.tail,a.rendering=t,a.tail=t.sibling,a.renderingStartTime=Yt(),t.sibling=null,r=Lt.current,kt(Lt,n?r&1|2:r&1),t):(Or(t),null);case 22:case 23:return Qg(),n=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==n&&(t.flags|=8192),n&&t.mode&1?Sn&1073741824&&(Or(t),t.subtreeFlags&6&&(t.flags|=8192)):Or(t),null;case 24:return null;case 25:return null}throw Error(Ee(156,t.tag))}function XC(e,t){switch(Rg(t),t.tag){case 1:return yn(t.type)&&Rh(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return hl(),Rt(vn),Rt(Gr),Vg(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return Ug(t),null;case 13:if(Rt(Lt),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(Ee(340));ul()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return Rt(Lt),null;case 4:return hl(),null;case 10:return Og(t.type._context),null;case 22:case 23:return Qg(),null;case 24:return null;default:return null}}var Df=!1,Vr=!1,YC=typeof WeakSet=="function"?WeakSet:Set,Ne=null;function zo(e,t){var r=e.ref;if(r!==null)if(typeof r=="function")try{r(null)}catch(n){Wt(e,t,n)}else r.current=null}function hp(e,t,r){try{r()}catch(n){Wt(e,t,n)}}var xy=!1;function QC(e,t){if(Xm=bh,e=S2(),Ng(e)){if("selectionStart"in e)var r={start:e.selectionStart,end:e.selectionEnd};else e:{r=(r=e.ownerDocument)&&r.defaultView||window;var n=r.getSelection&&r.getSelection();if(n&&n.rangeCount!==0){r=n.anchorNode;var s=n.anchorOffset,a=n.focusNode;n=n.focusOffset;try{r.nodeType,a.nodeType}catch{r=null;break e}var i=0,o=-1,l=-1,u=0,f=0,d=e,m=null;t:for(;;){for(var p;d!==r||s!==0&&d.nodeType!==3||(o=i+s),d!==a||n!==0&&d.nodeType!==3||(l=i+n),d.nodeType===3&&(i+=d.nodeValue.length),(p=d.firstChild)!==null;)m=d,d=p;for(;;){if(d===e)break t;if(m===r&&++u===s&&(o=i),m===a&&++f===n&&(l=i),(p=d.nextSibling)!==null)break;d=m,m=d.parentNode}d=p}r=o===-1||l===-1?null:{start:o,end:l}}else r=null}r=r||{start:0,end:0}}else r=null;for(Ym={focusedElem:e,selectionRange:r},bh=!1,Ne=t;Ne!==null;)if(t=Ne,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,Ne=e;else for(;Ne!==null;){t=Ne;try{var x=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(x!==null){var g=x.memoizedProps,_=x.memoizedState,k=t.stateNode,E=k.getSnapshotBeforeUpdate(t.elementType===t.type?g:ls(t.type,g),_);k.__reactInternalSnapshotBeforeUpdate=E}break;case 3:var y=t.stateNode.containerInfo;y.nodeType===1?y.textContent="":y.nodeType===9&&y.documentElement&&y.removeChild(y.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(Ee(163))}}catch(b){Wt(t,t.return,b)}if(e=t.sibling,e!==null){e.return=t.return,Ne=e;break}Ne=t.return}return x=xy,xy=!1,x}function Ac(e,t,r){var n=t.updateQueue;if(n=n!==null?n.lastEffect:null,n!==null){var s=n=n.next;do{if((s.tag&e)===e){var a=s.destroy;s.destroy=void 0,a!==void 0&&hp(t,r,a)}s=s.next}while(s!==n)}}function Md(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var r=t=t.next;do{if((r.tag&e)===e){var n=r.create;r.destroy=n()}r=r.next}while(r!==t)}}function dp(e){var t=e.ref;if(t!==null){var r=e.stateNode;switch(e.tag){case 5:e=r;break;default:e=r}typeof t=="function"?t(e):t.current=e}}function wT(e){var t=e.alternate;t!==null&&(e.alternate=null,wT(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[Ps],delete t[tu],delete t[Zm],delete t[DC],delete t[FC])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function ET(e){return e.tag===5||e.tag===3||e.tag===4}function vy(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||ET(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function mp(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.nodeType===8?r.parentNode.insertBefore(e,t):r.insertBefore(e,t):(r.nodeType===8?(t=r.parentNode,t.insertBefore(e,r)):(t=r,t.appendChild(e)),r=r._reactRootContainer,r!=null||t.onclick!==null||(t.onclick=Ch));else if(n!==4&&(e=e.child,e!==null))for(mp(e,t,r),e=e.sibling;e!==null;)mp(e,t,r),e=e.sibling}function pp(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.insertBefore(e,t):r.appendChild(e);else if(n!==4&&(e=e.child,e!==null))for(pp(e,t,r),e=e.sibling;e!==null;)pp(e,t,r),e=e.sibling}var Er=null,cs=!1;function Pa(e,t,r){for(r=r.child;r!==null;)TT(e,t,r),r=r.sibling}function TT(e,t,r){if(Os&&typeof Os.onCommitFiberUnmount=="function")try{Os.onCommitFiberUnmount(Id,r)}catch{}switch(r.tag){case 5:Vr||zo(r,t);case 6:var n=Er,s=cs;Er=null,Pa(e,t,r),Er=n,cs=s,Er!==null&&(cs?(e=Er,r=r.stateNode,e.nodeType===8?e.parentNode.removeChild(r):e.removeChild(r)):Er.removeChild(r.stateNode));break;case 18:Er!==null&&(cs?(e=Er,r=r.stateNode,e.nodeType===8?W0(e.parentNode,r):e.nodeType===1&&W0(e,r),Yc(e)):W0(Er,r.stateNode));break;case 4:n=Er,s=cs,Er=r.stateNode.containerInfo,cs=!0,Pa(e,t,r),Er=n,cs=s;break;case 0:case 11:case 14:case 15:if(!Vr&&(n=r.updateQueue,n!==null&&(n=n.lastEffect,n!==null))){s=n=n.next;do{var a=s,i=a.destroy;a=a.tag,i!==void 0&&(a&2||a&4)&&hp(r,t,i),s=s.next}while(s!==n)}Pa(e,t,r);break;case 1:if(!Vr&&(zo(r,t),n=r.stateNode,typeof n.componentWillUnmount=="function"))try{n.props=r.memoizedProps,n.state=r.memoizedState,n.componentWillUnmount()}catch(o){Wt(r,t,o)}Pa(e,t,r);break;case 21:Pa(e,t,r);break;case 22:r.mode&1?(Vr=(n=Vr)||r.memoizedState!==null,Pa(e,t,r),Vr=n):Pa(e,t,r);break;default:Pa(e,t,r)}}function yy(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var r=e.stateNode;r===null&&(r=e.stateNode=new YC),t.forEach(function(n){var s=iR.bind(null,e,n);r.has(n)||(r.add(n),n.then(s,s))})}}function as(e,t){var r=t.deletions;if(r!==null)for(var n=0;n<r.length;n++){var s=r[n];try{var a=e,i=t,o=i;e:for(;o!==null;){switch(o.tag){case 5:Er=o.stateNode,cs=!1;break e;case 3:Er=o.stateNode.containerInfo,cs=!0;break e;case 4:Er=o.stateNode.containerInfo,cs=!0;break e}o=o.return}if(Er===null)throw Error(Ee(160));TT(a,i,s),Er=null,cs=!1;var l=s.alternate;l!==null&&(l.return=null),s.return=null}catch(u){Wt(s,t,u)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)kT(t,e),t=t.sibling}function kT(e,t){var r=e.alternate,n=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(as(t,e),Is(e),n&4){try{Ac(3,e,e.return),Md(3,e)}catch(g){Wt(e,e.return,g)}try{Ac(5,e,e.return)}catch(g){Wt(e,e.return,g)}}break;case 1:as(t,e),Is(e),n&512&&r!==null&&zo(r,r.return);break;case 5:if(as(t,e),Is(e),n&512&&r!==null&&zo(r,r.return),e.flags&32){var s=e.stateNode;try{Gc(s,"")}catch(g){Wt(e,e.return,g)}}if(n&4&&(s=e.stateNode,s!=null)){var a=e.memoizedProps,i=r!==null?r.memoizedProps:a,o=e.type,l=e.updateQueue;if(e.updateQueue=null,l!==null)try{o==="input"&&a.type==="radio"&&a.name!=null&&GE(s,a),Um(o,i);var u=Um(o,a);for(i=0;i<l.length;i+=2){var f=l[i],d=l[i+1];f==="style"?QE(s,d):f==="dangerouslySetInnerHTML"?XE(s,d):f==="children"?Gc(s,d):gg(s,f,d,u)}switch(o){case"input":Fm(s,a);break;case"textarea":KE(s,a);break;case"select":var m=s._wrapperState.wasMultiple;s._wrapperState.wasMultiple=!!a.multiple;var p=a.value;p!=null?Ko(s,!!a.multiple,p,!1):m!==!!a.multiple&&(a.defaultValue!=null?Ko(s,!!a.multiple,a.defaultValue,!0):Ko(s,!!a.multiple,a.multiple?[]:"",!1))}s[tu]=a}catch(g){Wt(e,e.return,g)}}break;case 6:if(as(t,e),Is(e),n&4){if(e.stateNode===null)throw Error(Ee(162));s=e.stateNode,a=e.memoizedProps;try{s.nodeValue=a}catch(g){Wt(e,e.return,g)}}break;case 3:if(as(t,e),Is(e),n&4&&r!==null&&r.memoizedState.isDehydrated)try{Yc(t.containerInfo)}catch(g){Wt(e,e.return,g)}break;case 4:as(t,e),Is(e);break;case 13:as(t,e),Is(e),s=e.child,s.flags&8192&&(a=s.memoizedState!==null,s.stateNode.isHidden=a,!a||s.alternate!==null&&s.alternate.memoizedState!==null||(Xg=Yt())),n&4&&yy(e);break;case 22:if(f=r!==null&&r.memoizedState!==null,e.mode&1?(Vr=(u=Vr)||f,as(t,e),Vr=u):as(t,e),Is(e),n&8192){if(u=e.memoizedState!==null,(e.stateNode.isHidden=u)&&!f&&e.mode&1)for(Ne=e,f=e.child;f!==null;){for(d=Ne=f;Ne!==null;){switch(m=Ne,p=m.child,m.tag){case 0:case 11:case 14:case 15:Ac(4,m,m.return);break;case 1:zo(m,m.return);var x=m.stateNode;if(typeof x.componentWillUnmount=="function"){n=m,r=m.return;try{t=n,x.props=t.memoizedProps,x.state=t.memoizedState,x.componentWillUnmount()}catch(g){Wt(n,r,g)}}break;case 5:zo(m,m.return);break;case 22:if(m.memoizedState!==null){wy(d);continue}}p!==null?(p.return=m,Ne=p):wy(d)}f=f.sibling}e:for(f=null,d=e;;){if(d.tag===5){if(f===null){f=d;try{s=d.stateNode,u?(a=s.style,typeof a.setProperty=="function"?a.setProperty("display","none","important"):a.display="none"):(o=d.stateNode,l=d.memoizedProps.style,i=l!=null&&l.hasOwnProperty("display")?l.display:null,o.style.display=YE("display",i))}catch(g){Wt(e,e.return,g)}}}else if(d.tag===6){if(f===null)try{d.stateNode.nodeValue=u?"":d.memoizedProps}catch(g){Wt(e,e.return,g)}}else if((d.tag!==22&&d.tag!==23||d.memoizedState===null||d===e)&&d.child!==null){d.child.return=d,d=d.child;continue}if(d===e)break e;for(;d.sibling===null;){if(d.return===null||d.return===e)break e;f===d&&(f=null),d=d.return}f===d&&(f=null),d.sibling.return=d.return,d=d.sibling}}break;case 19:as(t,e),Is(e),n&4&&yy(e);break;case 21:break;default:as(t,e),Is(e)}}function Is(e){var t=e.flags;if(t&2){try{e:{for(var r=e.return;r!==null;){if(ET(r)){var n=r;break e}r=r.return}throw Error(Ee(160))}switch(n.tag){case 5:var s=n.stateNode;n.flags&32&&(Gc(s,""),n.flags&=-33);var a=vy(e);pp(e,a,s);break;case 3:case 4:var i=n.stateNode.containerInfo,o=vy(e);mp(e,o,i);break;default:throw Error(Ee(161))}}catch(l){Wt(e,e.return,l)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function JC(e,t,r){Ne=e,ST(e)}function ST(e,t,r){for(var n=(e.mode&1)!==0;Ne!==null;){var s=Ne,a=s.child;if(s.tag===22&&n){var i=s.memoizedState!==null||Df;if(!i){var o=s.alternate,l=o!==null&&o.memoizedState!==null||Vr;o=Df;var u=Vr;if(Df=i,(Vr=l)&&!u)for(Ne=s;Ne!==null;)i=Ne,l=i.child,i.tag===22&&i.memoizedState!==null?Ey(s):l!==null?(l.return=i,Ne=l):Ey(s);for(;a!==null;)Ne=a,ST(a),a=a.sibling;Ne=s,Df=o,Vr=u}_y(e)}else s.subtreeFlags&8772&&a!==null?(a.return=s,Ne=a):_y(e)}}function _y(e){for(;Ne!==null;){var t=Ne;if(t.flags&8772){var r=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:Vr||Md(5,t);break;case 1:var n=t.stateNode;if(t.flags&4&&!Vr)if(r===null)n.componentDidMount();else{var s=t.elementType===t.type?r.memoizedProps:ls(t.type,r.memoizedProps);n.componentDidUpdate(s,r.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var a=t.updateQueue;a!==null&&sy(t,a,n);break;case 3:var i=t.updateQueue;if(i!==null){if(r=null,t.child!==null)switch(t.child.tag){case 5:r=t.child.stateNode;break;case 1:r=t.child.stateNode}sy(t,i,r)}break;case 5:var o=t.stateNode;if(r===null&&t.flags&4){r=o;var l=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&r.focus();break;case"img":l.src&&(r.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var u=t.alternate;if(u!==null){var f=u.memoizedState;if(f!==null){var d=f.dehydrated;d!==null&&Yc(d)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(Ee(163))}Vr||t.flags&512&&dp(t)}catch(m){Wt(t,t.return,m)}}if(t===e){Ne=null;break}if(r=t.sibling,r!==null){r.return=t.return,Ne=r;break}Ne=t.return}}function wy(e){for(;Ne!==null;){var t=Ne;if(t===e){Ne=null;break}var r=t.sibling;if(r!==null){r.return=t.return,Ne=r;break}Ne=t.return}}function Ey(e){for(;Ne!==null;){var t=Ne;try{switch(t.tag){case 0:case 11:case 15:var r=t.return;try{Md(4,t)}catch(l){Wt(t,r,l)}break;case 1:var n=t.stateNode;if(typeof n.componentDidMount=="function"){var s=t.return;try{n.componentDidMount()}catch(l){Wt(t,s,l)}}var a=t.return;try{dp(t)}catch(l){Wt(t,a,l)}break;case 5:var i=t.return;try{dp(t)}catch(l){Wt(t,i,l)}}}catch(l){Wt(t,t.return,l)}if(t===e){Ne=null;break}var o=t.sibling;if(o!==null){o.return=t.return,Ne=o;break}Ne=t.return}}var ZC=Math.ceil,Bh=Aa.ReactCurrentDispatcher,Kg=Aa.ReactCurrentOwner,qn=Aa.ReactCurrentBatchConfig,ot=0,vr=null,sr=null,Ar=0,Sn=0,Ho=_i(0),cr=0,ou=null,Qi=0,jd=0,qg=0,bc=null,mn=null,Xg=0,ml=1/0,ea=null,$h=!1,gp=null,ni=null,Ff=!1,Ka=null,Wh=0,Ic=0,xp=null,lh=-1,ch=0;function tn(){return ot&6?Yt():lh!==-1?lh:lh=Yt()}function si(e){return e.mode&1?ot&2&&Ar!==0?Ar&-Ar:MC.transition!==null?(ch===0&&(ch=c2()),ch):(e=xt,e!==0||(e=window.event,e=e===void 0?16:g2(e.type)),e):1}function vs(e,t,r,n){if(50<Ic)throw Ic=0,xp=null,Error(Ee(185));Ru(e,r,n),(!(ot&2)||e!==vr)&&(e===vr&&(!(ot&2)&&(jd|=r),cr===4&&Va(e,Ar)),_n(e,n),r===1&&ot===0&&!(t.mode&1)&&(ml=Yt()+500,Dd&&wi()))}function _n(e,t){var r=e.callbackNode;MN(e,t);var n=Ah(e,e===vr?Ar:0);if(n===0)r!==null&&R1(r),e.callbackNode=null,e.callbackPriority=0;else if(t=n&-n,e.callbackPriority!==t){if(r!=null&&R1(r),t===1)e.tag===0?OC(Ty.bind(null,e)):O2(Ty.bind(null,e)),RC(function(){!(ot&6)&&wi()}),r=null;else{switch(u2(n)){case 1:r=wg;break;case 4:r=o2;break;case 16:r=Sh;break;case 536870912:r=l2;break;default:r=Sh}r=DT(r,AT.bind(null,e))}e.callbackPriority=t,e.callbackNode=r}}function AT(e,t){if(lh=-1,ch=0,ot&6)throw Error(Ee(327));var r=e.callbackNode;if(Jo()&&e.callbackNode!==r)return null;var n=Ah(e,e===vr?Ar:0);if(n===0)return null;if(n&30||n&e.expiredLanes||t)t=zh(e,n);else{t=n;var s=ot;ot|=2;var a=IT();(vr!==e||Ar!==t)&&(ea=null,ml=Yt()+500,Vi(e,t));do try{rR();break}catch(o){bT(e,o)}while(!0);Fg(),Bh.current=a,ot=s,sr!==null?t=0:(vr=null,Ar=0,t=cr)}if(t!==0){if(t===2&&(s=zm(e),s!==0&&(n=s,t=vp(e,s))),t===1)throw r=ou,Vi(e,0),Va(e,n),_n(e,Yt()),r;if(t===6)Va(e,n);else{if(s=e.current.alternate,!(n&30)&&!eR(s)&&(t=zh(e,n),t===2&&(a=zm(e),a!==0&&(n=a,t=vp(e,a))),t===1))throw r=ou,Vi(e,0),Va(e,n),_n(e,Yt()),r;switch(e.finishedWork=s,e.finishedLanes=n,t){case 0:case 1:throw Error(Ee(345));case 2:Ii(e,mn,ea);break;case 3:if(Va(e,n),(n&130023424)===n&&(t=Xg+500-Yt(),10<t)){if(Ah(e,0)!==0)break;if(s=e.suspendedLanes,(s&n)!==n){tn(),e.pingedLanes|=e.suspendedLanes&s;break}e.timeoutHandle=Jm(Ii.bind(null,e,mn,ea),t);break}Ii(e,mn,ea);break;case 4:if(Va(e,n),(n&4194240)===n)break;for(t=e.eventTimes,s=-1;0<n;){var i=31-xs(n);a=1<<i,i=t[i],i>s&&(s=i),n&=~a}if(n=s,n=Yt()-n,n=(120>n?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*ZC(n/1960))-n,10<n){e.timeoutHandle=Jm(Ii.bind(null,e,mn,ea),n);break}Ii(e,mn,ea);break;case 5:Ii(e,mn,ea);break;default:throw Error(Ee(329))}}}return _n(e,Yt()),e.callbackNode===r?AT.bind(null,e):null}function vp(e,t){var r=bc;return e.current.memoizedState.isDehydrated&&(Vi(e,t).flags|=256),e=zh(e,t),e!==2&&(t=mn,mn=r,t!==null&&yp(t)),e}function yp(e){mn===null?mn=e:mn.push.apply(mn,e)}function eR(e){for(var t=e;;){if(t.flags&16384){var r=t.updateQueue;if(r!==null&&(r=r.stores,r!==null))for(var n=0;n<r.length;n++){var s=r[n],a=s.getSnapshot;s=s.value;try{if(!ws(a(),s))return!1}catch{return!1}}}if(r=t.child,t.subtreeFlags&16384&&r!==null)r.return=t,t=r;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function Va(e,t){for(t&=~qg,t&=~jd,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var r=31-xs(t),n=1<<r;e[r]=-1,t&=~n}}function Ty(e){if(ot&6)throw Error(Ee(327));Jo();var t=Ah(e,0);if(!(t&1))return _n(e,Yt()),null;var r=zh(e,t);if(e.tag!==0&&r===2){var n=zm(e);n!==0&&(t=n,r=vp(e,n))}if(r===1)throw r=ou,Vi(e,0),Va(e,t),_n(e,Yt()),r;if(r===6)throw Error(Ee(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,Ii(e,mn,ea),_n(e,Yt()),null}function Yg(e,t){var r=ot;ot|=1;try{return e(t)}finally{ot=r,ot===0&&(ml=Yt()+500,Dd&&wi())}}function Ji(e){Ka!==null&&Ka.tag===0&&!(ot&6)&&Jo();var t=ot;ot|=1;var r=qn.transition,n=xt;try{if(qn.transition=null,xt=1,e)return e()}finally{xt=n,qn.transition=r,ot=t,!(ot&6)&&wi()}}function Qg(){Sn=Ho.current,Rt(Ho)}function Vi(e,t){e.finishedWork=null,e.finishedLanes=0;var r=e.timeoutHandle;if(r!==-1&&(e.timeoutHandle=-1,CC(r)),sr!==null)for(r=sr.return;r!==null;){var n=r;switch(Rg(n),n.tag){case 1:n=n.type.childContextTypes,n!=null&&Rh();break;case 3:hl(),Rt(vn),Rt(Gr),Vg();break;case 5:Ug(n);break;case 4:hl();break;case 13:Rt(Lt);break;case 19:Rt(Lt);break;case 10:Og(n.type._context);break;case 22:case 23:Qg()}r=r.return}if(vr=e,sr=e=ai(e.current,null),Ar=Sn=t,cr=0,ou=null,qg=jd=Qi=0,mn=bc=null,Fi!==null){for(t=0;t<Fi.length;t++)if(r=Fi[t],n=r.interleaved,n!==null){r.interleaved=null;var s=n.next,a=r.pending;if(a!==null){var i=a.next;a.next=s,n.next=i}r.pending=n}Fi=null}return e}function bT(e,t){do{var r=sr;try{if(Fg(),ah.current=Vh,Uh){for(var n=Ut.memoizedState;n!==null;){var s=n.queue;s!==null&&(s.pending=null),n=n.next}Uh=!1}if(Yi=0,xr=lr=Ut=null,Sc=!1,su=0,Kg.current=null,r===null||r.return===null){cr=1,ou=t,sr=null;break}e:{var a=e,i=r.return,o=r,l=t;if(t=Ar,o.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var u=l,f=o,d=f.tag;if(!(f.mode&1)&&(d===0||d===11||d===15)){var m=f.alternate;m?(f.updateQueue=m.updateQueue,f.memoizedState=m.memoizedState,f.lanes=m.lanes):(f.updateQueue=null,f.memoizedState=null)}var p=uy(i);if(p!==null){p.flags&=-257,fy(p,i,o,a,t),p.mode&1&&cy(a,u,t),t=p,l=u;var x=t.updateQueue;if(x===null){var g=new Set;g.add(l),t.updateQueue=g}else x.add(l);break e}else{if(!(t&1)){cy(a,u,t),Jg();break e}l=Error(Ee(426))}}else if(Ot&&o.mode&1){var _=uy(i);if(_!==null){!(_.flags&65536)&&(_.flags|=256),fy(_,i,o,a,t),Pg(dl(l,o));break e}}a=l=dl(l,o),cr!==4&&(cr=2),bc===null?bc=[a]:bc.push(a),a=i;do{switch(a.tag){case 3:a.flags|=65536,t&=-t,a.lanes|=t;var k=uT(a,l,t);ny(a,k);break e;case 1:o=l;var E=a.type,y=a.stateNode;if(!(a.flags&128)&&(typeof E.getDerivedStateFromError=="function"||y!==null&&typeof y.componentDidCatch=="function"&&(ni===null||!ni.has(y)))){a.flags|=65536,t&=-t,a.lanes|=t;var b=fT(a,o,t);ny(a,b);break e}}a=a.return}while(a!==null)}CT(r)}catch(O){t=O,sr===r&&r!==null&&(sr=r=r.return);continue}break}while(!0)}function IT(){var e=Bh.current;return Bh.current=Vh,e===null?Vh:e}function Jg(){(cr===0||cr===3||cr===2)&&(cr=4),vr===null||!(Qi&268435455)&&!(jd&268435455)||Va(vr,Ar)}function zh(e,t){var r=ot;ot|=2;var n=IT();(vr!==e||Ar!==t)&&(ea=null,Vi(e,t));do try{tR();break}catch(s){bT(e,s)}while(!0);if(Fg(),ot=r,Bh.current=n,sr!==null)throw Error(Ee(261));return vr=null,Ar=0,cr}function tR(){for(;sr!==null;)NT(sr)}function rR(){for(;sr!==null&&!bN();)NT(sr)}function NT(e){var t=PT(e.alternate,e,Sn);e.memoizedProps=e.pendingProps,t===null?CT(e):sr=t,Kg.current=null}function CT(e){var t=e;do{var r=t.alternate;if(e=t.return,t.flags&32768){if(r=XC(r,t),r!==null){r.flags&=32767,sr=r;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{cr=6,sr=null;return}}else if(r=qC(r,t,Sn),r!==null){sr=r;return}if(t=t.sibling,t!==null){sr=t;return}sr=t=e}while(t!==null);cr===0&&(cr=5)}function Ii(e,t,r){var n=xt,s=qn.transition;try{qn.transition=null,xt=1,nR(e,t,r,n)}finally{qn.transition=s,xt=n}return null}function nR(e,t,r,n){do Jo();while(Ka!==null);if(ot&6)throw Error(Ee(327));r=e.finishedWork;var s=e.finishedLanes;if(r===null)return null;if(e.finishedWork=null,e.finishedLanes=0,r===e.current)throw Error(Ee(177));e.callbackNode=null,e.callbackPriority=0;var a=r.lanes|r.childLanes;if(jN(e,a),e===vr&&(sr=vr=null,Ar=0),!(r.subtreeFlags&2064)&&!(r.flags&2064)||Ff||(Ff=!0,DT(Sh,function(){return Jo(),null})),a=(r.flags&15990)!==0,r.subtreeFlags&15990||a){a=qn.transition,qn.transition=null;var i=xt;xt=1;var o=ot;ot|=4,Kg.current=null,QC(e,r),kT(r,e),TC(Ym),bh=!!Xm,Ym=Xm=null,e.current=r,JC(r),IN(),ot=o,xt=i,qn.transition=a}else e.current=r;if(Ff&&(Ff=!1,Ka=e,Wh=s),a=e.pendingLanes,a===0&&(ni=null),RN(r.stateNode),_n(e,Yt()),t!==null)for(n=e.onRecoverableError,r=0;r<t.length;r++)s=t[r],n(s.value,{componentStack:s.stack,digest:s.digest});if($h)throw $h=!1,e=gp,gp=null,e;return Wh&1&&e.tag!==0&&Jo(),a=e.pendingLanes,a&1?e===xp?Ic++:(Ic=0,xp=e):Ic=0,wi(),null}function Jo(){if(Ka!==null){var e=u2(Wh),t=qn.transition,r=xt;try{if(qn.transition=null,xt=16>e?16:e,Ka===null)var n=!1;else{if(e=Ka,Ka=null,Wh=0,ot&6)throw Error(Ee(331));var s=ot;for(ot|=4,Ne=e.current;Ne!==null;){var a=Ne,i=a.child;if(Ne.flags&16){var o=a.deletions;if(o!==null){for(var l=0;l<o.length;l++){var u=o[l];for(Ne=u;Ne!==null;){var f=Ne;switch(f.tag){case 0:case 11:case 15:Ac(8,f,a)}var d=f.child;if(d!==null)d.return=f,Ne=d;else for(;Ne!==null;){f=Ne;var m=f.sibling,p=f.return;if(wT(f),f===u){Ne=null;break}if(m!==null){m.return=p,Ne=m;break}Ne=p}}}var x=a.alternate;if(x!==null){var g=x.child;if(g!==null){x.child=null;do{var _=g.sibling;g.sibling=null,g=_}while(g!==null)}}Ne=a}}if(a.subtreeFlags&2064&&i!==null)i.return=a,Ne=i;else e:for(;Ne!==null;){if(a=Ne,a.flags&2048)switch(a.tag){case 0:case 11:case 15:Ac(9,a,a.return)}var k=a.sibling;if(k!==null){k.return=a.return,Ne=k;break e}Ne=a.return}}var E=e.current;for(Ne=E;Ne!==null;){i=Ne;var y=i.child;if(i.subtreeFlags&2064&&y!==null)y.return=i,Ne=y;else e:for(i=E;Ne!==null;){if(o=Ne,o.flags&2048)try{switch(o.tag){case 0:case 11:case 15:Md(9,o)}}catch(O){Wt(o,o.return,O)}if(o===i){Ne=null;break e}var b=o.sibling;if(b!==null){b.return=o.return,Ne=b;break e}Ne=o.return}}if(ot=s,wi(),Os&&typeof Os.onPostCommitFiberRoot=="function")try{Os.onPostCommitFiberRoot(Id,e)}catch{}n=!0}return n}finally{xt=r,qn.transition=t}}return!1}function ky(e,t,r){t=dl(r,t),t=uT(e,t,1),e=ri(e,t,1),t=tn(),e!==null&&(Ru(e,1,t),_n(e,t))}function Wt(e,t,r){if(e.tag===3)ky(e,e,r);else for(;t!==null;){if(t.tag===3){ky(t,e,r);break}else if(t.tag===1){var n=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof n.componentDidCatch=="function"&&(ni===null||!ni.has(n))){e=dl(r,e),e=fT(t,e,1),t=ri(t,e,1),e=tn(),t!==null&&(Ru(t,1,e),_n(t,e));break}}t=t.return}}function sR(e,t,r){var n=e.pingCache;n!==null&&n.delete(t),t=tn(),e.pingedLanes|=e.suspendedLanes&r,vr===e&&(Ar&r)===r&&(cr===4||cr===3&&(Ar&130023424)===Ar&&500>Yt()-Xg?Vi(e,0):qg|=r),_n(e,t)}function RT(e,t){t===0&&(e.mode&1?(t=kf,kf<<=1,!(kf&130023424)&&(kf=4194304)):t=1);var r=tn();e=ga(e,t),e!==null&&(Ru(e,t,r),_n(e,r))}function aR(e){var t=e.memoizedState,r=0;t!==null&&(r=t.retryLane),RT(e,r)}function iR(e,t){var r=0;switch(e.tag){case 13:var n=e.stateNode,s=e.memoizedState;s!==null&&(r=s.retryLane);break;case 19:n=e.stateNode;break;default:throw Error(Ee(314))}n!==null&&n.delete(t),RT(e,r)}var PT;PT=function(e,t,r){if(e!==null)if(e.memoizedProps!==t.pendingProps||vn.current)gn=!0;else{if(!(e.lanes&r)&&!(t.flags&128))return gn=!1,KC(e,t,r);gn=!!(e.flags&131072)}else gn=!1,Ot&&t.flags&1048576&&M2(t,Fh,t.index);switch(t.lanes=0,t.tag){case 2:var n=t.type;oh(e,t),e=t.pendingProps;var s=cl(t,Gr.current);Qo(t,r),s=$g(null,t,n,e,s,r);var a=Wg();return t.flags|=1,typeof s=="object"&&s!==null&&typeof s.render=="function"&&s.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,yn(n)?(a=!0,Ph(t)):a=!1,t.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,jg(t),s.updater=Od,t.stateNode=s,s._reactInternals=t,ap(t,n,e,r),t=lp(null,t,n,!0,a,r)):(t.tag=0,Ot&&a&&Cg(t),Qr(null,t,s,r),t=t.child),t;case 16:n=t.elementType;e:{switch(oh(e,t),e=t.pendingProps,s=n._init,n=s(n._payload),t.type=n,s=t.tag=lR(n),e=ls(n,e),s){case 0:t=op(null,t,n,e,r);break e;case 1:t=my(null,t,n,e,r);break e;case 11:t=hy(null,t,n,e,r);break e;case 14:t=dy(null,t,n,ls(n.type,e),r);break e}throw Error(Ee(306,n,""))}return t;case 0:return n=t.type,s=t.pendingProps,s=t.elementType===n?s:ls(n,s),op(e,t,n,s,r);case 1:return n=t.type,s=t.pendingProps,s=t.elementType===n?s:ls(n,s),my(e,t,n,s,r);case 3:e:{if(pT(t),e===null)throw Error(Ee(387));n=t.pendingProps,a=t.memoizedState,s=a.element,$2(e,t),jh(t,n,null,r);var i=t.memoizedState;if(n=i.element,a.isDehydrated)if(a={element:n,isDehydrated:!1,cache:i.cache,pendingSuspenseBoundaries:i.pendingSuspenseBoundaries,transitions:i.transitions},t.updateQueue.baseState=a,t.memoizedState=a,t.flags&256){s=dl(Error(Ee(423)),t),t=py(e,t,n,r,s);break e}else if(n!==s){s=dl(Error(Ee(424)),t),t=py(e,t,n,r,s);break e}else for(Nn=ti(t.stateNode.containerInfo.firstChild),Pn=t,Ot=!0,fs=null,r=V2(t,null,n,r),t.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if(ul(),n===s){t=xa(e,t,r);break e}Qr(e,t,n,r)}t=t.child}return t;case 5:return W2(t),e===null&&rp(t),n=t.type,s=t.pendingProps,a=e!==null?e.memoizedProps:null,i=s.children,Qm(n,s)?i=null:a!==null&&Qm(n,a)&&(t.flags|=32),mT(e,t),Qr(e,t,i,r),t.child;case 6:return e===null&&rp(t),null;case 13:return gT(e,t,r);case 4:return Lg(t,t.stateNode.containerInfo),n=t.pendingProps,e===null?t.child=fl(t,null,n,r):Qr(e,t,n,r),t.child;case 11:return n=t.type,s=t.pendingProps,s=t.elementType===n?s:ls(n,s),hy(e,t,n,s,r);case 7:return Qr(e,t,t.pendingProps,r),t.child;case 8:return Qr(e,t,t.pendingProps.children,r),t.child;case 12:return Qr(e,t,t.pendingProps.children,r),t.child;case 10:e:{if(n=t.type._context,s=t.pendingProps,a=t.memoizedProps,i=s.value,kt(Oh,n._currentValue),n._currentValue=i,a!==null)if(ws(a.value,i)){if(a.children===s.children&&!vn.current){t=xa(e,t,r);break e}}else for(a=t.child,a!==null&&(a.return=t);a!==null;){var o=a.dependencies;if(o!==null){i=a.child;for(var l=o.firstContext;l!==null;){if(l.context===n){if(a.tag===1){l=ca(-1,r&-r),l.tag=2;var u=a.updateQueue;if(u!==null){u=u.shared;var f=u.pending;f===null?l.next=l:(l.next=f.next,f.next=l),u.pending=l}}a.lanes|=r,l=a.alternate,l!==null&&(l.lanes|=r),np(a.return,r,t),o.lanes|=r;break}l=l.next}}else if(a.tag===10)i=a.type===t.type?null:a.child;else if(a.tag===18){if(i=a.return,i===null)throw Error(Ee(341));i.lanes|=r,o=i.alternate,o!==null&&(o.lanes|=r),np(i,r,t),i=a.sibling}else i=a.child;if(i!==null)i.return=a;else for(i=a;i!==null;){if(i===t){i=null;break}if(a=i.sibling,a!==null){a.return=i.return,i=a;break}i=i.return}a=i}Qr(e,t,s.children,r),t=t.child}return t;case 9:return s=t.type,n=t.pendingProps.children,Qo(t,r),s=Qn(s),n=n(s),t.flags|=1,Qr(e,t,n,r),t.child;case 14:return n=t.type,s=ls(n,t.pendingProps),s=ls(n.type,s),dy(e,t,n,s,r);case 15:return hT(e,t,t.type,t.pendingProps,r);case 17:return n=t.type,s=t.pendingProps,s=t.elementType===n?s:ls(n,s),oh(e,t),t.tag=1,yn(n)?(e=!0,Ph(t)):e=!1,Qo(t,r),cT(t,n,s),ap(t,n,s,r),lp(null,t,n,!0,e,r);case 19:return xT(e,t,r);case 22:return dT(e,t,r)}throw Error(Ee(156,t.tag))};function DT(e,t){return i2(e,t)}function oR(e,t,r,n){this.tag=e,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Kn(e,t,r,n){return new oR(e,t,r,n)}function Zg(e){return e=e.prototype,!(!e||!e.isReactComponent)}function lR(e){if(typeof e=="function")return Zg(e)?1:0;if(e!=null){if(e=e.$$typeof,e===vg)return 11;if(e===yg)return 14}return 2}function ai(e,t){var r=e.alternate;return r===null?(r=Kn(e.tag,t,e.key,e.mode),r.elementType=e.elementType,r.type=e.type,r.stateNode=e.stateNode,r.alternate=e,e.alternate=r):(r.pendingProps=t,r.type=e.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=e.flags&14680064,r.childLanes=e.childLanes,r.lanes=e.lanes,r.child=e.child,r.memoizedProps=e.memoizedProps,r.memoizedState=e.memoizedState,r.updateQueue=e.updateQueue,t=e.dependencies,r.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},r.sibling=e.sibling,r.index=e.index,r.ref=e.ref,r}function uh(e,t,r,n,s,a){var i=2;if(n=e,typeof e=="function")Zg(e)&&(i=1);else if(typeof e=="string")i=5;else e:switch(e){case Oo:return Bi(r.children,s,a,t);case xg:i=8,s|=8;break;case Nm:return e=Kn(12,r,t,s|2),e.elementType=Nm,e.lanes=a,e;case Cm:return e=Kn(13,r,t,s),e.elementType=Cm,e.lanes=a,e;case Rm:return e=Kn(19,r,t,s),e.elementType=Rm,e.lanes=a,e;case WE:return Ld(r,s,a,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case BE:i=10;break e;case $E:i=9;break e;case vg:i=11;break e;case yg:i=14;break e;case ja:i=16,n=null;break e}throw Error(Ee(130,e==null?e:typeof e,""))}return t=Kn(i,r,t,s),t.elementType=e,t.type=n,t.lanes=a,t}function Bi(e,t,r,n){return e=Kn(7,e,n,t),e.lanes=r,e}function Ld(e,t,r,n){return e=Kn(22,e,n,t),e.elementType=WE,e.lanes=r,e.stateNode={isHidden:!1},e}function Q0(e,t,r){return e=Kn(6,e,null,t),e.lanes=r,e}function J0(e,t,r){return t=Kn(4,e.children!==null?e.children:[],e.key,t),t.lanes=r,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function cR(e,t,r,n,s){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=P0(0),this.expirationTimes=P0(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=P0(0),this.identifierPrefix=n,this.onRecoverableError=s,this.mutableSourceEagerHydrationData=null}function ex(e,t,r,n,s,a,i,o,l){return e=new cR(e,t,r,o,l),t===1?(t=1,a===!0&&(t|=8)):t=0,a=Kn(3,null,null,t),e.current=a,a.stateNode=e,a.memoizedState={element:n,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},jg(a),e}function uR(e,t,r){var n=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Fo,key:n==null?null:""+n,children:e,containerInfo:t,implementation:r}}function FT(e){if(!e)return hi;e=e._reactInternals;e:{if(co(e)!==e||e.tag!==1)throw Error(Ee(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(yn(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(Ee(171))}if(e.tag===1){var r=e.type;if(yn(r))return F2(e,r,t)}return t}function OT(e,t,r,n,s,a,i,o,l){return e=ex(r,n,!0,e,s,a,i,o,l),e.context=FT(null),r=e.current,n=tn(),s=si(r),a=ca(n,s),a.callback=t??null,ri(r,a,s),e.current.lanes=s,Ru(e,s,n),_n(e,n),e}function Ud(e,t,r,n){var s=t.current,a=tn(),i=si(s);return r=FT(r),t.context===null?t.context=r:t.pendingContext=r,t=ca(a,i),t.payload={element:e},n=n===void 0?null:n,n!==null&&(t.callback=n),e=ri(s,t,i),e!==null&&(vs(e,s,i,a),sh(e,s,i)),i}function Hh(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function Sy(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var r=e.retryLane;e.retryLane=r!==0&&r<t?r:t}}function tx(e,t){Sy(e,t),(e=e.alternate)&&Sy(e,t)}function fR(){return null}var MT=typeof reportError=="function"?reportError:function(e){console.error(e)};function rx(e){this._internalRoot=e}Vd.prototype.render=rx.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(Ee(409));Ud(e,t,null,null)};Vd.prototype.unmount=rx.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;Ji(function(){Ud(null,e,null,null)}),t[pa]=null}};function Vd(e){this._internalRoot=e}Vd.prototype.unstable_scheduleHydration=function(e){if(e){var t=d2();e={blockedOn:null,target:e,priority:t};for(var r=0;r<Ua.length&&t!==0&&t<Ua[r].priority;r++);Ua.splice(r,0,e),r===0&&p2(e)}};function nx(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function Bd(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function Ay(){}function hR(e,t,r,n,s){if(s){if(typeof n=="function"){var a=n;n=function(){var u=Hh(i);a.call(u)}}var i=OT(t,n,e,0,null,!1,!1,"",Ay);return e._reactRootContainer=i,e[pa]=i.current,Zc(e.nodeType===8?e.parentNode:e),Ji(),i}for(;s=e.lastChild;)e.removeChild(s);if(typeof n=="function"){var o=n;n=function(){var u=Hh(l);o.call(u)}}var l=ex(e,0,!1,null,null,!1,!1,"",Ay);return e._reactRootContainer=l,e[pa]=l.current,Zc(e.nodeType===8?e.parentNode:e),Ji(function(){Ud(t,l,r,n)}),l}function $d(e,t,r,n,s){var a=r._reactRootContainer;if(a){var i=a;if(typeof s=="function"){var o=s;s=function(){var l=Hh(i);o.call(l)}}Ud(t,i,e,s)}else i=hR(r,t,e,s,n);return Hh(i)}f2=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var r=cc(t.pendingLanes);r!==0&&(Eg(t,r|1),_n(t,Yt()),!(ot&6)&&(ml=Yt()+500,wi()))}break;case 13:Ji(function(){var n=ga(e,1);if(n!==null){var s=tn();vs(n,e,1,s)}}),tx(e,1)}};Tg=function(e){if(e.tag===13){var t=ga(e,134217728);if(t!==null){var r=tn();vs(t,e,134217728,r)}tx(e,134217728)}};h2=function(e){if(e.tag===13){var t=si(e),r=ga(e,t);if(r!==null){var n=tn();vs(r,e,t,n)}tx(e,t)}};d2=function(){return xt};m2=function(e,t){var r=xt;try{return xt=e,t()}finally{xt=r}};Bm=function(e,t,r){switch(t){case"input":if(Fm(e,r),t=r.name,r.type==="radio"&&t!=null){for(r=e;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<r.length;t++){var n=r[t];if(n!==e&&n.form===e.form){var s=Pd(n);if(!s)throw Error(Ee(90));HE(n),Fm(n,s)}}}break;case"textarea":KE(e,r);break;case"select":t=r.value,t!=null&&Ko(e,!!r.multiple,t,!1)}};e2=Yg;t2=Ji;var dR={usingClientEntryPoint:!1,Events:[Du,Uo,Pd,JE,ZE,Yg]},tc={findFiberByHostInstance:Di,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},mR={bundleType:tc.bundleType,version:tc.version,rendererPackageName:tc.rendererPackageName,rendererConfig:tc.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Aa.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=s2(e),e===null?null:e.stateNode},findFiberByHostInstance:tc.findFiberByHostInstance||fR,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Of=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Of.isDisabled&&Of.supportsFiber)try{Id=Of.inject(mR),Os=Of}catch{}}jn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=dR;jn.createPortal=function(e,t){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!nx(t))throw Error(Ee(200));return uR(e,t,null,r)};jn.createRoot=function(e,t){if(!nx(e))throw Error(Ee(299));var r=!1,n="",s=MT;return t!=null&&(t.unstable_strictMode===!0&&(r=!0),t.identifierPrefix!==void 0&&(n=t.identifierPrefix),t.onRecoverableError!==void 0&&(s=t.onRecoverableError)),t=ex(e,1,!1,null,null,r,!1,n,s),e[pa]=t.current,Zc(e.nodeType===8?e.parentNode:e),new rx(t)};jn.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(Ee(188)):(e=Object.keys(e).join(","),Error(Ee(268,e)));return e=s2(t),e=e===null?null:e.stateNode,e};jn.flushSync=function(e){return Ji(e)};jn.hydrate=function(e,t,r){if(!Bd(t))throw Error(Ee(200));return $d(null,e,t,!0,r)};jn.hydrateRoot=function(e,t,r){if(!nx(e))throw Error(Ee(405));var n=r!=null&&r.hydratedSources||null,s=!1,a="",i=MT;if(r!=null&&(r.unstable_strictMode===!0&&(s=!0),r.identifierPrefix!==void 0&&(a=r.identifierPrefix),r.onRecoverableError!==void 0&&(i=r.onRecoverableError)),t=OT(t,null,e,1,r??null,s,!1,a,i),e[pa]=t.current,Zc(e),n)for(e=0;e<n.length;e++)r=n[e],s=r._getVersion,s=s(r._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[r,s]:t.mutableSourceEagerHydrationData.push(r,s);return new Vd(t)};jn.render=function(e,t,r){if(!Bd(t))throw Error(Ee(200));return $d(null,e,t,!1,r)};jn.unmountComponentAtNode=function(e){if(!Bd(e))throw Error(Ee(40));return e._reactRootContainer?(Ji(function(){$d(null,null,e,!1,function(){e._reactRootContainer=null,e[pa]=null})}),!0):!1};jn.unstable_batchedUpdates=Yg;jn.unstable_renderSubtreeIntoContainer=function(e,t,r,n){if(!Bd(r))throw Error(Ee(200));if(e==null||e._reactInternals===void 0)throw Error(Ee(38));return $d(e,t,r,!1,n)};jn.version="18.3.1-next-f1338f8080-20240426";function jT(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(jT)}catch(e){console.error(e)}}jT(),jE.exports=jn;var sx=jE.exports;const pR=SE(sx),gR=kE({__proto__:null,default:pR},[sx]);var by=sx;bm.createRoot=by.createRoot,bm.hydrateRoot=by.hydrateRoot;/**
 * @remix-run/router v1.23.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Dt(){return Dt=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Dt.apply(this,arguments)}var nr;(function(e){e.Pop="POP",e.Push="PUSH",e.Replace="REPLACE"})(nr||(nr={}));const Iy="popstate";function xR(e){e===void 0&&(e={});function t(n,s){let{pathname:a,search:i,hash:o}=n.location;return lu("",{pathname:a,search:i,hash:o},s.state&&s.state.usr||null,s.state&&s.state.key||"default")}function r(n,s){return typeof s=="string"?s:Zi(s)}return yR(t,r,null,e)}function qe(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}function pl(e,t){if(!e){typeof console<"u"&&console.warn(t);try{throw new Error(t)}catch{}}}function vR(){return Math.random().toString(36).substr(2,8)}function Ny(e,t){return{usr:e.state,key:e.key,idx:t}}function lu(e,t,r,n){return r===void 0&&(r=null),Dt({pathname:typeof e=="string"?e:e.pathname,search:"",hash:""},typeof t=="string"?Ei(t):t,{state:r,key:t&&t.key||n||vR()})}function Zi(e){let{pathname:t="/",search:r="",hash:n=""}=e;return r&&r!=="?"&&(t+=r.charAt(0)==="?"?r:"?"+r),n&&n!=="#"&&(t+=n.charAt(0)==="#"?n:"#"+n),t}function Ei(e){let t={};if(e){let r=e.indexOf("#");r>=0&&(t.hash=e.substr(r),e=e.substr(0,r));let n=e.indexOf("?");n>=0&&(t.search=e.substr(n),e=e.substr(0,n)),e&&(t.pathname=e)}return t}function yR(e,t,r,n){n===void 0&&(n={});let{window:s=document.defaultView,v5Compat:a=!1}=n,i=s.history,o=nr.Pop,l=null,u=f();u==null&&(u=0,i.replaceState(Dt({},i.state,{idx:u}),""));function f(){return(i.state||{idx:null}).idx}function d(){o=nr.Pop;let _=f(),k=_==null?null:_-u;u=_,l&&l({action:o,location:g.location,delta:k})}function m(_,k){o=nr.Push;let E=lu(g.location,_,k);u=f()+1;let y=Ny(E,u),b=g.createHref(E);try{i.pushState(y,"",b)}catch(O){if(O instanceof DOMException&&O.name==="DataCloneError")throw O;s.location.assign(b)}a&&l&&l({action:o,location:g.location,delta:1})}function p(_,k){o=nr.Replace;let E=lu(g.location,_,k);u=f();let y=Ny(E,u),b=g.createHref(E);i.replaceState(y,"",b),a&&l&&l({action:o,location:g.location,delta:0})}function x(_){let k=s.location.origin!=="null"?s.location.origin:s.location.href,E=typeof _=="string"?_:Zi(_);return E=E.replace(/ $/,"%20"),qe(k,"No window.location.(origin|href) available to create URL for href: "+E),new URL(E,k)}let g={get action(){return o},get location(){return e(s,i)},listen(_){if(l)throw new Error("A history only accepts one active listener");return s.addEventListener(Iy,d),l=_,()=>{s.removeEventListener(Iy,d),l=null}},createHref(_){return t(s,_)},createURL:x,encodeLocation(_){let k=x(_);return{pathname:k.pathname,search:k.search,hash:k.hash}},push:m,replace:p,go(_){return i.go(_)}};return g}var gt;(function(e){e.data="data",e.deferred="deferred",e.redirect="redirect",e.error="error"})(gt||(gt={}));const _R=new Set(["lazy","caseSensitive","path","id","index","children"]);function wR(e){return e.index===!0}function Gh(e,t,r,n){return r===void 0&&(r=[]),n===void 0&&(n={}),e.map((s,a)=>{let i=[...r,String(a)],o=typeof s.id=="string"?s.id:i.join("-");if(qe(s.index!==!0||!s.children,"Cannot specify children on an index route"),qe(!n[o],'Found a route id collision on id "'+o+`".  Route id's must be globally unique within Data Router usages`),wR(s)){let l=Dt({},s,t(s),{id:o});return n[o]=l,l}else{let l=Dt({},s,t(s),{id:o,children:void 0});return n[o]=l,s.children&&(l.children=Gh(s.children,t,i,n)),l}})}function Ci(e,t,r){return r===void 0&&(r="/"),fh(e,t,r,!1)}function fh(e,t,r,n){let s=typeof t=="string"?Ei(t):t,a=va(s.pathname||"/",r);if(a==null)return null;let i=LT(e);TR(i);let o=null;for(let l=0;o==null&&l<i.length;++l){let u=FR(a);o=PR(i[l],u,n)}return o}function ER(e,t){let{route:r,pathname:n,params:s}=e;return{id:r.id,pathname:n,params:s,data:t[r.id],handle:r.handle}}function LT(e,t,r,n){t===void 0&&(t=[]),r===void 0&&(r=[]),n===void 0&&(n="");let s=(a,i,o)=>{let l={relativePath:o===void 0?a.path||"":o,caseSensitive:a.caseSensitive===!0,childrenIndex:i,route:a};l.relativePath.startsWith("/")&&(qe(l.relativePath.startsWith(n),'Absolute route path "'+l.relativePath+'" nested under path '+('"'+n+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),l.relativePath=l.relativePath.slice(n.length));let u=ua([n,l.relativePath]),f=r.concat(l);a.children&&a.children.length>0&&(qe(a.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+u+'".')),LT(a.children,t,f,u)),!(a.path==null&&!a.index)&&t.push({path:u,score:CR(u,a.index),routesMeta:f})};return e.forEach((a,i)=>{var o;if(a.path===""||!((o=a.path)!=null&&o.includes("?")))s(a,i);else for(let l of UT(a.path))s(a,i,l)}),t}function UT(e){let t=e.split("/");if(t.length===0)return[];let[r,...n]=t,s=r.endsWith("?"),a=r.replace(/\?$/,"");if(n.length===0)return s?[a,""]:[a];let i=UT(n.join("/")),o=[];return o.push(...i.map(l=>l===""?a:[a,l].join("/"))),s&&o.push(...i),o.map(l=>e.startsWith("/")&&l===""?"/":l)}function TR(e){e.sort((t,r)=>t.score!==r.score?r.score-t.score:RR(t.routesMeta.map(n=>n.childrenIndex),r.routesMeta.map(n=>n.childrenIndex)))}const kR=/^:[\w-]+$/,SR=3,AR=2,bR=1,IR=10,NR=-2,Cy=e=>e==="*";function CR(e,t){let r=e.split("/"),n=r.length;return r.some(Cy)&&(n+=NR),t&&(n+=AR),r.filter(s=>!Cy(s)).reduce((s,a)=>s+(kR.test(a)?SR:a===""?bR:IR),n)}function RR(e,t){return e.length===t.length&&e.slice(0,-1).every((n,s)=>n===t[s])?e[e.length-1]-t[t.length-1]:0}function PR(e,t,r){r===void 0&&(r=!1);let{routesMeta:n}=e,s={},a="/",i=[];for(let o=0;o<n.length;++o){let l=n[o],u=o===n.length-1,f=a==="/"?t:t.slice(a.length)||"/",d=Kh({path:l.relativePath,caseSensitive:l.caseSensitive,end:u},f),m=l.route;if(!d&&u&&r&&!n[n.length-1].route.index&&(d=Kh({path:l.relativePath,caseSensitive:l.caseSensitive,end:!1},f)),!d)return null;Object.assign(s,d.params),i.push({params:s,pathname:ua([a,d.pathname]),pathnameBase:jR(ua([a,d.pathnameBase])),route:m}),d.pathnameBase!=="/"&&(a=ua([a,d.pathnameBase]))}return i}function Kh(e,t){typeof e=="string"&&(e={path:e,caseSensitive:!1,end:!0});let[r,n]=DR(e.path,e.caseSensitive,e.end),s=t.match(r);if(!s)return null;let a=s[0],i=a.replace(/(.)\/+$/,"$1"),o=s.slice(1);return{params:n.reduce((u,f,d)=>{let{paramName:m,isOptional:p}=f;if(m==="*"){let g=o[d]||"";i=a.slice(0,a.length-g.length).replace(/(.)\/+$/,"$1")}const x=o[d];return p&&!x?u[m]=void 0:u[m]=(x||"").replace(/%2F/g,"/"),u},{}),pathname:a,pathnameBase:i,pattern:e}}function DR(e,t,r){t===void 0&&(t=!1),r===void 0&&(r=!0),pl(e==="*"||!e.endsWith("*")||e.endsWith("/*"),'Route path "'+e+'" will be treated as if it were '+('"'+e.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+e.replace(/\*$/,"/*")+'".'));let n=[],s="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(i,o,l)=>(n.push({paramName:o,isOptional:l!=null}),l?"/?([^\\/]+)?":"/([^\\/]+)"));return e.endsWith("*")?(n.push({paramName:"*"}),s+=e==="*"||e==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):r?s+="\\/*$":e!==""&&e!=="/"&&(s+="(?:(?=\\/|$))"),[new RegExp(s,t?void 0:"i"),n]}function FR(e){try{return e.split("/").map(t=>decodeURIComponent(t).replace(/\//g,"%2F")).join("/")}catch(t){return pl(!1,'The URL path "'+e+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+t+").")),e}}function va(e,t){if(t==="/")return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let r=t.endsWith("/")?t.length-1:t.length,n=e.charAt(r);return n&&n!=="/"?null:e.slice(r)||"/"}function OR(e,t){t===void 0&&(t="/");let{pathname:r,search:n="",hash:s=""}=typeof e=="string"?Ei(e):e;return{pathname:r?r.startsWith("/")?r:MR(r,t):t,search:LR(n),hash:UR(s)}}function MR(e,t){let r=t.replace(/\/+$/,"").split("/");return e.split("/").forEach(s=>{s===".."?r.length>1&&r.pop():s!=="."&&r.push(s)}),r.length>1?r.join("/"):"/"}function Z0(e,t,r,n){return"Cannot include a '"+e+"' character in a manually specified "+("`to."+t+"` field ["+JSON.stringify(n)+"].  Please separate it out to the ")+("`to."+r+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function VT(e){return e.filter((t,r)=>r===0||t.route.path&&t.route.path.length>0)}function Wd(e,t){let r=VT(e);return t?r.map((n,s)=>s===r.length-1?n.pathname:n.pathnameBase):r.map(n=>n.pathnameBase)}function zd(e,t,r,n){n===void 0&&(n=!1);let s;typeof e=="string"?s=Ei(e):(s=Dt({},e),qe(!s.pathname||!s.pathname.includes("?"),Z0("?","pathname","search",s)),qe(!s.pathname||!s.pathname.includes("#"),Z0("#","pathname","hash",s)),qe(!s.search||!s.search.includes("#"),Z0("#","search","hash",s)));let a=e===""||s.pathname==="",i=a?"/":s.pathname,o;if(i==null)o=r;else{let d=t.length-1;if(!n&&i.startsWith("..")){let m=i.split("/");for(;m[0]==="..";)m.shift(),d-=1;s.pathname=m.join("/")}o=d>=0?t[d]:"/"}let l=OR(s,o),u=i&&i!=="/"&&i.endsWith("/"),f=(a||i===".")&&r.endsWith("/");return!l.pathname.endsWith("/")&&(u||f)&&(l.pathname+="/"),l}const ua=e=>e.join("/").replace(/\/\/+/g,"/"),jR=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),LR=e=>!e||e==="?"?"":e.startsWith("?")?e:"?"+e,UR=e=>!e||e==="#"?"":e.startsWith("#")?e:"#"+e;class qh{constructor(t,r,n,s){s===void 0&&(s=!1),this.status=t,this.statusText=r||"",this.internal=s,n instanceof Error?(this.data=n.toString(),this.error=n):this.data=n}}function cu(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.internal=="boolean"&&"data"in e}const BT=["post","put","patch","delete"],VR=new Set(BT),BR=["get",...BT],$R=new Set(BR),WR=new Set([301,302,303,307,308]),zR=new Set([307,308]),em={state:"idle",location:void 0,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0},HR={state:"idle",data:void 0,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0},rc={state:"unblocked",proceed:void 0,reset:void 0,location:void 0},ax=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,GR=e=>({hasErrorBoundary:!!e.hasErrorBoundary}),$T="remix-router-transitions";function KR(e){const t=e.window?e.window:typeof window<"u"?window:void 0,r=typeof t<"u"&&typeof t.document<"u"&&typeof t.document.createElement<"u",n=!r;qe(e.routes.length>0,"You must provide a non-empty routes array to createRouter");let s;if(e.mapRouteProperties)s=e.mapRouteProperties;else if(e.detectErrorBoundary){let Q=e.detectErrorBoundary;s=ne=>({hasErrorBoundary:Q(ne)})}else s=GR;let a={},i=Gh(e.routes,s,void 0,a),o,l=e.basename||"/",u=e.dataStrategy||QR,f=e.patchRoutesOnNavigation,d=Dt({v7_fetcherPersist:!1,v7_normalizeFormMethod:!1,v7_partialHydration:!1,v7_prependBasename:!1,v7_relativeSplatPath:!1,v7_skipActionErrorRevalidation:!1},e.future),m=null,p=new Set,x=null,g=null,_=null,k=e.hydrationData!=null,E=Ci(i,e.history.location,l),y=!1,b=null;if(E==null&&!f){let Q=hn(404,{pathname:e.history.location.pathname}),{matches:ne,route:ue}=By(i);E=ne,b={[ue.id]:Q}}E&&!e.hydrationData&&Qs(E,i,e.history.location.pathname).active&&(E=null);let O;if(E)if(E.some(Q=>Q.route.lazy))O=!1;else if(!E.some(Q=>Q.route.loader))O=!0;else if(d.v7_partialHydration){let Q=e.hydrationData?e.hydrationData.loaderData:null,ne=e.hydrationData?e.hydrationData.errors:null;if(ne){let ue=E.findIndex(ve=>ne[ve.route.id]!==void 0);O=E.slice(0,ue+1).every(ve=>!wp(ve.route,Q,ne))}else O=E.every(ue=>!wp(ue.route,Q,ne))}else O=e.hydrationData!=null;else if(O=!1,E=[],d.v7_partialHydration){let Q=Qs(null,i,e.history.location.pathname);Q.active&&Q.matches&&(y=!0,E=Q.matches)}let D,v={historyAction:e.history.action,location:e.history.location,matches:E,initialized:O,navigation:em,restoreScrollPosition:e.hydrationData!=null?!1:null,preventScrollReset:!1,revalidation:"idle",loaderData:e.hydrationData&&e.hydrationData.loaderData||{},actionData:e.hydrationData&&e.hydrationData.actionData||null,errors:e.hydrationData&&e.hydrationData.errors||b,fetchers:new Map,blockers:new Map},T=nr.Pop,S=!1,N,C=!1,R=new Map,F=null,oe=!1,te=!1,de=[],ae=new Set,X=new Map,H=0,Z=-1,Y=new Map,M=new Set,q=new Map,K=new Map,L=new Set,J=new Map,fe=new Map,we;function ge(){if(m=e.history.listen(Q=>{let{action:ne,location:ue,delta:ve}=Q;if(we){we(),we=void 0;return}pl(fe.size===0||ve!=null,"You are trying to use a blocker on a POP navigation to a location that was not created by @remix-run/router. This will fail silently in production. This can happen if you are navigating outside the router via `window.history.pushState`/`window.location.hash` instead of using router navigation APIs.  This can also happen if you are using createHashRouter and the user manually changes the URL.");let be=Na({currentLocation:v.location,nextLocation:ue,historyAction:ne});if(be&&ve!=null){let I=new Promise(W=>{we=W});e.history.go(ve*-1),Ss(be,{state:"blocked",location:ue,proceed(){Ss(be,{state:"proceeding",proceed:void 0,reset:void 0,location:ue}),I.then(()=>e.history.go(ve))},reset(){let W=new Map(v.blockers);W.set(be,rc),G({blockers:W})}});return}return Oe(ne,ue)}),r){f4(t,R);let Q=()=>h4(t,R);t.addEventListener("pagehide",Q),F=()=>t.removeEventListener("pagehide",Q)}return v.initialized||Oe(nr.Pop,v.location,{initialHydration:!0}),D}function pe(){m&&m(),F&&F(),p.clear(),N&&N.abort(),v.fetchers.forEach((Q,ne)=>wt(ne)),v.blockers.forEach((Q,ne)=>qs(ne))}function Pe(Q){return p.add(Q),()=>p.delete(Q)}function G(Q,ne){ne===void 0&&(ne={}),v=Dt({},v,Q);let ue=[],ve=[];d.v7_fetcherPersist&&v.fetchers.forEach((be,I)=>{be.state==="idle"&&(L.has(I)?ve.push(I):ue.push(I))}),L.forEach(be=>{!v.fetchers.has(be)&&!X.has(be)&&ve.push(be)}),[...p].forEach(be=>be(v,{deletedFetchers:ve,viewTransitionOpts:ne.viewTransitionOpts,flushSync:ne.flushSync===!0})),d.v7_fetcherPersist?(ue.forEach(be=>v.fetchers.delete(be)),ve.forEach(be=>wt(be))):ve.forEach(be=>L.delete(be))}function Xe(Q,ne,ue){var ve,be;let{flushSync:I}=ue===void 0?{}:ue,W=v.actionData!=null&&v.navigation.formMethod!=null&&us(v.navigation.formMethod)&&v.navigation.state==="loading"&&((ve=Q.state)==null?void 0:ve._isRedirect)!==!0,P;ne.actionData?Object.keys(ne.actionData).length>0?P=ne.actionData:P=null:W?P=v.actionData:P=null;let j=ne.loaderData?Uy(v.loaderData,ne.loaderData,ne.matches||[],ne.errors):v.loaderData,V=v.blockers;V.size>0&&(V=new Map(V),V.forEach((le,ie)=>V.set(ie,rc)));let B=S===!0||v.navigation.formMethod!=null&&us(v.navigation.formMethod)&&((be=Q.state)==null?void 0:be._isRedirect)!==!0;o&&(i=o,o=void 0),oe||T===nr.Pop||(T===nr.Push?e.history.push(Q,Q.state):T===nr.Replace&&e.history.replace(Q,Q.state));let ee;if(T===nr.Pop){let le=R.get(v.location.pathname);le&&le.has(Q.pathname)?ee={currentLocation:v.location,nextLocation:Q}:R.has(Q.pathname)&&(ee={currentLocation:Q,nextLocation:v.location})}else if(C){let le=R.get(v.location.pathname);le?le.add(Q.pathname):(le=new Set([Q.pathname]),R.set(v.location.pathname,le)),ee={currentLocation:v.location,nextLocation:Q}}G(Dt({},ne,{actionData:P,loaderData:j,historyAction:T,location:Q,initialized:!0,navigation:em,revalidation:"idle",restoreScrollPosition:Ys(Q,ne.matches||v.matches),preventScrollReset:B,blockers:V}),{viewTransitionOpts:ee,flushSync:I===!0}),T=nr.Pop,S=!1,C=!1,oe=!1,te=!1,de=[]}async function Ve(Q,ne){if(typeof Q=="number"){e.history.go(Q);return}let ue=_p(v.location,v.matches,l,d.v7_prependBasename,Q,d.v7_relativeSplatPath,ne==null?void 0:ne.fromRouteId,ne==null?void 0:ne.relative),{path:ve,submission:be,error:I}=Ry(d.v7_normalizeFormMethod,!1,ue,ne),W=v.location,P=lu(v.location,ve,ne&&ne.state);P=Dt({},P,e.history.encodeLocation(P));let j=ne&&ne.replace!=null?ne.replace:void 0,V=nr.Push;j===!0?V=nr.Replace:j===!1||be!=null&&us(be.formMethod)&&be.formAction===v.location.pathname+v.location.search&&(V=nr.Replace);let B=ne&&"preventScrollReset"in ne?ne.preventScrollReset===!0:void 0,ee=(ne&&ne.flushSync)===!0,le=Na({currentLocation:W,nextLocation:P,historyAction:V});if(le){Ss(le,{state:"blocked",location:P,proceed(){Ss(le,{state:"proceeding",proceed:void 0,reset:void 0,location:P}),Ve(Q,ne)},reset(){let ie=new Map(v.blockers);ie.set(le,rc),G({blockers:ie})}});return}return await Oe(V,P,{submission:be,pendingError:I,preventScrollReset:B,replace:ne&&ne.replace,enableViewTransition:ne&&ne.viewTransition,flushSync:ee})}function Ze(){if(bt(),G({revalidation:"loading"}),v.navigation.state!=="submitting"){if(v.navigation.state==="idle"){Oe(v.historyAction,v.location,{startUninterruptedRevalidation:!0});return}Oe(T||v.historyAction,v.navigation.location,{overrideNavigation:v.navigation,enableViewTransition:C===!0})}}async function Oe(Q,ne,ue){N&&N.abort(),N=null,T=Q,oe=(ue&&ue.startUninterruptedRevalidation)===!0,Eo(v.location,v.matches),S=(ue&&ue.preventScrollReset)===!0,C=(ue&&ue.enableViewTransition)===!0;let ve=o||i,be=ue&&ue.overrideNavigation,I=ue!=null&&ue.initialHydration&&v.matches&&v.matches.length>0&&!y?v.matches:Ci(ve,ne,l),W=(ue&&ue.flushSync)===!0;if(I&&v.initialized&&!te&&n4(v.location,ne)&&!(ue&&ue.submission&&us(ue.submission.formMethod))){Xe(ne,{matches:I},{flushSync:W});return}let P=Qs(I,ve,ne.pathname);if(P.active&&P.matches&&(I=P.matches),!I){let{error:se,notFoundMatches:re,route:me}=ns(ne.pathname);Xe(ne,{matches:re,loaderData:{},errors:{[me.id]:se}},{flushSync:W});return}N=new AbortController;let j=Io(e.history,ne,N.signal,ue&&ue.submission),V;if(ue&&ue.pendingError)V=[Ri(I).route.id,{type:gt.error,error:ue.pendingError}];else if(ue&&ue.submission&&us(ue.submission.formMethod)){let se=await Se(j,ne,ue.submission,I,P.active,{replace:ue.replace,flushSync:W});if(se.shortCircuited)return;if(se.pendingActionResult){let[re,me]=se.pendingActionResult;if(An(me)&&cu(me.error)&&me.error.status===404){N=null,Xe(ne,{matches:se.matches,loaderData:{},errors:{[re]:me.error}});return}}I=se.matches||I,V=se.pendingActionResult,be=tm(ne,ue.submission),W=!1,P.active=!1,j=Io(e.history,j.url,j.signal)}let{shortCircuited:B,matches:ee,loaderData:le,errors:ie}=await yt(j,ne,I,P.active,be,ue&&ue.submission,ue&&ue.fetcherSubmission,ue&&ue.replace,ue&&ue.initialHydration===!0,W,V);B||(N=null,Xe(ne,Dt({matches:ee||I},Vy(V),{loaderData:le,errors:ie})))}async function Se(Q,ne,ue,ve,be,I){I===void 0&&(I={}),bt();let W=c4(ne,ue);if(G({navigation:W},{flushSync:I.flushSync===!0}),be){let V=await Vn(ve,ne.pathname,Q.signal);if(V.type==="aborted")return{shortCircuited:!0};if(V.type==="error"){let B=Ri(V.partialMatches).route.id;return{matches:V.partialMatches,pendingActionResult:[B,{type:gt.error,error:V.error}]}}else if(V.matches)ve=V.matches;else{let{notFoundMatches:B,error:ee,route:le}=ns(ne.pathname);return{matches:B,pendingActionResult:[le.id,{type:gt.error,error:ee}]}}}let P,j=fc(ve,ne);if(!j.route.action&&!j.route.lazy)P={type:gt.error,error:hn(405,{method:Q.method,pathname:ne.pathname,routeId:j.route.id})};else if(P=(await mr("action",v,Q,[j],ve,null))[j.route.id],Q.signal.aborted)return{shortCircuited:!0};if(Mi(P)){let V;return I&&I.replace!=null?V=I.replace:V=My(P.response.headers.get("Location"),new URL(Q.url),l)===v.location.pathname+v.location.search,await At(Q,P,!0,{submission:ue,replace:V}),{shortCircuited:!0}}if(qa(P))throw hn(400,{type:"defer-action"});if(An(P)){let V=Ri(ve,j.route.id);return(I&&I.replace)!==!0&&(T=nr.Push),{matches:ve,pendingActionResult:[V.route.id,P]}}return{matches:ve,pendingActionResult:[j.route.id,P]}}async function yt(Q,ne,ue,ve,be,I,W,P,j,V,B){let ee=be||tm(ne,I),le=I||W||Wy(ee),ie=!oe&&(!d.v7_partialHydration||!j);if(ve){if(ie){let ht=Qt(B);G(Dt({navigation:ee},ht!==void 0?{actionData:ht}:{}),{flushSync:V})}let Ke=await Vn(ue,ne.pathname,Q.signal);if(Ke.type==="aborted")return{shortCircuited:!0};if(Ke.type==="error"){let ht=Ri(Ke.partialMatches).route.id;return{matches:Ke.partialMatches,loaderData:{},errors:{[ht]:Ke.error}}}else if(Ke.matches)ue=Ke.matches;else{let{error:ht,notFoundMatches:_r,route:Bn}=ns(ne.pathname);return{matches:_r,loaderData:{},errors:{[Bn.id]:ht}}}}let se=o||i,[re,me]=Dy(e.history,v,ue,le,ne,d.v7_partialHydration&&j===!0,d.v7_skipActionErrorRevalidation,te,de,ae,L,q,M,se,l,B);if(Xs(Ke=>!(ue&&ue.some(ht=>ht.route.id===Ke))||re&&re.some(ht=>ht.route.id===Ke)),Z=++H,re.length===0&&me.length===0){let Ke=Ks();return Xe(ne,Dt({matches:ue,loaderData:{},errors:B&&An(B[1])?{[B[0]]:B[1].error}:null},Vy(B),Ke?{fetchers:new Map(v.fetchers)}:{}),{flushSync:V}),{shortCircuited:!0}}if(ie){let Ke={};if(!ve){Ke.navigation=ee;let ht=Qt(B);ht!==void 0&&(Ke.actionData=ht)}me.length>0&&(Ke.fetchers=dr(me)),G(Ke,{flushSync:V})}me.forEach(Ke=>{ft(Ke.key),Ke.controller&&X.set(Ke.key,Ke.controller)});let Te=()=>me.forEach(Ke=>ft(Ke.key));N&&N.signal.addEventListener("abort",Te);let{loaderResults:Ie,fetcherResults:ye}=await _t(v,ue,re,me,Q);if(Q.signal.aborted)return{shortCircuited:!0};N&&N.signal.removeEventListener("abort",Te),me.forEach(Ke=>X.delete(Ke.key));let ke=Mf(Ie);if(ke)return await At(Q,ke.result,!0,{replace:P}),{shortCircuited:!0};if(ke=Mf(ye),ke)return M.add(ke.key),await At(Q,ke.result,!0,{replace:P}),{shortCircuited:!0};let{loaderData:Me,errors:it}=Ly(v,ue,Ie,B,me,ye,J);J.forEach((Ke,ht)=>{Ke.subscribe(_r=>{(_r||Ke.done)&&J.delete(ht)})}),d.v7_partialHydration&&j&&v.errors&&(it=Dt({},v.errors,it));let Ye=Ks(),pt=wo(Z),fn=Ye||pt||me.length>0;return Dt({matches:ue,loaderData:Me,errors:it},fn?{fetchers:new Map(v.fetchers)}:{})}function Qt(Q){if(Q&&!An(Q[1]))return{[Q[0]]:Q[1].data};if(v.actionData)return Object.keys(v.actionData).length===0?null:v.actionData}function dr(Q){return Q.forEach(ne=>{let ue=v.fetchers.get(ne.key),ve=nc(void 0,ue?ue.data:void 0);v.fetchers.set(ne.key,ve)}),new Map(v.fetchers)}function cn(Q,ne,ue,ve){if(n)throw new Error("router.fetch() was called during the server render, but it shouldn't be. You are likely calling a useFetcher() method in the body of your component. Try moving it to a useEffect or a callback.");ft(Q);let be=(ve&&ve.flushSync)===!0,I=o||i,W=_p(v.location,v.matches,l,d.v7_prependBasename,ue,d.v7_relativeSplatPath,ne,ve==null?void 0:ve.relative),P=Ci(I,W,l),j=Qs(P,I,W);if(j.active&&j.matches&&(P=j.matches),!P){jt(Q,ne,hn(404,{pathname:W}),{flushSync:be});return}let{path:V,submission:B,error:ee}=Ry(d.v7_normalizeFormMethod,!0,W,ve);if(ee){jt(Q,ne,ee,{flushSync:be});return}let le=fc(P,V),ie=(ve&&ve.preventScrollReset)===!0;if(B&&us(B.formMethod)){Gs(Q,ne,V,le,P,j.active,be,ie,B);return}q.set(Q,{routeId:ne,path:V}),un(Q,ne,V,le,P,j.active,be,ie,B)}async function Gs(Q,ne,ue,ve,be,I,W,P,j){bt(),q.delete(Q);function V(rt){if(!rt.route.action&&!rt.route.lazy){let bs=hn(405,{method:j.formMethod,pathname:ue,routeId:ne});return jt(Q,ne,bs,{flushSync:W}),!0}return!1}if(!I&&V(ve))return;let B=v.fetchers.get(Q);mt(Q,u4(j,B),{flushSync:W});let ee=new AbortController,le=Io(e.history,ue,ee.signal,j);if(I){let rt=await Vn(be,new URL(le.url).pathname,le.signal,Q);if(rt.type==="aborted")return;if(rt.type==="error"){jt(Q,ne,rt.error,{flushSync:W});return}else if(rt.matches){if(be=rt.matches,ve=fc(be,ue),V(ve))return}else{jt(Q,ne,hn(404,{pathname:ue}),{flushSync:W});return}}X.set(Q,ee);let ie=H,re=(await mr("action",v,le,[ve],be,Q))[ve.route.id];if(le.signal.aborted){X.get(Q)===ee&&X.delete(Q);return}if(d.v7_fetcherPersist&&L.has(Q)){if(Mi(re)||An(re)){mt(Q,Ma(void 0));return}}else{if(Mi(re))if(X.delete(Q),Z>ie){mt(Q,Ma(void 0));return}else return M.add(Q),mt(Q,nc(j)),At(le,re,!1,{fetcherSubmission:j,preventScrollReset:P});if(An(re)){jt(Q,ne,re.error);return}}if(qa(re))throw hn(400,{type:"defer-action"});let me=v.navigation.location||v.location,Te=Io(e.history,me,ee.signal),Ie=o||i,ye=v.navigation.state!=="idle"?Ci(Ie,v.navigation.location,l):v.matches;qe(ye,"Didn't find any matches after fetcher action");let ke=++H;Y.set(Q,ke);let Me=nc(j,re.data);v.fetchers.set(Q,Me);let[it,Ye]=Dy(e.history,v,ye,j,me,!1,d.v7_skipActionErrorRevalidation,te,de,ae,L,q,M,Ie,l,[ve.route.id,re]);Ye.filter(rt=>rt.key!==Q).forEach(rt=>{let bs=rt.key,Vl=v.fetchers.get(bs),of=nc(void 0,Vl?Vl.data:void 0);v.fetchers.set(bs,of),ft(bs),rt.controller&&X.set(bs,rt.controller)}),G({fetchers:new Map(v.fetchers)});let pt=()=>Ye.forEach(rt=>ft(rt.key));ee.signal.addEventListener("abort",pt);let{loaderResults:fn,fetcherResults:Ke}=await _t(v,ye,it,Ye,Te);if(ee.signal.aborted)return;ee.signal.removeEventListener("abort",pt),Y.delete(Q),X.delete(Q),Ye.forEach(rt=>X.delete(rt.key));let ht=Mf(fn);if(ht)return At(Te,ht.result,!1,{preventScrollReset:P});if(ht=Mf(Ke),ht)return M.add(ht.key),At(Te,ht.result,!1,{preventScrollReset:P});let{loaderData:_r,errors:Bn}=Ly(v,ye,fn,void 0,Ye,Ke,J);if(v.fetchers.has(Q)){let rt=Ma(re.data);v.fetchers.set(Q,rt)}wo(ke),v.navigation.state==="loading"&&ke>Z?(qe(T,"Expected pending action"),N&&N.abort(),Xe(v.navigation.location,{matches:ye,loaderData:_r,errors:Bn,fetchers:new Map(v.fetchers)})):(G({errors:Bn,loaderData:Uy(v.loaderData,_r,ye,Bn),fetchers:new Map(v.fetchers)}),te=!1)}async function un(Q,ne,ue,ve,be,I,W,P,j){let V=v.fetchers.get(Q);mt(Q,nc(j,V?V.data:void 0),{flushSync:W});let B=new AbortController,ee=Io(e.history,ue,B.signal);if(I){let re=await Vn(be,new URL(ee.url).pathname,ee.signal,Q);if(re.type==="aborted")return;if(re.type==="error"){jt(Q,ne,re.error,{flushSync:W});return}else if(re.matches)be=re.matches,ve=fc(be,ue);else{jt(Q,ne,hn(404,{pathname:ue}),{flushSync:W});return}}X.set(Q,B);let le=H,se=(await mr("loader",v,ee,[ve],be,Q))[ve.route.id];if(qa(se)&&(se=await ix(se,ee.signal,!0)||se),X.get(Q)===B&&X.delete(Q),!ee.signal.aborted){if(L.has(Q)){mt(Q,Ma(void 0));return}if(Mi(se))if(Z>le){mt(Q,Ma(void 0));return}else{M.add(Q),await At(ee,se,!1,{preventScrollReset:P});return}if(An(se)){jt(Q,ne,se.error);return}qe(!qa(se),"Unhandled fetcher deferred data"),mt(Q,Ma(se.data))}}async function At(Q,ne,ue,ve){let{submission:be,fetcherSubmission:I,preventScrollReset:W,replace:P}=ve===void 0?{}:ve;ne.response.headers.has("X-Remix-Revalidate")&&(te=!0);let j=ne.response.headers.get("Location");qe(j,"Expected a Location header on the redirect Response"),j=My(j,new URL(Q.url),l);let V=lu(v.location,j,{_isRedirect:!0});if(r){let re=!1;if(ne.response.headers.has("X-Remix-Reload-Document"))re=!0;else if(ax.test(j)){const me=e.history.createURL(j);re=me.origin!==t.location.origin||va(me.pathname,l)==null}if(re){P?t.location.replace(j):t.location.assign(j);return}}N=null;let B=P===!0||ne.response.headers.has("X-Remix-Replace")?nr.Replace:nr.Push,{formMethod:ee,formAction:le,formEncType:ie}=v.navigation;!be&&!I&&ee&&le&&ie&&(be=Wy(v.navigation));let se=be||I;if(zR.has(ne.response.status)&&se&&us(se.formMethod))await Oe(B,V,{submission:Dt({},se,{formAction:j}),preventScrollReset:W||S,enableViewTransition:ue?C:void 0});else{let re=tm(V,be);await Oe(B,V,{overrideNavigation:re,fetcherSubmission:I,preventScrollReset:W||S,enableViewTransition:ue?C:void 0})}}async function mr(Q,ne,ue,ve,be,I){let W,P={};try{W=await JR(u,Q,ne,ue,ve,be,I,a,s)}catch(j){return ve.forEach(V=>{P[V.route.id]={type:gt.error,error:j}}),P}for(let[j,V]of Object.entries(W))if(s4(V)){let B=V.result;P[j]={type:gt.redirect,response:t4(B,ue,j,be,l,d.v7_relativeSplatPath)}}else P[j]=await e4(V);return P}async function _t(Q,ne,ue,ve,be){let I=Q.matches,W=mr("loader",Q,be,ue,ne,null),P=Promise.all(ve.map(async B=>{if(B.matches&&B.match&&B.controller){let le=(await mr("loader",Q,Io(e.history,B.path,B.controller.signal),[B.match],B.matches,B.key))[B.match.route.id];return{[B.key]:le}}else return Promise.resolve({[B.key]:{type:gt.error,error:hn(404,{pathname:B.path})}})})),j=await W,V=(await P).reduce((B,ee)=>Object.assign(B,ee),{});return await Promise.all([o4(ne,j,be.signal,I,Q.loaderData),l4(ne,V,ve)]),{loaderResults:j,fetcherResults:V}}function bt(){te=!0,de.push(...Xs()),q.forEach((Q,ne)=>{X.has(ne)&&ae.add(ne),ft(ne)})}function mt(Q,ne,ue){ue===void 0&&(ue={}),v.fetchers.set(Q,ne),G({fetchers:new Map(v.fetchers)},{flushSync:(ue&&ue.flushSync)===!0})}function jt(Q,ne,ue,ve){ve===void 0&&(ve={});let be=Ri(v.matches,ne);wt(Q),G({errors:{[be.route.id]:ue},fetchers:new Map(v.fetchers)},{flushSync:(ve&&ve.flushSync)===!0})}function Be(Q){return K.set(Q,(K.get(Q)||0)+1),L.has(Q)&&L.delete(Q),v.fetchers.get(Q)||HR}function wt(Q){let ne=v.fetchers.get(Q);X.has(Q)&&!(ne&&ne.state==="loading"&&Y.has(Q))&&ft(Q),q.delete(Q),Y.delete(Q),M.delete(Q),d.v7_fetcherPersist&&L.delete(Q),ae.delete(Q),v.fetchers.delete(Q)}function Jt(Q){let ne=(K.get(Q)||0)-1;ne<=0?(K.delete(Q),L.add(Q),d.v7_fetcherPersist||wt(Q)):K.set(Q,ne),G({fetchers:new Map(v.fetchers)})}function ft(Q){let ne=X.get(Q);ne&&(ne.abort(),X.delete(Q))}function Tn(Q){for(let ne of Q){let ue=Be(ne),ve=Ma(ue.data);v.fetchers.set(ne,ve)}}function Ks(){let Q=[],ne=!1;for(let ue of M){let ve=v.fetchers.get(ue);qe(ve,"Expected fetcher: "+ue),ve.state==="loading"&&(M.delete(ue),Q.push(ue),ne=!0)}return Tn(Q),ne}function wo(Q){let ne=[];for(let[ue,ve]of Y)if(ve<Q){let be=v.fetchers.get(ue);qe(be,"Expected fetcher: "+ue),be.state==="loading"&&(ft(ue),Y.delete(ue),ne.push(ue))}return Tn(ne),ne.length>0}function Ul(Q,ne){let ue=v.blockers.get(Q)||rc;return fe.get(Q)!==ne&&fe.set(Q,ne),ue}function qs(Q){v.blockers.delete(Q),fe.delete(Q)}function Ss(Q,ne){let ue=v.blockers.get(Q)||rc;qe(ue.state==="unblocked"&&ne.state==="blocked"||ue.state==="blocked"&&ne.state==="blocked"||ue.state==="blocked"&&ne.state==="proceeding"||ue.state==="blocked"&&ne.state==="unblocked"||ue.state==="proceeding"&&ne.state==="unblocked","Invalid blocker state transition: "+ue.state+" -> "+ne.state);let ve=new Map(v.blockers);ve.set(Q,ne),G({blockers:ve})}function Na(Q){let{currentLocation:ne,nextLocation:ue,historyAction:ve}=Q;if(fe.size===0)return;fe.size>1&&pl(!1,"A router only supports one blocker at a time");let be=Array.from(fe.entries()),[I,W]=be[be.length-1],P=v.blockers.get(I);if(!(P&&P.state==="proceeding")&&W({currentLocation:ne,nextLocation:ue,historyAction:ve}))return I}function ns(Q){let ne=hn(404,{pathname:Q}),ue=o||i,{matches:ve,route:be}=By(ue);return Xs(),{notFoundMatches:ve,route:be,error:ne}}function Xs(Q){let ne=[];return J.forEach((ue,ve)=>{(!Q||Q(ve))&&(ue.cancel(),ne.push(ve),J.delete(ve))}),ne}function As(Q,ne,ue){if(x=Q,_=ne,g=ue||null,!k&&v.navigation===em){k=!0;let ve=Ys(v.location,v.matches);ve!=null&&G({restoreScrollPosition:ve})}return()=>{x=null,_=null,g=null}}function Un(Q,ne){return g&&g(Q,ne.map(ve=>ER(ve,v.loaderData)))||Q.key}function Eo(Q,ne){if(x&&_){let ue=Un(Q,ne);x[ue]=_()}}function Ys(Q,ne){if(x){let ue=Un(Q,ne),ve=x[ue];if(typeof ve=="number")return ve}return null}function Qs(Q,ne,ue){if(f)if(Q){if(Object.keys(Q[0].params).length>0)return{active:!0,matches:fh(ne,ue,l,!0)}}else return{active:!0,matches:fh(ne,ue,l,!0)||[]};return{active:!1,matches:null}}async function Vn(Q,ne,ue,ve){if(!f)return{type:"success",matches:Q};let be=Q;for(;;){let I=o==null,W=o||i,P=a;try{await f({signal:ue,path:ne,matches:be,fetcherKey:ve,patch:(B,ee)=>{ue.aborted||Oy(B,ee,W,P,s)}})}catch(B){return{type:"error",error:B,partialMatches:be}}finally{I&&!ue.aborted&&(i=[...i])}if(ue.aborted)return{type:"aborted"};let j=Ci(W,ne,l);if(j)return{type:"success",matches:j};let V=fh(W,ne,l,!0);if(!V||be.length===V.length&&be.every((B,ee)=>B.route.id===V[ee].route.id))return{type:"success",matches:null};be=V}}function To(Q){a={},o=Gh(Q,s,void 0,a)}function ir(Q,ne){let ue=o==null;Oy(Q,ne,o||i,a,s),ue&&(i=[...i],G({}))}return D={get basename(){return l},get future(){return d},get state(){return v},get routes(){return i},get window(){return t},initialize:ge,subscribe:Pe,enableScrollRestoration:As,navigate:Ve,fetch:cn,revalidate:Ze,createHref:Q=>e.history.createHref(Q),encodeLocation:Q=>e.history.encodeLocation(Q),getFetcher:Be,deleteFetcher:Jt,dispose:pe,getBlocker:Ul,deleteBlocker:qs,patchRoutes:ir,_internalFetchControllers:X,_internalActiveDeferreds:J,_internalSetRoutes:To},D}function qR(e){return e!=null&&("formData"in e&&e.formData!=null||"body"in e&&e.body!==void 0)}function _p(e,t,r,n,s,a,i,o){let l,u;if(i){l=[];for(let d of t)if(l.push(d),d.route.id===i){u=d;break}}else l=t,u=t[t.length-1];let f=zd(s||".",Wd(l,a),va(e.pathname,r)||e.pathname,o==="path");if(s==null&&(f.search=e.search,f.hash=e.hash),(s==null||s===""||s===".")&&u){let d=ox(f.search);if(u.route.index&&!d)f.search=f.search?f.search.replace(/^\?/,"?index&"):"?index";else if(!u.route.index&&d){let m=new URLSearchParams(f.search),p=m.getAll("index");m.delete("index"),p.filter(g=>g).forEach(g=>m.append("index",g));let x=m.toString();f.search=x?"?"+x:""}}return n&&r!=="/"&&(f.pathname=f.pathname==="/"?r:ua([r,f.pathname])),Zi(f)}function Ry(e,t,r,n){if(!n||!qR(n))return{path:r};if(n.formMethod&&!i4(n.formMethod))return{path:r,error:hn(405,{method:n.formMethod})};let s=()=>({path:r,error:hn(400,{type:"invalid-body"})}),a=n.formMethod||"get",i=e?a.toUpperCase():a.toLowerCase(),o=HT(r);if(n.body!==void 0){if(n.formEncType==="text/plain"){if(!us(i))return s();let m=typeof n.body=="string"?n.body:n.body instanceof FormData||n.body instanceof URLSearchParams?Array.from(n.body.entries()).reduce((p,x)=>{let[g,_]=x;return""+p+g+"="+_+`
`},""):String(n.body);return{path:r,submission:{formMethod:i,formAction:o,formEncType:n.formEncType,formData:void 0,json:void 0,text:m}}}else if(n.formEncType==="application/json"){if(!us(i))return s();try{let m=typeof n.body=="string"?JSON.parse(n.body):n.body;return{path:r,submission:{formMethod:i,formAction:o,formEncType:n.formEncType,formData:void 0,json:m,text:void 0}}}catch{return s()}}}qe(typeof FormData=="function","FormData is not available in this environment");let l,u;if(n.formData)l=Ep(n.formData),u=n.formData;else if(n.body instanceof FormData)l=Ep(n.body),u=n.body;else if(n.body instanceof URLSearchParams)l=n.body,u=jy(l);else if(n.body==null)l=new URLSearchParams,u=new FormData;else try{l=new URLSearchParams(n.body),u=jy(l)}catch{return s()}let f={formMethod:i,formAction:o,formEncType:n&&n.formEncType||"application/x-www-form-urlencoded",formData:u,json:void 0,text:void 0};if(us(f.formMethod))return{path:r,submission:f};let d=Ei(r);return t&&d.search&&ox(d.search)&&l.append("index",""),d.search="?"+l,{path:Zi(d),submission:f}}function Py(e,t,r){r===void 0&&(r=!1);let n=e.findIndex(s=>s.route.id===t);return n>=0?e.slice(0,r?n+1:n):e}function Dy(e,t,r,n,s,a,i,o,l,u,f,d,m,p,x,g){let _=g?An(g[1])?g[1].error:g[1].data:void 0,k=e.createURL(t.location),E=e.createURL(s),y=r;a&&t.errors?y=Py(r,Object.keys(t.errors)[0],!0):g&&An(g[1])&&(y=Py(r,g[0]));let b=g?g[1].statusCode:void 0,O=i&&b&&b>=400,D=y.filter((T,S)=>{let{route:N}=T;if(N.lazy)return!0;if(N.loader==null)return!1;if(a)return wp(N,t.loaderData,t.errors);if(XR(t.loaderData,t.matches[S],T)||l.some(F=>F===T.route.id))return!0;let C=t.matches[S],R=T;return Fy(T,Dt({currentUrl:k,currentParams:C.params,nextUrl:E,nextParams:R.params},n,{actionResult:_,actionStatus:b,defaultShouldRevalidate:O?!1:o||k.pathname+k.search===E.pathname+E.search||k.search!==E.search||WT(C,R)}))}),v=[];return d.forEach((T,S)=>{if(a||!r.some(oe=>oe.route.id===T.routeId)||f.has(S))return;let N=Ci(p,T.path,x);if(!N){v.push({key:S,routeId:T.routeId,path:T.path,matches:null,match:null,controller:null});return}let C=t.fetchers.get(S),R=fc(N,T.path),F=!1;m.has(S)?F=!1:u.has(S)?(u.delete(S),F=!0):C&&C.state!=="idle"&&C.data===void 0?F=o:F=Fy(R,Dt({currentUrl:k,currentParams:t.matches[t.matches.length-1].params,nextUrl:E,nextParams:r[r.length-1].params},n,{actionResult:_,actionStatus:b,defaultShouldRevalidate:O?!1:o})),F&&v.push({key:S,routeId:T.routeId,path:T.path,matches:N,match:R,controller:new AbortController})}),[D,v]}function wp(e,t,r){if(e.lazy)return!0;if(!e.loader)return!1;let n=t!=null&&t[e.id]!==void 0,s=r!=null&&r[e.id]!==void 0;return!n&&s?!1:typeof e.loader=="function"&&e.loader.hydrate===!0?!0:!n&&!s}function XR(e,t,r){let n=!t||r.route.id!==t.route.id,s=e[r.route.id]===void 0;return n||s}function WT(e,t){let r=e.route.path;return e.pathname!==t.pathname||r!=null&&r.endsWith("*")&&e.params["*"]!==t.params["*"]}function Fy(e,t){if(e.route.shouldRevalidate){let r=e.route.shouldRevalidate(t);if(typeof r=="boolean")return r}return t.defaultShouldRevalidate}function Oy(e,t,r,n,s){var a;let i;if(e){let u=n[e];qe(u,"No route found to patch children into: routeId = "+e),u.children||(u.children=[]),i=u.children}else i=r;let o=t.filter(u=>!i.some(f=>zT(u,f))),l=Gh(o,s,[e||"_","patch",String(((a=i)==null?void 0:a.length)||"0")],n);i.push(...l)}function zT(e,t){return"id"in e&&"id"in t&&e.id===t.id?!0:e.index===t.index&&e.path===t.path&&e.caseSensitive===t.caseSensitive?(!e.children||e.children.length===0)&&(!t.children||t.children.length===0)?!0:e.children.every((r,n)=>{var s;return(s=t.children)==null?void 0:s.some(a=>zT(r,a))}):!1}async function YR(e,t,r){if(!e.lazy)return;let n=await e.lazy();if(!e.lazy)return;let s=r[e.id];qe(s,"No route found in manifest");let a={};for(let i in n){let l=s[i]!==void 0&&i!=="hasErrorBoundary";pl(!l,'Route "'+s.id+'" has a static property "'+i+'" defined but its lazy function is also returning a value for this property. '+('The lazy route property "'+i+'" will be ignored.')),!l&&!_R.has(i)&&(a[i]=n[i])}Object.assign(s,a),Object.assign(s,Dt({},t(s),{lazy:void 0}))}async function QR(e){let{matches:t}=e,r=t.filter(s=>s.shouldLoad);return(await Promise.all(r.map(s=>s.resolve()))).reduce((s,a,i)=>Object.assign(s,{[r[i].route.id]:a}),{})}async function JR(e,t,r,n,s,a,i,o,l,u){let f=a.map(p=>p.route.lazy?YR(p.route,l,o):void 0),d=a.map((p,x)=>{let g=f[x],_=s.some(E=>E.route.id===p.route.id);return Dt({},p,{shouldLoad:_,resolve:async E=>(E&&n.method==="GET"&&(p.route.lazy||p.route.loader)&&(_=!0),_?ZR(t,n,p,g,E,u):Promise.resolve({type:gt.data,result:void 0}))})}),m=await e({matches:d,request:n,params:a[0].params,fetcherKey:i,context:u});try{await Promise.all(f)}catch{}return m}async function ZR(e,t,r,n,s,a){let i,o,l=u=>{let f,d=new Promise((x,g)=>f=g);o=()=>f(),t.signal.addEventListener("abort",o);let m=x=>typeof u!="function"?Promise.reject(new Error("You cannot call the handler for a route which defines a boolean "+('"'+e+'" [routeId: '+r.route.id+"]"))):u({request:t,params:r.params,context:a},...x!==void 0?[x]:[]),p=(async()=>{try{return{type:"data",result:await(s?s(g=>m(g)):m())}}catch(x){return{type:"error",result:x}}})();return Promise.race([p,d])};try{let u=r.route[e];if(n)if(u){let f,[d]=await Promise.all([l(u).catch(m=>{f=m}),n]);if(f!==void 0)throw f;i=d}else if(await n,u=r.route[e],u)i=await l(u);else if(e==="action"){let f=new URL(t.url),d=f.pathname+f.search;throw hn(405,{method:t.method,pathname:d,routeId:r.route.id})}else return{type:gt.data,result:void 0};else if(u)i=await l(u);else{let f=new URL(t.url),d=f.pathname+f.search;throw hn(404,{pathname:d})}qe(i.result!==void 0,"You defined "+(e==="action"?"an action":"a loader")+" for route "+('"'+r.route.id+"\" but didn't return anything from your `"+e+"` ")+"function. Please return a value or `null`.")}catch(u){return{type:gt.error,result:u}}finally{o&&t.signal.removeEventListener("abort",o)}return i}async function e4(e){let{result:t,type:r}=e;if(GT(t)){let d;try{let m=t.headers.get("Content-Type");m&&/\bapplication\/json\b/.test(m)?t.body==null?d=null:d=await t.json():d=await t.text()}catch(m){return{type:gt.error,error:m}}return r===gt.error?{type:gt.error,error:new qh(t.status,t.statusText,d),statusCode:t.status,headers:t.headers}:{type:gt.data,data:d,statusCode:t.status,headers:t.headers}}if(r===gt.error){if($y(t)){var n,s;if(t.data instanceof Error){var a,i;return{type:gt.error,error:t.data,statusCode:(a=t.init)==null?void 0:a.status,headers:(i=t.init)!=null&&i.headers?new Headers(t.init.headers):void 0}}return{type:gt.error,error:new qh(((n=t.init)==null?void 0:n.status)||500,void 0,t.data),statusCode:cu(t)?t.status:void 0,headers:(s=t.init)!=null&&s.headers?new Headers(t.init.headers):void 0}}return{type:gt.error,error:t,statusCode:cu(t)?t.status:void 0}}if(a4(t)){var o,l;return{type:gt.deferred,deferredData:t,statusCode:(o=t.init)==null?void 0:o.status,headers:((l=t.init)==null?void 0:l.headers)&&new Headers(t.init.headers)}}if($y(t)){var u,f;return{type:gt.data,data:t.data,statusCode:(u=t.init)==null?void 0:u.status,headers:(f=t.init)!=null&&f.headers?new Headers(t.init.headers):void 0}}return{type:gt.data,data:t}}function t4(e,t,r,n,s,a){let i=e.headers.get("Location");if(qe(i,"Redirects returned/thrown from loaders/actions must have a Location header"),!ax.test(i)){let o=n.slice(0,n.findIndex(l=>l.route.id===r)+1);i=_p(new URL(t.url),o,s,!0,i,a),e.headers.set("Location",i)}return e}function My(e,t,r){if(ax.test(e)){let n=e,s=n.startsWith("//")?new URL(t.protocol+n):new URL(n),a=va(s.pathname,r)!=null;if(s.origin===t.origin&&a)return s.pathname+s.search+s.hash}return e}function Io(e,t,r,n){let s=e.createURL(HT(t)).toString(),a={signal:r};if(n&&us(n.formMethod)){let{formMethod:i,formEncType:o}=n;a.method=i.toUpperCase(),o==="application/json"?(a.headers=new Headers({"Content-Type":o}),a.body=JSON.stringify(n.json)):o==="text/plain"?a.body=n.text:o==="application/x-www-form-urlencoded"&&n.formData?a.body=Ep(n.formData):a.body=n.formData}return new Request(s,a)}function Ep(e){let t=new URLSearchParams;for(let[r,n]of e.entries())t.append(r,typeof n=="string"?n:n.name);return t}function jy(e){let t=new FormData;for(let[r,n]of e.entries())t.append(r,n);return t}function r4(e,t,r,n,s){let a={},i=null,o,l=!1,u={},f=r&&An(r[1])?r[1].error:void 0;return e.forEach(d=>{if(!(d.route.id in t))return;let m=d.route.id,p=t[m];if(qe(!Mi(p),"Cannot handle redirect results in processLoaderData"),An(p)){let x=p.error;f!==void 0&&(x=f,f=void 0),i=i||{};{let g=Ri(e,m);i[g.route.id]==null&&(i[g.route.id]=x)}a[m]=void 0,l||(l=!0,o=cu(p.error)?p.error.status:500),p.headers&&(u[m]=p.headers)}else qa(p)?(n.set(m,p.deferredData),a[m]=p.deferredData.data,p.statusCode!=null&&p.statusCode!==200&&!l&&(o=p.statusCode),p.headers&&(u[m]=p.headers)):(a[m]=p.data,p.statusCode&&p.statusCode!==200&&!l&&(o=p.statusCode),p.headers&&(u[m]=p.headers))}),f!==void 0&&r&&(i={[r[0]]:f},a[r[0]]=void 0),{loaderData:a,errors:i,statusCode:o||200,loaderHeaders:u}}function Ly(e,t,r,n,s,a,i){let{loaderData:o,errors:l}=r4(t,r,n,i);return s.forEach(u=>{let{key:f,match:d,controller:m}=u,p=a[f];if(qe(p,"Did not find corresponding fetcher result"),!(m&&m.signal.aborted))if(An(p)){let x=Ri(e.matches,d==null?void 0:d.route.id);l&&l[x.route.id]||(l=Dt({},l,{[x.route.id]:p.error})),e.fetchers.delete(f)}else if(Mi(p))qe(!1,"Unhandled fetcher revalidation redirect");else if(qa(p))qe(!1,"Unhandled fetcher deferred data");else{let x=Ma(p.data);e.fetchers.set(f,x)}}),{loaderData:o,errors:l}}function Uy(e,t,r,n){let s=Dt({},t);for(let a of r){let i=a.route.id;if(t.hasOwnProperty(i)?t[i]!==void 0&&(s[i]=t[i]):e[i]!==void 0&&a.route.loader&&(s[i]=e[i]),n&&n.hasOwnProperty(i))break}return s}function Vy(e){return e?An(e[1])?{actionData:{}}:{actionData:{[e[0]]:e[1].data}}:{}}function Ri(e,t){return(t?e.slice(0,e.findIndex(n=>n.route.id===t)+1):[...e]).reverse().find(n=>n.route.hasErrorBoundary===!0)||e[0]}function By(e){let t=e.length===1?e[0]:e.find(r=>r.index||!r.path||r.path==="/")||{id:"__shim-error-route__"};return{matches:[{params:{},pathname:"",pathnameBase:"",route:t}],route:t}}function hn(e,t){let{pathname:r,routeId:n,method:s,type:a,message:i}=t===void 0?{}:t,o="Unknown Server Error",l="Unknown @remix-run/router error";return e===400?(o="Bad Request",s&&r&&n?l="You made a "+s+' request to "'+r+'" but '+('did not provide a `loader` for route "'+n+'", ')+"so there is no way to handle the request.":a==="defer-action"?l="defer() is not supported in actions":a==="invalid-body"&&(l="Unable to encode submission body")):e===403?(o="Forbidden",l='Route "'+n+'" does not match URL "'+r+'"'):e===404?(o="Not Found",l='No route matches URL "'+r+'"'):e===405&&(o="Method Not Allowed",s&&r&&n?l="You made a "+s.toUpperCase()+' request to "'+r+'" but '+('did not provide an `action` for route "'+n+'", ')+"so there is no way to handle the request.":s&&(l='Invalid request method "'+s.toUpperCase()+'"')),new qh(e||500,o,new Error(l),!0)}function Mf(e){let t=Object.entries(e);for(let r=t.length-1;r>=0;r--){let[n,s]=t[r];if(Mi(s))return{key:n,result:s}}}function HT(e){let t=typeof e=="string"?Ei(e):e;return Zi(Dt({},t,{hash:""}))}function n4(e,t){return e.pathname!==t.pathname||e.search!==t.search?!1:e.hash===""?t.hash!=="":e.hash===t.hash?!0:t.hash!==""}function s4(e){return GT(e.result)&&WR.has(e.result.status)}function qa(e){return e.type===gt.deferred}function An(e){return e.type===gt.error}function Mi(e){return(e&&e.type)===gt.redirect}function $y(e){return typeof e=="object"&&e!=null&&"type"in e&&"data"in e&&"init"in e&&e.type==="DataWithResponseInit"}function a4(e){let t=e;return t&&typeof t=="object"&&typeof t.data=="object"&&typeof t.subscribe=="function"&&typeof t.cancel=="function"&&typeof t.resolveData=="function"}function GT(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.headers=="object"&&typeof e.body<"u"}function i4(e){return $R.has(e.toLowerCase())}function us(e){return VR.has(e.toLowerCase())}async function o4(e,t,r,n,s){let a=Object.entries(t);for(let i=0;i<a.length;i++){let[o,l]=a[i],u=e.find(m=>(m==null?void 0:m.route.id)===o);if(!u)continue;let f=n.find(m=>m.route.id===u.route.id),d=f!=null&&!WT(f,u)&&(s&&s[u.route.id])!==void 0;qa(l)&&d&&await ix(l,r,!1).then(m=>{m&&(t[o]=m)})}}async function l4(e,t,r){for(let n=0;n<r.length;n++){let{key:s,routeId:a,controller:i}=r[n],o=t[s];e.find(u=>(u==null?void 0:u.route.id)===a)&&qa(o)&&(qe(i,"Expected an AbortController for revalidating fetcher deferred result"),await ix(o,i.signal,!0).then(u=>{u&&(t[s]=u)}))}}async function ix(e,t,r){if(r===void 0&&(r=!1),!await e.deferredData.resolveData(t)){if(r)try{return{type:gt.data,data:e.deferredData.unwrappedData}}catch(s){return{type:gt.error,error:s}}return{type:gt.data,data:e.deferredData.data}}}function ox(e){return new URLSearchParams(e).getAll("index").some(t=>t==="")}function fc(e,t){let r=typeof t=="string"?Ei(t).search:t.search;if(e[e.length-1].route.index&&ox(r||""))return e[e.length-1];let n=VT(e);return n[n.length-1]}function Wy(e){let{formMethod:t,formAction:r,formEncType:n,text:s,formData:a,json:i}=e;if(!(!t||!r||!n)){if(s!=null)return{formMethod:t,formAction:r,formEncType:n,formData:void 0,json:void 0,text:s};if(a!=null)return{formMethod:t,formAction:r,formEncType:n,formData:a,json:void 0,text:void 0};if(i!==void 0)return{formMethod:t,formAction:r,formEncType:n,formData:void 0,json:i,text:void 0}}}function tm(e,t){return t?{state:"loading",location:e,formMethod:t.formMethod,formAction:t.formAction,formEncType:t.formEncType,formData:t.formData,json:t.json,text:t.text}:{state:"loading",location:e,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0}}function c4(e,t){return{state:"submitting",location:e,formMethod:t.formMethod,formAction:t.formAction,formEncType:t.formEncType,formData:t.formData,json:t.json,text:t.text}}function nc(e,t){return e?{state:"loading",formMethod:e.formMethod,formAction:e.formAction,formEncType:e.formEncType,formData:e.formData,json:e.json,text:e.text,data:t}:{state:"loading",formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0,data:t}}function u4(e,t){return{state:"submitting",formMethod:e.formMethod,formAction:e.formAction,formEncType:e.formEncType,formData:e.formData,json:e.json,text:e.text,data:t?t.data:void 0}}function Ma(e){return{state:"idle",formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0,data:e}}function f4(e,t){try{let r=e.sessionStorage.getItem($T);if(r){let n=JSON.parse(r);for(let[s,a]of Object.entries(n||{}))a&&Array.isArray(a)&&t.set(s,new Set(a||[]))}}catch{}}function h4(e,t){if(t.size>0){let r={};for(let[n,s]of t)r[n]=[...s];try{e.sessionStorage.setItem($T,JSON.stringify(r))}catch(n){pl(!1,"Failed to save applied view transitions in sessionStorage ("+n+").")}}}/**
 * React Router v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Xh(){return Xh=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Xh.apply(this,arguments)}const Ou=U.createContext(null),lx=U.createContext(null),ba=U.createContext(null),cx=U.createContext(null),Ws=U.createContext({outlet:null,matches:[],isDataRoute:!1}),KT=U.createContext(null);function d4(e,t){let{relative:r}=t===void 0?{}:t;Cl()||qe(!1);let{basename:n,navigator:s}=U.useContext(ba),{hash:a,pathname:i,search:o}=Gd(e,{relative:r}),l=i;return n!=="/"&&(l=i==="/"?n:ua([n,i])),s.createHref({pathname:l,search:o,hash:a})}function Cl(){return U.useContext(cx)!=null}function Ts(){return Cl()||qe(!1),U.useContext(cx).location}function qT(e){U.useContext(ba).static||U.useLayoutEffect(e)}function ts(){let{isDataRoute:e}=U.useContext(Ws);return e?b4():m4()}function m4(){Cl()||qe(!1);let e=U.useContext(Ou),{basename:t,future:r,navigator:n}=U.useContext(ba),{matches:s}=U.useContext(Ws),{pathname:a}=Ts(),i=JSON.stringify(Wd(s,r.v7_relativeSplatPath)),o=U.useRef(!1);return qT(()=>{o.current=!0}),U.useCallback(function(u,f){if(f===void 0&&(f={}),!o.current)return;if(typeof u=="number"){n.go(u);return}let d=zd(u,JSON.parse(i),a,f.relative==="path");e==null&&t!=="/"&&(d.pathname=d.pathname==="/"?t:ua([t,d.pathname])),(f.replace?n.replace:n.push)(d,f.state,f)},[t,n,i,a,e])}const p4=U.createContext(null);function g4(e){let t=U.useContext(Ws).outlet;return t&&U.createElement(p4.Provider,{value:e},t)}function Hd(){let{matches:e}=U.useContext(Ws),t=e[e.length-1];return t?t.params:{}}function Gd(e,t){let{relative:r}=t===void 0?{}:t,{future:n}=U.useContext(ba),{matches:s}=U.useContext(Ws),{pathname:a}=Ts(),i=JSON.stringify(Wd(s,n.v7_relativeSplatPath));return U.useMemo(()=>zd(e,JSON.parse(i),a,r==="path"),[e,i,a,r])}function x4(e,t,r,n){Cl()||qe(!1);let{navigator:s}=U.useContext(ba),{matches:a}=U.useContext(Ws),i=a[a.length-1],o=i?i.params:{};i&&i.pathname;let l=i?i.pathnameBase:"/";i&&i.route;let u=Ts(),f;f=u;let d=f.pathname||"/",m=d;if(l!=="/"){let g=l.replace(/^\//,"").split("/");m="/"+d.replace(/^\//,"").split("/").slice(g.length).join("/")}let p=Ci(e,{pathname:m});return E4(p&&p.map(g=>Object.assign({},g,{params:Object.assign({},o,g.params),pathname:ua([l,s.encodeLocation?s.encodeLocation(g.pathname).pathname:g.pathname]),pathnameBase:g.pathnameBase==="/"?l:ua([l,s.encodeLocation?s.encodeLocation(g.pathnameBase).pathname:g.pathnameBase])})),a,r,n)}function v4(){let e=A4(),t=cu(e)?e.status+" "+e.statusText:e instanceof Error?e.message:JSON.stringify(e),r=e instanceof Error?e.stack:null,s={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return U.createElement(U.Fragment,null,U.createElement("h2",null,"Unexpected Application Error!"),U.createElement("h3",{style:{fontStyle:"italic"}},t),r?U.createElement("pre",{style:s},r):null,null)}const y4=U.createElement(v4,null);class _4 extends U.Component{constructor(t){super(t),this.state={location:t.location,revalidation:t.revalidation,error:t.error}}static getDerivedStateFromError(t){return{error:t}}static getDerivedStateFromProps(t,r){return r.location!==t.location||r.revalidation!=="idle"&&t.revalidation==="idle"?{error:t.error,location:t.location,revalidation:t.revalidation}:{error:t.error!==void 0?t.error:r.error,location:r.location,revalidation:t.revalidation||r.revalidation}}componentDidCatch(t,r){console.error("React Router caught the following error during render",t,r)}render(){return this.state.error!==void 0?U.createElement(Ws.Provider,{value:this.props.routeContext},U.createElement(KT.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function w4(e){let{routeContext:t,match:r,children:n}=e,s=U.useContext(Ou);return s&&s.static&&s.staticContext&&(r.route.errorElement||r.route.ErrorBoundary)&&(s.staticContext._deepestRenderedBoundaryId=r.route.id),U.createElement(Ws.Provider,{value:t},n)}function E4(e,t,r,n){var s;if(t===void 0&&(t=[]),r===void 0&&(r=null),n===void 0&&(n=null),e==null){var a;if(!r)return null;if(r.errors)e=r.matches;else if((a=n)!=null&&a.v7_partialHydration&&t.length===0&&!r.initialized&&r.matches.length>0)e=r.matches;else return null}let i=e,o=(s=r)==null?void 0:s.errors;if(o!=null){let f=i.findIndex(d=>d.route.id&&(o==null?void 0:o[d.route.id])!==void 0);f>=0||qe(!1),i=i.slice(0,Math.min(i.length,f+1))}let l=!1,u=-1;if(r&&n&&n.v7_partialHydration)for(let f=0;f<i.length;f++){let d=i[f];if((d.route.HydrateFallback||d.route.hydrateFallbackElement)&&(u=f),d.route.id){let{loaderData:m,errors:p}=r,x=d.route.loader&&m[d.route.id]===void 0&&(!p||p[d.route.id]===void 0);if(d.route.lazy||x){l=!0,u>=0?i=i.slice(0,u+1):i=[i[0]];break}}}return i.reduceRight((f,d,m)=>{let p,x=!1,g=null,_=null;r&&(p=o&&d.route.id?o[d.route.id]:void 0,g=d.route.errorElement||y4,l&&(u<0&&m===0?(I4("route-fallback"),x=!0,_=null):u===m&&(x=!0,_=d.route.hydrateFallbackElement||null)));let k=t.concat(i.slice(0,m+1)),E=()=>{let y;return p?y=g:x?y=_:d.route.Component?y=U.createElement(d.route.Component,null):d.route.element?y=d.route.element:y=f,U.createElement(w4,{match:d,routeContext:{outlet:f,matches:k,isDataRoute:r!=null},children:y})};return r&&(d.route.ErrorBoundary||d.route.errorElement||m===0)?U.createElement(_4,{location:r.location,revalidation:r.revalidation,component:g,error:p,children:E(),routeContext:{outlet:null,matches:k,isDataRoute:!0}}):E()},null)}var XT=function(e){return e.UseBlocker="useBlocker",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e}(XT||{}),YT=function(e){return e.UseBlocker="useBlocker",e.UseLoaderData="useLoaderData",e.UseActionData="useActionData",e.UseRouteError="useRouteError",e.UseNavigation="useNavigation",e.UseRouteLoaderData="useRouteLoaderData",e.UseMatches="useMatches",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e.UseRouteId="useRouteId",e}(YT||{});function T4(e){let t=U.useContext(Ou);return t||qe(!1),t}function k4(e){let t=U.useContext(lx);return t||qe(!1),t}function S4(e){let t=U.useContext(Ws);return t||qe(!1),t}function QT(e){let t=S4(),r=t.matches[t.matches.length-1];return r.route.id||qe(!1),r.route.id}function A4(){var e;let t=U.useContext(KT),r=k4(YT.UseRouteError),n=QT();return t!==void 0?t:(e=r.errors)==null?void 0:e[n]}function b4(){let{router:e}=T4(XT.UseNavigateStable),t=QT(),r=U.useRef(!1);return qT(()=>{r.current=!0}),U.useCallback(function(s,a){a===void 0&&(a={}),r.current&&(typeof s=="number"?e.navigate(s):e.navigate(s,Xh({fromRouteId:t},a)))},[e,t])}const zy={};function I4(e,t,r){zy[e]||(zy[e]=!0)}function N4(e,t){e==null||e.v7_startTransition,(e==null?void 0:e.v7_relativeSplatPath)===void 0&&(!t||t.v7_relativeSplatPath),t&&(t.v7_fetcherPersist,t.v7_normalizeFormMethod,t.v7_partialHydration,t.v7_skipActionErrorRevalidation)}function C4(e){let{to:t,replace:r,state:n,relative:s}=e;Cl()||qe(!1);let{future:a,static:i}=U.useContext(ba),{matches:o}=U.useContext(Ws),{pathname:l}=Ts(),u=ts(),f=zd(t,Wd(o,a.v7_relativeSplatPath),l,s==="path"),d=JSON.stringify(f);return U.useEffect(()=>u(JSON.parse(d),{replace:r,state:n,relative:s}),[u,d,s,r,n]),null}function JT(e){return g4(e.context)}function R4(e){let{basename:t="/",children:r=null,location:n,navigationType:s=nr.Pop,navigator:a,static:i=!1,future:o}=e;Cl()&&qe(!1);let l=t.replace(/^\/*/,"/"),u=U.useMemo(()=>({basename:l,navigator:a,static:i,future:Xh({v7_relativeSplatPath:!1},o)}),[l,o,a,i]);typeof n=="string"&&(n=Ei(n));let{pathname:f="/",search:d="",hash:m="",state:p=null,key:x="default"}=n,g=U.useMemo(()=>{let _=va(f,l);return _==null?null:{location:{pathname:_,search:d,hash:m,state:p,key:x},navigationType:s}},[l,f,d,m,p,x,s]);return g==null?null:U.createElement(ba.Provider,{value:u},U.createElement(cx.Provider,{children:r,value:g}))}new Promise(()=>{});function P4(e){let t={hasErrorBoundary:e.ErrorBoundary!=null||e.errorElement!=null};return e.Component&&Object.assign(t,{element:U.createElement(e.Component),Component:void 0}),e.HydrateFallback&&Object.assign(t,{hydrateFallbackElement:U.createElement(e.HydrateFallback),HydrateFallback:void 0}),e.ErrorBoundary&&Object.assign(t,{errorElement:U.createElement(e.ErrorBoundary),ErrorBoundary:void 0}),t}/**
 * React Router DOM v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function gl(){return gl=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},gl.apply(this,arguments)}function ZT(e,t){if(e==null)return{};var r={},n=Object.keys(e),s,a;for(a=0;a<n.length;a++)s=n[a],!(t.indexOf(s)>=0)&&(r[s]=e[s]);return r}function D4(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}function F4(e,t){return e.button===0&&(!t||t==="_self")&&!D4(e)}function Tp(e){return e===void 0&&(e=""),new URLSearchParams(typeof e=="string"||Array.isArray(e)||e instanceof URLSearchParams?e:Object.keys(e).reduce((t,r)=>{let n=e[r];return t.concat(Array.isArray(n)?n.map(s=>[r,s]):[[r,n]])},[]))}function O4(e,t){let r=Tp(e);return t&&t.forEach((n,s)=>{r.has(s)||t.getAll(s).forEach(a=>{r.append(s,a)})}),r}const M4=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],j4=["aria-current","caseSensitive","className","end","style","to","viewTransition","children"],L4="6";try{window.__reactRouterVersion=L4}catch{}function U4(e,t){return KR({basename:void 0,future:gl({},void 0,{v7_prependBasename:!0}),history:xR({window:void 0}),hydrationData:V4(),routes:e,mapRouteProperties:P4,dataStrategy:void 0,patchRoutesOnNavigation:void 0,window:void 0}).initialize()}function V4(){var e;let t=(e=window)==null?void 0:e.__staticRouterHydrationData;return t&&t.errors&&(t=gl({},t,{errors:B4(t.errors)})),t}function B4(e){if(!e)return null;let t=Object.entries(e),r={};for(let[n,s]of t)if(s&&s.__type==="RouteErrorResponse")r[n]=new qh(s.status,s.statusText,s.data,s.internal===!0);else if(s&&s.__type==="Error"){if(s.__subType){let a=window[s.__subType];if(typeof a=="function")try{let i=new a(s.message);i.stack="",r[n]=i}catch{}}if(r[n]==null){let a=new Error(s.message);a.stack="",r[n]=a}}else r[n]=s;return r}const ek=U.createContext({isTransitioning:!1}),$4=U.createContext(new Map),W4="startTransition",Hy=sN[W4],z4="flushSync",Gy=gR[z4];function H4(e){Hy?Hy(e):e()}function sc(e){Gy?Gy(e):e()}let G4=class{constructor(){this.status="pending",this.promise=new Promise((t,r)=>{this.resolve=n=>{this.status==="pending"&&(this.status="resolved",t(n))},this.reject=n=>{this.status==="pending"&&(this.status="rejected",r(n))}})}};function K4(e){let{fallbackElement:t,router:r,future:n}=e,[s,a]=U.useState(r.state),[i,o]=U.useState(),[l,u]=U.useState({isTransitioning:!1}),[f,d]=U.useState(),[m,p]=U.useState(),[x,g]=U.useState(),_=U.useRef(new Map),{v7_startTransition:k}=n||{},E=U.useCallback(T=>{k?H4(T):T()},[k]),y=U.useCallback((T,S)=>{let{deletedFetchers:N,flushSync:C,viewTransitionOpts:R}=S;T.fetchers.forEach((oe,te)=>{oe.data!==void 0&&_.current.set(te,oe.data)}),N.forEach(oe=>_.current.delete(oe));let F=r.window==null||r.window.document==null||typeof r.window.document.startViewTransition!="function";if(!R||F){C?sc(()=>a(T)):E(()=>a(T));return}if(C){sc(()=>{m&&(f&&f.resolve(),m.skipTransition()),u({isTransitioning:!0,flushSync:!0,currentLocation:R.currentLocation,nextLocation:R.nextLocation})});let oe=r.window.document.startViewTransition(()=>{sc(()=>a(T))});oe.finished.finally(()=>{sc(()=>{d(void 0),p(void 0),o(void 0),u({isTransitioning:!1})})}),sc(()=>p(oe));return}m?(f&&f.resolve(),m.skipTransition(),g({state:T,currentLocation:R.currentLocation,nextLocation:R.nextLocation})):(o(T),u({isTransitioning:!0,flushSync:!1,currentLocation:R.currentLocation,nextLocation:R.nextLocation}))},[r.window,m,f,_,E]);U.useLayoutEffect(()=>r.subscribe(y),[r,y]),U.useEffect(()=>{l.isTransitioning&&!l.flushSync&&d(new G4)},[l]),U.useEffect(()=>{if(f&&i&&r.window){let T=i,S=f.promise,N=r.window.document.startViewTransition(async()=>{E(()=>a(T)),await S});N.finished.finally(()=>{d(void 0),p(void 0),o(void 0),u({isTransitioning:!1})}),p(N)}},[E,i,f,r.window]),U.useEffect(()=>{f&&i&&s.location.key===i.location.key&&f.resolve()},[f,m,s.location,i]),U.useEffect(()=>{!l.isTransitioning&&x&&(o(x.state),u({isTransitioning:!0,flushSync:!1,currentLocation:x.currentLocation,nextLocation:x.nextLocation}),g(void 0))},[l.isTransitioning,x]),U.useEffect(()=>{},[]);let b=U.useMemo(()=>({createHref:r.createHref,encodeLocation:r.encodeLocation,go:T=>r.navigate(T),push:(T,S,N)=>r.navigate(T,{state:S,preventScrollReset:N==null?void 0:N.preventScrollReset}),replace:(T,S,N)=>r.navigate(T,{replace:!0,state:S,preventScrollReset:N==null?void 0:N.preventScrollReset})}),[r]),O=r.basename||"/",D=U.useMemo(()=>({router:r,navigator:b,static:!1,basename:O}),[r,b,O]),v=U.useMemo(()=>({v7_relativeSplatPath:r.future.v7_relativeSplatPath}),[r.future.v7_relativeSplatPath]);return U.useEffect(()=>N4(n,r.future),[n,r.future]),U.createElement(U.Fragment,null,U.createElement(Ou.Provider,{value:D},U.createElement(lx.Provider,{value:s},U.createElement($4.Provider,{value:_.current},U.createElement(ek.Provider,{value:l},U.createElement(R4,{basename:O,location:s.location,navigationType:s.historyAction,navigator:b,future:v},s.initialized||r.future.v7_partialHydration?U.createElement(q4,{routes:r.routes,future:r.future,state:s}):t))))),null)}const q4=U.memo(X4);function X4(e){let{routes:t,future:r,state:n}=e;return x4(t,void 0,n,r)}const Y4=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",Q4=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Ge=U.forwardRef(function(t,r){let{onClick:n,relative:s,reloadDocument:a,replace:i,state:o,target:l,to:u,preventScrollReset:f,viewTransition:d}=t,m=ZT(t,M4),{basename:p}=U.useContext(ba),x,g=!1;if(typeof u=="string"&&Q4.test(u)&&(x=u,Y4))try{let y=new URL(window.location.href),b=u.startsWith("//")?new URL(y.protocol+u):new URL(u),O=va(b.pathname,p);b.origin===y.origin&&O!=null?u=O+b.search+b.hash:g=!0}catch{}let _=d4(u,{relative:s}),k=Z4(u,{replace:i,state:o,target:l,preventScrollReset:f,relative:s,viewTransition:d});function E(y){n&&n(y),y.defaultPrevented||k(y)}return U.createElement("a",gl({},m,{href:x||_,onClick:g||a?n:E,ref:r,target:l}))}),Da=U.forwardRef(function(t,r){let{"aria-current":n="page",caseSensitive:s=!1,className:a="",end:i=!1,style:o,to:l,viewTransition:u,children:f}=t,d=ZT(t,j4),m=Gd(l,{relative:d.relative}),p=Ts(),x=U.useContext(lx),{navigator:g,basename:_}=U.useContext(ba),k=x!=null&&tP(m)&&u===!0,E=g.encodeLocation?g.encodeLocation(m).pathname:m.pathname,y=p.pathname,b=x&&x.navigation&&x.navigation.location?x.navigation.location.pathname:null;s||(y=y.toLowerCase(),b=b?b.toLowerCase():null,E=E.toLowerCase()),b&&_&&(b=va(b,_)||b);const O=E!=="/"&&E.endsWith("/")?E.length-1:E.length;let D=y===E||!i&&y.startsWith(E)&&y.charAt(O)==="/",v=b!=null&&(b===E||!i&&b.startsWith(E)&&b.charAt(E.length)==="/"),T={isActive:D,isPending:v,isTransitioning:k},S=D?n:void 0,N;typeof a=="function"?N=a(T):N=[a,D?"active":null,v?"pending":null,k?"transitioning":null].filter(Boolean).join(" ");let C=typeof o=="function"?o(T):o;return U.createElement(Ge,gl({},d,{"aria-current":S,className:N,ref:r,style:C,to:l,viewTransition:u}),typeof f=="function"?f(T):f)});var kp;(function(e){e.UseScrollRestoration="useScrollRestoration",e.UseSubmit="useSubmit",e.UseSubmitFetcher="useSubmitFetcher",e.UseFetcher="useFetcher",e.useViewTransitionState="useViewTransitionState"})(kp||(kp={}));var Ky;(function(e){e.UseFetcher="useFetcher",e.UseFetchers="useFetchers",e.UseScrollRestoration="useScrollRestoration"})(Ky||(Ky={}));function J4(e){let t=U.useContext(Ou);return t||qe(!1),t}function Z4(e,t){let{target:r,replace:n,state:s,preventScrollReset:a,relative:i,viewTransition:o}=t===void 0?{}:t,l=ts(),u=Ts(),f=Gd(e,{relative:i});return U.useCallback(d=>{if(F4(d,r)){d.preventDefault();let m=n!==void 0?n:Zi(u)===Zi(f);l(e,{replace:m,state:s,preventScrollReset:a,relative:i,viewTransition:o})}},[u,l,f,n,s,r,e,a,i,o])}function eP(e){let t=U.useRef(Tp(e)),r=U.useRef(!1),n=Ts(),s=U.useMemo(()=>O4(n.search,r.current?null:t.current),[n.search]),a=ts(),i=U.useCallback((o,l)=>{const u=Tp(typeof o=="function"?o(s):o);r.current=!0,a("?"+u,l)},[a,s]);return[s,i]}function tP(e,t){t===void 0&&(t={});let r=U.useContext(ek);r==null&&qe(!1);let{basename:n}=J4(kp.useViewTransitionState),s=Gd(e,{relative:t.relative});if(!r.isTransitioning)return!1;let a=va(r.currentLocation.pathname,n)||r.currentLocation.pathname,i=va(r.nextLocation.pathname,n)||r.nextLocation.pathname;return Kh(s.pathname,i)!=null||Kh(s.pathname,a)!=null}var qy={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tk=function(e){const t=[];let r=0;for(let n=0;n<e.length;n++){let s=e.charCodeAt(n);s<128?t[r++]=s:s<2048?(t[r++]=s>>6|192,t[r++]=s&63|128):(s&64512)===55296&&n+1<e.length&&(e.charCodeAt(n+1)&64512)===56320?(s=65536+((s&1023)<<10)+(e.charCodeAt(++n)&1023),t[r++]=s>>18|240,t[r++]=s>>12&63|128,t[r++]=s>>6&63|128,t[r++]=s&63|128):(t[r++]=s>>12|224,t[r++]=s>>6&63|128,t[r++]=s&63|128)}return t},rP=function(e){const t=[];let r=0,n=0;for(;r<e.length;){const s=e[r++];if(s<128)t[n++]=String.fromCharCode(s);else if(s>191&&s<224){const a=e[r++];t[n++]=String.fromCharCode((s&31)<<6|a&63)}else if(s>239&&s<365){const a=e[r++],i=e[r++],o=e[r++],l=((s&7)<<18|(a&63)<<12|(i&63)<<6|o&63)-65536;t[n++]=String.fromCharCode(55296+(l>>10)),t[n++]=String.fromCharCode(56320+(l&1023))}else{const a=e[r++],i=e[r++];t[n++]=String.fromCharCode((s&15)<<12|(a&63)<<6|i&63)}}return t.join("")},rk={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(e,t){if(!Array.isArray(e))throw Error("encodeByteArray takes an array as a parameter");this.init_();const r=t?this.byteToCharMapWebSafe_:this.byteToCharMap_,n=[];for(let s=0;s<e.length;s+=3){const a=e[s],i=s+1<e.length,o=i?e[s+1]:0,l=s+2<e.length,u=l?e[s+2]:0,f=a>>2,d=(a&3)<<4|o>>4;let m=(o&15)<<2|u>>6,p=u&63;l||(p=64,i||(m=64)),n.push(r[f],r[d],r[m],r[p])}return n.join("")},encodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?btoa(e):this.encodeByteArray(tk(e),t)},decodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?atob(e):rP(this.decodeStringToByteArray(e,t))},decodeStringToByteArray(e,t){this.init_();const r=t?this.charToByteMapWebSafe_:this.charToByteMap_,n=[];for(let s=0;s<e.length;){const a=r[e.charAt(s++)],o=s<e.length?r[e.charAt(s)]:0;++s;const u=s<e.length?r[e.charAt(s)]:64;++s;const d=s<e.length?r[e.charAt(s)]:64;if(++s,a==null||o==null||u==null||d==null)throw new nP;const m=a<<2|o>>4;if(n.push(m),u!==64){const p=o<<4&240|u>>2;if(n.push(p),d!==64){const x=u<<6&192|d;n.push(x)}}}return n},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let e=0;e<this.ENCODED_VALS.length;e++)this.byteToCharMap_[e]=this.ENCODED_VALS.charAt(e),this.charToByteMap_[this.byteToCharMap_[e]]=e,this.byteToCharMapWebSafe_[e]=this.ENCODED_VALS_WEBSAFE.charAt(e),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[e]]=e,e>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(e)]=e,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(e)]=e)}}};class nP extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const sP=function(e){const t=tk(e);return rk.encodeByteArray(t,!0)},Yh=function(e){return sP(e).replace(/\./g,"")},nk=function(e){try{return rk.decodeString(e,!0)}catch(t){console.error("base64Decode failed: ",t)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function aP(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const iP=()=>aP().__FIREBASE_DEFAULTS__,oP=()=>{if(typeof process>"u"||typeof qy>"u")return;const e=qy.__FIREBASE_DEFAULTS__;if(e)return JSON.parse(e)},lP=()=>{if(typeof document>"u")return;let e;try{e=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const t=e&&nk(e[1]);return t&&JSON.parse(t)},Kd=()=>{try{return iP()||oP()||lP()}catch(e){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${e}`);return}},sk=e=>{var t,r;return(r=(t=Kd())===null||t===void 0?void 0:t.emulatorHosts)===null||r===void 0?void 0:r[e]},ux=e=>{const t=sk(e);if(!t)return;const r=t.lastIndexOf(":");if(r<=0||r+1===t.length)throw new Error(`Invalid host ${t} with no separate hostname and port!`);const n=parseInt(t.substring(r+1),10);return t[0]==="["?[t.substring(1,r-1),n]:[t.substring(0,r),n]},ak=()=>{var e;return(e=Kd())===null||e===void 0?void 0:e.config},ik=e=>{var t;return(t=Kd())===null||t===void 0?void 0:t[`_${e}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cP{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((t,r)=>{this.resolve=t,this.reject=r})}wrapCallback(t){return(r,n)=>{r?this.reject(r):this.resolve(n),typeof t=="function"&&(this.promise.catch(()=>{}),t.length===1?t(r):t(r,n))}}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ok(e,t){if(e.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const r={alg:"none",type:"JWT"},n=t||"demo-project",s=e.iat||0,a=e.sub||e.user_id;if(!a)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const i=Object.assign({iss:`https://securetoken.google.com/${n}`,aud:n,iat:s,exp:s+3600,auth_time:s,sub:a,user_id:a,firebase:{sign_in_provider:"custom",identities:{}}},e);return[Yh(JSON.stringify(r)),Yh(JSON.stringify(i)),""].join(".")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Kr(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function uP(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Kr())}function fP(){var e;const t=(e=Kd())===null||e===void 0?void 0:e.forceEnvironment;if(t==="node")return!0;if(t==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function hP(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function dP(){const e=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof e=="object"&&e.id!==void 0}function mP(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function pP(){const e=Kr();return e.indexOf("MSIE ")>=0||e.indexOf("Trident/")>=0}function gP(){return!fP()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function xP(){try{return typeof indexedDB=="object"}catch{return!1}}function vP(){return new Promise((e,t)=>{try{let r=!0;const n="validate-browser-context-for-indexeddb-analytics-module",s=self.indexedDB.open(n);s.onsuccess=()=>{s.result.close(),r||self.indexedDB.deleteDatabase(n),e(!0)},s.onupgradeneeded=()=>{r=!1},s.onerror=()=>{var a;t(((a=s.error)===null||a===void 0?void 0:a.message)||"")}}catch(r){t(r)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yP="FirebaseError";class ks extends Error{constructor(t,r,n){super(r),this.code=t,this.customData=n,this.name=yP,Object.setPrototypeOf(this,ks.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Mu.prototype.create)}}class Mu{constructor(t,r,n){this.service=t,this.serviceName=r,this.errors=n}create(t,...r){const n=r[0]||{},s=`${this.service}/${t}`,a=this.errors[t],i=a?_P(a,n):"Error",o=`${this.serviceName}: ${i} (${s}).`;return new ks(s,o,n)}}function _P(e,t){return e.replace(wP,(r,n)=>{const s=t[n];return s!=null?String(s):`<${n}?>`})}const wP=/\{\$([^}]+)}/g;function EP(e){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}function Qh(e,t){if(e===t)return!0;const r=Object.keys(e),n=Object.keys(t);for(const s of r){if(!n.includes(s))return!1;const a=e[s],i=t[s];if(Xy(a)&&Xy(i)){if(!Qh(a,i))return!1}else if(a!==i)return!1}for(const s of n)if(!r.includes(s))return!1;return!0}function Xy(e){return e!==null&&typeof e=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ju(e){const t=[];for(const[r,n]of Object.entries(e))Array.isArray(n)?n.forEach(s=>{t.push(encodeURIComponent(r)+"="+encodeURIComponent(s))}):t.push(encodeURIComponent(r)+"="+encodeURIComponent(n));return t.length?"&"+t.join("&"):""}function TP(e,t){const r=new kP(e,t);return r.subscribe.bind(r)}class kP{constructor(t,r){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=r,this.task.then(()=>{t(this)}).catch(n=>{this.error(n)})}next(t){this.forEachObserver(r=>{r.next(t)})}error(t){this.forEachObserver(r=>{r.error(t)}),this.close(t)}complete(){this.forEachObserver(t=>{t.complete()}),this.close()}subscribe(t,r,n){let s;if(t===void 0&&r===void 0&&n===void 0)throw new Error("Missing Observer.");SP(t,["next","error","complete"])?s=t:s={next:t,error:r,complete:n},s.next===void 0&&(s.next=rm),s.error===void 0&&(s.error=rm),s.complete===void 0&&(s.complete=rm);const a=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?s.error(this.finalError):s.complete()}catch{}}),this.observers.push(s),a}unsubscribeOne(t){this.observers===void 0||this.observers[t]===void 0||(delete this.observers[t],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(t){if(!this.finalized)for(let r=0;r<this.observers.length;r++)this.sendOne(r,t)}sendOne(t,r){this.task.then(()=>{if(this.observers!==void 0&&this.observers[t]!==void 0)try{r(this.observers[t])}catch(n){typeof console<"u"&&console.error&&console.error(n)}})}close(t){this.finalized||(this.finalized=!0,t!==void 0&&(this.finalError=t),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function SP(e,t){if(typeof e!="object"||e===null)return!1;for(const r of t)if(r in e&&typeof e[r]=="function")return!0;return!1}function rm(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Pt(e){return e&&e._delegate?e._delegate:e}class ya{constructor(t,r,n){this.name=t,this.instanceFactory=r,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(t){return this.instantiationMode=t,this}setMultipleInstances(t){return this.multipleInstances=t,this}setServiceProps(t){return this.serviceProps=t,this}setInstanceCreatedCallback(t){return this.onInstanceCreated=t,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ni="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AP{constructor(t,r){this.name=t,this.container=r,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(t){const r=this.normalizeInstanceIdentifier(t);if(!this.instancesDeferred.has(r)){const n=new cP;if(this.instancesDeferred.set(r,n),this.isInitialized(r)||this.shouldAutoInitialize())try{const s=this.getOrInitializeService({instanceIdentifier:r});s&&n.resolve(s)}catch{}}return this.instancesDeferred.get(r).promise}getImmediate(t){var r;const n=this.normalizeInstanceIdentifier(t==null?void 0:t.identifier),s=(r=t==null?void 0:t.optional)!==null&&r!==void 0?r:!1;if(this.isInitialized(n)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:n})}catch(a){if(s)return null;throw a}else{if(s)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(t){if(t.name!==this.name)throw Error(`Mismatching Component ${t.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=t,!!this.shouldAutoInitialize()){if(IP(t))try{this.getOrInitializeService({instanceIdentifier:Ni})}catch{}for(const[r,n]of this.instancesDeferred.entries()){const s=this.normalizeInstanceIdentifier(r);try{const a=this.getOrInitializeService({instanceIdentifier:s});n.resolve(a)}catch{}}}}clearInstance(t=Ni){this.instancesDeferred.delete(t),this.instancesOptions.delete(t),this.instances.delete(t)}async delete(){const t=Array.from(this.instances.values());await Promise.all([...t.filter(r=>"INTERNAL"in r).map(r=>r.INTERNAL.delete()),...t.filter(r=>"_delete"in r).map(r=>r._delete())])}isComponentSet(){return this.component!=null}isInitialized(t=Ni){return this.instances.has(t)}getOptions(t=Ni){return this.instancesOptions.get(t)||{}}initialize(t={}){const{options:r={}}=t,n=this.normalizeInstanceIdentifier(t.instanceIdentifier);if(this.isInitialized(n))throw Error(`${this.name}(${n}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const s=this.getOrInitializeService({instanceIdentifier:n,options:r});for(const[a,i]of this.instancesDeferred.entries()){const o=this.normalizeInstanceIdentifier(a);n===o&&i.resolve(s)}return s}onInit(t,r){var n;const s=this.normalizeInstanceIdentifier(r),a=(n=this.onInitCallbacks.get(s))!==null&&n!==void 0?n:new Set;a.add(t),this.onInitCallbacks.set(s,a);const i=this.instances.get(s);return i&&t(i,s),()=>{a.delete(t)}}invokeOnInitCallbacks(t,r){const n=this.onInitCallbacks.get(r);if(n)for(const s of n)try{s(t,r)}catch{}}getOrInitializeService({instanceIdentifier:t,options:r={}}){let n=this.instances.get(t);if(!n&&this.component&&(n=this.component.instanceFactory(this.container,{instanceIdentifier:bP(t),options:r}),this.instances.set(t,n),this.instancesOptions.set(t,r),this.invokeOnInitCallbacks(n,t),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,t,n)}catch{}return n||null}normalizeInstanceIdentifier(t=Ni){return this.component?this.component.multipleInstances?t:Ni:t}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function bP(e){return e===Ni?void 0:e}function IP(e){return e.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class NP{constructor(t){this.name=t,this.providers=new Map}addComponent(t){const r=this.getProvider(t.name);if(r.isComponentSet())throw new Error(`Component ${t.name} has already been registered with ${this.name}`);r.setComponent(t)}addOrOverwriteComponent(t){this.getProvider(t.name).isComponentSet()&&this.providers.delete(t.name),this.addComponent(t)}getProvider(t){if(this.providers.has(t))return this.providers.get(t);const r=new AP(t,this);return this.providers.set(t,r),r}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var et;(function(e){e[e.DEBUG=0]="DEBUG",e[e.VERBOSE=1]="VERBOSE",e[e.INFO=2]="INFO",e[e.WARN=3]="WARN",e[e.ERROR=4]="ERROR",e[e.SILENT=5]="SILENT"})(et||(et={}));const CP={debug:et.DEBUG,verbose:et.VERBOSE,info:et.INFO,warn:et.WARN,error:et.ERROR,silent:et.SILENT},RP=et.INFO,PP={[et.DEBUG]:"log",[et.VERBOSE]:"log",[et.INFO]:"info",[et.WARN]:"warn",[et.ERROR]:"error"},DP=(e,t,...r)=>{if(t<e.logLevel)return;const n=new Date().toISOString(),s=PP[t];if(s)console[s](`[${n}]  ${e.name}:`,...r);else throw new Error(`Attempted to log a message with an invalid logType (value: ${t})`)};class fx{constructor(t){this.name=t,this._logLevel=RP,this._logHandler=DP,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(t){if(!(t in et))throw new TypeError(`Invalid value "${t}" assigned to \`logLevel\``);this._logLevel=t}setLogLevel(t){this._logLevel=typeof t=="string"?CP[t]:t}get logHandler(){return this._logHandler}set logHandler(t){if(typeof t!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t}get userLogHandler(){return this._userLogHandler}set userLogHandler(t){this._userLogHandler=t}debug(...t){this._userLogHandler&&this._userLogHandler(this,et.DEBUG,...t),this._logHandler(this,et.DEBUG,...t)}log(...t){this._userLogHandler&&this._userLogHandler(this,et.VERBOSE,...t),this._logHandler(this,et.VERBOSE,...t)}info(...t){this._userLogHandler&&this._userLogHandler(this,et.INFO,...t),this._logHandler(this,et.INFO,...t)}warn(...t){this._userLogHandler&&this._userLogHandler(this,et.WARN,...t),this._logHandler(this,et.WARN,...t)}error(...t){this._userLogHandler&&this._userLogHandler(this,et.ERROR,...t),this._logHandler(this,et.ERROR,...t)}}const FP=(e,t)=>t.some(r=>e instanceof r);let Yy,Qy;function OP(){return Yy||(Yy=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function MP(){return Qy||(Qy=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const lk=new WeakMap,Sp=new WeakMap,ck=new WeakMap,nm=new WeakMap,hx=new WeakMap;function jP(e){const t=new Promise((r,n)=>{const s=()=>{e.removeEventListener("success",a),e.removeEventListener("error",i)},a=()=>{r(ii(e.result)),s()},i=()=>{n(e.error),s()};e.addEventListener("success",a),e.addEventListener("error",i)});return t.then(r=>{r instanceof IDBCursor&&lk.set(r,e)}).catch(()=>{}),hx.set(t,e),t}function LP(e){if(Sp.has(e))return;const t=new Promise((r,n)=>{const s=()=>{e.removeEventListener("complete",a),e.removeEventListener("error",i),e.removeEventListener("abort",i)},a=()=>{r(),s()},i=()=>{n(e.error||new DOMException("AbortError","AbortError")),s()};e.addEventListener("complete",a),e.addEventListener("error",i),e.addEventListener("abort",i)});Sp.set(e,t)}let Ap={get(e,t,r){if(e instanceof IDBTransaction){if(t==="done")return Sp.get(e);if(t==="objectStoreNames")return e.objectStoreNames||ck.get(e);if(t==="store")return r.objectStoreNames[1]?void 0:r.objectStore(r.objectStoreNames[0])}return ii(e[t])},set(e,t,r){return e[t]=r,!0},has(e,t){return e instanceof IDBTransaction&&(t==="done"||t==="store")?!0:t in e}};function UP(e){Ap=e(Ap)}function VP(e){return e===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(t,...r){const n=e.call(sm(this),t,...r);return ck.set(n,t.sort?t.sort():[t]),ii(n)}:MP().includes(e)?function(...t){return e.apply(sm(this),t),ii(lk.get(this))}:function(...t){return ii(e.apply(sm(this),t))}}function BP(e){return typeof e=="function"?VP(e):(e instanceof IDBTransaction&&LP(e),FP(e,OP())?new Proxy(e,Ap):e)}function ii(e){if(e instanceof IDBRequest)return jP(e);if(nm.has(e))return nm.get(e);const t=BP(e);return t!==e&&(nm.set(e,t),hx.set(t,e)),t}const sm=e=>hx.get(e);function $P(e,t,{blocked:r,upgrade:n,blocking:s,terminated:a}={}){const i=indexedDB.open(e,t),o=ii(i);return n&&i.addEventListener("upgradeneeded",l=>{n(ii(i.result),l.oldVersion,l.newVersion,ii(i.transaction),l)}),r&&i.addEventListener("blocked",l=>r(l.oldVersion,l.newVersion,l)),o.then(l=>{a&&l.addEventListener("close",()=>a()),s&&l.addEventListener("versionchange",u=>s(u.oldVersion,u.newVersion,u))}).catch(()=>{}),o}const WP=["get","getKey","getAll","getAllKeys","count"],zP=["put","add","delete","clear"],am=new Map;function Jy(e,t){if(!(e instanceof IDBDatabase&&!(t in e)&&typeof t=="string"))return;if(am.get(t))return am.get(t);const r=t.replace(/FromIndex$/,""),n=t!==r,s=zP.includes(r);if(!(r in(n?IDBIndex:IDBObjectStore).prototype)||!(s||WP.includes(r)))return;const a=async function(i,...o){const l=this.transaction(i,s?"readwrite":"readonly");let u=l.store;return n&&(u=u.index(o.shift())),(await Promise.all([u[r](...o),s&&l.done]))[0]};return am.set(t,a),a}UP(e=>({...e,get:(t,r,n)=>Jy(t,r)||e.get(t,r,n),has:(t,r)=>!!Jy(t,r)||e.has(t,r)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HP{constructor(t){this.container=t}getPlatformInfoString(){return this.container.getProviders().map(r=>{if(GP(r)){const n=r.getImmediate();return`${n.library}/${n.version}`}else return null}).filter(r=>r).join(" ")}}function GP(e){const t=e.getComponent();return(t==null?void 0:t.type)==="VERSION"}const bp="@firebase/app",Zy="0.10.13";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _a=new fx("@firebase/app"),KP="@firebase/app-compat",qP="@firebase/analytics-compat",XP="@firebase/analytics",YP="@firebase/app-check-compat",QP="@firebase/app-check",JP="@firebase/auth",ZP="@firebase/auth-compat",eD="@firebase/database",tD="@firebase/data-connect",rD="@firebase/database-compat",nD="@firebase/functions",sD="@firebase/functions-compat",aD="@firebase/installations",iD="@firebase/installations-compat",oD="@firebase/messaging",lD="@firebase/messaging-compat",cD="@firebase/performance",uD="@firebase/performance-compat",fD="@firebase/remote-config",hD="@firebase/remote-config-compat",dD="@firebase/storage",mD="@firebase/storage-compat",pD="@firebase/firestore",gD="@firebase/vertexai-preview",xD="@firebase/firestore-compat",vD="firebase",yD="10.14.1";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ip="[DEFAULT]",_D={[bp]:"fire-core",[KP]:"fire-core-compat",[XP]:"fire-analytics",[qP]:"fire-analytics-compat",[QP]:"fire-app-check",[YP]:"fire-app-check-compat",[JP]:"fire-auth",[ZP]:"fire-auth-compat",[eD]:"fire-rtdb",[tD]:"fire-data-connect",[rD]:"fire-rtdb-compat",[nD]:"fire-fn",[sD]:"fire-fn-compat",[aD]:"fire-iid",[iD]:"fire-iid-compat",[oD]:"fire-fcm",[lD]:"fire-fcm-compat",[cD]:"fire-perf",[uD]:"fire-perf-compat",[fD]:"fire-rc",[hD]:"fire-rc-compat",[dD]:"fire-gcs",[mD]:"fire-gcs-compat",[pD]:"fire-fst",[xD]:"fire-fst-compat",[gD]:"fire-vertex","fire-js":"fire-js",[vD]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Jh=new Map,wD=new Map,Np=new Map;function e_(e,t){try{e.container.addComponent(t)}catch(r){_a.debug(`Component ${t.name} failed to register with FirebaseApp ${e.name}`,r)}}function di(e){const t=e.name;if(Np.has(t))return _a.debug(`There were multiple attempts to register component ${t}.`),!1;Np.set(t,e);for(const r of Jh.values())e_(r,e);for(const r of wD.values())e_(r,e);return!0}function Lu(e,t){const r=e.container.getProvider("heartbeat").getImmediate({optional:!0});return r&&r.triggerHeartbeat(),e.container.getProvider(t)}function sa(e){return e.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ED={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},oi=new Mu("app","Firebase",ED);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TD{constructor(t,r,n){this._isDeleted=!1,this._options=Object.assign({},t),this._config=Object.assign({},r),this._name=r.name,this._automaticDataCollectionEnabled=r.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new ya("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(t){this.checkDestroyed(),this._automaticDataCollectionEnabled=t}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(t){this._isDeleted=t}checkDestroyed(){if(this.isDeleted)throw oi.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uo=yD;function uk(e,t={}){let r=e;typeof t!="object"&&(t={name:t});const n=Object.assign({name:Ip,automaticDataCollectionEnabled:!1},t),s=n.name;if(typeof s!="string"||!s)throw oi.create("bad-app-name",{appName:String(s)});if(r||(r=ak()),!r)throw oi.create("no-options");const a=Jh.get(s);if(a){if(Qh(r,a.options)&&Qh(n,a.config))return a;throw oi.create("duplicate-app",{appName:s})}const i=new NP(s);for(const l of Np.values())i.addComponent(l);const o=new TD(r,n,i);return Jh.set(s,o),o}function qd(e=Ip){const t=Jh.get(e);if(!t&&e===Ip&&ak())return uk();if(!t)throw oi.create("no-app",{appName:e});return t}function Xn(e,t,r){var n;let s=(n=_D[e])!==null&&n!==void 0?n:e;r&&(s+=`-${r}`);const a=s.match(/\s|\//),i=t.match(/\s|\//);if(a||i){const o=[`Unable to register library "${s}" with version "${t}":`];a&&o.push(`library name "${s}" contains illegal characters (whitespace or "/")`),a&&i&&o.push("and"),i&&o.push(`version name "${t}" contains illegal characters (whitespace or "/")`),_a.warn(o.join(" "));return}di(new ya(`${s}-version`,()=>({library:s,version:t}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kD="firebase-heartbeat-database",SD=1,uu="firebase-heartbeat-store";let im=null;function fk(){return im||(im=$P(kD,SD,{upgrade:(e,t)=>{switch(t){case 0:try{e.createObjectStore(uu)}catch(r){console.warn(r)}}}}).catch(e=>{throw oi.create("idb-open",{originalErrorMessage:e.message})})),im}async function AD(e){try{const r=(await fk()).transaction(uu),n=await r.objectStore(uu).get(hk(e));return await r.done,n}catch(t){if(t instanceof ks)_a.warn(t.message);else{const r=oi.create("idb-get",{originalErrorMessage:t==null?void 0:t.message});_a.warn(r.message)}}}async function t_(e,t){try{const n=(await fk()).transaction(uu,"readwrite");await n.objectStore(uu).put(t,hk(e)),await n.done}catch(r){if(r instanceof ks)_a.warn(r.message);else{const n=oi.create("idb-set",{originalErrorMessage:r==null?void 0:r.message});_a.warn(n.message)}}}function hk(e){return`${e.name}!${e.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bD=1024,ID=30*24*60*60*1e3;class ND{constructor(t){this.container=t,this._heartbeatsCache=null;const r=this.container.getProvider("app").getImmediate();this._storage=new RD(r),this._heartbeatsCachePromise=this._storage.read().then(n=>(this._heartbeatsCache=n,n))}async triggerHeartbeat(){var t,r;try{const s=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),a=r_();return((t=this._heartbeatsCache)===null||t===void 0?void 0:t.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((r=this._heartbeatsCache)===null||r===void 0?void 0:r.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===a||this._heartbeatsCache.heartbeats.some(i=>i.date===a)?void 0:(this._heartbeatsCache.heartbeats.push({date:a,agent:s}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(i=>{const o=new Date(i.date).valueOf();return Date.now()-o<=ID}),this._storage.overwrite(this._heartbeatsCache))}catch(n){_a.warn(n)}}async getHeartbeatsHeader(){var t;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((t=this._heartbeatsCache)===null||t===void 0?void 0:t.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const r=r_(),{heartbeatsToSend:n,unsentEntries:s}=CD(this._heartbeatsCache.heartbeats),a=Yh(JSON.stringify({version:2,heartbeats:n}));return this._heartbeatsCache.lastSentHeartbeatDate=r,s.length>0?(this._heartbeatsCache.heartbeats=s,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),a}catch(r){return _a.warn(r),""}}}function r_(){return new Date().toISOString().substring(0,10)}function CD(e,t=bD){const r=[];let n=e.slice();for(const s of e){const a=r.find(i=>i.agent===s.agent);if(a){if(a.dates.push(s.date),n_(r)>t){a.dates.pop();break}}else if(r.push({agent:s.agent,dates:[s.date]}),n_(r)>t){r.pop();break}n=n.slice(1)}return{heartbeatsToSend:r,unsentEntries:n}}class RD{constructor(t){this.app=t,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return xP()?vP().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const r=await AD(this.app);return r!=null&&r.heartbeats?r:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(t){var r;if(await this._canUseIndexedDBPromise){const s=await this.read();return t_(this.app,{lastSentHeartbeatDate:(r=t.lastSentHeartbeatDate)!==null&&r!==void 0?r:s.lastSentHeartbeatDate,heartbeats:t.heartbeats})}else return}async add(t){var r;if(await this._canUseIndexedDBPromise){const s=await this.read();return t_(this.app,{lastSentHeartbeatDate:(r=t.lastSentHeartbeatDate)!==null&&r!==void 0?r:s.lastSentHeartbeatDate,heartbeats:[...s.heartbeats,...t.heartbeats]})}else return}}function n_(e){return Yh(JSON.stringify({version:2,heartbeats:e})).length}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function PD(e){di(new ya("platform-logger",t=>new HP(t),"PRIVATE")),di(new ya("heartbeat",t=>new ND(t),"PRIVATE")),Xn(bp,Zy,e),Xn(bp,Zy,"esm2017"),Xn("fire-js","")}PD("");function dx(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,n=Object.getOwnPropertySymbols(e);s<n.length;s++)t.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(e,n[s])&&(r[n[s]]=e[n[s]]);return r}function dk(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const DD=dk,mk=new Mu("auth","Firebase",dk());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Zh=new fx("@firebase/auth");function FD(e,...t){Zh.logLevel<=et.WARN&&Zh.warn(`Auth (${uo}): ${e}`,...t)}function hh(e,...t){Zh.logLevel<=et.ERROR&&Zh.error(`Auth (${uo}): ${e}`,...t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Vs(e,...t){throw px(e,...t)}function ys(e,...t){return px(e,...t)}function mx(e,t,r){const n=Object.assign(Object.assign({},DD()),{[t]:r});return new Mu("auth","Firebase",n).create(t,{appName:e.name})}function $i(e){return mx(e,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function OD(e,t,r){const n=r;if(!(t instanceof n))throw n.name!==t.constructor.name&&Vs(e,"argument-error"),mx(e,"argument-error",`Type of ${t.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function px(e,...t){if(typeof e!="string"){const r=t[0],n=[...t.slice(1)];return n[0]&&(n[0].appName=e.name),e._errorFactory.create(r,...n)}return mk.create(e,...t)}function Le(e,t,...r){if(!e)throw px(t,...r)}function aa(e){const t="INTERNAL ASSERTION FAILED: "+e;throw hh(t),new Error(t)}function wa(e,t){e||aa(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Cp(){var e;return typeof self<"u"&&((e=self.location)===null||e===void 0?void 0:e.href)||""}function MD(){return s_()==="http:"||s_()==="https:"}function s_(){var e;return typeof self<"u"&&((e=self.location)===null||e===void 0?void 0:e.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jD(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(MD()||dP()||"connection"in navigator)?navigator.onLine:!0}function LD(){if(typeof navigator>"u")return null;const e=navigator;return e.languages&&e.languages[0]||e.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Uu{constructor(t,r){this.shortDelay=t,this.longDelay=r,wa(r>t,"Short delay should be less than long delay!"),this.isMobile=uP()||mP()}get(){return jD()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gx(e,t){wa(e.emulator,"Emulator should always be set here");const{url:r}=e.emulator;return t?`${r}${t.startsWith("/")?t.slice(1):t}`:r}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pk{static initialize(t,r,n){this.fetchImpl=t,r&&(this.headersImpl=r),n&&(this.responseImpl=n)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;aa("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;aa("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;aa("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const UD={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const VD=new Uu(3e4,6e4);function xx(e,t){return e.tenantId&&!t.tenantId?Object.assign(Object.assign({},t),{tenantId:e.tenantId}):t}async function Rl(e,t,r,n,s={}){return gk(e,s,async()=>{let a={},i={};n&&(t==="GET"?i=n:a={body:JSON.stringify(n)});const o=ju(Object.assign({key:e.config.apiKey},i)).slice(1),l=await e._getAdditionalHeaders();l["Content-Type"]="application/json",e.languageCode&&(l["X-Firebase-Locale"]=e.languageCode);const u=Object.assign({method:t,headers:l},a);return hP()||(u.referrerPolicy="no-referrer"),pk.fetch()(xk(e,e.config.apiHost,r,o),u)})}async function gk(e,t,r){e._canInitEmulator=!1;const n=Object.assign(Object.assign({},UD),t);try{const s=new $D(e),a=await Promise.race([r(),s.promise]);s.clearNetworkTimeout();const i=await a.json();if("needConfirmation"in i)throw jf(e,"account-exists-with-different-credential",i);if(a.ok&&!("errorMessage"in i))return i;{const o=a.ok?i.errorMessage:i.error.message,[l,u]=o.split(" : ");if(l==="FEDERATED_USER_ID_ALREADY_LINKED")throw jf(e,"credential-already-in-use",i);if(l==="EMAIL_EXISTS")throw jf(e,"email-already-in-use",i);if(l==="USER_DISABLED")throw jf(e,"user-disabled",i);const f=n[l]||l.toLowerCase().replace(/[_\s]+/g,"-");if(u)throw mx(e,f,u);Vs(e,f)}}catch(s){if(s instanceof ks)throw s;Vs(e,"network-request-failed",{message:String(s)})}}async function BD(e,t,r,n,s={}){const a=await Rl(e,t,r,n,s);return"mfaPendingCredential"in a&&Vs(e,"multi-factor-auth-required",{_serverResponse:a}),a}function xk(e,t,r,n){const s=`${t}${r}?${n}`;return e.config.emulator?gx(e.config,s):`${e.config.apiScheme}://${s}`}class $D{constructor(t){this.auth=t,this.timer=null,this.promise=new Promise((r,n)=>{this.timer=setTimeout(()=>n(ys(this.auth,"network-request-failed")),VD.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}}function jf(e,t,r){const n={appName:e.name};r.email&&(n.email=r.email),r.phoneNumber&&(n.phoneNumber=r.phoneNumber);const s=ys(e,t,n);return s.customData._tokenResponse=r,s}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function WD(e,t){return Rl(e,"POST","/v1/accounts:delete",t)}async function vk(e,t){return Rl(e,"POST","/v1/accounts:lookup",t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Nc(e){if(e)try{const t=new Date(Number(e));if(!isNaN(t.getTime()))return t.toUTCString()}catch{}}async function yk(e,t=!1){const r=Pt(e),n=await r.getIdToken(t),s=vx(n);Le(s&&s.exp&&s.auth_time&&s.iat,r.auth,"internal-error");const a=typeof s.firebase=="object"?s.firebase:void 0,i=a==null?void 0:a.sign_in_provider;return{claims:s,token:n,authTime:Nc(om(s.auth_time)),issuedAtTime:Nc(om(s.iat)),expirationTime:Nc(om(s.exp)),signInProvider:i||null,signInSecondFactor:(a==null?void 0:a.sign_in_second_factor)||null}}function om(e){return Number(e)*1e3}function vx(e){const[t,r,n]=e.split(".");if(t===void 0||r===void 0||n===void 0)return hh("JWT malformed, contained fewer than 3 sections"),null;try{const s=nk(r);return s?JSON.parse(s):(hh("Failed to decode base64 JWT payload"),null)}catch(s){return hh("Caught error parsing JWT payload as JSON",s==null?void 0:s.toString()),null}}function a_(e){const t=vx(e);return Le(t,"internal-error"),Le(typeof t.exp<"u","internal-error"),Le(typeof t.iat<"u","internal-error"),Number(t.exp)-Number(t.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function fu(e,t,r=!1){if(r)return t;try{return await t}catch(n){throw n instanceof ks&&zD(n)&&e.auth.currentUser===e&&await e.auth.signOut(),n}}function zD({code:e}){return e==="auth/user-disabled"||e==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HD{constructor(t){this.user=t,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(t){var r;if(t){const n=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),n}else{this.errorBackoff=3e4;const s=((r=this.user.stsTokenManager.expirationTime)!==null&&r!==void 0?r:0)-Date.now()-3e5;return Math.max(0,s)}}schedule(t=!1){if(!this.isRunning)return;const r=this.getInterval(t);this.timerId=setTimeout(async()=>{await this.iteration()},r)}async iteration(){try{await this.user.getIdToken(!0)}catch(t){(t==null?void 0:t.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rp{constructor(t,r){this.createdAt=t,this.lastLoginAt=r,this._initializeTime()}_initializeTime(){this.lastSignInTime=Nc(this.lastLoginAt),this.creationTime=Nc(this.createdAt)}_copy(t){this.createdAt=t.createdAt,this.lastLoginAt=t.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ed(e){var t;const r=e.auth,n=await e.getIdToken(),s=await fu(e,vk(r,{idToken:n}));Le(s==null?void 0:s.users.length,r,"internal-error");const a=s.users[0];e._notifyReloadListener(a);const i=!((t=a.providerUserInfo)===null||t===void 0)&&t.length?_k(a.providerUserInfo):[],o=KD(e.providerData,i),l=e.isAnonymous,u=!(e.email&&a.passwordHash)&&!(o!=null&&o.length),f=l?u:!1,d={uid:a.localId,displayName:a.displayName||null,photoURL:a.photoUrl||null,email:a.email||null,emailVerified:a.emailVerified||!1,phoneNumber:a.phoneNumber||null,tenantId:a.tenantId||null,providerData:o,metadata:new Rp(a.createdAt,a.lastLoginAt),isAnonymous:f};Object.assign(e,d)}async function GD(e){const t=Pt(e);await ed(t),await t.auth._persistUserIfCurrent(t),t.auth._notifyListenersIfCurrent(t)}function KD(e,t){return[...e.filter(n=>!t.some(s=>s.providerId===n.providerId)),...t]}function _k(e){return e.map(t=>{var{providerId:r}=t,n=dx(t,["providerId"]);return{providerId:r,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function qD(e,t){const r=await gk(e,{},async()=>{const n=ju({grant_type:"refresh_token",refresh_token:t}).slice(1),{tokenApiHost:s,apiKey:a}=e.config,i=xk(e,s,"/v1/token",`key=${a}`),o=await e._getAdditionalHeaders();return o["Content-Type"]="application/x-www-form-urlencoded",pk.fetch()(i,{method:"POST",headers:o,body:n})});return{accessToken:r.access_token,expiresIn:r.expires_in,refreshToken:r.refresh_token}}async function XD(e,t){return Rl(e,"POST","/v2/accounts:revokeToken",xx(e,t))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zo{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(t){Le(t.idToken,"internal-error"),Le(typeof t.idToken<"u","internal-error"),Le(typeof t.refreshToken<"u","internal-error");const r="expiresIn"in t&&typeof t.expiresIn<"u"?Number(t.expiresIn):a_(t.idToken);this.updateTokensAndExpiration(t.idToken,t.refreshToken,r)}updateFromIdToken(t){Le(t.length!==0,"internal-error");const r=a_(t);this.updateTokensAndExpiration(t,null,r)}async getToken(t,r=!1){return!r&&this.accessToken&&!this.isExpired?this.accessToken:(Le(this.refreshToken,t,"user-token-expired"),this.refreshToken?(await this.refresh(t,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(t,r){const{accessToken:n,refreshToken:s,expiresIn:a}=await qD(t,r);this.updateTokensAndExpiration(n,s,Number(a))}updateTokensAndExpiration(t,r,n){this.refreshToken=r||null,this.accessToken=t||null,this.expirationTime=Date.now()+n*1e3}static fromJSON(t,r){const{refreshToken:n,accessToken:s,expirationTime:a}=r,i=new Zo;return n&&(Le(typeof n=="string","internal-error",{appName:t}),i.refreshToken=n),s&&(Le(typeof s=="string","internal-error",{appName:t}),i.accessToken=s),a&&(Le(typeof a=="number","internal-error",{appName:t}),i.expirationTime=a),i}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(t){this.accessToken=t.accessToken,this.refreshToken=t.refreshToken,this.expirationTime=t.expirationTime}_clone(){return Object.assign(new Zo,this.toJSON())}_performRefresh(){return aa("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Fa(e,t){Le(typeof e=="string"||typeof e>"u","internal-error",{appName:t})}class ia{constructor(t){var{uid:r,auth:n,stsTokenManager:s}=t,a=dx(t,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new HD(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=r,this.auth=n,this.stsTokenManager=s,this.accessToken=s.accessToken,this.displayName=a.displayName||null,this.email=a.email||null,this.emailVerified=a.emailVerified||!1,this.phoneNumber=a.phoneNumber||null,this.photoURL=a.photoURL||null,this.isAnonymous=a.isAnonymous||!1,this.tenantId=a.tenantId||null,this.providerData=a.providerData?[...a.providerData]:[],this.metadata=new Rp(a.createdAt||void 0,a.lastLoginAt||void 0)}async getIdToken(t){const r=await fu(this,this.stsTokenManager.getToken(this.auth,t));return Le(r,this.auth,"internal-error"),this.accessToken!==r&&(this.accessToken=r,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),r}getIdTokenResult(t){return yk(this,t)}reload(){return GD(this)}_assign(t){this!==t&&(Le(this.uid===t.uid,this.auth,"internal-error"),this.displayName=t.displayName,this.photoURL=t.photoURL,this.email=t.email,this.emailVerified=t.emailVerified,this.phoneNumber=t.phoneNumber,this.isAnonymous=t.isAnonymous,this.tenantId=t.tenantId,this.providerData=t.providerData.map(r=>Object.assign({},r)),this.metadata._copy(t.metadata),this.stsTokenManager._assign(t.stsTokenManager))}_clone(t){const r=new ia(Object.assign(Object.assign({},this),{auth:t,stsTokenManager:this.stsTokenManager._clone()}));return r.metadata._copy(this.metadata),r}_onReload(t){Le(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=t,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(t){this.reloadListener?this.reloadListener(t):this.reloadUserInfo=t}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(t,r=!1){let n=!1;t.idToken&&t.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(t),n=!0),r&&await ed(this),await this.auth._persistUserIfCurrent(this),n&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(sa(this.auth.app))return Promise.reject($i(this.auth));const t=await this.getIdToken();return await fu(this,WD(this.auth,{idToken:t})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(t=>Object.assign({},t)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(t,r){var n,s,a,i,o,l,u,f;const d=(n=r.displayName)!==null&&n!==void 0?n:void 0,m=(s=r.email)!==null&&s!==void 0?s:void 0,p=(a=r.phoneNumber)!==null&&a!==void 0?a:void 0,x=(i=r.photoURL)!==null&&i!==void 0?i:void 0,g=(o=r.tenantId)!==null&&o!==void 0?o:void 0,_=(l=r._redirectEventId)!==null&&l!==void 0?l:void 0,k=(u=r.createdAt)!==null&&u!==void 0?u:void 0,E=(f=r.lastLoginAt)!==null&&f!==void 0?f:void 0,{uid:y,emailVerified:b,isAnonymous:O,providerData:D,stsTokenManager:v}=r;Le(y&&v,t,"internal-error");const T=Zo.fromJSON(this.name,v);Le(typeof y=="string",t,"internal-error"),Fa(d,t.name),Fa(m,t.name),Le(typeof b=="boolean",t,"internal-error"),Le(typeof O=="boolean",t,"internal-error"),Fa(p,t.name),Fa(x,t.name),Fa(g,t.name),Fa(_,t.name),Fa(k,t.name),Fa(E,t.name);const S=new ia({uid:y,auth:t,email:m,emailVerified:b,displayName:d,isAnonymous:O,photoURL:x,phoneNumber:p,tenantId:g,stsTokenManager:T,createdAt:k,lastLoginAt:E});return D&&Array.isArray(D)&&(S.providerData=D.map(N=>Object.assign({},N))),_&&(S._redirectEventId=_),S}static async _fromIdTokenResponse(t,r,n=!1){const s=new Zo;s.updateFromServerResponse(r);const a=new ia({uid:r.localId,auth:t,stsTokenManager:s,isAnonymous:n});return await ed(a),a}static async _fromGetAccountInfoResponse(t,r,n){const s=r.users[0];Le(s.localId!==void 0,"internal-error");const a=s.providerUserInfo!==void 0?_k(s.providerUserInfo):[],i=!(s.email&&s.passwordHash)&&!(a!=null&&a.length),o=new Zo;o.updateFromIdToken(n);const l=new ia({uid:s.localId,auth:t,stsTokenManager:o,isAnonymous:i}),u={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:a,metadata:new Rp(s.createdAt,s.lastLoginAt),isAnonymous:!(s.email&&s.passwordHash)&&!(a!=null&&a.length)};return Object.assign(l,u),l}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const i_=new Map;function oa(e){wa(e instanceof Function,"Expected a class definition");let t=i_.get(e);return t?(wa(t instanceof e,"Instance stored in cache mismatched with class"),t):(t=new e,i_.set(e,t),t)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wk{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(t,r){this.storage[t]=r}async _get(t){const r=this.storage[t];return r===void 0?null:r}async _remove(t){delete this.storage[t]}_addListener(t,r){}_removeListener(t,r){}}wk.type="NONE";const o_=wk;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function dh(e,t,r){return`firebase:${e}:${t}:${r}`}class el{constructor(t,r,n){this.persistence=t,this.auth=r,this.userKey=n;const{config:s,name:a}=this.auth;this.fullUserKey=dh(this.userKey,s.apiKey,a),this.fullPersistenceKey=dh("persistence",s.apiKey,a),this.boundEventHandler=r._onStorageEvent.bind(r),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(t){return this.persistence._set(this.fullUserKey,t.toJSON())}async getCurrentUser(){const t=await this.persistence._get(this.fullUserKey);return t?ia._fromJSON(this.auth,t):null}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(t){if(this.persistence===t)return;const r=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=t,r)return this.setCurrentUser(r)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(t,r,n="authUser"){if(!r.length)return new el(oa(o_),t,n);const s=(await Promise.all(r.map(async u=>{if(await u._isAvailable())return u}))).filter(u=>u);let a=s[0]||oa(o_);const i=dh(n,t.config.apiKey,t.name);let o=null;for(const u of r)try{const f=await u._get(i);if(f){const d=ia._fromJSON(t,f);u!==a&&(o=d),a=u;break}}catch{}const l=s.filter(u=>u._shouldAllowMigration);return!a._shouldAllowMigration||!l.length?new el(a,t,n):(a=l[0],o&&await a._set(i,o.toJSON()),await Promise.all(r.map(async u=>{if(u!==a)try{await u._remove(i)}catch{}})),new el(a,t,n))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function l_(e){const t=e.toLowerCase();if(t.includes("opera/")||t.includes("opr/")||t.includes("opios/"))return"Opera";if(Sk(t))return"IEMobile";if(t.includes("msie")||t.includes("trident/"))return"IE";if(t.includes("edge/"))return"Edge";if(Ek(t))return"Firefox";if(t.includes("silk/"))return"Silk";if(bk(t))return"Blackberry";if(Ik(t))return"Webos";if(Tk(t))return"Safari";if((t.includes("chrome/")||kk(t))&&!t.includes("edge/"))return"Chrome";if(Ak(t))return"Android";{const r=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,n=e.match(r);if((n==null?void 0:n.length)===2)return n[1]}return"Other"}function Ek(e=Kr()){return/firefox\//i.test(e)}function Tk(e=Kr()){const t=e.toLowerCase();return t.includes("safari/")&&!t.includes("chrome/")&&!t.includes("crios/")&&!t.includes("android")}function kk(e=Kr()){return/crios\//i.test(e)}function Sk(e=Kr()){return/iemobile/i.test(e)}function Ak(e=Kr()){return/android/i.test(e)}function bk(e=Kr()){return/blackberry/i.test(e)}function Ik(e=Kr()){return/webos/i.test(e)}function yx(e=Kr()){return/iphone|ipad|ipod/i.test(e)||/macintosh/i.test(e)&&/mobile/i.test(e)}function YD(e=Kr()){var t;return yx(e)&&!!(!((t=window.navigator)===null||t===void 0)&&t.standalone)}function QD(){return pP()&&document.documentMode===10}function Nk(e=Kr()){return yx(e)||Ak(e)||Ik(e)||bk(e)||/windows phone/i.test(e)||Sk(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ck(e,t=[]){let r;switch(e){case"Browser":r=l_(Kr());break;case"Worker":r=`${l_(Kr())}-${e}`;break;default:r=e}const n=t.length?t.join(","):"FirebaseCore-web";return`${r}/JsCore/${uo}/${n}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JD{constructor(t){this.auth=t,this.queue=[]}pushCallback(t,r){const n=a=>new Promise((i,o)=>{try{const l=t(a);i(l)}catch(l){o(l)}});n.onAbort=r,this.queue.push(n);const s=this.queue.length-1;return()=>{this.queue[s]=()=>Promise.resolve()}}async runMiddleware(t){if(this.auth.currentUser===t)return;const r=[];try{for(const n of this.queue)await n(t),n.onAbort&&r.push(n.onAbort)}catch(n){r.reverse();for(const s of r)try{s()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:n==null?void 0:n.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ZD(e,t={}){return Rl(e,"GET","/v2/passwordPolicy",xx(e,t))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const eF=6;class tF{constructor(t){var r,n,s,a;const i=t.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(r=i.minPasswordLength)!==null&&r!==void 0?r:eF,i.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=i.maxPasswordLength),i.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=i.containsLowercaseCharacter),i.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=i.containsUppercaseCharacter),i.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=i.containsNumericCharacter),i.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=i.containsNonAlphanumericCharacter),this.enforcementState=t.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(s=(n=t.allowedNonAlphanumericCharacters)===null||n===void 0?void 0:n.join(""))!==null&&s!==void 0?s:"",this.forceUpgradeOnSignin=(a=t.forceUpgradeOnSignin)!==null&&a!==void 0?a:!1,this.schemaVersion=t.schemaVersion}validatePassword(t){var r,n,s,a,i,o;const l={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(t,l),this.validatePasswordCharacterOptions(t,l),l.isValid&&(l.isValid=(r=l.meetsMinPasswordLength)!==null&&r!==void 0?r:!0),l.isValid&&(l.isValid=(n=l.meetsMaxPasswordLength)!==null&&n!==void 0?n:!0),l.isValid&&(l.isValid=(s=l.containsLowercaseLetter)!==null&&s!==void 0?s:!0),l.isValid&&(l.isValid=(a=l.containsUppercaseLetter)!==null&&a!==void 0?a:!0),l.isValid&&(l.isValid=(i=l.containsNumericCharacter)!==null&&i!==void 0?i:!0),l.isValid&&(l.isValid=(o=l.containsNonAlphanumericCharacter)!==null&&o!==void 0?o:!0),l}validatePasswordLengthOptions(t,r){const n=this.customStrengthOptions.minPasswordLength,s=this.customStrengthOptions.maxPasswordLength;n&&(r.meetsMinPasswordLength=t.length>=n),s&&(r.meetsMaxPasswordLength=t.length<=s)}validatePasswordCharacterOptions(t,r){this.updatePasswordCharacterOptionsStatuses(r,!1,!1,!1,!1);let n;for(let s=0;s<t.length;s++)n=t.charAt(s),this.updatePasswordCharacterOptionsStatuses(r,n>="a"&&n<="z",n>="A"&&n<="Z",n>="0"&&n<="9",this.allowedNonAlphanumericCharacters.includes(n))}updatePasswordCharacterOptionsStatuses(t,r,n,s,a){this.customStrengthOptions.containsLowercaseLetter&&(t.containsLowercaseLetter||(t.containsLowercaseLetter=r)),this.customStrengthOptions.containsUppercaseLetter&&(t.containsUppercaseLetter||(t.containsUppercaseLetter=n)),this.customStrengthOptions.containsNumericCharacter&&(t.containsNumericCharacter||(t.containsNumericCharacter=s)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(t.containsNonAlphanumericCharacter||(t.containsNonAlphanumericCharacter=a))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rF{constructor(t,r,n,s){this.app=t,this.heartbeatServiceProvider=r,this.appCheckServiceProvider=n,this.config=s,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new c_(this),this.idTokenSubscription=new c_(this),this.beforeStateQueue=new JD(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=mk,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=t.name,this.clientVersion=s.sdkClientVersion}_initializeWithPersistence(t,r){return r&&(this._popupRedirectResolver=oa(r)),this._initializationPromise=this.queue(async()=>{var n,s;if(!this._deleted&&(this.persistenceManager=await el.create(this,t),!this._deleted)){if(!((n=this._popupRedirectResolver)===null||n===void 0)&&n._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(r),this.lastNotifiedUid=((s=this.currentUser)===null||s===void 0?void 0:s.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const t=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!t)){if(this.currentUser&&t&&this.currentUser.uid===t.uid){this._currentUser._assign(t),await this.currentUser.getIdToken();return}await this._updateCurrentUser(t,!0)}}async initializeCurrentUserFromIdToken(t){try{const r=await vk(this,{idToken:t}),n=await ia._fromGetAccountInfoResponse(this,r,t);await this.directlySetCurrentUser(n)}catch(r){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",r),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(t){var r;if(sa(this.app)){const i=this.app.settings.authIdToken;return i?new Promise(o=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(i).then(o,o))}):this.directlySetCurrentUser(null)}const n=await this.assertedPersistence.getCurrentUser();let s=n,a=!1;if(t&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const i=(r=this.redirectUser)===null||r===void 0?void 0:r._redirectEventId,o=s==null?void 0:s._redirectEventId,l=await this.tryRedirectSignIn(t);(!i||i===o)&&(l!=null&&l.user)&&(s=l.user,a=!0)}if(!s)return this.directlySetCurrentUser(null);if(!s._redirectEventId){if(a)try{await this.beforeStateQueue.runMiddleware(s)}catch(i){s=n,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(i))}return s?this.reloadAndSetCurrentUserOrClear(s):this.directlySetCurrentUser(null)}return Le(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===s._redirectEventId?this.directlySetCurrentUser(s):this.reloadAndSetCurrentUserOrClear(s)}async tryRedirectSignIn(t){let r=null;try{r=await this._popupRedirectResolver._completeRedirectFn(this,t,!0)}catch{await this._setRedirectUser(null)}return r}async reloadAndSetCurrentUserOrClear(t){try{await ed(t)}catch(r){if((r==null?void 0:r.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(t)}useDeviceLanguage(){this.languageCode=LD()}async _delete(){this._deleted=!0}async updateCurrentUser(t){if(sa(this.app))return Promise.reject($i(this));const r=t?Pt(t):null;return r&&Le(r.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(r&&r._clone(this))}async _updateCurrentUser(t,r=!1){if(!this._deleted)return t&&Le(this.tenantId===t.tenantId,this,"tenant-id-mismatch"),r||await this.beforeStateQueue.runMiddleware(t),this.queue(async()=>{await this.directlySetCurrentUser(t),this.notifyAuthListeners()})}async signOut(){return sa(this.app)?Promise.reject($i(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(t){return sa(this.app)?Promise.reject($i(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(oa(t))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(t){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const r=this._getPasswordPolicyInternal();return r.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):r.validatePassword(t)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const t=await ZD(this),r=new tF(t);this.tenantId===null?this._projectPasswordPolicy=r:this._tenantPasswordPolicies[this.tenantId]=r}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(t){this._errorFactory=new Mu("auth","Firebase",t())}onAuthStateChanged(t,r,n){return this.registerStateListener(this.authStateSubscription,t,r,n)}beforeAuthStateChanged(t,r){return this.beforeStateQueue.pushCallback(t,r)}onIdTokenChanged(t,r,n){return this.registerStateListener(this.idTokenSubscription,t,r,n)}authStateReady(){return new Promise((t,r)=>{if(this.currentUser)t();else{const n=this.onAuthStateChanged(()=>{n(),t()},r)}})}async revokeAccessToken(t){if(this.currentUser){const r=await this.currentUser.getIdToken(),n={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:t,idToken:r};this.tenantId!=null&&(n.tenantId=this.tenantId),await XD(this,n)}}toJSON(){var t;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(t=this._currentUser)===null||t===void 0?void 0:t.toJSON()}}async _setRedirectUser(t,r){const n=await this.getOrInitRedirectPersistenceManager(r);return t===null?n.removeCurrentUser():n.setCurrentUser(t)}async getOrInitRedirectPersistenceManager(t){if(!this.redirectPersistenceManager){const r=t&&oa(t)||this._popupRedirectResolver;Le(r,this,"argument-error"),this.redirectPersistenceManager=await el.create(this,[oa(r._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(t){var r,n;return this._isInitialized&&await this.queue(async()=>{}),((r=this._currentUser)===null||r===void 0?void 0:r._redirectEventId)===t?this._currentUser:((n=this.redirectUser)===null||n===void 0?void 0:n._redirectEventId)===t?this.redirectUser:null}async _persistUserIfCurrent(t){if(t===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(t))}_notifyListenersIfCurrent(t){t===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var t,r;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const n=(r=(t=this.currentUser)===null||t===void 0?void 0:t.uid)!==null&&r!==void 0?r:null;this.lastNotifiedUid!==n&&(this.lastNotifiedUid=n,this.authStateSubscription.next(this.currentUser))}registerStateListener(t,r,n,s){if(this._deleted)return()=>{};const a=typeof r=="function"?r:r.next.bind(r);let i=!1;const o=this._isInitialized?Promise.resolve():this._initializationPromise;if(Le(o,this,"internal-error"),o.then(()=>{i||a(this.currentUser)}),typeof r=="function"){const l=t.addObserver(r,n,s);return()=>{i=!0,l()}}else{const l=t.addObserver(r);return()=>{i=!0,l()}}}async directlySetCurrentUser(t){this.currentUser&&this.currentUser!==t&&this._currentUser._stopProactiveRefresh(),t&&this.isProactiveRefreshEnabled&&t._startProactiveRefresh(),this.currentUser=t,t?await this.assertedPersistence.setCurrentUser(t):await this.assertedPersistence.removeCurrentUser()}queue(t){return this.operations=this.operations.then(t,t),this.operations}get assertedPersistence(){return Le(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(t){!t||this.frameworks.includes(t)||(this.frameworks.push(t),this.frameworks.sort(),this.clientVersion=Ck(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var t;const r={"X-Client-Version":this.clientVersion};this.app.options.appId&&(r["X-Firebase-gmpid"]=this.app.options.appId);const n=await((t=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||t===void 0?void 0:t.getHeartbeatsHeader());n&&(r["X-Firebase-Client"]=n);const s=await this._getAppCheckToken();return s&&(r["X-Firebase-AppCheck"]=s),r}async _getAppCheckToken(){var t;const r=await((t=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||t===void 0?void 0:t.getToken());return r!=null&&r.error&&FD(`Error while retrieving App Check token: ${r.error}`),r==null?void 0:r.token}}function Xd(e){return Pt(e)}class c_{constructor(t){this.auth=t,this.observer=null,this.addObserver=TP(r=>this.observer=r)}get next(){return Le(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let _x={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function nF(e){_x=e}function sF(e){return _x.loadJS(e)}function aF(){return _x.gapiScript}function iF(e){return`__${e}${Math.floor(Math.random()*1e6)}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function oF(e,t){const r=Lu(e,"auth");if(r.isInitialized()){const s=r.getImmediate(),a=r.getOptions();if(Qh(a,t??{}))return s;Vs(s,"already-initialized")}return r.initialize({options:t})}function lF(e,t){const r=(t==null?void 0:t.persistence)||[],n=(Array.isArray(r)?r:[r]).map(oa);t!=null&&t.errorMap&&e._updateErrorMap(t.errorMap),e._initializeWithPersistence(n,t==null?void 0:t.popupRedirectResolver)}function cF(e,t,r){const n=Xd(e);Le(n._canInitEmulator,n,"emulator-config-failed"),Le(/^https?:\/\//.test(t),n,"invalid-emulator-scheme");const s=!1,a=Rk(t),{host:i,port:o}=uF(t),l=o===null?"":`:${o}`;n.config.emulator={url:`${a}//${i}${l}/`},n.settings.appVerificationDisabledForTesting=!0,n.emulatorConfig=Object.freeze({host:i,port:o,protocol:a.replace(":",""),options:Object.freeze({disableWarnings:s})}),fF()}function Rk(e){const t=e.indexOf(":");return t<0?"":e.substr(0,t+1)}function uF(e){const t=Rk(e),r=/(\/\/)?([^?#/]+)/.exec(e.substr(t.length));if(!r)return{host:"",port:null};const n=r[2].split("@").pop()||"",s=/^(\[[^\]]+\])(:|$)/.exec(n);if(s){const a=s[1];return{host:a,port:u_(n.substr(a.length+1))}}else{const[a,i]=n.split(":");return{host:a,port:u_(i)}}}function u_(e){if(!e)return null;const t=Number(e);return isNaN(t)?null:t}function fF(){function e(){const t=document.createElement("p"),r=t.style;t.innerText="Running in emulator mode. Do not use with production credentials.",r.position="fixed",r.width="100%",r.backgroundColor="#ffffff",r.border=".1em solid #000000",r.color="#b50000",r.bottom="0px",r.left="0px",r.margin="0px",r.zIndex="10000",r.textAlign="center",t.classList.add("firebase-emulator-warning"),document.body.appendChild(t)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",e):e())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pk{constructor(t,r){this.providerId=t,this.signInMethod=r}toJSON(){return aa("not implemented")}_getIdTokenResponse(t){return aa("not implemented")}_linkToIdToken(t,r){return aa("not implemented")}_getReauthenticationResolver(t){return aa("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function tl(e,t){return BD(e,"POST","/v1/accounts:signInWithIdp",xx(e,t))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hF="http://localhost";class eo extends Pk{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(t){const r=new eo(t.providerId,t.signInMethod);return t.idToken||t.accessToken?(t.idToken&&(r.idToken=t.idToken),t.accessToken&&(r.accessToken=t.accessToken),t.nonce&&!t.pendingToken&&(r.nonce=t.nonce),t.pendingToken&&(r.pendingToken=t.pendingToken)):t.oauthToken&&t.oauthTokenSecret?(r.accessToken=t.oauthToken,r.secret=t.oauthTokenSecret):Vs("argument-error"),r}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(t){const r=typeof t=="string"?JSON.parse(t):t,{providerId:n,signInMethod:s}=r,a=dx(r,["providerId","signInMethod"]);if(!n||!s)return null;const i=new eo(n,s);return i.idToken=a.idToken||void 0,i.accessToken=a.accessToken||void 0,i.secret=a.secret,i.nonce=a.nonce,i.pendingToken=a.pendingToken||null,i}_getIdTokenResponse(t){const r=this.buildRequest();return tl(t,r)}_linkToIdToken(t,r){const n=this.buildRequest();return n.idToken=r,tl(t,n)}_getReauthenticationResolver(t){const r=this.buildRequest();return r.autoCreate=!1,tl(t,r)}buildRequest(){const t={requestUri:hF,returnSecureToken:!0};if(this.pendingToken)t.pendingToken=this.pendingToken;else{const r={};this.idToken&&(r.id_token=this.idToken),this.accessToken&&(r.access_token=this.accessToken),this.secret&&(r.oauth_token_secret=this.secret),r.providerId=this.providerId,this.nonce&&!this.pendingToken&&(r.nonce=this.nonce),t.postBody=ju(r)}return t}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wx{constructor(t){this.providerId=t,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(t){this.defaultLanguageCode=t}setCustomParameters(t){return this.customParameters=t,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vu extends wx{constructor(){super(...arguments),this.scopes=[]}addScope(t){return this.scopes.includes(t)||this.scopes.push(t),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ba extends Vu{constructor(){super("facebook.com")}static credential(t){return eo._fromParams({providerId:Ba.PROVIDER_ID,signInMethod:Ba.FACEBOOK_SIGN_IN_METHOD,accessToken:t})}static credentialFromResult(t){return Ba.credentialFromTaggedObject(t)}static credentialFromError(t){return Ba.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t||!("oauthAccessToken"in t)||!t.oauthAccessToken)return null;try{return Ba.credential(t.oauthAccessToken)}catch{return null}}}Ba.FACEBOOK_SIGN_IN_METHOD="facebook.com";Ba.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ds extends Vu{constructor(){super("google.com"),this.addScope("profile")}static credential(t,r){return eo._fromParams({providerId:Ds.PROVIDER_ID,signInMethod:Ds.GOOGLE_SIGN_IN_METHOD,idToken:t,accessToken:r})}static credentialFromResult(t){return Ds.credentialFromTaggedObject(t)}static credentialFromError(t){return Ds.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t)return null;const{oauthIdToken:r,oauthAccessToken:n}=t;if(!r&&!n)return null;try{return Ds.credential(r,n)}catch{return null}}}Ds.GOOGLE_SIGN_IN_METHOD="google.com";Ds.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $a extends Vu{constructor(){super("github.com")}static credential(t){return eo._fromParams({providerId:$a.PROVIDER_ID,signInMethod:$a.GITHUB_SIGN_IN_METHOD,accessToken:t})}static credentialFromResult(t){return $a.credentialFromTaggedObject(t)}static credentialFromError(t){return $a.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t||!("oauthAccessToken"in t)||!t.oauthAccessToken)return null;try{return $a.credential(t.oauthAccessToken)}catch{return null}}}$a.GITHUB_SIGN_IN_METHOD="github.com";$a.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wa extends Vu{constructor(){super("twitter.com")}static credential(t,r){return eo._fromParams({providerId:Wa.PROVIDER_ID,signInMethod:Wa.TWITTER_SIGN_IN_METHOD,oauthToken:t,oauthTokenSecret:r})}static credentialFromResult(t){return Wa.credentialFromTaggedObject(t)}static credentialFromError(t){return Wa.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t)return null;const{oauthAccessToken:r,oauthTokenSecret:n}=t;if(!r||!n)return null;try{return Wa.credential(r,n)}catch{return null}}}Wa.TWITTER_SIGN_IN_METHOD="twitter.com";Wa.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xl{constructor(t){this.user=t.user,this.providerId=t.providerId,this._tokenResponse=t._tokenResponse,this.operationType=t.operationType}static async _fromIdTokenResponse(t,r,n,s=!1){const a=await ia._fromIdTokenResponse(t,n,s),i=f_(n);return new xl({user:a,providerId:i,_tokenResponse:n,operationType:r})}static async _forOperation(t,r,n){await t._updateTokensIfNecessary(n,!0);const s=f_(n);return new xl({user:t,providerId:s,_tokenResponse:n,operationType:r})}}function f_(e){return e.providerId?e.providerId:"phoneNumber"in e?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class td extends ks{constructor(t,r,n,s){var a;super(r.code,r.message),this.operationType=n,this.user=s,Object.setPrototypeOf(this,td.prototype),this.customData={appName:t.name,tenantId:(a=t.tenantId)!==null&&a!==void 0?a:void 0,_serverResponse:r.customData._serverResponse,operationType:n}}static _fromErrorAndOperation(t,r,n,s){return new td(t,r,n,s)}}function Dk(e,t,r,n){return(t==="reauthenticate"?r._getReauthenticationResolver(e):r._getIdTokenResponse(e)).catch(a=>{throw a.code==="auth/multi-factor-auth-required"?td._fromErrorAndOperation(e,a,t,n):a})}async function dF(e,t,r=!1){const n=await fu(e,t._linkToIdToken(e.auth,await e.getIdToken()),r);return xl._forOperation(e,"link",n)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function mF(e,t,r=!1){const{auth:n}=e;if(sa(n.app))return Promise.reject($i(n));const s="reauthenticate";try{const a=await fu(e,Dk(n,s,t,e),r);Le(a.idToken,n,"internal-error");const i=vx(a.idToken);Le(i,n,"internal-error");const{sub:o}=i;return Le(e.uid===o,n,"user-mismatch"),xl._forOperation(e,s,a)}catch(a){throw(a==null?void 0:a.code)==="auth/user-not-found"&&Vs(n,"user-mismatch"),a}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function pF(e,t,r=!1){if(sa(e.app))return Promise.reject($i(e));const n="signIn",s=await Dk(e,n,t),a=await xl._fromIdTokenResponse(e,n,s);return r||await e._updateCurrentUser(a.user),a}function gF(e,t,r,n){return Pt(e).onIdTokenChanged(t,r,n)}function xF(e,t,r){return Pt(e).beforeAuthStateChanged(t,r)}function Fk(e,t,r,n){return Pt(e).onAuthStateChanged(t,r,n)}function vF(e){return Pt(e).signOut()}const rd="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ok{constructor(t,r){this.storageRetriever=t,this.type=r}_isAvailable(){try{return this.storage?(this.storage.setItem(rd,"1"),this.storage.removeItem(rd),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(t,r){return this.storage.setItem(t,JSON.stringify(r)),Promise.resolve()}_get(t){const r=this.storage.getItem(t);return Promise.resolve(r?JSON.parse(r):null)}_remove(t){return this.storage.removeItem(t),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yF=1e3,_F=10;class Mk extends Ok{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(t,r)=>this.onStorageEvent(t,r),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=Nk(),this._shouldAllowMigration=!0}forAllChangedKeys(t){for(const r of Object.keys(this.listeners)){const n=this.storage.getItem(r),s=this.localCache[r];n!==s&&t(r,s,n)}}onStorageEvent(t,r=!1){if(!t.key){this.forAllChangedKeys((i,o,l)=>{this.notifyListeners(i,l)});return}const n=t.key;r?this.detachListener():this.stopPolling();const s=()=>{const i=this.storage.getItem(n);!r&&this.localCache[n]===i||this.notifyListeners(n,i)},a=this.storage.getItem(n);QD()&&a!==t.newValue&&t.newValue!==t.oldValue?setTimeout(s,_F):s()}notifyListeners(t,r){this.localCache[t]=r;const n=this.listeners[t];if(n)for(const s of Array.from(n))s(r&&JSON.parse(r))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((t,r,n)=>{this.onStorageEvent(new StorageEvent("storage",{key:t,oldValue:r,newValue:n}),!0)})},yF)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(t,r){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[t]||(this.listeners[t]=new Set,this.localCache[t]=this.storage.getItem(t)),this.listeners[t].add(r)}_removeListener(t,r){this.listeners[t]&&(this.listeners[t].delete(r),this.listeners[t].size===0&&delete this.listeners[t]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(t,r){await super._set(t,r),this.localCache[t]=JSON.stringify(r)}async _get(t){const r=await super._get(t);return this.localCache[t]=JSON.stringify(r),r}async _remove(t){await super._remove(t),delete this.localCache[t]}}Mk.type="LOCAL";const wF=Mk;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jk extends Ok{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(t,r){}_removeListener(t,r){}}jk.type="SESSION";const Lk=jk;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function EF(e){return Promise.all(e.map(async t=>{try{return{fulfilled:!0,value:await t}}catch(r){return{fulfilled:!1,reason:r}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yd{constructor(t){this.eventTarget=t,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(t){const r=this.receivers.find(s=>s.isListeningto(t));if(r)return r;const n=new Yd(t);return this.receivers.push(n),n}isListeningto(t){return this.eventTarget===t}async handleEvent(t){const r=t,{eventId:n,eventType:s,data:a}=r.data,i=this.handlersMap[s];if(!(i!=null&&i.size))return;r.ports[0].postMessage({status:"ack",eventId:n,eventType:s});const o=Array.from(i).map(async u=>u(r.origin,a)),l=await EF(o);r.ports[0].postMessage({status:"done",eventId:n,eventType:s,response:l})}_subscribe(t,r){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[t]||(this.handlersMap[t]=new Set),this.handlersMap[t].add(r)}_unsubscribe(t,r){this.handlersMap[t]&&r&&this.handlersMap[t].delete(r),(!r||this.handlersMap[t].size===0)&&delete this.handlersMap[t],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}Yd.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ex(e="",t=10){let r="";for(let n=0;n<t;n++)r+=Math.floor(Math.random()*10);return e+r}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TF{constructor(t){this.target=t,this.handlers=new Set}removeMessageHandler(t){t.messageChannel&&(t.messageChannel.port1.removeEventListener("message",t.onMessage),t.messageChannel.port1.close()),this.handlers.delete(t)}async _send(t,r,n=50){const s=typeof MessageChannel<"u"?new MessageChannel:null;if(!s)throw new Error("connection_unavailable");let a,i;return new Promise((o,l)=>{const u=Ex("",20);s.port1.start();const f=setTimeout(()=>{l(new Error("unsupported_event"))},n);i={messageChannel:s,onMessage(d){const m=d;if(m.data.eventId===u)switch(m.data.status){case"ack":clearTimeout(f),a=setTimeout(()=>{l(new Error("timeout"))},3e3);break;case"done":clearTimeout(a),o(m.data.response);break;default:clearTimeout(f),clearTimeout(a),l(new Error("invalid_response"));break}}},this.handlers.add(i),s.port1.addEventListener("message",i.onMessage),this.target.postMessage({eventType:t,eventId:u,data:r},[s.port2])}).finally(()=>{i&&this.removeMessageHandler(i)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function js(){return window}function kF(e){js().location.href=e}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Uk(){return typeof js().WorkerGlobalScope<"u"&&typeof js().importScripts=="function"}async function SF(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function AF(){var e;return((e=navigator==null?void 0:navigator.serviceWorker)===null||e===void 0?void 0:e.controller)||null}function bF(){return Uk()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Vk="firebaseLocalStorageDb",IF=1,nd="firebaseLocalStorage",Bk="fbase_key";class Bu{constructor(t){this.request=t}toPromise(){return new Promise((t,r)=>{this.request.addEventListener("success",()=>{t(this.request.result)}),this.request.addEventListener("error",()=>{r(this.request.error)})})}}function Qd(e,t){return e.transaction([nd],t?"readwrite":"readonly").objectStore(nd)}function NF(){const e=indexedDB.deleteDatabase(Vk);return new Bu(e).toPromise()}function Pp(){const e=indexedDB.open(Vk,IF);return new Promise((t,r)=>{e.addEventListener("error",()=>{r(e.error)}),e.addEventListener("upgradeneeded",()=>{const n=e.result;try{n.createObjectStore(nd,{keyPath:Bk})}catch(s){r(s)}}),e.addEventListener("success",async()=>{const n=e.result;n.objectStoreNames.contains(nd)?t(n):(n.close(),await NF(),t(await Pp()))})})}async function h_(e,t,r){const n=Qd(e,!0).put({[Bk]:t,value:r});return new Bu(n).toPromise()}async function CF(e,t){const r=Qd(e,!1).get(t),n=await new Bu(r).toPromise();return n===void 0?null:n.value}function d_(e,t){const r=Qd(e,!0).delete(t);return new Bu(r).toPromise()}const RF=800,PF=3;class $k{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await Pp(),this.db)}async _withRetries(t){let r=0;for(;;)try{const n=await this._openDb();return await t(n)}catch(n){if(r++>PF)throw n;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return Uk()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=Yd._getInstance(bF()),this.receiver._subscribe("keyChanged",async(t,r)=>({keyProcessed:(await this._poll()).includes(r.key)})),this.receiver._subscribe("ping",async(t,r)=>["keyChanged"])}async initializeSender(){var t,r;if(this.activeServiceWorker=await SF(),!this.activeServiceWorker)return;this.sender=new TF(this.activeServiceWorker);const n=await this.sender._send("ping",{},800);n&&!((t=n[0])===null||t===void 0)&&t.fulfilled&&!((r=n[0])===null||r===void 0)&&r.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(t){if(!(!this.sender||!this.activeServiceWorker||AF()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:t},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const t=await Pp();return await h_(t,rd,"1"),await d_(t,rd),!0}catch{}return!1}async _withPendingWrite(t){this.pendingWrites++;try{await t()}finally{this.pendingWrites--}}async _set(t,r){return this._withPendingWrite(async()=>(await this._withRetries(n=>h_(n,t,r)),this.localCache[t]=r,this.notifyServiceWorker(t)))}async _get(t){const r=await this._withRetries(n=>CF(n,t));return this.localCache[t]=r,r}async _remove(t){return this._withPendingWrite(async()=>(await this._withRetries(r=>d_(r,t)),delete this.localCache[t],this.notifyServiceWorker(t)))}async _poll(){const t=await this._withRetries(s=>{const a=Qd(s,!1).getAll();return new Bu(a).toPromise()});if(!t)return[];if(this.pendingWrites!==0)return[];const r=[],n=new Set;if(t.length!==0)for(const{fbase_key:s,value:a}of t)n.add(s),JSON.stringify(this.localCache[s])!==JSON.stringify(a)&&(this.notifyListeners(s,a),r.push(s));for(const s of Object.keys(this.localCache))this.localCache[s]&&!n.has(s)&&(this.notifyListeners(s,null),r.push(s));return r}notifyListeners(t,r){this.localCache[t]=r;const n=this.listeners[t];if(n)for(const s of Array.from(n))s(r)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),RF)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(t,r){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[t]||(this.listeners[t]=new Set,this._get(t)),this.listeners[t].add(r)}_removeListener(t,r){this.listeners[t]&&(this.listeners[t].delete(r),this.listeners[t].size===0&&delete this.listeners[t]),Object.keys(this.listeners).length===0&&this.stopPolling()}}$k.type="LOCAL";const DF=$k;new Uu(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Wk(e,t){return t?oa(t):(Le(e._popupRedirectResolver,e,"argument-error"),e._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tx extends Pk{constructor(t){super("custom","custom"),this.params=t}_getIdTokenResponse(t){return tl(t,this._buildIdpRequest())}_linkToIdToken(t,r){return tl(t,this._buildIdpRequest(r))}_getReauthenticationResolver(t){return tl(t,this._buildIdpRequest())}_buildIdpRequest(t){const r={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return t&&(r.idToken=t),r}}function FF(e){return pF(e.auth,new Tx(e),e.bypassAuthState)}function OF(e){const{auth:t,user:r}=e;return Le(r,t,"internal-error"),mF(r,new Tx(e),e.bypassAuthState)}async function MF(e){const{auth:t,user:r}=e;return Le(r,t,"internal-error"),dF(r,new Tx(e),e.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zk{constructor(t,r,n,s,a=!1){this.auth=t,this.resolver=n,this.user=s,this.bypassAuthState=a,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(r)?r:[r]}execute(){return new Promise(async(t,r)=>{this.pendingPromise={resolve:t,reject:r};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(n){this.reject(n)}})}async onAuthEvent(t){const{urlResponse:r,sessionId:n,postBody:s,tenantId:a,error:i,type:o}=t;if(i){this.reject(i);return}const l={auth:this.auth,requestUri:r,sessionId:n,tenantId:a||void 0,postBody:s||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(o)(l))}catch(u){this.reject(u)}}onError(t){this.reject(t)}getIdpTask(t){switch(t){case"signInViaPopup":case"signInViaRedirect":return FF;case"linkViaPopup":case"linkViaRedirect":return MF;case"reauthViaPopup":case"reauthViaRedirect":return OF;default:Vs(this.auth,"internal-error")}}resolve(t){wa(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(t),this.unregisterAndCleanUp()}reject(t){wa(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(t),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jF=new Uu(2e3,1e4);async function Hk(e,t,r){if(sa(e.app))return Promise.reject(ys(e,"operation-not-supported-in-this-environment"));const n=Xd(e);OD(e,t,wx);const s=Wk(n,r);return new ji(n,"signInViaPopup",t,s).executeNotNull()}class ji extends zk{constructor(t,r,n,s,a){super(t,r,s,a),this.provider=n,this.authWindow=null,this.pollId=null,ji.currentPopupAction&&ji.currentPopupAction.cancel(),ji.currentPopupAction=this}async executeNotNull(){const t=await this.execute();return Le(t,this.auth,"internal-error"),t}async onExecution(){wa(this.filter.length===1,"Popup operations only handle one event");const t=Ex();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],t),this.authWindow.associatedEvent=t,this.resolver._originValidation(this.auth).catch(r=>{this.reject(r)}),this.resolver._isIframeWebStorageSupported(this.auth,r=>{r||this.reject(ys(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var t;return((t=this.authWindow)===null||t===void 0?void 0:t.associatedEvent)||null}cancel(){this.reject(ys(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,ji.currentPopupAction=null}pollUserCancellation(){const t=()=>{var r,n;if(!((n=(r=this.authWindow)===null||r===void 0?void 0:r.window)===null||n===void 0)&&n.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(ys(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(t,jF.get())};t()}}ji.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const LF="pendingRedirect",mh=new Map;class UF extends zk{constructor(t,r,n=!1){super(t,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],r,void 0,n),this.eventId=null}async execute(){let t=mh.get(this.auth._key());if(!t){try{const n=await VF(this.resolver,this.auth)?await super.execute():null;t=()=>Promise.resolve(n)}catch(r){t=()=>Promise.reject(r)}mh.set(this.auth._key(),t)}return this.bypassAuthState||mh.set(this.auth._key(),()=>Promise.resolve(null)),t()}async onAuthEvent(t){if(t.type==="signInViaRedirect")return super.onAuthEvent(t);if(t.type==="unknown"){this.resolve(null);return}if(t.eventId){const r=await this.auth._redirectUserForId(t.eventId);if(r)return this.user=r,super.onAuthEvent(t);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function VF(e,t){const r=WF(t),n=$F(e);if(!await n._isAvailable())return!1;const s=await n._get(r)==="true";return await n._remove(r),s}function BF(e,t){mh.set(e._key(),t)}function $F(e){return oa(e._redirectPersistence)}function WF(e){return dh(LF,e.config.apiKey,e.name)}async function zF(e,t,r=!1){if(sa(e.app))return Promise.reject($i(e));const n=Xd(e),s=Wk(n,t),i=await new UF(n,s,r).execute();return i&&!r&&(delete i.user._redirectEventId,await n._persistUserIfCurrent(i.user),await n._setRedirectUser(null,t)),i}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const HF=10*60*1e3;class GF{constructor(t){this.auth=t,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(t){this.consumers.add(t),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,t)&&(this.sendToConsumer(this.queuedRedirectEvent,t),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(t){this.consumers.delete(t)}onEvent(t){if(this.hasEventBeenHandled(t))return!1;let r=!1;return this.consumers.forEach(n=>{this.isEventForConsumer(t,n)&&(r=!0,this.sendToConsumer(t,n),this.saveEventToCache(t))}),this.hasHandledPotentialRedirect||!KF(t)||(this.hasHandledPotentialRedirect=!0,r||(this.queuedRedirectEvent=t,r=!0)),r}sendToConsumer(t,r){var n;if(t.error&&!Gk(t)){const s=((n=t.error.code)===null||n===void 0?void 0:n.split("auth/")[1])||"internal-error";r.onError(ys(this.auth,s))}else r.onAuthEvent(t)}isEventForConsumer(t,r){const n=r.eventId===null||!!t.eventId&&t.eventId===r.eventId;return r.filter.includes(t.type)&&n}hasEventBeenHandled(t){return Date.now()-this.lastProcessedEventTime>=HF&&this.cachedEventUids.clear(),this.cachedEventUids.has(m_(t))}saveEventToCache(t){this.cachedEventUids.add(m_(t)),this.lastProcessedEventTime=Date.now()}}function m_(e){return[e.type,e.eventId,e.sessionId,e.tenantId].filter(t=>t).join("-")}function Gk({type:e,error:t}){return e==="unknown"&&(t==null?void 0:t.code)==="auth/no-auth-event"}function KF(e){switch(e.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return Gk(e);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function qF(e,t={}){return Rl(e,"GET","/v1/projects",t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const XF=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,YF=/^https?/;async function QF(e){if(e.config.emulator)return;const{authorizedDomains:t}=await qF(e);for(const r of t)try{if(JF(r))return}catch{}Vs(e,"unauthorized-domain")}function JF(e){const t=Cp(),{protocol:r,hostname:n}=new URL(t);if(e.startsWith("chrome-extension://")){const i=new URL(e);return i.hostname===""&&n===""?r==="chrome-extension:"&&e.replace("chrome-extension://","")===t.replace("chrome-extension://",""):r==="chrome-extension:"&&i.hostname===n}if(!YF.test(r))return!1;if(XF.test(e))return n===e;const s=e.replace(/\./g,"\\.");return new RegExp("^(.+\\."+s+"|"+s+")$","i").test(n)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ZF=new Uu(3e4,6e4);function p_(){const e=js().___jsl;if(e!=null&&e.H){for(const t of Object.keys(e.H))if(e.H[t].r=e.H[t].r||[],e.H[t].L=e.H[t].L||[],e.H[t].r=[...e.H[t].L],e.CP)for(let r=0;r<e.CP.length;r++)e.CP[r]=null}}function e3(e){return new Promise((t,r)=>{var n,s,a;function i(){p_(),gapi.load("gapi.iframes",{callback:()=>{t(gapi.iframes.getContext())},ontimeout:()=>{p_(),r(ys(e,"network-request-failed"))},timeout:ZF.get()})}if(!((s=(n=js().gapi)===null||n===void 0?void 0:n.iframes)===null||s===void 0)&&s.Iframe)t(gapi.iframes.getContext());else if(!((a=js().gapi)===null||a===void 0)&&a.load)i();else{const o=iF("iframefcb");return js()[o]=()=>{gapi.load?i():r(ys(e,"network-request-failed"))},sF(`${aF()}?onload=${o}`).catch(l=>r(l))}}).catch(t=>{throw ph=null,t})}let ph=null;function t3(e){return ph=ph||e3(e),ph}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const r3=new Uu(5e3,15e3),n3="__/auth/iframe",s3="emulator/auth/iframe",a3={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},i3=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function o3(e){const t=e.config;Le(t.authDomain,e,"auth-domain-config-required");const r=t.emulator?gx(t,s3):`https://${e.config.authDomain}/${n3}`,n={apiKey:t.apiKey,appName:e.name,v:uo},s=i3.get(e.config.apiHost);s&&(n.eid=s);const a=e._getFrameworks();return a.length&&(n.fw=a.join(",")),`${r}?${ju(n).slice(1)}`}async function l3(e){const t=await t3(e),r=js().gapi;return Le(r,e,"internal-error"),t.open({where:document.body,url:o3(e),messageHandlersFilter:r.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:a3,dontclear:!0},n=>new Promise(async(s,a)=>{await n.restyle({setHideOnLeave:!1});const i=ys(e,"network-request-failed"),o=js().setTimeout(()=>{a(i)},r3.get());function l(){js().clearTimeout(o),s(n)}n.ping(l).then(l,()=>{a(i)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const c3={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},u3=500,f3=600,h3="_blank",d3="http://localhost";class g_{constructor(t){this.window=t,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function m3(e,t,r,n=u3,s=f3){const a=Math.max((window.screen.availHeight-s)/2,0).toString(),i=Math.max((window.screen.availWidth-n)/2,0).toString();let o="";const l=Object.assign(Object.assign({},c3),{width:n.toString(),height:s.toString(),top:a,left:i}),u=Kr().toLowerCase();r&&(o=kk(u)?h3:r),Ek(u)&&(t=t||d3,l.scrollbars="yes");const f=Object.entries(l).reduce((m,[p,x])=>`${m}${p}=${x},`,"");if(YD(u)&&o!=="_self")return p3(t||"",o),new g_(null);const d=window.open(t||"",o,f);Le(d,e,"popup-blocked");try{d.focus()}catch{}return new g_(d)}function p3(e,t){const r=document.createElement("a");r.href=e,r.target=t;const n=document.createEvent("MouseEvent");n.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),r.dispatchEvent(n)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const g3="__/auth/handler",x3="emulator/auth/handler",v3=encodeURIComponent("fac");async function x_(e,t,r,n,s,a){Le(e.config.authDomain,e,"auth-domain-config-required"),Le(e.config.apiKey,e,"invalid-api-key");const i={apiKey:e.config.apiKey,appName:e.name,authType:r,redirectUrl:n,v:uo,eventId:s};if(t instanceof wx){t.setDefaultLanguage(e.languageCode),i.providerId=t.providerId||"",EP(t.getCustomParameters())||(i.customParameters=JSON.stringify(t.getCustomParameters()));for(const[f,d]of Object.entries({}))i[f]=d}if(t instanceof Vu){const f=t.getScopes().filter(d=>d!=="");f.length>0&&(i.scopes=f.join(","))}e.tenantId&&(i.tid=e.tenantId);const o=i;for(const f of Object.keys(o))o[f]===void 0&&delete o[f];const l=await e._getAppCheckToken(),u=l?`#${v3}=${encodeURIComponent(l)}`:"";return`${y3(e)}?${ju(o).slice(1)}${u}`}function y3({config:e}){return e.emulator?gx(e,x3):`https://${e.authDomain}/${g3}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lm="webStorageSupport";class _3{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=Lk,this._completeRedirectFn=zF,this._overrideRedirectResult=BF}async _openPopup(t,r,n,s){var a;wa((a=this.eventManagers[t._key()])===null||a===void 0?void 0:a.manager,"_initialize() not called before _openPopup()");const i=await x_(t,r,n,Cp(),s);return m3(t,i,Ex())}async _openRedirect(t,r,n,s){await this._originValidation(t);const a=await x_(t,r,n,Cp(),s);return kF(a),new Promise(()=>{})}_initialize(t){const r=t._key();if(this.eventManagers[r]){const{manager:s,promise:a}=this.eventManagers[r];return s?Promise.resolve(s):(wa(a,"If manager is not set, promise should be"),a)}const n=this.initAndGetManager(t);return this.eventManagers[r]={promise:n},n.catch(()=>{delete this.eventManagers[r]}),n}async initAndGetManager(t){const r=await l3(t),n=new GF(t);return r.register("authEvent",s=>(Le(s==null?void 0:s.authEvent,t,"invalid-auth-event"),{status:n.onEvent(s.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[t._key()]={manager:n},this.iframes[t._key()]=r,n}_isIframeWebStorageSupported(t,r){this.iframes[t._key()].send(lm,{type:lm},s=>{var a;const i=(a=s==null?void 0:s[0])===null||a===void 0?void 0:a[lm];i!==void 0&&r(!!i),Vs(t,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(t){const r=t._key();return this.originValidationPromises[r]||(this.originValidationPromises[r]=QF(t)),this.originValidationPromises[r]}get _shouldInitProactively(){return Nk()||Tk()||yx()}}const w3=_3;var v_="@firebase/auth",y_="1.7.9";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class E3{constructor(t){this.auth=t,this.internalListeners=new Map}getUid(){var t;return this.assertAuthConfigured(),((t=this.auth.currentUser)===null||t===void 0?void 0:t.uid)||null}async getToken(t){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(t)}:null}addAuthTokenListener(t){if(this.assertAuthConfigured(),this.internalListeners.has(t))return;const r=this.auth.onIdTokenChanged(n=>{t((n==null?void 0:n.stsTokenManager.accessToken)||null)});this.internalListeners.set(t,r),this.updateProactiveRefresh()}removeAuthTokenListener(t){this.assertAuthConfigured();const r=this.internalListeners.get(t);r&&(this.internalListeners.delete(t),r(),this.updateProactiveRefresh())}assertAuthConfigured(){Le(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function T3(e){switch(e){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function k3(e){di(new ya("auth",(t,{options:r})=>{const n=t.getProvider("app").getImmediate(),s=t.getProvider("heartbeat"),a=t.getProvider("app-check-internal"),{apiKey:i,authDomain:o}=n.options;Le(i&&!i.includes(":"),"invalid-api-key",{appName:n.name});const l={apiKey:i,authDomain:o,clientPlatform:e,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:Ck(e)},u=new rF(n,s,a,l);return lF(u,r),u},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((t,r,n)=>{t.getProvider("auth-internal").initialize()})),di(new ya("auth-internal",t=>{const r=Xd(t.getProvider("auth").getImmediate());return(n=>new E3(n))(r)},"PRIVATE").setInstantiationMode("EXPLICIT")),Xn(v_,y_,T3(e)),Xn(v_,y_,"esm2017")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const S3=5*60,A3=ik("authIdTokenMaxAge")||S3;let __=null;const b3=e=>async t=>{const r=t&&await t.getIdTokenResult(),n=r&&(new Date().getTime()-Date.parse(r.issuedAtTime))/1e3;if(n&&n>A3)return;const s=r==null?void 0:r.token;__!==s&&(__=s,await fetch(e,{method:s?"POST":"DELETE",headers:s?{Authorization:`Bearer ${s}`}:{}}))};function I3(e=qd()){const t=Lu(e,"auth");if(t.isInitialized())return t.getImmediate();const r=oF(e,{popupRedirectResolver:w3,persistence:[DF,wF,Lk]}),n=ik("authTokenSyncURL");if(n&&typeof isSecureContext=="boolean"&&isSecureContext){const a=new URL(n,location.origin);if(location.origin===a.origin){const i=b3(a.toString());xF(r,i,()=>i(r.currentUser)),gF(r,o=>i(o))}}const s=sk("auth");return s&&cF(r,`http://${s}`),r}function N3(){var e,t;return(t=(e=document.getElementsByTagName("head"))===null||e===void 0?void 0:e[0])!==null&&t!==void 0?t:document}nF({loadJS(e){return new Promise((t,r)=>{const n=document.createElement("script");n.setAttribute("src",e),n.onload=t,n.onerror=s=>{const a=ys("internal-error");a.customData=s,r(a)},n.type="text/javascript",n.charset="UTF-8",N3().appendChild(n)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});k3("Browser");var w_=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Wi,Kk;(function(){var e;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function t(v,T){function S(){}S.prototype=T.prototype,v.D=T.prototype,v.prototype=new S,v.prototype.constructor=v,v.C=function(N,C,R){for(var F=Array(arguments.length-2),oe=2;oe<arguments.length;oe++)F[oe-2]=arguments[oe];return T.prototype[C].apply(N,F)}}function r(){this.blockSize=-1}function n(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}t(n,r),n.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function s(v,T,S){S||(S=0);var N=Array(16);if(typeof T=="string")for(var C=0;16>C;++C)N[C]=T.charCodeAt(S++)|T.charCodeAt(S++)<<8|T.charCodeAt(S++)<<16|T.charCodeAt(S++)<<24;else for(C=0;16>C;++C)N[C]=T[S++]|T[S++]<<8|T[S++]<<16|T[S++]<<24;T=v.g[0],S=v.g[1],C=v.g[2];var R=v.g[3],F=T+(R^S&(C^R))+N[0]+3614090360&4294967295;T=S+(F<<7&4294967295|F>>>25),F=R+(C^T&(S^C))+N[1]+3905402710&4294967295,R=T+(F<<12&4294967295|F>>>20),F=C+(S^R&(T^S))+N[2]+606105819&4294967295,C=R+(F<<17&4294967295|F>>>15),F=S+(T^C&(R^T))+N[3]+3250441966&4294967295,S=C+(F<<22&4294967295|F>>>10),F=T+(R^S&(C^R))+N[4]+4118548399&4294967295,T=S+(F<<7&4294967295|F>>>25),F=R+(C^T&(S^C))+N[5]+1200080426&4294967295,R=T+(F<<12&4294967295|F>>>20),F=C+(S^R&(T^S))+N[6]+2821735955&4294967295,C=R+(F<<17&4294967295|F>>>15),F=S+(T^C&(R^T))+N[7]+4249261313&4294967295,S=C+(F<<22&4294967295|F>>>10),F=T+(R^S&(C^R))+N[8]+1770035416&4294967295,T=S+(F<<7&4294967295|F>>>25),F=R+(C^T&(S^C))+N[9]+2336552879&4294967295,R=T+(F<<12&4294967295|F>>>20),F=C+(S^R&(T^S))+N[10]+4294925233&4294967295,C=R+(F<<17&4294967295|F>>>15),F=S+(T^C&(R^T))+N[11]+2304563134&4294967295,S=C+(F<<22&4294967295|F>>>10),F=T+(R^S&(C^R))+N[12]+1804603682&4294967295,T=S+(F<<7&4294967295|F>>>25),F=R+(C^T&(S^C))+N[13]+4254626195&4294967295,R=T+(F<<12&4294967295|F>>>20),F=C+(S^R&(T^S))+N[14]+2792965006&4294967295,C=R+(F<<17&4294967295|F>>>15),F=S+(T^C&(R^T))+N[15]+1236535329&4294967295,S=C+(F<<22&4294967295|F>>>10),F=T+(C^R&(S^C))+N[1]+4129170786&4294967295,T=S+(F<<5&4294967295|F>>>27),F=R+(S^C&(T^S))+N[6]+3225465664&4294967295,R=T+(F<<9&4294967295|F>>>23),F=C+(T^S&(R^T))+N[11]+643717713&4294967295,C=R+(F<<14&4294967295|F>>>18),F=S+(R^T&(C^R))+N[0]+3921069994&4294967295,S=C+(F<<20&4294967295|F>>>12),F=T+(C^R&(S^C))+N[5]+3593408605&4294967295,T=S+(F<<5&4294967295|F>>>27),F=R+(S^C&(T^S))+N[10]+38016083&4294967295,R=T+(F<<9&4294967295|F>>>23),F=C+(T^S&(R^T))+N[15]+3634488961&4294967295,C=R+(F<<14&4294967295|F>>>18),F=S+(R^T&(C^R))+N[4]+3889429448&4294967295,S=C+(F<<20&4294967295|F>>>12),F=T+(C^R&(S^C))+N[9]+568446438&4294967295,T=S+(F<<5&4294967295|F>>>27),F=R+(S^C&(T^S))+N[14]+3275163606&4294967295,R=T+(F<<9&4294967295|F>>>23),F=C+(T^S&(R^T))+N[3]+4107603335&4294967295,C=R+(F<<14&4294967295|F>>>18),F=S+(R^T&(C^R))+N[8]+1163531501&4294967295,S=C+(F<<20&4294967295|F>>>12),F=T+(C^R&(S^C))+N[13]+2850285829&4294967295,T=S+(F<<5&4294967295|F>>>27),F=R+(S^C&(T^S))+N[2]+4243563512&4294967295,R=T+(F<<9&4294967295|F>>>23),F=C+(T^S&(R^T))+N[7]+1735328473&4294967295,C=R+(F<<14&4294967295|F>>>18),F=S+(R^T&(C^R))+N[12]+2368359562&4294967295,S=C+(F<<20&4294967295|F>>>12),F=T+(S^C^R)+N[5]+4294588738&4294967295,T=S+(F<<4&4294967295|F>>>28),F=R+(T^S^C)+N[8]+2272392833&4294967295,R=T+(F<<11&4294967295|F>>>21),F=C+(R^T^S)+N[11]+1839030562&4294967295,C=R+(F<<16&4294967295|F>>>16),F=S+(C^R^T)+N[14]+4259657740&4294967295,S=C+(F<<23&4294967295|F>>>9),F=T+(S^C^R)+N[1]+2763975236&4294967295,T=S+(F<<4&4294967295|F>>>28),F=R+(T^S^C)+N[4]+1272893353&4294967295,R=T+(F<<11&4294967295|F>>>21),F=C+(R^T^S)+N[7]+4139469664&4294967295,C=R+(F<<16&4294967295|F>>>16),F=S+(C^R^T)+N[10]+3200236656&4294967295,S=C+(F<<23&4294967295|F>>>9),F=T+(S^C^R)+N[13]+681279174&4294967295,T=S+(F<<4&4294967295|F>>>28),F=R+(T^S^C)+N[0]+3936430074&4294967295,R=T+(F<<11&4294967295|F>>>21),F=C+(R^T^S)+N[3]+3572445317&4294967295,C=R+(F<<16&4294967295|F>>>16),F=S+(C^R^T)+N[6]+76029189&4294967295,S=C+(F<<23&4294967295|F>>>9),F=T+(S^C^R)+N[9]+3654602809&4294967295,T=S+(F<<4&4294967295|F>>>28),F=R+(T^S^C)+N[12]+3873151461&4294967295,R=T+(F<<11&4294967295|F>>>21),F=C+(R^T^S)+N[15]+530742520&4294967295,C=R+(F<<16&4294967295|F>>>16),F=S+(C^R^T)+N[2]+3299628645&4294967295,S=C+(F<<23&4294967295|F>>>9),F=T+(C^(S|~R))+N[0]+4096336452&4294967295,T=S+(F<<6&4294967295|F>>>26),F=R+(S^(T|~C))+N[7]+1126891415&4294967295,R=T+(F<<10&4294967295|F>>>22),F=C+(T^(R|~S))+N[14]+2878612391&4294967295,C=R+(F<<15&4294967295|F>>>17),F=S+(R^(C|~T))+N[5]+4237533241&4294967295,S=C+(F<<21&4294967295|F>>>11),F=T+(C^(S|~R))+N[12]+1700485571&4294967295,T=S+(F<<6&4294967295|F>>>26),F=R+(S^(T|~C))+N[3]+2399980690&4294967295,R=T+(F<<10&4294967295|F>>>22),F=C+(T^(R|~S))+N[10]+4293915773&4294967295,C=R+(F<<15&4294967295|F>>>17),F=S+(R^(C|~T))+N[1]+2240044497&4294967295,S=C+(F<<21&4294967295|F>>>11),F=T+(C^(S|~R))+N[8]+1873313359&4294967295,T=S+(F<<6&4294967295|F>>>26),F=R+(S^(T|~C))+N[15]+4264355552&4294967295,R=T+(F<<10&4294967295|F>>>22),F=C+(T^(R|~S))+N[6]+2734768916&4294967295,C=R+(F<<15&4294967295|F>>>17),F=S+(R^(C|~T))+N[13]+1309151649&4294967295,S=C+(F<<21&4294967295|F>>>11),F=T+(C^(S|~R))+N[4]+4149444226&4294967295,T=S+(F<<6&4294967295|F>>>26),F=R+(S^(T|~C))+N[11]+3174756917&4294967295,R=T+(F<<10&4294967295|F>>>22),F=C+(T^(R|~S))+N[2]+718787259&4294967295,C=R+(F<<15&4294967295|F>>>17),F=S+(R^(C|~T))+N[9]+3951481745&4294967295,v.g[0]=v.g[0]+T&4294967295,v.g[1]=v.g[1]+(C+(F<<21&4294967295|F>>>11))&4294967295,v.g[2]=v.g[2]+C&4294967295,v.g[3]=v.g[3]+R&4294967295}n.prototype.u=function(v,T){T===void 0&&(T=v.length);for(var S=T-this.blockSize,N=this.B,C=this.h,R=0;R<T;){if(C==0)for(;R<=S;)s(this,v,R),R+=this.blockSize;if(typeof v=="string"){for(;R<T;)if(N[C++]=v.charCodeAt(R++),C==this.blockSize){s(this,N),C=0;break}}else for(;R<T;)if(N[C++]=v[R++],C==this.blockSize){s(this,N),C=0;break}}this.h=C,this.o+=T},n.prototype.v=function(){var v=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);v[0]=128;for(var T=1;T<v.length-8;++T)v[T]=0;var S=8*this.o;for(T=v.length-8;T<v.length;++T)v[T]=S&255,S/=256;for(this.u(v),v=Array(16),T=S=0;4>T;++T)for(var N=0;32>N;N+=8)v[S++]=this.g[T]>>>N&255;return v};function a(v,T){var S=o;return Object.prototype.hasOwnProperty.call(S,v)?S[v]:S[v]=T(v)}function i(v,T){this.h=T;for(var S=[],N=!0,C=v.length-1;0<=C;C--){var R=v[C]|0;N&&R==T||(S[C]=R,N=!1)}this.g=S}var o={};function l(v){return-128<=v&&128>v?a(v,function(T){return new i([T|0],0>T?-1:0)}):new i([v|0],0>v?-1:0)}function u(v){if(isNaN(v)||!isFinite(v))return d;if(0>v)return _(u(-v));for(var T=[],S=1,N=0;v>=S;N++)T[N]=v/S|0,S*=4294967296;return new i(T,0)}function f(v,T){if(v.length==0)throw Error("number format error: empty string");if(T=T||10,2>T||36<T)throw Error("radix out of range: "+T);if(v.charAt(0)=="-")return _(f(v.substring(1),T));if(0<=v.indexOf("-"))throw Error('number format error: interior "-" character');for(var S=u(Math.pow(T,8)),N=d,C=0;C<v.length;C+=8){var R=Math.min(8,v.length-C),F=parseInt(v.substring(C,C+R),T);8>R?(R=u(Math.pow(T,R)),N=N.j(R).add(u(F))):(N=N.j(S),N=N.add(u(F)))}return N}var d=l(0),m=l(1),p=l(16777216);e=i.prototype,e.m=function(){if(g(this))return-_(this).m();for(var v=0,T=1,S=0;S<this.g.length;S++){var N=this.i(S);v+=(0<=N?N:4294967296+N)*T,T*=4294967296}return v},e.toString=function(v){if(v=v||10,2>v||36<v)throw Error("radix out of range: "+v);if(x(this))return"0";if(g(this))return"-"+_(this).toString(v);for(var T=u(Math.pow(v,6)),S=this,N="";;){var C=b(S,T).g;S=k(S,C.j(T));var R=((0<S.g.length?S.g[0]:S.h)>>>0).toString(v);if(S=C,x(S))return R+N;for(;6>R.length;)R="0"+R;N=R+N}},e.i=function(v){return 0>v?0:v<this.g.length?this.g[v]:this.h};function x(v){if(v.h!=0)return!1;for(var T=0;T<v.g.length;T++)if(v.g[T]!=0)return!1;return!0}function g(v){return v.h==-1}e.l=function(v){return v=k(this,v),g(v)?-1:x(v)?0:1};function _(v){for(var T=v.g.length,S=[],N=0;N<T;N++)S[N]=~v.g[N];return new i(S,~v.h).add(m)}e.abs=function(){return g(this)?_(this):this},e.add=function(v){for(var T=Math.max(this.g.length,v.g.length),S=[],N=0,C=0;C<=T;C++){var R=N+(this.i(C)&65535)+(v.i(C)&65535),F=(R>>>16)+(this.i(C)>>>16)+(v.i(C)>>>16);N=F>>>16,R&=65535,F&=65535,S[C]=F<<16|R}return new i(S,S[S.length-1]&-2147483648?-1:0)};function k(v,T){return v.add(_(T))}e.j=function(v){if(x(this)||x(v))return d;if(g(this))return g(v)?_(this).j(_(v)):_(_(this).j(v));if(g(v))return _(this.j(_(v)));if(0>this.l(p)&&0>v.l(p))return u(this.m()*v.m());for(var T=this.g.length+v.g.length,S=[],N=0;N<2*T;N++)S[N]=0;for(N=0;N<this.g.length;N++)for(var C=0;C<v.g.length;C++){var R=this.i(N)>>>16,F=this.i(N)&65535,oe=v.i(C)>>>16,te=v.i(C)&65535;S[2*N+2*C]+=F*te,E(S,2*N+2*C),S[2*N+2*C+1]+=R*te,E(S,2*N+2*C+1),S[2*N+2*C+1]+=F*oe,E(S,2*N+2*C+1),S[2*N+2*C+2]+=R*oe,E(S,2*N+2*C+2)}for(N=0;N<T;N++)S[N]=S[2*N+1]<<16|S[2*N];for(N=T;N<2*T;N++)S[N]=0;return new i(S,0)};function E(v,T){for(;(v[T]&65535)!=v[T];)v[T+1]+=v[T]>>>16,v[T]&=65535,T++}function y(v,T){this.g=v,this.h=T}function b(v,T){if(x(T))throw Error("division by zero");if(x(v))return new y(d,d);if(g(v))return T=b(_(v),T),new y(_(T.g),_(T.h));if(g(T))return T=b(v,_(T)),new y(_(T.g),T.h);if(30<v.g.length){if(g(v)||g(T))throw Error("slowDivide_ only works with positive integers.");for(var S=m,N=T;0>=N.l(v);)S=O(S),N=O(N);var C=D(S,1),R=D(N,1);for(N=D(N,2),S=D(S,2);!x(N);){var F=R.add(N);0>=F.l(v)&&(C=C.add(S),R=F),N=D(N,1),S=D(S,1)}return T=k(v,C.j(T)),new y(C,T)}for(C=d;0<=v.l(T);){for(S=Math.max(1,Math.floor(v.m()/T.m())),N=Math.ceil(Math.log(S)/Math.LN2),N=48>=N?1:Math.pow(2,N-48),R=u(S),F=R.j(T);g(F)||0<F.l(v);)S-=N,R=u(S),F=R.j(T);x(R)&&(R=m),C=C.add(R),v=k(v,F)}return new y(C,v)}e.A=function(v){return b(this,v).h},e.and=function(v){for(var T=Math.max(this.g.length,v.g.length),S=[],N=0;N<T;N++)S[N]=this.i(N)&v.i(N);return new i(S,this.h&v.h)},e.or=function(v){for(var T=Math.max(this.g.length,v.g.length),S=[],N=0;N<T;N++)S[N]=this.i(N)|v.i(N);return new i(S,this.h|v.h)},e.xor=function(v){for(var T=Math.max(this.g.length,v.g.length),S=[],N=0;N<T;N++)S[N]=this.i(N)^v.i(N);return new i(S,this.h^v.h)};function O(v){for(var T=v.g.length+1,S=[],N=0;N<T;N++)S[N]=v.i(N)<<1|v.i(N-1)>>>31;return new i(S,v.h)}function D(v,T){var S=T>>5;T%=32;for(var N=v.g.length-S,C=[],R=0;R<N;R++)C[R]=0<T?v.i(R+S)>>>T|v.i(R+S+1)<<32-T:v.i(R+S);return new i(C,v.h)}n.prototype.digest=n.prototype.v,n.prototype.reset=n.prototype.s,n.prototype.update=n.prototype.u,Kk=n,i.prototype.add=i.prototype.add,i.prototype.multiply=i.prototype.j,i.prototype.modulo=i.prototype.A,i.prototype.compare=i.prototype.l,i.prototype.toNumber=i.prototype.m,i.prototype.toString=i.prototype.toString,i.prototype.getBits=i.prototype.i,i.fromNumber=u,i.fromString=f,Wi=i}).apply(typeof w_<"u"?w_:typeof self<"u"?self:typeof window<"u"?window:{});var Lf=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var qk,hc,Xk,gh,Dp,Yk,Qk,Jk;(function(){var e,t=typeof Object.defineProperties=="function"?Object.defineProperty:function(h,w,A){return h==Array.prototype||h==Object.prototype||(h[w]=A.value),h};function r(h){h=[typeof globalThis=="object"&&globalThis,h,typeof window=="object"&&window,typeof self=="object"&&self,typeof Lf=="object"&&Lf];for(var w=0;w<h.length;++w){var A=h[w];if(A&&A.Math==Math)return A}throw Error("Cannot find global object")}var n=r(this);function s(h,w){if(w)e:{var A=n;h=h.split(".");for(var z=0;z<h.length-1;z++){var ce=h[z];if(!(ce in A))break e;A=A[ce]}h=h[h.length-1],z=A[h],w=w(z),w!=z&&w!=null&&t(A,h,{configurable:!0,writable:!0,value:w})}}function a(h,w){h instanceof String&&(h+="");var A=0,z=!1,ce={next:function(){if(!z&&A<h.length){var he=A++;return{value:w(he,h[he]),done:!1}}return z=!0,{done:!0,value:void 0}}};return ce[Symbol.iterator]=function(){return ce},ce}s("Array.prototype.values",function(h){return h||function(){return a(this,function(w,A){return A})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var i=i||{},o=this||self;function l(h){var w=typeof h;return w=w!="object"?w:h?Array.isArray(h)?"array":w:"null",w=="array"||w=="object"&&typeof h.length=="number"}function u(h){var w=typeof h;return w=="object"&&h!=null||w=="function"}function f(h,w,A){return h.call.apply(h.bind,arguments)}function d(h,w,A){if(!h)throw Error();if(2<arguments.length){var z=Array.prototype.slice.call(arguments,2);return function(){var ce=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(ce,z),h.apply(w,ce)}}return function(){return h.apply(w,arguments)}}function m(h,w,A){return m=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?f:d,m.apply(null,arguments)}function p(h,w){var A=Array.prototype.slice.call(arguments,1);return function(){var z=A.slice();return z.push.apply(z,arguments),h.apply(this,z)}}function x(h,w){function A(){}A.prototype=w.prototype,h.aa=w.prototype,h.prototype=new A,h.prototype.constructor=h,h.Qb=function(z,ce,he){for(var Ae=Array(arguments.length-2),Et=2;Et<arguments.length;Et++)Ae[Et-2]=arguments[Et];return w.prototype[ce].apply(z,Ae)}}function g(h){const w=h.length;if(0<w){const A=Array(w);for(let z=0;z<w;z++)A[z]=h[z];return A}return[]}function _(h,w){for(let A=1;A<arguments.length;A++){const z=arguments[A];if(l(z)){const ce=h.length||0,he=z.length||0;h.length=ce+he;for(let Ae=0;Ae<he;Ae++)h[ce+Ae]=z[Ae]}else h.push(z)}}class k{constructor(w,A){this.i=w,this.j=A,this.h=0,this.g=null}get(){let w;return 0<this.h?(this.h--,w=this.g,this.g=w.next,w.next=null):w=this.i(),w}}function E(h){return/^[\s\xa0]*$/.test(h)}function y(){var h=o.navigator;return h&&(h=h.userAgent)?h:""}function b(h){return b[" "](h),h}b[" "]=function(){};var O=y().indexOf("Gecko")!=-1&&!(y().toLowerCase().indexOf("webkit")!=-1&&y().indexOf("Edge")==-1)&&!(y().indexOf("Trident")!=-1||y().indexOf("MSIE")!=-1)&&y().indexOf("Edge")==-1;function D(h,w,A){for(const z in h)w.call(A,h[z],z,h)}function v(h,w){for(const A in h)w.call(void 0,h[A],A,h)}function T(h){const w={};for(const A in h)w[A]=h[A];return w}const S="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function N(h,w){let A,z;for(let ce=1;ce<arguments.length;ce++){z=arguments[ce];for(A in z)h[A]=z[A];for(let he=0;he<S.length;he++)A=S[he],Object.prototype.hasOwnProperty.call(z,A)&&(h[A]=z[A])}}function C(h){var w=1;h=h.split(":");const A=[];for(;0<w&&h.length;)A.push(h.shift()),w--;return h.length&&A.push(h.join(":")),A}function R(h){o.setTimeout(()=>{throw h},0)}function F(){var h=H;let w=null;return h.g&&(w=h.g,h.g=h.g.next,h.g||(h.h=null),w.next=null),w}class oe{constructor(){this.h=this.g=null}add(w,A){const z=te.get();z.set(w,A),this.h?this.h.next=z:this.g=z,this.h=z}}var te=new k(()=>new de,h=>h.reset());class de{constructor(){this.next=this.g=this.h=null}set(w,A){this.h=w,this.g=A,this.next=null}reset(){this.next=this.g=this.h=null}}let ae,X=!1,H=new oe,Z=()=>{const h=o.Promise.resolve(void 0);ae=()=>{h.then(Y)}};var Y=()=>{for(var h;h=F();){try{h.h.call(h.g)}catch(A){R(A)}var w=te;w.j(h),100>w.h&&(w.h++,h.next=w.g,w.g=h)}X=!1};function M(){this.s=this.s,this.C=this.C}M.prototype.s=!1,M.prototype.ma=function(){this.s||(this.s=!0,this.N())},M.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function q(h,w){this.type=h,this.g=this.target=w,this.defaultPrevented=!1}q.prototype.h=function(){this.defaultPrevented=!0};var K=function(){if(!o.addEventListener||!Object.defineProperty)return!1;var h=!1,w=Object.defineProperty({},"passive",{get:function(){h=!0}});try{const A=()=>{};o.addEventListener("test",A,w),o.removeEventListener("test",A,w)}catch{}return h}();function L(h,w){if(q.call(this,h?h.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,h){var A=this.type=h.type,z=h.changedTouches&&h.changedTouches.length?h.changedTouches[0]:null;if(this.target=h.target||h.srcElement,this.g=w,w=h.relatedTarget){if(O){e:{try{b(w.nodeName);var ce=!0;break e}catch{}ce=!1}ce||(w=null)}}else A=="mouseover"?w=h.fromElement:A=="mouseout"&&(w=h.toElement);this.relatedTarget=w,z?(this.clientX=z.clientX!==void 0?z.clientX:z.pageX,this.clientY=z.clientY!==void 0?z.clientY:z.pageY,this.screenX=z.screenX||0,this.screenY=z.screenY||0):(this.clientX=h.clientX!==void 0?h.clientX:h.pageX,this.clientY=h.clientY!==void 0?h.clientY:h.pageY,this.screenX=h.screenX||0,this.screenY=h.screenY||0),this.button=h.button,this.key=h.key||"",this.ctrlKey=h.ctrlKey,this.altKey=h.altKey,this.shiftKey=h.shiftKey,this.metaKey=h.metaKey,this.pointerId=h.pointerId||0,this.pointerType=typeof h.pointerType=="string"?h.pointerType:J[h.pointerType]||"",this.state=h.state,this.i=h,h.defaultPrevented&&L.aa.h.call(this)}}x(L,q);var J={2:"touch",3:"pen",4:"mouse"};L.prototype.h=function(){L.aa.h.call(this);var h=this.i;h.preventDefault?h.preventDefault():h.returnValue=!1};var fe="closure_listenable_"+(1e6*Math.random()|0),we=0;function ge(h,w,A,z,ce){this.listener=h,this.proxy=null,this.src=w,this.type=A,this.capture=!!z,this.ha=ce,this.key=++we,this.da=this.fa=!1}function pe(h){h.da=!0,h.listener=null,h.proxy=null,h.src=null,h.ha=null}function Pe(h){this.src=h,this.g={},this.h=0}Pe.prototype.add=function(h,w,A,z,ce){var he=h.toString();h=this.g[he],h||(h=this.g[he]=[],this.h++);var Ae=Xe(h,w,z,ce);return-1<Ae?(w=h[Ae],A||(w.fa=!1)):(w=new ge(w,this.src,he,!!z,ce),w.fa=A,h.push(w)),w};function G(h,w){var A=w.type;if(A in h.g){var z=h.g[A],ce=Array.prototype.indexOf.call(z,w,void 0),he;(he=0<=ce)&&Array.prototype.splice.call(z,ce,1),he&&(pe(w),h.g[A].length==0&&(delete h.g[A],h.h--))}}function Xe(h,w,A,z){for(var ce=0;ce<h.length;++ce){var he=h[ce];if(!he.da&&he.listener==w&&he.capture==!!A&&he.ha==z)return ce}return-1}var Ve="closure_lm_"+(1e6*Math.random()|0),Ze={};function Oe(h,w,A,z,ce){if(Array.isArray(w)){for(var he=0;he<w.length;he++)Oe(h,w[he],A,z,ce);return null}return A=mr(A),h&&h[fe]?h.K(w,A,u(z)?!!z.capture:!1,ce):Se(h,w,A,!1,z,ce)}function Se(h,w,A,z,ce,he){if(!w)throw Error("Invalid event type");var Ae=u(ce)?!!ce.capture:!!ce,Et=un(h);if(Et||(h[Ve]=Et=new Pe(h)),A=Et.add(w,A,z,Ae,he),A.proxy)return A;if(z=yt(),A.proxy=z,z.src=h,z.listener=A,h.addEventListener)K||(ce=Ae),ce===void 0&&(ce=!1),h.addEventListener(w.toString(),z,ce);else if(h.attachEvent)h.attachEvent(cn(w.toString()),z);else if(h.addListener&&h.removeListener)h.addListener(z);else throw Error("addEventListener and attachEvent are unavailable.");return A}function yt(){function h(A){return w.call(h.src,h.listener,A)}const w=Gs;return h}function Qt(h,w,A,z,ce){if(Array.isArray(w))for(var he=0;he<w.length;he++)Qt(h,w[he],A,z,ce);else z=u(z)?!!z.capture:!!z,A=mr(A),h&&h[fe]?(h=h.i,w=String(w).toString(),w in h.g&&(he=h.g[w],A=Xe(he,A,z,ce),-1<A&&(pe(he[A]),Array.prototype.splice.call(he,A,1),he.length==0&&(delete h.g[w],h.h--)))):h&&(h=un(h))&&(w=h.g[w.toString()],h=-1,w&&(h=Xe(w,A,z,ce)),(A=-1<h?w[h]:null)&&dr(A))}function dr(h){if(typeof h!="number"&&h&&!h.da){var w=h.src;if(w&&w[fe])G(w.i,h);else{var A=h.type,z=h.proxy;w.removeEventListener?w.removeEventListener(A,z,h.capture):w.detachEvent?w.detachEvent(cn(A),z):w.addListener&&w.removeListener&&w.removeListener(z),(A=un(w))?(G(A,h),A.h==0&&(A.src=null,w[Ve]=null)):pe(h)}}}function cn(h){return h in Ze?Ze[h]:Ze[h]="on"+h}function Gs(h,w){if(h.da)h=!0;else{w=new L(w,this);var A=h.listener,z=h.ha||h.src;h.fa&&dr(h),h=A.call(z,w)}return h}function un(h){return h=h[Ve],h instanceof Pe?h:null}var At="__closure_events_fn_"+(1e9*Math.random()>>>0);function mr(h){return typeof h=="function"?h:(h[At]||(h[At]=function(w){return h.handleEvent(w)}),h[At])}function _t(){M.call(this),this.i=new Pe(this),this.M=this,this.F=null}x(_t,M),_t.prototype[fe]=!0,_t.prototype.removeEventListener=function(h,w,A,z){Qt(this,h,w,A,z)};function bt(h,w){var A,z=h.F;if(z)for(A=[];z;z=z.F)A.push(z);if(h=h.M,z=w.type||w,typeof w=="string")w=new q(w,h);else if(w instanceof q)w.target=w.target||h;else{var ce=w;w=new q(z,h),N(w,ce)}if(ce=!0,A)for(var he=A.length-1;0<=he;he--){var Ae=w.g=A[he];ce=mt(Ae,z,!0,w)&&ce}if(Ae=w.g=h,ce=mt(Ae,z,!0,w)&&ce,ce=mt(Ae,z,!1,w)&&ce,A)for(he=0;he<A.length;he++)Ae=w.g=A[he],ce=mt(Ae,z,!1,w)&&ce}_t.prototype.N=function(){if(_t.aa.N.call(this),this.i){var h=this.i,w;for(w in h.g){for(var A=h.g[w],z=0;z<A.length;z++)pe(A[z]);delete h.g[w],h.h--}}this.F=null},_t.prototype.K=function(h,w,A,z){return this.i.add(String(h),w,!1,A,z)},_t.prototype.L=function(h,w,A,z){return this.i.add(String(h),w,!0,A,z)};function mt(h,w,A,z){if(w=h.i.g[String(w)],!w)return!0;w=w.concat();for(var ce=!0,he=0;he<w.length;++he){var Ae=w[he];if(Ae&&!Ae.da&&Ae.capture==A){var Et=Ae.listener,wr=Ae.ha||Ae.src;Ae.fa&&G(h.i,Ae),ce=Et.call(wr,z)!==!1&&ce}}return ce&&!z.defaultPrevented}function jt(h,w,A){if(typeof h=="function")A&&(h=m(h,A));else if(h&&typeof h.handleEvent=="function")h=m(h.handleEvent,h);else throw Error("Invalid listener argument");return 2147483647<Number(w)?-1:o.setTimeout(h,w||0)}function Be(h){h.g=jt(()=>{h.g=null,h.i&&(h.i=!1,Be(h))},h.l);const w=h.h;h.h=null,h.m.apply(null,w)}class wt extends M{constructor(w,A){super(),this.m=w,this.l=A,this.h=null,this.i=!1,this.g=null}j(w){this.h=arguments,this.g?this.i=!0:Be(this)}N(){super.N(),this.g&&(o.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Jt(h){M.call(this),this.h=h,this.g={}}x(Jt,M);var ft=[];function Tn(h){D(h.g,function(w,A){this.g.hasOwnProperty(A)&&dr(w)},h),h.g={}}Jt.prototype.N=function(){Jt.aa.N.call(this),Tn(this)},Jt.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Ks=o.JSON.stringify,wo=o.JSON.parse,Ul=class{stringify(h){return o.JSON.stringify(h,void 0)}parse(h){return o.JSON.parse(h,void 0)}};function qs(){}qs.prototype.h=null;function Ss(h){return h.h||(h.h=h.i())}function Na(){}var ns={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function Xs(){q.call(this,"d")}x(Xs,q);function As(){q.call(this,"c")}x(As,q);var Un={},Eo=null;function Ys(){return Eo=Eo||new _t}Un.La="serverreachability";function Qs(h){q.call(this,Un.La,h)}x(Qs,q);function Vn(h){const w=Ys();bt(w,new Qs(w))}Un.STAT_EVENT="statevent";function To(h,w){q.call(this,Un.STAT_EVENT,h),this.stat=w}x(To,q);function ir(h){const w=Ys();bt(w,new To(w,h))}Un.Ma="timingevent";function Q(h,w){q.call(this,Un.Ma,h),this.size=w}x(Q,q);function ne(h,w){if(typeof h!="function")throw Error("Fn must not be null and must be a function");return o.setTimeout(function(){h()},w)}function ue(){this.g=!0}ue.prototype.xa=function(){this.g=!1};function ve(h,w,A,z,ce,he){h.info(function(){if(h.g)if(he)for(var Ae="",Et=he.split("&"),wr=0;wr<Et.length;wr++){var ct=Et[wr].split("=");if(1<ct.length){var Pr=ct[0];ct=ct[1];var Dr=Pr.split("_");Ae=2<=Dr.length&&Dr[1]=="type"?Ae+(Pr+"="+ct+"&"):Ae+(Pr+"=redacted&")}}else Ae=null;else Ae=he;return"XMLHTTP REQ ("+z+") [attempt "+ce+"]: "+w+`
`+A+`
`+Ae})}function be(h,w,A,z,ce,he,Ae){h.info(function(){return"XMLHTTP RESP ("+z+") [ attempt "+ce+"]: "+w+`
`+A+`
`+he+" "+Ae})}function I(h,w,A,z){h.info(function(){return"XMLHTTP TEXT ("+w+"): "+P(h,A)+(z?" "+z:"")})}function W(h,w){h.info(function(){return"TIMEOUT: "+w})}ue.prototype.info=function(){};function P(h,w){if(!h.g)return w;if(!w)return null;try{var A=JSON.parse(w);if(A){for(h=0;h<A.length;h++)if(Array.isArray(A[h])){var z=A[h];if(!(2>z.length)){var ce=z[1];if(Array.isArray(ce)&&!(1>ce.length)){var he=ce[0];if(he!="noop"&&he!="stop"&&he!="close")for(var Ae=1;Ae<ce.length;Ae++)ce[Ae]=""}}}}return Ks(A)}catch{return w}}var j={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},V={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},B;function ee(){}x(ee,qs),ee.prototype.g=function(){return new XMLHttpRequest},ee.prototype.i=function(){return{}},B=new ee;function le(h,w,A,z){this.j=h,this.i=w,this.l=A,this.R=z||1,this.U=new Jt(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new ie}function ie(){this.i=null,this.g="",this.h=!1}var se={},re={};function me(h,w,A){h.L=1,h.v=uf(Js(w)),h.m=A,h.P=!0,Te(h,null)}function Te(h,w){h.F=Date.now(),ke(h),h.A=Js(h.v);var A=h.A,z=h.R;Array.isArray(z)||(z=[String(z)]),Qv(A.i,"t",z),h.C=0,A=h.j.J,h.h=new ie,h.g=p1(h.j,A?w:null,!h.m),0<h.O&&(h.M=new wt(m(h.Y,h,h.g),h.O)),w=h.U,A=h.g,z=h.ca;var ce="readystatechange";Array.isArray(ce)||(ce&&(ft[0]=ce.toString()),ce=ft);for(var he=0;he<ce.length;he++){var Ae=Oe(A,ce[he],z||w.handleEvent,!1,w.h||w);if(!Ae)break;w.g[Ae.key]=Ae}w=h.H?T(h.H):{},h.m?(h.u||(h.u="POST"),w["Content-Type"]="application/x-www-form-urlencoded",h.g.ea(h.A,h.u,h.m,w)):(h.u="GET",h.g.ea(h.A,h.u,null,w)),Vn(),ve(h.i,h.u,h.A,h.l,h.R,h.m)}le.prototype.ca=function(h){h=h.target;const w=this.M;w&&Zs(h)==3?w.j():this.Y(h)},le.prototype.Y=function(h){try{if(h==this.g)e:{const Dr=Zs(this.g);var w=this.g.Ba();const Ao=this.g.Z();if(!(3>Dr)&&(Dr!=3||this.g&&(this.h.h||this.g.oa()||s1(this.g)))){this.J||Dr!=4||w==7||(w==8||0>=Ao?Vn(3):Vn(2)),it(this);var A=this.g.Z();this.X=A;t:if(Ie(this)){var z=s1(this.g);h="";var ce=z.length,he=Zs(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){pt(this),Ye(this);var Ae="";break t}this.h.i=new o.TextDecoder}for(w=0;w<ce;w++)this.h.h=!0,h+=this.h.i.decode(z[w],{stream:!(he&&w==ce-1)});z.length=0,this.h.g+=h,this.C=0,Ae=this.h.g}else Ae=this.g.oa();if(this.o=A==200,be(this.i,this.u,this.A,this.l,this.R,Dr,A),this.o){if(this.T&&!this.K){t:{if(this.g){var Et,wr=this.g;if((Et=wr.g?wr.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!E(Et)){var ct=Et;break t}}ct=null}if(A=ct)I(this.i,this.l,A,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,fn(this,A);else{this.o=!1,this.s=3,ir(12),pt(this),Ye(this);break e}}if(this.P){A=!0;let ss;for(;!this.J&&this.C<Ae.length;)if(ss=ye(this,Ae),ss==re){Dr==4&&(this.s=4,ir(14),A=!1),I(this.i,this.l,null,"[Incomplete Response]");break}else if(ss==se){this.s=4,ir(15),I(this.i,this.l,Ae,"[Invalid Chunk]"),A=!1;break}else I(this.i,this.l,ss,null),fn(this,ss);if(Ie(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Dr!=4||Ae.length!=0||this.h.h||(this.s=1,ir(16),A=!1),this.o=this.o&&A,!A)I(this.i,this.l,Ae,"[Invalid Chunked Response]"),pt(this),Ye(this);else if(0<Ae.length&&!this.W){this.W=!0;var Pr=this.j;Pr.g==this&&Pr.ba&&!Pr.M&&(Pr.j.info("Great, no buffering proxy detected. Bytes received: "+Ae.length),S0(Pr),Pr.M=!0,ir(11))}}else I(this.i,this.l,Ae,null),fn(this,Ae);Dr==4&&pt(this),this.o&&!this.J&&(Dr==4?f1(this.j,this):(this.o=!1,ke(this)))}else BI(this.g),A==400&&0<Ae.indexOf("Unknown SID")?(this.s=3,ir(12)):(this.s=0,ir(13)),pt(this),Ye(this)}}}catch{}finally{}};function Ie(h){return h.g?h.u=="GET"&&h.L!=2&&h.j.Ca:!1}function ye(h,w){var A=h.C,z=w.indexOf(`
`,A);return z==-1?re:(A=Number(w.substring(A,z)),isNaN(A)?se:(z+=1,z+A>w.length?re:(w=w.slice(z,z+A),h.C=z+A,w)))}le.prototype.cancel=function(){this.J=!0,pt(this)};function ke(h){h.S=Date.now()+h.I,Me(h,h.I)}function Me(h,w){if(h.B!=null)throw Error("WatchDog timer not null");h.B=ne(m(h.ba,h),w)}function it(h){h.B&&(o.clearTimeout(h.B),h.B=null)}le.prototype.ba=function(){this.B=null;const h=Date.now();0<=h-this.S?(W(this.i,this.A),this.L!=2&&(Vn(),ir(17)),pt(this),this.s=2,Ye(this)):Me(this,this.S-h)};function Ye(h){h.j.G==0||h.J||f1(h.j,h)}function pt(h){it(h);var w=h.M;w&&typeof w.ma=="function"&&w.ma(),h.M=null,Tn(h.U),h.g&&(w=h.g,h.g=null,w.abort(),w.ma())}function fn(h,w){try{var A=h.j;if(A.G!=0&&(A.g==h||rt(A.h,h))){if(!h.K&&rt(A.h,h)&&A.G==3){try{var z=A.Da.g.parse(w)}catch{z=null}if(Array.isArray(z)&&z.length==3){var ce=z;if(ce[0]==0){e:if(!A.u){if(A.g)if(A.g.F+3e3<h.F)gf(A),mf(A);else break e;k0(A),ir(18)}}else A.za=ce[1],0<A.za-A.T&&37500>ce[2]&&A.F&&A.v==0&&!A.C&&(A.C=ne(m(A.Za,A),6e3));if(1>=Bn(A.h)&&A.ca){try{A.ca()}catch{}A.ca=void 0}}else Ai(A,11)}else if((h.K||A.g==h)&&gf(A),!E(w))for(ce=A.Da.g.parse(w),w=0;w<ce.length;w++){let ct=ce[w];if(A.T=ct[0],ct=ct[1],A.G==2)if(ct[0]=="c"){A.K=ct[1],A.ia=ct[2];const Pr=ct[3];Pr!=null&&(A.la=Pr,A.j.info("VER="+A.la));const Dr=ct[4];Dr!=null&&(A.Aa=Dr,A.j.info("SVER="+A.Aa));const Ao=ct[5];Ao!=null&&typeof Ao=="number"&&0<Ao&&(z=1.5*Ao,A.L=z,A.j.info("backChannelRequestTimeoutMs_="+z)),z=A;const ss=h.g;if(ss){const vf=ss.g?ss.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(vf){var he=z.h;he.g||vf.indexOf("spdy")==-1&&vf.indexOf("quic")==-1&&vf.indexOf("h2")==-1||(he.j=he.l,he.g=new Set,he.h&&(bs(he,he.h),he.h=null))}if(z.D){const A0=ss.g?ss.g.getResponseHeader("X-HTTP-Session-Id"):null;A0&&(z.ya=A0,It(z.I,z.D,A0))}}A.G=3,A.l&&A.l.ua(),A.ba&&(A.R=Date.now()-h.F,A.j.info("Handshake RTT: "+A.R+"ms")),z=A;var Ae=h;if(z.qa=m1(z,z.J?z.ia:null,z.W),Ae.K){Vl(z.h,Ae);var Et=Ae,wr=z.L;wr&&(Et.I=wr),Et.B&&(it(Et),ke(Et)),z.g=Ae}else c1(z);0<A.i.length&&pf(A)}else ct[0]!="stop"&&ct[0]!="close"||Ai(A,7);else A.G==3&&(ct[0]=="stop"||ct[0]=="close"?ct[0]=="stop"?Ai(A,7):T0(A):ct[0]!="noop"&&A.l&&A.l.ta(ct),A.v=0)}}Vn(4)}catch{}}var Ke=class{constructor(h,w){this.g=h,this.map=w}};function ht(h){this.l=h||10,o.PerformanceNavigationTiming?(h=o.performance.getEntriesByType("navigation"),h=0<h.length&&(h[0].nextHopProtocol=="hq"||h[0].nextHopProtocol=="h2")):h=!!(o.chrome&&o.chrome.loadTimes&&o.chrome.loadTimes()&&o.chrome.loadTimes().wasFetchedViaSpdy),this.j=h?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function _r(h){return h.h?!0:h.g?h.g.size>=h.j:!1}function Bn(h){return h.h?1:h.g?h.g.size:0}function rt(h,w){return h.h?h.h==w:h.g?h.g.has(w):!1}function bs(h,w){h.g?h.g.add(w):h.h=w}function Vl(h,w){h.h&&h.h==w?h.h=null:h.g&&h.g.has(w)&&h.g.delete(w)}ht.prototype.cancel=function(){if(this.i=of(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const h of this.g.values())h.cancel();this.g.clear()}};function of(h){if(h.h!=null)return h.i.concat(h.h.D);if(h.g!=null&&h.g.size!==0){let w=h.i;for(const A of h.g.values())w=w.concat(A.D);return w}return g(h.i)}function AI(h){if(h.V&&typeof h.V=="function")return h.V();if(typeof Map<"u"&&h instanceof Map||typeof Set<"u"&&h instanceof Set)return Array.from(h.values());if(typeof h=="string")return h.split("");if(l(h)){for(var w=[],A=h.length,z=0;z<A;z++)w.push(h[z]);return w}w=[],A=0;for(z in h)w[A++]=h[z];return w}function bI(h){if(h.na&&typeof h.na=="function")return h.na();if(!h.V||typeof h.V!="function"){if(typeof Map<"u"&&h instanceof Map)return Array.from(h.keys());if(!(typeof Set<"u"&&h instanceof Set)){if(l(h)||typeof h=="string"){var w=[];h=h.length;for(var A=0;A<h;A++)w.push(A);return w}w=[],A=0;for(const z in h)w[A++]=z;return w}}}function Hv(h,w){if(h.forEach&&typeof h.forEach=="function")h.forEach(w,void 0);else if(l(h)||typeof h=="string")Array.prototype.forEach.call(h,w,void 0);else for(var A=bI(h),z=AI(h),ce=z.length,he=0;he<ce;he++)w.call(void 0,z[he],A&&A[he],h)}var Gv=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function II(h,w){if(h){h=h.split("&");for(var A=0;A<h.length;A++){var z=h[A].indexOf("="),ce=null;if(0<=z){var he=h[A].substring(0,z);ce=h[A].substring(z+1)}else he=h[A];w(he,ce?decodeURIComponent(ce.replace(/\+/g," ")):"")}}}function Si(h){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,h instanceof Si){this.h=h.h,lf(this,h.j),this.o=h.o,this.g=h.g,cf(this,h.s),this.l=h.l;var w=h.i,A=new Wl;A.i=w.i,w.g&&(A.g=new Map(w.g),A.h=w.h),Kv(this,A),this.m=h.m}else h&&(w=String(h).match(Gv))?(this.h=!1,lf(this,w[1]||"",!0),this.o=Bl(w[2]||""),this.g=Bl(w[3]||"",!0),cf(this,w[4]),this.l=Bl(w[5]||"",!0),Kv(this,w[6]||"",!0),this.m=Bl(w[7]||"")):(this.h=!1,this.i=new Wl(null,this.h))}Si.prototype.toString=function(){var h=[],w=this.j;w&&h.push($l(w,qv,!0),":");var A=this.g;return(A||w=="file")&&(h.push("//"),(w=this.o)&&h.push($l(w,qv,!0),"@"),h.push(encodeURIComponent(String(A)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),A=this.s,A!=null&&h.push(":",String(A))),(A=this.l)&&(this.g&&A.charAt(0)!="/"&&h.push("/"),h.push($l(A,A.charAt(0)=="/"?RI:CI,!0))),(A=this.i.toString())&&h.push("?",A),(A=this.m)&&h.push("#",$l(A,DI)),h.join("")};function Js(h){return new Si(h)}function lf(h,w,A){h.j=A?Bl(w,!0):w,h.j&&(h.j=h.j.replace(/:$/,""))}function cf(h,w){if(w){if(w=Number(w),isNaN(w)||0>w)throw Error("Bad port number "+w);h.s=w}else h.s=null}function Kv(h,w,A){w instanceof Wl?(h.i=w,FI(h.i,h.h)):(A||(w=$l(w,PI)),h.i=new Wl(w,h.h))}function It(h,w,A){h.i.set(w,A)}function uf(h){return It(h,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),h}function Bl(h,w){return h?w?decodeURI(h.replace(/%25/g,"%2525")):decodeURIComponent(h):""}function $l(h,w,A){return typeof h=="string"?(h=encodeURI(h).replace(w,NI),A&&(h=h.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),h):null}function NI(h){return h=h.charCodeAt(0),"%"+(h>>4&15).toString(16)+(h&15).toString(16)}var qv=/[#\/\?@]/g,CI=/[#\?:]/g,RI=/[#\?]/g,PI=/[#\?@]/g,DI=/#/g;function Wl(h,w){this.h=this.g=null,this.i=h||null,this.j=!!w}function Ca(h){h.g||(h.g=new Map,h.h=0,h.i&&II(h.i,function(w,A){h.add(decodeURIComponent(w.replace(/\+/g," ")),A)}))}e=Wl.prototype,e.add=function(h,w){Ca(this),this.i=null,h=ko(this,h);var A=this.g.get(h);return A||this.g.set(h,A=[]),A.push(w),this.h+=1,this};function Xv(h,w){Ca(h),w=ko(h,w),h.g.has(w)&&(h.i=null,h.h-=h.g.get(w).length,h.g.delete(w))}function Yv(h,w){return Ca(h),w=ko(h,w),h.g.has(w)}e.forEach=function(h,w){Ca(this),this.g.forEach(function(A,z){A.forEach(function(ce){h.call(w,ce,z,this)},this)},this)},e.na=function(){Ca(this);const h=Array.from(this.g.values()),w=Array.from(this.g.keys()),A=[];for(let z=0;z<w.length;z++){const ce=h[z];for(let he=0;he<ce.length;he++)A.push(w[z])}return A},e.V=function(h){Ca(this);let w=[];if(typeof h=="string")Yv(this,h)&&(w=w.concat(this.g.get(ko(this,h))));else{h=Array.from(this.g.values());for(let A=0;A<h.length;A++)w=w.concat(h[A])}return w},e.set=function(h,w){return Ca(this),this.i=null,h=ko(this,h),Yv(this,h)&&(this.h-=this.g.get(h).length),this.g.set(h,[w]),this.h+=1,this},e.get=function(h,w){return h?(h=this.V(h),0<h.length?String(h[0]):w):w};function Qv(h,w,A){Xv(h,w),0<A.length&&(h.i=null,h.g.set(ko(h,w),g(A)),h.h+=A.length)}e.toString=function(){if(this.i)return this.i;if(!this.g)return"";const h=[],w=Array.from(this.g.keys());for(var A=0;A<w.length;A++){var z=w[A];const he=encodeURIComponent(String(z)),Ae=this.V(z);for(z=0;z<Ae.length;z++){var ce=he;Ae[z]!==""&&(ce+="="+encodeURIComponent(String(Ae[z]))),h.push(ce)}}return this.i=h.join("&")};function ko(h,w){return w=String(w),h.j&&(w=w.toLowerCase()),w}function FI(h,w){w&&!h.j&&(Ca(h),h.i=null,h.g.forEach(function(A,z){var ce=z.toLowerCase();z!=ce&&(Xv(this,z),Qv(this,ce,A))},h)),h.j=w}function OI(h,w){const A=new ue;if(o.Image){const z=new Image;z.onload=p(Ra,A,"TestLoadImage: loaded",!0,w,z),z.onerror=p(Ra,A,"TestLoadImage: error",!1,w,z),z.onabort=p(Ra,A,"TestLoadImage: abort",!1,w,z),z.ontimeout=p(Ra,A,"TestLoadImage: timeout",!1,w,z),o.setTimeout(function(){z.ontimeout&&z.ontimeout()},1e4),z.src=h}else w(!1)}function MI(h,w){const A=new ue,z=new AbortController,ce=setTimeout(()=>{z.abort(),Ra(A,"TestPingServer: timeout",!1,w)},1e4);fetch(h,{signal:z.signal}).then(he=>{clearTimeout(ce),he.ok?Ra(A,"TestPingServer: ok",!0,w):Ra(A,"TestPingServer: server error",!1,w)}).catch(()=>{clearTimeout(ce),Ra(A,"TestPingServer: error",!1,w)})}function Ra(h,w,A,z,ce){try{ce&&(ce.onload=null,ce.onerror=null,ce.onabort=null,ce.ontimeout=null),z(A)}catch{}}function jI(){this.g=new Ul}function LI(h,w,A){const z=A||"";try{Hv(h,function(ce,he){let Ae=ce;u(ce)&&(Ae=Ks(ce)),w.push(z+he+"="+encodeURIComponent(Ae))})}catch(ce){throw w.push(z+"type="+encodeURIComponent("_badmap")),ce}}function ff(h){this.l=h.Ub||null,this.j=h.eb||!1}x(ff,qs),ff.prototype.g=function(){return new hf(this.l,this.j)},ff.prototype.i=function(h){return function(){return h}}({});function hf(h,w){_t.call(this),this.D=h,this.o=w,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}x(hf,_t),e=hf.prototype,e.open=function(h,w){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=h,this.A=w,this.readyState=1,Hl(this)},e.send=function(h){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const w={headers:this.u,method:this.B,credentials:this.m,cache:void 0};h&&(w.body=h),(this.D||o).fetch(new Request(this.A,w)).then(this.Sa.bind(this),this.ga.bind(this))},e.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,zl(this)),this.readyState=0},e.Sa=function(h){if(this.g&&(this.l=h,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=h.headers,this.readyState=2,Hl(this)),this.g&&(this.readyState=3,Hl(this),this.g)))if(this.responseType==="arraybuffer")h.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof o.ReadableStream<"u"&&"body"in h){if(this.j=h.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;Jv(this)}else h.text().then(this.Ra.bind(this),this.ga.bind(this))};function Jv(h){h.j.read().then(h.Pa.bind(h)).catch(h.ga.bind(h))}e.Pa=function(h){if(this.g){if(this.o&&h.value)this.response.push(h.value);else if(!this.o){var w=h.value?h.value:new Uint8Array(0);(w=this.v.decode(w,{stream:!h.done}))&&(this.response=this.responseText+=w)}h.done?zl(this):Hl(this),this.readyState==3&&Jv(this)}},e.Ra=function(h){this.g&&(this.response=this.responseText=h,zl(this))},e.Qa=function(h){this.g&&(this.response=h,zl(this))},e.ga=function(){this.g&&zl(this)};function zl(h){h.readyState=4,h.l=null,h.j=null,h.v=null,Hl(h)}e.setRequestHeader=function(h,w){this.u.append(h,w)},e.getResponseHeader=function(h){return this.h&&this.h.get(h.toLowerCase())||""},e.getAllResponseHeaders=function(){if(!this.h)return"";const h=[],w=this.h.entries();for(var A=w.next();!A.done;)A=A.value,h.push(A[0]+": "+A[1]),A=w.next();return h.join(`\r
`)};function Hl(h){h.onreadystatechange&&h.onreadystatechange.call(h)}Object.defineProperty(hf.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(h){this.m=h?"include":"same-origin"}});function Zv(h){let w="";return D(h,function(A,z){w+=z,w+=":",w+=A,w+=`\r
`}),w}function E0(h,w,A){e:{for(z in A){var z=!1;break e}z=!0}z||(A=Zv(A),typeof h=="string"?A!=null&&encodeURIComponent(String(A)):It(h,w,A))}function $t(h){_t.call(this),this.headers=new Map,this.o=h||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}x($t,_t);var UI=/^https?$/i,VI=["POST","PUT"];e=$t.prototype,e.Ha=function(h){this.J=h},e.ea=function(h,w,A,z){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+h);w=w?w.toUpperCase():"GET",this.D=h,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():B.g(),this.v=this.o?Ss(this.o):Ss(B),this.g.onreadystatechange=m(this.Ea,this);try{this.B=!0,this.g.open(w,String(h),!0),this.B=!1}catch(he){e1(this,he);return}if(h=A||"",A=new Map(this.headers),z)if(Object.getPrototypeOf(z)===Object.prototype)for(var ce in z)A.set(ce,z[ce]);else if(typeof z.keys=="function"&&typeof z.get=="function")for(const he of z.keys())A.set(he,z.get(he));else throw Error("Unknown input type for opt_headers: "+String(z));z=Array.from(A.keys()).find(he=>he.toLowerCase()=="content-type"),ce=o.FormData&&h instanceof o.FormData,!(0<=Array.prototype.indexOf.call(VI,w,void 0))||z||ce||A.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[he,Ae]of A)this.g.setRequestHeader(he,Ae);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{n1(this),this.u=!0,this.g.send(h),this.u=!1}catch(he){e1(this,he)}};function e1(h,w){h.h=!1,h.g&&(h.j=!0,h.g.abort(),h.j=!1),h.l=w,h.m=5,t1(h),df(h)}function t1(h){h.A||(h.A=!0,bt(h,"complete"),bt(h,"error"))}e.abort=function(h){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=h||7,bt(this,"complete"),bt(this,"abort"),df(this))},e.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),df(this,!0)),$t.aa.N.call(this)},e.Ea=function(){this.s||(this.B||this.u||this.j?r1(this):this.bb())},e.bb=function(){r1(this)};function r1(h){if(h.h&&typeof i<"u"&&(!h.v[1]||Zs(h)!=4||h.Z()!=2)){if(h.u&&Zs(h)==4)jt(h.Ea,0,h);else if(bt(h,"readystatechange"),Zs(h)==4){h.h=!1;try{const Ae=h.Z();e:switch(Ae){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var w=!0;break e;default:w=!1}var A;if(!(A=w)){var z;if(z=Ae===0){var ce=String(h.D).match(Gv)[1]||null;!ce&&o.self&&o.self.location&&(ce=o.self.location.protocol.slice(0,-1)),z=!UI.test(ce?ce.toLowerCase():"")}A=z}if(A)bt(h,"complete"),bt(h,"success");else{h.m=6;try{var he=2<Zs(h)?h.g.statusText:""}catch{he=""}h.l=he+" ["+h.Z()+"]",t1(h)}}finally{df(h)}}}}function df(h,w){if(h.g){n1(h);const A=h.g,z=h.v[0]?()=>{}:null;h.g=null,h.v=null,w||bt(h,"ready");try{A.onreadystatechange=z}catch{}}}function n1(h){h.I&&(o.clearTimeout(h.I),h.I=null)}e.isActive=function(){return!!this.g};function Zs(h){return h.g?h.g.readyState:0}e.Z=function(){try{return 2<Zs(this)?this.g.status:-1}catch{return-1}},e.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},e.Oa=function(h){if(this.g){var w=this.g.responseText;return h&&w.indexOf(h)==0&&(w=w.substring(h.length)),wo(w)}};function s1(h){try{if(!h.g)return null;if("response"in h.g)return h.g.response;switch(h.H){case"":case"text":return h.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in h.g)return h.g.mozResponseArrayBuffer}return null}catch{return null}}function BI(h){const w={};h=(h.g&&2<=Zs(h)&&h.g.getAllResponseHeaders()||"").split(`\r
`);for(let z=0;z<h.length;z++){if(E(h[z]))continue;var A=C(h[z]);const ce=A[0];if(A=A[1],typeof A!="string")continue;A=A.trim();const he=w[ce]||[];w[ce]=he,he.push(A)}v(w,function(z){return z.join(", ")})}e.Ba=function(){return this.m},e.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function Gl(h,w,A){return A&&A.internalChannelParams&&A.internalChannelParams[h]||w}function a1(h){this.Aa=0,this.i=[],this.j=new ue,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=Gl("failFast",!1,h),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=Gl("baseRetryDelayMs",5e3,h),this.cb=Gl("retryDelaySeedMs",1e4,h),this.Wa=Gl("forwardChannelMaxRetries",2,h),this.wa=Gl("forwardChannelRequestTimeoutMs",2e4,h),this.pa=h&&h.xmlHttpFactory||void 0,this.Xa=h&&h.Tb||void 0,this.Ca=h&&h.useFetchStreams||!1,this.L=void 0,this.J=h&&h.supportsCrossDomainXhr||!1,this.K="",this.h=new ht(h&&h.concurrentRequestLimit),this.Da=new jI,this.P=h&&h.fastHandshake||!1,this.O=h&&h.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=h&&h.Rb||!1,h&&h.xa&&this.j.xa(),h&&h.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&h&&h.detectBufferingProxy||!1,this.ja=void 0,h&&h.longPollingTimeout&&0<h.longPollingTimeout&&(this.ja=h.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}e=a1.prototype,e.la=8,e.G=1,e.connect=function(h,w,A,z){ir(0),this.W=h,this.H=w||{},A&&z!==void 0&&(this.H.OSID=A,this.H.OAID=z),this.F=this.X,this.I=m1(this,null,this.W),pf(this)};function T0(h){if(i1(h),h.G==3){var w=h.U++,A=Js(h.I);if(It(A,"SID",h.K),It(A,"RID",w),It(A,"TYPE","terminate"),Kl(h,A),w=new le(h,h.j,w),w.L=2,w.v=uf(Js(A)),A=!1,o.navigator&&o.navigator.sendBeacon)try{A=o.navigator.sendBeacon(w.v.toString(),"")}catch{}!A&&o.Image&&(new Image().src=w.v,A=!0),A||(w.g=p1(w.j,null),w.g.ea(w.v)),w.F=Date.now(),ke(w)}d1(h)}function mf(h){h.g&&(S0(h),h.g.cancel(),h.g=null)}function i1(h){mf(h),h.u&&(o.clearTimeout(h.u),h.u=null),gf(h),h.h.cancel(),h.s&&(typeof h.s=="number"&&o.clearTimeout(h.s),h.s=null)}function pf(h){if(!_r(h.h)&&!h.s){h.s=!0;var w=h.Ga;ae||Z(),X||(ae(),X=!0),H.add(w,h),h.B=0}}function $I(h,w){return Bn(h.h)>=h.h.j-(h.s?1:0)?!1:h.s?(h.i=w.D.concat(h.i),!0):h.G==1||h.G==2||h.B>=(h.Va?0:h.Wa)?!1:(h.s=ne(m(h.Ga,h,w),h1(h,h.B)),h.B++,!0)}e.Ga=function(h){if(this.s)if(this.s=null,this.G==1){if(!h){this.U=Math.floor(1e5*Math.random()),h=this.U++;const ce=new le(this,this.j,h);let he=this.o;if(this.S&&(he?(he=T(he),N(he,this.S)):he=this.S),this.m!==null||this.O||(ce.H=he,he=null),this.P)e:{for(var w=0,A=0;A<this.i.length;A++){t:{var z=this.i[A];if("__data__"in z.map&&(z=z.map.__data__,typeof z=="string")){z=z.length;break t}z=void 0}if(z===void 0)break;if(w+=z,4096<w){w=A;break e}if(w===4096||A===this.i.length-1){w=A+1;break e}}w=1e3}else w=1e3;w=l1(this,ce,w),A=Js(this.I),It(A,"RID",h),It(A,"CVER",22),this.D&&It(A,"X-HTTP-Session-Id",this.D),Kl(this,A),he&&(this.O?w="headers="+encodeURIComponent(String(Zv(he)))+"&"+w:this.m&&E0(A,this.m,he)),bs(this.h,ce),this.Ua&&It(A,"TYPE","init"),this.P?(It(A,"$req",w),It(A,"SID","null"),ce.T=!0,me(ce,A,null)):me(ce,A,w),this.G=2}}else this.G==3&&(h?o1(this,h):this.i.length==0||_r(this.h)||o1(this))};function o1(h,w){var A;w?A=w.l:A=h.U++;const z=Js(h.I);It(z,"SID",h.K),It(z,"RID",A),It(z,"AID",h.T),Kl(h,z),h.m&&h.o&&E0(z,h.m,h.o),A=new le(h,h.j,A,h.B+1),h.m===null&&(A.H=h.o),w&&(h.i=w.D.concat(h.i)),w=l1(h,A,1e3),A.I=Math.round(.5*h.wa)+Math.round(.5*h.wa*Math.random()),bs(h.h,A),me(A,z,w)}function Kl(h,w){h.H&&D(h.H,function(A,z){It(w,z,A)}),h.l&&Hv({},function(A,z){It(w,z,A)})}function l1(h,w,A){A=Math.min(h.i.length,A);var z=h.l?m(h.l.Na,h.l,h):null;e:{var ce=h.i;let he=-1;for(;;){const Ae=["count="+A];he==-1?0<A?(he=ce[0].g,Ae.push("ofs="+he)):he=0:Ae.push("ofs="+he);let Et=!0;for(let wr=0;wr<A;wr++){let ct=ce[wr].g;const Pr=ce[wr].map;if(ct-=he,0>ct)he=Math.max(0,ce[wr].g-100),Et=!1;else try{LI(Pr,Ae,"req"+ct+"_")}catch{z&&z(Pr)}}if(Et){z=Ae.join("&");break e}}}return h=h.i.splice(0,A),w.D=h,z}function c1(h){if(!h.g&&!h.u){h.Y=1;var w=h.Fa;ae||Z(),X||(ae(),X=!0),H.add(w,h),h.v=0}}function k0(h){return h.g||h.u||3<=h.v?!1:(h.Y++,h.u=ne(m(h.Fa,h),h1(h,h.v)),h.v++,!0)}e.Fa=function(){if(this.u=null,u1(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var h=2*this.R;this.j.info("BP detection timer enabled: "+h),this.A=ne(m(this.ab,this),h)}},e.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,ir(10),mf(this),u1(this))};function S0(h){h.A!=null&&(o.clearTimeout(h.A),h.A=null)}function u1(h){h.g=new le(h,h.j,"rpc",h.Y),h.m===null&&(h.g.H=h.o),h.g.O=0;var w=Js(h.qa);It(w,"RID","rpc"),It(w,"SID",h.K),It(w,"AID",h.T),It(w,"CI",h.F?"0":"1"),!h.F&&h.ja&&It(w,"TO",h.ja),It(w,"TYPE","xmlhttp"),Kl(h,w),h.m&&h.o&&E0(w,h.m,h.o),h.L&&(h.g.I=h.L);var A=h.g;h=h.ia,A.L=1,A.v=uf(Js(w)),A.m=null,A.P=!0,Te(A,h)}e.Za=function(){this.C!=null&&(this.C=null,mf(this),k0(this),ir(19))};function gf(h){h.C!=null&&(o.clearTimeout(h.C),h.C=null)}function f1(h,w){var A=null;if(h.g==w){gf(h),S0(h),h.g=null;var z=2}else if(rt(h.h,w))A=w.D,Vl(h.h,w),z=1;else return;if(h.G!=0){if(w.o)if(z==1){A=w.m?w.m.length:0,w=Date.now()-w.F;var ce=h.B;z=Ys(),bt(z,new Q(z,A)),pf(h)}else c1(h);else if(ce=w.s,ce==3||ce==0&&0<w.X||!(z==1&&$I(h,w)||z==2&&k0(h)))switch(A&&0<A.length&&(w=h.h,w.i=w.i.concat(A)),ce){case 1:Ai(h,5);break;case 4:Ai(h,10);break;case 3:Ai(h,6);break;default:Ai(h,2)}}}function h1(h,w){let A=h.Ta+Math.floor(Math.random()*h.cb);return h.isActive()||(A*=2),A*w}function Ai(h,w){if(h.j.info("Error code "+w),w==2){var A=m(h.fb,h),z=h.Xa;const ce=!z;z=new Si(z||"//www.google.com/images/cleardot.gif"),o.location&&o.location.protocol=="http"||lf(z,"https"),uf(z),ce?OI(z.toString(),A):MI(z.toString(),A)}else ir(2);h.G=0,h.l&&h.l.sa(w),d1(h),i1(h)}e.fb=function(h){h?(this.j.info("Successfully pinged google.com"),ir(2)):(this.j.info("Failed to ping google.com"),ir(1))};function d1(h){if(h.G=0,h.ka=[],h.l){const w=of(h.h);(w.length!=0||h.i.length!=0)&&(_(h.ka,w),_(h.ka,h.i),h.h.i.length=0,g(h.i),h.i.length=0),h.l.ra()}}function m1(h,w,A){var z=A instanceof Si?Js(A):new Si(A);if(z.g!="")w&&(z.g=w+"."+z.g),cf(z,z.s);else{var ce=o.location;z=ce.protocol,w=w?w+"."+ce.hostname:ce.hostname,ce=+ce.port;var he=new Si(null);z&&lf(he,z),w&&(he.g=w),ce&&cf(he,ce),A&&(he.l=A),z=he}return A=h.D,w=h.ya,A&&w&&It(z,A,w),It(z,"VER",h.la),Kl(h,z),z}function p1(h,w,A){if(w&&!h.J)throw Error("Can't create secondary domain capable XhrIo object.");return w=h.Ca&&!h.pa?new $t(new ff({eb:A})):new $t(h.pa),w.Ha(h.J),w}e.isActive=function(){return!!this.l&&this.l.isActive(this)};function g1(){}e=g1.prototype,e.ua=function(){},e.ta=function(){},e.sa=function(){},e.ra=function(){},e.isActive=function(){return!0},e.Na=function(){};function xf(){}xf.prototype.g=function(h,w){return new kn(h,w)};function kn(h,w){_t.call(this),this.g=new a1(w),this.l=h,this.h=w&&w.messageUrlParams||null,h=w&&w.messageHeaders||null,w&&w.clientProtocolHeaderRequired&&(h?h["X-Client-Protocol"]="webchannel":h={"X-Client-Protocol":"webchannel"}),this.g.o=h,h=w&&w.initMessageHeaders||null,w&&w.messageContentType&&(h?h["X-WebChannel-Content-Type"]=w.messageContentType:h={"X-WebChannel-Content-Type":w.messageContentType}),w&&w.va&&(h?h["X-WebChannel-Client-Profile"]=w.va:h={"X-WebChannel-Client-Profile":w.va}),this.g.S=h,(h=w&&w.Sb)&&!E(h)&&(this.g.m=h),this.v=w&&w.supportsCrossDomainXhr||!1,this.u=w&&w.sendRawJson||!1,(w=w&&w.httpSessionIdParam)&&!E(w)&&(this.g.D=w,h=this.h,h!==null&&w in h&&(h=this.h,w in h&&delete h[w])),this.j=new So(this)}x(kn,_t),kn.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},kn.prototype.close=function(){T0(this.g)},kn.prototype.o=function(h){var w=this.g;if(typeof h=="string"){var A={};A.__data__=h,h=A}else this.u&&(A={},A.__data__=Ks(h),h=A);w.i.push(new Ke(w.Ya++,h)),w.G==3&&pf(w)},kn.prototype.N=function(){this.g.l=null,delete this.j,T0(this.g),delete this.g,kn.aa.N.call(this)};function x1(h){Xs.call(this),h.__headers__&&(this.headers=h.__headers__,this.statusCode=h.__status__,delete h.__headers__,delete h.__status__);var w=h.__sm__;if(w){e:{for(const A in w){h=A;break e}h=void 0}(this.i=h)&&(h=this.i,w=w!==null&&h in w?w[h]:void 0),this.data=w}else this.data=h}x(x1,Xs);function v1(){As.call(this),this.status=1}x(v1,As);function So(h){this.g=h}x(So,g1),So.prototype.ua=function(){bt(this.g,"a")},So.prototype.ta=function(h){bt(this.g,new x1(h))},So.prototype.sa=function(h){bt(this.g,new v1)},So.prototype.ra=function(){bt(this.g,"b")},xf.prototype.createWebChannel=xf.prototype.g,kn.prototype.send=kn.prototype.o,kn.prototype.open=kn.prototype.m,kn.prototype.close=kn.prototype.close,Jk=function(){return new xf},Qk=function(){return Ys()},Yk=Un,Dp={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},j.NO_ERROR=0,j.TIMEOUT=8,j.HTTP_ERROR=6,gh=j,V.COMPLETE="complete",Xk=V,Na.EventType=ns,ns.OPEN="a",ns.CLOSE="b",ns.ERROR="c",ns.MESSAGE="d",_t.prototype.listen=_t.prototype.K,hc=Na,$t.prototype.listenOnce=$t.prototype.L,$t.prototype.getLastError=$t.prototype.Ka,$t.prototype.getLastErrorCode=$t.prototype.Ba,$t.prototype.getStatus=$t.prototype.Z,$t.prototype.getResponseJson=$t.prototype.Oa,$t.prototype.getResponseText=$t.prototype.oa,$t.prototype.send=$t.prototype.ea,$t.prototype.setWithCredentials=$t.prototype.Ha,qk=$t}).apply(typeof Lf<"u"?Lf:typeof self<"u"?self:typeof window<"u"?window:{});const E_="@firebase/firestore";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lr{constructor(t){this.uid=t}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(t){return t.uid===this.uid}}Lr.UNAUTHENTICATED=new Lr(null),Lr.GOOGLE_CREDENTIALS=new Lr("google-credentials-uid"),Lr.FIRST_PARTY=new Lr("first-party-uid"),Lr.MOCK_USER=new Lr("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Pl="10.14.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const to=new fx("@firebase/firestore");function ac(){return to.logLevel}function Re(e,...t){if(to.logLevel<=et.DEBUG){const r=t.map(kx);to.debug(`Firestore (${Pl}): ${e}`,...r)}}function Ea(e,...t){if(to.logLevel<=et.ERROR){const r=t.map(kx);to.error(`Firestore (${Pl}): ${e}`,...r)}}function vl(e,...t){if(to.logLevel<=et.WARN){const r=t.map(kx);to.warn(`Firestore (${Pl}): ${e}`,...r)}}function kx(e){if(typeof e=="string")return e;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(r){return JSON.stringify(r)}(e)}catch{return e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ue(e="Unexpected state"){const t=`FIRESTORE (${Pl}) INTERNAL ASSERTION FAILED: `+e;throw Ea(t),new Error(t)}function vt(e,t){e||Ue()}function ze(e,t){return e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xe={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Ce extends ks{constructor(t,r){super(t,r),this.code=t,this.message=r,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fa{constructor(){this.promise=new Promise((t,r)=>{this.resolve=t,this.reject=r})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zk{constructor(t,r){this.user=r,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${t}`)}}class C3{getToken(){return Promise.resolve(null)}invalidateToken(){}start(t,r){t.enqueueRetryable(()=>r(Lr.UNAUTHENTICATED))}shutdown(){}}class R3{constructor(t){this.token=t,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(t,r){this.changeListener=r,t.enqueueRetryable(()=>r(this.token.user))}shutdown(){this.changeListener=null}}class P3{constructor(t){this.t=t,this.currentUser=Lr.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(t,r){vt(this.o===void 0);let n=this.i;const s=l=>this.i!==n?(n=this.i,r(l)):Promise.resolve();let a=new fa;this.o=()=>{this.i++,this.currentUser=this.u(),a.resolve(),a=new fa,t.enqueueRetryable(()=>s(this.currentUser))};const i=()=>{const l=a;t.enqueueRetryable(async()=>{await l.promise,await s(this.currentUser)})},o=l=>{Re("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=l,this.o&&(this.auth.addAuthTokenListener(this.o),i())};this.t.onInit(l=>o(l)),setTimeout(()=>{if(!this.auth){const l=this.t.getImmediate({optional:!0});l?o(l):(Re("FirebaseAuthCredentialsProvider","Auth not yet detected"),a.resolve(),a=new fa)}},0),i()}getToken(){const t=this.i,r=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(r).then(n=>this.i!==t?(Re("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):n?(vt(typeof n.accessToken=="string"),new Zk(n.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const t=this.auth&&this.auth.getUid();return vt(t===null||typeof t=="string"),new Lr(t)}}class D3{constructor(t,r,n){this.l=t,this.h=r,this.P=n,this.type="FirstParty",this.user=Lr.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);const t=this.T();return t&&this.I.set("Authorization",t),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}}class F3{constructor(t,r,n){this.l=t,this.h=r,this.P=n}getToken(){return Promise.resolve(new D3(this.l,this.h,this.P))}start(t,r){t.enqueueRetryable(()=>r(Lr.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class O3{constructor(t){this.value=t,this.type="AppCheck",this.headers=new Map,t&&t.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class M3{constructor(t){this.A=t,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(t,r){vt(this.o===void 0);const n=a=>{a.error!=null&&Re("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${a.error.message}`);const i=a.token!==this.R;return this.R=a.token,Re("FirebaseAppCheckTokenProvider",`Received ${i?"new":"existing"} token.`),i?r(a.token):Promise.resolve()};this.o=a=>{t.enqueueRetryable(()=>n(a))};const s=a=>{Re("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=a,this.o&&this.appCheck.addTokenListener(this.o)};this.A.onInit(a=>s(a)),setTimeout(()=>{if(!this.appCheck){const a=this.A.getImmediate({optional:!0});a?s(a):Re("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const t=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(t).then(r=>r?(vt(typeof r.token=="string"),this.R=r.token,new O3(r.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function j3(e){const t=typeof self<"u"&&(self.crypto||self.msCrypto),r=new Uint8Array(e);if(t&&typeof t.getRandomValues=="function")t.getRandomValues(r);else for(let n=0;n<e;n++)r[n]=Math.floor(256*Math.random());return r}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eS{static newId(){const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",r=Math.floor(256/t.length)*t.length;let n="";for(;n.length<20;){const s=j3(40);for(let a=0;a<s.length;++a)n.length<20&&s[a]<r&&(n+=t.charAt(s[a]%t.length))}return n}}function ut(e,t){return e<t?-1:e>t?1:0}function yl(e,t,r){return e.length===t.length&&e.every((n,s)=>r(n,t[s]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fr{constructor(t,r){if(this.seconds=t,this.nanoseconds=r,r<0)throw new Ce(xe.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+r);if(r>=1e9)throw new Ce(xe.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+r);if(t<-62135596800)throw new Ce(xe.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(t>=253402300800)throw new Ce(xe.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}static now(){return fr.fromMillis(Date.now())}static fromDate(t){return fr.fromMillis(t.getTime())}static fromMillis(t){const r=Math.floor(t/1e3),n=Math.floor(1e6*(t-1e3*r));return new fr(r,n)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(t){return this.seconds===t.seconds?ut(this.nanoseconds,t.nanoseconds):ut(this.seconds,t.seconds)}isEqual(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const t=this.seconds- -62135596800;return String(t).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $e{constructor(t){this.timestamp=t}static fromTimestamp(t){return new $e(t)}static min(){return new $e(new fr(0,0))}static max(){return new $e(new fr(253402300799,999999999))}compareTo(t){return this.timestamp._compareTo(t.timestamp)}isEqual(t){return this.timestamp.isEqual(t.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hu{constructor(t,r,n){r===void 0?r=0:r>t.length&&Ue(),n===void 0?n=t.length-r:n>t.length-r&&Ue(),this.segments=t,this.offset=r,this.len=n}get length(){return this.len}isEqual(t){return hu.comparator(this,t)===0}child(t){const r=this.segments.slice(this.offset,this.limit());return t instanceof hu?t.forEach(n=>{r.push(n)}):r.push(t),this.construct(r)}limit(){return this.offset+this.length}popFirst(t){return t=t===void 0?1:t,this.construct(this.segments,this.offset+t,this.length-t)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(t){return this.segments[this.offset+t]}isEmpty(){return this.length===0}isPrefixOf(t){if(t.length<this.length)return!1;for(let r=0;r<this.length;r++)if(this.get(r)!==t.get(r))return!1;return!0}isImmediateParentOf(t){if(this.length+1!==t.length)return!1;for(let r=0;r<this.length;r++)if(this.get(r)!==t.get(r))return!1;return!0}forEach(t){for(let r=this.offset,n=this.limit();r<n;r++)t(this.segments[r])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(t,r){const n=Math.min(t.length,r.length);for(let s=0;s<n;s++){const a=t.get(s),i=r.get(s);if(a<i)return-1;if(a>i)return 1}return t.length<r.length?-1:t.length>r.length?1:0}}class Ct extends hu{construct(t,r,n){return new Ct(t,r,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...t){const r=[];for(const n of t){if(n.indexOf("//")>=0)throw new Ce(xe.INVALID_ARGUMENT,`Invalid segment (${n}). Paths must not contain // in them.`);r.push(...n.split("/").filter(s=>s.length>0))}return new Ct(r)}static emptyPath(){return new Ct([])}}const L3=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Sr extends hu{construct(t,r,n){return new Sr(t,r,n)}static isValidIdentifier(t){return L3.test(t)}canonicalString(){return this.toArray().map(t=>(t=t.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Sr.isValidIdentifier(t)||(t="`"+t+"`"),t)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new Sr(["__name__"])}static fromServerFormat(t){const r=[];let n="",s=0;const a=()=>{if(n.length===0)throw new Ce(xe.INVALID_ARGUMENT,`Invalid field path (${t}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);r.push(n),n=""};let i=!1;for(;s<t.length;){const o=t[s];if(o==="\\"){if(s+1===t.length)throw new Ce(xe.INVALID_ARGUMENT,"Path has trailing escape character: "+t);const l=t[s+1];if(l!=="\\"&&l!=="."&&l!=="`")throw new Ce(xe.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);n+=l,s+=2}else o==="`"?(i=!i,s++):o!=="."||i?(n+=o,s++):(a(),s++)}if(a(),i)throw new Ce(xe.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new Sr(r)}static emptyPath(){return new Sr([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fe{constructor(t){this.path=t}static fromPath(t){return new Fe(Ct.fromString(t))}static fromName(t){return new Fe(Ct.fromString(t).popFirst(5))}static empty(){return new Fe(Ct.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(t){return this.path.length>=2&&this.path.get(this.path.length-2)===t}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(t){return t!==null&&Ct.comparator(this.path,t.path)===0}toString(){return this.path.toString()}static comparator(t,r){return Ct.comparator(t.path,r.path)}static isDocumentKey(t){return t.length%2==0}static fromSegments(t){return new Fe(new Ct(t.slice()))}}function U3(e,t){const r=e.toTimestamp().seconds,n=e.toTimestamp().nanoseconds+1,s=$e.fromTimestamp(n===1e9?new fr(r+1,0):new fr(r,n));return new mi(s,Fe.empty(),t)}function V3(e){return new mi(e.readTime,e.key,-1)}class mi{constructor(t,r,n){this.readTime=t,this.documentKey=r,this.largestBatchId=n}static min(){return new mi($e.min(),Fe.empty(),-1)}static max(){return new mi($e.max(),Fe.empty(),-1)}}function B3(e,t){let r=e.readTime.compareTo(t.readTime);return r!==0?r:(r=Fe.comparator(e.documentKey,t.documentKey),r!==0?r:ut(e.largestBatchId,t.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $3="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class W3{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(t){this.onCommittedListeners.push(t)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(t=>t())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function $u(e){if(e.code!==xe.FAILED_PRECONDITION||e.message!==$3)throw e;Re("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _e{constructor(t){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,t(r=>{this.isDone=!0,this.result=r,this.nextCallback&&this.nextCallback(r)},r=>{this.isDone=!0,this.error=r,this.catchCallback&&this.catchCallback(r)})}catch(t){return this.next(void 0,t)}next(t,r){return this.callbackAttached&&Ue(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(r,this.error):this.wrapSuccess(t,this.result):new _e((n,s)=>{this.nextCallback=a=>{this.wrapSuccess(t,a).next(n,s)},this.catchCallback=a=>{this.wrapFailure(r,a).next(n,s)}})}toPromise(){return new Promise((t,r)=>{this.next(t,r)})}wrapUserFunction(t){try{const r=t();return r instanceof _e?r:_e.resolve(r)}catch(r){return _e.reject(r)}}wrapSuccess(t,r){return t?this.wrapUserFunction(()=>t(r)):_e.resolve(r)}wrapFailure(t,r){return t?this.wrapUserFunction(()=>t(r)):_e.reject(r)}static resolve(t){return new _e((r,n)=>{r(t)})}static reject(t){return new _e((r,n)=>{n(t)})}static waitFor(t){return new _e((r,n)=>{let s=0,a=0,i=!1;t.forEach(o=>{++s,o.next(()=>{++a,i&&a===s&&r()},l=>n(l))}),i=!0,a===s&&r()})}static or(t){let r=_e.resolve(!1);for(const n of t)r=r.next(s=>s?_e.resolve(s):n());return r}static forEach(t,r){const n=[];return t.forEach((s,a)=>{n.push(r.call(this,s,a))}),this.waitFor(n)}static mapArray(t,r){return new _e((n,s)=>{const a=t.length,i=new Array(a);let o=0;for(let l=0;l<a;l++){const u=l;r(t[u]).next(f=>{i[u]=f,++o,o===a&&n(i)},f=>s(f))}})}static doWhile(t,r){return new _e((n,s)=>{const a=()=>{t()===!0?r().next(()=>{a()},s):n()};a()})}}function z3(e){const t=e.match(/Android ([\d.]+)/i),r=t?t[1].split(".").slice(0,2).join("."):"-1";return Number(r)}function Wu(e){return e.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sx{constructor(t,r){this.previousValue=t,r&&(r.sequenceNumberHandler=n=>this.ie(n),this.se=n=>r.writeSequenceNumber(n))}ie(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue}next(){const t=++this.previousValue;return this.se&&this.se(t),t}}Sx.oe=-1;function Jd(e){return e==null}function sd(e){return e===0&&1/e==-1/0}function H3(e){return typeof e=="number"&&Number.isInteger(e)&&!sd(e)&&e<=Number.MAX_SAFE_INTEGER&&e>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function T_(e){let t=0;for(const r in e)Object.prototype.hasOwnProperty.call(e,r)&&t++;return t}function fo(e,t){for(const r in e)Object.prototype.hasOwnProperty.call(e,r)&&t(r,e[r])}function tS(e){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bt{constructor(t,r){this.comparator=t,this.root=r||Tr.EMPTY}insert(t,r){return new Bt(this.comparator,this.root.insert(t,r,this.comparator).copy(null,null,Tr.BLACK,null,null))}remove(t){return new Bt(this.comparator,this.root.remove(t,this.comparator).copy(null,null,Tr.BLACK,null,null))}get(t){let r=this.root;for(;!r.isEmpty();){const n=this.comparator(t,r.key);if(n===0)return r.value;n<0?r=r.left:n>0&&(r=r.right)}return null}indexOf(t){let r=0,n=this.root;for(;!n.isEmpty();){const s=this.comparator(t,n.key);if(s===0)return r+n.left.size;s<0?n=n.left:(r+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(t){return this.root.inorderTraversal(t)}forEach(t){this.inorderTraversal((r,n)=>(t(r,n),!1))}toString(){const t=[];return this.inorderTraversal((r,n)=>(t.push(`${r}:${n}`),!1)),`{${t.join(", ")}}`}reverseTraversal(t){return this.root.reverseTraversal(t)}getIterator(){return new Uf(this.root,null,this.comparator,!1)}getIteratorFrom(t){return new Uf(this.root,t,this.comparator,!1)}getReverseIterator(){return new Uf(this.root,null,this.comparator,!0)}getReverseIteratorFrom(t){return new Uf(this.root,t,this.comparator,!0)}}class Uf{constructor(t,r,n,s){this.isReverse=s,this.nodeStack=[];let a=1;for(;!t.isEmpty();)if(a=r?n(t.key,r):1,r&&s&&(a*=-1),a<0)t=this.isReverse?t.left:t.right;else{if(a===0){this.nodeStack.push(t);break}this.nodeStack.push(t),t=this.isReverse?t.right:t.left}}getNext(){let t=this.nodeStack.pop();const r={key:t.key,value:t.value};if(this.isReverse)for(t=t.left;!t.isEmpty();)this.nodeStack.push(t),t=t.right;else for(t=t.right;!t.isEmpty();)this.nodeStack.push(t),t=t.left;return r}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const t=this.nodeStack[this.nodeStack.length-1];return{key:t.key,value:t.value}}}class Tr{constructor(t,r,n,s,a){this.key=t,this.value=r,this.color=n??Tr.RED,this.left=s??Tr.EMPTY,this.right=a??Tr.EMPTY,this.size=this.left.size+1+this.right.size}copy(t,r,n,s,a){return new Tr(t??this.key,r??this.value,n??this.color,s??this.left,a??this.right)}isEmpty(){return!1}inorderTraversal(t){return this.left.inorderTraversal(t)||t(this.key,this.value)||this.right.inorderTraversal(t)}reverseTraversal(t){return this.right.reverseTraversal(t)||t(this.key,this.value)||this.left.reverseTraversal(t)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(t,r,n){let s=this;const a=n(t,s.key);return s=a<0?s.copy(null,null,null,s.left.insert(t,r,n),null):a===0?s.copy(null,r,null,null,null):s.copy(null,null,null,null,s.right.insert(t,r,n)),s.fixUp()}removeMin(){if(this.left.isEmpty())return Tr.EMPTY;let t=this;return t.left.isRed()||t.left.left.isRed()||(t=t.moveRedLeft()),t=t.copy(null,null,null,t.left.removeMin(),null),t.fixUp()}remove(t,r){let n,s=this;if(r(t,s.key)<0)s.left.isEmpty()||s.left.isRed()||s.left.left.isRed()||(s=s.moveRedLeft()),s=s.copy(null,null,null,s.left.remove(t,r),null);else{if(s.left.isRed()&&(s=s.rotateRight()),s.right.isEmpty()||s.right.isRed()||s.right.left.isRed()||(s=s.moveRedRight()),r(t,s.key)===0){if(s.right.isEmpty())return Tr.EMPTY;n=s.right.min(),s=s.copy(n.key,n.value,null,null,s.right.removeMin())}s=s.copy(null,null,null,null,s.right.remove(t,r))}return s.fixUp()}isRed(){return this.color}fixUp(){let t=this;return t.right.isRed()&&!t.left.isRed()&&(t=t.rotateLeft()),t.left.isRed()&&t.left.left.isRed()&&(t=t.rotateRight()),t.left.isRed()&&t.right.isRed()&&(t=t.colorFlip()),t}moveRedLeft(){let t=this.colorFlip();return t.right.left.isRed()&&(t=t.copy(null,null,null,null,t.right.rotateRight()),t=t.rotateLeft(),t=t.colorFlip()),t}moveRedRight(){let t=this.colorFlip();return t.left.left.isRed()&&(t=t.rotateRight(),t=t.colorFlip()),t}rotateLeft(){const t=this.copy(null,null,Tr.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)}rotateRight(){const t=this.copy(null,null,Tr.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)}colorFlip(){const t=this.left.copy(null,null,!this.left.color,null,null),r=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,r)}checkMaxDepth(){const t=this.check();return Math.pow(2,t)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw Ue();const t=this.left.check();if(t!==this.right.check())throw Ue();return t+(this.isRed()?0:1)}}Tr.EMPTY=null,Tr.RED=!0,Tr.BLACK=!1;Tr.EMPTY=new class{constructor(){this.size=0}get key(){throw Ue()}get value(){throw Ue()}get color(){throw Ue()}get left(){throw Ue()}get right(){throw Ue()}copy(t,r,n,s,a){return this}insert(t,r,n){return new Tr(t,r)}remove(t,r){return this}isEmpty(){return!0}inorderTraversal(t){return!1}reverseTraversal(t){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class br{constructor(t){this.comparator=t,this.data=new Bt(this.comparator)}has(t){return this.data.get(t)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(t){return this.data.indexOf(t)}forEach(t){this.data.inorderTraversal((r,n)=>(t(r),!1))}forEachInRange(t,r){const n=this.data.getIteratorFrom(t[0]);for(;n.hasNext();){const s=n.getNext();if(this.comparator(s.key,t[1])>=0)return;r(s.key)}}forEachWhile(t,r){let n;for(n=r!==void 0?this.data.getIteratorFrom(r):this.data.getIterator();n.hasNext();)if(!t(n.getNext().key))return}firstAfterOrEqual(t){const r=this.data.getIteratorFrom(t);return r.hasNext()?r.getNext().key:null}getIterator(){return new k_(this.data.getIterator())}getIteratorFrom(t){return new k_(this.data.getIteratorFrom(t))}add(t){return this.copy(this.data.remove(t).insert(t,!0))}delete(t){return this.has(t)?this.copy(this.data.remove(t)):this}isEmpty(){return this.data.isEmpty()}unionWith(t){let r=this;return r.size<t.size&&(r=t,t=this),t.forEach(n=>{r=r.add(n)}),r}isEqual(t){if(!(t instanceof br)||this.size!==t.size)return!1;const r=this.data.getIterator(),n=t.data.getIterator();for(;r.hasNext();){const s=r.getNext().key,a=n.getNext().key;if(this.comparator(s,a)!==0)return!1}return!0}toArray(){const t=[];return this.forEach(r=>{t.push(r)}),t}toString(){const t=[];return this.forEach(r=>t.push(r)),"SortedSet("+t.toString()+")"}copy(t){const r=new br(this.comparator);return r.data=t,r}}class k_{constructor(t){this.iter=t}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cn{constructor(t){this.fields=t,t.sort(Sr.comparator)}static empty(){return new Cn([])}unionWith(t){let r=new br(Sr.comparator);for(const n of this.fields)r=r.add(n);for(const n of t)r=r.add(n);return new Cn(r.toArray())}covers(t){for(const r of this.fields)if(r.isPrefixOf(t))return!0;return!1}isEqual(t){return yl(this.fields,t.fields,(r,n)=>r.isEqual(n))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rS extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rr{constructor(t){this.binaryString=t}static fromBase64String(t){const r=function(s){try{return atob(s)}catch(a){throw typeof DOMException<"u"&&a instanceof DOMException?new rS("Invalid base64 string: "+a):a}}(t);return new Rr(r)}static fromUint8Array(t){const r=function(s){let a="";for(let i=0;i<s.length;++i)a+=String.fromCharCode(s[i]);return a}(t);return new Rr(r)}[Symbol.iterator](){let t=0;return{next:()=>t<this.binaryString.length?{value:this.binaryString.charCodeAt(t++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(r){return btoa(r)}(this.binaryString)}toUint8Array(){return function(r){const n=new Uint8Array(r.length);for(let s=0;s<r.length;s++)n[s]=r.charCodeAt(s);return n}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(t){return ut(this.binaryString,t.binaryString)}isEqual(t){return this.binaryString===t.binaryString}}Rr.EMPTY_BYTE_STRING=new Rr("");const G3=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function pi(e){if(vt(!!e),typeof e=="string"){let t=0;const r=G3.exec(e);if(vt(!!r),r[1]){let s=r[1];s=(s+"000000000").substr(0,9),t=Number(s)}const n=new Date(e);return{seconds:Math.floor(n.getTime()/1e3),nanos:t}}return{seconds:Xt(e.seconds),nanos:Xt(e.nanos)}}function Xt(e){return typeof e=="number"?e:typeof e=="string"?Number(e):0}function ro(e){return typeof e=="string"?Rr.fromBase64String(e):Rr.fromUint8Array(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ax(e){var t,r;return((r=(((t=e==null?void 0:e.mapValue)===null||t===void 0?void 0:t.fields)||{}).__type__)===null||r===void 0?void 0:r.stringValue)==="server_timestamp"}function bx(e){const t=e.mapValue.fields.__previous_value__;return Ax(t)?bx(t):t}function du(e){const t=pi(e.mapValue.fields.__local_write_time__.timestampValue);return new fr(t.seconds,t.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class K3{constructor(t,r,n,s,a,i,o,l,u){this.databaseId=t,this.appId=r,this.persistenceKey=n,this.host=s,this.ssl=a,this.forceLongPolling=i,this.autoDetectLongPolling=o,this.longPollingOptions=l,this.useFetchStreams=u}}class mu{constructor(t,r){this.projectId=t,this.database=r||"(default)"}static empty(){return new mu("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(t){return t instanceof mu&&t.projectId===this.projectId&&t.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Vf={mapValue:{}};function no(e){return"nullValue"in e?0:"booleanValue"in e?1:"integerValue"in e||"doubleValue"in e?2:"timestampValue"in e?3:"stringValue"in e?5:"bytesValue"in e?6:"referenceValue"in e?7:"geoPointValue"in e?8:"arrayValue"in e?9:"mapValue"in e?Ax(e)?4:X3(e)?9007199254740991:q3(e)?10:11:Ue()}function Bs(e,t){if(e===t)return!0;const r=no(e);if(r!==no(t))return!1;switch(r){case 0:case 9007199254740991:return!0;case 1:return e.booleanValue===t.booleanValue;case 4:return du(e).isEqual(du(t));case 3:return function(s,a){if(typeof s.timestampValue=="string"&&typeof a.timestampValue=="string"&&s.timestampValue.length===a.timestampValue.length)return s.timestampValue===a.timestampValue;const i=pi(s.timestampValue),o=pi(a.timestampValue);return i.seconds===o.seconds&&i.nanos===o.nanos}(e,t);case 5:return e.stringValue===t.stringValue;case 6:return function(s,a){return ro(s.bytesValue).isEqual(ro(a.bytesValue))}(e,t);case 7:return e.referenceValue===t.referenceValue;case 8:return function(s,a){return Xt(s.geoPointValue.latitude)===Xt(a.geoPointValue.latitude)&&Xt(s.geoPointValue.longitude)===Xt(a.geoPointValue.longitude)}(e,t);case 2:return function(s,a){if("integerValue"in s&&"integerValue"in a)return Xt(s.integerValue)===Xt(a.integerValue);if("doubleValue"in s&&"doubleValue"in a){const i=Xt(s.doubleValue),o=Xt(a.doubleValue);return i===o?sd(i)===sd(o):isNaN(i)&&isNaN(o)}return!1}(e,t);case 9:return yl(e.arrayValue.values||[],t.arrayValue.values||[],Bs);case 10:case 11:return function(s,a){const i=s.mapValue.fields||{},o=a.mapValue.fields||{};if(T_(i)!==T_(o))return!1;for(const l in i)if(i.hasOwnProperty(l)&&(o[l]===void 0||!Bs(i[l],o[l])))return!1;return!0}(e,t);default:return Ue()}}function pu(e,t){return(e.values||[]).find(r=>Bs(r,t))!==void 0}function _l(e,t){if(e===t)return 0;const r=no(e),n=no(t);if(r!==n)return ut(r,n);switch(r){case 0:case 9007199254740991:return 0;case 1:return ut(e.booleanValue,t.booleanValue);case 2:return function(a,i){const o=Xt(a.integerValue||a.doubleValue),l=Xt(i.integerValue||i.doubleValue);return o<l?-1:o>l?1:o===l?0:isNaN(o)?isNaN(l)?0:-1:1}(e,t);case 3:return S_(e.timestampValue,t.timestampValue);case 4:return S_(du(e),du(t));case 5:return ut(e.stringValue,t.stringValue);case 6:return function(a,i){const o=ro(a),l=ro(i);return o.compareTo(l)}(e.bytesValue,t.bytesValue);case 7:return function(a,i){const o=a.split("/"),l=i.split("/");for(let u=0;u<o.length&&u<l.length;u++){const f=ut(o[u],l[u]);if(f!==0)return f}return ut(o.length,l.length)}(e.referenceValue,t.referenceValue);case 8:return function(a,i){const o=ut(Xt(a.latitude),Xt(i.latitude));return o!==0?o:ut(Xt(a.longitude),Xt(i.longitude))}(e.geoPointValue,t.geoPointValue);case 9:return A_(e.arrayValue,t.arrayValue);case 10:return function(a,i){var o,l,u,f;const d=a.fields||{},m=i.fields||{},p=(o=d.value)===null||o===void 0?void 0:o.arrayValue,x=(l=m.value)===null||l===void 0?void 0:l.arrayValue,g=ut(((u=p==null?void 0:p.values)===null||u===void 0?void 0:u.length)||0,((f=x==null?void 0:x.values)===null||f===void 0?void 0:f.length)||0);return g!==0?g:A_(p,x)}(e.mapValue,t.mapValue);case 11:return function(a,i){if(a===Vf.mapValue&&i===Vf.mapValue)return 0;if(a===Vf.mapValue)return 1;if(i===Vf.mapValue)return-1;const o=a.fields||{},l=Object.keys(o),u=i.fields||{},f=Object.keys(u);l.sort(),f.sort();for(let d=0;d<l.length&&d<f.length;++d){const m=ut(l[d],f[d]);if(m!==0)return m;const p=_l(o[l[d]],u[f[d]]);if(p!==0)return p}return ut(l.length,f.length)}(e.mapValue,t.mapValue);default:throw Ue()}}function S_(e,t){if(typeof e=="string"&&typeof t=="string"&&e.length===t.length)return ut(e,t);const r=pi(e),n=pi(t),s=ut(r.seconds,n.seconds);return s!==0?s:ut(r.nanos,n.nanos)}function A_(e,t){const r=e.values||[],n=t.values||[];for(let s=0;s<r.length&&s<n.length;++s){const a=_l(r[s],n[s]);if(a)return a}return ut(r.length,n.length)}function wl(e){return Fp(e)}function Fp(e){return"nullValue"in e?"null":"booleanValue"in e?""+e.booleanValue:"integerValue"in e?""+e.integerValue:"doubleValue"in e?""+e.doubleValue:"timestampValue"in e?function(r){const n=pi(r);return`time(${n.seconds},${n.nanos})`}(e.timestampValue):"stringValue"in e?e.stringValue:"bytesValue"in e?function(r){return ro(r).toBase64()}(e.bytesValue):"referenceValue"in e?function(r){return Fe.fromName(r).toString()}(e.referenceValue):"geoPointValue"in e?function(r){return`geo(${r.latitude},${r.longitude})`}(e.geoPointValue):"arrayValue"in e?function(r){let n="[",s=!0;for(const a of r.values||[])s?s=!1:n+=",",n+=Fp(a);return n+"]"}(e.arrayValue):"mapValue"in e?function(r){const n=Object.keys(r.fields||{}).sort();let s="{",a=!0;for(const i of n)a?a=!1:s+=",",s+=`${i}:${Fp(r.fields[i])}`;return s+"}"}(e.mapValue):Ue()}function b_(e,t){return{referenceValue:`projects/${e.projectId}/databases/${e.database}/documents/${t.path.canonicalString()}`}}function Op(e){return!!e&&"integerValue"in e}function Ix(e){return!!e&&"arrayValue"in e}function I_(e){return!!e&&"nullValue"in e}function N_(e){return!!e&&"doubleValue"in e&&isNaN(Number(e.doubleValue))}function xh(e){return!!e&&"mapValue"in e}function q3(e){var t,r;return((r=(((t=e==null?void 0:e.mapValue)===null||t===void 0?void 0:t.fields)||{}).__type__)===null||r===void 0?void 0:r.stringValue)==="__vector__"}function Cc(e){if(e.geoPointValue)return{geoPointValue:Object.assign({},e.geoPointValue)};if(e.timestampValue&&typeof e.timestampValue=="object")return{timestampValue:Object.assign({},e.timestampValue)};if(e.mapValue){const t={mapValue:{fields:{}}};return fo(e.mapValue.fields,(r,n)=>t.mapValue.fields[r]=Cc(n)),t}if(e.arrayValue){const t={arrayValue:{values:[]}};for(let r=0;r<(e.arrayValue.values||[]).length;++r)t.arrayValue.values[r]=Cc(e.arrayValue.values[r]);return t}return Object.assign({},e)}function X3(e){return(((e.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pn{constructor(t){this.value=t}static empty(){return new pn({mapValue:{}})}field(t){if(t.isEmpty())return this.value;{let r=this.value;for(let n=0;n<t.length-1;++n)if(r=(r.mapValue.fields||{})[t.get(n)],!xh(r))return null;return r=(r.mapValue.fields||{})[t.lastSegment()],r||null}}set(t,r){this.getFieldsMap(t.popLast())[t.lastSegment()]=Cc(r)}setAll(t){let r=Sr.emptyPath(),n={},s=[];t.forEach((i,o)=>{if(!r.isImmediateParentOf(o)){const l=this.getFieldsMap(r);this.applyChanges(l,n,s),n={},s=[],r=o.popLast()}i?n[o.lastSegment()]=Cc(i):s.push(o.lastSegment())});const a=this.getFieldsMap(r);this.applyChanges(a,n,s)}delete(t){const r=this.field(t.popLast());xh(r)&&r.mapValue.fields&&delete r.mapValue.fields[t.lastSegment()]}isEqual(t){return Bs(this.value,t.value)}getFieldsMap(t){let r=this.value;r.mapValue.fields||(r.mapValue={fields:{}});for(let n=0;n<t.length;++n){let s=r.mapValue.fields[t.get(n)];xh(s)&&s.mapValue.fields||(s={mapValue:{fields:{}}},r.mapValue.fields[t.get(n)]=s),r=s}return r.mapValue.fields}applyChanges(t,r,n){fo(r,(s,a)=>t[s]=a);for(const s of n)delete t[s]}clone(){return new pn(Cc(this.value))}}function nS(e){const t=[];return fo(e.fields,(r,n)=>{const s=new Sr([r]);if(xh(n)){const a=nS(n.mapValue).fields;if(a.length===0)t.push(s);else for(const i of a)t.push(s.child(i))}else t.push(s)}),new Cn(t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Br{constructor(t,r,n,s,a,i,o){this.key=t,this.documentType=r,this.version=n,this.readTime=s,this.createTime=a,this.data=i,this.documentState=o}static newInvalidDocument(t){return new Br(t,0,$e.min(),$e.min(),$e.min(),pn.empty(),0)}static newFoundDocument(t,r,n,s){return new Br(t,1,r,$e.min(),n,s,0)}static newNoDocument(t,r){return new Br(t,2,r,$e.min(),$e.min(),pn.empty(),0)}static newUnknownDocument(t,r){return new Br(t,3,r,$e.min(),$e.min(),pn.empty(),2)}convertToFoundDocument(t,r){return!this.createTime.isEqual($e.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=t),this.version=t,this.documentType=1,this.data=r,this.documentState=0,this}convertToNoDocument(t){return this.version=t,this.documentType=2,this.data=pn.empty(),this.documentState=0,this}convertToUnknownDocument(t){return this.version=t,this.documentType=3,this.data=pn.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=$e.min(),this}setReadTime(t){return this.readTime=t,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(t){return t instanceof Br&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.documentType===t.documentType&&this.documentState===t.documentState&&this.data.isEqual(t.data)}mutableCopy(){return new Br(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ad{constructor(t,r){this.position=t,this.inclusive=r}}function C_(e,t,r){let n=0;for(let s=0;s<e.position.length;s++){const a=t[s],i=e.position[s];if(a.field.isKeyField()?n=Fe.comparator(Fe.fromName(i.referenceValue),r.key):n=_l(i,r.data.field(a.field)),a.dir==="desc"&&(n*=-1),n!==0)break}return n}function R_(e,t){if(e===null)return t===null;if(t===null||e.inclusive!==t.inclusive||e.position.length!==t.position.length)return!1;for(let r=0;r<e.position.length;r++)if(!Bs(e.position[r],t.position[r]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class id{constructor(t,r="asc"){this.field=t,this.dir=r}}function Y3(e,t){return e.dir===t.dir&&e.field.isEqual(t.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sS{}class ar extends sS{constructor(t,r,n){super(),this.field=t,this.op=r,this.value=n}static create(t,r,n){return t.isKeyField()?r==="in"||r==="not-in"?this.createKeyFieldInFilter(t,r,n):new J3(t,r,n):r==="array-contains"?new tO(t,n):r==="in"?new rO(t,n):r==="not-in"?new nO(t,n):r==="array-contains-any"?new sO(t,n):new ar(t,r,n)}static createKeyFieldInFilter(t,r,n){return r==="in"?new Z3(t,n):new eO(t,n)}matches(t){const r=t.data.field(this.field);return this.op==="!="?r!==null&&this.matchesComparison(_l(r,this.value)):r!==null&&no(this.value)===no(r)&&this.matchesComparison(_l(r,this.value))}matchesComparison(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return t===0;case"!=":return t!==0;case">":return t>0;case">=":return t>=0;default:return Ue()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Es extends sS{constructor(t,r){super(),this.filters=t,this.op=r,this.ae=null}static create(t,r){return new Es(t,r)}matches(t){return aS(this)?this.filters.find(r=>!r.matches(t))===void 0:this.filters.find(r=>r.matches(t))!==void 0}getFlattenedFilters(){return this.ae!==null||(this.ae=this.filters.reduce((t,r)=>t.concat(r.getFlattenedFilters()),[])),this.ae}getFilters(){return Object.assign([],this.filters)}}function aS(e){return e.op==="and"}function iS(e){return Q3(e)&&aS(e)}function Q3(e){for(const t of e.filters)if(t instanceof Es)return!1;return!0}function Mp(e){if(e instanceof ar)return e.field.canonicalString()+e.op.toString()+wl(e.value);if(iS(e))return e.filters.map(t=>Mp(t)).join(",");{const t=e.filters.map(r=>Mp(r)).join(",");return`${e.op}(${t})`}}function oS(e,t){return e instanceof ar?function(n,s){return s instanceof ar&&n.op===s.op&&n.field.isEqual(s.field)&&Bs(n.value,s.value)}(e,t):e instanceof Es?function(n,s){return s instanceof Es&&n.op===s.op&&n.filters.length===s.filters.length?n.filters.reduce((a,i,o)=>a&&oS(i,s.filters[o]),!0):!1}(e,t):void Ue()}function lS(e){return e instanceof ar?function(r){return`${r.field.canonicalString()} ${r.op} ${wl(r.value)}`}(e):e instanceof Es?function(r){return r.op.toString()+" {"+r.getFilters().map(lS).join(" ,")+"}"}(e):"Filter"}class J3 extends ar{constructor(t,r,n){super(t,r,n),this.key=Fe.fromName(n.referenceValue)}matches(t){const r=Fe.comparator(t.key,this.key);return this.matchesComparison(r)}}class Z3 extends ar{constructor(t,r){super(t,"in",r),this.keys=cS("in",r)}matches(t){return this.keys.some(r=>r.isEqual(t.key))}}class eO extends ar{constructor(t,r){super(t,"not-in",r),this.keys=cS("not-in",r)}matches(t){return!this.keys.some(r=>r.isEqual(t.key))}}function cS(e,t){var r;return(((r=t.arrayValue)===null||r===void 0?void 0:r.values)||[]).map(n=>Fe.fromName(n.referenceValue))}class tO extends ar{constructor(t,r){super(t,"array-contains",r)}matches(t){const r=t.data.field(this.field);return Ix(r)&&pu(r.arrayValue,this.value)}}class rO extends ar{constructor(t,r){super(t,"in",r)}matches(t){const r=t.data.field(this.field);return r!==null&&pu(this.value.arrayValue,r)}}class nO extends ar{constructor(t,r){super(t,"not-in",r)}matches(t){if(pu(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const r=t.data.field(this.field);return r!==null&&!pu(this.value.arrayValue,r)}}class sO extends ar{constructor(t,r){super(t,"array-contains-any",r)}matches(t){const r=t.data.field(this.field);return!(!Ix(r)||!r.arrayValue.values)&&r.arrayValue.values.some(n=>pu(this.value.arrayValue,n))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aO{constructor(t,r=null,n=[],s=[],a=null,i=null,o=null){this.path=t,this.collectionGroup=r,this.orderBy=n,this.filters=s,this.limit=a,this.startAt=i,this.endAt=o,this.ue=null}}function P_(e,t=null,r=[],n=[],s=null,a=null,i=null){return new aO(e,t,r,n,s,a,i)}function Nx(e){const t=ze(e);if(t.ue===null){let r=t.path.canonicalString();t.collectionGroup!==null&&(r+="|cg:"+t.collectionGroup),r+="|f:",r+=t.filters.map(n=>Mp(n)).join(","),r+="|ob:",r+=t.orderBy.map(n=>function(a){return a.field.canonicalString()+a.dir}(n)).join(","),Jd(t.limit)||(r+="|l:",r+=t.limit),t.startAt&&(r+="|lb:",r+=t.startAt.inclusive?"b:":"a:",r+=t.startAt.position.map(n=>wl(n)).join(",")),t.endAt&&(r+="|ub:",r+=t.endAt.inclusive?"a:":"b:",r+=t.endAt.position.map(n=>wl(n)).join(",")),t.ue=r}return t.ue}function Cx(e,t){if(e.limit!==t.limit||e.orderBy.length!==t.orderBy.length)return!1;for(let r=0;r<e.orderBy.length;r++)if(!Y3(e.orderBy[r],t.orderBy[r]))return!1;if(e.filters.length!==t.filters.length)return!1;for(let r=0;r<e.filters.length;r++)if(!oS(e.filters[r],t.filters[r]))return!1;return e.collectionGroup===t.collectionGroup&&!!e.path.isEqual(t.path)&&!!R_(e.startAt,t.startAt)&&R_(e.endAt,t.endAt)}function jp(e){return Fe.isDocumentKey(e.path)&&e.collectionGroup===null&&e.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zu{constructor(t,r=null,n=[],s=[],a=null,i="F",o=null,l=null){this.path=t,this.collectionGroup=r,this.explicitOrderBy=n,this.filters=s,this.limit=a,this.limitType=i,this.startAt=o,this.endAt=l,this.ce=null,this.le=null,this.he=null,this.startAt,this.endAt}}function iO(e,t,r,n,s,a,i,o){return new zu(e,t,r,n,s,a,i,o)}function Zd(e){return new zu(e)}function D_(e){return e.filters.length===0&&e.limit===null&&e.startAt==null&&e.endAt==null&&(e.explicitOrderBy.length===0||e.explicitOrderBy.length===1&&e.explicitOrderBy[0].field.isKeyField())}function uS(e){return e.collectionGroup!==null}function Rc(e){const t=ze(e);if(t.ce===null){t.ce=[];const r=new Set;for(const a of t.explicitOrderBy)t.ce.push(a),r.add(a.field.canonicalString());const n=t.explicitOrderBy.length>0?t.explicitOrderBy[t.explicitOrderBy.length-1].dir:"asc";(function(i){let o=new br(Sr.comparator);return i.filters.forEach(l=>{l.getFlattenedFilters().forEach(u=>{u.isInequality()&&(o=o.add(u.field))})}),o})(t).forEach(a=>{r.has(a.canonicalString())||a.isKeyField()||t.ce.push(new id(a,n))}),r.has(Sr.keyField().canonicalString())||t.ce.push(new id(Sr.keyField(),n))}return t.ce}function Ls(e){const t=ze(e);return t.le||(t.le=oO(t,Rc(e))),t.le}function oO(e,t){if(e.limitType==="F")return P_(e.path,e.collectionGroup,t,e.filters,e.limit,e.startAt,e.endAt);{t=t.map(s=>{const a=s.dir==="desc"?"asc":"desc";return new id(s.field,a)});const r=e.endAt?new ad(e.endAt.position,e.endAt.inclusive):null,n=e.startAt?new ad(e.startAt.position,e.startAt.inclusive):null;return P_(e.path,e.collectionGroup,t,e.filters,e.limit,r,n)}}function Lp(e,t){const r=e.filters.concat([t]);return new zu(e.path,e.collectionGroup,e.explicitOrderBy.slice(),r,e.limit,e.limitType,e.startAt,e.endAt)}function Up(e,t,r){return new zu(e.path,e.collectionGroup,e.explicitOrderBy.slice(),e.filters.slice(),t,r,e.startAt,e.endAt)}function e0(e,t){return Cx(Ls(e),Ls(t))&&e.limitType===t.limitType}function fS(e){return`${Nx(Ls(e))}|lt:${e.limitType}`}function Co(e){return`Query(target=${function(r){let n=r.path.canonicalString();return r.collectionGroup!==null&&(n+=" collectionGroup="+r.collectionGroup),r.filters.length>0&&(n+=`, filters: [${r.filters.map(s=>lS(s)).join(", ")}]`),Jd(r.limit)||(n+=", limit: "+r.limit),r.orderBy.length>0&&(n+=`, orderBy: [${r.orderBy.map(s=>function(i){return`${i.field.canonicalString()} (${i.dir})`}(s)).join(", ")}]`),r.startAt&&(n+=", startAt: ",n+=r.startAt.inclusive?"b:":"a:",n+=r.startAt.position.map(s=>wl(s)).join(",")),r.endAt&&(n+=", endAt: ",n+=r.endAt.inclusive?"a:":"b:",n+=r.endAt.position.map(s=>wl(s)).join(",")),`Target(${n})`}(Ls(e))}; limitType=${e.limitType})`}function t0(e,t){return t.isFoundDocument()&&function(n,s){const a=s.key.path;return n.collectionGroup!==null?s.key.hasCollectionId(n.collectionGroup)&&n.path.isPrefixOf(a):Fe.isDocumentKey(n.path)?n.path.isEqual(a):n.path.isImmediateParentOf(a)}(e,t)&&function(n,s){for(const a of Rc(n))if(!a.field.isKeyField()&&s.data.field(a.field)===null)return!1;return!0}(e,t)&&function(n,s){for(const a of n.filters)if(!a.matches(s))return!1;return!0}(e,t)&&function(n,s){return!(n.startAt&&!function(i,o,l){const u=C_(i,o,l);return i.inclusive?u<=0:u<0}(n.startAt,Rc(n),s)||n.endAt&&!function(i,o,l){const u=C_(i,o,l);return i.inclusive?u>=0:u>0}(n.endAt,Rc(n),s))}(e,t)}function lO(e){return e.collectionGroup||(e.path.length%2==1?e.path.lastSegment():e.path.get(e.path.length-2))}function hS(e){return(t,r)=>{let n=!1;for(const s of Rc(e)){const a=cO(s,t,r);if(a!==0)return a;n=n||s.field.isKeyField()}return 0}}function cO(e,t,r){const n=e.field.isKeyField()?Fe.comparator(t.key,r.key):function(a,i,o){const l=i.data.field(a),u=o.data.field(a);return l!==null&&u!==null?_l(l,u):Ue()}(e.field,t,r);switch(e.dir){case"asc":return n;case"desc":return-1*n;default:return Ue()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dl{constructor(t,r){this.mapKeyFn=t,this.equalsFn=r,this.inner={},this.innerSize=0}get(t){const r=this.mapKeyFn(t),n=this.inner[r];if(n!==void 0){for(const[s,a]of n)if(this.equalsFn(s,t))return a}}has(t){return this.get(t)!==void 0}set(t,r){const n=this.mapKeyFn(t),s=this.inner[n];if(s===void 0)return this.inner[n]=[[t,r]],void this.innerSize++;for(let a=0;a<s.length;a++)if(this.equalsFn(s[a][0],t))return void(s[a]=[t,r]);s.push([t,r]),this.innerSize++}delete(t){const r=this.mapKeyFn(t),n=this.inner[r];if(n===void 0)return!1;for(let s=0;s<n.length;s++)if(this.equalsFn(n[s][0],t))return n.length===1?delete this.inner[r]:n.splice(s,1),this.innerSize--,!0;return!1}forEach(t){fo(this.inner,(r,n)=>{for(const[s,a]of n)t(s,a)})}isEmpty(){return tS(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uO=new Bt(Fe.comparator);function Ta(){return uO}const dS=new Bt(Fe.comparator);function dc(...e){let t=dS;for(const r of e)t=t.insert(r.key,r);return t}function mS(e){let t=dS;return e.forEach((r,n)=>t=t.insert(r,n.overlayedDocument)),t}function Li(){return Pc()}function pS(){return Pc()}function Pc(){return new Dl(e=>e.toString(),(e,t)=>e.isEqual(t))}const fO=new Bt(Fe.comparator),hO=new br(Fe.comparator);function Je(...e){let t=hO;for(const r of e)t=t.add(r);return t}const dO=new br(ut);function mO(){return dO}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Rx(e,t){if(e.useProto3Json){if(isNaN(t))return{doubleValue:"NaN"};if(t===1/0)return{doubleValue:"Infinity"};if(t===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:sd(t)?"-0":t}}function gS(e){return{integerValue:""+e}}function xS(e,t){return H3(t)?gS(t):Rx(e,t)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class r0{constructor(){this._=void 0}}function pO(e,t,r){return e instanceof gu?function(s,a){const i={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:s.seconds,nanos:s.nanoseconds}}}};return a&&Ax(a)&&(a=bx(a)),a&&(i.fields.__previous_value__=a),{mapValue:i}}(r,t):e instanceof xu?yS(e,t):e instanceof vu?_S(e,t):function(s,a){const i=vS(s,a),o=F_(i)+F_(s.Pe);return Op(i)&&Op(s.Pe)?gS(o):Rx(s.serializer,o)}(e,t)}function gO(e,t,r){return e instanceof xu?yS(e,t):e instanceof vu?_S(e,t):r}function vS(e,t){return e instanceof yu?function(n){return Op(n)||function(a){return!!a&&"doubleValue"in a}(n)}(t)?t:{integerValue:0}:null}class gu extends r0{}class xu extends r0{constructor(t){super(),this.elements=t}}function yS(e,t){const r=wS(t);for(const n of e.elements)r.some(s=>Bs(s,n))||r.push(n);return{arrayValue:{values:r}}}class vu extends r0{constructor(t){super(),this.elements=t}}function _S(e,t){let r=wS(t);for(const n of e.elements)r=r.filter(s=>!Bs(s,n));return{arrayValue:{values:r}}}class yu extends r0{constructor(t,r){super(),this.serializer=t,this.Pe=r}}function F_(e){return Xt(e.integerValue||e.doubleValue)}function wS(e){return Ix(e)&&e.arrayValue.values?e.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ES{constructor(t,r){this.field=t,this.transform=r}}function xO(e,t){return e.field.isEqual(t.field)&&function(n,s){return n instanceof xu&&s instanceof xu||n instanceof vu&&s instanceof vu?yl(n.elements,s.elements,Bs):n instanceof yu&&s instanceof yu?Bs(n.Pe,s.Pe):n instanceof gu&&s instanceof gu}(e.transform,t.transform)}class vO{constructor(t,r){this.version=t,this.transformResults=r}}class Yn{constructor(t,r){this.updateTime=t,this.exists=r}static none(){return new Yn}static exists(t){return new Yn(void 0,t)}static updateTime(t){return new Yn(t)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)}}function vh(e,t){return e.updateTime!==void 0?t.isFoundDocument()&&t.version.isEqual(e.updateTime):e.exists===void 0||e.exists===t.isFoundDocument()}class n0{}function TS(e,t){if(!e.hasLocalMutations||t&&t.fields.length===0)return null;if(t===null)return e.isNoDocument()?new Px(e.key,Yn.none()):new Hu(e.key,e.data,Yn.none());{const r=e.data,n=pn.empty();let s=new br(Sr.comparator);for(let a of t.fields)if(!s.has(a)){let i=r.field(a);i===null&&a.length>1&&(a=a.popLast(),i=r.field(a)),i===null?n.delete(a):n.set(a,i),s=s.add(a)}return new Ti(e.key,n,new Cn(s.toArray()),Yn.none())}}function yO(e,t,r){e instanceof Hu?function(s,a,i){const o=s.value.clone(),l=M_(s.fieldTransforms,a,i.transformResults);o.setAll(l),a.convertToFoundDocument(i.version,o).setHasCommittedMutations()}(e,t,r):e instanceof Ti?function(s,a,i){if(!vh(s.precondition,a))return void a.convertToUnknownDocument(i.version);const o=M_(s.fieldTransforms,a,i.transformResults),l=a.data;l.setAll(kS(s)),l.setAll(o),a.convertToFoundDocument(i.version,l).setHasCommittedMutations()}(e,t,r):function(s,a,i){a.convertToNoDocument(i.version).setHasCommittedMutations()}(0,t,r)}function Dc(e,t,r,n){return e instanceof Hu?function(a,i,o,l){if(!vh(a.precondition,i))return o;const u=a.value.clone(),f=j_(a.fieldTransforms,l,i);return u.setAll(f),i.convertToFoundDocument(i.version,u).setHasLocalMutations(),null}(e,t,r,n):e instanceof Ti?function(a,i,o,l){if(!vh(a.precondition,i))return o;const u=j_(a.fieldTransforms,l,i),f=i.data;return f.setAll(kS(a)),f.setAll(u),i.convertToFoundDocument(i.version,f).setHasLocalMutations(),o===null?null:o.unionWith(a.fieldMask.fields).unionWith(a.fieldTransforms.map(d=>d.field))}(e,t,r,n):function(a,i,o){return vh(a.precondition,i)?(i.convertToNoDocument(i.version).setHasLocalMutations(),null):o}(e,t,r)}function _O(e,t){let r=null;for(const n of e.fieldTransforms){const s=t.data.field(n.field),a=vS(n.transform,s||null);a!=null&&(r===null&&(r=pn.empty()),r.set(n.field,a))}return r||null}function O_(e,t){return e.type===t.type&&!!e.key.isEqual(t.key)&&!!e.precondition.isEqual(t.precondition)&&!!function(n,s){return n===void 0&&s===void 0||!(!n||!s)&&yl(n,s,(a,i)=>xO(a,i))}(e.fieldTransforms,t.fieldTransforms)&&(e.type===0?e.value.isEqual(t.value):e.type!==1||e.data.isEqual(t.data)&&e.fieldMask.isEqual(t.fieldMask))}class Hu extends n0{constructor(t,r,n,s=[]){super(),this.key=t,this.value=r,this.precondition=n,this.fieldTransforms=s,this.type=0}getFieldMask(){return null}}class Ti extends n0{constructor(t,r,n,s,a=[]){super(),this.key=t,this.data=r,this.fieldMask=n,this.precondition=s,this.fieldTransforms=a,this.type=1}getFieldMask(){return this.fieldMask}}function kS(e){const t=new Map;return e.fieldMask.fields.forEach(r=>{if(!r.isEmpty()){const n=e.data.field(r);t.set(r,n)}}),t}function M_(e,t,r){const n=new Map;vt(e.length===r.length);for(let s=0;s<r.length;s++){const a=e[s],i=a.transform,o=t.data.field(a.field);n.set(a.field,gO(i,o,r[s]))}return n}function j_(e,t,r){const n=new Map;for(const s of e){const a=s.transform,i=r.data.field(s.field);n.set(s.field,pO(a,i,t))}return n}class Px extends n0{constructor(t,r){super(),this.key=t,this.precondition=r,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class wO extends n0{constructor(t,r){super(),this.key=t,this.precondition=r,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class EO{constructor(t,r,n,s){this.batchId=t,this.localWriteTime=r,this.baseMutations=n,this.mutations=s}applyToRemoteDocument(t,r){const n=r.mutationResults;for(let s=0;s<this.mutations.length;s++){const a=this.mutations[s];a.key.isEqual(t.key)&&yO(a,t,n[s])}}applyToLocalView(t,r){for(const n of this.baseMutations)n.key.isEqual(t.key)&&(r=Dc(n,t,r,this.localWriteTime));for(const n of this.mutations)n.key.isEqual(t.key)&&(r=Dc(n,t,r,this.localWriteTime));return r}applyToLocalDocumentSet(t,r){const n=pS();return this.mutations.forEach(s=>{const a=t.get(s.key),i=a.overlayedDocument;let o=this.applyToLocalView(i,a.mutatedFields);o=r.has(s.key)?null:o;const l=TS(i,o);l!==null&&n.set(s.key,l),i.isValidDocument()||i.convertToNoDocument($e.min())}),n}keys(){return this.mutations.reduce((t,r)=>t.add(r.key),Je())}isEqual(t){return this.batchId===t.batchId&&yl(this.mutations,t.mutations,(r,n)=>O_(r,n))&&yl(this.baseMutations,t.baseMutations,(r,n)=>O_(r,n))}}class Dx{constructor(t,r,n,s){this.batch=t,this.commitVersion=r,this.mutationResults=n,this.docVersions=s}static from(t,r,n){vt(t.mutations.length===n.length);let s=function(){return fO}();const a=t.mutations;for(let i=0;i<a.length;i++)s=s.insert(a[i].key,n[i].version);return new Dx(t,r,n,s)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TO{constructor(t,r){this.largestBatchId=t,this.mutation=r}getKey(){return this.mutation.key}isEqual(t){return t!==null&&this.mutation===t.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kO{constructor(t,r){this.count=t,this.unchangedNames=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var er,nt;function SO(e){switch(e){default:return Ue();case xe.CANCELLED:case xe.UNKNOWN:case xe.DEADLINE_EXCEEDED:case xe.RESOURCE_EXHAUSTED:case xe.INTERNAL:case xe.UNAVAILABLE:case xe.UNAUTHENTICATED:return!1;case xe.INVALID_ARGUMENT:case xe.NOT_FOUND:case xe.ALREADY_EXISTS:case xe.PERMISSION_DENIED:case xe.FAILED_PRECONDITION:case xe.ABORTED:case xe.OUT_OF_RANGE:case xe.UNIMPLEMENTED:case xe.DATA_LOSS:return!0}}function SS(e){if(e===void 0)return Ea("GRPC error has no .code"),xe.UNKNOWN;switch(e){case er.OK:return xe.OK;case er.CANCELLED:return xe.CANCELLED;case er.UNKNOWN:return xe.UNKNOWN;case er.DEADLINE_EXCEEDED:return xe.DEADLINE_EXCEEDED;case er.RESOURCE_EXHAUSTED:return xe.RESOURCE_EXHAUSTED;case er.INTERNAL:return xe.INTERNAL;case er.UNAVAILABLE:return xe.UNAVAILABLE;case er.UNAUTHENTICATED:return xe.UNAUTHENTICATED;case er.INVALID_ARGUMENT:return xe.INVALID_ARGUMENT;case er.NOT_FOUND:return xe.NOT_FOUND;case er.ALREADY_EXISTS:return xe.ALREADY_EXISTS;case er.PERMISSION_DENIED:return xe.PERMISSION_DENIED;case er.FAILED_PRECONDITION:return xe.FAILED_PRECONDITION;case er.ABORTED:return xe.ABORTED;case er.OUT_OF_RANGE:return xe.OUT_OF_RANGE;case er.UNIMPLEMENTED:return xe.UNIMPLEMENTED;case er.DATA_LOSS:return xe.DATA_LOSS;default:return Ue()}}(nt=er||(er={}))[nt.OK=0]="OK",nt[nt.CANCELLED=1]="CANCELLED",nt[nt.UNKNOWN=2]="UNKNOWN",nt[nt.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",nt[nt.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",nt[nt.NOT_FOUND=5]="NOT_FOUND",nt[nt.ALREADY_EXISTS=6]="ALREADY_EXISTS",nt[nt.PERMISSION_DENIED=7]="PERMISSION_DENIED",nt[nt.UNAUTHENTICATED=16]="UNAUTHENTICATED",nt[nt.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",nt[nt.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",nt[nt.ABORTED=10]="ABORTED",nt[nt.OUT_OF_RANGE=11]="OUT_OF_RANGE",nt[nt.UNIMPLEMENTED=12]="UNIMPLEMENTED",nt[nt.INTERNAL=13]="INTERNAL",nt[nt.UNAVAILABLE=14]="UNAVAILABLE",nt[nt.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function AO(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bO=new Wi([4294967295,4294967295],0);function L_(e){const t=AO().encode(e),r=new Kk;return r.update(t),new Uint8Array(r.digest())}function U_(e){const t=new DataView(e.buffer),r=t.getUint32(0,!0),n=t.getUint32(4,!0),s=t.getUint32(8,!0),a=t.getUint32(12,!0);return[new Wi([r,n],0),new Wi([s,a],0)]}class Fx{constructor(t,r,n){if(this.bitmap=t,this.padding=r,this.hashCount=n,r<0||r>=8)throw new mc(`Invalid padding: ${r}`);if(n<0)throw new mc(`Invalid hash count: ${n}`);if(t.length>0&&this.hashCount===0)throw new mc(`Invalid hash count: ${n}`);if(t.length===0&&r!==0)throw new mc(`Invalid padding when bitmap length is 0: ${r}`);this.Ie=8*t.length-r,this.Te=Wi.fromNumber(this.Ie)}Ee(t,r,n){let s=t.add(r.multiply(Wi.fromNumber(n)));return s.compare(bO)===1&&(s=new Wi([s.getBits(0),s.getBits(1)],0)),s.modulo(this.Te).toNumber()}de(t){return(this.bitmap[Math.floor(t/8)]&1<<t%8)!=0}mightContain(t){if(this.Ie===0)return!1;const r=L_(t),[n,s]=U_(r);for(let a=0;a<this.hashCount;a++){const i=this.Ee(n,s,a);if(!this.de(i))return!1}return!0}static create(t,r,n){const s=t%8==0?0:8-t%8,a=new Uint8Array(Math.ceil(t/8)),i=new Fx(a,s,r);return n.forEach(o=>i.insert(o)),i}insert(t){if(this.Ie===0)return;const r=L_(t),[n,s]=U_(r);for(let a=0;a<this.hashCount;a++){const i=this.Ee(n,s,a);this.Ae(i)}}Ae(t){const r=Math.floor(t/8),n=t%8;this.bitmap[r]|=1<<n}}class mc extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class s0{constructor(t,r,n,s,a){this.snapshotVersion=t,this.targetChanges=r,this.targetMismatches=n,this.documentUpdates=s,this.resolvedLimboDocuments=a}static createSynthesizedRemoteEventForCurrentChange(t,r,n){const s=new Map;return s.set(t,Gu.createSynthesizedTargetChangeForCurrentChange(t,r,n)),new s0($e.min(),s,new Bt(ut),Ta(),Je())}}class Gu{constructor(t,r,n,s,a){this.resumeToken=t,this.current=r,this.addedDocuments=n,this.modifiedDocuments=s,this.removedDocuments=a}static createSynthesizedTargetChangeForCurrentChange(t,r,n){return new Gu(n,r,Je(),Je(),Je())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yh{constructor(t,r,n,s){this.Re=t,this.removedTargetIds=r,this.key=n,this.Ve=s}}class AS{constructor(t,r){this.targetId=t,this.me=r}}class bS{constructor(t,r,n=Rr.EMPTY_BYTE_STRING,s=null){this.state=t,this.targetIds=r,this.resumeToken=n,this.cause=s}}class V_{constructor(){this.fe=0,this.ge=$_(),this.pe=Rr.EMPTY_BYTE_STRING,this.ye=!1,this.we=!0}get current(){return this.ye}get resumeToken(){return this.pe}get Se(){return this.fe!==0}get be(){return this.we}De(t){t.approximateByteSize()>0&&(this.we=!0,this.pe=t)}ve(){let t=Je(),r=Je(),n=Je();return this.ge.forEach((s,a)=>{switch(a){case 0:t=t.add(s);break;case 2:r=r.add(s);break;case 1:n=n.add(s);break;default:Ue()}}),new Gu(this.pe,this.ye,t,r,n)}Ce(){this.we=!1,this.ge=$_()}Fe(t,r){this.we=!0,this.ge=this.ge.insert(t,r)}Me(t){this.we=!0,this.ge=this.ge.remove(t)}xe(){this.fe+=1}Oe(){this.fe-=1,vt(this.fe>=0)}Ne(){this.we=!0,this.ye=!0}}class IO{constructor(t){this.Le=t,this.Be=new Map,this.ke=Ta(),this.qe=B_(),this.Qe=new Bt(ut)}Ke(t){for(const r of t.Re)t.Ve&&t.Ve.isFoundDocument()?this.$e(r,t.Ve):this.Ue(r,t.key,t.Ve);for(const r of t.removedTargetIds)this.Ue(r,t.key,t.Ve)}We(t){this.forEachTarget(t,r=>{const n=this.Ge(r);switch(t.state){case 0:this.ze(r)&&n.De(t.resumeToken);break;case 1:n.Oe(),n.Se||n.Ce(),n.De(t.resumeToken);break;case 2:n.Oe(),n.Se||this.removeTarget(r);break;case 3:this.ze(r)&&(n.Ne(),n.De(t.resumeToken));break;case 4:this.ze(r)&&(this.je(r),n.De(t.resumeToken));break;default:Ue()}})}forEachTarget(t,r){t.targetIds.length>0?t.targetIds.forEach(r):this.Be.forEach((n,s)=>{this.ze(s)&&r(s)})}He(t){const r=t.targetId,n=t.me.count,s=this.Je(r);if(s){const a=s.target;if(jp(a))if(n===0){const i=new Fe(a.path);this.Ue(r,i,Br.newNoDocument(i,$e.min()))}else vt(n===1);else{const i=this.Ye(r);if(i!==n){const o=this.Ze(t),l=o?this.Xe(o,t,i):1;if(l!==0){this.je(r);const u=l===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Qe=this.Qe.insert(r,u)}}}}}Ze(t){const r=t.me.unchangedNames;if(!r||!r.bits)return null;const{bits:{bitmap:n="",padding:s=0},hashCount:a=0}=r;let i,o;try{i=ro(n).toUint8Array()}catch(l){if(l instanceof rS)return vl("Decoding the base64 bloom filter in existence filter failed ("+l.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw l}try{o=new Fx(i,s,a)}catch(l){return vl(l instanceof mc?"BloomFilter error: ":"Applying bloom filter failed: ",l),null}return o.Ie===0?null:o}Xe(t,r,n){return r.me.count===n-this.nt(t,r.targetId)?0:2}nt(t,r){const n=this.Le.getRemoteKeysForTarget(r);let s=0;return n.forEach(a=>{const i=this.Le.tt(),o=`projects/${i.projectId}/databases/${i.database}/documents/${a.path.canonicalString()}`;t.mightContain(o)||(this.Ue(r,a,null),s++)}),s}rt(t){const r=new Map;this.Be.forEach((a,i)=>{const o=this.Je(i);if(o){if(a.current&&jp(o.target)){const l=new Fe(o.target.path);this.ke.get(l)!==null||this.it(i,l)||this.Ue(i,l,Br.newNoDocument(l,t))}a.be&&(r.set(i,a.ve()),a.Ce())}});let n=Je();this.qe.forEach((a,i)=>{let o=!0;i.forEachWhile(l=>{const u=this.Je(l);return!u||u.purpose==="TargetPurposeLimboResolution"||(o=!1,!1)}),o&&(n=n.add(a))}),this.ke.forEach((a,i)=>i.setReadTime(t));const s=new s0(t,r,this.Qe,this.ke,n);return this.ke=Ta(),this.qe=B_(),this.Qe=new Bt(ut),s}$e(t,r){if(!this.ze(t))return;const n=this.it(t,r.key)?2:0;this.Ge(t).Fe(r.key,n),this.ke=this.ke.insert(r.key,r),this.qe=this.qe.insert(r.key,this.st(r.key).add(t))}Ue(t,r,n){if(!this.ze(t))return;const s=this.Ge(t);this.it(t,r)?s.Fe(r,1):s.Me(r),this.qe=this.qe.insert(r,this.st(r).delete(t)),n&&(this.ke=this.ke.insert(r,n))}removeTarget(t){this.Be.delete(t)}Ye(t){const r=this.Ge(t).ve();return this.Le.getRemoteKeysForTarget(t).size+r.addedDocuments.size-r.removedDocuments.size}xe(t){this.Ge(t).xe()}Ge(t){let r=this.Be.get(t);return r||(r=new V_,this.Be.set(t,r)),r}st(t){let r=this.qe.get(t);return r||(r=new br(ut),this.qe=this.qe.insert(t,r)),r}ze(t){const r=this.Je(t)!==null;return r||Re("WatchChangeAggregator","Detected inactive target",t),r}Je(t){const r=this.Be.get(t);return r&&r.Se?null:this.Le.ot(t)}je(t){this.Be.set(t,new V_),this.Le.getRemoteKeysForTarget(t).forEach(r=>{this.Ue(t,r,null)})}it(t,r){return this.Le.getRemoteKeysForTarget(t).has(r)}}function B_(){return new Bt(Fe.comparator)}function $_(){return new Bt(Fe.comparator)}const NO={asc:"ASCENDING",desc:"DESCENDING"},CO={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},RO={and:"AND",or:"OR"};class PO{constructor(t,r){this.databaseId=t,this.useProto3Json=r}}function Vp(e,t){return e.useProto3Json||Jd(t)?t:{value:t}}function od(e,t){return e.useProto3Json?`${new Date(1e3*t.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+t.nanoseconds).slice(-9)}Z`:{seconds:""+t.seconds,nanos:t.nanoseconds}}function IS(e,t){return e.useProto3Json?t.toBase64():t.toUint8Array()}function DO(e,t){return od(e,t.toTimestamp())}function Us(e){return vt(!!e),$e.fromTimestamp(function(r){const n=pi(r);return new fr(n.seconds,n.nanos)}(e))}function Ox(e,t){return Bp(e,t).canonicalString()}function Bp(e,t){const r=function(s){return new Ct(["projects",s.projectId,"databases",s.database])}(e).child("documents");return t===void 0?r:r.child(t)}function NS(e){const t=Ct.fromString(e);return vt(FS(t)),t}function $p(e,t){return Ox(e.databaseId,t.path)}function cm(e,t){const r=NS(t);if(r.get(1)!==e.databaseId.projectId)throw new Ce(xe.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+r.get(1)+" vs "+e.databaseId.projectId);if(r.get(3)!==e.databaseId.database)throw new Ce(xe.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+r.get(3)+" vs "+e.databaseId.database);return new Fe(RS(r))}function CS(e,t){return Ox(e.databaseId,t)}function FO(e){const t=NS(e);return t.length===4?Ct.emptyPath():RS(t)}function Wp(e){return new Ct(["projects",e.databaseId.projectId,"databases",e.databaseId.database]).canonicalString()}function RS(e){return vt(e.length>4&&e.get(4)==="documents"),e.popFirst(5)}function W_(e,t,r){return{name:$p(e,t),fields:r.value.mapValue.fields}}function OO(e,t){let r;if("targetChange"in t){t.targetChange;const n=function(u){return u==="NO_CHANGE"?0:u==="ADD"?1:u==="REMOVE"?2:u==="CURRENT"?3:u==="RESET"?4:Ue()}(t.targetChange.targetChangeType||"NO_CHANGE"),s=t.targetChange.targetIds||[],a=function(u,f){return u.useProto3Json?(vt(f===void 0||typeof f=="string"),Rr.fromBase64String(f||"")):(vt(f===void 0||f instanceof Buffer||f instanceof Uint8Array),Rr.fromUint8Array(f||new Uint8Array))}(e,t.targetChange.resumeToken),i=t.targetChange.cause,o=i&&function(u){const f=u.code===void 0?xe.UNKNOWN:SS(u.code);return new Ce(f,u.message||"")}(i);r=new bS(n,s,a,o||null)}else if("documentChange"in t){t.documentChange;const n=t.documentChange;n.document,n.document.name,n.document.updateTime;const s=cm(e,n.document.name),a=Us(n.document.updateTime),i=n.document.createTime?Us(n.document.createTime):$e.min(),o=new pn({mapValue:{fields:n.document.fields}}),l=Br.newFoundDocument(s,a,i,o),u=n.targetIds||[],f=n.removedTargetIds||[];r=new yh(u,f,l.key,l)}else if("documentDelete"in t){t.documentDelete;const n=t.documentDelete;n.document;const s=cm(e,n.document),a=n.readTime?Us(n.readTime):$e.min(),i=Br.newNoDocument(s,a),o=n.removedTargetIds||[];r=new yh([],o,i.key,i)}else if("documentRemove"in t){t.documentRemove;const n=t.documentRemove;n.document;const s=cm(e,n.document),a=n.removedTargetIds||[];r=new yh([],a,s,null)}else{if(!("filter"in t))return Ue();{t.filter;const n=t.filter;n.targetId;const{count:s=0,unchangedNames:a}=n,i=new kO(s,a),o=n.targetId;r=new AS(o,i)}}return r}function MO(e,t){let r;if(t instanceof Hu)r={update:W_(e,t.key,t.value)};else if(t instanceof Px)r={delete:$p(e,t.key)};else if(t instanceof Ti)r={update:W_(e,t.key,t.data),updateMask:HO(t.fieldMask)};else{if(!(t instanceof wO))return Ue();r={verify:$p(e,t.key)}}return t.fieldTransforms.length>0&&(r.updateTransforms=t.fieldTransforms.map(n=>function(a,i){const o=i.transform;if(o instanceof gu)return{fieldPath:i.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(o instanceof xu)return{fieldPath:i.field.canonicalString(),appendMissingElements:{values:o.elements}};if(o instanceof vu)return{fieldPath:i.field.canonicalString(),removeAllFromArray:{values:o.elements}};if(o instanceof yu)return{fieldPath:i.field.canonicalString(),increment:o.Pe};throw Ue()}(0,n))),t.precondition.isNone||(r.currentDocument=function(s,a){return a.updateTime!==void 0?{updateTime:DO(s,a.updateTime)}:a.exists!==void 0?{exists:a.exists}:Ue()}(e,t.precondition)),r}function jO(e,t){return e&&e.length>0?(vt(t!==void 0),e.map(r=>function(s,a){let i=s.updateTime?Us(s.updateTime):Us(a);return i.isEqual($e.min())&&(i=Us(a)),new vO(i,s.transformResults||[])}(r,t))):[]}function LO(e,t){return{documents:[CS(e,t.path)]}}function UO(e,t){const r={structuredQuery:{}},n=t.path;let s;t.collectionGroup!==null?(s=n,r.structuredQuery.from=[{collectionId:t.collectionGroup,allDescendants:!0}]):(s=n.popLast(),r.structuredQuery.from=[{collectionId:n.lastSegment()}]),r.parent=CS(e,s);const a=function(u){if(u.length!==0)return DS(Es.create(u,"and"))}(t.filters);a&&(r.structuredQuery.where=a);const i=function(u){if(u.length!==0)return u.map(f=>function(m){return{field:Ro(m.field),direction:$O(m.dir)}}(f))}(t.orderBy);i&&(r.structuredQuery.orderBy=i);const o=Vp(e,t.limit);return o!==null&&(r.structuredQuery.limit=o),t.startAt&&(r.structuredQuery.startAt=function(u){return{before:u.inclusive,values:u.position}}(t.startAt)),t.endAt&&(r.structuredQuery.endAt=function(u){return{before:!u.inclusive,values:u.position}}(t.endAt)),{_t:r,parent:s}}function VO(e){let t=FO(e.parent);const r=e.structuredQuery,n=r.from?r.from.length:0;let s=null;if(n>0){vt(n===1);const f=r.from[0];f.allDescendants?s=f.collectionId:t=t.child(f.collectionId)}let a=[];r.where&&(a=function(d){const m=PS(d);return m instanceof Es&&iS(m)?m.getFilters():[m]}(r.where));let i=[];r.orderBy&&(i=function(d){return d.map(m=>function(x){return new id(Po(x.field),function(_){switch(_){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(x.direction))}(m))}(r.orderBy));let o=null;r.limit&&(o=function(d){let m;return m=typeof d=="object"?d.value:d,Jd(m)?null:m}(r.limit));let l=null;r.startAt&&(l=function(d){const m=!!d.before,p=d.values||[];return new ad(p,m)}(r.startAt));let u=null;return r.endAt&&(u=function(d){const m=!d.before,p=d.values||[];return new ad(p,m)}(r.endAt)),iO(t,s,i,a,o,"F",l,u)}function BO(e,t){const r=function(s){switch(s){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return Ue()}}(t.purpose);return r==null?null:{"goog-listen-tags":r}}function PS(e){return e.unaryFilter!==void 0?function(r){switch(r.unaryFilter.op){case"IS_NAN":const n=Po(r.unaryFilter.field);return ar.create(n,"==",{doubleValue:NaN});case"IS_NULL":const s=Po(r.unaryFilter.field);return ar.create(s,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const a=Po(r.unaryFilter.field);return ar.create(a,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const i=Po(r.unaryFilter.field);return ar.create(i,"!=",{nullValue:"NULL_VALUE"});default:return Ue()}}(e):e.fieldFilter!==void 0?function(r){return ar.create(Po(r.fieldFilter.field),function(s){switch(s){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return Ue()}}(r.fieldFilter.op),r.fieldFilter.value)}(e):e.compositeFilter!==void 0?function(r){return Es.create(r.compositeFilter.filters.map(n=>PS(n)),function(s){switch(s){case"AND":return"and";case"OR":return"or";default:return Ue()}}(r.compositeFilter.op))}(e):Ue()}function $O(e){return NO[e]}function WO(e){return CO[e]}function zO(e){return RO[e]}function Ro(e){return{fieldPath:e.canonicalString()}}function Po(e){return Sr.fromServerFormat(e.fieldPath)}function DS(e){return e instanceof ar?function(r){if(r.op==="=="){if(N_(r.value))return{unaryFilter:{field:Ro(r.field),op:"IS_NAN"}};if(I_(r.value))return{unaryFilter:{field:Ro(r.field),op:"IS_NULL"}}}else if(r.op==="!="){if(N_(r.value))return{unaryFilter:{field:Ro(r.field),op:"IS_NOT_NAN"}};if(I_(r.value))return{unaryFilter:{field:Ro(r.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Ro(r.field),op:WO(r.op),value:r.value}}}(e):e instanceof Es?function(r){const n=r.getFilters().map(s=>DS(s));return n.length===1?n[0]:{compositeFilter:{op:zO(r.op),filters:n}}}(e):Ue()}function HO(e){const t=[];return e.fields.forEach(r=>t.push(r.canonicalString())),{fieldPaths:t}}function FS(e){return e.length>=4&&e.get(0)==="projects"&&e.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xa{constructor(t,r,n,s,a=$e.min(),i=$e.min(),o=Rr.EMPTY_BYTE_STRING,l=null){this.target=t,this.targetId=r,this.purpose=n,this.sequenceNumber=s,this.snapshotVersion=a,this.lastLimboFreeSnapshotVersion=i,this.resumeToken=o,this.expectedCount=l}withSequenceNumber(t){return new Xa(this.target,this.targetId,this.purpose,t,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(t,r){return new Xa(this.target,this.targetId,this.purpose,this.sequenceNumber,r,this.lastLimboFreeSnapshotVersion,t,null)}withExpectedCount(t){return new Xa(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,t)}withLastLimboFreeSnapshotVersion(t){return new Xa(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,t,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GO{constructor(t){this.ct=t}}function KO(e){const t=VO({parent:e.parent,structuredQuery:e.structuredQuery});return e.limitType==="LAST"?Up(t,t.limit,"L"):t}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qO{constructor(){this.un=new XO}addToCollectionParentIndex(t,r){return this.un.add(r),_e.resolve()}getCollectionParents(t,r){return _e.resolve(this.un.getEntries(r))}addFieldIndex(t,r){return _e.resolve()}deleteFieldIndex(t,r){return _e.resolve()}deleteAllFieldIndexes(t){return _e.resolve()}createTargetIndexes(t,r){return _e.resolve()}getDocumentsMatchingTarget(t,r){return _e.resolve(null)}getIndexType(t,r){return _e.resolve(0)}getFieldIndexes(t,r){return _e.resolve([])}getNextCollectionGroupToUpdate(t){return _e.resolve(null)}getMinOffset(t,r){return _e.resolve(mi.min())}getMinOffsetFromCollectionGroup(t,r){return _e.resolve(mi.min())}updateCollectionGroup(t,r,n){return _e.resolve()}updateIndexEntries(t,r){return _e.resolve()}}class XO{constructor(){this.index={}}add(t){const r=t.lastSegment(),n=t.popLast(),s=this.index[r]||new br(Ct.comparator),a=!s.has(n);return this.index[r]=s.add(n),a}has(t){const r=t.lastSegment(),n=t.popLast(),s=this.index[r];return s&&s.has(n)}getEntries(t){return(this.index[t]||new br(Ct.comparator)).toArray()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class El{constructor(t){this.Ln=t}next(){return this.Ln+=2,this.Ln}static Bn(){return new El(0)}static kn(){return new El(-1)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YO{constructor(){this.changes=new Dl(t=>t.toString(),(t,r)=>t.isEqual(r)),this.changesApplied=!1}addEntry(t){this.assertNotApplied(),this.changes.set(t.key,t)}removeEntry(t,r){this.assertNotApplied(),this.changes.set(t,Br.newInvalidDocument(t).setReadTime(r))}getEntry(t,r){this.assertNotApplied();const n=this.changes.get(r);return n!==void 0?_e.resolve(n):this.getFromCache(t,r)}getEntries(t,r){return this.getAllFromCache(t,r)}apply(t){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(t)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QO{constructor(t,r){this.overlayedDocument=t,this.mutatedFields=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JO{constructor(t,r,n,s){this.remoteDocumentCache=t,this.mutationQueue=r,this.documentOverlayCache=n,this.indexManager=s}getDocument(t,r){let n=null;return this.documentOverlayCache.getOverlay(t,r).next(s=>(n=s,this.remoteDocumentCache.getEntry(t,r))).next(s=>(n!==null&&Dc(n.mutation,s,Cn.empty(),fr.now()),s))}getDocuments(t,r){return this.remoteDocumentCache.getEntries(t,r).next(n=>this.getLocalViewOfDocuments(t,n,Je()).next(()=>n))}getLocalViewOfDocuments(t,r,n=Je()){const s=Li();return this.populateOverlays(t,s,r).next(()=>this.computeViews(t,r,s,n).next(a=>{let i=dc();return a.forEach((o,l)=>{i=i.insert(o,l.overlayedDocument)}),i}))}getOverlayedDocuments(t,r){const n=Li();return this.populateOverlays(t,n,r).next(()=>this.computeViews(t,r,n,Je()))}populateOverlays(t,r,n){const s=[];return n.forEach(a=>{r.has(a)||s.push(a)}),this.documentOverlayCache.getOverlays(t,s).next(a=>{a.forEach((i,o)=>{r.set(i,o)})})}computeViews(t,r,n,s){let a=Ta();const i=Pc(),o=function(){return Pc()}();return r.forEach((l,u)=>{const f=n.get(u.key);s.has(u.key)&&(f===void 0||f.mutation instanceof Ti)?a=a.insert(u.key,u):f!==void 0?(i.set(u.key,f.mutation.getFieldMask()),Dc(f.mutation,u,f.mutation.getFieldMask(),fr.now())):i.set(u.key,Cn.empty())}),this.recalculateAndSaveOverlays(t,a).next(l=>(l.forEach((u,f)=>i.set(u,f)),r.forEach((u,f)=>{var d;return o.set(u,new QO(f,(d=i.get(u))!==null&&d!==void 0?d:null))}),o))}recalculateAndSaveOverlays(t,r){const n=Pc();let s=new Bt((i,o)=>i-o),a=Je();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(t,r).next(i=>{for(const o of i)o.keys().forEach(l=>{const u=r.get(l);if(u===null)return;let f=n.get(l)||Cn.empty();f=o.applyToLocalView(u,f),n.set(l,f);const d=(s.get(o.batchId)||Je()).add(l);s=s.insert(o.batchId,d)})}).next(()=>{const i=[],o=s.getReverseIterator();for(;o.hasNext();){const l=o.getNext(),u=l.key,f=l.value,d=pS();f.forEach(m=>{if(!a.has(m)){const p=TS(r.get(m),n.get(m));p!==null&&d.set(m,p),a=a.add(m)}}),i.push(this.documentOverlayCache.saveOverlays(t,u,d))}return _e.waitFor(i)}).next(()=>n)}recalculateAndSaveOverlaysForDocumentKeys(t,r){return this.remoteDocumentCache.getEntries(t,r).next(n=>this.recalculateAndSaveOverlays(t,n))}getDocumentsMatchingQuery(t,r,n,s){return function(i){return Fe.isDocumentKey(i.path)&&i.collectionGroup===null&&i.filters.length===0}(r)?this.getDocumentsMatchingDocumentQuery(t,r.path):uS(r)?this.getDocumentsMatchingCollectionGroupQuery(t,r,n,s):this.getDocumentsMatchingCollectionQuery(t,r,n,s)}getNextDocuments(t,r,n,s){return this.remoteDocumentCache.getAllFromCollectionGroup(t,r,n,s).next(a=>{const i=s-a.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(t,r,n.largestBatchId,s-a.size):_e.resolve(Li());let o=-1,l=a;return i.next(u=>_e.forEach(u,(f,d)=>(o<d.largestBatchId&&(o=d.largestBatchId),a.get(f)?_e.resolve():this.remoteDocumentCache.getEntry(t,f).next(m=>{l=l.insert(f,m)}))).next(()=>this.populateOverlays(t,u,a)).next(()=>this.computeViews(t,l,u,Je())).next(f=>({batchId:o,changes:mS(f)})))})}getDocumentsMatchingDocumentQuery(t,r){return this.getDocument(t,new Fe(r)).next(n=>{let s=dc();return n.isFoundDocument()&&(s=s.insert(n.key,n)),s})}getDocumentsMatchingCollectionGroupQuery(t,r,n,s){const a=r.collectionGroup;let i=dc();return this.indexManager.getCollectionParents(t,a).next(o=>_e.forEach(o,l=>{const u=function(d,m){return new zu(m,null,d.explicitOrderBy.slice(),d.filters.slice(),d.limit,d.limitType,d.startAt,d.endAt)}(r,l.child(a));return this.getDocumentsMatchingCollectionQuery(t,u,n,s).next(f=>{f.forEach((d,m)=>{i=i.insert(d,m)})})}).next(()=>i))}getDocumentsMatchingCollectionQuery(t,r,n,s){let a;return this.documentOverlayCache.getOverlaysForCollection(t,r.path,n.largestBatchId).next(i=>(a=i,this.remoteDocumentCache.getDocumentsMatchingQuery(t,r,n,a,s))).next(i=>{a.forEach((l,u)=>{const f=u.getKey();i.get(f)===null&&(i=i.insert(f,Br.newInvalidDocument(f)))});let o=dc();return i.forEach((l,u)=>{const f=a.get(l);f!==void 0&&Dc(f.mutation,u,Cn.empty(),fr.now()),t0(r,u)&&(o=o.insert(l,u))}),o})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZO{constructor(t){this.serializer=t,this.hr=new Map,this.Pr=new Map}getBundleMetadata(t,r){return _e.resolve(this.hr.get(r))}saveBundleMetadata(t,r){return this.hr.set(r.id,function(s){return{id:s.id,version:s.version,createTime:Us(s.createTime)}}(r)),_e.resolve()}getNamedQuery(t,r){return _e.resolve(this.Pr.get(r))}saveNamedQuery(t,r){return this.Pr.set(r.name,function(s){return{name:s.name,query:KO(s.bundledQuery),readTime:Us(s.readTime)}}(r)),_e.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eM{constructor(){this.overlays=new Bt(Fe.comparator),this.Ir=new Map}getOverlay(t,r){return _e.resolve(this.overlays.get(r))}getOverlays(t,r){const n=Li();return _e.forEach(r,s=>this.getOverlay(t,s).next(a=>{a!==null&&n.set(s,a)})).next(()=>n)}saveOverlays(t,r,n){return n.forEach((s,a)=>{this.ht(t,r,a)}),_e.resolve()}removeOverlaysForBatchId(t,r,n){const s=this.Ir.get(n);return s!==void 0&&(s.forEach(a=>this.overlays=this.overlays.remove(a)),this.Ir.delete(n)),_e.resolve()}getOverlaysForCollection(t,r,n){const s=Li(),a=r.length+1,i=new Fe(r.child("")),o=this.overlays.getIteratorFrom(i);for(;o.hasNext();){const l=o.getNext().value,u=l.getKey();if(!r.isPrefixOf(u.path))break;u.path.length===a&&l.largestBatchId>n&&s.set(l.getKey(),l)}return _e.resolve(s)}getOverlaysForCollectionGroup(t,r,n,s){let a=new Bt((u,f)=>u-f);const i=this.overlays.getIterator();for(;i.hasNext();){const u=i.getNext().value;if(u.getKey().getCollectionGroup()===r&&u.largestBatchId>n){let f=a.get(u.largestBatchId);f===null&&(f=Li(),a=a.insert(u.largestBatchId,f)),f.set(u.getKey(),u)}}const o=Li(),l=a.getIterator();for(;l.hasNext()&&(l.getNext().value.forEach((u,f)=>o.set(u,f)),!(o.size()>=s)););return _e.resolve(o)}ht(t,r,n){const s=this.overlays.get(n.key);if(s!==null){const i=this.Ir.get(s.largestBatchId).delete(n.key);this.Ir.set(s.largestBatchId,i)}this.overlays=this.overlays.insert(n.key,new TO(r,n));let a=this.Ir.get(r);a===void 0&&(a=Je(),this.Ir.set(r,a)),this.Ir.set(r,a.add(n.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tM{constructor(){this.sessionToken=Rr.EMPTY_BYTE_STRING}getSessionToken(t){return _e.resolve(this.sessionToken)}setSessionToken(t,r){return this.sessionToken=r,_e.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mx{constructor(){this.Tr=new br(pr.Er),this.dr=new br(pr.Ar)}isEmpty(){return this.Tr.isEmpty()}addReference(t,r){const n=new pr(t,r);this.Tr=this.Tr.add(n),this.dr=this.dr.add(n)}Rr(t,r){t.forEach(n=>this.addReference(n,r))}removeReference(t,r){this.Vr(new pr(t,r))}mr(t,r){t.forEach(n=>this.removeReference(n,r))}gr(t){const r=new Fe(new Ct([])),n=new pr(r,t),s=new pr(r,t+1),a=[];return this.dr.forEachInRange([n,s],i=>{this.Vr(i),a.push(i.key)}),a}pr(){this.Tr.forEach(t=>this.Vr(t))}Vr(t){this.Tr=this.Tr.delete(t),this.dr=this.dr.delete(t)}yr(t){const r=new Fe(new Ct([])),n=new pr(r,t),s=new pr(r,t+1);let a=Je();return this.dr.forEachInRange([n,s],i=>{a=a.add(i.key)}),a}containsKey(t){const r=new pr(t,0),n=this.Tr.firstAfterOrEqual(r);return n!==null&&t.isEqual(n.key)}}class pr{constructor(t,r){this.key=t,this.wr=r}static Er(t,r){return Fe.comparator(t.key,r.key)||ut(t.wr,r.wr)}static Ar(t,r){return ut(t.wr,r.wr)||Fe.comparator(t.key,r.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rM{constructor(t,r){this.indexManager=t,this.referenceDelegate=r,this.mutationQueue=[],this.Sr=1,this.br=new br(pr.Er)}checkEmpty(t){return _e.resolve(this.mutationQueue.length===0)}addMutationBatch(t,r,n,s){const a=this.Sr;this.Sr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const i=new EO(a,r,n,s);this.mutationQueue.push(i);for(const o of s)this.br=this.br.add(new pr(o.key,a)),this.indexManager.addToCollectionParentIndex(t,o.key.path.popLast());return _e.resolve(i)}lookupMutationBatch(t,r){return _e.resolve(this.Dr(r))}getNextMutationBatchAfterBatchId(t,r){const n=r+1,s=this.vr(n),a=s<0?0:s;return _e.resolve(this.mutationQueue.length>a?this.mutationQueue[a]:null)}getHighestUnacknowledgedBatchId(){return _e.resolve(this.mutationQueue.length===0?-1:this.Sr-1)}getAllMutationBatches(t){return _e.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(t,r){const n=new pr(r,0),s=new pr(r,Number.POSITIVE_INFINITY),a=[];return this.br.forEachInRange([n,s],i=>{const o=this.Dr(i.wr);a.push(o)}),_e.resolve(a)}getAllMutationBatchesAffectingDocumentKeys(t,r){let n=new br(ut);return r.forEach(s=>{const a=new pr(s,0),i=new pr(s,Number.POSITIVE_INFINITY);this.br.forEachInRange([a,i],o=>{n=n.add(o.wr)})}),_e.resolve(this.Cr(n))}getAllMutationBatchesAffectingQuery(t,r){const n=r.path,s=n.length+1;let a=n;Fe.isDocumentKey(a)||(a=a.child(""));const i=new pr(new Fe(a),0);let o=new br(ut);return this.br.forEachWhile(l=>{const u=l.key.path;return!!n.isPrefixOf(u)&&(u.length===s&&(o=o.add(l.wr)),!0)},i),_e.resolve(this.Cr(o))}Cr(t){const r=[];return t.forEach(n=>{const s=this.Dr(n);s!==null&&r.push(s)}),r}removeMutationBatch(t,r){vt(this.Fr(r.batchId,"removed")===0),this.mutationQueue.shift();let n=this.br;return _e.forEach(r.mutations,s=>{const a=new pr(s.key,r.batchId);return n=n.delete(a),this.referenceDelegate.markPotentiallyOrphaned(t,s.key)}).next(()=>{this.br=n})}On(t){}containsKey(t,r){const n=new pr(r,0),s=this.br.firstAfterOrEqual(n);return _e.resolve(r.isEqual(s&&s.key))}performConsistencyCheck(t){return this.mutationQueue.length,_e.resolve()}Fr(t,r){return this.vr(t)}vr(t){return this.mutationQueue.length===0?0:t-this.mutationQueue[0].batchId}Dr(t){const r=this.vr(t);return r<0||r>=this.mutationQueue.length?null:this.mutationQueue[r]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nM{constructor(t){this.Mr=t,this.docs=function(){return new Bt(Fe.comparator)}(),this.size=0}setIndexManager(t){this.indexManager=t}addEntry(t,r){const n=r.key,s=this.docs.get(n),a=s?s.size:0,i=this.Mr(r);return this.docs=this.docs.insert(n,{document:r.mutableCopy(),size:i}),this.size+=i-a,this.indexManager.addToCollectionParentIndex(t,n.path.popLast())}removeEntry(t){const r=this.docs.get(t);r&&(this.docs=this.docs.remove(t),this.size-=r.size)}getEntry(t,r){const n=this.docs.get(r);return _e.resolve(n?n.document.mutableCopy():Br.newInvalidDocument(r))}getEntries(t,r){let n=Ta();return r.forEach(s=>{const a=this.docs.get(s);n=n.insert(s,a?a.document.mutableCopy():Br.newInvalidDocument(s))}),_e.resolve(n)}getDocumentsMatchingQuery(t,r,n,s){let a=Ta();const i=r.path,o=new Fe(i.child("")),l=this.docs.getIteratorFrom(o);for(;l.hasNext();){const{key:u,value:{document:f}}=l.getNext();if(!i.isPrefixOf(u.path))break;u.path.length>i.length+1||B3(V3(f),n)<=0||(s.has(f.key)||t0(r,f))&&(a=a.insert(f.key,f.mutableCopy()))}return _e.resolve(a)}getAllFromCollectionGroup(t,r,n,s){Ue()}Or(t,r){return _e.forEach(this.docs,n=>r(n))}newChangeBuffer(t){return new sM(this)}getSize(t){return _e.resolve(this.size)}}class sM extends YO{constructor(t){super(),this.cr=t}applyChanges(t){const r=[];return this.changes.forEach((n,s)=>{s.isValidDocument()?r.push(this.cr.addEntry(t,s)):this.cr.removeEntry(n)}),_e.waitFor(r)}getFromCache(t,r){return this.cr.getEntry(t,r)}getAllFromCache(t,r){return this.cr.getEntries(t,r)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aM{constructor(t){this.persistence=t,this.Nr=new Dl(r=>Nx(r),Cx),this.lastRemoteSnapshotVersion=$e.min(),this.highestTargetId=0,this.Lr=0,this.Br=new Mx,this.targetCount=0,this.kr=El.Bn()}forEachTarget(t,r){return this.Nr.forEach((n,s)=>r(s)),_e.resolve()}getLastRemoteSnapshotVersion(t){return _e.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(t){return _e.resolve(this.Lr)}allocateTargetId(t){return this.highestTargetId=this.kr.next(),_e.resolve(this.highestTargetId)}setTargetsMetadata(t,r,n){return n&&(this.lastRemoteSnapshotVersion=n),r>this.Lr&&(this.Lr=r),_e.resolve()}Kn(t){this.Nr.set(t.target,t);const r=t.targetId;r>this.highestTargetId&&(this.kr=new El(r),this.highestTargetId=r),t.sequenceNumber>this.Lr&&(this.Lr=t.sequenceNumber)}addTargetData(t,r){return this.Kn(r),this.targetCount+=1,_e.resolve()}updateTargetData(t,r){return this.Kn(r),_e.resolve()}removeTargetData(t,r){return this.Nr.delete(r.target),this.Br.gr(r.targetId),this.targetCount-=1,_e.resolve()}removeTargets(t,r,n){let s=0;const a=[];return this.Nr.forEach((i,o)=>{o.sequenceNumber<=r&&n.get(o.targetId)===null&&(this.Nr.delete(i),a.push(this.removeMatchingKeysForTargetId(t,o.targetId)),s++)}),_e.waitFor(a).next(()=>s)}getTargetCount(t){return _e.resolve(this.targetCount)}getTargetData(t,r){const n=this.Nr.get(r)||null;return _e.resolve(n)}addMatchingKeys(t,r,n){return this.Br.Rr(r,n),_e.resolve()}removeMatchingKeys(t,r,n){this.Br.mr(r,n);const s=this.persistence.referenceDelegate,a=[];return s&&r.forEach(i=>{a.push(s.markPotentiallyOrphaned(t,i))}),_e.waitFor(a)}removeMatchingKeysForTargetId(t,r){return this.Br.gr(r),_e.resolve()}getMatchingKeysForTargetId(t,r){const n=this.Br.yr(r);return _e.resolve(n)}containsKey(t,r){return _e.resolve(this.Br.containsKey(r))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iM{constructor(t,r){this.qr={},this.overlays={},this.Qr=new Sx(0),this.Kr=!1,this.Kr=!0,this.$r=new tM,this.referenceDelegate=t(this),this.Ur=new aM(this),this.indexManager=new qO,this.remoteDocumentCache=function(s){return new nM(s)}(n=>this.referenceDelegate.Wr(n)),this.serializer=new GO(r),this.Gr=new ZO(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.Kr=!1,Promise.resolve()}get started(){return this.Kr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(t){return this.indexManager}getDocumentOverlayCache(t){let r=this.overlays[t.toKey()];return r||(r=new eM,this.overlays[t.toKey()]=r),r}getMutationQueue(t,r){let n=this.qr[t.toKey()];return n||(n=new rM(r,this.referenceDelegate),this.qr[t.toKey()]=n),n}getGlobalsCache(){return this.$r}getTargetCache(){return this.Ur}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Gr}runTransaction(t,r,n){Re("MemoryPersistence","Starting transaction:",t);const s=new oM(this.Qr.next());return this.referenceDelegate.zr(),n(s).next(a=>this.referenceDelegate.jr(s).next(()=>a)).toPromise().then(a=>(s.raiseOnCommittedEvent(),a))}Hr(t,r){return _e.or(Object.values(this.qr).map(n=>()=>n.containsKey(t,r)))}}class oM extends W3{constructor(t){super(),this.currentSequenceNumber=t}}class jx{constructor(t){this.persistence=t,this.Jr=new Mx,this.Yr=null}static Zr(t){return new jx(t)}get Xr(){if(this.Yr)return this.Yr;throw Ue()}addReference(t,r,n){return this.Jr.addReference(n,r),this.Xr.delete(n.toString()),_e.resolve()}removeReference(t,r,n){return this.Jr.removeReference(n,r),this.Xr.add(n.toString()),_e.resolve()}markPotentiallyOrphaned(t,r){return this.Xr.add(r.toString()),_e.resolve()}removeTarget(t,r){this.Jr.gr(r.targetId).forEach(s=>this.Xr.add(s.toString()));const n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(t,r.targetId).next(s=>{s.forEach(a=>this.Xr.add(a.toString()))}).next(()=>n.removeTargetData(t,r))}zr(){this.Yr=new Set}jr(t){const r=this.persistence.getRemoteDocumentCache().newChangeBuffer();return _e.forEach(this.Xr,n=>{const s=Fe.fromPath(n);return this.ei(t,s).next(a=>{a||r.removeEntry(s,$e.min())})}).next(()=>(this.Yr=null,r.apply(t)))}updateLimboDocument(t,r){return this.ei(t,r).next(n=>{n?this.Xr.delete(r.toString()):this.Xr.add(r.toString())})}Wr(t){return 0}ei(t,r){return _e.or([()=>_e.resolve(this.Jr.containsKey(r)),()=>this.persistence.getTargetCache().containsKey(t,r),()=>this.persistence.Hr(t,r)])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lx{constructor(t,r,n,s){this.targetId=t,this.fromCache=r,this.$i=n,this.Ui=s}static Wi(t,r){let n=Je(),s=Je();for(const a of r.docChanges)switch(a.type){case 0:n=n.add(a.doc.key);break;case 1:s=s.add(a.doc.key)}return new Lx(t,r.fromCache,n,s)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lM{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(t){this._documentReadCount+=t}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cM{constructor(){this.Gi=!1,this.zi=!1,this.ji=100,this.Hi=function(){return gP()?8:z3(Kr())>0?6:4}()}initialize(t,r){this.Ji=t,this.indexManager=r,this.Gi=!0}getDocumentsMatchingQuery(t,r,n,s){const a={result:null};return this.Yi(t,r).next(i=>{a.result=i}).next(()=>{if(!a.result)return this.Zi(t,r,s,n).next(i=>{a.result=i})}).next(()=>{if(a.result)return;const i=new lM;return this.Xi(t,r,i).next(o=>{if(a.result=o,this.zi)return this.es(t,r,i,o.size)})}).next(()=>a.result)}es(t,r,n,s){return n.documentReadCount<this.ji?(ac()<=et.DEBUG&&Re("QueryEngine","SDK will not create cache indexes for query:",Co(r),"since it only creates cache indexes for collection contains","more than or equal to",this.ji,"documents"),_e.resolve()):(ac()<=et.DEBUG&&Re("QueryEngine","Query:",Co(r),"scans",n.documentReadCount,"local documents and returns",s,"documents as results."),n.documentReadCount>this.Hi*s?(ac()<=et.DEBUG&&Re("QueryEngine","The SDK decides to create cache indexes for query:",Co(r),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(t,Ls(r))):_e.resolve())}Yi(t,r){if(D_(r))return _e.resolve(null);let n=Ls(r);return this.indexManager.getIndexType(t,n).next(s=>s===0?null:(r.limit!==null&&s===1&&(r=Up(r,null,"F"),n=Ls(r)),this.indexManager.getDocumentsMatchingTarget(t,n).next(a=>{const i=Je(...a);return this.Ji.getDocuments(t,i).next(o=>this.indexManager.getMinOffset(t,n).next(l=>{const u=this.ts(r,o);return this.ns(r,u,i,l.readTime)?this.Yi(t,Up(r,null,"F")):this.rs(t,u,r,l)}))})))}Zi(t,r,n,s){return D_(r)||s.isEqual($e.min())?_e.resolve(null):this.Ji.getDocuments(t,n).next(a=>{const i=this.ts(r,a);return this.ns(r,i,n,s)?_e.resolve(null):(ac()<=et.DEBUG&&Re("QueryEngine","Re-using previous result from %s to execute query: %s",s.toString(),Co(r)),this.rs(t,i,r,U3(s,-1)).next(o=>o))})}ts(t,r){let n=new br(hS(t));return r.forEach((s,a)=>{t0(t,a)&&(n=n.add(a))}),n}ns(t,r,n,s){if(t.limit===null)return!1;if(n.size!==r.size)return!0;const a=t.limitType==="F"?r.last():r.first();return!!a&&(a.hasPendingWrites||a.version.compareTo(s)>0)}Xi(t,r,n){return ac()<=et.DEBUG&&Re("QueryEngine","Using full collection scan to execute query:",Co(r)),this.Ji.getDocumentsMatchingQuery(t,r,mi.min(),n)}rs(t,r,n,s){return this.Ji.getDocumentsMatchingQuery(t,n,s).next(a=>(r.forEach(i=>{a=a.insert(i.key,i)}),a))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uM{constructor(t,r,n,s){this.persistence=t,this.ss=r,this.serializer=s,this.os=new Bt(ut),this._s=new Dl(a=>Nx(a),Cx),this.us=new Map,this.cs=t.getRemoteDocumentCache(),this.Ur=t.getTargetCache(),this.Gr=t.getBundleCache(),this.ls(n)}ls(t){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(t),this.indexManager=this.persistence.getIndexManager(t),this.mutationQueue=this.persistence.getMutationQueue(t,this.indexManager),this.localDocuments=new JO(this.cs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.cs.setIndexManager(this.indexManager),this.ss.initialize(this.localDocuments,this.indexManager)}collectGarbage(t){return this.persistence.runTransaction("Collect garbage","readwrite-primary",r=>t.collect(r,this.os))}}function fM(e,t,r,n){return new uM(e,t,r,n)}async function OS(e,t){const r=ze(e);return await r.persistence.runTransaction("Handle user change","readonly",n=>{let s;return r.mutationQueue.getAllMutationBatches(n).next(a=>(s=a,r.ls(t),r.mutationQueue.getAllMutationBatches(n))).next(a=>{const i=[],o=[];let l=Je();for(const u of s){i.push(u.batchId);for(const f of u.mutations)l=l.add(f.key)}for(const u of a){o.push(u.batchId);for(const f of u.mutations)l=l.add(f.key)}return r.localDocuments.getDocuments(n,l).next(u=>({hs:u,removedBatchIds:i,addedBatchIds:o}))})})}function hM(e,t){const r=ze(e);return r.persistence.runTransaction("Acknowledge batch","readwrite-primary",n=>{const s=t.batch.keys(),a=r.cs.newChangeBuffer({trackRemovals:!0});return function(o,l,u,f){const d=u.batch,m=d.keys();let p=_e.resolve();return m.forEach(x=>{p=p.next(()=>f.getEntry(l,x)).next(g=>{const _=u.docVersions.get(x);vt(_!==null),g.version.compareTo(_)<0&&(d.applyToRemoteDocument(g,u),g.isValidDocument()&&(g.setReadTime(u.commitVersion),f.addEntry(g)))})}),p.next(()=>o.mutationQueue.removeMutationBatch(l,d))}(r,n,t,a).next(()=>a.apply(n)).next(()=>r.mutationQueue.performConsistencyCheck(n)).next(()=>r.documentOverlayCache.removeOverlaysForBatchId(n,s,t.batch.batchId)).next(()=>r.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(n,function(o){let l=Je();for(let u=0;u<o.mutationResults.length;++u)o.mutationResults[u].transformResults.length>0&&(l=l.add(o.batch.mutations[u].key));return l}(t))).next(()=>r.localDocuments.getDocuments(n,s))})}function MS(e){const t=ze(e);return t.persistence.runTransaction("Get last remote snapshot version","readonly",r=>t.Ur.getLastRemoteSnapshotVersion(r))}function dM(e,t){const r=ze(e),n=t.snapshotVersion;let s=r.os;return r.persistence.runTransaction("Apply remote event","readwrite-primary",a=>{const i=r.cs.newChangeBuffer({trackRemovals:!0});s=r.os;const o=[];t.targetChanges.forEach((f,d)=>{const m=s.get(d);if(!m)return;o.push(r.Ur.removeMatchingKeys(a,f.removedDocuments,d).next(()=>r.Ur.addMatchingKeys(a,f.addedDocuments,d)));let p=m.withSequenceNumber(a.currentSequenceNumber);t.targetMismatches.get(d)!==null?p=p.withResumeToken(Rr.EMPTY_BYTE_STRING,$e.min()).withLastLimboFreeSnapshotVersion($e.min()):f.resumeToken.approximateByteSize()>0&&(p=p.withResumeToken(f.resumeToken,n)),s=s.insert(d,p),function(g,_,k){return g.resumeToken.approximateByteSize()===0||_.snapshotVersion.toMicroseconds()-g.snapshotVersion.toMicroseconds()>=3e8?!0:k.addedDocuments.size+k.modifiedDocuments.size+k.removedDocuments.size>0}(m,p,f)&&o.push(r.Ur.updateTargetData(a,p))});let l=Ta(),u=Je();if(t.documentUpdates.forEach(f=>{t.resolvedLimboDocuments.has(f)&&o.push(r.persistence.referenceDelegate.updateLimboDocument(a,f))}),o.push(mM(a,i,t.documentUpdates).next(f=>{l=f.Ps,u=f.Is})),!n.isEqual($e.min())){const f=r.Ur.getLastRemoteSnapshotVersion(a).next(d=>r.Ur.setTargetsMetadata(a,a.currentSequenceNumber,n));o.push(f)}return _e.waitFor(o).next(()=>i.apply(a)).next(()=>r.localDocuments.getLocalViewOfDocuments(a,l,u)).next(()=>l)}).then(a=>(r.os=s,a))}function mM(e,t,r){let n=Je(),s=Je();return r.forEach(a=>n=n.add(a)),t.getEntries(e,n).next(a=>{let i=Ta();return r.forEach((o,l)=>{const u=a.get(o);l.isFoundDocument()!==u.isFoundDocument()&&(s=s.add(o)),l.isNoDocument()&&l.version.isEqual($e.min())?(t.removeEntry(o,l.readTime),i=i.insert(o,l)):!u.isValidDocument()||l.version.compareTo(u.version)>0||l.version.compareTo(u.version)===0&&u.hasPendingWrites?(t.addEntry(l),i=i.insert(o,l)):Re("LocalStore","Ignoring outdated watch update for ",o,". Current version:",u.version," Watch version:",l.version)}),{Ps:i,Is:s}})}function pM(e,t){const r=ze(e);return r.persistence.runTransaction("Get next mutation batch","readonly",n=>(t===void 0&&(t=-1),r.mutationQueue.getNextMutationBatchAfterBatchId(n,t)))}function gM(e,t){const r=ze(e);return r.persistence.runTransaction("Allocate target","readwrite",n=>{let s;return r.Ur.getTargetData(n,t).next(a=>a?(s=a,_e.resolve(s)):r.Ur.allocateTargetId(n).next(i=>(s=new Xa(t,i,"TargetPurposeListen",n.currentSequenceNumber),r.Ur.addTargetData(n,s).next(()=>s))))}).then(n=>{const s=r.os.get(n.targetId);return(s===null||n.snapshotVersion.compareTo(s.snapshotVersion)>0)&&(r.os=r.os.insert(n.targetId,n),r._s.set(t,n.targetId)),n})}async function zp(e,t,r){const n=ze(e),s=n.os.get(t),a=r?"readwrite":"readwrite-primary";try{r||await n.persistence.runTransaction("Release target",a,i=>n.persistence.referenceDelegate.removeTarget(i,s))}catch(i){if(!Wu(i))throw i;Re("LocalStore",`Failed to update sequence numbers for target ${t}: ${i}`)}n.os=n.os.remove(t),n._s.delete(s.target)}function z_(e,t,r){const n=ze(e);let s=$e.min(),a=Je();return n.persistence.runTransaction("Execute query","readwrite",i=>function(l,u,f){const d=ze(l),m=d._s.get(f);return m!==void 0?_e.resolve(d.os.get(m)):d.Ur.getTargetData(u,f)}(n,i,Ls(t)).next(o=>{if(o)return s=o.lastLimboFreeSnapshotVersion,n.Ur.getMatchingKeysForTargetId(i,o.targetId).next(l=>{a=l})}).next(()=>n.ss.getDocumentsMatchingQuery(i,t,r?s:$e.min(),r?a:Je())).next(o=>(xM(n,lO(t),o),{documents:o,Ts:a})))}function xM(e,t,r){let n=e.us.get(t)||$e.min();r.forEach((s,a)=>{a.readTime.compareTo(n)>0&&(n=a.readTime)}),e.us.set(t,n)}class H_{constructor(){this.activeTargetIds=mO()}fs(t){this.activeTargetIds=this.activeTargetIds.add(t)}gs(t){this.activeTargetIds=this.activeTargetIds.delete(t)}Vs(){const t={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(t)}}class vM{constructor(){this.so=new H_,this.oo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(t){}updateMutationState(t,r,n){}addLocalQueryTarget(t,r=!0){return r&&this.so.fs(t),this.oo[t]||"not-current"}updateQueryState(t,r,n){this.oo[t]=r}removeLocalQueryTarget(t){this.so.gs(t)}isLocalQueryTarget(t){return this.so.activeTargetIds.has(t)}clearQueryState(t){delete this.oo[t]}getAllActiveQueryTargets(){return this.so.activeTargetIds}isActiveQueryTarget(t){return this.so.activeTargetIds.has(t)}start(){return this.so=new H_,Promise.resolve()}handleUserChange(t,r,n){}setOnlineState(t){}shutdown(){}writeSequenceNumber(t){}notifyBundleLoaded(t){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yM{_o(t){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class G_{constructor(){this.ao=()=>this.uo(),this.co=()=>this.lo(),this.ho=[],this.Po()}_o(t){this.ho.push(t)}shutdown(){window.removeEventListener("online",this.ao),window.removeEventListener("offline",this.co)}Po(){window.addEventListener("online",this.ao),window.addEventListener("offline",this.co)}uo(){Re("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const t of this.ho)t(0)}lo(){Re("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const t of this.ho)t(1)}static D(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Bf=null;function um(){return Bf===null?Bf=function(){return 268435456+Math.round(2147483648*Math.random())}():Bf++,"0x"+Bf.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _M={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wM{constructor(t){this.Io=t.Io,this.To=t.To}Eo(t){this.Ao=t}Ro(t){this.Vo=t}mo(t){this.fo=t}onMessage(t){this.po=t}close(){this.To()}send(t){this.Io(t)}yo(){this.Ao()}wo(){this.Vo()}So(t){this.fo(t)}bo(t){this.po(t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Mr="WebChannelConnection";class EM extends class{constructor(r){this.databaseInfo=r,this.databaseId=r.databaseId;const n=r.ssl?"https":"http",s=encodeURIComponent(this.databaseId.projectId),a=encodeURIComponent(this.databaseId.database);this.Do=n+"://"+r.host,this.vo=`projects/${s}/databases/${a}`,this.Co=this.databaseId.database==="(default)"?`project_id=${s}`:`project_id=${s}&database_id=${a}`}get Fo(){return!1}Mo(r,n,s,a,i){const o=um(),l=this.xo(r,n.toUriEncodedString());Re("RestConnection",`Sending RPC '${r}' ${o}:`,l,s);const u={"google-cloud-resource-prefix":this.vo,"x-goog-request-params":this.Co};return this.Oo(u,a,i),this.No(r,l,u,s).then(f=>(Re("RestConnection",`Received RPC '${r}' ${o}: `,f),f),f=>{throw vl("RestConnection",`RPC '${r}' ${o} failed with error: `,f,"url: ",l,"request:",s),f})}Lo(r,n,s,a,i,o){return this.Mo(r,n,s,a,i)}Oo(r,n,s){r["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+Pl}(),r["Content-Type"]="text/plain",this.databaseInfo.appId&&(r["X-Firebase-GMPID"]=this.databaseInfo.appId),n&&n.headers.forEach((a,i)=>r[i]=a),s&&s.headers.forEach((a,i)=>r[i]=a)}xo(r,n){const s=_M[r];return`${this.Do}/v1/${n}:${s}`}terminate(){}}{constructor(t){super(t),this.forceLongPolling=t.forceLongPolling,this.autoDetectLongPolling=t.autoDetectLongPolling,this.useFetchStreams=t.useFetchStreams,this.longPollingOptions=t.longPollingOptions}No(t,r,n,s){const a=um();return new Promise((i,o)=>{const l=new qk;l.setWithCredentials(!0),l.listenOnce(Xk.COMPLETE,()=>{try{switch(l.getLastErrorCode()){case gh.NO_ERROR:const f=l.getResponseJson();Re(Mr,`XHR for RPC '${t}' ${a} received:`,JSON.stringify(f)),i(f);break;case gh.TIMEOUT:Re(Mr,`RPC '${t}' ${a} timed out`),o(new Ce(xe.DEADLINE_EXCEEDED,"Request time out"));break;case gh.HTTP_ERROR:const d=l.getStatus();if(Re(Mr,`RPC '${t}' ${a} failed with status:`,d,"response text:",l.getResponseText()),d>0){let m=l.getResponseJson();Array.isArray(m)&&(m=m[0]);const p=m==null?void 0:m.error;if(p&&p.status&&p.message){const x=function(_){const k=_.toLowerCase().replace(/_/g,"-");return Object.values(xe).indexOf(k)>=0?k:xe.UNKNOWN}(p.status);o(new Ce(x,p.message))}else o(new Ce(xe.UNKNOWN,"Server responded with status "+l.getStatus()))}else o(new Ce(xe.UNAVAILABLE,"Connection failed."));break;default:Ue()}}finally{Re(Mr,`RPC '${t}' ${a} completed.`)}});const u=JSON.stringify(s);Re(Mr,`RPC '${t}' ${a} sending request:`,s),l.send(r,"POST",u,n,15)})}Bo(t,r,n){const s=um(),a=[this.Do,"/","google.firestore.v1.Firestore","/",t,"/channel"],i=Jk(),o=Qk(),l={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},u=this.longPollingOptions.timeoutSeconds;u!==void 0&&(l.longPollingTimeout=Math.round(1e3*u)),this.useFetchStreams&&(l.useFetchStreams=!0),this.Oo(l.initMessageHeaders,r,n),l.encodeInitMessageHeaders=!0;const f=a.join("");Re(Mr,`Creating RPC '${t}' stream ${s}: ${f}`,l);const d=i.createWebChannel(f,l);let m=!1,p=!1;const x=new wM({Io:_=>{p?Re(Mr,`Not sending because RPC '${t}' stream ${s} is closed:`,_):(m||(Re(Mr,`Opening RPC '${t}' stream ${s} transport.`),d.open(),m=!0),Re(Mr,`RPC '${t}' stream ${s} sending:`,_),d.send(_))},To:()=>d.close()}),g=(_,k,E)=>{_.listen(k,y=>{try{E(y)}catch(b){setTimeout(()=>{throw b},0)}})};return g(d,hc.EventType.OPEN,()=>{p||(Re(Mr,`RPC '${t}' stream ${s} transport opened.`),x.yo())}),g(d,hc.EventType.CLOSE,()=>{p||(p=!0,Re(Mr,`RPC '${t}' stream ${s} transport closed`),x.So())}),g(d,hc.EventType.ERROR,_=>{p||(p=!0,vl(Mr,`RPC '${t}' stream ${s} transport errored:`,_),x.So(new Ce(xe.UNAVAILABLE,"The operation could not be completed")))}),g(d,hc.EventType.MESSAGE,_=>{var k;if(!p){const E=_.data[0];vt(!!E);const y=E,b=y.error||((k=y[0])===null||k===void 0?void 0:k.error);if(b){Re(Mr,`RPC '${t}' stream ${s} received error:`,b);const O=b.status;let D=function(S){const N=er[S];if(N!==void 0)return SS(N)}(O),v=b.message;D===void 0&&(D=xe.INTERNAL,v="Unknown error status: "+O+" with message "+b.message),p=!0,x.So(new Ce(D,v)),d.close()}else Re(Mr,`RPC '${t}' stream ${s} received:`,E),x.bo(E)}}),g(o,Yk.STAT_EVENT,_=>{_.stat===Dp.PROXY?Re(Mr,`RPC '${t}' stream ${s} detected buffering proxy`):_.stat===Dp.NOPROXY&&Re(Mr,`RPC '${t}' stream ${s} detected no buffering proxy`)}),setTimeout(()=>{x.wo()},0),x}}function fm(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function a0(e){return new PO(e,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jS{constructor(t,r,n=1e3,s=1.5,a=6e4){this.ui=t,this.timerId=r,this.ko=n,this.qo=s,this.Qo=a,this.Ko=0,this.$o=null,this.Uo=Date.now(),this.reset()}reset(){this.Ko=0}Wo(){this.Ko=this.Qo}Go(t){this.cancel();const r=Math.floor(this.Ko+this.zo()),n=Math.max(0,Date.now()-this.Uo),s=Math.max(0,r-n);s>0&&Re("ExponentialBackoff",`Backing off for ${s} ms (base delay: ${this.Ko} ms, delay with jitter: ${r} ms, last attempt: ${n} ms ago)`),this.$o=this.ui.enqueueAfterDelay(this.timerId,s,()=>(this.Uo=Date.now(),t())),this.Ko*=this.qo,this.Ko<this.ko&&(this.Ko=this.ko),this.Ko>this.Qo&&(this.Ko=this.Qo)}jo(){this.$o!==null&&(this.$o.skipDelay(),this.$o=null)}cancel(){this.$o!==null&&(this.$o.cancel(),this.$o=null)}zo(){return(Math.random()-.5)*this.Ko}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class LS{constructor(t,r,n,s,a,i,o,l){this.ui=t,this.Ho=n,this.Jo=s,this.connection=a,this.authCredentialsProvider=i,this.appCheckCredentialsProvider=o,this.listener=l,this.state=0,this.Yo=0,this.Zo=null,this.Xo=null,this.stream=null,this.e_=0,this.t_=new jS(t,r)}n_(){return this.state===1||this.state===5||this.r_()}r_(){return this.state===2||this.state===3}start(){this.e_=0,this.state!==4?this.auth():this.i_()}async stop(){this.n_()&&await this.close(0)}s_(){this.state=0,this.t_.reset()}o_(){this.r_()&&this.Zo===null&&(this.Zo=this.ui.enqueueAfterDelay(this.Ho,6e4,()=>this.__()))}a_(t){this.u_(),this.stream.send(t)}async __(){if(this.r_())return this.close(0)}u_(){this.Zo&&(this.Zo.cancel(),this.Zo=null)}c_(){this.Xo&&(this.Xo.cancel(),this.Xo=null)}async close(t,r){this.u_(),this.c_(),this.t_.cancel(),this.Yo++,t!==4?this.t_.reset():r&&r.code===xe.RESOURCE_EXHAUSTED?(Ea(r.toString()),Ea("Using maximum backoff delay to prevent overloading the backend."),this.t_.Wo()):r&&r.code===xe.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.l_(),this.stream.close(),this.stream=null),this.state=t,await this.listener.mo(r)}l_(){}auth(){this.state=1;const t=this.h_(this.Yo),r=this.Yo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([n,s])=>{this.Yo===r&&this.P_(n,s)},n=>{t(()=>{const s=new Ce(xe.UNKNOWN,"Fetching auth token failed: "+n.message);return this.I_(s)})})}P_(t,r){const n=this.h_(this.Yo);this.stream=this.T_(t,r),this.stream.Eo(()=>{n(()=>this.listener.Eo())}),this.stream.Ro(()=>{n(()=>(this.state=2,this.Xo=this.ui.enqueueAfterDelay(this.Jo,1e4,()=>(this.r_()&&(this.state=3),Promise.resolve())),this.listener.Ro()))}),this.stream.mo(s=>{n(()=>this.I_(s))}),this.stream.onMessage(s=>{n(()=>++this.e_==1?this.E_(s):this.onNext(s))})}i_(){this.state=5,this.t_.Go(async()=>{this.state=0,this.start()})}I_(t){return Re("PersistentStream",`close with error: ${t}`),this.stream=null,this.close(4,t)}h_(t){return r=>{this.ui.enqueueAndForget(()=>this.Yo===t?r():(Re("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class TM extends LS{constructor(t,r,n,s,a,i){super(t,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",r,n,s,i),this.serializer=a}T_(t,r){return this.connection.Bo("Listen",t,r)}E_(t){return this.onNext(t)}onNext(t){this.t_.reset();const r=OO(this.serializer,t),n=function(a){if(!("targetChange"in a))return $e.min();const i=a.targetChange;return i.targetIds&&i.targetIds.length?$e.min():i.readTime?Us(i.readTime):$e.min()}(t);return this.listener.d_(r,n)}A_(t){const r={};r.database=Wp(this.serializer),r.addTarget=function(a,i){let o;const l=i.target;if(o=jp(l)?{documents:LO(a,l)}:{query:UO(a,l)._t},o.targetId=i.targetId,i.resumeToken.approximateByteSize()>0){o.resumeToken=IS(a,i.resumeToken);const u=Vp(a,i.expectedCount);u!==null&&(o.expectedCount=u)}else if(i.snapshotVersion.compareTo($e.min())>0){o.readTime=od(a,i.snapshotVersion.toTimestamp());const u=Vp(a,i.expectedCount);u!==null&&(o.expectedCount=u)}return o}(this.serializer,t);const n=BO(this.serializer,t);n&&(r.labels=n),this.a_(r)}R_(t){const r={};r.database=Wp(this.serializer),r.removeTarget=t,this.a_(r)}}class kM extends LS{constructor(t,r,n,s,a,i){super(t,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",r,n,s,i),this.serializer=a}get V_(){return this.e_>0}start(){this.lastStreamToken=void 0,super.start()}l_(){this.V_&&this.m_([])}T_(t,r){return this.connection.Bo("Write",t,r)}E_(t){return vt(!!t.streamToken),this.lastStreamToken=t.streamToken,vt(!t.writeResults||t.writeResults.length===0),this.listener.f_()}onNext(t){vt(!!t.streamToken),this.lastStreamToken=t.streamToken,this.t_.reset();const r=jO(t.writeResults,t.commitTime),n=Us(t.commitTime);return this.listener.g_(n,r)}p_(){const t={};t.database=Wp(this.serializer),this.a_(t)}m_(t){const r={streamToken:this.lastStreamToken,writes:t.map(n=>MO(this.serializer,n))};this.a_(r)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SM extends class{}{constructor(t,r,n,s){super(),this.authCredentials=t,this.appCheckCredentials=r,this.connection=n,this.serializer=s,this.y_=!1}w_(){if(this.y_)throw new Ce(xe.FAILED_PRECONDITION,"The client has already been terminated.")}Mo(t,r,n,s){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([a,i])=>this.connection.Mo(t,Bp(r,n),s,a,i)).catch(a=>{throw a.name==="FirebaseError"?(a.code===xe.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),a):new Ce(xe.UNKNOWN,a.toString())})}Lo(t,r,n,s,a){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([i,o])=>this.connection.Lo(t,Bp(r,n),s,i,o,a)).catch(i=>{throw i.name==="FirebaseError"?(i.code===xe.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),i):new Ce(xe.UNKNOWN,i.toString())})}terminate(){this.y_=!0,this.connection.terminate()}}class AM{constructor(t,r){this.asyncQueue=t,this.onlineStateHandler=r,this.state="Unknown",this.S_=0,this.b_=null,this.D_=!0}v_(){this.S_===0&&(this.C_("Unknown"),this.b_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.b_=null,this.F_("Backend didn't respond within 10 seconds."),this.C_("Offline"),Promise.resolve())))}M_(t){this.state==="Online"?this.C_("Unknown"):(this.S_++,this.S_>=1&&(this.x_(),this.F_(`Connection failed 1 times. Most recent error: ${t.toString()}`),this.C_("Offline")))}set(t){this.x_(),this.S_=0,t==="Online"&&(this.D_=!1),this.C_(t)}C_(t){t!==this.state&&(this.state=t,this.onlineStateHandler(t))}F_(t){const r=`Could not reach Cloud Firestore backend. ${t}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.D_?(Ea(r),this.D_=!1):Re("OnlineStateTracker",r)}x_(){this.b_!==null&&(this.b_.cancel(),this.b_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bM{constructor(t,r,n,s,a){this.localStore=t,this.datastore=r,this.asyncQueue=n,this.remoteSyncer={},this.O_=[],this.N_=new Map,this.L_=new Set,this.B_=[],this.k_=a,this.k_._o(i=>{n.enqueueAndForget(async()=>{ho(this)&&(Re("RemoteStore","Restarting streams for network reachability change."),await async function(l){const u=ze(l);u.L_.add(4),await Ku(u),u.q_.set("Unknown"),u.L_.delete(4),await i0(u)}(this))})}),this.q_=new AM(n,s)}}async function i0(e){if(ho(e))for(const t of e.B_)await t(!0)}async function Ku(e){for(const t of e.B_)await t(!1)}function US(e,t){const r=ze(e);r.N_.has(t.targetId)||(r.N_.set(t.targetId,t),$x(r)?Bx(r):Fl(r).r_()&&Vx(r,t))}function Ux(e,t){const r=ze(e),n=Fl(r);r.N_.delete(t),n.r_()&&VS(r,t),r.N_.size===0&&(n.r_()?n.o_():ho(r)&&r.q_.set("Unknown"))}function Vx(e,t){if(e.Q_.xe(t.targetId),t.resumeToken.approximateByteSize()>0||t.snapshotVersion.compareTo($e.min())>0){const r=e.remoteSyncer.getRemoteKeysForTarget(t.targetId).size;t=t.withExpectedCount(r)}Fl(e).A_(t)}function VS(e,t){e.Q_.xe(t),Fl(e).R_(t)}function Bx(e){e.Q_=new IO({getRemoteKeysForTarget:t=>e.remoteSyncer.getRemoteKeysForTarget(t),ot:t=>e.N_.get(t)||null,tt:()=>e.datastore.serializer.databaseId}),Fl(e).start(),e.q_.v_()}function $x(e){return ho(e)&&!Fl(e).n_()&&e.N_.size>0}function ho(e){return ze(e).L_.size===0}function BS(e){e.Q_=void 0}async function IM(e){e.q_.set("Online")}async function NM(e){e.N_.forEach((t,r)=>{Vx(e,t)})}async function CM(e,t){BS(e),$x(e)?(e.q_.M_(t),Bx(e)):e.q_.set("Unknown")}async function RM(e,t,r){if(e.q_.set("Online"),t instanceof bS&&t.state===2&&t.cause)try{await async function(s,a){const i=a.cause;for(const o of a.targetIds)s.N_.has(o)&&(await s.remoteSyncer.rejectListen(o,i),s.N_.delete(o),s.Q_.removeTarget(o))}(e,t)}catch(n){Re("RemoteStore","Failed to remove targets %s: %s ",t.targetIds.join(","),n),await ld(e,n)}else if(t instanceof yh?e.Q_.Ke(t):t instanceof AS?e.Q_.He(t):e.Q_.We(t),!r.isEqual($e.min()))try{const n=await MS(e.localStore);r.compareTo(n)>=0&&await function(a,i){const o=a.Q_.rt(i);return o.targetChanges.forEach((l,u)=>{if(l.resumeToken.approximateByteSize()>0){const f=a.N_.get(u);f&&a.N_.set(u,f.withResumeToken(l.resumeToken,i))}}),o.targetMismatches.forEach((l,u)=>{const f=a.N_.get(l);if(!f)return;a.N_.set(l,f.withResumeToken(Rr.EMPTY_BYTE_STRING,f.snapshotVersion)),VS(a,l);const d=new Xa(f.target,l,u,f.sequenceNumber);Vx(a,d)}),a.remoteSyncer.applyRemoteEvent(o)}(e,r)}catch(n){Re("RemoteStore","Failed to raise snapshot:",n),await ld(e,n)}}async function ld(e,t,r){if(!Wu(t))throw t;e.L_.add(1),await Ku(e),e.q_.set("Offline"),r||(r=()=>MS(e.localStore)),e.asyncQueue.enqueueRetryable(async()=>{Re("RemoteStore","Retrying IndexedDB access"),await r(),e.L_.delete(1),await i0(e)})}function $S(e,t){return t().catch(r=>ld(e,r,t))}async function o0(e){const t=ze(e),r=gi(t);let n=t.O_.length>0?t.O_[t.O_.length-1].batchId:-1;for(;PM(t);)try{const s=await pM(t.localStore,n);if(s===null){t.O_.length===0&&r.o_();break}n=s.batchId,DM(t,s)}catch(s){await ld(t,s)}WS(t)&&zS(t)}function PM(e){return ho(e)&&e.O_.length<10}function DM(e,t){e.O_.push(t);const r=gi(e);r.r_()&&r.V_&&r.m_(t.mutations)}function WS(e){return ho(e)&&!gi(e).n_()&&e.O_.length>0}function zS(e){gi(e).start()}async function FM(e){gi(e).p_()}async function OM(e){const t=gi(e);for(const r of e.O_)t.m_(r.mutations)}async function MM(e,t,r){const n=e.O_.shift(),s=Dx.from(n,t,r);await $S(e,()=>e.remoteSyncer.applySuccessfulWrite(s)),await o0(e)}async function jM(e,t){t&&gi(e).V_&&await async function(n,s){if(function(i){return SO(i)&&i!==xe.ABORTED}(s.code)){const a=n.O_.shift();gi(n).s_(),await $S(n,()=>n.remoteSyncer.rejectFailedWrite(a.batchId,s)),await o0(n)}}(e,t),WS(e)&&zS(e)}async function K_(e,t){const r=ze(e);r.asyncQueue.verifyOperationInProgress(),Re("RemoteStore","RemoteStore received new credentials");const n=ho(r);r.L_.add(3),await Ku(r),n&&r.q_.set("Unknown"),await r.remoteSyncer.handleCredentialChange(t),r.L_.delete(3),await i0(r)}async function LM(e,t){const r=ze(e);t?(r.L_.delete(2),await i0(r)):t||(r.L_.add(2),await Ku(r),r.q_.set("Unknown"))}function Fl(e){return e.K_||(e.K_=function(r,n,s){const a=ze(r);return a.w_(),new TM(n,a.connection,a.authCredentials,a.appCheckCredentials,a.serializer,s)}(e.datastore,e.asyncQueue,{Eo:IM.bind(null,e),Ro:NM.bind(null,e),mo:CM.bind(null,e),d_:RM.bind(null,e)}),e.B_.push(async t=>{t?(e.K_.s_(),$x(e)?Bx(e):e.q_.set("Unknown")):(await e.K_.stop(),BS(e))})),e.K_}function gi(e){return e.U_||(e.U_=function(r,n,s){const a=ze(r);return a.w_(),new kM(n,a.connection,a.authCredentials,a.appCheckCredentials,a.serializer,s)}(e.datastore,e.asyncQueue,{Eo:()=>Promise.resolve(),Ro:FM.bind(null,e),mo:jM.bind(null,e),f_:OM.bind(null,e),g_:MM.bind(null,e)}),e.B_.push(async t=>{t?(e.U_.s_(),await o0(e)):(await e.U_.stop(),e.O_.length>0&&(Re("RemoteStore",`Stopping write stream with ${e.O_.length} pending writes`),e.O_=[]))})),e.U_}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wx{constructor(t,r,n,s,a){this.asyncQueue=t,this.timerId=r,this.targetTimeMs=n,this.op=s,this.removalCallback=a,this.deferred=new fa,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(i=>{})}get promise(){return this.deferred.promise}static createAndSchedule(t,r,n,s,a){const i=Date.now()+n,o=new Wx(t,r,i,s,a);return o.start(n),o}start(t){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),t)}skipDelay(){return this.handleDelayElapsed()}cancel(t){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new Ce(xe.CANCELLED,"Operation cancelled"+(t?": "+t:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(t=>this.deferred.resolve(t))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function zx(e,t){if(Ea("AsyncQueue",`${t}: ${e}`),Wu(e))return new Ce(xe.UNAVAILABLE,`${t}: ${e}`);throw e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rl{constructor(t){this.comparator=t?(r,n)=>t(r,n)||Fe.comparator(r.key,n.key):(r,n)=>Fe.comparator(r.key,n.key),this.keyedMap=dc(),this.sortedSet=new Bt(this.comparator)}static emptySet(t){return new rl(t.comparator)}has(t){return this.keyedMap.get(t)!=null}get(t){return this.keyedMap.get(t)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(t){const r=this.keyedMap.get(t);return r?this.sortedSet.indexOf(r):-1}get size(){return this.sortedSet.size}forEach(t){this.sortedSet.inorderTraversal((r,n)=>(t(r),!1))}add(t){const r=this.delete(t.key);return r.copy(r.keyedMap.insert(t.key,t),r.sortedSet.insert(t,null))}delete(t){const r=this.get(t);return r?this.copy(this.keyedMap.remove(t),this.sortedSet.remove(r)):this}isEqual(t){if(!(t instanceof rl)||this.size!==t.size)return!1;const r=this.sortedSet.getIterator(),n=t.sortedSet.getIterator();for(;r.hasNext();){const s=r.getNext().key,a=n.getNext().key;if(!s.isEqual(a))return!1}return!0}toString(){const t=[];return this.forEach(r=>{t.push(r.toString())}),t.length===0?"DocumentSet ()":`DocumentSet (
  `+t.join(`  
`)+`
)`}copy(t,r){const n=new rl;return n.comparator=this.comparator,n.keyedMap=t,n.sortedSet=r,n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class q_{constructor(){this.W_=new Bt(Fe.comparator)}track(t){const r=t.doc.key,n=this.W_.get(r);n?t.type!==0&&n.type===3?this.W_=this.W_.insert(r,t):t.type===3&&n.type!==1?this.W_=this.W_.insert(r,{type:n.type,doc:t.doc}):t.type===2&&n.type===2?this.W_=this.W_.insert(r,{type:2,doc:t.doc}):t.type===2&&n.type===0?this.W_=this.W_.insert(r,{type:0,doc:t.doc}):t.type===1&&n.type===0?this.W_=this.W_.remove(r):t.type===1&&n.type===2?this.W_=this.W_.insert(r,{type:1,doc:n.doc}):t.type===0&&n.type===1?this.W_=this.W_.insert(r,{type:2,doc:t.doc}):Ue():this.W_=this.W_.insert(r,t)}G_(){const t=[];return this.W_.inorderTraversal((r,n)=>{t.push(n)}),t}}class Tl{constructor(t,r,n,s,a,i,o,l,u){this.query=t,this.docs=r,this.oldDocs=n,this.docChanges=s,this.mutatedKeys=a,this.fromCache=i,this.syncStateChanged=o,this.excludesMetadataChanges=l,this.hasCachedResults=u}static fromInitialDocuments(t,r,n,s,a){const i=[];return r.forEach(o=>{i.push({type:0,doc:o})}),new Tl(t,r,rl.emptySet(r),i,n,s,!0,!1,a)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(t){if(!(this.fromCache===t.fromCache&&this.hasCachedResults===t.hasCachedResults&&this.syncStateChanged===t.syncStateChanged&&this.mutatedKeys.isEqual(t.mutatedKeys)&&e0(this.query,t.query)&&this.docs.isEqual(t.docs)&&this.oldDocs.isEqual(t.oldDocs)))return!1;const r=this.docChanges,n=t.docChanges;if(r.length!==n.length)return!1;for(let s=0;s<r.length;s++)if(r[s].type!==n[s].type||!r[s].doc.isEqual(n[s].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class UM{constructor(){this.z_=void 0,this.j_=[]}H_(){return this.j_.some(t=>t.J_())}}class VM{constructor(){this.queries=X_(),this.onlineState="Unknown",this.Y_=new Set}terminate(){(function(r,n){const s=ze(r),a=s.queries;s.queries=X_(),a.forEach((i,o)=>{for(const l of o.j_)l.onError(n)})})(this,new Ce(xe.ABORTED,"Firestore shutting down"))}}function X_(){return new Dl(e=>fS(e),e0)}async function Hx(e,t){const r=ze(e);let n=3;const s=t.query;let a=r.queries.get(s);a?!a.H_()&&t.J_()&&(n=2):(a=new UM,n=t.J_()?0:1);try{switch(n){case 0:a.z_=await r.onListen(s,!0);break;case 1:a.z_=await r.onListen(s,!1);break;case 2:await r.onFirstRemoteStoreListen(s)}}catch(i){const o=zx(i,`Initialization of query '${Co(t.query)}' failed`);return void t.onError(o)}r.queries.set(s,a),a.j_.push(t),t.Z_(r.onlineState),a.z_&&t.X_(a.z_)&&Kx(r)}async function Gx(e,t){const r=ze(e),n=t.query;let s=3;const a=r.queries.get(n);if(a){const i=a.j_.indexOf(t);i>=0&&(a.j_.splice(i,1),a.j_.length===0?s=t.J_()?0:1:!a.H_()&&t.J_()&&(s=2))}switch(s){case 0:return r.queries.delete(n),r.onUnlisten(n,!0);case 1:return r.queries.delete(n),r.onUnlisten(n,!1);case 2:return r.onLastRemoteStoreUnlisten(n);default:return}}function BM(e,t){const r=ze(e);let n=!1;for(const s of t){const a=s.query,i=r.queries.get(a);if(i){for(const o of i.j_)o.X_(s)&&(n=!0);i.z_=s}}n&&Kx(r)}function $M(e,t,r){const n=ze(e),s=n.queries.get(t);if(s)for(const a of s.j_)a.onError(r);n.queries.delete(t)}function Kx(e){e.Y_.forEach(t=>{t.next()})}var Hp,Y_;(Y_=Hp||(Hp={})).ea="default",Y_.Cache="cache";class qx{constructor(t,r,n){this.query=t,this.ta=r,this.na=!1,this.ra=null,this.onlineState="Unknown",this.options=n||{}}X_(t){if(!this.options.includeMetadataChanges){const n=[];for(const s of t.docChanges)s.type!==3&&n.push(s);t=new Tl(t.query,t.docs,t.oldDocs,n,t.mutatedKeys,t.fromCache,t.syncStateChanged,!0,t.hasCachedResults)}let r=!1;return this.na?this.ia(t)&&(this.ta.next(t),r=!0):this.sa(t,this.onlineState)&&(this.oa(t),r=!0),this.ra=t,r}onError(t){this.ta.error(t)}Z_(t){this.onlineState=t;let r=!1;return this.ra&&!this.na&&this.sa(this.ra,t)&&(this.oa(this.ra),r=!0),r}sa(t,r){if(!t.fromCache||!this.J_())return!0;const n=r!=="Offline";return(!this.options._a||!n)&&(!t.docs.isEmpty()||t.hasCachedResults||r==="Offline")}ia(t){if(t.docChanges.length>0)return!0;const r=this.ra&&this.ra.hasPendingWrites!==t.hasPendingWrites;return!(!t.syncStateChanged&&!r)&&this.options.includeMetadataChanges===!0}oa(t){t=Tl.fromInitialDocuments(t.query,t.docs,t.mutatedKeys,t.fromCache,t.hasCachedResults),this.na=!0,this.ta.next(t)}J_(){return this.options.source!==Hp.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HS{constructor(t){this.key=t}}class GS{constructor(t){this.key=t}}class WM{constructor(t,r){this.query=t,this.Ta=r,this.Ea=null,this.hasCachedResults=!1,this.current=!1,this.da=Je(),this.mutatedKeys=Je(),this.Aa=hS(t),this.Ra=new rl(this.Aa)}get Va(){return this.Ta}ma(t,r){const n=r?r.fa:new q_,s=r?r.Ra:this.Ra;let a=r?r.mutatedKeys:this.mutatedKeys,i=s,o=!1;const l=this.query.limitType==="F"&&s.size===this.query.limit?s.last():null,u=this.query.limitType==="L"&&s.size===this.query.limit?s.first():null;if(t.inorderTraversal((f,d)=>{const m=s.get(f),p=t0(this.query,d)?d:null,x=!!m&&this.mutatedKeys.has(m.key),g=!!p&&(p.hasLocalMutations||this.mutatedKeys.has(p.key)&&p.hasCommittedMutations);let _=!1;m&&p?m.data.isEqual(p.data)?x!==g&&(n.track({type:3,doc:p}),_=!0):this.ga(m,p)||(n.track({type:2,doc:p}),_=!0,(l&&this.Aa(p,l)>0||u&&this.Aa(p,u)<0)&&(o=!0)):!m&&p?(n.track({type:0,doc:p}),_=!0):m&&!p&&(n.track({type:1,doc:m}),_=!0,(l||u)&&(o=!0)),_&&(p?(i=i.add(p),a=g?a.add(f):a.delete(f)):(i=i.delete(f),a=a.delete(f)))}),this.query.limit!==null)for(;i.size>this.query.limit;){const f=this.query.limitType==="F"?i.last():i.first();i=i.delete(f.key),a=a.delete(f.key),n.track({type:1,doc:f})}return{Ra:i,fa:n,ns:o,mutatedKeys:a}}ga(t,r){return t.hasLocalMutations&&r.hasCommittedMutations&&!r.hasLocalMutations}applyChanges(t,r,n,s){const a=this.Ra;this.Ra=t.Ra,this.mutatedKeys=t.mutatedKeys;const i=t.fa.G_();i.sort((f,d)=>function(p,x){const g=_=>{switch(_){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Ue()}};return g(p)-g(x)}(f.type,d.type)||this.Aa(f.doc,d.doc)),this.pa(n),s=s!=null&&s;const o=r&&!s?this.ya():[],l=this.da.size===0&&this.current&&!s?1:0,u=l!==this.Ea;return this.Ea=l,i.length!==0||u?{snapshot:new Tl(this.query,t.Ra,a,i,t.mutatedKeys,l===0,u,!1,!!n&&n.resumeToken.approximateByteSize()>0),wa:o}:{wa:o}}Z_(t){return this.current&&t==="Offline"?(this.current=!1,this.applyChanges({Ra:this.Ra,fa:new q_,mutatedKeys:this.mutatedKeys,ns:!1},!1)):{wa:[]}}Sa(t){return!this.Ta.has(t)&&!!this.Ra.has(t)&&!this.Ra.get(t).hasLocalMutations}pa(t){t&&(t.addedDocuments.forEach(r=>this.Ta=this.Ta.add(r)),t.modifiedDocuments.forEach(r=>{}),t.removedDocuments.forEach(r=>this.Ta=this.Ta.delete(r)),this.current=t.current)}ya(){if(!this.current)return[];const t=this.da;this.da=Je(),this.Ra.forEach(n=>{this.Sa(n.key)&&(this.da=this.da.add(n.key))});const r=[];return t.forEach(n=>{this.da.has(n)||r.push(new GS(n))}),this.da.forEach(n=>{t.has(n)||r.push(new HS(n))}),r}ba(t){this.Ta=t.Ts,this.da=Je();const r=this.ma(t.documents);return this.applyChanges(r,!0)}Da(){return Tl.fromInitialDocuments(this.query,this.Ra,this.mutatedKeys,this.Ea===0,this.hasCachedResults)}}class zM{constructor(t,r,n){this.query=t,this.targetId=r,this.view=n}}class HM{constructor(t){this.key=t,this.va=!1}}class GM{constructor(t,r,n,s,a,i){this.localStore=t,this.remoteStore=r,this.eventManager=n,this.sharedClientState=s,this.currentUser=a,this.maxConcurrentLimboResolutions=i,this.Ca={},this.Fa=new Dl(o=>fS(o),e0),this.Ma=new Map,this.xa=new Set,this.Oa=new Bt(Fe.comparator),this.Na=new Map,this.La=new Mx,this.Ba={},this.ka=new Map,this.qa=El.kn(),this.onlineState="Unknown",this.Qa=void 0}get isPrimaryClient(){return this.Qa===!0}}async function KM(e,t,r=!0){const n=JS(e);let s;const a=n.Fa.get(t);return a?(n.sharedClientState.addLocalQueryTarget(a.targetId),s=a.view.Da()):s=await KS(n,t,r,!0),s}async function qM(e,t){const r=JS(e);await KS(r,t,!0,!1)}async function KS(e,t,r,n){const s=await gM(e.localStore,Ls(t)),a=s.targetId,i=e.sharedClientState.addLocalQueryTarget(a,r);let o;return n&&(o=await XM(e,t,a,i==="current",s.resumeToken)),e.isPrimaryClient&&r&&US(e.remoteStore,s),o}async function XM(e,t,r,n,s){e.Ka=(d,m,p)=>async function(g,_,k,E){let y=_.view.ma(k);y.ns&&(y=await z_(g.localStore,_.query,!1).then(({documents:v})=>_.view.ma(v,y)));const b=E&&E.targetChanges.get(_.targetId),O=E&&E.targetMismatches.get(_.targetId)!=null,D=_.view.applyChanges(y,g.isPrimaryClient,b,O);return J_(g,_.targetId,D.wa),D.snapshot}(e,d,m,p);const a=await z_(e.localStore,t,!0),i=new WM(t,a.Ts),o=i.ma(a.documents),l=Gu.createSynthesizedTargetChangeForCurrentChange(r,n&&e.onlineState!=="Offline",s),u=i.applyChanges(o,e.isPrimaryClient,l);J_(e,r,u.wa);const f=new zM(t,r,i);return e.Fa.set(t,f),e.Ma.has(r)?e.Ma.get(r).push(t):e.Ma.set(r,[t]),u.snapshot}async function YM(e,t,r){const n=ze(e),s=n.Fa.get(t),a=n.Ma.get(s.targetId);if(a.length>1)return n.Ma.set(s.targetId,a.filter(i=>!e0(i,t))),void n.Fa.delete(t);n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(s.targetId),n.sharedClientState.isActiveQueryTarget(s.targetId)||await zp(n.localStore,s.targetId,!1).then(()=>{n.sharedClientState.clearQueryState(s.targetId),r&&Ux(n.remoteStore,s.targetId),Gp(n,s.targetId)}).catch($u)):(Gp(n,s.targetId),await zp(n.localStore,s.targetId,!0))}async function QM(e,t){const r=ze(e),n=r.Fa.get(t),s=r.Ma.get(n.targetId);r.isPrimaryClient&&s.length===1&&(r.sharedClientState.removeLocalQueryTarget(n.targetId),Ux(r.remoteStore,n.targetId))}async function JM(e,t,r){const n=aj(e);try{const s=await function(i,o){const l=ze(i),u=fr.now(),f=o.reduce((p,x)=>p.add(x.key),Je());let d,m;return l.persistence.runTransaction("Locally write mutations","readwrite",p=>{let x=Ta(),g=Je();return l.cs.getEntries(p,f).next(_=>{x=_,x.forEach((k,E)=>{E.isValidDocument()||(g=g.add(k))})}).next(()=>l.localDocuments.getOverlayedDocuments(p,x)).next(_=>{d=_;const k=[];for(const E of o){const y=_O(E,d.get(E.key).overlayedDocument);y!=null&&k.push(new Ti(E.key,y,nS(y.value.mapValue),Yn.exists(!0)))}return l.mutationQueue.addMutationBatch(p,u,k,o)}).next(_=>{m=_;const k=_.applyToLocalDocumentSet(d,g);return l.documentOverlayCache.saveOverlays(p,_.batchId,k)})}).then(()=>({batchId:m.batchId,changes:mS(d)}))}(n.localStore,t);n.sharedClientState.addPendingMutation(s.batchId),function(i,o,l){let u=i.Ba[i.currentUser.toKey()];u||(u=new Bt(ut)),u=u.insert(o,l),i.Ba[i.currentUser.toKey()]=u}(n,s.batchId,r),await qu(n,s.changes),await o0(n.remoteStore)}catch(s){const a=zx(s,"Failed to persist write");r.reject(a)}}async function qS(e,t){const r=ze(e);try{const n=await dM(r.localStore,t);t.targetChanges.forEach((s,a)=>{const i=r.Na.get(a);i&&(vt(s.addedDocuments.size+s.modifiedDocuments.size+s.removedDocuments.size<=1),s.addedDocuments.size>0?i.va=!0:s.modifiedDocuments.size>0?vt(i.va):s.removedDocuments.size>0&&(vt(i.va),i.va=!1))}),await qu(r,n,t)}catch(n){await $u(n)}}function Q_(e,t,r){const n=ze(e);if(n.isPrimaryClient&&r===0||!n.isPrimaryClient&&r===1){const s=[];n.Fa.forEach((a,i)=>{const o=i.view.Z_(t);o.snapshot&&s.push(o.snapshot)}),function(i,o){const l=ze(i);l.onlineState=o;let u=!1;l.queries.forEach((f,d)=>{for(const m of d.j_)m.Z_(o)&&(u=!0)}),u&&Kx(l)}(n.eventManager,t),s.length&&n.Ca.d_(s),n.onlineState=t,n.isPrimaryClient&&n.sharedClientState.setOnlineState(t)}}async function ZM(e,t,r){const n=ze(e);n.sharedClientState.updateQueryState(t,"rejected",r);const s=n.Na.get(t),a=s&&s.key;if(a){let i=new Bt(Fe.comparator);i=i.insert(a,Br.newNoDocument(a,$e.min()));const o=Je().add(a),l=new s0($e.min(),new Map,new Bt(ut),i,o);await qS(n,l),n.Oa=n.Oa.remove(a),n.Na.delete(t),Xx(n)}else await zp(n.localStore,t,!1).then(()=>Gp(n,t,r)).catch($u)}async function ej(e,t){const r=ze(e),n=t.batch.batchId;try{const s=await hM(r.localStore,t);YS(r,n,null),XS(r,n),r.sharedClientState.updateMutationState(n,"acknowledged"),await qu(r,s)}catch(s){await $u(s)}}async function tj(e,t,r){const n=ze(e);try{const s=await function(i,o){const l=ze(i);return l.persistence.runTransaction("Reject batch","readwrite-primary",u=>{let f;return l.mutationQueue.lookupMutationBatch(u,o).next(d=>(vt(d!==null),f=d.keys(),l.mutationQueue.removeMutationBatch(u,d))).next(()=>l.mutationQueue.performConsistencyCheck(u)).next(()=>l.documentOverlayCache.removeOverlaysForBatchId(u,f,o)).next(()=>l.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(u,f)).next(()=>l.localDocuments.getDocuments(u,f))})}(n.localStore,t);YS(n,t,r),XS(n,t),n.sharedClientState.updateMutationState(t,"rejected",r),await qu(n,s)}catch(s){await $u(s)}}function XS(e,t){(e.ka.get(t)||[]).forEach(r=>{r.resolve()}),e.ka.delete(t)}function YS(e,t,r){const n=ze(e);let s=n.Ba[n.currentUser.toKey()];if(s){const a=s.get(t);a&&(r?a.reject(r):a.resolve(),s=s.remove(t)),n.Ba[n.currentUser.toKey()]=s}}function Gp(e,t,r=null){e.sharedClientState.removeLocalQueryTarget(t);for(const n of e.Ma.get(t))e.Fa.delete(n),r&&e.Ca.$a(n,r);e.Ma.delete(t),e.isPrimaryClient&&e.La.gr(t).forEach(n=>{e.La.containsKey(n)||QS(e,n)})}function QS(e,t){e.xa.delete(t.path.canonicalString());const r=e.Oa.get(t);r!==null&&(Ux(e.remoteStore,r),e.Oa=e.Oa.remove(t),e.Na.delete(r),Xx(e))}function J_(e,t,r){for(const n of r)n instanceof HS?(e.La.addReference(n.key,t),rj(e,n)):n instanceof GS?(Re("SyncEngine","Document no longer in limbo: "+n.key),e.La.removeReference(n.key,t),e.La.containsKey(n.key)||QS(e,n.key)):Ue()}function rj(e,t){const r=t.key,n=r.path.canonicalString();e.Oa.get(r)||e.xa.has(n)||(Re("SyncEngine","New document in limbo: "+r),e.xa.add(n),Xx(e))}function Xx(e){for(;e.xa.size>0&&e.Oa.size<e.maxConcurrentLimboResolutions;){const t=e.xa.values().next().value;e.xa.delete(t);const r=new Fe(Ct.fromString(t)),n=e.qa.next();e.Na.set(n,new HM(r)),e.Oa=e.Oa.insert(r,n),US(e.remoteStore,new Xa(Ls(Zd(r.path)),n,"TargetPurposeLimboResolution",Sx.oe))}}async function qu(e,t,r){const n=ze(e),s=[],a=[],i=[];n.Fa.isEmpty()||(n.Fa.forEach((o,l)=>{i.push(n.Ka(l,t,r).then(u=>{var f;if((u||r)&&n.isPrimaryClient){const d=u?!u.fromCache:(f=r==null?void 0:r.targetChanges.get(l.targetId))===null||f===void 0?void 0:f.current;n.sharedClientState.updateQueryState(l.targetId,d?"current":"not-current")}if(u){s.push(u);const d=Lx.Wi(l.targetId,u);a.push(d)}}))}),await Promise.all(i),n.Ca.d_(s),await async function(l,u){const f=ze(l);try{await f.persistence.runTransaction("notifyLocalViewChanges","readwrite",d=>_e.forEach(u,m=>_e.forEach(m.$i,p=>f.persistence.referenceDelegate.addReference(d,m.targetId,p)).next(()=>_e.forEach(m.Ui,p=>f.persistence.referenceDelegate.removeReference(d,m.targetId,p)))))}catch(d){if(!Wu(d))throw d;Re("LocalStore","Failed to update sequence numbers: "+d)}for(const d of u){const m=d.targetId;if(!d.fromCache){const p=f.os.get(m),x=p.snapshotVersion,g=p.withLastLimboFreeSnapshotVersion(x);f.os=f.os.insert(m,g)}}}(n.localStore,a))}async function nj(e,t){const r=ze(e);if(!r.currentUser.isEqual(t)){Re("SyncEngine","User change. New user:",t.toKey());const n=await OS(r.localStore,t);r.currentUser=t,function(a,i){a.ka.forEach(o=>{o.forEach(l=>{l.reject(new Ce(xe.CANCELLED,i))})}),a.ka.clear()}(r,"'waitForPendingWrites' promise is rejected due to a user change."),r.sharedClientState.handleUserChange(t,n.removedBatchIds,n.addedBatchIds),await qu(r,n.hs)}}function sj(e,t){const r=ze(e),n=r.Na.get(t);if(n&&n.va)return Je().add(n.key);{let s=Je();const a=r.Ma.get(t);if(!a)return s;for(const i of a){const o=r.Fa.get(i);s=s.unionWith(o.view.Va)}return s}}function JS(e){const t=ze(e);return t.remoteStore.remoteSyncer.applyRemoteEvent=qS.bind(null,t),t.remoteStore.remoteSyncer.getRemoteKeysForTarget=sj.bind(null,t),t.remoteStore.remoteSyncer.rejectListen=ZM.bind(null,t),t.Ca.d_=BM.bind(null,t.eventManager),t.Ca.$a=$M.bind(null,t.eventManager),t}function aj(e){const t=ze(e);return t.remoteStore.remoteSyncer.applySuccessfulWrite=ej.bind(null,t),t.remoteStore.remoteSyncer.rejectFailedWrite=tj.bind(null,t),t}class cd{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(t){this.serializer=a0(t.databaseInfo.databaseId),this.sharedClientState=this.Wa(t),this.persistence=this.Ga(t),await this.persistence.start(),this.localStore=this.za(t),this.gcScheduler=this.ja(t,this.localStore),this.indexBackfillerScheduler=this.Ha(t,this.localStore)}ja(t,r){return null}Ha(t,r){return null}za(t){return fM(this.persistence,new cM,t.initialUser,this.serializer)}Ga(t){return new iM(jx.Zr,this.serializer)}Wa(t){return new vM}async terminate(){var t,r;(t=this.gcScheduler)===null||t===void 0||t.stop(),(r=this.indexBackfillerScheduler)===null||r===void 0||r.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}cd.provider={build:()=>new cd};class Kp{async initialize(t,r){this.localStore||(this.localStore=t.localStore,this.sharedClientState=t.sharedClientState,this.datastore=this.createDatastore(r),this.remoteStore=this.createRemoteStore(r),this.eventManager=this.createEventManager(r),this.syncEngine=this.createSyncEngine(r,!t.synchronizeTabs),this.sharedClientState.onlineStateHandler=n=>Q_(this.syncEngine,n,1),this.remoteStore.remoteSyncer.handleCredentialChange=nj.bind(null,this.syncEngine),await LM(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(t){return function(){return new VM}()}createDatastore(t){const r=a0(t.databaseInfo.databaseId),n=function(a){return new EM(a)}(t.databaseInfo);return function(a,i,o,l){return new SM(a,i,o,l)}(t.authCredentials,t.appCheckCredentials,n,r)}createRemoteStore(t){return function(n,s,a,i,o){return new bM(n,s,a,i,o)}(this.localStore,this.datastore,t.asyncQueue,r=>Q_(this.syncEngine,r,0),function(){return G_.D()?new G_:new yM}())}createSyncEngine(t,r){return function(s,a,i,o,l,u,f){const d=new GM(s,a,i,o,l,u);return f&&(d.Qa=!0),d}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,t.initialUser,t.maxConcurrentLimboResolutions,r)}async terminate(){var t,r;await async function(s){const a=ze(s);Re("RemoteStore","RemoteStore shutting down."),a.L_.add(5),await Ku(a),a.k_.shutdown(),a.q_.set("Unknown")}(this.remoteStore),(t=this.datastore)===null||t===void 0||t.terminate(),(r=this.eventManager)===null||r===void 0||r.terminate()}}Kp.provider={build:()=>new Kp};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yx{constructor(t){this.observer=t,this.muted=!1}next(t){this.muted||this.observer.next&&this.Ya(this.observer.next,t)}error(t){this.muted||(this.observer.error?this.Ya(this.observer.error,t):Ea("Uncaught Error in snapshot listener:",t.toString()))}Za(){this.muted=!0}Ya(t,r){setTimeout(()=>{this.muted||t(r)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ij{constructor(t,r,n,s,a){this.authCredentials=t,this.appCheckCredentials=r,this.asyncQueue=n,this.databaseInfo=s,this.user=Lr.UNAUTHENTICATED,this.clientId=eS.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=a,this.authCredentials.start(n,async i=>{Re("FirestoreClient","Received user=",i.uid),await this.authCredentialListener(i),this.user=i}),this.appCheckCredentials.start(n,i=>(Re("FirestoreClient","Received new app check token=",i),this.appCheckCredentialListener(i,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(t){this.authCredentialListener=t}setAppCheckTokenChangeListener(t){this.appCheckCredentialListener=t}terminate(){this.asyncQueue.enterRestrictedMode();const t=new fa;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),t.resolve()}catch(r){const n=zx(r,"Failed to shutdown persistence");t.reject(n)}}),t.promise}}async function hm(e,t){e.asyncQueue.verifyOperationInProgress(),Re("FirestoreClient","Initializing OfflineComponentProvider");const r=e.configuration;await t.initialize(r);let n=r.initialUser;e.setCredentialChangeListener(async s=>{n.isEqual(s)||(await OS(t.localStore,s),n=s)}),t.persistence.setDatabaseDeletedListener(()=>e.terminate()),e._offlineComponents=t}async function Z_(e,t){e.asyncQueue.verifyOperationInProgress();const r=await oj(e);Re("FirestoreClient","Initializing OnlineComponentProvider"),await t.initialize(r,e.configuration),e.setCredentialChangeListener(n=>K_(t.remoteStore,n)),e.setAppCheckTokenChangeListener((n,s)=>K_(t.remoteStore,s)),e._onlineComponents=t}async function oj(e){if(!e._offlineComponents)if(e._uninitializedComponentsProvider){Re("FirestoreClient","Using user provided OfflineComponentProvider");try{await hm(e,e._uninitializedComponentsProvider._offline)}catch(t){const r=t;if(!function(s){return s.name==="FirebaseError"?s.code===xe.FAILED_PRECONDITION||s.code===xe.UNIMPLEMENTED:!(typeof DOMException<"u"&&s instanceof DOMException)||s.code===22||s.code===20||s.code===11}(r))throw r;vl("Error using user provided cache. Falling back to memory cache: "+r),await hm(e,new cd)}}else Re("FirestoreClient","Using default OfflineComponentProvider"),await hm(e,new cd);return e._offlineComponents}async function ZS(e){return e._onlineComponents||(e._uninitializedComponentsProvider?(Re("FirestoreClient","Using user provided OnlineComponentProvider"),await Z_(e,e._uninitializedComponentsProvider._online)):(Re("FirestoreClient","Using default OnlineComponentProvider"),await Z_(e,new Kp))),e._onlineComponents}function lj(e){return ZS(e).then(t=>t.syncEngine)}async function ud(e){const t=await ZS(e),r=t.eventManager;return r.onListen=KM.bind(null,t.syncEngine),r.onUnlisten=YM.bind(null,t.syncEngine),r.onFirstRemoteStoreListen=qM.bind(null,t.syncEngine),r.onLastRemoteStoreUnlisten=QM.bind(null,t.syncEngine),r}function cj(e,t,r={}){const n=new fa;return e.asyncQueue.enqueueAndForget(async()=>function(a,i,o,l,u){const f=new Yx({next:m=>{f.Za(),i.enqueueAndForget(()=>Gx(a,d));const p=m.docs.has(o);!p&&m.fromCache?u.reject(new Ce(xe.UNAVAILABLE,"Failed to get document because the client is offline.")):p&&m.fromCache&&l&&l.source==="server"?u.reject(new Ce(xe.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):u.resolve(m)},error:m=>u.reject(m)}),d=new qx(Zd(o.path),f,{includeMetadataChanges:!0,_a:!0});return Hx(a,d)}(await ud(e),e.asyncQueue,t,r,n)),n.promise}function uj(e,t,r={}){const n=new fa;return e.asyncQueue.enqueueAndForget(async()=>function(a,i,o,l,u){const f=new Yx({next:m=>{f.Za(),i.enqueueAndForget(()=>Gx(a,d)),m.fromCache&&l.source==="server"?u.reject(new Ce(xe.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):u.resolve(m)},error:m=>u.reject(m)}),d=new qx(o,f,{includeMetadataChanges:!0,_a:!0});return Hx(a,d)}(await ud(e),e.asyncQueue,t,r,n)),n.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function eA(e){const t={};return e.timeoutSeconds!==void 0&&(t.timeoutSeconds=e.timeoutSeconds),t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ew=new Map;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tA(e,t,r){if(!r)throw new Ce(xe.INVALID_ARGUMENT,`Function ${e}() cannot be called with an empty ${t}.`)}function fj(e,t,r,n){if(t===!0&&n===!0)throw new Ce(xe.INVALID_ARGUMENT,`${e} and ${r} cannot be used together.`)}function tw(e){if(!Fe.isDocumentKey(e))throw new Ce(xe.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${e} has ${e.length}.`)}function rw(e){if(Fe.isDocumentKey(e))throw new Ce(xe.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${e} has ${e.length}.`)}function l0(e){if(e===void 0)return"undefined";if(e===null)return"null";if(typeof e=="string")return e.length>20&&(e=`${e.substring(0,20)}...`),JSON.stringify(e);if(typeof e=="number"||typeof e=="boolean")return""+e;if(typeof e=="object"){if(e instanceof Array)return"an array";{const t=function(n){return n.constructor?n.constructor.name:null}(e);return t?`a custom ${t} object`:"an object"}}return typeof e=="function"?"a function":Ue()}function wn(e,t){if("_delegate"in e&&(e=e._delegate),!(e instanceof t)){if(t.name===e.constructor.name)throw new Ce(xe.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const r=l0(e);throw new Ce(xe.INVALID_ARGUMENT,`Expected type '${t.name}', but it was: ${r}`)}}return e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nw{constructor(t){var r,n;if(t.host===void 0){if(t.ssl!==void 0)throw new Ce(xe.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=t.host,this.ssl=(r=t.ssl)===null||r===void 0||r;if(this.credentials=t.credentials,this.ignoreUndefinedProperties=!!t.ignoreUndefinedProperties,this.localCache=t.localCache,t.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(t.cacheSizeBytes!==-1&&t.cacheSizeBytes<1048576)throw new Ce(xe.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=t.cacheSizeBytes}fj("experimentalForceLongPolling",t.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",t.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!t.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:t.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!t.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=eA((n=t.experimentalLongPollingOptions)!==null&&n!==void 0?n:{}),function(a){if(a.timeoutSeconds!==void 0){if(isNaN(a.timeoutSeconds))throw new Ce(xe.INVALID_ARGUMENT,`invalid long polling timeout: ${a.timeoutSeconds} (must not be NaN)`);if(a.timeoutSeconds<5)throw new Ce(xe.INVALID_ARGUMENT,`invalid long polling timeout: ${a.timeoutSeconds} (minimum allowed value is 5)`);if(a.timeoutSeconds>30)throw new Ce(xe.INVALID_ARGUMENT,`invalid long polling timeout: ${a.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!t.useFetchStreams}isEqual(t){return this.host===t.host&&this.ssl===t.ssl&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.experimentalForceLongPolling===t.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===t.experimentalAutoDetectLongPolling&&function(n,s){return n.timeoutSeconds===s.timeoutSeconds}(this.experimentalLongPollingOptions,t.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties&&this.useFetchStreams===t.useFetchStreams}}class c0{constructor(t,r,n,s){this._authCredentials=t,this._appCheckCredentials=r,this._databaseId=n,this._app=s,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new nw({}),this._settingsFrozen=!1,this._terminateTask="notTerminated"}get app(){if(!this._app)throw new Ce(xe.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(t){if(this._settingsFrozen)throw new Ce(xe.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new nw(t),t.credentials!==void 0&&(this._authCredentials=function(n){if(!n)return new C3;switch(n.type){case"firstParty":return new F3(n.sessionIndex||"0",n.iamToken||null,n.authTokenFactory||null);case"provider":return n.client;default:throw new Ce(xe.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(t.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(r){const n=ew.get(r);n&&(Re("ComponentProvider","Removing Datastore"),ew.delete(r),n.terminate())}(this),Promise.resolve()}}function hj(e,t,r,n={}){var s;const a=(e=wn(e,c0))._getSettings(),i=`${t}:${r}`;if(a.host!=="firestore.googleapis.com"&&a.host!==i&&vl("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),e._setSettings(Object.assign(Object.assign({},a),{host:i,ssl:!1})),n.mockUserToken){let o,l;if(typeof n.mockUserToken=="string")o=n.mockUserToken,l=Lr.MOCK_USER;else{o=ok(n.mockUserToken,(s=e._app)===null||s===void 0?void 0:s.options.projectId);const u=n.mockUserToken.sub||n.mockUserToken.user_id;if(!u)throw new Ce(xe.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");l=new Lr(u)}e._authCredentials=new R3(new Zk(o,l))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mo{constructor(t,r,n){this.converter=r,this._query=n,this.type="query",this.firestore=t}withConverter(t){return new mo(this.firestore,t,this._query)}}class zr{constructor(t,r,n){this.converter=r,this._key=n,this.type="document",this.firestore=t}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new li(this.firestore,this.converter,this._key.path.popLast())}withConverter(t){return new zr(this.firestore,t,this._key)}}class li extends mo{constructor(t,r,n){super(t,r,Zd(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const t=this._path.popLast();return t.isEmpty()?null:new zr(this.firestore,null,new Fe(t))}withConverter(t){return new li(this.firestore,t,this._path)}}function Tt(e,t,...r){if(e=Pt(e),tA("collection","path",t),e instanceof c0){const n=Ct.fromString(t,...r);return rw(n),new li(e,null,n)}{if(!(e instanceof zr||e instanceof li))throw new Ce(xe.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=e._path.child(Ct.fromString(t,...r));return rw(n),new li(e.firestore,null,n)}}function dt(e,t,...r){if(e=Pt(e),arguments.length===1&&(t=eS.newId()),tA("doc","path",t),e instanceof c0){const n=Ct.fromString(t,...r);return tw(n),new zr(e,null,new Fe(n))}{if(!(e instanceof zr||e instanceof li))throw new Ce(xe.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=e._path.child(Ct.fromString(t,...r));return tw(n),new zr(e.firestore,e instanceof li?e.converter:null,new Fe(n))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sw{constructor(t=Promise.resolve()){this.Pu=[],this.Iu=!1,this.Tu=[],this.Eu=null,this.du=!1,this.Au=!1,this.Ru=[],this.t_=new jS(this,"async_queue_retry"),this.Vu=()=>{const n=fm();n&&Re("AsyncQueue","Visibility state changed to "+n.visibilityState),this.t_.jo()},this.mu=t;const r=fm();r&&typeof r.addEventListener=="function"&&r.addEventListener("visibilitychange",this.Vu)}get isShuttingDown(){return this.Iu}enqueueAndForget(t){this.enqueue(t)}enqueueAndForgetEvenWhileRestricted(t){this.fu(),this.gu(t)}enterRestrictedMode(t){if(!this.Iu){this.Iu=!0,this.Au=t||!1;const r=fm();r&&typeof r.removeEventListener=="function"&&r.removeEventListener("visibilitychange",this.Vu)}}enqueue(t){if(this.fu(),this.Iu)return new Promise(()=>{});const r=new fa;return this.gu(()=>this.Iu&&this.Au?Promise.resolve():(t().then(r.resolve,r.reject),r.promise)).then(()=>r.promise)}enqueueRetryable(t){this.enqueueAndForget(()=>(this.Pu.push(t),this.pu()))}async pu(){if(this.Pu.length!==0){try{await this.Pu[0](),this.Pu.shift(),this.t_.reset()}catch(t){if(!Wu(t))throw t;Re("AsyncQueue","Operation failed with retryable error: "+t)}this.Pu.length>0&&this.t_.Go(()=>this.pu())}}gu(t){const r=this.mu.then(()=>(this.du=!0,t().catch(n=>{this.Eu=n,this.du=!1;const s=function(i){let o=i.message||"";return i.stack&&(o=i.stack.includes(i.message)?i.stack:i.message+`
`+i.stack),o}(n);throw Ea("INTERNAL UNHANDLED ERROR: ",s),n}).then(n=>(this.du=!1,n))));return this.mu=r,r}enqueueAfterDelay(t,r,n){this.fu(),this.Ru.indexOf(t)>-1&&(r=0);const s=Wx.createAndSchedule(this,t,r,n,a=>this.yu(a));return this.Tu.push(s),s}fu(){this.Eu&&Ue()}verifyOperationInProgress(){}async wu(){let t;do t=this.mu,await t;while(t!==this.mu)}Su(t){for(const r of this.Tu)if(r.timerId===t)return!0;return!1}bu(t){return this.wu().then(()=>{this.Tu.sort((r,n)=>r.targetTimeMs-n.targetTimeMs);for(const r of this.Tu)if(r.skipDelay(),t!=="all"&&r.timerId===t)break;return this.wu()})}Du(t){this.Ru.push(t)}yu(t){const r=this.Tu.indexOf(t);this.Tu.splice(r,1)}}function aw(e){return function(r,n){if(typeof r!="object"||r===null)return!1;const s=r;for(const a of n)if(a in s&&typeof s[a]=="function")return!0;return!1}(e,["next","error","complete"])}class ka extends c0{constructor(t,r,n,s){super(t,r,n,s),this.type="firestore",this._queue=new sw,this._persistenceKey=(s==null?void 0:s.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const t=this._firestoreClient.terminate();this._queue=new sw(t),this._firestoreClient=void 0,await t}}}function dj(e,t){const r=typeof e=="object"?e:qd(),n=typeof e=="string"?e:"(default)",s=Lu(r,"firestore").getImmediate({identifier:n});if(!s._initialized){const a=ux("firestore");a&&hj(s,...a)}return s}function u0(e){if(e._terminated)throw new Ce(xe.FAILED_PRECONDITION,"The client has already been terminated.");return e._firestoreClient||mj(e),e._firestoreClient}function mj(e){var t,r,n;const s=e._freezeSettings(),a=function(o,l,u,f){return new K3(o,l,u,f.host,f.ssl,f.experimentalForceLongPolling,f.experimentalAutoDetectLongPolling,eA(f.experimentalLongPollingOptions),f.useFetchStreams)}(e._databaseId,((t=e._app)===null||t===void 0?void 0:t.options.appId)||"",e._persistenceKey,s);e._componentsProvider||!((r=s.localCache)===null||r===void 0)&&r._offlineComponentProvider&&(!((n=s.localCache)===null||n===void 0)&&n._onlineComponentProvider)&&(e._componentsProvider={_offline:s.localCache._offlineComponentProvider,_online:s.localCache._onlineComponentProvider}),e._firestoreClient=new ij(e._authCredentials,e._appCheckCredentials,e._queue,a,e._componentsProvider&&function(o){const l=o==null?void 0:o._online.build();return{_offline:o==null?void 0:o._offline.build(l),_online:l}}(e._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kl{constructor(t){this._byteString=t}static fromBase64String(t){try{return new kl(Rr.fromBase64String(t))}catch(r){throw new Ce(xe.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+r)}}static fromUint8Array(t){return new kl(Rr.fromUint8Array(t))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(t){return this._byteString.isEqual(t._byteString)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class f0{constructor(...t){for(let r=0;r<t.length;++r)if(t[r].length===0)throw new Ce(xe.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Sr(t)}isEqual(t){return this._internalPath.isEqual(t._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xu{constructor(t){this._methodName=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qx{constructor(t,r){if(!isFinite(t)||t<-90||t>90)throw new Ce(xe.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(r)||r<-180||r>180)throw new Ce(xe.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+r);this._lat=t,this._long=r}get latitude(){return this._lat}get longitude(){return this._long}isEqual(t){return this._lat===t._lat&&this._long===t._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(t){return ut(this._lat,t._lat)||ut(this._long,t._long)}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jx{constructor(t){this._values=(t||[]).map(r=>r)}toArray(){return this._values.map(t=>t)}isEqual(t){return function(n,s){if(n.length!==s.length)return!1;for(let a=0;a<n.length;++a)if(n[a]!==s[a])return!1;return!0}(this._values,t._values)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pj=/^__.*__$/;class gj{constructor(t,r,n){this.data=t,this.fieldMask=r,this.fieldTransforms=n}toMutation(t,r){return this.fieldMask!==null?new Ti(t,this.data,this.fieldMask,r,this.fieldTransforms):new Hu(t,this.data,r,this.fieldTransforms)}}class rA{constructor(t,r,n){this.data=t,this.fieldMask=r,this.fieldTransforms=n}toMutation(t,r){return new Ti(t,this.data,this.fieldMask,r,this.fieldTransforms)}}function nA(e){switch(e){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Ue()}}class Zx{constructor(t,r,n,s,a,i){this.settings=t,this.databaseId=r,this.serializer=n,this.ignoreUndefinedProperties=s,a===void 0&&this.vu(),this.fieldTransforms=a||[],this.fieldMask=i||[]}get path(){return this.settings.path}get Cu(){return this.settings.Cu}Fu(t){return new Zx(Object.assign(Object.assign({},this.settings),t),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Mu(t){var r;const n=(r=this.path)===null||r===void 0?void 0:r.child(t),s=this.Fu({path:n,xu:!1});return s.Ou(t),s}Nu(t){var r;const n=(r=this.path)===null||r===void 0?void 0:r.child(t),s=this.Fu({path:n,xu:!1});return s.vu(),s}Lu(t){return this.Fu({path:void 0,xu:!0})}Bu(t){return fd(t,this.settings.methodName,this.settings.ku||!1,this.path,this.settings.qu)}contains(t){return this.fieldMask.find(r=>t.isPrefixOf(r))!==void 0||this.fieldTransforms.find(r=>t.isPrefixOf(r.field))!==void 0}vu(){if(this.path)for(let t=0;t<this.path.length;t++)this.Ou(this.path.get(t))}Ou(t){if(t.length===0)throw this.Bu("Document fields must not be empty");if(nA(this.Cu)&&pj.test(t))throw this.Bu('Document fields cannot begin and end with "__"')}}class xj{constructor(t,r,n){this.databaseId=t,this.ignoreUndefinedProperties=r,this.serializer=n||a0(t)}Qu(t,r,n,s=!1){return new Zx({Cu:t,methodName:r,qu:n,path:Sr.emptyPath(),xu:!1,ku:s},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function h0(e){const t=e._freezeSettings(),r=a0(e._databaseId);return new xj(e._databaseId,!!t.ignoreUndefinedProperties,r)}function sA(e,t,r,n,s,a={}){const i=e.Qu(a.merge||a.mergeFields?2:0,t,r,s);rv("Data must be an object, but it was:",i,n);const o=aA(n,i);let l,u;if(a.merge)l=new Cn(i.fieldMask),u=i.fieldTransforms;else if(a.mergeFields){const f=[];for(const d of a.mergeFields){const m=qp(t,d,r);if(!i.contains(m))throw new Ce(xe.INVALID_ARGUMENT,`Field '${m}' is specified in your field mask but missing from your input data.`);oA(f,m)||f.push(m)}l=new Cn(f),u=i.fieldTransforms.filter(d=>l.covers(d.field))}else l=null,u=i.fieldTransforms;return new gj(new pn(o),l,u)}class d0 extends Xu{_toFieldTransform(t){if(t.Cu!==2)throw t.Cu===1?t.Bu(`${this._methodName}() can only appear at the top level of your update data`):t.Bu(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return t.fieldMask.push(t.path),null}isEqual(t){return t instanceof d0}}class ev extends Xu{_toFieldTransform(t){return new ES(t.path,new gu)}isEqual(t){return t instanceof ev}}class tv extends Xu{constructor(t,r){super(t),this.$u=r}_toFieldTransform(t){const r=new yu(t.serializer,xS(t.serializer,this.$u));return new ES(t.path,r)}isEqual(t){return t instanceof tv&&this.$u===t.$u}}function vj(e,t,r,n){const s=e.Qu(1,t,r);rv("Data must be an object, but it was:",s,n);const a=[],i=pn.empty();fo(n,(l,u)=>{const f=nv(t,l,r);u=Pt(u);const d=s.Nu(f);if(u instanceof d0)a.push(f);else{const m=Yu(u,d);m!=null&&(a.push(f),i.set(f,m))}});const o=new Cn(a);return new rA(i,o,s.fieldTransforms)}function yj(e,t,r,n,s,a){const i=e.Qu(1,t,r),o=[qp(t,n,r)],l=[s];if(a.length%2!=0)throw new Ce(xe.INVALID_ARGUMENT,`Function ${t}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let m=0;m<a.length;m+=2)o.push(qp(t,a[m])),l.push(a[m+1]);const u=[],f=pn.empty();for(let m=o.length-1;m>=0;--m)if(!oA(u,o[m])){const p=o[m];let x=l[m];x=Pt(x);const g=i.Nu(p);if(x instanceof d0)u.push(p);else{const _=Yu(x,g);_!=null&&(u.push(p),f.set(p,_))}}const d=new Cn(u);return new rA(f,d,i.fieldTransforms)}function _j(e,t,r,n=!1){return Yu(r,e.Qu(n?4:3,t))}function Yu(e,t){if(iA(e=Pt(e)))return rv("Unsupported field value:",t,e),aA(e,t);if(e instanceof Xu)return function(n,s){if(!nA(s.Cu))throw s.Bu(`${n._methodName}() can only be used with update() and set()`);if(!s.path)throw s.Bu(`${n._methodName}() is not currently supported inside arrays`);const a=n._toFieldTransform(s);a&&s.fieldTransforms.push(a)}(e,t),null;if(e===void 0&&t.ignoreUndefinedProperties)return null;if(t.path&&t.fieldMask.push(t.path),e instanceof Array){if(t.settings.xu&&t.Cu!==4)throw t.Bu("Nested arrays are not supported");return function(n,s){const a=[];let i=0;for(const o of n){let l=Yu(o,s.Lu(i));l==null&&(l={nullValue:"NULL_VALUE"}),a.push(l),i++}return{arrayValue:{values:a}}}(e,t)}return function(n,s){if((n=Pt(n))===null)return{nullValue:"NULL_VALUE"};if(typeof n=="number")return xS(s.serializer,n);if(typeof n=="boolean")return{booleanValue:n};if(typeof n=="string")return{stringValue:n};if(n instanceof Date){const a=fr.fromDate(n);return{timestampValue:od(s.serializer,a)}}if(n instanceof fr){const a=new fr(n.seconds,1e3*Math.floor(n.nanoseconds/1e3));return{timestampValue:od(s.serializer,a)}}if(n instanceof Qx)return{geoPointValue:{latitude:n.latitude,longitude:n.longitude}};if(n instanceof kl)return{bytesValue:IS(s.serializer,n._byteString)};if(n instanceof zr){const a=s.databaseId,i=n.firestore._databaseId;if(!i.isEqual(a))throw s.Bu(`Document reference is for database ${i.projectId}/${i.database} but should be for database ${a.projectId}/${a.database}`);return{referenceValue:Ox(n.firestore._databaseId||s.databaseId,n._key.path)}}if(n instanceof Jx)return function(i,o){return{mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{values:i.toArray().map(l=>{if(typeof l!="number")throw o.Bu("VectorValues must only contain numeric values.");return Rx(o.serializer,l)})}}}}}}(n,s);throw s.Bu(`Unsupported field value: ${l0(n)}`)}(e,t)}function aA(e,t){const r={};return tS(e)?t.path&&t.path.length>0&&t.fieldMask.push(t.path):fo(e,(n,s)=>{const a=Yu(s,t.Mu(n));a!=null&&(r[n]=a)}),{mapValue:{fields:r}}}function iA(e){return!(typeof e!="object"||e===null||e instanceof Array||e instanceof Date||e instanceof fr||e instanceof Qx||e instanceof kl||e instanceof zr||e instanceof Xu||e instanceof Jx)}function rv(e,t,r){if(!iA(r)||!function(s){return typeof s=="object"&&s!==null&&(Object.getPrototypeOf(s)===Object.prototype||Object.getPrototypeOf(s)===null)}(r)){const n=l0(r);throw n==="an object"?t.Bu(e+" a custom object"):t.Bu(e+" "+n)}}function qp(e,t,r){if((t=Pt(t))instanceof f0)return t._internalPath;if(typeof t=="string")return nv(e,t);throw fd("Field path arguments must be of type string or ",e,!1,void 0,r)}const wj=new RegExp("[~\\*/\\[\\]]");function nv(e,t,r){if(t.search(wj)>=0)throw fd(`Invalid field path (${t}). Paths must not contain '~', '*', '/', '[', or ']'`,e,!1,void 0,r);try{return new f0(...t.split("."))._internalPath}catch{throw fd(`Invalid field path (${t}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,e,!1,void 0,r)}}function fd(e,t,r,n,s){const a=n&&!n.isEmpty(),i=s!==void 0;let o=`Function ${t}() called with invalid data`;r&&(o+=" (via `toFirestore()`)"),o+=". ";let l="";return(a||i)&&(l+=" (found",a&&(l+=` in field ${n}`),i&&(l+=` in document ${s}`),l+=")"),new Ce(xe.INVALID_ARGUMENT,o+e+l)}function oA(e,t){return e.some(r=>r.isEqual(t))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lA{constructor(t,r,n,s,a){this._firestore=t,this._userDataWriter=r,this._key=n,this._document=s,this._converter=a}get id(){return this._key.path.lastSegment()}get ref(){return new zr(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const t=new Ej(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(t)}return this._userDataWriter.convertValue(this._document.data.value)}}get(t){if(this._document){const r=this._document.data.field(sv("DocumentSnapshot.get",t));if(r!==null)return this._userDataWriter.convertValue(r)}}}class Ej extends lA{data(){return super.data()}}function sv(e,t){return typeof t=="string"?nv(e,t):t instanceof f0?t._internalPath:t._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cA(e){if(e.limitType==="L"&&e.explicitOrderBy.length===0)throw new Ce(xe.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class av{}class Tj extends av{}function Dn(e,t,...r){let n=[];t instanceof av&&n.push(t),n=n.concat(r),function(a){const i=a.filter(l=>l instanceof iv).length,o=a.filter(l=>l instanceof m0).length;if(i>1||i>0&&o>0)throw new Ce(xe.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(n);for(const s of n)e=s._apply(e);return e}class m0 extends Tj{constructor(t,r,n){super(),this._field=t,this._op=r,this._value=n,this.type="where"}static _create(t,r,n){return new m0(t,r,n)}_apply(t){const r=this._parse(t);return uA(t._query,r),new mo(t.firestore,t.converter,Lp(t._query,r))}_parse(t){const r=h0(t.firestore);return function(a,i,o,l,u,f,d){let m;if(u.isKeyField()){if(f==="array-contains"||f==="array-contains-any")throw new Ce(xe.INVALID_ARGUMENT,`Invalid Query. You can't perform '${f}' queries on documentId().`);if(f==="in"||f==="not-in"){ow(d,f);const p=[];for(const x of d)p.push(iw(l,a,x));m={arrayValue:{values:p}}}else m=iw(l,a,d)}else f!=="in"&&f!=="not-in"&&f!=="array-contains-any"||ow(d,f),m=_j(o,i,d,f==="in"||f==="not-in");return ar.create(u,f,m)}(t._query,"where",r,t.firestore._databaseId,this._field,this._op,this._value)}}function rn(e,t,r){const n=t,s=sv("where",e);return m0._create(s,n,r)}class iv extends av{constructor(t,r){super(),this.type=t,this._queryConstraints=r}static _create(t,r){return new iv(t,r)}_parse(t){const r=this._queryConstraints.map(n=>n._parse(t)).filter(n=>n.getFilters().length>0);return r.length===1?r[0]:Es.create(r,this._getOperator())}_apply(t){const r=this._parse(t);return r.getFilters().length===0?t:(function(s,a){let i=s;const o=a.getFlattenedFilters();for(const l of o)uA(i,l),i=Lp(i,l)}(t._query,r),new mo(t.firestore,t.converter,Lp(t._query,r)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}function iw(e,t,r){if(typeof(r=Pt(r))=="string"){if(r==="")throw new Ce(xe.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!uS(t)&&r.indexOf("/")!==-1)throw new Ce(xe.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${r}' contains a '/' character.`);const n=t.path.child(Ct.fromString(r));if(!Fe.isDocumentKey(n))throw new Ce(xe.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${n}' is not because it has an odd number of segments (${n.length}).`);return b_(e,new Fe(n))}if(r instanceof zr)return b_(e,r._key);throw new Ce(xe.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${l0(r)}.`)}function ow(e,t){if(!Array.isArray(e)||e.length===0)throw new Ce(xe.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${t.toString()}' filters.`)}function uA(e,t){const r=function(s,a){for(const i of s)for(const o of i.getFlattenedFilters())if(a.indexOf(o.op)>=0)return o.op;return null}(e.filters,function(s){switch(s){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(t.op));if(r!==null)throw r===t.op?new Ce(xe.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${t.op.toString()}' filter.`):new Ce(xe.INVALID_ARGUMENT,`Invalid query. You cannot use '${t.op.toString()}' filters with '${r.toString()}' filters.`)}class kj{convertValue(t,r="none"){switch(no(t)){case 0:return null;case 1:return t.booleanValue;case 2:return Xt(t.integerValue||t.doubleValue);case 3:return this.convertTimestamp(t.timestampValue);case 4:return this.convertServerTimestamp(t,r);case 5:return t.stringValue;case 6:return this.convertBytes(ro(t.bytesValue));case 7:return this.convertReference(t.referenceValue);case 8:return this.convertGeoPoint(t.geoPointValue);case 9:return this.convertArray(t.arrayValue,r);case 11:return this.convertObject(t.mapValue,r);case 10:return this.convertVectorValue(t.mapValue);default:throw Ue()}}convertObject(t,r){return this.convertObjectMap(t.fields,r)}convertObjectMap(t,r="none"){const n={};return fo(t,(s,a)=>{n[s]=this.convertValue(a,r)}),n}convertVectorValue(t){var r,n,s;const a=(s=(n=(r=t.fields)===null||r===void 0?void 0:r.value.arrayValue)===null||n===void 0?void 0:n.values)===null||s===void 0?void 0:s.map(i=>Xt(i.doubleValue));return new Jx(a)}convertGeoPoint(t){return new Qx(Xt(t.latitude),Xt(t.longitude))}convertArray(t,r){return(t.values||[]).map(n=>this.convertValue(n,r))}convertServerTimestamp(t,r){switch(r){case"previous":const n=bx(t);return n==null?null:this.convertValue(n,r);case"estimate":return this.convertTimestamp(du(t));default:return null}}convertTimestamp(t){const r=pi(t);return new fr(r.seconds,r.nanos)}convertDocumentKey(t,r){const n=Ct.fromString(t);vt(FS(n));const s=new mu(n.get(1),n.get(3)),a=new Fe(n.popFirst(5));return s.isEqual(r)||Ea(`Document ${a} contains a document reference within a different database (${s.projectId}/${s.database}) which is not supported. It will be treated as a reference in the current database (${r.projectId}/${r.database}) instead.`),a}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fA(e,t,r){let n;return n=e?r&&(r.merge||r.mergeFields)?e.toFirestore(t,r):e.toFirestore(t):t,n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pc{constructor(t,r){this.hasPendingWrites=t,this.fromCache=r}isEqual(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache}}class hA extends lA{constructor(t,r,n,s,a,i){super(t,r,n,s,i),this._firestore=t,this._firestoreImpl=t,this.metadata=a}exists(){return super.exists()}data(t={}){if(this._document){if(this._converter){const r=new _h(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(r,t)}return this._userDataWriter.convertValue(this._document.data.value,t.serverTimestamps)}}get(t,r={}){if(this._document){const n=this._document.data.field(sv("DocumentSnapshot.get",t));if(n!==null)return this._userDataWriter.convertValue(n,r.serverTimestamps)}}}class _h extends hA{data(t={}){return super.data(t)}}class dA{constructor(t,r,n,s){this._firestore=t,this._userDataWriter=r,this._snapshot=s,this.metadata=new pc(s.hasPendingWrites,s.fromCache),this.query=n}get docs(){const t=[];return this.forEach(r=>t.push(r)),t}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(t,r){this._snapshot.docs.forEach(n=>{t.call(r,new _h(this._firestore,this._userDataWriter,n.key,n,new pc(this._snapshot.mutatedKeys.has(n.key),this._snapshot.fromCache),this.query.converter))})}docChanges(t={}){const r=!!t.includeMetadataChanges;if(r&&this._snapshot.excludesMetadataChanges)throw new Ce(xe.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===r||(this._cachedChanges=function(s,a){if(s._snapshot.oldDocs.isEmpty()){let i=0;return s._snapshot.docChanges.map(o=>{const l=new _h(s._firestore,s._userDataWriter,o.doc.key,o.doc,new pc(s._snapshot.mutatedKeys.has(o.doc.key),s._snapshot.fromCache),s.query.converter);return o.doc,{type:"added",doc:l,oldIndex:-1,newIndex:i++}})}{let i=s._snapshot.oldDocs;return s._snapshot.docChanges.filter(o=>a||o.type!==3).map(o=>{const l=new _h(s._firestore,s._userDataWriter,o.doc.key,o.doc,new pc(s._snapshot.mutatedKeys.has(o.doc.key),s._snapshot.fromCache),s.query.converter);let u=-1,f=-1;return o.type!==0&&(u=i.indexOf(o.doc.key),i=i.delete(o.doc.key)),o.type!==1&&(i=i.add(o.doc),f=i.indexOf(o.doc.key)),{type:Sj(o.type),doc:l,oldIndex:u,newIndex:f}})}}(this,r),this._cachedChangesIncludeMetadataChanges=r),this._cachedChanges}}function Sj(e){switch(e){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Ue()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function En(e){e=wn(e,zr);const t=wn(e.firestore,ka);return cj(u0(t),e._key).then(r=>mA(t,e,r))}class ov extends kj{constructor(t){super(),this.firestore=t}convertBytes(t){return new kl(t)}convertReference(t){const r=this.convertDocumentKey(t,this.firestore._databaseId);return new zr(this.firestore,null,r)}}function Mt(e){e=wn(e,mo);const t=wn(e.firestore,ka),r=u0(t),n=new ov(t);return cA(e._query),uj(r,e._query).then(s=>new dA(t,n,e,s))}function Zn(e,t,r){e=wn(e,zr);const n=wn(e.firestore,ka),s=fA(e.converter,t,r);return p0(n,[sA(h0(n),"setDoc",e._key,s,e.converter!==null,r).toMutation(e._key,Yn.none())])}function Fn(e,t,r,...n){e=wn(e,zr);const s=wn(e.firestore,ka),a=h0(s);let i;return i=typeof(t=Pt(t))=="string"||t instanceof f0?yj(a,"updateDoc",e._key,t,r,n):vj(a,"updateDoc",e._key,t),p0(s,[i.toMutation(e._key,Yn.exists(!0))])}function Aj(e){return p0(wn(e.firestore,ka),[new Px(e._key,Yn.none())])}function Qu(e,t){const r=wn(e.firestore,ka),n=dt(e),s=fA(e.converter,t);return p0(r,[sA(h0(e.firestore),"addDoc",n._key,s,e.converter!==null,{}).toMutation(n._key,Yn.exists(!1))]).then(()=>n)}function bj(e,...t){var r,n,s;e=Pt(e);let a={includeMetadataChanges:!1,source:"default"},i=0;typeof t[i]!="object"||aw(t[i])||(a=t[i],i++);const o={includeMetadataChanges:a.includeMetadataChanges,source:a.source};if(aw(t[i])){const d=t[i];t[i]=(r=d.next)===null||r===void 0?void 0:r.bind(d),t[i+1]=(n=d.error)===null||n===void 0?void 0:n.bind(d),t[i+2]=(s=d.complete)===null||s===void 0?void 0:s.bind(d)}let l,u,f;if(e instanceof zr)u=wn(e.firestore,ka),f=Zd(e._key.path),l={next:d=>{t[i]&&t[i](mA(u,e,d))},error:t[i+1],complete:t[i+2]};else{const d=wn(e,mo);u=wn(d.firestore,ka),f=d._query;const m=new ov(u);l={next:p=>{t[i]&&t[i](new dA(u,m,d,p))},error:t[i+1],complete:t[i+2]},cA(e._query)}return function(m,p,x,g){const _=new Yx(g),k=new qx(p,_,x);return m.asyncQueue.enqueueAndForget(async()=>Hx(await ud(m),k)),()=>{_.Za(),m.asyncQueue.enqueueAndForget(async()=>Gx(await ud(m),k))}}(u0(u),f,o,l)}function p0(e,t){return function(n,s){const a=new fa;return n.asyncQueue.enqueueAndForget(async()=>JM(await lj(n),s,a)),a.promise}(u0(e),t)}function mA(e,t,r){const n=r.docs.get(t._key),s=new ov(e);return new hA(e,s,t._key,n,new pc(r.hasPendingWrites,r.fromCache),t.converter)}function Ij(){return new ev("serverTimestamp")}function Nj(e){return new tv("increment",e)}(function(t,r=!0){(function(s){Pl=s})(uo),di(new ya("firestore",(n,{instanceIdentifier:s,options:a})=>{const i=n.getProvider("app").getImmediate(),o=new ka(new P3(n.getProvider("auth-internal")),new M3(n.getProvider("app-check-internal")),function(u,f){if(!Object.prototype.hasOwnProperty.apply(u.options,["projectId"]))throw new Ce(xe.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new mu(u.options.projectId,f)}(i,s),i);return a=Object.assign({useFetchStreams:r},a),o._setSettings(a),o},"PUBLIC").setMultipleInstances(!0)),Xn(E_,"4.7.3",t),Xn(E_,"4.7.3","esm2017")})();var Cj="firebase",Rj="10.14.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Xn(Cj,Rj,"app");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pA="firebasestorage.googleapis.com",gA="storageBucket",Pj=2*60*1e3,Dj=10*60*1e3;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kt extends ks{constructor(t,r,n=0){super(dm(t),`Firebase Storage: ${r} (${dm(t)})`),this.status_=n,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,Kt.prototype)}get status(){return this.status_}set status(t){this.status_=t}_codeEquals(t){return dm(t)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(t){this.customData.serverResponse=t,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}var Ht;(function(e){e.UNKNOWN="unknown",e.OBJECT_NOT_FOUND="object-not-found",e.BUCKET_NOT_FOUND="bucket-not-found",e.PROJECT_NOT_FOUND="project-not-found",e.QUOTA_EXCEEDED="quota-exceeded",e.UNAUTHENTICATED="unauthenticated",e.UNAUTHORIZED="unauthorized",e.UNAUTHORIZED_APP="unauthorized-app",e.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",e.INVALID_CHECKSUM="invalid-checksum",e.CANCELED="canceled",e.INVALID_EVENT_NAME="invalid-event-name",e.INVALID_URL="invalid-url",e.INVALID_DEFAULT_BUCKET="invalid-default-bucket",e.NO_DEFAULT_BUCKET="no-default-bucket",e.CANNOT_SLICE_BLOB="cannot-slice-blob",e.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",e.NO_DOWNLOAD_URL="no-download-url",e.INVALID_ARGUMENT="invalid-argument",e.INVALID_ARGUMENT_COUNT="invalid-argument-count",e.APP_DELETED="app-deleted",e.INVALID_ROOT_OPERATION="invalid-root-operation",e.INVALID_FORMAT="invalid-format",e.INTERNAL_ERROR="internal-error",e.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})(Ht||(Ht={}));function dm(e){return"storage/"+e}function lv(){const e="An unknown error occurred, please check the error payload for server response.";return new Kt(Ht.UNKNOWN,e)}function Fj(e){return new Kt(Ht.OBJECT_NOT_FOUND,"Object '"+e+"' does not exist.")}function Oj(e){return new Kt(Ht.QUOTA_EXCEEDED,"Quota for bucket '"+e+"' exceeded, please view quota on https://firebase.google.com/pricing/.")}function Mj(){const e="User is not authenticated, please authenticate using Firebase Authentication and try again.";return new Kt(Ht.UNAUTHENTICATED,e)}function jj(){return new Kt(Ht.UNAUTHORIZED_APP,"This app does not have permission to access Firebase Storage on this project.")}function Lj(e){return new Kt(Ht.UNAUTHORIZED,"User does not have permission to access '"+e+"'.")}function Uj(){return new Kt(Ht.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function Vj(){return new Kt(Ht.CANCELED,"User canceled the upload/download.")}function Bj(e){return new Kt(Ht.INVALID_URL,"Invalid URL '"+e+"'.")}function $j(e){return new Kt(Ht.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+e+"'.")}function Wj(){return new Kt(Ht.NO_DEFAULT_BUCKET,"No default bucket found. Did you set the '"+gA+"' property when initializing the app?")}function zj(){return new Kt(Ht.CANNOT_SLICE_BLOB,"Cannot slice blob for upload. Please retry the upload.")}function Hj(){return new Kt(Ht.NO_DOWNLOAD_URL,"The given file does not have any download URLs.")}function Gj(e){return new Kt(Ht.UNSUPPORTED_ENVIRONMENT,`${e} is missing. Make sure to install the required polyfills. See https://firebase.google.com/docs/web/environments-js-sdk#polyfills for more information.`)}function Xp(e){return new Kt(Ht.INVALID_ARGUMENT,e)}function xA(){return new Kt(Ht.APP_DELETED,"The Firebase app was deleted.")}function Kj(e){return new Kt(Ht.INVALID_ROOT_OPERATION,"The operation '"+e+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}function Fc(e,t){return new Kt(Ht.INVALID_FORMAT,"String does not match format '"+e+"': "+t)}function ic(e){throw new Kt(Ht.INTERNAL_ERROR,"Internal error: "+e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rn{constructor(t,r){this.bucket=t,this.path_=r}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const t=encodeURIComponent;return"/b/"+t(this.bucket)+"/o/"+t(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(t,r){let n;try{n=Rn.makeFromUrl(t,r)}catch{return new Rn(t,"")}if(n.path==="")return n;throw $j(t)}static makeFromUrl(t,r){let n=null;const s="([A-Za-z0-9.\\-_]+)";function a(b){b.path.charAt(b.path.length-1)==="/"&&(b.path_=b.path_.slice(0,-1))}const i="(/(.*))?$",o=new RegExp("^gs://"+s+i,"i"),l={bucket:1,path:3};function u(b){b.path_=decodeURIComponent(b.path)}const f="v[A-Za-z0-9_]+",d=r.replace(/[.]/g,"\\."),m="(/([^?#]*).*)?$",p=new RegExp(`^https?://${d}/${f}/b/${s}/o${m}`,"i"),x={bucket:1,path:3},g=r===pA?"(?:storage.googleapis.com|storage.cloud.google.com)":r,_="([^?#]*)",k=new RegExp(`^https?://${g}/${s}/${_}`,"i"),y=[{regex:o,indices:l,postModify:a},{regex:p,indices:x,postModify:u},{regex:k,indices:{bucket:1,path:2},postModify:u}];for(let b=0;b<y.length;b++){const O=y[b],D=O.regex.exec(t);if(D){const v=D[O.indices.bucket];let T=D[O.indices.path];T||(T=""),n=new Rn(v,T),O.postModify(n);break}}if(n==null)throw Bj(t);return n}}class qj{constructor(t){this.promise_=Promise.reject(t)}getPromise(){return this.promise_}cancel(t=!1){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Xj(e,t,r){let n=1,s=null,a=null,i=!1,o=0;function l(){return o===2}let u=!1;function f(..._){u||(u=!0,t.apply(null,_))}function d(_){s=setTimeout(()=>{s=null,e(p,l())},_)}function m(){a&&clearTimeout(a)}function p(_,...k){if(u){m();return}if(_){m(),f.call(null,_,...k);return}if(l()||i){m(),f.call(null,_,...k);return}n<64&&(n*=2);let y;o===1?(o=2,y=0):y=(n+Math.random())*1e3,d(y)}let x=!1;function g(_){x||(x=!0,m(),!u&&(s!==null?(_||(o=2),clearTimeout(s),d(0)):_||(o=1)))}return d(0),a=setTimeout(()=>{i=!0,g(!0)},r),g}function Yj(e){e(!1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Qj(e){return e!==void 0}function Jj(e){return typeof e=="object"&&!Array.isArray(e)}function cv(e){return typeof e=="string"||e instanceof String}function lw(e){return uv()&&e instanceof Blob}function uv(){return typeof Blob<"u"}function cw(e,t,r,n){if(n<t)throw Xp(`Invalid value for '${e}'. Expected ${t} or greater.`);if(n>r)throw Xp(`Invalid value for '${e}'. Expected ${r} or less.`)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fv(e,t,r){let n=t;return r==null&&(n=`https://${t}`),`${r}://${n}/v0${e}`}function vA(e){const t=encodeURIComponent;let r="?";for(const n in e)if(e.hasOwnProperty(n)){const s=t(n)+"="+t(e[n]);r=r+s+"&"}return r=r.slice(0,-1),r}var zi;(function(e){e[e.NO_ERROR=0]="NO_ERROR",e[e.NETWORK_ERROR=1]="NETWORK_ERROR",e[e.ABORT=2]="ABORT"})(zi||(zi={}));/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Zj(e,t){const r=e>=500&&e<600,s=[408,429].indexOf(e)!==-1,a=t.indexOf(e)!==-1;return r||s||a}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eL{constructor(t,r,n,s,a,i,o,l,u,f,d,m=!0){this.url_=t,this.method_=r,this.headers_=n,this.body_=s,this.successCodes_=a,this.additionalRetryCodes_=i,this.callback_=o,this.errorCallback_=l,this.timeout_=u,this.progressCallback_=f,this.connectionFactory_=d,this.retry=m,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((p,x)=>{this.resolve_=p,this.reject_=x,this.start_()})}start_(){const t=(n,s)=>{if(s){n(!1,new $f(!1,null,!0));return}const a=this.connectionFactory_();this.pendingConnection_=a;const i=o=>{const l=o.loaded,u=o.lengthComputable?o.total:-1;this.progressCallback_!==null&&this.progressCallback_(l,u)};this.progressCallback_!==null&&a.addUploadProgressListener(i),a.send(this.url_,this.method_,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&a.removeUploadProgressListener(i),this.pendingConnection_=null;const o=a.getErrorCode()===zi.NO_ERROR,l=a.getStatus();if(!o||Zj(l,this.additionalRetryCodes_)&&this.retry){const f=a.getErrorCode()===zi.ABORT;n(!1,new $f(!1,null,f));return}const u=this.successCodes_.indexOf(l)!==-1;n(!0,new $f(u,a))})},r=(n,s)=>{const a=this.resolve_,i=this.reject_,o=s.connection;if(s.wasSuccessCode)try{const l=this.callback_(o,o.getResponse());Qj(l)?a(l):a()}catch(l){i(l)}else if(o!==null){const l=lv();l.serverResponse=o.getErrorText(),this.errorCallback_?i(this.errorCallback_(o,l)):i(l)}else if(s.canceled){const l=this.appDelete_?xA():Vj();i(l)}else{const l=Uj();i(l)}};this.canceled_?r(!1,new $f(!1,null,!0)):this.backoffId_=Xj(t,r,this.timeout_)}getPromise(){return this.promise_}cancel(t){this.canceled_=!0,this.appDelete_=t||!1,this.backoffId_!==null&&Yj(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}}class $f{constructor(t,r,n){this.wasSuccessCode=t,this.connection=r,this.canceled=!!n}}function tL(e,t){t!==null&&t.length>0&&(e.Authorization="Firebase "+t)}function rL(e,t){e["X-Firebase-Storage-Version"]="webjs/"+(t??"AppManager")}function nL(e,t){t&&(e["X-Firebase-GMPID"]=t)}function sL(e,t){t!==null&&(e["X-Firebase-AppCheck"]=t)}function aL(e,t,r,n,s,a,i=!0){const o=vA(e.urlParams),l=e.url+o,u=Object.assign({},e.headers);return nL(u,t),tL(u,r),rL(u,a),sL(u,n),new eL(l,e.method,u,e.body,e.successCodes,e.additionalRetryCodes,e.handler,e.errorHandler,e.timeout,e.progressCallback,s,i)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function iL(){return typeof BlobBuilder<"u"?BlobBuilder:typeof WebKitBlobBuilder<"u"?WebKitBlobBuilder:void 0}function oL(...e){const t=iL();if(t!==void 0){const r=new t;for(let n=0;n<e.length;n++)r.append(e[n]);return r.getBlob()}else{if(uv())return new Blob(e);throw new Kt(Ht.UNSUPPORTED_ENVIRONMENT,"This browser doesn't seem to support creating Blobs")}}function lL(e,t,r){return e.webkitSlice?e.webkitSlice(t,r):e.mozSlice?e.mozSlice(t,r):e.slice?e.slice(t,r):null}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cL(e){if(typeof atob>"u")throw Gj("base-64");return atob(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Fs={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"};class mm{constructor(t,r){this.data=t,this.contentType=r||null}}function uL(e,t){switch(e){case Fs.RAW:return new mm(yA(t));case Fs.BASE64:case Fs.BASE64URL:return new mm(_A(e,t));case Fs.DATA_URL:return new mm(hL(t),dL(t))}throw lv()}function yA(e){const t=[];for(let r=0;r<e.length;r++){let n=e.charCodeAt(r);if(n<=127)t.push(n);else if(n<=2047)t.push(192|n>>6,128|n&63);else if((n&64512)===55296)if(!(r<e.length-1&&(e.charCodeAt(r+1)&64512)===56320))t.push(239,191,189);else{const a=n,i=e.charCodeAt(++r);n=65536|(a&1023)<<10|i&1023,t.push(240|n>>18,128|n>>12&63,128|n>>6&63,128|n&63)}else(n&64512)===56320?t.push(239,191,189):t.push(224|n>>12,128|n>>6&63,128|n&63)}return new Uint8Array(t)}function fL(e){let t;try{t=decodeURIComponent(e)}catch{throw Fc(Fs.DATA_URL,"Malformed data URL.")}return yA(t)}function _A(e,t){switch(e){case Fs.BASE64:{const s=t.indexOf("-")!==-1,a=t.indexOf("_")!==-1;if(s||a)throw Fc(e,"Invalid character '"+(s?"-":"_")+"' found: is it base64url encoded?");break}case Fs.BASE64URL:{const s=t.indexOf("+")!==-1,a=t.indexOf("/")!==-1;if(s||a)throw Fc(e,"Invalid character '"+(s?"+":"/")+"' found: is it base64 encoded?");t=t.replace(/-/g,"+").replace(/_/g,"/");break}}let r;try{r=cL(t)}catch(s){throw s.message.includes("polyfill")?s:Fc(e,"Invalid character found")}const n=new Uint8Array(r.length);for(let s=0;s<r.length;s++)n[s]=r.charCodeAt(s);return n}class wA{constructor(t){this.base64=!1,this.contentType=null;const r=t.match(/^data:([^,]+)?,/);if(r===null)throw Fc(Fs.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");const n=r[1]||null;n!=null&&(this.base64=mL(n,";base64"),this.contentType=this.base64?n.substring(0,n.length-7):n),this.rest=t.substring(t.indexOf(",")+1)}}function hL(e){const t=new wA(e);return t.base64?_A(Fs.BASE64,t.rest):fL(t.rest)}function dL(e){return new wA(e).contentType}function mL(e,t){return e.length>=t.length?e.substring(e.length-t.length)===t:!1}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class za{constructor(t,r){let n=0,s="";lw(t)?(this.data_=t,n=t.size,s=t.type):t instanceof ArrayBuffer?(r?this.data_=new Uint8Array(t):(this.data_=new Uint8Array(t.byteLength),this.data_.set(new Uint8Array(t))),n=this.data_.length):t instanceof Uint8Array&&(r?this.data_=t:(this.data_=new Uint8Array(t.length),this.data_.set(t)),n=t.length),this.size_=n,this.type_=s}size(){return this.size_}type(){return this.type_}slice(t,r){if(lw(this.data_)){const n=this.data_,s=lL(n,t,r);return s===null?null:new za(s)}else{const n=new Uint8Array(this.data_.buffer,t,r-t);return new za(n,!0)}}static getBlob(...t){if(uv()){const r=t.map(n=>n instanceof za?n.data_:n);return new za(oL.apply(null,r))}else{const r=t.map(i=>cv(i)?uL(Fs.RAW,i).data:i.data_);let n=0;r.forEach(i=>{n+=i.byteLength});const s=new Uint8Array(n);let a=0;return r.forEach(i=>{for(let o=0;o<i.length;o++)s[a++]=i[o]}),new za(s,!0)}}uploadData(){return this.data_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function EA(e){let t;try{t=JSON.parse(e)}catch{return null}return Jj(t)?t:null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pL(e){if(e.length===0)return null;const t=e.lastIndexOf("/");return t===-1?"":e.slice(0,t)}function gL(e,t){const r=t.split("/").filter(n=>n.length>0).join("/");return e.length===0?r:e+"/"+r}function TA(e){const t=e.lastIndexOf("/",e.length-2);return t===-1?e:e.slice(t+1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xL(e,t){return t}class Yr{constructor(t,r,n,s){this.server=t,this.local=r||t,this.writable=!!n,this.xform=s||xL}}let Wf=null;function vL(e){return!cv(e)||e.length<2?e:TA(e)}function kA(){if(Wf)return Wf;const e=[];e.push(new Yr("bucket")),e.push(new Yr("generation")),e.push(new Yr("metageneration")),e.push(new Yr("name","fullPath",!0));function t(a,i){return vL(i)}const r=new Yr("name");r.xform=t,e.push(r);function n(a,i){return i!==void 0?Number(i):i}const s=new Yr("size");return s.xform=n,e.push(s),e.push(new Yr("timeCreated")),e.push(new Yr("updated")),e.push(new Yr("md5Hash",null,!0)),e.push(new Yr("cacheControl",null,!0)),e.push(new Yr("contentDisposition",null,!0)),e.push(new Yr("contentEncoding",null,!0)),e.push(new Yr("contentLanguage",null,!0)),e.push(new Yr("contentType",null,!0)),e.push(new Yr("metadata","customMetadata",!0)),Wf=e,Wf}function yL(e,t){function r(){const n=e.bucket,s=e.fullPath,a=new Rn(n,s);return t._makeStorageReference(a)}Object.defineProperty(e,"ref",{get:r})}function _L(e,t,r){const n={};n.type="file";const s=r.length;for(let a=0;a<s;a++){const i=r[a];n[i.local]=i.xform(n,t[i.server])}return yL(n,e),n}function SA(e,t,r){const n=EA(t);return n===null?null:_L(e,n,r)}function wL(e,t,r,n){const s=EA(t);if(s===null||!cv(s.downloadTokens))return null;const a=s.downloadTokens;if(a.length===0)return null;const i=encodeURIComponent;return a.split(",").map(u=>{const f=e.bucket,d=e.fullPath,m="/b/"+i(f)+"/o/"+i(d),p=fv(m,r,n),x=vA({alt:"media",token:u});return p+x})[0]}function EL(e,t){const r={},n=t.length;for(let s=0;s<n;s++){const a=t[s];a.writable&&(r[a.server]=e[a.local])}return JSON.stringify(r)}class AA{constructor(t,r,n,s){this.url=t,this.method=r,this.handler=n,this.timeout=s,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bA(e){if(!e)throw lv()}function TL(e,t){function r(n,s){const a=SA(e,s,t);return bA(a!==null),a}return r}function kL(e,t){function r(n,s){const a=SA(e,s,t);return bA(a!==null),wL(a,s,e.host,e._protocol)}return r}function IA(e){function t(r,n){let s;return r.getStatus()===401?r.getErrorText().includes("Firebase App Check token is invalid")?s=jj():s=Mj():r.getStatus()===402?s=Oj(e.bucket):r.getStatus()===403?s=Lj(e.path):s=n,s.status=r.getStatus(),s.serverResponse=n.serverResponse,s}return t}function SL(e){const t=IA(e);function r(n,s){let a=t(n,s);return n.getStatus()===404&&(a=Fj(e.path)),a.serverResponse=s.serverResponse,a}return r}function AL(e,t,r){const n=t.fullServerUrl(),s=fv(n,e.host,e._protocol),a="GET",i=e.maxOperationRetryTime,o=new AA(s,a,kL(e,r),i);return o.errorHandler=SL(t),o}function bL(e,t){return e&&e.contentType||t&&t.type()||"application/octet-stream"}function IL(e,t,r){const n=Object.assign({},r);return n.fullPath=e.path,n.size=t.size(),n.contentType||(n.contentType=bL(null,t)),n}function NL(e,t,r,n,s){const a=t.bucketOnlyServerUrl(),i={"X-Goog-Upload-Protocol":"multipart"};function o(){let y="";for(let b=0;b<2;b++)y=y+Math.random().toString().slice(2);return y}const l=o();i["Content-Type"]="multipart/related; boundary="+l;const u=IL(t,n,s),f=EL(u,r),d="--"+l+`\r
Content-Type: application/json; charset=utf-8\r
\r
`+f+`\r
--`+l+`\r
Content-Type: `+u.contentType+`\r
\r
`,m=`\r
--`+l+"--",p=za.getBlob(d,n,m);if(p===null)throw zj();const x={name:u.fullPath},g=fv(a,e.host,e._protocol),_="POST",k=e.maxUploadRetryTime,E=new AA(g,_,TL(e,r),k);return E.urlParams=x,E.headers=i,E.body=p.uploadData(),E.errorHandler=IA(t),E}class CL{constructor(){this.sent_=!1,this.xhr_=new XMLHttpRequest,this.initXhr(),this.errorCode_=zi.NO_ERROR,this.sendPromise_=new Promise(t=>{this.xhr_.addEventListener("abort",()=>{this.errorCode_=zi.ABORT,t()}),this.xhr_.addEventListener("error",()=>{this.errorCode_=zi.NETWORK_ERROR,t()}),this.xhr_.addEventListener("load",()=>{t()})})}send(t,r,n,s){if(this.sent_)throw ic("cannot .send() more than once");if(this.sent_=!0,this.xhr_.open(r,t,!0),s!==void 0)for(const a in s)s.hasOwnProperty(a)&&this.xhr_.setRequestHeader(a,s[a].toString());return n!==void 0?this.xhr_.send(n):this.xhr_.send(),this.sendPromise_}getErrorCode(){if(!this.sent_)throw ic("cannot .getErrorCode() before sending");return this.errorCode_}getStatus(){if(!this.sent_)throw ic("cannot .getStatus() before sending");try{return this.xhr_.status}catch{return-1}}getResponse(){if(!this.sent_)throw ic("cannot .getResponse() before sending");return this.xhr_.response}getErrorText(){if(!this.sent_)throw ic("cannot .getErrorText() before sending");return this.xhr_.statusText}abort(){this.xhr_.abort()}getResponseHeader(t){return this.xhr_.getResponseHeader(t)}addUploadProgressListener(t){this.xhr_.upload!=null&&this.xhr_.upload.addEventListener("progress",t)}removeUploadProgressListener(t){this.xhr_.upload!=null&&this.xhr_.upload.removeEventListener("progress",t)}}class RL extends CL{initXhr(){this.xhr_.responseType="text"}}function NA(){return new RL}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class so{constructor(t,r){this._service=t,r instanceof Rn?this._location=r:this._location=Rn.makeFromUrl(r,t.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(t,r){return new so(t,r)}get root(){const t=new Rn(this._location.bucket,"");return this._newRef(this._service,t)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return TA(this._location.path)}get storage(){return this._service}get parent(){const t=pL(this._location.path);if(t===null)return null;const r=new Rn(this._location.bucket,t);return new so(this._service,r)}_throwIfRoot(t){if(this._location.path==="")throw Kj(t)}}function PL(e,t,r){e._throwIfRoot("uploadBytes");const n=NL(e.storage,e._location,kA(),new za(t,!0),r);return e.storage.makeRequestWithTokens(n,NA).then(s=>({metadata:s,ref:e}))}function DL(e){e._throwIfRoot("getDownloadURL");const t=AL(e.storage,e._location,kA());return e.storage.makeRequestWithTokens(t,NA).then(r=>{if(r===null)throw Hj();return r})}function FL(e,t){const r=gL(e._location.path,t),n=new Rn(e._location.bucket,r);return new so(e.storage,n)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function OL(e){return/^[A-Za-z]+:\/\//.test(e)}function ML(e,t){return new so(e,t)}function CA(e,t){if(e instanceof hv){const r=e;if(r._bucket==null)throw Wj();const n=new so(r,r._bucket);return t!=null?CA(n,t):n}else return t!==void 0?FL(e,t):e}function jL(e,t){if(t&&OL(t)){if(e instanceof hv)return ML(e,t);throw Xp("To use ref(service, url), the first argument must be a Storage instance.")}else return CA(e,t)}function uw(e,t){const r=t==null?void 0:t[gA];return r==null?null:Rn.makeFromBucketSpec(r,e)}function LL(e,t,r,n={}){e.host=`${t}:${r}`,e._protocol="http";const{mockUserToken:s}=n;s&&(e._overrideAuthToken=typeof s=="string"?s:ok(s,e.app.options.projectId))}class hv{constructor(t,r,n,s,a){this.app=t,this._authProvider=r,this._appCheckProvider=n,this._url=s,this._firebaseVersion=a,this._bucket=null,this._host=pA,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=Pj,this._maxUploadRetryTime=Dj,this._requests=new Set,s!=null?this._bucket=Rn.makeFromBucketSpec(s,this._host):this._bucket=uw(this._host,this.app.options)}get host(){return this._host}set host(t){this._host=t,this._url!=null?this._bucket=Rn.makeFromBucketSpec(this._url,t):this._bucket=uw(t,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(t){cw("time",0,Number.POSITIVE_INFINITY,t),this._maxUploadRetryTime=t}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(t){cw("time",0,Number.POSITIVE_INFINITY,t),this._maxOperationRetryTime=t}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const t=this._authProvider.getImmediate({optional:!0});if(t){const r=await t.getToken();if(r!==null)return r.accessToken}return null}async _getAppCheckToken(){const t=this._appCheckProvider.getImmediate({optional:!0});return t?(await t.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(t=>t.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(t){return new so(this,t)}_makeRequest(t,r,n,s,a=!0){if(this._deleted)return new qj(xA());{const i=aL(t,this._appId,n,s,r,this._firebaseVersion,a);return this._requests.add(i),i.getPromise().then(()=>this._requests.delete(i),()=>this._requests.delete(i)),i}}async makeRequestWithTokens(t,r){const[n,s]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(t,r,n,s).getPromise()}}const fw="@firebase/storage",hw="0.13.2";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const RA="storage";function UL(e,t,r){return e=Pt(e),PL(e,t,r)}function VL(e){return e=Pt(e),DL(e)}function BL(e,t){return e=Pt(e),jL(e,t)}function $L(e=qd(),t){e=Pt(e);const n=Lu(e,RA).getImmediate({identifier:t}),s=ux("storage");return s&&WL(n,...s),n}function WL(e,t,r,n={}){LL(e,t,r,n)}function zL(e,{instanceIdentifier:t}){const r=e.getProvider("app").getImmediate(),n=e.getProvider("auth-internal"),s=e.getProvider("app-check-internal");return new hv(r,n,s,t,uo)}function HL(){di(new ya(RA,zL,"PUBLIC").setMultipleInstances(!0)),Xn(fw,hw,""),Xn(fw,hw,"esm2017")}HL();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const GL="type.googleapis.com/google.protobuf.Int64Value",KL="type.googleapis.com/google.protobuf.UInt64Value";function PA(e,t){const r={};for(const n in e)e.hasOwnProperty(n)&&(r[n]=t(e[n]));return r}function Yp(e){if(e==null)return null;if(e instanceof Number&&(e=e.valueOf()),typeof e=="number"&&isFinite(e)||e===!0||e===!1||Object.prototype.toString.call(e)==="[object String]")return e;if(e instanceof Date)return e.toISOString();if(Array.isArray(e))return e.map(t=>Yp(t));if(typeof e=="function"||typeof e=="object")return PA(e,t=>Yp(t));throw new Error("Data cannot be encoded in JSON: "+e)}function hd(e){if(e==null)return e;if(e["@type"])switch(e["@type"]){case GL:case KL:{const t=Number(e.value);if(isNaN(t))throw new Error("Data cannot be decoded from JSON: "+e);return t}default:throw new Error("Data cannot be decoded from JSON: "+e)}return Array.isArray(e)?e.map(t=>hd(t)):typeof e=="function"||typeof e=="object"?PA(e,t=>hd(t)):e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dv="functions";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dw={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class nl extends ks{constructor(t,r,n){super(`${dv}/${t}`,r||""),this.details=n}}function qL(e){if(e>=200&&e<300)return"ok";switch(e){case 0:return"internal";case 400:return"invalid-argument";case 401:return"unauthenticated";case 403:return"permission-denied";case 404:return"not-found";case 409:return"aborted";case 429:return"resource-exhausted";case 499:return"cancelled";case 500:return"internal";case 501:return"unimplemented";case 503:return"unavailable";case 504:return"deadline-exceeded"}return"unknown"}function XL(e,t){let r=qL(e),n=r,s;try{const a=t&&t.error;if(a){const i=a.status;if(typeof i=="string"){if(!dw[i])return new nl("internal","internal");r=dw[i],n=i}const o=a.message;typeof o=="string"&&(n=o),s=a.details,s!==void 0&&(s=hd(s))}}catch{}return r==="ok"?null:new nl(r,n,s)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YL{constructor(t,r,n){this.auth=null,this.messaging=null,this.appCheck=null,this.auth=t.getImmediate({optional:!0}),this.messaging=r.getImmediate({optional:!0}),this.auth||t.get().then(s=>this.auth=s,()=>{}),this.messaging||r.get().then(s=>this.messaging=s,()=>{}),this.appCheck||n.get().then(s=>this.appCheck=s,()=>{})}async getAuthToken(){if(this.auth)try{const t=await this.auth.getToken();return t==null?void 0:t.accessToken}catch{return}}async getMessagingToken(){if(!(!this.messaging||!("Notification"in self)||Notification.permission!=="granted"))try{return await this.messaging.getToken()}catch{return}}async getAppCheckToken(t){if(this.appCheck){const r=t?await this.appCheck.getLimitedUseToken():await this.appCheck.getToken();return r.error?null:r.token}return null}async getContext(t){const r=await this.getAuthToken(),n=await this.getMessagingToken(),s=await this.getAppCheckToken(t);return{authToken:r,messagingToken:n,appCheckToken:s}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Qp="us-central1";function QL(e){let t=null;return{promise:new Promise((r,n)=>{t=setTimeout(()=>{n(new nl("deadline-exceeded","deadline-exceeded"))},e)}),cancel:()=>{t&&clearTimeout(t)}}}class JL{constructor(t,r,n,s,a=Qp,i){this.app=t,this.fetchImpl=i,this.emulatorOrigin=null,this.contextProvider=new YL(r,n,s),this.cancelAllRequests=new Promise(o=>{this.deleteService=()=>Promise.resolve(o())});try{const o=new URL(a);this.customDomain=o.origin+(o.pathname==="/"?"":o.pathname),this.region=Qp}catch{this.customDomain=null,this.region=a}}_delete(){return this.deleteService()}_url(t){const r=this.app.options.projectId;return this.emulatorOrigin!==null?`${this.emulatorOrigin}/${r}/${this.region}/${t}`:this.customDomain!==null?`${this.customDomain}/${t}`:`https://${this.region}-${r}.cloudfunctions.net/${t}`}}function ZL(e,t,r){e.emulatorOrigin=`http://${t}:${r}`}function e6(e,t,r){return n=>r6(e,t,n,{})}async function t6(e,t,r,n){r["Content-Type"]="application/json";let s;try{s=await n(e,{method:"POST",body:JSON.stringify(t),headers:r})}catch{return{status:0,json:null}}let a=null;try{a=await s.json()}catch{}return{status:s.status,json:a}}function r6(e,t,r,n){const s=e._url(t);return n6(e,s,r,n)}async function n6(e,t,r,n){r=Yp(r);const s={data:r},a={},i=await e.contextProvider.getContext(n.limitedUseAppCheckTokens);i.authToken&&(a.Authorization="Bearer "+i.authToken),i.messagingToken&&(a["Firebase-Instance-ID-Token"]=i.messagingToken),i.appCheckToken!==null&&(a["X-Firebase-AppCheck"]=i.appCheckToken);const o=n.timeout||7e4,l=QL(o),u=await Promise.race([t6(t,s,a,e.fetchImpl),l.promise,e.cancelAllRequests]);if(l.cancel(),!u)throw new nl("cancelled","Firebase Functions instance was deleted.");const f=XL(u.status,u.json);if(f)throw f;if(!u.json)throw new nl("internal","Response is not valid JSON object.");let d=u.json.data;if(typeof d>"u"&&(d=u.json.result),typeof d>"u")throw new nl("internal","Response is missing data field.");return{data:hd(d)}}const mw="@firebase/functions",pw="0.11.8";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const s6="auth-internal",a6="app-check-internal",i6="messaging-internal";function o6(e,t){const r=(n,{instanceIdentifier:s})=>{const a=n.getProvider("app").getImmediate(),i=n.getProvider(s6),o=n.getProvider(i6),l=n.getProvider(a6);return new JL(a,i,o,l,s,e)};di(new ya(dv,r,"PUBLIC").setMultipleInstances(!0)),Xn(mw,pw,t),Xn(mw,pw,"esm2017")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function l6(e=qd(),t=Qp){const n=Lu(Pt(e),dv).getImmediate({identifier:t}),s=ux("functions");return s&&c6(n,...s),n}function c6(e,t,r){ZL(Pt(e),t,r)}function u6(e,t,r){return e6(Pt(e),t)}o6(fetch.bind(self));const f6={apiKey:"AIzaSyD5-h96WDy4SzuP1XqClyBbpd1CL_tNZQw",authDomain:"my-xmas-movies.firebaseapp.com",projectId:"my-xmas-movies",storageBucket:"my-xmas-movies.firebasestorage.app",messagingSenderId:"534280822678",appId:"1:534280822678:web:5e91b52cb61b7ed71a47b7"},g0=uk(f6),Oc=I3(g0),DA=new Ds;DA.setCustomParameters({prompt:"select_account"});const h6=DA,De=dj(g0),d6=$L(g0),m6=l6(g0),FA=U.createContext(void 0),ln=()=>{const e=U.useContext(FA);if(e===void 0)throw new Error("useAuth must be used within an AuthProvider");return e},p6=({children:e})=>{const[t,r]=U.useState(null),[n,s]=U.useState(null),[a,i]=U.useState(!0),[o,l]=U.useState(null);U.useEffect(()=>{const m=Fk(Oc,async p=>{if(r(p),l(null),p)try{const x=dt(De,"users",p.uid),g=await En(x);if(g.exists())await Zn(x,{lastLoginAt:Ij()},{merge:!0}),s(g.data());else{const _={email:p.email||"",displayName:p.displayName||"User",photoURL:p.photoURL||void 0,createdAt:new Date,lastLoginAt:new Date};await Zn(x,_),s({id:p.uid,..._})}}catch(x){console.error("Error fetching user profile:",x),l("Failed to load user profile")}else s(null);i(!1)});return()=>m()},[]);const d={currentUser:t,userProfile:n,isLoading:a,error:o,signInWithGoogle:async()=>{try{l(null),i(!0);const m=new Ds;await Hk(Oc,m)}catch(m){console.error("Login error:",m),l(m.message||"Failed to sign in")}finally{i(!1)}},signOut:async()=>{try{await vF(Oc)}catch(m){console.error("Sign out error:",m),l(m.message||"Failed to sign out")}}};return c.jsx(FA.Provider,{value:d,children:e})},Ol=()=>{const[e,t]=U.useState(!1),[r,n]=U.useState(!0),[s,a]=U.useState(null),[i,o]=U.useState(null);return U.useEffect(()=>{const l=Fk(Oc,async u=>{if(n(!0),a(null),!u){t(!1),o(null),n(!1);return}o({uid:u.uid,email:u.email});try{const d=(await yk(u,!0)).claims.admin===!0;t(d)}catch(f){console.error("Error checking admin status:",f),a("Failed to verify admin status"),t(!1)}finally{n(!1)}});return()=>l()},[]),{isAdmin:e,loading:r,error:s,currentUser:i}},g6=({snowflakeCount:e=100,mobileSnowflakeCount:t=50})=>{const[r,n]=U.useState(!1),[s,a]=U.useState(e),i=U.useRef(null),o=U.useRef([]),l=U.useRef(0);return U.useEffect(()=>{const u=()=>{const f=window.matchMedia("(max-width: 768px)").matches;n(f),a(f?t:e)};return u(),window.addEventListener("resize",u),()=>{window.removeEventListener("resize",u)}},[e,t]),U.useEffect(()=>{const u=i.current;if(!u)return;const f=u.getContext("2d");if(!f)return;const d=()=>{u.width=window.innerWidth,u.height=window.innerHeight},m=()=>{o.current=[];for(let _=0;_<s;_++)o.current.push({x:Math.random()*u.width,y:Math.random()*u.height,size:r?Math.random()*3+1:Math.random()*4+1,speed:r?Math.random()*.8+.3:Math.random()*1+.5,opacity:r?Math.random()*.5+.2:Math.random()*.6+.3,wind:r?Math.random()*.3-.15:Math.random()*.5-.25})},p=_=>{f.beginPath(),f.arc(_.x,_.y,_.size,0,Math.PI*2),f.fillStyle=`rgba(255, 255, 255, ${_.opacity})`,f.fill()},x=_=>{_.y+=_.speed,_.x+=_.wind,_.y>u.height&&(_.y=-10,_.x=Math.random()*u.width),_.x>u.width?_.x=0:_.x<0&&(_.x=u.width)},g=()=>{f.clearRect(0,0,u.width,u.height),o.current.forEach(_=>{p(_),x(_)}),l.current=requestAnimationFrame(g)};return window.addEventListener("resize",d),d(),m(),g(),()=>{window.removeEventListener("resize",d),cancelAnimationFrame(l.current)}},[s]),c.jsx("canvas",{ref:i,className:"fixed top-0 left-0 w-full h-full pointer-events-none z-10","aria-hidden":"true"})},x6=()=>{const[e,t]=U.useState(!1),[r,n]=U.useState(null),[s,a]=U.useState(!1);U.useEffect(()=>{const l=/iPad|iPhone|iPod/.test(navigator.userAgent)&&!window.MSStream;a(l);const u=f=>{f.preventDefault(),n(f),t(!0)};return window.addEventListener("beforeinstallprompt",u),window.matchMedia("(display-mode: standalone)").matches&&t(!1),()=>{window.removeEventListener("beforeinstallprompt",u)}},[]);const i=async()=>{if(!r)return;r.prompt();const{outcome:l}=await r.userChoice;n(null),t(!1),console.log(`User ${l==="accepted"?"accepted":"dismissed"} the install prompt`)},o=()=>{t(!1),localStorage.setItem("installPromptDismissed","true")};return e?c.jsxs("div",{className:"fixed bottom-0 left-0 right-0 bg-green-800 text-white p-4 shadow-lg z-50 flex items-center justify-between",children:[c.jsxs("div",{className:"flex items-center",children:[c.jsx("div",{className:"mr-3 text-2xl",children:c.jsx("i",{className:"fas fa-gift"})}),c.jsx("div",{children:s?c.jsxs("p",{children:["Install this app on your device: tap ",c.jsx("i",{className:"fas fa-share"}),' and then "Add to Home Screen"']}):c.jsx("p",{children:"Add Christmas Movies to your home screen!"})})]}),c.jsxs("div",{className:"flex items-center",children:[!s&&c.jsx("button",{onClick:i,className:"bg-red-700 hover:bg-red-800 text-white py-1 px-4 rounded-full mr-2",children:"Install"}),c.jsx("button",{onClick:o,className:"bg-transparent hover:bg-green-700 text-white py-1 px-2 rounded-full",children:c.jsx("i",{className:"fas fa-times"})})]})]}):null};function v6(){const{currentUser:e}=ln(),{isAdmin:t}=Ol(),[r,n]=U.useState(!1),s=Ts();U.useEffect(()=>(r?document.body.style.overflow="hidden":document.body.style.overflow="",()=>{document.body.style.overflow=""}),[r]),U.useEffect(()=>{r&&n(!1)},[s.pathname]);const a=()=>{n(!r)};return c.jsxs("div",{className:"min-h-screen bg-gradient-to-b from-xmas-bg to-xmas-card bg-opacity-95",children:[c.jsx(g6,{snowflakeCount:150,mobileSnowflakeCount:40}),c.jsx(x6,{}),c.jsxs("div",{className:"navbar bg-gradient-to-r from-xmas-card via-xmas-card to-xmas-bg border-b border-xmas-gold px-2 sm:px-4 shadow-lg relative overflow-hidden",children:[c.jsx("div",{className:"absolute top-0 left-0 w-full h-1 bg-gradient-to-r from-xmas-gold via-transparent to-xmas-gold opacity-60"}),c.jsx("div",{className:"absolute -bottom-4 left-0 right-0 h-8 snow-accumulation-fast"}),c.jsxs("div",{className:"flex items-center",children:[c.jsx("button",{className:"btn btn-ghost btn-sm md:hidden relative z-10",onClick:a,"aria-label":"Toggle navigation menu",children:c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",className:"inline-block w-5 h-5 stroke-current",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M4 6h16M4 12h16M4 18h16"})})}),c.jsxs(Ge,{to:"/",className:"hidden sm:flex items-center group",children:[c.jsxs("div",{className:"relative",children:[c.jsx("div",{className:"absolute -inset-1 bg-gradient-to-r from-xmas-gold to-xmas-line rounded-full opacity-70 group-hover:opacity-100 blur transition duration-200"}),c.jsx("div",{className:"relative flex items-center justify-center w-10 h-10 bg-xmas-card rounded-full border border-xmas-gold overflow-hidden",children:c.jsx("img",{src:"/Santa.png",alt:"Santa",className:"w-full h-full object-cover group-hover:scale-110 transition-transform duration-300"})})]}),c.jsx("div",{className:"ml-3 font-christmas text-xl sm:text-2xl bg-gradient-to-br from-xmas-gold via-xmas-snow to-xmas-gold bg-clip-text text-transparent font-bold",children:"Christmas Movies"})]}),c.jsxs(Ge,{to:"/",className:"sm:hidden flex items-center",children:[c.jsx("div",{className:"w-8 h-8 flex items-center justify-center rounded-full bg-xmas-card border border-xmas-gold overflow-hidden",children:c.jsx("img",{src:"/Santa.png",alt:"Santa",className:"w-full h-full object-cover"})}),c.jsx("span",{className:"ml-2 font-christmas text-lg text-xmas-gold",children:"Christmas Movies"})]})]}),c.jsx("div",{className:"flex-1"}),c.jsxs("div",{className:"flex items-center gap-1 sm:gap-2",children:[e&&c.jsxs(Ge,{to:"/profile",className:"btn btn-primary btn-sm hidden md:flex",children:[c.jsx("i",{className:"fas fa-user-circle mr-1"})," Profile"]}),e?c.jsxs("div",{className:"dropdown dropdown-end",children:[c.jsx("label",{tabIndex:0,className:"btn btn-ghost btn-circle avatar cursor-pointer",children:c.jsx("div",{className:"w-10 rounded-full border border-xmas-gold",children:e.photoURL?c.jsx("img",{src:e.photoURL,alt:"Profile"}):c.jsx("div",{className:"bg-xmas-card flex items-center justify-center h-full",children:c.jsx("i",{className:"fas fa-user text-xmas-gold"})})})}),c.jsxs("ul",{tabIndex:0,className:"dropdown-content menu menu-sm mt-3 z-[1] p-2 shadow bg-xmas-card rounded-box w-52 border border-xmas-gold",children:[c.jsx("li",{children:c.jsxs(Ge,{to:"/profile",className:"justify-between",children:["Profile",c.jsx("i",{className:"fas fa-user-circle"})]})}),c.jsx("li",{children:c.jsxs(Ge,{to:"/movies",children:["My Movies",c.jsx("i",{className:"fas fa-film"})]})}),c.jsx("li",{children:c.jsxs(Ge,{to:"/random",children:["Random Movie",c.jsx("i",{className:"fas fa-random"})]})}),c.jsx("li",{children:c.jsxs(Ge,{to:"/import",children:["Import Movies",c.jsx("i",{className:"fas fa-file-import"})]})}),t&&c.jsx("li",{children:c.jsxs(Ge,{to:"/admin",className:"text-xmas-gold",children:["Admin Dashboard",c.jsx("i",{className:"fas fa-crown"})]})})]})]}):c.jsxs(Ge,{to:"/login",className:"btn btn-primary btn-sm",children:[c.jsx("i",{className:"fas fa-sign-in-alt mr-1"})," Sign In"]})]})]}),c.jsx("div",{className:`fixed inset-0 bg-black bg-opacity-70 z-20 transition-opacity duration-300 md:hidden ${r?"opacity-100":"opacity-0 pointer-events-none"}`,onClick:a}),c.jsxs("div",{className:`fixed top-0 left-0 h-full w-72 bg-gradient-to-b from-xmas-bg to-xmas-card border-r border-xmas-gold z-30 transform transition-transform duration-300 ease-in-out md:hidden shadow-xl ${r?"translate-x-0":"-translate-x-full"}`,children:[c.jsxs("div",{className:"relative overflow-hidden",children:[c.jsx("div",{className:"absolute top-0 left-0 w-full h-1 bg-gradient-to-r from-xmas-gold via-transparent to-xmas-gold opacity-60"}),c.jsxs("div",{className:"flex justify-between items-center p-4 border-b border-xmas-gold bg-xmas-card bg-opacity-80",children:[c.jsxs("div",{className:"flex items-center",children:[c.jsx("div",{className:"w-9 h-9 flex items-center justify-center rounded-full bg-xmas-card border border-xmas-gold shadow-lg overflow-hidden",children:c.jsx("img",{src:"/Santa.png",alt:"Santa",className:"w-full h-full object-cover"})}),c.jsx("div",{className:"ml-3 font-christmas text-xl bg-gradient-to-br from-xmas-gold via-xmas-snow to-xmas-gold bg-clip-text text-transparent font-bold",children:"Christmas Movies"})]}),c.jsx("button",{className:"btn btn-ghost btn-sm text-xmas-text hover:text-xmas-line",onClick:a,"aria-label":"Close navigation menu",children:c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})]}),c.jsx("div",{className:"overflow-y-auto h-full pb-20",children:c.jsx("div",{className:"p-4 pt-6",children:c.jsxs("div",{className:"mb-6",children:[c.jsx("h3",{className:"font-christmas text-xl text-xmas-gold mb-4 pl-2 border-l-2 border-xmas-line",children:"Navigation"}),c.jsxs("ul",{className:"space-y-3",children:[c.jsx("li",{children:c.jsx(Da,{to:"/",onClick:a,className:({isActive:i})=>i?"flex items-center p-2 pl-3 rounded-md bg-gradient-to-r from-xmas-card to-transparent border-l-2 border-xmas-gold text-xmas-gold font-medium":"flex items-center p-2 pl-3 rounded-md hover:bg-xmas-card hover:bg-opacity-50 text-xmas-text hover:text-xmas-gold transition-all duration-200",children:({isActive:i})=>c.jsxs(c.Fragment,{children:[c.jsx("i",{className:"fas fa-home mr-3 text-xmas-gold"}),c.jsx("span",{children:"Home"}),c.jsx("i",{className:`fas fa-snowflake ml-auto text-xmas-gold opacity-70 ${i?"visible":"invisible"}`})]})})}),e?c.jsxs(c.Fragment,{children:[c.jsx("li",{children:c.jsx(Da,{to:"/movies",onClick:a,className:({isActive:i})=>i?"flex items-center p-2 pl-3 rounded-md bg-gradient-to-r from-xmas-card to-transparent border-l-2 border-xmas-gold text-xmas-gold font-medium":"flex items-center p-2 pl-3 rounded-md hover:bg-xmas-card hover:bg-opacity-50 text-xmas-text hover:text-xmas-gold transition-all duration-200",children:({isActive:i})=>c.jsxs(c.Fragment,{children:[c.jsx("i",{className:"fas fa-film mr-3 text-xmas-gold"}),c.jsx("span",{children:"My Movies"}),c.jsx("i",{className:`fas fa-snowflake ml-auto text-xmas-gold opacity-70 ${i?"visible":"invisible"}`})]})})}),c.jsx("li",{children:c.jsx(Da,{to:"/random",onClick:a,className:({isActive:i})=>i?"flex items-center p-2 pl-3 rounded-md bg-gradient-to-r from-xmas-card to-transparent border-l-2 border-xmas-gold text-xmas-gold font-medium":"flex items-center p-2 pl-3 rounded-md hover:bg-xmas-card hover:bg-opacity-50 text-xmas-text hover:text-xmas-gold transition-all duration-200",children:({isActive:i})=>c.jsxs(c.Fragment,{children:[c.jsx("i",{className:"fas fa-random mr-3 text-xmas-gold"}),c.jsx("span",{children:"Random Movie"}),c.jsx("i",{className:`fas fa-snowflake ml-auto text-xmas-gold opacity-70 ${i?"visible":"invisible"}`})]})})}),c.jsx("li",{children:c.jsx(Da,{to:"/achievements",onClick:a,className:({isActive:i})=>i?"flex items-center p-2 pl-3 rounded-md bg-gradient-to-r from-xmas-card to-transparent border-l-2 border-xmas-gold text-xmas-gold font-medium":"flex items-center p-2 pl-3 rounded-md hover:bg-xmas-card hover:bg-opacity-50 text-xmas-text hover:text-xmas-gold transition-all duration-200",children:({isActive:i})=>c.jsxs(c.Fragment,{children:[c.jsx("i",{className:"fas fa-trophy mr-3 text-xmas-gold"}),c.jsx("span",{children:"Achievements"}),c.jsx("i",{className:`fas fa-snowflake ml-auto text-xmas-gold opacity-70 ${i?"visible":"invisible"}`})]})})}),c.jsx("li",{children:c.jsx(Da,{to:"/import",onClick:a,className:({isActive:i})=>i?"flex items-center p-2 pl-3 rounded-md bg-gradient-to-r from-xmas-card to-transparent border-l-2 border-xmas-gold text-xmas-gold font-medium":"flex items-center p-2 pl-3 rounded-md hover:bg-xmas-card hover:bg-opacity-50 text-xmas-text hover:text-xmas-gold transition-all duration-200",children:({isActive:i})=>c.jsxs(c.Fragment,{children:[c.jsx("i",{className:"fas fa-file-import mr-3 text-xmas-gold"}),c.jsx("span",{children:"Add Movies"}),c.jsx("i",{className:`fas fa-snowflake ml-auto text-xmas-gold opacity-70 ${i?"visible":"invisible"}`})]})})}),c.jsx("li",{children:c.jsx(Da,{to:"/profile",onClick:a,className:({isActive:i})=>i?"flex items-center p-2 pl-3 rounded-md bg-gradient-to-r from-xmas-card to-transparent border-l-2 border-xmas-gold text-xmas-gold font-medium":"flex items-center p-2 pl-3 rounded-md hover:bg-xmas-card hover:bg-opacity-50 text-xmas-text hover:text-xmas-gold transition-all duration-200",children:({isActive:i})=>c.jsxs(c.Fragment,{children:[c.jsx("i",{className:"fas fa-user-circle mr-3 text-xmas-gold"}),c.jsx("span",{children:"Profile"}),c.jsx("i",{className:`fas fa-snowflake ml-auto text-xmas-gold opacity-70 ${i?"visible":"invisible"}`})]})})}),t&&c.jsx("li",{children:c.jsx(Da,{to:"/admin",onClick:a,className:({isActive:i})=>i?"flex items-center p-2 pl-3 rounded-md bg-gradient-to-r from-xmas-card to-transparent border-l-2 border-xmas-gold text-xmas-gold font-medium":"flex items-center p-2 pl-3 rounded-md hover:bg-xmas-card hover:bg-opacity-50 text-xmas-text hover:text-xmas-gold transition-all duration-200",children:({isActive:i})=>c.jsxs(c.Fragment,{children:[c.jsx("i",{className:"fas fa-crown mr-3 text-xmas-gold"}),c.jsx("span",{children:"Admin Dashboard"}),c.jsx("i",{className:`fas fa-snowflake ml-auto text-xmas-gold opacity-70 ${i?"visible":"invisible"}`})]})})})]}):c.jsx("li",{children:c.jsx(Da,{to:"/login",onClick:a,className:({isActive:i})=>i?"flex items-center p-2 pl-3 rounded-md bg-gradient-to-r from-xmas-card to-transparent border-l-2 border-xmas-gold text-xmas-gold font-medium":"flex items-center p-2 pl-3 rounded-md hover:bg-xmas-card hover:bg-opacity-50 text-xmas-text hover:text-xmas-gold transition-all duration-200",children:({isActive:i})=>c.jsxs(c.Fragment,{children:[c.jsx("i",{className:"fas fa-sign-in-alt mr-3 text-xmas-gold"}),c.jsx("span",{children:"Sign In"}),c.jsx("i",{className:`fas fa-snowflake ml-auto text-xmas-gold opacity-70 ${i?"visible":"invisible"}`})]})})})]})]})})})]}),c.jsx("main",{className:"p-4",children:c.jsx(JT,{})}),c.jsx("div",{className:"fixed bottom-0 left-0 w-full pointer-events-none",children:c.jsx("div",{className:"container mx-auto",children:c.jsxs("div",{className:"relative h-16",children:[c.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-px bg-gradient-to-r from-xmas-gold via-transparent to-xmas-gold opacity-40"}),c.jsx("div",{className:"absolute bottom-4 left-4 opacity-30",children:c.jsx("i",{className:"fas fa-tree text-4xl text-xmas-gold"})}),c.jsx("div",{className:"absolute bottom-4 right-4 opacity-30",children:c.jsx("i",{className:"fas fa-star text-4xl text-xmas-gold"})})]})})})]})}const OA=U.createContext(null);function y6({children:e}){const[t,r]=U.useState([]),n=U.useCallback(i=>{r(o=>o.filter(l=>l.id!==i))},[]),s=U.useCallback((i,o)=>{const l=Math.random().toString(36).slice(2);r(u=>[...u,{id:l,kind:i,message:o}]),setTimeout(()=>n(l),3e3)},[n]),a=U.useMemo(()=>({push:s}),[s]);return c.jsxs(OA.Provider,{value:a,children:[e,c.jsx("div",{className:"fixed top-4 left-1/2 -translate-x-1/2 z-50 space-y-2",children:t.map(i=>c.jsxs("div",{className:`alert shadow-lg max-w-sm border-2 rounded-xl bg-gradient-to-r ${i.kind==="success"?"from-green-700/90 to-emerald-600/90 border-green-300":i.kind==="error"?"from-red-800/90 to-rose-700/90 border-red-300":"from-sky-700/90 to-cyan-600/90 border-sky-300"} text-white`,children:[c.jsxs("div",{className:"flex items-center",children:[c.jsx("span",{className:"text-lg mr-2",children:i.kind==="success"?"":i.kind==="error"?"":""}),c.jsx("span",{className:"ml-1",children:i.message})]}),c.jsx("button",{className:"btn btn-ghost btn-xs text-white/80 hover:text-white",onClick:()=>n(i.id),children:""})]},i.id))})]})}function MA(){const e=U.useContext(OA);if(!e)throw new Error("useToast must be used inside <ToastProvider>");return{success:t=>e.push("success",t),error:t=>e.push("error",t),info:t=>e.push("info",t)}}const pm=({children:e})=>{const{currentUser:t,isLoading:r}=ln();return r?c.jsx("div",{className:"flex justify-center items-center min-h-[60vh]",children:c.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-xmas-gold"})}):t?e?c.jsx(c.Fragment,{children:e}):c.jsx(JT,{}):c.jsx(C4,{to:"/login"})},sl=[{id:"first_snowflake",name:"First Snowflake",description:"You logged your very first watched Christmas movie.",hint:"Watch 1 movie.",icon:"",check:e=>e.totalWatched>=1},{id:"snowball_starter",name:"Snowball Starter",description:"You have started to build your festive watchlist.",hint:"Watch 5 movies.",icon:"",check:e=>e.totalWatched>=5},{id:"blizzard_binger",name:"Blizzard Binger",description:"You powered through a flurry of festive films.",hint:"Watch 20 movies.",icon:"",check:e=>e.totalWatched>=20},{id:"christmas_marathoner",name:"Christmas Marathoner",description:"You turned Christmas movies into a marathon event.",hint:"Watch 50 movies.",icon:"",check:e=>e.totalWatched>=50},{id:"twelve_days",name:"12 Days of Christmas",description:"You kept the festive streak going for 12 days.",hint:"Watch a movie daily for 12 days.",icon:"",check:e=>e.hasTwelveDayStreak},{id:"the_grinch",name:"The Grinch",description:"Not every movie can be a Christmas miracle.",hint:"Give a movie 1.",icon:"",check:e=>e.lowRatingAny},{id:"santas_favourite",name:"Santa's Favourite",description:"You found a film worthy of Santa himself.",hint:"Give a movie a perfect 10.",icon:"",check:e=>e.highRatingAny},{id:"the_critic",name:"The Critic",description:"You have opinions on a lot of movies.",hint:"Rate 20 movies.",icon:"",check:e=>e.totalRated>=20},{id:"nice_list",name:"Nice List",description:"You are generous with your festive ratings.",hint:"Keep your average rating above 5.",icon:"",check:e=>e.averageRating>5},{id:"classic_connoisseur",name:"Classic Connoisseur",description:"You appreciate the classics before Y2K.",hint:"Watch 5 movies released before 2000.",icon:"",check:e=>e.classicWatched>=5},{id:"animated_joy",name:"Animated Joy",description:"You love animated festive adventures.",hint:"Watch 5 animated Christmas movies.",icon:"",check:e=>e.animatedCount>=5},{id:"romcom_reindeer",name:"Rom-Com Reindeer",description:"You love a festive rom-com.",hint:"Watch 5 Christmas romance movies.",icon:"",check:e=>e.romanceCount>=5},{id:"decorator",name:"Decorator",description:"You have a whole row of favourites lit up.",hint:"Mark 10 movies as favourite.",icon:"",check:e=>e.favoriteCount>=10},{id:"elf_mode",name:"Elf Mode",description:"You keep coming back like a dedicated Christmas elf.",hint:"Use the app on 10 different days.",icon:"",check:e=>e.usageDistinctDays>=10},{id:"christmas_eve_watcher",name:"Christmas Eve Watcher",description:"You watched a movie on Christmas Eve.",hint:"Watch a movie on Dec 24.",icon:"",check:e=>e.hasChristmasEveWatch},{id:"new_years_cozy",name:"New Year's Cozy",description:"You started the year with a cozy movie.",hint:"Watch a movie on Jan 1.",icon:"",check:e=>e.hasNewYearsWatch}];function gw(e){if(!e)return null;if(e instanceof Date)return e;if(typeof e.toDate=="function")return e.toDate();if(typeof e=="object"&&"seconds"in e)return new Date(e.seconds*1e3);if(typeof e=="string"){const t=new Date(e);if(!isNaN(t.getTime()))return t}return null}function _6(e,t){let r=0,n=0,s=0,a=0,i=0,o=0,l=0,u=!1,f=!1;const d=new Set,m=new Set,p=new Set;for(const O of e){if(O.watched){r++;const v=gw(O.watchedDate);if(v){const S=v.toISOString().split("T")[0];p.add(S);const N=v.getMonth();v.getDate(),N===11&&d.add(S)}const T=t[O.movieId];T&&T.releaseDate&&T.releaseDate.substring(0,4)<"2000"&&a++,T&&T.genres&&T.genres.includes("Romance")&&i++,T&&T.genres&&T.genres.includes("Animation")&&o++}O.favorite&&l++,typeof O.rating=="number"&&(n++,s+=O.rating,O.rating<=1&&(u=!0),O.rating>=10&&(f=!0));const D=gw(O.updatedAt||O.addedAt);if(D){const v=D.toISOString().split("T")[0];m.add(v)}}const x=Array.from(p).map(O=>{const D=new Date(O+"T00:00:00Z");return Math.floor(D.getTime()/864e5)}).sort((O,D)=>O-D);let g=!1,_=0,k=null;for(const O of x){if(k===null||O===k+1?_+=1:O!==k&&(_=1),_>=12){g=!0;break}k=O}let E=!1,y=!1;for(const O of p){const D=new Date(O+"T00:00:00Z"),v=D.getMonth(),T=D.getDate();v===11&&T===24&&(E=!0),v===0&&T===1&&(y=!0)}const b=n>0?s/n:0;return{totalWatched:r,totalRated:n,averageRating:b,lowRatingAny:u,highRatingAny:f,classicWatched:a,romanceCount:i,animatedCount:o,favoriteCount:l,usageDistinctDays:m.size,decemberDistinctDays:d.size,hasChristmasEveWatch:E,hasNewYearsWatch:y,hasTwelveDayStreak:g}}async function wh(e){const t=await Mt(Tt(De,`users/${e}/movies`)),r=[],n=new Set;t.forEach(f=>{const d=f.data();r.push({id:f.id,...d}),d.movieId&&n.add(d.movieId)});const s={};if(n.size){const f=Array.from(n);for(const d of f){(await Mt(Tt(De,"movies"))).forEach(p=>{const x=p.data();s[p.id]={id:p.id,...x}});break}}const a=_6(r,s),i=Tt(De,`users/${e}/achievements`),o=await Mt(i),l=new Set;o.forEach(f=>l.add(f.id));const u=[];for(const f of sl)!l.has(f.id)&&f.check(a)&&(u.push(f.id),await Zn(dt(De,`users/${e}/achievements`,f.id),{unlockedAt:new Date,seen:!1}));return u}const w6=()=>{const{currentUser:e}=ln(),[t,r]=U.useState(new Date),[n,s]=U.useState(null),[a,i]=U.useState(null),o=sl.length;U.useEffect(()=>{const f=setInterval(()=>r(new Date),1e3);return()=>clearInterval(f)},[]);const l=U.useMemo(()=>{const f=t.getFullYear(),d=new Date(f,11,25,0,0,0);return t>d?new Date(f+1,11,25,0,0,0):d},[t]),u=U.useMemo(()=>{const f=l.getTime()-t.getTime(),d=Math.max(0,Math.floor(f/1e3)),m=Math.floor(d/86400),p=Math.floor(d%86400/3600),x=Math.floor(d%3600/60),g=d%60;return{days:m,hours:p,minutes:x,seconds:g}},[t,l]);return U.useEffect(()=>{const f=dt(De,"stats","global"),d=bj(f,m=>{const p=m.data();s(typeof(p==null?void 0:p.watchedTotal)=="number"?p.watchedTotal:0)});return()=>d()},[]),U.useEffect(()=>{if(!e){i(null);return}(async()=>{try{const d=Tt(De,`users/${e.uid}/achievements`),m=await Mt(d);i(m.size)}catch(d){console.error("Error loading achievements count",d),i(null)}})()},[e]),c.jsxs("div",{className:"container mx-auto px-4 py-8",children:[c.jsxs("div",{className:"text-center mb-12",children:[c.jsx("h1",{className:"font-christmas text-5xl md:text-7xl text-xmas-line mb-4",children:"My Christmas Movies"}),c.jsx("p",{className:"text-xl md:text-2xl text-xmas-snow mb-8",children:"Track, rate, and discover your favourite Christmas movies!"}),c.jsx("div",{className:"flex flex-col md:flex-row justify-center gap-6 mb-4 md:mb-6",children:e?c.jsxs(c.Fragment,{children:[c.jsxs(Ge,{to:"/movies",className:"btn btn-primary btn-lg text-xl px-8 py-3 rounded-md shadow-lg hover:shadow-xl transition-all duration-300 border border-xmas-gold border-opacity-30",children:[c.jsx("i",{className:"fas fa-film mr-2"})," My Movies"]}),c.jsxs(Ge,{to:"/random",className:"btn btn-primary btn-lg text-xl px-8 py-3 rounded-md shadow-lg hover:shadow-xl transition-all duration-300 border border-xmas-gold border-opacity-30",children:[c.jsx("i",{className:"fas fa-random mr-2"})," Random Movie"]}),c.jsxs(Ge,{to:"/achievements",className:"btn btn-primary btn-lg text-xl px-8 py-3 rounded-md shadow-lg hover:shadow-xl transition-all duration-300 border border-xmas-gold border-opacity-30",children:[c.jsx("i",{className:"fas fa-trophy mr-2"})," Achievements"]})]}):c.jsxs(Ge,{to:"/login",className:"btn btn-primary btn-lg text-xl px-8 py-3 rounded-md shadow-lg hover:shadow-xl transition-all duration-300 border border-xmas-gold border-opacity-30",children:[c.jsx("i",{className:"fas fa-sign-in-alt mr-2"})," Sign In"]})})]}),c.jsx("div",{className:"w-full max-w-4xl mx-auto mb-8",children:c.jsx("div",{className:"h-px bg-gradient-to-r from-transparent via-xmas-gold to-transparent"})}),c.jsxs("div",{className:"bg-xmas-card rounded-lg shadow-xl p-6 mb-12 border border-xmas-gold border-opacity-30 relative",children:[c.jsx("h2",{className:"font-christmas text-3xl text-xmas-gold text-center mb-6",children:"Countdown to Christmas"}),c.jsxs("div",{className:"grid md:grid-cols-2 gap-6 items-stretch",children:[c.jsxs("div",{className:"bg-xmas-card bg-opacity-70 p-6 rounded-lg shadow-md border-l-2 border-xmas-line flex flex-col items-center justify-center",children:[c.jsxs("div",{className:"text-5xl md:text-6xl font-bold text-xmas-line mb-2",children:[u.days,"d ",u.hours,"h ",u.minutes,"m ",u.seconds,"s"]}),c.jsx("p",{className:"text-xmas-text text-opacity-80",children:"until Christmas Day"})]}),c.jsxs("div",{className:"bg-xmas-card bg-opacity-70 p-6 rounded-lg shadow-md border-l-2 border-xmas-gold flex flex-col items-center justify-center",children:[c.jsx("div",{className:"text-5xl md:text-6xl font-bold text-xmas-gold mb-2",children:n??""}),c.jsx("p",{className:"text-xmas-text text-opacity-80 text-center",children:"total movies watched"})]})]})]}),c.jsxs("div",{className:"bg-xmas-card rounded-lg shadow-xl p-6 mb-12 border border-xmas-gold border-opacity-20 snow-accumulation snow-accumulation-slow relative",children:[c.jsx("h2",{className:"font-christmas text-3xl text-xmas-line mb-6 text-center",children:"Features"}),c.jsxs("div",{className:"grid md:grid-cols-4 gap-6",children:[c.jsxs("div",{className:"bg-xmas-card bg-opacity-70 p-6 rounded-lg shadow-md border-l-2 border-xmas-line",children:[c.jsx("div",{className:"text-3xl text-xmas-gold mb-4 text-center",children:c.jsx("i",{className:"fas fa-search"})}),c.jsx("h3",{className:"font-christmas text-xl text-center mb-3",children:"Find Movies"}),c.jsx("p",{className:"text-center text-xmas-text text-opacity-80",children:"Search and discover Christmas movies using OMDb data"})]}),c.jsxs("div",{className:"bg-xmas-card bg-opacity-70 p-6 rounded-lg shadow-md border-l-2 border-xmas-gold",children:[c.jsx("div",{className:"text-3xl text-xmas-gold mb-4 text-center",children:c.jsx("i",{className:"fas fa-star"})}),c.jsx("h3",{className:"font-christmas text-xl text-center mb-3",children:"Rate & Review"}),c.jsx("p",{className:"text-center text-xmas-text text-opacity-80",children:"Keep track of movies you've watched and rate them"})]}),c.jsxs("div",{className:"bg-xmas-card bg-opacity-70 p-6 rounded-lg shadow-md border-l-2 border-xmas-line",children:[c.jsx("div",{className:"text-3xl text-xmas-gold mb-4 text-center",children:c.jsx("i",{className:"fas fa-random"})}),c.jsx("h3",{className:"font-christmas text-xl text-center mb-3",children:"Random Picker"}),c.jsx("p",{className:"text-center text-xmas-text text-opacity-80",children:"Can't decide what to watch? Let our random movie picker help!"})]}),c.jsxs("div",{className:"bg-xmas-card bg-opacity-70 p-6 rounded-lg shadow-md border-l-2 border-xmas-line",children:[c.jsx("div",{className:"text-3xl text-xmas-gold mb-4 text-center",children:c.jsx("i",{className:"fas fa-trophy"})}),c.jsx("h3",{className:"font-christmas text-xl text-center mb-3",children:"Achievements"}),c.jsx("p",{className:"text-center text-xmas-text text-opacity-80 mb-2",children:"Unlock festive badges as you watch, rate, and explore."}),e&&c.jsx("p",{className:"text-center text-xmas-text text-opacity-80 font-medium",children:typeof a=="number"?`${a} / ${o} unlocked`:`${o} to discover`})]})]})]}),c.jsx("div",{className:"bg-xmas-card rounded-lg shadow-xl p-6 mb-12 border border-xmas-gold border-opacity-30 snow-accumulation snow-accumulation-fast relative",children:c.jsxs("div",{className:"mb-6 text-center",children:[c.jsxs("h2",{className:"font-christmas text-3xl md:text-4xl text-xmas-gold inline-block relative",children:[c.jsx("span",{className:"relative z-10",children:"Create Your Collection"}),c.jsx("span",{className:"absolute -bottom-2 left-0 right-0 h-1 bg-xmas-gold opacity-30 rounded-full"})]}),c.jsx("p",{className:"mt-4 mb-6",children:"Add movies to your collection and rate them"}),e?c.jsxs(Ge,{to:"/import",className:"btn btn-primary",children:[c.jsx("i",{className:"fas fa-file-import mr-2"})," Add Movies"]}):c.jsxs(Ge,{to:"/login",className:"btn btn-primary",children:[c.jsx("i",{className:"fas fa-sign-in-alt mr-2"})," Sign In to Add"]})]})}),c.jsx("div",{className:"w-full max-w-4xl mx-auto mb-8",children:c.jsx("div",{className:"h-px bg-gradient-to-r from-transparent via-xmas-gold to-transparent"})}),c.jsxs("footer",{className:"text-center text-xmas-mute mt-12 pb-8 space-y-4",children:[c.jsxs("p",{children:[" ",new Date().getFullYear()," Christmas Movie Database"]}),c.jsxs("div",{className:"flex flex-col items-center justify-center gap-2 text-xs md:text-sm text-xmas-mute/80",children:[c.jsx("a",{href:"https://www.omdbapi.com/",target:"_blank",rel:"noopener noreferrer",className:"link link-hover",children:"OMDb API"}),c.jsx("p",{className:"max-w-xl px-4 text-center",children:"This product uses the OMDb API but is not endorsed or certified by OMDb."})]})]})]})},E6=()=>{const e=ts(),{currentUser:t,isLoading:r,error:n,signInWithGoogle:s}=ln();U.useEffect(()=>{t&&!r&&e("/")},[t,r,e]);const a=async()=>{try{await s()}catch(i){console.error("Login failed:",i)}};return r?c.jsx("div",{className:"flex justify-center items-center min-h-[60vh]",children:c.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-xmas-gold"})}):c.jsx("div",{className:"container mx-auto px-4 py-12",children:c.jsxs("div",{className:"max-w-md mx-auto",children:[c.jsxs("div",{className:"text-center mb-8",children:[c.jsx("h1",{className:"font-christmas text-4xl text-xmas-line mb-2",children:"Christmas Movie Database"}),c.jsx("p",{className:"text-xmas-mute",children:"Sign in to manage your Christmas movie collection"})]}),c.jsxs("div",{className:"bg-xmas-card rounded-lg shadow-lg p-6",children:[n&&c.jsx("div",{className:"bg-error bg-opacity-10 border-l-4 border-error p-4 mb-6 rounded",children:c.jsx("p",{className:"text-error",children:n})}),c.jsxs("div",{className:"text-center mb-6",children:[c.jsx("p",{className:"mb-4",children:"Sign in with your Google account to access your Christmas movie collection."}),c.jsx("p",{className:"text-sm text-xmas-mute mb-6",children:"Track, rate, and discover Christmas movies!"}),c.jsxs("button",{onClick:a,className:"btn btn-primary w-full flex items-center justify-center gap-2",children:[c.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 48 48",children:[c.jsx("path",{fill:"#FFC107",d:`M43.611,20.083H42V20H24v8h11.303c-1.649,4.657-6.08,8-11.303,8c-6.627,0-12-5.373-12-12\r
                  s5.373-12,12-12c3.059,0,5.842,1.154,7.961,3.039l5.657-5.657C34.046,6.053,29.268,4,24,4C12.955,4,4,12.955,4,24s8.955,20,20,20\r
                  s20-8.955,20-20C44,22.659,43.862,21.35,43.611,20.083z`}),c.jsx("path",{fill:"#FF3D00",d:`M6.306,14.691l6.571,4.819C14.655,15.108,18.961,12,24,12c3.059,0,5.842,1.154,7.961,3.039\r
                  l5.657-5.657C34.046,6.053,29.268,4,24,4C16.318,4,9.656,8.337,6.306,14.691z`}),c.jsx("path",{fill:"#4CAF50",d:`M24,44c5.166,0,9.86-1.977,13.409-5.192l-6.19-5.238C29.211,35.091,26.715,36,24,36\r
                  c-5.202,0-9.619-3.317-11.283-7.946l-6.522,5.025C9.505,39.556,16.227,44,24,44z`}),c.jsx("path",{fill:"#1976D2",d:`M43.611,20.083H42V20H24v8h11.303c-0.792,2.237-2.231,4.166-4.087,5.571\r
                  c0.001-0.001,0.002-0.001,0.003-0.002l6.19,5.238C36.971,39.205,44,34,44,24C44,22.659,43.862,21.35,43.611,20.083z`})]}),"Sign in with Google"]})]})]}),c.jsx("div",{className:"text-center mt-6",children:c.jsx("p",{className:"text-sm text-xmas-mute",children:"By signing in, you agree to our Terms of Service and Privacy Policy."})})]})})},jA=e=>e.toLowerCase().replace(/[^\w\s-]/g,"").replace(/\s+/g,"-").replace(/-+/g,"-").trim(),mv=(e,t)=>`/movies/${jA(e)}?id=${t}`,LA=e=>new URLSearchParams(e).get("id"),T6=5*60*1e3;let hs=null;const k6=(e,t,r)=>{hs={userMovies:t,movies:r,timestamp:Date.now(),userId:e}},S6=e=>!hs||hs.userId!==e||Date.now()-hs.timestamp>T6?null:{userMovies:hs.userMovies,movies:hs.movies},UA=()=>{hs=null},A6=(e,t,r)=>{hs&&hs.userId===e&&(hs.userMovies[t]=r,hs.timestamp=Date.now())},Ju=async(e,t,r)=>{const n=dt(De,`users/${e}/movies`,t);if((await En(n)).exists()){const o={...r,updatedAt:new Date};r.rating===null&&(o.rating=null),r.watchedDate===null&&(o.watchedDate=null),r.review===null&&(o.review=null),await Fn(n,o)}else{const o={userId:e,movieId:t,watched:r.watched||!1,favorite:r.favorite||!1,addedAt:new Date,updatedAt:new Date,...r};await Zn(n,o)}const a=await En(n),i={id:a.id,...a.data()};return A6(e,t,i),i},dd=async(e,t)=>{const r=dt(De,`users/${e}/movies`,t),n=await En(r);return n.exists()?{id:n.id,...n.data()}:null},VA=async e=>{const t=Tt(De,`users/${e}/movies`),r=await Mt(t),n=[];return r.forEach(s=>{n.push({id:s.id,...s.data()})}),n},b6=async(e,t)=>{const r=dt(De,`users/${e}/movies`,t);await Aj(r),UA()},Zu=async e=>{const t=S6(e);if(t)return t;const r=await VA(e),n={},s=[];r.forEach(o=>{n[o.movieId]=o,s.push(o.movieId)});const a=[];if(s.length>0)for(let l=0;l<s.length;l+=10){const f=s.slice(l,l+10).map(m=>En(dt(De,"movies",m)).then(p=>p.exists()?{id:p.id,...p.data()}:null).catch(p=>(console.error(`Error fetching movie ${m}:`,p),null))),d=await Promise.all(f);a.push(...d.filter(Boolean))}const i={userMovies:n,movies:a};return k6(e,n,a),i},I6="https://api.themoviedb.org/3",N6="https://image.tmdb.org/t/p/w500";function BA(e,t){if(!e)return e;const r="https://image.tmdb.org/t/p/";if(!e.startsWith(r))return e;const n=e.substring(r.length),s=n.indexOf("/");return s===-1||n.substring(0,s)===t?e:r+t+n.substring(s)}const C6=async(e,t)=>{if(!t)throw new Error("TMDb API key is required.");const r=`${I6}/movie/${e}/images?api_key=${encodeURIComponent(t)}&include_image_language=en,null`,n=await fetch(r);if(!n.ok)throw new Error(`TMDb API error: ${n.status}`);const i=((await n.json()).posters||[]).filter(o=>!o.iso_639_1||o.iso_639_1==="en");return i.sort((o,l)=>l.vote_count-o.vote_count),i.map(o=>({url:`${N6}${o.file_path}`,iso_639_1:o.iso_639_1??null,width:o.width,height:o.height,voteAverage:o.vote_average,voteCount:o.vote_count}))},ds=e=>{if(!e)return null;const t=e.trim();if(!t)return null;const r=t.match(/(\d{4})/);if(!r)return null;const n=parseInt(r[1],10);return Number.isFinite(n)?String(n):null},R6=()=>{const{currentUser:e,userProfile:t}=ln(),r=MA(),[n,s]=U.useState([]),[a,i]=U.useState({}),[o,l]=U.useState(!0),[u,f]=U.useState(!0),[d,m]=U.useState(null),[p,x]=U.useState("all"),[g,_]=U.useState({option:"title",direction:"asc"}),[k,E]=U.useState(""),[y,b]=U.useState("all"),[O,D]=U.useState(!1),[v,T]=U.useState(!1),[S,N]=U.useState(""),[C,R]=U.useState(""),[F,oe]=U.useState(""),[te,de]=U.useState(!1),ae=Ts();ts();const X=L=>L.toLowerCase().trim().replace(/[^a-z0-9]+/g,"-").replace(/^-+|-+$/g,""),H=async()=>{if(e)try{de(!0);const L=dt(De,"users",e.uid),J={isPublicWatchlist:v,publicWatchlistName:S||null,publicWatchlistTagline:C||null,publicWatchlistSlug:F||null};if(v&&!J.publicWatchlistSlug){const fe=S||(t==null?void 0:t.displayName)||"xmas-watchlist";J.publicWatchlistSlug=X(fe),oe(J.publicWatchlistSlug)}if(await Fn(L,J),v&&J.publicWatchlistSlug){const fe=dt(De,"publicProfiles",J.publicWatchlistSlug);await Zn(fe,{userId:e.uid,displayName:(t==null?void 0:t.displayName)||"",photoURL:(t==null?void 0:t.photoURL)||null,publicWatchlistName:J.publicWatchlistName||null,publicWatchlistTagline:J.publicWatchlistTagline||null,publicWatchlistSlug:J.publicWatchlistSlug,isPublicWatchlist:!0},{merge:!0})}else if(!v&&F){const fe=dt(De,"publicProfiles",F);await Zn(fe,{userId:e.uid,isPublicWatchlist:!1,publicWatchlistName:null,publicWatchlistTagline:null},{merge:!0})}r.success("Sharing settings saved")}catch(L){console.error("Error saving sharing settings:",L),r.error("Failed to save sharing settings")}finally{de(!1)}},Z=async()=>{if(F)try{const J=`${window.location.origin}/u/${F}`;await navigator.clipboard.writeText(J),r.success("Link copied to clipboard")}catch(L){console.error("Failed to copy link",L),r.error("Failed to copy link")}};U.useEffect(()=>{const L=new URLSearchParams(ae.search),J=L.get("q")||"",fe=L.get("field")||"all";J!==k&&E(J),fe!==y&&b(fe)},[ae.search]),U.useEffect(()=>{t&&(T(!!t.isPublicWatchlist),N(t.publicWatchlistName||""),R(t.publicWatchlistTagline||""),oe(t.publicWatchlistSlug||""))},[t]),U.useEffect(()=>{v&&S&&(F||oe(X(S)))},[v,S,F]),U.useEffect(()=>{(async()=>{if(e)try{f(!0);const{userMovies:J,movies:fe}=await Zu(e.uid);i(J),s(fe)}catch(J){console.error("Error fetching movies:",J),m("Failed to load movies")}finally{f(!1),l(!1)}})()},[e,ae.key]);const Y=L=>{_(J=>J.option===L?{option:L,direction:J.direction==="asc"?"desc":"asc"}:{option:L,direction:"asc"})},M=U.useCallback(L=>{var pe;if(!k.trim())return!0;const J=k.toLowerCase().trim(),fe=J.split(",").map(Pe=>Pe.trim()).filter(Boolean),we=Pe=>L.cast&&L.cast.some(G=>G.toLowerCase().includes(Pe)),ge=a[L.id];switch(y){case"title":return L.title.toLowerCase().includes(J)||L.sortTitle&&L.sortTitle.toLowerCase().includes(J)||L.originalTitle&&L.originalTitle.toLowerCase().includes(J);case"year":return!!L.releaseDate&&!!((pe=ds(L.releaseDate))!=null&&pe.includes(J));case"cast":return fe.length?fe.some(Pe=>we(Pe)):we(J);case"all":default:{const Pe=L.releaseDate&&ds(L.releaseDate);return L.title.toLowerCase().includes(J)||L.sortTitle&&L.sortTitle.toLowerCase().includes(J)||L.originalTitle&&L.originalTitle.toLowerCase().includes(J)||Pe&&Pe.includes(J)||L.overview&&L.overview.toLowerCase().includes(J)||L.genres&&L.genres.some(G=>G.toLowerCase().includes(J))||L.directors&&L.directors.some(G=>G.toLowerCase().includes(J))||L.cast&&L.cast.some(G=>G.toLowerCase().includes(J))||ge&&ge.review&&ge.review.toLowerCase().includes(J)}}},[k,y,a]),q=U.useMemo(()=>{if(u)return[];l(!0);const L=n.filter(J=>{const fe=a[J.id];let we=!0;switch(p){case"watched":we=fe&&fe.watched;break;case"unwatched":we=!fe||!fe.watched;break;case"favorites":we=fe&&fe.favorite;break}return we&&M(J)}).sort((J,fe)=>{const we=a[J.id],ge=a[fe.id],pe=g.direction==="asc"?1:-1;switch(g.option){case"title":const Pe=J.sortTitle||J.title,G=fe.sortTitle||fe.title;return Pe.localeCompare(G)*pe;case"year":{const Se=J.releaseDate&&ds(J.releaseDate),yt=fe.releaseDate&&ds(fe.releaseDate),Qt=Se?parseInt(Se,10):0,dr=yt?parseInt(yt,10):0;return(Qt-dr)*pe}case"rating":const Xe=(we==null?void 0:we.rating)||0,Ve=(ge==null?void 0:ge.rating)||0;return(Xe-Ve)*pe;case"watched":const Ze=we!=null&&we.watched?1:0,Oe=ge!=null&&ge.watched?1:0;return(Ze-Oe)*pe;default:return 0}});return l(!1),L},[n,a,p,g,k,y,u]),K=q;return u?c.jsx("div",{className:"flex justify-center items-center min-h-[60vh]",children:c.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-xmas-gold"})}):c.jsxs("div",{className:"container mx-auto px-2 sm:px-4 py-4 sm:py-8",children:[c.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-center mb-4 sm:mb-8 gap-3",children:[c.jsx("h1",{className:"font-christmas text-2xl sm:text-3xl md:text-4xl text-xmas-line",children:"My Christmas Movies"}),c.jsxs("div",{className:"flex gap-2 w-full sm:w-auto justify-center",children:[c.jsxs(Ge,{to:"/random",className:"btn btn-primary btn-sm sm:btn-md",children:[c.jsx("i",{className:"fas fa-random mr-1 sm:mr-2"})," ",c.jsx("span",{className:"hidden xs:inline",children:"Random Movie"}),c.jsx("span",{className:"xs:hidden",children:"Random"})]}),c.jsxs(Ge,{to:"/import",className:"btn btn-primary btn-sm sm:btn-md",children:[c.jsx("i",{className:"fas fa-file-import mr-1 sm:mr-2"})," ",c.jsx("span",{className:"hidden xs:inline",children:"Add Movies"}),c.jsx("span",{className:"xs:hidden",children:"Import"})]}),c.jsxs("button",{type:"button",className:"btn btn-primary btn-sm sm:btn-md",onClick:()=>D(!0),children:[c.jsx("i",{className:"fas fa-share-alt mr-1 sm:mr-2"}),c.jsx("span",{className:"hidden xs:inline",children:"Share"}),c.jsx("span",{className:"xs:hidden",children:"Share"})]})]})]}),d&&c.jsxs("div",{className:"alert alert-error mb-6",children:[c.jsx("i",{className:"fas fa-exclamation-circle mr-2"}),c.jsx("span",{children:d})]}),c.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 mb-3",children:[c.jsxs("div",{className:"relative flex-grow",children:[c.jsx("div",{className:"absolute inset-y-0 left-0 pl-2 flex items-center pointer-events-none",children:c.jsx("i",{className:"fas fa-search text-gray-400"})}),c.jsx("input",{type:"text",className:"input input-bordered input-sm sm:input-md w-full pl-8 pr-8",placeholder:"   Search movies...",value:k,onChange:L=>E(L.target.value)}),k&&c.jsx("button",{className:"absolute inset-y-0 right-0 pr-2 flex items-center",onClick:()=>E(""),children:c.jsx("i",{className:"fas fa-times text-gray-400 hover:text-gray-600"})})]}),c.jsxs("select",{className:"select select-bordered select-sm sm:select-md w-full sm:w-36",value:y,onChange:L=>b(L.target.value),children:[c.jsx("option",{value:"all",children:"All Fields"}),c.jsx("option",{value:"title",children:"Title Only"}),c.jsx("option",{value:"year",children:"Year Only"}),c.jsx("option",{value:"cast",children:"Cast Only"})]})]}),c.jsxs("div",{className:"tabs tabs-boxed mb-3 text-xs sm:text-sm overflow-x-auto",children:[c.jsx("button",{className:`tab ${p==="all"?"tab-active":""}`,onClick:()=>x("all"),children:"All Movies"}),c.jsx("button",{className:`tab ${p==="watched"?"tab-active":""}`,onClick:()=>x("watched"),children:"Watched"}),c.jsx("button",{className:`tab ${p==="unwatched"?"tab-active":""}`,onClick:()=>x("unwatched"),children:"Watch"}),c.jsxs("button",{className:`tab ${p==="favorites"?"tab-active":""}`,onClick:()=>x("favorites"),children:[c.jsx("span",{className:"hidden sm:inline",children:"Favourites"}),c.jsx("span",{className:"sm:hidden",children:"Favs"})]})]}),c.jsxs("div",{className:"flex flex-wrap items-center gap-1 mb-3 bg-xmas-card bg-opacity-50 p-2 rounded-lg overflow-x-auto",children:[c.jsx("span",{className:"text-xs sm:text-sm font-medium mr-1",children:"Sort:"}),c.jsxs("div",{className:"flex flex-nowrap gap-1 overflow-x-auto",children:[c.jsxs("button",{className:`btn btn-xs ${g.option==="title"?"btn-primary":"btn-ghost"}`,onClick:()=>Y("title"),children:["Title ",g.option==="title"&&c.jsx("i",{className:`fas fa-sort-${g.direction==="asc"?"up":"down"} ml-1`})]}),c.jsxs("button",{className:`btn btn-xs ${g.option==="year"?"btn-primary":"btn-ghost"}`,onClick:()=>Y("year"),children:["Year ",g.option==="year"&&c.jsx("i",{className:`fas fa-sort-${g.direction==="asc"?"up":"down"} ml-1`})]}),c.jsxs("button",{className:`btn btn-xs ${g.option==="rating"?"btn-primary":"btn-ghost"}`,onClick:()=>Y("rating"),children:["Rating ",g.option==="rating"&&c.jsx("i",{className:`fas fa-sort-${g.direction==="asc"?"up":"down"} ml-1`})]}),c.jsxs("button",{className:`btn btn-xs ${g.option==="watched"?"btn-primary":"btn-ghost"}`,onClick:()=>Y("watched"),children:[c.jsx("span",{className:"hidden sm:inline",children:"Watched Status"}),c.jsx("span",{className:"sm:hidden",children:"Watched"}),g.option==="watched"&&c.jsx("i",{className:`fas fa-sort-${g.direction==="asc"?"up":"down"} ml-1`})]})]})]}),c.jsxs("div",{className:"flex flex-col xs:flex-row justify-between items-start xs:items-center mb-3 text-xs sm:text-sm",children:[c.jsxs("div",{children:[c.jsx("span",{className:"font-medium",children:q.length})," ",q.length===1?"movie":"movies"," found",k&&c.jsxs("span",{className:"ml-1 text-xmas-mute",children:["for: ",c.jsxs("span",{className:"font-medium",children:['"',k,'"']})]})]}),g.option&&c.jsxs("div",{className:"text-xmas-mute",children:["Sorted by ",c.jsx("span",{className:"font-medium",children:g.option})," (",g.direction==="asc"?"asc":"desc",")"]})]}),o&&!u&&c.jsx("div",{className:"flex justify-center items-center py-4",children:c.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-t-2 border-b-2 border-xmas-gold"})}),q.length===0?c.jsxs("div",{className:"bg-xmas-card p-8 rounded-lg text-center",children:[c.jsx("h3",{className:"text-xl mb-4",children:"No movies found"}),c.jsx("p",{className:"mb-4",children:p==="all"?"You haven't added any Christmas movies yet.":`You don't have any ${p} Christmas movies.`}),c.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 justify-center",children:[c.jsxs(Ge,{to:"/import",className:"btn btn-primary",children:[c.jsx("i",{className:"fas fa-file-import mr-2"})," Add Movies"]}),n.length>0&&c.jsxs(Ge,{to:"/random",className:"btn btn-primary",children:[c.jsx("i",{className:"fas fa-random mr-2"})," Random Movie"]})]})]}):c.jsx("div",{className:"grid grid-cols-3 sm:grid-cols-4 md:grid-cols-5 lg:grid-cols-6 gap-2 sm:gap-3",children:K.map(L=>{const J=a[L.id],fe=(J==null?void 0:J.posterUrlOverride)||null,ge=(fe==null?void 0:fe.includes("fanart.tv"))?L.posterUrl:fe||L.posterUrl,pe=BA(ge||"","w185");return c.jsx(Ge,{to:mv(L.title,L.id),state:{from:"movies"},className:"block transition-transform hover:scale-[1.02] hover:shadow-xl",children:c.jsxs("div",{className:"relative rounded-lg overflow-hidden bg-xmas-card shadow-md h-full flex flex-col",children:[c.jsxs("div",{className:"relative",children:[ge?c.jsx("img",{src:pe,alt:L.title,className:"w-full h-auto object-cover",style:{aspectRatio:"2/3"},loading:"lazy"}):c.jsx("div",{className:"w-full flex items-center justify-center bg-gray-800",style:{aspectRatio:"2/3"},children:c.jsx("i",{className:"fas fa-film text-2xl text-gray-500"})}),J&&J.watched&&c.jsx("div",{className:"absolute top-1 right-1 bg-primary rounded-full p-1 shadow-md",children:c.jsx("i",{className:"fas fa-check text-xs text-white"})}),J&&J.favorite&&c.jsx("div",{className:"absolute top-1 left-1 text-yellow-400 drop-shadow-md",children:c.jsx("i",{className:"fas fa-star text-sm"})})]}),c.jsxs("div",{className:"p-1 sm:p-2 flex-grow flex flex-col",children:[c.jsx("h3",{className:"text-xs sm:text-sm font-medium line-clamp-2",children:L.title}),c.jsxs("div",{className:"flex justify-between items-center mt-1",children:[c.jsx("p",{className:"text-xs text-gray-400",children:L.releaseDate&&ds(L.releaseDate)}),J&&J.rating&&c.jsxs("div",{className:"flex items-center",children:[c.jsx("span",{className:"text-yellow-400 mr-0.5",children:c.jsx("i",{className:"fas fa-star text-xs"})}),c.jsx("span",{className:"text-xs",children:J.rating})]})]})]})]})},L.id)})}),O&&c.jsxs("dialog",{className:"modal modal-open",children:[c.jsxs("div",{className:"modal-box max-w-lg",children:[c.jsx("h3",{className:"font-bold text-lg mb-2",children:"Share your watchlist"}),c.jsx("p",{className:"text-sm mb-4",children:"Create a shareable page that shows your watched Christmas movies, ratings and vibes."}),c.jsx("div",{className:"form-control mb-4",children:c.jsxs("label",{className:"label cursor-pointer",children:[c.jsx("span",{className:"label-text",children:"Make my watchlist public"}),c.jsx("input",{type:"checkbox",className:"toggle toggle-primary",checked:v,onChange:L=>T(L.target.checked)})]})}),c.jsxs("div",{className:"grid grid-cols-1 gap-3",children:[c.jsxs("div",{className:"form-control",children:[c.jsx("label",{className:"label",children:c.jsx("span",{className:"label-text",children:"Public display name"})}),c.jsx("input",{type:"text",className:"input input-bordered input-sm sm:input-md",value:S,onChange:L=>N(L.target.value),placeholder:"My Xmas Movies"})]}),c.jsxs("div",{className:"form-control",children:[c.jsx("label",{className:"label",children:c.jsx("span",{className:"label-text",children:"Tagline / bio (optional)"})}),c.jsx("input",{type:"text",className:"input input-bordered input-sm sm:input-md",value:C,onChange:L=>R(L.target.value),placeholder:"Only the coziest Xmas movies allowed"})]}),F&&c.jsxs("div",{className:"mt-1 text-xs text-xmas-mute",children:["Your public link: ",c.jsxs("span",{className:"font-mono",children:["/u/",F]})]})]}),c.jsxs("div",{className:"modal-action flex flex-wrap gap-2 justify-between",children:[c.jsxs("div",{className:"flex gap-2",children:[c.jsxs("button",{className:"btn btn-primary btn-sm",onClick:H,disabled:te,children:[te&&c.jsx("span",{className:"loading loading-spinner loading-xs mr-1"}),"Save"]}),c.jsxs("button",{type:"button",className:"btn btn-outline btn-sm",onClick:Z,disabled:!F,children:[c.jsx("i",{className:"fas fa-link mr-2"}),"Copy link"]})]}),c.jsx("button",{type:"button",className:"btn btn-ghost btn-sm",onClick:()=>D(!1),children:"Close"})]})]}),c.jsx("form",{method:"dialog",className:"modal-backdrop",onClick:()=>D(!1),children:c.jsx("button",{children:"close"})})]})]})},Jp=dt(De,"stats","global");async function P6(){(await En(Jp)).exists()||await Zn(Jp,{watchedTotal:0,updatedAt:new Date},{merge:!0})}async function D6(e){await P6(),await Fn(Jp,{watchedTotal:Nj(e),updatedAt:new Date})}const F6=[{id:"heartwarming",label:"Heartwarming",emoji:"",type:"positive"},{id:"very_christmassy",label:"Very Christmassy",emoji:"",type:"positive"},{id:"snowy",label:"Snowy Setting",emoji:"",type:"positive"},{id:"funny",label:"Funny",emoji:"",type:"positive"},{id:"cheesy",label:"Cheesy (Good Way)",emoji:"",type:"positive"},{id:"romantic",label:"Romantic",emoji:"",type:"positive"},{id:"family_friendly",label:"Family Friendly",emoji:"",type:"positive"},{id:"background",label:"Good Background Watch",emoji:"",type:"positive"},{id:"tearjerker",label:"Emotional",emoji:"",type:"positive"},{id:"rewatch",label:"Would Rewatch",emoji:"",type:"positive"}],O6=[{id:"slow",label:"Slow Pacing",emoji:"",type:"negative"},{id:"boring",label:"A Bit Boring",emoji:"",type:"negative"},{id:"low_christmas",label:"Low Xmas Vibes",emoji:"",type:"negative"},{id:"weak_chemistry",label:"Weak Chemistry",emoji:"",type:"negative"},{id:"confusing",label:"Confusing Plot",emoji:"",type:"negative"},{id:"too_long",label:"Too Long",emoji:"",type:"negative"},{id:"cringey",label:"Cringey",emoji:"",type:"negative"},{id:"fake_snow",label:"Fake Snow",emoji:"",type:"negative"},{id:"hammy",label:"Hammy",emoji:"",type:"negative"}],M6={heartwarming:"heartwarming",very_christmassy:"full of Christmas vibes",snowy:"with a lovely snowy setting",funny:"with some funny moments",cheesy:"a bit cheesy in a good way",romantic:"with sweet romantic moments",family_friendly:"very family friendly",background:"great as a cosy background watch",tearjerker:"quite emotional at times",rewatch:"something I'd happily rewatch"},j6={slow:"quite slow in places",boring:"a bit boring overall",low_christmas:"lighter on Christmas vibes than expected",weak_chemistry:"with weak chemistry between the leads",confusing:"a bit confusing at times",too_long:"longer than it needed to be",cringey:"a bit cringey in parts",fake_snow:"with fake snow",hammy:"hammy overacting"};function L6(e){return!e||e<=0?"An easy-going Christmas movie.":e>=9?"Absolutely loved this Christmas movie.":e>=8?"Really enjoyed this festive watch.":e>=7?"A good Christmas movie I liked overall.":e>=6?"A decent cosy watch with some nice moments.":e>=5?"An okay Christmas movie, but nothing special.":e>=3?"Not really my thing, it had a few issues.":"I didn't enjoy this Christmas movie very much."}function xw(e){if(e.length===0)return"";if(e.length===1)return e[0];const t=e[e.length-1];return`${e.slice(0,-1).join(", ")} and ${t}`}function U6(e){const t=e.map(s=>M6[s]).filter(Boolean),r=e.map(s=>j6[s]).filter(Boolean);let n="";return t.length&&(n+=` It felt ${xw(t)}.`),r.length&&(n+=` However, it was ${xw(r)}.`),n}const V6=({rating:e,initialTags:t=[],initialAutoReview:r="",onChange:n})=>{const[s,a]=U.useState(t),[i,o]=U.useState(r);U.useEffect(()=>{a(t)},[t.join("|")]),U.useEffect(()=>{o(r)},[r]);const l=d=>{a(m=>m.includes(d)?m.filter(p=>p!==d):[...m,d])},u=()=>{const d=L6(e),m=U6(s),p=(d+m).trim();o(p),n&&n({tags:s,autoReview:p})},f=d=>s.includes(d);return c.jsxs("div",{className:"mt-4",children:[c.jsxs("div",{className:"flex items-center justify-between mb-2",children:[c.jsx("h3",{className:"text-lg font-semibold text-primary",children:"Quick Vibe Review"}),c.jsx("span",{className:"text-xs opacity-80",children:"Pick a few that fit, then generate."})]}),c.jsx("p",{className:"text-xs mb-1 opacity-80",children:"What worked?"}),c.jsx("div",{className:"flex flex-wrap gap-2 mb-3",children:F6.map(d=>c.jsxs("button",{type:"button",onClick:()=>l(d.id),className:`btn btn-xs rounded-full border ${f(d.id)?"btn-accent text-base-100":"btn-ghost border-base-300 text-sm"}`,children:[c.jsx("span",{className:"mr-1",children:d.emoji}),d.label]},d.id))}),c.jsx("p",{className:"text-xs mb-1 opacity-80",children:"What didn't?"}),c.jsx("div",{className:"flex flex-wrap gap-2 mb-3",children:O6.map(d=>c.jsxs("button",{type:"button",onClick:()=>l(d.id),className:`btn btn-xs rounded-full border ${f(d.id)?"btn-error text-base-100":"btn-ghost border-base-300 text-sm"}`,children:[c.jsx("span",{className:"mr-1",children:d.emoji}),d.label]},d.id))}),c.jsx("button",{type:"button",onClick:u,className:"btn btn-sm btn-primary",children:" Generate Review From Tags"}),i&&c.jsxs("p",{className:"mt-3 text-sm opacity-90 italic",children:["Generated preview: ",i,""]})]})},B6=({watched:e,watchedDate:t,onWatchedDateChange:r,rating:n,onRatingChange:s,review:a,onReviewChange:i,vibeTags:o,onVibeChange:l,saving:u,onSave:f})=>c.jsxs(c.Fragment,{children:[c.jsx("h2",{className:"text-2xl font-christmas text-xmas-gold mb-4",children:"Your Rating & Review"}),e&&c.jsxs("div",{className:"form-control mb-4",children:[c.jsx("label",{className:"label",children:c.jsx("span",{className:"label-text",children:"Date Watched"})}),c.jsx("input",{type:"date",className:"input input-bordered",value:t,onChange:d=>r(d.target.value)})]}),c.jsxs("div",{className:"form-control mb-4",children:[c.jsx("label",{className:"label",children:c.jsx("span",{className:"label-text",children:"Your Rating"})}),c.jsx("div",{className:"rating rating-lg",children:[1,2,3,4,5,6,7,8,9,10].map(d=>c.jsx("input",{type:"radio",name:"rating",className:`mask mask-star-2 ${d<=5?"bg-orange-400":"bg-yellow-400"}`,checked:n===d,onChange:()=>s(d)},d))}),n&&c.jsx("div",{className:"mt-2",children:c.jsx("button",{className:"btn btn-xs btn-ghost",onClick:()=>s(null),children:"Clear Rating"})})]}),c.jsx(V6,{rating:n,initialTags:o,initialAutoReview:a,onChange:l}),c.jsxs("div",{className:"form-control mb-6 mt-4",children:[c.jsx("label",{className:"label",children:c.jsx("span",{className:"label-text",children:"Your Review"})}),c.jsx("textarea",{className:"textarea textarea-bordered h-32",placeholder:"Write your thoughts about this movie...",value:a,onChange:d=>i(d.target.value)})]}),c.jsx("div",{className:"flex justify-end",children:c.jsx("button",{className:"btn btn-primary btn-sm sm:btn-md",onClick:f,disabled:u,children:u?c.jsxs(c.Fragment,{children:[c.jsx("span",{className:"loading loading-spinner loading-sm mr-2"}),"Saving..."]}):c.jsxs(c.Fragment,{children:[c.jsx("i",{className:"fas fa-save mr-2"}),"Save Changes"]})})})]}),$6=()=>{var H;const{movieId:e}=Hd(),t=Ts(),r=ts(),{currentUser:n}=ln(),s=MA(),a=LA(t.search),o=((H=t.state)==null?void 0:H.from)==="import"?"/import":"/movies",[l,u]=U.useState(null),[f,d]=U.useState(null),[m,p]=U.useState(!0),[x,g]=U.useState(null),[_,k]=U.useState(!1),[E,y]=U.useState(!1),[b,O]=U.useState(""),[D,v]=U.useState(null),[T,S]=U.useState(""),[N,C]=U.useState(!1),[R,F]=U.useState([]),oe=U.useRef(null);U.useEffect(()=>{(async()=>{if(!n||!a){g("Movie not found"),p(!1);return}try{p(!0);const Y=await En(dt(De,"movies",a));if(!Y.exists()){g("Movie not found"),p(!1);return}const M={id:Y.id,...Y.data()};u(M);const q=await dd(n.uid,a);if(q){d(q),y(q.watched);let K="";if(q.watchedDate)try{if(q.watchedDate instanceof Date)K=q.watchedDate.toISOString().split("T")[0];else{const L=q.watchedDate;if(typeof L=="object"&&L!==null&&"seconds"in L){const J=L;K=new Date(J.seconds*1e3).toISOString().split("T")[0]}else{const J=new Date(q.watchedDate);isNaN(J.getTime())||(K=J.toISOString().split("T")[0])}}}catch(L){console.error("Error parsing watchedDate:",L)}O(K),v(q.rating||null),S(q.review||""),C(q.favorite),F(q.vibeTags||[])}}catch(Y){console.error("Error fetching movie data:",Y),g("Failed to load movie data")}finally{p(!1)}})()},[n,a]),U.useEffect(()=>{E&&oe.current&&typeof window<"u"&&window.innerWidth<768&&oe.current.scrollIntoView({behavior:"smooth",block:"start"})},[E]);const te=async()=>{if(!(!n||!a||!l))try{k(!0);const Z={userId:n.uid,movieId:a,watched:E,favorite:N,updatedAt:new Date,vibeTags:R};if(E&&b)try{Z.watchedDate=new Date(b),isNaN(Z.watchedDate.getTime())&&delete Z.watchedDate}catch(q){console.error("Error parsing watchedDate for save:",q),delete Z.watchedDate}else E||(Z.watchedDate=null);Z.rating=D,Z.review=T||null;const Y=await Ju(n.uid,a,Z);d(Y);const M=await wh(n.uid);if(M.length){const q=M.map(K=>{var L;return((L=sl.find(J=>J.id===K))==null?void 0:L.name)||K}).join(", ");s.success(`You unlocked: ${q}! `)}}catch(Z){console.error("Error saving movie data:",Z),g("Failed to save movie data")}finally{k(!1)}},de=async()=>{if(!n||!a)return;const Z=!N;C(Z);try{const Y=dt(De,"users",n.uid,"movies",a);(await En(Y)).exists()?await Fn(Y,{favorite:Z,updatedAt:new Date}):await Zn(Y,{userId:n.uid,movieId:a,favorite:Z,watched:!1,rating:null,review:"",vibeTags:[],addedAt:new Date,updatedAt:new Date},{merge:!0}),d(K=>K&&{...K,favorite:Z});const q=await wh(n.uid);if(q.length){const K=q.map(L=>{var J;return((J=sl.find(fe=>fe.id===L))==null?void 0:J.name)||L}).join(", ");s.success(`You unlocked: ${K}! `)}}catch(Y){console.error("Failed to toggle favorite",Y),C(!Z)}},ae=async()=>{if(!(!n||!a||!window.confirm("Are you sure you want to remove this movie from your collection?")))try{k(!0),await b6(n.uid,a),r("/movies")}catch(Z){console.error("Error deleting movie:",Z),g("Failed to delete movie"),k(!1)}},X=async()=>{if(!n||!a)return;const Z=!E;y(Z);try{const Y=dt(De,"users",n.uid,"movies",a),M=await En(Y),q=M.exists()?!!M.data().watched:!1;M.exists()?await Fn(Y,{watched:Z,...Z?{}:{watchedDate:null},updatedAt:new Date}):await Zn(Y,{userId:n.uid,movieId:a,watched:Z,favorite:!1,rating:null,review:"",vibeTags:[],addedAt:new Date,updatedAt:new Date},{merge:!0}),d(L=>L&&{...L,watched:Z}),q!==Z&&await D6(Z?1:-1);const K=await wh(n.uid);if(K.length){const L=K.map(J=>{var fe;return((fe=sl.find(we=>we.id===J))==null?void 0:fe.name)||J}).join(", ");s.success(`You unlocked: ${L}! `)}}catch(Y){console.error("Failed to toggle watched",Y),y(!Z)}};return m?c.jsx("div",{className:"flex justify-center items-center min-h-[60vh]",children:c.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-xmas-gold"})}):l?c.jsxs("div",{className:"container mx-auto px-4 py-8",children:[c.jsx("div",{className:"mb-4",children:c.jsxs(Ge,{to:o,className:"btn btn-primary btn-sm sm:btn-md",children:[c.jsx("i",{className:"fas fa-arrow-left mr-2"})," Back to Movies"]})}),x&&c.jsxs("div",{className:"alert alert-error mb-6",children:[c.jsx("i",{className:"fas fa-exclamation-circle mr-2"}),c.jsx("span",{children:x})]}),c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-8",children:[c.jsxs("div",{className:"md:col-span-1",children:[c.jsx("div",{className:"rounded-lg overflow-hidden shadow-xl",children:f!=null&&f.posterUrlOverride||l.posterUrl?c.jsx("img",{src:(f==null?void 0:f.posterUrlOverride)||l.posterUrl,alt:l.title,className:"w-full object-contain",style:{aspectRatio:"2/3"}}):c.jsx("div",{className:"w-full flex items-center justify-center bg-gray-800",style:{aspectRatio:"2/3"},children:c.jsx("i",{className:"fas fa-film text-6xl text-gray-500"})})}),c.jsxs("div",{className:"mt-4 flex flex-col gap-2",children:[c.jsxs("button",{className:`btn ${N?"btn-primary":"btn-outline"} w-full`,onClick:de,children:[c.jsx("i",{className:`fas fa-star mr-2 ${N?"text-white":""}`}),N?"Favourited":"Add to Favourites"]}),c.jsxs(Ge,{to:`/movies/${e}/edit-poster${t.search}`,className:"btn btn-outline w-full",children:[c.jsx("i",{className:"fas fa-image mr-2"}),"Edit Poster"]}),c.jsxs("button",{className:`btn ${E?"btn-success":"btn-outline"} w-full`,onClick:X,children:[c.jsx("i",{className:`fas fa-check mr-2 ${E?"text-white":""}`}),E?"Watched":"Mark as Watched"]}),c.jsxs("button",{className:"btn btn-error btn-outline w-full",onClick:ae,disabled:_,children:[c.jsx("i",{className:"fas fa-trash mr-2"}),"Remove from Collection"]})]})]}),c.jsxs("div",{className:"md:col-span-2",children:[c.jsx("h1",{className:"font-christmas text-3xl md:text-4xl text-xmas-line mb-2",children:l.title}),l.releaseDate&&c.jsx("p",{className:"text-lg text-gray-400 mb-4",children:new Date(l.releaseDate).getFullYear()}),l.genres&&l.genres.length>0&&c.jsx("div",{className:"flex flex-wrap gap-2 mb-4",children:l.genres.map((Z,Y)=>c.jsx("span",{className:"badge badge-outline",children:Z},Y))}),l.runtime&&c.jsxs("p",{className:"mb-4",children:[c.jsx("i",{className:"fas fa-clock mr-2 text-xmas-gold"}),Math.floor(l.runtime/60),"h ",l.runtime%60,"m"]}),l.overview&&c.jsxs("div",{className:"mb-6",children:[c.jsx("h2",{className:"text-xl font-bold mb-2",children:"Overview"}),c.jsx("p",{className:"text-gray-300",children:l.overview})]}),l.directors&&l.directors.length>0&&c.jsxs("div",{className:"mb-4",children:[c.jsxs("h2",{className:"text-xl font-bold mb-2",children:["Director",l.directors.length>1?"s":""]}),c.jsx("p",{children:l.directors.join(", ")})]}),l.cast&&l.cast.length>0&&c.jsxs("div",{className:"mb-6",children:[c.jsx("h2",{className:"text-xl font-bold mb-2",children:"Cast"}),c.jsx("p",{className:"flex flex-wrap gap-1",children:l.cast.slice(0,10).map((Z,Y)=>c.jsxs(Cu.Fragment,{children:[c.jsx(Ge,{to:`/movies?q=${encodeURIComponent(Z)}&field=cast`,className:"link link-primary",children:Z}),Y<Math.min(l.cast.length,10)-1&&c.jsx("span",{children:","})]},Z))})]}),c.jsxs("div",{ref:oe,children:[c.jsx("div",{className:"divider"}),E&&c.jsx(B6,{watched:E,watchedDate:b,onWatchedDateChange:O,rating:D,onRatingChange:v,review:T,onReviewChange:S,vibeTags:R,onVibeChange:({tags:Z,autoReview:Y})=>{F(Z),S(Y)},saving:_,onSave:te})]})]})]})]}):c.jsxs("div",{className:"container mx-auto px-4 py-8",children:[c.jsxs("div",{className:"alert alert-error",children:[c.jsx("i",{className:"fas fa-exclamation-circle mr-2"}),c.jsx("span",{children:"Movie not found"})]}),c.jsx("div",{className:"mt-4",children:c.jsxs(Ge,{to:o,className:"btn btn-primary btn-sm sm:btn-md",children:[c.jsx("i",{className:"fas fa-arrow-left mr-2"})," Back to Movies"]})})]})};function md(e,t){let r=0;const n=(e.title||"").toLowerCase(),s=(t.Title||"").toLowerCase();if(n&&s)if(n===s)r+=60;else if(s.includes(n)||n.includes(s))r+=40;else{const a=n.split(" "),i=s.split(" "),o=a.filter(l=>i.includes(l));r+=o.length/Math.max(a.length,i.length)*40}if(e.releaseDate!=null&&t.Year){const a=String(e.releaseDate).slice(0,4),i=String(t.Year).slice(0,4),o=parseInt(a,10),l=parseInt(i,10);!isNaN(o)&&!isNaN(l)&&(o===l?r+=40:Math.abs(o-l)<=1&&(r+=20))}return Math.min(Math.round(r),100)}const xn=e=>e!=null&&e.Poster&&e.Poster!=="N/A"?e.Poster:(e==null?void 0:e.posterUrl)||"",W6=({onSelect:e,userMovieIds:t})=>{const r=ts(),[n,s]=U.useState([]),[a,i]=U.useState(!0),[o,l]=U.useState(null),[u,f]=U.useState(""),[d,m]=U.useState("all"),[p,x]=U.useState("title-asc"),[g,_]=U.useState(!1);U.useEffect(()=>{(async()=>{try{i(!0),l(null);const D=(await Mt(Tt(De,"movies"))).docs.map(v=>{var S;const T=v.data();return T.imdbId?{id:T.imdbId,title:T.title,release_date:T.releaseDate,poster_path:(S=T.posterUrl)!=null&&S.startsWith("https://image.tmdb.org/t/p/")?T.posterUrl.replace("https://image.tmdb.org/t/p/w500",""):null,posterUrl:T.posterUrl||null,source:"local",firestoreId:v.id,cast:T.cast||[],runtime:T.runtime,genres:T.genres||[],overview:T.overview}:null}).filter(Boolean);s(D)}catch(O){console.error("Error loading local catalogue:",O),l((O==null?void 0:O.message)??"Failed to load local catalogue")}finally{i(!1)}})()},[]);const k=U.useCallback(b=>{var T;if(!u.trim())return!0;const O=u.toLowerCase().trim(),D=O.split(",").map(S=>S.trim()).filter(Boolean),v=S=>b.cast&&b.cast.some(N=>N.toLowerCase().includes(S));switch(d){case"title":return b.title.toLowerCase().includes(O);case"year":return!!b.release_date&&!!((T=ds(b.release_date))!=null&&T.includes(O));case"cast":return D.length?D.some(S=>v(S)):v(O);case"all":default:{const S=b.release_date&&ds(b.release_date);return b.title.toLowerCase().includes(O)||S&&S.includes(O)||b.cast&&b.cast.some(N=>N.toLowerCase().includes(O))}}},[u,d]),E=U.useMemo(()=>n.filter(b=>{if(!k(b))return!1;const O=!!b.firestoreId&&t.includes(b.firestoreId);return!(g&&O)}),[n,k,t,g]),y=U.useMemo(()=>{const b=[...E],O=D=>{if(!D.release_date)return 0;const v=ds(D.release_date);if(!v)return 0;const T=parseInt(v,10);return Number.isNaN(T)?0:T};return b.sort((D,v)=>{switch(p){case"title-asc":return D.title.localeCompare(v.title);case"title-desc":return v.title.localeCompare(D.title);case"year-desc":{const T=O(D);return O(v)-T||D.title.localeCompare(v.title)}case"year-asc":{const T=O(D),S=O(v);return T-S||D.title.localeCompare(v.title)}default:return 0}}),b},[E,p]);return c.jsxs("div",{className:"space-y-4",children:[c.jsxs("div",{className:"flex flex-col lg:flex-row gap-2",children:[c.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 flex-1",children:[c.jsxs("div",{className:"relative flex-grow",children:[c.jsx("div",{className:"absolute inset-y-0 left-0 pl-2 flex items-center pointer-events-none",children:c.jsx("i",{className:"fas fa-search text-gray-400"})}),c.jsx("input",{type:"text",className:"input input-bordered input-sm sm:input-md w-full pl-8 pr-8",placeholder:"   Search catalogue by title, cast, year...",value:u,onChange:b=>f(b.target.value)}),u&&c.jsx("button",{className:"absolute inset-y-0 right-0 pr-2 flex items-center",onClick:()=>f(""),children:c.jsx("i",{className:"fas fa-times text-gray-400 hover:text-gray-600"})})]}),c.jsxs("select",{className:"select select-bordered select-sm sm:select-md w-full sm:w-40",value:d,onChange:b=>m(b.target.value),children:[c.jsx("option",{value:"all",children:"All Fields"}),c.jsx("option",{value:"title",children:"Title Only"}),c.jsx("option",{value:"year",children:"Year Only"}),c.jsx("option",{value:"cast",children:"Cast Only"})]})]}),c.jsx("div",{className:"flex items-center justify-end",children:c.jsxs("select",{className:"select select-bordered select-sm sm:select-md w-full sm:w-52",value:p,onChange:b=>x(b.target.value),children:[c.jsx("option",{value:"title-asc",children:"Sort: Title (A  Z)"}),c.jsx("option",{value:"title-desc",children:"Sort: Title (Z  A)"}),c.jsx("option",{value:"year-desc",children:"Sort: Year (Newest  Oldest)"}),c.jsx("option",{value:"year-asc",children:"Sort: Year (Oldest  Newest)"})]})})]}),c.jsxs("div",{className:"flex flex-col xs:flex-row justify-between items-start xs:items-center text-xs sm:text-sm gap-2",children:[c.jsx("div",{children:a?c.jsx("span",{children:"Loading catalogue"}):c.jsxs(c.Fragment,{children:[c.jsx("span",{className:"font-medium",children:y.length})," ",y.length===1?"movie":"movies"," in catalogue",u&&c.jsxs("span",{className:"ml-1 opacity-70",children:["for: ",c.jsxs("span",{className:"font-medium",children:['"',u,'"']})]})]})}),c.jsxs("label",{className:"flex items-center gap-1 cursor-pointer select-none",children:[c.jsx("input",{type:"checkbox",className:"checkbox checkbox-xs sm:checkbox-sm",checked:g,onChange:b=>_(b.target.checked)}),c.jsx("span",{children:"Hide owned movies"})]})]}),o&&c.jsx("div",{className:"alert alert-error",children:o}),a&&c.jsx("div",{className:"flex justify-center p-6",children:c.jsx("span",{className:"loading loading-spinner loading-lg"})}),!a&&y.length===0&&!o&&c.jsxs("div",{className:"bg-xmas-card bg-opacity-60 rounded-lg p-6 text-center",children:[c.jsx("h3",{className:"text-lg font-semibold mb-2",children:"No movies found"}),c.jsx("p",{className:"text-sm opacity-80 mb-2",children:"Try changing your search text, field, or sort order."})]}),!a&&y.length>0&&c.jsx("div",{className:"grid grid-cols-3 sm:grid-cols-4 md:grid-cols-5 lg:grid-cols-6 gap-2 sm:gap-3",children:y.map(b=>{const O=!!b.firestoreId&&t.includes(b.firestoreId);return c.jsx("div",{className:`block transition-transform hover:scale-[1.02] hover:shadow-xl ${O?"opacity-60 cursor-pointer":"cursor-pointer"}`,onClick:()=>{O&&b.firestoreId?r(mv(b.title,b.firestoreId),{state:{from:"import"}}):e(b)},children:c.jsxs("div",{className:"relative rounded-lg overflow-hidden bg-xmas-card shadow-md h-full flex flex-col",children:[c.jsxs("div",{className:"relative",children:[xn(b)?c.jsx("img",{src:xn(b),alt:b.title,className:"w-full h-auto object-cover",style:{aspectRatio:"2/3"},loading:"lazy"}):c.jsx("div",{className:"w-full flex items-center justify-center bg-gray-800",style:{aspectRatio:"2/3"},children:c.jsx("i",{className:"fas fa-film text-2xl text-gray-500"})}),O&&c.jsxs("div",{className:`\r
                          absolute top-1 left-1 \r
                          badge badge-success \r
                          px-2 py-0.5 \r
                          text-[0.6rem] leading-none \r
                          whitespace-nowrap \r
                          flex items-center gap-1 \r
                          shadow\r
                        `,children:[c.jsx("i",{className:"fas fa-check text-[0.6rem]"}),c.jsx("span",{children:"Owned"})]})]}),c.jsxs("div",{className:"p-1 sm:p-2 flex-grow flex flex-col",children:[c.jsx("h3",{className:"text-xs sm:text-sm font-medium line-clamp-2",children:b.title}),c.jsx("p",{className:"text-xs text-gray-400 mt-1",children:b.release_date&&ds(b.release_date)})]})]})},b.firestoreId||b.id)})})]})},$A=e=>{const t=e.trim();return/^The\s+/i.test(t)?t.replace(/^The\s+/i,"").trim():/^A\s+/i.test(t)?t.replace(/^A\s+/i,"").trim():/^An\s+/i.test(t)?t.replace(/^An\s+/i,"").trim():t},WA="https://www.omdbapi.com/",zA=e=>(e||"").toLowerCase().replace(/^(the|a|an)\s+/,"").replace(/[^a-z0-9]+/g," ").trim(),z6=e=>{const t=new Set,r=n=>{const s=zA(n||"");s&&(t.add(s),s.split(" ").forEach(a=>a&&t.add(a)))};return r(e.Title),e.Year&&t.add(e.Year),e.Genre&&e.Genre.split(",").forEach(n=>r(n)),e.Actors&&e.Actors.split(",").forEach(n=>r(n)),e.Director&&e.Director.split(",").forEach(n=>r(n)),Array.from(t).slice(0,200)},Hi=async(e,t)=>{const r=`${WA}?apikey=${t}&s=${encodeURIComponent(e)}&type=movie`,n=await fetch(r);if(!n.ok)throw new Error(`OMDb API error: ${n.status}`);const s=await n.json();if(s.Response==="False"||!s.Search)throw new Error(s.Error||"No results from OMDb");return s.Search},ci=async(e,t)=>{const r=`${WA}?apikey=${t}&i=${encodeURIComponent(e)}&plot=full`,n=await fetch(r);if(!n.ok)throw new Error(`OMDb API error: ${n.status}`);const s=await n.json();if(s.Response==="False")throw new Error(s.Error||"Failed to fetch OMDb details");return s},x0=e=>{const t=e.Title,r=$A(t),n=zA(r),s=e.Year,a=e.Released&&e.Released!=="N/A"?e.Released:s&&s!=="N/A"?`${s}-01-01`:null,i=e.Runtime&&e.Runtime!=="N/A"?parseInt(e.Runtime,10):null,o=e.Genre&&e.Genre!=="N/A"?e.Genre.split(",").map(d=>d.trim()).filter(Boolean):[],l=e.Director&&e.Director!=="N/A"?e.Director.split(",").map(d=>d.trim()).filter(Boolean):[],u=e.Actors&&e.Actors!=="N/A"?e.Actors.split(",").map(d=>d.trim()).filter(Boolean):[],f=e.Plot&&e.Plot!=="N/A"?e.Plot:null;return{imdbId:e.imdbID,title:t,sortTitle:r,sortTitleLower:n,originalTitle:t,releaseDate:a,posterUrl:e.Poster&&e.Poster!=="N/A"?e.Poster:null,backdropUrl:null,overview:f,runtime:i,genres:o,directors:l,cast:u,isChristmas:!0,keywords:z6(e),updatedAt:new Date}},H6=({omdbApiKey:e,onSelect:t})=>{const[r,n]=U.useState(""),[s,a]=U.useState(!1),[i,o]=U.useState([]),[l,u]=U.useState(null),f=async()=>{if(r.trim())try{a(!0),u(null);const d=await Hi(r,e);o(d)}catch(d){u((d==null?void 0:d.message)??"OMDb search failed")}finally{a(!1)}};return c.jsxs("div",{className:"space-y-3",children:[c.jsxs("div",{className:"flex gap-2",children:[c.jsx("input",{className:"input input-bordered flex-1",value:r,onChange:d=>n(d.target.value),placeholder:"Search OMDb...",onKeyDown:d=>d.key==="Enter"&&f()}),c.jsx("button",{className:"btn btn-primary",onClick:f,disabled:s||!e,children:s?c.jsx("span",{className:"loading loading-spinner loading-sm"}):"Search"})]}),l&&c.jsx("div",{className:"alert alert-error",children:l}),i.length>0&&c.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-3",children:i.map(d=>c.jsxs("div",{className:"card bg-base-100 shadow cursor-pointer hover:shadow-lg transition-shadow",onClick:()=>t(d),children:[c.jsx("figure",{children:xn(d)?c.jsx("img",{src:xn(d),alt:d.Title,className:"w-full h-64 object-contain"}):c.jsx("div",{className:"h-64 w-full flex items-center justify-center bg-base-200",children:c.jsx("i",{className:"fas fa-film text-3xl opacity-50"})})}),c.jsxs("div",{className:"card-body p-3",children:[c.jsx("div",{className:"font-semibold",children:d.Title}),c.jsx("div",{className:"text-xs opacity-70",children:d.Year})]})]},d.imdbID))})]})};/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var HA=1252,G6=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],pv={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},gv=function(e){G6.indexOf(e)!=-1&&(HA=pv[0]=e)};function K6(){gv(1252)}var ps=function(e){gv(e)};function GA(){ps(1200),K6()}function vw(e){for(var t=[],r=0,n=e.length;r<n;++r)t[r]=e.charCodeAt(r);return t}function q6(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r)+(e.charCodeAt(2*r+1)<<8));return t.join("")}function KA(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r+1)+(e.charCodeAt(2*r)<<8));return t.join("")}var gc=function(e){var t=e.charCodeAt(0),r=e.charCodeAt(1);return t==255&&r==254?q6(e.slice(2)):t==254&&r==255?KA(e.slice(2)):t==65279?e.slice(1):e},zf=function(t){return String.fromCharCode(t)},yw=function(t){return String.fromCharCode(t)},_u,Ya="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function _w(e){for(var t="",r=0,n=0,s=0,a=0,i=0,o=0,l=0,u=0;u<e.length;)r=e.charCodeAt(u++),a=r>>2,n=e.charCodeAt(u++),i=(r&3)<<4|n>>4,s=e.charCodeAt(u++),o=(n&15)<<2|s>>6,l=s&63,isNaN(n)?o=l=64:isNaN(s)&&(l=64),t+=Ya.charAt(a)+Ya.charAt(i)+Ya.charAt(o)+Ya.charAt(l);return t}function Mn(e){var t="",r=0,n=0,s=0,a=0,i=0,o=0,l=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var u=0;u<e.length;)a=Ya.indexOf(e.charAt(u++)),i=Ya.indexOf(e.charAt(u++)),r=a<<2|i>>4,t+=String.fromCharCode(r),o=Ya.indexOf(e.charAt(u++)),n=(i&15)<<4|o>>2,o!==64&&(t+=String.fromCharCode(n)),l=Ya.indexOf(e.charAt(u++)),s=(o&3)<<6|l,l!==64&&(t+=String.fromCharCode(s));return t}var tt=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),po=function(){if(typeof Buffer<"u"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(t,r){return r?new Buffer(t,r):new Buffer(t)}:Buffer.from.bind(Buffer)}return function(){}}();function xi(e){return tt?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}function ww(e){return tt?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}var ms=function(t){return tt?po(t,"binary"):t.split("").map(function(r){return r.charCodeAt(0)&255})};function go(e){if(Array.isArray(e))return e.map(function(n){return String.fromCharCode(n)}).join("");for(var t=[],r=0;r<e.length;++r)t[r]=String.fromCharCode(e[r]);return t.join("")}function xv(e){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(e instanceof ArrayBuffer)return xv(new Uint8Array(e));for(var t=new Array(e.length),r=0;r<e.length;++r)t[r]=e[r];return t}var Ha=tt?function(e){return Buffer.concat(e.map(function(t){return Buffer.isBuffer(t)?t:po(t)}))}:function(e){if(typeof Uint8Array<"u"){var t=0,r=0;for(t=0;t<e.length;++t)r+=e[t].length;var n=new Uint8Array(r),s=0;for(t=0,r=0;t<e.length;r+=s,++t)if(s=e[t].length,e[t]instanceof Uint8Array)n.set(e[t],r);else{if(typeof e[t]=="string")throw"wtf";n.set(new Uint8Array(e[t]),r)}return n}return[].concat.apply([],e.map(function(a){return Array.isArray(a)?a:[].slice.call(a)}))};function X6(e){for(var t=[],r=0,n=e.length+250,s=xi(e.length+255),a=0;a<e.length;++a){var i=e.charCodeAt(a);if(i<128)s[r++]=i;else if(i<2048)s[r++]=192|i>>6&31,s[r++]=128|i&63;else if(i>=55296&&i<57344){i=(i&1023)+64;var o=e.charCodeAt(++a)&1023;s[r++]=240|i>>8&7,s[r++]=128|i>>2&63,s[r++]=128|o>>6&15|(i&3)<<4,s[r++]=128|o&63}else s[r++]=224|i>>12&15,s[r++]=128|i>>6&63,s[r++]=128|i&63;r>n&&(t.push(s.slice(0,r)),r=0,s=xi(65535),n=65530)}return t.push(s.slice(0,r)),Ha(t)}var nn=/\u0000/g,xc=/[\u0001-\u0006]/g;function al(e){for(var t="",r=e.length-1;r>=0;)t+=e.charAt(r--);return t}function gs(e,t){var r=""+e;return r.length>=t?r:zt("0",t-r.length)+r}function vv(e,t){var r=""+e;return r.length>=t?r:zt(" ",t-r.length)+r}function pd(e,t){var r=""+e;return r.length>=t?r:r+zt(" ",t-r.length)}function Y6(e,t){var r=""+Math.round(e);return r.length>=t?r:zt("0",t-r.length)+r}function Q6(e,t){var r=""+e;return r.length>=t?r:zt("0",t-r.length)+r}var Ew=Math.pow(2,32);function No(e,t){if(e>Ew||e<-Ew)return Y6(e,t);var r=Math.round(e);return Q6(r,t)}function gd(e,t){return t=t||0,e.length>=7+t&&(e.charCodeAt(t)|32)===103&&(e.charCodeAt(t+1)|32)===101&&(e.charCodeAt(t+2)|32)===110&&(e.charCodeAt(t+3)|32)===101&&(e.charCodeAt(t+4)|32)===114&&(e.charCodeAt(t+5)|32)===97&&(e.charCodeAt(t+6)|32)===108}var Tw=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],gm=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function J6(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"/ "hh""mm""ss" "',e}var He={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},kw={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},Z6={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function xd(e,t,r){for(var n=e<0?-1:1,s=e*n,a=0,i=1,o=0,l=1,u=0,f=0,d=Math.floor(s);u<t&&(d=Math.floor(s),o=d*i+a,f=d*u+l,!(s-d<5e-8));)s=1/(s-d),a=i,i=o,l=u,u=f;if(f>t&&(u>t?(f=l,o=a):(f=u,o=i)),!r)return[0,n*o,f];var m=Math.floor(n*o/f);return[m,n*o-m*f,f]}function Ui(e,t,r){if(e>2958465||e<0)return null;var n=e|0,s=Math.floor(86400*(e-n)),a=0,i=[],o={D:n,T:s,u:86400*(e-n)-s,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(o.u)<1e-6&&(o.u=0),t&&t.date1904&&(n+=1462),o.u>.9999&&(o.u=0,++s==86400&&(o.T=s=0,++n,++o.D)),n===60)i=r?[1317,10,29]:[1900,2,29],a=3;else if(n===0)i=r?[1317,8,29]:[1900,1,0],a=6;else{n>60&&--n;var l=new Date(1900,0,1);l.setDate(l.getDate()+n-1),i=[l.getFullYear(),l.getMonth()+1,l.getDate()],a=l.getDay(),n<60&&(a=(a+6)%7),r&&(a=a8(l,i))}return o.y=i[0],o.m=i[1],o.d=i[2],o.S=s%60,s=Math.floor(s/60),o.M=s%60,s=Math.floor(s/60),o.H=s,o.q=a,o}var qA=new Date(1899,11,31,0,0,0),e8=qA.getTime(),t8=new Date(1900,2,1,0,0,0);function XA(e,t){var r=e.getTime();return t?r-=1461*24*60*60*1e3:e>=t8&&(r+=24*60*60*1e3),(r-(e8+(e.getTimezoneOffset()-qA.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function yv(e){return e.indexOf(".")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function r8(e){return e.indexOf("E")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function n8(e){var t=e<0?12:11,r=yv(e.toFixed(12));return r.length<=t||(r=e.toPrecision(10),r.length<=t)?r:e.toExponential(5)}function s8(e){var t=yv(e.toFixed(11));return t.length>(e<0?12:11)||t==="0"||t==="-0"?e.toPrecision(6):t}function wu(e){var t=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),r;return t>=-4&&t<=-1?r=e.toPrecision(10+t):Math.abs(t)<=9?r=n8(e):t===10?r=e.toFixed(10).substr(0,12):r=s8(e),yv(r8(r.toUpperCase()))}function ao(e,t){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):wu(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return es(14,XA(e,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+e)}function a8(e,t){t[0]-=581;var r=e.getDay();return e<60&&(r=(r+6)%7),r}function i8(e,t,r,n){var s="",a=0,i=0,o=r.y,l,u=0;switch(e){case 98:o=r.y+543;case 121:switch(t.length){case 1:case 2:l=o%100,u=2;break;default:l=o%1e4,u=4;break}break;case 109:switch(t.length){case 1:case 2:l=r.m,u=t.length;break;case 3:return gm[r.m-1][1];case 5:return gm[r.m-1][0];default:return gm[r.m-1][2]}break;case 100:switch(t.length){case 1:case 2:l=r.d,u=t.length;break;case 3:return Tw[r.q][0];default:return Tw[r.q][1]}break;case 104:switch(t.length){case 1:case 2:l=1+(r.H+11)%12,u=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:l=r.H,u=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:l=r.M,u=t.length;break;default:throw"bad minute format: "+t}break;case 115:if(t!="s"&&t!="ss"&&t!=".0"&&t!=".00"&&t!=".000")throw"bad second format: "+t;return r.u===0&&(t=="s"||t=="ss")?gs(r.S,t.length):(n>=2?i=n===3?1e3:100:i=n===1?10:1,a=Math.round(i*(r.S+r.u)),a>=60*i&&(a=0),t==="s"?a===0?"0":""+a/i:(s=gs(a,2+n),t==="ss"?s.substr(0,2):"."+s.substr(2,t.length-1)));case 90:switch(t){case"[h]":case"[hh]":l=r.D*24+r.H;break;case"[m]":case"[mm]":l=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":l=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+t}u=t.length===3?1:2;break;case 101:l=o,u=1;break}var f=u>0?gs(l,u):"";return f}function Qa(e){var t=3;if(e.length<=t)return e;for(var r=e.length%t,n=e.substr(0,r);r!=e.length;r+=t)n+=(n.length>0?",":"")+e.substr(r,t);return n}var YA=/%/g;function o8(e,t,r){var n=t.replace(YA,""),s=t.length-n.length;return ha(e,n,r*Math.pow(10,2*s))+zt("%",s)}function l8(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return ha(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function QA(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+QA(e,-t);var s=e.indexOf(".");s===-1&&(s=e.indexOf("E"));var a=Math.floor(Math.log(t)*Math.LOG10E)%s;if(a<0&&(a+=s),r=(t/Math.pow(10,a)).toPrecision(n+1+(s+a)%s),r.indexOf("e")===-1){var i=Math.floor(Math.log(t)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(i-r.length+a):r+="E+"+(i-a);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,s)+"."+r.substr(2+s),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,l,u,f){return l+u+f.substr(0,(s+a)%s)+"."+f.substr(a)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var JA=/# (\?+)( ?)\/( ?)(\d+)/;function c8(e,t,r){var n=parseInt(e[4],10),s=Math.round(t*n),a=Math.floor(s/n),i=s-a*n,o=n;return r+(a===0?"":""+a)+" "+(i===0?zt(" ",e[1].length+1+e[4].length):vv(i,e[1].length)+e[2]+"/"+e[3]+gs(o,e[4].length))}function u8(e,t,r){return r+(t===0?"":""+t)+zt(" ",e[1].length+2+e[4].length)}var ZA=/^#*0*\.([0#]+)/,eb=/\).*[0#]/,tb=/\(###\) ###\\?-####/;function Jr(e){for(var t="",r,n=0;n!=e.length;++n)switch(r=e.charCodeAt(n)){case 35:break;case 63:t+=" ";break;case 48:t+="0";break;default:t+=String.fromCharCode(r)}return t}function Sw(e,t){var r=Math.pow(10,t);return""+Math.round(e*r)/r}function Aw(e,t){var r=e-Math.floor(e),n=Math.pow(10,t);return t<(""+Math.round(r*n)).length?0:Math.round(r*n)}function f8(e,t){return t<(""+Math.round((e-Math.floor(e))*Math.pow(10,t))).length?1:0}function h8(e){return e<2147483647&&e>-2147483648?""+(e>=0?e|0:e-1|0):""+Math.floor(e)}function Wn(e,t,r){if(e.charCodeAt(0)===40&&!t.match(eb)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Wn("n",n,r):"("+Wn("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return l8(e,t,r);if(t.indexOf("%")!==-1)return o8(e,t,r);if(t.indexOf("E")!==-1)return QA(t,r);if(t.charCodeAt(0)===36)return"$"+Wn(e,t.substr(t.charAt(1)==" "?2:1),r);var s,a,i,o,l=Math.abs(r),u=r<0?"-":"";if(t.match(/^00+$/))return u+No(l,t.length);if(t.match(/^[#?]+$/))return s=No(r,0),s==="0"&&(s=""),s.length>t.length?s:Jr(t.substr(0,t.length-s.length))+s;if(a=t.match(JA))return c8(a,l,u);if(t.match(/^#+0+$/))return u+No(l,t.length-t.indexOf("0"));if(a=t.match(ZA))return s=Sw(r,a[1].length).replace(/^([^\.]+)$/,"$1."+Jr(a[1])).replace(/\.$/,"."+Jr(a[1])).replace(/\.(\d*)$/,function(x,g){return"."+g+zt("0",Jr(a[1]).length-g.length)}),t.indexOf("0.")!==-1?s:s.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),a=t.match(/^(0*)\.(#*)$/))return u+Sw(l,a[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,a[1].length?"0.":".");if(a=t.match(/^#{1,3},##0(\.?)$/))return u+Qa(No(l,0));if(a=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Wn(e,t,-r):Qa(""+(Math.floor(r)+f8(r,a[1].length)))+"."+gs(Aw(r,a[1].length),a[1].length);if(a=t.match(/^#,#*,#0/))return Wn(e,t.replace(/^#,#*,/,""),r);if(a=t.match(/^([0#]+)(\\?-([0#]+))+$/))return s=al(Wn(e,t.replace(/[\\-]/g,""),r)),i=0,al(al(t.replace(/\\/g,"")).replace(/[0#]/g,function(x){return i<s.length?s.charAt(i++):x==="0"?"0":""}));if(t.match(tb))return s=Wn(e,"##########",r),"("+s.substr(0,3)+") "+s.substr(3,3)+"-"+s.substr(6);var f="";if(a=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(a[4].length,7),o=xd(l,Math.pow(10,i)-1,!1),s=""+u,f=ha("n",a[1],o[1]),f.charAt(f.length-1)==" "&&(f=f.substr(0,f.length-1)+"0"),s+=f+a[2]+"/"+a[3],f=pd(o[2],i),f.length<a[4].length&&(f=Jr(a[4].substr(a[4].length-f.length))+f),s+=f,s;if(a=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(Math.max(a[1].length,a[4].length),7),o=xd(l,Math.pow(10,i)-1,!0),u+(o[0]||(o[1]?"":"0"))+" "+(o[1]?vv(o[1],i)+a[2]+"/"+a[3]+pd(o[2],i):zt(" ",2*i+1+a[2].length+a[3].length));if(a=t.match(/^[#0?]+$/))return s=No(r,0),t.length<=s.length?s:Jr(t.substr(0,t.length-s.length))+s;if(a=t.match(/^([#0?]+)\.([#0]+)$/)){s=""+r.toFixed(Math.min(a[2].length,10)).replace(/([^0])0+$/,"$1"),i=s.indexOf(".");var d=t.indexOf(".")-i,m=t.length-s.length-d;return Jr(t.substr(0,d)+s+t.substr(t.length-m))}if(a=t.match(/^00,000\.([#0]*0)$/))return i=Aw(r,a[1].length),r<0?"-"+Wn(e,t,-r):Qa(h8(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(x){return"00,"+(x.length<3?gs(0,3-x.length):"")+x})+"."+gs(i,a[1].length);switch(t){case"###,##0.00":return Wn(e,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var p=Qa(No(l,0));return p!=="0"?u+p:"";case"###,###.00":return Wn(e,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return Wn(e,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+t+"|")}function d8(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return ha(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function m8(e,t,r){var n=t.replace(YA,""),s=t.length-n.length;return ha(e,n,r*Math.pow(10,2*s))+zt("%",s)}function rb(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+rb(e,-t);var s=e.indexOf(".");s===-1&&(s=e.indexOf("E"));var a=Math.floor(Math.log(t)*Math.LOG10E)%s;if(a<0&&(a+=s),r=(t/Math.pow(10,a)).toPrecision(n+1+(s+a)%s),!r.match(/[Ee]/)){var i=Math.floor(Math.log(t)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(i-r.length+a):r+="E+"+(i-a),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,l,u,f){return l+u+f.substr(0,(s+a)%s)+"."+f.substr(a)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function Cs(e,t,r){if(e.charCodeAt(0)===40&&!t.match(eb)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Cs("n",n,r):"("+Cs("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return d8(e,t,r);if(t.indexOf("%")!==-1)return m8(e,t,r);if(t.indexOf("E")!==-1)return rb(t,r);if(t.charCodeAt(0)===36)return"$"+Cs(e,t.substr(t.charAt(1)==" "?2:1),r);var s,a,i,o,l=Math.abs(r),u=r<0?"-":"";if(t.match(/^00+$/))return u+gs(l,t.length);if(t.match(/^[#?]+$/))return s=""+r,r===0&&(s=""),s.length>t.length?s:Jr(t.substr(0,t.length-s.length))+s;if(a=t.match(JA))return u8(a,l,u);if(t.match(/^#+0+$/))return u+gs(l,t.length-t.indexOf("0"));if(a=t.match(ZA))return s=(""+r).replace(/^([^\.]+)$/,"$1."+Jr(a[1])).replace(/\.$/,"."+Jr(a[1])),s=s.replace(/\.(\d*)$/,function(x,g){return"."+g+zt("0",Jr(a[1]).length-g.length)}),t.indexOf("0.")!==-1?s:s.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),a=t.match(/^(0*)\.(#*)$/))return u+(""+l).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,a[1].length?"0.":".");if(a=t.match(/^#{1,3},##0(\.?)$/))return u+Qa(""+l);if(a=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Cs(e,t,-r):Qa(""+r)+"."+zt("0",a[1].length);if(a=t.match(/^#,#*,#0/))return Cs(e,t.replace(/^#,#*,/,""),r);if(a=t.match(/^([0#]+)(\\?-([0#]+))+$/))return s=al(Cs(e,t.replace(/[\\-]/g,""),r)),i=0,al(al(t.replace(/\\/g,"")).replace(/[0#]/g,function(x){return i<s.length?s.charAt(i++):x==="0"?"0":""}));if(t.match(tb))return s=Cs(e,"##########",r),"("+s.substr(0,3)+") "+s.substr(3,3)+"-"+s.substr(6);var f="";if(a=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(a[4].length,7),o=xd(l,Math.pow(10,i)-1,!1),s=""+u,f=ha("n",a[1],o[1]),f.charAt(f.length-1)==" "&&(f=f.substr(0,f.length-1)+"0"),s+=f+a[2]+"/"+a[3],f=pd(o[2],i),f.length<a[4].length&&(f=Jr(a[4].substr(a[4].length-f.length))+f),s+=f,s;if(a=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(Math.max(a[1].length,a[4].length),7),o=xd(l,Math.pow(10,i)-1,!0),u+(o[0]||(o[1]?"":"0"))+" "+(o[1]?vv(o[1],i)+a[2]+"/"+a[3]+pd(o[2],i):zt(" ",2*i+1+a[2].length+a[3].length));if(a=t.match(/^[#0?]+$/))return s=""+r,t.length<=s.length?s:Jr(t.substr(0,t.length-s.length))+s;if(a=t.match(/^([#0]+)\.([#0]+)$/)){s=""+r.toFixed(Math.min(a[2].length,10)).replace(/([^0])0+$/,"$1"),i=s.indexOf(".");var d=t.indexOf(".")-i,m=t.length-s.length-d;return Jr(t.substr(0,d)+s+t.substr(t.length-m))}if(a=t.match(/^00,000\.([#0]*0)$/))return r<0?"-"+Cs(e,t,-r):Qa(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(x){return"00,"+(x.length<3?gs(0,3-x.length):"")+x})+"."+gs(0,a[1].length);switch(t){case"###,###":case"##,###":case"#,###":var p=Qa(""+l);return p!=="0"?u+p:"";default:if(t.match(/\.[0#?]*$/))return Cs(e,t.slice(0,t.lastIndexOf(".")),r)+Jr(t.slice(t.lastIndexOf(".")))}throw new Error("unsupported format |"+t+"|")}function ha(e,t,r){return(r|0)===r?Cs(e,t,r):Wn(e,t,r)}function p8(e){for(var t=[],r=!1,n=0,s=0;n<e.length;++n)switch(e.charCodeAt(n)){case 34:r=!r;break;case 95:case 42:case 92:++n;break;case 59:t[t.length]=e.substr(s,n-s),s=n+1}if(t[t.length]=e.substr(s),r===!0)throw new Error("Format |"+e+"| unterminated string ");return t}var nb=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function Ml(e){for(var t=0,r="",n="";t<e.length;)switch(r=e.charAt(t)){case"G":gd(e,t)&&(t+=6),t++;break;case'"':for(;e.charCodeAt(++t)!==34&&t<e.length;);++t;break;case"\\":t+=2;break;case"_":t+=2;break;case"@":++t;break;case"B":case"b":if(e.charAt(t+1)==="1"||e.charAt(t+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(e.substr(t,3).toUpperCase()==="A/P"||e.substr(t,5).toUpperCase()==="AM/PM"||e.substr(t,5).toUpperCase()==="/")return!0;++t;break;case"[":for(n=r;e.charAt(t++)!=="]"&&t<e.length;)n+=e.charAt(t);if(n.match(nb))return!0;break;case".":case"0":case"#":for(;t<e.length&&("0#?.,E+-%".indexOf(r=e.charAt(++t))>-1||r=="\\"&&e.charAt(t+1)=="-"&&"0#".indexOf(e.charAt(t+2))>-1););break;case"?":for(;e.charAt(++t)===r;);break;case"*":++t,(e.charAt(t)==" "||e.charAt(t)=="*")&&++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<e.length&&"0123456789".indexOf(e.charAt(++t))>-1;);break;case" ":++t;break;default:++t;break}return!1}function g8(e,t,r,n){for(var s=[],a="",i=0,o="",l="t",u,f,d,m="H";i<e.length;)switch(o=e.charAt(i)){case"G":if(!gd(e,i))throw new Error("unrecognized character "+o+" in "+e);s[s.length]={t:"G",v:"General"},i+=7;break;case'"':for(a="";(d=e.charCodeAt(++i))!==34&&i<e.length;)a+=String.fromCharCode(d);s[s.length]={t:"t",v:a},++i;break;case"\\":var p=e.charAt(++i),x=p==="("||p===")"?p:"t";s[s.length]={t:x,v:p},++i;break;case"_":s[s.length]={t:"t",v:" "},i+=2;break;case"@":s[s.length]={t:"T",v:t},++i;break;case"B":case"b":if(e.charAt(i+1)==="1"||e.charAt(i+1)==="2"){if(u==null&&(u=Ui(t,r,e.charAt(i+1)==="2"),u==null))return"";s[s.length]={t:"X",v:e.substr(i,2)},l=o,i+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":o=o.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0||u==null&&(u=Ui(t,r),u==null))return"";for(a=o;++i<e.length&&e.charAt(i).toLowerCase()===o;)a+=o;o==="m"&&l.toLowerCase()==="h"&&(o="M"),o==="h"&&(o=m),s[s.length]={t:o,v:a},l=o;break;case"A":case"a":case"":var g={t:o,v:o};if(u==null&&(u=Ui(t,r)),e.substr(i,3).toUpperCase()==="A/P"?(u!=null&&(g.v=u.H>=12?"P":"A"),g.t="T",m="h",i+=3):e.substr(i,5).toUpperCase()==="AM/PM"?(u!=null&&(g.v=u.H>=12?"PM":"AM"),g.t="T",i+=5,m="h"):e.substr(i,5).toUpperCase()==="/"?(u!=null&&(g.v=u.H>=12?"":""),g.t="T",i+=5,m="h"):(g.t="t",++i),u==null&&g.t==="T")return"";s[s.length]=g,l=o;break;case"[":for(a=o;e.charAt(i++)!=="]"&&i<e.length;)a+=e.charAt(i);if(a.slice(-1)!=="]")throw'unterminated "[" block: |'+a+"|";if(a.match(nb)){if(u==null&&(u=Ui(t,r),u==null))return"";s[s.length]={t:"Z",v:a.toLowerCase()},l=a.charAt(1)}else a.indexOf("$")>-1&&(a=(a.match(/\$([^-\[\]]*)/)||[])[1]||"$",Ml(e)||(s[s.length]={t:"t",v:a}));break;case".":if(u!=null){for(a=o;++i<e.length&&(o=e.charAt(i))==="0";)a+=o;s[s.length]={t:"s",v:a};break}case"0":case"#":for(a=o;++i<e.length&&"0#?.,E+-%".indexOf(o=e.charAt(i))>-1;)a+=o;s[s.length]={t:"n",v:a};break;case"?":for(a=o;e.charAt(++i)===o;)a+=o;s[s.length]={t:o,v:a},l=o;break;case"*":++i,(e.charAt(i)==" "||e.charAt(i)=="*")&&++i;break;case"(":case")":s[s.length]={t:n===1?"t":o,v:o},++i;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(a=o;i<e.length&&"0123456789".indexOf(e.charAt(++i))>-1;)a+=e.charAt(i);s[s.length]={t:"D",v:a};break;case" ":s[s.length]={t:o,v:o},++i;break;case"$":s[s.length]={t:"t",v:"$"},++i;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(o)===-1)throw new Error("unrecognized character "+o+" in "+e);s[s.length]={t:"t",v:o},++i;break}var _=0,k=0,E;for(i=s.length-1,l="t";i>=0;--i)switch(s[i].t){case"h":case"H":s[i].t=m,l="h",_<1&&(_=1);break;case"s":(E=s[i].v.match(/\.0+$/))&&(k=Math.max(k,E[0].length-1)),_<3&&(_=3);case"d":case"y":case"M":case"e":l=s[i].t;break;case"m":l==="s"&&(s[i].t="M",_<2&&(_=2));break;case"X":break;case"Z":_<1&&s[i].v.match(/[Hh]/)&&(_=1),_<2&&s[i].v.match(/[Mm]/)&&(_=2),_<3&&s[i].v.match(/[Ss]/)&&(_=3)}switch(_){case 0:break;case 1:u.u>=.5&&(u.u=0,++u.S),u.S>=60&&(u.S=0,++u.M),u.M>=60&&(u.M=0,++u.H);break;case 2:u.u>=.5&&(u.u=0,++u.S),u.S>=60&&(u.S=0,++u.M);break}var y="",b;for(i=0;i<s.length;++i)switch(s[i].t){case"t":case"T":case" ":case"D":break;case"X":s[i].v="",s[i].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":s[i].v=i8(s[i].t.charCodeAt(0),s[i].v,u,k),s[i].t="t";break;case"n":case"?":for(b=i+1;s[b]!=null&&((o=s[b].t)==="?"||o==="D"||(o===" "||o==="t")&&s[b+1]!=null&&(s[b+1].t==="?"||s[b+1].t==="t"&&s[b+1].v==="/")||s[i].t==="("&&(o===" "||o==="n"||o===")")||o==="t"&&(s[b].v==="/"||s[b].v===" "&&s[b+1]!=null&&s[b+1].t=="?"));)s[i].v+=s[b].v,s[b]={v:"",t:";"},++b;y+=s[i].v,i=b-1;break;case"G":s[i].t="t",s[i].v=ao(t,r);break}var O="",D,v;if(y.length>0){y.charCodeAt(0)==40?(D=t<0&&y.charCodeAt(0)===45?-t:t,v=ha("n",y,D)):(D=t<0&&n>1?-t:t,v=ha("n",y,D),D<0&&s[0]&&s[0].t=="t"&&(v=v.substr(1),s[0].v="-"+s[0].v)),b=v.length-1;var T=s.length;for(i=0;i<s.length;++i)if(s[i]!=null&&s[i].t!="t"&&s[i].v.indexOf(".")>-1){T=i;break}var S=s.length;if(T===s.length&&v.indexOf("E")===-1){for(i=s.length-1;i>=0;--i)s[i]==null||"n?".indexOf(s[i].t)===-1||(b>=s[i].v.length-1?(b-=s[i].v.length,s[i].v=v.substr(b+1,s[i].v.length)):b<0?s[i].v="":(s[i].v=v.substr(0,b+1),b=-1),s[i].t="t",S=i);b>=0&&S<s.length&&(s[S].v=v.substr(0,b+1)+s[S].v)}else if(T!==s.length&&v.indexOf("E")===-1){for(b=v.indexOf(".")-1,i=T;i>=0;--i)if(!(s[i]==null||"n?".indexOf(s[i].t)===-1)){for(f=s[i].v.indexOf(".")>-1&&i===T?s[i].v.indexOf(".")-1:s[i].v.length-1,O=s[i].v.substr(f+1);f>=0;--f)b>=0&&(s[i].v.charAt(f)==="0"||s[i].v.charAt(f)==="#")&&(O=v.charAt(b--)+O);s[i].v=O,s[i].t="t",S=i}for(b>=0&&S<s.length&&(s[S].v=v.substr(0,b+1)+s[S].v),b=v.indexOf(".")+1,i=T;i<s.length;++i)if(!(s[i]==null||"n?(".indexOf(s[i].t)===-1&&i!==T)){for(f=s[i].v.indexOf(".")>-1&&i===T?s[i].v.indexOf(".")+1:0,O=s[i].v.substr(0,f);f<s[i].v.length;++f)b<v.length&&(O+=v.charAt(b++));s[i].v=O,s[i].t="t",S=i}}}for(i=0;i<s.length;++i)s[i]!=null&&"n?".indexOf(s[i].t)>-1&&(D=n>1&&t<0&&i>0&&s[i-1].v==="-"?-t:t,s[i].v=ha(s[i].t,s[i].v,D),s[i].t="t");var N="";for(i=0;i!==s.length;++i)s[i]!=null&&(N+=s[i].v);return N}var bw=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function Iw(e,t){if(t==null)return!1;var r=parseFloat(t[2]);switch(t[1]){case"=":if(e==r)return!0;break;case">":if(e>r)return!0;break;case"<":if(e<r)return!0;break;case"<>":if(e!=r)return!0;break;case">=":if(e>=r)return!0;break;case"<=":if(e<=r)return!0;break}return!1}function x8(e,t){var r=p8(e),n=r.length,s=r[n-1].indexOf("@");if(n<4&&s>-1&&--n,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof t!="number")return[4,r.length===4||s>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=s>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=s>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=s>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var a=t>0?r[0]:t<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[n,a];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var i=r[0].match(bw),o=r[1].match(bw);return Iw(t,i)?[n,r[0]]:Iw(t,o)?[n,r[1]]:[n,r[i!=null&&o!=null?2:1]]}return[n,a]}function es(e,t,r){r==null&&(r={});var n="";switch(typeof e){case"string":e=="m/d/yy"&&r.dateNF?n=r.dateNF:n=e;break;case"number":e==14&&r.dateNF?n=r.dateNF:n=(r.table!=null?r.table:He)[e],n==null&&(n=r.table&&r.table[kw[e]]||He[kw[e]]),n==null&&(n=Z6[e]||"General");break}if(gd(n,0))return ao(t,r);t instanceof Date&&(t=XA(t,r.date1904));var s=x8(n,t);if(gd(s[1]))return ao(t,r);if(t===!0)t="TRUE";else if(t===!1)t="FALSE";else if(t===""||t==null)return"";return g8(s[1],t,r,s[0])}function Gi(e,t){if(typeof t!="number"){t=+t||-1;for(var r=0;r<392;++r){if(He[r]==null){t<0&&(t=r);continue}if(He[r]==e){t=r;break}}t<0&&(t=391)}return He[t]=e,t}function sb(){He=J6()}var v8={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},ab=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function y8(e){var t=typeof e=="number"?He[e]:e;return t=t.replace(ab,"(\\d+)"),new RegExp("^"+t+"$")}function _8(e,t,r){var n=-1,s=-1,a=-1,i=-1,o=-1,l=-1;(t.match(ab)||[]).forEach(function(d,m){var p=parseInt(r[m+1],10);switch(d.toLowerCase().charAt(0)){case"y":n=p;break;case"d":a=p;break;case"h":i=p;break;case"s":l=p;break;case"m":i>=0?o=p:s=p;break}}),l>=0&&o==-1&&s>=0&&(o=s,s=-1);var u=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(s>=1?s:1)).slice(-2)+"-"+("00"+(a>=1?a:1)).slice(-2);u.length==7&&(u="0"+u),u.length==8&&(u="20"+u);var f=("00"+(i>=0?i:0)).slice(-2)+":"+("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(l>=0?l:0)).slice(-2);return i==-1&&o==-1&&l==-1?u:n==-1&&s==-1&&a==-1?f:u+"T"+f}var w8=function(){var e={};e.version="1.2.0";function t(){for(var v=0,T=new Array(256),S=0;S!=256;++S)v=S,v=v&1?-306674912^v>>>1:v>>>1,v=v&1?-306674912^v>>>1:v>>>1,v=v&1?-306674912^v>>>1:v>>>1,v=v&1?-306674912^v>>>1:v>>>1,v=v&1?-306674912^v>>>1:v>>>1,v=v&1?-306674912^v>>>1:v>>>1,v=v&1?-306674912^v>>>1:v>>>1,v=v&1?-306674912^v>>>1:v>>>1,T[S]=v;return typeof Int32Array<"u"?new Int32Array(T):T}var r=t();function n(v){var T=0,S=0,N=0,C=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(N=0;N!=256;++N)C[N]=v[N];for(N=0;N!=256;++N)for(S=v[N],T=256+N;T<4096;T+=256)S=C[T]=S>>>8^v[S&255];var R=[];for(N=1;N!=16;++N)R[N-1]=typeof Int32Array<"u"?C.subarray(N*256,N*256+256):C.slice(N*256,N*256+256);return R}var s=n(r),a=s[0],i=s[1],o=s[2],l=s[3],u=s[4],f=s[5],d=s[6],m=s[7],p=s[8],x=s[9],g=s[10],_=s[11],k=s[12],E=s[13],y=s[14];function b(v,T){for(var S=T^-1,N=0,C=v.length;N<C;)S=S>>>8^r[(S^v.charCodeAt(N++))&255];return~S}function O(v,T){for(var S=T^-1,N=v.length-15,C=0;C<N;)S=y[v[C++]^S&255]^E[v[C++]^S>>8&255]^k[v[C++]^S>>16&255]^_[v[C++]^S>>>24]^g[v[C++]]^x[v[C++]]^p[v[C++]]^m[v[C++]]^d[v[C++]]^f[v[C++]]^u[v[C++]]^l[v[C++]]^o[v[C++]]^i[v[C++]]^a[v[C++]]^r[v[C++]];for(N+=15;C<N;)S=S>>>8^r[(S^v[C++])&255];return~S}function D(v,T){for(var S=T^-1,N=0,C=v.length,R=0,F=0;N<C;)R=v.charCodeAt(N++),R<128?S=S>>>8^r[(S^R)&255]:R<2048?(S=S>>>8^r[(S^(192|R>>6&31))&255],S=S>>>8^r[(S^(128|R&63))&255]):R>=55296&&R<57344?(R=(R&1023)+64,F=v.charCodeAt(N++)&1023,S=S>>>8^r[(S^(240|R>>8&7))&255],S=S>>>8^r[(S^(128|R>>2&63))&255],S=S>>>8^r[(S^(128|F>>6&15|(R&3)<<4))&255],S=S>>>8^r[(S^(128|F&63))&255]):(S=S>>>8^r[(S^(224|R>>12&15))&255],S=S>>>8^r[(S^(128|R>>6&63))&255],S=S>>>8^r[(S^(128|R&63))&255]);return~S}return e.table=r,e.bstr=b,e.buf=O,e.str=D,e}(),st=function(){var t={};t.version="1.2.1";function r(I,W){for(var P=I.split("/"),j=W.split("/"),V=0,B=0,ee=Math.min(P.length,j.length);V<ee;++V){if(B=P[V].length-j[V].length)return B;if(P[V]!=j[V])return P[V]<j[V]?-1:1}return P.length-j.length}function n(I){if(I.charAt(I.length-1)=="/")return I.slice(0,-1).indexOf("/")===-1?I:n(I.slice(0,-1));var W=I.lastIndexOf("/");return W===-1?I:I.slice(0,W+1)}function s(I){if(I.charAt(I.length-1)=="/")return s(I.slice(0,-1));var W=I.lastIndexOf("/");return W===-1?I:I.slice(W+1)}function a(I,W){typeof W=="string"&&(W=new Date(W));var P=W.getHours();P=P<<6|W.getMinutes(),P=P<<5|W.getSeconds()>>>1,I.write_shift(2,P);var j=W.getFullYear()-1980;j=j<<4|W.getMonth()+1,j=j<<5|W.getDate(),I.write_shift(2,j)}function i(I){var W=I.read_shift(2)&65535,P=I.read_shift(2)&65535,j=new Date,V=P&31;P>>>=5;var B=P&15;P>>>=4,j.setMilliseconds(0),j.setFullYear(P+1980),j.setMonth(B-1),j.setDate(V);var ee=W&31;W>>>=5;var le=W&63;return W>>>=6,j.setHours(W),j.setMinutes(le),j.setSeconds(ee<<1),j}function o(I){kr(I,0);for(var W={},P=0;I.l<=I.length-4;){var j=I.read_shift(2),V=I.read_shift(2),B=I.l+V,ee={};switch(j){case 21589:P=I.read_shift(1),P&1&&(ee.mtime=I.read_shift(4)),V>5&&(P&2&&(ee.atime=I.read_shift(4)),P&4&&(ee.ctime=I.read_shift(4))),ee.mtime&&(ee.mt=new Date(ee.mtime*1e3));break}I.l=B,W[j]=ee}return W}var l;function u(){return l||(l={})}function f(I,W){if(I[0]==80&&I[1]==75)return Na(I,W);if((I[0]|32)==109&&(I[1]|32)==105)return To(I,W);if(I.length<512)throw new Error("CFB file size "+I.length+" < 512");var P=3,j=512,V=0,B=0,ee=0,le=0,ie=0,se=[],re=I.slice(0,512);kr(re,0);var me=d(re);switch(P=me[0],P){case 3:j=512;break;case 4:j=4096;break;case 0:if(me[1]==0)return Na(I,W);default:throw new Error("Major Version: Expected 3 or 4 saw "+P)}j!==512&&(re=I.slice(0,j),kr(re,28));var Te=I.slice(0,j);m(re,P);var Ie=re.read_shift(4,"i");if(P===3&&Ie!==0)throw new Error("# Directory Sectors: Expected 0 saw "+Ie);re.l+=4,ee=re.read_shift(4,"i"),re.l+=4,re.chk("00100000","Mini Stream Cutoff Size: "),le=re.read_shift(4,"i"),V=re.read_shift(4,"i"),ie=re.read_shift(4,"i"),B=re.read_shift(4,"i");for(var ye=-1,ke=0;ke<109&&(ye=re.read_shift(4,"i"),!(ye<0));++ke)se[ke]=ye;var Me=p(I,j);_(ie,B,Me,j,se);var it=E(Me,ee,se,j);it[ee].name="!Directory",V>0&&le!==F&&(it[le].name="!MiniFAT"),it[se[0]].name="!FAT",it.fat_addrs=se,it.ssz=j;var Ye={},pt=[],fn=[],Ke=[];y(ee,it,Me,pt,V,Ye,fn,le),x(fn,Ke,pt),pt.shift();var ht={FileIndex:fn,FullPaths:Ke};return W&&W.raw&&(ht.raw={header:Te,sectors:Me}),ht}function d(I){if(I[I.l]==80&&I[I.l+1]==75)return[0,0];I.chk(oe,"Header Signature: "),I.l+=16;var W=I.read_shift(2,"u");return[I.read_shift(2,"u"),W]}function m(I,W){var P=9;switch(I.l+=2,P=I.read_shift(2)){case 9:if(W!=3)throw new Error("Sector Shift: Expected 9 saw "+P);break;case 12:if(W!=4)throw new Error("Sector Shift: Expected 12 saw "+P);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+P)}I.chk("0600","Mini Sector Shift: "),I.chk("000000000000","Reserved: ")}function p(I,W){for(var P=Math.ceil(I.length/W)-1,j=[],V=1;V<P;++V)j[V-1]=I.slice(V*W,(V+1)*W);return j[P-1]=I.slice(P*W),j}function x(I,W,P){for(var j=0,V=0,B=0,ee=0,le=0,ie=P.length,se=[],re=[];j<ie;++j)se[j]=re[j]=j,W[j]=P[j];for(;le<re.length;++le)j=re[le],V=I[j].L,B=I[j].R,ee=I[j].C,se[j]===j&&(V!==-1&&se[V]!==V&&(se[j]=se[V]),B!==-1&&se[B]!==B&&(se[j]=se[B])),ee!==-1&&(se[ee]=j),V!==-1&&j!=se[j]&&(se[V]=se[j],re.lastIndexOf(V)<le&&re.push(V)),B!==-1&&j!=se[j]&&(se[B]=se[j],re.lastIndexOf(B)<le&&re.push(B));for(j=1;j<ie;++j)se[j]===j&&(B!==-1&&se[B]!==B?se[j]=se[B]:V!==-1&&se[V]!==V&&(se[j]=se[V]));for(j=1;j<ie;++j)if(I[j].type!==0){if(le=j,le!=se[le])do le=se[le],W[j]=W[le]+"/"+W[j];while(le!==0&&se[le]!==-1&&le!=se[le]);se[j]=-1}for(W[0]+="/",j=1;j<ie;++j)I[j].type!==2&&(W[j]+="/")}function g(I,W,P){for(var j=I.start,V=I.size,B=[],ee=j;P&&V>0&&ee>=0;)B.push(W.slice(ee*R,ee*R+R)),V-=R,ee=Pi(P,ee*4);return B.length===0?or(0):Ha(B).slice(0,I.size)}function _(I,W,P,j,V){var B=F;if(I===F){if(W!==0)throw new Error("DIFAT chain shorter than expected")}else if(I!==-1){var ee=P[I],le=(j>>>2)-1;if(!ee)return;for(var ie=0;ie<le&&(B=Pi(ee,ie*4))!==F;++ie)V.push(B);_(Pi(ee,j-4),W-1,P,j,V)}}function k(I,W,P,j,V){var B=[],ee=[];V||(V=[]);var le=j-1,ie=0,se=0;for(ie=W;ie>=0;){V[ie]=!0,B[B.length]=ie,ee.push(I[ie]);var re=P[Math.floor(ie*4/j)];if(se=ie*4&le,j<4+se)throw new Error("FAT boundary crossed: "+ie+" 4 "+j);if(!I[re])break;ie=Pi(I[re],se)}return{nodes:B,data:Lw([ee])}}function E(I,W,P,j){var V=I.length,B=[],ee=[],le=[],ie=[],se=j-1,re=0,me=0,Te=0,Ie=0;for(re=0;re<V;++re)if(le=[],Te=re+W,Te>=V&&(Te-=V),!ee[Te]){ie=[];var ye=[];for(me=Te;me>=0;){ye[me]=!0,ee[me]=!0,le[le.length]=me,ie.push(I[me]);var ke=P[Math.floor(me*4/j)];if(Ie=me*4&se,j<4+Ie)throw new Error("FAT boundary crossed: "+me+" 4 "+j);if(!I[ke]||(me=Pi(I[ke],Ie),ye[me]))break}B[Te]={nodes:le,data:Lw([ie])}}return B}function y(I,W,P,j,V,B,ee,le){for(var ie=0,se=j.length?2:0,re=W[I].data,me=0,Te=0,Ie;me<re.length;me+=128){var ye=re.slice(me,me+128);kr(ye,64),Te=ye.read_shift(2),Ie=kv(ye,0,Te-se),j.push(Ie);var ke={name:Ie,type:ye.read_shift(1),color:ye.read_shift(1),L:ye.read_shift(4,"i"),R:ye.read_shift(4,"i"),C:ye.read_shift(4,"i"),clsid:ye.read_shift(16),state:ye.read_shift(4,"i"),start:0,size:0},Me=ye.read_shift(2)+ye.read_shift(2)+ye.read_shift(2)+ye.read_shift(2);Me!==0&&(ke.ct=b(ye,ye.l-8));var it=ye.read_shift(2)+ye.read_shift(2)+ye.read_shift(2)+ye.read_shift(2);it!==0&&(ke.mt=b(ye,ye.l-8)),ke.start=ye.read_shift(4,"i"),ke.size=ye.read_shift(4,"i"),ke.size<0&&ke.start<0&&(ke.size=ke.type=0,ke.start=F,ke.name=""),ke.type===5?(ie=ke.start,V>0&&ie!==F&&(W[ie].name="!StreamData")):ke.size>=4096?(ke.storage="fat",W[ke.start]===void 0&&(W[ke.start]=k(P,ke.start,W.fat_addrs,W.ssz)),W[ke.start].name=ke.name,ke.content=W[ke.start].data.slice(0,ke.size)):(ke.storage="minifat",ke.size<0?ke.size=0:ie!==F&&ke.start!==F&&W[ie]&&(ke.content=g(ke,W[ie].data,(W[le]||{}).data))),ke.content&&kr(ke.content,0),B[Ie]=ke,ee.push(ke)}}function b(I,W){return new Date((bn(I,W+4)/1e7*Math.pow(2,32)+bn(I,W)/1e7-11644473600)*1e3)}function O(I,W){return u(),f(l.readFileSync(I),W)}function D(I,W){var P=W&&W.type;switch(P||tt&&Buffer.isBuffer(I)&&(P="buffer"),P||"base64"){case"file":return O(I,W);case"base64":return f(ms(Mn(I)),W);case"binary":return f(ms(I),W)}return f(I,W)}function v(I,W){var P=W||{},j=P.root||"Root Entry";if(I.FullPaths||(I.FullPaths=[]),I.FileIndex||(I.FileIndex=[]),I.FullPaths.length!==I.FileIndex.length)throw new Error("inconsistent CFB structure");I.FullPaths.length===0&&(I.FullPaths[0]=j+"/",I.FileIndex[0]={name:j,type:5}),P.CLSID&&(I.FileIndex[0].clsid=P.CLSID),T(I)}function T(I){var W="Sh33tJ5";if(!st.find(I,"/"+W)){var P=or(4);P[0]=55,P[1]=P[3]=50,P[2]=54,I.FileIndex.push({name:W,type:2,content:P,size:4,L:69,R:69,C:69}),I.FullPaths.push(I.FullPaths[0]+W),S(I)}}function S(I,W){v(I);for(var P=!1,j=!1,V=I.FullPaths.length-1;V>=0;--V){var B=I.FileIndex[V];switch(B.type){case 0:j?P=!0:(I.FileIndex.pop(),I.FullPaths.pop());break;case 1:case 2:case 5:j=!0,isNaN(B.R*B.L*B.C)&&(P=!0),B.R>-1&&B.L>-1&&B.R==B.L&&(P=!0);break;default:P=!0;break}}if(!(!P&&!W)){var ee=new Date(1987,1,19),le=0,ie=Object.create?Object.create(null):{},se=[];for(V=0;V<I.FullPaths.length;++V)ie[I.FullPaths[V]]=!0,I.FileIndex[V].type!==0&&se.push([I.FullPaths[V],I.FileIndex[V]]);for(V=0;V<se.length;++V){var re=n(se[V][0]);j=ie[re],j||(se.push([re,{name:s(re).replace("/",""),type:1,clsid:de,ct:ee,mt:ee,content:null}]),ie[re]=!0)}for(se.sort(function(Ie,ye){return r(Ie[0],ye[0])}),I.FullPaths=[],I.FileIndex=[],V=0;V<se.length;++V)I.FullPaths[V]=se[V][0],I.FileIndex[V]=se[V][1];for(V=0;V<se.length;++V){var me=I.FileIndex[V],Te=I.FullPaths[V];if(me.name=s(Te).replace("/",""),me.L=me.R=me.C=-(me.color=1),me.size=me.content?me.content.length:0,me.start=0,me.clsid=me.clsid||de,V===0)me.C=se.length>1?1:-1,me.size=0,me.type=5;else if(Te.slice(-1)=="/"){for(le=V+1;le<se.length&&n(I.FullPaths[le])!=Te;++le);for(me.C=le>=se.length?-1:le,le=V+1;le<se.length&&n(I.FullPaths[le])!=n(Te);++le);me.R=le>=se.length?-1:le,me.type=1}else n(I.FullPaths[V+1]||"")==n(Te)&&(me.R=V+1),me.type=2}}}function N(I,W){var P=W||{};if(P.fileType=="mad")return ir(I,P);switch(S(I),P.fileType){case"zip":return Xs(I,P)}var j=function(Ie){for(var ye=0,ke=0,Me=0;Me<Ie.FileIndex.length;++Me){var it=Ie.FileIndex[Me];if(it.content){var Ye=it.content.length;Ye>0&&(Ye<4096?ye+=Ye+63>>6:ke+=Ye+511>>9)}}for(var pt=Ie.FullPaths.length+3>>2,fn=ye+7>>3,Ke=ye+127>>7,ht=fn+ke+pt+Ke,_r=ht+127>>7,Bn=_r<=109?0:Math.ceil((_r-109)/127);ht+_r+Bn+127>>7>_r;)Bn=++_r<=109?0:Math.ceil((_r-109)/127);var rt=[1,Bn,_r,Ke,pt,ke,ye,0];return Ie.FileIndex[0].size=ye<<6,rt[7]=(Ie.FileIndex[0].start=rt[0]+rt[1]+rt[2]+rt[3]+rt[4]+rt[5])+(rt[6]+7>>3),rt}(I),V=or(j[7]<<9),B=0,ee=0;{for(B=0;B<8;++B)V.write_shift(1,te[B]);for(B=0;B<8;++B)V.write_shift(2,0);for(V.write_shift(2,62),V.write_shift(2,3),V.write_shift(2,65534),V.write_shift(2,9),V.write_shift(2,6),B=0;B<3;++B)V.write_shift(2,0);for(V.write_shift(4,0),V.write_shift(4,j[2]),V.write_shift(4,j[0]+j[1]+j[2]+j[3]-1),V.write_shift(4,0),V.write_shift(4,4096),V.write_shift(4,j[3]?j[0]+j[1]+j[2]-1:F),V.write_shift(4,j[3]),V.write_shift(-4,j[1]?j[0]-1:F),V.write_shift(4,j[1]),B=0;B<109;++B)V.write_shift(-4,B<j[2]?j[1]+B:-1)}if(j[1])for(ee=0;ee<j[1];++ee){for(;B<236+ee*127;++B)V.write_shift(-4,B<j[2]?j[1]+B:-1);V.write_shift(-4,ee===j[1]-1?F:ee+1)}var le=function(Ie){for(ee+=Ie;B<ee-1;++B)V.write_shift(-4,B+1);Ie&&(++B,V.write_shift(-4,F))};for(ee=B=0,ee+=j[1];B<ee;++B)V.write_shift(-4,ae.DIFSECT);for(ee+=j[2];B<ee;++B)V.write_shift(-4,ae.FATSECT);le(j[3]),le(j[4]);for(var ie=0,se=0,re=I.FileIndex[0];ie<I.FileIndex.length;++ie)re=I.FileIndex[ie],re.content&&(se=re.content.length,!(se<4096)&&(re.start=ee,le(se+511>>9)));for(le(j[6]+7>>3);V.l&511;)V.write_shift(-4,ae.ENDOFCHAIN);for(ee=B=0,ie=0;ie<I.FileIndex.length;++ie)re=I.FileIndex[ie],re.content&&(se=re.content.length,!(!se||se>=4096)&&(re.start=ee,le(se+63>>6)));for(;V.l&511;)V.write_shift(-4,ae.ENDOFCHAIN);for(B=0;B<j[4]<<2;++B){var me=I.FullPaths[B];if(!me||me.length===0){for(ie=0;ie<17;++ie)V.write_shift(4,0);for(ie=0;ie<3;++ie)V.write_shift(4,-1);for(ie=0;ie<12;++ie)V.write_shift(4,0);continue}re=I.FileIndex[B],B===0&&(re.start=re.size?re.start-1:F);var Te=B===0&&P.root||re.name;if(se=2*(Te.length+1),V.write_shift(64,Te,"utf16le"),V.write_shift(2,se),V.write_shift(1,re.type),V.write_shift(1,re.color),V.write_shift(-4,re.L),V.write_shift(-4,re.R),V.write_shift(-4,re.C),re.clsid)V.write_shift(16,re.clsid,"hex");else for(ie=0;ie<4;++ie)V.write_shift(4,0);V.write_shift(4,re.state||0),V.write_shift(4,0),V.write_shift(4,0),V.write_shift(4,0),V.write_shift(4,0),V.write_shift(4,re.start),V.write_shift(4,re.size),V.write_shift(4,0)}for(B=1;B<I.FileIndex.length;++B)if(re=I.FileIndex[B],re.size>=4096)if(V.l=re.start+1<<9,tt&&Buffer.isBuffer(re.content))re.content.copy(V,V.l,0,re.size),V.l+=re.size+511&-512;else{for(ie=0;ie<re.size;++ie)V.write_shift(1,re.content[ie]);for(;ie&511;++ie)V.write_shift(1,0)}for(B=1;B<I.FileIndex.length;++B)if(re=I.FileIndex[B],re.size>0&&re.size<4096)if(tt&&Buffer.isBuffer(re.content))re.content.copy(V,V.l,0,re.size),V.l+=re.size+63&-64;else{for(ie=0;ie<re.size;++ie)V.write_shift(1,re.content[ie]);for(;ie&63;++ie)V.write_shift(1,0)}if(tt)V.l=V.length;else for(;V.l<V.length;)V.write_shift(1,0);return V}function C(I,W){var P=I.FullPaths.map(function(ie){return ie.toUpperCase()}),j=P.map(function(ie){var se=ie.split("/");return se[se.length-(ie.slice(-1)=="/"?2:1)]}),V=!1;W.charCodeAt(0)===47?(V=!0,W=P[0].slice(0,-1)+W):V=W.indexOf("/")!==-1;var B=W.toUpperCase(),ee=V===!0?P.indexOf(B):j.indexOf(B);if(ee!==-1)return I.FileIndex[ee];var le=!B.match(xc);for(B=B.replace(nn,""),le&&(B=B.replace(xc,"!")),ee=0;ee<P.length;++ee)if((le?P[ee].replace(xc,"!"):P[ee]).replace(nn,"")==B||(le?j[ee].replace(xc,"!"):j[ee]).replace(nn,"")==B)return I.FileIndex[ee];return null}var R=64,F=-2,oe="d0cf11e0a1b11ae1",te=[208,207,17,224,161,177,26,225],de="00000000000000000000000000000000",ae={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:F,FREESECT:-1,HEADER_SIGNATURE:oe,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:de,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function X(I,W,P){u();var j=N(I,P);l.writeFileSync(W,j)}function H(I){for(var W=new Array(I.length),P=0;P<I.length;++P)W[P]=String.fromCharCode(I[P]);return W.join("")}function Z(I,W){var P=N(I,W);switch(W&&W.type||"buffer"){case"file":return u(),l.writeFileSync(W.filename,P),P;case"binary":return typeof P=="string"?P:H(P);case"base64":return _w(typeof P=="string"?P:H(P));case"buffer":if(tt)return Buffer.isBuffer(P)?P:po(P);case"array":return typeof P=="string"?ms(P):P}return P}var Y;function M(I){try{var W=I.InflateRaw,P=new W;if(P._processChunk(new Uint8Array([3,0]),P._finishFlushFlag),P.bytesRead)Y=I;else throw new Error("zlib does not expose bytesRead")}catch(j){console.error("cannot use native zlib: "+(j.message||j))}}function q(I,W){if(!Y)return qs(I,W);var P=Y.InflateRaw,j=new P,V=j._processChunk(I.slice(I.l),j._finishFlushFlag);return I.l+=j.bytesRead,V}function K(I){return Y?Y.deflateRawSync(I):Be(I)}var L=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],J=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],fe=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function we(I){var W=(I<<1|I<<11)&139536|(I<<5|I<<15)&558144;return(W>>16|W>>8|W)&255}for(var ge=typeof Uint8Array<"u",pe=ge?new Uint8Array(256):[],Pe=0;Pe<256;++Pe)pe[Pe]=we(Pe);function G(I,W){var P=pe[I&255];return W<=8?P>>>8-W:(P=P<<8|pe[I>>8&255],W<=16?P>>>16-W:(P=P<<8|pe[I>>16&255],P>>>24-W))}function Xe(I,W){var P=W&7,j=W>>>3;return(I[j]|(P<=6?0:I[j+1]<<8))>>>P&3}function Ve(I,W){var P=W&7,j=W>>>3;return(I[j]|(P<=5?0:I[j+1]<<8))>>>P&7}function Ze(I,W){var P=W&7,j=W>>>3;return(I[j]|(P<=4?0:I[j+1]<<8))>>>P&15}function Oe(I,W){var P=W&7,j=W>>>3;return(I[j]|(P<=3?0:I[j+1]<<8))>>>P&31}function Se(I,W){var P=W&7,j=W>>>3;return(I[j]|(P<=1?0:I[j+1]<<8))>>>P&127}function yt(I,W,P){var j=W&7,V=W>>>3,B=(1<<P)-1,ee=I[V]>>>j;return P<8-j||(ee|=I[V+1]<<8-j,P<16-j)||(ee|=I[V+2]<<16-j,P<24-j)||(ee|=I[V+3]<<24-j),ee&B}function Qt(I,W,P){var j=W&7,V=W>>>3;return j<=5?I[V]|=(P&7)<<j:(I[V]|=P<<j&255,I[V+1]=(P&7)>>8-j),W+3}function dr(I,W,P){var j=W&7,V=W>>>3;return P=(P&1)<<j,I[V]|=P,W+1}function cn(I,W,P){var j=W&7,V=W>>>3;return P<<=j,I[V]|=P&255,P>>>=8,I[V+1]=P,W+8}function Gs(I,W,P){var j=W&7,V=W>>>3;return P<<=j,I[V]|=P&255,P>>>=8,I[V+1]=P&255,I[V+2]=P>>>8,W+16}function un(I,W){var P=I.length,j=2*P>W?2*P:W+5,V=0;if(P>=W)return I;if(tt){var B=ww(j);if(I.copy)I.copy(B);else for(;V<I.length;++V)B[V]=I[V];return B}else if(ge){var ee=new Uint8Array(j);if(ee.set)ee.set(I);else for(;V<P;++V)ee[V]=I[V];return ee}return I.length=j,I}function At(I){for(var W=new Array(I),P=0;P<I;++P)W[P]=0;return W}function mr(I,W,P){var j=1,V=0,B=0,ee=0,le=0,ie=I.length,se=ge?new Uint16Array(32):At(32);for(B=0;B<32;++B)se[B]=0;for(B=ie;B<P;++B)I[B]=0;ie=I.length;var re=ge?new Uint16Array(ie):At(ie);for(B=0;B<ie;++B)se[V=I[B]]++,j<V&&(j=V),re[B]=0;for(se[0]=0,B=1;B<=j;++B)se[B+16]=le=le+se[B-1]<<1;for(B=0;B<ie;++B)le=I[B],le!=0&&(re[B]=se[le+16]++);var me=0;for(B=0;B<ie;++B)if(me=I[B],me!=0)for(le=G(re[B],j)>>j-me,ee=(1<<j+4-me)-1;ee>=0;--ee)W[le|ee<<me]=me&15|B<<4;return j}var _t=ge?new Uint16Array(512):At(512),bt=ge?new Uint16Array(32):At(32);if(!ge){for(var mt=0;mt<512;++mt)_t[mt]=0;for(mt=0;mt<32;++mt)bt[mt]=0}(function(){for(var I=[],W=0;W<32;W++)I.push(5);mr(I,bt,32);var P=[];for(W=0;W<=143;W++)P.push(8);for(;W<=255;W++)P.push(9);for(;W<=279;W++)P.push(7);for(;W<=287;W++)P.push(8);mr(P,_t,288)})();var jt=function(){for(var W=ge?new Uint8Array(32768):[],P=0,j=0;P<fe.length-1;++P)for(;j<fe[P+1];++j)W[j]=P;for(;j<32768;++j)W[j]=29;var V=ge?new Uint8Array(259):[];for(P=0,j=0;P<J.length-1;++P)for(;j<J[P+1];++j)V[j]=P;function B(le,ie){for(var se=0;se<le.length;){var re=Math.min(65535,le.length-se),me=se+re==le.length;for(ie.write_shift(1,+me),ie.write_shift(2,re),ie.write_shift(2,~re&65535);re-- >0;)ie[ie.l++]=le[se++]}return ie.l}function ee(le,ie){for(var se=0,re=0,me=ge?new Uint16Array(32768):[];re<le.length;){var Te=Math.min(65535,le.length-re);if(Te<10){for(se=Qt(ie,se,+(re+Te==le.length)),se&7&&(se+=8-(se&7)),ie.l=se/8|0,ie.write_shift(2,Te),ie.write_shift(2,~Te&65535);Te-- >0;)ie[ie.l++]=le[re++];se=ie.l*8;continue}se=Qt(ie,se,+(re+Te==le.length)+2);for(var Ie=0;Te-- >0;){var ye=le[re];Ie=(Ie<<5^ye)&32767;var ke=-1,Me=0;if((ke=me[Ie])&&(ke|=re&-32768,ke>re&&(ke-=32768),ke<re))for(;le[ke+Me]==le[re+Me]&&Me<250;)++Me;if(Me>2){ye=V[Me],ye<=22?se=cn(ie,se,pe[ye+1]>>1)-1:(cn(ie,se,3),se+=5,cn(ie,se,pe[ye-23]>>5),se+=3);var it=ye<8?0:ye-4>>2;it>0&&(Gs(ie,se,Me-J[ye]),se+=it),ye=W[re-ke],se=cn(ie,se,pe[ye]>>3),se-=3;var Ye=ye<4?0:ye-2>>1;Ye>0&&(Gs(ie,se,re-ke-fe[ye]),se+=Ye);for(var pt=0;pt<Me;++pt)me[Ie]=re&32767,Ie=(Ie<<5^le[re])&32767,++re;Te-=Me-1}else ye<=143?ye=ye+48:se=dr(ie,se,1),se=cn(ie,se,pe[ye]),me[Ie]=re&32767,++re}se=cn(ie,se,0)-1}return ie.l=(se+7)/8|0,ie.l}return function(ie,se){return ie.length<8?B(ie,se):ee(ie,se)}}();function Be(I){var W=or(50+Math.floor(I.length*1.1)),P=jt(I,W);return W.slice(0,P)}var wt=ge?new Uint16Array(32768):At(32768),Jt=ge?new Uint16Array(32768):At(32768),ft=ge?new Uint16Array(128):At(128),Tn=1,Ks=1;function wo(I,W){var P=Oe(I,W)+257;W+=5;var j=Oe(I,W)+1;W+=5;var V=Ze(I,W)+4;W+=4;for(var B=0,ee=ge?new Uint8Array(19):At(19),le=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],ie=1,se=ge?new Uint8Array(8):At(8),re=ge?new Uint8Array(8):At(8),me=ee.length,Te=0;Te<V;++Te)ee[L[Te]]=B=Ve(I,W),ie<B&&(ie=B),se[B]++,W+=3;var Ie=0;for(se[0]=0,Te=1;Te<=ie;++Te)re[Te]=Ie=Ie+se[Te-1]<<1;for(Te=0;Te<me;++Te)(Ie=ee[Te])!=0&&(le[Te]=re[Ie]++);var ye=0;for(Te=0;Te<me;++Te)if(ye=ee[Te],ye!=0){Ie=pe[le[Te]]>>8-ye;for(var ke=(1<<7-ye)-1;ke>=0;--ke)ft[Ie|ke<<ye]=ye&7|Te<<3}var Me=[];for(ie=1;Me.length<P+j;)switch(Ie=ft[Se(I,W)],W+=Ie&7,Ie>>>=3){case 16:for(B=3+Xe(I,W),W+=2,Ie=Me[Me.length-1];B-- >0;)Me.push(Ie);break;case 17:for(B=3+Ve(I,W),W+=3;B-- >0;)Me.push(0);break;case 18:for(B=11+Se(I,W),W+=7;B-- >0;)Me.push(0);break;default:Me.push(Ie),ie<Ie&&(ie=Ie);break}var it=Me.slice(0,P),Ye=Me.slice(P);for(Te=P;Te<286;++Te)it[Te]=0;for(Te=j;Te<30;++Te)Ye[Te]=0;return Tn=mr(it,wt,286),Ks=mr(Ye,Jt,30),W}function Ul(I,W){if(I[0]==3&&!(I[1]&3))return[xi(W),2];for(var P=0,j=0,V=ww(W||1<<18),B=0,ee=V.length>>>0,le=0,ie=0;!(j&1);){if(j=Ve(I,P),P+=3,j>>>1)j>>1==1?(le=9,ie=5):(P=wo(I,P),le=Tn,ie=Ks);else{P&7&&(P+=8-(P&7));var se=I[P>>>3]|I[(P>>>3)+1]<<8;if(P+=32,se>0)for(!W&&ee<B+se&&(V=un(V,B+se),ee=V.length);se-- >0;)V[B++]=I[P>>>3],P+=8;continue}for(;;){!W&&ee<B+32767&&(V=un(V,B+32767),ee=V.length);var re=yt(I,P,le),me=j>>>1==1?_t[re]:wt[re];if(P+=me&15,me>>>=4,!(me>>>8&255))V[B++]=me;else{if(me==256)break;me-=257;var Te=me<8?0:me-4>>2;Te>5&&(Te=0);var Ie=B+J[me];Te>0&&(Ie+=yt(I,P,Te),P+=Te),re=yt(I,P,ie),me=j>>>1==1?bt[re]:Jt[re],P+=me&15,me>>>=4;var ye=me<4?0:me-2>>1,ke=fe[me];for(ye>0&&(ke+=yt(I,P,ye),P+=ye),!W&&ee<Ie&&(V=un(V,Ie+100),ee=V.length);B<Ie;)V[B]=V[B-ke],++B}}}return W?[V,P+7>>>3]:[V.slice(0,B),P+7>>>3]}function qs(I,W){var P=I.slice(I.l||0),j=Ul(P,W);return I.l+=j[1],j[0]}function Ss(I,W){if(I)typeof console<"u"&&console.error(W);else throw new Error(W)}function Na(I,W){var P=I;kr(P,0);var j=[],V=[],B={FileIndex:j,FullPaths:V};v(B,{root:W.root});for(var ee=P.length-4;(P[ee]!=80||P[ee+1]!=75||P[ee+2]!=5||P[ee+3]!=6)&&ee>=0;)--ee;P.l=ee+4,P.l+=4;var le=P.read_shift(2);P.l+=6;var ie=P.read_shift(4);for(P.l=ie,ee=0;ee<le;++ee){P.l+=20;var se=P.read_shift(4),re=P.read_shift(4),me=P.read_shift(2),Te=P.read_shift(2),Ie=P.read_shift(2);P.l+=8;var ye=P.read_shift(4),ke=o(P.slice(P.l+me,P.l+me+Te));P.l+=me+Te+Ie;var Me=P.l;P.l=ye+4,ns(P,se,re,B,ke),P.l=Me}return B}function ns(I,W,P,j,V){I.l+=2;var B=I.read_shift(2),ee=I.read_shift(2),le=i(I);if(B&8257)throw new Error("Unsupported ZIP encryption");for(var ie=I.read_shift(4),se=I.read_shift(4),re=I.read_shift(4),me=I.read_shift(2),Te=I.read_shift(2),Ie="",ye=0;ye<me;++ye)Ie+=String.fromCharCode(I[I.l++]);if(Te){var ke=o(I.slice(I.l,I.l+Te));(ke[21589]||{}).mt&&(le=ke[21589].mt),((V||{})[21589]||{}).mt&&(le=V[21589].mt)}I.l+=Te;var Me=I.slice(I.l,I.l+se);switch(ee){case 8:Me=q(I,re);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+ee)}var it=!1;B&8&&(ie=I.read_shift(4),ie==134695760&&(ie=I.read_shift(4),it=!0),se=I.read_shift(4),re=I.read_shift(4)),se!=W&&Ss(it,"Bad compressed size: "+W+" != "+se),re!=P&&Ss(it,"Bad uncompressed size: "+P+" != "+re),ne(j,Ie,Me,{unsafe:!0,mt:le})}function Xs(I,W){var P=W||{},j=[],V=[],B=or(1),ee=P.compression?8:0,le=0,ie=0,se=0,re=0,me=0,Te=I.FullPaths[0],Ie=Te,ye=I.FileIndex[0],ke=[],Me=0;for(ie=1;ie<I.FullPaths.length;++ie)if(Ie=I.FullPaths[ie].slice(Te.length),ye=I.FileIndex[ie],!(!ye.size||!ye.content||Ie=="Sh33tJ5")){var it=re,Ye=or(Ie.length);for(se=0;se<Ie.length;++se)Ye.write_shift(1,Ie.charCodeAt(se)&127);Ye=Ye.slice(0,Ye.l),ke[me]=w8.buf(ye.content,0);var pt=ye.content;ee==8&&(pt=K(pt)),B=or(30),B.write_shift(4,67324752),B.write_shift(2,20),B.write_shift(2,le),B.write_shift(2,ee),ye.mt?a(B,ye.mt):B.write_shift(4,0),B.write_shift(-4,ke[me]),B.write_shift(4,pt.length),B.write_shift(4,ye.content.length),B.write_shift(2,Ye.length),B.write_shift(2,0),re+=B.length,j.push(B),re+=Ye.length,j.push(Ye),re+=pt.length,j.push(pt),B=or(46),B.write_shift(4,33639248),B.write_shift(2,0),B.write_shift(2,20),B.write_shift(2,le),B.write_shift(2,ee),B.write_shift(4,0),B.write_shift(-4,ke[me]),B.write_shift(4,pt.length),B.write_shift(4,ye.content.length),B.write_shift(2,Ye.length),B.write_shift(2,0),B.write_shift(2,0),B.write_shift(2,0),B.write_shift(2,0),B.write_shift(4,0),B.write_shift(4,it),Me+=B.l,V.push(B),Me+=Ye.length,V.push(Ye),++me}return B=or(22),B.write_shift(4,101010256),B.write_shift(2,0),B.write_shift(2,0),B.write_shift(2,me),B.write_shift(2,me),B.write_shift(4,Me),B.write_shift(4,re),B.write_shift(2,0),Ha([Ha(j),Ha(V),B])}var As={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function Un(I,W){if(I.ctype)return I.ctype;var P=I.name||"",j=P.match(/\.([^\.]+)$/);return j&&As[j[1]]||W&&(j=(P=W).match(/[\.\\]([^\.\\])+$/),j&&As[j[1]])?As[j[1]]:"application/octet-stream"}function Eo(I){for(var W=_w(I),P=[],j=0;j<W.length;j+=76)P.push(W.slice(j,j+76));return P.join(`\r
`)+`\r
`}function Ys(I){var W=I.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(se){var re=se.charCodeAt(0).toString(16).toUpperCase();return"="+(re.length==1?"0"+re:re)});W=W.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),W.charAt(0)==`
`&&(W="=0D"+W.slice(1)),W=W.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var P=[],j=W.split(`\r
`),V=0;V<j.length;++V){var B=j[V];if(B.length==0){P.push("");continue}for(var ee=0;ee<B.length;){var le=76,ie=B.slice(ee,ee+le);ie.charAt(le-1)=="="?le--:ie.charAt(le-2)=="="?le-=2:ie.charAt(le-3)=="="&&(le-=3),ie=B.slice(ee,ee+le),ee+=le,ee<B.length&&(ie+="="),P.push(ie)}}return P.join(`\r
`)}function Qs(I){for(var W=[],P=0;P<I.length;++P){for(var j=I[P];P<=I.length&&j.charAt(j.length-1)=="=";)j=j.slice(0,j.length-1)+I[++P];W.push(j)}for(var V=0;V<W.length;++V)W[V]=W[V].replace(/[=][0-9A-Fa-f]{2}/g,function(B){return String.fromCharCode(parseInt(B.slice(1),16))});return ms(W.join(`\r
`))}function Vn(I,W,P){for(var j="",V="",B="",ee,le=0;le<10;++le){var ie=W[le];if(!ie||ie.match(/^\s*$/))break;var se=ie.match(/^(.*?):\s*([^\s].*)$/);if(se)switch(se[1].toLowerCase()){case"content-location":j=se[2].trim();break;case"content-type":B=se[2].trim();break;case"content-transfer-encoding":V=se[2].trim();break}}switch(++le,V.toLowerCase()){case"base64":ee=ms(Mn(W.slice(le).join("")));break;case"quoted-printable":ee=Qs(W.slice(le));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+V)}var re=ne(I,j.slice(P.length),ee,{unsafe:!0});B&&(re.ctype=B)}function To(I,W){if(H(I.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var P=W&&W.root||"",j=(tt&&Buffer.isBuffer(I)?I.toString("binary"):H(I)).split(`\r
`),V=0,B="";for(V=0;V<j.length;++V)if(B=j[V],!!/^Content-Location:/i.test(B)&&(B=B.slice(B.indexOf("file")),P||(P=B.slice(0,B.lastIndexOf("/")+1)),B.slice(0,P.length)!=P))for(;P.length>0&&(P=P.slice(0,P.length-1),P=P.slice(0,P.lastIndexOf("/")+1),B.slice(0,P.length)!=P););var ee=(j[1]||"").match(/boundary="(.*?)"/);if(!ee)throw new Error("MAD cannot find boundary");var le="--"+(ee[1]||""),ie=[],se=[],re={FileIndex:ie,FullPaths:se};v(re);var me,Te=0;for(V=0;V<j.length;++V){var Ie=j[V];Ie!==le&&Ie!==le+"--"||(Te++&&Vn(re,j.slice(me,V),P),me=V)}return re}function ir(I,W){var P=W||{},j=P.boundary||"SheetJS";j="------="+j;for(var V=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+j.slice(2)+'"',"","",""],B=I.FullPaths[0],ee=B,le=I.FileIndex[0],ie=1;ie<I.FullPaths.length;++ie)if(ee=I.FullPaths[ie].slice(B.length),le=I.FileIndex[ie],!(!le.size||!le.content||ee=="Sh33tJ5")){ee=ee.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(Me){return"_x"+Me.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(Me){return"_u"+Me.charCodeAt(0).toString(16)+"_"});for(var se=le.content,re=tt&&Buffer.isBuffer(se)?se.toString("binary"):H(se),me=0,Te=Math.min(1024,re.length),Ie=0,ye=0;ye<=Te;++ye)(Ie=re.charCodeAt(ye))>=32&&Ie<128&&++me;var ke=me>=Te*4/5;V.push(j),V.push("Content-Location: "+(P.root||"file:///C:/SheetJS/")+ee),V.push("Content-Transfer-Encoding: "+(ke?"quoted-printable":"base64")),V.push("Content-Type: "+Un(le,ee)),V.push(""),V.push(ke?Ys(re):Eo(re))}return V.push(j+`--\r
`),V.join(`\r
`)}function Q(I){var W={};return v(W,I),W}function ne(I,W,P,j){var V=j&&j.unsafe;V||v(I);var B=!V&&st.find(I,W);if(!B){var ee=I.FullPaths[0];W.slice(0,ee.length)==ee?ee=W:(ee.slice(-1)!="/"&&(ee+="/"),ee=(ee+W).replace("//","/")),B={name:s(W),type:2},I.FileIndex.push(B),I.FullPaths.push(ee),V||st.utils.cfb_gc(I)}return B.content=P,B.size=P?P.length:0,j&&(j.CLSID&&(B.clsid=j.CLSID),j.mt&&(B.mt=j.mt),j.ct&&(B.ct=j.ct)),B}function ue(I,W){v(I);var P=st.find(I,W);if(P){for(var j=0;j<I.FileIndex.length;++j)if(I.FileIndex[j]==P)return I.FileIndex.splice(j,1),I.FullPaths.splice(j,1),!0}return!1}function ve(I,W,P){v(I);var j=st.find(I,W);if(j){for(var V=0;V<I.FileIndex.length;++V)if(I.FileIndex[V]==j)return I.FileIndex[V].name=s(P),I.FullPaths[V]=P,!0}return!1}function be(I){S(I,!0)}return t.find=C,t.read=D,t.parse=f,t.write=Z,t.writeFile=X,t.utils={cfb_new:Q,cfb_add:ne,cfb_del:ue,cfb_mov:ve,cfb_gc:be,ReadShift:Mc,CheckField:bb,prep_blob:kr,bconcat:Ha,use_zlib:M,_deflateRaw:Be,_inflateRaw:qs,consts:ae},t}();function E8(e){if(typeof Deno<"u")return Deno.readFileSync(e);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var t=File(e);t.open("r"),t.encoding="binary";var r=t.read();return t.close(),r}catch(n){if(!n.message||!n.message.match(/onstruct/))throw n}throw new Error("Cannot access file "+e)}function $s(e){for(var t=Object.keys(e),r=[],n=0;n<t.length;++n)Object.prototype.hasOwnProperty.call(e,t[n])&&r.push(t[n]);return r}function _v(e){for(var t=[],r=$s(e),n=0;n!==r.length;++n)t[e[r[n]]]=r[n];return t}var vd=new Date(1899,11,30,0,0,0);function sn(e,t){var r=e.getTime(),n=vd.getTime()+(e.getTimezoneOffset()-vd.getTimezoneOffset())*6e4;return(r-n)/(24*60*60*1e3)}var ib=new Date,T8=vd.getTime()+(ib.getTimezoneOffset()-vd.getTimezoneOffset())*6e4,Nw=ib.getTimezoneOffset();function v0(e){var t=new Date;return t.setTime(e*24*60*60*1e3+T8),t.getTimezoneOffset()!==Nw&&t.setTime(t.getTime()+(t.getTimezoneOffset()-Nw)*6e4),t}function k8(e){var t=0,r=0,n=!1,s=e.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!s)throw new Error("|"+e+"| is not an ISO8601 Duration");for(var a=1;a!=s.length;++a)if(s[a]){switch(r=1,a>3&&(n=!0),s[a].slice(s[a].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+s[a].slice(s[a].length-1));case"D":r*=24;case"H":r*=60;case"M":if(n)r*=60;else throw new Error("Unsupported ISO Duration Field: M")}t+=r*parseInt(s[a],10)}return t}var Cw=new Date("2017-02-19T19:06:09.000Z"),ob=isNaN(Cw.getFullYear())?new Date("2/19/17"):Cw,S8=ob.getFullYear()==2017;function yr(e,t){var r=new Date(e);if(S8)return t>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):t<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(e instanceof Date)return e;if(ob.getFullYear()==1917&&!isNaN(r.getFullYear())){var n=r.getFullYear();return e.indexOf(""+n)>-1||r.setFullYear(r.getFullYear()+100),r}var s=e.match(/\d+/g)||["2017","2","19","0","0","0"],a=new Date(+s[0],+s[1]-1,+s[2],+s[3]||0,+s[4]||0,+s[5]||0);return e.indexOf("Z")>-1&&(a=new Date(a.getTime()-a.getTimezoneOffset()*60*1e3)),a}function io(e,t){if(tt&&Buffer.isBuffer(e)){if(t){if(e[0]==255&&e[1]==254)return yc(e.slice(2).toString("utf16le"));if(e[1]==254&&e[2]==255)return yc(KA(e.slice(2).toString("binary")))}return e.toString("binary")}if(typeof TextDecoder<"u")try{if(t){if(e[0]==255&&e[1]==254)return yc(new TextDecoder("utf-16le").decode(e.slice(2)));if(e[0]==254&&e[1]==255)return yc(new TextDecoder("utf-16be").decode(e.slice(2)))}var r={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[]/g,function(a){return r[a]||a})}catch{}for(var n=[],s=0;s!=e.length;++s)n.push(String.fromCharCode(e[s]));return n.join("")}function Ir(e){if(typeof JSON<"u"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=Ir(e[r]));return t}function zt(e,t){for(var r="";r.length<t;)r+=e;return r}function _s(e){var t=Number(e);if(!isNaN(t))return isFinite(t)?t:NaN;if(!/\d/.test(e))return t;var r=1,n=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(t=Number(n))||(n=n.replace(/[(](.*)[)]/,function(s,a){return r=-r,a}),!isNaN(t=Number(n)))?t/r:t}var A8=["january","february","march","april","may","june","july","august","september","october","november","december"];function Sl(e){var t=new Date(e),r=new Date(NaN),n=t.getYear(),s=t.getMonth(),a=t.getDate();if(isNaN(a))return r;var i=e.toLowerCase();if(i.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(i=i.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),i.length>3&&A8.indexOf(i)==-1)return r}else if(i.match(/[a-z]/))return r;return n<0||n>8099?r:(s>0||a>1)&&n!=101?t:e.match(/[^-0-9:,\/\\]/)?r:t}var b8=function(){var e="abacaba".split(/(:?b)/i).length==5;return function(r,n,s){if(e||typeof n=="string")return r.split(n);for(var a=r.split(n),i=[a[0]],o=1;o<a.length;++o)i.push(s),i.push(a[o]);return i}}();function lb(e){return e?e.content&&e.type?io(e.content,!0):e.data?gc(e.data):e.asNodeBuffer&&tt?gc(e.asNodeBuffer().toString("binary")):e.asBinary?gc(e.asBinary()):e._data&&e._data.getContent?gc(io(Array.prototype.slice.call(e._data.getContent(),0))):null:null}function cb(e){if(!e)return null;if(e.data)return vw(e.data);if(e.asNodeBuffer&&tt)return e.asNodeBuffer();if(e._data&&e._data.getContent){var t=e._data.getContent();return typeof t=="string"?vw(t):Array.prototype.slice.call(t)}return e.content&&e.type?e.content:null}function I8(e){return e&&e.name.slice(-4)===".bin"?cb(e):lb(e)}function zn(e,t){for(var r=e.FullPaths||$s(e.files),n=t.toLowerCase().replace(/[\/]/g,"\\"),s=n.replace(/\\/g,"/"),a=0;a<r.length;++a){var i=r[a].replace(/^Root Entry[\/]/,"").toLowerCase();if(n==i||s==i)return e.files?e.files[r[a]]:e.FileIndex[a]}return null}function wv(e,t){var r=zn(e,t);if(r==null)throw new Error("Cannot find file "+t+" in zip");return r}function tr(e,t,r){if(!r)return I8(wv(e,t));if(!t)return null;try{return tr(e,t)}catch{return null}}function In(e,t,r){if(!r)return lb(wv(e,t));if(!t)return null;try{return In(e,t)}catch{return null}}function N8(e,t,r){return cb(wv(e,t))}function Rw(e){for(var t=e.FullPaths||$s(e.files),r=[],n=0;n<t.length;++n)t[n].slice(-1)!="/"&&r.push(t[n].replace(/^Root Entry[\/]/,""));return r.sort()}function C8(e,t,r){if(e.FullPaths){if(typeof r=="string"){var n;return tt?n=po(r):n=X6(r),st.utils.cfb_add(e,t,n)}st.utils.cfb_add(e,t,r)}else e.file(t,r)}function ub(e,t){switch(t.type){case"base64":return st.read(e,{type:"base64"});case"binary":return st.read(e,{type:"binary"});case"buffer":case"array":return st.read(e,{type:"buffer"})}throw new Error("Unrecognized type "+t.type)}function vc(e,t){if(e.charAt(0)=="/")return e.slice(1);var r=t.split("/");t.slice(-1)!="/"&&r.pop();for(var n=e.split("/");n.length!==0;){var s=n.shift();s===".."?r.pop():s!=="."&&r.push(s)}return r.join("/")}var fb=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,R8=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,Pw=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,P8=/<[^>]*>/g,Xr=fb.match(Pw)?Pw:P8,D8=/<\w*:/,F8=/<(\/?)\w+:/;function je(e,t,r){for(var n={},s=0,a=0;s!==e.length&&!((a=e.charCodeAt(s))===32||a===10||a===13);++s);if(t||(n[0]=e.slice(0,s)),s===e.length)return n;var i=e.match(R8),o=0,l="",u=0,f="",d="",m=1;if(i)for(u=0;u!=i.length;++u){for(d=i[u],a=0;a!=d.length&&d.charCodeAt(a)!==61;++a);for(f=d.slice(0,a).trim();d.charCodeAt(a+1)==32;)++a;for(m=(s=d.charCodeAt(a+1))==34||s==39?1:0,l=d.slice(a+1+m,d.length-m),o=0;o!=f.length&&f.charCodeAt(o)!==58;++o);if(o===f.length)f.indexOf("_")>0&&(f=f.slice(0,f.indexOf("_"))),n[f]=l,n[f.toLowerCase()]=l;else{var p=(o===5&&f.slice(0,5)==="xmlns"?"xmlns":"")+f.slice(o+1);if(n[p]&&f.slice(o-3,o)=="ext")continue;n[p]=l,n[p.toLowerCase()]=l}}return n}function zs(e){return e.replace(F8,"<$1")}var hb={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},O8=_v(hb),lt=function(){var e=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,t=/_x([\da-fA-F]{4})_/ig;return function r(n){var s=n+"",a=s.indexOf("<![CDATA[");if(a==-1)return s.replace(e,function(o,l){return hb[o]||String.fromCharCode(parseInt(l,o.indexOf("x")>-1?16:10))||o}).replace(t,function(o,l){return String.fromCharCode(parseInt(l,16))});var i=s.indexOf("]]>");return r(s.slice(0,a))+s.slice(a+9,i)+r(s.slice(i+3))}}(),M8=/[&<>'"]/g,j8=/[\u0000-\u001f]/g;function Ev(e){var t=e+"";return t.replace(M8,function(r){return O8[r]}).replace(/\n/g,"<br/>").replace(j8,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}var Dw=function(){var e=/&#(\d+);/g;function t(r,n){return String.fromCharCode(parseInt(n,10))}return function(n){return n.replace(e,t)}}();function Ft(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function xm(e){for(var t="",r=0,n=0,s=0,a=0,i=0,o=0;r<e.length;){if(n=e.charCodeAt(r++),n<128){t+=String.fromCharCode(n);continue}if(s=e.charCodeAt(r++),n>191&&n<224){i=(n&31)<<6,i|=s&63,t+=String.fromCharCode(i);continue}if(a=e.charCodeAt(r++),n<240){t+=String.fromCharCode((n&15)<<12|(s&63)<<6|a&63);continue}i=e.charCodeAt(r++),o=((n&7)<<18|(s&63)<<12|(a&63)<<6|i&63)-65536,t+=String.fromCharCode(55296+(o>>>10&1023)),t+=String.fromCharCode(56320+(o&1023))}return t}function Fw(e){var t=xi(2*e.length),r,n,s=1,a=0,i=0,o;for(n=0;n<e.length;n+=s)s=1,(o=e.charCodeAt(n))<128?r=o:o<224?(r=(o&31)*64+(e.charCodeAt(n+1)&63),s=2):o<240?(r=(o&15)*4096+(e.charCodeAt(n+1)&63)*64+(e.charCodeAt(n+2)&63),s=3):(s=4,r=(o&7)*262144+(e.charCodeAt(n+1)&63)*4096+(e.charCodeAt(n+2)&63)*64+(e.charCodeAt(n+3)&63),r-=65536,i=55296+(r>>>10&1023),r=56320+(r&1023)),i!==0&&(t[a++]=i&255,t[a++]=i>>>8,i=0),t[a++]=r%256,t[a++]=r>>>8;return t.slice(0,a).toString("ucs2")}function Ow(e){return po(e,"binary").toString("utf8")}var Hf="foo bar baz",St=tt&&(Ow(Hf)==xm(Hf)&&Ow||Fw(Hf)==xm(Hf)&&Fw)||xm,yc=tt?function(e){return po(e,"utf8").toString("binary")}:function(e){for(var t=[],r=0,n=0,s=0;r<e.length;)switch(n=e.charCodeAt(r++),!0){case n<128:t.push(String.fromCharCode(n));break;case n<2048:t.push(String.fromCharCode(192+(n>>6))),t.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,s=e.charCodeAt(r++)-56320+(n<<10),t.push(String.fromCharCode(240+(s>>18&7))),t.push(String.fromCharCode(144+(s>>12&63))),t.push(String.fromCharCode(128+(s>>6&63))),t.push(String.fromCharCode(128+(s&63)));break;default:t.push(String.fromCharCode(224+(n>>12))),t.push(String.fromCharCode(128+(n>>6&63))),t.push(String.fromCharCode(128+(n&63)))}return t.join("")},Eu=function(){var e={};return function(r,n){var s=r+"|"+(n||"");return e[s]?e[s]:e[s]=new RegExp("<(?:\\w+:)?"+r+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+r+">",n||"")}}(),db=function(){var e=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(t){return[new RegExp("&"+t[0]+";","ig"),t[1]]});return function(r){for(var n=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),s=0;s<e.length;++s)n=n.replace(e[s][0],e[s][1]);return n}}(),L8=function(){var e={};return function(r){return e[r]!==void 0?e[r]:e[r]=new RegExp("<(?:vt:)?"+r+">([\\s\\S]*?)</(?:vt:)?"+r+">","g")}}(),U8=/<\/?(?:vt:)?variant>/g,V8=/<(?:vt:)([^>]*)>([\s\S]*)</;function Mw(e,t){var r=je(e),n=e.match(L8(r.baseType))||[],s=[];if(n.length!=r.size){if(t.WTF)throw new Error("unexpected vector length "+n.length+" != "+r.size);return s}return n.forEach(function(a){var i=a.replace(U8,"").match(V8);i&&s.push({v:St(i[2]),t:i[1]})}),s}var B8=/(^\s|\s$|\n)/;function $8(e){return $s(e).map(function(t){return" "+t+'="'+e[t]+'"'}).join("")}function W8(e,t,r){return"<"+e+(r!=null?$8(r):"")+(t!=null?(t.match(B8)?' xml:space="preserve"':"")+">"+t+"</"+e:"/")+">"}function Tv(e){if(tt&&Buffer.isBuffer(e))return e.toString("utf8");if(typeof e=="string")return e;if(typeof Uint8Array<"u"&&e instanceof Uint8Array)return St(go(xv(e)));throw new Error("Bad input format: expected Buffer or string")}var Tu=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,z8={CT:"http://schemas.openxmlformats.org/package/2006/content-types"},H8=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"];function G8(e,t){for(var r=1-2*(e[t+7]>>>7),n=((e[t+7]&127)<<4)+(e[t+6]>>>4&15),s=e[t+6]&15,a=5;a>=0;--a)s=s*256+e[t+a];return n==2047?s==0?r*(1/0):NaN:(n==0?n=-1022:(n-=1023,s+=Math.pow(2,52)),r*Math.pow(2,n-52)*s)}function K8(e,t,r){var n=(t<0||1/t==-1/0?1:0)<<7,s=0,a=0,i=n?-t:t;isFinite(i)?i==0?s=a=0:(s=Math.floor(Math.log(i)/Math.LN2),a=i*Math.pow(2,52-s),s<=-1023&&(!isFinite(a)||a<Math.pow(2,52))?s=-1022:(a-=Math.pow(2,52),s+=1023)):(s=2047,a=isNaN(t)?26985:0);for(var o=0;o<=5;++o,a/=256)e[r+o]=a&255;e[r+6]=(s&15)<<4|a&15,e[r+7]=s>>4|n}var jw=function(e){for(var t=[],r=10240,n=0;n<e[0].length;++n)if(e[0][n])for(var s=0,a=e[0][n].length;s<a;s+=r)t.push.apply(t,e[0][n].slice(s,s+r));return t},Lw=tt?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(t){return Buffer.isBuffer(t)?t:po(t)})):jw(e)}:jw,Uw=function(e,t,r){for(var n=[],s=t;s<r;s+=2)n.push(String.fromCharCode(la(e,s)));return n.join("").replace(nn,"")},kv=tt?function(e,t,r){return Buffer.isBuffer(e)?e.toString("utf16le",t,r).replace(nn,""):Uw(e,t,r)}:Uw,Vw=function(e,t,r){for(var n=[],s=t;s<t+r;++s)n.push(("0"+e[s].toString(16)).slice(-2));return n.join("")},mb=tt?function(e,t,r){return Buffer.isBuffer(e)?e.toString("hex",t,t+r):Vw(e,t,r)}:Vw,Bw=function(e,t,r){for(var n=[],s=t;s<r;s++)n.push(String.fromCharCode(Do(e,s)));return n.join("")},ef=tt?function(t,r,n){return Buffer.isBuffer(t)?t.toString("utf8",r,n):Bw(t,r,n)}:Bw,pb=function(e,t){var r=bn(e,t);return r>0?ef(e,t+4,t+4+r-1):""},gb=pb,xb=function(e,t){var r=bn(e,t);return r>0?ef(e,t+4,t+4+r-1):""},vb=xb,yb=function(e,t){var r=2*bn(e,t);return r>0?ef(e,t+4,t+4+r-1):""},_b=yb,wb=function(t,r){var n=bn(t,r);return n>0?kv(t,r+4,r+4+n):""},Eb=wb,Tb=function(e,t){var r=bn(e,t);return r>0?ef(e,t+4,t+4+r):""},kb=Tb,Sb=function(e,t){return G8(e,t)},yd=Sb,Ab=function(t){return Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array};tt&&(gb=function(t,r){if(!Buffer.isBuffer(t))return pb(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},vb=function(t,r){if(!Buffer.isBuffer(t))return xb(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},_b=function(t,r){if(!Buffer.isBuffer(t))return yb(t,r);var n=2*t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n-1)},Eb=function(t,r){if(!Buffer.isBuffer(t))return wb(t,r);var n=t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n)},kb=function(t,r){if(!Buffer.isBuffer(t))return Tb(t,r);var n=t.readUInt32LE(r);return t.toString("utf8",r+4,r+4+n)},yd=function(t,r){return Buffer.isBuffer(t)?t.readDoubleLE(r):Sb(t,r)},Ab=function(t){return Buffer.isBuffer(t)||Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array});var Do=function(e,t){return e[t]},la=function(e,t){return e[t+1]*256+e[t]},q8=function(e,t){var r=e[t+1]*256+e[t];return r<32768?r:(65535-r+1)*-1},bn=function(e,t){return e[t+3]*(1<<24)+(e[t+2]<<16)+(e[t+1]<<8)+e[t]},Pi=function(e,t){return e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]},X8=function(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]};function Mc(e,t){var r="",n,s,a=[],i,o,l,u;switch(t){case"dbcs":if(u=this.l,tt&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*e).toString("utf16le");else for(l=0;l<e;++l)r+=String.fromCharCode(la(this,u)),u+=2;e*=2;break;case"utf8":r=ef(this,this.l,this.l+e);break;case"utf16le":e*=2,r=kv(this,this.l,this.l+e);break;case"wstr":return Mc.call(this,e,"dbcs");case"lpstr-ansi":r=gb(this,this.l),e=4+bn(this,this.l);break;case"lpstr-cp":r=vb(this,this.l),e=4+bn(this,this.l);break;case"lpwstr":r=_b(this,this.l),e=4+2*bn(this,this.l);break;case"lpp4":e=4+bn(this,this.l),r=Eb(this,this.l),e&2&&(e+=2);break;case"8lpp4":e=4+bn(this,this.l),r=kb(this,this.l),e&3&&(e+=4-(e&3));break;case"cstr":for(e=0,r="";(i=Do(this,this.l+e++))!==0;)a.push(zf(i));r=a.join("");break;case"_wstr":for(e=0,r="";(i=la(this,this.l+e))!==0;)a.push(zf(i)),e+=2;e+=2,r=a.join("");break;case"dbcs-cont":for(r="",u=this.l,l=0;l<e;++l){if(this.lens&&this.lens.indexOf(u)!==-1)return i=Do(this,u),this.l=u+1,o=Mc.call(this,e-l,i?"dbcs-cont":"sbcs-cont"),a.join("")+o;a.push(zf(la(this,u))),u+=2}r=a.join(""),e*=2;break;case"cpstr":case"sbcs-cont":for(r="",u=this.l,l=0;l!=e;++l){if(this.lens&&this.lens.indexOf(u)!==-1)return i=Do(this,u),this.l=u+1,o=Mc.call(this,e-l,i?"dbcs-cont":"sbcs-cont"),a.join("")+o;a.push(zf(Do(this,u))),u+=1}r=a.join("");break;default:switch(e){case 1:return n=Do(this,this.l),this.l++,n;case 2:return n=(t==="i"?q8:la)(this,this.l),this.l+=2,n;case 4:case-4:return t==="i"||!(this[this.l+3]&128)?(n=(e>0?Pi:X8)(this,this.l),this.l+=4,n):(s=bn(this,this.l),this.l+=4,s);case 8:case-8:if(t==="f")return e==8?s=yd(this,this.l):s=yd([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,s;e=8;case 16:r=mb(this,this.l,e);break}}return this.l+=e,r}var Y8=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24&255},Q8=function(e,t,r){e[r]=t&255,e[r+1]=t>>8&255,e[r+2]=t>>16&255,e[r+3]=t>>24&255},J8=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255};function Z8(e,t,r){var n=0,s=0;if(r==="dbcs"){for(s=0;s!=t.length;++s)J8(this,t.charCodeAt(s),this.l+2*s);n=2*t.length}else if(r==="sbcs"){for(t=t.replace(/[^\x00-\x7F]/g,"_"),s=0;s!=t.length;++s)this[this.l+s]=t.charCodeAt(s)&255;n=t.length}else if(r==="hex"){for(;s<e;++s)this[this.l++]=parseInt(t.slice(2*s,2*s+2),16)||0;return this}else if(r==="utf16le"){var a=Math.min(this.l+e,this.length);for(s=0;s<Math.min(t.length,e);++s){var i=t.charCodeAt(s);this[this.l++]=i&255,this[this.l++]=i>>8}for(;this.l<a;)this[this.l++]=0;return this}else switch(e){case 1:n=1,this[this.l]=t&255;break;case 2:n=2,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255;break;case 3:n=3,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255,t>>>=8,this[this.l+2]=t&255;break;case 4:n=4,Y8(this,t,this.l);break;case 8:if(n=8,r==="f"){K8(this,t,this.l);break}case 16:break;case-4:n=4,Q8(this,t,this.l);break}return this.l+=n,this}function bb(e,t){var r=mb(this,this.l,e.length>>1);if(r!==e)throw new Error(t+"Expected "+e+" saw "+r);this.l+=e.length>>1}function kr(e,t){e.l=t,e.read_shift=Mc,e.chk=bb,e.write_shift=Z8}function qr(e,t){e.l+=t}function or(e){var t=xi(e);return kr(t,0),t}function Ia(e,t,r){if(e){var n,s,a;kr(e,e.l||0);for(var i=e.length,o=0,l=0;e.l<i;){o=e.read_shift(1),o&128&&(o=(o&127)+((e.read_shift(1)&127)<<7));var u=Sd[o]||Sd[65535];for(n=e.read_shift(1),a=n&127,s=1;s<4&&n&128;++s)a+=((n=e.read_shift(1))&127)<<7*s;l=e.l+a;var f=u.f&&u.f(e,a,r);if(e.l=l,t(f,u,o))return}}}function Zp(){var e=[],t=tt?256:2048,r=function(u){var f=or(u);return kr(f,0),f},n=r(t),s=function(){n&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&e.push(n),n=null)},a=function(u){return n&&u<n.length-n.l?n:(s(),n=r(Math.max(u+1,t)))},i=function(){return s(),Ha(e)},o=function(u){s(),n=u,n.l==null&&(n.l=n.length),a(t)};return{next:a,push:o,end:i,_bufs:e}}function jc(e,t,r){var n=Ir(e);if(t.s?(n.cRel&&(n.c+=t.s.c),n.rRel&&(n.r+=t.s.r)):(n.cRel&&(n.c+=t.c),n.rRel&&(n.r+=t.r)),!r||r.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function $w(e,t,r){var n=Ir(e);return n.s=jc(n.s,t.s,r),n.e=jc(n.e,t.s,r),n}function Lc(e,t){if(e.cRel&&e.c<0)for(e=Ir(e);e.c<0;)e.c+=t>8?16384:256;if(e.rRel&&e.r<0)for(e=Ir(e);e.r<0;)e.r+=t>8?1048576:t>5?65536:16384;var r=We(e);return!e.cRel&&e.cRel!=null&&(r=r5(r)),!e.rRel&&e.rRel!=null&&(r=e5(r)),r}function vm(e,t){return e.s.r==0&&!e.s.rRel&&e.e.r==(t.biff>=12?1048575:t.biff>=8?65536:16384)&&!e.e.rRel?(e.s.cRel?"":"$")+ur(e.s.c)+":"+(e.e.cRel?"":"$")+ur(e.e.c):e.s.c==0&&!e.s.cRel&&e.e.c==(t.biff>=12?16383:255)&&!e.e.cRel?(e.s.rRel?"":"$")+Nr(e.s.r)+":"+(e.e.rRel?"":"$")+Nr(e.e.r):Lc(e.s,t.biff)+":"+Lc(e.e,t.biff)}function Sv(e){return parseInt(t5(e),10)-1}function Nr(e){return""+(e+1)}function e5(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function t5(e){return e.replace(/\$(\d+)$/,"$1")}function Av(e){for(var t=n5(e),r=0,n=0;n!==t.length;++n)r=26*r+t.charCodeAt(n)-64;return r-1}function ur(e){if(e<0)throw new Error("invalid column "+e);var t="";for(++e;e;e=Math.floor((e-1)/26))t=String.fromCharCode((e-1)%26+65)+t;return t}function r5(e){return e.replace(/^([A-Z])/,"$$$1")}function n5(e){return e.replace(/^\$([A-Z])/,"$1")}function s5(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function en(e){for(var t=0,r=0,n=0;n<e.length;++n){var s=e.charCodeAt(n);s>=48&&s<=57?t=10*t+(s-48):s>=65&&s<=90&&(r=26*r+(s-64))}return{c:r-1,r:t-1}}function We(e){for(var t=e.c+1,r="";t;t=(t-1)/26|0)r=String.fromCharCode((t-1)%26+65)+r;return r+(e.r+1)}function jl(e){var t=e.indexOf(":");return t==-1?{s:en(e),e:en(e)}:{s:en(e.slice(0,t)),e:en(e.slice(t+1))}}function at(e,t){return typeof t>"u"||typeof t=="number"?at(e.s,e.e):(typeof e!="string"&&(e=We(e)),typeof t!="string"&&(t=We(t)),e==t?e:e+":"+t)}function Gt(e){var t={s:{c:0,r:0},e:{c:0,r:0}},r=0,n=0,s=0,a=e.length;for(r=0;n<a&&!((s=e.charCodeAt(n)-64)<1||s>26);++n)r=26*r+s;for(t.s.c=--r,r=0;n<a&&!((s=e.charCodeAt(n)-48)<0||s>9);++n)r=10*r+s;if(t.s.r=--r,n===a||s!=10)return t.e.c=t.s.c,t.e.r=t.s.r,t;for(++n,r=0;n!=a&&!((s=e.charCodeAt(n)-64)<1||s>26);++n)r=26*r+s;for(t.e.c=--r,r=0;n!=a&&!((s=e.charCodeAt(n)-48)<0||s>9);++n)r=10*r+s;return t.e.r=--r,t}function Ww(e,t){var r=e.t=="d"&&t instanceof Date;if(e.z!=null)try{return e.w=es(e.z,r?sn(t):t)}catch{}try{return e.w=es((e.XF||{}).numFmtId||(r?14:0),r?sn(t):t)}catch{return""+t}}function Sa(e,t,r){return e==null||e.t==null||e.t=="z"?"":e.w!==void 0?e.w:(e.t=="d"&&!e.z&&r&&r.dateNF&&(e.z=r.dateNF),e.t=="e"?yo[e.v]||e.v:t==null?Ww(e,e.v):Ww(e,t))}function ki(e,t){var r=t&&t.sheet?t.sheet:"Sheet1",n={};return n[r]=e,{SheetNames:[r],Sheets:n}}function Ib(e,t,r){var n=r||{},s=e?Array.isArray(e):n.dense,a=e||(s?[]:{}),i=0,o=0;if(a&&n.origin!=null){if(typeof n.origin=="number")i=n.origin;else{var l=typeof n.origin=="string"?en(n.origin):n.origin;i=l.r,o=l.c}a["!ref"]||(a["!ref"]="A1:A1")}var u={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(a["!ref"]){var f=Gt(a["!ref"]);u.s.c=f.s.c,u.s.r=f.s.r,u.e.c=Math.max(u.e.c,f.e.c),u.e.r=Math.max(u.e.r,f.e.r),i==-1&&(u.e.r=i=f.e.r+1)}for(var d=0;d!=t.length;++d)if(t[d]){if(!Array.isArray(t[d]))throw new Error("aoa_to_sheet expects an array of arrays");for(var m=0;m!=t[d].length;++m)if(!(typeof t[d][m]>"u")){var p={v:t[d][m]},x=i+d,g=o+m;if(u.s.r>x&&(u.s.r=x),u.s.c>g&&(u.s.c=g),u.e.r<x&&(u.e.r=x),u.e.c<g&&(u.e.c=g),t[d][m]&&typeof t[d][m]=="object"&&!Array.isArray(t[d][m])&&!(t[d][m]instanceof Date))p=t[d][m];else if(Array.isArray(p.v)&&(p.f=t[d][m][1],p.v=p.v[0]),p.v===null)if(p.f)p.t="n";else if(n.nullError)p.t="e",p.v=0;else if(n.sheetStubs)p.t="z";else continue;else typeof p.v=="number"?p.t="n":typeof p.v=="boolean"?p.t="b":p.v instanceof Date?(p.z=n.dateNF||He[14],n.cellDates?(p.t="d",p.w=es(p.z,sn(p.v))):(p.t="n",p.v=sn(p.v),p.w=es(p.z,p.v))):p.t="s";if(s)a[x]||(a[x]=[]),a[x][g]&&a[x][g].z&&(p.z=a[x][g].z),a[x][g]=p;else{var _=We({c:g,r:x});a[_]&&a[_].z&&(p.z=a[_].z),a[_]=p}}}return u.s.c<1e7&&(a["!ref"]=at(u)),a}function Ll(e,t){return Ib(null,e,t)}function a5(e){return e.read_shift(4,"i")}function Hr(e){var t=e.read_shift(4);return t===0?"":e.read_shift(t,"dbcs")}function i5(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function bv(e,t){var r=e.l,n=e.read_shift(1),s=Hr(e),a=[],i={t:s,h:s};if(n&1){for(var o=e.read_shift(4),l=0;l!=o;++l)a.push(i5(e));i.r=a}else i.r=[{ich:0,ifnt:0}];return e.l=r+t,i}var o5=bv;function rs(e){var t=e.read_shift(4),r=e.read_shift(2);return r+=e.read_shift(1)<<16,e.l++,{c:t,iStyleRef:r}}function xo(e){var t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:t}}var l5=Hr;function Iv(e){var t=e.read_shift(4);return t===0||t===4294967295?"":e.read_shift(t,"dbcs")}var c5=Hr,eg=Iv;function Nv(e){var t=e.slice(e.l,e.l+4),r=t[0]&1,n=t[0]&2;e.l+=4;var s=n===0?yd([0,0,0,0,t[0]&252,t[1],t[2],t[3]],0):Pi(t,0)>>2;return r?s/100:s}function Nb(e){var t={s:{},e:{}};return t.s.r=e.read_shift(4),t.e.r=e.read_shift(4),t.s.c=e.read_shift(4),t.e.c=e.read_shift(4),t}var vo=Nb;function $r(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function u5(e){var t={},r=e.read_shift(1),n=r>>>1,s=e.read_shift(1),a=e.read_shift(2,"i"),i=e.read_shift(1),o=e.read_shift(1),l=e.read_shift(1);switch(e.l++,n){case 0:t.auto=1;break;case 1:t.index=s;var u=Ki[s];u&&(t.rgb=Su(u));break;case 2:t.rgb=Su([i,o,l]);break;case 3:t.theme=s;break}return a!=0&&(t.tint=a>0?a/32767:a/32768),t}function f5(e){var t=e.read_shift(1);e.l++;var r={fBold:t&1,fItalic:t&2,fUnderline:t&4,fStrikeout:t&8,fOutline:t&16,fShadow:t&32,fCondense:t&64,fExtend:t&128};return r}function Cb(e,t){var r={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},n=e.read_shift(4);switch(n){case 0:return"";case 4294967295:case 4294967294:return r[e.read_shift(4)]||""}if(n>400)throw new Error("Unsupported Clipboard: "+n.toString(16));return e.l-=4,e.read_shift(0,t==1?"lpstr":"lpwstr")}function h5(e){return Cb(e,1)}function d5(e){return Cb(e,2)}var Cv=2,dn=3,Gf=11,zw=12,_d=19,Kf=64,m5=65,p5=71,g5=4108,x5=4126,gr=80,Rb=81,v5=[gr,Rb],y5={1:{n:"CodePage",t:Cv},2:{n:"Category",t:gr},3:{n:"PresentationFormat",t:gr},4:{n:"ByteCount",t:dn},5:{n:"LineCount",t:dn},6:{n:"ParagraphCount",t:dn},7:{n:"SlideCount",t:dn},8:{n:"NoteCount",t:dn},9:{n:"HiddenCount",t:dn},10:{n:"MultimediaClipCount",t:dn},11:{n:"ScaleCrop",t:Gf},12:{n:"HeadingPairs",t:g5},13:{n:"TitlesOfParts",t:x5},14:{n:"Manager",t:gr},15:{n:"Company",t:gr},16:{n:"LinksUpToDate",t:Gf},17:{n:"CharacterCount",t:dn},19:{n:"SharedDoc",t:Gf},22:{n:"HyperlinksChanged",t:Gf},23:{n:"AppVersion",t:dn,p:"version"},24:{n:"DigSig",t:m5},26:{n:"ContentType",t:gr},27:{n:"ContentStatus",t:gr},28:{n:"Language",t:gr},29:{n:"Version",t:gr},255:{},2147483648:{n:"Locale",t:_d},2147483651:{n:"Behavior",t:_d},1919054434:{}},_5={1:{n:"CodePage",t:Cv},2:{n:"Title",t:gr},3:{n:"Subject",t:gr},4:{n:"Author",t:gr},5:{n:"Keywords",t:gr},6:{n:"Comments",t:gr},7:{n:"Template",t:gr},8:{n:"LastAuthor",t:gr},9:{n:"RevNumber",t:gr},10:{n:"EditTime",t:Kf},11:{n:"LastPrinted",t:Kf},12:{n:"CreatedDate",t:Kf},13:{n:"ModifiedDate",t:Kf},14:{n:"PageCount",t:dn},15:{n:"WordCount",t:dn},16:{n:"CharCount",t:dn},17:{n:"Thumbnail",t:p5},18:{n:"Application",t:gr},19:{n:"DocSecurity",t:dn},255:{},2147483648:{n:"Locale",t:_d},2147483651:{n:"Behavior",t:_d},1919054434:{}},Hw={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},w5=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function E5(e){return e.map(function(t){return[t>>16&255,t>>8&255,t&255]})}var T5=E5([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Ki=Ir(T5),yo={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},Pb={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},Gw={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"};function k5(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function S5(e){var t=k5();if(!e||!e.match)return t;var r={};if((e.match(Xr)||[]).forEach(function(n){var s=je(n);switch(s[0].replace(D8,"<")){case"<?xml":break;case"<Types":t.xmlns=s["xmlns"+(s[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":r[s.Extension]=s.ContentType;break;case"<Override":t[Gw[s.ContentType]]!==void 0&&t[Gw[s.ContentType]].push(s.PartName);break}}),t.xmlns!==z8.CT)throw new Error("Unknown Namespace: "+t.xmlns);return t.calcchain=t.calcchains.length>0?t.calcchains[0]:"",t.sst=t.strs.length>0?t.strs[0]:"",t.style=t.styles.length>0?t.styles[0]:"",t.defaults=r,delete t.calcchains,t}var Go={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function tg(e){var t=e.lastIndexOf("/");return e.slice(0,t+1)+"_rels/"+e.slice(t+1)+".rels"}function Uc(e,t){var r={"!id":{}};if(!e)return r;t.charAt(0)!=="/"&&(t="/"+t);var n={};return(e.match(Xr)||[]).forEach(function(s){var a=je(s);if(a[0]==="<Relationship"){var i={};i.Type=a.Type,i.Target=a.Target,i.Id=a.Id,a.TargetMode&&(i.TargetMode=a.TargetMode);var o=a.TargetMode==="External"?a.Target:vc(a.Target,t);r[o]=i,n[a.Id]=i}}),r["!id"]=n,r}var A5="application/vnd.oasis.opendocument.spreadsheet";function b5(e,t){for(var r=Tv(e),n,s;n=Tu.exec(r);)switch(n[3]){case"manifest":break;case"file-entry":if(s=je(n[0],!1),s.path=="/"&&s.type!==A5)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(t&&t.WTF)throw n}}var Vc=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],I5=function(){for(var e=new Array(Vc.length),t=0;t<Vc.length;++t){var r=Vc[t],n="(?:"+r[0].slice(0,r[0].indexOf(":"))+":)"+r[0].slice(r[0].indexOf(":")+1);e[t]=new RegExp("<"+n+"[^>]*>([\\s\\S]*?)</"+n+">")}return e}();function Db(e){var t={};e=St(e);for(var r=0;r<Vc.length;++r){var n=Vc[r],s=e.match(I5[r]);s!=null&&s.length>0&&(t[n[1]]=lt(s[1])),n[2]==="date"&&t[n[1]]&&(t[n[1]]=yr(t[n[1]]))}return t}var N5=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]];function Fb(e,t,r,n){var s=[];if(typeof e=="string")s=Mw(e,n);else for(var a=0;a<e.length;++a)s=s.concat(e[a].map(function(f){return{v:f}}));var i=typeof t=="string"?Mw(t,n).map(function(f){return f.v}):t,o=0,l=0;if(i.length>0)for(var u=0;u!==s.length;u+=2){switch(l=+s[u+1].v,s[u].v){case"Worksheets":case"":case"":case" ":case"":case" ":case"Arbeitsbltter":case"alma Sayfalar":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de clculo":case"Planilhas":case"Regneark":case"Hojas de clculo":case"Werkbladen":r.Worksheets=l,r.SheetNames=i.slice(o,o+l);break;case"Named Ranges":case"Rangos con nombre":case"":case"Benannte Bereiche":case"Navngivne omrder":r.NamedRanges=l,r.DefinedNames=i.slice(o,o+l);break;case"Charts":case"Diagramme":r.Chartsheets=l,r.ChartNames=i.slice(o,o+l);break}o+=l}}function C5(e,t,r){var n={};return t||(t={}),e=St(e),N5.forEach(function(s){var a=(e.match(Eu(s[0]))||[])[1];switch(s[2]){case"string":a&&(t[s[1]]=lt(a));break;case"bool":t[s[1]]=a==="true";break;case"raw":var i=e.match(new RegExp("<"+s[0]+"[^>]*>([\\s\\S]*?)</"+s[0]+">"));i&&i.length>0&&(n[s[1]]=i[1]);break}}),n.HeadingPairs&&n.TitlesOfParts&&Fb(n.HeadingPairs,n.TitlesOfParts,t,r),t}var R5=/<[^>]+>[^<]*/g;function P5(e,t){var r={},n="",s=e.match(R5);if(s)for(var a=0;a!=s.length;++a){var i=s[a],o=je(i);switch(o[0]){case"<?xml":break;case"<Properties":break;case"<property":n=lt(o.name);break;case"</property>":n=null;break;default:if(i.indexOf("<vt:")===0){var l=i.split(">"),u=l[0].slice(4),f=l[1];switch(u){case"lpstr":case"bstr":case"lpwstr":r[n]=lt(f);break;case"bool":r[n]=Ft(f);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":r[n]=parseInt(f,10);break;case"r4":case"r8":case"decimal":r[n]=parseFloat(f);break;case"filetime":case"date":r[n]=yr(f);break;case"cy":case"error":r[n]=lt(f);break;default:if(u.slice(-1)=="/")break;t.WTF&&typeof console<"u"&&console.warn("Unexpected",i,u,l)}}else if(i.slice(0,2)!=="</"){if(t.WTF)throw new Error(i)}}}return r}var D5={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},ym;function F5(e,t,r){ym||(ym=_v(D5)),t=ym[t]||t,e[t]=r}function Rv(e){var t=e.read_shift(4),r=e.read_shift(4);return new Date((r/1e7*Math.pow(2,32)+t/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function Ob(e,t,r){var n=e.l,s=e.read_shift(0,"lpstr-cp");if(r)for(;e.l-n&3;)++e.l;return s}function Mb(e,t,r){var n=e.read_shift(0,"lpwstr");return n}function jb(e,t,r){return t===31?Mb(e):Ob(e,t,r)}function rg(e,t,r){return jb(e,t,r===!1?0:4)}function O5(e,t){if(!t)throw new Error("VtUnalignedString must have positive length");return jb(e,t,0)}function M5(e){for(var t=e.read_shift(4),r=[],n=0;n!=t;++n){var s=e.l;r[n]=e.read_shift(0,"lpwstr").replace(nn,""),e.l-s&2&&(e.l+=2)}return r}function j5(e){for(var t=e.read_shift(4),r=[],n=0;n!=t;++n)r[n]=e.read_shift(0,"lpstr-cp").replace(nn,"");return r}function L5(e){var t=e.l,r=wd(e,Rb);e[e.l]==0&&e[e.l+1]==0&&e.l-t&2&&(e.l+=2);var n=wd(e,dn);return[r,n]}function U5(e){for(var t=e.read_shift(4),r=[],n=0;n<t/2;++n)r.push(L5(e));return r}function Kw(e,t){for(var r=e.read_shift(4),n={},s=0;s!=r;++s){var a=e.read_shift(4),i=e.read_shift(4);n[a]=e.read_shift(i,t===1200?"utf16le":"utf8").replace(nn,"").replace(xc,"!"),t===1200&&i%2&&(e.l+=2)}return e.l&3&&(e.l=e.l>>3<<2),n}function Lb(e){var t=e.read_shift(4),r=e.slice(e.l,e.l+t);return e.l+=t,(t&3)>0&&(e.l+=4-(t&3)&3),r}function V5(e){var t={};return t.Size=e.read_shift(4),e.l+=t.Size+3-(t.Size-1)%4,t}function wd(e,t,r){var n=e.read_shift(2),s,a=r||{};if(e.l+=2,t!==zw&&n!==t&&v5.indexOf(t)===-1&&!((t&65534)==4126&&(n&65534)==4126))throw new Error("Expected type "+t+" saw "+n);switch(t===zw?n:t){case 2:return s=e.read_shift(2,"i"),a.raw||(e.l+=2),s;case 3:return s=e.read_shift(4,"i"),s;case 11:return e.read_shift(4)!==0;case 19:return s=e.read_shift(4),s;case 30:return Ob(e,n,4).replace(nn,"");case 31:return Mb(e);case 64:return Rv(e);case 65:return Lb(e);case 71:return V5(e);case 80:return rg(e,n,!a.raw).replace(nn,"");case 81:return O5(e,n).replace(nn,"");case 4108:return U5(e);case 4126:case 4127:return n==4127?M5(e):j5(e);default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+n)}}function qw(e,t){var r=e.l,n=e.read_shift(4),s=e.read_shift(4),a=[],i=0,o=0,l=-1,u={};for(i=0;i!=s;++i){var f=e.read_shift(4),d=e.read_shift(4);a[i]=[f,d+r]}a.sort(function(E,y){return E[1]-y[1]});var m={};for(i=0;i!=s;++i){if(e.l!==a[i][1]){var p=!0;if(i>0&&t)switch(t[a[i-1][0]].t){case 2:e.l+2===a[i][1]&&(e.l+=2,p=!1);break;case 80:e.l<=a[i][1]&&(e.l=a[i][1],p=!1);break;case 4108:e.l<=a[i][1]&&(e.l=a[i][1],p=!1);break}if((!t||i==0)&&e.l<=a[i][1]&&(p=!1,e.l=a[i][1]),p)throw new Error("Read Error: Expected address "+a[i][1]+" at "+e.l+" :"+i)}if(t){var x=t[a[i][0]];if(m[x.n]=wd(e,x.t,{raw:!0}),x.p==="version"&&(m[x.n]=String(m[x.n]>>16)+"."+("0000"+String(m[x.n]&65535)).slice(-4)),x.n=="CodePage")switch(m[x.n]){case 0:m[x.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:ps(o=m[x.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+m[x.n])}}else if(a[i][0]===1){if(o=m.CodePage=wd(e,Cv),ps(o),l!==-1){var g=e.l;e.l=a[l][1],u=Kw(e,o),e.l=g}}else if(a[i][0]===0){if(o===0){l=i,e.l=a[i+1][1];continue}u=Kw(e,o)}else{var _=u[a[i][0]],k;switch(e[e.l]){case 65:e.l+=4,k=Lb(e);break;case 30:e.l+=4,k=rg(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 31:e.l+=4,k=rg(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 3:e.l+=4,k=e.read_shift(4,"i");break;case 19:e.l+=4,k=e.read_shift(4);break;case 5:e.l+=4,k=e.read_shift(8,"f");break;case 11:e.l+=4,k=qt(e,4);break;case 64:e.l+=4,k=yr(Rv(e));break;default:throw new Error("unparsed value: "+e[e.l])}m[_]=k}}return e.l=r+n,m}function Xw(e,t,r){var n=e.content;if(!n)return{};kr(n,0);var s,a,i,o,l=0;n.chk("feff","Byte Order: "),n.read_shift(2);var u=n.read_shift(4),f=n.read_shift(16);if(f!==st.utils.consts.HEADER_CLSID&&f!==r)throw new Error("Bad PropertySet CLSID "+f);if(s=n.read_shift(4),s!==1&&s!==2)throw new Error("Unrecognized #Sets: "+s);if(a=n.read_shift(16),o=n.read_shift(4),s===1&&o!==n.l)throw new Error("Length mismatch: "+o+" !== "+n.l);s===2&&(i=n.read_shift(16),l=n.read_shift(4));var d=qw(n,t),m={SystemIdentifier:u};for(var p in d)m[p]=d[p];if(m.FMTID=a,s===1)return m;if(l-n.l==2&&(n.l+=2),n.l!==l)throw new Error("Length mismatch 2: "+n.l+" !== "+l);var x;try{x=qw(n,null)}catch{}for(p in x)m[p]=x[p];return m.FMTID=[a,i],m}function Oa(e,t){return e.read_shift(t),null}function B5(e,t,r){for(var n=[],s=e.l+t;e.l<s;)n.push(r(e,s-e.l));if(s!==e.l)throw new Error("Slurp error");return n}function qt(e,t){return e.read_shift(t)===1}function rr(e){return e.read_shift(2,"u")}function Ub(e,t){return B5(e,t,rr)}function $5(e){var t=e.read_shift(1),r=e.read_shift(1);return r===1?t:t===1}function tf(e,t,r){var n=e.read_shift(r&&r.biff>=12?2:1),s="sbcs-cont";if(r&&r.biff>=8,!r||r.biff==8){var a=e.read_shift(1);a&&(s="dbcs-cont")}else r.biff==12&&(s="wstr");r.biff>=2&&r.biff<=5&&(s="cpstr");var i=n?e.read_shift(n,s):"";return i}function W5(e){var t=e.read_shift(2),r=e.read_shift(1),n=r&4,s=r&8,a=1+(r&1),i=0,o,l={};s&&(i=e.read_shift(2)),n&&(o=e.read_shift(4));var u=a==2?"dbcs-cont":"sbcs-cont",f=t===0?"":e.read_shift(t,u);return s&&(e.l+=4*i),n&&(e.l+=o),l.t=f,s||(l.raw="<t>"+l.t+"</t>",l.r=l.t),l}function oo(e,t,r){var n;if(r){if(r.biff>=2&&r.biff<=5)return e.read_shift(t,"cpstr");if(r.biff>=12)return e.read_shift(t,"dbcs-cont")}var s=e.read_shift(1);return s===0?n=e.read_shift(t,"sbcs-cont"):n=e.read_shift(t,"dbcs-cont"),n}function rf(e,t,r){var n=e.read_shift(r&&r.biff==2?1:2);return n===0?(e.l++,""):oo(e,n,r)}function _o(e,t,r){if(r.biff>5)return rf(e,t,r);var n=e.read_shift(1);return n===0?(e.l++,""):e.read_shift(n,r.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function z5(e){var t=e.read_shift(1);e.l++;var r=e.read_shift(2);return e.l+=2,[t,r]}function H5(e){var t=e.read_shift(4),r=e.l,n=!1;t>24&&(e.l+=t-24,e.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(n=!0),e.l=r);var s=e.read_shift((n?t-24:t)>>1,"utf16le").replace(nn,"");return n&&(e.l+=24),s}function G5(e){for(var t=e.read_shift(2),r="";t-- >0;)r+="../";var n=e.read_shift(0,"lpstr-ansi");if(e.l+=2,e.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var s=e.read_shift(4);if(s===0)return r+n.replace(/\\/g,"/");var a=e.read_shift(4);if(e.read_shift(2)!=3)throw new Error("Bad FileMoniker");var i=e.read_shift(a>>1,"utf16le").replace(nn,"");return r+i}function K5(e,t){var r=e.read_shift(16);switch(r){case"e0c9ea79f9bace118c8200aa004ba90b":return H5(e);case"0303000000000000c000000000000046":return G5(e);default:throw new Error("Unsupported Moniker "+r)}}function qf(e){var t=e.read_shift(4),r=t>0?e.read_shift(t,"utf16le").replace(nn,""):"";return r}function q5(e,t){var r=e.l+t,n=e.read_shift(4);if(n!==2)throw new Error("Unrecognized streamVersion: "+n);var s=e.read_shift(2);e.l+=2;var a,i,o,l,u="",f,d;s&16&&(a=qf(e,r-e.l)),s&128&&(i=qf(e,r-e.l)),(s&257)===257&&(o=qf(e,r-e.l)),(s&257)===1&&(l=K5(e,r-e.l)),s&8&&(u=qf(e,r-e.l)),s&32&&(f=e.read_shift(16)),s&64&&(d=Rv(e)),e.l=r;var m=i||o||l||"";m&&u&&(m+="#"+u),m||(m="#"+u),s&2&&m.charAt(0)=="/"&&m.charAt(1)!="/"&&(m="file://"+m);var p={Target:m};return f&&(p.guid=f),d&&(p.time=d),a&&(p.Tooltip=a),p}function Vb(e){var t=e.read_shift(1),r=e.read_shift(1),n=e.read_shift(1),s=e.read_shift(1);return[t,r,n,s]}function Bb(e,t){var r=Vb(e);return r[3]=0,r}function Hs(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2);return{r:t,c:r,ixfe:n}}function X5(e){var t=e.read_shift(2),r=e.read_shift(2);return e.l+=8,{type:t,flags:r}}function Y5(e,t,r){return t===0?"":_o(e,t,r)}function Q5(e,t,r){var n=r.biff>8?4:2,s=e.read_shift(n),a=e.read_shift(n,"i"),i=e.read_shift(n,"i");return[s,a,i]}function $b(e){var t=e.read_shift(2),r=Nv(e);return[t,r]}function J5(e,t,r){e.l+=4,t-=4;var n=e.l+t,s=tf(e,t,r),a=e.read_shift(2);if(n-=e.l,a!==n)throw new Error("Malformed AddinUdf: padding = "+n+" != "+a);return e.l+=a,s}function y0(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2),s=e.read_shift(2);return{s:{c:n,r:t},e:{c:s,r}}}function Wb(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(1),s=e.read_shift(1);return{s:{c:n,r:t},e:{c:s,r}}}var Z5=Wb;function zb(e){e.l+=4;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2);return e.l+=12,[r,t,n]}function e9(e){var t={};return e.l+=4,e.l+=16,t.fSharedNote=e.read_shift(2),e.l+=4,t}function t9(e){var t={};return e.l+=4,e.cf=e.read_shift(2),t}function jr(e){e.l+=2,e.l+=e.read_shift(2)}var r9={0:jr,4:jr,5:jr,6:jr,7:t9,8:jr,9:jr,10:jr,11:jr,12:jr,13:e9,14:jr,15:jr,16:jr,17:jr,18:jr,19:jr,20:jr,21:zb};function n9(e,t){for(var r=e.l+t,n=[];e.l<r;){var s=e.read_shift(2);e.l-=2;try{n.push(r9[s](e,r-e.l))}catch{return e.l=r,n}}return e.l!=r&&(e.l=r),n}function Xf(e,t){var r={BIFFVer:0,dt:0};switch(r.BIFFVer=e.read_shift(2),t-=2,t>=2&&(r.dt=e.read_shift(2),e.l-=2),r.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(t>6)throw new Error("Unexpected BIFF Ver "+r.BIFFVer)}return e.read_shift(t),r}function s9(e,t){return t===0||e.read_shift(2),1200}function a9(e,t,r){if(r.enc)return e.l+=t,"";var n=e.l,s=_o(e,0,r);return e.read_shift(t+n-e.l),s}function i9(e,t,r){var n=r&&r.biff==8||t==2?e.read_shift(2):(e.l+=t,0);return{fDialog:n&16,fBelow:n&64,fRight:n&128}}function o9(e,t,r){var n=e.read_shift(4),s=e.read_shift(1)&3,a=e.read_shift(1);switch(a){case 0:a="Worksheet";break;case 1:a="Macrosheet";break;case 2:a="Chartsheet";break;case 6:a="VBAModule";break}var i=tf(e,0,r);return i.length===0&&(i="Sheet1"),{pos:n,hs:s,dt:a,name:i}}function l9(e,t){for(var r=e.l+t,n=e.read_shift(4),s=e.read_shift(4),a=[],i=0;i!=s&&e.l<r;++i)a.push(W5(e));return a.Count=n,a.Unique=s,a}function c9(e,t){var r={};return r.dsst=e.read_shift(2),e.l+=t-2,r}function u9(e){var t={};t.r=e.read_shift(2),t.c=e.read_shift(2),t.cnt=e.read_shift(2)-t.c;var r=e.read_shift(2);e.l+=4;var n=e.read_shift(1);return e.l+=3,n&7&&(t.level=n&7),n&32&&(t.hidden=!0),n&64&&(t.hpt=r/20),t}function f9(e){var t=X5(e);if(t.type!=2211)throw new Error("Invalid Future Record "+t.type);var r=e.read_shift(4);return r!==0}function h9(e){return e.read_shift(2),e.read_shift(4)}function Yw(e,t,r){var n=0;r&&r.biff==2||(n=e.read_shift(2));var s=e.read_shift(2);r&&r.biff==2&&(n=1-(s>>15),s&=32767);var a={Unsynced:n&1,DyZero:(n&2)>>1,ExAsc:(n&4)>>2,ExDsc:(n&8)>>3};return[a,s]}function d9(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2),s=e.read_shift(2),a=e.read_shift(2),i=e.read_shift(2),o=e.read_shift(2),l=e.read_shift(2),u=e.read_shift(2);return{Pos:[t,r],Dim:[n,s],Flags:a,CurTab:i,FirstTab:o,Selected:l,TabRatio:u}}function m9(e,t,r){if(r&&r.biff>=2&&r.biff<5)return{};var n=e.read_shift(2);return{RTL:n&64}}function p9(){}function g9(e,t,r){var n={dyHeight:e.read_shift(2),fl:e.read_shift(2)};switch(r&&r.biff||8){case 2:break;case 3:case 4:e.l+=2;break;default:e.l+=10;break}return n.name=tf(e,0,r),n}function x9(e){var t=Hs(e);return t.isst=e.read_shift(4),t}function v9(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=e.l+t,s=Hs(e);r.biff==2&&e.l++;var a=rf(e,n-e.l,r);return s.val=a,s}function y9(e,t,r){var n=e.read_shift(2),s=_o(e,0,r);return[n,s]}var _9=_o;function Qw(e,t,r){var n=e.l+t,s=r.biff==8||!r.biff?4:2,a=e.read_shift(s),i=e.read_shift(s),o=e.read_shift(2),l=e.read_shift(2);return e.l=n,{s:{r:a,c:o},e:{r:i,c:l}}}function w9(e){var t=e.read_shift(2),r=e.read_shift(2),n=$b(e);return{r:t,c:r,ixfe:n[0],rknum:n[1]}}function E9(e,t){for(var r=e.l+t-2,n=e.read_shift(2),s=e.read_shift(2),a=[];e.l<r;)a.push($b(e));if(e.l!==r)throw new Error("MulRK read error");var i=e.read_shift(2);if(a.length!=i-s+1)throw new Error("MulRK length mismatch");return{r:n,c:s,C:i,rkrec:a}}function T9(e,t){for(var r=e.l+t-2,n=e.read_shift(2),s=e.read_shift(2),a=[];e.l<r;)a.push(e.read_shift(2));if(e.l!==r)throw new Error("MulBlank read error");var i=e.read_shift(2);if(a.length!=i-s+1)throw new Error("MulBlank length mismatch");return{r:n,c:s,C:i,ixfe:a}}function k9(e,t,r,n){var s={},a=e.read_shift(4),i=e.read_shift(4),o=e.read_shift(4),l=e.read_shift(2);return s.patternType=w5[o>>26],n.cellStyles&&(s.alc=a&7,s.fWrap=a>>3&1,s.alcV=a>>4&7,s.fJustLast=a>>7&1,s.trot=a>>8&255,s.cIndent=a>>16&15,s.fShrinkToFit=a>>20&1,s.iReadOrder=a>>22&2,s.fAtrNum=a>>26&1,s.fAtrFnt=a>>27&1,s.fAtrAlc=a>>28&1,s.fAtrBdr=a>>29&1,s.fAtrPat=a>>30&1,s.fAtrProt=a>>31&1,s.dgLeft=i&15,s.dgRight=i>>4&15,s.dgTop=i>>8&15,s.dgBottom=i>>12&15,s.icvLeft=i>>16&127,s.icvRight=i>>23&127,s.grbitDiag=i>>30&3,s.icvTop=o&127,s.icvBottom=o>>7&127,s.icvDiag=o>>14&127,s.dgDiag=o>>21&15,s.icvFore=l&127,s.icvBack=l>>7&127,s.fsxButton=l>>14&1),s}function S9(e,t,r){var n={};return n.ifnt=e.read_shift(2),n.numFmtId=e.read_shift(2),n.flags=e.read_shift(2),n.fStyle=n.flags>>2&1,t-=6,n.data=k9(e,t,n.fStyle,r),n}function A9(e){e.l+=4;var t=[e.read_shift(2),e.read_shift(2)];if(t[0]!==0&&t[0]--,t[1]!==0&&t[1]--,t[0]>7||t[1]>7)throw new Error("Bad Gutters: "+t.join("|"));return t}function Jw(e,t,r){var n=Hs(e);(r.biff==2||t==9)&&++e.l;var s=$5(e);return n.val=s,n.t=s===!0||s===!1?"b":"e",n}function b9(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=Hs(e),s=$r(e);return n.val=s,n}var Zw=Y5;function I9(e,t,r){var n=e.l+t,s=e.read_shift(2),a=e.read_shift(2);if(r.sbcch=a,a==1025||a==14849)return[a,s];if(a<1||a>255)throw new Error("Unexpected SupBook type: "+a);for(var i=oo(e,a),o=[];n>e.l;)o.push(rf(e));return[a,s,i,o]}function eE(e,t,r){var n=e.read_shift(2),s,a={fBuiltIn:n&1,fWantAdvise:n>>>1&1,fWantPict:n>>>2&1,fOle:n>>>3&1,fOleLink:n>>>4&1,cf:n>>>5&1023,fIcon:n>>>15&1};return r.sbcch===14849&&(s=J5(e,t-2,r)),a.body=s||e.read_shift(t-2),typeof s=="string"&&(a.Name=s),a}var N9=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function tE(e,t,r){var n=e.l+t,s=e.read_shift(2),a=e.read_shift(1),i=e.read_shift(1),o=e.read_shift(r&&r.biff==2?1:2),l=0;(!r||r.biff>=5)&&(r.biff!=5&&(e.l+=2),l=e.read_shift(2),r.biff==5&&(e.l+=2),e.l+=4);var u=oo(e,i,r);s&32&&(u=N9[u.charCodeAt(0)]);var f=n-e.l;r&&r.biff==2&&--f;var d=n==e.l||o===0||!(f>0)?[]:u7(e,f,r,o);return{chKey:a,Name:u,itab:l,rgce:d}}function Hb(e,t,r){if(r.biff<8)return C9(e,t,r);for(var n=[],s=e.l+t,a=e.read_shift(r.biff>8?4:2);a--!==0;)n.push(Q5(e,r.biff>8?12:6,r));if(e.l!=s)throw new Error("Bad ExternSheet: "+e.l+" != "+s);return n}function C9(e,t,r){e[e.l+1]==3&&e[e.l]++;var n=tf(e,t,r);return n.charCodeAt(0)==3?n.slice(1):n}function R9(e,t,r){if(r.biff<8){e.l+=t;return}var n=e.read_shift(2),s=e.read_shift(2),a=oo(e,n,r),i=oo(e,s,r);return[a,i]}function P9(e,t,r){var n=Wb(e);e.l++;var s=e.read_shift(1);return t-=8,[f7(e,t,r),s,n]}function rE(e,t,r){var n=Z5(e);switch(r.biff){case 2:e.l++,t-=7;break;case 3:case 4:e.l+=2,t-=8;break;default:e.l+=6,t-=12}return[n,l7(e,t,r)]}function D9(e){var t=e.read_shift(4)!==0,r=e.read_shift(4)!==0,n=e.read_shift(4);return[t,r,n]}function F9(e,t,r){if(!(r.biff<8)){var n=e.read_shift(2),s=e.read_shift(2),a=e.read_shift(2),i=e.read_shift(2),o=_o(e,0,r);return r.biff<8&&e.read_shift(1),[{r:n,c:s},o,i,a]}}function O9(e,t,r){return F9(e,t,r)}function M9(e,t){for(var r=[],n=e.read_shift(2);n--;)r.push(y0(e));return r}function j9(e,t,r){if(r&&r.biff<8)return U9(e,t,r);var n=zb(e),s=n9(e,t-22,n[1]);return{cmo:n,ft:s}}var L9={8:function(e,t){var r=e.l+t;e.l+=10;var n=e.read_shift(2);e.l+=4,e.l+=2,e.l+=2,e.l+=2,e.l+=4;var s=e.read_shift(1);return e.l+=s,e.l=r,{fmt:n}}};function U9(e,t,r){e.l+=4;var n=e.read_shift(2),s=e.read_shift(2),a=e.read_shift(2);e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=6,t-=36;var i=[];return i.push((L9[n]||qr)(e,t,r)),{cmo:[s,n,a],ft:i}}function V9(e,t,r){var n=e.l,s="";try{e.l+=4;var a=(r.lastobj||{cmo:[0,0]}).cmo[1],i;[0,5,7,11,12,14].indexOf(a)==-1?e.l+=6:i=z5(e,6,r);var o=e.read_shift(2);e.read_shift(2),rr(e,2);var l=e.read_shift(2);e.l+=l;for(var u=1;u<e.lens.length-1;++u){if(e.l-n!=e.lens[u])throw new Error("TxO: bad continue record");var f=e[e.l],d=oo(e,e.lens[u+1]-e.lens[u]-1);if(s+=d,s.length>=(f?o:2*o))break}if(s.length!==o&&s.length!==o*2)throw new Error("cchText: "+o+" != "+s.length);return e.l=n+t,{t:s}}catch{return e.l=n+t,{t:s}}}function B9(e,t){var r=y0(e);e.l+=16;var n=q5(e,t-24);return[r,n]}function $9(e,t){e.read_shift(2);var r=y0(e),n=e.read_shift((t-10)/2,"dbcs-cont");return n=n.replace(nn,""),[r,n]}function W9(e){var t=[0,0],r;return r=e.read_shift(2),t[0]=Hw[r]||r,r=e.read_shift(2),t[1]=Hw[r]||r,t}function z9(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(Bb(e));return r}function H9(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(Bb(e));return r}function G9(e){e.l+=2;var t={cxfs:0,crc:0};return t.cxfs=e.read_shift(2),t.crc=e.read_shift(4),t}function Gb(e,t,r){if(!r.cellStyles)return qr(e,t);var n=r&&r.biff>=12?4:2,s=e.read_shift(n),a=e.read_shift(n),i=e.read_shift(n),o=e.read_shift(n),l=e.read_shift(2);n==2&&(e.l+=2);var u={s,e:a,w:i,ixfe:o,flags:l};return(r.biff>=5||!r.biff)&&(u.level=l>>8&7),u}function K9(e,t){var r={};return t<32||(e.l+=16,r.header=$r(e),r.footer=$r(e),e.l+=2),r}function q9(e,t,r){var n={area:!1};if(r.biff!=5)return e.l+=t,n;var s=e.read_shift(1);return e.l+=3,s&16&&(n.area=!0),n}var X9=Hs,Y9=Ub,Q9=rf;function J9(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),s={fmt:t,env:r,len:n,data:e.slice(e.l,e.l+n)};return e.l+=n,s}function Z9(e,t,r){r.biffguess&&r.biff==5&&(r.biff=2);var n=Hs(e);++e.l;var s=_o(e,t-7,r);return n.t="str",n.val=s,n}function eU(e){var t=Hs(e);++e.l;var r=$r(e);return t.t="n",t.val=r,t}function tU(e){var t=Hs(e);++e.l;var r=e.read_shift(2);return t.t="n",t.val=r,t}function rU(e){var t=e.read_shift(1);return t===0?(e.l++,""):e.read_shift(t,"sbcs-cont")}function nU(e,t){e.l+=6,e.l+=2,e.l+=1,e.l+=3,e.l+=1,e.l+=t-13}function sU(e,t,r){var n=e.l+t,s=Hs(e),a=e.read_shift(2),i=oo(e,a,r);return e.l=n,s.t="str",s.val=i,s}var aU=[2,3,48,49,131,139,140,245],nE=function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},t=_v({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(o,l){var u=[],f=xi(1);switch(l.type){case"base64":f=ms(Mn(o));break;case"binary":f=ms(o);break;case"buffer":case"array":f=o;break}kr(f,0);var d=f.read_shift(1),m=!!(d&136),p=!1,x=!1;switch(d){case 2:break;case 3:break;case 48:p=!0,m=!0;break;case 49:p=!0,m=!0;break;case 131:break;case 139:break;case 140:x=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+d.toString(16))}var g=0,_=521;d==2&&(g=f.read_shift(2)),f.l+=3,d!=2&&(g=f.read_shift(4)),g>1048576&&(g=1e6),d!=2&&(_=f.read_shift(2));var k=f.read_shift(2),E=l.codepage||1252;d!=2&&(f.l+=16,f.read_shift(1),f[f.l]!==0&&(E=e[f[f.l]]),f.l+=1,f.l+=2),x&&(f.l+=36);for(var y=[],b={},O=Math.min(f.length,d==2?521:_-10-(p?264:0)),D=x?32:11;f.l<O&&f[f.l]!=13;)switch(b={},b.name=_u.utils.decode(E,f.slice(f.l,f.l+D)).replace(/[\u0000\r\n].*$/g,""),f.l+=D,b.type=String.fromCharCode(f.read_shift(1)),d!=2&&!x&&(b.offset=f.read_shift(4)),b.len=f.read_shift(1),d==2&&(b.offset=f.read_shift(2)),b.dec=f.read_shift(1),b.name.length&&y.push(b),d!=2&&(f.l+=x?13:14),b.type){case"B":(!p||b.len!=8)&&l.WTF&&console.log("Skipping "+b.name+":"+b.type);break;case"G":case"P":l.WTF&&console.log("Skipping "+b.name+":"+b.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+b.type)}if(f[f.l]!==13&&(f.l=_-1),f.read_shift(1)!==13)throw new Error("DBF Terminator not found "+f.l+" "+f[f.l]);f.l=_;var v=0,T=0;for(u[0]=[],T=0;T!=y.length;++T)u[0][T]=y[T].name;for(;g-- >0;){if(f[f.l]===42){f.l+=k;continue}for(++f.l,u[++v]=[],T=0,T=0;T!=y.length;++T){var S=f.slice(f.l,f.l+y[T].len);f.l+=y[T].len,kr(S,0);var N=_u.utils.decode(E,S);switch(y[T].type){case"C":N.trim().length&&(u[v][T]=N.replace(/\s+$/,""));break;case"D":N.length===8?u[v][T]=new Date(+N.slice(0,4),+N.slice(4,6)-1,+N.slice(6,8)):u[v][T]=N;break;case"F":u[v][T]=parseFloat(N.trim());break;case"+":case"I":u[v][T]=x?S.read_shift(-4,"i")^2147483648:S.read_shift(4,"i");break;case"L":switch(N.trim().toUpperCase()){case"Y":case"T":u[v][T]=!0;break;case"N":case"F":u[v][T]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+N+"|")}break;case"M":if(!m)throw new Error("DBF Unexpected MEMO for type "+d.toString(16));u[v][T]="##MEMO##"+(x?parseInt(N.trim(),10):S.read_shift(4));break;case"N":N=N.replace(/\u0000/g,"").trim(),N&&N!="."&&(u[v][T]=+N||0);break;case"@":u[v][T]=new Date(S.read_shift(-8,"f")-621356832e5);break;case"T":u[v][T]=new Date((S.read_shift(4)-2440588)*864e5+S.read_shift(4));break;case"Y":u[v][T]=S.read_shift(4,"i")/1e4+S.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":u[v][T]=-S.read_shift(-8,"f");break;case"B":if(p&&y[T].len==8){u[v][T]=S.read_shift(8,"f");break}case"G":case"P":S.l+=y[T].len;break;case"0":if(y[T].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+y[T].type)}}}if(d!=2&&f.l<f.length&&f[f.l++]!=26)throw new Error("DBF EOF Marker missing "+(f.l-1)+" of "+f.length+" "+f[f.l-1].toString(16));return l&&l.sheetRows&&(u=u.slice(0,l.sheetRows)),l.DBF=y,u}function n(o,l){var u=l||{};u.dateNF||(u.dateNF="yyyymmdd");var f=Ll(r(o,u),u);return f["!cols"]=u.DBF.map(function(d){return{wch:d.len,DBF:d}}),delete u.DBF,f}function s(o,l){try{return ki(n(o,l),l)}catch(u){if(l&&l.WTF)throw u}return{SheetNames:[],Sheets:{}}}var a={B:8,C:250,L:1,D:8,"?":0,"":0};function i(o,l){var u=l||{};if(+u.codepage>=0&&ps(+u.codepage),u.type=="string")throw new Error("Cannot write DBF to JS string");var f=Zp(),d=lg(o,{header:1,raw:!0,cellDates:!0}),m=d[0],p=d.slice(1),x=o["!cols"]||[],g=0,_=0,k=0,E=1;for(g=0;g<m.length;++g){if(((x[g]||{}).DBF||{}).name){m[g]=x[g].DBF.name,++k;continue}if(m[g]!=null){if(++k,typeof m[g]=="number"&&(m[g]=m[g].toString(10)),typeof m[g]!="string")throw new Error("DBF Invalid column name "+m[g]+" |"+typeof m[g]+"|");if(m.indexOf(m[g])!==g){for(_=0;_<1024;++_)if(m.indexOf(m[g]+"_"+_)==-1){m[g]+="_"+_;break}}}}var y=Gt(o["!ref"]),b=[],O=[],D=[];for(g=0;g<=y.e.c-y.s.c;++g){var v="",T="",S=0,N=[];for(_=0;_<p.length;++_)p[_][g]!=null&&N.push(p[_][g]);if(N.length==0||m[g]==null){b[g]="?";continue}for(_=0;_<N.length;++_){switch(typeof N[_]){case"number":T="B";break;case"string":T="C";break;case"boolean":T="L";break;case"object":T=N[_]instanceof Date?"D":"C";break;default:T="C"}S=Math.max(S,String(N[_]).length),v=v&&v!=T?"C":T}S>250&&(S=250),T=((x[g]||{}).DBF||{}).type,T=="C"&&x[g].DBF.len>S&&(S=x[g].DBF.len),v=="B"&&T=="N"&&(v="N",D[g]=x[g].DBF.dec,S=x[g].DBF.len),O[g]=v=="C"||T=="N"?S:a[v]||0,E+=O[g],b[g]=v}var C=f.next(32);for(C.write_shift(4,318902576),C.write_shift(4,p.length),C.write_shift(2,296+32*k),C.write_shift(2,E),g=0;g<4;++g)C.write_shift(4,0);for(C.write_shift(4,0|(+t[HA]||3)<<8),g=0,_=0;g<m.length;++g)if(m[g]!=null){var R=f.next(32),F=(m[g].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);R.write_shift(1,F,"sbcs"),R.write_shift(1,b[g]=="?"?"C":b[g],"sbcs"),R.write_shift(4,_),R.write_shift(1,O[g]||a[b[g]]||0),R.write_shift(1,D[g]||0),R.write_shift(1,2),R.write_shift(4,0),R.write_shift(1,0),R.write_shift(4,0),R.write_shift(4,0),_+=O[g]||a[b[g]]||0}var oe=f.next(264);for(oe.write_shift(4,13),g=0;g<65;++g)oe.write_shift(4,0);for(g=0;g<p.length;++g){var te=f.next(E);for(te.write_shift(1,0),_=0;_<m.length;++_)if(m[_]!=null)switch(b[_]){case"L":te.write_shift(1,p[g][_]==null?63:p[g][_]?84:70);break;case"B":te.write_shift(8,p[g][_]||0,"f");break;case"N":var de="0";for(typeof p[g][_]=="number"&&(de=p[g][_].toFixed(D[_]||0)),k=0;k<O[_]-de.length;++k)te.write_shift(1,32);te.write_shift(1,de,"sbcs");break;case"D":p[g][_]?(te.write_shift(4,("0000"+p[g][_].getFullYear()).slice(-4),"sbcs"),te.write_shift(2,("00"+(p[g][_].getMonth()+1)).slice(-2),"sbcs"),te.write_shift(2,("00"+p[g][_].getDate()).slice(-2),"sbcs")):te.write_shift(8,"00000000","sbcs");break;case"C":var ae=String(p[g][_]!=null?p[g][_]:"").slice(0,O[_]);for(te.write_shift(1,ae,"sbcs"),k=0;k<O[_]-ae.length;++k)te.write_shift(1,32);break}}return f.next(1).write_shift(1,26),f.end()}return{to_workbook:s,to_sheet:n,from_sheet:i}}(),iU=function(){var e={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},t=new RegExp("\x1BN("+$s(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(m,p){var x=e[p];return typeof x=="number"?yw(x):x},n=function(m,p,x){var g=p.charCodeAt(0)-32<<4|x.charCodeAt(0)-48;return g==59?m:yw(g)};e["|"]=254;function s(m,p){switch(p.type){case"base64":return a(Mn(m),p);case"binary":return a(m,p);case"buffer":return a(tt&&Buffer.isBuffer(m)?m.toString("binary"):go(m),p);case"array":return a(io(m),p)}throw new Error("Unrecognized type "+p.type)}function a(m,p){var x=m.split(/[\n\r]+/),g=-1,_=-1,k=0,E=0,y=[],b=[],O=null,D={},v=[],T=[],S=[],N=0,C;for(+p.codepage>=0&&ps(+p.codepage);k!==x.length;++k){N=0;var R=x[k].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(t,r),F=R.replace(/;;/g,"\0").split(";").map(function(L){return L.replace(/\u0000/g,";")}),oe=F[0],te;if(R.length>0)switch(oe){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":F[1].charAt(0)=="P"&&b.push(R.slice(3).replace(/;;/g,";"));break;case"C":var de=!1,ae=!1,X=!1,H=!1,Z=-1,Y=-1;for(E=1;E<F.length;++E)switch(F[E].charAt(0)){case"A":break;case"X":_=parseInt(F[E].slice(1))-1,ae=!0;break;case"Y":for(g=parseInt(F[E].slice(1))-1,ae||(_=0),C=y.length;C<=g;++C)y[C]=[];break;case"K":te=F[E].slice(1),te.charAt(0)==='"'?te=te.slice(1,te.length-1):te==="TRUE"?te=!0:te==="FALSE"?te=!1:isNaN(_s(te))?isNaN(Sl(te).getDate())||(te=yr(te)):(te=_s(te),O!==null&&Ml(O)&&(te=v0(te))),de=!0;break;case"E":H=!0;var M=il(F[E].slice(1),{r:g,c:_});y[g][_]=[y[g][_],M];break;case"S":X=!0,y[g][_]=[y[g][_],"S5S"];break;case"G":break;case"R":Z=parseInt(F[E].slice(1))-1;break;case"C":Y=parseInt(F[E].slice(1))-1;break;default:if(p&&p.WTF)throw new Error("SYLK bad record "+R)}if(de&&(y[g][_]&&y[g][_].length==2?y[g][_][0]=te:y[g][_]=te,O=null),X){if(H)throw new Error("SYLK shared formula cannot have own formula");var q=Z>-1&&y[Z][Y];if(!q||!q[1])throw new Error("SYLK shared formula cannot find base");y[g][_][1]=rI(q[1],{r:g-Z,c:_-Y})}break;case"F":var K=0;for(E=1;E<F.length;++E)switch(F[E].charAt(0)){case"X":_=parseInt(F[E].slice(1))-1,++K;break;case"Y":for(g=parseInt(F[E].slice(1))-1,C=y.length;C<=g;++C)y[C]=[];break;case"M":N=parseInt(F[E].slice(1))/20;break;case"F":break;case"G":break;case"P":O=b[parseInt(F[E].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(S=F[E].slice(1).split(" "),C=parseInt(S[0],10);C<=parseInt(S[1],10);++C)N=parseInt(S[2],10),T[C-1]=N===0?{hidden:!0}:{wch:N},Al(T[C-1]);break;case"C":_=parseInt(F[E].slice(1))-1,T[_]||(T[_]={});break;case"R":g=parseInt(F[E].slice(1))-1,v[g]||(v[g]={}),N>0?(v[g].hpt=N,v[g].hpx=Au(N)):N===0&&(v[g].hidden=!0);break;default:if(p&&p.WTF)throw new Error("SYLK bad record "+R)}K<1&&(O=null);break;default:if(p&&p.WTF)throw new Error("SYLK bad record "+R)}}return v.length>0&&(D["!rows"]=v),T.length>0&&(D["!cols"]=T),p&&p.sheetRows&&(y=y.slice(0,p.sheetRows)),[y,D]}function i(m,p){var x=s(m,p),g=x[0],_=x[1],k=Ll(g,p);return $s(_).forEach(function(E){k[E]=_[E]}),k}function o(m,p){return ki(i(m,p),p)}function l(m,p,x,g){var _="C;Y"+(x+1)+";X"+(g+1)+";K";switch(m.t){case"n":_+=m.v||0,m.f&&!m.F&&(_+=";E"+GV(m.f,{r:x,c:g}));break;case"b":_+=m.v?"TRUE":"FALSE";break;case"e":_+=m.w||m.v;break;case"d":_+='"'+(m.w||m.v)+'"';break;case"s":_+='"'+m.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return _}function u(m,p){p.forEach(function(x,g){var _="F;W"+(g+1)+" "+(g+1)+" ";x.hidden?_+="0":(typeof x.width=="number"&&!x.wpx&&(x.wpx=Td(x.width)),typeof x.wpx=="number"&&!x.wch&&(x.wch=kd(x.wpx)),typeof x.wch=="number"&&(_+=Math.round(x.wch))),_.charAt(_.length-1)!=" "&&m.push(_)})}function f(m,p){p.forEach(function(x,g){var _="F;";x.hidden?_+="M0;":x.hpt?_+="M"+20*x.hpt+";":x.hpx&&(_+="M"+20*Zb(x.hpx)+";"),_.length>2&&m.push(_+"R"+(g+1))})}function d(m,p){var x=["ID;PWXL;N;E"],g=[],_=Gt(m["!ref"]),k,E=Array.isArray(m),y=`\r
`;x.push("P;PGeneral"),x.push("F;P0;DG0G8;M255"),m["!cols"]&&u(x,m["!cols"]),m["!rows"]&&f(x,m["!rows"]),x.push("B;Y"+(_.e.r-_.s.r+1)+";X"+(_.e.c-_.s.c+1)+";D"+[_.s.c,_.s.r,_.e.c,_.e.r].join(" "));for(var b=_.s.r;b<=_.e.r;++b)for(var O=_.s.c;O<=_.e.c;++O){var D=We({r:b,c:O});k=E?(m[b]||[])[O]:m[D],!(!k||k.v==null&&(!k.f||k.F))&&g.push(l(k,m,b,O))}return x.join(y)+y+g.join(y)+y+"E"+y}return{to_workbook:o,to_sheet:i,from_sheet:d}}(),oU=function(){function e(a,i){switch(i.type){case"base64":return t(Mn(a),i);case"binary":return t(a,i);case"buffer":return t(tt&&Buffer.isBuffer(a)?a.toString("binary"):go(a),i);case"array":return t(io(a),i)}throw new Error("Unrecognized type "+i.type)}function t(a,i){for(var o=a.split(`
`),l=-1,u=-1,f=0,d=[];f!==o.length;++f){if(o[f].trim()==="BOT"){d[++l]=[],u=0;continue}if(!(l<0)){var m=o[f].trim().split(","),p=m[0],x=m[1];++f;for(var g=o[f]||"";(g.match(/["]/g)||[]).length&1&&f<o.length-1;)g+=`
`+o[++f];switch(g=g.trim(),+p){case-1:if(g==="BOT"){d[++l]=[],u=0;continue}else if(g!=="EOD")throw new Error("Unrecognized DIF special command "+g);break;case 0:g==="TRUE"?d[l][u]=!0:g==="FALSE"?d[l][u]=!1:isNaN(_s(x))?isNaN(Sl(x).getDate())?d[l][u]=x:d[l][u]=yr(x):d[l][u]=_s(x),++u;break;case 1:g=g.slice(1,g.length-1),g=g.replace(/""/g,'"'),g&&g.match(/^=".*"$/)&&(g=g.slice(2,-1)),d[l][u++]=g!==""?g:null;break}if(g==="EOD")break}}return i&&i.sheetRows&&(d=d.slice(0,i.sheetRows)),d}function r(a,i){return Ll(e(a,i),i)}function n(a,i){return ki(r(a,i),i)}var s=function(){var a=function(l,u,f,d,m){l.push(u),l.push(f+","+d),l.push('"'+m.replace(/"/g,'""')+'"')},i=function(l,u,f,d){l.push(u+","+f),l.push(u==1?'"'+d.replace(/"/g,'""')+'"':d)};return function(l){var u=[],f=Gt(l["!ref"]),d,m=Array.isArray(l);a(u,"TABLE",0,1,"sheetjs"),a(u,"VECTORS",0,f.e.r-f.s.r+1,""),a(u,"TUPLES",0,f.e.c-f.s.c+1,""),a(u,"DATA",0,0,"");for(var p=f.s.r;p<=f.e.r;++p){i(u,-1,0,"BOT");for(var x=f.s.c;x<=f.e.c;++x){var g=We({r:p,c:x});if(d=m?(l[p]||[])[x]:l[g],!d){i(u,1,0,"");continue}switch(d.t){case"n":var _=d.w;!_&&d.v!=null&&(_=d.v),_==null?d.f&&!d.F?i(u,1,0,"="+d.f):i(u,1,0,""):i(u,0,_,"V");break;case"b":i(u,0,d.v?1:0,d.v?"TRUE":"FALSE");break;case"s":i(u,1,0,isNaN(d.v)?d.v:'="'+d.v+'"');break;case"d":d.w||(d.w=es(d.z||He[14],sn(yr(d.v)))),i(u,0,d.w,"V");break;default:i(u,1,0,"")}}}i(u,-1,0,"EOD");var k=`\r
`,E=u.join(k);return E}}();return{to_workbook:n,to_sheet:r,from_sheet:s}}(),lU=function(){function e(d){return d.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function t(d){return d.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(d,m){for(var p=d.split(`
`),x=-1,g=-1,_=0,k=[];_!==p.length;++_){var E=p[_].trim().split(":");if(E[0]==="cell"){var y=en(E[1]);if(k.length<=y.r)for(x=k.length;x<=y.r;++x)k[x]||(k[x]=[]);switch(x=y.r,g=y.c,E[2]){case"t":k[x][g]=e(E[3]);break;case"v":k[x][g]=+E[3];break;case"vtf":var b=E[E.length-1];case"vtc":switch(E[3]){case"nl":k[x][g]=!!+E[4];break;default:k[x][g]=+E[4];break}E[2]=="vtf"&&(k[x][g]=[k[x][g],b])}}}return m&&m.sheetRows&&(k=k.slice(0,m.sheetRows)),k}function n(d,m){return Ll(r(d,m),m)}function s(d,m){return ki(n(d,m),m)}var a=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),i=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,o=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),l="--SocialCalcSpreadsheetControlSave--";function u(d){if(!d||!d["!ref"])return"";for(var m=[],p=[],x,g="",_=jl(d["!ref"]),k=Array.isArray(d),E=_.s.r;E<=_.e.r;++E)for(var y=_.s.c;y<=_.e.c;++y)if(g=We({r:E,c:y}),x=k?(d[E]||[])[y]:d[g],!(!x||x.v==null||x.t==="z")){switch(p=["cell",g,"t"],x.t){case"s":case"str":p.push(t(x.v));break;case"n":x.f?(p[2]="vtf",p[3]="n",p[4]=x.v,p[5]=t(x.f)):(p[2]="v",p[3]=x.v);break;case"b":p[2]="vt"+(x.f?"f":"c"),p[3]="nl",p[4]=x.v?"1":"0",p[5]=t(x.f||(x.v?"TRUE":"FALSE"));break;case"d":var b=sn(yr(x.v));p[2]="vtc",p[3]="nd",p[4]=""+b,p[5]=x.w||es(x.z||He[14],b);break;case"e":continue}m.push(p.join(":"))}return m.push("sheet:c:"+(_.e.c-_.s.c+1)+":r:"+(_.e.r-_.s.r+1)+":tvf:1"),m.push("valueformat:1:text-wiki"),m.join(`
`)}function f(d){return[a,i,o,i,u(d),l].join(`
`)}return{to_workbook:s,to_sheet:n,from_sheet:f}}(),ku=function(){function e(f,d,m,p,x){x.raw?d[m][p]=f:f===""||(f==="TRUE"?d[m][p]=!0:f==="FALSE"?d[m][p]=!1:isNaN(_s(f))?isNaN(Sl(f).getDate())?d[m][p]=f:d[m][p]=yr(f):d[m][p]=_s(f))}function t(f,d){var m=d||{},p=[];if(!f||f.length===0)return p;for(var x=f.split(/[\r\n]/),g=x.length-1;g>=0&&x[g].length===0;)--g;for(var _=10,k=0,E=0;E<=g;++E)k=x[E].indexOf(" "),k==-1?k=x[E].length:k++,_=Math.max(_,k);for(E=0;E<=g;++E){p[E]=[];var y=0;for(e(x[E].slice(0,_).trim(),p,E,y,m),y=1;y<=(x[E].length-_)/10+1;++y)e(x[E].slice(_+(y-1)*10,_+y*10).trim(),p,E,y,m)}return m.sheetRows&&(p=p.slice(0,m.sheetRows)),p}var r={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function s(f){for(var d={},m=!1,p=0,x=0;p<f.length;++p)(x=f.charCodeAt(p))==34?m=!m:!m&&x in r&&(d[x]=(d[x]||0)+1);x=[];for(p in d)Object.prototype.hasOwnProperty.call(d,p)&&x.push([d[p],p]);if(!x.length){d=n;for(p in d)Object.prototype.hasOwnProperty.call(d,p)&&x.push([d[p],p])}return x.sort(function(g,_){return g[0]-_[0]||n[g[1]]-n[_[1]]}),r[x.pop()[1]]||44}function a(f,d){var m=d||{},p="",x=m.dense?[]:{},g={s:{c:0,r:0},e:{c:0,r:0}};f.slice(0,4)=="sep="?f.charCodeAt(5)==13&&f.charCodeAt(6)==10?(p=f.charAt(4),f=f.slice(7)):f.charCodeAt(5)==13||f.charCodeAt(5)==10?(p=f.charAt(4),f=f.slice(6)):p=s(f.slice(0,1024)):m&&m.FS?p=m.FS:p=s(f.slice(0,1024));var _=0,k=0,E=0,y=0,b=0,O=p.charCodeAt(0),D=!1,v=0,T=f.charCodeAt(0);f=f.replace(/\r\n/mg,`
`);var S=m.dateNF!=null?y8(m.dateNF):null;function N(){var C=f.slice(y,b),R={};if(C.charAt(0)=='"'&&C.charAt(C.length-1)=='"'&&(C=C.slice(1,-1).replace(/""/g,'"')),C.length===0)R.t="z";else if(m.raw)R.t="s",R.v=C;else if(C.trim().length===0)R.t="s",R.v=C;else if(C.charCodeAt(0)==61)C.charCodeAt(1)==34&&C.charCodeAt(C.length-1)==34?(R.t="s",R.v=C.slice(2,-1).replace(/""/g,'"')):qV(C)?(R.t="n",R.f=C.slice(1)):(R.t="s",R.v=C);else if(C=="TRUE")R.t="b",R.v=!0;else if(C=="FALSE")R.t="b",R.v=!1;else if(!isNaN(E=_s(C)))R.t="n",m.cellText!==!1&&(R.w=C),R.v=E;else if(!isNaN(Sl(C).getDate())||S&&C.match(S)){R.z=m.dateNF||He[14];var F=0;S&&C.match(S)&&(C=_8(C,m.dateNF,C.match(S)||[]),F=1),m.cellDates?(R.t="d",R.v=yr(C,F)):(R.t="n",R.v=sn(yr(C,F))),m.cellText!==!1&&(R.w=es(R.z,R.v instanceof Date?sn(R.v):R.v)),m.cellNF||delete R.z}else R.t="s",R.v=C;if(R.t=="z"||(m.dense?(x[_]||(x[_]=[]),x[_][k]=R):x[We({c:k,r:_})]=R),y=b+1,T=f.charCodeAt(y),g.e.c<k&&(g.e.c=k),g.e.r<_&&(g.e.r=_),v==O)++k;else if(k=0,++_,m.sheetRows&&m.sheetRows<=_)return!0}e:for(;b<f.length;++b)switch(v=f.charCodeAt(b)){case 34:T===34&&(D=!D);break;case O:case 10:case 13:if(!D&&N())break e;break}return b-y>0&&N(),x["!ref"]=at(g),x}function i(f,d){return!(d&&d.PRN)||d.FS||f.slice(0,4)=="sep="||f.indexOf("	")>=0||f.indexOf(",")>=0||f.indexOf(";")>=0?a(f,d):Ll(t(f,d),d)}function o(f,d){var m="",p=d.type=="string"?[0,0,0,0]:Uv(f,d);switch(d.type){case"base64":m=Mn(f);break;case"binary":m=f;break;case"buffer":d.codepage==65001?m=f.toString("utf8"):d.codepage&&typeof _u<"u"||(m=tt&&Buffer.isBuffer(f)?f.toString("binary"):go(f));break;case"array":m=io(f);break;case"string":m=f;break;default:throw new Error("Unrecognized type "+d.type)}return p[0]==239&&p[1]==187&&p[2]==191?m=St(m.slice(3)):d.type!="string"&&d.type!="buffer"&&d.codepage==65001?m=St(m):d.type=="binary"&&typeof _u<"u",m.slice(0,19)=="socialcalc:version:"?lU.to_sheet(d.type=="string"?m:St(m),d):i(m,d)}function l(f,d){return ki(o(f,d),d)}function u(f){for(var d=[],m=Gt(f["!ref"]),p,x=Array.isArray(f),g=m.s.r;g<=m.e.r;++g){for(var _=[],k=m.s.c;k<=m.e.c;++k){var E=We({r:g,c:k});if(p=x?(f[g]||[])[k]:f[E],!p||p.v==null){_.push("          ");continue}for(var y=(p.w||(Sa(p),p.w)||"").slice(0,10);y.length<10;)y+=" ";_.push(y+(k===0?" ":""))}d.push(_.join(""))}return d.join(`
`)}return{to_workbook:l,to_sheet:o,from_sheet:u}}();function cU(e,t){var r=t||{},n=!!r.WTF;r.WTF=!0;try{var s=iU.to_workbook(e,r);return r.WTF=n,s}catch(a){if(r.WTF=n,!a.message.match(/SYLK bad record ID/)&&n)throw a;return ku.to_workbook(e,t)}}var Bc=function(){function e(M,q,K){if(M){kr(M,M.l||0);for(var L=K.Enum||Z;M.l<M.length;){var J=M.read_shift(2),fe=L[J]||L[65535],we=M.read_shift(2),ge=M.l+we,pe=fe.f&&fe.f(M,we,K);if(M.l=ge,q(pe,fe,J))return}}}function t(M,q){switch(q.type){case"base64":return r(ms(Mn(M)),q);case"binary":return r(ms(M),q);case"buffer":case"array":return r(M,q)}throw"Unsupported type "+q.type}function r(M,q){if(!M)return M;var K=q||{},L=K.dense?[]:{},J="Sheet1",fe="",we=0,ge={},pe=[],Pe=[],G={s:{r:0,c:0},e:{r:0,c:0}},Xe=K.sheetRows||0;if(M[2]==0&&(M[3]==8||M[3]==9)&&M.length>=16&&M[14]==5&&M[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(M[2]==2)K.Enum=Z,e(M,function(Se,yt,Qt){switch(Qt){case 0:K.vers=Se,Se>=4096&&(K.qpro=!0);break;case 6:G=Se;break;case 204:Se&&(fe=Se);break;case 222:fe=Se;break;case 15:case 51:K.qpro||(Se[1].v=Se[1].v.slice(1));case 13:case 14:case 16:Qt==14&&(Se[2]&112)==112&&(Se[2]&15)>1&&(Se[2]&15)<15&&(Se[1].z=K.dateNF||He[14],K.cellDates&&(Se[1].t="d",Se[1].v=v0(Se[1].v))),K.qpro&&Se[3]>we&&(L["!ref"]=at(G),ge[J]=L,pe.push(J),L=K.dense?[]:{},G={s:{r:0,c:0},e:{r:0,c:0}},we=Se[3],J=fe||"Sheet"+(we+1),fe="");var dr=K.dense?(L[Se[0].r]||[])[Se[0].c]:L[We(Se[0])];if(dr){dr.t=Se[1].t,dr.v=Se[1].v,Se[1].z!=null&&(dr.z=Se[1].z),Se[1].f!=null&&(dr.f=Se[1].f);break}K.dense?(L[Se[0].r]||(L[Se[0].r]=[]),L[Se[0].r][Se[0].c]=Se[1]):L[We(Se[0])]=Se[1];break}},K);else if(M[2]==26||M[2]==14)K.Enum=Y,M[2]==14&&(K.qpro=!0,M.l=0),e(M,function(Se,yt,Qt){switch(Qt){case 204:J=Se;break;case 22:Se[1].v=Se[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(Se[3]>we&&(L["!ref"]=at(G),ge[J]=L,pe.push(J),L=K.dense?[]:{},G={s:{r:0,c:0},e:{r:0,c:0}},we=Se[3],J="Sheet"+(we+1)),Xe>0&&Se[0].r>=Xe)break;K.dense?(L[Se[0].r]||(L[Se[0].r]=[]),L[Se[0].r][Se[0].c]=Se[1]):L[We(Se[0])]=Se[1],G.e.c<Se[0].c&&(G.e.c=Se[0].c),G.e.r<Se[0].r&&(G.e.r=Se[0].r);break;case 27:Se[14e3]&&(Pe[Se[14e3][0]]=Se[14e3][1]);break;case 1537:Pe[Se[0]]=Se[1],Se[0]==we&&(J=Se[1]);break}},K);else throw new Error("Unrecognized LOTUS BOF "+M[2]);if(L["!ref"]=at(G),ge[fe||J]=L,pe.push(fe||J),!Pe.length)return{SheetNames:pe,Sheets:ge};for(var Ve={},Ze=[],Oe=0;Oe<Pe.length;++Oe)ge[pe[Oe]]?(Ze.push(Pe[Oe]||pe[Oe]),Ve[Pe[Oe]]=ge[Pe[Oe]]||ge[pe[Oe]]):(Ze.push(Pe[Oe]),Ve[Pe[Oe]]={"!ref":"A1"});return{SheetNames:Ze,Sheets:Ve}}function n(M,q){var K=q||{};if(+K.codepage>=0&&ps(+K.codepage),K.type=="string")throw new Error("Cannot write WK1 to JS string");var L=Zp(),J=Gt(M["!ref"]),fe=Array.isArray(M),we=[];os(L,0,a(1030)),os(L,6,l(J));for(var ge=Math.min(J.e.r,8191),pe=J.s.r;pe<=ge;++pe)for(var Pe=Nr(pe),G=J.s.c;G<=J.e.c;++G){pe===J.s.r&&(we[G]=ur(G));var Xe=we[G]+Pe,Ve=fe?(M[pe]||[])[G]:M[Xe];if(!(!Ve||Ve.t=="z"))if(Ve.t=="n")(Ve.v|0)==Ve.v&&Ve.v>=-32768&&Ve.v<=32767?os(L,13,p(pe,G,Ve.v)):os(L,14,g(pe,G,Ve.v));else{var Ze=Sa(Ve);os(L,15,d(pe,G,Ze.slice(0,239)))}}return os(L,1),L.end()}function s(M,q){var K=q||{};if(+K.codepage>=0&&ps(+K.codepage),K.type=="string")throw new Error("Cannot write WK3 to JS string");var L=Zp();os(L,0,i(M));for(var J=0,fe=0;J<M.SheetNames.length;++J)(M.Sheets[M.SheetNames[J]]||{})["!ref"]&&os(L,27,H(M.SheetNames[J],fe++));var we=0;for(J=0;J<M.SheetNames.length;++J){var ge=M.Sheets[M.SheetNames[J]];if(!(!ge||!ge["!ref"])){for(var pe=Gt(ge["!ref"]),Pe=Array.isArray(ge),G=[],Xe=Math.min(pe.e.r,8191),Ve=pe.s.r;Ve<=Xe;++Ve)for(var Ze=Nr(Ve),Oe=pe.s.c;Oe<=pe.e.c;++Oe){Ve===pe.s.r&&(G[Oe]=ur(Oe));var Se=G[Oe]+Ze,yt=Pe?(ge[Ve]||[])[Oe]:ge[Se];if(!(!yt||yt.t=="z"))if(yt.t=="n")os(L,23,N(Ve,Oe,we,yt.v));else{var Qt=Sa(yt);os(L,22,v(Ve,Oe,we,Qt.slice(0,239)))}}++we}}return os(L,1),L.end()}function a(M){var q=or(2);return q.write_shift(2,M),q}function i(M){var q=or(26);q.write_shift(2,4096),q.write_shift(2,4),q.write_shift(4,0);for(var K=0,L=0,J=0,fe=0;fe<M.SheetNames.length;++fe){var we=M.SheetNames[fe],ge=M.Sheets[we];if(!(!ge||!ge["!ref"])){++J;var pe=jl(ge["!ref"]);K<pe.e.r&&(K=pe.e.r),L<pe.e.c&&(L=pe.e.c)}}return K>8191&&(K=8191),q.write_shift(2,K),q.write_shift(1,J),q.write_shift(1,L),q.write_shift(2,0),q.write_shift(2,0),q.write_shift(1,1),q.write_shift(1,2),q.write_shift(4,0),q.write_shift(4,0),q}function o(M,q,K){var L={s:{c:0,r:0},e:{c:0,r:0}};return q==8&&K.qpro?(L.s.c=M.read_shift(1),M.l++,L.s.r=M.read_shift(2),L.e.c=M.read_shift(1),M.l++,L.e.r=M.read_shift(2),L):(L.s.c=M.read_shift(2),L.s.r=M.read_shift(2),q==12&&K.qpro&&(M.l+=2),L.e.c=M.read_shift(2),L.e.r=M.read_shift(2),q==12&&K.qpro&&(M.l+=2),L.s.c==65535&&(L.s.c=L.e.c=L.s.r=L.e.r=0),L)}function l(M){var q=or(8);return q.write_shift(2,M.s.c),q.write_shift(2,M.s.r),q.write_shift(2,M.e.c),q.write_shift(2,M.e.r),q}function u(M,q,K){var L=[{c:0,r:0},{t:"n",v:0},0,0];return K.qpro&&K.vers!=20768?(L[0].c=M.read_shift(1),L[3]=M.read_shift(1),L[0].r=M.read_shift(2),M.l+=2):(L[2]=M.read_shift(1),L[0].c=M.read_shift(2),L[0].r=M.read_shift(2)),L}function f(M,q,K){var L=M.l+q,J=u(M,q,K);if(J[1].t="s",K.vers==20768){M.l++;var fe=M.read_shift(1);return J[1].v=M.read_shift(fe,"utf8"),J}return K.qpro&&M.l++,J[1].v=M.read_shift(L-M.l,"cstr"),J}function d(M,q,K){var L=or(7+K.length);L.write_shift(1,255),L.write_shift(2,q),L.write_shift(2,M),L.write_shift(1,39);for(var J=0;J<L.length;++J){var fe=K.charCodeAt(J);L.write_shift(1,fe>=128?95:fe)}return L.write_shift(1,0),L}function m(M,q,K){var L=u(M,q,K);return L[1].v=M.read_shift(2,"i"),L}function p(M,q,K){var L=or(7);return L.write_shift(1,255),L.write_shift(2,q),L.write_shift(2,M),L.write_shift(2,K,"i"),L}function x(M,q,K){var L=u(M,q,K);return L[1].v=M.read_shift(8,"f"),L}function g(M,q,K){var L=or(13);return L.write_shift(1,255),L.write_shift(2,q),L.write_shift(2,M),L.write_shift(8,K,"f"),L}function _(M,q,K){var L=M.l+q,J=u(M,q,K);if(J[1].v=M.read_shift(8,"f"),K.qpro)M.l=L;else{var fe=M.read_shift(2);b(M.slice(M.l,M.l+fe),J),M.l+=fe}return J}function k(M,q,K){var L=q&32768;return q&=-32769,q=(L?M:0)+(q>=8192?q-16384:q),(L?"":"$")+(K?ur(q):Nr(q))}var E={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},y=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function b(M,q){kr(M,0);for(var K=[],L=0,J="",fe="",we="",ge="";M.l<M.length;){var pe=M[M.l++];switch(pe){case 0:K.push(M.read_shift(8,"f"));break;case 1:fe=k(q[0].c,M.read_shift(2),!0),J=k(q[0].r,M.read_shift(2),!1),K.push(fe+J);break;case 2:{var Pe=k(q[0].c,M.read_shift(2),!0),G=k(q[0].r,M.read_shift(2),!1);fe=k(q[0].c,M.read_shift(2),!0),J=k(q[0].r,M.read_shift(2),!1),K.push(Pe+G+":"+fe+J)}break;case 3:if(M.l<M.length){console.error("WK1 premature formula end");return}break;case 4:K.push("("+K.pop()+")");break;case 5:K.push(M.read_shift(2));break;case 6:{for(var Xe="";pe=M[M.l++];)Xe+=String.fromCharCode(pe);K.push('"'+Xe.replace(/"/g,'""')+'"')}break;case 8:K.push("-"+K.pop());break;case 23:K.push("+"+K.pop());break;case 22:K.push("NOT("+K.pop()+")");break;case 20:case 21:ge=K.pop(),we=K.pop(),K.push(["AND","OR"][pe-20]+"("+we+","+ge+")");break;default:if(pe<32&&y[pe])ge=K.pop(),we=K.pop(),K.push(we+y[pe]+ge);else if(E[pe]){if(L=E[pe][1],L==69&&(L=M[M.l++]),L>K.length){console.error("WK1 bad formula parse 0x"+pe.toString(16)+":|"+K.join("|")+"|");return}var Ve=K.slice(-L);K.length-=L,K.push(E[pe][0]+"("+Ve.join(",")+")")}else return pe<=7?console.error("WK1 invalid opcode "+pe.toString(16)):pe<=24?console.error("WK1 unsupported op "+pe.toString(16)):pe<=30?console.error("WK1 invalid opcode "+pe.toString(16)):pe<=115?console.error("WK1 unsupported function opcode "+pe.toString(16)):console.error("WK1 unrecognized opcode "+pe.toString(16))}}K.length==1?q[1].f=""+K[0]:console.error("WK1 bad formula parse |"+K.join("|")+"|")}function O(M){var q=[{c:0,r:0},{t:"n",v:0},0];return q[0].r=M.read_shift(2),q[3]=M[M.l++],q[0].c=M[M.l++],q}function D(M,q){var K=O(M);return K[1].t="s",K[1].v=M.read_shift(q-4,"cstr"),K}function v(M,q,K,L){var J=or(6+L.length);J.write_shift(2,M),J.write_shift(1,K),J.write_shift(1,q),J.write_shift(1,39);for(var fe=0;fe<L.length;++fe){var we=L.charCodeAt(fe);J.write_shift(1,we>=128?95:we)}return J.write_shift(1,0),J}function T(M,q){var K=O(M);K[1].v=M.read_shift(2);var L=K[1].v>>1;if(K[1].v&1)switch(L&7){case 0:L=(L>>3)*5e3;break;case 1:L=(L>>3)*500;break;case 2:L=(L>>3)/20;break;case 3:L=(L>>3)/200;break;case 4:L=(L>>3)/2e3;break;case 5:L=(L>>3)/2e4;break;case 6:L=(L>>3)/16;break;case 7:L=(L>>3)/64;break}return K[1].v=L,K}function S(M,q){var K=O(M),L=M.read_shift(4),J=M.read_shift(4),fe=M.read_shift(2);if(fe==65535)return L===0&&J===3221225472?(K[1].t="e",K[1].v=15):L===0&&J===3489660928?(K[1].t="e",K[1].v=42):K[1].v=0,K;var we=fe&32768;return fe=(fe&32767)-16446,K[1].v=(1-we*2)*(J*Math.pow(2,fe+32)+L*Math.pow(2,fe)),K}function N(M,q,K,L){var J=or(14);if(J.write_shift(2,M),J.write_shift(1,K),J.write_shift(1,q),L==0)return J.write_shift(4,0),J.write_shift(4,0),J.write_shift(2,65535),J;var fe=0,we=0,ge=0,pe=0;return L<0&&(fe=1,L=-L),we=Math.log2(L)|0,L/=Math.pow(2,we-31),pe=L>>>0,pe&2147483648||(L/=2,++we,pe=L>>>0),L-=pe,pe|=2147483648,pe>>>=0,L*=Math.pow(2,32),ge=L>>>0,J.write_shift(4,ge),J.write_shift(4,pe),we+=16383+(fe?32768:0),J.write_shift(2,we),J}function C(M,q){var K=S(M);return M.l+=q-14,K}function R(M,q){var K=O(M),L=M.read_shift(4);return K[1].v=L>>6,K}function F(M,q){var K=O(M),L=M.read_shift(8,"f");return K[1].v=L,K}function oe(M,q){var K=F(M);return M.l+=q-10,K}function te(M,q){return M[M.l+q-1]==0?M.read_shift(q,"cstr"):""}function de(M,q){var K=M[M.l++];K>q-1&&(K=q-1);for(var L="";L.length<K;)L+=String.fromCharCode(M[M.l++]);return L}function ae(M,q,K){if(!(!K.qpro||q<21)){var L=M.read_shift(1);M.l+=17,M.l+=1,M.l+=2;var J=M.read_shift(q-21,"cstr");return[L,J]}}function X(M,q){for(var K={},L=M.l+q;M.l<L;){var J=M.read_shift(2);if(J==14e3){for(K[J]=[0,""],K[J][0]=M.read_shift(2);M[M.l];)K[J][1]+=String.fromCharCode(M[M.l]),M.l++;M.l++}}return K}function H(M,q){var K=or(5+M.length);K.write_shift(2,14e3),K.write_shift(2,q);for(var L=0;L<M.length;++L){var J=M.charCodeAt(L);K[K.l++]=J>127?95:J}return K[K.l++]=0,K}var Z={0:{n:"BOF",f:rr},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:o},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:m},14:{n:"NUMBER",f:x},15:{n:"LABEL",f},16:{n:"FORMULA",f:_},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:te},222:{n:"SHEETNAMELP",f:de},65535:{n:""}},Y={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:D},23:{n:"NUMBER17",f:S},24:{n:"NUMBER18",f:T},25:{n:"FORMULA19",f:C},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:X},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:R},38:{n:"??"},39:{n:"NUMBER27",f:F},40:{n:"FORMULA28",f:oe},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:te},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:ae},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:n,book_to_wk3:s,to_workbook:t}}();function uU(e){var t={},r=e.match(Xr),n=0,s=!1;if(r)for(;n!=r.length;++n){var a=je(r[n]);switch(a[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!a.val)break;case"<shadow>":case"<shadow/>":t.shadow=1;break;case"</shadow>":break;case"<charset":if(a.val=="1")break;t.cp=pv[parseInt(a.val,10)];break;case"<outline":if(!a.val)break;case"<outline>":case"<outline/>":t.outline=1;break;case"</outline>":break;case"<rFont":t.name=a.val;break;case"<sz":t.sz=a.val;break;case"<strike":if(!a.val)break;case"<strike>":case"<strike/>":t.strike=1;break;case"</strike>":break;case"<u":if(!a.val)break;switch(a.val){case"double":t.uval="double";break;case"singleAccounting":t.uval="single-accounting";break;case"doubleAccounting":t.uval="double-accounting";break}case"<u>":case"<u/>":t.u=1;break;case"</u>":break;case"<b":if(a.val=="0")break;case"<b>":case"<b/>":t.b=1;break;case"</b>":break;case"<i":if(a.val=="0")break;case"<i>":case"<i/>":t.i=1;break;case"</i>":break;case"<color":a.rgb&&(t.color=a.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":t.family=a.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":t.valign=a.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(a[0].charCodeAt(1)!==47&&!s)throw new Error("Unrecognized rich format "+a[0])}}return t}var fU=function(){var e=Eu("t"),t=Eu("rPr");function r(a){var i=a.match(e);if(!i)return{t:"s",v:""};var o={t:"s",v:lt(i[1])},l=a.match(t);return l&&(o.s=uU(l[1])),o}var n=/<(?:\w+:)?r>/g,s=/<\/(?:\w+:)?r>/;return function(i){return i.replace(n,"").split(s).map(r).filter(function(o){return o.v})}}(),hU=function(){var t=/(\r\n|\n)/g;function r(s,a,i){var o=[];s.u&&o.push("text-decoration: underline;"),s.uval&&o.push("text-underline-style:"+s.uval+";"),s.sz&&o.push("font-size:"+s.sz+"pt;"),s.outline&&o.push("text-effect: outline;"),s.shadow&&o.push("text-shadow: auto;"),a.push('<span style="'+o.join("")+'">'),s.b&&(a.push("<b>"),i.push("</b>")),s.i&&(a.push("<i>"),i.push("</i>")),s.strike&&(a.push("<s>"),i.push("</s>"));var l=s.valign||"";return l=="superscript"||l=="super"?l="sup":l=="subscript"&&(l="sub"),l!=""&&(a.push("<"+l+">"),i.push("</"+l+">")),i.push("</span>"),s}function n(s){var a=[[],s.v,[]];return s.v?(s.s&&r(s.s,a[0],a[2]),a[0].join("")+a[1].replace(t,"<br/>")+a[2].join("")):""}return function(a){return a.map(n).join("")}}(),dU=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,mU=/<(?:\w+:)?r>/,pU=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function Pv(e,t){var r=t?t.cellHTML:!0,n={};return e?(e.match(/^\s*<(?:\w+:)?t[^>]*>/)?(n.t=lt(St(e.slice(e.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),n.r=St(e),r&&(n.h=Ev(n.t))):e.match(mU)&&(n.r=St(e),n.t=lt(St((e.replace(pU,"").match(dU)||[]).join("").replace(Xr,""))),r&&(n.h=hU(fU(n.r)))),n):{t:""}}var gU=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,xU=/<(?:\w+:)?(?:si|sstItem)>/g,vU=/<\/(?:\w+:)?(?:si|sstItem)>/;function yU(e,t){var r=[],n="";if(!e)return r;var s=e.match(gU);if(s){n=s[2].replace(xU,"").split(vU);for(var a=0;a!=n.length;++a){var i=Pv(n[a].trim(),t);i!=null&&(r[r.length]=i)}s=je(s[1]),r.Count=s.count,r.Unique=s.uniqueCount}return r}function _U(e){return[e.read_shift(4),e.read_shift(4)]}function wU(e,t){var r=[],n=!1;return Ia(e,function(a,i,o){switch(o){case 159:r.Count=a[0],r.Unique=a[1];break;case 19:r.push(a);break;case 160:return!0;case 35:n=!0;break;case 36:n=!1;break;default:if(i.T,!n||t.WTF)throw new Error("Unexpected record 0x"+o.toString(16))}}),r}function Kb(e){for(var t=[],r=e.split(""),n=0;n<r.length;++n)t[n]=r[n].charCodeAt(0);return t}function da(e,t){var r={};return r.Major=e.read_shift(2),r.Minor=e.read_shift(2),t>=4&&(e.l+=t-4),r}function EU(e){var t={};return t.id=e.read_shift(0,"lpp4"),t.R=da(e,4),t.U=da(e,4),t.W=da(e,4),t}function TU(e){for(var t=e.read_shift(4),r=e.l+t-4,n={},s=e.read_shift(4),a=[];s-- >0;)a.push({t:e.read_shift(4),v:e.read_shift(0,"lpp4")});if(n.name=e.read_shift(0,"lpp4"),n.comps=a,e.l!=r)throw new Error("Bad DataSpaceMapEntry: "+e.l+" != "+r);return n}function kU(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(TU(e));return t}function SU(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(e.read_shift(0,"lpp4"));return t}function AU(e){var t={};return e.read_shift(4),e.l+=4,t.id=e.read_shift(0,"lpp4"),t.name=e.read_shift(0,"lpp4"),t.R=da(e,4),t.U=da(e,4),t.W=da(e,4),t}function bU(e){var t=AU(e);if(t.ename=e.read_shift(0,"8lpp4"),t.blksz=e.read_shift(4),t.cmode=e.read_shift(4),e.read_shift(4)!=4)throw new Error("Bad !Primary record");return t}function qb(e,t){var r=e.l+t,n={};n.Flags=e.read_shift(4)&63,e.l+=4,n.AlgID=e.read_shift(4);var s=!1;switch(n.AlgID){case 26126:case 26127:case 26128:s=n.Flags==36;break;case 26625:s=n.Flags==4;break;case 0:s=n.Flags==16||n.Flags==4||n.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+n.AlgID}if(!s)throw new Error("Encryption Flags/AlgID mismatch");return n.AlgIDHash=e.read_shift(4),n.KeySize=e.read_shift(4),n.ProviderType=e.read_shift(4),e.l+=8,n.CSPName=e.read_shift(r-e.l>>1,"utf16le"),e.l=r,n}function Xb(e,t){var r={},n=e.l+t;return e.l+=4,r.Salt=e.slice(e.l,e.l+16),e.l+=16,r.Verifier=e.slice(e.l,e.l+16),e.l+=16,e.read_shift(4),r.VerifierHash=e.slice(e.l,n),e.l=n,r}function IU(e){var t=da(e);switch(t.Minor){case 2:return[t.Minor,NU(e)];case 3:return[t.Minor,CU()];case 4:return[t.Minor,RU(e)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+t.Minor)}function NU(e){var t=e.read_shift(4);if((t&63)!=36)throw new Error("EncryptionInfo mismatch");var r=e.read_shift(4),n=qb(e,r),s=Xb(e,e.length-e.l);return{t:"Std",h:n,v:s}}function CU(){throw new Error("File is password-protected: ECMA-376 Extensible")}function RU(e){var t=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];e.l+=4;var r=e.read_shift(e.length-e.l,"utf8"),n={};return r.replace(Xr,function(a){var i=je(a);switch(zs(i[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":t.forEach(function(o){n[o]=i[o]});break;case"<dataIntegrity":n.encryptedHmacKey=i.encryptedHmacKey,n.encryptedHmacValue=i.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":n.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":n.uri=i.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":n.encs.push(i);break;default:throw i[0]}}),n}function PU(e,t){var r={},n=r.EncryptionVersionInfo=da(e,4);if(t-=4,n.Minor!=2)throw new Error("unrecognized minor version code: "+n.Minor);if(n.Major>4||n.Major<2)throw new Error("unrecognized major version code: "+n.Major);r.Flags=e.read_shift(4),t-=4;var s=e.read_shift(4);return t-=4,r.EncryptionHeader=qb(e,s),t-=s,r.EncryptionVerifier=Xb(e,t),r}function DU(e){var t={},r=t.EncryptionVersionInfo=da(e,4);if(r.Major!=1||r.Minor!=1)throw"unrecognized version code "+r.Major+" : "+r.Minor;return t.Salt=e.read_shift(16),t.EncryptedVerifier=e.read_shift(16),t.EncryptedVerifierHash=e.read_shift(16),t}function FU(e){var t=0,r,n=Kb(e),s=n.length+1,a,i,o,l,u;for(r=xi(s),r[0]=n.length,a=1;a!=s;++a)r[a]=n[a-1];for(a=s-1;a>=0;--a)i=r[a],o=t&16384?1:0,l=t<<1&32767,u=o|l,t=u^i;return t^52811}var Yb=function(){var e=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],t=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],r=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],n=function(i){return(i/2|i*128)&255},s=function(i,o){return n(i^o)},a=function(i){for(var o=t[i.length-1],l=104,u=i.length-1;u>=0;--u)for(var f=i[u],d=0;d!=7;++d)f&64&&(o^=r[l]),f*=2,--l;return o};return function(i){for(var o=Kb(i),l=a(o),u=o.length,f=xi(16),d=0;d!=16;++d)f[d]=0;var m,p,x;for((u&1)===1&&(m=l>>8,f[u]=s(e[0],m),--u,m=l&255,p=o[o.length-1],f[u]=s(p,m));u>0;)--u,m=l>>8,f[u]=s(o[u],m),--u,m=l&255,f[u]=s(o[u],m);for(u=15,x=15-o.length;x>0;)m=l>>8,f[u]=s(e[x],m),--u,--x,m=l&255,f[u]=s(o[u],m),--u,--x;return f}}(),OU=function(e,t,r,n,s){s||(s=t),n||(n=Yb(e));var a,i;for(a=0;a!=t.length;++a)i=t[a],i^=n[r],i=(i>>5|i<<3)&255,s[a]=i,++r;return[s,r,n]},MU=function(e){var t=0,r=Yb(e);return function(n){var s=OU("",n,t,r);return t=s[1],s[0]}};function jU(e,t,r,n){var s={key:rr(e),verificationBytes:rr(e)};return r.password&&(s.verifier=FU(r.password)),n.valid=s.verificationBytes===s.verifier,n.valid&&(n.insitu=MU(r.password)),s}function LU(e,t,r){var n=r||{};return n.Info=e.read_shift(2),e.l-=2,n.Info===1?n.Data=DU(e):n.Data=PU(e,t),n}function UU(e,t,r){var n={Type:r.biff>=8?e.read_shift(2):0};return n.Type?LU(e,t-2,n):jU(e,r.biff>=8?t:t-2,r,n),n}var VU=function(){function e(s,a){switch(a.type){case"base64":return t(Mn(s),a);case"binary":return t(s,a);case"buffer":return t(tt&&Buffer.isBuffer(s)?s.toString("binary"):go(s),a);case"array":return t(io(s),a)}throw new Error("Unrecognized type "+a.type)}function t(s,a){var i=a||{},o=i.dense?[]:{},l=s.match(/\\trowd.*?\\row\b/g);if(!l.length)throw new Error("RTF missing table");var u={s:{c:0,r:0},e:{c:0,r:l.length-1}};return l.forEach(function(f,d){Array.isArray(o)&&(o[d]=[]);for(var m=/\\\w+\b/g,p=0,x,g=-1;x=m.exec(f);){switch(x[0]){case"\\cell":var _=f.slice(p,m.lastIndex-x[0].length);if(_[0]==" "&&(_=_.slice(1)),++g,_.length){var k={v:_,t:"s"};Array.isArray(o)?o[d][g]=k:o[We({r:d,c:g})]=k}break}p=m.lastIndex}g>u.e.c&&(u.e.c=g)}),o["!ref"]=at(u),o}function r(s,a){return ki(e(s,a),a)}function n(s){for(var a=["{\\rtf1\\ansi"],i=Gt(s["!ref"]),o,l=Array.isArray(s),u=i.s.r;u<=i.e.r;++u){a.push("\\trowd\\trautofit1");for(var f=i.s.c;f<=i.e.c;++f)a.push("\\cellx"+(f+1));for(a.push("\\pard\\intbl"),f=i.s.c;f<=i.e.c;++f){var d=We({r:u,c:f});o=l?(s[u]||[])[f]:s[d],!(!o||o.v==null&&(!o.f||o.F))&&(a.push(" "+(o.w||(Sa(o),o.w))),a.push("\\cell"))}a.push("\\pard\\intbl\\row")}return a.join("")+"}"}return{to_workbook:r,to_sheet:e,from_sheet:n}}();function BU(e){var t=e.slice(e[0]==="#"?1:0).slice(0,6);return[parseInt(t.slice(0,2),16),parseInt(t.slice(2,4),16),parseInt(t.slice(4,6),16)]}function Su(e){for(var t=0,r=1;t!=3;++t)r=r*256+(e[t]>255?255:e[t]<0?0:e[t]);return r.toString(16).toUpperCase().slice(1)}function $U(e){var t=e[0]/255,r=e[1]/255,n=e[2]/255,s=Math.max(t,r,n),a=Math.min(t,r,n),i=s-a;if(i===0)return[0,0,t];var o=0,l=0,u=s+a;switch(l=i/(u>1?2-u:u),s){case t:o=((r-n)/i+6)%6;break;case r:o=(n-t)/i+2;break;case n:o=(t-r)/i+4;break}return[o/6,l,u/2]}function WU(e){var t=e[0],r=e[1],n=e[2],s=r*2*(n<.5?n:1-n),a=n-s/2,i=[a,a,a],o=6*t,l;if(r!==0)switch(o|0){case 0:case 6:l=s*o,i[0]+=s,i[1]+=l;break;case 1:l=s*(2-o),i[0]+=l,i[1]+=s;break;case 2:l=s*(o-2),i[1]+=s,i[2]+=l;break;case 3:l=s*(4-o),i[1]+=l,i[2]+=s;break;case 4:l=s*(o-4),i[2]+=s,i[0]+=l;break;case 5:l=s*(6-o),i[2]+=l,i[0]+=s;break}for(var u=0;u!=3;++u)i[u]=Math.round(i[u]*255);return i}function Ed(e,t){if(t===0)return e;var r=$U(BU(e));return t<0?r[2]=r[2]*(1+t):r[2]=1-(1-r[2])*(1-t),Su(WU(r))}var Qb=6,zU=15,HU=1,Zr=Qb;function Td(e){return Math.floor((e+Math.round(128/Zr)/256)*Zr)}function kd(e){return Math.floor((e-5)/Zr*100+.5)/100}function ng(e){return Math.round((e*Zr+5)/Zr*256)/256}function _m(e){return ng(kd(Td(e)))}function Dv(e){var t=Math.abs(e-_m(e)),r=Zr;if(t>.005)for(Zr=HU;Zr<zU;++Zr)Math.abs(e-_m(e))<=t&&(t=Math.abs(e-_m(e)),r=Zr);Zr=r}function Al(e){e.width?(e.wpx=Td(e.width),e.wch=kd(e.wpx),e.MDW=Zr):e.wpx?(e.wch=kd(e.wpx),e.width=ng(e.wch),e.MDW=Zr):typeof e.wch=="number"&&(e.width=ng(e.wch),e.wpx=Td(e.width),e.MDW=Zr),e.customWidth&&delete e.customWidth}var GU=96,Jb=GU;function Zb(e){return e*96/Jb}function Au(e){return e*Jb/96}var KU={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function qU(e,t,r,n){t.Borders=[];var s={},a=!1;(e[0].match(Xr)||[]).forEach(function(i){var o=je(i);switch(zs(o[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":s={},o.diagonalUp&&(s.diagonalUp=Ft(o.diagonalUp)),o.diagonalDown&&(s.diagonalDown=Ft(o.diagonalDown)),t.Borders.push(s);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(n&&n.WTF&&!a)throw new Error("unrecognized "+o[0]+" in borders")}})}function XU(e,t,r,n){t.Fills=[];var s={},a=!1;(e[0].match(Xr)||[]).forEach(function(i){var o=je(i);switch(zs(o[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":s={},t.Fills.push(s);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":t.Fills.push(s),s={};break;case"<patternFill":case"<patternFill>":o.patternType&&(s.patternType=o.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":s.bgColor||(s.bgColor={}),o.indexed&&(s.bgColor.indexed=parseInt(o.indexed,10)),o.theme&&(s.bgColor.theme=parseInt(o.theme,10)),o.tint&&(s.bgColor.tint=parseFloat(o.tint)),o.rgb&&(s.bgColor.rgb=o.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":s.fgColor||(s.fgColor={}),o.theme&&(s.fgColor.theme=parseInt(o.theme,10)),o.tint&&(s.fgColor.tint=parseFloat(o.tint)),o.rgb!=null&&(s.fgColor.rgb=o.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(n&&n.WTF&&!a)throw new Error("unrecognized "+o[0]+" in fills")}})}function YU(e,t,r,n){t.Fonts=[];var s={},a=!1;(e[0].match(Xr)||[]).forEach(function(i){var o=je(i);switch(zs(o[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":t.Fonts.push(s),s={};break;case"<name":o.val&&(s.name=St(o.val));break;case"<name/>":case"</name>":break;case"<b":s.bold=o.val?Ft(o.val):1;break;case"<b/>":s.bold=1;break;case"<i":s.italic=o.val?Ft(o.val):1;break;case"<i/>":s.italic=1;break;case"<u":switch(o.val){case"none":s.underline=0;break;case"single":s.underline=1;break;case"double":s.underline=2;break;case"singleAccounting":s.underline=33;break;case"doubleAccounting":s.underline=34;break}break;case"<u/>":s.underline=1;break;case"<strike":s.strike=o.val?Ft(o.val):1;break;case"<strike/>":s.strike=1;break;case"<outline":s.outline=o.val?Ft(o.val):1;break;case"<outline/>":s.outline=1;break;case"<shadow":s.shadow=o.val?Ft(o.val):1;break;case"<shadow/>":s.shadow=1;break;case"<condense":s.condense=o.val?Ft(o.val):1;break;case"<condense/>":s.condense=1;break;case"<extend":s.extend=o.val?Ft(o.val):1;break;case"<extend/>":s.extend=1;break;case"<sz":o.val&&(s.sz=+o.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":o.val&&(s.vertAlign=o.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":o.val&&(s.family=parseInt(o.val,10));break;case"<family/>":case"</family>":break;case"<scheme":o.val&&(s.scheme=o.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(o.val=="1")break;o.codepage=pv[parseInt(o.val,10)];break;case"<color":if(s.color||(s.color={}),o.auto&&(s.color.auto=Ft(o.auto)),o.rgb)s.color.rgb=o.rgb.slice(-6);else if(o.indexed){s.color.index=parseInt(o.indexed,10);var l=Ki[s.color.index];s.color.index==81&&(l=Ki[1]),l||(l=Ki[1]),s.color.rgb=l[0].toString(16)+l[1].toString(16)+l[2].toString(16)}else o.theme&&(s.color.theme=parseInt(o.theme,10),o.tint&&(s.color.tint=parseFloat(o.tint)),o.theme&&r.themeElements&&r.themeElements.clrScheme&&(s.color.rgb=Ed(r.themeElements.clrScheme[s.color.theme].rgb,s.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":a=!0;break;case"</AlternateContent>":a=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(n&&n.WTF&&!a)throw new Error("unrecognized "+o[0]+" in fonts")}})}function QU(e,t,r){t.NumberFmt=[];for(var n=$s(He),s=0;s<n.length;++s)t.NumberFmt[n[s]]=He[n[s]];var a=e[0].match(Xr);if(a)for(s=0;s<a.length;++s){var i=je(a[s]);switch(zs(i[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var o=lt(St(i.formatCode)),l=parseInt(i.numFmtId,10);if(t.NumberFmt[l]=o,l>0){if(l>392){for(l=392;l>60&&t.NumberFmt[l]!=null;--l);t.NumberFmt[l]=o}Gi(o,l)}}break;case"</numFmt>":break;default:if(r.WTF)throw new Error("unrecognized "+i[0]+" in numFmts")}}}var Yf=["numFmtId","fillId","fontId","borderId","xfId"],Qf=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function JU(e,t,r){t.CellXf=[];var n,s=!1;(e[0].match(Xr)||[]).forEach(function(a){var i=je(a),o=0;switch(zs(i[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(n=i,delete n[0],o=0;o<Yf.length;++o)n[Yf[o]]&&(n[Yf[o]]=parseInt(n[Yf[o]],10));for(o=0;o<Qf.length;++o)n[Qf[o]]&&(n[Qf[o]]=Ft(n[Qf[o]]));if(t.NumberFmt&&n.numFmtId>392){for(o=392;o>60;--o)if(t.NumberFmt[n.numFmtId]==t.NumberFmt[o]){n.numFmtId=o;break}}t.CellXf.push(n);break;case"</xf>":break;case"<alignment":case"<alignment/>":var l={};i.vertical&&(l.vertical=i.vertical),i.horizontal&&(l.horizontal=i.horizontal),i.textRotation!=null&&(l.textRotation=i.textRotation),i.indent&&(l.indent=i.indent),i.wrapText&&(l.wrapText=Ft(i.wrapText)),n.alignment=l;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":s=!0;break;case"</AlternateContent>":s=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(r&&r.WTF&&!s)throw new Error("unrecognized "+i[0]+" in cellXfs")}})}var ZU=function(){var t=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,r=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,n=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,s=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,a=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(o,l,u){var f={};if(!o)return f;o=o.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var d;return(d=o.match(t))&&QU(d,f,u),(d=o.match(s))&&YU(d,f,l,u),(d=o.match(n))&&XU(d,f,l,u),(d=o.match(a))&&qU(d,f,l,u),(d=o.match(r))&&JU(d,f,u),f}}();function eV(e,t){var r=e.read_shift(2),n=Hr(e);return[r,n]}function tV(e,t,r){var n={};n.sz=e.read_shift(2)/20;var s=f5(e);s.fItalic&&(n.italic=1),s.fCondense&&(n.condense=1),s.fExtend&&(n.extend=1),s.fShadow&&(n.shadow=1),s.fOutline&&(n.outline=1),s.fStrikeout&&(n.strike=1);var a=e.read_shift(2);switch(a===700&&(n.bold=1),e.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var i=e.read_shift(1);i!=0&&(n.underline=i);var o=e.read_shift(1);o>0&&(n.family=o);var l=e.read_shift(1);switch(l>0&&(n.charset=l),e.l++,n.color=u5(e),e.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=Hr(e),n}var rV=qr;function nV(e,t){var r=e.l+t,n=e.read_shift(2),s=e.read_shift(2);return e.l=r,{ixfe:n,numFmtId:s}}var sV=qr;function aV(e,t,r){var n={};n.NumberFmt=[];for(var s in He)n.NumberFmt[s]=He[s];n.CellXf=[],n.Fonts=[];var a=[],i=!1;return Ia(e,function(l,u,f){switch(f){case 44:n.NumberFmt[l[0]]=l[1],Gi(l[1],l[0]);break;case 43:n.Fonts.push(l),l.color.theme!=null&&t&&t.themeElements&&t.themeElements.clrScheme&&(l.color.rgb=Ed(t.themeElements.clrScheme[l.color.theme].rgb,l.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:a[a.length-1]==617&&n.CellXf.push(l);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:i=!0;break;case 36:i=!1;break;case 37:a.push(f),i=!0;break;case 38:a.pop(),i=!1;break;default:if(u.T>0)a.push(f);else if(u.T<0)a.pop();else if(!i||r.WTF&&a[a.length-1]!=37)throw new Error("Unexpected record 0x"+f.toString(16))}}),n}var iV=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function oV(e,t,r){t.themeElements.clrScheme=[];var n={};(e[0].match(Xr)||[]).forEach(function(s){var a=je(s);switch(a[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":n.rgb=a.val;break;case"<a:sysClr":n.rgb=a.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":a[0].charAt(1)==="/"?(t.themeElements.clrScheme[iV.indexOf(a[0])]=n,n={}):n.name=a[0].slice(3,a[0].length-1);break;default:if(r&&r.WTF)throw new Error("Unrecognized "+a[0]+" in clrScheme")}})}function lV(){}function cV(){}var uV=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,fV=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,hV=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function dV(e,t,r){t.themeElements={};var n;[["clrScheme",uV,oV],["fontScheme",fV,lV],["fmtScheme",hV,cV]].forEach(function(s){if(!(n=e.match(s[1])))throw new Error(s[0]+" not found in themeElements");s[2](n,t,r)})}var mV=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function eI(e,t){(!e||e.length===0)&&(e=pV());var r,n={};if(!(r=e.match(mV)))throw new Error("themeElements not found in theme");return dV(r[0],n,t),n.raw=e,n}function pV(e,t){var r=[fb];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function gV(e,t,r){var n=e.l+t,s=e.read_shift(4);if(s!==124226){if(!r.cellStyles){e.l=n;return}var a=e.slice(e.l);e.l=n;var i;try{i=ub(a,{type:"array"})}catch{return}var o=In(i,"theme/theme/theme1.xml",!0);if(o)return eI(o,r)}}function xV(e){return e.read_shift(4)}function vV(e){var t={};switch(t.xclrType=e.read_shift(2),t.nTintShade=e.read_shift(2),t.xclrType){case 0:e.l+=4;break;case 1:t.xclrValue=yV(e,4);break;case 2:t.xclrValue=Vb(e);break;case 3:t.xclrValue=xV(e);break;case 4:e.l+=4;break}return e.l+=8,t}function yV(e,t){return qr(e,t)}function _V(e,t){return qr(e,t)}function wV(e){var t=e.read_shift(2),r=e.read_shift(2)-4,n=[t];switch(t){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:n[1]=vV(e);break;case 6:n[1]=_V(e,r);break;case 14:case 15:n[1]=e.read_shift(r===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+t+" "+r)}return n}function EV(e,t){var r=e.l+t;e.l+=2;var n=e.read_shift(2);e.l+=2;for(var s=e.read_shift(2),a=[];s-- >0;)a.push(wV(e,r-e.l));return{ixfe:n,ext:a}}function TV(e,t){t.forEach(function(r){switch(r[0]){}})}function kV(e,t){return{flags:e.read_shift(4),version:e.read_shift(4),name:Hr(e)}}function SV(e){for(var t=[],r=e.read_shift(4);r-- >0;)t.push([e.read_shift(4),e.read_shift(4)]);return t}function AV(e){return e.l+=4,e.read_shift(4)!=0}function bV(e,t,r){var n={Types:[],Cell:[],Value:[]},s=r||{},a=[],i=!1,o=2;return Ia(e,function(l,u,f){switch(f){case 335:n.Types.push({name:l.name});break;case 51:l.forEach(function(d){o==1?n.Cell.push({type:n.Types[d[0]-1].name,index:d[1]}):o==0&&n.Value.push({type:n.Types[d[0]-1].name,index:d[1]})});break;case 337:o=l?1:0;break;case 338:o=2;break;case 35:a.push(f),i=!0;break;case 36:a.pop(),i=!1;break;default:if(!u.T){if(!i||s.WTF&&a[a.length-1]!=35)throw new Error("Unexpected record 0x"+f.toString(16))}}}),n}function IV(e,t,r){var n={Types:[],Cell:[],Value:[]};if(!e)return n;var s=!1,a=2,i;return e.replace(Xr,function(o){var l=je(o);switch(zs(l[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":n.Types.push({name:l.name});break;case"</metadataType>":break;case"<futureMetadata":for(var u=0;u<n.Types.length;++u)n.Types[u].name==l.name&&(i=n.Types[u]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":a==1?n.Cell.push({type:n.Types[l.t-1].name,index:+l.v}):a==0&&n.Value.push({type:n.Types[l.t-1].name,index:+l.v});break;case"</rc>":break;case"<cellMetadata":a=1;break;case"</cellMetadata>":a=2;break;case"<valueMetadata":a=0;break;case"</valueMetadata>":a=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;case"<rvb":if(!i)break;i.offsets||(i.offsets=[]),i.offsets.push(+l.i);break;default:if(!s&&r.WTF)throw new Error("unrecognized "+l[0]+" in metadata")}return o}),n}function NV(e){var t=[];if(!e)return t;var r=1;return(e.match(Xr)||[]).forEach(function(n){var s=je(n);switch(s[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete s[0],s.i?r=s.i:s.i=r,t.push(s);break}}),t}function CV(e){var t={};t.i=e.read_shift(4);var r={};r.r=e.read_shift(4),r.c=e.read_shift(4),t.r=We(r);var n=e.read_shift(1);return n&2&&(t.l="1"),n&8&&(t.a="1"),t}function RV(e,t,r){var n=[];return Ia(e,function(a,i,o){switch(o){case 63:n.push(a);break;default:if(!i.T)throw new Error("Unexpected record 0x"+o.toString(16))}}),n}function PV(e,t,r,n){if(!e)return e;var s=n||{},a=!1;Ia(e,function(o,l,u){switch(u){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:a=!0;break;case 36:a=!1;break;default:if(!l.T){if(!a||s.WTF)throw new Error("Unexpected record 0x"+u.toString(16))}}},s)}function DV(e,t){if(!e)return"??";var r=(e.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return t["!id"][r].Target}function sE(e,t,r,n){var s=Array.isArray(e),a;t.forEach(function(i){var o=en(i.ref);if(s?(e[o.r]||(e[o.r]=[]),a=e[o.r][o.c]):a=e[i.ref],!a){a={t:"z"},s?e[o.r][o.c]=a:e[i.ref]=a;var l=Gt(e["!ref"]||"BDWGO1000001:A1");l.s.r>o.r&&(l.s.r=o.r),l.e.r<o.r&&(l.e.r=o.r),l.s.c>o.c&&(l.s.c=o.c),l.e.c<o.c&&(l.e.c=o.c);var u=at(l);u!==e["!ref"]&&(e["!ref"]=u)}a.c||(a.c=[]);var f={a:i.author,t:i.t,r:i.r,T:r};i.h&&(f.h=i.h);for(var d=a.c.length-1;d>=0;--d){if(!r&&a.c[d].T)return;r&&!a.c[d].T&&a.c.splice(d,1)}if(r&&n){for(d=0;d<n.length;++d)if(f.a==n[d].id){f.a=n[d].name||f.a;break}}a.c.push(f)})}function FV(e,t){if(e.match(/<(?:\w+:)?comments *\/>/))return[];var r=[],n=[],s=e.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);s&&s[1]&&s[1].split(/<\/\w*:?author>/).forEach(function(i){if(!(i===""||i.trim()==="")){var o=i.match(/<(?:\w+:)?author[^>]*>(.*)/);o&&r.push(o[1])}});var a=e.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return a&&a[1]&&a[1].split(/<\/\w*:?comment>/).forEach(function(i){if(!(i===""||i.trim()==="")){var o=i.match(/<(?:\w+:)?comment[^>]*>/);if(o){var l=je(o[0]),u={author:l.authorId&&r[l.authorId]||"sheetjsghost",ref:l.ref,guid:l.guid},f=en(l.ref);if(!(t.sheetRows&&t.sheetRows<=f.r)){var d=i.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),m=!!d&&!!d[1]&&Pv(d[1])||{r:"",t:"",h:""};u.r=m.r,m.r=="<t></t>"&&(m.t=m.h=""),u.t=(m.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),t.cellHTML&&(u.h=m.h),n.push(u)}}}}),n}function OV(e,t){var r=[],n=!1,s={},a=0;return e.replace(Xr,function(o,l){var u=je(o);switch(zs(u[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":s={author:u.personId,guid:u.id,ref:u.ref,T:1};break;case"</threadedComment>":s.t!=null&&r.push(s);break;case"<text>":case"<text":a=l+o.length;break;case"</text>":s.t=e.slice(a,l).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":n=!0;break;case"</mentions>":n=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&t.WTF)throw new Error("unrecognized "+u[0]+" in threaded comments")}return o}),r}function MV(e,t){var r=[],n=!1;return e.replace(Xr,function(a){var i=je(a);switch(zs(i[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":r.push({name:i.displayname,id:i.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&t.WTF)throw new Error("unrecognized "+i[0]+" in threaded comments")}return a}),r}function jV(e){var t={};t.iauthor=e.read_shift(4);var r=vo(e);return t.rfx=r.s,t.ref=We(r.s),e.l+=16,t}var LV=Hr;function UV(e,t){var r=[],n=[],s={},a=!1;return Ia(e,function(o,l,u){switch(u){case 632:n.push(o);break;case 635:s=o;break;case 637:s.t=o.t,s.h=o.h,s.r=o.r;break;case 636:if(s.author=n[s.iauthor],delete s.iauthor,t.sheetRows&&s.rfx&&t.sheetRows<=s.rfx.r)break;s.t||(s.t=""),delete s.rfx,r.push(s);break;case 3072:break;case 35:a=!0;break;case 36:a=!1;break;case 37:break;case 38:break;default:if(!l.T){if(!a||t.WTF)throw new Error("Unexpected record 0x"+u.toString(16))}}}),r}var VV="application/vnd.ms-office.vbaProject";function BV(e){var t=st.utils.cfb_new({root:"R"});return e.FullPaths.forEach(function(r,n){if(!(r.slice(-1)==="/"||!r.match(/_VBA_PROJECT_CUR/))){var s=r.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");st.utils.cfb_add(t,s,e.FileIndex[n].content)}}),st.write(t)}function $V(){return{"!type":"dialog"}}function WV(){return{"!type":"dialog"}}function zV(){return{"!type":"macro"}}function HV(){return{"!type":"macro"}}var il=function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,t={r:0,c:0};function r(n,s,a,i){var o=!1,l=!1;a.length==0?l=!0:a.charAt(0)=="["&&(l=!0,a=a.slice(1,-1)),i.length==0?o=!0:i.charAt(0)=="["&&(o=!0,i=i.slice(1,-1));var u=a.length>0?parseInt(a,10)|0:0,f=i.length>0?parseInt(i,10)|0:0;return o?f+=t.c:--f,l?u+=t.r:--u,s+(o?"":"$")+ur(f)+(l?"":"$")+Nr(u)}return function(s,a){return t=a,s.replace(e,r)}}(),tI=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,GV=function(){return function(t,r){return t.replace(tI,function(n,s,a,i,o,l){var u=Av(i)-(a?0:r.c),f=Sv(l)-(o?0:r.r),d=f==0?"":o?f+1:"["+f+"]",m=u==0?"":a?u+1:"["+u+"]";return s+"R"+d+"C"+m})}}();function rI(e,t){return e.replace(tI,function(r,n,s,a,i,o){return n+(s=="$"?s+a:ur(Av(a)+t.c))+(i=="$"?i+o:Nr(Sv(o)+t.r))})}function KV(e,t,r){var n=jl(t),s=n.s,a=en(r),i={r:a.r-s.r,c:a.c-s.c};return rI(e,i)}function qV(e){return e.length!=1}function aE(e){return e.replace(/_xlfn\./g,"")}function Zt(e){e.l+=1}function vi(e,t){var r=e.read_shift(2);return[r&16383,r>>14&1,r>>15&1]}function nI(e,t,r){var n=2;if(r){if(r.biff>=2&&r.biff<=5)return sI(e);r.biff==12&&(n=4)}var s=e.read_shift(n),a=e.read_shift(n),i=vi(e),o=vi(e);return{s:{r:s,c:i[0],cRel:i[1],rRel:i[2]},e:{r:a,c:o[0],cRel:o[1],rRel:o[2]}}}function sI(e){var t=vi(e),r=vi(e),n=e.read_shift(1),s=e.read_shift(1);return{s:{r:t[0],c:n,cRel:t[1],rRel:t[2]},e:{r:r[0],c:s,cRel:r[1],rRel:r[2]}}}function XV(e,t,r){if(r.biff<8)return sI(e);var n=e.read_shift(r.biff==12?4:2),s=e.read_shift(r.biff==12?4:2),a=vi(e),i=vi(e);return{s:{r:n,c:a[0],cRel:a[1],rRel:a[2]},e:{r:s,c:i[0],cRel:i[1],rRel:i[2]}}}function aI(e,t,r){if(r&&r.biff>=2&&r.biff<=5)return YV(e);var n=e.read_shift(r&&r.biff==12?4:2),s=vi(e);return{r:n,c:s[0],cRel:s[1],rRel:s[2]}}function YV(e){var t=vi(e),r=e.read_shift(1);return{r:t[0],c:r,cRel:t[1],rRel:t[2]}}function QV(e){var t=e.read_shift(2),r=e.read_shift(2);return{r:t,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function JV(e,t,r){var n=r&&r.biff?r.biff:8;if(n>=2&&n<=5)return ZV(e);var s=e.read_shift(n>=12?4:2),a=e.read_shift(2),i=(a&16384)>>14,o=(a&32768)>>15;if(a&=16383,o==1)for(;s>524287;)s-=1048576;if(i==1)for(;a>8191;)a=a-16384;return{r:s,c:a,cRel:i,rRel:o}}function ZV(e){var t=e.read_shift(2),r=e.read_shift(1),n=(t&32768)>>15,s=(t&16384)>>14;return t&=16383,n==1&&t>=8192&&(t=t-16384),s==1&&r>=128&&(r=r-256),{r:t,c:r,cRel:s,rRel:n}}function eB(e,t,r){var n=(e[e.l++]&96)>>5,s=nI(e,r.biff>=2&&r.biff<=5?6:8,r);return[n,s]}function tB(e,t,r){var n=(e[e.l++]&96)>>5,s=e.read_shift(2,"i"),a=8;if(r)switch(r.biff){case 5:e.l+=12,a=6;break;case 12:a=12;break}var i=nI(e,a,r);return[n,s,i]}function rB(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r&&r.biff>8?12:r.biff<8?6:8,[n]}function nB(e,t,r){var n=(e[e.l++]&96)>>5,s=e.read_shift(2),a=8;if(r)switch(r.biff){case 5:e.l+=12,a=6;break;case 12:a=12;break}return e.l+=a,[n,s]}function sB(e,t,r){var n=(e[e.l++]&96)>>5,s=XV(e,t-1,r);return[n,s]}function aB(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r.biff==2?6:r.biff==12?14:7,[n]}function iE(e){var t=e[e.l+1]&1,r=1;return e.l+=4,[t,r]}function iB(e,t,r){e.l+=2;for(var n=e.read_shift(r&&r.biff==2?1:2),s=[],a=0;a<=n;++a)s.push(e.read_shift(r&&r.biff==2?1:2));return s}function oB(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function lB(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function cB(e){var t=e[e.l+1]&255?1:0;return e.l+=2,[t,e.read_shift(2)]}function uB(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=r&&r.biff==2?3:4,[n]}function iI(e){var t=e.read_shift(1),r=e.read_shift(1);return[t,r]}function fB(e){return e.read_shift(2),iI(e)}function hB(e){return e.read_shift(2),iI(e)}function dB(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var s=aI(e,0,r);return[n,s]}function mB(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var s=JV(e,0,r);return[n,s]}function pB(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var s=e.read_shift(2);r&&r.biff==5&&(e.l+=12);var a=aI(e,0,r);return[n,s,a]}function gB(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var s=e.read_shift(r&&r.biff<=3?1:2);return[x7[s],cI[s],n]}function xB(e,t,r){var n=e[e.l++],s=e.read_shift(1),a=r&&r.biff<=3?[n==88?-1:0,e.read_shift(1)]:vB(e);return[s,(a[0]===0?cI:g7)[a[1]]]}function vB(e){return[e[e.l+1]>>7,e.read_shift(2)&32767]}function yB(e,t,r){e.l+=r&&r.biff==2?3:4}function _B(e,t,r){if(e.l++,r&&r.biff==12)return[e.read_shift(4,"i"),0];var n=e.read_shift(2),s=e.read_shift(r&&r.biff==2?1:2);return[n,s]}function wB(e){return e.l++,yo[e.read_shift(1)]}function EB(e){return e.l++,e.read_shift(2)}function TB(e){return e.l++,e.read_shift(1)!==0}function kB(e){return e.l++,$r(e)}function SB(e,t,r){return e.l++,tf(e,t-1,r)}function AB(e,t){var r=[e.read_shift(1)];if(t==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=qt(e,1)?"TRUE":"FALSE",t!=12&&(e.l+=7);break;case 37:case 16:r[1]=yo[e[e.l]],e.l+=t==12?4:8;break;case 0:e.l+=8;break;case 1:r[1]=$r(e);break;case 2:r[1]=_o(e,0,{biff:t>0&&t<8?2:t});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function bB(e,t,r){for(var n=e.read_shift(r.biff==12?4:2),s=[],a=0;a!=n;++a)s.push((r.biff==12?vo:y0)(e));return s}function IB(e,t,r){var n=0,s=0;r.biff==12?(n=e.read_shift(4),s=e.read_shift(4)):(s=1+e.read_shift(1),n=1+e.read_shift(2)),r.biff>=2&&r.biff<8&&(--n,--s==0&&(s=256));for(var a=0,i=[];a!=n&&(i[a]=[]);++a)for(var o=0;o!=s;++o)i[a][o]=AB(e,r.biff);return i}function NB(e,t,r){var n=e.read_shift(1)>>>5&3,s=!r||r.biff>=8?4:2,a=e.read_shift(s);switch(r.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[n,0,a]}function CB(e,t,r){if(r.biff==5)return RB(e);var n=e.read_shift(1)>>>5&3,s=e.read_shift(2),a=e.read_shift(4);return[n,s,a]}function RB(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2,"i");e.l+=8;var n=e.read_shift(2);return e.l+=12,[t,r,n]}function PB(e,t,r){var n=e.read_shift(1)>>>5&3;e.l+=r&&r.biff==2?3:4;var s=e.read_shift(r&&r.biff==2?1:2);return[n,s]}function DB(e,t,r){var n=e.read_shift(1)>>>5&3,s=e.read_shift(r&&r.biff==2?1:2);return[n,s]}function FB(e,t,r){var n=e.read_shift(1)>>>5&3;return e.l+=4,r.biff<8&&e.l--,r.biff==12&&(e.l+=2),[n]}function OB(e,t,r){var n=(e[e.l++]&96)>>5,s=e.read_shift(2),a=4;if(r)switch(r.biff){case 5:a=15;break;case 12:a=6;break}return e.l+=a,[n,s]}var MB=qr,jB=qr,LB=qr;function nf(e,t,r){return e.l+=2,[QV(e)]}function Fv(e){return e.l+=6,[]}var UB=nf,VB=Fv,BB=Fv,$B=nf;function oI(e){return e.l+=2,[rr(e),e.read_shift(2)&1]}var WB=nf,zB=oI,HB=Fv,GB=nf,KB=nf,qB=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function XB(e){e.l+=2;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),s=e.read_shift(2),a=e.read_shift(2),i=qB[r>>2&31];return{ixti:t,coltype:r&3,rt:i,idx:n,c:s,C:a}}function YB(e){return e.l+=2,[e.read_shift(4)]}function QB(e,t,r){return e.l+=5,e.l+=2,e.l+=r.biff==2?1:4,["PTGSHEET"]}function JB(e,t,r){return e.l+=r.biff==2?4:5,["PTGENDSHEET"]}function ZB(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function e7(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function t7(e){return e.l+=4,[0,0]}var oE={1:{n:"PtgExp",f:_B},2:{n:"PtgTbl",f:LB},3:{n:"PtgAdd",f:Zt},4:{n:"PtgSub",f:Zt},5:{n:"PtgMul",f:Zt},6:{n:"PtgDiv",f:Zt},7:{n:"PtgPower",f:Zt},8:{n:"PtgConcat",f:Zt},9:{n:"PtgLt",f:Zt},10:{n:"PtgLe",f:Zt},11:{n:"PtgEq",f:Zt},12:{n:"PtgGe",f:Zt},13:{n:"PtgGt",f:Zt},14:{n:"PtgNe",f:Zt},15:{n:"PtgIsect",f:Zt},16:{n:"PtgUnion",f:Zt},17:{n:"PtgRange",f:Zt},18:{n:"PtgUplus",f:Zt},19:{n:"PtgUminus",f:Zt},20:{n:"PtgPercent",f:Zt},21:{n:"PtgParen",f:Zt},22:{n:"PtgMissArg",f:Zt},23:{n:"PtgStr",f:SB},26:{n:"PtgSheet",f:QB},27:{n:"PtgEndSheet",f:JB},28:{n:"PtgErr",f:wB},29:{n:"PtgBool",f:TB},30:{n:"PtgInt",f:EB},31:{n:"PtgNum",f:kB},32:{n:"PtgArray",f:aB},33:{n:"PtgFunc",f:gB},34:{n:"PtgFuncVar",f:xB},35:{n:"PtgName",f:NB},36:{n:"PtgRef",f:dB},37:{n:"PtgArea",f:eB},38:{n:"PtgMemArea",f:PB},39:{n:"PtgMemErr",f:MB},40:{n:"PtgMemNoMem",f:jB},41:{n:"PtgMemFunc",f:DB},42:{n:"PtgRefErr",f:FB},43:{n:"PtgAreaErr",f:rB},44:{n:"PtgRefN",f:mB},45:{n:"PtgAreaN",f:sB},46:{n:"PtgMemAreaN",f:ZB},47:{n:"PtgMemNoMemN",f:e7},57:{n:"PtgNameX",f:CB},58:{n:"PtgRef3d",f:pB},59:{n:"PtgArea3d",f:tB},60:{n:"PtgRefErr3d",f:OB},61:{n:"PtgAreaErr3d",f:nB},255:{}},r7={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},n7={1:{n:"PtgElfLel",f:oI},2:{n:"PtgElfRw",f:GB},3:{n:"PtgElfCol",f:UB},6:{n:"PtgElfRwV",f:KB},7:{n:"PtgElfColV",f:$B},10:{n:"PtgElfRadical",f:WB},11:{n:"PtgElfRadicalS",f:HB},13:{n:"PtgElfColS",f:VB},15:{n:"PtgElfColSV",f:BB},16:{n:"PtgElfRadicalLel",f:zB},25:{n:"PtgList",f:XB},29:{n:"PtgSxName",f:YB},255:{}},s7={0:{n:"PtgAttrNoop",f:t7},1:{n:"PtgAttrSemi",f:uB},2:{n:"PtgAttrIf",f:lB},4:{n:"PtgAttrChoose",f:iB},8:{n:"PtgAttrGoto",f:oB},16:{n:"PtgAttrSum",f:yB},32:{n:"PtgAttrBaxcel",f:iE},33:{n:"PtgAttrBaxcel",f:iE},64:{n:"PtgAttrSpace",f:fB},65:{n:"PtgAttrSpaceSemi",f:hB},128:{n:"PtgAttrIfError",f:cB},255:{}};function sf(e,t,r,n){if(n.biff<8)return qr(e,t);for(var s=e.l+t,a=[],i=0;i!==r.length;++i)switch(r[i][0]){case"PtgArray":r[i][1]=IB(e,0,n),a.push(r[i][1]);break;case"PtgMemArea":r[i][2]=bB(e,r[i][1],n),a.push(r[i][2]);break;case"PtgExp":n&&n.biff==12&&(r[i][1][1]=e.read_shift(4),a.push(r[i][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[i][0]}return t=s-e.l,t!==0&&a.push(qr(e,t)),a}function af(e,t,r){for(var n=e.l+t,s,a,i=[];n!=e.l;)t=n-e.l,a=e[e.l],s=oE[a]||oE[r7[a]],(a===24||a===25)&&(s=(a===24?n7:s7)[e[e.l+1]]),!s||!s.f?qr(e,t):i.push([s.n,s.f(e,t,r)]);return i}function a7(e){for(var t=[],r=0;r<e.length;++r){for(var n=e[r],s=[],a=0;a<n.length;++a){var i=n[a];if(i)switch(i[0]){case 2:s.push('"'+i[1].replace(/"/g,'""')+'"');break;default:s.push(i[1])}else s.push("")}t.push(s.join(","))}return t.join(";")}var i7={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function o7(e,t){if(!e&&!(t&&t.biff<=5&&t.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}function lI(e,t,r){if(!e)return"SH33TJSERR0";if(r.biff>8&&(!e.XTI||!e.XTI[t]))return e.SheetNames[t];if(!e.XTI)return"SH33TJSERR6";var n=e.XTI[t];if(r.biff<8)return t>1e4&&(t-=65536),t<0&&(t=-t),t==0?"":e.XTI[t-1];if(!n)return"SH33TJSERR1";var s="";if(r.biff>8)switch(e[n[0]][0]){case 357:return s=n[1]==-1?"#REF":e.SheetNames[n[1]],n[1]==n[2]?s:s+":"+e.SheetNames[n[2]];case 358:return r.SID!=null?e.SheetNames[r.SID]:"SH33TJSSAME"+e[n[0]][0];case 355:default:return"SH33TJSSRC"+e[n[0]][0]}switch(e[n[0]][0][0]){case 1025:return s=n[1]==-1?"#REF":e.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?s:s+":"+e.SheetNames[n[2]];case 14849:return e[n[0]].slice(1).map(function(a){return a.Name}).join(";;");default:return e[n[0]][0][3]?(s=n[1]==-1?"#REF":e[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?s:s+":"+e[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function lE(e,t,r){var n=lI(e,t,r);return n=="#REF"?n:o7(n,r)}function Ur(e,t,r,n,s){var a=s&&s.biff||8,i={s:{c:0,r:0}},o=[],l,u,f,d=0,m=0,p,x="";if(!e[0]||!e[0][0])return"";for(var g=-1,_="",k=0,E=e[0].length;k<E;++k){var y=e[0][k];switch(y[0]){case"PtgUminus":o.push("-"+o.pop());break;case"PtgUplus":o.push("+"+o.pop());break;case"PtgPercent":o.push(o.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(l=o.pop(),u=o.pop(),g>=0){switch(e[0][g][1][0]){case 0:_=zt(" ",e[0][g][1][1]);break;case 1:_=zt("\r",e[0][g][1][1]);break;default:if(_="",s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][g][1][0])}u=u+_,g=-1}o.push(u+i7[y[0]]+l);break;case"PtgIsect":l=o.pop(),u=o.pop(),o.push(u+" "+l);break;case"PtgUnion":l=o.pop(),u=o.pop(),o.push(u+","+l);break;case"PtgRange":l=o.pop(),u=o.pop(),o.push(u+":"+l);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":f=jc(y[1][1],i,s),o.push(Lc(f,a));break;case"PtgRefN":f=r?jc(y[1][1],r,s):y[1][1],o.push(Lc(f,a));break;case"PtgRef3d":d=y[1][1],f=jc(y[1][2],i,s),x=lE(n,d,s),o.push(x+"!"+Lc(f,a));break;case"PtgFunc":case"PtgFuncVar":var b=y[1][0],O=y[1][1];b||(b=0),b&=127;var D=b==0?[]:o.slice(-b);o.length-=b,O==="User"&&(O=D.shift()),o.push(O+"("+D.join(",")+")");break;case"PtgBool":o.push(y[1]?"TRUE":"FALSE");break;case"PtgInt":o.push(y[1]);break;case"PtgNum":o.push(String(y[1]));break;case"PtgStr":o.push('"'+y[1].replace(/"/g,'""')+'"');break;case"PtgErr":o.push(y[1]);break;case"PtgAreaN":p=$w(y[1][1],r?{s:r}:i,s),o.push(vm(p,s));break;case"PtgArea":p=$w(y[1][1],i,s),o.push(vm(p,s));break;case"PtgArea3d":d=y[1][1],p=y[1][2],x=lE(n,d,s),o.push(x+"!"+vm(p,s));break;case"PtgAttrSum":o.push("SUM("+o.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":m=y[1][2];var v=(n.names||[])[m-1]||(n[0]||[])[m],T=v?v.Name:"SH33TJSNAME"+String(m);T&&T.slice(0,6)=="_xlfn."&&!s.xlfn&&(T=T.slice(6)),o.push(T);break;case"PtgNameX":var S=y[1][1];m=y[1][2];var N;if(s.biff<=5)S<0&&(S=-S),n[S]&&(N=n[S][m]);else{var C="";if(((n[S]||[])[0]||[])[0]==14849||(((n[S]||[])[0]||[])[0]==1025?n[S][m]&&n[S][m].itab>0&&(C=n.SheetNames[n[S][m].itab-1]+"!"):C=n.SheetNames[m-1]+"!"),n[S]&&n[S][m])C+=n[S][m].Name;else if(n[0]&&n[0][m])C+=n[0][m].Name;else{var R=(lI(n,S,s)||"").split(";;");R[m-1]?C=R[m-1]:C+="SH33TJSERRX"}o.push(C);break}N||(N={Name:"SH33TJSERRY"}),o.push(N.Name);break;case"PtgParen":var F="(",oe=")";if(g>=0){switch(_="",e[0][g][1][0]){case 2:F=zt(" ",e[0][g][1][1])+F;break;case 3:F=zt("\r",e[0][g][1][1])+F;break;case 4:oe=zt(" ",e[0][g][1][1])+oe;break;case 5:oe=zt("\r",e[0][g][1][1])+oe;break;default:if(s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][g][1][0])}g=-1}o.push(F+o.pop()+oe);break;case"PtgRefErr":o.push("#REF!");break;case"PtgRefErr3d":o.push("#REF!");break;case"PtgExp":f={c:y[1][1],r:y[1][0]};var te={c:r.c,r:r.r};if(n.sharedf[We(f)]){var de=n.sharedf[We(f)];o.push(Ur(de,i,te,n,s))}else{var ae=!1;for(l=0;l!=n.arrayf.length;++l)if(u=n.arrayf[l],!(f.c<u[0].s.c||f.c>u[0].e.c)&&!(f.r<u[0].s.r||f.r>u[0].e.r)){o.push(Ur(u[1],i,te,n,s)),ae=!0;break}ae||o.push(y[1])}break;case"PtgArray":o.push("{"+a7(y[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":g=k;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":o.push("");break;case"PtgAreaErr":o.push("#REF!");break;case"PtgAreaErr3d":o.push("#REF!");break;case"PtgList":o.push("Table"+y[1].idx+"[#"+y[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(y));default:throw new Error("Unrecognized Formula Token: "+String(y))}var X=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(s.biff!=3&&g>=0&&X.indexOf(e[0][k][0])==-1){y=e[0][g];var H=!0;switch(y[1][0]){case 4:H=!1;case 0:_=zt(" ",y[1][1]);break;case 5:H=!1;case 1:_=zt("\r",y[1][1]);break;default:if(_="",s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+y[1][0])}o.push((H?_:"")+o.pop()+(H?"":_)),g=-1}}if(o.length>1&&s.WTF)throw new Error("bad formula stack");return o[0]}function l7(e,t,r){var n=e.l+t,s=r.biff==2?1:2,a,i=e.read_shift(s);if(i==65535)return[[],qr(e,t-2)];var o=af(e,i,r);return t!==i+s&&(a=sf(e,t-i-s,o,r)),e.l=n,[o,a]}function c7(e,t,r){var n=e.l+t,s=r.biff==2?1:2,a,i=e.read_shift(s);if(i==65535)return[[],qr(e,t-2)];var o=af(e,i,r);return t!==i+s&&(a=sf(e,t-i-s,o,r)),e.l=n,[o,a]}function u7(e,t,r,n){var s=e.l+t,a=af(e,n,r),i;return s!==e.l&&(i=sf(e,s-e.l,a,r)),[a,i]}function f7(e,t,r){var n=e.l+t,s,a=e.read_shift(2),i=af(e,a,r);return a==65535?[[],qr(e,t-2)]:(t!==a+2&&(s=sf(e,n-a-2,i,r)),[i,s])}function h7(e){var t;if(la(e,e.l+6)!==65535)return[$r(e),"n"];switch(e[e.l]){case 0:return e.l+=8,["String","s"];case 1:return t=e[e.l+2]===1,e.l+=8,[t,"b"];case 2:return t=e[e.l+2],e.l+=8,[t,"e"];case 3:return e.l+=8,["","s"]}return[]}function wm(e,t,r){var n=e.l+t,s=Hs(e);r.biff==2&&++e.l;var a=h7(e),i=e.read_shift(1);r.biff!=2&&(e.read_shift(1),r.biff>=5&&e.read_shift(4));var o=c7(e,n-e.l,r);return{cell:s,val:a[0],formula:o,shared:i>>3&1,tt:a[1]}}function _0(e,t,r){var n=e.read_shift(4),s=af(e,n,r),a=e.read_shift(4),i=a>0?sf(e,a,s,r):null;return[s,i]}var d7=_0,w0=_0,m7=_0,p7=_0,g7={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},cI={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},x7={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function cE(e){return e.slice(0,3)=="of:"&&(e=e.slice(3)),e.charCodeAt(0)==61&&(e=e.slice(1),e.charCodeAt(0)==61&&(e=e.slice(1))),e=e.replace(/COM\.MICROSOFT\./g,""),e=e.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(t,r){return r.replace(/\./g,"")}),e=e.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),e.replace(/[;~]/g,",").replace(/\|/g,";")}function Em(e){var t=e.split(":"),r=t[0].split(".")[0];return[r,t[0].split(".")[1]+(t.length>1?":"+(t[1].split(".")[1]||t[1].split(".")[0]):"")]}var $c={},ol={};function Wc(e,t){if(e){var r=[.7,.7,.75,.75,.3,.3];t=="xlml"&&(r=[1,1,1,1,.5,.5]),e.left==null&&(e.left=r[0]),e.right==null&&(e.right=r[1]),e.top==null&&(e.top=r[2]),e.bottom==null&&(e.bottom=r[3]),e.header==null&&(e.header=r[4]),e.footer==null&&(e.footer=r[5])}}function uI(e,t,r,n,s,a){try{n.cellNF&&(e.z=He[t])}catch(o){if(n.WTF)throw o}if(!(e.t==="z"&&!n.cellStyles)){if(e.t==="d"&&typeof e.v=="string"&&(e.v=yr(e.v)),(!n||n.cellText!==!1)&&e.t!=="z")try{if(He[t]==null&&Gi(v8[t]||"General",t),e.t==="e")e.w=e.w||yo[e.v];else if(t===0)if(e.t==="n")(e.v|0)===e.v?e.w=e.v.toString(10):e.w=wu(e.v);else if(e.t==="d"){var i=sn(e.v);(i|0)===i?e.w=i.toString(10):e.w=wu(i)}else{if(e.v===void 0)return"";e.w=ao(e.v,ol)}else e.t==="d"?e.w=es(t,sn(e.v),ol):e.w=es(t,e.v,ol)}catch(o){if(n.WTF)throw o}if(n.cellStyles&&r!=null)try{e.s=a.Fills[r],e.s.fgColor&&e.s.fgColor.theme&&!e.s.fgColor.rgb&&(e.s.fgColor.rgb=Ed(s.themeElements.clrScheme[e.s.fgColor.theme].rgb,e.s.fgColor.tint||0),n.WTF&&(e.s.fgColor.raw_rgb=s.themeElements.clrScheme[e.s.fgColor.theme].rgb)),e.s.bgColor&&e.s.bgColor.theme&&(e.s.bgColor.rgb=Ed(s.themeElements.clrScheme[e.s.bgColor.theme].rgb,e.s.bgColor.tint||0),n.WTF&&(e.s.bgColor.raw_rgb=s.themeElements.clrScheme[e.s.bgColor.theme].rgb))}catch(o){if(n.WTF&&a.Fills)throw o}}}function v7(e,t){var r=Gt(t);r.s.r<=r.e.r&&r.s.c<=r.e.c&&r.s.r>=0&&r.s.c>=0&&(e["!ref"]=at(r))}var y7=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,_7=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,w7=/<(?:\w:)?hyperlink [^>]*>/mg,E7=/"(\w*:\w*)"/,T7=/<(?:\w:)?col\b[^>]*[\/]?>/g,k7=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,S7=/<(?:\w:)?pageMargins[^>]*\/>/g,fI=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,A7=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,b7=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function I7(e,t,r,n,s,a,i){if(!e)return e;n||(n={"!id":{}});var o=t.dense?[]:{},l={s:{r:2e6,c:2e6},e:{r:0,c:0}},u="",f="",d=e.match(_7);d?(u=e.slice(0,d.index),f=e.slice(d.index+d[0].length)):u=f=e;var m=u.match(fI);m?Ov(m[0],o,s,r):(m=u.match(A7))&&N7(m[0],m[1]||"",o,s,r);var p=(u.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(p>0){var x=u.slice(p,p+50).match(E7);x&&v7(o,x[1])}var g=u.match(b7);g&&g[1]&&O7(g[1],s);var _=[];if(t.cellStyles){var k=u.match(T7);k&&P7(_,k)}d&&M7(d[1],o,t,l,a,i);var E=f.match(k7);E&&(o["!autofilter"]=D7(E[0]));var y=[],b=f.match(y7);if(b)for(p=0;p!=b.length;++p)y[p]=Gt(b[p].slice(b[p].indexOf('"')+1));var O=f.match(w7);O&&C7(o,O,n);var D=f.match(S7);if(D&&(o["!margins"]=R7(je(D[0]))),!o["!ref"]&&l.e.c>=l.s.c&&l.e.r>=l.s.r&&(o["!ref"]=at(l)),t.sheetRows>0&&o["!ref"]){var v=Gt(o["!ref"]);t.sheetRows<=+v.e.r&&(v.e.r=t.sheetRows-1,v.e.r>l.e.r&&(v.e.r=l.e.r),v.e.r<v.s.r&&(v.s.r=v.e.r),v.e.c>l.e.c&&(v.e.c=l.e.c),v.e.c<v.s.c&&(v.s.c=v.e.c),o["!fullref"]=o["!ref"],o["!ref"]=at(v))}return _.length>0&&(o["!cols"]=_),y.length>0&&(o["!merges"]=y),o}function Ov(e,t,r,n){var s=je(e);r.Sheets[n]||(r.Sheets[n]={}),s.codeName&&(r.Sheets[n].CodeName=lt(St(s.codeName)))}function N7(e,t,r,n,s){Ov(e.slice(0,e.indexOf(">")),r,n,s)}function C7(e,t,r){for(var n=Array.isArray(e),s=0;s!=t.length;++s){var a=je(St(t[s]),!0);if(!a.ref)return;var i=((r||{})["!id"]||[])[a.id];i?(a.Target=i.Target,a.location&&(a.Target+="#"+lt(a.location))):(a.Target="#"+lt(a.location),i={Target:a.Target,TargetMode:"Internal"}),a.Rel=i,a.tooltip&&(a.Tooltip=a.tooltip,delete a.tooltip);for(var o=Gt(a.ref),l=o.s.r;l<=o.e.r;++l)for(var u=o.s.c;u<=o.e.c;++u){var f=We({c:u,r:l});n?(e[l]||(e[l]=[]),e[l][u]||(e[l][u]={t:"z",v:void 0}),e[l][u].l=a):(e[f]||(e[f]={t:"z",v:void 0}),e[f].l=a)}}}function R7(e){var t={};return["left","right","top","bottom","header","footer"].forEach(function(r){e[r]&&(t[r]=parseFloat(e[r]))}),t}function P7(e,t){for(var r=!1,n=0;n!=t.length;++n){var s=je(t[n],!0);s.hidden&&(s.hidden=Ft(s.hidden));var a=parseInt(s.min,10)-1,i=parseInt(s.max,10)-1;for(s.outlineLevel&&(s.level=+s.outlineLevel||0),delete s.min,delete s.max,s.width=+s.width,!r&&s.width&&(r=!0,Dv(s.width)),Al(s);a<=i;)e[a++]=Ir(s)}}function D7(e){var t={ref:(e.match(/ref="([^"]*)"/)||[])[1]};return t}var F7=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function O7(e,t){t.Views||(t.Views=[{}]),(e.match(F7)||[]).forEach(function(r,n){var s=je(r);t.Views[n]||(t.Views[n]={}),+s.zoomScale&&(t.Views[n].zoom=+s.zoomScale),Ft(s.rightToLeft)&&(t.Views[n].RTL=!0)})}var M7=function(){var e=/<(?:\w+:)?c[ \/>]/,t=/<\/(?:\w+:)?row>/,r=/r=["']([^"']*)["']/,n=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,s=/ref=["']([^"']*)["']/,a=Eu("v"),i=Eu("f");return function(l,u,f,d,m,p){for(var x=0,g="",_=[],k=[],E=0,y=0,b=0,O="",D,v,T=0,S=0,N,C,R=0,F=0,oe=Array.isArray(p.CellXf),te,de=[],ae=[],X=Array.isArray(u),H=[],Z={},Y=!1,M=!!f.sheetStubs,q=l.split(t),K=0,L=q.length;K!=L;++K){g=q[K].trim();var J=g.length;if(J!==0){var fe=0;e:for(x=0;x<J;++x)switch(g[x]){case">":if(g[x-1]!="/"){++x;break e}if(f&&f.cellStyles){if(v=je(g.slice(fe,x),!0),T=v.r!=null?parseInt(v.r,10):T+1,S=-1,f.sheetRows&&f.sheetRows<T)continue;Z={},Y=!1,v.ht&&(Y=!0,Z.hpt=parseFloat(v.ht),Z.hpx=Au(Z.hpt)),v.hidden=="1"&&(Y=!0,Z.hidden=!0),v.outlineLevel!=null&&(Y=!0,Z.level=+v.outlineLevel),Y&&(H[T-1]=Z)}break;case"<":fe=x;break}if(fe>=x)break;if(v=je(g.slice(fe,x),!0),T=v.r!=null?parseInt(v.r,10):T+1,S=-1,!(f.sheetRows&&f.sheetRows<T)){d.s.r>T-1&&(d.s.r=T-1),d.e.r<T-1&&(d.e.r=T-1),f&&f.cellStyles&&(Z={},Y=!1,v.ht&&(Y=!0,Z.hpt=parseFloat(v.ht),Z.hpx=Au(Z.hpt)),v.hidden=="1"&&(Y=!0,Z.hidden=!0),v.outlineLevel!=null&&(Y=!0,Z.level=+v.outlineLevel),Y&&(H[T-1]=Z)),_=g.slice(x).split(e);for(var we=0;we!=_.length&&_[we].trim().charAt(0)=="<";++we);for(_=_.slice(we),x=0;x!=_.length;++x)if(g=_[x].trim(),g.length!==0){if(k=g.match(r),E=x,y=0,b=0,g="<c "+(g.slice(0,1)=="<"?">":"")+g,k!=null&&k.length===2){for(E=0,O=k[1],y=0;y!=O.length&&!((b=O.charCodeAt(y)-64)<1||b>26);++y)E=26*E+b;--E,S=E}else++S;for(y=0;y!=g.length&&g.charCodeAt(y)!==62;++y);if(++y,v=je(g.slice(0,y),!0),v.r||(v.r=We({r:T-1,c:S})),O=g.slice(y),D={t:""},(k=O.match(a))!=null&&k[1]!==""&&(D.v=lt(k[1])),f.cellFormula){if((k=O.match(i))!=null&&k[1]!==""){if(D.f=lt(St(k[1])).replace(/\r\n/g,`
`),f.xlfn||(D.f=aE(D.f)),k[0].indexOf('t="array"')>-1)D.F=(O.match(s)||[])[1],D.F.indexOf(":")>-1&&de.push([Gt(D.F),D.F]);else if(k[0].indexOf('t="shared"')>-1){C=je(k[0]);var ge=lt(St(k[1]));f.xlfn||(ge=aE(ge)),ae[parseInt(C.si,10)]=[C,ge,v.r]}}else(k=O.match(/<f[^>]*\/>/))&&(C=je(k[0]),ae[C.si]&&(D.f=KV(ae[C.si][1],ae[C.si][2],v.r)));var pe=en(v.r);for(y=0;y<de.length;++y)pe.r>=de[y][0].s.r&&pe.r<=de[y][0].e.r&&pe.c>=de[y][0].s.c&&pe.c<=de[y][0].e.c&&(D.F=de[y][1])}if(v.t==null&&D.v===void 0)if(D.f||D.F)D.v=0,D.t="n";else if(M)D.t="z";else continue;else D.t=v.t||"n";switch(d.s.c>S&&(d.s.c=S),d.e.c<S&&(d.e.c=S),D.t){case"n":if(D.v==""||D.v==null){if(!M)continue;D.t="z"}else D.v=parseFloat(D.v);break;case"s":if(typeof D.v>"u"){if(!M)continue;D.t="z"}else N=$c[parseInt(D.v,10)],D.v=N.t,D.r=N.r,f.cellHTML&&(D.h=N.h);break;case"str":D.t="s",D.v=D.v!=null?St(D.v):"",f.cellHTML&&(D.h=Ev(D.v));break;case"inlineStr":k=O.match(n),D.t="s",k!=null&&(N=Pv(k[1]))?(D.v=N.t,f.cellHTML&&(D.h=N.h)):D.v="";break;case"b":D.v=Ft(D.v);break;case"d":f.cellDates?D.v=yr(D.v,1):(D.v=sn(yr(D.v,1)),D.t="n");break;case"e":(!f||f.cellText!==!1)&&(D.w=D.v),D.v=Pb[D.v];break}if(R=F=0,te=null,oe&&v.s!==void 0&&(te=p.CellXf[v.s],te!=null&&(te.numFmtId!=null&&(R=te.numFmtId),f.cellStyles&&te.fillId!=null&&(F=te.fillId))),uI(D,R,F,f,m,p),f.cellDates&&oe&&D.t=="n"&&Ml(He[R])&&(D.t="d",D.v=v0(D.v)),v.cm&&f.xlmeta){var Pe=(f.xlmeta.Cell||[])[+v.cm-1];Pe&&Pe.type=="XLDAPR"&&(D.D=!0)}if(X){var G=en(v.r);u[G.r]||(u[G.r]=[]),u[G.r][G.c]=D}else u[v.r]=D}}}}H.length>0&&(u["!rows"]=H)}}();function j7(e,t){var r={},n=e.l+t;r.r=e.read_shift(4),e.l+=4;var s=e.read_shift(2);e.l+=1;var a=e.read_shift(1);return e.l=n,a&7&&(r.level=a&7),a&16&&(r.hidden=!0),a&32&&(r.hpt=s/20),r}var L7=vo;function U7(){}function V7(e,t){var r={},n=e[e.l];return++e.l,r.above=!(n&64),r.left=!(n&128),e.l+=18,r.name=l5(e),r}function B7(e){var t=rs(e);return[t]}function $7(e){var t=xo(e);return[t]}function W7(e){var t=rs(e),r=e.read_shift(1);return[t,r,"b"]}function z7(e){var t=xo(e),r=e.read_shift(1);return[t,r,"b"]}function H7(e){var t=rs(e),r=e.read_shift(1);return[t,r,"e"]}function G7(e){var t=xo(e),r=e.read_shift(1);return[t,r,"e"]}function K7(e){var t=rs(e),r=e.read_shift(4);return[t,r,"s"]}function q7(e){var t=xo(e),r=e.read_shift(4);return[t,r,"s"]}function X7(e){var t=rs(e),r=$r(e);return[t,r,"n"]}function hI(e){var t=xo(e),r=$r(e);return[t,r,"n"]}function Y7(e){var t=rs(e),r=Nv(e);return[t,r,"n"]}function Q7(e){var t=xo(e),r=Nv(e);return[t,r,"n"]}function J7(e){var t=rs(e),r=bv(e);return[t,r,"is"]}function Z7(e){var t=rs(e),r=Hr(e);return[t,r,"str"]}function e$(e){var t=xo(e),r=Hr(e);return[t,r,"str"]}function t$(e,t,r){var n=e.l+t,s=rs(e);s.r=r["!row"];var a=e.read_shift(1),i=[s,a,"b"];if(r.cellFormula){e.l+=2;var o=w0(e,n-e.l,r);i[3]=Ur(o,null,s,r.supbooks,r)}else e.l=n;return i}function r$(e,t,r){var n=e.l+t,s=rs(e);s.r=r["!row"];var a=e.read_shift(1),i=[s,a,"e"];if(r.cellFormula){e.l+=2;var o=w0(e,n-e.l,r);i[3]=Ur(o,null,s,r.supbooks,r)}else e.l=n;return i}function n$(e,t,r){var n=e.l+t,s=rs(e);s.r=r["!row"];var a=$r(e),i=[s,a,"n"];if(r.cellFormula){e.l+=2;var o=w0(e,n-e.l,r);i[3]=Ur(o,null,s,r.supbooks,r)}else e.l=n;return i}function s$(e,t,r){var n=e.l+t,s=rs(e);s.r=r["!row"];var a=Hr(e),i=[s,a,"str"];if(r.cellFormula){e.l+=2;var o=w0(e,n-e.l,r);i[3]=Ur(o,null,s,r.supbooks,r)}else e.l=n;return i}var a$=vo;function i$(e,t){var r=e.l+t,n=vo(e),s=Iv(e),a=Hr(e),i=Hr(e),o=Hr(e);e.l=r;var l={rfx:n,relId:s,loc:a,display:o};return i&&(l.Tooltip=i),l}function o$(){}function l$(e,t,r){var n=e.l+t,s=Nb(e),a=e.read_shift(1),i=[s];if(i[2]=a,r.cellFormula){var o=d7(e,n-e.l,r);i[1]=o}else e.l=n;return i}function c$(e,t,r){var n=e.l+t,s=vo(e),a=[s];if(r.cellFormula){var i=p7(e,n-e.l,r);a[1]=i,e.l=n}else e.l=n;return a}var u$=["left","right","top","bottom","header","footer"];function f$(e){var t={};return u$.forEach(function(r){t[r]=$r(e)}),t}function h$(e){var t=e.read_shift(2);return e.l+=28,{RTL:t&32}}function d$(){}function m$(){}function p$(e,t,r,n,s,a,i){if(!e)return e;var o=t||{};n||(n={"!id":{}});var l=o.dense?[]:{},u,f={s:{r:2e6,c:2e6},e:{r:0,c:0}},d=!1,m=!1,p,x,g,_,k,E,y,b,O,D=[];o.biff=12,o["!row"]=0;var v=0,T=!1,S=[],N={},C=o.supbooks||s.supbooks||[[]];if(C.sharedf=N,C.arrayf=S,C.SheetNames=s.SheetNames||s.Sheets.map(function(X){return X.name}),!o.supbooks&&(o.supbooks=C,s.Names))for(var R=0;R<s.Names.length;++R)C[0][R+1]=s.Names[R];var F=[],oe=[],te=!1;Sd[16]={n:"BrtShortReal",f:hI};var de;if(Ia(e,function(H,Z,Y){if(!m)switch(Y){case 148:u=H;break;case 0:p=H,o.sheetRows&&o.sheetRows<=p.r&&(m=!0),b=Nr(_=p.r),o["!row"]=p.r,(H.hidden||H.hpt||H.level!=null)&&(H.hpt&&(H.hpx=Au(H.hpt)),oe[H.r]=H);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(x={t:H[2]},H[2]){case"n":x.v=H[1];break;case"s":y=$c[H[1]],x.v=y.t,x.r=y.r;break;case"b":x.v=!!H[1];break;case"e":x.v=H[1],o.cellText!==!1&&(x.w=yo[x.v]);break;case"str":x.t="s",x.v=H[1];break;case"is":x.t="s",x.v=H[1].t;break}if((g=i.CellXf[H[0].iStyleRef])&&uI(x,g.numFmtId,null,o,a,i),k=H[0].c==-1?k+1:H[0].c,o.dense?(l[_]||(l[_]=[]),l[_][k]=x):l[ur(k)+b]=x,o.cellFormula){for(T=!1,v=0;v<S.length;++v){var M=S[v];p.r>=M[0].s.r&&p.r<=M[0].e.r&&k>=M[0].s.c&&k<=M[0].e.c&&(x.F=at(M[0]),T=!0)}!T&&H.length>3&&(x.f=H[3])}if(f.s.r>p.r&&(f.s.r=p.r),f.s.c>k&&(f.s.c=k),f.e.r<p.r&&(f.e.r=p.r),f.e.c<k&&(f.e.c=k),o.cellDates&&g&&x.t=="n"&&Ml(He[g.numFmtId])){var q=Ui(x.v);q&&(x.t="d",x.v=new Date(q.y,q.m-1,q.d,q.H,q.M,q.S,q.u))}de&&(de.type=="XLDAPR"&&(x.D=!0),de=void 0);break;case 1:case 12:if(!o.sheetStubs||d)break;x={t:"z",v:void 0},k=H[0].c==-1?k+1:H[0].c,o.dense?(l[_]||(l[_]=[]),l[_][k]=x):l[ur(k)+b]=x,f.s.r>p.r&&(f.s.r=p.r),f.s.c>k&&(f.s.c=k),f.e.r<p.r&&(f.e.r=p.r),f.e.c<k&&(f.e.c=k),de&&(de.type=="XLDAPR"&&(x.D=!0),de=void 0);break;case 176:D.push(H);break;case 49:de=((o.xlmeta||{}).Cell||[])[H-1];break;case 494:var K=n["!id"][H.relId];for(K?(H.Target=K.Target,H.loc&&(H.Target+="#"+H.loc),H.Rel=K):H.relId==""&&(H.Target="#"+H.loc),_=H.rfx.s.r;_<=H.rfx.e.r;++_)for(k=H.rfx.s.c;k<=H.rfx.e.c;++k)o.dense?(l[_]||(l[_]=[]),l[_][k]||(l[_][k]={t:"z",v:void 0}),l[_][k].l=H):(E=We({c:k,r:_}),l[E]||(l[E]={t:"z",v:void 0}),l[E].l=H);break;case 426:if(!o.cellFormula)break;S.push(H),O=o.dense?l[_][k]:l[ur(k)+b],O.f=Ur(H[1],f,{r:p.r,c:k},C,o),O.F=at(H[0]);break;case 427:if(!o.cellFormula)break;N[We(H[0].s)]=H[1],O=o.dense?l[_][k]:l[ur(k)+b],O.f=Ur(H[1],f,{r:p.r,c:k},C,o);break;case 60:if(!o.cellStyles)break;for(;H.e>=H.s;)F[H.e--]={width:H.w/256,hidden:!!(H.flags&1),level:H.level},te||(te=!0,Dv(H.w/256)),Al(F[H.e+1]);break;case 161:l["!autofilter"]={ref:at(H)};break;case 476:l["!margins"]=H;break;case 147:s.Sheets[r]||(s.Sheets[r]={}),H.name&&(s.Sheets[r].CodeName=H.name),(H.above||H.left)&&(l["!outline"]={above:H.above,left:H.left});break;case 137:s.Views||(s.Views=[{}]),s.Views[0]||(s.Views[0]={}),H.RTL&&(s.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:d=!0;break;case 36:d=!1;break;case 37:d=!0;break;case 38:d=!1;break;default:if(!Z.T){if(!d||o.WTF)throw new Error("Unexpected record 0x"+Y.toString(16))}}},o),delete o.supbooks,delete o["!row"],!l["!ref"]&&(f.s.r<2e6||u&&(u.e.r>0||u.e.c>0||u.s.r>0||u.s.c>0))&&(l["!ref"]=at(u||f)),o.sheetRows&&l["!ref"]){var ae=Gt(l["!ref"]);o.sheetRows<=+ae.e.r&&(ae.e.r=o.sheetRows-1,ae.e.r>f.e.r&&(ae.e.r=f.e.r),ae.e.r<ae.s.r&&(ae.s.r=ae.e.r),ae.e.c>f.e.c&&(ae.e.c=f.e.c),ae.e.c<ae.s.c&&(ae.s.c=ae.e.c),l["!fullref"]=l["!ref"],l["!ref"]=at(ae))}return D.length>0&&(l["!merges"]=D),F.length>0&&(l["!cols"]=F),oe.length>0&&(l["!rows"]=oe),l}function g$(e){var t=[],r=e.match(/^<c:numCache>/),n;(e.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(a){var i=a.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);i&&(t[+i[1]]=r?+i[2]:i[2])});var s=lt((e.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(e.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(a){n=a.replace(/<.*?>/g,"")}),[t,s,n]}function x$(e,t,r,n,s,a){var i=a||{"!type":"chart"};if(!e)return a;var o=0,l=0,u="A",f={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(e.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(d){var m=g$(d);f.s.r=f.s.c=0,f.e.c=o,u=ur(o),m[0].forEach(function(p,x){i[u+Nr(x)]={t:"n",v:p,z:m[1]},l=x}),f.e.r<l&&(f.e.r=l),++o}),o>0&&(i["!ref"]=at(f)),i}function v$(e,t,r,n,s){if(!e)return e;n||(n={"!id":{}});var a={"!type":"chart","!drawel":null,"!rel":""},i,o=e.match(fI);return o&&Ov(o[0],a,s,r),(i=e.match(/drawing r:id="(.*?)"/))&&(a["!rel"]=i[1]),n["!id"][a["!rel"]]&&(a["!drawel"]=n["!id"][a["!rel"]]),a}function y$(e,t){e.l+=10;var r=Hr(e);return{name:r}}function _$(e,t,r,n,s){if(!e)return e;n||(n={"!id":{}});var a={"!type":"chart","!drawel":null,"!rel":""},i=!1;return Ia(e,function(l,u,f){switch(f){case 550:a["!rel"]=l;break;case 651:s.Sheets[r]||(s.Sheets[r]={}),l.name&&(s.Sheets[r].CodeName=l.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:i=!0;break;case 36:i=!1;break;case 37:break;case 38:break;default:if(!(u.T>0)){if(!(u.T<0)){if(!i||t.WTF)throw new Error("Unexpected record 0x"+f.toString(16))}}}},t),n["!id"][a["!rel"]]&&(a["!drawel"]=n["!id"][a["!rel"]]),a}var dI=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],w$=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],E$=[],T$=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function uE(e,t){for(var r=0;r!=e.length;++r)for(var n=e[r],s=0;s!=t.length;++s){var a=t[s];if(n[a[0]]==null)n[a[0]]=a[1];else switch(a[2]){case"bool":typeof n[a[0]]=="string"&&(n[a[0]]=Ft(n[a[0]]));break;case"int":typeof n[a[0]]=="string"&&(n[a[0]]=parseInt(n[a[0]],10));break}}}function fE(e,t){for(var r=0;r!=t.length;++r){var n=t[r];if(e[n[0]]==null)e[n[0]]=n[1];else switch(n[2]){case"bool":typeof e[n[0]]=="string"&&(e[n[0]]=Ft(e[n[0]]));break;case"int":typeof e[n[0]]=="string"&&(e[n[0]]=parseInt(e[n[0]],10));break}}}function mI(e){fE(e.WBProps,dI),fE(e.CalcPr,T$),uE(e.WBView,w$),uE(e.Sheets,E$),ol.date1904=Ft(e.WBProps.date1904)}var k$="][*?/\\".split("");function S$(e,t){if(e.length>31)throw new Error("Sheet names cannot exceed 31 chars");var r=!0;return k$.forEach(function(n){if(e.indexOf(n)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),r}var A$=/<\w+:workbook/;function b$(e,t){if(!e)throw new Error("Could not find file");var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},n=!1,s="xmlns",a={},i=0;if(e.replace(Xr,function(l,u){var f=je(l);switch(zs(f[0])){case"<?xml":break;case"<workbook":l.match(A$)&&(s="xmlns"+l.match(/<(\w+):/)[1]),r.xmlns=f[s];break;case"</workbook>":break;case"<fileVersion":delete f[0],r.AppVersion=f;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":dI.forEach(function(d){if(f[d[0]]!=null)switch(d[2]){case"bool":r.WBProps[d[0]]=Ft(f[d[0]]);break;case"int":r.WBProps[d[0]]=parseInt(f[d[0]],10);break;default:r.WBProps[d[0]]=f[d[0]]}}),f.codeName&&(r.WBProps.CodeName=St(f.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete f[0],r.WBView.push(f);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(f.state){case"hidden":f.Hidden=1;break;case"veryHidden":f.Hidden=2;break;default:f.Hidden=0}delete f.state,f.name=lt(St(f.name)),delete f[0],r.Sheets.push(f);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":n=!0;break;case"</definedNames>":n=!1;break;case"<definedName":a={},a.Name=St(f.name),f.comment&&(a.Comment=f.comment),f.localSheetId&&(a.Sheet=+f.localSheetId),Ft(f.hidden||"0")&&(a.Hidden=!0),i=u+l.length;break;case"</definedName>":a.Ref=lt(St(e.slice(i,u))),r.Names.push(a);break;case"<definedName/>":break;case"<calcPr":delete f[0],r.CalcPr=f;break;case"<calcPr/>":delete f[0],r.CalcPr=f;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":n=!0;break;case"</AlternateContent>":n=!1;break;case"<revisionPtr":break;default:if(!n&&t.WTF)throw new Error("unrecognized "+f[0]+" in workbook")}return l}),H8.indexOf(r.xmlns)===-1)throw new Error("Unknown Namespace: "+r.xmlns);return mI(r),r}function I$(e,t){var r={};return r.Hidden=e.read_shift(4),r.iTabID=e.read_shift(4),r.strRelID=eg(e),r.name=Hr(e),r}function N$(e,t){var r={},n=e.read_shift(4);r.defaultThemeVersion=e.read_shift(4);var s=t>8?Hr(e):"";return s.length>0&&(r.CodeName=s),r.autoCompressPictures=!!(n&65536),r.backupFile=!!(n&64),r.checkCompatibility=!!(n&4096),r.date1904=!!(n&1),r.filterPrivacy=!!(n&8),r.hidePivotFieldList=!!(n&1024),r.promptedSolutions=!!(n&16),r.publishItems=!!(n&2048),r.refreshAllConnections=!!(n&262144),r.saveExternalLinkValues=!!(n&128),r.showBorderUnselectedTables=!!(n&4),r.showInkAnnotation=!!(n&32),r.showObjects=["all","placeholders","none"][n>>13&3],r.showPivotChartFilter=!!(n&32768),r.updateLinks=["userSet","never","always"][n>>8&3],r}function C$(e,t){var r={};return e.read_shift(4),r.ArchID=e.read_shift(4),e.l+=t-8,r}function R$(e,t,r){var n=e.l+t;e.l+=4,e.l+=1;var s=e.read_shift(4),a=c5(e),i=m7(e,0,r),o=Iv(e);e.l=n;var l={Name:a,Ptg:i};return s<268435455&&(l.Sheet=s),o&&(l.Comment=o),l}function P$(e,t){var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},n=[],s=!1;t||(t={}),t.biff=12;var a=[],i=[[]];return i.SheetNames=[],i.XTI=[],Sd[16]={n:"BrtFRTArchID$",f:C$},Ia(e,function(l,u,f){switch(f){case 156:i.SheetNames.push(l.name),r.Sheets.push(l);break;case 153:r.WBProps=l;break;case 39:l.Sheet!=null&&(t.SID=l.Sheet),l.Ref=Ur(l.Ptg,null,null,i,t),delete t.SID,delete l.Ptg,a.push(l);break;case 1036:break;case 357:case 358:case 355:case 667:i[0].length?i.push([f,l]):i[0]=[f,l],i[i.length-1].XTI=[];break;case 362:i.length===0&&(i[0]=[],i[0].XTI=[]),i[i.length-1].XTI=i[i.length-1].XTI.concat(l),i.XTI=i.XTI.concat(l);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:n.push(f),s=!0;break;case 36:n.pop(),s=!1;break;case 37:n.push(f),s=!0;break;case 38:n.pop(),s=!1;break;case 16:break;default:if(!u.T){if(!s||t.WTF&&n[n.length-1]!=37&&n[n.length-1]!=35)throw new Error("Unexpected record 0x"+f.toString(16))}}},t),mI(r),r.Names=a,r.supbooks=i,r}function D$(e,t,r){return t.slice(-4)===".bin"?P$(e,r):b$(e,r)}function F$(e,t,r,n,s,a,i,o){return t.slice(-4)===".bin"?p$(e,n,r,s,a,i,o):I7(e,n,r,s,a,i,o)}function O$(e,t,r,n,s,a,i,o){return t.slice(-4)===".bin"?_$(e,n,r,s,a):v$(e,n,r,s,a)}function M$(e,t,r,n,s,a,i,o){return t.slice(-4)===".bin"?zV():HV()}function j$(e,t,r,n,s,a,i,o){return t.slice(-4)===".bin"?$V():WV()}function L$(e,t,r,n){return t.slice(-4)===".bin"?aV(e,r,n):ZU(e,r,n)}function U$(e,t,r){return eI(e,r)}function V$(e,t,r){return t.slice(-4)===".bin"?wU(e,r):yU(e,r)}function B$(e,t,r){return t.slice(-4)===".bin"?UV(e,r):FV(e,r)}function $$(e,t,r){return t.slice(-4)===".bin"?RV(e):NV(e)}function W$(e,t,r,n){return r.slice(-4)===".bin"?PV(e,t,r,n):void 0}function z$(e,t,r){return t.slice(-4)===".bin"?bV(e,t,r):IV(e,t,r)}var pI=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,gI=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function is(e,t){var r=e.split(/\s+/),n=[];if(n[0]=r[0],r.length===1)return n;var s=e.match(pI),a,i,o,l;if(s)for(l=0;l!=s.length;++l)a=s[l].match(gI),(i=a[1].indexOf(":"))===-1?n[a[1]]=a[2].slice(1,a[2].length-1):(a[1].slice(0,6)==="xmlns:"?o="xmlns"+a[1].slice(6):o=a[1].slice(i+1),n[o]=a[2].slice(1,a[2].length-1));return n}function H$(e){var t=e.split(/\s+/),r={};if(t.length===1)return r;var n=e.match(pI),s,a,i,o;if(n)for(o=0;o!=n.length;++o)s=n[o].match(gI),(a=s[1].indexOf(":"))===-1?r[s[1]]=s[2].slice(1,s[2].length-1):(s[1].slice(0,6)==="xmlns:"?i="xmlns"+s[1].slice(6):i=s[1].slice(a+1),r[i]=s[2].slice(1,s[2].length-1));return r}var zc;function G$(e,t){var r=zc[e]||lt(e);return r==="General"?ao(t):es(r,t)}function K$(e,t,r,n){var s=n;switch((r[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":s=Ft(n);break;case"i2":case"int":s=parseInt(n,10);break;case"r4":case"float":s=parseFloat(n);break;case"date":case"dateTime.tz":s=yr(n);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+r[0])}e[lt(t)]=s}function q$(e,t,r){if(e.t!=="z"){if(!r||r.cellText!==!1)try{e.t==="e"?e.w=e.w||yo[e.v]:t==="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=wu(e.v):e.w=ao(e.v):e.w=G$(t||"General",e.v)}catch(a){if(r.WTF)throw a}try{var n=zc[t]||t||"General";if(r.cellNF&&(e.z=n),r.cellDates&&e.t=="n"&&Ml(n)){var s=Ui(e.v);s&&(e.t="d",e.v=new Date(s.y,s.m-1,s.d,s.H,s.M,s.S,s.u))}}catch(a){if(r.WTF)throw a}}}function X$(e,t,r){if(r.cellStyles&&t.Interior){var n=t.Interior;n.Pattern&&(n.patternType=KU[n.Pattern]||n.Pattern)}e[t.ID]=t}function Y$(e,t,r,n,s,a,i,o,l,u){var f="General",d=n.StyleID,m={};u=u||{};var p=[],x=0;for(d===void 0&&o&&(d=o.StyleID),d===void 0&&i&&(d=i.StyleID);a[d]!==void 0&&(a[d].nf&&(f=a[d].nf),a[d].Interior&&p.push(a[d].Interior),!!a[d].Parent);)d=a[d].Parent;switch(r.Type){case"Boolean":n.t="b",n.v=Ft(e);break;case"String":n.t="s",n.r=Dw(lt(e)),n.v=e.indexOf("<")>-1?lt(t||e).replace(/<.*?>/g,""):n.r;break;case"DateTime":e.slice(-1)!="Z"&&(e+="Z"),n.v=(yr(e)-new Date(Date.UTC(1899,11,30)))/(24*60*60*1e3),n.v!==n.v?n.v=lt(e):n.v<60&&(n.v=n.v-1),(!f||f=="General")&&(f="yyyy-mm-dd");case"Number":n.v===void 0&&(n.v=+e),n.t||(n.t="n");break;case"Error":n.t="e",n.v=Pb[e],u.cellText!==!1&&(n.w=e);break;default:e==""&&t==""?n.t="z":(n.t="s",n.v=Dw(t||e));break}if(q$(n,f,u),u.cellFormula!==!1)if(n.Formula){var g=lt(n.Formula);g.charCodeAt(0)==61&&(g=g.slice(1)),n.f=il(g,s),delete n.Formula,n.ArrayRange=="RC"?n.F=il("RC:RC",s):n.ArrayRange&&(n.F=il(n.ArrayRange,s),l.push([Gt(n.F),n.F]))}else for(x=0;x<l.length;++x)s.r>=l[x][0].s.r&&s.r<=l[x][0].e.r&&s.c>=l[x][0].s.c&&s.c<=l[x][0].e.c&&(n.F=l[x][1]);u.cellStyles&&(p.forEach(function(_){!m.patternType&&_.patternType&&(m.patternType=_.patternType)}),n.s=m),n.StyleID!==void 0&&(n.ixfe=n.StyleID)}function Q$(e){e.t=e.v||"",e.t=e.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.v=e.w=e.ixfe=void 0}function Tm(e,t){var r=t||{};sb();var n=gc(Tv(e));(r.type=="binary"||r.type=="array"||r.type=="base64")&&(n=St(n));var s=n.slice(0,1024).toLowerCase(),a=!1;if(s=s.replace(/".*?"/g,""),(s.indexOf(">")&1023)>Math.min(s.indexOf(",")&1023,s.indexOf(";")&1023)){var i=Ir(r);return i.type="string",ku.to_workbook(n,i)}if(s.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(yt){s.indexOf("<"+yt)>=0&&(a=!0)}),a)return iW(n,r);zc={"General Number":"General","General Date":He[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":He[15],"Short Date":He[14],"Long Time":He[19],"Medium Time":He[18],"Short Time":He[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:He[2],Standard:He[4],Percent:He[10],Scientific:He[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var o,l=[],u,f={},d=[],m=r.dense?[]:{},p="",x={},g={},_=is('<Data ss:Type="String">'),k=0,E=0,y=0,b={s:{r:2e6,c:2e6},e:{r:0,c:0}},O={},D={},v="",T=0,S=[],N={},C={},R=0,F=[],oe=[],te={},de=[],ae,X=!1,H=[],Z=[],Y={},M=0,q=0,K={Sheets:[],WBProps:{date1904:!1}},L={};Tu.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"");for(var J="";o=Tu.exec(n);)switch(o[3]=(J=o[3]).toLowerCase()){case"data":if(J=="data"){if(o[1]==="/"){if((u=l.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&l.push([o[3],!0]);break}if(l[l.length-1][1])break;o[1]==="/"?Y$(n.slice(k,o.index),v,_,l[l.length-1][0]=="comment"?te:x,{c:E,r:y},O,de[E],g,H,r):(v="",_=is(o[0]),k=o.index+o[0].length);break;case"cell":if(o[1]==="/")if(oe.length>0&&(x.c=oe),(!r.sheetRows||r.sheetRows>y)&&x.v!==void 0&&(r.dense?(m[y]||(m[y]=[]),m[y][E]=x):m[ur(E)+Nr(y)]=x),x.HRef&&(x.l={Target:lt(x.HRef)},x.HRefScreenTip&&(x.l.Tooltip=x.HRefScreenTip),delete x.HRef,delete x.HRefScreenTip),(x.MergeAcross||x.MergeDown)&&(M=E+(parseInt(x.MergeAcross,10)|0),q=y+(parseInt(x.MergeDown,10)|0),S.push({s:{c:E,r:y},e:{c:M,r:q}})),!r.sheetStubs)x.MergeAcross?E=M+1:++E;else if(x.MergeAcross||x.MergeDown){for(var fe=E;fe<=M;++fe)for(var we=y;we<=q;++we)(fe>E||we>y)&&(r.dense?(m[we]||(m[we]=[]),m[we][fe]={t:"z"}):m[ur(fe)+Nr(we)]={t:"z"});E=M+1}else++E;else x=H$(o[0]),x.Index&&(E=+x.Index-1),E<b.s.c&&(b.s.c=E),E>b.e.c&&(b.e.c=E),o[0].slice(-2)==="/>"&&++E,oe=[];break;case"row":o[1]==="/"||o[0].slice(-2)==="/>"?(y<b.s.r&&(b.s.r=y),y>b.e.r&&(b.e.r=y),o[0].slice(-2)==="/>"&&(g=is(o[0]),g.Index&&(y=+g.Index-1)),E=0,++y):(g=is(o[0]),g.Index&&(y=+g.Index-1),Y={},(g.AutoFitHeight=="0"||g.Height)&&(Y.hpx=parseInt(g.Height,10),Y.hpt=Zb(Y.hpx),Z[y]=Y),g.Hidden=="1"&&(Y.hidden=!0,Z[y]=Y));break;case"worksheet":if(o[1]==="/"){if((u=l.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"));d.push(p),b.s.r<=b.e.r&&b.s.c<=b.e.c&&(m["!ref"]=at(b),r.sheetRows&&r.sheetRows<=b.e.r&&(m["!fullref"]=m["!ref"],b.e.r=r.sheetRows-1,m["!ref"]=at(b))),S.length&&(m["!merges"]=S),de.length>0&&(m["!cols"]=de),Z.length>0&&(m["!rows"]=Z),f[p]=m}else b={s:{r:2e6,c:2e6},e:{r:0,c:0}},y=E=0,l.push([o[3],!1]),u=is(o[0]),p=lt(u.Name),m=r.dense?[]:{},S=[],H=[],Z=[],L={name:p,Hidden:0},K.Sheets.push(L);break;case"table":if(o[1]==="/"){if((u=l.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"))}else{if(o[0].slice(-2)=="/>")break;l.push([o[3],!1]),de=[],X=!1}break;case"style":o[1]==="/"?X$(O,D,r):D=is(o[0]);break;case"numberformat":D.nf=lt(is(o[0]).Format||"General"),zc[D.nf]&&(D.nf=zc[D.nf]);for(var ge=0;ge!=392&&He[ge]!=D.nf;++ge);if(ge==392){for(ge=57;ge!=392;++ge)if(He[ge]==null){Gi(D.nf,ge);break}}break;case"column":if(l[l.length-1][0]!=="table")break;if(ae=is(o[0]),ae.Hidden&&(ae.hidden=!0,delete ae.Hidden),ae.Width&&(ae.wpx=parseInt(ae.Width,10)),!X&&ae.wpx>10){X=!0,Zr=Qb;for(var pe=0;pe<de.length;++pe)de[pe]&&Al(de[pe])}X&&Al(ae),de[ae.Index-1||de.length]=ae;for(var Pe=0;Pe<+ae.Span;++Pe)de[de.length]=Ir(ae);break;case"namedrange":if(o[1]==="/")break;K.Names||(K.Names=[]);var G=je(o[0]),Xe={Name:G.Name,Ref:il(G.RefersTo.slice(1),{r:0,c:0})};K.Sheets.length>0&&(Xe.Sheet=K.Sheets.length-1),K.Names.push(Xe);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(o[0].slice(-2)==="/>")break;o[1]==="/"?v+=n.slice(T,o.index):T=o.index+o[0].length;break;case"interior":if(!r.cellStyles)break;D.Interior=is(o[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(o[0].slice(-2)==="/>")break;o[1]==="/"?F5(N,J,n.slice(R,o.index)):R=o.index+o[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(o[1]==="/"){if((u=l.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"))}else l.push([o[3],!1]);break;case"comment":if(o[1]==="/"){if((u=l.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"));Q$(te),oe.push(te)}else l.push([o[3],!1]),u=is(o[0]),te={a:u.Author};break;case"autofilter":if(o[1]==="/"){if((u=l.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"))}else if(o[0].charAt(o[0].length-2)!=="/"){var Ve=is(o[0]);m["!autofilter"]={ref:il(Ve.Range).replace(/\$/g,"")},l.push([o[3],!0])}break;case"name":break;case"datavalidation":if(o[1]==="/"){if((u=l.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&l.push([o[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(o[1]==="/"){if((u=l.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&l.push([o[3],!0]);break;case"null":break;default:if(l.length==0&&o[3]=="document"||l.length==0&&o[3]=="uof")return xE(n,r);var Ze=!0;switch(l[l.length-1][0]){case"officedocumentsettings":switch(o[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:Ze=!1}break;case"componentoptions":switch(o[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:Ze=!1}break;case"excelworkbook":switch(o[3]){case"date1904":K.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:Ze=!1}break;case"workbookoptions":switch(o[3]){case"owcversion":break;case"height":break;case"width":break;default:Ze=!1}break;case"worksheetoptions":switch(o[3]){case"visible":if(o[0].slice(-2)!=="/>")if(o[1]==="/")switch(n.slice(R,o.index)){case"SheetHidden":L.Hidden=1;break;case"SheetVeryHidden":L.Hidden=2;break}else R=o.index+o[0].length;break;case"header":m["!margins"]||Wc(m["!margins"]={},"xlml"),isNaN(+je(o[0]).Margin)||(m["!margins"].header=+je(o[0]).Margin);break;case"footer":m["!margins"]||Wc(m["!margins"]={},"xlml"),isNaN(+je(o[0]).Margin)||(m["!margins"].footer=+je(o[0]).Margin);break;case"pagemargins":var Oe=je(o[0]);m["!margins"]||Wc(m["!margins"]={},"xlml"),isNaN(+Oe.Top)||(m["!margins"].top=+Oe.Top),isNaN(+Oe.Left)||(m["!margins"].left=+Oe.Left),isNaN(+Oe.Right)||(m["!margins"].right=+Oe.Right),isNaN(+Oe.Bottom)||(m["!margins"].bottom=+Oe.Bottom);break;case"displayrighttoleft":K.Views||(K.Views=[]),K.Views[0]||(K.Views[0]={}),K.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":m["!outline"]||(m["!outline"]={}),m["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":m["!outline"]||(m["!outline"]={}),m["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:Ze=!1}break;case"pivottable":case"pivotcache":switch(o[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:Ze=!1}break;case"pagebreaks":switch(o[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:Ze=!1}break;case"autofilter":switch(o[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:Ze=!1}break;case"querytable":switch(o[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:Ze=!1}break;case"datavalidation":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:Ze=!1}break;case"sorting":case"conditionalformatting":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:Ze=!1}break;case"mapinfo":case"schema":case"data":switch(o[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:Ze=!1}break;case"smarttags":break;default:Ze=!1;break}if(Ze||o[3].match(/!\[CDATA/))break;if(!l[l.length-1][1])throw"Unrecognized tag: "+o[3]+"|"+l.join("|");if(l[l.length-1][0]==="customdocumentproperties"){if(o[0].slice(-2)==="/>")break;o[1]==="/"?K$(C,J,F,n.slice(R,o.index)):(F=o,R=o.index+o[0].length);break}if(r.WTF)throw"Unrecognized tag: "+o[3]+"|"+l.join("|")}var Se={};return!r.bookSheets&&!r.bookProps&&(Se.Sheets=f),Se.SheetNames=d,Se.Workbook=K,Se.SSF=Ir(He),Se.Props=N,Se.Custprops=C,Se}function sg(e,t){switch(Lv(t=t||{}),t.type||"base64"){case"base64":return Tm(Mn(e),t);case"binary":case"buffer":case"file":return Tm(e,t);case"array":return Tm(go(e),t)}}function J$(e){var t={},r=e.content;if(r.l=28,t.AnsiUserType=r.read_shift(0,"lpstr-ansi"),t.AnsiClipboardFormat=h5(r),r.length-r.l<=4)return t;var n=r.read_shift(4);if(n==0||n>40||(r.l-=4,t.Reserved1=r.read_shift(0,"lpstr-ansi"),r.length-r.l<=4)||(n=r.read_shift(4),n!==1907505652)||(t.UnicodeClipboardFormat=d5(r),n=r.read_shift(4),n==0||n>40))return t;r.l-=4,t.Reserved2=r.read_shift(0,"lpwstr")}var Z$=[60,1084,2066,2165,2175];function eW(e,t,r,n,s){var a=n,i=[],o=r.slice(r.l,r.l+a);if(s&&s.enc&&s.enc.insitu&&o.length>0)switch(e){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:s.enc.insitu(o)}i.push(o),r.l+=a;for(var l=la(r,r.l),u=ag[l],f=0;u!=null&&Z$.indexOf(l)>-1;)a=la(r,r.l+2),f=r.l+4,l==2066?f+=4:(l==2165||l==2175)&&(f+=12),o=r.slice(f,r.l+4+a),i.push(o),r.l+=4+a,u=ag[l=la(r,r.l)];var d=Ha(i);kr(d,0);var m=0;d.lens=[];for(var p=0;p<i.length;++p)d.lens.push(m),m+=i[p].length;if(d.length<n)throw"XLS Record 0x"+e.toString(16)+" Truncated: "+d.length+" < "+n;return t.f(d,d.length,s)}function Ns(e,t,r){if(e.t!=="z"&&e.XF){var n=0;try{n=e.z||e.XF.numFmtId||0,t.cellNF&&(e.z=He[n])}catch(a){if(t.WTF)throw a}if(!t||t.cellText!==!1)try{e.t==="e"?e.w=e.w||yo[e.v]:n===0||n=="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=wu(e.v):e.w=ao(e.v):e.w=es(n,e.v,{date1904:!!r,dateNF:t&&t.dateNF})}catch(a){if(t.WTF)throw a}if(t.cellDates&&n&&e.t=="n"&&Ml(He[n]||String(n))){var s=Ui(e.v);s&&(e.t="d",e.v=new Date(s.y,s.m-1,s.d,s.H,s.M,s.S,s.u))}}}function Jf(e,t,r){return{v:e,ixfe:t,t:r}}function tW(e,t){var r={opts:{}},n={},s=t.dense?[]:{},a={},i={},o=null,l=[],u="",f={},d,m="",p,x,g,_,k={},E=[],y,b,O=[],D=[],v={Sheets:[],WBProps:{date1904:!1},Views:[{}]},T={},S=function(Be){return Be<8?Ki[Be]:Be<64&&D[Be-8]||Ki[Be]},N=function(Be,wt,Jt){var ft=wt.XF.data;if(!(!ft||!ft.patternType||!Jt||!Jt.cellStyles)){wt.s={},wt.s.patternType=ft.patternType;var Tn;(Tn=Su(S(ft.icvFore)))&&(wt.s.fgColor={rgb:Tn}),(Tn=Su(S(ft.icvBack)))&&(wt.s.bgColor={rgb:Tn})}},C=function(Be,wt,Jt){if(!(Y>1)&&!(Jt.sheetRows&&Be.r>=Jt.sheetRows)){if(Jt.cellStyles&&wt.XF&&wt.XF.data&&N(Be,wt,Jt),delete wt.ixfe,delete wt.XF,d=Be,m=We(Be),(!i||!i.s||!i.e)&&(i={s:{r:0,c:0},e:{r:0,c:0}}),Be.r<i.s.r&&(i.s.r=Be.r),Be.c<i.s.c&&(i.s.c=Be.c),Be.r+1>i.e.r&&(i.e.r=Be.r+1),Be.c+1>i.e.c&&(i.e.c=Be.c+1),Jt.cellFormula&&wt.f){for(var ft=0;ft<E.length;++ft)if(!(E[ft][0].s.c>Be.c||E[ft][0].s.r>Be.r)&&!(E[ft][0].e.c<Be.c||E[ft][0].e.r<Be.r)){wt.F=at(E[ft][0]),(E[ft][0].s.c!=Be.c||E[ft][0].s.r!=Be.r)&&delete wt.f,wt.f&&(wt.f=""+Ur(E[ft][1],i,Be,H,R));break}}Jt.dense?(s[Be.r]||(s[Be.r]=[]),s[Be.r][Be.c]=wt):s[m]=wt}},R={enc:!1,sbcch:0,snames:[],sharedf:k,arrayf:E,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!t&&!!t.cellStyles,WTF:!!t&&!!t.wtf};t.password&&(R.password=t.password);var F,oe=[],te=[],de=[],ae=[],X=!1,H=[];H.SheetNames=R.snames,H.sharedf=R.sharedf,H.arrayf=R.arrayf,H.names=[],H.XTI=[];var Z=0,Y=0,M=0,q=[],K=[],L;R.codepage=1200,ps(1200);for(var J=!1;e.l<e.length-1;){var fe=e.l,we=e.read_shift(2);if(we===0&&Z===10)break;var ge=e.l===e.length?0:e.read_shift(2),pe=ag[we];if(pe&&pe.f){if(t.bookSheets&&Z===133&&we!==133)break;if(Z=we,pe.r===2||pe.r==12){var Pe=e.read_shift(2);if(ge-=2,!R.enc&&Pe!==we&&((Pe&255)<<8|Pe>>8)!==we)throw new Error("rt mismatch: "+Pe+"!="+we);pe.r==12&&(e.l+=10,ge-=10)}var G={};if(we===10?G=pe.f(e,ge,R):G=eW(we,pe,e,ge,R),Y==0&&[9,521,1033,2057].indexOf(Z)===-1)continue;switch(we){case 34:r.opts.Date1904=v.WBProps.date1904=G;break;case 134:r.opts.WriteProtect=!0;break;case 47:if(R.enc||(e.l=0),R.enc=G,!t.password)throw new Error("File is password-protected");if(G.valid==null)throw new Error("Encryption scheme unsupported");if(!G.valid)throw new Error("Password is incorrect");break;case 92:R.lastuser=G;break;case 66:var Xe=Number(G);switch(Xe){case 21010:Xe=1200;break;case 32768:Xe=1e4;break;case 32769:Xe=1252;break}ps(R.codepage=Xe),J=!0;break;case 317:R.rrtabid=G;break;case 25:R.winlocked=G;break;case 439:r.opts.RefreshAll=G;break;case 12:r.opts.CalcCount=G;break;case 16:r.opts.CalcDelta=G;break;case 17:r.opts.CalcIter=G;break;case 13:r.opts.CalcMode=G;break;case 14:r.opts.CalcPrecision=G;break;case 95:r.opts.CalcSaveRecalc=G;break;case 15:R.CalcRefMode=G;break;case 2211:r.opts.FullCalc=G;break;case 129:G.fDialog&&(s["!type"]="dialog"),G.fBelow||((s["!outline"]||(s["!outline"]={})).above=!0),G.fRight||((s["!outline"]||(s["!outline"]={})).left=!0);break;case 224:O.push(G);break;case 430:H.push([G]),H[H.length-1].XTI=[];break;case 35:case 547:H[H.length-1].push(G);break;case 24:case 536:L={Name:G.Name,Ref:Ur(G.rgce,i,null,H,R)},G.itab>0&&(L.Sheet=G.itab-1),H.names.push(L),H[0]||(H[0]=[],H[0].XTI=[]),H[H.length-1].push(G),G.Name=="_xlnm._FilterDatabase"&&G.itab>0&&G.rgce&&G.rgce[0]&&G.rgce[0][0]&&G.rgce[0][0][0]=="PtgArea3d"&&(K[G.itab-1]={ref:at(G.rgce[0][0][1][2])});break;case 22:R.ExternCount=G;break;case 23:H.length==0&&(H[0]=[],H[0].XTI=[]),H[H.length-1].XTI=H[H.length-1].XTI.concat(G),H.XTI=H.XTI.concat(G);break;case 2196:if(R.biff<8)break;L!=null&&(L.Comment=G[1]);break;case 18:s["!protect"]=G;break;case 19:G!==0&&R.WTF&&console.error("Password verifier: "+G);break;case 133:a[G.pos]=G,R.snames.push(G.name);break;case 10:{if(--Y)break;if(i.e){if(i.e.r>0&&i.e.c>0){if(i.e.r--,i.e.c--,s["!ref"]=at(i),t.sheetRows&&t.sheetRows<=i.e.r){var Ve=i.e.r;i.e.r=t.sheetRows-1,s["!fullref"]=s["!ref"],s["!ref"]=at(i),i.e.r=Ve}i.e.r++,i.e.c++}oe.length>0&&(s["!merges"]=oe),te.length>0&&(s["!objects"]=te),de.length>0&&(s["!cols"]=de),ae.length>0&&(s["!rows"]=ae),v.Sheets.push(T)}u===""?f=s:n[u]=s,s=t.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(R.biff===8&&(R.biff={9:2,521:3,1033:4}[we]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[G.BIFFVer]||8),R.biffguess=G.BIFFVer==0,G.BIFFVer==0&&G.dt==4096&&(R.biff=5,J=!0,ps(R.codepage=28591)),R.biff==8&&G.BIFFVer==0&&G.dt==16&&(R.biff=2),Y++)break;if(s=t.dense?[]:{},R.biff<8&&!J&&(J=!0,ps(R.codepage=t.codepage||1252)),R.biff<5||G.BIFFVer==0&&G.dt==4096){u===""&&(u="Sheet1"),i={s:{r:0,c:0},e:{r:0,c:0}};var Ze={pos:e.l-ge,name:u};a[Ze.pos]=Ze,R.snames.push(u)}else u=(a[fe]||{name:""}).name;G.dt==32&&(s["!type"]="chart"),G.dt==64&&(s["!type"]="macro"),oe=[],te=[],R.arrayf=E=[],de=[],ae=[],X=!1,T={Hidden:(a[fe]||{hs:0}).hs,name:u}}break;case 515:case 3:case 2:s["!type"]=="chart"&&(t.dense?(s[G.r]||[])[G.c]:s[We({c:G.c,r:G.r})])&&++G.c,y={ixfe:G.ixfe,XF:O[G.ixfe]||{},v:G.val,t:"n"},M>0&&(y.z=q[y.ixfe>>8&63]),Ns(y,t,r.opts.Date1904),C({c:G.c,r:G.r},y,t);break;case 5:case 517:y={ixfe:G.ixfe,XF:O[G.ixfe],v:G.val,t:G.t},M>0&&(y.z=q[y.ixfe>>8&63]),Ns(y,t,r.opts.Date1904),C({c:G.c,r:G.r},y,t);break;case 638:y={ixfe:G.ixfe,XF:O[G.ixfe],v:G.rknum,t:"n"},M>0&&(y.z=q[y.ixfe>>8&63]),Ns(y,t,r.opts.Date1904),C({c:G.c,r:G.r},y,t);break;case 189:for(var Oe=G.c;Oe<=G.C;++Oe){var Se=G.rkrec[Oe-G.c][0];y={ixfe:Se,XF:O[Se],v:G.rkrec[Oe-G.c][1],t:"n"},M>0&&(y.z=q[y.ixfe>>8&63]),Ns(y,t,r.opts.Date1904),C({c:Oe,r:G.r},y,t)}break;case 6:case 518:case 1030:{if(G.val=="String"){o=G;break}if(y=Jf(G.val,G.cell.ixfe,G.tt),y.XF=O[y.ixfe],t.cellFormula){var yt=G.formula;if(yt&&yt[0]&&yt[0][0]&&yt[0][0][0]=="PtgExp"){var Qt=yt[0][0][1][0],dr=yt[0][0][1][1],cn=We({r:Qt,c:dr});k[cn]?y.f=""+Ur(G.formula,i,G.cell,H,R):y.F=((t.dense?(s[Qt]||[])[dr]:s[cn])||{}).F}else y.f=""+Ur(G.formula,i,G.cell,H,R)}M>0&&(y.z=q[y.ixfe>>8&63]),Ns(y,t,r.opts.Date1904),C(G.cell,y,t),o=G}break;case 7:case 519:if(o)o.val=G,y=Jf(G,o.cell.ixfe,"s"),y.XF=O[y.ixfe],t.cellFormula&&(y.f=""+Ur(o.formula,i,o.cell,H,R)),M>0&&(y.z=q[y.ixfe>>8&63]),Ns(y,t,r.opts.Date1904),C(o.cell,y,t),o=null;else throw new Error("String record expects Formula");break;case 33:case 545:{E.push(G);var Gs=We(G[0].s);if(p=t.dense?(s[G[0].s.r]||[])[G[0].s.c]:s[Gs],t.cellFormula&&p){if(!o||!Gs||!p)break;p.f=""+Ur(G[1],i,G[0],H,R),p.F=at(G[0])}}break;case 1212:{if(!t.cellFormula)break;if(m){if(!o)break;k[We(o.cell)]=G[0],p=t.dense?(s[o.cell.r]||[])[o.cell.c]:s[We(o.cell)],(p||{}).f=""+Ur(G[0],i,d,H,R)}}break;case 253:y=Jf(l[G.isst].t,G.ixfe,"s"),l[G.isst].h&&(y.h=l[G.isst].h),y.XF=O[y.ixfe],M>0&&(y.z=q[y.ixfe>>8&63]),Ns(y,t,r.opts.Date1904),C({c:G.c,r:G.r},y,t);break;case 513:t.sheetStubs&&(y={ixfe:G.ixfe,XF:O[G.ixfe],t:"z"},M>0&&(y.z=q[y.ixfe>>8&63]),Ns(y,t,r.opts.Date1904),C({c:G.c,r:G.r},y,t));break;case 190:if(t.sheetStubs)for(var un=G.c;un<=G.C;++un){var At=G.ixfe[un-G.c];y={ixfe:At,XF:O[At],t:"z"},M>0&&(y.z=q[y.ixfe>>8&63]),Ns(y,t,r.opts.Date1904),C({c:un,r:G.r},y,t)}break;case 214:case 516:case 4:y=Jf(G.val,G.ixfe,"s"),y.XF=O[y.ixfe],M>0&&(y.z=q[y.ixfe>>8&63]),Ns(y,t,r.opts.Date1904),C({c:G.c,r:G.r},y,t);break;case 0:case 512:Y===1&&(i=G);break;case 252:l=G;break;case 1054:if(R.biff==4){q[M++]=G[1];for(var mr=0;mr<M+163&&He[mr]!=G[1];++mr);mr>=163&&Gi(G[1],M+163)}else Gi(G[1],G[0]);break;case 30:{q[M++]=G;for(var _t=0;_t<M+163&&He[_t]!=G;++_t);_t>=163&&Gi(G,M+163)}break;case 229:oe=oe.concat(G);break;case 93:te[G.cmo[0]]=R.lastobj=G;break;case 438:R.lastobj.TxO=G;break;case 127:R.lastobj.ImData=G;break;case 440:for(_=G[0].s.r;_<=G[0].e.r;++_)for(g=G[0].s.c;g<=G[0].e.c;++g)p=t.dense?(s[_]||[])[g]:s[We({c:g,r:_})],p&&(p.l=G[1]);break;case 2048:for(_=G[0].s.r;_<=G[0].e.r;++_)for(g=G[0].s.c;g<=G[0].e.c;++g)p=t.dense?(s[_]||[])[g]:s[We({c:g,r:_})],p&&p.l&&(p.l.Tooltip=G[1]);break;case 28:{if(R.biff<=5&&R.biff>=2)break;p=t.dense?(s[G[0].r]||[])[G[0].c]:s[We(G[0])];var bt=te[G[2]];p||(t.dense?(s[G[0].r]||(s[G[0].r]=[]),p=s[G[0].r][G[0].c]={t:"z"}):p=s[We(G[0])]={t:"z"},i.e.r=Math.max(i.e.r,G[0].r),i.s.r=Math.min(i.s.r,G[0].r),i.e.c=Math.max(i.e.c,G[0].c),i.s.c=Math.min(i.s.c,G[0].c)),p.c||(p.c=[]),x={a:G[1],t:bt.TxO.t},p.c.push(x)}break;case 2173:TV(O[G.ixfe],G.ext);break;case 125:{if(!R.cellStyles)break;for(;G.e>=G.s;)de[G.e--]={width:G.w/256,level:G.level||0,hidden:!!(G.flags&1)},X||(X=!0,Dv(G.w/256)),Al(de[G.e+1])}break;case 520:{var mt={};G.level!=null&&(ae[G.r]=mt,mt.level=G.level),G.hidden&&(ae[G.r]=mt,mt.hidden=!0),G.hpt&&(ae[G.r]=mt,mt.hpt=G.hpt,mt.hpx=Au(G.hpt))}break;case 38:case 39:case 40:case 41:s["!margins"]||Wc(s["!margins"]={}),s["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[we]]=G;break;case 161:s["!margins"]||Wc(s["!margins"]={}),s["!margins"].header=G.header,s["!margins"].footer=G.footer;break;case 574:G.RTL&&(v.Views[0].RTL=!0);break;case 146:D=G;break;case 2198:F=G;break;case 140:b=G;break;case 442:u?T.CodeName=G||T.name:v.WBProps.CodeName=G||"ThisWorkbook";break}}else pe||console.error("Missing Info for XLS Record 0x"+we.toString(16)),e.l+=ge}return r.SheetNames=$s(a).sort(function(jt,Be){return Number(jt)-Number(Be)}).map(function(jt){return a[jt].name}),t.bookSheets||(r.Sheets=n),!r.SheetNames.length&&f["!ref"]?(r.SheetNames.push("Sheet1"),r.Sheets&&(r.Sheets.Sheet1=f)):r.Preamble=f,r.Sheets&&K.forEach(function(jt,Be){r.Sheets[r.SheetNames[Be]]["!autofilter"]=jt}),r.Strings=l,r.SSF=Ir(He),R.enc&&(r.Encryption=R.enc),F&&(r.Themes=F),r.Metadata={},b!==void 0&&(r.Metadata.Country=b),H.names.length>0&&(v.Names=H.names),r.Workbook=v,r}var hE={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function rW(e,t,r){var n=st.find(e,"/!DocumentSummaryInformation");if(n&&n.size>0)try{var s=Xw(n,y5,hE.DSI);for(var a in s)t[a]=s[a]}catch(u){if(r.WTF)throw u}var i=st.find(e,"/!SummaryInformation");if(i&&i.size>0)try{var o=Xw(i,_5,hE.SI);for(var l in o)t[l]==null&&(t[l]=o[l])}catch(u){if(r.WTF)throw u}t.HeadingPairs&&t.TitlesOfParts&&(Fb(t.HeadingPairs,t.TitlesOfParts,t,r),delete t.HeadingPairs,delete t.TitlesOfParts)}function xI(e,t){t||(t={}),Lv(t),GA(),t.codepage&&gv(t.codepage);var r,n;if(e.FullPaths){if(st.find(e,"/encryption"))throw new Error("File is password-protected");r=st.find(e,"!CompObj"),n=st.find(e,"/Workbook")||st.find(e,"/Book")}else{switch(t.type){case"base64":e=ms(Mn(e));break;case"binary":e=ms(e);break;case"buffer":break;case"array":Array.isArray(e)||(e=Array.prototype.slice.call(e));break}kr(e,0),n={content:e}}var s,a;if(r&&J$(r),t.bookProps&&!t.bookSheets)s={};else{var i=tt?"buffer":"array";if(n&&n.content)s=tW(n.content,t);else if((a=st.find(e,"PerfectOffice_MAIN"))&&a.content)s=Bc.to_workbook(a.content,(t.type=i,t));else if((a=st.find(e,"NativeContent_MAIN"))&&a.content)s=Bc.to_workbook(a.content,(t.type=i,t));else throw(a=st.find(e,"MN0"))&&a.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");t.bookVBA&&e.FullPaths&&st.find(e,"/_VBA_PROJECT_CUR/VBA/dir")&&(s.vbaraw=BV(e))}var o={};return e.FullPaths&&rW(e,o,t),s.Props=s.Custprops=o,t.bookFiles&&(s.cfb=e),s}var Sd={0:{f:j7},1:{f:B7},2:{f:Y7},3:{f:H7},4:{f:W7},5:{f:X7},6:{f:Z7},7:{f:K7},8:{f:s$},9:{f:n$},10:{f:t$},11:{f:r$},12:{f:$7},13:{f:Q7},14:{f:G7},15:{f:z7},16:{f:hI},17:{f:e$},18:{f:q7},19:{f:bv},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:R$},40:{},42:{},43:{f:tV},44:{f:eV},45:{f:rV},46:{f:sV},47:{f:nV},48:{},49:{f:a5},50:{},51:{f:SV},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:Gb},62:{f:J7},63:{f:CV},64:{f:d$},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:qr,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:h$},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:V7},148:{f:L7,p:16},151:{f:o$},152:{},153:{f:N$},154:{},155:{},156:{f:I$},157:{},158:{},159:{T:1,f:_U},160:{T:-1},161:{T:1,f:vo},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:a$},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:kV},336:{T:-1},337:{f:AV,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:eg},357:{},358:{},359:{},360:{T:1},361:{},362:{f:Hb},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:l$},427:{f:c$},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:f$},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:U7},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:i$},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:eg},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:LV},633:{T:1},634:{T:-1},635:{T:1,f:jV},636:{T:-1},637:{f:o5},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:y$},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:m$},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},ag={6:{f:wm},10:{f:Oa},12:{f:rr},13:{f:rr},14:{f:qt},15:{f:qt},16:{f:$r},17:{f:qt},18:{f:qt},19:{f:rr},20:{f:Zw},21:{f:Zw},23:{f:Hb},24:{f:tE},25:{f:qt},26:{},27:{},28:{f:O9},29:{},34:{f:qt},35:{f:eE},38:{f:$r},39:{f:$r},40:{f:$r},41:{f:$r},42:{f:qt},43:{f:qt},47:{f:UU},49:{f:g9},51:{f:rr},60:{},61:{f:d9},64:{f:qt},65:{f:p9},66:{f:rr},77:{},80:{},81:{},82:{},85:{f:rr},89:{},90:{},91:{},92:{f:a9},93:{f:j9},94:{},95:{f:qt},96:{},97:{},99:{f:qt},125:{f:Gb},128:{f:A9},129:{f:i9},130:{f:rr},131:{f:qt},132:{f:qt},133:{f:o9},134:{},140:{f:W9},141:{f:rr},144:{},146:{f:H9},151:{},152:{},153:{},154:{},155:{},156:{f:rr},157:{},158:{},160:{f:Y9},161:{f:K9},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:E9},190:{f:T9},193:{f:Oa},197:{},198:{},199:{},200:{},201:{},202:{f:qt},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:rr},220:{},221:{f:qt},222:{},224:{f:S9},225:{f:s9},226:{f:Oa},227:{},229:{f:M9},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:l9},253:{f:x9},255:{f:c9},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:Ub},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:qt},353:{f:Oa},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:I9},431:{f:qt},432:{},433:{},434:{},437:{},438:{f:V9},439:{f:qt},440:{f:B9},441:{},442:{f:rf},443:{},444:{f:rr},445:{},446:{},448:{f:Oa},449:{f:h9,r:2},450:{f:Oa},512:{f:Qw},513:{f:X9},515:{f:b9},516:{f:v9},517:{f:Jw},519:{f:Q9},520:{f:u9},523:{},545:{f:rE},549:{f:Yw},566:{},574:{f:m9},638:{f:w9},659:{},1048:{},1054:{f:y9},1084:{},1212:{f:P9},2048:{f:$9},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:Xf},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:Oa},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:G9,r:12},2173:{f:EV,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:qt,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:R9,r:12},2197:{},2198:{f:gV,r:12},2199:{},2200:{},2201:{},2202:{f:D9,r:12},2203:{f:Oa},2204:{},2205:{},2206:{},2207:{},2211:{f:f9},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:rr},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:q9},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:z9},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:Qw},1:{},2:{f:tU},3:{f:eU},4:{f:Z9},5:{f:Jw},7:{f:rU},8:{},9:{f:Xf},11:{},22:{f:rr},30:{f:_9},31:{},32:{},33:{f:rE},36:{},37:{f:Yw},50:{f:nU},62:{},52:{},67:{},68:{f:rr},69:{},86:{},126:{},127:{f:J9},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:sU},223:{},234:{},354:{},421:{},518:{f:wm},521:{f:Xf},536:{f:tE},547:{f:eE},561:{},579:{},1030:{f:wm},1033:{f:Xf},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function os(e,t,r,n){var s=t;if(!isNaN(s)){var a=(r||[]).length||0,i=e.next(4);i.write_shift(2,s),i.write_shift(2,a),a>0&&Ab(r)&&e.push(r)}}function dE(e,t){var r=t||{},n=r.dense?[]:{};e=e.replace(/<!--.*?-->/g,"");var s=e.match(/<table/i);if(!s)throw new Error("Invalid HTML: could not find <table>");var a=e.match(/<\/table/i),i=s.index,o=a&&a.index||e.length,l=b8(e.slice(i,o),/(:?<tr[^>]*>)/i,"<tr>"),u=-1,f=0,d=0,m=0,p={s:{r:1e7,c:1e7},e:{r:0,c:0}},x=[];for(i=0;i<l.length;++i){var g=l[i].trim(),_=g.slice(0,3).toLowerCase();if(_=="<tr"){if(++u,r.sheetRows&&r.sheetRows<=u){--u;break}f=0;continue}if(!(_!="<td"&&_!="<th")){var k=g.split(/<\/t[dh]>/i);for(o=0;o<k.length;++o){var E=k[o].trim();if(E.match(/<t[dh]/i)){for(var y=E,b=0;y.charAt(0)=="<"&&(b=y.indexOf(">"))>-1;)y=y.slice(b+1);for(var O=0;O<x.length;++O){var D=x[O];D.s.c==f&&D.s.r<u&&u<=D.e.r&&(f=D.e.c+1,O=-1)}var v=je(E.slice(0,E.indexOf(">")));m=v.colspan?+v.colspan:1,((d=+v.rowspan)>1||m>1)&&x.push({s:{r:u,c:f},e:{r:u+(d||1)-1,c:f+m-1}});var T=v.t||v["data-t"]||"";if(!y.length){f+=m;continue}if(y=db(y),p.s.r>u&&(p.s.r=u),p.e.r<u&&(p.e.r=u),p.s.c>f&&(p.s.c=f),p.e.c<f&&(p.e.c=f),!y.length){f+=m;continue}var S={t:"s",v:y};r.raw||!y.trim().length||T=="s"||(y==="TRUE"?S={t:"b",v:!0}:y==="FALSE"?S={t:"b",v:!1}:isNaN(_s(y))?isNaN(Sl(y).getDate())||(S={t:"d",v:yr(y)},r.cellDates||(S={t:"n",v:sn(S.v)}),S.z=r.dateNF||He[14]):S={t:"n",v:_s(y)}),r.dense?(n[u]||(n[u]=[]),n[u][f]=S):n[We({r:u,c:f})]=S,f+=m}}}}return n["!ref"]=at(p),x.length&&(n["!merges"]=x),n}function nW(e,t,r,n){for(var s=e["!merges"]||[],a=[],i=t.s.c;i<=t.e.c;++i){for(var o=0,l=0,u=0;u<s.length;++u)if(!(s[u].s.r>r||s[u].s.c>i)&&!(s[u].e.r<r||s[u].e.c<i)){if(s[u].s.r<r||s[u].s.c<i){o=-1;break}o=s[u].e.r-s[u].s.r+1,l=s[u].e.c-s[u].s.c+1;break}if(!(o<0)){var f=We({r,c:i}),d=n.dense?(e[r]||[])[i]:e[f],m=d&&d.v!=null&&(d.h||Ev(d.w||(Sa(d),d.w)||""))||"",p={};o>1&&(p.rowspan=o),l>1&&(p.colspan=l),n.editable?m='<span contenteditable="true">'+m+"</span>":d&&(p["data-t"]=d&&d.t||"z",d.v!=null&&(p["data-v"]=d.v),d.z!=null&&(p["data-z"]=d.z),d.l&&(d.l.Target||"#").charAt(0)!="#"&&(m='<a href="'+d.l.Target+'">'+m+"</a>")),p.id=(n.id||"sjs")+"-"+f,a.push(W8("td",m,p))}}var x="<tr>";return x+a.join("")+"</tr>"}var sW='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',aW="</body></html>";function iW(e,t){var r=e.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!r||r.length==0)throw new Error("Invalid HTML: could not find <table>");if(r.length==1)return ki(dE(r[0],t),t);var n=Vv();return r.forEach(function(s,a){Bv(n,dE(s,t),"Sheet"+(a+1))}),n}function oW(e,t,r){var n=[];return n.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function lW(e,t){var r=t||{},n=r.header!=null?r.header:sW,s=r.footer!=null?r.footer:aW,a=[n],i=jl(e["!ref"]);r.dense=Array.isArray(e),a.push(oW(e,i,r));for(var o=i.s.r;o<=i.e.r;++o)a.push(nW(e,i,o,r));return a.push("</table>"+s),a.join("")}function vI(e,t,r){var n=r||{},s=0,a=0;if(n.origin!=null)if(typeof n.origin=="number")s=n.origin;else{var i=typeof n.origin=="string"?en(n.origin):n.origin;s=i.r,a=i.c}var o=t.getElementsByTagName("tr"),l=Math.min(n.sheetRows||1e7,o.length),u={s:{r:0,c:0},e:{r:s,c:a}};if(e["!ref"]){var f=jl(e["!ref"]);u.s.r=Math.min(u.s.r,f.s.r),u.s.c=Math.min(u.s.c,f.s.c),u.e.r=Math.max(u.e.r,f.e.r),u.e.c=Math.max(u.e.c,f.e.c),s==-1&&(u.e.r=s=f.e.r+1)}var d=[],m=0,p=e["!rows"]||(e["!rows"]=[]),x=0,g=0,_=0,k=0,E=0,y=0;for(e["!cols"]||(e["!cols"]=[]);x<o.length&&g<l;++x){var b=o[x];if(mE(b)){if(n.display)continue;p[g]={hidden:!0}}var O=b.children;for(_=k=0;_<O.length;++_){var D=O[_];if(!(n.display&&mE(D))){var v=D.hasAttribute("data-v")?D.getAttribute("data-v"):D.hasAttribute("v")?D.getAttribute("v"):db(D.innerHTML),T=D.getAttribute("data-z")||D.getAttribute("z");for(m=0;m<d.length;++m){var S=d[m];S.s.c==k+a&&S.s.r<g+s&&g+s<=S.e.r&&(k=S.e.c+1-a,m=-1)}y=+D.getAttribute("colspan")||1,((E=+D.getAttribute("rowspan")||1)>1||y>1)&&d.push({s:{r:g+s,c:k+a},e:{r:g+s+(E||1)-1,c:k+a+(y||1)-1}});var N={t:"s",v},C=D.getAttribute("data-t")||D.getAttribute("t")||"";v!=null&&(v.length==0?N.t=C||"z":n.raw||v.trim().length==0||C=="s"||(v==="TRUE"?N={t:"b",v:!0}:v==="FALSE"?N={t:"b",v:!1}:isNaN(_s(v))?isNaN(Sl(v).getDate())||(N={t:"d",v:yr(v)},n.cellDates||(N={t:"n",v:sn(N.v)}),N.z=n.dateNF||He[14]):N={t:"n",v:_s(v)})),N.z===void 0&&T!=null&&(N.z=T);var R="",F=D.getElementsByTagName("A");if(F&&F.length)for(var oe=0;oe<F.length&&!(F[oe].hasAttribute("href")&&(R=F[oe].getAttribute("href"),R.charAt(0)!="#"));++oe);R&&R.charAt(0)!="#"&&(N.l={Target:R}),n.dense?(e[g+s]||(e[g+s]=[]),e[g+s][k+a]=N):e[We({c:k+a,r:g+s})]=N,u.e.c<k+a&&(u.e.c=k+a),k+=y}}++g}return d.length&&(e["!merges"]=(e["!merges"]||[]).concat(d)),u.e.r=Math.max(u.e.r,g-1+s),e["!ref"]=at(u),g>=l&&(e["!fullref"]=at((u.e.r=o.length-x+g-1+s,u))),e}function yI(e,t){var r=t||{},n=r.dense?[]:{};return vI(n,e,t)}function cW(e,t){return ki(yI(e,t),t)}function mE(e){var t="",r=uW(e);return r&&(t=r(e).getPropertyValue("display")),t||(t=e.style&&e.style.display),t==="none"}function uW(e){return e.ownerDocument.defaultView&&typeof e.ownerDocument.defaultView.getComputedStyle=="function"?e.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function fW(e){var t=e.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(n,s){return Array(parseInt(s,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),r=lt(t.replace(/<[^>]*>/g,""));return[r]}var pE={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function _I(e,t){var r=t||{},n=Tv(e),s=[],a,i,o={name:""},l="",u=0,f,d,m={},p=[],x=r.dense?[]:{},g,_,k={value:""},E="",y=0,b=[],O=-1,D=-1,v={s:{r:1e6,c:1e7},e:{r:0,c:0}},T=0,S={},N=[],C={},R=0,F=0,oe=[],te=1,de=1,ae=[],X={Names:[]},H={},Z=["",""],Y=[],M={},q="",K=0,L=!1,J=!1,fe=0;for(Tu.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");g=Tu.exec(n);)switch(g[3]=g[3].replace(/_.*$/,"")){case"table":case"":g[1]==="/"?(v.e.c>=v.s.c&&v.e.r>=v.s.r?x["!ref"]=at(v):x["!ref"]="A1:A1",r.sheetRows>0&&r.sheetRows<=v.e.r&&(x["!fullref"]=x["!ref"],v.e.r=r.sheetRows-1,x["!ref"]=at(v)),N.length&&(x["!merges"]=N),oe.length&&(x["!rows"]=oe),f.name=f.||f.name,typeof JSON<"u"&&JSON.stringify(f),p.push(f.name),m[f.name]=x,J=!1):g[0].charAt(g[0].length-2)!=="/"&&(f=je(g[0],!1),O=D=-1,v.s.r=v.s.c=1e7,v.e.r=v.e.c=0,x=r.dense?[]:{},N=[],oe=[],J=!0);break;case"table-row-group":g[1]==="/"?--T:++T;break;case"table-row":case"":if(g[1]==="/"){O+=te,te=1;break}if(d=je(g[0],!1),d.?O=d.-1:O==-1&&(O=0),te=+d["number-rows-repeated"]||1,te<10)for(fe=0;fe<te;++fe)T>0&&(oe[O+fe]={level:T});D=-1;break;case"covered-table-cell":g[1]!=="/"&&++D,r.sheetStubs&&(r.dense?(x[O]||(x[O]=[]),x[O][D]={t:"z"}):x[We({r:O,c:D})]={t:"z"}),E="",b=[];break;case"table-cell":case"":if(g[0].charAt(g[0].length-2)==="/")++D,k=je(g[0],!1),de=parseInt(k["number-columns-repeated"]||"1",10),_={t:"z",v:null},k.formula&&r.cellFormula!=!1&&(_.f=cE(lt(k.formula))),(k.||k["value-type"])=="string"&&(_.t="s",_.v=lt(k["string-value"]||""),r.dense?(x[O]||(x[O]=[]),x[O][D]=_):x[We({r:O,c:D})]=_),D+=de-1;else if(g[1]!=="/"){++D,E="",y=0,b=[],de=1;var we=te?O+te-1:O;if(D>v.e.c&&(v.e.c=D),D<v.s.c&&(v.s.c=D),O<v.s.r&&(v.s.r=O),we>v.e.r&&(v.e.r=we),k=je(g[0],!1),Y=[],M={},_={t:k.||k["value-type"],v:null},r.cellFormula)if(k.formula&&(k.formula=lt(k.formula)),k["number-matrix-columns-spanned"]&&k["number-matrix-rows-spanned"]&&(R=parseInt(k["number-matrix-rows-spanned"],10)||0,F=parseInt(k["number-matrix-columns-spanned"],10)||0,C={s:{r:O,c:D},e:{r:O+R-1,c:D+F-1}},_.F=at(C),ae.push([C,_.F])),k.formula)_.f=cE(k.formula);else for(fe=0;fe<ae.length;++fe)O>=ae[fe][0].s.r&&O<=ae[fe][0].e.r&&D>=ae[fe][0].s.c&&D<=ae[fe][0].e.c&&(_.F=ae[fe][1]);switch((k["number-columns-spanned"]||k["number-rows-spanned"])&&(R=parseInt(k["number-rows-spanned"],10)||0,F=parseInt(k["number-columns-spanned"],10)||0,C={s:{r:O,c:D},e:{r:O+R-1,c:D+F-1}},N.push(C)),k["number-columns-repeated"]&&(de=parseInt(k["number-columns-repeated"],10)),_.t){case"boolean":_.t="b",_.v=Ft(k["boolean-value"]);break;case"float":_.t="n",_.v=parseFloat(k.value);break;case"percentage":_.t="n",_.v=parseFloat(k.value);break;case"currency":_.t="n",_.v=parseFloat(k.value);break;case"date":_.t="d",_.v=yr(k["date-value"]),r.cellDates||(_.t="n",_.v=sn(_.v)),_.z="m/d/yy";break;case"time":_.t="n",_.v=k8(k["time-value"])/86400,r.cellDates&&(_.t="d",_.v=v0(_.v)),_.z="HH:MM:SS";break;case"number":_.t="n",_.v=parseFloat(k.);break;default:if(_.t==="string"||_.t==="text"||!_.t)_.t="s",k["string-value"]!=null&&(E=lt(k["string-value"]),b=[]);else throw new Error("Unsupported value type "+_.t)}}else{if(L=!1,_.t==="s"&&(_.v=E||"",b.length&&(_.R=b),L=y==0),H.Target&&(_.l=H),Y.length>0&&(_.c=Y,Y=[]),E&&r.cellText!==!1&&(_.w=E),L&&(_.t="z",delete _.v),(!L||r.sheetStubs)&&!(r.sheetRows&&r.sheetRows<=O))for(var ge=0;ge<te;++ge){if(de=parseInt(k["number-columns-repeated"]||"1",10),r.dense)for(x[O+ge]||(x[O+ge]=[]),x[O+ge][D]=ge==0?_:Ir(_);--de>0;)x[O+ge][D+de]=Ir(_);else for(x[We({r:O+ge,c:D})]=_;--de>0;)x[We({r:O+ge,c:D+de})]=Ir(_);v.e.c<=D&&(v.e.c=D)}de=parseInt(k["number-columns-repeated"]||"1",10),D+=de-1,de=0,_={},E="",b=[]}H={};break;case"document":case"document-content":case"":case"spreadsheet":case"":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(g[1]==="/"){if((a=s.pop())[0]!==g[3])throw"Bad state: "+a}else g[0].charAt(g[0].length-2)!=="/"&&s.push([g[3],!0]);break;case"annotation":if(g[1]==="/"){if((a=s.pop())[0]!==g[3])throw"Bad state: "+a;M.t=E,b.length&&(M.R=b),M.a=q,Y.push(M)}else g[0].charAt(g[0].length-2)!=="/"&&s.push([g[3],!1]);q="",K=0,E="",y=0,b=[];break;case"creator":g[1]==="/"?q=n.slice(K,g.index):K=g.index+g[0].length;break;case"meta":case"":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(g[1]==="/"){if((a=s.pop())[0]!==g[3])throw"Bad state: "+a}else g[0].charAt(g[0].length-2)!=="/"&&s.push([g[3],!1]);E="",y=0,b=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(g[1]==="/"){if(S[o.name]=l,(a=s.pop())[0]!==g[3])throw"Bad state: "+a}else g[0].charAt(g[0].length-2)!=="/"&&(l="",o=je(g[0],!1),s.push([g[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(s[s.length-1][0]){case"time-style":case"date-style":i=je(g[0],!1),l+=pE[g[3]][i.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(s[s.length-1][0]){case"time-style":case"date-style":i=je(g[0],!1),l+=pE[g[3]][i.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(g[0].slice(-2)==="/>")break;if(g[1]==="/")switch(s[s.length-1][0]){case"number-style":case"date-style":case"time-style":l+=n.slice(u,g.index);break}else u=g.index+g[0].length;break;case"named-range":i=je(g[0],!1),Z=Em(i["cell-range-address"]);var pe={Name:i.name,Ref:Z[0]+"!"+Z[1]};J&&(pe.Sheet=p.length),X.Names.push(pe);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"":if(["master-styles"].indexOf(s[s.length-1][0])>-1)break;if(g[1]==="/"&&(!k||!k["string-value"])){var Pe=fW(n.slice(y,g.index));E=(E.length>0?E+`
`:"")+Pe[0]}else je(g[0],!1),y=g.index+g[0].length;break;case"s":break;case"database-range":if(g[1]==="/")break;try{Z=Em(je(g[0])["target-range-address"]),m[Z[0]]["!autofilter"]={ref:Z[1]}}catch{}break;case"date":break;case"object":break;case"title":case"":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(g[1]!=="/"){if(H=je(g[0],!1),!H.href)break;H.Target=lt(H.href),delete H.href,H.Target.charAt(0)=="#"&&H.Target.indexOf(".")>-1?(Z=Em(H.Target.slice(1)),H.Target="#"+Z[0]+"!"+Z[1]):H.Target.match(/^\.\.[\\\/]/)&&(H.Target=H.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(g[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case":":case":":break;default:if(r.WTF)throw new Error(g)}}var G={Sheets:m,SheetNames:p,Workbook:X};return r.bookSheets&&delete G.Sheets,G}function gE(e,t){t=t||{},zn(e,"META-INF/manifest.xml")&&b5(tr(e,"META-INF/manifest.xml"),t);var r=In(e,"content.xml");if(!r)throw new Error("Missing content.xml in ODS / UOF file");var n=_I(St(r),t);return zn(e,"meta.xml")&&(n.Props=Db(tr(e,"meta.xml"))),n}function xE(e,t){return _I(e,t)}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function Mv(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function ig(e){return typeof TextDecoder<"u"?new TextDecoder().decode(e):St(go(e))}function og(e){var t=e.reduce(function(s,a){return s+a.length},0),r=new Uint8Array(t),n=0;return e.forEach(function(s){r.set(s,n),n+=s.length}),r}function vE(e){return e-=e>>1&1431655765,e=(e&858993459)+(e>>2&858993459),(e+(e>>4)&252645135)*16843009>>>24}function hW(e,t){for(var r=(e[t+15]&127)<<7|e[t+14]>>1,n=e[t+14]&1,s=t+13;s>=t;--s)n=n*256+e[s];return(e[t+15]&128?-n:n)*Math.pow(10,r-6176)}function bu(e,t){var r=t?t[0]:0,n=e[r]&127;e:if(e[r++]>=128&&(n|=(e[r]&127)<<7,e[r++]<128||(n|=(e[r]&127)<<14,e[r++]<128)||(n|=(e[r]&127)<<21,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,28),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,35),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,42),++r,e[r++]<128)))break e;return t&&(t[0]=r),n}function hr(e){var t=0,r=e[t]&127;e:if(e[t++]>=128){if(r|=(e[t]&127)<<7,e[t++]<128||(r|=(e[t]&127)<<14,e[t++]<128)||(r|=(e[t]&127)<<21,e[t++]<128))break e;r|=(e[t]&127)<<28}return r}function Wr(e){for(var t=[],r=[0];r[0]<e.length;){var n=r[0],s=bu(e,r),a=s&7;s=Math.floor(s/8);var i=0,o;if(s==0)break;switch(a){case 0:{for(var l=r[0];e[r[0]++]>=128;);o=e.slice(l,r[0])}break;case 5:i=4,o=e.slice(r[0],r[0]+i),r[0]+=i;break;case 1:i=8,o=e.slice(r[0],r[0]+i),r[0]+=i;break;case 2:i=bu(e,r),o=e.slice(r[0],r[0]+i),r[0]+=i;break;case 3:case 4:default:throw new Error("PB Type ".concat(a," for Field ").concat(s," at offset ").concat(n))}var u={data:o,type:a};t[s]==null?t[s]=[u]:t[s].push(u)}return t}function jv(e,t){return(e==null?void 0:e.map(function(r){return t(r.data)}))||[]}function dW(e){for(var t,r=[],n=[0];n[0]<e.length;){var s=bu(e,n),a=Wr(e.slice(n[0],n[0]+s));n[0]+=s;var i={id:hr(a[1][0].data),messages:[]};a[2].forEach(function(o){var l=Wr(o.data),u=hr(l[3][0].data);i.messages.push({meta:l,data:e.slice(n[0],n[0]+u)}),n[0]+=u}),(t=a[3])!=null&&t[0]&&(i.merge=hr(a[3][0].data)>>>0>0),r.push(i)}return r}function mW(e,t){if(e!=0)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var r=[0],n=bu(t,r),s=[];r[0]<t.length;){var a=t[r[0]]&3;if(a==0){var i=t[r[0]++]>>2;if(i<60)++i;else{var o=i-59;i=t[r[0]],o>1&&(i|=t[r[0]+1]<<8),o>2&&(i|=t[r[0]+2]<<16),o>3&&(i|=t[r[0]+3]<<24),i>>>=0,i++,r[0]+=o}s.push(t.slice(r[0],r[0]+i)),r[0]+=i;continue}else{var l=0,u=0;if(a==1?(u=(t[r[0]]>>2&7)+4,l=(t[r[0]++]&224)<<3,l|=t[r[0]++]):(u=(t[r[0]++]>>2)+1,a==2?(l=t[r[0]]|t[r[0]+1]<<8,r[0]+=2):(l=(t[r[0]]|t[r[0]+1]<<8|t[r[0]+2]<<16|t[r[0]+3]<<24)>>>0,r[0]+=4)),s=[og(s)],l==0)throw new Error("Invalid offset 0");if(l>s[0].length)throw new Error("Invalid offset beyond length");if(u>=l)for(s.push(s[0].slice(-l)),u-=l;u>=s[s.length-1].length;)s.push(s[s.length-1]),u-=s[s.length-1].length;s.push(s[0].slice(-l,-l+u))}}var f=og(s);if(f.length!=n)throw new Error("Unexpected length: ".concat(f.length," != ").concat(n));return f}function pW(e){for(var t=[],r=0;r<e.length;){var n=e[r++],s=e[r]|e[r+1]<<8|e[r+2]<<16;r+=3,t.push(mW(n,e.slice(r,r+s))),r+=s}if(r!==e.length)throw new Error("data is not a valid framed stream!");return og(t)}function gW(e,t,r,n){var s=Mv(e),a=s.getUint32(4,!0),i=(n>1?12:8)+vE(a&(n>1?3470:398))*4,o=-1,l=-1,u=NaN,f=new Date(2001,0,1);a&512&&(o=s.getUint32(i,!0),i+=4),i+=vE(a&(n>1?12288:4096))*4,a&16&&(l=s.getUint32(i,!0),i+=4),a&32&&(u=s.getFloat64(i,!0),i+=8),a&64&&(f.setTime(f.getTime()+s.getFloat64(i,!0)*1e3),i+=8);var d;switch(e[2]){case 0:break;case 2:d={t:"n",v:u};break;case 3:d={t:"s",v:t[l]};break;case 5:d={t:"d",v:f};break;case 6:d={t:"b",v:u>0};break;case 7:d={t:"n",v:u/86400};break;case 8:d={t:"e",v:0};break;case 9:if(o>-1)d={t:"s",v:r[o]};else if(l>-1)d={t:"s",v:t[l]};else if(!isNaN(u))d={t:"n",v:u};else throw new Error("Unsupported cell type ".concat(e.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(e.slice(0,4)))}return d}function xW(e,t,r){var n=Mv(e),s=n.getUint32(8,!0),a=12,i=-1,o=-1,l=NaN,u=NaN,f=new Date(2001,0,1);s&1&&(l=hW(e,a),a+=16),s&2&&(u=n.getFloat64(a,!0),a+=8),s&4&&(f.setTime(f.getTime()+n.getFloat64(a,!0)*1e3),a+=8),s&8&&(o=n.getUint32(a,!0),a+=4),s&16&&(i=n.getUint32(a,!0),a+=4);var d;switch(e[1]){case 0:break;case 2:d={t:"n",v:l};break;case 3:d={t:"s",v:t[o]};break;case 5:d={t:"d",v:f};break;case 6:d={t:"b",v:u>0};break;case 7:d={t:"n",v:u/86400};break;case 8:d={t:"e",v:0};break;case 9:if(i>-1)d={t:"s",v:r[i]};else throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(s&31," : ").concat(e.slice(0,4)));break;case 10:d={t:"n",v:l};break;default:throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(s&31," : ").concat(e.slice(0,4)))}return d}function vW(e,t,r){switch(e[0]){case 0:case 1:case 2:case 3:return gW(e,t,r,e[0]);case 5:return xW(e,t,r);default:throw new Error("Unsupported payload version ".concat(e[0]))}}function ui(e){var t=Wr(e);return bu(t[1][0].data)}function yE(e,t){var r=Wr(t.data),n=hr(r[1][0].data),s=r[3],a=[];return(s||[]).forEach(function(i){var o=Wr(i.data),l=hr(o[1][0].data)>>>0;switch(n){case 1:a[l]=ig(o[3][0].data);break;case 8:{var u=e[ui(o[9][0].data)][0],f=Wr(u.data),d=e[ui(f[1][0].data)][0],m=hr(d.meta[1][0].data);if(m!=2001)throw new Error("2000 unexpected reference to ".concat(m));var p=Wr(d.data);a[l]=p[3].map(function(x){return ig(x.data)}).join("")}break}}),a}function yW(e,t){var r,n,s,a,i,o,l,u,f,d,m,p,x,g,_=Wr(e),k=hr(_[1][0].data)>>>0,E=hr(_[2][0].data)>>>0,y=((n=(r=_[8])==null?void 0:r[0])==null?void 0:n.data)&&hr(_[8][0].data)>0||!1,b,O;if((a=(s=_[7])==null?void 0:s[0])!=null&&a.data&&t!=0)b=(o=(i=_[7])==null?void 0:i[0])==null?void 0:o.data,O=(u=(l=_[6])==null?void 0:l[0])==null?void 0:u.data;else if((d=(f=_[4])==null?void 0:f[0])!=null&&d.data&&t!=1)b=(p=(m=_[4])==null?void 0:m[0])==null?void 0:p.data,O=(g=(x=_[3])==null?void 0:x[0])==null?void 0:g.data;else throw"NUMBERS Tile missing ".concat(t," cell storage");for(var D=y?4:1,v=Mv(b),T=[],S=0;S<b.length/2;++S){var N=v.getUint16(S*2,!0);N<65535&&T.push([S,N])}if(T.length!=E)throw"Expected ".concat(E," cells, found ").concat(T.length);var C=[];for(S=0;S<T.length-1;++S)C[T[S][0]]=O.subarray(T[S][1]*D,T[S+1][1]*D);return T.length>=1&&(C[T[T.length-1][0]]=O.subarray(T[T.length-1][1]*D)),{R:k,cells:C}}function _W(e,t){var r,n=Wr(t.data),s=(r=n==null?void 0:n[7])!=null&&r[0]?hr(n[7][0].data)>>>0>0?1:0:-1,a=jv(n[5],function(i){return yW(i,s)});return{nrows:hr(n[4][0].data)>>>0,data:a.reduce(function(i,o){return i[o.R]||(i[o.R]=[]),o.cells.forEach(function(l,u){if(i[o.R][u])throw new Error("Duplicate cell r=".concat(o.R," c=").concat(u));i[o.R][u]=l}),i},[])}}function wW(e,t,r){var n,s=Wr(t.data),a={s:{r:0,c:0},e:{r:0,c:0}};if(a.e.r=(hr(s[6][0].data)>>>0)-1,a.e.r<0)throw new Error("Invalid row varint ".concat(s[6][0].data));if(a.e.c=(hr(s[7][0].data)>>>0)-1,a.e.c<0)throw new Error("Invalid col varint ".concat(s[7][0].data));r["!ref"]=at(a);var i=Wr(s[4][0].data),o=yE(e,e[ui(i[4][0].data)][0]),l=(n=i[17])!=null&&n[0]?yE(e,e[ui(i[17][0].data)][0]):[],u=Wr(i[3][0].data),f=0;u[1].forEach(function(d){var m=Wr(d.data),p=e[ui(m[2][0].data)][0],x=hr(p.meta[1][0].data);if(x!=6002)throw new Error("6001 unexpected reference to ".concat(x));var g=_W(e,p);g.data.forEach(function(_,k){_.forEach(function(E,y){var b=We({r:f+k,c:y}),O=vW(E,o,l);O&&(r[b]=O)})}),f+=g.nrows})}function EW(e,t){var r=Wr(t.data),n={"!ref":"A1"},s=e[ui(r[2][0].data)],a=hr(s[0].meta[1][0].data);if(a!=6001)throw new Error("6000 unexpected reference to ".concat(a));return wW(e,s[0],n),n}function TW(e,t){var r,n=Wr(t.data),s={name:(r=n[1])!=null&&r[0]?ig(n[1][0].data):"",sheets:[]},a=jv(n[2],ui);return a.forEach(function(i){e[i].forEach(function(o){var l=hr(o.meta[1][0].data);l==6e3&&s.sheets.push(EW(e,o))})}),s}function kW(e,t){var r=Vv(),n=Wr(t.data),s=jv(n[1],ui);if(s.forEach(function(a){e[a].forEach(function(i){var o=hr(i.meta[1][0].data);if(o==2){var l=TW(e,i);l.sheets.forEach(function(u,f){Bv(r,u,f==0?l.name:l.name+"_"+f,!0)})}})}),r.SheetNames.length==0)throw new Error("Empty NUMBERS file");return r}function km(e){var t,r,n,s,a={},i=[];if(e.FullPaths.forEach(function(l){if(l.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),e.FileIndex.forEach(function(l){if(l.name.match(/\.iwa$/)){var u;try{u=pW(l.content)}catch(d){return console.log("?? "+l.content.length+" "+(d.message||d))}var f;try{f=dW(u)}catch(d){return console.log("## "+(d.message||d))}f.forEach(function(d){a[d.id]=d.messages,i.push(d.id)})}}),!i.length)throw new Error("File has no messages");var o=((s=(n=(r=(t=a==null?void 0:a[1])==null?void 0:t[0])==null?void 0:r.meta)==null?void 0:n[1])==null?void 0:s[0].data)&&hr(a[1][0].meta[1][0].data)==1&&a[1][0];if(o||i.forEach(function(l){a[l].forEach(function(u){var f=hr(u.meta[1][0].data)>>>0;if(f==1)if(!o)o=u;else throw new Error("Document has multiple roots")})}),!o)throw new Error("Cannot find Document root");return kW(a,o)}function SW(e){return function(r){for(var n=0;n!=e.length;++n){var s=e[n];r[s[0]]===void 0&&(r[s[0]]=s[1]),s[2]==="n"&&(r[s[0]]=Number(r[s[0]]))}}}function Lv(e){SW([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(e)}function AW(e){return Go.WS.indexOf(e)>-1?"sheet":e==Go.CS?"chart":e==Go.DS?"dialog":e==Go.MS?"macro":e&&e.length?e:"sheet"}function bW(e,t){if(!e)return 0;try{e=t.map(function(n){return n.id||(n.id=n.strRelID),[n.name,e["!id"][n.id].Target,AW(e["!id"][n.id].Type)]})}catch{return null}return!e||e.length===0?null:e}function IW(e,t,r,n,s,a,i,o,l,u,f,d){try{a[n]=Uc(In(e,r,!0),t);var m=tr(e,t),p;switch(o){case"sheet":p=F$(m,t,s,l,a[n],u,f,d);break;case"chart":if(p=O$(m,t,s,l,a[n],u,f,d),!p||!p["!drawel"])break;var x=vc(p["!drawel"].Target,t),g=tg(x),_=DV(In(e,x,!0),Uc(In(e,g,!0),x)),k=vc(_,x),E=tg(k);p=x$(In(e,k,!0),k,l,Uc(In(e,E,!0),k),u,p);break;case"macro":p=M$(m,t,s,l,a[n],u,f,d);break;case"dialog":p=j$(m,t,s,l,a[n],u,f,d);break;default:throw new Error("Unrecognized sheet type "+o)}i[n]=p;var y=[];a&&a[n]&&$s(a[n]).forEach(function(b){var O="";if(a[n][b].Type==Go.CMNT){O=vc(a[n][b].Target,t);var D=B$(tr(e,O,!0),O,l);if(!D||!D.length)return;sE(p,D,!1)}a[n][b].Type==Go.TCMNT&&(O=vc(a[n][b].Target,t),y=y.concat(OV(tr(e,O,!0),l)))}),y&&y.length&&sE(p,y,!0,l.people||[])}catch(b){if(l.WTF)throw b}}function $n(e){return e.charAt(0)=="/"?e.slice(1):e}function NW(e,t){if(sb(),t=t||{},Lv(t),zn(e,"META-INF/manifest.xml")||zn(e,"objectdata.xml"))return gE(e,t);if(zn(e,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof km<"u"){if(e.FileIndex)return km(e);var r=st.utils.cfb_new();return Rw(e).forEach(function(oe){C8(r,oe,N8(e,oe))}),km(r)}throw new Error("Unsupported NUMBERS file")}if(!zn(e,"[Content_Types].xml"))throw zn(e,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):zn(e,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var n=Rw(e),s=S5(In(e,"[Content_Types].xml")),a=!1,i,o;if(s.workbooks.length===0&&(o="xl/workbook.xml",tr(e,o,!0)&&s.workbooks.push(o)),s.workbooks.length===0){if(o="xl/workbook.bin",!tr(e,o,!0))throw new Error("Could not find workbook");s.workbooks.push(o),a=!0}s.workbooks[0].slice(-3)=="bin"&&(a=!0);var l={},u={};if(!t.bookSheets&&!t.bookProps){if($c=[],s.sst)try{$c=V$(tr(e,$n(s.sst)),s.sst,t)}catch(oe){if(t.WTF)throw oe}t.cellStyles&&s.themes.length&&(l=U$(In(e,s.themes[0].replace(/^\//,""),!0)||"",s.themes[0],t)),s.style&&(u=L$(tr(e,$n(s.style)),s.style,l,t))}s.links.map(function(oe){try{var te=Uc(In(e,tg($n(oe))),oe);return W$(tr(e,$n(oe)),te,oe,t)}catch{}});var f=D$(tr(e,$n(s.workbooks[0])),s.workbooks[0],t),d={},m="";s.coreprops.length&&(m=tr(e,$n(s.coreprops[0]),!0),m&&(d=Db(m)),s.extprops.length!==0&&(m=tr(e,$n(s.extprops[0]),!0),m&&C5(m,d,t)));var p={};(!t.bookSheets||t.bookProps)&&s.custprops.length!==0&&(m=In(e,$n(s.custprops[0]),!0),m&&(p=P5(m,t)));var x={};if((t.bookSheets||t.bookProps)&&(f.Sheets?i=f.Sheets.map(function(te){return te.name}):d.Worksheets&&d.SheetNames.length>0&&(i=d.SheetNames),t.bookProps&&(x.Props=d,x.Custprops=p),t.bookSheets&&typeof i<"u"&&(x.SheetNames=i),t.bookSheets?x.SheetNames:t.bookProps))return x;i={};var g={};t.bookDeps&&s.calcchain&&(g=$$(tr(e,$n(s.calcchain)),s.calcchain));var _=0,k={},E,y;{var b=f.Sheets;d.Worksheets=b.length,d.SheetNames=[];for(var O=0;O!=b.length;++O)d.SheetNames[O]=b[O].name}var D=a?"bin":"xml",v=s.workbooks[0].lastIndexOf("/"),T=(s.workbooks[0].slice(0,v+1)+"_rels/"+s.workbooks[0].slice(v+1)+".rels").replace(/^\//,"");zn(e,T)||(T="xl/_rels/workbook."+D+".rels");var S=Uc(In(e,T,!0),T.replace(/_rels.*/,"s5s"));(s.metadata||[]).length>=1&&(t.xlmeta=z$(tr(e,$n(s.metadata[0])),s.metadata[0],t)),(s.people||[]).length>=1&&(t.people=MV(tr(e,$n(s.people[0])),t)),S&&(S=bW(S,f.Sheets));var N=tr(e,"xl/worksheets/sheet.xml",!0)?1:0;e:for(_=0;_!=d.Worksheets;++_){var C="sheet";if(S&&S[_]?(E="xl/"+S[_][1].replace(/[\/]?xl\//,""),zn(e,E)||(E=S[_][1]),zn(e,E)||(E=T.replace(/_rels\/.*$/,"")+S[_][1]),C=S[_][2]):(E="xl/worksheets/sheet"+(_+1-N)+"."+D,E=E.replace(/sheet0\./,"sheet.")),y=E.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),t&&t.sheets!=null)switch(typeof t.sheets){case"number":if(_!=t.sheets)continue e;break;case"string":if(d.SheetNames[_].toLowerCase()!=t.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(t.sheets)){for(var R=!1,F=0;F!=t.sheets.length;++F)typeof t.sheets[F]=="number"&&t.sheets[F]==_&&(R=1),typeof t.sheets[F]=="string"&&t.sheets[F].toLowerCase()==d.SheetNames[_].toLowerCase()&&(R=1);if(!R)continue e}}IW(e,E,y,d.SheetNames[_],_,k,i,C,t,f,l,u)}return x={Directory:s,Workbook:f,Props:d,Custprops:p,Deps:g,Sheets:i,SheetNames:d.SheetNames,Strings:$c,Styles:u,Themes:l,SSF:Ir(He)},t&&t.bookFiles&&(e.files?(x.keys=n,x.files=e.files):(x.keys=[],x.files={},e.FullPaths.forEach(function(oe,te){oe=oe.replace(/^Root Entry[\/]/,""),x.keys.push(oe),x.files[oe]=e.FileIndex[te]}))),t&&t.bookVBA&&(s.vba.length>0?x.vbaraw=tr(e,$n(s.vba[0]),!0):s.defaults&&s.defaults.bin===VV&&(x.vbaraw=tr(e,"xl/vbaProject.bin",!0))),x}function CW(e,t){var r=t||{},n="Workbook",s=st.find(e,n);try{if(n="/!DataSpaces/Version",s=st.find(e,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(EU(s.content),n="/!DataSpaces/DataSpaceMap",s=st.find(e,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);var a=kU(s.content);if(a.length!==1||a[0].comps.length!==1||a[0].comps[0].t!==0||a[0].name!=="StrongEncryptionDataSpace"||a[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",s=st.find(e,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);var i=SU(s.content);if(i.length!=1||i[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",s=st.find(e,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);bU(s.content)}catch{}if(n="/EncryptionInfo",s=st.find(e,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);var o=IU(s.content);if(n="/EncryptedPackage",s=st.find(e,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(o[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(o[1],s.content,r.password||"",r);if(o[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(o[1],s.content,r.password||"",r);throw new Error("File is password-protected")}function Uv(e,t){var r="";switch((t||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":r=Mn(e.slice(0,12));break;case"binary":r=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(t&&t.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function RW(e,t){return st.find(e,"EncryptedPackage")?CW(e,t):xI(e,t)}function PW(e,t){var r,n=e,s=t||{};return s.type||(s.type=tt&&Buffer.isBuffer(e)?"buffer":"base64"),r=ub(n,s),NW(r,s)}function wI(e,t){var r=0;e:for(;r<e.length;)switch(e.charCodeAt(r)){case 10:case 13:case 32:++r;break;case 60:return sg(e.slice(r),t);default:break e}return ku.to_workbook(e,t)}function DW(e,t){var r="",n=Uv(e,t);switch(t.type){case"base64":r=Mn(e);break;case"binary":r=e;break;case"buffer":r=e.toString("binary");break;case"array":r=io(e);break;default:throw new Error("Unrecognized type "+t.type)}return n[0]==239&&n[1]==187&&n[2]==191&&(r=St(r)),t.type="binary",wI(r,t)}function FW(e,t){var r=e;return t.type=="base64"&&(r=Mn(r)),r=_u.utils.decode(1200,r.slice(2),"str"),t.type="binary",wI(r,t)}function OW(e){return e.match(/[^\x00-\x7F]/)?yc(e):e}function Sm(e,t,r,n){return n?(r.type="string",ku.to_workbook(e,r)):ku.to_workbook(t,r)}function Ad(e,t){GA();var r=t||{};if(typeof ArrayBuffer<"u"&&e instanceof ArrayBuffer)return Ad(new Uint8Array(e),(r=Ir(r),r.type="array",r));typeof Uint8Array<"u"&&e instanceof Uint8Array&&!r.type&&(r.type=typeof Deno<"u"?"buffer":"array");var n=e,s=[0,0,0,0],a=!1;if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),ol={},r.dateNF&&(ol.dateNF=r.dateNF),r.type||(r.type=tt&&Buffer.isBuffer(e)?"buffer":"base64"),r.type=="file"&&(r.type=tt?"buffer":"binary",n=E8(e),typeof Uint8Array<"u"&&!tt&&(r.type="array")),r.type=="string"&&(a=!0,r.type="binary",r.codepage=65001,n=OW(e)),r.type=="array"&&typeof Uint8Array<"u"&&e instanceof Uint8Array&&typeof ArrayBuffer<"u"){var i=new ArrayBuffer(3),o=new Uint8Array(i);if(o.foo="bar",!o.foo)return r=Ir(r),r.type="array",Ad(xv(n),r)}switch((s=Uv(n,r))[0]){case 208:if(s[1]===207&&s[2]===17&&s[3]===224&&s[4]===161&&s[5]===177&&s[6]===26&&s[7]===225)return RW(st.read(n,r),r);break;case 9:if(s[1]<=8)return xI(n,r);break;case 60:return sg(n,r);case 73:if(s[1]===73&&s[2]===42&&s[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(s[1]===68)return cU(n,r);break;case 84:if(s[1]===65&&s[2]===66&&s[3]===76)return oU.to_workbook(n,r);break;case 80:return s[1]===75&&s[2]<9&&s[3]<9?PW(n,r):Sm(e,n,r,a);case 239:return s[3]===60?sg(n,r):Sm(e,n,r,a);case 255:if(s[1]===254)return FW(n,r);if(s[1]===0&&s[2]===2&&s[3]===0)return Bc.to_workbook(n,r);break;case 0:if(s[1]===0&&(s[2]>=2&&s[3]===0||s[2]===0&&(s[3]===8||s[3]===9)))return Bc.to_workbook(n,r);break;case 3:case 131:case 139:case 140:return nE.to_workbook(n,r);case 123:if(s[1]===92&&s[2]===114&&s[3]===116)return VU.to_workbook(n,r);break;case 10:case 13:case 32:return DW(n,r);case 137:if(s[1]===80&&s[2]===78&&s[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return aU.indexOf(s[0])>-1&&s[2]<=12&&s[3]<=31?nE.to_workbook(n,r):Sm(e,n,r,a)}function MW(e,t,r,n,s,a,i,o){var l=Nr(r),u=o.defval,f=o.raw||!Object.prototype.hasOwnProperty.call(o,"raw"),d=!0,m=s===1?[]:{};if(s!==1)if(Object.defineProperty)try{Object.defineProperty(m,"__rowNum__",{value:r,enumerable:!1})}catch{m.__rowNum__=r}else m.__rowNum__=r;if(!i||e[r])for(var p=t.s.c;p<=t.e.c;++p){var x=i?e[r][p]:e[n[p]+l];if(x===void 0||x.t===void 0){if(u===void 0)continue;a[p]!=null&&(m[a[p]]=u);continue}var g=x.v;switch(x.t){case"z":if(g==null)break;continue;case"e":g=g==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+x.t)}if(a[p]!=null){if(g==null)if(x.t=="e"&&g===null)m[a[p]]=null;else if(u!==void 0)m[a[p]]=u;else if(f&&g===null)m[a[p]]=null;else continue;else m[a[p]]=f&&(x.t!=="n"||x.t==="n"&&o.rawNumbers!==!1)?g:Sa(x,g,o);g!=null&&(d=!1)}}return{row:m,isempty:d}}function lg(e,t){if(e==null||e["!ref"]==null)return[];var r={t:"n",v:0},n=0,s=1,a=[],i=0,o="",l={s:{r:0,c:0},e:{r:0,c:0}},u=t||{},f=u.range!=null?u.range:e["!ref"];switch(u.header===1?n=1:u.header==="A"?n=2:Array.isArray(u.header)?n=3:u.header==null&&(n=0),typeof f){case"string":l=Gt(f);break;case"number":l=Gt(e["!ref"]),l.s.r=f;break;default:l=f}n>0&&(s=0);var d=Nr(l.s.r),m=[],p=[],x=0,g=0,_=Array.isArray(e),k=l.s.r,E=0,y={};_&&!e[k]&&(e[k]=[]);var b=u.skipHidden&&e["!cols"]||[],O=u.skipHidden&&e["!rows"]||[];for(E=l.s.c;E<=l.e.c;++E)if(!(b[E]||{}).hidden)switch(m[E]=ur(E),r=_?e[k][E]:e[m[E]+d],n){case 1:a[E]=E-l.s.c;break;case 2:a[E]=m[E];break;case 3:a[E]=u.header[E-l.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),o=i=Sa(r,null,u),g=y[i]||0,!g)y[i]=1;else{do o=i+"_"+g++;while(y[o]);y[i]=g,y[o]=1}a[E]=o}for(k=l.s.r+s;k<=l.e.r;++k)if(!(O[k]||{}).hidden){var D=MW(e,l,k,m,n,a,_,u);(D.isempty===!1||(n===1?u.blankrows!==!1:u.blankrows))&&(p[x++]=D.row)}return p.length=x,p}var _E=/"/g;function jW(e,t,r,n,s,a,i,o){for(var l=!0,u=[],f="",d=Nr(r),m=t.s.c;m<=t.e.c;++m)if(n[m]){var p=o.dense?(e[r]||[])[m]:e[n[m]+d];if(p==null)f="";else if(p.v!=null){l=!1,f=""+(o.rawNumbers&&p.t=="n"?p.v:Sa(p,null,o));for(var x=0,g=0;x!==f.length;++x)if((g=f.charCodeAt(x))===s||g===a||g===34||o.forceQuotes){f='"'+f.replace(_E,'""')+'"';break}f=="ID"&&(f='"ID"')}else p.f!=null&&!p.F?(l=!1,f="="+p.f,f.indexOf(",")>=0&&(f='"'+f.replace(_E,'""')+'"')):f="";u.push(f)}return o.blankrows===!1&&l?null:u.join(i)}function EI(e,t){var r=[],n=t??{};if(e==null||e["!ref"]==null)return"";var s=Gt(e["!ref"]),a=n.FS!==void 0?n.FS:",",i=a.charCodeAt(0),o=n.RS!==void 0?n.RS:`
`,l=o.charCodeAt(0),u=new RegExp((a=="|"?"\\|":a)+"+$"),f="",d=[];n.dense=Array.isArray(e);for(var m=n.skipHidden&&e["!cols"]||[],p=n.skipHidden&&e["!rows"]||[],x=s.s.c;x<=s.e.c;++x)(m[x]||{}).hidden||(d[x]=ur(x));for(var g=0,_=s.s.r;_<=s.e.r;++_)(p[_]||{}).hidden||(f=jW(e,s,_,d,i,l,a,n),f!=null&&(n.strip&&(f=f.replace(u,"")),(f||n.blankrows!==!1)&&r.push((g++?o:"")+f)));return delete n.dense,r.join("")}function LW(e,t){t||(t={}),t.FS="	",t.RS=`
`;var r=EI(e,t);return r}function UW(e){var t="",r,n="";if(e==null||e["!ref"]==null)return[];var s=Gt(e["!ref"]),a="",i=[],o,l=[],u=Array.isArray(e);for(o=s.s.c;o<=s.e.c;++o)i[o]=ur(o);for(var f=s.s.r;f<=s.e.r;++f)for(a=Nr(f),o=s.s.c;o<=s.e.c;++o)if(t=i[o]+a,r=u?(e[f]||[])[o]:e[t],n="",r!==void 0){if(r.F!=null){if(t=r.F,!r.f)continue;n=r.f,t.indexOf(":")==-1&&(t=t+":"+t)}if(r.f!=null)n=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)n=""+r.v;else if(r.t=="b")n=r.v?"TRUE":"FALSE";else if(r.w!==void 0)n="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?n="'"+r.v:n=""+r.v}}l[l.length]=t+"="+n}return l}function TI(e,t,r){var n=r||{},s=+!n.skipHeader,a=e||{},i=0,o=0;if(a&&n.origin!=null)if(typeof n.origin=="number")i=n.origin;else{var l=typeof n.origin=="string"?en(n.origin):n.origin;i=l.r,o=l.c}var u,f={s:{c:0,r:0},e:{c:o,r:i+t.length-1+s}};if(a["!ref"]){var d=Gt(a["!ref"]);f.e.c=Math.max(f.e.c,d.e.c),f.e.r=Math.max(f.e.r,d.e.r),i==-1&&(i=d.e.r+1,f.e.r=i+t.length-1+s)}else i==-1&&(i=0,f.e.r=t.length-1+s);var m=n.header||[],p=0;t.forEach(function(g,_){$s(g).forEach(function(k){(p=m.indexOf(k))==-1&&(m[p=m.length]=k);var E=g[k],y="z",b="",O=We({c:o+p,r:i+_+s});u=Iu(a,O),E&&typeof E=="object"&&!(E instanceof Date)?a[O]=E:(typeof E=="number"?y="n":typeof E=="boolean"?y="b":typeof E=="string"?y="s":E instanceof Date?(y="d",n.cellDates||(y="n",E=sn(E)),b=n.dateNF||He[14]):E===null&&n.nullError&&(y="e",E=0),u?(u.t=y,u.v=E,delete u.w,delete u.R,b&&(u.z=b)):a[O]=u={t:y,v:E},b&&(u.z=b))})}),f.e.c=Math.max(f.e.c,o+m.length-1);var x=Nr(i);if(s)for(p=0;p<m.length;++p)a[ur(p+o)+x]={t:"s",v:m[p]};return a["!ref"]=at(f),a}function VW(e,t){return TI(null,e,t)}function Iu(e,t,r){if(typeof t=="string"){if(Array.isArray(e)){var n=en(t);return e[n.r]||(e[n.r]=[]),e[n.r][n.c]||(e[n.r][n.c]={t:"z"})}return e[t]||(e[t]={t:"z"})}return typeof t!="number"?Iu(e,We(t)):Iu(e,We({r:t,c:r||0}))}function BW(e,t){if(typeof t=="number"){if(t>=0&&e.SheetNames.length>t)return t;throw new Error("Cannot find sheet # "+t)}else if(typeof t=="string"){var r=e.SheetNames.indexOf(t);if(r>-1)return r;throw new Error("Cannot find sheet name |"+t+"|")}else throw new Error("Cannot find sheet |"+t+"|")}function Vv(){return{SheetNames:[],Sheets:{}}}function Bv(e,t,r,n){var s=1;if(!r)for(;s<=65535&&e.SheetNames.indexOf(r="Sheet"+s)!=-1;++s,r=void 0);if(!r||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&e.SheetNames.indexOf(r)>=0){var a=r.match(/(^.*?)(\d+)$/);s=a&&+a[2]||0;var i=a&&a[1]||r;for(++s;s<=65535&&e.SheetNames.indexOf(r=i+s)!=-1;++s);}if(S$(r),e.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return e.SheetNames.push(r),e.Sheets[r]=t,r}function $W(e,t,r){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var n=BW(e,t);switch(e.Workbook.Sheets[n]||(e.Workbook.Sheets[n]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}e.Workbook.Sheets[n].Hidden=r}function WW(e,t){return e.z=t,e}function kI(e,t,r){return t?(e.l={Target:t},r&&(e.l.Tooltip=r)):delete e.l,e}function zW(e,t,r){return kI(e,"#"+t,r)}function HW(e,t,r){e.c||(e.c=[]),e.c.push({t,a:r||"SheetJS"})}function GW(e,t,r,n){for(var s=typeof t!="string"?t:Gt(t),a=typeof t=="string"?t:at(t),i=s.s.r;i<=s.e.r;++i)for(var o=s.s.c;o<=s.e.c;++o){var l=Iu(e,i,o);l.t="n",l.F=a,delete l.v,i==s.s.r&&o==s.s.c&&(l.f=r,n&&(l.D=!0))}return e}var SI={encode_col:ur,encode_row:Nr,encode_cell:We,encode_range:at,decode_col:Av,decode_row:Sv,split_cell:s5,decode_cell:en,decode_range:jl,format_cell:Sa,sheet_add_aoa:Ib,sheet_add_json:TI,sheet_add_dom:vI,aoa_to_sheet:Ll,json_to_sheet:VW,table_to_sheet:yI,table_to_book:cW,sheet_to_csv:EI,sheet_to_txt:LW,sheet_to_json:lg,sheet_to_html:lW,sheet_to_formulae:UW,sheet_to_row_object_array:lg,sheet_get_cell:Iu,book_new:Vv,book_append_sheet:Bv,book_set_sheet_visibility:$W,cell_set_number_format:WW,cell_set_hyperlink:kI,cell_set_internal_link:zW,cell_add_comment:HW,sheet_set_array_formula:GW,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};const KW=({omdbApiKey:e,userId:t,onDone:r})=>{const[n,s]=U.useState(null),[a,i]=U.useState([]),[o,l]=U.useState([]),[u,f]=U.useState("upload"),[d,m]=U.useState(0),[p,x]=U.useState(null),[g,_]=U.useState(0),[k,E]=U.useState(!1),[y,b]=U.useState(null),[O,D]=U.useState([]),[v,T]=U.useState(null),S=o.filter(te=>te.selected&&te.tmdbMatch).length,N=te=>{var X;const de=(X=te.target.files)==null?void 0:X[0];if(!de)return;s(de);const ae=new FileReader;ae.onload=H=>{var K;const Z=Ad((K=H.target)==null?void 0:K.result,{type:"binary"}),Y=Z.Sheets[Z.SheetNames[0]],q=SI.sheet_to_json(Y).map(L=>({title:L.title||L.Title||L.name||L.Name||"",imdbId:L.imdb||L.IMDB||L.Imdb||L.imdbId||L.imdbID||"",releaseDate:L.year||L.Year||L.releaseDate||L.ReleaseDate||L.release_date||"",watched:L.watched||L.Watched||!1,rating:L.rating||L.Rating||null,review:L.review||L.Review||L.notes||L.Notes||""})).filter(L=>L.title);i(q)},ae.readAsBinaryString(de)},C=async()=>{if(!a.length||!e){T("Missing data or OMDb key");return}try{E(!0),T(null),l([]),m(0),x(null);const te=[],de=Tt(De,"movies");for(let ae=0;ae<a.length;ae++){const X=a[ae];x(X.title||null);try{let H=null;if(X.imdbId)H=await ci(X.imdbId,e);else{const Z=`${X.title} ${X.releaseDate||""}`.trim();let Y=Z||X.title,M=[];try{M=await Hi(Y,e)}catch{M=[]}if(!M.length&&Z&&X.title&&Z!==X.title){Y=X.title;try{M=await Hi(Y,e)}catch{M=[]}}if(!M.length){te.push({excelData:X,tmdbMatch:null,confidence:0,status:"unmatched",userMovieExists:!1,selected:!1});continue}H=await ci(M[0].imdbID,e)}if(!H)te.push({excelData:X,tmdbMatch:null,confidence:0,status:"unmatched",userMovieExists:!1,selected:!1});else{const Z=md(X,H),Y=await Mt(Dn(de,rn("imdbId","==",H.imdbID)));let M,q=!1;Y.empty||(M=Y.docs[0].id,q=!!await dd(t,M)),te.push({excelData:X,tmdbMatch:H,confidence:Z,status:q?"duplicate":Z>=70?"matched":"manual",userMovieExists:q,movieId:M,selected:!q})}}catch{te.push({excelData:X,tmdbMatch:null,confidence:0,status:"unmatched",userMovieExists:!1,selected:!1})}m(Math.round((ae+1)/a.length*100))}l(te),f("review")}finally{E(!1),x(null)}},R=async(te,de)=>{try{E(!0);const ae=o[te],X=de||ae.excelData.title,H=await Hi(X,e);b(te),D(H)}finally{E(!1)}},F=async te=>{if(y!=null){E(!0);try{const de=await ci(te.imdbID,e),ae=md(o[y].excelData,de),X=Tt(De,"movies"),H=await Mt(Dn(X,rn("imdbId","==",de.imdbID)));let Z,Y=!1;H.empty||(Z=H.docs[0].id,Y=!!await dd(t,Z)),l(M=>{const q=[...M],K=q[y];return q[y]={...K,tmdbMatch:de,confidence:ae,status:Y?"duplicate":"matched",userMovieExists:Y,movieId:Z,selected:!Y},q}),b(null),D([])}finally{E(!1)}}},oe=async()=>{const te=o.filter(ae=>ae.selected&&ae.tmdbMatch);if(!te.length)return;f("import"),_(0);const de=Tt(De,"movies");for(let ae=0;ae<te.length;ae++){const X=te[ae];try{let H=X.movieId;H||(H=(await Qu(de,{...x0(X.tmdbMatch),addedAt:new Date,updatedAt:new Date})).id),await Ju(t,H,{userId:t,movieId:H,watched:X.excelData.watched||!1,rating:X.excelData.rating||null,review:X.excelData.review||"",favorite:!1})}catch{}_(Math.round((ae+1)/te.length*100))}r==null||r()};return c.jsxs("div",{className:"space-y-6",children:[u==="upload"&&c.jsxs("div",{className:"space-y-4",children:[c.jsx("input",{type:"file",accept:".xlsx,.xls",className:"file-input file-input-bordered w-full",onChange:N}),!!a.length&&c.jsxs("div",{className:"text-sm opacity-80",children:[a.length," rows detected"]}),c.jsx("button",{className:"btn btn-primary",onClick:C,disabled:!e||!a.length||k,children:k?c.jsx("span",{className:"loading loading-spinner loading-sm"}):"Scan & Match"}),k&&!!d&&d<100&&c.jsxs("div",{className:"space-y-1",children:[c.jsxs("div",{className:"text-sm",children:["Scanning ",d,"%"]}),c.jsx("progress",{className:"progress w-full",value:d,max:100}),p&&c.jsxs("div",{className:"text-xs opacity-70 truncate",children:["Current: ",p]})]})]}),u==="review"&&c.jsxs("div",{className:"space-y-4",children:[c.jsxs("div",{className:"flex justify-between items-center",children:[c.jsx("div",{className:"font-bold",children:"Review Matches"}),c.jsx("button",{className:"btn btn-ghost btn-sm",onClick:()=>f("upload"),children:"Back"})]}),c.jsx("div",{className:"overflow-x-auto",children:c.jsxs("table",{className:"table table-zebra w-full",children:[c.jsx("thead",{children:c.jsxs("tr",{children:[c.jsx("th",{}),c.jsx("th",{children:"Excel"}),c.jsx("th",{children:"Match"}),c.jsx("th",{children:"Confidence"}),c.jsx("th",{children:"Status"}),c.jsx("th",{children:"Action"})]})}),c.jsx("tbody",{children:o.map((te,de)=>c.jsxs("tr",{className:te.userMovieExists?"bg-warning bg-opacity-20":"",children:[c.jsx("td",{children:c.jsx("input",{type:"checkbox",className:"checkbox",checked:te.selected,disabled:!te.tmdbMatch,onChange:()=>{const ae=[...o];ae[de].selected=!ae[de].selected,l(ae)}})}),c.jsxs("td",{children:[c.jsx("div",{className:"font-semibold",children:te.excelData.title}),c.jsx("div",{className:"text-xs opacity-70",children:te.excelData.releaseDate||"-"})]}),c.jsx("td",{children:te.tmdbMatch?c.jsxs("div",{className:"flex items-center gap-3",children:[c.jsx("div",{className:"w-12 h-18",children:xn(te.tmdbMatch)?c.jsx("img",{src:xn(te.tmdbMatch),className:"object-cover"}):c.jsx("div",{className:"w-full h-full bg-base-200"})}),c.jsxs("div",{children:[c.jsx("div",{className:"font-semibold",children:te.tmdbMatch.Title}),c.jsx("div",{className:"text-xs opacity-70",children:te.tmdbMatch.Year})]})]}):c.jsx("span",{className:"text-error",children:"No match"})}),c.jsx("td",{children:te.tmdbMatch?c.jsxs("div",{className:"flex items-center",children:[c.jsx("progress",{className:`progress ${te.confidence>=70?"progress-success":te.confidence>=40?"progress-warning":"progress-error"}`,value:te.confidence,max:100}),c.jsxs("span",{className:"ml-2",children:[te.confidence,"%"]})]}):"-"}),c.jsxs("td",{children:[te.status==="matched"&&c.jsx("div",{className:"badge badge-success",children:"Matched"}),te.status==="unmatched"&&c.jsx("div",{className:"badge badge-error",children:"Unmatched"}),te.status==="duplicate"&&c.jsx("div",{className:"badge badge-warning",children:"Duplicate"}),te.status==="manual"&&c.jsx("div",{className:"badge badge-info",children:"Manual"})]}),c.jsx("td",{children:c.jsx("button",{className:"btn btn-sm btn-outline",onClick:()=>R(de),children:c.jsx("i",{className:"fas fa-search"})})})]},de))})]})}),c.jsx("div",{className:"flex justify-end",children:c.jsxs("button",{className:"btn btn-primary",onClick:oe,disabled:!S||k,children:["Import ",S," Movies"]})}),!!d&&d<100&&c.jsx("div",{children:c.jsx("progress",{className:"progress w-full",value:d,max:100})})]}),u==="import"&&c.jsxs("div",{className:"space-y-3",children:[c.jsx("div",{className:"font-bold",children:"Importing"}),c.jsx("progress",{className:"progress w-full",value:g,max:100})]}),y!==null&&c.jsx("div",{className:"fixed inset-0 z-[100] flex items-center justify-center bg-black/60",children:c.jsxs("div",{className:"bg-base-100 rounded-box shadow-xl max-w-4xl w-full max-h-[90vh] overflow-hidden p-6",children:[c.jsxs("h3",{className:"font-bold text-lg mb-4",children:["Manual match: ",o[y].excelData.title]}),c.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 mb-6",children:[c.jsx("input",{type:"text",className:"input input-bordered flex-1",placeholder:"Search for a movie...",defaultValue:o[y].excelData.title,onKeyDown:te=>te.key==="Enter"&&R(y,te.target.value)}),c.jsx("button",{className:"btn btn-primary w-full sm:w-auto",onClick:()=>{var te;return R(y,(te=document.querySelector("[data-manual-search-input]"))==null?void 0:te.value)},disabled:k,children:k?c.jsx("span",{className:"loading loading-spinner loading-sm"}):c.jsx("i",{className:"fas fa-search"})})]}),c.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-3 max-h-96 overflow-y-auto",children:O.map(te=>c.jsxs("div",{className:"card bg-base-100 shadow cursor-pointer",onClick:()=>F(te),children:[c.jsx("figure",{children:xn(te)?c.jsx("img",{src:xn(te)}):c.jsx("div",{className:"h-48 w-full bg-base-200"})}),c.jsxs("div",{className:"card-body p-3",children:[c.jsx("div",{className:"text-sm font-semibold",children:te.Title}),c.jsx("div",{className:"text-xs opacity-70",children:te.Year})]})]},te.imdbID))}),c.jsx("div",{className:"flex justify-end mt-6",children:c.jsx("button",{className:"btn",onClick:()=>{b(null),D([])},children:"Close"})})]})}),v&&c.jsx("div",{className:"alert alert-error",children:v})]})},qW=({selected:e,showDetails:t,loading:r,onToggleDetails:n,onAdd:s,onClose:a})=>{var i,o,l,u,f;return e?c.jsx("dialog",{className:"modal modal-open",children:c.jsxs("div",{className:"modal-box bg-xmas-card",children:[c.jsxs("div",{className:"flex gap-4",children:[c.jsx("div",{className:"w-24 shrink-0",children:xn(e)?c.jsx("img",{src:xn(e),alt:e.title,className:"w-full rounded-lg"}):c.jsx("div",{className:"w-full h-36 bg-base-200 flex items-center justify-center rounded-lg",children:c.jsx("i",{className:"fas fa-film text-2xl opacity-50"})})}),c.jsxs("div",{className:"flex-1",children:[c.jsx("h2",{className:"text-xl font-bold mb-1",children:e.title}),c.jsx("p",{className:"text-sm opacity-80 mb-1",children:(i=e.release_date)==null?void 0:i.slice(0,4)}),!t&&e.runtime&&c.jsxs("p",{className:"text-sm opacity-80 mb-1",children:["Runtime: ",e.runtime," min"]}),t&&c.jsxs("div",{className:"mt-3 space-y-2 text-sm opacity-90 max-h-48 overflow-auto pr-1",children:[e.overview&&c.jsxs("div",{children:[c.jsx("p",{className:"font-semibold mb-1",children:"Overview"}),c.jsx("p",{children:e.overview})]}),e.runtime&&c.jsxs("p",{children:[c.jsx("span",{className:"font-semibold",children:"Runtime:"})," ",e.runtime," min"]}),e.genres&&e.genres.length>0&&c.jsxs("p",{children:[c.jsx("span",{className:"font-semibold",children:"Genres:"})," ",e.genres.map(d=>typeof d=="string"?d:d.name).join(", ")]}),(((l=(o=e.credits)==null?void 0:o.cast)==null?void 0:l.length)||((u=e.cast)==null?void 0:u.length))&&c.jsxs("p",{children:[c.jsx("span",{className:"font-semibold",children:"Top cast:"})," ",((f=e.credits)!=null&&f.cast&&e.credits.cast.length>0?e.credits.cast.map(d=>d.name):e.cast).slice(0,5).join(", ")]})]})]})]}),c.jsx("div",{className:"mt-4 space-y-3",children:c.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-3",children:[c.jsx("div",{children:(e.overview||e.runtime||e.genres||e.credits||e.cast)&&c.jsxs("button",{type:"button",className:"btn btn-outline btn-sm sm:btn-md gap-2",onClick:n,disabled:r,children:[c.jsx("i",{className:"fas fa-info-circle"}),t?"Hide details":"View details"]})}),c.jsxs("div",{className:"flex justify-end gap-2",children:[c.jsxs("button",{className:"btn btn-primary btn-sm sm:btn-md",onClick:s,disabled:r,children:[r?c.jsx("span",{className:"loading loading-spinner loading-sm mr-2"}):c.jsx("i",{className:"fas fa-plus mr-2"}),"Add Movie"]}),c.jsx("button",{className:"btn btn-outline btn-sm sm:btn-md",onClick:a,disabled:r,children:"Cancel"})]})]})}),c.jsx("form",{method:"dialog",className:"modal-backdrop",onClick:a,children:c.jsx("button",{children:"close"})})]})}):null},XW=()=>{const{currentUser:e,userProfile:t}=ln(),[r,n]=U.useState(!1),[s,a]=U.useState(""),[i,o]=U.useState(""),[l,u]=U.useState(""),[f,d]=U.useState(""),[m,p]=U.useState(""),[x,g]=U.useState(!1),[_,k]=U.useState(null),[E,y]=U.useState(null);U.useEffect(()=>{i&&!l&&u(`https://www.themoviedb.org/movie/${i}`)},[i,l]);const b=()=>{a(""),o(""),u(""),d(""),p(""),k(null)},O=()=>{if(k(null),y(null),!e){k("Please sign in to request a movie.");return}n(!0)},D=()=>{x||(n(!1),b())},v=async T=>{if(T.preventDefault(),!e){k("You must be signed in to submit a request.");return}if(!s.trim()){k("Please enter a movie title.");return}try{g(!0),k(null),await Qu(Tt(De,"Requests"),{title:s.trim(),tmdbId:i?Number(i):null,tmdbUrl:l.trim()||null,year:f.trim()||null,notes:m.trim()||null,userId:e.uid,userDisplayName:(t==null?void 0:t.displayName)||e.displayName||null,status:"pending",createdAt:new Date}),y("Request submitted! Thank you."),b(),n(!1)}catch(S){console.error("Failed to submit movie request:",S),k((S==null?void 0:S.message)||"Failed to submit request. Please try again.")}finally{g(!1)}};return c.jsxs(c.Fragment,{children:[c.jsxs("button",{type:"button",className:"btn btn-outline btn-sm sm:btn-md mb-4",onClick:O,children:[c.jsx("i",{className:"fas fa-gift mr-2"}),"Request a movie"]}),_&&!r&&c.jsxs("div",{className:"alert alert-warning mb-4",children:[c.jsx("i",{className:"fas fa-exclamation-triangle mr-2"}),c.jsx("span",{children:_})]}),E&&!r&&c.jsxs("div",{className:"alert alert-success mb-4",children:[c.jsx("i",{className:"fas fa-check-circle mr-2"}),c.jsx("span",{children:E})]}),r&&c.jsx("dialog",{className:"modal modal-open",children:c.jsxs("div",{className:"modal-box bg-xmas-card max-w-lg",children:[c.jsx("h2",{className:"font-christmas text-2xl mb-2 text-xmas-gold",children:"Request a Movie"}),c.jsx("p",{className:"text-sm mb-4 opacity-80",children:"Can't find a movie in the catalogue? Tell us about it so we can add it."}),_&&c.jsxs("div",{className:"alert alert-error mb-3",children:[c.jsx("i",{className:"fas fa-exclamation-circle mr-2"}),c.jsx("span",{children:_})]}),c.jsxs("form",{className:"space-y-3",onSubmit:v,children:[c.jsxs("div",{children:[c.jsx("label",{className:"label",children:c.jsx("span",{className:"label-text",children:"Movie title *"})}),c.jsx("input",{type:"text",className:"input input-bordered w-full",value:s,onChange:T=>a(T.target.value),required:!0,disabled:x,placeholder:"e.g. The Grinch"})]}),c.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:[c.jsxs("div",{children:[c.jsx("label",{className:"label",children:c.jsx("span",{className:"label-text",children:"TMDB ID (optional)"})}),c.jsx("input",{type:"number",className:"input input-bordered w-full",value:i,onChange:T=>o(T.target.value),disabled:x,placeholder:"e.g. 8871"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"label",children:c.jsx("span",{className:"label-text",children:"Release year (optional)"})}),c.jsx("input",{type:"number",className:"input input-bordered w-full",value:f,onChange:T=>d(T.target.value),disabled:x,placeholder:"e.g. 2000"})]})]}),c.jsxs("div",{children:[c.jsx("label",{className:"label",children:c.jsx("span",{className:"label-text",children:"TMDB URL (optional)"})}),c.jsx("input",{type:"url",className:"input input-bordered w-full",value:l,onChange:T=>u(T.target.value),disabled:x,placeholder:"https://www.themoviedb.org/movie/..."}),c.jsx("p",{className:"text-xs opacity-70 mt-1",children:"If you provide a TMDB ID, the URL will be auto-filled. You can also paste a URL directly."})]}),c.jsxs("div",{children:[c.jsx("label",{className:"label",children:c.jsx("span",{className:"label-text",children:"Anything else that helps? (optional)"})}),c.jsx("textarea",{className:"textarea textarea-bordered w-full",rows:3,value:m,onChange:T=>p(T.target.value),disabled:x,placeholder:"Actors, streaming service, or where you heard about it."})]}),c.jsxs("div",{className:"modal-action flex justify-end gap-2",children:[c.jsx("button",{type:"button",className:"btn btn-ghost",onClick:D,disabled:x,children:"Cancel"}),c.jsxs("button",{type:"submit",className:"btn btn-primary",disabled:x,children:[x&&c.jsx("span",{className:"loading loading-spinner loading-sm mr-2"}),"Submit request"]})]})]}),c.jsx("form",{method:"dialog",className:"modal-backdrop",onClick:D,children:c.jsx("button",{children:"close"})})]})})]})},YW=()=>{const{currentUser:e,userProfile:t}=ln(),{isAdmin:r}=Ol(),[n,s]=U.useState(""),[a,i]=U.useState("local"),[o,l]=U.useState(null),[u,f]=U.useState(!1),[d,m]=U.useState(!1),[p,x]=U.useState(null),[g,_]=U.useState([]);U.useEffect(()=>{r&&(t!=null&&t.omdbApiKey)?s(t.omdbApiKey):s("")},[t,r]),U.useEffect(()=>{(async()=>{if(!e){_([]);return}try{const{userMovies:D}=await Zu(e.uid);_(Object.keys(D))}catch(D){console.error("Error loading user movies for import page:",D)}})()},[e]);const k=O=>{x(null),f(!1),l(O)},E=async O=>{if(!r){x({type:"error",text:"Only admins can import directly from OMDb."});return}if(!n){x({type:"error",text:"OMDb key required to fetch details."});return}try{m(!0),x(null),f(!1);const D=await ci(O.imdbID,n);l(D)}catch(D){x({type:"error",text:(D==null?void 0:D.message)??"Failed to fetch details"})}finally{m(!1)}},y=async()=>{if(!(!e||!o))try{m(!0),x(null);const O=Tt(De,"movies");let D;if(o.firestoreId)D=o.firestoreId;else{const v=o.imdbID||o.imdbId;if(!v){x({type:"error",text:"Cannot add movie: missing IMDb id."}),m(!1);return}const T=await Mt(Dn(O,rn("imdbId","==",v)));if(T.empty){if(!r){x({type:"error",text:"Only admins can add new catalogue movies."}),m(!1);return}D=(await Qu(O,{...x0(o),addedAt:new Date,updatedAt:new Date})).id}else D=T.docs[0].id}await Ju(e.uid,D,{userId:e.uid,movieId:D,watched:!1,favorite:!1}),_(v=>v.includes(D)?v:[...v,D]),UA(),x({type:"success",text:"Added to your collection!"}),f(!1),l(null)}catch(O){x({type:"error",text:(O==null?void 0:O.message)??"Failed to add movie"})}finally{m(!1)}},b=()=>{d||l(null)};return c.jsxs("div",{className:"container mx-auto px-4 py-8",children:[c.jsx("div",{className:"mb-4",children:c.jsxs(Ge,{to:"/movies",className:"btn btn-primary btn-sm sm:btn-md",children:[c.jsx("i",{className:"fas fa-arrow-left mr-2"})," Back to Movies"]})}),c.jsx("h1",{className:"font-christmas text-3xl md:text-4xl text-xmas-line mb-6",children:"Add Movies"}),p&&c.jsxs("div",{className:`alert ${p.type==="error"?"alert-error":"alert-success"} mb-4`,children:[c.jsx("i",{className:`fas ${p.type==="error"?"fa-exclamation-circle":"fa-check-circle"} mr-2`}),c.jsx("span",{children:p.text})]}),c.jsx("div",{className:"mb-4",children:c.jsx(XW,{})}),r&&c.jsxs("div",{className:"tabs tabs-boxed mb-6",children:[c.jsxs("button",{className:`tab ${a==="local"?"tab-active":""}`,onClick:()=>i("local"),children:[c.jsx("i",{className:"fas fa-database mr-2"}),"Local"]}),c.jsxs("button",{className:`tab ${a==="tmdb"?"tab-active":""}`,onClick:()=>i("tmdb"),children:[c.jsx("i",{className:"fas fa-search mr-2"}),"OMDb"]}),c.jsxs("button",{className:`tab ${a==="excel"?"tab-active":""}`,onClick:()=>i("excel"),children:[c.jsx("i",{className:"fas fa-file-excel mr-2"}),"Excel"]})]}),a==="local"&&c.jsx("div",{className:"bg-xmas-card p-6 rounded-lg shadow-lg",children:c.jsx(W6,{onSelect:k,userMovieIds:g})}),a==="tmdb"&&r&&c.jsxs("div",{className:"bg-xmas-card p-6 rounded-lg shadow-lg",children:[!n&&c.jsxs("div",{className:"alert alert-warning mb-4",children:[c.jsx("i",{className:"fas fa-exclamation-triangle mr-2"}),c.jsx("span",{children:"Set your OMDb API key in Profile to search OMDb."})]}),c.jsx(H6,{omdbApiKey:n,onSelect:E})]}),a==="excel"&&r&&c.jsxs("div",{className:"bg-xmas-card p-6 rounded-lg shadow-lg",children:[!n&&c.jsxs("div",{className:"alert alert-warning mb-4",children:[c.jsx("i",{className:"fas fa-exclamation-triangle mr-2"}),c.jsx("span",{children:"OMDb key required for matching."})]}),e?c.jsx(KW,{omdbApiKey:n,userId:e.uid,onDone:()=>i("local")}):c.jsx("div",{className:"alert alert-info",children:"Log in to import from Excel."})]}),o&&c.jsx(qW,{selected:o,showDetails:u,loading:d,onToggleDetails:()=>f(O=>!O),onAdd:y,onClose:b})]})},QW=()=>{var _,k;const{currentUser:e}=ln(),[t,r]=U.useState([]),[n,s]=U.useState({}),[a,i]=U.useState(!0),[o,l]=U.useState(null),[u,f]=U.useState(null),[d,m]=U.useState(!1),[p,x]=U.useState(!1);U.useEffect(()=>{(async()=>{if(e)try{i(!0);const{userMovies:y,movies:b}=await Zu(e.uid);s(y),r(b)}catch(y){console.error("Error fetching movies:",y),l("Failed to load movies")}finally{i(!1)}})()},[e]);const g=()=>{if(t.length===0)return;x(!0),f(null);const E=t.filter(D=>{const v=n[D.id];return d||!v||!v.watched});if(E.length===0){l("No eligible movies found. Try including watched movies."),x(!1);return}let y=0;const b=25,O=setInterval(()=>{const D=Math.floor(Math.random()*E.length);f(E[D]),y++,y>=b&&(clearInterval(O),x(!1))},100)};return a?c.jsx("div",{className:"flex justify-center items-center min-h-[60vh]",children:c.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-xmas-gold"})}):c.jsxs("div",{className:"container mx-auto px-4 py-8",children:[c.jsx("div",{className:"mb-4",children:c.jsxs(Ge,{to:"/movies",className:"btn btn-primary btn-sm sm:btn-md",children:[c.jsx("i",{className:"fas fa-arrow-left mr-2"})," Back to Movies"]})}),c.jsx("h1",{className:"font-christmas text-3xl md:text-4xl text-xmas-line mb-6",children:"Christmas Movie Picker"}),o&&c.jsxs("div",{className:"alert alert-error mb-6",children:[c.jsx("i",{className:"fas fa-exclamation-circle mr-2"}),c.jsx("span",{children:o})]}),t.length===0?c.jsxs("div",{className:"bg-xmas-card p-8 rounded-lg text-center",children:[c.jsx("h3",{className:"text-xl mb-4",children:"No movies in your collection"}),c.jsx("p",{className:"mb-4",children:"Add some Christmas movies to use the random movie picker!"}),c.jsxs(Ge,{to:"/import",className:"btn btn-primary",children:[c.jsx("i",{className:"fas fa-file-import mr-2"})," Import Movies"]})]}):c.jsxs("div",{className:"bg-xmas-card p-8 rounded-lg shadow-lg",children:[c.jsxs("div",{className:"text-center mb-6",children:[c.jsx("p",{className:"mb-4",children:"Can't decide what Christmas movie to watch? Let us pick one for you!"}),c.jsx("div",{className:"form-control mb-6",children:c.jsxs("label",{className:"label cursor-pointer justify-center",children:[c.jsx("span",{className:"label-text mr-2",children:"Include watched movies"}),c.jsx("input",{type:"checkbox",className:"toggle toggle-primary",checked:d,onChange:()=>m(!d)})]})}),c.jsx("button",{className:"btn btn-primary btn-lg",onClick:g,disabled:p,children:p?c.jsxs(c.Fragment,{children:[c.jsx("span",{className:"loading loading-spinner loading-md mr-2"}),"Picking a movie..."]}):c.jsxs(c.Fragment,{children:[c.jsx("i",{className:"fas fa-random mr-2"}),"Pick a Random Movie"]})})]}),u&&c.jsx("div",{className:"mt-8 flex flex-col items-center",children:c.jsx("div",{className:"w-full max-w-md",children:c.jsxs("div",{className:"card bg-base-100 shadow-xl overflow-hidden",children:[c.jsxs("figure",{className:"relative",children:[u.posterUrl?c.jsx("img",{src:u.posterUrl,alt:u.title,className:"w-full object-contain",style:{aspectRatio:"2/3",maxHeight:"500px"},loading:"lazy"}):c.jsx("div",{className:"w-full flex items-center justify-center bg-gray-800",style:{aspectRatio:"2/3",maxHeight:"500px"},children:c.jsx("i",{className:"fas fa-film text-6xl text-gray-500"})}),((_=n[u.id])==null?void 0:_.watched)&&c.jsx("div",{className:"absolute top-4 left-4 badge badge-lg badge-success",children:"Already Watched"}),((k=n[u.id])==null?void 0:k.rating)&&c.jsxs("div",{className:"absolute top-4 right-4 badge badge-lg badge-warning",children:[c.jsx("i",{className:"fas fa-star mr-1"}),n[u.id].rating,"/10"]})]}),c.jsxs("div",{className:"card-body",children:[c.jsx("h2",{className:"card-title text-2xl font-christmas",children:u.title}),c.jsx("p",{className:"text-gray-400",children:u.releaseDate&&ds(u.releaseDate)}),c.jsxs("div",{className:"card-actions justify-end mt-4",children:[c.jsx(Ge,{to:mv(u.title,u.id),className:"btn btn-primary",children:"View Details"}),c.jsx("button",{className:"btn btn-outline",onClick:g,disabled:p,children:"Pick Another"})]})]})]})})})]})]})},JW=(e,t)=>{const r=["Title","TMDB ID","Release Year","Watched","Watched Date","Rating","Review","Favorite","Date Added"].join(","),n=e.map(s=>{const a=t[s.id];if(!a)return null;const i=s.releaseDate?s.releaseDate.substring(0,4):"",o=a.watchedDate?cg(a.watchedDate):"",l=a.addedAt?cg(a.addedAt):"",u=wE(s.title),f=a.review?wE(a.review):"";return[u,s.imdbId||"",i,a.watched?"Yes":"No",o,a.rating!==null&&a.rating!==void 0?a.rating:"",f,a.favorite?"Yes":"No",l].join(",")}).filter(Boolean);return[r,...n].join(`
`)},cg=e=>{if(!(e instanceof Date))try{e&&typeof e.toDate=="function"?e=e.toDate():e=new Date(e)}catch{return""}return e.toISOString().split("T")[0]},wE=e=>e?e.includes(",")||e.includes('"')||e.includes(`
`)?`"${e.replace(/"/g,'""')}"`:e:"",ZW=(e,t,r)=>{const n=document.createElement("a"),s=new Blob([e],{type:r});n.href=URL.createObjectURL(s),n.download=t,n.click(),URL.revokeObjectURL(n.href)},ez=async(e,t,r)=>{const n=JW(e,t),s=`${r.replace(/\s+/g,"_")}_christmas_movies_${cg(new Date)}.csv`;ZW(n,s,"text/csv;charset=utf-8;")},tz=async()=>{const e=Tt(De,"movies"),t=await Mt(e);let r=0;const n=t.size;for(const s of t.docs){const a=s.data();if(a.sortTitle)continue;const i=$A(a.title);i!==a.title&&(await Fn(dt(De,"movies",s.id),{sortTitle:i,updatedAt:new Date}),r++)}return{updated:r,total:n}},rz=()=>{const{currentUser:e}=ln(),[t,r]=U.useState([]),[n,s]=U.useState(!1),[a,i]=U.useState(null),[o,l]=U.useState(null),[u,f]=U.useState(new Set);U.useEffect(()=>{(async()=>{if(e){s(!0),i(null);try{const g=Dn(Tt(De,"Requests"),rn("userId","==",e.uid)),k=(await Mt(g)).docs.map(E=>{const y=E.data();return{id:E.id,title:y.title,year:y.year??null,status:y.status,tmdbId:y.tmdbId??null,createdAt:y.createdAt,updatedAt:y.updatedAt}});if(r(k),e&&k.length>0){const E=[];for(const y of k){if(y.status!=="fulfilled"||!y.tmdbId)continue;const b=Tt(De,"movies"),O=Dn(b,rn("tmdbId","==",y.tmdbId)),D=await Mt(O);if(D.empty)continue;const T=D.docs[0].id,S=dt(De,`users/${e.uid}/movies`,T);(await En(S)).exists()&&E.push(y.id)}E.length>0&&f(new Set(E))}}catch(g){console.error("Error loading your movie requests:",g),i(g.message||"Failed to load your movie requests")}finally{s(!1)}}})()},[e]);const d=x=>{if(!x)return"";const g=x!=null&&x.toDate?x.toDate():x;try{return new Date(g).toLocaleString()}catch{return""}},m=x=>x==="fulfilled"?"badge badge-success":x==="dismissed"?"badge badge-ghost":"badge badge-warning",p=async x=>{if(e){if(!x.tmdbId){i("This request does not have a TMDB ID to match a movie.");return}try{i(null),l(x.id);const g=Tt(De,"movies"),_=Dn(g,rn("tmdbId","==",x.tmdbId)),k=await Mt(_);if(k.empty){i("Could not find this movie in the catalogue yet.");return}const y=k.docs[0].id;await Ju(e.uid,y,{userId:e.uid,movieId:y,watched:!1,favorite:!1}),f(b=>new Set(b).add(x.id))}catch(g){console.error("Failed to add movie to your collection:",g),i(g.message||"Failed to add movie to your collection")}finally{l(null)}}};return c.jsxs("div",{className:"mt-8",children:[c.jsx("h3",{className:"text-lg font-bold mb-2",children:"My Movie Requests"}),c.jsx("p",{className:"text-sm opacity-80 mb-4",children:"These are movies you've asked to be added to the catalogue."}),n&&c.jsx("div",{className:"flex justify-center py-4",children:c.jsx("span",{className:"loading loading-spinner loading-md"})}),a&&c.jsxs("div",{className:"alert alert-error mb-4",children:[c.jsx("i",{className:"fas fa-exclamation-circle mr-2"}),c.jsx("span",{children:a})]}),!n&&!a&&t.length===0&&c.jsx("p",{className:"text-sm opacity-80",children:"You haven't requested any movies yet."}),!n&&!a&&t.length>0&&c.jsx("div",{className:"overflow-x-auto",children:c.jsxs("table",{className:"table table-zebra table-sm",children:[c.jsx("thead",{children:c.jsxs("tr",{children:[c.jsx("th",{children:"Title"}),c.jsx("th",{children:"Year"}),c.jsx("th",{children:"Status"}),c.jsx("th",{children:"Last Updated"}),c.jsx("th",{})]})}),c.jsx("tbody",{children:t.map(x=>c.jsxs("tr",{children:[c.jsx("td",{children:x.title}),c.jsx("td",{children:x.year||"-"}),c.jsx("td",{children:c.jsx("span",{className:m(x.status),children:x.status})}),c.jsx("td",{className:"text-xs",children:d(x.updatedAt||x.createdAt)}),c.jsx("td",{children:x.status==="fulfilled"&&x.tmdbId&&(u.has(x.id)?c.jsx("span",{className:"badge badge-success text-xs",children:"In collection"}):c.jsxs("button",{className:"btn btn-xs btn-primary",onClick:()=>p(x),disabled:o===x.id,children:[o===x.id&&c.jsx("span",{className:"loading loading-spinner loading-xs mr-1"}),"Add to my movies"]}))})]},x.id))})]})})]})},nz=()=>{const{currentUser:e,userProfile:t,signOut:r}=ln(),{isAdmin:n}=Ol(),[s,a]=U.useState(!1),[i,o]=U.useState(!1),[l,u]=U.useState(""),[f,d]=U.useState(""),[m,p]=U.useState(!1),[x,g]=U.useState(""),[_,k]=U.useState(!1),[E,y]=U.useState(!1),[b,O]=U.useState(!1),[D,v]=U.useState(null),[T,S]=U.useState(null),[N,C]=U.useState({totalMovies:0,watchedMovies:0,unwatchedMovies:0,averageRating:0,favoriteMovies:0});U.useEffect(()=>{t!=null&&t.omdbApiKey&&u(t.omdbApiKey),t!=null&&t.fanartApiKey&&d(t.fanartApiKey),t!=null&&t.tmdbApiKey&&g(t.tmdbApiKey),(async()=>{if(e)try{const X=await VA(e.uid),H=X.length,Z=X.filter(L=>L.watched).length,Y=H-Z,M=X.filter(L=>L.favorite).length,q=X.filter(L=>L.rating!==void 0&&L.rating!==null),K=q.length>0?q.reduce((L,J)=>L+(J.rating||0),0)/q.length:0;C({totalMovies:H,watchedMovies:Z,unwatchedMovies:Y,averageRating:K,favoriteMovies:M})}catch(X){console.error("Error fetching user stats:",X)}})()},[e,t]);const R=async()=>{if(e)try{k(!0),v(null);const ae=dt(De,"users",e.uid);await Fn(ae,{tmdbApiKey:x||null}),S("TMDb API key saved successfully!"),setTimeout(()=>{S(null)},3e3)}catch(ae){console.error("Error saving TMDb API key:",ae),v(ae.message||"Failed to save TMDb API key")}finally{k(!1)}},F=async()=>{if(e)try{k(!0),v(null);const ae=dt(De,"users",e.uid);await Fn(ae,{omdbApiKey:l}),S("OMDb API key saved successfully!"),setTimeout(()=>{S(null)},3e3)}catch(ae){console.error("Error saving API key:",ae),v(ae.message||"Failed to save API key")}finally{k(!1)}},oe=async()=>{if(e)try{k(!0),v(null);const ae=dt(De,"users",e.uid);await Fn(ae,{fanartApiKey:f||null}),S("fanart.tv API key saved successfully!"),setTimeout(()=>{S(null)},3e3)}catch(ae){console.error("Error saving fanart.tv API key:",ae),v(ae.message||"Failed to save fanart.tv API key")}finally{k(!1)}},te=async()=>{try{await r()}catch(ae){console.error("Error signing out:",ae)}},de=async()=>{if(e)try{y(!0),v(null);const{userMovies:ae,movies:X}=await Zu(e.uid);await ez(X,ae,t.displayName||"User"),S("Movies exported successfully!"),setTimeout(()=>{S(null)},3e3)}catch(ae){console.error("Error exporting movies:",ae),v(ae.message||"Failed to export movies")}finally{y(!1)}};return!e||!t?c.jsx("div",{className:"flex justify-center items-center min-h-[60vh]",children:c.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-xmas-gold"})}):c.jsxs("div",{className:"container mx-auto px-4 py-8",children:[c.jsx("h1",{className:"font-christmas text-3xl md:text-4xl text-xmas-line mb-6",children:"Your Profile"}),D&&c.jsxs("div",{className:"alert alert-error mb-6",children:[c.jsx("i",{className:"fas fa-exclamation-circle mr-2"}),c.jsx("span",{children:D})]}),T&&c.jsxs("div",{className:"alert alert-success mb-6",children:[c.jsx("i",{className:"fas fa-check-circle mr-2"}),c.jsx("span",{children:T})]}),c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-8",children:[c.jsx("div",{className:"md:col-span-1",children:c.jsxs("div",{className:"bg-xmas-card p-6 rounded-lg shadow-lg",children:[c.jsxs("div",{className:"flex flex-col items-center mb-6",children:[t.photoURL?c.jsx("img",{src:t.photoURL,alt:t.displayName,className:"w-24 h-24 rounded-full mb-4"}):c.jsx("div",{className:"w-24 h-24 rounded-full bg-gray-700 flex items-center justify-center mb-4",children:c.jsx("i",{className:"fas fa-user text-4xl text-gray-400"})}),c.jsx("h2",{className:"text-xl font-bold",children:t.displayName})]}),c.jsx("div",{className:"divider"}),c.jsxs("div",{className:"mb-6",children:[c.jsx("h3",{className:"text-lg font-bold mb-2",children:"Your Stats"}),c.jsxs("ul",{className:"space-y-2",children:[c.jsxs("li",{className:"flex justify-between",children:[c.jsx("span",{children:"Total Movies:"}),c.jsx("span",{className:"font-bold",children:N.totalMovies})]}),c.jsxs("li",{className:"flex justify-between",children:[c.jsx("span",{children:"Watched:"}),c.jsx("span",{className:"font-bold",children:N.watchedMovies})]}),c.jsxs("li",{className:"flex justify-between",children:[c.jsx("span",{children:"Unwatched:"}),c.jsx("span",{className:"font-bold",children:N.unwatchedMovies})]}),c.jsxs("li",{className:"flex justify-between",children:[c.jsx("span",{children:"Favorites:"}),c.jsx("span",{className:"font-bold",children:N.favoriteMovies})]}),c.jsxs("li",{className:"flex justify-between",children:[c.jsx("span",{children:"Average Rating:"}),c.jsxs("span",{className:"font-bold",children:[N.averageRating.toFixed(1),"/10"]})]})]})]}),c.jsx("div",{className:"divider"}),c.jsxs("div",{className:"mt-6 space-y-3",children:[c.jsxs("button",{className:"btn btn-outline btn-primary w-full",onClick:de,disabled:E||N.totalMovies===0,children:[E?c.jsx("span",{className:"loading loading-spinner loading-sm mr-2"}):c.jsx("i",{className:"fas fa-file-export mr-2"}),"Export Movie Data"]}),c.jsxs("button",{className:"btn btn-outline btn-error w-full",onClick:te,children:[c.jsx("i",{className:"fas fa-sign-out-alt mr-2"}),"Sign Out"]})]})]})}),c.jsx("div",{className:"md:col-span-2",children:c.jsxs("div",{className:"bg-xmas-card p-6 rounded-lg shadow-lg",children:[c.jsxs("div",{className:"mb-6",children:[c.jsx("h2",{className:"text-2xl font-bold mb-4",children:"Artwork Settings"}),c.jsxs("div",{className:"mb-6",children:[c.jsx("h3",{className:"text-lg font-bold mb-2",children:"fanart.tv API Key"}),c.jsx("p",{className:"mb-4",children:"If you have a fanart.tv account, you can add your personal API key here to fetch alternative posters for movies in your collection."}),c.jsxs("div",{className:"form-control",children:[c.jsx("label",{className:"label",children:c.jsx("span",{className:"label-text",children:"API Key"})}),c.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 items-stretch",children:[c.jsx("input",{type:m?"text":"password",className:"input input-bordered flex-1 h-12 text-lg",value:f,onChange:ae=>d(ae.target.value),placeholder:"Enter your fanart.tv API key",style:{letterSpacing:m?"normal":"3px"}}),c.jsx("button",{type:"button",className:"btn btn-ghost w-12",onClick:()=>p(ae=>!ae),children:c.jsx("i",{className:`fas ${m?"fa-eye-slash":"fa-eye"}`})}),c.jsx("button",{className:"btn btn-primary w-full sm:w-auto",onClick:oe,disabled:_,children:_?c.jsx("span",{className:"loading loading-spinner loading-sm"}):c.jsx("i",{className:"fas fa-save"})})]})]})]})]}),n&&c.jsxs(c.Fragment,{children:[c.jsx("h2",{className:"text-2xl font-bold mb-4",children:"Settings"}),c.jsxs("div",{className:"mb-6",children:[c.jsx("h3",{className:"text-lg font-bold mb-2",children:"OMDb API Key"}),c.jsx("p",{className:"mb-4",children:"Your OMDb API key is used to fetch movies and other details from the Open Movie Database."}),c.jsxs("div",{className:"form-control",children:[c.jsx("label",{className:"label",children:c.jsx("span",{className:"label-text",children:"API Key"})}),c.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 items-stretch",children:[c.jsx("input",{type:i?"text":"password",className:"input input-bordered flex-1 h-12 text-lg",value:l,onChange:ae=>u(ae.target.value),placeholder:"Enter your OMDb API key",style:{letterSpacing:i?"normal":"3px"}}),c.jsx("button",{type:"button",className:"btn btn-ghost w-12",onClick:()=>o(ae=>!ae),children:c.jsx("i",{className:`fas ${i?"fa-eye-slash":"fa-eye"}`})}),c.jsx("button",{className:"btn btn-primary w-full sm:w-auto",onClick:F,disabled:_,children:_?c.jsx("span",{className:"loading loading-spinner loading-sm"}):c.jsx("i",{className:"fas fa-save"})})]})]})]}),c.jsxs("div",{className:"mb-6",children:[c.jsx("h3",{className:"text-lg font-bold mb-2",children:"TMDb API Key (Admin posters)"}),c.jsx("p",{className:"mb-4",children:"Used only in the admin poster manager to fetch official posters from The Movie Database using stored tmdbIds."}),c.jsxs("div",{className:"form-control",children:[c.jsx("label",{className:"label",children:c.jsx("span",{className:"label-text",children:"API Key"})}),c.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 items-stretch",children:[c.jsx("input",{type:s?"text":"password",className:"input input-bordered flex-1 h-12 text-lg",value:x,onChange:ae=>g(ae.target.value),placeholder:"Enter your TMDb API key",style:{letterSpacing:s?"normal":"3px"}}),c.jsx("button",{type:"button",className:"btn btn-ghost w-12",onClick:()=>a(ae=>!ae),children:c.jsx("i",{className:`fas ${s?"fa-eye-slash":"fa-eye"}`})}),c.jsx("button",{className:"btn btn-primary w-full sm:w-auto",onClick:R,disabled:_,children:_?c.jsx("span",{className:"loading loading-spinner loading-sm"}):c.jsx("i",{className:"fas fa-save"})})]})]})]}),c.jsx("div",{className:"divider"})]}),c.jsxs("div",{className:"mb-6",children:[c.jsx("h3",{className:"text-lg font-bold mb-2",children:"Quick Links"}),c.jsxs("div",{className:"flex flex-wrap gap-2",children:[c.jsxs(Ge,{to:"/movies",className:"btn btn-outline btn-sm",children:[c.jsx("i",{className:"fas fa-film mr-2"}),"My Movies"]}),c.jsxs(Ge,{to:"/import",className:"btn btn-outline btn-sm",children:[c.jsx("i",{className:"fas fa-file-import mr-2"}),"Add Movies"]}),c.jsxs(Ge,{to:"/random",className:"btn btn-outline btn-sm",children:[c.jsx("i",{className:"fas fa-random mr-2"}),"Random Movie Picker"]}),c.jsxs(Ge,{to:"/achievements",className:"btn btn-outline btn-sm",children:[c.jsx("i",{className:"fas fa-trophy mr-2"}),"Achievements"]})]})]}),c.jsx(rz,{}),n&&c.jsxs(c.Fragment,{children:[c.jsx("div",{className:"divider"}),c.jsxs("div",{className:"mb-6",children:[c.jsx("h3",{className:"text-lg font-bold mb-2",children:"Admin Tools"}),c.jsxs(Ge,{to:"/admin",className:"btn btn-primary btn-sm",children:[c.jsx("i",{className:"fas fa-tools mr-2"}),"Open Admin Dashboard"]})]})]})]})})]})]})},sz=({item:e})=>{const[t,r]=Cu.useState(!1);return c.jsxs("div",{className:"rounded-lg p-4 shadow-lg border transition-transform bg-xmas-card "+(e.unlocked?"border-xmas-gold hover:scale-[1.02]":"border-gray-700 opacity-70"),children:[c.jsxs("div",{className:"flex items-center mb-3",children:[c.jsx("div",{className:"relative mr-3 w-16 h-16 rounded-full overflow-hidden border border-xmas-gold/60 bg-gray-800 flex items-center justify-center",children:t?c.jsx("span",{className:"text-3xl",children:e.icon}):c.jsx("img",{src:`/achievements/${e.id}.png`,alt:e.name,className:"w-full h-full object-cover",loading:"lazy",onError:()=>r(!0)})}),c.jsxs("div",{children:[c.jsxs("h2",{className:"text-lg font-bold flex items-center gap-2",children:[e.name,e.unlocked&&c.jsx("span",{className:"badge badge-success badge-sm",children:"Unlocked"})]}),e.unlocked&&e.unlockedAt&&c.jsxs("p",{className:"text-xs text-xmas-text/70 mt-1",children:["Unlocked on"," ",e.unlockedAt.toLocaleDateString(void 0,{year:"numeric",month:"short",day:"numeric"})]})]})]}),c.jsx("p",{className:"text-sm text-xmas-text mb-3",children:e.unlocked?e.description:e.hint}),!e.unlocked&&c.jsx("p",{className:"text-xs text-xmas-text/60 italic",children:"Locked  keep watching to reveal this badge."})]})},az=()=>{const{currentUser:e}=ln(),[t,r]=U.useState(!0),[n,s]=U.useState([]);return U.useEffect(()=>{(async()=>{if(e)try{r(!0),await wh(e.uid);const i=Tt(De,`users/${e.uid}/achievements`),o=await Mt(i),l=new Map;o.forEach(f=>{const d=f.data();let m=null;d.unlockedAt instanceof Date?m=d.unlockedAt:d.unlockedAt&&typeof d.unlockedAt.toDate=="function"&&(m=d.unlockedAt.toDate()),l.set(f.id,{unlockedAt:m,seen:d.seen})});const u=sl.map(f=>{const d=l.get(f.id);return{id:f.id,name:f.name,description:f.description,hint:f.hint,icon:f.icon,unlocked:!!d,unlockedAt:(d==null?void 0:d.unlockedAt)??null}}).sort((f,d)=>{if(f.unlocked!==d.unlocked)return f.unlocked?-1:1;if(f.unlocked&&d.unlocked){const m=f.unlockedAt?f.unlockedAt.getTime():0,p=d.unlockedAt?d.unlockedAt.getTime():0;if(m!==p)return m-p}return f.name.localeCompare(d.name)});s(u)}finally{r(!1)}})()},[e]),e?t?c.jsx("div",{className:"flex justify-center items-center min-h-[60vh]",children:c.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-xmas-gold"})}):c.jsxs("div",{className:"container mx-auto px-4 py-8",children:[c.jsx("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between mb-6",children:c.jsxs("div",{children:[c.jsx("h1",{className:"font-christmas text-3xl md:text-4xl text-xmas-line mb-2",children:"Achievements"}),c.jsx("p",{className:"text-sm text-xmas-text/80",children:"Unlock festive badges as you watch, rate and explore your Christmas movies."})]})}),c.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-3 gap-6",children:n.map(a=>c.jsx(sz,{item:a},a.id))})]}):c.jsx("div",{className:"flex justify-center items-center min-h-[60vh]",children:c.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-xmas-gold"})})},iz=()=>{const{slug:e}=Hd(),[t,r]=U.useState(null),[n,s]=U.useState([]),[a,i]=U.useState({}),[o,l]=U.useState(null),[u,f]=U.useState(!0),[d,m]=U.useState(null);if(U.useEffect(()=>{(async()=>{if(e)try{f(!0),m(null);const _=Tt(De,"publicProfiles"),k=Dn(_,rn("publicWatchlistSlug","==",e),rn("isPublicWatchlist","==",!0)),E=await Mt(k);if(E.empty){m("This watchlist isn't public (or no longer exists)."),f(!1);return}const y=E.docs[0],b={id:y.id,...y.data()};r(b);const O=b.userId,{userMovies:D,movies:v}=await Zu(O),T=v.filter(F=>{const oe=D[F.id];return oe&&oe.watched}).sort((F,oe)=>{const te=D[F.id],de=D[oe.id],ae=(te==null?void 0:te.rating)??0,X=(de==null?void 0:de.rating)??0;return X!==ae?X-ae:F.title.localeCompare(oe.title)}),S={};T.forEach(F=>{S[F.id]=D[F.id]});const N=T.map(F=>S[F.id]).filter(F=>F&&F.rating!=null),C=N.length>0?N.reduce((F,oe)=>F+(oe.rating||0),0)/N.length:0,R=T.filter(F=>{var oe;return(oe=S[F.id])==null?void 0:oe.favorite}).length;s(T),i(S),l({totalWatched:T.length,averageRating:C,favoriteMovies:R})}catch(_){console.error("Error loading public watchlist:",_),m("This watchlist isn't public (or no longer exists).")}finally{f(!1)}})()},[e]),U.useEffect(()=>{if(!(typeof document>"u"))if(t){const g=t.publicWatchlistName||`${t.displayName}'s Xmas Watchlist`;document.title=`${g}  Christmas Movies`}else document.title="Christmas Movies"},[t]),u)return c.jsx("div",{className:"flex justify-center items-center min-h-[60vh]",children:c.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-xmas-gold"})});if(d||!t)return c.jsx("div",{className:"container mx-auto px-4 py-16",children:c.jsxs("div",{className:"bg-xmas-card p-8 rounded-lg text-center max-w-xl mx-auto",children:[c.jsx("h1",{className:"font-christmas text-3xl text-xmas-line mb-4",children:"Watchlist Not Available"}),c.jsx("p",{className:"mb-4",children:d||"This watchlist isn't public (or no longer exists)."}),c.jsxs(Ge,{to:"/",className:"btn btn-primary",children:[c.jsx("i",{className:"fas fa-home mr-2"}),"Go to Home"]})]})});const p=t.publicWatchlistName||`${t.displayName}'s Xmas Watchlist`,x=t.publicWatchlistTagline;return c.jsxs("div",{className:"container mx-auto px-2 sm:px-4 py-6 sm:py-10",children:[c.jsxs("header",{className:"mb-6 sm:mb-8 flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[c.jsxs("div",{className:"flex items-center gap-4",children:[t.photoURL?c.jsx("img",{src:t.photoURL,alt:t.displayName,className:"w-16 h-16 sm:w-20 sm:h-20 rounded-full border-2 border-xmas-gold shadow-lg"}):c.jsx("div",{className:"w-16 h-16 sm:w-20 sm:h-20 rounded-full bg-gray-700 flex items-center justify-center border-2 border-xmas-gold shadow-lg",children:c.jsx("i",{className:"fas fa-user text-2xl text-gray-300"})}),c.jsxs("div",{children:[c.jsx("h1",{className:"font-christmas text-2xl sm:text-3xl md:text-4xl text-xmas-line mb-1",children:p}),x&&c.jsx("p",{className:"text-sm sm:text-base text-xmas-mute",children:x})]})]}),o&&c.jsxs("div",{className:"bg-xmas-card px-4 py-3 rounded-lg shadow-md flex flex-wrap gap-4 text-sm sm:text-base",children:[c.jsxs("div",{children:[c.jsx("div",{className:"text-xs uppercase tracking-wide text-xmas-mute",children:"Watched"}),c.jsx("div",{className:"font-bold text-lg",children:o.totalWatched})]}),c.jsxs("div",{children:[c.jsx("div",{className:"text-xs uppercase tracking-wide text-xmas-mute",children:"Average Rating"}),c.jsxs("div",{className:"font-bold text-lg",children:[o.averageRating.toFixed(1),"/10"]})]}),c.jsxs("div",{children:[c.jsx("div",{className:"text-xs uppercase tracking-wide text-xmas-mute",children:"Favorites"}),c.jsx("div",{className:"font-bold text-lg",children:o.favoriteMovies})]})]})]}),n.length===0?c.jsxs("div",{className:"bg-xmas-card p-8 rounded-lg text-center max-w-xl mx-auto",children:[c.jsx("h2",{className:"text-xl mb-3",children:"No watched movies yet"}),c.jsx("p",{className:"text-sm text-xmas-mute",children:"As soon as they start marking movies as watched, they'll show up here."})]}):c.jsx("div",{className:"grid grid-cols-3 sm:grid-cols-4 md:grid-cols-5 lg:grid-cols-6 gap-2 sm:gap-3",children:n.map(g=>{const _=a[g.id],k=g.posterUrl,E=BA(k||"","w185");return c.jsx(Ge,{to:`/u/${e}/m/${jA(g.title)}?id=${g.id}`,className:"block transition-transform hover:scale-[1.02] hover:shadow-xl",children:c.jsxs("div",{className:"relative rounded-lg overflow-hidden bg-xmas-card shadow-md h-full flex flex-col",children:[c.jsxs("div",{className:"relative",children:[k?c.jsx("img",{src:E,alt:g.title,className:"w-full h-auto object-cover",style:{aspectRatio:"2/3"},loading:"lazy"}):c.jsx("div",{className:"w-full flex items-center justify-center bg-gray-800",style:{aspectRatio:"2/3"},children:c.jsx("i",{className:"fas fa-film text-2xl text-gray-500"})}),_&&_.watched&&c.jsx("div",{className:"absolute top-1 right-1 bg-primary rounded-full p-1 shadow-md",children:c.jsx("i",{className:"fas fa-check text-xs text-white"})}),_&&_.favorite&&c.jsx("div",{className:"absolute top-1 left-1 text-yellow-400 drop-shadow-md",children:c.jsx("i",{className:"fas fa-star text-sm"})})]}),c.jsxs("div",{className:"p-1 sm:p-2 flex-grow flex flex-col",children:[c.jsx("h3",{className:"text-xs sm:text-sm font-medium line-clamp-2",children:g.title}),c.jsxs("div",{className:"flex justify-between items-center mt-1",children:[c.jsx("p",{className:"text-xs text-gray-400",children:g.releaseDate&&ds(g.releaseDate)}),_&&_.rating!=null&&c.jsxs("div",{className:"flex items-center",children:[c.jsx("span",{className:"text-yellow-400 mr-0.5",children:c.jsx("i",{className:"fas fa-star text-xs"})}),c.jsx("span",{className:"text-xs",children:_.rating})]})]})]})]})},g.id)})})]})},$v="https://api.watchmode.com/v1",EE=["GB","US","CA"],TE="GB",oz=24*60*60*1e3,Wv="jg4HbDMFz2bE6i1YPoqDMFqo5Rmh6AEqP9mqqQdO";let Am=null;async function zv(e){const t=await fetch(e);if(!t.ok)throw new Error(`Watchmode API error ${t.status}`);return await t.json()}async function lz(e){var t;try{const r=e.releaseDate?new Date(e.releaseDate).getFullYear():void 0,n=new URLSearchParams({apiKey:Wv,search_field:"name",search_value:e.title}),s=`${$v}/search/?${n.toString()}`,a=await zv(s);if(!((t=a.title_results)!=null&&t.length))return null;if(r){const i=a.title_results.find(o=>o.year===r);if(i)return i.id}return a.title_results[0].id}catch(r){return console.error("Watchmode name search failed",r),null}}async function cz(e){const t=new URLSearchParams({apiKey:Wv,regions:EE.join(",")}),r=`${$v}/title/${e}/sources/?${t.toString()}`,n=await zv(r),s=new Set(EE.map(a=>a.toUpperCase()));return n.filter(a=>s.has((a.region||"").toUpperCase())&&!!a.name)}async function uz(){if(Am)return Am;try{const e=`${$v}/sources/?apiKey=${Wv}`,t=await zv(e),r={};for(const n of t)r[n.id]=n;return Am=r,r}catch(e){return console.error("Failed to load Watchmode source metadata",e),null}}async function fz(e){var o;if(!(e!=null&&e.id))return null;const t=dt(Tt(De,"watchmodeSources"),e.id);try{const l=await En(t);if(l.exists()){const u=l.data(),f=(o=u.updatedAt)!=null&&o.toDate?u.updatedAt.toDate():new Date(u.updatedAt),d=Date.now()-f.getTime()<oz,m=Array.isArray(u.sources)&&u.sources.length>0;if(d&&m)return{movieId:e.id,region:u.region||TE,watchmodeTitleId:u.watchmodeTitleId??void 0,sources:u.sources||[],updatedAt:f,errorCode:u.errorCode??null}}}catch(l){console.error("Error reading Watchmode cache",l)}const r=await lz(e);let n=[],s=null;if(r)try{n=await cz(r)}catch(l){console.error("Error fetching Watchmode sources",l),s="sources_fetch_failed"}else s="title_not_found";const a=n.map(({ios_url:l,android_url:u,...f})=>f),i={movieId:e.id,region:TE,watchmodeTitleId:r||null,sources:a,updatedAt:new Date,errorCode:s};try{await Zn(t,i,{merge:!0})}catch(l){console.error("Error updating Watchmode cache",l)}return{movieId:i.movieId,region:i.region,watchmodeTitleId:r||void 0,sources:a,updatedAt:i.updatedAt,errorCode:s}}function hz(e){const[t,r]=U.useState({loading:!1,error:null,data:null});return U.useEffect(()=>{let n=!1;return(async()=>{if(!e){r({loading:!1,error:null,data:null});return}r(a=>({...a,loading:!0,error:null}));try{const a=await fz(e);if(n)return;r({loading:!1,error:null,data:a})}catch(a){if(console.error("useWatchmodeSources error",a),n)return;r({loading:!1,error:"Failed to load streaming info",data:null})}})(),()=>{n=!0}},[e==null?void 0:e.id]),t}const dz=({movie:e})=>{const{loading:t,error:r,data:n}=hz(e),[s,a]=U.useState(null),[i,o]=U.useState(!1);if(U.useEffect(()=>{let p=!1;return(async()=>{const g=await uz();p||a(g)})(),()=>{p=!0}},[]),!e)return null;if(t&&!n)return c.jsx("div",{className:"mt-6 text-sm text-xmas-mute",children:"Looking up where to watch"});if(r)return null;const l=(n==null?void 0:n.sources)||[],u=["GB","US","CA"],f={};for(const p of l){const x=(p.region||"").toUpperCase();f[x]||(f[x]=[]),f[x].push(p)}const d=p=>{const x=new Map;for(const g of p)x.has(g.name)||x.set(g.name,g);return Array.from(x.values())},m=()=>c.jsx("div",{className:"grid gap-4 sm:gap-5 md:grid-cols-3",children:u.map(p=>{const x=f[p];if(!x||!x.length)return null;const g=x.filter(y=>y.type==="sub"||y.type==="subscription"),_=x.filter(y=>y.type==="buy"||y.type==="rent"||y.type==="purchase"||y.type==="buy/rent"),k=x.filter(y=>y.type==="free");if(!g.length&&!_.length&&!k.length)return null;const E=p==="GB"?"UK":p;return c.jsxs("div",{className:"bg-black/10 rounded-md p-3 sm:p-4 flex flex-col gap-3",children:[c.jsx("h3",{className:"text-sm font-semibold mb-1",children:E}),k.length>0&&c.jsxs("div",{children:[c.jsx("div",{className:"text-xs uppercase tracking-wide text-xmas-mute mb-1",children:"Free"}),c.jsx("div",{className:"flex flex-wrap gap-3",children:d(k).map(y=>{const b=s?s[y.source_id]:void 0;return b!=null&&b.logo_100px?c.jsx("a",{href:y.web_url||void 0,target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center justify-center rounded-lg overflow-hidden bg-white/5 hover:bg-white/10 transition-colors",children:c.jsx("img",{src:b.logo_100px,alt:y.name,className:"h-10 w-10 sm:h-12 sm:w-12 object-contain",loading:"lazy"})},y.name+y.web_url):null})})]}),g.length>0&&c.jsxs("div",{children:[c.jsx("div",{className:"text-xs uppercase tracking-wide text-xmas-mute mb-1",children:"Streaming"}),c.jsx("div",{className:"flex flex-wrap gap-3",children:d(g).map(y=>{const b=s?s[y.source_id]:void 0;return b!=null&&b.logo_100px?c.jsx("a",{href:y.web_url||void 0,target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center justify-center rounded-lg overflow-hidden bg-white/5 hover:bg-white/10 transition-colors",children:c.jsx("img",{src:b.logo_100px,alt:y.name,className:"h-10 w-10 sm:h-12 sm:w-12 object-contain",loading:"lazy"})},y.name+y.web_url):null})})]}),_.length>0&&c.jsxs("div",{children:[c.jsx("div",{className:"text-xs uppercase tracking-wide text-xmas-mute mb-1",children:"Buy / Rent"}),c.jsx("div",{className:"flex flex-wrap gap-3",children:d(_).map(y=>{const b=s?s[y.source_id]:void 0;return b!=null&&b.logo_100px?c.jsx("a",{href:y.web_url||void 0,target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center justify-center rounded-lg overflow-hidden bg-white/5 hover:bg-white/10 transition-colors",children:c.jsx("img",{src:b.logo_100px,alt:y.name,className:"h-10 w-10 sm:h-12 sm:w-12 object-contain",loading:"lazy"})},y.name+y.web_url):null})})]})]},p)})});return l.length?c.jsxs("div",{className:"mt-6",children:[c.jsx("div",{className:"divider"}),c.jsxs("div",{className:"bg-xmas-card/40 border border-xmas-gold/40 rounded-lg overflow-hidden",children:[c.jsxs("button",{type:"button",className:"w-full flex items-center justify-between text-left px-4 py-3 sm:px-5 sm:py-4 bg-xmas-card/60 hover:bg-xmas-card transition-colors cursor-pointer",onClick:()=>o(p=>!p),children:[c.jsxs("div",{className:"flex items-center gap-3",children:[c.jsx("i",{className:"fas fa-tv text-xmas-gold"}),c.jsx("h2",{className:"text-lg sm:text-xl font-bold flex-1",children:"Where to watch"})]}),c.jsx("span",{className:`ml-3 text-sm text-xmas-mute transition-transform duration-200 ${i?"rotate-180":"rotate-0"}`,children:c.jsx("i",{className:"fas fa-chevron-down"})})]}),i&&c.jsxs("div",{className:"px-4 py-3 sm:px-5 sm:py-5",children:[c.jsx("p",{className:"text-xs text-xmas-mute mb-4",children:"Powered by Watchmode. Availability can change, so please double-check on the provider's site."}),m()]})]})]}):c.jsxs("div",{className:"mt-6",children:[c.jsx("div",{className:"divider"}),c.jsxs("div",{className:"bg-xmas-card/40 border border-xmas-gold/40 rounded-lg overflow-hidden",children:[c.jsxs("button",{type:"button",className:"w-full flex items-center justify-between text-left px-4 py-3 sm:px-5 sm:py-4 bg-xmas-card/60 hover:bg-xmas-card transition-colors cursor-pointer",onClick:()=>o(p=>!p),children:[c.jsxs("div",{className:"flex items-center gap-3",children:[c.jsx("i",{className:"fas fa-tv text-xmas-gold"}),c.jsx("h2",{className:"text-lg sm:text-xl font-bold flex-1",children:"Where to watch"})]}),c.jsx("span",{className:`ml-3 text-sm text-xmas-mute transition-transform duration-200 ${i?"rotate-180":"rotate-0"}`,children:c.jsx("i",{className:"fas fa-chevron-down"})})]}),i&&c.jsxs("div",{className:"px-4 py-3 sm:px-5 sm:py-5 text-xs text-xmas-mute",children:[c.jsx("p",{className:"mb-2",children:"Powered by Watchmode. Availability can change, so please double-check on the provider's site."}),c.jsx("p",{children:"We couldn't find any current streaming options via Watchmode for this title."})]})]})]})},mz=()=>{const{slug:e}=Hd(),[t]=eP(),r=ts(),[n,s]=U.useState(null),[a,i]=U.useState(null),[o,l]=U.useState(null),[u,f]=U.useState(!0),[d,m]=U.useState(null);if(U.useEffect(()=>{(async()=>{const _=t.get("id");if(!(!e||!_))try{f(!0),m(null);const k=Tt(De,"publicProfiles"),E=Dn(k,rn("publicWatchlistSlug","==",e),rn("isPublicWatchlist","==",!0)),y=await Mt(E);if(y.empty){m("This watchlist isn't public (or no longer exists)."),f(!1);return}const b=y.docs[0],O={id:b.id,...b.data()};s(O);const D=O.userId,v=dt(De,"movies",_),T=await En(v);if(!T.exists()){m("Movie not found"),f(!1);return}const S={id:T.id,...T.data()};i(S);const N=dt(De,"users",D,"movies",_),C=await En(N);C.exists()?l({id:C.id,...C.data()}):l(null)}catch(k){console.error("Error loading public movie",k),m("Failed to load this movie.")}finally{f(!1)}})()},[e,t]),U.useEffect(()=>{if(!(typeof document>"u"))if(a&&n){const g=n.publicWatchlistName||`${n.displayName}'s Xmas Watchlist`;document.title=`${a.title}  ${g}`}else document.title="Christmas Movies"},[a,n]),u)return c.jsx("div",{className:"flex justify-center items-center min-h-[60vh]",children:c.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-xmas-gold"})});if(d||!n||!a)return c.jsx("div",{className:"container mx-auto px-4 py-16",children:c.jsxs("div",{className:"bg-xmas-card p-8 rounded-lg text-center max-w-xl mx-auto",children:[c.jsx("h1",{className:"font-christmas text-3xl text-xmas-line mb-4",children:"Movie Not Available"}),c.jsx("p",{className:"mb-4",children:d||"This movie could not be found for this watchlist."}),e&&c.jsxs("button",{className:"btn btn-primary",onClick:()=>r(`/u/${e}`),children:[c.jsx("i",{className:"fas fa-arrow-left mr-2"}),"Back to Watchlist"]})]})});const p=n.publicWatchlistName||`${n.displayName}'s Xmas Watchlist`,x=o!=null&&o.watched?"Watched":"Not watched yet";return c.jsxs("div",{className:"container mx-auto px-2 sm:px-4 py-6 sm:py-10",children:[c.jsx("div",{className:"mb-4 flex flex-wrap justify-between items-center gap-2",children:c.jsxs("div",{className:"flex items-center gap-3",children:[n.photoURL?c.jsx("img",{src:n.photoURL,alt:n.displayName,className:"w-10 h-10 rounded-full border border-xmas-gold"}):c.jsx("div",{className:"w-10 h-10 rounded-full bg-gray-700 flex items-center justify-center border border-xmas-gold",children:c.jsx("i",{className:"fas fa-user text-sm text-gray-300"})}),c.jsxs("div",{className:"text-sm",children:[c.jsx("div",{className:"font-semibold mb-1",children:p}),c.jsxs("button",{className:"btn btn-primary btn-sm px-4 py-2 rounded-md shadow-lg hover:shadow-xl transition-all duration-300 border border-xmas-gold border-opacity-30 flex items-center gap-2",onClick:()=>r(`/u/${e}`),children:[c.jsx("i",{className:"fas fa-arrow-left"}),c.jsx("span",{children:"Back to watchlist"})]})]})]})}),c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-8",children:[c.jsxs("div",{className:"md:col-span-1",children:[c.jsx("div",{className:"rounded-lg overflow-hidden shadow-xl",children:a.posterUrl?c.jsx("img",{src:a.posterUrl,alt:a.title,className:"w-full object-contain",style:{aspectRatio:"2/3"}}):c.jsx("div",{className:"w-full flex items-center justify-center bg-gray-800",style:{aspectRatio:"2/3"},children:c.jsx("i",{className:"fas fa-film text-6xl text-gray-500"})})}),o&&c.jsxs("div",{className:"mt-4 space-y-2 text-sm",children:[c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsx("span",{className:"text-xs uppercase tracking-wide text-xmas-mute",children:"Status"}),c.jsx("span",{className:"font-semibold",children:x})]}),o.rating!=null&&c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsx("span",{className:"text-xs uppercase tracking-wide text-xmas-mute",children:"Rating"}),c.jsxs("div",{className:"flex items-center gap-1",children:[c.jsx("span",{className:"text-yellow-400",children:c.jsx("i",{className:"fas fa-star"})}),c.jsxs("span",{className:"font-semibold",children:[o.rating,"/10"]})]})]}),o.watchedDate&&c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsx("span",{className:"text-xs uppercase tracking-wide text-xmas-mute",children:"Watched on"}),c.jsx("span",{className:"font-semibold",children:(()=>{var _;const g=(_=o.watchedDate)!=null&&_.toDate?o.watchedDate.toDate():new Date(o.watchedDate);return isNaN(g.getTime())?"":g.toLocaleDateString()})()})]}),o.vibeTags&&o.vibeTags.length>0&&c.jsxs("div",{children:[c.jsx("div",{className:"text-xs uppercase tracking-wide text-xmas-mute mb-1",children:"Vibe review"}),c.jsx("div",{className:"flex flex-wrap gap-1.5",children:o.vibeTags.map(g=>c.jsx("span",{className:"badge badge-sm bg-xmas-gold bg-opacity-20 text-[0.7rem] border-xmas-gold",children:g},g))})]})]})]}),c.jsxs("div",{className:"md:col-span-2",children:[c.jsx("h1",{className:"font-christmas text-3xl md:text-4xl text-xmas-line mb-2",children:a.title}),a.releaseDate&&c.jsx("p",{className:"text-lg text-gray-400 mb-4",children:new Date(a.releaseDate).getFullYear()}),a.genres&&a.genres.length>0&&c.jsx("div",{className:"flex flex-wrap gap-2 mb-4",children:a.genres.map(g=>c.jsx("span",{className:"badge badge-outline",children:g},g))}),a.runtime&&c.jsxs("p",{className:"mb-4",children:[c.jsx("i",{className:"fas fa-clock mr-2 text-xmas-gold"}),Math.floor(a.runtime/60),"h ",a.runtime%60,"m"]}),a.overview&&c.jsxs("div",{className:"mb-6",children:[c.jsx("h2",{className:"text-xl font-bold mb-2",children:"Overview"}),c.jsx("p",{className:"text-gray-300",children:a.overview})]}),a.directors&&a.directors.length>0&&c.jsxs("div",{className:"mb-4",children:[c.jsxs("h2",{className:"text-xl font-bold mb-2",children:["Director",a.directors.length>1?"s":""]}),c.jsx("p",{children:a.directors.join(", ")})]}),a.cast&&a.cast.length>0&&c.jsxs("div",{className:"mb-6",children:[c.jsx("h2",{className:"text-xl font-bold mb-2",children:"Cast"}),c.jsx("p",{className:"flex flex-wrap gap-1",children:a.cast.slice(0,10).map((g,_)=>c.jsxs(Cu.Fragment,{children:[c.jsx("span",{children:g}),_<Math.min(a.cast.length,10)-1&&c.jsx("span",{children:","})]},g))})]}),o&&o.review&&c.jsxs("div",{className:"mt-6",children:[c.jsx("div",{className:"divider"}),c.jsx("h2",{className:"text-xl font-bold mb-2",children:"Their Thoughts"}),c.jsx("p",{className:"whitespace-pre-line text-gray-200 text-sm sm:text-base",children:o.review})]}),c.jsx(dz,{movie:a})]})]})]})},pz=7*24*60*60*1e3,gz=async(e,t,r)=>{if(t.fanartPosters&&t.fanartPosters.length>0&&t.lastFanartFetchAt){const s=t.lastFanartFetchAt instanceof Date?t.lastFanartFetchAt:new Date(t.lastFanartFetchAt.seconds*1e3);if(Date.now()-s.getTime()<pz)return t.fanartPosters.map(a=>({url:a}))}const n=!!t.imdbId||t.tmdbId!=null;if(!r||!n)return(t.fanartPosters||[]).map(s=>({url:s}));try{const s=u6(m6,"fanartProxy"),a=t.tmdbId,i=typeof a=="number"?a:typeof a=="string"&&a.trim()?Number(a):void 0,o=await s({imdbId:t.imdbId,tmdbId:i,apiKey:r}),l=Array.isArray(o.data.posters)?o.data.posters:[],u=Array.from(new Set(l.filter(f=>typeof f=="string"&&f)));try{const f=dt(De,"movies",e);await Fn(f,{fanartPosters:u,lastFanartFetchAt:new Date})}catch(f){console.error("Failed to cache fanart posters on movie doc",f)}return u.map(f=>({url:f}))}catch(s){return console.error("fanartProxy callable failed",s),(t.fanartPosters||[]).map(a=>({url:a}))}},xz=()=>{const{movieId:e}=Hd(),t=Ts(),r=ts(),{currentUser:n,userProfile:s}=ln(),a=LA(t.search),[i,o]=U.useState(null),[l,u]=U.useState(null),[f,d]=U.useState(""),[m,p]=U.useState([]),[x,g]=U.useState(!0),[_,k]=U.useState(!1),[E,y]=U.useState(null);U.useEffect(()=>{if(!n||!a)return;(async()=>{try{g(!0);const D=await En(dt(De,"movies",a));if(!D.exists()){y("Movie not found"),g(!1);return}const v={id:D.id,...D.data()};o(v);const T=await dd(n.uid,a);if(T?(u(T),d(T.posterUrlOverride||v.posterUrl||"")):d(v.posterUrl||""),(v.imdbId||v.tmdbId)&&(s!=null&&s.fanartApiKey))try{const S=await gz(a,v,s.fanartApiKey);p(S)}catch(S){console.error("Error loading fanart posters:",S)}}catch(D){console.error("Error loading movie/poster data:",D),y("Failed to load movie data")}finally{g(!1)}})()},[n,a,s]);const b=async()=>{if(!(!n||!a||!i))try{k(!0),y(null);const O={userId:n.uid,movieId:a,posterUrlOverride:f.trim()||null},D=await Ju(n.uid,a,O);u(D),r(`/movies/${e}${t.search}`)}catch(O){console.error("Failed to save poster override:",O),y((O==null?void 0:O.message)||"Failed to save poster")}finally{k(!1)}};return x?c.jsx("div",{className:"flex justify-center items-center min-h-[60vh]",children:c.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-xmas-gold"})}):i?c.jsxs("div",{className:"container mx-auto px-4 py-8",children:[c.jsxs("div",{className:"mb-4 flex items-center gap-2",children:[c.jsxs(Ge,{to:`/movies/${e}${t.search}`,className:"btn btn-primary btn-sm",children:[c.jsx("i",{className:"fas fa-arrow-left mr-2"}),"Back to Movie"]}),c.jsxs("h1",{className:"font-christmas text-2xl md:text-3xl text-xmas-line ml-2",children:["Edit Poster 	for ",i.title]})]}),E&&c.jsxs("div",{className:"alert alert-error mb-4",children:[c.jsx("i",{className:"fas fa-exclamation-circle mr-2"}),c.jsx("span",{children:E})]}),c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-8",children:[c.jsx("div",{children:c.jsx("div",{className:"rounded-lg overflow-hidden shadow-xl",children:f?c.jsx("img",{src:f,alt:i.title,className:"w-full object-contain",style:{aspectRatio:"2/3"}}):c.jsx("div",{className:"w-full flex items-center justify-center bg-gray-800",style:{aspectRatio:"2/3"},children:c.jsx("i",{className:"fas fa-film text-6xl text-gray-500"})})})}),c.jsx("div",{className:"md:col-span-2",children:c.jsxs("div",{className:"bg-xmas-card p-6 rounded-lg shadow-lg space-y-4",children:[c.jsx("h2",{className:"text-xl font-bold mb-2",children:"Choose a Poster from fanart.tv"}),!(s!=null&&s.fanartApiKey)&&c.jsx("p",{className:"text-sm text-warning mb-2",children:"Add your fanart.tv API key on your Profile page to see alternative posters."}),(s==null?void 0:s.fanartApiKey)&&m.length===0&&c.jsx("p",{className:"text-sm text-gray-300 mb-2",children:"No posters were returned from fanart.tv for this movie. The default poster will be used."}),m.length>0&&c.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-4 gap-4",children:m.map(O=>c.jsxs("button",{type:"button",className:`relative rounded-lg overflow-hidden border-2 transition-transform hover:scale-105 ${f===O.url?"border-primary":"border-transparent"}`,onClick:()=>d(O.url),children:[c.jsx("img",{src:O.url,alt:i.title,className:"w-full h-full object-cover",style:{aspectRatio:"2/3"}}),f===O.url&&c.jsx("div",{className:"absolute inset-0 bg-black bg-opacity-30 flex items-center justify-center",children:c.jsx("i",{className:"fas fa-check text-2xl text-primary-content"})})]},O.url))}),c.jsxs("div",{className:"flex gap-2 mt-4",children:[c.jsxs("button",{className:"btn btn-primary",onClick:b,disabled:_||!f,children:[_?c.jsx("span",{className:"loading loading-spinner loading-sm mr-2"}):c.jsx("i",{className:"fas fa-save mr-2"}),"Save Poster"]}),c.jsx("button",{className:"btn btn-outline",type:"button",onClick:()=>d(i.posterUrl||""),children:"Reset to default"})]})]})})]})]}):c.jsxs("div",{className:"container mx-auto px-4 py-8",children:[c.jsx("div",{className:"alert alert-error mb-4",children:c.jsx("span",{children:"Movie not found"})}),c.jsxs(Ge,{to:"/movies",className:"btn btn-primary btn-sm",children:[c.jsx("i",{className:"fas fa-arrow-left mr-2"}),"Back to Movies"]})]})},vz=()=>{const e=ts(),{isAdmin:t,loading:r,currentUser:n}=Ol(),[s,a]=U.useState(!1),[i,o]=U.useState(null),l=!1;U.useEffect(()=>{t&&!r&&e("/admin")},[t,r,e]);const u=async()=>{o(null),a(!0);try{await Hk(Oc,h6)}catch(f){console.error("Login error:",f),f.code==="auth/popup-closed-by-user"?o("Sign-in popup was closed. Please try again."):f.code==="auth/cancelled-popup-request"?o("Another popup is already open. Please try again."):f.code==="auth/unauthorized-domain"?(console.error("Unauthorized domain error:",window.location.hostname),o("This domain is not authorized for OAuth operations. Please add "+window.location.hostname+" to your Firebase authorized domains list in the Firebase console under Authentication > Sign-in method > Authorized domains.")):o("Failed to sign in. Please try again."),a(!1)}};return r?c.jsx("div",{className:"flex justify-center items-center min-h-[60vh]",children:c.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-xmas-gold"})}):c.jsx("div",{className:"container mx-auto px-4 py-12",children:c.jsxs("div",{className:"max-w-md mx-auto",children:[c.jsxs("div",{className:"text-center mb-8",children:[c.jsx("h1",{className:"font-christmas text-4xl text-xmas-line mb-2",children:"Admin Login"}),c.jsx("p",{className:"text-xmas-mute",children:"Sign in to manage the Christmas Quiz"})]}),c.jsxs("div",{className:"bg-xmas-card rounded-lg shadow-lg p-6",children:[l,n&&c.jsxs("div",{className:"bg-info bg-opacity-10 border-l-4 border-info p-4 mb-6 rounded",children:[c.jsx("p",{className:"text-info font-bold mb-2",children:"User Authenticated"}),c.jsxs("p",{className:"text-info text-sm mb-1",children:["Email: ",n.email]}),c.jsxs("p",{className:"text-info text-sm mb-2",children:["UID: ",n.uid]}),c.jsxs("p",{className:"text-info text-sm",children:["To grant admin access, create a document in the ",c.jsx("code",{className:"bg-base-300 px-1 py-0.5 rounded",children:"admins"})," collection with this UID as the document ID."]}),l]}),i&&c.jsx("div",{className:"bg-error bg-opacity-10 border-l-4 border-error p-4 mb-6 rounded",children:c.jsx("p",{className:"text-error",children:i})}),c.jsxs("div",{className:"text-center mb-6",children:[c.jsx("p",{className:"mb-4",children:"Sign in with your Google account to access the admin panel."}),c.jsx("p",{className:"text-sm text-xmas-mute mb-6",children:"Only authorized administrators will be granted access."}),c.jsx("button",{onClick:u,className:"btn btn-primary w-full flex items-center justify-center gap-2",disabled:s,children:s?c.jsxs(c.Fragment,{children:[c.jsx("span",{className:"loading loading-spinner loading-sm"}),"Signing in..."]}):c.jsxs(c.Fragment,{children:[c.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 48 48",children:[c.jsx("path",{fill:"#FFC107",d:`M43.611,20.083H42V20H24v8h11.303c-1.649,4.657-6.08,8-11.303,8c-6.627,0-12-5.373-12-12\r
                      s5.373-12,12-12c3.059,0,5.842,1.154,7.961,3.039l5.657-5.657C34.046,6.053,29.268,4,24,4C12.955,4,4,12.955,4,24s8.955,20,20,20\r
                      s20-8.955,20-20C44,22.659,43.862,21.35,43.611,20.083z`}),c.jsx("path",{fill:"#FF3D00",d:`M6.306,14.691l6.571,4.819C14.655,15.108,18.961,12,24,12c3.059,0,5.842,1.154,7.961,3.039\r
                      l5.657-5.657C34.046,6.053,29.268,4,24,4C16.318,4,9.656,8.337,6.306,14.691z`}),c.jsx("path",{fill:"#4CAF50",d:`M24,44c5.166,0,9.86-1.977,13.409-5.192l-6.19-5.238C29.211,35.091,26.715,36,24,36\r
                      c-5.202,0-9.619-3.317-11.283-7.946l-6.522,5.025C9.505,39.556,16.227,44,24,44z`}),c.jsx("path",{fill:"#1976D2",d:`M43.611,20.083H42V20H24v8h11.303c-0.792,2.237-2.231,4.166-4.087,5.571\r
                      c0.001-0.001,0.002-0.001,0.003-0.002l6.19,5.238C36.971,39.205,44,34,44,24C44,22.659,43.862,21.35,43.611,20.083z`})]}),"Sign in with Google"]})})]})]}),c.jsx("div",{className:"text-center mt-6",children:c.jsx("button",{onClick:()=>e("/"),className:"btn btn-link text-xmas-mute",children:"Back to Home"})})]})})};async function yz(e,t){const r=await ci(e,t),n=Tt(De,"movies"),s=Dn(n,rn("imdbId","==",r.imdbID)),a=await Mt(s),i={...x0(r),updatedAt:new Date};if(a.empty){const o={...i,addedAt:new Date};return{movieId:(await Qu(n,o)).id,action:"created"}}else{const o=a.docs[0].id;return await Zn(dt(De,"movies",o),i,{merge:!0}),{movieId:o,action:"updated"}}}const _z=e=>new Promise(t=>setTimeout(t,e));async function wz(e,t,r,n=200){let s=0,a=0,i=0,o=0;const l=[];for(let u=0;u<e.length;u++){const f=e[u];try{if(!f){i++,r==null||r(u+1,e.length,"skipped");continue}const{movieId:d,action:m}=await yz(f,t);l.push(d),m==="created"?s++:a++,r==null||r(u+1,e.length,m),n>0&&await _z(n)}catch(d){console.error("Catalogue upsert error for IMDb",f,d),o++,r==null||r(u+1,e.length,"error")}}return{totalRequested:e.length,created:s,updated:a,skipped:i,errors:o,movieIds:l}}const Ez=({omdbApiKey:e,onDone:t})=>{const[r,n]=U.useState(null),[s,a]=U.useState([]),[i,o]=U.useState([]),[l,u]=U.useState("upload"),[f,d]=U.useState(0),[m,p]=U.useState(null),[x,g]=U.useState(0),[_,k]=U.useState(!1),[E,y]=U.useState(null),[b,O]=U.useState([]),[D,v]=U.useState(null),T=i.filter(oe=>oe.selected&&oe.tmdbMatch).length,S=oe=>{var ae;const te=(ae=oe.target.files)==null?void 0:ae[0];if(!te)return;n(te);const de=new FileReader;de.onload=X=>{var q;const H=Ad((q=X.target)==null?void 0:q.result,{type:"binary"}),Z=H.Sheets[H.SheetNames[0]],M=SI.sheet_to_json(Z).map(K=>({title:K.title||K.Title||K.name||K.Name||"",imdbId:K.imdb||K.IMDB||K.Imdb||K.imdbId||K.imdbID||"",releaseDate:K.year||K.Year||K.releaseDate||K.ReleaseDate||K.release_date||"",tmdbId:K.tmdbId||K.TMDBId||K["TMDB ID"]||K.tmdb||K.TMDB||"",watched:K.watched||K.Watched||!1,rating:K.rating||K.Rating||null,review:K.review||K.Review||K.notes||K.Notes||""})).filter(K=>K.title);a(M)},de.readAsBinaryString(te)},N=async()=>{if(!s.length||!e){v("Missing data or OMDb key");return}try{k(!0),v(null),o([]),d(0),p(null);const oe=[],te=Tt(De,"movies");for(let de=0;de<s.length;de++){const ae=s[de];p(ae.title||null);try{let X=null;if(ae.imdbId)X=await ci(ae.imdbId,e);else{const H=`${ae.title} ${ae.releaseDate||""}`.trim();let Z=H||ae.title,Y=[];try{Y=await Hi(Z,e)}catch{Y=[]}if(!Y.length&&H&&ae.title&&H!==ae.title){Z=ae.title;try{Y=await Hi(Z,e)}catch{Y=[]}}if(!Y.length){oe.push({excelData:ae,tmdbMatch:null,confidence:0,status:"unmatched",movieId:void 0,selected:!1});continue}X=await ci(Y[0].imdbID,e)}if(!X)oe.push({excelData:ae,tmdbMatch:null,confidence:0,status:"unmatched",movieId:void 0,selected:!1});else{const H=md(ae,X),Z=await Mt(Dn(te,rn("imdbId","==",X.imdbID)));let Y,M="matched";Z.empty?H<70&&(M="manual"):(Y=Z.docs[0].id,M=H>=70?"duplicate":"manual"),oe.push({excelData:ae,tmdbMatch:X,confidence:H,status:M,movieId:Y,selected:!0})}}catch{oe.push({excelData:ae,tmdbMatch:null,confidence:0,status:"unmatched",movieId:void 0,selected:!1})}d(Math.round((de+1)/s.length*100))}o(oe),u("review")}finally{k(!1),p(null)}},C=async(oe,te)=>{try{k(!0);const de=i[oe],ae=te||de.excelData.title,X=await Hi(ae,e);y(oe),O(X)}finally{k(!1)}},R=async oe=>{if(E!=null){k(!0);try{const te=await ci(oe.imdbID,e),de=md(i[E].excelData,te),ae=Tt(De,"movies"),X=await Mt(Dn(ae,rn("imdbId","==",te.imdbID)));let H,Z="matched";X.empty?de<70&&(Z="manual"):(H=X.docs[0].id,Z=de>=70?"duplicate":"manual"),o(Y=>{const M=[...Y];return M[E]={excelData:Y[E].excelData,tmdbMatch:te,confidence:de,status:Z,movieId:H,selected:!0},M}),y(null),O([])}finally{k(!1)}}},F=async()=>{const oe=i.filter(de=>de.selected&&de.tmdbMatch);if(!oe.length)return;u("import"),g(0);const te=Tt(De,"movies");for(let de=0;de<oe.length;de++){const ae=oe[de];try{const X=ae.tmdbMatch,H=await Mt(Dn(te,rn("imdbId","==",X.imdbID)));let Z=null;const Y=ae.excelData.tmdbId;if(Y!=null&&Y!==""){const q=Number(Y);Z=Number.isFinite(q)?q:null}const M={...x0(X),updatedAt:new Date};if(Z!=null&&(M.tmdbId=Z),H.empty)await Qu(te,{...M,addedAt:new Date});else{const q=H.docs[0].id;await Zn(dt(De,"movies",q),M,{merge:!0})}}catch{}g(Math.round((de+1)/oe.length*100))}t==null||t()};return c.jsxs("div",{className:"space-y-6",children:[l==="upload"&&c.jsxs("div",{className:"space-y-4",children:[c.jsx("input",{type:"file",accept:".xlsx,.xls",className:"file-input file-input-bordered w-full",onChange:S}),!!s.length&&c.jsxs("div",{className:"text-sm opacity-80",children:[s.length," rows detected"]}),c.jsx("button",{className:"btn btn-primary",onClick:N,disabled:!e||!s.length||_,children:_?c.jsx("span",{className:"loading loading-spinner loading-sm"}):"Scan & Match to Catalogue"}),_&&!!f&&f<100&&c.jsxs("div",{className:"space-y-1",children:[c.jsxs("div",{className:"text-sm",children:["Scanning ",f,"%"]}),c.jsx("progress",{className:"progress w-full",value:f,max:100}),m&&c.jsxs("div",{className:"text-xs opacity-70 truncate",children:["Current: ",m]})]})]}),l==="review"&&c.jsxs("div",{className:"space-y-4",children:[c.jsxs("div",{className:"flex justify-between items-center",children:[c.jsx("div",{className:"font-bold",children:"Review Catalogue Matches"}),c.jsx("button",{className:"btn btn-ghost btn-sm",onClick:()=>u("upload"),children:"Back"})]}),c.jsx("div",{className:"overflow-x-auto",children:c.jsxs("table",{className:"table table-zebra w-full",children:[c.jsx("thead",{children:c.jsxs("tr",{children:[c.jsx("th",{}),c.jsx("th",{children:"Excel"}),c.jsx("th",{children:"Match"}),c.jsx("th",{children:"Confidence"}),c.jsx("th",{children:"Status"}),c.jsx("th",{children:"Action"})]})}),c.jsx("tbody",{children:i.map((oe,te)=>c.jsxs("tr",{children:[c.jsx("td",{children:c.jsx("input",{type:"checkbox",className:"checkbox",checked:oe.selected,disabled:!oe.tmdbMatch,onChange:()=>{const de=[...i];de[te].selected=!de[te].selected,o(de)}})}),c.jsxs("td",{children:[c.jsx("div",{className:"font-semibold",children:oe.excelData.title}),c.jsx("div",{className:"text-xs opacity-70",children:oe.excelData.releaseDate||"-"})]}),c.jsx("td",{children:oe.tmdbMatch?c.jsxs("div",{className:"flex items-center gap-3",children:[c.jsx("div",{className:"w-12 h-18",children:xn(oe.tmdbMatch)?c.jsx("img",{src:xn(oe.tmdbMatch),className:"object-cover"}):c.jsx("div",{className:"w-full h-full bg-base-200"})}),c.jsxs("div",{children:[c.jsx("div",{className:"font-semibold",children:oe.tmdbMatch.Title}),c.jsx("div",{className:"text-xs opacity-70",children:oe.tmdbMatch.Year})]})]}):c.jsx("span",{className:"text-error",children:"No match"})}),c.jsx("td",{children:oe.tmdbMatch?c.jsxs("div",{className:"flex items-center",children:[c.jsx("progress",{className:`progress ${oe.confidence>=70?"progress-success":oe.confidence>=40?"progress-warning":"progress-error"}`,value:oe.confidence,max:100}),c.jsxs("span",{className:"ml-2",children:[oe.confidence,"%"]})]}):"-"}),c.jsxs("td",{children:[oe.status==="matched"&&c.jsx("div",{className:"badge badge-success",children:"New"}),oe.status==="unmatched"&&c.jsx("div",{className:"badge badge-error",children:"Unmatched"}),oe.status==="duplicate"&&c.jsx("div",{className:"badge badge-warning",children:"Existing"}),oe.status==="manual"&&c.jsx("div",{className:"badge badge-info",children:"Manual"})]}),c.jsx("td",{children:c.jsx("button",{className:"btn btn-sm btn-outline",onClick:()=>C(te),children:c.jsx("i",{className:"fas fa-search"})})})]},te))})]})}),c.jsx("div",{className:"flex justify-end",children:c.jsxs("button",{className:"btn btn-primary",onClick:F,disabled:!T||_,children:["Import ",T," to Catalogue"]})}),!!f&&f<100&&c.jsx("div",{children:c.jsx("progress",{className:"progress w-full",value:f,max:100})})]}),l==="import"&&c.jsxs("div",{className:"space-y-3",children:[c.jsx("div",{className:"font-bold",children:"Importing to Catalogue"}),c.jsx("progress",{className:"progress w-full",value:x,max:100})]}),E!==null&&c.jsx("div",{className:"fixed inset-0 z-[100] flex items-center justify-center bg-black/60",children:c.jsxs("div",{className:"bg-base-100 rounded-box shadow-xl max-w-4xl w-full max-h-[90vh] overflow-hidden p-6",children:[c.jsxs("h3",{className:"font-bold text-lg mb-4",children:["Manual match: ",i[E].excelData.title]}),c.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 mb-6",children:[c.jsx("input",{type:"text",className:"input input-bordered flex-1",placeholder:"Search for a movie...",defaultValue:i[E].excelData.title,onKeyDown:oe=>oe.key==="Enter"&&C(E,oe.target.value)}),c.jsx("button",{className:"btn btn-primary w-full sm:w-auto",onClick:()=>{var oe;return C(E,(oe=document.querySelector("[data-manual-search-input]"))==null?void 0:oe.value)},disabled:_,children:_?c.jsx("span",{className:"loading loading-spinner loading-sm"}):c.jsx("i",{className:"fas fa-search"})})]}),c.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-3 max-h-96 overflow-y-auto",children:b.map(oe=>c.jsxs("div",{className:"card bg-base-100 shadow cursor-pointer",onClick:()=>R(oe),children:[c.jsx("figure",{children:xn(oe)?c.jsx("img",{src:xn(oe)}):c.jsx("div",{className:"h-48 w-full bg-base-200"})}),c.jsxs("div",{className:"card-body p-3",children:[c.jsx("div",{className:"text-sm font-semibold",children:oe.Title}),c.jsx("div",{className:"text-xs opacity-70",children:oe.Year})]})]},oe.imdbID))}),c.jsx("div",{className:"flex justify-end mt-6",children:c.jsx("button",{className:"btn",onClick:()=>{y(null),O([])},children:"Close"})})]})}),D&&c.jsx("div",{className:"alert alert-error",children:D})]})},Tz=()=>{const e=ts(),{isAdmin:t,loading:r}=Ol(),{userProfile:n}=ln(),[s,a]=U.useState(!0),[i,o]=U.useState(null),[l,u]=U.useState(null),[f,d]=U.useState(!1),[m,p]=U.useState({totalMovies:0,moviesWithSortTitle:0}),[x,g]=U.useState([]),[_,k]=U.useState(!1),[E,y]=U.useState(!1),[b,O]=U.useState(""),[D,v]=U.useState(""),[T,S]=U.useState(!0),[N,C]=U.useState(!1),[R,F]=U.useState(0),[oe,te]=U.useState("");U.useEffect(()=>{n!=null&&n.omdbApiKey&&O(n.omdbApiKey)},[n]),U.useEffect(()=>{!r&&!t&&e("/admin/login")},[t,r,e]),U.useEffect(()=>{t&&(async()=>{if(t){a(!0);try{const M=await Mt(Tt(De,"movies")),q=M.size;let K=0;M.forEach(L=>{L.data().sortTitle&&K++}),p({totalMovies:q,moviesWithSortTitle:K})}catch(M){console.error("Error fetching movie data:",M),o("Failed to load movie data")}finally{a(!1)}}})()},[t]);const de=async()=>{try{o(null),y(!0);const Y=await Mt(Tt(De,"movies")),M=[];M.push("Title,IMDb ID,Year");const q=we=>{const ge=(we??"").toString(),pe=/[",\n]/.test(ge),Pe=ge.replace(/"/g,'""');return pe?`"${Pe}"`:Pe};Y.forEach(we=>{var Xe;const ge=we.data(),pe=ge.title||"",Pe=ge.imdbId||"";let G="";if(ge.releaseDate)try{const Ve=(Xe=ge.releaseDate)!=null&&Xe.toDate?ge.releaseDate.toDate():new Date(ge.releaseDate);isNaN(Ve.getTime())?typeof ge.releaseDate=="string"&&(G=ge.releaseDate.slice(0,4)):G=String(Ve.getFullYear())}catch{typeof ge.releaseDate=="string"&&(G=ge.releaseDate.slice(0,4))}M.push([q(pe),q(Pe),q(G)].join(","))});const K=M.join(`
`),L=new Blob([K],{type:"text/csv;charset=utf-8;"}),J=URL.createObjectURL(L),fe=document.createElement("a");fe.href=J,fe.download="movies_catalogue.csv",document.body.appendChild(fe),fe.click(),document.body.removeChild(fe),URL.revokeObjectURL(J)}catch(Y){console.error("Error exporting catalogue CSV:",Y),o(Y.message||"Failed to export catalogue CSV")}finally{y(!1)}};U.useEffect(()=>{t&&(async()=>{if(t){k(!0);try{const M=Dn(Tt(De,"Requests"),rn("status","==","pending")),K=(await Mt(M)).docs.map(L=>({id:L.id,...L.data()}));g(K)}catch(M){console.error("Error fetching movie requests:",M),o("Failed to load movie requests")}finally{k(!1)}}})()},[t]);const ae=async()=>{try{d(!0),o(null);const Y=await tz();u(`Sort titles updated for ${Y.updated} out of ${Y.total} movies.`),p(M=>({...M,moviesWithSortTitle:M.moviesWithSortTitle+Y.updated})),setTimeout(()=>u(null),5e3)}catch(Y){console.error("Error updating sort titles:",Y),o(Y.message||"Failed to update sort titles")}finally{d(!1)}},X=async(Y,M)=>{try{o(null),await Fn(dt(De,"Requests",Y),{status:M,updatedAt:new Date}),g(q=>q.filter(K=>K.id!==Y)),u(`Request marked as ${M}.`),setTimeout(()=>u(null),4e3)}catch(q){console.error("Error updating request status:",q),o(q.message||"Failed to update request")}},H=U.useMemo(()=>{const Y=D.split(/[\s,]+/).map(M=>M.trim()).filter(Boolean);return Array.from(new Set(Y))},[D]),Z=async()=>{if(o(null),u(null),!b){o("OMDb API key required");return}if(H.length===0){o("Please paste at least one valid IMDb ID");return}try{C(!0),F(0),te(`Starting (0 / ${H.length})`);const Y=await wz(H,b,(M,q,K)=>{const L=Math.round(M/q*100);F(L),te(`Processed ${M} / ${q} (${K})`)},T?300:0);u(`Catalogue updated. Created: ${Y.created}, Updated: ${Y.updated}, Skipped: ${Y.skipped}, Errors: ${Y.errors}.`)}catch(Y){console.error(Y),o((Y==null?void 0:Y.message)??"Catalogue import failed.")}finally{C(!1)}};return r||s?c.jsx("div",{className:"flex justify-center items-center min-h-[60vh]",children:c.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-xmas-gold"})}):c.jsxs("div",{className:"container mx-auto px-4 py-8",children:[c.jsxs("div",{className:"flex justify-between items-center mb-8",children:[c.jsx("h1",{className:"font-christmas text-3xl md:text-4xl text-xmas-line",children:"Admin Dashboard"}),c.jsx("div",{className:"flex gap-2",children:c.jsxs(Ge,{to:"/movies",className:"btn btn-outline",children:[c.jsx("i",{className:"fas fa-film mr-2"})," Movies"]})})]}),i&&c.jsxs("div",{className:"alert alert-error mb-6",children:[c.jsx("i",{className:"fas fa-exclamation-circle mr-2"}),c.jsx("span",{children:i})]}),l&&c.jsxs("div",{className:"alert alert-success mb-6",children:[c.jsx("i",{className:"fas fa-check-circle mr-2"}),c.jsx("span",{children:l})]}),c.jsxs("div",{className:"mb-8",children:[c.jsx("h2",{className:"text-2xl font-christmas mb-4 text-xmas-gold",children:"Movie Administration"}),c.jsxs("div",{className:"flex justify-end mb-4",children:[c.jsx("button",{className:"btn btn-outline btn-sm",onClick:de,disabled:E,children:E?c.jsxs(c.Fragment,{children:[c.jsx("span",{className:"loading loading-spinner loading-xs mr-2"}),"Exporting"]}):c.jsxs(c.Fragment,{children:[c.jsx("i",{className:"fas fa-file-csv mr-2"}),"Export Catalogue CSV"]})}),c.jsxs(Ge,{to:"/admin/posters",className:"btn btn-outline btn-sm ml-2 flex items-center gap-2",children:[c.jsx("i",{className:"fas fa-image"}),"Poster Manager"]})]}),c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-8",children:[c.jsx("div",{className:"card bg-xmas-card shadow-xl",children:c.jsxs("div",{className:"card-body",children:[c.jsxs("h2",{className:"card-title font-christmas",children:[c.jsx("i",{className:"fas fa-sort-alpha-down text-primary mr-2"})," Sort Title Migration"]}),c.jsx("p",{className:"mb-4",children:'Update all movies to include sort titles (e.g., "The Grinch"  "Grinch") for better alphabetical sorting.'}),c.jsxs("div",{className:"flex flex-col gap-2",children:[c.jsxs("div",{className:"stats bg-base-200 text-base-content",children:[c.jsxs("div",{className:"stat",children:[c.jsx("div",{className:"stat-title",children:"Total Movies"}),c.jsx("div",{className:"stat-value",children:m.totalMovies})]}),c.jsxs("div",{className:"stat",children:[c.jsx("div",{className:"stat-title",children:"With Sort Titles"}),c.jsx("div",{className:"stat-value",children:m.moviesWithSortTitle}),c.jsx("div",{className:"stat-desc",children:m.totalMovies>0?`${Math.round(m.moviesWithSortTitle/m.totalMovies*100)}%`:"0%"})]})]}),c.jsxs("button",{className:"btn btn-primary w-full",onClick:ae,disabled:f||m.moviesWithSortTitle===m.totalMovies,children:[f?c.jsx("span",{className:"loading loading-spinner loading-sm mr-2"}):c.jsx("i",{className:"fas fa-sync-alt mr-2"}),m.moviesWithSortTitle===m.totalMovies?"All Movies Updated":"Update Sort Titles"]})]})]})}),c.jsx("div",{className:"card bg-xmas-card shadow-xl",children:c.jsxs("div",{className:"card-body",children:[c.jsxs("h2",{className:"card-title font-christmas",children:[c.jsx("i",{className:"fas fa-database text-primary mr-2"})," Catalogue Builder (IMDb IDs)"]}),c.jsxs("p",{className:"mb-4",children:["Bulk-import titles by IMDb ID into your ",c.jsx("code",{children:"movies"})," catalogue only  no user collections will be updated."]}),c.jsx("label",{className:"label mt-4",children:c.jsx("span",{className:"label-text",children:"IMDb IDs (comma / space / newline separated)"})}),c.jsx("textarea",{className:"textarea textarea-bordered w-full h-40",value:D,onChange:Y=>v(Y.target.value),placeholder:`e.g. tt0096061, tt0107688
tt0096061
tt0107688`}),c.jsxs("div",{className:"flex items-center gap-4 mt-4",children:[c.jsx("div",{className:"form-control",children:c.jsxs("label",{className:"label cursor-pointer gap-2",children:[c.jsx("span",{className:"label-text",children:"Slow mode (API friendly)"}),c.jsx("input",{type:"checkbox",className:"toggle",checked:T,onChange:Y=>S(Y.target.checked)})]})}),c.jsx("button",{className:"btn btn-primary ml-auto",onClick:Z,disabled:N||H.length===0||!b,title:b?void 0:"Add your OMDb API key in Profile > Settings",children:N?c.jsxs(c.Fragment,{children:[c.jsx("span",{className:"loading loading-spinner loading-sm mr-2"}),"Importing ",H.length,""]}):c.jsxs(c.Fragment,{children:[c.jsx("i",{className:"fas fa-file-import mr-2"}),"Import ",H.length||0," to Catalogue"]})})]}),(N||R>0)&&c.jsxs("div",{className:"mt-4",children:[c.jsx("progress",{className:"progress w-full",value:R,max:100}),c.jsx("div",{className:"text-sm mt-1 opacity-80",children:oe})]})]})})]}),c.jsx("div",{className:"card bg-xmas-card shadow-xl overflow-visible no-card-hover",children:c.jsxs("div",{className:"card-body",children:[c.jsxs("h2",{className:"card-title font-christmas",children:[c.jsx("i",{className:"fas fa-file-excel text-primary mr-2"})," Excel Catalogue Import"]}),c.jsxs("p",{className:"mb-4 text-sm opacity-80",children:["Use an Excel file (title / year / optional IMDb id) to populate or refresh the main",c.jsx("code",{className:"mx-1",children:"movies"})," catalogue via OMDb."]}),!b&&c.jsxs("div",{className:"alert alert-warning mb-4",children:[c.jsx("i",{className:"fas fa-exclamation-triangle mr-2"}),c.jsx("span",{children:"Add your OMDb API key in Profile to enable Excel catalogue import."})]}),b&&c.jsx(Ez,{omdbApiKey:b,onDone:()=>{u("Excel catalogue import completed."),setTimeout(()=>u(null),4e3)}})]})})]}),c.jsxs("div",{className:"mb-8",children:[c.jsx("h2",{className:"text-2xl font-christmas mb-4 text-xmas-gold",children:"Movie Requests"}),c.jsx("div",{className:"card bg-xmas-card shadow-xl",children:c.jsxs("div",{className:"card-body",children:[c.jsxs("h2",{className:"card-title font-christmas flex items-center gap-2",children:[c.jsx("i",{className:"fas fa-gift text-primary"}),"Pending Requests"]}),c.jsx("p",{className:"text-sm opacity-80 mb-4",children:"These are movies users have asked to be added to the catalogue."}),_?c.jsx("div",{className:"flex justify-center py-8",children:c.jsx("span",{className:"loading loading-spinner loading-md"})}):x.length===0?c.jsx("p",{className:"text-sm opacity-80",children:"No pending requests right now."}):c.jsx("div",{className:"overflow-x-auto",children:c.jsxs("table",{className:"table table-zebra table-sm",children:[c.jsx("thead",{children:c.jsxs("tr",{children:[c.jsx("th",{children:"Title"}),c.jsx("th",{children:"Year"}),c.jsx("th",{children:"TMDB"}),c.jsx("th",{children:"Requested By"}),c.jsx("th",{children:"Notes"}),c.jsx("th",{})]})}),c.jsx("tbody",{children:x.map(Y=>{var q;const M=(q=Y.createdAt)!=null&&q.toDate?Y.createdAt.toDate():Y.createdAt;return c.jsxs("tr",{children:[c.jsxs("td",{children:[c.jsx("div",{className:"font-semibold",children:Y.title}),M&&c.jsx("div",{className:"text-xs opacity-70",children:new Date(M).toLocaleString()})]}),c.jsx("td",{children:Y.year||"-"}),c.jsxs("td",{children:[Y.tmdbId&&c.jsxs("div",{className:"text-xs",children:["ID: ",Y.tmdbId]}),Y.tmdbUrl&&c.jsx("a",{href:Y.tmdbUrl,target:"_blank",rel:"noopener noreferrer",className:"link link-primary text-xs",children:"View TMDB"})]}),c.jsxs("td",{children:[c.jsx("div",{className:"text-sm",children:Y.userDisplayName||Y.userEmail||Y.userId}),Y.userEmail&&c.jsx("div",{className:"text-xs opacity-70",children:Y.userEmail})]}),c.jsx("td",{className:"max-w-xs whitespace-pre-wrap text-xs",children:Y.notes||"-"}),c.jsxs("td",{className:"flex flex-col gap-1",children:[c.jsx("button",{className:"btn btn-xs btn-success",onClick:()=>X(Y.id,"fulfilled"),children:"Fulfilled"}),c.jsx("button",{className:"btn btn-xs btn-ghost",onClick:()=>X(Y.id,"dismissed"),children:"Dismiss"})]})]},Y.id)})})]})})]})})]})]})},kz=()=>{const e=ts(),{isAdmin:t,loading:r}=Ol(),{userProfile:n}=ln(),[s,a]=U.useState(!0),[i,o]=U.useState(null),[l,u]=U.useState(null),[f,d]=U.useState([]),[m,p]=U.useState({}),[x,g]=U.useState(null),[_,k]=U.useState(null),[E,y]=U.useState(null),[b,O]=U.useState([]),[D,v]=U.useState(""),[T,S]=U.useState("all"),N=U.useRef({});U.useEffect(()=>{!r&&!t&&e("/admin/login")},[t,r,e]),U.useEffect(()=>{t&&(async()=>{if(t){a(!0),o(null);try{const H=await Mt(Tt(De,"movies")),Z=[];H.forEach(Y=>{const M=Y.data();Z.push({id:Y.id,title:M.title||"(Untitled)",releaseDate:M.releaseDate,posterUrl:M.posterUrl,tmdbId:M.tmdbId})}),Z.sort((Y,M)=>Y.title.localeCompare(M.title)),d(Z)}catch(H){console.error("Error loading movies for poster manager:",H),o((H==null?void 0:H.message)||"Failed to load movies")}finally{a(!1)}}})()},[t]);const C=(X,H)=>{p(Z=>({...Z,[X]:H}))},R=X=>{const H=N.current[X];H&&H.click()},F=async X=>{const H=m[X.id];if(!H){o("Please choose an image file to upload.");return}try{o(null),u(null),g(X.id);const Z=H.name.match(/\.([a-zA-Z0-9]+)$/),Y=Z?Z[1]:"jpg",M=(X.title||"movie").toLowerCase().replace(/[^a-z0-9]+/g,"-"),q=BL(d6,`movies/${X.id}/poster-${M}.${Y}`);await UL(q,H);const K=await VL(q);await Fn(dt(De,"movies",X.id),{posterUrl:K,updatedAt:new Date}),d(L=>L.map(J=>J.id===X.id?{...J,posterUrl:K}:J)),u(`Poster updated for "${X.title}".`),p(L=>({...L,[X.id]:null}))}catch(Z){console.error("Error uploading poster image:",Z),o((Z==null?void 0:Z.message)||"Failed to upload poster image")}finally{g(null)}},oe=U.useMemo(()=>{const X=D.trim().toLowerCase();return f.filter(H=>{if(T==="with"&&!H.posterUrl||T==="without"&&H.posterUrl)return!1;if(!X)return!0;const Z=H.title.toLowerCase(),Y=H.releaseDate?new Date(H.releaseDate).getFullYear().toString():"";return Z.includes(X)||!!Y&&Y.includes(X)})},[f,D,T]),te=(n==null?void 0:n.tmdbApiKey)||"",de=async X=>{if(!te){o("TMDb API key is required. Set it on your Profile page.");return}if(!X.tmdbId){o("No tmdbId stored for this movie.");return}try{o(null),u(null),k(X.id);const H=await C6(X.tmdbId,te);if(!H.length){o("No posters returned from TMDb for this movie.");return}O(H),y(X.id)}catch(H){console.error("Error fetching TMDb posters:",H),o((H==null?void 0:H.message)||"Failed to fetch TMDb posters")}finally{k(null)}},ae=async X=>{if(!E)return;const H=f.find(Z=>Z.id===E);if(H)try{o(null),u(null),await Fn(dt(De,"movies",H.id),{posterUrl:X.url,updatedAt:new Date}),d(Z=>Z.map(Y=>Y.id===H.id?{...Y,posterUrl:X.url}:Y)),u(`TMDb poster applied for "${H.title}".`),y(null),O([])}catch(Z){console.error("Error applying TMDb poster:",Z),o((Z==null?void 0:Z.message)||"Failed to apply TMDb poster")}};return r||s?c.jsx("div",{className:"flex justify-center items-center min-h-[60vh]",children:c.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-xmas-gold"})}):c.jsxs("div",{className:"container mx-auto px-4 py-8",children:[c.jsxs("div",{className:"flex justify-between items-center mb-6",children:[c.jsxs("div",{children:[c.jsx("h1",{className:"font-christmas text-3xl md:text-4xl text-xmas-line",children:"Poster Image Manager"}),c.jsx("p",{className:"text-sm text-xmas-mute mt-1",children:"View current posters and upload replacements stored in Firebase Storage."})]}),c.jsx("div",{className:"flex gap-2",children:c.jsxs(Ge,{to:"/admin",className:"btn btn-outline btn-sm md:btn-md",children:[c.jsx("i",{className:"fas fa-arrow-left mr-2"}),"Admin Dashboard"]})})]}),i&&c.jsxs("div",{className:"alert alert-error mb-4",children:[c.jsx("i",{className:"fas fa-exclamation-circle mr-2"}),c.jsx("span",{children:i})]}),l&&c.jsxs("div",{className:"alert alert-success mb-4",children:[c.jsx("i",{className:"fas fa-check-circle mr-2"}),c.jsx("span",{children:l})]}),f.length>0&&c.jsxs("div",{className:"flex flex-col md:flex-row md:items-center gap-2 mb-4",children:[c.jsx("div",{className:"flex-1",children:c.jsxs("div",{className:"relative",children:[c.jsx("span",{className:"absolute inset-y-0 left-0 pl-2 flex items-center pointer-events-none",children:c.jsx("i",{className:"fas fa-search text-gray-400"})}),c.jsx("input",{type:"text",className:"input input-bordered input-sm md:input-md w-full pl-8 pr-8",placeholder:"Search by title or year...",value:D,onChange:X=>v(X.target.value)}),D&&c.jsx("button",{type:"button",className:"absolute inset-y-0 right-0 pr-2 flex items-center",onClick:()=>v(""),children:c.jsx("i",{className:"fas fa-times text-gray-400 hover:text-gray-600"})})]})}),c.jsxs("div",{className:"flex gap-1",children:[c.jsx("button",{type:"button",className:`btn btn-xs md:btn-sm ${T==="all"?"btn-primary":"btn-ghost"}`,onClick:()=>S("all"),children:"All"}),c.jsx("button",{type:"button",className:`btn btn-xs md:btn-sm ${T==="with"?"btn-primary":"btn-ghost"}`,onClick:()=>S("with"),children:"With poster"}),c.jsx("button",{type:"button",className:`btn btn-xs md:btn-sm ${T==="without"?"btn-primary":"btn-ghost"}`,onClick:()=>S("without"),children:"No poster"})]})]}),oe.length===0?c.jsx("p",{className:"text-sm opacity-80",children:"No movies found."}):c.jsx("div",{className:"grid grid-cols-3 sm:grid-cols-4 md:grid-cols-5 lg:grid-cols-6 gap-2 sm:gap-3",children:oe.map(X=>{const H=m[X.id]||null,Z=X.releaseDate?new Date(X.releaseDate).getFullYear():void 0;return c.jsx("div",{className:"block transition-transform hover:scale-[1.02] hover:shadow-xl cursor-default",children:c.jsxs("div",{className:"relative rounded-lg overflow-hidden bg-xmas-card shadow-md h-full flex flex-col",children:[c.jsx("div",{className:"relative",children:X.posterUrl?c.jsx("img",{src:X.posterUrl,alt:X.title,className:"w-full h-auto object-cover",style:{aspectRatio:"2/3"}}):c.jsx("div",{className:"w-full flex items-center justify-center bg-gray-800",style:{aspectRatio:"2/3"},children:c.jsx("i",{className:"fas fa-film text-2xl text-gray-500"})})}),c.jsxs("div",{className:"p-1 sm:p-2 flex-grow flex flex-col",children:[c.jsx("h2",{className:"text-xs sm:text-sm font-medium line-clamp-2",children:X.title}),Z&&c.jsx("p",{className:"text-xs text-gray-400 mt-1",children:Z}),X.posterUrl&&c.jsx("a",{href:X.posterUrl,target:"_blank",rel:"noopener noreferrer",className:"link link-primary text-[10px] sm:text-xs mt-0.5 inline-block",children:"Open current poster"})]}),c.jsxs("div",{className:"px-1 sm:px-2 pb-2 space-y-1",children:[c.jsx("input",{type:"file",accept:"image/*",ref:Y=>{N.current[X.id]=Y},className:"hidden",onChange:Y=>C(X.id,Y.target.files&&Y.target.files[0]?Y.target.files[0]:null)}),c.jsx("button",{className:"btn btn-primary btn-xs w-full",type:"button",onClick:()=>de(X),disabled:_===X.id||!te||!X.tmdbId,children:_===X.id?c.jsxs(c.Fragment,{children:[c.jsx("span",{className:"loading loading-spinner loading-xs mr-1"}),"TMDb..."]}):c.jsxs(c.Fragment,{children:[c.jsx("i",{className:"fas fa-photo-video mr-1"}),"TMDb posters"]})}),c.jsxs("button",{className:"btn btn-outline btn-xs w-full",type:"button",onClick:()=>R(X.id),children:[c.jsx("i",{className:"fas fa-file-image mr-1"}),"Choose file"]}),c.jsx("button",{className:"btn btn-primary btn-xs w-full",type:"button",onClick:()=>F(X),disabled:x===X.id||!H,children:x===X.id?c.jsxs(c.Fragment,{children:[c.jsx("span",{className:"loading loading-spinner loading-xs mr-1"}),"Uploading..."]}):c.jsxs(c.Fragment,{children:[c.jsx("i",{className:"fas fa-upload mr-1"}),"Upload"]})})]})]})},X.id)})}),E&&b.length>0&&c.jsx("dialog",{className:"modal modal-open",children:c.jsxs("div",{className:"modal-box max-w-5xl bg-xmas-card",children:[c.jsx("h3",{className:"font-bold text-lg mb-2",children:"Choose a TMDb poster"}),c.jsx("p",{className:"text-xs opacity-80 mb-4",children:"These posters come from The Movie Database for this movie's stored tmdbId."}),c.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-3 max-h-[60vh] overflow-y-auto",children:b.map(X=>c.jsx("button",{type:"button",className:"border border-transparent hover:border-xmas-gold rounded-lg overflow-hidden bg-gray-900 focus:outline-none focus:ring-2 focus:ring-xmas-gold",onClick:()=>ae(X),children:c.jsx("img",{src:X.url,alt:"TMDb poster option",className:"w-full h-auto object-cover",style:{aspectRatio:"2/3"}})},X.url))}),c.jsx("div",{className:"modal-action",children:c.jsx("button",{type:"button",className:"btn btn-sm",onClick:()=>{y(null),O([])},children:"Close"})})]})})]})},Sz=U4([{element:c.jsx(v6,{}),children:[{path:"/",element:c.jsx(w6,{})},{path:"/login",element:c.jsx(E6,{})},{path:"/u/:slug",element:c.jsx(iz,{})},{path:"/u/:slug/m/:movieSlug",element:c.jsx(mz,{})},{element:c.jsx(pm,{}),children:[{path:"/movies",element:c.jsx(R6,{})},{path:"/movies/:movieId",element:c.jsx($6,{})},{path:"/movies/:movieId/edit-poster",element:c.jsx(xz,{})},{path:"/import",element:c.jsx(YW,{})},{path:"/random",element:c.jsx(QW,{})},{path:"/profile",element:c.jsx(nz,{})},{path:"/achievements",element:c.jsx(az,{})}]},{path:"/admin/login",element:c.jsx(vz,{})},{path:"/admin",element:c.jsx(pm,{children:c.jsx(Tz,{})})},{path:"/admin/posters",element:c.jsx(pm,{children:c.jsx(kz,{})})}]}]);bm.createRoot(document.getElementById("root")).render(c.jsx(Cu.StrictMode,{children:c.jsx(p6,{children:c.jsx(y6,{children:c.jsx(K4,{router:Sz})})})}));
