function Zw(e,t){for(var r=0;r<t.length;r++){const n=t[r];if(typeof n!="string"&&!Array.isArray(n)){for(const s in n)if(s!=="default"&&!(s in e)){const a=Object.getOwnPropertyDescriptor(n,s);a&&Object.defineProperty(e,s,a.get?a:{enumerable:!0,get:()=>n[s]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))n(s);new MutationObserver(s=>{for(const a of s)if(a.type==="childList")for(const i of a.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&n(i)}).observe(document,{childList:!0,subtree:!0});function r(s){const a={};return s.integrity&&(a.integrity=s.integrity),s.referrerPolicy&&(a.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?a.credentials="include":s.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function n(s){if(s.ep)return;s.ep=!0;const a=r(s);fetch(s.href,a)}})();function eE(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var tE={exports:{}},hd={},rE={exports:{}},Xe={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var xu=Symbol.for("react.element"),tC=Symbol.for("react.portal"),rC=Symbol.for("react.fragment"),nC=Symbol.for("react.strict_mode"),sC=Symbol.for("react.profiler"),aC=Symbol.for("react.provider"),iC=Symbol.for("react.context"),oC=Symbol.for("react.forward_ref"),lC=Symbol.for("react.suspense"),cC=Symbol.for("react.memo"),uC=Symbol.for("react.lazy"),Xv=Symbol.iterator;function fC(e){return e===null||typeof e!="object"?null:(e=Xv&&e[Xv]||e["@@iterator"],typeof e=="function"?e:null)}var nE={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},sE=Object.assign,aE={};function vl(e,t,r){this.props=e,this.context=t,this.refs=aE,this.updater=r||nE}vl.prototype.isReactComponent={};vl.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};vl.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function iE(){}iE.prototype=vl.prototype;function Kp(e,t,r){this.props=e,this.context=t,this.refs=aE,this.updater=r||nE}var qp=Kp.prototype=new iE;qp.constructor=Kp;sE(qp,vl.prototype);qp.isPureReactComponent=!0;var Yv=Array.isArray,oE=Object.prototype.hasOwnProperty,Xp={current:null},lE={key:!0,ref:!0,__self:!0,__source:!0};function cE(e,t,r){var n,s={},a=null,i=null;if(t!=null)for(n in t.ref!==void 0&&(i=t.ref),t.key!==void 0&&(a=""+t.key),t)oE.call(t,n)&&!lE.hasOwnProperty(n)&&(s[n]=t[n]);var o=arguments.length-2;if(o===1)s.children=r;else if(1<o){for(var l=Array(o),c=0;c<o;c++)l[c]=arguments[c+2];s.children=l}if(e&&e.defaultProps)for(n in o=e.defaultProps,o)s[n]===void 0&&(s[n]=o[n]);return{$$typeof:xu,type:e,key:a,ref:i,props:s,_owner:Xp.current}}function hC(e,t){return{$$typeof:xu,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function Yp(e){return typeof e=="object"&&e!==null&&e.$$typeof===xu}function dC(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(r){return t[r]})}var Qv=/\/+/g;function h0(e,t){return typeof e=="object"&&e!==null&&e.key!=null?dC(""+e.key):t.toString(36)}function Uf(e,t,r,n,s){var a=typeof e;(a==="undefined"||a==="boolean")&&(e=null);var i=!1;if(e===null)i=!0;else switch(a){case"string":case"number":i=!0;break;case"object":switch(e.$$typeof){case xu:case tC:i=!0}}if(i)return i=e,s=s(i),e=n===""?"."+h0(i,0):n,Yv(s)?(r="",e!=null&&(r=e.replace(Qv,"$&/")+"/"),Uf(s,t,r,"",function(c){return c})):s!=null&&(Yp(s)&&(s=hC(s,r+(!s.key||i&&i.key===s.key?"":(""+s.key).replace(Qv,"$&/")+"/")+e)),t.push(s)),1;if(i=0,n=n===""?".":n+":",Yv(e))for(var o=0;o<e.length;o++){a=e[o];var l=n+h0(a,o);i+=Uf(a,t,r,l,s)}else if(l=fC(e),typeof l=="function")for(e=l.call(e),o=0;!(a=e.next()).done;)a=a.value,l=n+h0(a,o++),i+=Uf(a,t,r,l,s);else if(a==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return i}function af(e,t,r){if(e==null)return e;var n=[],s=0;return Uf(e,n,"","",function(a){return t.call(r,a,s++)}),n}function mC(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(r){(e._status===0||e._status===-1)&&(e._status=1,e._result=r)},function(r){(e._status===0||e._status===-1)&&(e._status=2,e._result=r)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var tn={current:null},Vf={transition:null},pC={ReactCurrentDispatcher:tn,ReactCurrentBatchConfig:Vf,ReactCurrentOwner:Xp};function uE(){throw Error("act(...) is not supported in production builds of React.")}Xe.Children={map:af,forEach:function(e,t,r){af(e,function(){t.apply(this,arguments)},r)},count:function(e){var t=0;return af(e,function(){t++}),t},toArray:function(e){return af(e,function(t){return t})||[]},only:function(e){if(!Yp(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};Xe.Component=vl;Xe.Fragment=rC;Xe.Profiler=sC;Xe.PureComponent=Kp;Xe.StrictMode=nC;Xe.Suspense=lC;Xe.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=pC;Xe.act=uE;Xe.cloneElement=function(e,t,r){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var n=sE({},e.props),s=e.key,a=e.ref,i=e._owner;if(t!=null){if(t.ref!==void 0&&(a=t.ref,i=Xp.current),t.key!==void 0&&(s=""+t.key),e.type&&e.type.defaultProps)var o=e.type.defaultProps;for(l in t)oE.call(t,l)&&!lE.hasOwnProperty(l)&&(n[l]=t[l]===void 0&&o!==void 0?o[l]:t[l])}var l=arguments.length-2;if(l===1)n.children=r;else if(1<l){o=Array(l);for(var c=0;c<l;c++)o[c]=arguments[c+2];n.children=o}return{$$typeof:xu,type:e.type,key:s,ref:a,props:n,_owner:i}};Xe.createContext=function(e){return e={$$typeof:iC,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:aC,_context:e},e.Consumer=e};Xe.createElement=cE;Xe.createFactory=function(e){var t=cE.bind(null,e);return t.type=e,t};Xe.createRef=function(){return{current:null}};Xe.forwardRef=function(e){return{$$typeof:oC,render:e}};Xe.isValidElement=Yp;Xe.lazy=function(e){return{$$typeof:uC,_payload:{_status:-1,_result:e},_init:mC}};Xe.memo=function(e,t){return{$$typeof:cC,type:e,compare:t===void 0?null:t}};Xe.startTransition=function(e){var t=Vf.transition;Vf.transition={};try{e()}finally{Vf.transition=t}};Xe.unstable_act=uE;Xe.useCallback=function(e,t){return tn.current.useCallback(e,t)};Xe.useContext=function(e){return tn.current.useContext(e)};Xe.useDebugValue=function(){};Xe.useDeferredValue=function(e){return tn.current.useDeferredValue(e)};Xe.useEffect=function(e,t){return tn.current.useEffect(e,t)};Xe.useId=function(){return tn.current.useId()};Xe.useImperativeHandle=function(e,t,r){return tn.current.useImperativeHandle(e,t,r)};Xe.useInsertionEffect=function(e,t){return tn.current.useInsertionEffect(e,t)};Xe.useLayoutEffect=function(e,t){return tn.current.useLayoutEffect(e,t)};Xe.useMemo=function(e,t){return tn.current.useMemo(e,t)};Xe.useReducer=function(e,t,r){return tn.current.useReducer(e,t,r)};Xe.useRef=function(e){return tn.current.useRef(e)};Xe.useState=function(e){return tn.current.useState(e)};Xe.useSyncExternalStore=function(e,t,r){return tn.current.useSyncExternalStore(e,t,r)};Xe.useTransition=function(){return tn.current.useTransition()};Xe.version="18.3.1";rE.exports=Xe;var z=rE.exports;const vu=eE(z),gC=Zw({__proto__:null,default:vu},[z]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var xC=z,vC=Symbol.for("react.element"),yC=Symbol.for("react.fragment"),_C=Object.prototype.hasOwnProperty,wC=xC.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,EC={key:!0,ref:!0,__self:!0,__source:!0};function fE(e,t,r){var n,s={},a=null,i=null;r!==void 0&&(a=""+r),t.key!==void 0&&(a=""+t.key),t.ref!==void 0&&(i=t.ref);for(n in t)_C.call(t,n)&&!EC.hasOwnProperty(n)&&(s[n]=t[n]);if(e&&e.defaultProps)for(n in t=e.defaultProps,t)s[n]===void 0&&(s[n]=t[n]);return{$$typeof:vC,type:e,key:a,ref:i,props:s,_owner:wC.current}}hd.Fragment=yC;hd.jsx=fE;hd.jsxs=fE;tE.exports=hd;var f=tE.exports,cm={},hE={exports:{}},In={},dE={exports:{}},mE={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(Z,G){var ae=Z.length;Z.push(G);e:for(;0<ae;){var fe=ae-1>>>1,B=Z[fe];if(0<s(B,G))Z[fe]=G,Z[ae]=B,ae=fe;else break e}}function r(Z){return Z.length===0?null:Z[0]}function n(Z){if(Z.length===0)return null;var G=Z[0],ae=Z.pop();if(ae!==G){Z[0]=ae;e:for(var fe=0,B=Z.length,K=B>>>1;fe<K;){var q=2*(fe+1)-1,W=Z[q],Q=q+1,ue=Z[Q];if(0>s(W,ae))Q<B&&0>s(ue,W)?(Z[fe]=ue,Z[Q]=ae,fe=Q):(Z[fe]=W,Z[q]=ae,fe=q);else if(Q<B&&0>s(ue,ae))Z[fe]=ue,Z[Q]=ae,fe=Q;else break e}}return G}function s(Z,G){var ae=Z.sortIndex-G.sortIndex;return ae!==0?ae:Z.id-G.id}if(typeof performance=="object"&&typeof performance.now=="function"){var a=performance;e.unstable_now=function(){return a.now()}}else{var i=Date,o=i.now();e.unstable_now=function(){return i.now()-o}}var l=[],c=[],u=1,d=null,m=3,p=!1,x=!1,g=!1,_=typeof setTimeout=="function"?setTimeout:null,k=typeof clearTimeout=="function"?clearTimeout:null,T=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function w(Z){for(var G=r(c);G!==null;){if(G.callback===null)n(c);else if(G.startTime<=Z)n(c),G.sortIndex=G.expirationTime,t(l,G);else break;G=r(c)}}function C(Z){if(g=!1,w(Z),!x)if(r(l)!==null)x=!0,de(M);else{var G=r(c);G!==null&&ge(C,G.startTime-Z)}}function M(Z,G){x=!1,g&&(g=!1,k(E),E=-1),p=!0;var ae=m;try{for(w(G),d=r(l);d!==null&&(!(d.expirationTime>G)||Z&&!P());){var fe=d.callback;if(typeof fe=="function"){d.callback=null,m=d.priorityLevel;var B=fe(d.expirationTime<=G);G=e.unstable_now(),typeof B=="function"?d.callback=B:d===r(l)&&n(l),w(G)}else n(l);d=r(l)}if(d!==null)var K=!0;else{var q=r(c);q!==null&&ge(C,q.startTime-G),K=!1}return K}finally{d=null,m=ae,p=!1}}var O=!1,v=null,E=-1,S=5,R=-1;function P(){return!(e.unstable_now()-R<S)}function D(){if(v!==null){var Z=e.unstable_now();R=Z;var G=!0;try{G=v(!0,Z)}finally{G?N():(O=!1,v=null)}}else O=!1}var N;if(typeof T=="function")N=function(){T(D)};else if(typeof MessageChannel<"u"){var ce=new MessageChannel,oe=ce.port2;ce.port1.onmessage=D,N=function(){oe.postMessage(null)}}else N=function(){_(D,0)};function de(Z){v=Z,O||(O=!0,N())}function ge(Z,G){E=_(function(){Z(e.unstable_now())},G)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(Z){Z.callback=null},e.unstable_continueExecution=function(){x||p||(x=!0,de(M))},e.unstable_forceFrameRate=function(Z){0>Z||125<Z?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):S=0<Z?Math.floor(1e3/Z):5},e.unstable_getCurrentPriorityLevel=function(){return m},e.unstable_getFirstCallbackNode=function(){return r(l)},e.unstable_next=function(Z){switch(m){case 1:case 2:case 3:var G=3;break;default:G=m}var ae=m;m=G;try{return Z()}finally{m=ae}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(Z,G){switch(Z){case 1:case 2:case 3:case 4:case 5:break;default:Z=3}var ae=m;m=Z;try{return G()}finally{m=ae}},e.unstable_scheduleCallback=function(Z,G,ae){var fe=e.unstable_now();switch(typeof ae=="object"&&ae!==null?(ae=ae.delay,ae=typeof ae=="number"&&0<ae?fe+ae:fe):ae=fe,Z){case 1:var B=-1;break;case 2:B=250;break;case 5:B=1073741823;break;case 4:B=1e4;break;default:B=5e3}return B=ae+B,Z={id:u++,callback:G,priorityLevel:Z,startTime:ae,expirationTime:B,sortIndex:-1},ae>fe?(Z.sortIndex=ae,t(c,Z),r(l)===null&&Z===r(c)&&(g?(k(E),E=-1):g=!0,ge(C,ae-fe))):(Z.sortIndex=B,t(l,Z),x||p||(x=!0,de(M))),Z},e.unstable_shouldYield=P,e.unstable_wrapCallback=function(Z){var G=m;return function(){var ae=m;m=G;try{return Z.apply(this,arguments)}finally{m=ae}}}})(mE);dE.exports=mE;var TC=dE.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var kC=z,Sn=TC;function we(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,r=1;r<arguments.length;r++)t+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var pE=new Set,Dc={};function eo(e,t){Zo(e,t),Zo(e+"Capture",t)}function Zo(e,t){for(Dc[e]=t,e=0;e<t.length;e++)pE.add(t[e])}var ua=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),um=Object.prototype.hasOwnProperty,SC=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Jv={},Zv={};function AC(e){return um.call(Zv,e)?!0:um.call(Jv,e)?!1:SC.test(e)?Zv[e]=!0:(Jv[e]=!0,!1)}function IC(e,t,r,n){if(r!==null&&r.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return n?!1:r!==null?!r.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function CC(e,t,r,n){if(t===null||typeof t>"u"||IC(e,t,r,n))return!0;if(n)return!1;if(r!==null)switch(r.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function rn(e,t,r,n,s,a,i){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=n,this.attributeNamespace=s,this.mustUseProperty=r,this.propertyName=e,this.type=t,this.sanitizeURL=a,this.removeEmptyString=i}var Ir={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){Ir[e]=new rn(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];Ir[t]=new rn(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){Ir[e]=new rn(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){Ir[e]=new rn(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){Ir[e]=new rn(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){Ir[e]=new rn(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){Ir[e]=new rn(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){Ir[e]=new rn(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){Ir[e]=new rn(e,5,!1,e.toLowerCase(),null,!1,!1)});var Qp=/[\-:]([a-z])/g;function Jp(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(Qp,Jp);Ir[t]=new rn(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(Qp,Jp);Ir[t]=new rn(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(Qp,Jp);Ir[t]=new rn(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){Ir[e]=new rn(e,1,!1,e.toLowerCase(),null,!1,!1)});Ir.xlinkHref=new rn("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){Ir[e]=new rn(e,1,!1,e.toLowerCase(),null,!0,!0)});function Zp(e,t,r,n){var s=Ir.hasOwnProperty(t)?Ir[t]:null;(s!==null?s.type!==0:n||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(CC(t,r,s,n)&&(r=null),n||s===null?AC(t)&&(r===null?e.removeAttribute(t):e.setAttribute(t,""+r)):s.mustUseProperty?e[s.propertyName]=r===null?s.type===3?!1:"":r:(t=s.attributeName,n=s.attributeNamespace,r===null?e.removeAttribute(t):(s=s.type,r=s===3||s===4&&r===!0?"":""+r,n?e.setAttributeNS(n,t,r):e.setAttribute(t,r))))}var Ea=kC.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,of=Symbol.for("react.element"),Ao=Symbol.for("react.portal"),Io=Symbol.for("react.fragment"),eg=Symbol.for("react.strict_mode"),fm=Symbol.for("react.profiler"),gE=Symbol.for("react.provider"),xE=Symbol.for("react.context"),tg=Symbol.for("react.forward_ref"),hm=Symbol.for("react.suspense"),dm=Symbol.for("react.suspense_list"),rg=Symbol.for("react.memo"),Da=Symbol.for("react.lazy"),vE=Symbol.for("react.offscreen"),e1=Symbol.iterator;function jl(e){return e===null||typeof e!="object"?null:(e=e1&&e[e1]||e["@@iterator"],typeof e=="function"?e:null)}var Mt=Object.assign,d0;function Yl(e){if(d0===void 0)try{throw Error()}catch(r){var t=r.stack.trim().match(/\n( *(at )?)/);d0=t&&t[1]||""}return`
`+d0+e}var m0=!1;function p0(e,t){if(!e||m0)return"";m0=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(c){var n=c}Reflect.construct(e,[],t)}else{try{t.call()}catch(c){n=c}e.call(t.prototype)}else{try{throw Error()}catch(c){n=c}e()}}catch(c){if(c&&n&&typeof c.stack=="string"){for(var s=c.stack.split(`
`),a=n.stack.split(`
`),i=s.length-1,o=a.length-1;1<=i&&0<=o&&s[i]!==a[o];)o--;for(;1<=i&&0<=o;i--,o--)if(s[i]!==a[o]){if(i!==1||o!==1)do if(i--,o--,0>o||s[i]!==a[o]){var l=`
`+s[i].replace(" at new "," at ");return e.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",e.displayName)),l}while(1<=i&&0<=o);break}}}finally{m0=!1,Error.prepareStackTrace=r}return(e=e?e.displayName||e.name:"")?Yl(e):""}function NC(e){switch(e.tag){case 5:return Yl(e.type);case 16:return Yl("Lazy");case 13:return Yl("Suspense");case 19:return Yl("SuspenseList");case 0:case 2:case 15:return e=p0(e.type,!1),e;case 11:return e=p0(e.type.render,!1),e;case 1:return e=p0(e.type,!0),e;default:return""}}function mm(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case Io:return"Fragment";case Ao:return"Portal";case fm:return"Profiler";case eg:return"StrictMode";case hm:return"Suspense";case dm:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case xE:return(e.displayName||"Context")+".Consumer";case gE:return(e._context.displayName||"Context")+".Provider";case tg:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case rg:return t=e.displayName||null,t!==null?t:mm(e.type)||"Memo";case Da:t=e._payload,e=e._init;try{return mm(e(t))}catch{}}return null}function RC(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return mm(t);case 8:return t===eg?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function ai(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function yE(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function bC(e){var t=yE(e)?"checked":"value",r=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),n=""+e[t];if(!e.hasOwnProperty(t)&&typeof r<"u"&&typeof r.get=="function"&&typeof r.set=="function"){var s=r.get,a=r.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return s.call(this)},set:function(i){n=""+i,a.call(this,i)}}),Object.defineProperty(e,t,{enumerable:r.enumerable}),{getValue:function(){return n},setValue:function(i){n=""+i},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function lf(e){e._valueTracker||(e._valueTracker=bC(e))}function _E(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var r=t.getValue(),n="";return e&&(n=yE(e)?e.checked?"true":"false":e.value),e=n,e!==r?(t.setValue(e),!0):!1}function lh(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function pm(e,t){var r=t.checked;return Mt({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:r??e._wrapperState.initialChecked})}function t1(e,t){var r=t.defaultValue==null?"":t.defaultValue,n=t.checked!=null?t.checked:t.defaultChecked;r=ai(t.value!=null?t.value:r),e._wrapperState={initialChecked:n,initialValue:r,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function wE(e,t){t=t.checked,t!=null&&Zp(e,"checked",t,!1)}function gm(e,t){wE(e,t);var r=ai(t.value),n=t.type;if(r!=null)n==="number"?(r===0&&e.value===""||e.value!=r)&&(e.value=""+r):e.value!==""+r&&(e.value=""+r);else if(n==="submit"||n==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?xm(e,t.type,r):t.hasOwnProperty("defaultValue")&&xm(e,t.type,ai(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function r1(e,t,r){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var n=t.type;if(!(n!=="submit"&&n!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,r||t===e.value||(e.value=t),e.defaultValue=t}r=e.name,r!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,r!==""&&(e.name=r)}function xm(e,t,r){(t!=="number"||lh(e.ownerDocument)!==e)&&(r==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+r&&(e.defaultValue=""+r))}var Ql=Array.isArray;function Uo(e,t,r,n){if(e=e.options,t){t={};for(var s=0;s<r.length;s++)t["$"+r[s]]=!0;for(r=0;r<e.length;r++)s=t.hasOwnProperty("$"+e[r].value),e[r].selected!==s&&(e[r].selected=s),s&&n&&(e[r].defaultSelected=!0)}else{for(r=""+ai(r),t=null,s=0;s<e.length;s++){if(e[s].value===r){e[s].selected=!0,n&&(e[s].defaultSelected=!0);return}t!==null||e[s].disabled||(t=e[s])}t!==null&&(t.selected=!0)}}function vm(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(we(91));return Mt({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function n1(e,t){var r=t.value;if(r==null){if(r=t.children,t=t.defaultValue,r!=null){if(t!=null)throw Error(we(92));if(Ql(r)){if(1<r.length)throw Error(we(93));r=r[0]}t=r}t==null&&(t=""),r=t}e._wrapperState={initialValue:ai(r)}}function EE(e,t){var r=ai(t.value),n=ai(t.defaultValue);r!=null&&(r=""+r,r!==e.value&&(e.value=r),t.defaultValue==null&&e.defaultValue!==r&&(e.defaultValue=r)),n!=null&&(e.defaultValue=""+n)}function s1(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function TE(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function ym(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?TE(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var cf,kE=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,r,n,s){MSApp.execUnsafeLocalFunction(function(){return e(t,r,n,s)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(cf=cf||document.createElement("div"),cf.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=cf.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function Fc(e,t){if(t){var r=e.firstChild;if(r&&r===e.lastChild&&r.nodeType===3){r.nodeValue=t;return}}e.textContent=t}var cc={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},PC=["Webkit","ms","Moz","O"];Object.keys(cc).forEach(function(e){PC.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),cc[t]=cc[e]})});function SE(e,t,r){return t==null||typeof t=="boolean"||t===""?"":r||typeof t!="number"||t===0||cc.hasOwnProperty(e)&&cc[e]?(""+t).trim():t+"px"}function AE(e,t){e=e.style;for(var r in t)if(t.hasOwnProperty(r)){var n=r.indexOf("--")===0,s=SE(r,t[r],n);r==="float"&&(r="cssFloat"),n?e.setProperty(r,s):e[r]=s}}var DC=Mt({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function _m(e,t){if(t){if(DC[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(we(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(we(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(we(61))}if(t.style!=null&&typeof t.style!="object")throw Error(we(62))}}function wm(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Em=null;function ng(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var Tm=null,Vo=null,Bo=null;function a1(e){if(e=wu(e)){if(typeof Tm!="function")throw Error(we(280));var t=e.stateNode;t&&(t=xd(t),Tm(e.stateNode,e.type,t))}}function IE(e){Vo?Bo?Bo.push(e):Bo=[e]:Vo=e}function CE(){if(Vo){var e=Vo,t=Bo;if(Bo=Vo=null,a1(e),t)for(e=0;e<t.length;e++)a1(t[e])}}function NE(e,t){return e(t)}function RE(){}var g0=!1;function bE(e,t,r){if(g0)return e(t,r);g0=!0;try{return NE(e,t,r)}finally{g0=!1,(Vo!==null||Bo!==null)&&(RE(),CE())}}function Oc(e,t){var r=e.stateNode;if(r===null)return null;var n=xd(r);if(n===null)return null;r=n[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(e=e.type,n=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!n;break e;default:e=!1}if(e)return null;if(r&&typeof r!="function")throw Error(we(231,t,typeof r));return r}var km=!1;if(ua)try{var Ul={};Object.defineProperty(Ul,"passive",{get:function(){km=!0}}),window.addEventListener("test",Ul,Ul),window.removeEventListener("test",Ul,Ul)}catch{km=!1}function FC(e,t,r,n,s,a,i,o,l){var c=Array.prototype.slice.call(arguments,3);try{t.apply(r,c)}catch(u){this.onError(u)}}var uc=!1,ch=null,uh=!1,Sm=null,OC={onError:function(e){uc=!0,ch=e}};function MC(e,t,r,n,s,a,i,o,l){uc=!1,ch=null,FC.apply(OC,arguments)}function LC(e,t,r,n,s,a,i,o,l){if(MC.apply(this,arguments),uc){if(uc){var c=ch;uc=!1,ch=null}else throw Error(we(198));uh||(uh=!0,Sm=c)}}function to(e){var t=e,r=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(r=t.return),e=t.return;while(e)}return t.tag===3?r:null}function PE(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function i1(e){if(to(e)!==e)throw Error(we(188))}function jC(e){var t=e.alternate;if(!t){if(t=to(e),t===null)throw Error(we(188));return t!==e?null:e}for(var r=e,n=t;;){var s=r.return;if(s===null)break;var a=s.alternate;if(a===null){if(n=s.return,n!==null){r=n;continue}break}if(s.child===a.child){for(a=s.child;a;){if(a===r)return i1(s),e;if(a===n)return i1(s),t;a=a.sibling}throw Error(we(188))}if(r.return!==n.return)r=s,n=a;else{for(var i=!1,o=s.child;o;){if(o===r){i=!0,r=s,n=a;break}if(o===n){i=!0,n=s,r=a;break}o=o.sibling}if(!i){for(o=a.child;o;){if(o===r){i=!0,r=a,n=s;break}if(o===n){i=!0,n=a,r=s;break}o=o.sibling}if(!i)throw Error(we(189))}}if(r.alternate!==n)throw Error(we(190))}if(r.tag!==3)throw Error(we(188));return r.stateNode.current===r?e:t}function DE(e){return e=jC(e),e!==null?FE(e):null}function FE(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=FE(e);if(t!==null)return t;e=e.sibling}return null}var OE=Sn.unstable_scheduleCallback,o1=Sn.unstable_cancelCallback,UC=Sn.unstable_shouldYield,VC=Sn.unstable_requestPaint,Ht=Sn.unstable_now,BC=Sn.unstable_getCurrentPriorityLevel,sg=Sn.unstable_ImmediatePriority,ME=Sn.unstable_UserBlockingPriority,fh=Sn.unstable_NormalPriority,zC=Sn.unstable_LowPriority,LE=Sn.unstable_IdlePriority,dd=null,ks=null;function $C(e){if(ks&&typeof ks.onCommitFiberRoot=="function")try{ks.onCommitFiberRoot(dd,e,void 0,(e.current.flags&128)===128)}catch{}}var ls=Math.clz32?Math.clz32:GC,WC=Math.log,HC=Math.LN2;function GC(e){return e>>>=0,e===0?32:31-(WC(e)/HC|0)|0}var uf=64,ff=4194304;function Jl(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function hh(e,t){var r=e.pendingLanes;if(r===0)return 0;var n=0,s=e.suspendedLanes,a=e.pingedLanes,i=r&268435455;if(i!==0){var o=i&~s;o!==0?n=Jl(o):(a&=i,a!==0&&(n=Jl(a)))}else i=r&~s,i!==0?n=Jl(i):a!==0&&(n=Jl(a));if(n===0)return 0;if(t!==0&&t!==n&&!(t&s)&&(s=n&-n,a=t&-t,s>=a||s===16&&(a&4194240)!==0))return t;if(n&4&&(n|=r&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=n;0<t;)r=31-ls(t),s=1<<r,n|=e[r],t&=~s;return n}function KC(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function qC(e,t){for(var r=e.suspendedLanes,n=e.pingedLanes,s=e.expirationTimes,a=e.pendingLanes;0<a;){var i=31-ls(a),o=1<<i,l=s[i];l===-1?(!(o&r)||o&n)&&(s[i]=KC(o,t)):l<=t&&(e.expiredLanes|=o),a&=~o}}function Am(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function jE(){var e=uf;return uf<<=1,!(uf&4194240)&&(uf=64),e}function x0(e){for(var t=[],r=0;31>r;r++)t.push(e);return t}function yu(e,t,r){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-ls(t),e[t]=r}function XC(e,t){var r=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var n=e.eventTimes;for(e=e.expirationTimes;0<r;){var s=31-ls(r),a=1<<s;t[s]=0,n[s]=-1,e[s]=-1,r&=~a}}function ag(e,t){var r=e.entangledLanes|=t;for(e=e.entanglements;r;){var n=31-ls(r),s=1<<n;s&t|e[n]&t&&(e[n]|=t),r&=~s}}var gt=0;function UE(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var VE,ig,BE,zE,$E,Im=!1,hf=[],Ka=null,qa=null,Xa=null,Mc=new Map,Lc=new Map,Oa=[],YC="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function l1(e,t){switch(e){case"focusin":case"focusout":Ka=null;break;case"dragenter":case"dragleave":qa=null;break;case"mouseover":case"mouseout":Xa=null;break;case"pointerover":case"pointerout":Mc.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Lc.delete(t.pointerId)}}function Vl(e,t,r,n,s,a){return e===null||e.nativeEvent!==a?(e={blockedOn:t,domEventName:r,eventSystemFlags:n,nativeEvent:a,targetContainers:[s]},t!==null&&(t=wu(t),t!==null&&ig(t)),e):(e.eventSystemFlags|=n,t=e.targetContainers,s!==null&&t.indexOf(s)===-1&&t.push(s),e)}function QC(e,t,r,n,s){switch(t){case"focusin":return Ka=Vl(Ka,e,t,r,n,s),!0;case"dragenter":return qa=Vl(qa,e,t,r,n,s),!0;case"mouseover":return Xa=Vl(Xa,e,t,r,n,s),!0;case"pointerover":var a=s.pointerId;return Mc.set(a,Vl(Mc.get(a)||null,e,t,r,n,s)),!0;case"gotpointercapture":return a=s.pointerId,Lc.set(a,Vl(Lc.get(a)||null,e,t,r,n,s)),!0}return!1}function WE(e){var t=Ci(e.target);if(t!==null){var r=to(t);if(r!==null){if(t=r.tag,t===13){if(t=PE(r),t!==null){e.blockedOn=t,$E(e.priority,function(){BE(r)});return}}else if(t===3&&r.stateNode.current.memoizedState.isDehydrated){e.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}e.blockedOn=null}function Bf(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var r=Cm(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(r===null){r=e.nativeEvent;var n=new r.constructor(r.type,r);Em=n,r.target.dispatchEvent(n),Em=null}else return t=wu(r),t!==null&&ig(t),e.blockedOn=r,!1;t.shift()}return!0}function c1(e,t,r){Bf(e)&&r.delete(t)}function JC(){Im=!1,Ka!==null&&Bf(Ka)&&(Ka=null),qa!==null&&Bf(qa)&&(qa=null),Xa!==null&&Bf(Xa)&&(Xa=null),Mc.forEach(c1),Lc.forEach(c1)}function Bl(e,t){e.blockedOn===t&&(e.blockedOn=null,Im||(Im=!0,Sn.unstable_scheduleCallback(Sn.unstable_NormalPriority,JC)))}function jc(e){function t(s){return Bl(s,e)}if(0<hf.length){Bl(hf[0],e);for(var r=1;r<hf.length;r++){var n=hf[r];n.blockedOn===e&&(n.blockedOn=null)}}for(Ka!==null&&Bl(Ka,e),qa!==null&&Bl(qa,e),Xa!==null&&Bl(Xa,e),Mc.forEach(t),Lc.forEach(t),r=0;r<Oa.length;r++)n=Oa[r],n.blockedOn===e&&(n.blockedOn=null);for(;0<Oa.length&&(r=Oa[0],r.blockedOn===null);)WE(r),r.blockedOn===null&&Oa.shift()}var zo=Ea.ReactCurrentBatchConfig,dh=!0;function ZC(e,t,r,n){var s=gt,a=zo.transition;zo.transition=null;try{gt=1,og(e,t,r,n)}finally{gt=s,zo.transition=a}}function eN(e,t,r,n){var s=gt,a=zo.transition;zo.transition=null;try{gt=4,og(e,t,r,n)}finally{gt=s,zo.transition=a}}function og(e,t,r,n){if(dh){var s=Cm(e,t,r,n);if(s===null)I0(e,t,n,mh,r),l1(e,n);else if(QC(s,e,t,r,n))n.stopPropagation();else if(l1(e,n),t&4&&-1<YC.indexOf(e)){for(;s!==null;){var a=wu(s);if(a!==null&&VE(a),a=Cm(e,t,r,n),a===null&&I0(e,t,n,mh,r),a===s)break;s=a}s!==null&&n.stopPropagation()}else I0(e,t,n,null,r)}}var mh=null;function Cm(e,t,r,n){if(mh=null,e=ng(n),e=Ci(e),e!==null)if(t=to(e),t===null)e=null;else if(r=t.tag,r===13){if(e=PE(t),e!==null)return e;e=null}else if(r===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return mh=e,null}function HE(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(BC()){case sg:return 1;case ME:return 4;case fh:case zC:return 16;case LE:return 536870912;default:return 16}default:return 16}}var Ba=null,lg=null,zf=null;function GE(){if(zf)return zf;var e,t=lg,r=t.length,n,s="value"in Ba?Ba.value:Ba.textContent,a=s.length;for(e=0;e<r&&t[e]===s[e];e++);var i=r-e;for(n=1;n<=i&&t[r-n]===s[a-n];n++);return zf=s.slice(e,1<n?1-n:void 0)}function $f(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function df(){return!0}function u1(){return!1}function Cn(e){function t(r,n,s,a,i){this._reactName=r,this._targetInst=s,this.type=n,this.nativeEvent=a,this.target=i,this.currentTarget=null;for(var o in e)e.hasOwnProperty(o)&&(r=e[o],this[o]=r?r(a):a[o]);return this.isDefaultPrevented=(a.defaultPrevented!=null?a.defaultPrevented:a.returnValue===!1)?df:u1,this.isPropagationStopped=u1,this}return Mt(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=df)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=df)},persist:function(){},isPersistent:df}),t}var yl={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},cg=Cn(yl),_u=Mt({},yl,{view:0,detail:0}),tN=Cn(_u),v0,y0,zl,md=Mt({},_u,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:ug,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==zl&&(zl&&e.type==="mousemove"?(v0=e.screenX-zl.screenX,y0=e.screenY-zl.screenY):y0=v0=0,zl=e),v0)},movementY:function(e){return"movementY"in e?e.movementY:y0}}),f1=Cn(md),rN=Mt({},md,{dataTransfer:0}),nN=Cn(rN),sN=Mt({},_u,{relatedTarget:0}),_0=Cn(sN),aN=Mt({},yl,{animationName:0,elapsedTime:0,pseudoElement:0}),iN=Cn(aN),oN=Mt({},yl,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),lN=Cn(oN),cN=Mt({},yl,{data:0}),h1=Cn(cN),uN={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},fN={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},hN={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function dN(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=hN[e])?!!t[e]:!1}function ug(){return dN}var mN=Mt({},_u,{key:function(e){if(e.key){var t=uN[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=$f(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?fN[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:ug,charCode:function(e){return e.type==="keypress"?$f(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?$f(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),pN=Cn(mN),gN=Mt({},md,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),d1=Cn(gN),xN=Mt({},_u,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:ug}),vN=Cn(xN),yN=Mt({},yl,{propertyName:0,elapsedTime:0,pseudoElement:0}),_N=Cn(yN),wN=Mt({},md,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),EN=Cn(wN),TN=[9,13,27,32],fg=ua&&"CompositionEvent"in window,fc=null;ua&&"documentMode"in document&&(fc=document.documentMode);var kN=ua&&"TextEvent"in window&&!fc,KE=ua&&(!fg||fc&&8<fc&&11>=fc),m1=" ",p1=!1;function qE(e,t){switch(e){case"keyup":return TN.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function XE(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var Co=!1;function SN(e,t){switch(e){case"compositionend":return XE(t);case"keypress":return t.which!==32?null:(p1=!0,m1);case"textInput":return e=t.data,e===m1&&p1?null:e;default:return null}}function AN(e,t){if(Co)return e==="compositionend"||!fg&&qE(e,t)?(e=GE(),zf=lg=Ba=null,Co=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return KE&&t.locale!=="ko"?null:t.data;default:return null}}var IN={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function g1(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!IN[e.type]:t==="textarea"}function YE(e,t,r,n){IE(n),t=ph(t,"onChange"),0<t.length&&(r=new cg("onChange","change",null,r,n),e.push({event:r,listeners:t}))}var hc=null,Uc=null;function CN(e){o2(e,0)}function pd(e){var t=bo(e);if(_E(t))return e}function NN(e,t){if(e==="change")return t}var QE=!1;if(ua){var w0;if(ua){var E0="oninput"in document;if(!E0){var x1=document.createElement("div");x1.setAttribute("oninput","return;"),E0=typeof x1.oninput=="function"}w0=E0}else w0=!1;QE=w0&&(!document.documentMode||9<document.documentMode)}function v1(){hc&&(hc.detachEvent("onpropertychange",JE),Uc=hc=null)}function JE(e){if(e.propertyName==="value"&&pd(Uc)){var t=[];YE(t,Uc,e,ng(e)),bE(CN,t)}}function RN(e,t,r){e==="focusin"?(v1(),hc=t,Uc=r,hc.attachEvent("onpropertychange",JE)):e==="focusout"&&v1()}function bN(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return pd(Uc)}function PN(e,t){if(e==="click")return pd(t)}function DN(e,t){if(e==="input"||e==="change")return pd(t)}function FN(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var hs=typeof Object.is=="function"?Object.is:FN;function Vc(e,t){if(hs(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var r=Object.keys(e),n=Object.keys(t);if(r.length!==n.length)return!1;for(n=0;n<r.length;n++){var s=r[n];if(!um.call(t,s)||!hs(e[s],t[s]))return!1}return!0}function y1(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function _1(e,t){var r=y1(e);e=0;for(var n;r;){if(r.nodeType===3){if(n=e+r.textContent.length,e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=y1(r)}}function ZE(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?ZE(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function e2(){for(var e=window,t=lh();t instanceof e.HTMLIFrameElement;){try{var r=typeof t.contentWindow.location.href=="string"}catch{r=!1}if(r)e=t.contentWindow;else break;t=lh(e.document)}return t}function hg(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function ON(e){var t=e2(),r=e.focusedElem,n=e.selectionRange;if(t!==r&&r&&r.ownerDocument&&ZE(r.ownerDocument.documentElement,r)){if(n!==null&&hg(r)){if(t=n.start,e=n.end,e===void 0&&(e=t),"selectionStart"in r)r.selectionStart=t,r.selectionEnd=Math.min(e,r.value.length);else if(e=(t=r.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var s=r.textContent.length,a=Math.min(n.start,s);n=n.end===void 0?a:Math.min(n.end,s),!e.extend&&a>n&&(s=n,n=a,a=s),s=_1(r,a);var i=_1(r,n);s&&i&&(e.rangeCount!==1||e.anchorNode!==s.node||e.anchorOffset!==s.offset||e.focusNode!==i.node||e.focusOffset!==i.offset)&&(t=t.createRange(),t.setStart(s.node,s.offset),e.removeAllRanges(),a>n?(e.addRange(t),e.extend(i.node,i.offset)):(t.setEnd(i.node,i.offset),e.addRange(t)))}}for(t=[],e=r;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof r.focus=="function"&&r.focus(),r=0;r<t.length;r++)e=t[r],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var MN=ua&&"documentMode"in document&&11>=document.documentMode,No=null,Nm=null,dc=null,Rm=!1;function w1(e,t,r){var n=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;Rm||No==null||No!==lh(n)||(n=No,"selectionStart"in n&&hg(n)?n={start:n.selectionStart,end:n.selectionEnd}:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection(),n={anchorNode:n.anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset}),dc&&Vc(dc,n)||(dc=n,n=ph(Nm,"onSelect"),0<n.length&&(t=new cg("onSelect","select",null,t,r),e.push({event:t,listeners:n}),t.target=No)))}function mf(e,t){var r={};return r[e.toLowerCase()]=t.toLowerCase(),r["Webkit"+e]="webkit"+t,r["Moz"+e]="moz"+t,r}var Ro={animationend:mf("Animation","AnimationEnd"),animationiteration:mf("Animation","AnimationIteration"),animationstart:mf("Animation","AnimationStart"),transitionend:mf("Transition","TransitionEnd")},T0={},t2={};ua&&(t2=document.createElement("div").style,"AnimationEvent"in window||(delete Ro.animationend.animation,delete Ro.animationiteration.animation,delete Ro.animationstart.animation),"TransitionEvent"in window||delete Ro.transitionend.transition);function gd(e){if(T0[e])return T0[e];if(!Ro[e])return e;var t=Ro[e],r;for(r in t)if(t.hasOwnProperty(r)&&r in t2)return T0[e]=t[r];return e}var r2=gd("animationend"),n2=gd("animationiteration"),s2=gd("animationstart"),a2=gd("transitionend"),i2=new Map,E1="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function mi(e,t){i2.set(e,t),eo(t,[e])}for(var k0=0;k0<E1.length;k0++){var S0=E1[k0],LN=S0.toLowerCase(),jN=S0[0].toUpperCase()+S0.slice(1);mi(LN,"on"+jN)}mi(r2,"onAnimationEnd");mi(n2,"onAnimationIteration");mi(s2,"onAnimationStart");mi("dblclick","onDoubleClick");mi("focusin","onFocus");mi("focusout","onBlur");mi(a2,"onTransitionEnd");Zo("onMouseEnter",["mouseout","mouseover"]);Zo("onMouseLeave",["mouseout","mouseover"]);Zo("onPointerEnter",["pointerout","pointerover"]);Zo("onPointerLeave",["pointerout","pointerover"]);eo("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));eo("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));eo("onBeforeInput",["compositionend","keypress","textInput","paste"]);eo("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));eo("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));eo("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Zl="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),UN=new Set("cancel close invalid load scroll toggle".split(" ").concat(Zl));function T1(e,t,r){var n=e.type||"unknown-event";e.currentTarget=r,LC(n,t,void 0,e),e.currentTarget=null}function o2(e,t){t=(t&4)!==0;for(var r=0;r<e.length;r++){var n=e[r],s=n.event;n=n.listeners;e:{var a=void 0;if(t)for(var i=n.length-1;0<=i;i--){var o=n[i],l=o.instance,c=o.currentTarget;if(o=o.listener,l!==a&&s.isPropagationStopped())break e;T1(s,o,c),a=l}else for(i=0;i<n.length;i++){if(o=n[i],l=o.instance,c=o.currentTarget,o=o.listener,l!==a&&s.isPropagationStopped())break e;T1(s,o,c),a=l}}}if(uh)throw e=Sm,uh=!1,Sm=null,e}function It(e,t){var r=t[Om];r===void 0&&(r=t[Om]=new Set);var n=e+"__bubble";r.has(n)||(l2(t,e,2,!1),r.add(n))}function A0(e,t,r){var n=0;t&&(n|=4),l2(r,e,n,t)}var pf="_reactListening"+Math.random().toString(36).slice(2);function Bc(e){if(!e[pf]){e[pf]=!0,pE.forEach(function(r){r!=="selectionchange"&&(UN.has(r)||A0(r,!1,e),A0(r,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[pf]||(t[pf]=!0,A0("selectionchange",!1,t))}}function l2(e,t,r,n){switch(HE(t)){case 1:var s=ZC;break;case 4:s=eN;break;default:s=og}r=s.bind(null,t,r,e),s=void 0,!km||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(s=!0),n?s!==void 0?e.addEventListener(t,r,{capture:!0,passive:s}):e.addEventListener(t,r,!0):s!==void 0?e.addEventListener(t,r,{passive:s}):e.addEventListener(t,r,!1)}function I0(e,t,r,n,s){var a=n;if(!(t&1)&&!(t&2)&&n!==null)e:for(;;){if(n===null)return;var i=n.tag;if(i===3||i===4){var o=n.stateNode.containerInfo;if(o===s||o.nodeType===8&&o.parentNode===s)break;if(i===4)for(i=n.return;i!==null;){var l=i.tag;if((l===3||l===4)&&(l=i.stateNode.containerInfo,l===s||l.nodeType===8&&l.parentNode===s))return;i=i.return}for(;o!==null;){if(i=Ci(o),i===null)return;if(l=i.tag,l===5||l===6){n=a=i;continue e}o=o.parentNode}}n=n.return}bE(function(){var c=a,u=ng(r),d=[];e:{var m=i2.get(e);if(m!==void 0){var p=cg,x=e;switch(e){case"keypress":if($f(r)===0)break e;case"keydown":case"keyup":p=pN;break;case"focusin":x="focus",p=_0;break;case"focusout":x="blur",p=_0;break;case"beforeblur":case"afterblur":p=_0;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":p=f1;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":p=nN;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":p=vN;break;case r2:case n2:case s2:p=iN;break;case a2:p=_N;break;case"scroll":p=tN;break;case"wheel":p=EN;break;case"copy":case"cut":case"paste":p=lN;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":p=d1}var g=(t&4)!==0,_=!g&&e==="scroll",k=g?m!==null?m+"Capture":null:m;g=[];for(var T=c,w;T!==null;){w=T;var C=w.stateNode;if(w.tag===5&&C!==null&&(w=C,k!==null&&(C=Oc(T,k),C!=null&&g.push(zc(T,C,w)))),_)break;T=T.return}0<g.length&&(m=new p(m,x,null,r,u),d.push({event:m,listeners:g}))}}if(!(t&7)){e:{if(m=e==="mouseover"||e==="pointerover",p=e==="mouseout"||e==="pointerout",m&&r!==Em&&(x=r.relatedTarget||r.fromElement)&&(Ci(x)||x[fa]))break e;if((p||m)&&(m=u.window===u?u:(m=u.ownerDocument)?m.defaultView||m.parentWindow:window,p?(x=r.relatedTarget||r.toElement,p=c,x=x?Ci(x):null,x!==null&&(_=to(x),x!==_||x.tag!==5&&x.tag!==6)&&(x=null)):(p=null,x=c),p!==x)){if(g=f1,C="onMouseLeave",k="onMouseEnter",T="mouse",(e==="pointerout"||e==="pointerover")&&(g=d1,C="onPointerLeave",k="onPointerEnter",T="pointer"),_=p==null?m:bo(p),w=x==null?m:bo(x),m=new g(C,T+"leave",p,r,u),m.target=_,m.relatedTarget=w,C=null,Ci(u)===c&&(g=new g(k,T+"enter",x,r,u),g.target=w,g.relatedTarget=_,C=g),_=C,p&&x)t:{for(g=p,k=x,T=0,w=g;w;w=yo(w))T++;for(w=0,C=k;C;C=yo(C))w++;for(;0<T-w;)g=yo(g),T--;for(;0<w-T;)k=yo(k),w--;for(;T--;){if(g===k||k!==null&&g===k.alternate)break t;g=yo(g),k=yo(k)}g=null}else g=null;p!==null&&k1(d,m,p,g,!1),x!==null&&_!==null&&k1(d,_,x,g,!0)}}e:{if(m=c?bo(c):window,p=m.nodeName&&m.nodeName.toLowerCase(),p==="select"||p==="input"&&m.type==="file")var M=NN;else if(g1(m))if(QE)M=DN;else{M=bN;var O=RN}else(p=m.nodeName)&&p.toLowerCase()==="input"&&(m.type==="checkbox"||m.type==="radio")&&(M=PN);if(M&&(M=M(e,c))){YE(d,M,r,u);break e}O&&O(e,m,c),e==="focusout"&&(O=m._wrapperState)&&O.controlled&&m.type==="number"&&xm(m,"number",m.value)}switch(O=c?bo(c):window,e){case"focusin":(g1(O)||O.contentEditable==="true")&&(No=O,Nm=c,dc=null);break;case"focusout":dc=Nm=No=null;break;case"mousedown":Rm=!0;break;case"contextmenu":case"mouseup":case"dragend":Rm=!1,w1(d,r,u);break;case"selectionchange":if(MN)break;case"keydown":case"keyup":w1(d,r,u)}var v;if(fg)e:{switch(e){case"compositionstart":var E="onCompositionStart";break e;case"compositionend":E="onCompositionEnd";break e;case"compositionupdate":E="onCompositionUpdate";break e}E=void 0}else Co?qE(e,r)&&(E="onCompositionEnd"):e==="keydown"&&r.keyCode===229&&(E="onCompositionStart");E&&(KE&&r.locale!=="ko"&&(Co||E!=="onCompositionStart"?E==="onCompositionEnd"&&Co&&(v=GE()):(Ba=u,lg="value"in Ba?Ba.value:Ba.textContent,Co=!0)),O=ph(c,E),0<O.length&&(E=new h1(E,e,null,r,u),d.push({event:E,listeners:O}),v?E.data=v:(v=XE(r),v!==null&&(E.data=v)))),(v=kN?SN(e,r):AN(e,r))&&(c=ph(c,"onBeforeInput"),0<c.length&&(u=new h1("onBeforeInput","beforeinput",null,r,u),d.push({event:u,listeners:c}),u.data=v))}o2(d,t)})}function zc(e,t,r){return{instance:e,listener:t,currentTarget:r}}function ph(e,t){for(var r=t+"Capture",n=[];e!==null;){var s=e,a=s.stateNode;s.tag===5&&a!==null&&(s=a,a=Oc(e,r),a!=null&&n.unshift(zc(e,a,s)),a=Oc(e,t),a!=null&&n.push(zc(e,a,s))),e=e.return}return n}function yo(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function k1(e,t,r,n,s){for(var a=t._reactName,i=[];r!==null&&r!==n;){var o=r,l=o.alternate,c=o.stateNode;if(l!==null&&l===n)break;o.tag===5&&c!==null&&(o=c,s?(l=Oc(r,a),l!=null&&i.unshift(zc(r,l,o))):s||(l=Oc(r,a),l!=null&&i.push(zc(r,l,o)))),r=r.return}i.length!==0&&e.push({event:t,listeners:i})}var VN=/\r\n?/g,BN=/\u0000|\uFFFD/g;function S1(e){return(typeof e=="string"?e:""+e).replace(VN,`
`).replace(BN,"")}function gf(e,t,r){if(t=S1(t),S1(e)!==t&&r)throw Error(we(425))}function gh(){}var bm=null,Pm=null;function Dm(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var Fm=typeof setTimeout=="function"?setTimeout:void 0,zN=typeof clearTimeout=="function"?clearTimeout:void 0,A1=typeof Promise=="function"?Promise:void 0,$N=typeof queueMicrotask=="function"?queueMicrotask:typeof A1<"u"?function(e){return A1.resolve(null).then(e).catch(WN)}:Fm;function WN(e){setTimeout(function(){throw e})}function C0(e,t){var r=t,n=0;do{var s=r.nextSibling;if(e.removeChild(r),s&&s.nodeType===8)if(r=s.data,r==="/$"){if(n===0){e.removeChild(s),jc(t);return}n--}else r!=="$"&&r!=="$?"&&r!=="$!"||n++;r=s}while(r);jc(t)}function Ya(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function I1(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="$"||r==="$!"||r==="$?"){if(t===0)return e;t--}else r==="/$"&&t++}e=e.previousSibling}return null}var _l=Math.random().toString(36).slice(2),ws="__reactFiber$"+_l,$c="__reactProps$"+_l,fa="__reactContainer$"+_l,Om="__reactEvents$"+_l,HN="__reactListeners$"+_l,GN="__reactHandles$"+_l;function Ci(e){var t=e[ws];if(t)return t;for(var r=e.parentNode;r;){if(t=r[fa]||r[ws]){if(r=t.alternate,t.child!==null||r!==null&&r.child!==null)for(e=I1(e);e!==null;){if(r=e[ws])return r;e=I1(e)}return t}e=r,r=e.parentNode}return null}function wu(e){return e=e[ws]||e[fa],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function bo(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(we(33))}function xd(e){return e[$c]||null}var Mm=[],Po=-1;function pi(e){return{current:e}}function Nt(e){0>Po||(e.current=Mm[Po],Mm[Po]=null,Po--)}function Et(e,t){Po++,Mm[Po]=e.current,e.current=t}var ii={},Wr=pi(ii),hn=pi(!1),Bi=ii;function el(e,t){var r=e.type.contextTypes;if(!r)return ii;var n=e.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===t)return n.__reactInternalMemoizedMaskedChildContext;var s={},a;for(a in r)s[a]=t[a];return n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=s),s}function dn(e){return e=e.childContextTypes,e!=null}function xh(){Nt(hn),Nt(Wr)}function C1(e,t,r){if(Wr.current!==ii)throw Error(we(168));Et(Wr,t),Et(hn,r)}function c2(e,t,r){var n=e.stateNode;if(t=t.childContextTypes,typeof n.getChildContext!="function")return r;n=n.getChildContext();for(var s in n)if(!(s in t))throw Error(we(108,RC(e)||"Unknown",s));return Mt({},r,n)}function vh(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||ii,Bi=Wr.current,Et(Wr,e),Et(hn,hn.current),!0}function N1(e,t,r){var n=e.stateNode;if(!n)throw Error(we(169));r?(e=c2(e,t,Bi),n.__reactInternalMemoizedMergedChildContext=e,Nt(hn),Nt(Wr),Et(Wr,e)):Nt(hn),Et(hn,r)}var Qs=null,vd=!1,N0=!1;function u2(e){Qs===null?Qs=[e]:Qs.push(e)}function KN(e){vd=!0,u2(e)}function gi(){if(!N0&&Qs!==null){N0=!0;var e=0,t=gt;try{var r=Qs;for(gt=1;e<r.length;e++){var n=r[e];do n=n(!0);while(n!==null)}Qs=null,vd=!1}catch(s){throw Qs!==null&&(Qs=Qs.slice(e+1)),OE(sg,gi),s}finally{gt=t,N0=!1}}return null}var Do=[],Fo=0,yh=null,_h=0,Mn=[],Ln=0,zi=null,Js=1,Zs="";function Ei(e,t){Do[Fo++]=_h,Do[Fo++]=yh,yh=e,_h=t}function f2(e,t,r){Mn[Ln++]=Js,Mn[Ln++]=Zs,Mn[Ln++]=zi,zi=e;var n=Js;e=Zs;var s=32-ls(n)-1;n&=~(1<<s),r+=1;var a=32-ls(t)+s;if(30<a){var i=s-s%5;a=(n&(1<<i)-1).toString(32),n>>=i,s-=i,Js=1<<32-ls(t)+s|r<<s|n,Zs=a+e}else Js=1<<a|r<<s|n,Zs=e}function dg(e){e.return!==null&&(Ei(e,1),f2(e,1,0))}function mg(e){for(;e===yh;)yh=Do[--Fo],Do[Fo]=null,_h=Do[--Fo],Do[Fo]=null;for(;e===zi;)zi=Mn[--Ln],Mn[Ln]=null,Zs=Mn[--Ln],Mn[Ln]=null,Js=Mn[--Ln],Mn[Ln]=null}var kn=null,En=null,Pt=!1,rs=null;function h2(e,t){var r=jn(5,null,null,0);r.elementType="DELETED",r.stateNode=t,r.return=e,t=e.deletions,t===null?(e.deletions=[r],e.flags|=16):t.push(r)}function R1(e,t){switch(e.tag){case 5:var r=e.type;return t=t.nodeType!==1||r.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,kn=e,En=Ya(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,kn=e,En=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(r=zi!==null?{id:Js,overflow:Zs}:null,e.memoizedState={dehydrated:t,treeContext:r,retryLane:1073741824},r=jn(18,null,null,0),r.stateNode=t,r.return=e,e.child=r,kn=e,En=null,!0):!1;default:return!1}}function Lm(e){return(e.mode&1)!==0&&(e.flags&128)===0}function jm(e){if(Pt){var t=En;if(t){var r=t;if(!R1(e,t)){if(Lm(e))throw Error(we(418));t=Ya(r.nextSibling);var n=kn;t&&R1(e,t)?h2(n,r):(e.flags=e.flags&-4097|2,Pt=!1,kn=e)}}else{if(Lm(e))throw Error(we(418));e.flags=e.flags&-4097|2,Pt=!1,kn=e}}}function b1(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;kn=e}function xf(e){if(e!==kn)return!1;if(!Pt)return b1(e),Pt=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!Dm(e.type,e.memoizedProps)),t&&(t=En)){if(Lm(e))throw d2(),Error(we(418));for(;t;)h2(e,t),t=Ya(t.nextSibling)}if(b1(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(we(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="/$"){if(t===0){En=Ya(e.nextSibling);break e}t--}else r!=="$"&&r!=="$!"&&r!=="$?"||t++}e=e.nextSibling}En=null}}else En=kn?Ya(e.stateNode.nextSibling):null;return!0}function d2(){for(var e=En;e;)e=Ya(e.nextSibling)}function tl(){En=kn=null,Pt=!1}function pg(e){rs===null?rs=[e]:rs.push(e)}var qN=Ea.ReactCurrentBatchConfig;function $l(e,t,r){if(e=r.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(r._owner){if(r=r._owner,r){if(r.tag!==1)throw Error(we(309));var n=r.stateNode}if(!n)throw Error(we(147,e));var s=n,a=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===a?t.ref:(t=function(i){var o=s.refs;i===null?delete o[a]:o[a]=i},t._stringRef=a,t)}if(typeof e!="string")throw Error(we(284));if(!r._owner)throw Error(we(290,e))}return e}function vf(e,t){throw e=Object.prototype.toString.call(t),Error(we(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function P1(e){var t=e._init;return t(e._payload)}function m2(e){function t(k,T){if(e){var w=k.deletions;w===null?(k.deletions=[T],k.flags|=16):w.push(T)}}function r(k,T){if(!e)return null;for(;T!==null;)t(k,T),T=T.sibling;return null}function n(k,T){for(k=new Map;T!==null;)T.key!==null?k.set(T.key,T):k.set(T.index,T),T=T.sibling;return k}function s(k,T){return k=ei(k,T),k.index=0,k.sibling=null,k}function a(k,T,w){return k.index=w,e?(w=k.alternate,w!==null?(w=w.index,w<T?(k.flags|=2,T):w):(k.flags|=2,T)):(k.flags|=1048576,T)}function i(k){return e&&k.alternate===null&&(k.flags|=2),k}function o(k,T,w,C){return T===null||T.tag!==6?(T=M0(w,k.mode,C),T.return=k,T):(T=s(T,w),T.return=k,T)}function l(k,T,w,C){var M=w.type;return M===Io?u(k,T,w.props.children,C,w.key):T!==null&&(T.elementType===M||typeof M=="object"&&M!==null&&M.$$typeof===Da&&P1(M)===T.type)?(C=s(T,w.props),C.ref=$l(k,T,w),C.return=k,C):(C=Yf(w.type,w.key,w.props,null,k.mode,C),C.ref=$l(k,T,w),C.return=k,C)}function c(k,T,w,C){return T===null||T.tag!==4||T.stateNode.containerInfo!==w.containerInfo||T.stateNode.implementation!==w.implementation?(T=L0(w,k.mode,C),T.return=k,T):(T=s(T,w.children||[]),T.return=k,T)}function u(k,T,w,C,M){return T===null||T.tag!==7?(T=Mi(w,k.mode,C,M),T.return=k,T):(T=s(T,w),T.return=k,T)}function d(k,T,w){if(typeof T=="string"&&T!==""||typeof T=="number")return T=M0(""+T,k.mode,w),T.return=k,T;if(typeof T=="object"&&T!==null){switch(T.$$typeof){case of:return w=Yf(T.type,T.key,T.props,null,k.mode,w),w.ref=$l(k,null,T),w.return=k,w;case Ao:return T=L0(T,k.mode,w),T.return=k,T;case Da:var C=T._init;return d(k,C(T._payload),w)}if(Ql(T)||jl(T))return T=Mi(T,k.mode,w,null),T.return=k,T;vf(k,T)}return null}function m(k,T,w,C){var M=T!==null?T.key:null;if(typeof w=="string"&&w!==""||typeof w=="number")return M!==null?null:o(k,T,""+w,C);if(typeof w=="object"&&w!==null){switch(w.$$typeof){case of:return w.key===M?l(k,T,w,C):null;case Ao:return w.key===M?c(k,T,w,C):null;case Da:return M=w._init,m(k,T,M(w._payload),C)}if(Ql(w)||jl(w))return M!==null?null:u(k,T,w,C,null);vf(k,w)}return null}function p(k,T,w,C,M){if(typeof C=="string"&&C!==""||typeof C=="number")return k=k.get(w)||null,o(T,k,""+C,M);if(typeof C=="object"&&C!==null){switch(C.$$typeof){case of:return k=k.get(C.key===null?w:C.key)||null,l(T,k,C,M);case Ao:return k=k.get(C.key===null?w:C.key)||null,c(T,k,C,M);case Da:var O=C._init;return p(k,T,w,O(C._payload),M)}if(Ql(C)||jl(C))return k=k.get(w)||null,u(T,k,C,M,null);vf(T,C)}return null}function x(k,T,w,C){for(var M=null,O=null,v=T,E=T=0,S=null;v!==null&&E<w.length;E++){v.index>E?(S=v,v=null):S=v.sibling;var R=m(k,v,w[E],C);if(R===null){v===null&&(v=S);break}e&&v&&R.alternate===null&&t(k,v),T=a(R,T,E),O===null?M=R:O.sibling=R,O=R,v=S}if(E===w.length)return r(k,v),Pt&&Ei(k,E),M;if(v===null){for(;E<w.length;E++)v=d(k,w[E],C),v!==null&&(T=a(v,T,E),O===null?M=v:O.sibling=v,O=v);return Pt&&Ei(k,E),M}for(v=n(k,v);E<w.length;E++)S=p(v,k,E,w[E],C),S!==null&&(e&&S.alternate!==null&&v.delete(S.key===null?E:S.key),T=a(S,T,E),O===null?M=S:O.sibling=S,O=S);return e&&v.forEach(function(P){return t(k,P)}),Pt&&Ei(k,E),M}function g(k,T,w,C){var M=jl(w);if(typeof M!="function")throw Error(we(150));if(w=M.call(w),w==null)throw Error(we(151));for(var O=M=null,v=T,E=T=0,S=null,R=w.next();v!==null&&!R.done;E++,R=w.next()){v.index>E?(S=v,v=null):S=v.sibling;var P=m(k,v,R.value,C);if(P===null){v===null&&(v=S);break}e&&v&&P.alternate===null&&t(k,v),T=a(P,T,E),O===null?M=P:O.sibling=P,O=P,v=S}if(R.done)return r(k,v),Pt&&Ei(k,E),M;if(v===null){for(;!R.done;E++,R=w.next())R=d(k,R.value,C),R!==null&&(T=a(R,T,E),O===null?M=R:O.sibling=R,O=R);return Pt&&Ei(k,E),M}for(v=n(k,v);!R.done;E++,R=w.next())R=p(v,k,E,R.value,C),R!==null&&(e&&R.alternate!==null&&v.delete(R.key===null?E:R.key),T=a(R,T,E),O===null?M=R:O.sibling=R,O=R);return e&&v.forEach(function(D){return t(k,D)}),Pt&&Ei(k,E),M}function _(k,T,w,C){if(typeof w=="object"&&w!==null&&w.type===Io&&w.key===null&&(w=w.props.children),typeof w=="object"&&w!==null){switch(w.$$typeof){case of:e:{for(var M=w.key,O=T;O!==null;){if(O.key===M){if(M=w.type,M===Io){if(O.tag===7){r(k,O.sibling),T=s(O,w.props.children),T.return=k,k=T;break e}}else if(O.elementType===M||typeof M=="object"&&M!==null&&M.$$typeof===Da&&P1(M)===O.type){r(k,O.sibling),T=s(O,w.props),T.ref=$l(k,O,w),T.return=k,k=T;break e}r(k,O);break}else t(k,O);O=O.sibling}w.type===Io?(T=Mi(w.props.children,k.mode,C,w.key),T.return=k,k=T):(C=Yf(w.type,w.key,w.props,null,k.mode,C),C.ref=$l(k,T,w),C.return=k,k=C)}return i(k);case Ao:e:{for(O=w.key;T!==null;){if(T.key===O)if(T.tag===4&&T.stateNode.containerInfo===w.containerInfo&&T.stateNode.implementation===w.implementation){r(k,T.sibling),T=s(T,w.children||[]),T.return=k,k=T;break e}else{r(k,T);break}else t(k,T);T=T.sibling}T=L0(w,k.mode,C),T.return=k,k=T}return i(k);case Da:return O=w._init,_(k,T,O(w._payload),C)}if(Ql(w))return x(k,T,w,C);if(jl(w))return g(k,T,w,C);vf(k,w)}return typeof w=="string"&&w!==""||typeof w=="number"?(w=""+w,T!==null&&T.tag===6?(r(k,T.sibling),T=s(T,w),T.return=k,k=T):(r(k,T),T=M0(w,k.mode,C),T.return=k,k=T),i(k)):r(k,T)}return _}var rl=m2(!0),p2=m2(!1),wh=pi(null),Eh=null,Oo=null,gg=null;function xg(){gg=Oo=Eh=null}function vg(e){var t=wh.current;Nt(wh),e._currentValue=t}function Um(e,t,r){for(;e!==null;){var n=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,n!==null&&(n.childLanes|=t)):n!==null&&(n.childLanes&t)!==t&&(n.childLanes|=t),e===r)break;e=e.return}}function $o(e,t){Eh=e,gg=Oo=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(fn=!0),e.firstContext=null)}function Wn(e){var t=e._currentValue;if(gg!==e)if(e={context:e,memoizedValue:t,next:null},Oo===null){if(Eh===null)throw Error(we(308));Oo=e,Eh.dependencies={lanes:0,firstContext:e}}else Oo=Oo.next=e;return t}var Ni=null;function yg(e){Ni===null?Ni=[e]:Ni.push(e)}function g2(e,t,r,n){var s=t.interleaved;return s===null?(r.next=r,yg(t)):(r.next=s.next,s.next=r),t.interleaved=r,ha(e,n)}function ha(e,t){e.lanes|=t;var r=e.alternate;for(r!==null&&(r.lanes|=t),r=e,e=e.return;e!==null;)e.childLanes|=t,r=e.alternate,r!==null&&(r.childLanes|=t),r=e,e=e.return;return r.tag===3?r.stateNode:null}var Fa=!1;function _g(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function x2(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function aa(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function Qa(e,t,r){var n=e.updateQueue;if(n===null)return null;if(n=n.shared,ot&2){var s=n.pending;return s===null?t.next=t:(t.next=s.next,s.next=t),n.pending=t,ha(e,r)}return s=n.interleaved,s===null?(t.next=t,yg(n)):(t.next=s.next,s.next=t),n.interleaved=t,ha(e,r)}function Wf(e,t,r){if(t=t.updateQueue,t!==null&&(t=t.shared,(r&4194240)!==0)){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,ag(e,r)}}function D1(e,t){var r=e.updateQueue,n=e.alternate;if(n!==null&&(n=n.updateQueue,r===n)){var s=null,a=null;if(r=r.firstBaseUpdate,r!==null){do{var i={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};a===null?s=a=i:a=a.next=i,r=r.next}while(r!==null);a===null?s=a=t:a=a.next=t}else s=a=t;r={baseState:n.baseState,firstBaseUpdate:s,lastBaseUpdate:a,shared:n.shared,effects:n.effects},e.updateQueue=r;return}e=r.lastBaseUpdate,e===null?r.firstBaseUpdate=t:e.next=t,r.lastBaseUpdate=t}function Th(e,t,r,n){var s=e.updateQueue;Fa=!1;var a=s.firstBaseUpdate,i=s.lastBaseUpdate,o=s.shared.pending;if(o!==null){s.shared.pending=null;var l=o,c=l.next;l.next=null,i===null?a=c:i.next=c,i=l;var u=e.alternate;u!==null&&(u=u.updateQueue,o=u.lastBaseUpdate,o!==i&&(o===null?u.firstBaseUpdate=c:o.next=c,u.lastBaseUpdate=l))}if(a!==null){var d=s.baseState;i=0,u=c=l=null,o=a;do{var m=o.lane,p=o.eventTime;if((n&m)===m){u!==null&&(u=u.next={eventTime:p,lane:0,tag:o.tag,payload:o.payload,callback:o.callback,next:null});e:{var x=e,g=o;switch(m=t,p=r,g.tag){case 1:if(x=g.payload,typeof x=="function"){d=x.call(p,d,m);break e}d=x;break e;case 3:x.flags=x.flags&-65537|128;case 0:if(x=g.payload,m=typeof x=="function"?x.call(p,d,m):x,m==null)break e;d=Mt({},d,m);break e;case 2:Fa=!0}}o.callback!==null&&o.lane!==0&&(e.flags|=64,m=s.effects,m===null?s.effects=[o]:m.push(o))}else p={eventTime:p,lane:m,tag:o.tag,payload:o.payload,callback:o.callback,next:null},u===null?(c=u=p,l=d):u=u.next=p,i|=m;if(o=o.next,o===null){if(o=s.shared.pending,o===null)break;m=o,o=m.next,m.next=null,s.lastBaseUpdate=m,s.shared.pending=null}}while(!0);if(u===null&&(l=d),s.baseState=l,s.firstBaseUpdate=c,s.lastBaseUpdate=u,t=s.shared.interleaved,t!==null){s=t;do i|=s.lane,s=s.next;while(s!==t)}else a===null&&(s.shared.lanes=0);Wi|=i,e.lanes=i,e.memoizedState=d}}function F1(e,t,r){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var n=e[t],s=n.callback;if(s!==null){if(n.callback=null,n=r,typeof s!="function")throw Error(we(191,s));s.call(n)}}}var Eu={},Ss=pi(Eu),Wc=pi(Eu),Hc=pi(Eu);function Ri(e){if(e===Eu)throw Error(we(174));return e}function wg(e,t){switch(Et(Hc,t),Et(Wc,e),Et(Ss,Eu),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:ym(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=ym(t,e)}Nt(Ss),Et(Ss,t)}function nl(){Nt(Ss),Nt(Wc),Nt(Hc)}function v2(e){Ri(Hc.current);var t=Ri(Ss.current),r=ym(t,e.type);t!==r&&(Et(Wc,e),Et(Ss,r))}function Eg(e){Wc.current===e&&(Nt(Ss),Nt(Wc))}var Ft=pi(0);function kh(e){for(var t=e;t!==null;){if(t.tag===13){var r=t.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||r.data==="$?"||r.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var R0=[];function Tg(){for(var e=0;e<R0.length;e++)R0[e]._workInProgressVersionPrimary=null;R0.length=0}var Hf=Ea.ReactCurrentDispatcher,b0=Ea.ReactCurrentBatchConfig,$i=0,Ot=null,sr=null,mr=null,Sh=!1,mc=!1,Gc=0,XN=0;function Pr(){throw Error(we(321))}function kg(e,t){if(t===null)return!1;for(var r=0;r<t.length&&r<e.length;r++)if(!hs(e[r],t[r]))return!1;return!0}function Sg(e,t,r,n,s,a){if($i=a,Ot=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,Hf.current=e===null||e.memoizedState===null?ZN:e4,e=r(n,s),mc){a=0;do{if(mc=!1,Gc=0,25<=a)throw Error(we(301));a+=1,mr=sr=null,t.updateQueue=null,Hf.current=t4,e=r(n,s)}while(mc)}if(Hf.current=Ah,t=sr!==null&&sr.next!==null,$i=0,mr=sr=Ot=null,Sh=!1,t)throw Error(we(300));return e}function Ag(){var e=Gc!==0;return Gc=0,e}function _s(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return mr===null?Ot.memoizedState=mr=e:mr=mr.next=e,mr}function Hn(){if(sr===null){var e=Ot.alternate;e=e!==null?e.memoizedState:null}else e=sr.next;var t=mr===null?Ot.memoizedState:mr.next;if(t!==null)mr=t,sr=e;else{if(e===null)throw Error(we(310));sr=e,e={memoizedState:sr.memoizedState,baseState:sr.baseState,baseQueue:sr.baseQueue,queue:sr.queue,next:null},mr===null?Ot.memoizedState=mr=e:mr=mr.next=e}return mr}function Kc(e,t){return typeof t=="function"?t(e):t}function P0(e){var t=Hn(),r=t.queue;if(r===null)throw Error(we(311));r.lastRenderedReducer=e;var n=sr,s=n.baseQueue,a=r.pending;if(a!==null){if(s!==null){var i=s.next;s.next=a.next,a.next=i}n.baseQueue=s=a,r.pending=null}if(s!==null){a=s.next,n=n.baseState;var o=i=null,l=null,c=a;do{var u=c.lane;if(($i&u)===u)l!==null&&(l=l.next={lane:0,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null}),n=c.hasEagerState?c.eagerState:e(n,c.action);else{var d={lane:u,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null};l===null?(o=l=d,i=n):l=l.next=d,Ot.lanes|=u,Wi|=u}c=c.next}while(c!==null&&c!==a);l===null?i=n:l.next=o,hs(n,t.memoizedState)||(fn=!0),t.memoizedState=n,t.baseState=i,t.baseQueue=l,r.lastRenderedState=n}if(e=r.interleaved,e!==null){s=e;do a=s.lane,Ot.lanes|=a,Wi|=a,s=s.next;while(s!==e)}else s===null&&(r.lanes=0);return[t.memoizedState,r.dispatch]}function D0(e){var t=Hn(),r=t.queue;if(r===null)throw Error(we(311));r.lastRenderedReducer=e;var n=r.dispatch,s=r.pending,a=t.memoizedState;if(s!==null){r.pending=null;var i=s=s.next;do a=e(a,i.action),i=i.next;while(i!==s);hs(a,t.memoizedState)||(fn=!0),t.memoizedState=a,t.baseQueue===null&&(t.baseState=a),r.lastRenderedState=a}return[a,n]}function y2(){}function _2(e,t){var r=Ot,n=Hn(),s=t(),a=!hs(n.memoizedState,s);if(a&&(n.memoizedState=s,fn=!0),n=n.queue,Ig(T2.bind(null,r,n,e),[e]),n.getSnapshot!==t||a||mr!==null&&mr.memoizedState.tag&1){if(r.flags|=2048,qc(9,E2.bind(null,r,n,s,t),void 0,null),pr===null)throw Error(we(349));$i&30||w2(r,t,s)}return s}function w2(e,t,r){e.flags|=16384,e={getSnapshot:t,value:r},t=Ot.updateQueue,t===null?(t={lastEffect:null,stores:null},Ot.updateQueue=t,t.stores=[e]):(r=t.stores,r===null?t.stores=[e]:r.push(e))}function E2(e,t,r,n){t.value=r,t.getSnapshot=n,k2(t)&&S2(e)}function T2(e,t,r){return r(function(){k2(t)&&S2(e)})}function k2(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!hs(e,r)}catch{return!0}}function S2(e){var t=ha(e,1);t!==null&&cs(t,e,1,-1)}function O1(e){var t=_s();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Kc,lastRenderedState:e},t.queue=e,e=e.dispatch=JN.bind(null,Ot,e),[t.memoizedState,e]}function qc(e,t,r,n){return e={tag:e,create:t,destroy:r,deps:n,next:null},t=Ot.updateQueue,t===null?(t={lastEffect:null,stores:null},Ot.updateQueue=t,t.lastEffect=e.next=e):(r=t.lastEffect,r===null?t.lastEffect=e.next=e:(n=r.next,r.next=e,e.next=n,t.lastEffect=e)),e}function A2(){return Hn().memoizedState}function Gf(e,t,r,n){var s=_s();Ot.flags|=e,s.memoizedState=qc(1|t,r,void 0,n===void 0?null:n)}function yd(e,t,r,n){var s=Hn();n=n===void 0?null:n;var a=void 0;if(sr!==null){var i=sr.memoizedState;if(a=i.destroy,n!==null&&kg(n,i.deps)){s.memoizedState=qc(t,r,a,n);return}}Ot.flags|=e,s.memoizedState=qc(1|t,r,a,n)}function M1(e,t){return Gf(8390656,8,e,t)}function Ig(e,t){return yd(2048,8,e,t)}function I2(e,t){return yd(4,2,e,t)}function C2(e,t){return yd(4,4,e,t)}function N2(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function R2(e,t,r){return r=r!=null?r.concat([e]):null,yd(4,4,N2.bind(null,t,e),r)}function Cg(){}function b2(e,t){var r=Hn();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&kg(t,n[1])?n[0]:(r.memoizedState=[e,t],e)}function P2(e,t){var r=Hn();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&kg(t,n[1])?n[0]:(e=e(),r.memoizedState=[e,t],e)}function D2(e,t,r){return $i&21?(hs(r,t)||(r=jE(),Ot.lanes|=r,Wi|=r,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,fn=!0),e.memoizedState=r)}function YN(e,t){var r=gt;gt=r!==0&&4>r?r:4,e(!0);var n=b0.transition;b0.transition={};try{e(!1),t()}finally{gt=r,b0.transition=n}}function F2(){return Hn().memoizedState}function QN(e,t,r){var n=Za(e);if(r={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null},O2(e))M2(t,r);else if(r=g2(e,t,r,n),r!==null){var s=Jr();cs(r,e,n,s),L2(r,t,n)}}function JN(e,t,r){var n=Za(e),s={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null};if(O2(e))M2(t,s);else{var a=e.alternate;if(e.lanes===0&&(a===null||a.lanes===0)&&(a=t.lastRenderedReducer,a!==null))try{var i=t.lastRenderedState,o=a(i,r);if(s.hasEagerState=!0,s.eagerState=o,hs(o,i)){var l=t.interleaved;l===null?(s.next=s,yg(t)):(s.next=l.next,l.next=s),t.interleaved=s;return}}catch{}finally{}r=g2(e,t,s,n),r!==null&&(s=Jr(),cs(r,e,n,s),L2(r,t,n))}}function O2(e){var t=e.alternate;return e===Ot||t!==null&&t===Ot}function M2(e,t){mc=Sh=!0;var r=e.pending;r===null?t.next=t:(t.next=r.next,r.next=t),e.pending=t}function L2(e,t,r){if(r&4194240){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,ag(e,r)}}var Ah={readContext:Wn,useCallback:Pr,useContext:Pr,useEffect:Pr,useImperativeHandle:Pr,useInsertionEffect:Pr,useLayoutEffect:Pr,useMemo:Pr,useReducer:Pr,useRef:Pr,useState:Pr,useDebugValue:Pr,useDeferredValue:Pr,useTransition:Pr,useMutableSource:Pr,useSyncExternalStore:Pr,useId:Pr,unstable_isNewReconciler:!1},ZN={readContext:Wn,useCallback:function(e,t){return _s().memoizedState=[e,t===void 0?null:t],e},useContext:Wn,useEffect:M1,useImperativeHandle:function(e,t,r){return r=r!=null?r.concat([e]):null,Gf(4194308,4,N2.bind(null,t,e),r)},useLayoutEffect:function(e,t){return Gf(4194308,4,e,t)},useInsertionEffect:function(e,t){return Gf(4,2,e,t)},useMemo:function(e,t){var r=_s();return t=t===void 0?null:t,e=e(),r.memoizedState=[e,t],e},useReducer:function(e,t,r){var n=_s();return t=r!==void 0?r(t):t,n.memoizedState=n.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},n.queue=e,e=e.dispatch=QN.bind(null,Ot,e),[n.memoizedState,e]},useRef:function(e){var t=_s();return e={current:e},t.memoizedState=e},useState:O1,useDebugValue:Cg,useDeferredValue:function(e){return _s().memoizedState=e},useTransition:function(){var e=O1(!1),t=e[0];return e=YN.bind(null,e[1]),_s().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,r){var n=Ot,s=_s();if(Pt){if(r===void 0)throw Error(we(407));r=r()}else{if(r=t(),pr===null)throw Error(we(349));$i&30||w2(n,t,r)}s.memoizedState=r;var a={value:r,getSnapshot:t};return s.queue=a,M1(T2.bind(null,n,a,e),[e]),n.flags|=2048,qc(9,E2.bind(null,n,a,r,t),void 0,null),r},useId:function(){var e=_s(),t=pr.identifierPrefix;if(Pt){var r=Zs,n=Js;r=(n&~(1<<32-ls(n)-1)).toString(32)+r,t=":"+t+"R"+r,r=Gc++,0<r&&(t+="H"+r.toString(32)),t+=":"}else r=XN++,t=":"+t+"r"+r.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},e4={readContext:Wn,useCallback:b2,useContext:Wn,useEffect:Ig,useImperativeHandle:R2,useInsertionEffect:I2,useLayoutEffect:C2,useMemo:P2,useReducer:P0,useRef:A2,useState:function(){return P0(Kc)},useDebugValue:Cg,useDeferredValue:function(e){var t=Hn();return D2(t,sr.memoizedState,e)},useTransition:function(){var e=P0(Kc)[0],t=Hn().memoizedState;return[e,t]},useMutableSource:y2,useSyncExternalStore:_2,useId:F2,unstable_isNewReconciler:!1},t4={readContext:Wn,useCallback:b2,useContext:Wn,useEffect:Ig,useImperativeHandle:R2,useInsertionEffect:I2,useLayoutEffect:C2,useMemo:P2,useReducer:D0,useRef:A2,useState:function(){return D0(Kc)},useDebugValue:Cg,useDeferredValue:function(e){var t=Hn();return sr===null?t.memoizedState=e:D2(t,sr.memoizedState,e)},useTransition:function(){var e=D0(Kc)[0],t=Hn().memoizedState;return[e,t]},useMutableSource:y2,useSyncExternalStore:_2,useId:F2,unstable_isNewReconciler:!1};function Zn(e,t){if(e&&e.defaultProps){t=Mt({},t),e=e.defaultProps;for(var r in e)t[r]===void 0&&(t[r]=e[r]);return t}return t}function Vm(e,t,r,n){t=e.memoizedState,r=r(n,t),r=r==null?t:Mt({},t,r),e.memoizedState=r,e.lanes===0&&(e.updateQueue.baseState=r)}var _d={isMounted:function(e){return(e=e._reactInternals)?to(e)===e:!1},enqueueSetState:function(e,t,r){e=e._reactInternals;var n=Jr(),s=Za(e),a=aa(n,s);a.payload=t,r!=null&&(a.callback=r),t=Qa(e,a,s),t!==null&&(cs(t,e,s,n),Wf(t,e,s))},enqueueReplaceState:function(e,t,r){e=e._reactInternals;var n=Jr(),s=Za(e),a=aa(n,s);a.tag=1,a.payload=t,r!=null&&(a.callback=r),t=Qa(e,a,s),t!==null&&(cs(t,e,s,n),Wf(t,e,s))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var r=Jr(),n=Za(e),s=aa(r,n);s.tag=2,t!=null&&(s.callback=t),t=Qa(e,s,n),t!==null&&(cs(t,e,n,r),Wf(t,e,n))}};function L1(e,t,r,n,s,a,i){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(n,a,i):t.prototype&&t.prototype.isPureReactComponent?!Vc(r,n)||!Vc(s,a):!0}function j2(e,t,r){var n=!1,s=ii,a=t.contextType;return typeof a=="object"&&a!==null?a=Wn(a):(s=dn(t)?Bi:Wr.current,n=t.contextTypes,a=(n=n!=null)?el(e,s):ii),t=new t(r,a),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=_d,e.stateNode=t,t._reactInternals=e,n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=s,e.__reactInternalMemoizedMaskedChildContext=a),t}function j1(e,t,r,n){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(r,n),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(r,n),t.state!==e&&_d.enqueueReplaceState(t,t.state,null)}function Bm(e,t,r,n){var s=e.stateNode;s.props=r,s.state=e.memoizedState,s.refs={},_g(e);var a=t.contextType;typeof a=="object"&&a!==null?s.context=Wn(a):(a=dn(t)?Bi:Wr.current,s.context=el(e,a)),s.state=e.memoizedState,a=t.getDerivedStateFromProps,typeof a=="function"&&(Vm(e,t,a,r),s.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof s.getSnapshotBeforeUpdate=="function"||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(t=s.state,typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount(),t!==s.state&&_d.enqueueReplaceState(s,s.state,null),Th(e,r,s,n),s.state=e.memoizedState),typeof s.componentDidMount=="function"&&(e.flags|=4194308)}function sl(e,t){try{var r="",n=t;do r+=NC(n),n=n.return;while(n);var s=r}catch(a){s=`
Error generating stack: `+a.message+`
`+a.stack}return{value:e,source:t,stack:s,digest:null}}function F0(e,t,r){return{value:e,source:null,stack:r??null,digest:t??null}}function zm(e,t){try{console.error(t.value)}catch(r){setTimeout(function(){throw r})}}var r4=typeof WeakMap=="function"?WeakMap:Map;function U2(e,t,r){r=aa(-1,r),r.tag=3,r.payload={element:null};var n=t.value;return r.callback=function(){Ch||(Ch=!0,Jm=n),zm(e,t)},r}function V2(e,t,r){r=aa(-1,r),r.tag=3;var n=e.type.getDerivedStateFromError;if(typeof n=="function"){var s=t.value;r.payload=function(){return n(s)},r.callback=function(){zm(e,t)}}var a=e.stateNode;return a!==null&&typeof a.componentDidCatch=="function"&&(r.callback=function(){zm(e,t),typeof n!="function"&&(Ja===null?Ja=new Set([this]):Ja.add(this));var i=t.stack;this.componentDidCatch(t.value,{componentStack:i!==null?i:""})}),r}function U1(e,t,r){var n=e.pingCache;if(n===null){n=e.pingCache=new r4;var s=new Set;n.set(t,s)}else s=n.get(t),s===void 0&&(s=new Set,n.set(t,s));s.has(r)||(s.add(r),e=g4.bind(null,e,t,r),t.then(e,e))}function V1(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function B1(e,t,r,n,s){return e.mode&1?(e.flags|=65536,e.lanes=s,e):(e===t?e.flags|=65536:(e.flags|=128,r.flags|=131072,r.flags&=-52805,r.tag===1&&(r.alternate===null?r.tag=17:(t=aa(-1,1),t.tag=2,Qa(r,t,1))),r.lanes|=1),e)}var n4=Ea.ReactCurrentOwner,fn=!1;function qr(e,t,r,n){t.child=e===null?p2(t,null,r,n):rl(t,e.child,r,n)}function z1(e,t,r,n,s){r=r.render;var a=t.ref;return $o(t,s),n=Sg(e,t,r,n,a,s),r=Ag(),e!==null&&!fn?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~s,da(e,t,s)):(Pt&&r&&dg(t),t.flags|=1,qr(e,t,n,s),t.child)}function $1(e,t,r,n,s){if(e===null){var a=r.type;return typeof a=="function"&&!Mg(a)&&a.defaultProps===void 0&&r.compare===null&&r.defaultProps===void 0?(t.tag=15,t.type=a,B2(e,t,a,n,s)):(e=Yf(r.type,null,n,t,t.mode,s),e.ref=t.ref,e.return=t,t.child=e)}if(a=e.child,!(e.lanes&s)){var i=a.memoizedProps;if(r=r.compare,r=r!==null?r:Vc,r(i,n)&&e.ref===t.ref)return da(e,t,s)}return t.flags|=1,e=ei(a,n),e.ref=t.ref,e.return=t,t.child=e}function B2(e,t,r,n,s){if(e!==null){var a=e.memoizedProps;if(Vc(a,n)&&e.ref===t.ref)if(fn=!1,t.pendingProps=n=a,(e.lanes&s)!==0)e.flags&131072&&(fn=!0);else return t.lanes=e.lanes,da(e,t,s)}return $m(e,t,r,n,s)}function z2(e,t,r){var n=t.pendingProps,s=n.children,a=e!==null?e.memoizedState:null;if(n.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},Et(Lo,vn),vn|=r;else{if(!(r&1073741824))return e=a!==null?a.baseLanes|r:r,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,Et(Lo,vn),vn|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=a!==null?a.baseLanes:r,Et(Lo,vn),vn|=n}else a!==null?(n=a.baseLanes|r,t.memoizedState=null):n=r,Et(Lo,vn),vn|=n;return qr(e,t,s,r),t.child}function $2(e,t){var r=t.ref;(e===null&&r!==null||e!==null&&e.ref!==r)&&(t.flags|=512,t.flags|=2097152)}function $m(e,t,r,n,s){var a=dn(r)?Bi:Wr.current;return a=el(t,a),$o(t,s),r=Sg(e,t,r,n,a,s),n=Ag(),e!==null&&!fn?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~s,da(e,t,s)):(Pt&&n&&dg(t),t.flags|=1,qr(e,t,r,s),t.child)}function W1(e,t,r,n,s){if(dn(r)){var a=!0;vh(t)}else a=!1;if($o(t,s),t.stateNode===null)Kf(e,t),j2(t,r,n),Bm(t,r,n,s),n=!0;else if(e===null){var i=t.stateNode,o=t.memoizedProps;i.props=o;var l=i.context,c=r.contextType;typeof c=="object"&&c!==null?c=Wn(c):(c=dn(r)?Bi:Wr.current,c=el(t,c));var u=r.getDerivedStateFromProps,d=typeof u=="function"||typeof i.getSnapshotBeforeUpdate=="function";d||typeof i.UNSAFE_componentWillReceiveProps!="function"&&typeof i.componentWillReceiveProps!="function"||(o!==n||l!==c)&&j1(t,i,n,c),Fa=!1;var m=t.memoizedState;i.state=m,Th(t,n,i,s),l=t.memoizedState,o!==n||m!==l||hn.current||Fa?(typeof u=="function"&&(Vm(t,r,u,n),l=t.memoizedState),(o=Fa||L1(t,r,o,n,m,l,c))?(d||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount()),typeof i.componentDidMount=="function"&&(t.flags|=4194308)):(typeof i.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=n,t.memoizedState=l),i.props=n,i.state=l,i.context=c,n=o):(typeof i.componentDidMount=="function"&&(t.flags|=4194308),n=!1)}else{i=t.stateNode,x2(e,t),o=t.memoizedProps,c=t.type===t.elementType?o:Zn(t.type,o),i.props=c,d=t.pendingProps,m=i.context,l=r.contextType,typeof l=="object"&&l!==null?l=Wn(l):(l=dn(r)?Bi:Wr.current,l=el(t,l));var p=r.getDerivedStateFromProps;(u=typeof p=="function"||typeof i.getSnapshotBeforeUpdate=="function")||typeof i.UNSAFE_componentWillReceiveProps!="function"&&typeof i.componentWillReceiveProps!="function"||(o!==d||m!==l)&&j1(t,i,n,l),Fa=!1,m=t.memoizedState,i.state=m,Th(t,n,i,s);var x=t.memoizedState;o!==d||m!==x||hn.current||Fa?(typeof p=="function"&&(Vm(t,r,p,n),x=t.memoizedState),(c=Fa||L1(t,r,c,n,m,x,l)||!1)?(u||typeof i.UNSAFE_componentWillUpdate!="function"&&typeof i.componentWillUpdate!="function"||(typeof i.componentWillUpdate=="function"&&i.componentWillUpdate(n,x,l),typeof i.UNSAFE_componentWillUpdate=="function"&&i.UNSAFE_componentWillUpdate(n,x,l)),typeof i.componentDidUpdate=="function"&&(t.flags|=4),typeof i.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof i.componentDidUpdate!="function"||o===e.memoizedProps&&m===e.memoizedState||(t.flags|=4),typeof i.getSnapshotBeforeUpdate!="function"||o===e.memoizedProps&&m===e.memoizedState||(t.flags|=1024),t.memoizedProps=n,t.memoizedState=x),i.props=n,i.state=x,i.context=l,n=c):(typeof i.componentDidUpdate!="function"||o===e.memoizedProps&&m===e.memoizedState||(t.flags|=4),typeof i.getSnapshotBeforeUpdate!="function"||o===e.memoizedProps&&m===e.memoizedState||(t.flags|=1024),n=!1)}return Wm(e,t,r,n,a,s)}function Wm(e,t,r,n,s,a){$2(e,t);var i=(t.flags&128)!==0;if(!n&&!i)return s&&N1(t,r,!1),da(e,t,a);n=t.stateNode,n4.current=t;var o=i&&typeof r.getDerivedStateFromError!="function"?null:n.render();return t.flags|=1,e!==null&&i?(t.child=rl(t,e.child,null,a),t.child=rl(t,null,o,a)):qr(e,t,o,a),t.memoizedState=n.state,s&&N1(t,r,!0),t.child}function W2(e){var t=e.stateNode;t.pendingContext?C1(e,t.pendingContext,t.pendingContext!==t.context):t.context&&C1(e,t.context,!1),wg(e,t.containerInfo)}function H1(e,t,r,n,s){return tl(),pg(s),t.flags|=256,qr(e,t,r,n),t.child}var Hm={dehydrated:null,treeContext:null,retryLane:0};function Gm(e){return{baseLanes:e,cachePool:null,transitions:null}}function H2(e,t,r){var n=t.pendingProps,s=Ft.current,a=!1,i=(t.flags&128)!==0,o;if((o=i)||(o=e!==null&&e.memoizedState===null?!1:(s&2)!==0),o?(a=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(s|=1),Et(Ft,s&1),e===null)return jm(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(i=n.children,e=n.fallback,a?(n=t.mode,a=t.child,i={mode:"hidden",children:i},!(n&1)&&a!==null?(a.childLanes=0,a.pendingProps=i):a=Td(i,n,0,null),e=Mi(e,n,r,null),a.return=t,e.return=t,a.sibling=e,t.child=a,t.child.memoizedState=Gm(r),t.memoizedState=Hm,e):Ng(t,i));if(s=e.memoizedState,s!==null&&(o=s.dehydrated,o!==null))return s4(e,t,i,n,o,s,r);if(a){a=n.fallback,i=t.mode,s=e.child,o=s.sibling;var l={mode:"hidden",children:n.children};return!(i&1)&&t.child!==s?(n=t.child,n.childLanes=0,n.pendingProps=l,t.deletions=null):(n=ei(s,l),n.subtreeFlags=s.subtreeFlags&14680064),o!==null?a=ei(o,a):(a=Mi(a,i,r,null),a.flags|=2),a.return=t,n.return=t,n.sibling=a,t.child=n,n=a,a=t.child,i=e.child.memoizedState,i=i===null?Gm(r):{baseLanes:i.baseLanes|r,cachePool:null,transitions:i.transitions},a.memoizedState=i,a.childLanes=e.childLanes&~r,t.memoizedState=Hm,n}return a=e.child,e=a.sibling,n=ei(a,{mode:"visible",children:n.children}),!(t.mode&1)&&(n.lanes=r),n.return=t,n.sibling=null,e!==null&&(r=t.deletions,r===null?(t.deletions=[e],t.flags|=16):r.push(e)),t.child=n,t.memoizedState=null,n}function Ng(e,t){return t=Td({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function yf(e,t,r,n){return n!==null&&pg(n),rl(t,e.child,null,r),e=Ng(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function s4(e,t,r,n,s,a,i){if(r)return t.flags&256?(t.flags&=-257,n=F0(Error(we(422))),yf(e,t,i,n)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(a=n.fallback,s=t.mode,n=Td({mode:"visible",children:n.children},s,0,null),a=Mi(a,s,i,null),a.flags|=2,n.return=t,a.return=t,n.sibling=a,t.child=n,t.mode&1&&rl(t,e.child,null,i),t.child.memoizedState=Gm(i),t.memoizedState=Hm,a);if(!(t.mode&1))return yf(e,t,i,null);if(s.data==="$!"){if(n=s.nextSibling&&s.nextSibling.dataset,n)var o=n.dgst;return n=o,a=Error(we(419)),n=F0(a,n,void 0),yf(e,t,i,n)}if(o=(i&e.childLanes)!==0,fn||o){if(n=pr,n!==null){switch(i&-i){case 4:s=2;break;case 16:s=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:s=32;break;case 536870912:s=268435456;break;default:s=0}s=s&(n.suspendedLanes|i)?0:s,s!==0&&s!==a.retryLane&&(a.retryLane=s,ha(e,s),cs(n,e,s,-1))}return Og(),n=F0(Error(we(421))),yf(e,t,i,n)}return s.data==="$?"?(t.flags|=128,t.child=e.child,t=x4.bind(null,e),s._reactRetry=t,null):(e=a.treeContext,En=Ya(s.nextSibling),kn=t,Pt=!0,rs=null,e!==null&&(Mn[Ln++]=Js,Mn[Ln++]=Zs,Mn[Ln++]=zi,Js=e.id,Zs=e.overflow,zi=t),t=Ng(t,n.children),t.flags|=4096,t)}function G1(e,t,r){e.lanes|=t;var n=e.alternate;n!==null&&(n.lanes|=t),Um(e.return,t,r)}function O0(e,t,r,n,s){var a=e.memoizedState;a===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:n,tail:r,tailMode:s}:(a.isBackwards=t,a.rendering=null,a.renderingStartTime=0,a.last=n,a.tail=r,a.tailMode=s)}function G2(e,t,r){var n=t.pendingProps,s=n.revealOrder,a=n.tail;if(qr(e,t,n.children,r),n=Ft.current,n&2)n=n&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&G1(e,r,t);else if(e.tag===19)G1(e,r,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}n&=1}if(Et(Ft,n),!(t.mode&1))t.memoizedState=null;else switch(s){case"forwards":for(r=t.child,s=null;r!==null;)e=r.alternate,e!==null&&kh(e)===null&&(s=r),r=r.sibling;r=s,r===null?(s=t.child,t.child=null):(s=r.sibling,r.sibling=null),O0(t,!1,s,r,a);break;case"backwards":for(r=null,s=t.child,t.child=null;s!==null;){if(e=s.alternate,e!==null&&kh(e)===null){t.child=s;break}e=s.sibling,s.sibling=r,r=s,s=e}O0(t,!0,r,null,a);break;case"together":O0(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function Kf(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function da(e,t,r){if(e!==null&&(t.dependencies=e.dependencies),Wi|=t.lanes,!(r&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(we(153));if(t.child!==null){for(e=t.child,r=ei(e,e.pendingProps),t.child=r,r.return=t;e.sibling!==null;)e=e.sibling,r=r.sibling=ei(e,e.pendingProps),r.return=t;r.sibling=null}return t.child}function a4(e,t,r){switch(t.tag){case 3:W2(t),tl();break;case 5:v2(t);break;case 1:dn(t.type)&&vh(t);break;case 4:wg(t,t.stateNode.containerInfo);break;case 10:var n=t.type._context,s=t.memoizedProps.value;Et(wh,n._currentValue),n._currentValue=s;break;case 13:if(n=t.memoizedState,n!==null)return n.dehydrated!==null?(Et(Ft,Ft.current&1),t.flags|=128,null):r&t.child.childLanes?H2(e,t,r):(Et(Ft,Ft.current&1),e=da(e,t,r),e!==null?e.sibling:null);Et(Ft,Ft.current&1);break;case 19:if(n=(r&t.childLanes)!==0,e.flags&128){if(n)return G2(e,t,r);t.flags|=128}if(s=t.memoizedState,s!==null&&(s.rendering=null,s.tail=null,s.lastEffect=null),Et(Ft,Ft.current),n)break;return null;case 22:case 23:return t.lanes=0,z2(e,t,r)}return da(e,t,r)}var K2,Km,q2,X2;K2=function(e,t){for(var r=t.child;r!==null;){if(r.tag===5||r.tag===6)e.appendChild(r.stateNode);else if(r.tag!==4&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===t)break;for(;r.sibling===null;){if(r.return===null||r.return===t)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};Km=function(){};q2=function(e,t,r,n){var s=e.memoizedProps;if(s!==n){e=t.stateNode,Ri(Ss.current);var a=null;switch(r){case"input":s=pm(e,s),n=pm(e,n),a=[];break;case"select":s=Mt({},s,{value:void 0}),n=Mt({},n,{value:void 0}),a=[];break;case"textarea":s=vm(e,s),n=vm(e,n),a=[];break;default:typeof s.onClick!="function"&&typeof n.onClick=="function"&&(e.onclick=gh)}_m(r,n);var i;r=null;for(c in s)if(!n.hasOwnProperty(c)&&s.hasOwnProperty(c)&&s[c]!=null)if(c==="style"){var o=s[c];for(i in o)o.hasOwnProperty(i)&&(r||(r={}),r[i]="")}else c!=="dangerouslySetInnerHTML"&&c!=="children"&&c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&c!=="autoFocus"&&(Dc.hasOwnProperty(c)?a||(a=[]):(a=a||[]).push(c,null));for(c in n){var l=n[c];if(o=s!=null?s[c]:void 0,n.hasOwnProperty(c)&&l!==o&&(l!=null||o!=null))if(c==="style")if(o){for(i in o)!o.hasOwnProperty(i)||l&&l.hasOwnProperty(i)||(r||(r={}),r[i]="");for(i in l)l.hasOwnProperty(i)&&o[i]!==l[i]&&(r||(r={}),r[i]=l[i])}else r||(a||(a=[]),a.push(c,r)),r=l;else c==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,o=o?o.__html:void 0,l!=null&&o!==l&&(a=a||[]).push(c,l)):c==="children"?typeof l!="string"&&typeof l!="number"||(a=a||[]).push(c,""+l):c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&(Dc.hasOwnProperty(c)?(l!=null&&c==="onScroll"&&It("scroll",e),a||o===l||(a=[])):(a=a||[]).push(c,l))}r&&(a=a||[]).push("style",r);var c=a;(t.updateQueue=c)&&(t.flags|=4)}};X2=function(e,t,r,n){r!==n&&(t.flags|=4)};function Wl(e,t){if(!Pt)switch(e.tailMode){case"hidden":t=e.tail;for(var r=null;t!==null;)t.alternate!==null&&(r=t),t=t.sibling;r===null?e.tail=null:r.sibling=null;break;case"collapsed":r=e.tail;for(var n=null;r!==null;)r.alternate!==null&&(n=r),r=r.sibling;n===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:n.sibling=null}}function Dr(e){var t=e.alternate!==null&&e.alternate.child===e.child,r=0,n=0;if(t)for(var s=e.child;s!==null;)r|=s.lanes|s.childLanes,n|=s.subtreeFlags&14680064,n|=s.flags&14680064,s.return=e,s=s.sibling;else for(s=e.child;s!==null;)r|=s.lanes|s.childLanes,n|=s.subtreeFlags,n|=s.flags,s.return=e,s=s.sibling;return e.subtreeFlags|=n,e.childLanes=r,t}function i4(e,t,r){var n=t.pendingProps;switch(mg(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Dr(t),null;case 1:return dn(t.type)&&xh(),Dr(t),null;case 3:return n=t.stateNode,nl(),Nt(hn),Nt(Wr),Tg(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(e===null||e.child===null)&&(xf(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,rs!==null&&(tp(rs),rs=null))),Km(e,t),Dr(t),null;case 5:Eg(t);var s=Ri(Hc.current);if(r=t.type,e!==null&&t.stateNode!=null)q2(e,t,r,n,s),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!n){if(t.stateNode===null)throw Error(we(166));return Dr(t),null}if(e=Ri(Ss.current),xf(t)){n=t.stateNode,r=t.type;var a=t.memoizedProps;switch(n[ws]=t,n[$c]=a,e=(t.mode&1)!==0,r){case"dialog":It("cancel",n),It("close",n);break;case"iframe":case"object":case"embed":It("load",n);break;case"video":case"audio":for(s=0;s<Zl.length;s++)It(Zl[s],n);break;case"source":It("error",n);break;case"img":case"image":case"link":It("error",n),It("load",n);break;case"details":It("toggle",n);break;case"input":t1(n,a),It("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!a.multiple},It("invalid",n);break;case"textarea":n1(n,a),It("invalid",n)}_m(r,a),s=null;for(var i in a)if(a.hasOwnProperty(i)){var o=a[i];i==="children"?typeof o=="string"?n.textContent!==o&&(a.suppressHydrationWarning!==!0&&gf(n.textContent,o,e),s=["children",o]):typeof o=="number"&&n.textContent!==""+o&&(a.suppressHydrationWarning!==!0&&gf(n.textContent,o,e),s=["children",""+o]):Dc.hasOwnProperty(i)&&o!=null&&i==="onScroll"&&It("scroll",n)}switch(r){case"input":lf(n),r1(n,a,!0);break;case"textarea":lf(n),s1(n);break;case"select":case"option":break;default:typeof a.onClick=="function"&&(n.onclick=gh)}n=s,t.updateQueue=n,n!==null&&(t.flags|=4)}else{i=s.nodeType===9?s:s.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=TE(r)),e==="http://www.w3.org/1999/xhtml"?r==="script"?(e=i.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof n.is=="string"?e=i.createElement(r,{is:n.is}):(e=i.createElement(r),r==="select"&&(i=e,n.multiple?i.multiple=!0:n.size&&(i.size=n.size))):e=i.createElementNS(e,r),e[ws]=t,e[$c]=n,K2(e,t,!1,!1),t.stateNode=e;e:{switch(i=wm(r,n),r){case"dialog":It("cancel",e),It("close",e),s=n;break;case"iframe":case"object":case"embed":It("load",e),s=n;break;case"video":case"audio":for(s=0;s<Zl.length;s++)It(Zl[s],e);s=n;break;case"source":It("error",e),s=n;break;case"img":case"image":case"link":It("error",e),It("load",e),s=n;break;case"details":It("toggle",e),s=n;break;case"input":t1(e,n),s=pm(e,n),It("invalid",e);break;case"option":s=n;break;case"select":e._wrapperState={wasMultiple:!!n.multiple},s=Mt({},n,{value:void 0}),It("invalid",e);break;case"textarea":n1(e,n),s=vm(e,n),It("invalid",e);break;default:s=n}_m(r,s),o=s;for(a in o)if(o.hasOwnProperty(a)){var l=o[a];a==="style"?AE(e,l):a==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&kE(e,l)):a==="children"?typeof l=="string"?(r!=="textarea"||l!=="")&&Fc(e,l):typeof l=="number"&&Fc(e,""+l):a!=="suppressContentEditableWarning"&&a!=="suppressHydrationWarning"&&a!=="autoFocus"&&(Dc.hasOwnProperty(a)?l!=null&&a==="onScroll"&&It("scroll",e):l!=null&&Zp(e,a,l,i))}switch(r){case"input":lf(e),r1(e,n,!1);break;case"textarea":lf(e),s1(e);break;case"option":n.value!=null&&e.setAttribute("value",""+ai(n.value));break;case"select":e.multiple=!!n.multiple,a=n.value,a!=null?Uo(e,!!n.multiple,a,!1):n.defaultValue!=null&&Uo(e,!!n.multiple,n.defaultValue,!0);break;default:typeof s.onClick=="function"&&(e.onclick=gh)}switch(r){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}}n&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return Dr(t),null;case 6:if(e&&t.stateNode!=null)X2(e,t,e.memoizedProps,n);else{if(typeof n!="string"&&t.stateNode===null)throw Error(we(166));if(r=Ri(Hc.current),Ri(Ss.current),xf(t)){if(n=t.stateNode,r=t.memoizedProps,n[ws]=t,(a=n.nodeValue!==r)&&(e=kn,e!==null))switch(e.tag){case 3:gf(n.nodeValue,r,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&gf(n.nodeValue,r,(e.mode&1)!==0)}a&&(t.flags|=4)}else n=(r.nodeType===9?r:r.ownerDocument).createTextNode(n),n[ws]=t,t.stateNode=n}return Dr(t),null;case 13:if(Nt(Ft),n=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(Pt&&En!==null&&t.mode&1&&!(t.flags&128))d2(),tl(),t.flags|=98560,a=!1;else if(a=xf(t),n!==null&&n.dehydrated!==null){if(e===null){if(!a)throw Error(we(318));if(a=t.memoizedState,a=a!==null?a.dehydrated:null,!a)throw Error(we(317));a[ws]=t}else tl(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;Dr(t),a=!1}else rs!==null&&(tp(rs),rs=null),a=!0;if(!a)return t.flags&65536?t:null}return t.flags&128?(t.lanes=r,t):(n=n!==null,n!==(e!==null&&e.memoizedState!==null)&&n&&(t.child.flags|=8192,t.mode&1&&(e===null||Ft.current&1?ar===0&&(ar=3):Og())),t.updateQueue!==null&&(t.flags|=4),Dr(t),null);case 4:return nl(),Km(e,t),e===null&&Bc(t.stateNode.containerInfo),Dr(t),null;case 10:return vg(t.type._context),Dr(t),null;case 17:return dn(t.type)&&xh(),Dr(t),null;case 19:if(Nt(Ft),a=t.memoizedState,a===null)return Dr(t),null;if(n=(t.flags&128)!==0,i=a.rendering,i===null)if(n)Wl(a,!1);else{if(ar!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(i=kh(e),i!==null){for(t.flags|=128,Wl(a,!1),n=i.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),t.subtreeFlags=0,n=r,r=t.child;r!==null;)a=r,e=n,a.flags&=14680066,i=a.alternate,i===null?(a.childLanes=0,a.lanes=e,a.child=null,a.subtreeFlags=0,a.memoizedProps=null,a.memoizedState=null,a.updateQueue=null,a.dependencies=null,a.stateNode=null):(a.childLanes=i.childLanes,a.lanes=i.lanes,a.child=i.child,a.subtreeFlags=0,a.deletions=null,a.memoizedProps=i.memoizedProps,a.memoizedState=i.memoizedState,a.updateQueue=i.updateQueue,a.type=i.type,e=i.dependencies,a.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),r=r.sibling;return Et(Ft,Ft.current&1|2),t.child}e=e.sibling}a.tail!==null&&Ht()>al&&(t.flags|=128,n=!0,Wl(a,!1),t.lanes=4194304)}else{if(!n)if(e=kh(i),e!==null){if(t.flags|=128,n=!0,r=e.updateQueue,r!==null&&(t.updateQueue=r,t.flags|=4),Wl(a,!0),a.tail===null&&a.tailMode==="hidden"&&!i.alternate&&!Pt)return Dr(t),null}else 2*Ht()-a.renderingStartTime>al&&r!==1073741824&&(t.flags|=128,n=!0,Wl(a,!1),t.lanes=4194304);a.isBackwards?(i.sibling=t.child,t.child=i):(r=a.last,r!==null?r.sibling=i:t.child=i,a.last=i)}return a.tail!==null?(t=a.tail,a.rendering=t,a.tail=t.sibling,a.renderingStartTime=Ht(),t.sibling=null,r=Ft.current,Et(Ft,n?r&1|2:r&1),t):(Dr(t),null);case 22:case 23:return Fg(),n=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==n&&(t.flags|=8192),n&&t.mode&1?vn&1073741824&&(Dr(t),t.subtreeFlags&6&&(t.flags|=8192)):Dr(t),null;case 24:return null;case 25:return null}throw Error(we(156,t.tag))}function o4(e,t){switch(mg(t),t.tag){case 1:return dn(t.type)&&xh(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return nl(),Nt(hn),Nt(Wr),Tg(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return Eg(t),null;case 13:if(Nt(Ft),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(we(340));tl()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return Nt(Ft),null;case 4:return nl(),null;case 10:return vg(t.type._context),null;case 22:case 23:return Fg(),null;case 24:return null;default:return null}}var _f=!1,jr=!1,l4=typeof WeakSet=="function"?WeakSet:Set,Ne=null;function Mo(e,t){var r=e.ref;if(r!==null)if(typeof r=="function")try{r(null)}catch(n){Ut(e,t,n)}else r.current=null}function qm(e,t,r){try{r()}catch(n){Ut(e,t,n)}}var K1=!1;function c4(e,t){if(bm=dh,e=e2(),hg(e)){if("selectionStart"in e)var r={start:e.selectionStart,end:e.selectionEnd};else e:{r=(r=e.ownerDocument)&&r.defaultView||window;var n=r.getSelection&&r.getSelection();if(n&&n.rangeCount!==0){r=n.anchorNode;var s=n.anchorOffset,a=n.focusNode;n=n.focusOffset;try{r.nodeType,a.nodeType}catch{r=null;break e}var i=0,o=-1,l=-1,c=0,u=0,d=e,m=null;t:for(;;){for(var p;d!==r||s!==0&&d.nodeType!==3||(o=i+s),d!==a||n!==0&&d.nodeType!==3||(l=i+n),d.nodeType===3&&(i+=d.nodeValue.length),(p=d.firstChild)!==null;)m=d,d=p;for(;;){if(d===e)break t;if(m===r&&++c===s&&(o=i),m===a&&++u===n&&(l=i),(p=d.nextSibling)!==null)break;d=m,m=d.parentNode}d=p}r=o===-1||l===-1?null:{start:o,end:l}}else r=null}r=r||{start:0,end:0}}else r=null;for(Pm={focusedElem:e,selectionRange:r},dh=!1,Ne=t;Ne!==null;)if(t=Ne,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,Ne=e;else for(;Ne!==null;){t=Ne;try{var x=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(x!==null){var g=x.memoizedProps,_=x.memoizedState,k=t.stateNode,T=k.getSnapshotBeforeUpdate(t.elementType===t.type?g:Zn(t.type,g),_);k.__reactInternalSnapshotBeforeUpdate=T}break;case 3:var w=t.stateNode.containerInfo;w.nodeType===1?w.textContent="":w.nodeType===9&&w.documentElement&&w.removeChild(w.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(we(163))}}catch(C){Ut(t,t.return,C)}if(e=t.sibling,e!==null){e.return=t.return,Ne=e;break}Ne=t.return}return x=K1,K1=!1,x}function pc(e,t,r){var n=t.updateQueue;if(n=n!==null?n.lastEffect:null,n!==null){var s=n=n.next;do{if((s.tag&e)===e){var a=s.destroy;s.destroy=void 0,a!==void 0&&qm(t,r,a)}s=s.next}while(s!==n)}}function wd(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var r=t=t.next;do{if((r.tag&e)===e){var n=r.create;r.destroy=n()}r=r.next}while(r!==t)}}function Xm(e){var t=e.ref;if(t!==null){var r=e.stateNode;switch(e.tag){case 5:e=r;break;default:e=r}typeof t=="function"?t(e):t.current=e}}function Y2(e){var t=e.alternate;t!==null&&(e.alternate=null,Y2(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[ws],delete t[$c],delete t[Om],delete t[HN],delete t[GN])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function Q2(e){return e.tag===5||e.tag===3||e.tag===4}function q1(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||Q2(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function Ym(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.nodeType===8?r.parentNode.insertBefore(e,t):r.insertBefore(e,t):(r.nodeType===8?(t=r.parentNode,t.insertBefore(e,r)):(t=r,t.appendChild(e)),r=r._reactRootContainer,r!=null||t.onclick!==null||(t.onclick=gh));else if(n!==4&&(e=e.child,e!==null))for(Ym(e,t,r),e=e.sibling;e!==null;)Ym(e,t,r),e=e.sibling}function Qm(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.insertBefore(e,t):r.appendChild(e);else if(n!==4&&(e=e.child,e!==null))for(Qm(e,t,r),e=e.sibling;e!==null;)Qm(e,t,r),e=e.sibling}var yr=null,es=!1;function Ca(e,t,r){for(r=r.child;r!==null;)J2(e,t,r),r=r.sibling}function J2(e,t,r){if(ks&&typeof ks.onCommitFiberUnmount=="function")try{ks.onCommitFiberUnmount(dd,r)}catch{}switch(r.tag){case 5:jr||Mo(r,t);case 6:var n=yr,s=es;yr=null,Ca(e,t,r),yr=n,es=s,yr!==null&&(es?(e=yr,r=r.stateNode,e.nodeType===8?e.parentNode.removeChild(r):e.removeChild(r)):yr.removeChild(r.stateNode));break;case 18:yr!==null&&(es?(e=yr,r=r.stateNode,e.nodeType===8?C0(e.parentNode,r):e.nodeType===1&&C0(e,r),jc(e)):C0(yr,r.stateNode));break;case 4:n=yr,s=es,yr=r.stateNode.containerInfo,es=!0,Ca(e,t,r),yr=n,es=s;break;case 0:case 11:case 14:case 15:if(!jr&&(n=r.updateQueue,n!==null&&(n=n.lastEffect,n!==null))){s=n=n.next;do{var a=s,i=a.destroy;a=a.tag,i!==void 0&&(a&2||a&4)&&qm(r,t,i),s=s.next}while(s!==n)}Ca(e,t,r);break;case 1:if(!jr&&(Mo(r,t),n=r.stateNode,typeof n.componentWillUnmount=="function"))try{n.props=r.memoizedProps,n.state=r.memoizedState,n.componentWillUnmount()}catch(o){Ut(r,t,o)}Ca(e,t,r);break;case 21:Ca(e,t,r);break;case 22:r.mode&1?(jr=(n=jr)||r.memoizedState!==null,Ca(e,t,r),jr=n):Ca(e,t,r);break;default:Ca(e,t,r)}}function X1(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var r=e.stateNode;r===null&&(r=e.stateNode=new l4),t.forEach(function(n){var s=v4.bind(null,e,n);r.has(n)||(r.add(n),n.then(s,s))})}}function Yn(e,t){var r=t.deletions;if(r!==null)for(var n=0;n<r.length;n++){var s=r[n];try{var a=e,i=t,o=i;e:for(;o!==null;){switch(o.tag){case 5:yr=o.stateNode,es=!1;break e;case 3:yr=o.stateNode.containerInfo,es=!0;break e;case 4:yr=o.stateNode.containerInfo,es=!0;break e}o=o.return}if(yr===null)throw Error(we(160));J2(a,i,s),yr=null,es=!1;var l=s.alternate;l!==null&&(l.return=null),s.return=null}catch(c){Ut(s,t,c)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)Z2(t,e),t=t.sibling}function Z2(e,t){var r=e.alternate,n=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(Yn(t,e),xs(e),n&4){try{pc(3,e,e.return),wd(3,e)}catch(g){Ut(e,e.return,g)}try{pc(5,e,e.return)}catch(g){Ut(e,e.return,g)}}break;case 1:Yn(t,e),xs(e),n&512&&r!==null&&Mo(r,r.return);break;case 5:if(Yn(t,e),xs(e),n&512&&r!==null&&Mo(r,r.return),e.flags&32){var s=e.stateNode;try{Fc(s,"")}catch(g){Ut(e,e.return,g)}}if(n&4&&(s=e.stateNode,s!=null)){var a=e.memoizedProps,i=r!==null?r.memoizedProps:a,o=e.type,l=e.updateQueue;if(e.updateQueue=null,l!==null)try{o==="input"&&a.type==="radio"&&a.name!=null&&wE(s,a),wm(o,i);var c=wm(o,a);for(i=0;i<l.length;i+=2){var u=l[i],d=l[i+1];u==="style"?AE(s,d):u==="dangerouslySetInnerHTML"?kE(s,d):u==="children"?Fc(s,d):Zp(s,u,d,c)}switch(o){case"input":gm(s,a);break;case"textarea":EE(s,a);break;case"select":var m=s._wrapperState.wasMultiple;s._wrapperState.wasMultiple=!!a.multiple;var p=a.value;p!=null?Uo(s,!!a.multiple,p,!1):m!==!!a.multiple&&(a.defaultValue!=null?Uo(s,!!a.multiple,a.defaultValue,!0):Uo(s,!!a.multiple,a.multiple?[]:"",!1))}s[$c]=a}catch(g){Ut(e,e.return,g)}}break;case 6:if(Yn(t,e),xs(e),n&4){if(e.stateNode===null)throw Error(we(162));s=e.stateNode,a=e.memoizedProps;try{s.nodeValue=a}catch(g){Ut(e,e.return,g)}}break;case 3:if(Yn(t,e),xs(e),n&4&&r!==null&&r.memoizedState.isDehydrated)try{jc(t.containerInfo)}catch(g){Ut(e,e.return,g)}break;case 4:Yn(t,e),xs(e);break;case 13:Yn(t,e),xs(e),s=e.child,s.flags&8192&&(a=s.memoizedState!==null,s.stateNode.isHidden=a,!a||s.alternate!==null&&s.alternate.memoizedState!==null||(Pg=Ht())),n&4&&X1(e);break;case 22:if(u=r!==null&&r.memoizedState!==null,e.mode&1?(jr=(c=jr)||u,Yn(t,e),jr=c):Yn(t,e),xs(e),n&8192){if(c=e.memoizedState!==null,(e.stateNode.isHidden=c)&&!u&&e.mode&1)for(Ne=e,u=e.child;u!==null;){for(d=Ne=u;Ne!==null;){switch(m=Ne,p=m.child,m.tag){case 0:case 11:case 14:case 15:pc(4,m,m.return);break;case 1:Mo(m,m.return);var x=m.stateNode;if(typeof x.componentWillUnmount=="function"){n=m,r=m.return;try{t=n,x.props=t.memoizedProps,x.state=t.memoizedState,x.componentWillUnmount()}catch(g){Ut(n,r,g)}}break;case 5:Mo(m,m.return);break;case 22:if(m.memoizedState!==null){Q1(d);continue}}p!==null?(p.return=m,Ne=p):Q1(d)}u=u.sibling}e:for(u=null,d=e;;){if(d.tag===5){if(u===null){u=d;try{s=d.stateNode,c?(a=s.style,typeof a.setProperty=="function"?a.setProperty("display","none","important"):a.display="none"):(o=d.stateNode,l=d.memoizedProps.style,i=l!=null&&l.hasOwnProperty("display")?l.display:null,o.style.display=SE("display",i))}catch(g){Ut(e,e.return,g)}}}else if(d.tag===6){if(u===null)try{d.stateNode.nodeValue=c?"":d.memoizedProps}catch(g){Ut(e,e.return,g)}}else if((d.tag!==22&&d.tag!==23||d.memoizedState===null||d===e)&&d.child!==null){d.child.return=d,d=d.child;continue}if(d===e)break e;for(;d.sibling===null;){if(d.return===null||d.return===e)break e;u===d&&(u=null),d=d.return}u===d&&(u=null),d.sibling.return=d.return,d=d.sibling}}break;case 19:Yn(t,e),xs(e),n&4&&X1(e);break;case 21:break;default:Yn(t,e),xs(e)}}function xs(e){var t=e.flags;if(t&2){try{e:{for(var r=e.return;r!==null;){if(Q2(r)){var n=r;break e}r=r.return}throw Error(we(160))}switch(n.tag){case 5:var s=n.stateNode;n.flags&32&&(Fc(s,""),n.flags&=-33);var a=q1(e);Qm(e,a,s);break;case 3:case 4:var i=n.stateNode.containerInfo,o=q1(e);Ym(e,o,i);break;default:throw Error(we(161))}}catch(l){Ut(e,e.return,l)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function u4(e,t,r){Ne=e,eT(e)}function eT(e,t,r){for(var n=(e.mode&1)!==0;Ne!==null;){var s=Ne,a=s.child;if(s.tag===22&&n){var i=s.memoizedState!==null||_f;if(!i){var o=s.alternate,l=o!==null&&o.memoizedState!==null||jr;o=_f;var c=jr;if(_f=i,(jr=l)&&!c)for(Ne=s;Ne!==null;)i=Ne,l=i.child,i.tag===22&&i.memoizedState!==null?J1(s):l!==null?(l.return=i,Ne=l):J1(s);for(;a!==null;)Ne=a,eT(a),a=a.sibling;Ne=s,_f=o,jr=c}Y1(e)}else s.subtreeFlags&8772&&a!==null?(a.return=s,Ne=a):Y1(e)}}function Y1(e){for(;Ne!==null;){var t=Ne;if(t.flags&8772){var r=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:jr||wd(5,t);break;case 1:var n=t.stateNode;if(t.flags&4&&!jr)if(r===null)n.componentDidMount();else{var s=t.elementType===t.type?r.memoizedProps:Zn(t.type,r.memoizedProps);n.componentDidUpdate(s,r.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var a=t.updateQueue;a!==null&&F1(t,a,n);break;case 3:var i=t.updateQueue;if(i!==null){if(r=null,t.child!==null)switch(t.child.tag){case 5:r=t.child.stateNode;break;case 1:r=t.child.stateNode}F1(t,i,r)}break;case 5:var o=t.stateNode;if(r===null&&t.flags&4){r=o;var l=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&r.focus();break;case"img":l.src&&(r.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var c=t.alternate;if(c!==null){var u=c.memoizedState;if(u!==null){var d=u.dehydrated;d!==null&&jc(d)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(we(163))}jr||t.flags&512&&Xm(t)}catch(m){Ut(t,t.return,m)}}if(t===e){Ne=null;break}if(r=t.sibling,r!==null){r.return=t.return,Ne=r;break}Ne=t.return}}function Q1(e){for(;Ne!==null;){var t=Ne;if(t===e){Ne=null;break}var r=t.sibling;if(r!==null){r.return=t.return,Ne=r;break}Ne=t.return}}function J1(e){for(;Ne!==null;){var t=Ne;try{switch(t.tag){case 0:case 11:case 15:var r=t.return;try{wd(4,t)}catch(l){Ut(t,r,l)}break;case 1:var n=t.stateNode;if(typeof n.componentDidMount=="function"){var s=t.return;try{n.componentDidMount()}catch(l){Ut(t,s,l)}}var a=t.return;try{Xm(t)}catch(l){Ut(t,a,l)}break;case 5:var i=t.return;try{Xm(t)}catch(l){Ut(t,i,l)}}}catch(l){Ut(t,t.return,l)}if(t===e){Ne=null;break}var o=t.sibling;if(o!==null){o.return=t.return,Ne=o;break}Ne=t.return}}var f4=Math.ceil,Ih=Ea.ReactCurrentDispatcher,Rg=Ea.ReactCurrentOwner,Un=Ea.ReactCurrentBatchConfig,ot=0,pr=null,er=null,Tr=0,vn=0,Lo=pi(0),ar=0,Xc=null,Wi=0,Ed=0,bg=0,gc=null,cn=null,Pg=0,al=1/0,Ys=null,Ch=!1,Jm=null,Ja=null,wf=!1,za=null,Nh=0,xc=0,Zm=null,qf=-1,Xf=0;function Jr(){return ot&6?Ht():qf!==-1?qf:qf=Ht()}function Za(e){return e.mode&1?ot&2&&Tr!==0?Tr&-Tr:qN.transition!==null?(Xf===0&&(Xf=jE()),Xf):(e=gt,e!==0||(e=window.event,e=e===void 0?16:HE(e.type)),e):1}function cs(e,t,r,n){if(50<xc)throw xc=0,Zm=null,Error(we(185));yu(e,r,n),(!(ot&2)||e!==pr)&&(e===pr&&(!(ot&2)&&(Ed|=r),ar===4&&Ma(e,Tr)),mn(e,n),r===1&&ot===0&&!(t.mode&1)&&(al=Ht()+500,vd&&gi()))}function mn(e,t){var r=e.callbackNode;qC(e,t);var n=hh(e,e===pr?Tr:0);if(n===0)r!==null&&o1(r),e.callbackNode=null,e.callbackPriority=0;else if(t=n&-n,e.callbackPriority!==t){if(r!=null&&o1(r),t===1)e.tag===0?KN(Z1.bind(null,e)):u2(Z1.bind(null,e)),$N(function(){!(ot&6)&&gi()}),r=null;else{switch(UE(n)){case 1:r=sg;break;case 4:r=ME;break;case 16:r=fh;break;case 536870912:r=LE;break;default:r=fh}r=lT(r,tT.bind(null,e))}e.callbackPriority=t,e.callbackNode=r}}function tT(e,t){if(qf=-1,Xf=0,ot&6)throw Error(we(327));var r=e.callbackNode;if(Wo()&&e.callbackNode!==r)return null;var n=hh(e,e===pr?Tr:0);if(n===0)return null;if(n&30||n&e.expiredLanes||t)t=Rh(e,n);else{t=n;var s=ot;ot|=2;var a=nT();(pr!==e||Tr!==t)&&(Ys=null,al=Ht()+500,Oi(e,t));do try{m4();break}catch(o){rT(e,o)}while(!0);xg(),Ih.current=a,ot=s,er!==null?t=0:(pr=null,Tr=0,t=ar)}if(t!==0){if(t===2&&(s=Am(e),s!==0&&(n=s,t=ep(e,s))),t===1)throw r=Xc,Oi(e,0),Ma(e,n),mn(e,Ht()),r;if(t===6)Ma(e,n);else{if(s=e.current.alternate,!(n&30)&&!h4(s)&&(t=Rh(e,n),t===2&&(a=Am(e),a!==0&&(n=a,t=ep(e,a))),t===1))throw r=Xc,Oi(e,0),Ma(e,n),mn(e,Ht()),r;switch(e.finishedWork=s,e.finishedLanes=n,t){case 0:case 1:throw Error(we(345));case 2:Ti(e,cn,Ys);break;case 3:if(Ma(e,n),(n&130023424)===n&&(t=Pg+500-Ht(),10<t)){if(hh(e,0)!==0)break;if(s=e.suspendedLanes,(s&n)!==n){Jr(),e.pingedLanes|=e.suspendedLanes&s;break}e.timeoutHandle=Fm(Ti.bind(null,e,cn,Ys),t);break}Ti(e,cn,Ys);break;case 4:if(Ma(e,n),(n&4194240)===n)break;for(t=e.eventTimes,s=-1;0<n;){var i=31-ls(n);a=1<<i,i=t[i],i>s&&(s=i),n&=~a}if(n=s,n=Ht()-n,n=(120>n?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*f4(n/1960))-n,10<n){e.timeoutHandle=Fm(Ti.bind(null,e,cn,Ys),n);break}Ti(e,cn,Ys);break;case 5:Ti(e,cn,Ys);break;default:throw Error(we(329))}}}return mn(e,Ht()),e.callbackNode===r?tT.bind(null,e):null}function ep(e,t){var r=gc;return e.current.memoizedState.isDehydrated&&(Oi(e,t).flags|=256),e=Rh(e,t),e!==2&&(t=cn,cn=r,t!==null&&tp(t)),e}function tp(e){cn===null?cn=e:cn.push.apply(cn,e)}function h4(e){for(var t=e;;){if(t.flags&16384){var r=t.updateQueue;if(r!==null&&(r=r.stores,r!==null))for(var n=0;n<r.length;n++){var s=r[n],a=s.getSnapshot;s=s.value;try{if(!hs(a(),s))return!1}catch{return!1}}}if(r=t.child,t.subtreeFlags&16384&&r!==null)r.return=t,t=r;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function Ma(e,t){for(t&=~bg,t&=~Ed,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var r=31-ls(t),n=1<<r;e[r]=-1,t&=~n}}function Z1(e){if(ot&6)throw Error(we(327));Wo();var t=hh(e,0);if(!(t&1))return mn(e,Ht()),null;var r=Rh(e,t);if(e.tag!==0&&r===2){var n=Am(e);n!==0&&(t=n,r=ep(e,n))}if(r===1)throw r=Xc,Oi(e,0),Ma(e,t),mn(e,Ht()),r;if(r===6)throw Error(we(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,Ti(e,cn,Ys),mn(e,Ht()),null}function Dg(e,t){var r=ot;ot|=1;try{return e(t)}finally{ot=r,ot===0&&(al=Ht()+500,vd&&gi())}}function Hi(e){za!==null&&za.tag===0&&!(ot&6)&&Wo();var t=ot;ot|=1;var r=Un.transition,n=gt;try{if(Un.transition=null,gt=1,e)return e()}finally{gt=n,Un.transition=r,ot=t,!(ot&6)&&gi()}}function Fg(){vn=Lo.current,Nt(Lo)}function Oi(e,t){e.finishedWork=null,e.finishedLanes=0;var r=e.timeoutHandle;if(r!==-1&&(e.timeoutHandle=-1,zN(r)),er!==null)for(r=er.return;r!==null;){var n=r;switch(mg(n),n.tag){case 1:n=n.type.childContextTypes,n!=null&&xh();break;case 3:nl(),Nt(hn),Nt(Wr),Tg();break;case 5:Eg(n);break;case 4:nl();break;case 13:Nt(Ft);break;case 19:Nt(Ft);break;case 10:vg(n.type._context);break;case 22:case 23:Fg()}r=r.return}if(pr=e,er=e=ei(e.current,null),Tr=vn=t,ar=0,Xc=null,bg=Ed=Wi=0,cn=gc=null,Ni!==null){for(t=0;t<Ni.length;t++)if(r=Ni[t],n=r.interleaved,n!==null){r.interleaved=null;var s=n.next,a=r.pending;if(a!==null){var i=a.next;a.next=s,n.next=i}r.pending=n}Ni=null}return e}function rT(e,t){do{var r=er;try{if(xg(),Hf.current=Ah,Sh){for(var n=Ot.memoizedState;n!==null;){var s=n.queue;s!==null&&(s.pending=null),n=n.next}Sh=!1}if($i=0,mr=sr=Ot=null,mc=!1,Gc=0,Rg.current=null,r===null||r.return===null){ar=1,Xc=t,er=null;break}e:{var a=e,i=r.return,o=r,l=t;if(t=Tr,o.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var c=l,u=o,d=u.tag;if(!(u.mode&1)&&(d===0||d===11||d===15)){var m=u.alternate;m?(u.updateQueue=m.updateQueue,u.memoizedState=m.memoizedState,u.lanes=m.lanes):(u.updateQueue=null,u.memoizedState=null)}var p=V1(i);if(p!==null){p.flags&=-257,B1(p,i,o,a,t),p.mode&1&&U1(a,c,t),t=p,l=c;var x=t.updateQueue;if(x===null){var g=new Set;g.add(l),t.updateQueue=g}else x.add(l);break e}else{if(!(t&1)){U1(a,c,t),Og();break e}l=Error(we(426))}}else if(Pt&&o.mode&1){var _=V1(i);if(_!==null){!(_.flags&65536)&&(_.flags|=256),B1(_,i,o,a,t),pg(sl(l,o));break e}}a=l=sl(l,o),ar!==4&&(ar=2),gc===null?gc=[a]:gc.push(a),a=i;do{switch(a.tag){case 3:a.flags|=65536,t&=-t,a.lanes|=t;var k=U2(a,l,t);D1(a,k);break e;case 1:o=l;var T=a.type,w=a.stateNode;if(!(a.flags&128)&&(typeof T.getDerivedStateFromError=="function"||w!==null&&typeof w.componentDidCatch=="function"&&(Ja===null||!Ja.has(w)))){a.flags|=65536,t&=-t,a.lanes|=t;var C=V2(a,o,t);D1(a,C);break e}}a=a.return}while(a!==null)}aT(r)}catch(M){t=M,er===r&&r!==null&&(er=r=r.return);continue}break}while(!0)}function nT(){var e=Ih.current;return Ih.current=Ah,e===null?Ah:e}function Og(){(ar===0||ar===3||ar===2)&&(ar=4),pr===null||!(Wi&268435455)&&!(Ed&268435455)||Ma(pr,Tr)}function Rh(e,t){var r=ot;ot|=2;var n=nT();(pr!==e||Tr!==t)&&(Ys=null,Oi(e,t));do try{d4();break}catch(s){rT(e,s)}while(!0);if(xg(),ot=r,Ih.current=n,er!==null)throw Error(we(261));return pr=null,Tr=0,ar}function d4(){for(;er!==null;)sT(er)}function m4(){for(;er!==null&&!UC();)sT(er)}function sT(e){var t=oT(e.alternate,e,vn);e.memoizedProps=e.pendingProps,t===null?aT(e):er=t,Rg.current=null}function aT(e){var t=e;do{var r=t.alternate;if(e=t.return,t.flags&32768){if(r=o4(r,t),r!==null){r.flags&=32767,er=r;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{ar=6,er=null;return}}else if(r=i4(r,t,vn),r!==null){er=r;return}if(t=t.sibling,t!==null){er=t;return}er=t=e}while(t!==null);ar===0&&(ar=5)}function Ti(e,t,r){var n=gt,s=Un.transition;try{Un.transition=null,gt=1,p4(e,t,r,n)}finally{Un.transition=s,gt=n}return null}function p4(e,t,r,n){do Wo();while(za!==null);if(ot&6)throw Error(we(327));r=e.finishedWork;var s=e.finishedLanes;if(r===null)return null;if(e.finishedWork=null,e.finishedLanes=0,r===e.current)throw Error(we(177));e.callbackNode=null,e.callbackPriority=0;var a=r.lanes|r.childLanes;if(XC(e,a),e===pr&&(er=pr=null,Tr=0),!(r.subtreeFlags&2064)&&!(r.flags&2064)||wf||(wf=!0,lT(fh,function(){return Wo(),null})),a=(r.flags&15990)!==0,r.subtreeFlags&15990||a){a=Un.transition,Un.transition=null;var i=gt;gt=1;var o=ot;ot|=4,Rg.current=null,c4(e,r),Z2(r,e),ON(Pm),dh=!!bm,Pm=bm=null,e.current=r,u4(r),VC(),ot=o,gt=i,Un.transition=a}else e.current=r;if(wf&&(wf=!1,za=e,Nh=s),a=e.pendingLanes,a===0&&(Ja=null),$C(r.stateNode),mn(e,Ht()),t!==null)for(n=e.onRecoverableError,r=0;r<t.length;r++)s=t[r],n(s.value,{componentStack:s.stack,digest:s.digest});if(Ch)throw Ch=!1,e=Jm,Jm=null,e;return Nh&1&&e.tag!==0&&Wo(),a=e.pendingLanes,a&1?e===Zm?xc++:(xc=0,Zm=e):xc=0,gi(),null}function Wo(){if(za!==null){var e=UE(Nh),t=Un.transition,r=gt;try{if(Un.transition=null,gt=16>e?16:e,za===null)var n=!1;else{if(e=za,za=null,Nh=0,ot&6)throw Error(we(331));var s=ot;for(ot|=4,Ne=e.current;Ne!==null;){var a=Ne,i=a.child;if(Ne.flags&16){var o=a.deletions;if(o!==null){for(var l=0;l<o.length;l++){var c=o[l];for(Ne=c;Ne!==null;){var u=Ne;switch(u.tag){case 0:case 11:case 15:pc(8,u,a)}var d=u.child;if(d!==null)d.return=u,Ne=d;else for(;Ne!==null;){u=Ne;var m=u.sibling,p=u.return;if(Y2(u),u===c){Ne=null;break}if(m!==null){m.return=p,Ne=m;break}Ne=p}}}var x=a.alternate;if(x!==null){var g=x.child;if(g!==null){x.child=null;do{var _=g.sibling;g.sibling=null,g=_}while(g!==null)}}Ne=a}}if(a.subtreeFlags&2064&&i!==null)i.return=a,Ne=i;else e:for(;Ne!==null;){if(a=Ne,a.flags&2048)switch(a.tag){case 0:case 11:case 15:pc(9,a,a.return)}var k=a.sibling;if(k!==null){k.return=a.return,Ne=k;break e}Ne=a.return}}var T=e.current;for(Ne=T;Ne!==null;){i=Ne;var w=i.child;if(i.subtreeFlags&2064&&w!==null)w.return=i,Ne=w;else e:for(i=T;Ne!==null;){if(o=Ne,o.flags&2048)try{switch(o.tag){case 0:case 11:case 15:wd(9,o)}}catch(M){Ut(o,o.return,M)}if(o===i){Ne=null;break e}var C=o.sibling;if(C!==null){C.return=o.return,Ne=C;break e}Ne=o.return}}if(ot=s,gi(),ks&&typeof ks.onPostCommitFiberRoot=="function")try{ks.onPostCommitFiberRoot(dd,e)}catch{}n=!0}return n}finally{gt=r,Un.transition=t}}return!1}function ey(e,t,r){t=sl(r,t),t=U2(e,t,1),e=Qa(e,t,1),t=Jr(),e!==null&&(yu(e,1,t),mn(e,t))}function Ut(e,t,r){if(e.tag===3)ey(e,e,r);else for(;t!==null;){if(t.tag===3){ey(t,e,r);break}else if(t.tag===1){var n=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof n.componentDidCatch=="function"&&(Ja===null||!Ja.has(n))){e=sl(r,e),e=V2(t,e,1),t=Qa(t,e,1),e=Jr(),t!==null&&(yu(t,1,e),mn(t,e));break}}t=t.return}}function g4(e,t,r){var n=e.pingCache;n!==null&&n.delete(t),t=Jr(),e.pingedLanes|=e.suspendedLanes&r,pr===e&&(Tr&r)===r&&(ar===4||ar===3&&(Tr&130023424)===Tr&&500>Ht()-Pg?Oi(e,0):bg|=r),mn(e,t)}function iT(e,t){t===0&&(e.mode&1?(t=ff,ff<<=1,!(ff&130023424)&&(ff=4194304)):t=1);var r=Jr();e=ha(e,t),e!==null&&(yu(e,t,r),mn(e,r))}function x4(e){var t=e.memoizedState,r=0;t!==null&&(r=t.retryLane),iT(e,r)}function v4(e,t){var r=0;switch(e.tag){case 13:var n=e.stateNode,s=e.memoizedState;s!==null&&(r=s.retryLane);break;case 19:n=e.stateNode;break;default:throw Error(we(314))}n!==null&&n.delete(t),iT(e,r)}var oT;oT=function(e,t,r){if(e!==null)if(e.memoizedProps!==t.pendingProps||hn.current)fn=!0;else{if(!(e.lanes&r)&&!(t.flags&128))return fn=!1,a4(e,t,r);fn=!!(e.flags&131072)}else fn=!1,Pt&&t.flags&1048576&&f2(t,_h,t.index);switch(t.lanes=0,t.tag){case 2:var n=t.type;Kf(e,t),e=t.pendingProps;var s=el(t,Wr.current);$o(t,r),s=Sg(null,t,n,e,s,r);var a=Ag();return t.flags|=1,typeof s=="object"&&s!==null&&typeof s.render=="function"&&s.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,dn(n)?(a=!0,vh(t)):a=!1,t.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,_g(t),s.updater=_d,t.stateNode=s,s._reactInternals=t,Bm(t,n,e,r),t=Wm(null,t,n,!0,a,r)):(t.tag=0,Pt&&a&&dg(t),qr(null,t,s,r),t=t.child),t;case 16:n=t.elementType;e:{switch(Kf(e,t),e=t.pendingProps,s=n._init,n=s(n._payload),t.type=n,s=t.tag=_4(n),e=Zn(n,e),s){case 0:t=$m(null,t,n,e,r);break e;case 1:t=W1(null,t,n,e,r);break e;case 11:t=z1(null,t,n,e,r);break e;case 14:t=$1(null,t,n,Zn(n.type,e),r);break e}throw Error(we(306,n,""))}return t;case 0:return n=t.type,s=t.pendingProps,s=t.elementType===n?s:Zn(n,s),$m(e,t,n,s,r);case 1:return n=t.type,s=t.pendingProps,s=t.elementType===n?s:Zn(n,s),W1(e,t,n,s,r);case 3:e:{if(W2(t),e===null)throw Error(we(387));n=t.pendingProps,a=t.memoizedState,s=a.element,x2(e,t),Th(t,n,null,r);var i=t.memoizedState;if(n=i.element,a.isDehydrated)if(a={element:n,isDehydrated:!1,cache:i.cache,pendingSuspenseBoundaries:i.pendingSuspenseBoundaries,transitions:i.transitions},t.updateQueue.baseState=a,t.memoizedState=a,t.flags&256){s=sl(Error(we(423)),t),t=H1(e,t,n,r,s);break e}else if(n!==s){s=sl(Error(we(424)),t),t=H1(e,t,n,r,s);break e}else for(En=Ya(t.stateNode.containerInfo.firstChild),kn=t,Pt=!0,rs=null,r=p2(t,null,n,r),t.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if(tl(),n===s){t=da(e,t,r);break e}qr(e,t,n,r)}t=t.child}return t;case 5:return v2(t),e===null&&jm(t),n=t.type,s=t.pendingProps,a=e!==null?e.memoizedProps:null,i=s.children,Dm(n,s)?i=null:a!==null&&Dm(n,a)&&(t.flags|=32),$2(e,t),qr(e,t,i,r),t.child;case 6:return e===null&&jm(t),null;case 13:return H2(e,t,r);case 4:return wg(t,t.stateNode.containerInfo),n=t.pendingProps,e===null?t.child=rl(t,null,n,r):qr(e,t,n,r),t.child;case 11:return n=t.type,s=t.pendingProps,s=t.elementType===n?s:Zn(n,s),z1(e,t,n,s,r);case 7:return qr(e,t,t.pendingProps,r),t.child;case 8:return qr(e,t,t.pendingProps.children,r),t.child;case 12:return qr(e,t,t.pendingProps.children,r),t.child;case 10:e:{if(n=t.type._context,s=t.pendingProps,a=t.memoizedProps,i=s.value,Et(wh,n._currentValue),n._currentValue=i,a!==null)if(hs(a.value,i)){if(a.children===s.children&&!hn.current){t=da(e,t,r);break e}}else for(a=t.child,a!==null&&(a.return=t);a!==null;){var o=a.dependencies;if(o!==null){i=a.child;for(var l=o.firstContext;l!==null;){if(l.context===n){if(a.tag===1){l=aa(-1,r&-r),l.tag=2;var c=a.updateQueue;if(c!==null){c=c.shared;var u=c.pending;u===null?l.next=l:(l.next=u.next,u.next=l),c.pending=l}}a.lanes|=r,l=a.alternate,l!==null&&(l.lanes|=r),Um(a.return,r,t),o.lanes|=r;break}l=l.next}}else if(a.tag===10)i=a.type===t.type?null:a.child;else if(a.tag===18){if(i=a.return,i===null)throw Error(we(341));i.lanes|=r,o=i.alternate,o!==null&&(o.lanes|=r),Um(i,r,t),i=a.sibling}else i=a.child;if(i!==null)i.return=a;else for(i=a;i!==null;){if(i===t){i=null;break}if(a=i.sibling,a!==null){a.return=i.return,i=a;break}i=i.return}a=i}qr(e,t,s.children,r),t=t.child}return t;case 9:return s=t.type,n=t.pendingProps.children,$o(t,r),s=Wn(s),n=n(s),t.flags|=1,qr(e,t,n,r),t.child;case 14:return n=t.type,s=Zn(n,t.pendingProps),s=Zn(n.type,s),$1(e,t,n,s,r);case 15:return B2(e,t,t.type,t.pendingProps,r);case 17:return n=t.type,s=t.pendingProps,s=t.elementType===n?s:Zn(n,s),Kf(e,t),t.tag=1,dn(n)?(e=!0,vh(t)):e=!1,$o(t,r),j2(t,n,s),Bm(t,n,s,r),Wm(null,t,n,!0,e,r);case 19:return G2(e,t,r);case 22:return z2(e,t,r)}throw Error(we(156,t.tag))};function lT(e,t){return OE(e,t)}function y4(e,t,r,n){this.tag=e,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function jn(e,t,r,n){return new y4(e,t,r,n)}function Mg(e){return e=e.prototype,!(!e||!e.isReactComponent)}function _4(e){if(typeof e=="function")return Mg(e)?1:0;if(e!=null){if(e=e.$$typeof,e===tg)return 11;if(e===rg)return 14}return 2}function ei(e,t){var r=e.alternate;return r===null?(r=jn(e.tag,t,e.key,e.mode),r.elementType=e.elementType,r.type=e.type,r.stateNode=e.stateNode,r.alternate=e,e.alternate=r):(r.pendingProps=t,r.type=e.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=e.flags&14680064,r.childLanes=e.childLanes,r.lanes=e.lanes,r.child=e.child,r.memoizedProps=e.memoizedProps,r.memoizedState=e.memoizedState,r.updateQueue=e.updateQueue,t=e.dependencies,r.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},r.sibling=e.sibling,r.index=e.index,r.ref=e.ref,r}function Yf(e,t,r,n,s,a){var i=2;if(n=e,typeof e=="function")Mg(e)&&(i=1);else if(typeof e=="string")i=5;else e:switch(e){case Io:return Mi(r.children,s,a,t);case eg:i=8,s|=8;break;case fm:return e=jn(12,r,t,s|2),e.elementType=fm,e.lanes=a,e;case hm:return e=jn(13,r,t,s),e.elementType=hm,e.lanes=a,e;case dm:return e=jn(19,r,t,s),e.elementType=dm,e.lanes=a,e;case vE:return Td(r,s,a,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case gE:i=10;break e;case xE:i=9;break e;case tg:i=11;break e;case rg:i=14;break e;case Da:i=16,n=null;break e}throw Error(we(130,e==null?e:typeof e,""))}return t=jn(i,r,t,s),t.elementType=e,t.type=n,t.lanes=a,t}function Mi(e,t,r,n){return e=jn(7,e,n,t),e.lanes=r,e}function Td(e,t,r,n){return e=jn(22,e,n,t),e.elementType=vE,e.lanes=r,e.stateNode={isHidden:!1},e}function M0(e,t,r){return e=jn(6,e,null,t),e.lanes=r,e}function L0(e,t,r){return t=jn(4,e.children!==null?e.children:[],e.key,t),t.lanes=r,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function w4(e,t,r,n,s){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=x0(0),this.expirationTimes=x0(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=x0(0),this.identifierPrefix=n,this.onRecoverableError=s,this.mutableSourceEagerHydrationData=null}function Lg(e,t,r,n,s,a,i,o,l){return e=new w4(e,t,r,o,l),t===1?(t=1,a===!0&&(t|=8)):t=0,a=jn(3,null,null,t),e.current=a,a.stateNode=e,a.memoizedState={element:n,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},_g(a),e}function E4(e,t,r){var n=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Ao,key:n==null?null:""+n,children:e,containerInfo:t,implementation:r}}function cT(e){if(!e)return ii;e=e._reactInternals;e:{if(to(e)!==e||e.tag!==1)throw Error(we(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(dn(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(we(171))}if(e.tag===1){var r=e.type;if(dn(r))return c2(e,r,t)}return t}function uT(e,t,r,n,s,a,i,o,l){return e=Lg(r,n,!0,e,s,a,i,o,l),e.context=cT(null),r=e.current,n=Jr(),s=Za(r),a=aa(n,s),a.callback=t??null,Qa(r,a,s),e.current.lanes=s,yu(e,s,n),mn(e,n),e}function kd(e,t,r,n){var s=t.current,a=Jr(),i=Za(s);return r=cT(r),t.context===null?t.context=r:t.pendingContext=r,t=aa(a,i),t.payload={element:e},n=n===void 0?null:n,n!==null&&(t.callback=n),e=Qa(s,t,i),e!==null&&(cs(e,s,i,a),Wf(e,s,i)),i}function bh(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function ty(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var r=e.retryLane;e.retryLane=r!==0&&r<t?r:t}}function jg(e,t){ty(e,t),(e=e.alternate)&&ty(e,t)}function T4(){return null}var fT=typeof reportError=="function"?reportError:function(e){console.error(e)};function Ug(e){this._internalRoot=e}Sd.prototype.render=Ug.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(we(409));kd(e,t,null,null)};Sd.prototype.unmount=Ug.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;Hi(function(){kd(null,e,null,null)}),t[fa]=null}};function Sd(e){this._internalRoot=e}Sd.prototype.unstable_scheduleHydration=function(e){if(e){var t=zE();e={blockedOn:null,target:e,priority:t};for(var r=0;r<Oa.length&&t!==0&&t<Oa[r].priority;r++);Oa.splice(r,0,e),r===0&&WE(e)}};function Vg(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function Ad(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function ry(){}function k4(e,t,r,n,s){if(s){if(typeof n=="function"){var a=n;n=function(){var c=bh(i);a.call(c)}}var i=uT(t,n,e,0,null,!1,!1,"",ry);return e._reactRootContainer=i,e[fa]=i.current,Bc(e.nodeType===8?e.parentNode:e),Hi(),i}for(;s=e.lastChild;)e.removeChild(s);if(typeof n=="function"){var o=n;n=function(){var c=bh(l);o.call(c)}}var l=Lg(e,0,!1,null,null,!1,!1,"",ry);return e._reactRootContainer=l,e[fa]=l.current,Bc(e.nodeType===8?e.parentNode:e),Hi(function(){kd(t,l,r,n)}),l}function Id(e,t,r,n,s){var a=r._reactRootContainer;if(a){var i=a;if(typeof s=="function"){var o=s;s=function(){var l=bh(i);o.call(l)}}kd(t,i,e,s)}else i=k4(r,t,e,s,n);return bh(i)}VE=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var r=Jl(t.pendingLanes);r!==0&&(ag(t,r|1),mn(t,Ht()),!(ot&6)&&(al=Ht()+500,gi()))}break;case 13:Hi(function(){var n=ha(e,1);if(n!==null){var s=Jr();cs(n,e,1,s)}}),jg(e,1)}};ig=function(e){if(e.tag===13){var t=ha(e,134217728);if(t!==null){var r=Jr();cs(t,e,134217728,r)}jg(e,134217728)}};BE=function(e){if(e.tag===13){var t=Za(e),r=ha(e,t);if(r!==null){var n=Jr();cs(r,e,t,n)}jg(e,t)}};zE=function(){return gt};$E=function(e,t){var r=gt;try{return gt=e,t()}finally{gt=r}};Tm=function(e,t,r){switch(t){case"input":if(gm(e,r),t=r.name,r.type==="radio"&&t!=null){for(r=e;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<r.length;t++){var n=r[t];if(n!==e&&n.form===e.form){var s=xd(n);if(!s)throw Error(we(90));_E(n),gm(n,s)}}}break;case"textarea":EE(e,r);break;case"select":t=r.value,t!=null&&Uo(e,!!r.multiple,t,!1)}};NE=Dg;RE=Hi;var S4={usingClientEntryPoint:!1,Events:[wu,bo,xd,IE,CE,Dg]},Hl={findFiberByHostInstance:Ci,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},A4={bundleType:Hl.bundleType,version:Hl.version,rendererPackageName:Hl.rendererPackageName,rendererConfig:Hl.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Ea.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=DE(e),e===null?null:e.stateNode},findFiberByHostInstance:Hl.findFiberByHostInstance||T4,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Ef=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Ef.isDisabled&&Ef.supportsFiber)try{dd=Ef.inject(A4),ks=Ef}catch{}}In.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=S4;In.createPortal=function(e,t){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Vg(t))throw Error(we(200));return E4(e,t,null,r)};In.createRoot=function(e,t){if(!Vg(e))throw Error(we(299));var r=!1,n="",s=fT;return t!=null&&(t.unstable_strictMode===!0&&(r=!0),t.identifierPrefix!==void 0&&(n=t.identifierPrefix),t.onRecoverableError!==void 0&&(s=t.onRecoverableError)),t=Lg(e,1,!1,null,null,r,!1,n,s),e[fa]=t.current,Bc(e.nodeType===8?e.parentNode:e),new Ug(t)};In.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(we(188)):(e=Object.keys(e).join(","),Error(we(268,e)));return e=DE(t),e=e===null?null:e.stateNode,e};In.flushSync=function(e){return Hi(e)};In.hydrate=function(e,t,r){if(!Ad(t))throw Error(we(200));return Id(null,e,t,!0,r)};In.hydrateRoot=function(e,t,r){if(!Vg(e))throw Error(we(405));var n=r!=null&&r.hydratedSources||null,s=!1,a="",i=fT;if(r!=null&&(r.unstable_strictMode===!0&&(s=!0),r.identifierPrefix!==void 0&&(a=r.identifierPrefix),r.onRecoverableError!==void 0&&(i=r.onRecoverableError)),t=uT(t,null,e,1,r??null,s,!1,a,i),e[fa]=t.current,Bc(e),n)for(e=0;e<n.length;e++)r=n[e],s=r._getVersion,s=s(r._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[r,s]:t.mutableSourceEagerHydrationData.push(r,s);return new Sd(t)};In.render=function(e,t,r){if(!Ad(t))throw Error(we(200));return Id(null,e,t,!1,r)};In.unmountComponentAtNode=function(e){if(!Ad(e))throw Error(we(40));return e._reactRootContainer?(Hi(function(){Id(null,null,e,!1,function(){e._reactRootContainer=null,e[fa]=null})}),!0):!1};In.unstable_batchedUpdates=Dg;In.unstable_renderSubtreeIntoContainer=function(e,t,r,n){if(!Ad(r))throw Error(we(200));if(e==null||e._reactInternals===void 0)throw Error(we(38));return Id(e,t,r,!1,n)};In.version="18.3.1-next-f1338f8080-20240426";function hT(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(hT)}catch(e){console.error(e)}}hT(),hE.exports=In;var Bg=hE.exports;const I4=eE(Bg),C4=Zw({__proto__:null,default:I4},[Bg]);var ny=Bg;cm.createRoot=ny.createRoot,cm.hydrateRoot=ny.hydrateRoot;/**
 * @remix-run/router v1.23.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Rt(){return Rt=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Rt.apply(this,arguments)}var Zt;(function(e){e.Pop="POP",e.Push="PUSH",e.Replace="REPLACE"})(Zt||(Zt={}));const sy="popstate";function N4(e){e===void 0&&(e={});function t(n,s){let{pathname:a,search:i,hash:o}=n.location;return Yc("",{pathname:a,search:i,hash:o},s.state&&s.state.usr||null,s.state&&s.state.key||"default")}function r(n,s){return typeof s=="string"?s:Gi(s)}return b4(t,r,null,e)}function Ke(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}function il(e,t){if(!e){typeof console<"u"&&console.warn(t);try{throw new Error(t)}catch{}}}function R4(){return Math.random().toString(36).substr(2,8)}function ay(e,t){return{usr:e.state,key:e.key,idx:t}}function Yc(e,t,r,n){return r===void 0&&(r=null),Rt({pathname:typeof e=="string"?e:e.pathname,search:"",hash:""},typeof t=="string"?xi(t):t,{state:r,key:t&&t.key||n||R4()})}function Gi(e){let{pathname:t="/",search:r="",hash:n=""}=e;return r&&r!=="?"&&(t+=r.charAt(0)==="?"?r:"?"+r),n&&n!=="#"&&(t+=n.charAt(0)==="#"?n:"#"+n),t}function xi(e){let t={};if(e){let r=e.indexOf("#");r>=0&&(t.hash=e.substr(r),e=e.substr(0,r));let n=e.indexOf("?");n>=0&&(t.search=e.substr(n),e=e.substr(0,n)),e&&(t.pathname=e)}return t}function b4(e,t,r,n){n===void 0&&(n={});let{window:s=document.defaultView,v5Compat:a=!1}=n,i=s.history,o=Zt.Pop,l=null,c=u();c==null&&(c=0,i.replaceState(Rt({},i.state,{idx:c}),""));function u(){return(i.state||{idx:null}).idx}function d(){o=Zt.Pop;let _=u(),k=_==null?null:_-c;c=_,l&&l({action:o,location:g.location,delta:k})}function m(_,k){o=Zt.Push;let T=Yc(g.location,_,k);c=u()+1;let w=ay(T,c),C=g.createHref(T);try{i.pushState(w,"",C)}catch(M){if(M instanceof DOMException&&M.name==="DataCloneError")throw M;s.location.assign(C)}a&&l&&l({action:o,location:g.location,delta:1})}function p(_,k){o=Zt.Replace;let T=Yc(g.location,_,k);c=u();let w=ay(T,c),C=g.createHref(T);i.replaceState(w,"",C),a&&l&&l({action:o,location:g.location,delta:0})}function x(_){let k=s.location.origin!=="null"?s.location.origin:s.location.href,T=typeof _=="string"?_:Gi(_);return T=T.replace(/ $/,"%20"),Ke(k,"No window.location.(origin|href) available to create URL for href: "+T),new URL(T,k)}let g={get action(){return o},get location(){return e(s,i)},listen(_){if(l)throw new Error("A history only accepts one active listener");return s.addEventListener(sy,d),l=_,()=>{s.removeEventListener(sy,d),l=null}},createHref(_){return t(s,_)},createURL:x,encodeLocation(_){let k=x(_);return{pathname:k.pathname,search:k.search,hash:k.hash}},push:m,replace:p,go(_){return i.go(_)}};return g}var pt;(function(e){e.data="data",e.deferred="deferred",e.redirect="redirect",e.error="error"})(pt||(pt={}));const P4=new Set(["lazy","caseSensitive","path","id","index","children"]);function D4(e){return e.index===!0}function Ph(e,t,r,n){return r===void 0&&(r=[]),n===void 0&&(n={}),e.map((s,a)=>{let i=[...r,String(a)],o=typeof s.id=="string"?s.id:i.join("-");if(Ke(s.index!==!0||!s.children,"Cannot specify children on an index route"),Ke(!n[o],'Found a route id collision on id "'+o+`".  Route id's must be globally unique within Data Router usages`),D4(s)){let l=Rt({},s,t(s),{id:o});return n[o]=l,l}else{let l=Rt({},s,t(s),{id:o,children:void 0});return n[o]=l,s.children&&(l.children=Ph(s.children,t,i,n)),l}})}function Si(e,t,r){return r===void 0&&(r="/"),Qf(e,t,r,!1)}function Qf(e,t,r,n){let s=typeof t=="string"?xi(t):t,a=ma(s.pathname||"/",r);if(a==null)return null;let i=dT(e);O4(i);let o=null;for(let l=0;o==null&&l<i.length;++l){let c=G4(a);o=W4(i[l],c,n)}return o}function F4(e,t){let{route:r,pathname:n,params:s}=e;return{id:r.id,pathname:n,params:s,data:t[r.id],handle:r.handle}}function dT(e,t,r,n){t===void 0&&(t=[]),r===void 0&&(r=[]),n===void 0&&(n="");let s=(a,i,o)=>{let l={relativePath:o===void 0?a.path||"":o,caseSensitive:a.caseSensitive===!0,childrenIndex:i,route:a};l.relativePath.startsWith("/")&&(Ke(l.relativePath.startsWith(n),'Absolute route path "'+l.relativePath+'" nested under path '+('"'+n+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),l.relativePath=l.relativePath.slice(n.length));let c=ia([n,l.relativePath]),u=r.concat(l);a.children&&a.children.length>0&&(Ke(a.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+c+'".')),dT(a.children,t,u,c)),!(a.path==null&&!a.index)&&t.push({path:c,score:z4(c,a.index),routesMeta:u})};return e.forEach((a,i)=>{var o;if(a.path===""||!((o=a.path)!=null&&o.includes("?")))s(a,i);else for(let l of mT(a.path))s(a,i,l)}),t}function mT(e){let t=e.split("/");if(t.length===0)return[];let[r,...n]=t,s=r.endsWith("?"),a=r.replace(/\?$/,"");if(n.length===0)return s?[a,""]:[a];let i=mT(n.join("/")),o=[];return o.push(...i.map(l=>l===""?a:[a,l].join("/"))),s&&o.push(...i),o.map(l=>e.startsWith("/")&&l===""?"/":l)}function O4(e){e.sort((t,r)=>t.score!==r.score?r.score-t.score:$4(t.routesMeta.map(n=>n.childrenIndex),r.routesMeta.map(n=>n.childrenIndex)))}const M4=/^:[\w-]+$/,L4=3,j4=2,U4=1,V4=10,B4=-2,iy=e=>e==="*";function z4(e,t){let r=e.split("/"),n=r.length;return r.some(iy)&&(n+=B4),t&&(n+=j4),r.filter(s=>!iy(s)).reduce((s,a)=>s+(M4.test(a)?L4:a===""?U4:V4),n)}function $4(e,t){return e.length===t.length&&e.slice(0,-1).every((n,s)=>n===t[s])?e[e.length-1]-t[t.length-1]:0}function W4(e,t,r){r===void 0&&(r=!1);let{routesMeta:n}=e,s={},a="/",i=[];for(let o=0;o<n.length;++o){let l=n[o],c=o===n.length-1,u=a==="/"?t:t.slice(a.length)||"/",d=Dh({path:l.relativePath,caseSensitive:l.caseSensitive,end:c},u),m=l.route;if(!d&&c&&r&&!n[n.length-1].route.index&&(d=Dh({path:l.relativePath,caseSensitive:l.caseSensitive,end:!1},u)),!d)return null;Object.assign(s,d.params),i.push({params:s,pathname:ia([a,d.pathname]),pathnameBase:X4(ia([a,d.pathnameBase])),route:m}),d.pathnameBase!=="/"&&(a=ia([a,d.pathnameBase]))}return i}function Dh(e,t){typeof e=="string"&&(e={path:e,caseSensitive:!1,end:!0});let[r,n]=H4(e.path,e.caseSensitive,e.end),s=t.match(r);if(!s)return null;let a=s[0],i=a.replace(/(.)\/+$/,"$1"),o=s.slice(1);return{params:n.reduce((c,u,d)=>{let{paramName:m,isOptional:p}=u;if(m==="*"){let g=o[d]||"";i=a.slice(0,a.length-g.length).replace(/(.)\/+$/,"$1")}const x=o[d];return p&&!x?c[m]=void 0:c[m]=(x||"").replace(/%2F/g,"/"),c},{}),pathname:a,pathnameBase:i,pattern:e}}function H4(e,t,r){t===void 0&&(t=!1),r===void 0&&(r=!0),il(e==="*"||!e.endsWith("*")||e.endsWith("/*"),'Route path "'+e+'" will be treated as if it were '+('"'+e.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+e.replace(/\*$/,"/*")+'".'));let n=[],s="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(i,o,l)=>(n.push({paramName:o,isOptional:l!=null}),l?"/?([^\\/]+)?":"/([^\\/]+)"));return e.endsWith("*")?(n.push({paramName:"*"}),s+=e==="*"||e==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):r?s+="\\/*$":e!==""&&e!=="/"&&(s+="(?:(?=\\/|$))"),[new RegExp(s,t?void 0:"i"),n]}function G4(e){try{return e.split("/").map(t=>decodeURIComponent(t).replace(/\//g,"%2F")).join("/")}catch(t){return il(!1,'The URL path "'+e+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+t+").")),e}}function ma(e,t){if(t==="/")return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let r=t.endsWith("/")?t.length-1:t.length,n=e.charAt(r);return n&&n!=="/"?null:e.slice(r)||"/"}function K4(e,t){t===void 0&&(t="/");let{pathname:r,search:n="",hash:s=""}=typeof e=="string"?xi(e):e;return{pathname:r?r.startsWith("/")?r:q4(r,t):t,search:Y4(n),hash:Q4(s)}}function q4(e,t){let r=t.replace(/\/+$/,"").split("/");return e.split("/").forEach(s=>{s===".."?r.length>1&&r.pop():s!=="."&&r.push(s)}),r.length>1?r.join("/"):"/"}function j0(e,t,r,n){return"Cannot include a '"+e+"' character in a manually specified "+("`to."+t+"` field ["+JSON.stringify(n)+"].  Please separate it out to the ")+("`to."+r+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function pT(e){return e.filter((t,r)=>r===0||t.route.path&&t.route.path.length>0)}function Cd(e,t){let r=pT(e);return t?r.map((n,s)=>s===r.length-1?n.pathname:n.pathnameBase):r.map(n=>n.pathnameBase)}function Nd(e,t,r,n){n===void 0&&(n=!1);let s;typeof e=="string"?s=xi(e):(s=Rt({},e),Ke(!s.pathname||!s.pathname.includes("?"),j0("?","pathname","search",s)),Ke(!s.pathname||!s.pathname.includes("#"),j0("#","pathname","hash",s)),Ke(!s.search||!s.search.includes("#"),j0("#","search","hash",s)));let a=e===""||s.pathname==="",i=a?"/":s.pathname,o;if(i==null)o=r;else{let d=t.length-1;if(!n&&i.startsWith("..")){let m=i.split("/");for(;m[0]==="..";)m.shift(),d-=1;s.pathname=m.join("/")}o=d>=0?t[d]:"/"}let l=K4(s,o),c=i&&i!=="/"&&i.endsWith("/"),u=(a||i===".")&&r.endsWith("/");return!l.pathname.endsWith("/")&&(c||u)&&(l.pathname+="/"),l}const ia=e=>e.join("/").replace(/\/\/+/g,"/"),X4=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),Y4=e=>!e||e==="?"?"":e.startsWith("?")?e:"?"+e,Q4=e=>!e||e==="#"?"":e.startsWith("#")?e:"#"+e;class Fh{constructor(t,r,n,s){s===void 0&&(s=!1),this.status=t,this.statusText=r||"",this.internal=s,n instanceof Error?(this.data=n.toString(),this.error=n):this.data=n}}function Qc(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.internal=="boolean"&&"data"in e}const gT=["post","put","patch","delete"],J4=new Set(gT),Z4=["get",...gT],eR=new Set(Z4),tR=new Set([301,302,303,307,308]),rR=new Set([307,308]),U0={state:"idle",location:void 0,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0},nR={state:"idle",data:void 0,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0},Gl={state:"unblocked",proceed:void 0,reset:void 0,location:void 0},zg=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,sR=e=>({hasErrorBoundary:!!e.hasErrorBoundary}),xT="remix-router-transitions";function aR(e){const t=e.window?e.window:typeof window<"u"?window:void 0,r=typeof t<"u"&&typeof t.document<"u"&&typeof t.document.createElement<"u",n=!r;Ke(e.routes.length>0,"You must provide a non-empty routes array to createRouter");let s;if(e.mapRouteProperties)s=e.mapRouteProperties;else if(e.detectErrorBoundary){let X=e.detectErrorBoundary;s=ee=>({hasErrorBoundary:X(ee)})}else s=sR;let a={},i=Ph(e.routes,s,void 0,a),o,l=e.basename||"/",c=e.dataStrategy||cR,u=e.patchRoutesOnNavigation,d=Rt({v7_fetcherPersist:!1,v7_normalizeFormMethod:!1,v7_partialHydration:!1,v7_prependBasename:!1,v7_relativeSplatPath:!1,v7_skipActionErrorRevalidation:!1},e.future),m=null,p=new Set,x=null,g=null,_=null,k=e.hydrationData!=null,T=Si(i,e.history.location,l),w=!1,C=null;if(T==null&&!u){let X=on(404,{pathname:e.history.location.pathname}),{matches:ee,route:ie}=xy(i);T=ee,C={[ie.id]:X}}T&&!e.hydrationData&&Ks(T,i,e.history.location.pathname).active&&(T=null);let M;if(T)if(T.some(X=>X.route.lazy))M=!1;else if(!T.some(X=>X.route.loader))M=!0;else if(d.v7_partialHydration){let X=e.hydrationData?e.hydrationData.loaderData:null,ee=e.hydrationData?e.hydrationData.errors:null;if(ee){let ie=T.findIndex(xe=>ee[xe.route.id]!==void 0);M=T.slice(0,ie+1).every(xe=>!np(xe.route,X,ee))}else M=T.every(ie=>!np(ie.route,X,ee))}else M=e.hydrationData!=null;else if(M=!1,T=[],d.v7_partialHydration){let X=Ks(null,i,e.history.location.pathname);X.active&&X.matches&&(w=!0,T=X.matches)}let O,v={historyAction:e.history.action,location:e.history.location,matches:T,initialized:M,navigation:U0,restoreScrollPosition:e.hydrationData!=null?!1:null,preventScrollReset:!1,revalidation:"idle",loaderData:e.hydrationData&&e.hydrationData.loaderData||{},actionData:e.hydrationData&&e.hydrationData.actionData||null,errors:e.hydrationData&&e.hydrationData.errors||C,fetchers:new Map,blockers:new Map},E=Zt.Pop,S=!1,R,P=!1,D=new Map,N=null,ce=!1,oe=!1,de=[],ge=new Set,Z=new Map,G=0,ae=-1,fe=new Map,B=new Set,K=new Map,q=new Map,W=new Set,Q=new Map,ue=new Map,Ee;function _e(){if(m=e.history.listen(X=>{let{action:ee,location:ie,delta:xe}=X;if(Ee){Ee(),Ee=void 0;return}il(ue.size===0||xe!=null,"You are trying to use a blocker on a POP navigation to a location that was not created by @remix-run/router. This will fail silently in production. This can happen if you are navigating outside the router via `window.history.pushState`/`window.location.hash` instead of using router navigation APIs.  This can also happen if you are using createHashRouter and the user manually changes the URL.");let Ie=Sa({currentLocation:v.location,nextLocation:ie,historyAction:ee});if(Ie&&xe!=null){let I=new Promise(U=>{Ee=U});e.history.go(xe*-1),ms(Ie,{state:"blocked",location:ie,proceed(){ms(Ie,{state:"proceeding",proceed:void 0,reset:void 0,location:ie}),I.then(()=>e.history.go(xe))},reset(){let U=new Map(v.blockers);U.set(Ie,Gl),H({blockers:U})}});return}return De(ee,ie)}),r){TR(t,D);let X=()=>kR(t,D);t.addEventListener("pagehide",X),N=()=>t.removeEventListener("pagehide",X)}return v.initialized||De(Zt.Pop,v.location,{initialHydration:!0}),O}function me(){m&&m(),N&&N(),p.clear(),R&&R.abort(),v.fetchers.forEach((X,ee)=>yt(ee)),v.blockers.forEach((X,ee)=>Ws(ee))}function je(X){return p.add(X),()=>p.delete(X)}function H(X,ee){ee===void 0&&(ee={}),v=Rt({},v,X);let ie=[],xe=[];d.v7_fetcherPersist&&v.fetchers.forEach((Ie,I)=>{Ie.state==="idle"&&(W.has(I)?xe.push(I):ie.push(I))}),W.forEach(Ie=>{!v.fetchers.has(Ie)&&!Z.has(Ie)&&xe.push(Ie)}),[...p].forEach(Ie=>Ie(v,{deletedFetchers:xe,viewTransitionOpts:ee.viewTransitionOpts,flushSync:ee.flushSync===!0})),d.v7_fetcherPersist?(ie.forEach(Ie=>v.fetchers.delete(Ie)),xe.forEach(Ie=>yt(Ie))):xe.forEach(Ie=>W.delete(Ie))}function tt(X,ee,ie){var xe,Ie;let{flushSync:I}=ie===void 0?{}:ie,U=v.actionData!=null&&v.navigation.formMethod!=null&&ts(v.navigation.formMethod)&&v.navigation.state==="loading"&&((xe=X.state)==null?void 0:xe._isRedirect)!==!0,b;ee.actionData?Object.keys(ee.actionData).length>0?b=ee.actionData:b=null:U?b=v.actionData:b=null;let F=ee.loaderData?py(v.loaderData,ee.loaderData,ee.matches||[],ee.errors):v.loaderData,L=v.blockers;L.size>0&&(L=new Map(L),L.forEach((ne,re)=>L.set(re,Gl)));let j=S===!0||v.navigation.formMethod!=null&&ts(v.navigation.formMethod)&&((Ie=X.state)==null?void 0:Ie._isRedirect)!==!0;o&&(i=o,o=void 0),ce||E===Zt.Pop||(E===Zt.Push?e.history.push(X,X.state):E===Zt.Replace&&e.history.replace(X,X.state));let Y;if(E===Zt.Pop){let ne=D.get(v.location.pathname);ne&&ne.has(X.pathname)?Y={currentLocation:v.location,nextLocation:X}:D.has(X.pathname)&&(Y={currentLocation:X,nextLocation:v.location})}else if(P){let ne=D.get(v.location.pathname);ne?ne.add(X.pathname):(ne=new Set([X.pathname]),D.set(v.location.pathname,ne)),Y={currentLocation:v.location,nextLocation:X}}H(Rt({},ee,{actionData:b,loaderData:F,historyAction:E,location:X,initialized:!0,navigation:U0,revalidation:"idle",restoreScrollPosition:Gs(X,ee.matches||v.matches),preventScrollReset:j,blockers:L}),{viewTransitionOpts:Y,flushSync:I===!0}),E=Zt.Pop,S=!1,P=!1,ce=!1,oe=!1,de=[]}async function He(X,ee){if(typeof X=="number"){e.history.go(X);return}let ie=rp(v.location,v.matches,l,d.v7_prependBasename,X,d.v7_relativeSplatPath,ee==null?void 0:ee.fromRouteId,ee==null?void 0:ee.relative),{path:xe,submission:Ie,error:I}=oy(d.v7_normalizeFormMethod,!1,ie,ee),U=v.location,b=Yc(v.location,xe,ee&&ee.state);b=Rt({},b,e.history.encodeLocation(b));let F=ee&&ee.replace!=null?ee.replace:void 0,L=Zt.Push;F===!0?L=Zt.Replace:F===!1||Ie!=null&&ts(Ie.formMethod)&&Ie.formAction===v.location.pathname+v.location.search&&(L=Zt.Replace);let j=ee&&"preventScrollReset"in ee?ee.preventScrollReset===!0:void 0,Y=(ee&&ee.flushSync)===!0,ne=Sa({currentLocation:U,nextLocation:b,historyAction:L});if(ne){ms(ne,{state:"blocked",location:b,proceed(){ms(ne,{state:"proceeding",proceed:void 0,reset:void 0,location:b}),He(X,ee)},reset(){let re=new Map(v.blockers);re.set(ne,Gl),H({blockers:re})}});return}return await De(L,b,{submission:Ie,pendingError:I,preventScrollReset:j,replace:ee&&ee.replace,enableViewTransition:ee&&ee.viewTransition,flushSync:Y})}function Je(){if(St(),H({revalidation:"loading"}),v.navigation.state!=="submitting"){if(v.navigation.state==="idle"){De(v.historyAction,v.location,{startUninterruptedRevalidation:!0});return}De(E||v.historyAction,v.navigation.location,{overrideNavigation:v.navigation,enableViewTransition:P===!0})}}async function De(X,ee,ie){R&&R.abort(),R=null,E=X,ce=(ie&&ie.startUninterruptedRevalidation)===!0,mo(v.location,v.matches),S=(ie&&ie.preventScrollReset)===!0,P=(ie&&ie.enableViewTransition)===!0;let xe=o||i,Ie=ie&&ie.overrideNavigation,I=ie!=null&&ie.initialHydration&&v.matches&&v.matches.length>0&&!w?v.matches:Si(xe,ee,l),U=(ie&&ie.flushSync)===!0;if(I&&v.initialized&&!oe&&pR(v.location,ee)&&!(ie&&ie.submission&&ts(ie.submission.formMethod))){tt(ee,{matches:I},{flushSync:U});return}let b=Ks(I,xe,ee.pathname);if(b.active&&b.matches&&(I=b.matches),!I){let{error:te,notFoundMatches:J,route:he}=qn(ee.pathname);tt(ee,{matches:J,loaderData:{},errors:{[he.id]:te}},{flushSync:U});return}R=new AbortController;let F=_o(e.history,ee,R.signal,ie&&ie.submission),L;if(ie&&ie.pendingError)L=[Ai(I).route.id,{type:pt.error,error:ie.pendingError}];else if(ie&&ie.submission&&ts(ie.submission.formMethod)){let te=await Ae(F,ee,ie.submission,I,b.active,{replace:ie.replace,flushSync:U});if(te.shortCircuited)return;if(te.pendingActionResult){let[J,he]=te.pendingActionResult;if(yn(he)&&Qc(he.error)&&he.error.status===404){R=null,tt(ee,{matches:te.matches,loaderData:{},errors:{[J]:he.error}});return}}I=te.matches||I,L=te.pendingActionResult,Ie=V0(ee,ie.submission),U=!1,b.active=!1,F=_o(e.history,F.url,F.signal)}let{shortCircuited:j,matches:Y,loaderData:ne,errors:re}=await _t(F,ee,I,b.active,Ie,ie&&ie.submission,ie&&ie.fetcherSubmission,ie&&ie.replace,ie&&ie.initialHydration===!0,U,L);j||(R=null,tt(ee,Rt({matches:Y||I},gy(L),{loaderData:ne,errors:re})))}async function Ae(X,ee,ie,xe,Ie,I){I===void 0&&(I={}),St();let U=wR(ee,ie);if(H({navigation:U},{flushSync:I.flushSync===!0}),Ie){let L=await bn(xe,ee.pathname,X.signal);if(L.type==="aborted")return{shortCircuited:!0};if(L.type==="error"){let j=Ai(L.partialMatches).route.id;return{matches:L.partialMatches,pendingActionResult:[j,{type:pt.error,error:L.error}]}}else if(L.matches)xe=L.matches;else{let{notFoundMatches:j,error:Y,route:ne}=qn(ee.pathname);return{matches:j,pendingActionResult:[ne.id,{type:pt.error,error:Y}]}}}let b,F=ec(xe,ee);if(!F.route.action&&!F.route.lazy)b={type:pt.error,error:on(405,{method:X.method,pathname:ee.pathname,routeId:F.route.id})};else if(b=(await fr("action",v,X,[F],xe,null))[F.route.id],X.signal.aborted)return{shortCircuited:!0};if(bi(b)){let L;return I&&I.replace!=null?L=I.replace:L=hy(b.response.headers.get("Location"),new URL(X.url),l)===v.location.pathname+v.location.search,await kt(X,b,!0,{submission:ie,replace:L}),{shortCircuited:!0}}if($a(b))throw on(400,{type:"defer-action"});if(yn(b)){let L=Ai(xe,F.route.id);return(I&&I.replace)!==!0&&(E=Zt.Push),{matches:xe,pendingActionResult:[L.route.id,b]}}return{matches:xe,pendingActionResult:[F.route.id,b]}}async function _t(X,ee,ie,xe,Ie,I,U,b,F,L,j){let Y=Ie||V0(ee,I),ne=I||U||yy(Y),re=!ce&&(!d.v7_partialHydration||!F);if(xe){if(re){let ht=ur(j);H(Rt({navigation:Y},ht!==void 0?{actionData:ht}:{}),{flushSync:L})}let Ge=await bn(ie,ee.pathname,X.signal);if(Ge.type==="aborted")return{shortCircuited:!0};if(Ge.type==="error"){let ht=Ai(Ge.partialMatches).route.id;return{matches:Ge.partialMatches,loaderData:{},errors:{[ht]:Ge.error}}}else if(Ge.matches)ie=Ge.matches;else{let{error:ht,notFoundMatches:xr,route:Pn}=qn(ee.pathname);return{matches:xr,loaderData:{},errors:{[Pn.id]:ht}}}}let te=o||i,[J,he]=cy(e.history,v,ie,ne,ee,d.v7_partialHydration&&F===!0,d.v7_skipActionErrorRevalidation,oe,de,ge,W,K,B,te,l,j);if(Hs(Ge=>!(ie&&ie.some(ht=>ht.route.id===Ge))||J&&J.some(ht=>ht.route.id===Ge)),ae=++G,J.length===0&&he.length===0){let Ge=$s();return tt(ee,Rt({matches:ie,loaderData:{},errors:j&&yn(j[1])?{[j[0]]:j[1].error}:null},gy(j),Ge?{fetchers:new Map(v.fetchers)}:{}),{flushSync:L}),{shortCircuited:!0}}if(re){let Ge={};if(!xe){Ge.navigation=Y;let ht=ur(j);ht!==void 0&&(Ge.actionData=ht)}he.length>0&&(Ge.fetchers=Nr(he)),H(Ge,{flushSync:L})}he.forEach(Ge=>{ft(Ge.key),Ge.controller&&Z.set(Ge.key,Ge.controller)});let Te=()=>he.forEach(Ge=>ft(Ge.key));R&&R.signal.addEventListener("abort",Te);let{loaderResults:Ce,fetcherResults:ve}=await vt(v,ie,J,he,X);if(X.signal.aborted)return{shortCircuited:!0};R&&R.signal.removeEventListener("abort",Te),he.forEach(Ge=>Z.delete(Ge.key));let ke=Tf(Ce);if(ke)return await kt(X,ke.result,!0,{replace:b}),{shortCircuited:!0};if(ke=Tf(ve),ke)return B.add(ke.key),await kt(X,ke.result,!0,{replace:b}),{shortCircuited:!0};let{loaderData:Fe,errors:it}=my(v,ie,Ce,j,he,ve,Q);Q.forEach((Ge,ht)=>{Ge.subscribe(xr=>{(xr||Ge.done)&&Q.delete(ht)})}),d.v7_partialHydration&&F&&v.errors&&(it=Rt({},v.errors,it));let qe=$s(),mt=ho(ae),an=qe||mt||he.length>0;return Rt({matches:ie,loaderData:Fe,errors:it},an?{fetchers:new Map(v.fetchers)}:{})}function ur(X){if(X&&!yn(X[1]))return{[X[0]]:X[1].data};if(v.actionData)return Object.keys(v.actionData).length===0?null:v.actionData}function Nr(X){return X.forEach(ee=>{let ie=v.fetchers.get(ee.key),xe=Kl(void 0,ie?ie.data:void 0);v.fetchers.set(ee.key,xe)}),new Map(v.fetchers)}function nn(X,ee,ie,xe){if(n)throw new Error("router.fetch() was called during the server render, but it shouldn't be. You are likely calling a useFetcher() method in the body of your component. Try moving it to a useEffect or a callback.");ft(X);let Ie=(xe&&xe.flushSync)===!0,I=o||i,U=rp(v.location,v.matches,l,d.v7_prependBasename,ie,d.v7_relativeSplatPath,ee,xe==null?void 0:xe.relative),b=Si(I,U,l),F=Ks(b,I,U);if(F.active&&F.matches&&(b=F.matches),!b){Dt(X,ee,on(404,{pathname:U}),{flushSync:Ie});return}let{path:L,submission:j,error:Y}=oy(d.v7_normalizeFormMethod,!0,U,xe);if(Y){Dt(X,ee,Y,{flushSync:Ie});return}let ne=ec(b,L),re=(xe&&xe.preventScrollReset)===!0;if(j&&ts(j.formMethod)){zs(X,ee,L,ne,b,F.active,Ie,re,j);return}K.set(X,{routeId:ee,path:L}),sn(X,ee,L,ne,b,F.active,Ie,re,j)}async function zs(X,ee,ie,xe,Ie,I,U,b,F){St(),K.delete(X);function L(rt){if(!rt.route.action&&!rt.route.lazy){let gs=on(405,{method:F.formMethod,pathname:ie,routeId:ee});return Dt(X,ee,gs,{flushSync:U}),!0}return!1}if(!I&&L(xe))return;let j=v.fetchers.get(X);dt(X,ER(F,j),{flushSync:U});let Y=new AbortController,ne=_o(e.history,ie,Y.signal,F);if(I){let rt=await bn(Ie,new URL(ne.url).pathname,ne.signal,X);if(rt.type==="aborted")return;if(rt.type==="error"){Dt(X,ee,rt.error,{flushSync:U});return}else if(rt.matches){if(Ie=rt.matches,xe=ec(Ie,ie),L(xe))return}else{Dt(X,ee,on(404,{pathname:ie}),{flushSync:U});return}}Z.set(X,Y);let re=G,J=(await fr("action",v,ne,[xe],Ie,X))[xe.route.id];if(ne.signal.aborted){Z.get(X)===Y&&Z.delete(X);return}if(d.v7_fetcherPersist&&W.has(X)){if(bi(J)||yn(J)){dt(X,Pa(void 0));return}}else{if(bi(J))if(Z.delete(X),ae>re){dt(X,Pa(void 0));return}else return B.add(X),dt(X,Kl(F)),kt(ne,J,!1,{fetcherSubmission:F,preventScrollReset:b});if(yn(J)){Dt(X,ee,J.error);return}}if($a(J))throw on(400,{type:"defer-action"});let he=v.navigation.location||v.location,Te=_o(e.history,he,Y.signal),Ce=o||i,ve=v.navigation.state!=="idle"?Si(Ce,v.navigation.location,l):v.matches;Ke(ve,"Didn't find any matches after fetcher action");let ke=++G;fe.set(X,ke);let Fe=Kl(F,J.data);v.fetchers.set(X,Fe);let[it,qe]=cy(e.history,v,ve,F,he,!1,d.v7_skipActionErrorRevalidation,oe,de,ge,W,K,B,Ce,l,[xe.route.id,J]);qe.filter(rt=>rt.key!==X).forEach(rt=>{let gs=rt.key,Rl=v.fetchers.get(gs),Ku=Kl(void 0,Rl?Rl.data:void 0);v.fetchers.set(gs,Ku),ft(gs),rt.controller&&Z.set(gs,rt.controller)}),H({fetchers:new Map(v.fetchers)});let mt=()=>qe.forEach(rt=>ft(rt.key));Y.signal.addEventListener("abort",mt);let{loaderResults:an,fetcherResults:Ge}=await vt(v,ve,it,qe,Te);if(Y.signal.aborted)return;Y.signal.removeEventListener("abort",mt),fe.delete(X),Z.delete(X),qe.forEach(rt=>Z.delete(rt.key));let ht=Tf(an);if(ht)return kt(Te,ht.result,!1,{preventScrollReset:b});if(ht=Tf(Ge),ht)return B.add(ht.key),kt(Te,ht.result,!1,{preventScrollReset:b});let{loaderData:xr,errors:Pn}=my(v,ve,an,void 0,qe,Ge,Q);if(v.fetchers.has(X)){let rt=Pa(J.data);v.fetchers.set(X,rt)}ho(ke),v.navigation.state==="loading"&&ke>ae?(Ke(E,"Expected pending action"),R&&R.abort(),tt(v.navigation.location,{matches:ve,loaderData:xr,errors:Pn,fetchers:new Map(v.fetchers)})):(H({errors:Pn,loaderData:py(v.loaderData,xr,ve,Pn),fetchers:new Map(v.fetchers)}),oe=!1)}async function sn(X,ee,ie,xe,Ie,I,U,b,F){let L=v.fetchers.get(X);dt(X,Kl(F,L?L.data:void 0),{flushSync:U});let j=new AbortController,Y=_o(e.history,ie,j.signal);if(I){let J=await bn(Ie,new URL(Y.url).pathname,Y.signal,X);if(J.type==="aborted")return;if(J.type==="error"){Dt(X,ee,J.error,{flushSync:U});return}else if(J.matches)Ie=J.matches,xe=ec(Ie,ie);else{Dt(X,ee,on(404,{pathname:ie}),{flushSync:U});return}}Z.set(X,j);let ne=G,te=(await fr("loader",v,Y,[xe],Ie,X))[xe.route.id];if($a(te)&&(te=await $g(te,Y.signal,!0)||te),Z.get(X)===j&&Z.delete(X),!Y.signal.aborted){if(W.has(X)){dt(X,Pa(void 0));return}if(bi(te))if(ae>ne){dt(X,Pa(void 0));return}else{B.add(X),await kt(Y,te,!1,{preventScrollReset:b});return}if(yn(te)){Dt(X,ee,te.error);return}Ke(!$a(te),"Unhandled fetcher deferred data"),dt(X,Pa(te.data))}}async function kt(X,ee,ie,xe){let{submission:Ie,fetcherSubmission:I,preventScrollReset:U,replace:b}=xe===void 0?{}:xe;ee.response.headers.has("X-Remix-Revalidate")&&(oe=!0);let F=ee.response.headers.get("Location");Ke(F,"Expected a Location header on the redirect Response"),F=hy(F,new URL(X.url),l);let L=Yc(v.location,F,{_isRedirect:!0});if(r){let J=!1;if(ee.response.headers.has("X-Remix-Reload-Document"))J=!0;else if(zg.test(F)){const he=e.history.createURL(F);J=he.origin!==t.location.origin||ma(he.pathname,l)==null}if(J){b?t.location.replace(F):t.location.assign(F);return}}R=null;let j=b===!0||ee.response.headers.has("X-Remix-Replace")?Zt.Replace:Zt.Push,{formMethod:Y,formAction:ne,formEncType:re}=v.navigation;!Ie&&!I&&Y&&ne&&re&&(Ie=yy(v.navigation));let te=Ie||I;if(rR.has(ee.response.status)&&te&&ts(te.formMethod))await De(j,L,{submission:Rt({},te,{formAction:F}),preventScrollReset:U||S,enableViewTransition:ie?P:void 0});else{let J=V0(L,Ie);await De(j,L,{overrideNavigation:J,fetcherSubmission:I,preventScrollReset:U||S,enableViewTransition:ie?P:void 0})}}async function fr(X,ee,ie,xe,Ie,I){let U,b={};try{U=await uR(c,X,ee,ie,xe,Ie,I,a,s)}catch(F){return xe.forEach(L=>{b[L.route.id]={type:pt.error,error:F}}),b}for(let[F,L]of Object.entries(U))if(gR(L)){let j=L.result;b[F]={type:pt.redirect,response:dR(j,ie,F,Ie,l,d.v7_relativeSplatPath)}}else b[F]=await hR(L);return b}async function vt(X,ee,ie,xe,Ie){let I=X.matches,U=fr("loader",X,Ie,ie,ee,null),b=Promise.all(xe.map(async j=>{if(j.matches&&j.match&&j.controller){let ne=(await fr("loader",X,_o(e.history,j.path,j.controller.signal),[j.match],j.matches,j.key))[j.match.route.id];return{[j.key]:ne}}else return Promise.resolve({[j.key]:{type:pt.error,error:on(404,{pathname:j.path})}})})),F=await U,L=(await b).reduce((j,Y)=>Object.assign(j,Y),{});return await Promise.all([yR(ee,F,Ie.signal,I,X.loaderData),_R(ee,L,xe)]),{loaderResults:F,fetcherResults:L}}function St(){oe=!0,de.push(...Hs()),K.forEach((X,ee)=>{Z.has(ee)&&ge.add(ee),ft(ee)})}function dt(X,ee,ie){ie===void 0&&(ie={}),v.fetchers.set(X,ee),H({fetchers:new Map(v.fetchers)},{flushSync:(ie&&ie.flushSync)===!0})}function Dt(X,ee,ie,xe){xe===void 0&&(xe={});let Ie=Ai(v.matches,ee);yt(X),H({errors:{[Ie.route.id]:ie},fetchers:new Map(v.fetchers)},{flushSync:(xe&&xe.flushSync)===!0})}function Ue(X){return q.set(X,(q.get(X)||0)+1),W.has(X)&&W.delete(X),v.fetchers.get(X)||nR}function yt(X){let ee=v.fetchers.get(X);Z.has(X)&&!(ee&&ee.state==="loading"&&fe.has(X))&&ft(X),K.delete(X),fe.delete(X),B.delete(X),d.v7_fetcherPersist&&W.delete(X),ge.delete(X),v.fetchers.delete(X)}function qt(X){let ee=(q.get(X)||0)-1;ee<=0?(q.delete(X),W.add(X),d.v7_fetcherPersist||yt(X)):q.set(X,ee),H({fetchers:new Map(v.fetchers)})}function ft(X){let ee=Z.get(X);ee&&(ee.abort(),Z.delete(X))}function gn(X){for(let ee of X){let ie=Ue(ee),xe=Pa(ie.data);v.fetchers.set(ee,xe)}}function $s(){let X=[],ee=!1;for(let ie of B){let xe=v.fetchers.get(ie);Ke(xe,"Expected fetcher: "+ie),xe.state==="loading"&&(B.delete(ie),X.push(ie),ee=!0)}return gn(X),ee}function ho(X){let ee=[];for(let[ie,xe]of fe)if(xe<X){let Ie=v.fetchers.get(ie);Ke(Ie,"Expected fetcher: "+ie),Ie.state==="loading"&&(ft(ie),fe.delete(ie),ee.push(ie))}return gn(ee),ee.length>0}function Nl(X,ee){let ie=v.blockers.get(X)||Gl;return ue.get(X)!==ee&&ue.set(X,ee),ie}function Ws(X){v.blockers.delete(X),ue.delete(X)}function ms(X,ee){let ie=v.blockers.get(X)||Gl;Ke(ie.state==="unblocked"&&ee.state==="blocked"||ie.state==="blocked"&&ee.state==="blocked"||ie.state==="blocked"&&ee.state==="proceeding"||ie.state==="blocked"&&ee.state==="unblocked"||ie.state==="proceeding"&&ee.state==="unblocked","Invalid blocker state transition: "+ie.state+" -> "+ee.state);let xe=new Map(v.blockers);xe.set(X,ee),H({blockers:xe})}function Sa(X){let{currentLocation:ee,nextLocation:ie,historyAction:xe}=X;if(ue.size===0)return;ue.size>1&&il(!1,"A router only supports one blocker at a time");let Ie=Array.from(ue.entries()),[I,U]=Ie[Ie.length-1],b=v.blockers.get(I);if(!(b&&b.state==="proceeding")&&U({currentLocation:ee,nextLocation:ie,historyAction:xe}))return I}function qn(X){let ee=on(404,{pathname:X}),ie=o||i,{matches:xe,route:Ie}=xy(ie);return Hs(),{notFoundMatches:xe,route:Ie,error:ee}}function Hs(X){let ee=[];return Q.forEach((ie,xe)=>{(!X||X(xe))&&(ie.cancel(),ee.push(xe),Q.delete(xe))}),ee}function ps(X,ee,ie){if(x=X,_=ee,g=ie||null,!k&&v.navigation===U0){k=!0;let xe=Gs(v.location,v.matches);xe!=null&&H({restoreScrollPosition:xe})}return()=>{x=null,_=null,g=null}}function Rn(X,ee){return g&&g(X,ee.map(xe=>F4(xe,v.loaderData)))||X.key}function mo(X,ee){if(x&&_){let ie=Rn(X,ee);x[ie]=_()}}function Gs(X,ee){if(x){let ie=Rn(X,ee),xe=x[ie];if(typeof xe=="number")return xe}return null}function Ks(X,ee,ie){if(u)if(X){if(Object.keys(X[0].params).length>0)return{active:!0,matches:Qf(ee,ie,l,!0)}}else return{active:!0,matches:Qf(ee,ie,l,!0)||[]};return{active:!1,matches:null}}async function bn(X,ee,ie,xe){if(!u)return{type:"success",matches:X};let Ie=X;for(;;){let I=o==null,U=o||i,b=a;try{await u({signal:ie,path:ee,matches:Ie,fetcherKey:xe,patch:(j,Y)=>{ie.aborted||fy(j,Y,U,b,s)}})}catch(j){return{type:"error",error:j,partialMatches:Ie}}finally{I&&!ie.aborted&&(i=[...i])}if(ie.aborted)return{type:"aborted"};let F=Si(U,ee,l);if(F)return{type:"success",matches:F};let L=Qf(U,ee,l,!0);if(!L||Ie.length===L.length&&Ie.every((j,Y)=>j.route.id===L[Y].route.id))return{type:"success",matches:null};Ie=L}}function po(X){a={},o=Ph(X,s,void 0,a)}function rr(X,ee){let ie=o==null;fy(X,ee,o||i,a,s),ie&&(i=[...i],H({}))}return O={get basename(){return l},get future(){return d},get state(){return v},get routes(){return i},get window(){return t},initialize:_e,subscribe:je,enableScrollRestoration:ps,navigate:He,fetch:nn,revalidate:Je,createHref:X=>e.history.createHref(X),encodeLocation:X=>e.history.encodeLocation(X),getFetcher:Ue,deleteFetcher:qt,dispose:me,getBlocker:Nl,deleteBlocker:Ws,patchRoutes:rr,_internalFetchControllers:Z,_internalActiveDeferreds:Q,_internalSetRoutes:po},O}function iR(e){return e!=null&&("formData"in e&&e.formData!=null||"body"in e&&e.body!==void 0)}function rp(e,t,r,n,s,a,i,o){let l,c;if(i){l=[];for(let d of t)if(l.push(d),d.route.id===i){c=d;break}}else l=t,c=t[t.length-1];let u=Nd(s||".",Cd(l,a),ma(e.pathname,r)||e.pathname,o==="path");if(s==null&&(u.search=e.search,u.hash=e.hash),(s==null||s===""||s===".")&&c){let d=Wg(u.search);if(c.route.index&&!d)u.search=u.search?u.search.replace(/^\?/,"?index&"):"?index";else if(!c.route.index&&d){let m=new URLSearchParams(u.search),p=m.getAll("index");m.delete("index"),p.filter(g=>g).forEach(g=>m.append("index",g));let x=m.toString();u.search=x?"?"+x:""}}return n&&r!=="/"&&(u.pathname=u.pathname==="/"?r:ia([r,u.pathname])),Gi(u)}function oy(e,t,r,n){if(!n||!iR(n))return{path:r};if(n.formMethod&&!vR(n.formMethod))return{path:r,error:on(405,{method:n.formMethod})};let s=()=>({path:r,error:on(400,{type:"invalid-body"})}),a=n.formMethod||"get",i=e?a.toUpperCase():a.toLowerCase(),o=_T(r);if(n.body!==void 0){if(n.formEncType==="text/plain"){if(!ts(i))return s();let m=typeof n.body=="string"?n.body:n.body instanceof FormData||n.body instanceof URLSearchParams?Array.from(n.body.entries()).reduce((p,x)=>{let[g,_]=x;return""+p+g+"="+_+`
`},""):String(n.body);return{path:r,submission:{formMethod:i,formAction:o,formEncType:n.formEncType,formData:void 0,json:void 0,text:m}}}else if(n.formEncType==="application/json"){if(!ts(i))return s();try{let m=typeof n.body=="string"?JSON.parse(n.body):n.body;return{path:r,submission:{formMethod:i,formAction:o,formEncType:n.formEncType,formData:void 0,json:m,text:void 0}}}catch{return s()}}}Ke(typeof FormData=="function","FormData is not available in this environment");let l,c;if(n.formData)l=sp(n.formData),c=n.formData;else if(n.body instanceof FormData)l=sp(n.body),c=n.body;else if(n.body instanceof URLSearchParams)l=n.body,c=dy(l);else if(n.body==null)l=new URLSearchParams,c=new FormData;else try{l=new URLSearchParams(n.body),c=dy(l)}catch{return s()}let u={formMethod:i,formAction:o,formEncType:n&&n.formEncType||"application/x-www-form-urlencoded",formData:c,json:void 0,text:void 0};if(ts(u.formMethod))return{path:r,submission:u};let d=xi(r);return t&&d.search&&Wg(d.search)&&l.append("index",""),d.search="?"+l,{path:Gi(d),submission:u}}function ly(e,t,r){r===void 0&&(r=!1);let n=e.findIndex(s=>s.route.id===t);return n>=0?e.slice(0,r?n+1:n):e}function cy(e,t,r,n,s,a,i,o,l,c,u,d,m,p,x,g){let _=g?yn(g[1])?g[1].error:g[1].data:void 0,k=e.createURL(t.location),T=e.createURL(s),w=r;a&&t.errors?w=ly(r,Object.keys(t.errors)[0],!0):g&&yn(g[1])&&(w=ly(r,g[0]));let C=g?g[1].statusCode:void 0,M=i&&C&&C>=400,O=w.filter((E,S)=>{let{route:R}=E;if(R.lazy)return!0;if(R.loader==null)return!1;if(a)return np(R,t.loaderData,t.errors);if(oR(t.loaderData,t.matches[S],E)||l.some(N=>N===E.route.id))return!0;let P=t.matches[S],D=E;return uy(E,Rt({currentUrl:k,currentParams:P.params,nextUrl:T,nextParams:D.params},n,{actionResult:_,actionStatus:C,defaultShouldRevalidate:M?!1:o||k.pathname+k.search===T.pathname+T.search||k.search!==T.search||vT(P,D)}))}),v=[];return d.forEach((E,S)=>{if(a||!r.some(ce=>ce.route.id===E.routeId)||u.has(S))return;let R=Si(p,E.path,x);if(!R){v.push({key:S,routeId:E.routeId,path:E.path,matches:null,match:null,controller:null});return}let P=t.fetchers.get(S),D=ec(R,E.path),N=!1;m.has(S)?N=!1:c.has(S)?(c.delete(S),N=!0):P&&P.state!=="idle"&&P.data===void 0?N=o:N=uy(D,Rt({currentUrl:k,currentParams:t.matches[t.matches.length-1].params,nextUrl:T,nextParams:r[r.length-1].params},n,{actionResult:_,actionStatus:C,defaultShouldRevalidate:M?!1:o})),N&&v.push({key:S,routeId:E.routeId,path:E.path,matches:R,match:D,controller:new AbortController})}),[O,v]}function np(e,t,r){if(e.lazy)return!0;if(!e.loader)return!1;let n=t!=null&&t[e.id]!==void 0,s=r!=null&&r[e.id]!==void 0;return!n&&s?!1:typeof e.loader=="function"&&e.loader.hydrate===!0?!0:!n&&!s}function oR(e,t,r){let n=!t||r.route.id!==t.route.id,s=e[r.route.id]===void 0;return n||s}function vT(e,t){let r=e.route.path;return e.pathname!==t.pathname||r!=null&&r.endsWith("*")&&e.params["*"]!==t.params["*"]}function uy(e,t){if(e.route.shouldRevalidate){let r=e.route.shouldRevalidate(t);if(typeof r=="boolean")return r}return t.defaultShouldRevalidate}function fy(e,t,r,n,s){var a;let i;if(e){let c=n[e];Ke(c,"No route found to patch children into: routeId = "+e),c.children||(c.children=[]),i=c.children}else i=r;let o=t.filter(c=>!i.some(u=>yT(c,u))),l=Ph(o,s,[e||"_","patch",String(((a=i)==null?void 0:a.length)||"0")],n);i.push(...l)}function yT(e,t){return"id"in e&&"id"in t&&e.id===t.id?!0:e.index===t.index&&e.path===t.path&&e.caseSensitive===t.caseSensitive?(!e.children||e.children.length===0)&&(!t.children||t.children.length===0)?!0:e.children.every((r,n)=>{var s;return(s=t.children)==null?void 0:s.some(a=>yT(r,a))}):!1}async function lR(e,t,r){if(!e.lazy)return;let n=await e.lazy();if(!e.lazy)return;let s=r[e.id];Ke(s,"No route found in manifest");let a={};for(let i in n){let l=s[i]!==void 0&&i!=="hasErrorBoundary";il(!l,'Route "'+s.id+'" has a static property "'+i+'" defined but its lazy function is also returning a value for this property. '+('The lazy route property "'+i+'" will be ignored.')),!l&&!P4.has(i)&&(a[i]=n[i])}Object.assign(s,a),Object.assign(s,Rt({},t(s),{lazy:void 0}))}async function cR(e){let{matches:t}=e,r=t.filter(s=>s.shouldLoad);return(await Promise.all(r.map(s=>s.resolve()))).reduce((s,a,i)=>Object.assign(s,{[r[i].route.id]:a}),{})}async function uR(e,t,r,n,s,a,i,o,l,c){let u=a.map(p=>p.route.lazy?lR(p.route,l,o):void 0),d=a.map((p,x)=>{let g=u[x],_=s.some(T=>T.route.id===p.route.id);return Rt({},p,{shouldLoad:_,resolve:async T=>(T&&n.method==="GET"&&(p.route.lazy||p.route.loader)&&(_=!0),_?fR(t,n,p,g,T,c):Promise.resolve({type:pt.data,result:void 0}))})}),m=await e({matches:d,request:n,params:a[0].params,fetcherKey:i,context:c});try{await Promise.all(u)}catch{}return m}async function fR(e,t,r,n,s,a){let i,o,l=c=>{let u,d=new Promise((x,g)=>u=g);o=()=>u(),t.signal.addEventListener("abort",o);let m=x=>typeof c!="function"?Promise.reject(new Error("You cannot call the handler for a route which defines a boolean "+('"'+e+'" [routeId: '+r.route.id+"]"))):c({request:t,params:r.params,context:a},...x!==void 0?[x]:[]),p=(async()=>{try{return{type:"data",result:await(s?s(g=>m(g)):m())}}catch(x){return{type:"error",result:x}}})();return Promise.race([p,d])};try{let c=r.route[e];if(n)if(c){let u,[d]=await Promise.all([l(c).catch(m=>{u=m}),n]);if(u!==void 0)throw u;i=d}else if(await n,c=r.route[e],c)i=await l(c);else if(e==="action"){let u=new URL(t.url),d=u.pathname+u.search;throw on(405,{method:t.method,pathname:d,routeId:r.route.id})}else return{type:pt.data,result:void 0};else if(c)i=await l(c);else{let u=new URL(t.url),d=u.pathname+u.search;throw on(404,{pathname:d})}Ke(i.result!==void 0,"You defined "+(e==="action"?"an action":"a loader")+" for route "+('"'+r.route.id+"\" but didn't return anything from your `"+e+"` ")+"function. Please return a value or `null`.")}catch(c){return{type:pt.error,result:c}}finally{o&&t.signal.removeEventListener("abort",o)}return i}async function hR(e){let{result:t,type:r}=e;if(wT(t)){let d;try{let m=t.headers.get("Content-Type");m&&/\bapplication\/json\b/.test(m)?t.body==null?d=null:d=await t.json():d=await t.text()}catch(m){return{type:pt.error,error:m}}return r===pt.error?{type:pt.error,error:new Fh(t.status,t.statusText,d),statusCode:t.status,headers:t.headers}:{type:pt.data,data:d,statusCode:t.status,headers:t.headers}}if(r===pt.error){if(vy(t)){var n,s;if(t.data instanceof Error){var a,i;return{type:pt.error,error:t.data,statusCode:(a=t.init)==null?void 0:a.status,headers:(i=t.init)!=null&&i.headers?new Headers(t.init.headers):void 0}}return{type:pt.error,error:new Fh(((n=t.init)==null?void 0:n.status)||500,void 0,t.data),statusCode:Qc(t)?t.status:void 0,headers:(s=t.init)!=null&&s.headers?new Headers(t.init.headers):void 0}}return{type:pt.error,error:t,statusCode:Qc(t)?t.status:void 0}}if(xR(t)){var o,l;return{type:pt.deferred,deferredData:t,statusCode:(o=t.init)==null?void 0:o.status,headers:((l=t.init)==null?void 0:l.headers)&&new Headers(t.init.headers)}}if(vy(t)){var c,u;return{type:pt.data,data:t.data,statusCode:(c=t.init)==null?void 0:c.status,headers:(u=t.init)!=null&&u.headers?new Headers(t.init.headers):void 0}}return{type:pt.data,data:t}}function dR(e,t,r,n,s,a){let i=e.headers.get("Location");if(Ke(i,"Redirects returned/thrown from loaders/actions must have a Location header"),!zg.test(i)){let o=n.slice(0,n.findIndex(l=>l.route.id===r)+1);i=rp(new URL(t.url),o,s,!0,i,a),e.headers.set("Location",i)}return e}function hy(e,t,r){if(zg.test(e)){let n=e,s=n.startsWith("//")?new URL(t.protocol+n):new URL(n),a=ma(s.pathname,r)!=null;if(s.origin===t.origin&&a)return s.pathname+s.search+s.hash}return e}function _o(e,t,r,n){let s=e.createURL(_T(t)).toString(),a={signal:r};if(n&&ts(n.formMethod)){let{formMethod:i,formEncType:o}=n;a.method=i.toUpperCase(),o==="application/json"?(a.headers=new Headers({"Content-Type":o}),a.body=JSON.stringify(n.json)):o==="text/plain"?a.body=n.text:o==="application/x-www-form-urlencoded"&&n.formData?a.body=sp(n.formData):a.body=n.formData}return new Request(s,a)}function sp(e){let t=new URLSearchParams;for(let[r,n]of e.entries())t.append(r,typeof n=="string"?n:n.name);return t}function dy(e){let t=new FormData;for(let[r,n]of e.entries())t.append(r,n);return t}function mR(e,t,r,n,s){let a={},i=null,o,l=!1,c={},u=r&&yn(r[1])?r[1].error:void 0;return e.forEach(d=>{if(!(d.route.id in t))return;let m=d.route.id,p=t[m];if(Ke(!bi(p),"Cannot handle redirect results in processLoaderData"),yn(p)){let x=p.error;u!==void 0&&(x=u,u=void 0),i=i||{};{let g=Ai(e,m);i[g.route.id]==null&&(i[g.route.id]=x)}a[m]=void 0,l||(l=!0,o=Qc(p.error)?p.error.status:500),p.headers&&(c[m]=p.headers)}else $a(p)?(n.set(m,p.deferredData),a[m]=p.deferredData.data,p.statusCode!=null&&p.statusCode!==200&&!l&&(o=p.statusCode),p.headers&&(c[m]=p.headers)):(a[m]=p.data,p.statusCode&&p.statusCode!==200&&!l&&(o=p.statusCode),p.headers&&(c[m]=p.headers))}),u!==void 0&&r&&(i={[r[0]]:u},a[r[0]]=void 0),{loaderData:a,errors:i,statusCode:o||200,loaderHeaders:c}}function my(e,t,r,n,s,a,i){let{loaderData:o,errors:l}=mR(t,r,n,i);return s.forEach(c=>{let{key:u,match:d,controller:m}=c,p=a[u];if(Ke(p,"Did not find corresponding fetcher result"),!(m&&m.signal.aborted))if(yn(p)){let x=Ai(e.matches,d==null?void 0:d.route.id);l&&l[x.route.id]||(l=Rt({},l,{[x.route.id]:p.error})),e.fetchers.delete(u)}else if(bi(p))Ke(!1,"Unhandled fetcher revalidation redirect");else if($a(p))Ke(!1,"Unhandled fetcher deferred data");else{let x=Pa(p.data);e.fetchers.set(u,x)}}),{loaderData:o,errors:l}}function py(e,t,r,n){let s=Rt({},t);for(let a of r){let i=a.route.id;if(t.hasOwnProperty(i)?t[i]!==void 0&&(s[i]=t[i]):e[i]!==void 0&&a.route.loader&&(s[i]=e[i]),n&&n.hasOwnProperty(i))break}return s}function gy(e){return e?yn(e[1])?{actionData:{}}:{actionData:{[e[0]]:e[1].data}}:{}}function Ai(e,t){return(t?e.slice(0,e.findIndex(n=>n.route.id===t)+1):[...e]).reverse().find(n=>n.route.hasErrorBoundary===!0)||e[0]}function xy(e){let t=e.length===1?e[0]:e.find(r=>r.index||!r.path||r.path==="/")||{id:"__shim-error-route__"};return{matches:[{params:{},pathname:"",pathnameBase:"",route:t}],route:t}}function on(e,t){let{pathname:r,routeId:n,method:s,type:a,message:i}=t===void 0?{}:t,o="Unknown Server Error",l="Unknown @remix-run/router error";return e===400?(o="Bad Request",s&&r&&n?l="You made a "+s+' request to "'+r+'" but '+('did not provide a `loader` for route "'+n+'", ')+"so there is no way to handle the request.":a==="defer-action"?l="defer() is not supported in actions":a==="invalid-body"&&(l="Unable to encode submission body")):e===403?(o="Forbidden",l='Route "'+n+'" does not match URL "'+r+'"'):e===404?(o="Not Found",l='No route matches URL "'+r+'"'):e===405&&(o="Method Not Allowed",s&&r&&n?l="You made a "+s.toUpperCase()+' request to "'+r+'" but '+('did not provide an `action` for route "'+n+'", ')+"so there is no way to handle the request.":s&&(l='Invalid request method "'+s.toUpperCase()+'"')),new Fh(e||500,o,new Error(l),!0)}function Tf(e){let t=Object.entries(e);for(let r=t.length-1;r>=0;r--){let[n,s]=t[r];if(bi(s))return{key:n,result:s}}}function _T(e){let t=typeof e=="string"?xi(e):e;return Gi(Rt({},t,{hash:""}))}function pR(e,t){return e.pathname!==t.pathname||e.search!==t.search?!1:e.hash===""?t.hash!=="":e.hash===t.hash?!0:t.hash!==""}function gR(e){return wT(e.result)&&tR.has(e.result.status)}function $a(e){return e.type===pt.deferred}function yn(e){return e.type===pt.error}function bi(e){return(e&&e.type)===pt.redirect}function vy(e){return typeof e=="object"&&e!=null&&"type"in e&&"data"in e&&"init"in e&&e.type==="DataWithResponseInit"}function xR(e){let t=e;return t&&typeof t=="object"&&typeof t.data=="object"&&typeof t.subscribe=="function"&&typeof t.cancel=="function"&&typeof t.resolveData=="function"}function wT(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.headers=="object"&&typeof e.body<"u"}function vR(e){return eR.has(e.toLowerCase())}function ts(e){return J4.has(e.toLowerCase())}async function yR(e,t,r,n,s){let a=Object.entries(t);for(let i=0;i<a.length;i++){let[o,l]=a[i],c=e.find(m=>(m==null?void 0:m.route.id)===o);if(!c)continue;let u=n.find(m=>m.route.id===c.route.id),d=u!=null&&!vT(u,c)&&(s&&s[c.route.id])!==void 0;$a(l)&&d&&await $g(l,r,!1).then(m=>{m&&(t[o]=m)})}}async function _R(e,t,r){for(let n=0;n<r.length;n++){let{key:s,routeId:a,controller:i}=r[n],o=t[s];e.find(c=>(c==null?void 0:c.route.id)===a)&&$a(o)&&(Ke(i,"Expected an AbortController for revalidating fetcher deferred result"),await $g(o,i.signal,!0).then(c=>{c&&(t[s]=c)}))}}async function $g(e,t,r){if(r===void 0&&(r=!1),!await e.deferredData.resolveData(t)){if(r)try{return{type:pt.data,data:e.deferredData.unwrappedData}}catch(s){return{type:pt.error,error:s}}return{type:pt.data,data:e.deferredData.data}}}function Wg(e){return new URLSearchParams(e).getAll("index").some(t=>t==="")}function ec(e,t){let r=typeof t=="string"?xi(t).search:t.search;if(e[e.length-1].route.index&&Wg(r||""))return e[e.length-1];let n=pT(e);return n[n.length-1]}function yy(e){let{formMethod:t,formAction:r,formEncType:n,text:s,formData:a,json:i}=e;if(!(!t||!r||!n)){if(s!=null)return{formMethod:t,formAction:r,formEncType:n,formData:void 0,json:void 0,text:s};if(a!=null)return{formMethod:t,formAction:r,formEncType:n,formData:a,json:void 0,text:void 0};if(i!==void 0)return{formMethod:t,formAction:r,formEncType:n,formData:void 0,json:i,text:void 0}}}function V0(e,t){return t?{state:"loading",location:e,formMethod:t.formMethod,formAction:t.formAction,formEncType:t.formEncType,formData:t.formData,json:t.json,text:t.text}:{state:"loading",location:e,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0}}function wR(e,t){return{state:"submitting",location:e,formMethod:t.formMethod,formAction:t.formAction,formEncType:t.formEncType,formData:t.formData,json:t.json,text:t.text}}function Kl(e,t){return e?{state:"loading",formMethod:e.formMethod,formAction:e.formAction,formEncType:e.formEncType,formData:e.formData,json:e.json,text:e.text,data:t}:{state:"loading",formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0,data:t}}function ER(e,t){return{state:"submitting",formMethod:e.formMethod,formAction:e.formAction,formEncType:e.formEncType,formData:e.formData,json:e.json,text:e.text,data:t?t.data:void 0}}function Pa(e){return{state:"idle",formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0,data:e}}function TR(e,t){try{let r=e.sessionStorage.getItem(xT);if(r){let n=JSON.parse(r);for(let[s,a]of Object.entries(n||{}))a&&Array.isArray(a)&&t.set(s,new Set(a||[]))}}catch{}}function kR(e,t){if(t.size>0){let r={};for(let[n,s]of t)r[n]=[...s];try{e.sessionStorage.setItem(xT,JSON.stringify(r))}catch(n){il(!1,"Failed to save applied view transitions in sessionStorage ("+n+").")}}}/**
 * React Router v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Oh(){return Oh=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Oh.apply(this,arguments)}const Tu=z.createContext(null),Hg=z.createContext(null),Ta=z.createContext(null),Gg=z.createContext(null),Os=z.createContext({outlet:null,matches:[],isDataRoute:!1}),ET=z.createContext(null);function SR(e,t){let{relative:r}=t===void 0?{}:t;wl()||Ke(!1);let{basename:n,navigator:s}=z.useContext(Ta),{hash:a,pathname:i,search:o}=Rd(e,{relative:r}),l=i;return n!=="/"&&(l=i==="/"?n:ia([n,i])),s.createHref({pathname:l,search:o,hash:a})}function wl(){return z.useContext(Gg)!=null}function Ms(){return wl()||Ke(!1),z.useContext(Gg).location}function TT(e){z.useContext(Ta).static||z.useLayoutEffect(e)}function Ls(){let{isDataRoute:e}=z.useContext(Os);return e?UR():AR()}function AR(){wl()||Ke(!1);let e=z.useContext(Tu),{basename:t,future:r,navigator:n}=z.useContext(Ta),{matches:s}=z.useContext(Os),{pathname:a}=Ms(),i=JSON.stringify(Cd(s,r.v7_relativeSplatPath)),o=z.useRef(!1);return TT(()=>{o.current=!0}),z.useCallback(function(c,u){if(u===void 0&&(u={}),!o.current)return;if(typeof c=="number"){n.go(c);return}let d=Nd(c,JSON.parse(i),a,u.relative==="path");e==null&&t!=="/"&&(d.pathname=d.pathname==="/"?t:ia([t,d.pathname])),(u.replace?n.replace:n.push)(d,u.state,u)},[t,n,i,a,e])}const IR=z.createContext(null);function CR(e){let t=z.useContext(Os).outlet;return t&&z.createElement(IR.Provider,{value:e},t)}function Kg(){let{matches:e}=z.useContext(Os),t=e[e.length-1];return t?t.params:{}}function Rd(e,t){let{relative:r}=t===void 0?{}:t,{future:n}=z.useContext(Ta),{matches:s}=z.useContext(Os),{pathname:a}=Ms(),i=JSON.stringify(Cd(s,n.v7_relativeSplatPath));return z.useMemo(()=>Nd(e,JSON.parse(i),a,r==="path"),[e,i,a,r])}function NR(e,t,r,n){wl()||Ke(!1);let{navigator:s}=z.useContext(Ta),{matches:a}=z.useContext(Os),i=a[a.length-1],o=i?i.params:{};i&&i.pathname;let l=i?i.pathnameBase:"/";i&&i.route;let c=Ms(),u;u=c;let d=u.pathname||"/",m=d;if(l!=="/"){let g=l.replace(/^\//,"").split("/");m="/"+d.replace(/^\//,"").split("/").slice(g.length).join("/")}let p=Si(e,{pathname:m});return FR(p&&p.map(g=>Object.assign({},g,{params:Object.assign({},o,g.params),pathname:ia([l,s.encodeLocation?s.encodeLocation(g.pathname).pathname:g.pathname]),pathnameBase:g.pathnameBase==="/"?l:ia([l,s.encodeLocation?s.encodeLocation(g.pathnameBase).pathname:g.pathnameBase])})),a,r,n)}function RR(){let e=jR(),t=Qc(e)?e.status+" "+e.statusText:e instanceof Error?e.message:JSON.stringify(e),r=e instanceof Error?e.stack:null,s={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return z.createElement(z.Fragment,null,z.createElement("h2",null,"Unexpected Application Error!"),z.createElement("h3",{style:{fontStyle:"italic"}},t),r?z.createElement("pre",{style:s},r):null,null)}const bR=z.createElement(RR,null);class PR extends z.Component{constructor(t){super(t),this.state={location:t.location,revalidation:t.revalidation,error:t.error}}static getDerivedStateFromError(t){return{error:t}}static getDerivedStateFromProps(t,r){return r.location!==t.location||r.revalidation!=="idle"&&t.revalidation==="idle"?{error:t.error,location:t.location,revalidation:t.revalidation}:{error:t.error!==void 0?t.error:r.error,location:r.location,revalidation:t.revalidation||r.revalidation}}componentDidCatch(t,r){console.error("React Router caught the following error during render",t,r)}render(){return this.state.error!==void 0?z.createElement(Os.Provider,{value:this.props.routeContext},z.createElement(ET.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function DR(e){let{routeContext:t,match:r,children:n}=e,s=z.useContext(Tu);return s&&s.static&&s.staticContext&&(r.route.errorElement||r.route.ErrorBoundary)&&(s.staticContext._deepestRenderedBoundaryId=r.route.id),z.createElement(Os.Provider,{value:t},n)}function FR(e,t,r,n){var s;if(t===void 0&&(t=[]),r===void 0&&(r=null),n===void 0&&(n=null),e==null){var a;if(!r)return null;if(r.errors)e=r.matches;else if((a=n)!=null&&a.v7_partialHydration&&t.length===0&&!r.initialized&&r.matches.length>0)e=r.matches;else return null}let i=e,o=(s=r)==null?void 0:s.errors;if(o!=null){let u=i.findIndex(d=>d.route.id&&(o==null?void 0:o[d.route.id])!==void 0);u>=0||Ke(!1),i=i.slice(0,Math.min(i.length,u+1))}let l=!1,c=-1;if(r&&n&&n.v7_partialHydration)for(let u=0;u<i.length;u++){let d=i[u];if((d.route.HydrateFallback||d.route.hydrateFallbackElement)&&(c=u),d.route.id){let{loaderData:m,errors:p}=r,x=d.route.loader&&m[d.route.id]===void 0&&(!p||p[d.route.id]===void 0);if(d.route.lazy||x){l=!0,c>=0?i=i.slice(0,c+1):i=[i[0]];break}}}return i.reduceRight((u,d,m)=>{let p,x=!1,g=null,_=null;r&&(p=o&&d.route.id?o[d.route.id]:void 0,g=d.route.errorElement||bR,l&&(c<0&&m===0?(VR("route-fallback"),x=!0,_=null):c===m&&(x=!0,_=d.route.hydrateFallbackElement||null)));let k=t.concat(i.slice(0,m+1)),T=()=>{let w;return p?w=g:x?w=_:d.route.Component?w=z.createElement(d.route.Component,null):d.route.element?w=d.route.element:w=u,z.createElement(DR,{match:d,routeContext:{outlet:u,matches:k,isDataRoute:r!=null},children:w})};return r&&(d.route.ErrorBoundary||d.route.errorElement||m===0)?z.createElement(PR,{location:r.location,revalidation:r.revalidation,component:g,error:p,children:T(),routeContext:{outlet:null,matches:k,isDataRoute:!0}}):T()},null)}var kT=function(e){return e.UseBlocker="useBlocker",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e}(kT||{}),ST=function(e){return e.UseBlocker="useBlocker",e.UseLoaderData="useLoaderData",e.UseActionData="useActionData",e.UseRouteError="useRouteError",e.UseNavigation="useNavigation",e.UseRouteLoaderData="useRouteLoaderData",e.UseMatches="useMatches",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e.UseRouteId="useRouteId",e}(ST||{});function OR(e){let t=z.useContext(Tu);return t||Ke(!1),t}function MR(e){let t=z.useContext(Hg);return t||Ke(!1),t}function LR(e){let t=z.useContext(Os);return t||Ke(!1),t}function AT(e){let t=LR(),r=t.matches[t.matches.length-1];return r.route.id||Ke(!1),r.route.id}function jR(){var e;let t=z.useContext(ET),r=MR(ST.UseRouteError),n=AT();return t!==void 0?t:(e=r.errors)==null?void 0:e[n]}function UR(){let{router:e}=OR(kT.UseNavigateStable),t=AT(),r=z.useRef(!1);return TT(()=>{r.current=!0}),z.useCallback(function(s,a){a===void 0&&(a={}),r.current&&(typeof s=="number"?e.navigate(s):e.navigate(s,Oh({fromRouteId:t},a)))},[e,t])}const _y={};function VR(e,t,r){_y[e]||(_y[e]=!0)}function BR(e,t){e==null||e.v7_startTransition,(e==null?void 0:e.v7_relativeSplatPath)===void 0&&(!t||t.v7_relativeSplatPath),t&&(t.v7_fetcherPersist,t.v7_normalizeFormMethod,t.v7_partialHydration,t.v7_skipActionErrorRevalidation)}function zR(e){let{to:t,replace:r,state:n,relative:s}=e;wl()||Ke(!1);let{future:a,static:i}=z.useContext(Ta),{matches:o}=z.useContext(Os),{pathname:l}=Ms(),c=Ls(),u=Nd(t,Cd(o,a.v7_relativeSplatPath),l,s==="path"),d=JSON.stringify(u);return z.useEffect(()=>c(JSON.parse(d),{replace:r,state:n,relative:s}),[c,d,s,r,n]),null}function IT(e){return CR(e.context)}function $R(e){let{basename:t="/",children:r=null,location:n,navigationType:s=Zt.Pop,navigator:a,static:i=!1,future:o}=e;wl()&&Ke(!1);let l=t.replace(/^\/*/,"/"),c=z.useMemo(()=>({basename:l,navigator:a,static:i,future:Oh({v7_relativeSplatPath:!1},o)}),[l,o,a,i]);typeof n=="string"&&(n=xi(n));let{pathname:u="/",search:d="",hash:m="",state:p=null,key:x="default"}=n,g=z.useMemo(()=>{let _=ma(u,l);return _==null?null:{location:{pathname:_,search:d,hash:m,state:p,key:x},navigationType:s}},[l,u,d,m,p,x,s]);return g==null?null:z.createElement(Ta.Provider,{value:c},z.createElement(Gg.Provider,{children:r,value:g}))}new Promise(()=>{});function WR(e){let t={hasErrorBoundary:e.ErrorBoundary!=null||e.errorElement!=null};return e.Component&&Object.assign(t,{element:z.createElement(e.Component),Component:void 0}),e.HydrateFallback&&Object.assign(t,{hydrateFallbackElement:z.createElement(e.HydrateFallback),HydrateFallback:void 0}),e.ErrorBoundary&&Object.assign(t,{errorElement:z.createElement(e.ErrorBoundary),ErrorBoundary:void 0}),t}/**
 * React Router DOM v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function ol(){return ol=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},ol.apply(this,arguments)}function CT(e,t){if(e==null)return{};var r={},n=Object.keys(e),s,a;for(a=0;a<n.length;a++)s=n[a],!(t.indexOf(s)>=0)&&(r[s]=e[s]);return r}function HR(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}function GR(e,t){return e.button===0&&(!t||t==="_self")&&!HR(e)}function ap(e){return e===void 0&&(e=""),new URLSearchParams(typeof e=="string"||Array.isArray(e)||e instanceof URLSearchParams?e:Object.keys(e).reduce((t,r)=>{let n=e[r];return t.concat(Array.isArray(n)?n.map(s=>[r,s]):[[r,n]])},[]))}function KR(e,t){let r=ap(e);return t&&t.forEach((n,s)=>{r.has(s)||t.getAll(s).forEach(a=>{r.append(s,a)})}),r}const qR=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],XR=["aria-current","caseSensitive","className","end","style","to","viewTransition","children"],YR="6";try{window.__reactRouterVersion=YR}catch{}function QR(e,t){return aR({basename:void 0,future:ol({},void 0,{v7_prependBasename:!0}),history:N4({window:void 0}),hydrationData:JR(),routes:e,mapRouteProperties:WR,dataStrategy:void 0,patchRoutesOnNavigation:void 0,window:void 0}).initialize()}function JR(){var e;let t=(e=window)==null?void 0:e.__staticRouterHydrationData;return t&&t.errors&&(t=ol({},t,{errors:ZR(t.errors)})),t}function ZR(e){if(!e)return null;let t=Object.entries(e),r={};for(let[n,s]of t)if(s&&s.__type==="RouteErrorResponse")r[n]=new Fh(s.status,s.statusText,s.data,s.internal===!0);else if(s&&s.__type==="Error"){if(s.__subType){let a=window[s.__subType];if(typeof a=="function")try{let i=new a(s.message);i.stack="",r[n]=i}catch{}}if(r[n]==null){let a=new Error(s.message);a.stack="",r[n]=a}}else r[n]=s;return r}const NT=z.createContext({isTransitioning:!1}),eb=z.createContext(new Map),tb="startTransition",wy=gC[tb],rb="flushSync",Ey=C4[rb];function nb(e){wy?wy(e):e()}function ql(e){Ey?Ey(e):e()}let sb=class{constructor(){this.status="pending",this.promise=new Promise((t,r)=>{this.resolve=n=>{this.status==="pending"&&(this.status="resolved",t(n))},this.reject=n=>{this.status==="pending"&&(this.status="rejected",r(n))}})}};function ab(e){let{fallbackElement:t,router:r,future:n}=e,[s,a]=z.useState(r.state),[i,o]=z.useState(),[l,c]=z.useState({isTransitioning:!1}),[u,d]=z.useState(),[m,p]=z.useState(),[x,g]=z.useState(),_=z.useRef(new Map),{v7_startTransition:k}=n||{},T=z.useCallback(E=>{k?nb(E):E()},[k]),w=z.useCallback((E,S)=>{let{deletedFetchers:R,flushSync:P,viewTransitionOpts:D}=S;E.fetchers.forEach((ce,oe)=>{ce.data!==void 0&&_.current.set(oe,ce.data)}),R.forEach(ce=>_.current.delete(ce));let N=r.window==null||r.window.document==null||typeof r.window.document.startViewTransition!="function";if(!D||N){P?ql(()=>a(E)):T(()=>a(E));return}if(P){ql(()=>{m&&(u&&u.resolve(),m.skipTransition()),c({isTransitioning:!0,flushSync:!0,currentLocation:D.currentLocation,nextLocation:D.nextLocation})});let ce=r.window.document.startViewTransition(()=>{ql(()=>a(E))});ce.finished.finally(()=>{ql(()=>{d(void 0),p(void 0),o(void 0),c({isTransitioning:!1})})}),ql(()=>p(ce));return}m?(u&&u.resolve(),m.skipTransition(),g({state:E,currentLocation:D.currentLocation,nextLocation:D.nextLocation})):(o(E),c({isTransitioning:!0,flushSync:!1,currentLocation:D.currentLocation,nextLocation:D.nextLocation}))},[r.window,m,u,_,T]);z.useLayoutEffect(()=>r.subscribe(w),[r,w]),z.useEffect(()=>{l.isTransitioning&&!l.flushSync&&d(new sb)},[l]),z.useEffect(()=>{if(u&&i&&r.window){let E=i,S=u.promise,R=r.window.document.startViewTransition(async()=>{T(()=>a(E)),await S});R.finished.finally(()=>{d(void 0),p(void 0),o(void 0),c({isTransitioning:!1})}),p(R)}},[T,i,u,r.window]),z.useEffect(()=>{u&&i&&s.location.key===i.location.key&&u.resolve()},[u,m,s.location,i]),z.useEffect(()=>{!l.isTransitioning&&x&&(o(x.state),c({isTransitioning:!0,flushSync:!1,currentLocation:x.currentLocation,nextLocation:x.nextLocation}),g(void 0))},[l.isTransitioning,x]),z.useEffect(()=>{},[]);let C=z.useMemo(()=>({createHref:r.createHref,encodeLocation:r.encodeLocation,go:E=>r.navigate(E),push:(E,S,R)=>r.navigate(E,{state:S,preventScrollReset:R==null?void 0:R.preventScrollReset}),replace:(E,S,R)=>r.navigate(E,{replace:!0,state:S,preventScrollReset:R==null?void 0:R.preventScrollReset})}),[r]),M=r.basename||"/",O=z.useMemo(()=>({router:r,navigator:C,static:!1,basename:M}),[r,C,M]),v=z.useMemo(()=>({v7_relativeSplatPath:r.future.v7_relativeSplatPath}),[r.future.v7_relativeSplatPath]);return z.useEffect(()=>BR(n,r.future),[n,r.future]),z.createElement(z.Fragment,null,z.createElement(Tu.Provider,{value:O},z.createElement(Hg.Provider,{value:s},z.createElement(eb.Provider,{value:_.current},z.createElement(NT.Provider,{value:l},z.createElement($R,{basename:M,location:s.location,navigationType:s.historyAction,navigator:C,future:v},s.initialized||r.future.v7_partialHydration?z.createElement(ib,{routes:r.routes,future:r.future,state:s}):t))))),null)}const ib=z.memo(ob);function ob(e){let{routes:t,future:r,state:n}=e;return NR(t,void 0,n,r)}const lb=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",cb=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Ye=z.forwardRef(function(t,r){let{onClick:n,relative:s,reloadDocument:a,replace:i,state:o,target:l,to:c,preventScrollReset:u,viewTransition:d}=t,m=CT(t,qR),{basename:p}=z.useContext(Ta),x,g=!1;if(typeof c=="string"&&cb.test(c)&&(x=c,lb))try{let w=new URL(window.location.href),C=c.startsWith("//")?new URL(w.protocol+c):new URL(c),M=ma(C.pathname,p);C.origin===w.origin&&M!=null?c=M+C.search+C.hash:g=!0}catch{}let _=SR(c,{relative:s}),k=fb(c,{replace:i,state:o,target:l,preventScrollReset:u,relative:s,viewTransition:d});function T(w){n&&n(w),w.defaultPrevented||k(w)}return z.createElement("a",ol({},m,{href:x||_,onClick:g||a?n:T,ref:r,target:l}))}),Na=z.forwardRef(function(t,r){let{"aria-current":n="page",caseSensitive:s=!1,className:a="",end:i=!1,style:o,to:l,viewTransition:c,children:u}=t,d=CT(t,XR),m=Rd(l,{relative:d.relative}),p=Ms(),x=z.useContext(Hg),{navigator:g,basename:_}=z.useContext(Ta),k=x!=null&&db(m)&&c===!0,T=g.encodeLocation?g.encodeLocation(m).pathname:m.pathname,w=p.pathname,C=x&&x.navigation&&x.navigation.location?x.navigation.location.pathname:null;s||(w=w.toLowerCase(),C=C?C.toLowerCase():null,T=T.toLowerCase()),C&&_&&(C=ma(C,_)||C);const M=T!=="/"&&T.endsWith("/")?T.length-1:T.length;let O=w===T||!i&&w.startsWith(T)&&w.charAt(M)==="/",v=C!=null&&(C===T||!i&&C.startsWith(T)&&C.charAt(T.length)==="/"),E={isActive:O,isPending:v,isTransitioning:k},S=O?n:void 0,R;typeof a=="function"?R=a(E):R=[a,O?"active":null,v?"pending":null,k?"transitioning":null].filter(Boolean).join(" ");let P=typeof o=="function"?o(E):o;return z.createElement(Ye,ol({},d,{"aria-current":S,className:R,ref:r,style:P,to:l,viewTransition:c}),typeof u=="function"?u(E):u)});var ip;(function(e){e.UseScrollRestoration="useScrollRestoration",e.UseSubmit="useSubmit",e.UseSubmitFetcher="useSubmitFetcher",e.UseFetcher="useFetcher",e.useViewTransitionState="useViewTransitionState"})(ip||(ip={}));var Ty;(function(e){e.UseFetcher="useFetcher",e.UseFetchers="useFetchers",e.UseScrollRestoration="useScrollRestoration"})(Ty||(Ty={}));function ub(e){let t=z.useContext(Tu);return t||Ke(!1),t}function fb(e,t){let{target:r,replace:n,state:s,preventScrollReset:a,relative:i,viewTransition:o}=t===void 0?{}:t,l=Ls(),c=Ms(),u=Rd(e,{relative:i});return z.useCallback(d=>{if(GR(d,r)){d.preventDefault();let m=n!==void 0?n:Gi(c)===Gi(u);l(e,{replace:m,state:s,preventScrollReset:a,relative:i,viewTransition:o})}},[c,l,u,n,s,r,e,a,i,o])}function hb(e){let t=z.useRef(ap(e)),r=z.useRef(!1),n=Ms(),s=z.useMemo(()=>KR(n.search,r.current?null:t.current),[n.search]),a=Ls(),i=z.useCallback((o,l)=>{const c=ap(typeof o=="function"?o(s):o);r.current=!0,a("?"+c,l)},[a,s]);return[s,i]}function db(e,t){t===void 0&&(t={});let r=z.useContext(NT);r==null&&Ke(!1);let{basename:n}=ub(ip.useViewTransitionState),s=Rd(e,{relative:t.relative});if(!r.isTransitioning)return!1;let a=ma(r.currentLocation.pathname,n)||r.currentLocation.pathname,i=ma(r.nextLocation.pathname,n)||r.nextLocation.pathname;return Dh(s.pathname,i)!=null||Dh(s.pathname,a)!=null}var ky={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const RT=function(e){const t=[];let r=0;for(let n=0;n<e.length;n++){let s=e.charCodeAt(n);s<128?t[r++]=s:s<2048?(t[r++]=s>>6|192,t[r++]=s&63|128):(s&64512)===55296&&n+1<e.length&&(e.charCodeAt(n+1)&64512)===56320?(s=65536+((s&1023)<<10)+(e.charCodeAt(++n)&1023),t[r++]=s>>18|240,t[r++]=s>>12&63|128,t[r++]=s>>6&63|128,t[r++]=s&63|128):(t[r++]=s>>12|224,t[r++]=s>>6&63|128,t[r++]=s&63|128)}return t},mb=function(e){const t=[];let r=0,n=0;for(;r<e.length;){const s=e[r++];if(s<128)t[n++]=String.fromCharCode(s);else if(s>191&&s<224){const a=e[r++];t[n++]=String.fromCharCode((s&31)<<6|a&63)}else if(s>239&&s<365){const a=e[r++],i=e[r++],o=e[r++],l=((s&7)<<18|(a&63)<<12|(i&63)<<6|o&63)-65536;t[n++]=String.fromCharCode(55296+(l>>10)),t[n++]=String.fromCharCode(56320+(l&1023))}else{const a=e[r++],i=e[r++];t[n++]=String.fromCharCode((s&15)<<12|(a&63)<<6|i&63)}}return t.join("")},bT={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(e,t){if(!Array.isArray(e))throw Error("encodeByteArray takes an array as a parameter");this.init_();const r=t?this.byteToCharMapWebSafe_:this.byteToCharMap_,n=[];for(let s=0;s<e.length;s+=3){const a=e[s],i=s+1<e.length,o=i?e[s+1]:0,l=s+2<e.length,c=l?e[s+2]:0,u=a>>2,d=(a&3)<<4|o>>4;let m=(o&15)<<2|c>>6,p=c&63;l||(p=64,i||(m=64)),n.push(r[u],r[d],r[m],r[p])}return n.join("")},encodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?btoa(e):this.encodeByteArray(RT(e),t)},decodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?atob(e):mb(this.decodeStringToByteArray(e,t))},decodeStringToByteArray(e,t){this.init_();const r=t?this.charToByteMapWebSafe_:this.charToByteMap_,n=[];for(let s=0;s<e.length;){const a=r[e.charAt(s++)],o=s<e.length?r[e.charAt(s)]:0;++s;const c=s<e.length?r[e.charAt(s)]:64;++s;const d=s<e.length?r[e.charAt(s)]:64;if(++s,a==null||o==null||c==null||d==null)throw new pb;const m=a<<2|o>>4;if(n.push(m),c!==64){const p=o<<4&240|c>>2;if(n.push(p),d!==64){const x=c<<6&192|d;n.push(x)}}}return n},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let e=0;e<this.ENCODED_VALS.length;e++)this.byteToCharMap_[e]=this.ENCODED_VALS.charAt(e),this.charToByteMap_[this.byteToCharMap_[e]]=e,this.byteToCharMapWebSafe_[e]=this.ENCODED_VALS_WEBSAFE.charAt(e),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[e]]=e,e>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(e)]=e,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(e)]=e)}}};class pb extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const gb=function(e){const t=RT(e);return bT.encodeByteArray(t,!0)},Mh=function(e){return gb(e).replace(/\./g,"")},PT=function(e){try{return bT.decodeString(e,!0)}catch(t){console.error("base64Decode failed: ",t)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xb(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vb=()=>xb().__FIREBASE_DEFAULTS__,yb=()=>{if(typeof process>"u"||typeof ky>"u")return;const e=ky.__FIREBASE_DEFAULTS__;if(e)return JSON.parse(e)},_b=()=>{if(typeof document>"u")return;let e;try{e=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const t=e&&PT(e[1]);return t&&JSON.parse(t)},bd=()=>{try{return vb()||yb()||_b()}catch(e){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${e}`);return}},DT=e=>{var t,r;return(r=(t=bd())===null||t===void 0?void 0:t.emulatorHosts)===null||r===void 0?void 0:r[e]},qg=e=>{const t=DT(e);if(!t)return;const r=t.lastIndexOf(":");if(r<=0||r+1===t.length)throw new Error(`Invalid host ${t} with no separate hostname and port!`);const n=parseInt(t.substring(r+1),10);return t[0]==="["?[t.substring(1,r-1),n]:[t.substring(0,r),n]},FT=()=>{var e;return(e=bd())===null||e===void 0?void 0:e.config},OT=e=>{var t;return(t=bd())===null||t===void 0?void 0:t[`_${e}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wb{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((t,r)=>{this.resolve=t,this.reject=r})}wrapCallback(t){return(r,n)=>{r?this.reject(r):this.resolve(n),typeof t=="function"&&(this.promise.catch(()=>{}),t.length===1?t(r):t(r,n))}}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function MT(e,t){if(e.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const r={alg:"none",type:"JWT"},n=t||"demo-project",s=e.iat||0,a=e.sub||e.user_id;if(!a)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const i=Object.assign({iss:`https://securetoken.google.com/${n}`,aud:n,iat:s,exp:s+3600,auth_time:s,sub:a,user_id:a,firebase:{sign_in_provider:"custom",identities:{}}},e);return[Mh(JSON.stringify(r)),Mh(JSON.stringify(i)),""].join(".")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Hr(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function Eb(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Hr())}function Tb(){var e;const t=(e=bd())===null||e===void 0?void 0:e.forceEnvironment;if(t==="node")return!0;if(t==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function kb(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function Sb(){const e=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof e=="object"&&e.id!==void 0}function Ab(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function Ib(){const e=Hr();return e.indexOf("MSIE ")>=0||e.indexOf("Trident/")>=0}function Cb(){return!Tb()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function Nb(){try{return typeof indexedDB=="object"}catch{return!1}}function Rb(){return new Promise((e,t)=>{try{let r=!0;const n="validate-browser-context-for-indexeddb-analytics-module",s=self.indexedDB.open(n);s.onsuccess=()=>{s.result.close(),r||self.indexedDB.deleteDatabase(n),e(!0)},s.onupgradeneeded=()=>{r=!1},s.onerror=()=>{var a;t(((a=s.error)===null||a===void 0?void 0:a.message)||"")}}catch(r){t(r)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bb="FirebaseError";class js extends Error{constructor(t,r,n){super(r),this.code=t,this.customData=n,this.name=bb,Object.setPrototypeOf(this,js.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,ku.prototype.create)}}class ku{constructor(t,r,n){this.service=t,this.serviceName=r,this.errors=n}create(t,...r){const n=r[0]||{},s=`${this.service}/${t}`,a=this.errors[t],i=a?Pb(a,n):"Error",o=`${this.serviceName}: ${i} (${s}).`;return new js(s,o,n)}}function Pb(e,t){return e.replace(Db,(r,n)=>{const s=t[n];return s!=null?String(s):`<${n}?>`})}const Db=/\{\$([^}]+)}/g;function Fb(e){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}function Lh(e,t){if(e===t)return!0;const r=Object.keys(e),n=Object.keys(t);for(const s of r){if(!n.includes(s))return!1;const a=e[s],i=t[s];if(Sy(a)&&Sy(i)){if(!Lh(a,i))return!1}else if(a!==i)return!1}for(const s of n)if(!r.includes(s))return!1;return!0}function Sy(e){return e!==null&&typeof e=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Su(e){const t=[];for(const[r,n]of Object.entries(e))Array.isArray(n)?n.forEach(s=>{t.push(encodeURIComponent(r)+"="+encodeURIComponent(s))}):t.push(encodeURIComponent(r)+"="+encodeURIComponent(n));return t.length?"&"+t.join("&"):""}function Ob(e,t){const r=new Mb(e,t);return r.subscribe.bind(r)}class Mb{constructor(t,r){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=r,this.task.then(()=>{t(this)}).catch(n=>{this.error(n)})}next(t){this.forEachObserver(r=>{r.next(t)})}error(t){this.forEachObserver(r=>{r.error(t)}),this.close(t)}complete(){this.forEachObserver(t=>{t.complete()}),this.close()}subscribe(t,r,n){let s;if(t===void 0&&r===void 0&&n===void 0)throw new Error("Missing Observer.");Lb(t,["next","error","complete"])?s=t:s={next:t,error:r,complete:n},s.next===void 0&&(s.next=B0),s.error===void 0&&(s.error=B0),s.complete===void 0&&(s.complete=B0);const a=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?s.error(this.finalError):s.complete()}catch{}}),this.observers.push(s),a}unsubscribeOne(t){this.observers===void 0||this.observers[t]===void 0||(delete this.observers[t],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(t){if(!this.finalized)for(let r=0;r<this.observers.length;r++)this.sendOne(r,t)}sendOne(t,r){this.task.then(()=>{if(this.observers!==void 0&&this.observers[t]!==void 0)try{r(this.observers[t])}catch(n){typeof console<"u"&&console.error&&console.error(n)}})}close(t){this.finalized||(this.finalized=!0,t!==void 0&&(this.finalError=t),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function Lb(e,t){if(typeof e!="object"||e===null)return!1;for(const r of t)if(r in e&&typeof e[r]=="function")return!0;return!1}function B0(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Kt(e){return e&&e._delegate?e._delegate:e}class pa{constructor(t,r,n){this.name=t,this.instanceFactory=r,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(t){return this.instantiationMode=t,this}setMultipleInstances(t){return this.multipleInstances=t,this}setServiceProps(t){return this.serviceProps=t,this}setInstanceCreatedCallback(t){return this.onInstanceCreated=t,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ki="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jb{constructor(t,r){this.name=t,this.container=r,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(t){const r=this.normalizeInstanceIdentifier(t);if(!this.instancesDeferred.has(r)){const n=new wb;if(this.instancesDeferred.set(r,n),this.isInitialized(r)||this.shouldAutoInitialize())try{const s=this.getOrInitializeService({instanceIdentifier:r});s&&n.resolve(s)}catch{}}return this.instancesDeferred.get(r).promise}getImmediate(t){var r;const n=this.normalizeInstanceIdentifier(t==null?void 0:t.identifier),s=(r=t==null?void 0:t.optional)!==null&&r!==void 0?r:!1;if(this.isInitialized(n)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:n})}catch(a){if(s)return null;throw a}else{if(s)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(t){if(t.name!==this.name)throw Error(`Mismatching Component ${t.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=t,!!this.shouldAutoInitialize()){if(Vb(t))try{this.getOrInitializeService({instanceIdentifier:ki})}catch{}for(const[r,n]of this.instancesDeferred.entries()){const s=this.normalizeInstanceIdentifier(r);try{const a=this.getOrInitializeService({instanceIdentifier:s});n.resolve(a)}catch{}}}}clearInstance(t=ki){this.instancesDeferred.delete(t),this.instancesOptions.delete(t),this.instances.delete(t)}async delete(){const t=Array.from(this.instances.values());await Promise.all([...t.filter(r=>"INTERNAL"in r).map(r=>r.INTERNAL.delete()),...t.filter(r=>"_delete"in r).map(r=>r._delete())])}isComponentSet(){return this.component!=null}isInitialized(t=ki){return this.instances.has(t)}getOptions(t=ki){return this.instancesOptions.get(t)||{}}initialize(t={}){const{options:r={}}=t,n=this.normalizeInstanceIdentifier(t.instanceIdentifier);if(this.isInitialized(n))throw Error(`${this.name}(${n}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const s=this.getOrInitializeService({instanceIdentifier:n,options:r});for(const[a,i]of this.instancesDeferred.entries()){const o=this.normalizeInstanceIdentifier(a);n===o&&i.resolve(s)}return s}onInit(t,r){var n;const s=this.normalizeInstanceIdentifier(r),a=(n=this.onInitCallbacks.get(s))!==null&&n!==void 0?n:new Set;a.add(t),this.onInitCallbacks.set(s,a);const i=this.instances.get(s);return i&&t(i,s),()=>{a.delete(t)}}invokeOnInitCallbacks(t,r){const n=this.onInitCallbacks.get(r);if(n)for(const s of n)try{s(t,r)}catch{}}getOrInitializeService({instanceIdentifier:t,options:r={}}){let n=this.instances.get(t);if(!n&&this.component&&(n=this.component.instanceFactory(this.container,{instanceIdentifier:Ub(t),options:r}),this.instances.set(t,n),this.instancesOptions.set(t,r),this.invokeOnInitCallbacks(n,t),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,t,n)}catch{}return n||null}normalizeInstanceIdentifier(t=ki){return this.component?this.component.multipleInstances?t:ki:t}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function Ub(e){return e===ki?void 0:e}function Vb(e){return e.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bb{constructor(t){this.name=t,this.providers=new Map}addComponent(t){const r=this.getProvider(t.name);if(r.isComponentSet())throw new Error(`Component ${t.name} has already been registered with ${this.name}`);r.setComponent(t)}addOrOverwriteComponent(t){this.getProvider(t.name).isComponentSet()&&this.providers.delete(t.name),this.addComponent(t)}getProvider(t){if(this.providers.has(t))return this.providers.get(t);const r=new jb(t,this);return this.providers.set(t,r),r}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Ze;(function(e){e[e.DEBUG=0]="DEBUG",e[e.VERBOSE=1]="VERBOSE",e[e.INFO=2]="INFO",e[e.WARN=3]="WARN",e[e.ERROR=4]="ERROR",e[e.SILENT=5]="SILENT"})(Ze||(Ze={}));const zb={debug:Ze.DEBUG,verbose:Ze.VERBOSE,info:Ze.INFO,warn:Ze.WARN,error:Ze.ERROR,silent:Ze.SILENT},$b=Ze.INFO,Wb={[Ze.DEBUG]:"log",[Ze.VERBOSE]:"log",[Ze.INFO]:"info",[Ze.WARN]:"warn",[Ze.ERROR]:"error"},Hb=(e,t,...r)=>{if(t<e.logLevel)return;const n=new Date().toISOString(),s=Wb[t];if(s)console[s](`[${n}]  ${e.name}:`,...r);else throw new Error(`Attempted to log a message with an invalid logType (value: ${t})`)};class Xg{constructor(t){this.name=t,this._logLevel=$b,this._logHandler=Hb,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(t){if(!(t in Ze))throw new TypeError(`Invalid value "${t}" assigned to \`logLevel\``);this._logLevel=t}setLogLevel(t){this._logLevel=typeof t=="string"?zb[t]:t}get logHandler(){return this._logHandler}set logHandler(t){if(typeof t!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t}get userLogHandler(){return this._userLogHandler}set userLogHandler(t){this._userLogHandler=t}debug(...t){this._userLogHandler&&this._userLogHandler(this,Ze.DEBUG,...t),this._logHandler(this,Ze.DEBUG,...t)}log(...t){this._userLogHandler&&this._userLogHandler(this,Ze.VERBOSE,...t),this._logHandler(this,Ze.VERBOSE,...t)}info(...t){this._userLogHandler&&this._userLogHandler(this,Ze.INFO,...t),this._logHandler(this,Ze.INFO,...t)}warn(...t){this._userLogHandler&&this._userLogHandler(this,Ze.WARN,...t),this._logHandler(this,Ze.WARN,...t)}error(...t){this._userLogHandler&&this._userLogHandler(this,Ze.ERROR,...t),this._logHandler(this,Ze.ERROR,...t)}}const Gb=(e,t)=>t.some(r=>e instanceof r);let Ay,Iy;function Kb(){return Ay||(Ay=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function qb(){return Iy||(Iy=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const LT=new WeakMap,op=new WeakMap,jT=new WeakMap,z0=new WeakMap,Yg=new WeakMap;function Xb(e){const t=new Promise((r,n)=>{const s=()=>{e.removeEventListener("success",a),e.removeEventListener("error",i)},a=()=>{r(ti(e.result)),s()},i=()=>{n(e.error),s()};e.addEventListener("success",a),e.addEventListener("error",i)});return t.then(r=>{r instanceof IDBCursor&&LT.set(r,e)}).catch(()=>{}),Yg.set(t,e),t}function Yb(e){if(op.has(e))return;const t=new Promise((r,n)=>{const s=()=>{e.removeEventListener("complete",a),e.removeEventListener("error",i),e.removeEventListener("abort",i)},a=()=>{r(),s()},i=()=>{n(e.error||new DOMException("AbortError","AbortError")),s()};e.addEventListener("complete",a),e.addEventListener("error",i),e.addEventListener("abort",i)});op.set(e,t)}let lp={get(e,t,r){if(e instanceof IDBTransaction){if(t==="done")return op.get(e);if(t==="objectStoreNames")return e.objectStoreNames||jT.get(e);if(t==="store")return r.objectStoreNames[1]?void 0:r.objectStore(r.objectStoreNames[0])}return ti(e[t])},set(e,t,r){return e[t]=r,!0},has(e,t){return e instanceof IDBTransaction&&(t==="done"||t==="store")?!0:t in e}};function Qb(e){lp=e(lp)}function Jb(e){return e===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(t,...r){const n=e.call($0(this),t,...r);return jT.set(n,t.sort?t.sort():[t]),ti(n)}:qb().includes(e)?function(...t){return e.apply($0(this),t),ti(LT.get(this))}:function(...t){return ti(e.apply($0(this),t))}}function Zb(e){return typeof e=="function"?Jb(e):(e instanceof IDBTransaction&&Yb(e),Gb(e,Kb())?new Proxy(e,lp):e)}function ti(e){if(e instanceof IDBRequest)return Xb(e);if(z0.has(e))return z0.get(e);const t=Zb(e);return t!==e&&(z0.set(e,t),Yg.set(t,e)),t}const $0=e=>Yg.get(e);function eP(e,t,{blocked:r,upgrade:n,blocking:s,terminated:a}={}){const i=indexedDB.open(e,t),o=ti(i);return n&&i.addEventListener("upgradeneeded",l=>{n(ti(i.result),l.oldVersion,l.newVersion,ti(i.transaction),l)}),r&&i.addEventListener("blocked",l=>r(l.oldVersion,l.newVersion,l)),o.then(l=>{a&&l.addEventListener("close",()=>a()),s&&l.addEventListener("versionchange",c=>s(c.oldVersion,c.newVersion,c))}).catch(()=>{}),o}const tP=["get","getKey","getAll","getAllKeys","count"],rP=["put","add","delete","clear"],W0=new Map;function Cy(e,t){if(!(e instanceof IDBDatabase&&!(t in e)&&typeof t=="string"))return;if(W0.get(t))return W0.get(t);const r=t.replace(/FromIndex$/,""),n=t!==r,s=rP.includes(r);if(!(r in(n?IDBIndex:IDBObjectStore).prototype)||!(s||tP.includes(r)))return;const a=async function(i,...o){const l=this.transaction(i,s?"readwrite":"readonly");let c=l.store;return n&&(c=c.index(o.shift())),(await Promise.all([c[r](...o),s&&l.done]))[0]};return W0.set(t,a),a}Qb(e=>({...e,get:(t,r,n)=>Cy(t,r)||e.get(t,r,n),has:(t,r)=>!!Cy(t,r)||e.has(t,r)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nP{constructor(t){this.container=t}getPlatformInfoString(){return this.container.getProviders().map(r=>{if(sP(r)){const n=r.getImmediate();return`${n.library}/${n.version}`}else return null}).filter(r=>r).join(" ")}}function sP(e){const t=e.getComponent();return(t==null?void 0:t.type)==="VERSION"}const cp="@firebase/app",Ny="0.10.13";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ga=new Xg("@firebase/app"),aP="@firebase/app-compat",iP="@firebase/analytics-compat",oP="@firebase/analytics",lP="@firebase/app-check-compat",cP="@firebase/app-check",uP="@firebase/auth",fP="@firebase/auth-compat",hP="@firebase/database",dP="@firebase/data-connect",mP="@firebase/database-compat",pP="@firebase/functions",gP="@firebase/functions-compat",xP="@firebase/installations",vP="@firebase/installations-compat",yP="@firebase/messaging",_P="@firebase/messaging-compat",wP="@firebase/performance",EP="@firebase/performance-compat",TP="@firebase/remote-config",kP="@firebase/remote-config-compat",SP="@firebase/storage",AP="@firebase/storage-compat",IP="@firebase/firestore",CP="@firebase/vertexai-preview",NP="@firebase/firestore-compat",RP="firebase",bP="10.14.1";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const up="[DEFAULT]",PP={[cp]:"fire-core",[aP]:"fire-core-compat",[oP]:"fire-analytics",[iP]:"fire-analytics-compat",[cP]:"fire-app-check",[lP]:"fire-app-check-compat",[uP]:"fire-auth",[fP]:"fire-auth-compat",[hP]:"fire-rtdb",[dP]:"fire-data-connect",[mP]:"fire-rtdb-compat",[pP]:"fire-fn",[gP]:"fire-fn-compat",[xP]:"fire-iid",[vP]:"fire-iid-compat",[yP]:"fire-fcm",[_P]:"fire-fcm-compat",[wP]:"fire-perf",[EP]:"fire-perf-compat",[TP]:"fire-rc",[kP]:"fire-rc-compat",[SP]:"fire-gcs",[AP]:"fire-gcs-compat",[IP]:"fire-fst",[NP]:"fire-fst-compat",[CP]:"fire-vertex","fire-js":"fire-js",[RP]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jh=new Map,DP=new Map,fp=new Map;function Ry(e,t){try{e.container.addComponent(t)}catch(r){ga.debug(`Component ${t.name} failed to register with FirebaseApp ${e.name}`,r)}}function oi(e){const t=e.name;if(fp.has(t))return ga.debug(`There were multiple attempts to register component ${t}.`),!1;fp.set(t,e);for(const r of jh.values())Ry(r,e);for(const r of DP.values())Ry(r,e);return!0}function Au(e,t){const r=e.container.getProvider("heartbeat").getImmediate({optional:!0});return r&&r.triggerHeartbeat(),e.container.getProvider(t)}function ea(e){return e.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const FP={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},ri=new ku("app","Firebase",FP);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OP{constructor(t,r,n){this._isDeleted=!1,this._options=Object.assign({},t),this._config=Object.assign({},r),this._name=r.name,this._automaticDataCollectionEnabled=r.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new pa("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(t){this.checkDestroyed(),this._automaticDataCollectionEnabled=t}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(t){this._isDeleted=t}checkDestroyed(){if(this.isDeleted)throw ri.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ro=bP;function UT(e,t={}){let r=e;typeof t!="object"&&(t={name:t});const n=Object.assign({name:up,automaticDataCollectionEnabled:!1},t),s=n.name;if(typeof s!="string"||!s)throw ri.create("bad-app-name",{appName:String(s)});if(r||(r=FT()),!r)throw ri.create("no-options");const a=jh.get(s);if(a){if(Lh(r,a.options)&&Lh(n,a.config))return a;throw ri.create("duplicate-app",{appName:s})}const i=new Bb(s);for(const l of fp.values())i.addComponent(l);const o=new OP(r,n,i);return jh.set(s,o),o}function Pd(e=up){const t=jh.get(e);if(!t&&e===up&&FT())return UT();if(!t)throw ri.create("no-app",{appName:e});return t}function Vn(e,t,r){var n;let s=(n=PP[e])!==null&&n!==void 0?n:e;r&&(s+=`-${r}`);const a=s.match(/\s|\//),i=t.match(/\s|\//);if(a||i){const o=[`Unable to register library "${s}" with version "${t}":`];a&&o.push(`library name "${s}" contains illegal characters (whitespace or "/")`),a&&i&&o.push("and"),i&&o.push(`version name "${t}" contains illegal characters (whitespace or "/")`),ga.warn(o.join(" "));return}oi(new pa(`${s}-version`,()=>({library:s,version:t}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const MP="firebase-heartbeat-database",LP=1,Jc="firebase-heartbeat-store";let H0=null;function VT(){return H0||(H0=eP(MP,LP,{upgrade:(e,t)=>{switch(t){case 0:try{e.createObjectStore(Jc)}catch(r){console.warn(r)}}}}).catch(e=>{throw ri.create("idb-open",{originalErrorMessage:e.message})})),H0}async function jP(e){try{const r=(await VT()).transaction(Jc),n=await r.objectStore(Jc).get(BT(e));return await r.done,n}catch(t){if(t instanceof js)ga.warn(t.message);else{const r=ri.create("idb-get",{originalErrorMessage:t==null?void 0:t.message});ga.warn(r.message)}}}async function by(e,t){try{const n=(await VT()).transaction(Jc,"readwrite");await n.objectStore(Jc).put(t,BT(e)),await n.done}catch(r){if(r instanceof js)ga.warn(r.message);else{const n=ri.create("idb-set",{originalErrorMessage:r==null?void 0:r.message});ga.warn(n.message)}}}function BT(e){return`${e.name}!${e.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const UP=1024,VP=30*24*60*60*1e3;class BP{constructor(t){this.container=t,this._heartbeatsCache=null;const r=this.container.getProvider("app").getImmediate();this._storage=new $P(r),this._heartbeatsCachePromise=this._storage.read().then(n=>(this._heartbeatsCache=n,n))}async triggerHeartbeat(){var t,r;try{const s=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),a=Py();return((t=this._heartbeatsCache)===null||t===void 0?void 0:t.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((r=this._heartbeatsCache)===null||r===void 0?void 0:r.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===a||this._heartbeatsCache.heartbeats.some(i=>i.date===a)?void 0:(this._heartbeatsCache.heartbeats.push({date:a,agent:s}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(i=>{const o=new Date(i.date).valueOf();return Date.now()-o<=VP}),this._storage.overwrite(this._heartbeatsCache))}catch(n){ga.warn(n)}}async getHeartbeatsHeader(){var t;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((t=this._heartbeatsCache)===null||t===void 0?void 0:t.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const r=Py(),{heartbeatsToSend:n,unsentEntries:s}=zP(this._heartbeatsCache.heartbeats),a=Mh(JSON.stringify({version:2,heartbeats:n}));return this._heartbeatsCache.lastSentHeartbeatDate=r,s.length>0?(this._heartbeatsCache.heartbeats=s,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),a}catch(r){return ga.warn(r),""}}}function Py(){return new Date().toISOString().substring(0,10)}function zP(e,t=UP){const r=[];let n=e.slice();for(const s of e){const a=r.find(i=>i.agent===s.agent);if(a){if(a.dates.push(s.date),Dy(r)>t){a.dates.pop();break}}else if(r.push({agent:s.agent,dates:[s.date]}),Dy(r)>t){r.pop();break}n=n.slice(1)}return{heartbeatsToSend:r,unsentEntries:n}}class $P{constructor(t){this.app=t,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return Nb()?Rb().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const r=await jP(this.app);return r!=null&&r.heartbeats?r:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(t){var r;if(await this._canUseIndexedDBPromise){const s=await this.read();return by(this.app,{lastSentHeartbeatDate:(r=t.lastSentHeartbeatDate)!==null&&r!==void 0?r:s.lastSentHeartbeatDate,heartbeats:t.heartbeats})}else return}async add(t){var r;if(await this._canUseIndexedDBPromise){const s=await this.read();return by(this.app,{lastSentHeartbeatDate:(r=t.lastSentHeartbeatDate)!==null&&r!==void 0?r:s.lastSentHeartbeatDate,heartbeats:[...s.heartbeats,...t.heartbeats]})}else return}}function Dy(e){return Mh(JSON.stringify({version:2,heartbeats:e})).length}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function WP(e){oi(new pa("platform-logger",t=>new nP(t),"PRIVATE")),oi(new pa("heartbeat",t=>new BP(t),"PRIVATE")),Vn(cp,Ny,e),Vn(cp,Ny,"esm2017"),Vn("fire-js","")}WP("");function Qg(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,n=Object.getOwnPropertySymbols(e);s<n.length;s++)t.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(e,n[s])&&(r[n[s]]=e[n[s]]);return r}function zT(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const HP=zT,$T=new ku("auth","Firebase",zT());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Uh=new Xg("@firebase/auth");function GP(e,...t){Uh.logLevel<=Ze.WARN&&Uh.warn(`Auth (${ro}): ${e}`,...t)}function Jf(e,...t){Uh.logLevel<=Ze.ERROR&&Uh.error(`Auth (${ro}): ${e}`,...t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Rs(e,...t){throw Zg(e,...t)}function us(e,...t){return Zg(e,...t)}function Jg(e,t,r){const n=Object.assign(Object.assign({},HP()),{[t]:r});return new ku("auth","Firebase",n).create(t,{appName:e.name})}function Li(e){return Jg(e,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function KP(e,t,r){const n=r;if(!(t instanceof n))throw n.name!==t.constructor.name&&Rs(e,"argument-error"),Jg(e,"argument-error",`Type of ${t.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function Zg(e,...t){if(typeof e!="string"){const r=t[0],n=[...t.slice(1)];return n[0]&&(n[0].appName=e.name),e._errorFactory.create(r,...n)}return $T.create(e,...t)}function Me(e,t,...r){if(!e)throw Zg(t,...r)}function ta(e){const t="INTERNAL ASSERTION FAILED: "+e;throw Jf(t),new Error(t)}function xa(e,t){e||ta(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hp(){var e;return typeof self<"u"&&((e=self.location)===null||e===void 0?void 0:e.href)||""}function qP(){return Fy()==="http:"||Fy()==="https:"}function Fy(){var e;return typeof self<"u"&&((e=self.location)===null||e===void 0?void 0:e.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function XP(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(qP()||Sb()||"connection"in navigator)?navigator.onLine:!0}function YP(){if(typeof navigator>"u")return null;const e=navigator;return e.languages&&e.languages[0]||e.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Iu{constructor(t,r){this.shortDelay=t,this.longDelay=r,xa(r>t,"Short delay should be less than long delay!"),this.isMobile=Eb()||Ab()}get(){return XP()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ex(e,t){xa(e.emulator,"Emulator should always be set here");const{url:r}=e.emulator;return t?`${r}${t.startsWith("/")?t.slice(1):t}`:r}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class WT{static initialize(t,r,n){this.fetchImpl=t,r&&(this.headersImpl=r),n&&(this.responseImpl=n)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;ta("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;ta("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;ta("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const QP={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const JP=new Iu(3e4,6e4);function tx(e,t){return e.tenantId&&!t.tenantId?Object.assign(Object.assign({},t),{tenantId:e.tenantId}):t}async function El(e,t,r,n,s={}){return HT(e,s,async()=>{let a={},i={};n&&(t==="GET"?i=n:a={body:JSON.stringify(n)});const o=Su(Object.assign({key:e.config.apiKey},i)).slice(1),l=await e._getAdditionalHeaders();l["Content-Type"]="application/json",e.languageCode&&(l["X-Firebase-Locale"]=e.languageCode);const c=Object.assign({method:t,headers:l},a);return kb()||(c.referrerPolicy="no-referrer"),WT.fetch()(GT(e,e.config.apiHost,r,o),c)})}async function HT(e,t,r){e._canInitEmulator=!1;const n=Object.assign(Object.assign({},QP),t);try{const s=new eD(e),a=await Promise.race([r(),s.promise]);s.clearNetworkTimeout();const i=await a.json();if("needConfirmation"in i)throw kf(e,"account-exists-with-different-credential",i);if(a.ok&&!("errorMessage"in i))return i;{const o=a.ok?i.errorMessage:i.error.message,[l,c]=o.split(" : ");if(l==="FEDERATED_USER_ID_ALREADY_LINKED")throw kf(e,"credential-already-in-use",i);if(l==="EMAIL_EXISTS")throw kf(e,"email-already-in-use",i);if(l==="USER_DISABLED")throw kf(e,"user-disabled",i);const u=n[l]||l.toLowerCase().replace(/[_\s]+/g,"-");if(c)throw Jg(e,u,c);Rs(e,u)}}catch(s){if(s instanceof js)throw s;Rs(e,"network-request-failed",{message:String(s)})}}async function ZP(e,t,r,n,s={}){const a=await El(e,t,r,n,s);return"mfaPendingCredential"in a&&Rs(e,"multi-factor-auth-required",{_serverResponse:a}),a}function GT(e,t,r,n){const s=`${t}${r}?${n}`;return e.config.emulator?ex(e.config,s):`${e.config.apiScheme}://${s}`}class eD{constructor(t){this.auth=t,this.timer=null,this.promise=new Promise((r,n)=>{this.timer=setTimeout(()=>n(us(this.auth,"network-request-failed")),JP.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}}function kf(e,t,r){const n={appName:e.name};r.email&&(n.email=r.email),r.phoneNumber&&(n.phoneNumber=r.phoneNumber);const s=us(e,t,n);return s.customData._tokenResponse=r,s}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function tD(e,t){return El(e,"POST","/v1/accounts:delete",t)}async function KT(e,t){return El(e,"POST","/v1/accounts:lookup",t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vc(e){if(e)try{const t=new Date(Number(e));if(!isNaN(t.getTime()))return t.toUTCString()}catch{}}async function qT(e,t=!1){const r=Kt(e),n=await r.getIdToken(t),s=rx(n);Me(s&&s.exp&&s.auth_time&&s.iat,r.auth,"internal-error");const a=typeof s.firebase=="object"?s.firebase:void 0,i=a==null?void 0:a.sign_in_provider;return{claims:s,token:n,authTime:vc(G0(s.auth_time)),issuedAtTime:vc(G0(s.iat)),expirationTime:vc(G0(s.exp)),signInProvider:i||null,signInSecondFactor:(a==null?void 0:a.sign_in_second_factor)||null}}function G0(e){return Number(e)*1e3}function rx(e){const[t,r,n]=e.split(".");if(t===void 0||r===void 0||n===void 0)return Jf("JWT malformed, contained fewer than 3 sections"),null;try{const s=PT(r);return s?JSON.parse(s):(Jf("Failed to decode base64 JWT payload"),null)}catch(s){return Jf("Caught error parsing JWT payload as JSON",s==null?void 0:s.toString()),null}}function Oy(e){const t=rx(e);return Me(t,"internal-error"),Me(typeof t.exp<"u","internal-error"),Me(typeof t.iat<"u","internal-error"),Number(t.exp)-Number(t.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Zc(e,t,r=!1){if(r)return t;try{return await t}catch(n){throw n instanceof js&&rD(n)&&e.auth.currentUser===e&&await e.auth.signOut(),n}}function rD({code:e}){return e==="auth/user-disabled"||e==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nD{constructor(t){this.user=t,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(t){var r;if(t){const n=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),n}else{this.errorBackoff=3e4;const s=((r=this.user.stsTokenManager.expirationTime)!==null&&r!==void 0?r:0)-Date.now()-3e5;return Math.max(0,s)}}schedule(t=!1){if(!this.isRunning)return;const r=this.getInterval(t);this.timerId=setTimeout(async()=>{await this.iteration()},r)}async iteration(){try{await this.user.getIdToken(!0)}catch(t){(t==null?void 0:t.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dp{constructor(t,r){this.createdAt=t,this.lastLoginAt=r,this._initializeTime()}_initializeTime(){this.lastSignInTime=vc(this.lastLoginAt),this.creationTime=vc(this.createdAt)}_copy(t){this.createdAt=t.createdAt,this.lastLoginAt=t.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Vh(e){var t;const r=e.auth,n=await e.getIdToken(),s=await Zc(e,KT(r,{idToken:n}));Me(s==null?void 0:s.users.length,r,"internal-error");const a=s.users[0];e._notifyReloadListener(a);const i=!((t=a.providerUserInfo)===null||t===void 0)&&t.length?XT(a.providerUserInfo):[],o=aD(e.providerData,i),l=e.isAnonymous,c=!(e.email&&a.passwordHash)&&!(o!=null&&o.length),u=l?c:!1,d={uid:a.localId,displayName:a.displayName||null,photoURL:a.photoUrl||null,email:a.email||null,emailVerified:a.emailVerified||!1,phoneNumber:a.phoneNumber||null,tenantId:a.tenantId||null,providerData:o,metadata:new dp(a.createdAt,a.lastLoginAt),isAnonymous:u};Object.assign(e,d)}async function sD(e){const t=Kt(e);await Vh(t),await t.auth._persistUserIfCurrent(t),t.auth._notifyListenersIfCurrent(t)}function aD(e,t){return[...e.filter(n=>!t.some(s=>s.providerId===n.providerId)),...t]}function XT(e){return e.map(t=>{var{providerId:r}=t,n=Qg(t,["providerId"]);return{providerId:r,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function iD(e,t){const r=await HT(e,{},async()=>{const n=Su({grant_type:"refresh_token",refresh_token:t}).slice(1),{tokenApiHost:s,apiKey:a}=e.config,i=GT(e,s,"/v1/token",`key=${a}`),o=await e._getAdditionalHeaders();return o["Content-Type"]="application/x-www-form-urlencoded",WT.fetch()(i,{method:"POST",headers:o,body:n})});return{accessToken:r.access_token,expiresIn:r.expires_in,refreshToken:r.refresh_token}}async function oD(e,t){return El(e,"POST","/v2/accounts:revokeToken",tx(e,t))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ho{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(t){Me(t.idToken,"internal-error"),Me(typeof t.idToken<"u","internal-error"),Me(typeof t.refreshToken<"u","internal-error");const r="expiresIn"in t&&typeof t.expiresIn<"u"?Number(t.expiresIn):Oy(t.idToken);this.updateTokensAndExpiration(t.idToken,t.refreshToken,r)}updateFromIdToken(t){Me(t.length!==0,"internal-error");const r=Oy(t);this.updateTokensAndExpiration(t,null,r)}async getToken(t,r=!1){return!r&&this.accessToken&&!this.isExpired?this.accessToken:(Me(this.refreshToken,t,"user-token-expired"),this.refreshToken?(await this.refresh(t,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(t,r){const{accessToken:n,refreshToken:s,expiresIn:a}=await iD(t,r);this.updateTokensAndExpiration(n,s,Number(a))}updateTokensAndExpiration(t,r,n){this.refreshToken=r||null,this.accessToken=t||null,this.expirationTime=Date.now()+n*1e3}static fromJSON(t,r){const{refreshToken:n,accessToken:s,expirationTime:a}=r,i=new Ho;return n&&(Me(typeof n=="string","internal-error",{appName:t}),i.refreshToken=n),s&&(Me(typeof s=="string","internal-error",{appName:t}),i.accessToken=s),a&&(Me(typeof a=="number","internal-error",{appName:t}),i.expirationTime=a),i}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(t){this.accessToken=t.accessToken,this.refreshToken=t.refreshToken,this.expirationTime=t.expirationTime}_clone(){return Object.assign(new Ho,this.toJSON())}_performRefresh(){return ta("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ra(e,t){Me(typeof e=="string"||typeof e>"u","internal-error",{appName:t})}class ra{constructor(t){var{uid:r,auth:n,stsTokenManager:s}=t,a=Qg(t,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new nD(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=r,this.auth=n,this.stsTokenManager=s,this.accessToken=s.accessToken,this.displayName=a.displayName||null,this.email=a.email||null,this.emailVerified=a.emailVerified||!1,this.phoneNumber=a.phoneNumber||null,this.photoURL=a.photoURL||null,this.isAnonymous=a.isAnonymous||!1,this.tenantId=a.tenantId||null,this.providerData=a.providerData?[...a.providerData]:[],this.metadata=new dp(a.createdAt||void 0,a.lastLoginAt||void 0)}async getIdToken(t){const r=await Zc(this,this.stsTokenManager.getToken(this.auth,t));return Me(r,this.auth,"internal-error"),this.accessToken!==r&&(this.accessToken=r,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),r}getIdTokenResult(t){return qT(this,t)}reload(){return sD(this)}_assign(t){this!==t&&(Me(this.uid===t.uid,this.auth,"internal-error"),this.displayName=t.displayName,this.photoURL=t.photoURL,this.email=t.email,this.emailVerified=t.emailVerified,this.phoneNumber=t.phoneNumber,this.isAnonymous=t.isAnonymous,this.tenantId=t.tenantId,this.providerData=t.providerData.map(r=>Object.assign({},r)),this.metadata._copy(t.metadata),this.stsTokenManager._assign(t.stsTokenManager))}_clone(t){const r=new ra(Object.assign(Object.assign({},this),{auth:t,stsTokenManager:this.stsTokenManager._clone()}));return r.metadata._copy(this.metadata),r}_onReload(t){Me(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=t,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(t){this.reloadListener?this.reloadListener(t):this.reloadUserInfo=t}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(t,r=!1){let n=!1;t.idToken&&t.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(t),n=!0),r&&await Vh(this),await this.auth._persistUserIfCurrent(this),n&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(ea(this.auth.app))return Promise.reject(Li(this.auth));const t=await this.getIdToken();return await Zc(this,tD(this.auth,{idToken:t})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(t=>Object.assign({},t)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(t,r){var n,s,a,i,o,l,c,u;const d=(n=r.displayName)!==null&&n!==void 0?n:void 0,m=(s=r.email)!==null&&s!==void 0?s:void 0,p=(a=r.phoneNumber)!==null&&a!==void 0?a:void 0,x=(i=r.photoURL)!==null&&i!==void 0?i:void 0,g=(o=r.tenantId)!==null&&o!==void 0?o:void 0,_=(l=r._redirectEventId)!==null&&l!==void 0?l:void 0,k=(c=r.createdAt)!==null&&c!==void 0?c:void 0,T=(u=r.lastLoginAt)!==null&&u!==void 0?u:void 0,{uid:w,emailVerified:C,isAnonymous:M,providerData:O,stsTokenManager:v}=r;Me(w&&v,t,"internal-error");const E=Ho.fromJSON(this.name,v);Me(typeof w=="string",t,"internal-error"),Ra(d,t.name),Ra(m,t.name),Me(typeof C=="boolean",t,"internal-error"),Me(typeof M=="boolean",t,"internal-error"),Ra(p,t.name),Ra(x,t.name),Ra(g,t.name),Ra(_,t.name),Ra(k,t.name),Ra(T,t.name);const S=new ra({uid:w,auth:t,email:m,emailVerified:C,displayName:d,isAnonymous:M,photoURL:x,phoneNumber:p,tenantId:g,stsTokenManager:E,createdAt:k,lastLoginAt:T});return O&&Array.isArray(O)&&(S.providerData=O.map(R=>Object.assign({},R))),_&&(S._redirectEventId=_),S}static async _fromIdTokenResponse(t,r,n=!1){const s=new Ho;s.updateFromServerResponse(r);const a=new ra({uid:r.localId,auth:t,stsTokenManager:s,isAnonymous:n});return await Vh(a),a}static async _fromGetAccountInfoResponse(t,r,n){const s=r.users[0];Me(s.localId!==void 0,"internal-error");const a=s.providerUserInfo!==void 0?XT(s.providerUserInfo):[],i=!(s.email&&s.passwordHash)&&!(a!=null&&a.length),o=new Ho;o.updateFromIdToken(n);const l=new ra({uid:s.localId,auth:t,stsTokenManager:o,isAnonymous:i}),c={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:a,metadata:new dp(s.createdAt,s.lastLoginAt),isAnonymous:!(s.email&&s.passwordHash)&&!(a!=null&&a.length)};return Object.assign(l,c),l}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const My=new Map;function na(e){xa(e instanceof Function,"Expected a class definition");let t=My.get(e);return t?(xa(t instanceof e,"Instance stored in cache mismatched with class"),t):(t=new e,My.set(e,t),t)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YT{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(t,r){this.storage[t]=r}async _get(t){const r=this.storage[t];return r===void 0?null:r}async _remove(t){delete this.storage[t]}_addListener(t,r){}_removeListener(t,r){}}YT.type="NONE";const Ly=YT;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Zf(e,t,r){return`firebase:${e}:${t}:${r}`}class Go{constructor(t,r,n){this.persistence=t,this.auth=r,this.userKey=n;const{config:s,name:a}=this.auth;this.fullUserKey=Zf(this.userKey,s.apiKey,a),this.fullPersistenceKey=Zf("persistence",s.apiKey,a),this.boundEventHandler=r._onStorageEvent.bind(r),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(t){return this.persistence._set(this.fullUserKey,t.toJSON())}async getCurrentUser(){const t=await this.persistence._get(this.fullUserKey);return t?ra._fromJSON(this.auth,t):null}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(t){if(this.persistence===t)return;const r=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=t,r)return this.setCurrentUser(r)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(t,r,n="authUser"){if(!r.length)return new Go(na(Ly),t,n);const s=(await Promise.all(r.map(async c=>{if(await c._isAvailable())return c}))).filter(c=>c);let a=s[0]||na(Ly);const i=Zf(n,t.config.apiKey,t.name);let o=null;for(const c of r)try{const u=await c._get(i);if(u){const d=ra._fromJSON(t,u);c!==a&&(o=d),a=c;break}}catch{}const l=s.filter(c=>c._shouldAllowMigration);return!a._shouldAllowMigration||!l.length?new Go(a,t,n):(a=l[0],o&&await a._set(i,o.toJSON()),await Promise.all(r.map(async c=>{if(c!==a)try{await c._remove(i)}catch{}})),new Go(a,t,n))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jy(e){const t=e.toLowerCase();if(t.includes("opera/")||t.includes("opr/")||t.includes("opios/"))return"Opera";if(ek(t))return"IEMobile";if(t.includes("msie")||t.includes("trident/"))return"IE";if(t.includes("edge/"))return"Edge";if(QT(t))return"Firefox";if(t.includes("silk/"))return"Silk";if(rk(t))return"Blackberry";if(nk(t))return"Webos";if(JT(t))return"Safari";if((t.includes("chrome/")||ZT(t))&&!t.includes("edge/"))return"Chrome";if(tk(t))return"Android";{const r=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,n=e.match(r);if((n==null?void 0:n.length)===2)return n[1]}return"Other"}function QT(e=Hr()){return/firefox\//i.test(e)}function JT(e=Hr()){const t=e.toLowerCase();return t.includes("safari/")&&!t.includes("chrome/")&&!t.includes("crios/")&&!t.includes("android")}function ZT(e=Hr()){return/crios\//i.test(e)}function ek(e=Hr()){return/iemobile/i.test(e)}function tk(e=Hr()){return/android/i.test(e)}function rk(e=Hr()){return/blackberry/i.test(e)}function nk(e=Hr()){return/webos/i.test(e)}function nx(e=Hr()){return/iphone|ipad|ipod/i.test(e)||/macintosh/i.test(e)&&/mobile/i.test(e)}function lD(e=Hr()){var t;return nx(e)&&!!(!((t=window.navigator)===null||t===void 0)&&t.standalone)}function cD(){return Ib()&&document.documentMode===10}function sk(e=Hr()){return nx(e)||tk(e)||nk(e)||rk(e)||/windows phone/i.test(e)||ek(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ak(e,t=[]){let r;switch(e){case"Browser":r=jy(Hr());break;case"Worker":r=`${jy(Hr())}-${e}`;break;default:r=e}const n=t.length?t.join(","):"FirebaseCore-web";return`${r}/JsCore/${ro}/${n}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uD{constructor(t){this.auth=t,this.queue=[]}pushCallback(t,r){const n=a=>new Promise((i,o)=>{try{const l=t(a);i(l)}catch(l){o(l)}});n.onAbort=r,this.queue.push(n);const s=this.queue.length-1;return()=>{this.queue[s]=()=>Promise.resolve()}}async runMiddleware(t){if(this.auth.currentUser===t)return;const r=[];try{for(const n of this.queue)await n(t),n.onAbort&&r.push(n.onAbort)}catch(n){r.reverse();for(const s of r)try{s()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:n==null?void 0:n.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function fD(e,t={}){return El(e,"GET","/v2/passwordPolicy",tx(e,t))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hD=6;class dD{constructor(t){var r,n,s,a;const i=t.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(r=i.minPasswordLength)!==null&&r!==void 0?r:hD,i.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=i.maxPasswordLength),i.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=i.containsLowercaseCharacter),i.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=i.containsUppercaseCharacter),i.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=i.containsNumericCharacter),i.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=i.containsNonAlphanumericCharacter),this.enforcementState=t.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(s=(n=t.allowedNonAlphanumericCharacters)===null||n===void 0?void 0:n.join(""))!==null&&s!==void 0?s:"",this.forceUpgradeOnSignin=(a=t.forceUpgradeOnSignin)!==null&&a!==void 0?a:!1,this.schemaVersion=t.schemaVersion}validatePassword(t){var r,n,s,a,i,o;const l={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(t,l),this.validatePasswordCharacterOptions(t,l),l.isValid&&(l.isValid=(r=l.meetsMinPasswordLength)!==null&&r!==void 0?r:!0),l.isValid&&(l.isValid=(n=l.meetsMaxPasswordLength)!==null&&n!==void 0?n:!0),l.isValid&&(l.isValid=(s=l.containsLowercaseLetter)!==null&&s!==void 0?s:!0),l.isValid&&(l.isValid=(a=l.containsUppercaseLetter)!==null&&a!==void 0?a:!0),l.isValid&&(l.isValid=(i=l.containsNumericCharacter)!==null&&i!==void 0?i:!0),l.isValid&&(l.isValid=(o=l.containsNonAlphanumericCharacter)!==null&&o!==void 0?o:!0),l}validatePasswordLengthOptions(t,r){const n=this.customStrengthOptions.minPasswordLength,s=this.customStrengthOptions.maxPasswordLength;n&&(r.meetsMinPasswordLength=t.length>=n),s&&(r.meetsMaxPasswordLength=t.length<=s)}validatePasswordCharacterOptions(t,r){this.updatePasswordCharacterOptionsStatuses(r,!1,!1,!1,!1);let n;for(let s=0;s<t.length;s++)n=t.charAt(s),this.updatePasswordCharacterOptionsStatuses(r,n>="a"&&n<="z",n>="A"&&n<="Z",n>="0"&&n<="9",this.allowedNonAlphanumericCharacters.includes(n))}updatePasswordCharacterOptionsStatuses(t,r,n,s,a){this.customStrengthOptions.containsLowercaseLetter&&(t.containsLowercaseLetter||(t.containsLowercaseLetter=r)),this.customStrengthOptions.containsUppercaseLetter&&(t.containsUppercaseLetter||(t.containsUppercaseLetter=n)),this.customStrengthOptions.containsNumericCharacter&&(t.containsNumericCharacter||(t.containsNumericCharacter=s)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(t.containsNonAlphanumericCharacter||(t.containsNonAlphanumericCharacter=a))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mD{constructor(t,r,n,s){this.app=t,this.heartbeatServiceProvider=r,this.appCheckServiceProvider=n,this.config=s,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new Uy(this),this.idTokenSubscription=new Uy(this),this.beforeStateQueue=new uD(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=$T,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=t.name,this.clientVersion=s.sdkClientVersion}_initializeWithPersistence(t,r){return r&&(this._popupRedirectResolver=na(r)),this._initializationPromise=this.queue(async()=>{var n,s;if(!this._deleted&&(this.persistenceManager=await Go.create(this,t),!this._deleted)){if(!((n=this._popupRedirectResolver)===null||n===void 0)&&n._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(r),this.lastNotifiedUid=((s=this.currentUser)===null||s===void 0?void 0:s.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const t=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!t)){if(this.currentUser&&t&&this.currentUser.uid===t.uid){this._currentUser._assign(t),await this.currentUser.getIdToken();return}await this._updateCurrentUser(t,!0)}}async initializeCurrentUserFromIdToken(t){try{const r=await KT(this,{idToken:t}),n=await ra._fromGetAccountInfoResponse(this,r,t);await this.directlySetCurrentUser(n)}catch(r){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",r),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(t){var r;if(ea(this.app)){const i=this.app.settings.authIdToken;return i?new Promise(o=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(i).then(o,o))}):this.directlySetCurrentUser(null)}const n=await this.assertedPersistence.getCurrentUser();let s=n,a=!1;if(t&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const i=(r=this.redirectUser)===null||r===void 0?void 0:r._redirectEventId,o=s==null?void 0:s._redirectEventId,l=await this.tryRedirectSignIn(t);(!i||i===o)&&(l!=null&&l.user)&&(s=l.user,a=!0)}if(!s)return this.directlySetCurrentUser(null);if(!s._redirectEventId){if(a)try{await this.beforeStateQueue.runMiddleware(s)}catch(i){s=n,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(i))}return s?this.reloadAndSetCurrentUserOrClear(s):this.directlySetCurrentUser(null)}return Me(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===s._redirectEventId?this.directlySetCurrentUser(s):this.reloadAndSetCurrentUserOrClear(s)}async tryRedirectSignIn(t){let r=null;try{r=await this._popupRedirectResolver._completeRedirectFn(this,t,!0)}catch{await this._setRedirectUser(null)}return r}async reloadAndSetCurrentUserOrClear(t){try{await Vh(t)}catch(r){if((r==null?void 0:r.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(t)}useDeviceLanguage(){this.languageCode=YP()}async _delete(){this._deleted=!0}async updateCurrentUser(t){if(ea(this.app))return Promise.reject(Li(this));const r=t?Kt(t):null;return r&&Me(r.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(r&&r._clone(this))}async _updateCurrentUser(t,r=!1){if(!this._deleted)return t&&Me(this.tenantId===t.tenantId,this,"tenant-id-mismatch"),r||await this.beforeStateQueue.runMiddleware(t),this.queue(async()=>{await this.directlySetCurrentUser(t),this.notifyAuthListeners()})}async signOut(){return ea(this.app)?Promise.reject(Li(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(t){return ea(this.app)?Promise.reject(Li(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(na(t))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(t){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const r=this._getPasswordPolicyInternal();return r.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):r.validatePassword(t)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const t=await fD(this),r=new dD(t);this.tenantId===null?this._projectPasswordPolicy=r:this._tenantPasswordPolicies[this.tenantId]=r}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(t){this._errorFactory=new ku("auth","Firebase",t())}onAuthStateChanged(t,r,n){return this.registerStateListener(this.authStateSubscription,t,r,n)}beforeAuthStateChanged(t,r){return this.beforeStateQueue.pushCallback(t,r)}onIdTokenChanged(t,r,n){return this.registerStateListener(this.idTokenSubscription,t,r,n)}authStateReady(){return new Promise((t,r)=>{if(this.currentUser)t();else{const n=this.onAuthStateChanged(()=>{n(),t()},r)}})}async revokeAccessToken(t){if(this.currentUser){const r=await this.currentUser.getIdToken(),n={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:t,idToken:r};this.tenantId!=null&&(n.tenantId=this.tenantId),await oD(this,n)}}toJSON(){var t;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(t=this._currentUser)===null||t===void 0?void 0:t.toJSON()}}async _setRedirectUser(t,r){const n=await this.getOrInitRedirectPersistenceManager(r);return t===null?n.removeCurrentUser():n.setCurrentUser(t)}async getOrInitRedirectPersistenceManager(t){if(!this.redirectPersistenceManager){const r=t&&na(t)||this._popupRedirectResolver;Me(r,this,"argument-error"),this.redirectPersistenceManager=await Go.create(this,[na(r._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(t){var r,n;return this._isInitialized&&await this.queue(async()=>{}),((r=this._currentUser)===null||r===void 0?void 0:r._redirectEventId)===t?this._currentUser:((n=this.redirectUser)===null||n===void 0?void 0:n._redirectEventId)===t?this.redirectUser:null}async _persistUserIfCurrent(t){if(t===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(t))}_notifyListenersIfCurrent(t){t===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var t,r;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const n=(r=(t=this.currentUser)===null||t===void 0?void 0:t.uid)!==null&&r!==void 0?r:null;this.lastNotifiedUid!==n&&(this.lastNotifiedUid=n,this.authStateSubscription.next(this.currentUser))}registerStateListener(t,r,n,s){if(this._deleted)return()=>{};const a=typeof r=="function"?r:r.next.bind(r);let i=!1;const o=this._isInitialized?Promise.resolve():this._initializationPromise;if(Me(o,this,"internal-error"),o.then(()=>{i||a(this.currentUser)}),typeof r=="function"){const l=t.addObserver(r,n,s);return()=>{i=!0,l()}}else{const l=t.addObserver(r);return()=>{i=!0,l()}}}async directlySetCurrentUser(t){this.currentUser&&this.currentUser!==t&&this._currentUser._stopProactiveRefresh(),t&&this.isProactiveRefreshEnabled&&t._startProactiveRefresh(),this.currentUser=t,t?await this.assertedPersistence.setCurrentUser(t):await this.assertedPersistence.removeCurrentUser()}queue(t){return this.operations=this.operations.then(t,t),this.operations}get assertedPersistence(){return Me(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(t){!t||this.frameworks.includes(t)||(this.frameworks.push(t),this.frameworks.sort(),this.clientVersion=ak(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var t;const r={"X-Client-Version":this.clientVersion};this.app.options.appId&&(r["X-Firebase-gmpid"]=this.app.options.appId);const n=await((t=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||t===void 0?void 0:t.getHeartbeatsHeader());n&&(r["X-Firebase-Client"]=n);const s=await this._getAppCheckToken();return s&&(r["X-Firebase-AppCheck"]=s),r}async _getAppCheckToken(){var t;const r=await((t=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||t===void 0?void 0:t.getToken());return r!=null&&r.error&&GP(`Error while retrieving App Check token: ${r.error}`),r==null?void 0:r.token}}function Dd(e){return Kt(e)}class Uy{constructor(t){this.auth=t,this.observer=null,this.addObserver=Ob(r=>this.observer=r)}get next(){return Me(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let sx={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function pD(e){sx=e}function gD(e){return sx.loadJS(e)}function xD(){return sx.gapiScript}function vD(e){return`__${e}${Math.floor(Math.random()*1e6)}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yD(e,t){const r=Au(e,"auth");if(r.isInitialized()){const s=r.getImmediate(),a=r.getOptions();if(Lh(a,t??{}))return s;Rs(s,"already-initialized")}return r.initialize({options:t})}function _D(e,t){const r=(t==null?void 0:t.persistence)||[],n=(Array.isArray(r)?r:[r]).map(na);t!=null&&t.errorMap&&e._updateErrorMap(t.errorMap),e._initializeWithPersistence(n,t==null?void 0:t.popupRedirectResolver)}function wD(e,t,r){const n=Dd(e);Me(n._canInitEmulator,n,"emulator-config-failed"),Me(/^https?:\/\//.test(t),n,"invalid-emulator-scheme");const s=!1,a=ik(t),{host:i,port:o}=ED(t),l=o===null?"":`:${o}`;n.config.emulator={url:`${a}//${i}${l}/`},n.settings.appVerificationDisabledForTesting=!0,n.emulatorConfig=Object.freeze({host:i,port:o,protocol:a.replace(":",""),options:Object.freeze({disableWarnings:s})}),TD()}function ik(e){const t=e.indexOf(":");return t<0?"":e.substr(0,t+1)}function ED(e){const t=ik(e),r=/(\/\/)?([^?#/]+)/.exec(e.substr(t.length));if(!r)return{host:"",port:null};const n=r[2].split("@").pop()||"",s=/^(\[[^\]]+\])(:|$)/.exec(n);if(s){const a=s[1];return{host:a,port:Vy(n.substr(a.length+1))}}else{const[a,i]=n.split(":");return{host:a,port:Vy(i)}}}function Vy(e){if(!e)return null;const t=Number(e);return isNaN(t)?null:t}function TD(){function e(){const t=document.createElement("p"),r=t.style;t.innerText="Running in emulator mode. Do not use with production credentials.",r.position="fixed",r.width="100%",r.backgroundColor="#ffffff",r.border=".1em solid #000000",r.color="#b50000",r.bottom="0px",r.left="0px",r.margin="0px",r.zIndex="10000",r.textAlign="center",t.classList.add("firebase-emulator-warning"),document.body.appendChild(t)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",e):e())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ok{constructor(t,r){this.providerId=t,this.signInMethod=r}toJSON(){return ta("not implemented")}_getIdTokenResponse(t){return ta("not implemented")}_linkToIdToken(t,r){return ta("not implemented")}_getReauthenticationResolver(t){return ta("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Ko(e,t){return ZP(e,"POST","/v1/accounts:signInWithIdp",tx(e,t))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kD="http://localhost";class Ki extends ok{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(t){const r=new Ki(t.providerId,t.signInMethod);return t.idToken||t.accessToken?(t.idToken&&(r.idToken=t.idToken),t.accessToken&&(r.accessToken=t.accessToken),t.nonce&&!t.pendingToken&&(r.nonce=t.nonce),t.pendingToken&&(r.pendingToken=t.pendingToken)):t.oauthToken&&t.oauthTokenSecret?(r.accessToken=t.oauthToken,r.secret=t.oauthTokenSecret):Rs("argument-error"),r}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(t){const r=typeof t=="string"?JSON.parse(t):t,{providerId:n,signInMethod:s}=r,a=Qg(r,["providerId","signInMethod"]);if(!n||!s)return null;const i=new Ki(n,s);return i.idToken=a.idToken||void 0,i.accessToken=a.accessToken||void 0,i.secret=a.secret,i.nonce=a.nonce,i.pendingToken=a.pendingToken||null,i}_getIdTokenResponse(t){const r=this.buildRequest();return Ko(t,r)}_linkToIdToken(t,r){const n=this.buildRequest();return n.idToken=r,Ko(t,n)}_getReauthenticationResolver(t){const r=this.buildRequest();return r.autoCreate=!1,Ko(t,r)}buildRequest(){const t={requestUri:kD,returnSecureToken:!0};if(this.pendingToken)t.pendingToken=this.pendingToken;else{const r={};this.idToken&&(r.id_token=this.idToken),this.accessToken&&(r.access_token=this.accessToken),this.secret&&(r.oauth_token_secret=this.secret),r.providerId=this.providerId,this.nonce&&!this.pendingToken&&(r.nonce=this.nonce),t.postBody=Su(r)}return t}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ax{constructor(t){this.providerId=t,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(t){this.defaultLanguageCode=t}setCustomParameters(t){return this.customParameters=t,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cu extends ax{constructor(){super(...arguments),this.scopes=[]}addScope(t){return this.scopes.includes(t)||this.scopes.push(t),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class La extends Cu{constructor(){super("facebook.com")}static credential(t){return Ki._fromParams({providerId:La.PROVIDER_ID,signInMethod:La.FACEBOOK_SIGN_IN_METHOD,accessToken:t})}static credentialFromResult(t){return La.credentialFromTaggedObject(t)}static credentialFromError(t){return La.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t||!("oauthAccessToken"in t)||!t.oauthAccessToken)return null;try{return La.credential(t.oauthAccessToken)}catch{return null}}}La.FACEBOOK_SIGN_IN_METHOD="facebook.com";La.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Es extends Cu{constructor(){super("google.com"),this.addScope("profile")}static credential(t,r){return Ki._fromParams({providerId:Es.PROVIDER_ID,signInMethod:Es.GOOGLE_SIGN_IN_METHOD,idToken:t,accessToken:r})}static credentialFromResult(t){return Es.credentialFromTaggedObject(t)}static credentialFromError(t){return Es.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t)return null;const{oauthIdToken:r,oauthAccessToken:n}=t;if(!r&&!n)return null;try{return Es.credential(r,n)}catch{return null}}}Es.GOOGLE_SIGN_IN_METHOD="google.com";Es.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ja extends Cu{constructor(){super("github.com")}static credential(t){return Ki._fromParams({providerId:ja.PROVIDER_ID,signInMethod:ja.GITHUB_SIGN_IN_METHOD,accessToken:t})}static credentialFromResult(t){return ja.credentialFromTaggedObject(t)}static credentialFromError(t){return ja.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t||!("oauthAccessToken"in t)||!t.oauthAccessToken)return null;try{return ja.credential(t.oauthAccessToken)}catch{return null}}}ja.GITHUB_SIGN_IN_METHOD="github.com";ja.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ua extends Cu{constructor(){super("twitter.com")}static credential(t,r){return Ki._fromParams({providerId:Ua.PROVIDER_ID,signInMethod:Ua.TWITTER_SIGN_IN_METHOD,oauthToken:t,oauthTokenSecret:r})}static credentialFromResult(t){return Ua.credentialFromTaggedObject(t)}static credentialFromError(t){return Ua.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t)return null;const{oauthAccessToken:r,oauthTokenSecret:n}=t;if(!r||!n)return null;try{return Ua.credential(r,n)}catch{return null}}}Ua.TWITTER_SIGN_IN_METHOD="twitter.com";Ua.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ll{constructor(t){this.user=t.user,this.providerId=t.providerId,this._tokenResponse=t._tokenResponse,this.operationType=t.operationType}static async _fromIdTokenResponse(t,r,n,s=!1){const a=await ra._fromIdTokenResponse(t,n,s),i=By(n);return new ll({user:a,providerId:i,_tokenResponse:n,operationType:r})}static async _forOperation(t,r,n){await t._updateTokensIfNecessary(n,!0);const s=By(n);return new ll({user:t,providerId:s,_tokenResponse:n,operationType:r})}}function By(e){return e.providerId?e.providerId:"phoneNumber"in e?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bh extends js{constructor(t,r,n,s){var a;super(r.code,r.message),this.operationType=n,this.user=s,Object.setPrototypeOf(this,Bh.prototype),this.customData={appName:t.name,tenantId:(a=t.tenantId)!==null&&a!==void 0?a:void 0,_serverResponse:r.customData._serverResponse,operationType:n}}static _fromErrorAndOperation(t,r,n,s){return new Bh(t,r,n,s)}}function lk(e,t,r,n){return(t==="reauthenticate"?r._getReauthenticationResolver(e):r._getIdTokenResponse(e)).catch(a=>{throw a.code==="auth/multi-factor-auth-required"?Bh._fromErrorAndOperation(e,a,t,n):a})}async function SD(e,t,r=!1){const n=await Zc(e,t._linkToIdToken(e.auth,await e.getIdToken()),r);return ll._forOperation(e,"link",n)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function AD(e,t,r=!1){const{auth:n}=e;if(ea(n.app))return Promise.reject(Li(n));const s="reauthenticate";try{const a=await Zc(e,lk(n,s,t,e),r);Me(a.idToken,n,"internal-error");const i=rx(a.idToken);Me(i,n,"internal-error");const{sub:o}=i;return Me(e.uid===o,n,"user-mismatch"),ll._forOperation(e,s,a)}catch(a){throw(a==null?void 0:a.code)==="auth/user-not-found"&&Rs(n,"user-mismatch"),a}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ID(e,t,r=!1){if(ea(e.app))return Promise.reject(Li(e));const n="signIn",s=await lk(e,n,t),a=await ll._fromIdTokenResponse(e,n,s);return r||await e._updateCurrentUser(a.user),a}function CD(e,t,r,n){return Kt(e).onIdTokenChanged(t,r,n)}function ND(e,t,r){return Kt(e).beforeAuthStateChanged(t,r)}function ck(e,t,r,n){return Kt(e).onAuthStateChanged(t,r,n)}function RD(e){return Kt(e).signOut()}const zh="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uk{constructor(t,r){this.storageRetriever=t,this.type=r}_isAvailable(){try{return this.storage?(this.storage.setItem(zh,"1"),this.storage.removeItem(zh),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(t,r){return this.storage.setItem(t,JSON.stringify(r)),Promise.resolve()}_get(t){const r=this.storage.getItem(t);return Promise.resolve(r?JSON.parse(r):null)}_remove(t){return this.storage.removeItem(t),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bD=1e3,PD=10;class fk extends uk{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(t,r)=>this.onStorageEvent(t,r),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=sk(),this._shouldAllowMigration=!0}forAllChangedKeys(t){for(const r of Object.keys(this.listeners)){const n=this.storage.getItem(r),s=this.localCache[r];n!==s&&t(r,s,n)}}onStorageEvent(t,r=!1){if(!t.key){this.forAllChangedKeys((i,o,l)=>{this.notifyListeners(i,l)});return}const n=t.key;r?this.detachListener():this.stopPolling();const s=()=>{const i=this.storage.getItem(n);!r&&this.localCache[n]===i||this.notifyListeners(n,i)},a=this.storage.getItem(n);cD()&&a!==t.newValue&&t.newValue!==t.oldValue?setTimeout(s,PD):s()}notifyListeners(t,r){this.localCache[t]=r;const n=this.listeners[t];if(n)for(const s of Array.from(n))s(r&&JSON.parse(r))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((t,r,n)=>{this.onStorageEvent(new StorageEvent("storage",{key:t,oldValue:r,newValue:n}),!0)})},bD)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(t,r){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[t]||(this.listeners[t]=new Set,this.localCache[t]=this.storage.getItem(t)),this.listeners[t].add(r)}_removeListener(t,r){this.listeners[t]&&(this.listeners[t].delete(r),this.listeners[t].size===0&&delete this.listeners[t]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(t,r){await super._set(t,r),this.localCache[t]=JSON.stringify(r)}async _get(t){const r=await super._get(t);return this.localCache[t]=JSON.stringify(r),r}async _remove(t){await super._remove(t),delete this.localCache[t]}}fk.type="LOCAL";const DD=fk;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hk extends uk{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(t,r){}_removeListener(t,r){}}hk.type="SESSION";const dk=hk;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function FD(e){return Promise.all(e.map(async t=>{try{return{fulfilled:!0,value:await t}}catch(r){return{fulfilled:!1,reason:r}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fd{constructor(t){this.eventTarget=t,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(t){const r=this.receivers.find(s=>s.isListeningto(t));if(r)return r;const n=new Fd(t);return this.receivers.push(n),n}isListeningto(t){return this.eventTarget===t}async handleEvent(t){const r=t,{eventId:n,eventType:s,data:a}=r.data,i=this.handlersMap[s];if(!(i!=null&&i.size))return;r.ports[0].postMessage({status:"ack",eventId:n,eventType:s});const o=Array.from(i).map(async c=>c(r.origin,a)),l=await FD(o);r.ports[0].postMessage({status:"done",eventId:n,eventType:s,response:l})}_subscribe(t,r){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[t]||(this.handlersMap[t]=new Set),this.handlersMap[t].add(r)}_unsubscribe(t,r){this.handlersMap[t]&&r&&this.handlersMap[t].delete(r),(!r||this.handlersMap[t].size===0)&&delete this.handlersMap[t],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}Fd.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ix(e="",t=10){let r="";for(let n=0;n<t;n++)r+=Math.floor(Math.random()*10);return e+r}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OD{constructor(t){this.target=t,this.handlers=new Set}removeMessageHandler(t){t.messageChannel&&(t.messageChannel.port1.removeEventListener("message",t.onMessage),t.messageChannel.port1.close()),this.handlers.delete(t)}async _send(t,r,n=50){const s=typeof MessageChannel<"u"?new MessageChannel:null;if(!s)throw new Error("connection_unavailable");let a,i;return new Promise((o,l)=>{const c=ix("",20);s.port1.start();const u=setTimeout(()=>{l(new Error("unsupported_event"))},n);i={messageChannel:s,onMessage(d){const m=d;if(m.data.eventId===c)switch(m.data.status){case"ack":clearTimeout(u),a=setTimeout(()=>{l(new Error("timeout"))},3e3);break;case"done":clearTimeout(a),o(m.data.response);break;default:clearTimeout(u),clearTimeout(a),l(new Error("invalid_response"));break}}},this.handlers.add(i),s.port1.addEventListener("message",i.onMessage),this.target.postMessage({eventType:t,eventId:c,data:r},[s.port2])}).finally(()=>{i&&this.removeMessageHandler(i)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function As(){return window}function MD(e){As().location.href=e}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mk(){return typeof As().WorkerGlobalScope<"u"&&typeof As().importScripts=="function"}async function LD(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function jD(){var e;return((e=navigator==null?void 0:navigator.serviceWorker)===null||e===void 0?void 0:e.controller)||null}function UD(){return mk()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pk="firebaseLocalStorageDb",VD=1,$h="firebaseLocalStorage",gk="fbase_key";class Nu{constructor(t){this.request=t}toPromise(){return new Promise((t,r)=>{this.request.addEventListener("success",()=>{t(this.request.result)}),this.request.addEventListener("error",()=>{r(this.request.error)})})}}function Od(e,t){return e.transaction([$h],t?"readwrite":"readonly").objectStore($h)}function BD(){const e=indexedDB.deleteDatabase(pk);return new Nu(e).toPromise()}function mp(){const e=indexedDB.open(pk,VD);return new Promise((t,r)=>{e.addEventListener("error",()=>{r(e.error)}),e.addEventListener("upgradeneeded",()=>{const n=e.result;try{n.createObjectStore($h,{keyPath:gk})}catch(s){r(s)}}),e.addEventListener("success",async()=>{const n=e.result;n.objectStoreNames.contains($h)?t(n):(n.close(),await BD(),t(await mp()))})})}async function zy(e,t,r){const n=Od(e,!0).put({[gk]:t,value:r});return new Nu(n).toPromise()}async function zD(e,t){const r=Od(e,!1).get(t),n=await new Nu(r).toPromise();return n===void 0?null:n.value}function $y(e,t){const r=Od(e,!0).delete(t);return new Nu(r).toPromise()}const $D=800,WD=3;class xk{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await mp(),this.db)}async _withRetries(t){let r=0;for(;;)try{const n=await this._openDb();return await t(n)}catch(n){if(r++>WD)throw n;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return mk()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=Fd._getInstance(UD()),this.receiver._subscribe("keyChanged",async(t,r)=>({keyProcessed:(await this._poll()).includes(r.key)})),this.receiver._subscribe("ping",async(t,r)=>["keyChanged"])}async initializeSender(){var t,r;if(this.activeServiceWorker=await LD(),!this.activeServiceWorker)return;this.sender=new OD(this.activeServiceWorker);const n=await this.sender._send("ping",{},800);n&&!((t=n[0])===null||t===void 0)&&t.fulfilled&&!((r=n[0])===null||r===void 0)&&r.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(t){if(!(!this.sender||!this.activeServiceWorker||jD()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:t},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const t=await mp();return await zy(t,zh,"1"),await $y(t,zh),!0}catch{}return!1}async _withPendingWrite(t){this.pendingWrites++;try{await t()}finally{this.pendingWrites--}}async _set(t,r){return this._withPendingWrite(async()=>(await this._withRetries(n=>zy(n,t,r)),this.localCache[t]=r,this.notifyServiceWorker(t)))}async _get(t){const r=await this._withRetries(n=>zD(n,t));return this.localCache[t]=r,r}async _remove(t){return this._withPendingWrite(async()=>(await this._withRetries(r=>$y(r,t)),delete this.localCache[t],this.notifyServiceWorker(t)))}async _poll(){const t=await this._withRetries(s=>{const a=Od(s,!1).getAll();return new Nu(a).toPromise()});if(!t)return[];if(this.pendingWrites!==0)return[];const r=[],n=new Set;if(t.length!==0)for(const{fbase_key:s,value:a}of t)n.add(s),JSON.stringify(this.localCache[s])!==JSON.stringify(a)&&(this.notifyListeners(s,a),r.push(s));for(const s of Object.keys(this.localCache))this.localCache[s]&&!n.has(s)&&(this.notifyListeners(s,null),r.push(s));return r}notifyListeners(t,r){this.localCache[t]=r;const n=this.listeners[t];if(n)for(const s of Array.from(n))s(r)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),$D)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(t,r){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[t]||(this.listeners[t]=new Set,this._get(t)),this.listeners[t].add(r)}_removeListener(t,r){this.listeners[t]&&(this.listeners[t].delete(r),this.listeners[t].size===0&&delete this.listeners[t]),Object.keys(this.listeners).length===0&&this.stopPolling()}}xk.type="LOCAL";const HD=xk;new Iu(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vk(e,t){return t?na(t):(Me(e._popupRedirectResolver,e,"argument-error"),e._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ox extends ok{constructor(t){super("custom","custom"),this.params=t}_getIdTokenResponse(t){return Ko(t,this._buildIdpRequest())}_linkToIdToken(t,r){return Ko(t,this._buildIdpRequest(r))}_getReauthenticationResolver(t){return Ko(t,this._buildIdpRequest())}_buildIdpRequest(t){const r={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return t&&(r.idToken=t),r}}function GD(e){return ID(e.auth,new ox(e),e.bypassAuthState)}function KD(e){const{auth:t,user:r}=e;return Me(r,t,"internal-error"),AD(r,new ox(e),e.bypassAuthState)}async function qD(e){const{auth:t,user:r}=e;return Me(r,t,"internal-error"),SD(r,new ox(e),e.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yk{constructor(t,r,n,s,a=!1){this.auth=t,this.resolver=n,this.user=s,this.bypassAuthState=a,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(r)?r:[r]}execute(){return new Promise(async(t,r)=>{this.pendingPromise={resolve:t,reject:r};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(n){this.reject(n)}})}async onAuthEvent(t){const{urlResponse:r,sessionId:n,postBody:s,tenantId:a,error:i,type:o}=t;if(i){this.reject(i);return}const l={auth:this.auth,requestUri:r,sessionId:n,tenantId:a||void 0,postBody:s||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(o)(l))}catch(c){this.reject(c)}}onError(t){this.reject(t)}getIdpTask(t){switch(t){case"signInViaPopup":case"signInViaRedirect":return GD;case"linkViaPopup":case"linkViaRedirect":return qD;case"reauthViaPopup":case"reauthViaRedirect":return KD;default:Rs(this.auth,"internal-error")}}resolve(t){xa(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(t),this.unregisterAndCleanUp()}reject(t){xa(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(t),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const XD=new Iu(2e3,1e4);async function _k(e,t,r){if(ea(e.app))return Promise.reject(us(e,"operation-not-supported-in-this-environment"));const n=Dd(e);KP(e,t,ax);const s=vk(n,r);return new Pi(n,"signInViaPopup",t,s).executeNotNull()}class Pi extends yk{constructor(t,r,n,s,a){super(t,r,s,a),this.provider=n,this.authWindow=null,this.pollId=null,Pi.currentPopupAction&&Pi.currentPopupAction.cancel(),Pi.currentPopupAction=this}async executeNotNull(){const t=await this.execute();return Me(t,this.auth,"internal-error"),t}async onExecution(){xa(this.filter.length===1,"Popup operations only handle one event");const t=ix();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],t),this.authWindow.associatedEvent=t,this.resolver._originValidation(this.auth).catch(r=>{this.reject(r)}),this.resolver._isIframeWebStorageSupported(this.auth,r=>{r||this.reject(us(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var t;return((t=this.authWindow)===null||t===void 0?void 0:t.associatedEvent)||null}cancel(){this.reject(us(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Pi.currentPopupAction=null}pollUserCancellation(){const t=()=>{var r,n;if(!((n=(r=this.authWindow)===null||r===void 0?void 0:r.window)===null||n===void 0)&&n.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(us(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(t,XD.get())};t()}}Pi.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const YD="pendingRedirect",eh=new Map;class QD extends yk{constructor(t,r,n=!1){super(t,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],r,void 0,n),this.eventId=null}async execute(){let t=eh.get(this.auth._key());if(!t){try{const n=await JD(this.resolver,this.auth)?await super.execute():null;t=()=>Promise.resolve(n)}catch(r){t=()=>Promise.reject(r)}eh.set(this.auth._key(),t)}return this.bypassAuthState||eh.set(this.auth._key(),()=>Promise.resolve(null)),t()}async onAuthEvent(t){if(t.type==="signInViaRedirect")return super.onAuthEvent(t);if(t.type==="unknown"){this.resolve(null);return}if(t.eventId){const r=await this.auth._redirectUserForId(t.eventId);if(r)return this.user=r,super.onAuthEvent(t);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function JD(e,t){const r=t3(t),n=e3(e);if(!await n._isAvailable())return!1;const s=await n._get(r)==="true";return await n._remove(r),s}function ZD(e,t){eh.set(e._key(),t)}function e3(e){return na(e._redirectPersistence)}function t3(e){return Zf(YD,e.config.apiKey,e.name)}async function r3(e,t,r=!1){if(ea(e.app))return Promise.reject(Li(e));const n=Dd(e),s=vk(n,t),i=await new QD(n,s,r).execute();return i&&!r&&(delete i.user._redirectEventId,await n._persistUserIfCurrent(i.user),await n._setRedirectUser(null,t)),i}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const n3=10*60*1e3;class s3{constructor(t){this.auth=t,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(t){this.consumers.add(t),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,t)&&(this.sendToConsumer(this.queuedRedirectEvent,t),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(t){this.consumers.delete(t)}onEvent(t){if(this.hasEventBeenHandled(t))return!1;let r=!1;return this.consumers.forEach(n=>{this.isEventForConsumer(t,n)&&(r=!0,this.sendToConsumer(t,n),this.saveEventToCache(t))}),this.hasHandledPotentialRedirect||!a3(t)||(this.hasHandledPotentialRedirect=!0,r||(this.queuedRedirectEvent=t,r=!0)),r}sendToConsumer(t,r){var n;if(t.error&&!wk(t)){const s=((n=t.error.code)===null||n===void 0?void 0:n.split("auth/")[1])||"internal-error";r.onError(us(this.auth,s))}else r.onAuthEvent(t)}isEventForConsumer(t,r){const n=r.eventId===null||!!t.eventId&&t.eventId===r.eventId;return r.filter.includes(t.type)&&n}hasEventBeenHandled(t){return Date.now()-this.lastProcessedEventTime>=n3&&this.cachedEventUids.clear(),this.cachedEventUids.has(Wy(t))}saveEventToCache(t){this.cachedEventUids.add(Wy(t)),this.lastProcessedEventTime=Date.now()}}function Wy(e){return[e.type,e.eventId,e.sessionId,e.tenantId].filter(t=>t).join("-")}function wk({type:e,error:t}){return e==="unknown"&&(t==null?void 0:t.code)==="auth/no-auth-event"}function a3(e){switch(e.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return wk(e);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function i3(e,t={}){return El(e,"GET","/v1/projects",t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const o3=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,l3=/^https?/;async function c3(e){if(e.config.emulator)return;const{authorizedDomains:t}=await i3(e);for(const r of t)try{if(u3(r))return}catch{}Rs(e,"unauthorized-domain")}function u3(e){const t=hp(),{protocol:r,hostname:n}=new URL(t);if(e.startsWith("chrome-extension://")){const i=new URL(e);return i.hostname===""&&n===""?r==="chrome-extension:"&&e.replace("chrome-extension://","")===t.replace("chrome-extension://",""):r==="chrome-extension:"&&i.hostname===n}if(!l3.test(r))return!1;if(o3.test(e))return n===e;const s=e.replace(/\./g,"\\.");return new RegExp("^(.+\\."+s+"|"+s+")$","i").test(n)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const f3=new Iu(3e4,6e4);function Hy(){const e=As().___jsl;if(e!=null&&e.H){for(const t of Object.keys(e.H))if(e.H[t].r=e.H[t].r||[],e.H[t].L=e.H[t].L||[],e.H[t].r=[...e.H[t].L],e.CP)for(let r=0;r<e.CP.length;r++)e.CP[r]=null}}function h3(e){return new Promise((t,r)=>{var n,s,a;function i(){Hy(),gapi.load("gapi.iframes",{callback:()=>{t(gapi.iframes.getContext())},ontimeout:()=>{Hy(),r(us(e,"network-request-failed"))},timeout:f3.get()})}if(!((s=(n=As().gapi)===null||n===void 0?void 0:n.iframes)===null||s===void 0)&&s.Iframe)t(gapi.iframes.getContext());else if(!((a=As().gapi)===null||a===void 0)&&a.load)i();else{const o=vD("iframefcb");return As()[o]=()=>{gapi.load?i():r(us(e,"network-request-failed"))},gD(`${xD()}?onload=${o}`).catch(l=>r(l))}}).catch(t=>{throw th=null,t})}let th=null;function d3(e){return th=th||h3(e),th}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const m3=new Iu(5e3,15e3),p3="__/auth/iframe",g3="emulator/auth/iframe",x3={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},v3=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function y3(e){const t=e.config;Me(t.authDomain,e,"auth-domain-config-required");const r=t.emulator?ex(t,g3):`https://${e.config.authDomain}/${p3}`,n={apiKey:t.apiKey,appName:e.name,v:ro},s=v3.get(e.config.apiHost);s&&(n.eid=s);const a=e._getFrameworks();return a.length&&(n.fw=a.join(",")),`${r}?${Su(n).slice(1)}`}async function _3(e){const t=await d3(e),r=As().gapi;return Me(r,e,"internal-error"),t.open({where:document.body,url:y3(e),messageHandlersFilter:r.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:x3,dontclear:!0},n=>new Promise(async(s,a)=>{await n.restyle({setHideOnLeave:!1});const i=us(e,"network-request-failed"),o=As().setTimeout(()=>{a(i)},m3.get());function l(){As().clearTimeout(o),s(n)}n.ping(l).then(l,()=>{a(i)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const w3={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},E3=500,T3=600,k3="_blank",S3="http://localhost";class Gy{constructor(t){this.window=t,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function A3(e,t,r,n=E3,s=T3){const a=Math.max((window.screen.availHeight-s)/2,0).toString(),i=Math.max((window.screen.availWidth-n)/2,0).toString();let o="";const l=Object.assign(Object.assign({},w3),{width:n.toString(),height:s.toString(),top:a,left:i}),c=Hr().toLowerCase();r&&(o=ZT(c)?k3:r),QT(c)&&(t=t||S3,l.scrollbars="yes");const u=Object.entries(l).reduce((m,[p,x])=>`${m}${p}=${x},`,"");if(lD(c)&&o!=="_self")return I3(t||"",o),new Gy(null);const d=window.open(t||"",o,u);Me(d,e,"popup-blocked");try{d.focus()}catch{}return new Gy(d)}function I3(e,t){const r=document.createElement("a");r.href=e,r.target=t;const n=document.createEvent("MouseEvent");n.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),r.dispatchEvent(n)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const C3="__/auth/handler",N3="emulator/auth/handler",R3=encodeURIComponent("fac");async function Ky(e,t,r,n,s,a){Me(e.config.authDomain,e,"auth-domain-config-required"),Me(e.config.apiKey,e,"invalid-api-key");const i={apiKey:e.config.apiKey,appName:e.name,authType:r,redirectUrl:n,v:ro,eventId:s};if(t instanceof ax){t.setDefaultLanguage(e.languageCode),i.providerId=t.providerId||"",Fb(t.getCustomParameters())||(i.customParameters=JSON.stringify(t.getCustomParameters()));for(const[u,d]of Object.entries({}))i[u]=d}if(t instanceof Cu){const u=t.getScopes().filter(d=>d!=="");u.length>0&&(i.scopes=u.join(","))}e.tenantId&&(i.tid=e.tenantId);const o=i;for(const u of Object.keys(o))o[u]===void 0&&delete o[u];const l=await e._getAppCheckToken(),c=l?`#${R3}=${encodeURIComponent(l)}`:"";return`${b3(e)}?${Su(o).slice(1)}${c}`}function b3({config:e}){return e.emulator?ex(e,N3):`https://${e.authDomain}/${C3}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const K0="webStorageSupport";class P3{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=dk,this._completeRedirectFn=r3,this._overrideRedirectResult=ZD}async _openPopup(t,r,n,s){var a;xa((a=this.eventManagers[t._key()])===null||a===void 0?void 0:a.manager,"_initialize() not called before _openPopup()");const i=await Ky(t,r,n,hp(),s);return A3(t,i,ix())}async _openRedirect(t,r,n,s){await this._originValidation(t);const a=await Ky(t,r,n,hp(),s);return MD(a),new Promise(()=>{})}_initialize(t){const r=t._key();if(this.eventManagers[r]){const{manager:s,promise:a}=this.eventManagers[r];return s?Promise.resolve(s):(xa(a,"If manager is not set, promise should be"),a)}const n=this.initAndGetManager(t);return this.eventManagers[r]={promise:n},n.catch(()=>{delete this.eventManagers[r]}),n}async initAndGetManager(t){const r=await _3(t),n=new s3(t);return r.register("authEvent",s=>(Me(s==null?void 0:s.authEvent,t,"invalid-auth-event"),{status:n.onEvent(s.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[t._key()]={manager:n},this.iframes[t._key()]=r,n}_isIframeWebStorageSupported(t,r){this.iframes[t._key()].send(K0,{type:K0},s=>{var a;const i=(a=s==null?void 0:s[0])===null||a===void 0?void 0:a[K0];i!==void 0&&r(!!i),Rs(t,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(t){const r=t._key();return this.originValidationPromises[r]||(this.originValidationPromises[r]=c3(t)),this.originValidationPromises[r]}get _shouldInitProactively(){return sk()||JT()||nx()}}const D3=P3;var qy="@firebase/auth",Xy="1.7.9";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class F3{constructor(t){this.auth=t,this.internalListeners=new Map}getUid(){var t;return this.assertAuthConfigured(),((t=this.auth.currentUser)===null||t===void 0?void 0:t.uid)||null}async getToken(t){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(t)}:null}addAuthTokenListener(t){if(this.assertAuthConfigured(),this.internalListeners.has(t))return;const r=this.auth.onIdTokenChanged(n=>{t((n==null?void 0:n.stsTokenManager.accessToken)||null)});this.internalListeners.set(t,r),this.updateProactiveRefresh()}removeAuthTokenListener(t){this.assertAuthConfigured();const r=this.internalListeners.get(t);r&&(this.internalListeners.delete(t),r(),this.updateProactiveRefresh())}assertAuthConfigured(){Me(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function O3(e){switch(e){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function M3(e){oi(new pa("auth",(t,{options:r})=>{const n=t.getProvider("app").getImmediate(),s=t.getProvider("heartbeat"),a=t.getProvider("app-check-internal"),{apiKey:i,authDomain:o}=n.options;Me(i&&!i.includes(":"),"invalid-api-key",{appName:n.name});const l={apiKey:i,authDomain:o,clientPlatform:e,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:ak(e)},c=new mD(n,s,a,l);return _D(c,r),c},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((t,r,n)=>{t.getProvider("auth-internal").initialize()})),oi(new pa("auth-internal",t=>{const r=Dd(t.getProvider("auth").getImmediate());return(n=>new F3(n))(r)},"PRIVATE").setInstantiationMode("EXPLICIT")),Vn(qy,Xy,O3(e)),Vn(qy,Xy,"esm2017")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const L3=5*60,j3=OT("authIdTokenMaxAge")||L3;let Yy=null;const U3=e=>async t=>{const r=t&&await t.getIdTokenResult(),n=r&&(new Date().getTime()-Date.parse(r.issuedAtTime))/1e3;if(n&&n>j3)return;const s=r==null?void 0:r.token;Yy!==s&&(Yy=s,await fetch(e,{method:s?"POST":"DELETE",headers:s?{Authorization:`Bearer ${s}`}:{}}))};function V3(e=Pd()){const t=Au(e,"auth");if(t.isInitialized())return t.getImmediate();const r=yD(e,{popupRedirectResolver:D3,persistence:[HD,DD,dk]}),n=OT("authTokenSyncURL");if(n&&typeof isSecureContext=="boolean"&&isSecureContext){const a=new URL(n,location.origin);if(location.origin===a.origin){const i=U3(a.toString());ND(r,i,()=>i(r.currentUser)),CD(r,o=>i(o))}}const s=DT("auth");return s&&wD(r,`http://${s}`),r}function B3(){var e,t;return(t=(e=document.getElementsByTagName("head"))===null||e===void 0?void 0:e[0])!==null&&t!==void 0?t:document}pD({loadJS(e){return new Promise((t,r)=>{const n=document.createElement("script");n.setAttribute("src",e),n.onload=t,n.onerror=s=>{const a=us("internal-error");a.customData=s,r(a)},n.type="text/javascript",n.charset="UTF-8",B3().appendChild(n)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});M3("Browser");var Qy=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var ji,Ek;(function(){var e;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function t(v,E){function S(){}S.prototype=E.prototype,v.D=E.prototype,v.prototype=new S,v.prototype.constructor=v,v.C=function(R,P,D){for(var N=Array(arguments.length-2),ce=2;ce<arguments.length;ce++)N[ce-2]=arguments[ce];return E.prototype[P].apply(R,N)}}function r(){this.blockSize=-1}function n(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}t(n,r),n.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function s(v,E,S){S||(S=0);var R=Array(16);if(typeof E=="string")for(var P=0;16>P;++P)R[P]=E.charCodeAt(S++)|E.charCodeAt(S++)<<8|E.charCodeAt(S++)<<16|E.charCodeAt(S++)<<24;else for(P=0;16>P;++P)R[P]=E[S++]|E[S++]<<8|E[S++]<<16|E[S++]<<24;E=v.g[0],S=v.g[1],P=v.g[2];var D=v.g[3],N=E+(D^S&(P^D))+R[0]+3614090360&4294967295;E=S+(N<<7&4294967295|N>>>25),N=D+(P^E&(S^P))+R[1]+3905402710&4294967295,D=E+(N<<12&4294967295|N>>>20),N=P+(S^D&(E^S))+R[2]+606105819&4294967295,P=D+(N<<17&4294967295|N>>>15),N=S+(E^P&(D^E))+R[3]+3250441966&4294967295,S=P+(N<<22&4294967295|N>>>10),N=E+(D^S&(P^D))+R[4]+4118548399&4294967295,E=S+(N<<7&4294967295|N>>>25),N=D+(P^E&(S^P))+R[5]+1200080426&4294967295,D=E+(N<<12&4294967295|N>>>20),N=P+(S^D&(E^S))+R[6]+2821735955&4294967295,P=D+(N<<17&4294967295|N>>>15),N=S+(E^P&(D^E))+R[7]+4249261313&4294967295,S=P+(N<<22&4294967295|N>>>10),N=E+(D^S&(P^D))+R[8]+1770035416&4294967295,E=S+(N<<7&4294967295|N>>>25),N=D+(P^E&(S^P))+R[9]+2336552879&4294967295,D=E+(N<<12&4294967295|N>>>20),N=P+(S^D&(E^S))+R[10]+4294925233&4294967295,P=D+(N<<17&4294967295|N>>>15),N=S+(E^P&(D^E))+R[11]+2304563134&4294967295,S=P+(N<<22&4294967295|N>>>10),N=E+(D^S&(P^D))+R[12]+1804603682&4294967295,E=S+(N<<7&4294967295|N>>>25),N=D+(P^E&(S^P))+R[13]+4254626195&4294967295,D=E+(N<<12&4294967295|N>>>20),N=P+(S^D&(E^S))+R[14]+2792965006&4294967295,P=D+(N<<17&4294967295|N>>>15),N=S+(E^P&(D^E))+R[15]+1236535329&4294967295,S=P+(N<<22&4294967295|N>>>10),N=E+(P^D&(S^P))+R[1]+4129170786&4294967295,E=S+(N<<5&4294967295|N>>>27),N=D+(S^P&(E^S))+R[6]+3225465664&4294967295,D=E+(N<<9&4294967295|N>>>23),N=P+(E^S&(D^E))+R[11]+643717713&4294967295,P=D+(N<<14&4294967295|N>>>18),N=S+(D^E&(P^D))+R[0]+3921069994&4294967295,S=P+(N<<20&4294967295|N>>>12),N=E+(P^D&(S^P))+R[5]+3593408605&4294967295,E=S+(N<<5&4294967295|N>>>27),N=D+(S^P&(E^S))+R[10]+38016083&4294967295,D=E+(N<<9&4294967295|N>>>23),N=P+(E^S&(D^E))+R[15]+3634488961&4294967295,P=D+(N<<14&4294967295|N>>>18),N=S+(D^E&(P^D))+R[4]+3889429448&4294967295,S=P+(N<<20&4294967295|N>>>12),N=E+(P^D&(S^P))+R[9]+568446438&4294967295,E=S+(N<<5&4294967295|N>>>27),N=D+(S^P&(E^S))+R[14]+3275163606&4294967295,D=E+(N<<9&4294967295|N>>>23),N=P+(E^S&(D^E))+R[3]+4107603335&4294967295,P=D+(N<<14&4294967295|N>>>18),N=S+(D^E&(P^D))+R[8]+1163531501&4294967295,S=P+(N<<20&4294967295|N>>>12),N=E+(P^D&(S^P))+R[13]+2850285829&4294967295,E=S+(N<<5&4294967295|N>>>27),N=D+(S^P&(E^S))+R[2]+4243563512&4294967295,D=E+(N<<9&4294967295|N>>>23),N=P+(E^S&(D^E))+R[7]+1735328473&4294967295,P=D+(N<<14&4294967295|N>>>18),N=S+(D^E&(P^D))+R[12]+2368359562&4294967295,S=P+(N<<20&4294967295|N>>>12),N=E+(S^P^D)+R[5]+4294588738&4294967295,E=S+(N<<4&4294967295|N>>>28),N=D+(E^S^P)+R[8]+2272392833&4294967295,D=E+(N<<11&4294967295|N>>>21),N=P+(D^E^S)+R[11]+1839030562&4294967295,P=D+(N<<16&4294967295|N>>>16),N=S+(P^D^E)+R[14]+4259657740&4294967295,S=P+(N<<23&4294967295|N>>>9),N=E+(S^P^D)+R[1]+2763975236&4294967295,E=S+(N<<4&4294967295|N>>>28),N=D+(E^S^P)+R[4]+1272893353&4294967295,D=E+(N<<11&4294967295|N>>>21),N=P+(D^E^S)+R[7]+4139469664&4294967295,P=D+(N<<16&4294967295|N>>>16),N=S+(P^D^E)+R[10]+3200236656&4294967295,S=P+(N<<23&4294967295|N>>>9),N=E+(S^P^D)+R[13]+681279174&4294967295,E=S+(N<<4&4294967295|N>>>28),N=D+(E^S^P)+R[0]+3936430074&4294967295,D=E+(N<<11&4294967295|N>>>21),N=P+(D^E^S)+R[3]+3572445317&4294967295,P=D+(N<<16&4294967295|N>>>16),N=S+(P^D^E)+R[6]+76029189&4294967295,S=P+(N<<23&4294967295|N>>>9),N=E+(S^P^D)+R[9]+3654602809&4294967295,E=S+(N<<4&4294967295|N>>>28),N=D+(E^S^P)+R[12]+3873151461&4294967295,D=E+(N<<11&4294967295|N>>>21),N=P+(D^E^S)+R[15]+530742520&4294967295,P=D+(N<<16&4294967295|N>>>16),N=S+(P^D^E)+R[2]+3299628645&4294967295,S=P+(N<<23&4294967295|N>>>9),N=E+(P^(S|~D))+R[0]+4096336452&4294967295,E=S+(N<<6&4294967295|N>>>26),N=D+(S^(E|~P))+R[7]+1126891415&4294967295,D=E+(N<<10&4294967295|N>>>22),N=P+(E^(D|~S))+R[14]+2878612391&4294967295,P=D+(N<<15&4294967295|N>>>17),N=S+(D^(P|~E))+R[5]+4237533241&4294967295,S=P+(N<<21&4294967295|N>>>11),N=E+(P^(S|~D))+R[12]+1700485571&4294967295,E=S+(N<<6&4294967295|N>>>26),N=D+(S^(E|~P))+R[3]+2399980690&4294967295,D=E+(N<<10&4294967295|N>>>22),N=P+(E^(D|~S))+R[10]+4293915773&4294967295,P=D+(N<<15&4294967295|N>>>17),N=S+(D^(P|~E))+R[1]+2240044497&4294967295,S=P+(N<<21&4294967295|N>>>11),N=E+(P^(S|~D))+R[8]+1873313359&4294967295,E=S+(N<<6&4294967295|N>>>26),N=D+(S^(E|~P))+R[15]+4264355552&4294967295,D=E+(N<<10&4294967295|N>>>22),N=P+(E^(D|~S))+R[6]+2734768916&4294967295,P=D+(N<<15&4294967295|N>>>17),N=S+(D^(P|~E))+R[13]+1309151649&4294967295,S=P+(N<<21&4294967295|N>>>11),N=E+(P^(S|~D))+R[4]+4149444226&4294967295,E=S+(N<<6&4294967295|N>>>26),N=D+(S^(E|~P))+R[11]+3174756917&4294967295,D=E+(N<<10&4294967295|N>>>22),N=P+(E^(D|~S))+R[2]+718787259&4294967295,P=D+(N<<15&4294967295|N>>>17),N=S+(D^(P|~E))+R[9]+3951481745&4294967295,v.g[0]=v.g[0]+E&4294967295,v.g[1]=v.g[1]+(P+(N<<21&4294967295|N>>>11))&4294967295,v.g[2]=v.g[2]+P&4294967295,v.g[3]=v.g[3]+D&4294967295}n.prototype.u=function(v,E){E===void 0&&(E=v.length);for(var S=E-this.blockSize,R=this.B,P=this.h,D=0;D<E;){if(P==0)for(;D<=S;)s(this,v,D),D+=this.blockSize;if(typeof v=="string"){for(;D<E;)if(R[P++]=v.charCodeAt(D++),P==this.blockSize){s(this,R),P=0;break}}else for(;D<E;)if(R[P++]=v[D++],P==this.blockSize){s(this,R),P=0;break}}this.h=P,this.o+=E},n.prototype.v=function(){var v=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);v[0]=128;for(var E=1;E<v.length-8;++E)v[E]=0;var S=8*this.o;for(E=v.length-8;E<v.length;++E)v[E]=S&255,S/=256;for(this.u(v),v=Array(16),E=S=0;4>E;++E)for(var R=0;32>R;R+=8)v[S++]=this.g[E]>>>R&255;return v};function a(v,E){var S=o;return Object.prototype.hasOwnProperty.call(S,v)?S[v]:S[v]=E(v)}function i(v,E){this.h=E;for(var S=[],R=!0,P=v.length-1;0<=P;P--){var D=v[P]|0;R&&D==E||(S[P]=D,R=!1)}this.g=S}var o={};function l(v){return-128<=v&&128>v?a(v,function(E){return new i([E|0],0>E?-1:0)}):new i([v|0],0>v?-1:0)}function c(v){if(isNaN(v)||!isFinite(v))return d;if(0>v)return _(c(-v));for(var E=[],S=1,R=0;v>=S;R++)E[R]=v/S|0,S*=4294967296;return new i(E,0)}function u(v,E){if(v.length==0)throw Error("number format error: empty string");if(E=E||10,2>E||36<E)throw Error("radix out of range: "+E);if(v.charAt(0)=="-")return _(u(v.substring(1),E));if(0<=v.indexOf("-"))throw Error('number format error: interior "-" character');for(var S=c(Math.pow(E,8)),R=d,P=0;P<v.length;P+=8){var D=Math.min(8,v.length-P),N=parseInt(v.substring(P,P+D),E);8>D?(D=c(Math.pow(E,D)),R=R.j(D).add(c(N))):(R=R.j(S),R=R.add(c(N)))}return R}var d=l(0),m=l(1),p=l(16777216);e=i.prototype,e.m=function(){if(g(this))return-_(this).m();for(var v=0,E=1,S=0;S<this.g.length;S++){var R=this.i(S);v+=(0<=R?R:4294967296+R)*E,E*=4294967296}return v},e.toString=function(v){if(v=v||10,2>v||36<v)throw Error("radix out of range: "+v);if(x(this))return"0";if(g(this))return"-"+_(this).toString(v);for(var E=c(Math.pow(v,6)),S=this,R="";;){var P=C(S,E).g;S=k(S,P.j(E));var D=((0<S.g.length?S.g[0]:S.h)>>>0).toString(v);if(S=P,x(S))return D+R;for(;6>D.length;)D="0"+D;R=D+R}},e.i=function(v){return 0>v?0:v<this.g.length?this.g[v]:this.h};function x(v){if(v.h!=0)return!1;for(var E=0;E<v.g.length;E++)if(v.g[E]!=0)return!1;return!0}function g(v){return v.h==-1}e.l=function(v){return v=k(this,v),g(v)?-1:x(v)?0:1};function _(v){for(var E=v.g.length,S=[],R=0;R<E;R++)S[R]=~v.g[R];return new i(S,~v.h).add(m)}e.abs=function(){return g(this)?_(this):this},e.add=function(v){for(var E=Math.max(this.g.length,v.g.length),S=[],R=0,P=0;P<=E;P++){var D=R+(this.i(P)&65535)+(v.i(P)&65535),N=(D>>>16)+(this.i(P)>>>16)+(v.i(P)>>>16);R=N>>>16,D&=65535,N&=65535,S[P]=N<<16|D}return new i(S,S[S.length-1]&-2147483648?-1:0)};function k(v,E){return v.add(_(E))}e.j=function(v){if(x(this)||x(v))return d;if(g(this))return g(v)?_(this).j(_(v)):_(_(this).j(v));if(g(v))return _(this.j(_(v)));if(0>this.l(p)&&0>v.l(p))return c(this.m()*v.m());for(var E=this.g.length+v.g.length,S=[],R=0;R<2*E;R++)S[R]=0;for(R=0;R<this.g.length;R++)for(var P=0;P<v.g.length;P++){var D=this.i(R)>>>16,N=this.i(R)&65535,ce=v.i(P)>>>16,oe=v.i(P)&65535;S[2*R+2*P]+=N*oe,T(S,2*R+2*P),S[2*R+2*P+1]+=D*oe,T(S,2*R+2*P+1),S[2*R+2*P+1]+=N*ce,T(S,2*R+2*P+1),S[2*R+2*P+2]+=D*ce,T(S,2*R+2*P+2)}for(R=0;R<E;R++)S[R]=S[2*R+1]<<16|S[2*R];for(R=E;R<2*E;R++)S[R]=0;return new i(S,0)};function T(v,E){for(;(v[E]&65535)!=v[E];)v[E+1]+=v[E]>>>16,v[E]&=65535,E++}function w(v,E){this.g=v,this.h=E}function C(v,E){if(x(E))throw Error("division by zero");if(x(v))return new w(d,d);if(g(v))return E=C(_(v),E),new w(_(E.g),_(E.h));if(g(E))return E=C(v,_(E)),new w(_(E.g),E.h);if(30<v.g.length){if(g(v)||g(E))throw Error("slowDivide_ only works with positive integers.");for(var S=m,R=E;0>=R.l(v);)S=M(S),R=M(R);var P=O(S,1),D=O(R,1);for(R=O(R,2),S=O(S,2);!x(R);){var N=D.add(R);0>=N.l(v)&&(P=P.add(S),D=N),R=O(R,1),S=O(S,1)}return E=k(v,P.j(E)),new w(P,E)}for(P=d;0<=v.l(E);){for(S=Math.max(1,Math.floor(v.m()/E.m())),R=Math.ceil(Math.log(S)/Math.LN2),R=48>=R?1:Math.pow(2,R-48),D=c(S),N=D.j(E);g(N)||0<N.l(v);)S-=R,D=c(S),N=D.j(E);x(D)&&(D=m),P=P.add(D),v=k(v,N)}return new w(P,v)}e.A=function(v){return C(this,v).h},e.and=function(v){for(var E=Math.max(this.g.length,v.g.length),S=[],R=0;R<E;R++)S[R]=this.i(R)&v.i(R);return new i(S,this.h&v.h)},e.or=function(v){for(var E=Math.max(this.g.length,v.g.length),S=[],R=0;R<E;R++)S[R]=this.i(R)|v.i(R);return new i(S,this.h|v.h)},e.xor=function(v){for(var E=Math.max(this.g.length,v.g.length),S=[],R=0;R<E;R++)S[R]=this.i(R)^v.i(R);return new i(S,this.h^v.h)};function M(v){for(var E=v.g.length+1,S=[],R=0;R<E;R++)S[R]=v.i(R)<<1|v.i(R-1)>>>31;return new i(S,v.h)}function O(v,E){var S=E>>5;E%=32;for(var R=v.g.length-S,P=[],D=0;D<R;D++)P[D]=0<E?v.i(D+S)>>>E|v.i(D+S+1)<<32-E:v.i(D+S);return new i(P,v.h)}n.prototype.digest=n.prototype.v,n.prototype.reset=n.prototype.s,n.prototype.update=n.prototype.u,Ek=n,i.prototype.add=i.prototype.add,i.prototype.multiply=i.prototype.j,i.prototype.modulo=i.prototype.A,i.prototype.compare=i.prototype.l,i.prototype.toNumber=i.prototype.m,i.prototype.toString=i.prototype.toString,i.prototype.getBits=i.prototype.i,i.fromNumber=c,i.fromString=u,ji=i}).apply(typeof Qy<"u"?Qy:typeof self<"u"?self:typeof window<"u"?window:{});var Sf=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Tk,tc,kk,rh,pp,Sk,Ak,Ik;(function(){var e,t=typeof Object.defineProperties=="function"?Object.defineProperty:function(h,y,A){return h==Array.prototype||h==Object.prototype||(h[y]=A.value),h};function r(h){h=[typeof globalThis=="object"&&globalThis,h,typeof window=="object"&&window,typeof self=="object"&&self,typeof Sf=="object"&&Sf];for(var y=0;y<h.length;++y){var A=h[y];if(A&&A.Math==Math)return A}throw Error("Cannot find global object")}var n=r(this);function s(h,y){if(y)e:{var A=n;h=h.split(".");for(var V=0;V<h.length-1;V++){var se=h[V];if(!(se in A))break e;A=A[se]}h=h[h.length-1],V=A[h],y=y(V),y!=V&&y!=null&&t(A,h,{configurable:!0,writable:!0,value:y})}}function a(h,y){h instanceof String&&(h+="");var A=0,V=!1,se={next:function(){if(!V&&A<h.length){var le=A++;return{value:y(le,h[le]),done:!1}}return V=!0,{done:!0,value:void 0}}};return se[Symbol.iterator]=function(){return se},se}s("Array.prototype.values",function(h){return h||function(){return a(this,function(y,A){return A})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var i=i||{},o=this||self;function l(h){var y=typeof h;return y=y!="object"?y:h?Array.isArray(h)?"array":y:"null",y=="array"||y=="object"&&typeof h.length=="number"}function c(h){var y=typeof h;return y=="object"&&h!=null||y=="function"}function u(h,y,A){return h.call.apply(h.bind,arguments)}function d(h,y,A){if(!h)throw Error();if(2<arguments.length){var V=Array.prototype.slice.call(arguments,2);return function(){var se=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(se,V),h.apply(y,se)}}return function(){return h.apply(y,arguments)}}function m(h,y,A){return m=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?u:d,m.apply(null,arguments)}function p(h,y){var A=Array.prototype.slice.call(arguments,1);return function(){var V=A.slice();return V.push.apply(V,arguments),h.apply(this,V)}}function x(h,y){function A(){}A.prototype=y.prototype,h.aa=y.prototype,h.prototype=new A,h.prototype.constructor=h,h.Qb=function(V,se,le){for(var Se=Array(arguments.length-2),wt=2;wt<arguments.length;wt++)Se[wt-2]=arguments[wt];return y.prototype[se].apply(V,Se)}}function g(h){const y=h.length;if(0<y){const A=Array(y);for(let V=0;V<y;V++)A[V]=h[V];return A}return[]}function _(h,y){for(let A=1;A<arguments.length;A++){const V=arguments[A];if(l(V)){const se=h.length||0,le=V.length||0;h.length=se+le;for(let Se=0;Se<le;Se++)h[se+Se]=V[Se]}else h.push(V)}}class k{constructor(y,A){this.i=y,this.j=A,this.h=0,this.g=null}get(){let y;return 0<this.h?(this.h--,y=this.g,this.g=y.next,y.next=null):y=this.i(),y}}function T(h){return/^[\s\xa0]*$/.test(h)}function w(){var h=o.navigator;return h&&(h=h.userAgent)?h:""}function C(h){return C[" "](h),h}C[" "]=function(){};var M=w().indexOf("Gecko")!=-1&&!(w().toLowerCase().indexOf("webkit")!=-1&&w().indexOf("Edge")==-1)&&!(w().indexOf("Trident")!=-1||w().indexOf("MSIE")!=-1)&&w().indexOf("Edge")==-1;function O(h,y,A){for(const V in h)y.call(A,h[V],V,h)}function v(h,y){for(const A in h)y.call(void 0,h[A],A,h)}function E(h){const y={};for(const A in h)y[A]=h[A];return y}const S="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function R(h,y){let A,V;for(let se=1;se<arguments.length;se++){V=arguments[se];for(A in V)h[A]=V[A];for(let le=0;le<S.length;le++)A=S[le],Object.prototype.hasOwnProperty.call(V,A)&&(h[A]=V[A])}}function P(h){var y=1;h=h.split(":");const A=[];for(;0<y&&h.length;)A.push(h.shift()),y--;return h.length&&A.push(h.join(":")),A}function D(h){o.setTimeout(()=>{throw h},0)}function N(){var h=G;let y=null;return h.g&&(y=h.g,h.g=h.g.next,h.g||(h.h=null),y.next=null),y}class ce{constructor(){this.h=this.g=null}add(y,A){const V=oe.get();V.set(y,A),this.h?this.h.next=V:this.g=V,this.h=V}}var oe=new k(()=>new de,h=>h.reset());class de{constructor(){this.next=this.g=this.h=null}set(y,A){this.h=y,this.g=A,this.next=null}reset(){this.next=this.g=this.h=null}}let ge,Z=!1,G=new ce,ae=()=>{const h=o.Promise.resolve(void 0);ge=()=>{h.then(fe)}};var fe=()=>{for(var h;h=N();){try{h.h.call(h.g)}catch(A){D(A)}var y=oe;y.j(h),100>y.h&&(y.h++,h.next=y.g,y.g=h)}Z=!1};function B(){this.s=this.s,this.C=this.C}B.prototype.s=!1,B.prototype.ma=function(){this.s||(this.s=!0,this.N())},B.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function K(h,y){this.type=h,this.g=this.target=y,this.defaultPrevented=!1}K.prototype.h=function(){this.defaultPrevented=!0};var q=function(){if(!o.addEventListener||!Object.defineProperty)return!1;var h=!1,y=Object.defineProperty({},"passive",{get:function(){h=!0}});try{const A=()=>{};o.addEventListener("test",A,y),o.removeEventListener("test",A,y)}catch{}return h}();function W(h,y){if(K.call(this,h?h.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,h){var A=this.type=h.type,V=h.changedTouches&&h.changedTouches.length?h.changedTouches[0]:null;if(this.target=h.target||h.srcElement,this.g=y,y=h.relatedTarget){if(M){e:{try{C(y.nodeName);var se=!0;break e}catch{}se=!1}se||(y=null)}}else A=="mouseover"?y=h.fromElement:A=="mouseout"&&(y=h.toElement);this.relatedTarget=y,V?(this.clientX=V.clientX!==void 0?V.clientX:V.pageX,this.clientY=V.clientY!==void 0?V.clientY:V.pageY,this.screenX=V.screenX||0,this.screenY=V.screenY||0):(this.clientX=h.clientX!==void 0?h.clientX:h.pageX,this.clientY=h.clientY!==void 0?h.clientY:h.pageY,this.screenX=h.screenX||0,this.screenY=h.screenY||0),this.button=h.button,this.key=h.key||"",this.ctrlKey=h.ctrlKey,this.altKey=h.altKey,this.shiftKey=h.shiftKey,this.metaKey=h.metaKey,this.pointerId=h.pointerId||0,this.pointerType=typeof h.pointerType=="string"?h.pointerType:Q[h.pointerType]||"",this.state=h.state,this.i=h,h.defaultPrevented&&W.aa.h.call(this)}}x(W,K);var Q={2:"touch",3:"pen",4:"mouse"};W.prototype.h=function(){W.aa.h.call(this);var h=this.i;h.preventDefault?h.preventDefault():h.returnValue=!1};var ue="closure_listenable_"+(1e6*Math.random()|0),Ee=0;function _e(h,y,A,V,se){this.listener=h,this.proxy=null,this.src=y,this.type=A,this.capture=!!V,this.ha=se,this.key=++Ee,this.da=this.fa=!1}function me(h){h.da=!0,h.listener=null,h.proxy=null,h.src=null,h.ha=null}function je(h){this.src=h,this.g={},this.h=0}je.prototype.add=function(h,y,A,V,se){var le=h.toString();h=this.g[le],h||(h=this.g[le]=[],this.h++);var Se=tt(h,y,V,se);return-1<Se?(y=h[Se],A||(y.fa=!1)):(y=new _e(y,this.src,le,!!V,se),y.fa=A,h.push(y)),y};function H(h,y){var A=y.type;if(A in h.g){var V=h.g[A],se=Array.prototype.indexOf.call(V,y,void 0),le;(le=0<=se)&&Array.prototype.splice.call(V,se,1),le&&(me(y),h.g[A].length==0&&(delete h.g[A],h.h--))}}function tt(h,y,A,V){for(var se=0;se<h.length;++se){var le=h[se];if(!le.da&&le.listener==y&&le.capture==!!A&&le.ha==V)return se}return-1}var He="closure_lm_"+(1e6*Math.random()|0),Je={};function De(h,y,A,V,se){if(Array.isArray(y)){for(var le=0;le<y.length;le++)De(h,y[le],A,V,se);return null}return A=fr(A),h&&h[ue]?h.K(y,A,c(V)?!!V.capture:!1,se):Ae(h,y,A,!1,V,se)}function Ae(h,y,A,V,se,le){if(!y)throw Error("Invalid event type");var Se=c(se)?!!se.capture:!!se,wt=sn(h);if(wt||(h[He]=wt=new je(h)),A=wt.add(y,A,V,Se,le),A.proxy)return A;if(V=_t(),A.proxy=V,V.src=h,V.listener=A,h.addEventListener)q||(se=Se),se===void 0&&(se=!1),h.addEventListener(y.toString(),V,se);else if(h.attachEvent)h.attachEvent(nn(y.toString()),V);else if(h.addListener&&h.removeListener)h.addListener(V);else throw Error("addEventListener and attachEvent are unavailable.");return A}function _t(){function h(A){return y.call(h.src,h.listener,A)}const y=zs;return h}function ur(h,y,A,V,se){if(Array.isArray(y))for(var le=0;le<y.length;le++)ur(h,y[le],A,V,se);else V=c(V)?!!V.capture:!!V,A=fr(A),h&&h[ue]?(h=h.i,y=String(y).toString(),y in h.g&&(le=h.g[y],A=tt(le,A,V,se),-1<A&&(me(le[A]),Array.prototype.splice.call(le,A,1),le.length==0&&(delete h.g[y],h.h--)))):h&&(h=sn(h))&&(y=h.g[y.toString()],h=-1,y&&(h=tt(y,A,V,se)),(A=-1<h?y[h]:null)&&Nr(A))}function Nr(h){if(typeof h!="number"&&h&&!h.da){var y=h.src;if(y&&y[ue])H(y.i,h);else{var A=h.type,V=h.proxy;y.removeEventListener?y.removeEventListener(A,V,h.capture):y.detachEvent?y.detachEvent(nn(A),V):y.addListener&&y.removeListener&&y.removeListener(V),(A=sn(y))?(H(A,h),A.h==0&&(A.src=null,y[He]=null)):me(h)}}}function nn(h){return h in Je?Je[h]:Je[h]="on"+h}function zs(h,y){if(h.da)h=!0;else{y=new W(y,this);var A=h.listener,V=h.ha||h.src;h.fa&&Nr(h),h=A.call(V,y)}return h}function sn(h){return h=h[He],h instanceof je?h:null}var kt="__closure_events_fn_"+(1e9*Math.random()>>>0);function fr(h){return typeof h=="function"?h:(h[kt]||(h[kt]=function(y){return h.handleEvent(y)}),h[kt])}function vt(){B.call(this),this.i=new je(this),this.M=this,this.F=null}x(vt,B),vt.prototype[ue]=!0,vt.prototype.removeEventListener=function(h,y,A,V){ur(this,h,y,A,V)};function St(h,y){var A,V=h.F;if(V)for(A=[];V;V=V.F)A.push(V);if(h=h.M,V=y.type||y,typeof y=="string")y=new K(y,h);else if(y instanceof K)y.target=y.target||h;else{var se=y;y=new K(V,h),R(y,se)}if(se=!0,A)for(var le=A.length-1;0<=le;le--){var Se=y.g=A[le];se=dt(Se,V,!0,y)&&se}if(Se=y.g=h,se=dt(Se,V,!0,y)&&se,se=dt(Se,V,!1,y)&&se,A)for(le=0;le<A.length;le++)Se=y.g=A[le],se=dt(Se,V,!1,y)&&se}vt.prototype.N=function(){if(vt.aa.N.call(this),this.i){var h=this.i,y;for(y in h.g){for(var A=h.g[y],V=0;V<A.length;V++)me(A[V]);delete h.g[y],h.h--}}this.F=null},vt.prototype.K=function(h,y,A,V){return this.i.add(String(h),y,!1,A,V)},vt.prototype.L=function(h,y,A,V){return this.i.add(String(h),y,!0,A,V)};function dt(h,y,A,V){if(y=h.i.g[String(y)],!y)return!0;y=y.concat();for(var se=!0,le=0;le<y.length;++le){var Se=y[le];if(Se&&!Se.da&&Se.capture==A){var wt=Se.listener,vr=Se.ha||Se.src;Se.fa&&H(h.i,Se),se=wt.call(vr,V)!==!1&&se}}return se&&!V.defaultPrevented}function Dt(h,y,A){if(typeof h=="function")A&&(h=m(h,A));else if(h&&typeof h.handleEvent=="function")h=m(h.handleEvent,h);else throw Error("Invalid listener argument");return 2147483647<Number(y)?-1:o.setTimeout(h,y||0)}function Ue(h){h.g=Dt(()=>{h.g=null,h.i&&(h.i=!1,Ue(h))},h.l);const y=h.h;h.h=null,h.m.apply(null,y)}class yt extends B{constructor(y,A){super(),this.m=y,this.l=A,this.h=null,this.i=!1,this.g=null}j(y){this.h=arguments,this.g?this.i=!0:Ue(this)}N(){super.N(),this.g&&(o.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function qt(h){B.call(this),this.h=h,this.g={}}x(qt,B);var ft=[];function gn(h){O(h.g,function(y,A){this.g.hasOwnProperty(A)&&Nr(y)},h),h.g={}}qt.prototype.N=function(){qt.aa.N.call(this),gn(this)},qt.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var $s=o.JSON.stringify,ho=o.JSON.parse,Nl=class{stringify(h){return o.JSON.stringify(h,void 0)}parse(h){return o.JSON.parse(h,void 0)}};function Ws(){}Ws.prototype.h=null;function ms(h){return h.h||(h.h=h.i())}function Sa(){}var qn={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function Hs(){K.call(this,"d")}x(Hs,K);function ps(){K.call(this,"c")}x(ps,K);var Rn={},mo=null;function Gs(){return mo=mo||new vt}Rn.La="serverreachability";function Ks(h){K.call(this,Rn.La,h)}x(Ks,K);function bn(h){const y=Gs();St(y,new Ks(y))}Rn.STAT_EVENT="statevent";function po(h,y){K.call(this,Rn.STAT_EVENT,h),this.stat=y}x(po,K);function rr(h){const y=Gs();St(y,new po(y,h))}Rn.Ma="timingevent";function X(h,y){K.call(this,Rn.Ma,h),this.size=y}x(X,K);function ee(h,y){if(typeof h!="function")throw Error("Fn must not be null and must be a function");return o.setTimeout(function(){h()},y)}function ie(){this.g=!0}ie.prototype.xa=function(){this.g=!1};function xe(h,y,A,V,se,le){h.info(function(){if(h.g)if(le)for(var Se="",wt=le.split("&"),vr=0;vr<wt.length;vr++){var ct=wt[vr].split("=");if(1<ct.length){var Rr=ct[0];ct=ct[1];var br=Rr.split("_");Se=2<=br.length&&br[1]=="type"?Se+(Rr+"="+ct+"&"):Se+(Rr+"=redacted&")}}else Se=null;else Se=le;return"XMLHTTP REQ ("+V+") [attempt "+se+"]: "+y+`
`+A+`
`+Se})}function Ie(h,y,A,V,se,le,Se){h.info(function(){return"XMLHTTP RESP ("+V+") [ attempt "+se+"]: "+y+`
`+A+`
`+le+" "+Se})}function I(h,y,A,V){h.info(function(){return"XMLHTTP TEXT ("+y+"): "+b(h,A)+(V?" "+V:"")})}function U(h,y){h.info(function(){return"TIMEOUT: "+y})}ie.prototype.info=function(){};function b(h,y){if(!h.g)return y;if(!y)return null;try{var A=JSON.parse(y);if(A){for(h=0;h<A.length;h++)if(Array.isArray(A[h])){var V=A[h];if(!(2>V.length)){var se=V[1];if(Array.isArray(se)&&!(1>se.length)){var le=se[0];if(le!="noop"&&le!="stop"&&le!="close")for(var Se=1;Se<se.length;Se++)se[Se]=""}}}}return $s(A)}catch{return y}}var F={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},L={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},j;function Y(){}x(Y,Ws),Y.prototype.g=function(){return new XMLHttpRequest},Y.prototype.i=function(){return{}},j=new Y;function ne(h,y,A,V){this.j=h,this.i=y,this.l=A,this.R=V||1,this.U=new qt(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new re}function re(){this.i=null,this.g="",this.h=!1}var te={},J={};function he(h,y,A){h.L=1,h.v=Yu(qs(y)),h.m=A,h.P=!0,Te(h,null)}function Te(h,y){h.F=Date.now(),ke(h),h.A=qs(h.v);var A=h.A,V=h.R;Array.isArray(V)||(V=[String(V)]),Iv(A.i,"t",V),h.C=0,A=h.j.J,h.h=new re,h.g=Hv(h.j,A?y:null,!h.m),0<h.O&&(h.M=new yt(m(h.Y,h,h.g),h.O)),y=h.U,A=h.g,V=h.ca;var se="readystatechange";Array.isArray(se)||(se&&(ft[0]=se.toString()),se=ft);for(var le=0;le<se.length;le++){var Se=De(A,se[le],V||y.handleEvent,!1,y.h||y);if(!Se)break;y.g[Se.key]=Se}y=h.H?E(h.H):{},h.m?(h.u||(h.u="POST"),y["Content-Type"]="application/x-www-form-urlencoded",h.g.ea(h.A,h.u,h.m,y)):(h.u="GET",h.g.ea(h.A,h.u,null,y)),bn(),xe(h.i,h.u,h.A,h.l,h.R,h.m)}ne.prototype.ca=function(h){h=h.target;const y=this.M;y&&Xs(h)==3?y.j():this.Y(h)},ne.prototype.Y=function(h){try{if(h==this.g)e:{const br=Xs(this.g);var y=this.g.Ba();const vo=this.g.Z();if(!(3>br)&&(br!=3||this.g&&(this.h.h||this.g.oa()||Fv(this.g)))){this.J||br!=4||y==7||(y==8||0>=vo?bn(3):bn(2)),it(this);var A=this.g.Z();this.X=A;t:if(Ce(this)){var V=Fv(this.g);h="";var se=V.length,le=Xs(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){mt(this),qe(this);var Se="";break t}this.h.i=new o.TextDecoder}for(y=0;y<se;y++)this.h.h=!0,h+=this.h.i.decode(V[y],{stream:!(le&&y==se-1)});V.length=0,this.h.g+=h,this.C=0,Se=this.h.g}else Se=this.g.oa();if(this.o=A==200,Ie(this.i,this.u,this.A,this.l,this.R,br,A),this.o){if(this.T&&!this.K){t:{if(this.g){var wt,vr=this.g;if((wt=vr.g?vr.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!T(wt)){var ct=wt;break t}}ct=null}if(A=ct)I(this.i,this.l,A,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,an(this,A);else{this.o=!1,this.s=3,rr(12),mt(this),qe(this);break e}}if(this.P){A=!0;let Xn;for(;!this.J&&this.C<Se.length;)if(Xn=ve(this,Se),Xn==J){br==4&&(this.s=4,rr(14),A=!1),I(this.i,this.l,null,"[Incomplete Response]");break}else if(Xn==te){this.s=4,rr(15),I(this.i,this.l,Se,"[Invalid Chunk]"),A=!1;break}else I(this.i,this.l,Xn,null),an(this,Xn);if(Ce(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),br!=4||Se.length!=0||this.h.h||(this.s=1,rr(16),A=!1),this.o=this.o&&A,!A)I(this.i,this.l,Se,"[Invalid Chunked Response]"),mt(this),qe(this);else if(0<Se.length&&!this.W){this.W=!0;var Rr=this.j;Rr.g==this&&Rr.ba&&!Rr.M&&(Rr.j.info("Great, no buffering proxy detected. Bytes received: "+Se.length),u0(Rr),Rr.M=!0,rr(11))}}else I(this.i,this.l,Se,null),an(this,Se);br==4&&mt(this),this.o&&!this.J&&(br==4?Bv(this.j,this):(this.o=!1,ke(this)))}else ZI(this.g),A==400&&0<Se.indexOf("Unknown SID")?(this.s=3,rr(12)):(this.s=0,rr(13)),mt(this),qe(this)}}}catch{}finally{}};function Ce(h){return h.g?h.u=="GET"&&h.L!=2&&h.j.Ca:!1}function ve(h,y){var A=h.C,V=y.indexOf(`
`,A);return V==-1?J:(A=Number(y.substring(A,V)),isNaN(A)?te:(V+=1,V+A>y.length?J:(y=y.slice(V,V+A),h.C=V+A,y)))}ne.prototype.cancel=function(){this.J=!0,mt(this)};function ke(h){h.S=Date.now()+h.I,Fe(h,h.I)}function Fe(h,y){if(h.B!=null)throw Error("WatchDog timer not null");h.B=ee(m(h.ba,h),y)}function it(h){h.B&&(o.clearTimeout(h.B),h.B=null)}ne.prototype.ba=function(){this.B=null;const h=Date.now();0<=h-this.S?(U(this.i,this.A),this.L!=2&&(bn(),rr(17)),mt(this),this.s=2,qe(this)):Fe(this,this.S-h)};function qe(h){h.j.G==0||h.J||Bv(h.j,h)}function mt(h){it(h);var y=h.M;y&&typeof y.ma=="function"&&y.ma(),h.M=null,gn(h.U),h.g&&(y=h.g,h.g=null,y.abort(),y.ma())}function an(h,y){try{var A=h.j;if(A.G!=0&&(A.g==h||rt(A.h,h))){if(!h.K&&rt(A.h,h)&&A.G==3){try{var V=A.Da.g.parse(y)}catch{V=null}if(Array.isArray(V)&&V.length==3){var se=V;if(se[0]==0){e:if(!A.u){if(A.g)if(A.g.F+3e3<h.F)rf(A),ef(A);else break e;c0(A),rr(18)}}else A.za=se[1],0<A.za-A.T&&37500>se[2]&&A.F&&A.v==0&&!A.C&&(A.C=ee(m(A.Za,A),6e3));if(1>=Pn(A.h)&&A.ca){try{A.ca()}catch{}A.ca=void 0}}else wi(A,11)}else if((h.K||A.g==h)&&rf(A),!T(y))for(se=A.Da.g.parse(y),y=0;y<se.length;y++){let ct=se[y];if(A.T=ct[0],ct=ct[1],A.G==2)if(ct[0]=="c"){A.K=ct[1],A.ia=ct[2];const Rr=ct[3];Rr!=null&&(A.la=Rr,A.j.info("VER="+A.la));const br=ct[4];br!=null&&(A.Aa=br,A.j.info("SVER="+A.Aa));const vo=ct[5];vo!=null&&typeof vo=="number"&&0<vo&&(V=1.5*vo,A.L=V,A.j.info("backChannelRequestTimeoutMs_="+V)),V=A;const Xn=h.g;if(Xn){const sf=Xn.g?Xn.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(sf){var le=V.h;le.g||sf.indexOf("spdy")==-1&&sf.indexOf("quic")==-1&&sf.indexOf("h2")==-1||(le.j=le.l,le.g=new Set,le.h&&(gs(le,le.h),le.h=null))}if(V.D){const f0=Xn.g?Xn.g.getResponseHeader("X-HTTP-Session-Id"):null;f0&&(V.ya=f0,At(V.I,V.D,f0))}}A.G=3,A.l&&A.l.ua(),A.ba&&(A.R=Date.now()-h.F,A.j.info("Handshake RTT: "+A.R+"ms")),V=A;var Se=h;if(V.qa=Wv(V,V.J?V.ia:null,V.W),Se.K){Rl(V.h,Se);var wt=Se,vr=V.L;vr&&(wt.I=vr),wt.B&&(it(wt),ke(wt)),V.g=Se}else Uv(V);0<A.i.length&&tf(A)}else ct[0]!="stop"&&ct[0]!="close"||wi(A,7);else A.G==3&&(ct[0]=="stop"||ct[0]=="close"?ct[0]=="stop"?wi(A,7):l0(A):ct[0]!="noop"&&A.l&&A.l.ta(ct),A.v=0)}}bn(4)}catch{}}var Ge=class{constructor(h,y){this.g=h,this.map=y}};function ht(h){this.l=h||10,o.PerformanceNavigationTiming?(h=o.performance.getEntriesByType("navigation"),h=0<h.length&&(h[0].nextHopProtocol=="hq"||h[0].nextHopProtocol=="h2")):h=!!(o.chrome&&o.chrome.loadTimes&&o.chrome.loadTimes()&&o.chrome.loadTimes().wasFetchedViaSpdy),this.j=h?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function xr(h){return h.h?!0:h.g?h.g.size>=h.j:!1}function Pn(h){return h.h?1:h.g?h.g.size:0}function rt(h,y){return h.h?h.h==y:h.g?h.g.has(y):!1}function gs(h,y){h.g?h.g.add(y):h.h=y}function Rl(h,y){h.h&&h.h==y?h.h=null:h.g&&h.g.has(y)&&h.g.delete(y)}ht.prototype.cancel=function(){if(this.i=Ku(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const h of this.g.values())h.cancel();this.g.clear()}};function Ku(h){if(h.h!=null)return h.i.concat(h.h.D);if(h.g!=null&&h.g.size!==0){let y=h.i;for(const A of h.g.values())y=y.concat(A.D);return y}return g(h.i)}function jI(h){if(h.V&&typeof h.V=="function")return h.V();if(typeof Map<"u"&&h instanceof Map||typeof Set<"u"&&h instanceof Set)return Array.from(h.values());if(typeof h=="string")return h.split("");if(l(h)){for(var y=[],A=h.length,V=0;V<A;V++)y.push(h[V]);return y}y=[],A=0;for(V in h)y[A++]=h[V];return y}function UI(h){if(h.na&&typeof h.na=="function")return h.na();if(!h.V||typeof h.V!="function"){if(typeof Map<"u"&&h instanceof Map)return Array.from(h.keys());if(!(typeof Set<"u"&&h instanceof Set)){if(l(h)||typeof h=="string"){var y=[];h=h.length;for(var A=0;A<h;A++)y.push(A);return y}y=[],A=0;for(const V in h)y[A++]=V;return y}}}function wv(h,y){if(h.forEach&&typeof h.forEach=="function")h.forEach(y,void 0);else if(l(h)||typeof h=="string")Array.prototype.forEach.call(h,y,void 0);else for(var A=UI(h),V=jI(h),se=V.length,le=0;le<se;le++)y.call(void 0,V[le],A&&A[le],h)}var Ev=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function VI(h,y){if(h){h=h.split("&");for(var A=0;A<h.length;A++){var V=h[A].indexOf("="),se=null;if(0<=V){var le=h[A].substring(0,V);se=h[A].substring(V+1)}else le=h[A];y(le,se?decodeURIComponent(se.replace(/\+/g," ")):"")}}}function _i(h){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,h instanceof _i){this.h=h.h,qu(this,h.j),this.o=h.o,this.g=h.g,Xu(this,h.s),this.l=h.l;var y=h.i,A=new Dl;A.i=y.i,y.g&&(A.g=new Map(y.g),A.h=y.h),Tv(this,A),this.m=h.m}else h&&(y=String(h).match(Ev))?(this.h=!1,qu(this,y[1]||"",!0),this.o=bl(y[2]||""),this.g=bl(y[3]||"",!0),Xu(this,y[4]),this.l=bl(y[5]||"",!0),Tv(this,y[6]||"",!0),this.m=bl(y[7]||"")):(this.h=!1,this.i=new Dl(null,this.h))}_i.prototype.toString=function(){var h=[],y=this.j;y&&h.push(Pl(y,kv,!0),":");var A=this.g;return(A||y=="file")&&(h.push("//"),(y=this.o)&&h.push(Pl(y,kv,!0),"@"),h.push(encodeURIComponent(String(A)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),A=this.s,A!=null&&h.push(":",String(A))),(A=this.l)&&(this.g&&A.charAt(0)!="/"&&h.push("/"),h.push(Pl(A,A.charAt(0)=="/"?$I:zI,!0))),(A=this.i.toString())&&h.push("?",A),(A=this.m)&&h.push("#",Pl(A,HI)),h.join("")};function qs(h){return new _i(h)}function qu(h,y,A){h.j=A?bl(y,!0):y,h.j&&(h.j=h.j.replace(/:$/,""))}function Xu(h,y){if(y){if(y=Number(y),isNaN(y)||0>y)throw Error("Bad port number "+y);h.s=y}else h.s=null}function Tv(h,y,A){y instanceof Dl?(h.i=y,GI(h.i,h.h)):(A||(y=Pl(y,WI)),h.i=new Dl(y,h.h))}function At(h,y,A){h.i.set(y,A)}function Yu(h){return At(h,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),h}function bl(h,y){return h?y?decodeURI(h.replace(/%25/g,"%2525")):decodeURIComponent(h):""}function Pl(h,y,A){return typeof h=="string"?(h=encodeURI(h).replace(y,BI),A&&(h=h.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),h):null}function BI(h){return h=h.charCodeAt(0),"%"+(h>>4&15).toString(16)+(h&15).toString(16)}var kv=/[#\/\?@]/g,zI=/[#\?:]/g,$I=/[#\?]/g,WI=/[#\?@]/g,HI=/#/g;function Dl(h,y){this.h=this.g=null,this.i=h||null,this.j=!!y}function Aa(h){h.g||(h.g=new Map,h.h=0,h.i&&VI(h.i,function(y,A){h.add(decodeURIComponent(y.replace(/\+/g," ")),A)}))}e=Dl.prototype,e.add=function(h,y){Aa(this),this.i=null,h=go(this,h);var A=this.g.get(h);return A||this.g.set(h,A=[]),A.push(y),this.h+=1,this};function Sv(h,y){Aa(h),y=go(h,y),h.g.has(y)&&(h.i=null,h.h-=h.g.get(y).length,h.g.delete(y))}function Av(h,y){return Aa(h),y=go(h,y),h.g.has(y)}e.forEach=function(h,y){Aa(this),this.g.forEach(function(A,V){A.forEach(function(se){h.call(y,se,V,this)},this)},this)},e.na=function(){Aa(this);const h=Array.from(this.g.values()),y=Array.from(this.g.keys()),A=[];for(let V=0;V<y.length;V++){const se=h[V];for(let le=0;le<se.length;le++)A.push(y[V])}return A},e.V=function(h){Aa(this);let y=[];if(typeof h=="string")Av(this,h)&&(y=y.concat(this.g.get(go(this,h))));else{h=Array.from(this.g.values());for(let A=0;A<h.length;A++)y=y.concat(h[A])}return y},e.set=function(h,y){return Aa(this),this.i=null,h=go(this,h),Av(this,h)&&(this.h-=this.g.get(h).length),this.g.set(h,[y]),this.h+=1,this},e.get=function(h,y){return h?(h=this.V(h),0<h.length?String(h[0]):y):y};function Iv(h,y,A){Sv(h,y),0<A.length&&(h.i=null,h.g.set(go(h,y),g(A)),h.h+=A.length)}e.toString=function(){if(this.i)return this.i;if(!this.g)return"";const h=[],y=Array.from(this.g.keys());for(var A=0;A<y.length;A++){var V=y[A];const le=encodeURIComponent(String(V)),Se=this.V(V);for(V=0;V<Se.length;V++){var se=le;Se[V]!==""&&(se+="="+encodeURIComponent(String(Se[V]))),h.push(se)}}return this.i=h.join("&")};function go(h,y){return y=String(y),h.j&&(y=y.toLowerCase()),y}function GI(h,y){y&&!h.j&&(Aa(h),h.i=null,h.g.forEach(function(A,V){var se=V.toLowerCase();V!=se&&(Sv(this,V),Iv(this,se,A))},h)),h.j=y}function KI(h,y){const A=new ie;if(o.Image){const V=new Image;V.onload=p(Ia,A,"TestLoadImage: loaded",!0,y,V),V.onerror=p(Ia,A,"TestLoadImage: error",!1,y,V),V.onabort=p(Ia,A,"TestLoadImage: abort",!1,y,V),V.ontimeout=p(Ia,A,"TestLoadImage: timeout",!1,y,V),o.setTimeout(function(){V.ontimeout&&V.ontimeout()},1e4),V.src=h}else y(!1)}function qI(h,y){const A=new ie,V=new AbortController,se=setTimeout(()=>{V.abort(),Ia(A,"TestPingServer: timeout",!1,y)},1e4);fetch(h,{signal:V.signal}).then(le=>{clearTimeout(se),le.ok?Ia(A,"TestPingServer: ok",!0,y):Ia(A,"TestPingServer: server error",!1,y)}).catch(()=>{clearTimeout(se),Ia(A,"TestPingServer: error",!1,y)})}function Ia(h,y,A,V,se){try{se&&(se.onload=null,se.onerror=null,se.onabort=null,se.ontimeout=null),V(A)}catch{}}function XI(){this.g=new Nl}function YI(h,y,A){const V=A||"";try{wv(h,function(se,le){let Se=se;c(se)&&(Se=$s(se)),y.push(V+le+"="+encodeURIComponent(Se))})}catch(se){throw y.push(V+"type="+encodeURIComponent("_badmap")),se}}function Qu(h){this.l=h.Ub||null,this.j=h.eb||!1}x(Qu,Ws),Qu.prototype.g=function(){return new Ju(this.l,this.j)},Qu.prototype.i=function(h){return function(){return h}}({});function Ju(h,y){vt.call(this),this.D=h,this.o=y,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}x(Ju,vt),e=Ju.prototype,e.open=function(h,y){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=h,this.A=y,this.readyState=1,Ol(this)},e.send=function(h){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const y={headers:this.u,method:this.B,credentials:this.m,cache:void 0};h&&(y.body=h),(this.D||o).fetch(new Request(this.A,y)).then(this.Sa.bind(this),this.ga.bind(this))},e.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,Fl(this)),this.readyState=0},e.Sa=function(h){if(this.g&&(this.l=h,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=h.headers,this.readyState=2,Ol(this)),this.g&&(this.readyState=3,Ol(this),this.g)))if(this.responseType==="arraybuffer")h.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof o.ReadableStream<"u"&&"body"in h){if(this.j=h.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;Cv(this)}else h.text().then(this.Ra.bind(this),this.ga.bind(this))};function Cv(h){h.j.read().then(h.Pa.bind(h)).catch(h.ga.bind(h))}e.Pa=function(h){if(this.g){if(this.o&&h.value)this.response.push(h.value);else if(!this.o){var y=h.value?h.value:new Uint8Array(0);(y=this.v.decode(y,{stream:!h.done}))&&(this.response=this.responseText+=y)}h.done?Fl(this):Ol(this),this.readyState==3&&Cv(this)}},e.Ra=function(h){this.g&&(this.response=this.responseText=h,Fl(this))},e.Qa=function(h){this.g&&(this.response=h,Fl(this))},e.ga=function(){this.g&&Fl(this)};function Fl(h){h.readyState=4,h.l=null,h.j=null,h.v=null,Ol(h)}e.setRequestHeader=function(h,y){this.u.append(h,y)},e.getResponseHeader=function(h){return this.h&&this.h.get(h.toLowerCase())||""},e.getAllResponseHeaders=function(){if(!this.h)return"";const h=[],y=this.h.entries();for(var A=y.next();!A.done;)A=A.value,h.push(A[0]+": "+A[1]),A=y.next();return h.join(`\r
`)};function Ol(h){h.onreadystatechange&&h.onreadystatechange.call(h)}Object.defineProperty(Ju.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(h){this.m=h?"include":"same-origin"}});function Nv(h){let y="";return O(h,function(A,V){y+=V,y+=":",y+=A,y+=`\r
`}),y}function o0(h,y,A){e:{for(V in A){var V=!1;break e}V=!0}V||(A=Nv(A),typeof h=="string"?A!=null&&encodeURIComponent(String(A)):At(h,y,A))}function jt(h){vt.call(this),this.headers=new Map,this.o=h||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}x(jt,vt);var QI=/^https?$/i,JI=["POST","PUT"];e=jt.prototype,e.Ha=function(h){this.J=h},e.ea=function(h,y,A,V){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+h);y=y?y.toUpperCase():"GET",this.D=h,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():j.g(),this.v=this.o?ms(this.o):ms(j),this.g.onreadystatechange=m(this.Ea,this);try{this.B=!0,this.g.open(y,String(h),!0),this.B=!1}catch(le){Rv(this,le);return}if(h=A||"",A=new Map(this.headers),V)if(Object.getPrototypeOf(V)===Object.prototype)for(var se in V)A.set(se,V[se]);else if(typeof V.keys=="function"&&typeof V.get=="function")for(const le of V.keys())A.set(le,V.get(le));else throw Error("Unknown input type for opt_headers: "+String(V));V=Array.from(A.keys()).find(le=>le.toLowerCase()=="content-type"),se=o.FormData&&h instanceof o.FormData,!(0<=Array.prototype.indexOf.call(JI,y,void 0))||V||se||A.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[le,Se]of A)this.g.setRequestHeader(le,Se);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{Dv(this),this.u=!0,this.g.send(h),this.u=!1}catch(le){Rv(this,le)}};function Rv(h,y){h.h=!1,h.g&&(h.j=!0,h.g.abort(),h.j=!1),h.l=y,h.m=5,bv(h),Zu(h)}function bv(h){h.A||(h.A=!0,St(h,"complete"),St(h,"error"))}e.abort=function(h){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=h||7,St(this,"complete"),St(this,"abort"),Zu(this))},e.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Zu(this,!0)),jt.aa.N.call(this)},e.Ea=function(){this.s||(this.B||this.u||this.j?Pv(this):this.bb())},e.bb=function(){Pv(this)};function Pv(h){if(h.h&&typeof i<"u"&&(!h.v[1]||Xs(h)!=4||h.Z()!=2)){if(h.u&&Xs(h)==4)Dt(h.Ea,0,h);else if(St(h,"readystatechange"),Xs(h)==4){h.h=!1;try{const Se=h.Z();e:switch(Se){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var y=!0;break e;default:y=!1}var A;if(!(A=y)){var V;if(V=Se===0){var se=String(h.D).match(Ev)[1]||null;!se&&o.self&&o.self.location&&(se=o.self.location.protocol.slice(0,-1)),V=!QI.test(se?se.toLowerCase():"")}A=V}if(A)St(h,"complete"),St(h,"success");else{h.m=6;try{var le=2<Xs(h)?h.g.statusText:""}catch{le=""}h.l=le+" ["+h.Z()+"]",bv(h)}}finally{Zu(h)}}}}function Zu(h,y){if(h.g){Dv(h);const A=h.g,V=h.v[0]?()=>{}:null;h.g=null,h.v=null,y||St(h,"ready");try{A.onreadystatechange=V}catch{}}}function Dv(h){h.I&&(o.clearTimeout(h.I),h.I=null)}e.isActive=function(){return!!this.g};function Xs(h){return h.g?h.g.readyState:0}e.Z=function(){try{return 2<Xs(this)?this.g.status:-1}catch{return-1}},e.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},e.Oa=function(h){if(this.g){var y=this.g.responseText;return h&&y.indexOf(h)==0&&(y=y.substring(h.length)),ho(y)}};function Fv(h){try{if(!h.g)return null;if("response"in h.g)return h.g.response;switch(h.H){case"":case"text":return h.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in h.g)return h.g.mozResponseArrayBuffer}return null}catch{return null}}function ZI(h){const y={};h=(h.g&&2<=Xs(h)&&h.g.getAllResponseHeaders()||"").split(`\r
`);for(let V=0;V<h.length;V++){if(T(h[V]))continue;var A=P(h[V]);const se=A[0];if(A=A[1],typeof A!="string")continue;A=A.trim();const le=y[se]||[];y[se]=le,le.push(A)}v(y,function(V){return V.join(", ")})}e.Ba=function(){return this.m},e.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function Ml(h,y,A){return A&&A.internalChannelParams&&A.internalChannelParams[h]||y}function Ov(h){this.Aa=0,this.i=[],this.j=new ie,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=Ml("failFast",!1,h),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=Ml("baseRetryDelayMs",5e3,h),this.cb=Ml("retryDelaySeedMs",1e4,h),this.Wa=Ml("forwardChannelMaxRetries",2,h),this.wa=Ml("forwardChannelRequestTimeoutMs",2e4,h),this.pa=h&&h.xmlHttpFactory||void 0,this.Xa=h&&h.Tb||void 0,this.Ca=h&&h.useFetchStreams||!1,this.L=void 0,this.J=h&&h.supportsCrossDomainXhr||!1,this.K="",this.h=new ht(h&&h.concurrentRequestLimit),this.Da=new XI,this.P=h&&h.fastHandshake||!1,this.O=h&&h.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=h&&h.Rb||!1,h&&h.xa&&this.j.xa(),h&&h.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&h&&h.detectBufferingProxy||!1,this.ja=void 0,h&&h.longPollingTimeout&&0<h.longPollingTimeout&&(this.ja=h.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}e=Ov.prototype,e.la=8,e.G=1,e.connect=function(h,y,A,V){rr(0),this.W=h,this.H=y||{},A&&V!==void 0&&(this.H.OSID=A,this.H.OAID=V),this.F=this.X,this.I=Wv(this,null,this.W),tf(this)};function l0(h){if(Mv(h),h.G==3){var y=h.U++,A=qs(h.I);if(At(A,"SID",h.K),At(A,"RID",y),At(A,"TYPE","terminate"),Ll(h,A),y=new ne(h,h.j,y),y.L=2,y.v=Yu(qs(A)),A=!1,o.navigator&&o.navigator.sendBeacon)try{A=o.navigator.sendBeacon(y.v.toString(),"")}catch{}!A&&o.Image&&(new Image().src=y.v,A=!0),A||(y.g=Hv(y.j,null),y.g.ea(y.v)),y.F=Date.now(),ke(y)}$v(h)}function ef(h){h.g&&(u0(h),h.g.cancel(),h.g=null)}function Mv(h){ef(h),h.u&&(o.clearTimeout(h.u),h.u=null),rf(h),h.h.cancel(),h.s&&(typeof h.s=="number"&&o.clearTimeout(h.s),h.s=null)}function tf(h){if(!xr(h.h)&&!h.s){h.s=!0;var y=h.Ga;ge||ae(),Z||(ge(),Z=!0),G.add(y,h),h.B=0}}function eC(h,y){return Pn(h.h)>=h.h.j-(h.s?1:0)?!1:h.s?(h.i=y.D.concat(h.i),!0):h.G==1||h.G==2||h.B>=(h.Va?0:h.Wa)?!1:(h.s=ee(m(h.Ga,h,y),zv(h,h.B)),h.B++,!0)}e.Ga=function(h){if(this.s)if(this.s=null,this.G==1){if(!h){this.U=Math.floor(1e5*Math.random()),h=this.U++;const se=new ne(this,this.j,h);let le=this.o;if(this.S&&(le?(le=E(le),R(le,this.S)):le=this.S),this.m!==null||this.O||(se.H=le,le=null),this.P)e:{for(var y=0,A=0;A<this.i.length;A++){t:{var V=this.i[A];if("__data__"in V.map&&(V=V.map.__data__,typeof V=="string")){V=V.length;break t}V=void 0}if(V===void 0)break;if(y+=V,4096<y){y=A;break e}if(y===4096||A===this.i.length-1){y=A+1;break e}}y=1e3}else y=1e3;y=jv(this,se,y),A=qs(this.I),At(A,"RID",h),At(A,"CVER",22),this.D&&At(A,"X-HTTP-Session-Id",this.D),Ll(this,A),le&&(this.O?y="headers="+encodeURIComponent(String(Nv(le)))+"&"+y:this.m&&o0(A,this.m,le)),gs(this.h,se),this.Ua&&At(A,"TYPE","init"),this.P?(At(A,"$req",y),At(A,"SID","null"),se.T=!0,he(se,A,null)):he(se,A,y),this.G=2}}else this.G==3&&(h?Lv(this,h):this.i.length==0||xr(this.h)||Lv(this))};function Lv(h,y){var A;y?A=y.l:A=h.U++;const V=qs(h.I);At(V,"SID",h.K),At(V,"RID",A),At(V,"AID",h.T),Ll(h,V),h.m&&h.o&&o0(V,h.m,h.o),A=new ne(h,h.j,A,h.B+1),h.m===null&&(A.H=h.o),y&&(h.i=y.D.concat(h.i)),y=jv(h,A,1e3),A.I=Math.round(.5*h.wa)+Math.round(.5*h.wa*Math.random()),gs(h.h,A),he(A,V,y)}function Ll(h,y){h.H&&O(h.H,function(A,V){At(y,V,A)}),h.l&&wv({},function(A,V){At(y,V,A)})}function jv(h,y,A){A=Math.min(h.i.length,A);var V=h.l?m(h.l.Na,h.l,h):null;e:{var se=h.i;let le=-1;for(;;){const Se=["count="+A];le==-1?0<A?(le=se[0].g,Se.push("ofs="+le)):le=0:Se.push("ofs="+le);let wt=!0;for(let vr=0;vr<A;vr++){let ct=se[vr].g;const Rr=se[vr].map;if(ct-=le,0>ct)le=Math.max(0,se[vr].g-100),wt=!1;else try{YI(Rr,Se,"req"+ct+"_")}catch{V&&V(Rr)}}if(wt){V=Se.join("&");break e}}}return h=h.i.splice(0,A),y.D=h,V}function Uv(h){if(!h.g&&!h.u){h.Y=1;var y=h.Fa;ge||ae(),Z||(ge(),Z=!0),G.add(y,h),h.v=0}}function c0(h){return h.g||h.u||3<=h.v?!1:(h.Y++,h.u=ee(m(h.Fa,h),zv(h,h.v)),h.v++,!0)}e.Fa=function(){if(this.u=null,Vv(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var h=2*this.R;this.j.info("BP detection timer enabled: "+h),this.A=ee(m(this.ab,this),h)}},e.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,rr(10),ef(this),Vv(this))};function u0(h){h.A!=null&&(o.clearTimeout(h.A),h.A=null)}function Vv(h){h.g=new ne(h,h.j,"rpc",h.Y),h.m===null&&(h.g.H=h.o),h.g.O=0;var y=qs(h.qa);At(y,"RID","rpc"),At(y,"SID",h.K),At(y,"AID",h.T),At(y,"CI",h.F?"0":"1"),!h.F&&h.ja&&At(y,"TO",h.ja),At(y,"TYPE","xmlhttp"),Ll(h,y),h.m&&h.o&&o0(y,h.m,h.o),h.L&&(h.g.I=h.L);var A=h.g;h=h.ia,A.L=1,A.v=Yu(qs(y)),A.m=null,A.P=!0,Te(A,h)}e.Za=function(){this.C!=null&&(this.C=null,ef(this),c0(this),rr(19))};function rf(h){h.C!=null&&(o.clearTimeout(h.C),h.C=null)}function Bv(h,y){var A=null;if(h.g==y){rf(h),u0(h),h.g=null;var V=2}else if(rt(h.h,y))A=y.D,Rl(h.h,y),V=1;else return;if(h.G!=0){if(y.o)if(V==1){A=y.m?y.m.length:0,y=Date.now()-y.F;var se=h.B;V=Gs(),St(V,new X(V,A)),tf(h)}else Uv(h);else if(se=y.s,se==3||se==0&&0<y.X||!(V==1&&eC(h,y)||V==2&&c0(h)))switch(A&&0<A.length&&(y=h.h,y.i=y.i.concat(A)),se){case 1:wi(h,5);break;case 4:wi(h,10);break;case 3:wi(h,6);break;default:wi(h,2)}}}function zv(h,y){let A=h.Ta+Math.floor(Math.random()*h.cb);return h.isActive()||(A*=2),A*y}function wi(h,y){if(h.j.info("Error code "+y),y==2){var A=m(h.fb,h),V=h.Xa;const se=!V;V=new _i(V||"//www.google.com/images/cleardot.gif"),o.location&&o.location.protocol=="http"||qu(V,"https"),Yu(V),se?KI(V.toString(),A):qI(V.toString(),A)}else rr(2);h.G=0,h.l&&h.l.sa(y),$v(h),Mv(h)}e.fb=function(h){h?(this.j.info("Successfully pinged google.com"),rr(2)):(this.j.info("Failed to ping google.com"),rr(1))};function $v(h){if(h.G=0,h.ka=[],h.l){const y=Ku(h.h);(y.length!=0||h.i.length!=0)&&(_(h.ka,y),_(h.ka,h.i),h.h.i.length=0,g(h.i),h.i.length=0),h.l.ra()}}function Wv(h,y,A){var V=A instanceof _i?qs(A):new _i(A);if(V.g!="")y&&(V.g=y+"."+V.g),Xu(V,V.s);else{var se=o.location;V=se.protocol,y=y?y+"."+se.hostname:se.hostname,se=+se.port;var le=new _i(null);V&&qu(le,V),y&&(le.g=y),se&&Xu(le,se),A&&(le.l=A),V=le}return A=h.D,y=h.ya,A&&y&&At(V,A,y),At(V,"VER",h.la),Ll(h,V),V}function Hv(h,y,A){if(y&&!h.J)throw Error("Can't create secondary domain capable XhrIo object.");return y=h.Ca&&!h.pa?new jt(new Qu({eb:A})):new jt(h.pa),y.Ha(h.J),y}e.isActive=function(){return!!this.l&&this.l.isActive(this)};function Gv(){}e=Gv.prototype,e.ua=function(){},e.ta=function(){},e.sa=function(){},e.ra=function(){},e.isActive=function(){return!0},e.Na=function(){};function nf(){}nf.prototype.g=function(h,y){return new xn(h,y)};function xn(h,y){vt.call(this),this.g=new Ov(y),this.l=h,this.h=y&&y.messageUrlParams||null,h=y&&y.messageHeaders||null,y&&y.clientProtocolHeaderRequired&&(h?h["X-Client-Protocol"]="webchannel":h={"X-Client-Protocol":"webchannel"}),this.g.o=h,h=y&&y.initMessageHeaders||null,y&&y.messageContentType&&(h?h["X-WebChannel-Content-Type"]=y.messageContentType:h={"X-WebChannel-Content-Type":y.messageContentType}),y&&y.va&&(h?h["X-WebChannel-Client-Profile"]=y.va:h={"X-WebChannel-Client-Profile":y.va}),this.g.S=h,(h=y&&y.Sb)&&!T(h)&&(this.g.m=h),this.v=y&&y.supportsCrossDomainXhr||!1,this.u=y&&y.sendRawJson||!1,(y=y&&y.httpSessionIdParam)&&!T(y)&&(this.g.D=y,h=this.h,h!==null&&y in h&&(h=this.h,y in h&&delete h[y])),this.j=new xo(this)}x(xn,vt),xn.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},xn.prototype.close=function(){l0(this.g)},xn.prototype.o=function(h){var y=this.g;if(typeof h=="string"){var A={};A.__data__=h,h=A}else this.u&&(A={},A.__data__=$s(h),h=A);y.i.push(new Ge(y.Ya++,h)),y.G==3&&tf(y)},xn.prototype.N=function(){this.g.l=null,delete this.j,l0(this.g),delete this.g,xn.aa.N.call(this)};function Kv(h){Hs.call(this),h.__headers__&&(this.headers=h.__headers__,this.statusCode=h.__status__,delete h.__headers__,delete h.__status__);var y=h.__sm__;if(y){e:{for(const A in y){h=A;break e}h=void 0}(this.i=h)&&(h=this.i,y=y!==null&&h in y?y[h]:void 0),this.data=y}else this.data=h}x(Kv,Hs);function qv(){ps.call(this),this.status=1}x(qv,ps);function xo(h){this.g=h}x(xo,Gv),xo.prototype.ua=function(){St(this.g,"a")},xo.prototype.ta=function(h){St(this.g,new Kv(h))},xo.prototype.sa=function(h){St(this.g,new qv)},xo.prototype.ra=function(){St(this.g,"b")},nf.prototype.createWebChannel=nf.prototype.g,xn.prototype.send=xn.prototype.o,xn.prototype.open=xn.prototype.m,xn.prototype.close=xn.prototype.close,Ik=function(){return new nf},Ak=function(){return Gs()},Sk=Rn,pp={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},F.NO_ERROR=0,F.TIMEOUT=8,F.HTTP_ERROR=6,rh=F,L.COMPLETE="complete",kk=L,Sa.EventType=qn,qn.OPEN="a",qn.CLOSE="b",qn.ERROR="c",qn.MESSAGE="d",vt.prototype.listen=vt.prototype.K,tc=Sa,jt.prototype.listenOnce=jt.prototype.L,jt.prototype.getLastError=jt.prototype.Ka,jt.prototype.getLastErrorCode=jt.prototype.Ba,jt.prototype.getStatus=jt.prototype.Z,jt.prototype.getResponseJson=jt.prototype.Oa,jt.prototype.getResponseText=jt.prototype.oa,jt.prototype.send=jt.prototype.ea,jt.prototype.setWithCredentials=jt.prototype.Ha,Tk=jt}).apply(typeof Sf<"u"?Sf:typeof self<"u"?self:typeof window<"u"?window:{});const Jy="@firebase/firestore";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mr{constructor(t){this.uid=t}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(t){return t.uid===this.uid}}Mr.UNAUTHENTICATED=new Mr(null),Mr.GOOGLE_CREDENTIALS=new Mr("google-credentials-uid"),Mr.FIRST_PARTY=new Mr("first-party-uid"),Mr.MOCK_USER=new Mr("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Tl="10.14.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qi=new Xg("@firebase/firestore");function Xl(){return qi.logLevel}function be(e,...t){if(qi.logLevel<=Ze.DEBUG){const r=t.map(lx);qi.debug(`Firestore (${Tl}): ${e}`,...r)}}function va(e,...t){if(qi.logLevel<=Ze.ERROR){const r=t.map(lx);qi.error(`Firestore (${Tl}): ${e}`,...r)}}function cl(e,...t){if(qi.logLevel<=Ze.WARN){const r=t.map(lx);qi.warn(`Firestore (${Tl}): ${e}`,...r)}}function lx(e){if(typeof e=="string")return e;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(r){return JSON.stringify(r)}(e)}catch{return e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Le(e="Unexpected state"){const t=`FIRESTORE (${Tl}) INTERNAL ASSERTION FAILED: `+e;throw va(t),new Error(t)}function xt(e,t){e||Le()}function ze(e,t){return e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pe={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Re extends js{constructor(t,r){super(t,r),this.code=t,this.message=r,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oa{constructor(){this.promise=new Promise((t,r)=>{this.resolve=t,this.reject=r})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ck{constructor(t,r){this.user=r,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${t}`)}}class z3{getToken(){return Promise.resolve(null)}invalidateToken(){}start(t,r){t.enqueueRetryable(()=>r(Mr.UNAUTHENTICATED))}shutdown(){}}class $3{constructor(t){this.token=t,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(t,r){this.changeListener=r,t.enqueueRetryable(()=>r(this.token.user))}shutdown(){this.changeListener=null}}class W3{constructor(t){this.t=t,this.currentUser=Mr.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(t,r){xt(this.o===void 0);let n=this.i;const s=l=>this.i!==n?(n=this.i,r(l)):Promise.resolve();let a=new oa;this.o=()=>{this.i++,this.currentUser=this.u(),a.resolve(),a=new oa,t.enqueueRetryable(()=>s(this.currentUser))};const i=()=>{const l=a;t.enqueueRetryable(async()=>{await l.promise,await s(this.currentUser)})},o=l=>{be("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=l,this.o&&(this.auth.addAuthTokenListener(this.o),i())};this.t.onInit(l=>o(l)),setTimeout(()=>{if(!this.auth){const l=this.t.getImmediate({optional:!0});l?o(l):(be("FirebaseAuthCredentialsProvider","Auth not yet detected"),a.resolve(),a=new oa)}},0),i()}getToken(){const t=this.i,r=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(r).then(n=>this.i!==t?(be("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):n?(xt(typeof n.accessToken=="string"),new Ck(n.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const t=this.auth&&this.auth.getUid();return xt(t===null||typeof t=="string"),new Mr(t)}}class H3{constructor(t,r,n){this.l=t,this.h=r,this.P=n,this.type="FirstParty",this.user=Mr.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);const t=this.T();return t&&this.I.set("Authorization",t),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}}class G3{constructor(t,r,n){this.l=t,this.h=r,this.P=n}getToken(){return Promise.resolve(new H3(this.l,this.h,this.P))}start(t,r){t.enqueueRetryable(()=>r(Mr.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class K3{constructor(t){this.value=t,this.type="AppCheck",this.headers=new Map,t&&t.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class q3{constructor(t){this.A=t,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(t,r){xt(this.o===void 0);const n=a=>{a.error!=null&&be("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${a.error.message}`);const i=a.token!==this.R;return this.R=a.token,be("FirebaseAppCheckTokenProvider",`Received ${i?"new":"existing"} token.`),i?r(a.token):Promise.resolve()};this.o=a=>{t.enqueueRetryable(()=>n(a))};const s=a=>{be("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=a,this.o&&this.appCheck.addTokenListener(this.o)};this.A.onInit(a=>s(a)),setTimeout(()=>{if(!this.appCheck){const a=this.A.getImmediate({optional:!0});a?s(a):be("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const t=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(t).then(r=>r?(xt(typeof r.token=="string"),this.R=r.token,new K3(r.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function X3(e){const t=typeof self<"u"&&(self.crypto||self.msCrypto),r=new Uint8Array(e);if(t&&typeof t.getRandomValues=="function")t.getRandomValues(r);else for(let n=0;n<e;n++)r[n]=Math.floor(256*Math.random());return r}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nk{static newId(){const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",r=Math.floor(256/t.length)*t.length;let n="";for(;n.length<20;){const s=X3(40);for(let a=0;a<s.length;++a)n.length<20&&s[a]<r&&(n+=t.charAt(s[a]%t.length))}return n}}function ut(e,t){return e<t?-1:e>t?1:0}function ul(e,t,r){return e.length===t.length&&e.every((n,s)=>r(n,t[s]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class or{constructor(t,r){if(this.seconds=t,this.nanoseconds=r,r<0)throw new Re(pe.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+r);if(r>=1e9)throw new Re(pe.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+r);if(t<-62135596800)throw new Re(pe.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(t>=253402300800)throw new Re(pe.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}static now(){return or.fromMillis(Date.now())}static fromDate(t){return or.fromMillis(t.getTime())}static fromMillis(t){const r=Math.floor(t/1e3),n=Math.floor(1e6*(t-1e3*r));return new or(r,n)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(t){return this.seconds===t.seconds?ut(this.nanoseconds,t.nanoseconds):ut(this.seconds,t.seconds)}isEqual(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const t=this.seconds- -62135596800;return String(t).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ve{constructor(t){this.timestamp=t}static fromTimestamp(t){return new Ve(t)}static min(){return new Ve(new or(0,0))}static max(){return new Ve(new or(253402300799,999999999))}compareTo(t){return this.timestamp._compareTo(t.timestamp)}isEqual(t){return this.timestamp.isEqual(t.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eu{constructor(t,r,n){r===void 0?r=0:r>t.length&&Le(),n===void 0?n=t.length-r:n>t.length-r&&Le(),this.segments=t,this.offset=r,this.len=n}get length(){return this.len}isEqual(t){return eu.comparator(this,t)===0}child(t){const r=this.segments.slice(this.offset,this.limit());return t instanceof eu?t.forEach(n=>{r.push(n)}):r.push(t),this.construct(r)}limit(){return this.offset+this.length}popFirst(t){return t=t===void 0?1:t,this.construct(this.segments,this.offset+t,this.length-t)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(t){return this.segments[this.offset+t]}isEmpty(){return this.length===0}isPrefixOf(t){if(t.length<this.length)return!1;for(let r=0;r<this.length;r++)if(this.get(r)!==t.get(r))return!1;return!0}isImmediateParentOf(t){if(this.length+1!==t.length)return!1;for(let r=0;r<this.length;r++)if(this.get(r)!==t.get(r))return!1;return!0}forEach(t){for(let r=this.offset,n=this.limit();r<n;r++)t(this.segments[r])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(t,r){const n=Math.min(t.length,r.length);for(let s=0;s<n;s++){const a=t.get(s),i=r.get(s);if(a<i)return-1;if(a>i)return 1}return t.length<r.length?-1:t.length>r.length?1:0}}class Ct extends eu{construct(t,r,n){return new Ct(t,r,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...t){const r=[];for(const n of t){if(n.indexOf("//")>=0)throw new Re(pe.INVALID_ARGUMENT,`Invalid segment (${n}). Paths must not contain // in them.`);r.push(...n.split("/").filter(s=>s.length>0))}return new Ct(r)}static emptyPath(){return new Ct([])}}const Y3=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Er extends eu{construct(t,r,n){return new Er(t,r,n)}static isValidIdentifier(t){return Y3.test(t)}canonicalString(){return this.toArray().map(t=>(t=t.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Er.isValidIdentifier(t)||(t="`"+t+"`"),t)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new Er(["__name__"])}static fromServerFormat(t){const r=[];let n="",s=0;const a=()=>{if(n.length===0)throw new Re(pe.INVALID_ARGUMENT,`Invalid field path (${t}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);r.push(n),n=""};let i=!1;for(;s<t.length;){const o=t[s];if(o==="\\"){if(s+1===t.length)throw new Re(pe.INVALID_ARGUMENT,"Path has trailing escape character: "+t);const l=t[s+1];if(l!=="\\"&&l!=="."&&l!=="`")throw new Re(pe.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);n+=l,s+=2}else o==="`"?(i=!i,s++):o!=="."||i?(n+=o,s++):(a(),s++)}if(a(),i)throw new Re(pe.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new Er(r)}static emptyPath(){return new Er([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pe{constructor(t){this.path=t}static fromPath(t){return new Pe(Ct.fromString(t))}static fromName(t){return new Pe(Ct.fromString(t).popFirst(5))}static empty(){return new Pe(Ct.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(t){return this.path.length>=2&&this.path.get(this.path.length-2)===t}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(t){return t!==null&&Ct.comparator(this.path,t.path)===0}toString(){return this.path.toString()}static comparator(t,r){return Ct.comparator(t.path,r.path)}static isDocumentKey(t){return t.length%2==0}static fromSegments(t){return new Pe(new Ct(t.slice()))}}function Q3(e,t){const r=e.toTimestamp().seconds,n=e.toTimestamp().nanoseconds+1,s=Ve.fromTimestamp(n===1e9?new or(r+1,0):new or(r,n));return new li(s,Pe.empty(),t)}function J3(e){return new li(e.readTime,e.key,-1)}class li{constructor(t,r,n){this.readTime=t,this.documentKey=r,this.largestBatchId=n}static min(){return new li(Ve.min(),Pe.empty(),-1)}static max(){return new li(Ve.max(),Pe.empty(),-1)}}function Z3(e,t){let r=e.readTime.compareTo(t.readTime);return r!==0?r:(r=Pe.comparator(e.documentKey,t.documentKey),r!==0?r:ut(e.largestBatchId,t.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const eF="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class tF{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(t){this.onCommittedListeners.push(t)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(t=>t())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Ru(e){if(e.code!==pe.FAILED_PRECONDITION||e.message!==eF)throw e;be("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ye{constructor(t){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,t(r=>{this.isDone=!0,this.result=r,this.nextCallback&&this.nextCallback(r)},r=>{this.isDone=!0,this.error=r,this.catchCallback&&this.catchCallback(r)})}catch(t){return this.next(void 0,t)}next(t,r){return this.callbackAttached&&Le(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(r,this.error):this.wrapSuccess(t,this.result):new ye((n,s)=>{this.nextCallback=a=>{this.wrapSuccess(t,a).next(n,s)},this.catchCallback=a=>{this.wrapFailure(r,a).next(n,s)}})}toPromise(){return new Promise((t,r)=>{this.next(t,r)})}wrapUserFunction(t){try{const r=t();return r instanceof ye?r:ye.resolve(r)}catch(r){return ye.reject(r)}}wrapSuccess(t,r){return t?this.wrapUserFunction(()=>t(r)):ye.resolve(r)}wrapFailure(t,r){return t?this.wrapUserFunction(()=>t(r)):ye.reject(r)}static resolve(t){return new ye((r,n)=>{r(t)})}static reject(t){return new ye((r,n)=>{n(t)})}static waitFor(t){return new ye((r,n)=>{let s=0,a=0,i=!1;t.forEach(o=>{++s,o.next(()=>{++a,i&&a===s&&r()},l=>n(l))}),i=!0,a===s&&r()})}static or(t){let r=ye.resolve(!1);for(const n of t)r=r.next(s=>s?ye.resolve(s):n());return r}static forEach(t,r){const n=[];return t.forEach((s,a)=>{n.push(r.call(this,s,a))}),this.waitFor(n)}static mapArray(t,r){return new ye((n,s)=>{const a=t.length,i=new Array(a);let o=0;for(let l=0;l<a;l++){const c=l;r(t[c]).next(u=>{i[c]=u,++o,o===a&&n(i)},u=>s(u))}})}static doWhile(t,r){return new ye((n,s)=>{const a=()=>{t()===!0?r().next(()=>{a()},s):n()};a()})}}function rF(e){const t=e.match(/Android ([\d.]+)/i),r=t?t[1].split(".").slice(0,2).join("."):"-1";return Number(r)}function bu(e){return e.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cx{constructor(t,r){this.previousValue=t,r&&(r.sequenceNumberHandler=n=>this.ie(n),this.se=n=>r.writeSequenceNumber(n))}ie(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue}next(){const t=++this.previousValue;return this.se&&this.se(t),t}}cx.oe=-1;function Md(e){return e==null}function Wh(e){return e===0&&1/e==-1/0}function nF(e){return typeof e=="number"&&Number.isInteger(e)&&!Wh(e)&&e<=Number.MAX_SAFE_INTEGER&&e>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Zy(e){let t=0;for(const r in e)Object.prototype.hasOwnProperty.call(e,r)&&t++;return t}function no(e,t){for(const r in e)Object.prototype.hasOwnProperty.call(e,r)&&t(r,e[r])}function Rk(e){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lt{constructor(t,r){this.comparator=t,this.root=r||_r.EMPTY}insert(t,r){return new Lt(this.comparator,this.root.insert(t,r,this.comparator).copy(null,null,_r.BLACK,null,null))}remove(t){return new Lt(this.comparator,this.root.remove(t,this.comparator).copy(null,null,_r.BLACK,null,null))}get(t){let r=this.root;for(;!r.isEmpty();){const n=this.comparator(t,r.key);if(n===0)return r.value;n<0?r=r.left:n>0&&(r=r.right)}return null}indexOf(t){let r=0,n=this.root;for(;!n.isEmpty();){const s=this.comparator(t,n.key);if(s===0)return r+n.left.size;s<0?n=n.left:(r+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(t){return this.root.inorderTraversal(t)}forEach(t){this.inorderTraversal((r,n)=>(t(r,n),!1))}toString(){const t=[];return this.inorderTraversal((r,n)=>(t.push(`${r}:${n}`),!1)),`{${t.join(", ")}}`}reverseTraversal(t){return this.root.reverseTraversal(t)}getIterator(){return new Af(this.root,null,this.comparator,!1)}getIteratorFrom(t){return new Af(this.root,t,this.comparator,!1)}getReverseIterator(){return new Af(this.root,null,this.comparator,!0)}getReverseIteratorFrom(t){return new Af(this.root,t,this.comparator,!0)}}class Af{constructor(t,r,n,s){this.isReverse=s,this.nodeStack=[];let a=1;for(;!t.isEmpty();)if(a=r?n(t.key,r):1,r&&s&&(a*=-1),a<0)t=this.isReverse?t.left:t.right;else{if(a===0){this.nodeStack.push(t);break}this.nodeStack.push(t),t=this.isReverse?t.right:t.left}}getNext(){let t=this.nodeStack.pop();const r={key:t.key,value:t.value};if(this.isReverse)for(t=t.left;!t.isEmpty();)this.nodeStack.push(t),t=t.right;else for(t=t.right;!t.isEmpty();)this.nodeStack.push(t),t=t.left;return r}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const t=this.nodeStack[this.nodeStack.length-1];return{key:t.key,value:t.value}}}class _r{constructor(t,r,n,s,a){this.key=t,this.value=r,this.color=n??_r.RED,this.left=s??_r.EMPTY,this.right=a??_r.EMPTY,this.size=this.left.size+1+this.right.size}copy(t,r,n,s,a){return new _r(t??this.key,r??this.value,n??this.color,s??this.left,a??this.right)}isEmpty(){return!1}inorderTraversal(t){return this.left.inorderTraversal(t)||t(this.key,this.value)||this.right.inorderTraversal(t)}reverseTraversal(t){return this.right.reverseTraversal(t)||t(this.key,this.value)||this.left.reverseTraversal(t)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(t,r,n){let s=this;const a=n(t,s.key);return s=a<0?s.copy(null,null,null,s.left.insert(t,r,n),null):a===0?s.copy(null,r,null,null,null):s.copy(null,null,null,null,s.right.insert(t,r,n)),s.fixUp()}removeMin(){if(this.left.isEmpty())return _r.EMPTY;let t=this;return t.left.isRed()||t.left.left.isRed()||(t=t.moveRedLeft()),t=t.copy(null,null,null,t.left.removeMin(),null),t.fixUp()}remove(t,r){let n,s=this;if(r(t,s.key)<0)s.left.isEmpty()||s.left.isRed()||s.left.left.isRed()||(s=s.moveRedLeft()),s=s.copy(null,null,null,s.left.remove(t,r),null);else{if(s.left.isRed()&&(s=s.rotateRight()),s.right.isEmpty()||s.right.isRed()||s.right.left.isRed()||(s=s.moveRedRight()),r(t,s.key)===0){if(s.right.isEmpty())return _r.EMPTY;n=s.right.min(),s=s.copy(n.key,n.value,null,null,s.right.removeMin())}s=s.copy(null,null,null,null,s.right.remove(t,r))}return s.fixUp()}isRed(){return this.color}fixUp(){let t=this;return t.right.isRed()&&!t.left.isRed()&&(t=t.rotateLeft()),t.left.isRed()&&t.left.left.isRed()&&(t=t.rotateRight()),t.left.isRed()&&t.right.isRed()&&(t=t.colorFlip()),t}moveRedLeft(){let t=this.colorFlip();return t.right.left.isRed()&&(t=t.copy(null,null,null,null,t.right.rotateRight()),t=t.rotateLeft(),t=t.colorFlip()),t}moveRedRight(){let t=this.colorFlip();return t.left.left.isRed()&&(t=t.rotateRight(),t=t.colorFlip()),t}rotateLeft(){const t=this.copy(null,null,_r.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)}rotateRight(){const t=this.copy(null,null,_r.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)}colorFlip(){const t=this.left.copy(null,null,!this.left.color,null,null),r=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,r)}checkMaxDepth(){const t=this.check();return Math.pow(2,t)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw Le();const t=this.left.check();if(t!==this.right.check())throw Le();return t+(this.isRed()?0:1)}}_r.EMPTY=null,_r.RED=!0,_r.BLACK=!1;_r.EMPTY=new class{constructor(){this.size=0}get key(){throw Le()}get value(){throw Le()}get color(){throw Le()}get left(){throw Le()}get right(){throw Le()}copy(t,r,n,s,a){return this}insert(t,r,n){return new _r(t,r)}remove(t,r){return this}isEmpty(){return!0}inorderTraversal(t){return!1}reverseTraversal(t){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kr{constructor(t){this.comparator=t,this.data=new Lt(this.comparator)}has(t){return this.data.get(t)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(t){return this.data.indexOf(t)}forEach(t){this.data.inorderTraversal((r,n)=>(t(r),!1))}forEachInRange(t,r){const n=this.data.getIteratorFrom(t[0]);for(;n.hasNext();){const s=n.getNext();if(this.comparator(s.key,t[1])>=0)return;r(s.key)}}forEachWhile(t,r){let n;for(n=r!==void 0?this.data.getIteratorFrom(r):this.data.getIterator();n.hasNext();)if(!t(n.getNext().key))return}firstAfterOrEqual(t){const r=this.data.getIteratorFrom(t);return r.hasNext()?r.getNext().key:null}getIterator(){return new e_(this.data.getIterator())}getIteratorFrom(t){return new e_(this.data.getIteratorFrom(t))}add(t){return this.copy(this.data.remove(t).insert(t,!0))}delete(t){return this.has(t)?this.copy(this.data.remove(t)):this}isEmpty(){return this.data.isEmpty()}unionWith(t){let r=this;return r.size<t.size&&(r=t,t=this),t.forEach(n=>{r=r.add(n)}),r}isEqual(t){if(!(t instanceof kr)||this.size!==t.size)return!1;const r=this.data.getIterator(),n=t.data.getIterator();for(;r.hasNext();){const s=r.getNext().key,a=n.getNext().key;if(this.comparator(s,a)!==0)return!1}return!0}toArray(){const t=[];return this.forEach(r=>{t.push(r)}),t}toString(){const t=[];return this.forEach(r=>t.push(r)),"SortedSet("+t.toString()+")"}copy(t){const r=new kr(this.comparator);return r.data=t,r}}class e_{constructor(t){this.iter=t}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tn{constructor(t){this.fields=t,t.sort(Er.comparator)}static empty(){return new Tn([])}unionWith(t){let r=new kr(Er.comparator);for(const n of this.fields)r=r.add(n);for(const n of t)r=r.add(n);return new Tn(r.toArray())}covers(t){for(const r of this.fields)if(r.isPrefixOf(t))return!0;return!1}isEqual(t){return ul(this.fields,t.fields,(r,n)=>r.isEqual(n))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bk extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cr{constructor(t){this.binaryString=t}static fromBase64String(t){const r=function(s){try{return atob(s)}catch(a){throw typeof DOMException<"u"&&a instanceof DOMException?new bk("Invalid base64 string: "+a):a}}(t);return new Cr(r)}static fromUint8Array(t){const r=function(s){let a="";for(let i=0;i<s.length;++i)a+=String.fromCharCode(s[i]);return a}(t);return new Cr(r)}[Symbol.iterator](){let t=0;return{next:()=>t<this.binaryString.length?{value:this.binaryString.charCodeAt(t++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(r){return btoa(r)}(this.binaryString)}toUint8Array(){return function(r){const n=new Uint8Array(r.length);for(let s=0;s<r.length;s++)n[s]=r.charCodeAt(s);return n}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(t){return ut(this.binaryString,t.binaryString)}isEqual(t){return this.binaryString===t.binaryString}}Cr.EMPTY_BYTE_STRING=new Cr("");const sF=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function ci(e){if(xt(!!e),typeof e=="string"){let t=0;const r=sF.exec(e);if(xt(!!r),r[1]){let s=r[1];s=(s+"000000000").substr(0,9),t=Number(s)}const n=new Date(e);return{seconds:Math.floor(n.getTime()/1e3),nanos:t}}return{seconds:Wt(e.seconds),nanos:Wt(e.nanos)}}function Wt(e){return typeof e=="number"?e:typeof e=="string"?Number(e):0}function Xi(e){return typeof e=="string"?Cr.fromBase64String(e):Cr.fromUint8Array(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ux(e){var t,r;return((r=(((t=e==null?void 0:e.mapValue)===null||t===void 0?void 0:t.fields)||{}).__type__)===null||r===void 0?void 0:r.stringValue)==="server_timestamp"}function fx(e){const t=e.mapValue.fields.__previous_value__;return ux(t)?fx(t):t}function tu(e){const t=ci(e.mapValue.fields.__local_write_time__.timestampValue);return new or(t.seconds,t.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aF{constructor(t,r,n,s,a,i,o,l,c){this.databaseId=t,this.appId=r,this.persistenceKey=n,this.host=s,this.ssl=a,this.forceLongPolling=i,this.autoDetectLongPolling=o,this.longPollingOptions=l,this.useFetchStreams=c}}class ru{constructor(t,r){this.projectId=t,this.database=r||"(default)"}static empty(){return new ru("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(t){return t instanceof ru&&t.projectId===this.projectId&&t.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const If={mapValue:{}};function Yi(e){return"nullValue"in e?0:"booleanValue"in e?1:"integerValue"in e||"doubleValue"in e?2:"timestampValue"in e?3:"stringValue"in e?5:"bytesValue"in e?6:"referenceValue"in e?7:"geoPointValue"in e?8:"arrayValue"in e?9:"mapValue"in e?ux(e)?4:oF(e)?9007199254740991:iF(e)?10:11:Le()}function bs(e,t){if(e===t)return!0;const r=Yi(e);if(r!==Yi(t))return!1;switch(r){case 0:case 9007199254740991:return!0;case 1:return e.booleanValue===t.booleanValue;case 4:return tu(e).isEqual(tu(t));case 3:return function(s,a){if(typeof s.timestampValue=="string"&&typeof a.timestampValue=="string"&&s.timestampValue.length===a.timestampValue.length)return s.timestampValue===a.timestampValue;const i=ci(s.timestampValue),o=ci(a.timestampValue);return i.seconds===o.seconds&&i.nanos===o.nanos}(e,t);case 5:return e.stringValue===t.stringValue;case 6:return function(s,a){return Xi(s.bytesValue).isEqual(Xi(a.bytesValue))}(e,t);case 7:return e.referenceValue===t.referenceValue;case 8:return function(s,a){return Wt(s.geoPointValue.latitude)===Wt(a.geoPointValue.latitude)&&Wt(s.geoPointValue.longitude)===Wt(a.geoPointValue.longitude)}(e,t);case 2:return function(s,a){if("integerValue"in s&&"integerValue"in a)return Wt(s.integerValue)===Wt(a.integerValue);if("doubleValue"in s&&"doubleValue"in a){const i=Wt(s.doubleValue),o=Wt(a.doubleValue);return i===o?Wh(i)===Wh(o):isNaN(i)&&isNaN(o)}return!1}(e,t);case 9:return ul(e.arrayValue.values||[],t.arrayValue.values||[],bs);case 10:case 11:return function(s,a){const i=s.mapValue.fields||{},o=a.mapValue.fields||{};if(Zy(i)!==Zy(o))return!1;for(const l in i)if(i.hasOwnProperty(l)&&(o[l]===void 0||!bs(i[l],o[l])))return!1;return!0}(e,t);default:return Le()}}function nu(e,t){return(e.values||[]).find(r=>bs(r,t))!==void 0}function fl(e,t){if(e===t)return 0;const r=Yi(e),n=Yi(t);if(r!==n)return ut(r,n);switch(r){case 0:case 9007199254740991:return 0;case 1:return ut(e.booleanValue,t.booleanValue);case 2:return function(a,i){const o=Wt(a.integerValue||a.doubleValue),l=Wt(i.integerValue||i.doubleValue);return o<l?-1:o>l?1:o===l?0:isNaN(o)?isNaN(l)?0:-1:1}(e,t);case 3:return t_(e.timestampValue,t.timestampValue);case 4:return t_(tu(e),tu(t));case 5:return ut(e.stringValue,t.stringValue);case 6:return function(a,i){const o=Xi(a),l=Xi(i);return o.compareTo(l)}(e.bytesValue,t.bytesValue);case 7:return function(a,i){const o=a.split("/"),l=i.split("/");for(let c=0;c<o.length&&c<l.length;c++){const u=ut(o[c],l[c]);if(u!==0)return u}return ut(o.length,l.length)}(e.referenceValue,t.referenceValue);case 8:return function(a,i){const o=ut(Wt(a.latitude),Wt(i.latitude));return o!==0?o:ut(Wt(a.longitude),Wt(i.longitude))}(e.geoPointValue,t.geoPointValue);case 9:return r_(e.arrayValue,t.arrayValue);case 10:return function(a,i){var o,l,c,u;const d=a.fields||{},m=i.fields||{},p=(o=d.value)===null||o===void 0?void 0:o.arrayValue,x=(l=m.value)===null||l===void 0?void 0:l.arrayValue,g=ut(((c=p==null?void 0:p.values)===null||c===void 0?void 0:c.length)||0,((u=x==null?void 0:x.values)===null||u===void 0?void 0:u.length)||0);return g!==0?g:r_(p,x)}(e.mapValue,t.mapValue);case 11:return function(a,i){if(a===If.mapValue&&i===If.mapValue)return 0;if(a===If.mapValue)return 1;if(i===If.mapValue)return-1;const o=a.fields||{},l=Object.keys(o),c=i.fields||{},u=Object.keys(c);l.sort(),u.sort();for(let d=0;d<l.length&&d<u.length;++d){const m=ut(l[d],u[d]);if(m!==0)return m;const p=fl(o[l[d]],c[u[d]]);if(p!==0)return p}return ut(l.length,u.length)}(e.mapValue,t.mapValue);default:throw Le()}}function t_(e,t){if(typeof e=="string"&&typeof t=="string"&&e.length===t.length)return ut(e,t);const r=ci(e),n=ci(t),s=ut(r.seconds,n.seconds);return s!==0?s:ut(r.nanos,n.nanos)}function r_(e,t){const r=e.values||[],n=t.values||[];for(let s=0;s<r.length&&s<n.length;++s){const a=fl(r[s],n[s]);if(a)return a}return ut(r.length,n.length)}function hl(e){return gp(e)}function gp(e){return"nullValue"in e?"null":"booleanValue"in e?""+e.booleanValue:"integerValue"in e?""+e.integerValue:"doubleValue"in e?""+e.doubleValue:"timestampValue"in e?function(r){const n=ci(r);return`time(${n.seconds},${n.nanos})`}(e.timestampValue):"stringValue"in e?e.stringValue:"bytesValue"in e?function(r){return Xi(r).toBase64()}(e.bytesValue):"referenceValue"in e?function(r){return Pe.fromName(r).toString()}(e.referenceValue):"geoPointValue"in e?function(r){return`geo(${r.latitude},${r.longitude})`}(e.geoPointValue):"arrayValue"in e?function(r){let n="[",s=!0;for(const a of r.values||[])s?s=!1:n+=",",n+=gp(a);return n+"]"}(e.arrayValue):"mapValue"in e?function(r){const n=Object.keys(r.fields||{}).sort();let s="{",a=!0;for(const i of n)a?a=!1:s+=",",s+=`${i}:${gp(r.fields[i])}`;return s+"}"}(e.mapValue):Le()}function n_(e,t){return{referenceValue:`projects/${e.projectId}/databases/${e.database}/documents/${t.path.canonicalString()}`}}function xp(e){return!!e&&"integerValue"in e}function hx(e){return!!e&&"arrayValue"in e}function s_(e){return!!e&&"nullValue"in e}function a_(e){return!!e&&"doubleValue"in e&&isNaN(Number(e.doubleValue))}function nh(e){return!!e&&"mapValue"in e}function iF(e){var t,r;return((r=(((t=e==null?void 0:e.mapValue)===null||t===void 0?void 0:t.fields)||{}).__type__)===null||r===void 0?void 0:r.stringValue)==="__vector__"}function yc(e){if(e.geoPointValue)return{geoPointValue:Object.assign({},e.geoPointValue)};if(e.timestampValue&&typeof e.timestampValue=="object")return{timestampValue:Object.assign({},e.timestampValue)};if(e.mapValue){const t={mapValue:{fields:{}}};return no(e.mapValue.fields,(r,n)=>t.mapValue.fields[r]=yc(n)),t}if(e.arrayValue){const t={arrayValue:{values:[]}};for(let r=0;r<(e.arrayValue.values||[]).length;++r)t.arrayValue.values[r]=yc(e.arrayValue.values[r]);return t}return Object.assign({},e)}function oF(e){return(((e.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class un{constructor(t){this.value=t}static empty(){return new un({mapValue:{}})}field(t){if(t.isEmpty())return this.value;{let r=this.value;for(let n=0;n<t.length-1;++n)if(r=(r.mapValue.fields||{})[t.get(n)],!nh(r))return null;return r=(r.mapValue.fields||{})[t.lastSegment()],r||null}}set(t,r){this.getFieldsMap(t.popLast())[t.lastSegment()]=yc(r)}setAll(t){let r=Er.emptyPath(),n={},s=[];t.forEach((i,o)=>{if(!r.isImmediateParentOf(o)){const l=this.getFieldsMap(r);this.applyChanges(l,n,s),n={},s=[],r=o.popLast()}i?n[o.lastSegment()]=yc(i):s.push(o.lastSegment())});const a=this.getFieldsMap(r);this.applyChanges(a,n,s)}delete(t){const r=this.field(t.popLast());nh(r)&&r.mapValue.fields&&delete r.mapValue.fields[t.lastSegment()]}isEqual(t){return bs(this.value,t.value)}getFieldsMap(t){let r=this.value;r.mapValue.fields||(r.mapValue={fields:{}});for(let n=0;n<t.length;++n){let s=r.mapValue.fields[t.get(n)];nh(s)&&s.mapValue.fields||(s={mapValue:{fields:{}}},r.mapValue.fields[t.get(n)]=s),r=s}return r.mapValue.fields}applyChanges(t,r,n){no(r,(s,a)=>t[s]=a);for(const s of n)delete t[s]}clone(){return new un(yc(this.value))}}function Pk(e){const t=[];return no(e.fields,(r,n)=>{const s=new Er([r]);if(nh(n)){const a=Pk(n.mapValue).fields;if(a.length===0)t.push(s);else for(const i of a)t.push(s.child(i))}else t.push(s)}),new Tn(t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ur{constructor(t,r,n,s,a,i,o){this.key=t,this.documentType=r,this.version=n,this.readTime=s,this.createTime=a,this.data=i,this.documentState=o}static newInvalidDocument(t){return new Ur(t,0,Ve.min(),Ve.min(),Ve.min(),un.empty(),0)}static newFoundDocument(t,r,n,s){return new Ur(t,1,r,Ve.min(),n,s,0)}static newNoDocument(t,r){return new Ur(t,2,r,Ve.min(),Ve.min(),un.empty(),0)}static newUnknownDocument(t,r){return new Ur(t,3,r,Ve.min(),Ve.min(),un.empty(),2)}convertToFoundDocument(t,r){return!this.createTime.isEqual(Ve.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=t),this.version=t,this.documentType=1,this.data=r,this.documentState=0,this}convertToNoDocument(t){return this.version=t,this.documentType=2,this.data=un.empty(),this.documentState=0,this}convertToUnknownDocument(t){return this.version=t,this.documentType=3,this.data=un.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Ve.min(),this}setReadTime(t){return this.readTime=t,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(t){return t instanceof Ur&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.documentType===t.documentType&&this.documentState===t.documentState&&this.data.isEqual(t.data)}mutableCopy(){return new Ur(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hh{constructor(t,r){this.position=t,this.inclusive=r}}function i_(e,t,r){let n=0;for(let s=0;s<e.position.length;s++){const a=t[s],i=e.position[s];if(a.field.isKeyField()?n=Pe.comparator(Pe.fromName(i.referenceValue),r.key):n=fl(i,r.data.field(a.field)),a.dir==="desc"&&(n*=-1),n!==0)break}return n}function o_(e,t){if(e===null)return t===null;if(t===null||e.inclusive!==t.inclusive||e.position.length!==t.position.length)return!1;for(let r=0;r<e.position.length;r++)if(!bs(e.position[r],t.position[r]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gh{constructor(t,r="asc"){this.field=t,this.dir=r}}function lF(e,t){return e.dir===t.dir&&e.field.isEqual(t.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dk{}class tr extends Dk{constructor(t,r,n){super(),this.field=t,this.op=r,this.value=n}static create(t,r,n){return t.isKeyField()?r==="in"||r==="not-in"?this.createKeyFieldInFilter(t,r,n):new uF(t,r,n):r==="array-contains"?new dF(t,n):r==="in"?new mF(t,n):r==="not-in"?new pF(t,n):r==="array-contains-any"?new gF(t,n):new tr(t,r,n)}static createKeyFieldInFilter(t,r,n){return r==="in"?new fF(t,n):new hF(t,n)}matches(t){const r=t.data.field(this.field);return this.op==="!="?r!==null&&this.matchesComparison(fl(r,this.value)):r!==null&&Yi(this.value)===Yi(r)&&this.matchesComparison(fl(r,this.value))}matchesComparison(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return t===0;case"!=":return t!==0;case">":return t>0;case">=":return t>=0;default:return Le()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class ds extends Dk{constructor(t,r){super(),this.filters=t,this.op=r,this.ae=null}static create(t,r){return new ds(t,r)}matches(t){return Fk(this)?this.filters.find(r=>!r.matches(t))===void 0:this.filters.find(r=>r.matches(t))!==void 0}getFlattenedFilters(){return this.ae!==null||(this.ae=this.filters.reduce((t,r)=>t.concat(r.getFlattenedFilters()),[])),this.ae}getFilters(){return Object.assign([],this.filters)}}function Fk(e){return e.op==="and"}function Ok(e){return cF(e)&&Fk(e)}function cF(e){for(const t of e.filters)if(t instanceof ds)return!1;return!0}function vp(e){if(e instanceof tr)return e.field.canonicalString()+e.op.toString()+hl(e.value);if(Ok(e))return e.filters.map(t=>vp(t)).join(",");{const t=e.filters.map(r=>vp(r)).join(",");return`${e.op}(${t})`}}function Mk(e,t){return e instanceof tr?function(n,s){return s instanceof tr&&n.op===s.op&&n.field.isEqual(s.field)&&bs(n.value,s.value)}(e,t):e instanceof ds?function(n,s){return s instanceof ds&&n.op===s.op&&n.filters.length===s.filters.length?n.filters.reduce((a,i,o)=>a&&Mk(i,s.filters[o]),!0):!1}(e,t):void Le()}function Lk(e){return e instanceof tr?function(r){return`${r.field.canonicalString()} ${r.op} ${hl(r.value)}`}(e):e instanceof ds?function(r){return r.op.toString()+" {"+r.getFilters().map(Lk).join(" ,")+"}"}(e):"Filter"}class uF extends tr{constructor(t,r,n){super(t,r,n),this.key=Pe.fromName(n.referenceValue)}matches(t){const r=Pe.comparator(t.key,this.key);return this.matchesComparison(r)}}class fF extends tr{constructor(t,r){super(t,"in",r),this.keys=jk("in",r)}matches(t){return this.keys.some(r=>r.isEqual(t.key))}}class hF extends tr{constructor(t,r){super(t,"not-in",r),this.keys=jk("not-in",r)}matches(t){return!this.keys.some(r=>r.isEqual(t.key))}}function jk(e,t){var r;return(((r=t.arrayValue)===null||r===void 0?void 0:r.values)||[]).map(n=>Pe.fromName(n.referenceValue))}class dF extends tr{constructor(t,r){super(t,"array-contains",r)}matches(t){const r=t.data.field(this.field);return hx(r)&&nu(r.arrayValue,this.value)}}class mF extends tr{constructor(t,r){super(t,"in",r)}matches(t){const r=t.data.field(this.field);return r!==null&&nu(this.value.arrayValue,r)}}class pF extends tr{constructor(t,r){super(t,"not-in",r)}matches(t){if(nu(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const r=t.data.field(this.field);return r!==null&&!nu(this.value.arrayValue,r)}}class gF extends tr{constructor(t,r){super(t,"array-contains-any",r)}matches(t){const r=t.data.field(this.field);return!(!hx(r)||!r.arrayValue.values)&&r.arrayValue.values.some(n=>nu(this.value.arrayValue,n))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xF{constructor(t,r=null,n=[],s=[],a=null,i=null,o=null){this.path=t,this.collectionGroup=r,this.orderBy=n,this.filters=s,this.limit=a,this.startAt=i,this.endAt=o,this.ue=null}}function l_(e,t=null,r=[],n=[],s=null,a=null,i=null){return new xF(e,t,r,n,s,a,i)}function dx(e){const t=ze(e);if(t.ue===null){let r=t.path.canonicalString();t.collectionGroup!==null&&(r+="|cg:"+t.collectionGroup),r+="|f:",r+=t.filters.map(n=>vp(n)).join(","),r+="|ob:",r+=t.orderBy.map(n=>function(a){return a.field.canonicalString()+a.dir}(n)).join(","),Md(t.limit)||(r+="|l:",r+=t.limit),t.startAt&&(r+="|lb:",r+=t.startAt.inclusive?"b:":"a:",r+=t.startAt.position.map(n=>hl(n)).join(",")),t.endAt&&(r+="|ub:",r+=t.endAt.inclusive?"a:":"b:",r+=t.endAt.position.map(n=>hl(n)).join(",")),t.ue=r}return t.ue}function mx(e,t){if(e.limit!==t.limit||e.orderBy.length!==t.orderBy.length)return!1;for(let r=0;r<e.orderBy.length;r++)if(!lF(e.orderBy[r],t.orderBy[r]))return!1;if(e.filters.length!==t.filters.length)return!1;for(let r=0;r<e.filters.length;r++)if(!Mk(e.filters[r],t.filters[r]))return!1;return e.collectionGroup===t.collectionGroup&&!!e.path.isEqual(t.path)&&!!o_(e.startAt,t.startAt)&&o_(e.endAt,t.endAt)}function yp(e){return Pe.isDocumentKey(e.path)&&e.collectionGroup===null&&e.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pu{constructor(t,r=null,n=[],s=[],a=null,i="F",o=null,l=null){this.path=t,this.collectionGroup=r,this.explicitOrderBy=n,this.filters=s,this.limit=a,this.limitType=i,this.startAt=o,this.endAt=l,this.ce=null,this.le=null,this.he=null,this.startAt,this.endAt}}function vF(e,t,r,n,s,a,i,o){return new Pu(e,t,r,n,s,a,i,o)}function Ld(e){return new Pu(e)}function c_(e){return e.filters.length===0&&e.limit===null&&e.startAt==null&&e.endAt==null&&(e.explicitOrderBy.length===0||e.explicitOrderBy.length===1&&e.explicitOrderBy[0].field.isKeyField())}function Uk(e){return e.collectionGroup!==null}function _c(e){const t=ze(e);if(t.ce===null){t.ce=[];const r=new Set;for(const a of t.explicitOrderBy)t.ce.push(a),r.add(a.field.canonicalString());const n=t.explicitOrderBy.length>0?t.explicitOrderBy[t.explicitOrderBy.length-1].dir:"asc";(function(i){let o=new kr(Er.comparator);return i.filters.forEach(l=>{l.getFlattenedFilters().forEach(c=>{c.isInequality()&&(o=o.add(c.field))})}),o})(t).forEach(a=>{r.has(a.canonicalString())||a.isKeyField()||t.ce.push(new Gh(a,n))}),r.has(Er.keyField().canonicalString())||t.ce.push(new Gh(Er.keyField(),n))}return t.ce}function Is(e){const t=ze(e);return t.le||(t.le=yF(t,_c(e))),t.le}function yF(e,t){if(e.limitType==="F")return l_(e.path,e.collectionGroup,t,e.filters,e.limit,e.startAt,e.endAt);{t=t.map(s=>{const a=s.dir==="desc"?"asc":"desc";return new Gh(s.field,a)});const r=e.endAt?new Hh(e.endAt.position,e.endAt.inclusive):null,n=e.startAt?new Hh(e.startAt.position,e.startAt.inclusive):null;return l_(e.path,e.collectionGroup,t,e.filters,e.limit,r,n)}}function _p(e,t){const r=e.filters.concat([t]);return new Pu(e.path,e.collectionGroup,e.explicitOrderBy.slice(),r,e.limit,e.limitType,e.startAt,e.endAt)}function wp(e,t,r){return new Pu(e.path,e.collectionGroup,e.explicitOrderBy.slice(),e.filters.slice(),t,r,e.startAt,e.endAt)}function jd(e,t){return mx(Is(e),Is(t))&&e.limitType===t.limitType}function Vk(e){return`${dx(Is(e))}|lt:${e.limitType}`}function Eo(e){return`Query(target=${function(r){let n=r.path.canonicalString();return r.collectionGroup!==null&&(n+=" collectionGroup="+r.collectionGroup),r.filters.length>0&&(n+=`, filters: [${r.filters.map(s=>Lk(s)).join(", ")}]`),Md(r.limit)||(n+=", limit: "+r.limit),r.orderBy.length>0&&(n+=`, orderBy: [${r.orderBy.map(s=>function(i){return`${i.field.canonicalString()} (${i.dir})`}(s)).join(", ")}]`),r.startAt&&(n+=", startAt: ",n+=r.startAt.inclusive?"b:":"a:",n+=r.startAt.position.map(s=>hl(s)).join(",")),r.endAt&&(n+=", endAt: ",n+=r.endAt.inclusive?"a:":"b:",n+=r.endAt.position.map(s=>hl(s)).join(",")),`Target(${n})`}(Is(e))}; limitType=${e.limitType})`}function Ud(e,t){return t.isFoundDocument()&&function(n,s){const a=s.key.path;return n.collectionGroup!==null?s.key.hasCollectionId(n.collectionGroup)&&n.path.isPrefixOf(a):Pe.isDocumentKey(n.path)?n.path.isEqual(a):n.path.isImmediateParentOf(a)}(e,t)&&function(n,s){for(const a of _c(n))if(!a.field.isKeyField()&&s.data.field(a.field)===null)return!1;return!0}(e,t)&&function(n,s){for(const a of n.filters)if(!a.matches(s))return!1;return!0}(e,t)&&function(n,s){return!(n.startAt&&!function(i,o,l){const c=i_(i,o,l);return i.inclusive?c<=0:c<0}(n.startAt,_c(n),s)||n.endAt&&!function(i,o,l){const c=i_(i,o,l);return i.inclusive?c>=0:c>0}(n.endAt,_c(n),s))}(e,t)}function _F(e){return e.collectionGroup||(e.path.length%2==1?e.path.lastSegment():e.path.get(e.path.length-2))}function Bk(e){return(t,r)=>{let n=!1;for(const s of _c(e)){const a=wF(s,t,r);if(a!==0)return a;n=n||s.field.isKeyField()}return 0}}function wF(e,t,r){const n=e.field.isKeyField()?Pe.comparator(t.key,r.key):function(a,i,o){const l=i.data.field(a),c=o.data.field(a);return l!==null&&c!==null?fl(l,c):Le()}(e.field,t,r);switch(e.dir){case"asc":return n;case"desc":return-1*n;default:return Le()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kl{constructor(t,r){this.mapKeyFn=t,this.equalsFn=r,this.inner={},this.innerSize=0}get(t){const r=this.mapKeyFn(t),n=this.inner[r];if(n!==void 0){for(const[s,a]of n)if(this.equalsFn(s,t))return a}}has(t){return this.get(t)!==void 0}set(t,r){const n=this.mapKeyFn(t),s=this.inner[n];if(s===void 0)return this.inner[n]=[[t,r]],void this.innerSize++;for(let a=0;a<s.length;a++)if(this.equalsFn(s[a][0],t))return void(s[a]=[t,r]);s.push([t,r]),this.innerSize++}delete(t){const r=this.mapKeyFn(t),n=this.inner[r];if(n===void 0)return!1;for(let s=0;s<n.length;s++)if(this.equalsFn(n[s][0],t))return n.length===1?delete this.inner[r]:n.splice(s,1),this.innerSize--,!0;return!1}forEach(t){no(this.inner,(r,n)=>{for(const[s,a]of n)t(s,a)})}isEmpty(){return Rk(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const EF=new Lt(Pe.comparator);function ya(){return EF}const zk=new Lt(Pe.comparator);function rc(...e){let t=zk;for(const r of e)t=t.insert(r.key,r);return t}function $k(e){let t=zk;return e.forEach((r,n)=>t=t.insert(r,n.overlayedDocument)),t}function Di(){return wc()}function Wk(){return wc()}function wc(){return new kl(e=>e.toString(),(e,t)=>e.isEqual(t))}const TF=new Lt(Pe.comparator),kF=new kr(Pe.comparator);function Qe(...e){let t=kF;for(const r of e)t=t.add(r);return t}const SF=new kr(ut);function AF(){return SF}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function px(e,t){if(e.useProto3Json){if(isNaN(t))return{doubleValue:"NaN"};if(t===1/0)return{doubleValue:"Infinity"};if(t===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Wh(t)?"-0":t}}function Hk(e){return{integerValue:""+e}}function Gk(e,t){return nF(t)?Hk(t):px(e,t)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vd{constructor(){this._=void 0}}function IF(e,t,r){return e instanceof su?function(s,a){const i={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:s.seconds,nanos:s.nanoseconds}}}};return a&&ux(a)&&(a=fx(a)),a&&(i.fields.__previous_value__=a),{mapValue:i}}(r,t):e instanceof au?qk(e,t):e instanceof iu?Xk(e,t):function(s,a){const i=Kk(s,a),o=u_(i)+u_(s.Pe);return xp(i)&&xp(s.Pe)?Hk(o):px(s.serializer,o)}(e,t)}function CF(e,t,r){return e instanceof au?qk(e,t):e instanceof iu?Xk(e,t):r}function Kk(e,t){return e instanceof ou?function(n){return xp(n)||function(a){return!!a&&"doubleValue"in a}(n)}(t)?t:{integerValue:0}:null}class su extends Vd{}class au extends Vd{constructor(t){super(),this.elements=t}}function qk(e,t){const r=Yk(t);for(const n of e.elements)r.some(s=>bs(s,n))||r.push(n);return{arrayValue:{values:r}}}class iu extends Vd{constructor(t){super(),this.elements=t}}function Xk(e,t){let r=Yk(t);for(const n of e.elements)r=r.filter(s=>!bs(s,n));return{arrayValue:{values:r}}}class ou extends Vd{constructor(t,r){super(),this.serializer=t,this.Pe=r}}function u_(e){return Wt(e.integerValue||e.doubleValue)}function Yk(e){return hx(e)&&e.arrayValue.values?e.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qk{constructor(t,r){this.field=t,this.transform=r}}function NF(e,t){return e.field.isEqual(t.field)&&function(n,s){return n instanceof au&&s instanceof au||n instanceof iu&&s instanceof iu?ul(n.elements,s.elements,bs):n instanceof ou&&s instanceof ou?bs(n.Pe,s.Pe):n instanceof su&&s instanceof su}(e.transform,t.transform)}class RF{constructor(t,r){this.version=t,this.transformResults=r}}class Bn{constructor(t,r){this.updateTime=t,this.exists=r}static none(){return new Bn}static exists(t){return new Bn(void 0,t)}static updateTime(t){return new Bn(t)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)}}function sh(e,t){return e.updateTime!==void 0?t.isFoundDocument()&&t.version.isEqual(e.updateTime):e.exists===void 0||e.exists===t.isFoundDocument()}class Bd{}function Jk(e,t){if(!e.hasLocalMutations||t&&t.fields.length===0)return null;if(t===null)return e.isNoDocument()?new gx(e.key,Bn.none()):new Du(e.key,e.data,Bn.none());{const r=e.data,n=un.empty();let s=new kr(Er.comparator);for(let a of t.fields)if(!s.has(a)){let i=r.field(a);i===null&&a.length>1&&(a=a.popLast(),i=r.field(a)),i===null?n.delete(a):n.set(a,i),s=s.add(a)}return new vi(e.key,n,new Tn(s.toArray()),Bn.none())}}function bF(e,t,r){e instanceof Du?function(s,a,i){const o=s.value.clone(),l=h_(s.fieldTransforms,a,i.transformResults);o.setAll(l),a.convertToFoundDocument(i.version,o).setHasCommittedMutations()}(e,t,r):e instanceof vi?function(s,a,i){if(!sh(s.precondition,a))return void a.convertToUnknownDocument(i.version);const o=h_(s.fieldTransforms,a,i.transformResults),l=a.data;l.setAll(Zk(s)),l.setAll(o),a.convertToFoundDocument(i.version,l).setHasCommittedMutations()}(e,t,r):function(s,a,i){a.convertToNoDocument(i.version).setHasCommittedMutations()}(0,t,r)}function Ec(e,t,r,n){return e instanceof Du?function(a,i,o,l){if(!sh(a.precondition,i))return o;const c=a.value.clone(),u=d_(a.fieldTransforms,l,i);return c.setAll(u),i.convertToFoundDocument(i.version,c).setHasLocalMutations(),null}(e,t,r,n):e instanceof vi?function(a,i,o,l){if(!sh(a.precondition,i))return o;const c=d_(a.fieldTransforms,l,i),u=i.data;return u.setAll(Zk(a)),u.setAll(c),i.convertToFoundDocument(i.version,u).setHasLocalMutations(),o===null?null:o.unionWith(a.fieldMask.fields).unionWith(a.fieldTransforms.map(d=>d.field))}(e,t,r,n):function(a,i,o){return sh(a.precondition,i)?(i.convertToNoDocument(i.version).setHasLocalMutations(),null):o}(e,t,r)}function PF(e,t){let r=null;for(const n of e.fieldTransforms){const s=t.data.field(n.field),a=Kk(n.transform,s||null);a!=null&&(r===null&&(r=un.empty()),r.set(n.field,a))}return r||null}function f_(e,t){return e.type===t.type&&!!e.key.isEqual(t.key)&&!!e.precondition.isEqual(t.precondition)&&!!function(n,s){return n===void 0&&s===void 0||!(!n||!s)&&ul(n,s,(a,i)=>NF(a,i))}(e.fieldTransforms,t.fieldTransforms)&&(e.type===0?e.value.isEqual(t.value):e.type!==1||e.data.isEqual(t.data)&&e.fieldMask.isEqual(t.fieldMask))}class Du extends Bd{constructor(t,r,n,s=[]){super(),this.key=t,this.value=r,this.precondition=n,this.fieldTransforms=s,this.type=0}getFieldMask(){return null}}class vi extends Bd{constructor(t,r,n,s,a=[]){super(),this.key=t,this.data=r,this.fieldMask=n,this.precondition=s,this.fieldTransforms=a,this.type=1}getFieldMask(){return this.fieldMask}}function Zk(e){const t=new Map;return e.fieldMask.fields.forEach(r=>{if(!r.isEmpty()){const n=e.data.field(r);t.set(r,n)}}),t}function h_(e,t,r){const n=new Map;xt(e.length===r.length);for(let s=0;s<r.length;s++){const a=e[s],i=a.transform,o=t.data.field(a.field);n.set(a.field,CF(i,o,r[s]))}return n}function d_(e,t,r){const n=new Map;for(const s of e){const a=s.transform,i=r.data.field(s.field);n.set(s.field,IF(a,i,t))}return n}class gx extends Bd{constructor(t,r){super(),this.key=t,this.precondition=r,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class DF extends Bd{constructor(t,r){super(),this.key=t,this.precondition=r,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FF{constructor(t,r,n,s){this.batchId=t,this.localWriteTime=r,this.baseMutations=n,this.mutations=s}applyToRemoteDocument(t,r){const n=r.mutationResults;for(let s=0;s<this.mutations.length;s++){const a=this.mutations[s];a.key.isEqual(t.key)&&bF(a,t,n[s])}}applyToLocalView(t,r){for(const n of this.baseMutations)n.key.isEqual(t.key)&&(r=Ec(n,t,r,this.localWriteTime));for(const n of this.mutations)n.key.isEqual(t.key)&&(r=Ec(n,t,r,this.localWriteTime));return r}applyToLocalDocumentSet(t,r){const n=Wk();return this.mutations.forEach(s=>{const a=t.get(s.key),i=a.overlayedDocument;let o=this.applyToLocalView(i,a.mutatedFields);o=r.has(s.key)?null:o;const l=Jk(i,o);l!==null&&n.set(s.key,l),i.isValidDocument()||i.convertToNoDocument(Ve.min())}),n}keys(){return this.mutations.reduce((t,r)=>t.add(r.key),Qe())}isEqual(t){return this.batchId===t.batchId&&ul(this.mutations,t.mutations,(r,n)=>f_(r,n))&&ul(this.baseMutations,t.baseMutations,(r,n)=>f_(r,n))}}class xx{constructor(t,r,n,s){this.batch=t,this.commitVersion=r,this.mutationResults=n,this.docVersions=s}static from(t,r,n){xt(t.mutations.length===n.length);let s=function(){return TF}();const a=t.mutations;for(let i=0;i<a.length;i++)s=s.insert(a[i].key,n[i].version);return new xx(t,r,n,s)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OF{constructor(t,r){this.largestBatchId=t,this.mutation=r}getKey(){return this.mutation.key}isEqual(t){return t!==null&&this.mutation===t.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class MF{constructor(t,r){this.count=t,this.unchangedNames=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Yt,nt;function LF(e){switch(e){default:return Le();case pe.CANCELLED:case pe.UNKNOWN:case pe.DEADLINE_EXCEEDED:case pe.RESOURCE_EXHAUSTED:case pe.INTERNAL:case pe.UNAVAILABLE:case pe.UNAUTHENTICATED:return!1;case pe.INVALID_ARGUMENT:case pe.NOT_FOUND:case pe.ALREADY_EXISTS:case pe.PERMISSION_DENIED:case pe.FAILED_PRECONDITION:case pe.ABORTED:case pe.OUT_OF_RANGE:case pe.UNIMPLEMENTED:case pe.DATA_LOSS:return!0}}function eS(e){if(e===void 0)return va("GRPC error has no .code"),pe.UNKNOWN;switch(e){case Yt.OK:return pe.OK;case Yt.CANCELLED:return pe.CANCELLED;case Yt.UNKNOWN:return pe.UNKNOWN;case Yt.DEADLINE_EXCEEDED:return pe.DEADLINE_EXCEEDED;case Yt.RESOURCE_EXHAUSTED:return pe.RESOURCE_EXHAUSTED;case Yt.INTERNAL:return pe.INTERNAL;case Yt.UNAVAILABLE:return pe.UNAVAILABLE;case Yt.UNAUTHENTICATED:return pe.UNAUTHENTICATED;case Yt.INVALID_ARGUMENT:return pe.INVALID_ARGUMENT;case Yt.NOT_FOUND:return pe.NOT_FOUND;case Yt.ALREADY_EXISTS:return pe.ALREADY_EXISTS;case Yt.PERMISSION_DENIED:return pe.PERMISSION_DENIED;case Yt.FAILED_PRECONDITION:return pe.FAILED_PRECONDITION;case Yt.ABORTED:return pe.ABORTED;case Yt.OUT_OF_RANGE:return pe.OUT_OF_RANGE;case Yt.UNIMPLEMENTED:return pe.UNIMPLEMENTED;case Yt.DATA_LOSS:return pe.DATA_LOSS;default:return Le()}}(nt=Yt||(Yt={}))[nt.OK=0]="OK",nt[nt.CANCELLED=1]="CANCELLED",nt[nt.UNKNOWN=2]="UNKNOWN",nt[nt.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",nt[nt.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",nt[nt.NOT_FOUND=5]="NOT_FOUND",nt[nt.ALREADY_EXISTS=6]="ALREADY_EXISTS",nt[nt.PERMISSION_DENIED=7]="PERMISSION_DENIED",nt[nt.UNAUTHENTICATED=16]="UNAUTHENTICATED",nt[nt.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",nt[nt.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",nt[nt.ABORTED=10]="ABORTED",nt[nt.OUT_OF_RANGE=11]="OUT_OF_RANGE",nt[nt.UNIMPLEMENTED=12]="UNIMPLEMENTED",nt[nt.INTERNAL=13]="INTERNAL",nt[nt.UNAVAILABLE=14]="UNAVAILABLE",nt[nt.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jF(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const UF=new ji([4294967295,4294967295],0);function m_(e){const t=jF().encode(e),r=new Ek;return r.update(t),new Uint8Array(r.digest())}function p_(e){const t=new DataView(e.buffer),r=t.getUint32(0,!0),n=t.getUint32(4,!0),s=t.getUint32(8,!0),a=t.getUint32(12,!0);return[new ji([r,n],0),new ji([s,a],0)]}class vx{constructor(t,r,n){if(this.bitmap=t,this.padding=r,this.hashCount=n,r<0||r>=8)throw new nc(`Invalid padding: ${r}`);if(n<0)throw new nc(`Invalid hash count: ${n}`);if(t.length>0&&this.hashCount===0)throw new nc(`Invalid hash count: ${n}`);if(t.length===0&&r!==0)throw new nc(`Invalid padding when bitmap length is 0: ${r}`);this.Ie=8*t.length-r,this.Te=ji.fromNumber(this.Ie)}Ee(t,r,n){let s=t.add(r.multiply(ji.fromNumber(n)));return s.compare(UF)===1&&(s=new ji([s.getBits(0),s.getBits(1)],0)),s.modulo(this.Te).toNumber()}de(t){return(this.bitmap[Math.floor(t/8)]&1<<t%8)!=0}mightContain(t){if(this.Ie===0)return!1;const r=m_(t),[n,s]=p_(r);for(let a=0;a<this.hashCount;a++){const i=this.Ee(n,s,a);if(!this.de(i))return!1}return!0}static create(t,r,n){const s=t%8==0?0:8-t%8,a=new Uint8Array(Math.ceil(t/8)),i=new vx(a,s,r);return n.forEach(o=>i.insert(o)),i}insert(t){if(this.Ie===0)return;const r=m_(t),[n,s]=p_(r);for(let a=0;a<this.hashCount;a++){const i=this.Ee(n,s,a);this.Ae(i)}}Ae(t){const r=Math.floor(t/8),n=t%8;this.bitmap[r]|=1<<n}}class nc extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zd{constructor(t,r,n,s,a){this.snapshotVersion=t,this.targetChanges=r,this.targetMismatches=n,this.documentUpdates=s,this.resolvedLimboDocuments=a}static createSynthesizedRemoteEventForCurrentChange(t,r,n){const s=new Map;return s.set(t,Fu.createSynthesizedTargetChangeForCurrentChange(t,r,n)),new zd(Ve.min(),s,new Lt(ut),ya(),Qe())}}class Fu{constructor(t,r,n,s,a){this.resumeToken=t,this.current=r,this.addedDocuments=n,this.modifiedDocuments=s,this.removedDocuments=a}static createSynthesizedTargetChangeForCurrentChange(t,r,n){return new Fu(n,r,Qe(),Qe(),Qe())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ah{constructor(t,r,n,s){this.Re=t,this.removedTargetIds=r,this.key=n,this.Ve=s}}class tS{constructor(t,r){this.targetId=t,this.me=r}}class rS{constructor(t,r,n=Cr.EMPTY_BYTE_STRING,s=null){this.state=t,this.targetIds=r,this.resumeToken=n,this.cause=s}}class g_{constructor(){this.fe=0,this.ge=v_(),this.pe=Cr.EMPTY_BYTE_STRING,this.ye=!1,this.we=!0}get current(){return this.ye}get resumeToken(){return this.pe}get Se(){return this.fe!==0}get be(){return this.we}De(t){t.approximateByteSize()>0&&(this.we=!0,this.pe=t)}ve(){let t=Qe(),r=Qe(),n=Qe();return this.ge.forEach((s,a)=>{switch(a){case 0:t=t.add(s);break;case 2:r=r.add(s);break;case 1:n=n.add(s);break;default:Le()}}),new Fu(this.pe,this.ye,t,r,n)}Ce(){this.we=!1,this.ge=v_()}Fe(t,r){this.we=!0,this.ge=this.ge.insert(t,r)}Me(t){this.we=!0,this.ge=this.ge.remove(t)}xe(){this.fe+=1}Oe(){this.fe-=1,xt(this.fe>=0)}Ne(){this.we=!0,this.ye=!0}}class VF{constructor(t){this.Le=t,this.Be=new Map,this.ke=ya(),this.qe=x_(),this.Qe=new Lt(ut)}Ke(t){for(const r of t.Re)t.Ve&&t.Ve.isFoundDocument()?this.$e(r,t.Ve):this.Ue(r,t.key,t.Ve);for(const r of t.removedTargetIds)this.Ue(r,t.key,t.Ve)}We(t){this.forEachTarget(t,r=>{const n=this.Ge(r);switch(t.state){case 0:this.ze(r)&&n.De(t.resumeToken);break;case 1:n.Oe(),n.Se||n.Ce(),n.De(t.resumeToken);break;case 2:n.Oe(),n.Se||this.removeTarget(r);break;case 3:this.ze(r)&&(n.Ne(),n.De(t.resumeToken));break;case 4:this.ze(r)&&(this.je(r),n.De(t.resumeToken));break;default:Le()}})}forEachTarget(t,r){t.targetIds.length>0?t.targetIds.forEach(r):this.Be.forEach((n,s)=>{this.ze(s)&&r(s)})}He(t){const r=t.targetId,n=t.me.count,s=this.Je(r);if(s){const a=s.target;if(yp(a))if(n===0){const i=new Pe(a.path);this.Ue(r,i,Ur.newNoDocument(i,Ve.min()))}else xt(n===1);else{const i=this.Ye(r);if(i!==n){const o=this.Ze(t),l=o?this.Xe(o,t,i):1;if(l!==0){this.je(r);const c=l===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Qe=this.Qe.insert(r,c)}}}}}Ze(t){const r=t.me.unchangedNames;if(!r||!r.bits)return null;const{bits:{bitmap:n="",padding:s=0},hashCount:a=0}=r;let i,o;try{i=Xi(n).toUint8Array()}catch(l){if(l instanceof bk)return cl("Decoding the base64 bloom filter in existence filter failed ("+l.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw l}try{o=new vx(i,s,a)}catch(l){return cl(l instanceof nc?"BloomFilter error: ":"Applying bloom filter failed: ",l),null}return o.Ie===0?null:o}Xe(t,r,n){return r.me.count===n-this.nt(t,r.targetId)?0:2}nt(t,r){const n=this.Le.getRemoteKeysForTarget(r);let s=0;return n.forEach(a=>{const i=this.Le.tt(),o=`projects/${i.projectId}/databases/${i.database}/documents/${a.path.canonicalString()}`;t.mightContain(o)||(this.Ue(r,a,null),s++)}),s}rt(t){const r=new Map;this.Be.forEach((a,i)=>{const o=this.Je(i);if(o){if(a.current&&yp(o.target)){const l=new Pe(o.target.path);this.ke.get(l)!==null||this.it(i,l)||this.Ue(i,l,Ur.newNoDocument(l,t))}a.be&&(r.set(i,a.ve()),a.Ce())}});let n=Qe();this.qe.forEach((a,i)=>{let o=!0;i.forEachWhile(l=>{const c=this.Je(l);return!c||c.purpose==="TargetPurposeLimboResolution"||(o=!1,!1)}),o&&(n=n.add(a))}),this.ke.forEach((a,i)=>i.setReadTime(t));const s=new zd(t,r,this.Qe,this.ke,n);return this.ke=ya(),this.qe=x_(),this.Qe=new Lt(ut),s}$e(t,r){if(!this.ze(t))return;const n=this.it(t,r.key)?2:0;this.Ge(t).Fe(r.key,n),this.ke=this.ke.insert(r.key,r),this.qe=this.qe.insert(r.key,this.st(r.key).add(t))}Ue(t,r,n){if(!this.ze(t))return;const s=this.Ge(t);this.it(t,r)?s.Fe(r,1):s.Me(r),this.qe=this.qe.insert(r,this.st(r).delete(t)),n&&(this.ke=this.ke.insert(r,n))}removeTarget(t){this.Be.delete(t)}Ye(t){const r=this.Ge(t).ve();return this.Le.getRemoteKeysForTarget(t).size+r.addedDocuments.size-r.removedDocuments.size}xe(t){this.Ge(t).xe()}Ge(t){let r=this.Be.get(t);return r||(r=new g_,this.Be.set(t,r)),r}st(t){let r=this.qe.get(t);return r||(r=new kr(ut),this.qe=this.qe.insert(t,r)),r}ze(t){const r=this.Je(t)!==null;return r||be("WatchChangeAggregator","Detected inactive target",t),r}Je(t){const r=this.Be.get(t);return r&&r.Se?null:this.Le.ot(t)}je(t){this.Be.set(t,new g_),this.Le.getRemoteKeysForTarget(t).forEach(r=>{this.Ue(t,r,null)})}it(t,r){return this.Le.getRemoteKeysForTarget(t).has(r)}}function x_(){return new Lt(Pe.comparator)}function v_(){return new Lt(Pe.comparator)}const BF={asc:"ASCENDING",desc:"DESCENDING"},zF={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},$F={and:"AND",or:"OR"};class WF{constructor(t,r){this.databaseId=t,this.useProto3Json=r}}function Ep(e,t){return e.useProto3Json||Md(t)?t:{value:t}}function Kh(e,t){return e.useProto3Json?`${new Date(1e3*t.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+t.nanoseconds).slice(-9)}Z`:{seconds:""+t.seconds,nanos:t.nanoseconds}}function nS(e,t){return e.useProto3Json?t.toBase64():t.toUint8Array()}function HF(e,t){return Kh(e,t.toTimestamp())}function Cs(e){return xt(!!e),Ve.fromTimestamp(function(r){const n=ci(r);return new or(n.seconds,n.nanos)}(e))}function yx(e,t){return Tp(e,t).canonicalString()}function Tp(e,t){const r=function(s){return new Ct(["projects",s.projectId,"databases",s.database])}(e).child("documents");return t===void 0?r:r.child(t)}function sS(e){const t=Ct.fromString(e);return xt(cS(t)),t}function kp(e,t){return yx(e.databaseId,t.path)}function q0(e,t){const r=sS(t);if(r.get(1)!==e.databaseId.projectId)throw new Re(pe.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+r.get(1)+" vs "+e.databaseId.projectId);if(r.get(3)!==e.databaseId.database)throw new Re(pe.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+r.get(3)+" vs "+e.databaseId.database);return new Pe(iS(r))}function aS(e,t){return yx(e.databaseId,t)}function GF(e){const t=sS(e);return t.length===4?Ct.emptyPath():iS(t)}function Sp(e){return new Ct(["projects",e.databaseId.projectId,"databases",e.databaseId.database]).canonicalString()}function iS(e){return xt(e.length>4&&e.get(4)==="documents"),e.popFirst(5)}function y_(e,t,r){return{name:kp(e,t),fields:r.value.mapValue.fields}}function KF(e,t){let r;if("targetChange"in t){t.targetChange;const n=function(c){return c==="NO_CHANGE"?0:c==="ADD"?1:c==="REMOVE"?2:c==="CURRENT"?3:c==="RESET"?4:Le()}(t.targetChange.targetChangeType||"NO_CHANGE"),s=t.targetChange.targetIds||[],a=function(c,u){return c.useProto3Json?(xt(u===void 0||typeof u=="string"),Cr.fromBase64String(u||"")):(xt(u===void 0||u instanceof Buffer||u instanceof Uint8Array),Cr.fromUint8Array(u||new Uint8Array))}(e,t.targetChange.resumeToken),i=t.targetChange.cause,o=i&&function(c){const u=c.code===void 0?pe.UNKNOWN:eS(c.code);return new Re(u,c.message||"")}(i);r=new rS(n,s,a,o||null)}else if("documentChange"in t){t.documentChange;const n=t.documentChange;n.document,n.document.name,n.document.updateTime;const s=q0(e,n.document.name),a=Cs(n.document.updateTime),i=n.document.createTime?Cs(n.document.createTime):Ve.min(),o=new un({mapValue:{fields:n.document.fields}}),l=Ur.newFoundDocument(s,a,i,o),c=n.targetIds||[],u=n.removedTargetIds||[];r=new ah(c,u,l.key,l)}else if("documentDelete"in t){t.documentDelete;const n=t.documentDelete;n.document;const s=q0(e,n.document),a=n.readTime?Cs(n.readTime):Ve.min(),i=Ur.newNoDocument(s,a),o=n.removedTargetIds||[];r=new ah([],o,i.key,i)}else if("documentRemove"in t){t.documentRemove;const n=t.documentRemove;n.document;const s=q0(e,n.document),a=n.removedTargetIds||[];r=new ah([],a,s,null)}else{if(!("filter"in t))return Le();{t.filter;const n=t.filter;n.targetId;const{count:s=0,unchangedNames:a}=n,i=new MF(s,a),o=n.targetId;r=new tS(o,i)}}return r}function qF(e,t){let r;if(t instanceof Du)r={update:y_(e,t.key,t.value)};else if(t instanceof gx)r={delete:kp(e,t.key)};else if(t instanceof vi)r={update:y_(e,t.key,t.data),updateMask:nO(t.fieldMask)};else{if(!(t instanceof DF))return Le();r={verify:kp(e,t.key)}}return t.fieldTransforms.length>0&&(r.updateTransforms=t.fieldTransforms.map(n=>function(a,i){const o=i.transform;if(o instanceof su)return{fieldPath:i.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(o instanceof au)return{fieldPath:i.field.canonicalString(),appendMissingElements:{values:o.elements}};if(o instanceof iu)return{fieldPath:i.field.canonicalString(),removeAllFromArray:{values:o.elements}};if(o instanceof ou)return{fieldPath:i.field.canonicalString(),increment:o.Pe};throw Le()}(0,n))),t.precondition.isNone||(r.currentDocument=function(s,a){return a.updateTime!==void 0?{updateTime:HF(s,a.updateTime)}:a.exists!==void 0?{exists:a.exists}:Le()}(e,t.precondition)),r}function XF(e,t){return e&&e.length>0?(xt(t!==void 0),e.map(r=>function(s,a){let i=s.updateTime?Cs(s.updateTime):Cs(a);return i.isEqual(Ve.min())&&(i=Cs(a)),new RF(i,s.transformResults||[])}(r,t))):[]}function YF(e,t){return{documents:[aS(e,t.path)]}}function QF(e,t){const r={structuredQuery:{}},n=t.path;let s;t.collectionGroup!==null?(s=n,r.structuredQuery.from=[{collectionId:t.collectionGroup,allDescendants:!0}]):(s=n.popLast(),r.structuredQuery.from=[{collectionId:n.lastSegment()}]),r.parent=aS(e,s);const a=function(c){if(c.length!==0)return lS(ds.create(c,"and"))}(t.filters);a&&(r.structuredQuery.where=a);const i=function(c){if(c.length!==0)return c.map(u=>function(m){return{field:To(m.field),direction:eO(m.dir)}}(u))}(t.orderBy);i&&(r.structuredQuery.orderBy=i);const o=Ep(e,t.limit);return o!==null&&(r.structuredQuery.limit=o),t.startAt&&(r.structuredQuery.startAt=function(c){return{before:c.inclusive,values:c.position}}(t.startAt)),t.endAt&&(r.structuredQuery.endAt=function(c){return{before:!c.inclusive,values:c.position}}(t.endAt)),{_t:r,parent:s}}function JF(e){let t=GF(e.parent);const r=e.structuredQuery,n=r.from?r.from.length:0;let s=null;if(n>0){xt(n===1);const u=r.from[0];u.allDescendants?s=u.collectionId:t=t.child(u.collectionId)}let a=[];r.where&&(a=function(d){const m=oS(d);return m instanceof ds&&Ok(m)?m.getFilters():[m]}(r.where));let i=[];r.orderBy&&(i=function(d){return d.map(m=>function(x){return new Gh(ko(x.field),function(_){switch(_){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(x.direction))}(m))}(r.orderBy));let o=null;r.limit&&(o=function(d){let m;return m=typeof d=="object"?d.value:d,Md(m)?null:m}(r.limit));let l=null;r.startAt&&(l=function(d){const m=!!d.before,p=d.values||[];return new Hh(p,m)}(r.startAt));let c=null;return r.endAt&&(c=function(d){const m=!d.before,p=d.values||[];return new Hh(p,m)}(r.endAt)),vF(t,s,i,a,o,"F",l,c)}function ZF(e,t){const r=function(s){switch(s){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return Le()}}(t.purpose);return r==null?null:{"goog-listen-tags":r}}function oS(e){return e.unaryFilter!==void 0?function(r){switch(r.unaryFilter.op){case"IS_NAN":const n=ko(r.unaryFilter.field);return tr.create(n,"==",{doubleValue:NaN});case"IS_NULL":const s=ko(r.unaryFilter.field);return tr.create(s,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const a=ko(r.unaryFilter.field);return tr.create(a,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const i=ko(r.unaryFilter.field);return tr.create(i,"!=",{nullValue:"NULL_VALUE"});default:return Le()}}(e):e.fieldFilter!==void 0?function(r){return tr.create(ko(r.fieldFilter.field),function(s){switch(s){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return Le()}}(r.fieldFilter.op),r.fieldFilter.value)}(e):e.compositeFilter!==void 0?function(r){return ds.create(r.compositeFilter.filters.map(n=>oS(n)),function(s){switch(s){case"AND":return"and";case"OR":return"or";default:return Le()}}(r.compositeFilter.op))}(e):Le()}function eO(e){return BF[e]}function tO(e){return zF[e]}function rO(e){return $F[e]}function To(e){return{fieldPath:e.canonicalString()}}function ko(e){return Er.fromServerFormat(e.fieldPath)}function lS(e){return e instanceof tr?function(r){if(r.op==="=="){if(a_(r.value))return{unaryFilter:{field:To(r.field),op:"IS_NAN"}};if(s_(r.value))return{unaryFilter:{field:To(r.field),op:"IS_NULL"}}}else if(r.op==="!="){if(a_(r.value))return{unaryFilter:{field:To(r.field),op:"IS_NOT_NAN"}};if(s_(r.value))return{unaryFilter:{field:To(r.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:To(r.field),op:tO(r.op),value:r.value}}}(e):e instanceof ds?function(r){const n=r.getFilters().map(s=>lS(s));return n.length===1?n[0]:{compositeFilter:{op:rO(r.op),filters:n}}}(e):Le()}function nO(e){const t=[];return e.fields.forEach(r=>t.push(r.canonicalString())),{fieldPaths:t}}function cS(e){return e.length>=4&&e.get(0)==="projects"&&e.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wa{constructor(t,r,n,s,a=Ve.min(),i=Ve.min(),o=Cr.EMPTY_BYTE_STRING,l=null){this.target=t,this.targetId=r,this.purpose=n,this.sequenceNumber=s,this.snapshotVersion=a,this.lastLimboFreeSnapshotVersion=i,this.resumeToken=o,this.expectedCount=l}withSequenceNumber(t){return new Wa(this.target,this.targetId,this.purpose,t,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(t,r){return new Wa(this.target,this.targetId,this.purpose,this.sequenceNumber,r,this.lastLimboFreeSnapshotVersion,t,null)}withExpectedCount(t){return new Wa(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,t)}withLastLimboFreeSnapshotVersion(t){return new Wa(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,t,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sO{constructor(t){this.ct=t}}function aO(e){const t=JF({parent:e.parent,structuredQuery:e.structuredQuery});return e.limitType==="LAST"?wp(t,t.limit,"L"):t}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iO{constructor(){this.un=new oO}addToCollectionParentIndex(t,r){return this.un.add(r),ye.resolve()}getCollectionParents(t,r){return ye.resolve(this.un.getEntries(r))}addFieldIndex(t,r){return ye.resolve()}deleteFieldIndex(t,r){return ye.resolve()}deleteAllFieldIndexes(t){return ye.resolve()}createTargetIndexes(t,r){return ye.resolve()}getDocumentsMatchingTarget(t,r){return ye.resolve(null)}getIndexType(t,r){return ye.resolve(0)}getFieldIndexes(t,r){return ye.resolve([])}getNextCollectionGroupToUpdate(t){return ye.resolve(null)}getMinOffset(t,r){return ye.resolve(li.min())}getMinOffsetFromCollectionGroup(t,r){return ye.resolve(li.min())}updateCollectionGroup(t,r,n){return ye.resolve()}updateIndexEntries(t,r){return ye.resolve()}}class oO{constructor(){this.index={}}add(t){const r=t.lastSegment(),n=t.popLast(),s=this.index[r]||new kr(Ct.comparator),a=!s.has(n);return this.index[r]=s.add(n),a}has(t){const r=t.lastSegment(),n=t.popLast(),s=this.index[r];return s&&s.has(n)}getEntries(t){return(this.index[t]||new kr(Ct.comparator)).toArray()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dl{constructor(t){this.Ln=t}next(){return this.Ln+=2,this.Ln}static Bn(){return new dl(0)}static kn(){return new dl(-1)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lO{constructor(){this.changes=new kl(t=>t.toString(),(t,r)=>t.isEqual(r)),this.changesApplied=!1}addEntry(t){this.assertNotApplied(),this.changes.set(t.key,t)}removeEntry(t,r){this.assertNotApplied(),this.changes.set(t,Ur.newInvalidDocument(t).setReadTime(r))}getEntry(t,r){this.assertNotApplied();const n=this.changes.get(r);return n!==void 0?ye.resolve(n):this.getFromCache(t,r)}getEntries(t,r){return this.getAllFromCache(t,r)}apply(t){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(t)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cO{constructor(t,r){this.overlayedDocument=t,this.mutatedFields=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uO{constructor(t,r,n,s){this.remoteDocumentCache=t,this.mutationQueue=r,this.documentOverlayCache=n,this.indexManager=s}getDocument(t,r){let n=null;return this.documentOverlayCache.getOverlay(t,r).next(s=>(n=s,this.remoteDocumentCache.getEntry(t,r))).next(s=>(n!==null&&Ec(n.mutation,s,Tn.empty(),or.now()),s))}getDocuments(t,r){return this.remoteDocumentCache.getEntries(t,r).next(n=>this.getLocalViewOfDocuments(t,n,Qe()).next(()=>n))}getLocalViewOfDocuments(t,r,n=Qe()){const s=Di();return this.populateOverlays(t,s,r).next(()=>this.computeViews(t,r,s,n).next(a=>{let i=rc();return a.forEach((o,l)=>{i=i.insert(o,l.overlayedDocument)}),i}))}getOverlayedDocuments(t,r){const n=Di();return this.populateOverlays(t,n,r).next(()=>this.computeViews(t,r,n,Qe()))}populateOverlays(t,r,n){const s=[];return n.forEach(a=>{r.has(a)||s.push(a)}),this.documentOverlayCache.getOverlays(t,s).next(a=>{a.forEach((i,o)=>{r.set(i,o)})})}computeViews(t,r,n,s){let a=ya();const i=wc(),o=function(){return wc()}();return r.forEach((l,c)=>{const u=n.get(c.key);s.has(c.key)&&(u===void 0||u.mutation instanceof vi)?a=a.insert(c.key,c):u!==void 0?(i.set(c.key,u.mutation.getFieldMask()),Ec(u.mutation,c,u.mutation.getFieldMask(),or.now())):i.set(c.key,Tn.empty())}),this.recalculateAndSaveOverlays(t,a).next(l=>(l.forEach((c,u)=>i.set(c,u)),r.forEach((c,u)=>{var d;return o.set(c,new cO(u,(d=i.get(c))!==null&&d!==void 0?d:null))}),o))}recalculateAndSaveOverlays(t,r){const n=wc();let s=new Lt((i,o)=>i-o),a=Qe();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(t,r).next(i=>{for(const o of i)o.keys().forEach(l=>{const c=r.get(l);if(c===null)return;let u=n.get(l)||Tn.empty();u=o.applyToLocalView(c,u),n.set(l,u);const d=(s.get(o.batchId)||Qe()).add(l);s=s.insert(o.batchId,d)})}).next(()=>{const i=[],o=s.getReverseIterator();for(;o.hasNext();){const l=o.getNext(),c=l.key,u=l.value,d=Wk();u.forEach(m=>{if(!a.has(m)){const p=Jk(r.get(m),n.get(m));p!==null&&d.set(m,p),a=a.add(m)}}),i.push(this.documentOverlayCache.saveOverlays(t,c,d))}return ye.waitFor(i)}).next(()=>n)}recalculateAndSaveOverlaysForDocumentKeys(t,r){return this.remoteDocumentCache.getEntries(t,r).next(n=>this.recalculateAndSaveOverlays(t,n))}getDocumentsMatchingQuery(t,r,n,s){return function(i){return Pe.isDocumentKey(i.path)&&i.collectionGroup===null&&i.filters.length===0}(r)?this.getDocumentsMatchingDocumentQuery(t,r.path):Uk(r)?this.getDocumentsMatchingCollectionGroupQuery(t,r,n,s):this.getDocumentsMatchingCollectionQuery(t,r,n,s)}getNextDocuments(t,r,n,s){return this.remoteDocumentCache.getAllFromCollectionGroup(t,r,n,s).next(a=>{const i=s-a.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(t,r,n.largestBatchId,s-a.size):ye.resolve(Di());let o=-1,l=a;return i.next(c=>ye.forEach(c,(u,d)=>(o<d.largestBatchId&&(o=d.largestBatchId),a.get(u)?ye.resolve():this.remoteDocumentCache.getEntry(t,u).next(m=>{l=l.insert(u,m)}))).next(()=>this.populateOverlays(t,c,a)).next(()=>this.computeViews(t,l,c,Qe())).next(u=>({batchId:o,changes:$k(u)})))})}getDocumentsMatchingDocumentQuery(t,r){return this.getDocument(t,new Pe(r)).next(n=>{let s=rc();return n.isFoundDocument()&&(s=s.insert(n.key,n)),s})}getDocumentsMatchingCollectionGroupQuery(t,r,n,s){const a=r.collectionGroup;let i=rc();return this.indexManager.getCollectionParents(t,a).next(o=>ye.forEach(o,l=>{const c=function(d,m){return new Pu(m,null,d.explicitOrderBy.slice(),d.filters.slice(),d.limit,d.limitType,d.startAt,d.endAt)}(r,l.child(a));return this.getDocumentsMatchingCollectionQuery(t,c,n,s).next(u=>{u.forEach((d,m)=>{i=i.insert(d,m)})})}).next(()=>i))}getDocumentsMatchingCollectionQuery(t,r,n,s){let a;return this.documentOverlayCache.getOverlaysForCollection(t,r.path,n.largestBatchId).next(i=>(a=i,this.remoteDocumentCache.getDocumentsMatchingQuery(t,r,n,a,s))).next(i=>{a.forEach((l,c)=>{const u=c.getKey();i.get(u)===null&&(i=i.insert(u,Ur.newInvalidDocument(u)))});let o=rc();return i.forEach((l,c)=>{const u=a.get(l);u!==void 0&&Ec(u.mutation,c,Tn.empty(),or.now()),Ud(r,c)&&(o=o.insert(l,c))}),o})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fO{constructor(t){this.serializer=t,this.hr=new Map,this.Pr=new Map}getBundleMetadata(t,r){return ye.resolve(this.hr.get(r))}saveBundleMetadata(t,r){return this.hr.set(r.id,function(s){return{id:s.id,version:s.version,createTime:Cs(s.createTime)}}(r)),ye.resolve()}getNamedQuery(t,r){return ye.resolve(this.Pr.get(r))}saveNamedQuery(t,r){return this.Pr.set(r.name,function(s){return{name:s.name,query:aO(s.bundledQuery),readTime:Cs(s.readTime)}}(r)),ye.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hO{constructor(){this.overlays=new Lt(Pe.comparator),this.Ir=new Map}getOverlay(t,r){return ye.resolve(this.overlays.get(r))}getOverlays(t,r){const n=Di();return ye.forEach(r,s=>this.getOverlay(t,s).next(a=>{a!==null&&n.set(s,a)})).next(()=>n)}saveOverlays(t,r,n){return n.forEach((s,a)=>{this.ht(t,r,a)}),ye.resolve()}removeOverlaysForBatchId(t,r,n){const s=this.Ir.get(n);return s!==void 0&&(s.forEach(a=>this.overlays=this.overlays.remove(a)),this.Ir.delete(n)),ye.resolve()}getOverlaysForCollection(t,r,n){const s=Di(),a=r.length+1,i=new Pe(r.child("")),o=this.overlays.getIteratorFrom(i);for(;o.hasNext();){const l=o.getNext().value,c=l.getKey();if(!r.isPrefixOf(c.path))break;c.path.length===a&&l.largestBatchId>n&&s.set(l.getKey(),l)}return ye.resolve(s)}getOverlaysForCollectionGroup(t,r,n,s){let a=new Lt((c,u)=>c-u);const i=this.overlays.getIterator();for(;i.hasNext();){const c=i.getNext().value;if(c.getKey().getCollectionGroup()===r&&c.largestBatchId>n){let u=a.get(c.largestBatchId);u===null&&(u=Di(),a=a.insert(c.largestBatchId,u)),u.set(c.getKey(),c)}}const o=Di(),l=a.getIterator();for(;l.hasNext()&&(l.getNext().value.forEach((c,u)=>o.set(c,u)),!(o.size()>=s)););return ye.resolve(o)}ht(t,r,n){const s=this.overlays.get(n.key);if(s!==null){const i=this.Ir.get(s.largestBatchId).delete(n.key);this.Ir.set(s.largestBatchId,i)}this.overlays=this.overlays.insert(n.key,new OF(r,n));let a=this.Ir.get(r);a===void 0&&(a=Qe(),this.Ir.set(r,a)),this.Ir.set(r,a.add(n.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dO{constructor(){this.sessionToken=Cr.EMPTY_BYTE_STRING}getSessionToken(t){return ye.resolve(this.sessionToken)}setSessionToken(t,r){return this.sessionToken=r,ye.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _x{constructor(){this.Tr=new kr(hr.Er),this.dr=new kr(hr.Ar)}isEmpty(){return this.Tr.isEmpty()}addReference(t,r){const n=new hr(t,r);this.Tr=this.Tr.add(n),this.dr=this.dr.add(n)}Rr(t,r){t.forEach(n=>this.addReference(n,r))}removeReference(t,r){this.Vr(new hr(t,r))}mr(t,r){t.forEach(n=>this.removeReference(n,r))}gr(t){const r=new Pe(new Ct([])),n=new hr(r,t),s=new hr(r,t+1),a=[];return this.dr.forEachInRange([n,s],i=>{this.Vr(i),a.push(i.key)}),a}pr(){this.Tr.forEach(t=>this.Vr(t))}Vr(t){this.Tr=this.Tr.delete(t),this.dr=this.dr.delete(t)}yr(t){const r=new Pe(new Ct([])),n=new hr(r,t),s=new hr(r,t+1);let a=Qe();return this.dr.forEachInRange([n,s],i=>{a=a.add(i.key)}),a}containsKey(t){const r=new hr(t,0),n=this.Tr.firstAfterOrEqual(r);return n!==null&&t.isEqual(n.key)}}class hr{constructor(t,r){this.key=t,this.wr=r}static Er(t,r){return Pe.comparator(t.key,r.key)||ut(t.wr,r.wr)}static Ar(t,r){return ut(t.wr,r.wr)||Pe.comparator(t.key,r.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mO{constructor(t,r){this.indexManager=t,this.referenceDelegate=r,this.mutationQueue=[],this.Sr=1,this.br=new kr(hr.Er)}checkEmpty(t){return ye.resolve(this.mutationQueue.length===0)}addMutationBatch(t,r,n,s){const a=this.Sr;this.Sr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const i=new FF(a,r,n,s);this.mutationQueue.push(i);for(const o of s)this.br=this.br.add(new hr(o.key,a)),this.indexManager.addToCollectionParentIndex(t,o.key.path.popLast());return ye.resolve(i)}lookupMutationBatch(t,r){return ye.resolve(this.Dr(r))}getNextMutationBatchAfterBatchId(t,r){const n=r+1,s=this.vr(n),a=s<0?0:s;return ye.resolve(this.mutationQueue.length>a?this.mutationQueue[a]:null)}getHighestUnacknowledgedBatchId(){return ye.resolve(this.mutationQueue.length===0?-1:this.Sr-1)}getAllMutationBatches(t){return ye.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(t,r){const n=new hr(r,0),s=new hr(r,Number.POSITIVE_INFINITY),a=[];return this.br.forEachInRange([n,s],i=>{const o=this.Dr(i.wr);a.push(o)}),ye.resolve(a)}getAllMutationBatchesAffectingDocumentKeys(t,r){let n=new kr(ut);return r.forEach(s=>{const a=new hr(s,0),i=new hr(s,Number.POSITIVE_INFINITY);this.br.forEachInRange([a,i],o=>{n=n.add(o.wr)})}),ye.resolve(this.Cr(n))}getAllMutationBatchesAffectingQuery(t,r){const n=r.path,s=n.length+1;let a=n;Pe.isDocumentKey(a)||(a=a.child(""));const i=new hr(new Pe(a),0);let o=new kr(ut);return this.br.forEachWhile(l=>{const c=l.key.path;return!!n.isPrefixOf(c)&&(c.length===s&&(o=o.add(l.wr)),!0)},i),ye.resolve(this.Cr(o))}Cr(t){const r=[];return t.forEach(n=>{const s=this.Dr(n);s!==null&&r.push(s)}),r}removeMutationBatch(t,r){xt(this.Fr(r.batchId,"removed")===0),this.mutationQueue.shift();let n=this.br;return ye.forEach(r.mutations,s=>{const a=new hr(s.key,r.batchId);return n=n.delete(a),this.referenceDelegate.markPotentiallyOrphaned(t,s.key)}).next(()=>{this.br=n})}On(t){}containsKey(t,r){const n=new hr(r,0),s=this.br.firstAfterOrEqual(n);return ye.resolve(r.isEqual(s&&s.key))}performConsistencyCheck(t){return this.mutationQueue.length,ye.resolve()}Fr(t,r){return this.vr(t)}vr(t){return this.mutationQueue.length===0?0:t-this.mutationQueue[0].batchId}Dr(t){const r=this.vr(t);return r<0||r>=this.mutationQueue.length?null:this.mutationQueue[r]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pO{constructor(t){this.Mr=t,this.docs=function(){return new Lt(Pe.comparator)}(),this.size=0}setIndexManager(t){this.indexManager=t}addEntry(t,r){const n=r.key,s=this.docs.get(n),a=s?s.size:0,i=this.Mr(r);return this.docs=this.docs.insert(n,{document:r.mutableCopy(),size:i}),this.size+=i-a,this.indexManager.addToCollectionParentIndex(t,n.path.popLast())}removeEntry(t){const r=this.docs.get(t);r&&(this.docs=this.docs.remove(t),this.size-=r.size)}getEntry(t,r){const n=this.docs.get(r);return ye.resolve(n?n.document.mutableCopy():Ur.newInvalidDocument(r))}getEntries(t,r){let n=ya();return r.forEach(s=>{const a=this.docs.get(s);n=n.insert(s,a?a.document.mutableCopy():Ur.newInvalidDocument(s))}),ye.resolve(n)}getDocumentsMatchingQuery(t,r,n,s){let a=ya();const i=r.path,o=new Pe(i.child("")),l=this.docs.getIteratorFrom(o);for(;l.hasNext();){const{key:c,value:{document:u}}=l.getNext();if(!i.isPrefixOf(c.path))break;c.path.length>i.length+1||Z3(J3(u),n)<=0||(s.has(u.key)||Ud(r,u))&&(a=a.insert(u.key,u.mutableCopy()))}return ye.resolve(a)}getAllFromCollectionGroup(t,r,n,s){Le()}Or(t,r){return ye.forEach(this.docs,n=>r(n))}newChangeBuffer(t){return new gO(this)}getSize(t){return ye.resolve(this.size)}}class gO extends lO{constructor(t){super(),this.cr=t}applyChanges(t){const r=[];return this.changes.forEach((n,s)=>{s.isValidDocument()?r.push(this.cr.addEntry(t,s)):this.cr.removeEntry(n)}),ye.waitFor(r)}getFromCache(t,r){return this.cr.getEntry(t,r)}getAllFromCache(t,r){return this.cr.getEntries(t,r)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xO{constructor(t){this.persistence=t,this.Nr=new kl(r=>dx(r),mx),this.lastRemoteSnapshotVersion=Ve.min(),this.highestTargetId=0,this.Lr=0,this.Br=new _x,this.targetCount=0,this.kr=dl.Bn()}forEachTarget(t,r){return this.Nr.forEach((n,s)=>r(s)),ye.resolve()}getLastRemoteSnapshotVersion(t){return ye.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(t){return ye.resolve(this.Lr)}allocateTargetId(t){return this.highestTargetId=this.kr.next(),ye.resolve(this.highestTargetId)}setTargetsMetadata(t,r,n){return n&&(this.lastRemoteSnapshotVersion=n),r>this.Lr&&(this.Lr=r),ye.resolve()}Kn(t){this.Nr.set(t.target,t);const r=t.targetId;r>this.highestTargetId&&(this.kr=new dl(r),this.highestTargetId=r),t.sequenceNumber>this.Lr&&(this.Lr=t.sequenceNumber)}addTargetData(t,r){return this.Kn(r),this.targetCount+=1,ye.resolve()}updateTargetData(t,r){return this.Kn(r),ye.resolve()}removeTargetData(t,r){return this.Nr.delete(r.target),this.Br.gr(r.targetId),this.targetCount-=1,ye.resolve()}removeTargets(t,r,n){let s=0;const a=[];return this.Nr.forEach((i,o)=>{o.sequenceNumber<=r&&n.get(o.targetId)===null&&(this.Nr.delete(i),a.push(this.removeMatchingKeysForTargetId(t,o.targetId)),s++)}),ye.waitFor(a).next(()=>s)}getTargetCount(t){return ye.resolve(this.targetCount)}getTargetData(t,r){const n=this.Nr.get(r)||null;return ye.resolve(n)}addMatchingKeys(t,r,n){return this.Br.Rr(r,n),ye.resolve()}removeMatchingKeys(t,r,n){this.Br.mr(r,n);const s=this.persistence.referenceDelegate,a=[];return s&&r.forEach(i=>{a.push(s.markPotentiallyOrphaned(t,i))}),ye.waitFor(a)}removeMatchingKeysForTargetId(t,r){return this.Br.gr(r),ye.resolve()}getMatchingKeysForTargetId(t,r){const n=this.Br.yr(r);return ye.resolve(n)}containsKey(t,r){return ye.resolve(this.Br.containsKey(r))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vO{constructor(t,r){this.qr={},this.overlays={},this.Qr=new cx(0),this.Kr=!1,this.Kr=!0,this.$r=new dO,this.referenceDelegate=t(this),this.Ur=new xO(this),this.indexManager=new iO,this.remoteDocumentCache=function(s){return new pO(s)}(n=>this.referenceDelegate.Wr(n)),this.serializer=new sO(r),this.Gr=new fO(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.Kr=!1,Promise.resolve()}get started(){return this.Kr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(t){return this.indexManager}getDocumentOverlayCache(t){let r=this.overlays[t.toKey()];return r||(r=new hO,this.overlays[t.toKey()]=r),r}getMutationQueue(t,r){let n=this.qr[t.toKey()];return n||(n=new mO(r,this.referenceDelegate),this.qr[t.toKey()]=n),n}getGlobalsCache(){return this.$r}getTargetCache(){return this.Ur}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Gr}runTransaction(t,r,n){be("MemoryPersistence","Starting transaction:",t);const s=new yO(this.Qr.next());return this.referenceDelegate.zr(),n(s).next(a=>this.referenceDelegate.jr(s).next(()=>a)).toPromise().then(a=>(s.raiseOnCommittedEvent(),a))}Hr(t,r){return ye.or(Object.values(this.qr).map(n=>()=>n.containsKey(t,r)))}}class yO extends tF{constructor(t){super(),this.currentSequenceNumber=t}}class wx{constructor(t){this.persistence=t,this.Jr=new _x,this.Yr=null}static Zr(t){return new wx(t)}get Xr(){if(this.Yr)return this.Yr;throw Le()}addReference(t,r,n){return this.Jr.addReference(n,r),this.Xr.delete(n.toString()),ye.resolve()}removeReference(t,r,n){return this.Jr.removeReference(n,r),this.Xr.add(n.toString()),ye.resolve()}markPotentiallyOrphaned(t,r){return this.Xr.add(r.toString()),ye.resolve()}removeTarget(t,r){this.Jr.gr(r.targetId).forEach(s=>this.Xr.add(s.toString()));const n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(t,r.targetId).next(s=>{s.forEach(a=>this.Xr.add(a.toString()))}).next(()=>n.removeTargetData(t,r))}zr(){this.Yr=new Set}jr(t){const r=this.persistence.getRemoteDocumentCache().newChangeBuffer();return ye.forEach(this.Xr,n=>{const s=Pe.fromPath(n);return this.ei(t,s).next(a=>{a||r.removeEntry(s,Ve.min())})}).next(()=>(this.Yr=null,r.apply(t)))}updateLimboDocument(t,r){return this.ei(t,r).next(n=>{n?this.Xr.delete(r.toString()):this.Xr.add(r.toString())})}Wr(t){return 0}ei(t,r){return ye.or([()=>ye.resolve(this.Jr.containsKey(r)),()=>this.persistence.getTargetCache().containsKey(t,r),()=>this.persistence.Hr(t,r)])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ex{constructor(t,r,n,s){this.targetId=t,this.fromCache=r,this.$i=n,this.Ui=s}static Wi(t,r){let n=Qe(),s=Qe();for(const a of r.docChanges)switch(a.type){case 0:n=n.add(a.doc.key);break;case 1:s=s.add(a.doc.key)}return new Ex(t,r.fromCache,n,s)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _O{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(t){this._documentReadCount+=t}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wO{constructor(){this.Gi=!1,this.zi=!1,this.ji=100,this.Hi=function(){return Cb()?8:rF(Hr())>0?6:4}()}initialize(t,r){this.Ji=t,this.indexManager=r,this.Gi=!0}getDocumentsMatchingQuery(t,r,n,s){const a={result:null};return this.Yi(t,r).next(i=>{a.result=i}).next(()=>{if(!a.result)return this.Zi(t,r,s,n).next(i=>{a.result=i})}).next(()=>{if(a.result)return;const i=new _O;return this.Xi(t,r,i).next(o=>{if(a.result=o,this.zi)return this.es(t,r,i,o.size)})}).next(()=>a.result)}es(t,r,n,s){return n.documentReadCount<this.ji?(Xl()<=Ze.DEBUG&&be("QueryEngine","SDK will not create cache indexes for query:",Eo(r),"since it only creates cache indexes for collection contains","more than or equal to",this.ji,"documents"),ye.resolve()):(Xl()<=Ze.DEBUG&&be("QueryEngine","Query:",Eo(r),"scans",n.documentReadCount,"local documents and returns",s,"documents as results."),n.documentReadCount>this.Hi*s?(Xl()<=Ze.DEBUG&&be("QueryEngine","The SDK decides to create cache indexes for query:",Eo(r),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(t,Is(r))):ye.resolve())}Yi(t,r){if(c_(r))return ye.resolve(null);let n=Is(r);return this.indexManager.getIndexType(t,n).next(s=>s===0?null:(r.limit!==null&&s===1&&(r=wp(r,null,"F"),n=Is(r)),this.indexManager.getDocumentsMatchingTarget(t,n).next(a=>{const i=Qe(...a);return this.Ji.getDocuments(t,i).next(o=>this.indexManager.getMinOffset(t,n).next(l=>{const c=this.ts(r,o);return this.ns(r,c,i,l.readTime)?this.Yi(t,wp(r,null,"F")):this.rs(t,c,r,l)}))})))}Zi(t,r,n,s){return c_(r)||s.isEqual(Ve.min())?ye.resolve(null):this.Ji.getDocuments(t,n).next(a=>{const i=this.ts(r,a);return this.ns(r,i,n,s)?ye.resolve(null):(Xl()<=Ze.DEBUG&&be("QueryEngine","Re-using previous result from %s to execute query: %s",s.toString(),Eo(r)),this.rs(t,i,r,Q3(s,-1)).next(o=>o))})}ts(t,r){let n=new kr(Bk(t));return r.forEach((s,a)=>{Ud(t,a)&&(n=n.add(a))}),n}ns(t,r,n,s){if(t.limit===null)return!1;if(n.size!==r.size)return!0;const a=t.limitType==="F"?r.last():r.first();return!!a&&(a.hasPendingWrites||a.version.compareTo(s)>0)}Xi(t,r,n){return Xl()<=Ze.DEBUG&&be("QueryEngine","Using full collection scan to execute query:",Eo(r)),this.Ji.getDocumentsMatchingQuery(t,r,li.min(),n)}rs(t,r,n,s){return this.Ji.getDocumentsMatchingQuery(t,n,s).next(a=>(r.forEach(i=>{a=a.insert(i.key,i)}),a))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class EO{constructor(t,r,n,s){this.persistence=t,this.ss=r,this.serializer=s,this.os=new Lt(ut),this._s=new kl(a=>dx(a),mx),this.us=new Map,this.cs=t.getRemoteDocumentCache(),this.Ur=t.getTargetCache(),this.Gr=t.getBundleCache(),this.ls(n)}ls(t){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(t),this.indexManager=this.persistence.getIndexManager(t),this.mutationQueue=this.persistence.getMutationQueue(t,this.indexManager),this.localDocuments=new uO(this.cs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.cs.setIndexManager(this.indexManager),this.ss.initialize(this.localDocuments,this.indexManager)}collectGarbage(t){return this.persistence.runTransaction("Collect garbage","readwrite-primary",r=>t.collect(r,this.os))}}function TO(e,t,r,n){return new EO(e,t,r,n)}async function uS(e,t){const r=ze(e);return await r.persistence.runTransaction("Handle user change","readonly",n=>{let s;return r.mutationQueue.getAllMutationBatches(n).next(a=>(s=a,r.ls(t),r.mutationQueue.getAllMutationBatches(n))).next(a=>{const i=[],o=[];let l=Qe();for(const c of s){i.push(c.batchId);for(const u of c.mutations)l=l.add(u.key)}for(const c of a){o.push(c.batchId);for(const u of c.mutations)l=l.add(u.key)}return r.localDocuments.getDocuments(n,l).next(c=>({hs:c,removedBatchIds:i,addedBatchIds:o}))})})}function kO(e,t){const r=ze(e);return r.persistence.runTransaction("Acknowledge batch","readwrite-primary",n=>{const s=t.batch.keys(),a=r.cs.newChangeBuffer({trackRemovals:!0});return function(o,l,c,u){const d=c.batch,m=d.keys();let p=ye.resolve();return m.forEach(x=>{p=p.next(()=>u.getEntry(l,x)).next(g=>{const _=c.docVersions.get(x);xt(_!==null),g.version.compareTo(_)<0&&(d.applyToRemoteDocument(g,c),g.isValidDocument()&&(g.setReadTime(c.commitVersion),u.addEntry(g)))})}),p.next(()=>o.mutationQueue.removeMutationBatch(l,d))}(r,n,t,a).next(()=>a.apply(n)).next(()=>r.mutationQueue.performConsistencyCheck(n)).next(()=>r.documentOverlayCache.removeOverlaysForBatchId(n,s,t.batch.batchId)).next(()=>r.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(n,function(o){let l=Qe();for(let c=0;c<o.mutationResults.length;++c)o.mutationResults[c].transformResults.length>0&&(l=l.add(o.batch.mutations[c].key));return l}(t))).next(()=>r.localDocuments.getDocuments(n,s))})}function fS(e){const t=ze(e);return t.persistence.runTransaction("Get last remote snapshot version","readonly",r=>t.Ur.getLastRemoteSnapshotVersion(r))}function SO(e,t){const r=ze(e),n=t.snapshotVersion;let s=r.os;return r.persistence.runTransaction("Apply remote event","readwrite-primary",a=>{const i=r.cs.newChangeBuffer({trackRemovals:!0});s=r.os;const o=[];t.targetChanges.forEach((u,d)=>{const m=s.get(d);if(!m)return;o.push(r.Ur.removeMatchingKeys(a,u.removedDocuments,d).next(()=>r.Ur.addMatchingKeys(a,u.addedDocuments,d)));let p=m.withSequenceNumber(a.currentSequenceNumber);t.targetMismatches.get(d)!==null?p=p.withResumeToken(Cr.EMPTY_BYTE_STRING,Ve.min()).withLastLimboFreeSnapshotVersion(Ve.min()):u.resumeToken.approximateByteSize()>0&&(p=p.withResumeToken(u.resumeToken,n)),s=s.insert(d,p),function(g,_,k){return g.resumeToken.approximateByteSize()===0||_.snapshotVersion.toMicroseconds()-g.snapshotVersion.toMicroseconds()>=3e8?!0:k.addedDocuments.size+k.modifiedDocuments.size+k.removedDocuments.size>0}(m,p,u)&&o.push(r.Ur.updateTargetData(a,p))});let l=ya(),c=Qe();if(t.documentUpdates.forEach(u=>{t.resolvedLimboDocuments.has(u)&&o.push(r.persistence.referenceDelegate.updateLimboDocument(a,u))}),o.push(AO(a,i,t.documentUpdates).next(u=>{l=u.Ps,c=u.Is})),!n.isEqual(Ve.min())){const u=r.Ur.getLastRemoteSnapshotVersion(a).next(d=>r.Ur.setTargetsMetadata(a,a.currentSequenceNumber,n));o.push(u)}return ye.waitFor(o).next(()=>i.apply(a)).next(()=>r.localDocuments.getLocalViewOfDocuments(a,l,c)).next(()=>l)}).then(a=>(r.os=s,a))}function AO(e,t,r){let n=Qe(),s=Qe();return r.forEach(a=>n=n.add(a)),t.getEntries(e,n).next(a=>{let i=ya();return r.forEach((o,l)=>{const c=a.get(o);l.isFoundDocument()!==c.isFoundDocument()&&(s=s.add(o)),l.isNoDocument()&&l.version.isEqual(Ve.min())?(t.removeEntry(o,l.readTime),i=i.insert(o,l)):!c.isValidDocument()||l.version.compareTo(c.version)>0||l.version.compareTo(c.version)===0&&c.hasPendingWrites?(t.addEntry(l),i=i.insert(o,l)):be("LocalStore","Ignoring outdated watch update for ",o,". Current version:",c.version," Watch version:",l.version)}),{Ps:i,Is:s}})}function IO(e,t){const r=ze(e);return r.persistence.runTransaction("Get next mutation batch","readonly",n=>(t===void 0&&(t=-1),r.mutationQueue.getNextMutationBatchAfterBatchId(n,t)))}function CO(e,t){const r=ze(e);return r.persistence.runTransaction("Allocate target","readwrite",n=>{let s;return r.Ur.getTargetData(n,t).next(a=>a?(s=a,ye.resolve(s)):r.Ur.allocateTargetId(n).next(i=>(s=new Wa(t,i,"TargetPurposeListen",n.currentSequenceNumber),r.Ur.addTargetData(n,s).next(()=>s))))}).then(n=>{const s=r.os.get(n.targetId);return(s===null||n.snapshotVersion.compareTo(s.snapshotVersion)>0)&&(r.os=r.os.insert(n.targetId,n),r._s.set(t,n.targetId)),n})}async function Ap(e,t,r){const n=ze(e),s=n.os.get(t),a=r?"readwrite":"readwrite-primary";try{r||await n.persistence.runTransaction("Release target",a,i=>n.persistence.referenceDelegate.removeTarget(i,s))}catch(i){if(!bu(i))throw i;be("LocalStore",`Failed to update sequence numbers for target ${t}: ${i}`)}n.os=n.os.remove(t),n._s.delete(s.target)}function __(e,t,r){const n=ze(e);let s=Ve.min(),a=Qe();return n.persistence.runTransaction("Execute query","readwrite",i=>function(l,c,u){const d=ze(l),m=d._s.get(u);return m!==void 0?ye.resolve(d.os.get(m)):d.Ur.getTargetData(c,u)}(n,i,Is(t)).next(o=>{if(o)return s=o.lastLimboFreeSnapshotVersion,n.Ur.getMatchingKeysForTargetId(i,o.targetId).next(l=>{a=l})}).next(()=>n.ss.getDocumentsMatchingQuery(i,t,r?s:Ve.min(),r?a:Qe())).next(o=>(NO(n,_F(t),o),{documents:o,Ts:a})))}function NO(e,t,r){let n=e.us.get(t)||Ve.min();r.forEach((s,a)=>{a.readTime.compareTo(n)>0&&(n=a.readTime)}),e.us.set(t,n)}class w_{constructor(){this.activeTargetIds=AF()}fs(t){this.activeTargetIds=this.activeTargetIds.add(t)}gs(t){this.activeTargetIds=this.activeTargetIds.delete(t)}Vs(){const t={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(t)}}class RO{constructor(){this.so=new w_,this.oo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(t){}updateMutationState(t,r,n){}addLocalQueryTarget(t,r=!0){return r&&this.so.fs(t),this.oo[t]||"not-current"}updateQueryState(t,r,n){this.oo[t]=r}removeLocalQueryTarget(t){this.so.gs(t)}isLocalQueryTarget(t){return this.so.activeTargetIds.has(t)}clearQueryState(t){delete this.oo[t]}getAllActiveQueryTargets(){return this.so.activeTargetIds}isActiveQueryTarget(t){return this.so.activeTargetIds.has(t)}start(){return this.so=new w_,Promise.resolve()}handleUserChange(t,r,n){}setOnlineState(t){}shutdown(){}writeSequenceNumber(t){}notifyBundleLoaded(t){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bO{_o(t){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class E_{constructor(){this.ao=()=>this.uo(),this.co=()=>this.lo(),this.ho=[],this.Po()}_o(t){this.ho.push(t)}shutdown(){window.removeEventListener("online",this.ao),window.removeEventListener("offline",this.co)}Po(){window.addEventListener("online",this.ao),window.addEventListener("offline",this.co)}uo(){be("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const t of this.ho)t(0)}lo(){be("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const t of this.ho)t(1)}static D(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Cf=null;function X0(){return Cf===null?Cf=function(){return 268435456+Math.round(2147483648*Math.random())}():Cf++,"0x"+Cf.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const PO={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DO{constructor(t){this.Io=t.Io,this.To=t.To}Eo(t){this.Ao=t}Ro(t){this.Vo=t}mo(t){this.fo=t}onMessage(t){this.po=t}close(){this.To()}send(t){this.Io(t)}yo(){this.Ao()}wo(){this.Vo()}So(t){this.fo(t)}bo(t){this.po(t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Fr="WebChannelConnection";class FO extends class{constructor(r){this.databaseInfo=r,this.databaseId=r.databaseId;const n=r.ssl?"https":"http",s=encodeURIComponent(this.databaseId.projectId),a=encodeURIComponent(this.databaseId.database);this.Do=n+"://"+r.host,this.vo=`projects/${s}/databases/${a}`,this.Co=this.databaseId.database==="(default)"?`project_id=${s}`:`project_id=${s}&database_id=${a}`}get Fo(){return!1}Mo(r,n,s,a,i){const o=X0(),l=this.xo(r,n.toUriEncodedString());be("RestConnection",`Sending RPC '${r}' ${o}:`,l,s);const c={"google-cloud-resource-prefix":this.vo,"x-goog-request-params":this.Co};return this.Oo(c,a,i),this.No(r,l,c,s).then(u=>(be("RestConnection",`Received RPC '${r}' ${o}: `,u),u),u=>{throw cl("RestConnection",`RPC '${r}' ${o} failed with error: `,u,"url: ",l,"request:",s),u})}Lo(r,n,s,a,i,o){return this.Mo(r,n,s,a,i)}Oo(r,n,s){r["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+Tl}(),r["Content-Type"]="text/plain",this.databaseInfo.appId&&(r["X-Firebase-GMPID"]=this.databaseInfo.appId),n&&n.headers.forEach((a,i)=>r[i]=a),s&&s.headers.forEach((a,i)=>r[i]=a)}xo(r,n){const s=PO[r];return`${this.Do}/v1/${n}:${s}`}terminate(){}}{constructor(t){super(t),this.forceLongPolling=t.forceLongPolling,this.autoDetectLongPolling=t.autoDetectLongPolling,this.useFetchStreams=t.useFetchStreams,this.longPollingOptions=t.longPollingOptions}No(t,r,n,s){const a=X0();return new Promise((i,o)=>{const l=new Tk;l.setWithCredentials(!0),l.listenOnce(kk.COMPLETE,()=>{try{switch(l.getLastErrorCode()){case rh.NO_ERROR:const u=l.getResponseJson();be(Fr,`XHR for RPC '${t}' ${a} received:`,JSON.stringify(u)),i(u);break;case rh.TIMEOUT:be(Fr,`RPC '${t}' ${a} timed out`),o(new Re(pe.DEADLINE_EXCEEDED,"Request time out"));break;case rh.HTTP_ERROR:const d=l.getStatus();if(be(Fr,`RPC '${t}' ${a} failed with status:`,d,"response text:",l.getResponseText()),d>0){let m=l.getResponseJson();Array.isArray(m)&&(m=m[0]);const p=m==null?void 0:m.error;if(p&&p.status&&p.message){const x=function(_){const k=_.toLowerCase().replace(/_/g,"-");return Object.values(pe).indexOf(k)>=0?k:pe.UNKNOWN}(p.status);o(new Re(x,p.message))}else o(new Re(pe.UNKNOWN,"Server responded with status "+l.getStatus()))}else o(new Re(pe.UNAVAILABLE,"Connection failed."));break;default:Le()}}finally{be(Fr,`RPC '${t}' ${a} completed.`)}});const c=JSON.stringify(s);be(Fr,`RPC '${t}' ${a} sending request:`,s),l.send(r,"POST",c,n,15)})}Bo(t,r,n){const s=X0(),a=[this.Do,"/","google.firestore.v1.Firestore","/",t,"/channel"],i=Ik(),o=Ak(),l={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},c=this.longPollingOptions.timeoutSeconds;c!==void 0&&(l.longPollingTimeout=Math.round(1e3*c)),this.useFetchStreams&&(l.useFetchStreams=!0),this.Oo(l.initMessageHeaders,r,n),l.encodeInitMessageHeaders=!0;const u=a.join("");be(Fr,`Creating RPC '${t}' stream ${s}: ${u}`,l);const d=i.createWebChannel(u,l);let m=!1,p=!1;const x=new DO({Io:_=>{p?be(Fr,`Not sending because RPC '${t}' stream ${s} is closed:`,_):(m||(be(Fr,`Opening RPC '${t}' stream ${s} transport.`),d.open(),m=!0),be(Fr,`RPC '${t}' stream ${s} sending:`,_),d.send(_))},To:()=>d.close()}),g=(_,k,T)=>{_.listen(k,w=>{try{T(w)}catch(C){setTimeout(()=>{throw C},0)}})};return g(d,tc.EventType.OPEN,()=>{p||(be(Fr,`RPC '${t}' stream ${s} transport opened.`),x.yo())}),g(d,tc.EventType.CLOSE,()=>{p||(p=!0,be(Fr,`RPC '${t}' stream ${s} transport closed`),x.So())}),g(d,tc.EventType.ERROR,_=>{p||(p=!0,cl(Fr,`RPC '${t}' stream ${s} transport errored:`,_),x.So(new Re(pe.UNAVAILABLE,"The operation could not be completed")))}),g(d,tc.EventType.MESSAGE,_=>{var k;if(!p){const T=_.data[0];xt(!!T);const w=T,C=w.error||((k=w[0])===null||k===void 0?void 0:k.error);if(C){be(Fr,`RPC '${t}' stream ${s} received error:`,C);const M=C.status;let O=function(S){const R=Yt[S];if(R!==void 0)return eS(R)}(M),v=C.message;O===void 0&&(O=pe.INTERNAL,v="Unknown error status: "+M+" with message "+C.message),p=!0,x.So(new Re(O,v)),d.close()}else be(Fr,`RPC '${t}' stream ${s} received:`,T),x.bo(T)}}),g(o,Sk.STAT_EVENT,_=>{_.stat===pp.PROXY?be(Fr,`RPC '${t}' stream ${s} detected buffering proxy`):_.stat===pp.NOPROXY&&be(Fr,`RPC '${t}' stream ${s} detected no buffering proxy`)}),setTimeout(()=>{x.wo()},0),x}}function Y0(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $d(e){return new WF(e,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hS{constructor(t,r,n=1e3,s=1.5,a=6e4){this.ui=t,this.timerId=r,this.ko=n,this.qo=s,this.Qo=a,this.Ko=0,this.$o=null,this.Uo=Date.now(),this.reset()}reset(){this.Ko=0}Wo(){this.Ko=this.Qo}Go(t){this.cancel();const r=Math.floor(this.Ko+this.zo()),n=Math.max(0,Date.now()-this.Uo),s=Math.max(0,r-n);s>0&&be("ExponentialBackoff",`Backing off for ${s} ms (base delay: ${this.Ko} ms, delay with jitter: ${r} ms, last attempt: ${n} ms ago)`),this.$o=this.ui.enqueueAfterDelay(this.timerId,s,()=>(this.Uo=Date.now(),t())),this.Ko*=this.qo,this.Ko<this.ko&&(this.Ko=this.ko),this.Ko>this.Qo&&(this.Ko=this.Qo)}jo(){this.$o!==null&&(this.$o.skipDelay(),this.$o=null)}cancel(){this.$o!==null&&(this.$o.cancel(),this.$o=null)}zo(){return(Math.random()-.5)*this.Ko}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dS{constructor(t,r,n,s,a,i,o,l){this.ui=t,this.Ho=n,this.Jo=s,this.connection=a,this.authCredentialsProvider=i,this.appCheckCredentialsProvider=o,this.listener=l,this.state=0,this.Yo=0,this.Zo=null,this.Xo=null,this.stream=null,this.e_=0,this.t_=new hS(t,r)}n_(){return this.state===1||this.state===5||this.r_()}r_(){return this.state===2||this.state===3}start(){this.e_=0,this.state!==4?this.auth():this.i_()}async stop(){this.n_()&&await this.close(0)}s_(){this.state=0,this.t_.reset()}o_(){this.r_()&&this.Zo===null&&(this.Zo=this.ui.enqueueAfterDelay(this.Ho,6e4,()=>this.__()))}a_(t){this.u_(),this.stream.send(t)}async __(){if(this.r_())return this.close(0)}u_(){this.Zo&&(this.Zo.cancel(),this.Zo=null)}c_(){this.Xo&&(this.Xo.cancel(),this.Xo=null)}async close(t,r){this.u_(),this.c_(),this.t_.cancel(),this.Yo++,t!==4?this.t_.reset():r&&r.code===pe.RESOURCE_EXHAUSTED?(va(r.toString()),va("Using maximum backoff delay to prevent overloading the backend."),this.t_.Wo()):r&&r.code===pe.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.l_(),this.stream.close(),this.stream=null),this.state=t,await this.listener.mo(r)}l_(){}auth(){this.state=1;const t=this.h_(this.Yo),r=this.Yo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([n,s])=>{this.Yo===r&&this.P_(n,s)},n=>{t(()=>{const s=new Re(pe.UNKNOWN,"Fetching auth token failed: "+n.message);return this.I_(s)})})}P_(t,r){const n=this.h_(this.Yo);this.stream=this.T_(t,r),this.stream.Eo(()=>{n(()=>this.listener.Eo())}),this.stream.Ro(()=>{n(()=>(this.state=2,this.Xo=this.ui.enqueueAfterDelay(this.Jo,1e4,()=>(this.r_()&&(this.state=3),Promise.resolve())),this.listener.Ro()))}),this.stream.mo(s=>{n(()=>this.I_(s))}),this.stream.onMessage(s=>{n(()=>++this.e_==1?this.E_(s):this.onNext(s))})}i_(){this.state=5,this.t_.Go(async()=>{this.state=0,this.start()})}I_(t){return be("PersistentStream",`close with error: ${t}`),this.stream=null,this.close(4,t)}h_(t){return r=>{this.ui.enqueueAndForget(()=>this.Yo===t?r():(be("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class OO extends dS{constructor(t,r,n,s,a,i){super(t,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",r,n,s,i),this.serializer=a}T_(t,r){return this.connection.Bo("Listen",t,r)}E_(t){return this.onNext(t)}onNext(t){this.t_.reset();const r=KF(this.serializer,t),n=function(a){if(!("targetChange"in a))return Ve.min();const i=a.targetChange;return i.targetIds&&i.targetIds.length?Ve.min():i.readTime?Cs(i.readTime):Ve.min()}(t);return this.listener.d_(r,n)}A_(t){const r={};r.database=Sp(this.serializer),r.addTarget=function(a,i){let o;const l=i.target;if(o=yp(l)?{documents:YF(a,l)}:{query:QF(a,l)._t},o.targetId=i.targetId,i.resumeToken.approximateByteSize()>0){o.resumeToken=nS(a,i.resumeToken);const c=Ep(a,i.expectedCount);c!==null&&(o.expectedCount=c)}else if(i.snapshotVersion.compareTo(Ve.min())>0){o.readTime=Kh(a,i.snapshotVersion.toTimestamp());const c=Ep(a,i.expectedCount);c!==null&&(o.expectedCount=c)}return o}(this.serializer,t);const n=ZF(this.serializer,t);n&&(r.labels=n),this.a_(r)}R_(t){const r={};r.database=Sp(this.serializer),r.removeTarget=t,this.a_(r)}}class MO extends dS{constructor(t,r,n,s,a,i){super(t,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",r,n,s,i),this.serializer=a}get V_(){return this.e_>0}start(){this.lastStreamToken=void 0,super.start()}l_(){this.V_&&this.m_([])}T_(t,r){return this.connection.Bo("Write",t,r)}E_(t){return xt(!!t.streamToken),this.lastStreamToken=t.streamToken,xt(!t.writeResults||t.writeResults.length===0),this.listener.f_()}onNext(t){xt(!!t.streamToken),this.lastStreamToken=t.streamToken,this.t_.reset();const r=XF(t.writeResults,t.commitTime),n=Cs(t.commitTime);return this.listener.g_(n,r)}p_(){const t={};t.database=Sp(this.serializer),this.a_(t)}m_(t){const r={streamToken:this.lastStreamToken,writes:t.map(n=>qF(this.serializer,n))};this.a_(r)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class LO extends class{}{constructor(t,r,n,s){super(),this.authCredentials=t,this.appCheckCredentials=r,this.connection=n,this.serializer=s,this.y_=!1}w_(){if(this.y_)throw new Re(pe.FAILED_PRECONDITION,"The client has already been terminated.")}Mo(t,r,n,s){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([a,i])=>this.connection.Mo(t,Tp(r,n),s,a,i)).catch(a=>{throw a.name==="FirebaseError"?(a.code===pe.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),a):new Re(pe.UNKNOWN,a.toString())})}Lo(t,r,n,s,a){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([i,o])=>this.connection.Lo(t,Tp(r,n),s,i,o,a)).catch(i=>{throw i.name==="FirebaseError"?(i.code===pe.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),i):new Re(pe.UNKNOWN,i.toString())})}terminate(){this.y_=!0,this.connection.terminate()}}class jO{constructor(t,r){this.asyncQueue=t,this.onlineStateHandler=r,this.state="Unknown",this.S_=0,this.b_=null,this.D_=!0}v_(){this.S_===0&&(this.C_("Unknown"),this.b_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.b_=null,this.F_("Backend didn't respond within 10 seconds."),this.C_("Offline"),Promise.resolve())))}M_(t){this.state==="Online"?this.C_("Unknown"):(this.S_++,this.S_>=1&&(this.x_(),this.F_(`Connection failed 1 times. Most recent error: ${t.toString()}`),this.C_("Offline")))}set(t){this.x_(),this.S_=0,t==="Online"&&(this.D_=!1),this.C_(t)}C_(t){t!==this.state&&(this.state=t,this.onlineStateHandler(t))}F_(t){const r=`Could not reach Cloud Firestore backend. ${t}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.D_?(va(r),this.D_=!1):be("OnlineStateTracker",r)}x_(){this.b_!==null&&(this.b_.cancel(),this.b_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class UO{constructor(t,r,n,s,a){this.localStore=t,this.datastore=r,this.asyncQueue=n,this.remoteSyncer={},this.O_=[],this.N_=new Map,this.L_=new Set,this.B_=[],this.k_=a,this.k_._o(i=>{n.enqueueAndForget(async()=>{so(this)&&(be("RemoteStore","Restarting streams for network reachability change."),await async function(l){const c=ze(l);c.L_.add(4),await Ou(c),c.q_.set("Unknown"),c.L_.delete(4),await Wd(c)}(this))})}),this.q_=new jO(n,s)}}async function Wd(e){if(so(e))for(const t of e.B_)await t(!0)}async function Ou(e){for(const t of e.B_)await t(!1)}function mS(e,t){const r=ze(e);r.N_.has(t.targetId)||(r.N_.set(t.targetId,t),Ax(r)?Sx(r):Sl(r).r_()&&kx(r,t))}function Tx(e,t){const r=ze(e),n=Sl(r);r.N_.delete(t),n.r_()&&pS(r,t),r.N_.size===0&&(n.r_()?n.o_():so(r)&&r.q_.set("Unknown"))}function kx(e,t){if(e.Q_.xe(t.targetId),t.resumeToken.approximateByteSize()>0||t.snapshotVersion.compareTo(Ve.min())>0){const r=e.remoteSyncer.getRemoteKeysForTarget(t.targetId).size;t=t.withExpectedCount(r)}Sl(e).A_(t)}function pS(e,t){e.Q_.xe(t),Sl(e).R_(t)}function Sx(e){e.Q_=new VF({getRemoteKeysForTarget:t=>e.remoteSyncer.getRemoteKeysForTarget(t),ot:t=>e.N_.get(t)||null,tt:()=>e.datastore.serializer.databaseId}),Sl(e).start(),e.q_.v_()}function Ax(e){return so(e)&&!Sl(e).n_()&&e.N_.size>0}function so(e){return ze(e).L_.size===0}function gS(e){e.Q_=void 0}async function VO(e){e.q_.set("Online")}async function BO(e){e.N_.forEach((t,r)=>{kx(e,t)})}async function zO(e,t){gS(e),Ax(e)?(e.q_.M_(t),Sx(e)):e.q_.set("Unknown")}async function $O(e,t,r){if(e.q_.set("Online"),t instanceof rS&&t.state===2&&t.cause)try{await async function(s,a){const i=a.cause;for(const o of a.targetIds)s.N_.has(o)&&(await s.remoteSyncer.rejectListen(o,i),s.N_.delete(o),s.Q_.removeTarget(o))}(e,t)}catch(n){be("RemoteStore","Failed to remove targets %s: %s ",t.targetIds.join(","),n),await qh(e,n)}else if(t instanceof ah?e.Q_.Ke(t):t instanceof tS?e.Q_.He(t):e.Q_.We(t),!r.isEqual(Ve.min()))try{const n=await fS(e.localStore);r.compareTo(n)>=0&&await function(a,i){const o=a.Q_.rt(i);return o.targetChanges.forEach((l,c)=>{if(l.resumeToken.approximateByteSize()>0){const u=a.N_.get(c);u&&a.N_.set(c,u.withResumeToken(l.resumeToken,i))}}),o.targetMismatches.forEach((l,c)=>{const u=a.N_.get(l);if(!u)return;a.N_.set(l,u.withResumeToken(Cr.EMPTY_BYTE_STRING,u.snapshotVersion)),pS(a,l);const d=new Wa(u.target,l,c,u.sequenceNumber);kx(a,d)}),a.remoteSyncer.applyRemoteEvent(o)}(e,r)}catch(n){be("RemoteStore","Failed to raise snapshot:",n),await qh(e,n)}}async function qh(e,t,r){if(!bu(t))throw t;e.L_.add(1),await Ou(e),e.q_.set("Offline"),r||(r=()=>fS(e.localStore)),e.asyncQueue.enqueueRetryable(async()=>{be("RemoteStore","Retrying IndexedDB access"),await r(),e.L_.delete(1),await Wd(e)})}function xS(e,t){return t().catch(r=>qh(e,r,t))}async function Hd(e){const t=ze(e),r=ui(t);let n=t.O_.length>0?t.O_[t.O_.length-1].batchId:-1;for(;WO(t);)try{const s=await IO(t.localStore,n);if(s===null){t.O_.length===0&&r.o_();break}n=s.batchId,HO(t,s)}catch(s){await qh(t,s)}vS(t)&&yS(t)}function WO(e){return so(e)&&e.O_.length<10}function HO(e,t){e.O_.push(t);const r=ui(e);r.r_()&&r.V_&&r.m_(t.mutations)}function vS(e){return so(e)&&!ui(e).n_()&&e.O_.length>0}function yS(e){ui(e).start()}async function GO(e){ui(e).p_()}async function KO(e){const t=ui(e);for(const r of e.O_)t.m_(r.mutations)}async function qO(e,t,r){const n=e.O_.shift(),s=xx.from(n,t,r);await xS(e,()=>e.remoteSyncer.applySuccessfulWrite(s)),await Hd(e)}async function XO(e,t){t&&ui(e).V_&&await async function(n,s){if(function(i){return LF(i)&&i!==pe.ABORTED}(s.code)){const a=n.O_.shift();ui(n).s_(),await xS(n,()=>n.remoteSyncer.rejectFailedWrite(a.batchId,s)),await Hd(n)}}(e,t),vS(e)&&yS(e)}async function T_(e,t){const r=ze(e);r.asyncQueue.verifyOperationInProgress(),be("RemoteStore","RemoteStore received new credentials");const n=so(r);r.L_.add(3),await Ou(r),n&&r.q_.set("Unknown"),await r.remoteSyncer.handleCredentialChange(t),r.L_.delete(3),await Wd(r)}async function YO(e,t){const r=ze(e);t?(r.L_.delete(2),await Wd(r)):t||(r.L_.add(2),await Ou(r),r.q_.set("Unknown"))}function Sl(e){return e.K_||(e.K_=function(r,n,s){const a=ze(r);return a.w_(),new OO(n,a.connection,a.authCredentials,a.appCheckCredentials,a.serializer,s)}(e.datastore,e.asyncQueue,{Eo:VO.bind(null,e),Ro:BO.bind(null,e),mo:zO.bind(null,e),d_:$O.bind(null,e)}),e.B_.push(async t=>{t?(e.K_.s_(),Ax(e)?Sx(e):e.q_.set("Unknown")):(await e.K_.stop(),gS(e))})),e.K_}function ui(e){return e.U_||(e.U_=function(r,n,s){const a=ze(r);return a.w_(),new MO(n,a.connection,a.authCredentials,a.appCheckCredentials,a.serializer,s)}(e.datastore,e.asyncQueue,{Eo:()=>Promise.resolve(),Ro:GO.bind(null,e),mo:XO.bind(null,e),f_:KO.bind(null,e),g_:qO.bind(null,e)}),e.B_.push(async t=>{t?(e.U_.s_(),await Hd(e)):(await e.U_.stop(),e.O_.length>0&&(be("RemoteStore",`Stopping write stream with ${e.O_.length} pending writes`),e.O_=[]))})),e.U_}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ix{constructor(t,r,n,s,a){this.asyncQueue=t,this.timerId=r,this.targetTimeMs=n,this.op=s,this.removalCallback=a,this.deferred=new oa,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(i=>{})}get promise(){return this.deferred.promise}static createAndSchedule(t,r,n,s,a){const i=Date.now()+n,o=new Ix(t,r,i,s,a);return o.start(n),o}start(t){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),t)}skipDelay(){return this.handleDelayElapsed()}cancel(t){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new Re(pe.CANCELLED,"Operation cancelled"+(t?": "+t:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(t=>this.deferred.resolve(t))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Cx(e,t){if(va("AsyncQueue",`${t}: ${e}`),bu(e))return new Re(pe.UNAVAILABLE,`${t}: ${e}`);throw e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qo{constructor(t){this.comparator=t?(r,n)=>t(r,n)||Pe.comparator(r.key,n.key):(r,n)=>Pe.comparator(r.key,n.key),this.keyedMap=rc(),this.sortedSet=new Lt(this.comparator)}static emptySet(t){return new qo(t.comparator)}has(t){return this.keyedMap.get(t)!=null}get(t){return this.keyedMap.get(t)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(t){const r=this.keyedMap.get(t);return r?this.sortedSet.indexOf(r):-1}get size(){return this.sortedSet.size}forEach(t){this.sortedSet.inorderTraversal((r,n)=>(t(r),!1))}add(t){const r=this.delete(t.key);return r.copy(r.keyedMap.insert(t.key,t),r.sortedSet.insert(t,null))}delete(t){const r=this.get(t);return r?this.copy(this.keyedMap.remove(t),this.sortedSet.remove(r)):this}isEqual(t){if(!(t instanceof qo)||this.size!==t.size)return!1;const r=this.sortedSet.getIterator(),n=t.sortedSet.getIterator();for(;r.hasNext();){const s=r.getNext().key,a=n.getNext().key;if(!s.isEqual(a))return!1}return!0}toString(){const t=[];return this.forEach(r=>{t.push(r.toString())}),t.length===0?"DocumentSet ()":`DocumentSet (
  `+t.join(`  
`)+`
)`}copy(t,r){const n=new qo;return n.comparator=this.comparator,n.keyedMap=t,n.sortedSet=r,n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class k_{constructor(){this.W_=new Lt(Pe.comparator)}track(t){const r=t.doc.key,n=this.W_.get(r);n?t.type!==0&&n.type===3?this.W_=this.W_.insert(r,t):t.type===3&&n.type!==1?this.W_=this.W_.insert(r,{type:n.type,doc:t.doc}):t.type===2&&n.type===2?this.W_=this.W_.insert(r,{type:2,doc:t.doc}):t.type===2&&n.type===0?this.W_=this.W_.insert(r,{type:0,doc:t.doc}):t.type===1&&n.type===0?this.W_=this.W_.remove(r):t.type===1&&n.type===2?this.W_=this.W_.insert(r,{type:1,doc:n.doc}):t.type===0&&n.type===1?this.W_=this.W_.insert(r,{type:2,doc:t.doc}):Le():this.W_=this.W_.insert(r,t)}G_(){const t=[];return this.W_.inorderTraversal((r,n)=>{t.push(n)}),t}}class ml{constructor(t,r,n,s,a,i,o,l,c){this.query=t,this.docs=r,this.oldDocs=n,this.docChanges=s,this.mutatedKeys=a,this.fromCache=i,this.syncStateChanged=o,this.excludesMetadataChanges=l,this.hasCachedResults=c}static fromInitialDocuments(t,r,n,s,a){const i=[];return r.forEach(o=>{i.push({type:0,doc:o})}),new ml(t,r,qo.emptySet(r),i,n,s,!0,!1,a)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(t){if(!(this.fromCache===t.fromCache&&this.hasCachedResults===t.hasCachedResults&&this.syncStateChanged===t.syncStateChanged&&this.mutatedKeys.isEqual(t.mutatedKeys)&&jd(this.query,t.query)&&this.docs.isEqual(t.docs)&&this.oldDocs.isEqual(t.oldDocs)))return!1;const r=this.docChanges,n=t.docChanges;if(r.length!==n.length)return!1;for(let s=0;s<r.length;s++)if(r[s].type!==n[s].type||!r[s].doc.isEqual(n[s].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QO{constructor(){this.z_=void 0,this.j_=[]}H_(){return this.j_.some(t=>t.J_())}}class JO{constructor(){this.queries=S_(),this.onlineState="Unknown",this.Y_=new Set}terminate(){(function(r,n){const s=ze(r),a=s.queries;s.queries=S_(),a.forEach((i,o)=>{for(const l of o.j_)l.onError(n)})})(this,new Re(pe.ABORTED,"Firestore shutting down"))}}function S_(){return new kl(e=>Vk(e),jd)}async function Nx(e,t){const r=ze(e);let n=3;const s=t.query;let a=r.queries.get(s);a?!a.H_()&&t.J_()&&(n=2):(a=new QO,n=t.J_()?0:1);try{switch(n){case 0:a.z_=await r.onListen(s,!0);break;case 1:a.z_=await r.onListen(s,!1);break;case 2:await r.onFirstRemoteStoreListen(s)}}catch(i){const o=Cx(i,`Initialization of query '${Eo(t.query)}' failed`);return void t.onError(o)}r.queries.set(s,a),a.j_.push(t),t.Z_(r.onlineState),a.z_&&t.X_(a.z_)&&bx(r)}async function Rx(e,t){const r=ze(e),n=t.query;let s=3;const a=r.queries.get(n);if(a){const i=a.j_.indexOf(t);i>=0&&(a.j_.splice(i,1),a.j_.length===0?s=t.J_()?0:1:!a.H_()&&t.J_()&&(s=2))}switch(s){case 0:return r.queries.delete(n),r.onUnlisten(n,!0);case 1:return r.queries.delete(n),r.onUnlisten(n,!1);case 2:return r.onLastRemoteStoreUnlisten(n);default:return}}function ZO(e,t){const r=ze(e);let n=!1;for(const s of t){const a=s.query,i=r.queries.get(a);if(i){for(const o of i.j_)o.X_(s)&&(n=!0);i.z_=s}}n&&bx(r)}function eM(e,t,r){const n=ze(e),s=n.queries.get(t);if(s)for(const a of s.j_)a.onError(r);n.queries.delete(t)}function bx(e){e.Y_.forEach(t=>{t.next()})}var Ip,A_;(A_=Ip||(Ip={})).ea="default",A_.Cache="cache";class Px{constructor(t,r,n){this.query=t,this.ta=r,this.na=!1,this.ra=null,this.onlineState="Unknown",this.options=n||{}}X_(t){if(!this.options.includeMetadataChanges){const n=[];for(const s of t.docChanges)s.type!==3&&n.push(s);t=new ml(t.query,t.docs,t.oldDocs,n,t.mutatedKeys,t.fromCache,t.syncStateChanged,!0,t.hasCachedResults)}let r=!1;return this.na?this.ia(t)&&(this.ta.next(t),r=!0):this.sa(t,this.onlineState)&&(this.oa(t),r=!0),this.ra=t,r}onError(t){this.ta.error(t)}Z_(t){this.onlineState=t;let r=!1;return this.ra&&!this.na&&this.sa(this.ra,t)&&(this.oa(this.ra),r=!0),r}sa(t,r){if(!t.fromCache||!this.J_())return!0;const n=r!=="Offline";return(!this.options._a||!n)&&(!t.docs.isEmpty()||t.hasCachedResults||r==="Offline")}ia(t){if(t.docChanges.length>0)return!0;const r=this.ra&&this.ra.hasPendingWrites!==t.hasPendingWrites;return!(!t.syncStateChanged&&!r)&&this.options.includeMetadataChanges===!0}oa(t){t=ml.fromInitialDocuments(t.query,t.docs,t.mutatedKeys,t.fromCache,t.hasCachedResults),this.na=!0,this.ta.next(t)}J_(){return this.options.source!==Ip.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _S{constructor(t){this.key=t}}class wS{constructor(t){this.key=t}}class tM{constructor(t,r){this.query=t,this.Ta=r,this.Ea=null,this.hasCachedResults=!1,this.current=!1,this.da=Qe(),this.mutatedKeys=Qe(),this.Aa=Bk(t),this.Ra=new qo(this.Aa)}get Va(){return this.Ta}ma(t,r){const n=r?r.fa:new k_,s=r?r.Ra:this.Ra;let a=r?r.mutatedKeys:this.mutatedKeys,i=s,o=!1;const l=this.query.limitType==="F"&&s.size===this.query.limit?s.last():null,c=this.query.limitType==="L"&&s.size===this.query.limit?s.first():null;if(t.inorderTraversal((u,d)=>{const m=s.get(u),p=Ud(this.query,d)?d:null,x=!!m&&this.mutatedKeys.has(m.key),g=!!p&&(p.hasLocalMutations||this.mutatedKeys.has(p.key)&&p.hasCommittedMutations);let _=!1;m&&p?m.data.isEqual(p.data)?x!==g&&(n.track({type:3,doc:p}),_=!0):this.ga(m,p)||(n.track({type:2,doc:p}),_=!0,(l&&this.Aa(p,l)>0||c&&this.Aa(p,c)<0)&&(o=!0)):!m&&p?(n.track({type:0,doc:p}),_=!0):m&&!p&&(n.track({type:1,doc:m}),_=!0,(l||c)&&(o=!0)),_&&(p?(i=i.add(p),a=g?a.add(u):a.delete(u)):(i=i.delete(u),a=a.delete(u)))}),this.query.limit!==null)for(;i.size>this.query.limit;){const u=this.query.limitType==="F"?i.last():i.first();i=i.delete(u.key),a=a.delete(u.key),n.track({type:1,doc:u})}return{Ra:i,fa:n,ns:o,mutatedKeys:a}}ga(t,r){return t.hasLocalMutations&&r.hasCommittedMutations&&!r.hasLocalMutations}applyChanges(t,r,n,s){const a=this.Ra;this.Ra=t.Ra,this.mutatedKeys=t.mutatedKeys;const i=t.fa.G_();i.sort((u,d)=>function(p,x){const g=_=>{switch(_){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Le()}};return g(p)-g(x)}(u.type,d.type)||this.Aa(u.doc,d.doc)),this.pa(n),s=s!=null&&s;const o=r&&!s?this.ya():[],l=this.da.size===0&&this.current&&!s?1:0,c=l!==this.Ea;return this.Ea=l,i.length!==0||c?{snapshot:new ml(this.query,t.Ra,a,i,t.mutatedKeys,l===0,c,!1,!!n&&n.resumeToken.approximateByteSize()>0),wa:o}:{wa:o}}Z_(t){return this.current&&t==="Offline"?(this.current=!1,this.applyChanges({Ra:this.Ra,fa:new k_,mutatedKeys:this.mutatedKeys,ns:!1},!1)):{wa:[]}}Sa(t){return!this.Ta.has(t)&&!!this.Ra.has(t)&&!this.Ra.get(t).hasLocalMutations}pa(t){t&&(t.addedDocuments.forEach(r=>this.Ta=this.Ta.add(r)),t.modifiedDocuments.forEach(r=>{}),t.removedDocuments.forEach(r=>this.Ta=this.Ta.delete(r)),this.current=t.current)}ya(){if(!this.current)return[];const t=this.da;this.da=Qe(),this.Ra.forEach(n=>{this.Sa(n.key)&&(this.da=this.da.add(n.key))});const r=[];return t.forEach(n=>{this.da.has(n)||r.push(new wS(n))}),this.da.forEach(n=>{t.has(n)||r.push(new _S(n))}),r}ba(t){this.Ta=t.Ts,this.da=Qe();const r=this.ma(t.documents);return this.applyChanges(r,!0)}Da(){return ml.fromInitialDocuments(this.query,this.Ra,this.mutatedKeys,this.Ea===0,this.hasCachedResults)}}class rM{constructor(t,r,n){this.query=t,this.targetId=r,this.view=n}}class nM{constructor(t){this.key=t,this.va=!1}}class sM{constructor(t,r,n,s,a,i){this.localStore=t,this.remoteStore=r,this.eventManager=n,this.sharedClientState=s,this.currentUser=a,this.maxConcurrentLimboResolutions=i,this.Ca={},this.Fa=new kl(o=>Vk(o),jd),this.Ma=new Map,this.xa=new Set,this.Oa=new Lt(Pe.comparator),this.Na=new Map,this.La=new _x,this.Ba={},this.ka=new Map,this.qa=dl.kn(),this.onlineState="Unknown",this.Qa=void 0}get isPrimaryClient(){return this.Qa===!0}}async function aM(e,t,r=!0){const n=IS(e);let s;const a=n.Fa.get(t);return a?(n.sharedClientState.addLocalQueryTarget(a.targetId),s=a.view.Da()):s=await ES(n,t,r,!0),s}async function iM(e,t){const r=IS(e);await ES(r,t,!0,!1)}async function ES(e,t,r,n){const s=await CO(e.localStore,Is(t)),a=s.targetId,i=e.sharedClientState.addLocalQueryTarget(a,r);let o;return n&&(o=await oM(e,t,a,i==="current",s.resumeToken)),e.isPrimaryClient&&r&&mS(e.remoteStore,s),o}async function oM(e,t,r,n,s){e.Ka=(d,m,p)=>async function(g,_,k,T){let w=_.view.ma(k);w.ns&&(w=await __(g.localStore,_.query,!1).then(({documents:v})=>_.view.ma(v,w)));const C=T&&T.targetChanges.get(_.targetId),M=T&&T.targetMismatches.get(_.targetId)!=null,O=_.view.applyChanges(w,g.isPrimaryClient,C,M);return C_(g,_.targetId,O.wa),O.snapshot}(e,d,m,p);const a=await __(e.localStore,t,!0),i=new tM(t,a.Ts),o=i.ma(a.documents),l=Fu.createSynthesizedTargetChangeForCurrentChange(r,n&&e.onlineState!=="Offline",s),c=i.applyChanges(o,e.isPrimaryClient,l);C_(e,r,c.wa);const u=new rM(t,r,i);return e.Fa.set(t,u),e.Ma.has(r)?e.Ma.get(r).push(t):e.Ma.set(r,[t]),c.snapshot}async function lM(e,t,r){const n=ze(e),s=n.Fa.get(t),a=n.Ma.get(s.targetId);if(a.length>1)return n.Ma.set(s.targetId,a.filter(i=>!jd(i,t))),void n.Fa.delete(t);n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(s.targetId),n.sharedClientState.isActiveQueryTarget(s.targetId)||await Ap(n.localStore,s.targetId,!1).then(()=>{n.sharedClientState.clearQueryState(s.targetId),r&&Tx(n.remoteStore,s.targetId),Cp(n,s.targetId)}).catch(Ru)):(Cp(n,s.targetId),await Ap(n.localStore,s.targetId,!0))}async function cM(e,t){const r=ze(e),n=r.Fa.get(t),s=r.Ma.get(n.targetId);r.isPrimaryClient&&s.length===1&&(r.sharedClientState.removeLocalQueryTarget(n.targetId),Tx(r.remoteStore,n.targetId))}async function uM(e,t,r){const n=xM(e);try{const s=await function(i,o){const l=ze(i),c=or.now(),u=o.reduce((p,x)=>p.add(x.key),Qe());let d,m;return l.persistence.runTransaction("Locally write mutations","readwrite",p=>{let x=ya(),g=Qe();return l.cs.getEntries(p,u).next(_=>{x=_,x.forEach((k,T)=>{T.isValidDocument()||(g=g.add(k))})}).next(()=>l.localDocuments.getOverlayedDocuments(p,x)).next(_=>{d=_;const k=[];for(const T of o){const w=PF(T,d.get(T.key).overlayedDocument);w!=null&&k.push(new vi(T.key,w,Pk(w.value.mapValue),Bn.exists(!0)))}return l.mutationQueue.addMutationBatch(p,c,k,o)}).next(_=>{m=_;const k=_.applyToLocalDocumentSet(d,g);return l.documentOverlayCache.saveOverlays(p,_.batchId,k)})}).then(()=>({batchId:m.batchId,changes:$k(d)}))}(n.localStore,t);n.sharedClientState.addPendingMutation(s.batchId),function(i,o,l){let c=i.Ba[i.currentUser.toKey()];c||(c=new Lt(ut)),c=c.insert(o,l),i.Ba[i.currentUser.toKey()]=c}(n,s.batchId,r),await Mu(n,s.changes),await Hd(n.remoteStore)}catch(s){const a=Cx(s,"Failed to persist write");r.reject(a)}}async function TS(e,t){const r=ze(e);try{const n=await SO(r.localStore,t);t.targetChanges.forEach((s,a)=>{const i=r.Na.get(a);i&&(xt(s.addedDocuments.size+s.modifiedDocuments.size+s.removedDocuments.size<=1),s.addedDocuments.size>0?i.va=!0:s.modifiedDocuments.size>0?xt(i.va):s.removedDocuments.size>0&&(xt(i.va),i.va=!1))}),await Mu(r,n,t)}catch(n){await Ru(n)}}function I_(e,t,r){const n=ze(e);if(n.isPrimaryClient&&r===0||!n.isPrimaryClient&&r===1){const s=[];n.Fa.forEach((a,i)=>{const o=i.view.Z_(t);o.snapshot&&s.push(o.snapshot)}),function(i,o){const l=ze(i);l.onlineState=o;let c=!1;l.queries.forEach((u,d)=>{for(const m of d.j_)m.Z_(o)&&(c=!0)}),c&&bx(l)}(n.eventManager,t),s.length&&n.Ca.d_(s),n.onlineState=t,n.isPrimaryClient&&n.sharedClientState.setOnlineState(t)}}async function fM(e,t,r){const n=ze(e);n.sharedClientState.updateQueryState(t,"rejected",r);const s=n.Na.get(t),a=s&&s.key;if(a){let i=new Lt(Pe.comparator);i=i.insert(a,Ur.newNoDocument(a,Ve.min()));const o=Qe().add(a),l=new zd(Ve.min(),new Map,new Lt(ut),i,o);await TS(n,l),n.Oa=n.Oa.remove(a),n.Na.delete(t),Dx(n)}else await Ap(n.localStore,t,!1).then(()=>Cp(n,t,r)).catch(Ru)}async function hM(e,t){const r=ze(e),n=t.batch.batchId;try{const s=await kO(r.localStore,t);SS(r,n,null),kS(r,n),r.sharedClientState.updateMutationState(n,"acknowledged"),await Mu(r,s)}catch(s){await Ru(s)}}async function dM(e,t,r){const n=ze(e);try{const s=await function(i,o){const l=ze(i);return l.persistence.runTransaction("Reject batch","readwrite-primary",c=>{let u;return l.mutationQueue.lookupMutationBatch(c,o).next(d=>(xt(d!==null),u=d.keys(),l.mutationQueue.removeMutationBatch(c,d))).next(()=>l.mutationQueue.performConsistencyCheck(c)).next(()=>l.documentOverlayCache.removeOverlaysForBatchId(c,u,o)).next(()=>l.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(c,u)).next(()=>l.localDocuments.getDocuments(c,u))})}(n.localStore,t);SS(n,t,r),kS(n,t),n.sharedClientState.updateMutationState(t,"rejected",r),await Mu(n,s)}catch(s){await Ru(s)}}function kS(e,t){(e.ka.get(t)||[]).forEach(r=>{r.resolve()}),e.ka.delete(t)}function SS(e,t,r){const n=ze(e);let s=n.Ba[n.currentUser.toKey()];if(s){const a=s.get(t);a&&(r?a.reject(r):a.resolve(),s=s.remove(t)),n.Ba[n.currentUser.toKey()]=s}}function Cp(e,t,r=null){e.sharedClientState.removeLocalQueryTarget(t);for(const n of e.Ma.get(t))e.Fa.delete(n),r&&e.Ca.$a(n,r);e.Ma.delete(t),e.isPrimaryClient&&e.La.gr(t).forEach(n=>{e.La.containsKey(n)||AS(e,n)})}function AS(e,t){e.xa.delete(t.path.canonicalString());const r=e.Oa.get(t);r!==null&&(Tx(e.remoteStore,r),e.Oa=e.Oa.remove(t),e.Na.delete(r),Dx(e))}function C_(e,t,r){for(const n of r)n instanceof _S?(e.La.addReference(n.key,t),mM(e,n)):n instanceof wS?(be("SyncEngine","Document no longer in limbo: "+n.key),e.La.removeReference(n.key,t),e.La.containsKey(n.key)||AS(e,n.key)):Le()}function mM(e,t){const r=t.key,n=r.path.canonicalString();e.Oa.get(r)||e.xa.has(n)||(be("SyncEngine","New document in limbo: "+r),e.xa.add(n),Dx(e))}function Dx(e){for(;e.xa.size>0&&e.Oa.size<e.maxConcurrentLimboResolutions;){const t=e.xa.values().next().value;e.xa.delete(t);const r=new Pe(Ct.fromString(t)),n=e.qa.next();e.Na.set(n,new nM(r)),e.Oa=e.Oa.insert(r,n),mS(e.remoteStore,new Wa(Is(Ld(r.path)),n,"TargetPurposeLimboResolution",cx.oe))}}async function Mu(e,t,r){const n=ze(e),s=[],a=[],i=[];n.Fa.isEmpty()||(n.Fa.forEach((o,l)=>{i.push(n.Ka(l,t,r).then(c=>{var u;if((c||r)&&n.isPrimaryClient){const d=c?!c.fromCache:(u=r==null?void 0:r.targetChanges.get(l.targetId))===null||u===void 0?void 0:u.current;n.sharedClientState.updateQueryState(l.targetId,d?"current":"not-current")}if(c){s.push(c);const d=Ex.Wi(l.targetId,c);a.push(d)}}))}),await Promise.all(i),n.Ca.d_(s),await async function(l,c){const u=ze(l);try{await u.persistence.runTransaction("notifyLocalViewChanges","readwrite",d=>ye.forEach(c,m=>ye.forEach(m.$i,p=>u.persistence.referenceDelegate.addReference(d,m.targetId,p)).next(()=>ye.forEach(m.Ui,p=>u.persistence.referenceDelegate.removeReference(d,m.targetId,p)))))}catch(d){if(!bu(d))throw d;be("LocalStore","Failed to update sequence numbers: "+d)}for(const d of c){const m=d.targetId;if(!d.fromCache){const p=u.os.get(m),x=p.snapshotVersion,g=p.withLastLimboFreeSnapshotVersion(x);u.os=u.os.insert(m,g)}}}(n.localStore,a))}async function pM(e,t){const r=ze(e);if(!r.currentUser.isEqual(t)){be("SyncEngine","User change. New user:",t.toKey());const n=await uS(r.localStore,t);r.currentUser=t,function(a,i){a.ka.forEach(o=>{o.forEach(l=>{l.reject(new Re(pe.CANCELLED,i))})}),a.ka.clear()}(r,"'waitForPendingWrites' promise is rejected due to a user change."),r.sharedClientState.handleUserChange(t,n.removedBatchIds,n.addedBatchIds),await Mu(r,n.hs)}}function gM(e,t){const r=ze(e),n=r.Na.get(t);if(n&&n.va)return Qe().add(n.key);{let s=Qe();const a=r.Ma.get(t);if(!a)return s;for(const i of a){const o=r.Fa.get(i);s=s.unionWith(o.view.Va)}return s}}function IS(e){const t=ze(e);return t.remoteStore.remoteSyncer.applyRemoteEvent=TS.bind(null,t),t.remoteStore.remoteSyncer.getRemoteKeysForTarget=gM.bind(null,t),t.remoteStore.remoteSyncer.rejectListen=fM.bind(null,t),t.Ca.d_=ZO.bind(null,t.eventManager),t.Ca.$a=eM.bind(null,t.eventManager),t}function xM(e){const t=ze(e);return t.remoteStore.remoteSyncer.applySuccessfulWrite=hM.bind(null,t),t.remoteStore.remoteSyncer.rejectFailedWrite=dM.bind(null,t),t}class Xh{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(t){this.serializer=$d(t.databaseInfo.databaseId),this.sharedClientState=this.Wa(t),this.persistence=this.Ga(t),await this.persistence.start(),this.localStore=this.za(t),this.gcScheduler=this.ja(t,this.localStore),this.indexBackfillerScheduler=this.Ha(t,this.localStore)}ja(t,r){return null}Ha(t,r){return null}za(t){return TO(this.persistence,new wO,t.initialUser,this.serializer)}Ga(t){return new vO(wx.Zr,this.serializer)}Wa(t){return new RO}async terminate(){var t,r;(t=this.gcScheduler)===null||t===void 0||t.stop(),(r=this.indexBackfillerScheduler)===null||r===void 0||r.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}Xh.provider={build:()=>new Xh};class Np{async initialize(t,r){this.localStore||(this.localStore=t.localStore,this.sharedClientState=t.sharedClientState,this.datastore=this.createDatastore(r),this.remoteStore=this.createRemoteStore(r),this.eventManager=this.createEventManager(r),this.syncEngine=this.createSyncEngine(r,!t.synchronizeTabs),this.sharedClientState.onlineStateHandler=n=>I_(this.syncEngine,n,1),this.remoteStore.remoteSyncer.handleCredentialChange=pM.bind(null,this.syncEngine),await YO(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(t){return function(){return new JO}()}createDatastore(t){const r=$d(t.databaseInfo.databaseId),n=function(a){return new FO(a)}(t.databaseInfo);return function(a,i,o,l){return new LO(a,i,o,l)}(t.authCredentials,t.appCheckCredentials,n,r)}createRemoteStore(t){return function(n,s,a,i,o){return new UO(n,s,a,i,o)}(this.localStore,this.datastore,t.asyncQueue,r=>I_(this.syncEngine,r,0),function(){return E_.D()?new E_:new bO}())}createSyncEngine(t,r){return function(s,a,i,o,l,c,u){const d=new sM(s,a,i,o,l,c);return u&&(d.Qa=!0),d}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,t.initialUser,t.maxConcurrentLimboResolutions,r)}async terminate(){var t,r;await async function(s){const a=ze(s);be("RemoteStore","RemoteStore shutting down."),a.L_.add(5),await Ou(a),a.k_.shutdown(),a.q_.set("Unknown")}(this.remoteStore),(t=this.datastore)===null||t===void 0||t.terminate(),(r=this.eventManager)===null||r===void 0||r.terminate()}}Np.provider={build:()=>new Np};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fx{constructor(t){this.observer=t,this.muted=!1}next(t){this.muted||this.observer.next&&this.Ya(this.observer.next,t)}error(t){this.muted||(this.observer.error?this.Ya(this.observer.error,t):va("Uncaught Error in snapshot listener:",t.toString()))}Za(){this.muted=!0}Ya(t,r){setTimeout(()=>{this.muted||t(r)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vM{constructor(t,r,n,s,a){this.authCredentials=t,this.appCheckCredentials=r,this.asyncQueue=n,this.databaseInfo=s,this.user=Mr.UNAUTHENTICATED,this.clientId=Nk.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=a,this.authCredentials.start(n,async i=>{be("FirestoreClient","Received user=",i.uid),await this.authCredentialListener(i),this.user=i}),this.appCheckCredentials.start(n,i=>(be("FirestoreClient","Received new app check token=",i),this.appCheckCredentialListener(i,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(t){this.authCredentialListener=t}setAppCheckTokenChangeListener(t){this.appCheckCredentialListener=t}terminate(){this.asyncQueue.enterRestrictedMode();const t=new oa;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),t.resolve()}catch(r){const n=Cx(r,"Failed to shutdown persistence");t.reject(n)}}),t.promise}}async function Q0(e,t){e.asyncQueue.verifyOperationInProgress(),be("FirestoreClient","Initializing OfflineComponentProvider");const r=e.configuration;await t.initialize(r);let n=r.initialUser;e.setCredentialChangeListener(async s=>{n.isEqual(s)||(await uS(t.localStore,s),n=s)}),t.persistence.setDatabaseDeletedListener(()=>e.terminate()),e._offlineComponents=t}async function N_(e,t){e.asyncQueue.verifyOperationInProgress();const r=await yM(e);be("FirestoreClient","Initializing OnlineComponentProvider"),await t.initialize(r,e.configuration),e.setCredentialChangeListener(n=>T_(t.remoteStore,n)),e.setAppCheckTokenChangeListener((n,s)=>T_(t.remoteStore,s)),e._onlineComponents=t}async function yM(e){if(!e._offlineComponents)if(e._uninitializedComponentsProvider){be("FirestoreClient","Using user provided OfflineComponentProvider");try{await Q0(e,e._uninitializedComponentsProvider._offline)}catch(t){const r=t;if(!function(s){return s.name==="FirebaseError"?s.code===pe.FAILED_PRECONDITION||s.code===pe.UNIMPLEMENTED:!(typeof DOMException<"u"&&s instanceof DOMException)||s.code===22||s.code===20||s.code===11}(r))throw r;cl("Error using user provided cache. Falling back to memory cache: "+r),await Q0(e,new Xh)}}else be("FirestoreClient","Using default OfflineComponentProvider"),await Q0(e,new Xh);return e._offlineComponents}async function CS(e){return e._onlineComponents||(e._uninitializedComponentsProvider?(be("FirestoreClient","Using user provided OnlineComponentProvider"),await N_(e,e._uninitializedComponentsProvider._online)):(be("FirestoreClient","Using default OnlineComponentProvider"),await N_(e,new Np))),e._onlineComponents}function _M(e){return CS(e).then(t=>t.syncEngine)}async function Yh(e){const t=await CS(e),r=t.eventManager;return r.onListen=aM.bind(null,t.syncEngine),r.onUnlisten=lM.bind(null,t.syncEngine),r.onFirstRemoteStoreListen=iM.bind(null,t.syncEngine),r.onLastRemoteStoreUnlisten=cM.bind(null,t.syncEngine),r}function wM(e,t,r={}){const n=new oa;return e.asyncQueue.enqueueAndForget(async()=>function(a,i,o,l,c){const u=new Fx({next:m=>{u.Za(),i.enqueueAndForget(()=>Rx(a,d));const p=m.docs.has(o);!p&&m.fromCache?c.reject(new Re(pe.UNAVAILABLE,"Failed to get document because the client is offline.")):p&&m.fromCache&&l&&l.source==="server"?c.reject(new Re(pe.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):c.resolve(m)},error:m=>c.reject(m)}),d=new Px(Ld(o.path),u,{includeMetadataChanges:!0,_a:!0});return Nx(a,d)}(await Yh(e),e.asyncQueue,t,r,n)),n.promise}function EM(e,t,r={}){const n=new oa;return e.asyncQueue.enqueueAndForget(async()=>function(a,i,o,l,c){const u=new Fx({next:m=>{u.Za(),i.enqueueAndForget(()=>Rx(a,d)),m.fromCache&&l.source==="server"?c.reject(new Re(pe.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):c.resolve(m)},error:m=>c.reject(m)}),d=new Px(o,u,{includeMetadataChanges:!0,_a:!0});return Nx(a,d)}(await Yh(e),e.asyncQueue,t,r,n)),n.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function NS(e){const t={};return e.timeoutSeconds!==void 0&&(t.timeoutSeconds=e.timeoutSeconds),t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const R_=new Map;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function RS(e,t,r){if(!r)throw new Re(pe.INVALID_ARGUMENT,`Function ${e}() cannot be called with an empty ${t}.`)}function TM(e,t,r,n){if(t===!0&&n===!0)throw new Re(pe.INVALID_ARGUMENT,`${e} and ${r} cannot be used together.`)}function b_(e){if(!Pe.isDocumentKey(e))throw new Re(pe.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${e} has ${e.length}.`)}function P_(e){if(Pe.isDocumentKey(e))throw new Re(pe.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${e} has ${e.length}.`)}function Gd(e){if(e===void 0)return"undefined";if(e===null)return"null";if(typeof e=="string")return e.length>20&&(e=`${e.substring(0,20)}...`),JSON.stringify(e);if(typeof e=="number"||typeof e=="boolean")return""+e;if(typeof e=="object"){if(e instanceof Array)return"an array";{const t=function(n){return n.constructor?n.constructor.name:null}(e);return t?`a custom ${t} object`:"an object"}}return typeof e=="function"?"a function":Le()}function pn(e,t){if("_delegate"in e&&(e=e._delegate),!(e instanceof t)){if(t.name===e.constructor.name)throw new Re(pe.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const r=Gd(e);throw new Re(pe.INVALID_ARGUMENT,`Expected type '${t.name}', but it was: ${r}`)}}return e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class D_{constructor(t){var r,n;if(t.host===void 0){if(t.ssl!==void 0)throw new Re(pe.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=t.host,this.ssl=(r=t.ssl)===null||r===void 0||r;if(this.credentials=t.credentials,this.ignoreUndefinedProperties=!!t.ignoreUndefinedProperties,this.localCache=t.localCache,t.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(t.cacheSizeBytes!==-1&&t.cacheSizeBytes<1048576)throw new Re(pe.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=t.cacheSizeBytes}TM("experimentalForceLongPolling",t.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",t.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!t.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:t.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!t.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=NS((n=t.experimentalLongPollingOptions)!==null&&n!==void 0?n:{}),function(a){if(a.timeoutSeconds!==void 0){if(isNaN(a.timeoutSeconds))throw new Re(pe.INVALID_ARGUMENT,`invalid long polling timeout: ${a.timeoutSeconds} (must not be NaN)`);if(a.timeoutSeconds<5)throw new Re(pe.INVALID_ARGUMENT,`invalid long polling timeout: ${a.timeoutSeconds} (minimum allowed value is 5)`);if(a.timeoutSeconds>30)throw new Re(pe.INVALID_ARGUMENT,`invalid long polling timeout: ${a.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!t.useFetchStreams}isEqual(t){return this.host===t.host&&this.ssl===t.ssl&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.experimentalForceLongPolling===t.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===t.experimentalAutoDetectLongPolling&&function(n,s){return n.timeoutSeconds===s.timeoutSeconds}(this.experimentalLongPollingOptions,t.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties&&this.useFetchStreams===t.useFetchStreams}}class Kd{constructor(t,r,n,s){this._authCredentials=t,this._appCheckCredentials=r,this._databaseId=n,this._app=s,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new D_({}),this._settingsFrozen=!1,this._terminateTask="notTerminated"}get app(){if(!this._app)throw new Re(pe.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(t){if(this._settingsFrozen)throw new Re(pe.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new D_(t),t.credentials!==void 0&&(this._authCredentials=function(n){if(!n)return new z3;switch(n.type){case"firstParty":return new G3(n.sessionIndex||"0",n.iamToken||null,n.authTokenFactory||null);case"provider":return n.client;default:throw new Re(pe.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(t.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(r){const n=R_.get(r);n&&(be("ComponentProvider","Removing Datastore"),R_.delete(r),n.terminate())}(this),Promise.resolve()}}function kM(e,t,r,n={}){var s;const a=(e=pn(e,Kd))._getSettings(),i=`${t}:${r}`;if(a.host!=="firestore.googleapis.com"&&a.host!==i&&cl("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),e._setSettings(Object.assign(Object.assign({},a),{host:i,ssl:!1})),n.mockUserToken){let o,l;if(typeof n.mockUserToken=="string")o=n.mockUserToken,l=Mr.MOCK_USER;else{o=MT(n.mockUserToken,(s=e._app)===null||s===void 0?void 0:s.options.projectId);const c=n.mockUserToken.sub||n.mockUserToken.user_id;if(!c)throw new Re(pe.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");l=new Mr(c)}e._authCredentials=new $3(new Ck(o,l))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ao{constructor(t,r,n){this.converter=r,this._query=n,this.type="query",this.firestore=t}withConverter(t){return new ao(this.firestore,t,this._query)}}class zr{constructor(t,r,n){this.converter=r,this._key=n,this.type="document",this.firestore=t}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new ni(this.firestore,this.converter,this._key.path.popLast())}withConverter(t){return new zr(this.firestore,t,this._key)}}class ni extends ao{constructor(t,r,n){super(t,r,Ld(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const t=this._path.popLast();return t.isEmpty()?null:new zr(this.firestore,null,new Pe(t))}withConverter(t){return new ni(this.firestore,t,this._path)}}function Gt(e,t,...r){if(e=Kt(e),RS("collection","path",t),e instanceof Kd){const n=Ct.fromString(t,...r);return P_(n),new ni(e,null,n)}{if(!(e instanceof zr||e instanceof ni))throw new Re(pe.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=e._path.child(Ct.fromString(t,...r));return P_(n),new ni(e.firestore,null,n)}}function Bt(e,t,...r){if(e=Kt(e),arguments.length===1&&(t=Nk.newId()),RS("doc","path",t),e instanceof Kd){const n=Ct.fromString(t,...r);return b_(n),new zr(e,null,new Pe(n))}{if(!(e instanceof zr||e instanceof ni))throw new Re(pe.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=e._path.child(Ct.fromString(t,...r));return b_(n),new zr(e.firestore,e instanceof ni?e.converter:null,new Pe(n))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class F_{constructor(t=Promise.resolve()){this.Pu=[],this.Iu=!1,this.Tu=[],this.Eu=null,this.du=!1,this.Au=!1,this.Ru=[],this.t_=new hS(this,"async_queue_retry"),this.Vu=()=>{const n=Y0();n&&be("AsyncQueue","Visibility state changed to "+n.visibilityState),this.t_.jo()},this.mu=t;const r=Y0();r&&typeof r.addEventListener=="function"&&r.addEventListener("visibilitychange",this.Vu)}get isShuttingDown(){return this.Iu}enqueueAndForget(t){this.enqueue(t)}enqueueAndForgetEvenWhileRestricted(t){this.fu(),this.gu(t)}enterRestrictedMode(t){if(!this.Iu){this.Iu=!0,this.Au=t||!1;const r=Y0();r&&typeof r.removeEventListener=="function"&&r.removeEventListener("visibilitychange",this.Vu)}}enqueue(t){if(this.fu(),this.Iu)return new Promise(()=>{});const r=new oa;return this.gu(()=>this.Iu&&this.Au?Promise.resolve():(t().then(r.resolve,r.reject),r.promise)).then(()=>r.promise)}enqueueRetryable(t){this.enqueueAndForget(()=>(this.Pu.push(t),this.pu()))}async pu(){if(this.Pu.length!==0){try{await this.Pu[0](),this.Pu.shift(),this.t_.reset()}catch(t){if(!bu(t))throw t;be("AsyncQueue","Operation failed with retryable error: "+t)}this.Pu.length>0&&this.t_.Go(()=>this.pu())}}gu(t){const r=this.mu.then(()=>(this.du=!0,t().catch(n=>{this.Eu=n,this.du=!1;const s=function(i){let o=i.message||"";return i.stack&&(o=i.stack.includes(i.message)?i.stack:i.message+`
`+i.stack),o}(n);throw va("INTERNAL UNHANDLED ERROR: ",s),n}).then(n=>(this.du=!1,n))));return this.mu=r,r}enqueueAfterDelay(t,r,n){this.fu(),this.Ru.indexOf(t)>-1&&(r=0);const s=Ix.createAndSchedule(this,t,r,n,a=>this.yu(a));return this.Tu.push(s),s}fu(){this.Eu&&Le()}verifyOperationInProgress(){}async wu(){let t;do t=this.mu,await t;while(t!==this.mu)}Su(t){for(const r of this.Tu)if(r.timerId===t)return!0;return!1}bu(t){return this.wu().then(()=>{this.Tu.sort((r,n)=>r.targetTimeMs-n.targetTimeMs);for(const r of this.Tu)if(r.skipDelay(),t!=="all"&&r.timerId===t)break;return this.wu()})}Du(t){this.Ru.push(t)}yu(t){const r=this.Tu.indexOf(t);this.Tu.splice(r,1)}}function O_(e){return function(r,n){if(typeof r!="object"||r===null)return!1;const s=r;for(const a of n)if(a in s&&typeof s[a]=="function")return!0;return!1}(e,["next","error","complete"])}class _a extends Kd{constructor(t,r,n,s){super(t,r,n,s),this.type="firestore",this._queue=new F_,this._persistenceKey=(s==null?void 0:s.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const t=this._firestoreClient.terminate();this._queue=new F_(t),this._firestoreClient=void 0,await t}}}function SM(e,t){const r=typeof e=="object"?e:Pd(),n=typeof e=="string"?e:"(default)",s=Au(r,"firestore").getImmediate({identifier:n});if(!s._initialized){const a=qg("firestore");a&&kM(s,...a)}return s}function qd(e){if(e._terminated)throw new Re(pe.FAILED_PRECONDITION,"The client has already been terminated.");return e._firestoreClient||AM(e),e._firestoreClient}function AM(e){var t,r,n;const s=e._freezeSettings(),a=function(o,l,c,u){return new aF(o,l,c,u.host,u.ssl,u.experimentalForceLongPolling,u.experimentalAutoDetectLongPolling,NS(u.experimentalLongPollingOptions),u.useFetchStreams)}(e._databaseId,((t=e._app)===null||t===void 0?void 0:t.options.appId)||"",e._persistenceKey,s);e._componentsProvider||!((r=s.localCache)===null||r===void 0)&&r._offlineComponentProvider&&(!((n=s.localCache)===null||n===void 0)&&n._onlineComponentProvider)&&(e._componentsProvider={_offline:s.localCache._offlineComponentProvider,_online:s.localCache._onlineComponentProvider}),e._firestoreClient=new vM(e._authCredentials,e._appCheckCredentials,e._queue,a,e._componentsProvider&&function(o){const l=o==null?void 0:o._online.build();return{_offline:o==null?void 0:o._offline.build(l),_online:l}}(e._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pl{constructor(t){this._byteString=t}static fromBase64String(t){try{return new pl(Cr.fromBase64String(t))}catch(r){throw new Re(pe.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+r)}}static fromUint8Array(t){return new pl(Cr.fromUint8Array(t))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(t){return this._byteString.isEqual(t._byteString)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xd{constructor(...t){for(let r=0;r<t.length;++r)if(t[r].length===0)throw new Re(pe.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Er(t)}isEqual(t){return this._internalPath.isEqual(t._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lu{constructor(t){this._methodName=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ox{constructor(t,r){if(!isFinite(t)||t<-90||t>90)throw new Re(pe.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(r)||r<-180||r>180)throw new Re(pe.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+r);this._lat=t,this._long=r}get latitude(){return this._lat}get longitude(){return this._long}isEqual(t){return this._lat===t._lat&&this._long===t._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(t){return ut(this._lat,t._lat)||ut(this._long,t._long)}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mx{constructor(t){this._values=(t||[]).map(r=>r)}toArray(){return this._values.map(t=>t)}isEqual(t){return function(n,s){if(n.length!==s.length)return!1;for(let a=0;a<n.length;++a)if(n[a]!==s[a])return!1;return!0}(this._values,t._values)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const IM=/^__.*__$/;class CM{constructor(t,r,n){this.data=t,this.fieldMask=r,this.fieldTransforms=n}toMutation(t,r){return this.fieldMask!==null?new vi(t,this.data,this.fieldMask,r,this.fieldTransforms):new Du(t,this.data,r,this.fieldTransforms)}}class bS{constructor(t,r,n){this.data=t,this.fieldMask=r,this.fieldTransforms=n}toMutation(t,r){return new vi(t,this.data,this.fieldMask,r,this.fieldTransforms)}}function PS(e){switch(e){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Le()}}class Lx{constructor(t,r,n,s,a,i){this.settings=t,this.databaseId=r,this.serializer=n,this.ignoreUndefinedProperties=s,a===void 0&&this.vu(),this.fieldTransforms=a||[],this.fieldMask=i||[]}get path(){return this.settings.path}get Cu(){return this.settings.Cu}Fu(t){return new Lx(Object.assign(Object.assign({},this.settings),t),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Mu(t){var r;const n=(r=this.path)===null||r===void 0?void 0:r.child(t),s=this.Fu({path:n,xu:!1});return s.Ou(t),s}Nu(t){var r;const n=(r=this.path)===null||r===void 0?void 0:r.child(t),s=this.Fu({path:n,xu:!1});return s.vu(),s}Lu(t){return this.Fu({path:void 0,xu:!0})}Bu(t){return Qh(t,this.settings.methodName,this.settings.ku||!1,this.path,this.settings.qu)}contains(t){return this.fieldMask.find(r=>t.isPrefixOf(r))!==void 0||this.fieldTransforms.find(r=>t.isPrefixOf(r.field))!==void 0}vu(){if(this.path)for(let t=0;t<this.path.length;t++)this.Ou(this.path.get(t))}Ou(t){if(t.length===0)throw this.Bu("Document fields must not be empty");if(PS(this.Cu)&&IM.test(t))throw this.Bu('Document fields cannot begin and end with "__"')}}class NM{constructor(t,r,n){this.databaseId=t,this.ignoreUndefinedProperties=r,this.serializer=n||$d(t)}Qu(t,r,n,s=!1){return new Lx({Cu:t,methodName:r,qu:n,path:Er.emptyPath(),xu:!1,ku:s},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function Yd(e){const t=e._freezeSettings(),r=$d(e._databaseId);return new NM(e._databaseId,!!t.ignoreUndefinedProperties,r)}function DS(e,t,r,n,s,a={}){const i=e.Qu(a.merge||a.mergeFields?2:0,t,r,s);Vx("Data must be an object, but it was:",i,n);const o=FS(n,i);let l,c;if(a.merge)l=new Tn(i.fieldMask),c=i.fieldTransforms;else if(a.mergeFields){const u=[];for(const d of a.mergeFields){const m=Rp(t,d,r);if(!i.contains(m))throw new Re(pe.INVALID_ARGUMENT,`Field '${m}' is specified in your field mask but missing from your input data.`);MS(u,m)||u.push(m)}l=new Tn(u),c=i.fieldTransforms.filter(d=>l.covers(d.field))}else l=null,c=i.fieldTransforms;return new CM(new un(o),l,c)}class Qd extends Lu{_toFieldTransform(t){if(t.Cu!==2)throw t.Cu===1?t.Bu(`${this._methodName}() can only appear at the top level of your update data`):t.Bu(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return t.fieldMask.push(t.path),null}isEqual(t){return t instanceof Qd}}class jx extends Lu{_toFieldTransform(t){return new Qk(t.path,new su)}isEqual(t){return t instanceof jx}}class Ux extends Lu{constructor(t,r){super(t),this.$u=r}_toFieldTransform(t){const r=new ou(t.serializer,Gk(t.serializer,this.$u));return new Qk(t.path,r)}isEqual(t){return t instanceof Ux&&this.$u===t.$u}}function RM(e,t,r,n){const s=e.Qu(1,t,r);Vx("Data must be an object, but it was:",s,n);const a=[],i=un.empty();no(n,(l,c)=>{const u=Bx(t,l,r);c=Kt(c);const d=s.Nu(u);if(c instanceof Qd)a.push(u);else{const m=ju(c,d);m!=null&&(a.push(u),i.set(u,m))}});const o=new Tn(a);return new bS(i,o,s.fieldTransforms)}function bM(e,t,r,n,s,a){const i=e.Qu(1,t,r),o=[Rp(t,n,r)],l=[s];if(a.length%2!=0)throw new Re(pe.INVALID_ARGUMENT,`Function ${t}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let m=0;m<a.length;m+=2)o.push(Rp(t,a[m])),l.push(a[m+1]);const c=[],u=un.empty();for(let m=o.length-1;m>=0;--m)if(!MS(c,o[m])){const p=o[m];let x=l[m];x=Kt(x);const g=i.Nu(p);if(x instanceof Qd)c.push(p);else{const _=ju(x,g);_!=null&&(c.push(p),u.set(p,_))}}const d=new Tn(c);return new bS(u,d,i.fieldTransforms)}function PM(e,t,r,n=!1){return ju(r,e.Qu(n?4:3,t))}function ju(e,t){if(OS(e=Kt(e)))return Vx("Unsupported field value:",t,e),FS(e,t);if(e instanceof Lu)return function(n,s){if(!PS(s.Cu))throw s.Bu(`${n._methodName}() can only be used with update() and set()`);if(!s.path)throw s.Bu(`${n._methodName}() is not currently supported inside arrays`);const a=n._toFieldTransform(s);a&&s.fieldTransforms.push(a)}(e,t),null;if(e===void 0&&t.ignoreUndefinedProperties)return null;if(t.path&&t.fieldMask.push(t.path),e instanceof Array){if(t.settings.xu&&t.Cu!==4)throw t.Bu("Nested arrays are not supported");return function(n,s){const a=[];let i=0;for(const o of n){let l=ju(o,s.Lu(i));l==null&&(l={nullValue:"NULL_VALUE"}),a.push(l),i++}return{arrayValue:{values:a}}}(e,t)}return function(n,s){if((n=Kt(n))===null)return{nullValue:"NULL_VALUE"};if(typeof n=="number")return Gk(s.serializer,n);if(typeof n=="boolean")return{booleanValue:n};if(typeof n=="string")return{stringValue:n};if(n instanceof Date){const a=or.fromDate(n);return{timestampValue:Kh(s.serializer,a)}}if(n instanceof or){const a=new or(n.seconds,1e3*Math.floor(n.nanoseconds/1e3));return{timestampValue:Kh(s.serializer,a)}}if(n instanceof Ox)return{geoPointValue:{latitude:n.latitude,longitude:n.longitude}};if(n instanceof pl)return{bytesValue:nS(s.serializer,n._byteString)};if(n instanceof zr){const a=s.databaseId,i=n.firestore._databaseId;if(!i.isEqual(a))throw s.Bu(`Document reference is for database ${i.projectId}/${i.database} but should be for database ${a.projectId}/${a.database}`);return{referenceValue:yx(n.firestore._databaseId||s.databaseId,n._key.path)}}if(n instanceof Mx)return function(i,o){return{mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{values:i.toArray().map(l=>{if(typeof l!="number")throw o.Bu("VectorValues must only contain numeric values.");return px(o.serializer,l)})}}}}}}(n,s);throw s.Bu(`Unsupported field value: ${Gd(n)}`)}(e,t)}function FS(e,t){const r={};return Rk(e)?t.path&&t.path.length>0&&t.fieldMask.push(t.path):no(e,(n,s)=>{const a=ju(s,t.Mu(n));a!=null&&(r[n]=a)}),{mapValue:{fields:r}}}function OS(e){return!(typeof e!="object"||e===null||e instanceof Array||e instanceof Date||e instanceof or||e instanceof Ox||e instanceof pl||e instanceof zr||e instanceof Lu||e instanceof Mx)}function Vx(e,t,r){if(!OS(r)||!function(s){return typeof s=="object"&&s!==null&&(Object.getPrototypeOf(s)===Object.prototype||Object.getPrototypeOf(s)===null)}(r)){const n=Gd(r);throw n==="an object"?t.Bu(e+" a custom object"):t.Bu(e+" "+n)}}function Rp(e,t,r){if((t=Kt(t))instanceof Xd)return t._internalPath;if(typeof t=="string")return Bx(e,t);throw Qh("Field path arguments must be of type string or ",e,!1,void 0,r)}const DM=new RegExp("[~\\*/\\[\\]]");function Bx(e,t,r){if(t.search(DM)>=0)throw Qh(`Invalid field path (${t}). Paths must not contain '~', '*', '/', '[', or ']'`,e,!1,void 0,r);try{return new Xd(...t.split("."))._internalPath}catch{throw Qh(`Invalid field path (${t}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,e,!1,void 0,r)}}function Qh(e,t,r,n,s){const a=n&&!n.isEmpty(),i=s!==void 0;let o=`Function ${t}() called with invalid data`;r&&(o+=" (via `toFirestore()`)"),o+=". ";let l="";return(a||i)&&(l+=" (found",a&&(l+=` in field ${n}`),i&&(l+=` in document ${s}`),l+=")"),new Re(pe.INVALID_ARGUMENT,o+e+l)}function MS(e,t){return e.some(r=>r.isEqual(t))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class LS{constructor(t,r,n,s,a){this._firestore=t,this._userDataWriter=r,this._key=n,this._document=s,this._converter=a}get id(){return this._key.path.lastSegment()}get ref(){return new zr(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const t=new FM(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(t)}return this._userDataWriter.convertValue(this._document.data.value)}}get(t){if(this._document){const r=this._document.data.field(zx("DocumentSnapshot.get",t));if(r!==null)return this._userDataWriter.convertValue(r)}}}class FM extends LS{data(){return super.data()}}function zx(e,t){return typeof t=="string"?Bx(e,t):t instanceof Xd?t._internalPath:t._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jS(e){if(e.limitType==="L"&&e.explicitOrderBy.length===0)throw new Re(pe.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class $x{}class OM extends $x{}function Ns(e,t,...r){let n=[];t instanceof $x&&n.push(t),n=n.concat(r),function(a){const i=a.filter(l=>l instanceof Wx).length,o=a.filter(l=>l instanceof Jd).length;if(i>1||i>0&&o>0)throw new Re(pe.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(n);for(const s of n)e=s._apply(e);return e}class Jd extends OM{constructor(t,r,n){super(),this._field=t,this._op=r,this._value=n,this.type="where"}static _create(t,r,n){return new Jd(t,r,n)}_apply(t){const r=this._parse(t);return US(t._query,r),new ao(t.firestore,t.converter,_p(t._query,r))}_parse(t){const r=Yd(t.firestore);return function(a,i,o,l,c,u,d){let m;if(c.isKeyField()){if(u==="array-contains"||u==="array-contains-any")throw new Re(pe.INVALID_ARGUMENT,`Invalid Query. You can't perform '${u}' queries on documentId().`);if(u==="in"||u==="not-in"){L_(d,u);const p=[];for(const x of d)p.push(M_(l,a,x));m={arrayValue:{values:p}}}else m=M_(l,a,d)}else u!=="in"&&u!=="not-in"&&u!=="array-contains-any"||L_(d,u),m=PM(o,i,d,u==="in"||u==="not-in");return tr.create(c,u,m)}(t._query,"where",r,t.firestore._databaseId,this._field,this._op,this._value)}}function zn(e,t,r){const n=t,s=zx("where",e);return Jd._create(s,n,r)}class Wx extends $x{constructor(t,r){super(),this.type=t,this._queryConstraints=r}static _create(t,r){return new Wx(t,r)}_parse(t){const r=this._queryConstraints.map(n=>n._parse(t)).filter(n=>n.getFilters().length>0);return r.length===1?r[0]:ds.create(r,this._getOperator())}_apply(t){const r=this._parse(t);return r.getFilters().length===0?t:(function(s,a){let i=s;const o=a.getFlattenedFilters();for(const l of o)US(i,l),i=_p(i,l)}(t._query,r),new ao(t.firestore,t.converter,_p(t._query,r)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}function M_(e,t,r){if(typeof(r=Kt(r))=="string"){if(r==="")throw new Re(pe.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!Uk(t)&&r.indexOf("/")!==-1)throw new Re(pe.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${r}' contains a '/' character.`);const n=t.path.child(Ct.fromString(r));if(!Pe.isDocumentKey(n))throw new Re(pe.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${n}' is not because it has an odd number of segments (${n.length}).`);return n_(e,new Pe(n))}if(r instanceof zr)return n_(e,r._key);throw new Re(pe.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${Gd(r)}.`)}function L_(e,t){if(!Array.isArray(e)||e.length===0)throw new Re(pe.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${t.toString()}' filters.`)}function US(e,t){const r=function(s,a){for(const i of s)for(const o of i.getFlattenedFilters())if(a.indexOf(o.op)>=0)return o.op;return null}(e.filters,function(s){switch(s){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(t.op));if(r!==null)throw r===t.op?new Re(pe.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${t.op.toString()}' filter.`):new Re(pe.INVALID_ARGUMENT,`Invalid query. You cannot use '${t.op.toString()}' filters with '${r.toString()}' filters.`)}class MM{convertValue(t,r="none"){switch(Yi(t)){case 0:return null;case 1:return t.booleanValue;case 2:return Wt(t.integerValue||t.doubleValue);case 3:return this.convertTimestamp(t.timestampValue);case 4:return this.convertServerTimestamp(t,r);case 5:return t.stringValue;case 6:return this.convertBytes(Xi(t.bytesValue));case 7:return this.convertReference(t.referenceValue);case 8:return this.convertGeoPoint(t.geoPointValue);case 9:return this.convertArray(t.arrayValue,r);case 11:return this.convertObject(t.mapValue,r);case 10:return this.convertVectorValue(t.mapValue);default:throw Le()}}convertObject(t,r){return this.convertObjectMap(t.fields,r)}convertObjectMap(t,r="none"){const n={};return no(t,(s,a)=>{n[s]=this.convertValue(a,r)}),n}convertVectorValue(t){var r,n,s;const a=(s=(n=(r=t.fields)===null||r===void 0?void 0:r.value.arrayValue)===null||n===void 0?void 0:n.values)===null||s===void 0?void 0:s.map(i=>Wt(i.doubleValue));return new Mx(a)}convertGeoPoint(t){return new Ox(Wt(t.latitude),Wt(t.longitude))}convertArray(t,r){return(t.values||[]).map(n=>this.convertValue(n,r))}convertServerTimestamp(t,r){switch(r){case"previous":const n=fx(t);return n==null?null:this.convertValue(n,r);case"estimate":return this.convertTimestamp(tu(t));default:return null}}convertTimestamp(t){const r=ci(t);return new or(r.seconds,r.nanos)}convertDocumentKey(t,r){const n=Ct.fromString(t);xt(cS(n));const s=new ru(n.get(1),n.get(3)),a=new Pe(n.popFirst(5));return s.isEqual(r)||va(`Document ${a} contains a document reference within a different database (${s.projectId}/${s.database}) which is not supported. It will be treated as a reference in the current database (${r.projectId}/${r.database}) instead.`),a}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function VS(e,t,r){let n;return n=e?r&&(r.merge||r.mergeFields)?e.toFirestore(t,r):e.toFirestore(t):t,n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sc{constructor(t,r){this.hasPendingWrites=t,this.fromCache=r}isEqual(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache}}class BS extends LS{constructor(t,r,n,s,a,i){super(t,r,n,s,i),this._firestore=t,this._firestoreImpl=t,this.metadata=a}exists(){return super.exists()}data(t={}){if(this._document){if(this._converter){const r=new ih(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(r,t)}return this._userDataWriter.convertValue(this._document.data.value,t.serverTimestamps)}}get(t,r={}){if(this._document){const n=this._document.data.field(zx("DocumentSnapshot.get",t));if(n!==null)return this._userDataWriter.convertValue(n,r.serverTimestamps)}}}class ih extends BS{data(t={}){return super.data(t)}}class zS{constructor(t,r,n,s){this._firestore=t,this._userDataWriter=r,this._snapshot=s,this.metadata=new sc(s.hasPendingWrites,s.fromCache),this.query=n}get docs(){const t=[];return this.forEach(r=>t.push(r)),t}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(t,r){this._snapshot.docs.forEach(n=>{t.call(r,new ih(this._firestore,this._userDataWriter,n.key,n,new sc(this._snapshot.mutatedKeys.has(n.key),this._snapshot.fromCache),this.query.converter))})}docChanges(t={}){const r=!!t.includeMetadataChanges;if(r&&this._snapshot.excludesMetadataChanges)throw new Re(pe.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===r||(this._cachedChanges=function(s,a){if(s._snapshot.oldDocs.isEmpty()){let i=0;return s._snapshot.docChanges.map(o=>{const l=new ih(s._firestore,s._userDataWriter,o.doc.key,o.doc,new sc(s._snapshot.mutatedKeys.has(o.doc.key),s._snapshot.fromCache),s.query.converter);return o.doc,{type:"added",doc:l,oldIndex:-1,newIndex:i++}})}{let i=s._snapshot.oldDocs;return s._snapshot.docChanges.filter(o=>a||o.type!==3).map(o=>{const l=new ih(s._firestore,s._userDataWriter,o.doc.key,o.doc,new sc(s._snapshot.mutatedKeys.has(o.doc.key),s._snapshot.fromCache),s.query.converter);let c=-1,u=-1;return o.type!==0&&(c=i.indexOf(o.doc.key),i=i.delete(o.doc.key)),o.type!==1&&(i=i.add(o.doc),u=i.indexOf(o.doc.key)),{type:LM(o.type),doc:l,oldIndex:c,newIndex:u}})}}(this,r),this._cachedChangesIncludeMetadataChanges=r),this._cachedChanges}}function LM(e){switch(e){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Le()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $n(e){e=pn(e,zr);const t=pn(e.firestore,_a);return wM(qd(t),e._key).then(r=>$S(t,e,r))}class Hx extends MM{constructor(t){super(),this.firestore=t}convertBytes(t){return new pl(t)}convertReference(t){const r=this.convertDocumentKey(t,this.firestore._databaseId);return new zr(this.firestore,null,r)}}function lr(e){e=pn(e,ao);const t=pn(e.firestore,_a),r=qd(t),n=new Hx(t);return jS(e._query),EM(r,e._query).then(s=>new zS(t,n,e,s))}function Ps(e,t,r){e=pn(e,zr);const n=pn(e.firestore,_a),s=VS(e.converter,t,r);return e0(n,[DS(Yd(n),"setDoc",e._key,s,e.converter!==null,r).toMutation(e._key,Bn.none())])}function fi(e,t,r,...n){e=pn(e,zr);const s=pn(e.firestore,_a),a=Yd(s);let i;return i=typeof(t=Kt(t))=="string"||t instanceof Xd?bM(a,"updateDoc",e._key,t,r,n):RM(a,"updateDoc",e._key,t),e0(s,[i.toMutation(e._key,Bn.exists(!0))])}function jM(e){return e0(pn(e.firestore,_a),[new gx(e._key,Bn.none())])}function Zd(e,t){const r=pn(e.firestore,_a),n=Bt(e),s=VS(e.converter,t);return e0(r,[DS(Yd(e.firestore),"addDoc",n._key,s,e.converter!==null,{}).toMutation(n._key,Bn.exists(!1))]).then(()=>n)}function UM(e,...t){var r,n,s;e=Kt(e);let a={includeMetadataChanges:!1,source:"default"},i=0;typeof t[i]!="object"||O_(t[i])||(a=t[i],i++);const o={includeMetadataChanges:a.includeMetadataChanges,source:a.source};if(O_(t[i])){const d=t[i];t[i]=(r=d.next)===null||r===void 0?void 0:r.bind(d),t[i+1]=(n=d.error)===null||n===void 0?void 0:n.bind(d),t[i+2]=(s=d.complete)===null||s===void 0?void 0:s.bind(d)}let l,c,u;if(e instanceof zr)c=pn(e.firestore,_a),u=Ld(e._key.path),l={next:d=>{t[i]&&t[i]($S(c,e,d))},error:t[i+1],complete:t[i+2]};else{const d=pn(e,ao);c=pn(d.firestore,_a),u=d._query;const m=new Hx(c);l={next:p=>{t[i]&&t[i](new zS(c,m,d,p))},error:t[i+1],complete:t[i+2]},jS(e._query)}return function(m,p,x,g){const _=new Fx(g),k=new Px(p,_,x);return m.asyncQueue.enqueueAndForget(async()=>Nx(await Yh(m),k)),()=>{_.Za(),m.asyncQueue.enqueueAndForget(async()=>Rx(await Yh(m),k))}}(qd(c),u,o,l)}function e0(e,t){return function(n,s){const a=new oa;return n.asyncQueue.enqueueAndForget(async()=>uM(await _M(n),s,a)),a.promise}(qd(e),t)}function $S(e,t,r){const n=r.docs.get(t._key),s=new Hx(e);return new BS(e,s,t._key,n,new sc(r.hasPendingWrites,r.fromCache),t.converter)}function VM(){return new jx("serverTimestamp")}function BM(e){return new Ux("increment",e)}(function(t,r=!0){(function(s){Tl=s})(ro),oi(new pa("firestore",(n,{instanceIdentifier:s,options:a})=>{const i=n.getProvider("app").getImmediate(),o=new _a(new W3(n.getProvider("auth-internal")),new q3(n.getProvider("app-check-internal")),function(c,u){if(!Object.prototype.hasOwnProperty.apply(c.options,["projectId"]))throw new Re(pe.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new ru(c.options.projectId,u)}(i,s),i);return a=Object.assign({useFetchStreams:r},a),o._setSettings(a),o},"PUBLIC").setMultipleInstances(!0)),Vn(Jy,"4.7.3",t),Vn(Jy,"4.7.3","esm2017")})();var zM="firebase",$M="10.14.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Vn(zM,$M,"app");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const WS="firebasestorage.googleapis.com",WM="storageBucket",HM=2*60*1e3,GM=10*60*1e3;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Us extends js{constructor(t,r,n=0){super(J0(t),`Firebase Storage: ${r} (${J0(t)})`),this.status_=n,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,Us.prototype)}get status(){return this.status_}set status(t){this.status_=t}_codeEquals(t){return J0(t)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(t){this.customData.serverResponse=t,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}var Ds;(function(e){e.UNKNOWN="unknown",e.OBJECT_NOT_FOUND="object-not-found",e.BUCKET_NOT_FOUND="bucket-not-found",e.PROJECT_NOT_FOUND="project-not-found",e.QUOTA_EXCEEDED="quota-exceeded",e.UNAUTHENTICATED="unauthenticated",e.UNAUTHORIZED="unauthorized",e.UNAUTHORIZED_APP="unauthorized-app",e.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",e.INVALID_CHECKSUM="invalid-checksum",e.CANCELED="canceled",e.INVALID_EVENT_NAME="invalid-event-name",e.INVALID_URL="invalid-url",e.INVALID_DEFAULT_BUCKET="invalid-default-bucket",e.NO_DEFAULT_BUCKET="no-default-bucket",e.CANNOT_SLICE_BLOB="cannot-slice-blob",e.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",e.NO_DOWNLOAD_URL="no-download-url",e.INVALID_ARGUMENT="invalid-argument",e.INVALID_ARGUMENT_COUNT="invalid-argument-count",e.APP_DELETED="app-deleted",e.INVALID_ROOT_OPERATION="invalid-root-operation",e.INVALID_FORMAT="invalid-format",e.INTERNAL_ERROR="internal-error",e.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})(Ds||(Ds={}));function J0(e){return"storage/"+e}function KM(){const e="An unknown error occurred, please check the error payload for server response.";return new Us(Ds.UNKNOWN,e)}function qM(){return new Us(Ds.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function XM(){return new Us(Ds.CANCELED,"User canceled the upload/download.")}function YM(e){return new Us(Ds.INVALID_URL,"Invalid URL '"+e+"'.")}function QM(e){return new Us(Ds.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+e+"'.")}function j_(e){return new Us(Ds.INVALID_ARGUMENT,e)}function HS(){return new Us(Ds.APP_DELETED,"The Firebase app was deleted.")}function JM(e){return new Us(Ds.INVALID_ROOT_OPERATION,"The operation '"+e+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class as{constructor(t,r){this.bucket=t,this.path_=r}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const t=encodeURIComponent;return"/b/"+t(this.bucket)+"/o/"+t(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(t,r){let n;try{n=as.makeFromUrl(t,r)}catch{return new as(t,"")}if(n.path==="")return n;throw QM(t)}static makeFromUrl(t,r){let n=null;const s="([A-Za-z0-9.\\-_]+)";function a(C){C.path.charAt(C.path.length-1)==="/"&&(C.path_=C.path_.slice(0,-1))}const i="(/(.*))?$",o=new RegExp("^gs://"+s+i,"i"),l={bucket:1,path:3};function c(C){C.path_=decodeURIComponent(C.path)}const u="v[A-Za-z0-9_]+",d=r.replace(/[.]/g,"\\."),m="(/([^?#]*).*)?$",p=new RegExp(`^https?://${d}/${u}/b/${s}/o${m}`,"i"),x={bucket:1,path:3},g=r===WS?"(?:storage.googleapis.com|storage.cloud.google.com)":r,_="([^?#]*)",k=new RegExp(`^https?://${g}/${s}/${_}`,"i"),w=[{regex:o,indices:l,postModify:a},{regex:p,indices:x,postModify:c},{regex:k,indices:{bucket:1,path:2},postModify:c}];for(let C=0;C<w.length;C++){const M=w[C],O=M.regex.exec(t);if(O){const v=O[M.indices.bucket];let E=O[M.indices.path];E||(E=""),n=new as(v,E),M.postModify(n);break}}if(n==null)throw YM(t);return n}}class ZM{constructor(t){this.promise_=Promise.reject(t)}getPromise(){return this.promise_}cancel(t=!1){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function eL(e,t,r){let n=1,s=null,a=null,i=!1,o=0;function l(){return o===2}let c=!1;function u(..._){c||(c=!0,t.apply(null,_))}function d(_){s=setTimeout(()=>{s=null,e(p,l())},_)}function m(){a&&clearTimeout(a)}function p(_,...k){if(c){m();return}if(_){m(),u.call(null,_,...k);return}if(l()||i){m(),u.call(null,_,...k);return}n<64&&(n*=2);let w;o===1?(o=2,w=0):w=(n+Math.random())*1e3,d(w)}let x=!1;function g(_){x||(x=!0,m(),!c&&(s!==null?(_||(o=2),clearTimeout(s),d(0)):_||(o=1)))}return d(0),a=setTimeout(()=>{i=!0,g(!0)},r),g}function tL(e){e(!1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rL(e){return e!==void 0}function U_(e,t,r,n){if(n<t)throw j_(`Invalid value for '${e}'. Expected ${t} or greater.`);if(n>r)throw j_(`Invalid value for '${e}'. Expected ${r} or less.`)}function nL(e){const t=encodeURIComponent;let r="?";for(const n in e)if(e.hasOwnProperty(n)){const s=t(n)+"="+t(e[n]);r=r+s+"&"}return r=r.slice(0,-1),r}var Jh;(function(e){e[e.NO_ERROR=0]="NO_ERROR",e[e.NETWORK_ERROR=1]="NETWORK_ERROR",e[e.ABORT=2]="ABORT"})(Jh||(Jh={}));/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sL(e,t){const r=e>=500&&e<600,s=[408,429].indexOf(e)!==-1,a=t.indexOf(e)!==-1;return r||s||a}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aL{constructor(t,r,n,s,a,i,o,l,c,u,d,m=!0){this.url_=t,this.method_=r,this.headers_=n,this.body_=s,this.successCodes_=a,this.additionalRetryCodes_=i,this.callback_=o,this.errorCallback_=l,this.timeout_=c,this.progressCallback_=u,this.connectionFactory_=d,this.retry=m,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((p,x)=>{this.resolve_=p,this.reject_=x,this.start_()})}start_(){const t=(n,s)=>{if(s){n(!1,new Nf(!1,null,!0));return}const a=this.connectionFactory_();this.pendingConnection_=a;const i=o=>{const l=o.loaded,c=o.lengthComputable?o.total:-1;this.progressCallback_!==null&&this.progressCallback_(l,c)};this.progressCallback_!==null&&a.addUploadProgressListener(i),a.send(this.url_,this.method_,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&a.removeUploadProgressListener(i),this.pendingConnection_=null;const o=a.getErrorCode()===Jh.NO_ERROR,l=a.getStatus();if(!o||sL(l,this.additionalRetryCodes_)&&this.retry){const u=a.getErrorCode()===Jh.ABORT;n(!1,new Nf(!1,null,u));return}const c=this.successCodes_.indexOf(l)!==-1;n(!0,new Nf(c,a))})},r=(n,s)=>{const a=this.resolve_,i=this.reject_,o=s.connection;if(s.wasSuccessCode)try{const l=this.callback_(o,o.getResponse());rL(l)?a(l):a()}catch(l){i(l)}else if(o!==null){const l=KM();l.serverResponse=o.getErrorText(),this.errorCallback_?i(this.errorCallback_(o,l)):i(l)}else if(s.canceled){const l=this.appDelete_?HS():XM();i(l)}else{const l=qM();i(l)}};this.canceled_?r(!1,new Nf(!1,null,!0)):this.backoffId_=eL(t,r,this.timeout_)}getPromise(){return this.promise_}cancel(t){this.canceled_=!0,this.appDelete_=t||!1,this.backoffId_!==null&&tL(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}}class Nf{constructor(t,r,n){this.wasSuccessCode=t,this.connection=r,this.canceled=!!n}}function iL(e,t){t!==null&&t.length>0&&(e.Authorization="Firebase "+t)}function oL(e,t){e["X-Firebase-Storage-Version"]="webjs/"+(t??"AppManager")}function lL(e,t){t&&(e["X-Firebase-GMPID"]=t)}function cL(e,t){t!==null&&(e["X-Firebase-AppCheck"]=t)}function uL(e,t,r,n,s,a,i=!0){const o=nL(e.urlParams),l=e.url+o,c=Object.assign({},e.headers);return lL(c,t),iL(c,r),oL(c,a),cL(c,n),new aL(l,e.method,c,e.body,e.successCodes,e.additionalRetryCodes,e.handler,e.errorHandler,e.timeout,e.progressCallback,s,i)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fL(e){if(e.length===0)return null;const t=e.lastIndexOf("/");return t===-1?"":e.slice(0,t)}function hL(e){const t=e.lastIndexOf("/",e.length-2);return t===-1?e:e.slice(t+1)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zh{constructor(t,r){this._service=t,r instanceof as?this._location=r:this._location=as.makeFromUrl(r,t.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(t,r){return new Zh(t,r)}get root(){const t=new as(this._location.bucket,"");return this._newRef(this._service,t)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return hL(this._location.path)}get storage(){return this._service}get parent(){const t=fL(this._location.path);if(t===null)return null;const r=new as(this._location.bucket,t);return new Zh(this._service,r)}_throwIfRoot(t){if(this._location.path==="")throw JM(t)}}function V_(e,t){const r=t==null?void 0:t[WM];return r==null?null:as.makeFromBucketSpec(r,e)}function dL(e,t,r,n={}){e.host=`${t}:${r}`,e._protocol="http";const{mockUserToken:s}=n;s&&(e._overrideAuthToken=typeof s=="string"?s:MT(s,e.app.options.projectId))}class mL{constructor(t,r,n,s,a){this.app=t,this._authProvider=r,this._appCheckProvider=n,this._url=s,this._firebaseVersion=a,this._bucket=null,this._host=WS,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=HM,this._maxUploadRetryTime=GM,this._requests=new Set,s!=null?this._bucket=as.makeFromBucketSpec(s,this._host):this._bucket=V_(this._host,this.app.options)}get host(){return this._host}set host(t){this._host=t,this._url!=null?this._bucket=as.makeFromBucketSpec(this._url,t):this._bucket=V_(t,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(t){U_("time",0,Number.POSITIVE_INFINITY,t),this._maxUploadRetryTime=t}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(t){U_("time",0,Number.POSITIVE_INFINITY,t),this._maxOperationRetryTime=t}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const t=this._authProvider.getImmediate({optional:!0});if(t){const r=await t.getToken();if(r!==null)return r.accessToken}return null}async _getAppCheckToken(){const t=this._appCheckProvider.getImmediate({optional:!0});return t?(await t.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(t=>t.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(t){return new Zh(this,t)}_makeRequest(t,r,n,s,a=!0){if(this._deleted)return new ZM(HS());{const i=uL(t,this._appId,n,s,r,this._firebaseVersion,a);return this._requests.add(i),i.getPromise().then(()=>this._requests.delete(i),()=>this._requests.delete(i)),i}}async makeRequestWithTokens(t,r){const[n,s]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(t,r,n,s).getPromise()}}const B_="@firebase/storage",z_="0.13.2";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const GS="storage";function pL(e=Pd(),t){e=Kt(e);const n=Au(e,GS).getImmediate({identifier:t}),s=qg("storage");return s&&gL(n,...s),n}function gL(e,t,r,n={}){dL(e,t,r,n)}function xL(e,{instanceIdentifier:t}){const r=e.getProvider("app").getImmediate(),n=e.getProvider("auth-internal"),s=e.getProvider("app-check-internal");return new mL(r,n,s,t,ro)}function vL(){oi(new pa(GS,xL,"PUBLIC").setMultipleInstances(!0)),Vn(B_,z_,""),Vn(B_,z_,"esm2017")}vL();/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const KS="functions";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yL{constructor(t,r,n){this.auth=null,this.messaging=null,this.appCheck=null,this.auth=t.getImmediate({optional:!0}),this.messaging=r.getImmediate({optional:!0}),this.auth||t.get().then(s=>this.auth=s,()=>{}),this.messaging||r.get().then(s=>this.messaging=s,()=>{}),this.appCheck||n.get().then(s=>this.appCheck=s,()=>{})}async getAuthToken(){if(this.auth)try{const t=await this.auth.getToken();return t==null?void 0:t.accessToken}catch{return}}async getMessagingToken(){if(!(!this.messaging||!("Notification"in self)||Notification.permission!=="granted"))try{return await this.messaging.getToken()}catch{return}}async getAppCheckToken(t){if(this.appCheck){const r=t?await this.appCheck.getLimitedUseToken():await this.appCheck.getToken();return r.error?null:r.token}return null}async getContext(t){const r=await this.getAuthToken(),n=await this.getMessagingToken(),s=await this.getAppCheckToken(t);return{authToken:r,messagingToken:n,appCheckToken:s}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bp="us-central1";class _L{constructor(t,r,n,s,a=bp,i){this.app=t,this.fetchImpl=i,this.emulatorOrigin=null,this.contextProvider=new yL(r,n,s),this.cancelAllRequests=new Promise(o=>{this.deleteService=()=>Promise.resolve(o())});try{const o=new URL(a);this.customDomain=o.origin+(o.pathname==="/"?"":o.pathname),this.region=bp}catch{this.customDomain=null,this.region=a}}_delete(){return this.deleteService()}_url(t){const r=this.app.options.projectId;return this.emulatorOrigin!==null?`${this.emulatorOrigin}/${r}/${this.region}/${t}`:this.customDomain!==null?`${this.customDomain}/${t}`:`https://${this.region}-${r}.cloudfunctions.net/${t}`}}function wL(e,t,r){e.emulatorOrigin=`http://${t}:${r}`}const $_="@firebase/functions",W_="0.11.8";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const EL="auth-internal",TL="app-check-internal",kL="messaging-internal";function SL(e,t){const r=(n,{instanceIdentifier:s})=>{const a=n.getProvider("app").getImmediate(),i=n.getProvider(EL),o=n.getProvider(kL),l=n.getProvider(TL);return new _L(a,i,o,l,s,e)};oi(new pa(KS,r,"PUBLIC").setMultipleInstances(!0)),Vn($_,W_,t),Vn($_,W_,"esm2017")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function AL(e=Pd(),t=bp){const n=Au(Kt(e),KS).getImmediate({identifier:t}),s=qg("functions");return s&&IL(n,...s),n}function IL(e,t,r){wL(Kt(e),t,r)}SL(fetch.bind(self));const CL={apiKey:"AIzaSyAnEPcQISz9FY68mib-0StN6NQtTF3oz1c",authDomain:"xmas-movies.firebaseapp.com",projectId:"xmas-movies",storageBucket:"xmas-movies.firebasestorage.app",messagingSenderId:"721037810395",appId:"1:721037810395:web:1126b377adcc225c944afe"},t0=UT(CL),Tc=V3(t0),qS=new Es;qS.setCustomParameters({prompt:"select_account"});const NL=qS,We=SM(t0);pL(t0);AL(t0);const XS=z.createContext(void 0),Nn=()=>{const e=z.useContext(XS);if(e===void 0)throw new Error("useAuth must be used within an AuthProvider");return e},RL=({children:e})=>{const[t,r]=z.useState(null),[n,s]=z.useState(null),[a,i]=z.useState(!0),[o,l]=z.useState(null);z.useEffect(()=>{const m=ck(Tc,async p=>{if(r(p),l(null),p)try{const x=Bt(We,"users",p.uid),g=await $n(x);if(g.exists())await Ps(x,{lastLoginAt:VM()},{merge:!0}),s(g.data());else{const _={email:p.email||"",displayName:p.displayName||"User",photoURL:p.photoURL||void 0,createdAt:new Date,lastLoginAt:new Date};await Ps(x,_),s({id:p.uid,..._})}}catch(x){console.error("Error fetching user profile:",x),l("Failed to load user profile")}else s(null);i(!1)});return()=>m()},[]);const d={currentUser:t,userProfile:n,isLoading:a,error:o,signInWithGoogle:async()=>{try{l(null),i(!0);const m=new Es;await _k(Tc,m)}catch(m){console.error("Login error:",m),l(m.message||"Failed to sign in")}finally{i(!1)}},signOut:async()=>{try{await RD(Tc)}catch(m){console.error("Sign out error:",m),l(m.message||"Failed to sign out")}}};return f.jsx(XS.Provider,{value:d,children:e})},Uu=()=>{const[e,t]=z.useState(!1),[r,n]=z.useState(!0),[s,a]=z.useState(null),[i,o]=z.useState(null);return z.useEffect(()=>{const l=ck(Tc,async c=>{if(n(!0),a(null),!c){t(!1),o(null),n(!1);return}o({uid:c.uid,email:c.email});try{const d=(await qT(c,!0)).claims.admin===!0;t(d)}catch(u){console.error("Error checking admin status:",u),a("Failed to verify admin status"),t(!1)}finally{n(!1)}});return()=>l()},[]),{isAdmin:e,loading:r,error:s,currentUser:i}},bL=({snowflakeCount:e=100,mobileSnowflakeCount:t=50})=>{const[r,n]=z.useState(!1),[s,a]=z.useState(e),i=z.useRef(null),o=z.useRef([]),l=z.useRef(0);return z.useEffect(()=>{const c=()=>{const u=window.matchMedia("(max-width: 768px)").matches;n(u),a(u?t:e)};return c(),window.addEventListener("resize",c),()=>{window.removeEventListener("resize",c)}},[e,t]),z.useEffect(()=>{const c=i.current;if(!c)return;const u=c.getContext("2d");if(!u)return;const d=()=>{c.width=window.innerWidth,c.height=window.innerHeight},m=()=>{o.current=[];for(let _=0;_<s;_++)o.current.push({x:Math.random()*c.width,y:Math.random()*c.height,size:r?Math.random()*3+1:Math.random()*4+1,speed:r?Math.random()*.8+.3:Math.random()*1+.5,opacity:r?Math.random()*.5+.2:Math.random()*.6+.3,wind:r?Math.random()*.3-.15:Math.random()*.5-.25})},p=_=>{u.beginPath(),u.arc(_.x,_.y,_.size,0,Math.PI*2),u.fillStyle=`rgba(255, 255, 255, ${_.opacity})`,u.fill()},x=_=>{_.y+=_.speed,_.x+=_.wind,_.y>c.height&&(_.y=-10,_.x=Math.random()*c.width),_.x>c.width?_.x=0:_.x<0&&(_.x=c.width)},g=()=>{u.clearRect(0,0,c.width,c.height),o.current.forEach(_=>{p(_),x(_)}),l.current=requestAnimationFrame(g)};return window.addEventListener("resize",d),d(),m(),g(),()=>{window.removeEventListener("resize",d),cancelAnimationFrame(l.current)}},[s]),f.jsx("canvas",{ref:i,className:"fixed top-0 left-0 w-full h-full pointer-events-none z-10","aria-hidden":"true"})},PL=()=>{const[e,t]=z.useState(!1),[r,n]=z.useState(null),[s,a]=z.useState(!1);z.useEffect(()=>{const l=/iPad|iPhone|iPod/.test(navigator.userAgent)&&!window.MSStream;a(l);const c=u=>{u.preventDefault(),n(u),t(!0)};return window.addEventListener("beforeinstallprompt",c),window.matchMedia("(display-mode: standalone)").matches&&t(!1),()=>{window.removeEventListener("beforeinstallprompt",c)}},[]);const i=async()=>{if(!r)return;r.prompt();const{outcome:l}=await r.userChoice;n(null),t(!1),console.log(`User ${l==="accepted"?"accepted":"dismissed"} the install prompt`)},o=()=>{t(!1),localStorage.setItem("installPromptDismissed","true")};return e?f.jsxs("div",{className:"fixed bottom-0 left-0 right-0 bg-green-800 text-white p-4 shadow-lg z-50 flex items-center justify-between",children:[f.jsxs("div",{className:"flex items-center",children:[f.jsx("div",{className:"mr-3 text-2xl",children:f.jsx("i",{className:"fas fa-gift"})}),f.jsx("div",{children:s?f.jsxs("p",{children:["Install this app on your device: tap ",f.jsx("i",{className:"fas fa-share"}),' and then "Add to Home Screen"']}):f.jsx("p",{children:"Add Christmas Movies to your home screen!"})})]}),f.jsxs("div",{className:"flex items-center",children:[!s&&f.jsx("button",{onClick:i,className:"bg-red-700 hover:bg-red-800 text-white py-1 px-4 rounded-full mr-2",children:"Install"}),f.jsx("button",{onClick:o,className:"bg-transparent hover:bg-green-700 text-white py-1 px-2 rounded-full",children:f.jsx("i",{className:"fas fa-times"})})]})]}):null};function DL(){const{currentUser:e}=Nn(),{isAdmin:t}=Uu(),[r,n]=z.useState(!1),s=Ms();z.useEffect(()=>(r?document.body.style.overflow="hidden":document.body.style.overflow="",()=>{document.body.style.overflow=""}),[r]),z.useEffect(()=>{r&&n(!1)},[s.pathname]);const a=()=>{n(!r)};return f.jsxs("div",{className:"min-h-screen bg-gradient-to-b from-xmas-bg to-xmas-card bg-opacity-95",children:[f.jsx(bL,{snowflakeCount:150,mobileSnowflakeCount:40}),f.jsx(PL,{}),f.jsxs("div",{className:"navbar bg-gradient-to-r from-xmas-card via-xmas-card to-xmas-bg border-b border-xmas-gold px-2 sm:px-4 shadow-lg relative overflow-hidden",children:[f.jsx("div",{className:"absolute top-0 left-0 w-full h-1 bg-gradient-to-r from-xmas-gold via-transparent to-xmas-gold opacity-60"}),f.jsx("div",{className:"absolute -bottom-4 left-0 right-0 h-8 snow-accumulation-fast"}),f.jsxs("div",{className:"flex items-center",children:[f.jsx("button",{className:"btn btn-ghost btn-sm md:hidden relative z-10",onClick:a,"aria-label":"Toggle navigation menu",children:f.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",className:"inline-block w-5 h-5 stroke-current",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M4 6h16M4 12h16M4 18h16"})})}),f.jsxs(Ye,{to:"/",className:"hidden sm:flex items-center group",children:[f.jsxs("div",{className:"relative",children:[f.jsx("div",{className:"absolute -inset-1 bg-gradient-to-r from-xmas-gold to-xmas-line rounded-full opacity-70 group-hover:opacity-100 blur transition duration-200"}),f.jsx("div",{className:"relative flex items-center justify-center w-10 h-10 bg-xmas-card rounded-full border border-xmas-gold overflow-hidden",children:f.jsx("img",{src:"/Santa.png",alt:"Santa",className:"w-full h-full object-cover group-hover:scale-110 transition-transform duration-300"})})]}),f.jsx("div",{className:"ml-3 font-christmas text-xl sm:text-2xl bg-gradient-to-br from-xmas-gold via-xmas-snow to-xmas-gold bg-clip-text text-transparent font-bold",children:"Christmas Movies"})]}),f.jsxs(Ye,{to:"/",className:"sm:hidden flex items-center",children:[f.jsx("div",{className:"w-8 h-8 flex items-center justify-center rounded-full bg-xmas-card border border-xmas-gold overflow-hidden",children:f.jsx("img",{src:"/Santa.png",alt:"Santa",className:"w-full h-full object-cover"})}),f.jsx("span",{className:"ml-2 font-christmas text-lg text-xmas-gold",children:"Christmas Movies"})]})]}),f.jsx("div",{className:"flex-1"}),f.jsxs("div",{className:"flex items-center gap-1 sm:gap-2",children:[e&&f.jsxs(Ye,{to:"/profile",className:"btn btn-primary btn-sm hidden md:flex",children:[f.jsx("i",{className:"fas fa-user-circle mr-1"})," Profile"]}),e?f.jsxs("div",{className:"dropdown dropdown-end",children:[f.jsx("label",{tabIndex:0,className:"btn btn-ghost btn-circle avatar cursor-pointer",children:f.jsx("div",{className:"w-10 rounded-full border border-xmas-gold",children:e.photoURL?f.jsx("img",{src:e.photoURL,alt:"Profile"}):f.jsx("div",{className:"bg-xmas-card flex items-center justify-center h-full",children:f.jsx("i",{className:"fas fa-user text-xmas-gold"})})})}),f.jsxs("ul",{tabIndex:0,className:"dropdown-content menu menu-sm mt-3 z-[1] p-2 shadow bg-xmas-card rounded-box w-52 border border-xmas-gold",children:[f.jsx("li",{children:f.jsxs(Ye,{to:"/profile",className:"justify-between",children:["Profile",f.jsx("i",{className:"fas fa-user-circle"})]})}),f.jsx("li",{children:f.jsxs(Ye,{to:"/movies",children:["My Movies",f.jsx("i",{className:"fas fa-film"})]})}),f.jsx("li",{children:f.jsxs(Ye,{to:"/random",children:["Random Movie",f.jsx("i",{className:"fas fa-random"})]})}),f.jsx("li",{children:f.jsxs(Ye,{to:"/import",children:["Import Movies",f.jsx("i",{className:"fas fa-file-import"})]})}),t&&f.jsx("li",{children:f.jsxs(Ye,{to:"/admin",className:"text-xmas-gold",children:["Admin Dashboard",f.jsx("i",{className:"fas fa-crown"})]})})]})]}):f.jsxs(Ye,{to:"/login",className:"btn btn-primary btn-sm",children:[f.jsx("i",{className:"fas fa-sign-in-alt mr-1"})," Sign In"]})]})]}),f.jsx("div",{className:`fixed inset-0 bg-black bg-opacity-70 z-20 transition-opacity duration-300 md:hidden ${r?"opacity-100":"opacity-0 pointer-events-none"}`,onClick:a}),f.jsxs("div",{className:`fixed top-0 left-0 h-full w-72 bg-gradient-to-b from-xmas-bg to-xmas-card border-r border-xmas-gold z-30 transform transition-transform duration-300 ease-in-out md:hidden shadow-xl ${r?"translate-x-0":"-translate-x-full"}`,children:[f.jsxs("div",{className:"relative overflow-hidden",children:[f.jsx("div",{className:"absolute top-0 left-0 w-full h-1 bg-gradient-to-r from-xmas-gold via-transparent to-xmas-gold opacity-60"}),f.jsxs("div",{className:"flex justify-between items-center p-4 border-b border-xmas-gold bg-xmas-card bg-opacity-80",children:[f.jsxs("div",{className:"flex items-center",children:[f.jsx("div",{className:"w-9 h-9 flex items-center justify-center rounded-full bg-xmas-card border border-xmas-gold shadow-lg overflow-hidden",children:f.jsx("img",{src:"/Santa.png",alt:"Santa",className:"w-full h-full object-cover"})}),f.jsx("div",{className:"ml-3 font-christmas text-xl bg-gradient-to-br from-xmas-gold via-xmas-snow to-xmas-gold bg-clip-text text-transparent font-bold",children:"Christmas Movies"})]}),f.jsx("button",{className:"btn btn-ghost btn-sm text-xmas-text hover:text-xmas-line",onClick:a,"aria-label":"Close navigation menu",children:f.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})]}),f.jsx("div",{className:"overflow-y-auto h-full pb-20",children:f.jsx("div",{className:"p-4 pt-6",children:f.jsxs("div",{className:"mb-6",children:[f.jsx("h3",{className:"font-christmas text-xl text-xmas-gold mb-4 pl-2 border-l-2 border-xmas-line",children:"Navigation"}),f.jsxs("ul",{className:"space-y-3",children:[f.jsx("li",{children:f.jsx(Na,{to:"/",onClick:a,className:({isActive:i})=>i?"flex items-center p-2 pl-3 rounded-md bg-gradient-to-r from-xmas-card to-transparent border-l-2 border-xmas-gold text-xmas-gold font-medium":"flex items-center p-2 pl-3 rounded-md hover:bg-xmas-card hover:bg-opacity-50 text-xmas-text hover:text-xmas-gold transition-all duration-200",children:({isActive:i})=>f.jsxs(f.Fragment,{children:[f.jsx("i",{className:"fas fa-home mr-3 text-xmas-gold"}),f.jsx("span",{children:"Home"}),f.jsx("i",{className:`fas fa-snowflake ml-auto text-xmas-gold opacity-70 ${i?"visible":"invisible"}`})]})})}),e?f.jsxs(f.Fragment,{children:[f.jsx("li",{children:f.jsx(Na,{to:"/movies",onClick:a,className:({isActive:i})=>i?"flex items-center p-2 pl-3 rounded-md bg-gradient-to-r from-xmas-card to-transparent border-l-2 border-xmas-gold text-xmas-gold font-medium":"flex items-center p-2 pl-3 rounded-md hover:bg-xmas-card hover:bg-opacity-50 text-xmas-text hover:text-xmas-gold transition-all duration-200",children:({isActive:i})=>f.jsxs(f.Fragment,{children:[f.jsx("i",{className:"fas fa-film mr-3 text-xmas-gold"}),f.jsx("span",{children:"My Movies"}),f.jsx("i",{className:`fas fa-snowflake ml-auto text-xmas-gold opacity-70 ${i?"visible":"invisible"}`})]})})}),f.jsx("li",{children:f.jsx(Na,{to:"/random",onClick:a,className:({isActive:i})=>i?"flex items-center p-2 pl-3 rounded-md bg-gradient-to-r from-xmas-card to-transparent border-l-2 border-xmas-gold text-xmas-gold font-medium":"flex items-center p-2 pl-3 rounded-md hover:bg-xmas-card hover:bg-opacity-50 text-xmas-text hover:text-xmas-gold transition-all duration-200",children:({isActive:i})=>f.jsxs(f.Fragment,{children:[f.jsx("i",{className:"fas fa-random mr-3 text-xmas-gold"}),f.jsx("span",{children:"Random Movie"}),f.jsx("i",{className:`fas fa-snowflake ml-auto text-xmas-gold opacity-70 ${i?"visible":"invisible"}`})]})})}),f.jsx("li",{children:f.jsx(Na,{to:"/achievements",onClick:a,className:({isActive:i})=>i?"flex items-center p-2 pl-3 rounded-md bg-gradient-to-r from-xmas-card to-transparent border-l-2 border-xmas-gold text-xmas-gold font-medium":"flex items-center p-2 pl-3 rounded-md hover:bg-xmas-card hover:bg-opacity-50 text-xmas-text hover:text-xmas-gold transition-all duration-200",children:({isActive:i})=>f.jsxs(f.Fragment,{children:[f.jsx("i",{className:"fas fa-trophy mr-3 text-xmas-gold"}),f.jsx("span",{children:"Achievements"}),f.jsx("i",{className:`fas fa-snowflake ml-auto text-xmas-gold opacity-70 ${i?"visible":"invisible"}`})]})})}),f.jsx("li",{children:f.jsx(Na,{to:"/import",onClick:a,className:({isActive:i})=>i?"flex items-center p-2 pl-3 rounded-md bg-gradient-to-r from-xmas-card to-transparent border-l-2 border-xmas-gold text-xmas-gold font-medium":"flex items-center p-2 pl-3 rounded-md hover:bg-xmas-card hover:bg-opacity-50 text-xmas-text hover:text-xmas-gold transition-all duration-200",children:({isActive:i})=>f.jsxs(f.Fragment,{children:[f.jsx("i",{className:"fas fa-file-import mr-3 text-xmas-gold"}),f.jsx("span",{children:"Add Movies"}),f.jsx("i",{className:`fas fa-snowflake ml-auto text-xmas-gold opacity-70 ${i?"visible":"invisible"}`})]})})}),f.jsx("li",{children:f.jsx(Na,{to:"/profile",onClick:a,className:({isActive:i})=>i?"flex items-center p-2 pl-3 rounded-md bg-gradient-to-r from-xmas-card to-transparent border-l-2 border-xmas-gold text-xmas-gold font-medium":"flex items-center p-2 pl-3 rounded-md hover:bg-xmas-card hover:bg-opacity-50 text-xmas-text hover:text-xmas-gold transition-all duration-200",children:({isActive:i})=>f.jsxs(f.Fragment,{children:[f.jsx("i",{className:"fas fa-user-circle mr-3 text-xmas-gold"}),f.jsx("span",{children:"Profile"}),f.jsx("i",{className:`fas fa-snowflake ml-auto text-xmas-gold opacity-70 ${i?"visible":"invisible"}`})]})})}),t&&f.jsx("li",{children:f.jsx(Na,{to:"/admin",onClick:a,className:({isActive:i})=>i?"flex items-center p-2 pl-3 rounded-md bg-gradient-to-r from-xmas-card to-transparent border-l-2 border-xmas-gold text-xmas-gold font-medium":"flex items-center p-2 pl-3 rounded-md hover:bg-xmas-card hover:bg-opacity-50 text-xmas-text hover:text-xmas-gold transition-all duration-200",children:({isActive:i})=>f.jsxs(f.Fragment,{children:[f.jsx("i",{className:"fas fa-crown mr-3 text-xmas-gold"}),f.jsx("span",{children:"Admin Dashboard"}),f.jsx("i",{className:`fas fa-snowflake ml-auto text-xmas-gold opacity-70 ${i?"visible":"invisible"}`})]})})})]}):f.jsx("li",{children:f.jsx(Na,{to:"/login",onClick:a,className:({isActive:i})=>i?"flex items-center p-2 pl-3 rounded-md bg-gradient-to-r from-xmas-card to-transparent border-l-2 border-xmas-gold text-xmas-gold font-medium":"flex items-center p-2 pl-3 rounded-md hover:bg-xmas-card hover:bg-opacity-50 text-xmas-text hover:text-xmas-gold transition-all duration-200",children:({isActive:i})=>f.jsxs(f.Fragment,{children:[f.jsx("i",{className:"fas fa-sign-in-alt mr-3 text-xmas-gold"}),f.jsx("span",{children:"Sign In"}),f.jsx("i",{className:`fas fa-snowflake ml-auto text-xmas-gold opacity-70 ${i?"visible":"invisible"}`})]})})})]})]})})})]}),f.jsx("main",{className:"p-4",children:f.jsx(IT,{})}),f.jsx("div",{className:"fixed bottom-0 left-0 w-full pointer-events-none",children:f.jsx("div",{className:"container mx-auto",children:f.jsxs("div",{className:"relative h-16",children:[f.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-px bg-gradient-to-r from-xmas-gold via-transparent to-xmas-gold opacity-40"}),f.jsx("div",{className:"absolute bottom-4 left-4 opacity-30",children:f.jsx("i",{className:"fas fa-tree text-4xl text-xmas-gold"})}),f.jsx("div",{className:"absolute bottom-4 right-4 opacity-30",children:f.jsx("i",{className:"fas fa-star text-4xl text-xmas-gold"})})]})})})]})}const YS=z.createContext(null);function FL({children:e}){const[t,r]=z.useState([]),n=z.useCallback(i=>{r(o=>o.filter(l=>l.id!==i))},[]),s=z.useCallback((i,o)=>{const l=Math.random().toString(36).slice(2);r(c=>[...c,{id:l,kind:i,message:o}]),setTimeout(()=>n(l),3e3)},[n]),a=z.useMemo(()=>({push:s}),[s]);return f.jsxs(YS.Provider,{value:a,children:[e,f.jsx("div",{className:"fixed top-4 right-4 z-50 space-y-2",children:t.map(i=>f.jsxs("div",{className:`alert shadow-lg max-w-sm ${i.kind==="success"?"alert-success":i.kind==="error"?"alert-error":"alert-info"}`,children:[f.jsxs("div",{children:[i.kind==="success"?"":i.kind==="error"?"":"",f.jsx("span",{className:"ml-2",children:i.message})]}),f.jsx("button",{className:"btn btn-ghost btn-sm",onClick:()=>n(i.id),children:""})]},i.id))})]})}function QS(){const e=z.useContext(YS);if(!e)throw new Error("useToast must be used inside <ToastProvider>");return{success:t=>e.push("success",t),error:t=>e.push("error",t),info:t=>e.push("info",t)}}const H_=({children:e})=>{const{currentUser:t,isLoading:r}=Nn();return r?f.jsx("div",{className:"flex justify-center items-center min-h-[60vh]",children:f.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-xmas-gold"})}):t?e?f.jsx(f.Fragment,{children:e}):f.jsx(IT,{}):f.jsx(zR,{to:"/login"})},Xo=[{id:"first_snowflake",name:"First Snowflake",description:"You logged your very first watched Christmas movie.",hint:"Watch 1 movie.",icon:"",check:e=>e.totalWatched>=1},{id:"snowball_starter",name:"Snowball Starter",description:"You have started to build your festive watchlist.",hint:"Watch 5 movies.",icon:"",check:e=>e.totalWatched>=5},{id:"blizzard_binger",name:"Blizzard Binger",description:"You powered through a flurry of festive films.",hint:"Watch 20 movies.",icon:"",check:e=>e.totalWatched>=20},{id:"christmas_marathoner",name:"Christmas Marathoner",description:"You turned Christmas movies into a marathon event.",hint:"Watch 50 movies.",icon:"",check:e=>e.totalWatched>=50},{id:"twelve_days",name:"12 Days of Christmas",description:"You kept the festive streak going for 12 days.",hint:"Watch a movie daily for 12 days.",icon:"",check:e=>e.hasTwelveDayStreak},{id:"the_grinch",name:"The Grinch",description:"Not every movie can be a Christmas miracle.",hint:"Give a movie 1.",icon:"",check:e=>e.lowRatingAny},{id:"santas_favourite",name:"Santa's Favourite",description:"You found a film worthy of Santa himself.",hint:"Give a movie a perfect 10.",icon:"",check:e=>e.highRatingAny},{id:"the_critic",name:"The Critic",description:"You have opinions on a lot of movies.",hint:"Rate 20 movies.",icon:"",check:e=>e.totalRated>=20},{id:"nice_list",name:"Nice List",description:"You are generous with your festive ratings.",hint:"Keep your average rating above 5.",icon:"",check:e=>e.averageRating>5},{id:"classic_connoisseur",name:"Classic Connoisseur",description:"You appreciate the classics before Y2K.",hint:"Watch 5 movies released before 2000.",icon:"",check:e=>e.classicWatched>=5},{id:"animated_joy",name:"Animated Joy",description:"You love animated festive adventures.",hint:"Watch 5 animated Christmas movies.",icon:"",check:e=>e.animatedCount>=5},{id:"romcom_reindeer",name:"Rom-Com Reindeer",description:"You love a festive rom-com.",hint:"Watch 5 Christmas romance movies.",icon:"",check:e=>e.romanceCount>=5},{id:"decorator",name:"Decorator",description:"You have a whole row of favourites lit up.",hint:"Mark 10 movies as favourite.",icon:"",check:e=>e.favoriteCount>=10},{id:"elf_mode",name:"Elf Mode",description:"You keep coming back like a dedicated Christmas elf.",hint:"Use the app on 10 different days.",icon:"",check:e=>e.usageDistinctDays>=10},{id:"christmas_eve_watcher",name:"Christmas Eve Watcher",description:"You watched a movie on Christmas Eve.",hint:"Watch a movie on Dec 24.",icon:"",check:e=>e.hasChristmasEveWatch},{id:"new_years_cozy",name:"New Year's Cozy",description:"You started the year with a cozy movie.",hint:"Watch a movie on Jan 1.",icon:"",check:e=>e.hasNewYearsWatch}];function G_(e){if(!e)return null;if(e instanceof Date)return e;if(typeof e.toDate=="function")return e.toDate();if(typeof e=="object"&&"seconds"in e)return new Date(e.seconds*1e3);if(typeof e=="string"){const t=new Date(e);if(!isNaN(t.getTime()))return t}return null}function OL(e,t){let r=0,n=0,s=0,a=0,i=0,o=0,l=0,c=!1,u=!1;const d=new Set,m=new Set,p=new Set;for(const M of e){if(M.watched){r++;const v=G_(M.watchedDate);if(v){const S=v.toISOString().split("T")[0];p.add(S);const R=v.getMonth();v.getDate(),R===11&&d.add(S)}const E=t[M.movieId];E&&E.releaseDate&&E.releaseDate.substring(0,4)<"2000"&&a++,E&&E.genres&&E.genres.includes("Romance")&&i++,E&&E.genres&&E.genres.includes("Animation")&&o++}M.favorite&&l++,typeof M.rating=="number"&&(n++,s+=M.rating,M.rating<=1&&(c=!0),M.rating>=10&&(u=!0));const O=G_(M.updatedAt||M.addedAt);if(O){const v=O.toISOString().split("T")[0];m.add(v)}}const x=Array.from(p).map(M=>{const O=new Date(M+"T00:00:00Z");return Math.floor(O.getTime()/864e5)}).sort((M,O)=>M-O);let g=!1,_=0,k=null;for(const M of x){if(k===null||M===k+1?_+=1:M!==k&&(_=1),_>=12){g=!0;break}k=M}let T=!1,w=!1;for(const M of p){const O=new Date(M+"T00:00:00Z"),v=O.getMonth(),E=O.getDate();v===11&&E===24&&(T=!0),v===0&&E===1&&(w=!0)}const C=n>0?s/n:0;return{totalWatched:r,totalRated:n,averageRating:C,lowRatingAny:c,highRatingAny:u,classicWatched:a,romanceCount:i,animatedCount:o,favoriteCount:l,usageDistinctDays:m.size,decemberDistinctDays:d.size,hasChristmasEveWatch:T,hasNewYearsWatch:w,hasTwelveDayStreak:g}}async function oh(e){const t=await lr(Gt(We,`users/${e}/movies`)),r=[],n=new Set;t.forEach(u=>{const d=u.data();r.push({id:u.id,...d}),d.movieId&&n.add(d.movieId)});const s={};if(n.size){const u=Array.from(n);for(const d of u){(await lr(Gt(We,"movies"))).forEach(p=>{const x=p.data();s[p.id]={id:p.id,...x}});break}}const a=OL(r,s),i=Gt(We,`users/${e}/achievements`),o=await lr(i),l=new Set;o.forEach(u=>l.add(u.id));const c=[];for(const u of Xo)!l.has(u.id)&&u.check(a)&&(c.push(u.id),await Ps(Bt(We,`users/${e}/achievements`,u.id),{unlockedAt:new Date,seen:!1}));return c}const ML=()=>{const{currentUser:e}=Nn(),[t,r]=z.useState(new Date),[n,s]=z.useState(null),[a,i]=z.useState(null),o=Xo.length;z.useEffect(()=>{const u=setInterval(()=>r(new Date),1e3);return()=>clearInterval(u)},[]);const l=z.useMemo(()=>{const u=t.getFullYear(),d=new Date(u,11,25,0,0,0);return t>d?new Date(u+1,11,25,0,0,0):d},[t]),c=z.useMemo(()=>{const u=l.getTime()-t.getTime(),d=Math.max(0,Math.floor(u/1e3)),m=Math.floor(d/86400),p=Math.floor(d%86400/3600),x=Math.floor(d%3600/60),g=d%60;return{days:m,hours:p,minutes:x,seconds:g}},[t,l]);return z.useEffect(()=>{const u=Bt(We,"stats","global"),d=UM(u,m=>{const p=m.data();s(typeof(p==null?void 0:p.watchedTotal)=="number"?p.watchedTotal:0)});return()=>d()},[]),z.useEffect(()=>{if(!e){i(null);return}(async()=>{try{const d=Gt(We,`users/${e.uid}/achievements`),m=await lr(d);i(m.size)}catch(d){console.error("Error loading achievements count",d),i(null)}})()},[e]),f.jsxs("div",{className:"container mx-auto px-4 py-8",children:[f.jsxs("div",{className:"text-center mb-12",children:[f.jsx("h1",{className:"font-christmas text-5xl md:text-7xl text-xmas-line mb-4",children:"My Christmas Movies"}),f.jsx("p",{className:"text-xl md:text-2xl text-xmas-snow mb-8",children:"Track, rate, and discover your favourite Christmas movies!"}),f.jsx("div",{className:"flex flex-col md:flex-row justify-center gap-6 mb-4 md:mb-6",children:e?f.jsxs(f.Fragment,{children:[f.jsxs(Ye,{to:"/movies",className:"btn btn-primary btn-lg text-xl px-8 py-3 rounded-md shadow-lg hover:shadow-xl transition-all duration-300 border border-xmas-gold border-opacity-30",children:[f.jsx("i",{className:"fas fa-film mr-2"})," My Movies"]}),f.jsxs(Ye,{to:"/random",className:"btn btn-primary btn-lg text-xl px-8 py-3 rounded-md shadow-lg hover:shadow-xl transition-all duration-300 border border-xmas-gold border-opacity-30",children:[f.jsx("i",{className:"fas fa-random mr-2"})," Random Movie"]}),f.jsxs(Ye,{to:"/achievements",className:"btn btn-primary btn-lg text-xl px-8 py-3 rounded-md shadow-lg hover:shadow-xl transition-all duration-300 border border-xmas-gold border-opacity-30",children:[f.jsx("i",{className:"fas fa-trophy mr-2"})," Achievements"]})]}):f.jsxs(Ye,{to:"/login",className:"btn btn-primary btn-lg text-xl px-8 py-3 rounded-md shadow-lg hover:shadow-xl transition-all duration-300 border border-xmas-gold border-opacity-30",children:[f.jsx("i",{className:"fas fa-sign-in-alt mr-2"})," Sign In"]})})]}),f.jsx("div",{className:"w-full max-w-4xl mx-auto mb-8",children:f.jsx("div",{className:"h-px bg-gradient-to-r from-transparent via-xmas-gold to-transparent"})}),f.jsxs("div",{className:"bg-xmas-card rounded-lg shadow-xl p-6 mb-12 border border-xmas-gold border-opacity-30 relative",children:[f.jsx("h2",{className:"font-christmas text-3xl text-xmas-gold text-center mb-6",children:"Countdown to Christmas"}),f.jsxs("div",{className:"grid md:grid-cols-2 gap-6 items-stretch",children:[f.jsxs("div",{className:"bg-xmas-card bg-opacity-70 p-6 rounded-lg shadow-md border-l-2 border-xmas-line flex flex-col items-center justify-center",children:[f.jsxs("div",{className:"text-5xl md:text-6xl font-bold text-xmas-line mb-2",children:[c.days,"d ",c.hours,"h ",c.minutes,"m ",c.seconds,"s"]}),f.jsx("p",{className:"text-xmas-text text-opacity-80",children:"until Christmas Day"})]}),f.jsxs("div",{className:"bg-xmas-card bg-opacity-70 p-6 rounded-lg shadow-md border-l-2 border-xmas-gold flex flex-col items-center justify-center",children:[f.jsx("div",{className:"text-5xl md:text-6xl font-bold text-xmas-gold mb-2",children:n??""}),f.jsx("p",{className:"text-xmas-text text-opacity-80 text-center",children:"total movies watched"})]})]})]}),f.jsxs("div",{className:"bg-xmas-card rounded-lg shadow-xl p-6 mb-12 border border-xmas-gold border-opacity-20 snow-accumulation snow-accumulation-slow relative",children:[f.jsx("h2",{className:"font-christmas text-3xl text-xmas-line mb-6 text-center",children:"Features"}),f.jsxs("div",{className:"grid md:grid-cols-4 gap-6",children:[f.jsxs("div",{className:"bg-xmas-card bg-opacity-70 p-6 rounded-lg shadow-md border-l-2 border-xmas-line",children:[f.jsx("div",{className:"text-3xl text-xmas-gold mb-4 text-center",children:f.jsx("i",{className:"fas fa-search"})}),f.jsx("h3",{className:"font-christmas text-xl text-center mb-3",children:"Find Movies"}),f.jsx("p",{className:"text-center text-xmas-text text-opacity-80",children:"Search and discover Christmas movies using TMDB integration"})]}),f.jsxs("div",{className:"bg-xmas-card bg-opacity-70 p-6 rounded-lg shadow-md border-l-2 border-xmas-gold",children:[f.jsx("div",{className:"text-3xl text-xmas-gold mb-4 text-center",children:f.jsx("i",{className:"fas fa-star"})}),f.jsx("h3",{className:"font-christmas text-xl text-center mb-3",children:"Rate & Review"}),f.jsx("p",{className:"text-center text-xmas-text text-opacity-80",children:"Keep track of movies you've watched and rate them"})]}),f.jsxs("div",{className:"bg-xmas-card bg-opacity-70 p-6 rounded-lg shadow-md border-l-2 border-xmas-line",children:[f.jsx("div",{className:"text-3xl text-xmas-gold mb-4 text-center",children:f.jsx("i",{className:"fas fa-random"})}),f.jsx("h3",{className:"font-christmas text-xl text-center mb-3",children:"Random Picker"}),f.jsx("p",{className:"text-center text-xmas-text text-opacity-80",children:"Can't decide what to watch? Let our random movie picker help!"})]}),f.jsxs("div",{className:"bg-xmas-card bg-opacity-70 p-6 rounded-lg shadow-md border-l-2 border-xmas-line",children:[f.jsx("div",{className:"text-3xl text-xmas-gold mb-4 text-center",children:f.jsx("i",{className:"fas fa-trophy"})}),f.jsx("h3",{className:"font-christmas text-xl text-center mb-3",children:"Achievements"}),f.jsx("p",{className:"text-center text-xmas-text text-opacity-80 mb-2",children:"Unlock festive badges as you watch, rate, and explore."}),e&&f.jsx("p",{className:"text-center text-xmas-text text-opacity-80 font-medium",children:typeof a=="number"?`${a} / ${o} unlocked`:`${o} to discover`})]})]})]}),f.jsx("div",{className:"bg-xmas-card rounded-lg shadow-xl p-6 mb-12 border border-xmas-gold border-opacity-30 snow-accumulation snow-accumulation-fast relative",children:f.jsxs("div",{className:"mb-6 text-center",children:[f.jsxs("h2",{className:"font-christmas text-3xl md:text-4xl text-xmas-gold inline-block relative",children:[f.jsx("span",{className:"relative z-10",children:"Create Your Collection"}),f.jsx("span",{className:"absolute -bottom-2 left-0 right-0 h-1 bg-xmas-gold opacity-30 rounded-full"})]}),f.jsx("p",{className:"mt-4 mb-6",children:"Add movies to your collection and rate them"}),e?f.jsxs(Ye,{to:"/import",className:"btn btn-primary",children:[f.jsx("i",{className:"fas fa-file-import mr-2"})," Add Movies"]}):f.jsxs(Ye,{to:"/login",className:"btn btn-primary",children:[f.jsx("i",{className:"fas fa-sign-in-alt mr-2"})," Sign In to Add"]})]})}),f.jsx("div",{className:"w-full max-w-4xl mx-auto mb-8",children:f.jsx("div",{className:"h-px bg-gradient-to-r from-transparent via-xmas-gold to-transparent"})}),f.jsxs("footer",{className:"text-center text-xmas-mute mt-12 pb-8 space-y-4",children:[f.jsxs("p",{children:[" ",new Date().getFullYear()," Christmas Movie Database"]}),f.jsxs("div",{className:"flex flex-col items-center justify-center gap-2 text-xs md:text-sm text-xmas-mute/80",children:[f.jsx("a",{href:"https://www.themoviedb.org",target:"_blank",rel:"noopener noreferrer",className:"btn flex items-center justify-center gap-2",children:f.jsx("img",{src:"/tmdb.svg",alt:"TMDB logo",className:"h-6 md:h-8 w-auto mb-1"})}),f.jsx("p",{className:"max-w-xl px-4",children:"This product uses the TMDB API but is not endorsed or certified by TMDB."})]})]})]})},LL=()=>{const e=Ls(),{currentUser:t,isLoading:r,error:n,signInWithGoogle:s}=Nn();z.useEffect(()=>{t&&!r&&e("/")},[t,r,e]);const a=async()=>{try{await s()}catch(i){console.error("Login failed:",i)}};return r?f.jsx("div",{className:"flex justify-center items-center min-h-[60vh]",children:f.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-xmas-gold"})}):f.jsx("div",{className:"container mx-auto px-4 py-12",children:f.jsxs("div",{className:"max-w-md mx-auto",children:[f.jsxs("div",{className:"text-center mb-8",children:[f.jsx("h1",{className:"font-christmas text-4xl text-xmas-line mb-2",children:"Christmas Movie Database"}),f.jsx("p",{className:"text-xmas-mute",children:"Sign in to manage your Christmas movie collection"})]}),f.jsxs("div",{className:"bg-xmas-card rounded-lg shadow-lg p-6",children:[n&&f.jsx("div",{className:"bg-error bg-opacity-10 border-l-4 border-error p-4 mb-6 rounded",children:f.jsx("p",{className:"text-error",children:n})}),f.jsxs("div",{className:"text-center mb-6",children:[f.jsx("p",{className:"mb-4",children:"Sign in with your Google account to access your Christmas movie collection."}),f.jsx("p",{className:"text-sm text-xmas-mute mb-6",children:"Track, rate, and discover Christmas movies!"}),f.jsxs("button",{onClick:a,className:"btn btn-primary w-full flex items-center justify-center gap-2",children:[f.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 48 48",children:[f.jsx("path",{fill:"#FFC107",d:`M43.611,20.083H42V20H24v8h11.303c-1.649,4.657-6.08,8-11.303,8c-6.627,0-12-5.373-12-12
                  s5.373-12,12-12c3.059,0,5.842,1.154,7.961,3.039l5.657-5.657C34.046,6.053,29.268,4,24,4C12.955,4,4,12.955,4,24s8.955,20,20,20
                  s20-8.955,20-20C44,22.659,43.862,21.35,43.611,20.083z`}),f.jsx("path",{fill:"#FF3D00",d:`M6.306,14.691l6.571,4.819C14.655,15.108,18.961,12,24,12c3.059,0,5.842,1.154,7.961,3.039
                  l5.657-5.657C34.046,6.053,29.268,4,24,4C16.318,4,9.656,8.337,6.306,14.691z`}),f.jsx("path",{fill:"#4CAF50",d:`M24,44c5.166,0,9.86-1.977,13.409-5.192l-6.19-5.238C29.211,35.091,26.715,36,24,36
                  c-5.202,0-9.619-3.317-11.283-7.946l-6.522,5.025C9.505,39.556,16.227,44,24,44z`}),f.jsx("path",{fill:"#1976D2",d:`M43.611,20.083H42V20H24v8h11.303c-0.792,2.237-2.231,4.166-4.087,5.571
                  c0.001-0.001,0.002-0.001,0.003-0.002l6.19,5.238C36.971,39.205,44,34,44,24C44,22.659,43.862,21.35,43.611,20.083z`})]}),"Sign in with Google"]})]})]}),f.jsx("div",{className:"text-center mt-6",children:f.jsx("p",{className:"text-sm text-xmas-mute",children:"By signing in, you agree to our Terms of Service and Privacy Policy."})})]})})},JS=e=>e.toLowerCase().replace(/[^\w\s-]/g,"").replace(/\s+/g,"-").replace(/-+/g,"-").trim(),Gx=(e,t)=>`/movies/${JS(e)}?id=${t}`,jL=e=>new URLSearchParams(e).get("id"),UL=5*60*1e3;let ns=null;const VL=(e,t,r)=>{ns={userMovies:t,movies:r,timestamp:Date.now(),userId:e}},BL=e=>!ns||ns.userId!==e||Date.now()-ns.timestamp>UL?null:{userMovies:ns.userMovies,movies:ns.movies},ZS=()=>{ns=null},zL=(e,t,r)=>{ns&&ns.userId===e&&(ns.userMovies[t]=r,ns.timestamp=Date.now())},r0=async(e,t,r)=>{const n=Bt(We,`users/${e}/movies`,t);if((await $n(n)).exists()){const o={...r,updatedAt:new Date};r.rating===null&&(o.rating=null),r.watchedDate===null&&(o.watchedDate=null),r.review===null&&(o.review=null),await fi(n,o)}else{const o={userId:e,movieId:t,watched:r.watched||!1,favorite:r.favorite||!1,addedAt:new Date,updatedAt:new Date,...r};await Ps(n,o)}const a=await $n(n),i={id:a.id,...a.data()};return zL(e,t,i),i},Pp=async(e,t)=>{const r=Bt(We,`users/${e}/movies`,t),n=await $n(r);return n.exists()?{id:n.id,...n.data()}:null},eA=async e=>{const t=Gt(We,`users/${e}/movies`),r=await lr(t),n=[];return r.forEach(s=>{n.push({id:s.id,...s.data()})}),n},$L=async(e,t)=>{const r=Bt(We,`users/${e}/movies`,t);await jM(r),ZS()},Vu=async e=>{const t=BL(e);if(t)return t;const r=await eA(e),n={},s=[];r.forEach(o=>{n[o.movieId]=o,s.push(o.movieId)});const a=[];if(s.length>0)for(let l=0;l<s.length;l+=10){const u=s.slice(l,l+10).map(m=>$n(Bt(We,"movies",m)).then(p=>p.exists()?{id:p.id,...p.data()}:null).catch(p=>(console.error(`Error fetching movie ${m}:`,p),null))),d=await Promise.all(u);a.push(...d.filter(Boolean))}const i={userMovies:n,movies:a};return VL(e,n,a),i},WL=()=>{const{currentUser:e,userProfile:t}=Nn(),r=QS(),[n,s]=z.useState([]),[a,i]=z.useState({}),[o,l]=z.useState(!0),[c,u]=z.useState(!0),[d,m]=z.useState(null),[p,x]=z.useState("all"),[g,_]=z.useState({option:"title",direction:"asc"}),[k,T]=z.useState(""),[w,C]=z.useState("all"),[M,O]=z.useState(!1),[v,E]=z.useState(!1),[S,R]=z.useState(""),[P,D]=z.useState(""),[N,ce]=z.useState(""),[oe,de]=z.useState(!1),ge=Ms();Ls();const Z=W=>W.toLowerCase().trim().replace(/[^a-z0-9]+/g,"-").replace(/^-+|-+$/g,""),G=async()=>{if(e)try{de(!0);const W=Bt(We,"users",e.uid),Q={isPublicWatchlist:v,publicWatchlistName:S||null,publicWatchlistTagline:P||null,publicWatchlistSlug:N||null};if(v&&!Q.publicWatchlistSlug){const ue=S||(t==null?void 0:t.displayName)||"xmas-watchlist";Q.publicWatchlistSlug=Z(ue),ce(Q.publicWatchlistSlug)}if(await fi(W,Q),v&&Q.publicWatchlistSlug){const ue=Bt(We,"publicProfiles",Q.publicWatchlistSlug);await Ps(ue,{userId:e.uid,displayName:(t==null?void 0:t.displayName)||"",photoURL:(t==null?void 0:t.photoURL)||null,publicWatchlistName:Q.publicWatchlistName||null,publicWatchlistTagline:Q.publicWatchlistTagline||null,publicWatchlistSlug:Q.publicWatchlistSlug,isPublicWatchlist:!0},{merge:!0})}else if(!v&&N){const ue=Bt(We,"publicProfiles",N);await Ps(ue,{userId:e.uid,isPublicWatchlist:!1,publicWatchlistName:null,publicWatchlistTagline:null},{merge:!0})}r.success("Sharing settings saved")}catch(W){console.error("Error saving sharing settings:",W),r.error("Failed to save sharing settings")}finally{de(!1)}},ae=async()=>{if(N)try{const Q=`${window.location.origin}/u/${N}`;await navigator.clipboard.writeText(Q)}catch(W){console.error("Failed to copy link",W)}};z.useEffect(()=>{const W=new URLSearchParams(ge.search),Q=W.get("q")||"",ue=W.get("field")||"all";Q!==k&&T(Q),ue!==w&&C(ue)},[ge.search]),z.useEffect(()=>{t&&(E(!!t.isPublicWatchlist),R(t.publicWatchlistName||""),D(t.publicWatchlistTagline||""),ce(t.publicWatchlistSlug||""))},[t]),z.useEffect(()=>{v&&S&&(N||ce(Z(S)))},[v,S,N]),z.useEffect(()=>{(async()=>{if(e)try{u(!0);const{userMovies:Q,movies:ue}=await Vu(e.uid);i(Q),s(ue)}catch(Q){console.error("Error fetching movies:",Q),m("Failed to load movies")}finally{u(!1),l(!1)}})()},[e,ge.key]);const fe=W=>{_(Q=>Q.option===W?{option:W,direction:Q.direction==="asc"?"desc":"asc"}:{option:W,direction:"asc"})},B=z.useCallback(W=>{if(!k.trim())return!0;const Q=k.toLowerCase().trim(),ue=Q.split(",").map(me=>me.trim()).filter(Boolean),Ee=me=>W.cast&&W.cast.some(je=>je.toLowerCase().includes(me)),_e=a[W.id];switch(w){case"title":return W.title.toLowerCase().includes(Q)||W.sortTitle&&W.sortTitle.toLowerCase().includes(Q)||W.originalTitle&&W.originalTitle.toLowerCase().includes(Q);case"year":return W.releaseDate&&W.releaseDate.substring(0,4).includes(Q);case"cast":return ue.length?ue.some(me=>Ee(me)):Ee(Q);case"all":default:return W.title.toLowerCase().includes(Q)||W.sortTitle&&W.sortTitle.toLowerCase().includes(Q)||W.originalTitle&&W.originalTitle.toLowerCase().includes(Q)||W.releaseDate&&W.releaseDate.substring(0,4).includes(Q)||W.overview&&W.overview.toLowerCase().includes(Q)||W.genres&&W.genres.some(me=>me.toLowerCase().includes(Q))||W.directors&&W.directors.some(me=>me.toLowerCase().includes(Q))||W.cast&&W.cast.some(me=>me.toLowerCase().includes(Q))||_e&&_e.review&&_e.review.toLowerCase().includes(Q)}},[k,w,a]),K=z.useMemo(()=>{if(c)return[];l(!0);const W=n.filter(Q=>{const ue=a[Q.id];let Ee=!0;switch(p){case"watched":Ee=ue&&ue.watched;break;case"unwatched":Ee=!ue||!ue.watched;break;case"favorites":Ee=ue&&ue.favorite;break}return Ee&&B(Q)}).sort((Q,ue)=>{const Ee=a[Q.id],_e=a[ue.id],me=g.direction==="asc"?1:-1;switch(g.option){case"title":const je=Q.sortTitle||Q.title,H=ue.sortTitle||ue.title;return je.localeCompare(H)*me;case"year":const tt=Q.releaseDate?parseInt(Q.releaseDate.substring(0,4)):0,He=ue.releaseDate?parseInt(ue.releaseDate.substring(0,4)):0;return(tt-He)*me;case"rating":const Je=(Ee==null?void 0:Ee.rating)||0,De=(_e==null?void 0:_e.rating)||0;return(Je-De)*me;case"watched":const Ae=Ee!=null&&Ee.watched?1:0,_t=_e!=null&&_e.watched?1:0;return(Ae-_t)*me;default:return 0}});return l(!1),W},[n,a,p,g,k,w,c]),q=K;return c?f.jsx("div",{className:"flex justify-center items-center min-h-[60vh]",children:f.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-xmas-gold"})}):f.jsxs("div",{className:"container mx-auto px-2 sm:px-4 py-4 sm:py-8",children:[f.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-center mb-4 sm:mb-8 gap-3",children:[f.jsx("h1",{className:"font-christmas text-2xl sm:text-3xl md:text-4xl text-xmas-line",children:"My Christmas Movies"}),f.jsxs("div",{className:"flex gap-2 w-full sm:w-auto justify-center",children:[f.jsxs(Ye,{to:"/random",className:"btn btn-primary btn-sm sm:btn-md",children:[f.jsx("i",{className:"fas fa-random mr-1 sm:mr-2"})," ",f.jsx("span",{className:"hidden xs:inline",children:"Random Movie"}),f.jsx("span",{className:"xs:hidden",children:"Random"})]}),f.jsxs(Ye,{to:"/import",className:"btn btn-primary btn-sm sm:btn-md",children:[f.jsx("i",{className:"fas fa-file-import mr-1 sm:mr-2"})," ",f.jsx("span",{className:"hidden xs:inline",children:"Add Movies"}),f.jsx("span",{className:"xs:hidden",children:"Import"})]}),f.jsxs("button",{type:"button",className:"btn btn-outline btn-sm sm:btn-md",onClick:()=>O(!0),children:[f.jsx("i",{className:"fas fa-share-alt mr-1 sm:mr-2"}),f.jsx("span",{className:"hidden xs:inline",children:"Share"}),f.jsx("span",{className:"xs:hidden",children:"Share"})]})]})]}),d&&f.jsxs("div",{className:"alert alert-error mb-6",children:[f.jsx("i",{className:"fas fa-exclamation-circle mr-2"}),f.jsx("span",{children:d})]}),f.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 mb-3",children:[f.jsxs("div",{className:"relative flex-grow",children:[f.jsx("div",{className:"absolute inset-y-0 left-0 pl-2 flex items-center pointer-events-none",children:f.jsx("i",{className:"fas fa-search text-gray-400"})}),f.jsx("input",{type:"text",className:"input input-bordered input-sm sm:input-md w-full pl-8 pr-8",placeholder:"   Search movies...",value:k,onChange:W=>T(W.target.value)}),k&&f.jsx("button",{className:"absolute inset-y-0 right-0 pr-2 flex items-center",onClick:()=>T(""),children:f.jsx("i",{className:"fas fa-times text-gray-400 hover:text-gray-600"})})]}),f.jsxs("select",{className:"select select-bordered select-sm sm:select-md w-full sm:w-36",value:w,onChange:W=>C(W.target.value),children:[f.jsx("option",{value:"all",children:"All Fields"}),f.jsx("option",{value:"title",children:"Title Only"}),f.jsx("option",{value:"year",children:"Year Only"}),f.jsx("option",{value:"cast",children:"Cast Only"})]})]}),f.jsxs("div",{className:"tabs tabs-boxed mb-3 text-xs sm:text-sm overflow-x-auto",children:[f.jsx("button",{className:`tab ${p==="all"?"tab-active":""}`,onClick:()=>x("all"),children:"All Movies"}),f.jsx("button",{className:`tab ${p==="watched"?"tab-active":""}`,onClick:()=>x("watched"),children:"Watched"}),f.jsx("button",{className:`tab ${p==="unwatched"?"tab-active":""}`,onClick:()=>x("unwatched"),children:"Watch"}),f.jsxs("button",{className:`tab ${p==="favorites"?"tab-active":""}`,onClick:()=>x("favorites"),children:[f.jsx("span",{className:"hidden sm:inline",children:"Favourites"}),f.jsx("span",{className:"sm:hidden",children:"Favs"})]})]}),f.jsxs("div",{className:"flex flex-wrap items-center gap-1 mb-3 bg-xmas-card bg-opacity-50 p-2 rounded-lg overflow-x-auto",children:[f.jsx("span",{className:"text-xs sm:text-sm font-medium mr-1",children:"Sort:"}),f.jsxs("div",{className:"flex flex-nowrap gap-1 overflow-x-auto",children:[f.jsxs("button",{className:`btn btn-xs ${g.option==="title"?"btn-primary":"btn-ghost"}`,onClick:()=>fe("title"),children:["Title ",g.option==="title"&&f.jsx("i",{className:`fas fa-sort-${g.direction==="asc"?"up":"down"} ml-1`})]}),f.jsxs("button",{className:`btn btn-xs ${g.option==="year"?"btn-primary":"btn-ghost"}`,onClick:()=>fe("year"),children:["Year ",g.option==="year"&&f.jsx("i",{className:`fas fa-sort-${g.direction==="asc"?"up":"down"} ml-1`})]}),f.jsxs("button",{className:`btn btn-xs ${g.option==="rating"?"btn-primary":"btn-ghost"}`,onClick:()=>fe("rating"),children:["Rating ",g.option==="rating"&&f.jsx("i",{className:`fas fa-sort-${g.direction==="asc"?"up":"down"} ml-1`})]}),f.jsxs("button",{className:`btn btn-xs ${g.option==="watched"?"btn-primary":"btn-ghost"}`,onClick:()=>fe("watched"),children:[f.jsx("span",{className:"hidden sm:inline",children:"Watched Status"}),f.jsx("span",{className:"sm:hidden",children:"Watched"}),g.option==="watched"&&f.jsx("i",{className:`fas fa-sort-${g.direction==="asc"?"up":"down"} ml-1`})]})]})]}),f.jsxs("div",{className:"flex flex-col xs:flex-row justify-between items-start xs:items-center mb-3 text-xs sm:text-sm",children:[f.jsxs("div",{children:[f.jsx("span",{className:"font-medium",children:K.length})," ",K.length===1?"movie":"movies"," found",k&&f.jsxs("span",{className:"ml-1 text-xmas-mute",children:["for: ",f.jsxs("span",{className:"font-medium",children:['"',k,'"']})]})]}),g.option&&f.jsxs("div",{className:"text-xmas-mute",children:["Sorted by ",f.jsx("span",{className:"font-medium",children:g.option})," (",g.direction==="asc"?"asc":"desc",")"]})]}),o&&!c&&f.jsx("div",{className:"flex justify-center items-center py-4",children:f.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-t-2 border-b-2 border-xmas-gold"})}),K.length===0?f.jsxs("div",{className:"bg-xmas-card p-8 rounded-lg text-center",children:[f.jsx("h3",{className:"text-xl mb-4",children:"No movies found"}),f.jsx("p",{className:"mb-4",children:p==="all"?"You haven't added any Christmas movies yet.":`You don't have any ${p} Christmas movies.`}),f.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 justify-center",children:[f.jsxs(Ye,{to:"/import",className:"btn btn-primary",children:[f.jsx("i",{className:"fas fa-file-import mr-2"})," Add Movies"]}),n.length>0&&f.jsxs(Ye,{to:"/random",className:"btn btn-primary",children:[f.jsx("i",{className:"fas fa-random mr-2"})," Random Movie"]})]})]}):f.jsx("div",{className:"grid grid-cols-3 sm:grid-cols-4 md:grid-cols-5 lg:grid-cols-6 gap-2 sm:gap-3",children:q.map(W=>{var ue;const Q=a[W.id];return f.jsx(Ye,{to:Gx(W.title,W.id),state:{from:"movies"},className:"block transition-transform hover:scale-[1.02] hover:shadow-xl",children:f.jsxs("div",{className:"relative rounded-lg overflow-hidden bg-xmas-card shadow-md h-full flex flex-col",children:[f.jsxs("div",{className:"relative",children:[W.posterUrl?f.jsx("img",{src:W.posterUrl,alt:W.title,className:"w-full h-auto object-cover",style:{aspectRatio:"2/3"},loading:"lazy"}):f.jsx("div",{className:"w-full flex items-center justify-center bg-gray-800",style:{aspectRatio:"2/3"},children:f.jsx("i",{className:"fas fa-film text-2xl text-gray-500"})}),Q&&Q.watched&&f.jsx("div",{className:"absolute top-1 right-1 bg-primary rounded-full p-1 shadow-md",children:f.jsx("i",{className:"fas fa-check text-xs text-white"})}),Q&&Q.favorite&&f.jsx("div",{className:"absolute top-1 left-1 text-yellow-400 drop-shadow-md",children:f.jsx("i",{className:"fas fa-star text-sm"})})]}),f.jsxs("div",{className:"p-1 sm:p-2 flex-grow flex flex-col",children:[f.jsx("h3",{className:"text-xs sm:text-sm font-medium line-clamp-2",children:W.title}),f.jsxs("div",{className:"flex justify-between items-center mt-1",children:[f.jsx("p",{className:"text-xs text-gray-400",children:(ue=W.releaseDate)==null?void 0:ue.substring(0,4)}),Q&&Q.rating&&f.jsxs("div",{className:"flex items-center",children:[f.jsx("span",{className:"text-yellow-400 mr-0.5",children:f.jsx("i",{className:"fas fa-star text-xs"})}),f.jsx("span",{className:"text-xs",children:Q.rating})]})]})]})]})},W.id)})}),M&&f.jsxs("dialog",{className:"modal modal-open",children:[f.jsxs("div",{className:"modal-box max-w-lg",children:[f.jsx("h3",{className:"font-bold text-lg mb-2",children:"Share your watchlist"}),f.jsx("p",{className:"text-sm mb-4",children:"Create a shareable page that shows your watched Christmas movies, ratings and vibes."}),f.jsx("div",{className:"form-control mb-4",children:f.jsxs("label",{className:"label cursor-pointer",children:[f.jsx("span",{className:"label-text",children:"Make my watchlist public"}),f.jsx("input",{type:"checkbox",className:"toggle toggle-primary",checked:v,onChange:W=>E(W.target.checked)})]})}),f.jsxs("div",{className:"grid grid-cols-1 gap-3",children:[f.jsxs("div",{className:"form-control",children:[f.jsx("label",{className:"label",children:f.jsx("span",{className:"label-text",children:"Public display name"})}),f.jsx("input",{type:"text",className:"input input-bordered input-sm sm:input-md",value:S,onChange:W=>R(W.target.value),placeholder:"My Xmas Movies"})]}),f.jsxs("div",{className:"form-control",children:[f.jsx("label",{className:"label",children:f.jsx("span",{className:"label-text",children:"Tagline / bio (optional)"})}),f.jsx("input",{type:"text",className:"input input-bordered input-sm sm:input-md",value:P,onChange:W=>D(W.target.value),placeholder:"Only the coziest Xmas movies allowed"})]}),N&&f.jsxs("div",{className:"mt-1 text-xs text-xmas-mute",children:["Your public link: ",f.jsxs("span",{className:"font-mono",children:["/u/",N]})]})]}),f.jsxs("div",{className:"modal-action flex flex-wrap gap-2 justify-between",children:[f.jsxs("div",{className:"flex gap-2",children:[f.jsxs("button",{className:"btn btn-primary btn-sm",onClick:G,disabled:oe,children:[oe&&f.jsx("span",{className:"loading loading-spinner loading-xs mr-1"}),"Save"]}),f.jsxs("button",{type:"button",className:"btn btn-outline btn-sm",onClick:ae,disabled:!N,children:[f.jsx("i",{className:"fas fa-link mr-2"}),"Copy link"]})]}),f.jsx("button",{type:"button",className:"btn btn-ghost btn-sm",onClick:()=>O(!1),children:"Close"})]})]}),f.jsx("form",{method:"dialog",className:"modal-backdrop",onClick:()=>O(!1),children:f.jsx("button",{children:"close"})})]})]})},Dp=Bt(We,"stats","global");async function HL(){(await $n(Dp)).exists()||await Ps(Dp,{watchedTotal:0,updatedAt:new Date},{merge:!0})}async function GL(e){await HL(),await fi(Dp,{watchedTotal:BM(e),updatedAt:new Date})}const KL=[{id:"heartwarming",label:"Heartwarming",emoji:"",type:"positive"},{id:"very_christmassy",label:"Very Christmassy",emoji:"",type:"positive"},{id:"snowy",label:"Snowy Setting",emoji:"",type:"positive"},{id:"funny",label:"Funny",emoji:"",type:"positive"},{id:"cheesy",label:"Cheesy (Good Way)",emoji:"",type:"positive"},{id:"romantic",label:"Romantic",emoji:"",type:"positive"},{id:"family_friendly",label:"Family Friendly",emoji:"",type:"positive"},{id:"background",label:"Good Background Watch",emoji:"",type:"positive"},{id:"tearjerker",label:"Emotional",emoji:"",type:"positive"},{id:"rewatch",label:"Would Rewatch",emoji:"",type:"positive"}],qL=[{id:"slow",label:"Slow Pacing",emoji:"",type:"negative"},{id:"boring",label:"A Bit Boring",emoji:"",type:"negative"},{id:"low_christmas",label:"Low Xmas Vibes",emoji:"",type:"negative"},{id:"weak_chemistry",label:"Weak Chemistry",emoji:"",type:"negative"},{id:"confusing",label:"Confusing Plot",emoji:"",type:"negative"},{id:"too_long",label:"Too Long",emoji:"",type:"negative"},{id:"cringey",label:"Cringey",emoji:"",type:"negative"},{id:"fake_snow",label:"Fake Snow",emoji:"",type:"negative"},{id:"hammy",label:"Hammy",emoji:"",type:"negative"}],XL={heartwarming:"heartwarming",very_christmassy:"full of Christmas vibes",snowy:"with a lovely snowy setting",funny:"with some funny moments",cheesy:"a bit cheesy in a good way",romantic:"with sweet romantic moments",family_friendly:"very family friendly",background:"great as a cosy background watch",tearjerker:"quite emotional at times",rewatch:"something I'd happily rewatch"},YL={slow:"quite slow in places",boring:"a bit boring overall",low_christmas:"lighter on Christmas vibes than expected",weak_chemistry:"with weak chemistry between the leads",confusing:"a bit confusing at times",too_long:"longer than it needed to be",cringey:"a bit cringey in parts",fake_snow:"with fake snow",hammy:"hammy overacting"};function QL(e){return!e||e<=0?"An easy-going Christmas movie.":e>=9?"Absolutely loved this Christmas movie.":e>=8?"Really enjoyed this festive watch.":e>=7?"A good Christmas movie I liked overall.":e>=6?"A decent cosy watch with some nice moments.":e>=5?"An okay Christmas movie, but nothing special.":e>=3?"Not really my thing, it had a few issues.":"I didn't enjoy this Christmas movie very much."}function K_(e){if(e.length===0)return"";if(e.length===1)return e[0];const t=e[e.length-1];return`${e.slice(0,-1).join(", ")} and ${t}`}function JL(e){const t=e.map(s=>XL[s]).filter(Boolean),r=e.map(s=>YL[s]).filter(Boolean);let n="";return t.length&&(n+=` It felt ${K_(t)}.`),r.length&&(n+=` However, it was ${K_(r)}.`),n}const ZL=({rating:e,initialTags:t=[],initialAutoReview:r="",onChange:n})=>{const[s,a]=z.useState(t),[i,o]=z.useState(r);z.useEffect(()=>{a(t)},[t.join("|")]),z.useEffect(()=>{o(r)},[r]);const l=d=>{a(m=>m.includes(d)?m.filter(p=>p!==d):[...m,d])},c=()=>{const d=QL(e),m=JL(s),p=(d+m).trim();o(p),n&&n({tags:s,autoReview:p})},u=d=>s.includes(d);return f.jsxs("div",{className:"mt-4",children:[f.jsxs("div",{className:"flex items-center justify-between mb-2",children:[f.jsx("h3",{className:"text-lg font-semibold text-primary",children:"Quick Vibe Review"}),f.jsx("span",{className:"text-xs opacity-80",children:"Pick a few that fit, then generate."})]}),f.jsx("p",{className:"text-xs mb-1 opacity-80",children:"What worked?"}),f.jsx("div",{className:"flex flex-wrap gap-2 mb-3",children:KL.map(d=>f.jsxs("button",{type:"button",onClick:()=>l(d.id),className:`btn btn-xs rounded-full border ${u(d.id)?"btn-accent text-base-100":"btn-ghost border-base-300 text-sm"}`,children:[f.jsx("span",{className:"mr-1",children:d.emoji}),d.label]},d.id))}),f.jsx("p",{className:"text-xs mb-1 opacity-80",children:"What didn't?"}),f.jsx("div",{className:"flex flex-wrap gap-2 mb-3",children:qL.map(d=>f.jsxs("button",{type:"button",onClick:()=>l(d.id),className:`btn btn-xs rounded-full border ${u(d.id)?"btn-error text-base-100":"btn-ghost border-base-300 text-sm"}`,children:[f.jsx("span",{className:"mr-1",children:d.emoji}),d.label]},d.id))}),f.jsx("button",{type:"button",onClick:c,className:"btn btn-sm btn-primary",children:" Generate Review From Tags"}),i&&f.jsxs("p",{className:"mt-3 text-sm opacity-90 italic",children:["Generated preview: ",i,""]})]})},e6=({watched:e,watchedDate:t,onWatchedDateChange:r,rating:n,onRatingChange:s,review:a,onReviewChange:i,vibeTags:o,onVibeChange:l,saving:c,onSave:u})=>f.jsxs(f.Fragment,{children:[f.jsx("h2",{className:"text-2xl font-christmas text-xmas-gold mb-4",children:"Your Rating & Review"}),e&&f.jsxs("div",{className:"form-control mb-4",children:[f.jsx("label",{className:"label",children:f.jsx("span",{className:"label-text",children:"Date Watched"})}),f.jsx("input",{type:"date",className:"input input-bordered",value:t,onChange:d=>r(d.target.value)})]}),f.jsxs("div",{className:"form-control mb-4",children:[f.jsx("label",{className:"label",children:f.jsx("span",{className:"label-text",children:"Your Rating"})}),f.jsx("div",{className:"rating rating-lg",children:[1,2,3,4,5,6,7,8,9,10].map(d=>f.jsx("input",{type:"radio",name:"rating",className:`mask mask-star-2 ${d<=5?"bg-orange-400":"bg-yellow-400"}`,checked:n===d,onChange:()=>s(d)},d))}),n&&f.jsx("div",{className:"mt-2",children:f.jsx("button",{className:"btn btn-xs btn-ghost",onClick:()=>s(null),children:"Clear Rating"})})]}),f.jsx(ZL,{rating:n,initialTags:o,initialAutoReview:a,onChange:l}),f.jsxs("div",{className:"form-control mb-6 mt-4",children:[f.jsx("label",{className:"label",children:f.jsx("span",{className:"label-text",children:"Your Review"})}),f.jsx("textarea",{className:"textarea textarea-bordered h-32",placeholder:"Write your thoughts about this movie...",value:a,onChange:d=>i(d.target.value)})]}),f.jsx("div",{className:"flex justify-end",children:f.jsx("button",{className:"btn btn-primary btn-sm sm:btn-md",onClick:u,disabled:c,children:c?f.jsxs(f.Fragment,{children:[f.jsx("span",{className:"loading loading-spinner loading-sm mr-2"}),"Saving..."]}):f.jsxs(f.Fragment,{children:[f.jsx("i",{className:"fas fa-save mr-2"}),"Save Changes"]})})})]}),t6=()=>{var G;const{movieId:e}=Kg(),t=Ms(),r=Ls(),{currentUser:n}=Nn(),s=QS(),a=jL(t.search),o=((G=t.state)==null?void 0:G.from)==="import"?"/import":"/movies",[l,c]=z.useState(null),[u,d]=z.useState(null),[m,p]=z.useState(!0),[x,g]=z.useState(null),[_,k]=z.useState(!1),[T,w]=z.useState(!1),[C,M]=z.useState(""),[O,v]=z.useState(null),[E,S]=z.useState(""),[R,P]=z.useState(!1),[D,N]=z.useState([]),ce=z.useRef(null);z.useEffect(()=>{(async()=>{if(!n||!a){g("Movie not found"),p(!1);return}try{p(!0);const fe=await $n(Bt(We,"movies",a));if(!fe.exists()){g("Movie not found"),p(!1);return}const B={id:fe.id,...fe.data()};c(B);const K=await Pp(n.uid,a);if(K){d(K),w(K.watched);let q="";if(K.watchedDate)try{if(K.watchedDate instanceof Date)q=K.watchedDate.toISOString().split("T")[0];else{const W=K.watchedDate;if(typeof W=="object"&&W!==null&&"seconds"in W){const Q=W;q=new Date(Q.seconds*1e3).toISOString().split("T")[0]}else{const Q=new Date(K.watchedDate);isNaN(Q.getTime())||(q=Q.toISOString().split("T")[0])}}}catch(W){console.error("Error parsing watchedDate:",W)}M(q),v(K.rating||null),S(K.review||""),P(K.favorite),N(K.vibeTags||[])}}catch(fe){console.error("Error fetching movie data:",fe),g("Failed to load movie data")}finally{p(!1)}})()},[n,a]),z.useEffect(()=>{T&&ce.current&&typeof window<"u"&&window.innerWidth<768&&ce.current.scrollIntoView({behavior:"smooth",block:"start"})},[T]);const oe=async()=>{if(!(!n||!a||!l))try{k(!0);const ae={userId:n.uid,movieId:a,watched:T,favorite:R,updatedAt:new Date,vibeTags:D};if(T&&C)try{ae.watchedDate=new Date(C),isNaN(ae.watchedDate.getTime())&&delete ae.watchedDate}catch(K){console.error("Error parsing watchedDate for save:",K),delete ae.watchedDate}else T||(ae.watchedDate=null);ae.rating=O,ae.review=E||null;const fe=await r0(n.uid,a,ae);d(fe);const B=await oh(n.uid);if(B.length){const K=B.map(q=>{var W;return((W=Xo.find(Q=>Q.id===q))==null?void 0:W.name)||q}).join(", ");s.success(`You unlocked: ${K}! `)}}catch(ae){console.error("Error saving movie data:",ae),g("Failed to save movie data")}finally{k(!1)}},de=async()=>{if(!n||!a)return;const ae=!R;P(ae);try{const fe=Bt(We,"users",n.uid,"movies",a);(await $n(fe)).exists()?await fi(fe,{favorite:ae,updatedAt:new Date}):await Ps(fe,{userId:n.uid,movieId:a,favorite:ae,watched:!1,rating:null,review:"",vibeTags:[],addedAt:new Date,updatedAt:new Date},{merge:!0}),d(q=>q&&{...q,favorite:ae});const K=await oh(n.uid);if(K.length){const q=K.map(W=>{var Q;return((Q=Xo.find(ue=>ue.id===W))==null?void 0:Q.name)||W}).join(", ");s.success(`You unlocked: ${q}! `)}}catch(fe){console.error("Failed to toggle favorite",fe),P(!ae)}},ge=async()=>{if(!(!n||!a||!window.confirm("Are you sure you want to remove this movie from your collection?")))try{k(!0),await $L(n.uid,a),r("/movies")}catch(ae){console.error("Error deleting movie:",ae),g("Failed to delete movie"),k(!1)}},Z=async()=>{if(!n||!a)return;const ae=!T;w(ae);try{const fe=Bt(We,"users",n.uid,"movies",a),B=await $n(fe),K=B.exists()?!!B.data().watched:!1;B.exists()?await fi(fe,{watched:ae,...ae?{}:{watchedDate:null},updatedAt:new Date}):await Ps(fe,{userId:n.uid,movieId:a,watched:ae,favorite:!1,rating:null,review:"",vibeTags:[],addedAt:new Date,updatedAt:new Date},{merge:!0}),d(W=>W&&{...W,watched:ae}),K!==ae&&await GL(ae?1:-1);const q=await oh(n.uid);if(q.length){const W=q.map(Q=>{var ue;return((ue=Xo.find(Ee=>Ee.id===Q))==null?void 0:ue.name)||Q}).join(", ");s.success(`You unlocked: ${W}! `)}}catch(fe){console.error("Failed to toggle watched",fe),w(!ae)}};return m?f.jsx("div",{className:"flex justify-center items-center min-h-[60vh]",children:f.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-xmas-gold"})}):l?f.jsxs("div",{className:"container mx-auto px-4 py-8",children:[f.jsx("div",{className:"mb-4",children:f.jsxs(Ye,{to:o,className:"btn btn-primary btn-sm sm:btn-md",children:[f.jsx("i",{className:"fas fa-arrow-left mr-2"})," Back to Movies"]})}),x&&f.jsxs("div",{className:"alert alert-error mb-6",children:[f.jsx("i",{className:"fas fa-exclamation-circle mr-2"}),f.jsx("span",{children:x})]}),f.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-8",children:[f.jsxs("div",{className:"md:col-span-1",children:[f.jsx("div",{className:"rounded-lg overflow-hidden shadow-xl",children:l.posterUrl?f.jsx("img",{src:l.posterUrl,alt:l.title,className:"w-full object-contain",style:{aspectRatio:"2/3"}}):f.jsx("div",{className:"w-full flex items-center justify-center bg-gray-800",style:{aspectRatio:"2/3"},children:f.jsx("i",{className:"fas fa-film text-6xl text-gray-500"})})}),f.jsxs("div",{className:"mt-4 flex flex-col gap-2",children:[f.jsxs("button",{className:`btn ${R?"btn-primary":"btn-outline"} w-full`,onClick:de,children:[f.jsx("i",{className:`fas fa-star mr-2 ${R?"text-white":""}`}),R?"Favourited":"Add to Favourites"]}),f.jsxs("button",{className:`btn ${T?"btn-success":"btn-outline"} w-full`,onClick:Z,children:[f.jsx("i",{className:`fas fa-check mr-2 ${T?"text-white":""}`}),T?"Watched":"Mark as Watched"]}),f.jsxs("button",{className:"btn btn-error btn-outline w-full",onClick:ge,disabled:_,children:[f.jsx("i",{className:"fas fa-trash mr-2"}),"Remove from Collection"]}),l.tmdbId&&f.jsxs("div",{className:"mt-2 flex flex-col items-center",children:[f.jsx("a",{href:`https://www.themoviedb.org/movie/${l.tmdbId}`,target:"_blank",rel:"noopener noreferrer",className:"btn btn-outline w-full flex items-center justify-center gap-2",children:f.jsx("img",{src:"/tmdb.svg",alt:"TMDB",className:"h-5"})}),f.jsx("p",{className:"mt-2 text-xs text-gray-400 text-center",children:"This product uses the TMDB API but is not endorsed or certified by TMDB."})]})]})]}),f.jsxs("div",{className:"md:col-span-2",children:[f.jsx("h1",{className:"font-christmas text-3xl md:text-4xl text-xmas-line mb-2",children:l.title}),l.releaseDate&&f.jsx("p",{className:"text-lg text-gray-400 mb-4",children:new Date(l.releaseDate).getFullYear()}),l.genres&&l.genres.length>0&&f.jsx("div",{className:"flex flex-wrap gap-2 mb-4",children:l.genres.map((ae,fe)=>f.jsx("span",{className:"badge badge-outline",children:ae},fe))}),l.runtime&&f.jsxs("p",{className:"mb-4",children:[f.jsx("i",{className:"fas fa-clock mr-2 text-xmas-gold"}),Math.floor(l.runtime/60),"h ",l.runtime%60,"m"]}),l.overview&&f.jsxs("div",{className:"mb-6",children:[f.jsx("h2",{className:"text-xl font-bold mb-2",children:"Overview"}),f.jsx("p",{className:"text-gray-300",children:l.overview})]}),l.directors&&l.directors.length>0&&f.jsxs("div",{className:"mb-4",children:[f.jsxs("h2",{className:"text-xl font-bold mb-2",children:["Director",l.directors.length>1?"s":""]}),f.jsx("p",{children:l.directors.join(", ")})]}),l.cast&&l.cast.length>0&&f.jsxs("div",{className:"mb-6",children:[f.jsx("h2",{className:"text-xl font-bold mb-2",children:"Cast"}),f.jsx("p",{className:"flex flex-wrap gap-1",children:l.cast.slice(0,10).map((ae,fe)=>f.jsxs(vu.Fragment,{children:[f.jsx(Ye,{to:`/movies?q=${encodeURIComponent(ae)}&field=cast`,className:"link link-primary",children:ae}),fe<Math.min(l.cast.length,10)-1&&f.jsx("span",{children:","})]},ae))})]}),f.jsxs("div",{ref:ce,children:[f.jsx("div",{className:"divider"}),T&&f.jsx(e6,{watched:T,watchedDate:C,onWatchedDateChange:M,rating:O,onRatingChange:v,review:E,onReviewChange:S,vibeTags:D,onVibeChange:({tags:ae,autoReview:fe})=>{N(ae),S(fe)},saving:_,onSave:oe})]})]})]})]}):f.jsxs("div",{className:"container mx-auto px-4 py-8",children:[f.jsxs("div",{className:"alert alert-error",children:[f.jsx("i",{className:"fas fa-exclamation-circle mr-2"}),f.jsx("span",{children:"Movie not found"})]}),f.jsx("div",{className:"mt-4",children:f.jsxs(Ye,{to:o,className:"btn btn-primary btn-sm sm:btn-md",children:[f.jsx("i",{className:"fas fa-arrow-left mr-2"})," Back to Movies"]})})]})};function q_(e,t){let r=0;const n=(e.title||"").toLowerCase(),s=(t.title||"").toLowerCase();if(n&&s)if(n===s)r+=60;else if(s.includes(n)||n.includes(s))r+=40;else{const a=n.split(" "),i=s.split(" "),o=a.filter(l=>i.includes(l));r+=o.length/Math.max(a.length,i.length)*40}if(e.releaseDate&&t.release_date){const a=e.releaseDate.slice(0,4),i=t.release_date.slice(0,4);a===i?r+=40:Math.abs(parseInt(a)-parseInt(i))<=1&&(r+=20)}return Math.min(Math.round(r),100)}const Ts=e=>e!=null&&e.poster_path?`https://image.tmdb.org/t/p/w500${e.poster_path}`:(e==null?void 0:e.posterUrl)||"",r6=({onSelect:e,userMovieIds:t})=>{const r=Ls(),[n,s]=z.useState([]),[a,i]=z.useState(!0),[o,l]=z.useState(null),[c,u]=z.useState(""),[d,m]=z.useState("all"),[p,x]=z.useState("title-asc"),[g,_]=z.useState(!1);z.useEffect(()=>{(async()=>{try{i(!0),l(null);const O=(await lr(Gt(We,"movies"))).docs.map(v=>{var S;const E=v.data();return E.tmdbId?{id:E.tmdbId,title:E.title,release_date:E.releaseDate,poster_path:(S=E.posterUrl)!=null&&S.startsWith("https://image.tmdb.org/t/p/")?E.posterUrl.replace("https://image.tmdb.org/t/p/w500",""):null,source:"local",firestoreId:v.id,cast:E.cast||[],runtime:E.runtime,genres:E.genres||[],overview:E.overview}:null}).filter(Boolean);s(O)}catch(M){console.error("Error loading local catalogue:",M),l((M==null?void 0:M.message)??"Failed to load local catalogue")}finally{i(!1)}})()},[]);const k=z.useCallback(C=>{if(!c.trim())return!0;const M=c.toLowerCase().trim(),O=M.split(",").map(E=>E.trim()).filter(Boolean),v=E=>C.cast&&C.cast.some(S=>S.toLowerCase().includes(E));switch(d){case"title":return C.title.toLowerCase().includes(M);case"year":return C.release_date&&C.release_date.substring(0,4).includes(M);case"cast":return O.length?O.some(E=>v(E)):v(M);case"all":default:return C.title.toLowerCase().includes(M)||C.release_date&&C.release_date.substring(0,4).includes(M)||C.cast&&C.cast.some(E=>E.toLowerCase().includes(M))}},[c,d]),T=z.useMemo(()=>n.filter(C=>{if(!k(C))return!1;const M=!!C.firestoreId&&t.includes(C.firestoreId);return!(g&&M)}),[n,k,t,g]),w=z.useMemo(()=>{const C=[...T],M=O=>{if(!O.release_date)return 0;const v=parseInt(O.release_date.slice(0,4),10);return Number.isNaN(v)?0:v};return C.sort((O,v)=>{switch(p){case"title-asc":return O.title.localeCompare(v.title);case"title-desc":return v.title.localeCompare(O.title);case"year-desc":{const E=M(O);return M(v)-E||O.title.localeCompare(v.title)}case"year-asc":{const E=M(O),S=M(v);return E-S||O.title.localeCompare(v.title)}default:return 0}}),C},[T,p]);return f.jsxs("div",{className:"space-y-4",children:[f.jsxs("div",{className:"flex flex-col lg:flex-row gap-2",children:[f.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 flex-1",children:[f.jsxs("div",{className:"relative flex-grow",children:[f.jsx("div",{className:"absolute inset-y-0 left-0 pl-2 flex items-center pointer-events-none",children:f.jsx("i",{className:"fas fa-search text-gray-400"})}),f.jsx("input",{type:"text",className:"input input-bordered input-sm sm:input-md w-full pl-8 pr-8",placeholder:"   Search catalogue by title, cast, year...",value:c,onChange:C=>u(C.target.value)}),c&&f.jsx("button",{className:"absolute inset-y-0 right-0 pr-2 flex items-center",onClick:()=>u(""),children:f.jsx("i",{className:"fas fa-times text-gray-400 hover:text-gray-600"})})]}),f.jsxs("select",{className:"select select-bordered select-sm sm:select-md w-full sm:w-40",value:d,onChange:C=>m(C.target.value),children:[f.jsx("option",{value:"all",children:"All Fields"}),f.jsx("option",{value:"title",children:"Title Only"}),f.jsx("option",{value:"year",children:"Year Only"}),f.jsx("option",{value:"cast",children:"Cast Only"})]})]}),f.jsx("div",{className:"flex items-center justify-end",children:f.jsxs("select",{className:"select select-bordered select-sm sm:select-md w-full sm:w-52",value:p,onChange:C=>x(C.target.value),children:[f.jsx("option",{value:"title-asc",children:"Sort: Title (A  Z)"}),f.jsx("option",{value:"title-desc",children:"Sort: Title (Z  A)"}),f.jsx("option",{value:"year-desc",children:"Sort: Year (Newest  Oldest)"}),f.jsx("option",{value:"year-asc",children:"Sort: Year (Oldest  Newest)"})]})})]}),f.jsxs("div",{className:"flex flex-col xs:flex-row justify-between items-start xs:items-center text-xs sm:text-sm gap-2",children:[f.jsx("div",{children:a?f.jsx("span",{children:"Loading catalogue"}):f.jsxs(f.Fragment,{children:[f.jsx("span",{className:"font-medium",children:w.length})," ",w.length===1?"movie":"movies"," in catalogue",c&&f.jsxs("span",{className:"ml-1 opacity-70",children:["for: ",f.jsxs("span",{className:"font-medium",children:['"',c,'"']})]})]})}),f.jsxs("label",{className:"flex items-center gap-1 cursor-pointer select-none",children:[f.jsx("input",{type:"checkbox",className:"checkbox checkbox-xs sm:checkbox-sm",checked:g,onChange:C=>_(C.target.checked)}),f.jsx("span",{children:"Hide owned movies"})]})]}),o&&f.jsx("div",{className:"alert alert-error",children:o}),a&&f.jsx("div",{className:"flex justify-center p-6",children:f.jsx("span",{className:"loading loading-spinner loading-lg"})}),!a&&w.length===0&&!o&&f.jsxs("div",{className:"bg-xmas-card bg-opacity-60 rounded-lg p-6 text-center",children:[f.jsx("h3",{className:"text-lg font-semibold mb-2",children:"No movies found"}),f.jsx("p",{className:"text-sm opacity-80 mb-2",children:"Try changing your search text, field, or sort order."})]}),!a&&w.length>0&&f.jsx("div",{className:"grid grid-cols-3 sm:grid-cols-4 md:grid-cols-5 lg:grid-cols-6 gap-2 sm:gap-3",children:w.map(C=>{var O;const M=!!C.firestoreId&&t.includes(C.firestoreId);return f.jsx("div",{className:`block transition-transform hover:scale-[1.02] hover:shadow-xl ${M?"opacity-60 cursor-pointer":"cursor-pointer"}`,onClick:()=>{M&&C.firestoreId?r(Gx(C.title,C.firestoreId),{state:{from:"import"}}):e(C)},children:f.jsxs("div",{className:"relative rounded-lg overflow-hidden bg-xmas-card shadow-md h-full flex flex-col",children:[f.jsxs("div",{className:"relative",children:[Ts(C)?f.jsx("img",{src:Ts(C),alt:C.title,className:"w-full h-auto object-cover",style:{aspectRatio:"2/3"},loading:"lazy"}):f.jsx("div",{className:"w-full flex items-center justify-center bg-gray-800",style:{aspectRatio:"2/3"},children:f.jsx("i",{className:"fas fa-film text-2xl text-gray-500"})}),M&&f.jsxs("div",{className:`\r
                          absolute top-1 left-1 \r
                          badge badge-success \r
                          px-2 py-0.5 \r
                          text-[0.6rem] leading-none \r
                          whitespace-nowrap \r
                          flex items-center gap-1 \r
                          shadow\r
                        `,children:[f.jsx("i",{className:"fas fa-check text-[0.6rem]"}),f.jsx("span",{children:"Owned"})]})]}),f.jsxs("div",{className:"p-1 sm:p-2 flex-grow flex flex-col",children:[f.jsx("h3",{className:"text-xs sm:text-sm font-medium line-clamp-2",children:C.title}),f.jsx("p",{className:"text-xs text-gray-400 mt-1",children:(O=C.release_date)==null?void 0:O.slice(0,4)})]})]})},C.firestoreId||C.id)})})]})},tA=e=>{const t=e.trim();return/^The\s+/i.test(t)?t.replace(/^The\s+/i,"").trim():/^A\s+/i.test(t)?t.replace(/^A\s+/i,"").trim():/^An\s+/i.test(t)?t.replace(/^An\s+/i,"").trim():t},rA="https://api.themoviedb.org/3",n6="https://image.tmdb.org/t/p/w500",s6="https://image.tmdb.org/t/p/original",nA=e=>(e||"").toLowerCase().replace(/^(the|a|an)\s+/,"").replace(/[^a-z0-9]+/g," ").trim(),a6=e=>{var n;const t=new Set,r=s=>{const a=nA(s||"");a&&(t.add(a),a.split(" ").forEach(i=>i&&t.add(i)))};return r(e.title),r(e.original_title),e.release_date&&t.add(e.release_date.slice(0,4)),(e.genres||[]).forEach(s=>r(s==null?void 0:s.name)),(((n=e.credits)==null?void 0:n.cast)||[]).slice(0,5).forEach(s=>r(s==null?void 0:s.name)),Array.from(t).slice(0,200)},Fp=async(e,t)=>{const r=await fetch(`${rA}/search/movie?api_key=${t}&query=${encodeURIComponent(e)}&include_adult=false`);if(!r.ok)throw new Error(`TMDB API error: ${r.status}`);return await r.json()},ed=async(e,t)=>{const r=await fetch(`${rA}/movie/${e}?api_key=${t}&append_to_response=credits`);if(!r.ok)throw new Error(`TMDB API error: ${r.status}`);return await r.json()},Kx=e=>{var n,s,a,i,o,l;const t=tA(e.title),r=nA(t);return{tmdbId:e.id,title:e.title,sortTitle:t,sortTitleLower:r,originalTitle:e.original_title,releaseDate:e.release_date,posterUrl:e.poster_path?`${n6}${e.poster_path}`:void 0,backdropUrl:e.backdrop_path?`${s6}${e.backdrop_path}`:void 0,overview:e.overview,runtime:e.runtime,genres:((n=e.genres)==null?void 0:n.map(c=>c.name))||[],directors:((i=(a=(s=e.credits)==null?void 0:s.crew)==null?void 0:a.filter(c=>c.job==="Director"))==null?void 0:i.map(c=>c.name))||[],cast:((l=(o=e.credits)==null?void 0:o.cast)==null?void 0:l.slice(0,10).map(c=>c.name))||[],isChristmas:!0,keywords:a6(e),updatedAt:new Date}},i6=({tmdbApiKey:e,onSelect:t})=>{const[r,n]=z.useState(""),[s,a]=z.useState(!1),[i,o]=z.useState([]),[l,c]=z.useState(null),u=async()=>{if(r.trim())try{a(!0),c(null);const d=await Fp(r,e);o(d.results)}catch(d){c((d==null?void 0:d.message)??"TMDB search failed")}finally{a(!1)}};return f.jsxs("div",{className:"space-y-3",children:[f.jsxs("div",{className:"flex gap-2",children:[f.jsx("input",{className:"input input-bordered flex-1",value:r,onChange:d=>n(d.target.value),placeholder:"Search TMDB...",onKeyDown:d=>d.key==="Enter"&&u()}),f.jsx("button",{className:"btn btn-primary",onClick:u,disabled:s||!e,children:s?f.jsx("span",{className:"loading loading-spinner loading-sm"}):"Search"})]}),l&&f.jsx("div",{className:"alert alert-error",children:l}),i.length>0&&f.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-3",children:i.map(d=>{var m;return f.jsxs("div",{className:"card bg-base-100 shadow cursor-pointer hover:shadow-lg transition-shadow",onClick:()=>t(d),children:[f.jsx("figure",{children:Ts(d)?f.jsx("img",{src:Ts(d),alt:d.title,className:"w-full h-64 object-contain"}):f.jsx("div",{className:"h-64 w-full flex items-center justify-center bg-base-200",children:f.jsx("i",{className:"fas fa-film text-3xl opacity-50"})})}),f.jsxs("div",{className:"card-body p-3",children:[f.jsx("div",{className:"font-semibold",children:d.title}),f.jsx("div",{className:"text-xs opacity-70",children:(m=d.release_date)==null?void 0:m.slice(0,4)})]})]},d.id)})})]})};/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var sA=1252,o6=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],qx={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},Xx=function(e){o6.indexOf(e)!=-1&&(sA=qx[0]=e)};function l6(){Xx(1252)}var is=function(e){Xx(e)};function aA(){is(1200),l6()}function X_(e){for(var t=[],r=0,n=e.length;r<n;++r)t[r]=e.charCodeAt(r);return t}function c6(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r)+(e.charCodeAt(2*r+1)<<8));return t.join("")}function iA(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r+1)+(e.charCodeAt(2*r)<<8));return t.join("")}var ac=function(e){var t=e.charCodeAt(0),r=e.charCodeAt(1);return t==255&&r==254?c6(e.slice(2)):t==254&&r==255?iA(e.slice(2)):t==65279?e.slice(1):e},Rf=function(t){return String.fromCharCode(t)},Y_=function(t){return String.fromCharCode(t)},lu,Ha="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function Q_(e){for(var t="",r=0,n=0,s=0,a=0,i=0,o=0,l=0,c=0;c<e.length;)r=e.charCodeAt(c++),a=r>>2,n=e.charCodeAt(c++),i=(r&3)<<4|n>>4,s=e.charCodeAt(c++),o=(n&15)<<2|s>>6,l=s&63,isNaN(n)?o=l=64:isNaN(s)&&(l=64),t+=Ha.charAt(a)+Ha.charAt(i)+Ha.charAt(o)+Ha.charAt(l);return t}function An(e){var t="",r=0,n=0,s=0,a=0,i=0,o=0,l=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var c=0;c<e.length;)a=Ha.indexOf(e.charAt(c++)),i=Ha.indexOf(e.charAt(c++)),r=a<<2|i>>4,t+=String.fromCharCode(r),o=Ha.indexOf(e.charAt(c++)),n=(i&15)<<4|o>>2,o!==64&&(t+=String.fromCharCode(n)),l=Ha.indexOf(e.charAt(c++)),s=(o&3)<<6|l,l!==64&&(t+=String.fromCharCode(s));return t}var et=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),io=function(){if(typeof Buffer<"u"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(t,r){return r?new Buffer(t,r):new Buffer(t)}:Buffer.from.bind(Buffer)}return function(){}}();function hi(e){return et?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}function J_(e){return et?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}var ss=function(t){return et?io(t,"binary"):t.split("").map(function(r){return r.charCodeAt(0)&255})};function oo(e){if(Array.isArray(e))return e.map(function(n){return String.fromCharCode(n)}).join("");for(var t=[],r=0;r<e.length;++r)t[r]=String.fromCharCode(e[r]);return t.join("")}function Yx(e){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(e instanceof ArrayBuffer)return Yx(new Uint8Array(e));for(var t=new Array(e.length),r=0;r<e.length;++r)t[r]=e[r];return t}var Va=et?function(e){return Buffer.concat(e.map(function(t){return Buffer.isBuffer(t)?t:io(t)}))}:function(e){if(typeof Uint8Array<"u"){var t=0,r=0;for(t=0;t<e.length;++t)r+=e[t].length;var n=new Uint8Array(r),s=0;for(t=0,r=0;t<e.length;r+=s,++t)if(s=e[t].length,e[t]instanceof Uint8Array)n.set(e[t],r);else{if(typeof e[t]=="string")throw"wtf";n.set(new Uint8Array(e[t]),r)}return n}return[].concat.apply([],e.map(function(a){return Array.isArray(a)?a:[].slice.call(a)}))};function u6(e){for(var t=[],r=0,n=e.length+250,s=hi(e.length+255),a=0;a<e.length;++a){var i=e.charCodeAt(a);if(i<128)s[r++]=i;else if(i<2048)s[r++]=192|i>>6&31,s[r++]=128|i&63;else if(i>=55296&&i<57344){i=(i&1023)+64;var o=e.charCodeAt(++a)&1023;s[r++]=240|i>>8&7,s[r++]=128|i>>2&63,s[r++]=128|o>>6&15|(i&3)<<4,s[r++]=128|o&63}else s[r++]=224|i>>12&15,s[r++]=128|i>>6&63,s[r++]=128|i&63;r>n&&(t.push(s.slice(0,r)),r=0,s=hi(65535),n=65530)}return t.push(s.slice(0,r)),Va(t)}var Zr=/\u0000/g,ic=/[\u0001-\u0006]/g;function Yo(e){for(var t="",r=e.length-1;r>=0;)t+=e.charAt(r--);return t}function os(e,t){var r=""+e;return r.length>=t?r:Vt("0",t-r.length)+r}function Qx(e,t){var r=""+e;return r.length>=t?r:Vt(" ",t-r.length)+r}function td(e,t){var r=""+e;return r.length>=t?r:r+Vt(" ",t-r.length)}function f6(e,t){var r=""+Math.round(e);return r.length>=t?r:Vt("0",t-r.length)+r}function h6(e,t){var r=""+e;return r.length>=t?r:Vt("0",t-r.length)+r}var Z_=Math.pow(2,32);function wo(e,t){if(e>Z_||e<-Z_)return f6(e,t);var r=Math.round(e);return h6(r,t)}function rd(e,t){return t=t||0,e.length>=7+t&&(e.charCodeAt(t)|32)===103&&(e.charCodeAt(t+1)|32)===101&&(e.charCodeAt(t+2)|32)===110&&(e.charCodeAt(t+3)|32)===101&&(e.charCodeAt(t+4)|32)===114&&(e.charCodeAt(t+5)|32)===97&&(e.charCodeAt(t+6)|32)===108}var ew=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],Z0=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function d6(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"/ "hh""mm""ss" "',e}var $e={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},tw={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},m6={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function nd(e,t,r){for(var n=e<0?-1:1,s=e*n,a=0,i=1,o=0,l=1,c=0,u=0,d=Math.floor(s);c<t&&(d=Math.floor(s),o=d*i+a,u=d*c+l,!(s-d<5e-8));)s=1/(s-d),a=i,i=o,l=c,c=u;if(u>t&&(c>t?(u=l,o=a):(u=c,o=i)),!r)return[0,n*o,u];var m=Math.floor(n*o/u);return[m,n*o-m*u,u]}function Fi(e,t,r){if(e>2958465||e<0)return null;var n=e|0,s=Math.floor(86400*(e-n)),a=0,i=[],o={D:n,T:s,u:86400*(e-n)-s,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(o.u)<1e-6&&(o.u=0),t&&t.date1904&&(n+=1462),o.u>.9999&&(o.u=0,++s==86400&&(o.T=s=0,++n,++o.D)),n===60)i=r?[1317,10,29]:[1900,2,29],a=3;else if(n===0)i=r?[1317,8,29]:[1900,1,0],a=6;else{n>60&&--n;var l=new Date(1900,0,1);l.setDate(l.getDate()+n-1),i=[l.getFullYear(),l.getMonth()+1,l.getDate()],a=l.getDay(),n<60&&(a=(a+6)%7),r&&(a=_6(l,i))}return o.y=i[0],o.m=i[1],o.d=i[2],o.S=s%60,s=Math.floor(s/60),o.M=s%60,s=Math.floor(s/60),o.H=s,o.q=a,o}var oA=new Date(1899,11,31,0,0,0),p6=oA.getTime(),g6=new Date(1900,2,1,0,0,0);function lA(e,t){var r=e.getTime();return t?r-=1461*24*60*60*1e3:e>=g6&&(r+=24*60*60*1e3),(r-(p6+(e.getTimezoneOffset()-oA.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function Jx(e){return e.indexOf(".")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function x6(e){return e.indexOf("E")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function v6(e){var t=e<0?12:11,r=Jx(e.toFixed(12));return r.length<=t||(r=e.toPrecision(10),r.length<=t)?r:e.toExponential(5)}function y6(e){var t=Jx(e.toFixed(11));return t.length>(e<0?12:11)||t==="0"||t==="-0"?e.toPrecision(6):t}function cu(e){var t=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),r;return t>=-4&&t<=-1?r=e.toPrecision(10+t):Math.abs(t)<=9?r=v6(e):t===10?r=e.toFixed(10).substr(0,12):r=y6(e),Jx(x6(r.toUpperCase()))}function Qi(e,t){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):cu(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return Gn(14,lA(e,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+e)}function _6(e,t){t[0]-=581;var r=e.getDay();return e<60&&(r=(r+6)%7),r}function w6(e,t,r,n){var s="",a=0,i=0,o=r.y,l,c=0;switch(e){case 98:o=r.y+543;case 121:switch(t.length){case 1:case 2:l=o%100,c=2;break;default:l=o%1e4,c=4;break}break;case 109:switch(t.length){case 1:case 2:l=r.m,c=t.length;break;case 3:return Z0[r.m-1][1];case 5:return Z0[r.m-1][0];default:return Z0[r.m-1][2]}break;case 100:switch(t.length){case 1:case 2:l=r.d,c=t.length;break;case 3:return ew[r.q][0];default:return ew[r.q][1]}break;case 104:switch(t.length){case 1:case 2:l=1+(r.H+11)%12,c=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:l=r.H,c=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:l=r.M,c=t.length;break;default:throw"bad minute format: "+t}break;case 115:if(t!="s"&&t!="ss"&&t!=".0"&&t!=".00"&&t!=".000")throw"bad second format: "+t;return r.u===0&&(t=="s"||t=="ss")?os(r.S,t.length):(n>=2?i=n===3?1e3:100:i=n===1?10:1,a=Math.round(i*(r.S+r.u)),a>=60*i&&(a=0),t==="s"?a===0?"0":""+a/i:(s=os(a,2+n),t==="ss"?s.substr(0,2):"."+s.substr(2,t.length-1)));case 90:switch(t){case"[h]":case"[hh]":l=r.D*24+r.H;break;case"[m]":case"[mm]":l=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":l=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+t}c=t.length===3?1:2;break;case 101:l=o,c=1;break}var u=c>0?os(l,c):"";return u}function Ga(e){var t=3;if(e.length<=t)return e;for(var r=e.length%t,n=e.substr(0,r);r!=e.length;r+=t)n+=(n.length>0?",":"")+e.substr(r,t);return n}var cA=/%/g;function E6(e,t,r){var n=t.replace(cA,""),s=t.length-n.length;return la(e,n,r*Math.pow(10,2*s))+Vt("%",s)}function T6(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return la(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function uA(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+uA(e,-t);var s=e.indexOf(".");s===-1&&(s=e.indexOf("E"));var a=Math.floor(Math.log(t)*Math.LOG10E)%s;if(a<0&&(a+=s),r=(t/Math.pow(10,a)).toPrecision(n+1+(s+a)%s),r.indexOf("e")===-1){var i=Math.floor(Math.log(t)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(i-r.length+a):r+="E+"+(i-a);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,s)+"."+r.substr(2+s),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,l,c,u){return l+c+u.substr(0,(s+a)%s)+"."+u.substr(a)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var fA=/# (\?+)( ?)\/( ?)(\d+)/;function k6(e,t,r){var n=parseInt(e[4],10),s=Math.round(t*n),a=Math.floor(s/n),i=s-a*n,o=n;return r+(a===0?"":""+a)+" "+(i===0?Vt(" ",e[1].length+1+e[4].length):Qx(i,e[1].length)+e[2]+"/"+e[3]+os(o,e[4].length))}function S6(e,t,r){return r+(t===0?"":""+t)+Vt(" ",e[1].length+2+e[4].length)}var hA=/^#*0*\.([0#]+)/,dA=/\).*[0#]/,mA=/\(###\) ###\\?-####/;function Xr(e){for(var t="",r,n=0;n!=e.length;++n)switch(r=e.charCodeAt(n)){case 35:break;case 63:t+=" ";break;case 48:t+="0";break;default:t+=String.fromCharCode(r)}return t}function rw(e,t){var r=Math.pow(10,t);return""+Math.round(e*r)/r}function nw(e,t){var r=e-Math.floor(e),n=Math.pow(10,t);return t<(""+Math.round(r*n)).length?0:Math.round(r*n)}function A6(e,t){return t<(""+Math.round((e-Math.floor(e))*Math.pow(10,t))).length?1:0}function I6(e){return e<2147483647&&e>-2147483648?""+(e>=0?e|0:e-1|0):""+Math.floor(e)}function Fn(e,t,r){if(e.charCodeAt(0)===40&&!t.match(dA)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Fn("n",n,r):"("+Fn("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return T6(e,t,r);if(t.indexOf("%")!==-1)return E6(e,t,r);if(t.indexOf("E")!==-1)return uA(t,r);if(t.charCodeAt(0)===36)return"$"+Fn(e,t.substr(t.charAt(1)==" "?2:1),r);var s,a,i,o,l=Math.abs(r),c=r<0?"-":"";if(t.match(/^00+$/))return c+wo(l,t.length);if(t.match(/^[#?]+$/))return s=wo(r,0),s==="0"&&(s=""),s.length>t.length?s:Xr(t.substr(0,t.length-s.length))+s;if(a=t.match(fA))return k6(a,l,c);if(t.match(/^#+0+$/))return c+wo(l,t.length-t.indexOf("0"));if(a=t.match(hA))return s=rw(r,a[1].length).replace(/^([^\.]+)$/,"$1."+Xr(a[1])).replace(/\.$/,"."+Xr(a[1])).replace(/\.(\d*)$/,function(x,g){return"."+g+Vt("0",Xr(a[1]).length-g.length)}),t.indexOf("0.")!==-1?s:s.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),a=t.match(/^(0*)\.(#*)$/))return c+rw(l,a[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,a[1].length?"0.":".");if(a=t.match(/^#{1,3},##0(\.?)$/))return c+Ga(wo(l,0));if(a=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Fn(e,t,-r):Ga(""+(Math.floor(r)+A6(r,a[1].length)))+"."+os(nw(r,a[1].length),a[1].length);if(a=t.match(/^#,#*,#0/))return Fn(e,t.replace(/^#,#*,/,""),r);if(a=t.match(/^([0#]+)(\\?-([0#]+))+$/))return s=Yo(Fn(e,t.replace(/[\\-]/g,""),r)),i=0,Yo(Yo(t.replace(/\\/g,"")).replace(/[0#]/g,function(x){return i<s.length?s.charAt(i++):x==="0"?"0":""}));if(t.match(mA))return s=Fn(e,"##########",r),"("+s.substr(0,3)+") "+s.substr(3,3)+"-"+s.substr(6);var u="";if(a=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(a[4].length,7),o=nd(l,Math.pow(10,i)-1,!1),s=""+c,u=la("n",a[1],o[1]),u.charAt(u.length-1)==" "&&(u=u.substr(0,u.length-1)+"0"),s+=u+a[2]+"/"+a[3],u=td(o[2],i),u.length<a[4].length&&(u=Xr(a[4].substr(a[4].length-u.length))+u),s+=u,s;if(a=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(Math.max(a[1].length,a[4].length),7),o=nd(l,Math.pow(10,i)-1,!0),c+(o[0]||(o[1]?"":"0"))+" "+(o[1]?Qx(o[1],i)+a[2]+"/"+a[3]+td(o[2],i):Vt(" ",2*i+1+a[2].length+a[3].length));if(a=t.match(/^[#0?]+$/))return s=wo(r,0),t.length<=s.length?s:Xr(t.substr(0,t.length-s.length))+s;if(a=t.match(/^([#0?]+)\.([#0]+)$/)){s=""+r.toFixed(Math.min(a[2].length,10)).replace(/([^0])0+$/,"$1"),i=s.indexOf(".");var d=t.indexOf(".")-i,m=t.length-s.length-d;return Xr(t.substr(0,d)+s+t.substr(t.length-m))}if(a=t.match(/^00,000\.([#0]*0)$/))return i=nw(r,a[1].length),r<0?"-"+Fn(e,t,-r):Ga(I6(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(x){return"00,"+(x.length<3?os(0,3-x.length):"")+x})+"."+os(i,a[1].length);switch(t){case"###,##0.00":return Fn(e,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var p=Ga(wo(l,0));return p!=="0"?c+p:"";case"###,###.00":return Fn(e,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return Fn(e,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+t+"|")}function C6(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return la(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function N6(e,t,r){var n=t.replace(cA,""),s=t.length-n.length;return la(e,n,r*Math.pow(10,2*s))+Vt("%",s)}function pA(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+pA(e,-t);var s=e.indexOf(".");s===-1&&(s=e.indexOf("E"));var a=Math.floor(Math.log(t)*Math.LOG10E)%s;if(a<0&&(a+=s),r=(t/Math.pow(10,a)).toPrecision(n+1+(s+a)%s),!r.match(/[Ee]/)){var i=Math.floor(Math.log(t)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(i-r.length+a):r+="E+"+(i-a),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,l,c,u){return l+c+u.substr(0,(s+a)%s)+"."+u.substr(a)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function ys(e,t,r){if(e.charCodeAt(0)===40&&!t.match(dA)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?ys("n",n,r):"("+ys("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return C6(e,t,r);if(t.indexOf("%")!==-1)return N6(e,t,r);if(t.indexOf("E")!==-1)return pA(t,r);if(t.charCodeAt(0)===36)return"$"+ys(e,t.substr(t.charAt(1)==" "?2:1),r);var s,a,i,o,l=Math.abs(r),c=r<0?"-":"";if(t.match(/^00+$/))return c+os(l,t.length);if(t.match(/^[#?]+$/))return s=""+r,r===0&&(s=""),s.length>t.length?s:Xr(t.substr(0,t.length-s.length))+s;if(a=t.match(fA))return S6(a,l,c);if(t.match(/^#+0+$/))return c+os(l,t.length-t.indexOf("0"));if(a=t.match(hA))return s=(""+r).replace(/^([^\.]+)$/,"$1."+Xr(a[1])).replace(/\.$/,"."+Xr(a[1])),s=s.replace(/\.(\d*)$/,function(x,g){return"."+g+Vt("0",Xr(a[1]).length-g.length)}),t.indexOf("0.")!==-1?s:s.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),a=t.match(/^(0*)\.(#*)$/))return c+(""+l).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,a[1].length?"0.":".");if(a=t.match(/^#{1,3},##0(\.?)$/))return c+Ga(""+l);if(a=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+ys(e,t,-r):Ga(""+r)+"."+Vt("0",a[1].length);if(a=t.match(/^#,#*,#0/))return ys(e,t.replace(/^#,#*,/,""),r);if(a=t.match(/^([0#]+)(\\?-([0#]+))+$/))return s=Yo(ys(e,t.replace(/[\\-]/g,""),r)),i=0,Yo(Yo(t.replace(/\\/g,"")).replace(/[0#]/g,function(x){return i<s.length?s.charAt(i++):x==="0"?"0":""}));if(t.match(mA))return s=ys(e,"##########",r),"("+s.substr(0,3)+") "+s.substr(3,3)+"-"+s.substr(6);var u="";if(a=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(a[4].length,7),o=nd(l,Math.pow(10,i)-1,!1),s=""+c,u=la("n",a[1],o[1]),u.charAt(u.length-1)==" "&&(u=u.substr(0,u.length-1)+"0"),s+=u+a[2]+"/"+a[3],u=td(o[2],i),u.length<a[4].length&&(u=Xr(a[4].substr(a[4].length-u.length))+u),s+=u,s;if(a=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(Math.max(a[1].length,a[4].length),7),o=nd(l,Math.pow(10,i)-1,!0),c+(o[0]||(o[1]?"":"0"))+" "+(o[1]?Qx(o[1],i)+a[2]+"/"+a[3]+td(o[2],i):Vt(" ",2*i+1+a[2].length+a[3].length));if(a=t.match(/^[#0?]+$/))return s=""+r,t.length<=s.length?s:Xr(t.substr(0,t.length-s.length))+s;if(a=t.match(/^([#0]+)\.([#0]+)$/)){s=""+r.toFixed(Math.min(a[2].length,10)).replace(/([^0])0+$/,"$1"),i=s.indexOf(".");var d=t.indexOf(".")-i,m=t.length-s.length-d;return Xr(t.substr(0,d)+s+t.substr(t.length-m))}if(a=t.match(/^00,000\.([#0]*0)$/))return r<0?"-"+ys(e,t,-r):Ga(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(x){return"00,"+(x.length<3?os(0,3-x.length):"")+x})+"."+os(0,a[1].length);switch(t){case"###,###":case"##,###":case"#,###":var p=Ga(""+l);return p!=="0"?c+p:"";default:if(t.match(/\.[0#?]*$/))return ys(e,t.slice(0,t.lastIndexOf(".")),r)+Xr(t.slice(t.lastIndexOf(".")))}throw new Error("unsupported format |"+t+"|")}function la(e,t,r){return(r|0)===r?ys(e,t,r):Fn(e,t,r)}function R6(e){for(var t=[],r=!1,n=0,s=0;n<e.length;++n)switch(e.charCodeAt(n)){case 34:r=!r;break;case 95:case 42:case 92:++n;break;case 59:t[t.length]=e.substr(s,n-s),s=n+1}if(t[t.length]=e.substr(s),r===!0)throw new Error("Format |"+e+"| unterminated string ");return t}var gA=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function Al(e){for(var t=0,r="",n="";t<e.length;)switch(r=e.charAt(t)){case"G":rd(e,t)&&(t+=6),t++;break;case'"':for(;e.charCodeAt(++t)!==34&&t<e.length;);++t;break;case"\\":t+=2;break;case"_":t+=2;break;case"@":++t;break;case"B":case"b":if(e.charAt(t+1)==="1"||e.charAt(t+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(e.substr(t,3).toUpperCase()==="A/P"||e.substr(t,5).toUpperCase()==="AM/PM"||e.substr(t,5).toUpperCase()==="/")return!0;++t;break;case"[":for(n=r;e.charAt(t++)!=="]"&&t<e.length;)n+=e.charAt(t);if(n.match(gA))return!0;break;case".":case"0":case"#":for(;t<e.length&&("0#?.,E+-%".indexOf(r=e.charAt(++t))>-1||r=="\\"&&e.charAt(t+1)=="-"&&"0#".indexOf(e.charAt(t+2))>-1););break;case"?":for(;e.charAt(++t)===r;);break;case"*":++t,(e.charAt(t)==" "||e.charAt(t)=="*")&&++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<e.length&&"0123456789".indexOf(e.charAt(++t))>-1;);break;case" ":++t;break;default:++t;break}return!1}function b6(e,t,r,n){for(var s=[],a="",i=0,o="",l="t",c,u,d,m="H";i<e.length;)switch(o=e.charAt(i)){case"G":if(!rd(e,i))throw new Error("unrecognized character "+o+" in "+e);s[s.length]={t:"G",v:"General"},i+=7;break;case'"':for(a="";(d=e.charCodeAt(++i))!==34&&i<e.length;)a+=String.fromCharCode(d);s[s.length]={t:"t",v:a},++i;break;case"\\":var p=e.charAt(++i),x=p==="("||p===")"?p:"t";s[s.length]={t:x,v:p},++i;break;case"_":s[s.length]={t:"t",v:" "},i+=2;break;case"@":s[s.length]={t:"T",v:t},++i;break;case"B":case"b":if(e.charAt(i+1)==="1"||e.charAt(i+1)==="2"){if(c==null&&(c=Fi(t,r,e.charAt(i+1)==="2"),c==null))return"";s[s.length]={t:"X",v:e.substr(i,2)},l=o,i+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":o=o.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0||c==null&&(c=Fi(t,r),c==null))return"";for(a=o;++i<e.length&&e.charAt(i).toLowerCase()===o;)a+=o;o==="m"&&l.toLowerCase()==="h"&&(o="M"),o==="h"&&(o=m),s[s.length]={t:o,v:a},l=o;break;case"A":case"a":case"":var g={t:o,v:o};if(c==null&&(c=Fi(t,r)),e.substr(i,3).toUpperCase()==="A/P"?(c!=null&&(g.v=c.H>=12?"P":"A"),g.t="T",m="h",i+=3):e.substr(i,5).toUpperCase()==="AM/PM"?(c!=null&&(g.v=c.H>=12?"PM":"AM"),g.t="T",i+=5,m="h"):e.substr(i,5).toUpperCase()==="/"?(c!=null&&(g.v=c.H>=12?"":""),g.t="T",i+=5,m="h"):(g.t="t",++i),c==null&&g.t==="T")return"";s[s.length]=g,l=o;break;case"[":for(a=o;e.charAt(i++)!=="]"&&i<e.length;)a+=e.charAt(i);if(a.slice(-1)!=="]")throw'unterminated "[" block: |'+a+"|";if(a.match(gA)){if(c==null&&(c=Fi(t,r),c==null))return"";s[s.length]={t:"Z",v:a.toLowerCase()},l=a.charAt(1)}else a.indexOf("$")>-1&&(a=(a.match(/\$([^-\[\]]*)/)||[])[1]||"$",Al(e)||(s[s.length]={t:"t",v:a}));break;case".":if(c!=null){for(a=o;++i<e.length&&(o=e.charAt(i))==="0";)a+=o;s[s.length]={t:"s",v:a};break}case"0":case"#":for(a=o;++i<e.length&&"0#?.,E+-%".indexOf(o=e.charAt(i))>-1;)a+=o;s[s.length]={t:"n",v:a};break;case"?":for(a=o;e.charAt(++i)===o;)a+=o;s[s.length]={t:o,v:a},l=o;break;case"*":++i,(e.charAt(i)==" "||e.charAt(i)=="*")&&++i;break;case"(":case")":s[s.length]={t:n===1?"t":o,v:o},++i;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(a=o;i<e.length&&"0123456789".indexOf(e.charAt(++i))>-1;)a+=e.charAt(i);s[s.length]={t:"D",v:a};break;case" ":s[s.length]={t:o,v:o},++i;break;case"$":s[s.length]={t:"t",v:"$"},++i;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(o)===-1)throw new Error("unrecognized character "+o+" in "+e);s[s.length]={t:"t",v:o},++i;break}var _=0,k=0,T;for(i=s.length-1,l="t";i>=0;--i)switch(s[i].t){case"h":case"H":s[i].t=m,l="h",_<1&&(_=1);break;case"s":(T=s[i].v.match(/\.0+$/))&&(k=Math.max(k,T[0].length-1)),_<3&&(_=3);case"d":case"y":case"M":case"e":l=s[i].t;break;case"m":l==="s"&&(s[i].t="M",_<2&&(_=2));break;case"X":break;case"Z":_<1&&s[i].v.match(/[Hh]/)&&(_=1),_<2&&s[i].v.match(/[Mm]/)&&(_=2),_<3&&s[i].v.match(/[Ss]/)&&(_=3)}switch(_){case 0:break;case 1:c.u>=.5&&(c.u=0,++c.S),c.S>=60&&(c.S=0,++c.M),c.M>=60&&(c.M=0,++c.H);break;case 2:c.u>=.5&&(c.u=0,++c.S),c.S>=60&&(c.S=0,++c.M);break}var w="",C;for(i=0;i<s.length;++i)switch(s[i].t){case"t":case"T":case" ":case"D":break;case"X":s[i].v="",s[i].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":s[i].v=w6(s[i].t.charCodeAt(0),s[i].v,c,k),s[i].t="t";break;case"n":case"?":for(C=i+1;s[C]!=null&&((o=s[C].t)==="?"||o==="D"||(o===" "||o==="t")&&s[C+1]!=null&&(s[C+1].t==="?"||s[C+1].t==="t"&&s[C+1].v==="/")||s[i].t==="("&&(o===" "||o==="n"||o===")")||o==="t"&&(s[C].v==="/"||s[C].v===" "&&s[C+1]!=null&&s[C+1].t=="?"));)s[i].v+=s[C].v,s[C]={v:"",t:";"},++C;w+=s[i].v,i=C-1;break;case"G":s[i].t="t",s[i].v=Qi(t,r);break}var M="",O,v;if(w.length>0){w.charCodeAt(0)==40?(O=t<0&&w.charCodeAt(0)===45?-t:t,v=la("n",w,O)):(O=t<0&&n>1?-t:t,v=la("n",w,O),O<0&&s[0]&&s[0].t=="t"&&(v=v.substr(1),s[0].v="-"+s[0].v)),C=v.length-1;var E=s.length;for(i=0;i<s.length;++i)if(s[i]!=null&&s[i].t!="t"&&s[i].v.indexOf(".")>-1){E=i;break}var S=s.length;if(E===s.length&&v.indexOf("E")===-1){for(i=s.length-1;i>=0;--i)s[i]==null||"n?".indexOf(s[i].t)===-1||(C>=s[i].v.length-1?(C-=s[i].v.length,s[i].v=v.substr(C+1,s[i].v.length)):C<0?s[i].v="":(s[i].v=v.substr(0,C+1),C=-1),s[i].t="t",S=i);C>=0&&S<s.length&&(s[S].v=v.substr(0,C+1)+s[S].v)}else if(E!==s.length&&v.indexOf("E")===-1){for(C=v.indexOf(".")-1,i=E;i>=0;--i)if(!(s[i]==null||"n?".indexOf(s[i].t)===-1)){for(u=s[i].v.indexOf(".")>-1&&i===E?s[i].v.indexOf(".")-1:s[i].v.length-1,M=s[i].v.substr(u+1);u>=0;--u)C>=0&&(s[i].v.charAt(u)==="0"||s[i].v.charAt(u)==="#")&&(M=v.charAt(C--)+M);s[i].v=M,s[i].t="t",S=i}for(C>=0&&S<s.length&&(s[S].v=v.substr(0,C+1)+s[S].v),C=v.indexOf(".")+1,i=E;i<s.length;++i)if(!(s[i]==null||"n?(".indexOf(s[i].t)===-1&&i!==E)){for(u=s[i].v.indexOf(".")>-1&&i===E?s[i].v.indexOf(".")+1:0,M=s[i].v.substr(0,u);u<s[i].v.length;++u)C<v.length&&(M+=v.charAt(C++));s[i].v=M,s[i].t="t",S=i}}}for(i=0;i<s.length;++i)s[i]!=null&&"n?".indexOf(s[i].t)>-1&&(O=n>1&&t<0&&i>0&&s[i-1].v==="-"?-t:t,s[i].v=la(s[i].t,s[i].v,O),s[i].t="t");var R="";for(i=0;i!==s.length;++i)s[i]!=null&&(R+=s[i].v);return R}var sw=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function aw(e,t){if(t==null)return!1;var r=parseFloat(t[2]);switch(t[1]){case"=":if(e==r)return!0;break;case">":if(e>r)return!0;break;case"<":if(e<r)return!0;break;case"<>":if(e!=r)return!0;break;case">=":if(e>=r)return!0;break;case"<=":if(e<=r)return!0;break}return!1}function P6(e,t){var r=R6(e),n=r.length,s=r[n-1].indexOf("@");if(n<4&&s>-1&&--n,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof t!="number")return[4,r.length===4||s>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=s>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=s>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=s>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var a=t>0?r[0]:t<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[n,a];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var i=r[0].match(sw),o=r[1].match(sw);return aw(t,i)?[n,r[0]]:aw(t,o)?[n,r[1]]:[n,r[i!=null&&o!=null?2:1]]}return[n,a]}function Gn(e,t,r){r==null&&(r={});var n="";switch(typeof e){case"string":e=="m/d/yy"&&r.dateNF?n=r.dateNF:n=e;break;case"number":e==14&&r.dateNF?n=r.dateNF:n=(r.table!=null?r.table:$e)[e],n==null&&(n=r.table&&r.table[tw[e]]||$e[tw[e]]),n==null&&(n=m6[e]||"General");break}if(rd(n,0))return Qi(t,r);t instanceof Date&&(t=lA(t,r.date1904));var s=P6(n,t);if(rd(s[1]))return Qi(t,r);if(t===!0)t="TRUE";else if(t===!1)t="FALSE";else if(t===""||t==null)return"";return b6(s[1],t,r,s[0])}function Ui(e,t){if(typeof t!="number"){t=+t||-1;for(var r=0;r<392;++r){if($e[r]==null){t<0&&(t=r);continue}if($e[r]==e){t=r;break}}t<0&&(t=391)}return $e[t]=e,t}function xA(){$e=d6()}var D6={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},vA=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function F6(e){var t=typeof e=="number"?$e[e]:e;return t=t.replace(vA,"(\\d+)"),new RegExp("^"+t+"$")}function O6(e,t,r){var n=-1,s=-1,a=-1,i=-1,o=-1,l=-1;(t.match(vA)||[]).forEach(function(d,m){var p=parseInt(r[m+1],10);switch(d.toLowerCase().charAt(0)){case"y":n=p;break;case"d":a=p;break;case"h":i=p;break;case"s":l=p;break;case"m":i>=0?o=p:s=p;break}}),l>=0&&o==-1&&s>=0&&(o=s,s=-1);var c=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(s>=1?s:1)).slice(-2)+"-"+("00"+(a>=1?a:1)).slice(-2);c.length==7&&(c="0"+c),c.length==8&&(c="20"+c);var u=("00"+(i>=0?i:0)).slice(-2)+":"+("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(l>=0?l:0)).slice(-2);return i==-1&&o==-1&&l==-1?c:n==-1&&s==-1&&a==-1?u:c+"T"+u}var M6=function(){var e={};e.version="1.2.0";function t(){for(var v=0,E=new Array(256),S=0;S!=256;++S)v=S,v=v&1?-306674912^v>>>1:v>>>1,v=v&1?-306674912^v>>>1:v>>>1,v=v&1?-306674912^v>>>1:v>>>1,v=v&1?-306674912^v>>>1:v>>>1,v=v&1?-306674912^v>>>1:v>>>1,v=v&1?-306674912^v>>>1:v>>>1,v=v&1?-306674912^v>>>1:v>>>1,v=v&1?-306674912^v>>>1:v>>>1,E[S]=v;return typeof Int32Array<"u"?new Int32Array(E):E}var r=t();function n(v){var E=0,S=0,R=0,P=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(R=0;R!=256;++R)P[R]=v[R];for(R=0;R!=256;++R)for(S=v[R],E=256+R;E<4096;E+=256)S=P[E]=S>>>8^v[S&255];var D=[];for(R=1;R!=16;++R)D[R-1]=typeof Int32Array<"u"?P.subarray(R*256,R*256+256):P.slice(R*256,R*256+256);return D}var s=n(r),a=s[0],i=s[1],o=s[2],l=s[3],c=s[4],u=s[5],d=s[6],m=s[7],p=s[8],x=s[9],g=s[10],_=s[11],k=s[12],T=s[13],w=s[14];function C(v,E){for(var S=E^-1,R=0,P=v.length;R<P;)S=S>>>8^r[(S^v.charCodeAt(R++))&255];return~S}function M(v,E){for(var S=E^-1,R=v.length-15,P=0;P<R;)S=w[v[P++]^S&255]^T[v[P++]^S>>8&255]^k[v[P++]^S>>16&255]^_[v[P++]^S>>>24]^g[v[P++]]^x[v[P++]]^p[v[P++]]^m[v[P++]]^d[v[P++]]^u[v[P++]]^c[v[P++]]^l[v[P++]]^o[v[P++]]^i[v[P++]]^a[v[P++]]^r[v[P++]];for(R+=15;P<R;)S=S>>>8^r[(S^v[P++])&255];return~S}function O(v,E){for(var S=E^-1,R=0,P=v.length,D=0,N=0;R<P;)D=v.charCodeAt(R++),D<128?S=S>>>8^r[(S^D)&255]:D<2048?(S=S>>>8^r[(S^(192|D>>6&31))&255],S=S>>>8^r[(S^(128|D&63))&255]):D>=55296&&D<57344?(D=(D&1023)+64,N=v.charCodeAt(R++)&1023,S=S>>>8^r[(S^(240|D>>8&7))&255],S=S>>>8^r[(S^(128|D>>2&63))&255],S=S>>>8^r[(S^(128|N>>6&15|(D&3)<<4))&255],S=S>>>8^r[(S^(128|N&63))&255]):(S=S>>>8^r[(S^(224|D>>12&15))&255],S=S>>>8^r[(S^(128|D>>6&63))&255],S=S>>>8^r[(S^(128|D&63))&255]);return~S}return e.table=r,e.bstr=C,e.buf=M,e.str=O,e}(),st=function(){var t={};t.version="1.2.1";function r(I,U){for(var b=I.split("/"),F=U.split("/"),L=0,j=0,Y=Math.min(b.length,F.length);L<Y;++L){if(j=b[L].length-F[L].length)return j;if(b[L]!=F[L])return b[L]<F[L]?-1:1}return b.length-F.length}function n(I){if(I.charAt(I.length-1)=="/")return I.slice(0,-1).indexOf("/")===-1?I:n(I.slice(0,-1));var U=I.lastIndexOf("/");return U===-1?I:I.slice(0,U+1)}function s(I){if(I.charAt(I.length-1)=="/")return s(I.slice(0,-1));var U=I.lastIndexOf("/");return U===-1?I:I.slice(U+1)}function a(I,U){typeof U=="string"&&(U=new Date(U));var b=U.getHours();b=b<<6|U.getMinutes(),b=b<<5|U.getSeconds()>>>1,I.write_shift(2,b);var F=U.getFullYear()-1980;F=F<<4|U.getMonth()+1,F=F<<5|U.getDate(),I.write_shift(2,F)}function i(I){var U=I.read_shift(2)&65535,b=I.read_shift(2)&65535,F=new Date,L=b&31;b>>>=5;var j=b&15;b>>>=4,F.setMilliseconds(0),F.setFullYear(b+1980),F.setMonth(j-1),F.setDate(L);var Y=U&31;U>>>=5;var ne=U&63;return U>>>=6,F.setHours(U),F.setMinutes(ne),F.setSeconds(Y<<1),F}function o(I){wr(I,0);for(var U={},b=0;I.l<=I.length-4;){var F=I.read_shift(2),L=I.read_shift(2),j=I.l+L,Y={};switch(F){case 21589:b=I.read_shift(1),b&1&&(Y.mtime=I.read_shift(4)),L>5&&(b&2&&(Y.atime=I.read_shift(4)),b&4&&(Y.ctime=I.read_shift(4))),Y.mtime&&(Y.mt=new Date(Y.mtime*1e3));break}I.l=j,U[F]=Y}return U}var l;function c(){return l||(l={})}function u(I,U){if(I[0]==80&&I[1]==75)return Sa(I,U);if((I[0]|32)==109&&(I[1]|32)==105)return po(I,U);if(I.length<512)throw new Error("CFB file size "+I.length+" < 512");var b=3,F=512,L=0,j=0,Y=0,ne=0,re=0,te=[],J=I.slice(0,512);wr(J,0);var he=d(J);switch(b=he[0],b){case 3:F=512;break;case 4:F=4096;break;case 0:if(he[1]==0)return Sa(I,U);default:throw new Error("Major Version: Expected 3 or 4 saw "+b)}F!==512&&(J=I.slice(0,F),wr(J,28));var Te=I.slice(0,F);m(J,b);var Ce=J.read_shift(4,"i");if(b===3&&Ce!==0)throw new Error("# Directory Sectors: Expected 0 saw "+Ce);J.l+=4,Y=J.read_shift(4,"i"),J.l+=4,J.chk("00100000","Mini Stream Cutoff Size: "),ne=J.read_shift(4,"i"),L=J.read_shift(4,"i"),re=J.read_shift(4,"i"),j=J.read_shift(4,"i");for(var ve=-1,ke=0;ke<109&&(ve=J.read_shift(4,"i"),!(ve<0));++ke)te[ke]=ve;var Fe=p(I,F);_(re,j,Fe,F,te);var it=T(Fe,Y,te,F);it[Y].name="!Directory",L>0&&ne!==N&&(it[ne].name="!MiniFAT"),it[te[0]].name="!FAT",it.fat_addrs=te,it.ssz=F;var qe={},mt=[],an=[],Ge=[];w(Y,it,Fe,mt,L,qe,an,ne),x(an,Ge,mt),mt.shift();var ht={FileIndex:an,FullPaths:Ge};return U&&U.raw&&(ht.raw={header:Te,sectors:Fe}),ht}function d(I){if(I[I.l]==80&&I[I.l+1]==75)return[0,0];I.chk(ce,"Header Signature: "),I.l+=16;var U=I.read_shift(2,"u");return[I.read_shift(2,"u"),U]}function m(I,U){var b=9;switch(I.l+=2,b=I.read_shift(2)){case 9:if(U!=3)throw new Error("Sector Shift: Expected 9 saw "+b);break;case 12:if(U!=4)throw new Error("Sector Shift: Expected 12 saw "+b);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+b)}I.chk("0600","Mini Sector Shift: "),I.chk("000000000000","Reserved: ")}function p(I,U){for(var b=Math.ceil(I.length/U)-1,F=[],L=1;L<b;++L)F[L-1]=I.slice(L*U,(L+1)*U);return F[b-1]=I.slice(b*U),F}function x(I,U,b){for(var F=0,L=0,j=0,Y=0,ne=0,re=b.length,te=[],J=[];F<re;++F)te[F]=J[F]=F,U[F]=b[F];for(;ne<J.length;++ne)F=J[ne],L=I[F].L,j=I[F].R,Y=I[F].C,te[F]===F&&(L!==-1&&te[L]!==L&&(te[F]=te[L]),j!==-1&&te[j]!==j&&(te[F]=te[j])),Y!==-1&&(te[Y]=F),L!==-1&&F!=te[F]&&(te[L]=te[F],J.lastIndexOf(L)<ne&&J.push(L)),j!==-1&&F!=te[F]&&(te[j]=te[F],J.lastIndexOf(j)<ne&&J.push(j));for(F=1;F<re;++F)te[F]===F&&(j!==-1&&te[j]!==j?te[F]=te[j]:L!==-1&&te[L]!==L&&(te[F]=te[L]));for(F=1;F<re;++F)if(I[F].type!==0){if(ne=F,ne!=te[ne])do ne=te[ne],U[F]=U[ne]+"/"+U[F];while(ne!==0&&te[ne]!==-1&&ne!=te[ne]);te[F]=-1}for(U[0]+="/",F=1;F<re;++F)I[F].type!==2&&(U[F]+="/")}function g(I,U,b){for(var F=I.start,L=I.size,j=[],Y=F;b&&L>0&&Y>=0;)j.push(U.slice(Y*D,Y*D+D)),L-=D,Y=Ii(b,Y*4);return j.length===0?nr(0):Va(j).slice(0,I.size)}function _(I,U,b,F,L){var j=N;if(I===N){if(U!==0)throw new Error("DIFAT chain shorter than expected")}else if(I!==-1){var Y=b[I],ne=(F>>>2)-1;if(!Y)return;for(var re=0;re<ne&&(j=Ii(Y,re*4))!==N;++re)L.push(j);_(Ii(Y,F-4),U-1,b,F,L)}}function k(I,U,b,F,L){var j=[],Y=[];L||(L=[]);var ne=F-1,re=0,te=0;for(re=U;re>=0;){L[re]=!0,j[j.length]=re,Y.push(I[re]);var J=b[Math.floor(re*4/F)];if(te=re*4&ne,F<4+te)throw new Error("FAT boundary crossed: "+re+" 4 "+F);if(!I[J])break;re=Ii(I[J],te)}return{nodes:j,data:pw([Y])}}function T(I,U,b,F){var L=I.length,j=[],Y=[],ne=[],re=[],te=F-1,J=0,he=0,Te=0,Ce=0;for(J=0;J<L;++J)if(ne=[],Te=J+U,Te>=L&&(Te-=L),!Y[Te]){re=[];var ve=[];for(he=Te;he>=0;){ve[he]=!0,Y[he]=!0,ne[ne.length]=he,re.push(I[he]);var ke=b[Math.floor(he*4/F)];if(Ce=he*4&te,F<4+Ce)throw new Error("FAT boundary crossed: "+he+" 4 "+F);if(!I[ke]||(he=Ii(I[ke],Ce),ve[he]))break}j[Te]={nodes:ne,data:pw([re])}}return j}function w(I,U,b,F,L,j,Y,ne){for(var re=0,te=F.length?2:0,J=U[I].data,he=0,Te=0,Ce;he<J.length;he+=128){var ve=J.slice(he,he+128);wr(ve,64),Te=ve.read_shift(2),Ce=nv(ve,0,Te-te),F.push(Ce);var ke={name:Ce,type:ve.read_shift(1),color:ve.read_shift(1),L:ve.read_shift(4,"i"),R:ve.read_shift(4,"i"),C:ve.read_shift(4,"i"),clsid:ve.read_shift(16),state:ve.read_shift(4,"i"),start:0,size:0},Fe=ve.read_shift(2)+ve.read_shift(2)+ve.read_shift(2)+ve.read_shift(2);Fe!==0&&(ke.ct=C(ve,ve.l-8));var it=ve.read_shift(2)+ve.read_shift(2)+ve.read_shift(2)+ve.read_shift(2);it!==0&&(ke.mt=C(ve,ve.l-8)),ke.start=ve.read_shift(4,"i"),ke.size=ve.read_shift(4,"i"),ke.size<0&&ke.start<0&&(ke.size=ke.type=0,ke.start=N,ke.name=""),ke.type===5?(re=ke.start,L>0&&re!==N&&(U[re].name="!StreamData")):ke.size>=4096?(ke.storage="fat",U[ke.start]===void 0&&(U[ke.start]=k(b,ke.start,U.fat_addrs,U.ssz)),U[ke.start].name=ke.name,ke.content=U[ke.start].data.slice(0,ke.size)):(ke.storage="minifat",ke.size<0?ke.size=0:re!==N&&ke.start!==N&&U[re]&&(ke.content=g(ke,U[re].data,(U[ne]||{}).data))),ke.content&&wr(ke.content,0),j[Ce]=ke,Y.push(ke)}}function C(I,U){return new Date((_n(I,U+4)/1e7*Math.pow(2,32)+_n(I,U)/1e7-11644473600)*1e3)}function M(I,U){return c(),u(l.readFileSync(I),U)}function O(I,U){var b=U&&U.type;switch(b||et&&Buffer.isBuffer(I)&&(b="buffer"),b||"base64"){case"file":return M(I,U);case"base64":return u(ss(An(I)),U);case"binary":return u(ss(I),U)}return u(I,U)}function v(I,U){var b=U||{},F=b.root||"Root Entry";if(I.FullPaths||(I.FullPaths=[]),I.FileIndex||(I.FileIndex=[]),I.FullPaths.length!==I.FileIndex.length)throw new Error("inconsistent CFB structure");I.FullPaths.length===0&&(I.FullPaths[0]=F+"/",I.FileIndex[0]={name:F,type:5}),b.CLSID&&(I.FileIndex[0].clsid=b.CLSID),E(I)}function E(I){var U="Sh33tJ5";if(!st.find(I,"/"+U)){var b=nr(4);b[0]=55,b[1]=b[3]=50,b[2]=54,I.FileIndex.push({name:U,type:2,content:b,size:4,L:69,R:69,C:69}),I.FullPaths.push(I.FullPaths[0]+U),S(I)}}function S(I,U){v(I);for(var b=!1,F=!1,L=I.FullPaths.length-1;L>=0;--L){var j=I.FileIndex[L];switch(j.type){case 0:F?b=!0:(I.FileIndex.pop(),I.FullPaths.pop());break;case 1:case 2:case 5:F=!0,isNaN(j.R*j.L*j.C)&&(b=!0),j.R>-1&&j.L>-1&&j.R==j.L&&(b=!0);break;default:b=!0;break}}if(!(!b&&!U)){var Y=new Date(1987,1,19),ne=0,re=Object.create?Object.create(null):{},te=[];for(L=0;L<I.FullPaths.length;++L)re[I.FullPaths[L]]=!0,I.FileIndex[L].type!==0&&te.push([I.FullPaths[L],I.FileIndex[L]]);for(L=0;L<te.length;++L){var J=n(te[L][0]);F=re[J],F||(te.push([J,{name:s(J).replace("/",""),type:1,clsid:de,ct:Y,mt:Y,content:null}]),re[J]=!0)}for(te.sort(function(Ce,ve){return r(Ce[0],ve[0])}),I.FullPaths=[],I.FileIndex=[],L=0;L<te.length;++L)I.FullPaths[L]=te[L][0],I.FileIndex[L]=te[L][1];for(L=0;L<te.length;++L){var he=I.FileIndex[L],Te=I.FullPaths[L];if(he.name=s(Te).replace("/",""),he.L=he.R=he.C=-(he.color=1),he.size=he.content?he.content.length:0,he.start=0,he.clsid=he.clsid||de,L===0)he.C=te.length>1?1:-1,he.size=0,he.type=5;else if(Te.slice(-1)=="/"){for(ne=L+1;ne<te.length&&n(I.FullPaths[ne])!=Te;++ne);for(he.C=ne>=te.length?-1:ne,ne=L+1;ne<te.length&&n(I.FullPaths[ne])!=n(Te);++ne);he.R=ne>=te.length?-1:ne,he.type=1}else n(I.FullPaths[L+1]||"")==n(Te)&&(he.R=L+1),he.type=2}}}function R(I,U){var b=U||{};if(b.fileType=="mad")return rr(I,b);switch(S(I),b.fileType){case"zip":return Hs(I,b)}var F=function(Ce){for(var ve=0,ke=0,Fe=0;Fe<Ce.FileIndex.length;++Fe){var it=Ce.FileIndex[Fe];if(it.content){var qe=it.content.length;qe>0&&(qe<4096?ve+=qe+63>>6:ke+=qe+511>>9)}}for(var mt=Ce.FullPaths.length+3>>2,an=ve+7>>3,Ge=ve+127>>7,ht=an+ke+mt+Ge,xr=ht+127>>7,Pn=xr<=109?0:Math.ceil((xr-109)/127);ht+xr+Pn+127>>7>xr;)Pn=++xr<=109?0:Math.ceil((xr-109)/127);var rt=[1,Pn,xr,Ge,mt,ke,ve,0];return Ce.FileIndex[0].size=ve<<6,rt[7]=(Ce.FileIndex[0].start=rt[0]+rt[1]+rt[2]+rt[3]+rt[4]+rt[5])+(rt[6]+7>>3),rt}(I),L=nr(F[7]<<9),j=0,Y=0;{for(j=0;j<8;++j)L.write_shift(1,oe[j]);for(j=0;j<8;++j)L.write_shift(2,0);for(L.write_shift(2,62),L.write_shift(2,3),L.write_shift(2,65534),L.write_shift(2,9),L.write_shift(2,6),j=0;j<3;++j)L.write_shift(2,0);for(L.write_shift(4,0),L.write_shift(4,F[2]),L.write_shift(4,F[0]+F[1]+F[2]+F[3]-1),L.write_shift(4,0),L.write_shift(4,4096),L.write_shift(4,F[3]?F[0]+F[1]+F[2]-1:N),L.write_shift(4,F[3]),L.write_shift(-4,F[1]?F[0]-1:N),L.write_shift(4,F[1]),j=0;j<109;++j)L.write_shift(-4,j<F[2]?F[1]+j:-1)}if(F[1])for(Y=0;Y<F[1];++Y){for(;j<236+Y*127;++j)L.write_shift(-4,j<F[2]?F[1]+j:-1);L.write_shift(-4,Y===F[1]-1?N:Y+1)}var ne=function(Ce){for(Y+=Ce;j<Y-1;++j)L.write_shift(-4,j+1);Ce&&(++j,L.write_shift(-4,N))};for(Y=j=0,Y+=F[1];j<Y;++j)L.write_shift(-4,ge.DIFSECT);for(Y+=F[2];j<Y;++j)L.write_shift(-4,ge.FATSECT);ne(F[3]),ne(F[4]);for(var re=0,te=0,J=I.FileIndex[0];re<I.FileIndex.length;++re)J=I.FileIndex[re],J.content&&(te=J.content.length,!(te<4096)&&(J.start=Y,ne(te+511>>9)));for(ne(F[6]+7>>3);L.l&511;)L.write_shift(-4,ge.ENDOFCHAIN);for(Y=j=0,re=0;re<I.FileIndex.length;++re)J=I.FileIndex[re],J.content&&(te=J.content.length,!(!te||te>=4096)&&(J.start=Y,ne(te+63>>6)));for(;L.l&511;)L.write_shift(-4,ge.ENDOFCHAIN);for(j=0;j<F[4]<<2;++j){var he=I.FullPaths[j];if(!he||he.length===0){for(re=0;re<17;++re)L.write_shift(4,0);for(re=0;re<3;++re)L.write_shift(4,-1);for(re=0;re<12;++re)L.write_shift(4,0);continue}J=I.FileIndex[j],j===0&&(J.start=J.size?J.start-1:N);var Te=j===0&&b.root||J.name;if(te=2*(Te.length+1),L.write_shift(64,Te,"utf16le"),L.write_shift(2,te),L.write_shift(1,J.type),L.write_shift(1,J.color),L.write_shift(-4,J.L),L.write_shift(-4,J.R),L.write_shift(-4,J.C),J.clsid)L.write_shift(16,J.clsid,"hex");else for(re=0;re<4;++re)L.write_shift(4,0);L.write_shift(4,J.state||0),L.write_shift(4,0),L.write_shift(4,0),L.write_shift(4,0),L.write_shift(4,0),L.write_shift(4,J.start),L.write_shift(4,J.size),L.write_shift(4,0)}for(j=1;j<I.FileIndex.length;++j)if(J=I.FileIndex[j],J.size>=4096)if(L.l=J.start+1<<9,et&&Buffer.isBuffer(J.content))J.content.copy(L,L.l,0,J.size),L.l+=J.size+511&-512;else{for(re=0;re<J.size;++re)L.write_shift(1,J.content[re]);for(;re&511;++re)L.write_shift(1,0)}for(j=1;j<I.FileIndex.length;++j)if(J=I.FileIndex[j],J.size>0&&J.size<4096)if(et&&Buffer.isBuffer(J.content))J.content.copy(L,L.l,0,J.size),L.l+=J.size+63&-64;else{for(re=0;re<J.size;++re)L.write_shift(1,J.content[re]);for(;re&63;++re)L.write_shift(1,0)}if(et)L.l=L.length;else for(;L.l<L.length;)L.write_shift(1,0);return L}function P(I,U){var b=I.FullPaths.map(function(re){return re.toUpperCase()}),F=b.map(function(re){var te=re.split("/");return te[te.length-(re.slice(-1)=="/"?2:1)]}),L=!1;U.charCodeAt(0)===47?(L=!0,U=b[0].slice(0,-1)+U):L=U.indexOf("/")!==-1;var j=U.toUpperCase(),Y=L===!0?b.indexOf(j):F.indexOf(j);if(Y!==-1)return I.FileIndex[Y];var ne=!j.match(ic);for(j=j.replace(Zr,""),ne&&(j=j.replace(ic,"!")),Y=0;Y<b.length;++Y)if((ne?b[Y].replace(ic,"!"):b[Y]).replace(Zr,"")==j||(ne?F[Y].replace(ic,"!"):F[Y]).replace(Zr,"")==j)return I.FileIndex[Y];return null}var D=64,N=-2,ce="d0cf11e0a1b11ae1",oe=[208,207,17,224,161,177,26,225],de="00000000000000000000000000000000",ge={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:N,FREESECT:-1,HEADER_SIGNATURE:ce,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:de,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function Z(I,U,b){c();var F=R(I,b);l.writeFileSync(U,F)}function G(I){for(var U=new Array(I.length),b=0;b<I.length;++b)U[b]=String.fromCharCode(I[b]);return U.join("")}function ae(I,U){var b=R(I,U);switch(U&&U.type||"buffer"){case"file":return c(),l.writeFileSync(U.filename,b),b;case"binary":return typeof b=="string"?b:G(b);case"base64":return Q_(typeof b=="string"?b:G(b));case"buffer":if(et)return Buffer.isBuffer(b)?b:io(b);case"array":return typeof b=="string"?ss(b):b}return b}var fe;function B(I){try{var U=I.InflateRaw,b=new U;if(b._processChunk(new Uint8Array([3,0]),b._finishFlushFlag),b.bytesRead)fe=I;else throw new Error("zlib does not expose bytesRead")}catch(F){console.error("cannot use native zlib: "+(F.message||F))}}function K(I,U){if(!fe)return Ws(I,U);var b=fe.InflateRaw,F=new b,L=F._processChunk(I.slice(I.l),F._finishFlushFlag);return I.l+=F.bytesRead,L}function q(I){return fe?fe.deflateRawSync(I):Ue(I)}var W=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],Q=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],ue=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function Ee(I){var U=(I<<1|I<<11)&139536|(I<<5|I<<15)&558144;return(U>>16|U>>8|U)&255}for(var _e=typeof Uint8Array<"u",me=_e?new Uint8Array(256):[],je=0;je<256;++je)me[je]=Ee(je);function H(I,U){var b=me[I&255];return U<=8?b>>>8-U:(b=b<<8|me[I>>8&255],U<=16?b>>>16-U:(b=b<<8|me[I>>16&255],b>>>24-U))}function tt(I,U){var b=U&7,F=U>>>3;return(I[F]|(b<=6?0:I[F+1]<<8))>>>b&3}function He(I,U){var b=U&7,F=U>>>3;return(I[F]|(b<=5?0:I[F+1]<<8))>>>b&7}function Je(I,U){var b=U&7,F=U>>>3;return(I[F]|(b<=4?0:I[F+1]<<8))>>>b&15}function De(I,U){var b=U&7,F=U>>>3;return(I[F]|(b<=3?0:I[F+1]<<8))>>>b&31}function Ae(I,U){var b=U&7,F=U>>>3;return(I[F]|(b<=1?0:I[F+1]<<8))>>>b&127}function _t(I,U,b){var F=U&7,L=U>>>3,j=(1<<b)-1,Y=I[L]>>>F;return b<8-F||(Y|=I[L+1]<<8-F,b<16-F)||(Y|=I[L+2]<<16-F,b<24-F)||(Y|=I[L+3]<<24-F),Y&j}function ur(I,U,b){var F=U&7,L=U>>>3;return F<=5?I[L]|=(b&7)<<F:(I[L]|=b<<F&255,I[L+1]=(b&7)>>8-F),U+3}function Nr(I,U,b){var F=U&7,L=U>>>3;return b=(b&1)<<F,I[L]|=b,U+1}function nn(I,U,b){var F=U&7,L=U>>>3;return b<<=F,I[L]|=b&255,b>>>=8,I[L+1]=b,U+8}function zs(I,U,b){var F=U&7,L=U>>>3;return b<<=F,I[L]|=b&255,b>>>=8,I[L+1]=b&255,I[L+2]=b>>>8,U+16}function sn(I,U){var b=I.length,F=2*b>U?2*b:U+5,L=0;if(b>=U)return I;if(et){var j=J_(F);if(I.copy)I.copy(j);else for(;L<I.length;++L)j[L]=I[L];return j}else if(_e){var Y=new Uint8Array(F);if(Y.set)Y.set(I);else for(;L<b;++L)Y[L]=I[L];return Y}return I.length=F,I}function kt(I){for(var U=new Array(I),b=0;b<I;++b)U[b]=0;return U}function fr(I,U,b){var F=1,L=0,j=0,Y=0,ne=0,re=I.length,te=_e?new Uint16Array(32):kt(32);for(j=0;j<32;++j)te[j]=0;for(j=re;j<b;++j)I[j]=0;re=I.length;var J=_e?new Uint16Array(re):kt(re);for(j=0;j<re;++j)te[L=I[j]]++,F<L&&(F=L),J[j]=0;for(te[0]=0,j=1;j<=F;++j)te[j+16]=ne=ne+te[j-1]<<1;for(j=0;j<re;++j)ne=I[j],ne!=0&&(J[j]=te[ne+16]++);var he=0;for(j=0;j<re;++j)if(he=I[j],he!=0)for(ne=H(J[j],F)>>F-he,Y=(1<<F+4-he)-1;Y>=0;--Y)U[ne|Y<<he]=he&15|j<<4;return F}var vt=_e?new Uint16Array(512):kt(512),St=_e?new Uint16Array(32):kt(32);if(!_e){for(var dt=0;dt<512;++dt)vt[dt]=0;for(dt=0;dt<32;++dt)St[dt]=0}(function(){for(var I=[],U=0;U<32;U++)I.push(5);fr(I,St,32);var b=[];for(U=0;U<=143;U++)b.push(8);for(;U<=255;U++)b.push(9);for(;U<=279;U++)b.push(7);for(;U<=287;U++)b.push(8);fr(b,vt,288)})();var Dt=function(){for(var U=_e?new Uint8Array(32768):[],b=0,F=0;b<ue.length-1;++b)for(;F<ue[b+1];++F)U[F]=b;for(;F<32768;++F)U[F]=29;var L=_e?new Uint8Array(259):[];for(b=0,F=0;b<Q.length-1;++b)for(;F<Q[b+1];++F)L[F]=b;function j(ne,re){for(var te=0;te<ne.length;){var J=Math.min(65535,ne.length-te),he=te+J==ne.length;for(re.write_shift(1,+he),re.write_shift(2,J),re.write_shift(2,~J&65535);J-- >0;)re[re.l++]=ne[te++]}return re.l}function Y(ne,re){for(var te=0,J=0,he=_e?new Uint16Array(32768):[];J<ne.length;){var Te=Math.min(65535,ne.length-J);if(Te<10){for(te=ur(re,te,+(J+Te==ne.length)),te&7&&(te+=8-(te&7)),re.l=te/8|0,re.write_shift(2,Te),re.write_shift(2,~Te&65535);Te-- >0;)re[re.l++]=ne[J++];te=re.l*8;continue}te=ur(re,te,+(J+Te==ne.length)+2);for(var Ce=0;Te-- >0;){var ve=ne[J];Ce=(Ce<<5^ve)&32767;var ke=-1,Fe=0;if((ke=he[Ce])&&(ke|=J&-32768,ke>J&&(ke-=32768),ke<J))for(;ne[ke+Fe]==ne[J+Fe]&&Fe<250;)++Fe;if(Fe>2){ve=L[Fe],ve<=22?te=nn(re,te,me[ve+1]>>1)-1:(nn(re,te,3),te+=5,nn(re,te,me[ve-23]>>5),te+=3);var it=ve<8?0:ve-4>>2;it>0&&(zs(re,te,Fe-Q[ve]),te+=it),ve=U[J-ke],te=nn(re,te,me[ve]>>3),te-=3;var qe=ve<4?0:ve-2>>1;qe>0&&(zs(re,te,J-ke-ue[ve]),te+=qe);for(var mt=0;mt<Fe;++mt)he[Ce]=J&32767,Ce=(Ce<<5^ne[J])&32767,++J;Te-=Fe-1}else ve<=143?ve=ve+48:te=Nr(re,te,1),te=nn(re,te,me[ve]),he[Ce]=J&32767,++J}te=nn(re,te,0)-1}return re.l=(te+7)/8|0,re.l}return function(re,te){return re.length<8?j(re,te):Y(re,te)}}();function Ue(I){var U=nr(50+Math.floor(I.length*1.1)),b=Dt(I,U);return U.slice(0,b)}var yt=_e?new Uint16Array(32768):kt(32768),qt=_e?new Uint16Array(32768):kt(32768),ft=_e?new Uint16Array(128):kt(128),gn=1,$s=1;function ho(I,U){var b=De(I,U)+257;U+=5;var F=De(I,U)+1;U+=5;var L=Je(I,U)+4;U+=4;for(var j=0,Y=_e?new Uint8Array(19):kt(19),ne=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],re=1,te=_e?new Uint8Array(8):kt(8),J=_e?new Uint8Array(8):kt(8),he=Y.length,Te=0;Te<L;++Te)Y[W[Te]]=j=He(I,U),re<j&&(re=j),te[j]++,U+=3;var Ce=0;for(te[0]=0,Te=1;Te<=re;++Te)J[Te]=Ce=Ce+te[Te-1]<<1;for(Te=0;Te<he;++Te)(Ce=Y[Te])!=0&&(ne[Te]=J[Ce]++);var ve=0;for(Te=0;Te<he;++Te)if(ve=Y[Te],ve!=0){Ce=me[ne[Te]]>>8-ve;for(var ke=(1<<7-ve)-1;ke>=0;--ke)ft[Ce|ke<<ve]=ve&7|Te<<3}var Fe=[];for(re=1;Fe.length<b+F;)switch(Ce=ft[Ae(I,U)],U+=Ce&7,Ce>>>=3){case 16:for(j=3+tt(I,U),U+=2,Ce=Fe[Fe.length-1];j-- >0;)Fe.push(Ce);break;case 17:for(j=3+He(I,U),U+=3;j-- >0;)Fe.push(0);break;case 18:for(j=11+Ae(I,U),U+=7;j-- >0;)Fe.push(0);break;default:Fe.push(Ce),re<Ce&&(re=Ce);break}var it=Fe.slice(0,b),qe=Fe.slice(b);for(Te=b;Te<286;++Te)it[Te]=0;for(Te=F;Te<30;++Te)qe[Te]=0;return gn=fr(it,yt,286),$s=fr(qe,qt,30),U}function Nl(I,U){if(I[0]==3&&!(I[1]&3))return[hi(U),2];for(var b=0,F=0,L=J_(U||1<<18),j=0,Y=L.length>>>0,ne=0,re=0;!(F&1);){if(F=He(I,b),b+=3,F>>>1)F>>1==1?(ne=9,re=5):(b=ho(I,b),ne=gn,re=$s);else{b&7&&(b+=8-(b&7));var te=I[b>>>3]|I[(b>>>3)+1]<<8;if(b+=32,te>0)for(!U&&Y<j+te&&(L=sn(L,j+te),Y=L.length);te-- >0;)L[j++]=I[b>>>3],b+=8;continue}for(;;){!U&&Y<j+32767&&(L=sn(L,j+32767),Y=L.length);var J=_t(I,b,ne),he=F>>>1==1?vt[J]:yt[J];if(b+=he&15,he>>>=4,!(he>>>8&255))L[j++]=he;else{if(he==256)break;he-=257;var Te=he<8?0:he-4>>2;Te>5&&(Te=0);var Ce=j+Q[he];Te>0&&(Ce+=_t(I,b,Te),b+=Te),J=_t(I,b,re),he=F>>>1==1?St[J]:qt[J],b+=he&15,he>>>=4;var ve=he<4?0:he-2>>1,ke=ue[he];for(ve>0&&(ke+=_t(I,b,ve),b+=ve),!U&&Y<Ce&&(L=sn(L,Ce+100),Y=L.length);j<Ce;)L[j]=L[j-ke],++j}}}return U?[L,b+7>>>3]:[L.slice(0,j),b+7>>>3]}function Ws(I,U){var b=I.slice(I.l||0),F=Nl(b,U);return I.l+=F[1],F[0]}function ms(I,U){if(I)typeof console<"u"&&console.error(U);else throw new Error(U)}function Sa(I,U){var b=I;wr(b,0);var F=[],L=[],j={FileIndex:F,FullPaths:L};v(j,{root:U.root});for(var Y=b.length-4;(b[Y]!=80||b[Y+1]!=75||b[Y+2]!=5||b[Y+3]!=6)&&Y>=0;)--Y;b.l=Y+4,b.l+=4;var ne=b.read_shift(2);b.l+=6;var re=b.read_shift(4);for(b.l=re,Y=0;Y<ne;++Y){b.l+=20;var te=b.read_shift(4),J=b.read_shift(4),he=b.read_shift(2),Te=b.read_shift(2),Ce=b.read_shift(2);b.l+=8;var ve=b.read_shift(4),ke=o(b.slice(b.l+he,b.l+he+Te));b.l+=he+Te+Ce;var Fe=b.l;b.l=ve+4,qn(b,te,J,j,ke),b.l=Fe}return j}function qn(I,U,b,F,L){I.l+=2;var j=I.read_shift(2),Y=I.read_shift(2),ne=i(I);if(j&8257)throw new Error("Unsupported ZIP encryption");for(var re=I.read_shift(4),te=I.read_shift(4),J=I.read_shift(4),he=I.read_shift(2),Te=I.read_shift(2),Ce="",ve=0;ve<he;++ve)Ce+=String.fromCharCode(I[I.l++]);if(Te){var ke=o(I.slice(I.l,I.l+Te));(ke[21589]||{}).mt&&(ne=ke[21589].mt),((L||{})[21589]||{}).mt&&(ne=L[21589].mt)}I.l+=Te;var Fe=I.slice(I.l,I.l+te);switch(Y){case 8:Fe=K(I,J);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+Y)}var it=!1;j&8&&(re=I.read_shift(4),re==134695760&&(re=I.read_shift(4),it=!0),te=I.read_shift(4),J=I.read_shift(4)),te!=U&&ms(it,"Bad compressed size: "+U+" != "+te),J!=b&&ms(it,"Bad uncompressed size: "+b+" != "+J),ee(F,Ce,Fe,{unsafe:!0,mt:ne})}function Hs(I,U){var b=U||{},F=[],L=[],j=nr(1),Y=b.compression?8:0,ne=0,re=0,te=0,J=0,he=0,Te=I.FullPaths[0],Ce=Te,ve=I.FileIndex[0],ke=[],Fe=0;for(re=1;re<I.FullPaths.length;++re)if(Ce=I.FullPaths[re].slice(Te.length),ve=I.FileIndex[re],!(!ve.size||!ve.content||Ce=="Sh33tJ5")){var it=J,qe=nr(Ce.length);for(te=0;te<Ce.length;++te)qe.write_shift(1,Ce.charCodeAt(te)&127);qe=qe.slice(0,qe.l),ke[he]=M6.buf(ve.content,0);var mt=ve.content;Y==8&&(mt=q(mt)),j=nr(30),j.write_shift(4,67324752),j.write_shift(2,20),j.write_shift(2,ne),j.write_shift(2,Y),ve.mt?a(j,ve.mt):j.write_shift(4,0),j.write_shift(-4,ke[he]),j.write_shift(4,mt.length),j.write_shift(4,ve.content.length),j.write_shift(2,qe.length),j.write_shift(2,0),J+=j.length,F.push(j),J+=qe.length,F.push(qe),J+=mt.length,F.push(mt),j=nr(46),j.write_shift(4,33639248),j.write_shift(2,0),j.write_shift(2,20),j.write_shift(2,ne),j.write_shift(2,Y),j.write_shift(4,0),j.write_shift(-4,ke[he]),j.write_shift(4,mt.length),j.write_shift(4,ve.content.length),j.write_shift(2,qe.length),j.write_shift(2,0),j.write_shift(2,0),j.write_shift(2,0),j.write_shift(2,0),j.write_shift(4,0),j.write_shift(4,it),Fe+=j.l,L.push(j),Fe+=qe.length,L.push(qe),++he}return j=nr(22),j.write_shift(4,101010256),j.write_shift(2,0),j.write_shift(2,0),j.write_shift(2,he),j.write_shift(2,he),j.write_shift(4,Fe),j.write_shift(4,J),j.write_shift(2,0),Va([Va(F),Va(L),j])}var ps={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function Rn(I,U){if(I.ctype)return I.ctype;var b=I.name||"",F=b.match(/\.([^\.]+)$/);return F&&ps[F[1]]||U&&(F=(b=U).match(/[\.\\]([^\.\\])+$/),F&&ps[F[1]])?ps[F[1]]:"application/octet-stream"}function mo(I){for(var U=Q_(I),b=[],F=0;F<U.length;F+=76)b.push(U.slice(F,F+76));return b.join(`\r
`)+`\r
`}function Gs(I){var U=I.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(te){var J=te.charCodeAt(0).toString(16).toUpperCase();return"="+(J.length==1?"0"+J:J)});U=U.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),U.charAt(0)==`
`&&(U="=0D"+U.slice(1)),U=U.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var b=[],F=U.split(`\r
`),L=0;L<F.length;++L){var j=F[L];if(j.length==0){b.push("");continue}for(var Y=0;Y<j.length;){var ne=76,re=j.slice(Y,Y+ne);re.charAt(ne-1)=="="?ne--:re.charAt(ne-2)=="="?ne-=2:re.charAt(ne-3)=="="&&(ne-=3),re=j.slice(Y,Y+ne),Y+=ne,Y<j.length&&(re+="="),b.push(re)}}return b.join(`\r
`)}function Ks(I){for(var U=[],b=0;b<I.length;++b){for(var F=I[b];b<=I.length&&F.charAt(F.length-1)=="=";)F=F.slice(0,F.length-1)+I[++b];U.push(F)}for(var L=0;L<U.length;++L)U[L]=U[L].replace(/[=][0-9A-Fa-f]{2}/g,function(j){return String.fromCharCode(parseInt(j.slice(1),16))});return ss(U.join(`\r
`))}function bn(I,U,b){for(var F="",L="",j="",Y,ne=0;ne<10;++ne){var re=U[ne];if(!re||re.match(/^\s*$/))break;var te=re.match(/^(.*?):\s*([^\s].*)$/);if(te)switch(te[1].toLowerCase()){case"content-location":F=te[2].trim();break;case"content-type":j=te[2].trim();break;case"content-transfer-encoding":L=te[2].trim();break}}switch(++ne,L.toLowerCase()){case"base64":Y=ss(An(U.slice(ne).join("")));break;case"quoted-printable":Y=Ks(U.slice(ne));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+L)}var J=ee(I,F.slice(b.length),Y,{unsafe:!0});j&&(J.ctype=j)}function po(I,U){if(G(I.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var b=U&&U.root||"",F=(et&&Buffer.isBuffer(I)?I.toString("binary"):G(I)).split(`\r
`),L=0,j="";for(L=0;L<F.length;++L)if(j=F[L],!!/^Content-Location:/i.test(j)&&(j=j.slice(j.indexOf("file")),b||(b=j.slice(0,j.lastIndexOf("/")+1)),j.slice(0,b.length)!=b))for(;b.length>0&&(b=b.slice(0,b.length-1),b=b.slice(0,b.lastIndexOf("/")+1),j.slice(0,b.length)!=b););var Y=(F[1]||"").match(/boundary="(.*?)"/);if(!Y)throw new Error("MAD cannot find boundary");var ne="--"+(Y[1]||""),re=[],te=[],J={FileIndex:re,FullPaths:te};v(J);var he,Te=0;for(L=0;L<F.length;++L){var Ce=F[L];Ce!==ne&&Ce!==ne+"--"||(Te++&&bn(J,F.slice(he,L),b),he=L)}return J}function rr(I,U){var b=U||{},F=b.boundary||"SheetJS";F="------="+F;for(var L=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+F.slice(2)+'"',"","",""],j=I.FullPaths[0],Y=j,ne=I.FileIndex[0],re=1;re<I.FullPaths.length;++re)if(Y=I.FullPaths[re].slice(j.length),ne=I.FileIndex[re],!(!ne.size||!ne.content||Y=="Sh33tJ5")){Y=Y.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(Fe){return"_x"+Fe.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(Fe){return"_u"+Fe.charCodeAt(0).toString(16)+"_"});for(var te=ne.content,J=et&&Buffer.isBuffer(te)?te.toString("binary"):G(te),he=0,Te=Math.min(1024,J.length),Ce=0,ve=0;ve<=Te;++ve)(Ce=J.charCodeAt(ve))>=32&&Ce<128&&++he;var ke=he>=Te*4/5;L.push(F),L.push("Content-Location: "+(b.root||"file:///C:/SheetJS/")+Y),L.push("Content-Transfer-Encoding: "+(ke?"quoted-printable":"base64")),L.push("Content-Type: "+Rn(ne,Y)),L.push(""),L.push(ke?Gs(J):mo(J))}return L.push(F+`--\r
`),L.join(`\r
`)}function X(I){var U={};return v(U,I),U}function ee(I,U,b,F){var L=F&&F.unsafe;L||v(I);var j=!L&&st.find(I,U);if(!j){var Y=I.FullPaths[0];U.slice(0,Y.length)==Y?Y=U:(Y.slice(-1)!="/"&&(Y+="/"),Y=(Y+U).replace("//","/")),j={name:s(U),type:2},I.FileIndex.push(j),I.FullPaths.push(Y),L||st.utils.cfb_gc(I)}return j.content=b,j.size=b?b.length:0,F&&(F.CLSID&&(j.clsid=F.CLSID),F.mt&&(j.mt=F.mt),F.ct&&(j.ct=F.ct)),j}function ie(I,U){v(I);var b=st.find(I,U);if(b){for(var F=0;F<I.FileIndex.length;++F)if(I.FileIndex[F]==b)return I.FileIndex.splice(F,1),I.FullPaths.splice(F,1),!0}return!1}function xe(I,U,b){v(I);var F=st.find(I,U);if(F){for(var L=0;L<I.FileIndex.length;++L)if(I.FileIndex[L]==F)return I.FileIndex[L].name=s(b),I.FullPaths[L]=b,!0}return!1}function Ie(I){S(I,!0)}return t.find=P,t.read=O,t.parse=u,t.write=ae,t.writeFile=Z,t.utils={cfb_new:X,cfb_add:ee,cfb_del:ie,cfb_mov:xe,cfb_gc:Ie,ReadShift:kc,CheckField:VA,prep_blob:wr,bconcat:Va,use_zlib:B,_deflateRaw:Ue,_inflateRaw:Ws,consts:ge},t}();function L6(e){if(typeof Deno<"u")return Deno.readFileSync(e);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var t=File(e);t.open("r"),t.encoding="binary";var r=t.read();return t.close(),r}catch(n){if(!n.message||!n.message.match(/onstruct/))throw n}throw new Error("Cannot access file "+e)}function Fs(e){for(var t=Object.keys(e),r=[],n=0;n<t.length;++n)Object.prototype.hasOwnProperty.call(e,t[n])&&r.push(t[n]);return r}function Zx(e){for(var t=[],r=Fs(e),n=0;n!==r.length;++n)t[e[r[n]]]=r[n];return t}var sd=new Date(1899,11,30,0,0,0);function en(e,t){var r=e.getTime(),n=sd.getTime()+(e.getTimezoneOffset()-sd.getTimezoneOffset())*6e4;return(r-n)/(24*60*60*1e3)}var yA=new Date,j6=sd.getTime()+(yA.getTimezoneOffset()-sd.getTimezoneOffset())*6e4,iw=yA.getTimezoneOffset();function n0(e){var t=new Date;return t.setTime(e*24*60*60*1e3+j6),t.getTimezoneOffset()!==iw&&t.setTime(t.getTime()+(t.getTimezoneOffset()-iw)*6e4),t}function U6(e){var t=0,r=0,n=!1,s=e.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!s)throw new Error("|"+e+"| is not an ISO8601 Duration");for(var a=1;a!=s.length;++a)if(s[a]){switch(r=1,a>3&&(n=!0),s[a].slice(s[a].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+s[a].slice(s[a].length-1));case"D":r*=24;case"H":r*=60;case"M":if(n)r*=60;else throw new Error("Unsupported ISO Duration Field: M")}t+=r*parseInt(s[a],10)}return t}var ow=new Date("2017-02-19T19:06:09.000Z"),_A=isNaN(ow.getFullYear())?new Date("2/19/17"):ow,V6=_A.getFullYear()==2017;function gr(e,t){var r=new Date(e);if(V6)return t>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):t<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(e instanceof Date)return e;if(_A.getFullYear()==1917&&!isNaN(r.getFullYear())){var n=r.getFullYear();return e.indexOf(""+n)>-1||r.setFullYear(r.getFullYear()+100),r}var s=e.match(/\d+/g)||["2017","2","19","0","0","0"],a=new Date(+s[0],+s[1]-1,+s[2],+s[3]||0,+s[4]||0,+s[5]||0);return e.indexOf("Z")>-1&&(a=new Date(a.getTime()-a.getTimezoneOffset()*60*1e3)),a}function Ji(e,t){if(et&&Buffer.isBuffer(e)){if(t){if(e[0]==255&&e[1]==254)return lc(e.slice(2).toString("utf16le"));if(e[1]==254&&e[2]==255)return lc(iA(e.slice(2).toString("binary")))}return e.toString("binary")}if(typeof TextDecoder<"u")try{if(t){if(e[0]==255&&e[1]==254)return lc(new TextDecoder("utf-16le").decode(e.slice(2)));if(e[0]==254&&e[1]==255)return lc(new TextDecoder("utf-16be").decode(e.slice(2)))}var r={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[]/g,function(a){return r[a]||a})}catch{}for(var n=[],s=0;s!=e.length;++s)n.push(String.fromCharCode(e[s]));return n.join("")}function Sr(e){if(typeof JSON<"u"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=Sr(e[r]));return t}function Vt(e,t){for(var r="";r.length<t;)r+=e;return r}function fs(e){var t=Number(e);if(!isNaN(t))return isFinite(t)?t:NaN;if(!/\d/.test(e))return t;var r=1,n=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(t=Number(n))||(n=n.replace(/[(](.*)[)]/,function(s,a){return r=-r,a}),!isNaN(t=Number(n)))?t/r:t}var B6=["january","february","march","april","may","june","july","august","september","october","november","december"];function gl(e){var t=new Date(e),r=new Date(NaN),n=t.getYear(),s=t.getMonth(),a=t.getDate();if(isNaN(a))return r;var i=e.toLowerCase();if(i.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(i=i.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),i.length>3&&B6.indexOf(i)==-1)return r}else if(i.match(/[a-z]/))return r;return n<0||n>8099?r:(s>0||a>1)&&n!=101?t:e.match(/[^-0-9:,\/\\]/)?r:t}var z6=function(){var e="abacaba".split(/(:?b)/i).length==5;return function(r,n,s){if(e||typeof n=="string")return r.split(n);for(var a=r.split(n),i=[a[0]],o=1;o<a.length;++o)i.push(s),i.push(a[o]);return i}}();function wA(e){return e?e.content&&e.type?Ji(e.content,!0):e.data?ac(e.data):e.asNodeBuffer&&et?ac(e.asNodeBuffer().toString("binary")):e.asBinary?ac(e.asBinary()):e._data&&e._data.getContent?ac(Ji(Array.prototype.slice.call(e._data.getContent(),0))):null:null}function EA(e){if(!e)return null;if(e.data)return X_(e.data);if(e.asNodeBuffer&&et)return e.asNodeBuffer();if(e._data&&e._data.getContent){var t=e._data.getContent();return typeof t=="string"?X_(t):Array.prototype.slice.call(t)}return e.content&&e.type?e.content:null}function $6(e){return e&&e.name.slice(-4)===".bin"?EA(e):wA(e)}function On(e,t){for(var r=e.FullPaths||Fs(e.files),n=t.toLowerCase().replace(/[\/]/g,"\\"),s=n.replace(/\\/g,"/"),a=0;a<r.length;++a){var i=r[a].replace(/^Root Entry[\/]/,"").toLowerCase();if(n==i||s==i)return e.files?e.files[r[a]]:e.FileIndex[a]}return null}function ev(e,t){var r=On(e,t);if(r==null)throw new Error("Cannot find file "+t+" in zip");return r}function Qt(e,t,r){if(!r)return $6(ev(e,t));if(!t)return null;try{return Qt(e,t)}catch{return null}}function wn(e,t,r){if(!r)return wA(ev(e,t));if(!t)return null;try{return wn(e,t)}catch{return null}}function W6(e,t,r){return EA(ev(e,t))}function lw(e){for(var t=e.FullPaths||Fs(e.files),r=[],n=0;n<t.length;++n)t[n].slice(-1)!="/"&&r.push(t[n].replace(/^Root Entry[\/]/,""));return r.sort()}function H6(e,t,r){if(e.FullPaths){if(typeof r=="string"){var n;return et?n=io(r):n=u6(r),st.utils.cfb_add(e,t,n)}st.utils.cfb_add(e,t,r)}else e.file(t,r)}function TA(e,t){switch(t.type){case"base64":return st.read(e,{type:"base64"});case"binary":return st.read(e,{type:"binary"});case"buffer":case"array":return st.read(e,{type:"buffer"})}throw new Error("Unrecognized type "+t.type)}function oc(e,t){if(e.charAt(0)=="/")return e.slice(1);var r=t.split("/");t.slice(-1)!="/"&&r.pop();for(var n=e.split("/");n.length!==0;){var s=n.shift();s===".."?r.pop():s!=="."&&r.push(s)}return r.join("/")}var kA=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,G6=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,cw=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,K6=/<[^>]*>/g,Kr=kA.match(cw)?cw:K6,q6=/<\w*:/,X6=/<(\/?)\w+:/;function Oe(e,t,r){for(var n={},s=0,a=0;s!==e.length&&!((a=e.charCodeAt(s))===32||a===10||a===13);++s);if(t||(n[0]=e.slice(0,s)),s===e.length)return n;var i=e.match(G6),o=0,l="",c=0,u="",d="",m=1;if(i)for(c=0;c!=i.length;++c){for(d=i[c],a=0;a!=d.length&&d.charCodeAt(a)!==61;++a);for(u=d.slice(0,a).trim();d.charCodeAt(a+1)==32;)++a;for(m=(s=d.charCodeAt(a+1))==34||s==39?1:0,l=d.slice(a+1+m,d.length-m),o=0;o!=u.length&&u.charCodeAt(o)!==58;++o);if(o===u.length)u.indexOf("_")>0&&(u=u.slice(0,u.indexOf("_"))),n[u]=l,n[u.toLowerCase()]=l;else{var p=(o===5&&u.slice(0,5)==="xmlns"?"xmlns":"")+u.slice(o+1);if(n[p]&&u.slice(o-3,o)=="ext")continue;n[p]=l,n[p.toLowerCase()]=l}}return n}function Vs(e){return e.replace(X6,"<$1")}var SA={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},Y6=Zx(SA),lt=function(){var e=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,t=/_x([\da-fA-F]{4})_/ig;return function r(n){var s=n+"",a=s.indexOf("<![CDATA[");if(a==-1)return s.replace(e,function(o,l){return SA[o]||String.fromCharCode(parseInt(l,o.indexOf("x")>-1?16:10))||o}).replace(t,function(o,l){return String.fromCharCode(parseInt(l,16))});var i=s.indexOf("]]>");return r(s.slice(0,a))+s.slice(a+9,i)+r(s.slice(i+3))}}(),Q6=/[&<>'"]/g,J6=/[\u0000-\u001f]/g;function tv(e){var t=e+"";return t.replace(Q6,function(r){return Y6[r]}).replace(/\n/g,"<br/>").replace(J6,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}var uw=function(){var e=/&#(\d+);/g;function t(r,n){return String.fromCharCode(parseInt(n,10))}return function(n){return n.replace(e,t)}}();function bt(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function em(e){for(var t="",r=0,n=0,s=0,a=0,i=0,o=0;r<e.length;){if(n=e.charCodeAt(r++),n<128){t+=String.fromCharCode(n);continue}if(s=e.charCodeAt(r++),n>191&&n<224){i=(n&31)<<6,i|=s&63,t+=String.fromCharCode(i);continue}if(a=e.charCodeAt(r++),n<240){t+=String.fromCharCode((n&15)<<12|(s&63)<<6|a&63);continue}i=e.charCodeAt(r++),o=((n&7)<<18|(s&63)<<12|(a&63)<<6|i&63)-65536,t+=String.fromCharCode(55296+(o>>>10&1023)),t+=String.fromCharCode(56320+(o&1023))}return t}function fw(e){var t=hi(2*e.length),r,n,s=1,a=0,i=0,o;for(n=0;n<e.length;n+=s)s=1,(o=e.charCodeAt(n))<128?r=o:o<224?(r=(o&31)*64+(e.charCodeAt(n+1)&63),s=2):o<240?(r=(o&15)*4096+(e.charCodeAt(n+1)&63)*64+(e.charCodeAt(n+2)&63),s=3):(s=4,r=(o&7)*262144+(e.charCodeAt(n+1)&63)*4096+(e.charCodeAt(n+2)&63)*64+(e.charCodeAt(n+3)&63),r-=65536,i=55296+(r>>>10&1023),r=56320+(r&1023)),i!==0&&(t[a++]=i&255,t[a++]=i>>>8,i=0),t[a++]=r%256,t[a++]=r>>>8;return t.slice(0,a).toString("ucs2")}function hw(e){return io(e,"binary").toString("utf8")}var bf="foo bar baz",Tt=et&&(hw(bf)==em(bf)&&hw||fw(bf)==em(bf)&&fw)||em,lc=et?function(e){return io(e,"utf8").toString("binary")}:function(e){for(var t=[],r=0,n=0,s=0;r<e.length;)switch(n=e.charCodeAt(r++),!0){case n<128:t.push(String.fromCharCode(n));break;case n<2048:t.push(String.fromCharCode(192+(n>>6))),t.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,s=e.charCodeAt(r++)-56320+(n<<10),t.push(String.fromCharCode(240+(s>>18&7))),t.push(String.fromCharCode(144+(s>>12&63))),t.push(String.fromCharCode(128+(s>>6&63))),t.push(String.fromCharCode(128+(s&63)));break;default:t.push(String.fromCharCode(224+(n>>12))),t.push(String.fromCharCode(128+(n>>6&63))),t.push(String.fromCharCode(128+(n&63)))}return t.join("")},uu=function(){var e={};return function(r,n){var s=r+"|"+(n||"");return e[s]?e[s]:e[s]=new RegExp("<(?:\\w+:)?"+r+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+r+">",n||"")}}(),AA=function(){var e=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(t){return[new RegExp("&"+t[0]+";","ig"),t[1]]});return function(r){for(var n=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),s=0;s<e.length;++s)n=n.replace(e[s][0],e[s][1]);return n}}(),Z6=function(){var e={};return function(r){return e[r]!==void 0?e[r]:e[r]=new RegExp("<(?:vt:)?"+r+">([\\s\\S]*?)</(?:vt:)?"+r+">","g")}}(),ej=/<\/?(?:vt:)?variant>/g,tj=/<(?:vt:)([^>]*)>([\s\S]*)</;function dw(e,t){var r=Oe(e),n=e.match(Z6(r.baseType))||[],s=[];if(n.length!=r.size){if(t.WTF)throw new Error("unexpected vector length "+n.length+" != "+r.size);return s}return n.forEach(function(a){var i=a.replace(ej,"").match(tj);i&&s.push({v:Tt(i[2]),t:i[1]})}),s}var rj=/(^\s|\s$|\n)/;function nj(e){return Fs(e).map(function(t){return" "+t+'="'+e[t]+'"'}).join("")}function sj(e,t,r){return"<"+e+(r!=null?nj(r):"")+(t!=null?(t.match(rj)?' xml:space="preserve"':"")+">"+t+"</"+e:"/")+">"}function rv(e){if(et&&Buffer.isBuffer(e))return e.toString("utf8");if(typeof e=="string")return e;if(typeof Uint8Array<"u"&&e instanceof Uint8Array)return Tt(oo(Yx(e)));throw new Error("Bad input format: expected Buffer or string")}var fu=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,aj={CT:"http://schemas.openxmlformats.org/package/2006/content-types"},ij=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"];function oj(e,t){for(var r=1-2*(e[t+7]>>>7),n=((e[t+7]&127)<<4)+(e[t+6]>>>4&15),s=e[t+6]&15,a=5;a>=0;--a)s=s*256+e[t+a];return n==2047?s==0?r*(1/0):NaN:(n==0?n=-1022:(n-=1023,s+=Math.pow(2,52)),r*Math.pow(2,n-52)*s)}function lj(e,t,r){var n=(t<0||1/t==-1/0?1:0)<<7,s=0,a=0,i=n?-t:t;isFinite(i)?i==0?s=a=0:(s=Math.floor(Math.log(i)/Math.LN2),a=i*Math.pow(2,52-s),s<=-1023&&(!isFinite(a)||a<Math.pow(2,52))?s=-1022:(a-=Math.pow(2,52),s+=1023)):(s=2047,a=isNaN(t)?26985:0);for(var o=0;o<=5;++o,a/=256)e[r+o]=a&255;e[r+6]=(s&15)<<4|a&15,e[r+7]=s>>4|n}var mw=function(e){for(var t=[],r=10240,n=0;n<e[0].length;++n)if(e[0][n])for(var s=0,a=e[0][n].length;s<a;s+=r)t.push.apply(t,e[0][n].slice(s,s+r));return t},pw=et?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(t){return Buffer.isBuffer(t)?t:io(t)})):mw(e)}:mw,gw=function(e,t,r){for(var n=[],s=t;s<r;s+=2)n.push(String.fromCharCode(sa(e,s)));return n.join("").replace(Zr,"")},nv=et?function(e,t,r){return Buffer.isBuffer(e)?e.toString("utf16le",t,r).replace(Zr,""):gw(e,t,r)}:gw,xw=function(e,t,r){for(var n=[],s=t;s<t+r;++s)n.push(("0"+e[s].toString(16)).slice(-2));return n.join("")},IA=et?function(e,t,r){return Buffer.isBuffer(e)?e.toString("hex",t,t+r):xw(e,t,r)}:xw,vw=function(e,t,r){for(var n=[],s=t;s<r;s++)n.push(String.fromCharCode(So(e,s)));return n.join("")},Bu=et?function(t,r,n){return Buffer.isBuffer(t)?t.toString("utf8",r,n):vw(t,r,n)}:vw,CA=function(e,t){var r=_n(e,t);return r>0?Bu(e,t+4,t+4+r-1):""},NA=CA,RA=function(e,t){var r=_n(e,t);return r>0?Bu(e,t+4,t+4+r-1):""},bA=RA,PA=function(e,t){var r=2*_n(e,t);return r>0?Bu(e,t+4,t+4+r-1):""},DA=PA,FA=function(t,r){var n=_n(t,r);return n>0?nv(t,r+4,r+4+n):""},OA=FA,MA=function(e,t){var r=_n(e,t);return r>0?Bu(e,t+4,t+4+r):""},LA=MA,jA=function(e,t){return oj(e,t)},ad=jA,UA=function(t){return Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array};et&&(NA=function(t,r){if(!Buffer.isBuffer(t))return CA(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},bA=function(t,r){if(!Buffer.isBuffer(t))return RA(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},DA=function(t,r){if(!Buffer.isBuffer(t))return PA(t,r);var n=2*t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n-1)},OA=function(t,r){if(!Buffer.isBuffer(t))return FA(t,r);var n=t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n)},LA=function(t,r){if(!Buffer.isBuffer(t))return MA(t,r);var n=t.readUInt32LE(r);return t.toString("utf8",r+4,r+4+n)},ad=function(t,r){return Buffer.isBuffer(t)?t.readDoubleLE(r):jA(t,r)},UA=function(t){return Buffer.isBuffer(t)||Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array});var So=function(e,t){return e[t]},sa=function(e,t){return e[t+1]*256+e[t]},cj=function(e,t){var r=e[t+1]*256+e[t];return r<32768?r:(65535-r+1)*-1},_n=function(e,t){return e[t+3]*(1<<24)+(e[t+2]<<16)+(e[t+1]<<8)+e[t]},Ii=function(e,t){return e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]},uj=function(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]};function kc(e,t){var r="",n,s,a=[],i,o,l,c;switch(t){case"dbcs":if(c=this.l,et&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*e).toString("utf16le");else for(l=0;l<e;++l)r+=String.fromCharCode(sa(this,c)),c+=2;e*=2;break;case"utf8":r=Bu(this,this.l,this.l+e);break;case"utf16le":e*=2,r=nv(this,this.l,this.l+e);break;case"wstr":return kc.call(this,e,"dbcs");case"lpstr-ansi":r=NA(this,this.l),e=4+_n(this,this.l);break;case"lpstr-cp":r=bA(this,this.l),e=4+_n(this,this.l);break;case"lpwstr":r=DA(this,this.l),e=4+2*_n(this,this.l);break;case"lpp4":e=4+_n(this,this.l),r=OA(this,this.l),e&2&&(e+=2);break;case"8lpp4":e=4+_n(this,this.l),r=LA(this,this.l),e&3&&(e+=4-(e&3));break;case"cstr":for(e=0,r="";(i=So(this,this.l+e++))!==0;)a.push(Rf(i));r=a.join("");break;case"_wstr":for(e=0,r="";(i=sa(this,this.l+e))!==0;)a.push(Rf(i)),e+=2;e+=2,r=a.join("");break;case"dbcs-cont":for(r="",c=this.l,l=0;l<e;++l){if(this.lens&&this.lens.indexOf(c)!==-1)return i=So(this,c),this.l=c+1,o=kc.call(this,e-l,i?"dbcs-cont":"sbcs-cont"),a.join("")+o;a.push(Rf(sa(this,c))),c+=2}r=a.join(""),e*=2;break;case"cpstr":case"sbcs-cont":for(r="",c=this.l,l=0;l!=e;++l){if(this.lens&&this.lens.indexOf(c)!==-1)return i=So(this,c),this.l=c+1,o=kc.call(this,e-l,i?"dbcs-cont":"sbcs-cont"),a.join("")+o;a.push(Rf(So(this,c))),c+=1}r=a.join("");break;default:switch(e){case 1:return n=So(this,this.l),this.l++,n;case 2:return n=(t==="i"?cj:sa)(this,this.l),this.l+=2,n;case 4:case-4:return t==="i"||!(this[this.l+3]&128)?(n=(e>0?Ii:uj)(this,this.l),this.l+=4,n):(s=_n(this,this.l),this.l+=4,s);case 8:case-8:if(t==="f")return e==8?s=ad(this,this.l):s=ad([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,s;e=8;case 16:r=IA(this,this.l,e);break}}return this.l+=e,r}var fj=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24&255},hj=function(e,t,r){e[r]=t&255,e[r+1]=t>>8&255,e[r+2]=t>>16&255,e[r+3]=t>>24&255},dj=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255};function mj(e,t,r){var n=0,s=0;if(r==="dbcs"){for(s=0;s!=t.length;++s)dj(this,t.charCodeAt(s),this.l+2*s);n=2*t.length}else if(r==="sbcs"){for(t=t.replace(/[^\x00-\x7F]/g,"_"),s=0;s!=t.length;++s)this[this.l+s]=t.charCodeAt(s)&255;n=t.length}else if(r==="hex"){for(;s<e;++s)this[this.l++]=parseInt(t.slice(2*s,2*s+2),16)||0;return this}else if(r==="utf16le"){var a=Math.min(this.l+e,this.length);for(s=0;s<Math.min(t.length,e);++s){var i=t.charCodeAt(s);this[this.l++]=i&255,this[this.l++]=i>>8}for(;this.l<a;)this[this.l++]=0;return this}else switch(e){case 1:n=1,this[this.l]=t&255;break;case 2:n=2,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255;break;case 3:n=3,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255,t>>>=8,this[this.l+2]=t&255;break;case 4:n=4,fj(this,t,this.l);break;case 8:if(n=8,r==="f"){lj(this,t,this.l);break}case 16:break;case-4:n=4,hj(this,t,this.l);break}return this.l+=n,this}function VA(e,t){var r=IA(this,this.l,e.length>>1);if(r!==e)throw new Error(t+"Expected "+e+" saw "+r);this.l+=e.length>>1}function wr(e,t){e.l=t,e.read_shift=kc,e.chk=VA,e.write_shift=mj}function Gr(e,t){e.l+=t}function nr(e){var t=hi(e);return wr(t,0),t}function ka(e,t,r){if(e){var n,s,a;wr(e,e.l||0);for(var i=e.length,o=0,l=0;e.l<i;){o=e.read_shift(1),o&128&&(o=(o&127)+((e.read_shift(1)&127)<<7));var c=fd[o]||fd[65535];for(n=e.read_shift(1),a=n&127,s=1;s<4&&n&128;++s)a+=((n=e.read_shift(1))&127)<<7*s;l=e.l+a;var u=c.f&&c.f(e,a,r);if(e.l=l,t(u,c,o))return}}}function Op(){var e=[],t=et?256:2048,r=function(c){var u=nr(c);return wr(u,0),u},n=r(t),s=function(){n&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&e.push(n),n=null)},a=function(c){return n&&c<n.length-n.l?n:(s(),n=r(Math.max(c+1,t)))},i=function(){return s(),Va(e)},o=function(c){s(),n=c,n.l==null&&(n.l=n.length),a(t)};return{next:a,push:o,end:i,_bufs:e}}function Sc(e,t,r){var n=Sr(e);if(t.s?(n.cRel&&(n.c+=t.s.c),n.rRel&&(n.r+=t.s.r)):(n.cRel&&(n.c+=t.c),n.rRel&&(n.r+=t.r)),!r||r.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function yw(e,t,r){var n=Sr(e);return n.s=Sc(n.s,t.s,r),n.e=Sc(n.e,t.s,r),n}function Ac(e,t){if(e.cRel&&e.c<0)for(e=Sr(e);e.c<0;)e.c+=t>8?16384:256;if(e.rRel&&e.r<0)for(e=Sr(e);e.r<0;)e.r+=t>8?1048576:t>5?65536:16384;var r=Be(e);return!e.cRel&&e.cRel!=null&&(r=xj(r)),!e.rRel&&e.rRel!=null&&(r=pj(r)),r}function tm(e,t){return e.s.r==0&&!e.s.rRel&&e.e.r==(t.biff>=12?1048575:t.biff>=8?65536:16384)&&!e.e.rRel?(e.s.cRel?"":"$")+ir(e.s.c)+":"+(e.e.cRel?"":"$")+ir(e.e.c):e.s.c==0&&!e.s.cRel&&e.e.c==(t.biff>=12?16383:255)&&!e.e.cRel?(e.s.rRel?"":"$")+Ar(e.s.r)+":"+(e.e.rRel?"":"$")+Ar(e.e.r):Ac(e.s,t.biff)+":"+Ac(e.e,t.biff)}function sv(e){return parseInt(gj(e),10)-1}function Ar(e){return""+(e+1)}function pj(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function gj(e){return e.replace(/\$(\d+)$/,"$1")}function av(e){for(var t=vj(e),r=0,n=0;n!==t.length;++n)r=26*r+t.charCodeAt(n)-64;return r-1}function ir(e){if(e<0)throw new Error("invalid column "+e);var t="";for(++e;e;e=Math.floor((e-1)/26))t=String.fromCharCode((e-1)%26+65)+t;return t}function xj(e){return e.replace(/^([A-Z])/,"$$$1")}function vj(e){return e.replace(/^\$([A-Z])/,"$1")}function yj(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function Qr(e){for(var t=0,r=0,n=0;n<e.length;++n){var s=e.charCodeAt(n);s>=48&&s<=57?t=10*t+(s-48):s>=65&&s<=90&&(r=26*r+(s-64))}return{c:r-1,r:t-1}}function Be(e){for(var t=e.c+1,r="";t;t=(t-1)/26|0)r=String.fromCharCode((t-1)%26+65)+r;return r+(e.r+1)}function Il(e){var t=e.indexOf(":");return t==-1?{s:Qr(e),e:Qr(e)}:{s:Qr(e.slice(0,t)),e:Qr(e.slice(t+1))}}function at(e,t){return typeof t>"u"||typeof t=="number"?at(e.s,e.e):(typeof e!="string"&&(e=Be(e)),typeof t!="string"&&(t=Be(t)),e==t?e:e+":"+t)}function zt(e){var t={s:{c:0,r:0},e:{c:0,r:0}},r=0,n=0,s=0,a=e.length;for(r=0;n<a&&!((s=e.charCodeAt(n)-64)<1||s>26);++n)r=26*r+s;for(t.s.c=--r,r=0;n<a&&!((s=e.charCodeAt(n)-48)<0||s>9);++n)r=10*r+s;if(t.s.r=--r,n===a||s!=10)return t.e.c=t.s.c,t.e.r=t.s.r,t;for(++n,r=0;n!=a&&!((s=e.charCodeAt(n)-64)<1||s>26);++n)r=26*r+s;for(t.e.c=--r,r=0;n!=a&&!((s=e.charCodeAt(n)-48)<0||s>9);++n)r=10*r+s;return t.e.r=--r,t}function _w(e,t){var r=e.t=="d"&&t instanceof Date;if(e.z!=null)try{return e.w=Gn(e.z,r?en(t):t)}catch{}try{return e.w=Gn((e.XF||{}).numFmtId||(r?14:0),r?en(t):t)}catch{return""+t}}function wa(e,t,r){return e==null||e.t==null||e.t=="z"?"":e.w!==void 0?e.w:(e.t=="d"&&!e.z&&r&&r.dateNF&&(e.z=r.dateNF),e.t=="e"?uo[e.v]||e.v:t==null?_w(e,e.v):_w(e,t))}function yi(e,t){var r=t&&t.sheet?t.sheet:"Sheet1",n={};return n[r]=e,{SheetNames:[r],Sheets:n}}function BA(e,t,r){var n=r||{},s=e?Array.isArray(e):n.dense,a=e||(s?[]:{}),i=0,o=0;if(a&&n.origin!=null){if(typeof n.origin=="number")i=n.origin;else{var l=typeof n.origin=="string"?Qr(n.origin):n.origin;i=l.r,o=l.c}a["!ref"]||(a["!ref"]="A1:A1")}var c={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(a["!ref"]){var u=zt(a["!ref"]);c.s.c=u.s.c,c.s.r=u.s.r,c.e.c=Math.max(c.e.c,u.e.c),c.e.r=Math.max(c.e.r,u.e.r),i==-1&&(c.e.r=i=u.e.r+1)}for(var d=0;d!=t.length;++d)if(t[d]){if(!Array.isArray(t[d]))throw new Error("aoa_to_sheet expects an array of arrays");for(var m=0;m!=t[d].length;++m)if(!(typeof t[d][m]>"u")){var p={v:t[d][m]},x=i+d,g=o+m;if(c.s.r>x&&(c.s.r=x),c.s.c>g&&(c.s.c=g),c.e.r<x&&(c.e.r=x),c.e.c<g&&(c.e.c=g),t[d][m]&&typeof t[d][m]=="object"&&!Array.isArray(t[d][m])&&!(t[d][m]instanceof Date))p=t[d][m];else if(Array.isArray(p.v)&&(p.f=t[d][m][1],p.v=p.v[0]),p.v===null)if(p.f)p.t="n";else if(n.nullError)p.t="e",p.v=0;else if(n.sheetStubs)p.t="z";else continue;else typeof p.v=="number"?p.t="n":typeof p.v=="boolean"?p.t="b":p.v instanceof Date?(p.z=n.dateNF||$e[14],n.cellDates?(p.t="d",p.w=Gn(p.z,en(p.v))):(p.t="n",p.v=en(p.v),p.w=Gn(p.z,p.v))):p.t="s";if(s)a[x]||(a[x]=[]),a[x][g]&&a[x][g].z&&(p.z=a[x][g].z),a[x][g]=p;else{var _=Be({c:g,r:x});a[_]&&a[_].z&&(p.z=a[_].z),a[_]=p}}}return c.s.c<1e7&&(a["!ref"]=at(c)),a}function Cl(e,t){return BA(null,e,t)}function _j(e){return e.read_shift(4,"i")}function $r(e){var t=e.read_shift(4);return t===0?"":e.read_shift(t,"dbcs")}function wj(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function iv(e,t){var r=e.l,n=e.read_shift(1),s=$r(e),a=[],i={t:s,h:s};if(n&1){for(var o=e.read_shift(4),l=0;l!=o;++l)a.push(wj(e));i.r=a}else i.r=[{ich:0,ifnt:0}];return e.l=r+t,i}var Ej=iv;function Kn(e){var t=e.read_shift(4),r=e.read_shift(2);return r+=e.read_shift(1)<<16,e.l++,{c:t,iStyleRef:r}}function lo(e){var t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:t}}var Tj=$r;function ov(e){var t=e.read_shift(4);return t===0||t===4294967295?"":e.read_shift(t,"dbcs")}var kj=$r,Mp=ov;function lv(e){var t=e.slice(e.l,e.l+4),r=t[0]&1,n=t[0]&2;e.l+=4;var s=n===0?ad([0,0,0,0,t[0]&252,t[1],t[2],t[3]],0):Ii(t,0)>>2;return r?s/100:s}function zA(e){var t={s:{},e:{}};return t.s.r=e.read_shift(4),t.e.r=e.read_shift(4),t.s.c=e.read_shift(4),t.e.c=e.read_shift(4),t}var co=zA;function Vr(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function Sj(e){var t={},r=e.read_shift(1),n=r>>>1,s=e.read_shift(1),a=e.read_shift(2,"i"),i=e.read_shift(1),o=e.read_shift(1),l=e.read_shift(1);switch(e.l++,n){case 0:t.auto=1;break;case 1:t.index=s;var c=Vi[s];c&&(t.rgb=du(c));break;case 2:t.rgb=du([i,o,l]);break;case 3:t.theme=s;break}return a!=0&&(t.tint=a>0?a/32767:a/32768),t}function Aj(e){var t=e.read_shift(1);e.l++;var r={fBold:t&1,fItalic:t&2,fUnderline:t&4,fStrikeout:t&8,fOutline:t&16,fShadow:t&32,fCondense:t&64,fExtend:t&128};return r}function $A(e,t){var r={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},n=e.read_shift(4);switch(n){case 0:return"";case 4294967295:case 4294967294:return r[e.read_shift(4)]||""}if(n>400)throw new Error("Unsupported Clipboard: "+n.toString(16));return e.l-=4,e.read_shift(0,t==1?"lpstr":"lpwstr")}function Ij(e){return $A(e,1)}function Cj(e){return $A(e,2)}var cv=2,ln=3,Pf=11,ww=12,id=19,Df=64,Nj=65,Rj=71,bj=4108,Pj=4126,dr=80,WA=81,Dj=[dr,WA],Fj={1:{n:"CodePage",t:cv},2:{n:"Category",t:dr},3:{n:"PresentationFormat",t:dr},4:{n:"ByteCount",t:ln},5:{n:"LineCount",t:ln},6:{n:"ParagraphCount",t:ln},7:{n:"SlideCount",t:ln},8:{n:"NoteCount",t:ln},9:{n:"HiddenCount",t:ln},10:{n:"MultimediaClipCount",t:ln},11:{n:"ScaleCrop",t:Pf},12:{n:"HeadingPairs",t:bj},13:{n:"TitlesOfParts",t:Pj},14:{n:"Manager",t:dr},15:{n:"Company",t:dr},16:{n:"LinksUpToDate",t:Pf},17:{n:"CharacterCount",t:ln},19:{n:"SharedDoc",t:Pf},22:{n:"HyperlinksChanged",t:Pf},23:{n:"AppVersion",t:ln,p:"version"},24:{n:"DigSig",t:Nj},26:{n:"ContentType",t:dr},27:{n:"ContentStatus",t:dr},28:{n:"Language",t:dr},29:{n:"Version",t:dr},255:{},2147483648:{n:"Locale",t:id},2147483651:{n:"Behavior",t:id},1919054434:{}},Oj={1:{n:"CodePage",t:cv},2:{n:"Title",t:dr},3:{n:"Subject",t:dr},4:{n:"Author",t:dr},5:{n:"Keywords",t:dr},6:{n:"Comments",t:dr},7:{n:"Template",t:dr},8:{n:"LastAuthor",t:dr},9:{n:"RevNumber",t:dr},10:{n:"EditTime",t:Df},11:{n:"LastPrinted",t:Df},12:{n:"CreatedDate",t:Df},13:{n:"ModifiedDate",t:Df},14:{n:"PageCount",t:ln},15:{n:"WordCount",t:ln},16:{n:"CharCount",t:ln},17:{n:"Thumbnail",t:Rj},18:{n:"Application",t:dr},19:{n:"DocSecurity",t:ln},255:{},2147483648:{n:"Locale",t:id},2147483651:{n:"Behavior",t:id},1919054434:{}},Ew={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},Mj=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function Lj(e){return e.map(function(t){return[t>>16&255,t>>8&255,t&255]})}var jj=Lj([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Vi=Sr(jj),uo={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},HA={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},Tw={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"};function Uj(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function Vj(e){var t=Uj();if(!e||!e.match)return t;var r={};if((e.match(Kr)||[]).forEach(function(n){var s=Oe(n);switch(s[0].replace(q6,"<")){case"<?xml":break;case"<Types":t.xmlns=s["xmlns"+(s[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":r[s.Extension]=s.ContentType;break;case"<Override":t[Tw[s.ContentType]]!==void 0&&t[Tw[s.ContentType]].push(s.PartName);break}}),t.xmlns!==aj.CT)throw new Error("Unknown Namespace: "+t.xmlns);return t.calcchain=t.calcchains.length>0?t.calcchains[0]:"",t.sst=t.strs.length>0?t.strs[0]:"",t.style=t.styles.length>0?t.styles[0]:"",t.defaults=r,delete t.calcchains,t}var jo={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function Lp(e){var t=e.lastIndexOf("/");return e.slice(0,t+1)+"_rels/"+e.slice(t+1)+".rels"}function Ic(e,t){var r={"!id":{}};if(!e)return r;t.charAt(0)!=="/"&&(t="/"+t);var n={};return(e.match(Kr)||[]).forEach(function(s){var a=Oe(s);if(a[0]==="<Relationship"){var i={};i.Type=a.Type,i.Target=a.Target,i.Id=a.Id,a.TargetMode&&(i.TargetMode=a.TargetMode);var o=a.TargetMode==="External"?a.Target:oc(a.Target,t);r[o]=i,n[a.Id]=i}}),r["!id"]=n,r}var Bj="application/vnd.oasis.opendocument.spreadsheet";function zj(e,t){for(var r=rv(e),n,s;n=fu.exec(r);)switch(n[3]){case"manifest":break;case"file-entry":if(s=Oe(n[0],!1),s.path=="/"&&s.type!==Bj)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(t&&t.WTF)throw n}}var Cc=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],$j=function(){for(var e=new Array(Cc.length),t=0;t<Cc.length;++t){var r=Cc[t],n="(?:"+r[0].slice(0,r[0].indexOf(":"))+":)"+r[0].slice(r[0].indexOf(":")+1);e[t]=new RegExp("<"+n+"[^>]*>([\\s\\S]*?)</"+n+">")}return e}();function GA(e){var t={};e=Tt(e);for(var r=0;r<Cc.length;++r){var n=Cc[r],s=e.match($j[r]);s!=null&&s.length>0&&(t[n[1]]=lt(s[1])),n[2]==="date"&&t[n[1]]&&(t[n[1]]=gr(t[n[1]]))}return t}var Wj=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]];function KA(e,t,r,n){var s=[];if(typeof e=="string")s=dw(e,n);else for(var a=0;a<e.length;++a)s=s.concat(e[a].map(function(u){return{v:u}}));var i=typeof t=="string"?dw(t,n).map(function(u){return u.v}):t,o=0,l=0;if(i.length>0)for(var c=0;c!==s.length;c+=2){switch(l=+s[c+1].v,s[c].v){case"Worksheets":case"":case"":case" ":case"":case" ":case"Arbeitsbltter":case"alma Sayfalar":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de clculo":case"Planilhas":case"Regneark":case"Hojas de clculo":case"Werkbladen":r.Worksheets=l,r.SheetNames=i.slice(o,o+l);break;case"Named Ranges":case"Rangos con nombre":case"":case"Benannte Bereiche":case"Navngivne omrder":r.NamedRanges=l,r.DefinedNames=i.slice(o,o+l);break;case"Charts":case"Diagramme":r.Chartsheets=l,r.ChartNames=i.slice(o,o+l);break}o+=l}}function Hj(e,t,r){var n={};return t||(t={}),e=Tt(e),Wj.forEach(function(s){var a=(e.match(uu(s[0]))||[])[1];switch(s[2]){case"string":a&&(t[s[1]]=lt(a));break;case"bool":t[s[1]]=a==="true";break;case"raw":var i=e.match(new RegExp("<"+s[0]+"[^>]*>([\\s\\S]*?)</"+s[0]+">"));i&&i.length>0&&(n[s[1]]=i[1]);break}}),n.HeadingPairs&&n.TitlesOfParts&&KA(n.HeadingPairs,n.TitlesOfParts,t,r),t}var Gj=/<[^>]+>[^<]*/g;function Kj(e,t){var r={},n="",s=e.match(Gj);if(s)for(var a=0;a!=s.length;++a){var i=s[a],o=Oe(i);switch(o[0]){case"<?xml":break;case"<Properties":break;case"<property":n=lt(o.name);break;case"</property>":n=null;break;default:if(i.indexOf("<vt:")===0){var l=i.split(">"),c=l[0].slice(4),u=l[1];switch(c){case"lpstr":case"bstr":case"lpwstr":r[n]=lt(u);break;case"bool":r[n]=bt(u);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":r[n]=parseInt(u,10);break;case"r4":case"r8":case"decimal":r[n]=parseFloat(u);break;case"filetime":case"date":r[n]=gr(u);break;case"cy":case"error":r[n]=lt(u);break;default:if(c.slice(-1)=="/")break;t.WTF&&typeof console<"u"&&console.warn("Unexpected",i,c,l)}}else if(i.slice(0,2)!=="</"){if(t.WTF)throw new Error(i)}}}return r}var qj={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},rm;function Xj(e,t,r){rm||(rm=Zx(qj)),t=rm[t]||t,e[t]=r}function uv(e){var t=e.read_shift(4),r=e.read_shift(4);return new Date((r/1e7*Math.pow(2,32)+t/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function qA(e,t,r){var n=e.l,s=e.read_shift(0,"lpstr-cp");if(r)for(;e.l-n&3;)++e.l;return s}function XA(e,t,r){var n=e.read_shift(0,"lpwstr");return n}function YA(e,t,r){return t===31?XA(e):qA(e,t,r)}function jp(e,t,r){return YA(e,t,r===!1?0:4)}function Yj(e,t){if(!t)throw new Error("VtUnalignedString must have positive length");return YA(e,t,0)}function Qj(e){for(var t=e.read_shift(4),r=[],n=0;n!=t;++n){var s=e.l;r[n]=e.read_shift(0,"lpwstr").replace(Zr,""),e.l-s&2&&(e.l+=2)}return r}function Jj(e){for(var t=e.read_shift(4),r=[],n=0;n!=t;++n)r[n]=e.read_shift(0,"lpstr-cp").replace(Zr,"");return r}function Zj(e){var t=e.l,r=od(e,WA);e[e.l]==0&&e[e.l+1]==0&&e.l-t&2&&(e.l+=2);var n=od(e,ln);return[r,n]}function e8(e){for(var t=e.read_shift(4),r=[],n=0;n<t/2;++n)r.push(Zj(e));return r}function kw(e,t){for(var r=e.read_shift(4),n={},s=0;s!=r;++s){var a=e.read_shift(4),i=e.read_shift(4);n[a]=e.read_shift(i,t===1200?"utf16le":"utf8").replace(Zr,"").replace(ic,"!"),t===1200&&i%2&&(e.l+=2)}return e.l&3&&(e.l=e.l>>3<<2),n}function QA(e){var t=e.read_shift(4),r=e.slice(e.l,e.l+t);return e.l+=t,(t&3)>0&&(e.l+=4-(t&3)&3),r}function t8(e){var t={};return t.Size=e.read_shift(4),e.l+=t.Size+3-(t.Size-1)%4,t}function od(e,t,r){var n=e.read_shift(2),s,a=r||{};if(e.l+=2,t!==ww&&n!==t&&Dj.indexOf(t)===-1&&!((t&65534)==4126&&(n&65534)==4126))throw new Error("Expected type "+t+" saw "+n);switch(t===ww?n:t){case 2:return s=e.read_shift(2,"i"),a.raw||(e.l+=2),s;case 3:return s=e.read_shift(4,"i"),s;case 11:return e.read_shift(4)!==0;case 19:return s=e.read_shift(4),s;case 30:return qA(e,n,4).replace(Zr,"");case 31:return XA(e);case 64:return uv(e);case 65:return QA(e);case 71:return t8(e);case 80:return jp(e,n,!a.raw).replace(Zr,"");case 81:return Yj(e,n).replace(Zr,"");case 4108:return e8(e);case 4126:case 4127:return n==4127?Qj(e):Jj(e);default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+n)}}function Sw(e,t){var r=e.l,n=e.read_shift(4),s=e.read_shift(4),a=[],i=0,o=0,l=-1,c={};for(i=0;i!=s;++i){var u=e.read_shift(4),d=e.read_shift(4);a[i]=[u,d+r]}a.sort(function(T,w){return T[1]-w[1]});var m={};for(i=0;i!=s;++i){if(e.l!==a[i][1]){var p=!0;if(i>0&&t)switch(t[a[i-1][0]].t){case 2:e.l+2===a[i][1]&&(e.l+=2,p=!1);break;case 80:e.l<=a[i][1]&&(e.l=a[i][1],p=!1);break;case 4108:e.l<=a[i][1]&&(e.l=a[i][1],p=!1);break}if((!t||i==0)&&e.l<=a[i][1]&&(p=!1,e.l=a[i][1]),p)throw new Error("Read Error: Expected address "+a[i][1]+" at "+e.l+" :"+i)}if(t){var x=t[a[i][0]];if(m[x.n]=od(e,x.t,{raw:!0}),x.p==="version"&&(m[x.n]=String(m[x.n]>>16)+"."+("0000"+String(m[x.n]&65535)).slice(-4)),x.n=="CodePage")switch(m[x.n]){case 0:m[x.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:is(o=m[x.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+m[x.n])}}else if(a[i][0]===1){if(o=m.CodePage=od(e,cv),is(o),l!==-1){var g=e.l;e.l=a[l][1],c=kw(e,o),e.l=g}}else if(a[i][0]===0){if(o===0){l=i,e.l=a[i+1][1];continue}c=kw(e,o)}else{var _=c[a[i][0]],k;switch(e[e.l]){case 65:e.l+=4,k=QA(e);break;case 30:e.l+=4,k=jp(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 31:e.l+=4,k=jp(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 3:e.l+=4,k=e.read_shift(4,"i");break;case 19:e.l+=4,k=e.read_shift(4);break;case 5:e.l+=4,k=e.read_shift(8,"f");break;case 11:e.l+=4,k=$t(e,4);break;case 64:e.l+=4,k=gr(uv(e));break;default:throw new Error("unparsed value: "+e[e.l])}m[_]=k}}return e.l=r+n,m}function Aw(e,t,r){var n=e.content;if(!n)return{};wr(n,0);var s,a,i,o,l=0;n.chk("feff","Byte Order: "),n.read_shift(2);var c=n.read_shift(4),u=n.read_shift(16);if(u!==st.utils.consts.HEADER_CLSID&&u!==r)throw new Error("Bad PropertySet CLSID "+u);if(s=n.read_shift(4),s!==1&&s!==2)throw new Error("Unrecognized #Sets: "+s);if(a=n.read_shift(16),o=n.read_shift(4),s===1&&o!==n.l)throw new Error("Length mismatch: "+o+" !== "+n.l);s===2&&(i=n.read_shift(16),l=n.read_shift(4));var d=Sw(n,t),m={SystemIdentifier:c};for(var p in d)m[p]=d[p];if(m.FMTID=a,s===1)return m;if(l-n.l==2&&(n.l+=2),n.l!==l)throw new Error("Length mismatch 2: "+n.l+" !== "+l);var x;try{x=Sw(n,null)}catch{}for(p in x)m[p]=x[p];return m.FMTID=[a,i],m}function ba(e,t){return e.read_shift(t),null}function r8(e,t,r){for(var n=[],s=e.l+t;e.l<s;)n.push(r(e,s-e.l));if(s!==e.l)throw new Error("Slurp error");return n}function $t(e,t){return e.read_shift(t)===1}function Jt(e){return e.read_shift(2,"u")}function JA(e,t){return r8(e,t,Jt)}function n8(e){var t=e.read_shift(1),r=e.read_shift(1);return r===1?t:t===1}function zu(e,t,r){var n=e.read_shift(r&&r.biff>=12?2:1),s="sbcs-cont";if(r&&r.biff>=8,!r||r.biff==8){var a=e.read_shift(1);a&&(s="dbcs-cont")}else r.biff==12&&(s="wstr");r.biff>=2&&r.biff<=5&&(s="cpstr");var i=n?e.read_shift(n,s):"";return i}function s8(e){var t=e.read_shift(2),r=e.read_shift(1),n=r&4,s=r&8,a=1+(r&1),i=0,o,l={};s&&(i=e.read_shift(2)),n&&(o=e.read_shift(4));var c=a==2?"dbcs-cont":"sbcs-cont",u=t===0?"":e.read_shift(t,c);return s&&(e.l+=4*i),n&&(e.l+=o),l.t=u,s||(l.raw="<t>"+l.t+"</t>",l.r=l.t),l}function Zi(e,t,r){var n;if(r){if(r.biff>=2&&r.biff<=5)return e.read_shift(t,"cpstr");if(r.biff>=12)return e.read_shift(t,"dbcs-cont")}var s=e.read_shift(1);return s===0?n=e.read_shift(t,"sbcs-cont"):n=e.read_shift(t,"dbcs-cont"),n}function $u(e,t,r){var n=e.read_shift(r&&r.biff==2?1:2);return n===0?(e.l++,""):Zi(e,n,r)}function fo(e,t,r){if(r.biff>5)return $u(e,t,r);var n=e.read_shift(1);return n===0?(e.l++,""):e.read_shift(n,r.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function a8(e){var t=e.read_shift(1);e.l++;var r=e.read_shift(2);return e.l+=2,[t,r]}function i8(e){var t=e.read_shift(4),r=e.l,n=!1;t>24&&(e.l+=t-24,e.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(n=!0),e.l=r);var s=e.read_shift((n?t-24:t)>>1,"utf16le").replace(Zr,"");return n&&(e.l+=24),s}function o8(e){for(var t=e.read_shift(2),r="";t-- >0;)r+="../";var n=e.read_shift(0,"lpstr-ansi");if(e.l+=2,e.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var s=e.read_shift(4);if(s===0)return r+n.replace(/\\/g,"/");var a=e.read_shift(4);if(e.read_shift(2)!=3)throw new Error("Bad FileMoniker");var i=e.read_shift(a>>1,"utf16le").replace(Zr,"");return r+i}function l8(e,t){var r=e.read_shift(16);switch(r){case"e0c9ea79f9bace118c8200aa004ba90b":return i8(e);case"0303000000000000c000000000000046":return o8(e);default:throw new Error("Unsupported Moniker "+r)}}function Ff(e){var t=e.read_shift(4),r=t>0?e.read_shift(t,"utf16le").replace(Zr,""):"";return r}function c8(e,t){var r=e.l+t,n=e.read_shift(4);if(n!==2)throw new Error("Unrecognized streamVersion: "+n);var s=e.read_shift(2);e.l+=2;var a,i,o,l,c="",u,d;s&16&&(a=Ff(e,r-e.l)),s&128&&(i=Ff(e,r-e.l)),(s&257)===257&&(o=Ff(e,r-e.l)),(s&257)===1&&(l=l8(e,r-e.l)),s&8&&(c=Ff(e,r-e.l)),s&32&&(u=e.read_shift(16)),s&64&&(d=uv(e)),e.l=r;var m=i||o||l||"";m&&c&&(m+="#"+c),m||(m="#"+c),s&2&&m.charAt(0)=="/"&&m.charAt(1)!="/"&&(m="file://"+m);var p={Target:m};return u&&(p.guid=u),d&&(p.time=d),a&&(p.Tooltip=a),p}function ZA(e){var t=e.read_shift(1),r=e.read_shift(1),n=e.read_shift(1),s=e.read_shift(1);return[t,r,n,s]}function eI(e,t){var r=ZA(e);return r[3]=0,r}function Bs(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2);return{r:t,c:r,ixfe:n}}function u8(e){var t=e.read_shift(2),r=e.read_shift(2);return e.l+=8,{type:t,flags:r}}function f8(e,t,r){return t===0?"":fo(e,t,r)}function h8(e,t,r){var n=r.biff>8?4:2,s=e.read_shift(n),a=e.read_shift(n,"i"),i=e.read_shift(n,"i");return[s,a,i]}function tI(e){var t=e.read_shift(2),r=lv(e);return[t,r]}function d8(e,t,r){e.l+=4,t-=4;var n=e.l+t,s=zu(e,t,r),a=e.read_shift(2);if(n-=e.l,a!==n)throw new Error("Malformed AddinUdf: padding = "+n+" != "+a);return e.l+=a,s}function s0(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2),s=e.read_shift(2);return{s:{c:n,r:t},e:{c:s,r}}}function rI(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(1),s=e.read_shift(1);return{s:{c:n,r:t},e:{c:s,r}}}var m8=rI;function nI(e){e.l+=4;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2);return e.l+=12,[r,t,n]}function p8(e){var t={};return e.l+=4,e.l+=16,t.fSharedNote=e.read_shift(2),e.l+=4,t}function g8(e){var t={};return e.l+=4,e.cf=e.read_shift(2),t}function Or(e){e.l+=2,e.l+=e.read_shift(2)}var x8={0:Or,4:Or,5:Or,6:Or,7:g8,8:Or,9:Or,10:Or,11:Or,12:Or,13:p8,14:Or,15:Or,16:Or,17:Or,18:Or,19:Or,20:Or,21:nI};function v8(e,t){for(var r=e.l+t,n=[];e.l<r;){var s=e.read_shift(2);e.l-=2;try{n.push(x8[s](e,r-e.l))}catch{return e.l=r,n}}return e.l!=r&&(e.l=r),n}function Of(e,t){var r={BIFFVer:0,dt:0};switch(r.BIFFVer=e.read_shift(2),t-=2,t>=2&&(r.dt=e.read_shift(2),e.l-=2),r.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(t>6)throw new Error("Unexpected BIFF Ver "+r.BIFFVer)}return e.read_shift(t),r}function y8(e,t){return t===0||e.read_shift(2),1200}function _8(e,t,r){if(r.enc)return e.l+=t,"";var n=e.l,s=fo(e,0,r);return e.read_shift(t+n-e.l),s}function w8(e,t,r){var n=r&&r.biff==8||t==2?e.read_shift(2):(e.l+=t,0);return{fDialog:n&16,fBelow:n&64,fRight:n&128}}function E8(e,t,r){var n=e.read_shift(4),s=e.read_shift(1)&3,a=e.read_shift(1);switch(a){case 0:a="Worksheet";break;case 1:a="Macrosheet";break;case 2:a="Chartsheet";break;case 6:a="VBAModule";break}var i=zu(e,0,r);return i.length===0&&(i="Sheet1"),{pos:n,hs:s,dt:a,name:i}}function T8(e,t){for(var r=e.l+t,n=e.read_shift(4),s=e.read_shift(4),a=[],i=0;i!=s&&e.l<r;++i)a.push(s8(e));return a.Count=n,a.Unique=s,a}function k8(e,t){var r={};return r.dsst=e.read_shift(2),e.l+=t-2,r}function S8(e){var t={};t.r=e.read_shift(2),t.c=e.read_shift(2),t.cnt=e.read_shift(2)-t.c;var r=e.read_shift(2);e.l+=4;var n=e.read_shift(1);return e.l+=3,n&7&&(t.level=n&7),n&32&&(t.hidden=!0),n&64&&(t.hpt=r/20),t}function A8(e){var t=u8(e);if(t.type!=2211)throw new Error("Invalid Future Record "+t.type);var r=e.read_shift(4);return r!==0}function I8(e){return e.read_shift(2),e.read_shift(4)}function Iw(e,t,r){var n=0;r&&r.biff==2||(n=e.read_shift(2));var s=e.read_shift(2);r&&r.biff==2&&(n=1-(s>>15),s&=32767);var a={Unsynced:n&1,DyZero:(n&2)>>1,ExAsc:(n&4)>>2,ExDsc:(n&8)>>3};return[a,s]}function C8(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2),s=e.read_shift(2),a=e.read_shift(2),i=e.read_shift(2),o=e.read_shift(2),l=e.read_shift(2),c=e.read_shift(2);return{Pos:[t,r],Dim:[n,s],Flags:a,CurTab:i,FirstTab:o,Selected:l,TabRatio:c}}function N8(e,t,r){if(r&&r.biff>=2&&r.biff<5)return{};var n=e.read_shift(2);return{RTL:n&64}}function R8(){}function b8(e,t,r){var n={dyHeight:e.read_shift(2),fl:e.read_shift(2)};switch(r&&r.biff||8){case 2:break;case 3:case 4:e.l+=2;break;default:e.l+=10;break}return n.name=zu(e,0,r),n}function P8(e){var t=Bs(e);return t.isst=e.read_shift(4),t}function D8(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=e.l+t,s=Bs(e);r.biff==2&&e.l++;var a=$u(e,n-e.l,r);return s.val=a,s}function F8(e,t,r){var n=e.read_shift(2),s=fo(e,0,r);return[n,s]}var O8=fo;function Cw(e,t,r){var n=e.l+t,s=r.biff==8||!r.biff?4:2,a=e.read_shift(s),i=e.read_shift(s),o=e.read_shift(2),l=e.read_shift(2);return e.l=n,{s:{r:a,c:o},e:{r:i,c:l}}}function M8(e){var t=e.read_shift(2),r=e.read_shift(2),n=tI(e);return{r:t,c:r,ixfe:n[0],rknum:n[1]}}function L8(e,t){for(var r=e.l+t-2,n=e.read_shift(2),s=e.read_shift(2),a=[];e.l<r;)a.push(tI(e));if(e.l!==r)throw new Error("MulRK read error");var i=e.read_shift(2);if(a.length!=i-s+1)throw new Error("MulRK length mismatch");return{r:n,c:s,C:i,rkrec:a}}function j8(e,t){for(var r=e.l+t-2,n=e.read_shift(2),s=e.read_shift(2),a=[];e.l<r;)a.push(e.read_shift(2));if(e.l!==r)throw new Error("MulBlank read error");var i=e.read_shift(2);if(a.length!=i-s+1)throw new Error("MulBlank length mismatch");return{r:n,c:s,C:i,ixfe:a}}function U8(e,t,r,n){var s={},a=e.read_shift(4),i=e.read_shift(4),o=e.read_shift(4),l=e.read_shift(2);return s.patternType=Mj[o>>26],n.cellStyles&&(s.alc=a&7,s.fWrap=a>>3&1,s.alcV=a>>4&7,s.fJustLast=a>>7&1,s.trot=a>>8&255,s.cIndent=a>>16&15,s.fShrinkToFit=a>>20&1,s.iReadOrder=a>>22&2,s.fAtrNum=a>>26&1,s.fAtrFnt=a>>27&1,s.fAtrAlc=a>>28&1,s.fAtrBdr=a>>29&1,s.fAtrPat=a>>30&1,s.fAtrProt=a>>31&1,s.dgLeft=i&15,s.dgRight=i>>4&15,s.dgTop=i>>8&15,s.dgBottom=i>>12&15,s.icvLeft=i>>16&127,s.icvRight=i>>23&127,s.grbitDiag=i>>30&3,s.icvTop=o&127,s.icvBottom=o>>7&127,s.icvDiag=o>>14&127,s.dgDiag=o>>21&15,s.icvFore=l&127,s.icvBack=l>>7&127,s.fsxButton=l>>14&1),s}function V8(e,t,r){var n={};return n.ifnt=e.read_shift(2),n.numFmtId=e.read_shift(2),n.flags=e.read_shift(2),n.fStyle=n.flags>>2&1,t-=6,n.data=U8(e,t,n.fStyle,r),n}function B8(e){e.l+=4;var t=[e.read_shift(2),e.read_shift(2)];if(t[0]!==0&&t[0]--,t[1]!==0&&t[1]--,t[0]>7||t[1]>7)throw new Error("Bad Gutters: "+t.join("|"));return t}function Nw(e,t,r){var n=Bs(e);(r.biff==2||t==9)&&++e.l;var s=n8(e);return n.val=s,n.t=s===!0||s===!1?"b":"e",n}function z8(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=Bs(e),s=Vr(e);return n.val=s,n}var Rw=f8;function $8(e,t,r){var n=e.l+t,s=e.read_shift(2),a=e.read_shift(2);if(r.sbcch=a,a==1025||a==14849)return[a,s];if(a<1||a>255)throw new Error("Unexpected SupBook type: "+a);for(var i=Zi(e,a),o=[];n>e.l;)o.push($u(e));return[a,s,i,o]}function bw(e,t,r){var n=e.read_shift(2),s,a={fBuiltIn:n&1,fWantAdvise:n>>>1&1,fWantPict:n>>>2&1,fOle:n>>>3&1,fOleLink:n>>>4&1,cf:n>>>5&1023,fIcon:n>>>15&1};return r.sbcch===14849&&(s=d8(e,t-2,r)),a.body=s||e.read_shift(t-2),typeof s=="string"&&(a.Name=s),a}var W8=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function Pw(e,t,r){var n=e.l+t,s=e.read_shift(2),a=e.read_shift(1),i=e.read_shift(1),o=e.read_shift(r&&r.biff==2?1:2),l=0;(!r||r.biff>=5)&&(r.biff!=5&&(e.l+=2),l=e.read_shift(2),r.biff==5&&(e.l+=2),e.l+=4);var c=Zi(e,i,r);s&32&&(c=W8[c.charCodeAt(0)]);var u=n-e.l;r&&r.biff==2&&--u;var d=n==e.l||o===0||!(u>0)?[]:SV(e,u,r,o);return{chKey:a,Name:c,itab:l,rgce:d}}function sI(e,t,r){if(r.biff<8)return H8(e,t,r);for(var n=[],s=e.l+t,a=e.read_shift(r.biff>8?4:2);a--!==0;)n.push(h8(e,r.biff>8?12:6,r));if(e.l!=s)throw new Error("Bad ExternSheet: "+e.l+" != "+s);return n}function H8(e,t,r){e[e.l+1]==3&&e[e.l]++;var n=zu(e,t,r);return n.charCodeAt(0)==3?n.slice(1):n}function G8(e,t,r){if(r.biff<8){e.l+=t;return}var n=e.read_shift(2),s=e.read_shift(2),a=Zi(e,n,r),i=Zi(e,s,r);return[a,i]}function K8(e,t,r){var n=rI(e);e.l++;var s=e.read_shift(1);return t-=8,[AV(e,t,r),s,n]}function Dw(e,t,r){var n=m8(e);switch(r.biff){case 2:e.l++,t-=7;break;case 3:case 4:e.l+=2,t-=8;break;default:e.l+=6,t-=12}return[n,TV(e,t,r)]}function q8(e){var t=e.read_shift(4)!==0,r=e.read_shift(4)!==0,n=e.read_shift(4);return[t,r,n]}function X8(e,t,r){if(!(r.biff<8)){var n=e.read_shift(2),s=e.read_shift(2),a=e.read_shift(2),i=e.read_shift(2),o=fo(e,0,r);return r.biff<8&&e.read_shift(1),[{r:n,c:s},o,i,a]}}function Y8(e,t,r){return X8(e,t,r)}function Q8(e,t){for(var r=[],n=e.read_shift(2);n--;)r.push(s0(e));return r}function J8(e,t,r){if(r&&r.biff<8)return e5(e,t,r);var n=nI(e),s=v8(e,t-22,n[1]);return{cmo:n,ft:s}}var Z8={8:function(e,t){var r=e.l+t;e.l+=10;var n=e.read_shift(2);e.l+=4,e.l+=2,e.l+=2,e.l+=2,e.l+=4;var s=e.read_shift(1);return e.l+=s,e.l=r,{fmt:n}}};function e5(e,t,r){e.l+=4;var n=e.read_shift(2),s=e.read_shift(2),a=e.read_shift(2);e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=6,t-=36;var i=[];return i.push((Z8[n]||Gr)(e,t,r)),{cmo:[s,n,a],ft:i}}function t5(e,t,r){var n=e.l,s="";try{e.l+=4;var a=(r.lastobj||{cmo:[0,0]}).cmo[1],i;[0,5,7,11,12,14].indexOf(a)==-1?e.l+=6:i=a8(e,6,r);var o=e.read_shift(2);e.read_shift(2),Jt(e,2);var l=e.read_shift(2);e.l+=l;for(var c=1;c<e.lens.length-1;++c){if(e.l-n!=e.lens[c])throw new Error("TxO: bad continue record");var u=e[e.l],d=Zi(e,e.lens[c+1]-e.lens[c]-1);if(s+=d,s.length>=(u?o:2*o))break}if(s.length!==o&&s.length!==o*2)throw new Error("cchText: "+o+" != "+s.length);return e.l=n+t,{t:s}}catch{return e.l=n+t,{t:s}}}function r5(e,t){var r=s0(e);e.l+=16;var n=c8(e,t-24);return[r,n]}function n5(e,t){e.read_shift(2);var r=s0(e),n=e.read_shift((t-10)/2,"dbcs-cont");return n=n.replace(Zr,""),[r,n]}function s5(e){var t=[0,0],r;return r=e.read_shift(2),t[0]=Ew[r]||r,r=e.read_shift(2),t[1]=Ew[r]||r,t}function a5(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(eI(e));return r}function i5(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(eI(e));return r}function o5(e){e.l+=2;var t={cxfs:0,crc:0};return t.cxfs=e.read_shift(2),t.crc=e.read_shift(4),t}function aI(e,t,r){if(!r.cellStyles)return Gr(e,t);var n=r&&r.biff>=12?4:2,s=e.read_shift(n),a=e.read_shift(n),i=e.read_shift(n),o=e.read_shift(n),l=e.read_shift(2);n==2&&(e.l+=2);var c={s,e:a,w:i,ixfe:o,flags:l};return(r.biff>=5||!r.biff)&&(c.level=l>>8&7),c}function l5(e,t){var r={};return t<32||(e.l+=16,r.header=Vr(e),r.footer=Vr(e),e.l+=2),r}function c5(e,t,r){var n={area:!1};if(r.biff!=5)return e.l+=t,n;var s=e.read_shift(1);return e.l+=3,s&16&&(n.area=!0),n}var u5=Bs,f5=JA,h5=$u;function d5(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),s={fmt:t,env:r,len:n,data:e.slice(e.l,e.l+n)};return e.l+=n,s}function m5(e,t,r){r.biffguess&&r.biff==5&&(r.biff=2);var n=Bs(e);++e.l;var s=fo(e,t-7,r);return n.t="str",n.val=s,n}function p5(e){var t=Bs(e);++e.l;var r=Vr(e);return t.t="n",t.val=r,t}function g5(e){var t=Bs(e);++e.l;var r=e.read_shift(2);return t.t="n",t.val=r,t}function x5(e){var t=e.read_shift(1);return t===0?(e.l++,""):e.read_shift(t,"sbcs-cont")}function v5(e,t){e.l+=6,e.l+=2,e.l+=1,e.l+=3,e.l+=1,e.l+=t-13}function y5(e,t,r){var n=e.l+t,s=Bs(e),a=e.read_shift(2),i=Zi(e,a,r);return e.l=n,s.t="str",s.val=i,s}var _5=[2,3,48,49,131,139,140,245],Fw=function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},t=Zx({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(o,l){var c=[],u=hi(1);switch(l.type){case"base64":u=ss(An(o));break;case"binary":u=ss(o);break;case"buffer":case"array":u=o;break}wr(u,0);var d=u.read_shift(1),m=!!(d&136),p=!1,x=!1;switch(d){case 2:break;case 3:break;case 48:p=!0,m=!0;break;case 49:p=!0,m=!0;break;case 131:break;case 139:break;case 140:x=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+d.toString(16))}var g=0,_=521;d==2&&(g=u.read_shift(2)),u.l+=3,d!=2&&(g=u.read_shift(4)),g>1048576&&(g=1e6),d!=2&&(_=u.read_shift(2));var k=u.read_shift(2),T=l.codepage||1252;d!=2&&(u.l+=16,u.read_shift(1),u[u.l]!==0&&(T=e[u[u.l]]),u.l+=1,u.l+=2),x&&(u.l+=36);for(var w=[],C={},M=Math.min(u.length,d==2?521:_-10-(p?264:0)),O=x?32:11;u.l<M&&u[u.l]!=13;)switch(C={},C.name=lu.utils.decode(T,u.slice(u.l,u.l+O)).replace(/[\u0000\r\n].*$/g,""),u.l+=O,C.type=String.fromCharCode(u.read_shift(1)),d!=2&&!x&&(C.offset=u.read_shift(4)),C.len=u.read_shift(1),d==2&&(C.offset=u.read_shift(2)),C.dec=u.read_shift(1),C.name.length&&w.push(C),d!=2&&(u.l+=x?13:14),C.type){case"B":(!p||C.len!=8)&&l.WTF&&console.log("Skipping "+C.name+":"+C.type);break;case"G":case"P":l.WTF&&console.log("Skipping "+C.name+":"+C.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+C.type)}if(u[u.l]!==13&&(u.l=_-1),u.read_shift(1)!==13)throw new Error("DBF Terminator not found "+u.l+" "+u[u.l]);u.l=_;var v=0,E=0;for(c[0]=[],E=0;E!=w.length;++E)c[0][E]=w[E].name;for(;g-- >0;){if(u[u.l]===42){u.l+=k;continue}for(++u.l,c[++v]=[],E=0,E=0;E!=w.length;++E){var S=u.slice(u.l,u.l+w[E].len);u.l+=w[E].len,wr(S,0);var R=lu.utils.decode(T,S);switch(w[E].type){case"C":R.trim().length&&(c[v][E]=R.replace(/\s+$/,""));break;case"D":R.length===8?c[v][E]=new Date(+R.slice(0,4),+R.slice(4,6)-1,+R.slice(6,8)):c[v][E]=R;break;case"F":c[v][E]=parseFloat(R.trim());break;case"+":case"I":c[v][E]=x?S.read_shift(-4,"i")^2147483648:S.read_shift(4,"i");break;case"L":switch(R.trim().toUpperCase()){case"Y":case"T":c[v][E]=!0;break;case"N":case"F":c[v][E]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+R+"|")}break;case"M":if(!m)throw new Error("DBF Unexpected MEMO for type "+d.toString(16));c[v][E]="##MEMO##"+(x?parseInt(R.trim(),10):S.read_shift(4));break;case"N":R=R.replace(/\u0000/g,"").trim(),R&&R!="."&&(c[v][E]=+R||0);break;case"@":c[v][E]=new Date(S.read_shift(-8,"f")-621356832e5);break;case"T":c[v][E]=new Date((S.read_shift(4)-2440588)*864e5+S.read_shift(4));break;case"Y":c[v][E]=S.read_shift(4,"i")/1e4+S.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":c[v][E]=-S.read_shift(-8,"f");break;case"B":if(p&&w[E].len==8){c[v][E]=S.read_shift(8,"f");break}case"G":case"P":S.l+=w[E].len;break;case"0":if(w[E].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+w[E].type)}}}if(d!=2&&u.l<u.length&&u[u.l++]!=26)throw new Error("DBF EOF Marker missing "+(u.l-1)+" of "+u.length+" "+u[u.l-1].toString(16));return l&&l.sheetRows&&(c=c.slice(0,l.sheetRows)),l.DBF=w,c}function n(o,l){var c=l||{};c.dateNF||(c.dateNF="yyyymmdd");var u=Cl(r(o,c),c);return u["!cols"]=c.DBF.map(function(d){return{wch:d.len,DBF:d}}),delete c.DBF,u}function s(o,l){try{return yi(n(o,l),l)}catch(c){if(l&&l.WTF)throw c}return{SheetNames:[],Sheets:{}}}var a={B:8,C:250,L:1,D:8,"?":0,"":0};function i(o,l){var c=l||{};if(+c.codepage>=0&&is(+c.codepage),c.type=="string")throw new Error("Cannot write DBF to JS string");var u=Op(),d=Hp(o,{header:1,raw:!0,cellDates:!0}),m=d[0],p=d.slice(1),x=o["!cols"]||[],g=0,_=0,k=0,T=1;for(g=0;g<m.length;++g){if(((x[g]||{}).DBF||{}).name){m[g]=x[g].DBF.name,++k;continue}if(m[g]!=null){if(++k,typeof m[g]=="number"&&(m[g]=m[g].toString(10)),typeof m[g]!="string")throw new Error("DBF Invalid column name "+m[g]+" |"+typeof m[g]+"|");if(m.indexOf(m[g])!==g){for(_=0;_<1024;++_)if(m.indexOf(m[g]+"_"+_)==-1){m[g]+="_"+_;break}}}}var w=zt(o["!ref"]),C=[],M=[],O=[];for(g=0;g<=w.e.c-w.s.c;++g){var v="",E="",S=0,R=[];for(_=0;_<p.length;++_)p[_][g]!=null&&R.push(p[_][g]);if(R.length==0||m[g]==null){C[g]="?";continue}for(_=0;_<R.length;++_){switch(typeof R[_]){case"number":E="B";break;case"string":E="C";break;case"boolean":E="L";break;case"object":E=R[_]instanceof Date?"D":"C";break;default:E="C"}S=Math.max(S,String(R[_]).length),v=v&&v!=E?"C":E}S>250&&(S=250),E=((x[g]||{}).DBF||{}).type,E=="C"&&x[g].DBF.len>S&&(S=x[g].DBF.len),v=="B"&&E=="N"&&(v="N",O[g]=x[g].DBF.dec,S=x[g].DBF.len),M[g]=v=="C"||E=="N"?S:a[v]||0,T+=M[g],C[g]=v}var P=u.next(32);for(P.write_shift(4,318902576),P.write_shift(4,p.length),P.write_shift(2,296+32*k),P.write_shift(2,T),g=0;g<4;++g)P.write_shift(4,0);for(P.write_shift(4,0|(+t[sA]||3)<<8),g=0,_=0;g<m.length;++g)if(m[g]!=null){var D=u.next(32),N=(m[g].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);D.write_shift(1,N,"sbcs"),D.write_shift(1,C[g]=="?"?"C":C[g],"sbcs"),D.write_shift(4,_),D.write_shift(1,M[g]||a[C[g]]||0),D.write_shift(1,O[g]||0),D.write_shift(1,2),D.write_shift(4,0),D.write_shift(1,0),D.write_shift(4,0),D.write_shift(4,0),_+=M[g]||a[C[g]]||0}var ce=u.next(264);for(ce.write_shift(4,13),g=0;g<65;++g)ce.write_shift(4,0);for(g=0;g<p.length;++g){var oe=u.next(T);for(oe.write_shift(1,0),_=0;_<m.length;++_)if(m[_]!=null)switch(C[_]){case"L":oe.write_shift(1,p[g][_]==null?63:p[g][_]?84:70);break;case"B":oe.write_shift(8,p[g][_]||0,"f");break;case"N":var de="0";for(typeof p[g][_]=="number"&&(de=p[g][_].toFixed(O[_]||0)),k=0;k<M[_]-de.length;++k)oe.write_shift(1,32);oe.write_shift(1,de,"sbcs");break;case"D":p[g][_]?(oe.write_shift(4,("0000"+p[g][_].getFullYear()).slice(-4),"sbcs"),oe.write_shift(2,("00"+(p[g][_].getMonth()+1)).slice(-2),"sbcs"),oe.write_shift(2,("00"+p[g][_].getDate()).slice(-2),"sbcs")):oe.write_shift(8,"00000000","sbcs");break;case"C":var ge=String(p[g][_]!=null?p[g][_]:"").slice(0,M[_]);for(oe.write_shift(1,ge,"sbcs"),k=0;k<M[_]-ge.length;++k)oe.write_shift(1,32);break}}return u.next(1).write_shift(1,26),u.end()}return{to_workbook:s,to_sheet:n,from_sheet:i}}(),w5=function(){var e={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},t=new RegExp("\x1BN("+Fs(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(m,p){var x=e[p];return typeof x=="number"?Y_(x):x},n=function(m,p,x){var g=p.charCodeAt(0)-32<<4|x.charCodeAt(0)-48;return g==59?m:Y_(g)};e["|"]=254;function s(m,p){switch(p.type){case"base64":return a(An(m),p);case"binary":return a(m,p);case"buffer":return a(et&&Buffer.isBuffer(m)?m.toString("binary"):oo(m),p);case"array":return a(Ji(m),p)}throw new Error("Unrecognized type "+p.type)}function a(m,p){var x=m.split(/[\n\r]+/),g=-1,_=-1,k=0,T=0,w=[],C=[],M=null,O={},v=[],E=[],S=[],R=0,P;for(+p.codepage>=0&&is(+p.codepage);k!==x.length;++k){R=0;var D=x[k].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(t,r),N=D.replace(/;;/g,"\0").split(";").map(function(W){return W.replace(/\u0000/g,";")}),ce=N[0],oe;if(D.length>0)switch(ce){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":N[1].charAt(0)=="P"&&C.push(D.slice(3).replace(/;;/g,";"));break;case"C":var de=!1,ge=!1,Z=!1,G=!1,ae=-1,fe=-1;for(T=1;T<N.length;++T)switch(N[T].charAt(0)){case"A":break;case"X":_=parseInt(N[T].slice(1))-1,ge=!0;break;case"Y":for(g=parseInt(N[T].slice(1))-1,ge||(_=0),P=w.length;P<=g;++P)w[P]=[];break;case"K":oe=N[T].slice(1),oe.charAt(0)==='"'?oe=oe.slice(1,oe.length-1):oe==="TRUE"?oe=!0:oe==="FALSE"?oe=!1:isNaN(fs(oe))?isNaN(gl(oe).getDate())||(oe=gr(oe)):(oe=fs(oe),M!==null&&Al(M)&&(oe=n0(oe))),de=!0;break;case"E":G=!0;var B=Qo(N[T].slice(1),{r:g,c:_});w[g][_]=[w[g][_],B];break;case"S":Z=!0,w[g][_]=[w[g][_],"S5S"];break;case"G":break;case"R":ae=parseInt(N[T].slice(1))-1;break;case"C":fe=parseInt(N[T].slice(1))-1;break;default:if(p&&p.WTF)throw new Error("SYLK bad record "+D)}if(de&&(w[g][_]&&w[g][_].length==2?w[g][_][0]=oe:w[g][_]=oe,M=null),Z){if(G)throw new Error("SYLK shared formula cannot have own formula");var K=ae>-1&&w[ae][fe];if(!K||!K[1])throw new Error("SYLK shared formula cannot find base");w[g][_][1]=pI(K[1],{r:g-ae,c:_-fe})}break;case"F":var q=0;for(T=1;T<N.length;++T)switch(N[T].charAt(0)){case"X":_=parseInt(N[T].slice(1))-1,++q;break;case"Y":for(g=parseInt(N[T].slice(1))-1,P=w.length;P<=g;++P)w[P]=[];break;case"M":R=parseInt(N[T].slice(1))/20;break;case"F":break;case"G":break;case"P":M=C[parseInt(N[T].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(S=N[T].slice(1).split(" "),P=parseInt(S[0],10);P<=parseInt(S[1],10);++P)R=parseInt(S[2],10),E[P-1]=R===0?{hidden:!0}:{wch:R},xl(E[P-1]);break;case"C":_=parseInt(N[T].slice(1))-1,E[_]||(E[_]={});break;case"R":g=parseInt(N[T].slice(1))-1,v[g]||(v[g]={}),R>0?(v[g].hpt=R,v[g].hpx=mu(R)):R===0&&(v[g].hidden=!0);break;default:if(p&&p.WTF)throw new Error("SYLK bad record "+D)}q<1&&(M=null);break;default:if(p&&p.WTF)throw new Error("SYLK bad record "+D)}}return v.length>0&&(O["!rows"]=v),E.length>0&&(O["!cols"]=E),p&&p.sheetRows&&(w=w.slice(0,p.sheetRows)),[w,O]}function i(m,p){var x=s(m,p),g=x[0],_=x[1],k=Cl(g,p);return Fs(_).forEach(function(T){k[T]=_[T]}),k}function o(m,p){return yi(i(m,p),p)}function l(m,p,x,g){var _="C;Y"+(x+1)+";X"+(g+1)+";K";switch(m.t){case"n":_+=m.v||0,m.f&&!m.F&&(_+=";E"+oU(m.f,{r:x,c:g}));break;case"b":_+=m.v?"TRUE":"FALSE";break;case"e":_+=m.w||m.v;break;case"d":_+='"'+(m.w||m.v)+'"';break;case"s":_+='"'+m.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return _}function c(m,p){p.forEach(function(x,g){var _="F;W"+(g+1)+" "+(g+1)+" ";x.hidden?_+="0":(typeof x.width=="number"&&!x.wpx&&(x.wpx=cd(x.width)),typeof x.wpx=="number"&&!x.wch&&(x.wch=ud(x.wpx)),typeof x.wch=="number"&&(_+=Math.round(x.wch))),_.charAt(_.length-1)!=" "&&m.push(_)})}function u(m,p){p.forEach(function(x,g){var _="F;";x.hidden?_+="M0;":x.hpt?_+="M"+20*x.hpt+";":x.hpx&&(_+="M"+20*hI(x.hpx)+";"),_.length>2&&m.push(_+"R"+(g+1))})}function d(m,p){var x=["ID;PWXL;N;E"],g=[],_=zt(m["!ref"]),k,T=Array.isArray(m),w=`\r
`;x.push("P;PGeneral"),x.push("F;P0;DG0G8;M255"),m["!cols"]&&c(x,m["!cols"]),m["!rows"]&&u(x,m["!rows"]),x.push("B;Y"+(_.e.r-_.s.r+1)+";X"+(_.e.c-_.s.c+1)+";D"+[_.s.c,_.s.r,_.e.c,_.e.r].join(" "));for(var C=_.s.r;C<=_.e.r;++C)for(var M=_.s.c;M<=_.e.c;++M){var O=Be({r:C,c:M});k=T?(m[C]||[])[M]:m[O],!(!k||k.v==null&&(!k.f||k.F))&&g.push(l(k,m,C,M))}return x.join(w)+w+g.join(w)+w+"E"+w}return{to_workbook:o,to_sheet:i,from_sheet:d}}(),E5=function(){function e(a,i){switch(i.type){case"base64":return t(An(a),i);case"binary":return t(a,i);case"buffer":return t(et&&Buffer.isBuffer(a)?a.toString("binary"):oo(a),i);case"array":return t(Ji(a),i)}throw new Error("Unrecognized type "+i.type)}function t(a,i){for(var o=a.split(`
`),l=-1,c=-1,u=0,d=[];u!==o.length;++u){if(o[u].trim()==="BOT"){d[++l]=[],c=0;continue}if(!(l<0)){var m=o[u].trim().split(","),p=m[0],x=m[1];++u;for(var g=o[u]||"";(g.match(/["]/g)||[]).length&1&&u<o.length-1;)g+=`
`+o[++u];switch(g=g.trim(),+p){case-1:if(g==="BOT"){d[++l]=[],c=0;continue}else if(g!=="EOD")throw new Error("Unrecognized DIF special command "+g);break;case 0:g==="TRUE"?d[l][c]=!0:g==="FALSE"?d[l][c]=!1:isNaN(fs(x))?isNaN(gl(x).getDate())?d[l][c]=x:d[l][c]=gr(x):d[l][c]=fs(x),++c;break;case 1:g=g.slice(1,g.length-1),g=g.replace(/""/g,'"'),g&&g.match(/^=".*"$/)&&(g=g.slice(2,-1)),d[l][c++]=g!==""?g:null;break}if(g==="EOD")break}}return i&&i.sheetRows&&(d=d.slice(0,i.sheetRows)),d}function r(a,i){return Cl(e(a,i),i)}function n(a,i){return yi(r(a,i),i)}var s=function(){var a=function(l,c,u,d,m){l.push(c),l.push(u+","+d),l.push('"'+m.replace(/"/g,'""')+'"')},i=function(l,c,u,d){l.push(c+","+u),l.push(c==1?'"'+d.replace(/"/g,'""')+'"':d)};return function(l){var c=[],u=zt(l["!ref"]),d,m=Array.isArray(l);a(c,"TABLE",0,1,"sheetjs"),a(c,"VECTORS",0,u.e.r-u.s.r+1,""),a(c,"TUPLES",0,u.e.c-u.s.c+1,""),a(c,"DATA",0,0,"");for(var p=u.s.r;p<=u.e.r;++p){i(c,-1,0,"BOT");for(var x=u.s.c;x<=u.e.c;++x){var g=Be({r:p,c:x});if(d=m?(l[p]||[])[x]:l[g],!d){i(c,1,0,"");continue}switch(d.t){case"n":var _=d.w;!_&&d.v!=null&&(_=d.v),_==null?d.f&&!d.F?i(c,1,0,"="+d.f):i(c,1,0,""):i(c,0,_,"V");break;case"b":i(c,0,d.v?1:0,d.v?"TRUE":"FALSE");break;case"s":i(c,1,0,isNaN(d.v)?d.v:'="'+d.v+'"');break;case"d":d.w||(d.w=Gn(d.z||$e[14],en(gr(d.v)))),i(c,0,d.w,"V");break;default:i(c,1,0,"")}}}i(c,-1,0,"EOD");var k=`\r
`,T=c.join(k);return T}}();return{to_workbook:n,to_sheet:r,from_sheet:s}}(),T5=function(){function e(d){return d.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function t(d){return d.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(d,m){for(var p=d.split(`
`),x=-1,g=-1,_=0,k=[];_!==p.length;++_){var T=p[_].trim().split(":");if(T[0]==="cell"){var w=Qr(T[1]);if(k.length<=w.r)for(x=k.length;x<=w.r;++x)k[x]||(k[x]=[]);switch(x=w.r,g=w.c,T[2]){case"t":k[x][g]=e(T[3]);break;case"v":k[x][g]=+T[3];break;case"vtf":var C=T[T.length-1];case"vtc":switch(T[3]){case"nl":k[x][g]=!!+T[4];break;default:k[x][g]=+T[4];break}T[2]=="vtf"&&(k[x][g]=[k[x][g],C])}}}return m&&m.sheetRows&&(k=k.slice(0,m.sheetRows)),k}function n(d,m){return Cl(r(d,m),m)}function s(d,m){return yi(n(d,m),m)}var a=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),i=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,o=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),l="--SocialCalcSpreadsheetControlSave--";function c(d){if(!d||!d["!ref"])return"";for(var m=[],p=[],x,g="",_=Il(d["!ref"]),k=Array.isArray(d),T=_.s.r;T<=_.e.r;++T)for(var w=_.s.c;w<=_.e.c;++w)if(g=Be({r:T,c:w}),x=k?(d[T]||[])[w]:d[g],!(!x||x.v==null||x.t==="z")){switch(p=["cell",g,"t"],x.t){case"s":case"str":p.push(t(x.v));break;case"n":x.f?(p[2]="vtf",p[3]="n",p[4]=x.v,p[5]=t(x.f)):(p[2]="v",p[3]=x.v);break;case"b":p[2]="vt"+(x.f?"f":"c"),p[3]="nl",p[4]=x.v?"1":"0",p[5]=t(x.f||(x.v?"TRUE":"FALSE"));break;case"d":var C=en(gr(x.v));p[2]="vtc",p[3]="nd",p[4]=""+C,p[5]=x.w||Gn(x.z||$e[14],C);break;case"e":continue}m.push(p.join(":"))}return m.push("sheet:c:"+(_.e.c-_.s.c+1)+":r:"+(_.e.r-_.s.r+1)+":tvf:1"),m.push("valueformat:1:text-wiki"),m.join(`
`)}function u(d){return[a,i,o,i,c(d),l].join(`
`)}return{to_workbook:s,to_sheet:n,from_sheet:u}}(),hu=function(){function e(u,d,m,p,x){x.raw?d[m][p]=u:u===""||(u==="TRUE"?d[m][p]=!0:u==="FALSE"?d[m][p]=!1:isNaN(fs(u))?isNaN(gl(u).getDate())?d[m][p]=u:d[m][p]=gr(u):d[m][p]=fs(u))}function t(u,d){var m=d||{},p=[];if(!u||u.length===0)return p;for(var x=u.split(/[\r\n]/),g=x.length-1;g>=0&&x[g].length===0;)--g;for(var _=10,k=0,T=0;T<=g;++T)k=x[T].indexOf(" "),k==-1?k=x[T].length:k++,_=Math.max(_,k);for(T=0;T<=g;++T){p[T]=[];var w=0;for(e(x[T].slice(0,_).trim(),p,T,w,m),w=1;w<=(x[T].length-_)/10+1;++w)e(x[T].slice(_+(w-1)*10,_+w*10).trim(),p,T,w,m)}return m.sheetRows&&(p=p.slice(0,m.sheetRows)),p}var r={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function s(u){for(var d={},m=!1,p=0,x=0;p<u.length;++p)(x=u.charCodeAt(p))==34?m=!m:!m&&x in r&&(d[x]=(d[x]||0)+1);x=[];for(p in d)Object.prototype.hasOwnProperty.call(d,p)&&x.push([d[p],p]);if(!x.length){d=n;for(p in d)Object.prototype.hasOwnProperty.call(d,p)&&x.push([d[p],p])}return x.sort(function(g,_){return g[0]-_[0]||n[g[1]]-n[_[1]]}),r[x.pop()[1]]||44}function a(u,d){var m=d||{},p="",x=m.dense?[]:{},g={s:{c:0,r:0},e:{c:0,r:0}};u.slice(0,4)=="sep="?u.charCodeAt(5)==13&&u.charCodeAt(6)==10?(p=u.charAt(4),u=u.slice(7)):u.charCodeAt(5)==13||u.charCodeAt(5)==10?(p=u.charAt(4),u=u.slice(6)):p=s(u.slice(0,1024)):m&&m.FS?p=m.FS:p=s(u.slice(0,1024));var _=0,k=0,T=0,w=0,C=0,M=p.charCodeAt(0),O=!1,v=0,E=u.charCodeAt(0);u=u.replace(/\r\n/mg,`
`);var S=m.dateNF!=null?F6(m.dateNF):null;function R(){var P=u.slice(w,C),D={};if(P.charAt(0)=='"'&&P.charAt(P.length-1)=='"'&&(P=P.slice(1,-1).replace(/""/g,'"')),P.length===0)D.t="z";else if(m.raw)D.t="s",D.v=P;else if(P.trim().length===0)D.t="s",D.v=P;else if(P.charCodeAt(0)==61)P.charCodeAt(1)==34&&P.charCodeAt(P.length-1)==34?(D.t="s",D.v=P.slice(2,-1).replace(/""/g,'"')):cU(P)?(D.t="n",D.f=P.slice(1)):(D.t="s",D.v=P);else if(P=="TRUE")D.t="b",D.v=!0;else if(P=="FALSE")D.t="b",D.v=!1;else if(!isNaN(T=fs(P)))D.t="n",m.cellText!==!1&&(D.w=P),D.v=T;else if(!isNaN(gl(P).getDate())||S&&P.match(S)){D.z=m.dateNF||$e[14];var N=0;S&&P.match(S)&&(P=O6(P,m.dateNF,P.match(S)||[]),N=1),m.cellDates?(D.t="d",D.v=gr(P,N)):(D.t="n",D.v=en(gr(P,N))),m.cellText!==!1&&(D.w=Gn(D.z,D.v instanceof Date?en(D.v):D.v)),m.cellNF||delete D.z}else D.t="s",D.v=P;if(D.t=="z"||(m.dense?(x[_]||(x[_]=[]),x[_][k]=D):x[Be({c:k,r:_})]=D),w=C+1,E=u.charCodeAt(w),g.e.c<k&&(g.e.c=k),g.e.r<_&&(g.e.r=_),v==M)++k;else if(k=0,++_,m.sheetRows&&m.sheetRows<=_)return!0}e:for(;C<u.length;++C)switch(v=u.charCodeAt(C)){case 34:E===34&&(O=!O);break;case M:case 10:case 13:if(!O&&R())break e;break}return C-w>0&&R(),x["!ref"]=at(g),x}function i(u,d){return!(d&&d.PRN)||d.FS||u.slice(0,4)=="sep="||u.indexOf("	")>=0||u.indexOf(",")>=0||u.indexOf(";")>=0?a(u,d):Cl(t(u,d),d)}function o(u,d){var m="",p=d.type=="string"?[0,0,0,0]:vv(u,d);switch(d.type){case"base64":m=An(u);break;case"binary":m=u;break;case"buffer":d.codepage==65001?m=u.toString("utf8"):d.codepage&&typeof lu<"u"||(m=et&&Buffer.isBuffer(u)?u.toString("binary"):oo(u));break;case"array":m=Ji(u);break;case"string":m=u;break;default:throw new Error("Unrecognized type "+d.type)}return p[0]==239&&p[1]==187&&p[2]==191?m=Tt(m.slice(3)):d.type!="string"&&d.type!="buffer"&&d.codepage==65001?m=Tt(m):d.type=="binary"&&typeof lu<"u",m.slice(0,19)=="socialcalc:version:"?T5.to_sheet(d.type=="string"?m:Tt(m),d):i(m,d)}function l(u,d){return yi(o(u,d),d)}function c(u){for(var d=[],m=zt(u["!ref"]),p,x=Array.isArray(u),g=m.s.r;g<=m.e.r;++g){for(var _=[],k=m.s.c;k<=m.e.c;++k){var T=Be({r:g,c:k});if(p=x?(u[g]||[])[k]:u[T],!p||p.v==null){_.push("          ");continue}for(var w=(p.w||(wa(p),p.w)||"").slice(0,10);w.length<10;)w+=" ";_.push(w+(k===0?" ":""))}d.push(_.join(""))}return d.join(`
`)}return{to_workbook:l,to_sheet:o,from_sheet:c}}();function k5(e,t){var r=t||{},n=!!r.WTF;r.WTF=!0;try{var s=w5.to_workbook(e,r);return r.WTF=n,s}catch(a){if(r.WTF=n,!a.message.match(/SYLK bad record ID/)&&n)throw a;return hu.to_workbook(e,t)}}var Nc=function(){function e(B,K,q){if(B){wr(B,B.l||0);for(var W=q.Enum||ae;B.l<B.length;){var Q=B.read_shift(2),ue=W[Q]||W[65535],Ee=B.read_shift(2),_e=B.l+Ee,me=ue.f&&ue.f(B,Ee,q);if(B.l=_e,K(me,ue,Q))return}}}function t(B,K){switch(K.type){case"base64":return r(ss(An(B)),K);case"binary":return r(ss(B),K);case"buffer":case"array":return r(B,K)}throw"Unsupported type "+K.type}function r(B,K){if(!B)return B;var q=K||{},W=q.dense?[]:{},Q="Sheet1",ue="",Ee=0,_e={},me=[],je=[],H={s:{r:0,c:0},e:{r:0,c:0}},tt=q.sheetRows||0;if(B[2]==0&&(B[3]==8||B[3]==9)&&B.length>=16&&B[14]==5&&B[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(B[2]==2)q.Enum=ae,e(B,function(Ae,_t,ur){switch(ur){case 0:q.vers=Ae,Ae>=4096&&(q.qpro=!0);break;case 6:H=Ae;break;case 204:Ae&&(ue=Ae);break;case 222:ue=Ae;break;case 15:case 51:q.qpro||(Ae[1].v=Ae[1].v.slice(1));case 13:case 14:case 16:ur==14&&(Ae[2]&112)==112&&(Ae[2]&15)>1&&(Ae[2]&15)<15&&(Ae[1].z=q.dateNF||$e[14],q.cellDates&&(Ae[1].t="d",Ae[1].v=n0(Ae[1].v))),q.qpro&&Ae[3]>Ee&&(W["!ref"]=at(H),_e[Q]=W,me.push(Q),W=q.dense?[]:{},H={s:{r:0,c:0},e:{r:0,c:0}},Ee=Ae[3],Q=ue||"Sheet"+(Ee+1),ue="");var Nr=q.dense?(W[Ae[0].r]||[])[Ae[0].c]:W[Be(Ae[0])];if(Nr){Nr.t=Ae[1].t,Nr.v=Ae[1].v,Ae[1].z!=null&&(Nr.z=Ae[1].z),Ae[1].f!=null&&(Nr.f=Ae[1].f);break}q.dense?(W[Ae[0].r]||(W[Ae[0].r]=[]),W[Ae[0].r][Ae[0].c]=Ae[1]):W[Be(Ae[0])]=Ae[1];break}},q);else if(B[2]==26||B[2]==14)q.Enum=fe,B[2]==14&&(q.qpro=!0,B.l=0),e(B,function(Ae,_t,ur){switch(ur){case 204:Q=Ae;break;case 22:Ae[1].v=Ae[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(Ae[3]>Ee&&(W["!ref"]=at(H),_e[Q]=W,me.push(Q),W=q.dense?[]:{},H={s:{r:0,c:0},e:{r:0,c:0}},Ee=Ae[3],Q="Sheet"+(Ee+1)),tt>0&&Ae[0].r>=tt)break;q.dense?(W[Ae[0].r]||(W[Ae[0].r]=[]),W[Ae[0].r][Ae[0].c]=Ae[1]):W[Be(Ae[0])]=Ae[1],H.e.c<Ae[0].c&&(H.e.c=Ae[0].c),H.e.r<Ae[0].r&&(H.e.r=Ae[0].r);break;case 27:Ae[14e3]&&(je[Ae[14e3][0]]=Ae[14e3][1]);break;case 1537:je[Ae[0]]=Ae[1],Ae[0]==Ee&&(Q=Ae[1]);break}},q);else throw new Error("Unrecognized LOTUS BOF "+B[2]);if(W["!ref"]=at(H),_e[ue||Q]=W,me.push(ue||Q),!je.length)return{SheetNames:me,Sheets:_e};for(var He={},Je=[],De=0;De<je.length;++De)_e[me[De]]?(Je.push(je[De]||me[De]),He[je[De]]=_e[je[De]]||_e[me[De]]):(Je.push(je[De]),He[je[De]]={"!ref":"A1"});return{SheetNames:Je,Sheets:He}}function n(B,K){var q=K||{};if(+q.codepage>=0&&is(+q.codepage),q.type=="string")throw new Error("Cannot write WK1 to JS string");var W=Op(),Q=zt(B["!ref"]),ue=Array.isArray(B),Ee=[];Jn(W,0,a(1030)),Jn(W,6,l(Q));for(var _e=Math.min(Q.e.r,8191),me=Q.s.r;me<=_e;++me)for(var je=Ar(me),H=Q.s.c;H<=Q.e.c;++H){me===Q.s.r&&(Ee[H]=ir(H));var tt=Ee[H]+je,He=ue?(B[me]||[])[H]:B[tt];if(!(!He||He.t=="z"))if(He.t=="n")(He.v|0)==He.v&&He.v>=-32768&&He.v<=32767?Jn(W,13,p(me,H,He.v)):Jn(W,14,g(me,H,He.v));else{var Je=wa(He);Jn(W,15,d(me,H,Je.slice(0,239)))}}return Jn(W,1),W.end()}function s(B,K){var q=K||{};if(+q.codepage>=0&&is(+q.codepage),q.type=="string")throw new Error("Cannot write WK3 to JS string");var W=Op();Jn(W,0,i(B));for(var Q=0,ue=0;Q<B.SheetNames.length;++Q)(B.Sheets[B.SheetNames[Q]]||{})["!ref"]&&Jn(W,27,G(B.SheetNames[Q],ue++));var Ee=0;for(Q=0;Q<B.SheetNames.length;++Q){var _e=B.Sheets[B.SheetNames[Q]];if(!(!_e||!_e["!ref"])){for(var me=zt(_e["!ref"]),je=Array.isArray(_e),H=[],tt=Math.min(me.e.r,8191),He=me.s.r;He<=tt;++He)for(var Je=Ar(He),De=me.s.c;De<=me.e.c;++De){He===me.s.r&&(H[De]=ir(De));var Ae=H[De]+Je,_t=je?(_e[He]||[])[De]:_e[Ae];if(!(!_t||_t.t=="z"))if(_t.t=="n")Jn(W,23,R(He,De,Ee,_t.v));else{var ur=wa(_t);Jn(W,22,v(He,De,Ee,ur.slice(0,239)))}}++Ee}}return Jn(W,1),W.end()}function a(B){var K=nr(2);return K.write_shift(2,B),K}function i(B){var K=nr(26);K.write_shift(2,4096),K.write_shift(2,4),K.write_shift(4,0);for(var q=0,W=0,Q=0,ue=0;ue<B.SheetNames.length;++ue){var Ee=B.SheetNames[ue],_e=B.Sheets[Ee];if(!(!_e||!_e["!ref"])){++Q;var me=Il(_e["!ref"]);q<me.e.r&&(q=me.e.r),W<me.e.c&&(W=me.e.c)}}return q>8191&&(q=8191),K.write_shift(2,q),K.write_shift(1,Q),K.write_shift(1,W),K.write_shift(2,0),K.write_shift(2,0),K.write_shift(1,1),K.write_shift(1,2),K.write_shift(4,0),K.write_shift(4,0),K}function o(B,K,q){var W={s:{c:0,r:0},e:{c:0,r:0}};return K==8&&q.qpro?(W.s.c=B.read_shift(1),B.l++,W.s.r=B.read_shift(2),W.e.c=B.read_shift(1),B.l++,W.e.r=B.read_shift(2),W):(W.s.c=B.read_shift(2),W.s.r=B.read_shift(2),K==12&&q.qpro&&(B.l+=2),W.e.c=B.read_shift(2),W.e.r=B.read_shift(2),K==12&&q.qpro&&(B.l+=2),W.s.c==65535&&(W.s.c=W.e.c=W.s.r=W.e.r=0),W)}function l(B){var K=nr(8);return K.write_shift(2,B.s.c),K.write_shift(2,B.s.r),K.write_shift(2,B.e.c),K.write_shift(2,B.e.r),K}function c(B,K,q){var W=[{c:0,r:0},{t:"n",v:0},0,0];return q.qpro&&q.vers!=20768?(W[0].c=B.read_shift(1),W[3]=B.read_shift(1),W[0].r=B.read_shift(2),B.l+=2):(W[2]=B.read_shift(1),W[0].c=B.read_shift(2),W[0].r=B.read_shift(2)),W}function u(B,K,q){var W=B.l+K,Q=c(B,K,q);if(Q[1].t="s",q.vers==20768){B.l++;var ue=B.read_shift(1);return Q[1].v=B.read_shift(ue,"utf8"),Q}return q.qpro&&B.l++,Q[1].v=B.read_shift(W-B.l,"cstr"),Q}function d(B,K,q){var W=nr(7+q.length);W.write_shift(1,255),W.write_shift(2,K),W.write_shift(2,B),W.write_shift(1,39);for(var Q=0;Q<W.length;++Q){var ue=q.charCodeAt(Q);W.write_shift(1,ue>=128?95:ue)}return W.write_shift(1,0),W}function m(B,K,q){var W=c(B,K,q);return W[1].v=B.read_shift(2,"i"),W}function p(B,K,q){var W=nr(7);return W.write_shift(1,255),W.write_shift(2,K),W.write_shift(2,B),W.write_shift(2,q,"i"),W}function x(B,K,q){var W=c(B,K,q);return W[1].v=B.read_shift(8,"f"),W}function g(B,K,q){var W=nr(13);return W.write_shift(1,255),W.write_shift(2,K),W.write_shift(2,B),W.write_shift(8,q,"f"),W}function _(B,K,q){var W=B.l+K,Q=c(B,K,q);if(Q[1].v=B.read_shift(8,"f"),q.qpro)B.l=W;else{var ue=B.read_shift(2);C(B.slice(B.l,B.l+ue),Q),B.l+=ue}return Q}function k(B,K,q){var W=K&32768;return K&=-32769,K=(W?B:0)+(K>=8192?K-16384:K),(W?"":"$")+(q?ir(K):Ar(K))}var T={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},w=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function C(B,K){wr(B,0);for(var q=[],W=0,Q="",ue="",Ee="",_e="";B.l<B.length;){var me=B[B.l++];switch(me){case 0:q.push(B.read_shift(8,"f"));break;case 1:ue=k(K[0].c,B.read_shift(2),!0),Q=k(K[0].r,B.read_shift(2),!1),q.push(ue+Q);break;case 2:{var je=k(K[0].c,B.read_shift(2),!0),H=k(K[0].r,B.read_shift(2),!1);ue=k(K[0].c,B.read_shift(2),!0),Q=k(K[0].r,B.read_shift(2),!1),q.push(je+H+":"+ue+Q)}break;case 3:if(B.l<B.length){console.error("WK1 premature formula end");return}break;case 4:q.push("("+q.pop()+")");break;case 5:q.push(B.read_shift(2));break;case 6:{for(var tt="";me=B[B.l++];)tt+=String.fromCharCode(me);q.push('"'+tt.replace(/"/g,'""')+'"')}break;case 8:q.push("-"+q.pop());break;case 23:q.push("+"+q.pop());break;case 22:q.push("NOT("+q.pop()+")");break;case 20:case 21:_e=q.pop(),Ee=q.pop(),q.push(["AND","OR"][me-20]+"("+Ee+","+_e+")");break;default:if(me<32&&w[me])_e=q.pop(),Ee=q.pop(),q.push(Ee+w[me]+_e);else if(T[me]){if(W=T[me][1],W==69&&(W=B[B.l++]),W>q.length){console.error("WK1 bad formula parse 0x"+me.toString(16)+":|"+q.join("|")+"|");return}var He=q.slice(-W);q.length-=W,q.push(T[me][0]+"("+He.join(",")+")")}else return me<=7?console.error("WK1 invalid opcode "+me.toString(16)):me<=24?console.error("WK1 unsupported op "+me.toString(16)):me<=30?console.error("WK1 invalid opcode "+me.toString(16)):me<=115?console.error("WK1 unsupported function opcode "+me.toString(16)):console.error("WK1 unrecognized opcode "+me.toString(16))}}q.length==1?K[1].f=""+q[0]:console.error("WK1 bad formula parse |"+q.join("|")+"|")}function M(B){var K=[{c:0,r:0},{t:"n",v:0},0];return K[0].r=B.read_shift(2),K[3]=B[B.l++],K[0].c=B[B.l++],K}function O(B,K){var q=M(B);return q[1].t="s",q[1].v=B.read_shift(K-4,"cstr"),q}function v(B,K,q,W){var Q=nr(6+W.length);Q.write_shift(2,B),Q.write_shift(1,q),Q.write_shift(1,K),Q.write_shift(1,39);for(var ue=0;ue<W.length;++ue){var Ee=W.charCodeAt(ue);Q.write_shift(1,Ee>=128?95:Ee)}return Q.write_shift(1,0),Q}function E(B,K){var q=M(B);q[1].v=B.read_shift(2);var W=q[1].v>>1;if(q[1].v&1)switch(W&7){case 0:W=(W>>3)*5e3;break;case 1:W=(W>>3)*500;break;case 2:W=(W>>3)/20;break;case 3:W=(W>>3)/200;break;case 4:W=(W>>3)/2e3;break;case 5:W=(W>>3)/2e4;break;case 6:W=(W>>3)/16;break;case 7:W=(W>>3)/64;break}return q[1].v=W,q}function S(B,K){var q=M(B),W=B.read_shift(4),Q=B.read_shift(4),ue=B.read_shift(2);if(ue==65535)return W===0&&Q===3221225472?(q[1].t="e",q[1].v=15):W===0&&Q===3489660928?(q[1].t="e",q[1].v=42):q[1].v=0,q;var Ee=ue&32768;return ue=(ue&32767)-16446,q[1].v=(1-Ee*2)*(Q*Math.pow(2,ue+32)+W*Math.pow(2,ue)),q}function R(B,K,q,W){var Q=nr(14);if(Q.write_shift(2,B),Q.write_shift(1,q),Q.write_shift(1,K),W==0)return Q.write_shift(4,0),Q.write_shift(4,0),Q.write_shift(2,65535),Q;var ue=0,Ee=0,_e=0,me=0;return W<0&&(ue=1,W=-W),Ee=Math.log2(W)|0,W/=Math.pow(2,Ee-31),me=W>>>0,me&2147483648||(W/=2,++Ee,me=W>>>0),W-=me,me|=2147483648,me>>>=0,W*=Math.pow(2,32),_e=W>>>0,Q.write_shift(4,_e),Q.write_shift(4,me),Ee+=16383+(ue?32768:0),Q.write_shift(2,Ee),Q}function P(B,K){var q=S(B);return B.l+=K-14,q}function D(B,K){var q=M(B),W=B.read_shift(4);return q[1].v=W>>6,q}function N(B,K){var q=M(B),W=B.read_shift(8,"f");return q[1].v=W,q}function ce(B,K){var q=N(B);return B.l+=K-10,q}function oe(B,K){return B[B.l+K-1]==0?B.read_shift(K,"cstr"):""}function de(B,K){var q=B[B.l++];q>K-1&&(q=K-1);for(var W="";W.length<q;)W+=String.fromCharCode(B[B.l++]);return W}function ge(B,K,q){if(!(!q.qpro||K<21)){var W=B.read_shift(1);B.l+=17,B.l+=1,B.l+=2;var Q=B.read_shift(K-21,"cstr");return[W,Q]}}function Z(B,K){for(var q={},W=B.l+K;B.l<W;){var Q=B.read_shift(2);if(Q==14e3){for(q[Q]=[0,""],q[Q][0]=B.read_shift(2);B[B.l];)q[Q][1]+=String.fromCharCode(B[B.l]),B.l++;B.l++}}return q}function G(B,K){var q=nr(5+B.length);q.write_shift(2,14e3),q.write_shift(2,K);for(var W=0;W<B.length;++W){var Q=B.charCodeAt(W);q[q.l++]=Q>127?95:Q}return q[q.l++]=0,q}var ae={0:{n:"BOF",f:Jt},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:o},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:m},14:{n:"NUMBER",f:x},15:{n:"LABEL",f:u},16:{n:"FORMULA",f:_},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:u},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:oe},222:{n:"SHEETNAMELP",f:de},65535:{n:""}},fe={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:O},23:{n:"NUMBER17",f:S},24:{n:"NUMBER18",f:E},25:{n:"FORMULA19",f:P},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:Z},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:D},38:{n:"??"},39:{n:"NUMBER27",f:N},40:{n:"FORMULA28",f:ce},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:oe},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:ge},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:n,book_to_wk3:s,to_workbook:t}}();function S5(e){var t={},r=e.match(Kr),n=0,s=!1;if(r)for(;n!=r.length;++n){var a=Oe(r[n]);switch(a[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!a.val)break;case"<shadow>":case"<shadow/>":t.shadow=1;break;case"</shadow>":break;case"<charset":if(a.val=="1")break;t.cp=qx[parseInt(a.val,10)];break;case"<outline":if(!a.val)break;case"<outline>":case"<outline/>":t.outline=1;break;case"</outline>":break;case"<rFont":t.name=a.val;break;case"<sz":t.sz=a.val;break;case"<strike":if(!a.val)break;case"<strike>":case"<strike/>":t.strike=1;break;case"</strike>":break;case"<u":if(!a.val)break;switch(a.val){case"double":t.uval="double";break;case"singleAccounting":t.uval="single-accounting";break;case"doubleAccounting":t.uval="double-accounting";break}case"<u>":case"<u/>":t.u=1;break;case"</u>":break;case"<b":if(a.val=="0")break;case"<b>":case"<b/>":t.b=1;break;case"</b>":break;case"<i":if(a.val=="0")break;case"<i>":case"<i/>":t.i=1;break;case"</i>":break;case"<color":a.rgb&&(t.color=a.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":t.family=a.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":t.valign=a.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(a[0].charCodeAt(1)!==47&&!s)throw new Error("Unrecognized rich format "+a[0])}}return t}var A5=function(){var e=uu("t"),t=uu("rPr");function r(a){var i=a.match(e);if(!i)return{t:"s",v:""};var o={t:"s",v:lt(i[1])},l=a.match(t);return l&&(o.s=S5(l[1])),o}var n=/<(?:\w+:)?r>/g,s=/<\/(?:\w+:)?r>/;return function(i){return i.replace(n,"").split(s).map(r).filter(function(o){return o.v})}}(),I5=function(){var t=/(\r\n|\n)/g;function r(s,a,i){var o=[];s.u&&o.push("text-decoration: underline;"),s.uval&&o.push("text-underline-style:"+s.uval+";"),s.sz&&o.push("font-size:"+s.sz+"pt;"),s.outline&&o.push("text-effect: outline;"),s.shadow&&o.push("text-shadow: auto;"),a.push('<span style="'+o.join("")+'">'),s.b&&(a.push("<b>"),i.push("</b>")),s.i&&(a.push("<i>"),i.push("</i>")),s.strike&&(a.push("<s>"),i.push("</s>"));var l=s.valign||"";return l=="superscript"||l=="super"?l="sup":l=="subscript"&&(l="sub"),l!=""&&(a.push("<"+l+">"),i.push("</"+l+">")),i.push("</span>"),s}function n(s){var a=[[],s.v,[]];return s.v?(s.s&&r(s.s,a[0],a[2]),a[0].join("")+a[1].replace(t,"<br/>")+a[2].join("")):""}return function(a){return a.map(n).join("")}}(),C5=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,N5=/<(?:\w+:)?r>/,R5=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function fv(e,t){var r=t?t.cellHTML:!0,n={};return e?(e.match(/^\s*<(?:\w+:)?t[^>]*>/)?(n.t=lt(Tt(e.slice(e.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),n.r=Tt(e),r&&(n.h=tv(n.t))):e.match(N5)&&(n.r=Tt(e),n.t=lt(Tt((e.replace(R5,"").match(C5)||[]).join("").replace(Kr,""))),r&&(n.h=I5(A5(n.r)))),n):{t:""}}var b5=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,P5=/<(?:\w+:)?(?:si|sstItem)>/g,D5=/<\/(?:\w+:)?(?:si|sstItem)>/;function F5(e,t){var r=[],n="";if(!e)return r;var s=e.match(b5);if(s){n=s[2].replace(P5,"").split(D5);for(var a=0;a!=n.length;++a){var i=fv(n[a].trim(),t);i!=null&&(r[r.length]=i)}s=Oe(s[1]),r.Count=s.count,r.Unique=s.uniqueCount}return r}function O5(e){return[e.read_shift(4),e.read_shift(4)]}function M5(e,t){var r=[],n=!1;return ka(e,function(a,i,o){switch(o){case 159:r.Count=a[0],r.Unique=a[1];break;case 19:r.push(a);break;case 160:return!0;case 35:n=!0;break;case 36:n=!1;break;default:if(i.T,!n||t.WTF)throw new Error("Unexpected record 0x"+o.toString(16))}}),r}function iI(e){for(var t=[],r=e.split(""),n=0;n<r.length;++n)t[n]=r[n].charCodeAt(0);return t}function ca(e,t){var r={};return r.Major=e.read_shift(2),r.Minor=e.read_shift(2),t>=4&&(e.l+=t-4),r}function L5(e){var t={};return t.id=e.read_shift(0,"lpp4"),t.R=ca(e,4),t.U=ca(e,4),t.W=ca(e,4),t}function j5(e){for(var t=e.read_shift(4),r=e.l+t-4,n={},s=e.read_shift(4),a=[];s-- >0;)a.push({t:e.read_shift(4),v:e.read_shift(0,"lpp4")});if(n.name=e.read_shift(0,"lpp4"),n.comps=a,e.l!=r)throw new Error("Bad DataSpaceMapEntry: "+e.l+" != "+r);return n}function U5(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(j5(e));return t}function V5(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(e.read_shift(0,"lpp4"));return t}function B5(e){var t={};return e.read_shift(4),e.l+=4,t.id=e.read_shift(0,"lpp4"),t.name=e.read_shift(0,"lpp4"),t.R=ca(e,4),t.U=ca(e,4),t.W=ca(e,4),t}function z5(e){var t=B5(e);if(t.ename=e.read_shift(0,"8lpp4"),t.blksz=e.read_shift(4),t.cmode=e.read_shift(4),e.read_shift(4)!=4)throw new Error("Bad !Primary record");return t}function oI(e,t){var r=e.l+t,n={};n.Flags=e.read_shift(4)&63,e.l+=4,n.AlgID=e.read_shift(4);var s=!1;switch(n.AlgID){case 26126:case 26127:case 26128:s=n.Flags==36;break;case 26625:s=n.Flags==4;break;case 0:s=n.Flags==16||n.Flags==4||n.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+n.AlgID}if(!s)throw new Error("Encryption Flags/AlgID mismatch");return n.AlgIDHash=e.read_shift(4),n.KeySize=e.read_shift(4),n.ProviderType=e.read_shift(4),e.l+=8,n.CSPName=e.read_shift(r-e.l>>1,"utf16le"),e.l=r,n}function lI(e,t){var r={},n=e.l+t;return e.l+=4,r.Salt=e.slice(e.l,e.l+16),e.l+=16,r.Verifier=e.slice(e.l,e.l+16),e.l+=16,e.read_shift(4),r.VerifierHash=e.slice(e.l,n),e.l=n,r}function $5(e){var t=ca(e);switch(t.Minor){case 2:return[t.Minor,W5(e)];case 3:return[t.Minor,H5()];case 4:return[t.Minor,G5(e)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+t.Minor)}function W5(e){var t=e.read_shift(4);if((t&63)!=36)throw new Error("EncryptionInfo mismatch");var r=e.read_shift(4),n=oI(e,r),s=lI(e,e.length-e.l);return{t:"Std",h:n,v:s}}function H5(){throw new Error("File is password-protected: ECMA-376 Extensible")}function G5(e){var t=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];e.l+=4;var r=e.read_shift(e.length-e.l,"utf8"),n={};return r.replace(Kr,function(a){var i=Oe(a);switch(Vs(i[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":t.forEach(function(o){n[o]=i[o]});break;case"<dataIntegrity":n.encryptedHmacKey=i.encryptedHmacKey,n.encryptedHmacValue=i.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":n.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":n.uri=i.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":n.encs.push(i);break;default:throw i[0]}}),n}function K5(e,t){var r={},n=r.EncryptionVersionInfo=ca(e,4);if(t-=4,n.Minor!=2)throw new Error("unrecognized minor version code: "+n.Minor);if(n.Major>4||n.Major<2)throw new Error("unrecognized major version code: "+n.Major);r.Flags=e.read_shift(4),t-=4;var s=e.read_shift(4);return t-=4,r.EncryptionHeader=oI(e,s),t-=s,r.EncryptionVerifier=lI(e,t),r}function q5(e){var t={},r=t.EncryptionVersionInfo=ca(e,4);if(r.Major!=1||r.Minor!=1)throw"unrecognized version code "+r.Major+" : "+r.Minor;return t.Salt=e.read_shift(16),t.EncryptedVerifier=e.read_shift(16),t.EncryptedVerifierHash=e.read_shift(16),t}function X5(e){var t=0,r,n=iI(e),s=n.length+1,a,i,o,l,c;for(r=hi(s),r[0]=n.length,a=1;a!=s;++a)r[a]=n[a-1];for(a=s-1;a>=0;--a)i=r[a],o=t&16384?1:0,l=t<<1&32767,c=o|l,t=c^i;return t^52811}var cI=function(){var e=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],t=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],r=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],n=function(i){return(i/2|i*128)&255},s=function(i,o){return n(i^o)},a=function(i){for(var o=t[i.length-1],l=104,c=i.length-1;c>=0;--c)for(var u=i[c],d=0;d!=7;++d)u&64&&(o^=r[l]),u*=2,--l;return o};return function(i){for(var o=iI(i),l=a(o),c=o.length,u=hi(16),d=0;d!=16;++d)u[d]=0;var m,p,x;for((c&1)===1&&(m=l>>8,u[c]=s(e[0],m),--c,m=l&255,p=o[o.length-1],u[c]=s(p,m));c>0;)--c,m=l>>8,u[c]=s(o[c],m),--c,m=l&255,u[c]=s(o[c],m);for(c=15,x=15-o.length;x>0;)m=l>>8,u[c]=s(e[x],m),--c,--x,m=l&255,u[c]=s(o[c],m),--c,--x;return u}}(),Y5=function(e,t,r,n,s){s||(s=t),n||(n=cI(e));var a,i;for(a=0;a!=t.length;++a)i=t[a],i^=n[r],i=(i>>5|i<<3)&255,s[a]=i,++r;return[s,r,n]},Q5=function(e){var t=0,r=cI(e);return function(n){var s=Y5("",n,t,r);return t=s[1],s[0]}};function J5(e,t,r,n){var s={key:Jt(e),verificationBytes:Jt(e)};return r.password&&(s.verifier=X5(r.password)),n.valid=s.verificationBytes===s.verifier,n.valid&&(n.insitu=Q5(r.password)),s}function Z5(e,t,r){var n=r||{};return n.Info=e.read_shift(2),e.l-=2,n.Info===1?n.Data=q5(e):n.Data=K5(e,t),n}function e9(e,t,r){var n={Type:r.biff>=8?e.read_shift(2):0};return n.Type?Z5(e,t-2,n):J5(e,r.biff>=8?t:t-2,r,n),n}var t9=function(){function e(s,a){switch(a.type){case"base64":return t(An(s),a);case"binary":return t(s,a);case"buffer":return t(et&&Buffer.isBuffer(s)?s.toString("binary"):oo(s),a);case"array":return t(Ji(s),a)}throw new Error("Unrecognized type "+a.type)}function t(s,a){var i=a||{},o=i.dense?[]:{},l=s.match(/\\trowd.*?\\row\b/g);if(!l.length)throw new Error("RTF missing table");var c={s:{c:0,r:0},e:{c:0,r:l.length-1}};return l.forEach(function(u,d){Array.isArray(o)&&(o[d]=[]);for(var m=/\\\w+\b/g,p=0,x,g=-1;x=m.exec(u);){switch(x[0]){case"\\cell":var _=u.slice(p,m.lastIndex-x[0].length);if(_[0]==" "&&(_=_.slice(1)),++g,_.length){var k={v:_,t:"s"};Array.isArray(o)?o[d][g]=k:o[Be({r:d,c:g})]=k}break}p=m.lastIndex}g>c.e.c&&(c.e.c=g)}),o["!ref"]=at(c),o}function r(s,a){return yi(e(s,a),a)}function n(s){for(var a=["{\\rtf1\\ansi"],i=zt(s["!ref"]),o,l=Array.isArray(s),c=i.s.r;c<=i.e.r;++c){a.push("\\trowd\\trautofit1");for(var u=i.s.c;u<=i.e.c;++u)a.push("\\cellx"+(u+1));for(a.push("\\pard\\intbl"),u=i.s.c;u<=i.e.c;++u){var d=Be({r:c,c:u});o=l?(s[c]||[])[u]:s[d],!(!o||o.v==null&&(!o.f||o.F))&&(a.push(" "+(o.w||(wa(o),o.w))),a.push("\\cell"))}a.push("\\pard\\intbl\\row")}return a.join("")+"}"}return{to_workbook:r,to_sheet:e,from_sheet:n}}();function r9(e){var t=e.slice(e[0]==="#"?1:0).slice(0,6);return[parseInt(t.slice(0,2),16),parseInt(t.slice(2,4),16),parseInt(t.slice(4,6),16)]}function du(e){for(var t=0,r=1;t!=3;++t)r=r*256+(e[t]>255?255:e[t]<0?0:e[t]);return r.toString(16).toUpperCase().slice(1)}function n9(e){var t=e[0]/255,r=e[1]/255,n=e[2]/255,s=Math.max(t,r,n),a=Math.min(t,r,n),i=s-a;if(i===0)return[0,0,t];var o=0,l=0,c=s+a;switch(l=i/(c>1?2-c:c),s){case t:o=((r-n)/i+6)%6;break;case r:o=(n-t)/i+2;break;case n:o=(t-r)/i+4;break}return[o/6,l,c/2]}function s9(e){var t=e[0],r=e[1],n=e[2],s=r*2*(n<.5?n:1-n),a=n-s/2,i=[a,a,a],o=6*t,l;if(r!==0)switch(o|0){case 0:case 6:l=s*o,i[0]+=s,i[1]+=l;break;case 1:l=s*(2-o),i[0]+=l,i[1]+=s;break;case 2:l=s*(o-2),i[1]+=s,i[2]+=l;break;case 3:l=s*(4-o),i[1]+=l,i[2]+=s;break;case 4:l=s*(o-4),i[2]+=s,i[0]+=l;break;case 5:l=s*(6-o),i[2]+=l,i[0]+=s;break}for(var c=0;c!=3;++c)i[c]=Math.round(i[c]*255);return i}function ld(e,t){if(t===0)return e;var r=n9(r9(e));return t<0?r[2]=r[2]*(1+t):r[2]=1-(1-r[2])*(1-t),du(s9(r))}var uI=6,a9=15,i9=1,Yr=uI;function cd(e){return Math.floor((e+Math.round(128/Yr)/256)*Yr)}function ud(e){return Math.floor((e-5)/Yr*100+.5)/100}function Up(e){return Math.round((e*Yr+5)/Yr*256)/256}function nm(e){return Up(ud(cd(e)))}function hv(e){var t=Math.abs(e-nm(e)),r=Yr;if(t>.005)for(Yr=i9;Yr<a9;++Yr)Math.abs(e-nm(e))<=t&&(t=Math.abs(e-nm(e)),r=Yr);Yr=r}function xl(e){e.width?(e.wpx=cd(e.width),e.wch=ud(e.wpx),e.MDW=Yr):e.wpx?(e.wch=ud(e.wpx),e.width=Up(e.wch),e.MDW=Yr):typeof e.wch=="number"&&(e.width=Up(e.wch),e.wpx=cd(e.width),e.MDW=Yr),e.customWidth&&delete e.customWidth}var o9=96,fI=o9;function hI(e){return e*96/fI}function mu(e){return e*fI/96}var l9={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function c9(e,t,r,n){t.Borders=[];var s={},a=!1;(e[0].match(Kr)||[]).forEach(function(i){var o=Oe(i);switch(Vs(o[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":s={},o.diagonalUp&&(s.diagonalUp=bt(o.diagonalUp)),o.diagonalDown&&(s.diagonalDown=bt(o.diagonalDown)),t.Borders.push(s);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(n&&n.WTF&&!a)throw new Error("unrecognized "+o[0]+" in borders")}})}function u9(e,t,r,n){t.Fills=[];var s={},a=!1;(e[0].match(Kr)||[]).forEach(function(i){var o=Oe(i);switch(Vs(o[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":s={},t.Fills.push(s);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":t.Fills.push(s),s={};break;case"<patternFill":case"<patternFill>":o.patternType&&(s.patternType=o.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":s.bgColor||(s.bgColor={}),o.indexed&&(s.bgColor.indexed=parseInt(o.indexed,10)),o.theme&&(s.bgColor.theme=parseInt(o.theme,10)),o.tint&&(s.bgColor.tint=parseFloat(o.tint)),o.rgb&&(s.bgColor.rgb=o.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":s.fgColor||(s.fgColor={}),o.theme&&(s.fgColor.theme=parseInt(o.theme,10)),o.tint&&(s.fgColor.tint=parseFloat(o.tint)),o.rgb!=null&&(s.fgColor.rgb=o.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(n&&n.WTF&&!a)throw new Error("unrecognized "+o[0]+" in fills")}})}function f9(e,t,r,n){t.Fonts=[];var s={},a=!1;(e[0].match(Kr)||[]).forEach(function(i){var o=Oe(i);switch(Vs(o[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":t.Fonts.push(s),s={};break;case"<name":o.val&&(s.name=Tt(o.val));break;case"<name/>":case"</name>":break;case"<b":s.bold=o.val?bt(o.val):1;break;case"<b/>":s.bold=1;break;case"<i":s.italic=o.val?bt(o.val):1;break;case"<i/>":s.italic=1;break;case"<u":switch(o.val){case"none":s.underline=0;break;case"single":s.underline=1;break;case"double":s.underline=2;break;case"singleAccounting":s.underline=33;break;case"doubleAccounting":s.underline=34;break}break;case"<u/>":s.underline=1;break;case"<strike":s.strike=o.val?bt(o.val):1;break;case"<strike/>":s.strike=1;break;case"<outline":s.outline=o.val?bt(o.val):1;break;case"<outline/>":s.outline=1;break;case"<shadow":s.shadow=o.val?bt(o.val):1;break;case"<shadow/>":s.shadow=1;break;case"<condense":s.condense=o.val?bt(o.val):1;break;case"<condense/>":s.condense=1;break;case"<extend":s.extend=o.val?bt(o.val):1;break;case"<extend/>":s.extend=1;break;case"<sz":o.val&&(s.sz=+o.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":o.val&&(s.vertAlign=o.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":o.val&&(s.family=parseInt(o.val,10));break;case"<family/>":case"</family>":break;case"<scheme":o.val&&(s.scheme=o.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(o.val=="1")break;o.codepage=qx[parseInt(o.val,10)];break;case"<color":if(s.color||(s.color={}),o.auto&&(s.color.auto=bt(o.auto)),o.rgb)s.color.rgb=o.rgb.slice(-6);else if(o.indexed){s.color.index=parseInt(o.indexed,10);var l=Vi[s.color.index];s.color.index==81&&(l=Vi[1]),l||(l=Vi[1]),s.color.rgb=l[0].toString(16)+l[1].toString(16)+l[2].toString(16)}else o.theme&&(s.color.theme=parseInt(o.theme,10),o.tint&&(s.color.tint=parseFloat(o.tint)),o.theme&&r.themeElements&&r.themeElements.clrScheme&&(s.color.rgb=ld(r.themeElements.clrScheme[s.color.theme].rgb,s.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":a=!0;break;case"</AlternateContent>":a=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(n&&n.WTF&&!a)throw new Error("unrecognized "+o[0]+" in fonts")}})}function h9(e,t,r){t.NumberFmt=[];for(var n=Fs($e),s=0;s<n.length;++s)t.NumberFmt[n[s]]=$e[n[s]];var a=e[0].match(Kr);if(a)for(s=0;s<a.length;++s){var i=Oe(a[s]);switch(Vs(i[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var o=lt(Tt(i.formatCode)),l=parseInt(i.numFmtId,10);if(t.NumberFmt[l]=o,l>0){if(l>392){for(l=392;l>60&&t.NumberFmt[l]!=null;--l);t.NumberFmt[l]=o}Ui(o,l)}}break;case"</numFmt>":break;default:if(r.WTF)throw new Error("unrecognized "+i[0]+" in numFmts")}}}var Mf=["numFmtId","fillId","fontId","borderId","xfId"],Lf=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function d9(e,t,r){t.CellXf=[];var n,s=!1;(e[0].match(Kr)||[]).forEach(function(a){var i=Oe(a),o=0;switch(Vs(i[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(n=i,delete n[0],o=0;o<Mf.length;++o)n[Mf[o]]&&(n[Mf[o]]=parseInt(n[Mf[o]],10));for(o=0;o<Lf.length;++o)n[Lf[o]]&&(n[Lf[o]]=bt(n[Lf[o]]));if(t.NumberFmt&&n.numFmtId>392){for(o=392;o>60;--o)if(t.NumberFmt[n.numFmtId]==t.NumberFmt[o]){n.numFmtId=o;break}}t.CellXf.push(n);break;case"</xf>":break;case"<alignment":case"<alignment/>":var l={};i.vertical&&(l.vertical=i.vertical),i.horizontal&&(l.horizontal=i.horizontal),i.textRotation!=null&&(l.textRotation=i.textRotation),i.indent&&(l.indent=i.indent),i.wrapText&&(l.wrapText=bt(i.wrapText)),n.alignment=l;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":s=!0;break;case"</AlternateContent>":s=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(r&&r.WTF&&!s)throw new Error("unrecognized "+i[0]+" in cellXfs")}})}var m9=function(){var t=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,r=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,n=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,s=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,a=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(o,l,c){var u={};if(!o)return u;o=o.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var d;return(d=o.match(t))&&h9(d,u,c),(d=o.match(s))&&f9(d,u,l,c),(d=o.match(n))&&u9(d,u,l,c),(d=o.match(a))&&c9(d,u,l,c),(d=o.match(r))&&d9(d,u,c),u}}();function p9(e,t){var r=e.read_shift(2),n=$r(e);return[r,n]}function g9(e,t,r){var n={};n.sz=e.read_shift(2)/20;var s=Aj(e);s.fItalic&&(n.italic=1),s.fCondense&&(n.condense=1),s.fExtend&&(n.extend=1),s.fShadow&&(n.shadow=1),s.fOutline&&(n.outline=1),s.fStrikeout&&(n.strike=1);var a=e.read_shift(2);switch(a===700&&(n.bold=1),e.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var i=e.read_shift(1);i!=0&&(n.underline=i);var o=e.read_shift(1);o>0&&(n.family=o);var l=e.read_shift(1);switch(l>0&&(n.charset=l),e.l++,n.color=Sj(e),e.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=$r(e),n}var x9=Gr;function v9(e,t){var r=e.l+t,n=e.read_shift(2),s=e.read_shift(2);return e.l=r,{ixfe:n,numFmtId:s}}var y9=Gr;function _9(e,t,r){var n={};n.NumberFmt=[];for(var s in $e)n.NumberFmt[s]=$e[s];n.CellXf=[],n.Fonts=[];var a=[],i=!1;return ka(e,function(l,c,u){switch(u){case 44:n.NumberFmt[l[0]]=l[1],Ui(l[1],l[0]);break;case 43:n.Fonts.push(l),l.color.theme!=null&&t&&t.themeElements&&t.themeElements.clrScheme&&(l.color.rgb=ld(t.themeElements.clrScheme[l.color.theme].rgb,l.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:a[a.length-1]==617&&n.CellXf.push(l);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:i=!0;break;case 36:i=!1;break;case 37:a.push(u),i=!0;break;case 38:a.pop(),i=!1;break;default:if(c.T>0)a.push(u);else if(c.T<0)a.pop();else if(!i||r.WTF&&a[a.length-1]!=37)throw new Error("Unexpected record 0x"+u.toString(16))}}),n}var w9=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function E9(e,t,r){t.themeElements.clrScheme=[];var n={};(e[0].match(Kr)||[]).forEach(function(s){var a=Oe(s);switch(a[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":n.rgb=a.val;break;case"<a:sysClr":n.rgb=a.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":a[0].charAt(1)==="/"?(t.themeElements.clrScheme[w9.indexOf(a[0])]=n,n={}):n.name=a[0].slice(3,a[0].length-1);break;default:if(r&&r.WTF)throw new Error("Unrecognized "+a[0]+" in clrScheme")}})}function T9(){}function k9(){}var S9=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,A9=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,I9=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function C9(e,t,r){t.themeElements={};var n;[["clrScheme",S9,E9],["fontScheme",A9,T9],["fmtScheme",I9,k9]].forEach(function(s){if(!(n=e.match(s[1])))throw new Error(s[0]+" not found in themeElements");s[2](n,t,r)})}var N9=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function dI(e,t){(!e||e.length===0)&&(e=R9());var r,n={};if(!(r=e.match(N9)))throw new Error("themeElements not found in theme");return C9(r[0],n,t),n.raw=e,n}function R9(e,t){var r=[kA];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function b9(e,t,r){var n=e.l+t,s=e.read_shift(4);if(s!==124226){if(!r.cellStyles){e.l=n;return}var a=e.slice(e.l);e.l=n;var i;try{i=TA(a,{type:"array"})}catch{return}var o=wn(i,"theme/theme/theme1.xml",!0);if(o)return dI(o,r)}}function P9(e){return e.read_shift(4)}function D9(e){var t={};switch(t.xclrType=e.read_shift(2),t.nTintShade=e.read_shift(2),t.xclrType){case 0:e.l+=4;break;case 1:t.xclrValue=F9(e,4);break;case 2:t.xclrValue=ZA(e);break;case 3:t.xclrValue=P9(e);break;case 4:e.l+=4;break}return e.l+=8,t}function F9(e,t){return Gr(e,t)}function O9(e,t){return Gr(e,t)}function M9(e){var t=e.read_shift(2),r=e.read_shift(2)-4,n=[t];switch(t){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:n[1]=D9(e);break;case 6:n[1]=O9(e,r);break;case 14:case 15:n[1]=e.read_shift(r===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+t+" "+r)}return n}function L9(e,t){var r=e.l+t;e.l+=2;var n=e.read_shift(2);e.l+=2;for(var s=e.read_shift(2),a=[];s-- >0;)a.push(M9(e,r-e.l));return{ixfe:n,ext:a}}function j9(e,t){t.forEach(function(r){switch(r[0]){}})}function U9(e,t){return{flags:e.read_shift(4),version:e.read_shift(4),name:$r(e)}}function V9(e){for(var t=[],r=e.read_shift(4);r-- >0;)t.push([e.read_shift(4),e.read_shift(4)]);return t}function B9(e){return e.l+=4,e.read_shift(4)!=0}function z9(e,t,r){var n={Types:[],Cell:[],Value:[]},s=r||{},a=[],i=!1,o=2;return ka(e,function(l,c,u){switch(u){case 335:n.Types.push({name:l.name});break;case 51:l.forEach(function(d){o==1?n.Cell.push({type:n.Types[d[0]-1].name,index:d[1]}):o==0&&n.Value.push({type:n.Types[d[0]-1].name,index:d[1]})});break;case 337:o=l?1:0;break;case 338:o=2;break;case 35:a.push(u),i=!0;break;case 36:a.pop(),i=!1;break;default:if(!c.T){if(!i||s.WTF&&a[a.length-1]!=35)throw new Error("Unexpected record 0x"+u.toString(16))}}}),n}function $9(e,t,r){var n={Types:[],Cell:[],Value:[]};if(!e)return n;var s=!1,a=2,i;return e.replace(Kr,function(o){var l=Oe(o);switch(Vs(l[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":n.Types.push({name:l.name});break;case"</metadataType>":break;case"<futureMetadata":for(var c=0;c<n.Types.length;++c)n.Types[c].name==l.name&&(i=n.Types[c]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":a==1?n.Cell.push({type:n.Types[l.t-1].name,index:+l.v}):a==0&&n.Value.push({type:n.Types[l.t-1].name,index:+l.v});break;case"</rc>":break;case"<cellMetadata":a=1;break;case"</cellMetadata>":a=2;break;case"<valueMetadata":a=0;break;case"</valueMetadata>":a=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;case"<rvb":if(!i)break;i.offsets||(i.offsets=[]),i.offsets.push(+l.i);break;default:if(!s&&r.WTF)throw new Error("unrecognized "+l[0]+" in metadata")}return o}),n}function W9(e){var t=[];if(!e)return t;var r=1;return(e.match(Kr)||[]).forEach(function(n){var s=Oe(n);switch(s[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete s[0],s.i?r=s.i:s.i=r,t.push(s);break}}),t}function H9(e){var t={};t.i=e.read_shift(4);var r={};r.r=e.read_shift(4),r.c=e.read_shift(4),t.r=Be(r);var n=e.read_shift(1);return n&2&&(t.l="1"),n&8&&(t.a="1"),t}function G9(e,t,r){var n=[];return ka(e,function(a,i,o){switch(o){case 63:n.push(a);break;default:if(!i.T)throw new Error("Unexpected record 0x"+o.toString(16))}}),n}function K9(e,t,r,n){if(!e)return e;var s=n||{},a=!1;ka(e,function(o,l,c){switch(c){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:a=!0;break;case 36:a=!1;break;default:if(!l.T){if(!a||s.WTF)throw new Error("Unexpected record 0x"+c.toString(16))}}},s)}function q9(e,t){if(!e)return"??";var r=(e.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return t["!id"][r].Target}function Ow(e,t,r,n){var s=Array.isArray(e),a;t.forEach(function(i){var o=Qr(i.ref);if(s?(e[o.r]||(e[o.r]=[]),a=e[o.r][o.c]):a=e[i.ref],!a){a={t:"z"},s?e[o.r][o.c]=a:e[i.ref]=a;var l=zt(e["!ref"]||"BDWGO1000001:A1");l.s.r>o.r&&(l.s.r=o.r),l.e.r<o.r&&(l.e.r=o.r),l.s.c>o.c&&(l.s.c=o.c),l.e.c<o.c&&(l.e.c=o.c);var c=at(l);c!==e["!ref"]&&(e["!ref"]=c)}a.c||(a.c=[]);var u={a:i.author,t:i.t,r:i.r,T:r};i.h&&(u.h=i.h);for(var d=a.c.length-1;d>=0;--d){if(!r&&a.c[d].T)return;r&&!a.c[d].T&&a.c.splice(d,1)}if(r&&n){for(d=0;d<n.length;++d)if(u.a==n[d].id){u.a=n[d].name||u.a;break}}a.c.push(u)})}function X9(e,t){if(e.match(/<(?:\w+:)?comments *\/>/))return[];var r=[],n=[],s=e.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);s&&s[1]&&s[1].split(/<\/\w*:?author>/).forEach(function(i){if(!(i===""||i.trim()==="")){var o=i.match(/<(?:\w+:)?author[^>]*>(.*)/);o&&r.push(o[1])}});var a=e.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return a&&a[1]&&a[1].split(/<\/\w*:?comment>/).forEach(function(i){if(!(i===""||i.trim()==="")){var o=i.match(/<(?:\w+:)?comment[^>]*>/);if(o){var l=Oe(o[0]),c={author:l.authorId&&r[l.authorId]||"sheetjsghost",ref:l.ref,guid:l.guid},u=Qr(l.ref);if(!(t.sheetRows&&t.sheetRows<=u.r)){var d=i.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),m=!!d&&!!d[1]&&fv(d[1])||{r:"",t:"",h:""};c.r=m.r,m.r=="<t></t>"&&(m.t=m.h=""),c.t=(m.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),t.cellHTML&&(c.h=m.h),n.push(c)}}}}),n}function Y9(e,t){var r=[],n=!1,s={},a=0;return e.replace(Kr,function(o,l){var c=Oe(o);switch(Vs(c[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":s={author:c.personId,guid:c.id,ref:c.ref,T:1};break;case"</threadedComment>":s.t!=null&&r.push(s);break;case"<text>":case"<text":a=l+o.length;break;case"</text>":s.t=e.slice(a,l).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":n=!0;break;case"</mentions>":n=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&t.WTF)throw new Error("unrecognized "+c[0]+" in threaded comments")}return o}),r}function Q9(e,t){var r=[],n=!1;return e.replace(Kr,function(a){var i=Oe(a);switch(Vs(i[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":r.push({name:i.displayname,id:i.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&t.WTF)throw new Error("unrecognized "+i[0]+" in threaded comments")}return a}),r}function J9(e){var t={};t.iauthor=e.read_shift(4);var r=co(e);return t.rfx=r.s,t.ref=Be(r.s),e.l+=16,t}var Z9=$r;function eU(e,t){var r=[],n=[],s={},a=!1;return ka(e,function(o,l,c){switch(c){case 632:n.push(o);break;case 635:s=o;break;case 637:s.t=o.t,s.h=o.h,s.r=o.r;break;case 636:if(s.author=n[s.iauthor],delete s.iauthor,t.sheetRows&&s.rfx&&t.sheetRows<=s.rfx.r)break;s.t||(s.t=""),delete s.rfx,r.push(s);break;case 3072:break;case 35:a=!0;break;case 36:a=!1;break;case 37:break;case 38:break;default:if(!l.T){if(!a||t.WTF)throw new Error("Unexpected record 0x"+c.toString(16))}}}),r}var tU="application/vnd.ms-office.vbaProject";function rU(e){var t=st.utils.cfb_new({root:"R"});return e.FullPaths.forEach(function(r,n){if(!(r.slice(-1)==="/"||!r.match(/_VBA_PROJECT_CUR/))){var s=r.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");st.utils.cfb_add(t,s,e.FileIndex[n].content)}}),st.write(t)}function nU(){return{"!type":"dialog"}}function sU(){return{"!type":"dialog"}}function aU(){return{"!type":"macro"}}function iU(){return{"!type":"macro"}}var Qo=function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,t={r:0,c:0};function r(n,s,a,i){var o=!1,l=!1;a.length==0?l=!0:a.charAt(0)=="["&&(l=!0,a=a.slice(1,-1)),i.length==0?o=!0:i.charAt(0)=="["&&(o=!0,i=i.slice(1,-1));var c=a.length>0?parseInt(a,10)|0:0,u=i.length>0?parseInt(i,10)|0:0;return o?u+=t.c:--u,l?c+=t.r:--c,s+(o?"":"$")+ir(u)+(l?"":"$")+Ar(c)}return function(s,a){return t=a,s.replace(e,r)}}(),mI=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,oU=function(){return function(t,r){return t.replace(mI,function(n,s,a,i,o,l){var c=av(i)-(a?0:r.c),u=sv(l)-(o?0:r.r),d=u==0?"":o?u+1:"["+u+"]",m=c==0?"":a?c+1:"["+c+"]";return s+"R"+d+"C"+m})}}();function pI(e,t){return e.replace(mI,function(r,n,s,a,i,o){return n+(s=="$"?s+a:ir(av(a)+t.c))+(i=="$"?i+o:Ar(sv(o)+t.r))})}function lU(e,t,r){var n=Il(t),s=n.s,a=Qr(r),i={r:a.r-s.r,c:a.c-s.c};return pI(e,i)}function cU(e){return e.length!=1}function Mw(e){return e.replace(/_xlfn\./g,"")}function Xt(e){e.l+=1}function di(e,t){var r=e.read_shift(2);return[r&16383,r>>14&1,r>>15&1]}function gI(e,t,r){var n=2;if(r){if(r.biff>=2&&r.biff<=5)return xI(e);r.biff==12&&(n=4)}var s=e.read_shift(n),a=e.read_shift(n),i=di(e),o=di(e);return{s:{r:s,c:i[0],cRel:i[1],rRel:i[2]},e:{r:a,c:o[0],cRel:o[1],rRel:o[2]}}}function xI(e){var t=di(e),r=di(e),n=e.read_shift(1),s=e.read_shift(1);return{s:{r:t[0],c:n,cRel:t[1],rRel:t[2]},e:{r:r[0],c:s,cRel:r[1],rRel:r[2]}}}function uU(e,t,r){if(r.biff<8)return xI(e);var n=e.read_shift(r.biff==12?4:2),s=e.read_shift(r.biff==12?4:2),a=di(e),i=di(e);return{s:{r:n,c:a[0],cRel:a[1],rRel:a[2]},e:{r:s,c:i[0],cRel:i[1],rRel:i[2]}}}function vI(e,t,r){if(r&&r.biff>=2&&r.biff<=5)return fU(e);var n=e.read_shift(r&&r.biff==12?4:2),s=di(e);return{r:n,c:s[0],cRel:s[1],rRel:s[2]}}function fU(e){var t=di(e),r=e.read_shift(1);return{r:t[0],c:r,cRel:t[1],rRel:t[2]}}function hU(e){var t=e.read_shift(2),r=e.read_shift(2);return{r:t,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function dU(e,t,r){var n=r&&r.biff?r.biff:8;if(n>=2&&n<=5)return mU(e);var s=e.read_shift(n>=12?4:2),a=e.read_shift(2),i=(a&16384)>>14,o=(a&32768)>>15;if(a&=16383,o==1)for(;s>524287;)s-=1048576;if(i==1)for(;a>8191;)a=a-16384;return{r:s,c:a,cRel:i,rRel:o}}function mU(e){var t=e.read_shift(2),r=e.read_shift(1),n=(t&32768)>>15,s=(t&16384)>>14;return t&=16383,n==1&&t>=8192&&(t=t-16384),s==1&&r>=128&&(r=r-256),{r:t,c:r,cRel:s,rRel:n}}function pU(e,t,r){var n=(e[e.l++]&96)>>5,s=gI(e,r.biff>=2&&r.biff<=5?6:8,r);return[n,s]}function gU(e,t,r){var n=(e[e.l++]&96)>>5,s=e.read_shift(2,"i"),a=8;if(r)switch(r.biff){case 5:e.l+=12,a=6;break;case 12:a=12;break}var i=gI(e,a,r);return[n,s,i]}function xU(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r&&r.biff>8?12:r.biff<8?6:8,[n]}function vU(e,t,r){var n=(e[e.l++]&96)>>5,s=e.read_shift(2),a=8;if(r)switch(r.biff){case 5:e.l+=12,a=6;break;case 12:a=12;break}return e.l+=a,[n,s]}function yU(e,t,r){var n=(e[e.l++]&96)>>5,s=uU(e,t-1,r);return[n,s]}function _U(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r.biff==2?6:r.biff==12?14:7,[n]}function Lw(e){var t=e[e.l+1]&1,r=1;return e.l+=4,[t,r]}function wU(e,t,r){e.l+=2;for(var n=e.read_shift(r&&r.biff==2?1:2),s=[],a=0;a<=n;++a)s.push(e.read_shift(r&&r.biff==2?1:2));return s}function EU(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function TU(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function kU(e){var t=e[e.l+1]&255?1:0;return e.l+=2,[t,e.read_shift(2)]}function SU(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=r&&r.biff==2?3:4,[n]}function yI(e){var t=e.read_shift(1),r=e.read_shift(1);return[t,r]}function AU(e){return e.read_shift(2),yI(e)}function IU(e){return e.read_shift(2),yI(e)}function CU(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var s=vI(e,0,r);return[n,s]}function NU(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var s=dU(e,0,r);return[n,s]}function RU(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var s=e.read_shift(2);r&&r.biff==5&&(e.l+=12);var a=vI(e,0,r);return[n,s,a]}function bU(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var s=e.read_shift(r&&r.biff<=3?1:2);return[PV[s],EI[s],n]}function PU(e,t,r){var n=e[e.l++],s=e.read_shift(1),a=r&&r.biff<=3?[n==88?-1:0,e.read_shift(1)]:DU(e);return[s,(a[0]===0?EI:bV)[a[1]]]}function DU(e){return[e[e.l+1]>>7,e.read_shift(2)&32767]}function FU(e,t,r){e.l+=r&&r.biff==2?3:4}function OU(e,t,r){if(e.l++,r&&r.biff==12)return[e.read_shift(4,"i"),0];var n=e.read_shift(2),s=e.read_shift(r&&r.biff==2?1:2);return[n,s]}function MU(e){return e.l++,uo[e.read_shift(1)]}function LU(e){return e.l++,e.read_shift(2)}function jU(e){return e.l++,e.read_shift(1)!==0}function UU(e){return e.l++,Vr(e)}function VU(e,t,r){return e.l++,zu(e,t-1,r)}function BU(e,t){var r=[e.read_shift(1)];if(t==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=$t(e,1)?"TRUE":"FALSE",t!=12&&(e.l+=7);break;case 37:case 16:r[1]=uo[e[e.l]],e.l+=t==12?4:8;break;case 0:e.l+=8;break;case 1:r[1]=Vr(e);break;case 2:r[1]=fo(e,0,{biff:t>0&&t<8?2:t});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function zU(e,t,r){for(var n=e.read_shift(r.biff==12?4:2),s=[],a=0;a!=n;++a)s.push((r.biff==12?co:s0)(e));return s}function $U(e,t,r){var n=0,s=0;r.biff==12?(n=e.read_shift(4),s=e.read_shift(4)):(s=1+e.read_shift(1),n=1+e.read_shift(2)),r.biff>=2&&r.biff<8&&(--n,--s==0&&(s=256));for(var a=0,i=[];a!=n&&(i[a]=[]);++a)for(var o=0;o!=s;++o)i[a][o]=BU(e,r.biff);return i}function WU(e,t,r){var n=e.read_shift(1)>>>5&3,s=!r||r.biff>=8?4:2,a=e.read_shift(s);switch(r.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[n,0,a]}function HU(e,t,r){if(r.biff==5)return GU(e);var n=e.read_shift(1)>>>5&3,s=e.read_shift(2),a=e.read_shift(4);return[n,s,a]}function GU(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2,"i");e.l+=8;var n=e.read_shift(2);return e.l+=12,[t,r,n]}function KU(e,t,r){var n=e.read_shift(1)>>>5&3;e.l+=r&&r.biff==2?3:4;var s=e.read_shift(r&&r.biff==2?1:2);return[n,s]}function qU(e,t,r){var n=e.read_shift(1)>>>5&3,s=e.read_shift(r&&r.biff==2?1:2);return[n,s]}function XU(e,t,r){var n=e.read_shift(1)>>>5&3;return e.l+=4,r.biff<8&&e.l--,r.biff==12&&(e.l+=2),[n]}function YU(e,t,r){var n=(e[e.l++]&96)>>5,s=e.read_shift(2),a=4;if(r)switch(r.biff){case 5:a=15;break;case 12:a=6;break}return e.l+=a,[n,s]}var QU=Gr,JU=Gr,ZU=Gr;function Wu(e,t,r){return e.l+=2,[hU(e)]}function dv(e){return e.l+=6,[]}var eV=Wu,tV=dv,rV=dv,nV=Wu;function _I(e){return e.l+=2,[Jt(e),e.read_shift(2)&1]}var sV=Wu,aV=_I,iV=dv,oV=Wu,lV=Wu,cV=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function uV(e){e.l+=2;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),s=e.read_shift(2),a=e.read_shift(2),i=cV[r>>2&31];return{ixti:t,coltype:r&3,rt:i,idx:n,c:s,C:a}}function fV(e){return e.l+=2,[e.read_shift(4)]}function hV(e,t,r){return e.l+=5,e.l+=2,e.l+=r.biff==2?1:4,["PTGSHEET"]}function dV(e,t,r){return e.l+=r.biff==2?4:5,["PTGENDSHEET"]}function mV(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function pV(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function gV(e){return e.l+=4,[0,0]}var jw={1:{n:"PtgExp",f:OU},2:{n:"PtgTbl",f:ZU},3:{n:"PtgAdd",f:Xt},4:{n:"PtgSub",f:Xt},5:{n:"PtgMul",f:Xt},6:{n:"PtgDiv",f:Xt},7:{n:"PtgPower",f:Xt},8:{n:"PtgConcat",f:Xt},9:{n:"PtgLt",f:Xt},10:{n:"PtgLe",f:Xt},11:{n:"PtgEq",f:Xt},12:{n:"PtgGe",f:Xt},13:{n:"PtgGt",f:Xt},14:{n:"PtgNe",f:Xt},15:{n:"PtgIsect",f:Xt},16:{n:"PtgUnion",f:Xt},17:{n:"PtgRange",f:Xt},18:{n:"PtgUplus",f:Xt},19:{n:"PtgUminus",f:Xt},20:{n:"PtgPercent",f:Xt},21:{n:"PtgParen",f:Xt},22:{n:"PtgMissArg",f:Xt},23:{n:"PtgStr",f:VU},26:{n:"PtgSheet",f:hV},27:{n:"PtgEndSheet",f:dV},28:{n:"PtgErr",f:MU},29:{n:"PtgBool",f:jU},30:{n:"PtgInt",f:LU},31:{n:"PtgNum",f:UU},32:{n:"PtgArray",f:_U},33:{n:"PtgFunc",f:bU},34:{n:"PtgFuncVar",f:PU},35:{n:"PtgName",f:WU},36:{n:"PtgRef",f:CU},37:{n:"PtgArea",f:pU},38:{n:"PtgMemArea",f:KU},39:{n:"PtgMemErr",f:QU},40:{n:"PtgMemNoMem",f:JU},41:{n:"PtgMemFunc",f:qU},42:{n:"PtgRefErr",f:XU},43:{n:"PtgAreaErr",f:xU},44:{n:"PtgRefN",f:NU},45:{n:"PtgAreaN",f:yU},46:{n:"PtgMemAreaN",f:mV},47:{n:"PtgMemNoMemN",f:pV},57:{n:"PtgNameX",f:HU},58:{n:"PtgRef3d",f:RU},59:{n:"PtgArea3d",f:gU},60:{n:"PtgRefErr3d",f:YU},61:{n:"PtgAreaErr3d",f:vU},255:{}},xV={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},vV={1:{n:"PtgElfLel",f:_I},2:{n:"PtgElfRw",f:oV},3:{n:"PtgElfCol",f:eV},6:{n:"PtgElfRwV",f:lV},7:{n:"PtgElfColV",f:nV},10:{n:"PtgElfRadical",f:sV},11:{n:"PtgElfRadicalS",f:iV},13:{n:"PtgElfColS",f:tV},15:{n:"PtgElfColSV",f:rV},16:{n:"PtgElfRadicalLel",f:aV},25:{n:"PtgList",f:uV},29:{n:"PtgSxName",f:fV},255:{}},yV={0:{n:"PtgAttrNoop",f:gV},1:{n:"PtgAttrSemi",f:SU},2:{n:"PtgAttrIf",f:TU},4:{n:"PtgAttrChoose",f:wU},8:{n:"PtgAttrGoto",f:EU},16:{n:"PtgAttrSum",f:FU},32:{n:"PtgAttrBaxcel",f:Lw},33:{n:"PtgAttrBaxcel",f:Lw},64:{n:"PtgAttrSpace",f:AU},65:{n:"PtgAttrSpaceSemi",f:IU},128:{n:"PtgAttrIfError",f:kU},255:{}};function Hu(e,t,r,n){if(n.biff<8)return Gr(e,t);for(var s=e.l+t,a=[],i=0;i!==r.length;++i)switch(r[i][0]){case"PtgArray":r[i][1]=$U(e,0,n),a.push(r[i][1]);break;case"PtgMemArea":r[i][2]=zU(e,r[i][1],n),a.push(r[i][2]);break;case"PtgExp":n&&n.biff==12&&(r[i][1][1]=e.read_shift(4),a.push(r[i][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[i][0]}return t=s-e.l,t!==0&&a.push(Gr(e,t)),a}function Gu(e,t,r){for(var n=e.l+t,s,a,i=[];n!=e.l;)t=n-e.l,a=e[e.l],s=jw[a]||jw[xV[a]],(a===24||a===25)&&(s=(a===24?vV:yV)[e[e.l+1]]),!s||!s.f?Gr(e,t):i.push([s.n,s.f(e,t,r)]);return i}function _V(e){for(var t=[],r=0;r<e.length;++r){for(var n=e[r],s=[],a=0;a<n.length;++a){var i=n[a];if(i)switch(i[0]){case 2:s.push('"'+i[1].replace(/"/g,'""')+'"');break;default:s.push(i[1])}else s.push("")}t.push(s.join(","))}return t.join(";")}var wV={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function EV(e,t){if(!e&&!(t&&t.biff<=5&&t.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}function wI(e,t,r){if(!e)return"SH33TJSERR0";if(r.biff>8&&(!e.XTI||!e.XTI[t]))return e.SheetNames[t];if(!e.XTI)return"SH33TJSERR6";var n=e.XTI[t];if(r.biff<8)return t>1e4&&(t-=65536),t<0&&(t=-t),t==0?"":e.XTI[t-1];if(!n)return"SH33TJSERR1";var s="";if(r.biff>8)switch(e[n[0]][0]){case 357:return s=n[1]==-1?"#REF":e.SheetNames[n[1]],n[1]==n[2]?s:s+":"+e.SheetNames[n[2]];case 358:return r.SID!=null?e.SheetNames[r.SID]:"SH33TJSSAME"+e[n[0]][0];case 355:default:return"SH33TJSSRC"+e[n[0]][0]}switch(e[n[0]][0][0]){case 1025:return s=n[1]==-1?"#REF":e.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?s:s+":"+e.SheetNames[n[2]];case 14849:return e[n[0]].slice(1).map(function(a){return a.Name}).join(";;");default:return e[n[0]][0][3]?(s=n[1]==-1?"#REF":e[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?s:s+":"+e[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function Uw(e,t,r){var n=wI(e,t,r);return n=="#REF"?n:EV(n,r)}function Lr(e,t,r,n,s){var a=s&&s.biff||8,i={s:{c:0,r:0}},o=[],l,c,u,d=0,m=0,p,x="";if(!e[0]||!e[0][0])return"";for(var g=-1,_="",k=0,T=e[0].length;k<T;++k){var w=e[0][k];switch(w[0]){case"PtgUminus":o.push("-"+o.pop());break;case"PtgUplus":o.push("+"+o.pop());break;case"PtgPercent":o.push(o.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(l=o.pop(),c=o.pop(),g>=0){switch(e[0][g][1][0]){case 0:_=Vt(" ",e[0][g][1][1]);break;case 1:_=Vt("\r",e[0][g][1][1]);break;default:if(_="",s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][g][1][0])}c=c+_,g=-1}o.push(c+wV[w[0]]+l);break;case"PtgIsect":l=o.pop(),c=o.pop(),o.push(c+" "+l);break;case"PtgUnion":l=o.pop(),c=o.pop(),o.push(c+","+l);break;case"PtgRange":l=o.pop(),c=o.pop(),o.push(c+":"+l);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":u=Sc(w[1][1],i,s),o.push(Ac(u,a));break;case"PtgRefN":u=r?Sc(w[1][1],r,s):w[1][1],o.push(Ac(u,a));break;case"PtgRef3d":d=w[1][1],u=Sc(w[1][2],i,s),x=Uw(n,d,s),o.push(x+"!"+Ac(u,a));break;case"PtgFunc":case"PtgFuncVar":var C=w[1][0],M=w[1][1];C||(C=0),C&=127;var O=C==0?[]:o.slice(-C);o.length-=C,M==="User"&&(M=O.shift()),o.push(M+"("+O.join(",")+")");break;case"PtgBool":o.push(w[1]?"TRUE":"FALSE");break;case"PtgInt":o.push(w[1]);break;case"PtgNum":o.push(String(w[1]));break;case"PtgStr":o.push('"'+w[1].replace(/"/g,'""')+'"');break;case"PtgErr":o.push(w[1]);break;case"PtgAreaN":p=yw(w[1][1],r?{s:r}:i,s),o.push(tm(p,s));break;case"PtgArea":p=yw(w[1][1],i,s),o.push(tm(p,s));break;case"PtgArea3d":d=w[1][1],p=w[1][2],x=Uw(n,d,s),o.push(x+"!"+tm(p,s));break;case"PtgAttrSum":o.push("SUM("+o.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":m=w[1][2];var v=(n.names||[])[m-1]||(n[0]||[])[m],E=v?v.Name:"SH33TJSNAME"+String(m);E&&E.slice(0,6)=="_xlfn."&&!s.xlfn&&(E=E.slice(6)),o.push(E);break;case"PtgNameX":var S=w[1][1];m=w[1][2];var R;if(s.biff<=5)S<0&&(S=-S),n[S]&&(R=n[S][m]);else{var P="";if(((n[S]||[])[0]||[])[0]==14849||(((n[S]||[])[0]||[])[0]==1025?n[S][m]&&n[S][m].itab>0&&(P=n.SheetNames[n[S][m].itab-1]+"!"):P=n.SheetNames[m-1]+"!"),n[S]&&n[S][m])P+=n[S][m].Name;else if(n[0]&&n[0][m])P+=n[0][m].Name;else{var D=(wI(n,S,s)||"").split(";;");D[m-1]?P=D[m-1]:P+="SH33TJSERRX"}o.push(P);break}R||(R={Name:"SH33TJSERRY"}),o.push(R.Name);break;case"PtgParen":var N="(",ce=")";if(g>=0){switch(_="",e[0][g][1][0]){case 2:N=Vt(" ",e[0][g][1][1])+N;break;case 3:N=Vt("\r",e[0][g][1][1])+N;break;case 4:ce=Vt(" ",e[0][g][1][1])+ce;break;case 5:ce=Vt("\r",e[0][g][1][1])+ce;break;default:if(s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][g][1][0])}g=-1}o.push(N+o.pop()+ce);break;case"PtgRefErr":o.push("#REF!");break;case"PtgRefErr3d":o.push("#REF!");break;case"PtgExp":u={c:w[1][1],r:w[1][0]};var oe={c:r.c,r:r.r};if(n.sharedf[Be(u)]){var de=n.sharedf[Be(u)];o.push(Lr(de,i,oe,n,s))}else{var ge=!1;for(l=0;l!=n.arrayf.length;++l)if(c=n.arrayf[l],!(u.c<c[0].s.c||u.c>c[0].e.c)&&!(u.r<c[0].s.r||u.r>c[0].e.r)){o.push(Lr(c[1],i,oe,n,s)),ge=!0;break}ge||o.push(w[1])}break;case"PtgArray":o.push("{"+_V(w[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":g=k;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":o.push("");break;case"PtgAreaErr":o.push("#REF!");break;case"PtgAreaErr3d":o.push("#REF!");break;case"PtgList":o.push("Table"+w[1].idx+"[#"+w[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(w));default:throw new Error("Unrecognized Formula Token: "+String(w))}var Z=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(s.biff!=3&&g>=0&&Z.indexOf(e[0][k][0])==-1){w=e[0][g];var G=!0;switch(w[1][0]){case 4:G=!1;case 0:_=Vt(" ",w[1][1]);break;case 5:G=!1;case 1:_=Vt("\r",w[1][1]);break;default:if(_="",s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+w[1][0])}o.push((G?_:"")+o.pop()+(G?"":_)),g=-1}}if(o.length>1&&s.WTF)throw new Error("bad formula stack");return o[0]}function TV(e,t,r){var n=e.l+t,s=r.biff==2?1:2,a,i=e.read_shift(s);if(i==65535)return[[],Gr(e,t-2)];var o=Gu(e,i,r);return t!==i+s&&(a=Hu(e,t-i-s,o,r)),e.l=n,[o,a]}function kV(e,t,r){var n=e.l+t,s=r.biff==2?1:2,a,i=e.read_shift(s);if(i==65535)return[[],Gr(e,t-2)];var o=Gu(e,i,r);return t!==i+s&&(a=Hu(e,t-i-s,o,r)),e.l=n,[o,a]}function SV(e,t,r,n){var s=e.l+t,a=Gu(e,n,r),i;return s!==e.l&&(i=Hu(e,s-e.l,a,r)),[a,i]}function AV(e,t,r){var n=e.l+t,s,a=e.read_shift(2),i=Gu(e,a,r);return a==65535?[[],Gr(e,t-2)]:(t!==a+2&&(s=Hu(e,n-a-2,i,r)),[i,s])}function IV(e){var t;if(sa(e,e.l+6)!==65535)return[Vr(e),"n"];switch(e[e.l]){case 0:return e.l+=8,["String","s"];case 1:return t=e[e.l+2]===1,e.l+=8,[t,"b"];case 2:return t=e[e.l+2],e.l+=8,[t,"e"];case 3:return e.l+=8,["","s"]}return[]}function sm(e,t,r){var n=e.l+t,s=Bs(e);r.biff==2&&++e.l;var a=IV(e),i=e.read_shift(1);r.biff!=2&&(e.read_shift(1),r.biff>=5&&e.read_shift(4));var o=kV(e,n-e.l,r);return{cell:s,val:a[0],formula:o,shared:i>>3&1,tt:a[1]}}function a0(e,t,r){var n=e.read_shift(4),s=Gu(e,n,r),a=e.read_shift(4),i=a>0?Hu(e,a,s,r):null;return[s,i]}var CV=a0,i0=a0,NV=a0,RV=a0,bV={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},EI={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},PV={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function Vw(e){return e.slice(0,3)=="of:"&&(e=e.slice(3)),e.charCodeAt(0)==61&&(e=e.slice(1),e.charCodeAt(0)==61&&(e=e.slice(1))),e=e.replace(/COM\.MICROSOFT\./g,""),e=e.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(t,r){return r.replace(/\./g,"")}),e=e.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),e.replace(/[;~]/g,",").replace(/\|/g,";")}function am(e){var t=e.split(":"),r=t[0].split(".")[0];return[r,t[0].split(".")[1]+(t.length>1?":"+(t[1].split(".")[1]||t[1].split(".")[0]):"")]}var Rc={},Jo={};function bc(e,t){if(e){var r=[.7,.7,.75,.75,.3,.3];t=="xlml"&&(r=[1,1,1,1,.5,.5]),e.left==null&&(e.left=r[0]),e.right==null&&(e.right=r[1]),e.top==null&&(e.top=r[2]),e.bottom==null&&(e.bottom=r[3]),e.header==null&&(e.header=r[4]),e.footer==null&&(e.footer=r[5])}}function TI(e,t,r,n,s,a){try{n.cellNF&&(e.z=$e[t])}catch(o){if(n.WTF)throw o}if(!(e.t==="z"&&!n.cellStyles)){if(e.t==="d"&&typeof e.v=="string"&&(e.v=gr(e.v)),(!n||n.cellText!==!1)&&e.t!=="z")try{if($e[t]==null&&Ui(D6[t]||"General",t),e.t==="e")e.w=e.w||uo[e.v];else if(t===0)if(e.t==="n")(e.v|0)===e.v?e.w=e.v.toString(10):e.w=cu(e.v);else if(e.t==="d"){var i=en(e.v);(i|0)===i?e.w=i.toString(10):e.w=cu(i)}else{if(e.v===void 0)return"";e.w=Qi(e.v,Jo)}else e.t==="d"?e.w=Gn(t,en(e.v),Jo):e.w=Gn(t,e.v,Jo)}catch(o){if(n.WTF)throw o}if(n.cellStyles&&r!=null)try{e.s=a.Fills[r],e.s.fgColor&&e.s.fgColor.theme&&!e.s.fgColor.rgb&&(e.s.fgColor.rgb=ld(s.themeElements.clrScheme[e.s.fgColor.theme].rgb,e.s.fgColor.tint||0),n.WTF&&(e.s.fgColor.raw_rgb=s.themeElements.clrScheme[e.s.fgColor.theme].rgb)),e.s.bgColor&&e.s.bgColor.theme&&(e.s.bgColor.rgb=ld(s.themeElements.clrScheme[e.s.bgColor.theme].rgb,e.s.bgColor.tint||0),n.WTF&&(e.s.bgColor.raw_rgb=s.themeElements.clrScheme[e.s.bgColor.theme].rgb))}catch(o){if(n.WTF&&a.Fills)throw o}}}function DV(e,t){var r=zt(t);r.s.r<=r.e.r&&r.s.c<=r.e.c&&r.s.r>=0&&r.s.c>=0&&(e["!ref"]=at(r))}var FV=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,OV=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,MV=/<(?:\w:)?hyperlink [^>]*>/mg,LV=/"(\w*:\w*)"/,jV=/<(?:\w:)?col\b[^>]*[\/]?>/g,UV=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,VV=/<(?:\w:)?pageMargins[^>]*\/>/g,kI=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,BV=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,zV=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function $V(e,t,r,n,s,a,i){if(!e)return e;n||(n={"!id":{}});var o=t.dense?[]:{},l={s:{r:2e6,c:2e6},e:{r:0,c:0}},c="",u="",d=e.match(OV);d?(c=e.slice(0,d.index),u=e.slice(d.index+d[0].length)):c=u=e;var m=c.match(kI);m?mv(m[0],o,s,r):(m=c.match(BV))&&WV(m[0],m[1]||"",o,s,r);var p=(c.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(p>0){var x=c.slice(p,p+50).match(LV);x&&DV(o,x[1])}var g=c.match(zV);g&&g[1]&&YV(g[1],s);var _=[];if(t.cellStyles){var k=c.match(jV);k&&KV(_,k)}d&&QV(d[1],o,t,l,a,i);var T=u.match(UV);T&&(o["!autofilter"]=qV(T[0]));var w=[],C=u.match(FV);if(C)for(p=0;p!=C.length;++p)w[p]=zt(C[p].slice(C[p].indexOf('"')+1));var M=u.match(MV);M&&HV(o,M,n);var O=u.match(VV);if(O&&(o["!margins"]=GV(Oe(O[0]))),!o["!ref"]&&l.e.c>=l.s.c&&l.e.r>=l.s.r&&(o["!ref"]=at(l)),t.sheetRows>0&&o["!ref"]){var v=zt(o["!ref"]);t.sheetRows<=+v.e.r&&(v.e.r=t.sheetRows-1,v.e.r>l.e.r&&(v.e.r=l.e.r),v.e.r<v.s.r&&(v.s.r=v.e.r),v.e.c>l.e.c&&(v.e.c=l.e.c),v.e.c<v.s.c&&(v.s.c=v.e.c),o["!fullref"]=o["!ref"],o["!ref"]=at(v))}return _.length>0&&(o["!cols"]=_),w.length>0&&(o["!merges"]=w),o}function mv(e,t,r,n){var s=Oe(e);r.Sheets[n]||(r.Sheets[n]={}),s.codeName&&(r.Sheets[n].CodeName=lt(Tt(s.codeName)))}function WV(e,t,r,n,s){mv(e.slice(0,e.indexOf(">")),r,n,s)}function HV(e,t,r){for(var n=Array.isArray(e),s=0;s!=t.length;++s){var a=Oe(Tt(t[s]),!0);if(!a.ref)return;var i=((r||{})["!id"]||[])[a.id];i?(a.Target=i.Target,a.location&&(a.Target+="#"+lt(a.location))):(a.Target="#"+lt(a.location),i={Target:a.Target,TargetMode:"Internal"}),a.Rel=i,a.tooltip&&(a.Tooltip=a.tooltip,delete a.tooltip);for(var o=zt(a.ref),l=o.s.r;l<=o.e.r;++l)for(var c=o.s.c;c<=o.e.c;++c){var u=Be({c,r:l});n?(e[l]||(e[l]=[]),e[l][c]||(e[l][c]={t:"z",v:void 0}),e[l][c].l=a):(e[u]||(e[u]={t:"z",v:void 0}),e[u].l=a)}}}function GV(e){var t={};return["left","right","top","bottom","header","footer"].forEach(function(r){e[r]&&(t[r]=parseFloat(e[r]))}),t}function KV(e,t){for(var r=!1,n=0;n!=t.length;++n){var s=Oe(t[n],!0);s.hidden&&(s.hidden=bt(s.hidden));var a=parseInt(s.min,10)-1,i=parseInt(s.max,10)-1;for(s.outlineLevel&&(s.level=+s.outlineLevel||0),delete s.min,delete s.max,s.width=+s.width,!r&&s.width&&(r=!0,hv(s.width)),xl(s);a<=i;)e[a++]=Sr(s)}}function qV(e){var t={ref:(e.match(/ref="([^"]*)"/)||[])[1]};return t}var XV=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function YV(e,t){t.Views||(t.Views=[{}]),(e.match(XV)||[]).forEach(function(r,n){var s=Oe(r);t.Views[n]||(t.Views[n]={}),+s.zoomScale&&(t.Views[n].zoom=+s.zoomScale),bt(s.rightToLeft)&&(t.Views[n].RTL=!0)})}var QV=function(){var e=/<(?:\w+:)?c[ \/>]/,t=/<\/(?:\w+:)?row>/,r=/r=["']([^"']*)["']/,n=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,s=/ref=["']([^"']*)["']/,a=uu("v"),i=uu("f");return function(l,c,u,d,m,p){for(var x=0,g="",_=[],k=[],T=0,w=0,C=0,M="",O,v,E=0,S=0,R,P,D=0,N=0,ce=Array.isArray(p.CellXf),oe,de=[],ge=[],Z=Array.isArray(c),G=[],ae={},fe=!1,B=!!u.sheetStubs,K=l.split(t),q=0,W=K.length;q!=W;++q){g=K[q].trim();var Q=g.length;if(Q!==0){var ue=0;e:for(x=0;x<Q;++x)switch(g[x]){case">":if(g[x-1]!="/"){++x;break e}if(u&&u.cellStyles){if(v=Oe(g.slice(ue,x),!0),E=v.r!=null?parseInt(v.r,10):E+1,S=-1,u.sheetRows&&u.sheetRows<E)continue;ae={},fe=!1,v.ht&&(fe=!0,ae.hpt=parseFloat(v.ht),ae.hpx=mu(ae.hpt)),v.hidden=="1"&&(fe=!0,ae.hidden=!0),v.outlineLevel!=null&&(fe=!0,ae.level=+v.outlineLevel),fe&&(G[E-1]=ae)}break;case"<":ue=x;break}if(ue>=x)break;if(v=Oe(g.slice(ue,x),!0),E=v.r!=null?parseInt(v.r,10):E+1,S=-1,!(u.sheetRows&&u.sheetRows<E)){d.s.r>E-1&&(d.s.r=E-1),d.e.r<E-1&&(d.e.r=E-1),u&&u.cellStyles&&(ae={},fe=!1,v.ht&&(fe=!0,ae.hpt=parseFloat(v.ht),ae.hpx=mu(ae.hpt)),v.hidden=="1"&&(fe=!0,ae.hidden=!0),v.outlineLevel!=null&&(fe=!0,ae.level=+v.outlineLevel),fe&&(G[E-1]=ae)),_=g.slice(x).split(e);for(var Ee=0;Ee!=_.length&&_[Ee].trim().charAt(0)=="<";++Ee);for(_=_.slice(Ee),x=0;x!=_.length;++x)if(g=_[x].trim(),g.length!==0){if(k=g.match(r),T=x,w=0,C=0,g="<c "+(g.slice(0,1)=="<"?">":"")+g,k!=null&&k.length===2){for(T=0,M=k[1],w=0;w!=M.length&&!((C=M.charCodeAt(w)-64)<1||C>26);++w)T=26*T+C;--T,S=T}else++S;for(w=0;w!=g.length&&g.charCodeAt(w)!==62;++w);if(++w,v=Oe(g.slice(0,w),!0),v.r||(v.r=Be({r:E-1,c:S})),M=g.slice(w),O={t:""},(k=M.match(a))!=null&&k[1]!==""&&(O.v=lt(k[1])),u.cellFormula){if((k=M.match(i))!=null&&k[1]!==""){if(O.f=lt(Tt(k[1])).replace(/\r\n/g,`
`),u.xlfn||(O.f=Mw(O.f)),k[0].indexOf('t="array"')>-1)O.F=(M.match(s)||[])[1],O.F.indexOf(":")>-1&&de.push([zt(O.F),O.F]);else if(k[0].indexOf('t="shared"')>-1){P=Oe(k[0]);var _e=lt(Tt(k[1]));u.xlfn||(_e=Mw(_e)),ge[parseInt(P.si,10)]=[P,_e,v.r]}}else(k=M.match(/<f[^>]*\/>/))&&(P=Oe(k[0]),ge[P.si]&&(O.f=lU(ge[P.si][1],ge[P.si][2],v.r)));var me=Qr(v.r);for(w=0;w<de.length;++w)me.r>=de[w][0].s.r&&me.r<=de[w][0].e.r&&me.c>=de[w][0].s.c&&me.c<=de[w][0].e.c&&(O.F=de[w][1])}if(v.t==null&&O.v===void 0)if(O.f||O.F)O.v=0,O.t="n";else if(B)O.t="z";else continue;else O.t=v.t||"n";switch(d.s.c>S&&(d.s.c=S),d.e.c<S&&(d.e.c=S),O.t){case"n":if(O.v==""||O.v==null){if(!B)continue;O.t="z"}else O.v=parseFloat(O.v);break;case"s":if(typeof O.v>"u"){if(!B)continue;O.t="z"}else R=Rc[parseInt(O.v,10)],O.v=R.t,O.r=R.r,u.cellHTML&&(O.h=R.h);break;case"str":O.t="s",O.v=O.v!=null?Tt(O.v):"",u.cellHTML&&(O.h=tv(O.v));break;case"inlineStr":k=M.match(n),O.t="s",k!=null&&(R=fv(k[1]))?(O.v=R.t,u.cellHTML&&(O.h=R.h)):O.v="";break;case"b":O.v=bt(O.v);break;case"d":u.cellDates?O.v=gr(O.v,1):(O.v=en(gr(O.v,1)),O.t="n");break;case"e":(!u||u.cellText!==!1)&&(O.w=O.v),O.v=HA[O.v];break}if(D=N=0,oe=null,ce&&v.s!==void 0&&(oe=p.CellXf[v.s],oe!=null&&(oe.numFmtId!=null&&(D=oe.numFmtId),u.cellStyles&&oe.fillId!=null&&(N=oe.fillId))),TI(O,D,N,u,m,p),u.cellDates&&ce&&O.t=="n"&&Al($e[D])&&(O.t="d",O.v=n0(O.v)),v.cm&&u.xlmeta){var je=(u.xlmeta.Cell||[])[+v.cm-1];je&&je.type=="XLDAPR"&&(O.D=!0)}if(Z){var H=Qr(v.r);c[H.r]||(c[H.r]=[]),c[H.r][H.c]=O}else c[v.r]=O}}}}G.length>0&&(c["!rows"]=G)}}();function JV(e,t){var r={},n=e.l+t;r.r=e.read_shift(4),e.l+=4;var s=e.read_shift(2);e.l+=1;var a=e.read_shift(1);return e.l=n,a&7&&(r.level=a&7),a&16&&(r.hidden=!0),a&32&&(r.hpt=s/20),r}var ZV=co;function eB(){}function tB(e,t){var r={},n=e[e.l];return++e.l,r.above=!(n&64),r.left=!(n&128),e.l+=18,r.name=Tj(e),r}function rB(e){var t=Kn(e);return[t]}function nB(e){var t=lo(e);return[t]}function sB(e){var t=Kn(e),r=e.read_shift(1);return[t,r,"b"]}function aB(e){var t=lo(e),r=e.read_shift(1);return[t,r,"b"]}function iB(e){var t=Kn(e),r=e.read_shift(1);return[t,r,"e"]}function oB(e){var t=lo(e),r=e.read_shift(1);return[t,r,"e"]}function lB(e){var t=Kn(e),r=e.read_shift(4);return[t,r,"s"]}function cB(e){var t=lo(e),r=e.read_shift(4);return[t,r,"s"]}function uB(e){var t=Kn(e),r=Vr(e);return[t,r,"n"]}function SI(e){var t=lo(e),r=Vr(e);return[t,r,"n"]}function fB(e){var t=Kn(e),r=lv(e);return[t,r,"n"]}function hB(e){var t=lo(e),r=lv(e);return[t,r,"n"]}function dB(e){var t=Kn(e),r=iv(e);return[t,r,"is"]}function mB(e){var t=Kn(e),r=$r(e);return[t,r,"str"]}function pB(e){var t=lo(e),r=$r(e);return[t,r,"str"]}function gB(e,t,r){var n=e.l+t,s=Kn(e);s.r=r["!row"];var a=e.read_shift(1),i=[s,a,"b"];if(r.cellFormula){e.l+=2;var o=i0(e,n-e.l,r);i[3]=Lr(o,null,s,r.supbooks,r)}else e.l=n;return i}function xB(e,t,r){var n=e.l+t,s=Kn(e);s.r=r["!row"];var a=e.read_shift(1),i=[s,a,"e"];if(r.cellFormula){e.l+=2;var o=i0(e,n-e.l,r);i[3]=Lr(o,null,s,r.supbooks,r)}else e.l=n;return i}function vB(e,t,r){var n=e.l+t,s=Kn(e);s.r=r["!row"];var a=Vr(e),i=[s,a,"n"];if(r.cellFormula){e.l+=2;var o=i0(e,n-e.l,r);i[3]=Lr(o,null,s,r.supbooks,r)}else e.l=n;return i}function yB(e,t,r){var n=e.l+t,s=Kn(e);s.r=r["!row"];var a=$r(e),i=[s,a,"str"];if(r.cellFormula){e.l+=2;var o=i0(e,n-e.l,r);i[3]=Lr(o,null,s,r.supbooks,r)}else e.l=n;return i}var _B=co;function wB(e,t){var r=e.l+t,n=co(e),s=ov(e),a=$r(e),i=$r(e),o=$r(e);e.l=r;var l={rfx:n,relId:s,loc:a,display:o};return i&&(l.Tooltip=i),l}function EB(){}function TB(e,t,r){var n=e.l+t,s=zA(e),a=e.read_shift(1),i=[s];if(i[2]=a,r.cellFormula){var o=CV(e,n-e.l,r);i[1]=o}else e.l=n;return i}function kB(e,t,r){var n=e.l+t,s=co(e),a=[s];if(r.cellFormula){var i=RV(e,n-e.l,r);a[1]=i,e.l=n}else e.l=n;return a}var SB=["left","right","top","bottom","header","footer"];function AB(e){var t={};return SB.forEach(function(r){t[r]=Vr(e)}),t}function IB(e){var t=e.read_shift(2);return e.l+=28,{RTL:t&32}}function CB(){}function NB(){}function RB(e,t,r,n,s,a,i){if(!e)return e;var o=t||{};n||(n={"!id":{}});var l=o.dense?[]:{},c,u={s:{r:2e6,c:2e6},e:{r:0,c:0}},d=!1,m=!1,p,x,g,_,k,T,w,C,M,O=[];o.biff=12,o["!row"]=0;var v=0,E=!1,S=[],R={},P=o.supbooks||s.supbooks||[[]];if(P.sharedf=R,P.arrayf=S,P.SheetNames=s.SheetNames||s.Sheets.map(function(Z){return Z.name}),!o.supbooks&&(o.supbooks=P,s.Names))for(var D=0;D<s.Names.length;++D)P[0][D+1]=s.Names[D];var N=[],ce=[],oe=!1;fd[16]={n:"BrtShortReal",f:SI};var de;if(ka(e,function(G,ae,fe){if(!m)switch(fe){case 148:c=G;break;case 0:p=G,o.sheetRows&&o.sheetRows<=p.r&&(m=!0),C=Ar(_=p.r),o["!row"]=p.r,(G.hidden||G.hpt||G.level!=null)&&(G.hpt&&(G.hpx=mu(G.hpt)),ce[G.r]=G);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(x={t:G[2]},G[2]){case"n":x.v=G[1];break;case"s":w=Rc[G[1]],x.v=w.t,x.r=w.r;break;case"b":x.v=!!G[1];break;case"e":x.v=G[1],o.cellText!==!1&&(x.w=uo[x.v]);break;case"str":x.t="s",x.v=G[1];break;case"is":x.t="s",x.v=G[1].t;break}if((g=i.CellXf[G[0].iStyleRef])&&TI(x,g.numFmtId,null,o,a,i),k=G[0].c==-1?k+1:G[0].c,o.dense?(l[_]||(l[_]=[]),l[_][k]=x):l[ir(k)+C]=x,o.cellFormula){for(E=!1,v=0;v<S.length;++v){var B=S[v];p.r>=B[0].s.r&&p.r<=B[0].e.r&&k>=B[0].s.c&&k<=B[0].e.c&&(x.F=at(B[0]),E=!0)}!E&&G.length>3&&(x.f=G[3])}if(u.s.r>p.r&&(u.s.r=p.r),u.s.c>k&&(u.s.c=k),u.e.r<p.r&&(u.e.r=p.r),u.e.c<k&&(u.e.c=k),o.cellDates&&g&&x.t=="n"&&Al($e[g.numFmtId])){var K=Fi(x.v);K&&(x.t="d",x.v=new Date(K.y,K.m-1,K.d,K.H,K.M,K.S,K.u))}de&&(de.type=="XLDAPR"&&(x.D=!0),de=void 0);break;case 1:case 12:if(!o.sheetStubs||d)break;x={t:"z",v:void 0},k=G[0].c==-1?k+1:G[0].c,o.dense?(l[_]||(l[_]=[]),l[_][k]=x):l[ir(k)+C]=x,u.s.r>p.r&&(u.s.r=p.r),u.s.c>k&&(u.s.c=k),u.e.r<p.r&&(u.e.r=p.r),u.e.c<k&&(u.e.c=k),de&&(de.type=="XLDAPR"&&(x.D=!0),de=void 0);break;case 176:O.push(G);break;case 49:de=((o.xlmeta||{}).Cell||[])[G-1];break;case 494:var q=n["!id"][G.relId];for(q?(G.Target=q.Target,G.loc&&(G.Target+="#"+G.loc),G.Rel=q):G.relId==""&&(G.Target="#"+G.loc),_=G.rfx.s.r;_<=G.rfx.e.r;++_)for(k=G.rfx.s.c;k<=G.rfx.e.c;++k)o.dense?(l[_]||(l[_]=[]),l[_][k]||(l[_][k]={t:"z",v:void 0}),l[_][k].l=G):(T=Be({c:k,r:_}),l[T]||(l[T]={t:"z",v:void 0}),l[T].l=G);break;case 426:if(!o.cellFormula)break;S.push(G),M=o.dense?l[_][k]:l[ir(k)+C],M.f=Lr(G[1],u,{r:p.r,c:k},P,o),M.F=at(G[0]);break;case 427:if(!o.cellFormula)break;R[Be(G[0].s)]=G[1],M=o.dense?l[_][k]:l[ir(k)+C],M.f=Lr(G[1],u,{r:p.r,c:k},P,o);break;case 60:if(!o.cellStyles)break;for(;G.e>=G.s;)N[G.e--]={width:G.w/256,hidden:!!(G.flags&1),level:G.level},oe||(oe=!0,hv(G.w/256)),xl(N[G.e+1]);break;case 161:l["!autofilter"]={ref:at(G)};break;case 476:l["!margins"]=G;break;case 147:s.Sheets[r]||(s.Sheets[r]={}),G.name&&(s.Sheets[r].CodeName=G.name),(G.above||G.left)&&(l["!outline"]={above:G.above,left:G.left});break;case 137:s.Views||(s.Views=[{}]),s.Views[0]||(s.Views[0]={}),G.RTL&&(s.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:d=!0;break;case 36:d=!1;break;case 37:d=!0;break;case 38:d=!1;break;default:if(!ae.T){if(!d||o.WTF)throw new Error("Unexpected record 0x"+fe.toString(16))}}},o),delete o.supbooks,delete o["!row"],!l["!ref"]&&(u.s.r<2e6||c&&(c.e.r>0||c.e.c>0||c.s.r>0||c.s.c>0))&&(l["!ref"]=at(c||u)),o.sheetRows&&l["!ref"]){var ge=zt(l["!ref"]);o.sheetRows<=+ge.e.r&&(ge.e.r=o.sheetRows-1,ge.e.r>u.e.r&&(ge.e.r=u.e.r),ge.e.r<ge.s.r&&(ge.s.r=ge.e.r),ge.e.c>u.e.c&&(ge.e.c=u.e.c),ge.e.c<ge.s.c&&(ge.s.c=ge.e.c),l["!fullref"]=l["!ref"],l["!ref"]=at(ge))}return O.length>0&&(l["!merges"]=O),N.length>0&&(l["!cols"]=N),ce.length>0&&(l["!rows"]=ce),l}function bB(e){var t=[],r=e.match(/^<c:numCache>/),n;(e.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(a){var i=a.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);i&&(t[+i[1]]=r?+i[2]:i[2])});var s=lt((e.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(e.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(a){n=a.replace(/<.*?>/g,"")}),[t,s,n]}function PB(e,t,r,n,s,a){var i=a||{"!type":"chart"};if(!e)return a;var o=0,l=0,c="A",u={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(e.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(d){var m=bB(d);u.s.r=u.s.c=0,u.e.c=o,c=ir(o),m[0].forEach(function(p,x){i[c+Ar(x)]={t:"n",v:p,z:m[1]},l=x}),u.e.r<l&&(u.e.r=l),++o}),o>0&&(i["!ref"]=at(u)),i}function DB(e,t,r,n,s){if(!e)return e;n||(n={"!id":{}});var a={"!type":"chart","!drawel":null,"!rel":""},i,o=e.match(kI);return o&&mv(o[0],a,s,r),(i=e.match(/drawing r:id="(.*?)"/))&&(a["!rel"]=i[1]),n["!id"][a["!rel"]]&&(a["!drawel"]=n["!id"][a["!rel"]]),a}function FB(e,t){e.l+=10;var r=$r(e);return{name:r}}function OB(e,t,r,n,s){if(!e)return e;n||(n={"!id":{}});var a={"!type":"chart","!drawel":null,"!rel":""},i=!1;return ka(e,function(l,c,u){switch(u){case 550:a["!rel"]=l;break;case 651:s.Sheets[r]||(s.Sheets[r]={}),l.name&&(s.Sheets[r].CodeName=l.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:i=!0;break;case 36:i=!1;break;case 37:break;case 38:break;default:if(!(c.T>0)){if(!(c.T<0)){if(!i||t.WTF)throw new Error("Unexpected record 0x"+u.toString(16))}}}},t),n["!id"][a["!rel"]]&&(a["!drawel"]=n["!id"][a["!rel"]]),a}var AI=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],MB=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],LB=[],jB=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function Bw(e,t){for(var r=0;r!=e.length;++r)for(var n=e[r],s=0;s!=t.length;++s){var a=t[s];if(n[a[0]]==null)n[a[0]]=a[1];else switch(a[2]){case"bool":typeof n[a[0]]=="string"&&(n[a[0]]=bt(n[a[0]]));break;case"int":typeof n[a[0]]=="string"&&(n[a[0]]=parseInt(n[a[0]],10));break}}}function zw(e,t){for(var r=0;r!=t.length;++r){var n=t[r];if(e[n[0]]==null)e[n[0]]=n[1];else switch(n[2]){case"bool":typeof e[n[0]]=="string"&&(e[n[0]]=bt(e[n[0]]));break;case"int":typeof e[n[0]]=="string"&&(e[n[0]]=parseInt(e[n[0]],10));break}}}function II(e){zw(e.WBProps,AI),zw(e.CalcPr,jB),Bw(e.WBView,MB),Bw(e.Sheets,LB),Jo.date1904=bt(e.WBProps.date1904)}var UB="][*?/\\".split("");function VB(e,t){if(e.length>31)throw new Error("Sheet names cannot exceed 31 chars");var r=!0;return UB.forEach(function(n){if(e.indexOf(n)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),r}var BB=/<\w+:workbook/;function zB(e,t){if(!e)throw new Error("Could not find file");var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},n=!1,s="xmlns",a={},i=0;if(e.replace(Kr,function(l,c){var u=Oe(l);switch(Vs(u[0])){case"<?xml":break;case"<workbook":l.match(BB)&&(s="xmlns"+l.match(/<(\w+):/)[1]),r.xmlns=u[s];break;case"</workbook>":break;case"<fileVersion":delete u[0],r.AppVersion=u;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":AI.forEach(function(d){if(u[d[0]]!=null)switch(d[2]){case"bool":r.WBProps[d[0]]=bt(u[d[0]]);break;case"int":r.WBProps[d[0]]=parseInt(u[d[0]],10);break;default:r.WBProps[d[0]]=u[d[0]]}}),u.codeName&&(r.WBProps.CodeName=Tt(u.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete u[0],r.WBView.push(u);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(u.state){case"hidden":u.Hidden=1;break;case"veryHidden":u.Hidden=2;break;default:u.Hidden=0}delete u.state,u.name=lt(Tt(u.name)),delete u[0],r.Sheets.push(u);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":n=!0;break;case"</definedNames>":n=!1;break;case"<definedName":a={},a.Name=Tt(u.name),u.comment&&(a.Comment=u.comment),u.localSheetId&&(a.Sheet=+u.localSheetId),bt(u.hidden||"0")&&(a.Hidden=!0),i=c+l.length;break;case"</definedName>":a.Ref=lt(Tt(e.slice(i,c))),r.Names.push(a);break;case"<definedName/>":break;case"<calcPr":delete u[0],r.CalcPr=u;break;case"<calcPr/>":delete u[0],r.CalcPr=u;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":n=!0;break;case"</AlternateContent>":n=!1;break;case"<revisionPtr":break;default:if(!n&&t.WTF)throw new Error("unrecognized "+u[0]+" in workbook")}return l}),ij.indexOf(r.xmlns)===-1)throw new Error("Unknown Namespace: "+r.xmlns);return II(r),r}function $B(e,t){var r={};return r.Hidden=e.read_shift(4),r.iTabID=e.read_shift(4),r.strRelID=Mp(e),r.name=$r(e),r}function WB(e,t){var r={},n=e.read_shift(4);r.defaultThemeVersion=e.read_shift(4);var s=t>8?$r(e):"";return s.length>0&&(r.CodeName=s),r.autoCompressPictures=!!(n&65536),r.backupFile=!!(n&64),r.checkCompatibility=!!(n&4096),r.date1904=!!(n&1),r.filterPrivacy=!!(n&8),r.hidePivotFieldList=!!(n&1024),r.promptedSolutions=!!(n&16),r.publishItems=!!(n&2048),r.refreshAllConnections=!!(n&262144),r.saveExternalLinkValues=!!(n&128),r.showBorderUnselectedTables=!!(n&4),r.showInkAnnotation=!!(n&32),r.showObjects=["all","placeholders","none"][n>>13&3],r.showPivotChartFilter=!!(n&32768),r.updateLinks=["userSet","never","always"][n>>8&3],r}function HB(e,t){var r={};return e.read_shift(4),r.ArchID=e.read_shift(4),e.l+=t-8,r}function GB(e,t,r){var n=e.l+t;e.l+=4,e.l+=1;var s=e.read_shift(4),a=kj(e),i=NV(e,0,r),o=ov(e);e.l=n;var l={Name:a,Ptg:i};return s<268435455&&(l.Sheet=s),o&&(l.Comment=o),l}function KB(e,t){var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},n=[],s=!1;t||(t={}),t.biff=12;var a=[],i=[[]];return i.SheetNames=[],i.XTI=[],fd[16]={n:"BrtFRTArchID$",f:HB},ka(e,function(l,c,u){switch(u){case 156:i.SheetNames.push(l.name),r.Sheets.push(l);break;case 153:r.WBProps=l;break;case 39:l.Sheet!=null&&(t.SID=l.Sheet),l.Ref=Lr(l.Ptg,null,null,i,t),delete t.SID,delete l.Ptg,a.push(l);break;case 1036:break;case 357:case 358:case 355:case 667:i[0].length?i.push([u,l]):i[0]=[u,l],i[i.length-1].XTI=[];break;case 362:i.length===0&&(i[0]=[],i[0].XTI=[]),i[i.length-1].XTI=i[i.length-1].XTI.concat(l),i.XTI=i.XTI.concat(l);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:n.push(u),s=!0;break;case 36:n.pop(),s=!1;break;case 37:n.push(u),s=!0;break;case 38:n.pop(),s=!1;break;case 16:break;default:if(!c.T){if(!s||t.WTF&&n[n.length-1]!=37&&n[n.length-1]!=35)throw new Error("Unexpected record 0x"+u.toString(16))}}},t),II(r),r.Names=a,r.supbooks=i,r}function qB(e,t,r){return t.slice(-4)===".bin"?KB(e,r):zB(e,r)}function XB(e,t,r,n,s,a,i,o){return t.slice(-4)===".bin"?RB(e,n,r,s,a,i,o):$V(e,n,r,s,a,i,o)}function YB(e,t,r,n,s,a,i,o){return t.slice(-4)===".bin"?OB(e,n,r,s,a):DB(e,n,r,s,a)}function QB(e,t,r,n,s,a,i,o){return t.slice(-4)===".bin"?aU():iU()}function JB(e,t,r,n,s,a,i,o){return t.slice(-4)===".bin"?nU():sU()}function ZB(e,t,r,n){return t.slice(-4)===".bin"?_9(e,r,n):m9(e,r,n)}function e7(e,t,r){return dI(e,r)}function t7(e,t,r){return t.slice(-4)===".bin"?M5(e,r):F5(e,r)}function r7(e,t,r){return t.slice(-4)===".bin"?eU(e,r):X9(e,r)}function n7(e,t,r){return t.slice(-4)===".bin"?G9(e):W9(e)}function s7(e,t,r,n){return r.slice(-4)===".bin"?K9(e,t,r,n):void 0}function a7(e,t,r){return t.slice(-4)===".bin"?z9(e,t,r):$9(e,t,r)}var CI=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,NI=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function Qn(e,t){var r=e.split(/\s+/),n=[];if(n[0]=r[0],r.length===1)return n;var s=e.match(CI),a,i,o,l;if(s)for(l=0;l!=s.length;++l)a=s[l].match(NI),(i=a[1].indexOf(":"))===-1?n[a[1]]=a[2].slice(1,a[2].length-1):(a[1].slice(0,6)==="xmlns:"?o="xmlns"+a[1].slice(6):o=a[1].slice(i+1),n[o]=a[2].slice(1,a[2].length-1));return n}function i7(e){var t=e.split(/\s+/),r={};if(t.length===1)return r;var n=e.match(CI),s,a,i,o;if(n)for(o=0;o!=n.length;++o)s=n[o].match(NI),(a=s[1].indexOf(":"))===-1?r[s[1]]=s[2].slice(1,s[2].length-1):(s[1].slice(0,6)==="xmlns:"?i="xmlns"+s[1].slice(6):i=s[1].slice(a+1),r[i]=s[2].slice(1,s[2].length-1));return r}var Pc;function o7(e,t){var r=Pc[e]||lt(e);return r==="General"?Qi(t):Gn(r,t)}function l7(e,t,r,n){var s=n;switch((r[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":s=bt(n);break;case"i2":case"int":s=parseInt(n,10);break;case"r4":case"float":s=parseFloat(n);break;case"date":case"dateTime.tz":s=gr(n);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+r[0])}e[lt(t)]=s}function c7(e,t,r){if(e.t!=="z"){if(!r||r.cellText!==!1)try{e.t==="e"?e.w=e.w||uo[e.v]:t==="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=cu(e.v):e.w=Qi(e.v):e.w=o7(t||"General",e.v)}catch(a){if(r.WTF)throw a}try{var n=Pc[t]||t||"General";if(r.cellNF&&(e.z=n),r.cellDates&&e.t=="n"&&Al(n)){var s=Fi(e.v);s&&(e.t="d",e.v=new Date(s.y,s.m-1,s.d,s.H,s.M,s.S,s.u))}}catch(a){if(r.WTF)throw a}}}function u7(e,t,r){if(r.cellStyles&&t.Interior){var n=t.Interior;n.Pattern&&(n.patternType=l9[n.Pattern]||n.Pattern)}e[t.ID]=t}function f7(e,t,r,n,s,a,i,o,l,c){var u="General",d=n.StyleID,m={};c=c||{};var p=[],x=0;for(d===void 0&&o&&(d=o.StyleID),d===void 0&&i&&(d=i.StyleID);a[d]!==void 0&&(a[d].nf&&(u=a[d].nf),a[d].Interior&&p.push(a[d].Interior),!!a[d].Parent);)d=a[d].Parent;switch(r.Type){case"Boolean":n.t="b",n.v=bt(e);break;case"String":n.t="s",n.r=uw(lt(e)),n.v=e.indexOf("<")>-1?lt(t||e).replace(/<.*?>/g,""):n.r;break;case"DateTime":e.slice(-1)!="Z"&&(e+="Z"),n.v=(gr(e)-new Date(Date.UTC(1899,11,30)))/(24*60*60*1e3),n.v!==n.v?n.v=lt(e):n.v<60&&(n.v=n.v-1),(!u||u=="General")&&(u="yyyy-mm-dd");case"Number":n.v===void 0&&(n.v=+e),n.t||(n.t="n");break;case"Error":n.t="e",n.v=HA[e],c.cellText!==!1&&(n.w=e);break;default:e==""&&t==""?n.t="z":(n.t="s",n.v=uw(t||e));break}if(c7(n,u,c),c.cellFormula!==!1)if(n.Formula){var g=lt(n.Formula);g.charCodeAt(0)==61&&(g=g.slice(1)),n.f=Qo(g,s),delete n.Formula,n.ArrayRange=="RC"?n.F=Qo("RC:RC",s):n.ArrayRange&&(n.F=Qo(n.ArrayRange,s),l.push([zt(n.F),n.F]))}else for(x=0;x<l.length;++x)s.r>=l[x][0].s.r&&s.r<=l[x][0].e.r&&s.c>=l[x][0].s.c&&s.c<=l[x][0].e.c&&(n.F=l[x][1]);c.cellStyles&&(p.forEach(function(_){!m.patternType&&_.patternType&&(m.patternType=_.patternType)}),n.s=m),n.StyleID!==void 0&&(n.ixfe=n.StyleID)}function h7(e){e.t=e.v||"",e.t=e.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.v=e.w=e.ixfe=void 0}function im(e,t){var r=t||{};xA();var n=ac(rv(e));(r.type=="binary"||r.type=="array"||r.type=="base64")&&(n=Tt(n));var s=n.slice(0,1024).toLowerCase(),a=!1;if(s=s.replace(/".*?"/g,""),(s.indexOf(">")&1023)>Math.min(s.indexOf(",")&1023,s.indexOf(";")&1023)){var i=Sr(r);return i.type="string",hu.to_workbook(n,i)}if(s.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(_t){s.indexOf("<"+_t)>=0&&(a=!0)}),a)return w7(n,r);Pc={"General Number":"General","General Date":$e[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":$e[15],"Short Date":$e[14],"Long Time":$e[19],"Medium Time":$e[18],"Short Time":$e[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:$e[2],Standard:$e[4],Percent:$e[10],Scientific:$e[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var o,l=[],c,u={},d=[],m=r.dense?[]:{},p="",x={},g={},_=Qn('<Data ss:Type="String">'),k=0,T=0,w=0,C={s:{r:2e6,c:2e6},e:{r:0,c:0}},M={},O={},v="",E=0,S=[],R={},P={},D=0,N=[],ce=[],oe={},de=[],ge,Z=!1,G=[],ae=[],fe={},B=0,K=0,q={Sheets:[],WBProps:{date1904:!1}},W={};fu.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"");for(var Q="";o=fu.exec(n);)switch(o[3]=(Q=o[3]).toLowerCase()){case"data":if(Q=="data"){if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&l.push([o[3],!0]);break}if(l[l.length-1][1])break;o[1]==="/"?f7(n.slice(k,o.index),v,_,l[l.length-1][0]=="comment"?oe:x,{c:T,r:w},M,de[T],g,G,r):(v="",_=Qn(o[0]),k=o.index+o[0].length);break;case"cell":if(o[1]==="/")if(ce.length>0&&(x.c=ce),(!r.sheetRows||r.sheetRows>w)&&x.v!==void 0&&(r.dense?(m[w]||(m[w]=[]),m[w][T]=x):m[ir(T)+Ar(w)]=x),x.HRef&&(x.l={Target:lt(x.HRef)},x.HRefScreenTip&&(x.l.Tooltip=x.HRefScreenTip),delete x.HRef,delete x.HRefScreenTip),(x.MergeAcross||x.MergeDown)&&(B=T+(parseInt(x.MergeAcross,10)|0),K=w+(parseInt(x.MergeDown,10)|0),S.push({s:{c:T,r:w},e:{c:B,r:K}})),!r.sheetStubs)x.MergeAcross?T=B+1:++T;else if(x.MergeAcross||x.MergeDown){for(var ue=T;ue<=B;++ue)for(var Ee=w;Ee<=K;++Ee)(ue>T||Ee>w)&&(r.dense?(m[Ee]||(m[Ee]=[]),m[Ee][ue]={t:"z"}):m[ir(ue)+Ar(Ee)]={t:"z"});T=B+1}else++T;else x=i7(o[0]),x.Index&&(T=+x.Index-1),T<C.s.c&&(C.s.c=T),T>C.e.c&&(C.e.c=T),o[0].slice(-2)==="/>"&&++T,ce=[];break;case"row":o[1]==="/"||o[0].slice(-2)==="/>"?(w<C.s.r&&(C.s.r=w),w>C.e.r&&(C.e.r=w),o[0].slice(-2)==="/>"&&(g=Qn(o[0]),g.Index&&(w=+g.Index-1)),T=0,++w):(g=Qn(o[0]),g.Index&&(w=+g.Index-1),fe={},(g.AutoFitHeight=="0"||g.Height)&&(fe.hpx=parseInt(g.Height,10),fe.hpt=hI(fe.hpx),ae[w]=fe),g.Hidden=="1"&&(fe.hidden=!0,ae[w]=fe));break;case"worksheet":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"));d.push(p),C.s.r<=C.e.r&&C.s.c<=C.e.c&&(m["!ref"]=at(C),r.sheetRows&&r.sheetRows<=C.e.r&&(m["!fullref"]=m["!ref"],C.e.r=r.sheetRows-1,m["!ref"]=at(C))),S.length&&(m["!merges"]=S),de.length>0&&(m["!cols"]=de),ae.length>0&&(m["!rows"]=ae),u[p]=m}else C={s:{r:2e6,c:2e6},e:{r:0,c:0}},w=T=0,l.push([o[3],!1]),c=Qn(o[0]),p=lt(c.Name),m=r.dense?[]:{},S=[],G=[],ae=[],W={name:p,Hidden:0},q.Sheets.push(W);break;case"table":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else{if(o[0].slice(-2)=="/>")break;l.push([o[3],!1]),de=[],Z=!1}break;case"style":o[1]==="/"?u7(M,O,r):O=Qn(o[0]);break;case"numberformat":O.nf=lt(Qn(o[0]).Format||"General"),Pc[O.nf]&&(O.nf=Pc[O.nf]);for(var _e=0;_e!=392&&$e[_e]!=O.nf;++_e);if(_e==392){for(_e=57;_e!=392;++_e)if($e[_e]==null){Ui(O.nf,_e);break}}break;case"column":if(l[l.length-1][0]!=="table")break;if(ge=Qn(o[0]),ge.Hidden&&(ge.hidden=!0,delete ge.Hidden),ge.Width&&(ge.wpx=parseInt(ge.Width,10)),!Z&&ge.wpx>10){Z=!0,Yr=uI;for(var me=0;me<de.length;++me)de[me]&&xl(de[me])}Z&&xl(ge),de[ge.Index-1||de.length]=ge;for(var je=0;je<+ge.Span;++je)de[de.length]=Sr(ge);break;case"namedrange":if(o[1]==="/")break;q.Names||(q.Names=[]);var H=Oe(o[0]),tt={Name:H.Name,Ref:Qo(H.RefersTo.slice(1),{r:0,c:0})};q.Sheets.length>0&&(tt.Sheet=q.Sheets.length-1),q.Names.push(tt);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(o[0].slice(-2)==="/>")break;o[1]==="/"?v+=n.slice(E,o.index):E=o.index+o[0].length;break;case"interior":if(!r.cellStyles)break;O.Interior=Qn(o[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(o[0].slice(-2)==="/>")break;o[1]==="/"?Xj(R,Q,n.slice(D,o.index)):D=o.index+o[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else l.push([o[3],!1]);break;case"comment":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"));h7(oe),ce.push(oe)}else l.push([o[3],!1]),c=Qn(o[0]),oe={a:c.Author};break;case"autofilter":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else if(o[0].charAt(o[0].length-2)!=="/"){var He=Qn(o[0]);m["!autofilter"]={ref:Qo(He.Range).replace(/\$/g,"")},l.push([o[3],!0])}break;case"name":break;case"datavalidation":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&l.push([o[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&l.push([o[3],!0]);break;case"null":break;default:if(l.length==0&&o[3]=="document"||l.length==0&&o[3]=="uof")return qw(n,r);var Je=!0;switch(l[l.length-1][0]){case"officedocumentsettings":switch(o[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:Je=!1}break;case"componentoptions":switch(o[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:Je=!1}break;case"excelworkbook":switch(o[3]){case"date1904":q.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:Je=!1}break;case"workbookoptions":switch(o[3]){case"owcversion":break;case"height":break;case"width":break;default:Je=!1}break;case"worksheetoptions":switch(o[3]){case"visible":if(o[0].slice(-2)!=="/>")if(o[1]==="/")switch(n.slice(D,o.index)){case"SheetHidden":W.Hidden=1;break;case"SheetVeryHidden":W.Hidden=2;break}else D=o.index+o[0].length;break;case"header":m["!margins"]||bc(m["!margins"]={},"xlml"),isNaN(+Oe(o[0]).Margin)||(m["!margins"].header=+Oe(o[0]).Margin);break;case"footer":m["!margins"]||bc(m["!margins"]={},"xlml"),isNaN(+Oe(o[0]).Margin)||(m["!margins"].footer=+Oe(o[0]).Margin);break;case"pagemargins":var De=Oe(o[0]);m["!margins"]||bc(m["!margins"]={},"xlml"),isNaN(+De.Top)||(m["!margins"].top=+De.Top),isNaN(+De.Left)||(m["!margins"].left=+De.Left),isNaN(+De.Right)||(m["!margins"].right=+De.Right),isNaN(+De.Bottom)||(m["!margins"].bottom=+De.Bottom);break;case"displayrighttoleft":q.Views||(q.Views=[]),q.Views[0]||(q.Views[0]={}),q.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":m["!outline"]||(m["!outline"]={}),m["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":m["!outline"]||(m["!outline"]={}),m["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:Je=!1}break;case"pivottable":case"pivotcache":switch(o[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:Je=!1}break;case"pagebreaks":switch(o[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:Je=!1}break;case"autofilter":switch(o[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:Je=!1}break;case"querytable":switch(o[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:Je=!1}break;case"datavalidation":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:Je=!1}break;case"sorting":case"conditionalformatting":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:Je=!1}break;case"mapinfo":case"schema":case"data":switch(o[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:Je=!1}break;case"smarttags":break;default:Je=!1;break}if(Je||o[3].match(/!\[CDATA/))break;if(!l[l.length-1][1])throw"Unrecognized tag: "+o[3]+"|"+l.join("|");if(l[l.length-1][0]==="customdocumentproperties"){if(o[0].slice(-2)==="/>")break;o[1]==="/"?l7(P,Q,N,n.slice(D,o.index)):(N=o,D=o.index+o[0].length);break}if(r.WTF)throw"Unrecognized tag: "+o[3]+"|"+l.join("|")}var Ae={};return!r.bookSheets&&!r.bookProps&&(Ae.Sheets=u),Ae.SheetNames=d,Ae.Workbook=q,Ae.SSF=Sr($e),Ae.Props=R,Ae.Custprops=P,Ae}function Vp(e,t){switch(xv(t=t||{}),t.type||"base64"){case"base64":return im(An(e),t);case"binary":case"buffer":case"file":return im(e,t);case"array":return im(oo(e),t)}}function d7(e){var t={},r=e.content;if(r.l=28,t.AnsiUserType=r.read_shift(0,"lpstr-ansi"),t.AnsiClipboardFormat=Ij(r),r.length-r.l<=4)return t;var n=r.read_shift(4);if(n==0||n>40||(r.l-=4,t.Reserved1=r.read_shift(0,"lpstr-ansi"),r.length-r.l<=4)||(n=r.read_shift(4),n!==1907505652)||(t.UnicodeClipboardFormat=Cj(r),n=r.read_shift(4),n==0||n>40))return t;r.l-=4,t.Reserved2=r.read_shift(0,"lpwstr")}var m7=[60,1084,2066,2165,2175];function p7(e,t,r,n,s){var a=n,i=[],o=r.slice(r.l,r.l+a);if(s&&s.enc&&s.enc.insitu&&o.length>0)switch(e){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:s.enc.insitu(o)}i.push(o),r.l+=a;for(var l=sa(r,r.l),c=Bp[l],u=0;c!=null&&m7.indexOf(l)>-1;)a=sa(r,r.l+2),u=r.l+4,l==2066?u+=4:(l==2165||l==2175)&&(u+=12),o=r.slice(u,r.l+4+a),i.push(o),r.l+=4+a,c=Bp[l=sa(r,r.l)];var d=Va(i);wr(d,0);var m=0;d.lens=[];for(var p=0;p<i.length;++p)d.lens.push(m),m+=i[p].length;if(d.length<n)throw"XLS Record 0x"+e.toString(16)+" Truncated: "+d.length+" < "+n;return t.f(d,d.length,s)}function vs(e,t,r){if(e.t!=="z"&&e.XF){var n=0;try{n=e.z||e.XF.numFmtId||0,t.cellNF&&(e.z=$e[n])}catch(a){if(t.WTF)throw a}if(!t||t.cellText!==!1)try{e.t==="e"?e.w=e.w||uo[e.v]:n===0||n=="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=cu(e.v):e.w=Qi(e.v):e.w=Gn(n,e.v,{date1904:!!r,dateNF:t&&t.dateNF})}catch(a){if(t.WTF)throw a}if(t.cellDates&&n&&e.t=="n"&&Al($e[n]||String(n))){var s=Fi(e.v);s&&(e.t="d",e.v=new Date(s.y,s.m-1,s.d,s.H,s.M,s.S,s.u))}}}function jf(e,t,r){return{v:e,ixfe:t,t:r}}function g7(e,t){var r={opts:{}},n={},s=t.dense?[]:{},a={},i={},o=null,l=[],c="",u={},d,m="",p,x,g,_,k={},T=[],w,C,M=[],O=[],v={Sheets:[],WBProps:{date1904:!1},Views:[{}]},E={},S=function(Ue){return Ue<8?Vi[Ue]:Ue<64&&O[Ue-8]||Vi[Ue]},R=function(Ue,yt,qt){var ft=yt.XF.data;if(!(!ft||!ft.patternType||!qt||!qt.cellStyles)){yt.s={},yt.s.patternType=ft.patternType;var gn;(gn=du(S(ft.icvFore)))&&(yt.s.fgColor={rgb:gn}),(gn=du(S(ft.icvBack)))&&(yt.s.bgColor={rgb:gn})}},P=function(Ue,yt,qt){if(!(fe>1)&&!(qt.sheetRows&&Ue.r>=qt.sheetRows)){if(qt.cellStyles&&yt.XF&&yt.XF.data&&R(Ue,yt,qt),delete yt.ixfe,delete yt.XF,d=Ue,m=Be(Ue),(!i||!i.s||!i.e)&&(i={s:{r:0,c:0},e:{r:0,c:0}}),Ue.r<i.s.r&&(i.s.r=Ue.r),Ue.c<i.s.c&&(i.s.c=Ue.c),Ue.r+1>i.e.r&&(i.e.r=Ue.r+1),Ue.c+1>i.e.c&&(i.e.c=Ue.c+1),qt.cellFormula&&yt.f){for(var ft=0;ft<T.length;++ft)if(!(T[ft][0].s.c>Ue.c||T[ft][0].s.r>Ue.r)&&!(T[ft][0].e.c<Ue.c||T[ft][0].e.r<Ue.r)){yt.F=at(T[ft][0]),(T[ft][0].s.c!=Ue.c||T[ft][0].s.r!=Ue.r)&&delete yt.f,yt.f&&(yt.f=""+Lr(T[ft][1],i,Ue,G,D));break}}qt.dense?(s[Ue.r]||(s[Ue.r]=[]),s[Ue.r][Ue.c]=yt):s[m]=yt}},D={enc:!1,sbcch:0,snames:[],sharedf:k,arrayf:T,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!t&&!!t.cellStyles,WTF:!!t&&!!t.wtf};t.password&&(D.password=t.password);var N,ce=[],oe=[],de=[],ge=[],Z=!1,G=[];G.SheetNames=D.snames,G.sharedf=D.sharedf,G.arrayf=D.arrayf,G.names=[],G.XTI=[];var ae=0,fe=0,B=0,K=[],q=[],W;D.codepage=1200,is(1200);for(var Q=!1;e.l<e.length-1;){var ue=e.l,Ee=e.read_shift(2);if(Ee===0&&ae===10)break;var _e=e.l===e.length?0:e.read_shift(2),me=Bp[Ee];if(me&&me.f){if(t.bookSheets&&ae===133&&Ee!==133)break;if(ae=Ee,me.r===2||me.r==12){var je=e.read_shift(2);if(_e-=2,!D.enc&&je!==Ee&&((je&255)<<8|je>>8)!==Ee)throw new Error("rt mismatch: "+je+"!="+Ee);me.r==12&&(e.l+=10,_e-=10)}var H={};if(Ee===10?H=me.f(e,_e,D):H=p7(Ee,me,e,_e,D),fe==0&&[9,521,1033,2057].indexOf(ae)===-1)continue;switch(Ee){case 34:r.opts.Date1904=v.WBProps.date1904=H;break;case 134:r.opts.WriteProtect=!0;break;case 47:if(D.enc||(e.l=0),D.enc=H,!t.password)throw new Error("File is password-protected");if(H.valid==null)throw new Error("Encryption scheme unsupported");if(!H.valid)throw new Error("Password is incorrect");break;case 92:D.lastuser=H;break;case 66:var tt=Number(H);switch(tt){case 21010:tt=1200;break;case 32768:tt=1e4;break;case 32769:tt=1252;break}is(D.codepage=tt),Q=!0;break;case 317:D.rrtabid=H;break;case 25:D.winlocked=H;break;case 439:r.opts.RefreshAll=H;break;case 12:r.opts.CalcCount=H;break;case 16:r.opts.CalcDelta=H;break;case 17:r.opts.CalcIter=H;break;case 13:r.opts.CalcMode=H;break;case 14:r.opts.CalcPrecision=H;break;case 95:r.opts.CalcSaveRecalc=H;break;case 15:D.CalcRefMode=H;break;case 2211:r.opts.FullCalc=H;break;case 129:H.fDialog&&(s["!type"]="dialog"),H.fBelow||((s["!outline"]||(s["!outline"]={})).above=!0),H.fRight||((s["!outline"]||(s["!outline"]={})).left=!0);break;case 224:M.push(H);break;case 430:G.push([H]),G[G.length-1].XTI=[];break;case 35:case 547:G[G.length-1].push(H);break;case 24:case 536:W={Name:H.Name,Ref:Lr(H.rgce,i,null,G,D)},H.itab>0&&(W.Sheet=H.itab-1),G.names.push(W),G[0]||(G[0]=[],G[0].XTI=[]),G[G.length-1].push(H),H.Name=="_xlnm._FilterDatabase"&&H.itab>0&&H.rgce&&H.rgce[0]&&H.rgce[0][0]&&H.rgce[0][0][0]=="PtgArea3d"&&(q[H.itab-1]={ref:at(H.rgce[0][0][1][2])});break;case 22:D.ExternCount=H;break;case 23:G.length==0&&(G[0]=[],G[0].XTI=[]),G[G.length-1].XTI=G[G.length-1].XTI.concat(H),G.XTI=G.XTI.concat(H);break;case 2196:if(D.biff<8)break;W!=null&&(W.Comment=H[1]);break;case 18:s["!protect"]=H;break;case 19:H!==0&&D.WTF&&console.error("Password verifier: "+H);break;case 133:a[H.pos]=H,D.snames.push(H.name);break;case 10:{if(--fe)break;if(i.e){if(i.e.r>0&&i.e.c>0){if(i.e.r--,i.e.c--,s["!ref"]=at(i),t.sheetRows&&t.sheetRows<=i.e.r){var He=i.e.r;i.e.r=t.sheetRows-1,s["!fullref"]=s["!ref"],s["!ref"]=at(i),i.e.r=He}i.e.r++,i.e.c++}ce.length>0&&(s["!merges"]=ce),oe.length>0&&(s["!objects"]=oe),de.length>0&&(s["!cols"]=de),ge.length>0&&(s["!rows"]=ge),v.Sheets.push(E)}c===""?u=s:n[c]=s,s=t.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(D.biff===8&&(D.biff={9:2,521:3,1033:4}[Ee]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[H.BIFFVer]||8),D.biffguess=H.BIFFVer==0,H.BIFFVer==0&&H.dt==4096&&(D.biff=5,Q=!0,is(D.codepage=28591)),D.biff==8&&H.BIFFVer==0&&H.dt==16&&(D.biff=2),fe++)break;if(s=t.dense?[]:{},D.biff<8&&!Q&&(Q=!0,is(D.codepage=t.codepage||1252)),D.biff<5||H.BIFFVer==0&&H.dt==4096){c===""&&(c="Sheet1"),i={s:{r:0,c:0},e:{r:0,c:0}};var Je={pos:e.l-_e,name:c};a[Je.pos]=Je,D.snames.push(c)}else c=(a[ue]||{name:""}).name;H.dt==32&&(s["!type"]="chart"),H.dt==64&&(s["!type"]="macro"),ce=[],oe=[],D.arrayf=T=[],de=[],ge=[],Z=!1,E={Hidden:(a[ue]||{hs:0}).hs,name:c}}break;case 515:case 3:case 2:s["!type"]=="chart"&&(t.dense?(s[H.r]||[])[H.c]:s[Be({c:H.c,r:H.r})])&&++H.c,w={ixfe:H.ixfe,XF:M[H.ixfe]||{},v:H.val,t:"n"},B>0&&(w.z=K[w.ixfe>>8&63]),vs(w,t,r.opts.Date1904),P({c:H.c,r:H.r},w,t);break;case 5:case 517:w={ixfe:H.ixfe,XF:M[H.ixfe],v:H.val,t:H.t},B>0&&(w.z=K[w.ixfe>>8&63]),vs(w,t,r.opts.Date1904),P({c:H.c,r:H.r},w,t);break;case 638:w={ixfe:H.ixfe,XF:M[H.ixfe],v:H.rknum,t:"n"},B>0&&(w.z=K[w.ixfe>>8&63]),vs(w,t,r.opts.Date1904),P({c:H.c,r:H.r},w,t);break;case 189:for(var De=H.c;De<=H.C;++De){var Ae=H.rkrec[De-H.c][0];w={ixfe:Ae,XF:M[Ae],v:H.rkrec[De-H.c][1],t:"n"},B>0&&(w.z=K[w.ixfe>>8&63]),vs(w,t,r.opts.Date1904),P({c:De,r:H.r},w,t)}break;case 6:case 518:case 1030:{if(H.val=="String"){o=H;break}if(w=jf(H.val,H.cell.ixfe,H.tt),w.XF=M[w.ixfe],t.cellFormula){var _t=H.formula;if(_t&&_t[0]&&_t[0][0]&&_t[0][0][0]=="PtgExp"){var ur=_t[0][0][1][0],Nr=_t[0][0][1][1],nn=Be({r:ur,c:Nr});k[nn]?w.f=""+Lr(H.formula,i,H.cell,G,D):w.F=((t.dense?(s[ur]||[])[Nr]:s[nn])||{}).F}else w.f=""+Lr(H.formula,i,H.cell,G,D)}B>0&&(w.z=K[w.ixfe>>8&63]),vs(w,t,r.opts.Date1904),P(H.cell,w,t),o=H}break;case 7:case 519:if(o)o.val=H,w=jf(H,o.cell.ixfe,"s"),w.XF=M[w.ixfe],t.cellFormula&&(w.f=""+Lr(o.formula,i,o.cell,G,D)),B>0&&(w.z=K[w.ixfe>>8&63]),vs(w,t,r.opts.Date1904),P(o.cell,w,t),o=null;else throw new Error("String record expects Formula");break;case 33:case 545:{T.push(H);var zs=Be(H[0].s);if(p=t.dense?(s[H[0].s.r]||[])[H[0].s.c]:s[zs],t.cellFormula&&p){if(!o||!zs||!p)break;p.f=""+Lr(H[1],i,H[0],G,D),p.F=at(H[0])}}break;case 1212:{if(!t.cellFormula)break;if(m){if(!o)break;k[Be(o.cell)]=H[0],p=t.dense?(s[o.cell.r]||[])[o.cell.c]:s[Be(o.cell)],(p||{}).f=""+Lr(H[0],i,d,G,D)}}break;case 253:w=jf(l[H.isst].t,H.ixfe,"s"),l[H.isst].h&&(w.h=l[H.isst].h),w.XF=M[w.ixfe],B>0&&(w.z=K[w.ixfe>>8&63]),vs(w,t,r.opts.Date1904),P({c:H.c,r:H.r},w,t);break;case 513:t.sheetStubs&&(w={ixfe:H.ixfe,XF:M[H.ixfe],t:"z"},B>0&&(w.z=K[w.ixfe>>8&63]),vs(w,t,r.opts.Date1904),P({c:H.c,r:H.r},w,t));break;case 190:if(t.sheetStubs)for(var sn=H.c;sn<=H.C;++sn){var kt=H.ixfe[sn-H.c];w={ixfe:kt,XF:M[kt],t:"z"},B>0&&(w.z=K[w.ixfe>>8&63]),vs(w,t,r.opts.Date1904),P({c:sn,r:H.r},w,t)}break;case 214:case 516:case 4:w=jf(H.val,H.ixfe,"s"),w.XF=M[w.ixfe],B>0&&(w.z=K[w.ixfe>>8&63]),vs(w,t,r.opts.Date1904),P({c:H.c,r:H.r},w,t);break;case 0:case 512:fe===1&&(i=H);break;case 252:l=H;break;case 1054:if(D.biff==4){K[B++]=H[1];for(var fr=0;fr<B+163&&$e[fr]!=H[1];++fr);fr>=163&&Ui(H[1],B+163)}else Ui(H[1],H[0]);break;case 30:{K[B++]=H;for(var vt=0;vt<B+163&&$e[vt]!=H;++vt);vt>=163&&Ui(H,B+163)}break;case 229:ce=ce.concat(H);break;case 93:oe[H.cmo[0]]=D.lastobj=H;break;case 438:D.lastobj.TxO=H;break;case 127:D.lastobj.ImData=H;break;case 440:for(_=H[0].s.r;_<=H[0].e.r;++_)for(g=H[0].s.c;g<=H[0].e.c;++g)p=t.dense?(s[_]||[])[g]:s[Be({c:g,r:_})],p&&(p.l=H[1]);break;case 2048:for(_=H[0].s.r;_<=H[0].e.r;++_)for(g=H[0].s.c;g<=H[0].e.c;++g)p=t.dense?(s[_]||[])[g]:s[Be({c:g,r:_})],p&&p.l&&(p.l.Tooltip=H[1]);break;case 28:{if(D.biff<=5&&D.biff>=2)break;p=t.dense?(s[H[0].r]||[])[H[0].c]:s[Be(H[0])];var St=oe[H[2]];p||(t.dense?(s[H[0].r]||(s[H[0].r]=[]),p=s[H[0].r][H[0].c]={t:"z"}):p=s[Be(H[0])]={t:"z"},i.e.r=Math.max(i.e.r,H[0].r),i.s.r=Math.min(i.s.r,H[0].r),i.e.c=Math.max(i.e.c,H[0].c),i.s.c=Math.min(i.s.c,H[0].c)),p.c||(p.c=[]),x={a:H[1],t:St.TxO.t},p.c.push(x)}break;case 2173:j9(M[H.ixfe],H.ext);break;case 125:{if(!D.cellStyles)break;for(;H.e>=H.s;)de[H.e--]={width:H.w/256,level:H.level||0,hidden:!!(H.flags&1)},Z||(Z=!0,hv(H.w/256)),xl(de[H.e+1])}break;case 520:{var dt={};H.level!=null&&(ge[H.r]=dt,dt.level=H.level),H.hidden&&(ge[H.r]=dt,dt.hidden=!0),H.hpt&&(ge[H.r]=dt,dt.hpt=H.hpt,dt.hpx=mu(H.hpt))}break;case 38:case 39:case 40:case 41:s["!margins"]||bc(s["!margins"]={}),s["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[Ee]]=H;break;case 161:s["!margins"]||bc(s["!margins"]={}),s["!margins"].header=H.header,s["!margins"].footer=H.footer;break;case 574:H.RTL&&(v.Views[0].RTL=!0);break;case 146:O=H;break;case 2198:N=H;break;case 140:C=H;break;case 442:c?E.CodeName=H||E.name:v.WBProps.CodeName=H||"ThisWorkbook";break}}else me||console.error("Missing Info for XLS Record 0x"+Ee.toString(16)),e.l+=_e}return r.SheetNames=Fs(a).sort(function(Dt,Ue){return Number(Dt)-Number(Ue)}).map(function(Dt){return a[Dt].name}),t.bookSheets||(r.Sheets=n),!r.SheetNames.length&&u["!ref"]?(r.SheetNames.push("Sheet1"),r.Sheets&&(r.Sheets.Sheet1=u)):r.Preamble=u,r.Sheets&&q.forEach(function(Dt,Ue){r.Sheets[r.SheetNames[Ue]]["!autofilter"]=Dt}),r.Strings=l,r.SSF=Sr($e),D.enc&&(r.Encryption=D.enc),N&&(r.Themes=N),r.Metadata={},C!==void 0&&(r.Metadata.Country=C),G.names.length>0&&(v.Names=G.names),r.Workbook=v,r}var $w={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function x7(e,t,r){var n=st.find(e,"/!DocumentSummaryInformation");if(n&&n.size>0)try{var s=Aw(n,Fj,$w.DSI);for(var a in s)t[a]=s[a]}catch(c){if(r.WTF)throw c}var i=st.find(e,"/!SummaryInformation");if(i&&i.size>0)try{var o=Aw(i,Oj,$w.SI);for(var l in o)t[l]==null&&(t[l]=o[l])}catch(c){if(r.WTF)throw c}t.HeadingPairs&&t.TitlesOfParts&&(KA(t.HeadingPairs,t.TitlesOfParts,t,r),delete t.HeadingPairs,delete t.TitlesOfParts)}function RI(e,t){t||(t={}),xv(t),aA(),t.codepage&&Xx(t.codepage);var r,n;if(e.FullPaths){if(st.find(e,"/encryption"))throw new Error("File is password-protected");r=st.find(e,"!CompObj"),n=st.find(e,"/Workbook")||st.find(e,"/Book")}else{switch(t.type){case"base64":e=ss(An(e));break;case"binary":e=ss(e);break;case"buffer":break;case"array":Array.isArray(e)||(e=Array.prototype.slice.call(e));break}wr(e,0),n={content:e}}var s,a;if(r&&d7(r),t.bookProps&&!t.bookSheets)s={};else{var i=et?"buffer":"array";if(n&&n.content)s=g7(n.content,t);else if((a=st.find(e,"PerfectOffice_MAIN"))&&a.content)s=Nc.to_workbook(a.content,(t.type=i,t));else if((a=st.find(e,"NativeContent_MAIN"))&&a.content)s=Nc.to_workbook(a.content,(t.type=i,t));else throw(a=st.find(e,"MN0"))&&a.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");t.bookVBA&&e.FullPaths&&st.find(e,"/_VBA_PROJECT_CUR/VBA/dir")&&(s.vbaraw=rU(e))}var o={};return e.FullPaths&&x7(e,o,t),s.Props=s.Custprops=o,t.bookFiles&&(s.cfb=e),s}var fd={0:{f:JV},1:{f:rB},2:{f:fB},3:{f:iB},4:{f:sB},5:{f:uB},6:{f:mB},7:{f:lB},8:{f:yB},9:{f:vB},10:{f:gB},11:{f:xB},12:{f:nB},13:{f:hB},14:{f:oB},15:{f:aB},16:{f:SI},17:{f:pB},18:{f:cB},19:{f:iv},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:GB},40:{},42:{},43:{f:g9},44:{f:p9},45:{f:x9},46:{f:y9},47:{f:v9},48:{},49:{f:_j},50:{},51:{f:V9},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:aI},62:{f:dB},63:{f:H9},64:{f:CB},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:Gr,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:IB},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:tB},148:{f:ZV,p:16},151:{f:EB},152:{},153:{f:WB},154:{},155:{},156:{f:$B},157:{},158:{},159:{T:1,f:O5},160:{T:-1},161:{T:1,f:co},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:_B},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:U9},336:{T:-1},337:{f:B9,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:Mp},357:{},358:{},359:{},360:{T:1},361:{},362:{f:sI},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:TB},427:{f:kB},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:AB},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:eB},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:wB},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:Mp},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:Z9},633:{T:1},634:{T:-1},635:{T:1,f:J9},636:{T:-1},637:{f:Ej},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:FB},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:NB},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},Bp={6:{f:sm},10:{f:ba},12:{f:Jt},13:{f:Jt},14:{f:$t},15:{f:$t},16:{f:Vr},17:{f:$t},18:{f:$t},19:{f:Jt},20:{f:Rw},21:{f:Rw},23:{f:sI},24:{f:Pw},25:{f:$t},26:{},27:{},28:{f:Y8},29:{},34:{f:$t},35:{f:bw},38:{f:Vr},39:{f:Vr},40:{f:Vr},41:{f:Vr},42:{f:$t},43:{f:$t},47:{f:e9},49:{f:b8},51:{f:Jt},60:{},61:{f:C8},64:{f:$t},65:{f:R8},66:{f:Jt},77:{},80:{},81:{},82:{},85:{f:Jt},89:{},90:{},91:{},92:{f:_8},93:{f:J8},94:{},95:{f:$t},96:{},97:{},99:{f:$t},125:{f:aI},128:{f:B8},129:{f:w8},130:{f:Jt},131:{f:$t},132:{f:$t},133:{f:E8},134:{},140:{f:s5},141:{f:Jt},144:{},146:{f:i5},151:{},152:{},153:{},154:{},155:{},156:{f:Jt},157:{},158:{},160:{f:f5},161:{f:l5},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:L8},190:{f:j8},193:{f:ba},197:{},198:{},199:{},200:{},201:{},202:{f:$t},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:Jt},220:{},221:{f:$t},222:{},224:{f:V8},225:{f:y8},226:{f:ba},227:{},229:{f:Q8},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:T8},253:{f:P8},255:{f:k8},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:JA},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:$t},353:{f:ba},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:$8},431:{f:$t},432:{},433:{},434:{},437:{},438:{f:t5},439:{f:$t},440:{f:r5},441:{},442:{f:$u},443:{},444:{f:Jt},445:{},446:{},448:{f:ba},449:{f:I8,r:2},450:{f:ba},512:{f:Cw},513:{f:u5},515:{f:z8},516:{f:D8},517:{f:Nw},519:{f:h5},520:{f:S8},523:{},545:{f:Dw},549:{f:Iw},566:{},574:{f:N8},638:{f:M8},659:{},1048:{},1054:{f:F8},1084:{},1212:{f:K8},2048:{f:n5},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:Of},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:ba},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:o5,r:12},2173:{f:L9,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:$t,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:G8,r:12},2197:{},2198:{f:b9,r:12},2199:{},2200:{},2201:{},2202:{f:q8,r:12},2203:{f:ba},2204:{},2205:{},2206:{},2207:{},2211:{f:A8},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:Jt},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:c5},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:a5},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:Cw},1:{},2:{f:g5},3:{f:p5},4:{f:m5},5:{f:Nw},7:{f:x5},8:{},9:{f:Of},11:{},22:{f:Jt},30:{f:O8},31:{},32:{},33:{f:Dw},36:{},37:{f:Iw},50:{f:v5},62:{},52:{},67:{},68:{f:Jt},69:{},86:{},126:{},127:{f:d5},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:y5},223:{},234:{},354:{},421:{},518:{f:sm},521:{f:Of},536:{f:Pw},547:{f:bw},561:{},579:{},1030:{f:sm},1033:{f:Of},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function Jn(e,t,r,n){var s=t;if(!isNaN(s)){var a=(r||[]).length||0,i=e.next(4);i.write_shift(2,s),i.write_shift(2,a),a>0&&UA(r)&&e.push(r)}}function Ww(e,t){var r=t||{},n=r.dense?[]:{};e=e.replace(/<!--.*?-->/g,"");var s=e.match(/<table/i);if(!s)throw new Error("Invalid HTML: could not find <table>");var a=e.match(/<\/table/i),i=s.index,o=a&&a.index||e.length,l=z6(e.slice(i,o),/(:?<tr[^>]*>)/i,"<tr>"),c=-1,u=0,d=0,m=0,p={s:{r:1e7,c:1e7},e:{r:0,c:0}},x=[];for(i=0;i<l.length;++i){var g=l[i].trim(),_=g.slice(0,3).toLowerCase();if(_=="<tr"){if(++c,r.sheetRows&&r.sheetRows<=c){--c;break}u=0;continue}if(!(_!="<td"&&_!="<th")){var k=g.split(/<\/t[dh]>/i);for(o=0;o<k.length;++o){var T=k[o].trim();if(T.match(/<t[dh]/i)){for(var w=T,C=0;w.charAt(0)=="<"&&(C=w.indexOf(">"))>-1;)w=w.slice(C+1);for(var M=0;M<x.length;++M){var O=x[M];O.s.c==u&&O.s.r<c&&c<=O.e.r&&(u=O.e.c+1,M=-1)}var v=Oe(T.slice(0,T.indexOf(">")));m=v.colspan?+v.colspan:1,((d=+v.rowspan)>1||m>1)&&x.push({s:{r:c,c:u},e:{r:c+(d||1)-1,c:u+m-1}});var E=v.t||v["data-t"]||"";if(!w.length){u+=m;continue}if(w=AA(w),p.s.r>c&&(p.s.r=c),p.e.r<c&&(p.e.r=c),p.s.c>u&&(p.s.c=u),p.e.c<u&&(p.e.c=u),!w.length){u+=m;continue}var S={t:"s",v:w};r.raw||!w.trim().length||E=="s"||(w==="TRUE"?S={t:"b",v:!0}:w==="FALSE"?S={t:"b",v:!1}:isNaN(fs(w))?isNaN(gl(w).getDate())||(S={t:"d",v:gr(w)},r.cellDates||(S={t:"n",v:en(S.v)}),S.z=r.dateNF||$e[14]):S={t:"n",v:fs(w)}),r.dense?(n[c]||(n[c]=[]),n[c][u]=S):n[Be({r:c,c:u})]=S,u+=m}}}}return n["!ref"]=at(p),x.length&&(n["!merges"]=x),n}function v7(e,t,r,n){for(var s=e["!merges"]||[],a=[],i=t.s.c;i<=t.e.c;++i){for(var o=0,l=0,c=0;c<s.length;++c)if(!(s[c].s.r>r||s[c].s.c>i)&&!(s[c].e.r<r||s[c].e.c<i)){if(s[c].s.r<r||s[c].s.c<i){o=-1;break}o=s[c].e.r-s[c].s.r+1,l=s[c].e.c-s[c].s.c+1;break}if(!(o<0)){var u=Be({r,c:i}),d=n.dense?(e[r]||[])[i]:e[u],m=d&&d.v!=null&&(d.h||tv(d.w||(wa(d),d.w)||""))||"",p={};o>1&&(p.rowspan=o),l>1&&(p.colspan=l),n.editable?m='<span contenteditable="true">'+m+"</span>":d&&(p["data-t"]=d&&d.t||"z",d.v!=null&&(p["data-v"]=d.v),d.z!=null&&(p["data-z"]=d.z),d.l&&(d.l.Target||"#").charAt(0)!="#"&&(m='<a href="'+d.l.Target+'">'+m+"</a>")),p.id=(n.id||"sjs")+"-"+u,a.push(sj("td",m,p))}}var x="<tr>";return x+a.join("")+"</tr>"}var y7='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',_7="</body></html>";function w7(e,t){var r=e.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!r||r.length==0)throw new Error("Invalid HTML: could not find <table>");if(r.length==1)return yi(Ww(r[0],t),t);var n=yv();return r.forEach(function(s,a){_v(n,Ww(s,t),"Sheet"+(a+1))}),n}function E7(e,t,r){var n=[];return n.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function T7(e,t){var r=t||{},n=r.header!=null?r.header:y7,s=r.footer!=null?r.footer:_7,a=[n],i=Il(e["!ref"]);r.dense=Array.isArray(e),a.push(E7(e,i,r));for(var o=i.s.r;o<=i.e.r;++o)a.push(v7(e,i,o,r));return a.push("</table>"+s),a.join("")}function bI(e,t,r){var n=r||{},s=0,a=0;if(n.origin!=null)if(typeof n.origin=="number")s=n.origin;else{var i=typeof n.origin=="string"?Qr(n.origin):n.origin;s=i.r,a=i.c}var o=t.getElementsByTagName("tr"),l=Math.min(n.sheetRows||1e7,o.length),c={s:{r:0,c:0},e:{r:s,c:a}};if(e["!ref"]){var u=Il(e["!ref"]);c.s.r=Math.min(c.s.r,u.s.r),c.s.c=Math.min(c.s.c,u.s.c),c.e.r=Math.max(c.e.r,u.e.r),c.e.c=Math.max(c.e.c,u.e.c),s==-1&&(c.e.r=s=u.e.r+1)}var d=[],m=0,p=e["!rows"]||(e["!rows"]=[]),x=0,g=0,_=0,k=0,T=0,w=0;for(e["!cols"]||(e["!cols"]=[]);x<o.length&&g<l;++x){var C=o[x];if(Hw(C)){if(n.display)continue;p[g]={hidden:!0}}var M=C.children;for(_=k=0;_<M.length;++_){var O=M[_];if(!(n.display&&Hw(O))){var v=O.hasAttribute("data-v")?O.getAttribute("data-v"):O.hasAttribute("v")?O.getAttribute("v"):AA(O.innerHTML),E=O.getAttribute("data-z")||O.getAttribute("z");for(m=0;m<d.length;++m){var S=d[m];S.s.c==k+a&&S.s.r<g+s&&g+s<=S.e.r&&(k=S.e.c+1-a,m=-1)}w=+O.getAttribute("colspan")||1,((T=+O.getAttribute("rowspan")||1)>1||w>1)&&d.push({s:{r:g+s,c:k+a},e:{r:g+s+(T||1)-1,c:k+a+(w||1)-1}});var R={t:"s",v},P=O.getAttribute("data-t")||O.getAttribute("t")||"";v!=null&&(v.length==0?R.t=P||"z":n.raw||v.trim().length==0||P=="s"||(v==="TRUE"?R={t:"b",v:!0}:v==="FALSE"?R={t:"b",v:!1}:isNaN(fs(v))?isNaN(gl(v).getDate())||(R={t:"d",v:gr(v)},n.cellDates||(R={t:"n",v:en(R.v)}),R.z=n.dateNF||$e[14]):R={t:"n",v:fs(v)})),R.z===void 0&&E!=null&&(R.z=E);var D="",N=O.getElementsByTagName("A");if(N&&N.length)for(var ce=0;ce<N.length&&!(N[ce].hasAttribute("href")&&(D=N[ce].getAttribute("href"),D.charAt(0)!="#"));++ce);D&&D.charAt(0)!="#"&&(R.l={Target:D}),n.dense?(e[g+s]||(e[g+s]=[]),e[g+s][k+a]=R):e[Be({c:k+a,r:g+s})]=R,c.e.c<k+a&&(c.e.c=k+a),k+=w}}++g}return d.length&&(e["!merges"]=(e["!merges"]||[]).concat(d)),c.e.r=Math.max(c.e.r,g-1+s),e["!ref"]=at(c),g>=l&&(e["!fullref"]=at((c.e.r=o.length-x+g-1+s,c))),e}function PI(e,t){var r=t||{},n=r.dense?[]:{};return bI(n,e,t)}function k7(e,t){return yi(PI(e,t),t)}function Hw(e){var t="",r=S7(e);return r&&(t=r(e).getPropertyValue("display")),t||(t=e.style&&e.style.display),t==="none"}function S7(e){return e.ownerDocument.defaultView&&typeof e.ownerDocument.defaultView.getComputedStyle=="function"?e.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function A7(e){var t=e.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(n,s){return Array(parseInt(s,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),r=lt(t.replace(/<[^>]*>/g,""));return[r]}var Gw={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function DI(e,t){var r=t||{},n=rv(e),s=[],a,i,o={name:""},l="",c=0,u,d,m={},p=[],x=r.dense?[]:{},g,_,k={value:""},T="",w=0,C=[],M=-1,O=-1,v={s:{r:1e6,c:1e7},e:{r:0,c:0}},E=0,S={},R=[],P={},D=0,N=0,ce=[],oe=1,de=1,ge=[],Z={Names:[]},G={},ae=["",""],fe=[],B={},K="",q=0,W=!1,Q=!1,ue=0;for(fu.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");g=fu.exec(n);)switch(g[3]=g[3].replace(/_.*$/,"")){case"table":case"":g[1]==="/"?(v.e.c>=v.s.c&&v.e.r>=v.s.r?x["!ref"]=at(v):x["!ref"]="A1:A1",r.sheetRows>0&&r.sheetRows<=v.e.r&&(x["!fullref"]=x["!ref"],v.e.r=r.sheetRows-1,x["!ref"]=at(v)),R.length&&(x["!merges"]=R),ce.length&&(x["!rows"]=ce),u.name=u.||u.name,typeof JSON<"u"&&JSON.stringify(u),p.push(u.name),m[u.name]=x,Q=!1):g[0].charAt(g[0].length-2)!=="/"&&(u=Oe(g[0],!1),M=O=-1,v.s.r=v.s.c=1e7,v.e.r=v.e.c=0,x=r.dense?[]:{},R=[],ce=[],Q=!0);break;case"table-row-group":g[1]==="/"?--E:++E;break;case"table-row":case"":if(g[1]==="/"){M+=oe,oe=1;break}if(d=Oe(g[0],!1),d.?M=d.-1:M==-1&&(M=0),oe=+d["number-rows-repeated"]||1,oe<10)for(ue=0;ue<oe;++ue)E>0&&(ce[M+ue]={level:E});O=-1;break;case"covered-table-cell":g[1]!=="/"&&++O,r.sheetStubs&&(r.dense?(x[M]||(x[M]=[]),x[M][O]={t:"z"}):x[Be({r:M,c:O})]={t:"z"}),T="",C=[];break;case"table-cell":case"":if(g[0].charAt(g[0].length-2)==="/")++O,k=Oe(g[0],!1),de=parseInt(k["number-columns-repeated"]||"1",10),_={t:"z",v:null},k.formula&&r.cellFormula!=!1&&(_.f=Vw(lt(k.formula))),(k.||k["value-type"])=="string"&&(_.t="s",_.v=lt(k["string-value"]||""),r.dense?(x[M]||(x[M]=[]),x[M][O]=_):x[Be({r:M,c:O})]=_),O+=de-1;else if(g[1]!=="/"){++O,T="",w=0,C=[],de=1;var Ee=oe?M+oe-1:M;if(O>v.e.c&&(v.e.c=O),O<v.s.c&&(v.s.c=O),M<v.s.r&&(v.s.r=M),Ee>v.e.r&&(v.e.r=Ee),k=Oe(g[0],!1),fe=[],B={},_={t:k.||k["value-type"],v:null},r.cellFormula)if(k.formula&&(k.formula=lt(k.formula)),k["number-matrix-columns-spanned"]&&k["number-matrix-rows-spanned"]&&(D=parseInt(k["number-matrix-rows-spanned"],10)||0,N=parseInt(k["number-matrix-columns-spanned"],10)||0,P={s:{r:M,c:O},e:{r:M+D-1,c:O+N-1}},_.F=at(P),ge.push([P,_.F])),k.formula)_.f=Vw(k.formula);else for(ue=0;ue<ge.length;++ue)M>=ge[ue][0].s.r&&M<=ge[ue][0].e.r&&O>=ge[ue][0].s.c&&O<=ge[ue][0].e.c&&(_.F=ge[ue][1]);switch((k["number-columns-spanned"]||k["number-rows-spanned"])&&(D=parseInt(k["number-rows-spanned"],10)||0,N=parseInt(k["number-columns-spanned"],10)||0,P={s:{r:M,c:O},e:{r:M+D-1,c:O+N-1}},R.push(P)),k["number-columns-repeated"]&&(de=parseInt(k["number-columns-repeated"],10)),_.t){case"boolean":_.t="b",_.v=bt(k["boolean-value"]);break;case"float":_.t="n",_.v=parseFloat(k.value);break;case"percentage":_.t="n",_.v=parseFloat(k.value);break;case"currency":_.t="n",_.v=parseFloat(k.value);break;case"date":_.t="d",_.v=gr(k["date-value"]),r.cellDates||(_.t="n",_.v=en(_.v)),_.z="m/d/yy";break;case"time":_.t="n",_.v=U6(k["time-value"])/86400,r.cellDates&&(_.t="d",_.v=n0(_.v)),_.z="HH:MM:SS";break;case"number":_.t="n",_.v=parseFloat(k.);break;default:if(_.t==="string"||_.t==="text"||!_.t)_.t="s",k["string-value"]!=null&&(T=lt(k["string-value"]),C=[]);else throw new Error("Unsupported value type "+_.t)}}else{if(W=!1,_.t==="s"&&(_.v=T||"",C.length&&(_.R=C),W=w==0),G.Target&&(_.l=G),fe.length>0&&(_.c=fe,fe=[]),T&&r.cellText!==!1&&(_.w=T),W&&(_.t="z",delete _.v),(!W||r.sheetStubs)&&!(r.sheetRows&&r.sheetRows<=M))for(var _e=0;_e<oe;++_e){if(de=parseInt(k["number-columns-repeated"]||"1",10),r.dense)for(x[M+_e]||(x[M+_e]=[]),x[M+_e][O]=_e==0?_:Sr(_);--de>0;)x[M+_e][O+de]=Sr(_);else for(x[Be({r:M+_e,c:O})]=_;--de>0;)x[Be({r:M+_e,c:O+de})]=Sr(_);v.e.c<=O&&(v.e.c=O)}de=parseInt(k["number-columns-repeated"]||"1",10),O+=de-1,de=0,_={},T="",C=[]}G={};break;case"document":case"document-content":case"":case"spreadsheet":case"":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(g[1]==="/"){if((a=s.pop())[0]!==g[3])throw"Bad state: "+a}else g[0].charAt(g[0].length-2)!=="/"&&s.push([g[3],!0]);break;case"annotation":if(g[1]==="/"){if((a=s.pop())[0]!==g[3])throw"Bad state: "+a;B.t=T,C.length&&(B.R=C),B.a=K,fe.push(B)}else g[0].charAt(g[0].length-2)!=="/"&&s.push([g[3],!1]);K="",q=0,T="",w=0,C=[];break;case"creator":g[1]==="/"?K=n.slice(q,g.index):q=g.index+g[0].length;break;case"meta":case"":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(g[1]==="/"){if((a=s.pop())[0]!==g[3])throw"Bad state: "+a}else g[0].charAt(g[0].length-2)!=="/"&&s.push([g[3],!1]);T="",w=0,C=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(g[1]==="/"){if(S[o.name]=l,(a=s.pop())[0]!==g[3])throw"Bad state: "+a}else g[0].charAt(g[0].length-2)!=="/"&&(l="",o=Oe(g[0],!1),s.push([g[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(s[s.length-1][0]){case"time-style":case"date-style":i=Oe(g[0],!1),l+=Gw[g[3]][i.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(s[s.length-1][0]){case"time-style":case"date-style":i=Oe(g[0],!1),l+=Gw[g[3]][i.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(g[0].slice(-2)==="/>")break;if(g[1]==="/")switch(s[s.length-1][0]){case"number-style":case"date-style":case"time-style":l+=n.slice(c,g.index);break}else c=g.index+g[0].length;break;case"named-range":i=Oe(g[0],!1),ae=am(i["cell-range-address"]);var me={Name:i.name,Ref:ae[0]+"!"+ae[1]};Q&&(me.Sheet=p.length),Z.Names.push(me);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"":if(["master-styles"].indexOf(s[s.length-1][0])>-1)break;if(g[1]==="/"&&(!k||!k["string-value"])){var je=A7(n.slice(w,g.index));T=(T.length>0?T+`
`:"")+je[0]}else Oe(g[0],!1),w=g.index+g[0].length;break;case"s":break;case"database-range":if(g[1]==="/")break;try{ae=am(Oe(g[0])["target-range-address"]),m[ae[0]]["!autofilter"]={ref:ae[1]}}catch{}break;case"date":break;case"object":break;case"title":case"":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(g[1]!=="/"){if(G=Oe(g[0],!1),!G.href)break;G.Target=lt(G.href),delete G.href,G.Target.charAt(0)=="#"&&G.Target.indexOf(".")>-1?(ae=am(G.Target.slice(1)),G.Target="#"+ae[0]+"!"+ae[1]):G.Target.match(/^\.\.[\\\/]/)&&(G.Target=G.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(g[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case":":case":":break;default:if(r.WTF)throw new Error(g)}}var H={Sheets:m,SheetNames:p,Workbook:Z};return r.bookSheets&&delete H.Sheets,H}function Kw(e,t){t=t||{},On(e,"META-INF/manifest.xml")&&zj(Qt(e,"META-INF/manifest.xml"),t);var r=wn(e,"content.xml");if(!r)throw new Error("Missing content.xml in ODS / UOF file");var n=DI(Tt(r),t);return On(e,"meta.xml")&&(n.Props=GA(Qt(e,"meta.xml"))),n}function qw(e,t){return DI(e,t)}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function pv(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function zp(e){return typeof TextDecoder<"u"?new TextDecoder().decode(e):Tt(oo(e))}function $p(e){var t=e.reduce(function(s,a){return s+a.length},0),r=new Uint8Array(t),n=0;return e.forEach(function(s){r.set(s,n),n+=s.length}),r}function Xw(e){return e-=e>>1&1431655765,e=(e&858993459)+(e>>2&858993459),(e+(e>>4)&252645135)*16843009>>>24}function I7(e,t){for(var r=(e[t+15]&127)<<7|e[t+14]>>1,n=e[t+14]&1,s=t+13;s>=t;--s)n=n*256+e[s];return(e[t+15]&128?-n:n)*Math.pow(10,r-6176)}function pu(e,t){var r=t?t[0]:0,n=e[r]&127;e:if(e[r++]>=128&&(n|=(e[r]&127)<<7,e[r++]<128||(n|=(e[r]&127)<<14,e[r++]<128)||(n|=(e[r]&127)<<21,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,28),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,35),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,42),++r,e[r++]<128)))break e;return t&&(t[0]=r),n}function cr(e){var t=0,r=e[t]&127;e:if(e[t++]>=128){if(r|=(e[t]&127)<<7,e[t++]<128||(r|=(e[t]&127)<<14,e[t++]<128)||(r|=(e[t]&127)<<21,e[t++]<128))break e;r|=(e[t]&127)<<28}return r}function Br(e){for(var t=[],r=[0];r[0]<e.length;){var n=r[0],s=pu(e,r),a=s&7;s=Math.floor(s/8);var i=0,o;if(s==0)break;switch(a){case 0:{for(var l=r[0];e[r[0]++]>=128;);o=e.slice(l,r[0])}break;case 5:i=4,o=e.slice(r[0],r[0]+i),r[0]+=i;break;case 1:i=8,o=e.slice(r[0],r[0]+i),r[0]+=i;break;case 2:i=pu(e,r),o=e.slice(r[0],r[0]+i),r[0]+=i;break;case 3:case 4:default:throw new Error("PB Type ".concat(a," for Field ").concat(s," at offset ").concat(n))}var c={data:o,type:a};t[s]==null?t[s]=[c]:t[s].push(c)}return t}function gv(e,t){return(e==null?void 0:e.map(function(r){return t(r.data)}))||[]}function C7(e){for(var t,r=[],n=[0];n[0]<e.length;){var s=pu(e,n),a=Br(e.slice(n[0],n[0]+s));n[0]+=s;var i={id:cr(a[1][0].data),messages:[]};a[2].forEach(function(o){var l=Br(o.data),c=cr(l[3][0].data);i.messages.push({meta:l,data:e.slice(n[0],n[0]+c)}),n[0]+=c}),(t=a[3])!=null&&t[0]&&(i.merge=cr(a[3][0].data)>>>0>0),r.push(i)}return r}function N7(e,t){if(e!=0)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var r=[0],n=pu(t,r),s=[];r[0]<t.length;){var a=t[r[0]]&3;if(a==0){var i=t[r[0]++]>>2;if(i<60)++i;else{var o=i-59;i=t[r[0]],o>1&&(i|=t[r[0]+1]<<8),o>2&&(i|=t[r[0]+2]<<16),o>3&&(i|=t[r[0]+3]<<24),i>>>=0,i++,r[0]+=o}s.push(t.slice(r[0],r[0]+i)),r[0]+=i;continue}else{var l=0,c=0;if(a==1?(c=(t[r[0]]>>2&7)+4,l=(t[r[0]++]&224)<<3,l|=t[r[0]++]):(c=(t[r[0]++]>>2)+1,a==2?(l=t[r[0]]|t[r[0]+1]<<8,r[0]+=2):(l=(t[r[0]]|t[r[0]+1]<<8|t[r[0]+2]<<16|t[r[0]+3]<<24)>>>0,r[0]+=4)),s=[$p(s)],l==0)throw new Error("Invalid offset 0");if(l>s[0].length)throw new Error("Invalid offset beyond length");if(c>=l)for(s.push(s[0].slice(-l)),c-=l;c>=s[s.length-1].length;)s.push(s[s.length-1]),c-=s[s.length-1].length;s.push(s[0].slice(-l,-l+c))}}var u=$p(s);if(u.length!=n)throw new Error("Unexpected length: ".concat(u.length," != ").concat(n));return u}function R7(e){for(var t=[],r=0;r<e.length;){var n=e[r++],s=e[r]|e[r+1]<<8|e[r+2]<<16;r+=3,t.push(N7(n,e.slice(r,r+s))),r+=s}if(r!==e.length)throw new Error("data is not a valid framed stream!");return $p(t)}function b7(e,t,r,n){var s=pv(e),a=s.getUint32(4,!0),i=(n>1?12:8)+Xw(a&(n>1?3470:398))*4,o=-1,l=-1,c=NaN,u=new Date(2001,0,1);a&512&&(o=s.getUint32(i,!0),i+=4),i+=Xw(a&(n>1?12288:4096))*4,a&16&&(l=s.getUint32(i,!0),i+=4),a&32&&(c=s.getFloat64(i,!0),i+=8),a&64&&(u.setTime(u.getTime()+s.getFloat64(i,!0)*1e3),i+=8);var d;switch(e[2]){case 0:break;case 2:d={t:"n",v:c};break;case 3:d={t:"s",v:t[l]};break;case 5:d={t:"d",v:u};break;case 6:d={t:"b",v:c>0};break;case 7:d={t:"n",v:c/86400};break;case 8:d={t:"e",v:0};break;case 9:if(o>-1)d={t:"s",v:r[o]};else if(l>-1)d={t:"s",v:t[l]};else if(!isNaN(c))d={t:"n",v:c};else throw new Error("Unsupported cell type ".concat(e.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(e.slice(0,4)))}return d}function P7(e,t,r){var n=pv(e),s=n.getUint32(8,!0),a=12,i=-1,o=-1,l=NaN,c=NaN,u=new Date(2001,0,1);s&1&&(l=I7(e,a),a+=16),s&2&&(c=n.getFloat64(a,!0),a+=8),s&4&&(u.setTime(u.getTime()+n.getFloat64(a,!0)*1e3),a+=8),s&8&&(o=n.getUint32(a,!0),a+=4),s&16&&(i=n.getUint32(a,!0),a+=4);var d;switch(e[1]){case 0:break;case 2:d={t:"n",v:l};break;case 3:d={t:"s",v:t[o]};break;case 5:d={t:"d",v:u};break;case 6:d={t:"b",v:c>0};break;case 7:d={t:"n",v:c/86400};break;case 8:d={t:"e",v:0};break;case 9:if(i>-1)d={t:"s",v:r[i]};else throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(s&31," : ").concat(e.slice(0,4)));break;case 10:d={t:"n",v:l};break;default:throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(s&31," : ").concat(e.slice(0,4)))}return d}function D7(e,t,r){switch(e[0]){case 0:case 1:case 2:case 3:return b7(e,t,r,e[0]);case 5:return P7(e,t,r);default:throw new Error("Unsupported payload version ".concat(e[0]))}}function si(e){var t=Br(e);return pu(t[1][0].data)}function Yw(e,t){var r=Br(t.data),n=cr(r[1][0].data),s=r[3],a=[];return(s||[]).forEach(function(i){var o=Br(i.data),l=cr(o[1][0].data)>>>0;switch(n){case 1:a[l]=zp(o[3][0].data);break;case 8:{var c=e[si(o[9][0].data)][0],u=Br(c.data),d=e[si(u[1][0].data)][0],m=cr(d.meta[1][0].data);if(m!=2001)throw new Error("2000 unexpected reference to ".concat(m));var p=Br(d.data);a[l]=p[3].map(function(x){return zp(x.data)}).join("")}break}}),a}function F7(e,t){var r,n,s,a,i,o,l,c,u,d,m,p,x,g,_=Br(e),k=cr(_[1][0].data)>>>0,T=cr(_[2][0].data)>>>0,w=((n=(r=_[8])==null?void 0:r[0])==null?void 0:n.data)&&cr(_[8][0].data)>0||!1,C,M;if((a=(s=_[7])==null?void 0:s[0])!=null&&a.data&&t!=0)C=(o=(i=_[7])==null?void 0:i[0])==null?void 0:o.data,M=(c=(l=_[6])==null?void 0:l[0])==null?void 0:c.data;else if((d=(u=_[4])==null?void 0:u[0])!=null&&d.data&&t!=1)C=(p=(m=_[4])==null?void 0:m[0])==null?void 0:p.data,M=(g=(x=_[3])==null?void 0:x[0])==null?void 0:g.data;else throw"NUMBERS Tile missing ".concat(t," cell storage");for(var O=w?4:1,v=pv(C),E=[],S=0;S<C.length/2;++S){var R=v.getUint16(S*2,!0);R<65535&&E.push([S,R])}if(E.length!=T)throw"Expected ".concat(T," cells, found ").concat(E.length);var P=[];for(S=0;S<E.length-1;++S)P[E[S][0]]=M.subarray(E[S][1]*O,E[S+1][1]*O);return E.length>=1&&(P[E[E.length-1][0]]=M.subarray(E[E.length-1][1]*O)),{R:k,cells:P}}function O7(e,t){var r,n=Br(t.data),s=(r=n==null?void 0:n[7])!=null&&r[0]?cr(n[7][0].data)>>>0>0?1:0:-1,a=gv(n[5],function(i){return F7(i,s)});return{nrows:cr(n[4][0].data)>>>0,data:a.reduce(function(i,o){return i[o.R]||(i[o.R]=[]),o.cells.forEach(function(l,c){if(i[o.R][c])throw new Error("Duplicate cell r=".concat(o.R," c=").concat(c));i[o.R][c]=l}),i},[])}}function M7(e,t,r){var n,s=Br(t.data),a={s:{r:0,c:0},e:{r:0,c:0}};if(a.e.r=(cr(s[6][0].data)>>>0)-1,a.e.r<0)throw new Error("Invalid row varint ".concat(s[6][0].data));if(a.e.c=(cr(s[7][0].data)>>>0)-1,a.e.c<0)throw new Error("Invalid col varint ".concat(s[7][0].data));r["!ref"]=at(a);var i=Br(s[4][0].data),o=Yw(e,e[si(i[4][0].data)][0]),l=(n=i[17])!=null&&n[0]?Yw(e,e[si(i[17][0].data)][0]):[],c=Br(i[3][0].data),u=0;c[1].forEach(function(d){var m=Br(d.data),p=e[si(m[2][0].data)][0],x=cr(p.meta[1][0].data);if(x!=6002)throw new Error("6001 unexpected reference to ".concat(x));var g=O7(e,p);g.data.forEach(function(_,k){_.forEach(function(T,w){var C=Be({r:u+k,c:w}),M=D7(T,o,l);M&&(r[C]=M)})}),u+=g.nrows})}function L7(e,t){var r=Br(t.data),n={"!ref":"A1"},s=e[si(r[2][0].data)],a=cr(s[0].meta[1][0].data);if(a!=6001)throw new Error("6000 unexpected reference to ".concat(a));return M7(e,s[0],n),n}function j7(e,t){var r,n=Br(t.data),s={name:(r=n[1])!=null&&r[0]?zp(n[1][0].data):"",sheets:[]},a=gv(n[2],si);return a.forEach(function(i){e[i].forEach(function(o){var l=cr(o.meta[1][0].data);l==6e3&&s.sheets.push(L7(e,o))})}),s}function U7(e,t){var r=yv(),n=Br(t.data),s=gv(n[1],si);if(s.forEach(function(a){e[a].forEach(function(i){var o=cr(i.meta[1][0].data);if(o==2){var l=j7(e,i);l.sheets.forEach(function(c,u){_v(r,c,u==0?l.name:l.name+"_"+u,!0)})}})}),r.SheetNames.length==0)throw new Error("Empty NUMBERS file");return r}function om(e){var t,r,n,s,a={},i=[];if(e.FullPaths.forEach(function(l){if(l.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),e.FileIndex.forEach(function(l){if(l.name.match(/\.iwa$/)){var c;try{c=R7(l.content)}catch(d){return console.log("?? "+l.content.length+" "+(d.message||d))}var u;try{u=C7(c)}catch(d){return console.log("## "+(d.message||d))}u.forEach(function(d){a[d.id]=d.messages,i.push(d.id)})}}),!i.length)throw new Error("File has no messages");var o=((s=(n=(r=(t=a==null?void 0:a[1])==null?void 0:t[0])==null?void 0:r.meta)==null?void 0:n[1])==null?void 0:s[0].data)&&cr(a[1][0].meta[1][0].data)==1&&a[1][0];if(o||i.forEach(function(l){a[l].forEach(function(c){var u=cr(c.meta[1][0].data)>>>0;if(u==1)if(!o)o=c;else throw new Error("Document has multiple roots")})}),!o)throw new Error("Cannot find Document root");return U7(a,o)}function V7(e){return function(r){for(var n=0;n!=e.length;++n){var s=e[n];r[s[0]]===void 0&&(r[s[0]]=s[1]),s[2]==="n"&&(r[s[0]]=Number(r[s[0]]))}}}function xv(e){V7([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(e)}function B7(e){return jo.WS.indexOf(e)>-1?"sheet":e==jo.CS?"chart":e==jo.DS?"dialog":e==jo.MS?"macro":e&&e.length?e:"sheet"}function z7(e,t){if(!e)return 0;try{e=t.map(function(n){return n.id||(n.id=n.strRelID),[n.name,e["!id"][n.id].Target,B7(e["!id"][n.id].Type)]})}catch{return null}return!e||e.length===0?null:e}function $7(e,t,r,n,s,a,i,o,l,c,u,d){try{a[n]=Ic(wn(e,r,!0),t);var m=Qt(e,t),p;switch(o){case"sheet":p=XB(m,t,s,l,a[n],c,u,d);break;case"chart":if(p=YB(m,t,s,l,a[n],c,u,d),!p||!p["!drawel"])break;var x=oc(p["!drawel"].Target,t),g=Lp(x),_=q9(wn(e,x,!0),Ic(wn(e,g,!0),x)),k=oc(_,x),T=Lp(k);p=PB(wn(e,k,!0),k,l,Ic(wn(e,T,!0),k),c,p);break;case"macro":p=QB(m,t,s,l,a[n],c,u,d);break;case"dialog":p=JB(m,t,s,l,a[n],c,u,d);break;default:throw new Error("Unrecognized sheet type "+o)}i[n]=p;var w=[];a&&a[n]&&Fs(a[n]).forEach(function(C){var M="";if(a[n][C].Type==jo.CMNT){M=oc(a[n][C].Target,t);var O=r7(Qt(e,M,!0),M,l);if(!O||!O.length)return;Ow(p,O,!1)}a[n][C].Type==jo.TCMNT&&(M=oc(a[n][C].Target,t),w=w.concat(Y9(Qt(e,M,!0),l)))}),w&&w.length&&Ow(p,w,!0,l.people||[])}catch(C){if(l.WTF)throw C}}function Dn(e){return e.charAt(0)=="/"?e.slice(1):e}function W7(e,t){if(xA(),t=t||{},xv(t),On(e,"META-INF/manifest.xml")||On(e,"objectdata.xml"))return Kw(e,t);if(On(e,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof om<"u"){if(e.FileIndex)return om(e);var r=st.utils.cfb_new();return lw(e).forEach(function(ce){H6(r,ce,W6(e,ce))}),om(r)}throw new Error("Unsupported NUMBERS file")}if(!On(e,"[Content_Types].xml"))throw On(e,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):On(e,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var n=lw(e),s=Vj(wn(e,"[Content_Types].xml")),a=!1,i,o;if(s.workbooks.length===0&&(o="xl/workbook.xml",Qt(e,o,!0)&&s.workbooks.push(o)),s.workbooks.length===0){if(o="xl/workbook.bin",!Qt(e,o,!0))throw new Error("Could not find workbook");s.workbooks.push(o),a=!0}s.workbooks[0].slice(-3)=="bin"&&(a=!0);var l={},c={};if(!t.bookSheets&&!t.bookProps){if(Rc=[],s.sst)try{Rc=t7(Qt(e,Dn(s.sst)),s.sst,t)}catch(ce){if(t.WTF)throw ce}t.cellStyles&&s.themes.length&&(l=e7(wn(e,s.themes[0].replace(/^\//,""),!0)||"",s.themes[0],t)),s.style&&(c=ZB(Qt(e,Dn(s.style)),s.style,l,t))}s.links.map(function(ce){try{var oe=Ic(wn(e,Lp(Dn(ce))),ce);return s7(Qt(e,Dn(ce)),oe,ce,t)}catch{}});var u=qB(Qt(e,Dn(s.workbooks[0])),s.workbooks[0],t),d={},m="";s.coreprops.length&&(m=Qt(e,Dn(s.coreprops[0]),!0),m&&(d=GA(m)),s.extprops.length!==0&&(m=Qt(e,Dn(s.extprops[0]),!0),m&&Hj(m,d,t)));var p={};(!t.bookSheets||t.bookProps)&&s.custprops.length!==0&&(m=wn(e,Dn(s.custprops[0]),!0),m&&(p=Kj(m,t)));var x={};if((t.bookSheets||t.bookProps)&&(u.Sheets?i=u.Sheets.map(function(oe){return oe.name}):d.Worksheets&&d.SheetNames.length>0&&(i=d.SheetNames),t.bookProps&&(x.Props=d,x.Custprops=p),t.bookSheets&&typeof i<"u"&&(x.SheetNames=i),t.bookSheets?x.SheetNames:t.bookProps))return x;i={};var g={};t.bookDeps&&s.calcchain&&(g=n7(Qt(e,Dn(s.calcchain)),s.calcchain));var _=0,k={},T,w;{var C=u.Sheets;d.Worksheets=C.length,d.SheetNames=[];for(var M=0;M!=C.length;++M)d.SheetNames[M]=C[M].name}var O=a?"bin":"xml",v=s.workbooks[0].lastIndexOf("/"),E=(s.workbooks[0].slice(0,v+1)+"_rels/"+s.workbooks[0].slice(v+1)+".rels").replace(/^\//,"");On(e,E)||(E="xl/_rels/workbook."+O+".rels");var S=Ic(wn(e,E,!0),E.replace(/_rels.*/,"s5s"));(s.metadata||[]).length>=1&&(t.xlmeta=a7(Qt(e,Dn(s.metadata[0])),s.metadata[0],t)),(s.people||[]).length>=1&&(t.people=Q9(Qt(e,Dn(s.people[0])),t)),S&&(S=z7(S,u.Sheets));var R=Qt(e,"xl/worksheets/sheet.xml",!0)?1:0;e:for(_=0;_!=d.Worksheets;++_){var P="sheet";if(S&&S[_]?(T="xl/"+S[_][1].replace(/[\/]?xl\//,""),On(e,T)||(T=S[_][1]),On(e,T)||(T=E.replace(/_rels\/.*$/,"")+S[_][1]),P=S[_][2]):(T="xl/worksheets/sheet"+(_+1-R)+"."+O,T=T.replace(/sheet0\./,"sheet.")),w=T.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),t&&t.sheets!=null)switch(typeof t.sheets){case"number":if(_!=t.sheets)continue e;break;case"string":if(d.SheetNames[_].toLowerCase()!=t.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(t.sheets)){for(var D=!1,N=0;N!=t.sheets.length;++N)typeof t.sheets[N]=="number"&&t.sheets[N]==_&&(D=1),typeof t.sheets[N]=="string"&&t.sheets[N].toLowerCase()==d.SheetNames[_].toLowerCase()&&(D=1);if(!D)continue e}}$7(e,T,w,d.SheetNames[_],_,k,i,P,t,u,l,c)}return x={Directory:s,Workbook:u,Props:d,Custprops:p,Deps:g,Sheets:i,SheetNames:d.SheetNames,Strings:Rc,Styles:c,Themes:l,SSF:Sr($e)},t&&t.bookFiles&&(e.files?(x.keys=n,x.files=e.files):(x.keys=[],x.files={},e.FullPaths.forEach(function(ce,oe){ce=ce.replace(/^Root Entry[\/]/,""),x.keys.push(ce),x.files[ce]=e.FileIndex[oe]}))),t&&t.bookVBA&&(s.vba.length>0?x.vbaraw=Qt(e,Dn(s.vba[0]),!0):s.defaults&&s.defaults.bin===tU&&(x.vbaraw=Qt(e,"xl/vbaProject.bin",!0))),x}function H7(e,t){var r=t||{},n="Workbook",s=st.find(e,n);try{if(n="/!DataSpaces/Version",s=st.find(e,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(L5(s.content),n="/!DataSpaces/DataSpaceMap",s=st.find(e,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);var a=U5(s.content);if(a.length!==1||a[0].comps.length!==1||a[0].comps[0].t!==0||a[0].name!=="StrongEncryptionDataSpace"||a[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",s=st.find(e,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);var i=V5(s.content);if(i.length!=1||i[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",s=st.find(e,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);z5(s.content)}catch{}if(n="/EncryptionInfo",s=st.find(e,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);var o=$5(s.content);if(n="/EncryptedPackage",s=st.find(e,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(o[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(o[1],s.content,r.password||"",r);if(o[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(o[1],s.content,r.password||"",r);throw new Error("File is password-protected")}function vv(e,t){var r="";switch((t||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":r=An(e.slice(0,12));break;case"binary":r=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(t&&t.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function G7(e,t){return st.find(e,"EncryptedPackage")?H7(e,t):RI(e,t)}function K7(e,t){var r,n=e,s=t||{};return s.type||(s.type=et&&Buffer.isBuffer(e)?"buffer":"base64"),r=TA(n,s),W7(r,s)}function FI(e,t){var r=0;e:for(;r<e.length;)switch(e.charCodeAt(r)){case 10:case 13:case 32:++r;break;case 60:return Vp(e.slice(r),t);default:break e}return hu.to_workbook(e,t)}function q7(e,t){var r="",n=vv(e,t);switch(t.type){case"base64":r=An(e);break;case"binary":r=e;break;case"buffer":r=e.toString("binary");break;case"array":r=Ji(e);break;default:throw new Error("Unrecognized type "+t.type)}return n[0]==239&&n[1]==187&&n[2]==191&&(r=Tt(r)),t.type="binary",FI(r,t)}function X7(e,t){var r=e;return t.type=="base64"&&(r=An(r)),r=lu.utils.decode(1200,r.slice(2),"str"),t.type="binary",FI(r,t)}function Y7(e){return e.match(/[^\x00-\x7F]/)?lc(e):e}function lm(e,t,r,n){return n?(r.type="string",hu.to_workbook(e,r)):hu.to_workbook(t,r)}function Wp(e,t){aA();var r=t||{};if(typeof ArrayBuffer<"u"&&e instanceof ArrayBuffer)return Wp(new Uint8Array(e),(r=Sr(r),r.type="array",r));typeof Uint8Array<"u"&&e instanceof Uint8Array&&!r.type&&(r.type=typeof Deno<"u"?"buffer":"array");var n=e,s=[0,0,0,0],a=!1;if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),Jo={},r.dateNF&&(Jo.dateNF=r.dateNF),r.type||(r.type=et&&Buffer.isBuffer(e)?"buffer":"base64"),r.type=="file"&&(r.type=et?"buffer":"binary",n=L6(e),typeof Uint8Array<"u"&&!et&&(r.type="array")),r.type=="string"&&(a=!0,r.type="binary",r.codepage=65001,n=Y7(e)),r.type=="array"&&typeof Uint8Array<"u"&&e instanceof Uint8Array&&typeof ArrayBuffer<"u"){var i=new ArrayBuffer(3),o=new Uint8Array(i);if(o.foo="bar",!o.foo)return r=Sr(r),r.type="array",Wp(Yx(n),r)}switch((s=vv(n,r))[0]){case 208:if(s[1]===207&&s[2]===17&&s[3]===224&&s[4]===161&&s[5]===177&&s[6]===26&&s[7]===225)return G7(st.read(n,r),r);break;case 9:if(s[1]<=8)return RI(n,r);break;case 60:return Vp(n,r);case 73:if(s[1]===73&&s[2]===42&&s[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(s[1]===68)return k5(n,r);break;case 84:if(s[1]===65&&s[2]===66&&s[3]===76)return E5.to_workbook(n,r);break;case 80:return s[1]===75&&s[2]<9&&s[3]<9?K7(n,r):lm(e,n,r,a);case 239:return s[3]===60?Vp(n,r):lm(e,n,r,a);case 255:if(s[1]===254)return X7(n,r);if(s[1]===0&&s[2]===2&&s[3]===0)return Nc.to_workbook(n,r);break;case 0:if(s[1]===0&&(s[2]>=2&&s[3]===0||s[2]===0&&(s[3]===8||s[3]===9)))return Nc.to_workbook(n,r);break;case 3:case 131:case 139:case 140:return Fw.to_workbook(n,r);case 123:if(s[1]===92&&s[2]===114&&s[3]===116)return t9.to_workbook(n,r);break;case 10:case 13:case 32:return q7(n,r);case 137:if(s[1]===80&&s[2]===78&&s[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return _5.indexOf(s[0])>-1&&s[2]<=12&&s[3]<=31?Fw.to_workbook(n,r):lm(e,n,r,a)}function Q7(e,t,r,n,s,a,i,o){var l=Ar(r),c=o.defval,u=o.raw||!Object.prototype.hasOwnProperty.call(o,"raw"),d=!0,m=s===1?[]:{};if(s!==1)if(Object.defineProperty)try{Object.defineProperty(m,"__rowNum__",{value:r,enumerable:!1})}catch{m.__rowNum__=r}else m.__rowNum__=r;if(!i||e[r])for(var p=t.s.c;p<=t.e.c;++p){var x=i?e[r][p]:e[n[p]+l];if(x===void 0||x.t===void 0){if(c===void 0)continue;a[p]!=null&&(m[a[p]]=c);continue}var g=x.v;switch(x.t){case"z":if(g==null)break;continue;case"e":g=g==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+x.t)}if(a[p]!=null){if(g==null)if(x.t=="e"&&g===null)m[a[p]]=null;else if(c!==void 0)m[a[p]]=c;else if(u&&g===null)m[a[p]]=null;else continue;else m[a[p]]=u&&(x.t!=="n"||x.t==="n"&&o.rawNumbers!==!1)?g:wa(x,g,o);g!=null&&(d=!1)}}return{row:m,isempty:d}}function Hp(e,t){if(e==null||e["!ref"]==null)return[];var r={t:"n",v:0},n=0,s=1,a=[],i=0,o="",l={s:{r:0,c:0},e:{r:0,c:0}},c=t||{},u=c.range!=null?c.range:e["!ref"];switch(c.header===1?n=1:c.header==="A"?n=2:Array.isArray(c.header)?n=3:c.header==null&&(n=0),typeof u){case"string":l=zt(u);break;case"number":l=zt(e["!ref"]),l.s.r=u;break;default:l=u}n>0&&(s=0);var d=Ar(l.s.r),m=[],p=[],x=0,g=0,_=Array.isArray(e),k=l.s.r,T=0,w={};_&&!e[k]&&(e[k]=[]);var C=c.skipHidden&&e["!cols"]||[],M=c.skipHidden&&e["!rows"]||[];for(T=l.s.c;T<=l.e.c;++T)if(!(C[T]||{}).hidden)switch(m[T]=ir(T),r=_?e[k][T]:e[m[T]+d],n){case 1:a[T]=T-l.s.c;break;case 2:a[T]=m[T];break;case 3:a[T]=c.header[T-l.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),o=i=wa(r,null,c),g=w[i]||0,!g)w[i]=1;else{do o=i+"_"+g++;while(w[o]);w[i]=g,w[o]=1}a[T]=o}for(k=l.s.r+s;k<=l.e.r;++k)if(!(M[k]||{}).hidden){var O=Q7(e,l,k,m,n,a,_,c);(O.isempty===!1||(n===1?c.blankrows!==!1:c.blankrows))&&(p[x++]=O.row)}return p.length=x,p}var Qw=/"/g;function J7(e,t,r,n,s,a,i,o){for(var l=!0,c=[],u="",d=Ar(r),m=t.s.c;m<=t.e.c;++m)if(n[m]){var p=o.dense?(e[r]||[])[m]:e[n[m]+d];if(p==null)u="";else if(p.v!=null){l=!1,u=""+(o.rawNumbers&&p.t=="n"?p.v:wa(p,null,o));for(var x=0,g=0;x!==u.length;++x)if((g=u.charCodeAt(x))===s||g===a||g===34||o.forceQuotes){u='"'+u.replace(Qw,'""')+'"';break}u=="ID"&&(u='"ID"')}else p.f!=null&&!p.F?(l=!1,u="="+p.f,u.indexOf(",")>=0&&(u='"'+u.replace(Qw,'""')+'"')):u="";c.push(u)}return o.blankrows===!1&&l?null:c.join(i)}function OI(e,t){var r=[],n=t??{};if(e==null||e["!ref"]==null)return"";var s=zt(e["!ref"]),a=n.FS!==void 0?n.FS:",",i=a.charCodeAt(0),o=n.RS!==void 0?n.RS:`
`,l=o.charCodeAt(0),c=new RegExp((a=="|"?"\\|":a)+"+$"),u="",d=[];n.dense=Array.isArray(e);for(var m=n.skipHidden&&e["!cols"]||[],p=n.skipHidden&&e["!rows"]||[],x=s.s.c;x<=s.e.c;++x)(m[x]||{}).hidden||(d[x]=ir(x));for(var g=0,_=s.s.r;_<=s.e.r;++_)(p[_]||{}).hidden||(u=J7(e,s,_,d,i,l,a,n),u!=null&&(n.strip&&(u=u.replace(c,"")),(u||n.blankrows!==!1)&&r.push((g++?o:"")+u)));return delete n.dense,r.join("")}function Z7(e,t){t||(t={}),t.FS="	",t.RS=`
`;var r=OI(e,t);return r}function ez(e){var t="",r,n="";if(e==null||e["!ref"]==null)return[];var s=zt(e["!ref"]),a="",i=[],o,l=[],c=Array.isArray(e);for(o=s.s.c;o<=s.e.c;++o)i[o]=ir(o);for(var u=s.s.r;u<=s.e.r;++u)for(a=Ar(u),o=s.s.c;o<=s.e.c;++o)if(t=i[o]+a,r=c?(e[u]||[])[o]:e[t],n="",r!==void 0){if(r.F!=null){if(t=r.F,!r.f)continue;n=r.f,t.indexOf(":")==-1&&(t=t+":"+t)}if(r.f!=null)n=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)n=""+r.v;else if(r.t=="b")n=r.v?"TRUE":"FALSE";else if(r.w!==void 0)n="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?n="'"+r.v:n=""+r.v}}l[l.length]=t+"="+n}return l}function MI(e,t,r){var n=r||{},s=+!n.skipHeader,a=e||{},i=0,o=0;if(a&&n.origin!=null)if(typeof n.origin=="number")i=n.origin;else{var l=typeof n.origin=="string"?Qr(n.origin):n.origin;i=l.r,o=l.c}var c,u={s:{c:0,r:0},e:{c:o,r:i+t.length-1+s}};if(a["!ref"]){var d=zt(a["!ref"]);u.e.c=Math.max(u.e.c,d.e.c),u.e.r=Math.max(u.e.r,d.e.r),i==-1&&(i=d.e.r+1,u.e.r=i+t.length-1+s)}else i==-1&&(i=0,u.e.r=t.length-1+s);var m=n.header||[],p=0;t.forEach(function(g,_){Fs(g).forEach(function(k){(p=m.indexOf(k))==-1&&(m[p=m.length]=k);var T=g[k],w="z",C="",M=Be({c:o+p,r:i+_+s});c=gu(a,M),T&&typeof T=="object"&&!(T instanceof Date)?a[M]=T:(typeof T=="number"?w="n":typeof T=="boolean"?w="b":typeof T=="string"?w="s":T instanceof Date?(w="d",n.cellDates||(w="n",T=en(T)),C=n.dateNF||$e[14]):T===null&&n.nullError&&(w="e",T=0),c?(c.t=w,c.v=T,delete c.w,delete c.R,C&&(c.z=C)):a[M]=c={t:w,v:T},C&&(c.z=C))})}),u.e.c=Math.max(u.e.c,o+m.length-1);var x=Ar(i);if(s)for(p=0;p<m.length;++p)a[ir(p+o)+x]={t:"s",v:m[p]};return a["!ref"]=at(u),a}function tz(e,t){return MI(null,e,t)}function gu(e,t,r){if(typeof t=="string"){if(Array.isArray(e)){var n=Qr(t);return e[n.r]||(e[n.r]=[]),e[n.r][n.c]||(e[n.r][n.c]={t:"z"})}return e[t]||(e[t]={t:"z"})}return typeof t!="number"?gu(e,Be(t)):gu(e,Be({r:t,c:r||0}))}function rz(e,t){if(typeof t=="number"){if(t>=0&&e.SheetNames.length>t)return t;throw new Error("Cannot find sheet # "+t)}else if(typeof t=="string"){var r=e.SheetNames.indexOf(t);if(r>-1)return r;throw new Error("Cannot find sheet name |"+t+"|")}else throw new Error("Cannot find sheet |"+t+"|")}function yv(){return{SheetNames:[],Sheets:{}}}function _v(e,t,r,n){var s=1;if(!r)for(;s<=65535&&e.SheetNames.indexOf(r="Sheet"+s)!=-1;++s,r=void 0);if(!r||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&e.SheetNames.indexOf(r)>=0){var a=r.match(/(^.*?)(\d+)$/);s=a&&+a[2]||0;var i=a&&a[1]||r;for(++s;s<=65535&&e.SheetNames.indexOf(r=i+s)!=-1;++s);}if(VB(r),e.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return e.SheetNames.push(r),e.Sheets[r]=t,r}function nz(e,t,r){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var n=rz(e,t);switch(e.Workbook.Sheets[n]||(e.Workbook.Sheets[n]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}e.Workbook.Sheets[n].Hidden=r}function sz(e,t){return e.z=t,e}function LI(e,t,r){return t?(e.l={Target:t},r&&(e.l.Tooltip=r)):delete e.l,e}function az(e,t,r){return LI(e,"#"+t,r)}function iz(e,t,r){e.c||(e.c=[]),e.c.push({t,a:r||"SheetJS"})}function oz(e,t,r,n){for(var s=typeof t!="string"?t:zt(t),a=typeof t=="string"?t:at(t),i=s.s.r;i<=s.e.r;++i)for(var o=s.s.c;o<=s.e.c;++o){var l=gu(e,i,o);l.t="n",l.F=a,delete l.v,i==s.s.r&&o==s.s.c&&(l.f=r,n&&(l.D=!0))}return e}var lz={encode_col:ir,encode_row:Ar,encode_cell:Be,encode_range:at,decode_col:av,decode_row:sv,split_cell:yj,decode_cell:Qr,decode_range:Il,format_cell:wa,sheet_add_aoa:BA,sheet_add_json:MI,sheet_add_dom:bI,aoa_to_sheet:Cl,json_to_sheet:tz,table_to_sheet:PI,table_to_book:k7,sheet_to_csv:OI,sheet_to_txt:Z7,sheet_to_json:Hp,sheet_to_html:T7,sheet_to_formulae:ez,sheet_to_row_object_array:Hp,sheet_get_cell:gu,book_new:yv,book_append_sheet:_v,book_set_sheet_visibility:nz,cell_set_number_format:sz,cell_set_hyperlink:LI,cell_set_internal_link:az,cell_add_comment:iz,sheet_set_array_formula:oz,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};const cz=({tmdbApiKey:e,userId:t,onDone:r})=>{const[n,s]=z.useState(null),[a,i]=z.useState([]),[o,l]=z.useState([]),[c,u]=z.useState("upload"),[d,m]=z.useState(0),[p,x]=z.useState(0),[g,_]=z.useState(!1),[k,T]=z.useState(null),[w,C]=z.useState([]),[M,O]=z.useState(null),v=o.filter(N=>N.selected&&N.tmdbMatch).length,E=N=>{var de;const ce=(de=N.target.files)==null?void 0:de[0];if(!ce)return;s(ce);const oe=new FileReader;oe.onload=ge=>{var B;const Z=Wp((B=ge.target)==null?void 0:B.result,{type:"binary"}),G=Z.Sheets[Z.SheetNames[0]],fe=lz.sheet_to_json(G).map(K=>({title:K.title||K.Title||K.name||K.Name||"",releaseDate:K.releaseDate||K.ReleaseDate||K.release_date||K.year||K.Year||"",watched:K.watched||K.Watched||!1,rating:K.rating||K.Rating||null,review:K.review||K.Review||K.notes||K.Notes||""})).filter(K=>K.title);i(fe)},oe.readAsBinaryString(ce)},S=async()=>{if(!a.length||!e){O("Missing data or TMDB key");return}try{_(!0),O(null),l([]),m(0);const N=[],ce=Gt(We,"movies");for(let oe=0;oe<a.length;oe++){const de=a[oe];try{const ge=`${de.title} ${de.releaseDate||""}`.trim(),Z=await Fp(ge,e);if(!Z.results.length)N.push({excelData:de,tmdbMatch:null,confidence:0,status:"unmatched",userMovieExists:!1,selected:!1});else{const G=await ed(Z.results[0].id,e),ae=q_(de,G),fe=await lr(Ns(ce,zn("tmdbId","==",G.id)));let B,K=!1;fe.empty||(B=fe.docs[0].id,K=!!await Pp(t,B)),N.push({excelData:de,tmdbMatch:G,confidence:ae,status:K?"duplicate":ae>=70?"matched":"manual",userMovieExists:K,movieId:B,selected:!K})}}catch{N.push({excelData:de,tmdbMatch:null,confidence:0,status:"unmatched",userMovieExists:!1,selected:!1})}m(Math.round((oe+1)/a.length*100))}l(N),u("review")}finally{_(!1)}},R=async(N,ce)=>{try{_(!0);const oe=o[N],de=ce||oe.excelData.title,ge=await Fp(de,e);T(N),C(ge.results)}finally{_(!1)}},P=async N=>{if(k!=null){_(!0);try{const ce=await ed(N.id,e),oe=q_(o[k].excelData,ce),de=Gt(We,"movies"),ge=await lr(Ns(de,zn("tmdbId","==",ce.id)));let Z,G=!1;ge.empty||(Z=ge.docs[0].id,G=!!await Pp(t,Z)),l(ae=>{const fe=[...ae],B=fe[k];return fe[k]={...B,tmdbMatch:ce,confidence:oe,status:G?"duplicate":"matched",userMovieExists:G,movieId:Z,selected:!G},fe}),T(null),C([])}finally{_(!1)}}},D=async()=>{const N=o.filter(oe=>oe.selected&&oe.tmdbMatch);if(!N.length)return;u("import"),x(0);const ce=Gt(We,"movies");for(let oe=0;oe<N.length;oe++){const de=N[oe];try{let ge=de.movieId;ge||(ge=(await Zd(ce,{...Kx(de.tmdbMatch),addedAt:new Date,updatedAt:new Date})).id),await r0(t,ge,{userId:t,movieId:ge,watched:de.excelData.watched||!1,rating:de.excelData.rating||null,review:de.excelData.review||"",favorite:!1})}catch{}x(Math.round((oe+1)/N.length*100))}r==null||r()};return f.jsxs("div",{className:"space-y-6",children:[c==="upload"&&f.jsxs("div",{className:"space-y-4",children:[f.jsx("input",{type:"file",accept:".xlsx,.xls",className:"file-input file-input-bordered w-full",onChange:E}),!!a.length&&f.jsxs("div",{className:"text-sm opacity-80",children:[a.length," rows detected"]}),f.jsx("button",{className:"btn btn-primary",onClick:S,disabled:!e||!a.length||g,children:g?f.jsx("span",{className:"loading loading-spinner loading-sm"}):"Scan & Match"})]}),c==="review"&&f.jsxs("div",{className:"space-y-4",children:[f.jsxs("div",{className:"flex justify-between items-center",children:[f.jsx("div",{className:"font-bold",children:"Review Matches"}),f.jsx("button",{className:"btn btn-ghost btn-sm",onClick:()=>u("upload"),children:"Back"})]}),f.jsx("div",{className:"overflow-x-auto",children:f.jsxs("table",{className:"table table-zebra w-full",children:[f.jsx("thead",{children:f.jsxs("tr",{children:[f.jsx("th",{}),f.jsx("th",{children:"Excel"}),f.jsx("th",{children:"Match"}),f.jsx("th",{children:"Confidence"}),f.jsx("th",{children:"Status"}),f.jsx("th",{children:"Action"})]})}),f.jsx("tbody",{children:o.map((N,ce)=>{var oe;return f.jsxs("tr",{className:N.userMovieExists?"bg-warning bg-opacity-20":"",children:[f.jsx("td",{children:f.jsx("input",{type:"checkbox",className:"checkbox",checked:N.selected,disabled:!N.tmdbMatch,onChange:()=>{const de=[...o];de[ce].selected=!de[ce].selected,l(de)}})}),f.jsxs("td",{children:[f.jsx("div",{className:"font-semibold",children:N.excelData.title}),f.jsx("div",{className:"text-xs opacity-70",children:N.excelData.releaseDate||"-"})]}),f.jsx("td",{children:N.tmdbMatch?f.jsxs("div",{className:"flex items-center gap-3",children:[f.jsx("div",{className:"w-12 h-18",children:Ts(N.tmdbMatch)?f.jsx("img",{src:Ts(N.tmdbMatch),className:"object-cover"}):f.jsx("div",{className:"w-full h-full bg-base-200"})}),f.jsxs("div",{children:[f.jsx("div",{className:"font-semibold",children:N.tmdbMatch.title}),f.jsx("div",{className:"text-xs opacity-70",children:(oe=N.tmdbMatch.release_date)==null?void 0:oe.slice(0,4)})]})]}):f.jsx("span",{className:"text-error",children:"No match"})}),f.jsx("td",{children:N.tmdbMatch?f.jsxs("div",{className:"flex items-center",children:[f.jsx("progress",{className:`progress ${N.confidence>=70?"progress-success":N.confidence>=40?"progress-warning":"progress-error"}`,value:N.confidence,max:100}),f.jsxs("span",{className:"ml-2",children:[N.confidence,"%"]})]}):"-"}),f.jsxs("td",{children:[N.status==="matched"&&f.jsx("div",{className:"badge badge-success",children:"Matched"}),N.status==="unmatched"&&f.jsx("div",{className:"badge badge-error",children:"Unmatched"}),N.status==="duplicate"&&f.jsx("div",{className:"badge badge-warning",children:"Duplicate"}),N.status==="manual"&&f.jsx("div",{className:"badge badge-info",children:"Manual"})]}),f.jsx("td",{children:f.jsx("button",{className:"btn btn-sm btn-outline",onClick:()=>R(ce),children:f.jsx("i",{className:"fas fa-search"})})})]},ce)})})]})}),f.jsx("div",{className:"flex justify-end",children:f.jsxs("button",{className:"btn btn-primary",onClick:D,disabled:!v||g,children:["Import ",v," Movies"]})}),!!d&&d<100&&f.jsx("div",{children:f.jsx("progress",{className:"progress w-full",value:d,max:100})})]}),c==="import"&&f.jsxs("div",{className:"space-y-3",children:[f.jsx("div",{className:"font-bold",children:"Importing"}),f.jsx("progress",{className:"progress w-full",value:p,max:100})]}),k!==null&&f.jsx("div",{className:"modal modal-open",children:f.jsxs("div",{className:"modal-box max-w-4xl",children:[f.jsxs("h3",{className:"font-bold text-lg mb-4",children:["Manual match: ",o[k].excelData.title]}),f.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 mb-6",children:[f.jsx("input",{type:"text",className:"input input-bordered flex-1",placeholder:"Search for a movie...",defaultValue:o[k].excelData.title,onKeyDown:N=>N.key==="Enter"&&R(k,N.target.value)}),f.jsx("button",{className:"btn btn-primary w-full sm:w-auto",onClick:()=>{var N;return R(k,(N=document.querySelector(".modal input"))==null?void 0:N.value)},disabled:g,children:g?f.jsx("span",{className:"loading loading-spinner loading-sm"}):f.jsx("i",{className:"fas fa-search"})})]}),f.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-3 max-h-96 overflow-y-auto",children:w.map(N=>{var ce;return f.jsxs("div",{className:"card bg-base-100 shadow cursor-pointer",onClick:()=>P(N),children:[f.jsx("figure",{children:Ts(N)?f.jsx("img",{src:Ts(N)}):f.jsx("div",{className:"h-48 w-full bg-base-200"})}),f.jsxs("div",{className:"card-body p-3",children:[f.jsx("div",{className:"text-sm font-semibold",children:N.title}),f.jsx("div",{className:"text-xs opacity-70",children:(ce=N.release_date)==null?void 0:ce.slice(0,4)})]})]},N.id)})}),f.jsx("div",{className:"modal-action",children:f.jsx("button",{className:"btn",onClick:()=>{T(null),C([])},children:"Close"})})]})}),M&&f.jsx("div",{className:"alert alert-error",children:M})]})},uz=({selected:e,showDetails:t,loading:r,onToggleDetails:n,onAdd:s,onClose:a})=>{var i,o,l,c,u;return e?f.jsx("dialog",{className:"modal modal-open",children:f.jsxs("div",{className:"modal-box bg-xmas-card",children:[f.jsxs("div",{className:"flex gap-4",children:[f.jsx("div",{className:"w-24 shrink-0",children:Ts(e)?f.jsx("img",{src:Ts(e),alt:e.title,className:"w-full rounded-lg"}):f.jsx("div",{className:"w-full h-36 bg-base-200 flex items-center justify-center rounded-lg",children:f.jsx("i",{className:"fas fa-film text-2xl opacity-50"})})}),f.jsxs("div",{className:"flex-1",children:[f.jsx("h2",{className:"text-xl font-bold mb-1",children:e.title}),f.jsx("p",{className:"text-sm opacity-80 mb-1",children:(i=e.release_date)==null?void 0:i.slice(0,4)}),!t&&e.runtime&&f.jsxs("p",{className:"text-sm opacity-80 mb-1",children:["Runtime: ",e.runtime," min"]}),t&&f.jsxs("div",{className:"mt-3 space-y-2 text-sm opacity-90 max-h-48 overflow-auto pr-1",children:[e.overview&&f.jsxs("div",{children:[f.jsx("p",{className:"font-semibold mb-1",children:"Overview"}),f.jsx("p",{children:e.overview})]}),e.runtime&&f.jsxs("p",{children:[f.jsx("span",{className:"font-semibold",children:"Runtime:"})," ",e.runtime," min"]}),e.genres&&e.genres.length>0&&f.jsxs("p",{children:[f.jsx("span",{className:"font-semibold",children:"Genres:"})," ",e.genres.map(d=>typeof d=="string"?d:d.name).join(", ")]}),(((l=(o=e.credits)==null?void 0:o.cast)==null?void 0:l.length)||((c=e.cast)==null?void 0:c.length))&&f.jsxs("p",{children:[f.jsx("span",{className:"font-semibold",children:"Top cast:"})," ",((u=e.credits)!=null&&u.cast&&e.credits.cast.length>0?e.credits.cast.map(d=>d.name):e.cast).slice(0,5).join(", ")]})]})]})]}),f.jsxs("div",{className:"mt-4 space-y-3",children:[f.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-3",children:[f.jsx("div",{children:(e.overview||e.runtime||e.genres||e.credits||e.cast)&&f.jsxs("button",{type:"button",className:"btn btn-outline btn-sm sm:btn-md gap-2",onClick:n,disabled:r,children:[f.jsx("i",{className:"fas fa-info-circle"}),t?"Hide details":"View details"]})}),f.jsxs("div",{className:"flex justify-end gap-2",children:[f.jsxs("button",{className:"btn btn-primary btn-sm sm:btn-md",onClick:s,disabled:r,children:[r?f.jsx("span",{className:"loading loading-spinner loading-sm mr-2"}):f.jsx("i",{className:"fas fa-plus mr-2"}),"Add Movie"]}),f.jsx("button",{className:"btn btn-outline btn-sm sm:btn-md",onClick:a,disabled:r,children:"Cancel"})]})]}),e.id&&f.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center gap-2",children:[f.jsx("a",{href:`https://www.themoviedb.org/movie/${e.id}`,target:"_blank",rel:"noopener noreferrer",className:"btn btn-outline btn-xs sm:btn-sm flex items-center justify-center gap-2",children:f.jsx("img",{src:"/tmdb.svg",alt:"TMDB",className:"h-4 sm:h-5"})}),f.jsx("p",{className:"text-[10px] text-gray-400 max-w-xs",children:"This product uses the TMDB API but is not endorsed or certified by TMDB."})]})]}),f.jsx("form",{method:"dialog",className:"modal-backdrop",onClick:a,children:f.jsx("button",{children:"close"})})]})}):null},fz=()=>{const{currentUser:e,userProfile:t}=Nn(),[r,n]=z.useState(!1),[s,a]=z.useState(""),[i,o]=z.useState(""),[l,c]=z.useState(""),[u,d]=z.useState(""),[m,p]=z.useState(""),[x,g]=z.useState(!1),[_,k]=z.useState(null),[T,w]=z.useState(null);z.useEffect(()=>{i&&!l&&c(`https://www.themoviedb.org/movie/${i}`)},[i,l]);const C=()=>{a(""),o(""),c(""),d(""),p(""),k(null)},M=()=>{if(k(null),w(null),!e){k("Please sign in to request a movie.");return}n(!0)},O=()=>{x||(n(!1),C())},v=async E=>{if(E.preventDefault(),!e){k("You must be signed in to submit a request.");return}if(!s.trim()){k("Please enter a movie title.");return}try{g(!0),k(null),await Zd(Gt(We,"Requests"),{title:s.trim(),tmdbId:i?Number(i):null,tmdbUrl:l.trim()||null,year:u.trim()||null,notes:m.trim()||null,userId:e.uid,userDisplayName:(t==null?void 0:t.displayName)||e.displayName||null,status:"pending",createdAt:new Date}),w("Request submitted! Thank you."),C(),n(!1)}catch(S){console.error("Failed to submit movie request:",S),k((S==null?void 0:S.message)||"Failed to submit request. Please try again.")}finally{g(!1)}};return f.jsxs(f.Fragment,{children:[f.jsxs("button",{type:"button",className:"btn btn-outline btn-sm sm:btn-md mb-4",onClick:M,children:[f.jsx("i",{className:"fas fa-gift mr-2"}),"Request a movie"]}),_&&!r&&f.jsxs("div",{className:"alert alert-warning mb-4",children:[f.jsx("i",{className:"fas fa-exclamation-triangle mr-2"}),f.jsx("span",{children:_})]}),T&&!r&&f.jsxs("div",{className:"alert alert-success mb-4",children:[f.jsx("i",{className:"fas fa-check-circle mr-2"}),f.jsx("span",{children:T})]}),r&&f.jsx("dialog",{className:"modal modal-open",children:f.jsxs("div",{className:"modal-box bg-xmas-card max-w-lg",children:[f.jsx("h2",{className:"font-christmas text-2xl mb-2 text-xmas-gold",children:"Request a Movie"}),f.jsx("p",{className:"text-sm mb-4 opacity-80",children:"Can't find a movie in the catalogue? Tell us about it so we can add it."}),_&&f.jsxs("div",{className:"alert alert-error mb-3",children:[f.jsx("i",{className:"fas fa-exclamation-circle mr-2"}),f.jsx("span",{children:_})]}),f.jsxs("form",{className:"space-y-3",onSubmit:v,children:[f.jsxs("div",{children:[f.jsx("label",{className:"label",children:f.jsx("span",{className:"label-text",children:"Movie title *"})}),f.jsx("input",{type:"text",className:"input input-bordered w-full",value:s,onChange:E=>a(E.target.value),required:!0,disabled:x,placeholder:"e.g. The Grinch"})]}),f.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:[f.jsxs("div",{children:[f.jsx("label",{className:"label",children:f.jsx("span",{className:"label-text",children:"TMDB ID (optional)"})}),f.jsx("input",{type:"number",className:"input input-bordered w-full",value:i,onChange:E=>o(E.target.value),disabled:x,placeholder:"e.g. 8871"})]}),f.jsxs("div",{children:[f.jsx("label",{className:"label",children:f.jsx("span",{className:"label-text",children:"Release year (optional)"})}),f.jsx("input",{type:"number",className:"input input-bordered w-full",value:u,onChange:E=>d(E.target.value),disabled:x,placeholder:"e.g. 2000"})]})]}),f.jsxs("div",{children:[f.jsx("label",{className:"label",children:f.jsx("span",{className:"label-text",children:"TMDB URL (optional)"})}),f.jsx("input",{type:"url",className:"input input-bordered w-full",value:l,onChange:E=>c(E.target.value),disabled:x,placeholder:"https://www.themoviedb.org/movie/..."}),f.jsx("p",{className:"text-xs opacity-70 mt-1",children:"If you provide a TMDB ID, the URL will be auto-filled. You can also paste a URL directly."})]}),f.jsxs("div",{children:[f.jsx("label",{className:"label",children:f.jsx("span",{className:"label-text",children:"Anything else that helps? (optional)"})}),f.jsx("textarea",{className:"textarea textarea-bordered w-full",rows:3,value:m,onChange:E=>p(E.target.value),disabled:x,placeholder:"Actors, streaming service, or where you heard about it."})]}),f.jsxs("div",{className:"modal-action flex justify-end gap-2",children:[f.jsx("button",{type:"button",className:"btn btn-ghost",onClick:O,disabled:x,children:"Cancel"}),f.jsxs("button",{type:"submit",className:"btn btn-primary",disabled:x,children:[x&&f.jsx("span",{className:"loading loading-spinner loading-sm mr-2"}),"Submit request"]})]})]}),f.jsx("form",{method:"dialog",className:"modal-backdrop",onClick:O,children:f.jsx("button",{children:"close"})})]})})]})},hz=()=>{const{currentUser:e,userProfile:t}=Nn(),{isAdmin:r}=Uu(),[n,s]=z.useState(""),[a,i]=z.useState("local"),[o,l]=z.useState(null),[c,u]=z.useState(!1),[d,m]=z.useState(!1),[p,x]=z.useState(null),[g,_]=z.useState([]);z.useEffect(()=>{r&&(t!=null&&t.tmdbApiKey)?s(t.tmdbApiKey):s("")},[t,r]),z.useEffect(()=>{(async()=>{if(!e){_([]);return}try{const{userMovies:O}=await Vu(e.uid);_(Object.keys(O))}catch(O){console.error("Error loading user movies for import page:",O)}})()},[e]);const k=M=>{x(null),u(!1),l(M)},T=async M=>{if(!r){x({type:"error",text:"Only admins can import directly from TMDB."});return}if(!n){x({type:"error",text:"TMDB key required to fetch details."});return}try{m(!0),x(null),u(!1);const O=await ed(M.id,n);l(O)}catch(O){x({type:"error",text:(O==null?void 0:O.message)??"Failed to fetch details"})}finally{m(!1)}},w=async()=>{if(!(!e||!o))try{m(!0),x(null);const M=Gt(We,"movies"),O=await lr(Ns(M,zn("tmdbId","==",o.id)));let v;if(O.empty){if(!r){x({type:"error",text:"Only admins can add new catalogue movies."}),m(!1);return}v=(await Zd(M,{...Kx(o),addedAt:new Date,updatedAt:new Date})).id}else v=O.docs[0].id;await r0(e.uid,v,{userId:e.uid,movieId:v,watched:!1,favorite:!1}),_(E=>E.includes(v)?E:[...E,v]),ZS(),x({type:"success",text:"Added to your collection!"}),u(!1),l(null)}catch(M){x({type:"error",text:(M==null?void 0:M.message)??"Failed to add movie"})}finally{m(!1)}},C=()=>{d||l(null)};return f.jsxs("div",{className:"container mx-auto px-4 py-8",children:[f.jsx("div",{className:"mb-4",children:f.jsxs(Ye,{to:"/movies",className:"btn btn-primary btn-sm sm:btn-md",children:[f.jsx("i",{className:"fas fa-arrow-left mr-2"})," Back to Movies"]})}),f.jsx("h1",{className:"font-christmas text-3xl md:text-4xl text-xmas-line mb-6",children:"Add Movies"}),p&&f.jsxs("div",{className:`alert ${p.type==="error"?"alert-error":"alert-success"} mb-4`,children:[f.jsx("i",{className:`fas ${p.type==="error"?"fa-exclamation-circle":"fa-check-circle"} mr-2`}),f.jsx("span",{children:p.text})]}),f.jsx("div",{className:"mb-4",children:f.jsx(fz,{})}),r&&f.jsxs("div",{className:"tabs tabs-boxed mb-6",children:[f.jsxs("button",{className:`tab ${a==="local"?"tab-active":""}`,onClick:()=>i("local"),children:[f.jsx("i",{className:"fas fa-database mr-2"}),"Local"]}),f.jsxs("button",{className:`tab ${a==="tmdb"?"tab-active":""}`,onClick:()=>i("tmdb"),children:[f.jsx("i",{className:"fas fa-search mr-2"}),"TMDB"]}),f.jsxs("button",{className:`tab ${a==="excel"?"tab-active":""}`,onClick:()=>i("excel"),children:[f.jsx("i",{className:"fas fa-file-excel mr-2"}),"Excel"]})]}),a==="local"&&f.jsx("div",{className:"bg-xmas-card p-6 rounded-lg shadow-lg",children:f.jsx(r6,{onSelect:k,userMovieIds:g})}),a==="tmdb"&&r&&f.jsxs("div",{className:"bg-xmas-card p-6 rounded-lg shadow-lg",children:[!n&&f.jsxs("div",{className:"alert alert-warning mb-4",children:[f.jsx("i",{className:"fas fa-exclamation-triangle mr-2"}),f.jsx("span",{children:"Set your TMDB API key in Profile to search TMDB."})]}),f.jsx(i6,{tmdbApiKey:n,onSelect:T})]}),a==="excel"&&r&&f.jsxs("div",{className:"bg-xmas-card p-6 rounded-lg shadow-lg",children:[!n&&f.jsxs("div",{className:"alert alert-warning mb-4",children:[f.jsx("i",{className:"fas fa-exclamation-triangle mr-2"}),f.jsx("span",{children:"TMDB key required for matching."})]}),e?f.jsx(cz,{tmdbApiKey:n,userId:e.uid,onDone:()=>i("local")}):f.jsx("div",{className:"alert alert-info",children:"Log in to import from Excel."})]}),o&&f.jsx(uz,{selected:o,showDetails:c,loading:d,onToggleDetails:()=>u(M=>!M),onAdd:w,onClose:C})]})},dz=()=>{var _,k,T;const{currentUser:e}=Nn(),[t,r]=z.useState([]),[n,s]=z.useState({}),[a,i]=z.useState(!0),[o,l]=z.useState(null),[c,u]=z.useState(null),[d,m]=z.useState(!1),[p,x]=z.useState(!1);z.useEffect(()=>{(async()=>{if(e)try{i(!0);const{userMovies:C,movies:M}=await Vu(e.uid);s(C),r(M)}catch(C){console.error("Error fetching movies:",C),l("Failed to load movies")}finally{i(!1)}})()},[e]);const g=()=>{if(t.length===0)return;x(!0),u(null);const w=t.filter(v=>{const E=n[v.id];return d||!E||!E.watched});if(w.length===0){l("No eligible movies found. Try including watched movies."),x(!1);return}let C=0;const M=25,O=setInterval(()=>{const v=Math.floor(Math.random()*w.length);u(w[v]),C++,C>=M&&(clearInterval(O),x(!1))},100)};return a?f.jsx("div",{className:"flex justify-center items-center min-h-[60vh]",children:f.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-xmas-gold"})}):f.jsxs("div",{className:"container mx-auto px-4 py-8",children:[f.jsx("div",{className:"mb-4",children:f.jsxs(Ye,{to:"/movies",className:"btn btn-primary btn-sm sm:btn-md",children:[f.jsx("i",{className:"fas fa-arrow-left mr-2"})," Back to Movies"]})}),f.jsx("h1",{className:"font-christmas text-3xl md:text-4xl text-xmas-line mb-6",children:"Christmas Movie Picker"}),o&&f.jsxs("div",{className:"alert alert-error mb-6",children:[f.jsx("i",{className:"fas fa-exclamation-circle mr-2"}),f.jsx("span",{children:o})]}),t.length===0?f.jsxs("div",{className:"bg-xmas-card p-8 rounded-lg text-center",children:[f.jsx("h3",{className:"text-xl mb-4",children:"No movies in your collection"}),f.jsx("p",{className:"mb-4",children:"Add some Christmas movies to use the random movie picker!"}),f.jsxs(Ye,{to:"/import",className:"btn btn-primary",children:[f.jsx("i",{className:"fas fa-file-import mr-2"})," Import Movies"]})]}):f.jsxs("div",{className:"bg-xmas-card p-8 rounded-lg shadow-lg",children:[f.jsxs("div",{className:"text-center mb-6",children:[f.jsx("p",{className:"mb-4",children:"Can't decide what Christmas movie to watch? Let us pick one for you!"}),f.jsx("div",{className:"form-control mb-6",children:f.jsxs("label",{className:"label cursor-pointer justify-center",children:[f.jsx("span",{className:"label-text mr-2",children:"Include watched movies"}),f.jsx("input",{type:"checkbox",className:"toggle toggle-primary",checked:d,onChange:()=>m(!d)})]})}),f.jsx("button",{className:"btn btn-primary btn-lg",onClick:g,disabled:p,children:p?f.jsxs(f.Fragment,{children:[f.jsx("span",{className:"loading loading-spinner loading-md mr-2"}),"Picking a movie..."]}):f.jsxs(f.Fragment,{children:[f.jsx("i",{className:"fas fa-random mr-2"}),"Pick a Random Movie"]})})]}),c&&f.jsx("div",{className:"mt-8 flex flex-col items-center",children:f.jsx("div",{className:"w-full max-w-md",children:f.jsxs("div",{className:"card bg-base-100 shadow-xl overflow-hidden",children:[f.jsxs("figure",{className:"relative",children:[c.posterUrl?f.jsx("img",{src:c.posterUrl,alt:c.title,className:"w-full object-contain",style:{aspectRatio:"2/3",maxHeight:"500px"},loading:"lazy"}):f.jsx("div",{className:"w-full flex items-center justify-center bg-gray-800",style:{aspectRatio:"2/3",maxHeight:"500px"},children:f.jsx("i",{className:"fas fa-film text-6xl text-gray-500"})}),((_=n[c.id])==null?void 0:_.watched)&&f.jsx("div",{className:"absolute top-4 left-4 badge badge-lg badge-success",children:"Already Watched"}),((k=n[c.id])==null?void 0:k.rating)&&f.jsxs("div",{className:"absolute top-4 right-4 badge badge-lg badge-warning",children:[f.jsx("i",{className:"fas fa-star mr-1"}),n[c.id].rating,"/10"]})]}),f.jsxs("div",{className:"card-body",children:[f.jsx("h2",{className:"card-title text-2xl font-christmas",children:c.title}),f.jsx("p",{className:"text-gray-400",children:(T=c.releaseDate)==null?void 0:T.substring(0,4)}),f.jsxs("div",{className:"card-actions justify-end mt-4",children:[f.jsx(Ye,{to:Gx(c.title,c.id),className:"btn btn-primary",children:"View Details"}),f.jsx("button",{className:"btn btn-outline",onClick:g,disabled:p,children:"Pick Another"})]})]})]})})})]})]})},mz=(e,t)=>{const r=["Title","TMDB ID","Release Year","Watched","Watched Date","Rating","Review","Favorite","Date Added"].join(","),n=e.map(s=>{const a=t[s.id];if(!a)return null;const i=s.releaseDate?s.releaseDate.substring(0,4):"",o=a.watchedDate?Gp(a.watchedDate):"",l=a.addedAt?Gp(a.addedAt):"",c=Jw(s.title),u=a.review?Jw(a.review):"";return[c,s.tmdbId||"",i,a.watched?"Yes":"No",o,a.rating!==null&&a.rating!==void 0?a.rating:"",u,a.favorite?"Yes":"No",l].join(",")}).filter(Boolean);return[r,...n].join(`
`)},Gp=e=>{if(!(e instanceof Date))try{e&&typeof e.toDate=="function"?e=e.toDate():e=new Date(e)}catch{return""}return e.toISOString().split("T")[0]},Jw=e=>e?e.includes(",")||e.includes('"')||e.includes(`
`)?`"${e.replace(/"/g,'""')}"`:e:"",pz=(e,t,r)=>{const n=document.createElement("a"),s=new Blob([e],{type:r});n.href=URL.createObjectURL(s),n.download=t,n.click(),URL.revokeObjectURL(n.href)},gz=async(e,t,r)=>{const n=mz(e,t),s=`${r.replace(/\s+/g,"_")}_christmas_movies_${Gp(new Date)}.csv`;pz(n,s,"text/csv;charset=utf-8;")},xz=async()=>{const e=Gt(We,"movies"),t=await lr(e);let r=0;const n=t.size;for(const s of t.docs){const a=s.data();if(a.sortTitle)continue;const i=tA(a.title);i!==a.title&&(await fi(Bt(We,"movies",s.id),{sortTitle:i,updatedAt:new Date}),r++)}return{updated:r,total:n}},vz=()=>{const{currentUser:e}=Nn(),[t,r]=z.useState([]),[n,s]=z.useState(!1),[a,i]=z.useState(null),[o,l]=z.useState(null),[c,u]=z.useState(new Set);z.useEffect(()=>{(async()=>{if(e){s(!0),i(null);try{const g=Ns(Gt(We,"Requests"),zn("userId","==",e.uid)),k=(await lr(g)).docs.map(T=>{const w=T.data();return{id:T.id,title:w.title,year:w.year??null,status:w.status,tmdbId:w.tmdbId??null,createdAt:w.createdAt,updatedAt:w.updatedAt}});if(r(k),e&&k.length>0){const T=[];for(const w of k){if(w.status!=="fulfilled"||!w.tmdbId)continue;const C=Gt(We,"movies"),M=Ns(C,zn("tmdbId","==",w.tmdbId)),O=await lr(M);if(O.empty)continue;const E=O.docs[0].id,S=Bt(We,`users/${e.uid}/movies`,E);(await $n(S)).exists()&&T.push(w.id)}T.length>0&&u(new Set(T))}}catch(g){console.error("Error loading your movie requests:",g),i(g.message||"Failed to load your movie requests")}finally{s(!1)}}})()},[e]);const d=x=>{if(!x)return"";const g=x!=null&&x.toDate?x.toDate():x;try{return new Date(g).toLocaleString()}catch{return""}},m=x=>x==="fulfilled"?"badge badge-success":x==="dismissed"?"badge badge-ghost":"badge badge-warning",p=async x=>{if(e){if(!x.tmdbId){i("This request does not have a TMDB ID to match a movie.");return}try{i(null),l(x.id);const g=Gt(We,"movies"),_=Ns(g,zn("tmdbId","==",x.tmdbId)),k=await lr(_);if(k.empty){i("Could not find this movie in the catalogue yet.");return}const w=k.docs[0].id;await r0(e.uid,w,{userId:e.uid,movieId:w,watched:!1,favorite:!1}),u(C=>new Set(C).add(x.id))}catch(g){console.error("Failed to add movie to your collection:",g),i(g.message||"Failed to add movie to your collection")}finally{l(null)}}};return f.jsxs("div",{className:"mt-8",children:[f.jsx("h3",{className:"text-lg font-bold mb-2",children:"My Movie Requests"}),f.jsx("p",{className:"text-sm opacity-80 mb-4",children:"These are movies you've asked to be added to the catalogue."}),n&&f.jsx("div",{className:"flex justify-center py-4",children:f.jsx("span",{className:"loading loading-spinner loading-md"})}),a&&f.jsxs("div",{className:"alert alert-error mb-4",children:[f.jsx("i",{className:"fas fa-exclamation-circle mr-2"}),f.jsx("span",{children:a})]}),!n&&!a&&t.length===0&&f.jsx("p",{className:"text-sm opacity-80",children:"You haven't requested any movies yet."}),!n&&!a&&t.length>0&&f.jsx("div",{className:"overflow-x-auto",children:f.jsxs("table",{className:"table table-zebra table-sm",children:[f.jsx("thead",{children:f.jsxs("tr",{children:[f.jsx("th",{children:"Title"}),f.jsx("th",{children:"Year"}),f.jsx("th",{children:"Status"}),f.jsx("th",{children:"Last Updated"}),f.jsx("th",{})]})}),f.jsx("tbody",{children:t.map(x=>f.jsxs("tr",{children:[f.jsx("td",{children:x.title}),f.jsx("td",{children:x.year||"-"}),f.jsx("td",{children:f.jsx("span",{className:m(x.status),children:x.status})}),f.jsx("td",{className:"text-xs",children:d(x.updatedAt||x.createdAt)}),f.jsx("td",{children:x.status==="fulfilled"&&x.tmdbId&&(c.has(x.id)?f.jsx("span",{className:"badge badge-success text-xs",children:"In collection"}):f.jsxs("button",{className:"btn btn-xs btn-primary",onClick:()=>p(x),disabled:o===x.id,children:[o===x.id&&f.jsx("span",{className:"loading loading-spinner loading-xs mr-1"}),"Add to my movies"]}))})]},x.id))})]})})]})},yz=()=>{const{currentUser:e,userProfile:t,signOut:r}=Nn(),{isAdmin:n}=Uu(),[s,a]=z.useState(!1),[i,o]=z.useState(""),[l,c]=z.useState(!1),[u,d]=z.useState(!1),[m,p]=z.useState(!1),[x,g]=z.useState(null),[_,k]=z.useState(null),[T,w]=z.useState({totalMovies:0,watchedMovies:0,unwatchedMovies:0,averageRating:0,favoriteMovies:0});z.useEffect(()=>{t!=null&&t.tmdbApiKey&&o(t.tmdbApiKey),(async()=>{if(e)try{const E=await eA(e.uid),S=E.length,R=E.filter(oe=>oe.watched).length,P=S-R,D=E.filter(oe=>oe.favorite).length,N=E.filter(oe=>oe.rating!==void 0&&oe.rating!==null),ce=N.length>0?N.reduce((oe,de)=>oe+(de.rating||0),0)/N.length:0;w({totalMovies:S,watchedMovies:R,unwatchedMovies:P,averageRating:ce,favoriteMovies:D})}catch(E){console.error("Error fetching user stats:",E)}})()},[e,t]);const C=async()=>{if(e)try{c(!0),g(null);const v=Bt(We,"users",e.uid);await fi(v,{tmdbApiKey:i}),k("TMDB API key saved successfully!"),setTimeout(()=>{k(null)},3e3)}catch(v){console.error("Error saving API key:",v),g(v.message||"Failed to save API key")}finally{c(!1)}},M=async()=>{try{await r()}catch(v){console.error("Error signing out:",v)}},O=async()=>{if(e)try{d(!0),g(null);const{userMovies:v,movies:E}=await Vu(e.uid);await gz(E,v,t.displayName||"User"),k("Movies exported successfully!"),setTimeout(()=>{k(null)},3e3)}catch(v){console.error("Error exporting movies:",v),g(v.message||"Failed to export movies")}finally{d(!1)}};return!e||!t?f.jsx("div",{className:"flex justify-center items-center min-h-[60vh]",children:f.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-xmas-gold"})}):f.jsxs("div",{className:"container mx-auto px-4 py-8",children:[f.jsx("h1",{className:"font-christmas text-3xl md:text-4xl text-xmas-line mb-6",children:"Your Profile"}),x&&f.jsxs("div",{className:"alert alert-error mb-6",children:[f.jsx("i",{className:"fas fa-exclamation-circle mr-2"}),f.jsx("span",{children:x})]}),_&&f.jsxs("div",{className:"alert alert-success mb-6",children:[f.jsx("i",{className:"fas fa-check-circle mr-2"}),f.jsx("span",{children:_})]}),f.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-8",children:[f.jsx("div",{className:"md:col-span-1",children:f.jsxs("div",{className:"bg-xmas-card p-6 rounded-lg shadow-lg",children:[f.jsxs("div",{className:"flex flex-col items-center mb-6",children:[t.photoURL?f.jsx("img",{src:t.photoURL,alt:t.displayName,className:"w-24 h-24 rounded-full mb-4"}):f.jsx("div",{className:"w-24 h-24 rounded-full bg-gray-700 flex items-center justify-center mb-4",children:f.jsx("i",{className:"fas fa-user text-4xl text-gray-400"})}),f.jsx("h2",{className:"text-xl font-bold",children:t.displayName})]}),f.jsx("div",{className:"divider"}),f.jsxs("div",{className:"mb-6",children:[f.jsx("h3",{className:"text-lg font-bold mb-2",children:"Your Stats"}),f.jsxs("ul",{className:"space-y-2",children:[f.jsxs("li",{className:"flex justify-between",children:[f.jsx("span",{children:"Total Movies:"}),f.jsx("span",{className:"font-bold",children:T.totalMovies})]}),f.jsxs("li",{className:"flex justify-between",children:[f.jsx("span",{children:"Watched:"}),f.jsx("span",{className:"font-bold",children:T.watchedMovies})]}),f.jsxs("li",{className:"flex justify-between",children:[f.jsx("span",{children:"Unwatched:"}),f.jsx("span",{className:"font-bold",children:T.unwatchedMovies})]}),f.jsxs("li",{className:"flex justify-between",children:[f.jsx("span",{children:"Favorites:"}),f.jsx("span",{className:"font-bold",children:T.favoriteMovies})]}),f.jsxs("li",{className:"flex justify-between",children:[f.jsx("span",{children:"Average Rating:"}),f.jsxs("span",{className:"font-bold",children:[T.averageRating.toFixed(1),"/10"]})]})]})]}),f.jsx("div",{className:"divider"}),f.jsxs("div",{className:"mt-6 space-y-3",children:[f.jsxs("button",{className:"btn btn-outline btn-primary w-full",onClick:O,disabled:u||T.totalMovies===0,children:[u?f.jsx("span",{className:"loading loading-spinner loading-sm mr-2"}):f.jsx("i",{className:"fas fa-file-export mr-2"}),"Export Movie Data"]}),f.jsxs("button",{className:"btn btn-outline btn-error w-full",onClick:M,children:[f.jsx("i",{className:"fas fa-sign-out-alt mr-2"}),"Sign Out"]})]})]})}),f.jsx("div",{className:"md:col-span-2",children:f.jsxs("div",{className:"bg-xmas-card p-6 rounded-lg shadow-lg",children:[n&&f.jsxs(f.Fragment,{children:[f.jsx("h2",{className:"text-2xl font-bold mb-4",children:"Settings"}),f.jsxs("div",{className:"mb-6",children:[f.jsx("h3",{className:"text-lg font-bold mb-2",children:"TMDB API Key"}),f.jsxs("p",{className:"mb-4",children:["Your TMDB API key is used to fetch movies, cast and other details."," ",f.jsx("a",{href:"https://www.themoviedb.org/settings/api",target:"_blank",rel:"noopener noreferrer",className:"link link-primary",children:"The Movie Database"}),"."]}),f.jsxs("div",{className:"form-control",children:[f.jsx("label",{className:"label",children:f.jsx("span",{className:"label-text",children:"API Key"})}),f.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 items-stretch",children:[f.jsx("input",{type:s?"text":"password",className:"input input-bordered flex-1 h-12 text-lg",value:i,onChange:v=>o(v.target.value),placeholder:"Enter your TMDB API key",style:{letterSpacing:s?"normal":"3px"}}),f.jsx("button",{type:"button",className:"btn btn-ghost w-12",onClick:()=>a(v=>!v),children:f.jsx("i",{className:`fas ${s?"fa-eye-slash":"fa-eye"}`})}),f.jsx("button",{className:"btn btn-primary w-full sm:w-auto",onClick:C,disabled:l,children:l?f.jsx("span",{className:"loading loading-spinner loading-sm"}):f.jsx("i",{className:"fas fa-save"})})]})]})]}),f.jsx("div",{className:"divider"})]}),f.jsxs("div",{className:"mb-6",children:[f.jsx("h3",{className:"text-lg font-bold mb-2",children:"Quick Links"}),f.jsxs("div",{className:"flex flex-wrap gap-2",children:[f.jsxs(Ye,{to:"/movies",className:"btn btn-outline btn-sm",children:[f.jsx("i",{className:"fas fa-film mr-2"}),"My Movies"]}),f.jsxs(Ye,{to:"/import",className:"btn btn-outline btn-sm",children:[f.jsx("i",{className:"fas fa-file-import mr-2"}),"Add Movies"]}),f.jsxs(Ye,{to:"/random",className:"btn btn-outline btn-sm",children:[f.jsx("i",{className:"fas fa-random mr-2"}),"Random Movie Picker"]}),f.jsxs(Ye,{to:"/achievements",className:"btn btn-outline btn-sm",children:[f.jsx("i",{className:"fas fa-trophy mr-2"}),"Achievements"]})]})]}),f.jsx(vz,{}),n&&f.jsxs(f.Fragment,{children:[f.jsx("div",{className:"divider"}),f.jsxs("div",{className:"mb-6",children:[f.jsx("h3",{className:"text-lg font-bold mb-2",children:"Admin Tools"}),f.jsxs(Ye,{to:"/admin",className:"btn btn-primary btn-sm",children:[f.jsx("i",{className:"fas fa-tools mr-2"}),"Open Admin Dashboard"]})]})]})]})})]})]})},_z=({item:e})=>{const[t,r]=vu.useState(!1);return f.jsxs("div",{className:"rounded-lg p-4 shadow-lg border transition-transform bg-xmas-card "+(e.unlocked?"border-xmas-gold hover:scale-[1.02]":"border-gray-700 opacity-70"),children:[f.jsxs("div",{className:"flex items-center mb-3",children:[f.jsx("div",{className:"relative mr-3 w-16 h-16 rounded-full overflow-hidden border border-xmas-gold/60 bg-gray-800 flex items-center justify-center",children:t?f.jsx("span",{className:"text-3xl",children:e.icon}):f.jsx("img",{src:`/achievements/${e.id}.png`,alt:e.name,className:"w-full h-full object-cover",loading:"lazy",onError:()=>r(!0)})}),f.jsxs("div",{children:[f.jsxs("h2",{className:"text-lg font-bold flex items-center gap-2",children:[e.name,e.unlocked&&f.jsx("span",{className:"badge badge-success badge-sm",children:"Unlocked"})]}),e.unlocked&&e.unlockedAt&&f.jsxs("p",{className:"text-xs text-xmas-text/70 mt-1",children:["Unlocked on"," ",e.unlockedAt.toLocaleDateString(void 0,{year:"numeric",month:"short",day:"numeric"})]})]})]}),f.jsx("p",{className:"text-sm text-xmas-text mb-3",children:e.unlocked?e.description:e.hint}),!e.unlocked&&f.jsx("p",{className:"text-xs text-xmas-text/60 italic",children:"Locked  keep watching to reveal this badge."})]})},wz=()=>{const{currentUser:e}=Nn(),[t,r]=z.useState(!0),[n,s]=z.useState([]);return z.useEffect(()=>{(async()=>{if(e)try{r(!0),await oh(e.uid);const i=Gt(We,`users/${e.uid}/achievements`),o=await lr(i),l=new Map;o.forEach(u=>{const d=u.data();let m=null;d.unlockedAt instanceof Date?m=d.unlockedAt:d.unlockedAt&&typeof d.unlockedAt.toDate=="function"&&(m=d.unlockedAt.toDate()),l.set(u.id,{unlockedAt:m,seen:d.seen})});const c=Xo.map(u=>{const d=l.get(u.id);return{id:u.id,name:u.name,description:u.description,hint:u.hint,icon:u.icon,unlocked:!!d,unlockedAt:(d==null?void 0:d.unlockedAt)??null}}).sort((u,d)=>{if(u.unlocked!==d.unlocked)return u.unlocked?-1:1;if(u.unlocked&&d.unlocked){const m=u.unlockedAt?u.unlockedAt.getTime():0,p=d.unlockedAt?d.unlockedAt.getTime():0;if(m!==p)return m-p}return u.name.localeCompare(d.name)});s(c)}finally{r(!1)}})()},[e]),e?t?f.jsx("div",{className:"flex justify-center items-center min-h-[60vh]",children:f.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-xmas-gold"})}):f.jsxs("div",{className:"container mx-auto px-4 py-8",children:[f.jsx("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between mb-6",children:f.jsxs("div",{children:[f.jsx("h1",{className:"font-christmas text-3xl md:text-4xl text-xmas-line mb-2",children:"Achievements"}),f.jsx("p",{className:"text-sm text-xmas-text/80",children:"Unlock festive badges as you watch, rate and explore your Christmas movies."})]})}),f.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-3 gap-6",children:n.map(a=>f.jsx(_z,{item:a},a.id))})]}):f.jsx("div",{className:"flex justify-center items-center min-h-[60vh]",children:f.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-xmas-gold"})})},Ez=()=>{const{slug:e}=Kg(),[t,r]=z.useState(null),[n,s]=z.useState([]),[a,i]=z.useState({}),[o,l]=z.useState(null),[c,u]=z.useState(!0),[d,m]=z.useState(null);if(z.useEffect(()=>{(async()=>{if(e)try{u(!0),m(null);const _=Gt(We,"publicProfiles"),k=Ns(_,zn("publicWatchlistSlug","==",e),zn("isPublicWatchlist","==",!0)),T=await lr(k);if(T.empty){m("This watchlist isn't public (or no longer exists)."),u(!1);return}const w=T.docs[0],C={id:w.id,...w.data()};r(C);const M=C.userId,{userMovies:O,movies:v}=await Vu(M),E=v.filter(N=>{const ce=O[N.id];return ce&&ce.watched}).sort((N,ce)=>{const oe=O[N.id],de=O[ce.id],ge=(oe==null?void 0:oe.rating)??0,Z=(de==null?void 0:de.rating)??0;return Z!==ge?Z-ge:N.title.localeCompare(ce.title)}),S={};E.forEach(N=>{S[N.id]=O[N.id]});const R=E.map(N=>S[N.id]).filter(N=>N&&N.rating!=null),P=R.length>0?R.reduce((N,ce)=>N+(ce.rating||0),0)/R.length:0,D=E.filter(N=>{var ce;return(ce=S[N.id])==null?void 0:ce.favorite}).length;s(E),i(S),l({totalWatched:E.length,averageRating:P,favoriteMovies:D})}catch(_){console.error("Error loading public watchlist:",_),m("This watchlist isn't public (or no longer exists).")}finally{u(!1)}})()},[e]),z.useEffect(()=>{if(!(typeof document>"u"))if(t){const g=t.publicWatchlistName||`${t.displayName}'s Xmas Watchlist`;document.title=`${g}  Christmas Movies`}else document.title="Christmas Movies"},[t]),c)return f.jsx("div",{className:"flex justify-center items-center min-h-[60vh]",children:f.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-xmas-gold"})});if(d||!t)return f.jsx("div",{className:"container mx-auto px-4 py-16",children:f.jsxs("div",{className:"bg-xmas-card p-8 rounded-lg text-center max-w-xl mx-auto",children:[f.jsx("h1",{className:"font-christmas text-3xl text-xmas-line mb-4",children:"Watchlist Not Available"}),f.jsx("p",{className:"mb-4",children:d||"This watchlist isn't public (or no longer exists)."}),f.jsxs(Ye,{to:"/",className:"btn btn-primary",children:[f.jsx("i",{className:"fas fa-home mr-2"}),"Go to Home"]})]})});const p=t.publicWatchlistName||`${t.displayName}'s Xmas Watchlist`,x=t.publicWatchlistTagline;return f.jsxs("div",{className:"container mx-auto px-2 sm:px-4 py-6 sm:py-10",children:[f.jsxs("header",{className:"mb-6 sm:mb-8 flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[f.jsxs("div",{className:"flex items-center gap-4",children:[t.photoURL?f.jsx("img",{src:t.photoURL,alt:t.displayName,className:"w-16 h-16 sm:w-20 sm:h-20 rounded-full border-2 border-xmas-gold shadow-lg"}):f.jsx("div",{className:"w-16 h-16 sm:w-20 sm:h-20 rounded-full bg-gray-700 flex items-center justify-center border-2 border-xmas-gold shadow-lg",children:f.jsx("i",{className:"fas fa-user text-2xl text-gray-300"})}),f.jsxs("div",{children:[f.jsx("h1",{className:"font-christmas text-2xl sm:text-3xl md:text-4xl text-xmas-line mb-1",children:p}),x&&f.jsx("p",{className:"text-sm sm:text-base text-xmas-mute",children:x})]})]}),o&&f.jsxs("div",{className:"bg-xmas-card px-4 py-3 rounded-lg shadow-md flex flex-wrap gap-4 text-sm sm:text-base",children:[f.jsxs("div",{children:[f.jsx("div",{className:"text-xs uppercase tracking-wide text-xmas-mute",children:"Watched"}),f.jsx("div",{className:"font-bold text-lg",children:o.totalWatched})]}),f.jsxs("div",{children:[f.jsx("div",{className:"text-xs uppercase tracking-wide text-xmas-mute",children:"Average Rating"}),f.jsxs("div",{className:"font-bold text-lg",children:[o.averageRating.toFixed(1),"/10"]})]}),f.jsxs("div",{children:[f.jsx("div",{className:"text-xs uppercase tracking-wide text-xmas-mute",children:"Favorites"}),f.jsx("div",{className:"font-bold text-lg",children:o.favoriteMovies})]})]})]}),n.length===0?f.jsxs("div",{className:"bg-xmas-card p-8 rounded-lg text-center max-w-xl mx-auto",children:[f.jsx("h2",{className:"text-xl mb-3",children:"No watched movies yet"}),f.jsx("p",{className:"text-sm text-xmas-mute",children:"As soon as they start marking movies as watched, they'll show up here."})]}):f.jsx("div",{className:"grid grid-cols-3 sm:grid-cols-4 md:grid-cols-5 lg:grid-cols-6 gap-2 sm:gap-3",children:n.map(g=>{var k;const _=a[g.id];return f.jsx(Ye,{to:`/u/${e}/m/${JS(g.title)}?id=${g.id}`,className:"block transition-transform hover:scale-[1.02] hover:shadow-xl",children:f.jsxs("div",{className:"relative rounded-lg overflow-hidden bg-xmas-card shadow-md h-full flex flex-col",children:[f.jsxs("div",{className:"relative",children:[g.posterUrl?f.jsx("img",{src:g.posterUrl,alt:g.title,className:"w-full h-auto object-cover",style:{aspectRatio:"2/3"},loading:"lazy"}):f.jsx("div",{className:"w-full flex items-center justify-center bg-gray-800",style:{aspectRatio:"2/3"},children:f.jsx("i",{className:"fas fa-film text-2xl text-gray-500"})}),_&&_.watched&&f.jsx("div",{className:"absolute top-1 right-1 bg-primary rounded-full p-1 shadow-md",children:f.jsx("i",{className:"fas fa-check text-xs text-white"})}),_&&_.favorite&&f.jsx("div",{className:"absolute top-1 left-1 text-yellow-400 drop-shadow-md",children:f.jsx("i",{className:"fas fa-star text-sm"})})]}),f.jsxs("div",{className:"p-1 sm:p-2 flex-grow flex flex-col",children:[f.jsx("h3",{className:"text-xs sm:text-sm font-medium line-clamp-2",children:g.title}),f.jsxs("div",{className:"flex justify-between items-center mt-1",children:[f.jsx("p",{className:"text-xs text-gray-400",children:(k=g.releaseDate)==null?void 0:k.substring(0,4)}),_&&_.rating!=null&&f.jsxs("div",{className:"flex items-center",children:[f.jsx("span",{className:"text-yellow-400 mr-0.5",children:f.jsx("i",{className:"fas fa-star text-xs"})}),f.jsx("span",{className:"text-xs",children:_.rating})]})]}),_&&_.vibeTags&&_.vibeTags.length>0&&f.jsx("div",{className:"mt-1 flex flex-wrap gap-1.5",children:_.vibeTags.slice(0,3).map(T=>f.jsx("span",{className:"badge badge-sm bg-xmas-gold bg-opacity-20 text-[0.7rem] border-xmas-gold",children:T},T))})]})]})},g.id)})})]})},Tz=()=>{const{slug:e}=Kg(),[t]=hb(),r=Ls(),[n,s]=z.useState(null),[a,i]=z.useState(null),[o,l]=z.useState(null),[c,u]=z.useState(!0),[d,m]=z.useState(null);if(z.useEffect(()=>{(async()=>{const _=t.get("id");if(!(!e||!_))try{u(!0),m(null);const k=Gt(We,"publicProfiles"),T=Ns(k,zn("publicWatchlistSlug","==",e),zn("isPublicWatchlist","==",!0)),w=await lr(T);if(w.empty){m("This watchlist isn't public (or no longer exists)."),u(!1);return}const C=w.docs[0],M={id:C.id,...C.data()};s(M);const O=M.userId,v=Bt(We,"movies",_),E=await $n(v);if(!E.exists()){m("Movie not found"),u(!1);return}const S={id:E.id,...E.data()};i(S);const R=Bt(We,"users",O,"movies",_),P=await $n(R);P.exists()?l({id:P.id,...P.data()}):l(null)}catch(k){console.error("Error loading public movie",k),m("Failed to load this movie.")}finally{u(!1)}})()},[e,t]),z.useEffect(()=>{if(!(typeof document>"u"))if(a&&n){const g=n.publicWatchlistName||`${n.displayName}'s Xmas Watchlist`;document.title=`${a.title}  ${g}`}else document.title="Christmas Movies"},[a,n]),c)return f.jsx("div",{className:"flex justify-center items-center min-h-[60vh]",children:f.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-xmas-gold"})});if(d||!n||!a)return f.jsx("div",{className:"container mx-auto px-4 py-16",children:f.jsxs("div",{className:"bg-xmas-card p-8 rounded-lg text-center max-w-xl mx-auto",children:[f.jsx("h1",{className:"font-christmas text-3xl text-xmas-line mb-4",children:"Movie Not Available"}),f.jsx("p",{className:"mb-4",children:d||"This movie could not be found for this watchlist."}),e&&f.jsxs("button",{className:"btn btn-primary",onClick:()=>r(`/u/${e}`),children:[f.jsx("i",{className:"fas fa-arrow-left mr-2"}),"Back to Watchlist"]})]})});const p=n.publicWatchlistName||`${n.displayName}'s Xmas Watchlist`,x=o!=null&&o.watched?"Watched":"Not watched yet";return f.jsxs("div",{className:"container mx-auto px-2 sm:px-4 py-6 sm:py-10",children:[f.jsx("div",{className:"mb-4 flex flex-wrap justify-between items-center gap-2",children:f.jsxs("div",{className:"flex items-center gap-3",children:[n.photoURL?f.jsx("img",{src:n.photoURL,alt:n.displayName,className:"w-10 h-10 rounded-full border border-xmas-gold"}):f.jsx("div",{className:"w-10 h-10 rounded-full bg-gray-700 flex items-center justify-center border border-xmas-gold",children:f.jsx("i",{className:"fas fa-user text-sm text-gray-300"})}),f.jsxs("div",{className:"text-sm",children:[f.jsx("div",{className:"font-semibold",children:p}),f.jsx("button",{className:"link link-primary text-xs",onClick:()=>r(`/u/${e}`),children:" Back to watchlist"})]})]})}),f.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-8",children:[f.jsxs("div",{className:"md:col-span-1",children:[f.jsx("div",{className:"rounded-lg overflow-hidden shadow-xl",children:a.posterUrl?f.jsx("img",{src:a.posterUrl,alt:a.title,className:"w-full object-contain",style:{aspectRatio:"2/3"}}):f.jsx("div",{className:"w-full flex items-center justify-center bg-gray-800",style:{aspectRatio:"2/3"},children:f.jsx("i",{className:"fas fa-film text-6xl text-gray-500"})})}),a.tmdbId&&f.jsxs("div",{className:"mt-4 flex flex-col items-center",children:[f.jsx("a",{href:`https://www.themoviedb.org/movie/${a.tmdbId}`,target:"_blank",rel:"noopener noreferrer",className:"btn btn-outline w-full flex items-center justify-center gap-2",children:f.jsx("img",{src:"/tmdb.svg",alt:"TMDB",className:"h-5"})}),f.jsx("p",{className:"mt-2 text-xs text-gray-400 text-center",children:"This product uses the TMDB API but is not endorsed or certified by TMDB."})]}),o&&f.jsxs("div",{className:"mt-4 space-y-2 text-sm",children:[f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsx("span",{className:"text-xs uppercase tracking-wide text-xmas-mute",children:"Status"}),f.jsx("span",{className:"font-semibold",children:x})]}),o.rating!=null&&f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsx("span",{className:"text-xs uppercase tracking-wide text-xmas-mute",children:"Rating"}),f.jsxs("div",{className:"flex items-center gap-1",children:[f.jsx("span",{className:"text-yellow-400",children:f.jsx("i",{className:"fas fa-star"})}),f.jsxs("span",{className:"font-semibold",children:[o.rating,"/10"]})]})]}),o.watchedDate&&f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsx("span",{className:"text-xs uppercase tracking-wide text-xmas-mute",children:"Watched on"}),f.jsx("span",{className:"font-semibold",children:(()=>{var _;const g=(_=o.watchedDate)!=null&&_.toDate?o.watchedDate.toDate():new Date(o.watchedDate);return isNaN(g.getTime())?"":g.toLocaleDateString()})()})]}),o.vibeTags&&o.vibeTags.length>0&&f.jsxs("div",{children:[f.jsx("div",{className:"text-xs uppercase tracking-wide text-xmas-mute mb-1",children:"Vibe review"}),f.jsx("div",{className:"flex flex-wrap gap-1.5",children:o.vibeTags.map(g=>f.jsx("span",{className:"badge badge-sm bg-xmas-gold bg-opacity-20 text-[0.7rem] border-xmas-gold",children:g},g))})]})]})]}),f.jsxs("div",{className:"md:col-span-2",children:[f.jsx("h1",{className:"font-christmas text-3xl md:text-4xl text-xmas-line mb-2",children:a.title}),a.releaseDate&&f.jsx("p",{className:"text-lg text-gray-400 mb-4",children:new Date(a.releaseDate).getFullYear()}),a.genres&&a.genres.length>0&&f.jsx("div",{className:"flex flex-wrap gap-2 mb-4",children:a.genres.map(g=>f.jsx("span",{className:"badge badge-outline",children:g},g))}),a.runtime&&f.jsxs("p",{className:"mb-4",children:[f.jsx("i",{className:"fas fa-clock mr-2 text-xmas-gold"}),Math.floor(a.runtime/60),"h ",a.runtime%60,"m"]}),a.overview&&f.jsxs("div",{className:"mb-6",children:[f.jsx("h2",{className:"text-xl font-bold mb-2",children:"Overview"}),f.jsx("p",{className:"text-gray-300",children:a.overview})]}),a.directors&&a.directors.length>0&&f.jsxs("div",{className:"mb-4",children:[f.jsxs("h2",{className:"text-xl font-bold mb-2",children:["Director",a.directors.length>1?"s":""]}),f.jsx("p",{children:a.directors.join(", ")})]}),a.cast&&a.cast.length>0&&f.jsxs("div",{className:"mb-6",children:[f.jsx("h2",{className:"text-xl font-bold mb-2",children:"Cast"}),f.jsx("p",{className:"flex flex-wrap gap-1",children:a.cast.slice(0,10).map((g,_)=>f.jsxs(vu.Fragment,{children:[f.jsx("span",{children:g}),_<Math.min(a.cast.length,10)-1&&f.jsx("span",{children:","})]},g))})]}),o&&o.review&&f.jsxs("div",{className:"mt-6",children:[f.jsx("div",{className:"divider"}),f.jsx("h2",{className:"text-xl font-bold mb-2",children:"Their Thoughts"}),f.jsx("p",{className:"whitespace-pre-line text-gray-200 text-sm sm:text-base",children:o.review})]})]})]})]})},kz=()=>{const e=Ls(),{isAdmin:t,loading:r,currentUser:n}=Uu(),[s,a]=z.useState(!1),[i,o]=z.useState(null),l=!1;z.useEffect(()=>{t&&!r&&e("/admin")},[t,r,e]);const c=async()=>{o(null),a(!0);try{await _k(Tc,NL)}catch(u){console.error("Login error:",u),u.code==="auth/popup-closed-by-user"?o("Sign-in popup was closed. Please try again."):u.code==="auth/cancelled-popup-request"?o("Another popup is already open. Please try again."):u.code==="auth/unauthorized-domain"?(console.error("Unauthorized domain error:",window.location.hostname),o("This domain is not authorized for OAuth operations. Please add "+window.location.hostname+" to your Firebase authorized domains list in the Firebase console under Authentication > Sign-in method > Authorized domains.")):o("Failed to sign in. Please try again."),a(!1)}};return r?f.jsx("div",{className:"flex justify-center items-center min-h-[60vh]",children:f.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-xmas-gold"})}):f.jsx("div",{className:"container mx-auto px-4 py-12",children:f.jsxs("div",{className:"max-w-md mx-auto",children:[f.jsxs("div",{className:"text-center mb-8",children:[f.jsx("h1",{className:"font-christmas text-4xl text-xmas-line mb-2",children:"Admin Login"}),f.jsx("p",{className:"text-xmas-mute",children:"Sign in to manage the Christmas Quiz"})]}),f.jsxs("div",{className:"bg-xmas-card rounded-lg shadow-lg p-6",children:[l,n&&f.jsxs("div",{className:"bg-info bg-opacity-10 border-l-4 border-info p-4 mb-6 rounded",children:[f.jsx("p",{className:"text-info font-bold mb-2",children:"User Authenticated"}),f.jsxs("p",{className:"text-info text-sm mb-1",children:["Email: ",n.email]}),f.jsxs("p",{className:"text-info text-sm mb-2",children:["UID: ",n.uid]}),f.jsxs("p",{className:"text-info text-sm",children:["To grant admin access, create a document in the ",f.jsx("code",{className:"bg-base-300 px-1 py-0.5 rounded",children:"admins"})," collection with this UID as the document ID."]}),l]}),i&&f.jsx("div",{className:"bg-error bg-opacity-10 border-l-4 border-error p-4 mb-6 rounded",children:f.jsx("p",{className:"text-error",children:i})}),f.jsxs("div",{className:"text-center mb-6",children:[f.jsx("p",{className:"mb-4",children:"Sign in with your Google account to access the admin panel."}),f.jsx("p",{className:"text-sm text-xmas-mute mb-6",children:"Only authorized administrators will be granted access."}),f.jsx("button",{onClick:c,className:"btn btn-primary w-full flex items-center justify-center gap-2",disabled:s,children:s?f.jsxs(f.Fragment,{children:[f.jsx("span",{className:"loading loading-spinner loading-sm"}),"Signing in..."]}):f.jsxs(f.Fragment,{children:[f.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 48 48",children:[f.jsx("path",{fill:"#FFC107",d:`M43.611,20.083H42V20H24v8h11.303c-1.649,4.657-6.08,8-11.303,8c-6.627,0-12-5.373-12-12
                      s5.373-12,12-12c3.059,0,5.842,1.154,7.961,3.039l5.657-5.657C34.046,6.053,29.268,4,24,4C12.955,4,4,12.955,4,24s8.955,20,20,20
                      s20-8.955,20-20C44,22.659,43.862,21.35,43.611,20.083z`}),f.jsx("path",{fill:"#FF3D00",d:`M6.306,14.691l6.571,4.819C14.655,15.108,18.961,12,24,12c3.059,0,5.842,1.154,7.961,3.039
                      l5.657-5.657C34.046,6.053,29.268,4,24,4C16.318,4,9.656,8.337,6.306,14.691z`}),f.jsx("path",{fill:"#4CAF50",d:`M24,44c5.166,0,9.86-1.977,13.409-5.192l-6.19-5.238C29.211,35.091,26.715,36,24,36
                      c-5.202,0-9.619-3.317-11.283-7.946l-6.522,5.025C9.505,39.556,16.227,44,24,44z`}),f.jsx("path",{fill:"#1976D2",d:`M43.611,20.083H42V20H24v8h11.303c-0.792,2.237-2.231,4.166-4.087,5.571
                      c0.001-0.001,0.002-0.001,0.003-0.002l6.19,5.238C36.971,39.205,44,34,44,24C44,22.659,43.862,21.35,43.611,20.083z`})]}),"Sign in with Google"]})})]})]}),f.jsx("div",{className:"text-center mt-6",children:f.jsx("button",{onClick:()=>e("/"),className:"btn btn-link text-xmas-mute",children:"Back to Home"})})]})})};async function Sz(e,t){const r=await ed(e,t),n=Gt(We,"movies"),s=Ns(n,zn("tmdbId","==",r.id)),a=await lr(s),i={...Kx(r),updatedAt:new Date};if(a.empty){const o={...i,addedAt:new Date};return{movieId:(await Zd(n,o)).id,action:"created"}}else{const o=a.docs[0].id;return await Ps(Bt(We,"movies",o),i,{merge:!0}),{movieId:o,action:"updated"}}}const Az=e=>new Promise(t=>setTimeout(t,e));async function Iz(e,t,r,n=200){let s=0,a=0,i=0,o=0;const l=[];for(let c=0;c<e.length;c++){const u=e[c];try{if(!u||Number.isNaN(u)){i++,r==null||r(c+1,e.length,"skipped");continue}const{movieId:d,action:m}=await Sz(u,t);l.push(d),m==="created"?s++:a++,r==null||r(c+1,e.length,m),n>0&&await Az(n)}catch(d){console.error("Catalogue upsert error for TMDB",u,d),o++,r==null||r(c+1,e.length,"error")}}return{totalRequested:e.length,created:s,updated:a,skipped:i,errors:o,movieIds:l}}const Cz=()=>{const e=Ls(),{isAdmin:t,loading:r}=Uu(),{userProfile:n}=Nn(),[s,a]=z.useState(!0),[i,o]=z.useState(null),[l,c]=z.useState(null),[u,d]=z.useState(!1),[m,p]=z.useState({totalMovies:0,moviesWithSortTitle:0}),[x,g]=z.useState([]),[_,k]=z.useState(!1),[T,w]=z.useState(""),[C,M]=z.useState(""),[O,v]=z.useState(!0),[E,S]=z.useState(!1),[R,P]=z.useState(0),[D,N]=z.useState("");z.useEffect(()=>{n!=null&&n.tmdbApiKey&&w(n.tmdbApiKey)},[n]),z.useEffect(()=>{!r&&!t&&e("/admin/login")},[t,r,e]),z.useEffect(()=>{t&&(async()=>{if(t){a(!0);try{const G=await lr(Gt(We,"movies")),ae=G.size;let fe=0;G.forEach(B=>{B.data().sortTitle&&fe++}),p({totalMovies:ae,moviesWithSortTitle:fe})}catch(G){console.error("Error fetching movie data:",G),o("Failed to load movie data")}finally{a(!1)}}})()},[t]),z.useEffect(()=>{t&&(async()=>{if(t){k(!0);try{const G=Ns(Gt(We,"Requests"),zn("status","==","pending")),fe=(await lr(G)).docs.map(B=>({id:B.id,...B.data()}));g(fe)}catch(G){console.error("Error fetching movie requests:",G),o("Failed to load movie requests")}finally{k(!1)}}})()},[t]);const ce=async()=>{try{d(!0),o(null);const Z=await xz();c(`Sort titles updated for ${Z.updated} out of ${Z.total} movies.`),p(G=>({...G,moviesWithSortTitle:G.moviesWithSortTitle+Z.updated})),setTimeout(()=>c(null),5e3)}catch(Z){console.error("Error updating sort titles:",Z),o(Z.message||"Failed to update sort titles")}finally{d(!1)}},oe=async(Z,G)=>{try{o(null),await fi(Bt(We,"Requests",Z),{status:G,updatedAt:new Date}),g(ae=>ae.filter(fe=>fe.id!==Z)),c(`Request marked as ${G}.`),setTimeout(()=>c(null),4e3)}catch(ae){console.error("Error updating request status:",ae),o(ae.message||"Failed to update request")}},de=z.useMemo(()=>{const G=C.split(/[\s,]+/).map(ae=>ae.trim()).filter(Boolean).map(ae=>Number(ae)).filter(ae=>Number.isInteger(ae)&&ae>0);return Array.from(new Set(G))},[C]),ge=async()=>{if(o(null),c(null),!T){o("TMDB API key required");return}if(de.length===0){o("Please paste at least one valid TMDB ID");return}try{S(!0),P(0),N(`Starting (0 / ${de.length})`);const Z=await Iz(de,T,(G,ae,fe)=>{const B=Math.round(G/ae*100);P(B),N(`Processed ${G} / ${ae} (${fe})`)},O?300:0);c(`Catalogue updated. Created: ${Z.created}, Updated: ${Z.updated}, Skipped: ${Z.skipped}, Errors: ${Z.errors}.`)}catch(Z){console.error(Z),o((Z==null?void 0:Z.message)??"Catalogue import failed.")}finally{S(!1)}};return r||s?f.jsx("div",{className:"flex justify-center items-center min-h-[60vh]",children:f.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-xmas-gold"})}):f.jsxs("div",{className:"container mx-auto px-4 py-8",children:[f.jsxs("div",{className:"flex justify-between items-center mb-8",children:[f.jsx("h1",{className:"font-christmas text-3xl md:text-4xl text-xmas-line",children:"Admin Dashboard"}),f.jsx("div",{className:"flex gap-2",children:f.jsxs(Ye,{to:"/movies",className:"btn btn-outline",children:[f.jsx("i",{className:"fas fa-film mr-2"})," Movies"]})})]}),i&&f.jsxs("div",{className:"alert alert-error mb-6",children:[f.jsx("i",{className:"fas fa-exclamation-circle mr-2"}),f.jsx("span",{children:i})]}),l&&f.jsxs("div",{className:"alert alert-success mb-6",children:[f.jsx("i",{className:"fas fa-check-circle mr-2"}),f.jsx("span",{children:l})]}),f.jsxs("div",{className:"mb-8",children:[f.jsx("h2",{className:"text-2xl font-christmas mb-4 text-xmas-gold",children:"Movie Administration"}),f.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-8",children:[f.jsx("div",{className:"card bg-xmas-card shadow-xl",children:f.jsxs("div",{className:"card-body",children:[f.jsxs("h2",{className:"card-title font-christmas",children:[f.jsx("i",{className:"fas fa-sort-alpha-down text-primary mr-2"})," Sort Title Migration"]}),f.jsx("p",{className:"mb-4",children:'Update all movies to include sort titles (e.g., "The Grinch"  "Grinch") for better alphabetical sorting.'}),f.jsxs("div",{className:"flex flex-col gap-2",children:[f.jsxs("div",{className:"stats bg-base-200 text-base-content",children:[f.jsxs("div",{className:"stat",children:[f.jsx("div",{className:"stat-title",children:"Total Movies"}),f.jsx("div",{className:"stat-value",children:m.totalMovies})]}),f.jsxs("div",{className:"stat",children:[f.jsx("div",{className:"stat-title",children:"With Sort Titles"}),f.jsx("div",{className:"stat-value",children:m.moviesWithSortTitle}),f.jsx("div",{className:"stat-desc",children:m.totalMovies>0?`${Math.round(m.moviesWithSortTitle/m.totalMovies*100)}%`:"0%"})]})]}),f.jsxs("button",{className:"btn btn-primary w-full",onClick:ce,disabled:u||m.moviesWithSortTitle===m.totalMovies,children:[u?f.jsx("span",{className:"loading loading-spinner loading-sm mr-2"}):f.jsx("i",{className:"fas fa-sync-alt mr-2"}),m.moviesWithSortTitle===m.totalMovies?"All Movies Updated":"Update Sort Titles"]})]})]})}),f.jsx("div",{className:"card bg-xmas-card shadow-xl",children:f.jsxs("div",{className:"card-body",children:[f.jsxs("h2",{className:"card-title font-christmas",children:[f.jsx("i",{className:"fas fa-database text-primary mr-2"})," Catalogue Builder (TMDB IDs)"]}),f.jsxs("p",{className:"mb-4",children:["Bulk-import TMDB titles into your ",f.jsx("code",{children:"movies"})," catalogue only  no user collections will be updated."]}),f.jsx("label",{className:"label mt-4",children:f.jsx("span",{className:"label-text",children:"TMDB IDs (comma / space / newline separated)"})}),f.jsx("textarea",{className:"textarea textarea-bordered w-full h-40",value:C,onChange:Z=>M(Z.target.value),placeholder:`e.g. 603, 497, 155, 27205
603
497 155
27205`}),f.jsxs("div",{className:"flex items-center gap-4 mt-4",children:[f.jsx("div",{className:"form-control",children:f.jsxs("label",{className:"label cursor-pointer gap-2",children:[f.jsx("span",{className:"label-text",children:"Slow mode (API friendly)"}),f.jsx("input",{type:"checkbox",className:"toggle",checked:O,onChange:Z=>v(Z.target.checked)})]})}),f.jsx("button",{className:"btn btn-primary ml-auto",onClick:ge,disabled:E||de.length===0||!T,title:T?void 0:"Add your TMDB API key in Profile > Settings",children:E?f.jsxs(f.Fragment,{children:[f.jsx("span",{className:"loading loading-spinner loading-sm mr-2"}),"Importing ",de.length,""]}):f.jsxs(f.Fragment,{children:[f.jsx("i",{className:"fas fa-file-import mr-2"}),"Import ",de.length||0," to Catalogue"]})})]}),(E||R>0)&&f.jsxs("div",{className:"mt-4",children:[f.jsx("progress",{className:"progress w-full",value:R,max:100}),f.jsx("div",{className:"text-sm mt-1 opacity-80",children:D})]})]})})]})]}),f.jsxs("div",{className:"mb-8",children:[f.jsx("h2",{className:"text-2xl font-christmas mb-4 text-xmas-gold",children:"Movie Requests"}),f.jsx("div",{className:"card bg-xmas-card shadow-xl",children:f.jsxs("div",{className:"card-body",children:[f.jsxs("h2",{className:"card-title font-christmas flex items-center gap-2",children:[f.jsx("i",{className:"fas fa-gift text-primary"}),"Pending Requests"]}),f.jsx("p",{className:"text-sm opacity-80 mb-4",children:"These are movies users have asked to be added to the catalogue."}),_?f.jsx("div",{className:"flex justify-center py-8",children:f.jsx("span",{className:"loading loading-spinner loading-md"})}):x.length===0?f.jsx("p",{className:"text-sm opacity-80",children:"No pending requests right now."}):f.jsx("div",{className:"overflow-x-auto",children:f.jsxs("table",{className:"table table-zebra table-sm",children:[f.jsx("thead",{children:f.jsxs("tr",{children:[f.jsx("th",{children:"Title"}),f.jsx("th",{children:"Year"}),f.jsx("th",{children:"TMDB"}),f.jsx("th",{children:"Requested By"}),f.jsx("th",{children:"Notes"}),f.jsx("th",{})]})}),f.jsx("tbody",{children:x.map(Z=>{var ae;const G=(ae=Z.createdAt)!=null&&ae.toDate?Z.createdAt.toDate():Z.createdAt;return f.jsxs("tr",{children:[f.jsxs("td",{children:[f.jsx("div",{className:"font-semibold",children:Z.title}),G&&f.jsx("div",{className:"text-xs opacity-70",children:new Date(G).toLocaleString()})]}),f.jsx("td",{children:Z.year||"-"}),f.jsxs("td",{children:[Z.tmdbId&&f.jsxs("div",{className:"text-xs",children:["ID: ",Z.tmdbId]}),Z.tmdbUrl&&f.jsx("a",{href:Z.tmdbUrl,target:"_blank",rel:"noopener noreferrer",className:"link link-primary text-xs",children:"View TMDB"})]}),f.jsxs("td",{children:[f.jsx("div",{className:"text-sm",children:Z.userDisplayName||Z.userEmail||Z.userId}),Z.userEmail&&f.jsx("div",{className:"text-xs opacity-70",children:Z.userEmail})]}),f.jsx("td",{className:"max-w-xs whitespace-pre-wrap text-xs",children:Z.notes||"-"}),f.jsxs("td",{className:"flex flex-col gap-1",children:[f.jsx("button",{className:"btn btn-xs btn-success",onClick:()=>oe(Z.id,"fulfilled"),children:"Fulfilled"}),f.jsx("button",{className:"btn btn-xs btn-ghost",onClick:()=>oe(Z.id,"dismissed"),children:"Dismiss"})]})]},Z.id)})})]})})]})})]})]})},Nz=QR([{element:f.jsx(DL,{}),children:[{path:"/",element:f.jsx(ML,{})},{path:"/login",element:f.jsx(LL,{})},{path:"/u/:slug",element:f.jsx(Ez,{})},{path:"/u/:slug/m/:movieSlug",element:f.jsx(Tz,{})},{element:f.jsx(H_,{}),children:[{path:"/movies",element:f.jsx(WL,{})},{path:"/movies/:movieId",element:f.jsx(t6,{})},{path:"/import",element:f.jsx(hz,{})},{path:"/random",element:f.jsx(dz,{})},{path:"/profile",element:f.jsx(yz,{})},{path:"/achievements",element:f.jsx(wz,{})}]},{path:"/admin/login",element:f.jsx(kz,{})},{path:"/admin",element:f.jsx(H_,{children:f.jsx(Cz,{})})}]}]);cm.createRoot(document.getElementById("root")).render(f.jsx(vu.StrictMode,{children:f.jsx(RL,{children:f.jsx(FL,{children:f.jsx(ab,{router:Nz})})})}));
